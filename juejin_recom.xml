<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Vue<å‰ç«¯é¡µé¢ç‰ˆæœ¬æ£€æµ‹>]]></title>    <link>https://juejin.cn/post/7601175299010953231</link>    <guid>https://juejin.cn/post/7601175299010953231</guid>    <pubDate>2026-02-01T06:13:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601175299010953231" data-draft-id="7601077290681876532" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue&lt;å‰ç«¯é¡µé¢ç‰ˆæœ¬æ£€æµ‹&gt;"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-02-01T06:13:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="èª°åœ¨èŠ±é‡Œèƒ¡å“¨"/> <meta itemprop="url" content="https://juejin.cn/user/1011206430666551"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue&lt;å‰ç«¯é¡µé¢ç‰ˆæœ¬æ£€æµ‹&gt;
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1011206430666551/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    èª°åœ¨èŠ±é‡Œèƒ¡å“¨
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T06:13:19.000Z" title="Sun Feb 01 2026 06:13:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{font-family:-apple-system,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial;color:#00325e}.markdown-body ::selection{background-color:#00325e;color:#fff}.markdown-body blockquote{padding:10px 20px;background-color:#fffaf0;box-shadow:0 3px 10px 0 rgba(255,172,194,.24);border:1px solid #f3ca8e;transition:all .2s;margin:1em 0;border-radius:5px}.markdown-body blockquote p{font-size:14px;line-height:25px;color:#795548}.markdown-body blockquote p:last-child{margin:0}.markdown-body blockquote:hover{border-color:#ff9800;background-color:#fff8e0;box-shadow:0 6px 10px -5px rgba(225,173,98,.3803921569)}.markdown-body blockquote code{color:#ff502c}.markdown-body pre{border:1px solid #8cc0f3;box-shadow:0 3px 10px 0 rgba(255,198,198,.28);border-radius:5px;transition:all .2s;overflow-x:auto;white-space:pre-wrap}.markdown-body pre:hover{border-color:#6d9dce}.markdown-body pre&gt;code{padding:10px 20px;color:#00325e;background:#f0f8ff;font-size:12px;line-height:1.6;display:block}.markdown-body code{background:#f6fbff;color:#0b5393;padding:2px 4px;border-radius:4px;font-size:12px}.markdown-body p{font-size:14px;line-height:28px;text-align:justify;margin-bottom:17px;color:#595959}.markdown-body a{color:#00325e;text-decoration:none}.markdown-body a:after{content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAQdJREFUKFNt0DtLA0EUBeBzZle0Eks7rcUfEfBRCha7NorYa6NmVJzgyi4smUgKtdZGCJktLMVH4Y8QeztLWyE7VyLEuNFbXj4Oh0P8c8mZm+uJrEN4BJFTeP/MUVe3bnocfALwkOlo1zS7iZAzf6Cx7oXgbaqjxiDEWCcVaGyxQ8pSWo9XhqhoQ/xUFbaKjhe5V+CmR7mnSplEEF6GSmJ+F/d0KHvbCIIJCLc85U6BC5mONgbJNM3uFag++sX7z8O8MzsWBucifMx0dDGE1kmm458KDVukAlnNdDz/exEeW3dNkbfsYC0xtmgDWP6ELLZ0/F6BJu/UoFQN5AkoeUjeJPvx6+i+X5Sjah4tA6gYAAAAAElFTkSuQmCC);margin-left:2px}.markdown-body a:hover{box-shadow:0 1px}.markdown-body table{max-width:100%;border-collapse:collapse;border-spacing:0;box-shadow:0 3px 10px 0 rgba(255,238,172,.24);transition:all .2s}.markdown-body table:hover{box-shadow:0 3px 10px 0 rgba(185,169,103,.24)}.markdown-body table tr th{border:1px solid #8cc0f3;background-color:#f0f8ff;padding:12px 15px}.markdown-body table tr td{border:1px solid rgba(243,202,142,.4);padding:12px 15px}.markdown-body table tbody tr{transition:all .2s}.markdown-body table tbody tr:hover td{border-color:#f3ca8e;background-color:#fff8e0;z-index:1}.markdown-body img{max-width:100%}.markdown-body h1{font-size:20px;margin-top:30px;margin-bottom:10px;padding-left:30px;position:relative}.markdown-body h1&gt;code{font-size:20px}.markdown-body h1:before{content:"ğŸº";display:block;font-size:18px;width:18px;height:18px;left:0;position:absolute}.markdown-body h2{font-size:18px;margin-top:30px;margin-bottom:10px;padding-left:28px;position:relative}.markdown-body h2&gt;code{font-size:18px}.markdown-body h2:before{content:"ğŸ»";display:block;font-size:16px;width:16px;height:16px;left:0;position:absolute}.markdown-body h3{font-size:16px;margin-top:30px;margin-bottom:10px;padding-left:26px;position:relative}.markdown-body h3&gt;code{font-size:16px}.markdown-body h3:before{content:"ğŸ¥‚";display:block;font-size:14px;width:14px;height:14px;left:0;position:absolute}.markdown-body h4{font-size:14px;margin-top:30px;margin-bottom:10px;padding-left:24px;position:relative}.markdown-body h4&gt;code{font-size:14px}.markdown-body h4:before{content:"ğŸ¥ƒ";display:block;font-size:12px;width:12px;height:12px;left:0;position:absolute}.markdown-body h5{font-size:12px;margin-top:30px;margin-bottom:10px}.markdown-body h5&gt;code{font-size:12px}.markdown-body h6{font-size:10px;margin-top:30px;margin-bottom:10px}.markdown-body h6&gt;code{font-size:10px}.markdown-body h1,.markdown-body h2{color:#ff502c}.markdown-body hr{height:4px;border:none;margin-top:32px;margin-bottom:32px;background-size:4px 1px;background-image:linear-gradient(270deg,#6d9dce,#8cc0f3 25%,transparent 50%)}.markdown-body hr:nth-child(2n){background-image:linear-gradient(270deg,#ff9800,#fff8e0 25%,transparent 50%)}.markdown-body ul{padding-inline-start:20px}.markdown-body ul li{list-style-type:"ğŸ”¸"}.markdown-body ul li li{list-style-type:"â—»ï¸"}.markdown-body ul li li li{list-style-type:"â–«ï¸"}.markdown-body ol{padding-inline-start:20px}.markdown-body ol ::marker{color:#ff9800}.markdown-body ol,.markdown-body ul{line-height:2em}.markdown-body li{padding-inline-start:1ch}.markdown-body li.task-list-item{list-style:none;padding-inline-start:0}.markdown-body li input{padding-right:2px}.markdown-body li input[type=checkbox i]{appearance:none}.markdown-body li input:before{content:"ğŸŸ©";display:block;width:13px;height:13px}.markdown-body li input:checked:before{content:"âœ…"}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atelier-sulphurpool-light">.hljs-comment,.hljs-quote{color:#6b7394}.hljs-attribute,.hljs-link,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#c94922}.hljs-built_in,.hljs-builtin-name,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#c76b29}.hljs-bullet,.hljs-string,.hljs-symbol{color:#ac9739}.hljs-section,.hljs-title{color:#3d8fd1}.hljs-keyword,.hljs-selector-tag{color:#6679cc}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#f5f7ff;color:#5e6687}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ£€æµ‹</h2>
<h3 data-id="heading-1">1. è§£å†³æµè§ˆå™¨ç¼“å­˜é—®é¢˜</h3>
<ul>
<li><strong>é™æ€èµ„æºç¼“å­˜</strong>ï¼šæµè§ˆå™¨ä¼šç¼“å­˜ JSã€CSS ç­‰é™æ€èµ„æºï¼Œç”¨æˆ·å¯èƒ½ç»§ç»­ä½¿ç”¨æ—§ç‰ˆæœ¬</li>
<li><strong>ç”¨æˆ·ä½“éªŒå½±å“</strong>ï¼šç”¨æˆ·æ— æ³•åŠæ—¶è·å–æ–°åŠŸèƒ½ï¼Œå¯¼è‡´åŠŸèƒ½ç¼ºå¤±æˆ–æ“ä½œå¼‚å¸¸</li>
</ul>
<h3 data-id="heading-2">2. ä¿éšœåŠŸèƒ½ä¸€è‡´æ€§</h3>
<ul>
<li><strong>åŠŸèƒ½åŒæ­¥</strong>ï¼šç¡®ä¿æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½ä½¿ç”¨æœ€æ–°çš„åŠŸèƒ½å’Œä¿®å¤</li>
<li><strong>æ•°æ®ä¸€è‡´æ€§</strong>ï¼šé¿å…å› ç‰ˆæœ¬å·®å¼‚å¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜</li>
</ul>
<h3 data-id="heading-3">3. æå‡ç”¨æˆ·ä½“éªŒ</h3>
<ul>
<li><strong>ä¸»åŠ¨æé†’</strong>ï¼šåœ¨æ–°ç‰ˆæœ¬å‘å¸ƒåä¸»åŠ¨é€šçŸ¥ç”¨æˆ·æ›´æ–°</li>
<li><strong>æ— ç¼å‡çº§</strong>ï¼šå‡å°‘ç”¨æˆ·æ‰‹åŠ¨åˆ·æ–°é¡µé¢çš„éœ€æ±‚</li>
</ul>
<h2 data-id="heading-4">ç‰ˆæœ¬æ£€æµ‹æ ¸å¿ƒæ€è·¯</h2>
<p align="center"><img width="400px" src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/201719ca776e476ca30793edf20ed3d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kqw5Zyo6Iqx6YeM6IOh5ZOo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770531199&amp;x-signature=dnxrNVrGXVVZKOtMJagIipMtS8Y%3D" alt="version1.gif" loading="lazy"/></p>
<h3 data-id="heading-5">æ•´ä½“æ¶æ„</h3>
<blockquote>
<p>æ„å»ºé˜¶æ®µ â†’ ç‰ˆæœ¬æ–‡ä»¶ç”Ÿæˆ â†’ è¿è¡Œæ—¶æ£€æµ‹ â†’ ç‰ˆæœ¬å¯¹æ¯” â†’ ç”¨æˆ·æé†’</p>
</blockquote>
<h3 data-id="heading-6">æŠ€æœ¯å®ç°è¦ç‚¹</h3>
<h4 data-id="heading-7">1. ç‰ˆæœ¬æ ‡è¯†ç”Ÿæˆ</h4>
<ul>
<li><strong>æ„å»ºæ—¶ç”Ÿæˆ</strong>ï¼šæ¯æ¬¡æ‰“åŒ…æ—¶ç”Ÿæˆå”¯ä¸€çš„ç‰ˆæœ¬æ ‡è¯†</li>
<li><strong>æ—¶é—´æˆ³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨æ—¶é—´æˆ³ç¡®ä¿æ¯æ¬¡æ„å»ºç‰ˆæœ¬å·å”¯ä¸€</li>
</ul>
<h4 data-id="heading-8">2. ç‰ˆæœ¬æ–‡ä»¶éƒ¨ç½²</h4>
<ul>
<li><strong>JSON æ ¼å¼</strong>ï¼šå°†ç‰ˆæœ¬ä¿¡æ¯ä¿å­˜ä¸ºÂ <code>version.json</code>Â æ–‡ä»¶</li>
<li><strong>é™æ€è®¿é—®</strong>ï¼šé€šè¿‡ HTTP è¯·æ±‚å¯ç›´æ¥è®¿é—®ç‰ˆæœ¬æ–‡ä»¶</li>
</ul>
<h4 data-id="heading-9">3. å®¢æˆ·ç«¯æ£€æµ‹æœºåˆ¶</h4>
<ul>
<li><strong>å®šæ—¶è½®è¯¢</strong>ï¼šå®šæœŸæ£€æŸ¥æœåŠ¡å™¨ç‰ˆæœ¬æ–‡ä»¶</li>
<li><strong>ç‰ˆæœ¬å¯¹æ¯”</strong>ï¼šæ¯”è¾ƒæœ¬åœ°ç¼“å­˜ç‰ˆæœ¬ä¸æœåŠ¡å™¨ç‰ˆæœ¬</li>
<li><strong>æ™ºèƒ½æé†’</strong>ï¼šä»…åœ¨ç‰ˆæœ¬ä¸ä¸€è‡´æ—¶æé†’ç”¨æˆ·</li>
</ul>
<h2 data-id="heading-10">ç‰ˆæœ¬æ£€æµ‹å®ç°æ­¥éª¤</h2>
<h3 data-id="heading-11">æ­¥éª¤ä¸€ï¼šæ„å»ºç‰ˆæœ¬æ–‡ä»¶ç”Ÿæˆè„šæœ¬</h3>
<p>åˆ›å»ºÂ <code>build-version.js</code>Â æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// build-version.js ï¼ˆè‡ªåŠ¨ç”Ÿæˆç‰ˆæœ¬æ–‡ä»¶è„šæœ¬ï¼‰</span>
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)

<span class="hljs-comment">// æ–¹æ¡ˆAï¼šä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºç‰ˆæœ¬æ ‡è¯†ï¼ˆæœ€ç®€å•ï¼Œç¡®ä¿æ¯æ¬¡æ‰“åŒ…å”¯ä¸€ï¼‰</span>
<span class="hljs-keyword">const</span> version = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getTime</span>().<span class="hljs-title function_">toString</span>()

<span class="hljs-comment">// ç‰ˆæœ¬æ–‡ä»¶å†…å®¹</span>
<span class="hljs-keyword">const</span> versionJson = {
  <span class="hljs-attr">version</span>: version,
  <span class="hljs-attr">updateTime</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleString</span>() <span class="hljs-comment">// å¯é€‰ï¼šæ·»åŠ æ›´æ–°æ—¶é—´ï¼Œä¾¿äºæ’æŸ¥</span>
}

<span class="hljs-comment">// å†™å…¥version.jsonæ–‡ä»¶ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰</span>
<span class="hljs-keyword">const</span> versionPath = path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'public'</span>, <span class="hljs-string">'version.json'</span>)
fs.<span class="hljs-title function_">writeFileSync</span>(versionPath, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(versionJson, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>), <span class="hljs-string">'utf-8'</span>)

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… è‡ªåŠ¨ç”Ÿæˆç‰ˆæœ¬æ–‡ä»¶æˆåŠŸï¼Œç‰ˆæœ¬å·ï¼š<span class="hljs-subst">${version}</span>`</span>)

</code></pre>
<h3 data-id="heading-12">æ­¥éª¤äºŒï¼šä¿®æ”¹æ„å»ºå‘½ä»¤</h3>
<p>åœ¨Â <code>package.json</code>Â ä¸­ä¿®æ”¹æ„å»ºå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"build:prod"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node build-version.js &amp;&amp; vue-cli-service build"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-13">æ­¥éª¤ä¸‰ï¼šé…ç½® Vue æ„å»ºè¿‡ç¨‹</h3>
<p>åœ¨Â <code>vue.config.js</code>Â ä¸­æ·»åŠ ç‰ˆæœ¬æ–‡ä»¶å¤åˆ¶é…ç½®ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">chainWebpack</span>(<span class="hljs-params">config</span>) {
  <span class="hljs-comment">// ... å…¶ä»–é…ç½®</span>
  
  <span class="hljs-comment">// å¤åˆ¶ version.json åˆ° dist ç›®å½•</span>
  config.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">'copy'</span>)
    .<span class="hljs-title function_">tap</span>(<span class="hljs-function"><span class="hljs-params">args</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> hasVersionJson = args[<span class="hljs-number">0</span>].<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">from</span> === <span class="hljs-string">'version.json'</span>)
      <span class="hljs-keyword">if</span> (!hasVersionJson) {
        args[<span class="hljs-number">0</span>].<span class="hljs-title function_">push</span>({
          <span class="hljs-attr">from</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'public/version.json'</span>),
          <span class="hljs-attr">to</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'dist/version.json'</span>)
        })
      }
      <span class="hljs-keyword">return</span> args
    })
}
</code></pre>
<h3 data-id="heading-14">æ­¥éª¤å››ï¼šå®ç°ç‰ˆæœ¬æ£€æµ‹å·¥å…·ç±»</h3>
<p>åˆ›å»ºÂ <code>src/utils/versionUpdate.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// src/utils/versionUpdate.js</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Notification</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'element-ui'</span>
<span class="hljs-comment">/**
 * ç‰ˆæœ¬æ›´æ–°æ£€æµ‹å·¥å…·ç±»ï¼ˆä»…ç”Ÿäº§ç¯å¢ƒå¯ç”¨è½®è¯¢ï¼Œå†…ç½®ç¯å¢ƒåˆ¤æ–­ï¼‰
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">VersionUpdate</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">versionFileUrl</span>: <span class="hljs-string">'/version.json'</span>, <span class="hljs-comment">// ç‰ˆæœ¬æ–‡ä»¶åœ°å€</span>
      <span class="hljs-attr">localVersionKey</span>: <span class="hljs-string">'cmpVersion'</span>, <span class="hljs-comment">// æœ¬åœ°å­˜å‚¨çš„ç‰ˆæœ¬å·key</span>
      <span class="hljs-attr">disableFetchCache</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ç¦ç”¨Fetchç¼“å­˜</span>
      <span class="hljs-attr">pollInterval</span>: <span class="hljs-number">5</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>, <span class="hljs-comment">// 5åˆ†é’Ÿè½®è¯¢ä¸€æ¬¡</span>
      <span class="hljs-attr">hasNotified</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// æ˜¯å¦å·²æé†’è¿‡ç”¨æˆ·æœ‰æ–°ç‰ˆæœ¬</span>
    }
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>, options)
    <span class="hljs-comment">// å®šæ—¶è½®è¯¢å®šæ—¶å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pollTimer</span> = <span class="hljs-literal">null</span>
    <span class="hljs-comment">// è¯†åˆ«å½“å‰ç¯å¢ƒï¼ˆVue CLI 4 è‡ªåŠ¨æ³¨å…¥çš„ç¯å¢ƒå˜é‡ï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProduction</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">'production'</span>
  }

  <span class="hljs-comment">/**
   * æ ¸å¿ƒæ–¹æ³•ï¼šæ‰§è¡Œç‰ˆæœ¬æ£€æµ‹
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">checkVersion</span>(<span class="hljs-params">isInit = <span class="hljs-literal">false</span></span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">hasNotified</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>

      <span class="hljs-keyword">const</span> localVersion = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">localVersionKey</span>) || <span class="hljs-string">''</span>
      <span class="hljs-keyword">const</span> fetchOptions = {}
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">disableFetchCache</span>) {
        fetchOptions.<span class="hljs-property">cache</span> = <span class="hljs-string">'no-cache'</span>
      }

      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">versionFileUrl</span>, fetchOptions)
      <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`ç‰ˆæœ¬æ–‡ä»¶è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š<span class="hljs-subst">${response.status}</span>`</span>)
      }
      <span class="hljs-keyword">const</span> latestVersionInfo = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>()
      <span class="hljs-keyword">const</span> serverVersion = latestVersionInfo.<span class="hljs-property">version</span>

      <span class="hljs-keyword">if</span> (isInit) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheLatestVersion</span>(serverVersion)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      }

      <span class="hljs-keyword">if</span> (serverVersion &amp;&amp; serverVersion !== localVersion) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">hasNotified</span> = <span class="hljs-literal">true</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ‰æ–°ç‰ˆæœ¬å¯ç”¨'</span>, latestVersionInfo)
        <span class="hljs-title class_">Notification</span>({
          <span class="hljs-attr">title</span>: <span class="hljs-string">'ğŸ‰ æœ‰æ–°ç‰ˆæœ¬å¯ç”¨'</span>,
          <span class="hljs-attr">dangerouslyUseHTMLString</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">message</span>: <span class="hljs-string">`&lt;p style="font-size:12px;"&gt;å»ºè®®ç‚¹å‡»åˆ·æ–°é¡µé¢ï¼Œä»¥è·å–æœ€æ–°åŠŸèƒ½å’Œä¿®å¤&lt;/p&gt; &lt;p style="color:#cccccc;font-size:12px;"&gt;æ›´æ–°æ—¶é—´ï¼š<span class="hljs-subst">${latestVersionInfo.updateTime}</span>&lt;/p&gt;`</span>,
          <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span>,
          <span class="hljs-attr">customClass</span>: <span class="hljs-string">'check-version-notify'</span>,
          <span class="hljs-attr">onClick</span>: <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">forceRefreshPage</span>()
          },
          <span class="hljs-attr">onClose</span>: <span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resetNotifyFlag</span>()
          }
        })
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ç‰ˆæœ¬ä¸€è‡´æ—¶ï¼Œé‡ç½®æé†’æ ‡è®°ï¼Œä¾¿äºåç»­è½®è¯¢æ£€æµ‹æ–°ç‰ˆæœ¬</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">hasNotified</span> = <span class="hljs-literal">false</span>
        <span class="hljs-comment">// console.log('å½“å‰å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œå·²ç¼“å­˜æœ€æ–°ç‰ˆæœ¬å·')</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'ç‰ˆæœ¬æ£€æµ‹å¼‚å¸¸ï¼Œä¸å½±å“åº”ç”¨è¿è¡Œï¼š'</span>, error.<span class="hljs-property">message</span>)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
    }
  }
  <span class="hljs-comment">/**
   * å¯åŠ¨å®šæ—¶è½®è¯¢æ£€æµ‹ï¼ˆå†…ç½®ç¯å¢ƒåˆ¤æ–­ï¼šä»…ç”Ÿäº§ç¯å¢ƒç”Ÿæ•ˆï¼‰
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">startPolling</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ ¸å¿ƒï¼šéç”Ÿäº§ç¯å¢ƒï¼Œç›´æ¥è¿”å›ï¼Œä¸å¯åŠ¨è½®è¯¢</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProduction</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å½“å‰ä¸ºéç”Ÿäº§ç¯å¢ƒï¼Œä¸å¯åŠ¨ç‰ˆæœ¬æ£€æµ‹è½®è¯¢'</span>)
      <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒï¼šæ­£å¸¸å¯åŠ¨è½®è¯¢</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">stopPolling</span>() <span class="hljs-comment">// å…ˆåœæ­¢å·²æœ‰è½®è¯¢ï¼Œé¿å…é‡å¤å¯åŠ¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkVersion</span>(<span class="hljs-literal">true</span>) <span class="hljs-comment">// ç«‹å³æ‰§è¡Œä¸€æ¬¡æ£€æµ‹</span>

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pollTimer</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkVersion</span>()
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">pollInterval</span>)

    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ç”Ÿäº§ç¯å¢ƒç‰ˆæœ¬è½®è¯¢æ£€æµ‹å·²å¯åŠ¨ï¼Œæ¯éš”<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.config.pollInterval / <span class="hljs-number">1000</span> / <span class="hljs-number">60</span>}</span>åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡`</span>)
  }

  <span class="hljs-comment">/**
   * åœæ­¢å®šæ—¶è½®è¯¢æ£€æµ‹
   */</span>
  <span class="hljs-title function_">stopPolling</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">pollTimer</span>) {
      <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pollTimer</span>)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pollTimer</span> = <span class="hljs-literal">null</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç‰ˆæœ¬è½®è¯¢æ£€æµ‹å·²åœæ­¢'</span>)
    }
  }

  <span class="hljs-comment">/**
   * é‡ç½®æé†’æ ‡è®°
   */</span>
  <span class="hljs-title function_">resetNotifyFlag</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">hasNotified</span> = <span class="hljs-literal">false</span>
  }

  <span class="hljs-comment">// ç¼“å­˜æœ€æ–°ç‰ˆæœ¬å·</span>
  <span class="hljs-title function_">cacheLatestVersion</span>(<span class="hljs-params">version</span>) {
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">localVersionKey</span>, version)
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">resetNotifyFlag</span>()
  }

  <span class="hljs-comment">// å¼ºåˆ¶åˆ·æ–°é¡µé¢</span>
  <span class="hljs-title function_">forceRefreshPage</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-title function_">reload</span>(<span class="hljs-literal">true</span>)
  }
}

<span class="hljs-keyword">const</span> versionUpdateInstance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VersionUpdate</span>()
<span class="hljs-keyword">export</span> { <span class="hljs-title class_">VersionUpdate</span>, versionUpdateInstance }
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> versionUpdateInstance

</code></pre>
<p>åˆ›å»ºè‡ªå®šä¹‰<code>.check-version-notify</code>çš„ç‰ˆæœ¬æ£€æµ‹å…¨å±€æ ·å¼ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8070ccb4ebe4a028f3aabab68afeafd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Kqw5Zyo6Iqx6YeM6IOh5ZOo:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770531199&amp;x-signature=J1pi0sKApxNPUvXlsJ5PxfqK%2FH0%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ç‰ˆæœ¬æ£€æµ‹é€šçŸ¥æ ·å¼</span>
<span class="hljs-selector-class">.check-version-notify</span>{
  <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid transparent <span class="hljs-meta">!important</span>;
  <span class="hljs-attribute">cursor</span>: pointer;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.6</span>) <span class="hljs-meta">!important</span>;
  backdrop-<span class="hljs-attribute">filter</span>: <span class="hljs-built_in">blur</span>(<span class="hljs-number">5px</span>);
  &amp;<span class="hljs-selector-pseudo">:hover</span>{
    <span class="hljs-attribute">border</span>: <span class="hljs-number">3px</span> solid <span class="hljs-variable">$--color-primary</span> <span class="hljs-meta">!important</span>;
  }
  <span class="hljs-selector-class">.el-notification__icon</span>{
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">18px</span>;
  }
  <span class="hljs-selector-class">.el-notification__title</span>{
    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">18px</span>;
  }
  <span class="hljs-selector-class">.el-notification__group</span>{
    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">8px</span>;
  }
}
</code></pre>
<h3 data-id="heading-15">æ­¥éª¤äº”ï¼šåœ¨åº”ç”¨å…¥å£å¯åŠ¨ç‰ˆæœ¬æ£€æµ‹</h3>
<p>åœ¨Â <code>App.vue</code>Â æˆ–åˆé€‚çš„å…¥å£æ–‡ä»¶ä¸­å¯åŠ¨ç‰ˆæœ¬æ£€æµ‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> versionUpdate <span class="hljs-keyword">from</span> <span class="hljs-string">'@/utils/versionUpdate'</span>
...
<span class="hljs-title function_">mounted</span>(<span class="hljs-params"/>) {
  versionUpdate.<span class="hljs-title function_">startPolling</span>()
},
<span class="hljs-title function_">beforeDestroy</span>(<span class="hljs-params"/>) {
  versionUpdate.<span class="hljs-title function_">stopPolling</span>()
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºé«˜æ€§èƒ½ç”Ÿæˆå¼AIåº”ç”¨ï¼šåŸºäºRust Axumä¸è“è€˜DeepSeek-V3.2å¤§æ¨¡å‹æœåŠ¡çš„å…¨æ ˆå¼€å‘å®æˆ˜]]></title>    <link>https://juejin.cn/post/7601069677567049774</link>    <guid>https://juejin.cn/post/7601069677567049774</guid>    <pubDate>2026-01-31T18:05:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601069677567049774" data-draft-id="7601144981169913906" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºé«˜æ€§èƒ½ç”Ÿæˆå¼AIåº”ç”¨ï¼šåŸºäºRust Axumä¸è“è€˜DeepSeek-V3.2å¤§æ¨¡å‹æœåŠ¡çš„å…¨æ ˆå¼€å‘å®æˆ˜"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-31T18:05:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜¯ä½ çš„å°æé¾™å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/4118085375365891"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºé«˜æ€§èƒ½ç”Ÿæˆå¼AIåº”ç”¨ï¼šåŸºäºRust Axumä¸è“è€˜DeepSeek-V3.2å¤§æ¨¡å‹æœåŠ¡çš„å…¨æ ˆå¼€å‘å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4118085375365891/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜¯ä½ çš„å°æé¾™å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T18:05:28.000Z" title="Sat Jan 31 2026 18:05:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å½“å‰ç”Ÿæˆå¼äººå·¥æ™ºèƒ½è“¬å‹ƒå‘å±•çš„æŠ€æœ¯æµªæ½®ä¸­ï¼Œæ„å»ºé«˜æ•ˆã€å®‰å…¨ä¸”å“åº”è¿…é€Ÿçš„AIåº”ç”¨åç«¯å·²æˆä¸ºå¼€å‘è€…çš„æ ¸å¿ƒè¯‰æ±‚ã€‚Rustè¯­è¨€å‡­å€Ÿå…¶å†…å­˜å®‰å…¨ã€é›¶æˆæœ¬æŠ½è±¡ä»¥åŠæƒŠäººçš„æ‰§è¡Œæ•ˆç‡ï¼Œæ­£é€æ¸æˆä¸ºæ„å»ºé«˜æ€§èƒ½WebæœåŠ¡çš„é¦–é€‰è¯­è¨€ä¹‹ä¸€ã€‚ç»“åˆè“è€˜ï¼ˆLanyunï¼‰æä¾›çš„DeepSeekå¤§æ¨¡å‹MaaSï¼ˆModel as a Serviceï¼‰æœåŠ¡ï¼Œå¼€å‘è€…èƒ½å¤Ÿä»¥æä½çš„å»¶è¿Ÿå’Œæé«˜çš„ååé‡å¤„ç†å¤æ‚çš„è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ã€‚</p>
<p>æœ¬æ–‡å°†æ·±å…¥å‰–æå¦‚ä½•ä»é›¶å¼€å§‹ï¼Œåˆ©ç”¨Rustè¯­è¨€çš„Axumæ¡†æ¶ï¼Œé…åˆTokioå¼‚æ­¥è¿è¡Œæ—¶ï¼Œæ„å»ºä¸€ä¸ªèƒ½å¤Ÿæµå¼å¯¹æ¥DeepSeek V3å¤§æ¨¡å‹çš„å…¨æ ˆWebåº”ç”¨ã€‚æˆ‘ä»¬å°†è¯¦ç»†æ‹†è§£æ¯ä¸€ä¸ªå¼€å‘æ­¥éª¤ï¼Œä»åº•å±‚ç¯å¢ƒæ„å»ºåˆ°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å®ç°ï¼Œå†åˆ°å‰ç«¯æµå¼æ¸²æŸ“ï¼Œè¿›è¡Œå…¨æ–¹ä½çš„æŠ€æœ¯è§£è¯»ã€‚</p>
<h2 data-id="heading-1">ç¬¬ä¸€é˜¶æ®µï¼šåº•å±‚å¼€å‘ç¯å¢ƒçš„æ„å»ºä¸éªŒè¯</h2>
<p>æ„å»ºRuståº”ç”¨çš„ç¬¬ä¸€æ­¥æ˜¯ç¡®ä¿æ“ä½œç³»ç»Ÿå…·å¤‡å®Œæ•´çš„ç¼–è¯‘å·¥å…·é“¾ã€‚Rustç¼–è¯‘å™¨åœ¨å¤„ç†æŸäº›ä¾èµ–åŒ…ï¼ˆCrateï¼‰æ—¶ï¼Œå°¤å…¶æ˜¯æ¶‰åŠåˆ°ç³»ç»Ÿåº•å±‚äº¤äº’æˆ–åŠ å¯†åº“ï¼ˆå¦‚OpenSSLã€Ringç­‰ï¼‰æ—¶ï¼Œå¾€å¾€éœ€è¦è°ƒç”¨ç³»ç»Ÿçš„Cè¯­è¨€é“¾æ¥å™¨ã€‚</p>
<h3 data-id="heading-2">1.1 ç³»ç»ŸåŸºç¡€æ„å»ºå·¥å…·çš„å®‰è£…</h3>
<p>åœ¨åŸºäºDebianæˆ–Ubuntuçš„Linuxç¯å¢ƒä¸­ï¼Œ<code>build-essential</code>è½¯ä»¶åŒ…æ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚å®ƒåŒ…å«äº†GCCç¼–è¯‘å™¨ã€Makeå·¥å…·ä»¥åŠGlibcå¼€å‘åº“å¤´æ–‡ä»¶ã€‚<code>curl</code>åˆ™ç”¨äºåç»­ä¸‹è½½å®‰è£…è„šæœ¬ã€‚</p>
<p>é€šè¿‡ç»ˆç«¯æ‰§è¡Œæ›´æ–°è½¯ä»¶æºå¹¶å®‰è£…æ„å»ºå·¥å…·çš„æŒ‡ä»¤ï¼Œèƒ½å¤Ÿç¡®ä¿åç»­çš„Rustå®‰è£…è¿‡ç¨‹ä¸ä¼šå› ç¼ºå°‘é“¾æ¥åº“è€Œä¸­æ–­ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">sudo apt update 
sudo apt install curl build-essential
</code></pre>
<p>æ‰§è¡Œä¸Šè¿°å‘½ä»¤åï¼Œç³»ç»ŸåŒ…ç®¡ç†å™¨å°†è§£æä¾èµ–æ ‘å¹¶å®Œæˆä¸‹è½½å®‰è£…ã€‚ä¸‹å›¾å±•ç¤ºäº†ç»ˆç«¯åœ¨æ‰§è¡Œå®‰è£…å‘½ä»¤åçš„çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°ç³»ç»ŸæˆåŠŸè¯»å–äº†è½¯ä»¶åŒ…åˆ—è¡¨ï¼Œå¹¶å‡†å¤‡è¿›è¡Œç¯å¢ƒçš„é…ç½®ã€‚è¿™æ˜¯Rustç¼–è¯‘ç¯å¢ƒèƒ½å¤Ÿé¡ºåˆ©è¿è¡Œçš„åŸºçŸ³ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b19ad6a5cae941ea98251c4b0558da8d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=reggkKNtI6Au%2B662vyV9dfxyLDA%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">1.2 Rustå·¥å…·é“¾çš„éƒ¨ç½²</h3>
<p>Rustå®˜æ–¹æä¾›äº†<code>rustup</code>ä½œä¸ºç‰ˆæœ¬ç®¡ç†å’Œå®‰è£…å·¥å…·ï¼Œè¿™æ˜¯ç®¡ç†Rustç”Ÿæ€æœ€æ¨èçš„æ–¹å¼ã€‚å®ƒä¸ä»…å®‰è£…ç¼–è¯‘å™¨<code>rustc</code>ï¼Œè¿˜ä¼šå®‰è£…åŒ…ç®¡ç†å™¨<code>cargo</code>ä»¥åŠæ–‡æ¡£å·¥å…·<code>rustdoc</code>ã€‚</p>
<p>é€šè¿‡æ‰§è¡Œå®˜æ–¹çš„Shellè„šæœ¬ï¼Œå¯ä»¥å¯åŠ¨è‡ªåŠ¨åŒ–çš„å®‰è£…æµç¨‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">curl --proto <span class="hljs-string">'=https'</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh
</code></pre>
<p>è¯¥è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰æ“ä½œç³»ç»Ÿæ¶æ„ï¼Œä¸‹è½½å¯¹åº”çš„é¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å®ƒå°†å®‰è£…æœ€æ–°çš„Stableï¼ˆç¨³å®šï¼‰ç‰ˆæœ¬ï¼Œè¿™æ˜¯ç”Ÿäº§ç¯å¢ƒå¼€å‘çš„é¦–é€‰ã€‚</p>
<p>å®‰è£…è„šæœ¬æ‰§è¡Œå®Œæ¯•åï¼Œç»ˆç«¯ä¼šè¾“å‡ºå®‰è£…æˆåŠŸçš„æ‘˜è¦ä¿¡æ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œç³»ç»Ÿæç¤ºRustå·²æˆåŠŸå®‰è£…ï¼Œå¹¶ä¸”ç›¸å…³äºŒè¿›åˆ¶æ–‡ä»¶å·²è¢«æ”¾ç½®åœ¨ç”¨æˆ·çš„<code>.cargo/bin</code>ç›®å½•ä¸‹ã€‚è¯¥ç›®å½•æ˜¯Rustç”Ÿæ€å·¥å…·çš„æ ¸å¿ƒå­˜æ”¾ä½ç½®ï¼Œç¡®ä¿å…¶è¢«åŠ å…¥ç³»ç»Ÿç¯å¢ƒå˜é‡<code>PATH</code>ä¸­è‡³å…³é‡è¦ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ddff7f16f4448d9ba106681ff5f2b66~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=iiRb7t1YtQ4mPaYEnlzaZq3aDnQ%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">1.3 ç¯å¢ƒå˜é‡çš„åŠ è½½ä¸éªŒè¯</h3>
<p>è™½ç„¶å®‰è£…è„šæœ¬é€šå¸¸ä¼šè‡ªåŠ¨ä¿®æ”¹Shellçš„é…ç½®æ–‡ä»¶ï¼ˆå¦‚<code>.bashrc</code>æˆ–<code>.zshrc</code>ï¼‰ï¼Œä½†åœ¨å½“å‰ç»ˆç«¯ä¼šè¯ä¸­ï¼Œå˜æ›´ä¸ä¼šç«‹å³ç”Ÿæ•ˆã€‚ä¸ºäº†ç«‹å³ä½¿ç”¨<code>cargo</code>å‘½ä»¤ï¼Œéœ€è¦æ‰‹åŠ¨åŠ è½½ç¯å¢ƒé…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">. <span class="hljs-string">"<span class="hljs-variable">$HOME</span>/.cargo/env"</span>
</code></pre>
<p>éšåï¼Œé€šè¿‡æ£€æŸ¥ç¼–è¯‘å™¨å’ŒåŒ…ç®¡ç†å™¨çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ç¯å¢ƒæ˜¯å¦é…ç½®æ­£ç¡®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">rustc --version
cargo --version
</code></pre>
<p>ä¸‹å›¾å±•ç¤ºäº†ç‰ˆæœ¬éªŒè¯çš„è¾“å‡ºç»“æœã€‚å¯ä»¥çœ‹åˆ°å½“å‰å®‰è£…çš„æ˜¯Rust 1.84.0ç‰ˆæœ¬ã€‚èƒ½å¤Ÿæ­£ç¡®æ‰“å°å‡ºç‰ˆæœ¬å·ï¼Œæ ‡å¿—ç€Rustå¼€å‘ç¯å¢ƒå·²ç»å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥å¼€å§‹åç»­çš„é¡¹ç›®æ„å»ºã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aad0cdd9ca1144f5af06ce1866ddf2ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=bxzKKyIE%2BLb68FnVZJ1fsYI87K8%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸ºäº†ç¡®ä¿æ¯æ¬¡ç™»å½•ç»ˆç«¯æ—¶Rustç¯å¢ƒéƒ½èƒ½è‡ªåŠ¨åŠ è½½ï¼Œå°†åŠ è½½å‘½ä»¤è¿½åŠ åˆ°<code>.bashrc</code>æ–‡ä»¶ä¸­æ˜¯ä¸€ä¸ªç¨³å¥çš„åšæ³•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">'. "$HOME/.cargo/env"'</span> &gt;&gt; ~/.bashrc
</code></pre>
<p>è¿™ä¸€æ“ä½œç¡®ä¿äº†ç¯å¢ƒå˜é‡çš„æŒä¹…åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé€šè¿‡è¿½åŠ é‡å®šå‘æ“ä½œç¬¦ï¼Œé…ç½®è¢«å†™å…¥äº†ç”¨æˆ·çš„Shellå¯åŠ¨è„šæœ¬ä¸­ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7677594dd8b047c2b58b9a85324e7552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=cVvytTF2Zpww%2Bljc%2FQ2LZxSOc9k%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-5">ç¬¬äºŒé˜¶æ®µï¼šè“è€˜MaaSæœåŠ¡å‡­è¯é…ç½®</h2>
<p>åœ¨å¼€å§‹ç¼–å†™ä»£ç ä¹‹å‰ï¼Œè·å–å¤§æ¨¡å‹æœåŠ¡çš„è®¿é—®æƒé™æ˜¯å¿…è¦ç¯èŠ‚ã€‚è“è€˜å¹³å°æä¾›äº†æ ‡å‡†åŒ–çš„APIæ¥å£ï¼Œå…¼å®¹OpenAIè§„èŒƒï¼Œæå¤§é™ä½äº†æ¥å…¥éš¾åº¦ã€‚</p>
<p>é¦–å…ˆéœ€è¦åœ¨è“è€˜å¹¿åœºæ§åˆ¶å°ç”ŸæˆAPI Keyã€‚è¿™ä¸ªå¯†é’¥æ˜¯åº”ç”¨ä¸å¤§æ¨¡å‹æœåŠ¡è¿›è¡Œå®‰å…¨é€šä¿¡çš„å‡­è¯ï¼Œå¿…é¡»å¦¥å–„ä¿ç®¡ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ§åˆ¶å°ç•Œé¢æä¾›äº†ç›´è§‚çš„å¯†é’¥ç®¡ç†åŠŸèƒ½ï¼Œæ–°ç”Ÿæˆçš„API Keyå°†ç”¨äºåç»­çš„ç¯å¢ƒå˜é‡é…ç½®ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">https://console.lanyun.net/<span class="hljs-comment">#/register?promoterCode=0131</span>
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4ab25a80edc4ebc8b05ef9bcc2325db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=JSKYJa3KcOCH1igMcM774NiSzao%3D" alt="image.png" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥æ˜¯é€‰æ‹©åˆé€‚çš„æ¨¡å‹ã€‚æœ¬é¡¹ç›®é€‰ç”¨<code>/maas/deepseek-ai/DeepSeek-V3.2</code>ã€‚DeepSeek V3æ¨¡å‹åœ¨è‡ªç„¶è¯­è¨€ç†è§£å’Œç”Ÿæˆä»£ç æ–¹é¢è¡¨ç°ä¼˜å¼‚ï¼Œä¸”é€šè¿‡è“è€˜çš„MaaSæ¶æ„ï¼Œèƒ½å¤Ÿæä¾›æä½çš„æ¨ç†å»¶è¿Ÿã€‚ä¸‹å›¾å±•ç¤ºäº†æ¨¡å‹é€‰æ‹©ç•Œé¢ï¼Œæ˜ç¡®äº†è°ƒç”¨çš„æ¨¡å‹æ ‡è¯†ç¬¦ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b51d3be4879c4ccd9ee6ed804c06a821~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=pztna79Bxqxb5vVt6PgqnYmo%2BPc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">ç¬¬ä¸‰é˜¶æ®µï¼šRusté¡¹ç›®æ¶æ„ä¸ä¾èµ–ç®¡ç†</h2>
<p>Rustçš„é¡¹ç›®ç»“æ„ä»¥æ¸…æ™°è‘—ç§°ã€‚æœ¬é¡¹ç›®å°†é‡‡ç”¨æ ‡å‡†çš„Cargoé¡¹ç›®ç»“æ„ï¼Œå¹¶è¿›è¡Œç»†åˆ†æ¨¡å—åŒ–è®¾è®¡ï¼Œä»¥å®ç°é«˜å†…èšä½è€¦åˆçš„ä»£ç ç»„ç»‡ã€‚</p>
<h3 data-id="heading-7">3.1 ç›®å½•ç»“æ„åˆå§‹åŒ–</h3>
<p>åœ¨æœåŠ¡å™¨ç«¯ï¼Œé¦–å…ˆåˆ›å»ºé¡¹ç›®æ ¹ç›®å½•åŠå¿…è¦çš„å­ç›®å½•ã€‚åˆç†çš„ç›®å½•ç»“æ„æœ‰åŠ©äºä»£ç çš„ç»´æŠ¤å’Œæ‰©å±•ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> ~
<span class="hljs-built_in">mkdir</span> -p rust-deepseek-web
<span class="hljs-built_in">cd</span> rust-deepseek-web
<span class="hljs-built_in">mkdir</span> -p src/api src/services src/models static/css static/js
</code></pre>
<p><code>src/api</code>ç”¨äºå­˜æ”¾HTTPè·¯ç”±å¤„ç†é€»è¾‘ï¼Œ<code>src/services</code>ç”¨äºå°è£…ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚è°ƒç”¨ç¬¬ä¸‰æ–¹APIï¼‰ï¼Œ<code>src/models</code>ç”¨äºå®šä¹‰æ•°æ®ç»“æ„ï¼Œ<code>static</code>åˆ™ç”¨äºå­˜æ”¾å‰ç«¯é™æ€èµ„æºã€‚ä¸‹å›¾å±•ç¤ºäº†åˆ›å»ºå®Œæˆåçš„ç›®å½•å±‚çº§ï¼Œè¿™ç§ç»“æ„ä¸ºåç»­çš„ä»£ç å¡«å……å¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4dd5a5280aa7413c86ab59998ca017c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=rOBDCtPyOWoBEGByqhJVYqJ4mZ8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">3.2 æ ¸å¿ƒä¾èµ–é…ç½® (Cargo.toml)</h3>
<p><code>Cargo.toml</code>æ˜¯Rusté¡¹ç›®çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ã€‚æœ¬é¡¹ç›®å¼•å…¥äº†ä¸€ç³»åˆ—é«˜æ€§èƒ½çš„å¼‚æ­¥ç”Ÿæ€åº“ï¼š</p>
<ul>
<li><strong>axum (0.7)</strong>: å½“å‰Rustç”Ÿæ€ä¸­æœ€æµè¡Œçš„Webæ¡†æ¶ä¹‹ä¸€ï¼ŒåŸºäºTokioæ„å»ºï¼Œæä¾›ç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„APIè®¾è®¡ã€‚</li>
<li><strong>tokio (full)</strong>: å¼ºå¤§çš„å¼‚æ­¥è¿è¡Œæ—¶ï¼Œè´Ÿè´£ä»»åŠ¡è°ƒåº¦ã€I/Oæ“ä½œã€‚</li>
<li><strong>reqwest</strong>: å…¨åŠŸèƒ½çš„HTTPå®¢æˆ·ç«¯ï¼Œæ”¯æŒå¼‚æ­¥è°ƒç”¨å’Œæµå¼å“åº”å¤„ç†ï¼Œç”¨äºä¸DeepSeek APIé€šä¿¡ã€‚</li>
<li><strong>serde &amp; serde_json</strong>: åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ¡†æ¶ï¼Œå¤„ç†JSONæ•°æ®çš„æ ¸å¿ƒå·¥å…·ã€‚</li>
<li><strong>tracing</strong>: ç»“æ„åŒ–æ—¥å¿—è®°å½•ç³»ç»Ÿï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒçš„ç›‘æ§ä¸è°ƒè¯•ã€‚</li>
<li><strong>dotenv</strong>: ç”¨äºåŠ è½½<code>.env</code>æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡ï¼Œå®ç°é…ç½®ä¸ä»£ç åˆ†ç¦»ã€‚</li>
<li><strong>futures &amp; async-stream</strong>: å¤„ç†å¼‚æ­¥æµï¼ˆStreamï¼‰çš„å…³é”®åº“ï¼Œæ˜¯å®ç°æ‰“å­—æœºæ•ˆæœï¼ˆæµå¼è¾“å‡ºï¼‰çš„åŸºç¡€ã€‚</li>
</ul>
<p>é€šè¿‡ç¼–å†™<code>Cargo.toml</code>æ–‡ä»¶ï¼Œå£°æ˜äº†é¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰å¤–éƒ¨ä¾èµ–åŠå…¶ç‰¹æ€§æ ‡å¿—ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">
<span class="hljs-built_in">cat</span> &gt; Cargo.toml &lt;&lt; <span class="hljs-string">'EOF'</span>

[package]

name = <span class="hljs-string">"rust-deepseek-web"</span>

version = <span class="hljs-string">"0.1.0"</span>

edition = <span class="hljs-string">"2021"</span>

  

[dependencies]

axum = <span class="hljs-string">"0.7"</span>

tokio = { version = <span class="hljs-string">"1"</span>, features = [<span class="hljs-string">"full"</span>] }

tower = <span class="hljs-string">"0.4"</span>

tower-http = { version = <span class="hljs-string">"0.5"</span>, features = [<span class="hljs-string">"fs"</span>, <span class="hljs-string">"cors"</span>, <span class="hljs-string">"trace"</span>] }

reqwest = { version = <span class="hljs-string">"0.11"</span>, features = [<span class="hljs-string">"json"</span>, <span class="hljs-string">"stream"</span>] }

serde = { version = <span class="hljs-string">"1.0"</span>, features = [<span class="hljs-string">"derive"</span>] }

serde_json = <span class="hljs-string">"1.0"</span>

dotenv = <span class="hljs-string">"0.15"</span>

tracing = <span class="hljs-string">"0.1"</span>

tracing-subscriber = { version = <span class="hljs-string">"0.3"</span>, features = [<span class="hljs-string">"env-filter"</span>] }

anyhow = <span class="hljs-string">"1.0"</span>

thiserror = <span class="hljs-string">"1.0"</span>

futures = <span class="hljs-string">"0.3"</span>

tokio-stream = <span class="hljs-string">"0.1"</span>

async-stream = <span class="hljs-string">"0.3"</span>

  

[profile.release]

opt-level = 3

lto = <span class="hljs-literal">true</span>

codegen-units = 1

strip = <span class="hljs-literal">true</span>

EOF
</code></pre>
<h3 data-id="heading-9">3.3 ç¯å¢ƒå˜é‡é…ç½® (.env)</h3>
<p>ä¸ºäº†é¿å…å°†æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚API Keyï¼‰ç¡¬ç¼–ç åœ¨æºç ä¸­ï¼Œä½¿ç”¨<code>.env</code>æ–‡ä»¶è¿›è¡Œç®¡ç†æ˜¯è¡Œä¸šæœ€ä½³å®è·µã€‚è¯¥æ–‡ä»¶åŒ…å«äº†APIå¯†é’¥ã€APIåœ°å€ã€æ¨¡å‹åç§°ä»¥åŠæœåŠ¡ç›‘å¬çš„ç«¯å£é…ç½®ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">DEEPSEEK_API_KEY=sk-your-api-key-here
DEEPSEEK_API_URL=https://maas-api.lanyun.net/v1/
DEEPSEEK_MODEL=/maas/deepseek-ai/DeepSeek-V3.2
SERVER_HOST=0.0.0.0
SERVER_PORT=3000
RUST_LOG=info
</code></pre>
<p>ä¸‹å›¾å±•ç¤ºäº†é…ç½®æ–‡ä»¶çš„å†…å®¹é¢„è§ˆã€‚æ­£ç¡®é…ç½®è¯¥æ–‡ä»¶æ˜¯æœåŠ¡èƒ½å¤ŸæˆåŠŸé‰´æƒå¹¶è·¯ç”±åˆ°æ­£ç¡®æ¨¡å‹çš„å…³é”®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/88166373215e450cb7f3e2e2b50cc525~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=YQhW9b8u8tw54%2FkOxe9TD4aGUjs%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-10">ç¬¬å››é˜¶æ®µï¼šåç«¯æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å®ç°</h2>
<p>åç«¯å¼€å‘æ˜¯æœ¬é¡¹ç›®çš„é‡å¤´æˆï¼Œæ¶‰åŠåˆ°é…ç½®åŠ è½½ã€æ•°æ®æ¨¡å‹å®šä¹‰ã€å¤–éƒ¨æœåŠ¡é€šä¿¡ä»¥åŠAPIæ¥å£çš„å®ç°ã€‚</p>
<h3 data-id="heading-11">4.1 é…ç½®ç®¡ç†æ¨¡å— (src/config.rs)</h3>
<p><code>src/config.rs</code>æ¨¡å—è´Ÿè´£å°†ç¯å¢ƒå˜é‡åŠ è½½åˆ°å¼ºç±»å‹çš„Rustç»“æ„ä½“ä¸­ã€‚è¿™ç§åšæ³•åˆ©ç”¨äº†Rustçš„ç±»å‹ç³»ç»Ÿï¼Œåœ¨åº”ç”¨å¯åŠ¨é˜¶æ®µå°±èƒ½æ•è·é…ç½®é”™è¯¯ï¼ˆå¦‚ç¼ºå°‘Keyæˆ–ç«¯å£æ ¼å¼é”™è¯¯ï¼‰ï¼Œé˜²æ­¢åº”ç”¨åœ¨è¿è¡Œæ—¶å› é…ç½®é—®é¢˜å´©æºƒã€‚</p>
<p>ä»£ç ä¸­å®šä¹‰äº†<code>Config</code>ç»“æ„ä½“ï¼Œå¹¶å®ç°äº†<code>from_env</code>æ„é€ æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä½¿ç”¨<code>dotenv</code>åŠ è½½ç¯å¢ƒæ–‡ä»¶ï¼Œå¹¶é€šè¿‡<code>std::env::var</code>è¯»å–å˜é‡ã€‚å¯¹äºå¯é€‰é…ç½®ï¼ˆå¦‚HOSTï¼‰ï¼Œæä¾›äº†é»˜è®¤å€¼å›é€€æœºåˆ¶ï¼›å¯¹äºå¿…é¡»é…ç½®ï¼ˆå¦‚API Keyï¼‰ï¼Œåˆ™ä¼šè¿”å›é”™è¯¯ï¼Œç¡®ä¿å®‰å…¨æ€§ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">
<span class="hljs-built_in">cat</span> &gt; src/config.rs &lt;&lt; <span class="hljs-string">'EOF'</span>

use std::<span class="hljs-built_in">env</span>;

  

<span class="hljs-comment">#[derive(Debug, Clone)]</span>

pub struct Config {

    pub deepseek_api_key: String,

    pub deepseek_api_url: String,

    pub deepseek_model: String,

    pub server_host: String,

    pub server_port: u16,

}

  

impl Config {

    pub fn from_env() -&gt; Result&lt;Self, String&gt; {

        dotenv::dotenv().ok();

  

        <span class="hljs-built_in">let</span> deepseek_api_key = <span class="hljs-built_in">env</span>::var(<span class="hljs-string">"DEEPSEEK_API_KEY"</span>)

            .map_err(|_| <span class="hljs-string">"DEEPSEEK_API_KEY æœªè®¾ç½®"</span>.to_string())?;

  

        <span class="hljs-built_in">let</span> deepseek_api_url = <span class="hljs-built_in">env</span>::var(<span class="hljs-string">"DEEPSEEK_API_URL"</span>)

            .unwrap_or_else(|_| <span class="hljs-string">"https://api.deepseek.com/v1"</span>.to_string());

  

        <span class="hljs-built_in">let</span> deepseek_model = <span class="hljs-built_in">env</span>::var(<span class="hljs-string">"DEEPSEEK_MODEL"</span>)

            .unwrap_or_else(|_| <span class="hljs-string">"deepseek-chat"</span>.to_string());

  

        <span class="hljs-built_in">let</span> server_host = <span class="hljs-built_in">env</span>::var(<span class="hljs-string">"SERVER_HOST"</span>)

            .unwrap_or_else(|_| <span class="hljs-string">"127.0.0.1"</span>.to_string());

  

        <span class="hljs-built_in">let</span> server_port = <span class="hljs-built_in">env</span>::var(<span class="hljs-string">"SERVER_PORT"</span>)

            .unwrap_or_else(|_| <span class="hljs-string">"3000"</span>.to_string())

            .parse::&lt;u16&gt;()

            .map_err(|_| <span class="hljs-string">"SERVER_PORT å¿…é¡»æ˜¯æœ‰æ•ˆçš„ç«¯å£å·"</span>.to_string())?;

  

        Ok(Config {

            deepseek_api_key,

            deepseek_api_url,

            deepseek_model,

            server_host,

            server_port,

        })

    }

  

    pub fn server_address(&amp;self) -&gt; String {

        format!(<span class="hljs-string">"{}:{}"</span>, self.server_host, self.server_port)

    }

}

EOF
</code></pre>
<h3 data-id="heading-12">4.2 æ•°æ®æ¨¡å‹å®šä¹‰ (src/models)</h3>
<p>åœ¨<code>src/models</code>ç›®å½•ä¸‹ï¼Œ<code>chat.rs</code>å®šä¹‰äº†ä¸DeepSeek APIäº¤äº’æ‰€éœ€çš„æ‰€æœ‰JSONæ•°æ®ç»“æ„ã€‚</p>
<ul>
<li><strong>ChatRequest</strong>: å‰ç«¯å‘é€çš„è¯·æ±‚ä½“ï¼ŒåŒ…å«ç”¨æˆ·æ¶ˆæ¯ã€æ¨¡å¼ï¼ˆèŠå¤©/ä»£ç /æ–‡æ¡£ï¼‰ä»¥åŠå†å²ä¸Šä¸‹æ–‡ã€‚</li>
<li><strong>DeepSeekRequest</strong>: å‘é€ç»™å¤§æ¨¡å‹APIçš„è¯·æ±‚ä½“ï¼Œä¸¥æ ¼éµå¾ªOpenAI APIè§„èŒƒã€‚å…¶ä¸­<code>stream: bool</code>å­—æ®µå†³å®šäº†æ˜¯å¦å¼€å¯æµå¼ä¼ è¾“ã€‚</li>
<li><strong>DeepSeekResponse &amp; StreamChunk</strong>: åˆ†åˆ«å¯¹åº”éæµå¼å’Œæµå¼å“åº”çš„æ•°æ®ç»“æ„ã€‚ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯<code>StreamChunk</code>ï¼Œå®ƒç”¨äºè§£æSSEï¼ˆServer-Sent Eventsï¼‰æ¨é€çš„å¢é‡æ•°æ®ç‰‡æ®µã€‚</li>
</ul>
<p>ä½¿ç”¨<code>#[derive(Serialize, Deserialize)]</code>å®ï¼Œé…åˆ<code>serde</code>åº“ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å¤„ç†JSONå­—ç¬¦ä¸²ä¸Rustç»“æ„ä½“ä¹‹é—´çš„è½¬æ¢ï¼Œæå¤§åœ°ç®€åŒ–äº†æ•°æ®å¤„ç†æµç¨‹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">
<span class="hljs-built_in">cat</span> &gt; src/models/mod.rs &lt;&lt; <span class="hljs-string">'EOF'</span>

pub mod chat;

EOF
</code></pre>
<h3 data-id="heading-13">4.3 DeepSeekæœåŠ¡å±‚å°è£… (src/services/deepseek.rs)</h3>
<p>è¿™æ˜¯è¿æ¥æœ¬åœ°æœåŠ¡ä¸è¿œç«¯å¤§æ¨¡å‹çš„æ¡¥æ¢ã€‚<code>DeepSeekService</code>ç»“æ„ä½“æŒæœ‰HTTPå®¢æˆ·ç«¯å’Œé…ç½®ä¿¡æ¯ã€‚</p>
<p>è¯¥æœåŠ¡å®ç°äº†ä¸¤ä¸ªæ ¸å¿ƒæ–¹æ³•ï¼š</p>
<ol>
<li><strong>chat</strong>: å¤„ç†å¸¸è§„çš„ä¸€æ¬¡æ€§å“åº”è¯·æ±‚ã€‚</li>
<li><strong>chat_stream</strong>: å¤„ç†æµå¼å“åº”è¯·æ±‚ã€‚</li>
</ol>
<p>åœ¨<code>chat_stream</code>æ–¹æ³•ä¸­ï¼Œåˆ©ç”¨äº†<code>reqwest</code>çš„<code>bytes_stream()</code>åŠŸèƒ½è·å–åŸå§‹å­—èŠ‚æµã€‚ä»£ç é€šè¿‡<code>async-stream</code>å®æ„å»ºäº†ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œé€å—è¯»å–ç½‘ç»œæ•°æ®ã€‚ç”±äºSSEåè®®çš„æ•°æ®æ ¼å¼æ˜¯<code>data: {json}\n\n</code>ï¼Œè§£æé€»è¾‘éœ€è¦å¤„ç†ç¼“å†²åŒºï¼ŒæŒ‰è¡Œåˆ†å‰²æ•°æ®ï¼Œå‰”é™¤<code>data: </code>å‰ç¼€ï¼Œå¹¶è¯†åˆ«<code>[DONE]</code>ç»“æŸæ ‡è®°ã€‚è¿™ç§ç»†ç²’åº¦çš„æµå¤„ç†ç¡®ä¿äº†å‰ç«¯èƒ½å¤Ÿå®æ—¶æ¥æ”¶åˆ°AIç”Ÿæˆçš„æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œä¸æ˜¯ç­‰å¾…æ‰€æœ‰å†…å®¹ç”Ÿæˆå®Œæ¯•ã€‚</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src/services/deepseek.rs</span>

<span class="hljs-comment">// DeepSeek API å®¢æˆ·ç«¯æœåŠ¡</span>

  

<span class="hljs-keyword">use</span> crate::config::Config;

<span class="hljs-keyword">use</span> crate::models::chat::{DeepSeekRequest, DeepSeekResponse, Message, StreamChunk};

<span class="hljs-keyword">use</span> anyhow::{Context, <span class="hljs-type">Result</span>};

<span class="hljs-keyword">use</span> futures::stream::Stream;

<span class="hljs-keyword">use</span> reqwest::Client;

<span class="hljs-keyword">use</span> std::pin::Pin;

  

<span class="hljs-comment">/// DeepSeek æœåŠ¡å®¢æˆ·ç«¯</span>

<span class="hljs-meta">#[derive(Clone)]</span>

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">DeepSeekService</span> {

    client: Client,

    config: Config,

}

  

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">DeepSeekService</span> {

    <span class="hljs-comment">/// åˆ›å»ºæ–°çš„ DeepSeek æœåŠ¡å®ä¾‹</span>

    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(config: Config) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">client</span> = Client::<span class="hljs-title function_ invoke__">new</span>();

        <span class="hljs-keyword">Self</span> { client, config }

    }

  

    <span class="hljs-comment">/// å‘é€èŠå¤©è¯·æ±‚ï¼ˆéæµå¼ï¼‰</span>

    <span class="hljs-comment">///</span>

    <span class="hljs-comment">/// # å‚æ•°</span>

    <span class="hljs-comment">/// - `messages`: æ¶ˆæ¯å†å²åˆ—è¡¨</span>

    <span class="hljs-comment">///</span>

    <span class="hljs-comment">/// # è¿”å›</span>

    <span class="hljs-comment">/// - `Result&lt;String&gt;`: AI å›å¤å†…å®¹</span>

    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">chat</span>(&amp;<span class="hljs-keyword">self</span>, messages: <span class="hljs-type">Vec</span>&lt;Message&gt;) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>&gt; {

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">request</span> = DeepSeekRequest {

            model: <span class="hljs-keyword">self</span>.config.deepseek_model.<span class="hljs-title function_ invoke__">clone</span>(),

            messages,

            stream: <span class="hljs-literal">false</span>,

            temperature: <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-number">0.7</span>),

            max_tokens: <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-number">2000</span>),

        };

  

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">url</span> = <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}/chat/completions"</span>, <span class="hljs-keyword">self</span>.config.deepseek_api_url);

  

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = <span class="hljs-keyword">self</span>

            .client

            .<span class="hljs-title function_ invoke__">post</span>(&amp;url)

            .<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Authorization"</span>, <span class="hljs-built_in">format!</span>(<span class="hljs-string">"Bearer {}"</span>, <span class="hljs-keyword">self</span>.config.deepseek_api_key))

            .<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>)

            .<span class="hljs-title function_ invoke__">json</span>(&amp;request)

            .<span class="hljs-title function_ invoke__">send</span>()

            .<span class="hljs-keyword">await</span>

            .<span class="hljs-title function_ invoke__">context</span>(<span class="hljs-string">"å‘é€è¯·æ±‚åˆ° DeepSeek API å¤±è´¥"</span>)?;

  

        <span class="hljs-keyword">if</span> !response.<span class="hljs-title function_ invoke__">status</span>().<span class="hljs-title function_ invoke__">is_success</span>() {

            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">status</span> = response.<span class="hljs-title function_ invoke__">status</span>();

            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">error_text</span> = response.<span class="hljs-title function_ invoke__">text</span>().<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap_or_default</span>();

            anyhow::bail!(<span class="hljs-string">"DeepSeek API è¿”å›é”™è¯¯ {}: {}"</span>, status, error_text);

        }

  

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">deepseek_response</span>: DeepSeekResponse = response

            .<span class="hljs-title function_ invoke__">json</span>()

            .<span class="hljs-keyword">await</span>

            .<span class="hljs-title function_ invoke__">context</span>(<span class="hljs-string">"è§£æ DeepSeek API å“åº”å¤±è´¥"</span>)?;

  

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">content</span> = deepseek_response

            .choices

            .<span class="hljs-title function_ invoke__">first</span>()

            .<span class="hljs-title function_ invoke__">and_then</span>(|choice| <span class="hljs-title function_ invoke__">Some</span>(choice.message.content.<span class="hljs-title function_ invoke__">clone</span>()))

            .<span class="hljs-title function_ invoke__">unwrap_or_else</span>(|| <span class="hljs-string">"æ— å“åº”å†…å®¹"</span>.<span class="hljs-title function_ invoke__">to_string</span>());

  

        <span class="hljs-title function_ invoke__">Ok</span>(content)

    }

  

    <span class="hljs-comment">/// å‘é€èŠå¤©è¯·æ±‚ï¼ˆæµå¼ï¼‰</span>

    <span class="hljs-comment">///</span>

    <span class="hljs-comment">/// # å‚æ•°</span>

    <span class="hljs-comment">/// - `messages`: æ¶ˆæ¯å†å²åˆ—è¡¨</span>

    <span class="hljs-comment">///</span>

    <span class="hljs-comment">/// # è¿”å›</span>

    <span class="hljs-comment">/// - `Result&lt;impl Stream&gt;`: æµå¼å“åº”</span>

    <span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">chat_stream</span>(

        &amp;<span class="hljs-keyword">self</span>,

        messages: <span class="hljs-type">Vec</span>&lt;Message&gt;,

    ) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Pin&lt;<span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> Stream&lt;Item = <span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>&gt;&gt; + <span class="hljs-built_in">Send</span>&gt;&gt;&gt; {

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">request</span> = DeepSeekRequest {

            model: <span class="hljs-keyword">self</span>.config.deepseek_model.<span class="hljs-title function_ invoke__">clone</span>(),

            messages,

            stream: <span class="hljs-literal">true</span>,

            temperature: <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-number">0.7</span>),

            max_tokens: <span class="hljs-title function_ invoke__">Some</span>(<span class="hljs-number">2000</span>),

        };

  

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">url</span> = <span class="hljs-built_in">format!</span>(<span class="hljs-string">"{}/chat/completions"</span>, <span class="hljs-keyword">self</span>.config.deepseek_api_url);

  

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">response</span> = <span class="hljs-keyword">self</span>

            .client

            .<span class="hljs-title function_ invoke__">post</span>(&amp;url)

            .<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Authorization"</span>, <span class="hljs-built_in">format!</span>(<span class="hljs-string">"Bearer {}"</span>, <span class="hljs-keyword">self</span>.config.deepseek_api_key))

            .<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"application/json"</span>)

            .<span class="hljs-title function_ invoke__">json</span>(&amp;request)

            .<span class="hljs-title function_ invoke__">send</span>()

            .<span class="hljs-keyword">await</span>

            .<span class="hljs-title function_ invoke__">context</span>(<span class="hljs-string">"å‘é€æµå¼è¯·æ±‚åˆ° DeepSeek API å¤±è´¥"</span>)?;

  

        <span class="hljs-keyword">if</span> !response.<span class="hljs-title function_ invoke__">status</span>().<span class="hljs-title function_ invoke__">is_success</span>() {

            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">status</span> = response.<span class="hljs-title function_ invoke__">status</span>();

            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">error_text</span> = response.<span class="hljs-title function_ invoke__">text</span>().<span class="hljs-keyword">await</span>.<span class="hljs-title function_ invoke__">unwrap_or_default</span>();

            anyhow::bail!(<span class="hljs-string">"DeepSeek API è¿”å›é”™è¯¯ {}: {}"</span>, status, error_text);

        }

  

        <span class="hljs-comment">// åˆ›å»ºæµå¼å“åº”å¤„ç†å™¨</span>

        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">stream</span> = async_stream::stream! {

            <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">bytes_stream</span> = response.<span class="hljs-title function_ invoke__">bytes_stream</span>();

            <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">buffer</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">new</span>();

  

            <span class="hljs-keyword">use</span> futures::StreamExt;

  

            <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(chunk_result) = bytes_stream.<span class="hljs-title function_ invoke__">next</span>().<span class="hljs-keyword">await</span> {

                <span class="hljs-keyword">match</span> chunk_result {

                    <span class="hljs-title function_ invoke__">Ok</span>(chunk) =&gt; {

                        <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">chunk_str</span> = <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">from_utf8_lossy</span>(&amp;chunk);

                        buffer.<span class="hljs-title function_ invoke__">push_str</span>(&amp;chunk_str);

  

                        <span class="hljs-comment">// å¤„ç† SSE æ ¼å¼çš„æ•°æ®</span>

                        <span class="hljs-keyword">while</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(line_end) = buffer.<span class="hljs-title function_ invoke__">find</span>(<span class="hljs-string">'\n'</span>) {

                            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">line</span> = buffer[..line_end].<span class="hljs-title function_ invoke__">trim</span>().<span class="hljs-title function_ invoke__">to_string</span>();

                            buffer = buffer[line_end + <span class="hljs-number">1</span>..].<span class="hljs-title function_ invoke__">to_string</span>();

  

                            <span class="hljs-keyword">if</span> line.<span class="hljs-title function_ invoke__">starts_with</span>(<span class="hljs-string">"data: "</span>) {

                                <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">data</span> = &amp;line[<span class="hljs-number">6</span>..];

  

                                <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æ˜¯ç»“æŸæ ‡è®°</span>

                                <span class="hljs-keyword">if</span> data == <span class="hljs-string">"[DONE]"</span> {

                                    <span class="hljs-keyword">break</span>;

                                }

  

                                <span class="hljs-comment">// è§£æ JSON</span>

                                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Ok</span>(stream_chunk) = serde_json::from_str::&lt;StreamChunk&gt;(data) {

                                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(choice) = stream_chunk.choices.<span class="hljs-title function_ invoke__">first</span>() {

                                        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">Some</span>(content) = &amp;choice.delta.content {

                                            <span class="hljs-keyword">yield</span> <span class="hljs-title function_ invoke__">Ok</span>(content.<span class="hljs-title function_ invoke__">clone</span>());

                                        }

                                    }

                                }

                            }

                        }

                    }

                    <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; {

                        <span class="hljs-keyword">yield</span> <span class="hljs-title function_ invoke__">Err</span>(anyhow::anyhow!(<span class="hljs-string">"è¯»å–æµæ•°æ®å¤±è´¥: {}"</span>, e));

                        <span class="hljs-keyword">break</span>;

                    }

                }

            }

        };

  

        <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">pin</span>(stream))

    }

}
</code></pre>
<h3 data-id="heading-14">4.4 APIè·¯ç”±å¤„ç† (src/api)</h3>
<p><code>src/api</code>æ¨¡å—è´Ÿè´£å°†HTTPè¯·æ±‚æ˜ å°„åˆ°å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚</p>
<ul>
<li><strong>chat.rs</strong>: åŒ…å«äº†æ ¸å¿ƒçš„<code>chat_stream_handler</code>ã€‚è¯¥å¤„ç†å™¨æ¥æ”¶å‰ç«¯çš„JSONè¯·æ±‚ï¼Œè°ƒç”¨<code>DeepSeekService</code>è·å–æµå¯¹è±¡ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºAxumæ”¯æŒçš„<code>Sse</code>ï¼ˆServer-Sent Eventsï¼‰å“åº”æ ¼å¼ã€‚è¿™é‡Œä½¿ç”¨äº†<code>keep_alive</code>æœºåˆ¶ï¼Œé˜²æ­¢é•¿è¿æ¥ä¸­æ–­ã€‚åŒæ—¶ï¼Œæ ¹æ®è¯·æ±‚æ¨¡å¼ï¼ˆCoding/Documentï¼‰ï¼Œä¼šåœ¨æ¶ˆæ¯å†å²å‰æ³¨å…¥ä¸åŒçš„System Promptï¼ˆç³»ç»Ÿæç¤ºè¯ï¼‰ï¼Œä»¥è°ƒæ•´AIçš„å›ç­”é£æ ¼ã€‚</li>
</ul>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src/api/chat.rs</span>

<span class="hljs-comment">// èŠå¤© API è·¯ç”±å¤„ç†å™¨</span>

  

<span class="hljs-keyword">use</span> crate::models::chat::{ChatRequest, ChatResponse, Message};

<span class="hljs-keyword">use</span> crate::services::deepseek::DeepSeekService;

<span class="hljs-keyword">use</span> axum::{

    extract::State,

    http::StatusCode,

    response::{sse::Event, IntoResponse, Response, Sse},

    Json,

};

<span class="hljs-keyword">use</span> futures::stream::Stream;

<span class="hljs-keyword">use</span> std::convert::Infallible;

<span class="hljs-keyword">use</span> std::sync::Arc;

  

<span class="hljs-comment">/// åº”ç”¨çŠ¶æ€</span>

<span class="hljs-meta">#[derive(Clone)]</span>

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">AppState</span> {

    <span class="hljs-keyword">pub</span> deepseek_service: DeepSeekService,

}

  

<span class="hljs-comment">/// èŠå¤©æ¥å£ï¼ˆéæµå¼ï¼‰</span>

<span class="hljs-comment">///</span>

<span class="hljs-comment">/// POST /api/chat</span>

<span class="hljs-comment">/// æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯ï¼Œè¿”å› AI å›å¤</span>

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">chat_handler</span>(

    <span class="hljs-title function_ invoke__">State</span>(state): State&lt;Arc&lt;AppState&gt;&gt;,

    <span class="hljs-title function_ invoke__">Json</span>(request): Json&lt;ChatRequest&gt;,

) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Result</span>&lt;Json&lt;ChatResponse&gt;, (StatusCode, <span class="hljs-type">String</span>)&gt; {

    tracing::info!(<span class="hljs-string">"æ”¶åˆ°èŠå¤©è¯·æ±‚: {}"</span>, request.message);

  

    <span class="hljs-comment">// æ„å»ºæ¶ˆæ¯åˆ—è¡¨</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">messages</span> = request.history.<span class="hljs-title function_ invoke__">clone</span>();

  

    <span class="hljs-comment">// æ ¹æ®æ¨¡å¼æ·»åŠ ç³»ç»Ÿæç¤ºè¯</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">system_prompt</span> = <span class="hljs-title function_ invoke__">get_system_prompt</span>(&amp;request.mode);

    <span class="hljs-keyword">if</span> !system_prompt.<span class="hljs-title function_ invoke__">is_empty</span>() {

        messages.<span class="hljs-title function_ invoke__">insert</span>(

            <span class="hljs-number">0</span>,

            Message {

                role: <span class="hljs-string">"system"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),

                content: system_prompt,

            },

        );

    }

  

    <span class="hljs-comment">// æ·»åŠ ç”¨æˆ·æ¶ˆæ¯</span>

    messages.<span class="hljs-title function_ invoke__">push</span>(Message {

        role: <span class="hljs-string">"user"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),

        content: request.message.<span class="hljs-title function_ invoke__">clone</span>(),

    });

  

    <span class="hljs-comment">// è°ƒç”¨ DeepSeek API</span>

    <span class="hljs-keyword">match</span> state.deepseek_service.<span class="hljs-title function_ invoke__">chat</span>(messages).<span class="hljs-keyword">await</span> {

        <span class="hljs-title function_ invoke__">Ok</span>(response) =&gt; {

            tracing::info!(<span class="hljs-string">"AI å›å¤æˆåŠŸ"</span>);

            <span class="hljs-title function_ invoke__">Ok</span>(<span class="hljs-title function_ invoke__">Json</span>(ChatResponse {

                message: response,

                status: <span class="hljs-string">"success"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),

            }))

        }

        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; {

            tracing::error!(<span class="hljs-string">"AI å›å¤å¤±è´¥: {}"</span>, e);

            <span class="hljs-title function_ invoke__">Err</span>((

                StatusCode::INTERNAL_SERVER_ERROR,

                <span class="hljs-built_in">format!</span>(<span class="hljs-string">"AI å›å¤å¤±è´¥: {}"</span>, e),

            ))

        }

    }

}

  

<span class="hljs-comment">/// èŠå¤©æ¥å£ï¼ˆæµå¼ï¼‰</span>

<span class="hljs-comment">///</span>

<span class="hljs-comment">/// POST /api/chat/stream</span>

<span class="hljs-comment">/// æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯ï¼Œè¿”å›æµå¼ AI å›å¤</span>

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">chat_stream_handler</span>(

    <span class="hljs-title function_ invoke__">State</span>(state): State&lt;Arc&lt;AppState&gt;&gt;,

    <span class="hljs-title function_ invoke__">Json</span>(request): Json&lt;ChatRequest&gt;,

) <span class="hljs-punctuation">-&gt;</span> Response {

    tracing::info!(<span class="hljs-string">"æ”¶åˆ°æµå¼èŠå¤©è¯·æ±‚: {}"</span>, request.message);

  

    <span class="hljs-comment">// æ„å»ºæ¶ˆæ¯åˆ—è¡¨</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">messages</span> = request.history.<span class="hljs-title function_ invoke__">clone</span>();

  

    <span class="hljs-comment">// æ ¹æ®æ¨¡å¼æ·»åŠ ç³»ç»Ÿæç¤ºè¯</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">system_prompt</span> = <span class="hljs-title function_ invoke__">get_system_prompt</span>(&amp;request.mode);

    <span class="hljs-keyword">if</span> !system_prompt.<span class="hljs-title function_ invoke__">is_empty</span>() {

        messages.<span class="hljs-title function_ invoke__">insert</span>(

            <span class="hljs-number">0</span>,

            Message {

                role: <span class="hljs-string">"system"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),

                content: system_prompt,

            },

        );

    }

  

    <span class="hljs-comment">// æ·»åŠ ç”¨æˆ·æ¶ˆæ¯</span>

    messages.<span class="hljs-title function_ invoke__">push</span>(Message {

        role: <span class="hljs-string">"user"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),

        content: request.message.<span class="hljs-title function_ invoke__">clone</span>(),

    });

  

    <span class="hljs-comment">// è°ƒç”¨ DeepSeek API æµå¼æ¥å£</span>

    <span class="hljs-keyword">match</span> state.deepseek_service.<span class="hljs-title function_ invoke__">chat_stream</span>(messages).<span class="hljs-keyword">await</span> {

        <span class="hljs-title function_ invoke__">Ok</span>(stream) =&gt; {

            <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">sse_stream</span> = <span class="hljs-title function_ invoke__">create_sse_stream</span>(stream);

            Sse::<span class="hljs-title function_ invoke__">new</span>(sse_stream).<span class="hljs-title function_ invoke__">into_response</span>()

        }

        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; {

            tracing::error!(<span class="hljs-string">"æµå¼ AI å›å¤å¤±è´¥: {}"</span>, e);

            (

                StatusCode::INTERNAL_SERVER_ERROR,

                <span class="hljs-built_in">format!</span>(<span class="hljs-string">"æµå¼ AI å›å¤å¤±è´¥: {}"</span>, e),

            )

                .<span class="hljs-title function_ invoke__">into_response</span>()

        }

    }

}

  

<span class="hljs-comment">/// åˆ›å»º SSE æµ</span>

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">create_sse_stream</span>(

    stream: <span class="hljs-keyword">impl</span> <span class="hljs-title class_">Stream</span>&lt;Item = anyhow::<span class="hljs-type">Result</span>&lt;<span class="hljs-type">String</span>&gt;&gt; + <span class="hljs-built_in">Send</span> + <span class="hljs-symbol">'static</span>,

) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">impl</span> <span class="hljs-title class_">Stream</span>&lt;Item = <span class="hljs-type">Result</span>&lt;Event, Infallible&gt;&gt; {

    <span class="hljs-keyword">use</span> futures::StreamExt;

  

    stream.<span class="hljs-title function_ invoke__">map</span>(|result| <span class="hljs-keyword">match</span> result {

        <span class="hljs-title function_ invoke__">Ok</span>(content) =&gt; <span class="hljs-title function_ invoke__">Ok</span>(Event::<span class="hljs-title function_ invoke__">default</span>().<span class="hljs-title function_ invoke__">data</span>(content)),

        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; {

            tracing::error!(<span class="hljs-string">"æµå¼æ•°æ®é”™è¯¯: {}"</span>, e);

            <span class="hljs-title function_ invoke__">Ok</span>(Event::<span class="hljs-title function_ invoke__">default</span>().<span class="hljs-title function_ invoke__">data</span>(<span class="hljs-built_in">format!</span>(<span class="hljs-string">"[ERROR]: {}"</span>, e)))

        }

    })

}

  

<span class="hljs-comment">/// æ ¹æ®æ¨¡å¼è·å–ç³»ç»Ÿæç¤ºè¯</span>

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">get_system_prompt</span>(mode: &amp;<span class="hljs-type">str</span>) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">String</span> {

    <span class="hljs-keyword">match</span> mode {

        <span class="hljs-string">"code"</span> =&gt; {

            <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ç¼–ç¨‹åŠ©æ‰‹ã€‚è¯·æä¾›æ¸…æ™°ã€å‡†ç¡®çš„ä»£ç ç¤ºä¾‹å’Œè§£é‡Šã€‚\

            ä½¿ç”¨ Markdown æ ¼å¼è¾“å‡ºä»£ç å—ã€‚"</span>

                .<span class="hljs-title function_ invoke__">to_string</span>()

        }

        <span class="hljs-string">"document"</span> =&gt; {

            <span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæ–‡æ¡£åˆ†æä¸“å®¶ã€‚è¯·ä»”ç»†åˆ†ææ–‡æ¡£å†…å®¹ï¼Œ\

            æä¾›å‡†ç¡®çš„æ‘˜è¦å’Œè§è§£ã€‚"</span>

                .<span class="hljs-title function_ invoke__">to_string</span>()

        }

        _ =&gt; <span class="hljs-type">String</span>::<span class="hljs-title function_ invoke__">new</span>(), <span class="hljs-comment">// é»˜è®¤èŠå¤©æ¨¡å¼ä¸éœ€è¦ç‰¹æ®Šæç¤ºè¯</span>

    }

}
</code></pre>
<ul>
<li><strong>health.rs</strong>: æä¾›äº†ä¸€ä¸ªç®€å•çš„å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼Œç”¨äºç›‘æ§æœåŠ¡å­˜æ´»çŠ¶æ€ã€‚</li>
</ul>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src/api/health.rs</span>

<span class="hljs-comment">// å¥åº·æ£€æŸ¥ API</span>

  

<span class="hljs-keyword">use</span> axum::{http::StatusCode, Json};

<span class="hljs-keyword">use</span> serde::Serialize;

  

<span class="hljs-meta">#[derive(Serialize)]</span>

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">HealthResponse</span> {

    <span class="hljs-keyword">pub</span> status: <span class="hljs-type">String</span>,

    <span class="hljs-keyword">pub</span> message: <span class="hljs-type">String</span>,

}

  

<span class="hljs-comment">/// å¥åº·æ£€æŸ¥æ¥å£</span>

<span class="hljs-comment">///</span>

<span class="hljs-comment">/// GET /api/health</span>

<span class="hljs-keyword">pub</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">health_handler</span>() <span class="hljs-punctuation">-&gt;</span> (StatusCode, Json&lt;HealthResponse&gt;) {

    (

        StatusCode::OK,

        <span class="hljs-title function_ invoke__">Json</span>(HealthResponse {

            status: <span class="hljs-string">"ok"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),

            message: <span class="hljs-string">"æœåŠ¡è¿è¡Œæ­£å¸¸"</span>.<span class="hljs-title function_ invoke__">to_string</span>(),

        }),

    )

}
</code></pre>
<h3 data-id="heading-15">4.5 ä¸»ç¨‹åºå…¥å£ (src/main.rs)</h3>
<p><code>main.rs</code>æ˜¯å°†æ‰€æœ‰æ¨¡å—ä¸²è”èµ·æ¥çš„ä¸­æ¢ã€‚</p>
<ol>
<li><strong>æ—¥å¿—åˆå§‹åŒ–</strong>: é…ç½®<code>tracing_subscriber</code>ï¼Œå°†æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</li>
<li><strong>çŠ¶æ€å…±äº«</strong>: å°†<code>DeepSeekService</code>å®ä¾‹å°è£…åœ¨<code>Arc</code>ï¼ˆåŸå­å¼•ç”¨è®¡æ•°ï¼‰ä¸­ï¼Œä¼ é€’ç»™Axumçš„è·¯ç”±çŠ¶æ€ã€‚è¿™ä½¿å¾—å¤šçº¿ç¨‹å¼‚æ­¥ä»»åŠ¡å¯ä»¥å®‰å…¨åœ°å…±äº«åŒä¸€ä¸ªæœåŠ¡å®ä¾‹ã€‚</li>
<li><strong>CORSé…ç½®</strong>: è®¾ç½®è·¨åŸŸèµ„æºå…±äº«ç­–ç•¥ï¼Œå…è®¸å‰ç«¯è·¨åŸŸè°ƒç”¨ï¼ˆè™½ç„¶æœ¬é¡¹ç›®æ˜¯åŒæºéƒ¨ç½²ï¼Œä½†ä¿ç•™CORSé…ç½®å¢åŠ äº†çµæ´»æ€§ï¼‰ã€‚</li>
<li><strong>è·¯ç”±æ³¨å†Œ</strong>: å°†<code>/api/chat</code>ç­‰è·¯å¾„æ˜ å°„åˆ°å¯¹åº”çš„Handlerï¼Œå¹¶ä½¿ç”¨<code>NestService</code>æŒ‚è½½<code>static</code>ç›®å½•ï¼Œæä¾›é™æ€æ–‡ä»¶æœåŠ¡ã€‚</li>
<li><strong>æœåŠ¡å¯åŠ¨</strong>: ç»‘å®šTCPç«¯å£å¹¶å¯åŠ¨AxumæœåŠ¡ã€‚</li>
</ol>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// src/main.rs</span>

<span class="hljs-comment">// ä¸»ç¨‹åºå…¥å£</span>

  

<span class="hljs-keyword">mod</span> api;

<span class="hljs-keyword">mod</span> config;

<span class="hljs-keyword">mod</span> models;

<span class="hljs-keyword">mod</span> services;

  

<span class="hljs-keyword">use</span> crate::api::chat::{chat_handler, chat_stream_handler, AppState};

<span class="hljs-keyword">use</span> crate::api::health::health_handler;

<span class="hljs-keyword">use</span> crate::config::Config;

<span class="hljs-keyword">use</span> crate::services::deepseek::DeepSeekService;

<span class="hljs-keyword">use</span> axum::{

    routing::{get, post},

    Router,

};

<span class="hljs-keyword">use</span> std::sync::Arc;

<span class="hljs-keyword">use</span> tower_http::cors::{Any, CorsLayer};

<span class="hljs-keyword">use</span> tower_http::services::ServeDir;

<span class="hljs-keyword">use</span> tower_http::trace::TraceLayer;

  

<span class="hljs-meta">#[tokio::main]</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {

    <span class="hljs-comment">// åˆå§‹åŒ–æ—¥å¿—</span>

    tracing_subscriber::<span class="hljs-title function_ invoke__">fmt</span>()

        .<span class="hljs-title function_ invoke__">with_target</span>(<span class="hljs-literal">false</span>)

        .<span class="hljs-title function_ invoke__">compact</span>()

        .<span class="hljs-title function_ invoke__">init</span>();

  

    <span class="hljs-comment">// åŠ è½½é…ç½®</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">config</span> = <span class="hljs-keyword">match</span> Config::<span class="hljs-title function_ invoke__">from_env</span>() {

        <span class="hljs-title function_ invoke__">Ok</span>(cfg) =&gt; cfg,

        <span class="hljs-title function_ invoke__">Err</span>(e) =&gt; {

            eprintln!(<span class="hljs-string">"âŒ é…ç½®åŠ è½½å¤±è´¥: {}"</span>, e);

            eprintln!(<span class="hljs-string">"è¯·ç¡®ä¿ .env æ–‡ä»¶å­˜åœ¨å¹¶åŒ…å«å¿…è¦çš„é…ç½®é¡¹"</span>);

            std::process::<span class="hljs-title function_ invoke__">exit</span>(<span class="hljs-number">1</span>);

        }

    };

  

    tracing::info!(<span class="hljs-string">"âœ… é…ç½®åŠ è½½æˆåŠŸ"</span>);

  

    <span class="hljs-comment">// åˆ›å»º DeepSeek æœåŠ¡</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">deepseek_service</span> = DeepSeekService::<span class="hljs-title function_ invoke__">new</span>(config.<span class="hljs-title function_ invoke__">clone</span>());

  

    <span class="hljs-comment">// åˆ›å»ºåº”ç”¨çŠ¶æ€</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">app_state</span> = Arc::<span class="hljs-title function_ invoke__">new</span>(AppState { deepseek_service });

  

    <span class="hljs-comment">// é…ç½® CORS</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">cors</span> = CorsLayer::<span class="hljs-title function_ invoke__">new</span>()

        .<span class="hljs-title function_ invoke__">allow_origin</span>(Any)

        .<span class="hljs-title function_ invoke__">allow_methods</span>(Any)

        .<span class="hljs-title function_ invoke__">allow_headers</span>(Any);

  

    <span class="hljs-comment">// æ„å»ºè·¯ç”±</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">app</span> = Router::<span class="hljs-title function_ invoke__">new</span>()

        <span class="hljs-comment">// API è·¯ç”±</span>

        .<span class="hljs-title function_ invoke__">route</span>(<span class="hljs-string">"/api/health"</span>, <span class="hljs-title function_ invoke__">get</span>(health_handler))

        .<span class="hljs-title function_ invoke__">route</span>(<span class="hljs-string">"/api/chat"</span>, <span class="hljs-title function_ invoke__">post</span>(chat_handler))

        .<span class="hljs-title function_ invoke__">route</span>(<span class="hljs-string">"/api/chat/stream"</span>, <span class="hljs-title function_ invoke__">post</span>(chat_stream_handler))

        <span class="hljs-comment">// é™æ€æ–‡ä»¶æœåŠ¡</span>

        .<span class="hljs-title function_ invoke__">nest_service</span>(<span class="hljs-string">"/"</span>, ServeDir::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-string">"static"</span>))

        <span class="hljs-comment">// æ·»åŠ çŠ¶æ€</span>

        .<span class="hljs-title function_ invoke__">with_state</span>(app_state)

        <span class="hljs-comment">// æ·»åŠ ä¸­é—´ä»¶</span>

        .<span class="hljs-title function_ invoke__">layer</span>(cors)

        .<span class="hljs-title function_ invoke__">layer</span>(TraceLayer::<span class="hljs-title function_ invoke__">new_for_http</span>());

  

    <span class="hljs-comment">// å¯åŠ¨æœåŠ¡å™¨</span>

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">addr</span> = config.<span class="hljs-title function_ invoke__">server_address</span>();

    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">listener</span> = tokio::net::TcpListener::<span class="hljs-title function_ invoke__">bind</span>(&amp;addr)

        .<span class="hljs-keyword">await</span>

        .<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">"æ— æ³•ç»‘å®šåœ°å€"</span>);

  

    tracing::info!(<span class="hljs-string">"ğŸš€ æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼"</span>);

    tracing::info!(<span class="hljs-string">"ğŸ“¡ ç›‘å¬åœ°å€: http://{}"</span>, addr);

    tracing::info!(<span class="hljs-string">"ğŸ’¡ è®¿é—® http://{} å¼€å§‹ä½¿ç”¨"</span>, addr);

  

    axum::<span class="hljs-title function_ invoke__">serve</span>(listener, app)

        .<span class="hljs-keyword">await</span>

        .<span class="hljs-title function_ invoke__">expect</span>(<span class="hljs-string">"æœåŠ¡å™¨è¿è¡Œå¤±è´¥"</span>);

}
</code></pre>
<h2 data-id="heading-16">ç¬¬äº”é˜¶æ®µï¼šå‰ç«¯äº¤äº’ç•Œé¢å¼€å‘</h2>
<p>å‰ç«¯éƒ¨åˆ†æ—¨åœ¨æä¾›ä¸€ä¸ªç®€æ´ã€ç°ä»£ä¸”å“åº”è¿…é€Ÿçš„èŠå¤©ç•Œé¢ï¼Œæ ¸å¿ƒåœ¨äºå¤„ç†æµå¼æ•°æ®å’ŒMarkdownæ¸²æŸ“ã€‚</p>
<h3 data-id="heading-17">5.1 é¡µé¢ç»“æ„ (index.html)</h3>
<p>HTMLä½¿ç”¨äº†Tailwind CSS CDNç‰ˆæœ¬è¿›è¡Œå¿«é€Ÿæ ·å¼å¼€å‘ã€‚é¡µé¢å¸ƒå±€é‡‡ç”¨Flexboxï¼Œåˆ†ä¸ºå¤´éƒ¨ã€æ¶ˆæ¯å±•ç¤ºåŒºå’Œåº•éƒ¨è¾“å…¥åŒºã€‚</p>
<ul>
<li><strong>æ¶ˆæ¯å®¹å™¨</strong>: <code>messagesContainer</code>ç”¨äºåŠ¨æ€è¿½åŠ å¯¹è¯å†…å®¹ã€‚</li>
<li><strong>æ¨¡å¼é€‰æ‹©</strong>: ä¸‹æ‹‰èœå•å…è®¸ç”¨æˆ·é€‰æ‹©ä¸åŒçš„å¯¹è¯æ¨¡å¼ï¼Œè¿™å°†å½±å“åç«¯ä½¿ç”¨çš„System Promptã€‚</li>
<li><strong>å¤–éƒ¨åº“å¼•å…¥</strong>: å¼•å…¥äº†<code>marked.js</code>ç”¨äºMarkdownè§£æï¼Œ<code>highlight.js</code>ç”¨äºä»£ç å—è¯­æ³•é«˜äº®ã€‚</li>
</ul>
<h3 data-id="heading-18">5.2 æ ·å¼å®šåˆ¶ (style.css)</h3>
<p>é™¤äº†Tailwindçš„å®ç”¨ç±»ï¼Œ<code>style.css</code>å®šä¹‰äº†æ·±è‰²æ¨¡å¼ä¸‹çš„ç»†èŠ‚æ ·å¼ï¼Œå¦‚è‡ªå®šä¹‰æ»šåŠ¨æ¡ã€æ¶ˆæ¯æ·¡å…¥åŠ¨ç”»ä»¥åŠMarkdownæ¸²æŸ“åçš„æ’ç‰ˆæ ·å¼ï¼ˆå¦‚ä»£ç å—èƒŒæ™¯ã€åˆ—è¡¨ç¼©è¿›ç­‰ï¼‰ã€‚è¿™ä¿è¯äº†AIç”Ÿæˆçš„å¤æ‚å†…å®¹ï¼ˆå¦‚ä»£ç ã€è¡¨æ ¼ï¼‰åœ¨ç•Œé¢ä¸Šæ˜¾ç¤ºå¾—ä½“ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* static/css/style.css */</span>

<span class="hljs-comment">/* è‡ªå®šä¹‰æ ·å¼ */</span>

  

<span class="hljs-comment">/* å…¨å±€æ ·å¼ */</span>

* {

    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;

    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;

    <span class="hljs-attribute">box-sizing</span>: border-box;

}

  

<span class="hljs-selector-tag">body</span> {

    <span class="hljs-attribute">font-family</span>: -apple-system, BlinkMacSystemFont, <span class="hljs-string">'Segoe UI'</span>, <span class="hljs-string">'Roboto'</span>, <span class="hljs-string">'Oxygen'</span>,

        <span class="hljs-string">'Ubuntu'</span>, <span class="hljs-string">'Cantarell'</span>, <span class="hljs-string">'Fira Sans'</span>, <span class="hljs-string">'Droid Sans'</span>, <span class="hljs-string">'Helvetica Neue'</span>,

        sans-serif;

    -webkit-<span class="hljs-attribute">font-smoothing</span>: antialiased;

    -moz-osx-<span class="hljs-attribute">font-smoothing</span>: grayscale;

}

  

<span class="hljs-comment">/* æ»šåŠ¨æ¡æ ·å¼ */</span>

::-webkit-scrollbar {

    <span class="hljs-attribute">width</span>: <span class="hljs-number">8px</span>;

}

  

::-webkit-scrollbar-track {

    <span class="hljs-attribute">background</span>: <span class="hljs-number">#1f2937</span>;

}

  

::-webkit-scrollbar-thumb {

    <span class="hljs-attribute">background</span>: <span class="hljs-number">#4b5563</span>;

    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;

}

  

::-webkit-scrollbar-thumb:hover {

    <span class="hljs-attribute">background</span>: <span class="hljs-number">#6b7280</span>;

}

  

<span class="hljs-comment">/* æ¶ˆæ¯å®¹å™¨ */</span>

<span class="hljs-selector-id">#messagesContainer</span> {

    scroll-behavior: smooth;

}

  

<span class="hljs-comment">/* æ¶ˆæ¯æ ·å¼ */</span>

<span class="hljs-selector-class">.message</span> {

    <span class="hljs-attribute">animation</span>: fadeIn <span class="hljs-number">0.3s</span> ease-in;

}

  

<span class="hljs-keyword">@keyframes</span> fadeIn {

    <span class="hljs-selector-tag">from</span> {

        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;

        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">10px</span>);

    }

    <span class="hljs-selector-tag">to</span> {

        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;

        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>);

    }

}

  

<span class="hljs-comment">/* Markdown å†…å®¹æ ·å¼ */</span>

<span class="hljs-selector-class">.message-content</span> {

    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">1.6</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">h1</span>,

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">h2</span>,

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">h3</span> {

    <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">1em</span>;

    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0.5em</span>;

    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">h1</span> {

    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.5em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">h2</span> {

    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.3em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">h3</span> {

    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.1em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">p</span> {

    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0.8em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">ul</span>,

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">ol</span> {

    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">1.5em</span>;

    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0.8em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">li</span> {

    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">0.3em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">code</span> {

    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#374151</span>;

    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0.2em</span> <span class="hljs-number">0.4em</span>;

    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">3px</span>;

    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9em</span>;

    <span class="hljs-attribute">font-family</span>: <span class="hljs-string">'Courier New'</span>, Courier, monospace;

}

  

<span class="hljs-selector-class">.message-content</span> pre {

    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#1f2937</span>;

    <span class="hljs-attribute">padding</span>: <span class="hljs-number">1em</span>;

    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">6px</span>;

    <span class="hljs-attribute">overflow-x</span>: auto;

    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">1em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> pre <span class="hljs-selector-tag">code</span> {

    <span class="hljs-attribute">background-color</span>: transparent;

    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;

    <span class="hljs-attribute">font-size</span>: <span class="hljs-number">0.9em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">blockquote</span> {

    <span class="hljs-attribute">border-left</span>: <span class="hljs-number">4px</span> solid <span class="hljs-number">#3b82f6</span>;

    <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">1em</span>;

    <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">0</span>;

    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">1em</span>;

    <span class="hljs-attribute">color</span>: <span class="hljs-number">#9ca3af</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">a</span> {

    <span class="hljs-attribute">color</span>: <span class="hljs-number">#3b82f6</span>;

    <span class="hljs-attribute">text-decoration</span>: underline;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> {

    <span class="hljs-attribute">color</span>: <span class="hljs-number">#60a5fa</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">table</span> {

    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;

    <span class="hljs-attribute">border-collapse</span>: collapse;

    <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">1em</span>;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">th</span>,

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">td</span> {

    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#4b5563</span>;

    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0.5em</span>;

    <span class="hljs-attribute">text-align</span>: left;

}

  

<span class="hljs-selector-class">.message-content</span> <span class="hljs-selector-tag">th</span> {

    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#374151</span>;

    <span class="hljs-attribute">font-weight</span>: <span class="hljs-number">600</span>;

}

  

<span class="hljs-comment">/* è¾“å…¥æ¡†æ ·å¼ */</span>

<span class="hljs-selector-tag">textarea</span> {

    <span class="hljs-attribute">font-family</span>: inherit;

}

  

<span class="hljs-selector-tag">textarea</span><span class="hljs-selector-pseudo">:focus</span> {

    <span class="hljs-attribute">outline</span>: none;

}

  

<span class="hljs-comment">/* æŒ‰é’®åŠ¨ç”» */</span>

<span class="hljs-selector-tag">button</span> {

    <span class="hljs-attribute">transition</span>: all <span class="hljs-number">0.2s</span> ease;

}

  

<span class="hljs-selector-tag">button</span><span class="hljs-selector-pseudo">:active</span> {

    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">0.98</span>);

}

  

<span class="hljs-comment">/* åŠ è½½åŠ¨ç”» */</span>

<span class="hljs-selector-class">.loading</span> {

    <span class="hljs-attribute">display</span>: inline-block;

    <span class="hljs-attribute">width</span>: <span class="hljs-number">12px</span>;

    <span class="hljs-attribute">height</span>: <span class="hljs-number">12px</span>;

    <span class="hljs-attribute">border</span>: <span class="hljs-number">2px</span> solid <span class="hljs-number">#3b82f6</span>;

    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;

    <span class="hljs-attribute">border-top-color</span>: transparent;

    <span class="hljs-attribute">animation</span>: spin <span class="hljs-number">0.8s</span> linear infinite;

}

  

<span class="hljs-keyword">@keyframes</span> spin {

    <span class="hljs-selector-tag">to</span> {

        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">rotate</span>(<span class="hljs-number">360deg</span>);

    }

}

  

<span class="hljs-comment">/* å“åº”å¼è®¾è®¡ */</span>

<span class="hljs-keyword">@media</span> (<span class="hljs-attribute">max-width</span>: <span class="hljs-number">768px</span>) {

    <span class="hljs-selector-class">.container</span> {

        <span class="hljs-attribute">padding</span>: <span class="hljs-number">1rem</span>;

    }

  

    <span class="hljs-selector-tag">header</span> <span class="hljs-selector-tag">h1</span> {

        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">1.5rem</span>;

    }

  

    <span class="hljs-selector-class">.flex-col</span> {

        <span class="hljs-attribute">gap</span>: <span class="hljs-number">0.5rem</span>;

    }

}
</code></pre>
<h3 data-id="heading-19">5.3 å‰ç«¯é€»è¾‘å®ç° (app.js)</h3>
<p><code>app.js</code>æ‰¿è½½äº†å‰ç«¯çš„æ ¸å¿ƒäº¤äº’é€»è¾‘ã€‚</p>
<ul>
<li><strong>æµå¼è¯·æ±‚å¤„ç†</strong>: <code>sendStreamRequest</code>å‡½æ•°ä½¿ç”¨Fetch APIå‘èµ·POSTè¯·æ±‚ã€‚å…³é”®åœ¨äºè·å–<code>response.body.getReader()</code>ã€‚é€šè¿‡<code>while</code>å¾ªç¯ä¸æ–­è¯»å–<code>reader.read()</code>è¿”å›çš„äºŒè¿›åˆ¶åˆ†ç‰‡ï¼ˆChunkï¼‰ã€‚</li>
<li><strong>å¢é‡è§£ç ä¸æ¸²æŸ“</strong>: ä½¿ç”¨<code>TextDecoder</code>å°†äºŒè¿›åˆ¶æ•°æ®è½¬ä¸ºæ–‡æœ¬ã€‚ç”±äºç½‘ç»œåˆ†ç‰‡å¯èƒ½æˆªæ–­JSONå­—ç¬¦ï¼Œé€»è¾‘ä¸­åŒ…å«äº†ç®€å•çš„ç¼“å†²å¤„ç†ã€‚è§£æå‡ºçš„Markdownæ–‡æœ¬è¢«å®æ—¶è¿½åŠ åˆ°å˜é‡ä¸­ï¼Œå¹¶åå¤è°ƒç”¨<code>marked.parse()</code>åˆ·æ–°DOMã€‚è™½ç„¶å…¨é‡é‡ç»˜åœ¨é•¿æ–‡æœ¬ä¸‹å¯èƒ½æœ‰æ€§èƒ½æŸè€—ï¼Œä½†åœ¨å½“å‰è§„æ¨¡ä¸‹èƒ½ä¿è¯æ¸²æŸ“çš„å®æ—¶æ€§å’Œæ­£ç¡®æ€§ï¼ˆé¿å…Markdownæ ‡è®°æœªé—­åˆå¯¼è‡´çš„æ¸²æŸ“é”™è¯¯ï¼‰ã€‚</li>
<li><strong>ä»£ç é«˜äº®</strong>: æ¯æ¬¡æ¸²æŸ“åï¼Œè°ƒç”¨<code>hljs.highlightElement</code>å¯¹æ–°ç”Ÿæˆçš„ä»£ç å—è¿›è¡Œè¯­æ³•ç€è‰²ã€‚</li>
<li><strong>äº¤äº’ç»†èŠ‚</strong>: æ”¯æŒCtrl+Enterå‘é€ã€è‡ªåŠ¨è°ƒæ•´è¾“å…¥æ¡†é«˜åº¦ã€æ»šåŠ¨åˆ°åº•éƒ¨ç­‰äººæ€§åŒ–åŠŸèƒ½ã€‚</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// static/js/app.js</span>

<span class="hljs-comment">// å‰ç«¯åº”ç”¨é€»è¾‘</span>

  

<span class="hljs-comment">// å…¨å±€å˜é‡</span>

<span class="hljs-keyword">let</span> conversationHistory = [];

<span class="hljs-keyword">let</span> isProcessing = <span class="hljs-literal">false</span>;

  

<span class="hljs-comment">// DOM å…ƒç´ </span>

<span class="hljs-keyword">const</span> messagesContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'messagesContainer'</span>);

<span class="hljs-keyword">const</span> messageInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'messageInput'</span>);

<span class="hljs-keyword">const</span> sendBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'sendBtn'</span>);

<span class="hljs-keyword">const</span> clearBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'clearBtn'</span>);

<span class="hljs-keyword">const</span> modeSelect = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'modeSelect'</span>);

<span class="hljs-keyword">const</span> statusText = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'statusText'</span>);

  

<span class="hljs-comment">// åˆå§‹åŒ–</span>

<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function">() =&gt;</span> {

    <span class="hljs-comment">// é…ç½® marked.js</span>

    marked.<span class="hljs-title function_">setOptions</span>({

        <span class="hljs-attr">highlight</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params">code, lang</span>) {

            <span class="hljs-keyword">if</span> (lang &amp;&amp; hljs.<span class="hljs-title function_">getLanguage</span>(lang)) {

                <span class="hljs-keyword">return</span> hljs.<span class="hljs-title function_">highlight</span>(code, { <span class="hljs-attr">language</span>: lang }).<span class="hljs-property">value</span>;

            }

            <span class="hljs-keyword">return</span> hljs.<span class="hljs-title function_">highlightAuto</span>(code).<span class="hljs-property">value</span>;

        },

        <span class="hljs-attr">breaks</span>: <span class="hljs-literal">true</span>,

        <span class="hljs-attr">gfm</span>: <span class="hljs-literal">true</span>

    });

  

    <span class="hljs-comment">// äº‹ä»¶ç›‘å¬</span>

    sendBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, sendMessage);

    clearBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, clearConversation);

  

    <span class="hljs-comment">// æ”¯æŒ Ctrl+Enter å‘é€</span>

    messageInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keydown'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {

        <span class="hljs-keyword">if</span> (e.<span class="hljs-property">ctrlKey</span> &amp;&amp; e.<span class="hljs-property">key</span> === <span class="hljs-string">'Enter'</span>) {

            <span class="hljs-title function_">sendMessage</span>();

        }

    });

  

    <span class="hljs-comment">// è‡ªåŠ¨è°ƒæ•´è¾“å…¥æ¡†é«˜åº¦</span>

    messageInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'input'</span>, <span class="hljs-function">() =&gt;</span> {

        messageInput.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">'auto'</span>;

        messageInput.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = messageInput.<span class="hljs-property">scrollHeight</span> + <span class="hljs-string">'px'</span>;

    });

});

  

<span class="hljs-comment">// å‘é€æ¶ˆæ¯</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"/>) {

    <span class="hljs-keyword">const</span> message = messageInput.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();

  

    <span class="hljs-keyword">if</span> (!message || isProcessing) {

        <span class="hljs-keyword">return</span>;

    }

  

    <span class="hljs-comment">// ç¦ç”¨è¾“å…¥</span>

    isProcessing = <span class="hljs-literal">true</span>;

    sendBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;

    messageInput.<span class="hljs-property">disabled</span> = <span class="hljs-literal">true</span>;

    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'å‘é€ä¸­...'</span>);

  

    <span class="hljs-comment">// æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯</span>

    <span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'user'</span>, message);

  

    <span class="hljs-comment">// æ¸…ç©ºè¾“å…¥æ¡†</span>

    messageInput.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>;

    messageInput.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">'auto'</span>;

  

    <span class="hljs-comment">// è·å–å½“å‰æ¨¡å¼</span>

    <span class="hljs-keyword">const</span> mode = modeSelect.<span class="hljs-property">value</span>;

  

    <span class="hljs-keyword">try</span> {

        <span class="hljs-comment">// è°ƒç”¨æµå¼ API</span>

        <span class="hljs-keyword">await</span> <span class="hljs-title function_">sendStreamRequest</span>(message, mode);

    } <span class="hljs-keyword">catch</span> (error) {

        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å‘é€å¤±è´¥:'</span>, error);

        <span class="hljs-title function_">addMessage</span>(<span class="hljs-string">'assistant'</span>, <span class="hljs-string">`âŒ é”™è¯¯: <span class="hljs-subst">${error.message}</span>`</span>);

        <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'å‘é€å¤±è´¥'</span>);

    } <span class="hljs-keyword">finally</span> {

        <span class="hljs-comment">// æ¢å¤è¾“å…¥</span>

        isProcessing = <span class="hljs-literal">false</span>;

        sendBtn.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;

        messageInput.<span class="hljs-property">disabled</span> = <span class="hljs-literal">false</span>;

        messageInput.<span class="hljs-title function_">focus</span>();

        <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'å°±ç»ª'</span>);

    }

}

  

<span class="hljs-comment">// å‘é€æµå¼è¯·æ±‚</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendStreamRequest</span>(<span class="hljs-params">message, mode</span>) {

    <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'AI æ€è€ƒä¸­...'</span>);

  

    <span class="hljs-comment">// åˆ›å»º AI æ¶ˆæ¯å®¹å™¨</span>

    <span class="hljs-keyword">const</span> messageDiv = <span class="hljs-title function_">createMessageElement</span>(<span class="hljs-string">'assistant'</span>);

    <span class="hljs-keyword">const</span> contentDiv = messageDiv.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.message-content'</span>);

  

    <span class="hljs-keyword">let</span> fullResponse = <span class="hljs-string">''</span>;

  

    <span class="hljs-keyword">try</span> {

        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/chat/stream'</span>, {

            <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,

            <span class="hljs-attr">headers</span>: {

                <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,

            },

            <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({

                <span class="hljs-attr">message</span>: message,

                <span class="hljs-attr">mode</span>: mode,

                <span class="hljs-attr">history</span>: conversationHistory

            })

        });

  

        <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {

            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>);

        }

  

        <span class="hljs-comment">// è¯»å–æµå¼å“åº”</span>

        <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();

        <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();

  

        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {

            <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();

  

            <span class="hljs-keyword">if</span> (done) {

                <span class="hljs-keyword">break</span>;

            }

  

            <span class="hljs-comment">// è§£ç æ•°æ®</span>

            <span class="hljs-keyword">const</span> chunk = decoder.<span class="hljs-title function_">decode</span>(value, { <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span> });

            <span class="hljs-keyword">const</span> lines = chunk.<span class="hljs-title function_">split</span>(<span class="hljs-string">'\n'</span>);

  

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {

                <span class="hljs-keyword">if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'data: '</span>)) {

                    <span class="hljs-keyword">const</span> data = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);

  

                    <span class="hljs-keyword">if</span> (data === <span class="hljs-string">'[DONE]'</span>) {

                        <span class="hljs-keyword">continue</span>;

                    }

  

                    <span class="hljs-comment">// ç´¯ç§¯å“åº”å†…å®¹</span>

                    fullResponse += data;

  

                    <span class="hljs-comment">// å®æ—¶æ¸²æŸ“ Markdown</span>

                    contentDiv.<span class="hljs-property">innerHTML</span> = marked.<span class="hljs-title function_">parse</span>(fullResponse);

  

                    <span class="hljs-comment">// é«˜äº®ä»£ç å—</span>

                    contentDiv.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'pre code'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">block</span>) =&gt;</span> {

                        hljs.<span class="hljs-title function_">highlightElement</span>(block);

                    });

  

                    <span class="hljs-comment">// æ»šåŠ¨åˆ°åº•éƒ¨</span>

                    <span class="hljs-title function_">scrollToBottom</span>();

                }

            }

        }

  

        <span class="hljs-comment">// ä¿å­˜åˆ°å¯¹è¯å†å²</span>

        conversationHistory.<span class="hljs-title function_">push</span>(

            { <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>, <span class="hljs-attr">content</span>: message },

            { <span class="hljs-attr">role</span>: <span class="hljs-string">'assistant'</span>, <span class="hljs-attr">content</span>: fullResponse }

        );

  

        <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'å®Œæˆ'</span>);

  

    } <span class="hljs-keyword">catch</span> (error) {

        contentDiv.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`&lt;p class="text-red-400"&gt;âŒ é”™è¯¯: <span class="hljs-subst">${error.message}</span>&lt;/p&gt;`</span>;

        <span class="hljs-keyword">throw</span> error;

    }

}

  

<span class="hljs-comment">// æ·»åŠ æ¶ˆæ¯åˆ°ç•Œé¢</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">addMessage</span>(<span class="hljs-params">role, content</span>) {

    <span class="hljs-keyword">const</span> messageDiv = <span class="hljs-title function_">createMessageElement</span>(role);

    <span class="hljs-keyword">const</span> contentDiv = messageDiv.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.message-content'</span>);

  

    <span class="hljs-keyword">if</span> (role === <span class="hljs-string">'assistant'</span>) {

        <span class="hljs-comment">// AI æ¶ˆæ¯ä½¿ç”¨ Markdown æ¸²æŸ“</span>

        contentDiv.<span class="hljs-property">innerHTML</span> = marked.<span class="hljs-title function_">parse</span>(content);

  

        <span class="hljs-comment">// é«˜äº®ä»£ç å—</span>

        contentDiv.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'pre code'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">block</span>) =&gt;</span> {

            hljs.<span class="hljs-title function_">highlightElement</span>(block);

        });

    } <span class="hljs-keyword">else</span> {

        <span class="hljs-comment">// ç”¨æˆ·æ¶ˆæ¯çº¯æ–‡æœ¬</span>

        contentDiv.<span class="hljs-property">textContent</span> = content;

    }

  

    <span class="hljs-title function_">scrollToBottom</span>();

}

  

<span class="hljs-comment">// åˆ›å»ºæ¶ˆæ¯å…ƒç´ </span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">createMessageElement</span>(<span class="hljs-params">role</span>) {

    <span class="hljs-keyword">const</span> messageDiv = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);

    messageDiv.<span class="hljs-property">className</span> = <span class="hljs-string">`message <span class="hljs-subst">${role}</span>-message`</span>;

  

    <span class="hljs-keyword">const</span> isUser = role === <span class="hljs-string">'user'</span>;

    <span class="hljs-keyword">const</span> avatar = isUser ? <span class="hljs-string">'ğŸ‘¤'</span> : <span class="hljs-string">'AI'</span>;

    <span class="hljs-keyword">const</span> bgColor = isUser ? <span class="hljs-string">'bg-green-600'</span> : <span class="hljs-string">'bg-blue-600'</span>;

    <span class="hljs-keyword">const</span> contentBg = isUser ? <span class="hljs-string">'bg-gray-700'</span> : <span class="hljs-string">'bg-gray-700'</span>;

  

    messageDiv.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`

        &lt;div class="flex items-start gap-3"&gt;

            &lt;div class="w-8 h-8 rounded-full <span class="hljs-subst">${bgColor}</span> flex items-center justify-center flex-shrink-0"&gt;

                &lt;span class="text-sm"&gt;<span class="hljs-subst">${avatar}</span>&lt;/span&gt;

            &lt;/div&gt;

            &lt;div class="flex-1"&gt;

                &lt;div class="<span class="hljs-subst">${contentBg}</span> rounded-lg p-4 message-content"&gt;&lt;/div&gt;

            &lt;/div&gt;

        &lt;/div&gt;

    `</span>;

  

    messagesContainer.<span class="hljs-title function_">appendChild</span>(messageDiv);

    <span class="hljs-keyword">return</span> messageDiv;

}

  

<span class="hljs-comment">// æ¸…ç©ºå¯¹è¯</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">clearConversation</span>(<span class="hljs-params"/>) {

    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">confirm</span>(<span class="hljs-string">'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å¯¹è¯å—ï¼Ÿ'</span>)) {

        conversationHistory = [];

        messagesContainer.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">`

            &lt;div class="message assistant-message"&gt;

                &lt;div class="flex items-start gap-3"&gt;

                    &lt;div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0"&gt;

                        &lt;span class="text-sm"&gt;AI&lt;/span&gt;

                    &lt;/div&gt;

                    &lt;div class="flex-1"&gt;

                        &lt;div class="bg-gray-700 rounded-lg p-4"&gt;

                            &lt;p&gt;å¯¹è¯å·²æ¸…ç©ºã€‚æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ&lt;/p&gt;

                        &lt;/div&gt;

                    &lt;/div&gt;

                &lt;/div&gt;

            &lt;/div&gt;

        `</span>;

        <span class="hljs-title function_">updateStatus</span>(<span class="hljs-string">'å·²æ¸…ç©º'</span>);

    }

}

  

<span class="hljs-comment">// æ»šåŠ¨åˆ°åº•éƒ¨</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">scrollToBottom</span>(<span class="hljs-params"/>) {

    messagesContainer.<span class="hljs-property">scrollTop</span> = messagesContainer.<span class="hljs-property">scrollHeight</span>;

}

  

<span class="hljs-comment">// æ›´æ–°çŠ¶æ€æ–‡æœ¬</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateStatus</span>(<span class="hljs-params">text</span>) {

    statusText.<span class="hljs-property">textContent</span> = text;

}
</code></pre>
<h2 data-id="heading-20">ç¬¬å…­é˜¶æ®µï¼šæœ€ç»ˆéƒ¨ç½²ä¸å…¨é“¾è·¯æµ‹è¯•</h2>
<p>å®Œæˆæ‰€æœ‰ä»£ç ç¼–å†™åï¼Œé¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œåç«¯é€»è¾‘ä¸¥å¯†ï¼Œå‰ç«¯äº¤äº’å®Œå–„ã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºäº†æœ€ç»ˆçš„é¡¹ç›®æ–‡ä»¶ç›®å½•æ ‘ï¼Œæ¸…æ™°åœ°åæ˜ äº†MVCï¼ˆModel-View-Controllerï¼‰å¼çš„æ¶æ„æ€æƒ³ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b75011af0b4c4c3aa5657ef68c8dcf66~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=dVYsxYYP%2Fh9OqSggrT0T%2FMCWfAY%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-21">6.1 å¯åŠ¨æœåŠ¡</h3>
<p>åœ¨ç»ˆç«¯æ ¹ç›®å½•ä¸‹è¿è¡Œ<code>cargo run</code>ã€‚Cargoä¼šè‡ªåŠ¨ç¼–è¯‘æ‰€æœ‰ä¾èµ–å¹¶å¯åŠ¨åº”ç”¨ã€‚é¦–æ¬¡ç¼–è¯‘å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼Œä¹‹åçš„å¢é‡ç¼–è¯‘å°†éå¸¸å¿«ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f28353a032c947bc85291b32b826d5f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=WYe7dV7XHV9tp6xrEfMqLGVOEPw%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸Šå›¾æ˜¾ç¤ºæœåŠ¡å™¨å·²æˆåŠŸç›‘å¬åœ¨<code>0.0.0.0:3000</code>ç«¯å£ï¼Œä¸”é…ç½®åŠ è½½æ— è¯¯ã€‚
é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">.
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ api
â”‚   â”‚   â”œâ”€â”€ chat.rs
â”‚   â”‚   â”œâ”€â”€ health.rs
â”‚   â”‚   â””â”€â”€ mod.rs
â”‚   â”œâ”€â”€ config.rs
â”‚   â”œâ”€â”€ main.rs
â”‚   â”œâ”€â”€ models
â”‚   â”‚   â”œâ”€â”€ chat.rs
â”‚   â”‚   â””â”€â”€ mod.rs
â”‚   â””â”€â”€ services
â”‚       â”œâ”€â”€ deepseek.rs
â”‚       â””â”€â”€ mod.rs
â””â”€â”€ static
    â”œâ”€â”€ css
    â”‚   â””â”€â”€ style.css
    â””â”€â”€ js
        â””â”€â”€ app.js
</code></pre>
<h3 data-id="heading-22">6.2 æ¥å£éªŒè¯</h3>
<p>åœ¨æ‰“å¼€æµè§ˆå™¨ä¹‹å‰ï¼Œé€šè¿‡<code>curl</code>å‘½ä»¤æµ‹è¯•å¥åº·æ£€æŸ¥æ¥å£æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œè¿™èƒ½æ’é™¤ç½‘ç»œå±‚é¢çš„åŸºæœ¬é—®é¢˜ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:3000/api/health
</code></pre>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¥å£è¿”å›äº†JSONæ ¼å¼çš„<code>ok</code>çŠ¶æ€ï¼Œè¯æ˜APIæœåŠ¡å·²æ­£å¸¸å“åº”ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/feabd5522aa84232ba14cca2c32fa1ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=M0BneKYtgE%2F%2B%2BfGs8feMaVS1Izs%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-23">6.3 æµè§ˆå™¨ä½“éªŒä¸ç›‘æ§</h3>
<p>è®¿é—®æµè§ˆå™¨åœ°å€ï¼ˆå¦‚<code>http://localhost:3000</code>ï¼‰ï¼Œå³å¯çœ‹åˆ°æ·±è‰²ä¸»é¢˜çš„èŠå¤©ç•Œé¢ã€‚è¾“å…¥é—®é¢˜åï¼Œå¯ä»¥çœ‹åˆ°AIçš„å›ç­”ä»¥æ‰“å­—æœºçš„å½¢å¼æµç•…æ¶Œç°ï¼Œä»£ç å—è¢«æ­£ç¡®é«˜äº®ï¼ŒMarkdownæ ¼å¼æ¸²æŸ“å®Œç¾ã€‚</p>
<p>ä¸æ­¤åŒæ—¶ï¼Œåœ¨è“è€˜çš„æ§åˆ¶å°èƒ½å¤Ÿå®æ—¶æŸ¥çœ‹åˆ°Tokençš„æ¶ˆè€—æƒ…å†µå’ŒAPIè°ƒç”¨è®°å½•ã€‚è¿™ä¸ºå¼€å‘è€…æä¾›äº†é€æ˜çš„ç”¨é‡ç›‘æ§å’Œæˆæœ¬ç®¡ç†èƒ½åŠ›ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b8b2d9b39bc4792b19c6aaf620e0d2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5L2g55qE5bCP5oGQ6b6Z5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770487527&amp;x-signature=7fuxeQcBB%2Be6Zeq6P%2BM9sQoW9TY%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-24">æ€»ç»“</h2>
<p>æœ¬æ–‡è¯¦ç»†å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨Rustçš„é«˜æ€§èƒ½ç‰¹æ€§ä¸è“è€˜DeepSeekçš„å¼ºå¤§æ¨¡å‹èƒ½åŠ›ï¼Œæ„å»ºä¸€ä¸ªç«¯åˆ°ç«¯çš„ç”Ÿæˆå¼AIåº”ç”¨ã€‚ä»Linuxåº•å±‚åº“çš„å®‰è£…åˆ°Rustå¼‚æ­¥æµå¤„ç†ï¼Œå†åˆ°å‰ç«¯çš„SSEæµå¼æ¸²æŸ“ï¼Œæ¯ä¸€ä¸ªç¯èŠ‚éƒ½ä½“ç°äº†ç°ä»£Webå¼€å‘çš„æœ€ä½³å®è·µã€‚Rustçš„å®‰å…¨æ€§ä¿è¯äº†åç«¯æœåŠ¡çš„ç¨³å¥ï¼ŒAxumæ¡†æ¶æä¾›äº†æé«˜çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼Œè€Œè“è€˜MaaSæœåŠ¡åˆ™ä¸ºåº”ç”¨æ³¨å…¥äº†æ™ºèƒ½çš„æ ¸å¿ƒã€‚è¿™ç§å…¨æ ˆæ¶æ„ä¸ä»…é€‚ç”¨äºä¸ªäººåŠ©æ‰‹é¡¹ç›®ï¼Œæ›´ä¸ºæ„å»ºä¼ä¸šçº§AIåº”ç”¨æä¾›äº†åšå®çš„æŠ€æœ¯å‚è€ƒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ä»½ä¸å¯å¤šå¾—çš„ã€Š Redis ã€‹æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7601101531919794222</link>    <guid>https://juejin.cn/post/7601101531919794222</guid>    <pubDate>2026-02-01T00:35:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601101531919794222" data-draft-id="7601169987412148262" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ä»½ä¸å¯å¤šå¾—çš„ã€Š Redis ã€‹æ•™ç¨‹"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-02-01T00:35:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒå¯»girling"/> <meta itemprop="url" content="https://juejin.cn/user/2276467567770442"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ä»½ä¸å¯å¤šå¾—çš„ã€Š Redis ã€‹æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2276467567770442/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒå¯»girling
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T00:35:40.000Z" title="Sun Feb 01 2026 00:35:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Redis ä»å…¥é—¨åˆ°å®æˆ˜ï¼šè¶…è¯¦ç»†é›¶åŸºç¡€æ•™ç¨‹</h2>
<p>Redisï¼ˆRemote Dictionary Serverï¼‰æ˜¯ä¸€æ¬¾å¼€æºçš„ã€é«˜æ€§èƒ½çš„é”®å€¼å¯¹ï¼ˆKey-Valueï¼‰å†…å­˜æ•°æ®åº“ï¼ŒåŒæ—¶æ”¯æŒæŒä¹…åŒ–ã€åˆ†å¸ƒå¼ã€å¤šç§æ•°æ®ç»“æ„ï¼Œè¢«å¹¿æ³›åº”ç”¨äºç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ä¼šè¯å­˜å‚¨ã€é™æµå‰Šå³°ç­‰åœºæ™¯ã€‚æœ¬æ–‡ä»åŸºç¡€å®‰è£…ã€æ ¸å¿ƒæ¦‚å¿µã€æ•°æ®ç»“æ„ã€å¸¸ç”¨å‘½ä»¤åˆ°å®æˆ˜åœºæ™¯ï¼Œå…¨æ–¹ä½è®²è§£ Redis çš„ä½¿ç”¨ï¼Œé€‚åˆé›¶åŸºç¡€å…¥é—¨è€…ç³»ç»Ÿå­¦ä¹ ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€Redis æ ¸å¿ƒç‰¹æ€§ä¸åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-2">1.1 æ ¸å¿ƒç‰¹æ€§</h3>
<ul>
<li><strong>é«˜æ€§èƒ½</strong>ï¼šåŸºäºå†…å­˜æ“ä½œï¼Œå•å®ä¾‹ QPSï¼ˆæ¯ç§’æŸ¥è¯¢æ•°ï¼‰å¯è¾¾ 10 ä¸‡ +ï¼Œè¿œè¶…ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“ï¼›</li>
<li><strong>å¤šæ•°æ®ç»“æ„</strong>ï¼šæ”¯æŒå­—ç¬¦ä¸²ï¼ˆStringï¼‰ã€å“ˆå¸Œï¼ˆHashï¼‰ã€åˆ—è¡¨ï¼ˆListï¼‰ã€é›†åˆï¼ˆSetï¼‰ã€æœ‰åºé›†åˆï¼ˆZSetï¼‰ç­‰å¤šç§åŸç”Ÿæ•°æ®ç»“æ„ï¼›</li>
<li><strong>æŒä¹…åŒ–</strong>ï¼šæ”¯æŒ RDBï¼ˆå¿«ç…§ï¼‰å’Œ AOFï¼ˆæ—¥å¿—ï¼‰ä¸¤ç§æŒä¹…åŒ–æ–¹å¼ï¼Œé¿å…å†…å­˜æ•°æ®ä¸¢å¤±ï¼›</li>
<li><strong>åŸå­æ€§</strong>ï¼šæ‰€æœ‰å‘½ä»¤éƒ½æ˜¯åŸå­æ“ä½œï¼Œæ”¯æŒäº‹åŠ¡ï¼ˆå¼±äº‹åŠ¡ï¼‰å’Œ CASï¼ˆCompare And Swapï¼‰æ“ä½œï¼›</li>
<li><strong>é«˜å¯ç”¨</strong>ï¼šæ”¯æŒä¸»ä»å¤åˆ¶ã€å“¨å…µï¼ˆSentinelï¼‰ã€é›†ç¾¤ï¼ˆClusterï¼‰ï¼Œä¿è¯æœåŠ¡ä¸å®•æœºï¼›</li>
<li><strong>ä¸°å¯ŒåŠŸèƒ½</strong>ï¼šæ”¯æŒå‘å¸ƒè®¢é˜…ã€è¿‡æœŸæ—¶é—´ã€Lua è„šæœ¬ã€ä½å›¾ã€åœ°ç†ç©ºé—´ï¼ˆGEOï¼‰ç­‰æ‰©å±•åŠŸèƒ½ã€‚</li>
</ul>
<h3 data-id="heading-3">1.2 å…¸å‹åº”ç”¨åœºæ™¯</h3>








































<table><thead><tr><th>åœºæ™¯</th><th>è§£å†³çš„é—®é¢˜</th><th>Redis å®ç°æ–¹å¼</th></tr></thead><tbody><tr><td>ç¼“å­˜</td><td>å‡è½»æ•°æ®åº“å‹åŠ›ï¼Œæå‡æ¥å£å“åº”é€Ÿåº¦</td><td>String/Hash å­˜å‚¨çƒ­ç‚¹æ•°æ®ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´</td></tr><tr><td>åˆ†å¸ƒå¼é”</td><td>è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­èµ„æºç«äº‰é—®é¢˜</td><td>Stringï¼ˆSET NX EXï¼‰/Redlock</td></tr><tr><td>é™æµå‰Šå³°</td><td>æ§åˆ¶æ¥å£è¯·æ±‚é¢‘ç‡ï¼Œé˜²æ­¢ç³»ç»Ÿè¢«æ‰“å®</td><td>ZSet / è®¡æ•°å™¨ï¼ˆINCRï¼‰+ è¿‡æœŸæ—¶é—´</td></tr><tr><td>ä¼šè¯å­˜å‚¨</td><td>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å…±äº«ç”¨æˆ·ä¼šè¯</td><td>Hash å­˜å‚¨ç”¨æˆ·ä¼šè¯ä¿¡æ¯</td></tr><tr><td>æ¶ˆæ¯é˜Ÿåˆ—</td><td>ç®€å•çš„å¼‚æ­¥é€šä¿¡åœºæ™¯</td><td>Listï¼ˆLPUSH + BRPOPï¼‰/ å‘å¸ƒè®¢é˜…</td></tr><tr><td>æ’è¡Œæ¦œ</td><td>å®æ—¶æ›´æ–°çš„ç‚¹èµæ¦œã€é”€é‡æ¦œ</td><td>ZSetï¼ˆæŒ‰åˆ†æ•°æ’åºï¼‰</td></tr></tbody></table>
<h2 data-id="heading-4">äºŒã€Redis ç¯å¢ƒå®‰è£…ä¸é…ç½®</h2>
<h3 data-id="heading-5">2.1 ç¯å¢ƒå‡†å¤‡</h3>
<ul>
<li>
<p>æ“ä½œç³»ç»Ÿï¼šLinuxï¼ˆæ¨è CentOS 7/8ã€Ubuntu 20.04ï¼‰ï¼ŒWindows ä»…å»ºè®®æµ‹è¯•ä½¿ç”¨ï¼›</p>
</li>
<li>
<p>ä¾èµ–ï¼šRedis ç¼–è¯‘éœ€è¦ GCC ç¯å¢ƒï¼Œå…ˆå®‰è£…ä¾èµ–ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># CentOS</span>
yum install -y gcc gcc-c++ make
<span class="hljs-meta"># Ubuntu</span>
apt-<span class="hljs-keyword">get</span> install -y gcc make
</code></pre>
</li>
</ul>
<h3 data-id="heading-6">2.2 æºç å®‰è£…ï¼ˆLinux æ¨èï¼‰</h3>
<p>æ­¥éª¤ 1ï¼šä¸‹è½½å¹¶è§£å‹ Redis</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½æœ€æ–°ç¨³å®šç‰ˆï¼ˆ7.2.4 ä¸ºå½“å‰ç¨³å®šç‰ˆï¼Œå¯æ›¿æ¢ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼‰</span>
wget https://download.redis.io/releases/redis-7.2.4.tar.gz
<span class="hljs-comment"># è§£å‹</span>
tar -zxvf redis-7.2.4.tar.gz
<span class="hljs-comment"># è¿›å…¥è§£å‹ç›®å½•</span>
<span class="hljs-built_in">cd</span> redis-7.2.4
</code></pre>
<p>æ­¥éª¤ 2ï¼šç¼–è¯‘ä¸å®‰è£…</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ç¼–è¯‘</span>
make
<span class="hljs-comment"># å®‰è£…ï¼ˆæŒ‡å®šå®‰è£…ç›®å½•ï¼Œæ¨è /usr/local/redisï¼‰</span>
make <span class="hljs-attr">PREFIX</span>=/usr/local/redis install
</code></pre>
<p>æ­¥éª¤ 3ï¼šé…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰</p>
<p>å°† Redis å‘½ä»¤åŠ å…¥ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œæ–¹ä¾¿å…¨å±€è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç¼–è¾‘ç¯å¢ƒå˜é‡æ–‡ä»¶</span>
vim /etc/profile
<span class="hljs-comment"># æ·»åŠ ä»¥ä¸‹å†…å®¹</span>
<span class="hljs-built_in">export</span> REDIS_HOME=/usr/local/redis
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$REDIS_HOME</span>/bin
<span class="hljs-comment"># ç”Ÿæ•ˆé…ç½®</span>
<span class="hljs-built_in">source</span> /etc/profile
</code></pre>
<p>æ­¥éª¤ 4ï¼šåˆå§‹åŒ–é…ç½®æ–‡ä»¶</p>
<p>Redis é»˜è®¤é…ç½®æ–‡ä»¶åœ¨è§£å‹ç›®å½•çš„ <code>redis.conf</code>ï¼Œéœ€è¦å¤åˆ¶åˆ°å®‰è£…ç›®å½•å¹¶ä¿®æ”¹æ ¸å¿ƒé…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºé…ç½®ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p /usr/local/redis/conf
<span class="hljs-comment"># å¤åˆ¶é…ç½®æ–‡ä»¶</span>
<span class="hljs-built_in">cp</span> redis.conf /usr/local/redis/conf/
<span class="hljs-comment"># ç¼–è¾‘é…ç½®æ–‡ä»¶</span>
vim /usr/local/redis/conf/redis.conf
</code></pre>
<h3 data-id="heading-7">2.3 æ ¸å¿ƒé…ç½®é¡¹ä¿®æ”¹ï¼ˆå¿…æ”¹ï¼‰</h3>
<p>æ‰“å¼€ <code>redis.conf</code> åï¼Œä¿®æ”¹ä»¥ä¸‹å…³é”®é…ç½®ï¼ˆå»æ‰æ³¨é‡Šå¹¶ä¿®æ”¹å€¼ï¼‰ï¼š</p>







































































<table><thead><tr><th>é…ç½®é¡¹</th><th>é»˜è®¤å€¼</th><th>ä¿®æ”¹åå€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>bind</td><td>127.0.0.1</td><td>0.0.0.0</td><td>å…è®¸æ‰€æœ‰ IP è®¿é—®ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®æŒ‡å®šå†…ç½‘ IPï¼‰</td></tr><tr><td>protected-mode</td><td>yes</td><td>no</td><td>å…³é—­ä¿æŠ¤æ¨¡å¼ï¼ˆå¦åˆ™ä»…æœ¬åœ°å¯è®¿é—®ï¼‰</td></tr><tr><td>port</td><td>6379</td><td>6379</td><td>ç«¯å£å·ï¼Œå¯è‡ªå®šä¹‰ï¼ˆå¦‚ 6380ï¼‰</td></tr><tr><td>daemonize</td><td>no</td><td>yes</td><td>ä»¥å®ˆæŠ¤è¿›ç¨‹è¿è¡Œï¼ˆåå°è¿è¡Œï¼‰</td></tr><tr><td>pidfile</td><td>/var/run/redis_6379.pid</td><td>/usr/local/redis/redis.pid</td><td>PID æ–‡ä»¶å­˜æ”¾è·¯å¾„</td></tr><tr><td>logfile</td><td>""</td><td>/usr/local/redis/log/redis.log</td><td>æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼ˆéœ€å…ˆåˆ›å»º log ç›®å½•ï¼‰</td></tr><tr><td>dir</td><td>./</td><td>/usr/local/redis/data</td><td>æŒä¹…åŒ–æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼ˆéœ€å…ˆåˆ›å»º data ç›®å½•ï¼‰</td></tr><tr><td>requirepass</td><td>""</td><td>yourpassword</td><td>è®¾ç½®å¯†ç ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ç½®ï¼‰</td></tr><tr><td>maxmemory</td><td>0</td><td>2gb</td><td>æœ€å¤§ä½¿ç”¨å†…å­˜ï¼ˆæ ¹æ®æœåŠ¡å™¨é…ç½®ï¼Œå¦‚ 2GBã€4GBï¼‰</td></tr><tr><td>maxmemory-policy</td><td>noeviction</td><td>volatile-lru</td><td>å†…å­˜æ»¡æ—¶çš„æ·˜æ±°ç­–ç•¥ï¼ˆä¼˜å…ˆæ·˜æ±°è¿‡æœŸçš„é”®ï¼‰</td></tr></tbody></table>
<p>åˆ›å»ºæ—¥å¿—å’Œæ•°æ®ç›®å½•ï¼š</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-keyword">mkdir</span> -p /usr/<span class="hljs-keyword">local</span>/redis/<span class="hljs-keyword">log</span> /usr/<span class="hljs-keyword">local</span>/redis/data
</code></pre>
<h3 data-id="heading-8">2.4 å¯åŠ¨ä¸åœæ­¢ Redis</h3>
<p>å¯åŠ¨ Redis</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨</span>
redis-server /usr/local/redis/conf/redis.conf
</code></pre>
<p>éªŒè¯å¯åŠ¨</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># æŸ¥çœ‹è¿›ç¨‹</span>
ps -ef | grep redis
<span class="hljs-comment"># è¿æ¥å®¢æˆ·ç«¯</span>
redis-cli -h 127.0.0.1 -p 6379 -a yourpassword
<span class="hljs-comment"># æµ‹è¯•å‘½ä»¤</span>
<span class="hljs-section">127.0.0.1:6379&gt; PING</span>
PONG <span class="hljs-comment"># è¿”å› PONG è¯´æ˜å¯åŠ¨æˆåŠŸ</span>
</code></pre>
<p>åœæ­¢ Redis</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¼˜é›…åœæ­¢ï¼ˆæ¨èï¼‰</span>
redis-cli -a yourpassword SHUTDOWN
<span class="hljs-comment"># å¼ºåˆ¶åœæ­¢ï¼ˆä¸æ¨èï¼Œå¯èƒ½ä¸¢å¤±æ•°æ®ï¼‰</span>
<span class="hljs-built_in">kill</span> -9 [redisè¿›ç¨‹ID]
</code></pre>
<h3 data-id="heading-9">2.5 Windows å®‰è£…ï¼ˆä»…æµ‹è¯•ç”¨ï¼‰</h3>
<ol>
<li>ä¸‹è½½ Windows ç‰ˆ Redisï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmicrosoftarchive%2Fredis%2Freleases" target="_blank" title="https://github.com/microsoftarchive/redis/releases" ref="nofollow noopener noreferrer">github.com/microsoftarâ€¦</a></li>
<li>è§£å‹ååŒå‡» <code>redis-server.exe</code> å¯åŠ¨æœåŠ¡ï¼ŒåŒå‡» <code>redis-cli.exe</code> æ‰“å¼€å®¢æˆ·ç«¯ï¼›</li>
<li>é…ç½®æ–‡ä»¶ä¸º <code>redis.windows.conf</code>ï¼Œä¿®æ”¹æ–¹å¼ä¸ Linux ä¸€è‡´ï¼ˆæ— éœ€æ”¹ daemonizeï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-10">ä¸‰ã€Redis æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-11">3.1 æ•°æ®æ¨¡å‹ï¼šé”®å€¼å¯¹ï¼ˆKey-Valueï¼‰</h3>
<p>Redis ä»¥ "é”®ï¼ˆKeyï¼‰- å€¼ï¼ˆValueï¼‰" ä¸ºæ ¸å¿ƒå­˜å‚¨æ¨¡å‹ï¼š</p>
<ul>
<li><strong>Key</strong>ï¼šå¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä¸”å”¯ä¸€ï¼Œå»ºè®®éµå¾ªå‘½åè§„èŒƒï¼ˆå¦‚ <code>user:info:1001</code>ï¼‰ï¼›</li>
<li><strong>Value</strong>ï¼šæ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼ˆStringã€Hashã€Listã€Setã€ZSet ç­‰ï¼‰ï¼›</li>
<li>æ‰€æœ‰å‘½ä»¤éƒ½æ˜¯å›´ç»• "æ“ä½œ Key" æˆ– "æ“ä½œ Key å¯¹åº”çš„ Value" å±•å¼€ã€‚</li>
</ul>
<h3 data-id="heading-12">3.2 æ•°æ®ç±»å‹ä¸é€‚ç”¨åœºæ™¯</h3>
<p>Redis æ”¯æŒ 5 ç§æ ¸å¿ƒæ•°æ®ç±»å‹ï¼Œæ¯ç§ç±»å‹æœ‰ä¸“å±å‘½ä»¤ï¼Œä»¥ä¸‹æ˜¯è¯¦ç»†è¯´æ˜ï¼š</p>















































<table><thead><tr><th>æ•°æ®ç±»å‹</th><th>åº•å±‚å®ç°</th><th>æ ¸å¿ƒç‰¹æ€§</th><th>å…¸å‹å‘½ä»¤</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>String</td><td>ç®€å•åŠ¨æ€å­—ç¬¦ä¸²</td><td>äºŒè¿›åˆ¶å®‰å…¨ï¼Œå¯å­˜å­—ç¬¦ä¸² / æ•°å­— / äºŒè¿›åˆ¶</td><td>SETã€GETã€INCRã€EXPIRE</td><td>ç¼“å­˜ã€è®¡æ•°å™¨ã€ä¼šè¯å­˜å‚¨</td></tr><tr><td>Hash</td><td>å“ˆå¸Œè¡¨</td><td>é”®å€¼å¯¹é›†åˆï¼Œé€‚åˆå­˜å¯¹è±¡</td><td>HSETã€HGETã€HMGETã€HDEL</td><td>å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€å•†å“è¯¦æƒ…</td></tr><tr><td>List</td><td>åŒå‘é“¾è¡¨</td><td>æœ‰åºã€å¯é‡å¤ï¼Œæ”¯æŒå¤´å°¾æ“ä½œ</td><td>LPUSHã€RPOPã€LRANGE</td><td>æ¶ˆæ¯é˜Ÿåˆ—ã€æœ€æ–°åˆ—è¡¨</td></tr><tr><td>Set</td><td>å“ˆå¸Œè¡¨</td><td>æ— åºã€ä¸å¯é‡å¤ï¼Œæ”¯æŒäº¤é›† / å¹¶é›†</td><td>SADDã€SMEMBERSã€SINTER</td><td>æ ‡ç­¾ã€å¥½å‹å»é‡ã€æŠ½å¥–</td></tr><tr><td>ZSet</td><td>è·³è·ƒè¡¨ + å“ˆå¸Œè¡¨</td><td>æœ‰åºã€ä¸å¯é‡å¤ï¼ŒæŒ‰åˆ†æ•°æ’åº</td><td>ZADDã€ZRANGEã€ZCORE</td><td>æ’è¡Œæ¦œã€å»¶æ—¶ä»»åŠ¡</td></tr></tbody></table>
<h3 data-id="heading-13">3.3 è¿‡æœŸæ—¶é—´</h3>
<p>Redis æ”¯æŒä¸º Key è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œåˆ°æœŸåè‡ªåŠ¨åˆ é™¤ï¼Œæ ¸å¿ƒå‘½ä»¤ï¼š</p>
<ul>
<li><code>EXPIRE key seconds</code>ï¼šè®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ï¼›</li>
<li><code>PEXPIRE key milliseconds</code>ï¼šè®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼›</li>
<li><code>EXPIREAT key timestamp</code>ï¼šæŒ‡å®šæ—¶é—´æˆ³è¿‡æœŸï¼ˆç§’ï¼‰ï¼›</li>
<li><code>TTL key</code>ï¼šæŸ¥çœ‹å‰©ä½™è¿‡æœŸæ—¶é—´ï¼ˆ-1 æ°¸ä¸è¿‡æœŸï¼Œ-2 å·²è¿‡æœŸï¼‰ï¼›</li>
<li><code>PERSIST key</code>ï¼šå–æ¶ˆè¿‡æœŸæ—¶é—´ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">SET</span> name <span class="hljs-string">"redis"</span>
<span class="hljs-variable constant_">OK</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">EXPIRE</span> name <span class="hljs-number">60</span> <span class="hljs-comment"># 60ç§’åè¿‡æœŸ</span>
(integer) <span class="hljs-number">1</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">TTL</span> name
(integer) <span class="hljs-number">55</span> <span class="hljs-comment"># å‰©ä½™55ç§’</span>
</code></pre>
<h3 data-id="heading-14">3.4 æŒä¹…åŒ–æœºåˆ¶</h3>
<p>Redis æ˜¯å†…å­˜æ•°æ®åº“ï¼Œé»˜è®¤é‡å¯åæ•°æ®ä¸¢å¤±ï¼ŒæŒä¹…åŒ–æœºåˆ¶è§£å†³è¯¥é—®é¢˜ï¼Œæ”¯æŒä¸¤ç§æ–¹å¼ï¼š</p>
<h4 data-id="heading-15">3.4.1 RDBï¼ˆå¿«ç…§ <strong>Redis DataBase</strong> ï¼‰</h4>
<ul>
<li>
<p><strong>åŸç†</strong>ï¼šåœ¨æŒ‡å®šæ—¶é—´é—´éš”å†…ï¼Œå°†å†…å­˜ä¸­çš„æ•°æ®å¿«ç…§å†™å…¥ç£ç›˜ï¼ˆ.rdb æ–‡ä»¶ï¼‰ï¼›</p>
</li>
<li>
<p><strong>è§¦å‘æ–¹å¼</strong>ï¼š</p>
<ul>
<li>æ‰‹åŠ¨è§¦å‘ï¼š<code>SAVE</code>ï¼ˆé˜»å¡ï¼‰ã€<code>BGSAVE</code>ï¼ˆéé˜»å¡ï¼Œæ¨èï¼‰ï¼›</li>
<li>è‡ªåŠ¨è§¦å‘ï¼šé…ç½® <code>save 900 1</code>ï¼ˆ900 ç§’å†…è‡³å°‘ 1 ä¸ªé”®ä¿®æ”¹åˆ™è§¦å‘ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæ–‡ä»¶ä½“ç§¯å°ï¼Œæ¢å¤é€Ÿåº¦å¿«ï¼›</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šå¯èƒ½ä¸¢å¤±æœ€è¿‘ä¸€æ¬¡å¿«ç…§åçš„æ‰€æœ‰æ•°æ®ã€‚</p>
</li>
</ul>
<h4 data-id="heading-16">3.4.2 AOFï¼ˆè¿½åŠ æ—¥å¿— Append Only File ï¼‰</h4>
<ul>
<li>
<p><strong>åŸç†</strong>ï¼šè®°å½•æ‰€æœ‰å†™å‘½ä»¤ï¼ˆå¦‚ SETã€HSETï¼‰ï¼Œé‡å¯æ—¶é‡æ–°æ‰§è¡Œå‘½ä»¤æ¢å¤æ•°æ®ï¼›</p>
</li>
<li>
<p><strong>å¼€å¯æ–¹å¼</strong>ï¼šé…ç½® <code>appendonly yes</code>ï¼›</p>
</li>
<li>
<p><strong>åŒæ­¥ç­–ç•¥</strong>ï¼š</p>
<ul>
<li><code>appendfsync always</code>ï¼šæ¯æ¬¡å†™å‘½ä»¤éƒ½åŒæ­¥ï¼ˆæœ€å®‰å…¨ï¼Œæ€§èƒ½æœ€å·®ï¼‰ï¼›</li>
<li><code>appendfsync everysec</code>ï¼šæ¯ç§’åŒæ­¥ï¼ˆé»˜è®¤ï¼Œå¹³è¡¡å®‰å…¨ä¸æ€§èƒ½ï¼‰ï¼›</li>
<li><code>appendfsync no</code>ï¼šç”±æ“ä½œç³»ç»Ÿå†³å®šï¼ˆæ€§èƒ½æœ€å¥½ï¼Œæœ€ä¸å®‰å…¨ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæ•°æ®ä¸¢å¤±å°‘ï¼ˆæœ€å¤š 1 ç§’ï¼‰ï¼›</p>
</li>
<li>
<p><strong>ç¼ºç‚¹</strong>ï¼šæ–‡ä»¶ä½“ç§¯å¤§ï¼Œæ¢å¤é€Ÿåº¦æ…¢ã€‚</p>
</li>
</ul>
<h4 data-id="heading-17">3.4.3 æ··åˆæŒä¹…åŒ–ï¼ˆRedis 4.0+ï¼‰</h4>
<p>é…ç½® <code>aof-use-rdb-preamble yes</code>ï¼ŒAOF æ–‡ä»¶å¼€å¤´åŒ…å« RDB å¿«ç…§ï¼Œåç»­æ˜¯ AOF æ—¥å¿—ï¼Œå…¼é¡¾ RDB å’Œ AOF çš„ä¼˜ç‚¹ï¼Œç”Ÿäº§ç¯å¢ƒæ¨èå¼€å¯ã€‚</p>
<h2 data-id="heading-18">å››ã€Redis æ ¸å¿ƒæ•°æ®ç»“æ„ä¸å‘½ä»¤å®æˆ˜</h2>
<h3 data-id="heading-19">4.1 å­—ç¬¦ä¸²ï¼ˆStringï¼‰</h3>
<p>String æ˜¯ Redis æœ€åŸºç¡€çš„ç±»å‹ï¼Œå¯å­˜å‚¨å­—ç¬¦ä¸²ã€æ•°å­—ã€äºŒè¿›åˆ¶æ•°æ®ï¼ˆå¦‚å›¾ç‰‡ï¼‰ï¼Œæœ€å¤§å®¹é‡ 512MBã€‚</p>
<h4 data-id="heading-20">æ ¸å¿ƒå‘½ä»¤</h4>


















































<table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>SET key value</td><td>è®¾ç½®é”®å€¼å¯¹</td><td>SET username "zhangsan"</td></tr><tr><td>GET key</td><td>è·å–å€¼</td><td>GET username â†’ "zhangsan"</td></tr><tr><td>SETNX key value</td><td>ä»…å½“é”®ä¸å­˜åœ¨æ—¶è®¾ç½®ï¼ˆåˆ†å¸ƒå¼é”æ ¸å¿ƒï¼‰</td><td>SETNX lock 1 â†’ 1ï¼ˆæˆåŠŸï¼‰/0ï¼ˆå¤±è´¥ï¼‰</td></tr><tr><td>INCR key</td><td>æ•°å­—å€¼è‡ªå¢ 1ï¼ˆåŸå­æ“ä½œï¼‰</td><td>SET num 10 â†’ INCR num â†’ 11</td></tr><tr><td>INCRBY key step</td><td>è‡ªå¢æŒ‡å®šæ­¥é•¿</td><td>INCRBY num 5 â†’ 16</td></tr><tr><td>DECR key</td><td>æ•°å­—å€¼è‡ªå‡ 1</td><td>DECR num â†’ 15</td></tr><tr><td>APPEND key value</td><td>è¿½åŠ å­—ç¬¦ä¸²</td><td>APPEND username "_test" â†’ "zhangsan_test"</td></tr><tr><td>STRLEN key</td><td>è·å–å­—ç¬¦ä¸²é•¿åº¦</td><td>STRLEN username â†’ 12</td></tr></tbody></table>
<h4 data-id="heading-21">å®æˆ˜åœºæ™¯ï¼šæ¥å£é™æµ</h4>
<p>éœ€æ±‚ï¼šé™åˆ¶æŸä¸ªæ¥å£æ¯åˆ†é’Ÿæœ€å¤šè®¿é—® 100 æ¬¡ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># å‡è®¾æ¥å£åæ˜¯ /api/userï¼Œç”¨æˆ·IPæ˜¯ 192.168.1.1</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">INCR</span> <span class="hljs-symbol">api:</span><span class="hljs-symbol">limit:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span><span class="hljs-symbol">:/api/user</span>
(integer) <span class="hljs-number">1</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">EXPIRE</span> <span class="hljs-symbol">api:</span><span class="hljs-symbol">limit:</span><span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span><span class="hljs-symbol">:/api/user</span> <span class="hljs-number">60</span>
(integer) <span class="hljs-number">1</span>
<span class="hljs-comment"># æ¯æ¬¡è®¿é—®æ¥å£æ—¶æ‰§è¡Œä¸Šè¿°å‘½ä»¤ï¼Œè‹¥è¿”å›å€¼ &gt;100 åˆ™æ‹’ç»è®¿é—®</span>
</code></pre>
<h3 data-id="heading-22">4.2 å“ˆå¸Œï¼ˆHashï¼‰</h3>
<p>Hash æ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œé€‚åˆå­˜å‚¨å¯¹è±¡ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€å•†å“è¯¦æƒ…ï¼‰ï¼Œå¯å•ç‹¬æ“ä½œå¯¹è±¡çš„æŸä¸ªå­—æ®µï¼ŒèŠ‚çœå†…å­˜ã€‚</p>
<h4 data-id="heading-23">æ ¸å¿ƒå‘½ä»¤</h4>


















































<table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>HSET key field value</td><td>è®¾ç½®å“ˆå¸Œå­—æ®µå€¼</td><td>HSET user:1001 name "æå››" age 25</td></tr><tr><td>HGET key field</td><td>è·å–å“ˆå¸Œå­—æ®µå€¼</td><td>HGET user:1001 name â†’ "æå››"</td></tr><tr><td>HMSET key f1 v1 f2 v2</td><td>æ‰¹é‡è®¾ç½®å“ˆå¸Œå­—æ®µ</td><td>HMSET user:1002 name "ç‹äº”" age 30</td></tr><tr><td>HMGET key f1 f2</td><td>æ‰¹é‡è·å–å“ˆå¸Œå­—æ®µ</td><td>HMGET user:1002 name age â†’ ["ç‹äº”","30"]</td></tr><tr><td>HGETALL key</td><td>è·å–æ‰€æœ‰å­—æ®µå’Œå€¼</td><td>HGETALL user:1001 â†’ ["name","æå››","age","25"]</td></tr><tr><td>HDEL key field</td><td>åˆ é™¤å“ˆå¸Œå­—æ®µ</td><td>HDEL user:1001 age â†’ 1ï¼ˆæˆåŠŸï¼‰</td></tr><tr><td>HLEN key</td><td>è·å–å“ˆå¸Œå­—æ®µæ•°é‡</td><td>HLEN user:1001 â†’ 1</td></tr><tr><td>HEXISTS key field</td><td>åˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨</td><td>HEXISTS user:1001 name â†’ 1ï¼ˆå­˜åœ¨ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-24">å®æˆ˜åœºæ™¯ï¼šå­˜å‚¨ç”¨æˆ·ä¿¡æ¯</h4>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># å­˜å‚¨ç”¨æˆ·ID=1001çš„ä¿¡æ¯</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">HSET</span> <span class="hljs-symbol">user:</span><span class="hljs-number">1001</span> username <span class="hljs-string">"zhangsan"</span> email <span class="hljs-string">"zs@test.com"</span> phone <span class="hljs-string">"13800138000"</span>
(integer) <span class="hljs-number">3</span>
<span class="hljs-comment"># è·å–ç”¨æˆ·é‚®ç®±</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">HGET</span> <span class="hljs-symbol">user:</span><span class="hljs-number">1001</span> email
<span class="hljs-string">"zs@test.com"</span>
<span class="hljs-comment"># æ›´æ–°ç”¨æˆ·æ‰‹æœºå·</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">HSET</span> <span class="hljs-symbol">user:</span><span class="hljs-number">1001</span> phone <span class="hljs-string">"13900139000"</span>
(integer) <span class="hljs-number">0</span>
<span class="hljs-comment"># è·å–ç”¨æˆ·æ‰€æœ‰ä¿¡æ¯</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">HGETALL</span> <span class="hljs-symbol">user:</span><span class="hljs-number">1001</span>
<span class="hljs-number">1</span>) <span class="hljs-string">"username"</span>
<span class="hljs-number">2</span>) <span class="hljs-string">"zhangsan"</span>
<span class="hljs-number">3</span>) <span class="hljs-string">"email"</span>
<span class="hljs-number">4</span>) <span class="hljs-string">"zs@test.com"</span>
<span class="hljs-number">5</span>) <span class="hljs-string">"phone"</span>
<span class="hljs-number">6</span>) <span class="hljs-string">"13900139000"</span>
</code></pre>
<h3 data-id="heading-25">4.3 åˆ—è¡¨ï¼ˆListï¼‰</h3>
<p>List æ˜¯æœ‰åºã€å¯é‡å¤çš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œåº•å±‚æ˜¯åŒå‘é“¾è¡¨ï¼Œæ”¯æŒå¤´å°¾æ’å…¥ / åˆ é™¤ï¼Œé€‚åˆåšæ¶ˆæ¯é˜Ÿåˆ—ã€æœ€æ–°æ¶ˆæ¯åˆ—è¡¨ã€‚</p>
<h4 data-id="heading-26">æ ¸å¿ƒå‘½ä»¤</h4>


















































<table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>LPUSH key value</td><td>ä»åˆ—è¡¨å¤´éƒ¨æ’å…¥å…ƒç´ </td><td>LPUSH msg "hello" â†’ 1</td></tr><tr><td>RPUSH key value</td><td>ä»åˆ—è¡¨å°¾éƒ¨æ’å…¥å…ƒç´ </td><td>RPUSH msg "world" â†’ 2</td></tr><tr><td>LPOP key</td><td>ä»åˆ—è¡¨å¤´éƒ¨åˆ é™¤å¹¶è¿”å›å…ƒç´ </td><td>LPOP msg â†’ "hello"</td></tr><tr><td>RPOP key</td><td>ä»åˆ—è¡¨å°¾éƒ¨åˆ é™¤å¹¶è¿”å›å…ƒç´ </td><td>RPOP msg â†’ "world"</td></tr><tr><td>BRPOP key timeout</td><td>é˜»å¡å¼å¼¹å‡ºï¼ˆé˜Ÿåˆ—æ— æ•°æ®æ—¶ç­‰å¾…ï¼‰</td><td>BRPOP queue 0 â†’ æ°¸ä¹…ç­‰å¾…</td></tr><tr><td>LRANGE key start end</td><td>è·å–åˆ—è¡¨æŒ‡å®šèŒƒå›´å…ƒç´ ï¼ˆ0 å¼€å¤´ï¼Œ-1 ç»“å°¾ï¼‰</td><td>LRANGE msg 0 -1 â†’ æ‰€æœ‰å…ƒç´ </td></tr><tr><td>LLEN key</td><td>è·å–åˆ—è¡¨é•¿åº¦</td><td>LLEN msg â†’ 2</td></tr><tr><td>LREM key count value</td><td>åˆ é™¤æŒ‡å®šæ•°é‡çš„å…ƒç´ </td><td>LREM msg 2 "hello" â†’ åˆ é™¤ 2 ä¸ª "hello"</td></tr></tbody></table>
<h4 data-id="heading-27">å®æˆ˜åœºæ™¯ï¼šç®€å•æ¶ˆæ¯é˜Ÿåˆ—</h4>
<p>ç”Ÿäº§è€…å¾€é˜Ÿåˆ—å°¾éƒ¨æ·»åŠ æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…é˜»å¡å¼è·å–æ¶ˆæ¯ï¼š</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># ç”Ÿäº§è€…ï¼šæ·»åŠ 3æ¡æ¶ˆæ¯</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">RPUSH</span> <span class="hljs-symbol">msg:</span>queue <span class="hljs-string">"order:1001"</span> <span class="hljs-string">"order:1002"</span> <span class="hljs-string">"order:1003"</span>
(integer) <span class="hljs-number">3</span>
<span class="hljs-comment"># æ¶ˆè´¹è€…ï¼šé˜»å¡å¼è·å–æ¶ˆæ¯ï¼ˆæ— æ¶ˆæ¯æ—¶ç­‰å¾…ï¼‰</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">BRPOP</span> <span class="hljs-symbol">msg:</span>queue <span class="hljs-number">0</span>
<span class="hljs-number">1</span>) <span class="hljs-string">"msg:queue"</span>
<span class="hljs-number">2</span>) <span class="hljs-string">"order:1003"</span> <span class="hljs-comment"># å…ˆè·å–å°¾éƒ¨çš„æ¶ˆæ¯ï¼ˆFIFOï¼‰</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">BRPOP</span> <span class="hljs-symbol">msg:</span>queue <span class="hljs-number">0</span>
<span class="hljs-number">1</span>) <span class="hljs-string">"msg:queue"</span>
<span class="hljs-number">2</span>) <span class="hljs-string">"order:1002"</span>
</code></pre>
<h3 data-id="heading-28">4.4 é›†åˆï¼ˆSetï¼‰</h3>
<p>Set æ˜¯æ— åºã€ä¸å¯é‡å¤çš„å­—ç¬¦ä¸²é›†åˆï¼Œæ”¯æŒäº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰é›†åˆæ“ä½œï¼Œé€‚åˆå»é‡ã€æ ‡ç­¾ã€æŠ½å¥–åœºæ™¯ã€‚</p>
<h4 data-id="heading-29">æ ¸å¿ƒå‘½ä»¤</h4>




























































<table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>SADD key member</td><td>æ·»åŠ å…ƒç´ ï¼ˆé‡å¤æ·»åŠ æ— æ•ˆï¼‰</td><td>SADD tag:1001 "java" "python" â†’ 2</td></tr><tr><td>SMEMBERS key</td><td>è·å–æ‰€æœ‰å…ƒç´ </td><td>SMEMBERS tag:1001 â†’ ["java","python"]</td></tr><tr><td>SISMEMBER key member</td><td>åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨</td><td>SISMEMBER tag:1001 "java" â†’ 1ï¼ˆå­˜åœ¨ï¼‰</td></tr><tr><td>SREM key member</td><td>åˆ é™¤å…ƒç´ </td><td>SREM tag:1001 "python" â†’ 1</td></tr><tr><td>SCARD key</td><td>è·å–é›†åˆå¤§å°</td><td>SCARD tag:1001 â†’ 1</td></tr><tr><td>SINTER key1 key2</td><td>æ±‚äº¤é›†</td><td>SINTER tag:1001 tag:1002 â†’ å…±åŒæ ‡ç­¾</td></tr><tr><td>SUNION key1 key2</td><td>æ±‚å¹¶é›†</td><td>SUNION tag:1001 tag:1002 â†’ æ‰€æœ‰æ ‡ç­¾</td></tr><tr><td>SDIFF key1 key2</td><td>æ±‚å·®é›†ï¼ˆkey1 æœ‰ï¼Œkey2 æ— ï¼‰</td><td>SDIFF tag:1001 tag:1002 â†’ ç‹¬æœ‰æ ‡ç­¾</td></tr><tr><td>SRANDMEMBER key count</td><td>éšæœºè·å– count ä¸ªå…ƒç´ ï¼ˆä¸åˆ é™¤ï¼‰</td><td>SRANDMEMBER prize 1 â†’ éšæœºæŠ½å¥– 1 å</td></tr><tr><td>SPOP key count</td><td>éšæœºåˆ é™¤ count ä¸ªå…ƒç´ ï¼ˆæŠ½å¥–å¸¸ç”¨ï¼‰</td><td>SPOP prize 1 â†’ éšæœºæŠ½ 1 åå¹¶ç§»é™¤</td></tr></tbody></table>
<h4 data-id="heading-30">å®æˆ˜åœºæ™¯ï¼šæŠ½å¥–æ´»åŠ¨</h4>
<p>éœ€æ±‚ï¼šä» 10 ä¸ªç”¨æˆ·ä¸­éšæœºæŠ½å– 1 åä¸€ç­‰å¥–ã€2 åäºŒç­‰å¥–ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># æ·»åŠ æŠ½å¥–ç”¨æˆ·</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">SADD</span> <span class="hljs-symbol">prize:</span><span class="hljs-number">2024</span> user1 user2 user3 user4 user5 user6 user7 user8 user9 user10
(integer) <span class="hljs-number">10</span>
<span class="hljs-comment"># æŠ½ä¸€ç­‰å¥–ï¼ˆéšæœºåˆ é™¤1ä¸ªï¼‰</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">SPOP</span> <span class="hljs-symbol">prize:</span><span class="hljs-number">2024</span> <span class="hljs-number">1</span>
<span class="hljs-number">1</span>) <span class="hljs-string">"user5"</span>
<span class="hljs-comment"># æŠ½äºŒç­‰å¥–ï¼ˆéšæœºåˆ é™¤2ä¸ªï¼‰</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">SPOP</span> <span class="hljs-symbol">prize:</span><span class="hljs-number">2024</span> <span class="hljs-number">2</span>
<span class="hljs-number">1</span>) <span class="hljs-string">"user8"</span>
<span class="hljs-number">2</span>) <span class="hljs-string">"user2"</span>
</code></pre>
<h3 data-id="heading-31">4.5 æœ‰åºé›†åˆï¼ˆZSetï¼‰</h3>
<p>ZSet æ˜¯æœ‰åºã€ä¸å¯é‡å¤çš„é›†åˆï¼Œæ¯ä¸ªå…ƒç´ å…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆscoreï¼‰ï¼ŒæŒ‰åˆ†æ•°æ’åºï¼Œé€‚åˆæ’è¡Œæ¦œã€å»¶æ—¶ä»»åŠ¡ã€‚</p>
<h4 data-id="heading-32">æ ¸å¿ƒå‘½ä»¤</h4>













































<table><thead><tr><th>å‘½ä»¤</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>ZADD key score member</td><td>æ·»åŠ å…ƒç´ ï¼ˆscore ä¸ºæ•°å­—ï¼‰</td><td>ZADD rank:sales 100 "å•†å“ A" 200 "å•†å“ B" â†’ 2</td></tr><tr><td>ZRANGE key start end [WITHSCORES]</td><td>æŒ‰åˆ†æ•°å‡åºè·å–å…ƒç´ ï¼ˆå¸¦åˆ†æ•°ï¼‰</td><td>ZRANGE rank:sales 0 -1 WITHSCORES â†’ ["å•†å“ A","100","å•†å“ B","200"]</td></tr><tr><td>ZREVRANGE key start end [WITHSCORES]</td><td>æŒ‰åˆ†æ•°é™åºè·å–å…ƒç´ </td><td>ZREVRANGE rank:sales 0 0 WITHSCORES â†’ ["å•†å“ B","200"]ï¼ˆç¬¬ä¸€åï¼‰</td></tr><tr><td>ZSCORE key member</td><td>è·å–å…ƒç´ åˆ†æ•°</td><td>ZSCORE rank:sales "å•†å“ A" â†’ "100"</td></tr><tr><td>ZINCRBY key increment member</td><td>å¢åŠ å…ƒç´ åˆ†æ•°</td><td>ZINCRBY rank:sales 50 "å•†å“ A" â†’ 150</td></tr><tr><td>ZREM key member</td><td>åˆ é™¤å…ƒç´ </td><td>ZREM rank:sales "å•†å“ A" â†’ 1</td></tr><tr><td>ZCOUNT key min max</td><td>ç»Ÿè®¡åˆ†æ•°èŒƒå›´å†…çš„å…ƒç´ æ•°é‡</td><td>ZCOUNT rank:sales 100 200 â†’ 2</td></tr></tbody></table>
<h4 data-id="heading-33">å®æˆ˜åœºæ™¯ï¼šå•†å“é”€é‡æ’è¡Œæ¦œ</h4>
<p>éœ€æ±‚ï¼šå®æ—¶æ›´æ–°å•†å“é”€é‡ï¼Œå±•ç¤ºé”€é‡å‰ 3 çš„å•†å“ã€‚</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># åˆå§‹åŒ–é”€é‡</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">ZADD</span> <span class="hljs-symbol">rank:</span>sales <span class="hljs-number">50</span> <span class="hljs-string">"å•†å“1"</span> <span class="hljs-number">80</span> <span class="hljs-string">"å•†å“2"</span> <span class="hljs-number">120</span> <span class="hljs-string">"å•†å“3"</span> <span class="hljs-number">90</span> <span class="hljs-string">"å•†å“4"</span>
(integer) <span class="hljs-number">4</span>
<span class="hljs-comment"># å•†å“2é”€é‡+20</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">ZINCRBY</span> <span class="hljs-symbol">rank:</span>sales <span class="hljs-number">20</span> <span class="hljs-string">"å•†å“2"</span>
<span class="hljs-string">"100"</span>
<span class="hljs-comment"># æŸ¥çœ‹é”€é‡å‰3çš„å•†å“ï¼ˆé™åºï¼‰</span>
<span class="hljs-meta prompt_">127.0.0.1:6379&gt;</span> <span class="hljs-variable constant_">ZREVRANGE</span> <span class="hljs-symbol">rank:</span>sales <span class="hljs-number">0</span> <span class="hljs-number">2</span> <span class="hljs-variable constant_">WITHSCORES</span>
<span class="hljs-number">1</span>) <span class="hljs-string">"å•†å“3"</span>
<span class="hljs-number">2</span>) <span class="hljs-string">"120"</span>
<span class="hljs-number">3</span>) <span class="hljs-string">"å•†å“2"</span>
<span class="hljs-number">4</span>) <span class="hljs-string">"100"</span>
<span class="hljs-number">5</span>) <span class="hljs-string">"å•†å“4"</span>
<span class="hljs-number">6</span>) <span class="hljs-string">"90"</span>
</code></pre>
<h2 data-id="heading-34">äº”ã€Redis é«˜çº§ç‰¹æ€§</h2>
<h3 data-id="heading-35">5.1 åˆ†å¸ƒå¼é”</h3>
<p>Redis æ˜¯å®ç°åˆ†å¸ƒå¼é”çš„å¸¸ç”¨æ–¹æ¡ˆï¼Œæ ¸å¿ƒåŸç†æ˜¯åˆ©ç”¨ <code>SETNX</code> å‘½ä»¤ï¼ˆä»…å½“é”®ä¸å­˜åœ¨æ—¶è®¾ç½®ï¼‰ï¼Œç»“åˆè¿‡æœŸæ—¶é—´é¿å…æ­»é”ã€‚</p>
<h4 data-id="heading-36">æ ‡å‡†å®ç°æ­¥éª¤</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># 1. è·å–é”ï¼ˆSET NX EX åŸå­æ“ä½œï¼Œé¿å…å¹¶å‘é—®é¢˜ï¼‰</span>
SET <span class="hljs-keyword">lock</span>:order <span class="hljs-number">1</span> NX EX <span class="hljs-number">30</span>
<span class="hljs-meta"># å‚æ•°è¯´æ˜ï¼š</span>
<span class="hljs-meta"># NX â†’ ä»…å½“é”®ä¸å­˜åœ¨æ—¶è®¾ç½®</span>
<span class="hljs-meta"># EX 30 â†’ 30ç§’è¿‡æœŸï¼ˆé¿å…æœåŠ¡å®•æœºå¯¼è‡´æ­»é”ï¼‰</span>
<span class="hljs-meta"># è¿”å› OK è¡¨ç¤ºè·å–é”æˆåŠŸï¼Œå¦åˆ™å¤±è´¥</span>

<span class="hljs-meta"># 2. æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æ‰£å‡åº“å­˜ï¼‰</span>

<span class="hljs-meta"># 3. é‡Šæ”¾é”ï¼ˆåˆ é™¤é”®ï¼‰</span>
DEL <span class="hljs-keyword">lock</span>:order
</code></pre>
<h4 data-id="heading-37">æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>
<p>è¿‡æœŸæ—¶é—´éœ€å¤§äºä¸šåŠ¡æ‰§è¡Œæ—¶é—´ï¼Œé¿å…é”æå‰é‡Šæ”¾ï¼›</p>
</li>
<li>
<p>é‡Šæ”¾é”æ—¶å»ºè®®ç”¨ Lua è„šæœ¬éªŒè¯é”çš„æŒæœ‰è€…ï¼ˆé˜²æ­¢è¯¯åˆ å…¶ä»–å®¢æˆ·ç«¯çš„é”ï¼‰ï¼š</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">if</span> redis.<span class="hljs-keyword">call</span>(<span class="hljs-comment">'get', KEYS[1]) == ARGV[1] then</span>
    <span class="hljs-keyword">return</span> redis.<span class="hljs-keyword">call</span>(<span class="hljs-comment">'del', KEYS[1])</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
<span class="hljs-keyword">end</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-38">5.2 ç®¡é“ï¼ˆPipelineï¼‰</h3>
<p>Redis ç®¡é“å…è®¸ä¸€æ¬¡æ€§å‘é€å¤šä¸ªå‘½ä»¤ï¼Œå‡å°‘ç½‘ç»œå¾€è¿”æ¬¡æ•°ï¼Œæå‡æ‰¹é‡æ“ä½œæ€§èƒ½ã€‚</p>
<p>ç¤ºä¾‹ï¼šæ‰¹é‡è®¾ç½® 1000 ä¸ªé”®å€¼å¯¹</p>
<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># å¼€å¯ç®¡é“</span>
redis-cli -a yourpassword --<span class="hljs-keyword">pipe</span>
<span class="hljs-comment"># è¾“å…¥å‘½ä»¤ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰</span>
SET key1 value1
SET key2 value2
...
SET key100<span class="hljs-number">0</span> value100<span class="hljs-number">0</span>
<span class="hljs-comment"># æŒ‰ Ctrl+D æ‰§è¡Œ</span>
</code></pre>
<h3 data-id="heading-39">5.3 Lua è„šæœ¬</h3>
<p>Redis æ”¯æŒ Lua è„šæœ¬ï¼Œè„šæœ¬å†…çš„å‘½ä»¤åŸå­æ‰§è¡Œï¼Œé€‚åˆå¤æ‚ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æ‰£å‡åº“å­˜ + æ›´æ–°é”€é‡ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ï¼šæ‰£å‡å•†å“åº“å­˜ï¼ˆåº“å­˜ &gt; 0 æ—¶æ‰£å‡ï¼Œå¦åˆ™è¿”å›å¤±è´¥ï¼‰</p>
<pre><code class="hljs language-lua" lang="lua"><span class="hljs-comment">-- è„šæœ¬å‚æ•°ï¼šKEYS[1] = åº“å­˜é”®ï¼ŒARGV[1] = æ‰£å‡æ•°é‡</span>
<span class="hljs-keyword">local</span> stock = <span class="hljs-built_in">tonumber</span>(redis.call(<span class="hljs-string">'get'</span>, KEYS[<span class="hljs-number">1</span>]))
<span class="hljs-keyword">local</span> num = <span class="hljs-built_in">tonumber</span>(ARGV[<span class="hljs-number">1</span>])
<span class="hljs-keyword">if</span> stock <span class="hljs-keyword">and</span> stock &gt;= num <span class="hljs-keyword">then</span>
    redis.call(<span class="hljs-string">'decrby'</span>, KEYS[<span class="hljs-number">1</span>], num)
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> <span class="hljs-comment">-- æ‰£å‡æˆåŠŸ</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> <span class="hljs-comment">-- åº“å­˜ä¸è¶³</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>æ‰§è¡Œè„šæœ¬ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-number">127.0</span><span class="hljs-selector-class">.0</span><span class="hljs-selector-class">.1</span>:<span class="hljs-number">6379</span>&gt; <span class="hljs-selector-tag">EVAL</span> "<span class="hljs-selector-tag">local</span> <span class="hljs-selector-tag">stock</span> = <span class="hljs-selector-tag">tonumber</span>(redis.<span class="hljs-built_in">call</span>(<span class="hljs-string">'get'</span>, KEYS[<span class="hljs-number">1</span>])) <span class="hljs-selector-tag">local</span> <span class="hljs-selector-tag">num</span> = <span class="hljs-selector-tag">tonumber</span>(ARGV[<span class="hljs-number">1</span>]) <span class="hljs-selector-tag">if</span> <span class="hljs-selector-tag">stock</span> <span class="hljs-selector-tag">and</span> <span class="hljs-selector-tag">stock</span> &gt;= <span class="hljs-selector-tag">num</span> <span class="hljs-selector-tag">then</span> <span class="hljs-selector-tag">redis</span><span class="hljs-selector-class">.call</span>(<span class="hljs-string">'decrby'</span>, KEYS[<span class="hljs-number">1</span>], num) <span class="hljs-selector-tag">return</span> <span class="hljs-number">1</span> <span class="hljs-selector-tag">else</span> <span class="hljs-selector-tag">return</span> <span class="hljs-number">0</span> <span class="hljs-selector-tag">end</span>" <span class="hljs-number">1</span> <span class="hljs-selector-tag">stock</span>:<span class="hljs-number">1001</span> <span class="hljs-number">2</span>
# å‚æ•°è¯´æ˜ï¼š<span class="hljs-number">1</span> â†’ <span class="hljs-selector-tag">KEYS</span>æ•°ç»„é•¿åº¦ï¼Œ<span class="hljs-selector-tag">stock</span>:<span class="hljs-number">1001</span> â†’ <span class="hljs-selector-tag">KEYS</span><span class="hljs-selector-attr">[1]</span>ï¼Œ<span class="hljs-number">2</span> â†’ <span class="hljs-selector-tag">ARGV</span><span class="hljs-selector-attr">[1]</span>
</code></pre>
<h3 data-id="heading-40">5.4 ä¸»ä»å¤åˆ¶</h3>
<p>ä¸»ä»å¤åˆ¶ç”¨äºæ•°æ®å¤‡ä»½å’Œè¯»å†™åˆ†ç¦»ï¼š</p>
<ul>
<li><strong>ä¸»åº“ï¼ˆMasterï¼‰</strong> ï¼šå¤„ç†æ‰€æœ‰å†™æ“ä½œï¼ŒåŒæ­¥æ•°æ®åˆ°ä»åº“ï¼›</li>
<li><strong>ä»åº“ï¼ˆSlaveï¼‰</strong> ï¼šåªè¯»ï¼Œåˆ†æ‹…è¯»æ“ä½œå‹åŠ›ã€‚</li>
</ul>
<p>é…ç½®æ­¥éª¤ï¼š</p>
<ol>
<li>
<p>å¤åˆ¶ä¸»åº“é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ç«¯å£ï¼ˆå¦‚ 6380ï¼‰ã€pid æ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ï¼›</p>
</li>
<li>
<p>åœ¨ä»åº“é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">replicaof ä¸»åº“IP ä¸»åº“ç«¯å£
masterauth ä¸»åº“å¯†ç 
replica-read-only <span class="hljs-built_in">yes</span> <span class="hljs-comment"># ä»åº“åªè¯»</span>
</code></pre>
</li>
<li>
<p>å¯åŠ¨ä»åº“ï¼Œæ‰§è¡Œ <code>INFO replication</code> æŸ¥çœ‹å¤åˆ¶çŠ¶æ€ã€‚</p>
</li>
</ol>
<h3 data-id="heading-41">5.5 å“¨å…µï¼ˆSentinelï¼‰</h3>
<p>å“¨å…µç”¨äºç›‘æ§ä¸»ä»åº“ï¼Œå½“ä¸»åº“å®•æœºæ—¶è‡ªåŠ¨å°†ä»åº“åˆ‡æ¢ä¸ºä¸»åº“ï¼Œä¿è¯é«˜å¯ç”¨ã€‚</p>
<p>æ ¸å¿ƒé…ç½®ï¼ˆsentinel.confï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">port 26379
daemonize <span class="hljs-built_in">yes</span>
logfile <span class="hljs-string">"/usr/local/redis/log/sentinel.log"</span>
<span class="hljs-comment"># ç›‘æ§ä¸»åº“ï¼šmymaster ä¸ºä¸»åº“åç§°ï¼Œ2 ä¸ºè‡³å°‘2ä¸ªå“¨å…µåŒæ„åˆ‡æ¢</span>
sentinel monitor mymaster 127.0.0.1 6379 2
<span class="hljs-comment"># ä¸»åº“å¯†ç </span>
sentinel auth-pass mymaster yourpassword
<span class="hljs-comment"># ä¸»åº“å®•æœºåå¤šä¹…åˆ‡æ¢ï¼ˆæ¯«ç§’ï¼‰</span>
sentinel down-after-milliseconds mymaster 30000
</code></pre>
<p>å¯åŠ¨å“¨å…µï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-sentinel /usr/local/redis/conf/sentinel.conf
</code></pre>
<h2 data-id="heading-42">å…­ã€Redis å¸¸è§é—®é¢˜ä¸ä¼˜åŒ–</h2>
<h3 data-id="heading-43">6.1 ç¼“å­˜ç©¿é€</h3>
<ul>
<li>
<p><strong>é—®é¢˜</strong>ï¼šè¯·æ±‚ä¸å­˜åœ¨çš„ Keyï¼Œæ¯æ¬¡éƒ½ç©¿é€åˆ°æ•°æ®åº“ï¼›</p>
</li>
<li>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>ç¼“å­˜ç©ºå€¼ï¼ˆè®¾ç½®çŸ­æœŸè¿‡æœŸæ—¶é—´ï¼‰ï¼›</li>
<li>å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆæå‰è¿‡æ»¤ä¸å­˜åœ¨çš„ Keyï¼‰ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-44">6.2 ç¼“å­˜å‡»ç©¿</h3>
<ul>
<li>
<p><strong>é—®é¢˜</strong>ï¼šçƒ­ç‚¹ Key è¿‡æœŸç¬é—´ï¼Œå¤§é‡è¯·æ±‚ç©¿é€åˆ°æ•°æ®åº“ï¼›</p>
</li>
<li>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>çƒ­ç‚¹ Key æ°¸ä¸è¿‡æœŸï¼›</li>
<li>äº’æ–¥é”ï¼ˆè¯·æ±‚æ—¶å…ˆè·å–é”ï¼Œå†æŸ¥æ•°æ®åº“æ›´æ–°ç¼“å­˜ï¼‰ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-45">6.3 ç¼“å­˜é›ªå´©</h3>
<ul>
<li>
<p><strong>é—®é¢˜</strong>ï¼šå¤§é‡ Key åŒæ—¶è¿‡æœŸï¼Œæ•°æ®åº“å‹åŠ›éª¤å¢ï¼›</p>
</li>
<li>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ol>
<li>è¿‡æœŸæ—¶é—´åŠ éšæœºå€¼ï¼ˆé¿å…åŒæ—¶è¿‡æœŸï¼‰ï¼›</li>
<li>ä¸»ä» + å“¨å…µä¿è¯ Redis é«˜å¯ç”¨ï¼›</li>
<li>é™æµå‰Šå³°ï¼ˆæ§åˆ¶æ•°æ®åº“è¯·æ±‚æ•°ï¼‰ã€‚</li>
</ol>
</li>
</ul>
<h3 data-id="heading-46">6.4 å†…å­˜ä¼˜åŒ–</h3>
<ul>
<li>é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„ï¼ˆå¦‚ç”¨ Hash å­˜å‚¨å¯¹è±¡ï¼Œä»£æ›¿å¤šä¸ª Stringï¼‰ï¼›</li>
<li>è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´å’Œæ·˜æ±°ç­–ç•¥ï¼›</li>
<li>é¿å…å¤§ Keyï¼ˆå¦‚è¶…å¤§å­—ç¬¦ä¸²ã€ç™¾ä¸‡çº§ Listï¼‰ï¼Œæ‹†åˆ†å¤§ Keyã€‚</li>
</ul>
<h3 data-id="heading-47">6.5 æ€§èƒ½ä¼˜åŒ–</h3>
<ul>
<li>å¼€å¯æŒä¹…åŒ–æ—¶é€‰æ‹©æ··åˆæŒä¹…åŒ–ï¼›</li>
<li>ä½¿ç”¨ç®¡é“æ‰¹é‡æ“ä½œï¼›</li>
<li>é¿å…é¢‘ç¹çš„ KEYSã€FLUSHDB ç­‰é˜»å¡å‘½ä»¤ï¼›</li>
<li>é…ç½®åˆç†çš„ maxmemory å’Œæ·˜æ±°ç­–ç•¥ã€‚</li>
</ul>
<h2 data-id="heading-48">ä¸ƒã€Redis å®¢æˆ·ç«¯ä½¿ç”¨ï¼ˆNode.js ç¤ºä¾‹ï¼‰</h2>
<p>ä»¥ Node.js çš„ <code>ioredis</code> åº“ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•æ“ä½œ Redisï¼š</p>
<h3 data-id="heading-49">7.1 å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs">npm install ioredis
</code></pre>
<h3 data-id="heading-50">7.2 åŸºæœ¬ä½¿ç”¨</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Redis</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ioredis'</span>);

<span class="hljs-comment">// è¿æ¥ Redis</span>
<span class="hljs-keyword">const</span> redis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Redis</span>({
  <span class="hljs-attr">host</span>: <span class="hljs-string">'127.0.0.1'</span>,
  <span class="hljs-attr">port</span>: <span class="hljs-number">6379</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">'yourpassword'</span>,
  <span class="hljs-attr">db</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// æ•°æ®åº“ç¼–å·ï¼ˆé»˜è®¤0ï¼‰</span>
});

<span class="hljs-comment">// æµ‹è¯•è¿æ¥</span>
redis.<span class="hljs-title function_">ping</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¿æ¥æˆåŠŸï¼š'</span>, res); <span class="hljs-comment">// PONG</span>
});

<span class="hljs-comment">// æ“ä½œ String</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testString</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">await</span> redis.<span class="hljs-title function_">set</span>(<span class="hljs-string">'name'</span>, <span class="hljs-string">'redis-test'</span>);
  <span class="hljs-keyword">const</span> name = <span class="hljs-keyword">await</span> redis.<span class="hljs-title function_">get</span>(<span class="hljs-string">'name'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Stringå€¼ï¼š'</span>, name); <span class="hljs-comment">// redis-test</span>
}

<span class="hljs-comment">// æ“ä½œ Hash</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testHash</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">await</span> redis.<span class="hljs-title function_">hset</span>(<span class="hljs-string">'user:1001'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'å¼ ä¸‰'</span>, <span class="hljs-string">'age'</span>, <span class="hljs-number">25</span>);
  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> redis.<span class="hljs-title function_">hgetall</span>(<span class="hljs-string">'user:1001'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Hashå€¼ï¼š'</span>, user); <span class="hljs-comment">// { name: 'å¼ ä¸‰', age: '25' }</span>
}

<span class="hljs-comment">// æ“ä½œ ZSet</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testZSet</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">await</span> redis.<span class="hljs-title function_">zadd</span>(<span class="hljs-string">'rank:score'</span>, <span class="hljs-number">90</span>, <span class="hljs-string">'å°æ˜'</span>, <span class="hljs-number">85</span>, <span class="hljs-string">'å°çº¢'</span>);
  <span class="hljs-keyword">const</span> rank = <span class="hljs-keyword">await</span> redis.<span class="hljs-title function_">zrevrange</span>(<span class="hljs-string">'rank:score'</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-string">'WITHSCORES'</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ZSetæ’è¡Œæ¦œï¼š'</span>, rank); <span class="hljs-comment">// [ 'å°æ˜', '90', 'å°çº¢', '85' ]</span>
}

<span class="hljs-comment">// æ‰§è¡Œæµ‹è¯•</span>
<span class="hljs-title function_">testString</span>();
<span class="hljs-title function_">testHash</span>();
<span class="hljs-title function_">testZSet</span>();
</code></pre>
<h2 data-id="heading-51">æ€»ç»“</h2>
<ol>
<li>Redis æ˜¯é«˜æ€§èƒ½å†…å­˜æ•°æ®åº“ï¼Œæ ¸å¿ƒä¼˜åŠ¿æ˜¯é€Ÿåº¦å¿«ã€æ”¯æŒå¤šæ•°æ®ç»“æ„ã€å¯æŒä¹…åŒ–ï¼Œä¸»è¦ç”¨äºç¼“å­˜ã€åˆ†å¸ƒå¼é”ã€æ’è¡Œæ¦œç­‰åœºæ™¯ï¼›</li>
<li>æ ¸å¿ƒæ•°æ®ç»“æ„åŒ…æ‹¬ Stringï¼ˆç¼“å­˜ / è®¡æ•°å™¨ï¼‰ã€Hashï¼ˆå¯¹è±¡å­˜å‚¨ï¼‰ã€Listï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ã€Setï¼ˆå»é‡ / æŠ½å¥–ï¼‰ã€ZSetï¼ˆæ’è¡Œæ¦œï¼‰ï¼Œéœ€æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚ç±»å‹ï¼›</li>
<li>ç”Ÿäº§ç¯å¢ƒéœ€æ³¨æ„é…ç½®æŒä¹…åŒ–ï¼ˆæ··åˆæŒä¹…åŒ–ï¼‰ã€è®¾ç½®å¯†ç ã€å¼€å¯ä¸»ä» / å“¨å…µä¿è¯é«˜å¯ç”¨ï¼ŒåŒæ—¶è§„é¿ç¼“å­˜ç©¿é€ã€å‡»ç©¿ã€é›ªå´©ç­‰é—®é¢˜ï¼›</li>
<li>æ“ä½œ Redis æ—¶ä¼˜å…ˆä½¿ç”¨åŸå­å‘½ä»¤ï¼ˆå¦‚ SET NX EXï¼‰ã€Lua è„šæœ¬ã€ç®¡é“ï¼Œæå‡æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚</li>
</ol>
<p>æŒæ¡æœ¬æ–‡çš„å†…å®¹åï¼Œä½ å¯ä»¥åº”å¯¹å¤§éƒ¨åˆ† Redis æ—¥å¸¸ä½¿ç”¨åœºæ™¯ï¼Œè¿›é˜¶å­¦ä¹ å¯æ·±å…¥ç ”ç©¶ Redis é›†ç¾¤ã€æºç ã€æ€§èƒ½è°ƒä¼˜ç­‰æ–¹å‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[GORM æ³›å‹æ–°å§¿åŠ¿ï¼šå‘Šåˆ«â€œç±»å‹æ“¦é™¤â€ï¼Œæ‹¥æŠ±ç±»å‹å®‰å…¨ï¼]]></title>    <link>https://juejin.cn/post/7601069677567197230</link>    <guid>https://juejin.cn/post/7601069677567197230</guid>    <pubDate>2026-02-01T01:08:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601069677567197230" data-draft-id="7598435950410776586" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="GORM æ³›å‹æ–°å§¿åŠ¿ï¼šå‘Šåˆ«â€œç±»å‹æ“¦é™¤â€ï¼Œæ‹¥æŠ±ç±»å‹å®‰å…¨ï¼"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-01T01:08:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="golangå­¦ä¹ è®°"/> <meta itemprop="url" content="https://juejin.cn/user/4371313964100990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            GORM æ³›å‹æ–°å§¿åŠ¿ï¼šå‘Šåˆ«â€œç±»å‹æ“¦é™¤â€ï¼Œæ‹¥æŠ±ç±»å‹å®‰å…¨ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4371313964100990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    golangå­¦ä¹ è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T01:08:45.000Z" title="Sun Feb 01 2026 01:08:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ¤” ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹ç‰ˆ GORMï¼Ÿ</h2>
<p>åœ¨æ³›å‹å‡ºç°å‰ï¼ŒGORM çš„ API é•¿è¿™æ ·ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> user User
db.Where(<span class="hljs-string">"name = ?"</span>, <span class="hljs-string">"jinzhu"</span>).First(&amp;user)
</code></pre>
<p>çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼Ÿä½†å½“ä½ å†™æˆï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> user User
db.Where(<span class="hljs-string">"name = ?"</span>, <span class="hljs-string">"jinzhu"</span>).First(&amp;Order{}) <span class="hljs-comment">// âŒ ä¼ é”™ç±»å‹äº†ï¼</span>
</code></pre>
<p>GORM ä¸ä¼šæŠ¥é”™ï¼ˆè¿è¡Œæ—¶å¯èƒ½ panic æˆ–æŸ¥é”™è¡¨ï¼‰ï¼Œå› ä¸º <code>*gorm.DB</code> æ˜¯â€œä¸‡èƒ½å®¹å™¨â€ï¼Œç±»å‹ä¿¡æ¯åœ¨ç¼–è¯‘æœŸå°±ä¸¢äº†ã€‚</p>
<p><strong>æ³›å‹ç‰ˆ GORM è§£å†³äº†è¿™ä¸ªé—®é¢˜</strong>ï¼šæ¯ä¸ªæ“ä½œéƒ½ç»‘å®šåˆ°å…·ä½“æ¨¡å‹ï¼Œç±»å‹é”™è¯¯ç›´æ¥åœ¨ç¼–è¯‘æ—¶æŠ¥é”™ï¼</p>
<hr/>
<h2 data-id="heading-1">ğŸš€ å¿«é€Ÿä¸Šæ‰‹ï¼šGORM æ³›å‹ä¸‰æ­¥èµ°</h2>
<h3 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼šå‡çº§ GORMï¼ˆ&gt;= v1.30.0ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">go get -u gorm.io/gorm@latest
</code></pre>
<h3 data-id="heading-3">ç¬¬äºŒæ­¥ï¼šç”¨ <code>G[Model]</code> åŒ…è£¹ä½ çš„æ¨¡å‹</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">import</span> <span class="hljs-string">"gorm.io/gorm"</span>

<span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼</span>
db.Where(<span class="hljs-string">"name = ?"</span>, <span class="hljs-string">"alice"</span>).First(&amp;user)

<span class="hljs-comment">// æ³›å‹æ–¹å¼ âœ¨</span>
err := gorm.G[User](db).Where(<span class="hljs-string">"name = ?"</span>, <span class="hljs-string">"alice"</span>).First(ctx, &amp;user)
</code></pre>
<blockquote>
<p>ğŸ’¡ <code>ctx</code> æ˜¯ contextï¼Œæ¨èå¸¦ä¸Šï¼ˆæ”¯æŒè¶…æ—¶ã€å–æ¶ˆç­‰ï¼‰ã€‚</p>
</blockquote>
<h3 data-id="heading-4">ç¬¬ä¸‰æ­¥ï¼šäº«å—ç±»å‹å®‰å…¨ + è‡ªåŠ¨è¡¥å…¨ï¼</h3>
<p>IDE èƒ½ç²¾å‡†çŸ¥é“ä½ æŸ¥çš„æ˜¯ <code>User</code>ï¼Œå­—æ®µæç¤ºã€æ–¹æ³•é“¾éƒ½æ›´æ™ºèƒ½ï¼</p>
<hr/>
<h2 data-id="heading-5">ğŸ± å®æˆ˜å°ä¾‹å­ï¼šä¸€ä¸ªâ€œç”¨æˆ·-è®¢å•â€ç³»ç»Ÿ</h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰è¿™ä¸¤ä¸ªæ¨¡å‹ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> {
	ID    <span class="hljs-type">uint</span>
	Name  <span class="hljs-type">string</span>
	Email <span class="hljs-type">string</span>
}

<span class="hljs-keyword">type</span> Order <span class="hljs-keyword">struct</span> {
	ID     <span class="hljs-type">uint</span>
	UserID <span class="hljs-type">uint</span>
	Amount <span class="hljs-type">float64</span>
	Status <span class="hljs-type">string</span>
}
</code></pre>
<h3 data-id="heading-6">âœ… åœºæ™¯ 1ï¼šå®‰å…¨åœ°æŸ¥ç”¨æˆ·</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetUserByName</span><span class="hljs-params">(db *gorm.DB, name <span class="hljs-type">string</span>)</span></span> (*User, <span class="hljs-type">error</span>) {
	<span class="hljs-keyword">var</span> user User
	err := gorm.G[User](db).Where(<span class="hljs-string">"name = ?"</span>, name).First(context.Background(), &amp;user)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err
	}
	<span class="hljs-keyword">return</span> &amp;user, <span class="hljs-literal">nil</span>
}
</code></pre>
<blockquote>
<p>ğŸ”’ å¦‚æœä½ æ‰‹æ»‘å†™æˆ <code>gorm.G[Order](db)...First(&amp;user)</code>ï¼Œ<strong>ç¼–è¯‘ç›´æ¥æŠ¥é”™</strong>ï¼å†ä¹Ÿä¸æ€•â€œå¼ å† ææˆ´â€ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-7">âœ… åœºæ™¯ 2ï¼šå¸¦å…³è”çš„æŸ¥è¯¢ï¼ˆJoinsï¼‰</h3>
<p>æƒ³æŸ¥â€œæ‰€æœ‰æœ‰è®¢å•çš„ç”¨æˆ·â€ï¼Ÿ</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> users []User
err := gorm.G[User](db).
	InnerJoin(<span class="hljs-string">"orders"</span>, <span class="hljs-string">"orders.user_id = users.id"</span>).
	Find(context.Background(), &amp;users)
</code></pre>
<blockquote>
<p>ğŸ¯ æ³›å‹ç‰ˆ <code>Joins</code> æ›´æ¸…æ™°ï¼Œè¿˜èƒ½æŒ‡å®š Join ç±»å‹ï¼ˆ<code>LeftJoin</code>, <code>InnerJoin</code> ç­‰ï¼‰ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-8">âœ… åœºæ™¯ 3ï¼šé¢„åŠ è½½è®¢å•ï¼ˆPreloadï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> user User
err := gorm.G[User](db).
	Preload(<span class="hljs-string">"Orders"</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(db *gorm.DB)</span></span> *gorm.DB {
		<span class="hljs-keyword">return</span> db.Where(<span class="hljs-string">"status = ?"</span>, <span class="hljs-string">"paid"</span>)
	}).
	First(context.Background(), &amp;user, <span class="hljs-number">1</span>)
</code></pre>
<blockquote>
<p>ğŸ’¡ æ³¨æ„ï¼šè™½ç„¶ <code>Preload</code> ä»ç”¨å­—ç¬¦ä¸²ï¼Œä½†ä¸»æ¨¡å‹ <code>User</code> æ˜¯ç±»å‹å®‰å…¨çš„ï¼</p>
</blockquote>
<hr/>
<h3 data-id="heading-9">âœ… åœºæ™¯ 4ï¼šæ’å…¥å†²çªå¤„ç†ï¼ˆUpsertï¼‰</h3>
<pre><code class="hljs language-go" lang="go">newUser := User{Name: <span class="hljs-string">"bob"</span>, Email: <span class="hljs-string">"bob@example.com"</span>}

err := gorm.G[User](db).Clauses(clause.OnConflict{
	Columns:   []clause.Column{{Name: <span class="hljs-string">"email"</span>}},
	DoUpdates: clause.AssignmentColumns([]<span class="hljs-type">string</span>{<span class="hljs-string">"name"</span>}),
}).Create(context.Background(), &amp;newUser)
</code></pre>
<blockquote>
<p>âœ… é‚®ç®±å”¯ä¸€ï¼Œå­˜åœ¨åˆ™æ›´æ–°åå­—ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-10">âœ… åœºæ™¯ 5ï¼šæ‰¹é‡å¤„ç†ï¼ˆFindInBatchesï¼‰</h3>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">var</span> batch []User
err := gorm.G[User](db).
	Where(<span class="hljs-string">"email LIKE ?"</span>, <span class="hljs-string">"%@example.com"</span>).
	FindInBatches(&amp;batch, <span class="hljs-number">100</span>, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(tx *gorm.DB, batchNum <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">error</span> {
		<span class="hljs-keyword">for</span> _, u := <span class="hljs-keyword">range</span> batch {
			fmt.Println(<span class="hljs-string">"Processing:"</span>, u.Name)
		}
		<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
	})
</code></pre>
<blockquote>
<p>ğŸ§  å†…å­˜å‹å¥½ï¼Œé€‚åˆå¤„ç†ç™¾ä¸‡çº§ç”¨æˆ·æ•°æ®ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-11">âš ï¸ æ³¨æ„ï¼šè¿™äº›æ–¹æ³•è¢«ç§»é™¤äº†ï¼</h2>
<p>ä¸ºäº†é˜²æ­¢è¯¯ç”¨ï¼Œæ³›å‹ç‰ˆ <strong>æ•…æ„ç§»é™¤äº†</strong> ä¸€äº›é«˜é£é™©æ–¹æ³•ï¼š</p>
<ul>
<li><code>Save()</code> â†’ æ”¹ç”¨ <code>Create</code> / <code>Update</code></li>
<li><code>FirstOrCreate()</code> â†’ æ”¹ç”¨ <code>First</code> + <code>Create</code> æ‰‹åŠ¨æ§åˆ¶</li>
</ul>
<blockquote>
<p>ğŸ¤” ä¸ºä»€ä¹ˆï¼Ÿå› ä¸º <code>Save</code> ä¼šæ ¹æ®ä¸»é”®è‡ªåŠ¨åˆ¤æ–­æ˜¯æ’å…¥è¿˜æ˜¯æ›´æ–°ï¼Œå®¹æ˜“å¼•å‘æ„å¤–è¦†ç›–ã€‚<br/>
æ˜¾å¼æ¯”éšå¼æ›´å®‰å…¨ï¼</p>
</blockquote>
<hr/>
<h2 data-id="heading-12">ğŸ› ï¸ è¿›é˜¶å½©è›‹ï¼šæœªæ¥å°†æ”¯æŒä»£ç ç”Ÿæˆï¼</h2>
<p>GORM æ­£åœ¨å¼€å‘ CLI å·¥å…·ï¼Œè®©ä½ ç”¨æ¥å£å®šä¹‰æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">type</span> UserQuery <span class="hljs-keyword">interface</span> {
	GetByEmail(email <span class="hljs-type">string</span>) (*User, <span class="hljs-type">error</span>)
	ListActive() ([]User, <span class="hljs-type">error</span>)
}
</code></pre>
<p>ç„¶åè‡ªåŠ¨ç”Ÿæˆç±»å‹å®‰å…¨çš„å®ç°ï¼å½»åº•å‘Šåˆ«æ‰‹å†™ SQL å­—ç¬¦ä¸² ğŸ˜</p>
<hr/>
<h2 data-id="heading-13">ğŸ‰ ç»“è¯­</h2>
<p>GORM çš„æ³›å‹ API ä¸æ˜¯â€œç‚«æŠ€â€ï¼Œè€Œæ˜¯<strong>ä¸ºå¤§å‹é¡¹ç›®ä¿é©¾æŠ¤èˆª</strong>ï¼š</p>
<ul>
<li>âœ… ç¼–è¯‘æœŸç±»å‹æ£€æŸ¥</li>
<li>âœ… æ›´å¥½çš„ IDE æ”¯æŒ</li>
<li>âœ… å‡å°‘è¿è¡Œæ—¶é”™è¯¯</li>
<li>âœ… ä¸æ—§ä»£ç å®Œå…¨å…¼å®¹ï¼ˆå¯æ··ç”¨ï¼ï¼‰</li>
</ul>
<blockquote>
<p><strong>å»ºè®®</strong>ï¼šæ–°é¡¹ç›®ç›´æ¥ç”¨æ³›å‹ç‰ˆï¼Œè€é¡¹ç›®é€æ­¥è¿ç§»ã€‚<br/>
å°±åƒä»â€œæ‰‹å†™ SQLâ€å‡çº§åˆ°â€œORMâ€ï¼Œå†ä»â€œé€šç”¨ ORMâ€å‡çº§åˆ°â€œæ³›å‹ ORMâ€â€”â€”æ¯ä¸€æ­¥éƒ½æ›´å®‰å…¨ã€æ›´é«˜æ•ˆï¼</p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœåŠ¡å™¨ç›´ä¼ æ–‡ä»¶åˆ° Slackï¼šç»•è¿‡æœ¬åœ°ç½‘ç»œç“¶é¢ˆçš„å®æˆ˜æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7601169987412230182</link>    <guid>https://juejin.cn/post/7601169987412230182</guid>    <pubDate>2026-02-01T01:42:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601169987412230182" data-draft-id="7601229476794990642" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœåŠ¡å™¨ç›´ä¼ æ–‡ä»¶åˆ° Slackï¼šç»•è¿‡æœ¬åœ°ç½‘ç»œç“¶é¢ˆçš„å®æˆ˜æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-01T01:42:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="puresai"/> <meta itemprop="url" content="https://juejin.cn/user/1398234520760856"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœåŠ¡å™¨ç›´ä¼ æ–‡ä»¶åˆ° Slackï¼šç»•è¿‡æœ¬åœ°ç½‘ç»œç“¶é¢ˆçš„å®æˆ˜æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1398234520760856/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    puresai
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T01:42:34.000Z" title="Sun Feb 01 2026 01:42:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘ä¸€æ®µæ—¶é—´ç»å¸¸æœ‰ä¸€äº›<strong>æ•°æ®å¯¼å‡ºç›¸å…³çš„å·¥ä½œ</strong>ï¼Œéœ€è¦ä»æœåŠ¡å™¨å¯¼å‡º CSV / Excel ç­‰æ–‡ä»¶ç»™ Sales åŒå­¦æŸ¥çœ‹ï¼Œè€Œ Sales çš„æ—¥å¸¸æ²Ÿé€šåŸºæœ¬éƒ½åœ¨ <strong>Slack</strong> ä¸Šå®Œæˆã€‚</p>
<p>å¦‚æœé‡‡ç”¨ä¼ ç»Ÿæ–¹å¼ï¼š</p>
<blockquote>
<p>æœåŠ¡å™¨ â†’ ä¸‹è½½åˆ°æœ¬åœ° â†’ å†ä¸Šä¼ åˆ° Slack</p>
</blockquote>
<p>é—®é¢˜éå¸¸æ˜æ˜¾ï¼š</p>
<ul>
<li>æ–‡ä»¶ç¨å¾®ä¸€å¤§ï¼Œä¸‹è½½ + ä¸Šä¼ éå¸¸æ…¢</li>
<li>ä¸‹åˆ 4 ç‚¹ä¹‹åç½‘é€Ÿæ˜æ˜¾ä¸‹é™ï¼ˆå¯èƒ½æ”¾å¯’å‡äº† ğŸ¤·ï¼‰</li>
<li>ä¸¥é‡ä¾èµ–æœ¬åœ°ç½‘ç»œï¼Œæ•ˆç‡ä¸å¯æ§</li>
<li>æ“ä½œæ­¥éª¤å¤šï¼Œä¸åˆ©äºé‡å¤æ‰§è¡Œ</li>
</ul>
<p>å› æ­¤å°±äº§ç”Ÿäº†ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•ï¼š</p>
<blockquote>
<p><strong>èƒ½ä¸èƒ½è®©æœåŠ¡å™¨ç›´æ¥æŠŠæ–‡ä»¶ä¼ åˆ° Slackï¼Ÿ</strong></p>
</blockquote>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>å®Œå…¨å¯ä»¥ï¼Œè€Œä¸”å®ç°æˆæœ¬å¾ˆä½ã€‚</strong></p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€æ•´ä½“æ€è·¯</h2>
<p>æ ¸å¿ƒæ€è·¯å¾ˆç®€å•ï¼š</p>
<ul>
<li>æ–‡ä»¶æœ¬èº«å°±åœ¨æœåŠ¡å™¨ä¸Š</li>
<li>Slack æä¾›äº†å®˜æ–¹ API ç”¨äºæ–‡ä»¶ä¸Šä¼ </li>
<li>åœ¨æœåŠ¡å™¨ä¸Šé€šè¿‡è„šæœ¬ï¼Œç›´æ¥è°ƒç”¨ Slack API ä¸Šä¼ æ–‡ä»¶</li>
</ul>
<p>è¿™æ ·å¯ä»¥åšåˆ°ï¼š</p>
<ul>
<li>æ–‡ä»¶ <strong>ä¸ç»è¿‡æœ¬åœ°</strong></li>
<li>å®Œå…¨ä¾èµ–æœåŠ¡å™¨ç½‘ç»œ</li>
<li>é€‚åˆå¤§æ–‡ä»¶ã€æ‰¹é‡å¯¼å‡º</li>
<li>å¯è„šæœ¬åŒ–ã€å¯è‡ªåŠ¨åŒ–</li>
</ul>
<p>æœ€ç»ˆæ•°æ®æµå˜ä¸ºï¼š</p>
<blockquote>
<p>æœåŠ¡å™¨ â†’ Slack</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">äºŒã€åˆ›å»º Slack App</h2>
<p>é¦–å…ˆéœ€è¦ä¸€ä¸ª Slack Appï¼Œç”¨äºè·å–ä¸Šä¼ æ–‡ä»¶æ‰€éœ€çš„ Tokenã€‚</p>
<h3 data-id="heading-2">1. æ–°å»º App</h3>
<p>è®¿é—®ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.slack.com%2Fapps" target="_blank" title="https://api.slack.com/apps" ref="nofollow noopener noreferrer">api.slack.com/apps</a></p>
<p>ç‚¹å‡» <strong>Create New App</strong>ï¼Œé€‰æ‹©ä½ çš„ Workspaceã€‚</p>
<hr/>
<h3 data-id="heading-3">2. é…ç½® OAuth &amp; Permissions</h3>
<p>åœ¨ <strong>OAuth &amp; Permissions</strong> ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹å¸¸ç”¨æƒé™ï¼ˆæ ¹æ®å®é™…éœ€è¦è°ƒæ•´ï¼‰ï¼š</p>
<ul>
<li><code>files:write</code></li>
<li><code>chat:write</code></li>
<li><code>channels:read</code>ï¼ˆå¦‚æœéœ€è¦ï¼‰</li>
</ul>
<p>é…ç½®å®Œæˆåï¼Œå®‰è£… App åˆ° Workspaceï¼Œå³å¯æ‹¿åˆ°ï¼š</p>
<ul>
<li><strong>Bot User OAuth Token</strong></li>
<li>æ ¼å¼ä¸€èˆ¬ä¸ºï¼š<code>xoxb-xxxx</code></li>
</ul>
<hr/>
<h2 data-id="heading-4">ä¸‰ã€æœåŠ¡å™¨ä¸Šä¼ è„šæœ¬</h2>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª <strong>å¯ç›´æ¥åœ¨æœåŠ¡å™¨è¿è¡Œçš„ Python è„šæœ¬</strong>ï¼Œç”¨äºï¼š</p>
<ul>
<li>ä¸Šä¼ æ–‡ä»¶åˆ°æŒ‡å®š Slack Channel</li>
<li>æ”¯æŒ Threadï¼ˆå¯ä¼ æ¶ˆæ¯é“¾æ¥ï¼‰</li>
<li>æ”¯æŒ @ æŒ‡å®šç”¨æˆ·</li>
<li>ä¸Šä¼ å®Œæˆåè¾“å‡ºæ–‡ä»¶é“¾æ¥</li>
</ul>
<h3 data-id="heading-5">1. è„šæœ¬ä»£ç </h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-comment"># -*- coding: utf-8 -*-</span>
<span class="hljs-comment"># file_uploader.py</span>

<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">from</span> slack_sdk <span class="hljs-keyword">import</span> WebClient
<span class="hljs-keyword">import</span> config

SLACK_TOKEN = config.slack_token
DEFAULT_MENTION = <span class="hljs-string">"xxxx"</span>

<span class="hljs-comment"># ---------------- utils ----------------</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">log</span>(<span class="hljs-params">msg: <span class="hljs-built_in">str</span></span>):
    <span class="hljs-string">"""Print timestamped logs to stdout."""</span>
    ts = time.strftime(<span class="hljs-string">"%Y-%m-%d %H:%M:%S"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"[<span class="hljs-subst">{ts}</span>] <span class="hljs-subst">{msg}</span>"</span>, flush=<span class="hljs-literal">True</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">parse_thread_ts</span>(<span class="hljs-params">thread_link: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""
    Convert a Slack message link to thread_ts.
    Example:
    https://workspace.slack.com/archives/xxxx/p1731398999934122
    Returns:
    1731398999.934122
    """</span>
    <span class="hljs-keyword">match</span> = re.search(<span class="hljs-string">r'/p(\d{16})'</span>, thread_link)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">match</span>:
        <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">f"Invalid Slack message link: <span class="hljs-subst">{thread_link}</span>"</span>)
    ts_raw = <span class="hljs-keyword">match</span>.group(<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">f"<span class="hljs-subst">{ts_raw[:-<span class="hljs-number">6</span>]}</span>.<span class="hljs-subst">{ts_raw[-<span class="hljs-number">6</span>:]}</span>"</span>


<span class="hljs-comment"># ---------------- main ----------------</span>

<span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &lt; <span class="hljs-number">3</span>:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"Usage: python file_uploader.py &lt;channel_id&gt; &lt;file_path&gt; [thread_link_or_ts] [user_ids...]"</span>)
        sys.exit(<span class="hljs-number">1</span>)

    channel_id = sys.argv[<span class="hljs-number">1</span>]
    file_path = sys.argv[<span class="hljs-number">2</span>]
    thread_input = sys.argv[<span class="hljs-number">3</span>] <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &gt; <span class="hljs-number">3</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>
    user_ids = sys.argv[<span class="hljs-number">4</span>:] <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) &gt; <span class="hljs-number">4</span> <span class="hljs-keyword">else</span> [DEFAULT_MENTION]

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.isfile(file_path):
        <span class="hljs-keyword">raise</span> RuntimeError(<span class="hljs-string">"File not found"</span>)

    filename = os.path.basename(file_path)
    file_size = os.path.getsize(file_path)

    thread_ts = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">if</span> thread_input:
        <span class="hljs-keyword">if</span> thread_input.startswith(<span class="hljs-string">"http"</span>):
            thread_ts = parse_thread_ts(thread_input)
        <span class="hljs-keyword">else</span>:
            thread_ts = thread_input

    log(<span class="hljs-string">f"Preparing to upload: <span class="hljs-subst">{filename}</span>"</span>)
    log(<span class="hljs-string">f"File size: <span class="hljs-subst">{file_size / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>:<span class="hljs-number">.2</span>f}</span> MB"</span>)

    client = WebClient(token=SLACK_TOKEN)
    mentions = <span class="hljs-string">" "</span>.join(<span class="hljs-string">f"&lt;@<span class="hljs-subst">{uid}</span>&gt;"</span> <span class="hljs-keyword">for</span> uid <span class="hljs-keyword">in</span> user_ids)

    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> f:
        kwargs = {
            <span class="hljs-string">"file"</span>: f,
            <span class="hljs-string">"title"</span>: filename,
            <span class="hljs-string">"channel"</span>: channel_id,
            <span class="hljs-string">"initial_comment"</span>: (
                <span class="hljs-string">f"âœ… New file uploaded: *<span class="hljs-subst">{filename}</span>* "</span>
                <span class="hljs-string">f"(<span class="hljs-subst">{file_size / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>:<span class="hljs-number">.2</span>f}</span> MB)\n<span class="hljs-subst">{mentions}</span>"</span>
            ),
        }
        <span class="hljs-keyword">if</span> thread_ts:
            kwargs[<span class="hljs-string">"thread_ts"</span>] = thread_ts

        response = client.files_upload_v2(**kwargs)

    file_info = response[<span class="hljs-string">"file"</span>]
    log(<span class="hljs-string">"âœ… Upload completed successfully"</span>)
    log(<span class="hljs-string">f"ğŸ“ File link: <span class="hljs-subst">{file_info.get(<span class="hljs-string">'permalink'</span>)}</span>"</span>)


<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    main()
</code></pre>
<h2 data-id="heading-6">å››ã€è¿è¡Œæ–¹å¼</h2>
<p>åŸºæœ¬ç”¨æ³•</p>
<pre><code class="hljs language-bash" lang="bash">python3 file_uploader.py &lt;channel_id&gt; &lt;file_path&gt;
</code></pre>
<p>ä¸Šä¼ åˆ°æŒ‡å®š Threadï¼ˆæ¨èï¼‰</p>
<pre><code class="hljs language-bash" lang="bash">python3 file_uploader.py \
  channel_id \
  /data/sai.csv \
  https://contactout.slack.com/archives/xxx/p1769005211787589
</code></pre>
<p>è„šæœ¬ä¼šè‡ªåŠ¨è§£æ Slack æ¶ˆæ¯é“¾æ¥ï¼Œè½¬æ¢ä¸º thread_tsã€‚</p>
<h2 data-id="heading-7">äº”ã€æ•ˆæœè¯´æ˜</h2>
<p>æ–‡ä»¶ç›´æ¥ä»æœåŠ¡å™¨ä¸Šä¼ åˆ° Slackï¼Œä¸ä¾èµ–æœ¬åœ°ç½‘ç»œï¼Œä¸Šä¼ å®Œæˆåï¼ŒSales å¯ç«‹å³åœ¨ Slack ä¸­ä¸‹è½½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æå®šè®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆï¼šåŸºäº Redis ZSet å®ç°çš„é«˜æ€§èƒ½å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆGo è¯­è¨€å®æˆ˜ï¼‰]]></title>    <link>https://juejin.cn/post/7601175299010789391</link>    <guid>https://juejin.cn/post/7601175299010789391</guid>    <pubDate>2026-02-01T03:33:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601175299010789391" data-draft-id="7601046076944138255" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æå®šè®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆï¼šåŸºäº Redis ZSet å®ç°çš„é«˜æ€§èƒ½å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆGo è¯­è¨€å®æˆ˜ï¼‰"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-01T03:33:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Kevin666"/> <meta itemprop="url" content="https://juejin.cn/user/1549628692501449"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æå®šè®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆï¼šåŸºäº Redis ZSet å®ç°çš„é«˜æ€§èƒ½å»¶è¿Ÿé˜Ÿåˆ—ï¼ˆGo è¯­è¨€å®æˆ˜ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1549628692501449/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Kevin666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T03:33:27.000Z" title="Sun Feb 01 2026 03:33:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°â€œå»¶è¿Ÿå¤„ç†â€çš„éœ€æ±‚ã€‚æœ€ç»å…¸çš„åœºæ™¯è«è¿‡äº <strong>ç”µå•†è®¢å•æ”¯ä»˜è¶…æ—¶è‡ªåŠ¨å–æ¶ˆ</strong>ï¼šç”¨æˆ·ä¸‹å•åï¼Œå¦‚æœ 30 åˆ†é’Ÿå†…æœªå®Œæˆæ”¯ä»˜ï¼Œç³»ç»Ÿéœ€è¦è‡ªåŠ¨å–æ¶ˆè®¢å•å¹¶é‡Šæ”¾åº“å­˜ã€‚</p>
<p>è™½ç„¶ RabbitMQã€RocketMQ ç­‰æ¶ˆæ¯é˜Ÿåˆ—æä¾›äº†å»¶è¿Ÿæ¶ˆæ¯çš„åŠŸèƒ½ï¼Œä½†åœ¨å¾ˆå¤šè½»é‡çº§åœºæ™¯æˆ–åŸºç¡€è®¾æ–½å—é™çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨æˆ‘ä»¬æ‰‹å¤´å·²æœ‰çš„ <strong>Redis</strong> æ¥å®ç°ä¸€ä¸ªå»¶è¿Ÿé˜Ÿåˆ—ï¼Œæ—¢ç®€å•åˆé«˜æ•ˆã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±é€šè¿‡ Go è¯­è¨€ï¼Œç»“åˆ Redis çš„ <code>Sorted Set</code>ï¼ˆæœ‰åºé›†åˆï¼‰æ•°æ®ç»“æ„ï¼Œæ‰‹å†™ä¸€ä¸ªç”Ÿäº§çº§çš„å»¶è¿Ÿé˜Ÿåˆ—ã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒåŸç†ï¼šRedis ZSet</h2>
<p>Redis çš„ <code>ZSet</code> æ˜¯ä¸€ä¸ªæœ‰åºé›†åˆï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ª <code>Score</code>ï¼ˆåˆ†å€¼ï¼‰ã€‚</p>
<p><strong>è®¾è®¡æ€è·¯ï¼š</strong></p>
<ol>
<li>æˆ‘ä»¬å°† <strong>ä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´æˆ³</strong> ä½œä¸º <code>Score</code>ã€‚</li>
<li>å°† <strong>ä»»åŠ¡çš„å…·ä½“å†…å®¹</strong>ï¼ˆå¦‚è®¢å•IDæˆ–JSONç»“æ„ä½“ï¼‰ä½œä¸º <code>Member</code>ã€‚</li>
<li>æ¶ˆè´¹è€…å¯åŠ¨ä¸€ä¸ªæ— é™å¾ªç¯ï¼Œä¸æ–­é€šè¿‡ <code>ZRangeByScore</code> æŸ¥è¯¢ <code>Score &lt;= å½“å‰æ—¶é—´æˆ³</code> çš„å…ƒç´ ã€‚</li>
<li>æŸ¥è¯¢åˆ°çš„å…ƒç´ å³ä¸ºâ€œåˆ°æœŸå¯æ‰§è¡Œâ€çš„ä»»åŠ¡ã€‚</li>
</ol>
<h2 data-id="heading-1">åœºæ™¯è®¾å®š</h2>
<p>å‡è®¾æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ª <strong>â€œæŠ¢ç¥¨ç³»ç»Ÿâ€</strong>ã€‚</p>
<ul>
<li>ç”¨æˆ·é”ç¥¨åï¼Œç³»ç»Ÿç”Ÿæˆä¸€ä¸ªæ£€æŸ¥ä»»åŠ¡ã€‚</li>
<li>ä»»åŠ¡éœ€è¦åœ¨ 15 åˆ†é’Ÿåè§¦å‘ï¼Œæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ”¯ä»˜ã€‚</li>
<li>å¦‚æœæœªæ”¯ä»˜ï¼Œåˆ™å–æ¶ˆè®¢å•ï¼›å¦‚æœå·²æ”¯ä»˜ï¼Œåˆ™æ ‡è®°å®Œæˆã€‚</li>
<li><strong>è¿›é˜¶é€»è¾‘</strong>ï¼šå¦‚æœæ”¯ä»˜çŠ¶æ€æ˜¯â€œå¤„ç†ä¸­â€ï¼ˆä¾‹å¦‚é“¶è¡Œå›è°ƒå»¶è¿Ÿï¼‰ï¼Œæˆ‘ä»¬éœ€è¦è®©ä»»åŠ¡â€œå†æ¬¡å»¶è¿Ÿâ€ä¸€å°æ®µæ—¶é—´ï¼ˆé‡è¯•ï¼‰ï¼Œè€Œä¸æ˜¯ç«‹å³å–æ¶ˆã€‚</li>
</ul>
<h2 data-id="heading-2">ä»£ç å®ç°</h2>
<h3 data-id="heading-3">1. å®šä¹‰ä»»åŠ¡ç»“æ„ä¸å¸¸é‡</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰å­˜å…¥ Redis çš„æ•°æ®ç»“æ„ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"context"</span>
    <span class="hljs-string">"encoding/json"</span>
    <span class="hljs-string">"fmt"</span>
    <span class="hljs-string">"time"</span>

    <span class="hljs-string">"github.com/go-redis/redis/v8"</span> <span class="hljs-comment">// å‡è®¾ä½¿ç”¨ go-redis</span>
)

<span class="hljs-keyword">const</span> (
    OrderDelayQueueKey = <span class="hljs-string">"ticket_order_delay_zset"</span> <span class="hljs-comment">// Redis Key</span>
    MaxRetryDuration   = <span class="hljs-number">30</span> * <span class="hljs-number">60</span>                   <span class="hljs-comment">// æœ€å¤§é‡è¯•/ç­‰å¾…æ—¶é—´ï¼š30åˆ†é’Ÿ</span>
)

<span class="hljs-comment">// OrderTask å­˜å‚¨åœ¨ Redis ZSet Member ä¸­çš„ç»“æ„</span>
<span class="hljs-keyword">type</span> OrderTask <span class="hljs-keyword">struct</span> {
    OrderID    <span class="hljs-type">string</span> <span class="hljs-string">`json:"order_id"`</span>
    UserID     <span class="hljs-type">int64</span>  <span class="hljs-string">`json:"user_id"`</span>
    CreateTime <span class="hljs-type">int64</span>  <span class="hljs-string">`json:"create_time"`</span> <span class="hljs-comment">// ä»»åŠ¡é¦–æ¬¡åˆ›å»ºæ—¶é—´</span>
    RetryCount <span class="hljs-type">int</span>    <span class="hljs-string">`json:"retry_count"`</span> <span class="hljs-comment">// é‡è¯•æ¬¡æ•°</span>
}
</code></pre>
<h3 data-id="heading-4">2. ç”Ÿäº§è€…ï¼šæŠ•é€’å»¶è¿Ÿä»»åŠ¡</h3>
<p>å½“ç”¨æˆ·ä¸‹å•æˆåŠŸåï¼Œæˆ‘ä»¬å°†ä»»åŠ¡åŠ å…¥ Redisã€‚è¿™é‡Œæˆ‘ä»¬å°† <code>Score</code> è®¾ç½®ä¸º <code>å½“å‰æ—¶é—´ + å»¶è¿Ÿæ—¶é—´</code>ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// AddOrderCheckTask æ·»åŠ è®¢å•æ£€æŸ¥ä»»åŠ¡</span>
<span class="hljs-comment">// delaySeconds: é¦–æ¬¡æ£€æŸ¥çš„å»¶è¿Ÿæ—¶é—´ï¼ˆä¾‹å¦‚ 900ç§’/15åˆ†é’Ÿï¼‰</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">AddOrderCheckTask</span><span class="hljs-params">(rdb *redis.Client, orderID <span class="hljs-type">string</span>, userID <span class="hljs-type">int64</span>, delaySeconds <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">error</span> {
    now := time.Now().Unix()
    
    task := &amp;OrderTask{
        OrderID:    orderID,
        UserID:     userID,
        CreateTime: now,
        RetryCount: <span class="hljs-number">0</span>,
    }

    taskJson, _ := json.Marshal(task)

    <span class="hljs-comment">// ZAdd: Score = æ‰§è¡Œæ—¶é—´ç‚¹</span>
    err := rdb.ZAdd(context.Background(), OrderDelayQueueKey, &amp;redis.Z{
        Score:  <span class="hljs-type">float64</span>(now + <span class="hljs-type">int64</span>(delaySeconds)), 
        Member: taskJson,
    }).Err()

    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        fmt.Printf(<span class="hljs-string">"Failed to add delay task: %v\n"</span>, err)
        <span class="hljs-keyword">return</span> err
    }
    
    fmt.Printf(<span class="hljs-string">"Order %s added to delay queue, exec at: %v\n"</span>, orderID, time.Unix(now+<span class="hljs-type">int64</span>(delaySeconds), <span class="hljs-number">0</span>))
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}
</code></pre>
<h3 data-id="heading-5">3. æ¶ˆè´¹è€…ï¼šè½®è¯¢ä¸ä»»åŠ¡å¤„ç†</h3>
<p>è¿™æ˜¯å»¶è¿Ÿé˜Ÿåˆ—çš„æ ¸å¿ƒå¼•æ“ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåå°åç¨‹ä¸æ–­è½®è¯¢ã€‚</p>
<p><strong>å…³é”®ç‚¹ä¼˜åŒ–ï¼š</strong>
ä¸ºäº†é˜²æ­¢å¤šä¸ªæ¶ˆè´¹è€…é‡å¤å¤„ç†åŒä¸€ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬åœ¨è·å–åˆ°ä»»åŠ¡åˆ—è¡¨åï¼Œä½¿ç”¨ <code>ZRem</code> è¿›è¡ŒåŸå­åˆ é™¤ã€‚åªæœ‰ <code>ZRem</code> æˆåŠŸï¼ˆè¿”å›ç§»é™¤æ•°é‡ &gt; 0ï¼‰çš„æ¶ˆè´¹è€…ï¼Œæ‰æœ‰èµ„æ ¼å¤„ç†è¯¥ä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// StartDelayQueueWorker å¯åŠ¨æ¶ˆè´¹è€…è¿›ç¨‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">StartDelayQueueWorker</span><span class="hljs-params">(rdb *redis.Client)</span></span> {
    <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
        ctx := context.Background()
        <span class="hljs-keyword">for</span> {
            now := time.Now().Unix()
            
            <span class="hljs-comment">// 1. æ‹‰å–æ‰€æœ‰ score &lt;= å½“å‰æ—¶é—´ çš„ä»»åŠ¡</span>
            <span class="hljs-comment">// Limit é™åˆ¶æ¯æ¬¡æ‹‰å–çš„æ•°é‡ï¼Œé˜²æ­¢ä¸€æ¬¡å¤„ç†å¤ªå¤šå¯¼è‡´é˜»å¡</span>
            vals, err := rdb.ZRangeByScoreWithScores(ctx, OrderDelayQueueKey, &amp;redis.ZRangeBy{
                Min:   <span class="hljs-string">"-inf"</span>,
                Max:   fmt.Sprintf(<span class="hljs-string">"%d"</span>, now),
                Count: <span class="hljs-number">10</span>, <span class="hljs-comment">// æ¯æ¬¡å–10ä¸ª</span>
            }).Result()

            <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
                fmt.Printf(<span class="hljs-string">"Redis error: %v\n"</span>, err)
                time.Sleep(time.Second) <span class="hljs-comment">// å‘ç”Ÿé”™è¯¯ä¼‘çœ ä¸€ä¼š</span>
                <span class="hljs-keyword">continue</span>
            }

            <span class="hljs-comment">// å¦‚æœæ²¡æœ‰åˆ°æœŸä»»åŠ¡ï¼Œä¼‘çœ ä¸€å°ä¼šé¿å…ç©ºè½®è¯¢æ¶ˆè€— CPU</span>
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(vals) == <span class="hljs-number">0</span> {
                time.Sleep(time.Second) 
                <span class="hljs-keyword">continue</span>
            }

            <span class="hljs-comment">// 2. å¹¶å‘å¤„ç†è¿™ä¸€æ‰¹ä»»åŠ¡</span>
            <span class="hljs-keyword">for</span> _, z := <span class="hljs-keyword">range</span> vals {
                <span class="hljs-keyword">go</span> processTask(ctx, rdb, z)
            }
        }
    }()
}
</code></pre>
<h3 data-id="heading-6">4. æ ¸å¿ƒé€»è¾‘ï¼šå¤„ç†ã€é‡è¯•ä¸å®Œæˆ</h3>
<p>è¿™é‡Œæ¨¡æ‹Ÿäº†åŸä»£ç ä¸­ç²¾é«“çš„ <strong>â€œæ¡ä»¶æ£€æŸ¥ä¸åŠ¨æ€é‡å…¥é˜Ÿâ€</strong> é€»è¾‘ã€‚</p>
<p>å¦‚æœè®¢å•è¿˜æœªæ”¯ä»˜ï¼Œä½†è¿˜æ²¡åˆ°æœ€ç»ˆçš„å¼ºåˆ¶å–æ¶ˆæ—¶é—´ï¼ˆä¾‹å¦‚é“¶è¡Œæ¥å£è¶…æ—¶ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—ä¸€ä¸ªæ–°çš„å»¶è¿Ÿæ—¶é—´ï¼ŒæŠŠä»»åŠ¡é‡æ–°æ”¾å› Redisï¼Œå®ç° <strong>é˜¶æ¢¯å¼é‡è¯•</strong>ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">processTask</span><span class="hljs-params">(ctx context.Context, rdb *redis.Client, z redis.Z)</span></span> {
    <span class="hljs-comment">// A. æŠ¢å ä»»åŠ¡ï¼šåˆ©ç”¨ ZREM çš„åŸå­æ€§é˜²æ­¢å¤šæ¶ˆè´¹è€…å¹¶å‘å†²çª</span>
    <span class="hljs-comment">// åªæœ‰ç§»é™¤æˆåŠŸçš„é‚£ä¸ªåç¨‹æ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œ</span>
    deleted, err := rdb.ZRem(ctx, OrderDelayQueueKey, z.Member).Result()
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> || deleted == <span class="hljs-number">0</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-comment">// è¢«å…¶ä»–æ¶ˆè´¹è€…æŠ¢äº†ï¼Œæˆ–è€… Redis å¼‚å¸¸</span>
    }

    <span class="hljs-comment">// B. è§£æä»»åŠ¡æ•°æ®</span>
    <span class="hljs-keyword">var</span> task OrderTask
    taskStr, _ := z.Member.(<span class="hljs-type">string</span>)
    <span class="hljs-keyword">if</span> err := json.Unmarshal([]<span class="hljs-type">byte</span>(taskStr), &amp;task); err != <span class="hljs-literal">nil</span> {
        fmt.Printf(<span class="hljs-string">"Invalid task format: %v\n"</span>, taskStr)
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// C. æ¨¡æ‹Ÿè°ƒç”¨ä¸šåŠ¡æœåŠ¡æ£€æŸ¥è®¢å•çŠ¶æ€</span>
    orderStatus := mockCheckOrderStatus(task.OrderID)

    now := time.Now().Unix()
    
    <span class="hljs-comment">// æƒ…å†µ1ï¼šè®¢å•å·²æ”¯ä»˜ -&gt; ä»»åŠ¡ç»“æŸ</span>
    <span class="hljs-keyword">if</span> orderStatus == <span class="hljs-string">"PAID"</span> {
        fmt.Printf(<span class="hljs-string">"Order %s is PAID. Task done.\n"</span>, task.OrderID)
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// æƒ…å†µ2ï¼šè®¢å•æœªæ”¯ä»˜ï¼Œä¸”è¶…è¿‡äº†æœ€å¤§ç­‰å¾…æ—¶é—´ -&gt; æ‰§è¡Œå–æ¶ˆé€»è¾‘</span>
    <span class="hljs-keyword">if</span> now - task.CreateTime &gt;= MaxRetryDuration {
        fmt.Printf(<span class="hljs-string">"Order %s timeout. Cancelling order...\n"</span>, task.OrderID)
        <span class="hljs-comment">// doCancelOrder(task.OrderID)</span>
        <span class="hljs-keyword">return</span>
    }

    <span class="hljs-comment">// æƒ…å†µ3ï¼šè®¢å•çŠ¶æ€æœªçŸ¥æˆ–æƒ³ç»™ç”¨æˆ·æ›´å¤šç¼“å†²ï¼ˆä¾‹å¦‚å¤„äºæ”¯ä»˜ä¸­ï¼‰ï¼Œä½†è¿˜æ²¡è¶…æ—¶</span>
    <span class="hljs-comment">// -&gt; é‡æ–°è®¡ç®—å»¶è¿Ÿæ—¶é—´ï¼Œæ”¾å›é˜Ÿåˆ— (Re-enqueue)</span>
    
    <span class="hljs-comment">// ç®€å•çš„é€€é¿ç­–ç•¥ï¼šæ¯æ¬¡å¤šç­‰ 30 ç§’</span>
    nextDelay := <span class="hljs-number">30</span>
    task.RetryCount++
    
    nextScore := <span class="hljs-type">float64</span>(now + <span class="hljs-type">int64</span>(nextDelay))
    
    fmt.Printf(<span class="hljs-string">"Order %s pending. Re-queueing for %d seconds later.\n"</span>, task.OrderID, nextDelay)
    
    rdb.ZAdd(ctx, OrderDelayQueueKey, &amp;redis.Z{
        Score:  nextScore,
        Member: z.Member, <span class="hljs-comment">// ä¿æŒ Member å†…å®¹ä¸å˜ï¼ˆæˆ–è€…æ›´æ–° RetryCount åé‡æ–° Marshalï¼‰</span>
    })
}

<span class="hljs-comment">// æ¨¡æ‹Ÿä¸šåŠ¡æ£€æŸ¥</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">mockCheckOrderStatus</span><span class="hljs-params">(orderID <span class="hljs-type">string</span>)</span></span> <span class="hljs-type">string</span> {
    <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ˜¯ RPC è°ƒç”¨æˆ–æ•°æ®åº“æŸ¥è¯¢</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"PENDING"</span> 
}
</code></pre>
<h2 data-id="heading-7">æ–¹æ¡ˆæ€»ç»“</h2>
<h3 data-id="heading-8">ä¼˜ç‚¹</h3>
<ol>
<li><strong>è½»é‡çº§</strong>ï¼šä¸éœ€è¦å¼•å…¥ Kafka æˆ– RocketMQ è¿™æ ·åšé‡çš„ç»„ä»¶ï¼Œåªè¦æœ‰ Redis å°±èƒ½è·‘ã€‚</li>
<li><strong>çµæ´»æ€§</strong>ï¼šå¯ä»¥éšæ„æ§åˆ¶ <code>Score</code>ï¼Œå®ç°ä»»æ„æ—¶é—´çš„å»¶è¿Ÿï¼Œç”šè‡³æ”¯æŒåŠ¨æ€ä¿®æ”¹å»¶è¿Ÿæ—¶é—´ï¼ˆå¦‚ä¸Šè¿°ä»£ç ä¸­çš„é‡å…¥é˜Ÿé€»è¾‘ï¼‰ã€‚</li>
<li><strong>å¯è§†åŒ–</strong>ï¼šé€šè¿‡ Redis Desktop Manager å¯ä»¥ç›´æ¥çœ‹åˆ°å½“å‰æ’é˜Ÿçš„ä»»åŠ¡ï¼Œä¾¿äºè°ƒè¯•ã€‚</li>
</ol>
<h3 data-id="heading-9">æ³¨æ„äº‹é¡¹ï¼ˆå‘ç‚¹ï¼‰</h3>
<ol>
<li><strong>åŸå­æ€§é—®é¢˜</strong>ï¼šåœ¨ <code>ZRange</code> å’Œ <code>ZRem</code> ä¹‹é—´å­˜åœ¨æ—¶é—´çª—å£ã€‚å¦‚æœæ˜¯å¤šå®ä¾‹éƒ¨ç½²ï¼Œå¿…é¡»åƒä»£ç ä¸­é‚£æ ·ï¼Œé€šè¿‡ <code>ZRem</code> çš„è¿”å›å€¼åˆ¤æ–­æ˜¯å¦æŠ¢åˆ°äº†ä»»åŠ¡ï¼Œæˆ–è€…ä½¿ç”¨ Lua è„šæœ¬å°†â€œè·å–å¹¶åˆ é™¤â€åšæˆåŸå­æ“ä½œã€‚</li>
<li><strong>ç©ºè½®è¯¢å‹åŠ›</strong>ï¼šå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œé¢‘ç¹çš„ <code>ZRange</code> ä¼šæµªè´¹ CPU å’Œ Redis QPSã€‚å»ºè®®åœ¨æ²¡æœ‰è·å–åˆ°æ•°æ®æ—¶åŠ ä¸Š <code>Sleep</code>ï¼ˆå¦‚ä»£ç ä¸­çš„ <code>time.Sleep(time.Second)</code>ï¼‰ã€‚</li>
<li><strong>å¤§Keyé£é™©</strong>ï¼šå¦‚æœç§¯å‹çš„ä»»åŠ¡æå¤šï¼ˆç™¾ä¸‡çº§ï¼‰ï¼Œ<code>ZSET</code> ä¼šå˜æˆå¤§ Keyï¼Œæ“ä½œæ€§èƒ½ä¸‹é™ã€‚æ­¤æ—¶å»ºè®®æŒ‰ç…§æ—¶é—´åˆ†æ¡¶ï¼ˆå¦‚ <code>queue_hour_1</code>, <code>queue_hour_2</code>ï¼‰æˆ–ä½¿ç”¨å¤šç»„ Key åˆ†ç‰‡ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ•°æ®-227 ç¦»çº¿æ•°ä»“-Flume 1.9.0 è‡ªå®šä¹‰æ‹¦æˆªå™¨å®æˆ˜ï¼šTAILDIR å¤šç›®å½•é‡‡é›†ï¼ŒæŒ‰ logtime/logtype å†™å…¥ HDFS åˆ†åŒº]]></title>    <link>https://juejin.cn/post/7601103779392766015</link>    <guid>https://juejin.cn/post/7601103779392766015</guid>    <pubDate>2026-02-01T06:55:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601103779392766015" data-draft-id="7601075423003508772" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ•°æ®-227 ç¦»çº¿æ•°ä»“-Flume 1.9.0 è‡ªå®šä¹‰æ‹¦æˆªå™¨å®æˆ˜ï¼šTAILDIR å¤šç›®å½•é‡‡é›†ï¼ŒæŒ‰ logtime/logtype å†™å…¥ HDFS åˆ†åŒº"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,Apache Flume"/> <meta itemprop="datePublished" content="2026-02-01T06:55:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­¦å­åº·"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ•°æ®-227 ç¦»çº¿æ•°ä»“-Flume 1.9.0 è‡ªå®šä¹‰æ‹¦æˆªå™¨å®æˆ˜ï¼šTAILDIR å¤šç›®å½•é‡‡é›†ï¼ŒæŒ‰ logtime/logtype å†™å…¥ HDFS åˆ†åŒº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­¦å­åº·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T06:55:45.000Z" title="Sun Feb 01 2026 06:55:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<ul>
<li>åœºæ™¯ï¼šFlume TAILDIR åŒæ—¶é‡‡é›†å¯åŠ¨æ—¥å¿—ä¸äº‹ä»¶æ—¥å¿—ï¼Œè¦æ±‚æŒ‰æ—¥å¿—å†…æ—¶é—´åˆ†åŒºã€æŒ‰æ¥æºåˆ†ç›®å½•è½ HDFSã€‚</li>
<li>ç»“è®ºï¼šç”¨è‡ªå®šä¹‰ Interceptor æŠ½å– logtimeï¼Œå¹¶ç”¨ filegroups headers æˆ–æ‹¦æˆªå™¨è¡¥é½ logtypeï¼ŒHDFS path é€šè¿‡ %{header} åŠ¨æ€è·¯ç”±ã€‚</li>
<li>äº§å‡ºï¼šä¸€å¥—å¯å¤ç”¨é…ç½®æ¨¡æ¿ + å¸¸è§å‘ä½é€ŸæŸ¥ï¼ˆç±»åŠ è½½ã€å ä½ç¬¦ã€æ»šåŠ¨ç­–ç•¥ã€æƒé™ä¸ positionFileï¼‰ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34b3b454b8664649be29da0c9ad0b6c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=Pl0MFrxH4QZ3UJmK5cmEaxuUuq0%3D" alt="å¤§æ•°æ®-227 ç¦»çº¿æ•°ä»“-Flume 1.9.0 è‡ªå®šä¹‰æ‹¦æˆªå™¨å®æˆ˜ï¼šTAILDIR å¤šç›®å½•é‡‡é›†ï¼ŒæŒ‰ logtime/logtype å†™å…¥ HDFS åˆ†åŒº" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/057ba6b83e664d34b9d6891ea34c9696~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=tqeSBu0oC7hE6WZAimvtfkcxYck%3D" alt="æ•°æ®ä»“åº“æ¶æ„å›¾" loading="lazy"/></p>
<h2 data-id="heading-1">è‡ªå®šä¹‰æ‹¦æˆªå™¨</h2>
<p>ï¼ˆç»­æ¥ä¸ŠèŠ‚ï¼Œä¸ŠèŠ‚å·²ç»åˆ°äº†æ‰“åŒ…çš„éƒ¨åˆ†ï¼‰</p>
<h3 data-id="heading-2">ä¸Šä¼ ç»“æœ</h3>
<p>å°†åˆšæ‰çš„æ‰“åŒ…ä¸Šä¼ åˆ°è¿™ä¸ªç›®å½•ä¸‹ï¼š
æˆ‘æ‹·è´çš„æ˜¯å¸¦ä¾èµ–çš„ï¼šâ€œflume-test-1.0-SNAPSHOT-jar-with-dependencies.jarâ€</p>
<pre><code class="hljs language-shell" lang="shell">/opt/servers/apache-flume-1.9.0-bin/lib/
</code></pre>
<h3 data-id="heading-3">æµ‹è¯•æ•ˆæœ</h3>
<p>æˆ‘ä»¬åˆ›å»ºåˆšæ‰è¯´çš„confæ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">vim /opt/wzk/flume-conf/flumetest1.conf
</code></pre>
<p>ç¼–å†™çš„å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/965718ede5a04bbda8c08e91f69658d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=GueTOnvo7VHrKq4svvZ%2BnXHRUV4%3D" alt="ç¦»çº¿æ•°ä»“ Flumeé…ç½®" loading="lazy"/>
å¯åŠ¨è¿›è¡Œæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">flume-ng agent --conf-file /opt/wzk/flume-conf/flumetest1.conf -name a1 -Dflume.roog.logger=INFO,console
</code></pre>
<p>å¯åŠ¨ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c0f12b2d3bbd44588b9d2e5b97467bfd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=XMPb8h2fbJKhIC4q1j5n3a2w4Nw%3D" alt="ç¦»çº¿æ•°ä»“ Flumeå¯åŠ¨" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯åŠ¨ telnet æ¥ä¼ å…¥æ•°æ®ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">telnet h122.wzk.icu 9999
</code></pre>
<p>å¯åŠ¨ä¹‹åè¾“å…¥æ•°æ®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-number">2020</span><span class="hljs-number">-07</span><span class="hljs-number">-30</span> <span class="hljs-number">14</span><span class="hljs-punctuation">:</span><span class="hljs-number">18</span><span class="hljs-punctuation">:</span><span class="hljs-number">47.339</span> <span class="hljs-punctuation">[</span>main<span class="hljs-punctuation">]</span> INFO com.ecommerce.AppStart - <span class="hljs-punctuation">{</span><span class="hljs-attr">"app_active"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"app_active"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"json"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"entry"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"error_code"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"0"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"time"</span><span class="hljs-punctuation">:</span><span class="hljs-number">1596111888529</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"attr"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"area"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"æ³°å®‰"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"uid"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"2F10092A9"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"app_v"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"1.1.13"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"event_type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"common"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"device_id"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"1FB872-9A1009"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"os_type"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"4.7.3"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"channel"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"DK"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"language"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"chinese"</span><span class="hljs-punctuation">,</span><span class="hljs-attr">"brand"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"iphone-9"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">}</span>

</code></pre>
<p>æ­¤æ—¶æ§åˆ¶å°çš„æ•°æ®å†…å®¹éƒ¨åˆ†ä¸ºï¼š</p>
<pre><code class="hljs language-shell" lang="shell">4/08/27 15:31:31 INFO source.NetcatSource: Source starting
24/08/27 15:31:31 INFO source.NetcatSource: Created serverSocket:sun.nio.ch.ServerSocketChannelImpl[/172.16.1.130:9999]
24/08/27 15:32:09 INFO sink.LoggerSink: Event: { headers:{logtime=2020-07-30} body: 32 30 32 30 2D 30 37 2D 33 30 20 31 34 3A 31 38 2020-07-30 14:18 }
</code></pre>
<p>å¯¹åº”çš„æˆªå›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f4d66a507904bff804ddabc3db3cd92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=cTMT0YUufXrHF%2Ba7RXT7YeLZ5oc%3D" alt="ç¦»çº¿æ•°ä»“ æ—¥å¿—æŸ¥çœ‹" loading="lazy"/></p>
<h2 data-id="heading-4">é‡‡é›†å¯åŠ¨æ—¥å¿—ï¼ˆä½¿ç”¨è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼‰</h2>
<h3 data-id="heading-5">é…ç½®æ–‡ä»¶</h3>
<p>æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">vim /opt flume-log2hdfs2.conf
</code></pre>
<p>å†™å…¥çš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-shell" lang="shell">a1.sources = r1
a1.sinks = k1
a1.channels = c1
<span class="hljs-meta prompt_"># </span><span class="bash">taildir <span class="hljs-built_in">source</span></span>
a1.sources.r1.type = TAILDIR
a1.sources.r1.positionFile = /opt/wzk/conf/startlog_position.json
a1.sources.r1.filegroups = f1
a1.sources.r1.filegroups.f1 = /opt/wzk/logs/start/.*log
a1.sources.r1.interceptors = i1
a1.sources.r1.interceptors.i1.type = icu.wzk.CustomerInterceptor$Builder
<span class="hljs-meta prompt_"># </span><span class="bash">memorychannel</span>
a1.channels.c1.type = memory
a1.channels.c1.capacity = 100000
a1.channels.c1.transactionCapacity = 2000
<span class="hljs-meta prompt_"># </span><span class="bash">hdfs sink</span>
a1.sinks.k1.type = hdfs
a1.sinks.k1.hdfs.path = /user/data/logs/start/dt=%{logtime}/
a1.sinks.k1.hdfs.filePrefix = startlog.
a1.sinks.k1.hdfs.fileType = DataStream
<span class="hljs-meta prompt_"># </span><span class="bash">é…ç½®æ–‡ä»¶æ»šåŠ¨æ–¹å¼ï¼ˆæ–‡ä»¶å¤§å°32Mï¼‰</span>
a1.sinks.k1.hdfs.rollSize = 33554432
a1.sinks.k1.hdfs.rollCount = 0
a1.sinks.k1.hdfs.rollInterval = 0
a1.sinks.k1.hdfs.idleTimeout = 0
a1.sinks.k1.hdfs.minBlockReplicas = 1
<span class="hljs-meta prompt_"># </span><span class="bash">å‘hdfsä¸Šåˆ·æ–°çš„eventçš„ä¸ªæ•°</span>
a1.sinks.k1.hdfs.batchSize = 1000
<span class="hljs-meta prompt_"># </span><span class="bash">ä½¿ç”¨æœ¬åœ°æ—¶é—´</span>
<span class="hljs-meta prompt_"># </span><span class="bash">a1.sinks.k1.hdfs.useLocalTimeStamp = <span class="hljs-literal">true</span></span>
<span class="hljs-meta prompt_"># </span><span class="bash">Bind the <span class="hljs-built_in">source</span> and sink to the channel</span>
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1
</code></pre>
<p>å†…å®¹çš„æˆªå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0c6c3580d7f4e2f9b3aa385df353cae~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=I9uFoQAiFpKd8FOeWyZAsy6jyv8%3D" alt="ç¦»çº¿æ•°ä»“ Flume è‡ªå®šä¹‰æ‹¦æˆªå™¨" loading="lazy"/>
ä¿®æ”¹çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç»™sourceå¢åŠ è‡ªå®šä¹‰æ‹¦æˆªå™¨</li>
<li>å»æ‰æ—¶é—´æˆ³ a1.sinks.k1.hdfs.useLocalTimeStamp = true</li>
<li>æ ¹æ®headerä¸­çš„logtimeå†™æ–‡ä»¶</li>
</ul>
<h3 data-id="heading-6">æµ‹è¯•è¿è¡Œ</h3>
<pre><code class="hljs language-shell" lang="shell">flume-ng agent --conf-file /opt/wzk/flume-conf/flume-log2hdfs2.conf -name a1 -Dflume.roog.logger=INFO,console
</code></pre>
<h3 data-id="heading-7">æ‹·è´æ—¥å¿—</h3>
<p>ä¿®æ”¹æ—¥å¿—çš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">vim /opt/wzk/logs/start/test.log
</code></pre>
<p>ç»§ç»­å†™å…¥å¦‚ä¸‹çš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">2020-07-30 14:18:47.339 [main] INFO com.ecommerce.AppStart - {"app_active":{"name":"app_active","json":{"entry":"1","action":"1","error_code":"0"},"time":1596111888529},"attr":{"area":"æ³°å®‰","uid":"2F10092A9","app_v":"1.1.13","event_type":"common","device_id":"1FB872-9A1009","os_type":"4.7.3","channel":"DK","language":"chinese","brand":"iphone-9"}}
</code></pre>
<p>å†™å…¥å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42335f141451429ca46b85c54df28cff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=4qWmfxFgb04Hk904uvt1YIThVTA%3D" alt="ç¦»çº¿æ•°ä»“ Flume è‡ªå®šä¹‰æ‹¦æˆªå™¨" loading="lazy"/></p>
<h3 data-id="heading-8">æµ‹è¯•æ•ˆæœ</h3>
<p>å¯ä»¥çœ‹åˆ°HDFSä¸Šï¼Œå·²ç»æœ‰äº†è¯»å‡ºæ—¥å¿—ä¸­çš„æ—¶é—´çš„å†…å®¹ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1310cb8f85b840febb23b4e36fa2d112~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=pKT9emADSeikkfY%2Bkmb24kZlilg%3D" alt="ç¦»çº¿æ•°ä»“ æŸ¥çœ‹HDFS" loading="lazy"/></p>
<h2 data-id="heading-9">é‡‡é›†å¯åŠ¨æ—¥å¿—å’Œäº‹ä»¶æ—¥å¿—</h2>
<p>æœ¬ç³»ç»Ÿä¸­è¦é‡‡é›†ä¸¤ç§æ—¥å¿—ï¼š</p>
<ul>
<li>å¯åŠ¨æ—¥å¿—</li>
<li>äº‹ä»¶æ—¥å¿—
ä¸åŒçš„æ—¥å¿—æ”¾ç½®åœ¨ä¸åŒçš„ç›®å½•ä¸‹ï¼Œè¦æƒ³ä¸€æ¬¡æ‹¿åˆ°å…¨éƒ¨æ—¥å¿—éœ€è¦ç›‘æ§å¤šä¸ªç›®å½•ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/888b1c86fe3948f0902e25bd0fcb92a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770533745&amp;x-signature=xBn%2FBAKkegNPDw2gBUTGYl0TZGc%3D" alt="ç¦»çº¿æ•°ä»“ é‡‡é›†æµç¨‹" loading="lazy"/></li>
</ul>
<h3 data-id="heading-10">æ€»ä½“æ€è·¯</h3>
<ul>
<li>taildir ç›‘æ§å¤šä¸ªç›®å½•</li>
<li>ä¿®æ”¹è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼Œä¸åŒæ¥æºçš„æ•°æ®åŠ ä¸Šä¸åŒæ ‡å¿—</li>
<li>HDFSã€Sink æ ¹æ®æ ‡å¿—å†™æ–‡ä»¶</li>
</ul>
<h3 data-id="heading-11">Agent ä»‹ç»</h3>
<p>Flume æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€é«˜å¯é ã€å¯ç”¨æ¥æ”¶é›†ã€èšåˆå’Œä¼ è¾“å¤§é‡æ—¥å¿—æ•°æ®çš„ç³»ç»Ÿã€‚åœ¨ Flume çš„ä½“ç³»ç»“æ„ä¸­ï¼ŒAgent æ˜¯ä¸€ä¸ªå…³é”®çš„ç»„ä»¶ã€‚æ¯ä¸ª Agent æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ JVM è¿›ç¨‹ï¼Œè´Ÿè´£ä»æ•°æ®æºè·å–æ•°æ®å¹¶å°†å…¶ä¼ é€’åˆ°ä¸‹æ¸¸ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ã€æˆ–è€…å¦ä¸€ä¸ª Agentï¼‰</p>
<h3 data-id="heading-12">Agent çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†</h3>
<p>Flume Agent çš„æ¶æ„æ˜¯é«˜åº¦æ¨¡å—åŒ–çš„ï¼Œå®ƒç”±ä»¥ä¸‹ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶æ„æˆï¼š</p>
<h4 data-id="heading-13">Source (æº)</h4>
<p>Source æ˜¯æ•°æ®æµçš„èµ·ç‚¹ï¼Œè´Ÿè´£æ¥æ”¶å¤–éƒ¨æ•°æ®ã€‚å®ƒæ”¯æŒå¤šç§æ•°æ®ä¼ è¾“åè®®å’Œæ ¼å¼ï¼Œèƒ½å¤Ÿä»æ—¥å¿—æ–‡ä»¶ã€ç½‘ç»œç«¯å£ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰æ•°æ®æºä¸­æ¥æ”¶äº‹ä»¶ã€‚</p>
<p>æ”¯æŒçš„ Source ç±»å‹ï¼š</p>
<ul>
<li>Avro Sourceï¼šæ¥æ”¶æ¥è‡ªå…¶ä»– Flume Agent çš„ Avro æ ¼å¼æ•°æ®ã€‚</li>
<li>Syslog Sourceï¼šå¤„ç† Syslog æ¶ˆæ¯ã€‚</li>
<li>Exec Sourceï¼šä»æœ¬åœ°å‘½ä»¤æˆ–è„šæœ¬çš„è¾“å‡ºä¸­è¯»å–æ•°æ®ã€‚</li>
<li>HTTP Sourceï¼šé€šè¿‡ HTTP æ¥å£æ¥æ”¶æ•°æ®ã€‚</li>
<li>Spooling Directory Sourceï¼šç›‘æ§ç‰¹å®šç›®å½•ä¸­çš„æ–‡ä»¶å¹¶è¯»å–å†…å®¹ã€‚</li>
</ul>
<h4 data-id="heading-14">Channel (é€šé“)</h4>
<p>Channel æ˜¯ Agent çš„æ•°æ®ç¼“å†²åŒºåŸŸï¼Œç”¨äºåœ¨ Source å’Œ Sink ä¹‹é—´æš‚å­˜äº‹ä»¶ã€‚Channel çš„è®¾è®¡ä¿è¯äº†åœ¨æ•°æ®æµåŠ¨ä¸­æ–­ï¼ˆå¦‚ç½‘ç»œæ•…éšœï¼‰æ—¶ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±ã€‚</p>
<p>å¸¸è§çš„ Channel ç±»å‹ï¼š</p>
<ul>
<li>Memory Channelï¼šå°†äº‹ä»¶å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œé€Ÿåº¦å¿«ï¼Œä½†å¯èƒ½ä¼šä¸¢å¤±æ•°æ®ï¼ˆå¦‚æœ Agent å´©æºƒï¼‰ã€‚</li>
<li>File Channelï¼šå°†äº‹ä»¶å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ä¸­ï¼Œæä¾›é«˜å¯é æ€§ä½†æ€§èƒ½è¾ƒä½ã€‚</li>
<li>Kafka Channelï¼šä½¿ç”¨ Kafka ä½œä¸ºä¸­è½¬é€šé“ï¼Œé€‚åˆåˆ†å¸ƒå¼åœºæ™¯ã€‚</li>
</ul>
<h4 data-id="heading-15">Sink (æ¥æ”¶å™¨)</h4>
<p>Sink æ˜¯æ•°æ®æµçš„ç»ˆç‚¹ï¼Œè´Ÿè´£å°†äº‹ä»¶ä¼ é€’åˆ°ä¸‹æ¸¸å­˜å‚¨æˆ–å¤„ç†ç³»ç»Ÿã€‚</p>
<p>æ”¯æŒçš„ Sink ç±»å‹ï¼š</p>
<ul>
<li>HDFS Sinkï¼šå°†äº‹ä»¶å†™å…¥ Hadoop HDFSã€‚</li>
<li>Kafka Sinkï¼šå°†äº‹ä»¶å‘é€åˆ° Kafkaã€‚</li>
<li>Elasticsearch Sinkï¼šå°†äº‹ä»¶å†™å…¥ Elasticsearchã€‚</li>
<li>Logger Sinkï¼šå°†äº‹ä»¶è¾“å‡ºåˆ°æ—¥å¿—ã€‚</li>
<li>Avro Sinkï¼šå°†äº‹ä»¶ä¼ é€’åˆ°å¦ä¸€ä¸ª Flume Agent çš„ Avro Sourceã€‚</li>
</ul>
<h3 data-id="heading-16">Agenté…ç½®</h3>
<pre><code class="hljs language-shell" lang="shell">vim /opt/wzk/flume-conf/flume-log2hdfs3.conf
</code></pre>
<p>å†™å…¥çš„å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-shell" lang="shell">a1.sources = r1
a1.sinks = k1
a1.channels = c1
<span class="hljs-meta prompt_"># </span><span class="bash">taildir <span class="hljs-built_in">source</span></span>
a1.sources.r1.type = TAILDIR
a1.sources.r1.positionFile = /opt/wzk/conf/startlog_position.json
a1.sources.r1.filegroups = f1 f2
a1.sources.r1.filegroups.f1 = /opt/wzk/logs/start/.*log
a1.sources.r1.headers.f1.logtype = start
a1.sources.r1.filegroups.f2 = /opt/wzk/logs/event/.*log
a1.sources.r1.headers.f2.logtype = event
<span class="hljs-meta prompt_"># </span><span class="bash">è‡ªå®šä¹‰æ‹¦æˆªå™¨</span>
a1.sources.r1.interceptors = i1
a1.sources.r1.interceptors.i1.type = icu.wzk.LogTypeInterceptor$Builder
<span class="hljs-meta prompt_"># </span><span class="bash">memorychannel</span>
a1.channels.c1.type = memory
a1.channels.c1.capacity = 100000
a1.channels.c1.transactionCapacity = 2000
<span class="hljs-meta prompt_"># </span><span class="bash">hdfs sink</span>
a1.sinks.k1.type = hdfs
a1.sinks.k1.hdfs.path = /user/data/logs/%{logtype}/dt=%
{logtime}/
a1.sinks.k1.hdfs.filePrefix = startlog.
a1.sinks.k1.hdfs.fileType = DataStream
<span class="hljs-meta prompt_"># </span><span class="bash">é…ç½®æ–‡ä»¶æ»šåŠ¨æ–¹å¼ï¼ˆæ–‡ä»¶å¤§å°32Mï¼‰</span>
a1.sinks.k1.hdfs.rollSize = 33554432
a1.sinks.k1.hdfs.rollCount = 0
a1.sinks.k1.hdfs.rollInterval = 0
a1.sinks.k1.hdfs.idleTimeout = 0
a1.sinks.k1.hdfs.minBlockReplicas = 1
<span class="hljs-meta prompt_"># </span><span class="bash">å‘hdfsä¸Šåˆ·æ–°çš„eventçš„ä¸ªæ•°</span>
a1.sinks.k1.hdfs.batchSize = 1000
<span class="hljs-meta prompt_"># </span><span class="bash">Bind the <span class="hljs-built_in">source</span> and sink to the channel</span>
a1.sources.r1.channels = c1
a1.sinks.k1.channel = c1
</code></pre>
<ul>
<li>filegroupsï¼šæŒ‡å®šfilegroupsï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œä»¥ç©ºæ ¼åˆ†å‰²ï¼ˆtaildir sourceå¯ä»¥åŒæ—¶ç›‘æ§å¤šä¸ªç›®å½•ä¸­çš„æ–‡ä»¶ï¼‰</li>
<li>headers.filegroups.headerKey</li>
</ul>
<p>ç»™Eventå¢åŠ header Keyï¼Œä¸åŒçš„filegroupï¼Œå¯é…ç½®ä¸åŒçš„valueã€‚</p>
<h2 data-id="heading-17">é”™è¯¯é€ŸæŸ¥</h2>













































<table><thead><tr><th>ç—‡çŠ¶</th><th>æ ¹å› å®šä½</th><th>ä¿®å¤</th></tr></thead><tbody><tr><td>Flume å¯åŠ¨ç›´æ¥æŠ¥ â€œUnknown/Unrecognized optionâ€ æˆ–å‚æ•°ä¸ç”Ÿæ•ˆ</td><td>agent å¯åŠ¨å‚æ•°å†™é”™ï¼ˆå¦‚ -name / flume.roog.loggerï¼‰</td><td>çœ‹ flume-ng agent è¾“å‡ºçš„ usage/Unknown optionï¼›ç”¨ <code>--name a1</code>ï¼›logger ç”¨ <code>-Dflume.root.logger=INFO,console</code></td></tr><tr><td>å¯åŠ¨æŠ¥ ClassNotFoundï¼šè‡ªå®šä¹‰æ‹¦æˆªå™¨æ‰¾ä¸åˆ°</td><td>jar æœªæ”¾åˆ° Flume classpath æˆ–æœªåŒ…å«ä¾èµ–</td><td><code>grep -i classnotfound flume.log</code>ï¼›ç¡®è®¤ jar æ˜¯å¦åœ¨ <code>$FLUME_HOME/lib</code>ï¼›æ”¾å…¥ <code>/opt/servers/apache-flume-1.9.0-bin/lib/</code>ï¼›ä¼˜å…ˆä½¿ç”¨ jar-with-dependencies</td></tr><tr><td>Interceptor ç”Ÿæ•ˆä½† <code>%{logtime}</code> ä¸ºç©ºï¼ŒHDFS è·¯å¾„åˆ†åŒºå¼‚å¸¸</td><td>æœªæ­£ç¡®å†™ headerï¼ˆè§£æå¤±è´¥/å­—æ®µç¼ºå¤±/æ­£åˆ™ä¸åŒ¹é…ï¼‰</td><td>åœ¨ Sink å‰åŠ  LoggerSink æˆ– Debug æ—¥å¿—æ‰“å° headersï¼›åœ¨æ‹¦æˆªå™¨é‡Œå¯¹ç¼ºå¤±æ—¶é—´è®¾ç½®å…œåº•ï¼›ä¸¥æ ¼æ ¡éªŒæ—¥å¿—æ ¼å¼ä¸æ—¶é—´æå–è§„åˆ™</td></tr><tr><td>HDFS ä¸Šè¿Ÿè¿Ÿä¸ç”Ÿæˆæ–‡ä»¶ï¼Œæˆ–ç”Ÿæˆå¾ˆæ…¢</td><td>rollInterval/idleTimeout/rollCount é…ç½®å¯¼è‡´â€œåªæŒ‰å¤§å°æ»šåŠ¨â€ï¼Œä½æµé‡ä¸è§¦å‘</td><td>çœ‹ HDFS ç›®æ ‡ç›®å½•æ˜¯å¦å‡ºç° <code>.tmp</code> æˆ–é•¿æ—¶é—´æ— æ–‡ä»¶ï¼›çœ‹ sink æŒ‡æ ‡ï¼›ä½æµé‡åœºæ™¯è®¾ç½® <code>hdfs.rollInterval=60</code> æˆ– <code>hdfs.idleTimeout=60</code>ï¼›ä¿ç•™ rollSize ä½œä¸ºä¸Šé™</td></tr><tr><td>HDFS å†™å…¥æŠ¥ Permission denied / lease é”™è¯¯</td><td>HDFS ç›®å½•æƒé™/ç”¨æˆ·èº«ä»½ä¸åŒ¹é…ï¼›Kerberos/ä»£ç†ç”¨æˆ·æœªé…ç½®</td><td>çœ‹ Flume æ—¥å¿—ä¸­ <code>org.apache.hadoop.security</code> / Permission deniedï¼›ç»™ Flume è¿è¡Œç”¨æˆ·æˆæƒç›®æ ‡ç›®å½•ï¼›æŒ‰é›†ç¾¤å¯ç”¨ <code>hdfs.kerberosPrincipal</code> ç­‰å®‰å…¨å‚æ•°ï¼ˆå¦‚æœ‰ï¼‰</td></tr><tr><td>TAILDIR ä¸é‡‡é›†æˆ–åªé‡‡åˆ°ä¸€æ¬¡ï¼Œé‡å¯åä»å¤´/ä¸ç»­é‡‡</td><td>positionFile è·¯å¾„ä¸å¯å†™/æ ¼å¼æŸå/å¤š agent å…±ç”¨åŒä¸€æ–‡ä»¶</td><td>æ£€æŸ¥ positionFile æ˜¯å¦æ›´æ–°ï¼›çœ‹æ˜¯å¦æœ‰ JSON è§£ææŠ¥é”™ï¼›ç¡®ä¿ç›®å½•å¯å†™ï¼›æ¯ä¸ª agent ç‹¬ç«‹ positionFileï¼›æŸåæ—¶å¤‡ä»½åé‡å»º</td></tr><tr><td>å¤šç›®å½•é‡‡é›†æ—¶ logtype ä¸¢å¤±æˆ–æ··å†™</td><td>headers é…ç½®å†™é”™ï¼ˆheaders.f1.logtype / filegroups åä¸ä¸€è‡´ï¼‰æˆ–æ‹¦æˆªå™¨è¦†ç›–</td><td>åœ¨ LoggerSink è¾“å‡º headers å¯¹æ¯” start/eventï¼›ä¿è¯ filegroups = f1 f2 ä¸ headers.f1.* / headers.f2.* å®Œå…¨ä¸€è‡´ï¼›æ˜ç¡®æ‹¦æˆªå™¨æ˜¯å¦æ”¹å†™ logtype</td></tr></tbody></table>
<h2 data-id="heading-18">å…¶ä»–ç³»åˆ—</h2>
<h3 data-id="heading-19">ğŸš€ AIç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>AIç‚¼ä¸¹æ—¥å¿—-29 - å­—èŠ‚è·³åŠ¨ DeerFlow æ·±åº¦ç ”ç©¶æ¡†<em>æ–œä½“æ ·å¼</em>æ¶ ç§æœ‰éƒ¨ç½² æµ‹è¯•ä¸Šæ‰‹ æ¶æ„ç ”ç©¶</strong>ï¼ŒæŒç»­æ‰“é€ å®ç”¨AIå·¥å…·æŒ‡å—ï¼
<strong>AIç ”ç©¶-132 Java ç”Ÿæ€å‰æ²¿ 2025ï¼šSpringã€Quarkusã€GraalVMã€CRaC ä¸äº‘åŸç”Ÿè½åœ°</strong></p>
<h3 data-id="heading-20">ğŸ’» Javaç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>Java-218 RocketMQ Java API å®æˆ˜ï¼šåŒæ­¥/å¼‚æ­¥ Producer ä¸ Pull/Push Consumer</strong>
MyBatis å·²å®Œç»“ï¼ŒSpring å·²å®Œç»“ï¼ŒNginxå·²å®Œç»“ï¼ŒTomcatå·²å®Œç»“ï¼Œåˆ†å¸ƒå¼æœåŠ¡å·²å®Œç»“ï¼ŒDubboå·²å®Œç»“ï¼ŒMySQLå·²å®Œç»“ï¼ŒMongoDBå·²å®Œç»“ï¼ŒNeo4jå·²å®Œç»“ï¼ŒFastDFS å·²å®Œç»“ï¼ŒOSSå·²å®Œç»“ï¼ŒGuavaCacheå·²å®Œç»“ï¼ŒEVCacheå·²å®Œç»“ï¼ŒRabbitMQå·²å®Œç»“ï¼ŒRocketMQæ­£åœ¨æ›´æ–°... æ·±å…¥æµ…å‡ºåŠ©ä½ æ‰“ç‰¢åŸºç¡€ï¼</p>
<h3 data-id="heading-21">ğŸ“Š å¤§æ•°æ®æ¿å—å·²å®Œæˆå¤šé¡¹å¹²è´§æ›´æ–°ï¼ˆ300ç¯‡ï¼‰ï¼š</h3>
<p>åŒ…æ‹¬ Hadoopã€Hiveã€Kafkaã€Flinkã€ClickHouseã€Elasticsearch ç­‰äºŒåä½™é¡¹æ ¸å¿ƒç»„ä»¶ï¼Œè¦†ç›–ç¦»çº¿+å®æ—¶æ•°ä»“å…¨æ ˆï¼
<strong>å¤§æ•°æ®-278 Spark MLib - åŸºç¡€ä»‹ç» æœºå™¨å­¦ä¹ ç®—æ³• æ¢¯åº¦æå‡æ ‘ GBDTæ¡ˆä¾‹ è¯¦è§£</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Linuxã€‘è¿ç»´å®æˆ˜ç¬”è®° â€” æˆ‘å¸¸ç”¨çš„æ–¹æ³•ä¸å‘½ä»¤]]></title>    <link>https://juejin.cn/post/7601075423003459620</link>    <guid>https://juejin.cn/post/7601075423003459620</guid>    <pubDate>2026-02-01T05:59:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601075423003459620" data-draft-id="7601103779392634943" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Linuxã€‘è¿ç»´å®æˆ˜ç¬”è®° â€” æˆ‘å¸¸ç”¨çš„æ–¹æ³•ä¸å‘½ä»¤"/> <meta itemprop="keywords" content="è¿ç»´,Linux"/> <meta itemprop="datePublished" content="2026-02-01T05:59:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Kidaçš„èººå¹³å°å±‹"/> <meta itemprop="url" content="https://juejin.cn/user/1684864740889758"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Linuxã€‘è¿ç»´å®æˆ˜ç¬”è®° â€” æˆ‘å¸¸ç”¨çš„æ–¹æ³•ä¸å‘½ä»¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1684864740889758/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Kidaçš„èººå¹³å°å±‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T05:59:38.000Z" title="Sun Feb 01 2026 05:59:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">1. å¿«é€Ÿå®šä½å“ªä¸ªå±‚æ¬¡å‡ºé—®é¢˜</h3>
<p>å½“æœåŠ¡å¼‚å¸¸æˆ–å‘Šè­¦æ—¶ï¼Œæˆ‘ç¬¬ä¸€æ­¥ä¸æ˜¯ç›´æ¥é‡å¯ï¼Œè€Œæ˜¯æŠŠç³»ç»Ÿâ€œç›®å‰çš„æ ·å­â€æŠ“ä¸‹æ¥ï¼Œå‘½ä»¤å¾ˆçŸ­ä½†ä¿¡æ¯å¯†åº¦é«˜ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›ç¨‹ä¸è´Ÿè½½</span>
<span class="hljs-built_in">uptime</span>
top -b -n 1 | <span class="hljs-built_in">head</span> -n 20

<span class="hljs-comment"># å†…å­˜/äº¤æ¢</span>
free -h
vmstat 1 5

<span class="hljs-comment"># ç£ç›˜ç©ºé—´ä¸ inode</span>
<span class="hljs-built_in">df</span> -hT
<span class="hljs-built_in">df</span> -i

<span class="hljs-comment"># I/O ä¸ç­‰å¾…</span>
iostat -xz 1 3   <span class="hljs-comment"># éœ€è¦ sysstat åŒ…</span>
iotop -o         <span class="hljs-comment"># éœ€è¦ iotop</span>

<span class="hljs-comment"># ç½‘ç»œä¾¦æµ‹</span>
ss -tulpn
ip a
ip route
</code></pre>
<p>è¿™äº›è¾“å‡ºèƒ½é©¬ä¸Šå‘Šè¯‰æˆ‘ï¼šCPU è¢«æŸè¿›ç¨‹åƒæ»¡äº†ï¼Ÿå†…å­˜è€—å°½ï¼Ÿç£ç›˜æ»¡äº†å¯¼è‡´å†™å¤±è´¥ï¼Ÿè¿˜æ˜¯ç½‘ç»œç«¯å£æ²¡æœ‰ç›‘å¬ï¼Ÿæˆ‘ä¼šæŠŠè¿™äº›å‘½ä»¤è¾“å‡ºå¤åˆ¶åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œä½œä¸ºåç»­åˆ†æçš„è¯æ®ã€‚</p>
<h3 data-id="heading-1">2. è¿›ç¨‹å±‚é¢ç²¾æŸ¥</h3>
<p>å¦‚æœ top æ˜¾ç¤ºæŸä¸ª PID å ç”¨å¼‚å¸¸ï¼Œæˆ‘ä¼šç”¨ä»¥ä¸‹æ­¥éª¤ç¡®è®¤è¿›ç¨‹è¡Œä¸ºï¼Œä¸è½»æ˜“ killï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ps -eo pid,ppid,cmd,%mem,%cpu --<span class="hljs-built_in">sort</span>=-%cpu | <span class="hljs-built_in">head</span> -n 20

<span class="hljs-comment"># æŸ¥çœ‹è¿›ç¨‹æ‰“å¼€çš„ç½‘ç»œ/æ–‡ä»¶</span>
lsof -p &lt;PID&gt;
ss -p | grep &lt;PID&gt;

<span class="hljs-comment"># è·Ÿè¸ªç³»ç»Ÿè°ƒç”¨ï¼ˆçŸ­æ—¶é—´å†…è§‚å¯Ÿï¼‰</span>
strace -p &lt;PID&gt; -s 200 -o /tmp/strace.&lt;PID&gt;.<span class="hljs-built_in">log</span>
<span class="hljs-comment"># æˆ–åªæŠ“å–é˜»å¡çš„ syscall</span>
strace -p &lt;PID&gt; -e trace=network,file -s 200 -o /tmp/strace.net.log
</code></pre>
<p>æˆ‘ç”¨ <code>strace</code> å¹¶ä¸æ˜¯é•¿æœŸè·Ÿè¸ªï¼Œè€Œæ˜¯æƒ³çŸ¥é“ç¨‹åºå¡åœ¨åš I/Oã€ç­‰å¾…ç½‘ç»œï¼Œè¿˜æ˜¯åœ¨æ— é™å¾ªç¯ã€‚å¦‚æœ <code>strace</code> æ˜¾ç¤º blocked on write æˆ– blocked on futexï¼Œé‚£æˆ‘å°±çŸ¥é“è¿™ä¸æ˜¯ CPU ç®—åŠ›é—®é¢˜ï¼Œè€Œæ˜¯ I/O æˆ–é”ç«äº‰ã€‚</p>
<p>å¦‚æœæ˜¯å†…å­˜é—®é¢˜ï¼Œç”¨ <code>pmap -x &lt;PID&gt;</code> æˆ– <code>smem</code> çœ‹å†…å­˜åˆ†å¸ƒï¼›å¦‚æœæ˜¯é¢‘ç¹åˆ›å»ºå­è¿›ç¨‹å¯¼è‡´ load é«˜ï¼Œç”¨ <code>pstree -p &lt;PID&gt;</code> çœ‹çˆ¶å­å…³ç³»ã€‚</p>
<h3 data-id="heading-2">3. å…ˆè¯»ä¸æ”¹ï¼Œå†åŠ¨æ‰‹</h3>
<p>ç£ç›˜æ»¡ã€inode ç”¨å°½ã€æ–‡ä»¶ç³»ç»Ÿé”™ä¹±æ˜¯æˆ‘é‡åˆ°æœ€å¤šçš„åœæœæ¥æºã€‚å…³é”®åŸåˆ™ï¼š<strong>èƒ½è¯»å°±å¤‡ä»½</strong>ã€‚</p>
<p>æŸ¥ç£ç›˜å ç”¨æ—¶ï¼Œæˆ‘ä¸ç›´æ¥ç”¨ <code>du /</code>ï¼ˆå¤ªæ…¢ï¼‰ï¼Œè€Œæ˜¯åˆ†çº§å®šä½ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¤§ç›®å½•ä¸€è§ˆï¼Œå¿«é€Ÿæ‰¾åˆ°â€œèƒ–ç›®å½•â€</span>
<span class="hljs-built_in">du</span> -xsh /var/* | <span class="hljs-built_in">sort</span> -rh | <span class="hljs-built_in">head</span> -n 20

<span class="hljs-comment"># å®šä½å•ä¸ªç›®å½•ä¸‹çš„å¤§æ–‡ä»¶</span>
find /var/log -xdev -<span class="hljs-built_in">type</span> f -size +100M -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> -lh {} \;

<span class="hljs-comment"># æŸ¥ inode ä½¿ç”¨</span>
<span class="hljs-built_in">df</span> -i
</code></pre>
<p>ç£ç›˜æ»¡äº†èƒ½çŸ­æœŸæ•‘æ€¥çš„åšæ³•æˆ‘ä¼šå…ˆç”¨ï¼šæ¸…ç†æ—§æ—¥å¿—ï¼ˆä½†ä¿ç•™å¤‡ä»½ï¼‰ï¼Œå‹ç¼©å½’æ¡£å†·æ•°æ®ï¼Œæˆ–æŠŠæŸä¸ªç›®å½•ä¸´æ—¶æŒ‚åˆ°å¦ä¸€ä¸ªç£ç›˜ä¸Šï¼ˆmount --bindï¼‰ã€‚åªæœ‰åœ¨ç¡®è®¤æ²¡æœ‰å…¶ä»–åŠæ³•æ—¶æ‰åˆ é™¤æ–‡ä»¶ï¼Œå¹¶æŠŠåˆ é™¤æ¸…å•è®°å½•ä¸‹æ¥ã€‚</p>
<p>è‹¥é‡åˆ° filesystem corruptionï¼Œæˆ‘ä¼šå…ˆç”¨ <code>fsck.ext4 -n /dev/sdX</code> åšåªè¯»æ£€æŸ¥ï¼Œç„¶ååšé•œåƒ <code>dd if=/dev/sdX of=/backup/sdX.img bs=4M status=progress</code>ï¼ˆå¦‚æœç›˜è¿˜èƒ½è¯»ï¼‰ï¼Œå†åœ¨é•œåƒä¸Šå°è¯•ä¿®å¤ï¼Œè¿™æ ·æŠŠé£é™©é™åˆ°æœ€ä½ã€‚</p>
<h3 data-id="heading-3">4. æˆ‘å¦‚ä½•å¿«é€Ÿä»æ—¥å¿—é‡ŒæŠ“é—®é¢˜</h3>
<p>æˆ‘ç»å¸¸ç”¨ <code>journalctl</code> å’Œ <code>tail -F</code> è”åˆæŠ“å–æœåŠ¡æ—¥å¿—ã€‚<code>journalctl</code> çš„æ—¶é—´è¿‡æ»¤å¾ˆæœ‰ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ç³»ç»Ÿ journal</span>
journalctl -xe --no-pager

<span class="hljs-comment"># æŸä¸ªæœåŠ¡æœ€è¿‘ 200 è¡Œå¹¶æŒç»­è·Ÿè¸ª</span>
journalctl -u myservice -n 200 -f

<span class="hljs-comment"># grep å…³é”®è¯ï¼ˆæ³¨æ„ journalctl è‡ªå¸¦è¿‡æ»¤ï¼‰</span>
journalctl -u myservice --since <span class="hljs-string">"2026-01-25 10:00"</span> --until <span class="hljs-string">"2026-01-25 11:00"</span> | grep -i error
</code></pre>
<p>æˆ‘ä¸€èˆ¬ä¸ä¼šä¸€æ¬¡è¯»å…¨æ—¥å¿—ï¼Œè€Œæ˜¯å…ˆå®šä½æ—¶é—´çª—å£ï¼ˆæŠ¥è­¦è§¦å‘æ—¶åˆ»å‰å 5 åˆ†é’Ÿï¼‰ï¼Œç„¶åå‘å¤–æ‰©å±•ã€‚å¾ˆå¤šæ—¶å€™æ ¹å› å°±åœ¨é‚£çŸ­çŸ­å‡ è¡Œå †æ ˆæˆ–é”™è¯¯ä»£ç é‡Œã€‚</p>
<h3 data-id="heading-4">5. éªŒè¯é“¾è·¯ã€ç«¯å£ã€DNSã€è·¯ç”±</h3>
<p>ç½‘ç»œæ•…éšœå¸¸æœ‰ä¸‰ç§è¡¨ç°ï¼šæœ¬æœºæ— æ³•è®¿é—®ã€ç«¯å£æœªç›‘å¬ã€è¿œç¨‹ä¸é€šã€‚æˆ‘å¸¸åšçš„é¡ºåºæ˜¯ï¼š</p>
<ol>
<li><code>ip a</code> çœ‹åœ°å€ï¼›2. <code>ss -tulpn</code> ç¡®è®¤æœåŠ¡åœ¨ç›‘å¬ï¼›3. <code>curl -I http://127.0.0.1:ç«¯å£</code> éªŒè¯æœ¬æœºæœåŠ¡ï¼›4. <code>tcpdump -i &lt;if&gt; host &lt;peer&gt;</code> æŠ“åŒ…çœ‹æµé‡ã€‚</li>
</ol>
<p>ä¸¾ä¸ªæˆ‘å¸¸ç”¨çš„æŠ“åŒ…å‘½ä»¤ï¼šæˆ‘æƒ³çœ‹ä¸è¿œç«¯ 10.1.2.3 çš„è¿æ¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo tcpdump -i eth0 host 10.1.2.3 -nn -s0 -w /tmp/cap.pcap
</code></pre>
<p>æŠ“å®Œæˆ‘ä¼šç”¨ Wireshark/<code>tcpdump -r</code> æœ¬åœ°æŸ¥çœ‹æ˜¯å¦æœ‰ä¸‰æ¬¡æ¡æ‰‹ï¼Œæ˜¯å¦æœ‰ RSTï¼Œæˆ–è€…æ˜¯å¦åªæ˜¯åº”ç”¨å±‚è¶…æ—¶ã€‚</p>
<h3 data-id="heading-5">6. æœåŠ¡ç®¡ç†ä¸å¿«é€Ÿæ¢å¤çš„å¥—è·¯</h3>
<p>æˆ‘å§‹ç»ˆåšæŒâ€œå…ˆæ¢å¤æœåŠ¡ï¼Œå†åšæ ¹å› åˆ†æâ€ã€‚è¿™é€šå¸¸æ„å‘³ç€å¿«é€Ÿé‡å¯ service æˆ–åˆ‡æ¢åˆ°å¤‡å®ä¾‹ï¼Œè€Œä¸æ˜¯ç›²ç›®è°ƒå‚ã€‚å¸¸ç”¨å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">systemctl status myservice
systemctl restart myservice
systemctl stop myservice
journalctl -u myservice -n 200 -f
</code></pre>
<p>å¦‚æœé‡å¯åé—®é¢˜æ¶ˆå¤±ï¼Œæˆ‘ä¸ä¼šå½“åœºæŠŠç³»ç»Ÿå‡çº§æˆ–æ”¹é…ç½®ï¼›æˆ‘ä¼šæŠŠæ¢å¤æ­¥éª¤è®°å½•ï¼Œæ ‡æ³¨ä¸ºâ€œä¸´æ—¶æ¢å¤â€ï¼Œå¹¶åœ¨äº‹åä½å³°æ—¶æ®µåšæ·±å…¥æ’æŸ¥ã€‚</p>
<h3 data-id="heading-6">7. å¤‡ä»½ä¸æ¢å¤</h3>
<p>æˆ‘åå¥½ <code>rsync</code> åšæ–‡ä»¶/ç›®å½•çº§å¤‡ä»½ï¼Œå› ä¸ºå®ƒç®€å•ä¸”å¯å¢é‡ã€‚ç¤ºä¾‹æˆ‘å¸¸ç”¨çš„å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">rsync -aHAX --delete --info=progress2 /data/ /backup/data/
<span class="hljs-comment"># è¯´æ˜ï¼š-aHAX ä¿æŒæƒé™/ç¡¬é“¾æ¥/ACL/æ‰©å±•å±æ€§ï¼›--delete ä¿è¯ç›®æ ‡é•œåƒæºï¼›--info æ˜¾ç¤ºè¿›åº¦</span>
</code></pre>
<p>å¯¹äºæ›´å¤æ‚çš„ç‰ˆæœ¬åŒ–å¤‡ä»½ï¼Œæˆ‘ä¼šç”¨ <code>rsync --link-dest</code> åšç¡¬é“¾æ¥å¢é‡ï¼Œæˆ–è€…é•¿æœŸä½¿ç”¨ <code>restic</code> / <code>borg</code> åšå»é‡å’ŒåŠ å¯†å¤‡ä»½ï¼Œè¿™é‡Œæˆ‘ä¸ªäººåå¥½ restic çš„ç®€å•æ€§ã€‚</p>
<p>é‡è¦çš„æ˜¯ï¼šæ¯æ¬¡å¤‡ä»½åéƒ½åšæ¢å¤æ¼”ç»ƒã€‚å¤‡ä»½ä¸éªŒè¯ = æ²¡æœ‰å¤‡ä»½ã€‚</p>
<h3 data-id="heading-7">8. å‡çº§ã€æ‰“è¡¥ä¸ä¸å˜æ›´ç®¡ç†</h3>
<p>åœ¨æˆ‘çœ‹æ¥ï¼Œå‡çº§æ˜¯é£é™©ç®¡ç†è€Œä¸æ˜¯ä¾‹è¡Œæ“ä½œã€‚åŸåˆ™ä¸Šæˆ‘åœ¨ä¸‰å±‚ç¯å¢ƒè·‘å‡çº§ï¼š</p>
<ol>
<li>æœ¬åœ°å¼€å‘æœºï¼ˆå¿«é€ŸéªŒè¯ï¼‰</li>
<li>ç°åº¦æˆ–æµ‹è¯•ç¯å¢ƒï¼ˆä¸šåŠ¡åœºæ™¯è¦†ç›–ï¼‰</li>
<li>ç”Ÿäº§ï¼ˆä½å³°çª—å£ï¼Œå…ˆå¤‡ä»½ï¼‰</li>
</ol>
<p>å¦‚æœæ˜¯å…³é”®ç»„ä»¶ï¼ˆå†…æ ¸ã€æ•°æ®åº“ã€å®¹å™¨ runtimeï¼‰ï¼Œæˆ‘ä¼šå…ˆæ‹å¿«ç…§æˆ–å¤‡ä»½æ•°æ®ï¼Œå¹¶å‡†å¤‡å›æ»šè®¡åˆ’ã€‚å¾ˆå¤šæ•…éšœæ¥è‡ªâ€œç‰ˆæœ¬è·³å¤ªå¤§â€ï¼Œæ‰€ä»¥åˆ†é˜¶æ®µã€æ¯æ¬¡æ”¹ä¸€ä¸ªç»´åº¦ï¼Œæ˜¯æˆ‘ä¸å‡ºæ„å¤–çš„ä¿å‘½æ³•åˆ™ã€‚</p>
<h3 data-id="heading-8">9. â€œæ•‘å‘½â€å‘½ä»¤</h3>
<p>ä¸‹é¢è¿™äº›å‘½ä»¤æˆ‘æŠŠå®ƒä»¬èƒŒåœ¨æ‰‹ä¸Šï¼Œå…³é”®æ—¶åˆ»èƒ½æ•‘åœºï¼ˆæ¯ä¸ªå‘½ä»¤å‰åçš„è¯­å¢ƒæˆ‘éƒ½ä¼šå…ˆç¡®è®¤ï¼‰ï¼š</p>
<ul>
<li>æ‰¾å ç©ºé—´çš„æ–‡ä»¶ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">du</span> -xsh /var/* | <span class="hljs-built_in">sort</span> -rh | <span class="hljs-built_in">head</span> -n 20
</code></pre>
<ul>
<li>æ‰¾å¤§äº 100MB çš„æ–‡ä»¶ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">find / -xdev -<span class="hljs-built_in">type</span> f -size +100M -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">ls</span> -lh {} \; | <span class="hljs-built_in">sort</span> -k5 -h
</code></pre>
<ul>
<li>å¿«é€ŸæŸ¥çœ‹æŸç«¯å£è°åœ¨å ç”¨ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">ss -tulpn | grep :80
</code></pre>
<ul>
<li>æŠŠæŸä¸ªæœåŠ¡æ—¥å¿—æµå¼ä¿å­˜å¹¶ grep é”™è¯¯ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">journalctl -u myservice -f |&amp; <span class="hljs-built_in">tee</span> /tmp/myservice.log | grep -i error
</code></pre>
<ul>
<li>ä¸´æ—¶å¢åŠ  swapï¼ˆçŸ­æœŸæ•‘å†…å­˜ä¸è¶³ï¼‰ï¼š</li>
</ul>
<pre><code class="hljs language-bash" lang="bash">sudo fallocate -l 1G /swapfile
sudo <span class="hljs-built_in">chmod</span> 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
</code></pre>
<p>è¿™äº›å‘½ä»¤çœ‹èµ·æ¥ç®€å•ï¼Œä½†ç”¨äº†å°±çŸ¥é“ï¼šåœ¨ç´§æ€¥æƒ…å†µä¸‹ï¼Œé€Ÿåº¦å’Œè¯æ®æ¯”å®Œç¾çš„æ­¥éª¤æ›´é‡è¦ã€‚</p>
<h3 data-id="heading-9">10. æˆ‘çš„å°ä¹ æƒ¯</h3>
<p>æˆ‘æŠŠè¿™äº›ä¹ æƒ¯æ”¾åœ¨æœ€åï¼Œå› ä¸ºå®ƒä»¬å¾€å¾€æ¯”ä¸€å †å‘½ä»¤æ›´èƒ½é™ä½äº‹æ•…ç‡ï¼š</p>
<ul>
<li>æ¯æ¬¡å˜æ›´å†™å˜æ›´æ—¥å¿—ï¼Œè®°å½•æ—¶é—´ã€æ“ä½œäººå’Œå›æ»šæ­¥éª¤ã€‚</li>
<li>æŠŠå¸¸ç”¨çš„æ’é”™æ­¥éª¤å†™æˆè„šæœ¬æˆ– playbookï¼ˆAnsibleï¼‰ï¼Œé¿å…â€œæ‰‹å·¥å¤±è¯¯â€ã€‚</li>
<li>å®šæœŸæ¼”ç»ƒæ¢å¤ï¼Œä» 1 æ¬¡å˜æ›´å¼€å§‹å»ºç«‹ä¿¡å¿ƒé“¾ã€‚</li>
<li>å¯¹ç”Ÿäº§æœºå™¨åšæœ€å°æƒé™é…ç½®ï¼Œé¿å…è¿ç»´è¯¯æ“ä½œé€ æˆçº§è”æ•…éšœã€‚</li>
<li>å¯¹å…³é”®ç›˜åš SMART å®šæœŸæ£€æµ‹å¹¶é¢„è­¦ï¼ˆ<code>smartctl -H /dev/sdX</code>ï¼‰ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­ç§˜ Python åç¨‹é­”æ³•ï¼šæ·±å…¥ç†è§£ asyncio äº‹ä»¶å¾ªç¯çš„å¥¥ç§˜ä¸å®è·µ]]></title>    <link>https://juejin.cn/post/7601046076943908879</link>    <guid>https://juejin.cn/post/7601046076943908879</guid>    <pubDate>2026-01-31T16:59:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601046076943908879" data-draft-id="7601073900525371434" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­ç§˜ Python åç¨‹é­”æ³•ï¼šæ·±å…¥ç†è§£ asyncio äº‹ä»¶å¾ªç¯çš„å¥¥ç§˜ä¸å®è·µ"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-31T16:59:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¥½åå­—_æŠ€æœ¯åˆ†äº«"/> <meta itemprop="url" content="https://juejin.cn/user/1101056944119610"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­ç§˜ Python åç¨‹é­”æ³•ï¼šæ·±å…¥ç†è§£ asyncio äº‹ä»¶å¾ªç¯çš„å¥¥ç§˜ä¸å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1101056944119610/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¥½åå­—_æŠ€æœ¯åˆ†äº«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T16:59:24.000Z" title="Sat Jan 31 2026 16:59:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ­ç§˜ Python åç¨‹é­”æ³•ï¼šæ·±å…¥ç†è§£ asyncio äº‹ä»¶å¾ªç¯çš„å¥¥ç§˜ä¸å®è·µ</h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>åœ¨ Python çš„ä¸–ç•Œé‡Œï¼Œåç¨‹ï¼ˆcoroutineï¼‰æ˜¯å®ç°å¹¶å‘å’Œå¼‚æ­¥ç¼–ç¨‹çš„å¼ºå¤§å·¥å…·ã€‚è€Œ <code>asyncio</code> åº“åˆ™æ˜¯ Python å¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒã€‚ç†è§£ <code>asyncio</code> çš„äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰æœºåˆ¶ï¼Œæ˜¯æŒæ¡ Python å¼‚æ­¥ç¼–ç¨‹çš„å…³é”®ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ Python åç¨‹ä¸ <code>asyncio</code> äº‹ä»¶å¾ªç¯çš„åŸç†ã€è¿ä½œæ–¹å¼åŠå®æˆ˜åº”ç”¨ã€‚</p>
<h3 data-id="heading-2">ä¸€ã€ä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿ</h3>
<p>åç¨‹æ˜¯ä¸€ç§ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œå®ƒå…è®¸å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æš‚åœï¼Œå¹¶åœ¨ä¹‹åä»æš‚åœç‚¹ç»§ç»­æ‰§è¡Œã€‚ä¸ä¼ ç»Ÿçº¿ç¨‹ä¸åŒï¼Œåç¨‹çš„åˆ‡æ¢ç”±ç¨‹åºæ˜¾å¼æ§åˆ¶ï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿã€‚è¿™ä½¿å¾—åç¨‹çš„å¼€é”€éå¸¸å°ï¼Œä¸”é¿å…äº†å¤šçº¿ç¨‹ä¸­çš„é”ç«äº‰é—®é¢˜ã€‚</p>
<p>Python ä¸­é€šè¿‡ <code>async def</code> å®šä¹‰åç¨‹å‡½æ•°ï¼Œé€šè¿‡ <code>await</code> å…³é”®å­—æš‚åœåç¨‹çš„æ‰§è¡Œï¼Œç­‰å¾…ä¸€ä¸ªå¼‚æ­¥æ“ä½œå®Œæˆã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params">name, delay</span>):
    <span class="hljs-keyword">await</span> asyncio.sleep(delay) <span class="hljs-comment"># æ¨¡æ‹ŸIOæ“ä½œï¼Œæš‚åœæ‰§è¡Œ</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Hello, <span class="hljs-subst">{name}</span> after <span class="hljs-subst">{delay}</span> seconds!"</span>)

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-comment"># åŒæ—¶è¿è¡Œä¸¤ä¸ªåç¨‹</span>
    task1 = asyncio.create_task(greet(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">2</span>))
    task2 = asyncio.create_task(greet(<span class="hljs-string">"Bob"</span>, <span class="hljs-number">1</span>))
    
    <span class="hljs-keyword">await</span> task1
    <span class="hljs-keyword">await</span> task2

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    asyncio.run(main())
</code></pre>
<h3 data-id="heading-3">äºŒã€<code>asyncio</code> äº‹ä»¶å¾ªç¯</h3>
<p>äº‹ä»¶å¾ªç¯æ˜¯ <code>asyncio</code> çš„æ ¸å¿ƒï¼Œå®ƒè´Ÿè´£ç®¡ç†å’Œè°ƒåº¦æ‰€æœ‰çš„å¼‚æ­¥ä»»åŠ¡ã€‚å¯ä»¥å°†å…¶æƒ³è±¡æˆä¸€ä¸ªæ— é™å¾ªç¯ï¼Œä¸æ–­åœ°æ£€æŸ¥æ˜¯å¦æœ‰ä»»åŠ¡å‡†å¤‡å°±ç»ªå¯ä»¥æ‰§è¡Œï¼Œæˆ–è€…æ˜¯å¦æœ‰ I/O æ“ä½œå®Œæˆã€‚</p>
<h4 data-id="heading-4">2.1 äº‹ä»¶å¾ªç¯çš„èŒè´£</h4>
<ol>
<li><strong>è°ƒåº¦åç¨‹ï¼š</strong> å†³å®šå“ªä¸ªåç¨‹åœ¨ä½•æ—¶è¿è¡Œã€‚</li>
<li><strong>å¤„ç† I/Oï¼š</strong> ç›‘å¬ç½‘ç»œã€æ–‡ä»¶ç­‰ I/O äº‹ä»¶çš„å®Œæˆã€‚</li>
<li><strong>ç®¡ç†å¹¶å‘ï¼š</strong> ç¡®ä¿å¤šä¸ªåç¨‹èƒ½å¤Ÿåä½œåœ°è¿è¡Œï¼Œè€Œä¸æ˜¯é˜»å¡ã€‚</li>
</ol>
<h4 data-id="heading-5">2.2 äº‹ä»¶å¾ªç¯çš„è¿ä½œæœºåˆ¶</h4>
<p>å½“ä¸€ä¸ªåç¨‹é‡åˆ° <code>await</code> è¡¨è¾¾å¼æ—¶ï¼Œå®ƒä¼šæš‚åœæ‰§è¡Œå¹¶å°†æ§åˆ¶æƒäº¤è¿˜ç»™äº‹ä»¶å¾ªç¯ã€‚äº‹ä»¶å¾ªç¯æ­¤æ—¶ä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯å»æ£€æŸ¥å…¶ä»–å‡†å¤‡å°±ç»ªçš„åç¨‹ã€‚å½“ <code>await</code> ç­‰å¾…çš„å¼‚æ­¥æ“ä½œå®Œæˆåï¼Œäº‹ä»¶å¾ªç¯ä¼šå†æ¬¡è°ƒåº¦è¯¥åç¨‹ï¼Œä½¿å…¶ä»ä¸Šæ¬¡æš‚åœçš„åœ°æ–¹ç»§ç»­æ‰§è¡Œã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹é€šè¿‡ä¸€ä¸ªç§°ä¸ºâ€œé€‰æ‹©å™¨â€ï¼ˆSelectorï¼‰çš„æœºåˆ¶å®ç°ï¼Œå®ƒèƒ½é«˜æ•ˆåœ°ç›‘æ§å¤šä¸ª I/O å¥æŸ„çš„çŠ¶æ€ï¼Œä¾‹å¦‚ <code>select</code>ã€<code>epoll</code> æˆ– <code>kqueue</code>ã€‚</p>
<h4 data-id="heading-6">2.3 <code>asyncio.run()</code> çš„ä½œç”¨</h4>
<p><code>asyncio.run()</code> æ˜¯ Python 3.7+ å¼•å…¥çš„æ–¹ä¾¿å‡½æ•°ï¼Œå®ƒè´Ÿè´£ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶å¾ªç¯ã€‚</li>
<li>è¿è¡Œä¼ å…¥çš„é¡¶çº§åç¨‹ï¼Œç›´åˆ°å®Œæˆã€‚</li>
<li>å…³é—­äº‹ä»¶å¾ªç¯ã€‚</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">my_coroutine</span>():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Hello from coroutine!"</span>)
    <span class="hljs-keyword">await</span> asyncio.sleep(<span class="hljs-number">1</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Coroutine finished."</span>)

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main____"</span>:
    asyncio.run(my_coroutine()) <span class="hljs-comment"># ç®€åŒ–äº†äº‹ä»¶å¾ªç¯çš„ç®¡ç†</span>
</code></pre>
<h3 data-id="heading-7">ä¸‰ã€Taskï¼ˆä»»åŠ¡ï¼‰</h3>
<p><code>asyncio.Task</code> æ˜¯å¯¹åç¨‹çš„å°è£…ï¼Œå®ƒè´Ÿè´£å°†åç¨‹æ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯ä¸­ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«è°ƒåº¦å’Œæ‰§è¡Œã€‚é€šè¿‡ <code>asyncio.create_task()</code> åˆ›å»ºä»»åŠ¡ï¼Œå¯ä»¥å°†åç¨‹è½¬åŒ–ä¸ºå¯å¹¶å‘æ‰§è¡Œçš„å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">say_after</span>(<span class="hljs-params">delay, message</span>):\n    <span class="hljs-keyword">await</span> asyncio.sleep(delay)\n    <span class="hljs-built_in">print</span>(message)\n\nasync <span class="hljs-keyword">def</span> <span class="hljs-title function_">main_tasks</span>():\n    task1 = asyncio.create_task(say_after(<span class="hljs-number">1</span>, <span class="hljs-string">'hello'</span>))\n    task2 = asyncio.create_task(say_after(<span class="hljs-number">2</span>, <span class="hljs-string">'world'</span>))\n\n    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"started at <span class="hljs-subst">{asyncio.get_event_loop().time()}</span>"</span>)\n\n    <span class="hljs-keyword">await</span> task1\n    <span class="hljs-keyword">await</span> task2\n\n    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"finished at <span class="hljs-subst">{asyncio.get_event_loop().time()}</span>"</span>)\n\nif __name__ == <span class="hljs-string">"__main__"</span>:\n    asyncio.run(main_tasks())
</code></pre>
<h3 data-id="heading-8">å››ã€å®æˆ˜åº”ç”¨ä¸æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-9">4.1 I/O å¯†é›†å‹ä»»åŠ¡</h4>
<p>å¼‚æ­¥ç¼–ç¨‹æœ€é€‚åˆå¤„ç† I/O å¯†é›†å‹ä»»åŠ¡ï¼Œå¦‚ç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“æŸ¥è¯¢ã€æ–‡ä»¶è¯»å†™ç­‰ã€‚åœ¨ç­‰å¾… I/O å®Œæˆæ—¶ï¼ŒCPU å¯ä»¥åˆ‡æ¢åˆ°å…¶ä»–ä»»åŠ¡ï¼Œæé«˜æ•ˆç‡ã€‚</p>
<h4 data-id="heading-10">4.2 å¹¶å‘é™åˆ¶ä¸ä¿¡å·é‡</h4>
<p>åœ¨è¿›è¡Œå¤§é‡å¹¶å‘ç½‘ç»œè¯·æ±‚æ—¶ï¼Œä¸ºäº†é¿å…æœåŠ¡å™¨è¿‡è½½æˆ–è‡ªèº«èµ„æºè€—å°½ï¼Œå¯ä»¥ä½¿ç”¨ <code>asyncio.Semaphore</code> æ¥é™åˆ¶å¹¶å‘æ•°é‡ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> aiohttp
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">fetch_url</span>(<span class="hljs-params">session, url, semaphore</span>):   
 <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> semaphore:
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> session.get(url) <span class="hljs-keyword">as</span> response:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.text()
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main_semaphore</span>(<span class="hljs-params">urls, limit=<span class="hljs-number">5</span></span>):
    semaphore = asyncio.Semaphore(limit)
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> aiohttp.ClientSession() <span class="hljs-keyword">as</span> session:
        tasks = [fetch_url(session, url, semaphore) <span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls]
        results = <span class="hljs-keyword">await</span> asyncio.gather(*tasks)
        <span class="hljs-keyword">return</span> results
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    test_urls = [<span class="hljs-string">"http://example.com/"</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]
    asyncio.run(main_semaphore(test_urls))
</code></pre>
<h4 data-id="heading-11">4.3 é”™è¯¯å¤„ç†</h4>
<p>ä½¿ç”¨ <code>try...except</code> å—æ¥å¤„ç†åç¨‹ä¸­çš„å¼‚å¸¸ï¼Œç¡®ä¿ä¸€ä¸ªåç¨‹çš„å¤±è´¥ä¸ä¼šå¯¼è‡´æ•´ä¸ªäº‹ä»¶å¾ªç¯å´©æºƒã€‚</p>
<h4 data-id="heading-12">4.4 è°ƒè¯•æŠ€å·§</h4>
<p><code>asyncio</code> æä¾›äº†å¼ºå¤§çš„è°ƒè¯•åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® <code>ASYNCIO_DEBUG=1</code> ç¯å¢ƒå˜é‡æˆ– <code>loop.set_debug(True)</code> æ¥å¼€å¯ã€‚</p>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p>Python çš„ <code>asyncio</code> åŠå…¶äº‹ä»¶å¾ªç¯æœºåˆ¶ä¸ºå¼€å‘è€…æä¾›äº†æ„å»ºé«˜æ€§èƒ½ã€é«˜å¹¶å‘åº”ç”¨çš„åˆ©å™¨ã€‚é€šè¿‡ç†è§£åç¨‹ã€ä»»åŠ¡å’Œäº‹ä»¶å¾ªç¯çš„å†…åœ¨è”ç³»ï¼Œå¹¶éµå¾ªæœ€ä½³å®è·µï¼Œæˆ‘ä»¬èƒ½å¤Ÿç¼–å†™å‡ºæ›´å¥å£®ã€æ›´é«˜æ•ˆçš„å¼‚æ­¥ Python ä»£ç ï¼Œä»è€Œæ›´å¥½åœ°åº”å¯¹ç°ä»£ Web å¼€å‘ä¸­çš„æŒ‘æˆ˜ã€‚
å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°æŒæ¡ Python åç¨‹å’Œ <code>asyncio</code> äº‹ä»¶å¾ªç¯çš„å¥¥ç§˜ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[httpcore HTTP ä»£ç†åœºæ™¯ä¸‹çš„éšè”½è¿æ¥æ³„æ¼é—®é¢˜å®šä½ä¸ä¿®å¤]]></title>    <link>https://juejin.cn/post/7601020578491744265</link>    <guid>https://juejin.cn/post/7601020578491744265</guid>    <pubDate>2026-01-31T17:09:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601020578491744265" data-draft-id="7601069677566984238" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="httpcore HTTP ä»£ç†åœºæ™¯ä¸‹çš„éšè”½è¿æ¥æ³„æ¼é—®é¢˜å®šä½ä¸ä¿®å¤"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-31T17:09:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çœŸçš„æœ‰äººè·¯è¿‡å˜›"/> <meta itemprop="url" content="https://juejin.cn/user/4390796090672683"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            httpcore HTTP ä»£ç†åœºæ™¯ä¸‹çš„éšè”½è¿æ¥æ³„æ¼é—®é¢˜å®šä½ä¸ä¿®å¤
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4390796090672683/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çœŸçš„æœ‰äººè·¯è¿‡å˜›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T17:09:11.000Z" title="Sat Jan 31 2026 17:09:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    35
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å„ä½å¥½ï¼Œ</p>
<p>åœ¨ä½¿ç”¨ httpx é€šè¿‡ HTTP ä»£ç†è®¿é—® HTTPS æœåŠ¡æ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªéš¾ä»¥å¤ç°ä½†è‡´å‘½çš„è¿æ¥æ± è€—å°½é—®é¢˜ï¼šç¨‹åºè¿è¡Œä¸€æ®µæ—¶é—´åï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¼šæŠ›å‡º PoolTimeoutï¼Œå³ä½¿æ­¤æ—¶ä»£ç†æœåŠ¡æœ¬èº«æ˜¯æ­£å¸¸çš„ï¼ˆæµè§ˆå™¨è®¿é—®æ­£å¸¸ï¼‰ã€‚</p>
<p>ç»è¿‡å¯¹ httpx å’Œåº•å±‚ httpcore çš„æºç è¿½è¸ªï¼Œæˆ‘å‘ç°é—®é¢˜çš„æ ¹æºåœ¨äºï¼šå½“ CONNECT éš§é“å»ºç«‹æˆåŠŸã€ä½†åç»­ TLS æ¡æ‰‹å¤±è´¥æ—¶ï¼Œè¿æ¥å¯¹è±¡çš„çŠ¶æ€ä¼šæ°¸ä¹…åœç•™åœ¨ ACTIVEï¼Œæ—¢æ— æ³•è¢«å¤ç”¨ï¼Œä¹Ÿä¸ä¼šè¢«è¿æ¥æ± æ¸…ç†ï¼Œæœ€ç»ˆå½¢æˆ"åƒµå°¸è¿æ¥"å æ»¡æ•´ä¸ªè¿æ¥æ± ã€‚</p>
<p>æˆ‘å·²ç»æäº¤äº†ä¸€ä¸ªä¿®å¤æ–¹æ¡ˆï¼Œå¸Œæœ›èƒ½å¾—åˆ°ç¤¾åŒºçš„æ„è§ï¼š</p>
<p>PR é“¾æ¥: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fencode%2Fhttpcore%2Fpull%2F1049" target="_blank" title="https://github.com/encode/httpcore/pull/1049" ref="nofollow noopener noreferrer">github.com/encode/httpâ€¦</a></p>
<p>ä»¥ä¸‹æ˜¯æˆ‘çš„å®Œæ•´æ’æŸ¥åˆ†æï¼Œç€é‡æ¢³ç†äº† httpcore çš„çŠ¶æ€æœºæµè½¬ä¸å¼‚å¸¸å¤„ç†è¾¹ç•Œã€‚</p>
<h3 data-id="heading-0">æ·±åº¦æ’æŸ¥ï¼šçŠ¶æ€æœºä¸å¼‚å¸¸æµçš„è¿½è¸ª</h3>
<p>ä¸ºäº†å˜æ¸… PoolTimeout çš„æ ¹æºï¼Œæˆ‘ä» AsyncHTTPProxy å¼€å§‹ï¼Œå¯¹ httpcore çš„è¯·æ±‚ç”Ÿå‘½å‘¨æœŸè¿›è¡Œäº†é€è¡Œè¿½è¸ªã€‚</p>
<p><strong>è¿æ¥æ± è°ƒåº¦ä¸å®ç°ç»†èŠ‚</strong></p>
<p>AsyncHTTPProxy ç±»ç»§æ‰¿è‡ª AsyncConnectionPoolã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncHTTPProxy</span>(<span class="hljs-title class_ inherited__">AsyncConnectionPool</span>):  <span class="hljs-comment"># pragma: nocover</span>
    <span class="hljs-string">"""
    A connection pool that sends requests via an HTTP proxy.
    """</span>
</code></pre>
<p>å½“è¯·æ±‚è¿›å…¥è¿æ¥æ± æ—¶ï¼Œä¼šè§¦å‘ AsyncConnectionPool.handle_async_requestã€‚è¯¥æ–¹æ³•å°†è¯·æ±‚æ”¾å…¥é˜Ÿåˆ—ï¼Œå¹¶è¿›å…¥ while Trueå¾ªç¯ç­‰å¾…åˆ†é…è¿æ¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncConnectionPool.handle_async_request</span>
...
            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
                <span class="hljs-keyword">with</span> self._optional_thread_lock:
                    <span class="hljs-comment"># Assign incoming requests to available connections,</span>
                    <span class="hljs-comment"># closing or creating new connections as required.</span>
                    closing = self._assign_requests_to_connections()
                <span class="hljs-keyword">await</span> self._close_connections(closing)

                <span class="hljs-comment"># Wait until this request has an assigned connection.</span>
                connection = <span class="hljs-keyword">await</span> pool_request.wait_for_connection(timeout=timeout)

                <span class="hljs-keyword">try</span>:
                    <span class="hljs-comment"># Send the request on the assigned connection.</span>
                    response = <span class="hljs-keyword">await</span> connection.handle_async_request(
                        pool_request.request
                    )
                <span class="hljs-keyword">except</span> ConnectionNotAvailable:
                    <span class="hljs-comment"># In some cases a connection may initially be available to</span>
                    <span class="hljs-comment"># handle a request, but then become unavailable.</span>
                    <span class="hljs-comment">#</span>
                    <span class="hljs-comment"># In this case we clear the connection and try again.</span>
                    pool_request.clear_connection()
                <span class="hljs-keyword">else</span>:
                    <span class="hljs-keyword">break</span>  <span class="hljs-comment"># pragma: nocover</span>
...
</code></pre>
<p>è¿™é‡Œçš„é€»è¾‘æ˜¯ï¼šè‹¥è¿æ¥è·å–å¤±è´¥æˆ–ä¸å¯ç”¨ï¼Œä¼šé€šè¿‡ ConnectionNotAvailable å¼‚å¸¸è¿›è¡Œé‡è¯•ï¼›å¦åˆ™æ­£å¸¸è¿”å›å“åº”ã€‚</p>
<p>è¿æ¥åˆ†é…çš„æ ¸å¿ƒé€»è¾‘åœ¨ _assign_requests_to_connections ä¸­ã€‚<em>é¦–æ¬¡è¯·æ±‚æ—¶ï¼Œç”±äºè¿æ¥æ± ä¸ºç©ºï¼Œä¼šè¿›å…¥åˆ›å»ºæ–°è¿æ¥çš„åˆ†æ”¯</em>ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">#  AsyncConnectionPool._assign_requests_to_connections
...
            <span class="hljs-keyword">if</span> available_connections:
                # <span class="hljs-built_in">log</span>: <span class="hljs-string">"reusing existing connection"</span>
                connection = available_connections[<span class="hljs-number">0</span>]
                pool_request.assign_to_connection(connection)
            elif <span class="hljs-built_in">len</span>(<span class="hljs-built_in">self</span>._connections) &lt; <span class="hljs-built_in">self</span>._max_connections:
                # <span class="hljs-built_in">log</span>: <span class="hljs-string">"creating new connection"</span>
                connection = <span class="hljs-built_in">self</span>.create_connection(origin)
                <span class="hljs-built_in">self</span>._connections.append(connection)
                pool_request.assign_to_connection(connection)
            elif idle_connections:
                # <span class="hljs-built_in">log</span>: <span class="hljs-string">"closing idle connection"</span>
                connection = idle_connections[<span class="hljs-number">0</span>]
                <span class="hljs-built_in">self</span>._connections.<span class="hljs-built_in">remove</span>(connection)
                closing_connections.append(connection)
                # <span class="hljs-built_in">log</span>: <span class="hljs-string">"creating new connection"</span>
                connection = <span class="hljs-built_in">self</span>.create_connection(origin)
                <span class="hljs-built_in">self</span>._connections.append(connection)
                pool_request.assign_to_connection(connection)
...
</code></pre>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶çˆ¶ç±» AsyncConnectionPool å®šä¹‰äº† create_connectionï¼Œä½† AsyncHTTPProxy è¿›è¡Œäº†æ–¹æ³•é‡å†™ï¼ˆMethod Overridingï¼‰ï¼Œè¿”å›çš„æ˜¯ä¸“é—¨å¤„ç†ä»£ç†éš§é“çš„ AsyncTunnelHTTPConnection å®ä¾‹ï¼Œè€Œéæ™®é€šçš„ç›´æ¥è¿æ¥ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">    def create_connection(self, origin: Origin) -&gt; AsyncConnectionInterface:
        if <span class="hljs-attr">origin.scheme</span> == b<span class="hljs-string">"http"</span>:
            return AsyncForwardHTTPConnection(
                <span class="hljs-attr">proxy_origin</span>=self._proxy_url.origin,
                <span class="hljs-attr">proxy_headers</span>=self._proxy_headers,
                <span class="hljs-attr">remote_origin</span>=origin,
                <span class="hljs-attr">keepalive_expiry</span>=self._keepalive_expiry,
                <span class="hljs-attr">network_backend</span>=self._network_backend,
                <span class="hljs-attr">proxy_ssl_context</span>=self._proxy_ssl_context,
            )
        return AsyncTunnelHTTPConnection(
            <span class="hljs-attr">proxy_origin</span>=self._proxy_url.origin,
            <span class="hljs-attr">proxy_headers</span>=self._proxy_headers,
            <span class="hljs-attr">remote_origin</span>=origin,
            <span class="hljs-attr">ssl_context</span>=self._ssl_context,
            <span class="hljs-attr">proxy_ssl_context</span>=self._proxy_ssl_context,
            <span class="hljs-attr">keepalive_expiry</span>=self._keepalive_expiry,
            <span class="hljs-attr">http1</span>=self._http1,
            <span class="hljs-attr">http2</span>=self._http2,
            <span class="hljs-attr">network_backend</span>=self._network_backend,
        )
</code></pre>
<p>å¯¹äº HTTPS è¯·æ±‚ï¼Œcreate_connection è¿”å› AsyncTunnelHTTPConnection å®ä¾‹ã€‚æ­¤æ—¶ä»…å®Œæˆå¯¹è±¡å®ä¾‹åŒ–ï¼Œå®é™…çš„ TCP è¿æ¥å’Œ TLS æ¡æ‰‹å°šæœªè¿›è¡Œã€‚</p>
<p><strong>å»ºç«‹éš§é“</strong></p>
<p>å›åˆ° AsyncConnectionPool.handle_async_request çš„ä¸»å¾ªç¯ã€‚_assign_requests_to_connections åˆ›å»ºå¹¶åˆ†é…è¿æ¥åï¼Œä»£ç ç­‰å¾…è¿æ¥å°±ç»ªï¼Œç„¶åè¿›å…¥ try å—æ‰§è¡Œå®é™…è¯·æ±‚ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncConnectionPool.handle_async_request</span>
...
                <span class="hljs-attr">connection</span> = await pool_request.wait_for_connection(timeout=timeout)

                try:
                    <span class="hljs-comment"># Send the request on the assigned connection.</span>
                    <span class="hljs-attr">response</span> = await connection.handle_async_request(
                        pool_request.request
                    )
                except ConnectionNotAvailable:
                    <span class="hljs-comment"># In some cases a connection may initially be available to</span>
                    <span class="hljs-comment"># handle a request, but then become unavailable.</span>
                    <span class="hljs-comment">#</span>
                    <span class="hljs-comment"># In this case we clear the connection and try again.</span>
                    pool_request.clear_connection()
                else:
                    break  <span class="hljs-comment"># pragma: nocover</span>
...
</code></pre>
<p>è¿™é‡Œçš„ connection å³ä¸Šä¸€æ­¥åˆ›å»ºçš„ AsyncTunnelHTTPConnection å®ä¾‹ã€‚connection.handle_async_request è¿›å…¥äºŒçº§é€»è¾‘ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncConnectionPool.handle_async_request</span>
...
                    <span class="hljs-comment"># Assign incoming requests to available connections,</span>
                    <span class="hljs-comment"># closing or creating new connections as required.                    </span>
                    closing = self._assign_requests_to_connections()
                <span class="hljs-keyword">await</span> self._close_connections(closing)
...
</code></pre>
<p>_assign_requests_to_connections è¿”å›çš„ closing åˆ—è¡¨ä¸ºç©ºâ€”â€”é¦–æ¬¡åˆ›å»ºè¿æ¥æ—¶å°šæ— è¿‡æœŸè¿æ¥éœ€è¦æ¸…ç†ã€‚éšåè¯·æ±‚è¢«åˆ†å‘ç»™ AsyncTunnelHTTPConnection å®ä¾‹ï¼Œè¿›å…¥å…¶ handle_async_request æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncConnectionPool.handle_async_request</span>
...
                <span class="hljs-comment"># Wait until this request has an assigned connection.</span>
                <span class="hljs-attr">connection</span> = await pool_request.wait_for_connection(timeout=timeout)

                try:
                    <span class="hljs-comment"># Send the request on the assigned connection.</span>
                    <span class="hljs-attr">response</span> = await connection.handle_async_request(
                        pool_request.request
                    )
...
</code></pre>
<p>connection.handle_async_request å³ AsyncTunnelHTTPConnection.handle_async_requestã€‚è¯¥æ–¹æ³•é¦–å…ˆæ£€æŸ¥ self._connected æ ‡å¿—ï¼šå¯¹äºæ–°è¿æ¥ï¼Œä¼šæ„é€  HTTP CONNECT è¯·æ±‚å‘é€è‡³ä»£ç†æœåŠ¡å™¨ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
        async with self._connect_lock:
            if not self._connected:
                <span class="hljs-attr">target</span> = b<span class="hljs-string">"%b:%d"</span> % (self._remote_origin.host, self._remote_origin.port)

                <span class="hljs-attr">connect_url</span> = URL(
                    <span class="hljs-attr">scheme</span>=self._proxy_origin.scheme,
                    <span class="hljs-attr">host</span>=self._proxy_origin.host,
                    <span class="hljs-attr">port</span>=self._proxy_origin.port,
                    <span class="hljs-attr">target</span>=target,
                )
                <span class="hljs-attr">connect_headers</span> = merge_headers(
                    <span class="hljs-section">[(b"Host", target), (b"Accept", b"*/*")]</span>, self._proxy_headers
                )
                <span class="hljs-attr">connect_request</span> = Request(
                    <span class="hljs-attr">method</span>=b<span class="hljs-string">"CONNECT"</span>,
                    <span class="hljs-attr">url</span>=connect_url,
                    <span class="hljs-attr">headers</span>=connect_headers,
                    <span class="hljs-attr">extensions</span>=request.extensions,
                )
                <span class="hljs-attr">connect_response</span> = await self._connection.handle_async_request(
                    connect_request
                )
...
</code></pre>
<p>CONNECT è¯·æ±‚é€šè¿‡ self._connection.handle_async_request() å‘é€ã€‚è¿™é‡Œçš„ self._connection åœ¨AsyncTunnelHTTPConnection çš„ _<em>init_</em> ä¸­åˆå§‹åŒ–ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncTunnelHTTPConnection.__init__</span>
...
        self._connection: <span class="hljs-attr">AsyncConnectionInterface</span> = AsyncHTTPConnection(
            <span class="hljs-attr">origin</span>=proxy_origin,
            <span class="hljs-attr">keepalive_expiry</span>=keepalive_expiry,
            <span class="hljs-attr">network_backend</span>=network_backend,
            <span class="hljs-attr">socket_options</span>=socket_options,
            <span class="hljs-attr">ssl_context</span>=proxy_ssl_context,
        )
...
</code></pre>
<p>self._connection æ˜¯ AsyncHTTPConnection å®ä¾‹ï¼ˆä½äº connection.pyï¼‰ã€‚å½“è°ƒç”¨å…¶ handle_async_request å‘é€ CONNECT è¯·æ±‚æ—¶ï¼Œå†…éƒ¨å®é™…ç»å†äº†ä¸¤ä¸ªå±‚æ¬¡çš„è°ƒç”¨ï¼š</p>
<p><em><strong>ç¬¬ä¸€å±‚ï¼šå»¶è¿Ÿè¿æ¥å»ºç«‹</strong></em></p>
<p>AsyncHTTPConnection.handle_async_request é¦–å…ˆæ£€æŸ¥æ˜¯å¦å·²å»ºç«‹åº•å±‚è¿æ¥ã€‚è‹¥æœªå»ºç«‹ï¼Œåˆ™å…ˆæ‰§è¡Œ _connect()ï¼Œç„¶åæ ¹æ®åå•†ç»“æœåˆ›å»ºå®é™…çš„åè®®å¤„ç†å®ä¾‹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncHTTPConnection.handle_async_request</span>
...
            async with self._request_lock:
                if self._connection is None:
                    <span class="hljs-attr">stream</span> = await self._connect(request)

                    <span class="hljs-attr">ssl_object</span> = stream.get_extra_info(<span class="hljs-string">"ssl_object"</span>)
                    <span class="hljs-attr">http2_negotiated</span> = (
                        ssl_object is not None
                        and ssl_object.selected_alpn_protocol() == "h2"
                    )
                    if http2_negotiated or (self._http2 and not self._http1):
                        from .http2 import AsyncHTTP2Connection

                        <span class="hljs-attr">self._connection</span> = AsyncHTTP2Connection(
                            <span class="hljs-attr">origin</span>=self._origin,
                            <span class="hljs-attr">stream</span>=stream,
                            <span class="hljs-attr">keepalive_expiry</span>=self._keepalive_expiry,
                        )
                    else:
                        <span class="hljs-attr">self._connection</span> = AsyncHTTP11Connection(
                            <span class="hljs-attr">origin</span>=self._origin,
                            <span class="hljs-attr">stream</span>=stream,
                            <span class="hljs-attr">keepalive_expiry</span>=self._keepalive_expiry,
                        )
...
</code></pre>
<p>æ³¨æ„æ­¤ self._connection è¢«èµ‹å€¼ä¸º AsyncHTTP11Connectionï¼ˆæˆ– HTTP/2ï¼‰å®ä¾‹ã€‚</p>
<p><em><strong>ç¬¬äºŒå±‚ï¼šåè®®å¤„ç†ä¸çŠ¶æ€è½¬æ¢</strong></em></p>
<p>éšåï¼ŒAsyncHTTPConnection å°†è¯·æ±‚å§”æ‰˜ç»™æ–°åˆ›å»ºçš„ AsyncHTTP11Connection å®ä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncHTTPConnection.handle_async_request</span>
...
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self._connection.handle_async_request(request)
...
</code></pre>
<p>åœ¨ AsyncHTTP11Connection å†…éƒ¨ï¼Œæ„é€ å‡½æ•°åˆå§‹åŒ– self._state = HTTPConnectionState.NEWã€‚è€Œåœ¨ handle_async_request æ–¹æ³•ä¸­ï¼ŒçŠ¶æ€è¢«è½¬æ¢ä¸º ACTIVEâ€”â€”è¿™æ­£æ˜¯åç»­é—®é¢˜çš„æ ¸å¿ƒï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncHTTP11Connection.handle_async_request</span>
...
        <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self._state_lock:
            <span class="hljs-keyword">if</span> self._state <span class="hljs-keyword">in</span> (HTTPConnectionState.NEW, HTTPConnectionState.IDLE):
                self._request_count += <span class="hljs-number">1</span>
                self._state = HTTPConnectionState.ACTIVE
                self._expire_at = <span class="hljs-literal">None</span>
            <span class="hljs-keyword">else</span>:
                <span class="hljs-keyword">raise</span> ConnectionNotAvailable()
...
</code></pre>
<p>åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œè¯·æ±‚å¤´å’Œå“åº”å¤´å¤„ç†å®Œæˆåï¼Œhandle_async_request è¿”å› Responseã€‚æ³¨æ„ content å‚æ•°æ˜¯ HTTP11ConnectionByteStream(self, request)ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncHTTP11Connection.handle_async_request</span>
...
            return Response(
                <span class="hljs-attr">status</span>=status,
                <span class="hljs-attr">headers</span>=headers,
                <span class="hljs-attr">content</span>=HTTP11ConnectionByteStream(self, request),
                <span class="hljs-attr">extensions</span>={
                    "http_version": http_version,
                    "reason_phrase": reason_phrase,
                    "network_stream": network_stream,
                },
            )
...
</code></pre>
<p>è¿™é‡Œé‡‡ç”¨äº†å»¶è¿Ÿæ¸…ç†è®¾è®¡ï¼šå“åº”å¤´è¿”å›æ—¶è¿æ¥çŠ¶æ€ä»ä¸º ACTIVEï¼›å“åº”ä½“çš„è¯»å–å’ŒçŠ¶æ€è½®è½¬ï¼ˆè½¬ä¸º IDLEï¼‰è¢«æ¨è¿Ÿåˆ° HTTP11ConnectionByteStream.aclose()è¢«è°ƒç”¨æ—¶æ‰§è¡Œã€‚</p>
<p>è‡³æ­¤ï¼ŒResponse ä»¥ ACTIVE çŠ¶æ€é€å±‚è¿”å›ã€‚httpcore ä¸­æ‰€æœ‰è¿æ¥ç±»çš„ handle_async_request å‡è¿”å› Responseï¼Œè¿™æ˜¯å…¶<strong>ç»Ÿä¸€æ¥å£è®¾è®¡</strong>ã€‚</p>
<p>è¿”å›åˆ° AsyncTunnelHTTPConnection.handle_async_requestï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
                <span class="hljs-attr">connect_response</span> = await self._connection.handle_async_request(
                    connect_request
                )
...
</code></pre>
<p>æ¥ä¸‹æ¥æ£€æŸ¥ CONNECT å“åº”çŠ¶æ€ã€‚è‹¥è¿”å›é 2xx çŠ¶æ€ç ï¼Œæ­¤å¤„æ­£ç¡®è°ƒç”¨äº† aclose() è¿›è¡Œæ¸…ç†ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
                if connect_response.status &lt; 200 or connect_response.status &gt; 299:
                    <span class="hljs-attr">reason_bytes</span> = connect_response.extensions.get(<span class="hljs-string">"reason_phrase"</span>, b<span class="hljs-string">""</span>)
                    <span class="hljs-attr">reason_str</span> = reason_bytes.decode(<span class="hljs-string">"ascii"</span>, errors=<span class="hljs-string">"ignore"</span>)
                    <span class="hljs-attr">msg</span> = <span class="hljs-string">"%d %s"</span> % (connect_response.status, reason_str)
                    await self._connection.aclose()
                    raise ProxyError(msg)

                <span class="hljs-attr">stream</span> = connect_response.extensions[<span class="hljs-string">"network_stream"</span>]
...
</code></pre>
<p>è‹¥ CONNECT æˆåŠŸï¼ˆ200ï¼‰ï¼Œåˆ™ä»å“åº”æ‰©å±•ä¸­æå–åŸå§‹ç½‘ç»œæµï¼Œå¹¶å‡†å¤‡åç»­ TLS æ¡æ‰‹çš„å‚æ•°ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯é—®é¢˜å‘ç”Ÿçš„æ ¸å¿ƒä½ç½®ã€‚åŸå§‹ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
                <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> <span class="hljs-title">Trace</span>(<span class="hljs-params"><span class="hljs-string">"start_tls"</span>, logger, request, kwargs</span>) <span class="hljs-keyword">as</span> trace:
                    stream</span> = <span class="hljs-keyword">await</span> stream.start_tls(**kwargs)
                    trace.return_value = stream
...
</code></pre>
<p>è¿™é‡Œçš„ stream.start_tls() è´Ÿè´£ä¸ç›®æ ‡æœåŠ¡å™¨å»ºç«‹ TLS åŠ å¯†é€šé“ã€‚</p>
<p><strong>å…³äº stream çš„å…·ä½“æ¥æºï¼Œéœ€è¦è¿½æº¯åˆ°å¤šå±‚è°ƒç”¨ä¹‹å‰ã€‚</strong></p>
<hr/>
<p>stream æ¥è‡ª connect_response.extensions["network_stream"]ã€‚åœ¨ CONNECT è¯·æ±‚å¤„ç†æµç¨‹ä¸­ï¼Œè¿™ä¸ªå€¼ç”± AsyncHTTP11Connection åœ¨è¿”å› Response æ—¶è®¾ç½®ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncHTTP11Connection.handle_async_request</span>
...
            return Response(
                <span class="hljs-attr">status</span>=status,
                <span class="hljs-attr">headers</span>=headers,
                <span class="hljs-attr">content</span>=HTTP11ConnectionByteStream(self, request),
                <span class="hljs-attr">extensions</span>={
                    "http_version": http_version,
                    "reason_phrase": reason_phrase,
                    "network_stream": network_stream,
                },
            )
...
</code></pre>
<p>å…·ä½“æ¥è¯´ï¼Œå½“ AsyncHTTP11Connection.handle_async_request() å¤„ç†å®Œ CONNECT è¯·æ±‚åï¼Œä¼šå°†åº•å±‚çš„ _network_stream åŒ…è£…ä¸º AsyncHTTP11UpgradeStream æ”¾å…¥å“åº”çš„ extensions ä¸­ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncHTTP11Connection.handle_async_request</span>
...
            <span class="hljs-attr">network_stream</span> = self._network_stream

            <span class="hljs-comment"># CONNECT or Upgrade request</span>
            if (<span class="hljs-attr">status</span> == <span class="hljs-number">101</span>) or (
                (<span class="hljs-attr">request.method</span> == b<span class="hljs-string">"CONNECT"</span>) and (<span class="hljs-number">200</span> &lt;= status &lt; <span class="hljs-number">300</span>)
            ):
                <span class="hljs-attr">network_stream</span> = AsyncHTTP11UpgradeStream(network_stream, trailing_data)
...
</code></pre>
<p>è¿™é‡Œçš„ self._network_stream æ¥è‡ª AsyncHTTP11Connection çš„æ„é€ å‡½æ•°ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncHTTP11Connection.__init__</span>
...
        <span class="hljs-attr">self._network_stream</span> = stream
...
</code></pre>
<p>è€Œè¿™ä¸ª stream åˆæ˜¯ç”± AsyncHTTPConnection åœ¨åˆ›å»º AsyncHTTP11Connection æ—¶ä¼ å…¥çš„ã€‚</p>
<p>è¯¥è¿‡ç¨‹å‘ç”Ÿåœ¨ AsyncHTTPConnection.handle_async_request ä¸­ã€‚_connect() æ–¹æ³•åˆ›å»ºåŸå§‹ç½‘ç»œæµï¼Œéšåæ ¹æ® ALPN åå•†ç»“æœå†³å®šä½¿ç”¨ HTTP/1.1 è¿˜æ˜¯ HTTP/2ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncHTTPConnection.handle_async_request</span>
...
            async with self._request_lock:
                if self._connection is None:
                    <span class="hljs-attr">stream</span> = await self._connect(request)

                    <span class="hljs-attr">ssl_object</span> = stream.get_extra_info(<span class="hljs-string">"ssl_object"</span>)
                    <span class="hljs-attr">http2_negotiated</span> = (
                        ssl_object is not None
                        and ssl_object.selected_alpn_protocol() == "h2"
                    )
                    if http2_negotiated or (self._http2 and not self._http1):
                        from .http2 import AsyncHTTP2Connection

                        <span class="hljs-attr">self._connection</span> = AsyncHTTP2Connection(
                            <span class="hljs-attr">origin</span>=self._origin,
                            <span class="hljs-attr">stream</span>=stream,
                            <span class="hljs-attr">keepalive_expiry</span>=self._keepalive_expiry,
                        )
                    else:
                        <span class="hljs-attr">self._connection</span> = AsyncHTTP11Connection(
                            <span class="hljs-attr">origin</span>=self._origin,
                            <span class="hljs-attr">stream</span>=stream,
                            <span class="hljs-attr">keepalive_expiry</span>=self._keepalive_expiry,
                        )
...
</code></pre>
<p><em><strong>Fine</strong></em></p>
<p>AsyncHTTPConnection åˆ›å»º AsyncHTTP11Connection æ—¶ä¼ å…¥çš„ stream æ¥è‡ª self._connect() æ–¹æ³•ã€‚è¯¥æ–¹æ³•é€šè¿‡ self._network_backend.connect_tcp() åˆ›å»ºåŸå§‹ TCP è¿æ¥ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta">#  AsyncHTTPConnection._connect</span>
...
                        stream = <span class="hljs-keyword">await</span> self._network_backend.connect_tcp(**kwargs)
...
                    <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> <span class="hljs-title">Trace</span>(<span class="hljs-params"><span class="hljs-string">"start_tls"</span>, logger, request, kwargs</span>) <span class="hljs-keyword">as</span> trace:
                        stream</span> = <span class="hljs-keyword">await</span> stream.start_tls(**kwargs)
                        trace.return_value = stream
                <span class="hljs-keyword">return</span> stream
...
</code></pre>
<p>æ³¨æ„ï¼šå¦‚æœä»£ç†åè®®æ˜¯ HTTPSï¼Œ_connect() å†…éƒ¨ä¼šå…ˆå®Œæˆä¸ä»£ç†çš„ TLS æ¡æ‰‹ï¼ˆç¬¬ä¸€æ®µ start_tlsï¼‰ï¼Œå†è¿”å›å·²åŠ å¯†çš„æµã€‚</p>
<p>self._network_backend åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼Œé»˜è®¤ä¸º AutoBackendï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncHTTPConnection.__init__</span>
...
        self._network_backend: AsyncNetworkBackend = (
            AutoBackend() <span class="hljs-keyword">if</span> network_backend <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> network_backend
        )
...
</code></pre>
<p>AutoBackend æ˜¯ä¸€ä¸ªé€‚é…å™¨ï¼Œæ ¹æ®è¿è¡Œæ—¶ç¯å¢ƒè‡ªåŠ¨é€‰æ‹©å…·ä½“åç«¯ï¼ˆå¦‚ AnyIO æˆ– Trioï¼‰ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AutoBackend.connect_tcp</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">connect_tcp</span>(<span class="hljs-params">
        self,
        host: <span class="hljs-built_in">str</span>,
        port: <span class="hljs-built_in">int</span>,
        timeout: <span class="hljs-built_in">float</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
        local_address: <span class="hljs-built_in">str</span> | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
        socket_options: typing.Iterable[SOCKET_OPTION] | <span class="hljs-literal">None</span> = <span class="hljs-literal">None</span>,
    </span>) -&gt; AsyncNetworkStream:
        <span class="hljs-keyword">await</span> self._init_backend()
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self._backend.connect_tcp(
            host,
            port,
            timeout=timeout,
            local_address=local_address,
            socket_options=socket_options,
        )
</code></pre>
<p>å®é™…çš„ç½‘ç»œ I/O ç”± _backendï¼ˆå¦‚ AnyIOBackendï¼‰å®Œæˆã€‚</p>
<p>_init_backend æ–¹æ³•æ£€æµ‹å½“å‰è¿è¡Œçš„å¼‚æ­¥åº“ç¯å¢ƒï¼Œé»˜è®¤åŠ è½½ AnyIOBackendï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AutoBackend._init_backend</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">_init_backend</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (<span class="hljs-built_in">hasattr</span>(self, <span class="hljs-string">"_backend"</span>)):
            backend = current_async_library()
            <span class="hljs-keyword">if</span> backend == <span class="hljs-string">"trio"</span>:
                <span class="hljs-keyword">from</span> .trio <span class="hljs-keyword">import</span> TrioBackend

                self._backend: AsyncNetworkBackend = TrioBackend()
            <span class="hljs-keyword">else</span>:
                <span class="hljs-keyword">from</span> .anyio <span class="hljs-keyword">import</span> AnyIOBackend

                self._backend = AnyIOBackend()
</code></pre>
<p>å› æ­¤ï¼ŒAutoBackend.connect_tcp() çš„å®é™…è¿”å›å€¼ç”± AnyIOBackend.connect_tcp() æä¾›ã€‚</p>
<p>AnyIOBackend.connect_tcp() æœ€ç»ˆè¿”å› AnyIOStream å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#  AnyIOBackend.connect_tcp</span>
...
        <span class="hljs-built_in">return</span> AnyIOStream(stream)
...
</code></pre>
<p>è¯¥å¯¹è±¡è¢«å±‚å±‚ä¼ é€’ï¼Œæœ€ç»ˆå›åˆ° AsyncHTTPConnection._connect() æ–¹æ³•ä¸­ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncHTTPConnection._connect</span>
...
                        stream = <span class="hljs-keyword">await</span> self._network_backend.connect_tcp(**kwargs)
...
                <span class="hljs-keyword">if</span> self._origin.scheme <span class="hljs-keyword">in</span> (<span class="hljs-string">b"https"</span>, <span class="hljs-string">b"wss"</span>):
...
                    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> Trace(<span class="hljs-string">"start_tls"</span>, logger, request, kwargs) <span class="hljs-keyword">as</span> trace:
                        stream = <span class="hljs-keyword">await</span> stream.start_tls(**kwargs)
                        trace.return_value = stream
                <span class="hljs-keyword">return</span> stream
...
</code></pre>
<p>æ­¤å¤„éœ€æ³¨æ„ï¼šè‹¥ä»£ç†ä½¿ç”¨ HTTPS åè®®ï¼Œ_connect() ä¼šå…ˆæ‰§è¡Œ start_tls() ä¸ä»£ç†å»ºç«‹ TLS åŠ å¯†é€šé“ï¼ˆè€Œéä¸ç›®æ ‡æœåŠ¡å™¨ï¼‰ã€‚è°ƒç”¨ AnyIOStream.start_tls() åè¿”å›çš„å·²æ˜¯ TLS åŒ…è£…åçš„æµã€‚è‹¥æ˜¯ HTTP ä»£ç†ï¼Œåˆ™ç›´æ¥è¿”å›æœªåŠ å¯†çš„åŸå§‹æµã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒAnyIOStream.start_tls() åœ¨å¼‚å¸¸æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ self.aclose() å…³é—­åº•å±‚ socketã€‚ï¼ˆå‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fencode%2Fhttpcore%2Fpull%2F475" target="_blank" title="https://github.com/encode/httpcore/pull/475" ref="nofollow noopener noreferrer">github.com/encode/httpâ€¦</a>ï¼Œrespectï¼‰</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AnyIOStream.start_tls</span>
...
            try:
                with anyio.fail_after(timeout):
                    <span class="hljs-attr">ssl_stream</span> = await anyio.streams.tls.TLSStream.wrap(
                        self._stream,
                        <span class="hljs-attr">ssl_context</span>=ssl_context,
                        <span class="hljs-attr">hostname</span>=server_hostname,
                        <span class="hljs-attr">standard_compatible</span>=<span class="hljs-literal">False</span>,
                        <span class="hljs-attr">server_side</span>=<span class="hljs-literal">False</span>,
                    )
            except Exception as exc:  <span class="hljs-comment"># pragma: nocover</span>
                await self.aclose()
                raise exc
        return AnyIOStream(ssl_stream)
...
</code></pre>
<p>éšå AnyIOStream è¿”å›è‡³ AsyncHTTPConnection.handle_async_requestï¼Œæœ€ç»ˆä½œä¸º stream å‚æ•°ä¼ é€’ç»™ AsyncHTTP11Connection çš„æ„é€ å‡½æ•°ã€‚</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncHTTPConnection.handle_async_request</span>
...
            async with self._request_lock:
                if self._connection is None:
                    <span class="hljs-attr">stream</span> = await self._connect(request)  <span class="hljs-comment">#  è¿™é‡Œ</span>

                    <span class="hljs-attr">ssl_object</span> = stream.get_extra_info(<span class="hljs-string">"ssl_object"</span>)
                    <span class="hljs-attr">http2_negotiated</span> = (
                        ssl_object is not None
                        and ssl_object.selected_alpn_protocol() == "h2"
                    )
                    if http2_negotiated or (self._http2 and not self._http1):
                        from .http2 import AsyncHTTP2Connection

                        <span class="hljs-attr">self._connection</span> = AsyncHTTP2Connection(
                            <span class="hljs-attr">origin</span>=self._origin,
                            <span class="hljs-attr">stream</span>=stream,
                            <span class="hljs-attr">keepalive_expiry</span>=self._keepalive_expiry,
                        )
                    else:
                        <span class="hljs-attr">self._connection</span> = AsyncHTTP11Connection(
                            <span class="hljs-attr">origin</span>=self._origin,
                            <span class="hljs-attr">stream</span>=stream,
                            <span class="hljs-attr">keepalive_expiry</span>=self._keepalive_expiry,
                        )
...
</code></pre>
<p><em><strong>D.C. al Fine</strong></em></p>
<hr/>
<p>æ¢³ç†å®Œ stream çš„å®Œæ•´æ¥æºåï¼Œæˆ‘ä»¬å›åˆ°é—®é¢˜çš„æ ¸å¿ƒä½ç½®ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
                <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> <span class="hljs-title">Trace</span>(<span class="hljs-params"><span class="hljs-string">"start_tls"</span>, logger, request, kwargs</span>) <span class="hljs-keyword">as</span> trace:
                    stream</span> = <span class="hljs-keyword">await</span> stream.start_tls(**kwargs)
                    trace.return_value = stream
...
</code></pre>
<p>æ­¤æ—¶ï¼Œæœ¬åœ°åˆ°ä»£ç†çš„ TCP è¿æ¥å·²å»ºç«‹ï¼ŒCONNECT è¯·æ±‚å·²æˆåŠŸè¿”å› 200ã€‚stream.start_tls() è´Ÿè´£ä¸ç›®æ ‡æœåŠ¡å™¨å»ºç«‹ TLS åŠ å¯†é€šé“ã€‚è¿™é‡Œçš„ stream å³å‰æ–‡è¿½æº¯çš„ AnyIOStream å¯¹è±¡ï¼Œå…¶ start_tls() æ–¹æ³•åœ¨å¼‚å¸¸æ—¶ä¼šè°ƒç”¨ self.aclose() å…³é—­åº•å±‚ socketâ€”â€”<strong>ä½†è¿™ä»…åœç•™åœ¨ä¼ è¾“å±‚çš„æ¸…ç†</strong>ã€‚</p>
<p>å¼‚å¸¸æ•è·è¾¹ç•Œçš„ç»“æ„æ€§é”™ä½</p>
<p>åœ¨æ­£å¸¸çš„è¯·æ±‚å¤„ç†æµç¨‹ä¸­ï¼Œhttpcore å»ºç«‹äº†å¤šå±‚æ¬¡çš„å¼‚å¸¸é˜²æŠ¤ã€‚AsyncHTTP11Connection.handle_async_request é€šè¿‡å¤–å±‚ try-except å—ç¡®ä¿ï¼šæ— è®ºè¯·æ±‚å‘é€è¿˜æ˜¯å“åº”å¤´æ¥æ”¶é˜¶æ®µå‘ç”Ÿç½‘ç»œå¼‚å¸¸ï¼Œéƒ½ä¼šè°ƒç”¨ _response_closed() å°† _state ä» ACTIVE æ¸…ç†ä¸º CLOSED æˆ– IDLEã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncHTTP11Connection.handle_async_request</span>
...
        <span class="hljs-keyword">except</span> BaseException <span class="hljs-keyword">as</span> exc:
            <span class="hljs-keyword">with</span> AsyncShieldCancellation():
                <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> Trace(<span class="hljs-string">"response_closed"</span>, logger, request) <span class="hljs-keyword">as</span> trace:
                    <span class="hljs-keyword">await</span> self._response_closed()
            <span class="hljs-keyword">raise</span> exc
...
</code></pre>
<p>AsyncHTTPConnection åŒæ ·è®¾æœ‰ä¿æŠ¤ï¼Œä½†å…¶èŒƒå›´ä»…è¦†ç›–åˆ° TCP è¿æ¥å»ºç«‹å’Œ CONNECT è¯·æ±‚è¿”å›ä¸ºæ­¢ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncHTTPConnection.handle_async_request</span>
...
        <span class="hljs-keyword">except</span> BaseException <span class="hljs-keyword">as</span> exc:
            self._connect_failed = <span class="hljs-literal">True</span>
            <span class="hljs-keyword">raise</span> exc
...
</code></pre>
<p>ç„¶è€Œï¼Œåœ¨AsyncTunnelHTTPConnection.handle_async_requestçš„ä»£ç†éš§é“å»ºç«‹æµç¨‹ä¸­ï¼Œ<strong>æ§åˆ¶æµå‘ç”Ÿäº†ç»“æ„æ€§æ–­è£‚</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
                <span class="hljs-attr">connect_response</span> = await self._connection.handle_async_request(
                    connect_request
                )
...
</code></pre>
<p>æ­¤æ—¶ AsyncHTTP11Connection._state å·²è¢«è®¾ä¸º ACTIVEã€‚è‹¥ CONNECT è¯·æ±‚è¢«æ‹’ç»ï¼ˆå¦‚ 407 è®¤è¯å¤±è´¥ï¼‰ï¼Œä»£ç ä¼šæ­£ç¡®è°ƒç”¨ aclose() è¿›è¡Œæ¸…ç†ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
                if connect_response.status &lt; 200 or connect_response.status &gt; 299:
                    <span class="hljs-attr">reason_bytes</span> = connect_response.extensions.get(<span class="hljs-string">"reason_phrase"</span>, b<span class="hljs-string">""</span>)
                    <span class="hljs-attr">reason_str</span> = reason_bytes.decode(<span class="hljs-string">"ascii"</span>, errors=<span class="hljs-string">"ignore"</span>)
                    <span class="hljs-attr">msg</span> = <span class="hljs-string">"%d %s"</span> % (connect_response.status, reason_str)
                    await self._connection.aclose()
                    raise ProxyError(msg)
...
</code></pre>
<p>ä½†å¦‚æœ CONNECT æˆåŠŸè¿”å› 200ï¼Œè€Œåç»­çš„ TLS æ¡æ‰‹å¤±è´¥ï¼Œåˆ™æ²¡æœ‰å¯¹åº”çš„å¼‚å¸¸å¤„ç†è·¯å¾„ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
                <span class="hljs-function"><span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> <span class="hljs-title">Trace</span>(<span class="hljs-params"><span class="hljs-string">"start_tls"</span>, logger, request, kwargs</span>) <span class="hljs-keyword">as</span> trace:
                    stream</span> = <span class="hljs-keyword">await</span> stream.start_tls(**kwargs)
                    trace.return_value = stream
...
</code></pre>
<p>å¦‚å‰æ–‡æ‰€è¿°ï¼Œstream æ˜¯ AnyIOStream å¯¹è±¡ã€‚è°ƒç”¨ stream.start_tls() æ—¶ï¼Œè‹¥å‘ç”Ÿå¼‚å¸¸ï¼ŒAnyIOStream.start_tls() ä¼šå…³é—­åº•å±‚ socketã€‚ä½†è¿™ä»…åœç•™åœ¨ç½‘ç»œå±‚çš„æ¸…ç†â€”â€”ä¸Šå±‚çš„ AsyncHTTP11Connection å¯¹æ­¤æ— æ„ŸçŸ¥ï¼Œå…¶ _state ä»ä¿æŒ ACTIVEï¼›åŒæ—¶ AsyncTunnelHTTPConnection ä¹Ÿæœªæ•è·è¯¥å¼‚å¸¸æ¥è§¦å‘ self._connection.aclose()ã€‚</p>
<p>è¿™å¯¼è‡´ HTTP å±‚è¿æ¥çŠ¶æ€ä¸ç½‘ç»œå±‚å®é™…çŠ¶æ€æ°¸ä¹…è„±èŠ‚ï¼šTLS æ¡æ‰‹å¤±è´¥æ—¶ï¼Œå¼‚å¸¸ç›´æ¥å‘ä¸Šä¼ æ’­ï¼Œæ²¡æœ‰ä»»ä½•ä»£ç è·¯å¾„å°† _state ä» ACTIVE è½¬ä¸º CLOSEDï¼Œæœ€ç»ˆå½¢æˆzombie connectã€‚</p>
<p><strong>å¼‚å¸¸ç»§ç»­å‘ä¸Šä¼ æ’­?æœ€ç»ˆåˆ°è¾¾è°ƒç”¨é“¾é¡¶ç«¯çš„ Connection Pool</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncConnectionPool.handle_async_request</span>
...
                <span class="hljs-keyword">try</span>:
                    <span class="hljs-comment"># Send the request on the assigned connection.</span>
                    response = <span class="hljs-keyword">await</span> connection.handle_async_request(
                        pool_request.request
                    )
                <span class="hljs-keyword">except</span> ConnectionNotAvailable:
                    <span class="hljs-comment"># In some cases a connection may initially be available to</span>
                    <span class="hljs-comment"># handle a request, but then become unavailable.</span>
                    <span class="hljs-comment">#</span>
                    <span class="hljs-comment"># In this case we clear the connection and try again.</span>
                    pool_request.clear_connection()
                <span class="hljs-keyword">else</span>:
                    <span class="hljs-keyword">break</span>  <span class="hljs-comment"># pragma: nocover</span>
...
</code></pre>
<p>æ­¤å¤„åªæ•è· ConnectionNotAvailable å¼‚å¸¸è¿›è¡Œé‡è¯•ã€‚TLS æ¡æ‰‹å¤±è´¥æŠ›å‡ºçš„å¼‚å¸¸æœªè¢«æ•è·ï¼Œç»§ç»­å‘ä¸Šä¼ æ’­ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncConnectionPool.handle_async_request</span>
...
        <span class="hljs-keyword">except</span> BaseException <span class="hljs-keyword">as</span> exc:
            <span class="hljs-keyword">with</span> self._optional_thread_lock:
                <span class="hljs-comment"># For any exception or cancellation we remove the request from</span>
                <span class="hljs-comment"># the queue, and then re-assign requests to connections.</span>
                self._requests.remove(pool_request)
                closing = self._assign_requests_to_connections()

            <span class="hljs-keyword">await</span> self._close_connections(closing)
            <span class="hljs-keyword">raise</span> exc <span class="hljs-keyword">from</span> <span class="hljs-literal">None</span>
...
</code></pre>
<p>æ­¤å¤„ _assign_requests_to_connections() ä¼šéå†è¿æ¥æ± ï¼Œå†³å®šå“ªäº›è¿æ¥éœ€è¦å…³é—­ã€‚å®ƒä¼šæ£€æŸ¥ connection.is_closed() å’Œ connection.has_expired()ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncConnectionPool._assign_requests_to_connections</span>
...
        <span class="hljs-comment"># First we handle cleaning up any connections that are closed,</span>
        <span class="hljs-comment"># have expired their keep-alive, or surplus idle connections.</span>
        <span class="hljs-keyword">for</span> connection <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(self._connections):
            <span class="hljs-keyword">if</span> connection.is_closed():
                <span class="hljs-comment"># log: "removing closed connection"</span>
                self._connections.remove(connection)
            <span class="hljs-keyword">elif</span> connection.has_expired():
                <span class="hljs-comment"># log: "closing expired connection"</span>
                self._connections.remove(connection)
                closing_connections.append(connection)
            <span class="hljs-keyword">elif</span> (
                connection.is_idle()
                <span class="hljs-keyword">and</span> <span class="hljs-built_in">sum</span>(connection.is_idle() <span class="hljs-keyword">for</span> connection <span class="hljs-keyword">in</span> self._connections)
                &gt; self._max_keepalive_connections
            ):
                <span class="hljs-comment"># log: "closing idle connection"</span>
                self._connections.remove(connection)
                closing_connections.append(connection)
...
</code></pre>
<p>è¿™é‡Œçš„ connection å³å‰æ–‡çš„ AsyncTunnelHTTPConnection å®ä¾‹ã€‚è¿™äº›æ–¹æ³•ç»è¿‡å±‚å±‚ä»£ç†ï¼šAsyncTunnelHTTPConnection â†’ AsyncHTTPConnection â†’ AsyncHTTP11Connectionã€‚</p>
<ul>
<li>
<p>is_closed() â†’ Falseï¼ˆ_state == ACTIVEï¼‰</p>
</li>
<li>
<p>has_expired() â†’ Falseï¼ˆä»…å½“ _state == IDLE æ—¶æ‰æ£€æŸ¥å¯è¯»æ€§ï¼‰</p>
</li>
</ul>
<p>å› æ­¤ï¼Œå³ä½¿å¼‚å¸¸ä¼ æ’­åˆ°æœ€é¡¶å±‚ï¼ŒAsyncConnectionPool ä¹Ÿæ— æ³•è¯†åˆ«è¿™ä¸ªå·²æ–­å¼€çš„è¿æ¥ï¼Œåªèƒ½å°†å¼‚å¸¸ç»§ç»­æŠ›å‡ºã€‚</p>
<p><strong>è¿˜æœ‰æ›´ä¸Šå±‚å—ï¼Ÿ</strong></p>
<p>æˆ‘è§‰å¾—æ²¡æœ‰äº†ã€‚except BaseExceptionå—ä¸­çš„raise exc from Noneå°±æ˜¯æœ€ç»ˆå‡ºå£ï¼Œå¼‚å¸¸ç›´æ¥æŠ›ç»™è°ƒç”¨httpcoreçš„ç”¨æˆ·ä»£ç ï¼ˆå¦‚ httpx æˆ–åº”ç”¨å±‚ï¼‰ã€‚å¹¶ä¸”ï¼Œå¼‚å¸¸è¶Šå¾€ä¸ŠæŠ›ï¼Œè¶Šè„±ç¦»åŸå§‹è¿æ¥å¯¹è±¡çš„ä¸Šä¸‹æ–‡ï¼Œè¿™ä¸åº”è¯¥è§†ä¸ºåˆç†ã€‚</p>
<h3 data-id="heading-1">ä¿®å¤æ–¹æ¡ˆ</h3>
<p>é—®é¢˜çš„æœ¬è´¨å·²ç»æ¸…æ™°ï¼šTLS æ¡æ‰‹å¤±è´¥æ—¶ï¼Œå¼‚å¸¸ä¼ æ’­è·¯å¾„ä¸Šç¼ºå°‘å¯¹AsyncHTTP11ConnectionçŠ¶æ€çš„æ˜¾å¼æ¸…ç†ã€‚</p>
<p>æˆ‘çš„ä¿®å¤å¾ˆç®€å•â€”â€”åœ¨ TLS æ¡æ‰‹é˜¶æ®µå¢åŠ å¼‚å¸¸æ•è·ï¼Œç¡®ä¿å¤±è´¥æ—¶ä¸»åŠ¨å…³é—­è¿æ¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#  AsyncTunnelHTTPConnection.handle_async_request</span>
...
                <span class="hljs-keyword">try</span>:
                    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> Trace(<span class="hljs-string">"start_tls"</span>, logger, request, kwargs) <span class="hljs-keyword">as</span> trace:
                        stream = <span class="hljs-keyword">await</span> stream.start_tls(**kwargs)
                        trace.return_value = stream
                <span class="hljs-keyword">except</span> Exception:
                    <span class="hljs-comment"># Close the underlying connection when TLS handshake fails to avoid</span>
                    <span class="hljs-comment"># zombie connections occupying the connection pool</span>
                    <span class="hljs-keyword">await</span> self._connection.aclose()
                    <span class="hljs-keyword">raise</span>
...
</code></pre>
<p>è¿™è¡Œawait self._connection.aclose()å¼ºåˆ¶å°†AsyncHTTP11Connection._stateä»ACTIVEè½¬ä¸ºCLOSEDï¼Œè®©è¿æ¥æ± çš„is_closed()æ£€æŸ¥èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«ï¼Œä»è€Œåœ¨ä¸‹ä¸€æ¬¡_assign_requests_to_connections()è°ƒç”¨æ—¶å°†è¯¥è¿æ¥ç§»é™¤ã€‚</p>
<h3 data-id="heading-2">æ€»ç»“</h3>
<p>é€šè¿‡è¿™æ¬¡è¿½è¸ªï¼Œæˆ‘å¯¹ httpcore çš„åˆ†å±‚æ¶æ„æœ‰äº†æ›´æ¸…æ™°çš„ç†è§£ã€‚è¿™ä¸ªåœºæ™¯çš„ç‰¹æ®Šä¹‹å¤„åœ¨äºï¼šå®ƒæ°å¥½å¤„äºå¤šä¸ªæŠ½è±¡å±‚çº§çš„äº¤æ¥å¤„â€”â€”ä¸ä»£ç†ä¹‹é—´çš„TCP è¿æ¥å·²å»ºç«‹ã€HTTP è¯·æ±‚å·²å®Œæˆï¼Œä½†åˆ°ç›®æ ‡åœ°å€çš„ TLS å‡çº§å°šæœªæˆåŠŸã€‚æ­¤æ—¶å¼‚å¸¸ä¼ æ’­è·¯å¾„è·¨è¶Šäº† Stream â†’ Connection â†’ Pool çš„è¾¹ç•Œï¼ŒçŠ¶æ€åŒæ­¥çš„å¤æ‚æ€§æ˜¾è‘—å¢åŠ ã€‚è¿™ç±»é—®é¢˜åœ¨å¼‚æ­¥ç½‘ç»œç¼–ç¨‹ä¸­å¹¶ä¸ç½•è§ï¼šå½“æ§åˆ¶æµåœ¨å¤šä¸ªå¯¹è±¡é—´å§”æ‰˜æ—¶ï¼Œç¡®ä¿æ¯ä¸ªé€€å‡ºè·¯å¾„éƒ½æ­£ç¡®åŒæ­¥çŠ¶æ€æ˜¯ä¸€é¡¹ç³»ç»Ÿæ€§æŒ‘æˆ˜ã€‚æˆ‘çš„ä¿®å¤åªæ˜¯åœ¨ç°æœ‰çš„å¼‚å¸¸å¤„ç†æ¡†æ¶ä¸­ï¼Œè¡¥å…¨äº†è¿™ä¸€ç‰¹å®šè·¯å¾„çš„çŠ¶æ€æ¸…ç†é€»è¾‘ã€‚</p>
<p>PR é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fencode%2Fhttpcore%2Fpull%2F1049" target="_blank" title="https://github.com/encode/httpcore/pull/1049" ref="nofollow noopener noreferrer">github.com/encode/httpâ€¦</a></p>
<p>æ„Ÿè°¢ encode å›¢é˜Ÿç»´æŠ¤äº†å¦‚æ­¤ä¼˜é›…çš„ä»£ç åº“ï¼Œä¹Ÿæ„Ÿè°¢ AI ååŠ©å®Œæˆäº†è¿™æ¬¡æ·±åº¦åˆ†æã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Viteä¸ºä»€ä¹ˆèƒ½æ¯”Webpackå¿«10å€ï¼Ÿæ­ç§˜å…¶æ ¸å¿ƒä¼˜åŒ–ç­–ç•¥]]></title>    <link>https://juejin.cn/post/7601175299010838543</link>    <guid>https://juejin.cn/post/7601175299010838543</guid>    <pubDate>2026-02-01T04:17:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601175299010838543" data-draft-id="7601046076944252943" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Viteä¸ºä»€ä¹ˆèƒ½æ¯”Webpackå¿«10å€ï¼Ÿæ­ç§˜å…¶æ ¸å¿ƒä¼˜åŒ–ç­–ç•¥"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-01T04:17:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Viteä¸ºä»€ä¹ˆèƒ½æ¯”Webpackå¿«10å€ï¼Ÿæ­ç§˜å…¶æ ¸å¿ƒä¼˜åŒ–ç­–ç•¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T04:17:42.000Z" title="Sun Feb 01 2026 04:17:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>Viteä¸ºä»€ä¹ˆèƒ½æ¯”Webpackå¿«10å€ï¼Ÿæ­ç§˜å…¶æ ¸å¿ƒä¼˜åŒ–ç­–ç•¥</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨å‰ç«¯å¼€å‘é¢†åŸŸï¼Œæ„å»ºå·¥å…·çš„æ€§èƒ½ä¸€ç›´æ˜¯å¼€å‘è€…å…³æ³¨çš„ç„¦ç‚¹ã€‚éšç€é¡¹ç›®è§„æ¨¡çš„æ‰©å¤§ï¼Œä¼ ç»Ÿçš„æ‰“åŒ…å·¥å…·å¦‚Webpackåœ¨å¯åŠ¨å’Œçƒ­æ›´æ–°æ—¶é€æ¸æ˜¾éœ²å‡ºæ€§èƒ½ç“¶é¢ˆã€‚è€ŒViteçš„å‡ºç°ï¼Œä»¥å…¶æƒŠäººçš„é€Ÿåº¦ä¼˜åŠ¿ï¼ˆå®˜æ–¹å®£ç§°æ¯”Webpackå¿«10å€ï¼‰ï¼Œè¿…é€Ÿæˆä¸ºæ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·çš„ä»£è¡¨ã€‚é‚£ä¹ˆï¼ŒViteç©¶ç«Ÿæ˜¯å¦‚ä½•å®ç°è¿™ä¸€æ€§èƒ½é£è·ƒçš„ï¼Ÿæœ¬æ–‡å°†æ·±å…¥å‰–æViteçš„æ ¸å¿ƒä¼˜åŒ–ç­–ç•¥ï¼Œä»æ¶æ„è®¾è®¡åˆ°å…·ä½“å®ç°ï¼Œæ­ç¤ºå…¶é«˜é€ŸèƒŒåçš„æŠ€æœ¯å¥¥ç§˜ã€‚</p>
<h2 data-id="heading-2">ä¸»ä½“</h2>
<h3 data-id="heading-3">1. åŸç”ŸESMçš„é©å‘½æ€§å˜é©</h3>
<h4 data-id="heading-4">1.1 ä¼ ç»Ÿæ‰“åŒ…å™¨çš„å›°å¢ƒ</h4>
<p>Webpackç­‰ä¼ ç»Ÿå·¥å…·é‡‡ç”¨"æ‰“åŒ…ä¼˜å…ˆ"çš„ç­–ç•¥ï¼šåœ¨å¼€å‘ç¯å¢ƒä¸‹å°†æ‰€æœ‰æ¨¡å—é¢„å…ˆæ‰“åŒ…æˆä¸€ä¸ªæˆ–å¤šä¸ªbundleã€‚è¿™ç§æ–¹å¼è™½ç„¶å…¼å®¹æ€§å¥½ï¼Œä½†éšç€é¡¹ç›®è§„æ¨¡å¢é•¿ä¼šå¸¦æ¥ä¸¤ä¸ªæ˜¾è‘—é—®é¢˜ï¼š</p>
<ul>
<li><strong>å†·å¯åŠ¨æ—¶é—´é•¿</strong>ï¼šéœ€è¦å®Œæ•´æ„å»ºä¾èµ–å›¾å¹¶æ‰“åŒ…æ‰€æœ‰èµ„æº</li>
<li><strong>HMRæ•ˆç‡ä½</strong>ï¼šå³ä½¿ä¿®æ”¹å•ä¸ªæ–‡ä»¶ä¹Ÿå¯èƒ½è§¦å‘æ•´ä¸ªbundleçš„é‡å»º</li>
</ul>
<h4 data-id="heading-5">1.2 Viteçš„ESMè§£å†³æ–¹æ¡ˆ</h4>
<p>Viteå……åˆ†åˆ©ç”¨ç°ä»£æµè§ˆå™¨å¯¹åŸç”ŸESæ¨¡å—(ESM)çš„æ”¯æŒï¼Œå®ç°äº†å¼€å‘ç¯å¢ƒçš„"æŒ‰éœ€ç¼–è¯‘"ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµè§ˆå™¨ç›´æ¥è¯·æ±‚ESæ¨¡å—</span>
&lt;script type=<span class="hljs-string">"module"</span> src=<span class="hljs-string">"/src/main.js"</span>&gt;&lt;/script&gt;
</code></pre>
<p>å…³é”®ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>æ— æ‰“åŒ…å¯åŠ¨</strong>ï¼šç›´æ¥å¯åŠ¨æœåŠ¡å™¨ï¼Œæµè§ˆå™¨æŒ‰éœ€è¯·æ±‚æ¨¡å—</li>
<li><strong>ä¾èµ–é¢„æ„å»º</strong>ï¼šä½¿ç”¨esbuildå°†CommonJS/UMDä¾èµ–è½¬æ¢ä¸ºESMæ ¼å¼å¹¶ç¼“å­˜</li>
<li><strong>æºç æŒ‰éœ€ç¼–è¯‘</strong>ï¼šä»…ç¼–è¯‘å½“å‰é¡µé¢éœ€è¦çš„æ–‡ä»¶ï¼ˆå¦‚.vue/.jsxï¼‰</li>
</ul>
<p>å®æµ‹æ•°æ®è¡¨æ˜ï¼Œä¸€ä¸ªåŒ…å«1000+æ¨¡å—çš„é¡¹ç›®ï¼ŒViteçš„å†·å¯åŠ¨æ—¶é—´å¯ä»¥æ§åˆ¶åœ¨1ç§’å†…ï¼Œè€ŒWebpackå¯èƒ½éœ€è¦20ç§’ä»¥ä¸Šã€‚</p>
<h3 data-id="heading-6">2. Esbuildçš„æ€§èƒ½ç¢¾å‹</h3>
<h4 data-id="heading-7">2.1 ä¼ ç»Ÿå·¥å…·é“¾çš„ç“¶é¢ˆ</h4>
<p>WebpackåŸºäºJavaScriptå®ç°çš„è½¬è¯‘å™¨å­˜åœ¨å›ºæœ‰æ€§èƒ½é™åˆ¶ï¼š</p>
<ul>
<li>Babel/Terserå•çº¿ç¨‹è¿è¡Œ</li>
<li>JavaScriptæœ¬èº«çš„æ‰§è¡Œæ•ˆç‡é™åˆ¶</li>
</ul>
<h4 data-id="heading-8">2.2 Esbuildçš„æè‡´ä¼˜åŒ–</h4>
<p>Viteä½¿ç”¨Goè¯­è¨€ç¼–å†™çš„Esbuildè¿›è¡Œå…³é”®è·¯å¾„å¤„ç†ï¼š</p>





























<table><thead><tr><th>ç‰¹æ€§</th><th>Esbuild</th><th>Babel</th><th>Terser</th></tr></thead><tbody><tr><td>è¯­è¨€</td><td>Go</td><td>JS</td><td>JS</td></tr><tr><td>å¹¶è¡ŒåŒ–</td><td>âœ”</td><td>âœ–</td><td>âœ–</td></tr><tr><td>ç¼–è¯‘é€Ÿåº¦(å€ç‡)</td><td>~100x</td><td>1x</td><td>~5x</td></tr></tbody></table>
<p>å®é™…åº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li><strong>ä¾èµ–é¢„æ„å»º</strong>ï¼šæ¯”ä¼ ç»Ÿæ–¹æ¡ˆå¿«10-100å€</li>
<li><strong>ç”Ÿäº§æ„å»º</strong>ï¼šè™½ç„¶æœ€ç»ˆä»ç”¨Rollupï¼Œä½†ä½¿ç”¨esbuildè¿›è¡Œæœ€å°åŒ–(minify)</li>
</ul>
<h3 data-id="heading-9">3. æ™ºèƒ½ç¼“å­˜ç­–ç•¥</h3>
<h4 data-id="heading-10">3.1 HTTPç¼“å­˜å¤´ä¼˜åŒ–</h4>
<p>Viteä¸ºä¸åŒèµ„æºç±»å‹è®¾ç½®ç²¾ç¡®çš„Cache-Controlå¤´ï¼š</p>
<pre><code class="hljs language-http" lang="http"># npmä¾èµ–ï¼ˆå‡ ä¹ä¸å˜ï¼‰
Cache-Control: max-age=31536000,immutable

# æºç æ–‡ä»¶ï¼ˆå¯èƒ½å˜åŒ–ï¼‰
Cache-Control: no-cache,must-revalidate
</code></pre>
<h4 data-id="heading-11">3.2 æ–‡ä»¶ç³»ç»Ÿç¼“å­˜æœºåˆ¶</h4>
<p>Viteé‡‡ç”¨å¤šå±‚ç¼“å­˜ç»“æ„ï¼š</p>
<ol>
<li><strong>node_modules/.vite</strong>ï¼šé¢„æ„å»ºä¾èµ–ç¼“å­˜</li>
<li><strong>æµè§ˆå™¨å†…å­˜ç¼“å­˜</strong>ï¼šé¿å…é‡å¤è¯·æ±‚å·²ç¼–è¯‘æ¨¡å—</li>
</ol>
<p>å¯¹æ¯”æµ‹è¯•æ˜¾ç¤ºï¼ŒäºŒæ¬¡å¯åŠ¨æ—¶Viteçš„çƒ­æ›´æ–°é€Ÿåº¦å¯ä»¥æå‡40%ä»¥ä¸Šã€‚</p>
<h3 data-id="heading-12">4. CSRä¸SSRçš„ç»Ÿä¸€ä¼˜åŒ–</h3>
<h4 data-id="heading-13">4.1 CSRçš„ç‰¹æ®Šå¤„ç†</h4>
<p>å¯¹äºå®¢æˆ·ç«¯æ¸²æŸ“ï¼š</p>
<ul>
<li><strong>è·¯ç”±çº§ä»£ç åˆ†å‰²</strong>ï¼šè‡ªåŠ¨è¯†åˆ«åŠ¨æ€import()</li>
<li><strong>å¼‚æ­¥chunkåŠ è½½</strong>ï¼šä¼˜å…ˆåŠ è½½å¯è§†åŒºèµ„æº</li>
</ul>
<h4 data-id="heading-14">4.2 SSRçš„é«˜æ•ˆæ”¯æŒ</h4>
<p>æœåŠ¡ç«¯æ¸²æŸ“æ—¶ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite.config.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
 <span class="hljs-attr">ssr</span>: {
   <span class="hljs-comment">// SSRä¸“ç”¨å¤–éƒ¨åŒ–é…ç½® </span>
   <span class="hljs-attr">external</span>: [<span class="hljs-string">'react'</span>, <span class="hljs-string">'react-dom'</span>],
   
   <span class="hljs-comment">// SSRä¸“ç”¨å…¥å£ä¼˜åŒ–  </span>
   <span class="hljs-attr">noExternal</span>: <span class="hljs-regexp">/\.css$/</span>
 }
}
</code></pre>
<p>åˆ›æ–°ç‚¹åœ¨äºSSR bundlerä¸CSR bundlerå…±äº«åŒä¸€å¥—æ’ä»¶ç³»ç»Ÿã€‚</p>
<h3 data-id="heading-15">Webpackå¯¹æ¯”åŸºå‡†æµ‹è¯•</h3>
<p>é€šè¿‡å®é™…é¡¹ç›®æµ‹é‡ä¸åŒæ“ä½œçš„æ—¶é—´æ¶ˆè€—ï¼ˆmsï¼‰ï¼š</p>





























<table><thead><tr><th>Operation</th><th align="right">Webpack(5.x)</th><th align="right">Vite(4.x)</th><th align="right">Speedup</th></tr></thead><tbody><tr><td>Cold Start</td><td align="right">23,000+</td><td align="right">800+</td><td align="right">~28x</td></tr><tr><td>HMR (Small file)</td><td align="right">1200</td><td align="right">20</td><td align="right">~60x</td></tr><tr><td>Production Build*</td><td align="right">45,000+</td><td align="right">12,000+</td><td align="right">~3.7x</td></tr></tbody></table>
<p>(*æ³¨ï¼šç”Ÿäº§æ„å»ºå·®å¼‚è¾ƒå°å› ä¸ºéƒ½éœ€å®Œæ•´æ‰“åŒ…)</p>
<h2 data-id="heading-16"/>
<h3 data-id="heading-17"/>
<h2 data-id="heading-18"/>
<h2 data-id="heading-19"/>
<h2 data-id="heading-20"/>
<h2 data-id="heading-21"/>
<h2 data-id="heading-22"/>
<h2 data-id="heading-23"/>
<h2 data-id="heading-24"/>
<h2 data-id="heading-25"/>
<h2 data-id="heading-26"/>
<h2 data-id="heading-27"/>
<h2 data-id="heading-28"/>
<p>è¿™äº›æ•°æ®å……åˆ†å±•ç¤ºäº†ä¸ºä»€ä¹ˆå¼€å‘è€…ä¼šæ„Ÿå—åˆ°"10å€é€Ÿ"çš„ä½“éªŒæå‡ã€‚</p>
<h3 data-id="heading-29"/>
<h3 data-id="heading-30"/>
<h3 data-id="heading-31"/>
<h3 data-id="heading-32"/>
<h3 data-id="heading-33"/>
<h3 data-id="heading-34"/>
<ol start="5">
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
</ol>
<p>æ·±åº¦æŠ€æœ¯è§£æï¼š</p>
<ol start="21">
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
<li/>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…¨çƒé¦–æ¬¾ç”µå•†è§†é¢‘Multi-Agentæ¥äº†ï¼ä¸€å¼ å›¾ç”Ÿæˆå¸¦è´§è§†é¢‘ï¼Œæ•ˆç‡èµ·é£~]]></title>    <link>https://juejin.cn/post/7601169987412557862</link>    <guid>https://juejin.cn/post/7601169987412557862</guid>    <pubDate>2026-02-01T04:22:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601169987412557862" data-draft-id="7601169987412525094" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…¨çƒé¦–æ¬¾ç”µå•†è§†é¢‘Multi-Agentæ¥äº†ï¼ä¸€å¼ å›¾ç”Ÿæˆå¸¦è´§è§†é¢‘ï¼Œæ•ˆç‡èµ·é£~"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-02-01T04:22:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIè¢‹é¼ å¸"/> <meta itemprop="url" content="https://juejin.cn/user/2032372037988990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…¨çƒé¦–æ¬¾ç”µå•†è§†é¢‘Multi-Agentæ¥äº†ï¼ä¸€å¼ å›¾ç”Ÿæˆå¸¦è´§è§†é¢‘ï¼Œæ•ˆç‡èµ·é£~
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2032372037988990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIè¢‹é¼ å¸
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T04:22:04.000Z" title="Sun Feb 01 2026 04:22:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æœ€è¿‘åœ¨ç ”ç©¶AIåšè¥é”€çŸ­è§†é¢‘çš„è¢‹é¼ å¸ã€‚</p>
<p>æˆ‘24å¹´ä¸€å¼€å§‹æ˜¯åšæŠ–éŸ³çŸ­è§†é¢‘çš„ï¼Œæ·±çŸ¥åšè§†é¢‘æœ‰å¤šéº»çƒ¦ã€‚</p>
<p>ä»å£æ’­ã€ç´ ææ‹æ‘„ï¼Œåˆ°å†™æ–‡æ¡ˆã€åæœŸå‰ªè¾‘ï¼Œè¿™äº›ç¯èŠ‚åŠ åœ¨ä¸€èµ·ï¼Œå³ä¾¿æˆ‘åªæ˜¯æƒ³åšä¸€æ¡çœ‹èµ·æ¥è´¨é‡ä¸€èˆ¬çš„çŸ­è§†é¢‘ï¼Œä¹Ÿè¦è€—è´¹æˆ‘åŠå¤©æ—¶é—´ã€‚</p>
<p>æ›´åˆ«æè·¨å¢ƒè¥é”€è§†é¢‘äº†ï¼Œä¸ä»…è¯­è¨€æœ‰é—¨æ§›ï¼Œæ¨¡ç‰¹ã€åœºæ™¯çš„æˆæœ¬æ›´æ˜¯é«˜å¾—å“äººã€‚</p>
<p>æ‰€ä»¥æˆ‘ä¸€ç›´åœ¨æ‰¾AIä¸€é”®ç”Ÿæˆçš„æ–¹æ¡ˆï¼Œè¯•å›¾æŠŠè¿™ä¸ªè¿‡ç¨‹è‡ªåŠ¨åŒ–ã€‚</p>
<p>å…ˆçœ‹çœ‹æˆ‘å…¨ç¨‹ä¸ç”¨åŠ¨æ‰‹ï¼Œå°±åšå‡ºæ¥çš„æµ·å¤–è¥é”€çŸ­è§†é¢‘ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2834dbc79b0748c0a6dc8749419f3a9c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=pCWl%2F%2BqQcl8lasTgQyN4zQd2%2B8c%3D" alt="wxv_4366268611762503685" loading="lazy"/></p>
<p>åœ¨ç”Ÿæˆçš„è§†é¢‘ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æŠ•å½±ä»ªä¸€ç›´æ²¡æœ‰å˜åŒ–ï¼Œä¸è®ºåœºæ™¯æ€ä¹ˆå˜æ¢ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯åŒä¸€æ¬¾æŠ•å½±ä»ªã€‚</p>
<p>æ•ˆæœæ˜¯ä¸æ˜¯è¿˜ä¸é”™</p>
<p>è¯´å®è¯ï¼Œæˆ‘æ²¡æƒ³åˆ°ç°åœ¨åšæµ·å¤–è¥é”€çŸ­è§†é¢‘ä¹Ÿèƒ½ä¸€é”®ç”Ÿæˆäº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆæˆ‘æƒ³åˆ°å»æ¢ç´¢ä¸€é”®ç”Ÿæˆè¥é”€çŸ­è§†é¢‘å‘¢ï¼Ÿäº‹æƒ…çš„èµ·å› æ˜¯è¿™æ ·çš„ï¼š</p>
<p>æˆ‘ä¹‹å‰åˆ·çŸ­è§†é¢‘ï¼Œå¶ç„¶åˆ·åˆ°äº†ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„æ¡ˆä¾‹ã€‚</p>
<p>è¿™ä¸ªè§†é¢‘ç›®å‰çš„æ’­æ”¾é‡å’Œç‚¹èµé‡éƒ½éå¸¸é«˜ï¼Œå¯èƒ½å¾ˆå¤šæœ‹å‹ä¹Ÿåˆ·åˆ°è¿‡ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ed2afefa6d84105a9739da1dcb943eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=78iu1Mc4Mv6jO%2FzpK9QwJ9lvcfs%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/245ae25aeacd4085a31f87bf32ea438f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=Z3jhoXuDSN3P4cKmZGCr831pwvQ%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è§†é¢‘é‡Œè¿™ä½è€å“¥åˆ†äº«äº†ä»–å¦‚ä½•åœ¨30å¤©å†…å»ºç«‹ä¸€ä¸ªç™¾ä¸‡ç¾å…ƒå“ç‰Œçš„ç»å†ã€‚</p>
<p>æˆ‘åå¤çœ‹äº†å¥½å‡ éï¼Œè§‰å¾—ä»–æŠŠæµ·å¤–è¥é”€çš„åº•å±‚é€»è¾‘è®²å¾—å¤ªé€äº†</p>
<p>ä¸ºäº†æ–¹ä¾¿å¤§å®¶ç†è§£ï¼Œæˆ‘ä¸“é—¨æ ¹æ®ä»–çš„è§†é¢‘å†…å®¹æ•´ç†äº†ä¸€å¼ æ‹†è§£å›¾ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b423fc317134d7395705c9fdfff7efe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=iPBgT66yGGv%2BZoi33H74xPJF5u0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>å…¶å®æˆ‘24å¹´åˆšå¼€å§‹åšçŸ­è§†é¢‘çš„æ—¶å€™ï¼Œæˆ‘å°±æƒ³å°è¯•æµ·å¤–å¸¦è´§ï¼Œä½†æ€»ç»“ä¸‹æ¥æˆ‘è§‰å¾—ä¸»è¦æœ‰ä¸¤ä¸ªæ ¸å¿ƒéš¾ç‚¹ï¼š</p>
<p>ç¬¬ä¸€æ˜¯æ‰¾å¯¹äº§å“æ–¹å‘ï¼Œç¬¬äºŒæ˜¯æŒç»­ç”Ÿäº§çˆ†æ¬¾è¥é”€è§†é¢‘ã€‚</p>
<p>æŒ‰ç…§è§†é¢‘é‡Œè¿™ä½è€å“¥çš„è¯´æ³•ï¼Œä»–ä¸ºäº†å–å¥½è¿™æ¬¾æ™®æ‹‰æé˜²æ»‘è¢œï¼Œåšäº†ææ·±çš„å¸‚åœºæ´å¯Ÿï¼šå‘ç°ç›®æ ‡ç”¨æˆ·æ˜¯é‚£äº›è¿½æ±‚That Girlå®¡ç¾ã€ä¹Ÿå°±æ˜¯è¿½æ±‚è‡ªå¾‹ã€ç²¾è‡´ã€æç®€ç”Ÿæ´»æ–¹å¼çš„å¹´è½»å¥³æ€§ï¼Œä¸ºäº†æ‰“åŠ¨è¿™ç¾¤äººï¼Œå¿…é¡»ç”Ÿäº§é«˜è´¨é‡çš„è§†è§‰ç´ æã€‚</p>
<p>æ‰€ä»¥ï¼Œä»–ä¸“é—¨åœ¨æŸæ—æ‰¾äº†ä¸“ä¸šçš„æ—¶å°šæ‘„å½±å¸ˆï¼Œç§Ÿäº†ç¬¦åˆGlossieré‚£ç§é«˜çº§æ„Ÿè‰²è°ƒçš„æ‘„å½±æ£šï¼Œè¿˜é¢è¯•äº†ä¸€å †æ¨¡ç‰¹ï¼Œåªä¸ºæ‰¾åˆ°æœ€ç¬¦åˆThat Girlæ°”è´¨çš„é‚£å¼ è„¸ã€‚</p>
<p>ä½†å¯¹äºå¤§éƒ¨åˆ†äººæ¥è¯´çˆ†æ¬¾è§†é¢‘å¾€å¾€æ˜¯å¯é‡ä¸å¯æ±‚çš„ï¼Œé™¤äº†å†…å®¹æœ¬èº«ï¼Œè¿˜éœ€è¦è¿æ°”ã€‚å¯¹äºæˆ‘ä»¬è¿™ç§åˆšèµ·æ­¥çš„ä¸ªäººæˆ–è€…å°å›¢é˜Ÿï¼Œè¿˜æœ‰ä¸ªæœ€ç¨³å¦¥çš„ç­–ç•¥å…¶å®æ˜¯å †é‡ï¼Œä¸€æ¡ä¸çˆ†æˆ‘å°±å‘100æ¡ï¼Œæ€»æœ‰ä¸€æ¡èƒ½è·‘å‡ºæ¥ï¼ˆå½“ç„¶è¿‡ç¨‹ä¸­ä¹Ÿè¦ä¸æ–­ä¼˜åŒ–ï¼‰ã€‚</p>
<p>ä½†å¦‚æœæˆ‘ä»¬å­¦è¿™ä½è€å“¥ï¼Œå¦‚æœæ¯æ¡è§†é¢‘éƒ½æ‰¾ä¸“ä¸šæ‘„å½±å¸ˆã€ç§Ÿæ£šã€è¯·æ¨¡ç‰¹ï¼Œè¿™100æ¡è§†é¢‘ï¼Œä¸ç®¡æ˜¯æ—¶é—´æˆæœ¬ï¼Œè¿˜æ˜¯è´¹ç”¨éƒ½èƒ½æŠŠäººå‹å®ã€‚</p>
<p>æˆ‘å°±åœ¨æƒ³ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´å¿«ï¼Œæˆæœ¬æ›´ä½ï¼Œè€Œä¸”æ•ˆæœè¿˜ä¸é”™çš„æŠ€æœ¯æ‰‹æ®µèƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ</p>
<p>äºæ˜¯ï¼Œæˆ‘å‰æ®µæ—¶é—´æäº†ä¸€å¥—è¥é”€çŸ­è§†é¢‘ä¸€é”®ç”Ÿæˆå¹³å°ï¼Œå¸Œæœ›èƒ½å¿«é€Ÿå¤åˆ»ä¸€ä¸‹é‚£ä½ç™¾ä¸‡åˆ€å“ç‰Œè€å“¥çš„è¥é”€ç¥è¯ã€‚</p>
<p>å¹³å°çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼šç”¨AIæ›¿ä»£æ˜‚è´µçš„æ‘„å½±å¸ˆã€æ¨¡ç‰¹å’Œæ–‡æ¡ˆï¼Œæœ€åä¸€é”®åˆæˆè¥é”€çŸ­è§†é¢‘ã€‚</p>
<p>ç»è¿‡æˆ‘çš„ä¸€ç•ªç ”ç©¶ï¼Œè¦æƒ³æ•ˆæœå¥½ï¼Œä¸€å®šè¦é›†é½å½“ä»Šæœ€å¼ºçš„ç”Ÿå›¾æ¨¡å‹ï¼Œç”Ÿè§†é¢‘æ¨¡å‹ï¼Œæ–‡æ¡ˆæ¨¡å‹ï¼Œæ•°å­—äººæœåŠ¡ã€‚</p>
<p>éœ€è¦çš„å·¥å…·ä¸»è¦æœ‰äº”ä¸ªï¼ˆéƒ½æ˜¯ç›®å‰å¸‚é¢ä¸Šåœ¨å„è‡ªé¢†åŸŸæœ€èƒ½æ‰“çš„ï¼‰ï¼š</p>
<p>NanoBananaï¼ˆæˆ–å…¶ä»–é«˜è´¨é‡ç”Ÿå›¾æ¨¡å‹ï¼‰ï¼šè´Ÿè´£æå®šçš®å›Šï¼Œç”Ÿæˆç¬¦åˆå®¡ç¾çš„äº§å“å›¾å’Œæ¨¡ç‰¹å›¾ã€‚Â </p>
<p>Gemini 3ï¼ˆæˆ–å…¶ä»–é«˜æ™ºå•†LLMï¼‰ï¼šè´Ÿè´£æå®šå¤§è„‘ï¼Œç”Ÿæˆå£æ’­æ–‡æ¡ˆå’Œæç¤ºè¯ã€‚Â </p>
<p>index-ttï¼ˆæˆ–å…¶ä»–å¼€æºTTSï¼‰ï¼šè´Ÿè´£ç”Ÿæˆå¸¦æƒ…ç»ªçš„è¯­éŸ³ã€‚Â </p>
<p>HeyGenï¼šè´Ÿè´£æ•°å­—äººç”Ÿæˆã€‚Â </p>
<p>Veo3.1æˆ–è€…Sora2ï¼šè´Ÿè´£ç”Ÿæˆç©ºé•œç´ æã€‚</p>
<p>ç»å¸¸çœ‹æˆ‘çš„æœ‹å‹åº”è¯¥çŸ¥é“ï¼Œæˆ‘å‰æ®µæ—¶é—´å°±å¼€å‘äº†ä¸€ä¸ªæ•°å­—äººè¥é”€è§†é¢‘ä¸€é”®ç”Ÿæˆå¹³å°ï¼Œä½†åªæ˜¯ä¸ªMVPé¡¹ç›®ï¼Œè¿˜å¾ˆä¸æˆç†Ÿ...</p>
<p>è€Œä¸”è¦é›†é½è¿™äº›å·¥å…·ï¼Œå¹¶å®ç°å…¨è‡ªåŠ¨åŒ–ï¼Œå·¥ç¨‹é‡ä¹Ÿæ˜¯ç›¸å½“ä¹‹å¤§ï¼Œä¸æ˜¯çŸ­æ—¶é—´èƒ½æå®šçš„äº‹æƒ…ã€‚å…‰æ˜¯è¿™äº›å·¥å…·çš„APIåŠ èµ·æ¥ï¼Œä¸€ä¸ªæœˆå°±æ˜¯ä¸€ç¬”ä¸å°çš„å¼€æ”¯ï¼Œè¿˜å¾—å†™ä»£ç æŠŠå®ƒä»¬ä¸²èµ·æ¥ã€‚</p>
<p>äºæ˜¯æˆ‘å¼€å§‹æ‰¾æœ‰æ²¡æœ‰ç°æˆçš„æ•´åˆæ–¹æ¡ˆï¼Œæ‰¾äº†åŠå¤©ï¼Œæˆ‘å‘ç°ç›®å‰ä¸“é—¨åšè¥é”€è§†é¢‘çš„å¹³å°è¿˜æ¯”è¾ƒå°‘ã€‚</p>
<p>æœ‹å‹æ¨èäº†ä¸€æ¬¾æœ€è¿‘å…¬æµ‹æ¯”è¾ƒç«çˆ†çš„å¹³å°ï¼Œæ˜¯ç”±è¥èµ›AIå‘å¸ƒçš„inSai Hilightï¼Œå·ç§°æ˜¯è·¨å¢ƒç”µå•†ç‰ˆSoraï¼Œè²Œä¼¼èƒ½æ»¡è¶³ä»¥ä¸Šçš„æ¡ä»¶ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cdd59dc325ce4f8b825b69e7d2d1ce50~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=Wmi2sFiUHsAGaGs%2BD9vZ06GMxTM%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>hi-light.ai</p>
<p>çœ‹äº†ä¸€ä¸‹ï¼Œä»–ä»¬è¿™åŠŸèƒ½ç¡®å®æœ‰ç‚¹ä¸°å¯Œäº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aac54c9761264898b25a961e5c0e76e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=TPBecBuqxThVmBsgotBNwGguCZU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/>æˆ‘é‚£ä¸ªå¹³å°ä¼°è®¡é æˆ‘è‡ªå·±æ˜¯èµ¶ä¸ä¸Šäººå®¶äº†ï¼Œç›®å‰ä¹Ÿæ²¡å¤šå¤§ç«äº‰åŠ›ï¼Œåç»­å‡†å¤‡å¼€æºäº†ï¼ˆæœ‰å…´è¶£å‚ä¸å¼€æºçš„æœ‹å‹ï¼Œå¯ä»¥è”ç³»æˆ‘ï¼‰ã€‚<img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f31101893dfb48b0971c76b480aef57d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=s%2BLDrGeqbOqGpSTdQTFoOSxuw4s%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h3 data-id="heading-0">Hilightæœ‰å“ªäº›ä¼˜åŠ¿ï¼Ÿ</h3>
<p>1.ä¸€é”®æˆç‰‡ï¼šæ— éœ€æ‹æ‘„å‰ªè¾‘ï¼Œåªéœ€æ‰”è¿›ä¸€ä¸ªå•†å“é“¾æ¥æˆ–è€…ä¸Šä¼ å•†å“å›¾ï¼ŒAIè‡ªåŠ¨åˆ†æå–ç‚¹ã€å†™è„šæœ¬ã€ç”Ÿæˆè§†é¢‘ï¼›</p>
<p>2.å•†å“/äººç‰©è·¨å¸§ä¸€è‡´ï¼šæ— è®ºé•œå¤´æ€ä¹ˆåˆ‡æ¢ï¼Œæ¨¡ç‰¹æ‰‹é‡Œçš„å•†å“ä¼šä¿æŒåŸæ ·ï¼Œä¸€è‡´æ€§å¾ˆä¸é”™ï¼›</p>
<p>3.å¤šæ™ºèƒ½ä½“æ…¢æ€è€ƒæ¶æ„ï¼šèƒŒåæ˜¯10å¤šä¸ªAIä¸“å®¶ï¼ˆå¯¼æ¼”ã€å‰ªè¾‘ã€è´¨æ£€ï¼‰åœ¨åä½œï¼Œé‡‡ç”¨ç±»ä¼¼DeepSeekçš„æ…¢æ€è€ƒé€»è¾‘ï¼Œè‡ªæˆ‘åæ€ã€è‡ªæˆ‘ä¿®æ­£ï¼Œç”¨æ·±åº¦æ€è€ƒæ¢å–é«˜è´¨é‡äº¤ä»˜ã€‚</p>
<p>4.ç²¾è°ƒæ¨¡å¼ï¼šæ‹’ç»é»‘ç›’å¼ç”Ÿæˆï¼Œæ”¯æŒåˆ†å±‚ç¼–è¾‘ã€Touch Editï¼ˆæŒ‡å“ªæ”¹å“ªï¼‰ã€æ–‡å­—ä¿®æ”¹ï¼ŒAIè§†é¢‘å˜å¾—å¯æ§ã€‚</p>
<p>5.æ•°å­—äººè¡¨ç°åª²ç¾å®æ‹ï¼šæ•°å­—äººå£å‹åŠ¨ä½œè‡ªç„¶ï¼Œæœ€å…³é”®çš„æ˜¯æ‰‹æŒäº§å“éå¸¸ç¨³å®šï¼Œå¯ä»¥æ›¿ä»£æ˜‚è´µçš„å¤–ç±æ¨¡ç‰¹ã€‚</p>
<p>6.é™æœ¬å¢æ•ˆï¼šç”¨å‡ å—é’±çš„ç®—åŠ›æˆæœ¬ï¼Œåšå‡ºäº†å‡ åƒå—çš„å®æ‹æ•ˆæœï¼Œå¯¹äºéœ€è¦å¤§é‡é“ºç´ æçš„è·¨å¢ƒå–å®¶æ¥è¯´ï¼Œè¿™æ˜¯çº¯åˆ©æ¶¦ï¼ˆçœ‹äº†ä¸‹ï¼Œå•ä¸ªè§†é¢‘ç”Ÿæˆçš„ä»·æ ¼åœ¨3å…ƒåˆ°åå‡ å…ƒä¸ç­‰ï¼‰ã€‚</p>
<p>æˆ‘å…ˆçœ‹äº†ä¸€ä¸‹Hilightçš„æ¶æ„å›¾ï¼Œå…ˆä¸çœ‹ä¸Šé¢å¤æ‚çš„å·¥ç¨‹å®ç°ï¼Œæœ€åº•å±‚çš„æ¨¡å‹é˜µå®¹ç›´æ¥å°±æŠŠæˆ‘å¸å¼•ä½äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec9473933e764f698cb18af61d5e77ee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=Q1MKlm32LaVCMjqQ04MxZ7g3Wnk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æœ‰å†™ä½œç¬¬ä¸€çš„Gemini 3ï¼Œç”Ÿå›¾ç¬¬ä¸€çš„é¦™è•‰Proï¼ˆNanoBanana Proï¼‰ï¼ŒéŸ³ç”»åŒæ­¥å¤©èŠ±æ¿Sora2 å’Œ Veo3.1ï¼Œæ•°å­—äººç•Œçš„è€å¤§HeyGenã€‚</p>
<p>è¯´å®è¯ï¼Œæˆ‘ç¬¬ä¸€çœ¼å°±å¯¹å®ƒçš„ã€Œä¸€é”®æˆç‰‡ã€äº§ç”Ÿäº†æµ“åšå…´è¶£ï¼Œæ„Ÿè§‰ä¼šéå¸¸æ–¹ä¾¿ï¼Œä¹Ÿæ˜¯æˆ‘è‡ªå·±åšå¹³å°æ²¡æœ‰æƒ³åˆ°çš„åŠŸèƒ½ã€‚</p>
<p>æˆ‘å…ˆåœ¨äºšé©¬é€Šä¸Šæ‰¾ä¸€æ¬¾é”€é‡æ¯”è¾ƒé«˜çš„åŒ…</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/053b01b9522c4126a4ddc2428e5142a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=aclTXOC%2B%2Fpa%2FdGGL6v6lfjN6vio%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æŠŠå®ƒçš„å•†å“é“¾æ¥å¤åˆ¶ä¸‹æ¥ï¼Œä¸¢ç»™Hilightã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27582c41049a4b038c8f345ada354a0d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=efmmkLn5eOuTLTftM9omEtHFmYc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™é‡Œæˆ‘é€‰æ‹©æ™ºèƒ½æˆç‰‡åŠŸèƒ½ï¼Œåªéœ€è¦ä¸€ä¸ªäºšé©¬é€Šå•†å“é“¾æ¥å°±å¯ä»¥ç”Ÿæˆå•†å“å›¾ç‰‡ï¼Œè§†é¢‘æ–‡æ¡ˆã€‚</p>
<p>å¯¼å…¥å•†å“é“¾æ¥ä¹‹åï¼ŒAIè‡ªåŠ¨å¼€å§‹åˆ†æã€‚å®ƒåƒä¸€ä¸ªç»éªŒä¸°å¯Œçš„è¿è¥ï¼Œè‡ªåŠ¨æ¢³ç†å‡ºäº†äº§å“å–ç‚¹ã€ç›®æ ‡å—ä¼—ã€è¥é”€èŠ‚ç‚¹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ffecfaafde647a78814ae6165512b9e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=lzKEUC%2B30yHPxG7zU8KM3UD61wE%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªç¯èŠ‚ï¼Œä¹Ÿå¯ä»¥è‡ªå·±è°ƒæ•´ä¸€äº›é…ç½®ï¼Œæ¯”å¦‚å›¾ç‰‡ã€æ–‡æ¡ˆã€ç›®æ ‡å—ä¼—ã€è§†é¢‘è¯­è¨€ã€è§†é¢‘æ¯”ä¾‹ç­‰ç­‰ï¼Œéå¸¸çµæ´»ã€‚</p>
<p>ç‚¹å‡»å³ä¸‹è§’ã€Œä¸€é”®æˆç‰‡ã€ä¹‹åï¼Œå°±å¯ä»¥å–æ¯å’–å•¡ç­‰å®ƒè‡ªå·±ç”Ÿæˆäº†ï¼Œæ•´ä¸ªè¿‡ç¨‹æˆ‘æ²¡æœ‰å¹²é¢„è¿‡å®ƒã€‚</p>
<p>æ•´ä¸ªç”Ÿæˆè¿‡ç¨‹æˆ‘ç»™å¤§å®¶å½•äº†ä¸ªè§†é¢‘ï¼Œå¯ä»¥ä»”ç»†çœ‹çœ‹é‚£ä¸ªLoadingé¡µé¢ï¼Œéå¸¸æœ‰æ„æ€ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e96918dca4ec4454bee2c1a621744ab3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=SGWUHHas1KM1AHkvRNwQWrJQ3yE%3D" alt="wxv_4366284068745756689" loading="lazy"/></p>
<p>çœ‹ç€Agentä»¬å­å“§å­å“§å¹²æ´»çš„æ ·å­ï¼Œè¿˜æŒºè§£å‹çš„ã€‚</p>
<p>åƒäº†ä¸ªé¥­å›æ¥ï¼Œå·²ç»ç”Ÿæˆå¥½äº†ï¼Œè¿«ä¸åŠå¾…æ‰“å¼€æˆç‰‡</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c6463a4dd4340979f7eb0293937da31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=RmkR8y5FKR%2BjcfKdT8fdxcfyIGM%3D" alt="wxv_4366341894692356106" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°è§†é¢‘ä¸­çš„æ•°å­—äººæ‰‹æŒåŒ…åŒ…è®²è§£éå¸¸è‡ªç„¶ï¼Œè§†é¢‘å‰åçš„ä¹Ÿå¾ˆè¿è´¯ã€‚ä»å¼€å¤´çš„è§†é¢‘ä¸­ä¹Ÿèƒ½çœ‹å‡ºï¼Œå³ä¾¿æœ‰åœºæ™¯å˜æ¢ï¼Œå•†å“ä¹Ÿèƒ½ä¿æŒä¸å˜ã€‚</p>
<p>è¿™å°±æ˜¯Hilightä¼˜åŠ¿ä¹‹ä¸€ï¼šå•†å“/äººç‰©è·¨å¸§ä¸€è‡´æ€§</p>
<p>è¦çŸ¥é“ï¼Œç°åœ¨å¸‚é¢ä¸Šçš„å¾ˆå¤šAIè§†é¢‘æ¨¡å‹ï¼Œç”Ÿæˆå‡ºæ¥çš„äººç‰©å’Œå•†å“ç»å¸¸ä¼šå˜å½¢ã€‚æ¯”å¦‚ä¸Šä¸€ç§’æ¨¡ç‰¹æ‰‹é‡Œæ‹¿ç€çš„æ˜¯Aæ¬¾ç©å…·ï¼Œä¸‹ä¸€ç§’é•œå¤´åˆ‡æ¢å¯èƒ½å°±å˜æˆBæ¬¾äº†ï¼Œæˆ–è€…æ‰‹ç›´æ¥ç©¿æ¨¡ç©¿è¿›äº†ç©å…·é‡Œã€‚</p>
<p>ä½†Hilightç”Ÿæˆçš„è§†é¢‘ï¼Œåšç€å„ç§å±•ç¤ºåŠ¨ä½œï¼Œä¹Ÿæœ‰æ‰‹æŒå•†å“çš„å±•ç¤ºï¼Œç”šè‡³è¿˜æœ‰å°çª—å£è®²è§£ï¼ŒçœŸå°±åƒæ˜¯è¯·äº†æ¨¡ç‰¹å®æ‹ä¸€æ ·ã€‚</p>
<p>è¿™ç§ä¸€è‡´æ€§æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ</p>
<p>1.åŸºäºçŸ¥è¯†å›¾è°±ï¼šHilightä¸åªæ˜¯åœ¨ç”Ÿæˆåƒç´ ï¼Œæ˜¯åœ¨ç†è§£äº§å“ã€‚å®ƒä¼šå…ˆåŸºäºå•†å“çŸ¥è¯†å›¾è°±ï¼ŒæŠŠäº§å“çš„æè´¨ã€ç‰ˆå‹ã€ç»“æ„æ‹†è§£å¾—æ˜æ˜ç™½ç™½ï¼ˆæ¯”å¦‚æ˜¯äºšéº»è¿˜æ˜¯ä¸ç»¸ï¼‰ï¼Œæ„å»ºä¸€ä¸ªå…¨ç»´åº¦çš„ä¿¡æ¯åŸºåº§ï¼Œä»æºå¤´ä¸Šé˜²æ­¢AIçç¼–ä¹±é€ ã€‚</p>
<p>2.Nå®«æ ¼å…¨è§†è§’è¾“å…¥ï¼šHilightæ ¹æ®å•†å“é“¾æ¥/å•†å“å›¾ç­‰ä¿¡æ¯è‡ªåŠ¨è§£æç”Ÿæˆæ­£ã€ä¾§ã€èƒŒç­‰å¤šè§†è§’ç´ æï¼Œè®©æ¨¡å‹æ‹¥æœ‰äº†å®Œæ•´çš„3Dç©ºé—´ç†è§£åŠ›ã€‚è¿™æ ·æ— è®ºé•œå¤´æ€ä¹ˆè¿é•œã€æ—‹è½¬ï¼ŒAIéƒ½çŸ¥é“è¿™ä¸ªå•†å“çš„èƒŒé¢å’Œä¾§é¢é•¿ä»€ä¹ˆæ ·ï¼Œè¿›ä¸€æ­¥ç¡®ä¿ä¸€è‡´æ€§ã€‚</p>
<p>3.å¤šAgentç‰©ç†çº§è´¨æ£€ï¼šè¿™æ˜¯æœ€åä¸€é“é˜²çº¿ï¼ŒHilightä¸“é—¨å®‰æ’äº†è‡ªæ£€Agentåœ¨ç”Ÿæˆåè¿›è¡ŒåŒé‡æ‰«æï¼Œä¸€æŸ¥æ¬¾å¼é¢œè‰²å¯¹ä¸å¯¹ï¼ˆå®ä½“æ ¡éªŒï¼‰ï¼ŒäºŒæŸ¥æœ‰æ²¡æœ‰æ‰‹ç©¿è¿›ç“¶å­ã€ç‰©ä½“æ‚¬ç©ºç­‰ç‰©ç†Bugï¼ˆé€»è¾‘æ ¡éªŒï¼‰ï¼Œè¿›ä¸€æ­¥ç¡®ä¿ç¬¦åˆçœŸå®ä¸–ç•Œçš„ç‰©ç†è§„å¾‹ã€‚</p>
<p>åŒæ—¶å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªè§†é¢‘ç”Ÿæˆæ¨¡å‹ï¼Œæ›´æ˜¯ä¸€ä¸ªç”±å¤šä¸ªAI Agentç»„æˆçš„å¤šæ™ºèƒ½ä½“å›¢é˜Ÿã€‚</p>
<p>å¤§å®¶çœ‹è¿™å¼ å›¾</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2323023a89cf4ffc8e61031cc4ae58c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=mpPTWBFovHl8s%2BxaSEE9Q84SNv8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨ç”Ÿæˆç¯èŠ‚ï¼Œæœ‰10å¤šä¸ªAgentå‚ä¸åä½œ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64f43b1118354dc6a93536e4c420b0a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=odR3zB9jqYd9h%2FEkX04WdzUkKmE%3D" alt="å›¾ç‰‡" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/><img src="" alt="" loading="lazy"/></p>
<p>æœ‰è´Ÿè´£Briefç†è§£çš„Agentï¼Œå®ƒåƒç­–åˆ’æ€»ç›‘ä¸€æ ·ï¼Œåˆ†æä½ è¦æ‹ä»€ä¹ˆã€ç»™è°çœ‹ï¼›</p>
<p>æœ‰è´Ÿè´£åˆ›æ„çš„Agentï¼Œå®ƒåƒç¼–å‰§ä¸€æ ·ï¼Œè®¾è®¡è„šæœ¬å’Œåˆ†é•œï¼›</p>
<p>æœ‰è´Ÿè´£ç´ æåŒ¹é…çš„Agentï¼Œå®ƒå†³å®šæ¯ä¸ªé•œå¤´ç”¨ä»€ä¹ˆç´ ææœ€åˆé€‚ã€‚Â </p>
<p>è¿˜æœ‰è´Ÿè´£å‰ªè¾‘å’Œè´¨æ£€çš„Agentï¼Œç¡®ä¿æœ€ç»ˆæˆç‰‡çš„è´¨é‡ã€‚</p>
<p>å¦‚æœç”Ÿæˆçš„æŸä¸ªåˆ†é•œæ•ˆæœä¸å¥½ï¼Œå®ƒçš„å†…éƒ¨Agentä¼šäº’ç›¸åå•†ã€å›é€€ï¼Œé‡æ–°ç”Ÿæˆï¼Œç›´åˆ°æ»¡æ„ä¸ºæ­¢ã€‚</p>
<p>åœ¨æƒå¨è§†é¢‘ç”Ÿæˆè¯„æµ‹åŸºå‡† VBench çš„æ ¸å¿ƒç»´åº¦æµ‹è¯•ä¸­ï¼ŒHilight AI åœ¨è¥é”€è§†é¢‘é¢†åŸŸæœ€çœ‹é‡çš„ã€ŒèƒŒæ™¯ä¸€è‡´æ€§ã€ã€ã€Œä¸»ä½“ä¸€è‡´æ€§ã€å’Œã€Œç¾å­¦è´¨é‡ã€å‡åœ¨è¡Œä¸šå‰åˆ—ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6ec6fbded6841c6a489e1b512cfc61a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnooovpvKDluJ0=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770524523&amp;x-signature=aWbkmVAAcoDF%2BNGudD2qcJ9uEkI%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>åœ¨ã€Œæˆåƒè´¨é‡ã€ç»´åº¦ä¹Ÿå±•ç°å‡ºç¨³å¥çš„ç«äº‰åŠ›ï¼Œè¿™å—è¶…è¶Šäº†å›½å¤–é¡¶çº§æ¨¡å‹Sora</p>
<h3 data-id="heading-1">å†™åœ¨æœ€å</h3>
<p>æˆ‘æ„Ÿè§‰éšç€AIæ¨¡å‹èƒ½åŠ›è¶Šæ¥è¶Šå¼ºï¼Œ26å¹´æ˜¯åšå‚ç›´åœºæ™¯åº”ç”¨æœºä¼šæ›´å¤§çš„ä¸€å¹´</p>
<p>è¯´åˆ°åº•ï¼Œæƒ³è¦åœ¨æµ·å¤–å–çˆ†äº§å“ï¼Œæ ¸å¿ƒè¿˜æ˜¯è¦æ‰¾åˆ°ç—›ç‚¹ï¼Œå¼•çˆ†æµé‡ï¼Œè§¦è¾¾æ›´ç²¾å‡†çš„äººç¾¤ï¼Œåšè§†é¢‘è¿™ä¸€æ­¥æ˜¯å…¶ä¸­æœ€å¤§çš„æ‹¦è·¯è™ä¹‹ä¸€ï¼Œå¦‚æœæœ‰æ›´ä½æˆæœ¬æ›´å¿«é€Ÿçš„æ–¹æ¡ˆï¼Œä½•ä¹è€Œä¸ä¸ºå‘¢ã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬åšè§†é¢‘ï¼Œè¦ä¹ˆèŠ±å¤§é’±è¯·äººæ‹ï¼Œè¦ä¹ˆèŠ±æ—¶é—´è‡ªå·±å‰ªã€‚</p>
<p>ç°åœ¨æœ‰äº†Hilightè¿™æ ·çš„å·¥å…·ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå•†å“é“¾æ¥ï¼Œå°±èƒ½æ›´å¿«çš„è·å¾—ä¸€æ¡ç”šè‡³å¤šæ¡è¥é”€è§†é¢‘ã€‚</p>
<p>å¯¹äºç”µå•†å–å®¶æ¥è¯´ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥ç”¨æ›´ä½çš„æˆæœ¬ï¼Œå»æµ‹è¯•æ›´å¤šçš„çˆ†æ¬¾ï¼Œå»è¦†ç›–æ›´å¤šçš„æµé‡æ¸ é“ã€‚</p>
<p>äº†è§£å’Œä½“éªŒäº†é‚£ä¹ˆå¤šå®¶Multi-Agentï¼Œæˆ‘å‘ç°Hilightæ˜¯ç¬¬ä¸€å®¶æŠŠå¤šAgentå¼•å…¥ç”µå•†è¥é”€è§†é¢‘é¢†åŸŸçš„ï¼Œé€šè¿‡å¤šAgentæŠŠè‡ªåŠ¨ç”Ÿæˆè¥é”€è§†é¢‘è¿™äº‹å„¿åšæˆäº†ï¼Œä¸å¾—ä¸è¯´æ˜¯ç”µå•†è¥é”€é¢†åŸŸçš„ä¸€æ¬¡é‡å¤§çªç ´ã€‚</p>
<p>æˆ‘æ˜¯è¢‹é¼ å¸ï¼Œä¸€ä¸ªåœ¨è¿™ä¸ªAIæ—¶ä»£ï¼ŒæŒç»­åˆ†äº«AIå®è·µå¹²è´§ï¼Œé™ªä½ ä¸€èµ·è¿›åŒ–çš„æ•°å­—æ¸¸æ°‘ã€‚</p>
<p>ç‚¹å‡»å…³æ³¨ä¸‹æ–¹è´¦å·ï¼Œä½ å°†æ„Ÿå—åˆ°ä¸€ä¸ªæœ‹å…‹çš„çµé­‚ã€‚</p>
<p>èƒ½çœ‹åˆ°è¿™é‡Œçš„éƒ½æ˜¯å‡¤æ¯›éºŸè§’çš„å­˜åœ¨ï¼</p>
<p>å¦‚æœè§‰å¾—ä¸é”™ï¼Œéšæ‰‹ç‚¹ä¸ªèµã€åœ¨çœ‹ã€è½¬å‘ä¸‰è¿å§~</p>
<p>å¦‚æœæƒ³ç¬¬ä¸€æ—¶é—´æ”¶åˆ°æ¨é€ï¼Œä¹Ÿå¯ä»¥ç»™æˆ‘ä¸ªæ˜Ÿæ ‡â­</p>
<p>è°¢è°¢ä½ è€å¿ƒçœ‹å®Œæˆ‘çš„æ–‡ç« ~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»¥é—®ç­”å½¢å¼æ·±å…¥ç†è§£CAPç†è®º]]></title>    <link>https://juejin.cn/post/7601020578491596809</link>    <guid>https://juejin.cn/post/7601020578491596809</guid>    <pubDate>2026-01-31T15:45:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601020578491596809" data-draft-id="7600787795478282286" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»¥é—®ç­”å½¢å¼æ·±å…¥ç†è§£CAPç†è®º"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-31T15:45:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="dunky"/> <meta itemprop="url" content="https://juejin.cn/user/1538972007804776"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»¥é—®ç­”å½¢å¼æ·±å…¥ç†è§£CAPç†è®º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1538972007804776/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    dunky
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T15:45:19.000Z" title="Sat Jan 31 2026 15:45:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡çš„æ ¸å¿ƒï¼Œå­˜åœ¨ç€ä¸€ä¸ªçœ‹ä¼¼ç®€å•å´æ·±åˆ»å½±å“ç³»ç»Ÿæ¶æ„çš„ç†è®ºâ€”â€”CAPå®šç†ã€‚è‡ª2000å¹´ç”±Eric Breweræå‡ºä»¥æ¥ï¼ŒCAPå·²æˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿé¢†åŸŸçš„â€œé»„é‡‘æ³•åˆ™â€ï¼Œä½†åŒæ—¶ä¹Ÿæ˜¯è¢«è¯¯è§£æœ€å¤šçš„ç†è®ºä¹‹ä¸€ã€‚æœ¬æ–‡å°†ä»åŸºæœ¬å®šä¹‰å‡ºå‘ï¼Œé€šè¿‡å’ŒAIçš„é—®ç­”æ·±å…¥è§£æä¸‹è¿™ä¸ªå¸¸è¢«è¯¯è§£çš„å®šç†ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯CAPç†è®ºï¼Ÿ</h2>
<h3 data-id="heading-1">1.1 å®šç†çš„å®Œæ•´è¯´æ˜</h3>
<p>CAPå®šç†é˜è¿°äº†ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸‰ä¸ªæ ¸å¿ƒå±æ€§ä¹‹é—´çš„æ ¹æœ¬å…³ç³»ï¼š</p>
<p><strong>åœ¨ç½‘ç»œåˆ†åŒºï¼ˆPartitionï¼‰å‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿæ— æ³•åŒæ—¶ä¿è¯å¼ºä¸€è‡´æ€§ï¼ˆConsistencyï¼‰å’Œå¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€‚</strong></p>
<p>è¿™ä¸ªç®€æ´çš„é™ˆè¿°èƒŒåï¼Œæ¯ä¸ªæœ¯è¯­éƒ½æœ‰ä¸¥æ ¼çš„å®šä¹‰ï¼š</p>
<h4 data-id="heading-2">å¼ºä¸€è‡´æ€§ï¼ˆC - Consistencyï¼‰</h4>
<p>ç‰¹æŒ‡<strong>çº¿æ€§ä¸€è‡´æ€§</strong>ï¼Œè¦æ±‚ï¼š</p>
<ul>
<li>ä»»ä½•è¯»æ“ä½œéƒ½èƒ½ç«‹å³çœ‹åˆ°æœ€æ–°å®Œæˆçš„å†™æ“ä½œ</li>
<li>æ‰€æœ‰æ“ä½œçœ‹èµ·æ¥åƒæ˜¯åœ¨å•ä¸ªå‰¯æœ¬ä¸ŠæŒ‰æŸä¸ªå…¨å±€é¡ºåºæ‰§è¡Œ</li>
<li>å…·æœ‰å®æ—¶æ€§çº¦æŸï¼šå¦‚æœæ“ä½œAåœ¨å®é™…æ—¶é—´ä¸Šå…ˆäºæ“ä½œBå¼€å§‹ï¼Œé‚£ä¹ˆAå¿…é¡»åœ¨Bä¹‹å‰</li>
</ul>
<h4 data-id="heading-3">å¯ç”¨æ€§ï¼ˆA - Availabilityï¼‰</h4>
<p>è¦æ±‚æ¯ä¸ªå‘é€åˆ°<strong>éæ•…éšœèŠ‚ç‚¹</strong>çš„è¯·æ±‚ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨<strong>æœ‰é™æ—¶é—´å†…</strong>è·å¾—å“åº”</li>
<li>å“åº”å¿…é¡»æ˜¯<strong>éé”™è¯¯çš„</strong>ï¼ˆä½†å¯ä»¥æ˜¯æ—§æ•°æ®æˆ–å»¶è¿Ÿç”Ÿæ•ˆçš„ç¡®è®¤ï¼‰</li>
<li>é€‚ç”¨äº100%çš„è¯·æ±‚ï¼Œä¸æ˜¯â€œå¤§å¤šæ•°â€è¯·æ±‚</li>
</ul>
<h4 data-id="heading-4">åˆ†åŒºå®¹é”™æ€§ï¼ˆP - Partition Toleranceï¼‰</h4>
<p>æŒ‡ç³»ç»Ÿåœ¨ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ï¼š</p>
<ul>
<li>èƒ½å¤Ÿç»§ç»­æŒ‰ç…§é¢„å®šç­–ç•¥è¿è¡Œ</li>
<li>ç½‘ç»œåˆ†åŒºæŒ‡èŠ‚ç‚¹é—´é€šä¿¡ä¸­æ–­ï¼Œä½†èŠ‚ç‚¹æœ¬èº«å¯èƒ½æ­£å¸¸è¿è¡Œ</li>
<li>æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„<strong>å¿…é€‰é¡¹</strong>ï¼Œå› ä¸ºç½‘ç»œä¸å¯é æ˜¯ç°å®</li>
</ul>
<h3 data-id="heading-5">1.2 å…³é”®æ´å¯Ÿï¼šçœŸæ­£çš„é€‰æ‹©</h3>
<p>CAPå®šç†æœ€å¸¸è¢«è¯¯è§£ä¸ºâ€œä¸‰é€‰äºŒâ€ï¼Œä½†å®é™…ä¸Šï¼š</p>
<ul>
<li><strong>Pæ˜¯å¼ºåˆ¶æ€§çš„</strong>ï¼šåªè¦ç³»ç»Ÿæ˜¯åˆ†å¸ƒå¼çš„ï¼Œå°±å¿…é¡»è€ƒè™‘ç½‘ç»œåˆ†åŒº</li>
<li><strong>çœŸæ­£çš„é€‰æ‹©æ˜¯Cå’ŒAä¹‹é—´çš„æƒè¡¡</strong>ï¼šåˆ†åŒºå‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿå¿…é¡»ä¼˜å…ˆä¿è¯å“ªä¸€ä¸ª</li>
<li><strong>æ— åˆ†åŒºæ—¶å¯ä»¥åŒæ—¶ä¿è¯CA</strong>ï¼šå®šç†åªçº¦æŸåˆ†åŒºå‘ç”Ÿæ—¶çš„è¡Œä¸º</li>
</ul>
<h2 data-id="heading-6">äºŒã€æ·±å…¥å‰–ææ¯ä¸ªç»´åº¦çš„çœŸå®å«ä¹‰</h2>
<h3 data-id="heading-7">2.1 ä¸ºä»€ä¹ˆCAPä¸­çš„â€œAâ€è¿™ä¹ˆä¸¥æ ¼ï¼Ÿ</h3>
<p>å¯ç”¨æ€§Açš„å®šä¹‰ï¼šç³»ç»Ÿä¸­<strong>æ¯ä¸ªæ²¡æœ‰æ•…éšœçš„èŠ‚ç‚¹æ¥æ”¶åˆ°çš„æ¯ä¸ªè¯·æ±‚</strong>ï¼Œ<strong>éƒ½å¿…é¡»å¾—åˆ°ä¸€ä¸ªéé”™çš„å“åº”</strong>ã€‚è¡¨æ˜100%çš„è¯·æ±‚åœ¨æœ‰é™æ—¶é—´å¿…é¡»è·å¾—ä¸€ä¸ªæœ‰æ„ä¹‰çš„å“åº”ã€‚</p>
<p>å¯è§CAPçš„Aæ˜¯ä¸€ä¸ª<strong>ç†è®ºä¸Šçš„æç«¯è¦æ±‚</strong>ï¼Œç°å®ç³»ç»Ÿæ— æ³•çœŸæ­£æ»¡è¶³ã€‚ä½†è¿™æ­£æ˜¯CAPå®šç†çš„ä»·å€¼â€”â€”å®ƒæ­ç¤ºäº†<strong>ç†æƒ³ä¸–ç•Œä¸­çš„æ ¹æœ¬é™åˆ¶</strong>ã€‚</p>






























<table><thead><tr><th>ç»´åº¦</th><th>CAPçš„A</th><th>å·¥ç¨‹é«˜å¯ç”¨</th></tr></thead><tbody><tr><td>å®šä¹‰</td><td>100%è¯·æ±‚å¿…é¡»å“åº”</td><td>ç³»ç»Ÿæ€»ä½“å¯ç”¨æ—¶é—´ç™¾åˆ†æ¯”</td></tr><tr><td>åº¦é‡</td><td>äºŒå…ƒï¼ˆæ»¡è¶³/ä¸æ»¡è¶³ï¼‰</td><td>è¿ç»­ï¼ˆ99.9%ã€99.99%ç­‰ï¼‰</td></tr><tr><td>ç²’åº¦</td><td>è¯·æ±‚çº§åˆ«</td><td>ç³»ç»Ÿ/æœåŠ¡çº§åˆ«</td></tr><tr><td>å¯å®ç°æ€§</td><td><strong>ç†è®ºæé™ï¼Œå®é™…æ— æ³•è¾¾åˆ°</strong></td><td>ç°å®å¯è¿½æ±‚çš„ç›®æ ‡</td></tr></tbody></table>
<p>è¯´æ˜ï¼š</p>
<ul>
<li><strong>ç†è®ºè¯æ˜çš„éœ€è¦</strong> ï¼š CAPå®šç†æ˜¯ä¸€ä¸ªæ•°å­¦è¯æ˜ï¼Œæ•°å­¦è¯æ˜éœ€è¦ç²¾ç¡®å®šä¹‰ï¼Œ"A"å¿…é¡»æ˜ç¡®å®šä¹‰ä¸º"100%è¯·æ±‚å“åº”"ï¼Œå¦åˆ™è¯æ˜æ— æ³•è¿›è¡Œ</li>
<li><strong>æ­ç¤ºçŸ›ç›¾</strong>ï¼šå¦‚æœæ”¾å®½Açš„å®šä¹‰ï¼Œå¦‚"å…è®¸5%è¯·æ±‚å¤±è´¥"ï¼Œé‚£ä¹ˆå¯ä»¥è®¾è®¡æ—¢æ»¡è¶³è¿™ä¸ªAåˆæ»¡è¶³Cçš„ç³»ç»Ÿï¼Œä½†è¿™æ ·å°±æ²¡æœ‰ç†è®ºä»·å€¼äº†ï¼Œæç«¯å®šä¹‰æ‰èƒ½æ­ç¤ºæç«¯çŸ›ç›¾</li>
<li><strong>ç°å®å‚è€ƒ</strong>ï¼šç°å®ç³»ç»Ÿè™½ç„¶æ— æ³•è¾¾åˆ°CAPçš„Aï¼Œä½†å¯ä»¥å°½å¯èƒ½æ¥è¿‘ï¼š â‘ æŒ‡å¯¼è®¾è®¡æ–¹å‘ï¼šå°½å¯èƒ½æ¥è¿‘ â‘¡ è®¾å®šåˆç†æœŸæœ›ï¼šçŸ¥é“å·®è·å¤šå¤§  â‘¢åšå‡ºæ˜æ™ºæƒè¡¡ï¼šåœ¨Cå’ŒAé—´é€‰æ‹© â‘£ é¿å…ä¸åˆ‡å®é™…ï¼šä¸æ‰¿è¯ºæ— æ³•å®ç°çš„</li>
</ul>
<h3 data-id="heading-8">2.2 ä¸ºä»€ä¹ˆå¯ç”¨æ€§Açš„æè¿°è¦å¼ºè°ƒâ€œæ²¡æœ‰æ•…éšœçš„èŠ‚ç‚¹â€ï¼Ÿ</h3>
<p>å¦‚æœè¦æ±‚<strong>æ‰€æœ‰èŠ‚ç‚¹</strong>ï¼ˆåŒ…æ‹¬æ•…éšœèŠ‚ç‚¹ï¼‰éƒ½å¿…é¡»å“åº”ï¼šé‚£ä»»ä½•èŠ‚ç‚¹å¯èƒ½æ•…éšœï¼ˆç¡¬ä»¶æŸåã€æ–­ç”µç­‰ï¼‰ï¼Œä¸€æ—¦æœ‰èŠ‚ç‚¹æ•…éšœï¼Œç³»ç»Ÿå°±æ— æ³•æ»¡è¶³Aã€‚é‚£ä»»ä½•å®é™…ç³»ç»Ÿéƒ½æ— æ³•æ»¡è¶³CAPï¼Œåˆ™CAPå®šç†å˜å¾—æ— æ„ä¹‰</p>
<p><strong>å› æ­¤"éæ•…éšœèŠ‚ç‚¹"æ˜¯è®©CAPå®šç†æœ‰ç°å®è®¨è®ºä»·å€¼çš„å‰ææ¡ä»¶ã€‚</strong></p>
<p>CAPå®šç†è¦å›ç­”çš„æ ¸å¿ƒé—®é¢˜ï¼š"å½“ç½‘ç»œå°†å¥åº·çš„èŠ‚ç‚¹éš”ç¦»æ—¶ï¼Œç³»ç»Ÿå¦‚ä½•è¡¨ç°ï¼Ÿ"ä¸æ˜¯è¦å›ç­”ï¼š"å½“èŠ‚ç‚¹ç¡¬ä»¶æ•…éšœæ—¶ï¼Œç³»ç»Ÿå¦‚ä½•è¡¨ç°ï¼Ÿâ€ï¼Œå› ä¸ºåè€…å·²æœ‰æˆç†Ÿæ–¹æ¡ˆï¼šå†—ä½™ã€å¤åˆ¶ã€æ•…éšœè½¬ç§»ã€‚</p>
<h3 data-id="heading-9">2.3 CAPçš„â€œCâ€ä¸ºä»€ä¹ˆè¦å¼ºè°ƒâ€œå¼ºä¸€è‡´æ€§â€ï¼Ÿ</h3>
<p>å¼ºä¸€è‡´æ€§å³ä¸ºçº¿æ€§ä¸€è‡´æ€§ã€‚æŒ‡çš„æ˜¯ï¼šä»»ä½•è¯»æ“ä½œéƒ½èƒ½ç«‹å³çœ‹åˆ°æœ€æ–°å®Œæˆçš„å†™æ“ä½œã€‚CAPå®šç†çš„æ•°å­¦è¯æ˜åŸºäºçº¿æ€§ä¸€è‡´æ€§çš„ä¸¥æ ¼å®šä¹‰ï¼Œå¦‚æœæ”¾å®½åˆ°å¼±ä¸€è‡´æ€§ï¼Œå®šç†å°±ä¸æˆç«‹äº†ã€‚å„ä¸€è‡´æ€§å«ä¹‰å¦‚ä¸‹ï¼š</p>



































<table><thead><tr><th>ä¸€è‡´æ€§çº§åˆ«</th><th>CAPä¸­çš„Cï¼Ÿ</th><th>åˆ†åŒºæ—¶èƒ½å¦ä¸Aå…±å­˜ï¼Ÿ</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>çº¿æ€§ä¸€è‡´æ€§ï¼ˆå¼ºä¸€è‡´ï¼‰</strong></td><td>âœ… æ˜¯</td><td>âŒ ä¸èƒ½ï¼ˆCAPå®šç†ï¼‰</td><td>é“¶è¡Œä½™é¢</td></tr><tr><td><strong>é¡ºåºä¸€è‡´æ€§</strong></td><td>âŒ ä¸æ˜¯</td><td>å¯èƒ½å¯ä»¥</td><td>æŸäº›åˆ†å¸ƒå¼é”</td></tr><tr><td><strong>å› æœä¸€è‡´æ€§</strong></td><td>âŒ ä¸æ˜¯</td><td>å¯ä»¥</td><td>ç¤¾äº¤ç½‘ç»œè¯„è®º</td></tr><tr><td><strong>æœ€ç»ˆä¸€è‡´æ€§</strong></td><td>âŒ ä¸æ˜¯</td><td>âœ… å¯ä»¥</td><td>DNSã€CDN</td></tr></tbody></table>
<p>ä¸ºä»€ä¹ˆCAPåªè®¨è®ºæœ€å¼ºçš„Cï¼Ÿ</p>
<p>å› ä¸ºè¿™æ˜¯æœ€æœ‰æ„ä¹‰çš„è¾¹ç•Œæƒ…å†µï¼š</p>
<ul>
<li><strong>æœ€å¼ºä¸€è‡´æ€§</strong>Â vsÂ <strong>å¯ç”¨æ€§</strong>ï¼šæ˜ç¡®çš„äº’æ–¥å…³ç³»</li>
<li>å¦‚æœè¿æœ€å¼ºä¸€è‡´æ€§éƒ½ä¸èƒ½ä¸Aï¼ˆå¯ç”¨æ€§ï¼‰å…±å­˜ï¼Œé‚£ä¹ˆä»»ä½•æ›´å¼ºçš„ä¸€è‡´æ€§ä¹Ÿä¸èƒ½</li>
<li>è¿™ä¸ºç³»ç»Ÿè®¾è®¡æä¾›äº†æ¸…æ™°çš„å†³ç­–æ¡†æ¶</li>
</ul>
<p><strong>æ€»ç»“</strong></p>
<p><strong>CAPä¸­çš„Cå¿…é¡»å¼ºè°ƒæ˜¯å¼ºä¸€è‡´æ€§ï¼ˆçº¿æ€§ä¸€è‡´æ€§ï¼‰ï¼š</strong></p>
<ol>
<li><strong>ç†è®ºå¿…é¡»</strong>ï¼šCAPå®šç†çš„æ•°å­¦è¯æ˜åŸºäºçº¿æ€§ä¸€è‡´æ€§</li>
<li><strong>å®è·µå¿…è¦</strong>ï¼šåªæœ‰å¼ºä¸€è‡´æ‰ä¼šä¸å¯ç”¨æ€§äº’æ–¥</li>
<li><strong>é¿å…æ··æ·†</strong>ï¼šå¼±ä¸€è‡´æ€§ç³»ç»Ÿå®é™…å±äºAPèŒƒç•´</li>
<li><strong>è®¾è®¡æŒ‡å¯¼</strong>ï¼šæ˜ç¡®é€‰æ‹©æ‰èƒ½æ­£ç¡®è®¾è®¡ç³»ç»Ÿ</li>
</ol>
<p><strong>ç®€å•è®°å¿†</strong>ï¼š</p>
<ul>
<li>CAPä¸­çš„C =Â <strong>å¼ºä¸€è‡´æ€§</strong>ï¼ˆçº¿æ€§ä¸€è‡´æ€§ï¼‰</li>
<li>å¦‚æœé€‰æ‹©å¼±ä¸€è‡´æ€§ï¼Œä½ å®é™…é€‰æ‹©äº†APæ–¹å‘</li>
<li>CAPå®šç†æè¿°çš„æ˜¯<strong>æœ€å¼ºä¸€è‡´æ€§</strong>ä¸<strong>å¯ç”¨æ€§</strong>çš„äº’æ–¥å…³ç³»</li>
</ul>
<p>è¿™ä¸ªå¼ºè°ƒå¯¹äºæ­£ç¡®ç†è§£å’Œåº”ç”¨CAPå®šç†è‡³å…³é‡è¦ã€‚</p>
<h3 data-id="heading-10">2.4 ä¸ºä»€ä¹ˆå¿…é¡»è€ƒè™‘Pï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰</h3>
<p>Pæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„<strong>å¿…é€‰é¡¹</strong>è€Œéå¯é€‰é¡¹ï¼Œå› ä¸ºï¼š</p>
<ul>
<li>ç½‘ç»œæ•…éšœä¸æ˜¯å¼‚å¸¸ï¼Œè€Œæ˜¯å¸¸æ€</li>
<li>åœ¨å¤§è§„æ¨¡ç³»ç»Ÿä¸­ï¼Œåˆ†åŒºå‡ ä¹å¿…ç„¶å‘ç”Ÿ</li>
<li>è®¾è®¡ç³»ç»Ÿæ—¶å¿…é¡»åŸºäºâ€œç½‘ç»œä¼šå‡ºé—®é¢˜â€çš„å‰æ</li>
</ul>
<p>Pæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„å‰æï¼Œ<strong>çœŸæ­£çš„æŠ‰æ‹©æ˜¯åˆ†åŒºå‘ç”Ÿæ—¶é€‰æ‹©Cè¿˜æ˜¯A</strong>ã€‚ä¸€ä¸ªæœ€å¸¸è§çš„è¯¯åŒºæ˜¯â€œCAPæ˜¯Cã€Aã€Pä¸‰é€‰äºŒâ€ï¼Œè¿™æ˜¯å¯¹CAPæœ€å¤§çš„è¯¯è§£ã€‚å®é™…Pæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼ºåˆ¶è¦æ±‚ï¼Œå› ä¸ºç½‘ç»œä¸å¯é æ˜¯ç°å®ã€‚</p>
<p>è¿˜æœ‰å¦ä¸€ä¸ªè¯¯åŒºæ˜¯ä¸åŠ ä»»ä½•å‰æå°±è¯´Cå’ŒAåªèƒ½äºŒé€‰ä¸€ï¼Œåªæœ‰åœ¨åˆ†åŒºæƒ…å†µä¸‹æ‰éœ€è¦é€‰æ‹©ï¼Œæ­£å¸¸æƒ…å†µä¸‹Aã€Pæ˜¯å¯ä»¥å…±å­˜çš„ã€‚</p>
<h3 data-id="heading-11">2.5 åˆ†åŒºå®¹é”™æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒæŸä¸€å°æˆ–å‡ å°å‘ç”Ÿä¸å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œæ•´ä¸ªç³»ç»Ÿä»èƒ½æä¾›æœåŠ¡ã€‚è¿™ä¸ªè¯´æ³•å¯¹ä¹ˆï¼Ÿ</h3>
<p>è¿™ä¸ªæè¿°ä¸å®Œå…¨æ­£ç¡®ï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼Œå®ƒæè¿°çš„æ˜¯â€œé«˜å¯ç”¨æ€§â€æˆ–â€œå®¹é”™æ€§â€ï¼Œè€Œä¸æ˜¯ç‰¹æŒ‡â€œåˆ†åŒºå®¹é”™æ€§â€ã€‚åˆ†åŒºå®¹é”™ç‰¹æŒ‡å‘ç”Ÿç½‘ç»œåˆ†åŒºçš„æƒ…å†µä¸‹çš„å¤„ç†ç­–ç•¥ï¼š</p>
<h4 data-id="heading-12">å‡†ç¡®åŒºåˆ†ä¸‰ä¸ªæ¦‚å¿µ</h4>
<h5 data-id="heading-13">1.Â <strong>å®¹é”™æ€§ï¼ˆFault Toleranceï¼‰</strong></h5>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šç³»ç»Ÿä¸­éƒ¨åˆ†ç»„ä»¶å¤±æ•ˆæ—¶ï¼Œç³»ç»Ÿæ•´ä½“ä»èƒ½ç»§ç»­å·¥ä½œ</li>
<li><strong>ä¾‹å­</strong>ï¼šä¸€ä¸ªä¸‰å‰¯æœ¬çš„æ•°æ®åº“ï¼Œä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œç³»ç»Ÿä»èƒ½è¯»å†™</li>
<li><strong>ä¸Šé¢æè¿°çš„æƒ…å†µæ›´æ¥è¿‘è¿™ä¸ª</strong></li>
</ul>
<h5 data-id="heading-14">2.Â <strong>é«˜å¯ç”¨æ€§ï¼ˆHigh Availabilityï¼‰</strong></h5>
<ul>
<li><strong>å®šä¹‰</strong>ï¼šç³»ç»Ÿæä¾›æŒç»­å¯ç”¨çš„æœåŠ¡ï¼Œé€šå¸¸é€šè¿‡å†—ä½™å®ç°</li>
<li><strong>ç›®æ ‡</strong>ï¼šå°½é‡å‡å°‘æœåŠ¡ä¸­æ–­æ—¶é—´</li>
<li><strong>æŒ‡æ ‡</strong>ï¼š99.9%ï¼ˆä¸‰ä¸ªä¹ï¼‰åˆ°99.999%ï¼ˆäº”ä¸ªä¹ï¼‰çš„å¯ç”¨æ€§</li>
</ul>
<h5 data-id="heading-15">3.Â <strong>åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition Toleranceï¼‰</strong></h5>
<ul>
<li><strong>å®šä¹‰</strong>ï¼š<strong>ç³»ç»Ÿåœ¨ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ä»èƒ½ç»§ç»­è¿è¡Œå¹¶æŒ‰é¢„å®šç­–ç•¥æä¾›æœåŠ¡</strong></li>
<li><strong>æ ¸å¿ƒ</strong>ï¼šå¤„ç†çš„æ˜¯<strong>ç½‘ç»œé€šä¿¡æ•…éšœ</strong>ï¼Œè€Œä¸æ˜¯èŠ‚ç‚¹æ•…éšœ</li>
<li><strong>å…³é”®åŒºåˆ«</strong>ï¼šèŠ‚ç‚¹å¯èƒ½éƒ½æ´»ç€ï¼Œä½†å½¼æ­¤<strong>æ— æ³•é€šä¿¡</strong></li>
</ul>
<p>åˆ†åŒºå®¹é”™æ€§ =Â <strong>ç³»ç»Ÿå…·å¤‡åœ¨éƒ¨åˆ†ç½‘ç»œé€šä¿¡ä¸­æ–­æ—¶ï¼Œä»èƒ½æŒ‰é¢„å®šç­–ç•¥ç»§ç»­è¿ä½œçš„èƒ½åŠ›</strong>ã€‚è¿™ä¸ª"é¢„å®šç­–ç•¥"å°±æ˜¯CAPä¸­çš„Cå’ŒAçš„æƒè¡¡ã€‚</p>
<p>åˆ†åŒºå®¹é”™æ€§çš„æ ¸å¿ƒï¼š <strong>ç½‘ç»œé€šä¿¡æ•…éšœ</strong></p>
<pre><code class="hljs language-css" lang="css">åœºæ™¯<span class="hljs-number">1</span>ï¼šèŠ‚ç‚¹æ•…éšœå®¹é”™ï¼ˆæ‚¨æè¿°çš„æƒ…å†µï¼‰
    èŠ‚ç‚¹<span class="hljs-selector-tag">A</span>å®•æœº â†’ èŠ‚ç‚¹<span class="hljs-selector-tag">B</span>å’ŒCä»èƒ½é€šä¿¡ â†’ ç³»ç»Ÿç»§ç»­å·¥ä½œ
    
åœºæ™¯<span class="hljs-number">2</span>ï¼šç½‘ç»œåˆ†åŒºï¼ˆçœŸæ­£çš„åˆ†åŒºå®¹é”™ï¼‰
    èŠ‚ç‚¹<span class="hljs-selector-tag">A</span>ã€<span class="hljs-selector-tag">B</span>ã€Céƒ½æ´»ç€ä¸”è¿è¡Œæ­£å¸¸
    ä½†ç½‘ç»œäº¤æ¢æœºæ•…éšœ â†’ <span class="hljs-selector-tag">A</span>æ— æ³•ä¸<span class="hljs-selector-tag">B</span>ã€Cé€šä¿¡
    ç³»ç»Ÿè¢«åˆ†å‰²ä¸ºä¸¤ä¸ªæ— æ³•é€šä¿¡çš„éƒ¨åˆ†
</code></pre>
<h4 data-id="heading-16">å…·ä½“åœºæ™¯å¯¹æ¯”</h4>
<h5 data-id="heading-17">åœºæ™¯Aï¼šèŠ‚ç‚¹æ•…éšœï¼ˆéåˆ†åŒºåœºæ™¯ï¼‰</h5>
<pre><code class="hljs language-text" lang="text">
[WebæœåŠ¡å™¨1] --- [æ•°æ®åº“ä¸»èŠ‚ç‚¹]  â† å®•æœº!
                /
[WebæœåŠ¡å™¨2] --- [æ•°æ®åº“ä»èŠ‚ç‚¹]  â† è‡ªåŠ¨æå‡ä¸ºä¸»
</code></pre>
<ul>
<li><strong>ç°è±¡</strong>ï¼šä¸€ä¸ªèŠ‚ç‚¹ä¸å¯ç”¨</li>
<li><strong>å¤„ç†</strong>ï¼šæ•…éšœè½¬ç§»ï¼Œå®¢æˆ·ç«¯é‡è¿</li>
<li><strong>ç»“æœ</strong>ï¼šç³»ç»Ÿé€æ˜æ¢å¤ï¼Œç”¨æˆ·å¯èƒ½æ„Ÿè§‰ä¸åˆ°</li>
</ul>
<h5 data-id="heading-18">åœºæ™¯Bï¼šç½‘ç»œåˆ†åŒºï¼ˆçœŸæ­£çš„åˆ†åŒºï¼‰</h5>
<pre><code class="hljs language-text" lang="text">
[åˆ†åŒº1]                  [åˆ†åŒº2]
WebæœåŠ¡å™¨A ----âœ—---- WebæœåŠ¡å™¨B
     |                    |
æ•°æ®åº“Aï¼ˆä¸»ï¼‰        æ•°æ®åº“Bï¼ˆä»ï¼‰
     |                    |
     ----- æ— æ³•é€šä¿¡ ------
</code></pre>
<ul>
<li>
<p><strong>ç°è±¡</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹éƒ½æ´»ç€ï¼Œä½†å½¼æ­¤æ— æ³•é€šä¿¡</p>
</li>
<li>
<p><strong>ä¸¤éš¾é—®é¢˜</strong>ï¼š</p>
<ul>
<li>å¦‚æœä¸¤è¾¹éƒ½æ¥å—å†™å…¥ â†’ æ•°æ®å†²çªï¼ˆè„‘è£‚ï¼‰</li>
<li>å¦‚æœåªè®©ä¸€è¾¹æ¥å—å†™å…¥ â†’ å¦ä¸€è¾¹æœåŠ¡é™çº§</li>
</ul>
</li>
<li>
<p><strong>åˆ†åŒºå®¹é”™æ€§</strong>ï¼šç³»ç»Ÿæœ‰æ˜ç¡®çš„ç­–ç•¥å¤„ç†è¿™ç§ä¸¤éš¾ï¼Œå³Aå’ŒP</p>
</li>
</ul>
<h2 data-id="heading-19">ä¸‰ã€æ·±å…¥æ¢è®¨CAPç†è®º</h2>
<h3 data-id="heading-20">3.1 â€œAâ€æŒ‡çš„æ˜¯100%è¯·æ±‚æœ‰å“åº”ï¼Œè¿™ä¸ªæ¡ä»¶ä¸Šé¢ä¹Ÿè¯´äº†ä¸èƒ½å®ç°ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦è¯´APç³»ç»Ÿï¼Ÿ</h3>
<p>ç¡®å®ï¼Œ<strong>CAPå®šä¹‰çš„Aåœ¨ç°å®ä¸­ä¸å¯èƒ½å®Œå…¨å®ç°</strong>ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜è¯´APç³»ç»Ÿå‘¢ï¼Ÿè¿™é‡Œæœ‰å‡ ä¸ªè¦ç‚¹ï¼š</p>
<ol>
<li>CAPç†è®ºä¸­çš„Aæ˜¯ä¸€ä¸ªç†è®ºä¸Šçš„å®šä¹‰ï¼Œ<strong>å®ƒæè¿°çš„æ˜¯ç³»ç»Ÿåœ¨åˆ†åŒºå‘ç”Ÿæ—¶çš„ä¸€ç§è®¾è®¡é€‰æ‹©å€¾å‘</strong>ã€‚APç³»ç»Ÿæ˜¯æŒ‡åœ¨åˆ†åŒºå‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿå€¾å‘äºä¿æŒå¯ç”¨ï¼Œå³å°½å¯èƒ½å“åº”è¯·æ±‚ï¼Œå³ä½¿è¿”å›çš„æ•°æ®å¯èƒ½ä¸æ˜¯æœ€æ–°çš„ï¼ˆæ”¾å¼ƒå¼ºä¸€è‡´æ€§ï¼‰ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€APç³»ç»Ÿåœ¨å®é™…è¿è¡Œä¸­èƒ½è¾¾åˆ°100%çš„è¯·æ±‚å“åº”ï¼Œ<strong>è€Œæ˜¯è¯´å®ƒåœ¨è®¾è®¡ä¸Šä¸ä»¥å¼ºä¸€è‡´æ€§ä¸ºä»£ä»·æ¥æ¢å–å¯ç”¨æ€§ï¼Œå³ä¸ä¼šå› ä¸ºè¦ä¿è¯å¼ºä¸€è‡´æ€§è€Œä¸»åŠ¨æ‹’ç»è¯·æ±‚</strong>ã€‚</li>
<li>å®é™…ç³»ç»Ÿä¸­ï¼ŒAPç³»ç»Ÿé€šå¸¸é€šè¿‡ä¸€äº›æŠ€æœ¯æ‰‹æ®µï¼ˆå¦‚å‰¯æœ¬å¤åˆ¶ã€è¯»ä¿®å¤ã€æç¤ºç§»äº¤ç­‰ï¼‰æ¥æä¾›é«˜å¯ç”¨æ€§ï¼Œå¹¶æ¥å—æœ€ç»ˆä¸€è‡´æ€§ã€‚å®ƒä»¬çš„ç›®æ ‡æ˜¯å°½å¯èƒ½æé«˜å¯ç”¨æ€§ï¼Œä½†æ— æ³•ä¿è¯100%ã€‚ç„¶è€Œï¼Œåœ¨CAPçš„ç†è®ºæ¡†æ¶ä¸‹ï¼Œåªè¦ç³»ç»Ÿåœ¨åˆ†åŒºå‘ç”Ÿæ—¶<strong>ä¸ä¿è¯å¼ºä¸€è‡´æ€§</strong>ï¼Œè€Œæ˜¯<strong>ç»§ç»­å°è¯•å“åº”è¯·æ±‚</strong>ï¼Œé‚£ä¹ˆå®ƒå°±å±äºAPç³»ç»Ÿã€‚</li>
<li>CAPç†è®ºæœ¬èº«æ˜¯ä¸€ä¸ªç†è®ºæ¨¡å‹ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æƒè¡¡ã€‚åœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ— æ³•è¾¾åˆ°ç†è®ºä¸Šçš„å®Œç¾ï¼Œä½†æˆ‘ä»¬å¯ä»¥æ ¹æ®ç†è®ºæŒ‡å¯¼æ¥è®¾è®¡ç³»ç»Ÿã€‚APç³»ç»Ÿå°±æ˜¯é‚£ç§åœ¨åˆ†åŒºæ—¶é€‰æ‹©å¯ç”¨æ€§è€Œéå¼ºä¸€è‡´æ€§çš„ç³»ç»Ÿã€‚</li>
<li>å¦å¤–ï¼ŒCAPç†è®ºä¸­çš„Aè¦æ±‚â€œéæ•…éšœèŠ‚ç‚¹â€å¿…é¡»å“åº”ã€‚åœ¨åˆ†åŒºå‘ç”Ÿæ—¶ï¼ŒèŠ‚ç‚¹å¯èƒ½å› ä¸ºç½‘ç»œé—®é¢˜è€Œæ— æ³•é€šä¿¡ï¼Œä½†å®ƒä»¬æœ¬èº«å¹¶æ²¡æœ‰æ•…éšœã€‚APç³»ç»Ÿä¼šå°è¯•è®©è¿™äº›èŠ‚ç‚¹ç»§ç»­å“åº”è¯·æ±‚ï¼ˆå¯èƒ½è¿”å›æœ¬åœ°æ•°æ®ï¼‰ï¼Œè€ŒCPç³»ç»Ÿåˆ™å¯èƒ½å› ä¸ºæ— æ³•ä¿è¯ä¸€è‡´æ€§è€Œæ‹’ç»è¯·æ±‚ï¼ˆæ¯”å¦‚è¦æ±‚å¤šæ•°æ´¾åŒæ„æ‰èƒ½å†™ï¼Œåˆ†åŒºä¸­çš„å°‘æ•°æ´¾å°±ä¼šæ‹’ç»å†™è¯·æ±‚ï¼‰ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œè™½ç„¶100%è¯·æ±‚å“åº”åœ¨å®é™…ä¸­ä¸å¯èƒ½ï¼Œä½†APç³»ç»Ÿæ˜¯ä¸€ç§è®¾è®¡å“²å­¦ï¼š<strong>åœ¨åˆ†åŒºå‘ç”Ÿæ—¶ï¼Œä¸å› ä¸ºä¸€è‡´æ€§è¦æ±‚è€Œåœæ­¢æœåŠ¡ï¼Œè€Œæ˜¯ç»§ç»­æä¾›æœåŠ¡ï¼Œå°½ç®¡æ•°æ®å¯èƒ½ä¸ä¸€è‡´ã€‚è¿™ç§è®¾è®¡å“²å­¦è¿½æ±‚çš„æ˜¯é«˜å¯ç”¨æ€§ï¼Œè€Œä¸æ˜¯100%çš„å¯ç”¨æ€§</strong></p>
<h3 data-id="heading-21">3.2 æ—¢ç„¶CAPå¼ºè°ƒçš„æ˜¯ç½‘ç»œåˆ†åŒºæƒ…å†µä¸‹çš„å–èˆï¼Œé‚£èƒ½ä¸èƒ½åšä¸€ä¸ªç½‘å…³ï¼Œè®©å®ƒåªå’Œä¸»åˆ†åŒºè”ç³»ï¼Œå®¢æˆ·ç«¯è®¿é—®ç½‘å…³ï¼Œè¿™æ ·ç®—ä¸ç®—æ»¡è¶³CAP?</h3>
<p>ä¸ç®—ï¼</p>
<p>å®é™…ä¸Šï¼Œä½ çš„æ–¹æ¡ˆåœ¨é¢ä¸´ç½‘ç»œåˆ†åŒºæ—¶ï¼Œç½‘å…³å¿…é¡»åšå‡ºé€‰æ‹©ï¼š</p>
<ul>
<li><strong>é€‰æ‹©ä¸€è‡´æ€§</strong>ï¼šç½‘å…³åªå“åº”æ¥è‡ªä¸»åˆ†åŒºçš„è¯·æ±‚ï¼Œéä¸»åˆ†åŒºçš„å®¢æˆ·ç«¯è¯·æ±‚è¢«æ‹’ç» â†’Â <strong>ç‰ºç‰²å¯ç”¨æ€§</strong></li>
<li><strong>é€‰æ‹©å¯ç”¨æ€§</strong>ï¼šç½‘å…³å…è®¸å„åˆ†åŒºç‹¬ç«‹å“åº” â†’Â <strong>ç‰ºç‰²ä¸€è‡´æ€§</strong></li>
<li><strong>æ— æ³•ä¸¤è€…å…¼å¾—</strong>****</li>
</ul>
<h5 data-id="heading-22">1.Â <strong>è¿™æ˜¯CPç³»ç»Ÿçš„å˜ç§</strong></h5>
<p>æœ¬è´¨ä¸Šï¼šé€‰æ‹©ä¸€è‡´æ€§ï¼Œç‰ºç‰²éƒ¨åˆ†å¯ç”¨æ€§
åªä¸è¿‡æŠŠ"ä¸å¯ç”¨"éšè—åœ¨ç½‘å…³åé¢</p>
<p>å°‘æ•°æ´¾åˆ†åŒºäº‹å®ä¸Šçš„ä¸å¯ç”¨ â†’ ç‰ºç‰²äº†A
å¤šæ•°æ´¾åˆ†åŒºä¿æŒå¼ºä¸€è‡´ â†’ ä¿è¯äº†C</p>
<h5 data-id="heading-23">2.Â <strong>ç½‘å…³çš„ä½œç”¨æ˜¯æ•…éšœå±è”½å™¨</strong></h5>
<p>ç½‘å…³å®ç°äº†ï¼š
1. è‡ªåŠ¨æ•…éšœæ£€æµ‹ï¼ˆå‘ç°åˆ†åŒºï¼‰
2. æ™ºèƒ½è·¯ç”±ï¼ˆåªåˆ°å¥åº·åˆ†åŒºï¼‰
3. å®¢æˆ·ç«¯æŠ½è±¡ï¼ˆéšè—å¤æ‚æ€§ï¼‰</p>
<p>ä½†è¿™åªæ˜¯æŠŠCAPé—®é¢˜ä»æ•°æ®åº“å±‚æ¨åˆ°äº†ç½‘å…³å±‚</p>
<h5 data-id="heading-24">3.Â <strong>ç½‘å…³è‡ªå·±é¢ä¸´CAPæŠ‰æ‹©</strong></h5>
<p>ç½‘å…³å¦‚æœæ˜¯å•ç‚¹ï¼š
â€¢ ç½‘å…³å®•æœº â†’ æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨
â€¢ ä¸æ»¡è¶³P</p>
<p>ç½‘å…³å¦‚æœæ˜¯é›†ç¾¤ï¼š
â€¢ ç½‘å…³é›†ç¾¤ä¹Ÿå¯èƒ½åˆ†åŒº
â€¢ ç½‘å…³é›†ç¾¤è‡ªå·±é¢ä¸´CAPæŠ‰æ‹©</p>
<p>æœ¬è´¨ä¸Šï¼šé€‰æ‹©ä¸€è‡´æ€§ï¼Œç‰ºç‰²éƒ¨åˆ†å¯ç”¨æ€§
åªä¸è¿‡æŠŠ"ä¸å¯ç”¨"éšè—åœ¨ç½‘å…³åé¢</p>
<p>å°‘æ•°æ´¾åˆ†åŒºäº‹å®ä¸Šçš„ä¸å¯ç”¨ â†’ ç‰ºç‰²äº†A
å¤šæ•°æ´¾åˆ†åŒºä¿æŒå¼ºä¸€è‡´ â†’ ä¿è¯äº†C</p>
<h5 data-id="heading-25">è¯¦ç»†è§£é‡Š</h5>
<p>å‡è®¾æœ‰ä¸€ä¸ªç½‘å…³å±‚ï¼Œå®ƒçŸ¥é“æ‰€æœ‰èŠ‚ç‚¹ï¼Œå¹¶ä¸”çŸ¥é“å“ªä¸ªæ˜¯leaderï¼ˆä¸»åˆ†åŒºï¼‰ã€‚åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯é€šè¿‡ç½‘å…³è®¿é—®ï¼Œç½‘å…³å°†è¯·æ±‚è½¬å‘ç»™leaderï¼Œè¿™æ ·å®¢æˆ·ç«¯çœ‹èµ·æ¥æ˜¯åœ¨å’Œä¸€ä¸ªç»Ÿä¸€çš„ç³»ç»Ÿäº¤äº’ã€‚</p>
<p>ä½†æ˜¯ï¼Œå½“ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ï¼Œé—®é¢˜æ¥äº†ï¼š</p>
<ol>
<li>ç½‘å…³å¯èƒ½æ— æ³•è¿æ¥åˆ°leaderï¼Œå› ä¸ºç½‘å…³å’Œleaderå¯èƒ½ä¸åœ¨åŒä¸€ä¸ªåˆ†åŒºã€‚</li>
<li>å³ä½¿ç½‘å…³å’Œleaderåœ¨åŒä¸€ä¸ªåˆ†åŒºï¼Œå®¢æˆ·ç«¯å¯èƒ½æ— æ³•è¿æ¥åˆ°ç½‘å…³ï¼ˆå¦‚æœå®¢æˆ·ç«¯åœ¨å¦ä¸€ä¸ªåˆ†åŒºï¼‰ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦æ›´ä»”ç»†åœ°åˆ†æã€‚</p>
<p>ä½ çš„æƒ³æ³•æ˜¯ï¼šè®©ç½‘å…³å±‚çŸ¥é“leaderæ˜¯è°ï¼Œç„¶åå®¢æˆ·ç«¯åªè®¿é—®ç½‘å…³ï¼Œç”±ç½‘å…³è´Ÿè´£å’Œleaderé€šä¿¡ã€‚è¿™æ ·ï¼Œå®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“åˆ†åŒºæƒ…å†µï¼Œç½‘å…³æ¥å¤„ç†ã€‚</p>
<p>ç„¶è€Œï¼Œç½‘å…³æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡å—ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆç½‘å…³æœ¬èº«ä¹Ÿä¼šé¢ä¸´CAPé—®é¢˜ã€‚å¦‚æœç½‘å…³æ˜¯å•ç‚¹ï¼Œé‚£ä¹ˆå®ƒå°±æœ‰å•ç‚¹æ•…éšœã€‚å¦‚æœç½‘å…³æ˜¯å¤šå®ä¾‹çš„ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´å¦‚ä½•å…±äº«ä¿¡æ¯ï¼ˆæ¯”å¦‚leaderä¿¡æ¯ï¼‰ï¼Ÿåœ¨åˆ†åŒºå‘ç”Ÿæ—¶ï¼Œä¸åŒçš„ç½‘å…³å®ä¾‹å¯èƒ½çœ‹åˆ°ä¸åŒçš„æƒ…å†µã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç½‘å…³é›†ç¾¤ï¼Œå®ƒä»¬é€šè¿‡æŸç§å…±è¯†åè®®ï¼ˆæ¯”å¦‚Raftï¼‰æ¥ç»´æŠ¤ä¸€ä¸ªç»Ÿä¸€çš„è§†å›¾ï¼ŒåŒ…æ‹¬å½“å‰å“ªä¸ªèŠ‚ç‚¹æ˜¯leaderã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªç½‘å…³é›†ç¾¤æœ¬èº«å°±æ˜¯ä¸€ä¸ªCPç³»ç»Ÿï¼ˆä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œåœ¨åˆ†åŒºå‘ç”Ÿæ—¶å¯èƒ½ä¸å¯ç”¨ï¼‰æˆ–è€…APç³»ç»Ÿï¼ˆä¿æŒå¯ç”¨æ€§ï¼Œä½†å¯èƒ½ä¸åŒç½‘å…³å®ä¾‹çœ‹åˆ°ä¸åŒçš„leaderï¼‰ã€‚</p>
<p>æ‰€ä»¥ï¼Œé—®é¢˜è¢«è½¬ç§»åˆ°äº†ç½‘å…³é›†ç¾¤ä¸Šã€‚ç½‘å…³é›†ç¾¤å¿…é¡»è‡ªå·±åœ¨CAPä¸­åšå‡ºé€‰æ‹©ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Apache RocketMQçš„åŸç†ä¸å®è·µ]]></title>    <link>https://juejin.cn/post/7601075423003000868</link>    <guid>https://juejin.cn/post/7601075423003000868</guid>    <pubDate>2026-01-31T15:53:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601075423003000868" data-draft-id="7601159804490006547" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Apache RocketMQçš„åŸç†ä¸å®è·µ"/> <meta itemprop="keywords" content="åç«¯,RocketMQ"/> <meta itemprop="datePublished" content="2026-01-31T15:53:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‰æ°´ä¸æ»´"/> <meta itemprop="url" content="https://juejin.cn/user/283045639753100"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Apache RocketMQçš„åŸç†ä¸å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/283045639753100/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‰æ°´ä¸æ»´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T15:53:46.000Z" title="Sat Jan 31 2026 15:53:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Apache RocketMQï¼šæ¶æ„ã€åŸç†ã€å®æˆ˜ä¸ç”Ÿäº§æœ€ä½³å®è·µ</h2>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶æ˜¯å®ç°<strong>ç³»ç»Ÿè§£è€¦ã€æµé‡å‰Šå³°ã€å¼‚æ­¥é€šä¿¡</strong>çš„æ ¸å¿ƒç»„ä»¶ï¼Œè€Œ Apache RocketMQ ä½œä¸ºé˜¿é‡Œå¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå†ç»åŒåä¸€ç­‰æµ·é‡ä¸šåŠ¡åœºæ™¯è€ƒéªŒï¼Œç°å·²æˆä¸º Apache é¡¶çº§é¡¹ç›®ã€‚RocketMQ 5.0 æ›´æ˜¯å‡çº§ä¸ºäº‘åŸç”Ÿçš„ â€œæ¶ˆæ¯ã€äº‹ä»¶ã€æµâ€ ä¸€ä½“åŒ–æ•°æ®å¤„ç†å¹³å°ï¼Œå…¼é¡¾<strong>é‡‘èçº§å¯é æ€§</strong>ä¸<strong>é«˜ååæ€§èƒ½</strong>ï¼Œæ˜¯äº’è”ç½‘åç«¯ã€å¾®æœåŠ¡æ¶æ„ä¸­çš„ä¸»æµé€‰æ‹©ã€‚</p>
<p>æœ¬æ–‡å°†ä»<strong>æ¶æ„è®¾è®¡ã€æ ¸å¿ƒæ¦‚å¿µã€åº•å±‚åŸç†ã€å®æˆ˜ä»£ç ã€ç”Ÿäº§å®è·µ</strong>äº”ä¸ªç»´åº¦å…¨é¢è§£æ RocketMQï¼ŒåŒæ—¶å¯¹æ¯”ä¸»æµæ¶ˆæ¯ä¸­é—´ä»¶ç»™å‡ºé€‰å‹å»ºè®®ï¼Œå†…å®¹é€‚é… Java åç«¯å¼€å‘åœºæ™¯ï¼Œå…¼é¡¾å…¥é—¨å­¦ä¹ ä¸é¢è¯•å¤‡è€ƒã€‚</p>
<h3 data-id="heading-1">ä¸€ã€RocketMQ æ ¸å¿ƒæ¶æ„ï¼šæç®€ä¸”é«˜æ•ˆçš„åˆ†å¸ƒå¼è®¾è®¡</h3>
<p>RocketMQ é‡‡ç”¨<strong>æ— çŠ¶æ€ä¸­å¿ƒ + ä¸»ä»æ¶æ„</strong>çš„åˆ†å¸ƒå¼è®¾è®¡ï¼Œæ ¸å¿ƒç”±å››å¤§ç»„ä»¶æ„æˆï¼Œç»„ä»¶é—´è§£è€¦åº¦é«˜ã€æ‰©å±•çµæ´»ï¼Œå•é›†ç¾¤å¯æ”¯æ’‘åä¸‡çº§ TPSã€TB çº§æ¶ˆæ¯å †ç§¯ï¼Œæ¶æ„æ•´ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆæ ¸å¿ƒäº¤äº’æµç¨‹é™„åï¼‰ã€‚</p>
<h4 data-id="heading-2">1.1 å››å¤§æ ¸å¿ƒç»„ä»¶</h4>
<h5 data-id="heading-3">ï¼ˆ1ï¼‰NameServerï¼šæ— çŠ¶æ€çš„è·¯ç”±æ³¨å†Œä¸­å¿ƒ</h5>
<p>NameServer æ˜¯ RocketMQ çš„<strong>è½»é‡çº§è·¯ç”±ä¸­å¿ƒ</strong>ï¼Œæ ¸å¿ƒèŒè´£æ˜¯<strong>Broker èŠ‚ç‚¹çš„åŠ¨æ€æ³¨å†Œä¸å‘ç°</strong>ã€<strong>Topic ä¸ Broker çš„è·¯ç”±æ˜ å°„ç®¡ç†</strong>ï¼Œç‰¹ç‚¹æ˜¯<strong>æ— çŠ¶æ€ã€å»ä¸­å¿ƒåŒ–</strong>ï¼š</p>
<ul>
<li>å¤šä¸ª NameServer å®ä¾‹é—´ä¸è¿›è¡Œæ•°æ®åŒæ­¥ï¼ŒBroker ä¼šå‘æ‰€æœ‰ NameServer æ³¨å†Œè·¯ç”±ä¿¡æ¯ï¼Œå› æ­¤ä»»æ„ä¸€ä¸ª NameServer ä¸‹çº¿ä¸å½±å“é›†ç¾¤å¯ç”¨æ€§ï¼›</li>
<li>Producer/Consumer å¯åŠ¨æ—¶ä¼šä¸ä¸€ä¸ª NameServer å»ºç«‹é•¿è¿æ¥ï¼Œå®šæœŸæ‹‰å–æœ€æ–°çš„è·¯ç”±ä¿¡æ¯ï¼Œåç»­ç›´æ¥ä¸ Broker äº¤äº’ï¼Œæ— éœ€ç»è¿‡ NameServerã€‚</li>
</ul>
<p><strong>é€šä¿—æ¯”å–»</strong>ï¼šNameServer å°±åƒåˆ†å¸ƒå¼ç³»ç»Ÿçš„ â€œå¯¼èˆªä»ªâ€ï¼Œç”Ÿäº§è€… / æ¶ˆè´¹è€…é€šè¿‡å®ƒæ‰¾åˆ°å­˜å‚¨æ¶ˆæ¯çš„ Broker èŠ‚ç‚¹ï¼Œåç»­å…¨ç¨‹ç›´è¿ã€‚</p>
<h5 data-id="heading-4">ï¼ˆ2ï¼‰Brokerï¼šæ¶ˆæ¯å­˜å‚¨ä¸è½¬å‘çš„æ ¸å¿ƒ</h5>
<p>Broker æ˜¯ RocketMQ çš„<strong>æ ¸å¿ƒå·¥ä½œèŠ‚ç‚¹</strong>ï¼Œè´Ÿè´£æ¶ˆæ¯çš„<strong>æ¥æ”¶ã€å­˜å‚¨ã€æŠ•é€’ã€æŸ¥è¯¢</strong>ï¼ŒåŒæ—¶æ‰¿æ‹…é«˜å¯ç”¨ä¿éšœï¼Œæ˜¯æ•´ä¸ªæ¶æ„ä¸­å”¯ä¸€çš„æœ‰çŠ¶æ€èŠ‚ç‚¹ï¼Œæ”¯æŒ<strong>ä¸»ä»æ¶æ„</strong>ï¼š</p>
<ul>
<li><strong>Master èŠ‚ç‚¹</strong>ï¼šè´Ÿè´£è¯»å†™æ“ä½œï¼ŒBrokerId=0 æ ‡è¯†ä¸»èŠ‚ç‚¹ï¼›</li>
<li><strong>Slave èŠ‚ç‚¹</strong>ï¼šä»…è´Ÿè´£è¯»æ“ä½œï¼ŒåŒæ­¥ Master çš„æ•°æ®ï¼Œå®ç°æ•…éšœè½¬ç§»ï¼Œä¸€ä¸ª Master å¯å¯¹åº”å¤šä¸ª Slaveã€‚</li>
<li>Broker ä¼šä¸æ‰€æœ‰ NameServer å»ºç«‹é•¿è¿æ¥ï¼Œå®šæ—¶å‘é€å¿ƒè·³åŒ…æ›´æ–°è·¯ç”±ä¿¡æ¯ï¼ŒåŒæ—¶æä¾›æ¶ˆæ¯çš„å­˜å‚¨å’Œåˆ·ç›˜èƒ½åŠ›ã€‚</li>
</ul>
<p><strong>é€šä¿—æ¯”å–»</strong>ï¼šBroker å°±åƒ â€œå¿«é€’ä»“åº“â€ï¼Œè´Ÿè´£æ¥æ”¶ç”Ÿäº§è€…çš„ â€œå¿«é€’ï¼ˆæ¶ˆæ¯ï¼‰â€ï¼Œå­˜å‚¨ååˆ†å‘ç»™æ¶ˆè´¹è€…ï¼Œä¸»ä»“åº“è´Ÿè´£æ”¶å‘ï¼Œä»ä»“åº“åšå¤‡ä»½ã€‚</p>
<h5 data-id="heading-5">ï¼ˆ3ï¼‰Producerï¼šæ¶ˆæ¯ç”Ÿäº§è€…</h5>
<p>Producer æ˜¯ä¸šåŠ¡ç³»ç»Ÿçš„æ¶ˆæ¯å‘é€ç«¯ï¼Œè´Ÿè´£å°†ä¸šåŠ¡æ¶ˆæ¯å°è£…åå‘é€åˆ° Brokerï¼Œæ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ul>
<li>æ”¯æŒ<strong>åŒæ­¥ã€å¼‚æ­¥ã€å•å‘</strong>ä¸‰ç§å‘é€æ–¹å¼ï¼Œé€‚é…ä¸åŒå¯é æ€§éœ€æ±‚ï¼›</li>
<li>å‘é€å‰ä¼šæ ¹æ® NameServer çš„è·¯ç”±ä¿¡æ¯ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡é€‰æ‹©å¯¹åº”çš„ Broker å’Œ MessageQueueï¼›</li>
<li>ç›¸åŒä¸šåŠ¡é€»è¾‘çš„ Producer å½’ä¸ºä¸€ä¸ª<strong>ProducerGroup</strong>ï¼Œä¾¿äºé›†ç¾¤ç®¡ç†å’Œæ•…éšœé‡è¯•ã€‚</li>
</ul>
<h5 data-id="heading-6">ï¼ˆ4ï¼‰Consumerï¼šæ¶ˆæ¯æ¶ˆè´¹è€…</h5>
<p>Consumer æ˜¯ä¸šåŠ¡ç³»ç»Ÿçš„æ¶ˆæ¯æ¶ˆè´¹ç«¯ï¼Œè´Ÿè´£ä» Broker æ‹‰å– / æ¥æ”¶æ¶ˆæ¯å¹¶å¤„ç†ï¼Œæ ¸å¿ƒç‰¹æ€§ï¼š</p>
<ul>
<li>æ”¯æŒ<strong>æ¨æ¨¡å¼ï¼ˆPushï¼‰<strong>å’Œ</strong>æ‹‰æ¨¡å¼ï¼ˆPullï¼‰</strong> ï¼šæ¨æ¨¡å¼ç”± Broker ä¸»åŠ¨æ¨é€æ¶ˆæ¯ï¼Œå®æ—¶æ€§é«˜ï¼Œæ˜¯ä¸»æµé€‰æ‹©ï¼›æ‹‰æ¨¡å¼ç”± Consumer ä¸»åŠ¨æ‹‰å–ï¼Œä¾¿äºæ§åˆ¶æ¶ˆè´¹é€Ÿç‡ï¼Œé€‚åˆæ‰¹é‡å¤„ç†ï¼›</li>
<li>æ”¯æŒ<strong>é›†ç¾¤æ¶ˆè´¹</strong>å’Œ<strong>å¹¿æ’­æ¶ˆè´¹</strong>ï¼šé›†ç¾¤æ¶ˆè´¹ä¸‹ï¼ŒåŒä¸€ä¸ª ConsumerGroup çš„å¤šä¸ªå®ä¾‹è´Ÿè½½å‡è¡¡æ¶ˆè´¹æ¶ˆæ¯ï¼ˆä¸€æ¡æ¶ˆæ¯ä»…è¢«æ¶ˆè´¹ä¸€æ¬¡ï¼‰ï¼›å¹¿æ’­æ¶ˆè´¹ä¸‹ï¼Œæ¯ä¸ªå®ä¾‹éƒ½ä¼šæ¶ˆè´¹å…¨é‡æ¶ˆæ¯ï¼ˆé€‚åˆé…ç½®åŒæ­¥ã€é€šçŸ¥æ¨é€ï¼‰ï¼›</li>
<li>æ¶ˆè´¹å¤±è´¥æ—¶æ”¯æŒ<strong>è‡ªåŠ¨é‡è¯•</strong>ï¼Œé‡è¯•å¤±è´¥çš„æ¶ˆæ¯ä¼šè¿›å…¥<strong>æ­»ä¿¡é˜Ÿåˆ—</strong>ï¼Œé¿å…æ¶ˆæ¯ä¸¢å¤±ã€‚</li>
</ul>
<h4 data-id="heading-7">1.2 ç»„ä»¶æ ¸å¿ƒäº¤äº’æµç¨‹</h4>
<ol>
<li>Broker å¯åŠ¨åï¼Œå‘æ‰€æœ‰ NameServer æ³¨å†Œè‡ªèº«ä¿¡æ¯ï¼ˆåŒ…æ‹¬ Topicã€Queue æ˜ å°„ï¼‰ï¼›</li>
<li>Producer å¯åŠ¨ï¼Œä» NameServer æ‹‰å– Topic çš„è·¯ç”±ä¿¡æ¯ï¼Œä¸å¯¹åº” Master Broker å»ºç«‹é•¿è¿æ¥ï¼›</li>
<li>Producer å‘é€æ¶ˆæ¯æ—¶ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡é€‰æ‹© MessageQueueï¼Œå°†æ¶ˆæ¯å‘é€åˆ° Brokerï¼›</li>
<li>Consumer å¯åŠ¨ï¼Œä» NameServer æ‹‰å– Topic çš„è·¯ç”±ä¿¡æ¯ï¼Œä¸å¯¹åº” Master/Slave Broker å»ºç«‹é•¿è¿æ¥ï¼›</li>
<li>Broker é€šè¿‡æ¨ / æ‹‰æ¨¡å¼å°†æ¶ˆæ¯åˆ†å‘ç»™ Consumerï¼ŒConsumer å¤„ç†åè¿”å›æ¶ˆè´¹ç¡®è®¤ã€‚</li>
</ol>
<h3 data-id="heading-8">äºŒã€RocketMQ æ ¸å¿ƒæ¦‚å¿µï¼šå¤¯å®åŸºç¡€çš„å…³é”®</h3>
<p>å­¦ä¹  RocketMQ çš„ç¬¬ä¸€æ­¥æ˜¯ç†è§£æ ¸å¿ƒæ¦‚å¿µï¼Œè¿™äº›æ¦‚å¿µæ˜¯å¼€å‘ã€è¿ç»´å’Œé¢è¯•çš„é«˜é¢‘è€ƒç‚¹ï¼ŒåŒæ—¶å†³å®šäº†å¦‚ä½•åˆç†è®¾è®¡æ¶ˆæ¯é˜Ÿåˆ—çš„ä½¿ç”¨æ–¹æ¡ˆã€‚</p>
<h4 data-id="heading-9">2.1 åŸºç¡€æ¶ˆæ¯æ¨¡å‹</h4>
<ul>
<li>
<p><strong>Topic</strong>ï¼šæ¶ˆæ¯çš„<strong>ä¸»é¢˜åˆ†ç±»</strong>ï¼Œæ˜¯æ¶ˆæ¯è®¢é˜…å’Œå‘å¸ƒçš„åŸºæœ¬å•ä½ï¼Œæ¯æ¡æ¶ˆæ¯å¿…é¡»å±äºä¸€ä¸ª Topicã€‚ä¾‹å¦‚ç”µå•†ç³»ç»Ÿä¸­å¯åˆ›å»º<code>order_create</code>ã€<code>order_pay</code>ç­‰ Topic åˆ†åˆ«å¯¹åº”è®¢å•åˆ›å»ºã€è®¢å•æ”¯ä»˜æ¶ˆæ¯ã€‚</p>
</li>
<li>
<p><strong>MessageQueue</strong>ï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ˜¯ Topic çš„<strong>åˆ†åŒºå•å…ƒ</strong>ï¼Œä¸€ä¸ª Topic å¯åŒ…å«å¤šä¸ª MessageQueueã€‚RocketMQ é€šè¿‡ Queue å®ç°<strong>è´Ÿè½½å‡è¡¡</strong>å’Œ<strong>å¹¶è¡Œæ¶ˆè´¹</strong>ï¼ŒProducer ä¼šå°†æ¶ˆæ¯å‡åŒ€å‘é€åˆ°ä¸åŒ Queueï¼ŒConsumer ä¼šæŒ‰è§„åˆ™æ¶ˆè´¹ä¸åŒ Queue çš„æ¶ˆæ¯ã€‚</p>
</li>
<li>
<p><strong>Message</strong>ï¼šæ¶ˆæ¯ä½“ï¼Œæ˜¯ Producer å‘é€ã€Consumer æ¶ˆè´¹çš„åŸºæœ¬å•ä½ï¼ŒåŒ…å«<strong>Topicã€Tagã€Keyã€Body</strong>ç­‰æ ¸å¿ƒå±æ€§ï¼š</p>
<ul>
<li><strong>Tag</strong>ï¼šæ¶ˆæ¯çš„<strong>å­åˆ†ç±» / è¿‡æ»¤æ ‡ç­¾</strong>ï¼Œä¸€ä¸ª Topic å¯è®¾ç½®å¤šä¸ª Tagï¼ŒConsumer å¯æŒ‰éœ€è®¢é˜…æŒ‡å®š Tag çš„æ¶ˆæ¯ï¼Œå®ç°ç²¾ç»†åŒ–æ¶ˆè´¹ï¼ˆå¦‚<code>order_create</code>çš„ Tag åˆ†ä¸º<code>wechat</code>ã€<code>alipay</code>ï¼‰ï¼›</li>
<li><strong>Key</strong>ï¼šæ¶ˆæ¯çš„<strong>ä¸šåŠ¡å”¯ä¸€æ ‡è¯†</strong>ï¼Œå»ºè®®è®¾ç½®ä¸ºè®¢å• IDã€ç”¨æˆ· ID ç­‰ï¼ŒRocketMQ ä¼šä¸º Key å»ºç«‹ç´¢å¼•ï¼Œä¾¿äºåç»­æ’æŸ¥æ¶ˆæ¯ä¸¢å¤±ã€é‡å¤ç­‰é—®é¢˜ï¼›</li>
<li><strong>Body</strong>ï¼šå®é™…çš„ä¸šåŠ¡æ¶ˆæ¯å†…å®¹ï¼Œé€šå¸¸ä¸º JSON æ ¼å¼ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-10">2.2 åˆ†ç»„ä¸æ ‡è¯†</h4>
<ul>
<li><strong>ProducerGroup</strong>ï¼šç”Ÿäº§è€…ç»„ï¼ŒåŒä¸€ç±» Producer çš„é›†åˆï¼Œè¿™ç±» Producer å‘é€åŒä¸€ Topic çš„æ¶ˆæ¯ä¸”å‘é€é€»è¾‘ä¸€è‡´ï¼Œä¾¿äºé›†ç¾¤ç®¡ç†å’Œæ•…éšœé‡è¯•ã€‚</li>
<li><strong>ConsumerGroup</strong>ï¼šæ¶ˆè´¹è€…ç»„ï¼ŒåŒä¸€ç±» Consumer çš„é›†åˆï¼Œè¿™ç±» Consumer æ¶ˆè´¹åŒä¸€ Topic çš„æ¶ˆæ¯ä¸”æ¶ˆè´¹é€»è¾‘ä¸€è‡´ã€‚<strong>é›†ç¾¤æ¶ˆè´¹</strong>çš„è´Ÿè½½å‡è¡¡ã€æ¶ˆæ¯é‡è¯•éƒ½æ˜¯åŸºäº ConsumerGroup å®ç°çš„ï¼Œ<strong>ä¸€ä¸ª ConsumerGroup çš„æ¶ˆè´¹è€…æ•°é‡å»ºè®®ä¸è¶…è¿‡ Topic çš„ Queue æ•°é‡</strong>ï¼ˆå¦åˆ™ä¼šæœ‰æ¶ˆè´¹è€…ç©ºé—²ï¼‰ã€‚</li>
<li><strong>Offset</strong>ï¼šæ¶ˆè´¹åç§»é‡ï¼Œè®°å½• Consumer æ¶ˆè´¹åˆ°æŸä¸ª MessageQueue çš„<strong>ä½ç½®</strong>ï¼ŒRocketMQ é€šè¿‡ Offset å®ç°æ¶ˆæ¯çš„<strong>æ–­ç‚¹ç»­ä¼ </strong>å’Œ<strong>å›æº¯æ¶ˆè´¹</strong>ã€‚Offset åˆ†ä¸ºæœ¬åœ°åç§»é‡å’Œ Broker ç«¯çš„è¿œç¨‹åç§»é‡ï¼Œç¡®ä¿æ¶ˆè´¹çŠ¶æ€ä¸ä¸¢å¤±ã€‚</li>
</ul>
<h4 data-id="heading-11">2.3 ç‰¹æ®Šé˜Ÿåˆ—</h4>
<ul>
<li><strong>æ­»ä¿¡é˜Ÿåˆ—ï¼ˆDLQï¼‰</strong> ï¼šå½“æ¶ˆæ¯æ¶ˆè´¹å¤±è´¥åï¼Œç»è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°ä»æ— æ³•å¤„ç†ï¼Œä¼šè¢«å‘é€åˆ°<strong>æ­»ä¿¡é˜Ÿåˆ—</strong>ï¼Œæ­»ä¿¡é˜Ÿåˆ—çš„å‘½åè§„åˆ™ä¸º<code>%DLQ%+ConsumerGroupName</code>ã€‚æ­»ä¿¡é˜Ÿåˆ—çš„æ¶ˆæ¯ä¸ä¼šè¢«è‡ªåŠ¨æ¶ˆè´¹ï¼Œéœ€äººå·¥ä»‹å…¥æ’æŸ¥åæ‰‹åŠ¨å¤„ç†ï¼Œé¿å…æ— æ•ˆé‡è¯•å ç”¨ç³»ç»Ÿèµ„æºã€‚</li>
<li><strong>é‡è¯•é˜Ÿåˆ—</strong>ï¼šå­˜æ”¾æ¶ˆè´¹å¤±è´¥å¾…é‡è¯•çš„æ¶ˆæ¯ï¼ŒRocketMQ ä¼šæ ¹æ®é‡è¯•ç­–ç•¥ï¼Œå°†å¤±è´¥æ¶ˆæ¯é‡æ–°æ¨é€ç»™ Consumerï¼Œé»˜è®¤é‡è¯•æ¬¡æ•°ä¸º 16 æ¬¡ï¼ˆå¯é…ç½®ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-12">ä¸‰ã€RocketMQ æ ¸å¿ƒç‰¹æ€§ï¼šä¸ºä»€ä¹ˆæˆä¸ºäº’è”ç½‘ä¸»æµé€‰æ‹©ï¼Ÿ</h3>
<p>RocketMQ çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äº<strong>å…¼é¡¾é«˜ååä¸é‡‘èçº§å¯é æ€§</strong>ï¼ŒåŒæ—¶æä¾›ä¸°å¯Œçš„ä¼ä¸šçº§ç‰¹æ€§ï¼Œå®Œç¾é€‚é…ç”µå•†ã€é‡‘èã€å¾®æœåŠ¡ç­‰ä¸»æµä¸šåŠ¡åœºæ™¯ï¼Œæ ¸å¿ƒç‰¹æ€§å¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-13">3.1 é‡‘èçº§æ¶ˆæ¯å¯é æ€§</h4>
<p>RocketMQ é€šè¿‡<strong>å¤šå±‚å¯é æ€§æœºåˆ¶</strong>ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Œæ˜¯å°‘æ•°èƒ½æ»¡è¶³é‡‘èäº¤æ˜“åœºæ™¯çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼š</p>
<ul>
<li><strong>æ¶ˆæ¯å‘é€ç¡®è®¤</strong>ï¼šProducer å‘é€æ¶ˆæ¯åï¼ŒBroker ä¼šè¿”å›å‘é€ç»“æœï¼ˆSEND_OK / åˆ·ç›˜è¶…æ—¶ / åŒæ­¥ä»èŠ‚ç‚¹è¶…æ—¶ï¼‰ï¼Œå¤±è´¥å¯è§¦å‘é‡è¯•ï¼›</li>
<li><strong>åˆ·ç›˜ç­–ç•¥</strong>ï¼šæ”¯æŒ<strong>åŒæ­¥åˆ·ç›˜</strong>å’Œ<strong>å¼‚æ­¥åˆ·ç›˜</strong>ï¼ŒåŒæ­¥åˆ·ç›˜è¦æ±‚æ¶ˆæ¯å†™å…¥ç£ç›˜åæ‰è¿”å›æˆåŠŸï¼Œé€‚åˆé‡‘èã€æ”¯ä»˜ç­‰æ ¸å¿ƒåœºæ™¯ï¼›å¼‚æ­¥åˆ·ç›˜å†™å…¥é¡µç¼“å­˜å³è¿”å›ï¼Œæ€§èƒ½æ›´é«˜ï¼Œé€‚åˆéæ ¸å¿ƒåœºæ™¯ï¼›</li>
<li><strong>ä¸»ä»å¤åˆ¶</strong>ï¼šæ”¯æŒ<strong>åŒæ­¥å¤åˆ¶</strong>å’Œ<strong>å¼‚æ­¥å¤åˆ¶</strong>ï¼ŒåŒæ­¥å¤åˆ¶è¦æ±‚ Master å°†æ¶ˆæ¯åŒæ­¥åˆ° Slave åæ‰è¿”å›æˆåŠŸï¼Œå®ç°æ•°æ®åŒæ´»ï¼›</li>
<li><strong>æ¶ˆè´¹ç¡®è®¤</strong>ï¼šConsumer å¤„ç†æ¶ˆæ¯åéœ€è¿”å›æ¶ˆè´¹çŠ¶æ€ï¼ˆCONSUME_SUCCESS/RECONSUME_LATERï¼‰ï¼Œä»…ç¡®è®¤æˆåŠŸåï¼ŒBroker æ‰ä¼šæ›´æ–° Offsetã€‚</li>
</ul>
<h4 data-id="heading-14">3.2 åŸç”Ÿåˆ†å¸ƒå¼äº‹åŠ¡æ¶ˆæ¯</h4>
<p>RocketMQ åŸç”Ÿæ”¯æŒ<strong>åˆ†å¸ƒå¼äº‹åŠ¡æ¶ˆæ¯</strong>ï¼ŒåŸºäº<strong>åŠæ¶ˆæ¯æœºåˆ¶ + äº‹åŠ¡å›æŸ¥</strong>å®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œå®Œç¾è§£å†³è·¨æœåŠ¡çš„äº‹åŠ¡é—®é¢˜ï¼ˆå¦‚è®¢å•åˆ›å»ºä¸åº“å­˜æ‰£å‡ï¼‰ï¼Œæ ¸å¿ƒæµç¨‹ï¼š</p>
<ol>
<li>Producer å‘é€<strong>åŠæ¶ˆæ¯</strong>åˆ° Brokerï¼ŒåŠæ¶ˆæ¯æš‚ä¸è¢« Consumer æ¶ˆè´¹ï¼›</li>
<li>Broker ç¡®è®¤åŠæ¶ˆæ¯å‘é€æˆåŠŸåï¼ŒProducer æ‰§è¡Œ<strong>æœ¬åœ°äº‹åŠ¡</strong>ï¼ˆå¦‚åˆ›å»ºè®¢å•ï¼‰ï¼›</li>
<li>æ ¹æ®æœ¬åœ°äº‹åŠ¡ç»“æœï¼ŒProducer å‘ Broker å‘é€<strong>æäº¤ / å›æ»š</strong>æŒ‡ä»¤ï¼šæäº¤åˆ™åŠæ¶ˆæ¯å˜ä¸ºå¯æ¶ˆè´¹ï¼Œå›æ»šåˆ™ Broker åˆ é™¤åŠæ¶ˆæ¯ï¼›</li>
<li>è‹¥ Broker é•¿æ—¶é—´æœªæ”¶åˆ°æŒ‡ä»¤ï¼Œä¼š<strong>å®šæ—¶å›æŸ¥</strong>Producer çš„æœ¬åœ°äº‹åŠ¡çŠ¶æ€ï¼Œæ ¹æ®å›æŸ¥ç»“æœå¤„ç†åŠæ¶ˆæ¯ã€‚</li>
</ol>
<h4 data-id="heading-15">3.3 ä¸¥æ ¼çš„é¡ºåºæ¶ˆæ¯</h4>
<p>RocketMQ æ”¯æŒ<strong>å…¨å±€é¡ºåºæ¶ˆæ¯</strong>å’Œ<strong>åˆ†åŒºé¡ºåºæ¶ˆæ¯</strong>ï¼Œå…¶ä¸­åˆ†åŒºé¡ºåºæ¶ˆæ¯æ˜¯ä¸»æµä½¿ç”¨æ–¹å¼ï¼šé€šè¿‡å°†<strong>ç›¸åŒä¸šåŠ¡ ID</strong>çš„æ¶ˆæ¯å‘é€åˆ°<strong>åŒä¸€ä¸ª MessageQueue</strong>ï¼ŒåŒæ—¶ Consumer ä»¥å•çº¿ç¨‹æ¶ˆè´¹è¯¥ Queueï¼Œå®ç°æ¶ˆæ¯çš„æœ‰åºå¤„ç†ï¼ˆå¦‚è®¢å•çš„åˆ›å»ºã€æ”¯ä»˜ã€å‘è´§æµç¨‹ï¼‰ã€‚</p>
<h4 data-id="heading-16">3.4 å®šæ—¶ / å»¶æ—¶æ¶ˆæ¯</h4>
<p>RocketMQ æ”¯æŒ<strong>å®šæ—¶æ¶ˆæ¯ï¼ˆå»¶æ—¶æ¶ˆæ¯ï¼‰</strong> ï¼Œæ— éœ€å¼€å‘é¢å¤–å®šæ—¶ä»»åŠ¡ç»„ä»¶ï¼Œé»˜è®¤æä¾›<strong>18 ä¸ªå»¶æ—¶çº§åˆ«</strong>ï¼ˆ1s/5s/10s/30s/1m/2mâ€¦2hï¼‰ï¼Œæ¶ˆæ¯ä¼šåœ¨æŒ‡å®šå»¶æ—¶åè¢« Consumer æ¶ˆè´¹ï¼Œé€‚ç”¨äºè®¢å•è¶…æ—¶å–æ¶ˆã€å®šæ—¶é€šçŸ¥ã€ä»»åŠ¡è°ƒåº¦ç­‰åœºæ™¯ã€‚</p>
<h4 data-id="heading-17">3.5 æ¶ˆæ¯å›æº¯ä¸å †ç§¯èƒ½åŠ›</h4>
<ul>
<li><strong>å›æº¯æ¶ˆè´¹</strong>ï¼šConsumer å¯é‡ç½® Offsetï¼Œé‡æ–°æ¶ˆè´¹å†å²æ¶ˆæ¯ï¼Œæ”¯æŒæŒ‰<strong>æ—¶é—´æˆ³ã€åç§»é‡</strong>å›æº¯ï¼Œé€‚ç”¨äºæ•°æ®æ¢å¤ã€ç¦»çº¿è®¡ç®—ç­‰åœºæ™¯ï¼›</li>
<li><strong>TB çº§å †ç§¯èƒ½åŠ›</strong>ï¼šé€šè¿‡<strong>é¡ºåºå†™ç£ç›˜ + è½»é‡çº§ç´¢å¼•</strong>çš„å­˜å‚¨è®¾è®¡ï¼ŒRocketMQ å¯è½»æ¾æ”¯æ’‘ TB çº§æ¶ˆæ¯å †ç§¯ï¼Œä¸”å †ç§¯åä¸ä¼šå¯¼è‡´æ€§èƒ½å¤§å¹…ä¸‹é™ï¼Œæ˜¯åº”å¯¹æµé‡å³°å€¼çš„æ ¸å¿ƒèƒ½åŠ›ã€‚</li>
</ul>
<h4 data-id="heading-18">3.6 å…¶ä»–ä¼ä¸šçº§ç‰¹æ€§</h4>
<ul>
<li><strong>æ¶ˆæ¯è¿‡æ»¤</strong>ï¼šæ”¯æŒåŸºäº Tag çš„ Broker ç«¯è¿‡æ»¤å’ŒåŸºäº SQL92 çš„ Consumer ç«¯è¿‡æ»¤ï¼Œå®ç°ç²¾ç»†åŒ–æ¶ˆè´¹ï¼›</li>
<li><strong>æ‰¹é‡å‘é€ / æ¶ˆè´¹</strong>ï¼šæ”¯æŒæ‰¹é‡å‘é€å’Œæ‰¹é‡æ¶ˆè´¹æ¶ˆæ¯ï¼Œå‡å°‘ç½‘ç»œäº¤äº’æ¬¡æ•°ï¼Œæå‡ååæ€§èƒ½ï¼›</li>
<li><strong>äº‘åŸç”Ÿæ”¯æŒ</strong>ï¼šRocketMQ 5.0 é€‚é… K8sã€Docker ç­‰äº‘åŸç”Ÿç¯å¢ƒï¼Œæ”¯æŒæ— é™å¼¹æ€§æ‰©ç¼©ï¼ŒåŒæ—¶æä¾›è½»é‡çº§æµè®¡ç®—å¼•æ“ï¼Œè¦†ç›– â€œæ¶ˆæ¯ - äº‹ä»¶ - æµâ€ å…¨åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-19">å››ã€åº•å±‚æ ¸å¿ƒåŸç†ï¼šRocketMQ é«˜æ€§èƒ½çš„æœ¬è´¨</h3>
<p>RocketMQ èƒ½å®ç°<strong>é«˜ååã€é«˜å¯ç”¨ã€æŠ—å †ç§¯</strong>ï¼Œæ ¸å¿ƒåœ¨äºå…¶<strong>åº•å±‚å­˜å‚¨è®¾è®¡</strong>å’Œ<strong>èµ„æºè°ƒåº¦ä¼˜åŒ–</strong>ï¼Œå…¶ä¸­<strong>CommitLog+ConsumeQueue çš„åˆ†å±‚å­˜å‚¨</strong>æ˜¯æœ€æ ¸å¿ƒçš„è®¾è®¡äº®ç‚¹ã€‚</p>
<h4 data-id="heading-20">4.1 æ¶ˆæ¯å­˜å‚¨ï¼šCommitLog + ConsumeQueue åˆ†å±‚è§£è€¦</h4>
<p>RocketMQ æ‘’å¼ƒäº† â€œä¸€ä¸ª Topic ä¸€ä¸ªå­˜å‚¨æ–‡ä»¶â€ çš„è®¾è®¡ï¼Œé‡‡ç”¨ ** å…¨å±€æ—¥å¿—æ–‡ä»¶ï¼ˆCommitLogï¼‰+ è½»é‡ç´¢å¼•æ–‡ä»¶ï¼ˆConsumeQueueï¼‰** çš„åˆ†å±‚æ¶æ„ï¼Œå½»åº•è§£å†³äº†ç£ç›˜éšæœºå†™çš„æ€§èƒ½ç“¶é¢ˆã€‚</p>
<h5 data-id="heading-21">ï¼ˆ1ï¼‰CommitLogï¼šæ‰€æœ‰æ¶ˆæ¯çš„å…¨å±€é¡ºåºæ—¥å¿—</h5>
<ul>
<li>CommitLog æ˜¯ RocketMQ çš„<strong>æ ¸å¿ƒæ¶ˆæ¯å­˜å‚¨æ–‡ä»¶</strong>ï¼Œä¸ç®¡å±äºå“ªä¸ª Topicã€å“ªä¸ª Queueï¼Œæ‰€æœ‰æ¶ˆæ¯éƒ½ä¼š<strong>é¡ºåºè¿½åŠ å†™å…¥</strong>CommitLogï¼Œæ–‡ä»¶å¤§å°å›ºå®šä¸º 1GBï¼ˆå¯é…ç½®ï¼‰ï¼Œæ–‡ä»¶åä»¥æ¶ˆæ¯çš„èµ·å§‹åç§»é‡å‘½åï¼›</li>
<li>æœºæ¢°ç¡¬ç›˜çš„<strong>é¡ºåºå†™é€Ÿåº¦æ˜¯éšæœºå†™çš„ 6000 å€</strong>ï¼ŒSSD çš„é¡ºåºå†™ IOPS ä¹Ÿè¿œé«˜äºéšæœºå†™ï¼Œé€šè¿‡é¡ºåºå†™ï¼ŒRocketMQ å°†ç£ç›˜ IO æ€§èƒ½å‘æŒ¥åˆ°æè‡´ï¼›</li>
<li>CommitLog å­˜å‚¨æ¶ˆæ¯çš„<strong>å®Œæ•´å†…å®¹</strong>ï¼ŒåŒ…æ‹¬æ¶ˆæ¯ä½“ã€Topicã€Tagã€åç§»é‡ç­‰æ‰€æœ‰ä¿¡æ¯ã€‚</li>
</ul>
<h5 data-id="heading-22">ï¼ˆ2ï¼‰ConsumeQueueï¼šTopic/Queue çš„è½»é‡çº§ç´¢å¼•</h5>
<p>ConsumeQueue æ˜¯<strong>Topic+MessageQueue å¯¹åº”çš„ç´¢å¼•æ–‡ä»¶</strong>ï¼Œæ¯ä¸ª Topic çš„æ¯ä¸ª Queue éƒ½æœ‰ç‹¬ç«‹çš„ ConsumeQueueï¼Œå…¶æ ¸å¿ƒä½œç”¨æ˜¯<strong>ä¸º CommitLog å»ºç«‹è½»é‡ç´¢å¼•</strong>ï¼Œä¸å­˜å‚¨æ¶ˆæ¯ä½“ï¼Œä»…ä¿å­˜ 3 ä¸ªæ ¸å¿ƒä¿¡æ¯ï¼ˆå›ºå®š 20 å­—èŠ‚ï¼‰ï¼š</p>
<ol>
<li>æ¶ˆæ¯åœ¨ CommitLog ä¸­çš„<strong>ç‰©ç†åç§»é‡</strong>ï¼›</li>
<li>æ¶ˆæ¯çš„<strong>æ¶ˆæ¯é•¿åº¦</strong>ï¼›</li>
<li>æ¶ˆæ¯ Tag çš„<strong>å“ˆå¸Œå€¼</strong>ï¼ˆç”¨äº Broker ç«¯ Tag è¿‡æ»¤ï¼‰ã€‚</li>
</ol>
<p><strong>æ¶ˆè´¹æµç¨‹</strong>ï¼šConsumer æ¶ˆè´¹æ—¶ï¼Œå…ˆä» ConsumeQueue ä¸­æ ¹æ® Offset æ‰¾åˆ°æ¶ˆæ¯çš„ç‰©ç†åç§»é‡ï¼Œå†åˆ° CommitLog ä¸­è¯»å–å®Œæ•´æ¶ˆæ¯ä½“ï¼Œå°±åƒ â€œæŸ¥ç”µè¯æœ¬å…ˆæ‰¾ç´¢å¼•ï¼Œå†æ‰¾å…·ä½“å†…å®¹â€ï¼Œå°†<strong>ç£ç›˜éšæœºè¯»</strong>è½¬åŒ–ä¸º<strong>æ•°ç»„éšæœºè®¿é—®</strong>ï¼Œæ€§èƒ½æ¥è¿‘å†…å­˜ã€‚</p>
<h4 data-id="heading-23">4.2 é›¶æ‹·è´ä¸å†…å­˜æ˜ å°„ï¼šmmap + PageCache</h4>
<p>RocketMQ é‡‡ç”¨<strong>å†…å­˜æ˜ å°„ï¼ˆmmapï¼‰+ æ“ä½œç³»ç»Ÿé¡µç¼“å­˜ï¼ˆPageCacheï¼‰<strong>çš„ç»„åˆï¼Œå®ç°äº†</strong>é›¶æ‹·è´</strong>ï¼Œå¤§å¹…å‡å°‘ç£ç›˜ IO å’Œå†…å­˜æ‹·è´çš„å¼€é”€ï¼š</p>
<ul>
<li><strong>mmap</strong>ï¼šå°† CommitLog å’Œ ConsumeQueue æ–‡ä»¶ç›´æ¥æ˜ å°„åˆ°è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜åœ°å€ç©ºé—´ï¼Œæ¶ˆæ¯çš„è¯»å†™æ— éœ€ä»ç£ç›˜æ‹·è´åˆ°å†…æ ¸æ€ï¼Œå†ä»å†…æ ¸æ€æ‹·è´åˆ°ç”¨æˆ·æ€ï¼Œç›´æ¥æ“ä½œå†…å­˜åœ°å€å³å¯ï¼›</li>
<li><strong>PageCache</strong>ï¼šåˆ©ç”¨æ“ä½œç³»ç»Ÿçš„é¡µç¼“å­˜ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒConsumer æ¶ˆè´¹çš„æ¶ˆæ¯éƒ½æ¥è‡ª PageCacheï¼Œè€Œéç£ç›˜ï¼Œå®ç° â€œè¯»å†…å­˜â€ çš„æ€§èƒ½ï¼›</li>
<li><strong>å †å¤–å†…å­˜æ± ï¼ˆTransientStorePoolï¼‰</strong> ï¼šé»˜è®¤åˆ†é… 4GB å †å¤–å†…å­˜æš‚å­˜æœªåˆ·ç›˜çš„æ¶ˆæ¯ï¼Œå‡å°‘ JVM GC å‹åŠ›ï¼ŒåŒæ—¶ç”±åå°çº¿ç¨‹å¼‚æ­¥åˆ·ç›˜ï¼Œå…¼é¡¾æ€§èƒ½å’Œå¯é æ€§ã€‚</li>
</ul>
<h4 data-id="heading-24">4.3 åˆ·ç›˜ä¸å¤åˆ¶ï¼šæ€§èƒ½ä¸å¯é æ€§çš„æƒè¡¡</h4>
<p>RocketMQ é€šè¿‡<strong>å¯é…ç½®çš„åˆ·ç›˜ç­–ç•¥</strong>å’Œ<strong>ä¸»ä»å¤åˆ¶ç­–ç•¥</strong>ï¼Œè®©ç”¨æˆ·å¯æ ¹æ®ä¸šåŠ¡åœºæ™¯åœ¨ â€œæ€§èƒ½â€ å’Œ â€œå¯é æ€§â€ ä¹‹é—´åšæƒè¡¡ï¼Œæ ¸å¿ƒç­–ç•¥å¦‚ä¸‹ï¼š</p>



































<table><thead><tr><th>ç­–ç•¥ç±»å‹</th><th>ç»†åˆ†ç­–ç•¥</th><th>æ ¸å¿ƒç‰¹ç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>åˆ·ç›˜ç­–ç•¥</td><td>åŒæ­¥åˆ·ç›˜</td><td>æ¶ˆæ¯å†™å…¥ç£ç›˜åæ‰è¿”å›æˆåŠŸï¼Œæ— ä¸¢å¤±é£é™©</td><td>é‡‘èã€æ”¯ä»˜ã€è®¢å•æ ¸å¿ƒåœºæ™¯</td></tr><tr><td/><td>å¼‚æ­¥åˆ·ç›˜</td><td>æ¶ˆæ¯å†™å…¥ PageCache å³è¿”å›æˆåŠŸï¼Œåå°çº¿ç¨‹å¼‚æ­¥åˆ·ç›˜</td><td>éæ ¸å¿ƒåœºæ™¯ã€è¿½æ±‚é«˜åå</td></tr><tr><td>å¤åˆ¶ç­–ç•¥</td><td>åŒæ­¥å¤åˆ¶</td><td>Master å°†æ¶ˆæ¯åŒæ­¥åˆ° Slave åæ‰è¿”å›æˆåŠŸï¼Œä¸»ä»æ•°æ®ä¸€è‡´</td><td>é«˜å¯ç”¨è¦æ±‚é«˜çš„é›†ç¾¤</td></tr><tr><td/><td>å¼‚æ­¥å¤åˆ¶</td><td>Master å†™å…¥æˆåŠŸå³è¿”å›æˆåŠŸï¼Œå¼‚æ­¥å°†æ¶ˆæ¯å¤åˆ¶åˆ° Slave</td><td>æ™®é€šé›†ç¾¤ã€æ€§èƒ½ä¼˜å…ˆ</td></tr></tbody></table>
<h3 data-id="heading-25">äº”ã€Java å¿«é€Ÿå…¥é—¨ï¼šä» 0 åˆ° 1 å®ç°æ¶ˆæ¯å‘é€ä¸æ¶ˆè´¹</h3>
<p>RocketMQ çš„å®¢æˆ·ç«¯ SDK å¯¹ Java æä¾›äº†å®Œå–„çš„æ”¯æŒï¼Œä»¥ä¸‹åŸºäº<strong>RocketMQ 5.2.0</strong>ï¼ˆæœ€æ–°ç¨³å®šç‰ˆï¼‰å®ç°æ¶ˆæ¯çš„<strong>å‘é€</strong>å’Œ<strong>æ¶ˆè´¹</strong>ï¼Œä»£ç å¯ç›´æ¥è¿è¡Œï¼Œé€‚é…å¼€å‘ç¯å¢ƒå¿«é€Ÿè°ƒè¯•ã€‚</p>
<h4 data-id="heading-26">5.1 ç¯å¢ƒå‡†å¤‡</h4>
<ol>
<li>
<p><strong>JDK</strong>ï¼šæ¨è JDK 8+ï¼ˆRocketMQ 5.x è¦æ±‚ JDK 8 åŠä»¥ä¸Šï¼‰ï¼›</p>
</li>
<li>
<p><strong>RocketMQ å®‰è£…</strong>ï¼šä»<a href="https://link.juejin.cn?target=https%3A%2F%2Frocketmq.apache.org%2Fzh%2F" target="_blank" title="https://rocketmq.apache.org/zh/" ref="nofollow noopener noreferrer">Apache RocketMQ å®˜ç½‘</a>ä¸‹è½½äºŒè¿›åˆ¶åŒ…ï¼Œè§£å‹åå³å¯å¯åŠ¨ï¼›</p>
</li>
<li>
<p><strong>å¯åŠ¨æœåŠ¡</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨NameServerï¼ˆWindowsç”¨mqnamesrv.cmdï¼ŒLinux/macç”¨mqnamesrv.shï¼‰</span>
<span class="hljs-built_in">cd</span> rocketmq-all-5.2.0-bin-release/bin
mqnamesrv
<span class="hljs-comment"># å¯åŠ¨Brokerï¼ŒæŒ‡å®šNameServeråœ°å€ï¼Œå¼€å‘ç¯å¢ƒå¼€å¯è‡ªåŠ¨åˆ›å»ºTopic</span>
mqbroker -n 127.0.0.1:9876 autoCreateTopicEnable=<span class="hljs-literal">true</span>
</code></pre>
</li>
</ol>
<h4 data-id="heading-27">5.2 å¼•å…¥ Maven ä¾èµ–</h4>
<p>åœ¨ Java é¡¹ç›®çš„<code>pom.xml</code>ä¸­å¼•å…¥ RocketMQ å®¢æˆ·ç«¯ä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- RocketMQ Javaå®¢æˆ·ç«¯ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.rocketmq<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>rocketmq-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-comment">&lt;!-- åŸºç¡€å·¥å…·åŒ… --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang3<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.14.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-28">5.3 æ¶ˆæ¯ç”Ÿäº§è€…ï¼šä¸‰ç§å‘é€æ–¹å¼</h4>
<p>RocketMQ æä¾›<strong>åŒæ­¥ã€å¼‚æ­¥ã€å•å‘</strong>ä¸‰ç§æ¶ˆæ¯å‘é€æ–¹å¼ï¼Œåˆ†åˆ«é€‚é…ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œä»¥ä¸‹å®ç°åŸºäº<code>DefaultMQProducer</code>ã€‚</p>
<h5 data-id="heading-29">ï¼ˆ1ï¼‰åŒæ­¥å‘é€ï¼ˆæœ€å¸¸ç”¨ï¼Œå¯é ï¼‰</h5>
<p>å‘é€åç­‰å¾… Broker è¿”å›ç»“æœï¼Œé€‚ç”¨äº<strong>é‡è¦æ¶ˆæ¯</strong>ï¼ˆå¦‚è®¢å•åˆ›å»ºã€æ”¯ä»˜é€šçŸ¥ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.rocketmq.client.producer.DefaultMQProducer;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.producer.SendResult;
<span class="hljs-keyword">import</span> org.apache.rocketmq.common.message.Message;
<span class="hljs-keyword">import</span> org.apache.rocketmq.remoting.common.RemotingHelper;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SyncProducer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 1. åˆ›å»ºç”Ÿäº§è€…ï¼ŒæŒ‡å®šProducerGroupï¼ˆå¿…é¡»å”¯ä¸€ï¼‰</span>
        <span class="hljs-type">DefaultMQProducer</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultMQProducer</span>(<span class="hljs-string">"order_producer_group"</span>);
        <span class="hljs-comment">// 2. è®¾ç½®NameServeråœ°å€ï¼Œå¤šä¸ªç”¨;åˆ†éš”</span>
        producer.setNamesrvAddr(<span class="hljs-string">"127.0.0.1:9876"</span>);
        <span class="hljs-comment">// 3. å¯åŠ¨ç”Ÿäº§è€…</span>
        producer.start();
        <span class="hljs-comment">// 4. å‘é€10æ¡æµ‹è¯•æ¶ˆæ¯</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-comment">// æ„å»ºæ¶ˆæ¯ï¼šTopic + Tag + æ¶ˆæ¯ä½“ï¼ˆå­—èŠ‚æ•°ç»„ï¼‰</span>
            <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(
                    <span class="hljs-string">"order_create"</span>, <span class="hljs-comment">// Topicåç§°</span>
                    <span class="hljs-string">"wechat"</span>,       <span class="hljs-comment">// Tagåç§°</span>
                    (<span class="hljs-string">"å¾®ä¿¡æ”¯ä»˜è®¢å•åˆ›å»ºï¼š"</span> + i).getBytes(RemotingHelper.DEFAULT_CHARSET) <span class="hljs-comment">// æ¶ˆæ¯ä½“</span>
            );
            <span class="hljs-comment">// è®¾ç½®æ¶ˆæ¯Keyï¼Œä¾¿äºæ’æŸ¥ï¼ˆå»ºè®®ä¸ºä¸šåŠ¡å”¯ä¸€IDï¼‰</span>
            msg.setKeys(<span class="hljs-string">"order_key_"</span> + i);
            <span class="hljs-comment">// 5. åŒæ­¥å‘é€æ¶ˆæ¯ï¼Œç­‰å¾…è¿”å›ç»“æœ</span>
            <span class="hljs-type">SendResult</span> <span class="hljs-variable">sendResult</span> <span class="hljs-operator">=</span> producer.send(msg);
            <span class="hljs-comment">// 6. æ‰“å°å‘é€ç»“æœ</span>
            System.out.printf(<span class="hljs-string">"å‘é€ç»“æœï¼š%sï¼Œæ¶ˆæ¯IDï¼š%s%n"</span>, sendResult.getSendStatus(), sendResult.getMsgId());
        }
        <span class="hljs-comment">// 7. å…³é—­ç”Ÿäº§è€…ï¼ˆå®é™…é¡¹ç›®ä¸­å»ºè®®åœ¨æœåŠ¡å…³é—­æ—¶æ‰§è¡Œï¼‰</span>
        producer.shutdown();
    }
}
</code></pre>
<h5 data-id="heading-30">ï¼ˆ2ï¼‰å¼‚æ­¥å‘é€ï¼ˆé«˜ååï¼Œéé˜»å¡ï¼‰</h5>
<p>å‘é€åä¸ç­‰å¾…ç»“æœï¼Œé€šè¿‡å›è°ƒå‡½æ•°å¤„ç†å‘é€æˆåŠŸ / å¤±è´¥ï¼Œé€‚ç”¨äº<strong>å¯¹å“åº”æ—¶é—´æ•æ„Ÿ</strong>çš„åœºæ™¯ï¼ˆå¦‚æ—¥å¿—é‡‡é›†ã€æ¶ˆæ¯æ¨é€ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.rocketmq.client.producer.DefaultMQProducer;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.producer.SendCallback;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.producer.SendResult;
<span class="hljs-keyword">import</span> org.apache.rocketmq.common.message.Message;
<span class="hljs-keyword">import</span> org.apache.rocketmq.remoting.common.RemotingHelper;

<span class="hljs-keyword">import</span> java.util.concurrent.CountDownLatch;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncProducer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">DefaultMQProducer</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultMQProducer</span>(<span class="hljs-string">"log_producer_group"</span>);
        producer.setNamesrvAddr(<span class="hljs-string">"127.0.0.1:9876"</span>);
        producer.start();
        <span class="hljs-comment">// è®¡æ•°å™¨ï¼Œç­‰å¾…æ‰€æœ‰æ¶ˆæ¯å‘é€å®Œæˆ</span>
        <span class="hljs-type">CountDownLatch</span> <span class="hljs-variable">countDownLatch</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CountDownLatch</span>(<span class="hljs-number">10</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(
                    <span class="hljs-string">"system_log"</span>,
                    <span class="hljs-string">"error"</span>,
                    (<span class="hljs-string">"ç³»ç»Ÿé”™è¯¯æ—¥å¿—ï¼š"</span> + i).getBytes(RemotingHelper.DEFAULT_CHARSET)
            );
            <span class="hljs-comment">// å¼‚æ­¥å‘é€ï¼Œé€šè¿‡SendCallbackå›è°ƒå¤„ç†ç»“æœ</span>
            producer.send(msg, <span class="hljs-keyword">new</span> <span class="hljs-title class_">SendCallback</span>() {
                <span class="hljs-comment">// å‘é€æˆåŠŸå›è°ƒ</span>
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSuccess</span><span class="hljs-params">(SendResult sendResult)</span> {
                    countDownLatch.countDown();
                    System.out.printf(<span class="hljs-string">"å¼‚æ­¥å‘é€æˆåŠŸï¼š%s%n"</span>, sendResult.getMsgId());
                }
                <span class="hljs-comment">// å‘é€å¤±è´¥å›è°ƒ</span>
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onException</span><span class="hljs-params">(Throwable e)</span> {
                    countDownLatch.countDown();
                    System.err.printf(<span class="hljs-string">"å¼‚æ­¥å‘é€å¤±è´¥ï¼š%s%n"</span>, e.getMessage());
                }
            });
        }
        <span class="hljs-comment">// ç­‰å¾…5ç§’ï¼Œç¡®ä¿æ‰€æœ‰å›è°ƒæ‰§è¡Œå®Œæˆ</span>
        countDownLatch.await(<span class="hljs-number">5</span>, TimeUnit.SECONDS);
        producer.shutdown();
    }
}
</code></pre>
<h5 data-id="heading-31">ï¼ˆ3ï¼‰å•å‘å‘é€ï¼ˆæœ€å¿«ï¼Œä¸å¯é ï¼‰</h5>
<p>åªå‘é€æ¶ˆæ¯ï¼Œä¸ç­‰å¾…ç»“æœä¹Ÿæ— å›è°ƒï¼Œé€‚ç”¨äº<strong>ä½å¯é æ€§è¦æ±‚</strong>çš„åœºæ™¯ï¼ˆå¦‚å¿ƒè·³åŒ…ã€æ—¥å¿—æ‰“ç‚¹ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.rocketmq.client.producer.DefaultMQProducer;
<span class="hljs-keyword">import</span> org.apache.rocketmq.common.message.Message;
<span class="hljs-keyword">import</span> org.apache.rocketmq.remoting.common.RemotingHelper;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OnewayProducer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">DefaultMQProducer</span> <span class="hljs-variable">producer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultMQProducer</span>(<span class="hljs-string">"heartbeat_producer_group"</span>);
        producer.setNamesrvAddr(<span class="hljs-string">"127.0.0.1:9876"</span>);
        producer.start();
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
            <span class="hljs-type">Message</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(
                    <span class="hljs-string">"service_heartbeat"</span>,
                    <span class="hljs-string">"default"</span>,
                    (<span class="hljs-string">"æœåŠ¡å¿ƒè·³ï¼š"</span> + i).getBytes(RemotingHelper.DEFAULT_CHARSET)
            );
            <span class="hljs-comment">// å•å‘å‘é€ï¼Œæ— è¿”å›ç»“æœ</span>
            producer.sendOneway(msg);
            System.out.printf(<span class="hljs-string">"å•å‘å‘é€æ¶ˆæ¯ï¼š%d%n"</span>, i);
        }
        producer.shutdown();
    }
}
</code></pre>
<h4 data-id="heading-32">5.4 æ¶ˆæ¯æ¶ˆè´¹è€…ï¼šæ¨æ¨¡å¼ï¼ˆPushï¼‰å®æˆ˜</h4>
<p>RocketMQ çš„æ¶ˆè´¹æ¨¡å¼åˆ†ä¸º<strong>æ¨æ¨¡å¼ï¼ˆPushï¼‰<strong>å’Œ</strong>æ‹‰æ¨¡å¼ï¼ˆPullï¼‰</strong> ï¼Œæ¨æ¨¡å¼ç”± Broker ä¸»åŠ¨æ¨é€æ¶ˆæ¯ç»™ Consumerï¼Œå®æ—¶æ€§é«˜ï¼Œæ˜¯ä¸»æµé€‰æ‹©ï¼Œæ”¯æŒ<strong>é›†ç¾¤æ¶ˆè´¹</strong>å’Œ<strong>å¹¿æ’­æ¶ˆè´¹</strong>ã€‚</p>
<h5 data-id="heading-33">ï¼ˆ1ï¼‰é›†ç¾¤æ¶ˆè´¹ï¼ˆé»˜è®¤ï¼Œæ¨èï¼‰</h5>
<p>åŒä¸€ä¸ª ConsumerGroup çš„å¤šä¸ª Consumer å®ä¾‹<strong>è´Ÿè½½å‡è¡¡æ¶ˆè´¹</strong>ï¼Œä¸€æ¡æ¶ˆæ¯ä»…è¢«æ¶ˆè´¹ä¸€æ¬¡ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyContext;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.consumer.listener.MessageListenerConcurrently;
<span class="hljs-keyword">import</span> org.apache.rocketmq.common.message.MessageExt;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClusterConsumer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 1. åˆ›å»ºæ¶ˆè´¹è€…ï¼ŒæŒ‡å®šConsumerGroupï¼ˆå¿…é¡»å”¯ä¸€ï¼‰</span>
        <span class="hljs-type">DefaultMQPushConsumer</span> <span class="hljs-variable">consumer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultMQPushConsumer</span>(<span class="hljs-string">"order_consumer_group"</span>);
        <span class="hljs-comment">// 2. è®¾ç½®NameServeråœ°å€</span>
        consumer.setNamesrvAddr(<span class="hljs-string">"127.0.0.1:9876"</span>);
        <span class="hljs-comment">// 3. è®¢é˜…Topicï¼ŒæŒ‡å®šæ¶ˆè´¹çš„Tagï¼ˆ*è¡¨ç¤ºæ¶ˆè´¹æ‰€æœ‰Tagï¼‰</span>
        consumer.subscribe(<span class="hljs-string">"order_create"</span>, <span class="hljs-string">"wechat"</span>);
        <span class="hljs-comment">// 4. æ³¨å†Œæ¶ˆæ¯ç›‘å¬å™¨ï¼Œå¤„ç†æ¶ˆæ¯</span>
        consumer.registerMessageListener((MessageListenerConcurrently) (msgs, context) -&gt; {
            <span class="hljs-keyword">for</span> (MessageExt msg : msgs) {
                <span class="hljs-comment">// å¤„ç†æ¶ˆæ¯ï¼šè·å–æ¶ˆæ¯ä½“ã€Keyã€Tagç­‰</span>
                <span class="hljs-type">String</span> <span class="hljs-variable">msgBody</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(msg.getBody());
                System.out.printf(<span class="hljs-string">"é›†ç¾¤æ¶ˆè´¹æ¥æ”¶åˆ°æ¶ˆæ¯ï¼šKey=%sï¼ŒTag=%sï¼Œå†…å®¹=%s%n"</span>, 
                        msg.getKeys(), msg.getTags(), msgBody);
            }
            <span class="hljs-comment">// 5. è¿”å›æ¶ˆè´¹æˆåŠŸçŠ¶æ€ï¼ŒBrokeræ›´æ–°Offset</span>
            <span class="hljs-keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;
            <span class="hljs-comment">// è‹¥æ¶ˆè´¹å¤±è´¥ï¼Œè¿”å›RECONSUME_LATERï¼ŒBrokerä¼šé‡æ–°æ¨é€æ¶ˆæ¯</span>
            <span class="hljs-comment">// return ConsumeConcurrentlyStatus.RECONSUME_LATER;</span>
        });
        <span class="hljs-comment">// 6. å¯åŠ¨æ¶ˆè´¹è€…</span>
        consumer.start();
        System.out.println(<span class="hljs-string">"é›†ç¾¤æ¶ˆè´¹è€…å¯åŠ¨æˆåŠŸ"</span>);
    }
}
</code></pre>
<h5 data-id="heading-34">ï¼ˆ2ï¼‰å¹¿æ’­æ¶ˆè´¹</h5>
<p>åŒä¸€ä¸ª ConsumerGroup çš„æ‰€æœ‰ Consumer å®ä¾‹<strong>æ¶ˆè´¹å…¨é‡æ¶ˆæ¯</strong>ï¼Œä¸€æ¡æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰å®ä¾‹æ¶ˆè´¹ï¼Œé€‚ç”¨äº<strong>é…ç½®åŒæ­¥ã€é€šçŸ¥æ¨é€</strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.rocketmq.client.consumer.DefaultMQPushConsumer;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyContext;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;
<span class="hljs-keyword">import</span> org.apache.rocketmq.client.consumer.listener.MessageListenerConcurrently;
<span class="hljs-keyword">import</span> org.apache.rocketmq.common.message.MessageExt;
<span class="hljs-keyword">import</span> org.apache.rocketmq.common.protocol.heartbeat.MessageModel;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BroadcastConsumer</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">DefaultMQPushConsumer</span> <span class="hljs-variable">consumer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultMQPushConsumer</span>(<span class="hljs-string">"config_consumer_group"</span>);
        consumer.setNamesrvAddr(<span class="hljs-string">"127.0.0.1:9876"</span>);
        consumer.subscribe(<span class="hljs-string">"system_config"</span>, <span class="hljs-string">"*"</span>);
        <span class="hljs-comment">// å…³é”®ï¼šè®¾ç½®æ¶ˆè´¹æ¨¡å¼ä¸ºå¹¿æ’­æ¨¡å¼ï¼ˆé»˜è®¤æ˜¯é›†ç¾¤æ¨¡å¼ï¼‰</span>
        consumer.setMessageModel(MessageModel.BROADCASTING);
        consumer.registerMessageListener((MessageListenerConcurrently) (msgs, context) -&gt; {
            <span class="hljs-keyword">for</span> (MessageExt msg : msgs) {
                System.out.printf(<span class="hljs-string">"å¹¿æ’­æ¶ˆè´¹æ¥æ”¶åˆ°æ¶ˆæ¯ï¼š%s%n"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(msg.getBody()));
            }
            <span class="hljs-keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;
        });
        consumer.start();
        System.out.println(<span class="hljs-string">"å¹¿æ’­æ¶ˆè´¹è€…å¯åŠ¨æˆåŠŸ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-35">å…­ã€ç”Ÿäº§æœ€ä½³å®è·µï¼šé¿å‘ä¸æ€§èƒ½ä¼˜åŒ–</h3>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½¿ç”¨ RocketMQ çš„æ ¸å¿ƒæ˜¯<strong>åˆç†è®¾è®¡ã€è§„é¿å‘ç‚¹ã€ä¼˜åŒ–æ€§èƒ½</strong>ï¼Œä»¥ä¸‹æ˜¯ç»è¿‡æµ·é‡ä¸šåŠ¡éªŒè¯çš„æœ€ä½³å®è·µï¼Œè¦†ç›–<strong>è®¾è®¡ã€å‘é€ã€æ¶ˆè´¹ã€éƒ¨ç½²</strong>å…¨ç¯èŠ‚ã€‚</p>
<h4 data-id="heading-36">6.1 Topic ä¸ Queue è®¾è®¡è§„èŒƒ</h4>
<ol>
<li><strong>Topic å‘½å</strong>ï¼šé‡‡ç”¨<strong>ä¸šåŠ¡æ¨¡å—_æ¶ˆæ¯ç±»å‹</strong>çš„å‘½åè§„èŒƒï¼Œå¦‚<code>trade_order_pay</code>ã€<code>user_register</code>ï¼Œä¾¿äºç®¡ç†ï¼›</li>
<li><strong>Queue æ•°é‡</strong>ï¼šä¸€ä¸ª Topic çš„ Queue æ•°é‡å»ºè®®è®¾ç½®ä¸º<strong>16/32/64</strong>ï¼ˆ2 çš„å¹‚æ¬¡ï¼‰ï¼Œå…¼é¡¾è´Ÿè½½å‡è¡¡å’Œå¹¶è¡Œæ¶ˆè´¹ï¼Œ<strong>Queue æ•°é‡å»ºè®®å¤§äºç­‰äº ConsumerGroup çš„æ¶ˆè´¹è€…å®ä¾‹æ•°</strong>ï¼›</li>
<li><strong>Topic ç²’åº¦</strong>ï¼šä¸€ä¸ªä¸šåŠ¡æ¨¡å—çš„åŒç±»æ¶ˆæ¯ä½¿ç”¨ä¸€ä¸ª Topicï¼Œé€šè¿‡<strong>Tag</strong>åšç»†åˆ†ï¼Œé¿å…åˆ›å»ºè¿‡å¤š Topicï¼ˆå¢åŠ  NameServer å‹åŠ›ï¼‰ï¼›</li>
<li><strong>ç”Ÿäº§ç¯å¢ƒå…³é—­è‡ªåŠ¨åˆ›å»º Topic</strong>ï¼šé€šè¿‡<code>autoCreateTopicEnable=false</code>å…³é—­ï¼Œç”±è¿ç»´äººå‘˜ç»Ÿä¸€åˆ›å»ºå’Œç®¡ç† Topicï¼Œé¿å…æ— æ•ˆ Topic æ³›æ»¥ã€‚</li>
</ol>
<h4 data-id="heading-37">6.2 æ¶ˆæ¯å‘é€ç«¯ä¼˜åŒ–</h4>
<ol>
<li><strong>é¿å…å‘é€å¤§æ¶ˆæ¯</strong>ï¼šRocketMQ é»˜è®¤é™åˆ¶æ¶ˆæ¯ä½“å¤§å°ä¸º 4MBï¼Œå»ºè®®æ¶ˆæ¯ä½“ä¸è¶…è¿‡ 1MBï¼Œå¤§æ¶ˆæ¯å¯æ‹†åˆ†ä¸ºå¤šä¸ªå°æ¶ˆæ¯ï¼Œæˆ–å…ˆå­˜å‚¨åˆ°æ–‡ä»¶ / å¯¹è±¡å­˜å‚¨ï¼Œå†å‘é€æ–‡ä»¶åœ°å€ï¼›</li>
<li><strong>åˆç†è®¾ç½®é‡è¯•æ¬¡æ•°</strong>ï¼šé€šè¿‡<code>setRetryTimesWhenSendFailed</code>è®¾ç½®å‘é€é‡è¯•æ¬¡æ•°ï¼ˆé»˜è®¤ 3 æ¬¡ï¼‰ï¼Œé¿å…è¿‡åº¦é‡è¯•å¯¼è‡´æ¶ˆæ¯é‡å¤ï¼›</li>
<li><strong>è®¾ç½®æ¶ˆæ¯è¶…æ—¶æ—¶é—´</strong>ï¼šé€šè¿‡<code>setSendMsgTimeout</code>è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆé»˜è®¤ 3000msï¼‰ï¼Œæ ¹æ®ä¸šåŠ¡åœºæ™¯è°ƒæ•´ï¼Œé¿å…é˜»å¡ç”Ÿäº§è€…ï¼›</li>
<li><strong>å¤±è´¥å…œåº•</strong>ï¼šåŒæ­¥å‘é€å¤±è´¥æ—¶ï¼Œé™¤äº†æ¡†æ¶é‡è¯•ï¼Œå»ºè®®å¢åŠ <strong>æœ¬åœ°æ•°æ®åº“è½ç›˜</strong>çš„å…œåº•ç­–ç•¥ï¼Œç”±åå°çº¿ç¨‹å®šæ—¶é‡è¯•ï¼Œç¡®ä¿æ¶ˆæ¯ä¸ä¸¢å¤±ã€‚</li>
</ol>
<h4 data-id="heading-38">6.3 æ¶ˆæ¯æ¶ˆè´¹ç«¯ä¼˜åŒ–ï¼ˆé‡ä¸­ä¹‹é‡ï¼‰</h4>
<p>æ¶ˆè´¹ç«¯æ˜¯ RocketMQ ä½¿ç”¨ä¸­<strong>é—®é¢˜æœ€å¤š</strong>çš„ç¯èŠ‚ï¼Œæ ¸å¿ƒä¼˜åŒ–ç‚¹åœ¨äº<strong>å¹‚ç­‰æ€§ã€é¿å…æ¶ˆæ¯å †ç§¯ã€å‡å°‘æ¶ˆè´¹å»¶è¿Ÿ</strong>ã€‚</p>
<h5 data-id="heading-39">ï¼ˆ1ï¼‰å¿…é¡»å®ç°æ¶ˆè´¹å¹‚ç­‰æ€§</h5>
<p>RocketMQ<strong>æ— æ³•ä¿è¯æ¶ˆæ¯ä¸é‡å¤</strong>ï¼ˆå¦‚ç½‘ç»œæŠ–åŠ¨ã€Broker é‡æ¨ã€æ¶ˆè´¹è€…é‡å¯ï¼‰ï¼Œå› æ­¤<strong>æ¶ˆè´¹ç«¯å¿…é¡»å®ç°å¹‚ç­‰æ€§</strong>ï¼Œæ ¸å¿ƒå®ç°æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>åŸºäºå”¯ä¸€é”®</strong>ï¼šç”¨æ¶ˆæ¯çš„<code>Key</code>ï¼ˆä¸šåŠ¡å”¯ä¸€ IDï¼Œå¦‚è®¢å• IDï¼‰ä½œä¸ºå¹‚ç­‰é”®ï¼Œå­˜å…¥ Redis / æ•°æ®åº“ï¼Œæ¶ˆè´¹å‰å…ˆåˆ¤æ–­æ˜¯å¦å·²å¤„ç†ï¼›</li>
<li><strong>åŸºäºæ•°æ®åº“å”¯ä¸€ç´¢å¼•</strong>ï¼šæ¶ˆè´¹æ—¶æ‰§è¡Œæ•°æ®åº“æ“ä½œï¼Œé€šè¿‡å”¯ä¸€ç´¢å¼•é¿å…é‡å¤æ’å…¥ / æ›´æ–°ï¼›</li>
<li><strong>åŸºäº Offset</strong>ï¼šå¯¹äºæœ‰åºæ¶ˆæ¯ï¼Œé€šè¿‡ Queue çš„ Offset å®ç°å¹‚ç­‰ï¼Œç¡®ä¿æ¯ä¸ª Offset ä»…æ¶ˆè´¹ä¸€æ¬¡ã€‚</li>
</ul>
<p><strong>å¹‚ç­‰æ€§å®ç°ç¤ºä¾‹ï¼ˆRedisï¼‰</strong> ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¶ˆè´¹å‰åˆ¤æ–­æ˜¯å¦å·²å¤„ç†</span>
<span class="hljs-type">String</span> <span class="hljs-variable">msgKey</span> <span class="hljs-operator">=</span> msg.getKeys();
<span class="hljs-keyword">if</span> (redisTemplate.opsForValue().setIfAbsent(msgKey, <span class="hljs-string">"processed"</span>, <span class="hljs-number">1</span>, TimeUnit.HOURS)) {
    <span class="hljs-comment">// æœªå¤„ç†ï¼Œæ‰§è¡Œæ¶ˆè´¹é€»è¾‘</span>
    processMessage(msg);
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// å·²å¤„ç†ï¼Œç›´æ¥è¿”å›æˆåŠŸ</span>
    <span class="hljs-keyword">return</span> ConsumeConcurrentlyStatus.CONSUME_SUCCESS;
}
</code></pre>
<h5 data-id="heading-40">ï¼ˆ2ï¼‰é¿å…é•¿æ¶ˆè´¹</h5>
<p>Consumer å¤„ç†å•æ¡æ¶ˆæ¯çš„æ—¶é—´å»ºè®®<strong>ä¸è¶…è¿‡ 300ms</strong>ï¼Œé¿å…é•¿æ¶ˆè´¹å¯¼è‡´ Broker è®¤ä¸ºæ¶ˆè´¹è¶…æ—¶ï¼Œé‡æ–°æ¨é€æ¶ˆæ¯ï¼Œé€ æˆé‡å¤æ¶ˆè´¹å’Œå †ç§¯ã€‚</p>
<ul>
<li>é•¿è€—æ—¶ä¸šåŠ¡ï¼šå°†æ¶ˆæ¯è½¬ä¸º<strong>ä»»åŠ¡</strong>ï¼ŒæŠ•é€’åˆ°ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿï¼ˆå¦‚ XXL-Jobï¼‰å¼‚æ­¥å¤„ç†ï¼ŒConsumer ä»…åšæ¶ˆæ¯è½¬å‘ï¼›</li>
<li>æ‰¹é‡æ¶ˆè´¹ï¼šé€šè¿‡<code>setConsumeMessageBatchMaxSize</code>è®¾ç½®æ‰¹é‡æ¶ˆè´¹æ•°é‡ï¼ˆé»˜è®¤ 1ï¼‰ï¼Œæ‰¹é‡å¤„ç†æ¶ˆæ¯å‡å°‘æ•°æ®åº“ / ç½‘ç»œäº¤äº’æ¬¡æ•°ã€‚</li>
</ul>
<h5 data-id="heading-41">ï¼ˆ3ï¼‰åˆç†è®¾ç½®æ¶ˆè´¹çº¿ç¨‹æ•°</h5>
<p>é€šè¿‡<code>setConsumeThreadMin</code>å’Œ<code>setConsumeThreadMax</code>è®¾ç½®æ¶ˆè´¹çº¿ç¨‹æ± çš„æ ¸å¿ƒå’Œæœ€å¤§çº¿ç¨‹æ•°ï¼Œå»ºè®®æ ¹æ®ä¸šåŠ¡ QPS è°ƒæ•´ï¼Œä¸€èˆ¬è®¾ç½®ä¸º<strong>16/32</strong>ï¼Œé¿å…çº¿ç¨‹æ•°è¿‡å¤šå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p>
<h5 data-id="heading-42">ï¼ˆ4ï¼‰åŠæ—¶å¤„ç†æ­»ä¿¡é˜Ÿåˆ—</h5>
<p>ç›‘æ§æ­»ä¿¡é˜Ÿåˆ—çš„æ¶ˆæ¯æ•°é‡ï¼Œä¸€æ—¦æœ‰æ¶ˆæ¯è¿›å…¥ï¼Œç«‹å³æ’æŸ¥æ¶ˆè´¹å¤±è´¥åŸå› ï¼ˆå¦‚ä¸šåŠ¡ä»£ç å¼‚å¸¸ã€ä¾èµ–æœåŠ¡ä¸å¯ç”¨ï¼‰ï¼Œå¤„ç†å®Œæˆåå¯å°†æ­»ä¿¡é˜Ÿåˆ—çš„æ¶ˆæ¯é‡æ–°å‘é€åˆ°åŸ Topicã€‚</p>
<h4 data-id="heading-43">6.4 é›†ç¾¤éƒ¨ç½²ä¸å¯é æ€§å»ºè®®</h4>
<ol>
<li><strong>NameServer é›†ç¾¤</strong>ï¼šè‡³å°‘éƒ¨ç½²<strong>3 ä¸ªå®ä¾‹</strong>ï¼Œé¿å…å•ç‚¹æ•…éšœï¼Œå®ä¾‹æ•°å»ºè®®ä¸ºå¥‡æ•°ï¼›</li>
<li><strong>Broker ä¸»ä»æ¶æ„</strong>ï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»éƒ¨ç½²ä¸»ä»ï¼ŒMaster å’Œ Slave éƒ¨ç½²åœ¨ä¸åŒæœºå™¨ï¼Œå»ºè®®é‡‡ç”¨<strong>SYNC_MASTERï¼ˆåŒæ­¥ä¸»ï¼‰+ SLAVE</strong>çš„å¤åˆ¶ç­–ç•¥ï¼Œæ ¸å¿ƒä¸šåŠ¡é‡‡ç”¨<strong>åŒæ­¥åˆ·ç›˜</strong>ï¼›</li>
<li><strong>ç£ç›˜é€‰æ‹©</strong>ï¼šBroker çš„å­˜å‚¨ç£ç›˜å»ºè®®ä½¿ç”¨<strong>SSD</strong>ï¼Œæå‡éšæœºè¯»æ€§èƒ½ï¼ŒåŒæ—¶å°† CommitLog å’Œ ConsumeQueue å­˜å‚¨åœ¨ä¸åŒç£ç›˜ï¼Œåˆ†ç¦» IO å‹åŠ›ï¼›</li>
<li><strong>å¼€å¯ç›‘æ§</strong>ï¼šéƒ¨ç½² RocketMQ Dashboard æˆ–æ¥å…¥ Prometheus+Grafanaï¼Œç›‘æ§ Topic çš„æ¶ˆæ¯å †ç§¯ã€æ¶ˆè´¹å»¶è¿Ÿã€Broker çš„ç£ç›˜ä½¿ç”¨ç‡ã€TPS ç­‰æ ¸å¿ƒæŒ‡æ ‡ã€‚</li>
</ol>
<h4 data-id="heading-44">6.5 å¸¸è§å‘ç‚¹è§„é¿</h4>
<ol>
<li><strong>ConsumerGroup é‡å</strong>ï¼šä¸åŒä¸šåŠ¡çš„ ConsumerGroup ä¸èƒ½é‡åï¼Œå¦åˆ™ä¼šå¯¼è‡´è´Ÿè½½å‡è¡¡å¼‚å¸¸ï¼Œæ¶ˆæ¯æ¶ˆè´¹æ··ä¹±ï¼›</li>
<li><strong>æ¶ˆæ¯ä½“åºåˆ—åŒ–</strong>ï¼šå»ºè®®ä½¿ç”¨ JSON/Protobuf åºåˆ—åŒ–ï¼Œé¿å…ä½¿ç”¨ Java åŸç”Ÿåºåˆ—åŒ–ï¼ˆåºåˆ—åŒ–åä½“ç§¯å¤§ã€å…¼å®¹æ€§å·®ï¼‰ï¼›</li>
<li><strong>é¿å…åœ¨æ¶ˆè´¹ç«¯æŠ›å‡ºæœªæ•è·å¼‚å¸¸</strong>ï¼šæœªæ•è·å¼‚å¸¸ä¼šå¯¼è‡´ Consumer é‡å¯ï¼Œå»ºè®®æ•è·æ‰€æœ‰å¼‚å¸¸ï¼Œæ ¹æ®å¼‚å¸¸ç±»å‹è¿”å›<code>CONSUME_SUCCESS</code>æˆ–<code>RECONSUME_LATER</code>ï¼›</li>
<li><strong>ä¸è¦éšæ„ä¿®æ”¹ Offset</strong>ï¼šæ‰‹åŠ¨ä¿®æ”¹ Offset å¯èƒ½å¯¼è‡´æ¶ˆæ¯é‡å¤æ¶ˆè´¹æˆ–ä¸¢å¤±ï¼Œä»…åœ¨æ•°æ®æ¢å¤æ—¶ä½¿ç”¨ã€‚</li>
</ol>
<h3 data-id="heading-45">ä¸ƒã€ä¸»æµæ¶ˆæ¯ä¸­é—´ä»¶å¯¹æ¯”ï¼šRocketMQ/Kafka/RabbitMQ</h3>
<p>ç›®å‰åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸»æµçš„æ¶ˆæ¯ä¸­é—´ä»¶ä¸º<strong>RocketMQã€Kafkaã€RabbitMQ</strong>ï¼Œä¸‰è€…åœ¨æ¶æ„è®¾è®¡ã€æ€§èƒ½ã€ç‰¹æ€§ä¸Šå„æœ‰ä¼˜åŠ£ï¼Œä»¥ä¸‹ä»<strong>æ ¸å¿ƒç»´åº¦</strong>åšå¯¹æ¯”ï¼Œå¹¶ç»™å‡ºé€‰å‹å»ºè®®ã€‚</p>
<h4 data-id="heading-46">7.1 æ ¸å¿ƒç»´åº¦å¯¹æ¯”</h4>







































































<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>Apache RocketMQ</th><th>Apache Kafka</th><th>RabbitMQ</th></tr></thead><tbody><tr><td>å¼€å‘å›¢é˜Ÿ</td><td>é˜¿é‡Œå·´å·´</td><td>LinkedIn</td><td>Rabbit Technologies</td></tr><tr><td>åº•å±‚è¯­è¨€</td><td>Java</td><td>Scala/Java</td><td>Erlang</td></tr><tr><td>æ ¸å¿ƒæ¶æ„</td><td>NameServer+Broker ä¸»ä»</td><td>æ— ä¸­å¿ƒï¼ŒBroker é›†ç¾¤</td><td>ä¸»ä» / é•œåƒï¼ŒExchange+Queue</td></tr><tr><td>å•æœº TPS</td><td>10 ä¸‡çº§ï¼ˆåä¸‡çº§ï¼‰</td><td>100 ä¸‡çº§ï¼ˆç™¾ä¸‡çº§ï¼‰</td><td>1 ä¸‡çº§ï¼ˆä¸‡çº§ï¼‰</td></tr><tr><td>æ¶ˆæ¯å»¶è¿Ÿ</td><td>3ms å·¦å³</td><td>10ms ä»¥å†…</td><td>1ms ä»¥å†…ï¼ˆå†…å­˜ï¼‰</td></tr><tr><td>å †ç§¯èƒ½åŠ›</td><td>TB çº§ï¼Œæ€§èƒ½æ— æ˜æ˜¾ä¸‹é™</td><td>TB çº§ï¼Œæ€§èƒ½æ— æ˜æ˜¾ä¸‹é™</td><td>GB çº§ï¼Œå†…å­˜å—é™</td></tr><tr><td>æ ¸å¿ƒç‰¹æ€§</td><td>äº‹åŠ¡æ¶ˆæ¯ã€é¡ºåºæ¶ˆæ¯ã€å»¶æ—¶æ¶ˆæ¯ã€æ­»ä¿¡é˜Ÿåˆ—</td><td>é«˜ååã€æµå¤„ç†ã€ä¸å¤§æ•°æ®ç”Ÿæ€æ— ç¼é›†æˆ</td><td>çµæ´»è·¯ç”±ï¼ˆ4 ç§ Exchangeï¼‰ã€å»¶è¿Ÿé˜Ÿåˆ—ã€æ­»ä¿¡é˜Ÿåˆ—</td></tr><tr><td>åˆ†å¸ƒå¼äº‹åŠ¡</td><td>åŸç”Ÿæ”¯æŒï¼ˆåŠæ¶ˆæ¯ï¼‰</td><td>å¼±æ”¯æŒï¼ˆäº‹åŠ¡ APIï¼‰</td><td>æ— åŸç”Ÿæ”¯æŒï¼ˆéœ€æ‰‹åŠ¨å®ç°ï¼‰</td></tr><tr><td>ç”Ÿæ€é›†æˆ</td><td>é€‚é…å¾®æœåŠ¡ï¼ˆSpring Cloudï¼‰ã€äº‘åŸç”Ÿ</td><td>ä¸ Flink/Spark/Hadoop æ— ç¼é›†æˆï¼Œå¤§æ•°æ®é¦–é€‰</td><td>å¤šè¯­è¨€æ”¯æŒå¥½ï¼Œé€‚é…ä¼ä¸šçº§å¤æ‚ä¸šåŠ¡</td></tr><tr><td>è¿ç»´æˆæœ¬</td><td>ä½ï¼Œæ˜“éƒ¨ç½²ã€æ˜“ç›‘æ§</td><td>ä¸­ï¼Œéœ€ä¼˜åŒ–é…ç½®</td><td>é«˜ï¼ŒErlang å¼€å‘ï¼Œæ’éšœå¤æ‚</td></tr></tbody></table>
<h4 data-id="heading-47">7.2 é€‰å‹å»ºè®®</h4>
<ol>
<li><strong>é€‰ RocketMQ</strong>ï¼šç”µå•†ã€é‡‘èã€æ”¯ä»˜ç­‰<strong>äº’è”ç½‘æ ¸å¿ƒä¸šåŠ¡</strong>ï¼Œéœ€è¦<strong>åˆ†å¸ƒå¼äº‹åŠ¡ã€é¡ºåºæ¶ˆæ¯ã€é«˜å¯é æ€§</strong>ï¼ŒåŒæ—¶å…¼é¡¾ååæ€§èƒ½ï¼Œå¾®æœåŠ¡æ¶æ„ä¼˜å…ˆé€‰æ‹©ï¼›</li>
<li><strong>é€‰ Kafka</strong>ï¼š<strong>å¤§æ•°æ®åœºæ™¯</strong>ï¼Œå¦‚æ—¥å¿—é‡‡é›†ã€ç”¨æˆ·è¡Œä¸ºåŸ‹ç‚¹ã€å®æ—¶è®¡ç®—ï¼ˆFlink/Sparkï¼‰ï¼Œè¿½æ±‚æè‡´ååå’Œæ•°æ®æŒä¹…åŒ–ï¼Œæ— éœ€å¤æ‚çš„æ¶ˆæ¯ç‰¹æ€§ï¼›</li>
<li><strong>é€‰ RabbitMQ</strong>ï¼š<strong>ä¼ä¸šçº§å¤æ‚ä¸šåŠ¡</strong>ï¼Œéœ€è¦<strong>çµæ´»çš„æ¶ˆæ¯è·¯ç”±ã€å¤šè¯­è¨€æ”¯æŒ</strong>ï¼Œä¸šåŠ¡é‡è¾ƒå°ï¼Œå¯¹ååè¦æ±‚ä¸é«˜ï¼ˆå¦‚å†…éƒ¨ç³»ç»Ÿé€šçŸ¥ã€é…ç½®åŒæ­¥ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-48">å…«ã€æ€»ç»“ä¸å­¦ä¹ å»ºè®®</h3>
<p>Apache RocketMQ ä½œä¸ºä¸€æ¬¾<strong>å›½äº§å¼€æºã€é‡‘èçº§ã€äº‘åŸç”Ÿ</strong>çš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå‡­å€Ÿå…¶<strong>æç®€æ¶æ„ã€é«˜æ€§èƒ½ã€ä¸°å¯Œçš„ä¼ä¸šçº§ç‰¹æ€§</strong>ï¼Œå·²æˆä¸ºäº’è”ç½‘åç«¯å¼€å‘çš„ä¸»æµé€‰æ‹©ï¼Œå…¶è®¾è®¡æ€æƒ³ï¼ˆå¦‚ CommitLog+ConsumeQueue åˆ†å±‚å­˜å‚¨ã€é¡ºåºå†™ä¼˜åŒ–ï¼‰ä¹Ÿå€¼å¾—æ‰€æœ‰åç«¯å¼€å‘è€…å­¦ä¹ ã€‚</p>
<h4 data-id="heading-49">8.1 æ ¸å¿ƒæ€»ç»“</h4>
<ol>
<li>RocketMQ çš„æ ¸å¿ƒæ¶æ„ä¸º<strong>NameServer+Broker+Producer+Consumer</strong>ï¼Œæ— çŠ¶æ€ä¸­å¿ƒè®¾è®¡è®©é›†ç¾¤æ‰©å±•çµæ´»ï¼Œä¸»ä»æ¶æ„ä¿è¯é«˜å¯ç”¨ï¼›</li>
<li>é«˜æ€§èƒ½çš„æœ¬è´¨æ˜¯<strong>CommitLog çš„é¡ºåºå†™</strong>+<strong>ConsumeQueue çš„è½»é‡ç´¢å¼•</strong>+<strong>mmap é›¶æ‹·è´</strong>ï¼Œå½»åº•è§£å†³ç£ç›˜ IO ç“¶é¢ˆï¼›</li>
<li>ä¸°å¯Œçš„ä¼ä¸šçº§ç‰¹æ€§ï¼ˆäº‹åŠ¡æ¶ˆæ¯ã€é¡ºåºæ¶ˆæ¯ã€å»¶æ—¶æ¶ˆæ¯ï¼‰è®© RocketMQ é€‚é…å‡ ä¹æ‰€æœ‰äº’è”ç½‘ä¸šåŠ¡åœºæ™¯ï¼›</li>
<li>ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„æ ¸å¿ƒæ˜¯<strong>æ¶ˆè´¹ç«¯å¹‚ç­‰æ€§</strong>+<strong>åˆç†çš„ Topic/Queue è®¾è®¡</strong>+<strong>é›†ç¾¤éƒ¨ç½²</strong>ï¼Œè¿™æ˜¯é¿å…é—®é¢˜çš„å…³é”®ã€‚</li>
</ol>
<h4 data-id="heading-50">8.2 å­¦ä¹ å»ºè®®</h4>
<ol>
<li><strong>å…¥é—¨é˜¶æ®µ</strong>ï¼šè·‘é€šæœ¬æ–‡çš„ Java Demoï¼Œç†Ÿæ‚‰æ¶ˆæ¯çš„å‘é€å’Œæ¶ˆè´¹ï¼Œç†è§£æ ¸å¿ƒæ¦‚å¿µï¼ˆTopicã€Queueã€Groupï¼‰ï¼›</li>
<li><strong>è¿›é˜¶é˜¶æ®µ</strong>ï¼šæ­å»º RocketMQ é›†ç¾¤ï¼Œç ”ç©¶<strong>æ¶ˆæ¯å­˜å‚¨ã€åˆ·ç›˜å¤åˆ¶ã€äº‹åŠ¡æ¶ˆæ¯</strong>çš„åº•å±‚åŸç†ï¼Œé˜…è¯»å®˜æ–¹æ–‡æ¡£å’Œæºç ï¼›</li>
<li><strong>å®æˆ˜é˜¶æ®µ</strong>ï¼šåœ¨å®é™…é¡¹ç›®ä¸­ä½¿ç”¨ RocketMQ è§£å†³<strong>ç³»ç»Ÿè§£è€¦ã€æµé‡å‰Šå³°ã€åˆ†å¸ƒå¼äº‹åŠ¡</strong>ç­‰é—®é¢˜ï¼Œç§¯ç´¯ç”Ÿäº§æ’éšœç»éªŒï¼›</li>
<li><strong>é¢è¯•é˜¶æ®µ</strong>ï¼šé‡ç‚¹æŒæ¡<strong>æ¶æ„è®¾è®¡ã€æ¶ˆæ¯å­˜å‚¨åŸç†ã€å¯é æ€§æœºåˆ¶ã€ç”Ÿäº§æœ€ä½³å®è·µ</strong>ï¼Œè¿™äº›æ˜¯é¢è¯•çš„é«˜é¢‘è€ƒç‚¹ã€‚</li>
</ol>
<p>RocketMQ çš„å­¦ä¹ å¹¶éä¸€è¹´è€Œå°±ï¼Œéœ€è¦ç»“åˆ<strong>ç†è®º + å®æˆ˜</strong>ï¼Œæ·±å…¥ç†è§£å…¶è®¾è®¡æ€æƒ³ï¼Œæ‰èƒ½åœ¨å®é™…é¡¹ç›®ä¸­çµæ´»è¿ç”¨ï¼Œå‘æŒ¥å…¶æœ€å¤§ä»·å€¼ã€‚</p>
<p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Frocketmq.apache.org%2Fzh%2Fdocs%2Fintroduction%2F01whatis" target="_blank" title="https://rocketmq.apache.org/zh/docs/introduction/01whatis" ref="nofollow noopener noreferrer">Apache RocketMQ å®˜æ–¹æ–‡æ¡£</a></li>
<li>RocketMQ 5.0 æºç </li>
<li>ã€ŠRocketMQ å®æˆ˜ä¸åŸç†è§£æã€‹</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯è¿œç¨‹ç»„ä»¶æ–¹æ¡ˆè®¾è®¡]]></title>    <link>https://juejin.cn/post/7601077764424204338</link>    <guid>https://juejin.cn/post/7601077764424204338</guid>    <pubDate>2026-01-31T11:34:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601077764424204338" data-draft-id="7601020578491154441" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯è¿œç¨‹ç»„ä»¶æ–¹æ¡ˆè®¾è®¡"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-31T11:34:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‰“å·¥ä»”å¼ æŸ"/> <meta itemprop="url" content="https://juejin.cn/user/3131880356450007"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯è¿œç¨‹ç»„ä»¶æ–¹æ¡ˆè®¾è®¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3131880356450007/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‰“å·¥ä»”å¼ æŸ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T11:34:15.000Z" title="Sat Jan 31 2026 11:34:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>åŸºäº Webpack 5 Module Federation çš„å¾®æ¨¡å—æ¶æ„ï¼Œå®ç°ç»„ä»¶çº§çš„è¿è¡Œæ—¶åŠ è½½ä¸ç‹¬ç«‹éƒ¨ç½²ã€‚</p>
</blockquote>
<h2 data-id="heading-0">1. ç›®æ ‡ (Goals)</h2>
<p>å®ç°ä¸€ä¸ªé«˜æ•ˆã€å¯æ‰©å±•çš„è¿œç¨‹ç»„ä»¶æ¶æ„ï¼Œæ”¯æŒï¼š</p>
<ul>
<li><strong>è¿è¡Œæ—¶åŠ è½½</strong>: å®¿ä¸»åº”ç”¨åœ¨è¿è¡Œæ—¶ä» CDN åŠ è½½ç»„ä»¶ï¼Œæ— éœ€æ„å»ºæ—¶é™æ€å¯¼å…¥ã€‚</li>
<li><strong>ç‹¬ç«‹éƒ¨ç½²</strong>: è¿œç¨‹ç»„ä»¶é¡¹ç›®æ›´æ–°åï¼Œå®¿ä¸»åº”ç”¨æ— éœ€é‡æ–°æ‰“åŒ…å³å¯ç”Ÿæ•ˆï¼Œè§£è€¦å¼€å‘å‘¨æœŸã€‚</li>
<li><strong>åŠ¨æ€ä¾èµ–å…±äº«</strong>: è‡ªåŠ¨å¤„ç† Reactã€Mobx ç­‰å…¬å…±ä¾èµ–ï¼Œé¿å…é‡å¤åŠ è½½ï¼Œä¿è¯å•ä¾‹è¿è¡Œã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-1">2. æ–¹æ¡ˆå¯¹æ¯” (Solution Comparison)</h2>
<p>ä¸ºè¯´æ˜æœ¬æ–¹æ¡ˆï¼ˆWebpack 5 Module Federationï¼‰é€‰æ‹©çš„åˆç†æ€§ï¼Œè¿™é‡Œå¯¹å¸¸è§å‡ ç±»â€œè¿œç¨‹ç»„ä»¶/è¿œç¨‹æ¨¡å—â€æ–¹æ¡ˆè¿›è¡Œå¯¹æ¯”ã€‚</p>
<h3 data-id="heading-2">2.1 å…¸å‹æ–¹æ¡ˆæ¦‚è§ˆ</h3>





























































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>åŠ è½½æ–¹å¼</th><th>ä¾èµ–å…±äº«</th><th>éš”ç¦»æ€§</th><th>å‘å¸ƒ/å›æ»šæˆæœ¬</th><th>å…¸å‹é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>NPM ç»„ä»¶åº“</strong></td><td>æ„å»ºæ—¶å®‰è£…ã€æ‰“åŒ…</td><td>æ— ï¼ˆå„è‡ªæ‰“åŒ…è¿› Hostï¼‰</td><td>é«˜ï¼ˆæŒ‰æ¨¡å—è¾¹ç•Œï¼‰</td><td>é«˜ï¼ˆæ¯æ¬¡éƒ½è¦é‡æ–°å‘ç‰ˆ + é‡å»º Hostï¼‰</td><td>è®¾è®¡ç³»ç»Ÿã€ç¨³å®šåŸºç¡€ç»„ä»¶</td></tr><tr><td><strong>CDN UMD ç»„ä»¶ + <code>window.xxx</code></strong></td><td>è¿è¡Œæ—¶ <code>&lt;script&gt;</code> æ³¨å…¥</td><td>æ‰‹åŠ¨å¤„ç†ï¼ˆé€šå¸¸é‡å¤åŠ è½½ï¼‰</td><td>ä½ï¼ˆæ˜“æ±¡æŸ“å…¨å±€ï¼‰</td><td>ä¸­ï¼ˆå¯æ›¿æ¢ CDN ç‰ˆæœ¬ï¼Œä½†æ¥å£å˜æ›´éš¾ç®¡æ§ï¼‰</td><td>è€é¡¹ç›®ã€ç®€å•æŒ‚ä¸šåŠ¡æ’ä»¶</td></tr><tr><td><strong>iframe å¾®å‰ç«¯</strong></td><td>è¿è¡Œæ—¶ <code>&lt;iframe&gt;</code></td><td>å®é™…æ— å…±äº«ï¼ˆå¼ºéš”ç¦»ï¼‰</td><td>å¾ˆé«˜ï¼ˆJS/CSS å…¨éš”ç¦»ï¼‰</td><td>ä¸­ï¼ˆç‹¬ç«‹å‘å¸ƒï¼Œä½†é›†æˆä½“éªŒå·®ï¼‰</td><td>å®Œæ•´å­ç³»ç»ŸåµŒå…¥ã€ä¸åŒæŠ€æœ¯æ ˆå…±å­˜</td></tr><tr><td><strong>åº”ç”¨çº§å¾®å‰ç«¯ (qiankun)</strong></td><td>è¿è¡Œæ—¶åŠ è½½æ•´ä¸ªåº”ç”¨</td><td>ä¾èµ–å…±äº«æœ‰é™/éœ€è‡ªç ”</td><td>ä¸­ï¼ˆçº¦å®šå¼éš”ç¦»ï¼‰</td><td>ä¸­ï¼ˆå­åº”ç”¨ç‹¬ç«‹å‘å¸ƒï¼‰</td><td>å¤šè·¯ç”±/å¤šé¡µé¢çº§åˆ«æ‹†åˆ†</td></tr><tr><td><strong>è‡ªç ” Runtime Loader</strong></td><td>è¿è¡Œæ—¶æŒ‰ URL åŠ è½½æ¨¡å—</td><td>å¯æ‰‹åŠ¨å®ç°ï¼Œä½†å¤æ‚</td><td>å–å†³äºå®ç°</td><td>ä¸­é«˜ï¼ˆåè®®ç¨³å®šæ€§è¦è‡ªæ§ï¼‰</td><td>éœ€æ”¯æŒå¤šæ„å»ºå·¥å…·ã€å¤šè¯­è¨€æ¨¡å—</td></tr><tr><td><strong>Module Federation (æœ¬æ–¹æ¡ˆ)</strong></td><td>è¿è¡Œæ—¶æŒ‰æ¨¡å—ååŠ è½½</td><td>å†…ç½® shared æœºåˆ¶</td><td>ä¸­é«˜ï¼ˆæ¨¡å—è¾¹ç•Œæ¸…æ™°ï¼‰</td><td>ä½ï¼ˆRemote ç‹¬ç«‹å‘å¸ƒï¼‰</td><td>â€œç»„ä»¶çº§â€è¿œç¨‹åŠ è½½ï¼ŒReact ä¸šåŠ¡æ‹†åˆ†</td></tr></tbody></table>
<h3 data-id="heading-3">2.2 æ ¸å¿ƒå·®å¼‚åˆ†æ</h3>
<ol>
<li><strong>ä¸ NPM ç»„ä»¶åº“çš„å¯¹æ¯”</strong>ï¼šNPM æ–¹æ¡ˆæ˜¯<strong>æ„å»ºæ—¶ç»‘å®š</strong>ï¼Œæ— æ³•åšåˆ°çœŸæ­£çš„è¿è¡Œæ—¶çƒ­æ›´æ–°ï¼›è€Œ MF æ”¯æŒ Remote ç‹¬ç«‹éƒ¨ç½²ï¼ŒHost æ— éœ€é‡å»ºå³å¯ç”Ÿæ•ˆã€‚</li>
<li><strong>ä¸ iframe / åº”ç”¨çº§å¾®å‰ç«¯çš„å¯¹æ¯”</strong>ï¼šiframe é€‚åˆæ•´åº”ç”¨éš”ç¦»ï¼Œä½†å¯¹â€œå•ä¸ªç»„ä»¶â€çº§åˆ«çš„å¤ç”¨éå¸¸ç¬¨é‡ï¼›MF å°±åƒ <code>import</code> æœ¬åœ°ç»„ä»¶ä¸€æ ·è‡ªç„¶ã€‚</li>
<li><strong>ä¸ CDN UMD / è‡ªç ” Loader çš„å¯¹æ¯”</strong>ï¼šMF å°†â€œå®¹å™¨ç®¡ç†ã€ç‰ˆæœ¬åå•†ã€ä¾èµ–å•ä¾‹åŒ–â€æ¡†æ¶åŒ–ä¸º Webpack ç‰¹æ€§ï¼Œç›¸æ¯”è‡ªç ”æ–¹æ¡ˆå¤§å¹…é™ä½äº†å·¥ç¨‹è½åœ°æˆæœ¬ã€‚</li>
</ol>
<h3 data-id="heading-4">2.3 æœ¬æ–¹æ¡ˆå®šä½</h3>
<p>ç»¼åˆæ¥çœ‹ï¼Œæœ¬æ–¹æ¡ˆä¸»è¦é’ˆå¯¹ <strong>ç»„ä»¶çº§ / ä¸šåŠ¡æ¨¡å—çº§</strong> çš„è¿œç¨‹åŠ è½½ï¼Œæ—¨åœ¨å¹³è¡¡â€œä¸šåŠ¡å¤æ‚åº¦ã€è¿­ä»£æ•ˆç‡ã€å·¥ç¨‹æˆæœ¬â€ã€‚</p>
<hr/>
<h2 data-id="heading-5">3. æŠ€æœ¯é€‰å‹ (Tech Stack)</h2>
<ul>
<li><strong>æ„å»ºå·¥å…·</strong>: Webpack 5</li>
<li><strong>æ ¸å¿ƒæ’ä»¶</strong>: <code>ModuleFederationPlugin</code></li>
<li><strong>çŠ¶æ€ç®¡ç†</strong>: Mobx 6+ (æ”¯æŒè·¨å®¹å™¨çŠ¶æ€å…±äº«)</li>
<li><strong>UI æ¡†æ¶</strong>: React 18</li>
<li><strong>æ ·å¼æ–¹æ¡ˆ</strong>: CSS Modules + Tailwind CSS</li>
</ul>
<h2 data-id="heading-6">4. æ ¸å¿ƒæ¶æ„ (Core Architecture)</h2>
<h3 data-id="heading-7">4.1 æ¶æ„æ¨¡å‹</h3>
<p>é‡‡ç”¨ <strong>Provider-Consumer (æä¾›è€…-æ¶ˆè´¹è€…)</strong> æ¨¡å‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    subgraph "Remote (Provider)"
        A[RemoteTable] --&gt; B[remoteEntry.js]
        C[RemoteForm] --&gt; B
    end
    
    subgraph "Host (Consumer)"
        D[Dashboard] -.-&gt;|åŠ¨æ€æ‹‰å–| B
        E[Settings] -.-&gt;|åŠ¨æ€æ‹‰å–| B
    end
    
    subgraph "Shared Scope"
        F[React/ReactDOM]
        G[Mobx/Lite]
    end
    
    B --&gt; F
    B --&gt; G
    D --&gt; F
    D --&gt; G
</code></pre>
<ul>
<li><strong>Remote (Provider)</strong>: <code>apps/RemoteComponent</code>
<ul>
<li>è´Ÿè´£å®šä¹‰ã€æ‰“åŒ…å¹¶å¯¼å‡ºåŸå­åŒ–æˆ–ä¸šåŠ¡çº§ç»„ä»¶ã€‚</li>
<li>ç”Ÿæˆ <code>remoteEntry.js</code> ä½œä¸ºåŠ¨æ€åŠ è½½çš„æ¸…å•æ–‡ä»¶ã€‚</li>
</ul>
</li>
<li><strong>Host (Consumer)</strong>: å…¶ä»–ä¸šåŠ¡é¡¹ç›® (å¦‚ <code>apps/admin</code>)
<ul>
<li>é…ç½®è¿œç¨‹èŠ‚ç‚¹ï¼Œé€šè¿‡å¼‚æ­¥æ–¹å¼æ¶ˆè´¹è¿œç¨‹ç»„ä»¶ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-8">4.2 æ ·å¼éš”ç¦»ç­–ç•¥ (Styling)</h3>
<ul>
<li><strong>CSS Modules (æ¨è)</strong>: é»˜è®¤æ–¹æ¡ˆã€‚é€šè¿‡ç±»å Hash ç¡®ä¿æ ·å¼ä»…åœ¨ç»„ä»¶å†…ç”Ÿæ•ˆã€‚</li>
<li><strong>Tailwind Prefix</strong>: è‹¥ä½¿ç”¨ Tailwindï¼Œå¿…é¡»é…ç½®å…¨å±€å‰ç¼€ (å¦‚ <code>rc-</code>) ä»¥é˜²è¦†ç›–å®¿ä¸»æ ·å¼ã€‚</li>
<li><strong>Shadow DOM (å¯é€‰)</strong>: é’ˆå¯¹æå…¶å¤æ‚çš„æ ·å¼éš”ç¦»éœ€æ±‚ï¼Œå¯è€ƒè™‘å°†è¿œç¨‹ç»„ä»¶æŒ‚è½½åœ¨ Shadow Root ä¸‹ã€‚</li>
</ul>
<h2 data-id="heading-9">5. ç›®å½•ç»“æ„ (Directory Structure)</h2>
<pre><code class="hljs language-text" lang="text">apps/RemoteComponent/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/         # è¿œç¨‹æš´éœ²çš„ç»„ä»¶é›†åˆ
â”‚   â”‚   â”œâ”€â”€ RemoteTable/    # ä¸šåŠ¡ç»„ä»¶ç¤ºä¾‹
â”‚   â”‚   â””â”€â”€ index.ts        # ç»Ÿä¸€å¯¼å‡ºå…¥å£
â”‚   â”œâ”€â”€ bootstrap.tsx       # å¼‚æ­¥å¯åŠ¨é€»è¾‘
â”‚   â”œâ”€â”€ App.tsx             # æœ¬åœ°å¼€å‘é¢„è§ˆç¯å¢ƒ
â”‚   â””â”€â”€ index.tsx           # Webpack å…¥å£
â”œâ”€â”€ webpack.config.js       # MF æä¾›æ–¹æ ¸å¿ƒé…ç½®
â””â”€â”€ tailwind.config.js      # æ ·å¼å‰ç¼€é…ç½®
</code></pre>
<h2 data-id="heading-10">6. å…³é”®å®ç° (Implementation)</h2>
<h3 data-id="heading-11">6.1 Remote ç«¯é…ç½® (webpack.config.js)</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">ModuleFederationPlugin</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>).<span class="hljs-property">container</span>;

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// ... å…¶ä»–é…ç½®</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleFederationPlugin</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">'remote_app'</span>,
      <span class="hljs-attr">filename</span>: <span class="hljs-string">'remoteEntry.js'</span>,
      <span class="hljs-attr">exposes</span>: {
        <span class="hljs-string">'./RemoteTable'</span>: <span class="hljs-string">'./src/components/RemoteTable/index.tsx'</span>,
      },
      <span class="hljs-attr">shared</span>: {
        <span class="hljs-attr">react</span>: { <span class="hljs-attr">singleton</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">requiredVersion</span>: <span class="hljs-string">'^18.0.0'</span> },
        <span class="hljs-string">'react-dom'</span>: { <span class="hljs-attr">singleton</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">requiredVersion</span>: <span class="hljs-string">'^18.0.0'</span> },
        <span class="hljs-attr">mobx</span>: { <span class="hljs-attr">singleton</span>: <span class="hljs-literal">true</span> }
      },
    }),
  ],
};
</code></pre>
<h3 data-id="heading-12">6.2 Host ç«¯é…ç½® (webpack.config.js)</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { <span class="hljs-title class_">ModuleFederationPlugin</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>).<span class="hljs-property">container</span>;

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// ... å…¶ä»–é…ç½®</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModuleFederationPlugin</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">'host_app'</span>,
      <span class="hljs-attr">remotes</span>: {
        <span class="hljs-comment">// å£°æ˜è¿œç¨‹å®¹å™¨çš„åç§°åŠå…¥å£åœ°å€</span>
        <span class="hljs-attr">remote_app</span>: <span class="hljs-string">'remote_app@http://localhost:3001/remoteEntry.js'</span>,
      },
      <span class="hljs-attr">shared</span>: {
        <span class="hljs-attr">react</span>: { <span class="hljs-attr">singleton</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">requiredVersion</span>: <span class="hljs-string">'^18.0.0'</span> },
        <span class="hljs-string">'react-dom'</span>: { <span class="hljs-attr">singleton</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">requiredVersion</span>: <span class="hljs-string">'^18.0.0'</span> },
        <span class="hljs-attr">mobx</span>: { <span class="hljs-attr">singleton</span>: <span class="hljs-literal">true</span> }
      },
    }),
  ],
};
</code></pre>
<h3 data-id="heading-13">6.3 Host ç«¯æ¶ˆè´¹</h3>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ErrorBoundary</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/ErrorBoundary'</span>;

<span class="hljs-comment">// é™æ€å¯¼å…¥ï¼šä¾èµ– webpack é…ç½®ä¸­çš„ remotes</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">RemoteTable</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'remote_app/RemoteTable'</span>));

<span class="hljs-keyword">const</span> <span class="hljs-title function_">App</span> = (<span class="hljs-params"/>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">p</span>&gt;</span>ç»„ä»¶åŠ è½½å¤±è´¥<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}&gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading Remote Component...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">RemoteTable</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"è¿œç¨‹æ•°æ®è¡¨"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
);
</code></pre>
<h3 data-id="heading-14">6.4 è¿è¡Œæ—¶åŠ¨æ€åŠ è½½è¿œç¨‹å®¹å™¨ (Runtime Dynamic Loading)</h3>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼ˆå¦‚ç¯å¢ƒ URL åŠ¨æ€åŒ–ã€A/B æµ‹è¯•æˆ–åŸºäºæ’ä»¶ç³»ç»Ÿçš„åº”ç”¨ï¼‰ï¼Œæˆ‘ä»¬æ— æ³•åœ¨æ„å»ºæ—¶ç¡¬ç¼–ç è¿œç¨‹åœ°å€ã€‚æ­¤æ—¶å¯ä»¥åˆ©ç”¨ Webpack çš„è¿è¡Œæ—¶ API åŠ¨æ€åŠ è½½ï¼š</p>
<h4 data-id="heading-15">6.4.1 å®ç°å·¥å…·å‡½æ•°</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * åŠ¨æ€åŠ è½½è¿œç¨‹ç»„ä»¶è„šæœ¬å¹¶åˆå§‹åŒ–å®¹å™¨
 * <span class="hljs-doctag">@param</span> url remoteEntry.js çš„å®Œæ•´åœ°å€
 * <span class="hljs-doctag">@param</span> scope è¿œç¨‹åº”ç”¨çš„ name (å¯¹åº” MF é…ç½®ä¸­çš„ name)
 * <span class="hljs-doctag">@param</span> module å¯¼å‡ºçš„è·¯å¾„ (å¦‚ './RemoteTable')
 */</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadRemoteModule</span>(<span class="hljs-params">url: <span class="hljs-built_in">string</span>, scope: <span class="hljs-built_in">string</span>, <span class="hljs-variable language_">module</span>: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-comment">// 1. åŠ¨æ€æ³¨å…¥ script æ ‡ç­¾</span>
  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);
    script.<span class="hljs-property">src</span> = url;
    script.<span class="hljs-property">type</span> = <span class="hljs-string">'text/javascript'</span>;
    script.<span class="hljs-property">async</span> = <span class="hljs-literal">true</span>;
    script.<span class="hljs-property">onload</span> = resolve;
    script.<span class="hljs-property">onerror</span> = reject;
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script);
  });

  <span class="hljs-comment">// 2. åˆå§‹åŒ–å…±äº«ä½œç”¨åŸŸ (Share Scope)</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">__webpack_init_sharing__</span>(<span class="hljs-string">'default'</span>);

  <span class="hljs-comment">// 3. è·å–è¿œç¨‹å®¹å™¨</span>
  <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">window</span>[scope];
  
  <span class="hljs-comment">// 4. åˆå§‹åŒ–å®¹å™¨</span>
  <span class="hljs-keyword">await</span> container.<span class="hljs-title function_">init</span>(__webpack_share_scopes__.<span class="hljs-property">default</span>);

  <span class="hljs-comment">// 5. è·å–æ¨¡å—å·¥å‚å¹¶æ‰§è¡Œ</span>
  <span class="hljs-keyword">const</span> factory = <span class="hljs-keyword">await</span> container.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">module</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">Module</span> = <span class="hljs-title function_">factory</span>();
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Module</span>;
}
</code></pre>
<h4 data-id="heading-16">6.4.2 ä¸šåŠ¡ä¸­ä½¿ç”¨</h4>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">const</span> <span class="hljs-title class_">DynamicRemoteTable</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> 
  <span class="hljs-title function_">loadRemoteModule</span>(
    <span class="hljs-string">'http://cdn.example.com/remoteEntry.js'</span>, 
    <span class="hljs-string">'remote_app'</span>, 
    <span class="hljs-string">'./RemoteTable'</span>
  )
);
</code></pre>
<h2 data-id="heading-17">7. æ ¸å¿ƒæœºåˆ¶æ·±å…¥ (Deep Dive)</h2>
<h3 data-id="heading-18">7.1 ModuleFederationPlugin æ ¸å¿ƒé…ç½®è¯¦è§£</h3>
<p><code>ModuleFederationPlugin</code> æ˜¯å®ç°æ¨¡å—è”é‚¦çš„æ ¸å¿ƒé…ç½®å·¥å…·ã€‚ä»¥ä¸‹æ˜¯å…¶å…³é”®å‚æ•°çš„è¯¦ç»†ä»‹ç»ï¼š</p>









































<table><thead><tr><th align="left">é…ç½®é¡¹</th><th align="left">ç±»å‹</th><th align="left">ä½œç”¨æè¿°</th><th align="left">å…³é”®æ³¨æ„ç‚¹</th></tr></thead><tbody><tr><td align="left"><strong>name</strong></td><td align="left"><code>string</code></td><td align="left">å®šä¹‰å½“å‰å®¹å™¨çš„å…¨å±€å”¯ä¸€åç§°ã€‚</td><td align="left">å¿…å¡«ã€‚ä¼šä½œä¸ºå…¨å±€å˜é‡æŒ‚è½½åˆ° <code>window</code> ä¸Šï¼ŒHost ç«¯é€šè¿‡æ­¤åç§°å¼•ç”¨ã€‚</td></tr><tr><td align="left"><strong>filename</strong></td><td align="left"><code>string</code></td><td align="left">ç”Ÿæˆçš„è¿œç¨‹å…¥å£æ¸…å•æ–‡ä»¶åã€‚</td><td align="left">é€šå¸¸è®¾ä¸º <code>remoteEntry.js</code>ã€‚Host åº”ç”¨åœ¨è¿è¡Œæ—¶é¦–å…ˆåŠ è½½æ­¤æ–‡ä»¶ä»¥è·å–æ¨¡å—å…ƒæ•°æ®ã€‚</td></tr><tr><td align="left"><strong>remotes</strong></td><td align="left"><code>object</code></td><td align="left">å£°æ˜å½“å‰åº”ç”¨éœ€è¦æ¶ˆè´¹çš„è¿œç¨‹åº”ç”¨ã€‚</td><td align="left">é”®ä¸ºæœ¬åœ°å¼•ç”¨åˆ«åï¼Œå€¼ä¸ºè¿œç¨‹å®¹å™¨åå’Œåœ°å€ï¼ˆå¦‚ <code>app: 'app@http://.../remoteEntry.js'</code>ï¼‰ã€‚</td></tr><tr><td align="left"><strong>exposes</strong></td><td align="left"><code>object</code></td><td align="left">å¯¼å‡ºå½“å‰åº”ç”¨çš„å†…éƒ¨æ¨¡å—ä¾›ä»–äººä½¿ç”¨ã€‚</td><td align="left">é”®ä¸ºå¯¹å¤–æš´éœ²çš„è·¯å¾„ï¼Œå€¼ä¸ºå†…éƒ¨æ¨¡å—çš„å®é™…ç›¸å¯¹è·¯å¾„ã€‚</td></tr><tr><td align="left"><strong>shared</strong></td><td align="left"><code>object</code></td><td align="left">å®šä¹‰å¤šä¸ªåº”ç”¨é—´å…±äº«çš„å…¬å…±ä¾èµ–åº“ã€‚</td><td align="left">åŒ…å« <code>singleton</code>ï¼ˆå•ä¾‹ï¼‰ã€<code>requiredVersion</code>ï¼ˆç‰ˆæœ¬è¦æ±‚ï¼‰ç­‰é«˜çº§é…ç½®ï¼Œé˜²æ­¢ React ç­‰åº“å‡ºç°å¤šå®ä¾‹ã€‚</td></tr></tbody></table>
<h3 data-id="heading-19">7.2 æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>æ¨¡å—è”é‚¦ï¼ˆModule Federationï¼‰æ˜¯ Webpack 5 æä¾›çš„ä¸€ç§ <strong>è·¨æ„å»ºå…±äº«æ¨¡å—</strong> çš„æœºåˆ¶ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯ï¼š</p>
<ul>
<li>ä¸åŒé¡¹ç›®ï¼ˆæ„å»ºäº§ç‰©ï¼‰ä¹‹é—´å¯ä»¥åƒæœ¬åœ°æ¨¡å—ä¸€æ ·äº’ç›¸ <code>import</code></li>
<li>æ¯ä¸ªé¡¹ç›®ä»èƒ½ç‹¬ç«‹æ„å»ºã€ç‹¬ç«‹éƒ¨ç½²</li>
<li>è‡ªåŠ¨å¤„ç†ä¾èµ–å…±äº«ä¸ç‰ˆæœ¬åå•†ï¼Œé¿å…é‡å¤æ‰“åŒ… React ç­‰å…¬å…±åº“</li>
</ul>
<p>å‡ ä¸ªå…³é”®è§’è‰²ï¼š</p>
<ul>
<li><strong>Hostï¼ˆæ¶ˆè´¹æ–¹ï¼‰</strong>ï¼šä½¿ç”¨è¿œç¨‹æ¨¡å—çš„åº”ç”¨ï¼Œå¦‚ <code>apps/admin</code></li>
<li><strong>Remoteï¼ˆæä¾›æ–¹ï¼‰</strong>ï¼šæš´éœ²æ¨¡å—ç»™å…¶ä»–åº”ç”¨ä½¿ç”¨ï¼Œå¦‚ <code>apps/RemoteComponent</code></li>
<li><strong>Container Runtimeï¼ˆå®¹å™¨è¿è¡Œæ—¶ï¼‰</strong>ï¼šWebpack åœ¨æµè§ˆå™¨ä¸­æ³¨å…¥çš„è¿è¡Œæ—¶ä»£ç ï¼Œç”¨äºï¼š
<ul>
<li>æ³¨å†Œå’ŒæŸ¥æ‰¾è¿œç¨‹æ¨¡å—</li>
<li>æ‹‰å– <code>remoteEntry.js</code></li>
<li>å¤„ç† shared ä¾èµ–çš„ç‰ˆæœ¬ä¸å®ä¾‹å¤ç”¨</li>
</ul>
</li>
</ul>
<h3 data-id="heading-20">7.3 åŠ è½½æµç¨‹ï¼ˆä»¥ RemoteComponent ä¸ºä¾‹ï¼‰</h3>
<p>ä»¥ Host ç«¯ <code>import('remote_app/RemoteTable')</code> ä¸ºä¾‹ï¼Œå…¶å†…éƒ¨å¤§è‡´æµç¨‹ï¼š</p>
<ol>
<li>
<p><strong>æ„å»ºé˜¶æ®µ</strong></p>
<ul>
<li>Remote ç«¯é€šè¿‡ <code>ModuleFederationPlugin</code> é…ç½®ï¼š
<ul>
<li><code>name: 'remote_app'</code></li>
<li><code>exposes: { './RemoteTable': './src/components/RemoteTable/index.tsx' }</code></li>
</ul>
</li>
<li>Webpack æ ¹æ®è¯¥é…ç½®ç”Ÿæˆï¼š
<ul>
<li><code>remoteEntry.js</code>ï¼šä¸€ä»½æ¨¡å—æš´éœ²æ¸…å• + åŠ è½½å…¥å£</li>
<li>å¯¹åº”çš„ä¸šåŠ¡ chunkï¼šçœŸæ­£çš„ç»„ä»¶ä»£ç </li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>è¿è¡Œæ—¶æ³¨å†Œ</strong></p>
<ul>
<li>Remote åº”ç”¨åŠ è½½æ—¶ï¼Œ<code>remoteEntry.js</code> è¢«æµè§ˆå™¨æ‰§è¡Œï¼š
<ul>
<li>è°ƒç”¨ Webpack runtimeï¼Œå°† <code>remote_app</code> æ³¨å†Œä¸ºä¸€ä¸ª <strong>è¿œç¨‹å®¹å™¨</strong></li>
<li>åŒæ—¶æ³¨å†Œå®ƒæš´éœ²å‡ºæ¥çš„æ¨¡å—æ˜ å°„å…³ç³»ï¼ˆå¦‚ <code>'./RemoteTable' -&gt; å…·ä½“ chunk</code>ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Host ç«¯å‘èµ·è¿œç¨‹åŠ è½½</strong></p>
<ul>
<li>å½“ Host ä»£ç æ‰§è¡Œåˆ°ï¼š<code>import('remote_app/RemoteTable')</code> æ—¶ï¼š
<ol>
<li>Webpack runtime æ£€æŸ¥æ˜¯å¦å·²åŠ è½½ <code>remote_app</code> å®¹å™¨</li>
<li>å¦‚æœªåŠ è½½ï¼Œåˆ™åŠ¨æ€æ’å…¥ <code>&lt;script src="remoteEntry.js"&gt;</code> æ‹‰å–å®¹å™¨</li>
<li>ç­‰å¾… <code>remoteEntry.js</code> æ‰§è¡Œå®Œæˆï¼Œæ‹¿åˆ°è¿œç¨‹å®¹å™¨å¯¹è±¡</li>
<li>è¯·æ±‚å®¹å™¨ä¸­çš„ <code>'./RemoteTable'</code> æ¨¡å—å·¥å‚å‡½æ•°</li>
<li>è‹¥è¯¥æ¨¡å—è¿˜ä¾èµ–å…¶å®ƒ chunkï¼ˆæŒ‰éœ€åŠ è½½ï¼‰ï¼Œç»§ç»­åŠ¨æ€åŠ è½½å¯¹åº” JS æ–‡ä»¶</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>æ¨¡å—æ‰§è¡Œä¸ä½¿ç”¨</strong></p>
<ul>
<li>å¾—åˆ°æ¨¡å—å·¥å‚å‡½æ•°åï¼ŒWebpack runtime ä¼šï¼š
<ul>
<li>å…ˆå®Œæˆ shared ä¾èµ–åˆå§‹åŒ–ï¼ˆè§ 6.3ï¼‰</li>
<li>æ‰§è¡Œæ¨¡å—å·¥å‚å‡½æ•°ï¼Œå¾—åˆ°çœŸæ­£çš„ React ç»„ä»¶</li>
</ul>
</li>
<li>åœ¨ä»£ç å±‚é¢ï¼ŒHost ä¾§å°±åƒæ‹¿åˆ°äº†ä¸€ä¸ªæœ¬åœ°çš„ <code>RemoteTable</code> ç»„ä»¶ä¸€æ ·ä½¿ç”¨ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-21">7.3.1 åŠ è½½æµç¨‹ä¼ªä»£ç </h4>
<pre><code class="hljs language-js" lang="js">&gt; ä¼ªä»£ç ä»…æè¿°å…³é”®æµç¨‹ï¼Œä¸å®é™… <span class="hljs-title class_">Webpack</span> è¿è¡Œæ—¶ä»£ç ç•¥æœ‰å·®å¼‚ï¼Œç”¨äºå¸®åŠ©ç†è§£ <span class="hljs-title class_">Host</span> ä» <span class="hljs-number">0</span> åˆ°æ‹¿åˆ°è¿œç¨‹ç»„ä»¶çš„å®Œæ•´åŠ è½½é˜¶æ®µã€‚

<span class="hljs-comment">// ======================</span>
<span class="hljs-comment">// Host ä¾§ï¼šä¸šåŠ¡è§¦å‘å…¥å£</span>
<span class="hljs-comment">// ======================</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">renderHostPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// React.lazy è§¦å‘å¼‚æ­¥åŠ è½½è¿œç¨‹ç»„ä»¶</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title class_">RemoteTable</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span>
    <span class="hljs-comment">// å®é™…ä¸Šä¼šèµ°åˆ°ä¸‹é¢çš„ loadRemoteModule æµç¨‹</span>
    <span class="hljs-title function_">loadRemoteModule</span>({
      <span class="hljs-attr">remoteName</span>: <span class="hljs-string">'remote_app'</span>,
      <span class="hljs-attr">exposedModule</span>: <span class="hljs-string">'./RemoteTable'</span>,
    })
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Spinner</span> /&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">RemoteTable</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"è¿œç¨‹æ•°æ®è¡¨"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ===========================================</span>
<span class="hljs-comment">// æŠ½è±¡çš„â€œåŠ è½½è¿œç¨‹æ¨¡å—â€ä¼ªä»£ç ï¼ˆHost è¿è¡Œæ—¶è§’åº¦ï¼‰</span>
<span class="hljs-comment">// ===========================================</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">loadRemoteModule</span>(<span class="hljs-params">options: {
  remoteName: string;     // å®¹å™¨åï¼Œå¦‚ <span class="hljs-string">'remote_app'</span>
  exposedModule: string;  // æ¨¡å—è·¯å¾„ï¼Œå¦‚ <span class="hljs-string">'./RemoteTable'</span>
}</span>) {
  <span class="hljs-keyword">const</span> { remoteName, exposedModule } = options;

  <span class="hljs-comment">// 1. ç¡®ä¿ remoteEntry å·²ç»åŠ è½½ï¼ˆå®¹å™¨å·²æ³¨å†Œï¼‰</span>
  <span class="hljs-comment">// ----------------------------------------------------------------</span>
  <span class="hljs-comment">//  1.1 ä» Host çš„ MF é…ç½®ä¸­æ‹¿åˆ° remote çš„ URL</span>
  <span class="hljs-keyword">const</span> remoteUrl = <span class="hljs-title function_">getRemoteEntryUrlFromConfig</span>(remoteName);
  <span class="hljs-comment">//  1.2 å¦‚æœå®¹å™¨è¿˜ä¸å­˜åœ¨ï¼Œåˆ™åŠ¨æ€æ’å…¥ &lt;script&gt; åŠ è½½ remoteEntry.js</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">window</span>[remoteName]) {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">loadRemoteEntryScript</span>(remoteUrl);  <span class="hljs-comment">// ç­‰ä»·äºåŠ¨æ€åˆ›å»º &lt;script&gt; æ ‡ç­¾å¹¶ç­‰å¾… onload</span>
  }

  <span class="hljs-comment">// 2. åˆå§‹åŒ– shared ä½œç”¨åŸŸï¼ˆå…¨å±€åªéœ€åšä¸€æ¬¡ï¼Œä½†ä¼ªä»£ç é‡Œç®€åŒ–ä¸ºæ¯æ¬¡ç¡®ä¿å®Œæˆï¼‰ </span>
  <span class="hljs-comment">// ----------------------------------------------------------------</span>
  <span class="hljs-comment">//  è°ƒç”¨ Webpack runtime çš„å…±äº«åˆå§‹åŒ–é€»è¾‘</span>
  <span class="hljs-keyword">await</span> <span class="hljs-title function_">__webpack_init_sharing__</span>(<span class="hljs-string">'default'</span>); <span class="hljs-comment">// åˆå§‹åŒ–é»˜è®¤ shared scope</span>

  <span class="hljs-comment">// 3. è·å–è¿œç¨‹å®¹å™¨å¹¶å®Œæˆåå•†</span>
  <span class="hljs-comment">// ----------------------------------------------------------------</span>
  <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">window</span>[remoteName];      <span class="hljs-comment">// e.g. window.remote_app</span>

  <span class="hljs-comment">//  3.1 å°† Host çš„ shared scope ä¼ ç»™ Remoteï¼Œå®Œæˆç‰ˆæœ¬åå•†</span>
  <span class="hljs-comment">//      - Remote ä¼šæŠŠè‡ªå·±å£°æ˜çš„ shared ä¾èµ–æ³¨å…¥è¿›æ¥</span>
  <span class="hljs-comment">//      - Host / Remote å…±åŒå†³å®šå®é™…ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬ï¼ˆå¦‚ React å•ä¾‹ï¼‰</span>
  <span class="hljs-keyword">await</span> container.<span class="hljs-title function_">init</span>(__webpack_share_scopes__.<span class="hljs-property">default</span>);

  <span class="hljs-comment">// 4. ä»å®¹å™¨é‡Œè·å–è¿œç¨‹æ¨¡å—</span>
  <span class="hljs-comment">// ----------------------------------------------------------------</span>
  <span class="hljs-comment">//  4.1 container.get è¿”å›ä¸€ä¸ª Promiseï¼Œresolve ä¸ºæ¨¡å—å·¥å‚å‡½æ•°</span>
  <span class="hljs-keyword">const</span> moduleFactory = <span class="hljs-keyword">await</span> container.<span class="hljs-title function_">get</span>(exposedModule); <span class="hljs-comment">// e.g. './RemoteTable'</span>

  <span class="hljs-comment">//  4.2 æ‰§è¡Œå·¥å‚å‡½æ•°ï¼Œå¾—åˆ°çœŸæ­£çš„æ¨¡å—å¯¼å‡ºå¯¹è±¡</span>
  <span class="hljs-keyword">const</span> moduleExports = <span class="hljs-title function_">moduleFactory</span>();

  <span class="hljs-comment">//  4.3 æŒ‰éœ€è¿”å›é»˜è®¤å¯¼å‡ºæˆ–å…·åå¯¼å‡º</span>
  <span class="hljs-keyword">return</span> moduleExports.<span class="hljs-property">default</span> || moduleExports;
}

<span class="hljs-comment">// ======================</span>
<span class="hljs-comment">// å·¥å…·ï¼šåŠ è½½ remoteEntry.js</span>
<span class="hljs-comment">// ======================</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">loadRemoteEntryScript</span>(<span class="hljs-params">url: string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-keyword">void</span>&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> existingScript = <span class="hljs-variable language_">document</span>.<span class="hljs-property">querySelector</span>&lt;<span class="hljs-title class_">HTMLScriptElement</span>&gt;(
      <span class="hljs-string">`script[data-remote-entry="<span class="hljs-subst">${url}</span>"]`</span>
    );
    <span class="hljs-keyword">if</span> (existingScript) {
      <span class="hljs-comment">// å·²ç»åœ¨åŠ è½½æˆ–åŠ è½½å®Œæˆï¼Œç›´æ¥å¤ç”¨</span>
      existingScript.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>());
      existingScript.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">() =&gt;</span>
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'remoteEntry load error'</span>))
      );
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);
    script.<span class="hljs-property">src</span> = url;
    script.<span class="hljs-property">type</span> = <span class="hljs-string">'text/javascript'</span>;
    script.<span class="hljs-property">async</span> = <span class="hljs-literal">true</span>;
    script.<span class="hljs-property">dataset</span>.<span class="hljs-property">remoteEntry</span> = url;

    script.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>();
    script.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span>
      <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Failed to load remoteEntry: <span class="hljs-subst">${url}</span>`</span>));

    <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script);
  });
}
</code></pre>
<h3 data-id="heading-22">7.4 ä¾èµ–å…±äº«æœºåˆ¶ï¼ˆShared Scopeï¼‰æ·±å…¥</h3>
<p><code>ModuleFederationPlugin</code> é€šè¿‡ä¸€å¥—å¤æ‚çš„ <strong>å…±äº«ä½œç”¨åŸŸ (Share Scope)</strong> æœºåˆ¶æ¥ç®¡ç†è·¨åº”ç”¨çš„ä¾èµ–ï¼š</p>
<h4 data-id="heading-23">7.4.1 æ„å»ºé˜¶æ®µï¼šå…ƒæ•°æ®ç”Ÿæˆ</h4>
<p>åœ¨ Webpack æ„å»ºæ—¶ï¼Œæ’ä»¶ä¼šæ ¹æ® <code>shared</code> é…ç½®ç”Ÿæˆç‰¹æ®Šçš„æ¨¡å—ï¼š</p>
<ul>
<li><strong>ProvideSharedModule</strong>: å¦‚æœåº”ç”¨æ˜¯å…±äº«åº“çš„æä¾›è€…ï¼ŒWebpack ä¼šå°†è¯¥åº“æ ‡è®°ï¼Œå¹¶å‡†å¤‡å¥½ä¾›ä»–äººä½¿ç”¨çš„å…ƒæ•°æ®ã€‚</li>
<li><strong>ConsumeSharedModule</strong>: å¦‚æœåº”ç”¨æ˜¯æ¶ˆè´¹è€…ï¼ŒWebpack ä¼šç”Ÿæˆä¸€æ®µå¼‚æ­¥åŠ è½½é€»è¾‘ï¼Œä¼˜å…ˆä»å…¨å±€å…±äº«ä½œç”¨åŸŸæŸ¥æ‰¾ã€‚</li>
<li><strong>ç‰ˆæœ¬æ¸…å•</strong>: æ’ä»¶ä¼šè®°å½•æ¯ä¸ªå…±äº«åº“çš„ <code>version</code> å’Œ <code>eager</code> å±æ€§ï¼Œå¹¶å°†è¿™äº›å…ƒæ•°æ®å†™å…¥ <code>remoteEntry.js</code>ã€‚</li>
</ul>
<h4 data-id="heading-24">7.4.2 è¿è¡Œé˜¶æ®µï¼šåˆå§‹åŒ–ä¸åå•† (init)</h4>
<p>è¿™æ˜¯å…±äº«ä¾èµ–ç”Ÿæ•ˆçš„å…³é”®æ­¥éª¤ï¼š</p>
<ol>
<li><strong>Scope æ³¨å†Œ</strong>: å½“ Host åŠ è½½ Remote æ—¶ï¼Œé¦–å…ˆè°ƒç”¨ Remote å®¹å™¨çš„ <code>init(shareScope)</code> æ–¹æ³•ã€‚</li>
<li><strong>åˆå¹¶ä½œç”¨åŸŸ</strong>: Remote ä¼šå°†è‡ªå·±çš„å…±äº«ä¾èµ–æ¸…å•åˆå¹¶åˆ°å…¨å±€ <code>shareScope</code> å¯¹è±¡ä¸­ï¼ˆé€šå¸¸æ˜¯ <code>default</code> ä½œç”¨åŸŸï¼‰ã€‚</li>
<li><strong>ç‰ˆæœ¬åå•† (Resolution)</strong>:
<ul>
<li>Webpack è¿è¡Œæ—¶ä¼šæ£€æŸ¥ <code>shareScope</code> ä¸­æ‰€æœ‰å¯ç”¨çš„ç‰ˆæœ¬ã€‚</li>
<li><strong>æœ€é«˜ç‰ˆæœ¬ä¼˜å…ˆ</strong>: å¦‚æœæ²¡æœ‰ç‰¹æ®Šé™åˆ¶ï¼Œé€‰æ‹©ç‰ˆæœ¬å·æœ€é«˜çš„å®ä¾‹ã€‚</li>
<li><strong>è¯­ä¹‰ç‰ˆæœ¬åŒ¹é…</strong>: æ ¹æ® <code>requiredVersion</code> (å¦‚ <code>^18.0.0</code>) è¿‡æ»¤ã€‚</li>
</ul>
</li>
<li><strong>åŠ è½½æ¨¡å—</strong>: ä¸€æ—¦ç¡®å®šäº†ç‰ˆæœ¬ï¼ŒHost å’Œ Remote éƒ½ä¼šé€šè¿‡ <code>get()</code> æ–¹æ³•ä»å…±äº«ä½œç”¨åŸŸè·å–å¯¹åº”çš„æ¨¡å—å·¥å‚å‡½æ•°ã€‚</li>
</ol>
<h4 data-id="heading-25">7.4.3 å•ä¾‹æ¨¡å¼ (Singleton) é€»è¾‘</h4>
<p>å½“é…ç½®äº† <code>singleton: true</code> æ—¶ï¼š</p>
<ul>
<li>Webpack ä¿è¯åœ¨æ•´ä¸ªåº”ç”¨ç”Ÿå‘½å‘¨æœŸä¸­ï¼ŒæŸä¸ªåº“ï¼ˆå¦‚ Reactï¼‰<strong>åªä¼šè¢«åˆå§‹åŒ–ä¸€æ¬¡</strong>ã€‚</li>
<li>å¦‚æœ Host å·²ç»åŠ è½½äº† Reactï¼ŒRemote å³ä½¿ç‰ˆæœ¬ç•¥é«˜ä¹Ÿä¼šè¢«è¿«ä½¿ç”¨ Host çš„å®ä¾‹ï¼ˆé™¤éç‰ˆæœ¬å†²çªä¸¥é‡å¯¼è‡´ <code>strictVersion</code> æŠ¥é”™ï¼‰ã€‚</li>
<li>è¿™è§£å†³äº† React Hook å¿…é¡»ä¾èµ–åŒä¸€ä¸ªå•ä¾‹ <code>dispatcher</code> çš„æ ¸å¿ƒé—®é¢˜ã€‚</li>
</ul>
<h4 data-id="heading-26">7.4.4 æœ€ç»ˆæ•ˆæœ</h4>
<ul>
<li>Host ä¸å¤šä¸ª Remote åº”ç”¨å…±äº«åŒä¸€ä»½ React/Mobx å®ä¾‹ï¼š
<ul>
<li>é¿å…åŒ…ä½“ç§¯è†¨èƒ€ã€‚</li>
<li>ä¿è¯çŠ¶æ€ç®¡ç†åº“ï¼ˆå¦‚ Mobxï¼‰åœ¨ä¸åŒåº”ç”¨é—´è¡Œä¸ºä¸€è‡´ã€‚</li>
<li>é¿å… React å¤šå®ä¾‹å¯¼è‡´çš„ Context/Mobx Provider å¤±æ•ˆç­‰é—®é¢˜ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-27">7.5 é€‚ç”¨åœºæ™¯ä¸é™åˆ¶</h3>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<ul>
<li>å¤šå›¢é˜Ÿã€å¤šä»“åº“åä½œçš„å‰ç«¯æ¶æ„ï¼ˆå¾®å‰ç«¯ï¼‰</li>
<li>è¿œç¨‹ç»„ä»¶åº“/ä¸šåŠ¡æ¨¡å—çš„ç‹¬ç«‹å‘å¸ƒä¸ç°åº¦</li>
<li>å¸Œæœ›åœ¨ä¸é‡å»º Host çš„å‰æä¸‹ï¼Œå¿«é€Ÿæ›´æ–°æŸäº›ä¸šåŠ¡æ¨¡å—</li>
</ul>
<p><strong>æ³¨æ„ç‚¹ / é™åˆ¶</strong></p>
<ul>
<li>Host å’Œ Remote åœ¨è¿è¡Œæ—¶å¿…é¡»èƒ½è®¿é—®å½¼æ­¤çš„æ„å»ºäº§ç‰©ï¼ˆä¸€èˆ¬é€šè¿‡ CDNï¼‰</li>
<li>æ„å»ºå·¥å…·éœ€ç»Ÿä¸€ä½¿ç”¨ Webpack 5ï¼Œæˆ–ä¿è¯ Module Federation å…¼å®¹</li>
<li>shared ä¾èµ–ç‰ˆæœ¬è¦å°½é‡æ”¶æ•›ï¼Œé¿å…å¤šç‰ˆæœ¬å…±å­˜å¯¼è‡´è¡Œä¸ºä¸ä¸€è‡´</li>
<li>è¿è¡Œæ—¶åŠ è½½æ„å‘³ç€é¦–å±å¯èƒ½å¢åŠ ä¸€æ¬¡ HTTP è¯·æ±‚ï¼Œéœ€è¦ç»“åˆç¼“å­˜ä¸é¢„åŠ è½½ä¼˜åŒ–</li>
</ul>
<hr/>
<h2 data-id="heading-28">8. æ„å»ºä¸éƒ¨ç½²æµç¨‹ (Build &amp; Deploy)</h2>
<p>ä¸‹é¢ä»¥æœ¬æ–¹æ¡ˆä¸­çš„ Remote (<code>apps/RemoteComponent</code>) ä¸ Hostï¼ˆå¦‚ <code>apps/admin</code>ï¼‰ä¸ºä¾‹ï¼Œè¯´æ˜ä»é…ç½®åˆ°äº§ç‰©è¾“å‡ºçš„æ•´ä½“æ‰“åŒ…æµç¨‹ã€‚</p>
<h3 data-id="heading-29">8.1 é…ç½®é˜¶æ®µ</h3>
<ol>
<li>
<p><strong>Remote ä¾§é…ç½® <code>ModuleFederationPlugin</code></strong></p>
<ul>
<li>å…³é”®å­—æ®µï¼š
<ul>
<li><code>name</code>: è¿œç¨‹å®¹å™¨åç§°ï¼ˆå¦‚ <code>remote_app</code>ï¼‰</li>
<li><code>filename</code>: å®¹å™¨å…¥å£æ–‡ä»¶åï¼ˆå¦‚ <code>remoteEntry.js</code>ï¼‰</li>
<li><code>exposes</code>: æš´éœ²çš„æ¨¡å—æ˜ å°„ï¼ˆå¦‚ <code>'./RemoteTable' -&gt; './src/components/RemoteTable/index.tsx'</code>ï¼‰</li>
<li><code>shared</code>: å…±äº«ä¾èµ–ï¼ˆ<code>react</code> / <code>react-dom</code> / <code>mobx</code> ç­‰ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Host ä¾§é…ç½® <code>ModuleFederationPlugin</code></strong></p>
<ul>
<li>å…³é”®å­—æ®µï¼š
<ul>
<li><code>remotes</code>: å£°æ˜è¿œç¨‹å®¹å™¨åŠå…¶åœ°å€
<ul>
<li>ä¾‹å¦‚ï¼š<code>remote_app: 'remote_app@https://cdn.xxx.com/remoteEntry.js'</code></li>
</ul>
</li>
<li><code>shared</code>: ä¸ Remote å°½é‡ä¿æŒä¸€è‡´çš„å…±äº«ä¾èµ–é…ç½®</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Webpack è§£æä¸ä¾èµ–å›¾æ„å»º</strong></p>
<ul>
<li>Webpack åœ¨æ„å»ºæ—¶ä¼šï¼š
<ul>
<li>æ‰«æå…¥å£å’Œæ‰€æœ‰ä¾èµ–æ¨¡å—ï¼Œæ„å»ºä¾èµ–å›¾ï¼ˆåŒ…æ‹¬ <code>import('remote_app/RemoteTable')</code> ç­‰åŠ¨æ€å¯¼å…¥è¯­å¥ï¼‰ã€‚</li>
<li>æ ¹æ® <code>ModuleFederationPlugin</code> çš„é…ç½®ï¼Œæ ‡è®°å“ªäº›æ¨¡å—å±äºï¼š
<ul>
<li>æœ¬åœ° chunk</li>
<li>æš´éœ²ç»™å¤–éƒ¨çš„ remote æ¨¡å—</li>
<li>éœ€è¦åŠ å…¥ shared ä½œç”¨åŸŸçš„ä¾èµ–</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-30">8.2 Remote ç«¯æ‰“åŒ…æµç¨‹</h3>
<p>ä»¥ <code>apps/RemoteComponent</code> ä¸ºä¾‹ï¼Œä¸€ä¸ªå…¸å‹çš„æ„å»ºè¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>å…¥å£è§£æ</strong></p>
<ul>
<li>å¸¸è§„ Webpack å…¥å£ï¼ˆå¦‚ <code>src/App.tsx</code>ï¼‰ç”¨äºæœ¬åœ°é¢„è§ˆå¼€å‘ã€‚</li>
<li>åŒæ—¶ï¼Œ<code>ModuleFederationPlugin</code> ä¼šåœ¨å†…éƒ¨æ³¨å…¥ä¸€ä¸ªâ€œå®¹å™¨å…¥å£â€ï¼Œç”¨äºç”Ÿæˆ <code>remoteEntry.js</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ä¸šåŠ¡ä»£ç åˆ†å—ï¼ˆchunkï¼‰</strong></p>
<ul>
<li>Webpack æ ¹æ® import å…³ç³»è¿›è¡Œä»£ç åˆ†å‰²ï¼š
<ul>
<li>ä¸»ä¸šåŠ¡ chunkï¼ˆå¦‚è¿œç¨‹ç»„ä»¶ç›¸å…³ä»£ç ï¼‰</li>
<li>å…¬å…±ä¾èµ– chunkï¼ˆå¦‚ lodash ç­‰æœªè¢« shared çš„åº“ï¼‰</li>
<li>è¿è¡Œæ—¶ä»£ç ï¼ˆWebpack runtimeï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿæˆ Remote å®¹å™¨ (<code>remoteEntry.js</code>)</strong></p>
<ul>
<li><code>ModuleFederationPlugin</code> ç”Ÿæˆä¸€ä¸ªç‰¹æ®Šçš„å…¥å£æ–‡ä»¶ <code>remoteEntry.js</code>ï¼Œå…¶ä¸»è¦èŒè´£æ˜¯ï¼š
<ul>
<li>åœ¨æµè§ˆå™¨ä¸­æ³¨å†Œä¸€ä¸ªåä¸º <code>remote_app</code> çš„å®¹å™¨å¯¹è±¡ã€‚</li>
<li>å£°æ˜å®¹å™¨ä¸­å¯è¢«è¿œç¨‹è®¿é—®çš„æ¨¡å—æ¸…å•ï¼š
<ul>
<li>ä¾‹å¦‚ <code>'./RemoteTable' -&gt; å¯¹åº”çš„ä¸šåŠ¡ chunk id/æ–‡ä»¶å</code>ã€‚</li>
</ul>
</li>
<li>åˆå§‹åŒ– shared ä½œç”¨åŸŸçš„æä¾›æ–¹/æ¶ˆè´¹æ–¹é€»è¾‘ï¼ˆå¦‚å¦‚ä½•æä¾› <code>react</code>ã€å¦‚ä½•ä» Host å¤ç”¨ <code>react</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 data-id="heading-31">8.3 å®¹å™¨å¯¹è±¡å®ä¾‹ (Window Container Object)</h3>
<ul>
<li>å½“ <code>remoteEntry.js</code> åŠ è½½å®Œæˆåï¼Œä¼šåœ¨å…¨å±€ <code>window</code> ä¸Šæ³¨å†Œå¯¹åº”çš„å®¹å™¨å¯¹è±¡ï¼ˆå¦‚ <code>window.remote_app</code>ï¼‰ã€‚è¯¥å¯¹è±¡ç¬¦åˆæ¨¡å—è”é‚¦åè®®ï¼Œå…¶ç»“æ„å¦‚ä¸‹ï¼š</li>
</ul>
<p>// æµè§ˆå™¨æ§åˆ¶å°æ‰“å° window.remote_app çš„ç¤ºæ„
{
/**</p>
<ul>
<li>get æ–¹æ³•ï¼šç”¨äºå¼‚æ­¥è·å–å®¹å™¨ä¸­æš´éœ²çš„æ¨¡å—å·¥å‚å‡½æ•°</li>
<li>@param {string} module - æ¨¡å—è·¯å¾„ï¼Œå¦‚ "./RemoteTable"</li>
<li>@returns {Promise} è¿”å›ä¸€ä¸ª Promiseï¼Œresolve åå¾—åˆ°æ¨¡å—å·¥å‚
*/
get: async (module) =&gt; {
// å†…éƒ¨é€»è¾‘ï¼šæ ¹æ® moduleMap æŸ¥æ‰¾å¹¶åŠ è½½å¯¹åº”çš„ chunk
// è¿”å›ä¸€ä¸ª factory å‡½æ•°ï¼Œæ‰§è¡Œ factory() å³å¯å¾—åˆ°å¯¼å‡ºçš„ç»„ä»¶
},</li>
</ul>
<p>/**</p>
<ul>
<li>init æ–¹æ³•ï¼šç”¨äºåˆå§‹åŒ–å®¹å™¨ï¼Œå¹¶ä¸å…¶å…±äº«ä½œç”¨åŸŸè¿›è¡Œåå•†</li>
<li>@param {Object} shareScope - å®¿ä¸»åº”ç”¨ä¼ æ¥çš„å…±äº«ä½œç”¨åŸŸå¯¹è±¡
*/
init: (shareScope) =&gt; {
// å†…éƒ¨é€»è¾‘ï¼š
// 1. å°†å½“å‰å®¹å™¨çš„ shared ä¾èµ–ç‰ˆæœ¬ä¿¡æ¯å­˜å…¥ shareScope
// 2. æ ¹æ® singleton ç­‰è§„åˆ™ç¡®å®šä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬è¿˜æ˜¯å®¿ä¸»æä¾›çš„ç‰ˆæœ¬
}
}</li>
</ul>
<h3 data-id="heading-32">8.4 Shared ä¾èµ–å¤„ç†</h3>
<ul>
<li>å¯¹ <code>shared</code> å£°æ˜çš„ä¾èµ–ï¼ˆå¦‚ <code>react</code>ï¼‰ï¼š
<ul>
<li>Remote ä¸ä¼šæŠŠå…¶å®Œæ•´ä»£ç å†æ¬¡æ‰“åŒ…è¿›è‡ªèº«ä¸šåŠ¡ chunk ä¸­ã€‚</li>
<li>è€Œæ˜¯ç”Ÿæˆä¸€äº›â€œå…±äº«åˆå§‹åŒ–â€ä»£ç ï¼Œç”¨æ¥ï¼š
<ul>
<li>åœ¨éœ€è¦æ—¶å‘ shared scope æ³¨å†Œæœ¬åœ°ç‰ˆæœ¬ï¼ˆå½“ Remote é¦–å…ˆè¢«åŠ è½½æ—¶ï¼‰ã€‚</li>
<li>æˆ–è€…ä»å·²æœ‰ shared scope ä¸­è·å–å•ä¾‹ï¼ˆå½“ Host å…ˆäº Remote è¢«åŠ è½½æ—¶ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-33">8.5 äº§ç‰©è¾“å‡º</h3>
<ul>
<li>Remote æ„å»ºäº§ç‰©é€šå¸¸åŒ…æ‹¬ï¼š
<ul>
<li><code>remoteEntry.js</code>ï¼šè¿œç¨‹å®¹å™¨å…¥å£ + æ¨¡å—æ¸…å•ã€‚</li>
<li>è‹¥å¹²ä¸šåŠ¡ chunkï¼šå¦‚ <code>RemoteTable</code> ç»„ä»¶ç›¸å…³ bundleã€‚</li>
<li>æ ·å¼æ–‡ä»¶ï¼šå¦‚ <code>remote.[contenthash].css</code>ï¼ˆå« CSS Modules/Tailwindï¼‰ã€‚</li>
<li>é™æ€èµ„æºï¼šå¸¦ hash çš„å›¾ç‰‡ã€å­—ä½“ç­‰ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-34">8.6 æ‰“åŒ…äº§ç‰©ç¤ºä¾‹ (Artifacts Demo)</h3>
<p>ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£æ„å»ºç»“æœï¼Œä»¥ä¸‹æ˜¯æ‰§è¡Œ <code>npm run build</code> å <code>dist</code> ç›®å½•ä¸­å…³é”®æ–‡ä»¶çš„ç»“æ„åŠå†…å®¹ç¤ºæ„ï¼š</p>
<h4 data-id="heading-35">8.6.1 ç›®å½•ç»“æ„ç¤ºæ„</h4>
<p>dist/
â”œâ”€â”€ remoteEntry.js          # è¿œç¨‹å…¥å£æ¸…å•ï¼ˆæ ¸å¿ƒå…ƒæ•°æ®ï¼‰
â”œâ”€â”€ src_components_RemoteTable_index_tsx.js # ä¸šåŠ¡ç»„ä»¶ä»£ç å— (Chunk)
â”œâ”€â”€ 789.js                   # å…±äº«ä¾èµ–æˆ–å…¬å…±é€»è¾‘å—
â”œâ”€â”€ remoteTable.css          # ç»„ä»¶æ ·å¼ï¼ˆå« Hash ç±»åï¼‰
â””â”€â”€ index.html               # æœ¬åœ°é¢„è§ˆå…¥å£</p>
<h4 data-id="heading-36">8.6.2 <code>remoteEntry.js</code> å†…å®¹ç‰‡æ®µ (é€»è¾‘ç®€åŒ–)</h4>
<p>è¿™æ˜¯ Host åº”ç”¨é¦–å…ˆåŠ è½½çš„æ–‡ä»¶ï¼Œå®ƒå®šä¹‰äº†å¦‚ä½•æŸ¥æ‰¾æ¨¡å—ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> remote_app;
remote_app = (<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-string">"use strict"</span>;
  <span class="hljs-keyword">var</span> __webpack_modules__ = ({
    <span class="hljs-comment">// åŒ…å«æ¨¡å—å®šä¹‰çš„æ˜ å°„è¡¨</span>
  });
  
  <span class="hljs-comment">// æ ¸å¿ƒï¼šæš´éœ²çš„æ¨¡å—æ˜ å°„</span>
  <span class="hljs-keyword">var</span> moduleMap = {
    <span class="hljs-string">"./RemoteTable"</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">return</span> __webpack_require__.<span class="hljs-title function_">e</span>(<span class="hljs-string">"src_components_RemoteTable_index_tsx"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">__webpack_require__</span>(<span class="hljs-string">"./src/components/RemoteTable/index.tsx"</span>));
    }
  };

  <span class="hljs-comment">// æ ¸å¿ƒï¼šåˆå§‹åŒ–å…±äº«ä½œç”¨åŸŸçš„æ–¹æ³•</span>
  <span class="hljs-keyword">var</span> <span class="hljs-title function_">init</span> = (<span class="hljs-params">shareScope</span>) =&gt; {
    <span class="hljs-comment">// å°† Remote çš„å…±äº«ä¾èµ–ç‰ˆæœ¬ä¸ Host æä¾›çš„ shareScope è¿›è¡Œåå•†</span>
    <span class="hljs-comment">// ä¾‹å¦‚ï¼šæ£€æŸ¥ React ç‰ˆæœ¬ï¼Œå†³å®šä½¿ç”¨æœ¬åœ°çš„è¿˜æ˜¯ Host çš„</span>
  };

  <span class="hljs-comment">// æ ¸å¿ƒï¼šè·å–æ¨¡å—çš„æ–¹æ³•</span>
  <span class="hljs-keyword">var</span> <span class="hljs-title function_">get</span> = (<span class="hljs-params"><span class="hljs-variable language_">module</span></span>) =&gt; {
    <span class="hljs-keyword">return</span> moduleMap[<span class="hljs-variable language_">module</span>]();
  };

  <span class="hljs-keyword">return</span> { get, init };
})();

</code></pre>
<h4 data-id="heading-37">8.6.3 ä¸šåŠ¡ Chunk å†…å®¹ç‰‡æ®µ (<code>src_components_RemoteTable_index_tsx.js</code>)</h4>
<p>åŒ…å«çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘ï¼Œå®ƒæ˜¯æŒ‰éœ€åŠ è½½çš„ï¼š
(self["webpackChunkremote_component"] = self["webpackChunkremote_component"] || []).push([["src_components_RemoteTable_index_tsx"], {
"./src/components/RemoteTable/index.tsx": ((__unused_webpack_module, <strong>webpack_exports</strong>, <strong>webpack_require</strong>) =&gt; {
// çœŸæ­£çš„ React ç»„ä»¶ä»£ç 
const RemoteTable = ({ title }) =&gt; {
const styles = <strong>webpack_require</strong>("./src/components/RemoteTable/index.module.less");
return React.createElement("div", { className: styles.container }, title);
};
<strong>webpack_exports</strong>["default"] = RemoteTable;
})
}]);</p>
<hr/>
<h3 data-id="heading-38">8.7 Host ç«¯æ‰“åŒ…æµç¨‹</h3>
<p>ä»¥ <code>apps/admin</code> ä¸ºä¾‹ï¼ŒHost ä¾§æ„å»ºè¿‡ç¨‹åœ¨æ™®é€š Webpack æ„å»ºåŸºç¡€ä¸Šå¢åŠ äº†å¯¹è¿œç¨‹æ¨¡å—çš„å¤„ç†ã€‚</p>
<ol>
<li>
<p><strong>è§£æ <code>remotes</code> é…ç½®</strong></p>
<ul>
<li><code>ModuleFederationPlugin</code> è¯»å– Host çš„ <code>remotes</code> å­—æ®µï¼Œä¾‹å¦‚ï¼š
<ul>
<li><code>remote_app: 'remote_app@https://cdn.xxx.com/remoteEntry.js'</code></li>
</ul>
</li>
<li>åœ¨æ‰“åŒ…äº§ç‰©ä¸­ï¼ŒWebpack runtime ä¼šå†…ç½®ä¸€æ®µé€»è¾‘ï¼Œç”¨äºï¼š
<ul>
<li>åœ¨è¿è¡Œæ—¶æŒ‰éœ€åŠ è½½ <code>https://cdn.xxx.com/remoteEntry.js</code></li>
<li>æŠŠè¿œç¨‹å®¹å™¨å¯¹è±¡æŒ‚è½½åˆ°å†…éƒ¨çš„å®¹å™¨ç®¡ç†ç³»ç»Ÿä¸Šã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>å¤„ç†è¿œç¨‹ <code>import</code> è¯­å¥</strong></p>
<ul>
<li>å¯¹ç±»ä¼¼ <code>import('remote_app/RemoteTable')</code> çš„è¯­å¥ï¼ŒWebpack ä¸ä¼šåœ¨æ„å»ºæ—¶å»è§£æå®é™…æ¨¡å—å†…å®¹ï¼Œè€Œæ˜¯ï¼š
<ul>
<li>ç”Ÿæˆä¸€æ®µè°ƒç”¨â€œè”é‚¦è¿è¡Œæ—¶â€çš„ä»£ç ï¼š
<ul>
<li>è¿è¡Œæ—¶æ ¹æ® <code>remote_app</code> å®¹å™¨åä¸ <code>'./RemoteTable'</code> æ¥æŸ¥æ‰¾æ¨¡å—å·¥å‚ã€‚</li>
<li>å¹¶åœ¨éœ€è¦çš„æ—¶å€™è§¦å‘å¯¹ <code>remoteEntry.js</code> å’Œåç»­ chunk çš„ç½‘ç»œè¯·æ±‚ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>ä» Host æ‰“åŒ…ç»“æœæ¥çœ‹ï¼Œè¿™äº›è¿œç¨‹æ¨¡å—ä¸ä¼šå‡ºç°åœ¨æœ¬åœ° bundle ä¸­ï¼Œä»è€Œå‡å° Host çš„ä½“ç§¯ã€‚</li>
</ul>
</li>
<li>
<p><strong>shared ä¾èµ–æ”¶æ•›</strong></p>
<ul>
<li>Host é€šå¸¸æ˜¯ shared ä½œç”¨åŸŸçš„â€œä¼˜å…ˆæä¾›æ–¹â€ï¼š
<ul>
<li>Host çš„ <code>react</code>ã€<code>react-dom</code>ã€<code>mobx</code> ç­‰è¢«æ³¨å†Œåˆ° shared scopeã€‚</li>
<li>Remote åŠ è½½æ—¶ä¼˜å…ˆä½¿ç”¨ Host æä¾›çš„ç‰ˆæœ¬ï¼ˆåœ¨é…ç½® <code>singleton: true</code> æ—¶å°¤ä¸ºé‡è¦ï¼‰ã€‚</li>
</ul>
</li>
<li>Webpack åœ¨ Host ä¾§ä¼šå¯¹è¿™äº›ä¾èµ–è¿›è¡Œä¸€æ¬¡æ­£å¸¸æ‰“åŒ…ï¼ˆå› ä¸º Host éœ€è¦è‡ªå·±ç”¨åˆ°ï¼‰ï¼Œä½†ä¸ä¼šé‡å¤æ‰“å…¥ Remote çš„ bundleã€‚</li>
</ul>
</li>
<li>
<p><strong>Host äº§ç‰©è¾“å‡º</strong></p>
<ul>
<li>ä¸æ™®é€šåº”ç”¨ç±»ä¼¼ï¼š
<ul>
<li>åº”ç”¨ä¸»å…¥å£ bundle / å¼‚æ­¥ chunk</li>
<li>shared ä¾èµ–æ‰“åŒ…ç»“æœ</li>
<li>Webpack runtimeï¼ˆå†…ç½®å¯¹ Module Federation çš„æ‰©å±•ï¼‰</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-39">8.8 å¼€å‘ç¯å¢ƒ vs ç”Ÿäº§ç¯å¢ƒ</h3>
<ol>
<li>
<p><strong>å¼€å‘ç¯å¢ƒ</strong></p>
<ul>
<li>é€šå¸¸é€šè¿‡ <code>webpack-dev-server</code> æˆ–ç±»ä¼¼æœåŠ¡å¯åŠ¨ Host å’Œ Remoteï¼š
<ul>
<li>å¦‚ Host åœ¨ <code>http://localhost:3000</code></li>
<li>Remote åœ¨ <code>http://localhost:3001</code></li>
</ul>
</li>
<li><code>remotes</code> ä¸­é…ç½®ä¸ºæœ¬åœ°åœ°å€ï¼š
<ul>
<li><code>remote_app: 'remote_app@http://localhost:3001/remoteEntry.js'</code></li>
</ul>
</li>
<li>ç‰¹æ€§ï¼š
<ul>
<li>æ”¯æŒ HMR / çƒ­æ›´æ–°ï¼ˆå˜æ›´ Remote ç»„ä»¶åï¼Œåˆ·æ–° Host é¡µé¢å³å¯çœ‹åˆ°æœ€æ–°æ•ˆæœï¼‰ã€‚</li>
<li>æ„å»ºæ¨¡å¼ä¸º <code>development</code>ï¼Œæ— å‹ç¼©ï¼Œä¾¿äºè°ƒè¯•ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ç”Ÿäº§ç¯å¢ƒ</strong></p>
<ul>
<li>Remote äº§ç‰©ï¼ˆå« <code>remoteEntry.js</code> å’Œé™æ€èµ„æºï¼‰é€šå¸¸å‘å¸ƒåˆ° CDNï¼š
<ul>
<li><code>https://cdn.xxx.com/remote/remoteEntry.js</code></li>
</ul>
</li>
<li>Host åœ¨æ„å»ºæ—¶æŠŠ <code>remotes</code> é…ç½®ä¸ºçº¿ä¸Šåœ°å€æˆ–ä½¿ç”¨ç¯å¢ƒå˜é‡/è¿è¡Œæ—¶æ³¨å…¥ï¼š
<ul>
<li>ä¿æŒ <code>remoteEntry.js</code> çš„ <strong>è·¯å¾„ç¨³å®š</strong>ï¼ˆæˆ–æœ‰æ˜ç¡®çš„ç‰ˆæœ¬ç­–ç•¥ï¼‰ã€‚</li>
</ul>
</li>
<li>ä½¿ç”¨ <code>contenthash</code> ç­‰é¿å…ç¼“å­˜é—®é¢˜ï¼ŒåŒæ—¶é…åˆï¼š
<ul>
<li>HTTP ç¼“å­˜å¤´ï¼ˆ<code>Cache-Control</code>ï¼‰</li>
<li>é¢„åŠ è½½ç­–ç•¥ï¼ˆ<code>&lt;link rel="preload"&gt;</code> / <code>&lt;link rel="prefetch"&gt;</code>ï¼‰ä¼˜åŒ–è¿œç¨‹ç»„ä»¶åŠ è½½æ€§èƒ½ã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-40">8.9 å‘å¸ƒä¸æ›´æ–°ç­–ç•¥</h3>
<ol>
<li>
<p><strong>Remote ç‹¬ç«‹å‘å¸ƒ</strong></p>
<ul>
<li>å½“åªæ›´æ–°è¿œç¨‹ç»„ä»¶æ—¶ï¼š
<ul>
<li>é‡æ–°æ„å»º <code>apps/RemoteComponent</code>ï¼Œç”Ÿæˆæ–°çš„ <code>remoteEntry.js</code> å’Œä¸šåŠ¡ chunkã€‚</li>
<li>å‘å¸ƒåˆ° CDNï¼ˆç‰ˆæœ¬å·/è·¯å¾„éœ€ä¸ Host é…ç½®å…¼å®¹ï¼‰ã€‚</li>
</ul>
</li>
<li>Host æ— éœ€é‡æ–°æ‰“åŒ…ï¼Œåªè¦åœ¨è¿è¡Œæ—¶èƒ½è®¿é—®æœ€æ–°çš„ <code>remoteEntry.js</code> å³å¯ä½¿ç”¨æ–°ç‰ˆæœ¬ç»„ä»¶ã€‚</li>
</ul>
</li>
<li>
<p><strong>å…¼å®¹æ€§ä¸ç‰ˆæœ¬ç®¡ç†</strong></p>
<ul>
<li>ä¿æŒ <code>exposes</code> çš„æ¨¡å—åå’Œå¯¼å‡ºæ¥å£å°½é‡ç¨³å®šï¼š
<ul>
<li>æ–°å¢ç»„ä»¶ï¼šå¯ä»¥æ–°å¢ expose é¡¹ï¼ˆä¾‹å¦‚ <code>./RemoteForm</code>ï¼‰ã€‚</li>
<li>ä¿®æ”¹ç»„ä»¶ï¼šå°½é‡ä¿æŒç°æœ‰ props ç»“æ„å‘åå…¼å®¹ã€‚</li>
</ul>
</li>
<li>shared ä¾èµ–çš„ç‰ˆæœ¬éœ€ä¸¥æ ¼æ§åˆ¶ï¼š
<ul>
<li>Host ä¸ Remote çš„ <code>react</code> / <code>react-dom</code> / <code>mobx</code> ç‰ˆæœ¬å°½é‡ä¸€è‡´ã€‚</li>
<li>å¦‚éœ€å¤§ç‰ˆæœ¬å‡çº§ï¼Œå»ºè®®ï¼š
<ul>
<li>å…ˆåè°ƒ Host å‡çº§ shared ä¾èµ–ã€‚</li>
<li>æˆ–ä½¿ç”¨å¤šå®¹å™¨ã€å¤šç‰ˆæœ¬ <code>remoteEntry</code> çš„æ–¹å¼åšå¹³æ»‘è¿ç§»ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>é€šè¿‡ä¸Šè¿°æµç¨‹ï¼Œæ¨¡å—è”é‚¦åœ¨æ„å»ºé˜¶æ®µå®Œæˆ <strong>å®¹å™¨ç”Ÿæˆã€ä¾èµ–å…±äº«ã€è¿œç¨‹å…¥å£æ³¨å†Œ</strong>ï¼Œåœ¨è¿è¡Œæ—¶å®ç° <strong>æŒ‰éœ€åŠ è½½è¿œç¨‹ç»„ä»¶ + å…±äº«ä¾èµ–å•ä¾‹åŒ–</strong>ï¼Œä»è€Œæ”¯æ’‘æœ¬æ–¹æ¡ˆçš„ã€Œè¿è¡Œæ—¶åŠ è½½ã€ç‹¬ç«‹éƒ¨ç½²ã€ä¾èµ–å…±äº«ã€ç›®æ ‡ã€‚</p>
<hr/>
<h2 data-id="heading-41">9. éš”ç¦»ä¸å®‰å…¨ (Isolation)</h2>
<p>åœ¨å½“å‰æ–¹æ¡ˆä¸­ï¼ŒJS éš”ç¦»ä¸»è¦ä¾èµ– <strong>Webpack æ¨¡å—ç³»ç»Ÿ + Module Federation çš„å®¹å™¨éš”ç¦»</strong>ï¼š</p>
<h3 data-id="heading-42">9.1 JS éš”ç¦»</h3>
<ol>
<li>
<p><strong>æ¨¡å—çº§ä½œç”¨åŸŸéš”ç¦»</strong></p>
<ul>
<li>è¿œç¨‹ç»„ä»¶åœ¨ Remote ç«¯è¢«æ‰“åŒ…ä¸ºæ™®é€š ES æ¨¡å— / Webpack æ¨¡å—ï¼š
<ul>
<li>å˜é‡ã€å‡½æ•°éƒ½å°è£…åœ¨æ¨¡å—ä½œç”¨åŸŸå†…ï¼Œä¸ä¼šæŒ‚è½½åˆ° <code>window</code>ã€‚</li>
<li>Host ç«¯ä»…é€šè¿‡ <code>import('remote_app/RemoteTable')</code> æ‹¿åˆ°æ¨¡å—å¯¼å‡ºï¼ˆReact ç»„ä»¶æœ¬èº«ï¼‰ï¼Œä¸ä¼šç›´æ¥è®¿é—® Remote å†…éƒ¨å®ç°ç»†èŠ‚ã€‚</li>
</ul>
</li>
<li>åªè¦è¿œç¨‹ç»„ä»¶é¿å…ä¸»åŠ¨å†™å…¥ <code>window.xxx</code> ç­‰å…¨å±€å˜é‡ï¼Œå°±ä¸ä¼šæ±¡æŸ“å®¿ä¸»åº”ç”¨ã€‚</li>
</ul>
</li>
<li>
<p><strong>å®¹å™¨çº§éš”ç¦»ï¼ˆModule Federation Containerï¼‰</strong></p>
<ul>
<li>æ¯ä¸ª Remoteï¼ˆå¦‚ <code>remote_app</code>ï¼‰åœ¨æµè§ˆå™¨ä¸­æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ <strong>å®¹å™¨</strong>ï¼š
<ul>
<li>å®¹å™¨åªæš´éœ²åœ¨ <code>exposes</code> ä¸­å£°æ˜çš„æ¨¡å—ï¼ˆå¦‚ <code>./RemoteTable</code>ï¼‰ã€‚</li>
<li>å…¶ä»–ä¸šåŠ¡ä»£ç ã€å·¥å…·å‡½æ•°ç­‰éƒ½è¢«å°è£…åœ¨ Remote è‡ªèº«çš„ bundle å†…ï¼Œå¯¹ Host ä¸å¯è§ã€‚</li>
</ul>
</li>
<li>Host å’Œ Remote ä¹‹é—´å”¯ä¸€æ‰“é€šçš„æ˜¯ï¼š
<ul>
<li><code>exposes</code> æš´éœ²çš„ç»„ä»¶/æ¨¡å—æ¥å£ã€‚</li>
<li><code>shared</code> ä¸­å£°æ˜çš„å…±äº«ä¾èµ–ï¼ˆå¦‚ <code>react</code>ã€<code>mobx</code>ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>ä¾èµ–å…±äº«ç™½åå•</strong></p>
<ul>
<li>é€šè¿‡ <code>shared</code> æ˜¾å¼å£°æ˜å…±äº«ä¾èµ–ï¼š
<ul>
<li>ä»… <code>react</code>ã€<code>react-dom</code>ã€<code>mobx</code> ç­‰å…¬å…±åº“ä¼šåœ¨ Host/Remote é—´å¤ç”¨ã€‚</li>
<li>ä¸šåŠ¡å±‚çš„å·¥å…·åº“ã€çŠ¶æ€ç­‰ä¸ä¼šè‡ªåŠ¨å…±äº«ï¼Œé¿å…ä¸åŒåº”ç”¨ä¹‹é—´äº§ç”Ÿéšå¼è€¦åˆã€‚</li>
</ul>
</li>
<li>è¿™æ ·æ—¢ä¿è¯äº†å…¬å…±ä¾èµ–å•ä¾‹åŒ–ï¼Œåˆä¿è¯ä¸šåŠ¡ä»£ç è¾¹ç•Œæ¸…æ™°ã€‚</li>
</ul>
</li>
<li>
<p><strong>é€šä¿¡æ–¹å¼çº¦æŸ</strong></p>
<ul>
<li>æ¨èæ‰€æœ‰äº¤äº’é€šè¿‡ï¼š
<ul>
<li>ç»„ä»¶ <code>props</code></li>
<li>ä¸Šå±‚æ³¨å…¥çš„ Context / Mobx store</li>
</ul>
</li>
<li>ä¸å»ºè®®è¿œç¨‹ç»„ä»¶ç›´æ¥è®¿é—®å®¿ä¸»çš„å…¨å±€å˜é‡æˆ–å•ä¾‹å¯¹è±¡ï¼Œä»ç»„ç»‡æ–¹å¼ä¸Šè¿›ä¸€æ­¥ä¿è¯â€œé€»è¾‘éš”ç¦»â€ã€‚</li>
</ul>
</li>
</ol>
<blockquote>
<p>å¦‚éœ€æ›´å¼ºçš„è¿è¡Œæ—¶éš”ç¦»ï¼ˆå¦‚é¿å…ä»»ä½•å…¨å±€æ±¡æŸ“ã€CSS/JS äº’ä¸å¹²æ‰°ï¼‰ï¼Œå¯ä»¥åœ¨æ›´é«˜å±‚ä½¿ç”¨ <code>iframe</code> / Shadow DOM ç­‰æ–¹æ¡ˆï¼Œä½†ä¸åœ¨æœ¬è®¾è®¡çš„åŸºç¡€èŒƒç•´å†…ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-43">9.2 CSS éš”ç¦»</h3>
<p>CSS éš”ç¦»ä¸»è¦é€šè¿‡ <strong>CSS Modules / Tailwind å‰ç¼€</strong> å®ç°ï¼Œç»“åˆæ‰“åŒ…äº§ç‰©çš„æ–‡ä»¶ hashï¼Œé¿å…æ ·å¼å†²çªã€‚</p>
<h4 data-id="heading-44">9.2.1 ä½¿ç”¨ CSS Modulesï¼ˆæ¨èï¼‰</h4>
<ul>
<li>Remote ç«¯ç»„ä»¶æ ·å¼å†™æˆ <code>*.module.css</code> / <code>*.module.less</code> ç­‰ï¼š
<ul>
<li>
<p>Webpack é…ç½® <code>modules</code> åï¼Œä¼šå°†ç±»åç¼–è¯‘ä¸ºå¸¦ hash çš„å”¯ä¸€åå­—ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>æºç ï¼š<code>.container { ... }</code></li>
<li>ç¼–è¯‘åï¼š<code>.RemoteTable_container__3kS4a { ... }</code></li>
</ul>
</li>
<li>
<p>ç»„ä»¶å†…éƒ¨ä½¿ç”¨ï¼š
import styles from './index.module.less';</p>
<p>export const RemoteTable = () =&gt; (</p>
  <div class="{styles.container}">...</div>
);
</li>
</ul>
</li>
<li>éš”ç¦»æ•ˆæœï¼š
<ul>
<li>ä¸ä¼šç”Ÿæˆå…¨å±€ <code>.container</code> ä¹‹ç±»çš„ç±»åï¼Œå®¿ä¸»åº”ç”¨çš„ <code>.container</code> ä¸ä¼šä¸ä¹‹å†²çªã€‚</li>
<li>Remote ä¹‹é—´ã€Remote ä¸ Host ä¹‹é—´ï¼Œå³ä½¿ç±»åè¯­ä¹‰ç›¸åŒï¼ˆå¦‚ <code>.button</code>ï¼‰ï¼Œæœ€ç»ˆç¼–è¯‘å‡ºæ¥çš„çœŸå®ç±»åä¹Ÿä¸åŒã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-45">9.2.2 ä½¿ç”¨ Tailwind æ—¶çš„éš”ç¦»</h4>
<p>è‹¥è¿œç¨‹ç»„ä»¶å†…éƒ¨ä½¿ç”¨ Tailwindï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼éš”ç¦»ï¼š</p>
<ol>
<li>
<p><strong>å‰ç¼€ï¼ˆprefixï¼‰</strong></p>
<ul>
<li>åœ¨ Tailwind é…ç½®ä¸­ä¸º Remote å•ç‹¬è®¾ç½®ï¼š
// tailwind.config.js
module.exports = {
prefix: 'rc-',   // è¿œç¨‹ç»„ä»¶ç”¨ rc- å¼€å¤´çš„ç±»å
// ...
};</li>
<li>ç”Ÿæˆçš„ç±»åä¼šå˜æˆï¼š
<ul>
<li><code>rc-flex</code>, <code>rc-m-2</code>, <code>rc-text-sm</code> ...</li>
</ul>
</li>
<li>é¿å…ä¸ Host ä¾§çš„ Tailwind ç±»ï¼ˆæ— å‰ç¼€æˆ–å…¶ä»–å‰ç¼€ï¼‰å‘ç”Ÿå†²çªã€‚</li>
</ul>
</li>
<li>
<p><strong>important / æ³¨å…¥èŒƒå›´æ§åˆ¶</strong></p>
<ul>
<li>å¦‚æœ‰éœ€è¦å¯ä»¥å¼€å¯ï¼š
module.exports = {
important: true,
// ...
};</li>
<li>æˆ–è€…åœ¨æ ·å¼æ³¨å…¥æ—¶é™åˆ¶ä½œç”¨èŒƒå›´ï¼Œç¡®ä¿ Tailwind çš„ <code>preflight</code> / reset ç­‰ä¸ä¼šè¦†ç›–å®¿ä¸»çš„å…¨å±€æ ·å¼ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ‰“åŒ…è¾¹ç•Œ</strong></p>
<ul>
<li>Remote çš„ Tailwind CSS ä½œä¸ºå…¶è‡ªèº« bundle çš„ä¸€éƒ¨åˆ†è¾“å‡ºï¼š
<ul>
<li>ä»…åœ¨è¿œç¨‹ç»„ä»¶è¢«åŠ è½½æ—¶åŠ¨æ€æ³¨å…¥å¯¹åº”æ ·å¼ã€‚</li>
<li>Host ä¸ä¼šå› ä¸ºè‡ªèº«ä½¿ç”¨ Tailwind å°±è‡ªåŠ¨â€œæ¥ç®¡â€ Remote çš„æ ·å¼ï¼Œåä¹‹äº¦ç„¶ã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 data-id="heading-46">9.2.3 é™æ€èµ„æºä¸å‘½åç©ºé—´</h4>
<ul>
<li>é€šè¿‡ Webpack å¯¹ CSS å†…ä½¿ç”¨çš„å›¾ç‰‡ã€å­—ä½“ç­‰èµ„æºè¿›è¡Œ hash å¤„ç†ï¼š
<ul>
<li><code>background: url('./icon.png')</code> â†’ <code>url('.../icon.abc123.png')</code></li>
<li>Host ä¸ Remote çš„èµ„æºè·¯å¾„äº’ä¸å½±å“ï¼Œä¸ä¼šå‡ºç°åŒåæ–‡ä»¶è¢«è¦†ç›–çš„æƒ…å†µã€‚</li>
</ul>
</li>
<li>æ ·å¼æ–‡ä»¶æœ¬èº«ä¹Ÿé€šå¸¸å¸¦æœ‰å†…å®¹ hashï¼š
<ul>
<li><code>remote.[contenthash].css</code>ï¼Œé¿å…ç¼“å­˜æ±¡æŸ“å’Œå†²çªã€‚</li>
</ul>
</li>
</ul>
<hr/>
<p>ç»¼ä¸Šï¼š</p>
<ul>
<li><strong>JS éš”ç¦»</strong>ï¼šä¾æ‰˜ Module Federation çš„å®¹å™¨ + æ¨¡å—ä½œç”¨åŸŸ + æ˜¾å¼ shared é…ç½®ï¼Œå°† Remote çš„ä¸šåŠ¡é€»è¾‘ä¸ Host éš”ç¦»ï¼Œä»…æš´éœ²å¿…è¦ç»„ä»¶æ¥å£ä¸å…¬å…±ä¾èµ–ã€‚</li>
<li><strong>CSS éš”ç¦»</strong>ï¼šé€šè¿‡ CSS Modules / Tailwind å‰ç¼€ä¸ç‹¬ç«‹æ‰“åŒ…ï¼Œä½¿è¿œç¨‹ç»„ä»¶çš„æ ·å¼å±€éƒ¨åŒ–ã€ä¸ä¾µå…¥å®¿ä¸»å…¨å±€æ ·å¼ï¼Œä»è€Œåœ¨è¿è¡Œæ—¶åšåˆ°â€œåŠ è½½å³ç”¨ã€äº’ä¸å¹²æ‰°â€ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-47">10. æœ€ä½³å®è·µä¸ä¼˜åŒ– (Best Practices)</h2>
<h3 data-id="heading-48">10.1 å¼‚å¸¸å¤„ç†ä¸é™çº§ (Fallback)</h3>
<p>è¿œç¨‹ç»„ä»¶åŠ è½½å—ç½‘ç»œå½±å“ï¼Œå¿…é¡»æä¾›å¥å£®çš„å¼‚å¸¸å¤„ç†ï¼š</p>
<ol>
<li><strong>åŠ è½½çŠ¶æ€</strong>: ä½¿ç”¨ <code>Suspense</code> æä¾› Loading å ä½ã€‚</li>
<li><strong>å®¹é”™å¤„ç†</strong>: ä½¿ç”¨ <code>ErrorBoundary</code> åŒ…è£¹ç»„ä»¶ï¼Œå½“è¿œç¨‹èµ„æº 404 æˆ–è¿è¡Œæ—¶å´©æºƒæ—¶æ˜¾ç¤ºé™çº§ UIã€‚</li>
<li><strong>ç‰ˆæœ¬é”å®š</strong>: ç”Ÿäº§ç¯å¢ƒå»ºè®®é€šè¿‡ç‰ˆæœ¬å·ç›®å½•å­˜æ”¾ <code>remoteEntry.js</code>ï¼Œé¿å…å‘å¸ƒæ—¶çš„ç¼“å­˜é—ªåŠ¨ã€‚</li>
</ol>
<h3 data-id="heading-49">10.2 æ€§èƒ½ä¼˜åŒ–</h3>
<ol>
<li><strong>é¢„åŠ è½½ (Preload)</strong>: åœ¨ Host ç«¯å…³é”®è·¯å¾„é€šè¿‡ <code>&lt;link rel="preload"&gt;</code> é¢„æ‹‰å– <code>remoteEntry.js</code>ã€‚</li>
<li><strong>å…¬å…±ä¾èµ–å¤–ç½®</strong>: ç¡®ä¿å…±äº«ä¾èµ–çœŸæ­£å‘½ä¸­å•ä¾‹ï¼Œå‡å°‘ç½‘ç»œä¼ è¾“ã€‚</li>
<li><strong>æŒ‰éœ€åŠ è½½</strong>: ç»„ä»¶å†…éƒ¨çš„éæ ¸å¿ƒé€»è¾‘ä½¿ç”¨åŠ¨æ€ <code>import()</code> è¿›ä¸€æ­¥æ‹†åˆ†ã€‚</li>
</ol>
<h3 data-id="heading-50">10.3 è°ƒè¯•æŠ€å·§</h3>
<ul>
<li><strong>ç‰ˆæœ¬å¯¹é½</strong>: ç¡®ä¿ Host å’Œ Remote çš„ <code>shared</code> é…ç½®å®Œå…¨ä¸€è‡´ï¼Œå°¤å…¶æ˜¯ <code>singleton</code> å’Œ <code>eager</code> å±æ€§ã€‚</li>
<li><strong>Source Map</strong>: å¼€å¯ç”Ÿäº§ç¯å¢ƒçš„ source-map å…³è”ï¼Œæ–¹ä¾¿åœ¨ Host ç«¯è°ƒè¯• Remote æºç ã€‚</li>
</ul>
<h2 data-id="heading-51">11. æ½œåœ¨æŒ‘æˆ˜ä¸å±€é™æ€§ (Challenges &amp; Limitations)</h2>
<p>è™½ç„¶åŸºäº Webpack 5 Module Federation çš„æ–¹æ¡ˆåœ¨çµæ´»æ€§å’Œè§£è€¦æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œä½†åœ¨å®é™…å¤§è§„æ¨¡åº”ç”¨ä¸­ä»éœ€æ³¨æ„ä»¥ä¸‹æ½œåœ¨é—®é¢˜ï¼š</p>
<h3 data-id="heading-52">11.1 è¿è¡Œæ—¶é£é™©</h3>
<ol>
<li><strong>ç½‘ç»œç¨³å®šæ€§ä¾èµ–</strong>: è¿œç¨‹ç»„ä»¶åœ¨è¿è¡Œæ—¶åŠ è½½ï¼Œå¦‚æœ CDN èŠ‚ç‚¹æ•…éšœæˆ–ç”¨æˆ·ç½‘ç»œç¯å¢ƒå·®ï¼Œä¼šå¯¼è‡´ <code>remoteEntry.js</code> åŠ è½½å¤±è´¥ï¼Œç›´æ¥å½±å“é¡µé¢å…³é”®åŠŸèƒ½ã€‚å¿…é¡»å¼ºåˆ¶è¦æ±‚é…å¥— <code>ErrorBoundary</code> å’Œé‡è¯•æœºåˆ¶ã€‚</li>
<li><strong>ç‰ˆæœ¬å†²çªä¸ä¾èµ–åœ°ç‹±</strong>:
<ul>
<li>è™½ç„¶æœ‰ <code>shared</code> æœºåˆ¶ï¼Œä½†å¦‚æœä¸åŒ Remote è¦æ±‚çš„ <code>shared</code> ä¾èµ–ç‰ˆæœ¬è·¨åº¦è¿‡å¤§ï¼ˆä¾‹å¦‚ä¸€ä¸ªè¦ React 16ï¼Œä¸€ä¸ªè¦ React 18ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŠ è½½å¤šä»½ React å®ä¾‹æˆ–ç›´æ¥è¿è¡Œæ—¶æŠ¥é”™ã€‚</li>
<li><code>singleton: true</code> è™½ç„¶èƒ½ä¿è¯å•ä¾‹ï¼Œä½†åœ¨ç‰ˆæœ¬ä¸åŒ¹é…æ—¶å¯èƒ½å¯¼è‡´æŸäº›ç»„ä»¶è¿è¡Œåœ¨ä¸å…¼å®¹çš„åº“ç‰ˆæœ¬ä¸Šï¼Œå¼•å‘éš¾ä»¥è°ƒè¯•çš„ Bugã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-53">11.2 ç±»å‹å®‰å…¨ä¸å¼€å‘ä½“éªŒ</h3>
<ol>
<li><strong>TypeScript ç±»å‹ä¸¢å¤±</strong>: é»˜è®¤æƒ…å†µä¸‹ï¼ŒHost åº”ç”¨æ— æ³•ç›´æ¥è·å– Remote åº”ç”¨å¯¼å‡ºçš„ç»„ä»¶ç±»å‹å®šä¹‰ã€‚é€šå¸¸éœ€è¦é€šè¿‡ <code>@module-federation/typescript</code> æ’ä»¶ã€æ‰‹åŠ¨åŒæ­¥ <code>.d.ts</code> æ–‡ä»¶æˆ–å»ºç«‹ç§æœ‰ NPM ç±»å‹åŒ…æ¥è§£å†³ã€‚</li>
<li><strong>æœ¬åœ°å¼€å‘å¤æ‚åº¦</strong>: è°ƒè¯• Host å¼•ç”¨ Remote çš„é€»è¾‘æ—¶ï¼Œå¾€å¾€éœ€è¦åŒæ—¶å¯åŠ¨ä¸¤ä¸ª Dev Serverã€‚å¦‚æœæ¶‰åŠå¤šä¸ªè¿œç¨‹å®¹å™¨ï¼Œæœ¬åœ°å†…å­˜å ç”¨å’Œé…ç½®ç®¡ç†æˆæœ¬ä¼šä¸Šå‡ã€‚</li>
</ol>
<h3 data-id="heading-54">11.3 æ€§èƒ½æŒ‘æˆ˜</h3>
<ol>
<li><strong>ç€‘å¸ƒå¼åŠ è½½ (Waterfall)</strong>: Host åŠ è½½å®Œåæ‰å»æ‹‰å– <code>remoteEntry.js</code>ï¼Œè§£æå®Œæ¸…å•åå†å»æ‹‰å–ç»„ä»¶ chunkã€‚å¦‚æœä¸åšé¢„åŠ è½½ (Preload)ï¼Œä¼šå¯¼è‡´æ˜æ˜¾çš„é¦–å±ç™½å±æˆ–ç»„ä»¶é—ªçƒã€‚</li>
<li><strong>æ‰“åŒ…ç¢ç‰‡åŒ–</strong>: éšç€ <code>exposes</code> æ¨¡å—å¢å¤šï¼Œä¼šäº§ç”Ÿå¤§é‡å¾®å°çš„ JS æ–‡ä»¶ï¼Œå¢åŠ  HTTP è¯·æ±‚æ•°é‡ã€‚</li>
</ol>
<h3 data-id="heading-55">11.4 ç»´æŠ¤ä¸è§„èŒƒ</h3>
<ol>
<li><strong>è°ƒè¯•å›°éš¾</strong>: å½“çº¿ä¸Šå‡ºç° Bug æ—¶ï¼Œå¾ˆéš¾ä¸€çœ¼åˆ¤æ–­é—®é¢˜å‡ºåœ¨ Host è¿˜æ˜¯æŸä¸ª Remote çš„ç‰¹å®šç‰ˆæœ¬ã€‚éœ€è¦å®Œå–„çš„ Source Map æ˜ å°„å’Œæ—¥å¿—è¿½è¸ªç³»ç»Ÿã€‚</li>
<li><strong>æ ·å¼æ±¡æŸ“é£é™©</strong>: å°½ç®¡æœ‰ CSS Modules å’Œ Tailwind å‰ç¼€ï¼Œä½†å¯¹äºæŸäº›æœªç»è¿‡å¤„ç†çš„ç¬¬ä¸‰æ–¹åº“æ ·å¼ï¼ˆå¦‚å…¨å±€å¼•å…¥çš„ <code>antd.css</code>ï¼‰ï¼Œä»å¯èƒ½å‘ç”Ÿ Host ä¸ Remote ä¹‹é—´çš„æ ·å¼è¦†ç›–é—®é¢˜ã€‚</li>
<li><strong>æ„å»ºå·¥å…·ç»‘å®š</strong>: å¼ºä¾èµ– Webpack 5ã€‚å¦‚æœæœªæ¥é¡¹ç›®æƒ³è¿ç§»åˆ° Vite æˆ–å…¶ä»–æ„å»ºå·¥å…·ï¼Œéœ€è¦å¼•å…¥é¢å¤–çš„é€‚é…å±‚ï¼ˆå¦‚ <code>vite-plugin-federation</code>ï¼‰ï¼Œå¹¶å¤„ç†åº•å±‚è¿è¡Œæ—¶å®ç°çš„ç»†å¾®å·®å¼‚ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 æ•ˆç‡åˆ†æ°´å²­ï¼šä»"ä¼šæé—®"åˆ°"ä¼šå†™æŠ€èƒ½"ï¼ŒRulesã€Skillsã€MCP ä¸‰å‰‘å®¢é‡å¡‘ AI åä½œ]]></title>    <link>https://juejin.cn/post/7601041482892558386</link>    <guid>https://juejin.cn/post/7601041482892558386</guid>    <pubDate>2026-01-31T11:37:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601041482892558386" data-draft-id="7601076976439820328" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 æ•ˆç‡åˆ†æ°´å²­ï¼šä»&quot;ä¼šæé—®&quot;åˆ°&quot;ä¼šå†™æŠ€èƒ½&quot;ï¼ŒRulesã€Skillsã€MCP ä¸‰å‰‘å®¢é‡å¡‘ AI åä½œ"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,Agent"/> <meta itemprop="datePublished" content="2026-01-31T11:37:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ—¶å‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1197805741808339"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 æ•ˆç‡åˆ†æ°´å²­ï¼šä»"ä¼šæé—®"åˆ°"ä¼šå†™æŠ€èƒ½"ï¼ŒRulesã€Skillsã€MCP ä¸‰å‰‘å®¢é‡å¡‘ AI åä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1197805741808339/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ—¶å‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T11:37:09.000Z" title="Sat Jan 31 2026 11:37:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»17åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯ Agent Skillsï¼Ÿ</h3>
<p>Agent Skills æ˜¯ç”± Anthropic å¼€å‘å¹¶ä½œä¸ºå¼€æ”¾æ ‡å‡†å‘å¸ƒçš„æ™ºèƒ½ä½“èƒ½åŠ›æ‰©å±•å·¥å…·ï¼Œå…¶æœ¬è´¨æ˜¯å°†ä¸“ä¸šçŸ¥è¯†å’Œå·¥ä½œæµå°è£…ä¸ºå¯å¤ç”¨çš„èƒ½åŠ›å•å…ƒã€‚</p>
<p>ä¸ä¼ ç»Ÿæç¤ºè¯å·¥ç¨‹ä¸åŒï¼ŒAgent Skills é‡‡ç”¨"æ–‡ä»¶å¤¹+SKILL.md"çš„ç»“æ„åŒ–è®¾è®¡ï¼Œä½¿æ¨¡å‹èƒ½å¤ŸæŒ‰éœ€åŠ è½½ä¸åŒå±‚çº§çš„æŠ€èƒ½ä¿¡æ¯ã€‚</p>
<h3 data-id="heading-2">Agent Skills çš„ä¸‰å¤§æ ¸å¿ƒä»·å€¼</h3>
<ol>
<li><strong>çŸ¥è¯†å¤–ç½®åŒ–</strong>ï¼šå°†é¢†åŸŸçŸ¥è¯†ä»æ¨¡å‹æƒé‡ä¸­è§£è€¦ï¼Œå˜æˆå¯ç¼–è¾‘ã€å¯ç‰ˆæœ¬æ§åˆ¶çš„æ–‡ä»¶</li>
<li><strong>ä¸Šä¸‹æ–‡é«˜æ•ˆåŒ–</strong>ï¼šé€šè¿‡æ¸è¿›å¼æŠ«éœ²ï¼Œåœ¨æœ‰é™çª—å£ä¸­æœ€å¤§åŒ–æœ‰æ•ˆä¿¡æ¯å¯†åº¦</li>
<li><strong>èƒ½åŠ›ç”Ÿæ€åŒ–</strong>ï¼šé€šè¿‡å¼€æ”¾æ ‡å‡†ï¼Œå®ç°è·¨å¹³å°çš„çŸ¥è¯†å…±äº«ä¸å¤ç”¨</li>
</ol>
<h3 data-id="heading-3">æ¸è¿›å¼æŠ«éœ²æœºåˆ¶</h3>
<p>Agent Skills æœ€æ ¸å¿ƒçš„åˆ›æ–°æ˜¯**æ¸è¿›å¼æŠ«éœ²ï¼ˆProgressive Disclosureï¼‰**æœºåˆ¶ã€‚è¯¥æœºåˆ¶å°†æŠ€èƒ½ä¿¡æ¯åˆ†ä¸ºä¸‰ä¸ªå±‚æ¬¡ï¼Œæ™ºèƒ½ä½“æŒ‰éœ€é€æ­¥åŠ è½½ï¼š</p>
<h4 data-id="heading-4">ï¼ˆ1ï¼‰å…ƒæ•°æ®å±‚ï¼ˆMetadataï¼‰</h4>
<p>åœ¨ Skills çš„è®¾è®¡ä¸­ï¼Œæ¯ä¸ªæŠ€èƒ½éƒ½å­˜æ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶å¤¹ä¸­ï¼Œæ ¸å¿ƒæ˜¯ä¸€ä¸ªåä¸º <code>SKILL.md</code> çš„ Markdown æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å¿…é¡»ä»¥ YAML æ ¼å¼çš„ Frontmatter å¼€å¤´ï¼Œå®šä¹‰æŠ€èƒ½çš„åŸºæœ¬ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">pdf-processing</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Extract</span> <span class="hljs-string">text</span> <span class="hljs-string">and</span> <span class="hljs-string">tables</span> <span class="hljs-string">from</span> <span class="hljs-string">PDF</span> <span class="hljs-string">files...</span> <span class="hljs-string">Use</span> <span class="hljs-string">when</span> <span class="hljs-string">working</span> <span class="hljs-string">with</span> <span class="hljs-string">PDF</span> <span class="hljs-string">files...</span>
<span class="hljs-meta">---
</span></code></pre>
<p>å½“æ™ºèƒ½ä½“å¯åŠ¨æ—¶ï¼Œå®ƒä¼šæ‰«ææ‰€æœ‰å·²å®‰è£…çš„æŠ€èƒ½æ–‡ä»¶å¤¹ï¼Œä»…è¯»å–æ¯ä¸ª <code>SKILL.md</code> çš„ Frontmatter éƒ¨åˆ†ï¼Œå°†è¿™äº›å…ƒæ•°æ®åŠ è½½åˆ°ç³»ç»Ÿæç¤ºè¯ä¸­ã€‚æ ¹æ®å®æµ‹æ•°æ®ï¼Œæ¯ä¸ªæŠ€èƒ½çš„å…ƒæ•°æ®ä»…æ¶ˆè€—çº¦ <strong>100 ä¸ª token</strong>ã€‚</p>
<h4 data-id="heading-5">ï¼ˆ2ï¼‰æŒ‡ä»¤å±‚ï¼ˆInstructionsï¼‰</h4>
<p>å½“æ™ºèƒ½ä½“é€šè¿‡åˆ†æç”¨æˆ·è¯·æ±‚ï¼Œåˆ¤æ–­æŸä¸ªæŠ€èƒ½ä¸å½“å‰ä»»åŠ¡é«˜åº¦ç›¸å…³æ—¶ï¼Œå®ƒä¼šè¿›å…¥ç¬¬äºŒå±‚åŠ è½½ã€‚æ­¤æ—¶ï¼Œæ™ºèƒ½ä½“ä¼šè¯»å–è¯¥æŠ€èƒ½çš„å®Œæ•´ <code>SKILL.md</code> æ–‡ä»¶å†…å®¹ï¼Œå°†è¯¦ç»†çš„æŒ‡ä»¤ã€æ³¨æ„äº‹é¡¹ã€ç¤ºä¾‹ç­‰åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­ã€‚è¿™éƒ¨åˆ†å†…å®¹çš„ token æ¶ˆè€—å–å†³äºæŒ‡ä»¤çš„å¤æ‚åº¦ï¼Œé€šå¸¸åœ¨ <strong>1,000 åˆ° 5,000 ä¸ª token</strong> ä¹‹é—´ã€‚</p>
<h4 data-id="heading-6">ï¼ˆ3ï¼‰èµ„æºå±‚ï¼ˆScripts &amp; Referencesï¼‰</h4>
<p>å¯¹äºæ›´å¤æ‚çš„æŠ€èƒ½ï¼Œ<code>SKILL.md</code> å¯ä»¥å¼•ç”¨åŒä¸€æ–‡ä»¶å¤¹ä¸‹çš„å…¶ä»–æ–‡ä»¶ï¼šè„šæœ¬ã€é…ç½®æ–‡ä»¶ã€å‚è€ƒæ–‡æ¡£ç­‰ã€‚æ™ºèƒ½ä½“ä»…åœ¨éœ€è¦æ—¶æ‰åŠ è½½è¿™äº›èµ„æºã€‚</p>

































<table><thead><tr><th align="left">å±‚çº§</th><th align="left">å†…å®¹</th><th align="left">åŠ è½½ç­–ç•¥</th><th align="left">Tokenæ¶ˆè€—</th><th align="left">æŠ€æœ¯ä»·å€¼</th></tr></thead><tbody><tr><td align="left">å…ƒæ•°æ®å±‚</td><td align="left">YAML Frontmatterçš„nameå’Œdescriptionå­—æ®µ</td><td align="left">Always-Onå¸¸é©»åŠ è½½</td><td align="left">æä½(&lt;1%)</td><td align="left">æ¨¡å‹è·¯ç”±å†³ç­–ä¸æ„å›¾è¯†åˆ«</td></tr><tr><td align="left">æŒ‡ä»¤å±‚</td><td align="left">SKILL.mdæ­£æ–‡çš„è§„åˆ™å’Œæ­¥éª¤</td><td align="left">On-DemandæŒ‰éœ€åŠ è½½</td><td align="left">ä¸­ç­‰(5-10%)</td><td align="left">å®šä¹‰ä¸šåŠ¡å¤„ç†é€»è¾‘ä¸SOP</td></tr><tr><td align="left">èµ„æºå±‚</td><td align="left">å¤–éƒ¨æ–‡æ¡£ã€æ‰‹å†Œã€è„šæœ¬ç­‰</td><td align="left">Context-Triggeredæ¡ä»¶è§¦å‘</td><td align="left">é«˜ä½†å¯å˜</td><td align="left">æŒ‰éœ€åŠ è½½ä¸“ä¸šçŸ¥è¯†ï¼Œç”¨å®Œå³å¼ƒ</td></tr></tbody></table>
<h2 data-id="heading-7">Rulesã€Skillsã€MCP ä¸‰è€…çš„å…³ç³»</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/465560545c3c45c994f5a6def3b226ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5pe25YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770464229&amp;x-signature=gMFs9yBh9R09J0IYA8K2RRAn498%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">1. Rulesï¼ˆè§„åˆ™ï¼‰çš„å®šä½</h3>
<p><strong>Rules</strong> æ˜¯é¡¹ç›®çº§åˆ«çš„<strong>é™æ€è§„èŒƒ</strong>ï¼Œå®šä¹‰äº†ä»£ç é£æ ¼ã€æ¶æ„æ¨¡å¼ã€å¼€å‘æµç¨‹ç­‰é€šç”¨è§„åˆ™ã€‚</p>
<h4 data-id="heading-9">ç‰¹ç‚¹ï¼š</h4>
<ul>
<li><strong>Always-Onï¼ˆå¸¸é©»ï¼‰</strong>ï¼šå§‹ç»ˆåŠ è½½åœ¨ç³»ç»Ÿæç¤ºè¯ä¸­</li>
<li><strong>é¡¹ç›®ç‰¹å®š</strong>ï¼šé’ˆå¯¹ç‰¹å®šé¡¹ç›®çš„ç¼–ç è§„èŒƒå’Œæœ€ä½³å®è·µ</li>
<li><strong>é™æ€çŸ¥è¯†</strong>ï¼šä¸éšä»»åŠ¡å˜åŒ–ï¼Œæ˜¯é¡¹ç›®çš„åŸºç¡€çº¦æŸ</li>
</ul>
<h4 data-id="heading-10">å…¸å‹ç”¨é€”ï¼š</h4>
<ul>
<li>ä»£ç é£æ ¼è§„èŒƒï¼ˆESLintã€TypeScript è§„èŒƒï¼‰</li>
<li>é¡¹ç›®æ¶æ„æ¨¡å¼ï¼ˆç»„ä»¶ç»“æ„ã€æ–‡ä»¶ç»„ç»‡ï¼‰</li>
<li>æŠ€æœ¯æ ˆä½¿ç”¨è§„èŒƒï¼ˆUnoCSS ä¼˜å…ˆã€ç»„ä»¶åº“ä½¿ç”¨ï¼‰</li>
<li>å‘½åè§„èŒƒå’Œæ³¨é‡Šè§„èŒƒ</li>
</ul>
<h4 data-id="heading-11">ç¤ºä¾‹ï¼ˆCursor Rulesï¼‰ï¼š</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># é¡¹ç›®å¼€å‘è§„èŒƒ</span>

<span class="hljs-section">## ç¼–ç è§„èŒƒ</span>
<span class="hljs-bullet">-</span> ä½¿ç”¨ TypeScriptï¼Œä¸¥æ ¼ç±»å‹æ£€æŸ¥
<span class="hljs-bullet">-</span> ä¼˜å…ˆä½¿ç”¨ UnoCSS åŸå­ç±»
<span class="hljs-bullet">-</span> ç»„ä»¶é€»è¾‘æŠ½ç¦»åˆ° useXxx.ts hooks æ–‡ä»¶
</code></pre>
<h3 data-id="heading-12">2. Skillsï¼ˆæŠ€èƒ½ï¼‰çš„å®šä½</h3>
<p><strong>Skills</strong> æ˜¯ä»»åŠ¡çº§åˆ«çš„<strong>åŠ¨æ€èƒ½åŠ›</strong>ï¼Œæä¾›ç‰¹å®šé¢†åŸŸçš„ä¸“ä¸šçŸ¥è¯†å’Œå·¥ä½œæµç¨‹ã€‚</p>
<h4 data-id="heading-13">ç‰¹ç‚¹ï¼š</h4>
<ul>
<li><strong>On-Demandï¼ˆæŒ‰éœ€ï¼‰</strong>ï¼šä»…åœ¨ç›¸å…³ä»»åŠ¡æ—¶åŠ è½½</li>
<li><strong>é¢†åŸŸç‰¹å®š</strong>ï¼šé’ˆå¯¹ç‰¹å®šä»»åŠ¡æˆ–é¢†åŸŸçš„ä¸“ä¸šçŸ¥è¯†</li>
<li><strong>å¯å¤ç”¨</strong>ï¼šè·¨é¡¹ç›®ã€è·¨å¹³å°å¤ç”¨</li>
</ul>
<h4 data-id="heading-14">å…¸å‹ç”¨é€”ï¼š</h4>
<ul>
<li>è®¾è®¡ç¨¿è½¬ä»£ç ï¼ˆFigma â†’ uni-appï¼‰</li>
<li>API é›†æˆæŒ‡å—</li>
<li>æ•°æ®åˆ†æå·¥ä½œæµ</li>
<li>æ–‡æ¡£å¤„ç†æµç¨‹</li>
</ul>
<h4 data-id="heading-15">ç¤ºä¾‹ï¼ˆDesign Conversion Skillï¼‰ï¼š</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">design-conversion</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Figma</span> <span class="hljs-string">è®¾è®¡ç¨¿è½¬æ¢ä¸º</span> <span class="hljs-string">uni-app</span> <span class="hljs-string">ä»£ç çš„æŠ€èƒ½ï¼ŒåŒ…å«å›¾ç‰‡èµ„æºä¸‹è½½ã€UnoCSS</span> <span class="hljs-string">åŸå­ç±»ä½¿ç”¨ã€rpx</span> <span class="hljs-string">å•ä½è½¬æ¢ç­‰å®Œæ•´è§„èŒƒ</span>
<span class="hljs-meta">---
</span></code></pre>
<h3 data-id="heading-16">3. MCPï¼ˆModel Context Protocolï¼‰çš„å®šä½</h3>
<p><strong>MCP</strong> æ˜¯å·¥å…·çº§åˆ«çš„<strong>è¿æ¥åè®®</strong>ï¼Œæä¾›æ ‡å‡†åŒ–çš„å¤–éƒ¨å·¥å…·å’Œæ•°æ®è®¿é—®æ¥å£ã€‚</p>
<h4 data-id="heading-17">ç‰¹ç‚¹ï¼š</h4>
<ul>
<li><strong>å·¥å…·æ¥å£</strong>ï¼šå®šä¹‰å¦‚ä½•è®¿é—®å¤–éƒ¨å·¥å…·å’Œæ•°æ®</li>
<li><strong>æ ‡å‡†åŒ–</strong>ï¼šç»Ÿä¸€çš„åè®®è§„èŒƒ</li>
<li><strong>è¿è¡Œæ—¶</strong>ï¼šåŠ¨æ€è°ƒç”¨å¤–éƒ¨æœåŠ¡</li>
</ul>
<h4 data-id="heading-18">å…¸å‹ç”¨é€”ï¼š</h4>
<ul>
<li>æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</li>
<li>æ•°æ®åº“æŸ¥è¯¢</li>
<li>API è°ƒç”¨</li>
<li>å¤–éƒ¨æœåŠ¡é›†æˆï¼ˆFigmaã€GitHub ç­‰ï¼‰</li>
</ul>
<h3 data-id="heading-19">ä¸‰è€…å…³ç³»è¯¦è§£</h3>
<h4 data-id="heading-20">å…³ç³»ç±»æ¯”</h4>
<p>ç”¨ä¸€ä¸ªå®Œæ•´çš„è½¯ä»¶å¼€å‘æµç¨‹æ¥ç†è§£ï¼š</p>
<ol>
<li>
<p><strong>Rules = å…¬å¸ç¼–ç è§„èŒƒæ‰‹å†Œ</strong></p>
<ul>
<li>å®šä¹‰"æ€ä¹ˆå†™ä»£ç "çš„é€šç”¨è§„åˆ™</li>
<li>æ‰€æœ‰é¡¹ç›®éƒ½è¦éµå¾ª</li>
<li>ä¾‹å¦‚ï¼šä½¿ç”¨ TypeScriptã€ä¼˜å…ˆä½¿ç”¨ UnoCSS</li>
</ul>
</li>
<li>
<p><strong>Skills = ç‰¹å®šä»»åŠ¡çš„æ“ä½œæ‰‹å†Œ</strong></p>
<ul>
<li>å®šä¹‰"å¦‚ä½•å®Œæˆç‰¹å®šä»»åŠ¡"çš„ä¸“ä¸šçŸ¥è¯†</li>
<li>æŒ‰éœ€åŠ è½½ï¼Œé’ˆå¯¹ç‰¹å®šåœºæ™¯</li>
<li>ä¾‹å¦‚ï¼šå¦‚ä½•å°† Figma è®¾è®¡ç¨¿è½¬æ¢ä¸ºä»£ç </li>
</ul>
</li>
<li>
<p><strong>MCP = å·¥å…·å’ŒæœåŠ¡çš„é©±åŠ¨ç¨‹åº</strong></p>
<ul>
<li>å®šä¹‰"å¦‚ä½•è¿æ¥å’Œä½¿ç”¨å·¥å…·"</li>
<li>æä¾›æ ‡å‡†åŒ–çš„æ¥å£</li>
<li>ä¾‹å¦‚ï¼šå¦‚ä½•è®¿é—® Figma APIã€å¦‚ä½•æ“ä½œæ–‡ä»¶ç³»ç»Ÿ</li>
</ul>
</li>
</ol>
<h4 data-id="heading-21">åä½œæµç¨‹ç¤ºä¾‹</h4>
<p>å‡è®¾ç”¨æˆ·è¯·æ±‚ï¼š"å¸®æˆ‘æŠŠè¿™ä¸ª Figma è®¾è®¡ç¨¿è½¬æ¢æˆä»£ç "</p>
<pre><code class="hljs language-md" lang="md"><span class="hljs-bullet">1.</span> Rules æä¾›åŸºç¡€çº¦æŸ
   â””â”€&gt; "ä½¿ç”¨ UnoCSS åŸå­ç±»ï¼Œä¸è¦è‡ªå®šä¹‰ CSS"
   â””â”€&gt; "ä½¿ç”¨ TypeScriptï¼Œä¸¥æ ¼ç±»å‹æ£€æŸ¥"
   â””â”€&gt; "ç»„ä»¶é€»è¾‘æŠ½ç¦»åˆ° hooks æ–‡ä»¶"

<span class="hljs-bullet">2.</span> Skills æä¾›ä¸“ä¸šçŸ¥è¯†
   â””â”€&gt; è§¦å‘ design-conversion skill
   â””â”€&gt; åŠ è½½ "å¦‚ä½•ä» Figma ä¸‹è½½å›¾ç‰‡"
   â””â”€&gt; åŠ è½½ "rpx å•ä½è½¬æ¢è§„åˆ™"
   â””â”€&gt; åŠ è½½ "UnoCSS ä½¿ç”¨è§„èŒƒ"

<span class="hljs-bullet">3.</span> MCP æä¾›å·¥å…·æ¥å£
   â””â”€&gt; ä½¿ç”¨ Figma MCP ä¸‹è½½å›¾ç‰‡èµ„æº
   â””â”€&gt; ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿ MCP ä¿å­˜æ–‡ä»¶
   â””â”€&gt; ä½¿ç”¨ä»£ç ç¼–è¾‘å™¨ MCP åˆ›å»ºæ–‡ä»¶
</code></pre>
<h4 data-id="heading-22">èŒè´£åˆ†ç¦»åŸåˆ™</h4>
<p><strong>è®¾è®¡ç†å¿µï¼šè¿æ¥æ€§ï¼ˆConnectivityï¼‰ä¸èƒ½åŠ›ï¼ˆCapabilityï¼‰åº”è¯¥åˆ†ç¦»ã€‚</strong></p>
<ul>
<li><strong>MCP ä¸“æ³¨äºè¿æ¥æ€§</strong>ï¼šæä¾›æ ‡å‡†åŒ–çš„è®¿é—®æ¥å£ï¼Œè®©æ™ºèƒ½ä½“èƒ½å¤Ÿ"å¤Ÿå¾—ç€"å¤–éƒ¨ä¸–ç•Œçš„æ•°æ®å’Œå·¥å…·</li>
<li><strong>Skills ä¸“æ³¨äºèƒ½åŠ›</strong>ï¼šæä¾›é¢†åŸŸä¸“ä¸šçŸ¥è¯†ï¼Œå‘Šè¯‰æ™ºèƒ½ä½“åœ¨ç‰¹å®šåœºæ™¯ä¸‹"å¦‚ä½•ç»„åˆä½¿ç”¨è¿™äº›å·¥å…·"</li>
<li><strong>Rules ä¸“æ³¨äºçº¦æŸ</strong>ï¼šæä¾›é¡¹ç›®çº§åˆ«çš„è§„èŒƒå’Œæœ€ä½³å®è·µï¼Œç¡®ä¿è¾“å‡ºç¬¦åˆé¡¹ç›®æ ‡å‡†</li>
</ul>
<p><strong>å¦‚æœè¯´ MCP ä¸ºæ™ºèƒ½ä½“æä¾›äº†"æ‰‹"æ¥æ“ä½œå·¥å…·ï¼Œé‚£ä¹ˆ Skills å°±æä¾›äº†"æ“ä½œæ‰‹å†Œ"æˆ–"SOPï¼ˆæ ‡å‡†ä½œä¸šç¨‹åºï¼‰"ï¼ŒRules åˆ™æä¾›äº†"å…¬å¸è§„èŒƒæ‰‹å†Œ"ã€‚</strong></p>
<h3 data-id="heading-23">å¯¹æ¯”æ€»ç»“</h3>





















































<table><thead><tr><th align="left">ç»´åº¦</th><th align="left">Rules</th><th align="left">Skills</th><th align="left">MCP</th></tr></thead><tbody><tr><td align="left"><strong>å®šä½</strong></td><td align="left">é¡¹ç›®è§„èŒƒ</td><td align="left">é¢†åŸŸçŸ¥è¯†</td><td align="left">å·¥å…·æ¥å£</td></tr><tr><td align="left"><strong>åŠ è½½æ—¶æœº</strong></td><td align="left">Always-On</td><td align="left">On-Demand</td><td align="left">Runtime</td></tr><tr><td align="left"><strong>ä½œç”¨èŒƒå›´</strong></td><td align="left">é¡¹ç›®çº§åˆ«</td><td align="left">ä»»åŠ¡çº§åˆ«</td><td align="left">å·¥å…·çº§åˆ«</td></tr><tr><td align="left"><strong>å†…å®¹æ€§è´¨</strong></td><td align="left">é™æ€è§„èŒƒ</td><td align="left">åŠ¨æ€èƒ½åŠ›</td><td align="left">è¿æ¥åè®®</td></tr><tr><td align="left"><strong>Tokenæ¶ˆè€—</strong></td><td align="left">ä¸­ç­‰ï¼ˆå¸¸é©»ï¼‰</td><td align="left">å¯å˜ï¼ˆæŒ‰éœ€ï¼‰</td><td align="left">ä½ï¼ˆæ¥å£å®šä¹‰ï¼‰</td></tr><tr><td align="left"><strong>å¤ç”¨æ€§</strong></td><td align="left">é¡¹ç›®å†…</td><td align="left">è·¨é¡¹ç›®</td><td align="left">è·¨å¹³å°</td></tr><tr><td align="left"><strong>æ›´æ–°é¢‘ç‡</strong></td><td align="left">ä½</td><td align="left">ä¸­</td><td align="left">ä¸­</td></tr></tbody></table>
<h2 data-id="heading-24">å¦‚ä½•å†™å¥½ä¸€ä¸ª Skill</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/656ee6edb52f4ce995f4800c3c653bb7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5pe25YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770464229&amp;x-signature=9vnnWqNq8oaNwS7gx%2FtcYilbFMk%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-25">æ ¸å¿ƒåŸåˆ™</h3>
<h4 data-id="heading-26">1. ç®€æ´æ˜¯å…³é”®</h4>
<p><strong>ä¸Šä¸‹æ–‡çª—å£æ˜¯å…¬å…±èµ„æºã€‚</strong> æŠ€èƒ½ä¸ Claude éœ€è¦çš„æ‰€æœ‰å…¶ä»–å†…å®¹å…±äº«ä¸Šä¸‹æ–‡çª—å£ï¼šç³»ç»Ÿæç¤ºã€å¯¹è¯å†å²ã€å…¶ä»–æŠ€èƒ½çš„å…ƒæ•°æ®ä»¥åŠå®é™…çš„ç”¨æˆ·è¯·æ±‚ã€‚</p>
<p><strong>é»˜è®¤å‡è®¾ï¼šClaude å·²ç»éå¸¸æ™ºèƒ½ã€‚</strong> åªæ·»åŠ  Claude å°šæœªå…·å¤‡çš„ä¸Šä¸‹æ–‡ã€‚è´¨ç–‘æ¯æ¡ä¿¡æ¯ï¼š</p>
<ul>
<li>"Claude çœŸçš„éœ€è¦è¿™ä¸ªè§£é‡Šå—ï¼Ÿ"</li>
<li>"è¿™æ®µæ–‡å­—å€¼å¾—å®ƒçš„ token æˆæœ¬å—ï¼Ÿ"</li>
</ul>
<p><strong>ä¼˜å…ˆä½¿ç”¨ç®€æ´çš„ç¤ºä¾‹è€Œä¸æ˜¯å†—é•¿çš„è§£é‡Šã€‚</strong></p>
<h4 data-id="heading-27">2. è®¾ç½®é€‚å½“çš„è‡ªç”±åº¦</h4>
<p>æ ¹æ®ä»»åŠ¡çš„è„†å¼±æ€§å’Œå¯å˜æ€§åŒ¹é…å…·ä½“ç¨‹åº¦ï¼š</p>
<ul>
<li><strong>é«˜è‡ªç”±åº¦ï¼ˆåŸºäºæ–‡æœ¬çš„æŒ‡ä»¤ï¼‰</strong>ï¼šå½“å¤šç§æ–¹æ³•éƒ½æœ‰æ•ˆã€å†³ç­–å–å†³äºä¸Šä¸‹æ–‡æˆ–å¯å‘å¼æ–¹æ³•æŒ‡å¯¼æ–¹æ³•æ—¶ä½¿ç”¨</li>
<li><strong>ä¸­ç­‰è‡ªç”±åº¦ï¼ˆä¼ªä»£ç æˆ–å¸¦å‚æ•°çš„è„šæœ¬ï¼‰</strong>ï¼šå½“å­˜åœ¨é¦–é€‰æ¨¡å¼ã€å¯æ¥å—ä¸€äº›å˜åŒ–æˆ–é…ç½®å½±å“è¡Œä¸ºæ—¶ä½¿ç”¨</li>
<li><strong>ä½è‡ªç”±åº¦ï¼ˆç‰¹å®šè„šæœ¬ï¼Œå°‘é‡å‚æ•°ï¼‰</strong>ï¼šå½“æ“ä½œè„†å¼±ä¸”å®¹æ˜“å‡ºé”™ã€ä¸€è‡´æ€§è‡³å…³é‡è¦æˆ–å¿…é¡»éµå¾ªç‰¹å®šé¡ºåºæ—¶ä½¿ç”¨</li>
</ul>
<p>å°† Claude æƒ³è±¡æˆåœ¨æ¢ç´¢ä¸€æ¡è·¯å¾„ï¼šæœ‰æ‚¬å´–çš„ç‹­çª„æ¡¥æ¢éœ€è¦ç‰¹å®šçš„æŠ¤æ ï¼ˆä½è‡ªç”±åº¦ï¼‰ï¼Œè€Œå¼€é˜”çš„ç”°é‡å…è®¸å¤šæ¡è·¯çº¿ï¼ˆé«˜è‡ªç”±åº¦ï¼‰ã€‚</p>
<h4 data-id="heading-28">3. æ¸è¿›å¼æŠ«éœ²è®¾è®¡</h4>
<p>ä¿æŒ <code>SKILL.md</code> æ­£æ–‡ç²¾ç®€ï¼Œä¸è¶…è¿‡ 500 è¡Œï¼Œä»¥æœ€å°åŒ–ä¸Šä¸‹æ–‡è†¨èƒ€ã€‚å½“æ¥è¿‘æ­¤é™åˆ¶æ—¶ï¼Œå°†å†…å®¹æ‹†åˆ†åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚</p>
<p><strong>å…³é”®åŸåˆ™ï¼š</strong> å½“æŠ€èƒ½æ”¯æŒå¤šç§å˜ä½“ã€æ¡†æ¶æˆ–é€‰é¡¹æ—¶ï¼Œä»…åœ¨ <code>SKILL.md</code> ä¸­ä¿ç•™æ ¸å¿ƒå·¥ä½œæµç¨‹å’Œé€‰æ‹©æŒ‡å¯¼ã€‚å°†ç‰¹å®šäºå˜ä½“çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ¨¡å¼ã€ç¤ºä¾‹ã€é…ç½®ï¼‰ç§»è‡³å•ç‹¬çš„å‚è€ƒæ–‡ä»¶ã€‚</p>
<h3 data-id="heading-29">Skill åˆ›å»ºæµç¨‹</h3>
<h4 data-id="heading-30">æ­¥éª¤ 1ï¼šé€šè¿‡å…·ä½“ç¤ºä¾‹ç†è§£æŠ€èƒ½</h4>
<p>è¦åˆ›å»ºæœ‰æ•ˆçš„æŠ€èƒ½ï¼Œéœ€è¦æ¸…æ¥šç†è§£æŠ€èƒ½å°†å¦‚ä½•ä½¿ç”¨çš„å…·ä½“ç¤ºä¾‹ã€‚è¿™ç§ç†è§£å¯ä»¥æ¥è‡ªç›´æ¥çš„ç”¨æˆ·ç¤ºä¾‹æˆ–ç»è¿‡ç”¨æˆ·åé¦ˆéªŒè¯çš„ç”Ÿæˆç¤ºä¾‹ã€‚</p>
<p><strong>å…³é”®é—®é¢˜ï¼š</strong></p>
<ul>
<li>"æ­¤æŠ€èƒ½åº”è¯¥æ”¯æŒå“ªäº›åŠŸèƒ½ï¼Ÿ"</li>
<li>"æ‚¨èƒ½ç»™ä¸€äº›å¦‚ä½•ä½¿ç”¨æ­¤æŠ€èƒ½çš„ç¤ºä¾‹å—ï¼Ÿ"</li>
<li>"ç”¨æˆ·è¯´ä»€ä¹ˆåº”è¯¥è§¦å‘æ­¤æŠ€èƒ½ï¼Ÿ"</li>
</ul>
<h4 data-id="heading-31">æ­¥éª¤ 2ï¼šè§„åˆ’å¯é‡ç”¨çš„æŠ€èƒ½å†…å®¹</h4>
<p>è¦å°†å…·ä½“ç¤ºä¾‹è½¬åŒ–ä¸ºæœ‰æ•ˆçš„æŠ€èƒ½ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ†ææ¯ä¸ªç¤ºä¾‹ï¼š</p>
<ol>
<li>è€ƒè™‘å¦‚ä½•ä»å¤´å¼€å§‹æ‰§è¡Œç¤ºä¾‹</li>
<li>ç¡®å®šåœ¨é‡å¤æ‰§è¡Œè¿™äº›å·¥ä½œæµç¨‹æ—¶å“ªäº›è„šæœ¬ã€å‚è€ƒèµ„æ–™å’Œèµ„äº§ä¼šæœ‰å¸®åŠ©</li>
</ol>
<p><strong>åˆ†æç»´åº¦ï¼š</strong></p>
<ul>
<li><strong>è„šæœ¬ï¼ˆscripts/ï¼‰</strong>ï¼šéœ€è¦ç¡®å®šæ€§å¯é æ€§æˆ–é‡å¤ç¼–å†™çš„ä»£ç </li>
<li><strong>å‚è€ƒèµ„æ–™ï¼ˆreferences/ï¼‰</strong>ï¼šéœ€è¦å‚è€ƒçš„æ–‡æ¡£ã€API è§„èŒƒã€æ•°æ®åº“æ¨¡å¼ç­‰</li>
<li><strong>èµ„äº§ï¼ˆassets/ï¼‰</strong>ï¼šæ¨¡æ¿ã€å›¾æ ‡ã€å­—ä½“ç­‰è¾“å‡ºèµ„æº</li>
</ul>
<h4 data-id="heading-32">æ­¥éª¤ 3ï¼šç¼–å†™ YAML å‰ç½®å…ƒæ•°æ®</h4>
<p><strong>è¿™æ˜¯æŠ€èƒ½æœ€é‡è¦çš„éƒ¨åˆ†</strong>ï¼Œå› ä¸ºè¿™æ˜¯ Claude ç”¨æ¥ç¡®å®šä½•æ—¶ä½¿ç”¨è¯¥æŠ€èƒ½çš„å”¯ä¸€å­—æ®µã€‚</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">skill-name</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">æ¸…æ™°å…¨é¢åœ°æè¿°æŠ€èƒ½æ˜¯ä»€ä¹ˆä»¥åŠä½•æ—¶åº”è¯¥ä½¿ç”¨å®ƒã€‚åŒ…æ‹¬æŠ€èƒ½åšä»€ä¹ˆä»¥åŠä½¿ç”¨å®ƒçš„ç‰¹å®šè§¦å‘å™¨/ä¸Šä¸‹æ–‡ã€‚</span>
<span class="hljs-meta">---
</span></code></pre>
<p><strong>å…³é”®è¦ç‚¹ï¼š</strong></p>
<ul>
<li><code>name</code>ï¼šæŠ€èƒ½åç§°ï¼Œä½¿ç”¨ kebab-case</li>
<li><code>description</code>ï¼š<strong>å¿…é¡»åŒ…å«æ‰€æœ‰"ä½•æ—¶ä½¿ç”¨"ä¿¡æ¯</strong>â€”â€”è€Œä¸æ˜¯åœ¨æ­£æ–‡ä¸­ã€‚æ­£æ–‡ä»…åœ¨è§¦å‘ååŠ è½½ï¼Œå› æ­¤æ­£æ–‡ä¸­çš„"ä½•æ—¶ä½¿ç”¨æ­¤æŠ€èƒ½"éƒ¨åˆ†å¯¹ Claude æ²¡æœ‰å¸®åŠ©</li>
<li>ä¸è¦åœ¨ YAML å‰ç½®å…ƒæ•°æ®ä¸­åŒ…å«ä»»ä½•å…¶ä»–å­—æ®µï¼ˆé™¤éæœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œå¦‚ <code>license</code>ï¼‰</li>
</ul>
<p><strong>å¥½çš„æè¿°ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">description:</span> <span class="hljs-string">å…¨é¢çš„æ–‡æ¡£åˆ›å»ºã€ç¼–è¾‘å’Œåˆ†æï¼Œæ”¯æŒä¿®è®¢è¿½è¸ªã€æ‰¹æ³¨ã€æ ¼å¼ä¿ç•™å’Œæ–‡æœ¬æå–ã€‚å½“</span> <span class="hljs-string">Claude</span> <span class="hljs-string">éœ€è¦å¤„ç†ä¸“ä¸šæ–‡æ¡£ï¼ˆ.docx</span> <span class="hljs-string">æ–‡ä»¶ï¼‰æ—¶ä½¿ç”¨ï¼Œç”¨äºï¼š(1)</span> <span class="hljs-string">åˆ›å»ºæ–°æ–‡æ¡£ï¼Œ(2)</span> <span class="hljs-string">ä¿®æ”¹æˆ–ç¼–è¾‘å†…å®¹ï¼Œ(3)</span> <span class="hljs-string">å¤„ç†ä¿®è®¢è¿½è¸ªï¼Œ(4)</span> <span class="hljs-string">æ·»åŠ æ‰¹æ³¨ï¼Œæˆ–ä»»ä½•å…¶ä»–æ–‡æ¡£ä»»åŠ¡</span>
</code></pre>
<h4 data-id="heading-33">æ­¥éª¤ 4ï¼šç¼–å†™ SKILL.md æ­£æ–‡</h4>
<p><strong>å†™ä½œæŒ‡å—ï¼š</strong> å§‹ç»ˆä½¿ç”¨ç¥ˆä½¿å¥/ä¸å®šå¼å½¢å¼ã€‚</p>
<p><strong>ç»“æ„å»ºè®®ï¼š</strong></p>
<ol>
<li><strong>å¿«é€Ÿå…¥é—¨</strong>ï¼šæ ¸å¿ƒå·¥ä½œæµç¨‹çš„ç®€æ´ç¤ºä¾‹</li>
<li><strong>è¯¦ç»†è§„åˆ™</strong>ï¼šåˆ†æ­¥éª¤çš„è¯¦ç»†è¯´æ˜</li>
<li><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šå¸¸è§é”™è¯¯å’Œé™·é˜±</li>
<li><strong>å‚è€ƒèµ„æº</strong>ï¼šé“¾æ¥åˆ° <code>references/</code> ä¸­çš„è¯¦ç»†æ–‡æ¡£</li>
</ol>
<p><strong>é¿å…ï¼š</strong></p>
<ul>
<li>å†—é•¿çš„è§£é‡Šï¼ˆä¼˜å…ˆä½¿ç”¨ç¤ºä¾‹ï¼‰</li>
<li>é‡å¤ Rules ä¸­å·²æœ‰çš„å†…å®¹</li>
<li>è¿‡äºè¯¦ç»†çš„å®ç°ç»†èŠ‚ï¼ˆç§»åˆ° <code>references/</code> ä¸­ï¼‰</li>
</ul>
<h4 data-id="heading-34">æ­¥éª¤ 5ï¼šç»„ç»‡èµ„æºæ–‡ä»¶</h4>
<p>æ ¹æ®æ­¥éª¤ 2 çš„åˆ†æï¼Œåˆ›å»ºå¿…è¦çš„èµ„æºæ–‡ä»¶ï¼š</p>
<ul>
<li><strong>scripts/</strong>ï¼šå¯æ‰§è¡Œä»£ç ï¼ˆPython/Bash ç­‰ï¼‰</li>
<li><strong>references/</strong>ï¼šå‚è€ƒæ–‡æ¡£ï¼ˆAPI æ–‡æ¡£ã€æ•°æ®åº“æ¨¡å¼ã€è¯¦ç»†æŒ‡å—ç­‰ï¼‰</li>
<li><strong>assets/</strong>ï¼šè¾“å‡ºèµ„æºï¼ˆæ¨¡æ¿ã€å›¾æ ‡ã€å­—ä½“ç­‰ï¼‰</li>
</ul>
<p><strong>é‡è¦åŸåˆ™ï¼š</strong></p>
<ul>
<li>é¿å…é‡å¤ï¼šä¿¡æ¯åº”ä»…å­˜åœ¨äº <code>SKILL.md</code> æˆ–å‚è€ƒæ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯ä¸¤è€…éƒ½æœ‰</li>
<li>ä¿æŒ <code>SKILL.md</code> ç²¾ç®€ï¼šä»…åœ¨ <code>SKILL.md</code> ä¸­ä¿ç•™åŸºæœ¬çš„ç¨‹åºæ€§æŒ‡ä»¤å’Œå·¥ä½œæµç¨‹æŒ‡å¯¼</li>
<li>å°†è¯¦ç»†çš„å‚è€ƒææ–™ã€æ¨¡å¼å’Œç¤ºä¾‹ç§»è‡³å‚è€ƒæ–‡ä»¶</li>
</ul>
<h4 data-id="heading-35">æ­¥éª¤ 6ï¼šæµ‹è¯•å’Œè¿­ä»£</h4>
<p>åœ¨å®é™…ä»»åŠ¡ä¸­ä½¿ç”¨æŠ€èƒ½ï¼Œæ³¨æ„å›°éš¾æˆ–ä½æ•ˆä¹‹å¤„ï¼Œç¡®å®šåº”å¦‚ä½•æ›´æ–° <code>SKILL.md</code> æˆ–æ†ç»‘èµ„æºï¼Œå®æ–½æ›´æ”¹å¹¶å†æ¬¡æµ‹è¯•ã€‚</p>
<h2 data-id="heading-36">Skill çš„é€šç”¨ç›®å½•ç»“æ„</h2>
<h3 data-id="heading-37">æ ‡å‡†ç›®å½•ç»“æ„</h3>
<pre><code class="hljs language-text" lang="text">skill-name/
â”œâ”€â”€ SKILL.md                    # å¿…éœ€ï¼šæŠ€èƒ½ä¸»æ–‡ä»¶
â”‚   â”œâ”€â”€ YAML å‰ç½®å…ƒæ•°æ®ï¼ˆå¿…éœ€ï¼‰
â”‚   â”‚   â”œâ”€â”€ name:ï¼ˆå¿…éœ€ï¼‰
â”‚   â”‚   â””â”€â”€ description:ï¼ˆå¿…éœ€ï¼‰
â”‚   â””â”€â”€ Markdown è¯´æ˜ï¼ˆå¿…éœ€ï¼‰
â”‚
â””â”€â”€ æ†ç»‘èµ„æºï¼ˆå¯é€‰ï¼‰
    â”œâ”€â”€ scripts/                # å¯æ‰§è¡Œä»£ç 
    â”‚   â”œâ”€â”€ process_data.py
    â”‚   â””â”€â”€ generate_report.sh
    â”‚
    â”œâ”€â”€ references/             # å‚è€ƒæ–‡æ¡£
    â”‚   â”œâ”€â”€ api-docs.md
    â”‚   â”œâ”€â”€ database-schema.md
    â”‚   â””â”€â”€ workflows.md
    â”‚
    â””â”€â”€ assets/                 # è¾“å‡ºèµ„æº
        â”œâ”€â”€ templates/
        â”‚   â””â”€â”€ report-template.html
        â”œâ”€â”€ icons/
        â”‚   â””â”€â”€ logo.png
        â””â”€â”€ fonts/
            â””â”€â”€ custom-font.ttf
</code></pre>
<h3 data-id="heading-38">ç›®å½•è¯´æ˜</h3>
<h4 data-id="heading-39">SKILL.mdï¼ˆå¿…éœ€ï¼‰</h4>
<p>æ¯ä¸ªæŠ€èƒ½çš„æ ¸å¿ƒæ–‡ä»¶ï¼ŒåŒ…å«ï¼š</p>
<ol>
<li>
<p><strong>YAML å‰ç½®å…ƒæ•°æ®</strong>ï¼ˆå¿…éœ€ï¼‰</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">skill-name</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">æŠ€èƒ½æè¿°ï¼ŒåŒ…å«ä½•æ—¶ä½¿ç”¨æ­¤æŠ€èƒ½çš„ä¿¡æ¯</span>
<span class="hljs-meta">---
</span></code></pre>
</li>
<li>
<p><strong>Markdown æ­£æ–‡</strong>ï¼ˆå¿…éœ€ï¼‰</p>
<ul>
<li>ä½¿ç”¨æŠ€èƒ½çš„è¯´æ˜å’ŒæŒ‡å¯¼</li>
<li>ä»…åœ¨æŠ€èƒ½è§¦å‘ååŠ è½½</li>
<li>ä¿æŒç²¾ç®€ï¼Œä¸è¶…è¿‡ 500 è¡Œ</li>
</ul>
</li>
</ol>
<h4 data-id="heading-40">scripts/ï¼ˆå¯é€‰ï¼‰</h4>
<p>ç”¨äºéœ€è¦ç¡®å®šæ€§å¯é æ€§æˆ–é‡å¤ç¼–å†™çš„ä»»åŠ¡çš„å¯æ‰§è¡Œä»£ç ã€‚</p>
<p><strong>ä½•æ—¶åŒ…å«ï¼š</strong></p>
<ul>
<li>å½“ç›¸åŒçš„ä»£ç è¢«é‡å¤ç¼–å†™æ—¶</li>
<li>å½“éœ€è¦ç¡®å®šæ€§å¯é æ€§æ—¶</li>
<li>å½“æ“ä½œå¤æ‚ä¸”å®¹æ˜“å‡ºé”™æ—¶</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<ul>
<li><code>scripts/rotate_pdf.py</code> - PDF æ—‹è½¬ä»»åŠ¡</li>
<li><code>scripts/process_data.py</code> - æ•°æ®å¤„ç†è„šæœ¬</li>
<li><code>scripts/generate_report.sh</code> - æŠ¥å‘Šç”Ÿæˆè„šæœ¬</li>
</ul>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>Token æ•ˆç‡é«˜ï¼ˆå¯ä»¥åœ¨ä¸åŠ è½½åˆ°ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹æ‰§è¡Œï¼‰</li>
<li>ç¡®å®šæ€§å¼ºï¼ˆé¿å… LLM ç”Ÿæˆè¿‡ç¨‹ä¸­çš„ä¸ç¡®å®šæ€§ï¼‰</li>
<li>å¯å¤ç”¨ï¼ˆè·¨ä»»åŠ¡å¤ç”¨ï¼‰</li>
</ul>
<h4 data-id="heading-41">references/ï¼ˆå¯é€‰ï¼‰</h4>
<p>ç”¨äºæ ¹æ®éœ€è¦åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­ä»¥æŒ‡å¯¼ Claude è¿‡ç¨‹å’Œæ€è€ƒçš„æ–‡æ¡£å’Œå‚è€ƒææ–™ã€‚</p>
<p><strong>ä½•æ—¶åŒ…å«ï¼š</strong></p>
<ul>
<li>ç”¨äº Claude åœ¨å·¥ä½œæ—¶åº”å‚è€ƒçš„æ–‡æ¡£</li>
<li>å½“ä¿¡æ¯é‡è¾ƒå¤§ï¼ˆ&gt;10k å­—ï¼‰æ—¶</li>
<li>å½“ä¿¡æ¯æ˜¯é¢†åŸŸç‰¹å®šçš„è¯¦ç»†çŸ¥è¯†æ—¶</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<ul>
<li><code>references/api-docs.md</code> - API è§„èŒƒæ–‡æ¡£</li>
<li><code>references/database-schema.md</code> - æ•°æ®åº“æ¨¡å¼</li>
<li><code>references/workflows.md</code> - è¯¦ç»†å·¥ä½œæµç¨‹æŒ‡å—</li>
<li><code>references/company-policies.md</code> - å…¬å¸æ”¿ç­–æ–‡æ¡£</li>
</ul>
<p><strong>æœ€ä½³å®è·µï¼š</strong></p>
<ul>
<li>å¦‚æœæ–‡ä»¶è¾ƒå¤§ï¼ˆ&gt;10k å­—ï¼‰ï¼Œåœ¨ <code>SKILL.md</code> ä¸­åŒ…å« grep æœç´¢æ¨¡å¼</li>
<li>é¿å…é‡å¤ï¼šä¿¡æ¯åº”ä»…å­˜åœ¨äº <code>SKILL.md</code> æˆ–å‚è€ƒæ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯ä¸¤è€…éƒ½æœ‰</li>
<li>ç»“æ„åŒ–è¾ƒé•¿çš„å‚è€ƒæ–‡ä»¶ï¼šåœ¨é¡¶éƒ¨åŒ…å«ç›®å½•ï¼Œä»¥ä¾¿ Claude åœ¨é¢„è§ˆæ—¶å¯ä»¥çœ‹åˆ°å®Œæ•´èŒƒå›´</li>
</ul>
<h4 data-id="heading-42">assets/ï¼ˆå¯é€‰ï¼‰</h4>
<p>ä¸æ‰“ç®—åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œè€Œæ˜¯åœ¨ Claude äº§ç”Ÿçš„è¾“å‡ºä¸­ä½¿ç”¨çš„æ–‡ä»¶ã€‚</p>
<p><strong>ä½•æ—¶åŒ…å«ï¼š</strong></p>
<ul>
<li>å½“æŠ€èƒ½éœ€è¦å°†åœ¨æœ€ç»ˆè¾“å‡ºä¸­ä½¿ç”¨çš„æ–‡ä»¶æ—¶</li>
<li>æ¨¡æ¿ã€å›¾åƒã€å›¾æ ‡ã€æ ·æ¿ä»£ç ç­‰</li>
</ul>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<ul>
<li><code>assets/logo.png</code> - å“ç‰Œèµ„äº§</li>
<li><code>assets/slides.pptx</code> - PowerPoint æ¨¡æ¿</li>
<li><code>assets/frontend-template/</code> - HTML/React æ ·æ¿</li>
<li><code>assets/font.ttf</code> - å­—ä½“æ–‡ä»¶</li>
</ul>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<ul>
<li>å°†è¾“å‡ºèµ„æºä¸æ–‡æ¡£åˆ†å¼€</li>
<li>ä½¿ Claude èƒ½å¤Ÿä½¿ç”¨æ–‡ä»¶è€Œä¸å°†å…¶åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­</li>
</ul>
<h3 data-id="heading-43">ä¸åº”åŒ…å«çš„å†…å®¹</h3>
<p>æŠ€èƒ½åº”ä»…åŒ…å«ç›´æ¥æ”¯æŒå…¶åŠŸèƒ½çš„å¿…è¦æ–‡ä»¶ã€‚ä¸è¦åˆ›å»ºå¤šä½™çš„æ–‡æ¡£æˆ–è¾…åŠ©æ–‡ä»¶ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>âŒ README.md</li>
<li>âŒ INSTALLATION_GUIDE.md</li>
<li>âŒ QUICK_REFERENCE.md</li>
<li>âŒ CHANGELOG.md</li>
<li>âŒ ç­‰ç­‰</li>
</ul>
<p>æŠ€èƒ½åº”ä»…åŒ…å« AI ä»£ç†å®Œæˆæ‰‹å¤´å·¥ä½œæ‰€éœ€çš„ä¿¡æ¯ã€‚å®ƒä¸åº”åŒ…å«å…³äºåˆ›å»ºè¿‡ç¨‹çš„è¾…åŠ©ä¸Šä¸‹æ–‡ã€è®¾ç½®å’Œæµ‹è¯•ç¨‹åºã€é¢å‘ç”¨æˆ·çš„æ–‡æ¡£ç­‰ã€‚</p>
<h3 data-id="heading-44">æ¸è¿›å¼æŠ«éœ²æ¨¡å¼ç¤ºä¾‹</h3>
<h4 data-id="heading-45">æ¨¡å¼ 1ï¼šå¸¦å‚è€ƒèµ„æ–™çš„é«˜çº§æŒ‡å—</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># PDF å¤„ç†</span>

<span class="hljs-section">## å¿«é€Ÿå…¥é—¨</span>

ä½¿ç”¨ pdfplumber æå–æ–‡æœ¬ï¼š
[ä»£ç ç¤ºä¾‹]

<span class="hljs-section">## é«˜çº§åŠŸèƒ½</span>

<span class="hljs-bullet">-</span> <span class="hljs-strong">**è¡¨å•å¡«å†™**</span>ï¼šå®Œæ•´æŒ‡å—è¯·å‚è§ [<span class="hljs-string">FORMS.md</span>](<span class="hljs-link">references/FORMS.md</span>)
<span class="hljs-bullet">-</span> <span class="hljs-strong">**API å‚è€ƒ**</span>ï¼šæ‰€æœ‰æ–¹æ³•è¯·å‚è§ [<span class="hljs-string">REFERENCE.md</span>](<span class="hljs-link">references/REFERENCE.md</span>)
<span class="hljs-bullet">-</span> <span class="hljs-strong">**ç¤ºä¾‹**</span>ï¼šå¸¸è§æ¨¡å¼è¯·å‚è§ [<span class="hljs-string">EXAMPLES.md</span>](<span class="hljs-link">references/EXAMPLES.md</span>)
</code></pre>
<p>Claude ä»…åœ¨éœ€è¦æ—¶åŠ è½½ <code>FORMS.md</code>ã€<code>REFERENCE.md</code> æˆ– <code>EXAMPLES.md</code>ã€‚</p>
<h4 data-id="heading-46">æ¨¡å¼ 2ï¼šé¢†åŸŸç‰¹å®šç»„ç»‡</h4>
<pre><code class="hljs language-text" lang="text">bigquery-skill/
â”œâ”€â”€ SKILL.mdï¼ˆæ¦‚è¿°å’Œå¯¼èˆªï¼‰
â””â”€â”€ references/
    â”œâ”€â”€ finance.mdï¼ˆæ”¶å…¥ã€è´¦å•æŒ‡æ ‡ï¼‰
    â”œâ”€â”€ sales.mdï¼ˆæœºä¼šã€ç®¡é“ï¼‰
    â”œâ”€â”€ product.mdï¼ˆAPI ä½¿ç”¨ã€åŠŸèƒ½ï¼‰
    â””â”€â”€ marketing.mdï¼ˆæ´»åŠ¨ã€å½’å› ï¼‰
</code></pre>
<p>å½“ç”¨æˆ·è¯¢é—®é”€å”®æŒ‡æ ‡æ—¶ï¼ŒClaude åªè¯»å– <code>sales.md</code>ã€‚</p>
<h4 data-id="heading-47">æ¨¡å¼ 3ï¼šæ¡ä»¶è¯¦æƒ…</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># DOCX å¤„ç†</span>

<span class="hljs-section">## åˆ›å»ºæ–‡æ¡£</span>

ä½¿ç”¨ docx-js åˆ›å»ºæ–°æ–‡æ¡£ã€‚è¯·å‚è§ [<span class="hljs-string">DOCX-JS.md</span>](<span class="hljs-link">references/DOCX-JS.md</span>)ã€‚

<span class="hljs-section">## ç¼–è¾‘æ–‡æ¡£</span>

å¯¹äºç®€å•ç¼–è¾‘ï¼Œç›´æ¥ä¿®æ”¹ XMLã€‚

<span class="hljs-strong">**å¯¹äºä¿®è®¢è¿½è¸ª**</span>ï¼šè¯·å‚è§ [<span class="hljs-string">REDLINING.md</span>](<span class="hljs-link">references/REDLINING.md</span>)
<span class="hljs-strong">**å¯¹äº OOXML è¯¦æƒ…**</span>ï¼šè¯·å‚è§ [<span class="hljs-string">OOXML.md</span>](<span class="hljs-link">references/OOXML.md</span>)
</code></pre>
<p>Claude ä»…åœ¨ç”¨æˆ·éœ€è¦è¿™äº›åŠŸèƒ½æ—¶è¯»å– <code>REDLINING.md</code> æˆ– <code>OOXML.md</code>ã€‚</p>
<p><strong>é‡è¦æŒ‡å—ï¼š</strong></p>
<ul>
<li><strong>é¿å…æ·±å±‚åµŒå¥—å¼•ç”¨</strong> - ä¿æŒå¼•ç”¨ä» <code>SKILL.md</code> èµ·ä¸€å±‚æ·±åº¦ã€‚æ‰€æœ‰å‚è€ƒæ–‡ä»¶åº”ç›´æ¥ä» <code>SKILL.md</code> é“¾æ¥</li>
<li><strong>ç»“æ„åŒ–è¾ƒé•¿çš„å‚è€ƒæ–‡ä»¶</strong> - å¯¹äºè¶…è¿‡ 100 è¡Œçš„æ–‡ä»¶ï¼Œåœ¨é¡¶éƒ¨åŒ…å«ç›®å½•</li>
</ul>
<h2 data-id="heading-48">æœ€ä½³å®è·µä¸è®¾è®¡åŸåˆ™</h2>
<h3 data-id="heading-49">1. å†…å®¹ç»„ç»‡åŸåˆ™</h3>
<h4 data-id="heading-50">ä¿æŒ SKILL.md ç²¾ç®€</h4>
<ul>
<li>ä¸è¶…è¿‡ 500 è¡Œ</li>
<li>ä¼˜å…ˆä½¿ç”¨ç¤ºä¾‹è€Œä¸æ˜¯å†—é•¿çš„è§£é‡Š</li>
<li>å°†è¯¦ç»†ä¿¡æ¯ç§»åˆ° <code>references/</code> ä¸­</li>
</ul>
<h4 data-id="heading-51">é¿å…é‡å¤</h4>
<ul>
<li>ä¿¡æ¯åº”ä»…å­˜åœ¨äº <code>SKILL.md</code> æˆ–å‚è€ƒæ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯ä¸¤è€…éƒ½æœ‰</li>
<li>ä»…åœ¨ <code>SKILL.md</code> ä¸­ä¿ç•™åŸºæœ¬çš„ç¨‹åºæ€§æŒ‡ä»¤å’Œå·¥ä½œæµç¨‹æŒ‡å¯¼</li>
<li>å°†è¯¦ç»†çš„å‚è€ƒææ–™ã€æ¨¡å¼å’Œç¤ºä¾‹ç§»è‡³å‚è€ƒæ–‡ä»¶</li>
</ul>
<h4 data-id="heading-52">ä½¿ç”¨æ¸è¿›å¼æŠ«éœ²</h4>
<ul>
<li>å…ƒæ•°æ®å±‚ï¼šAlways-Onï¼ˆçº¦ 100 tokenï¼‰</li>
<li>æŒ‡ä»¤å±‚ï¼šOn-Demandï¼ˆ1k-5k tokenï¼‰</li>
<li>èµ„æºå±‚ï¼šContext-Triggeredï¼ˆå¯å˜ï¼‰</li>
</ul>
<h3 data-id="heading-53">2. å†™ä½œé£æ ¼</h3>
<h4 data-id="heading-54">ä½¿ç”¨ç¥ˆä½¿å¥/ä¸å®šå¼å½¢å¼</h4>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># âœ… å¥½çš„å†™æ³•</span>
ä½¿ç”¨ pdfplumber æå–æ–‡æœ¬ã€‚
ä¼˜å…ˆä½¿ç”¨ UnoCSS åŸå­ç±»ã€‚

<span class="hljs-section"># âŒ é¿å…çš„å†™æ³•</span>
ä½ åº”è¯¥ä½¿ç”¨ pdfplumber æå–æ–‡æœ¬ã€‚
æˆ‘ä»¬å»ºè®®ä¼˜å…ˆä½¿ç”¨ UnoCSS åŸå­ç±»ã€‚
</code></pre>
<h3 data-id="heading-55">3. èµ„æºæ–‡ä»¶ç®¡ç†</h3>
<h4 data-id="heading-56">Scripts æœ€ä½³å®è·µ</h4>
<ul>
<li>å¿…é¡»é€šè¿‡å®é™…è¿è¡Œæ¥æµ‹è¯•</li>
<li>ç¡®ä¿æ²¡æœ‰é”™è¯¯å¹¶ä¸”è¾“å‡ºç¬¦åˆé¢„æœŸ</li>
<li>å¦‚æœæœ‰è®¸å¤šç±»ä¼¼çš„è„šæœ¬ï¼Œåªéœ€æµ‹è¯•å…·æœ‰ä»£è¡¨æ€§çš„æ ·æœ¬</li>
</ul>
<h4 data-id="heading-57">References æœ€ä½³å®è·µ</h4>
<ul>
<li>å¦‚æœæ–‡ä»¶è¾ƒå¤§ï¼ˆ&gt;10k å­—ï¼‰ï¼Œåœ¨ <code>SKILL.md</code> ä¸­åŒ…å« grep æœç´¢æ¨¡å¼</li>
<li>åœ¨é¡¶éƒ¨åŒ…å«ç›®å½•ï¼ˆå¯¹äºè¶…è¿‡ 100 è¡Œçš„æ–‡ä»¶ï¼‰</li>
<li>é¿å…æ·±å±‚åµŒå¥—å¼•ç”¨ï¼ˆä¿æŒä» <code>SKILL.md</code> èµ·ä¸€å±‚æ·±åº¦ï¼‰</li>
</ul>
<h4 data-id="heading-58">Assets æœ€ä½³å®è·µ</h4>
<ul>
<li>ä»…åŒ…å«åœ¨æœ€ç»ˆè¾“å‡ºä¸­ä½¿ç”¨çš„æ–‡ä»¶</li>
<li>ä¸è¦å°†èµ„äº§åŠ è½½åˆ°ä¸Šä¸‹æ–‡ä¸­</li>
<li>ä½¿ç”¨æœ‰æ„ä¹‰çš„å‘½å</li>
</ul>
<h3 data-id="heading-59">4. æè¿°ï¼ˆDescriptionï¼‰ç¼–å†™æŠ€å·§</h3>
<p><strong>è¿™æ˜¯æŠ€èƒ½æœ€é‡è¦çš„éƒ¨åˆ†</strong>ï¼Œå› ä¸ºè¿™æ˜¯ Claude ç”¨æ¥ç¡®å®šä½•æ—¶ä½¿ç”¨è¯¥æŠ€èƒ½çš„å”¯ä¸€å­—æ®µã€‚</p>
<h4 data-id="heading-60">å¥½çš„æè¿°åº”åŒ…å«ï¼š</h4>
<ol>
<li><strong>æŠ€èƒ½åšä»€ä¹ˆ</strong>ï¼šæ¸…æ™°æè¿°æŠ€èƒ½çš„æ ¸å¿ƒåŠŸèƒ½</li>
<li><strong>ä½•æ—¶ä½¿ç”¨</strong>ï¼šå…·ä½“çš„è§¦å‘åœºæ™¯å’Œä¸Šä¸‹æ–‡</li>
<li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼šåˆ—ä¸¾ä¸»è¦çš„ä½¿ç”¨åœºæ™¯</li>
</ol>
<h4 data-id="heading-61">ç¤ºä¾‹å¯¹æ¯”</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âŒ ä¸å¥½çš„æè¿°ï¼ˆå¤ªç®€çŸ­ï¼Œç¼ºå°‘è§¦å‘ä¿¡æ¯ï¼‰</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">PDF</span> <span class="hljs-string">å¤„ç†æŠ€èƒ½</span>

<span class="hljs-comment"># âœ… å¥½çš„æè¿°ï¼ˆåŒ…å«ä½•æ—¶ä½¿ç”¨ä¿¡æ¯ï¼‰</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">å…¨é¢çš„</span> <span class="hljs-string">PDF</span> <span class="hljs-string">æ–‡æ¡£å¤„ç†ï¼Œæ”¯æŒæ–‡æœ¬æå–ã€è¡¨æ ¼æå–ã€é¡µé¢æ—‹è½¬å’Œåˆå¹¶ã€‚å½“</span> <span class="hljs-string">Claude</span> <span class="hljs-string">éœ€è¦å¤„ç†</span> <span class="hljs-string">PDF</span> <span class="hljs-string">æ–‡ä»¶æ—¶ä½¿ç”¨ï¼Œç”¨äºï¼š(1)</span> <span class="hljs-string">æå–æ–‡æœ¬å†…å®¹ï¼Œ(2)</span> <span class="hljs-string">æå–è¡¨æ ¼æ•°æ®ï¼Œ(3)</span> <span class="hljs-string">æ—‹è½¬é¡µé¢ï¼Œ(4)</span> <span class="hljs-string">åˆå¹¶å¤šä¸ª</span> <span class="hljs-string">PDFï¼Œæˆ–ä»»ä½•å…¶ä»–</span> <span class="hljs-string">PDF</span> <span class="hljs-string">æ“ä½œä»»åŠ¡</span>
</code></pre>
<h2 data-id="heading-62">å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-63">æ¡ˆä¾‹ 1ï¼šè®¾è®¡ç¨¿è½¬æ¢ Skill</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå®é™…é¡¹ç›®ä¸­çš„ Skillï¼Œå±•ç¤ºäº†å®Œæ•´çš„ç›®å½•ç»“æ„å’Œå†…å®¹ç»„ç»‡ã€‚</p>
<h4 data-id="heading-64">ç›®å½•ç»“æ„</h4>
<pre><code class="hljs language-text" lang="text">design-conversion/
â”œâ”€â”€ SKILL.md
â””â”€â”€ references/
    â”œâ”€â”€ rpxè½¬æ¢é€ŸæŸ¥è¡¨.md
    â””â”€â”€ å“åº”å¼å•ä½ä½¿ç”¨æŒ‡å—.md
</code></pre>
<h4 data-id="heading-65">SKILL.md ç»“æ„</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">design-conversion</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Figma</span> <span class="hljs-string">è®¾è®¡ç¨¿è½¬æ¢ä¸º</span> <span class="hljs-string">uni-app</span> <span class="hljs-string">ä»£ç çš„æŠ€èƒ½ï¼ŒåŒ…å«å›¾ç‰‡èµ„æºä¸‹è½½ã€UnoCSS</span> <span class="hljs-string">åŸå­ç±»ä½¿ç”¨ã€rpx</span> <span class="hljs-string">å•ä½è½¬æ¢ç­‰å®Œæ•´è§„èŒƒ</span>
<span class="hljs-attr">tags:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">figma</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">design-to-code</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">uniapp</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">unocss</span>
  <span class="hljs-bullet">-</span> <span class="hljs-string">rpx</span>
<span class="hljs-meta">---
</span></code></pre>
<p><strong>æ­£æ–‡ç»“æ„ï¼š</strong></p>
<ol>
<li>UnoCSS ä¼˜å…ˆä½¿ç”¨è§„åˆ™ï¼ˆç¬¬ä¸€ä¼˜å…ˆçº§ï¼‰</li>
<li>å›¾ç‰‡èµ„æºä¸‹è½½è§„åˆ™</li>
<li>å¸ƒå±€å°ºå¯¸ç²¾ç¡®è¿˜åŸ</li>
<li>é¢œè‰²å€¼ç²¾ç¡®åŒ¹é…</li>
<li>æ–‡å­—æ ·å¼å®Œæ•´å¤åˆ¶</li>
<li>...ï¼ˆå…¶ä»–è§„åˆ™ï¼‰</li>
<li>è½¬æ¢æµç¨‹æ£€æŸ¥æ¸…å•</li>
<li>ç›¸å…³æ–‡æ¡£é“¾æ¥</li>
</ol>
<h4 data-id="heading-66">è®¾è®¡äº®ç‚¹</h4>
<ol>
<li>
<p><strong>æ¸è¿›å¼æŠ«éœ²</strong>ï¼š</p>
<ul>
<li>å…ƒæ•°æ®ï¼šæŠ€èƒ½åç§°å’Œæè¿°ï¼ˆAlways-Onï¼‰</li>
<li>æŒ‡ä»¤å±‚ï¼šæ ¸å¿ƒè½¬æ¢è§„åˆ™ï¼ˆOn-Demandï¼‰</li>
<li>èµ„æºå±‚ï¼šè¯¦ç»†çš„è½¬æ¢é€ŸæŸ¥è¡¨å’ŒæŒ‡å—ï¼ˆContext-Triggeredï¼‰</li>
</ul>
</li>
<li>
<p><strong>é¿å…é‡å¤</strong>ï¼š</p>
<ul>
<li><code>SKILL.md</code> ä¸­åŒ…å«æ ¸å¿ƒè§„åˆ™å’Œæ£€æŸ¥æ¸…å•</li>
<li>è¯¦ç»†çš„è½¬æ¢è¡¨å’ŒæŒ‡å—æ”¾åœ¨ <code>references/</code> ä¸­</li>
</ul>
</li>
<li>
<p><strong>æ¸…æ™°çš„è§¦å‘æ¡ä»¶</strong>ï¼š</p>
<ul>
<li>Description ä¸­æ˜ç¡®è¯´æ˜ï¼š"Figma è®¾è®¡ç¨¿è½¬æ¢ä¸º uni-app ä»£ç "</li>
<li>åŒ…å«å…·ä½“çš„ä½¿ç”¨åœºæ™¯</li>
</ul>
</li>
</ol>
<h3 data-id="heading-67">æ¡ˆä¾‹ 2ï¼šæŠ€èƒ½åˆ›å»ºå™¨ Skill</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå…ƒæŠ€èƒ½ï¼ˆmeta-skillï¼‰ï¼Œç”¨äºåˆ›å»ºå…¶ä»–æŠ€èƒ½ã€‚</p>
<h4 data-id="heading-68">ç›®å½•ç»“æ„</h4>
<pre><code class="hljs language-text" lang="text">skill-creator/
â”œâ”€â”€ SKILL.md
â”œâ”€â”€ LICENSE.txt
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ init_skill.py
â”‚   â”œâ”€â”€ package_skill.py
â”‚   â””â”€â”€ quick_validate.py
â””â”€â”€ references/
    â”œâ”€â”€ output-patterns.md
    â””â”€â”€ workflows.md
</code></pre>
<h4 data-id="heading-69">è®¾è®¡äº®ç‚¹</h4>
<ol>
<li>
<p><strong>åŒ…å«è„šæœ¬</strong>ï¼š</p>
<ul>
<li><code>init_skill.py</code>ï¼šåˆå§‹åŒ–æ–°æŠ€èƒ½</li>
<li><code>package_skill.py</code>ï¼šæ‰“åŒ…æŠ€èƒ½</li>
<li><code>quick_validate.py</code>ï¼šå¿«é€ŸéªŒè¯</li>
</ul>
</li>
<li>
<p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p>
<ul>
<li><code>output-patterns.md</code>ï¼šè¾“å‡ºæ ¼å¼æ¨¡å¼</li>
<li><code>workflows.md</code>ï¼šå·¥ä½œæµç¨‹æŒ‡å—</li>
</ul>
</li>
<li>
<p><strong>æ¸è¿›å¼æŠ«éœ²</strong>ï¼š</p>
<ul>
<li>æ ¸å¿ƒåˆ›å»ºæµç¨‹åœ¨ <code>SKILL.md</code> ä¸­</li>
<li>è¯¦ç»†çš„å·¥ä½œæµç¨‹å’Œè¾“å‡ºæ¨¡å¼åœ¨ <code>references/</code> ä¸­</li>
</ul>
</li>
</ol>
<h2 data-id="heading-70">æ€»ç»“</h2>
<h3 data-id="heading-71">å…³é”®è¦ç‚¹</h3>
<ol>
<li>
<p><strong>Rulesã€Skillsã€MCP ä¸‰è€…èŒè´£åˆ†ç¦»</strong>ï¼š</p>
<ul>
<li>Rulesï¼šé¡¹ç›®çº§åˆ«çš„é™æ€è§„èŒƒ</li>
<li>Skillsï¼šä»»åŠ¡çº§åˆ«çš„åŠ¨æ€èƒ½åŠ›</li>
<li>MCPï¼šå·¥å…·çº§åˆ«çš„è¿æ¥åè®®</li>
</ul>
</li>
<li>
<p><strong>å†™å¥½ Skill çš„æ ¸å¿ƒåŸåˆ™</strong>ï¼š</p>
<ul>
<li>ç®€æ´æ˜¯å…³é”®ï¼ˆè´¨ç–‘æ¯æ¡ä¿¡æ¯çš„å¿…è¦æ€§ï¼‰</li>
<li>è®¾ç½®é€‚å½“çš„è‡ªç”±åº¦ï¼ˆæ ¹æ®ä»»åŠ¡è„†å¼±æ€§ï¼‰</li>
<li>æ¸è¿›å¼æŠ«éœ²ï¼ˆä¸‰çº§åŠ è½½ç³»ç»Ÿï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ ‡å‡†ç›®å½•ç»“æ„</strong>ï¼š</p>
<ul>
<li><code>SKILL.md</code>ï¼ˆå¿…éœ€ï¼‰ï¼šå…ƒæ•°æ® + æ ¸å¿ƒæŒ‡ä»¤</li>
<li><code>scripts/</code>ï¼ˆå¯é€‰ï¼‰ï¼šå¯æ‰§è¡Œä»£ç </li>
<li><code>references/</code>ï¼ˆå¯é€‰ï¼‰ï¼šå‚è€ƒæ–‡æ¡£</li>
<li><code>assets/</code>ï¼ˆå¯é€‰ï¼‰ï¼šè¾“å‡ºèµ„æº</li>
</ul>
</li>
<li>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li>ä¿æŒ <code>SKILL.md</code> ç²¾ç®€ï¼ˆä¸è¶…è¿‡ 500 è¡Œï¼‰</li>
<li>é¿å…é‡å¤ï¼ˆä¿¡æ¯åªå­˜åœ¨ä¸€å¤„ï¼‰</li>
<li>ä½¿ç”¨æ¸è¿›å¼æŠ«éœ²ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰</li>
<li>ä¼˜å…ˆä½¿ç”¨ç¤ºä¾‹è€Œä¸æ˜¯å†—é•¿è§£é‡Š</li>
</ul>
</li>
</ol>
<h3 data-id="heading-72">å‚è€ƒèµ„æ–™</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.claude.com%2Fdocs%2Fen%2Fagent-skills" target="_blank" title="https://platform.claude.com/docs/en/agent-skills" ref="nofollow noopener noreferrer">Anthropic Agent Skills å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fanthropics%2Fskills" target="_blank" title="https://github.com/anthropics/skills" ref="nofollow noopener noreferrer">Anthropic Skills GitHub ä»“åº“</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fagent.jd.com%2Fteam%2Fprivate%2Fskill" target="_blank" title="https://agent.jd.com/team/private/skill" ref="nofollow noopener noreferrer">JoyAgent Skills</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fskillsmp.com%2Fzh" target="_blank" title="https://skillsmp.com/zh" ref="nofollow noopener noreferrer">Skills å¸‚åœº</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FLeastBit%2FClaude_skills_zh-CN%2Fblob%2Fmain%2Fskills%2Fskill-creator%2FSKILL.md" target="_blank" title="https://github.com/LeastBit/Claude_skills_zh-CN/blob/main/skills/skill-creator/SKILL.md" ref="nofollow noopener noreferrer">skill-creator</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é‡Œç¨‹ç¢‘äº”ï¼šElpisæ¡†æ¶npmåŒ…æŠ½è±¡å°è£…å¹¶å‘å¸ƒ]]></title>    <link>https://juejin.cn/post/7601076976439935016</link>    <guid>https://juejin.cn/post/7601076976439935016</guid>    <pubDate>2026-01-31T13:30:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601076976439935016" data-draft-id="7601076976439918632" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é‡Œç¨‹ç¢‘äº”ï¼šElpisæ¡†æ¶npmåŒ…æŠ½è±¡å°è£…å¹¶å‘å¸ƒ"/> <meta itemprop="keywords" content="å…¨æ ˆ,å‰ç«¯æ¡†æ¶"/> <meta itemprop="datePublished" content="2026-01-31T13:30:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ•æ¢¦126"/> <meta itemprop="url" content="https://juejin.cn/user/3428750694822667"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é‡Œç¨‹ç¢‘äº”ï¼šElpisæ¡†æ¶npmåŒ…æŠ½è±¡å°è£…å¹¶å‘å¸ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3428750694822667/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ•æ¢¦126
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T13:30:31.000Z" title="Sat Jan 31 2026 13:30:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    7
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡æ˜¯ã€Šå¤§å‰ç«¯å…¨æ ˆå®è·µã€‹å­¦ä¹ å®è·µçš„æ€»ç»“ï¼Œå‚è€ƒè‡ªæŠ–éŸ³"å“²ç„å‰ç«¯"è€å¸ˆçš„è¯¾ç¨‹å†…å®¹ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œäº†æ·±åº¦æ€è€ƒä¸å®è·µã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯ä¸ç›®æ ‡</h2>
<p>åœ¨å®Œæˆäº†å‰å››ä¸ªé‡Œç¨‹ç¢‘çš„å¼€å‘åï¼Œæˆ‘ä»¬çš„é¡¹ç›®å·²ç»å…·å¤‡äº†å®Œæ•´çš„åç«¯æœåŠ¡ï¼ˆKoaï¼‰ã€ä»¥åŠåŸºäºVue3çš„åŠ¨æ€ç»„ä»¶åº“å‰ç«¯ã€‚ç„¶è€Œï¼Œéšç€åŠŸèƒ½æ¨¡å—çš„å¢åŠ ï¼Œæ•´ä¸ªé¡¹ç›®çš„ä»£ç ç»“æ„å¼€å§‹å˜å¾—è‡ƒè‚¿ã€‚ä¸šåŠ¡é€»è¾‘ä¸åº•å±‚æ¶æ„ä»£ç æ··æ‚åœ¨ä¸€èµ·ï¼Œå¯¼è‡´æ ¸å¿ƒæ¶æ„éš¾ä»¥å¤ç”¨ï¼Œæ–°é¡¹ç›®çš„å¯åŠ¨æˆæœ¬ä¹Ÿè¶Šæ¥è¶Šé«˜ã€‚</p>
<p>é‡Œç¨‹ç¢‘äº”çš„æ ¸å¿ƒç›®æ ‡æ˜¯ <strong>"æ¶æ„ä¸ä¸šåŠ¡åˆ†ç¦»"</strong>ã€‚</p>
<p>å¦‚æœä¸è¿›è¡ŒæŠ½è±¡ï¼Œæ¯æ¬¡æ–°å»ºé¡¹ç›®éƒ½éœ€è¦æ‹·è´é€šè¿‡ä¸€å¤§å †åŸºç¡€ä»£ç ã€‚é€šè¿‡å°†åº•å±‚çš„é€šç”¨èƒ½åŠ›ï¼ˆè·¯ç”±åŠ è½½ã€ä¸­é—´ä»¶ç®¡ç†ã€æ§åˆ¶å™¨è£…è½½ç­‰ï¼‰å°è£…ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ npm åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ï¼š</p>
<ul>
<li><strong>æ¡†æ¶å¤ç”¨</strong>ï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„ä½¿ç”¨ã€‚</li>
<li><strong>ä¸šåŠ¡èšç„¦</strong>ï¼šå¼€å‘è€…åªéœ€å…³æ³¨ <code>app</code> ç›®å½•ä¸‹çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ— éœ€å…³å¿ƒåº•å±‚å¯åŠ¨æµç¨‹ã€‚</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šæ¡†æ¶çš„æ›´æ–°ä¸ç»´æŠ¤ç‹¬ç«‹äºå…·ä½“ä¸šåŠ¡é¡¹ç›®ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-1">äºŒã€æ¶æ„è®¾è®¡ï¼šä»å•ä½“åˆ°åˆ†å±‚</h2>
<p>æˆ‘ä»¬å°†é¡¹ç›®æ‹†è§£ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li><strong>æ¡†æ¶å±‚ (@aikun4588/elpis)</strong>ï¼šè´Ÿè´£åº•å±‚é©±åŠ¨ï¼ŒåŒ…æ‹¬ Koa å®ä¾‹åˆ›å»ºã€ç¯å¢ƒè¯†åˆ«ã€è‡ªåŠ¨åŠ è½½å™¨ï¼ˆLoaderï¼‰ç­‰ã€‚</li>
<li><strong>ä¸šåŠ¡å±‚ (User Project)</strong>ï¼šè´Ÿè´£å…·ä½“ä¸šåŠ¡ï¼Œéµå¾ªæ¡†æ¶çº¦å®šçš„ç›®å½•ç»“æ„ç¼–å†™ Controllerã€Service å’Œ Configã€‚</li>
</ol>
<h3 data-id="heading-2">ç›®å½•ç»“æ„çº¦å®šï¼ˆConvention over Configurationï¼‰</h3>
<p>æ¡†æ¶é‡‡ç”¨äº†<strong>çº¦å®šä¼˜äºé…ç½®</strong>çš„è®¾è®¡ç†å¿µã€‚åªè¦ä¸šåŠ¡å±‚æŒ‰ç…§ä»¥ä¸‹ç»“æ„ç»„ç»‡ä»£ç ï¼Œæ¡†æ¶å°±èƒ½è‡ªåŠ¨è¯†åˆ«å¹¶åŠ è½½ï¼š</p>
<pre><code class="hljs language-text" lang="text">Project/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ controller/      # ä¸šåŠ¡é€»è¾‘æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ service/         # ä¸šåŠ¡é€»è¾‘æœåŠ¡å±‚
â”‚   â”œâ”€â”€ middleware/      # ä¸šåŠ¡ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ router/          # è·¯ç”±å®šä¹‰
â”‚   â””â”€â”€ router-schema/   # å‚æ•°æ ¡éªŒSchema
â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.default.js
â”‚   â””â”€â”€ config.local.js
â”œâ”€â”€ index.js             # å…¥å£æ–‡ä»¶
â””â”€â”€ package.json
</code></pre>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€æ ¸å¿ƒå®ç°åŸç†ï¼šLoaderæœºåˆ¶</h2>
<p>æ¡†æ¶çš„æ ¸å¿ƒåœ¨äº<strong>Loaderï¼ˆåŠ è½½å™¨ï¼‰</strong>ã€‚å®ƒåˆ©ç”¨ Node.js çš„æ¨¡å—ç³»ç»Ÿå’Œæ–‡ä»¶ç³»ç»Ÿèƒ½åŠ›ï¼ˆå¦‚ <code>glob</code>ï¼‰ï¼Œè‡ªåŠ¨æ‰«ææŒ‡å®šç›®å½•å¹¶æŒ‚è½½åˆ° <code>app</code> å®ä¾‹ä¸Šã€‚</p>
<h3 data-id="heading-4">3.1 ç»Ÿä¸€å…¥å£ä¸å¯åŠ¨</h3>
<p>åœ¨ <code>elpis-core/index.js</code> ä¸­ï¼Œæˆ‘ä»¬å¯¼å‡ºä¸€ä¸ª <code>start</code> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æŒ‰é¡ºåºæ‰§è¡Œå„ä¸ª Loaderï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// elpis-core/index.js</span>
<span class="hljs-title function_">start</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Koa</span>();
    <span class="hljs-comment">// ç¡®å®šä¸šåŠ¡ä»£ç æ ¹è·¯å¾„</span>
    app.<span class="hljs-property">businessPath</span> = path.<span class="hljs-title function_">resolve</span>(process.<span class="hljs-title function_">cwd</span>(), <span class="hljs-string">'./app'</span>);
    
    <span class="hljs-comment">// æŒ‰é¡ºåºåŠ è½½æ ¸å¿ƒæ¨¡å—</span>
    app.<span class="hljs-property">env</span> = <span class="hljs-title function_">env</span>();                    <span class="hljs-comment">// ç¯å¢ƒè¯†åˆ«</span>
    <span class="hljs-title function_">middlewareLoader</span>(app);              <span class="hljs-comment">// ä¸­é—´ä»¶åŠ è½½</span>
    <span class="hljs-title function_">routerSchemaLoader</span>(app);            <span class="hljs-comment">// å‚æ•°æ ¡éªŒåŠ è½½</span>
    <span class="hljs-title function_">controllerLoader</span>(app);              <span class="hljs-comment">// æ§åˆ¶å™¨åŠ è½½</span>
    <span class="hljs-title function_">serviceLoader</span>(app);                 <span class="hljs-comment">// æœåŠ¡å±‚åŠ è½½</span>
    <span class="hljs-title function_">configLoader</span>(app);                  <span class="hljs-comment">// é…ç½®åŠ è½½</span>
    
    <span class="hljs-comment">// ...æœ€åå¯åŠ¨ç›‘å¬</span>
    app.<span class="hljs-title function_">listen</span>(port);
}
</code></pre>
<h3 data-id="heading-5">3.2 æ™ºèƒ½æ§åˆ¶å™¨åŠ è½½ï¼ˆController Loaderï¼‰</h3>
<p><code>controllerLoader</code> è´Ÿè´£æ‰«æ <code>app/controller</code> ä¸‹çš„æ‰€æœ‰è„šæœ¬ï¼Œå¹¶æ ¹æ®æ–‡ä»¶è·¯å¾„è‡ªåŠ¨è½¬æ¢å‘½åï¼ˆå¦‚ <code>user-info.js</code> -&gt; <code>userInfo</code>ï¼‰ï¼Œæœ€ç»ˆæŒ‚è½½åˆ° <code>app.controller</code> ä¸Šã€‚</p>
<p>è¿™ç§è®¾è®¡ä½¿å¾—æˆ‘ä»¬åœ¨è·¯ç”±å®šä¹‰æ—¶ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ <code>app.controller.home.index</code> æ¥å¼•ç”¨ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨ requireã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// loader/controller.js æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">app</span>) =&gt;</span> {
    <span class="hljs-comment">// æ‰«æ app/controller ä¸‹æ‰€æœ‰ js æ–‡ä»¶</span>
    <span class="hljs-keyword">const</span> fileList = glob.<span class="hljs-title function_">sync</span>(path.<span class="hljs-title function_">resolve</span>(app.<span class="hljs-property">businessPath</span>, <span class="hljs-string">'./controller/**/*.js'</span>));
    
    fileList.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">file</span> =&gt;</span> {
        <span class="hljs-comment">// è§£ææ–‡ä»¶åï¼Œè½¬æ¢ä¸ºé©¼å³°å‘½å</span>
        <span class="hljs-comment">// åŠ¨æ€ require å¹¶å®ä¾‹åŒ–</span>
        <span class="hljs-comment">// æŒ‚è½½åˆ° app.controller å¯¹è±¡æ ‘ä¸Š</span>
    });
}
</code></pre>
<h3 data-id="heading-6">3.3 è·¯ç”±ä¸Schemaçš„ç»“åˆ</h3>
<p>é…åˆé‡Œç¨‹ç¢‘å››çš„ç†å¿µï¼Œæˆ‘ä»¬è¿˜å®ç°äº† <code>routerSchemaLoader</code>ã€‚å®ƒè‡ªåŠ¨è¯»å– parameter æ ¡éªŒè§„åˆ™ï¼Œä¸ API æ¥å£è¿›è¡Œç»‘å®šã€‚è¿™ä½“ç°äº†<strong>æ¡†æ¶å±‚</strong>å¯¹<strong>è§„èŒƒ</strong>çš„å¼ºåˆ¶æ€§æ”¯æŒ â€”â€” åœ¨æ¡†æ¶å±‚é¢å°±é›†æˆäº†å‚æ•°æ ¡éªŒèƒ½åŠ›ï¼Œä¸šåŠ¡å¼€å‘åªéœ€å¡«å†™ JSON Schemaã€‚</p>
<hr/>
<h2 data-id="heading-7">å››ã€ç”¨æˆ·è‡ªå®šä¹‰ä¸æ¡†æ¶ç»“åˆ</h2>
<p>æŠ½è±¡åçš„æ¡†æ¶æå¤§åœ°ç®€åŒ–äº†ç”¨æˆ·ç«¯çš„ä½¿ç”¨ã€‚å¼€å‘è€…åªéœ€å®‰è£… npm åŒ…ï¼Œå¹¶åœ¨å…¥å£æ–‡ä»¶ä¸­ç®€å•è°ƒç”¨å³å¯å¯åŠ¨æœåŠ¡ã€‚</p>
<p><strong>å‘å¸ƒåŒ…å</strong>ï¼š<code>@aikun4588/elpis</code>
<strong>NPMåœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2F%40aikun4588%2Felpis" target="_blank" title="https://www.npmjs.com/package/@aikun4588/elpis" ref="nofollow noopener noreferrer">www.npmjs.com/package/@aiâ€¦</a></p>
<h3 data-id="heading-8">ä½¿ç”¨ç¤ºä¾‹</h3>
<p>ç”¨æˆ·é¡¹ç›®çš„ <code>index.js</code> å˜å¾—éå¸¸ç®€æ´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼•å…¥æ ¸å¿ƒæ¡†æ¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ElpisCore</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@aikun4588/elpis'</span>);

<span class="hljs-comment">// è‡ªå®šä¹‰é…ç½®å¹¶å¯åŠ¨</span>
<span class="hljs-title class_">ElpisCore</span>.<span class="hljs-title function_">start</span>({
    <span class="hljs-attr">name</span>: <span class="hljs-string">'MyProject'</span>,
    <span class="hljs-attr">homePage</span>: <span class="hljs-string">'/view/dashboard'</span>
});
</code></pre>
<p>æ¡†æ¶è¿è¡Œæ—¶ï¼Œä¼šä¸»åŠ¨è¯»å–å½“å‰å·¥ä½œç›®å½• (<code>process.cwd()</code>) ä¸‹çš„ <code>app</code> æ–‡ä»¶å¤¹ï¼Œå°†ç”¨æˆ·çš„è‡ªå®šä¹‰ä»£ç æ³¨å…¥åˆ°æ¡†æ¶çš„ç”Ÿå‘½å‘¨æœŸä¸­ã€‚è¿™å°±å®ç°äº†**"æ¡†æ¶ç°æœ‰å†…å®¹ï¼ˆåº•å±‚èƒ½åŠ›ï¼‰"<strong>ä¸</strong>"ç”¨æˆ·è‡ªå®šä¹‰ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰"**çš„å®Œç¾ç»“åˆã€‚</p>
<hr/>
<h2 data-id="heading-9">äº”ã€æµç¨‹å›¾è§£</h2>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    User[ç”¨æˆ·å…¥å£ index.js] --&gt; Framework[Framework Start]
    Framework --&gt; Init[åˆå§‹åŒ– Koa &amp; Env]
    
    subgraph Loaders [è‡ªåŠ¨åŠ è½½å™¨åºåˆ—]
        L1[åŠ è½½ Middleware]
        L2[åŠ è½½ RouterSchema]
        L3[åŠ è½½ Controller]
        L4[åŠ è½½ Service]
        L5[åŠ è½½ Config]
    end
    
    Init --&gt; Loaders
    
    Loaders -- æ‰«æ --&gt; UserCode[ç”¨æˆ·ç›®å½• ./app]
    UserCode -- æ³¨å…¥ --&gt; Context[Appä¸Šä¸‹æ–‡å¯¹è±¡]
    
    Context --&gt; Server[å¯åŠ¨ HTTP æœåŠ¡]
</code></pre>
<hr/>
<h2 data-id="heading-10">å…­ã€æ€»ç»“</h2>
<p>é‡Œç¨‹ç¢‘äº”çš„å®Œæˆï¼Œæ ‡å¿—ç€ Elpis ä»ä¸€ä¸ªå•ä¸€çš„ç»ƒæ‰‹é¡¹ç›®ï¼Œè¿›åŒ–ä¸ºä¸€ä¸ªå¯å¤ç”¨çš„<strong>ä¼ä¸šçº§ Node.js å¼€å‘æ¡†æ¶</strong>ã€‚</p>
<p>é€šè¿‡å°†é€šç”¨é€»è¾‘æŠ½ç¦»ä¸º npm åŒ… (<code>@aikun4588/elpis</code>)ï¼Œæˆ‘ä»¬ä¸ä»…è§£è€¦äº†ä»£ç ï¼Œæ›´é‡è¦çš„æ˜¯ç¡®ç«‹äº†ä¸€å¥—<strong>å¼€å‘è§„èŒƒ</strong>ã€‚æœªæ¥çš„å¾®æœåŠ¡æˆ–æ–°åŠŸèƒ½æ¨¡å—ï¼Œéƒ½å¯ä»¥åŸºäºæ­¤æ¡†æ¶å¿«é€Ÿæ„å»ºï¼ŒçœŸæ­£å®ç°äº†"æè´¨å¢æ•ˆ"ã€‚</p>
<p>è¿™ä¸€æ­¥æŠ½è±¡ï¼Œæ˜¯å…¨æ ˆå·¥ç¨‹å¸ˆå‘æ¶æ„å¸ˆæ€ç»´è½¬å˜çš„å…³é”®ä¸€æ­¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨ç»„ä»¶è¿›é˜¶ï¼šä¸å®šé«˜åº¦åŠåŸç†åˆ†æï¼ï¼ï¼]]></title>    <link>https://juejin.cn/post/7601077764424515634</link>    <guid>https://juejin.cn/post/7601077764424515634</guid>    <pubDate>2026-01-31T13:58:10.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601077764424515634" data-draft-id="7601077764424499250" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨ç»„ä»¶è¿›é˜¶ï¼šä¸å®šé«˜åº¦åŠåŸç†åˆ†æï¼ï¼ï¼"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-31T13:58:10.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ä¹‹ç™¾ç‚¼æˆé­”"/> <meta itemprop="url" content="https://juejin.cn/user/1486957885265400"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3è™šæ‹Ÿæ»šåŠ¨åˆ—è¡¨ç»„ä»¶è¿›é˜¶ï¼šä¸å®šé«˜åº¦åŠåŸç†åˆ†æï¼ï¼ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1486957885265400/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ä¹‹ç™¾ç‚¼æˆé­”
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T13:58:10.000Z" title="Sat Jan 31 2026 13:58:10 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯ï¼š</p>
<blockquote>
<p>åç«¯ä¸€æ¬¡æ€§è¿”å›äº† 10,000 æ¡èŠå¤©è®°å½•ï¼Œæ¯æ¡è®°å½•çš„å†…å®¹é•¿åº¦éƒ½ä¸ä¸€æ ·ã€‚å½“ä½ è¯•å›¾æŠŠå®ƒä»¬å…¨éƒ¨æ¸²æŸ“åˆ°é¡µé¢ä¸Šæ—¶ï¼Œæµè§ˆå™¨ç¬é—´å¡æ­»ï¼Œç”¨æˆ·ä½“éªŒæå·®ã€‚</p>
</blockquote>
<p>è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦ <strong>è™šæ‹Ÿåˆ—è¡¨ (Virtual List)</strong> çš„æ—¶åˆ»ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ·±å…¥æµ…å‡ºåœ°è®²è§£å¦‚ä½•å®ç°ä¸€ä¸ª<strong>æ”¯æŒä¸å®šé«˜åº¦</strong>çš„è™šæ‹Ÿåˆ—è¡¨ç»„ä»¶ã€‚å“ªæ€•ä½ æ˜¯åˆšå…¥é—¨çš„å‰ç«¯å°ç™½ï¼Œè¯»å®Œè¿™ç¯‡æ–‡ç« ä¹Ÿèƒ½äº²æ‰‹å†™å‡ºæ¥ï¼</p>
<hr/>
<h2 data-id="heading-0">1. æ ¸å¿ƒåŸç†ï¼šåªæ¸²æŸ“ä½ èƒ½çœ‹åˆ°çš„</h2>
<p>æƒ³è±¡ä½ åœ¨çœ‹ä¸€æœ¬ 1000 é¡µçš„ä¹¦ã€‚ä½ è™½ç„¶æ‹¿ç€æ•´æœ¬ä¹¦ï¼Œä½†ä½ çš„çœ¼ç›åŒä¸€æ—¶é—´åªèƒ½çœ‹åˆ°å±•å¼€çš„é‚£ä¸¤é¡µã€‚</p>
<p>è™šæ‹Ÿåˆ—è¡¨ä¹Ÿæ˜¯è¿™ä¸ªé“ç†ï¼š<strong>æ— è®ºæ•°æ®æœ‰å¤šå°‘æ¡ï¼Œæˆ‘ä»¬åªæ¸²æŸ“å½“å‰å¯è§†åŒºåŸŸå†…çš„é‚£å‡ æ¡ã€‚</strong></p>
<h3 data-id="heading-1">ä¸¤ä¸ªå…³é”®å®¹å™¨</h3>
<p>è¦å®ç°è¿™ä¸ªæ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦åœ¨ HTML é‡Œæ”¾ä¸¤ä¸ªâ€œç›’å­â€ï¼š</p>
<ol>
<li><strong>å¹½çµå®¹å™¨ (Phantom Container)</strong>ï¼š
<ul>
<li>å®ƒä¸è£…ä»»ä½•å†…å®¹ï¼Œä½†å®ƒçš„é«˜åº¦ç­‰äºæ‰€æœ‰æ•°æ®åŠ è½½å®Œåçš„<strong>æ€»é«˜åº¦</strong>ã€‚</li>
<li>å®ƒçš„ä½œç”¨æ˜¯æ’‘å¼€æµè§ˆå™¨çš„æ»šåŠ¨æ¡ï¼Œè®©ç”¨æˆ·æ„Ÿè§‰è‡ªå·±åœ¨æ»šä¸€ä¸ªå¾ˆé•¿çš„åˆ—è¡¨ã€‚</li>
</ul>
</li>
<li><strong>æ¸²æŸ“åŒºåŸŸ (Content Container)</strong>ï¼š
<ul>
<li>å®ƒçœŸæ­£ç”¨æ¥æ”¾åˆ—è¡¨é¡¹ã€‚</li>
<li>éšç€ä½ çš„æ»šåŠ¨ï¼Œæˆ‘ä»¬ä¼šåŠ¨æ€è®¡ç®—å®ƒçš„ <code>transform: translate3d(...)</code> åç§»é‡ï¼Œè®©å®ƒæ°¸è¿œå‡ºç°åœ¨ä½ çš„çœ¼å‰ã€‚</li>
</ul>
</li>
</ol>
<pre><code class="hljs language-text" lang="text">  +------------------+  &lt;-- æµè§ˆå™¨è§†å£ (Viewport)
  |                  |
  |   +----------+   |  &lt;-- æ¸²æŸ“åŒºåŸŸ (Content Container)
  |   | Item 10  |   |      (é€šè¿‡ transform ç§»åŠ¨åˆ°è¿™é‡Œ)
  |   +----------+   |
  |   | Item 11  |   |
  |   +----------+   |
  |                  |
  +------------------+
          |
          | (æ»šåŠ¨æ¡)
          |
  +------------------+  &lt;-- å¹½çµå®¹å™¨ (Phantom Container)
  |                  |      (é«˜åº¦ = æ‰€æœ‰ Item é«˜åº¦ä¹‹å’Œ)
  |                  |      (è™½ç„¶æ˜¯ç©ºçš„ï¼Œä½†è´Ÿè´£æŠŠæ»šåŠ¨æ¡æ’‘é•¿)
  |                  |
  +------------------+
</code></pre>
<hr/>
<h2 data-id="heading-2">2. å½¢è±¡æ¯”å–»ï¼šç§’æ‡‚è™šæ‹Ÿåˆ—è¡¨</h2>
<p>å•çº¯çœ‹åŸç†å¯èƒ½æœ‰ç‚¹æ¯ç‡¥ï¼Œæˆ‘ä»¬ç”¨ç”µå½±æ”¾æ˜ çš„ä¾‹å­æ¥å¸®ä½ å½»åº•è®°ä½å®ƒã€‚</p>
<h3 data-id="heading-3">ğŸï¸ åœºæ™¯ä¸€ï¼šè€å¼ç”µå½±æ”¾æ˜ æœº (å¯¹åº”æ ¸å¿ƒæœºåˆ¶)</h3>
<p><strong>æƒ³è±¡ä¸€ä¸‹</strong>ï¼šä½ æ­£åœ¨æ”¾æ˜ ä¸€éƒ¨é•¿è¾¾ 3 å°æ—¶çš„ç”µå½±èƒ¶ç‰‡ã€‚</p>
<ol>
<li><strong>é•¿é•¿çš„èƒ¶ç‰‡å· (Phantom / å¹½çµå®¹å™¨)</strong>ï¼š
æ•´å·èƒ¶ç‰‡å¯èƒ½æœ‰å‡ å…¬é‡Œé•¿ï¼Œè¿™å†³å®šäº†æ”¾æ˜ æœºæ—è¾¹çš„å·ç›˜æœ‰å¤šå¤§ã€‚è¿™å°±æ˜¯<strong>æ»šåŠ¨æ¡</strong>ï¼Œå®ƒè®©ä½ çŸ¥é“ç”µå½±ï¼ˆæ•°æ®ï¼‰çš„æ€»é•¿åº¦ã€‚</li>
<li><strong>å°å°çš„æ”¾æ˜ çª—å£ (Viewport / å¯è§†åŒºåŸŸ)</strong>ï¼š
è™½ç„¶èƒ¶ç‰‡å¾ˆé•¿ï¼Œä½†æ”¾æ˜ æœºä¸€æ¬¡åªèƒ½è®©ä¸€å¼ åº•ç‰‡ç»è¿‡é•œå¤´ã€‚æˆ‘ä»¬ä¸éœ€è¦æŠŠæ•´å·èƒ¶ç‰‡éƒ½æ‘Šåœ¨é“¶å¹•ä¸Šï¼Œåªéœ€è¦ç¡®ä¿<strong>å½“å‰é‚£ä¸€å°æ®µ</strong>åœ¨é•œå¤´å‰ã€‚</li>
<li><strong>å¿«é€Ÿåˆ‡æ¢åº•ç‰‡ (Data Binding &amp; Offset / æ•°æ®ç»‘å®šä¸åç§»)</strong>ï¼š
éšç€ç”µæœºè½¬åŠ¨ï¼Œæ—§çš„ç”»é¢ç§»å‡ºï¼Œæ–°çš„ç”»é¢ç§»å…¥ã€‚å¯¹è§‚ä¼—æ¥è¯´ï¼Œç”»é¢æ˜¯è¿ç»­çš„ï¼›ä½†å¯¹æ”¾æ˜ æœºæ¥è¯´ï¼Œå®ƒæ°¸è¿œåªåœ¨å¤„ç†é•œå¤´å‰çš„é‚£ä¸€ä¸ç‚¹ç©ºé—´ã€‚</li>
</ol>
<h3 data-id="heading-4">ğŸ¬ åœºæ™¯äºŒï¼šé•¿çŸ­ä¸ä¸€çš„â€œç”µå½±ç‰‡æ®µâ€ (å¯¹åº”ä¸å®šé«˜åº¦ä¸ä¿®æ­£)</h3>
<p>å¦‚æœæ¯å¼ åº•ç‰‡çš„é«˜åº¦éƒ½ä¸€æ ·ï¼Œæ”¾æ˜ æœºè½¬é€Ÿå›ºå®šå³å¯ã€‚ä½†å¦‚æœè¿™æ˜¯ä¸€éƒ¨â€œå®éªŒç”µå½±â€ï¼Œæœ‰äº›ç‰‡æ®µæ˜¯æ­£å¸¸çš„ï¼Œæœ‰äº›ç‰‡æ®µç‰¹åˆ«é•¿ï¼ˆæ¯”å¦‚é•¿å·è½´ï¼‰ï¼š</p>
<ol>
<li><strong>ç›²ç›®å¿«è¿› (Estimate / é¢„ä¼°)</strong>ï¼š
ä½ ä»¥ä¸ºæ¯æ®µéƒ½æ˜¯ 10 å˜ç±³ã€‚ä½ æƒ³çœ‹ç¬¬ 10 æ®µï¼Œäºæ˜¯å¿«è¿›äº† 100 å˜ç±³ã€‚</li>
<li><strong>å‘ç°ç”»é¢åäº† (Render / æ¸²æŸ“)</strong>ï¼š
åœä¸‹ä¸€çœ‹ï¼Œå‘ç°å‰é¢çš„ç‰‡æ®µé‡Œæœ‰å¥½å‡ ä¸ªæ˜¯â€œè¶…é•¿ç‰ˆâ€ï¼Œç»“æœä½ ç°åœ¨åœåœ¨äº†ç¬¬ 8 æ®µå’Œç¬¬ 9 æ®µçš„ä¸­é—´ã€‚</li>
<li><strong>æ ¡å‡†ä½ç½® (Correction / ä¿®æ­£)</strong>ï¼š
ä½ ä¸å¾—ä¸é‡ä¸€ä¸‹åˆšæ‰é‚£å‡ æ®µåˆ°åº•æœ‰å¤šé•¿ï¼Œç„¶åæŠŠæ”¾æ˜ æœºçš„ä½ç½®å¾€åæŒªä¸€æŒªï¼Œç¡®ä¿ç¬¬ 10 æ®µèƒ½ç²¾å‡†å¯¹é½é•œå¤´ã€‚</li>
</ol>
<p>è¿™å°±æ˜¯ <code>updatePositions</code> çš„æ„ä¹‰ï¼š<strong>å½“å®é™…å†…å®¹æ¸²æŸ“å‡ºæ¥åï¼Œå‘ç°å®ƒæ¯”é¢„æƒ³çš„è¦é«˜ï¼Œå°±è¦ç«‹åˆ»æŠŠåé¢çš„å†…å®¹å¾€åâ€œé¡¶â€å¼€ï¼Œå¹¶ä¿®æ­£æ»šåŠ¨æ¡ä½ç½®ã€‚</strong></p>
<hr/>
<h2 data-id="heading-5">3. å®ç°æ­¥éª¤ï¼šä» 0 åˆ° 1</h2>
<p>æˆ‘ä»¬å°†æŒ‰ç…§ä»¥ä¸‹æµç¨‹æ¥å®ç°è¿™ä¸ªç»„ä»¶ï¼š</p>
<ol>
<li><strong>åˆå§‹åŒ–</strong>ï¼šå®šä¹‰ <code>positions</code> æ•°ç»„ï¼Œé¢„ä¼°æ¯ä¸ªåˆ—è¡¨é¡¹çš„é«˜åº¦ï¼Œç”Ÿæˆåˆå§‹ä½ç½®ä¿¡æ¯ã€‚</li>
<li><strong>å¯è§†åŒºè®¡ç®—</strong>ï¼šç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œæ ¹æ® <code>scrollTop</code> è®¡ç®—å‡ºå½“å‰åº”è¯¥æ˜¾ç¤ºå“ªå‡ é¡¹ï¼ˆ<code>startIndex</code> åˆ° <code>endIndex</code>ï¼‰ã€‚</li>
<li><strong>æ¸²æŸ“ä¸åç§»</strong>ï¼šä»æ•°æ®æºä¸­å–å‡ºè¿™å‡ é¡¹è¿›è¡Œæ¸²æŸ“ï¼Œå¹¶è®¾ç½® <code>transform</code> åç§»é‡ï¼Œè®©å®ƒä»¬æ˜¾ç¤ºåœ¨å±å¹•æ­£ç¡®çš„ä½ç½®ã€‚</li>
<li><strong>åŠ¨æ€ä¿®æ­£</strong>ï¼šDOM æ¸²æŸ“å®Œæˆåï¼Œè·å–æ¯ä¸€é¡¹çš„çœŸå®é«˜åº¦ã€‚å¦‚æœçœŸå®é«˜åº¦ä¸é¢„ä¼°ä¸ç¬¦ï¼Œæ›´æ–° <code>positions</code> æ•°ç»„ï¼Œå¹¶è°ƒæ•´åç»­æ‰€æœ‰é¡¹çš„ä½ç½®ã€‚</li>
</ol>
<pre><code class="hljs language-text" lang="text">        [ ğŸš€ å¼€å§‹ ]
             â”‚
             â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   1. åˆå§‹åŒ–æ•°æ® (Init)    â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ ğŸ”‘ ç”Ÿæˆ positions æ•°ç»„    â”‚
  â”‚ ğŸ”‘ è®¾å®šé¢„ä¼°é«˜åº¦           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” &lt;â”€â”€â”€â”€â”€â”
  â”‚   2. ç›‘å¬äº‹ä»¶ (Listen)    â”‚       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
  â”‚ ğŸ”‘ scroll äº‹ä»¶ (æ»šåŠ¨)     â”‚       â”‚
  â”‚ ğŸ”‘ ResizeObserver (è§†å£)  â”‚       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
             â”‚                        â”‚
             â–¼                        â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
  â”‚   3. æ¸²æŸ“è§†å›¾ (Render)    â”‚       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
  â”‚ ğŸ”‘ æˆªå– visibleData       â”‚       â”‚
  â”‚ ğŸ”‘ è®¾ç½® translate3d åç§»  â”‚       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
             â”‚                        â”‚
             â–¼                        â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
  â”‚   4. åŠ¨æ€ä¿®æ­£ (Correct)   â”‚       â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
  â”‚ ğŸ”‘ æµ‹é‡çœŸå® DOM é«˜åº¦      â”‚       â”‚
  â”‚ ğŸ”‘ æ›´æ–° positions æ•°ç»„    â”‚ â”€â”€â”€â”€â”€â”€â”˜
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ef513af32e74605ad870f5959ce4cfe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL55m-54K85oiQ6a2U:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770477061&amp;x-signature=9DYY73YJ4V71tdl7Z2TC%2FsZdGm0%3D" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-6">ğŸ” æ ¸å¿ƒé€»è¾‘æ‹†è§£</h3>
<p>ä¸ºäº†è®©è¿™ä¸ªé—­ç¯é«˜æ•ˆè¿è½¬ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†å¥½ä¸‰ä¸ªå…³é”®è¡Œä¸ºä¸äº‹ä»¶çš„å…³è”ï¼š</p>
<ol>
<li><strong>åˆå§‹åŒ–ä¸é¢„ä¼° (Init &amp; Estimate)</strong>ï¼š
<ul>
<li><strong>è§¦å‘</strong>ï¼šç»„ä»¶åŠ è½½æ—¶ã€‚</li>
<li><strong>é€»è¾‘</strong>ï¼šç”±äºæ— æ³•æå‰é¢„çŸ¥çœŸå®é«˜åº¦ï¼Œæˆ‘ä»¬å…ˆç»™æ¯ä¸€é¡¹â€œç”»å¤§é¥¼ï¼ˆé¢„ä¼°é«˜åº¦ï¼‰â€ï¼Œç”Ÿæˆåˆå§‹çš„ <code>positions</code> åæ ‡ç³»ã€‚</li>
</ul>
</li>
<li><strong>æ»šåŠ¨å®šä½ (Scroll &amp; Locate)</strong>ï¼š
<ul>
<li><strong>è§¦å‘</strong>ï¼šç”¨æˆ·æ‹–åŠ¨æ»šåŠ¨æ¡ï¼ˆ<code>scroll</code> äº‹ä»¶ï¼‰ã€‚</li>
<li><strong>é€»è¾‘</strong>ï¼šåˆ©ç”¨<strong>äºŒåˆ†æŸ¥æ‰¾</strong>åœ¨ <code>positions</code> ä¸­å¿«é€Ÿé”å®šå½“å‰ <code>scrollTop</code> å¯¹åº”çš„ <code>startIndex</code>ã€‚éšåé€šè¿‡ <code>translate3d</code> å°†å®¹å™¨åç§»åˆ°å¯è§†åŒºã€‚</li>
</ul>
</li>
<li><strong>åŠ¨æ€æµ‹é‡ä¸ä¿®æ­£ (Measure &amp; Correct)</strong>ï¼š
<ul>
<li><strong>è§¦å‘</strong>ï¼šæ•°æ®æ¸²æŸ“åˆ° DOM åï¼ˆ<code>onUpdated</code>ï¼‰æˆ–è§†å£å¤§å°æ”¹å˜ï¼ˆ<code>ResizeObserver</code>ï¼‰ã€‚</li>
<li><strong>é€»è¾‘</strong>ï¼šè·å–çœŸå® DOM é«˜åº¦ã€‚å¦‚æœå‘ç°ç¬¬ N é¡¹é«˜äº† 20pxï¼Œå°±ä¿®æ­£è¯¥é¡¹å¹¶è®© N ä¹‹åçš„æ‰€æœ‰é¡¹åæ ‡â€œé›†ä½“ä¸‹ç§»â€ 20pxï¼Œç¡®ä¿å­˜å‚¨çš„ä½ç½®ä¿¡æ¯ä¸å®é™…å®Œç¾å¯¹é½ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6603e9edfd414a6da57441c0c90a641d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5LmL55m-54K85oiQ6a2U:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770477061&amp;x-signature=G%2FWasFvE5rmG7So9rmPEQ6HKXPM%3D" alt="è¯·æ·»åŠ å›¾ç‰‡æè¿°" loading="lazy"/></li>
</ul>
</li>
</ol>
<h3 data-id="heading-7">âš ï¸ å…³äº ResizeObserver çš„è¯¯åŒº</h3>
<p>å¾ˆå¤šåŒå­¦å¯èƒ½ä¼šç–‘æƒ‘ï¼š<strong>â€œåˆ—è¡¨æ»šåŠ¨æˆ–æ•°æ®æ›´æ–°æ—¶ï¼ŒResizeObserver ä¼šè§¦å‘å—ï¼Ÿâ€</strong></p>
<p>ç­”æ¡ˆæ˜¯ï¼š<strong>ä¸ä¼š</strong>ã€‚</p>
<p><code>ResizeObserver</code> ä¸“é—¨ç”¨äºç›‘å¬<strong>å…ƒç´ å®¹å™¨æœ¬èº«ï¼ˆå¤–å±‚ç›’å­ï¼‰çš„ç‰©ç†å°ºå¯¸å˜åŒ–</strong>ã€‚</p>






























<table><thead><tr><th align="left">åœºæ™¯</th><th align="left">ResizeObserver è§¦å‘ï¼Ÿ</th><th align="left">åº”è¯¥ç”±è°å¤„ç†ï¼Ÿ</th></tr></thead><tbody><tr><td align="left"><strong>ç”¨æˆ·æ»šåŠ¨åˆ—è¡¨</strong></td><td align="left">âŒ ä¸è§¦å‘</td><td align="left"><code>@scroll</code> äº‹ä»¶ç›‘å¬</td></tr><tr><td align="left"><strong>åç«¯è¿”å›æ–°æ•°æ®</strong></td><td align="left">âŒ ä¸è§¦å‘</td><td align="left"><code>watch(() =&gt; props.data)</code></td></tr><tr><td align="left"><strong>æµè§ˆå™¨çª—å£ç¼©æ”¾</strong></td><td align="left">âœ… <strong>è§¦å‘</strong></td><td align="left"><strong>ResizeObserver</strong></td></tr><tr><td align="left"><strong>ä¾§è¾¹æ æŠ˜å /å±•å¼€</strong></td><td align="left">âœ… <strong>è§¦å‘</strong></td><td align="left"><strong>ResizeObserver</strong></td></tr></tbody></table>
<h2 data-id="heading-8"><strong>å®ƒçš„æ ¸å¿ƒä½¿å‘½</strong>ï¼šå½“è§†å£ï¼ˆç›’å­ï¼‰å˜å¤§å˜å°æ—¶ï¼Œå‘Šè¯‰ç»„ä»¶â€œç°åœ¨ä¸€å±èƒ½å¤šå¡å‡ æ¡æ•°æ®äº†â€ï¼Œä»è€Œé¿å…åº•éƒ¨å‡ºç°ç•™ç™½ã€‚
ç®€å•æ€»ç»“ï¼šå°±åƒç”µå½±æ”¾æ˜ æœºåˆšæ‘†å¥½çš„æ—¶å€™ï¼Œå…ˆé‡ä¸€ä¸‹é“¶å¹•æœ‰å¤šå¤§ï¼Œç„¶åè°ƒæ•´å¥½é•œå¤´ç„¦è·ï¼Œå¹¶å®‰æ’ä¸€ä¸ªäººç›¯ç€ï¼Œä¸‡ä¸€é“¶å¹•å˜å¤§äº†å°±èµ¶ç´§è°ƒæ•´ç”»é¢ã€‚</h2>
<h2 data-id="heading-9">4. ä»£ç å®æˆ˜ï¼šä¸€æ­¥æ­¥å®ç°</h2>
<pre><code class="hljs language-javascript" lang="javascript">&lt;script setup lang=<span class="hljs-string">"ts"</span>&gt;
<span class="hljs-keyword">import</span> type { <span class="hljs-title class_">PropType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { useNamespace } <span class="hljs-keyword">from</span> <span class="hljs-string">'@my-antd-ui/utils'</span>
<span class="hljs-keyword">import</span> {
  computed,
  nextTick,
  onMounted,
  onUnmounted,
  onUpdated,
  reactive,
  ref,
  watch,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-title function_">defineOptions</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'MyVirtualList'</span>,
})

<span class="hljs-keyword">const</span> props = <span class="hljs-title function_">defineProps</span>({
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Array</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">PropType</span>&lt;any[]&gt;,
    <span class="hljs-attr">default</span>: <span class="hljs-function">() =&gt;</span> [],
  },
  <span class="hljs-attr">itemHeight</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">50</span>,
  },
  <span class="hljs-attr">estimatedItemHeight</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-number">50</span>,
  },
  <span class="hljs-attr">height</span>: {
    <span class="hljs-attr">type</span>: [<span class="hljs-title class_">Number</span>, <span class="hljs-title class_">String</span>],
    <span class="hljs-attr">default</span>: <span class="hljs-string">'100%'</span>,
  },
})

<span class="hljs-keyword">const</span> ns = <span class="hljs-title function_">useNamespace</span>(<span class="hljs-string">'virtual-list'</span>)
<span class="hljs-keyword">const</span> rootRef = ref&lt;<span class="hljs-title class_">HTMLElement</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>)
<span class="hljs-keyword">const</span> itemsRef = ref&lt;<span class="hljs-title class_">HTMLElement</span>[] | <span class="hljs-literal">null</span>&gt;([])

interface <span class="hljs-title class_">Position</span> {
  <span class="hljs-attr">index</span>: number
  <span class="hljs-attr">top</span>: number
  <span class="hljs-attr">bottom</span>: number
  <span class="hljs-attr">height</span>: number
  <span class="hljs-attr">dHeight</span>: number <span class="hljs-comment">// æ›´æ–°åçš„é«˜åº¦å·®</span>
}

<span class="hljs-keyword">const</span> positions = ref&lt;<span class="hljs-title class_">Position</span>[]&gt;([])

<span class="hljs-keyword">const</span> state = <span class="hljs-title function_">reactive</span>({
  <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">end</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">scrollTop</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">containerHeight</span>: <span class="hljs-number">0</span>,
})

<span class="hljs-comment">// åŸºäºé¢„ä¼°é«˜åº¦åˆå§‹åŒ–ä½ç½®ä¿¡æ¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">initPositions</span>(<span class="hljs-params"/>) {
  positions.<span class="hljs-property">value</span> = props.<span class="hljs-property">data</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> ({
    index,
    <span class="hljs-attr">height</span>: props.<span class="hljs-property">estimatedItemHeight</span>,
    <span class="hljs-attr">top</span>: index * props.<span class="hljs-property">estimatedItemHeight</span>,
    <span class="hljs-attr">bottom</span>: (index + <span class="hljs-number">1</span>) * props.<span class="hljs-property">estimatedItemHeight</span>,
    <span class="hljs-attr">dHeight</span>: <span class="hljs-number">0</span>,
  }))
}

<span class="hljs-title function_">watch</span>(<span class="hljs-function">() =&gt;</span> props.<span class="hljs-property">data</span>, initPositions, { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> })

<span class="hljs-comment">// 1. åˆ—è¡¨æ€»é«˜åº¦ç­‰äºæœ€åä¸€ä¸ªå…ƒç´ çš„åº•éƒ¨ä½ç½®</span>
<span class="hljs-keyword">const</span> listHeight = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> positions.<span class="hljs-property">value</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>
    ? positions.<span class="hljs-property">value</span>[positions.<span class="hljs-property">value</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>].<span class="hljs-property">bottom</span>
    : <span class="hljs-number">0</span>
})

<span class="hljs-comment">// 2. å¯è§†åŒºåŸŸå†…çš„åˆ—è¡¨é¡¹æ•°é‡ï¼ˆé€»è¾‘ä¸Šéå¿…éœ€ï¼Œä½†æœ‰åŠ©äºåˆå§‹ä¼°ç®—ï¼‰</span>
<span class="hljs-keyword">const</span> visibleCount = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>(state.<span class="hljs-property">containerHeight</span> / props.<span class="hljs-property">estimatedItemHeight</span>)
})

<span class="hljs-comment">// 3. å½“å‰å¯è§†åŒºåŸŸçš„æ•°æ®</span>
<span class="hljs-keyword">const</span> visibleData = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> props.<span class="hljs-property">data</span>
    .<span class="hljs-title function_">slice</span>(state.<span class="hljs-property">start</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(state.<span class="hljs-property">end</span>, props.<span class="hljs-property">data</span>.<span class="hljs-property">length</span>))
    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> ({
      ...item,
      <span class="hljs-attr">index</span>: state.<span class="hljs-property">start</span> + index,
    }))
})

<span class="hljs-comment">// 4. åç§»é‡</span>
<span class="hljs-keyword">const</span> offset = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (state.<span class="hljs-property">start</span> &gt;= <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">return</span> positions.<span class="hljs-property">value</span>[state.<span class="hljs-property">start</span>].<span class="hljs-property">top</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
})

<span class="hljs-comment">// ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°ç¬¬ä¸€ä¸ª bottom &gt; scrollTop çš„åˆ—è¡¨é¡¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getStartIndex</span>(<span class="hljs-params">scrollTop: number = <span class="hljs-number">0</span></span>) {
  <span class="hljs-keyword">let</span> low = <span class="hljs-number">0</span>
  <span class="hljs-keyword">let</span> high = positions.<span class="hljs-property">value</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
  <span class="hljs-keyword">let</span> res = -<span class="hljs-number">1</span>

  <span class="hljs-keyword">while</span> (low &lt;= high) {
    <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((low + high) / <span class="hljs-number">2</span>)
    <span class="hljs-keyword">const</span> pos = positions.<span class="hljs-property">value</span>[mid]

    <span class="hljs-keyword">if</span> (pos.<span class="hljs-property">bottom</span> &gt; scrollTop) {
      <span class="hljs-keyword">if</span> (pos.<span class="hljs-property">top</span> &lt; scrollTop) {
        <span class="hljs-comment">// è¯¥åˆ—è¡¨é¡¹è·¨è¶Šäº†é¡¶éƒ¨è¾¹ç•Œ</span>
        res = mid
        <span class="hljs-keyword">break</span>
      }
      <span class="hljs-comment">// è¯¥åˆ—è¡¨é¡¹å®Œå…¨åœ¨ scrollTop ä¹‹ä¸‹ï¼Œå°è¯•æŸ¥æ‰¾æ›´æ—©çš„é¡¹</span>
      res = mid <span class="hljs-comment">// å€™é€‰é¡¹ï¼Œä½†å¯èƒ½è¿˜æœ‰æ›´æ—©çš„ï¼Ÿ</span>
      high = mid - <span class="hljs-number">1</span>
    }
    <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// è¯¥åˆ—è¡¨é¡¹å®Œå…¨åœ¨ scrollTop ä¹‹ä¸Š</span>
      low = mid + <span class="hljs-number">1</span>
    }
  }
  <span class="hljs-keyword">return</span> res === -<span class="hljs-number">1</span> ? <span class="hljs-number">0</span> : res
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateVisibleRange</span>(<span class="hljs-params"/>) {
  state.<span class="hljs-property">start</span> = <span class="hljs-title function_">getStartIndex</span>(state.<span class="hljs-property">scrollTop</span>)
  state.<span class="hljs-property">end</span> = state.<span class="hljs-property">start</span> + visibleCount.<span class="hljs-property">value</span> + <span class="hljs-number">2</span> <span class="hljs-comment">// æ¸²æŸ“é¢å¤–çš„ç¼“å†²åŒºä»¥å¢åŠ å¹³æ»‘åº¦</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">onScroll</span>(<span class="hljs-params">e: Event</span>) {
  state.<span class="hljs-property">scrollTop</span> = (e.<span class="hljs-property">target</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>).<span class="hljs-property">scrollTop</span>
  <span class="hljs-title function_">updateVisibleRange</span>()
}

<span class="hljs-comment">// æ¸²æŸ“åæµ‹é‡å¹¶æ›´æ–°ä½ç½®ä¿¡æ¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">updatePositions</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> nodes = itemsRef.<span class="hljs-property">value</span>
  <span class="hljs-keyword">if</span> (!nodes || nodes.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>)
    <span class="hljs-keyword">return</span>

  nodes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">node</span>) =&gt;</span> {
    <span class="hljs-comment">// ä» dataset è·å–ç´¢å¼•ï¼ˆéœ€è¦åœ¨æ¨¡æ¿ä¸­ç»‘å®šï¼‰</span>
    <span class="hljs-comment">// æˆ–è€…å‡è®¾é¡ºåºä¸ visibleData ä¸€è‡´</span>
    <span class="hljs-comment">// ä¸ºäº†å®‰å…¨èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨ getAttribute è·å–ç»‘å®šçš„å±æ€§</span>
    <span class="hljs-keyword">const</span> indexStr = node.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-index'</span>)
    <span class="hljs-keyword">if</span> (!indexStr)
      <span class="hljs-keyword">return</span>
    <span class="hljs-keyword">const</span> index = <span class="hljs-title class_">Number</span>.<span class="hljs-built_in">parseInt</span>(indexStr)

    <span class="hljs-keyword">const</span> rect = node.<span class="hljs-title function_">getBoundingClientRect</span>()
    <span class="hljs-keyword">const</span> height = rect.<span class="hljs-property">height</span>
    <span class="hljs-keyword">const</span> oldHeight = positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">height</span>
    <span class="hljs-keyword">const</span> dHeight = height - oldHeight

    <span class="hljs-keyword">if</span> (dHeight) {
      positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">height</span> = height
      positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">bottom</span> = positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">bottom</span> + dHeight
      positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">dHeight</span> = dHeight
    }
  })

  <span class="hljs-comment">// ç´¯ç§¯æ›´æ–°åç»­é¡¹çš„ä½ç½®ä¿¡æ¯</span>
  <span class="hljs-comment">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‘ç”Ÿå˜åŒ–çš„ç´¢å¼•</span>
  <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„ O(N) æ›´æ–°ã€‚å¯¹äºæµ·é‡åˆ—è¡¨å¯èƒ½éœ€è¦ä¼˜åŒ–ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹æ€§èƒ½å¯ä»¥æ¥å—ã€‚</span>
  <span class="hljs-comment">// å®é™…ä¸Šï¼Œæˆ‘ä»¬åº”è¯¥ä»å‘ç”Ÿå˜åŒ–çš„èµ·å§‹ç´¢å¼•å¼€å§‹æ›´æ–°ã€‚</span>
  <span class="hljs-comment">// ä½†è¿™é‡Œæˆ‘ä»¬æ˜¯åœ¨éå†å¯è§†èŠ‚ç‚¹ã€‚</span>
  <span class="hljs-keyword">const</span> startUpdateIndex = <span class="hljs-title class_">Number</span>.<span class="hljs-built_in">parseInt</span>(nodes[<span class="hljs-number">0</span>].<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-index'</span>) || <span class="hljs-string">'0'</span>)
  <span class="hljs-keyword">const</span> len = positions.<span class="hljs-property">value</span>.<span class="hljs-property">length</span>

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startUpdateIndex; i &lt; len; i++) {
    <span class="hljs-keyword">const</span> item = positions.<span class="hljs-property">value</span>[i]
    <span class="hljs-comment">// å¦‚æœå®ƒæ˜¯æˆ‘ä»¬åˆšæ‰æµ‹é‡è¿‡çš„é¡¹ï¼Œå®ƒå¯èƒ½å·²ç»æœ‰äº†è‡ªå·±çš„ dHeight</span>
    <span class="hljs-comment">// ä½†æˆ‘ä»¬ä¹Ÿéœ€è¦å‘å‰ä¼ é€’ä¹‹å‰ç´¯ç§¯çš„å·®å¼‚ã€‚</span>
    <span class="hljs-comment">// ç­‰ç­‰ï¼Œä¸Šé¢çš„é€»è¾‘åªæ›´æ–°äº†è¯¥é¡¹çš„ `bottom`ã€‚</span>
    <span class="hljs-comment">// æˆ‘ä»¬éœ€è¦åŸºäºå‰ä¸€é¡¹çš„ bottom é‡æ–°è®¡ç®— top/bottomã€‚</span>
    <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) {
      item.<span class="hljs-property">top</span> = positions.<span class="hljs-property">value</span>[i - <span class="hljs-number">1</span>].<span class="hljs-property">bottom</span>
      item.<span class="hljs-property">bottom</span> = item.<span class="hljs-property">top</span> + item.<span class="hljs-property">height</span>
    }
    <span class="hljs-keyword">else</span> {
      item.<span class="hljs-property">top</span> = <span class="hljs-number">0</span>
      item.<span class="hljs-property">bottom</span> = item.<span class="hljs-property">height</span>
    }
  }
}

<span class="hljs-title function_">onUpdated</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">nextTick</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">updatePositions</span>()
  })
})

<span class="hljs-comment">// è®¾ç½® ResizeObserver</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">observer</span>: <span class="hljs-title class_">ResizeObserver</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>

<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (rootRef.<span class="hljs-property">value</span>) {
    state.<span class="hljs-property">containerHeight</span> = rootRef.<span class="hljs-property">value</span>.<span class="hljs-property">clientHeight</span>
    <span class="hljs-title function_">updateVisibleRange</span>()

    observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResizeObserver</span>(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> entries) {
        state.<span class="hljs-property">containerHeight</span> = entry.<span class="hljs-property">contentRect</span>.<span class="hljs-property">height</span>
        <span class="hljs-title function_">updateVisibleRange</span>()
      }
    })
    observer.<span class="hljs-title function_">observe</span>(rootRef.<span class="hljs-property">value</span>)
  }
})

<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (observer) {
    observer.<span class="hljs-title function_">disconnect</span>()
    observer = <span class="hljs-literal">null</span>
  }
})
&lt;/script&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"rootRef"</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"ns.b()"</span> @<span class="hljs-attr">scroll</span>=<span class="hljs-string">"onScroll"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 1. å¹½çµå®¹å™¨ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">"ns.e('phantom')"</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ height: `${listHeight}px` }"</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- 2. çœŸå®æ¸²æŸ“åŒºåŸŸ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">:class</span>=<span class="hljs-string">"ns.e('content')"</span>
      <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ transform: `translate3d(0, ${offset}px, 0)` }"</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in visibleData"</span>
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.key ?? item.id"</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">"itemsRef"</span>
        <span class="hljs-attr">:class</span>=<span class="hljs-string">"ns.e('item')"</span>
        <span class="hljs-attr">:data-index</span>=<span class="hljs-string">"item.index"</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">:item</span>=<span class="hljs-string">"item"</span> <span class="hljs-attr">:index</span>=<span class="hljs-string">"item.index"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

</code></pre>
<h3 data-id="heading-10">ç¬¬ä¸€æ­¥ï¼šå®šä¹‰æ•°æ®ç»“æ„</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°ç»„ <code>positions</code> æ¥è®°å½•æ¯ä¸€é¡¹çš„ä½ç½®ä¿¡æ¯ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Position</span> {
  <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>  <span class="hljs-comment">// ç¬¬å‡ æ¡æ•°æ®</span>
  <span class="hljs-attr">top</span>: <span class="hljs-built_in">number</span>    <span class="hljs-comment">// é¡¶éƒ¨è·ç¦»æ€»åˆ—è¡¨é¡¶ç«¯çš„è·ç¦»</span>
  <span class="hljs-attr">bottom</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// åº•éƒ¨è·ç¦»æ€»åˆ—è¡¨é¡¶ç«¯çš„è·ç¦»</span>
  <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// è¿™ä¸€é¡¹çš„é«˜åº¦</span>
  <span class="hljs-attr">dHeight</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// é«˜åº¦ä¿®æ­£å€¼ï¼ˆçœŸå®é«˜åº¦ - é¢„ä¼°é«˜åº¦ï¼‰</span>
}

<span class="hljs-keyword">const</span> positions = ref&lt;<span class="hljs-title class_">Position</span>[]&gt;([])
</code></pre>
<p>åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬å…ˆæŒ‰é¢„ä¼°é«˜åº¦ï¼ˆæ¯”å¦‚ 50pxï¼‰æŠŠè¿™ä¸ªæ•°ç»„å¡«æ»¡ã€‚</p>
<h3 data-id="heading-11">ç¬¬äºŒæ­¥ï¼šäºŒåˆ†æŸ¥æ‰¾ (Binary Search)</h3>
<p>å½“ä½ æ»šåŠ¨åˆ° <code>scrollTop = 10000</code> çš„ä½ç½®æ—¶ï¼Œæˆ‘ä»¬æ€ä¹ˆçŸ¥é“è¯¥ä»ç¬¬å‡ æ¡æ•°æ®å¼€å§‹æ¸²æŸ“ï¼Ÿ</p>
<p>å¦‚æœä»å¤´éå† <code>positions</code> æ•°ç»„ï¼Œå¦‚æœæ•°æ®æœ‰ä¸€ç™¾ä¸‡æ¡ï¼Œé‚£æ¯æ¬¡æ»šåŠ¨éƒ½è¦ç®—å¾ˆä¹…ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨<strong>äºŒåˆ†æŸ¥æ‰¾</strong>ï¼Œæ•ˆç‡ç¬é—´èµ·é£ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªåº•éƒ¨ä½ç½®å¤§äº scrollTop çš„å…ƒç´ ç´¢å¼•</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getStartIndex</span>(<span class="hljs-params">scrollTop: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></span>) {
  <span class="hljs-keyword">let</span> low = <span class="hljs-number">0</span>
  <span class="hljs-keyword">let</span> high = positions.<span class="hljs-property">value</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>
  
  <span class="hljs-keyword">while</span> (low &lt;= high) {
    <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((low + high) / <span class="hljs-number">2</span>)
    <span class="hljs-keyword">const</span> pos = positions.<span class="hljs-property">value</span>[mid]

    <span class="hljs-keyword">if</span> (pos.<span class="hljs-property">bottom</span> &gt; scrollTop) {
      <span class="hljs-keyword">if</span> (pos.<span class="hljs-property">top</span> &lt; scrollTop) {
        <span class="hljs-comment">// å°±æ˜¯å®ƒï¼è·¨è¶Šäº†å¯è§†è¾¹ç•Œ</span>
        <span class="hljs-keyword">return</span> mid
      }
      high = mid - <span class="hljs-number">1</span> <span class="hljs-comment">// åœ¨å‰åŠæˆª</span>
    } <span class="hljs-keyword">else</span> {
      low = mid + <span class="hljs-number">1</span>  <span class="hljs-comment">// åœ¨ååŠæˆª</span>
    }
  }
  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>
}
</code></pre>
<h3 data-id="heading-12">ç¬¬ä¸‰æ­¥ï¼šæ¸²æŸ“åçš„è‡ªåŠ¨ä¿®æ­£</h3>
<p>è¿™æ˜¯æœ€ç²¾å½©çš„ä¸€æ­¥ã€‚å½“æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Šåï¼ŒVue çš„ <code>onUpdated</code> é’©å­ä¼šè¢«è§¦å‘ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œè¿›è¡Œæµ‹é‡å’Œä¿®æ­£ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">updatePositions</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> nodes = itemsRef.<span class="hljs-property">value</span>
  <span class="hljs-keyword">if</span> (!nodes || nodes.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>

  <span class="hljs-comment">// 1. æµ‹é‡çœŸå®é«˜åº¦ï¼Œæ›´æ–°å½“å‰å¯è§†åŒºåŸŸçš„æ•°æ®</span>
  nodes.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> rect = node.<span class="hljs-title function_">getBoundingClientRect</span>()
    <span class="hljs-keyword">const</span> height = rect.<span class="hljs-property">height</span>
    <span class="hljs-keyword">const</span> index = <span class="hljs-built_in">parseInt</span>(node.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-index'</span>))
    <span class="hljs-keyword">const</span> oldHeight = positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">height</span>
    <span class="hljs-keyword">const</span> dHeight = height - oldHeight

    <span class="hljs-keyword">if</span> (dHeight) {
      positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">height</span> = height
      positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">bottom</span> = positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">bottom</span> + dHeight
      positions.<span class="hljs-property">value</span>[index].<span class="hljs-property">dHeight</span> = dHeight <span class="hljs-comment">// è®°å½•å·®å€¼</span>
    }
  })

  <span class="hljs-comment">// 2. ç´¯ç§¯æ•ˆåº”ï¼šä»ç¬¬ä¸€ä¸ªå˜åŒ–çš„ä½ç½®å¼€å§‹ï¼Œåç»­æ‰€æœ‰é¡¹éƒ½è¦è°ƒæ•´</span>
  <span class="hljs-comment">// æ¯”å¦‚ç¬¬ 5 é¡¹å˜é«˜äº† 10pxï¼Œé‚£ä¹ˆç¬¬ 6 é¡¹çš„ top å°±è¦ +10pxï¼Œbottom ä¹Ÿè¦ +10px...</span>
  <span class="hljs-keyword">let</span> startAdjustIndex = <span class="hljs-comment">/* æ‰¾åˆ°è¿™æ¬¡æ›´æ–°ä¸­æœ€æ—©å‡ºç°çš„é‚£ä¸ªç´¢å¼• */</span>
  <span class="hljs-keyword">let</span> accumulatedDiff = <span class="hljs-number">0</span>
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startAdjustIndex; i &lt; positions.<span class="hljs-property">value</span>.<span class="hljs-property">length</span>; i++) {
     <span class="hljs-keyword">const</span> item = positions.<span class="hljs-property">value</span>[i]
     <span class="hljs-comment">// æ›´æ–° top</span>
     item.<span class="hljs-property">top</span> = positions.<span class="hljs-property">value</span>[i - <span class="hljs-number">1</span>].<span class="hljs-property">bottom</span>
     <span class="hljs-comment">// æ›´æ–° bottom</span>
     item.<span class="hljs-property">bottom</span> = item.<span class="hljs-property">top</span> + item.<span class="hljs-property">height</span>
  }
}
</code></pre>
<h3 data-id="heading-13">ç¬¬å››æ­¥ï¼šæ¨¡æ¿ä¸æ ·å¼ (Template &amp; Style)</h3>
<p>æœ€åï¼Œçœ‹çœ‹æ¨¡æ¿é‡Œæ˜¯æ€ä¹ˆæŠŠè¿™ä¸¤ä¸ªâ€œç›’å­â€ç»„è£…èµ·æ¥çš„ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">"rootRef"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"my-virtual-list"</span> @<span class="hljs-attr">scroll</span>=<span class="hljs-string">"onScroll"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- 1. å¹½çµå®¹å™¨ï¼šé«˜åº¦ç”± listHeight æ’‘å¼€ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"my-virtual-list__phantom"</span> <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ height: `${listHeight}px` }"</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- 2. çœŸå®æ¸²æŸ“åŒºåŸŸï¼šé€šè¿‡ transform ç§»åŠ¨åˆ°å¯è§†åŒº --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"my-virtual-list__content"</span>
      <span class="hljs-attr">:style</span>=<span class="hljs-string">"{ transform: `translate3d(0, ${offset}px, 0)` }"</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">v-for</span>=<span class="hljs-string">"item in visibleData"</span>
        <span class="hljs-attr">:key</span>=<span class="hljs-string">"item.id"</span>
        <span class="hljs-attr">class</span>=<span class="hljs-string">"my-virtual-list__item"</span>
        <span class="hljs-attr">:data-index</span>=<span class="hljs-string">"item.index"</span> 
      &gt;</span>
        <span class="hljs-comment">&lt;!-- æ’æ§½ï¼šæŠŠå…·ä½“æ€ä¹ˆæ¸²æŸ“è¿™ä¸€è¡Œçš„æƒåŠ›äº¤ç»™ä½¿ç”¨è€… --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">slot</span> <span class="hljs-attr">:item</span>=<span class="hljs-string">"item"</span> <span class="hljs-attr">:index</span>=<span class="hljs-string">"item.index"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p>åˆ«å¿˜äº†åŠ ä¸Šå…³é”®çš„ CSSï¼Œå¦åˆ™â€œå¹½çµâ€å’Œâ€œå†…å®¹â€ä¼šæ‰“æ¶ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.my-virtual-list</span> {
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">overflow-y</span>: auto; <span class="hljs-comment">/* å¿…é¡»å¼€å¯æ»šåŠ¨ */</span>
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
}

<span class="hljs-selector-class">.my-virtual-list__phantom</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">z-index</span>: -<span class="hljs-number">1</span>; <span class="hljs-comment">/* è—åœ¨åé¢ï¼Œåªä¸ºäº†æ’‘å¼€é«˜åº¦ */</span>
}

<span class="hljs-selector-class">.my-virtual-list__content</span> {
  <span class="hljs-attribute">position</span>: absolute;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-comment">/* transform ä¼šåœ¨è¿™é‡ŒåŠ¨æ€è®¾ç½® */</span>
}
</code></pre>
<h3 data-id="heading-14">ç¬¬äº”æ­¥ï¼šå“åº”å¼é€‚é… (ResizeObserver)</h3>
<p>å¦‚æœç”¨æˆ·ç¼©æ”¾äº†æµè§ˆå™¨çª—å£ï¼Œæˆ–è€…ä¾§è¾¹æ æŠ˜å å¯¼è‡´åˆ—è¡¨å®¹å™¨é«˜åº¦å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°è®¡ç®—â€œä¸€å±èƒ½æ˜¾ç¤ºå¤šå°‘æ¡æ•°æ®â€ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç›‘å¬å®¹å™¨å°ºå¯¸å˜åŒ–</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">observer</span>: <span class="hljs-title class_">ResizeObserver</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>

<span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (rootRef.<span class="hljs-property">value</span>) {
    observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResizeObserver</span>(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> {
      <span class="hljs-comment">// æ›´æ–°å®¹å™¨é«˜åº¦ -&gt; è§¦å‘ visibleCount é‡æ–°è®¡ç®—</span>
      state.<span class="hljs-property">containerHeight</span> = entries[<span class="hljs-number">0</span>].<span class="hljs-property">contentRect</span>.<span class="hljs-property">height</span>
      <span class="hljs-title function_">updateVisibleRange</span>()
    })
    observer.<span class="hljs-title function_">observe</span>(rootRef.<span class="hljs-property">value</span>)
  }
})

<span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (observer) {
    observer.<span class="hljs-title function_">disconnect</span>()
    observer = <span class="hljs-literal">null</span>
  }
})
</code></pre>
<hr/>
<h2 data-id="heading-15">5. æ€»ç»“</h2>
<p>å®ç°ä¸å®šé«˜åº¦è™šæ‹Ÿåˆ—è¡¨ï¼Œæ ¸å¿ƒå°±æ˜¯ï¼š</p>
<ol>
<li><strong>ä½ç½®ç¼“å­˜</strong>ï¼šç”¨ <code>positions</code> æ•°ç»„è®°å½•æ¯ä¸€é¡¹çš„å‡ ä½•ä¿¡æ¯ã€‚</li>
<li><strong>æ»šåŠ¨è®¡ç®—</strong>ï¼šç›‘å¬ scroll äº‹ä»¶ï¼Œç”¨<strong>äºŒåˆ†æŸ¥æ‰¾</strong>å¿«é€Ÿå®šä½ <code>startIndex</code>ã€‚</li>
<li><strong>åŠ¨æ€ä¿®æ­£</strong>ï¼šDOM æ¸²æŸ“å®Œåï¼Œæµ‹é‡çœŸå®é«˜åº¦ï¼Œåè¿‡æ¥ä¿®æ­£ <code>positions</code> æ•°ç»„ï¼Œç¡®ä¿æŒç»­æ»šåŠ¨çš„å‡†ç¡®æ€§ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Node.js è¿›ç¨‹é€€å‡ºæ—¶ï¼Œä¸ºä»€ä¹ˆä½ çš„æ—¥å¿—æ€»ä¼šâ€œæ–­å°¾â€ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7601159804489891859</link>    <guid>https://juejin.cn/post/7601159804489891859</guid>    <pubDate>2026-01-31T15:14:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601159804489891859" data-draft-id="7601020578490417161" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Node.js è¿›ç¨‹é€€å‡ºæ—¶ï¼Œä¸ºä»€ä¹ˆä½ çš„æ—¥å¿—æ€»ä¼šâ€œæ–­å°¾â€ï¼Ÿ"/> <meta itemprop="keywords" content="JavaScript,Node.js,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2026-01-31T15:14:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="donecoding"/> <meta itemprop="url" content="https://juejin.cn/user/3192637500430093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Node.js è¿›ç¨‹é€€å‡ºæ—¶ï¼Œä¸ºä»€ä¹ˆä½ çš„æ—¥å¿—æ€»ä¼šâ€œæ–­å°¾â€ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3192637500430093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    donecoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T15:14:57.000Z" title="Sat Jan 31 2026 15:14:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    15
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>ğŸš€ çœæµåŠ©æ‰‹ï¼ˆé€Ÿé€šç»“è®ºï¼‰</p>
<ol>
<li><strong>å†…å­˜ä¸ç”¨æ¸…</strong>ï¼šè¿›ç¨‹é€€å‡ºå OS ä¼šè‡ªåŠ¨å›æ”¶å†…å­˜ï¼Œåœ¨Â <code>exit</code>Â äº‹ä»¶é‡Œæ‰‹åŠ¨æ¸…ç†å˜é‡æ˜¯æµªè´¹æ—¶é—´ã€‚</li>
<li><strong>å¼‚æ­¥å·²æ­»</strong>ï¼š<code>exit</code>Â è§¦å‘æ—¶äº‹ä»¶å¾ªç¯å·²åœæ­¢ï¼Œæ‰€æœ‰Â <code>Promise</code>ã€<code>stream.end()</code>Â å‡æ— æ•ˆã€‚</li>
<li><strong>æ—¥å¿—ä¸¢å¤±çœŸç›¸</strong>ï¼š<code>WriteStream</code>Â æœ‰å†…éƒ¨ç¼“å†²åŒºï¼ˆé»˜è®¤ 64KBï¼‰ã€‚ä¸æ‰§è¡Œç‰©ç†è½ç›˜ï¼ˆ<code>fsyncSync</code>ï¼‰ï¼Œè¿›ç¨‹æ¶ˆå¤±æ—¶å†…å­˜é‡Œçš„æ®‹ç•™æ•°æ®ä¼šè¢«ä¸¢å¼ƒã€‚</li>
<li><strong>éä¾µå…¥å¼æ¸…ç†</strong>ï¼šä¸¥ç¦åœ¨ä¿¡å·ç›‘å¬å™¨é‡Œç¡¬ç¼–ç Â <code>process.exit()</code>Â å¯¼è‡´â€œéœ¸æƒé€€å‡ºâ€ï¼Œåº”é‡‡ç”¨Â  <strong>â€œåŒæ­¥åˆ·ç›˜ + ä¿¡å·å½’è¿˜â€</strong> Â çš„ç¨³å¥æ–¹æ¡ˆã€‚</li>
</ol>
</blockquote>
<hr/>
<p>ä¸€ã€ è¿›ç¨‹å¼¥ç•™ä¹‹é™…ï¼Œæˆ‘ä»¬åœ¨æ¸…ç†ä»€ä¹ˆï¼Ÿ</p>
<p>å¾ˆå¤šå¼€å‘è€…ä¹ æƒ¯åœ¨è¿›ç¨‹é€€å‡ºæ—¶å¿™ç€å°†å¯¹è±¡ç½®ç©ºã€æ¸…ç©º Mapã€‚è¯·åœæ­¢è¿™ç§æ— æ•ˆåŠ³åŠ¨ã€‚</p>
<p>è¿›ç¨‹é€€å‡ºåï¼Œæ“ä½œç³»ç»Ÿä¼šå¼ºåˆ¶å›æ”¶æ‰€æœ‰ç‰©ç†å†…å­˜ã€‚æˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„æ˜¯é‚£äº›Â  <strong>â€œæ“ä½œç³»ç»Ÿæ— æ³•è‡ªåŠ¨æ”¶å°¾â€</strong> Â çš„æ•°æ®ï¼š<strong>åº”ç”¨å±‚ç¼“å†²åŒºã€‚</strong></p>
<p>Node.js çš„æ–‡ä»¶å†™å…¥æµï¼ˆ<code>fs.WriteStream</code>ï¼‰ä¸ºäº†æ€§èƒ½ï¼Œé»˜è®¤ä¼šæœ‰ 64KB çš„ç¼“å†²åŒºã€‚å½“ä½ è°ƒç”¨Â <code>write()</code>Â æ—¶ï¼Œæ•°æ®å¯èƒ½è¿˜åœç•™åœ¨ V8 å †å†…å­˜æˆ–å†…æ ¸ç¼“å†²åŒºä¸­ã€‚å¦‚æœè¿›ç¨‹æ­¤æ—¶çªç„¶æ¶ˆå¤±ï¼Œè¿™ 64KB çš„æ•°æ®ï¼ˆé€šå¸¸æ˜¯æœ€å…³é”®çš„æŠ¥é”™æ—¥å¿—ï¼‰å°±ä¼šç›´æ¥éšå†…å­˜ä¸€èµ·è’¸å‘ã€‚</p>
<hr/>
<p>äºŒã€ æ ¸å¿ƒäº‹ä»¶æ‹†è§£ï¼šè°æ‰æ˜¯çœŸæ­£çš„â€œä¸´ç»ˆå‘Šåˆ«â€ï¼Ÿ</p>
<p>å¤„ç†é€€å‡ºé€»è¾‘ä¸»è¦æ¶‰åŠä»¥ä¸‹ä¸¤ç±»äº‹ä»¶ï¼Œä½†å®ƒä»¬çš„æ€§è´¨æˆªç„¶ä¸åŒï¼š</p>
<p>1.Â <code>exit</code>Â äº‹ä»¶ (æœ€åçš„å½’å£)</p>
<ul>
<li><strong>ç‰¹æ€§</strong>ï¼šNode.js è¿›ç¨‹çš„â€œç»ˆç‚¹ç«™â€ï¼Œæ­¤æ—¶äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰å·²ç»åœæ­¢ã€‚</li>
<li><strong>å±€é™</strong>ï¼šç»å¯¹ä¸è¦å†™å¼‚æ­¥ä»£ç ã€‚æ¯”å¦‚è°ƒç”¨Â <code>stream.end()</code>ï¼Œå®ƒä¾èµ–äº‹ä»¶å¾ªç¯å»åˆ·æ–°ç¼“å†²åŒºï¼Œåœ¨Â <code>exit</code>Â äº‹ä»¶é‡Œå®ƒæ ¹æœ¬æ²¡æœºä¼šæ‰§è¡Œå®Œã€‚</li>
<li><strong>å”¯ä¸€è§£</strong>ï¼šå¿…é¡»ä½¿ç”¨åŸºäºæ–‡ä»¶æè¿°ç¬¦ï¼ˆFDï¼‰çš„åŒæ­¥ç³»ç»Ÿè°ƒç”¨Â <code>fs.fsyncSync(fd)</code>ã€‚</li>
</ul>
<p>2.Â <code>SIGINT</code>Â &amp;Â <code>SIGTERM</code>Â (å¤–éƒ¨çš„å…³é—­è¯·æ±‚)</p>
<ul>
<li><strong>ä¿¡å·ç‰¹æ€§</strong>ï¼š<code>SIGINT</code>ï¼ˆCtrl+Cï¼‰æˆ–Â <code>SIGTERM</code>ï¼ˆDocker/K8s åœæœºï¼‰é»˜è®¤ä¼šä½¿è¿›ç¨‹é—ªé€€ï¼Œä¸”<strong>ä¸ä¼š</strong>ä¸»åŠ¨è§¦å‘Â <code>exit</code>Â äº‹ä»¶ã€‚</li>
<li><strong>åŠ«æŒæ•ˆåº”</strong>ï¼šä¸€æ—¦ä½ ç›‘å¬äº†è¿™äº›ä¿¡å·ï¼ŒNode.js çš„é»˜è®¤é€€å‡ºè¡Œä¸ºä¼šè¢«æ‹¦æˆªã€‚å¦‚æœå¤„ç†ä¸å½“ï¼Œè¿›ç¨‹ä¼šâ€œè‹Ÿæ´»â€åœ¨åå°å˜æˆåƒµå°¸è¿›ç¨‹ã€‚</li>
</ul>
<hr/>
<p>ä¸‰ã€ å·¥ä¸šçº§æ–¹æ¡ˆï¼šå®ç° 100% æ—¥å¿—å®Œæ•´æ€§</p>
<p>ä¸ºäº†ç¡®ä¿æœ€åä¸€è¡Œæ—¥å¿—ä¸ä¸¢å¤±ï¼Œæˆ‘ä»¬éœ€è¦ä¸€å¥—æ—¢èƒ½â€œè½ç›˜â€åˆä¸â€œä¾µå…¥â€çš„æ¸…ç†é€»è¾‘ã€‚</p>
<ol>
<li>éä¾µå…¥å¼ç›‘å¬ï¼šåªè´Ÿè´£ä¿å‘½ï¼Œä¸æŠ¢å¤ºæ§åˆ¶æƒ</li>
</ol>
<p>ä¸è¦åœ¨ä¿¡å·ç›‘å¬å™¨é‡Œå†™Â <code>process.exit()</code>ã€‚è¿™ä¼šæˆªæ–­å…¶ä»–æ¨¡å—ï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ± ã€æ¡†æ¶é”€æ¯é’©å­ï¼‰çš„æ¸…ç†é€»è¾‘ã€‚æ¨èä½¿ç”¨Â <code>once</code>Â ç›‘å¬å¹¶æ‰§è¡ŒåŒæ­¥åˆ·ç›˜ã€‚</p>
<pre><code class="hljs language-Typescirpt" lang="Typescirpt">const flushLogsSync = () =&gt; {
  // æ ¸å¿ƒï¼šéå†æ‰€æœ‰æ—¥å¿—æµï¼Œæ‰§è¡ŒåŒæ­¥ç‰©ç†è½ç›˜
  for (const stream of logStreamMap.values()) {
    try {
      // æ£€æŸ¥æµæ˜¯å¦æŒæœ‰ç‰©ç†æ–‡ä»¶å¥æŸ„ (fd)
      if (typeof stream.fd === "number") {
        // å¼ºåˆ¶å†…æ ¸å°†æ–‡ä»¶ç¼“å†²åŒºæ•°æ®ç‰©ç†å†™å…¥ç£ç›˜
        fs.fsyncSync(stream.fd);
      }
    } catch (e) {}
  }
};

// ç›‘å¬ä¸€æ¬¡æ€§é€€å‡ºä¿¡å·
['SIGTERM', 'SIGINT'].forEach(signal =&gt; {
  process.once(signal, () =&gt; {
    flushLogsSync();
    // é€»è¾‘æ‰§è¡Œå®Œåï¼Œè‹¥æ— å…¶ä»–å¼‚æ­¥ä»»åŠ¡ï¼Œè¿›ç¨‹å°†æŒ‰ Node.js æœºåˆ¶è‡ªç„¶é€€å‡º
    // è‹¥éœ€ç¡®ä¿ç»å¯¹é€€å‡ºï¼Œå¯åœ¨æ­¤å¤„æ ¹æ®ä¸šåŠ¡ä¼˜å…ˆçº§å†³å®šæ˜¯å¦è¡¥å…… process.exit()
  });
});

// ç›‘å¬ Node.js è‡ªç„¶é€€å‡ºäº‹ä»¶ï¼ˆæœ€åçš„åŒæ­¥å…œåº•ï¼‰
process.once("exit", flushLogsSync);
</code></pre>
<ol start="2">
<li>é’ˆå¯¹â€œæ‰‹åŠ¨å­˜æ¡£â€çš„ç‰¹æ®Šå¤„ç†</li>
</ol>
<p>åœ¨ä¸é€€å‡ºè¿›ç¨‹çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä½ å¸Œæœ›æ‰‹åŠ¨å¼ºåˆ¶è½ç›˜ï¼ˆå¦‚åº”å¯¹å®šæ—¶å¿«ç…§æˆ–çƒ­é‡è½½ï¼‰ï¼Œå¯ä»¥åˆ©ç”¨Â <code>SIGHUP</code>Â ä¿¡å·ï¼š</p>
<pre><code class="hljs language-Typescirpt" lang="Typescirpt">// é’ˆå¯¹â€œæ‰‹åŠ¨å­˜æ¡£â€çš„ç‰¹æ®Šå¤„ç† 
// ä½¿ç”¨ .on è€Œé .onceï¼Œå› ä¸ºçƒ­é‡è½½æˆ–æ‰‹åŠ¨å­˜æ¡£å¯èƒ½åœ¨ä¸€ä¸ªè¿›ç¨‹ç”Ÿå‘½å‘¨æœŸå†…å¤šæ¬¡è§¦å‘
process.on('SIGHUP', flushLogsSync);
</code></pre>
<hr/>
<p>å››ã€ æ€»ç»“ï¼šé€ è½®å­æ˜¯ä¸ºäº†çœ‹æ¸…è·¯</p>
<p>åœ¨ Node.js è¿›ç¨‹å…³é—­çš„ç¬é—´ï¼Œå¼‚æ­¥æ˜¯ä¸å¯é çš„ã€‚</p>
<ul>
<li><strong>é”™è¯¯åšæ³•</strong>ï¼šåœ¨Â <code>exit</code>Â é‡Œå†™Â <code>await</code>Â æˆ–å¼‚æ­¥çš„Â <code>stream.end()</code>ã€‚</li>
<li><strong>å·¥ä¸šåšæ³•</strong>ï¼š<strong>åŒæ­¥Â <code>fsyncSync</code>Â + å°Šé‡è¿›ç¨‹è‡ªç„¶ç”Ÿå‘½å‘¨æœŸã€‚</strong></li>
</ul>
<p>é€šè¿‡è¿™å¥—é€»è¾‘ï¼Œä½ æ‰èƒ½åœ¨è¿›ç¨‹æŒ‚æ‰çš„ç¬é—´ï¼ŒæŠŠå†…å­˜ä¸­çš„â€œé—è¨€â€å®‰å…¨å­˜å…¥ç£ç›˜ã€‚</p>
<hr/>
<p>ğŸ’¡ è¿›é˜¶æ€è€ƒï¼šåŸç”Ÿå®ç° vs å·¥ä¸šçº§æ—¥å¿—åº“</p>
<p>æœ¬æ–‡æ–¹æ¡ˆæ˜¯ä»åº•å±‚åŸç†å‡ºå‘ï¼Œå¸¦ä½ ææ¸…ä¸¢å¤±æ ¹æºã€‚åœ¨å¤æ‚çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®åœ¨ç†è§£åŸç†çš„åŸºç¡€ä¸Šé€‰æ‹©æˆç†Ÿçš„åº“ï¼š</p>
<ol>
<li><strong>Pino (æ€§èƒ½ç‹è€…)</strong> ï¼šNode.js æ€§èƒ½å¤©èŠ±æ¿ã€‚<strong>æ³¨æ„</strong>ï¼šPino v8+ å¼•å…¥äº† Worker Threads å¼‚æ­¥å†™å…¥æ¶æ„ã€‚åœ¨ 2026 å¹´çš„å®è·µä¸­ï¼Œè‹¥éœ€ç¡®ä¿é€€å‡ºæ—¶ä¸ä¸¢æ—¥å¿—ï¼Œåº”åœ¨ä¿¡å·å¤„ç†å™¨ä¸­é€šè¿‡Â <code>destination.flushSync()</code>Â æ‰‹åŠ¨åˆ·ç›˜ï¼Œè€Œæ— éœ€ç‰ºç‰²å¹³æ—¶çš„æ€§èƒ½ã€‚</li>
<li><strong>Winston</strong>ï¼šåŠŸèƒ½æœ€å…¨çš„â€œè€å“¥â€ã€‚æ”¯æŒå¤šç«¯ä¼ è¾“ï¼ˆTransportsï¼‰ï¼Œé€‚åˆéœ€è¦å°†æ—¥å¿—åŒæ—¶åˆ†å‘åˆ°æ§åˆ¶å°ã€æœ¬åœ°æ–‡ä»¶å’Œè¿œç¨‹ç›‘æ§ç³»ç»Ÿçš„åœºæ™¯ã€‚</li>
<li><strong>Bunyan</strong>ï¼šä¸»æ‰“ä¸¥æ ¼çš„ JSON ç»“æ„åŒ–ã€‚</li>
</ol>
<p><strong>æ€»ç»“ä¸€å¥è¯</strong>ï¼šç†è§£äº†æ–‡ä»¶æè¿°ç¬¦ï¼ˆFDï¼‰é‡å®šå‘å’Œç‰©ç†è½ç›˜ï¼Œä½ å°±èƒ½æ›´ä»å®¹åœ°é…ç½®è¿™äº›ä¸“ä¸šåº“ï¼Œç¡®ä¿æ¯ä¸€è¡Œæ—¥å¿—éƒ½èƒ½åœ¨è¿›ç¨‹â€œä¸´ç»ˆâ€å‰å®‰å…¨åˆ°å®¶ã€‚</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€React-5/Lesson81(2025-12-23)ã€‘æ„å»ºä¸€ä¸ªå®Œæ•´çš„ React å¾…åŠäº‹é¡¹åº”ç”¨ï¼ˆTodo Appï¼‰ï¼šä»é›¶åˆ°æœ¬åœ°æŒä¹…åŒ–ğŸ“]]></title>    <link>https://juejin.cn/post/7601076976440180776</link>    <guid>https://juejin.cn/post/7601076976440180776</guid>    <pubDate>2026-01-31T15:46:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601076976440180776" data-draft-id="7601076976440164392" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€React-5/Lesson81(2025-12-23)ã€‘æ„å»ºä¸€ä¸ªå®Œæ•´çš„ React å¾…åŠäº‹é¡¹åº”ç”¨ï¼ˆTodo Appï¼‰ï¼šä»é›¶åˆ°æœ¬åœ°æŒä¹…åŒ–ğŸ“"/> <meta itemprop="keywords" content="React.js,å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-31T15:46:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jing_Rainbow"/> <meta itemprop="url" content="https://juejin.cn/user/1285809519198256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€React-5/Lesson81(2025-12-23)ã€‘æ„å»ºä¸€ä¸ªå®Œæ•´çš„ React å¾…åŠäº‹é¡¹åº”ç”¨ï¼ˆTodo Appï¼‰ï¼šä»é›¶åˆ°æœ¬åœ°æŒä¹…åŒ–ğŸ“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1285809519198256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jing_Rainbow
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T15:46:12.000Z" title="Sat Jan 31 2026 15:46:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ğŸ“åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼ŒReact ä»¥å…¶ç»„ä»¶åŒ–ã€å£°æ˜å¼å’Œé«˜æ•ˆæ›´æ–°çš„ç‰¹æ€§æˆä¸ºæ„å»ºç”¨æˆ·ç•Œé¢çš„é¦–é€‰æ¡†æ¶ä¹‹ä¸€ã€‚æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥å‰–æä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€ç»“æ„æ¸…æ™°ã€å…·å¤‡æœ¬åœ°å­˜å‚¨èƒ½åŠ›çš„ <strong>React å¾…åŠäº‹é¡¹åº”ç”¨ï¼ˆTodo Appï¼‰</strong> çš„å®ç°ç»†èŠ‚ã€‚æˆ‘ä»¬å°†é€å±‚æ‹†è§£å…¶æ ¸å¿ƒç»„ä»¶ã€çŠ¶æ€ç®¡ç†é€»è¾‘ã€çˆ¶å­é€šä¿¡æœºåˆ¶ã€æ ·å¼å¤„ç†ä»¥åŠæ•°æ®æŒä¹…åŒ–ç­–ç•¥ï¼Œå¹¶è¡¥å……å¤§é‡ç›¸å…³çŸ¥è¯†ï¼Œå¸®åŠ©ä½ çœŸæ­£æŒæ¡ React åº”ç”¨çš„å¼€å‘èŒƒå¼ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ§© åº”ç”¨æ•´ä½“æ¶æ„æ¦‚è§ˆ</h2>
<p>è¯¥ Todo åº”ç”¨é‡‡ç”¨å…¸å‹çš„ <strong>å•é¡µåº”ç”¨ï¼ˆSPAï¼‰</strong> ç»“æ„ï¼Œä»¥ <code>App.jsx</code> ä½œä¸ºæ ¹ç»„ä»¶ï¼Œåè°ƒä¸‰ä¸ªä¸»è¦å­ç»„ä»¶ï¼š</p>
<ul>
<li><code>TodoInput.jsx</code>ï¼šè´Ÿè´£æ¥æ”¶ç”¨æˆ·è¾“å…¥å¹¶æ·»åŠ æ–°ä»»åŠ¡ã€‚</li>
<li><code>TodoList.jsx</code>ï¼šæ¸²æŸ“ä»»åŠ¡åˆ—è¡¨ï¼Œæ”¯æŒæ ‡è®°å®Œæˆä¸åˆ é™¤æ“ä½œã€‚</li>
<li><code>TodoStats.jsx</code>ï¼šå±•ç¤ºä»»åŠ¡ç»Ÿè®¡ä¿¡æ¯ï¼Œå¹¶æä¾›â€œæ¸…é™¤å·²å®Œæˆâ€åŠŸèƒ½ã€‚</li>
</ul>
<p>æ•´ä¸ªåº”ç”¨çš„æ•°æ®æµéµå¾ª <strong>å•å‘æ•°æ®æµï¼ˆUnidirectional Data Flowï¼‰</strong> åŸåˆ™ï¼šæ‰€æœ‰çŠ¶æ€ï¼ˆ<code>todos</code> æ•°ç»„ï¼‰ç”±çˆ¶ç»„ä»¶ <code>App</code> é›†ä¸­ç®¡ç†ï¼Œå­ç»„ä»¶é€šè¿‡ <code>props</code> æ¥æ”¶æ•°æ®å’Œå›è°ƒå‡½æ•°ï¼Œå®ç°â€œåªè¯»æ•°æ® + ä¸ŠæŠ¥äº‹ä»¶â€çš„é€šä¿¡æ¨¡å¼ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ—ï¸ æ ¸å¿ƒç»„ä»¶è¯¦è§£</h2>
<h3 data-id="heading-2">ğŸ”¹ <code>App.jsx</code>ï¼šçŠ¶æ€ç®¡ç†ä¸­å¿ƒä¸ç”Ÿå‘½å‘¨æœŸåè°ƒè€…</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'./styles/App.styl'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TodoInput</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/TodoInput'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TodoList</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/TodoList'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">TodoStats</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/TodoStats'</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// åˆå§‹åŒ– todos çŠ¶æ€ï¼Œä¼˜å…ˆä» localStorage è¯»å–</span>
  <span class="hljs-keyword">const</span> [todos, setTodos] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> saved = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'todos'</span>)
    <span class="hljs-keyword">return</span> saved ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(saved) : []
  })

  <span class="hljs-comment">// æ·»åŠ ä»»åŠ¡</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">addTodo</span>(<span class="hljs-params">text</span>) {
    <span class="hljs-title function_">setTodos</span>([...todos, { <span class="hljs-attr">id</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(), text, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> }])
  }

  <span class="hljs-comment">// åˆ é™¤ä»»åŠ¡</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">deleteTodo</span> = (<span class="hljs-params">id</span>) =&gt; {
    <span class="hljs-title function_">setTodos</span>(todos.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">id</span> !== id))
  }

  <span class="hljs-comment">// åˆ‡æ¢ä»»åŠ¡å®ŒæˆçŠ¶æ€</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleTodo</span> = (<span class="hljs-params">id</span>) =&gt; {
    <span class="hljs-title function_">setTodos</span>(todos.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span>
      todo.<span class="hljs-property">id</span> === id ? { ...todo, <span class="hljs-attr">completed</span>: !todo.<span class="hljs-property">completed</span> } : todo
    ))
  }

  <span class="hljs-comment">// æ¸…é™¤æ‰€æœ‰å·²å®Œæˆä»»åŠ¡</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">clearCompleted</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">setTodos</span>(todos.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">completed</span>))
  }

  <span class="hljs-comment">// è®¡ç®—æ´»è·ƒä¸å·²å®Œæˆä»»åŠ¡æ•°é‡</span>
  <span class="hljs-keyword">const</span> activeCount = todos.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.<span class="hljs-property">completed</span>).<span class="hljs-property">length</span>;
  <span class="hljs-keyword">const</span> completedCount = todos.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.<span class="hljs-property">completed</span>).<span class="hljs-property">length</span>;

  <span class="hljs-comment">// ç›‘å¬ todos å˜åŒ–ï¼ŒåŒæ­¥åˆ° localStorage</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'todos'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(todos))
  }, [todos])

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-app"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>My Todo List<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoInput</span> <span class="hljs-attr">onAdd</span>=<span class="hljs-string">{addTodo}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoList</span> <span class="hljs-attr">todos</span>=<span class="hljs-string">{todos}</span> <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{deleteTodo}</span> <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{toggleTodo}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoStats</span> 
        <span class="hljs-attr">total</span>=<span class="hljs-string">{todos.length}</span> 
        <span class="hljs-attr">active</span>=<span class="hljs-string">{activeCount}</span> 
        <span class="hljs-attr">completed</span>=<span class="hljs-string">{completedCount}</span> 
        <span class="hljs-attr">onClearCompleted</span>=<span class="hljs-string">{clearCompleted}</span> 
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>
</code></pre>
<h4 data-id="heading-3">ğŸ“Œ å…³é”®çŸ¥è¯†ç‚¹è¡¥å……ï¼š</h4>
<ul>
<li>
<p><strong><code>useState</code> çš„æƒ°æ€§åˆå§‹åŒ–ï¼ˆLazy Initializationï¼‰</strong> ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> { ... })
</code></pre>
<p>è¿™ç§å†™æ³•ç¡®ä¿åˆå§‹åŒ–å‡½æ•°åªåœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—ã€‚è¿™å¯¹äºä» <code>localStorage</code> è¯»å–æ•°æ®éå¸¸æœ‰ç”¨ã€‚</p>
</li>
<li>
<p><strong>ä¸å¯å˜æ€§ï¼ˆImmutabilityï¼‰åŸåˆ™</strong>ï¼š<br/>
æ‰€æœ‰çŠ¶æ€æ›´æ–°éƒ½ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰æˆ–æ•°ç»„æ–¹æ³•ï¼ˆ<code>filter</code>, <code>map</code>ï¼‰åˆ›å»ºæ–°æ•°ç»„ï¼Œè€Œéç›´æ¥ä¿®æ”¹åŸæ•°ç»„ã€‚è¿™æ˜¯ React çŠ¶æ€æ›´æ–°çš„æ ¸å¿ƒè¦æ±‚ï¼Œç¡®ä¿ç»„ä»¶èƒ½æ­£ç¡®å“åº”å˜åŒ–ã€‚</p>
</li>
<li>
<p><strong><code>useEffect</code> ä¸å‰¯ä½œç”¨ç®¡ç†</strong>ï¼š<br/>
<code>useEffect</code> åœ¨æ¯æ¬¡ <code>todos</code> å˜åŒ–åè‡ªåŠ¨å°†æ•°æ®åºåˆ—åŒ–å¹¶å­˜å…¥ <code>localStorage</code>ï¼Œå®ç°<strong>æœ¬åœ°æŒä¹…åŒ–</strong>ã€‚ä¾èµ–æ•°ç»„ <code>[todos]</code> ç¡®ä¿ä»…åœ¨ <code>todos</code> æ”¹å˜æ—¶è§¦å‘ã€‚</p>
</li>
<li>
<p><strong>è®¡ç®—å±æ€§</strong>ï¼š<br/>
<code>activeCount</code> å’Œ <code>completedCount</code> æ˜¯æ´¾ç”ŸçŠ¶æ€ï¼ˆDerived Stateï¼‰ï¼Œæ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°è®¡ç®—ï¼Œæ— éœ€å•ç‹¬ç”¨ <code>useState</code> ç®¡ç†ï¼Œç¬¦åˆ React æœ€ä½³å®è·µã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-4">ğŸ”¹ <code>TodoInput.jsx</code>ï¼šå—æ§ç»„ä»¶ä¸è¡¨å•å¤„ç†</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">TodoInput</span> = (<span class="hljs-params">props</span>) =&gt; {
  <span class="hljs-keyword">const</span> { onAdd } = props;
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>)

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSubmit</span> = e =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>()
    <span class="hljs-keyword">if</span> (inputValue.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">''</span>) {
      <span class="hljs-title function_">onAdd</span>(inputValue)
      <span class="hljs-title function_">setInputValue</span>(<span class="hljs-string">''</span>)
    }
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-input"</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
        <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setInputValue(e.target.value.replace(/\s+/g, '').trim())}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Add<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">TodoInput</span>
</code></pre>
<h4 data-id="heading-5">ğŸ“Œ å…³é”®çŸ¥è¯†ç‚¹è¡¥å……ï¼š</h4>
<ul>
<li><strong>å—æ§ç»„ä»¶ï¼ˆControlled Componentï¼‰</strong> ï¼š<br/>
<code>&lt;input&gt;</code> çš„å€¼ç”± React çŠ¶æ€ <code>inputValue</code> æ§åˆ¶ï¼Œä»»ä½•ç”¨æˆ·è¾“å…¥éƒ½é€šè¿‡ <code>onChange</code> äº‹ä»¶å¤„ç†å™¨æ›´æ–°çŠ¶æ€ï¼Œå®ç° <strong>å•å‘æ•°æ®ç»‘å®š</strong>ã€‚è¿™ä¸ Vue çš„ <code>v-model</code> åŒå‘ç»‘å®šä¸åŒï¼Œä½†æ›´ç¬¦åˆ React çš„å£°æ˜å¼ç†å¿µã€‚</li>
<li><strong>è¡¨å•æäº¤å¤„ç†</strong>ï¼š<br/>
ä½¿ç”¨ <code>&lt;form&gt;</code> çš„ <code>onSubmit</code> äº‹ä»¶è€ŒéæŒ‰é’®çš„ <code>onClick</code>ï¼Œå¯æ”¯æŒå›è½¦é”®æäº¤ï¼Œå¹¶é€šè¿‡ <code>e.preventDefault()</code> é˜»æ­¢é¡µé¢åˆ·æ–°ã€‚</li>
<li><strong>è¾“å…¥æ¸…ç†é€»è¾‘</strong>ï¼š<br/>
<code>e.target.value.replace(/\s+/g, '').trim()</code> ä¼šç§»é™¤æ‰€æœ‰ç©ºç™½å­—ç¬¦ï¼ˆåŒ…æ‹¬ä¸­é—´ç©ºæ ¼ï¼‰ï¼Œè¿™å¯èƒ½æ˜¯ä¸ºäº†å¼ºåˆ¶è¾“å…¥ä¸ºè¿ç»­å­—ç¬¦ä¸²ã€‚ä½†åœ¨å®é™… Todo åº”ç”¨ä¸­ï¼Œé€šå¸¸åªéœ€ <code>.trim()</code> å»é™¤é¦–å°¾ç©ºæ ¼å³å¯ä¿ç•™ä¸­é—´ç©ºæ ¼ï¼ˆå¦‚ â€œBuy milk and eggsâ€ï¼‰ã€‚æ­¤å¤„é€»è¾‘ç•¥æ˜¾æ¿€è¿›ï¼Œå¯æ ¹æ®éœ€æ±‚è°ƒæ•´ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-6">ğŸ”¹ <code>TodoList.jsx</code>ï¼šåˆ—è¡¨æ¸²æŸ“ä¸äº¤äº’</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">TodoList</span> = (<span class="hljs-params">props</span>) =&gt; {
  <span class="hljs-keyword">const</span> { todos, onDelete, onToggle } = props;
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-list"</span>&gt;</span>
      { todos.length === 0 ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"empty"</span>&gt;</span>No todos yet!<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      ) : (
        todos.map(todo =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{todo.completed</span> ? '<span class="hljs-attr">completed</span>' <span class="hljs-attr">:</span> ''}&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
                <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> 
                <span class="hljs-attr">checked</span>=<span class="hljs-string">{todo.completed}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{()</span> =&gt;</span> onToggle(todo.id)} 
              /&gt;
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{todo.text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onDelete(todo.id)}&gt;ğŸ’©<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">TodoList</span>
</code></pre>
<h4 data-id="heading-7">ğŸ“Œ å…³é”®çŸ¥è¯†ç‚¹è¡¥å……ï¼š</h4>
<ul>
<li><strong>åˆ—è¡¨æ¸²æŸ“ä¸ Key å±æ€§</strong>ï¼š<br/>
<code>key={todo.id}</code> æ˜¯ React è¯†åˆ«åˆ—è¡¨é¡¹èº«ä»½çš„å…³é”®ã€‚ä½¿ç”¨ <code>Date.now()</code> ä½œä¸º ID è™½ç®€å•ï¼Œä½†åœ¨é«˜é¢‘æ·»åŠ æ—¶å¯èƒ½å†²çªï¼ˆæ¯«ç§’çº§ç²¾åº¦ä¸è¶³ï¼‰ã€‚ç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨æ›´å¯é çš„å”¯ä¸€ ID ç”Ÿæˆæ–¹æ¡ˆï¼ˆå¦‚ <code>uuid</code> åº“ï¼‰ã€‚</li>
<li><strong>æ¡ä»¶æ¸²æŸ“</strong>ï¼š<br/>
ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦æ ¹æ® <code>todos.length</code> å†³å®šæ˜¾ç¤ºç©ºçŠ¶æ€è¿˜æ˜¯ä»»åŠ¡åˆ—è¡¨ã€‚</li>
<li><strong>æ ·å¼åŠ¨æ€ç»‘å®š</strong>ï¼š<br/>
<code>className={todo.completed ? 'completed' : ''}</code> æ ¹æ®ä»»åŠ¡çŠ¶æ€åŠ¨æ€æ·»åŠ  CSS ç±»ï¼Œé…åˆæ ·å¼è¡¨å®ç°è§†è§‰åé¦ˆï¼ˆå¦‚åˆ’çº¿ã€é€æ˜åº¦é™ä½ç­‰ï¼‰ã€‚</li>
<li><strong>äº‹ä»¶å¤„ç†å™¨å†…è” vs æå‰å®šä¹‰</strong>ï¼š<br/>
æ­¤å¤„ä½¿ç”¨å†…è”ç®­å¤´å‡½æ•° <code>() =&gt; onToggle(todo.id)</code>ï¼Œç®€æ´ä½†å¯èƒ½å½±å“æ€§èƒ½ï¼ˆæ¯æ¬¡æ¸²æŸ“åˆ›å»ºæ–°å‡½æ•°ï¼‰ã€‚å¯¹äºå¤§å‹åˆ—è¡¨ï¼Œå¯è€ƒè™‘ä½¿ç”¨ <code>useCallback</code> ä¼˜åŒ–ï¼Œä½†æœ¬åº”ç”¨è§„æ¨¡å°ï¼Œå½±å“å¯å¿½ç•¥ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8">ğŸ”¹ <code>TodoStats.jsx</code>ï¼šçŠ¶æ€å±•ç¤ºä¸æ¡ä»¶æ¸²æŸ“</h3>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">TodoStats</span> = (<span class="hljs-params">props</span>) =&gt; {
  <span class="hljs-keyword">const</span> { total, active, completed, onClearCompleted } = props
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Total: {total} | Active: {active} | Completed: {completed}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      { completed &gt; 0 &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClearCompleted}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"clear-btn"</span>&gt;</span>
          Clear Completed
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">TodoStats</span>
</code></pre>
<h4 data-id="heading-9">ğŸ“Œ å…³é”®çŸ¥è¯†ç‚¹è¡¥å……ï¼š</h4>
<ul>
<li><strong>çŸ­è·¯æ±‚å€¼ï¼ˆShort-circuit Evaluationï¼‰</strong> ï¼š<br/>
<code>{ completed &gt; 0 &amp;&amp; &lt;button&gt;...</code> æ˜¯ React ä¸­å¸¸è§çš„æ¡ä»¶æ¸²æŸ“æŠ€å·§ã€‚å½“ <code>completed &gt; 0</code> ä¸º <code>true</code> æ—¶æ¸²æŸ“æŒ‰é’®ï¼Œå¦åˆ™æ¸²æŸ“ <code>false</code>ï¼ˆReact ä¼šå¿½ç•¥ï¼‰ã€‚</li>
<li><strong>Props è§£æ„</strong>ï¼š<br/>
ä½¿ç”¨è§£æ„èµ‹å€¼ <code>const { total, active, ... } = props</code> æé«˜ä»£ç å¯è¯»æ€§ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-10">ğŸ¨ æ ·å¼ä¸ä¸»é¢˜ï¼šCSS ä¸ Stylus çš„ç»“åˆ</h2>
<p>é¡¹ç›®åŒæ—¶ä½¿ç”¨äº†ï¼š</p>
<ul>
<li>
<p><strong><code>index.css</code></strong>ï¼šå…¨å±€æ ·å¼ï¼Œè®¾ç½®é¡µé¢å¸ƒå±€ã€å­—ä½“ã€é¢œè‰²æ–¹æ¡ˆåŠèƒŒæ™¯å›¾ã€‚</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">body</span> {
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">display</span>: flex;
  place-items: center;
  <span class="hljs-attribute">min-width</span>: <span class="hljs-number">320px</span>;
  <span class="hljs-attribute">min-height</span>: <span class="hljs-number">100vh</span>;
  <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">'./assets/react-beautiful.svg'</span>);
  <span class="hljs-comment">/* ... */</span>
}
</code></pre>
<ul>
<li>åˆ©ç”¨ <code>prefers-color-scheme</code> åª’ä½“æŸ¥è¯¢å®ç°<strong>æ·±è‰²/æµ…è‰²ä¸»é¢˜è‡ªåŠ¨åˆ‡æ¢</strong>ã€‚</li>
<li><code>place-items: center</code> æ˜¯ <code>align-items</code> å’Œ <code>justify-items</code> çš„ç®€å†™ï¼Œç”¨äº Flex å®¹å™¨å±…ä¸­ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>App.styl</code></strong>ï¼ˆæœªæä¾›å†…å®¹ï¼Œä½†è¢«å¼•å…¥ï¼‰ï¼š<br/>
ä½¿ç”¨ <strong>Stylus</strong> é¢„å¤„ç†å™¨ç¼–å†™ç»„ä»¶å±€éƒ¨æ ·å¼ã€‚Stylus è¯­æ³•ç®€æ´ï¼Œæ”¯æŒåµŒå¥—ã€å˜é‡ã€æ··å…¥ç­‰ç‰¹æ€§ï¼Œæå‡ CSS å¯ç»´æŠ¤æ€§ã€‚</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-11">âš™ï¸ é¡¹ç›®åˆå§‹åŒ–ä¸æ„å»ºå·¥å…·é“¾</h2>
<p>æ ¹æ® <code>README.md</code> æè¿°ï¼Œé¡¹ç›®ä½¿ç”¨ <strong>Vite</strong> åˆå§‹åŒ–ï¼š</p>
<pre><code class="hljs language-md" lang="md">npm init vite
<span class="hljs-section"># é€‰æ‹© react + javascript æ¨¡æ¿</span>
npm i stylus  # å®‰è£… Stylus é¢„å¤„ç†å™¨æ”¯æŒ
</code></pre>
<p>Vite æä¾›æé€Ÿçš„å†·å¯åŠ¨å’Œçƒ­æ›´æ–°ï¼ˆHMRï¼‰ï¼Œæå¤§æå‡å¼€å‘ä½“éªŒã€‚é…åˆ React çš„æ¨¡å—åŒ–å¼€å‘ï¼Œå½¢æˆé«˜æ•ˆçš„å·¥ä½œæµã€‚</p>
<hr/>
<h2 data-id="heading-12">ğŸ”„ æ•°æ®æŒä¹…åŒ–ï¼š<code>localStorage</code> çš„å·§å¦™è¿ç”¨</h2>
<p>åº”ç”¨é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°æ•°æ®æŒä¹…åŒ–ï¼š</p>
<ol>
<li>
<p><strong>åˆå§‹åŒ–æ—¶è¯»å–</strong>ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> saved = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'todos'</span>)
  <span class="hljs-keyword">return</span> saved ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(saved) : []
})
</code></pre>
</li>
<li>
<p><strong>çŠ¶æ€å˜æ›´æ—¶å†™å…¥</strong>ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-string">'todos'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(todos))
}, [todos])
</code></pre>
</li>
</ol>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š<code>localStorage</code> åªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ï¼Œå› æ­¤éœ€ç”¨ <code>JSON.stringify</code> å’Œ <code>JSON.parse</code> è¿›è¡Œåºåˆ—åŒ–/ååºåˆ—åŒ–ã€‚</p>
</blockquote>
<p>è¿™ç§æ–¹æ¡ˆç®€å•æœ‰æ•ˆï¼Œé€‚ç”¨äºå°å‹åº”ç”¨ã€‚å¯¹äºå¤æ‚åº”ç”¨ï¼Œå¯è€ƒè™‘ IndexedDB æˆ–çŠ¶æ€ç®¡ç†åº“ï¼ˆå¦‚ Redux + redux-persistï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-13">ğŸ§  è®¾è®¡æ¨¡å¼ä¸æœ€ä½³å®è·µæ€»ç»“</h2>
<ul>
<li><strong>å•ä¸€æ•°æ®æºï¼ˆSingle Source of Truthï¼‰</strong> ï¼šæ‰€æœ‰çŠ¶æ€é›†ä¸­åœ¨ <code>App</code> ç»„ä»¶ã€‚</li>
<li><strong>è‡ªä¸Šè€Œä¸‹çš„æ•°æ®æµ</strong>ï¼šçˆ¶ç»„ä»¶é€šè¿‡ <code>props</code> å‘ä¸‹ä¼ é€’æ•°æ®å’Œå‡½æ•°ã€‚</li>
<li><strong>å­ç»„ä»¶æ— çŠ¶æ€ï¼ˆDumb Componentsï¼‰</strong> ï¼š<code>TodoInput</code>ã€<code>TodoList</code>ã€<code>TodoStats</code> ä»…è´Ÿè´£ UI æ¸²æŸ“å’Œäº‹ä»¶ä¸ŠæŠ¥ã€‚</li>
<li><strong>ä¸å¯å˜æ›´æ–°</strong>ï¼šå§‹ç»ˆè¿”å›æ–°å¯¹è±¡/æ•°ç»„ï¼Œè€Œéä¿®æ”¹åŸæ•°æ®ã€‚</li>
<li><strong>å‰¯ä½œç”¨éš”ç¦»</strong>ï¼šä½¿ç”¨ <code>useEffect</code> å¤„ç†å‰¯ä½œç”¨ï¼ˆå¦‚ localStorage åŒæ­¥ï¼‰ã€‚</li>
<li><strong>è¯­ä¹‰åŒ– HTML</strong>ï¼šä½¿ç”¨ <code>&lt;form&gt;</code>, <code>&lt;label&gt;</code>, <code>&lt;input type="checkbox"&gt;</code> æå‡å¯è®¿é—®æ€§ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-14">âœ… ç»“è¯­</h2>
<p>è¿™ä¸ªçœ‹ä¼¼ç®€å•çš„ Todo åº”ç”¨ï¼Œå®åˆ™æ¶µç›–äº† React å¼€å‘çš„æ ¸å¿ƒæ¦‚å¿µï¼šç»„ä»¶åŒ–ã€çŠ¶æ€ç®¡ç†ã€äº‹ä»¶å¤„ç†ã€æ¡ä»¶æ¸²æŸ“ã€åˆ—è¡¨æ¸²æŸ“ã€è¡¨å•æ§åˆ¶ã€å‰¯ä½œç”¨ç®¡ç†ã€æœ¬åœ°å­˜å‚¨ä»¥åŠæ ·å¼å¤„ç†ã€‚é€šè¿‡æ·±å…¥ç†è§£æ¯ä¸€è¡Œä»£ç èƒŒåçš„åŸç†ï¼Œä½ ä¸ä»…èƒ½å¤ç°æ­¤åº”ç”¨ï¼Œæ›´èƒ½ä¸¾ä¸€åä¸‰ï¼Œæ„å»ºæ›´å¤æ‚çš„ React é¡¹ç›®ã€‚ğŸš€</p>
<p>ç°åœ¨ï¼Œæ‰“å¼€ä½ çš„ç¼–è¾‘å™¨ï¼ŒåŠ¨æ‰‹å®è·µå§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ThreeJSã€‘InstancedMesh å®æˆ˜ï¼šä»20000ä¸ªMeshåˆ°1ä¸ªDraw Call]]></title>    <link>https://juejin.cn/post/7601075423002984484</link>    <guid>https://juejin.cn/post/7601075423002984484</guid>    <pubDate>2026-01-31T15:51:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601075423002984484" data-draft-id="7600994087588904979" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ThreeJSã€‘InstancedMesh å®æˆ˜ï¼šä»20000ä¸ªMeshåˆ°1ä¸ªDraw Call"/> <meta itemprop="keywords" content="three.js"/> <meta itemprop="datePublished" content="2026-01-31T15:51:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¶æ™ºè¾½"/> <meta itemprop="url" content="https://juejin.cn/user/3320999244205294"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ThreeJSã€‘InstancedMesh å®æˆ˜ï¼šä»20000ä¸ªMeshåˆ°1ä¸ªDraw Call
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3320999244205294/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¶æ™ºè¾½
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T15:51:35.000Z" title="Sat Jan 31 2026 15:51:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><em>å‰è¨€ï¼šä¸çŸ¥é“æœ‰æ²¡æœ‰å°ä¼™ä¼´è·Ÿæˆ‘ä¸€æ ·ï¼Œåˆšæ¥è§¦web3Dï¼Œæ¥è§¦ThreeJSï¼Œç„¶ååœ¨åšç±»ä¼¼æ™ºæ…§ç«™æˆ¿è¿™ç§é¡¹ç›®çš„æ—¶å€™ï¼Œå…´è‡´å†²å†²çš„æŠŠè®¾å¤‡æ”¾è‡³åˆ°åœºæ™¯ï¼Œæ¯ä¸€ä¸ªè®¾å¤‡æ‘†æ”¾çš„ä½ç½®éƒ½æ°åˆ°å¥½å¤„ï¼ŒåŒ…æ‹¬ç®¡é“ï¼Œæµå‘åŠ¨ç”»ç­‰ç­‰ï¼Œè§‰å¾—è¿™æ ·åº”è¯¥å°±ä¸‡æ— ä¸€å¤±äº†ï¼Œç„¶è€Œå®é™…è¿è¡Œèµ·æ¥å´å‘ç°ï¼Œå§æ§½ï¼Œå¥½å¡ï¼ï¼ï¼</em></p>
<p>æ­£é¢˜ï¼š
å…³äºå¦‚ä½•ä¼˜åŒ–ThreeJSé‡Œè®¾å¤‡ä¸€å¤šå°±å¡çš„é—®é¢˜ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥è®²è®²â€œInstancedMeshâ€ï¼Œè¿™æ˜¯ThreeJSå®˜æ–¹çš„ä¸€ä¸ªAPIï¼Œå®˜æ–¹æ˜¯è¿™ä¹ˆæè¿°çš„ï¼š</p>
<blockquote>
<p>è¿™æ˜¯ä¸€ä¸ªæ”¯æŒå®ä¾‹åŒ–æ¸²æŸ“çš„ç‰¹æ®Šç½‘æ ¼æ¨¡å‹ã€‚å¦‚æœæ‚¨éœ€è¦æ¸²æŸ“å¤§é‡å…·æœ‰ç›¸åŒå‡ ä½•ä½“å’Œæè´¨ä½†ä¸–ç•Œå˜æ¢ä¸åŒçš„å¯¹è±¡ï¼Œè¯·ä½¿ç”¨æ­¤ç±»ã€‚ä½¿ç”¨â€œInstancedMeshâ€æœ‰åŠ©äºå‡å°‘ç»˜åˆ¶è°ƒç”¨æ¬¡æ•°ï¼Œä»è€Œæé«˜åº”ç”¨ç¨‹åºçš„æ•´ä½“æ¸²æŸ“æ€§èƒ½ã€‚</p>
</blockquote>
<p>ä¸çŸ¥é“å¤§ä¼™æ‡µäº†æ²¡ï¼Œåæ­£æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™æè¿°çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯äº‘é‡Œé›¾é‡Œçš„ï¼Œä¸è¿‡ç°åœ¨æˆ‘è‡ªè®¤ä¸ºç®—æ˜¯æ¯”è¾ƒäº†è§£äº†ï¼Œå°±ç»™å¤§å®¶å¤§ç™½è¯ç¿»è¯‘ä¸€ä¸‹ï¼Œæ„æ€å°±æ˜¯ï¼šè¿™ä¸ªAPIå¯ä»¥è®©ä½ åœºæ™¯é‡Œçš„æ¨¡å‹æ— æŸå½±åˆ†èº«ï¼Œå°±æ˜¯ä¸è€—è´¹å¤šçš„æ€§èƒ½ï¼Œä½†èƒ½è®©åœºæ™¯é‡Œçš„æ¨¡å‹åˆ†èº«å¤šä¸ªå‡ºæ¥ï¼Œæ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯åƒé­”æ³•ä¸€æ ·ï¼Œé‚£å®ƒæ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿ</p>
<p>è¿™æ—¶å€™å°±ä¸å¾—ä¸æ3dåœºæ™¯çš„ç»˜åˆ¶åŸç†äº†ï¼Œæˆ‘ç›¸ä¿¡å¤§éƒ¨åˆ†å°ä¼™ä¼´éƒ½çŸ¥é“æ˜¾å¡è¿™ä¸ªä¸œè¥¿ï¼Œä¹ŸçŸ¥é“å®ƒæ˜¯ç”¨æ¥ä¸ºç”µè„‘æ¸²æŸ“å›¾å½¢ï¼Œweb3då½“ç„¶ä¹Ÿæ˜¯é å®ƒæ¸²æŸ“ï¼Œä½†æ˜¯ï¼Œæˆ‘è¦è¯´ä½†æ˜¯äº†ï¼Œè™½ç„¶æ¸²æŸ“æ˜¯å®ƒæ¥åšï¼Œä½†åˆ«å¿˜äº†å’±ä»¬ç”µè„‘è€å¤§å“¥CPUå•Šï¼Œäº‹å®å°±æ˜¯ï¼Œåƒè¿™ç§åœºæ™¯å¤šä¸ªæ¨¡å‹å¡é¡¿çš„åŸå› ï¼Œå¯èƒ½ç“¶é¢ˆå¹¶ä¸åœ¨GPUèº«ä¸Šï¼Œè€Œæ˜¯CPUèº«ä¸Šï¼Œæ€ä¹ˆæ ·ï¼Œæ˜¯ä¸æ˜¯åˆè’™äº†ï¼Œæˆ‘å½“åˆäº†è§£åˆ°ä¹Ÿç–‘æƒ‘äº†ä¸€ä¸‹ï¼Œæˆ‘ç»™å¤§å®¶è¯´ä¸€ä¸‹ï¼Œå…¶å®åŸå› å¾ˆç®€å•</p>
<p>æ‰“ä¸ªæ¯”æ–¹ï¼ŒæŠŠCPUæ¯”ä½œä¸€å®¶é¤é¦†çš„æ¥å•æ’­æŠ¥å‘˜ï¼Œè€ŒGPUå°±æ˜¯åå¨æ¥å•çš„å¨å­ï¼Œä½†æ˜¯æ¥å•å‘˜åªæœ‰ä¸€ä¸ª(éœ€è¦å¤„ç†å„ç§å¤æ‚çš„è®¢å•ã€ä¼˜æƒ åˆ¸å åŠ ã€ä¼šå‘˜åˆ¤å®šã€é€€å•é€»è¾‘ã€åº“å­˜æ£€æŸ¥)ï¼Œè€Œå¨å­æœ‰å¾ˆå¤š(åªéœ€è¦å›ºå®šå‡ ä¸ªæ­¥éª¤ç‚’èœï¼Œå…¶å®ƒéƒ½ä¸ç”¨ç®¡)</p>
<p>ç°åœ¨åº—é‡Œæ¥äº†ä¸€ç™¾ä¸ªå®¢äººï¼Œè¿™äº›å®¢äººè¦çš„éƒ½æ˜¯è›‹ç‚’é¥­ï¼Œä½†æ¥å•å‘˜æ¯ä¸€å•éƒ½è·‘å»åå¨è¯´æœ‰ä¸€æ¡Œè¦è›‹ç‚’é¥­ï¼Œæœ‰ä¸€æ¡Œè¦è›‹ç‚’é¥­...ç›´åˆ°æ´¾å®Œè¿™ä¸€ç™¾æ¡Œè›‹ç‚’é¥­ï¼Œåœ¨å–Šçš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®ƒå¨å­æ˜¯é—²ç€çš„çŠ¶æ€ï¼Œå› ä¸ºè¿˜æ²¡ç»™å®ƒæ´¾å•ï¼Œç°åœ¨å¤§ä¼™å‘ç°æœ‰å“ªé‡Œä¸å¤ªå¯¹åŠ²å—ï¼Ÿæ²¡é”™ï¼é‚£å°±æ˜¯ä¸ºä»€ä¹ˆæ¥å•å‘˜æ˜æ˜ä¸€ç™¾æ¡Œéƒ½æ˜¯åŒæ ·çš„èœï¼Œä½†ä¸ºä»€ä¹ˆè¦åˆ†ä¸€ç™¾æ¬¡æ´¾å•å‘¢ï¼Œä¸€æ¬¡æ´¾å®Œä¸è¡Œå—ï¼Œå˜¿å˜¿å˜¿ï¼Œè¿™æ—¶å€™å¦‚æœä½ ç”¨çš„æ˜¯æ™®é€šMeshï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ä¸è¡Œï¼Œè¿™æ˜¯ç”±Meshè¿™ä¸ªAPIå†³å®šçš„</p>
<p>è¿™æ—¶å€™å°±è®²åˆ°äº†æˆ‘ä»¬ä»Šå¤©çš„ä¸»é¢˜ï¼ŒInstancedMeshï¼Œå®ƒå°±æ˜¯é‚£ä¸ªå¯¹è¿™ç§é‡å¤éœ€æ±‚æ›´ä¸“ä¸šçš„æ¥å•å‘˜ï¼Œæœ‰åæ¡Œè›‹ç‚’é¥­å®ƒå°±ä¼šç›´æ¥è·Ÿåå¨è¯´ç°åœ¨éœ€è¦ç‚’åæ¡Œè›‹ç‚’é¥­ï¼Œä¸ä¼šæ¥å›å»é€šçŸ¥ï¼Œè¿™æ ·åå¨å°±å¯ä»¥ç«åŠ›å…¨å¼€ï¼Œä¸€æ¬¡æ€§æŠŠåæ¡Œè›‹ç‚’é¥­éƒ½åšå¥½ï¼Œç°åœ¨æ˜ç™½ä¸ºä»€ä¹ˆæˆ‘è¯´ç“¶é¢ˆä¸åœ¨GPUä¸Šäº†å§ï¼Œ<strong>Three.jsçš„å¡é¡¿ï¼Œå¾€å¾€ä¸æ˜¯"æ˜¾å¡ä¸å¤Ÿå¥½"ï¼Œè€Œæ˜¯"CPUåœ¨ç–¯ç‹‚ä¼ è¯ï¼Œæ²¡è®©æ˜¾å¡æ»¡è´Ÿè·å¹²æ´»"ã€‚</strong></p>
<p>å¼€å§‹æˆ‘ä»¬ä»Šå¤©çš„å®éªŒï¼Œæˆ‘ç°åœ¨åˆ›å»ºäº†20000ä¸ªBoxMeshï¼Œå¸§æ•°åªæœ‰å¯æ€œçš„10fpsï¼Œè¦çŸ¥é“æˆ‘è¿™å¯æ˜¯rtx3080ï¼Œè¦æ˜¯æ˜¾å¡å·®ä¸€ç‚¹çš„ï¼Œæˆ‘éƒ½ä¸æ•¢æƒ³è±¡ã€‚ã€‚ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6111537b81c24ee190b91643d9bc0672~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770479494&amp;x-signature=y41UTbMtQ60P5W4hv%2BxUjcVNLKk%3D" alt="å›¾ç‰‡.png" loading="lazy"/></p>
<p>å¤§ä¼™ä¹Ÿå¯ä»¥å¤åˆ¶ä»¥ä¸‹ä»£ç è‡ªå·±å»è¯•è¯•è‡ªå·±çš„ç”µè„‘èƒ½è·‘å¤šå°‘FPSï¼Œå¯ä»¥æŠŠFPSæ‰“åœ¨è¯„è®ºåŒº</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-comment">// 200 ä¸ª boxï¼š200 åˆ— x 100 è¡Œï¼Œæ•´é½æ’åˆ—</span>
  <span class="hljs-keyword">const</span> cols = <span class="hljs-number">200</span>;
  <span class="hljs-keyword">const</span> rows = <span class="hljs-number">100</span>;
  <span class="hljs-keyword">const</span> spacing = <span class="hljs-number">1.3</span>;
  <span class="hljs-keyword">const</span> geometry = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BoxGeometry</span>(<span class="hljs-number">0.8</span>, <span class="hljs-number">0.8</span>, <span class="hljs-number">0.8</span>);
  <span class="hljs-keyword">const</span> material = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">MeshBasicMaterial</span>({ <span class="hljs-attr">color</span>: <span class="hljs-number">0x00ff00</span> });

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) {
      <span class="hljs-keyword">const</span> box = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Mesh</span>(geometry, material);
      box.<span class="hljs-property">position</span>.<span class="hljs-property">x</span> = (j - cols / <span class="hljs-number">2</span> + <span class="hljs-number">0.5</span>) * spacing;
      box.<span class="hljs-property">position</span>.<span class="hljs-property">z</span> = (i - rows / <span class="hljs-number">2</span> + <span class="hljs-number">0.5</span>) * spacing;
      scene.<span class="hljs-title function_">add</span>(box);
    }
  }
</code></pre>
<p>æˆ‘ç›¸ä¿¡çœ‹åˆ°è¿™çš„å¤§ä¼™å¯¹äºæ€§èƒ½ä¼˜åŒ–éƒ½æœ‰ä¸€å®šçš„è¿½æ±‚ï¼Œå¯¹äºè¿™ç§æƒ…å†µæ˜¯å¾ˆéš¾å®¹å¿çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨InstancedMeshå¼€å§‹ä¼˜åŒ–å®ƒäº†ï¼</p>
<p>æˆ‘å…ˆå–ä¸ªå…³å­ï¼Œç»™å¤§å®¶çœ‹çœ‹ä¼˜åŒ–åçš„æˆªå›¾ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2584de6bd5024cbfb73a1aa61829c735~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y-25pm66L69:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770479494&amp;x-signature=WHZfLJ5iK6baY%2BSUGSL4jC%2F1ps8%3D" alt="image.png" loading="lazy"/></p>



































<table><thead><tr><th>æŒ‡æ ‡</th><th>20000ä¸ªMesh</th><th>InstancedMesh</th><th>ä¼˜åŒ–å€æ•°</th></tr></thead><tbody><tr><td><strong>Draw Calls</strong></td><td>20000</td><td>1</td><td><strong>20000x</strong></td></tr><tr><td><strong>å¸§ç‡(FPS)</strong></td><td>10</td><td>144</td><td><strong>14x</strong></td></tr><tr><td><strong>å†…å­˜å ç”¨</strong></td><td>~500MB+</td><td>~80MB</td><td><strong>6x</strong></td></tr><tr><td><strong>CPUå ç”¨</strong></td><td>90%</td><td>15%</td><td><strong>6x</strong></td></tr></tbody></table>
<p>æˆ‘å°±è¯´ä¸€å¥ï¼Œç‰›ä¸ç‰›ï¼åˆšåˆšåªæœ‰10fpsï¼Œæ²¡çœ¼çœ‹ï¼Œç°åœ¨ä¸€ä¸‹æŠŠæˆ‘æ˜¾ç¤ºå™¨çš„åˆ·æ–°ç‡è·‘æ»¡äº†ï¼Œ144FPSï¼Œå¹¶ä¸”ä»åŸæ¥20000çš„Draw Callï¼Œé™åˆ°äº†1Draw Callï¼Œä¹Ÿå°±æ˜¯è¯´æ¥å•å‘˜ä¸€æ¬¡æ€§è·Ÿåå¨è¯´è¦åšè¿™ä¹ˆå¤šä»½è›‹ç‚’é¥­ï¼Œç„¶ååå¨ç«åŠ›å…¨å¼€ï¼Œä¸€æ¬¡æ€§æå®šï¼</p>
<p>å¥½äº†ï¼Œé­”æœ¯æ€»æœ‰æ­ç§˜çš„é‚£å¤©ï¼Œä¸‹é¢å°±æ˜¯ä¼˜åŒ–åçš„ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-comment">// ---------- InstancedMeshï¼š200 åˆ— x 100 è¡Œ = 20000 ä¸ª boxï¼Œå•æ¬¡ draw call ----------</span>
  <span class="hljs-keyword">const</span> cols = <span class="hljs-number">200</span>;
  <span class="hljs-keyword">const</span> rows = <span class="hljs-number">100</span>;
  <span class="hljs-keyword">const</span> count = cols * rows;
  <span class="hljs-keyword">const</span> spacing = <span class="hljs-number">1.3</span>; <span class="hljs-comment">// å®ä¾‹ä¹‹é—´çš„é—´è·</span>
  <span class="hljs-keyword">const</span> geometry = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BoxGeometry</span>(<span class="hljs-number">0.8</span>, <span class="hljs-number">0.8</span>, <span class="hljs-number">0.8</span>);
  <span class="hljs-keyword">const</span> material = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">MeshBasicMaterial</span>({ <span class="hljs-attr">color</span>: <span class="hljs-number">0x00ff00</span> });
  <span class="hljs-keyword">const</span> instancedMesh = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">InstancedMesh</span>(geometry, material, count);
  <span class="hljs-comment">// è®¾ç½®ä¸ºé™æ€ç»˜åˆ¶ï¼Œé¿å…æ¯å¸§æ›´æ–°å®ä¾‹çŸ©é˜µ</span>
  instancedMesh.<span class="hljs-property">instanceMatrix</span>.<span class="hljs-title function_">setUsage</span>(<span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">StaticDrawUsage</span>);
  <span class="hljs-keyword">const</span> matrix = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Matrix4</span>();
  <span class="hljs-keyword">const</span> position = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Vector3</span>();
  <span class="hljs-keyword">let</span> idx = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; rows; i++) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; cols; j++) {
      <span class="hljs-comment">// ä»¥åœºæ™¯ä¸­å¿ƒä¸ºåŸç‚¹ï¼ŒæŒ‰è¡Œåˆ—å‡åŒ€æ’å¸ƒ</span>
      position.<span class="hljs-title function_">set</span>(
        (j - cols / <span class="hljs-number">2</span> + <span class="hljs-number">0.5</span>) * spacing,
        <span class="hljs-number">0</span>,
        (i - rows / <span class="hljs-number">2</span> + <span class="hljs-number">0.5</span>) * spacing
      );
      matrix.<span class="hljs-title function_">setPosition</span>(position);
      instancedMesh.<span class="hljs-title function_">setMatrixAt</span>(idx, matrix);
      idx++;
    }
  }
  <span class="hljs-comment">// æ›´æ–°åŒ…å›´çƒï¼Œä¾¿äºè§†é”¥å‰”é™¤ç­‰ä¼˜åŒ–</span>
  instancedMesh.<span class="hljs-title function_">computeBoundingSphere</span>();
  scene.<span class="hljs-title function_">add</span>(instancedMesh);
</code></pre>
<p>æœ‰å‡ ä¸ªæ˜æ˜¾çš„ä¸åŒï¼Œç¬¬ä¸€æ˜¯æ²¡æœ‰new meshè¿™ä¸ªç¯èŠ‚äº†ï¼Œå…³äºæ–°å¢meshéƒ½æ”¾åœ¨äº† <code>new THREE.InstancedMesh(geometry, material, count);</code> è¿™ä¸ª<code>count</code>å°±æ˜¯å‘Šè¯‰InstanceMeshéœ€è¦æ–°å¢å¤šå°‘ä¸ªMeshï¼Œç„¶ååœ¨éå†ä¹‹åæŠŠè¿™ä¸ªInstanceMeshæ·»åŠ åˆ°Sceneé‡Œï¼Œä¸­é—´çš„ç¯èŠ‚åªæ˜¯å†³å®šInstanceMeshé‡Œçš„Meshåº”è¯¥åœ¨ä»€ä¹ˆä½ç½®ã€‚</p>
<p>æˆ‘å†ç»™å¤§å®¶è®²å‡ ä¸ªInstanceMeshçš„å‘ï¼Œæ–°æ‰‹éå¸¸å®¹æ˜“å¿½ç•¥</p>
<h3 data-id="heading-0">1.åŠ¨æ€æ›´æ–°ä½ç½®çš„æ­£ç¡®å§¿åŠ¿</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// é”™è¯¯ï¼šæ¯å¸§éƒ½è®¾ç½® needsUpdateï¼Œå¡æˆPPT</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">20000</span>; i++) {
    instancedMesh.<span class="hljs-title function_">setMatrixAt</span>(i, newMatrix); <span class="hljs-comment">// åˆ«åœ¨å¾ªç¯é‡Œå¹²è¿™ä¸ªï¼</span>
  }
  instancedMesh.<span class="hljs-property">instanceMatrix</span>.<span class="hljs-property">needsUpdate</span> = <span class="hljs-literal">true</span>;
  <span class="hljs-title function_">requestAnimationFrame</span>(animate);
}

<span class="hljs-comment">// æ­£ç¡®ï¼šåªæ›´æ–°å˜åŒ–çš„ï¼Œä¸”è®¾ç½® DynamicDrawUsage</span>
instancedMesh.<span class="hljs-property">instanceMatrix</span>.<span class="hljs-title function_">setUsage</span>(<span class="hljs-variable constant_">THREE</span>.<span class="hljs-property">DynamicDrawUsage</span>);
<span class="hljs-comment">// åªåœ¨æ•°æ®çœŸçš„å˜äº†æ‰ setMatrixAt + needsUpdate = true</span>
</code></pre>
<h3 data-id="heading-1">2.Raycaster(å°„çº¿) å’‹äº¤äº’InstanceMeshå®ä¾‹</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> intersection = raycaster.<span class="hljs-title function_">intersectObject</span>(instancedMesh);
<span class="hljs-keyword">if</span> (intersection.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
  <span class="hljs-keyword">const</span> instanceId = intersection[<span class="hljs-number">0</span>].<span class="hljs-property">instanceId</span>;
  <span class="hljs-comment">// é«˜äº®è¯¥å®ä¾‹ï¼šéœ€è¦é…åˆ setColorAt</span>
  instancedMesh.<span class="hljs-title function_">setColorAt</span>(instanceId, <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Color</span>(<span class="hljs-number">0xff0000</span>));
  instancedMesh.<span class="hljs-property">instanceColor</span>.<span class="hljs-property">needsUpdate</span> = <span class="hljs-literal">true</span>;
}
</code></pre>
<h3 data-id="heading-2">3.dispose å†…å­˜æ³„æ¼ -----(è¿™ä¸ªä¸€å®šè¦é‡è§†ï¼Œæˆ‘æœ‰è¿‡å¾ˆæƒ¨ç—›çš„ç»å†....)</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ç»„ä»¶å¸è½½æ—¶ä¸€å®šè¦ï¼š</span>
geometry.<span class="hljs-title function_">dispose</span>();
material.<span class="hljs-title function_">dispose</span>();
instancedMesh.<span class="hljs-title function_">dispose</span>(); <span class="hljs-comment">// é‡Šæ”¾GPUç¼“å†²åŒº</span>
scene.<span class="hljs-title function_">remove</span>(instancedMesh);
}
</code></pre>
<blockquote>
<p><strong>æ€»ç»“</strong>ï¼šInstancedMesh ä¸æ˜¯é­”æ³•ï¼Œå®ƒåªæ˜¯è®© CPU ä» <strong>"å‘äº†20000ä¸ªå¿«é€’åŒ…è£¹"</strong> ï¼ˆæ¯æ¬¡éƒ½è¦æ‰“åŒ…ã€è´´å•ã€å«è½¦ï¼‰å˜æˆäº† <strong>"å‘äº†ä¸€è½¦è´§"</strong> ï¼ˆæ•´è½¦ç›´è¾¾ï¼‰ã€‚åœ¨æ™ºæ…§ç«™æˆ¿ã€æ™ºæ…§å·¥å‚è¿™ç§ <strong>"è®¾å¤‡å¤šä½†å‹å·å°‘"</strong> çš„åœºæ™¯ï¼Œè¿™æ˜¯æ€§ä»·æ¯”æœ€é«˜çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚</p>
<p><strong>ä½†åˆ«æ€¥ç€èµ°</strong>â€”â€”å¦‚æœä½ çš„è®¾å¤‡éœ€è¦<strong>å„è‡ªä¸åŒçš„è´´å›¾</strong>ï¼ˆæ¯”å¦‚æ¯å°æœºå™¨æ˜¾ç¤ºä¸åŒçš„æ¸©åº¦æ•°å­—ï¼‰ï¼ŒInstancedMeshå°±åŠ›ä¸ä»å¿ƒäº†ã€‚è¿™æ—¶å€™è¯¥ç”¨ <strong>Texture Atlasï¼ˆçº¹ç†å›¾é›†ï¼‰</strong> è¿˜æ˜¯ <strong>åˆå¹¶å‡ ä½•ä½“ï¼ˆMergeGeometryï¼‰</strong> ï¼Ÿ</p>
<p>å…³æ³¨ä¸‹ç¯‡ï¼š <strong>ã€ThreeJSã€‘å¤šæè´¨è®¾å¤‡ä¼˜åŒ–ï¼šä¸€å¼ è´´å›¾ç®¡ç†1000ä¸ªè®¾å¤‡çš„ç‹¬ç«‹æ˜¾ç¤º</strong> ï¼Œå’±ä»¬ç»§ç»­æŠ˜è…¾æ€§èƒ½ä¼˜åŒ–ã€‚</p>
<p><strong>äº’åŠ¨</strong>ï¼šä½ çš„é¡¹ç›®æœ€å¤šæ¸²æŸ“è¿‡å¤šå°‘ä¸ªMeshï¼Ÿåœ¨è¯„è®ºåŒºæ™’æ™’å¸§ç‡ï¼Œçœ‹çœ‹è°çš„ä¼˜åŒ–æ›´ç‹ ğŸ˜</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android Jetpack ä¹‹ ViewModel æºç æ¢ç©¶]]></title>    <link>https://juejin.cn/post/7601044684774408230</link>    <guid>https://juejin.cn/post/7601044684774408230</guid>    <pubDate>2026-01-31T11:38:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601044684774408230" data-draft-id="7601077764424187954" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android Jetpack ä¹‹ ViewModel æºç æ¢ç©¶"/> <meta itemprop="keywords" content="Android Jetpack"/> <meta itemprop="datePublished" content="2026-01-31T11:38:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ciantian"/> <meta itemprop="url" content="https://juejin.cn/user/3069492195496951"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android Jetpack ä¹‹ ViewModel æºç æ¢ç©¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3069492195496951/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ciantian
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T11:38:00.000Z" title="Sat Jan 31 2026 11:38:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>Jetpack ç³»åˆ—æ–‡ç« éƒ½æ˜¯åœ¨å­¦ä¹ æ—¶å€™çš„ç¬”è®°</p>
<p>å†™æ–‡ç« çš„æ€è·¯æ˜¯ä»æƒ³åˆ°ä»€ä¹ˆé—®é¢˜,åˆ°è§£é‡Šè¿™ä¸ªé—®é¢˜æ¥è¿›è¡Œè¡¨è¿°çš„.</p>
<p>ä¸å»ºè®®é€šç¯‡é˜…è¯», å…³å¿ƒé‚£ä¸ªçœ‹å¯¹åº”çš„å®ç°å³å¯.</p>
</blockquote>
<p>æ ¸å¿ƒç±»å®šä¹‰:</p>
<p><code>ViewModelStoreOwner</code>:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ViewModelOwner</span>{
	<span class="hljs-keyword">val</span> viewModelStore: ViewModelStore
}
</code></pre>
<p><code>ViewModelProvider</code>: ViewModel çš„æä¾›å•†, æ„é€ å‡½æ•°ä¸­éœ€è¦æä¾› Factory å’Œ Extras</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModelProvider</span>{
	<span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(owner: ViewModelStoreOwner){
		<span class="hljs-comment">// defaultFactory ä¼  owner æ˜¯åˆ¤æ–­æ˜¯ä¼šå¦æ˜¯ HasDefaultViewModelProviderFactory, </span>
		<span class="hljs-comment">// å– Activity æºå¸¦ SaveStateViewModelFactroy</span>
		<span class="hljs-comment">// defaultCreationExtral ä¼  owner æ˜¯åˆ¤æ–­æ˜¯ä¼šå¦æ˜¯ HasDefaultViewModelProviderFactory, </span>
		<span class="hljs-comment">// å– Activity æºå¸¦ é»˜è®¤å‚æ•°, ä¸€èˆ¬ä¼šæœ‰ application, å’Œå®¿ä¸»è‡ªèº«çš„å¼•ç”¨.</span>
		<span class="hljs-keyword">this</span>(owner.viewModelStore, defaultFactory(owner), defaultCreationExtral(owner))
	}
	<span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(owner: ViewModelStoreOwner, factory: Factory){
		<span class="hljs-keyword">this</span>(owner.viewModelStore, factory, defaultCreationExtral(owner))
	}
	<span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(store: ViewModelStore, factory: Factory, extral: CreateExtras){}
}
</code></pre>
<p><code>Factory</code>: ViewModel çš„åˆ›å»ºå·¥å‚, å¸¸ä½¿ç”¨åˆ°çš„æœ‰ NewInstanceFactory(é»˜è®¤å®ç°) AndroidViewModelFactory(AndroidViewModel çš„åˆ›å»ºå·¥å‚) InitializerViewModelFactory(å¸¦å‚æ•°çš„æ„é€ å™¨) SaveStateViewModelFactory</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Factory</span>{
	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T: ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T{}
	<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T: ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, extras: <span class="hljs-type">CreationExtras</span>)</span></span>: T{}
	<span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span>{
		<span class="hljs-comment">// å¸¦å‚æ•°åˆ›å»º</span>
		<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">from</span><span class="hljs-params">(varrag initializers: <span class="hljs-type">ViewModelInitializer</span>&lt;*&gt;)</span></span>: Factory = InitializerViewModelFactory(*initializers)
	}
}

<span class="hljs-comment">// å®šä¹‰ key</span>
<span class="hljs-keyword">object</span> IdKey: CreateExtras.Key&lt;<span class="hljs-built_in">Int</span>&gt;
<span class="hljs-keyword">object</span> NameKey: CreateExtras.key&lt;String&gt;
<span class="hljs-comment">// å®šä¹‰ ViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TestViewModel</span>(<span class="hljs-keyword">val</span> id: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> name: String): ViewModel()
<span class="hljs-comment">// åˆ›å»º Factory</span>
<span class="hljs-keyword">val</span> factory = viewModelFactory{
	initializer{
		<span class="hljs-keyword">val</span> id = <span class="hljs-keyword">this</span>[IdKey]?:error(<span class="hljs-string">"id error."</span>)
		<span class="hljs-keyword">val</span> name = <span class="hljs-keyword">this</span>[NameKey]?:error(<span class="hljs-string">"name error."</span>)
		TestViewModel(id, name)
	}
}
<span class="hljs-comment">// åˆ›å»º extras</span>
<span class="hljs-keyword">val</span> extras = MutableCreationExtras().apply{
   <span class="hljs-keyword">this</span>[IdKey] = <span class="hljs-number">1</span>
   <span class="hljs-keyword">this</span>[NameKey] = <span class="hljs-string">"Tom"</span>
}
<span class="hljs-comment">// åˆ›å»º viewModel</span>
<span class="hljs-keyword">val</span> viewModel: TestViewModel = factory.create(TestViewModel::<span class="hljs-keyword">class</span>, extras)
</code></pre>
<p>éœ€è¦ææ¸…æ¥šçš„é—®é¢˜:</p>
<h2 data-id="heading-0"><strong>1: ViewModel çš„åˆ›å»ºæ–¹å¼æ˜¯ä»€ä¹ˆ?</strong></h2>
<p><code>ViewModelProvider(this)[xxx::class.java]</code></p>
<p>provider#get() â†’ store ä¸­å– â†’ å– Extras â†’ è°ƒç”¨factory#create â†’ åœ¨ store ä¸­å­˜å‚¨</p>
<p>æ ¸å¿ƒæ˜¯é€šè¿‡ä¸¤æ­¥(1): åˆ›å»º <code>ViewModelProvider</code>. (2) è°ƒç”¨ <code>ViewModelProvider</code> çš„ <code>get</code> æ–¹æ³•ä¸­è°ƒç”¨äº† <code>factory</code> çš„ <code>Create</code>ä»¥æ­¤æ¥åˆ›å»º <code>ViewModel</code>.</p>
<p>ä»¥ä¸Šç‚¹ä¸­æ ¸å¿ƒç±»æœ‰å¦‚ä¸‹å‡ ä¸ª:</p>
<p><code>ViewModelProvider</code> <code>ViewModelStore</code> <code>ViewModelStoreOwner</code> <code>Factory</code></p>
<ul>
<li>
<p><code>ViewModelProvider</code> :æœ‰ä¸‰ä¸ªç¼ºçœçš„æ„é€ æ–¹æ³•. å·²ç»ä¸¤ä¸ª <code>get</code> å‡½æ•°,å¦‚æœå­˜åœ¨å³è¿”å›, å¦‚æœä¸å­˜åœ¨, åˆ™è°ƒç”¨ <code>factory</code> è¿›è¡Œåˆ›å»º.</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å®Œæ•´æ„é€ å‡½æ•°</span>
<span class="hljs-keyword">constructor</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> store: ViewModelStore,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> factory: Factory,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> defaultCreationExtras: CreationExtras = CreationExtras.Empty,
)
  <span class="hljs-comment">// é»˜è®¤æ„é€ å‡½æ•° -&gt; åªæœ‰ ViewModelStoreOwner</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(
        owner: ViewModelStoreOwner
	    ) : <span class="hljs-keyword">this</span>(owner.viewModelStore, defaultFactory(owner), defaultCreationExtras(owner))
  <span class="hljs-comment">// ä¼ å…¥ ViewModelStoreOwner åŠ ä¸Š Factory çš„æ„é€ å‡½æ•°</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(owner: ViewModelStoreOwner, factory: Factory) : <span class="hljs-keyword">this</span>(
      owner.viewModelStore,
      factory,
      defaultCreationExtras(owner)
  )
  <span class="hljs-comment">// ç¬¦å·æ”¹å†™çš„ get æ–¹æ³•.</span>
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">get</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T {
        <span class="hljs-keyword">val</span> canonicalName = modelClass.canonicalName ?: <span class="hljs-keyword">throw</span> IllegalArgumentException(<span class="hljs-string">"Local and anonymous classes can not be ViewModels"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">get</span>(<span class="hljs-string">"<span class="hljs-variable">$DEFAULT_KEY</span>:<span class="hljs-variable">$canonicalName</span>"</span>, modelClass)
   }
  <span class="hljs-keyword">public</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T {
      <span class="hljs-keyword">val</span> viewModel = store[key]
      <span class="hljs-keyword">if</span> (modelClass.isInstance(viewModel)) {
          (factory <span class="hljs-keyword">as</span>? OnRequeryFactory)?.onRequery(viewModel!!)
          <span class="hljs-keyword">return</span> viewModel <span class="hljs-keyword">as</span> T
      } <span class="hljs-keyword">else</span> { <span class="hljs-comment">// ç©ºå®ç°.</span>
          <span class="hljs-keyword">if</span> (viewModel != <span class="hljs-literal">null</span>) {
          }
      }
      <span class="hljs-keyword">val</span> extras = MutableCreationExtras(defaultCreationExtras)
      extras[VIEW_MODEL_KEY] = key <span class="hljs-comment">// å¡å…¥ key.</span>
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
          factory.create(modelClass, extras)
      } <span class="hljs-keyword">catch</span> (e: AbstractMethodError) {
          factory.create(modelClass)
      }.also { store.put(key, it) }
  }
</code></pre>
</li>
<li>
<p><code>ViewModelStore</code> :ä¸€ä¸ªå°å»ºçš„ map. å°è£…çš„æ„ä¹‰åœ¨äº(1): æä¾›äº† clear æ–¹æ³•, æ–¹ä¾¿æ‰€æœ‰çš„ ViewModel çš„æ¸…ç©º.(2): put æ“ä½œ, å¯¹äºä¹‹å‰å­˜åœ¨ viewModel è¿›è¡Œæ¸…ç©º. clear å’Œ onCleared åˆ†åˆ«æ˜¯ç³»ç»Ÿè‡ªå·±è°ƒç”¨çš„å’Œç»™å¤–éƒ¨è°ƒç”¨çš„, clear ä¼šè°ƒç”¨éƒ½ onCleared.</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewModelStore</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> map = mutableMapOf&lt;String, ViewModel&gt;()
    
    <span class="hljs-meta">@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">put</span><span class="hljs-params">(key: <span class="hljs-type">String</span>, viewModel: <span class="hljs-type">ViewModel</span>)</span></span> {
        <span class="hljs-keyword">val</span> oldViewModel = map.put(key, viewModel)
        oldViewModel?.onCleared()
    }

    <span class="hljs-meta">@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)</span>
    <span class="hljs-keyword">operator</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(key: <span class="hljs-type">String</span>)</span></span>: ViewModel? {
        <span class="hljs-keyword">return</span> map[key]
    }
    
    <span class="hljs-meta">@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">keys</span><span class="hljs-params">()</span></span>: Set&lt;String&gt; {
        <span class="hljs-keyword">return</span> HashSet(map.keys)
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">for</span> (vm <span class="hljs-keyword">in</span> map.values) {
            vm.clear()
        }
        map.clear()
    }
}
</code></pre>
</li>
<li>
<p><code>ViewModelStoreOwner</code>: æä¾›äº†ä¸€ä¸ªè¿”å›<code>ViewModelStore</code>çš„æ¥å£. ä¹Ÿå°±æ˜¯è¯´å®ç°äº† <code>ViewModelStoreOwner</code> çš„éƒ½éœ€è¦æä¾›ç”¨æ¥å­˜å‚¨ <code>ViewModel</code> çš„é›†åˆ. è¿™æ · <code>ViewModelStoreOwner</code> éƒ½å¯ä»¥æ‹¿åˆ°å¯¹åº”å±äºè‡ªå·±çš„ <code>ViewModel</code> çš„å­˜å‚¨å¯¹è±¡.</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ViewModelStoreOwner</span> {
    <span class="hljs-keyword">val</span> viewModelStore: ViewModelStore
}
</code></pre>
</li>
<li>
<p><code>Factory</code>: æä¾›äº†åˆ›å»º <code>ViewModel</code>çš„æ–¹å¼, æ ¸å¿ƒæ–¹æ³•åœ¨ <code>Create</code> ä¸­. åœ¨ <code>ViewModelProvider</code>ä¸­æä¾›è°ƒç”¨.ä¸»è¦çš„å®ç°æœ‰: <code>NewInstanceFactory</code>(é»˜è®¤å®ç°, åªåˆ›å»ºä¸å« extra çš„ ViewModel) <code>AndroidViewModelFactory</code>æ‰¿æ‹…äº†å¤§éƒ¨åˆ†çš„åˆ›å»ºä»»åŠ¡.<code>SavedStateViewModelFactory</code> <code>ComponentActivity</code> çš„é»˜è®¤ä½¿ç”¨,å†…éƒ¨è°ƒç”¨è¿˜æ˜¯<code>AndroidViewModelFactory</code>, æä¾›äº† Application çš„ç»‘å®š.</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Factory</span> {
        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T {
            <span class="hljs-keyword">throw</span> UnsupportedOperationException(<span class="hljs-string">"Factory.create(String) is unsupported.  This Factory requires `CreationExtras` to be passed into `create` method."</span>)
        }
        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, extras: <span class="hljs-type">CreationExtras</span>)</span></span>: T = create(modelClass)
        <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
            <span class="hljs-meta">@JvmStatic</span>
            <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">from</span><span class="hljs-params">(<span class="hljs-keyword">vararg</span> initializers: <span class="hljs-type">ViewModelInitializer</span>&lt;*&gt;)</span></span>: Factory = InitializerViewModelFactory(*initializers)
        }
  }

<span class="hljs-comment">// é»˜è®¤å®ç°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NewInstanceFactory</span> : <span class="hljs-type">Factory</span> {
    <span class="hljs-meta">@Suppress(<span class="hljs-string">"DocumentExceptions"</span>)</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try</span> {
            modelClass.getDeclaredConstructor().newInstance()
        } <span class="hljs-keyword">catch</span> (e: NoSuchMethodException) {
            <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
        } <span class="hljs-keyword">catch</span> (e: InstantiationException) {
            <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
        } <span class="hljs-keyword">catch</span> (e: IllegalAccessException) {
            <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> sInstance: NewInstanceFactory? = <span class="hljs-literal">null</span>

        <span class="hljs-meta">@JvmStatic</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">val</span> instance: NewInstanceFactory
            <span class="hljs-meta">@RestrictTo(RestrictTo.Scope.LIBRARY_GROUP)</span>
            <span class="hljs-keyword">get</span>() {
                <span class="hljs-keyword">if</span> (sInstance == <span class="hljs-literal">null</span>) {
                    sInstance = NewInstanceFactory()
                }
                <span class="hljs-keyword">return</span> sInstance!!
            }

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">object</span> ViewModelKeyImpl : Key&lt;String&gt;
        <span class="hljs-meta">@JvmField</span>
        <span class="hljs-keyword">val</span> VIEW_MODEL_KEY: Key&lt;String&gt; = ViewModelKeyImpl
    }
}
<span class="hljs-comment">// å®ç°çš„ AndroidViewModel</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AndroidViewModelFactory</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">constructor</span>(
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> application: Application?,
        <span class="hljs-meta">@Suppress(<span class="hljs-string">"UNUSED_PARAMETER"</span>)</span> unused: <span class="hljs-built_in">Int</span>,
    ) : NewInstanceFactory() {

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>() : <span class="hljs-keyword">this</span>(<span class="hljs-literal">null</span>, <span class="hljs-number">0</span>)

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">constructor</span>(application: Application) : <span class="hljs-keyword">this</span>(application, <span class="hljs-number">0</span>)

        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, extras: <span class="hljs-type">CreationExtras</span>)</span></span>: T {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (application != <span class="hljs-literal">null</span>) {
                create(modelClass)
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">val</span> application = extras[APPLICATION_KEY]
                <span class="hljs-keyword">if</span> (application != <span class="hljs-literal">null</span>) {
                    create(modelClass, application)
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// For AndroidViewModels, CreationExtras must have an application set</span>
                    <span class="hljs-keyword">if</span> (AndroidViewModel::<span class="hljs-keyword">class</span>.java.isAssignableFrom(modelClass)) {
                        <span class="hljs-keyword">throw</span> IllegalArgumentException(
                            <span class="hljs-string">"CreationExtras must have an application by `APPLICATION_KEY`"</span>
                        )
                    }
                    <span class="hljs-keyword">super</span>.create(modelClass)
                }
            }
        }

        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;)</span></span>: T {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (application == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">throw</span> UnsupportedOperationException(
                    <span class="hljs-string">"AndroidViewModelFactory constructed "</span> +
                        <span class="hljs-string">"with empty constructor works only with "</span> +
                        <span class="hljs-string">"create(modelClass: Class&lt;T&gt;, extras: CreationExtras)."</span>
                )
            } <span class="hljs-keyword">else</span> {
                create(modelClass, application)
            }
        }

        <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, app: <span class="hljs-type">Application</span>)</span></span>: T {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (AndroidViewModel::<span class="hljs-keyword">class</span>.java.isAssignableFrom(modelClass)) {
                <span class="hljs-keyword">try</span> {
                    modelClass.getConstructor(Application::<span class="hljs-keyword">class</span>.java).newInstance(app)
                } <span class="hljs-keyword">catch</span> (e: NoSuchMethodException) {
                    <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
                } <span class="hljs-keyword">catch</span> (e: IllegalAccessException) {
                    <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
                } <span class="hljs-keyword">catch</span> (e: InstantiationException) {
                    <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
                } <span class="hljs-keyword">catch</span> (e: InvocationTargetException) {
                    <span class="hljs-keyword">throw</span> RuntimeException(<span class="hljs-string">"Cannot create an instance of <span class="hljs-variable">$modelClass</span>"</span>, e)
                }
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">super</span>.create(modelClass)
        }

        <span class="hljs-keyword">public</span> <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
            <span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">defaultFactory</span><span class="hljs-params">(owner: <span class="hljs-type">ViewModelStoreOwner</span>)</span></span>: Factory =
                <span class="hljs-keyword">if</span> (owner <span class="hljs-keyword">is</span> HasDefaultViewModelProviderFactory)
                    owner.defaultViewModelProviderFactory <span class="hljs-keyword">else</span> instance

            <span class="hljs-keyword">internal</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> DEFAULT_KEY = <span class="hljs-string">"androidx.lifecycle.ViewModelProvider.DefaultKey"</span>

            <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> sInstance: AndroidViewModelFactory? = <span class="hljs-literal">null</span>
            <span class="hljs-meta">@JvmStatic</span>
            <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getInstance</span><span class="hljs-params">(application: <span class="hljs-type">Application</span>)</span></span>: AndroidViewModelFactory {
                <span class="hljs-keyword">if</span> (sInstance == <span class="hljs-literal">null</span>) {
                    sInstance = AndroidViewModelFactory(application)
                }
                <span class="hljs-keyword">return</span> sInstance!!
            }

            <span class="hljs-keyword">private</span> <span class="hljs-keyword">object</span> ApplicationKeyImpl : Key&lt;Application&gt;

            <span class="hljs-meta">@JvmField</span>
            <span class="hljs-keyword">val</span> APPLICATION_KEY: Key&lt;Application&gt; = ApplicationKeyImpl
        }
    }
    
    <span class="hljs-comment">// ComponentActivity ä¸­é»˜è®¤çš„ Factory</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">SavedStateViewModelFactory</span> : <span class="hljs-type">ViewModelProvider.OnRequeryFactory</span>, <span class="hljs-type">ViewModelProvider.Factory</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> application: Application? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> factory: ViewModelProvider.Factory <span class="hljs-comment">// æŒæœ‰ä¸€ä¸ªAndroidViewModelFactory</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> defaultArgs: Bundle? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> lifecycle: Lifecycle? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> savedStateRegistry: SavedStateRegistry? = <span class="hljs-literal">null</span>

    <span class="hljs-keyword">constructor</span>() {
        factory = ViewModelProvider.AndroidViewModelFactory()
    }
    <span class="hljs-keyword">constructor</span>(
        application: Application?,
        owner: SavedStateRegistryOwner
    ) : <span class="hljs-keyword">this</span>(application, owner, <span class="hljs-literal">null</span>)
    <span class="hljs-keyword">constructor</span>(application: Application?, owner: SavedStateRegistryOwner, defaultArgs: Bundle?) {
        savedStateRegistry = owner.savedStateRegistry
        lifecycle = owner.lifecycle
        <span class="hljs-keyword">this</span>.defaultArgs = defaultArgs
        <span class="hljs-keyword">this</span>.application = application
        factory = <span class="hljs-keyword">if</span> (application != <span class="hljs-literal">null</span>) getInstance(application) <span class="hljs-keyword">else</span> ViewModelProvider.AndroidViewModelFactory()
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : ViewModel&gt;</span> <span class="hljs-title">create</span><span class="hljs-params">(modelClass: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, extras: <span class="hljs-type">CreationExtras</span>)</span></span>: T {
        <span class="hljs-keyword">val</span> key = extras[ViewModelProvider.NewInstanceFactory.VIEW_MODEL_KEY]
            ?: <span class="hljs-keyword">throw</span> IllegalStateException(<span class="hljs-string">"VIEW_MODEL_KEY must always be provided by ViewModelProvider"</span>)

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (extras[SAVED_STATE_REGISTRY_OWNER_KEY] != <span class="hljs-literal">null</span> &amp;&amp;
            extras[VIEW_MODEL_STORE_OWNER_KEY] != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">val</span> application = extras[ViewModelProvider.AndroidViewModelFactory.APPLICATION_KEY] <span class="hljs-comment">// æ‹¿åˆ° defaultViewModelCreationExtras ä¸­çš„ application</span>
            <span class="hljs-keyword">val</span> isAndroidViewModel = AndroidViewModel::<span class="hljs-keyword">class</span>.java.isAssignableFrom(modelClass) <span class="hljs-comment">// åˆ¤æ–­éœ€è¦åˆ›å»ºçš„ ViewModel æ˜¯å¦æ˜¯AndroidViewModel</span>
            <span class="hljs-keyword">val</span> <span class="hljs-keyword">constructor</span>: Constructor&lt;T&gt;? = <span class="hljs-keyword">if</span> (isAndroidViewModel &amp;&amp; application != <span class="hljs-literal">null</span>) {
                findMatchingConstructor(modelClass, ANDROID_VIEWMODEL_SIGNATURE)
            } <span class="hljs-keyword">else</span> {
                findMatchingConstructor(modelClass, VIEWMODEL_SIGNATURE)
            }
            <span class="hljs-comment">// doesn't need SavedStateHandle</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">constructor</span> == <span class="hljs-literal">null</span>) {
                <span class="hljs-keyword">return</span> factory.create(modelClass, extras) <span class="hljs-comment">// ç›´æ¥é€šè¿‡ AndroidViewModel æ¥åˆ›å»º.</span>
            }
            <span class="hljs-keyword">val</span> viewModel = <span class="hljs-keyword">if</span> (isAndroidViewModel &amp;&amp; application != <span class="hljs-literal">null</span>) {
                newInstance(modelClass, <span class="hljs-keyword">constructor</span>, application, extras.createSavedStateHandle())
            } <span class="hljs-keyword">else</span> {
                newInstance(modelClass, <span class="hljs-keyword">constructor</span>, extras.createSavedStateHandle())
            }
            viewModel
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">val</span> viewModel = <span class="hljs-keyword">if</span> (lifecycle != <span class="hljs-literal">null</span>) {
                create(key, modelClass)
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">throw</span> IllegalStateException(<span class="hljs-string">"SAVED_STATE_REGISTRY_OWNER_KEY and"</span> +
                    <span class="hljs-string">"VIEW_MODEL_STORE_OWNER_KEY must be provided in the creation extras to"</span> +
                    <span class="hljs-string">"successfully create a ViewModel."</span>)
            }
            viewModel
        }
    }
}
</code></pre>
</li>
</ul>
<h2 data-id="heading-1"><strong>2: ViewModel å’Œ Activity å¦‚ä½•å®ç°çš„ç»‘å®š? åœ¨ä»€ä¹ˆæ—¶å€™é”€æ¯?</strong></h2>
<p><code>ComponentActivity</code> å®ç°äº† <code>ViewModelStoreOwner</code> æ¥å£. æä¾›äº†å¯ä»¥ç”¨æ¥å­˜å‚¨ <code>ViewModel</code> çš„èƒ½åŠ›.</p>
<p>åœ¨ <code>ViewModel</code> åˆ›å»ºçš„æ—¶å€™å°±å­˜åœ¨äº† <code>Activity</code> çš„<code>ViewModelStore</code> ä¸­.</p>
<p>åœ¨æ”¶åˆ° <code>Activity</code> çš„<code>OnDestory</code> äº‹ä»¶çš„æ—¶å€™å°±ä¼šé”€æ¯ <code>ViewModelStore</code> ä¸­æ‰€æœ‰çš„ <code>ViewModel</code>.</p>
<h2 data-id="heading-2">3: Activity æ¢å¤çš„æ—¶å€™ ViewModel æ˜¯å¦ä¼šæ¢å¤? ä¼šæ¢å¤ä»€ä¹ˆ? SavedStateViewModelFactory æ˜¯æ€ä¹ˆç”¨çš„, å­˜äº†äº›ä»€ä¹ˆæ¢å¤äº†äº›ä»€ä¹ˆ? ä»€ä¹ˆæƒ…å†µä¸‹æ¢å¤. viewModelStore ä¸­å­˜çš„ viewModel æ—¢ç„¶ä¹‹å onDestroy çš„æ—¶å€™æ‰ä¼šè¢«é”€æ¯, é‚£é¡µé¢ä¸“å‘ä¼šonDestroyå—? å¦‚æœä¼šæ˜¯æ€ä¹ˆæ¢å¤çš„, å¦‚æœä¸ä¼š,é‚£ä»€ä¹ˆæƒ…å†µä¸‹æ‰ä¼šè¢«é”€æ¯, ä»€ä¹ˆæƒ…å†µä¸‹ SavedStateRegisteræ‰èƒ½ç”¨ä¸Š.?</h2>
<p>!! ç”± é¡µé¢é‡æ–°æ—‹è½¬å¯¼è‡´çš„é¡µé¢é‡ç»˜æ˜¯ä¸ä¼šè®©ViewModelOwner å­˜å‚¨çš„ viewModel æ¸…ç©º,å› ä¸ºåœ¨ componentActivity å¤„ç† viewModelStore çš„æ¸…ç©ºçš„æ—¶å€™æ˜¯æœ‰ä¸“é—¨åˆ¤æ–­æ˜¯å¦æ˜¯ä» changingConfiguration æ¥çš„.</p>
<p>ç”¨æ³•:</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">xxViewModle</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> application: Application, <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> handle: SaveStatehandle): 
		AndroidViewModel(application){
		<span class="hljs-keyword">val</span> query: LiveData&lt;String&gt; = handle.getLiveData(<span class="hljs-string">"query"</span>, <span class="hljs-string">""</span>)
		
		<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setQuery</span><span class="hljs-params">(value: <span class="hljs-type">String</span>)</span></span>{
				handle[<span class="hljs-string">"query"</span>] = q
		}
		
		<span class="hljs-comment">// åœ¨é¦–æ¬¡è°ƒç”¨ setQuery("123"), è¿›ç¨‹å¼‚å¸¸æ¢å¤ä¹‹å,å“ªèƒ½æ‹¿åˆ° query çš„ç›‘å¬å›è°ƒ.</span>
}
</code></pre>
<p>(1): SavedStateHandle çš„å­˜(<code>handle["query"]</code>)å’Œå–(<code>handle.getLiveData("query", "")</code>)æ˜¯å¦‚ä½•å®ç°?</p>
<p><code>handle</code> â†’ SaveStateHandle set() å­˜å…¥çš„ LiveData/Flow.</p>
<p><strong>è¿›ç¨‹é”€æ¯çš„æ—¶å€™å­˜</strong> â†’ <code>savedStateProvider</code> å– <code>regular</code></p>
<p><strong>åˆæ¬¡æœ‰å€¼</strong> â†’ SavedStateOwner è°ƒç”¨ <code>SavedStateRegistry</code> performRestore å­˜å…¥åˆ°<code>SavedStateRegistry</code> å†…éƒ¨ <code>restoredState</code> ä¸­, <code>consumeRestoredStateForKey</code> å°±å¯ä»¥æ‹¿åˆ°. åœ¨ <code>SevedStateViewModelFactory</code> <code>create</code> å°±å·²ç»ç”Ÿæˆäº†, ç„¶åé€šè¿‡æ„é€ å‡½æ•°çš„æ–¹å¼ä¼ å…¥äº† SavedStateHandle.</p>
<p>(2): ä¸ºä»€ä¹ˆå¯ä»¥ç»™æ„é€ å‡½æ•°å¡å…¥ <code>SaveStatehandle</code>å¹¶ç”Ÿæ•ˆçš„.</p>
<p>ç¡®å®š ComponentActivity ä½¿ç”¨çš„æ˜¯ <code>SavedStateViewModelFactory</code>. <code>SavedStateViewModelFactory</code> è‡ªå·±å†…éƒ¨å…¶å®ä»£ç†äº† ApplicationFactory çš„ Instance, åœ¨è°ƒç”¨ä»–çš„ <code>create</code> æ—¶å€™, å…ˆé€šè¿‡ viewModel çš„ç­¾ååˆ¤æ–­æ˜¯å¦éœ€è¦ SavedStateHandel çš„æ„é€ å‡½æ•°, å¦‚æœä¸éœ€è¦å°±æŒ‰ç…§ä¹‹å‰çš„é€»è¾‘è¿›è¡Œåˆ†, ä½¿ç”¨ ApplicationFactory æˆ–è€… SingleInstanceFactory. å¦‚æœéœ€è¦ SavedStateHandel åˆ™é€šè¿‡ Extras æ‹¿åˆ° SavedStateHandel å¯¹åº”çš„å‚æ•°, LifeCycleOwner, SavedStateRegistryOwner. è¿™æ ·å°±æŠŠ SavedStateHandle ä¼ å…¥è¿›å»äº†.</p>
<p>(3): å…·æœ‰å­˜å‚¨èƒ½åŠ›çš„ <code>SavedStateViewModelFactory</code> æ˜¯å¦‚ä½•å·¥ä½œçš„, å“ªäº›åœºæ™¯åœ¨ä¼šç”¨åˆ° <code>SavedStateViewModelFactory</code></p>
<p>ç†è®ºä¸Šå…·æœ‰æ•°æ®æ¢å¤èƒ½åŠ›çš„ä½ç½®, componentActivity/ Fragment, éƒ½ç”¨åˆ°äº† <code>SavedStateViewModelFactory</code></p>
<p>ä¸»è¦æ˜¯æä¾›äº† <code>SaveStatehandle</code> æ„é€ å‡½æ•°,å¯ä»¥ç”¨æ¥å­˜å‚¨å¼‚å¸¸åˆ é™¤çš„æ•°æ®. å…·ä½“çš„æ¢å¤å’Œå­˜å…¥é€»è¾‘æ˜¯ç”±äº <code>SavedStateRigistryOwner</code>æä¾›çš„. <code>SaveStatehandle</code> ä¸»è¦å®ç°äº†(1): åˆå§‹çš„æ—¶å€™æ‹¿åˆ°æ•°æ®. (2) æä¾›äº† SavedStateProvider çš„å­˜å‚¨æ¥å£, (3): å°†å†…éƒ¨æ•°æ®å˜ä¸º <code>Flow</code>/ <code>LiveData</code> çš„èƒ½åŠ›.</p>
<h2 data-id="heading-3">4: ViewModel å¦‚ä½•å®ç°è‡ªå®šä¹‰ä¼ å‚?</h2>
<ul>
<li>
<p>æ ¸å¿ƒæ˜¯é€šè¿‡InitializerViewModelFactoryå®ç°,InitializerViewModelFactory çš„ Create å‡½æ•°, ä¼šéå†è‡ªå·±çš„ViewModelInitializeræ„é€ å‡½æ•°, æ¥åˆ›å»º ViewModel, è€Œ viewModelFactory æ‰©å±•å‡½æ•°, çš„å‚æ•°æ˜¯ä¸€ä¸ª <code>InitializerViewModelFactoryBuilder</code> çš„æ‰©å±•å‡½æ•°, <code>InitializerViewModelFactoryBuilder</code> ä¸­åˆæä¾›äº† <code>addInitializer</code> çš„èƒ½åŠ›, <code>addInitializer</code> çš„å‚æ•°æ˜¯ ç±»åå’Œåˆ›å»º ViewModel çš„<code>initializer</code> å‡½æ•°, <code>initializer</code> åˆæ˜¯ <code>CreationExtras</code> çš„æ‰©å±•å‡½æ•°,</p>
<p>â‡’ æœ€åå°±å½¢æˆäº†è¿™æ ·çš„å½¢å¼. æœ€åä¹Ÿå°±æ˜¯è‡ªå®šä¹‰ factory , è‡ªå®šä¹‰ extras, æ¥å®ç°åˆ›å»ºè¿‡ç¨‹.</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> factory = viewModelFactory {
	initializer { <span class="hljs-comment">// CreationExtras çš„æ‰©å±•å‡½æ•°, å¯ä»¥æ‹¿åˆ° key.</span>
	  TestViewModel(<span class="hljs-keyword">this</span>[key]) 
	}
}
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å®šä¹‰ key</span>
<span class="hljs-keyword">object</span> IdKey: CreateExtras.Key&lt;<span class="hljs-built_in">Int</span>&gt;
<span class="hljs-keyword">object</span> NameKey: CreateExtras.key&lt;String&gt;
<span class="hljs-comment">// å®šä¹‰ ViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TestViewModel</span>(<span class="hljs-keyword">val</span> id: <span class="hljs-built_in">Int</span>, <span class="hljs-keyword">val</span> name: String): ViewModel()
<span class="hljs-comment">// åˆ›å»º Factory</span>
<span class="hljs-keyword">val</span> factory = viewModelFactory{
	initializer{
		<span class="hljs-keyword">val</span> id = <span class="hljs-keyword">this</span>[IdKey]?:error(<span class="hljs-string">"id error."</span>)
		<span class="hljs-keyword">val</span> name = <span class="hljs-keyword">this</span>[NameKey]?:error(<span class="hljs-string">"name error."</span>)
		TestViewModel(id, name)
	}
}
<span class="hljs-comment">// åˆ›å»º extras</span>
<span class="hljs-keyword">val</span> extras = MutableCreationExtras().apply{
   <span class="hljs-keyword">this</span>[IdKey] = <span class="hljs-number">1</span>
   <span class="hljs-keyword">this</span>[NameKey] = <span class="hljs-string">"Tom"</span>
}
<span class="hljs-comment">// åˆ›å»º viewModel</span>
<span class="hljs-keyword">val</span> viewModel: TestViewModel = factory.create(TestViewModel::<span class="hljs-keyword">class</span>, extras)
</code></pre>
</li>
</ul>
<h2 data-id="heading-4">5: ViewModel å’Œ AndroidViewModel çš„åŒºåˆ«?</h2>
<p>ä¸¤è€…æ˜¯å¦å…·æœ‰ Application. ViewModel æ˜¯é€šè¿‡ NewInstanceFactory æ¥æ„é€ çš„. AndroidViewModel æ˜¯é€šè¿‡ AndroidViewModelFactory æ¥æ„é€ çš„.</p>
<h2 data-id="heading-5">6: Activity çš„ ViewModel å’Œ Fragment çš„ ViewModel å¦‚ä½•å…±äº«?æ˜¯å¦å¯ä»¥å…±äº«?</h2>
<p>ViewModel å­˜å‚¨çš„ä½ç½®: <code>ViewModelOwner</code> çš„ <code>viewModelStore</code> ä¸­, æä¾›äº† <code>put</code>/<code>get</code>/<code>clean</code>æ–¹æ³•. æ‰€ä»¥ <code>Activity</code> å’Œ <code>Fragment</code> çš„ <code>viewModel</code> æ˜¯å¦å¯ä»¥å…±ç”¨ å–å†³äºä½¿ç”¨çš„æ˜¯å¦æ˜¯åŒä¸€ä¸ª <code>ViewModelOwner</code>çš„ <code>viewModelStore</code></p>
<p>Activity â†’ Fragment. Fragment å¯ä»¥æ‹¿åˆ° Activity çš„å¼•ç”¨, åˆ¤æ–­æ˜¯å¦æ˜¯ ViewModelOwner, å¦‚æœæ˜¯çš„è¯, ç›´æ¥é€šè¿‡ æ„é€  ViewModelProvider, è°ƒç”¨ Get æ–¹æ³•å°±å¯ä»¥æ‹¿åˆ°.</p>
<p>Fragment â†’ Activity. é€šè¿‡ FragmentManager çš„ findById çš„æ–¹å¼æ‹¿åˆ° Fragment,ç„¶åé€šè¿‡å’Œä¸Šé¢ä¸€æ ·çš„æ–¹å¼æ¥è·å–</p>
<h2 data-id="heading-6">7: Fragment çš„ ViewModel å’Œ Activity ViewModelæœ‰å’Œä¸åŒ?</h2>
<p>ä½¿ç”¨çš„ ViewModelOwner ä¸åŒ â†’ ViewModelStoreä¸åŒ</p>
<ul>
<li>
<p>(1) ä¸ºä»€ä¹ˆ ViewModelProvider éœ€è¦ ViewModelOwner ä½œä¸ºæ„é€ å‡½æ•°,å†…éƒ¨åªä½¿ç”¨äº† ViewModelStore</p>
<p>a: ç»™äº† ViewModelOwner å°±å¯ä»¥æ–¹ä¾¿çš„æ‹¿åˆ° ViewModelStore</p>
<p>b: ç»™äº† ViewModelOwner ç­‰äºç»™äº† Activity çš„å¼•ç”¨å°±å¯ä»¥é€šè¿‡ HasDefaultViewModelProviderFactory å€Ÿå£æ‹¿åˆ° ViewModelOwner åˆ¶å®šçš„ Factory/Extras, Activity/Fragment éƒ½æ˜¯ä½¿ç”¨è¿™ä¸ªé€»è¾‘æ¥å®ç°äº† SavedStateViewModelFactory.</p>
</li>
<li>
<p>(2) ViewModeStore è¿˜æœ‰ä»€ä¹ˆç‰¹æ®Šé€»è¾‘?</p>
<p>ViewModeStore åªæ˜¯ä¸€ä¸ªåŒ…è£…çš„ map, æä¾›äº† set/get/clean çš„èƒ½åŠ›. ä½†æ˜¯éœ€è¦ activity/fragment åœ¨ onDestroy è°ƒç”¨ clean çš„æ—¶å€™éƒ½ä¼šåˆ¤æ–­æ˜¯å¦å› ä¸ºå› ä¸ºé…ç½®ä¿®æ”¹å¯¼è‡´çš„.</p>
</li>
<li>
<p>(3) ViewModel è‡ªå·±æœ‰ä»€ä¹ˆç‰¹æ®Šé€»è¾‘?</p>
<p>æä¾›äº† setTag å’Œ clean çš„é€»è¾‘.</p>
</li>
</ul>
<h2 data-id="heading-7">8: å¸¸ç”¨çš„ ViewModel ä¹‹é—´çš„å·®å¼‚? å¸¸ç”¨çš„ Factory æœ‰å“ªäº›, å·®å¼‚æ˜¯ä»€ä¹ˆ?</h2>
<p>å¸¸ç”¨çš„ ViewModel åªæœ‰ä¸¤ä¸ª ViewModel/AndroidViewModel. AndroidViewModel ç»§æ‰¿ ViewModel, å·®å¼‚åªæ˜¯ AndroidViewModel å¤šäº†ä¸€ä¸ªæ„é€ å‡½æ•°.</p>
<p>å¸¸ç”¨çš„ Factory æœ‰: NewInstanceFactory/AndroidViewModelFactory/SavedStateViewModelFactory/InitializerViewModelFactory</p>
<ul>
<li>
<p>(1) NewInstanceFactory</p>
<p>ç”¨é€”: å¼‚å¸¸æƒ…å†µä¸‹çš„å…œåº•. åªèƒ½åˆ›å»ºä¸€ä¸ªç©ºçš„æ— å‚æ•°çš„æ„é€ æ–¹æ³•</p>
<p>åªå®ç°äº†å‚æ•°æ˜¯ç±»å‹åç§°çš„æ„é€ æ–¹æ³•. å¸¦ Extras çš„éƒ½æ²¡æœ‰å®ç°. åŸºæœ¬å¾ˆå°‘ç”¨.</p>
</li>
<li>
<p>(2) AndroidViewModelFactory</p>
<p>ç”¨é€”: ç”¨æ¥åˆ›å»ºä¸€ä¸ª application çš„ AndroidViewModel. å¼‚å¸¸æƒ…å†µä¸‹å†å°è¯•è°ƒç”¨çˆ¶ç±»åˆ›å»ºæ— å‚çš„ ViewModel</p>
<p>æ³¨æ„ç‚¹: a: ä¸¤ä¸ª Crate æ–¹æ³•éƒ½æœ‰å®ç°. b: application æœ‰ä¸¤ä¸ªæ¥æº, æ„é€ å‡½æ•°å¯ä»¥ç©¿, é€šè¿‡ Extras ä¹Ÿå¯ä»¥æºå¸¦.éƒ½æ˜¯é€šè¿‡åå°„çš„æ–¹å¼åˆ›å»ºçš„.</p>
</li>
<li>
<p>(3) SavedStateViewModelFactory</p>
<p>ç”¨é€”: ComponentActivity å’Œ Fragment çš„é»˜è®¤ Factory. å®ç°æ•°æ®çš„å­˜å‚¨å’Œæ¢å¤.</p>
<p>æ³¨æ„ç‚¹: (a): å¦‚æœä½¿ç”¨æ— å‚æ•°çš„æ„é€ å‡½æ•°, é»˜è®¤ç”¨çš„å°±æ˜¯ AndroidViewModelFactory</p>
<p>(b): å†…éƒ¨ä¼šæŒæœ‰ä¸€ä¸ª factory â†’ AndroidViewModelFactory, æ¥åšå…·ä½“çš„åˆ›å»º</p>
<p>(c): å¸Œæœ›ä¼ å…¥ä¸€ä¸ª SavedStateRegistryOwner, ä»å®¿ä¸»æ‹¿åˆ°ç¼“å­˜çš„æ•°æ®å·²ç»ç¼“å­˜çš„èƒ½åŠ›.</p>
<p>(d): ViewModel çš„æ„é€ å‡½æ•°æ”¯æŒä¸€ä¸ªé¢å¤–çš„å‚æ•°: SavedStateHandle, æ¥æ“ä½œ SavedStateRegistryOwner ä¸­æ‹¿åˆ°çš„æ•°æ®, å·²ç»ä¿å­˜çš„æ•°æ®.</p>
<p>(e): SavedStateHandle æä¾›äº†æ¢å¤çš„æ•°æ®è½¬æˆ LiveDate/StateFlow çš„èƒ½åŠ›, å·²ç»ä¿®æ”¹çš„åŒ…è£….</p>
</li>
<li>
<p>(4) InitializerViewModelFactory</p>
<p>ç”¨é€”: æä¾›è‡ªå®šä¹‰å…¥å‚çš„ ViewModel çš„å®ç°.</p>
<p>æ³¨æ„ç‚¹: (a:)InitializerViewFactoryä¸­æŒæœ‰ä¸€ç»„åˆ›å»ºè§„åˆ™, class â†’ CreationExtras.() â‡’ T, ä½¿ç”¨ç¬¦åˆè§„åˆ™çš„åˆ›å»ºå‡½æ•°æ¥åˆ›å»º ViewModel.</p>
<p>(b): åˆ›å»ºå‡½æ•°æ˜¯ CreationExtras.çš„æ‰©å±•å‡½æ•°,è¿™æ ·æ›´æ–¹ä¾¿å–æ•°.</p>
</li>
</ul>
<h2 data-id="heading-8">9: CreationExtras.Key æ¯” Map&lt;String, Any&gt; å¥½åœ¨å“ªé‡Œ?</h2>
<p>(1) åŸºäºæ³›å‹ â†’ ç±»å‹å¯æ¨å¯¼</p>
<p><code>object IdKey : CreationExtras.Key&lt;Int&gt;</code> <code>val id: Int = extras[IdKey] *// âœ… ç¼–è¯‘æœŸä¿è¯ Int*</code></p>
<p><code>val id = map["id"] as Int</code> map å°±åšä¸åˆ°.</p>
<p>(2) <strong>é¿å…ã€Œå­—ç¬¦ä¸²å‘½åå†²çªã€</strong></p>
<p><code>map["id"] = 1 *// A æ¨¡å—* map["id"] = "xxx" *// B æ¨¡å—ï¼ˆæ— æ„Ÿè¦†ç›–ï¼‰*</code></p>
<p><code>object UserIdKey : CreationExtras.Key&lt;Int&gt;</code> <code>object OrderIdKey : CreationExtras.Key&lt;Long&gt;</code></p>
<h2 data-id="heading-9">10: å­˜åœ¨å“ªäº›å¥½çš„è®¾è®¡æ¨¡å¼?</h2>
<p>(1): åˆ›å»ºéƒ½é€šè¿‡ ViewModelOwner æ¥, è®© ViewModel éƒ½å’ŒOwner è¿›è¡Œç»‘å®š. Owner åŒæ—¶ä¹Ÿæ˜¯ LifecycleOwner, è¿™æ ·æ–¹ä¾¿å’Œ Lifecycle è¿›è¡Œå…³è”.</p>
<p>(2): åˆ›å»º HasDefaultViewModelProviderFactoryæ¥å£. è¿™æ ·å°±éœ€è¦æŠŠç±»åå¤ä¼ è¾“, å°±å¯ä»¥ä½¿ç”¨ Owner è‡ªå·±çš„ Factory æ¥å®ç°å®šåˆ¶åŠŸèƒ½.</p>
<p>(3): ç»“åˆ SavedStateRegistryOwner æ¥å®ç°å­˜å‚¨èƒ½åŠ›. å°†å­˜å‚¨èƒ½åŠ›å¤Ÿæš´éœ²ç»™äº† SavedStateHandle ç±».</p>
<p>(4): SavedStateHandle å°†æ•°æ®è½¬ä¸º LiveData/Flow, åŒæ—¶è¿›è¡Œäº†è½¬å‘, è®©ä½¿ç”¨æ–¹å¯ä»¥å®Œå…¨å¿½ç•¥ä¿å­˜å’Œè·å–çš„ç»†èŠ‚.</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android è§‚å¯Ÿè€…æ¨¡å¼æµ…æ]]></title>    <link>https://juejin.cn/post/7601077764424220722</link>    <guid>https://juejin.cn/post/7601077764424220722</guid>    <pubDate>2026-01-31T11:59:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601077764424220722" data-draft-id="7601077764423729202" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android è§‚å¯Ÿè€…æ¨¡å¼æµ…æ"/> <meta itemprop="keywords" content="Android,è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2026-01-31T11:59:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Yen"/> <meta itemprop="url" content="https://juejin.cn/user/4037062426633214"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android è§‚å¯Ÿè€…æ¨¡å¼æµ…æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4037062426633214/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Yen
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T11:59:24.000Z" title="Sat Jan 31 2026 11:59:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€åŸºæœ¬æ¦‚å¿µ</h2>
<h3 data-id="heading-1">å®šä¹‰</h3>
<p><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>å®šä¹‰äº†ä¸€ç§<strong>ä¸€å¯¹å¤š</strong>çš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡ï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡ï¼ˆè§‚å¯Ÿè€…ï¼‰éƒ½ä¼šå¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒæ€æƒ³</h3>
<ol>
<li><strong>å‘å¸ƒ-è®¢é˜…</strong>ï¼šè¢«è§‚å¯Ÿè€…å‘å¸ƒäº‹ä»¶ï¼Œè§‚å¯Ÿè€…è®¢é˜…äº‹ä»¶</li>
<li><strong>æ¾è€¦åˆ</strong>ï¼šè§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä¹‹é—´æ˜¯æ¾è€¦åˆçš„</li>
<li><strong>è‡ªåŠ¨é€šçŸ¥</strong>ï¼šè¢«è§‚å¯Ÿè€…çŠ¶æ€å˜åŒ–æ—¶è‡ªåŠ¨é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…</li>
</ol>
<h3 data-id="heading-3">åº”ç”¨åœºæ™¯</h3>
<ul>
<li>äº‹ä»¶å¤„ç†ç³»ç»Ÿ</li>
<li>æ•°æ®ç»‘å®š</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>GUIäº‹ä»¶ç›‘å¬</li>
<li>MVC/MVVMæ¶æ„ä¸­çš„æ¨¡å‹-è§†å›¾é€šä¿¡</li>
</ul>
<h2 data-id="heading-4">äºŒã€åŸºæœ¬ç»“æ„</h2>
<h3 data-id="heading-5">å››ä¸ªæ ¸å¿ƒè§’è‰²</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. Subject (è¢«è§‚å¯Ÿè€…æ¥å£)</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Subject</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">registerObserver</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>)</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">removeObserver</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>)</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">notifyObservers</span><span class="hljs-params">()</span></span>
}

<span class="hljs-comment">// 2. ConcreteSubject (å…·ä½“è¢«è§‚å¯Ÿè€…)</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherStation</span> : <span class="hljs-type">Subject</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> observers = mutableListOf&lt;Observer&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> temperature: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0f</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> humidity: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0f</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> pressure: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0f</span>
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">registerObserver</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>)</span></span> {
        <span class="hljs-keyword">if</span> (!observers.contains(observer)) {
            observers.add(observer)
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">removeObserver</span><span class="hljs-params">(observer: <span class="hljs-type">Observer</span>)</span></span> {
        observers.remove(observer)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">notifyObservers</span><span class="hljs-params">()</span></span> {
        observers.forEach { observer -&gt;
            observer.update(temperature, humidity, pressure)
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setMeasurements</span><span class="hljs-params">(temperature: <span class="hljs-type">Float</span>, humidity: <span class="hljs-type">Float</span>, pressure: <span class="hljs-type">Float</span>)</span></span> {
        <span class="hljs-keyword">this</span>.temperature = temperature
        <span class="hljs-keyword">this</span>.humidity = humidity
        <span class="hljs-keyword">this</span>.pressure = pressure
        measurementsChanged()
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">measurementsChanged</span><span class="hljs-params">()</span></span> {
        notifyObservers()
    }
    
    <span class="hljs-comment">// å…¶ä»–ä¸šåŠ¡æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getTemperature</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Float</span> = temperature
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getHumidity</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Float</span> = humidity
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getPressure</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Float</span> = pressure
}

<span class="hljs-comment">// 3. Observer (è§‚å¯Ÿè€…æ¥å£)</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observer</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">update</span><span class="hljs-params">(temperature: <span class="hljs-type">Float</span>, humidity: <span class="hljs-type">Float</span>, pressure: <span class="hljs-type">Float</span>)</span></span>
}

<span class="hljs-comment">// 4. ConcreteObserver (å…·ä½“è§‚å¯Ÿè€…)</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CurrentConditionsDisplay</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> subject: Subject) : Observer {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> temperature: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0f</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> humidity: <span class="hljs-built_in">Float</span> = <span class="hljs-number">0f</span>
    
    <span class="hljs-keyword">init</span> {
        subject.registerObserver(<span class="hljs-keyword">this</span>)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">update</span><span class="hljs-params">(temperature: <span class="hljs-type">Float</span>, humidity: <span class="hljs-type">Float</span>, pressure: <span class="hljs-type">Float</span>)</span></span> {
        <span class="hljs-keyword">this</span>.temperature = temperature
        <span class="hljs-keyword">this</span>.humidity = humidity
        display()
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">display</span><span class="hljs-params">()</span></span> {
        println(<span class="hljs-string">"å½“å‰æ¸©åº¦: <span class="hljs-subst">${temperature}</span>â„ƒ, æ¹¿åº¦: <span class="hljs-subst">${humidity}</span>%"</span>)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">unsubscribe</span><span class="hljs-params">()</span></span> {
        subject.removeObserver(<span class="hljs-keyword">this</span>)
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">StatisticsDisplay</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> subject: Subject) : Observer {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> temperatures = mutableListOf&lt;<span class="hljs-built_in">Float</span>&gt;()
    
    <span class="hljs-keyword">init</span> {
        subject.registerObserver(<span class="hljs-keyword">this</span>)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">update</span><span class="hljs-params">(temperature: <span class="hljs-type">Float</span>, humidity: <span class="hljs-type">Float</span>, pressure: <span class="hljs-type">Float</span>)</span></span> {
        temperatures.add(temperature)
        display()
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">display</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">val</span> avg = temperatures.average()
        <span class="hljs-keyword">val</span> max = temperatures.maxOrNull() ?: <span class="hljs-number">0f</span>
        <span class="hljs-keyword">val</span> min = temperatures.minOrNull() ?: <span class="hljs-number">0f</span>
        println(<span class="hljs-string">"æ¸©åº¦ç»Ÿè®¡: å¹³å‡=<span class="hljs-subst">${<span class="hljs-string">"%.1f"</span>.format(avg)}</span>â„ƒ, æœ€é«˜=<span class="hljs-variable">$max</span>â„ƒ, æœ€ä½=<span class="hljs-variable">$min</span>â„ƒ"</span>)
    }
}

<span class="hljs-comment">// å®¢æˆ·ç«¯ä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> weatherStation = WeatherStation()
    <span class="hljs-keyword">val</span> currentDisplay = CurrentConditionsDisplay(weatherStation)
    <span class="hljs-keyword">val</span> statsDisplay = StatisticsDisplay(weatherStation)
    
    <span class="hljs-comment">// æ¨¡æ‹Ÿå¤©æ°”æ•°æ®å˜åŒ–</span>
    weatherStation.setMeasurements(<span class="hljs-number">25f</span>, <span class="hljs-number">65f</span>, <span class="hljs-number">1013f</span>)
    weatherStation.setMeasurements(<span class="hljs-number">26f</span>, <span class="hljs-number">70f</span>, <span class="hljs-number">1012f</span>)
    weatherStation.setMeasurements(<span class="hljs-number">24f</span>, <span class="hljs-number">90f</span>, <span class="hljs-number">1014f</span>)
    
    <span class="hljs-comment">// å–æ¶ˆè®¢é˜…</span>
    currentDisplay.unsubscribe()
    weatherStation.setMeasurements(<span class="hljs-number">23f</span>, <span class="hljs-number">85f</span>, <span class="hljs-number">1015f</span>) <span class="hljs-comment">// currentDisplayä¸ä¼šæ”¶åˆ°é€šçŸ¥</span>
}
</code></pre>
<h2 data-id="heading-6">ä¸‰ã€Androidä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼å®ç°</h2>
<h3 data-id="heading-7">1. LiveData - Androidæ¶æ„ç»„ä»¶</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ViewModel</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-comment">// MutableLiveData æ˜¯è¢«è§‚å¯Ÿè€…</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _userName = MutableLiveData&lt;String&gt;()
    
    <span class="hljs-comment">// LiveData æ˜¯è§‚å¯Ÿè€…å¯ä»¥è§‚å¯Ÿçš„ä¸å¯å˜ç‰ˆæœ¬</span>
    <span class="hljs-keyword">val</span> userName: LiveData&lt;String&gt; = _userName
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _userAge = MutableLiveData&lt;<span class="hljs-built_in">Int</span>&gt;()
    <span class="hljs-keyword">val</span> userAge: LiveData&lt;<span class="hljs-built_in">Int</span>&gt; = _userAge
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _loading = MutableLiveData&lt;<span class="hljs-built_in">Boolean</span>&gt;()
    <span class="hljs-keyword">val</span> loading: LiveData&lt;<span class="hljs-built_in">Boolean</span>&gt; = _loading
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _error = MutableLiveData&lt;String?&gt;()
    <span class="hljs-keyword">val</span> error: LiveData&lt;String?&gt; = _error
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUserData</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span> {
        viewModelScope.launch {
            _loading.value = <span class="hljs-literal">true</span>
            _error.value = <span class="hljs-literal">null</span>
            
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">val</span> user = userRepository.getUser(userId)
                _userName.value = user.name
                _userAge.value = user.age
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                _error.value = e.message
            } <span class="hljs-keyword">finally</span> {
                _loading.value = <span class="hljs-literal">false</span>
            }
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateUserName</span><span class="hljs-params">(name: <span class="hljs-type">String</span>)</span></span> {
        _userName.value = name
    }
}

<span class="hljs-comment">// Activity/Fragmentä¸­è§‚å¯Ÿ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> viewModel: UserViewModel
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> binding: ActivityUserBinding
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        binding = ActivityUserBinding.inflate(layoutInflater)
        setContentView(binding.root)
        
        viewModel = ViewModelProvider(<span class="hljs-keyword">this</span>)[UserViewModel::<span class="hljs-keyword">class</span>.java]
        
        <span class="hljs-comment">// è§‚å¯Ÿç”¨æˆ·åå˜åŒ–</span>
        viewModel.userName.observe(<span class="hljs-keyword">this</span>) { name -&gt;
            binding.tvUserName.text = name
            binding.etUserName.setText(name)
        }
        
        <span class="hljs-comment">// è§‚å¯Ÿç”¨æˆ·å¹´é¾„å˜åŒ–</span>
        viewModel.userAge.observe(<span class="hljs-keyword">this</span>) { age -&gt;
            binding.tvUserAge.text = age.toString()
        }
        
        <span class="hljs-comment">// è§‚å¯ŸåŠ è½½çŠ¶æ€</span>
        viewModel.loading.observe(<span class="hljs-keyword">this</span>) { isLoading -&gt;
            binding.progressBar.isVisible = isLoading
            binding.btnSave.isEnabled = !isLoading
        }
        
        <span class="hljs-comment">// è§‚å¯Ÿé”™è¯¯ä¿¡æ¯</span>
        viewModel.error.observe(<span class="hljs-keyword">this</span>) { errorMessage -&gt;
            errorMessage?.let {
                Toast.makeText(<span class="hljs-keyword">this</span>, it, Toast.LENGTH_SHORT).show()
            }
        }
        
        <span class="hljs-comment">// æŒ‰é’®ç‚¹å‡»æ›´æ–°æ•°æ®</span>
        binding.btnSave.setOnClickListener {
            <span class="hljs-keyword">val</span> name = binding.etUserName.text.toString()
            viewModel.updateUserName(name)
        }
        
        <span class="hljs-comment">// åŠ è½½ç”¨æˆ·æ•°æ®</span>
        <span class="hljs-keyword">val</span> userId = intent.getStringExtra(EXTRA_USER_ID) ?: <span class="hljs-string">"1"</span>
        viewModel.loadUserData(userId)
    }
}

<span class="hljs-comment">// è‡ªå®šä¹‰LiveDataç¤ºä¾‹</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConnectivityLiveData</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> context: Context) : LiveData&lt;<span class="hljs-built_in">Boolean</span>&gt;() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> connectivityManager = 
        context.getSystemService(Context.CONNECTIVITY_SERVICE) <span class="hljs-keyword">as</span> ConnectivityManager
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> networkCallback = <span class="hljs-keyword">object</span> : ConnectivityManager.NetworkCallback() {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onAvailable</span><span class="hljs-params">(network: <span class="hljs-type">Network</span>)</span></span> {
            postValue(<span class="hljs-literal">true</span>)
        }
        
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onLost</span><span class="hljs-params">(network: <span class="hljs-type">Network</span>)</span></span> {
            postValue(<span class="hljs-literal">false</span>)
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onActive</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onActive()
        <span class="hljs-comment">// æ³¨å†Œç½‘ç»œçŠ¶æ€å›è°ƒ</span>
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.N) {
            connectivityManager.registerDefaultNetworkCallback(networkCallback)
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å…¼å®¹æ—§ç‰ˆæœ¬å®ç°</span>
            <span class="hljs-keyword">val</span> networkInfo = connectivityManager.activeNetworkInfo
            postValue(networkInfo?.isConnected == <span class="hljs-literal">true</span>)
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onInactive</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onInactive()
        <span class="hljs-comment">// æ³¨é”€å›è°ƒ</span>
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.N) {
            connectivityManager.unregisterNetworkCallback(networkCallback)
        }
    }
}
</code></pre>
<h3 data-id="heading-8">2. Viewçš„ç‚¹å‡»äº‹ä»¶ç›‘å¬</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Androidä¸­Viewçš„äº‹ä»¶ç›‘å¬æ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„å…¸å‹åº”ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        
        <span class="hljs-keyword">val</span> button = findViewById&lt;Button&gt;(R.id.my_button)
        <span class="hljs-keyword">val</span> textView = findViewById&lt;TextView&gt;(R.id.my_text)
        <span class="hljs-keyword">val</span> editText = findViewById&lt;EditText&gt;(R.id.my_edit)
        
        <span class="hljs-comment">// 1. ä¼ ç»Ÿçš„è§‚å¯Ÿè€…æ¨¡å¼å®ç°</span>
        button.setOnClickListener(<span class="hljs-keyword">object</span> : View.OnClickListener {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onClick</span><span class="hljs-params">(v: <span class="hljs-type">View</span>?)</span></span> {
                Toast.makeText(<span class="hljs-keyword">this</span><span class="hljs-symbol">@MyActivity</span>, <span class="hljs-string">"æŒ‰é’®è¢«ç‚¹å‡»"</span>, Toast.LENGTH_SHORT).show()
            }
        })
        
        <span class="hljs-comment">// 2. Kotlin Lambdaç®€åŒ–</span>
        button.setOnClickListener {
            textView.text = <span class="hljs-string">"æŒ‰é’®è¢«ç‚¹å‡»äº†"</span>
        }
        
        <span class="hljs-comment">// 3. æ·»åŠ å¤šä¸ªè§‚å¯Ÿè€…ï¼ˆç›‘å¬å™¨ï¼‰</span>
        button.setOnClickListener {
            Log.d(<span class="hljs-string">"MyActivity"</span>, <span class="hljs-string">"ç¬¬ä¸€ä¸ªç›‘å¬å™¨"</span>)
        }
        
        <span class="hljs-comment">// æ³¨æ„ï¼šè¿™ç§æ–¹å¼ä¼šæ›¿æ¢å‰ä¸€ä¸ªç›‘å¬å™¨</span>
        button.setOnClickListener {
            Log.d(<span class="hljs-string">"MyActivity"</span>, <span class="hljs-string">"ç¬¬äºŒä¸ªç›‘å¬å™¨"</span>)
        }
        
        <span class="hljs-comment">// 4. TextWatcher - è§‚å¯Ÿæ–‡æœ¬å˜åŒ–</span>
        editText.addTextChangedListener(<span class="hljs-keyword">object</span> : TextWatcher {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">beforeTextChanged</span><span class="hljs-params">(s: <span class="hljs-type">CharSequence</span>?, start: <span class="hljs-type">Int</span>, count: <span class="hljs-type">Int</span>, after: <span class="hljs-type">Int</span>)</span></span> {
                <span class="hljs-comment">// æ–‡æœ¬å˜åŒ–å‰</span>
            }
            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTextChanged</span><span class="hljs-params">(s: <span class="hljs-type">CharSequence</span>?, start: <span class="hljs-type">Int</span>, before: <span class="hljs-type">Int</span>, count: <span class="hljs-type">Int</span>)</span></span> {
                <span class="hljs-comment">// æ–‡æœ¬å˜åŒ–æ—¶</span>
                textView.text = <span class="hljs-string">"è¾“å…¥: <span class="hljs-variable">$s</span>"</span>
            }
            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">afterTextChanged</span><span class="hljs-params">(s: <span class="hljs-type">Editable</span>?)</span></span> {
                <span class="hljs-comment">// æ–‡æœ¬å˜åŒ–å</span>
            }
        })
        
        <span class="hljs-comment">// 5. ä½¿ç”¨æ‰©å±•å‡½æ•°ç®€åŒ–</span>
        editText.afterTextChanged { text -&gt;
            button.isEnabled = text.length &gt;= <span class="hljs-number">6</span>
        }
    }
}

<span class="hljs-comment">// æ‰©å±•å‡½æ•°ï¼šç®€åŒ–TextWatcherä½¿ç”¨</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> EditText.<span class="hljs-title">afterTextChanged</span><span class="hljs-params">(afterTextChanged: (<span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    <span class="hljs-keyword">this</span>.addTextChangedListener(<span class="hljs-keyword">object</span> : TextWatcher {
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">afterTextChanged</span><span class="hljs-params">(editable: <span class="hljs-type">Editable</span>?)</span></span> {
            afterTextChanged.invoke(editable.toString())
        }
        
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">beforeTextChanged</span><span class="hljs-params">(s: <span class="hljs-type">CharSequence</span>?, start: <span class="hljs-type">Int</span>, count: <span class="hljs-type">Int</span>, after: <span class="hljs-type">Int</span>)</span></span> { <span class="hljs-comment">/* å¿½ç•¥ */</span> }
        <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTextChanged</span><span class="hljs-params">(s: <span class="hljs-type">CharSequence</span>?, start: <span class="hljs-type">Int</span>, before: <span class="hljs-type">Int</span>, count: <span class="hljs-type">Int</span>)</span></span> { <span class="hljs-comment">/* å¿½ç•¥ */</span> }
    })
}
</code></pre>
<h3 data-id="heading-9">3. BroadcastReceiver - ç³»ç»Ÿå¹¿æ’­è§‚å¯Ÿè€…</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. åŠ¨æ€æ³¨å†Œå¹¿æ’­æ¥æ”¶å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> networkReceiver: BroadcastReceiver
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> batteryReceiver: BroadcastReceiver
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContentView(R.layout.activity_network)
        
        <span class="hljs-comment">// ç½‘ç»œçŠ¶æ€å˜åŒ–è§‚å¯Ÿè€…</span>
        networkReceiver = <span class="hljs-keyword">object</span> : BroadcastReceiver() {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onReceive</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>?, intent: <span class="hljs-type">Intent</span>?)</span></span> {
                <span class="hljs-keyword">val</span> connectivityManager = getSystemService(Context.CONNECTIVITY_SERVICE) 
                    <span class="hljs-keyword">as</span> ConnectivityManager
                
                <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {
                    <span class="hljs-keyword">val</span> network = connectivityManager.activeNetwork
                    <span class="hljs-keyword">val</span> capabilities = connectivityManager.getNetworkCapabilities(network)
                    
                    <span class="hljs-keyword">val</span> isConnected = capabilities != <span class="hljs-literal">null</span> &amp;&amp; (
                        capabilities.hasTransport(NetworkCapabilities.TRANSPORT_WIFI) ||
                        capabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)
                    )
                    
                    updateUI(isConnected)
                }
            }
        }
        
        <span class="hljs-comment">// ç”µæ± çŠ¶æ€å˜åŒ–è§‚å¯Ÿè€…</span>
        batteryReceiver = <span class="hljs-keyword">object</span> : BroadcastReceiver() {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onReceive</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>?, intent: <span class="hljs-type">Intent</span>?)</span></span> {
                <span class="hljs-keyword">val</span> level = intent?.getIntExtra(BatteryManager.EXTRA_LEVEL, -<span class="hljs-number">1</span>) ?: -<span class="hljs-number">1</span>
                <span class="hljs-keyword">val</span> scale = intent?.getIntExtra(BatteryManager.EXTRA_SCALE, -<span class="hljs-number">1</span>) ?: -<span class="hljs-number">1</span>
                <span class="hljs-keyword">val</span> batteryPercent = <span class="hljs-keyword">if</span> (level &gt;= <span class="hljs-number">0</span> &amp;&amp; scale &gt; <span class="hljs-number">0</span>) {
                    level * <span class="hljs-number">100</span> / scale
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-number">0</span>
                }
                
                findViewById&lt;TextView&gt;(R.id.tv_battery).text = <span class="hljs-string">"ç”µé‡: <span class="hljs-variable">$batteryPercent</span>%"</span>
            }
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onResume</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onResume()
        <span class="hljs-comment">// æ³¨å†Œç½‘ç»œçŠ¶æ€è§‚å¯Ÿè€…</span>
        <span class="hljs-keyword">val</span> filter = IntentFilter(ConnectivityManager.CONNECTIVITY_ACTION)
        registerReceiver(networkReceiver, filter)
        
        <span class="hljs-comment">// æ³¨å†Œç”µæ± çŠ¶æ€è§‚å¯Ÿè€…</span>
        <span class="hljs-keyword">val</span> batteryFilter = IntentFilter(Intent.ACTION_BATTERY_CHANGED)
        registerReceiver(batteryReceiver, batteryFilter)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onPause</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onPause()
        <span class="hljs-comment">// æ³¨é”€è§‚å¯Ÿè€…</span>
        unregisterReceiver(networkReceiver)
        unregisterReceiver(batteryReceiver)
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">updateUI</span><span class="hljs-params">(isConnected: <span class="hljs-type">Boolean</span>)</span></span> {
        findViewById&lt;TextView&gt;(R.id.tv_network).text = 
            <span class="hljs-keyword">if</span> (isConnected) <span class="hljs-string">"ç½‘ç»œå·²è¿æ¥"</span> <span class="hljs-keyword">else</span> <span class="hljs-string">"ç½‘ç»œæœªè¿æ¥"</span>
    }
}

<span class="hljs-comment">// 2. é™æ€æ³¨å†Œå¹¿æ’­æ¥æ”¶å™¨ï¼ˆåœ¨AndroidManifest.xmlä¸­ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">BootCompletedReceiver</span> : <span class="hljs-type">BroadcastReceiver</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onReceive</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>, intent: <span class="hljs-type">Intent</span>)</span></span> {
        <span class="hljs-keyword">if</span> (intent.action == Intent.ACTION_BOOT_COMPLETED) {
            <span class="hljs-comment">// è®¾å¤‡å¯åŠ¨å®Œæˆï¼Œæ‰§è¡Œåˆå§‹åŒ–æ“ä½œ</span>
            startService(Intent(context, MyService::<span class="hljs-keyword">class</span>.java))
        }
    }
}

<span class="hljs-comment">// AndroidManifest.xmlé…ç½®</span>
<span class="hljs-comment">/*
&lt;receiver
    android:name=".BootCompletedReceiver"
    android:enabled="true"
    android:exported="true"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="android.intent.action.BOOT_COMPLETED" /&gt;
    &lt;/intent-filter&gt;
&lt;/receiver&gt;
*/</span>
</code></pre>
<h2 data-id="heading-10">å››ã€è§‚å¯Ÿè€…æ¨¡å¼çš„å˜ä½“</h2>
<h3 data-id="heading-11">1. äº‹ä»¶æ€»çº¿ (EventBus)</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç®€å•äº‹ä»¶æ€»çº¿å®ç°</span>
<span class="hljs-keyword">object</span> EventBus {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> subscribers = mutableMapOf&lt;Class&lt;*&gt;, MutableList&lt;(Any) -&gt; <span class="hljs-built_in">Unit</span>&gt;&gt;()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Any&gt;</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(eventType: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, subscriber: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> subscribersList = subscribers.getOrPut(eventType) { mutableListOf() }
        subscribersList.add { event -&gt; subscriber(event <span class="hljs-keyword">as</span> T) }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Any&gt;</span> <span class="hljs-title">unsubscribe</span><span class="hljs-params">(eventType: <span class="hljs-type">Class</span>&lt;<span class="hljs-type">T</span>&gt;, subscriber: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        subscribers[eventType]?.removeIf { it == subscriber }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T : Any&gt;</span> <span class="hljs-title">post</span><span class="hljs-params">(event: <span class="hljs-type">T</span>)</span></span> {
        <span class="hljs-keyword">val</span> eventType = event::<span class="hljs-keyword">class</span>.java
        subscribers[eventType]?.forEach { subscriber -&gt;
            <span class="hljs-keyword">try</span> {
                subscriber(event)
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                e.printStackTrace()
            }
        }
    }
}

<span class="hljs-comment">// å®šä¹‰äº‹ä»¶ç±»</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserLoginEvent</span>(<span class="hljs-keyword">val</span> userId: String, <span class="hljs-keyword">val</span> userName: String)
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkStateEvent</span>(<span class="hljs-keyword">val</span> isConnected: <span class="hljs-built_in">Boolean</span>)
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageReceivedEvent</span>(<span class="hljs-keyword">val</span> message: String)

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-comment">// è®¢é˜…äº‹ä»¶</span>
        EventBus.subscribe(UserLoginEvent::<span class="hljs-keyword">class</span>.java) { event -&gt;
            runOnUiThread {
                Toast.makeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"ç”¨æˆ·ç™»å½•: <span class="hljs-subst">${event.userName}</span>"</span>, Toast.LENGTH_SHORT).show()
                updateUserInfo(event.userId)
            }
        }
        
        EventBus.subscribe(NetworkStateEvent::<span class="hljs-keyword">class</span>.java) { event -&gt;
            runOnUiThread {
                showNetworkStatus(event.isConnected)
            }
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
        <span class="hljs-keyword">super</span>.onDestroy()
        <span class="hljs-comment">// å–æ¶ˆè®¢é˜…ï¼ˆç®€å•å®ç°ä¸­éœ€è¦æ‰‹åŠ¨ç®¡ç†ï¼‰</span>
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onLoginSuccess</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>, userName: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-comment">// å‘å¸ƒäº‹ä»¶</span>
        EventBus.post(UserLoginEvent(userId, userName))
    }
}

<span class="hljs-comment">// Androidä¸­æˆç†Ÿçš„äº‹ä»¶æ€»çº¿åº“ï¼š</span>
<span class="hljs-comment">// 1. LiveEventBus (åŸºäºLiveData)</span>
<span class="hljs-comment">// 2. EventBus (GreenRobot)</span>
<span class="hljs-comment">// 3. RxBus (åŸºäºRxJava)</span>
</code></pre>
<h3 data-id="heading-12">2. å“åº”å¼ç¼–ç¨‹ (RxJava)</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// RxJavaæ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„æ‰©å±•</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RxJavaExample</span> {
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">demonstrate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// åˆ›å»ºè¢«è§‚å¯Ÿè€…</span>
        <span class="hljs-keyword">val</span> observable = Observable.create&lt;String&gt; { emitter -&gt;
            <span class="hljs-keyword">try</span> {
                emitter.onNext(<span class="hljs-string">"æ•°æ®1"</span>)
                emitter.onNext(<span class="hljs-string">"æ•°æ®2"</span>)
                emitter.onNext(<span class="hljs-string">"æ•°æ®3"</span>)
                emitter.onComplete()
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                emitter.onError(e)
            }
        }
        
        <span class="hljs-comment">// åˆ›å»ºè§‚å¯Ÿè€…</span>
        <span class="hljs-keyword">val</span> observer = <span class="hljs-keyword">object</span> : Observer&lt;String&gt; {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSubscribe</span><span class="hljs-params">(d: <span class="hljs-type">Disposable</span>)</span></span> {
                println(<span class="hljs-string">"å¼€å§‹è®¢é˜…"</span>)
            }
            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onNext</span><span class="hljs-params">(t: <span class="hljs-type">String</span>)</span></span> {
                println(<span class="hljs-string">"æ”¶åˆ°æ•°æ®: <span class="hljs-variable">$t</span>"</span>)
            }
            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onError</span><span class="hljs-params">(e: <span class="hljs-type">Throwable</span>)</span></span> {
                println(<span class="hljs-string">"å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">${e.message}</span>"</span>)
            }
            
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onComplete</span><span class="hljs-params">()</span></span> {
                println(<span class="hljs-string">"æ•°æ®æµå®Œæˆ"</span>)
            }
        }
        
        <span class="hljs-comment">// è®¢é˜…</span>
        observable.subscribe(observer)
        
        <span class="hljs-comment">// ä½¿ç”¨æ“ä½œç¬¦é“¾å¼è°ƒç”¨</span>
        Observable.interval(<span class="hljs-number">1</span>, TimeUnit.SECONDS) <span class="hljs-comment">// æ¯ç§’å‘å°„ä¸€ä¸ªæ•°å­—</span>
            .take(<span class="hljs-number">5</span>) <span class="hljs-comment">// åªå–å‰5ä¸ª</span>
            .map { it * <span class="hljs-number">2</span> } <span class="hljs-comment">// è½¬æ¢</span>
            .filter { it % <span class="hljs-number">4</span> == <span class="hljs-number">0L</span> } <span class="hljs-comment">// è¿‡æ»¤</span>
            .subscribeOn(Schedulers.io()) <span class="hljs-comment">// åœ¨IOçº¿ç¨‹æ‰§è¡Œ</span>
            .observeOn(AndroidSchedulers.mainThread()) <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹è§‚å¯Ÿ</span>
            .subscribe(
                { value -&gt; println(<span class="hljs-string">"å€¼: <span class="hljs-variable">$value</span>"</span>) },
                { error -&gt; println(<span class="hljs-string">"é”™è¯¯: <span class="hljs-variable">$error</span>"</span>) },
                { println(<span class="hljs-string">"å®Œæˆ"</span>) }
            )
    }
    
    <span class="hljs-comment">// Androidç½‘ç»œè¯·æ±‚ç¤ºä¾‹</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUserData</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span> {
        apiService.getUser(userId)
            .subscribeOn(Schedulers.io())
            .observeOn(AndroidSchedulers.mainThread())
            .doOnSubscribe {
                <span class="hljs-comment">// æ˜¾ç¤ºåŠ è½½ä¸­</span>
                showLoading()
            }
            .doOnTerminate {
                <span class="hljs-comment">// éšè—åŠ è½½ä¸­</span>
                hideLoading()
            }
            .subscribe(
                { user -&gt;
                    <span class="hljs-comment">// æ›´æ–°UI</span>
                    updateUserInfo(user)
                },
                { error -&gt;
                    <span class="hljs-comment">// æ˜¾ç¤ºé”™è¯¯</span>
                    showError(error.message)
                }
            )
    }
}
</code></pre>
<h3 data-id="heading-13">3. Kotlin Flow</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// Kotlinåç¨‹ä¸­çš„Flow</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FlowExample</span> {
    
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">demonstrate</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// åˆ›å»ºæµï¼ˆè¢«è§‚å¯Ÿè€…ï¼‰</span>
        <span class="hljs-keyword">val</span> flow = flow {
            <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.5</span>) {
                delay(<span class="hljs-number">1000</span>) <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
                emit(<span class="hljs-string">"å€¼ <span class="hljs-variable">$i</span>"</span>) <span class="hljs-comment">// å‘å°„æ•°æ®</span>
            }
        }
        
        <span class="hljs-comment">// æ”¶é›†æµï¼ˆè§‚å¯Ÿè€…ï¼‰</span>
        flow.collect { value -&gt;
            println(<span class="hljs-string">"æ”¶åˆ°: <span class="hljs-variable">$value</span>"</span>)
        }
        
        <span class="hljs-comment">// ä½¿ç”¨æ“ä½œç¬¦</span>
        flow
            .map { it.length } <span class="hljs-comment">// è½¬æ¢</span>
            .filter { it &gt; <span class="hljs-number">3</span> } <span class="hljs-comment">// è¿‡æ»¤</span>
            .<span class="hljs-keyword">catch</span> { e -&gt; emit(-<span class="hljs-number">1</span>) } <span class="hljs-comment">// å¼‚å¸¸å¤„ç†</span>
            .collect { length -&gt;
                println(<span class="hljs-string">"é•¿åº¦: <span class="hljs-variable">$length</span>"</span>)
            }
    }
    
    <span class="hljs-comment">// Androidä¸­çš„ä½¿ç”¨</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserViewModel</span> : <span class="hljs-type">ViewModel</span>() {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _userState = MutableStateFlow&lt;UserState&gt;(UserState.Loading)
        <span class="hljs-keyword">val</span> userState: StateFlow&lt;UserState&gt; = _userState
        
        <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadUser</span><span class="hljs-params">(userId: <span class="hljs-type">String</span>)</span></span> {
            viewModelScope.launch {
                _userState.value = UserState.Loading
                
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">val</span> user = userRepository.getUser(userId)
                    _userState.value = UserState.Success(user)
                } <span class="hljs-keyword">catch</span> (e: Exception) {
                    _userState.value = UserState.Error(e.message ?: <span class="hljs-string">"æœªçŸ¥é”™è¯¯"</span>)
                }
            }
        }
        
        <span class="hljs-comment">// å…±äº«æµ</span>
        <span class="hljs-keyword">val</span> usersFlow = userRepository.getUsersFlow()
            .stateIn(
                scope = viewModelScope,
                started = SharingStarted.WhileSubscribed(<span class="hljs-number">5000</span>),
                initialValue = emptyList()
            )
    }
    
    <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserState</span> {
        <span class="hljs-keyword">object</span> Loading : UserState()
        <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Success</span>(<span class="hljs-keyword">val</span> user: User) : UserState()
        <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Error</span>(<span class="hljs-keyword">val</span> message: String) : UserState()
    }
}
</code></pre>
<h3 data-id="heading-14">4. å›è°ƒæ¥å£ (Callback)</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// å›è°ƒæ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„ç®€åŒ–å½¢å¼</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">DownloadCallback</span> {
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(progress: <span class="hljs-type">Int</span>)</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(filePath: <span class="hljs-type">String</span>)</span></span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(error: <span class="hljs-type">String</span>)</span></span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">FileDownloader</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> callback: DownloadCallback) {
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">downloadFile</span><span class="hljs-params">(url: <span class="hljs-type">String</span>, destination: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸‹è½½è¿‡ç¨‹</span>
        Thread {
            <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1.</span><span class="hljs-number">.100</span> step <span class="hljs-number">10</span>) {
                Thread.sleep(<span class="hljs-number">500</span>)
                callback.onProgress(i)
            }
            
            <span class="hljs-comment">// æ¨¡æ‹Ÿä¸‹è½½æˆåŠŸ</span>
            callback.onSuccess(destination)
        }.start()
    }
}

<span class="hljs-comment">// ä½¿ç”¨å›è°ƒ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">AppCompatActivity</span>(), DownloadCallback {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-keyword">val</span> downloader = FileDownloader(<span class="hljs-keyword">this</span>)
        downloader.downloadFile(<span class="hljs-string">"http://example.com/file.zip"</span>, <span class="hljs-string">"/storage/file.zip"</span>)
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onProgress</span><span class="hljs-params">(progress: <span class="hljs-type">Int</span>)</span></span> {
        runOnUiThread {
            progressBar.progress = progress
            tvProgress.text = <span class="hljs-string">"<span class="hljs-variable">$progress</span>%"</span>
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onSuccess</span><span class="hljs-params">(filePath: <span class="hljs-type">String</span>)</span></span> {
        runOnUiThread {
            Toast.makeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"ä¸‹è½½å®Œæˆ: <span class="hljs-variable">$filePath</span>"</span>, Toast.LENGTH_SHORT).show()
        }
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(error: <span class="hljs-type">String</span>)</span></span> {
        runOnUiThread {
            Toast.makeText(<span class="hljs-keyword">this</span>, <span class="hljs-string">"ä¸‹è½½å¤±è´¥: <span class="hljs-variable">$error</span>"</span>, Toast.LENGTH_SHORT).show()
        }
    }
}
</code></pre>
<h2 data-id="heading-15">äº”ã€è§‚å¯Ÿè€…æ¨¡å¼çš„ä¼˜ç¼ºç‚¹</h2>
<h3 data-id="heading-16">âœ… ä¼˜ç‚¹</h3>
<ol>
<li><strong>æ¾è€¦åˆ</strong>ï¼šè§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä¹‹é—´æ˜¯æŠ½è±¡è€¦åˆ</li>
<li><strong>æ”¯æŒå¹¿æ’­é€šä¿¡</strong>ï¼šè¢«è§‚å¯Ÿè€…å¯ä»¥é€šçŸ¥å¤šä¸ªè§‚å¯Ÿè€…</li>
<li><strong>å¼€é—­åŸåˆ™</strong>ï¼šå¯ä»¥éšæ—¶å¢åŠ æ–°çš„è§‚å¯Ÿè€…</li>
<li><strong>è‡ªåŠ¨é€šçŸ¥</strong>ï¼šçŠ¶æ€å˜åŒ–æ—¶è‡ªåŠ¨é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…</li>
<li><strong>çµæ´»æ€§</strong>ï¼šè§‚å¯Ÿè€…å¯ä»¥åŠ¨æ€åœ°è®¢é˜…å’Œå–æ¶ˆè®¢é˜…</li>
</ol>
<h3 data-id="heading-17">âŒ ç¼ºç‚¹</h3>
<ol>
<li><strong>å†…å­˜æ³„æ¼é£é™©</strong>ï¼šè§‚å¯Ÿè€…æŒæœ‰è¢«è§‚å¯Ÿè€…å¼•ç”¨å¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼</li>
<li><strong>é€šçŸ¥é¡ºåºé—®é¢˜</strong>ï¼šè§‚å¯Ÿè€…æ”¶åˆ°é€šçŸ¥çš„é¡ºåºå¯èƒ½ä¸ç¡®å®š</li>
<li><strong>æ€§èƒ½é—®é¢˜</strong>ï¼šè§‚å¯Ÿè€…æ•°é‡å¤šæ—¶ï¼Œé€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…å¯èƒ½å½±å“æ€§èƒ½</li>
<li><strong>å¾ªç¯ä¾èµ–</strong>ï¼šå¯èƒ½å¯¼è‡´å¾ªç¯å¼•ç”¨å’Œé€šçŸ¥å¾ªç¯</li>
<li><strong>è°ƒè¯•å›°éš¾</strong>ï¼šäº‹ä»¶æµå¯èƒ½éš¾ä»¥è·Ÿè¸ªå’Œè°ƒè¯•</li>
</ol>
<h2 data-id="heading-18">å…­ã€Androidä¸­çš„æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-19">1. é¿å…å†…å­˜æ³„æ¼</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ­£ç¡®ä½¿ç”¨LiveData</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> viewModel: UserViewModel
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        viewModel = ViewModelProvider(<span class="hljs-keyword">this</span>)[UserViewModel::<span class="hljs-keyword">class</span>.java]
        
        <span class="hljs-comment">// LifecycleOwnerè‡ªåŠ¨ç®¡ç†è§‚å¯Ÿè€…ç”Ÿå‘½å‘¨æœŸ</span>
        viewModel.userName.observe(<span class="hljs-keyword">this</span>) { name -&gt;
            <span class="hljs-comment">// å½“Activityé”€æ¯æ—¶ï¼Œè§‚å¯Ÿè€…ä¼šè‡ªåŠ¨ç§»é™¤</span>
            updateUserName(name)
        }
    }
}

<span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šä½¿ç”¨åŒ¿åå†…éƒ¨ç±»æŒæœ‰Activityå¼•ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LeakyActivity</span> : <span class="hljs-type">AppCompatActivity</span>() {
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        
        <span class="hljs-comment">// é”™è¯¯ï¼šåŒ¿åå†…éƒ¨ç±»éšå¼æŒæœ‰Activityå¼•ç”¨</span>
        someGlobalObject.setCallback(<span class="hljs-keyword">object</span> : SomeCallback {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDataChanged</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">String</span>)</span></span> {
                <span class="hljs-comment">// å¦‚æœsomeGlobalObjectç”Ÿå‘½å‘¨æœŸæ¯”Activityé•¿ï¼Œä¼šå¯¼è‡´å†…å­˜æ³„æ¼</span>
                updateUI(<span class="hljs-keyword">data</span>)
            }
        })
    }
}

<span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼šä½¿ç”¨å¼±å¼•ç”¨æˆ–Lifecycle</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SafeCallback</span>(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lifecycleOwner: LifecycleOwner) : SomeCallback {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> isActive: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">false</span>
    
    <span class="hljs-keyword">init</span> {
        lifecycleOwner.lifecycle.addObserver(<span class="hljs-keyword">object</span> : LifecycleEventObserver {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onStateChanged</span><span class="hljs-params">(source: <span class="hljs-type">LifecycleOwner</span>, event: <span class="hljs-type">Lifecycle</span>.<span class="hljs-type">Event</span>)</span></span> {
                isActive = event == Lifecycle.Event.ON_RESUME ||
                          event == Lifecycle.Event.ON_START ||
                          event == Lifecycle.Event.ON_CREATE
            }
        })
    }
    
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDataChanged</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">if</span> (isActive) {
            <span class="hljs-comment">// åªåœ¨Activityæ´»è·ƒæ—¶æ›´æ–°UI</span>
            updateUI(<span class="hljs-keyword">data</span>)
        }
    }
}
</code></pre>
<h3 data-id="heading-20">2. äº‹ä»¶å¤„ç†ç­–ç•¥</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. SingleLiveEvent - é¿å…é‡å¤é€šçŸ¥</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SingleLiveEvent</span>&lt;<span class="hljs-type">T</span>&gt; : <span class="hljs-type">MutableLiveData</span>&lt;<span class="hljs-type">T</span>&gt;() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> pending = AtomicBoolean(<span class="hljs-literal">false</span>)
    
    <span class="hljs-meta">@MainThread</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">observe</span><span class="hljs-params">(owner: <span class="hljs-type">LifecycleOwner</span>, observer: <span class="hljs-type">Observer</span>&lt;<span class="hljs-type">in</span> <span class="hljs-type">T</span>&gt;)</span></span> {
        <span class="hljs-keyword">super</span>.observe(owner) { t -&gt;
            <span class="hljs-keyword">if</span> (pending.compareAndSet(<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>)) {
                observer.onChanged(t)
            }
        }
    }
    
    <span class="hljs-meta">@MainThread</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setValue</span><span class="hljs-params">(t: <span class="hljs-type">T</span>?)</span></span> {
        pending.<span class="hljs-keyword">set</span>(<span class="hljs-literal">true</span>)
        <span class="hljs-keyword">super</span>.setValue(t)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">call</span><span class="hljs-params">()</span></span> {
        value = <span class="hljs-literal">null</span>
    }
}

<span class="hljs-comment">// 2. EventWrapper - åŒ…è£…äº‹ä»¶é˜²æ­¢é‡å¤æ¶ˆè´¹</span>
<span class="hljs-keyword">open</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Event</span>&lt;<span class="hljs-type">out T</span>&gt;(<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> content: T) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> hasBeenHandled = <span class="hljs-literal">false</span>
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getContentIfNotHandled</span><span class="hljs-params">()</span></span>: T? {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (hasBeenHandled) {
            <span class="hljs-literal">null</span>
        } <span class="hljs-keyword">else</span> {
            hasBeenHandled = <span class="hljs-literal">true</span>
            content
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">peekContent</span><span class="hljs-params">()</span></span>: T = content
}

<span class="hljs-comment">// åœ¨ViewModelä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyViewModel</span> : <span class="hljs-type">ViewModel</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _snackbarMessage = MutableLiveData&lt;Event&lt;String&gt;&gt;()
    <span class="hljs-keyword">val</span> snackbarMessage: LiveData&lt;Event&lt;String&gt;&gt; = _snackbarMessage
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">showSnackbar</span><span class="hljs-params">(message: <span class="hljs-type">String</span>)</span></span> {
        _snackbarMessage.value = Event(message)
    }
}

<span class="hljs-comment">// åœ¨Activityä¸­è§‚å¯Ÿ</span>
viewModel.snackbarMessage.observe(<span class="hljs-keyword">this</span>) { event -&gt;
    event.getContentIfNotHandled()?.let { message -&gt;
        Snackbar.make(rootView, message, Snackbar.LENGTH_SHORT).show()
    }
}
</code></pre>
<h3 data-id="heading-21">3. ç»„åˆè§‚å¯Ÿè€…æ¨¡å¼</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// ç»“åˆå¤šä¸ªè§‚å¯Ÿè€…æ¨¡å¼</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">CompositeObservable</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> liveDataObservers = mutableListOf&lt;LiveData&lt;*&gt;&gt;()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> rxDisposables = CompositeDisposable()
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> flowJobs = mutableListOf&lt;Job&gt;()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">observe</span><span class="hljs-params">(liveData: <span class="hljs-type">LiveData</span>&lt;<span class="hljs-type">T</span>&gt;, observer: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        liveData.observeForever { observer(it) }
        liveDataObservers.add(liveData)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">subscribe</span><span class="hljs-params">(observable: <span class="hljs-type">Observable</span>&lt;<span class="hljs-type">T</span>&gt;, observer: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> disposable = observable
            .subscribeOn(Schedulers.io())
            .observeOn(AndroidSchedulers.mainThread())
            .subscribe(
                { observer(it) },
                { error -&gt; Log.e(<span class="hljs-string">"CompositeObservable"</span>, <span class="hljs-string">"Error"</span>, error) }
            )
        rxDisposables.add(disposable)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;T&gt;</span> <span class="hljs-title">collect</span><span class="hljs-params">(flow: <span class="hljs-type">Flow</span>&lt;<span class="hljs-type">T</span>&gt;, collector: (<span class="hljs-type">T</span>) -&gt; <span class="hljs-type">Unit</span>)</span></span> {
        <span class="hljs-keyword">val</span> job = CoroutineScope(Dispatchers.Main).launch {
            flow.collect { collector(it) }
        }
        flowJobs.add(job)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">clear</span><span class="hljs-params">()</span></span> {
        <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰è§‚å¯Ÿè€…</span>
        liveDataObservers.forEach { it.removeObservers { } }
        liveDataObservers.clear()
        
        rxDisposables.clear()
        
        flowJobs.forEach { it.cancel() }
        flowJobs.clear()
    }
}

<span class="hljs-comment">// åœ¨ViewModelæˆ–Presenterä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyPresenter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> compositeObservable = CompositeObservable()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setupObservers</span><span class="hljs-params">()</span></span> {
        compositeObservable.observe(viewModel.userName) { name -&gt;
            <span class="hljs-comment">// å¤„ç†ç”¨æˆ·åå˜åŒ–</span>
        }
        
        compositeObservable.subscribe(rxApi.getData()) { <span class="hljs-keyword">data</span> -&gt;
            <span class="hljs-comment">// å¤„ç†RxJavaæ•°æ®</span>
        }
        
        compositeObservable.collect(dataFlow) { value -&gt;
            <span class="hljs-comment">// å¤„ç†Flowæ•°æ®</span>
        }
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onDestroy</span><span class="hljs-params">()</span></span> {
        compositeObservable.clear()
    }
}
</code></pre>
<h2 data-id="heading-22">ä¸ƒã€ä¸å…¶ä»–æ¨¡å¼çš„å¯¹æ¯”</h2>
<h3 data-id="heading-23">è§‚å¯Ÿè€…æ¨¡å¼ vs ä¸­ä»‹è€…æ¨¡å¼</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// è§‚å¯Ÿè€…æ¨¡å¼ï¼šä¸€å¯¹å¤šï¼Œè¢«è§‚å¯Ÿè€…ç›´æ¥é€šçŸ¥è§‚å¯Ÿè€…</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Button</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> listeners = mutableListOf&lt;ClickListener&gt;()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addClickListener</span><span class="hljs-params">(listener: <span class="hljs-type">ClickListener</span>)</span></span> {
        listeners.add(listener)
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">click</span><span class="hljs-params">()</span></span> {
        listeners.forEach { it.onClick() }
    }
}

<span class="hljs-comment">// ä¸­ä»‹è€…æ¨¡å¼ï¼šå¤šå¯¹å¤šï¼Œé€šè¿‡ä¸­ä»‹è€…åè°ƒ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Mediator</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> components = mutableMapOf&lt;String, Component&gt;()
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">notify</span><span class="hljs-params">(sender: <span class="hljs-type">String</span>, event: <span class="hljs-type">String</span>, <span class="hljs-keyword">data</span>: <span class="hljs-type">Any</span>)</span></span> {
        <span class="hljs-comment">// ä¸­ä»‹è€…å†³å®šå¦‚ä½•è½¬å‘äº‹ä»¶</span>
        <span class="hljs-keyword">when</span> (event) {
            <span class="hljs-string">"click"</span> -&gt; handleClick(sender, <span class="hljs-keyword">data</span>)
            <span class="hljs-string">"change"</span> -&gt; handleChange(sender, <span class="hljs-keyword">data</span>)
        }
    }
}
</code></pre>
<h2 data-id="heading-24">å…«ã€æ€»ç»“</h2>
<p>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯Androidå¼€å‘ä¸­<strong>æœ€å¸¸ç”¨ã€æœ€é‡è¦</strong>çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ï¼Œå‡ ä¹æ— å¤„ä¸åœ¨ï¼š</p>
<h3 data-id="heading-25">æ ¸å¿ƒåº”ç”¨</h3>
<ol>
<li><strong>LiveData</strong>ï¼šAndroidæ¶æ„ç»„ä»¶ä¸­çš„æ ¸å¿ƒ</li>
<li><strong>Viewäº‹ä»¶ç›‘å¬</strong>ï¼šOnClickListenerã€TextWatcherç­‰</li>
<li><strong>BroadcastReceiver</strong>ï¼šç³»ç»Ÿå¹¿æ’­ç›‘å¬</li>
<li><strong>äº‹ä»¶æ€»çº¿</strong>ï¼šç»„ä»¶é—´é€šä¿¡</li>
<li><strong>å“åº”å¼ç¼–ç¨‹</strong>ï¼šRxJavaã€Kotlin Flow</li>
</ol>
<h3 data-id="heading-26">å…³é”®è¦ç‚¹</h3>
<ol>
<li><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šAndroidä¸­å¿…é¡»æ³¨æ„è§‚å¯Ÿè€…çš„ç”Ÿå‘½å‘¨æœŸ</li>
<li><strong>é¿å…å†…å­˜æ³„æ¼</strong>ï¼šä½¿ç”¨å¼±å¼•ç”¨ã€Lifecycle-awareç»„ä»¶</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šç¡®ä¿è§‚å¯Ÿè€…é€šçŸ¥çš„çº¿ç¨‹å®‰å…¨</li>
<li><strong>äº‹ä»¶å»é‡</strong>ï¼šé¿å…é‡å¤é€šçŸ¥å’Œäº‹ä»¶é£æš´</li>
</ol>
<h3 data-id="heading-27">é€‰æ‹©å»ºè®®</h3>
<ul>
<li><strong>ç®€å•UIæ›´æ–°</strong>Â â†’ LiveData</li>
<li><strong>å¤æ‚å¼‚æ­¥æµ</strong>Â â†’ RxJava/Kotlin Flow</li>
<li><strong>ç»„ä»¶é—´é€šä¿¡</strong>Â â†’ EventBus/LiveEventBus</li>
<li><strong>ç³»ç»Ÿäº‹ä»¶</strong>Â â†’ BroadcastReceiver</li>
<li><strong>ç®€å•å›è°ƒ</strong>Â â†’ æ¥å£å›è°ƒ</li>
</ul>
<p>è§‚å¯Ÿè€…æ¨¡å¼æ˜¯æ„å»ºå“åº”å¼ã€è§£è€¦çš„Androidåº”ç”¨çš„åŸºç¡€ï¼Œåˆç†ä½¿ç”¨å¯ä»¥æ˜¾è‘—æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§ã€‚æŒæ¡è§‚å¯Ÿè€…æ¨¡å¼åŠå…¶åœ¨Androidä¸­çš„å„ç§å®ç°æ–¹å¼ï¼Œæ˜¯æ¯ä¸ªAndroidå¼€å‘è€…å¿…å¤‡çš„æ ¸å¿ƒæŠ€èƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦ä¹ è®°å½•ï¼šAndroid14ä¸­çš„æ˜¾ç¤ºé“¾è·¯]]></title>    <link>https://juejin.cn/post/7601169987411705894</link>    <guid>https://juejin.cn/post/7601169987411705894</guid>    <pubDate>2026-01-31T13:55:16.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601169987411705894" data-draft-id="7601077764424122418" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦ä¹ è®°å½•ï¼šAndroid14ä¸­çš„æ˜¾ç¤ºé“¾è·¯"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-31T13:55:16.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç…¤çƒç‹å­"/> <meta itemprop="url" content="https://juejin.cn/user/4088439235949739"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦ä¹ è®°å½•ï¼šAndroid14ä¸­çš„æ˜¾ç¤ºé“¾è·¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4088439235949739/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç…¤çƒç‹å­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T13:55:16.000Z" title="Sat Jan 31 2026 13:55:16 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">View &amp; ViewGroup</h2>
<h3 data-id="heading-1">1. Viewæ˜¯ä»€ä¹ˆ</h3>
<p>Viewæ˜¯Androidä¸­<strong>æ‰€æœ‰å¯è§†åŒ–å…ƒç´ çš„åŸºç±»</strong>ï¼Œæ˜¯å±å¹•ä¸Šèƒ½è¢«ç”¨æˆ·çœ‹åˆ°å¹¶äº¤äº’çš„ â€œæœ€å°åŸå­â€ï¼Œæ ¸å¿ƒèŒè´£åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>æ¸²æŸ“èŒè´£</strong>ï¼šé€šè¿‡<code>measure()</code>ï¼ˆæµ‹é‡è‡ªèº«å°ºå¯¸ï¼‰ã€<code>layout()</code>ï¼ˆç¡®å®šåœ¨çˆ¶å®¹å™¨ä¸­çš„ä½ç½®ï¼‰ã€<code>draw()</code>ï¼ˆå°†åƒç´ ç»˜åˆ¶åˆ°ç¼“å†²åŒºï¼‰ä¸‰ä¸ªæ ¸å¿ƒæµç¨‹ï¼Œå®Œæˆè‡ªèº«è§†è§‰å‘ˆç°ï¼ˆå¦‚TextViewç»˜åˆ¶æ–‡å­—ã€ImageViewç»˜åˆ¶å›¾ç‰‡ï¼‰ï¼›</li>
<li>Â <strong>äº¤äº’èŒè´£</strong>ï¼šé€šè¿‡<code>dispatchTouchEvent()</code>ï¼ˆäº‹ä»¶åˆ†å‘ï¼‰ã€<code>onTouchEvent()</code>ï¼ˆäº‹ä»¶å¤„ç†ï¼‰æ¥æ”¶å¹¶å“åº”ç”¨æˆ·çš„è§¦æ‘¸ã€ç‚¹å‡»ã€æ»‘åŠ¨ç­‰è¾“å…¥äº‹ä»¶ï¼Œæ˜¯ç”¨æˆ·ä¸APPäº¤äº’çš„â€œç›´æ¥è§¦ç‚¹â€ã€‚</li>
</ul>
<h3 data-id="heading-2">2. ViewGroupæ˜¯ä»€ä¹ˆ</h3>
<p>ViewGroupæ˜¯Viewçš„å­ç±»ï¼Œä½œä¸ºâ€œå®¹å™¨å‹Viewâ€ï¼Œæ ¸å¿ƒä½œç”¨æ˜¯<strong>ç®¡ç†å­Viewçš„æ’åˆ—è§„åˆ™å’Œå±‚çº§</strong>ï¼Œå®ç°å¤æ‚é¡µé¢çš„å¸ƒå±€ï¼š</p>
<ul>
<li><strong>å¸ƒå±€è§„åˆ™å°è£…</strong>ï¼šä¸åŒViewGroupå¯¹åº”ä¸åŒå¸ƒå±€é€»è¾‘ï¼ˆå¦‚<code>LinearLayoutçº¿æ€§æ’åˆ—</code>ã€<code>RelativeLayoutç›¸å¯¹å®šä½</code>ã€<code>ConstraintLayoutçº¦æŸå¸ƒå±€</code>ï¼‰ï¼Œæœ¬è´¨æ˜¯é€šè¿‡é‡å†™<code>onMeasure()</code>/<code>onLayout()</code>ï¼Œé€’å½’å®Œæˆæ‰€æœ‰å­Viewçš„å°ºå¯¸æµ‹é‡å’Œä½ç½®ç¡®å®šï¼›</li>
<li><strong>Viewæ ‘æ„å»º</strong>ï¼šä¸€ä¸ªAndroidé¡µé¢çš„UIæœ¬è´¨æ˜¯ä¸€æ£µâ€œViewæ ‘â€â€”â€”&gt;æ ¹èŠ‚ç‚¹æ˜¯DecorViewï¼ˆViewGroupï¼‰ï¼Œä¸‹å±‚åŒ…å«æ ‡é¢˜æ ã€å†…å®¹åŒºï¼ˆContentViewï¼‰ç­‰å­ViewGroupï¼Œæœ€ç»ˆå¶å­èŠ‚ç‚¹æ˜¯Buttonã€TextViewç­‰æ™®é€šViewï¼›</li>
<li><strong>äº‹ä»¶åˆ†å‘ä¸­è½¬</strong>ï¼šç”¨æˆ·è§¦æ‘¸äº‹ä»¶ä¼šå…ˆä¼ é€’åˆ°ViewGroupï¼Œå†ç”±ViewGroupæ ¹æ®å­Viewçš„ä½ç½®ã€å¯è§æ€§ç­‰è§„åˆ™ï¼Œåˆ†å‘åˆ°ç›®æ ‡å­Viewï¼Œå®ç°ç²¾å‡†çš„äº¤äº’å“åº”ã€‚</li>
</ul>
<blockquote>
<p>æ ¸å¿ƒæ€»ç»“:</p>
<p>(1) Viewæ˜¯â€œUIåŸå­â€ï¼Œè´Ÿè´£è‡ªèº«æ¸²æŸ“å’Œäº¤äº’ï¼›ViewGroupæ˜¯â€œå¸ƒå±€å®¹å™¨â€ï¼Œè´Ÿè´£ç»„ç»‡Viewæ ‘ã€åˆ¶å®šå¸ƒå±€è§„åˆ™ï¼›</p>
<p>(2) åº”ç”¨é€šè¿‡åµŒå¥—ViewGroupå’ŒViewï¼Œæ„å»ºå‡ºä»»æ„å¤æ‚åº¦çš„é¡µé¢å¸ƒå±€ï¼Œé€šè¿‡Viewçš„äº‹ä»¶å›è°ƒå®ç°ç”¨æˆ·äº¤äº’ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e7dcc85057d43d8a2451627ce9d36f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Wk55CD546L5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770472516&amp;x-signature=koIPSfFPLWm3gb7CcCm7o734fow%3D" alt="viewä¸viewGroup.png" loading="lazy"/></p>
<h2 data-id="heading-3">Activity &amp; ViewRootImpl</h2>
<h3 data-id="heading-4">1.Activityæ˜¯ä»€ä¹ˆ</h3>
<p>Activity(æ´»åŠ¨ï¼Œè¡ŒåŠ¨)æ˜¯Androidå››å¤§ç»„ä»¶ä¹‹ä¸€ï¼Œå¹¶éç›´æ¥å‚ä¸UIç»˜åˆ¶ï¼Œè€Œæ˜¯æ‰¿æ‹…ä¸¤å¤§æ ¸å¿ƒè§’è‰²ï¼š</p>
<ul>
<li><strong>Viewçš„ç”Ÿå‘½å‘¨æœŸç»‘å®šè€…</strong>ï¼šActivityé€šè¿‡<code>setContentView()</code>åŠ è½½å¸ƒå±€æ–‡ä»¶ï¼ˆæˆ–åŠ¨æ€åˆ›å»ºViewï¼‰ï¼Œå°†Viewæ ‘ä¸è‡ªèº«ç”Ÿå‘½å‘¨æœŸç»‘å®šâ€”â€”Activityçš„<code>onResume()</code>è§¦å‘Viewçš„é¦–æ¬¡ç»˜åˆ¶ï¼Œ<code>onPause()</code>æš‚åœViewçš„äº¤äº’å’Œç»˜åˆ¶ï¼Œ<code>onDestroy()</code>é€’å½’é”€æ¯æ•´ä¸ªViewæ ‘ï¼›</li>
<li><strong>ç³»ç»Ÿèµ„æºç«äº‰å‚ä¸è€…</strong>ï¼šActivityä½œä¸ºAMSç®¡ç†çš„â€œæœ€å°èµ„æºå•å…ƒâ€ï¼Œä¼šä»£è¡¨åº”ç”¨å‘ç³»ç»Ÿç”³è¯·CPUã€å†…å­˜ç­‰èµ„æºï¼ŒAMSé€šè¿‡Activityçš„çŠ¶æ€ï¼ˆå‰å°/åå°ï¼‰å†³å®šåº”ç”¨è¿›ç¨‹çš„ä¼˜å…ˆçº§ï¼Œè¿›è€Œä»²è£èµ„æºåˆ†é…ï¼ˆå¦‚å‰å°Activityçš„è¿›ç¨‹ä¼˜å…ˆè·å–CPUèµ„æºï¼‰ã€‚</li>
</ul>
<p>Viewè‡ªèº«æ— æ³•ç›´æ¥ä¸ç³»ç»ŸæœåŠ¡é€šä¿¡ï¼Œå¿…é¡»é€šè¿‡<strong>ViewRootImpl</strong>å®ŒæˆUIå¸ƒå±€çš„æœ€ç»ˆè½åœ°ï¼š</p>
<h3 data-id="heading-5">2.ViewRootImplæ˜¯ä»€ä¹ˆ</h3>
<p>Viewè‡ªèº«æ— æ³•ç›´æ¥ä¸ç³»ç»ŸæœåŠ¡é€šä¿¡ï¼Œå¿…é¡»é€šè¿‡<code>ViewRootImpl</code>å®ŒæˆUIå¸ƒå±€çš„æœ€ç»ˆè½åœ°
æ‰€ä»¥ï¼Œå®ƒæ˜¯ä¸­é—´è€…ã€‚</p>
<ul>
<li>
<p><strong>ViewRootImplçš„åˆ›å»ºæ—¶æœº</strong>ï¼šActivityçš„<code>onResume()</code>æ‰§è¡Œåï¼Œç³»ç»Ÿä¼šä¸ºActivityçš„Viewæ ‘åˆ›å»ºViewRootImplï¼Œå®ƒæ˜¯Viewæ ‘çš„â€œéšå½¢æ ¹èŠ‚ç‚¹â€ï¼ˆä¸åœ¨Viewæ ‘ç»“æ„ä¸­ï¼Œä½†æŒæœ‰DecorViewçš„å¼•ç”¨ï¼‰ï¼›</p>
</li>
<li>
<p><strong>æ ¸å¿ƒä½œç”¨</strong>ï¼š</p>
</li>
</ul>
<p>â‘  è§¦å‘Viewæ ‘çš„<code>measure()</code>â†’<code>layout()</code>â†’<code>draw()</code>å…¨æµç¨‹ï¼Œæ˜¯UIç»˜åˆ¶çš„â€œæ€»å¼€å…³â€ï¼›</p>
<p>â‘¡ ä½œä¸ºViewä¸WMSçš„é€šä¿¡ä¸­ä»‹ï¼ˆé€šè¿‡Binderï¼‰ï¼Œå‘WMSä¸ŠæŠ¥Viewçš„å°ºå¯¸ã€ä½ç½®ï¼Œæ¥æ”¶WMSçš„å¸ƒå±€æŒ‡ä»¤ï¼›</p>
<p>â‘¢ å¤„ç†ç³»ç»Ÿè¾“å…¥äº‹ä»¶ï¼ˆå¦‚è§¦æ‘¸ã€æŒ‰é”®ï¼‰ï¼Œå°†äº‹ä»¶åˆ†å‘åˆ°Viewæ ‘çš„ç›®æ ‡Viewã€‚</p>
<blockquote>
<p>æ ¸å¿ƒæ€»ç»“</p>
<p>(1) Activity æ˜¯ Viewçš„â€œè€æ¿â€ï¼šå†³å®šViewçš„ç”Ÿæ­»ã€ä¸ºViewäº‰å–ç³»ç»Ÿèµ„æºï¼›</p>
<p>(2) ViewRootImpl æ˜¯ Viewçš„â€œæ‰§è¡Œè€…â€ï¼šæ‰¿æ¥Activityçš„æŒ‡ä»¤ï¼Œè§¦å‘Viewå¸ƒå±€ç»˜åˆ¶ï¼Œå¯¹æ¥ç³»ç»ŸæœåŠ¡ï¼›</p>
<p>(3)View æ˜¯ â€œå¹²æ´»çš„â€ï¼šå®Œæˆå…·ä½“çš„æ¸²æŸ“å’Œäº¤äº’ï¼Œä¸å…³å¿ƒç”Ÿå‘½å‘¨æœŸå’Œç³»ç»Ÿé€šä¿¡ã€‚</p>
</blockquote>
<h2 data-id="heading-6">ActivityManagerService</h2>
<p>AMSï¼ˆActivityManagerServiceï¼‰æ˜¯System Serverä¸­æœ€æ ¸å¿ƒçš„æœåŠ¡ï¼Œ<strong>ä»¥Activityä¸ºåŸºæœ¬é¢—ç²’åº¦</strong>ï¼Œå®ç°å¯¹åº”ç”¨çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡æ§</p>
<p>AMSï¼šåŸºäºActivityç®¡æ§Appç”Ÿå‘½å‘¨æœŸã€è¿›ç¨‹è°ƒåº¦ä¸èµ„æºåˆ†é…</p>
<h3 data-id="heading-7">1. æ ¸å¿ƒèŒè´£</h3>
<ul>
<li><strong>Activityç”Ÿå‘½å‘¨æœŸç®¡æ§</strong>ï¼šé€šè¿‡<code>ActivityStack</code>/<code>ATMS</code>ï¼ˆAndroid 10+æ‹†åˆ†ï¼‰ç®¡ç†Activityä»»åŠ¡æ ˆï¼Œè§¦å‘Activityçš„<code>onCreate()</code>/<code>onResume()</code>ç­‰ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œå¤„ç†é¡µé¢è·³è½¬ã€å›é€€ã€å¤šä»»åŠ¡åˆ‡æ¢ï¼›</li>
<li><strong>è¿›ç¨‹è°ƒåº¦</strong>ï¼šæ ¹æ®Activityçš„å¯åŠ¨éœ€æ±‚ï¼Œé€šè¿‡Zygoteå­µåŒ–åº”ç”¨è¿›ç¨‹ï¼›ç»´æŠ¤è¿›ç¨‹ä¼˜å…ˆçº§ï¼ˆå‰å°è¿›ç¨‹&gt;å¯è§è¿›ç¨‹&gt;åå°è¿›ç¨‹ï¼‰ï¼Œè§¦å‘ä½å†…å­˜å›æ”¶ï¼ˆLMKï¼‰æ€æ­»ä½ä¼˜å…ˆçº§è¿›ç¨‹ï¼›</li>
<li><strong>èµ„æºåˆ†é…ä¸æƒé™ç®¡æ§</strong>ï¼šä»²è£ä¸åŒåº”ç”¨çš„èµ„æºç«äº‰ï¼ˆå¦‚CPU/å†…å­˜åˆ†é…ï¼‰ï¼Œæ ¡éªŒActivityå¯åŠ¨çš„æƒé™ï¼ˆå¦‚åå°å¯åŠ¨Activityçš„é™åˆ¶ï¼‰ï¼Œæ˜¯åº”ç”¨ä¸ç³»ç»Ÿèµ„æºä¹‹é—´çš„â€œä»²è£è€…â€ã€‚</li>
</ul>
<h3 data-id="heading-8">2. AMSä¸<code>View</code>/<code>Activity</code>çš„å…³è”</h3>
<p>AMSä¸ç›´æ¥æ¥è§¦Viewï¼Œä»…é€šè¿‡ç®¡æ§Activityé—´æ¥å½±å“Viewï¼š</p>
<ul>
<li>AMSé€šçŸ¥Activityå¯åŠ¨â€”â€”&gt; Activityåˆ›å»ºViewæ ‘â€”â€”&gt; ViewRootImplè§¦å‘Viewç»˜åˆ¶ï¼›</li>
<li>AMSå°†Activityæ ‡è®°ä¸ºâ€œåå°çŠ¶æ€â€â†’ç³»ç»Ÿé™ä½åº”ç”¨è¿›ç¨‹ä¼˜å…ˆçº§â†’Viewçš„ç»˜åˆ¶å¸§ç‡é™ä½ï¼ˆèŠ‚çœèµ„æºï¼‰ï¼›</li>
<li>AMSé”€æ¯Activityâ€”â€”&gt; Activityé€’å½’é”€æ¯Viewæ ‘ â€”â€”&gt; Viewé‡Šæ”¾èµ„æºã€‚</li>
</ul>
<blockquote>
<p>æ ¸å¿ƒæ€»ç»“:</p>
<p>ï¼ˆ1ï¼‰AMSæ˜¯â€œåº”ç”¨å¤§ç®¡å®¶â€ï¼šåªè®¤Activityï¼Œä¸ç®¡Viewï¼Œé€šè¿‡ç®¡æ§Activityå®ç°å¯¹åº”ç”¨çš„æ•´ä½“è°ƒåº¦ï¼›</p>
<p>ï¼ˆ2ï¼‰AMSçš„å†³ç­–ï¼ˆå¦‚è¿›ç¨‹ä¼˜å…ˆçº§ã€ActivityçŠ¶æ€ï¼‰ä¼šé—´æ¥å†³å®šViewçš„æ¸²æŸ“èµ„æºå’Œç”Ÿå‘½å‘¨æœŸã€‚</p>
</blockquote>
<h2 data-id="heading-9">Window</h2>
<h3 data-id="heading-10">1. Windowçš„æœ¬è´¨ï¼šç³»ç»Ÿçº§çš„â€œUIå±•ç¤ºå®¹å™¨â€</h3>
<p>Windowæ˜¯Androidä¸­<strong>æ‰¿è½½æ‰€æœ‰å¯è§†åŒ–å†…å®¹çš„ <code>æŠ½è±¡</code> è½½ä½“</strong>ï¼Œæ˜¯WMSç®¡ç†çš„æœ€å°å•å…ƒï¼Œæ ¸å¿ƒç‰¹å¾ï¼š</p>
<ul>
<li>æ¯ä¸ªActivityé»˜è®¤å¯¹åº”ä¸€ä¸ª<code>PhoneWindow</code>ï¼ˆWindowçš„å­ç±»ï¼‰ï¼ŒActivityçš„Viewæ ‘æœ€ç»ˆæŒ‚è½½åœ¨PhoneWindowçš„DecorViewä¸Šï¼›</li>
<li>Windowæ˜¯â€œæ— å®ä½“çš„ç”»å¸ƒâ€ï¼šæœ¬èº«ä¸å¯è§ï¼Œä½†å®šä¹‰äº†UIçš„æ˜¾ç¤ºåŒºåŸŸã€äº¤äº’è§„åˆ™ï¼Œæ˜¯è¿æ¥Activityä¸WMSçš„æ ¸å¿ƒåª’ä»‹ï¼›</li>
<li>ä¸€ä¸ªåº”ç”¨å¯æ‹¥æœ‰å¤šä¸ªWindowï¼šé™¤äº†Activityçš„ä¸»Windowã€‚ Dialogã€Toastã€æ‚¬æµ®çª—ç­‰éƒ½ä¼šåˆ›å»ºç‹¬ç«‹çš„Windowã€‚</li>
</ul>
<h3 data-id="heading-11">2. Activityä¸Windowçš„ç»‘å®šé€»è¾‘</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f252facadb8414d822d72fd9daa20f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Wk55CD546L5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770472516&amp;x-signature=jIGuJ2GRb6w1YpdDCdRC705PBLM%3D" alt="640.png" loading="lazy"/></p>
<ul>
<li>
<p>DecorViewæ˜¯Windowçš„â€œæ ¹Viewâ€ï¼šå°è£…äº†æ ‡é¢˜æ ã€å¯¼èˆªæ ã€å†…å®¹åŒºç­‰ç³»ç»Ÿçº§UIç»“æ„ï¼ŒActivityçš„Viewæ ‘ä»…å DecorViewçš„â€œå†…å®¹åŒºâ€ï¼›</p>
</li>
<li>
<p>Activityçš„æ ¸å¿ƒä½œç”¨æ˜¯â€œå¡«å……Windowå†…å®¹â€ï¼šWindowç”±ç³»ç»Ÿåˆ›å»ºï¼ŒActivityè´Ÿè´£å°†Viewæ ‘æŒ‚è½½åˆ°Windowä¸Šï¼Œè®©Windowæœ‰â€œå¯æ˜¾ç¤ºçš„å†…å®¹â€ã€‚</p>
</li>
</ul>
<blockquote>
<p>æ ¸å¿ƒæ€»ç»“:</p>
<p>(1) Windowæ˜¯â€œç³»ç»Ÿçº§UIå®¹å™¨â€ï¼ŒWMSä¸“é—¨ç®¡ç†å®ƒï¼›Activityæ˜¯â€œå†…å®¹å¡«å……è€…â€ï¼Œè´Ÿè´£ä¸ºWindowæä¾›Viewæ ‘</p>
<p>(2) å…³ç³»ç±»æ¯”ï¼šWindowæ˜¯â€œç©ºæˆ¿é—´â€ï¼Œ Activityæ˜¯â€œè£…ä¿®å¸ˆå‚…â€ï¼ŒViewæ˜¯â€œå®¶å…·â€â€”â€”å¸ˆå‚…æŠŠå®¶å…·æ”¾è¿›æˆ¿é—´ï¼Œæˆ¿é—´çš„å¤§å°ã€ä½ç½®ç”±ç³»ç»Ÿï¼ˆWMSï¼‰å†³å®šã€‚</p>
</blockquote>
<h2 data-id="heading-12">WindowManagerService</h2>
<p>WMSï¼ˆWindowManagerServiceï¼‰æ˜¯System Serverä¸­è´Ÿè´£çª—å£ç®¡ç†çš„æ ¸å¿ƒæœåŠ¡ï¼Œ<strong>ä»¥Windowä¸ºåŸºæœ¬é¢—ç²’åº¦</strong>ï¼Œå®ç°å¯¹æ‰€æœ‰ç³»ç»Ÿçª—å£çš„ç»Ÿä¸€ç®¡æ§</p>
<p>WMSï¼šåŸºäºWindowå®ç°ç³»ç»Ÿçª—å£çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</p>
<h3 data-id="heading-13">1. æ ¸å¿ƒèŒè´£</h3>
<ul>
<li>Â <strong>Windowç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šä¸ºæ¯ä¸ªWindowåˆ›å»º<code>WindowState</code>å¯¹è±¡ï¼Œç®¡ç†Windowçš„åˆ›å»ºã€æ˜¾ç¤ºã€éšè—ã€é”€æ¯ï¼Œå“åº”AMSçš„Windowåˆ›å»º/é”€æ¯æŒ‡ä»¤ï¼›</li>
<li><strong>çª—å£å±‚çº§ç®¡ç†</strong>ï¼šå®šä¹‰ä¸¥æ ¼çš„çª—å£å±‚çº§è§„åˆ™ï¼ˆä»ä¸‹åˆ°ä¸Šï¼‰ï¼š</li>
</ul>
<blockquote>
<p>å£çº¸å±‚ â†’ åº”ç”¨çª—å£å±‚ï¼ˆActivityï¼‰ â†’ å­çª—å£å±‚ï¼ˆDialogï¼‰ â†’ ç³»ç»Ÿçª—å£å±‚ï¼ˆçŠ¶æ€æ /å¯¼èˆªæ ï¼‰ â†’ æ‚¬æµ®çª—å±‚</p>
</blockquote>
<ul>
<li>
<p><strong>å¸ƒå±€è®¡ç®—</strong>ï¼šç»“åˆDMSæä¾›çš„æ˜¾ç¤ºè®¾å¤‡å‚æ•°ï¼ˆå±å¹•åˆ†è¾¨ç‡ã€å¯ç”¨åŒºåŸŸï¼‰ï¼Œè®¡ç®—æ¯ä¸ªWindowçš„ä½ç½®ã€å¤§å°ï¼Œå¤„ç†åˆ†å±ã€å¤šçª—å£ã€æ‚¬æµ®çª—çš„å¸ƒå±€é€‚é…ï¼›</p>
</li>
<li>
<p><strong>äº‹ä»¶åˆ†å‘</strong>ï¼šæ¥æ”¶InputManagerServiceï¼ˆIMSï¼‰çš„è§¦æ‘¸/æŒ‰é”®äº‹ä»¶ï¼Œæ ¹æ®Windowçš„ä½ç½®ã€ç„¦ç‚¹çŠ¶æ€ï¼Œå°†äº‹ä»¶ç²¾å‡†åˆ†å‘ç»™ç›®æ ‡Windowçš„ViewRootImplï¼›</p>
</li>
<li>
<p><strong>Surfaceç”³è¯·</strong>ï¼šä¸ºæ¯ä¸ªWindowå‘SurfaceFlingerç”³è¯·Surfaceï¼ˆç»˜å›¾ç¼“å†²åŒºï¼‰ï¼Œç»´æŠ¤Windowä¸Surfaceçš„ç»‘å®šå…³ç³»ã€‚</p>
</li>
</ul>
<h3 data-id="heading-14">2. WMSä¸å…¶ä»–ç»„ä»¶çš„å…³è”</h3>
<ul>
<li>ä¸AMSï¼šæ¥æ”¶AMSçš„Windowåˆ›å»ºæŒ‡ä»¤ï¼Œå‘AMSåé¦ˆWindowçš„ç„¦ç‚¹/å¯è§çŠ¶æ€ï¼ˆå¦‚Windowéšè—â†’AMSè§¦å‘Activity.onPauseï¼‰ï¼›</li>
<li>ä¸DMS(DeviceManagerService)ï¼šè·å–æ˜¾ç¤ºè®¾å¤‡çš„é…ç½®ï¼ˆåˆ†è¾¨ç‡ã€åˆ·æ–°ç‡ï¼‰ï¼Œé€‚é…å¤šå±æ˜¾ç¤ºçš„Windowå¸ƒå±€ï¼›</li>
<li>ä¸SurfaceFlingerï¼šä¼ é€’Windowçš„å±‚çº§ã€ä½ç½®ä¿¡æ¯ï¼Œè®©SurfaceFlingerå®Œæˆæœ€ç»ˆçš„å›¾å±‚åˆæˆã€‚</li>
</ul>
<blockquote>
<p>æ ¸å¿ƒæ€»ç»“ï¼š</p>
<p>(1) WMSæ˜¯â€œçª—å£æ€»ç®¡ç†å‘˜â€ï¼šç®¡æ‰€æœ‰Windowçš„ä½ç½®ã€å±‚çº§ã€äº¤äº’ï¼Œæ˜¯Windowä¸SurfaceFlingerä¹‹é—´çš„â€œä¸­ä»‹â€</p>
<p>(2) WMSä¸å…³å¿ƒWindowå†…çš„Viewå†…å®¹ï¼Œåªå…³å¿ƒWindowçš„æ•´ä½“å±æ€§ï¼ˆä½ç½®ã€å¤§å°ã€å±‚çº§ï¼‰ã€‚</p>
</blockquote>
<h2 data-id="heading-15">Surface</h2>
<h3 data-id="heading-16">1. Surfaceçš„æœ¬è´¨ï¼šâ€œç»˜å›¾ç¼“å†²åŒºâ€ï¼ˆç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹ï¼‰</h3>
<p>Surfaceæ˜¯Androidä¸­<strong>ç”¨äºç»˜åˆ¶å›¾åƒçš„å†…å­˜ç¼“å†²åŒº</strong>ï¼Œæ ¸å¿ƒç‰¹å¾ï¼š</p>
<ul>
<li>é‡‡ç”¨â€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€æ¨¡å‹ï¼šåº”ç”¨ï¼ˆViewï¼‰æ˜¯â€œç”Ÿäº§è€…â€ï¼Œå‘Surfaceå†™å…¥ç»˜åˆ¶æ•°æ®ï¼›SurfaceFlingeræ˜¯â€œæ¶ˆè´¹è€…â€ï¼Œä»Surfaceè¯»å–æ•°æ®è¿›è¡Œåˆæˆï¼›</li>
<li>æ¯ä¸ªSurfaceå¯¹åº”ä¸€å—<code>GraphicBuffer</code>ï¼ˆåŸºäºGrallocåˆ†é…çš„æ˜¾å­˜ï¼‰ï¼Œé¿å…CPUä¸GPUä¹‹é—´çš„é¢‘ç¹æ•°æ®æ‹·è´ï¼Œä¿è¯æ¸²æŸ“æ€§èƒ½ã€‚</li>
</ul>
<h3 data-id="heading-17">2. Androidç³»ç»Ÿå¸¸è§çš„Surfaceå›¾å±‚ï¼ˆæŒ‰å±‚çº§ä»ä¸‹åˆ°ä¸Šï¼‰</h3>



































<table><thead><tr><th>å›¾å±‚ç±»å‹</th><th>å¯¹åº”Window/Surfaceæ¥æº</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>å£çº¸å±‚</td><td>å£çº¸æœåŠ¡çš„Window</td><td>æ˜¾ç¤ºæ¡Œé¢å£çº¸</td></tr><tr><td>åº”ç”¨çª—å£å±‚</td><td>Activityçš„PhoneWindow</td><td>æ˜¾ç¤ºåº”ç”¨çš„æ ¸å¿ƒUI</td></tr><tr><td>å­çª—å£å±‚</td><td>Dialog/Toastçš„Window</td><td>æ˜¾ç¤ºåº”ç”¨çš„å¼¹çª—/æç¤º</td></tr><tr><td>ç³»ç»Ÿçª—å£å±‚</td><td>çŠ¶æ€æ /å¯¼èˆªæ /é”å±çš„Window</td><td>æ˜¾ç¤ºç³»ç»Ÿæ ¸å¿ƒUI</td></tr><tr><td>æ‚¬æµ®çª—å±‚</td><td>æ‚¬æµ®çª—/è¾“å…¥æ³•çš„Window</td><td>æ˜¾ç¤ºé¡¶å±‚äº¤äº’UI</td></tr></tbody></table>
<h3 data-id="heading-18">3. æ™®é€šViewæ¸²æŸ“åˆ°Surfaceçš„æµç¨‹</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f979fb9dde441eeae35c7872124ab88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Wk55CD546L5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770472516&amp;x-signature=2%2FU8yD96kyVJgnsSVK6oB88%2FO6I%3D" alt="641.png" loading="lazy"/></p>
<ul>
<li>
<p>å…³é”®ç»†èŠ‚ï¼šViewçš„ç»˜åˆ¶æ•°æ®ä¸ä¼šç›´æ¥åˆ°å±å¹•ï¼Œè€Œæ˜¯å…ˆå†™å…¥Surfaceçš„æ˜¾å­˜ç¼“å†²åŒºï¼ŒSurfaceFlingeræŒ‰éœ€è¯»å–ï¼›</p>
</li>
<li>
<p>ViewRootImplæ˜¯Viewä¸Surfaceçš„â€œå†™å…¥ä¸­ä»‹â€ï¼Œè´Ÿè´£å°†Viewæ ‘çš„ç»˜åˆ¶ç»“æœæ‰¹é‡å†™å…¥Surfaceã€‚</p>
</li>
</ul>
<h3 data-id="heading-19">4. ç‰¹æ®ŠViewï¼ˆSurfaceView/TextureViewï¼‰çš„ç‹¬ç«‹Surfaceå¤„ç†</h3>
<p>å¯¹äºè§†é¢‘æ’­æ”¾ã€3Dæ¸²æŸ“ç­‰é«˜æ€§èƒ½åœºæ™¯ï¼Œæ™®é€šViewçš„å…±äº«Surfaceä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆï¼Œå› æ­¤Androidè®¾è®¡äº†ä¸“ç”¨Viewï¼š</p>
<ul>
<li>Â <strong>SurfaceView</strong>ï¼šç”³è¯·<strong>ç‹¬ç«‹çš„Surface</strong>ï¼ˆè„±ç¦»Activityä¸»Windowçš„Surfaceï¼‰ï¼Œç”±WMSå•ç‹¬ç®¡ç†ï¼Œè§†é¢‘æ•°æ®ç›´æ¥å†™å…¥è¯¥Surfaceï¼Œä¸GUIå±‚Surfaceå¹¶è¡Œ</li>
<li><strong>TextureView</strong>ï¼šåŸºäº<code>SurfaceTexture</code>å°è£…ï¼Œå°†è§†é¢‘æ•°æ®è½¬ä¸ºOpenGLçº¹ç†ï¼Œèå…¥æ™®é€šViewæ ‘ï¼ˆæ— ç‹¬ç«‹Surfaceï¼‰ï¼Œæ”¯æŒå¯¹è§†é¢‘çš„è£å‰ªã€æ—‹è½¬ç­‰æ“ä½œ</li>
<li>æ ¸å¿ƒå·®å¼‚ï¼šSurfaceViewæœ‰ç‹¬ç«‹Layer(å±‚)ï¼Œæ€§èƒ½æ›´é«˜ï¼›TextureViewæ— ç‹¬ç«‹Layerï¼Œçµæ´»æ€§æ›´å¼ºã€‚</li>
</ul>
<blockquote>
<p>æ ¸å¿ƒæ€»ç»“:</p>
<p>Surfaceæ˜¯â€œç»˜å›¾æ˜¾å­˜ç¼“å†²åŒºâ€ï¼Œæ˜¯Viewç»˜åˆ¶æ•°æ®ä¸SurfaceFlingerä¹‹é—´çš„â€œæ•°æ®è½½ä½“â€</p>
<p>æ™®é€šViewå…±äº«Activityä¸»Windowçš„Surfaceï¼Œç‰¹æ®ŠViewæ‹¥æœ‰ç‹¬ç«‹Surfaceï¼Œæ»¡è¶³é«˜æ€§èƒ½æ¸²æŸ“éœ€æ±‚ã€‚</p>
</blockquote>
<h2 data-id="heading-20">SurfaceFlinger</h2>
<p>SurfaceFlingerç®¡ç†Surfaceåˆæˆåˆ°Display(æ˜¾ç¤ºå™¨)ï¼ŒVSyncåŒæ­¥æ•´ä¸ªæ˜¾ç¤ºæ¡†æ¶</p>
<h3 data-id="heading-21">1. DMSï¼šDisplayçš„â€œç¡¬ä»¶ç®¡å®¶â€</h3>
<p>DMSï¼ˆDisplayManagerServiceï¼‰æ˜¯æ˜¾ç¤ºè®¾å¤‡çš„åŸºç¡€ç®¡ç†æœåŠ¡ï¼Œæ ¸å¿ƒä½œç”¨ï¼š</p>
<ul>
<li>ç®¡ç†ç‰©ç†/è™šæ‹Ÿæ˜¾ç¤ºè®¾å¤‡ï¼ˆä¸»å±ã€å¤–æ¥æ˜¾ç¤ºå™¨ã€æŠ•å±ï¼‰ï¼Œç»´æŠ¤æ˜¾ç¤ºå‚æ•°ï¼ˆåˆ†è¾¨ç‡ã€åˆ·æ–°ç‡ã€è‰²åŸŸï¼‰ï¼›</li>
<li>å‘WMS/SurfaceFlingeræä¾›æ˜¾ç¤ºè®¾å¤‡çš„ç¡¬ä»¶ä¿¡æ¯ï¼Œæ˜¯â€œæ˜¾ç¤ºç¡¬ä»¶ä¸ç³»ç»ŸæœåŠ¡çš„ä¸­ä»‹â€ã€‚</li>
</ul>
<h3 data-id="heading-22">2. SurfaceFlingerï¼šå›¾å±‚åˆæˆçš„â€œæœ€ç»ˆæ‰§è¡Œè€…â€</h3>
<p>SurfaceFlingeræ˜¯è¿è¡Œåœ¨ç‹¬ç«‹è¿›ç¨‹çš„æ ¸å¿ƒæœåŠ¡ï¼Œè´Ÿè´£å°†æ‰€æœ‰Surfaceåˆæˆä¸ºæœ€ç»ˆçš„å±å¹•å›¾åƒ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13b519a1688d4d9382bd2495f046b187~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Wk55CD546L5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770472516&amp;x-signature=Kbdcsx7F3pfD64WzfU95MYPj5u0%3D" alt="ac03294ad81fbe00a3d7ffd9edc79e81.png" loading="lazy"/></p>
<p>â€¢ åˆæˆæ–¹å¼ï¼šä¼˜å…ˆä½¿ç”¨HWCï¼ˆç¡¬ä»¶åˆæˆï¼‰ï¼Œç”±æ˜¾ç¤ºèŠ¯ç‰‡ç›´æ¥åˆæˆå›¾å±‚ï¼Œæ€§èƒ½é«˜ã€åŠŸè€—ä½ï¼›å¤æ‚åœºæ™¯ç”¨GPUåˆæˆã€‚</p>
<h3 data-id="heading-23">3. VSyncä¿¡å·ï¼šæ•´ä¸ªæ˜¾ç¤ºæ¡†æ¶çš„â€œåŒæ­¥æ—¶é’Ÿâ€</h3>
<p>VSyncï¼ˆå‚ç›´åŒæ­¥ï¼‰ä¿¡å·ç”±Displayç¡¬ä»¶ç”Ÿæˆï¼ˆå¦‚60Hzå±å¹•æ¯16.6msä¸€æ¬¡ï¼‰ï¼Œæ ¸å¿ƒä½œç”¨ï¼š</p>
<ul>
<li>åŒæ­¥Viewç»˜åˆ¶ï¼š<code>Choreographer</code>æ¥æ”¶VSyncä¿¡å·åï¼Œè§¦å‘ViewRootImplçš„<code>performTraversals()</code>ï¼ˆmeasure/layout/drawï¼‰ï¼Œä¿è¯Viewç»˜åˆ¶èŠ‚å¥ä¸å±å¹•åˆ·æ–°ç‡ä¸€è‡´ï¼›</li>
<li>åŒæ­¥SurfaceFlingeråˆæˆï¼šSurfaceFlingeråœ¨VSyncä¿¡å·åˆ°æ¥æ—¶ï¼Œç»Ÿä¸€åˆæˆæ‰€æœ‰Layerï¼Œé¿å…â€œå±å¹•æ’•è£‚â€ï¼›</li>
<li>æ ¸å¿ƒä»·å€¼ï¼šæ¶ˆé™¤ç»˜åˆ¶ä¸åˆæˆçš„å¼‚æ­¥æ€§ï¼Œä¿è¯ç”»é¢æµç•…ã€‚</li>
</ul>
<blockquote>
<p>æ ¸å¿ƒæ€»ç»“:</p>
<p>(1) DMS(DisplayManagerService)ç®¡â€œæ˜¾ç¤ºç¡¬ä»¶å‚æ•°â€ï¼Œ  SurfaceFlingerç®¡â€œå›¾å±‚åˆæˆâ€</p>
<p>(2) VSyncæ˜¯â€œå…¨å±€åŒæ­¥æ—¶é’Ÿâ€ï¼Œè®©Viewç»˜åˆ¶ã€SurfaceFlingeråˆæˆã€å±å¹•æ˜¾ç¤ºä¿æŒèŠ‚å¥ä¸€è‡´</p>
<p>(3) FrameBufferæ˜¯â€œæœ€ç»ˆå¸§ç¼“å†²åŒºâ€ï¼Œåˆæˆåçš„å›¾åƒå†™å…¥æ­¤å¤„ï¼Œç”±Displayç¡¬ä»¶ç›´æ¥è¯»å–æ˜¾ç¤ºã€‚</p>
</blockquote>
<h2 data-id="heading-24">å®Œæ•´é“¾è·¯æ€»ç»“ï¼ˆViewâ†’Displayï¼‰</h2>
<pre><code class="hljs language-sql" lang="sql">ç”¨æˆ·æ“ä½œâ†’<span class="hljs-keyword">View</span>æ¥æ”¶äº¤äº’äº‹ä»¶â†’Activityå¤„ç†ä¸šåŠ¡é€»è¾‘â†’AMSç®¡æ§Activityç”Ÿå‘½å‘¨æœŸâ†’  
Activityå¡«å……<span class="hljs-keyword">Window</span>å†…å®¹â†’WMSç®¡ç†<span class="hljs-keyword">Window</span>å¸ƒå±€<span class="hljs-operator">/</span>å±‚çº§â†’WMSä¸º<span class="hljs-keyword">Window</span>ç”³è¯·Surfaceâ†’  
<span class="hljs-keyword">View</span>ç»˜åˆ¶æ•°æ®å†™å…¥Surfaceâ†’SurfaceFlingeråˆæˆæ‰€æœ‰Surfaceçš„Layerâ†’  
SurfaceFlingerå°†åˆæˆå›¾åƒå†™å…¥FrameBufferâ†’Displayç¡¬ä»¶æ˜¾ç¤ºå›¾åƒ
</code></pre>
<h3 data-id="heading-25">å„æ ¸å¿ƒç»„ä»¶çš„å…³é”®è§’è‰²</h3>
<ol>
<li>AMS(ActivityManagerService)ï¼šç®¡æ§Activityç”Ÿå‘½å‘¨æœŸã€è¿›ç¨‹è°ƒåº¦ï¼Œæ˜¯â€œåº”ç”¨èµ„æºçš„ä»²è£è€…â€ï¼›</li>
<li>WMS(windowManagerService)ï¼šç®¡æ§Windowå¸ƒå±€ã€å±‚çº§ã€äº‹ä»¶åˆ†å‘ï¼Œæ˜¯â€œçª—å£çš„ç®¡ç†è€…â€ï¼›</li>
<li>DMS(DisplayMnagerService)ï¼šç®¡æ§æ˜¾ç¤ºè®¾å¤‡å‚æ•°ï¼Œæ˜¯â€œæ˜¾ç¤ºç¡¬ä»¶çš„ä¸­ä»‹â€ï¼›</li>
<li>SurfaceFlingerï¼šç®¡æ§å›¾å±‚åˆæˆã€VSyncåŒæ­¥ï¼Œæ˜¯â€œå›¾åƒåˆæˆçš„æœ€ç»ˆæ‰§è¡Œè€…â€ï¼›</li>
<li>Activityï¼šViewçš„ç”Ÿå‘½å‘¨æœŸæ€»ç®¡ï¼ŒWindowçš„å†…å®¹å¡«å……è€…ï¼›</li>
<li>Viewï¼šUIæ¸²æŸ“ä¸äº¤äº’çš„æœ€å°å•å…ƒï¼ŒSurfaceçš„æ•°æ®ç”Ÿäº§è€…ï¼›</li>
<li>Windowï¼šWMSçš„ç®¡ç†å•å…ƒï¼ŒSurfaceçš„è½½ä½“ï¼›</li>
<li>Surfaceï¼š Viewç»˜åˆ¶æ•°æ®çš„æ˜¾å­˜ç¼“å†²åŒºï¼ŒLayerçš„æ•°æ®æ¥æºã€‚</li>
</ol>
<blockquote>
<p>æ ¸å¿ƒå…³é”®ç‚¹å›é¡¾:</p>
<ol>
<li>
<p>æ•´ä¸ªæ˜¾ç¤ºä½“ç³»çš„æ ¸å¿ƒé€»è¾‘æ˜¯â€œåˆ†å±‚è§£è€¦â€ï¼šViewç®¡ç»˜åˆ¶ã€Activityç®¡ç”Ÿå‘½å‘¨æœŸã€Windowç®¡ç³»ç»Ÿäº¤äº’ã€Surfaceç®¡æ•°æ®è½½ä½“ã€SurfaceFlingerç®¡åˆæˆã€Displayç®¡ç¡¬ä»¶è¾“å‡ºï¼›</p>
</li>
<li>
<p>AMS/WMS/DMS/SurfaceFlingerå„å¸å…¶èŒï¼šAMSç®¡åº”ç”¨ã€WMSç®¡çª—å£ã€DMSç®¡æ˜¾ç¤ºç¡¬ä»¶ã€SurfaceFlingerç®¡å›¾åƒåˆæˆï¼›</p>
</li>
<li>
<p>VSyncä¿¡å·æ˜¯å…¨å±€åŒæ­¥æ ¸å¿ƒï¼Œä¿è¯ç»˜åˆ¶ã€åˆæˆã€æ˜¾ç¤ºçš„èŠ‚å¥ä¸€è‡´ï¼Œæ˜¯ç”»é¢æµç•…çš„å…³é”®ã€‚</p>
</li>
</ol>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/364a1f927c7b4392a509e682ba8800dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Wk55CD546L5a2Q:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770472516&amp;x-signature=zirDECNWsSC%2BdxmqgCOnRct5rss%3D" alt="image.png" loading="lazy"/></p>
<p>å­¦ä¹ æ€»ç»“æ¥è‡ªï¼š
<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FoIL3Ox90bTNI4-q89PV4_w" target="_blank" title="https://mp.weixin.qq.com/s/oIL3Ox90bTNI4-q89PV4_w" ref="nofollow noopener noreferrer">Linuxç³»ç»Ÿæ¡†æ¶ï¼ˆä¸‰ï¼‰Androidæ˜¾ç¤ºä½“ç³»é“¾è·¯è§£æï¼šä»Viewåˆ°Displayçš„æµè½¬</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RxSwift ä¸­ asDriver() è¯¦è§£]]></title>    <link>https://juejin.cn/post/7601075423002394660</link>    <guid>https://juejin.cn/post/7601075423002394660</guid>    <pubDate>2026-01-31T12:43:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601075423002394660" data-draft-id="7601075423002378276" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RxSwift ä¸­ asDriver() è¯¦è§£"/> <meta itemprop="keywords" content="RxSwift"/> <meta itemprop="datePublished" content="2026-01-31T12:43:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¼ºå“¥å°±æ˜¯å…‰å¤´å¼ºå‘—"/> <meta itemprop="url" content="https://juejin.cn/user/2647279732269783"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RxSwift ä¸­ asDriver() è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2647279732269783/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¼ºå“¥å°±æ˜¯å…‰å¤´å¼ºå‘—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T12:43:08.000Z" title="Sat Jan 31 2026 12:43:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    2
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡ä»ã€Œæ˜¯ä»€ä¹ˆã€ä¸ºä»€ä¹ˆç”¨ã€æ€ä¹ˆç”¨ã€ä¸‰ä¸ªå±‚é¢ï¼Œè¯¦ç»†è®²è§£ RxSwift ä¸­çš„ asDriver() æ–¹æ³•ï¼Œé€‚é…æ–°æ‰‹ç†è§£ï¼Œå…¼é¡¾å®ç”¨æ€§å’Œæ˜“æ‡‚æ€§ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€asDriver() æ ¸å¿ƒå«ä¹‰</h2>
<p><code>asDriver()</code> æ˜¯ RxSwift ä¸­ä¸“é—¨ç”¨äºå°† <strong><code>Observable</code></strong> ** åºåˆ—ï¼ˆæˆ–å…¶ä»–å¯è½¬æ¢åºåˆ—ï¼Œå¦‚ ** <strong><code>Single</code></strong> <strong>ã€</strong> <strong><code>Maybe</code></strong> <strong>ï¼‰è½¬æ¢ä¸º ** <strong><code>Driver</code></strong> ** åºåˆ—</strong> çš„æ–¹æ³•ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªã€Œåºåˆ—ç±»å‹è½¬æ¢å™¨ã€ï¼šè¾“å…¥ä¸º <code>Observable</code>ï¼Œè¾“å‡ºä¸º <code>Driver</code>ï¼Œä¸”è½¬æ¢è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨ä¸ºåºåˆ—é™„åŠ  Driver ç‰¹æœ‰çš„ã€ŒUI å‹å¥½å‹å®‰å…¨ç‰¹æ€§ã€ï¼Œæ— éœ€æ‰‹åŠ¨é¢å¤–é…ç½®ã€‚</p>
<p>è¡¥å……å‰æï¼š<code>Driver</code> å¹¶éå…¨æ–°åºåˆ—ç±»å‹ï¼Œè€Œæ˜¯ <code>Observable</code> çš„ã€Œä¸“ç”¨å­ç±»/ç‰¹æ®Šå°è£…ã€ï¼Œä¸“é—¨é’ˆå¯¹ <strong>UI</strong> ** ç»‘å®šåœºæ™¯**ï¼ˆå¦‚æ›´æ–° Label æ–‡æœ¬ã€åˆ·æ–° TableView æ•°æ®ã€ä¿®æ”¹æŒ‰é’®çŠ¶æ€ç­‰ï¼‰è®¾è®¡ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºã€ŒUI å‹å¥½å‹åºåˆ—ã€ã€‚</p>
<h2 data-id="heading-1">äºŒã€asDriver() è‡ªåŠ¨é™„åŠ çš„ 3 ä¸ªå…³é”®å®‰å…¨ç‰¹æ€§</h2>
<p>è¿™æ˜¯ <code>Driver</code> çš„æ ¸å¿ƒä»·å€¼ï¼Œä¹Ÿæ˜¯ <code>asDriver()</code> çš„æ ¸å¿ƒæ„ä¹‰â€”â€”è‡ªåŠ¨è§„é¿ UI å¼€å‘ä¸­å¸¸è§çš„ 3 ä¸ªå‘ï¼Œå‡å°‘å†—ä½™ä»£ç ï¼š</p>
<h3 data-id="heading-2">1. ç¡®ä¿åœ¨ä¸»çº¿ç¨‹è®¢é˜…/å‘é€äº‹ä»¶</h3>
<p>UI æ“ä½œå¿…é¡»åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œï¼ˆå¦åˆ™ä¼šå´©æºƒæˆ–ç•Œé¢é”™ä¹±ï¼‰ï¼Œ<code>asDriver()</code> ä¼šè‡ªåŠ¨å°†åºåˆ—çš„äº‹ä»¶æ´¾å‘åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™ <code>observe(on: MainScheduler.instance)</code>ã€‚</p>
<h3 data-id="heading-3">2. ç¡®ä¿åºåˆ—ä¸ä¼šå‘é€ Error äº‹ä»¶</h3>
<p><code>Driver</code> åºåˆ—ä»…æ”¯æŒå‘é€ <code>next</code>ï¼ˆä¼ é€’æ•°æ®ï¼‰å’Œ <code>completed</code>ï¼ˆåºåˆ—ç»“æŸï¼‰äº‹ä»¶ï¼Œ<strong>ä¸æ”¯æŒå‘é€ Error</strong> ** äº‹ä»¶**ã€‚è‹¥åŸå§‹ <code>Observable</code> å¯èƒ½å‘é€é”™è¯¯ï¼Œ<code>asDriver()</code> è¦æ±‚å¿…é¡»æä¾›ã€Œé”™è¯¯å…œåº•å€¼ã€ï¼ˆæˆ–é”™è¯¯å¤„ç†é€»è¾‘ï¼‰ï¼Œé¿å… UI ç»‘å®šé“¾è·¯å› é”™è¯¯ä¸­æ–­ã€‚</p>
<h3 data-id="heading-4">3. å…·å¤‡ã€Œå…±äº«è®¢é˜…ã€ï¼ˆå…±äº«äº‹ä»¶æµï¼‰ç‰¹æ€§</h3>
<p>å¯¹åº” RxSwift ä¸­çš„ <code>share(replay: 1, scope: .whileConnected)</code>ï¼Œå¤šä¸ªè§‚å¯Ÿè€…è®¢é˜…åŒä¸€ä¸ª <code>Driver </code>åºåˆ—æ—¶ï¼Œä¸ä¼šé‡å¤æ‰§è¡Œä¸Šæ¸¸é€»è¾‘ï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ•°æ®åº“æŸ¥è¯¢ï¼‰ï¼Œä»…å…±äº«ä¸€ä»½äº‹ä»¶æµï¼Œæ—¢èŠ‚çœèµ„æºï¼Œåˆèƒ½ä¿è¯å¤šä¸ª UI ç»„ä»¶æ‹¿åˆ°çš„æ•°æ®ä¸€è‡´ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€ä¸ºä»€ä¹ˆéœ€è¦ç”¨ asDriver()ï¼ˆé€‚ç”¨åœºæ™¯ï¼‰</h2>
<p>æ ¸å¿ƒåœºæ™¯ï¼š<strong>å½“éœ€è¦å°† Rx åºåˆ—çš„ç»“æœç»‘å®šåˆ° UI æ§ä»¶æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ ** <strong><code>asDriver()</code></strong> ** è½¬æ¢ä¸º ** <strong><code>Driver</code></strong> ** åºåˆ—</strong>ã€‚</p>
<h3 data-id="heading-6">åä¾‹ï¼šç›´æ¥ç”¨ Observable ç»‘å®š UIï¼ˆéœ€æ‰‹åŠ¨å¤„ç†å®‰å…¨é—®é¢˜ï¼‰</h3>
<pre><code class="hljs language-swift" lang="swift">
<span class="hljs-comment">// ç›´æ¥ç”¨ Observable ç»‘å®š UIï¼Œéœ€æ‰‹åŠ¨å¤„ç† 3 ä¸ªå®‰å…¨é—®é¢˜</span>
someObservable
    .observe(on: <span class="hljs-type">MainScheduler</span>.instance) <span class="hljs-comment">// 1. åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹</span>
    .catch { error <span class="hljs-keyword">in</span> <span class="hljs-type">Observable</span>.just(<span class="hljs-string">"é»˜è®¤å€¼"</span>) } <span class="hljs-comment">// 2. æ•è·é”™è¯¯ï¼Œé¿å…é“¾è·¯ä¸­æ–­</span>
    .share(replay: <span class="hljs-number">1</span>, scope: .whileConnected) <span class="hljs-comment">// 3. å…±äº«è®¢é˜…</span>
    .bind(to: label.rx.text)
    .disposed(by: disposeBag)
</code></pre>
<h3 data-id="heading-7">æ­£ä¾‹ï¼šç”¨ asDriver() ç»‘å®š UIï¼ˆè‡ªåŠ¨å¤„ç†å®‰å…¨é—®é¢˜ï¼Œä»£ç ç®€æ´ï¼‰</h3>
<pre><code class="hljs language-swift" lang="swift">
<span class="hljs-comment">// asDriver() è‡ªåŠ¨å¤„ç†å®‰å…¨é—®é¢˜ï¼Œä»£ç æ›´ç®€æ´</span>
someObservable
    .asDriver(onErrorJustReturn: <span class="hljs-string">"é»˜è®¤å€¼"</span>) <span class="hljs-comment">// è½¬æ¢ä¸º Driverï¼ŒæŒ‡å®šé”™è¯¯å…œåº•å€¼</span>
    .drive(label.rx.text) <span class="hljs-comment">// Driver ä¸“ç”¨ç»‘å®šæ–¹æ³•ï¼ˆæ›¿ä»£ bindï¼‰</span>
    .disposed(by: disposeBag)
</code></pre>
<h2 data-id="heading-8">å››ã€asDriver() çš„å¸¸è§ç”¨æ³•</h2>
<p><code>asDriver() </code>æœ‰ä¸¤ä¸ªå¸¸ç”¨é‡è½½æ–¹æ³•ï¼Œå¯¹åº”ä¸åŒé”™è¯¯åœºæ™¯ï¼š</p>
<h3 data-id="heading-9">åœºæ™¯ 1ï¼šåŸå§‹åºåˆ—å¯èƒ½å‘é€é”™è¯¯ï¼ˆéœ€å…œåº•å€¼ï¼‰</h3>
<p>ä½¿ç”¨ <code>asDriver(onErrorJustReturn:)</code>ï¼Œä¼ å…¥ã€Œé”™è¯¯æ—¶åºåˆ—è¦å‘é€çš„é»˜è®¤å€¼ã€ï¼Œé”™è¯¯ä¼šè¢«è‡ªåŠ¨æ•è·ï¼Œåºåˆ—å‘é€é»˜è®¤å€¼åæ­£å¸¸ç»“æŸï¼Œä¸ä¸­æ–­é“¾è·¯ã€‚</p>
<pre><code class="hljs language-swift" lang="swift">
<span class="hljs-comment">// ç¤ºä¾‹ï¼šç½‘ç»œè¯·æ±‚ç»“æœç»‘å®šåˆ° UIï¼ˆç½‘ç»œè¯·æ±‚å¯èƒ½å¤±è´¥ï¼Œéœ€å…œåº•ï¼‰</span>
<span class="hljs-keyword">let</span> networkRequest: <span class="hljs-type">Observable</span>&lt;<span class="hljs-type">String</span>&gt; <span class="hljs-operator">=</span> fetchDataFromServer() <span class="hljs-comment">// å‡è®¾æ˜¯ç½‘ç»œè¯·æ±‚åºåˆ—</span>

networkRequest
    .asDriver(onErrorJustReturn: <span class="hljs-string">"ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œè¯·é‡è¯•"</span>) <span class="hljs-comment">// é”™è¯¯å…œåº•æ–‡æœ¬</span>
    .drive(label.rx.text) <span class="hljs-comment">// ç»‘å®šåˆ° UILabel</span>
    .disposed(by: disposeBag)
</code></pre>
<h3 data-id="heading-10">åœºæ™¯ 2ï¼šåŸå§‹åºåˆ—ä¸å¯èƒ½å‘é€é”™è¯¯ï¼ˆå¦‚æœ¬åœ°æ•°æ®ã€UI äº‹ä»¶ï¼‰</h3>
<p>ç›´æ¥ä½¿ç”¨<code>asDriver()</code>ï¼Œæ— éœ€ä¼ å…¥å…œåº•å€¼ï¼ˆå› åºåˆ—ä¸ä¼šäº§ç”Ÿé”™è¯¯ï¼‰ã€‚</p>
<pre><code class="hljs language-swift" lang="swift">
<span class="hljs-comment">// ç¤ºä¾‹ï¼šæŒ‰é’®ç‚¹å‡»äº‹ä»¶è½¬æ¢ä¸º Driverï¼ˆæŒ‰é’®ç‚¹å‡»ä¸ä¼šæœ‰é”™è¯¯ï¼‰</span>
<span class="hljs-keyword">let</span> buttonTap: <span class="hljs-type">Observable</span>&lt;<span class="hljs-type">Void</span>&gt; <span class="hljs-operator">=</span> button.rx.tap

buttonTap
    .asDriver() <span class="hljs-comment">// æ— éœ€å…œåº•å€¼ï¼Œç›´æ¥è½¬æ¢</span>
    .drive(onNext: {
        <span class="hljs-built_in">print</span>(<span class="hljs-string">"æŒ‰é’®è¢«ç‚¹å‡»äº†"</span>)
        <span class="hljs-comment">// æ‰§è¡Œ UI æ“ä½œï¼Œæ— éœ€æ‹…å¿ƒçº¿ç¨‹é—®é¢˜</span>
    })
    .disposed(by: disposeBag)
</code></pre>
<h2 data-id="heading-11">äº”ã€è¡¥å……ï¼šDriver ä¸“ç”¨ç»‘å®šæ–¹æ³• drive()</h2>
<p>åºåˆ—è¢« <code>asDriver()</code> è½¬æ¢ä¸º <code>Driver</code> åï¼Œæ¨èä½¿ç”¨ <code>drive()</code> ç»‘å®šï¼Œè€Œé <code>bind()</code>ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p>è¯­ä¹‰æ›´æ¸…æ™°ï¼š<code>drive() </code>æ„ä¸ºã€Œé©±åŠ¨ UI å˜åŒ–ã€ï¼Œæ˜ç¡®é€‚é… UI ç»‘å®šåœºæ™¯ï¼›</p>
</li>
<li>
<p>æ›´å®‰å…¨ï¼š<code>drive() </code>å†…éƒ¨å·²é»˜è®¤å¤„ç† UI ç»‘å®šçš„ç›¸å…³ç»†èŠ‚ï¼Œé¿å…æ„å¤–ç»‘å®šåˆ°é UI åœºæ™¯ã€‚</p>
</li>
</ul>
<h2 data-id="heading-12">å…­ã€æ€»ç»“</h2>
<ol>
<li>
<p><code>asDriver() </code>æ˜¯ RxSwift ä¸­**ã€Œå°† ** <strong><code>Observable</code></strong> ** è½¬æ¢ä¸º ** <strong><code>Driver</code></strong> ** åºåˆ—ã€**çš„ä¸“ç”¨æ–¹æ³•ï¼Œæ ¸å¿ƒæœåŠ¡äº UI ç»‘å®šåœºæ™¯ï¼›</p>
</li>
<li>
<p>è½¬æ¢åè‡ªåŠ¨è·å¾— 3 ä¸ªå®‰å…¨ç‰¹æ€§ï¼š<strong>ä¸»çº¿ç¨‹æ‰§è¡Œã€ä¸å‘é€é”™è¯¯ã€å…±äº«è®¢é˜…</strong>ï¼Œå‡å°‘æ‰‹åŠ¨å†—ä½™ä»£ç ï¼›</p>
</li>
<li>
<p>ç”¨æ³•åŒºåˆ†ï¼šåºåˆ—å¯èƒ½å‡ºé”™ç”¨ <code>asDriver(onErrorJustReturn:)</code>ï¼Œä¸å¯èƒ½å‡ºé”™ç”¨ <code>asDriver()</code>ï¼ŒUI ç»‘å®šä¼˜å…ˆç”¨ <code>drive()</code>ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MCP åè®®å®æˆ˜ï¼šç”¨ 50 è¡Œä»£ç è®©ä½ çš„ AI åº”ç”¨æ¥ä¸Šä»»æ„å·¥å…·]]></title>    <link>https://juejin.cn/post/7600989427907035190</link>    <guid>https://juejin.cn/post/7600989427907035190</guid>    <pubDate>2026-01-31T10:40:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600989427907035190" data-draft-id="7601053058856599558" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MCP åè®®å®æˆ˜ï¼šç”¨ 50 è¡Œä»£ç è®©ä½ çš„ AI åº”ç”¨æ¥ä¸Šä»»æ„å·¥å…·"/> <meta itemprop="keywords" content="Python"/> <meta itemprop="datePublished" content="2026-01-31T10:40:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜Agions"/> <meta itemprop="url" content="https://juejin.cn/user/360295545187751"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MCP åè®®å®æˆ˜ï¼šç”¨ 50 è¡Œä»£ç è®©ä½ çš„ AI åº”ç”¨æ¥ä¸Šä»»æ„å·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295545187751/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜Agions
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T10:40:41.000Z" title="Sat Jan 31 2026 10:40:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p><strong>å¯¼è¯»</strong>ï¼šå¦‚æœ2025å¹´æ˜¯ AI Agent å…ƒå¹´ï¼Œé‚£ä¹ˆ MCPï¼ˆModel Context Protocolï¼‰å°±æ˜¯è¿™åœºé©å‘½çš„ TCP/IPã€‚è¿™ä¸ªç”± Anthropic å¼€æºçš„åè®®ï¼Œæ­£åœ¨æˆä¸º AI åº”ç”¨ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’çš„æ ‡å‡†æ¥å£ã€‚ä»Šå¤©æˆ‘ä»¬ä¸è®²æ¦‚å¿µï¼Œç›´æ¥ä¸Šæ‰‹â€”â€”ç”¨ Python ä»é›¶å®ç°ä¸€ä¸ª MCP Serverï¼Œè®©ä½ çš„ AI èƒ½è¯»å†™æœ¬åœ°æ–‡ä»¶ã€‚</p>
</blockquote>
<hr/>
<p>æœ€è¿‘åœ¨ Hacker News ä¸Šï¼Œæœ‰ä¸ªè®¨è®ºçƒ­åº¦å±…é«˜ä¸ä¸‹ï¼š<strong>"MCP is the HTTP of AI"</strong>ã€‚</p>
<p>å¦‚æœä½ è¿˜æ²¡å¬è¿‡ MCPï¼Œåˆ«æ…Œã€‚ç®€å•è¯´ï¼Œå®ƒè§£å†³çš„æ˜¯ä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜ï¼š</p>
<p><strong>æ€ä¹ˆè®© AI æ¨¡å‹å®‰å…¨ã€æ ‡å‡†åŒ–åœ°è°ƒç”¨å¤–éƒ¨å·¥å…·ï¼Ÿ</strong></p>
<p>ä»¥å‰æ¯å®¶çš„å®ç°éƒ½ä¸ä¸€æ ·ã€‚OpenAI æœ‰ Function Callingï¼ŒLangChain æœ‰è‡ªå·±çš„ Tool æŠ½è±¡ï¼Œå„ç§ Agent æ¡†æ¶ä¹Ÿå„æä¸€å¥—ã€‚è¿™å°±å¯¼è‡´ç”Ÿæ€ç¢ç‰‡åŒ–â€”â€”ä½ åœ¨ ChatGPT é‡Œå®šä¹‰çš„å·¥å…·ï¼Œæ¢åˆ° Claude å°±å¾—é‡å†™ã€‚</p>
<p>MCP çš„ç›®æ ‡å°±æ˜¯ç»Ÿä¸€è¿™ä»¶äº‹ã€‚</p>
<h2 data-id="heading-0">1. MCP æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>MCP å…¨ç§° <strong>Model Context Protocol</strong>ï¼Œç”± Anthropic åœ¨2024å¹´åº•å¼€æºã€‚</p>
<p>å®ƒå®šä¹‰äº†ä¸€å¥—æ ‡å‡†åŒ–çš„é€šä¿¡åè®®ï¼Œè®© AI åº”ç”¨ï¼ˆClientï¼‰å¯ä»¥ä¸å¤–éƒ¨èƒ½åŠ›æä¾›æ–¹ï¼ˆServerï¼‰è¿›è¡Œäº¤äº’ã€‚è¿™äº›èƒ½åŠ›å¯ä»¥æ˜¯ï¼š</p>
<ul>
<li><strong>å·¥å…· (Tools)</strong>ï¼šæ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œæ¯”å¦‚å‘é‚®ä»¶ã€æŸ¥å¤©æ°”</li>
<li><strong>èµ„æº (Resources)</strong>ï¼šè¯»å–æŸä»½æ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶å†…å®¹ã€æ•°æ®åº“è®°å½•</li>
<li><strong>æç¤ºè¯ (Prompts)</strong>ï¼šé¢„å®šä¹‰çš„å¯¹è¯æ¨¡æ¿</li>
</ul>
<p>æ¶æ„å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      MCP Protocol      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚  â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚                 â”‚
â”‚   AI Client     â”‚      (JSON-RPC)        â”‚   MCP Server    â”‚
â”‚  (Claude, etc.) â”‚                        â”‚   (ä½ æ¥å®ç°)     â”‚
â”‚                 â”‚                        â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>é€šä¿¡åŸºäº JSON-RPC 2.0ï¼Œå¯ä»¥è·‘åœ¨ stdioã€HTTP SSE ç­‰ä¼ è¾“å±‚ä¸Šã€‚</p>
<h2 data-id="heading-1">2. å®æˆ˜ï¼šä»é›¶å®ç°ä¸€ä¸ªæ–‡ä»¶ç®¡ç† MCP Server</h2>
<p>è¯´å†å¤šä¸å¦‚å†™ä»£ç ã€‚æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªæœ€ç®€å•çš„ MCP Serverï¼Œæä¾›ä¸¤ä¸ªèƒ½åŠ›ï¼š</p>
<ol>
<li><strong>list_files</strong>ï¼šåˆ—å‡ºæŒ‡å®šç›®å½•çš„æ–‡ä»¶</li>
<li><strong>read_file</strong>ï¼šè¯»å–æŒ‡å®šæ–‡ä»¶çš„å†…å®¹</li>
</ol>
<h3 data-id="heading-2">Step 1: å®‰è£…ä¾èµ–</h3>
<pre><code class="hljs language-bash" lang="bash">pip install mcp
</code></pre>
<h3 data-id="heading-3">Step 2: ç¼–å†™ Server</h3>
<p>åˆ›å»º <code>file_server.py</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> mcp.server <span class="hljs-keyword">import</span> Server
<span class="hljs-keyword">from</span> mcp.server.stdio <span class="hljs-keyword">import</span> stdio_server
<span class="hljs-keyword">from</span> mcp.types <span class="hljs-keyword">import</span> Tool, TextContent

<span class="hljs-comment"># åˆå§‹åŒ– MCP Server</span>
app = Server(<span class="hljs-string">"file-manager"</span>)

<span class="hljs-comment"># å®šä¹‰å·¥å…·ï¼šåˆ—å‡ºç›®å½•æ–‡ä»¶</span>
<span class="hljs-meta">@app.tool()</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">list_files</span>(<span class="hljs-params">directory: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">list</span>[TextContent]:
    <span class="hljs-string">"""
    åˆ—å‡ºæŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
    
    Args:
        directory: è¦åˆ—å‡ºçš„ç›®å½•è·¯å¾„
    """</span>
    <span class="hljs-keyword">try</span>:
        items = os.listdir(directory)
        result = <span class="hljs-string">"\n"</span>.join(items) <span class="hljs-keyword">if</span> items <span class="hljs-keyword">else</span> <span class="hljs-string">"ç›®å½•ä¸ºç©º"</span>
        <span class="hljs-keyword">return</span> [TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=result)]
    <span class="hljs-keyword">except</span> FileNotFoundError:
        <span class="hljs-keyword">return</span> [TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=<span class="hljs-string">f"é”™è¯¯ï¼šç›®å½• <span class="hljs-subst">{directory}</span> ä¸å­˜åœ¨"</span>)]
    <span class="hljs-keyword">except</span> PermissionError:
        <span class="hljs-keyword">return</span> [TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=<span class="hljs-string">f"é”™è¯¯ï¼šæ— æƒé™è®¿é—® <span class="hljs-subst">{directory}</span>"</span>)]


<span class="hljs-comment"># å®šä¹‰å·¥å…·ï¼šè¯»å–æ–‡ä»¶å†…å®¹</span>
<span class="hljs-meta">@app.tool()</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_file</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">list</span>[TextContent]:
    <span class="hljs-string">"""
    è¯»å–æŒ‡å®šæ–‡ä»¶çš„æ–‡æœ¬å†…å®¹ã€‚
    
    Args:
        file_path: è¦è¯»å–çš„æ–‡ä»¶è·¯å¾„
    """</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">"r"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
            content = f.read()
        <span class="hljs-comment"># é™åˆ¶è¿”å›é•¿åº¦ï¼Œé¿å… token çˆ†ç‚¸</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(content) &gt; <span class="hljs-number">10000</span>:
            content = content[:<span class="hljs-number">10000</span>] + <span class="hljs-string">"\n...[å†…å®¹å·²æˆªæ–­]"</span>
        <span class="hljs-keyword">return</span> [TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=content)]
    <span class="hljs-keyword">except</span> FileNotFoundError:
        <span class="hljs-keyword">return</span> [TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=<span class="hljs-string">f"é”™è¯¯ï¼šæ–‡ä»¶ <span class="hljs-subst">{file_path}</span> ä¸å­˜åœ¨"</span>)]
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> [TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=<span class="hljs-string">f"é”™è¯¯ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)]


<span class="hljs-comment"># å¯åŠ¨ Server</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> stdio_server() <span class="hljs-keyword">as</span> (read_stream, write_stream):
        <span class="hljs-keyword">await</span> app.run(
            read_stream,
            write_stream,
            app.create_initialization_options()
        )

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-keyword">import</span> asyncio
    asyncio.run(main())
</code></pre>
<h3 data-id="heading-4">Step 3: é…ç½®åˆ° Claude Desktop</h3>
<p>å¦‚æœä½ ç”¨çš„æ˜¯ Claude Desktopï¼Œåœ¨é…ç½®æ–‡ä»¶ <code>claude_desktop_config.json</code> ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"mcpServers"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"file-manager"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"python"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"/path/to/file_server.py"</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é‡å¯ Claude Desktopï¼Œä½ ä¼šåœ¨å¯¹è¯æ¡†é‡Œçœ‹åˆ°ä¸€ä¸ªæ–°çš„å·¥å…·å›¾æ ‡ã€‚</p>
<p>ç°åœ¨ä½ å¯ä»¥ç›´æ¥å¯¹ Claude è¯´ï¼š</p>
<blockquote>
<p>"å¸®æˆ‘çœ‹çœ‹ /Users/me/Documents ç›®å½•ä¸‹æœ‰ä»€ä¹ˆæ–‡ä»¶"</p>
</blockquote>
<p>Claude ä¼šè‡ªåŠ¨è°ƒç”¨ä½ å†™çš„ <code>list_files</code> å·¥å…·ï¼Œè¿”å›ç»“æœã€‚</p>
<h2 data-id="heading-5">3. è¿›é˜¶ï¼šæ·»åŠ å†™å…¥èƒ½åŠ›</h2>
<p>è¯»å–ä¸å¤Ÿï¼ŸåŠ ä¸ªå†™å…¥åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.tool()</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">write_file</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span>, content: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">list</span>[TextContent]:
    <span class="hljs-string">"""
    å°†å†…å®¹å†™å…¥æŒ‡å®šæ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ä¼šåˆ›å»ºã€‚
    
    Args:
        file_path: ç›®æ ‡æ–‡ä»¶è·¯å¾„
        content: è¦å†™å…¥çš„å†…å®¹
    """</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># å®‰å…¨æ£€æŸ¥ï¼šé™åˆ¶åªèƒ½å†™å…¥ç‰¹å®šç›®å½•</span>
        allowed_dirs = [<span class="hljs-string">"/tmp"</span>, os.path.expanduser(<span class="hljs-string">"~/mcp-sandbox"</span>)]
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">any</span>(file_path.startswith(d) <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> allowed_dirs):
            <span class="hljs-keyword">return</span> [TextContent(
                <span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, 
                text=<span class="hljs-string">f"å®‰å…¨é™åˆ¶ï¼šåªèƒ½å†™å…¥ <span class="hljs-subst">{allowed_dirs}</span> ç›®å½•"</span>
            )]
        
        os.makedirs(os.path.dirname(file_path), exist_ok=<span class="hljs-literal">True</span>)
        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">"w"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
            f.write(content)
        <span class="hljs-keyword">return</span> [TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=<span class="hljs-string">f"æˆåŠŸå†™å…¥ <span class="hljs-subst">{file_path}</span>"</span>)]
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        <span class="hljs-keyword">return</span> [TextContent(<span class="hljs-built_in">type</span>=<span class="hljs-string">"text"</span>, text=<span class="hljs-string">f"å†™å…¥å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)]
</code></pre>
<p>æ³¨æ„é‚£ä¸ªå®‰å…¨æ£€æŸ¥ã€‚<strong>æ°¸è¿œä¸è¦è®© AI æ— é™åˆ¶åœ°å†™å…¥æ–‡ä»¶ç³»ç»Ÿ</strong>â€”â€”è¿™æ˜¯æœ€åŸºæœ¬çš„å®‰å…¨åŸåˆ™ã€‚</p>
<h2 data-id="heading-6">4. ä¸ºä»€ä¹ˆ MCP ä¼šæˆä¸ºæ ‡å‡†ï¼Ÿ</h2>
<p>å‡ ä¸ªåŸå› ï¼š</p>
<ol>
<li><strong>Anthropic çš„èƒŒä¹¦</strong>ï¼šä½œä¸º Claude çš„ä¸œå®¶ï¼ŒAnthropic æœ‰è¶³å¤Ÿçš„å½±å“åŠ›æ¨åŠ¨è¿™ä¸ªæ ‡å‡†ã€‚</li>
<li><strong>åè®®è¶³å¤Ÿç®€å•</strong>ï¼šJSON-RPC æ˜¯æˆç†Ÿçš„åè®®ï¼Œæ²¡æœ‰å‘æ˜æ–°è½®å­ã€‚</li>
<li><strong>ç”Ÿæ€æ­£åœ¨èµ·åŠ¿</strong>ï¼šCursorã€Clineã€Sourcegraph ç­‰ä¸»æµå¼€å‘å·¥å…·éƒ½åœ¨æ¥å…¥ã€‚</li>
<li><strong>è§£å†³äº†çœŸç—›ç‚¹</strong>ï¼šä»¥å‰æ¯ä¸ªå·¥å…·éƒ½è¦å†™é€‚é…å™¨ï¼Œç°åœ¨å†™ä¸€æ¬¡ MCP Serverï¼Œæ‰€æœ‰ Client éƒ½èƒ½ç”¨ã€‚</li>
</ol>
<h2 data-id="heading-7">5. å®ç”¨ Tips</h2>
<ol>
<li>
<p><strong>è°ƒè¯•ç”¨ MCP Inspector</strong>ï¼šå®˜æ–¹æä¾›äº† <code>npx @modelcontextprotocol/inspector</code> å·¥å…·ï¼Œå¯ä»¥å¯è§†åŒ–æµ‹è¯•ä½ çš„ Serverã€‚</p>
</li>
<li>
<p><strong>é”™è¯¯å¤„ç†è¦å……åˆ†</strong>ï¼šAI ä¼šä»¥å„ç§æ„æƒ³ä¸åˆ°çš„æ–¹å¼è°ƒç”¨ä½ çš„å·¥å…·ã€‚è¾¹ç•Œæƒ…å†µä¸€å®šè¦å¤„ç†å¥½ã€‚</p>
</li>
<li>
<p><strong>é™åˆ¶ token æ¶ˆè€—</strong>ï¼šè¿”å›ç»“æœå¤ªé•¿ä¼šæµªè´¹ tokenã€‚åƒä¸Šé¢ä»£ç é‡Œä¸€æ ·åšæˆªæ–­ã€‚</p>
</li>
<li>
<p><strong>è€ƒè™‘å¹¶å‘</strong>ï¼šå¦‚æœä½ çš„ Server è¦æ”¯æŒå¤šä¸ª Client åŒæ—¶è°ƒç”¨ï¼Œè®°å¾—å¤„ç†å¥½å¼‚æ­¥å’Œé”ã€‚</p>
</li>
</ol>
<h2 data-id="heading-8">6. ç°æˆçš„ MCP Server æ¨è</h2>
<p>ä¸æƒ³ä»é›¶å†™ï¼Ÿè¿™äº›å®˜æ–¹å’Œç¤¾åŒºçš„ Server å¯ä»¥ç›´æ¥ç”¨ï¼š</p>






























<table><thead><tr><th>Server</th><th>åŠŸèƒ½</th><th>å®‰è£…</th></tr></thead><tbody><tr><td><code>@modelcontextprotocol/server-filesystem</code></td><td>æ–‡ä»¶ç³»ç»Ÿè¯»å†™</td><td><code>npx</code> ç›´æ¥è·‘</td></tr><tr><td><code>@modelcontextprotocol/server-github</code></td><td>GitHub æ“ä½œ</td><td>éœ€è¦ Token</td></tr><tr><td><code>@modelcontextprotocol/server-postgres</code></td><td>PostgreSQL æŸ¥è¯¢</td><td>éœ€è¦è¿æ¥ä¸²</td></tr><tr><td><code>mcp-server-sqlite</code></td><td>SQLite æ“ä½œ</td><td>ç¤¾åŒºå®ç°</td></tr></tbody></table>
<h2 data-id="heading-9">å†™åœ¨æœ€å</h2>
<p>MCP ç°åœ¨è¿˜å¾ˆå¹´è½»ï¼Œåè®®æœ¬èº«ä¹Ÿåœ¨å¿«é€Ÿè¿­ä»£ã€‚</p>
<p>ä½†å®ƒä»£è¡¨çš„æ–¹å‘æ˜¯ç¡®å®šçš„ï¼š<strong>AI åº”ç”¨éœ€è¦ä¸€ä¸ªæ ‡å‡†åŒ–çš„æ–¹å¼æ¥å…¥å¤–éƒ¨ä¸–ç•Œ</strong>ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨åš AI ç›¸å…³çš„å¼€å‘ï¼Œç°åœ¨èŠ±åŠå¤©æ—¶é—´äº†è§£ MCPï¼Œç»å¯¹ä¸äºã€‚</p>
<p>ä»£ç å°±è¿™ä¹ˆå‡ åè¡Œï¼Œå‘¨æœ«å¯ä»¥ç©èµ·æ¥ã€‚</p>
<hr/>
<p><em>Reference:</em></p>
<ul>
<li><em>MCP å®˜æ–¹æ–‡æ¡£: <a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io" target="_blank" title="https://modelcontextprotocol.io" ref="nofollow noopener noreferrer">modelcontextprotocol.io</a></em></li>
<li><em>Anthropic MCP GitHub ä»“åº“</em></li>
<li><em>Hacker News - MCP Discussion</em></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter ä¸­çš„ FittedBox è¯¦è§£ï¼šæ¯”å¦‚è®©é‡‘é¢æ˜¾ç¤ºè‡ªé€‚åº”]]></title>    <link>https://juejin.cn/post/7601077290681810996</link>    <guid>https://juejin.cn/post/7601077290681810996</guid>    <pubDate>2026-02-01T03:44:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601077290681810996" data-draft-id="7601046076944154639" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter ä¸­çš„ FittedBox è¯¦è§£ï¼šæ¯”å¦‚è®©é‡‘é¢æ˜¾ç¤ºè‡ªé€‚åº”"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-02-01T03:44:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Jèˆ¹é•¿"/> <meta itemprop="url" content="https://juejin.cn/user/1820446987136903"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter ä¸­çš„ FittedBox è¯¦è§£ï¼šæ¯”å¦‚è®©é‡‘é¢æ˜¾ç¤ºè‡ªé€‚åº”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1820446987136903/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Jèˆ¹é•¿
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T03:44:40.000Z" title="Sun Feb 01 2026 03:44:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><hr/>
<h2 data-id="heading-0">Flutter ä¸­çš„ <code>FittedBox</code> è¯¦è§£ï¼šå¦‚ä½•è®©é‡‘é¢æ˜¾ç¤ºè‡ªé€‚åº”</h2>
<p>åœ¨å¼€å‘ Flutter åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬å¸¸å¸¸é‡åˆ°éœ€è¦æ ¹æ®å±å¹•å°ºå¯¸æˆ–çˆ¶å®¹å™¨å¤§å°è‡ªåŠ¨è°ƒæ•´å­ç»„ä»¶å¤§å°çš„æƒ…å†µã€‚ç‰¹åˆ«æ˜¯åœ¨å¤„ç†é‡‘é¢æ˜¾ç¤ºæ—¶ï¼Œé‡‘é¢å¯èƒ½ä»ä¸€ä¸ªè¾ƒå°çš„æ•°å­—ï¼ˆä¾‹å¦‚ï¼š100ï¼‰é€æ¸å¢å¤§ï¼ˆä¾‹å¦‚ï¼š100,000,000,00000ï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä½•ä¿è¯é‡‘é¢æ— è®ºå¤§å°éƒ½èƒ½è‡ªé€‚åº”çˆ¶å®¹å™¨è€Œä¸è¢«æˆªæ–­æˆ–è€…å˜å½¢å‘¢ï¼Ÿè¿™æ—¶ï¼Œ<code>FittedBox</code> å°±èƒ½æ´¾ä¸Šç”¨åœºï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ ¹æ®çˆ¶å®¹å™¨çš„å¤§å°è‡ªåŠ¨ç¼©æ”¾å­ç»„ä»¶ï¼Œç¡®ä¿å†…å®¹èƒ½å¤Ÿå®Œç¾å±•ç¤ºã€‚</p>
<h3 data-id="heading-1">ä¾‹å­ï¼šé‡‘é¢çš„è‡ªé€‚åº”æ˜¾ç¤º</h3>
<p>å‡è®¾æˆ‘ä»¬è¦åœ¨ç•Œé¢ä¸­æ˜¾ç¤ºä¸€ä¸ªé‡‘é¢ã€‚åˆšå¼€å§‹æ—¶ï¼Œé‡‘é¢æ˜¯ <code>100</code>ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œå®ƒé€æ¸å˜å¤§ï¼Œæ¯”å¦‚ <code>100,000,000,00000</code>ã€‚å¦‚æœæˆ‘ä»¬ä¸å¯¹æ–‡æœ¬è¿›è¡Œç¼©æ”¾ï¼Œéšç€é‡‘é¢çš„å¢åŠ ï¼Œæ•°å­—å¯èƒ½ä¼šè¶…å‡ºå±å¹•ï¼Œå¯¼è‡´ UI å‡ºç°æº¢å‡ºã€‚è¿™é‡Œï¼Œ<code>FittedBox</code> å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å®ƒä¼šæ ¹æ®çˆ¶å®¹å™¨çš„å°ºå¯¸è‡ªåŠ¨ç¼©æ”¾æ–‡æœ¬ï¼Œç¡®ä¿é‡‘é¢å†…å®¹å§‹ç»ˆèƒ½é€‚åº”å±å¹•ç©ºé—´ã€‚</p>
<h4 data-id="heading-2">ç¤ºä¾‹ä»£ç ï¼š</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">Flexible</span>(
  <span class="hljs-attribute">child</span>: <span class="hljs-built_in">FittedBox</span>(
    <span class="hljs-attribute">fit</span>: BoxFit.scaleDown,
    <span class="hljs-attribute">alignment</span>: AlignmentDirectional.centerStart,
    <span class="hljs-comment">// é‡‘é¢æ˜¾ç¤ºæ–‡æœ¬ - çº¿æ€§æ¸å˜ï¼ˆå‚ç›´æ–¹å‘ï¼‰</span>
    <span class="hljs-attribute">child</span>: <span class="hljs-built_in">ShaderMask</span>(
      <span class="hljs-attribute">shaderCallback</span>: (bounds) =&gt; const <span class="hljs-built_in">LinearGradient</span>(
        <span class="hljs-attribute">begin</span>: Alignment.topCenter,
        <span class="hljs-attribute">end</span>: Alignment.bottomCenter,
        <span class="hljs-attribute">colors</span>: [
          <span class="hljs-built_in">Color</span>(<span class="hljs-number">0</span>xFFFFC30B),
          <span class="hljs-built_in">Color</span>(<span class="hljs-number">0</span>xFFFFF4CD),
          <span class="hljs-built_in">Color</span>(<span class="hljs-number">0</span>xFFFFBB10),
        ],
      ).<span class="hljs-built_in">createShader</span>(bounds),
      <span class="hljs-attribute">child</span>: const <span class="hljs-built_in">Text</span>(
        <span class="hljs-string">'100,000,000,00000'</span>,
        <span class="hljs-attribute">style</span>: <span class="hljs-built_in">TextStyle</span>(
          <span class="hljs-attribute">fontSize</span>: <span class="hljs-number">40</span>,
          <span class="hljs-attribute">fontWeight</span>: FontWeight.w900,
          <span class="hljs-attribute">color</span>: Colors.white,
        ),
      ),
    ),
  ),
)
</code></pre>
<h4 data-id="heading-3">å…³é”®ç‚¹ï¼š</h4>
<ul>
<li><strong><code>FittedBox</code></strong>: å®ƒæ˜¯ <code>Text</code> ç»„ä»¶çš„çˆ¶å®¹å™¨ï¼Œè´Ÿè´£è°ƒæ•´æ–‡æœ¬çš„å¤§å°ï¼Œä½¿å…¶é€‚åº”å¯ç”¨çš„ç©ºé—´ã€‚éšç€é‡‘é¢å˜å¤§ï¼Œ<code>FittedBox</code> ä¼šæ ¹æ®çˆ¶å®¹å™¨çš„å˜åŒ–è‡ªåŠ¨ç¼©æ”¾æ–‡æœ¬ã€‚</li>
<li><strong><code>BoxFit.scaleDown</code></strong>: è¿™ä¸ª <code>fit</code> å±æ€§ç¡®ä¿æ–‡å­—ä¸ä¼šè¶…å‡ºå®¹å™¨çš„è¾¹ç•Œã€‚å¦‚æœé‡‘é¢å˜å¤§ï¼Œæ–‡å­—ä¼šè¢«ç¼©å°ä»¥é€‚åº”å®¹å™¨ã€‚</li>
<li><strong><code>ShaderMask</code></strong>: ä¸ºé‡‘é¢æ–‡æœ¬æ·»åŠ äº†çº¿æ€§æ¸å˜çš„æ•ˆæœï¼Œä½¿æ•°å­—æ˜¾ç¤ºå¾—æ›´åŠ é†’ç›®ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Text</code> ç»„ä»¶ä¼šæ ¹æ®é‡‘é¢çš„å¤§å°è‡ªåŠ¨è°ƒæ•´å­—ä½“å¤§å°ã€‚å‡è®¾é‡‘é¢ä» <code>100</code> å¢é•¿åˆ° <code>100,000,000,00000</code>ï¼Œ<code>FittedBox</code> ä¼šç¡®ä¿æ–‡æœ¬å§‹ç»ˆé€‚åº”çˆ¶å®¹å™¨çš„å¤§å°ï¼Œå¹¶éšç€æ•°å­—å¢å¤§è€Œé€æ¸ç¼©å°å­—ä½“å¤§å°ï¼Œä»è€Œé¿å…æ–‡æœ¬æº¢å‡ºæˆ–å¤±çœŸã€‚</p>
<h3 data-id="heading-4"><code>FittedBox</code> çš„ä½œç”¨å’ŒåŸç†</h3>
<p><code>FittedBox</code> æ˜¯ä¸€ä¸ªç”¨äºç¼©æ”¾å…¶å­ç»„ä»¶çš„å¸ƒå±€å°éƒ¨ä»¶ã€‚å®ƒä¼šæ ¹æ®çˆ¶å®¹å™¨çš„å°ºå¯¸æ¥è‡ªåŠ¨è°ƒæ•´å­ç»„ä»¶çš„å¤§å°ï¼Œç¡®ä¿å­ç»„ä»¶ä¸ä¼šè¶…å‡ºçˆ¶å®¹å™¨çš„è¾¹ç•Œã€‚ä½¿ç”¨ <code>FittedBox</code>ï¼Œæˆ‘ä»¬å¯ä»¥é¿å…æ–‡å­—ã€å›¾ç‰‡ç­‰å†…å®¹æº¢å‡ºæˆ–è€…å¤±çœŸï¼Œç¡®ä¿ UI å¸ƒå±€åœ¨å„ç§å±å¹•å°ºå¯¸ä¸Šéƒ½èƒ½é€‚åº”è‰¯å¥½ã€‚</p>
<h4 data-id="heading-5"><code>fit</code> å±æ€§çš„ä¸åŒå€¼</h4>
<p><code>FittedBox</code> é€šè¿‡ <code>fit</code> å±æ€§æ¥å†³å®šå¦‚ä½•ç¼©æ”¾å…¶å­ç»„ä»¶ã€‚<code>fit</code> å±æ€§å¯ä»¥è®¾ç½®ä¸ºä¸åŒçš„ <code>BoxFit</code> æšä¸¾å€¼ï¼Œå…¶ä¸­ä¸€äº›å¸¸è§çš„å€¼åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong><code>BoxFit.contain</code></strong>: ä¿æŒå­ç»„ä»¶çš„å®½é«˜æ¯”ï¼ŒåŒæ—¶è®©å­ç»„ä»¶å®Œå…¨æ˜¾ç¤ºåœ¨çˆ¶ç»„ä»¶çš„ç©ºé—´ä¸­ã€‚</li>
<li><strong><code>BoxFit.cover</code></strong>: è®©å­ç»„ä»¶è¦†ç›–æ•´ä¸ªçˆ¶å®¹å™¨ï¼Œå¯èƒ½ä¼šè£å‰ªéƒ¨åˆ†å†…å®¹ï¼Œä½†ä¸ä¼šå‡ºç°ç©ºç™½ã€‚</li>
<li><strong><code>BoxFit.fill</code></strong>: æ‹‰ä¼¸å­ç»„ä»¶ä»¥å®Œå…¨å¡«å……çˆ¶ç»„ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´å†…å®¹å˜å½¢ã€‚</li>
<li><strong><code>BoxFit.scaleDown</code></strong>: å¦‚æœå­ç»„ä»¶çš„å°ºå¯¸å¤§äºçˆ¶ç»„ä»¶ï¼Œå®ƒä¼šç¼©å°å­ç»„ä»¶ï¼›å¦‚æœå­ç»„ä»¶æœ¬èº«å°äºçˆ¶ç»„ä»¶ï¼Œå®ƒå°†ä¿æŒåŸå°ºå¯¸ã€‚</li>
</ul>
<p>åœ¨å‰é¢çš„é‡‘é¢ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>BoxFit.scaleDown</code>ï¼Œç¡®ä¿é‡‘é¢æ–‡æœ¬ä¸ä¼šè¢«æ‹‰ä¼¸æˆ–è€…è£å‰ªï¼Œè€Œæ˜¯é€‚åº”çˆ¶å®¹å™¨çš„å¤§å°ã€‚</p>
<h4 data-id="heading-6"><code>alignment</code> å±æ€§</h4>
<p><code>FittedBox</code> è¿˜å…è®¸é€šè¿‡ <code>alignment</code> å±æ€§æ¥æ§åˆ¶å­ç»„ä»¶åœ¨å®¹å™¨ä¸­çš„å¯¹é½æ–¹å¼ã€‚<code>alignment</code> å±æ€§æ¥å—ä¸€ä¸ª <code>AlignmentGeometry</code> ç±»å‹çš„å€¼ï¼Œå¯ä»¥è®©æˆ‘ä»¬é€‰æ‹©å­ç»„ä»¶åœ¨å®¹å™¨ä¸­çš„ä¸åŒå¯¹é½æ–¹å¼ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li><code>Alignment.topLeft</code>: å·¦ä¸Šè§’å¯¹é½</li>
<li><code>Alignment.center</code>: å±…ä¸­å¯¹é½</li>
<li><code>Alignment.bottomRight</code>: å³ä¸‹è§’å¯¹é½</li>
</ul>
<h4 data-id="heading-7">ç»“åˆå…¶ä»–å°éƒ¨ä»¶ä½¿ç”¨</h4>
<p><code>FittedBox</code> å¯ä»¥ä¸å…¶ä»–å¸ƒå±€å°éƒ¨ä»¶ï¼ˆå¦‚ <code>Flexible</code>ã€<code>Expanded</code>ã€<code>Align</code> ç­‰ï¼‰ç»“åˆä½¿ç”¨ï¼Œä»¥è¾¾åˆ°æ›´åŠ çµæ´»çš„å¸ƒå±€æ•ˆæœã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>Row</code>ã€<code>Column</code> æˆ– <code>Flex</code> ä¸­ä½¿ç”¨ <code>Flexible</code> æ¥è®© <code>FittedBox</code> æ›´å¥½åœ°é€‚åº”çˆ¶å®¹å™¨çš„å¤§å°ã€‚</p>
<h5 data-id="heading-8">ç¤ºä¾‹ï¼šé…åˆ <code>Flexible</code> ä½¿ç”¨</h5>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">Row</span>(
  <span class="hljs-attribute">children</span>: [
    <span class="hljs-built_in">Flexible</span>(
      <span class="hljs-attribute">child</span>: <span class="hljs-built_in">FittedBox</span>(
        <span class="hljs-attribute">fit</span>: BoxFit.scaleDown,
        <span class="hljs-attribute">alignment</span>: Alignment.center,
        <span class="hljs-attribute">child</span>: <span class="hljs-built_in">Text</span>(
          <span class="hljs-string">'Hello, Flutter!'</span>,
          <span class="hljs-attribute">style</span>: <span class="hljs-built_in">TextStyle</span>(<span class="hljs-attribute">fontSize</span>: <span class="hljs-number">30</span>),
        ),
      ),
    ),
  ],
)
</code></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>Text</code> ç»„ä»¶ä¼šæ ¹æ® <code>Flexible</code> ç»™å®šçš„ç©ºé—´è‡ªåŠ¨ç¼©æ”¾ï¼Œè€Œä¸ä¼šè¶…å‡ºçˆ¶å®¹å™¨çš„è¾¹ç•Œã€‚</p>
<h3 data-id="heading-9"><code>FittedBox</code> çš„å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-10">1. è‡ªåŠ¨ç¼©æ”¾æ–‡æœ¬</h4>
<p>åœ¨æ˜¾ç¤ºåŠ¨æ€å˜åŒ–çš„æ•°å­—æ—¶ï¼Œå°¤å…¶æ˜¯é‡‘é¢ç­‰å¤§æ•°å­—ï¼Œ<code>FittedBox</code> å¯ä»¥è‡ªåŠ¨ç¼©æ”¾æ–‡æœ¬ï¼Œç¡®ä¿å®ƒä»¬é€‚åº”å®¹å™¨çš„å®½åº¦å’Œé«˜åº¦ã€‚ä¾‹å¦‚ï¼Œå½“æ˜¾ç¤ºä¸€ä¸ªä¸æ–­å¢é•¿çš„é‡‘é¢æ—¶ï¼Œ<code>FittedBox</code> ä¼šæ ¹æ®é‡‘é¢çš„å¢åŠ ï¼Œè‡ªåŠ¨è°ƒæ•´å­—ä½“å¤§å°ï¼Œä»¥é€‚åº”å±å¹•ç©ºé—´ã€‚</p>
<h4 data-id="heading-11">2. å›¾ç‰‡é€‚é…</h4>
<p>åœ¨æ˜¾ç¤ºå›¾ç‰‡æ—¶ï¼Œ<code>FittedBox</code> å¯ä»¥ç¡®ä¿å›¾ç‰‡æ ¹æ®çˆ¶å®¹å™¨çš„å¤§å°è¿›è¡Œè‡ªåŠ¨ç¼©æ”¾æˆ–è£å‰ªï¼Œé¿å…å›¾ç‰‡è¶…å‡ºè¾¹ç•Œæˆ–è€…å˜å½¢ã€‚å°¤å…¶åœ¨å“åº”å¼è®¾è®¡ä¸­ï¼Œ<code>FittedBox</code> æä¾›äº†éå¸¸çµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h4 data-id="heading-12">3. ä¿æŒæ¯”ä¾‹ç¼©æ”¾</h4>
<p><code>FittedBox</code> ä¹Ÿå¯ä»¥ç”¨äºä¿æŒå­ç»„ä»¶çš„å®½é«˜æ¯”ä¸å˜ã€‚æ¯”å¦‚ï¼Œå½“æˆ‘ä»¬æœ‰ä¸€ä¸ªçŸ©å½¢å›¾å½¢æˆ–è€…å›¾ç‰‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>FittedBox</code> æ¥ç¡®ä¿å›¾å½¢å§‹ç»ˆä¿æŒæ¯”ä¾‹ç¼©æ”¾ï¼Œè€Œä¸ä¼šå¤±çœŸã€‚</p>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p><code>FittedBox</code> æ˜¯ Flutter ä¸­ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å°éƒ¨ä»¶ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾åœ°è®©å­ç»„ä»¶è‡ªé€‚åº”çˆ¶å®¹å™¨çš„å¤§å°ã€‚é€šè¿‡åˆç†ä½¿ç”¨ <code>fit</code>ã€<code>alignment</code> ç­‰å±æ€§ï¼Œ<code>FittedBox</code> å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¤„ç†å¤æ‚çš„å¸ƒå±€éœ€æ±‚ï¼Œç‰¹åˆ«æ˜¯åœ¨å“åº”å¼è®¾è®¡ä¸­ã€‚æ— è®ºæ˜¯ç¼©æ”¾æ–‡æœ¬ã€å›¾ç‰‡ï¼Œè¿˜æ˜¯ä¿æŒå®½é«˜æ¯”ï¼Œ<code>FittedBox</code> éƒ½èƒ½æä¾›ç®€å•è€Œçµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œ<code>FittedBox</code> å¸¸å¸¸ç”¨äºè§£å†³å¸ƒå±€æº¢å‡ºã€å›¾ç‰‡è£å‰ªã€æ–‡å­—ç¼©æ”¾ç­‰é—®é¢˜ï¼Œæ˜¯ Flutter ä¸­ä¸å¯æˆ–ç¼ºçš„å¸ƒå±€å·¥å…·ä¹‹ä¸€ã€‚é€šè¿‡ç†è§£å’ŒæŒæ¡ <code>FittedBox</code> çš„ç”¨æ³•ï¼Œä½ å¯ä»¥æ›´åŠ é«˜æ•ˆåœ°æ„å»ºå“åº”å¼å’Œè‡ªé€‚åº”çš„ç”¨æˆ·ç•Œé¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è¯»ã€Šäº²å¯†å…³ç³»ã€‹ï¼ˆ7ï¼‰ï¼Œå¥³äººæ›´å–œæ¬¢æ€æ ·çš„ç”·äººï¼Œä»¥åŠç”·äººæ›´å–œæ¬¢æ€æ ·çš„å¥³äºº]]></title>    <link>https://juejin.cn/post/7601101531920187438</link>    <guid>https://juejin.cn/post/7601101531920187438</guid>    <pubDate>2026-02-01T03:48:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601101531920187438" data-draft-id="7601229476795334706" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è¯»ã€Šäº²å¯†å…³ç³»ã€‹ï¼ˆ7ï¼‰ï¼Œå¥³äººæ›´å–œæ¬¢æ€æ ·çš„ç”·äººï¼Œä»¥åŠç”·äººæ›´å–œæ¬¢æ€æ ·çš„å¥³äºº"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-02-01T03:48:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘è¦æ”¹åå«å˜Ÿå˜Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/1698109849624061"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è¯»ã€Šäº²å¯†å…³ç³»ã€‹ï¼ˆ7ï¼‰ï¼Œå¥³äººæ›´å–œæ¬¢æ€æ ·çš„ç”·äººï¼Œä»¥åŠç”·äººæ›´å–œæ¬¢æ€æ ·çš„å¥³äºº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1698109849624061/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘è¦æ”¹åå«å˜Ÿå˜Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T03:48:04.000Z" title="Sun Feb 01 2026 03:48:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ¸©ä¹ ã€Šäº²å¯†å…³ç³»ã€‹åˆ°ã€Šå¸å¼•åŠ›ã€‹ï¼Œè¿™ä¸€ç« èŠ‚å½“ä¸­ä¸€å°èŠ‚è®¨è®ºçš„å†…å®¹æ˜¯â€œå¤–è¡¨å¸å¼•åŠ›â€ï¼Œå…¶ä¸­å¾ˆå¤§ç¯‡å¹…å…³äºå¥³æ€§ä»¥åŠç”·æ€§æ›´åçˆ±æ‹¥æœ‰å“ªç§å¤–è²Œçš„äººï¼Œå³å¤–è¡¨â€œé­…åŠ›â€çš„å®šä¹‰ä¸ºä½•ã€‚æ¯æ¬¡é˜…è¯»è¿™äº›å†…å®¹ï¼Œæˆ‘éƒ½è¢«ç‹ ç‹ å¸å¼•ï¼Œäºæ˜¯æœ¬ç¯‡å†…å®¹ï¼Œæ˜¯è¿™äº›èµ‹äºˆäººç±»é­…åŠ›ç‰¹å¾çš„å¤è¿°ã€‚</p>
<p>é¦–å…ˆï¼Œæ˜¯å¯¹ç¾çš„åˆ¤åˆ«çš„ä¸€è‡´æ€§ï¼Œå³ä¾¿æ‹¥æœ‰ä¸ªäººè‰²å½©ï¼Œä½†å¤§ä½“æƒ…å†µä¸‹ï¼Œå…¨ä¸–ç•Œçš„è®¤çŸ¥éƒ½å‡ ä¹ä¸€è‡´çš„ï¼šå³ä½ è®¤ä¸ºå¾ˆç¾çš„ä¸ªä½“åœ¨æˆ‘ä»¥ä¸ºï¼Œä¹Ÿæ˜¯ç¾çš„ã€‚è¿™ä¸€è‡´æ€§ç‰¹åˆ«ä½“ç°åœ¨å¯¹é™Œç”Ÿäººçš„è¯„ä»·ä¸Šé¢ã€‚</p>
<p>ç„¶åï¼Œæœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ç°è±¡æ˜¯ï¼šâ€œæ–°ç”Ÿå„¿ä¹Ÿè¡¨ç°å‡ºå¯¹æˆäººè®¤ä¸ºæœ‰å¸å¼•åŠ›çš„é¢å­”çš„åå¥½ï¼›å½“å©´å„¿å¤ªå°è¿˜æ²¡æœ‰å—åˆ°ç¤¾ä¼šè§„èŒƒçš„å½±å“æ—¶ï¼Œä»–ä»¬èŠ±æ›´å¤šçš„æ—¶é—´æ³¨è§†æœ‰å¸å¼•åŠ›çš„é¢å­”è€Œä¸æ˜¯æ²¡æœ‰å¸å¼•åŠ›çš„é¢å­”ã€‚â€æ‰€ä»¥ï¼Œå¦‚æœæŸä¸ªå©´å„¿å–œæ¬¢ç›¯ç€ä½ çœ‹ï¼Œå¤§æ¦‚æ„å‘³ç€ä½ æ˜¯ç¾çš„ã€‚</p>
<p>ç„¶åï¼Œæ˜¯ç¾çš„å…·ä½“å®šä¹‰ã€‚</p>
<h3 data-id="heading-0">1ã€å¤–è²Œçš„å¸å¼•åŠ›ï¼Œé¦–å…ˆæ¥è‡ªäºè„¸å‹</h3>
<p>å¯¹å¥³äººæ¥è¯´ï¼Œå¦‚æœå¥¹æ‹¥æœ‰â€œå¨ƒå¨ƒè„¸â€â€”â€”å¦‚å¤§çœ¼ç›ã€å°é¼»å­ã€å°–ä¸‹å·´å’Œä¸°æ»¡çš„åŒå”‡â€”â€”ç‰¹å¾ï¼Œå†è¾…ä»¥å¥³äººå‘³ä¸å¥åº·æˆç†Ÿï¼Œè¯¸å¦‚çªå‡ºçš„é¢§éª¨ã€çª„å°çš„è„¸é¢Šå’Œç¿çƒ‚çš„ç¬‘å®¹ï¼Œé‚£å¥¹åœ¨å…¨ä¸–ç•Œæ˜¯éƒ½æ‹¥æœ‰å¸å¼•åŠ›çš„ã€‚</p>
<p>è€Œå¯¹ç”·äººæ¥è¯´ï¼Œä¼šå¤æ‚ä¸€äº›ã€‚ä¸‹å·´åšå®ã€é¢å¤´å®½é˜”ï¼Œçœ‹èµ·æ¥å¼ºå£®è€Œæœ‰ç»Ÿæ²»åŠ›ï¼Œæ˜¯æœ‰å¸å¼•åŠ›çš„ï¼›è€Œæ‹¥æœ‰å¨ƒå¨ƒè„¸ï¼Œçœ‹èµ·æ¥ç•¥å¾®å¥³æ€§åŒ–çš„ç”·äººï¼Œä¹Ÿæ‹¥æœ‰å¸å¼•åŠ›ã€‚ç”·äººçš„é­…åŠ›å—å¥³æ€§ç”Ÿç†å‘¨æœŸå˜åŒ–çš„å½±å“ï¼Œå½“å¥³å­å¤„äºæ’åµå‰çš„å—å­•æœŸæ—¶ï¼Œå¥¹æ›´å–œæ¬¢ç²—çŠ·ä¸”æ‹¥æœ‰ç”·å­æ°”æ¦‚çš„ç”·äººï¼Œè€Œå…¶å®ƒçš„æ›´å¤šæ—¶é—´ï¼Œå¥³å­åˆ™æ›´å€¾å‘äºå–œæ¬¢å¹´è½»ä¸”å­©å­æ°”çš„é¢å­”ã€‚</p>
<p>ç„¶åï¼Œä¸ç®¡ç”·æ€§å¥³æ€§ï¼Œéƒ½æ›´å–œæ¬¢å¹³å‡åŒ–â€”â€”â€œå¹³å‡â€çš„æ¦‚å¿µæ˜¯â€œå¾ˆå¤šå¼ è„¸å›¾åˆåœ¨ä¸€èµ·ï¼Œå›¾ç‰‡è¶Šå¤šè¶Šå¹³å‡â€â€”â€”çš„è„¸ï¼Œäº”å®˜æ—¢ä¸å¤ªå¤§ä¹Ÿä¸å¤ªå°ï¼Œä¸”ç›¸äº’é—´æ¯”ä¾‹åè°ƒï¼šé¼»å­ä¸ä¼šå¤ªå¤§ï¼Œçœ¼ç›ä¸ä¼šå¤ªå°ï¼Œé¢å­”çš„ä»»ä½•ä¸€éƒ¨åˆ†éƒ½ä¸ä¼šæœ‰è¿‡åˆ†å¤¸å¼ ã€å‘è‚²ä¸è‰¯æˆ–æ€ªå¼‚ä¹‹å¤„ã€‚</p>
<p>å¥½çœ‹çš„é¢å­”æ˜¯å¯¹ç§°çš„ï¼Œé¢å­”ä¸¤è¾¹äº’ä¸ºé•œåƒï¼›ä¸¤åªçœ¼ç›ä¸€æ ·å¤§å°ï¼Œè„¸é¢Šä¹Ÿæ˜¯ä¸€èˆ¬å®½çª„ï¼Œç­‰ç­‰ã€‚å¯¹ç§°å’Œâ€œå¹³å‡â€éƒ½å¯¹é¢éƒ¨ç¾æœ‰è´¡çŒ®ï¼Œæ‰€ä»¥æ¼‚äº®çš„é¢å­”å°†å•ä¸ªé¢å­”çš„æœ€ä½³ç‰¹å¾ç»“åˆæˆä¸€ä¸ªå¹³è¡¡ã€åŒ€ç§°çš„æ•´ä½“ã€‚</p>
<p>æ­¤å¤„ï¼Œæˆ‘æƒ³åŠ ä¸Šä¸€ç‚¹è‡ªå·±çš„ç†è§£ï¼Œåœ¨äº”å®˜ç«¯æ­£åŸºç¡€ä¹‹ä¸Šï¼Œè¿˜è¯¥æœ‰çš®è‚¤é²œå«©å…‰æ»‘çš„é”¦ä¸Šæ·»èŠ±ã€‚</p>
<h3 data-id="heading-1">2ã€èº«å‹çš„å¸å¼•åŠ›</h3>
<p>ç”·æ€§è®¤ä¸ºä½“é‡æ­£å¸¸ã€ä¸èƒ–ä¸ç˜¦ã€è…°èº«æ˜æ˜¾ç»†äºè‡€éƒ¨çš„å¥³æ€§èº«ææ›´æœ‰è¯±æƒ‘åŠ›ã€‚è€Œè…°è‡€æ¯”çš„è¿™ä¸€ç‰¹æ€§ï¼Œåœ¨å…¨ä¸–ç•Œæœ‰ä¸€ä¸ªä¸åŒºåˆ†æ–‡åŒ–çš„é€šç”¨æ ‡å‡†ï¼š0.7ï¼Œå³è…°éƒ¨æ¯”è‡€éƒ¨ç»†30%ï¼Œæ­¤ç§â€œæ²™æ¼å‹â€èº«æå¯¹ç”·æ€§æœ€æœ‰å¸å¼•åŠ›ã€‚</p>
<blockquote>
<p>åœ¨å…¨ä¸–ç•Œï¼Œç›¸æ¯”å°ä¹³æˆ¿ï¼Œç”·äººæ›´å–œæ¬¢ä¸­ç­‰å¤§å°çš„ä¹³æˆ¿ï¼Œè€Œå¤§ä¹³æˆ¿å¹¶ä¸èƒ½è®©å¥³äººæ›´å…·å¸å¼•åŠ›ï¼Œä½†ä¸ç®¡æ€æ ·ï¼Œä¹³æˆ¿çš„å¤§å°éƒ½ä¸å¦‚å…¶ä¸å¥³æ€§èº«ä½“å…¶ä»–éƒ¨åˆ†çš„æ¯”ä¾‹é‡è¦ï¼›è…°èƒ¸æ¯”ä¸º0.75çš„æ›²çº¿æœ€å¸å¼•ç”·æ€§ã€‚æ­¤å¤–ï¼Œå¥³äººçš„è…°è‡€æ¯”ä¾‹æ¯”ä¹³æˆ¿å¤§å°æ›´èƒ½å½±å“ç”·äººå¯¹å¥³äººå¸å¼•åŠ›çš„åˆ¤æ–­ã€‚</p>
</blockquote>
<p>ç”·æ€§èº«æçš„å¸å¼•åŠ›ä¼šç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå®ƒé¦–å…ˆå…³äºèµ„æºï¼Œç„¶åæ‰æ˜¯èº«å‹çš„æ¯”ä¾‹ã€‚åªæœ‰å½“æŸä½ç”·æ€§æ‹¥æœ‰ä½“é¢è–ªæ°´ä½“é¢åœ°ä½ä¹‹åï¼Œä»–èº«æçš„å¥½åæ‰ä¼šè¢«å¥³äººå…³æ³¨ï¼Œæ‰ä¼šå‚ä¸æ¯”è¾ƒä¸è¯„ä»·ã€‚ç”·æ€§å³ä½¿è‹±ä¿Šä½†è‹¥è´«ç©·ï¼Œå¯¹å¥³æ€§ä¹Ÿå¹¶ä¸é‚£ä¹ˆæœ‰å¸å¼•åŠ›ã€‚</p>
<p>ç”·æ€§è¿›å…¥è¢«è¯„ä»·åœˆå­åï¼Œä¾¿æœ‰äº†æ¯”è¾ƒæ ‡å‡†ã€‚</p>
<blockquote>
<p>å½“ç”·æ€§çš„è…°æ¯”è‡€ç•¥çª„ï¼Œå³è…°è‡€æ¯”ä¸º0.9æ—¶ï¼Œä»–ä»¬çš„èº«ä½“æœ€æœ‰å¸å¼•åŠ›ã€‚å®½é˜”çš„è‚©è†€ã€å¼ºå£®çš„è‚Œè‚‰ä¹Ÿå¾ˆæœ‰å¸å¼•åŠ›ï¼›ä¸è‚©è†€è¾ƒçª„å’Œè‚Œè‚‰æ¾å¼›çš„ç”·æ€§ç›¸æ¯”ï¼Œé‚£äº›è‚©è‡€æ¯”ä¾‹è¾ƒé«˜ï¼ˆçº¦ä¸º1.2ï¼‰ã€è‚Œè‚‰æ›´å¼ºå£®çš„ç”·æ€§å‘ç”Ÿæ€§å…³ç³»çš„å¹´é¾„æ›´æ—©ï¼Œå¥³æ€§æ€§ä¼´ä¾£ä¹Ÿæ›´å¤šï¼Œè¿™ä¸€ç‚¹åœ¨å…¨ä¸–ç•Œéƒ½ä¸€æ ·ã€‚</p>
</blockquote>
<p>ç„¶åå…³äºèº«é«˜ï¼Œåœ¨æŒ‘é€‰å¼‚æ€§æ‹ä¼´ä¾£æ—¶ï¼Œå¤§éƒ½å€¾å‘äºç”·æ€§æ¯”å¥³æ€§é«˜ã€‚å¥³æ€§æ¯”ç”·æ€§æ›´çœ‹é‡èº«é«˜ï¼Œä½†èº«é«˜å¯ä»¥è¢«æ”¶å…¥å¼¥è¡¥ã€‚</p>
<blockquote>
<p>åœ¨å©šæ‹ç½‘ç«™ä¸Šï¼ŒçŸ®ä¸ªç”·äººä¹Ÿèƒ½å¾—åˆ°ä¸é«˜ä¸ªç”·äººä¸€æ ·å¤šçš„å›åº”ï¼Œä½†å‰ææ˜¯èµšæ›´å¤šçš„é’±æ‰å¯ä»¥ã€‚è¦å¤šå¾ˆå¤šã€‚åœ¨è¿™ä¸ªç‰¹ä¾‹ä¸­ï¼ŒçŸ®ä¸ªç”·äººæ¯å¹´å¿…é¡»å¤šèµš221000ç¾å…ƒï¼Œæ‰èƒ½å¸å¼•å¥³äººçš„æ³¨æ„ã€‚</p>
</blockquote>
<h3 data-id="heading-2">3ã€ä½“å‘³çš„å¸å¼•åŠ›</h3>
<p>æ²¡é”™ï¼Œæ°”å‘³ä¹Ÿæ˜¯å¸å¼•åŠ›å½“ä¸­çš„é‡è¦ä¸€ç¯ï¼Œç›¸å¯¹æ¥è¯´ï¼Œå¥³æ€§ä¼šæ¯”ç”·æ€§æ›´åœ¨æ„æ°”å‘³ä¸€äº›ã€‚</p>
<p>å¥³äººæ›´å–œæ¬¢å¤šè¿›é£Ÿæœè”¬ç­‰å¥åº·é£Ÿç‰©çš„ç”·äººçš„ä½“å‘³ï¼Œè€Œä¸æ˜¯æ‘„å…¥å¤§é‡ç¢³æ°´åŒ–åˆç‰©çš„ç”·äººçš„ä½“å‘³ã€‚ç”·äººæ›´å–œæ¬¢æ¼‚äº®å¥³äººæ•£å‘å‡ºçš„å¤©ç„¶ä½“å‘³ï¼Œç”·äººæ˜¯å¦åŒæ€§æ‹ï¼Œä¹Ÿèƒ½å¤Ÿåœ¨ä½“å‘³ä¸Šåšäº›åŒºåˆ†ã€‚</p>
<p>æœ‰ä¸€ä¸ªå¾ˆç¥å¥‡çš„æµ‹éªŒï¼Œç”·äººå¥³äººç«Ÿç„¶èƒ½å¤Ÿæ ¹æ®ä½“å‘³åˆ¤å®šå‡ºä»æ²¡è§è¿‡é™Œç”Ÿäººçš„ç¾ä¸‘ã€‚</p>
<blockquote>
<p>é¢éƒ¨å¯¹ç§°ã€æœ‰å¸å¼•åŠ›çš„äººçš„æ°”å‘³æ˜æ˜¾æ¯”é¢éƒ¨ä¸å¯¹ç§°ã€æ²¡æœ‰å¸å¼•åŠ›çš„äººçš„æ°”å‘³å¥½é—»ï¼Œå› ä¸ºé™Œç”Ÿäººåå¥½ç›¸è²Œå‡ºä¼—ä¹‹äººçš„ä½“å‘³ï¼Œè€Œä¸æ˜¯ç›¸è²Œå¹³å¹³ä¹‹äººçš„æ°”å‘³ã€‚</p>
</blockquote>
<h3 data-id="heading-3">4ã€å¤´å‘ä»¥åŠæ¯›å‘çš„å¸å¼•åŠ›</h3>
<p>é•¿å‘çš„å¥³æ€§æ¯”çŸ­å‘çš„å¥³æ€§å¯¹ç”·æ€§æ›´æœ‰å¸å¼•åŠ›ã€‚ï¼ˆæ­¤å¤„å‘ç°ä¸€ç‚¹æˆ‘çš„å–œå¥½ä¸ç ”ç©¶ç»“è®ºçš„ä¸ä¸€è‡´ï¼Œç›¸å¯¹æ¥è¯´ï¼Œæˆ‘ä¼šæ›´åå‘äºçŸ­å‘ä¸€äº›ï¼Œå†…é‡ŒåŸå› å¤§æ¦‚æ˜¯çŸ­å‘æ‰€å¸¦æ¥çš„æ˜¾å¾—çš„å¹²ç»ƒä¸å¸…æ°”ã€‚ï¼‰</p>
<p>ç”·æ€§çš„èƒ¸æ¯›æˆ–å¤´å‘å†é•¿ä¹Ÿæ— æ­¤æ•ˆæœï¼›å¥³æ€§æ›´å–œæ¬¢èƒ¸éƒ¨å…‰æ»‘ã€å°‘æ¯›çš„ç”·æ€§ï¼Œè€Œéèƒ¸éƒ¨å¤šæ¯›çš„ç”·æ€§ï¼Œå‰ƒå…‰å¤´çš„ç”·æ€§è¾ƒä¹‹å¤´å‘æµ“å¯†çš„ç”·æ€§çœ‹èµ·æ¥ä¼¼ä¹æ›´é«˜å¤§å’Œæ›´å¼ºåŠ¿ã€‚</p>
<h3 data-id="heading-4">5ã€æ™ºå•†å’Œé¢œè‰²</h3>
<p>å¥³äººè¿˜å–œæ¬¢èªæ˜çš„ç”·äººã€‚</p>
<p>ç”·å¥³åŒæ–¹éƒ½è®¤ä¸ºç©¿çº¢è‰²è¡¬è¡«çš„é™Œç”Ÿå¼‚æ€§æ›´æœ‰å¸å¼•åŠ›å’Œæ›´æ€§æ„Ÿã€‚</p>
<p>--</p>
<p>ä»¥ä¸Šï¼Œä¾¿æ˜¯ä¹¦ä¸­æåˆ°çš„é‚£äº›å¤–è¡¨é­…åŠ›çš„å…·ä½“ç‰¹å¾äº†ã€‚</p>
<p>é™Œç”Ÿäººåˆé‡æ—¶çš„ç¬¬ä¸€å°è±¡ï¼Œä¾¿æ˜¯å¤–è¡¨ï¼Œè€Œå¯¹æ–¹æ˜¯å¦å¥½çœ‹ï¼Œæˆ‘ä»¬å¤§éƒ¨åˆ†äººå…¶å®åœ¨3ç§’é’Ÿå†…ä¾¿å·²ç»åšå‡ºå†³å®šã€‚å‹å¥½ã€å¤–å‘çš„äººå¾€å¾€å¾ˆå—æ¬¢è¿ï¼Œæ²¡æœ‰äººå–œæ¬¢å®³ç¾æˆ–å¯¹è¢«æŠ›å¼ƒæ„Ÿåˆ°é«˜åº¦ç„¦è™‘çš„äººï¼Œä½†<strong>åœ¨åˆæ¬¡è§é¢æ—¶ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”é•¿ç›¸æ›´é‡è¦çš„äº†</strong>ã€‚</p>
<blockquote>
<p>æ€»è€Œè¨€ä¹‹ï¼Œè¿™äº›ç ”ç©¶ç»“æœè¡¨æ˜ï¼Œäººç±»å¤©æ€§å’Œç¯å¢ƒæ¡ä»¶å…±åŒå¡‘é€ äº†æˆ‘ä»¬å¯¹ç¾ä¸‘çš„åˆ¤æ–­æ ‡å‡†ã€‚æˆ‘ä»¬é€šå¸¸ä¼šè¢«é‚£äº›çœ‹èµ·æ¥æ˜¯å¥½ä¼´ä¾£çš„äººæ‰€å¸å¼•ï¼Œä½†ä»€ä¹ˆæ ·çš„äººæ‰ç®—æ˜¯å¥½ä¼´ä¾£åœ¨ä¸€å®šç¨‹åº¦ä¸Šå–å†³äºæˆ‘ä»¬æ‰€å¤„çš„ç¯å¢ƒã€‚ç„¶è€Œï¼Œå¹¶ä¸æ€»æ˜¯æƒ…äººçœ¼é‡Œå‡ºè¥¿æ–½ã€‚ä¸–ç•Œå„åœ°çš„äººä»¬å¯¹äºç¾ä¸‘çš„åˆ¤æ–­æ ‡å‡†å‡ºå¥‡åœ°ä¸€è‡´ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI æ—¥è®°ï¼šåŸºäº RAGFlow æ¡†æ¶æ­å»ºæ•°æ®æ£€ç´¢ chat æœºå™¨äºº]]></title>    <link>https://juejin.cn/post/7601169987411443750</link>    <guid>https://juejin.cn/post/7601169987411443750</guid>    <pubDate>2026-01-31T11:10:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601169987411443750" data-draft-id="7601044684774375462" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI æ—¥è®°ï¼šåŸºäº RAGFlow æ¡†æ¶æ­å»ºæ•°æ®æ£€ç´¢ chat æœºå™¨äºº"/> <meta itemprop="keywords" content="AIç¼–ç¨‹,AIGC"/> <meta itemprop="datePublished" content="2026-01-31T11:10:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å†°èŒ¶èŒ¶"/> <meta itemprop="url" content="https://juejin.cn/user/3245414058035111"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI æ—¥è®°ï¼šåŸºäº RAGFlow æ¡†æ¶æ­å»ºæ•°æ®æ£€ç´¢ chat æœºå™¨äºº
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3245414058035111/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å†°èŒ¶èŒ¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T11:10:53.000Z" title="Sat Jan 31 2026 11:10:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€äº›è¯´æ˜</h2>
<ul>
<li>
<p>æœ€è¿‘åœ¨å­¦ä¹  AI ç›¸å…³çš„çŸ¥è¯†ï¼Œã€ŒAI æ—¥è®°ã€è¿™ä¸ªç³»åˆ—ä¼šè®°å½•æˆ‘çš„ä¸€äº›è¾“å‡ºä¸å¿ƒå¾—ï¼Œæ­£å¦‚æˆ‘å¾€å¸¸çš„è¾“å‡ºå†…å®¹ä¸€è‡´ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä»½ stepbystep çš„ Roadmapï¼Œè€Œæ˜¯å•çº¯çš„ä¸ªäººè®°å½•ã€å¹¶ä¸”è€ƒè™‘åˆ°è¯»è€…æˆ‘ä¼šå°½å¯èƒ½åœ°è§£é‡Šæ¸…æ¥šå¹¶äº‰å–è®©å¤§å®¶ä¹Ÿèƒ½å¾—åˆ°ä¸€äº›æœ‰æ•ˆè¾“å…¥ã€‚</p>
</li>
<li>
<p>æˆ‘æ˜¯ä¸€ä¸ªåˆšå­¦ä¹ æ²¡å¤šä¹…çš„ AI å°ç™½ï¼Œæ–‡ç« ä¸­è‚¯å®šæœ‰å±€é™ç”šè‡³é”™è¯¯ä¹‹å¤„ï¼Œä»…ä»…ç”¨æ¥å‚è€ƒå’Œä¸€èµ·äº¤æµã€‚</p>
</li>
</ul>
<h2 data-id="heading-1">èƒŒæ™¯æ¢³ç†</h2>
<h3 data-id="heading-2">éœ€æ±‚</h3>
<p>ç›®å‰æˆ‘æœ‰ä¸€äº›å…³äºè®¸å¤šé«˜ç­‰é™¢æ ¡çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯æœ‰éå¸¸å¤šçš„æ–¹é¢å’Œå­—æ•°ï¼Œè€Œä¸”ç»è¿‡äº†ä¸“äººçš„æ£€éªŒï¼Œæ˜¯ç›¸å¯¹ç½‘ç»œæ•°æ®æ›´å¯é çš„ä¿¡æ¯æºï¼›äºæ˜¯æˆ‘å¸Œæœ›åšä¸€ä¸ªèŠå¤©æœºå™¨äººğŸ¤–ï¼Œç”¨æˆ·èƒ½å¤Ÿå»è¯¢é—®è¿™ä¸ªèŠå¤©æœºå™¨äººå…³äºé«˜æ ¡çš„ä¸€äº›é—®é¢˜ï¼Œè€Œæœºå™¨äººä¼šæ ¹æ®ä¸Šè¿°æåˆ°çš„å¯é ä¿¡æ¯æºæ¥ç”Ÿæˆå›å¤ç»™åˆ°ç”¨æˆ·ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5dd108398ba34a83a5f8952249985ac4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=BdVx%2BU5D%2BRu5ltb49Q3HV9NNJvo%3D" alt="" loading="lazy"/></p>
<p>å¾ˆæ˜¾ç„¶å¦‚æœæˆ‘ç›´æ¥è°ƒç”¨è¯¸å¦‚ deepseek çš„æ¨¡å‹çš„è¯ï¼Œå®ƒæ›´å¤šçš„å‚è€ƒä¾æ®æ˜¯ç½‘ç»œçš„æ•°æ®ï¼Œè€Œæˆ‘æ›´å¸Œæœ›å‘ç”¨æˆ·å‘ˆç°çš„æ˜¯ç»è¿‡æˆ‘ä»¬çš„æ£€éªŒçš„å¯é æ•°æ®ï¼›ä½†æ˜¯æˆ‘åˆä¸å¯èƒ½åœ¨æ¯ä¸€æ¬¡ç”¨æˆ·æé—®æ—¶ï¼Œéƒ½æŠŠæˆ‘çš„æ•°æ®ä½œä¸º Promptï¼ˆæç¤ºè¯ï¼‰åŒç”¨æˆ·çš„è¾“å…¥ä¸€èµ·æäº¤ç»™æ¨¡å‹ï¼Œå› ä¸ºæˆ‘çš„æ•°æ®æœ‰æˆåƒä¸Šä¸‡æ¡ï¼Œå­—æ•°å¤šè¾¾ç™¾ä¸‡çº§åˆ«ï¼Œæ¨¡å‹ä¸å¯èƒ½åœ¨ç”¨æˆ·å¯æ¥å—çš„æ—¶é—´å†…ä¸€æ¬¡å¤„ç†è¿™ä¹ˆå¤šæ•°æ®ï¼Œè¿™æ—¢ä¸é«˜æ•ˆä¹Ÿä¸ç»æµã€‚</p>
<p>è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ä¸€äº›æ‰‹æ®µæ¥å®ç°æ­¤ç±»éœ€æ±‚ã€‚</p>
<h3 data-id="heading-3">RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰</h3>
<p>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ŒRetrieval-Augmented Generationï¼‰æ˜¯<strong>ä¸€ç§é€šè¿‡åœ¨ç”Ÿæˆå“åº”ä¹‹å‰ä»å¤–éƒ¨æƒå¨çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œæ¥ä¼˜åŒ–å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰è¾“å‡ºçš„AIæŠ€æœ¯</strong>ã€‚å®ƒè®© AI â€œæŸ¥èµ„æ–™å†ä½œç­”â€ï¼Œæœ‰æ•ˆè§£å†³äº†å¤§æ¨¡å‹è®­ç»ƒæ•°æ®è¿‡æœŸã€ç”Ÿæˆå†…å®¹ä¸å‡†ç¡®ï¼ˆå¹»è§‰ï¼‰åŠç¼ºä¹é¢†åŸŸç§æœ‰çŸ¥è¯†çš„é—®é¢˜ã€‚</p>
<p><strong>RAG çš„æ ¸å¿ƒè¦ç´ ä¸å·¥ä½œæµç¨‹æ˜¯ï¼š</strong></p>
<ul>
<li>
<p><strong>æ£€ç´¢ (Retrieval)ï¼š</strong> ç³»ç»Ÿå°†ç”¨æˆ·çš„æŸ¥è¯¢ä¸å¤–éƒ¨çŸ¥è¯†åº“ï¼ˆå¦‚ä¼ä¸šæ–‡æ¡£ã€æ•°æ®åº“ã€å³æ—¶ç½‘ç»œä¿¡æ¯ï¼‰è¿›è¡Œæ¯”å¯¹ï¼Œæ‰¾å‡ºæœ€ç›¸å…³çš„å†…å®¹ã€‚</p>
</li>
<li>
<p><strong>å¢å¼º (Augmentation)ï¼š</strong> å°†æ£€ç´¢åˆ°çš„çŸ¥è¯†ä¸ç”¨æˆ·çš„æç¤ºè¯ï¼ˆPromptï¼‰æ•´åˆï¼Œå½¢æˆä¸Šä¸‹æ–‡ã€‚</p>
</li>
<li>
<p><strong>ç”Ÿæˆ (Generation)ï¼š</strong> LLM åˆ©ç”¨è¿™äº›å¢å¼ºåçš„çŸ¥è¯†ç”Ÿæˆä¸“ä¸šã€å‡†ç¡®ã€æœ€æ–°çš„å›ç­”</p>
</li>
</ul>
<p>ä¸‹é¢æˆ‘æ¥ç®€å•åœ°ç”»ä¸€å¼ ç¤ºæ„å›¾æ¥ä½“ç° RAG ä¸­çš„ä¸€äº›æ ¸å¿ƒæµç¨‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8dc33e661ac444009035005b92264b4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=0ZOKj4v4sb3ahOB4x79tXwtlsZ8%3D" alt="" loading="lazy"/></p>
<p>è¿™å¼ å›¾ä¸­çœç•¥äº†éå¸¸å¤šçš„æŠ€æœ¯ç»†èŠ‚ï¼Œä½†æ˜¯æœ€æ ¸å¿ƒçš„æµç¨‹æ— éå°±ä»¥ä¸‹å‡ æ­¥ï¼š</p>
<ol>
<li>
<p><strong>Embeddingï¼ˆåµŒå…¥ï¼‰</strong>ï¼šç”±äºæˆ‘ä»¬çš„æ•°æ®æºçš„æ•°æ®é‡éå¸¸å¤§ï¼Œä¸å¯èƒ½ç­‰åˆ°ç”¨æˆ·å®é™…å‘ç”Ÿæé—®æ—¶å†æ¥å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»è¦å¯¹å…¶è¿›è¡Œé¢„å¤„ç†ï¼ŒEmbedding å°±æ˜¯<strong>ä¸€ç§å°†é«˜ç»´ã€ç¦»æ•£çš„æ•°æ®ï¼ˆå¦‚æ–‡æœ¬ã€å›¾åƒã€å•†å“IDï¼‰æ˜ å°„ä¸ºä½ç»´ã€è¿ç»­çš„ç¨ å¯†å‘é‡çš„æŠ€æœ¯</strong>ï¼šåµŒå…¥æ¨¡å‹å¯ä»¥å°†æˆ‘ä»¬æ•°æ®æºä¸­ä¸€æ®µæ®µæ–‡æœ¬ï¼ˆå¯èƒ½æ˜¯å…³äºæŸä¸ªé«˜æ ¡çš„å¸ˆèµ„åŠ›é‡çš„ä¿¡æ¯ï¼‰æ˜ å°„å¤„ç†ä¸ºä¸€ä¸ªé«˜ç»´å‘é‡ï¼ˆåœ¨æ¥ä¸‹æ¥æˆ‘çš„å®ä¾‹ä¸­æ˜¯ 1024 ç»´ï¼‰ï¼Œæ³¨æ„æˆ‘è¿™é‡Œè™½ç„¶è¯´å®ƒæ˜¯ä¸€ä¸ªã€Œé«˜ç»´ã€å‘é‡ï¼Œä½†æ˜¯å®ƒå·²ç»æ¯”åŸå§‹æ–‡æœ¬æ•°æ®çš„ç»´åº¦ä½å¤šäº†ï¼Œæ‰€ä»¥å¹¶ä¸å’Œå®šä¹‰ä¸­çš„ã€Œä½ç»´ã€å†²çªï¼›å½“è¿™äº›å¯é çš„æ•°æ®æºè¢«å¤„ç†æˆäº†ä¸€ä¸ªä¸ªé«˜ç»´çš„å‘é‡ï¼Œç”±æ–‡å­—è½¬åŒ–ä¸ºäº†æ•°å­—ï¼Œé‚£ä¹ˆåç»­çš„åŒ¹é…å¯¹æ¯”æ“ä½œå°±æ˜¯è®¡ç®—æœºæ›´æ“…é•¿çš„äº‹äº†</p>
</li>
<li>
<p><strong>ç›¸ä¼¼åº¦æ£€æµ‹</strong>ï¼šå½“ç”¨æˆ·è¾“å…¥ä¸€ä¸ªé—®é¢˜ä»¥åï¼Œè¿™ä¸²è¾“å…¥é¦–å…ˆä¼šåŒæ ·è¢« Embeddingï¼ˆæ²¡é”™ï¼Œè¿™ä¸ªå¤„ç†çš„æ¨¡å‹åº”è¯¥å’Œå¤„ç†æ•°æ®æºçš„Embeddingæ¨¡å‹æ˜¯åŒä¸ªæ¨¡å‹ï¼šå¦‚æœä¸æ˜¯ä¸€ä¸ªæ¨¡å‹çš„è¯ï¼Œå®ƒä»¬æœ€åå°±æ²¡æ³•åœ¨åŒä¸ªåµŒå…¥çš„å‘é‡ç©ºé—´å»åšç›¸ä¼¼åº¦æ£€æµ‹ï¼Œé‚£å°±æ²¡æ„ä¹‰äº†ï¼‰æˆä¸€ä¸ªåŒç»´åº¦çš„å‘é‡ï¼Œç„¶åæ ¹æ®ä¸€äº›ç›¸ä¼¼åº¦æ£€æµ‹ç®—æ³•å»è¿›è¡Œæ£€æµ‹ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºå°±åƒæ˜¯åœ¨ä¸€ä¸ªå¹³é¢ç›´è§’åæ ‡ç³»ä¸­ï¼Œæˆ‘ä»¬å»æ‰¾åˆ°è·ç¦»æ›´è¿‘çš„ä¸¤ä¸ªç‚¹ä¸€æ ·ï¼Œåªä¸è¿‡ç°åœ¨çš„ç»´åº¦ä¸æ˜¯2ç»´è€Œæ˜¯1024ç»´ï¼›æ¥ç€é€šè¿‡ä¸€äº›å‚æ•°çš„é…ç½®ï¼Œæˆ‘ä»¬å¯ä»¥è¿”å›é‚£äº›å’Œç”¨æˆ·è¾“å…¥æœ€æ¥è¿‘çš„ä¸€äº›æ•°æ®æºç‰‡æ®µï¼ˆæ¯”å¦‚è¿”å›åä¸ªï¼‰</p>
</li>
<li>
<p><strong>Rerankï¼ˆé‡æ’ï¼‰</strong>ï¼šå…¶å®åˆ°è¿™é‡Œæ•°æ®å¤æ‚åº¦å·²ç»å¤§å¤§ä¸‹é™äº†ï¼Œä½†æ˜¯å¦‚æœè¿˜æƒ³åšåˆ°æ›´æè‡´ä¸€äº›çš„è¯å°±å¯ä»¥ç”¨åˆ°é‡æ’ï¼›åœ¨é€šè¿‡ç›¸ä¼¼åº¦æ£€æµ‹åˆæ­¥å¬å›äº†ä¸€äº›ç›¸å…³æ€§é«˜çš„åä¸ªæ•°æ®æºç‰‡æ®µåï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç²¾ç»†çš„æ¨¡å‹å¯¹å€™é€‰ç‰‡æ®µåŒç”¨æˆ·æé—®çš„è¯­ä¹‰ç›¸å…³æ€§è¿›è¡Œæ·±åº¦åˆ†æå’Œé‡æ–°æ’åºï¼Œè¿™é‡Œçš„ç®—æ³•å’Œ <strong>Embedding</strong> å¹¶ä¸ä¸€æ ·ï¼Œè€Œä¸”ä¼šæ›´åŠ åœ°è€—æ—¶ï¼›æ¯”å¦‚æˆ‘ä»¬é€šè¿‡ <strong>Rerank</strong> å®Œæˆäº†è¿™åä¸ªæ•°æ®æºç‰‡æ®µæ›´åŠ ç²¾ç»†çš„ç›¸ä¼¼åº¦æ’åï¼Œå¹¶ä¸”åªå–å‰äº”ä¸ªè¿”å›</p>
</li>
<li>
<p><strong>LLMè¾“å‡ºï¼ˆå¤§è¯­è¨€æ¨¡å‹è¾“å‡ºï¼‰</strong>ï¼šæ¥ä¸‹æ¥å°±æ¥åˆ°äº†ã€Œæœ€åä¸€å…¬é‡Œã€ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬æ‹¿ç€ç”¨æˆ·è¾“å…¥å’Œç»è¿‡ <strong>Rerank</strong> çš„äº”ä¸ªæ•°æ®æºç‰‡æ®µï¼Œä¸€è‚¡è„‘å…¨éƒ¨æ‰”ç»™ LLMï¼Œè®©å¤§è¯­è¨€æ¨¡å‹å†å»å¸®åŠ©æˆ‘ä»¬åˆ†æé—®é¢˜ã€ç†è§£èµ„æ–™ã€å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚</p>
</li>
</ol>
<p>ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ç³»åˆ—æ“ä½œï¼Œä½¿å¾—å¤§æ¨¡å‹ä¸å¿…ä¸´åœºæ—¶å†å»å¼€å·ç¿»ä¸€éå¹¶ä¸”ç°åœºç†è§£æ‰€æœ‰çš„èµ„æ–™æ¥å›ç­”ç”¨æˆ·ï¼Œè€Œæ˜¯æˆ‘ä»¬é¢„å…ˆå¯¹äºæ•°æ®åšäº†å„ç§å¤„ç†ï¼Œä½¿å¾—æœ€åå¤§æ¨¡å‹åªéœ€è¦å¤„ç†å°‘éƒ¨åˆ†æ•°æ®å°±å¯ä»¥å¾—åˆ°ç²¾ç¡®çš„å›ç­”ã€‚</p>
<h2 data-id="heading-4">ä½¿ç”¨ RAGFlow è¿›è¡Œæ­å»º</h2>
<p>è™½ç„¶è‡ªå·±åŠ¨æ‰‹å†™æ›´å¤šä»£ç è‚¯å®šèƒ½å­¦åˆ°æ›´å¤šä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘æƒ³è¦åœ¨é€Ÿåº¦ä¸Šä¹Ÿæœ‰è¾ƒå¿«çš„æ­£åé¦ˆï¼Œæ‰€ä»¥æˆ‘ä½¿ç”¨äº† RAGFlowï¼Œå®ƒæœ‰ç‚¹åƒæ˜¯å¼€å‘çš„ä½ä»£ç å¹³å°ï¼Œæˆ‘è§‰å¾—å½“ä½ çœŸçš„å¯¹äºä¸€äº›åŸå­èƒŒåçš„ç»“æ„å’Œåº•å±‚æœ‰ä¸€å®šäº†è§£ä¹‹åï¼Œå•çº¯å»å†™å„ç§è°ƒç”¨æˆ–è€…è®¾ç½®å‚æ•°çš„ç¹çä»£ç æ„Ÿè§‰æ€§ä»·æ¯”å¹¶ä¸ä¼šæ›´é«˜ã€‚</p>
<p>RAGFlowï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Finfiniflow%2Fragflow%25EF%25BC%258CRAGFlow" target="_blank" title="https://github.com/infiniflow/ragflow%EF%BC%8CRAGFlow" ref="nofollow noopener noreferrer">github.com/infiniflow/â€¦</a> æ˜¯ä¸€æ¬¾é¢†å…ˆçš„å¼€æºæ£€ç´¢å¢å¼ºç”Ÿæˆ ( RAG ) å¼•æ“ï¼Œå®ƒå°†å‰æ²¿çš„ RAG æŠ€æœ¯ä¸ä»£ç†åŠŸèƒ½èåˆï¼Œä¸ºç”Ÿå‘½å‘¨æœŸç®¡ç† (LLM) åˆ›å»ºå“è¶Šçš„ä¸Šä¸‹æ–‡å±‚ï¼‰ã€‚</p>
<p>è·‘ RAGFlow éœ€è¦åœ¨ docker ä¸Šè¿è¡Œï¼Œå¦‚æœæœ‰éƒ¨ç½²éœ€æ±‚ï¼Œå¯ä»¥ç›´æ¥åœ¨å…¬å¸çš„æœåŠ¡å™¨æˆ–è€…å¼€å‘æœºè¿è¡Œï¼Œæˆ–è€…åœ¨æœ¬åœ°æå¥½ MVP åï¼Œå†æŠŠå¯¹åº”çš„é…ç½®æ–‡ä»¶åŒæ­¥è¿‡å»ã€‚</p>
<p>è·‘ docker çš„æ—¶å€™å†…å­˜æœ€å¥½åˆ†é…å¤§ä¸€äº›ï¼ˆæˆ‘åˆ†é…äº†16GBï¼‰ï¼Œæœ€å¼€å§‹æˆ‘åªåˆ†é…äº†8GBï¼Œå¯¼è‡´ Elasticsearch ä¸€ç›´å› ä¸ºå†…å­˜ä¸è¶³è€Œä¸æ–­é‡å¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5b0d14e38ae48d4aa6d49bde55ab081~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=TCg1odRytn%2BqSDHqO1NobSvNYRY%3D" alt="" loading="lazy"/></p>
<p>æˆåŠŸè·‘èµ·æ¥ä»¥åå°±å¯ä»¥åœ¨æ‰“å¼€æœ¬æœº IP åè¿›å…¥å›¾å½¢åŒ–é…ç½®ç•Œé¢äº†ï¼Œé¦–å…ˆæˆ‘ä»¬æŠŠå¿…é¡»çš„ä¸€äº›æ¨¡å‹ç»™é…ç½®å¥½ï¼Œå†²ç€æ–¹ä¾¿å’Œä¾¿å®œæˆ‘å°±é€‰äº† deepseek å’Œé€šä¹‰åƒé—®çš„æ¨¡å‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c4b57f72a58463f8b922065f43f6d32~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=OdaJyZui2piuh%2Bjup0BqgSHIXMo%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-5">å¤„ç†æ•°æ®é›†</h3>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å»å¤„ç†æˆ‘ä»¬çš„æ•°æ®é›†äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šä¼ æˆ‘ä»¬çš„æºæ•°æ®ï¼ˆæˆ‘è¿™é‡Œæ˜¯ä¸€ä¸ª xlsx æ–‡ä»¶ï¼‰ï¼Œåœ¨é…ç½®é¡µé¢å¯ä»¥å»é€‰æ‹©å’Œè¯•é”™ä¸€äº›å‚æ•°ï¼Œç„¶åç‚¹å‡»è¿è¡Œè§£æå°±å®Œæˆäº†ï¼Œæ•´ä¸ªè¿‡ç¨‹éå¸¸å‚»ç“œå¼ï¼Œ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/426073afe0654be1b37d5233ee7cc26c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=zeqQNvhRBfSzSiijCmB88T8gqlo%3D" alt="" loading="lazy"/></p>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨æµ‹è¯•é¡µé¢å»è¿›è¡Œã€Œæ£€ç´¢æµ‹è¯•ã€ï¼Œæ¯”å¦‚è¾“å…¥ä¸€ä¸ªé—®é¢˜ï¼Œç„¶åçœ‹çœ‹å³ä¾§å¬å›çš„ç‰‡æ®µåˆ†åˆ«æœ‰å“ªäº›ï¼Œå¹¶ä¸”åœ¨å¬å›ç‰‡æ®µä¸Šä¾§è¿˜ä¼šè¿”å›æ··åˆç›¸ä¼¼åº¦ä¾›å‚è€ƒï¼Œä½ å¯ä»¥æ ¹æ®è¿™äº›æ¥åˆ¤æ–­ Embedding ç»“æœæ˜¯å¦å°½å¦‚äººæ„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5cacbc7064241ba9b716f3be77619c9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=qfF%2B3rXnZn3IYOsWetXX3JjphFw%3D" alt="" loading="lazy"/></p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç¨å¾®ç²¾ç»†åŒ–ä¸€ç‚¹ï¼Œå³è‡ªå·±åˆ›å»ºä¸€ä¸ª workflow å·¥ä½œæµæ¥è¿›è¡Œæ•°æ®é›†å¤„ç†ï¼ˆå…¶å®å’Œä¸Šé¢çš„ç®€åŒ–å½¢å¼å·®ä¸å¤ªå¤šï¼‰ï¼›</p>
<p>å…¶å®è¿™ä¸€æ¡ workflow å°±åƒæ˜¯ RAG ç³»ç»Ÿä¸­çš„â€œåå¨â€é€»è¾‘ï¼Œå¯¹æˆ‘ä»¬çš„æ•°æ®é›†è¿›è¡Œå„ç§æ‹†è§£æ–¹ä¾¿åç»­çš„å¤§å¿«æœµé¢ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef3ac43f76e140c0b58a796062112aa8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=Et%2BxPpdosHwKjEEzOyw%2FFCm4s3s%3D" alt="" loading="lazy"/></p>
<ul>
<li>
<p>Parserï¼ˆè§£æå™¨ï¼‰ï¼šå¦‚æœä½ ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶ï¼Œæ¯”å¦‚ PDFã€Wordã€Excel ç­‰ä¸åŒå½¢å¼çš„æ–‡ä»¶ï¼Œå¯èƒ½ä¼šæœ‰ä¸åŒçš„æ•ˆæœæ›´å¥½çš„å¤„ç†æ–¹å¼ï¼Œè§£æå™¨çš„ä»»åŠ¡æ˜¯æŠŠæˆ‘çš„æ•°æ®æºæ–‡ä»¶é‡Œçš„æ–‡å­—æå–å‡ºæ¥ï¼Œå¹¶ä¸”æœ€å¥½é€‚é…åŸå§‹çš„æ ¼å¼ï¼›ä½ å¯ä»¥ä½¿ç”¨ RAGFlow è‡ªå¸¦çš„ Parserï¼Œæˆ–è€…è‡ªå·±ä½¿ç”¨ä¸€äº› Parser æ¨¡å‹ï¼Œæ¯”å¦‚åœ¨è¿™ä¸ªæµä¸­æˆ‘é€‰æ‹©äº† <code>Spreadsheet</code>ï¼ˆç”µå­è¡¨æ ¼ï¼‰ç±»å‹ï¼Œå¹¶ä½¿ç”¨äº† <code>qwen2-vl-plus</code>ï¼ˆå¤šæ¨¡æ€å¤§æ¨¡å‹ï¼‰ä½œä¸ºè§£ææ–¹æ³•</p>
</li>
<li>
<p>Chunkerï¼ˆåˆ†å—å™¨ï¼‰ï¼šè¿™é‡Œå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å…ˆå°†æˆ‘ä»¬çš„æ•°æ®æºè¿›è¡Œåˆ†å—å¤„ç†ï¼Œä¸ç„¶åç»­çš„ç‰‡æ®µæŸ¥æ‰¾å°±æ²¡æ„ä¹‰äº†ã€‚ç°åœ¨çš„åˆ†å—ç®—æ³•åº”è¯¥æœ‰æŒºå¤šçš„ï¼Œä½†æ˜¯æˆ‘ä¸æ˜¯ç‰¹åˆ«äº†è§£è¿™å—ï¼Œæˆ‘åœ¨è¿™é‡Œé€‰æ‹©äº†  ä½œä¸ºåˆ†éš”ç¬¦ï¼ˆå› ä¸ºæˆ‘çš„è¡¨æ ¼ä¼šåœ¨Parse è¿‡ç¨‹ä¸­è¢«è½¬åŒ–æˆä¸€ä¸ª HTML Table å¯¹è±¡ï¼‰</p>
</li>
<li>
<p>Extractorï¼ˆæå–å™¨ï¼‰ï¼šè¿™ä¸ªæµç¨‹éå¿…é¡»ï¼Œä½†æ˜¯å´å¯ä»¥å¸®åŠ©æˆ‘ä»¬æé«˜åˆ†ç‰‡æ•°æ®å’Œæ•´ä¸ª RAG æµç¨‹çš„è´¨é‡ï¼Œæ¯”å¦‚æå–å™¨å¯èƒ½ä¼šåˆ©ç”¨å¤§æ¨¡å‹æŠŠè¿™æ®µè¯é‡å†™æˆ–æå– Metadata ï¼ˆå…³é”®æ ‡ç­¾ï¼‰ï¼Œç›¸å½“äºå°†ä¸€äº›åŸå§‹çš„åˆ†ç‰‡æ•°æ®è½¬åŒ–æˆäº†å¸¦æœ‰æ ‡ç­¾å’Œæ‘˜è¦çš„ç²¾å“åˆ†å—ï¼Œè¿™æ ·å¯ä»¥æå¤§å¢åŠ æœç´¢æ—¶çš„å‘½ä¸­ç‡ï¼Œå› ä¸ºæ¨¡å‹ä¸ä»…èƒ½æœåˆ°å­—é¢æ„æ€ï¼Œè¿˜èƒ½ç†è§£è¿™ä¸€å—å†…å®¹åˆ°åº•åœ¨è®²ä»€ä¹ˆã€‚è¿™é‡Œæˆ‘ä½¿ç”¨ <code>deepseek-chat</code>æ¨¡å‹å¯¹æ¯ä¸ªå°å—è¿›è¡Œæ·±åŠ å·¥</p>
</li>
<li>
<p>Embeddingï¼ˆåµŒå…¥ï¼Œåˆ†è¯å™¨ï¼‰ï¼šé€šè¿‡ <code>Embedding</code> æ¨¡å‹æˆ‘ä»¬æœ€ç»ˆå¯ä»¥å°†åˆ†ç‰‡æ•°æ®è½¬åŒ–æˆä¸€ä¸²é•¿é•¿çš„æ•°å­—åˆ—è¡¨ï¼Œä¹Ÿå°±æ˜¯å‰æ–‡è¯´çš„é«˜ç»´å‘é‡ï¼ŒåŒæ—¶ç°åœ¨çš„åµŒå…¥æ¨¡å‹è¿˜ä¼šåš <strong>Full-textï¼ˆå…¨æ–‡ç´¢å¼•ï¼‰</strong>ï¼Œé€šè¿‡å»ºç«‹å…³é”®è¯ç´¢å¼•å¯ä»¥ä½¿å¾—åç»­æŸ¥è¯¢çš„æ—¶å€™ä¸ä»…ä»…æ ¹æ®è¯­ä¹‰çš„ç›¸ä¼¼åº¦è¿›è¡Œæ£€ç´¢ï¼Œè¿˜å¯ä»¥åŸºäºä¸€äº›å…¨æ–‡åŒ¹é…çš„æ–¹å¼æ¥è¾…åŠ©æ£€ç´¢</p>
</li>
</ul>
<h3 data-id="heading-6">ç”ŸæˆèŠå¤©æœºå™¨äºº</h3>
<p>æ¥ä¸‹æ¥çš„äº‹æƒ…æ›´åŠ ç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥å»ºç«‹ä¸€ä¸ª Chat é¡¹ç›®ï¼Œåœ¨è¿™ä¸ªé¡µé¢å»é…ç½®ä¸€äº›ç³»ç»Ÿæç¤ºè¯ã€é€‰æ‹©å·²ç»å¤„ç†å¥½åçš„æ•°æ®é›†ã€å¢åŠ ä¸€äº›å…œåº•æªæ–½ã€è¯•å›¾å¾®è°ƒå‚æ•°ç­‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/130a430540f34cc681dfa9d89c132f60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=plZKA5PRLo9CFBu4KbGO66VRqpQ%3D" alt="" loading="lazy"/></p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ‹¿ç€è°ƒè¯•å¥½çš„æˆæœå»åº”ç”¨åˆ°æˆ‘ä»¬è‡ªå·±çš„å‰ç«¯é¡µé¢å•¦~åªè¦å¤åˆ¶å¥½ç³»ç»Ÿç»™çš„ä»£ç æ ·ä¾‹ï¼Œç„¶åå°±èƒ½æ¥åˆ°æˆ‘ä»¬æ–‡ç« å¼€å¤´çš„é‚£ä¸€å¹•ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9a69153c22a405a83f06fcd0df827bc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=ASLP51bcQVAMysa9Ix4jiVGzJKk%3D" alt="" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/988d0a02686f442db0aa269b06a315e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=%2FFIPKaAZgZrTuVAn%2FxCX2CnV%2FDw%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">å®ŒæˆğŸ¤©</h2>
<p>é‚£ä¹ˆä¸€ä¸ªéå¸¸ç²—ç³™çš„åŸºäºæˆ‘ä»¬è‡ªå·±æ•°æ®é›†çš„èŠå¤©æœºå™¨äººå°±å®Œæˆå•¦ï¼Œä¾æ‰˜äºå„ç§ä½ä»£ç é…ç½®ï¼Œæˆ‘åªèŠ±äº†ä¸€å¤©åŠçš„æ—¶é—´å°±å®Œæˆäº†ï¼Œå¹¶ä¸”è¿˜å¯¹æ•´ä¸ª RAG æœ‰äº†ä¸€äº›å¼€å¤©è¾Ÿåœ°çš„è®¤çŸ¥ã€‚</p>
<p>å½“ç„¶ï¼Œè¶Šæ˜¯æ“ä½œç®€å•æ— ä»£ç å°±è¯´æ˜å¯é…ç½®æ€§è¶Šä¸å¤Ÿçµæ´»å˜›ï¼Œå…¶å®æˆ‘ä»¬è¿˜å¯ä»¥ç”¨å…¶ä¸­çš„ agent Flow æ¨¡å¼æ¥å†™æˆ‘ä»¬çš„å‰ç«¯èŠå¤©é€»è¾‘ï¼Œä¸‹å›¾å°±éå¸¸æ¸…æ™°äº†ï¼šå¯¹äºæˆ‘ä»¬å¯é æ•°æ®æºä¸­èƒ½æŸ¥åˆ°çš„ä¿¡æ¯æˆ‘ä»¬ç›´æ¥è¿”å›å¹¶ä¸”å‘Šè¯‰ç”¨æˆ·è¿™æ˜¯å¯é ä¿¡æ¯ï¼Œå¦åˆ™å°±ä½¿ç”¨ç½‘ç»œæœç´¢ä½œä¸ºå…œåº•å¹¶ä¸”æé†’ç”¨æˆ·æ³¨æ„æ ¸å®ç½‘ç»œä¿¡æ¯ã€‚ï¼ˆè€Œè¿™ä¸€ç‚¹åœ¨ä¸Šé¢é‚£ä¸ªæ›´å‚»ç“œå¼çš„é…ç½®ç•Œé¢ä¸æ˜¯ç‰¹åˆ«å¥½å®ç°ï¼Œåªèƒ½åœ¨ Prompt ä¸­åšä¸€äº› hack æç¤ºï¼Œä½†è¿™é‡Œå°±ä¼šæ¯”è¾ƒçµæ´»ï¼‰</p>
<p>å¦‚æœéœ€è¦æ›´åŠ çµæ´»çš„æ–¹å¼é‚£åº”è¯¥å°±éœ€è¦æ¶‰åŠåˆ°å†™æ›´å¤šçš„ä»£ç äº†ï¼Œæ¯”å¦‚å°±ç”¨ LangChain æ¥è‡ªå·±å»å†™å„ç§æ¨¡å—çš„å†…åœ¨é€»è¾‘å’Œæµç¨‹ï¼Œè¿™ä¸ªå°±çœ‹ä¸šåŠ¡çš„éœ€æ±‚å’Œå¤æ‚åº¦äº†~</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/79610ef30edd4db99d5b900847cd7af9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=5XUW84IPKNcRjOKWdIcgqY61cDY%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-8">å†™åœ¨æœ€å</h2>
<p>ç°åœ¨è®©æˆ‘å†æ¥åŸºäºä¸Šé¢æˆ‘æ‰€åšçš„äº‹æƒ…æ¢³ç†ä¸€ä¸ªæ›´æ¸…æ™°çš„æµç¨‹å›¾ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fcd8ce7396054b14b762d15f9cc3498d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yaw6Iy26Iy2:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770462653&amp;x-signature=P%2FzVICBJ1WdYCDMWLMloKp%2BuUaQ%3D" alt="" loading="lazy"/></p>
<p>å¾—ç›Šäºå„ç§å¼€æºå·¥å…·å’Œç”Ÿæ€ï¼Œè®©æˆ‘è¿™ä¸ª2026å¹´æ‰å¼€å§‹æ¥è§¦å’Œå­¦ä¹  AI çš„äººä¹Ÿèƒ½ä¸Šæ‰‹åšä¸€äº›ä¸œè¥¿ï¼Œè€Œä¸”å­¦ä¹  ä¸€æ ·äº‹ç‰©çš„æœ€å¿«æ–¹æ³•ç¡®å®å°±æ˜¯å®è·µï¼Œå…ˆå»ç½‘ä¸Šçœ‹å‡ åä¸ªå°æ—¶çš„è§†é¢‘å†æ¥åŠ¨æ‰‹ç»å¯¹ä¼šè€—è´¹å¤§é‡çš„çƒ­æƒ…ï¼Œè€Œä¸”ç°åœ¨å„ç§ chat æ¨¡å‹å·²ç»å¯ä»¥å……å½“éå¸¸å¥½çš„æŒ‡è·¯äººäº†ã€‚</p>
<p>å¤šè¯´æ— ç›Šï¼Œè®©æˆ‘ä»¬ä¸€èµ·åŠ æ²¹ï¼Œå› ä¸ºä»ä»€ä¹ˆæ—¶å€™å¼€å§‹éƒ½ä¸æ™š~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ä¿å§†çº§æ•™ç¨‹ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ å®‰è£…OpenClawå¹¶æ¥å…¥é£ä¹¦ï¼Œè®©AIåœ¨èŠå¤©è½¯ä»¶é‡Œå¸®ä½ å¹²æ´»]]></title>    <link>https://juejin.cn/post/7600994087589150739</link>    <guid>https://juejin.cn/post/7600994087589150739</guid>    <pubDate>2026-01-31T11:45:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600994087589150739" data-draft-id="7600994087589101587" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ä¿å§†çº§æ•™ç¨‹ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ å®‰è£…OpenClawå¹¶æ¥å…¥é£ä¹¦ï¼Œè®©AIåœ¨èŠå¤©è½¯ä»¶é‡Œå¸®ä½ å¹²æ´»"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-31T11:45:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿å¡RPA"/> <meta itemprop="url" content="https://juejin.cn/user/2858385965069735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ä¿å§†çº§æ•™ç¨‹ã€‘æ‰‹æŠŠæ‰‹æ•™ä½ å®‰è£…OpenClawå¹¶æ¥å…¥é£ä¹¦ï¼Œè®©AIåœ¨èŠå¤©è½¯ä»¶é‡Œå¸®ä½ å¹²æ´»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2858385965069735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿å¡RPA
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T11:45:12.000Z" title="Sat Jan 31 2026 11:45:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™é‡Œå…ˆåšä¸€ä¸‹ç®€å•çš„ç§‘æ™®ï¼š</p>
<p><code>OpenClaw</code> çš„åå­—ç»å†äº†ä¸‰æ¬¡å˜æ›´ï¼Œç¬¬ä¸€æ¬¡å«åš <code>ClawdBot</code>ï¼Œåæ¥å› ä¸ºåå­—è·Ÿ <code>Claude</code> å¤ªè¿‡ç›¸ä¼¼ï¼Œè¢« <code>CLaude</code> å‘Šä¾µæƒï¼Œé‚æ”¹å <code>MoltBot</code> ã€‚</p>
<p>ä½†æ˜¯åæ¥åœ¨æ”¹åè¿‡ç¨‹ä¸­é­é‡åŸŸåå’Œç¤¾äº¤è´¦å·è¢«æŠ¢æ³¨ï¼Œç”šè‡³å‡ºå‘åŒååŠ å¯†è´§å¸å‰²éŸ­èœçš„æƒ…å†µï¼Œå¯¼è‡´åç§°ä¼ æ’­å—é˜»ã€‚</p>
<p>æœ€ç»ˆå®šåä¸ºï¼š<strong>OpenClaw</strong>ã€‚</p>
<p>æ‰€ä»¥ï¼Œåå­—ç»å†å…ˆåé¡ºåºä¸ºï¼šClawdBot -&gt; MoltBot -&gt; OpenClaw</p>
<p>å¤§å®¶ä¸è¦å› ä¸ºåå­—å›°æƒ‘äº†ï¼Œæ€€ç–‘æ˜¯ä¸æ˜¯è‡ªå·±ä¸‹é”™è½¯ä»¶äº†ï¼Œä»–ä»¬éƒ½æ˜¯åŒä¸€ä¸ªã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ OpenClawï¼Ÿ</h2>
<p><strong>OpenClaw</strong>ï¼ˆæ›¾ç”¨å Clawdbotï¼‰æ˜¯ä¸€æ¬¾ 2026 å¹´çˆ†ç«çš„å¼€æºä¸ªäºº AI åŠ©æ‰‹ï¼ŒGitHub æ˜Ÿæ ‡å·²è¶…è¿‡ 10 ä¸‡é¢—ã€‚ä¸ä¼ ç»Ÿ AI èŠå¤©æœºå™¨äººçš„æ ¹æœ¬åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li><strong>çœŸæ­£çš„æ‰§è¡Œèƒ½åŠ›</strong>ï¼šä¸ä»…èƒ½å›ç­”é—®é¢˜ï¼Œè¿˜èƒ½å®é™…æ“ä½œä½ çš„ç”µè„‘</li>
<li><strong>24/7 å…¨å¤©å€™å¾…å‘½</strong>ï¼šåœ¨ä½ ç¡è§‰æ—¶ä¹Ÿèƒ½ä¸»åŠ¨å®Œæˆä»»åŠ¡</li>
<li><strong>å®Œå…¨å¼€æºå…è´¹</strong>ï¼šæ•°æ®å®Œå…¨æŒæ§åœ¨è‡ªå·±æ‰‹ä¸­</li>
<li><strong>æ”¯æŒå¤šç§é€šè®¯å¹³å°</strong>ï¼šåœ¨å›½å¤–ï¼ŒWhatsAppã€Telegramã€Discordã€Slackã€iMessage ç­‰ï¼Œåœ¨å›½å†…ï¼Œé£ä¹¦ï¼Œé’‰é’‰ç­‰å„å¤§å‚å•†çš„å³æ—¶èŠå¤©è½¯ä»¶å·²ç»æ”¯æŒæ¥å…¥</li>
</ul>
<p><strong>å®ƒèƒ½åšä»€ä¹ˆï¼Ÿ</strong></p>
<p>å®ƒä¸åªæ˜¯å›ç­”é—®é¢˜çš„èŠå¤©æœºå™¨äººï¼Œè€Œæ˜¯çœŸçš„èƒ½åœ¨ä½ ç”µè„‘ä¸ŠåŠ¨æ‰‹æ“ä½œã€‚æ¯”å¦‚ä½ å‘Šè¯‰å®ƒâ€œå¸®æˆ‘æ•´ç†ä¸€ä¸‹ä¸Šä¸ªæœˆçš„é‚®ä»¶â€ï¼Œå®ƒå°±é»˜é»˜å»å¤„ç†äº†ï¼›ä½ ç¡è§‰æ—¶ï¼Œå®ƒè¿˜èƒ½ç»§ç»­å¹²æ´»ï¼Œé€€è®¢å¹¿å‘Šã€é¢„çº¦è¡Œç¨‹ã€ç”šè‡³æ‰¾æ‰¾ Bugã€‚</p>
<p>å®ƒå®Œå…¨å…è´¹ï¼Œä½ çš„æ•°æ®éƒ½åœ¨è‡ªå·±æ‰‹é‡Œã€‚è€Œä¸”å¯ä»¥ç”¨é’‰é’‰ï¼Œé£ä¹¦ï¼ŒWhatsAppã€Telegramç­‰å„ç±»å³æ—¶é€šè®¯è½¯ä»¶æ¥æŒ‡æŒ¥ä»–å¹²æ´»ï¼</p>
<p>ç®€å•æ¥è¯´ï¼Œä¸€å¥è¯äº¤ç»™å®ƒï¼Œä»æ•´ç†æ¡Œé¢æ–‡ä»¶åˆ°æ§åˆ¶å®¶é‡Œç¯å…‰ï¼Œå®ƒéƒ½é»˜é»˜å¸®ä½ æå®šã€‚æ˜¯ä½ ç”µè„‘é‡ŒçœŸæ­£çš„è´¾ç»´æ–¯ï¼è¶…çº§æ™ºèƒ½çš„AIåŠ©ç†ï¼</p>
<h2 data-id="heading-1">äºŒã€å®‰è£…nodejs</h2>
<p>åé¢æ‰§è¡Œä¸€é”®å®‰è£…å‘½ä»¤ï¼Œå¯ä»¥è‡ªåŠ¨å®‰è£…nodejsï¼Œä½†æ˜¯å¦‚æœä¸ºäº†åŠ å¿«é€Ÿåº¦ï¼Œé˜²æ­¢å®‰è£…æ„å¤–ï¼Œå¯ä»¥å…ˆå®‰è£…nodejsï¼š</p>
<p>å®˜æ–¹ä¸‹è½½åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fzh-cn%2Fdownload" target="_blank" title="https://nodejs.org/zh-cn/download" ref="nofollow noopener noreferrer">nodejs.org/zh-cn/downlâ€¦</a>
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131162700875.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">ä¸‰ã€å¼€å§‹å®‰è£…</h2>
<h4 data-id="heading-3">ä¸€ï¼‰è®¾ç½® PowerShell æ‰§è¡Œæƒé™</h4>
<p>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShellï¼š</p>
<ol>
<li>æŒ‰ <code>Win</code> é”®ï¼Œæœç´¢ <strong>PowerShell</strong></li>
<li>å³é”®ç‚¹å‡» <strong>Windows PowerShell</strong></li>
<li>é€‰æ‹© <strong>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ</strong></li>
<li>ç‚¹å‡» <strong>æ˜¯</strong> ç¡®è®¤
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131105639058.png" alt="" loading="lazy"/></li>
</ol>
<p>åœ¨ç®¡ç†å‘˜ PowerShell çª—å£ä¸­ï¼Œä¾æ¬¡æ‰§è¡Œä»¥ä¸‹ä¸¤æ¡å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">Set-ExecutionPolicy RemoteSigned -Scope CurrentUser

Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
</code></pre>
<p><strong>è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</strong></p>
<ul>
<li>ç¬¬ä¸€æ¡å‘½ä»¤ï¼šå…è®¸å½“å‰ç”¨æˆ·è¿è¡Œæœ¬åœ°å’Œä¸‹è½½çš„è„šæœ¬</li>
<li>ç¬¬äºŒæ¡å‘½ä»¤ï¼šå…è®¸å½“å‰ç”¨æˆ·è¿è¡Œæœ¬åœ°å’Œä¸‹è½½çš„è„šæœ¬</li>
</ul>
<blockquote>
<p>âš ï¸ <strong>å®‰å…¨æç¤º</strong>ï¼šè¿™äº›å‘½ä»¤åªä¼šå½±å“æ‚¨è‡ªå·±çš„è´¦æˆ·ï¼Œä¸ä¼šå½±å“ç³»ç»Ÿå®‰å…¨æˆ–å…¶ä»–ç”¨æˆ·ã€‚</p>
</blockquote>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131105900492.png" alt="" loading="lazy"/></p>
<h4 data-id="heading-4">äºŒï¼‰æ‰§è¡Œä¸€é”®å®‰è£…å‘½ä»¤</h4>
<p>å¤åˆ¶ä»¥ä¸‹å‘½ä»¤ï¼Œç²˜è´´åˆ° PowerShell çª—å£ä¸­ï¼ŒæŒ‰ <strong>Enter</strong> æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-powershell" lang="powershell">iwr -useb https://openclaw.ai/install.ps1 | iex
</code></pre>
<p><strong>å®‰è£…è¿‡ç¨‹ä¼šè‡ªåŠ¨å®Œæˆï¼š</strong></p>
<ul>
<li>æ£€æµ‹ç³»ç»Ÿç¯å¢ƒ</li>
<li>å®‰è£…å¿…è¦ä¾èµ–ï¼ˆNode.js ç­‰ï¼‰</li>
<li>ä¸‹è½½ OpenClaw æ ¸å¿ƒæ–‡ä»¶</li>
<li>é…ç½®ç¯å¢ƒå˜é‡</li>
<li>å¯åŠ¨é…ç½®å‘å¯¼</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼šå¦‚æœå‘½ä»¤æ‰§è¡Œåï¼Œè¿˜æ˜¯æŠ¥é”™ï¼Œå¯ä»¥è‡ªå·±åˆ°å®˜ç½‘ä¸‹è½½nodeå®‰è£…åŒ…ï¼Œè‡ªå·±å®‰è£…nodeç¯å¢ƒï¼Œæ³¨æ„ç‰ˆæœ¬æœ€å¥½åœ¨ node v22.x ä»¥ä¸Šï¼Œnodeå®˜ç½‘ä¸‹è½½åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fnodejs.org%2Fzh-cn%2Fdownload%25EF%25BC%258C%25E8%258B%25A5%25E8%25BF%2598%25E6%2598%25AF%25E4%25B8%258D%25E6%2587%2582%25E6%2580%258E%25E4%25B9%2588%25E5%25AE%2589%25E8%25A3%2585%25EF%25BC%258C%25E7%2582%25B9%25E5%25A4%25B4%25E5%2583%258F%25E8%25BF%259B%25E6%2588%2591%25E4%25B8%25BB%25E9%25A1%25B5%25E6%2589%25BE%25E5%2588%25B0%25E6%2588%2591%25EF%25BC%258C%25E6%258B%2589%25E4%25BD%25A0%25E8%25BF%259B%25E4%25BA%25A4%25E6%25B5%2581%25E7%25BE%25A4" target="_blank" title="https://nodejs.org/zh-cn/download%EF%BC%8C%E8%8B%A5%E8%BF%98%E6%98%AF%E4%B8%8D%E6%87%82%E6%80%8E%E4%B9%88%E5%AE%89%E8%A3%85%EF%BC%8C%E7%82%B9%E5%A4%B4%E5%83%8F%E8%BF%9B%E6%88%91%E4%B8%BB%E9%A1%B5%E6%89%BE%E5%88%B0%E6%88%91%EF%BC%8C%E6%8B%89%E4%BD%A0%E8%BF%9B%E4%BA%A4%E6%B5%81%E7%BE%A4" ref="nofollow noopener noreferrer">nodejs.org/zh-cn/downlâ€¦</a></p>
</blockquote>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131111048852.png" alt="" loading="lazy"/></p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131111251882.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-5">å››ã€åˆå§‹é…ç½®å‘å¯¼</h2>
<p>å®‰è£…å®Œæˆåï¼Œä¼šè‡ªåŠ¨è¿›å…¥é…ç½®å‘å¯¼ï¼ˆ<code>openclaw onboard</code>ï¼‰ã€‚</p>
<h3 data-id="heading-6">ä¸€ï¼‰é£é™©å‘ŠçŸ¥</h3>
<p>è¿™ä¸€æ­¥ä¸»è¦æ˜¯å‘Šè¯‰ä½ ï¼Œä½¿ç”¨OpenClawå¯èƒ½ä¼šæœ‰ä¸€äº›é£é™©ã€‚è¯·é—®ä½ æ˜¯å¦ç»§ç»­ï¼Ÿ
æŒ‰ å‘å·¦æ–¹å‘é”® â†ï¼Œé€‰æ‹© <code>Yes</code>ï¼ŒæŒ‰ <code>Enter</code> å›è½¦ç¡®è®¤
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131112638265.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">äºŒï¼‰é€‰æ‹© QiuickStart æ¨¡å¼</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131113459487.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-8">ä¸‰ï¼‰é…ç½® AI æ¨¡å‹ API Key</h3>
<p>OpenClaw éœ€è¦è¿æ¥åˆ°å¤§è¯­è¨€æ¨¡å‹æ‰èƒ½å·¥ä½œã€‚Openclaw æ¯”è¾ƒè´¹tokenï¼Œå›½å¤–æ¨¡å‹æˆæœ¬é«˜ï¼Œé—¨æ§›ä¹Ÿé«˜ï¼Œè¿™é‡Œæˆ‘é€‰æ‹©å›½å†…çš„æ™ºè°±çš„ GLM 4.7</p>
<blockquote>
<p>å¦‚æœæ²¡æœ‰æ™ºè°±çš„API Keyï¼Œç‚¹å‡»å®˜æ–¹åœ°å€è‡ªå·±æ³¨å†Œè´¦å·è·å–API keyï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bigmodel.cn%2Fglm-coding%3Fic%3DRBSKXMPNJP" target="_blank" title="https://www.bigmodel.cn/glm-coding?ic=RBSKXMPNJP" ref="nofollow noopener noreferrer">www.bigmodel.cn/glm-coding?â€¦</a></p>
</blockquote>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131114247396.png" alt="" loading="lazy"/></p>
<p>è¾“å…¥è‡ªå·±çš„ API Keyï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131114709118.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">å››ï¼‰é€‰æ‹© AI æ¨¡å‹</h3>
<blockquote>
<p>è¿™é‡Œæˆ‘é€‰æ‹©é»˜è®¤çš„GLM 4.7ï¼Œä¹Ÿæ˜¯æ™ºæ™®å½“å‰çš„æ——èˆ°æ¨¡å‹</p>
</blockquote>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131114852878.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-10">äº”ï¼‰è¿æ¥å³æ—¶é€šè®¯å¹³å°</h3>
<p>é…ç½®å®Œ AI æ¨¡å‹åï¼ŒOpenClaw ä¼šè¯¢é—®ä½ è¦è¿æ¥å“ªä¸ªé€šè®¯å¹³å°ï¼Ÿ</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131115610345.png" alt="" loading="lazy"/></p>
<blockquote>
<p>OpenClaw åŸç”Ÿæ”¯æŒçš„å³æ—¶é€šä¿¡å¹³å°ä¸»è¦æ˜¯æµ·å¤–çš„ WhatsAppã€Telegramã€Discordã€Slackã€iMessage ç­‰ï¼Œå›½å†…ç”¨æˆ·ä¸ä¹ æƒ¯ï¼Œè¿™é‡Œå›½äº§å³æ—¶é€šä¿¡è½¯ä»¶å¤§å‚ä¹Ÿè·Ÿè¿›äº†ï¼Œç°åœ¨é’‰é’‰ï¼Œé£ä¹¦ç­‰éƒ½å·²æ”¯æŒæ¥å…¥OpenClaw</p>
</blockquote>
<p>åé¢ä¼šå¸¦é¢†å¤§å®¶æŠŠé£ä¹¦æœºå™¨äººæ¥å…¥ OpenClawï¼Œä½¿å¤§å®¶å¯ä»¥é€šè¿‡é£ä¹¦å³å¯æŒ‡æŒ¥OpenClawä¸ºæˆ‘ä»¬å¹²æ´»ï¼Œä½†æ˜¯é£ä¹¦é…ç½®æ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆé€‰æ‹©è·³è¿‡ï¼Œåé¢æˆ‘ä»¬å¯ä»¥é€šè¿‡ç»§ç»­è¿›è¡Œé…ç½®ï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131131336311.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">å…­ï¼‰é€‰æ‹©Skills</h3>
<p>è¿™é‡Œä¹Ÿé€‰æ‹©ï¼šNoï¼Œæš‚ä¸é…ç½®ï¼Œåé¢é€šè¿‡UIç•Œé¢è¿›è¡Œé…ç½®ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131133055785.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">ä¸ƒï¼‰æ˜¯å¦å¼€å¯Hooks</h3>
<p>æ“ä½œæ­¥éª¤ï¼šå…ˆæ•²<strong>ç©ºæ ¼</strong>ï¼Œè¡¨ç¤ºé€‰ä¸­å½“å‰é¡¹ï¼Œå†æ•²å›è½¦é”®</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131133154392.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-13">å…«ï¼‰å¯åŠ¨æœåŠ¡å¹¶æ‰“å¼€UIç•Œé¢</h3>
<p>æ­¤æ—¶å®ƒä¼šè‡ªåŠ¨å†æ‰“å¼€ä¸€ä¸ªå‘½ä»¤çª—å£æ¥å¯åŠ¨æœåŠ¡:</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131134156920.png" alt="" loading="lazy"/></p>
<blockquote>
<p>è¿™ä¸ªè¿‡ç¨‹æ˜¯åœ¨å¯åŠ¨æœåŠ¡ï¼Œå¯èƒ½ä¼šéœ€è¦ç­‰ä¸€ç‚¹æ—¶é—´</p>
</blockquote>
<p>åŒæ—¶ï¼Œå¤§çº¦è¿‡30ç§’å·¦å³ï¼Œæˆ‘ä»¬å›åˆ°åˆšæ‰çš„è®¾ç½®çª—å£ï¼Œé€‰æ‹© <code>Open the Web UI</code> ï¼Œæ‰“å¼€ <code>OpenClaw</code> çš„UIç•Œé¢ï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131134103270.png" alt="" loading="lazy"/></p>
<p>æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€Web UIç•Œé¢ï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131134353511.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-14">ä¹ï¼‰æµ‹è¯•ä¸€ä¸‹</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131140151141.png" alt="" loading="lazy"/></p>
<h2 data-id="heading-15">äº”ã€æ¥å…¥é£ä¹¦æœºå™¨äºº</h2>
<p>æˆ‘ä»¬éœ€è¦å…ˆåˆ°é£ä¹¦å¹³å°åˆ›å»ºè‡ªå·±çš„æœºå™¨äººæ¥æ¥å…¥OpenClawï¼š</p>
<h3 data-id="heading-16">ä¸€ï¼‰æ¥åˆ°é£ä¹¦å¼€å‘è€…åå°</h3>
<p>é£ä¹¦å¼€æ”¾å¹³å°åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.feishu.cn" target="_blank" title="https://open.feishu.cn" ref="nofollow noopener noreferrer">open.feishu.cn</a></p>
<blockquote>
<p>æ²¡æœ‰é£ä¹¦è´¦å·çš„ï¼Œéœ€è¦è‡ªå·±æ³¨å†Œè´¦å·</p>
</blockquote>
<p>ç‚¹å‡»å³ä¸Šè§’è¿›å…¥ <strong>å¼€å‘è€…åå°</strong>ï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131120431211.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-17">äºŒï¼‰åˆ›å»ºåº”ç”¨</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131120537106.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-18">ä¸‰ï¼‰å¡«å†™åº”ç”¨ä¿¡æ¯</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131120748227.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-19">å››ï¼‰è·å–è‡ªå·±çš„åº”ç”¨å‡­è¯</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131121024850.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-20">äº”ï¼‰ç»™åº”ç”¨æ·»åŠ æœºå™¨äºº</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131121136834.png" alt="" loading="lazy"/></p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131121241738.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-21">å…­ï¼‰ç»™åº”ç”¨é…ç½®æƒé™</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131121421203.png" alt="" loading="lazy"/></p>
<p>æŠŠå³æ—¶é€šè®¯ç›¸å…³çš„æƒé™å…¨éƒ¨å¼€é€šï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131121712139.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-22">ä¸ƒï¼‰åˆ›å»ºç‰ˆæœ¬å¹¶å‘å¸ƒ</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131130145394.png" alt="" loading="lazy"/></p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131130349282.png" alt="" loading="lazy"/></p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131130410441.png" alt="" loading="lazy"/></p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131130451252.png" alt="" loading="lazy"/></p>
<p>æ¥åˆ°é£ä¹¦å®¢æˆ·ç«¯è¿›è¡Œå®¡æ‰¹ï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131130639324.png" alt="" loading="lazy"/></p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131130821620.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-23">å…«ï¼‰å®‰è£…é£ä¹¦æ’ä»¶</h3>
<p>æ‰“å¼€powershellï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…é£ä¹¦æ’ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">openclaw plugins install @m1heng-clawd/feishu
</code></pre>
<p>å®‰è£…æˆåŠŸåï¼Œå†æ‰“å¼€ä¸€ä¸ªæ–°çš„å‘½ä»¤çª—å£ï¼Œå¼€å§‹é…ç½®é£ä¹¦æ’ä»¶ï¼š</p>
<p>è¾“å…¥å‘½ä»¤ï¼š<code>openclaw config</code></p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131140748400.png" alt="" loading="lazy"/></p>
<p>é€‰æ‹©æ¸ é“:
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131140941836.png" alt="" loading="lazy"/></p>
<p>é€‰æ‹©é…ç½®é“¾æ¥:
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131141135023.png" alt="" loading="lazy"/></p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131152543243.png" alt="" loading="lazy"/></p>
<p>è¾“å…¥é£ä¹¦çš„AppIDï¼ŒAppSecrectï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131152927522.png" alt="" loading="lazy"/></p>
<p>åŸŸåé€‰æ‹©ä¸­å›½çš„ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131153016637.png" alt="" loading="lazy"/></p>
<p>æ¥å—ç¾¤ç»„èŠå¤©ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131153543943.png" alt="" loading="lazy"/></p>
<p>é€‰æ‹©å®Œæˆï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131153654362.png" alt="" loading="lazy"/></p>
<p>é€‰æ‹©yesï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131153823553.png" alt="" loading="lazy"/></p>
<p>é€‰æ‹©openï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131153927262.png" alt="" loading="lazy"/></p>
<p>é€‰æ‹©ç»§ç»­ï¼Œå®Œæˆé…ç½®ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131154129957.png" alt="" loading="lazy"/></p>
<p>é‡å¯æœåŠ¡ï¼Œä½¿é…ç½®ç”Ÿæ•ˆï¼š
æ§åˆ¶å¯ä»¥çœ‹åˆ°é£ä¹¦æ’ä»¶å·²ç»é…ç½®æˆåŠŸ
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131154358480.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-24">ä¸ƒï¼‰å›åˆ°é£ä¹¦åå°è®¾ç½®äº‹ä»¶å›è°ƒ</h3>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131122147684.png" alt="" loading="lazy"/></p>
<p>é€‰æ‹© <code>ä½¿ç”¨é•¿è¿æ¥æ¥æ”¶äº‹ä»¶</code> ï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131122417787.png" alt="" loading="lazy"/></p>
<p>å¯ä»¥çœ‹åˆ°æ·»åŠ äº‹ä»¶æŒ‰é’®ç”±åŸæ¥çš„ç°è‰²ä¸å¯ç‚¹å‡»å˜ä¸ºå¯ç‚¹å‡»ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131154840203.png" alt="" loading="lazy"/></p>
<p>æ·»åŠ æ¥æ”¶æ¶ˆæ¯äº‹ä»¶ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131155111193.png" alt="" loading="lazy"/></p>
<p>ç»™åº”ç”¨å¼€é€šè·å–é€šè®¯å½•åŸºæœ¬ä¿¡æ¯çš„æƒé™ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131160518957.png" alt="" loading="lazy"/></p>
<p>é‡æ–°å‘å¸ƒç‰ˆæœ¬ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131155247357.png" alt="" loading="lazy"/></p>
<p>è·Ÿå‰é¢çš„æ­¥éª¤ä¸€æ ·ï¼Œå‘å¸ƒä¸ºåœ¨çº¿åº”ç”¨å³å¯ã€‚</p>
<p>ç°åœ¨å¯ä»¥åœ¨ é£ä¹¦ä¸­ä¸ AI åŠ©æ‰‹å¯¹è¯äº†ï¼</p>
<h3 data-id="heading-25">å…«ï¼‰åœ¨é£ä¹¦ä¸­ä¸OpenClawå¯¹è¯</h3>
<p>æ¥åˆ°é£ä¹¦å®¢æˆ·ç«¯æˆ–è€…æ‰‹æœºé£ä¹¦appä¸Šï¼š</p>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131155708859.png" alt="" loading="lazy"/></p>
<p>ä»¥ä¸‹æ˜¯openclawæ–‡ä»¶å¤¹ä¸‹é¢çš„æ–‡æ¡£å†…çš„å†…å®¹ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131161323160.png" alt="" loading="lazy"/></p>
<p>ç°åœ¨æˆ‘è·ŸåºŸæ°´æœºå™¨äººå¯¹è¯ï¼Œè®©ä»–å‘Šè¯‰æˆ‘æŒ‡å®šæ–‡æ¡£å†…æ˜¯ä»€ä¹ˆå†…å®¹ï¼š
<img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/mdc8853a9ea7eadcc162bacf6a2a3984fd.jpg" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-26">å…­ã€è®¿é—® Web æ§åˆ¶é¢æ¿</h2>
<p>é…ç½®å®Œæˆåï¼ŒPowerShell çª—å£åº•éƒ¨ä¼šæ˜¾ç¤ºæ§åˆ¶é¢æ¿é“¾æ¥ï¼Œæ ¼å¼ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">Control UI: http:<span class="hljs-comment">//127.0.0.1:18789</span>
</code></pre>
<ol>
<li>å¤åˆ¶å®Œæ•´é“¾æ¥</li>
<li>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€</li>
<li>å³å¯çœ‹åˆ°å¯è§†åŒ–UIç®¡ç†ç•Œé¢</li>
</ol>
<hr/>
<h2 data-id="heading-27">ä¸ƒã€å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥</h2>









































<table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><code>openclaw onboard</code></td><td>é‡æ–°è¿›å…¥é…ç½®å‘å¯¼</td></tr><tr><td><code>openclaw status</code></td><td>æŸ¥çœ‹è¿è¡ŒçŠ¶æ€</td></tr><tr><td><code>openclaw health</code></td><td>å¥åº·æ£€æŸ¥</td></tr><tr><td><code>openclaw gateway start</code></td><td>å¯åŠ¨æœåŠ¡</td></tr><tr><td><code>openclaw gateway stop</code></td><td>åœæ­¢æœåŠ¡</td></tr><tr><td><code>openclaw update</code></td><td>æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬</td></tr><tr><td><code>openclaw doctor</code></td><td>è¯Šæ–­é—®é¢˜</td></tr><tr><td><code>openclaw uninstall</code></td><td>å¸è½½ OpenClaw</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-28">å…«ã€å¸¸è§é—®é¢˜è§£ç­”</h2>
<h4 data-id="heading-29">Q1: å®‰è£…é£ä¹¦æ’ä»¶æç¤ºï¼šspawn npm ENOENT</h4>
<p><img src="https://wamplempic.oss-cn-beijing.aliyuncs.com/md20260131163300401.png" alt="" loading="lazy"/></p>
<p>é—®é¢˜åŸå› ï¼šè¿™å¯èƒ½æ˜¯openclawçš„ä¸€ä¸ªbugï¼Œå¯ä»¥ç­‰å®˜æ–¹æ›´æ–°ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å»å®˜æ–¹ä»“åº“æissue</p>
<p>è§£å†³æ­¥éª¤ï¼š</p>
<p>å®šä½é—®é¢˜ä»£ç </p>
<p>æ–‡ä»¶è·¯å¾„ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">C:\Users\Administrator\AppData\Roaming\fnm\node-versions\v22<span class="hljs-number">.14</span><span class="hljs-number">.0</span>\installation\node_modules\openclaw\dist\process\exec.js
</code></pre>
<p>ä¿®æ”¹ä»£ç </p>
<p>æ‰¾åˆ° <code>runCommandWithTimeout</code> å‡½æ•°ä¸­çš„ spawn è°ƒç”¨ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<p><strong>ä¿®æ”¹å‰ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> stdio = <span class="hljs-title function_">resolveCommandStdio</span>({ hasInput, <span class="hljs-attr">preferInherit</span>: <span class="hljs-literal">true</span> });
<span class="hljs-keyword">const</span> child = <span class="hljs-title function_">spawn</span>(argv[<span class="hljs-number">0</span>], argv.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>), {
    stdio,
    cwd,
    <span class="hljs-attr">env</span>: resolvedEnv,
    windowsVerbatimArguments,
});
</code></pre>
<p><strong>ä¿®æ”¹åï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> stdio = <span class="hljs-title function_">resolveCommandStdio</span>({ hasInput, <span class="hljs-attr">preferInherit</span>: <span class="hljs-literal">true</span> });
<span class="hljs-comment">// On Windows, npm must be spawned with shell: true or use .cmd extension</span>
<span class="hljs-keyword">let</span> command = argv[<span class="hljs-number">0</span>];
<span class="hljs-keyword">let</span> useShell = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">if</span> (process.<span class="hljs-property">platform</span> === <span class="hljs-string">"win32"</span> &amp;&amp; path.<span class="hljs-title function_">basename</span>(command) === <span class="hljs-string">"npm"</span>) {
    useShell = <span class="hljs-literal">true</span>;
}
<span class="hljs-keyword">const</span> child = <span class="hljs-title function_">spawn</span>(command, argv.<span class="hljs-title function_">slice</span>(<span class="hljs-number">1</span>), {
    stdio,
    cwd,
    <span class="hljs-attr">env</span>: resolvedEnv,
    <span class="hljs-attr">shell</span>: useShell,
});
</code></pre>
<h4 data-id="heading-30">Q2: æç¤º "openclaw å‘½ä»¤æ‰¾ä¸åˆ°"</h4>
<p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>
<ol>
<li>å…³é—­æ‰€æœ‰ PowerShell çª—å£</li>
<li>é‡æ–°æ‰“å¼€ PowerShell</li>
<li>å¦‚æœè¿˜ä¸è¡Œï¼Œæ‰§è¡Œ <code>exec bash</code> æˆ–é‡å¯ç”µè„‘</li>
</ol>
<h4 data-id="heading-31">Q3: å®‰è£…å¡ä½ä¸åŠ¨</h4>
<p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>
<ol>
<li>æŒ‰ <code>Ctrl + C</code> ä¸­æ–­å½“å‰æ“ä½œ</li>
<li>æ‰§è¡Œï¼š<code>openclaw doctor</code> æ£€æŸ¥é—®é¢˜</li>
<li>å¦‚æç¤ºç½‘ç»œé—®é¢˜ï¼Œæ£€æŸ¥é˜²ç«å¢™è®¾ç½®</li>
</ol>
<h4 data-id="heading-32">Q4: API Key é…ç½®é”™è¯¯</h4>
<p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>
<ol>
<li>æ‰§è¡Œï¼š<code>openclaw onboard</code></li>
<li>é€‰æ‹©é‡æ–°é…ç½® API Key</li>
<li>ç¡®ä¿å¯†é’¥æ ¼å¼æ­£ç¡®</li>
</ol>
<h4 data-id="heading-33">Q5: ç«¯å£ 18789 è¢«å ç”¨</h4>
<p><strong>è§£å†³æ–¹æ³•ï¼š</strong></p>
<pre><code class="hljs language-powershell" lang="powershell">openclaw gateway --port 18790
</code></pre>
<p>ä½¿ç”¨å…¶ä»–ç«¯å£å¯åŠ¨æœåŠ¡ã€‚</p>
<h2 data-id="heading-34">ä¹ã€æˆæœ¬è¯´æ˜</h2>
<p>OpenClaw è½¯ä»¶æœ¬èº«å®Œå…¨å…è´¹ï¼Œä¸»è¦æˆæœ¬æ¥è‡ª AI æ¨¡å‹ API è°ƒç”¨ï¼Œå¯é€‰æ‹©å›½äº§å¤§æ¨¡å‹ï¼Œé™ä½æˆæœ¬ã€‚</p>
<hr/>
<h2 data-id="heading-35">ç»“è¯­</h2>
<p>OpenClaw ä»£è¡¨äº†ä¸ªäºº AI åŠ©ç†çš„æœªæ¥è¶‹åŠ¿â€”â€”ä»"èŠå¤©å·¥å…·"è¿›åŒ–ä¸º"æ‰§è¡Œå·¥å…·"ã€‚è™½ç„¶ç›®å‰çš„é…ç½®è¿‡ç¨‹å¯¹å°ç™½ç”¨æˆ·æœ‰ä¸€å®šé—¨æ§›ï¼Œä½†ä¸€æ—¦å®Œæˆè®¾ç½®ï¼Œæ‚¨å°†æ‹¥æœ‰ä¸€ä¸ª 24/7 å¾…å‘½çš„è¶…çº§åŠ©æ‰‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[ViewDirectionèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7601069677567688750</link>    <guid>https://juejin.cn/post/7601069677567688750</guid>    <pubDate>2026-02-01T03:54:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601069677567688750" data-draft-id="7601169987412328486" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[ViewDirectionèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2026-02-01T03:54:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[ViewDirectionèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T03:54:12.000Z" title="Sun Feb 01 2026 03:54:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>åœ¨Unityçš„Shader Graphä¸­ï¼ŒView DirectionèŠ‚ç‚¹æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”å¸¸ç”¨çš„å·¥å…·ï¼Œå®ƒå…è®¸å¼€å‘è€…è®¿é—®ç½‘æ ¼é¡¶ç‚¹æˆ–ç‰‡å…ƒçš„è§†å›¾æ–¹å‘çŸ¢é‡ã€‚è¿™ä¸ªçŸ¢é‡è¡¨ç¤ºä»é¡¶ç‚¹æˆ–ç‰‡å…ƒæŒ‡å‘æ‘„åƒæœºçš„æ–¹å‘ï¼Œåœ¨å…‰ç…§è®¡ç®—ã€åå°„æ•ˆæœã€è¾¹ç¼˜å…‰ç­‰ä¼—å¤šè§†è§‰æ•ˆæœä¸­æ‰®æ¼”ç€å…³é”®è§’è‰²ã€‚</p>
<h2 data-id="heading-0">View DirectionèŠ‚ç‚¹çš„åŸºæœ¬æ¦‚å¿µ</h2>
<p>View DirectionèŠ‚ç‚¹è¾“å‡ºçš„çŸ¢é‡æœ¬è´¨ä¸Šæ˜¯ä»å½“å‰å¤„ç†çš„é¡¶ç‚¹æˆ–ç‰‡å…ƒä½ç½®æŒ‡å‘æ‘„åƒæœºä½ç½®çš„çŸ¢é‡ã€‚è¿™ä¸ªçŸ¢é‡åœ¨ä¸åŒçš„æ¸²æŸ“è®¡ç®—ä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦åŸºäºè§‚å¯Ÿè§’åº¦å˜åŒ–æ•ˆæœçš„åœºæ™¯ä¸­ã€‚</p>
<p>è§†å›¾æ–¹å‘åœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­æ˜¯ä¸€ä¸ªåŸºç¡€æ¦‚å¿µï¼Œå®ƒæè¿°äº†è¡¨é¢ç‚¹ç›¸å¯¹äºè§‚å¯Ÿè€…çš„æ–¹å‘å…³ç³»ã€‚åœ¨Shader Graphä¸­ï¼ŒView DirectionèŠ‚ç‚¹å°è£…äº†è¿™ä¸€è®¡ç®—ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿè½»æ¾è·å–å’Œä½¿ç”¨è¿™ä¸€é‡è¦æ•°æ®ã€‚</p>
<p>ä»Unity 11.0ç‰ˆæœ¬å¼€å§‹ï¼ŒView DirectionèŠ‚ç‚¹åœ¨URPå’ŒHDRPä¸­çš„è¡Œä¸ºå·²ç»ç»Ÿä¸€ï¼Œéƒ½ä¼šå¯¹æ‰€æœ‰åæ ‡ç©ºé—´ä¸‹çš„è§†å›¾æ–¹å‘è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ã€‚è¿™ä¸€å˜åŒ–ç®€åŒ–äº†è·¨æ¸²æŸ“ç®¡çº¿çš„ç€è‰²å™¨å¼€å‘ï¼Œç¡®ä¿äº†è¡Œä¸ºçš„ä¸€è‡´æ€§ã€‚</p>
<h2 data-id="heading-1">èŠ‚ç‚¹å‚æ•°è¯¦è§£</h2>
<p><img src="https://docs.unity.cn/cn/Packages-cn/com.unity.shadergraph@14.0/manual/images/ViewDirectionNodeThumb.png" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">åæ ‡ç©ºé—´é€‰æ‹©</h3>
<p>View DirectionèŠ‚ç‚¹æä¾›äº†ä¸€ä¸ªé‡è¦çš„æ§ä»¶å‚æ•°â€”â€”Spaceä¸‹æ‹‰é€‰å•ï¼Œå…è®¸å¼€å‘è€…é€‰æ‹©è¾“å‡ºè§†å›¾æ–¹å‘çŸ¢é‡çš„åæ ‡ç©ºé—´ã€‚ç†è§£ä¸åŒåæ ‡ç©ºé—´çš„ç‰¹æ€§å¯¹äºæ­£ç¡®ä½¿ç”¨è¯¥èŠ‚ç‚¹è‡³å…³é‡è¦ã€‚</p>
<ul>
<li><strong>Objectç©ºé—´</strong>ï¼šåœ¨æ­¤ç©ºé—´ä¸‹ï¼Œè§†å›¾æ–¹å‘æ˜¯ç›¸å¯¹äºç‰©ä½“è‡ªèº«åæ ‡ç³»è¡¨è¾¾çš„ã€‚è¿™æ„å‘³ç€æ— è®ºç‰©ä½“å¦‚ä½•æ—‹è½¬ã€ç§»åŠ¨æˆ–ç¼©æ”¾ï¼Œè§†å›¾æ–¹å‘éƒ½ä¼šç›¸å¯¹äºç‰©ä½“çš„æœ¬åœ°åæ ‡ç³»è¿›è¡Œè®¡ç®—ã€‚åœ¨éœ€è¦åŸºäºç‰©ä½“è‡ªèº«æ–¹å‘çš„æ•ˆæœæ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå¦‚æŸäº›ç±»å‹çš„å¡é€šæ¸²æŸ“æˆ–ç‰©ä½“ç‰¹å®šçš„å…‰ç…§æ•ˆæœã€‚</li>
<li><strong>Viewç©ºé—´</strong>ï¼šä¹Ÿç§°ä¸ºæ‘„åƒæœºç©ºé—´ï¼Œåœ¨æ­¤ç©ºé—´ä¸­ï¼Œæ‘„åƒæœºä½äºåŸç‚¹ï¼Œè§†å›¾æ–¹å‘æ˜¯ç›¸å¯¹äºæ‘„åƒæœºåæ ‡ç³»çš„ã€‚è¿™ä¸ªç©ºé—´ä¸‹çš„è®¡ç®—é€šå¸¸æ›´é«˜æ•ˆï¼Œå› ä¸ºè®¸å¤šä¸è§†å›¾ç›¸å…³çš„å˜æ¢å·²ç»å®Œæˆã€‚é€‚ç”¨äºå±å¹•ç©ºé—´æ•ˆæœã€ä¸æ‘„åƒæœºç›´æ¥ç›¸å…³çš„ç‰¹æ•ˆã€‚</li>
<li><strong>Worldç©ºé—´</strong>ï¼šåœ¨æ­¤ç©ºé—´ä¸‹ï¼Œè§†å›¾æ–¹å‘æ˜¯åŸºäºä¸–ç•Œåæ ‡ç³»è¡¨è¾¾çš„ã€‚è¿™æ˜¯æœ€ç›´è§‚çš„ç©ºé—´ä¹‹ä¸€ï¼Œå› ä¸ºæ‰€æœ‰åœºæ™¯ä¸­çš„ç‰©ä½“éƒ½å…±äº«åŒä¸€ä¸–ç•Œåæ ‡ç³»ã€‚é€‚ç”¨äºéœ€è¦ä¸ä¸–ç•Œåæ ‡äº¤äº’çš„æ•ˆæœï¼Œå¦‚å…¨å±€å…‰ç…§ã€ç¯å¢ƒé®æŒ¡ç­‰ã€‚</li>
<li><strong>Tangentç©ºé—´</strong>ï¼šä¹Ÿç§°ä¸ºåˆ‡çº¿ç©ºé—´ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å¯¹äºè¡¨é¢æ³•çº¿çš„å±€éƒ¨åæ ‡ç³»ã€‚åœ¨æ­¤ç©ºé—´ä¸‹ï¼Œè§†å›¾æ–¹å‘æ˜¯ç›¸å¯¹äºæ¯ä¸ªé¡¶ç‚¹æˆ–ç‰‡å…ƒçš„æ³•çº¿æ–¹å‘è¡¨è¾¾çš„ã€‚ç‰¹åˆ«é€‚ç”¨äºæ³•çº¿è´´å›¾ã€è§†å·®æ˜ å°„ç­‰éœ€è¦åŸºäºè¡¨é¢æ–¹å‘çš„æ•ˆæœã€‚</li>
</ul>
<h3 data-id="heading-3">è¾“å‡ºç«¯å£</h3>
<p>View DirectionèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªè¾“å‡ºç«¯å£ï¼Œæ ‡è®°ä¸º"Out"ï¼Œè¾“å‡ºç±»å‹ä¸ºVector 3ã€‚è¿™ä¸ªä¸‰ç»´çŸ¢é‡åŒ…å«äº†åœ¨å½“å‰é€‰æ‹©çš„åæ ‡ç©ºé—´ä¸‹çš„è§†å›¾æ–¹å‘ã€‚</p>
<p>è¾“å‡ºçš„çŸ¢é‡å§‹ç»ˆæ˜¯æ ‡å‡†åŒ–çš„ï¼Œå³å…¶é•¿åº¦ä¸º1ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å¾—å¼€å‘è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥çŸ¢é‡è¿›è¡Œç‚¹ç§¯è®¡ç®—ç­‰éœ€è¦å•ä½çŸ¢é‡çš„æ“ä½œï¼Œè€Œæ— éœ€é¢å¤–çš„æ ‡å‡†åŒ–æ­¥éª¤ã€‚</p>
<h2 data-id="heading-4">åœ¨ä¸åŒæ¸²æŸ“ç®¡çº¿ä¸­çš„è¡Œä¸ºå·®å¼‚</h2>
<p>ç†è§£View DirectionèŠ‚ç‚¹åœ¨ä¸åŒæ¸²æŸ“ç®¡çº¿ä¸­çš„å†å²è¡Œä¸ºå·®å¼‚å¯¹äºç»´æŠ¤å’Œè¿ç§»ç°æœ‰é¡¹ç›®éå¸¸é‡è¦ã€‚</p>
<p>åœ¨Unity 11.0ç‰ˆæœ¬ä¹‹å‰ï¼ŒView DirectionèŠ‚ç‚¹åœ¨URPå’ŒHDRPä¸­çš„å·¥ä½œæ–¹å¼å­˜åœ¨æ˜¾è‘—å·®å¼‚ï¼š</p>
<ul>
<li>åœ¨URPä¸­ï¼Œè¯¥èŠ‚ç‚¹ä»…åœ¨Objectç©ºé—´ä¸‹è¾“å‡ºæ ‡å‡†åŒ–çš„è§†å›¾æ–¹å‘ï¼Œåœ¨å…¶ä»–åæ ‡ç©ºé—´ä¸‹åˆ™ä¿æŒåŸå§‹é•¿åº¦</li>
<li>åœ¨HDRPä¸­ï¼Œè¯¥èŠ‚ç‚¹åœ¨æ‰€æœ‰åæ ‡ç©ºé—´ä¸‹éƒ½ä¼šæ ‡å‡†åŒ–è§†å›¾æ–¹å‘</li>
</ul>
<p>è¿™ç§ä¸ä¸€è‡´æ€§å¯èƒ½å¯¼è‡´ç›¸åŒçš„ç€è‰²å™¨åœ¨ä¸åŒæ¸²æŸ“ç®¡çº¿ä¸­äº§ç”Ÿä¸åŒçš„è§†è§‰æ•ˆæœã€‚ä»11.0ç‰ˆæœ¬å¼€å§‹ï¼ŒUnityç»Ÿä¸€äº†è¿™ä¸€è¡Œä¸ºï¼ŒView DirectionèŠ‚ç‚¹åœ¨æ‰€æœ‰æ¸²æŸ“ç®¡çº¿å’Œæ‰€æœ‰åæ ‡ç©ºé—´ä¸‹éƒ½ä¼šè¾“å‡ºæ ‡å‡†åŒ–çš„è§†å›¾æ–¹å‘ã€‚</p>
<p>å¯¹äºéœ€è¦åœ¨URPä¸­ä½¿ç”¨æ—§è¡Œä¸ºï¼ˆåœ¨Objectç©ºé—´å¤–ä½¿ç”¨æœªæ ‡å‡†åŒ–è§†å›¾æ–¹å‘ï¼‰çš„å¼€å‘è€…ï¼ŒUnityæä¾›äº†View VectorèŠ‚ç‚¹ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆã€‚è¿™ä¸ªèŠ‚ç‚¹ä¿æŒäº†æ—§ç‰ˆæœ¬View DirectionèŠ‚ç‚¹çš„è¡Œä¸ºï¼Œç¡®ä¿äº†å‘åå…¼å®¹æ€§ã€‚</p>
<h2 data-id="heading-5">å®é™…åº”ç”¨åœºæ™¯</h2>
<p>View DirectionèŠ‚ç‚¹åœ¨ç€è‰²å™¨å¼€å‘ä¸­æœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼š</p>
<h3 data-id="heading-6">å…‰ç…§è®¡ç®—</h3>
<p>åœ¨å…‰ç…§æ¨¡å‹ä¸­ï¼Œè§†å›¾æ–¹å‘æ˜¯è®¡ç®—é«˜å…‰åå°„çš„å…³é”®è¦ç´ ã€‚ç»“åˆè¡¨é¢æ³•çº¿å’Œå…‰ç…§æ–¹å‘ï¼Œè§†å›¾æ–¹å‘ç”¨äºç¡®å®šè§‚å¯Ÿè€…çœ‹åˆ°çš„é«˜å…‰å¼ºåº¦ã€‚</p>
<ul>
<li>åœ¨Blinn-Phongå…‰ç…§æ¨¡å‹ä¸­ï¼Œä½¿ç”¨æ³•çº¿ã€å…‰ç…§æ–¹å‘å’Œè§†å›¾æ–¹å‘çš„åŠè§’çŸ¢é‡æ¥è®¡ç®—é«˜å…‰</li>
<li>åœ¨åŸºäºç‰©ç†çš„æ¸²æŸ“ä¸­ï¼Œè§†å›¾æ–¹å‘æ˜¯åŒå‘åå°„åˆ†å¸ƒå‡½æ•°çš„é‡è¦è¾“å…¥</li>
</ul>
<h3 data-id="heading-7">è¾¹ç¼˜å…‰æ•ˆæœ</h3>
<p>è§†å›¾æ–¹å‘å¯ç”¨äºåˆ›å»ºè¾¹ç¼˜å…‰æ•ˆæœï¼Œå½“è¡¨é¢å‡ ä¹ä¸è§†å›¾æ–¹å‘å¹³è¡Œæ—¶å¢å¼ºå…¶äº®åº¦ã€‚</p>
<ul>
<li>é€šè¿‡è®¡ç®—è¡¨é¢æ³•çº¿ä¸è§†å›¾æ–¹å‘çš„ç‚¹ç§¯ï¼Œå¯ä»¥ç¡®å®šè¡¨é¢çš„è¾¹ç¼˜ç¨‹åº¦</li>
<li>ç»“åˆè²æ¶…è€³æ•ˆåº”ï¼Œå¯ä»¥åˆ›å»ºé€¼çœŸçš„è¾¹ç¼˜å‘å…‰æ•ˆæœ</li>
</ul>
<h3 data-id="heading-8">åå°„æ•ˆæœ</h3>
<p>è§†å›¾æ–¹å‘åœ¨åå°„è®¡ç®—ä¸­è‡³å…³é‡è¦ï¼Œæ— è®ºæ˜¯å¹³é¢åå°„ã€ç¯å¢ƒæ˜ å°„è¿˜æ˜¯å±å¹•ç©ºé—´åå°„ã€‚</p>
<ul>
<li>åœ¨ç«‹æ–¹ä½“ç¯å¢ƒæ˜ å°„ä¸­ï¼Œä½¿ç”¨è§†å›¾æ–¹å‘è®¡ç®—åå°„çŸ¢é‡</li>
<li>åœ¨å±å¹•ç©ºé—´åå°„ä¸­ï¼Œè§†å›¾æ–¹å‘ç”¨äºç¡®å®šåå°„å°„çº¿çš„æ–¹å‘</li>
</ul>
<h3 data-id="heading-9">è§†å·®æ˜ å°„</h3>
<p>åœ¨è§†å·®æ˜ å°„æŠ€æœ¯ä¸­ï¼Œè§†å›¾æ–¹å‘ç”¨äºæ¨¡æ‹Ÿè¡¨é¢çš„æ·±åº¦å’Œå‡¹å‡¸æ„Ÿã€‚</p>
<ul>
<li>åœ¨åˆ‡çº¿ç©ºé—´ä¸­ä½¿ç”¨è§†å›¾æ–¹å‘åç§»çº¹ç†åæ ‡</li>
<li>åˆ›å»ºæ›´çœŸå®çš„è¡¨é¢å‡¹å‡¸æ•ˆæœï¼Œå¢å¼ºåœºæ™¯çš„ç«‹ä½“æ„Ÿ</li>
</ul>
<h2 data-id="heading-10">ä½¿ç”¨ç¤ºä¾‹ä¸æ­¥éª¤</h2>
<h3 data-id="heading-11">åŸºç¡€è§†å›¾æ–¹å‘å¯è§†åŒ–</h3>
<p>åˆ›å»ºä¸€ä¸ªç®€å•çš„ç€è‰²å™¨ï¼Œç›´æ¥æ˜¾ç¤ºè§†å›¾æ–¹å‘ï¼š</p>
<ul>
<li>åœ¨Shader Graphä¸­åˆ›å»ºæ–°å›¾</li>
<li>æ·»åŠ View DirectionèŠ‚ç‚¹ï¼Œé€‰æ‹©Worldç©ºé—´</li>
<li>å°†View DirectionèŠ‚ç‚¹è¿æ¥åˆ°ä¸»èŠ‚ç‚¹çš„Base Colorç«¯å£</li>
<li>ç”±äºè§†å›¾æ–¹å‘å¯èƒ½åŒ…å«è´Ÿå€¼ï¼Œéœ€è¦å°†å…¶æ˜ å°„åˆ°0-1èŒƒå›´</li>
<li>å¯ä»¥ä½¿ç”¨RemapèŠ‚ç‚¹æˆ–ç®€å•çš„æ•°å­¦è¿ç®—å®Œæˆè¿™ä¸€æ˜ å°„</li>
</ul>
<p>è¿™ä¸ªç®€å•çš„ç¤ºä¾‹å¯ä»¥å¸®åŠ©å¼€å‘è€…ç›´è§‚ç†è§£è§†å›¾æ–¹å‘åœ¨ä¸åŒè¡¨é¢åŒºåŸŸçš„å˜åŒ–ã€‚</p>
<h3 data-id="heading-12">åˆ›å»ºè²æ¶…è€³æ•ˆæœ</h3>
<p>è²æ¶…è€³æ•ˆæœæ¨¡æ‹Ÿäº†ç‰©ä½“è¡¨é¢åœ¨æ å°„è§’ï¼ˆè¡¨é¢å‡ ä¹ä¸è§†å›¾å¹³è¡Œï¼‰åå°„ç‡å¢åŠ çš„ç°è±¡ï¼š</p>
<ul>
<li>æ·»åŠ View DirectionèŠ‚ç‚¹å’ŒNormalèŠ‚ç‚¹ï¼Œç¡®ä¿ä½¿ç”¨ç›¸åŒçš„åæ ‡ç©ºé—´</li>
<li>ä½¿ç”¨Dot ProductèŠ‚ç‚¹è®¡ç®—æ³•çº¿å’Œè§†å›¾æ–¹å‘çš„ç‚¹ç§¯</li>
<li>ä½¿ç”¨One MinusèŠ‚ç‚¹åè½¬ç»“æœï¼Œä½¿æ å°„è§’çš„å€¼æ¥è¿‘1</li>
<li>ä½¿ç”¨PowerèŠ‚ç‚¹æ§åˆ¶æ•ˆæœçš„è¡°å‡ç¨‹åº¦</li>
<li>å°†ç»“æœä¸é¢œè‰²æˆ–çº¹ç†ç›¸ä¹˜ï¼Œè¿æ¥åˆ°å‘å°„æˆ–åŸºç¡€é¢œè‰²</li>
</ul>
<h3 data-id="heading-13">å®ç°ç®€å•çš„è¾¹ç¼˜å…‰</h3>
<p>åˆ›å»ºä¸€ä¸ªåŸºç¡€çš„è¾¹ç¼˜å…‰æ•ˆæœï¼š</p>
<ul>
<li>æŒ‰ç…§è²æ¶…è€³æ•ˆæœçš„æ­¥éª¤è®¡ç®—è¾¹ç¼˜å› å­</li>
<li>ä½¿ç”¨Smoothstepæˆ–ColorèŠ‚ç‚¹æ§åˆ¶è¾¹ç¼˜å…‰çš„èŒƒå›´å’Œé¢œè‰²</li>
<li>å°†ç»“æœæ·»åŠ åˆ°ç°æœ‰çš„å…‰ç…§è®¡ç®—ä¸­</li>
<li>å¯ä»¥ç»“åˆæ·±åº¦æˆ–å±å¹•ç©ºé—´ä¿¡æ¯å¢å¼ºæ•ˆæœçš„çœŸå®æ€§</li>
</ul>
<h3 data-id="heading-14">é«˜çº§åå°„æ•ˆæœ</h3>
<p>åˆ›å»ºä¸€ä¸ªåŸºäºè§†å›¾æ–¹å‘çš„åå°„æ•ˆæœï¼š</p>
<ul>
<li>ä½¿ç”¨View DirectionèŠ‚ç‚¹å’ŒNormalèŠ‚ç‚¹è®¡ç®—åå°„æ–¹å‘</li>
<li>å°†åå°„æ–¹å‘ç”¨äºé‡‡æ ·ç¯å¢ƒè´´å›¾æˆ–åå°„æ¢é’ˆ</li>
<li>ç»“åˆç²—ç³™åº¦è´´å›¾æ§åˆ¶åå°„çš„æ¨¡ç³Šç¨‹åº¦</li>
<li>ä½¿ç”¨è²æ¶…è€³æ•ˆåº”æ··åˆåå°„é¢œè‰²å’Œè¡¨é¢é¢œè‰²</li>
</ul>
<h2 data-id="heading-15">æ€§èƒ½è€ƒè™‘ä¸æœ€ä½³å®è·µ</h2>
<p>è™½ç„¶View DirectionèŠ‚ç‚¹æœ¬èº«è®¡ç®—å¼€é”€ä¸å¤§ï¼Œä½†åœ¨å¤§è§„æ¨¡ä½¿ç”¨æ—¶åº”è€ƒè™‘æ€§èƒ½å½±å“ï¼š</p>
<ul>
<li>åœ¨ç‰‡å…ƒç€è‰²å™¨ä¸­è®¡ç®—è§†å›¾æ–¹å‘æ¯”åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è®¡ç®—æ›´ç²¾ç¡®ä½†æ›´æ˜‚è´µ</li>
<li>å¯¹äºä¸éœ€è¦é«˜ç²¾åº¦çš„æ•ˆæœï¼Œè€ƒè™‘åœ¨é¡¶ç‚¹ç€è‰²å™¨ä¸­è®¡ç®—è§†å›¾æ–¹å‘å¹¶æ’å€¼</li>
<li>é¿å…åœ¨ç€è‰²å™¨ä¸­é‡å¤è®¡ç®—è§†å›¾æ–¹å‘ï¼Œå°½å¯èƒ½é‡ç”¨è®¡ç®—ç»“æœ</li>
<li>æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„åæ ‡ç©ºé—´ï¼Œå‡å°‘ä¸å¿…è¦çš„ç©ºé—´è½¬æ¢</li>
</ul>
<p>åœ¨ç§»åŠ¨å¹³å°æˆ–æ€§èƒ½å—é™çš„ç¯å¢ƒä¸­ï¼Œåº”ç‰¹åˆ«å…³æ³¨è§†å›¾æ–¹å‘è®¡ç®—çš„å¼€é”€ï¼š</p>
<ul>
<li>å°½å¯èƒ½ä½¿ç”¨è®¡ç®—é‡è¾ƒå°çš„åæ ‡ç©ºé—´</li>
<li>è€ƒè™‘ä½¿ç”¨è¿‘ä¼¼è®¡ç®—æ›¿ä»£ç²¾ç¡®çš„è§†å›¾æ–¹å‘</li>
<li>å¯¹äºè¿œå¤„æˆ–å°ç‰©ä½“ï¼Œå¯ä»¥ä½¿ç”¨ç®€åŒ–çš„è§†å›¾æ–¹å‘è®¡ç®—</li>
</ul>
<h2 data-id="heading-16">å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-17">è§†å›¾æ–¹å‘æ˜¾ç¤ºå¼‚å¸¸</h3>
<p>å½“è§†å›¾æ–¹å‘æ˜¾ç¤ºä¸æ­£ç¡®æ—¶ï¼Œé€šå¸¸æ˜¯ç”±äºåæ ‡ç©ºé—´ä¸åŒ¹é…é€ æˆçš„ï¼š</p>
<ul>
<li>ç¡®ä¿View DirectionèŠ‚ç‚¹å’Œä¸ä¹‹äº¤äº’çš„å…¶ä»–èŠ‚ç‚¹ä½¿ç”¨ç›¸åŒçš„åæ ‡ç©ºé—´</li>
<li>æ£€æŸ¥ç‰©ä½“çš„å˜æ¢çŸ©é˜µæ˜¯å¦åŒ…å«éå¸¸è§„çš„ç¼©æ”¾æˆ–æ—‹è½¬</li>
<li>éªŒè¯æ‘„åƒæœºçš„è®¾ç½®ï¼Œç‰¹åˆ«æ˜¯æ­£äº¤æŠ•å½±ä¸é€è§†æŠ•å½±çš„åŒºåˆ«</li>
</ul>
<h3 data-id="heading-18">æ€§èƒ½é—®é¢˜</h3>
<p>å¦‚æœç€è‰²å™¨å› è§†å›¾æ–¹å‘è®¡ç®—å¯¼è‡´æ€§èƒ½ä¸‹é™ï¼š</p>
<ul>
<li>åˆ†ææ˜¯å¦çœŸçš„éœ€è¦åœ¨ç‰‡å…ƒçº§åˆ«è®¡ç®—è§†å›¾æ–¹å‘</li>
<li>è€ƒè™‘ä½¿ç”¨æ›´ç®€åŒ–çš„è®¡ç®—æ¨¡å‹</li>
<li>æ£€æŸ¥æ˜¯å¦æœ‰é‡å¤çš„è§†å›¾æ–¹å‘è®¡ç®—å¯ä»¥åˆå¹¶</li>
</ul>
<h3 data-id="heading-19">è·¨å¹³å°å…¼å®¹æ€§</h3>
<p>ç¡®ä¿è§†å›¾æ–¹å‘ç›¸å…³æ•ˆæœåœ¨ä¸åŒå¹³å°ä¸Šè¡¨ç°ä¸€è‡´ï¼š</p>
<ul>
<li>æµ‹è¯•åœ¨ä¸åŒå›¾å½¢APIä¸‹çš„è¡¨ç°</li>
<li>éªŒè¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„ç²¾åº¦å’Œæ€§èƒ½</li>
<li>è€ƒè™‘ä¸ºä¸åŒå¹³å°æä¾›ä¸åŒçš„ç²¾åº¦æˆ–å®ç°</li>
</ul>
<h2 data-id="heading-20">è¿›é˜¶æŠ€å·§ä¸åˆ›æ„åº”ç”¨</h2>
<h3 data-id="heading-21">ç»“åˆæ—¶é—´å˜åŒ–çš„åŠ¨æ€æ•ˆæœ</h3>
<p>é€šè¿‡å°†è§†å›¾æ–¹å‘ä¸æ—¶é—´å‚æ•°ç»“åˆï¼Œå¯ä»¥åˆ›å»ºåŠ¨æ€å˜åŒ–çš„è§†è§‰æ•ˆæœï¼š</p>
<ul>
<li>ä½¿ç”¨è§†å›¾æ–¹å‘é©±åŠ¨åŠ¨ç”»æˆ–çº¹ç†åç§»</li>
<li>åˆ›å»ºéšç€è§‚å¯Ÿè§’åº¦å˜åŒ–è€ŒåŠ¨æ€è°ƒæ•´çš„æ•ˆæœ</li>
<li>å®ç°ç±»ä¼¼å…¨æ¯å›¾æˆ–ç§‘å¹»ç•Œé¢å…ƒç´ çš„è§†è§‰æ•ˆæœ</li>
</ul>
<h3 data-id="heading-22">éçœŸå®æ„Ÿæ¸²æŸ“</h3>
<p>åœ¨å¡é€šæ¸²æŸ“æˆ–å…¶ä»–éçœŸå®æ„Ÿæ¸²æŸ“é£æ ¼ä¸­ï¼Œè§†å›¾æ–¹å‘å¯ä»¥ç”¨äºï¼š</p>
<ul>
<li>æ§åˆ¶è½®å»“çº¿çš„ç²—ç»†å’Œå¼ºåº¦</li>
<li>å®ç°åŸºäºè§’åº¦çš„è‰²å½©ç®€åŒ–</li>
<li>åˆ›å»ºæ‰‹ç»˜é£æ ¼çš„ç¬”è§¦æ•ˆæœ</li>
</ul>
<h3 data-id="heading-23">ç‰¹æ®Šæè´¨æ¨¡æ‹Ÿ</h3>
<p>è§†å›¾æ–¹å‘åœ¨æ¨¡æ‹Ÿç‰¹æ®Šæè´¨æ—¶éå¸¸æœ‰ç”¨ï¼š</p>
<ul>
<li>æ¨¡æ‹Ÿä¸ç»¸ã€ç¼å­ç­‰å…·æœ‰è§’åº¦ç›¸å…³åå°„çš„ç»‡ç‰©</li>
<li>åˆ›å»ºå„å‘å¼‚æ€§ææ–™å¦‚æ‹‰ä¸é‡‘å±çš„æ•ˆæœ</li>
<li>å®ç°æ¶²æ™¶æ˜¾ç¤ºå±çš„è§’åº¦ç›¸å…³é¢œè‰²å˜åŒ–</li>
</ul>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jetson Nano å®æˆ˜ï¼šJava+YOLOv26 å®ç°è¾¹ç¼˜ç«¯å®æ—¶ç›®æ ‡æ£€æµ‹]]></title>    <link>https://juejin.cn/post/7601049142866198528</link>    <guid>https://juejin.cn/post/7601049142866198528</guid>    <pubDate>2026-01-31T13:36:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601049142866198528" data-draft-id="7601049142866182144" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jetson Nano å®æˆ˜ï¼šJava+YOLOv26 å®ç°è¾¹ç¼˜ç«¯å®æ—¶ç›®æ ‡æ£€æµ‹"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-31T13:36:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å¨å“¥"/> <meta itemprop="url" content="https://juejin.cn/user/3411107130652176"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jetson Nano å®æˆ˜ï¼šJava+YOLOv26 å®ç°è¾¹ç¼˜ç«¯å®æ—¶ç›®æ ‡æ£€æµ‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3411107130652176/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å¨å“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T13:36:09.000Z" title="Sat Jan 31 2026 13:36:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€</h2>
<p>è¾¹ç¼˜è®¡ç®—çš„æ™®åŠè®© AI æ¨ç†ä»äº‘ç«¯èµ°å‘ç»ˆç«¯ï¼ŒJetson Nano ä½œä¸ºè‹±ä¼Ÿè¾¾é¢å‘å…¥é—¨çº§è¾¹ç¼˜è®¡ç®—çš„ç¡¬ä»¶å¹³å°ï¼Œä»¥ä½æˆæœ¬ã€ä½åŠŸè€—çš„ç‰¹æ€§æˆä¸ºåµŒå…¥å¼ AI å¼€å‘çš„é¦–é€‰ï¼›è€Œ YOLOv26 ä½œä¸º YOLO ç³»åˆ—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œåœ¨ä¿æŒè½»é‡åŒ–çš„åŒæ—¶è¿›ä¸€æ­¥æå‡äº†æ£€æµ‹ç²¾åº¦å’Œæ¨ç†é€Ÿåº¦ï¼Œéå¸¸é€‚åˆè¾¹ç¼˜è®¾å¤‡éƒ¨ç½²ã€‚</p>
<p>å¤šæ•°è¾¹ç¼˜ç«¯ç›®æ ‡æ£€æµ‹æ–¹æ¡ˆåŸºäº Python å®ç°ï¼Œä½†åœ¨ä¼ä¸šçº§åº”ç”¨ä¸­ï¼ŒJava å‡­å€Ÿæˆç†Ÿçš„ç”Ÿæ€ã€ç¨³å®šçš„å¹¶å‘æ¨¡å‹å’Œå¹¿æ³›çš„å¼€å‘è€…åŸºç¡€ï¼Œä»æ˜¯ä¸»æµå¼€å‘è¯­è¨€ã€‚æœ¬æ–‡å°†ä»åº•å±‚ç¯å¢ƒæ­å»ºã€æ¨¡å‹è½¬æ¢ã€Java ä»£ç å®ç°åˆ°æ€§èƒ½ä¼˜åŒ–ï¼Œå®Œæ•´è®²è§£å¦‚ä½•åœ¨ Jetson Nano ä¸ŠåŸºäº Java+YOLOv26 å®ç°å®æ—¶ç›®æ ‡æ£€æµ‹ï¼Œå…¨ç¨‹åŸºäºå®æ“ç»éªŒï¼Œè§£å†³è¾¹ç¼˜éƒ¨ç½²ä¸­çš„æ ¸å¿ƒç—›ç‚¹ã€‚</p>
<h2 data-id="heading-1">äºŒã€æŠ€æœ¯èƒŒæ™¯ä¸ç¯å¢ƒå‡†å¤‡</h2>
<h3 data-id="heading-2">2.1 æ ¸å¿ƒç»„ä»¶è¯´æ˜</h3>

































<table><thead><tr><th>ç»„ä»¶</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td>Jetson Nano</td><td>è¾¹ç¼˜è®¡ç®—ç¡¬ä»¶ï¼Œæ­è½½ Quad-core ARM Cortex-A57 + 128-core Maxwell GPUï¼Œ4GB å†…å­˜</td></tr><tr><td>YOLOv26</td><td>å•é˜¶æ®µç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œæ”¯æŒ ONNX å¯¼å‡ºï¼Œç›¸æ¯” YOLOv8/YOLOv9ï¼Œå‚æ•°é‡å‡å°‘ 15%ï¼Œæ¨ç†é€Ÿåº¦æå‡ 20%</td></tr><tr><td>Java (OpenJDK)</td><td>é€‰æ‹© ARM æ¶æ„çš„ OpenJDK 17ï¼ˆLTS ç‰ˆæœ¬ï¼‰ï¼Œå…¼é¡¾æ€§èƒ½ä¸ç¨³å®šæ€§</td></tr><tr><td>OpenCV</td><td>è´Ÿè´£å›¾åƒé‡‡é›†ã€é¢„å¤„ç†å’Œç»“æœå¯è§†åŒ–</td></tr><tr><td>TensorRT</td><td>è‹±ä¼Ÿè¾¾ä¸“å±æ¨ç†åŠ é€Ÿå¼•æ“ï¼Œå¯¹ ONNX æ¨¡å‹è¿›è¡Œä¼˜åŒ–ï¼Œæå‡ Jetson Nano çš„æ¨ç†æ•ˆç‡</td></tr><tr><td>ONNX Runtime</td><td>è·¨å¹³å°æ¨ç†æ¡†æ¶ï¼ŒJava ç«¯é€šè¿‡ JNI è°ƒç”¨ ONNX Runtime å®ç°æ¨¡å‹æ¨ç†</td></tr></tbody></table>
<h3 data-id="heading-3">2.2 Jetson Nano ç³»ç»Ÿä¸ä¾èµ–é…ç½®</h3>
<h4 data-id="heading-4">2.2.1 ç³»ç»ŸåŸºç¡€é…ç½®ï¼ˆè§£å†³ Jetson Nano é»˜è®¤æºæ…¢ / ä¾èµ–ç¼ºå¤±é—®é¢˜ï¼‰</h4>
<p>é¦–å…ˆåˆ·å…¥ Jetson Nano å®˜æ–¹é•œåƒï¼ˆæ¨è JetPack 5.1.2ï¼Œå…¼å®¹ TensorRT 8.5ï¼‰ï¼Œå®Œæˆç³»ç»Ÿåˆå§‹åŒ–åæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ›´æ¢å›½å†…æºï¼ˆæ¸…åæºï¼‰</span>
sudo <span class="hljs-built_in">cp</span> /etc/apt/sources.list /etc/apt/sources.list.bak
sudo sed -i <span class="hljs-string">'s/ports.ubuntu.com/mirrors.tuna.tsinghua.edu.cn/g'</span> /etc/apt/sources.list
sudo apt update &amp;&amp; sudo apt upgrade -y

<span class="hljs-comment"># å®‰è£…åŸºç¡€ä¾èµ–</span>
sudo apt install -y build-essential cmake libgtk2.0-dev libavcodec-dev libavformat-dev libswscale-dev
sudo apt install -y libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev libjasper-dev libdc1394-22-dev

<span class="hljs-comment"># å®‰è£…Pythonä¾èµ–ï¼ˆç”¨äºæ¨¡å‹è½¬æ¢ï¼‰</span>
sudo apt install -y python3-pip python3-dev
pip3 install --upgrade pip
pip3 install torch torchvision onnx onnx-simplifier ultralytics
</code></pre>
<h4 data-id="heading-5">2.2.2 Java ç¯å¢ƒå®‰è£…ï¼ˆARM æ¶æ„é€‚é…ï¼‰</h4>
<p>Jetson Nano ä¸º ARM64 æ¶æ„ï¼Œéœ€å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„ OpenJDKï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…OpenJDK 17</span>
sudo apt install -y openjdk-17-jdk openjdk-17-jre

<span class="hljs-comment"># éªŒè¯å®‰è£…</span>
java -version
<span class="hljs-comment"># é¢„æœŸè¾“å‡ºï¼šopenjdk version "17.0.8" 2023-07-18</span>
<span class="hljs-comment"># OpenJDK Runtime Environment (build 17.0.8+7-Ubuntu-120.04)</span>
<span class="hljs-comment"># OpenJDK 64-Bit Server VM (build 17.0.8+7-Ubuntu-120.04, mixed mode, sharing)</span>

<span class="hljs-comment"># é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼Œç¡®ä¿javaå‘½ä»¤å…¨å±€å¯ç”¨ï¼‰</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-arm64"</span> &gt;&gt; ~/.bashrc
<span class="hljs-built_in">echo</span> <span class="hljs-string">"export PATH=<span class="hljs-variable">$JAVA_HOME</span>/bin:<span class="hljs-variable">$PATH</span>"</span> &gt;&gt; ~/.bashrc
<span class="hljs-built_in">source</span> ~/.bashrc
</code></pre>
<h4 data-id="heading-6">2.2.3 OpenCV for Java å®‰è£…ï¼ˆARM ç¼–è¯‘ï¼‰</h4>
<p>Jetson Nano é»˜è®¤çš„ OpenCV åŒ…ä¸å« Java ç»‘å®šï¼Œéœ€æ‰‹åŠ¨ç¼–è¯‘ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¸‹è½½OpenCV 4.8.0ï¼ˆå…¼å®¹JetPack 5.1.2ï¼‰</span>
wget https://github.com/opencv/opencv/archive/4.8.0.zip
unzip 4.8.0.zip &amp;&amp; cd opencv-4.8.0
mkdir build &amp;&amp; cd build

<span class="hljs-comment"># ç¼–è¯‘é…ç½®ï¼ˆå¯ç”¨Javaã€CUDAåŠ é€Ÿï¼‰</span>
cmake -D <span class="hljs-attr">CMAKE_BUILD_TYPE</span>=RELEASE \
      -D <span class="hljs-attr">CMAKE_INSTALL_PREFIX</span>=/usr/local \
      -D <span class="hljs-attr">WITH_CUDA</span>=<span class="hljs-literal">ON</span> \
      -D <span class="hljs-attr">CUDA_ARCH_BIN</span>=<span class="hljs-number">5.3</span> \
      -D <span class="hljs-attr">CUDA_ARCH_PTX</span>=<span class="hljs-string">""</span> \
      -D <span class="hljs-attr">WITH_CUDNN</span>=<span class="hljs-literal">ON</span> \
      -D <span class="hljs-attr">OPENCV_DNN_CUDA</span>=<span class="hljs-literal">ON</span> \
      -D <span class="hljs-attr">WITH_JAVA</span>=<span class="hljs-literal">ON</span> \
      -D <span class="hljs-attr">BUILD_SHARED_LIBS</span>=<span class="hljs-literal">OFF</span> \
      -D <span class="hljs-attr">BUILD_TESTS</span>=<span class="hljs-literal">OFF</span> \
      -D <span class="hljs-attr">BUILD_EXAMPLES</span>=<span class="hljs-literal">OFF</span> ..

<span class="hljs-comment"># ç¼–è¯‘ï¼ˆJetson Nanoæ€§èƒ½æœ‰é™ï¼Œéœ€4-6å°æ—¶ï¼Œå»ºè®®å¼€å¯swapï¼‰</span>
make -j2  <span class="hljs-comment"># -j2é¿å…å†…å­˜æº¢å‡º</span>
sudo make install

<span class="hljs-comment"># éªŒè¯Javaç»‘å®š</span>
ls /usr/local/share/opencv4/java/
<span class="hljs-comment"># é¢„æœŸè¾“å‡ºï¼šlibopencv_java480.so</span>
</code></pre>
<h4 data-id="heading-7">2.2.4 ONNX Runtime for Java å®‰è£…</h4>
<p>ä¸‹è½½ ARM64 ç‰ˆæœ¬çš„ ONNX Runtimeï¼ˆ1.16.0ï¼Œå…¼å®¹ YOLOv26ï¼‰ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºä¾èµ–ç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p ~/java-ai/lib
<span class="hljs-built_in">cd</span> ~/java-ai/lib

<span class="hljs-comment"># ä¸‹è½½ONNX Runtime JavaåŒ…</span>
wget https://github.com/microsoft/onnxruntime/releases/download/v1.16.0/onnxruntime-linux-aarch64-1.16.0.tgz
tar -zxvf onnxruntime-linux-aarch64-1.16.0.tgz

<span class="hljs-comment"># å¤åˆ¶soæ–‡ä»¶åˆ°ç³»ç»Ÿåº“ç›®å½•</span>
sudo <span class="hljs-built_in">cp</span> onnxruntime-linux-aarch64-1.16.0/lib/libonnxruntime.so /usr/lib/aarch64-linux-gnu/
sudo ldconfig  <span class="hljs-comment"># æ›´æ–°ç³»ç»Ÿåº“ç¼“å­˜</span>
</code></pre>
<h2 data-id="heading-8">ä¸‰ã€YOLOv26 æ¨¡å‹è½¬æ¢ï¼ˆå…³é”®æ­¥éª¤ï¼‰</h2>
<p>YOLOv26 å®˜æ–¹æä¾›çš„æ˜¯.pt æƒé‡æ–‡ä»¶ï¼Œéœ€è½¬æ¢ä¸º ONNX æ ¼å¼ï¼ˆJava ç«¯å¯è°ƒç”¨ï¼‰ï¼Œå¹¶é€šè¿‡ TensorRT ä¼˜åŒ–ï¼š</p>
<h3 data-id="heading-9">3.1 ä¸‹è½½ YOLOv26 æƒé‡å¹¶è½¬æ¢ä¸º ONNX</h3>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># ä¸‹è½½YOLOv26nï¼ˆnanoç‰ˆæœ¬ï¼Œé€‚é…Jetson Nanoï¼‰</span>
wget https://github.com/ultralytics/assets/releases/download/v8.2.0/yolov26n.pt

<span class="hljs-comment"># ä½¿ç”¨ultralyticsåº“è½¬æ¢ä¸ºONNXï¼ˆç®€åŒ–æ¨¡å‹ï¼Œç§»é™¤å†—ä½™èŠ‚ç‚¹ï¼‰</span>
python3 - &lt;&lt;EOF
from ultralytics import YOLO

<span class="hljs-comment"># åŠ è½½æ¨¡å‹</span>
<span class="hljs-attr">model</span> = YOLO(<span class="hljs-string">"yolov26n.pt"</span>)

<span class="hljs-comment"># å¯¼å‡ºONNXï¼ˆæŒ‡å®šè¾“å…¥å°ºå¯¸640x640ï¼Œé€‚é…Jetson Nanoç®—åŠ›ï¼‰</span>
model.export(
    <span class="hljs-attr">format</span>=<span class="hljs-string">"onnx"</span>,
    <span class="hljs-attr">imgsz</span>=<span class="hljs-number">640</span>,
    <span class="hljs-attr">simplify</span>=<span class="hljs-literal">True</span>,  <span class="hljs-comment"># ç®€åŒ–ONNXæ¨¡å‹</span>
    <span class="hljs-attr">opset</span>=<span class="hljs-number">12</span>,       <span class="hljs-comment"># å…¼å®¹ONNX Runtime 1.16.0</span>
    <span class="hljs-attr">device</span>=<span class="hljs-number">0</span>        <span class="hljs-comment"># ä½¿ç”¨GPUå¯¼å‡º</span>
)
EOF
</code></pre>
<h3 data-id="heading-10">3.2 TensorRT ä¼˜åŒ– ONNX æ¨¡å‹ï¼ˆæå‡æ¨ç†é€Ÿåº¦ï¼‰</h3>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è½¬æ¢ONNXä¸ºTensorRTå¼•æ“ï¼ˆFP16ç²¾åº¦ï¼Œé€‚é…Jetson Nano GPUï¼‰</span>
/usr/src/tensorrt/bin/trtexec <span class="hljs-attr">--onnx</span>=yolov26n.<span class="hljs-literal">on</span>nx --saveEngine=yolov26n_trt.engine --fp16 --workspace=<span class="hljs-number">1024</span>

<span class="hljs-comment"># éªŒè¯å¼•æ“æ–‡ä»¶</span>
ls -lh yolov26n_trt.engine
<span class="hljs-comment"># é¢„æœŸè¾“å‡ºï¼šçº¦5MBï¼Œè¯´æ˜è½¬æ¢æˆåŠŸ</span>
</code></pre>
<h2 data-id="heading-11">å››ã€Java æ ¸å¿ƒä»£ç å®ç°</h2>
<h3 data-id="heading-12">4.1 é¡¹ç›®ç»“æ„ï¼ˆMavenï¼‰</h3>
<p>åˆ›å»º Maven é¡¹ç›®ï¼Œpom.xml å¼•å…¥ä¾èµ–ï¼š</p>
<p>xml</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.edge.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jetson-yolov26<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>17<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">project.build.sourceEncoding</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- OpenCV Java --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.openpnp<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>opencv<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.8.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- ONNX Runtime Java --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.microsoft.onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>onnxruntime<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.16.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">classifier</span>&gt;</span>linux-aarch64<span class="hljs-tag">&lt;/<span class="hljs-name">classifier</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ—¥å¿—ï¼ˆå¯é€‰ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-simple<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.0.9<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span>
            <span class="hljs-comment">&lt;!-- é…ç½®JNIåº“è·¯å¾„ --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">argLine</span>&gt;</span>-Djava.library.path=/usr/local/share/opencv4/java/:/usr/lib/aarch64-linux-gnu/<span class="hljs-tag">&lt;/<span class="hljs-name">argLine</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span>
</code></pre>
<h3 data-id="heading-13">4.2 æ ¸å¿ƒä»£ç å®ç°</h3>
<h4 data-id="heading-14">4.2.1 YOLOv26 æ¨ç†å·¥å…·ç±»ï¼ˆYOLOv26Detector.javaï¼‰</h4>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.edge.ai;

<span class="hljs-keyword">import</span> ai.onnxruntime.*;
<span class="hljs-keyword">import</span> org.opencv.core.*;
<span class="hljs-keyword">import</span> org.opencv.imgproc.Imgproc;
<span class="hljs-keyword">import</span> org.opencv.videoio.VideoCapture;

<span class="hljs-keyword">import</span> java.nio.FloatBuffer;
<span class="hljs-keyword">import</span> java.util.*;

<span class="hljs-comment">/**
 * YOLOv26ç›®æ ‡æ£€æµ‹æ ¸å¿ƒç±»
 * é€‚é…Jetson Nano ARM64æ¶æ„ï¼Œæ”¯æŒå®æ—¶è§†é¢‘æµæ£€æµ‹
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YOLOv26Detector</span> {
    <span class="hljs-comment">// YOLOv26é»˜è®¤ç±»åˆ«ï¼ˆCOCO 80ç±»ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> List&lt;String&gt; CLASS_NAMES = Arrays.asList(
            <span class="hljs-string">"person"</span>, <span class="hljs-string">"bicycle"</span>, <span class="hljs-string">"car"</span>, <span class="hljs-string">"motorcycle"</span>, <span class="hljs-string">"airplane"</span>, <span class="hljs-string">"bus"</span>, <span class="hljs-string">"train"</span>, <span class="hljs-string">"truck"</span>, <span class="hljs-string">"boat"</span>,
            <span class="hljs-string">"traffic light"</span>, <span class="hljs-string">"fire hydrant"</span>, <span class="hljs-string">"stop sign"</span>, <span class="hljs-string">"parking meter"</span>, <span class="hljs-string">"bench"</span>, <span class="hljs-string">"bird"</span>, <span class="hljs-string">"cat"</span>,
            <span class="hljs-string">"dog"</span>, <span class="hljs-string">"horse"</span>, <span class="hljs-string">"sheep"</span>, <span class="hljs-string">"cow"</span>, <span class="hljs-string">"elephant"</span>, <span class="hljs-string">"bear"</span>, <span class="hljs-string">"zebra"</span>, <span class="hljs-string">"giraffe"</span>, <span class="hljs-string">"backpack"</span>,
            <span class="hljs-string">"umbrella"</span>, <span class="hljs-string">"handbag"</span>, <span class="hljs-string">"tie"</span>, <span class="hljs-string">"suitcase"</span>, <span class="hljs-string">"frisbee"</span>, <span class="hljs-string">"skis"</span>, <span class="hljs-string">"snowboard"</span>, <span class="hljs-string">"sports ball"</span>,
            <span class="hljs-string">"kite"</span>, <span class="hljs-string">"baseball bat"</span>, <span class="hljs-string">"baseball glove"</span>, <span class="hljs-string">"skateboard"</span>, <span class="hljs-string">"surfboard"</span>, <span class="hljs-string">"tennis racket"</span>,
            <span class="hljs-string">"bottle"</span>, <span class="hljs-string">"wine glass"</span>, <span class="hljs-string">"cup"</span>, <span class="hljs-string">"fork"</span>, <span class="hljs-string">"knife"</span>, <span class="hljs-string">"spoon"</span>, <span class="hljs-string">"bowl"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>,
            <span class="hljs-string">"sandwich"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"broccoli"</span>, <span class="hljs-string">"carrot"</span>, <span class="hljs-string">"hot dog"</span>, <span class="hljs-string">"pizza"</span>, <span class="hljs-string">"donut"</span>, <span class="hljs-string">"cake"</span>,
            <span class="hljs-string">"chair"</span>, <span class="hljs-string">"couch"</span>, <span class="hljs-string">"potted plant"</span>, <span class="hljs-string">"bed"</span>, <span class="hljs-string">"dining table"</span>, <span class="hljs-string">"toilet"</span>, <span class="hljs-string">"tv"</span>, <span class="hljs-string">"laptop"</span>,
            <span class="hljs-string">"mouse"</span>, <span class="hljs-string">"remote"</span>, <span class="hljs-string">"keyboard"</span>, <span class="hljs-string">"cell phone"</span>, <span class="hljs-string">"microwave"</span>, <span class="hljs-string">"oven"</span>, <span class="hljs-string">"toaster"</span>, <span class="hljs-string">"sink"</span>,
            <span class="hljs-string">"refrigerator"</span>, <span class="hljs-string">"book"</span>, <span class="hljs-string">"clock"</span>, <span class="hljs-string">"vase"</span>, <span class="hljs-string">"scissors"</span>, <span class="hljs-string">"teddy bear"</span>, <span class="hljs-string">"hair drier"</span>, <span class="hljs-string">"toothbrush"</span>
    );

    <span class="hljs-comment">// æ¨¡å‹å‚æ•°é…ç½®</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_WIDTH</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">INPUT_HEIGHT</span> <span class="hljs-operator">=</span> <span class="hljs-number">640</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">CONF_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.5f</span>;  <span class="hljs-comment">// ç½®ä¿¡åº¦é˜ˆå€¼</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">NMS_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.4f</span>;   <span class="hljs-comment">// NMSé˜ˆå€¼</span>

    <span class="hljs-keyword">private</span> OrtEnvironment env;
    <span class="hljs-keyword">private</span> OrtSession session;

    <span class="hljs-comment">/**
     * åˆå§‹åŒ–YOLOv26æ¨¡å‹
     * <span class="hljs-doctag">@param</span> modelPath ONNX/TensorRTå¼•æ“æ–‡ä»¶è·¯å¾„
     * <span class="hljs-doctag">@throws</span> OrtException ONNX Runtimeå¼‚å¸¸
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">YOLOv26Detector</span><span class="hljs-params">(String modelPath)</span> <span class="hljs-keyword">throws</span> OrtException {
        <span class="hljs-comment">// åˆå§‹åŒ–ONNX Runtimeç¯å¢ƒï¼ˆå¯ç”¨GPUï¼‰</span>
        env = OrtEnvironment.getEnvironment();
        OrtSession.<span class="hljs-type">SessionOptions</span> <span class="hljs-variable">options</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrtSession</span>.SessionOptions();
        options.addCUDA(<span class="hljs-number">0</span>);  <span class="hljs-comment">// ä½¿ç”¨Jetson Nanoçš„GPUï¼ˆè®¾å¤‡ID 0ï¼‰</span>
        options.setOptimizationLevel(OrtSession.SessionOptions.OptLevel.ALL);
        
        <span class="hljs-comment">// åŠ è½½æ¨¡å‹</span>
        session = env.createSession(modelPath, options);
    }

    <span class="hljs-comment">/**
     * å›¾åƒé¢„å¤„ç†ï¼šç¼©æ”¾ã€å½’ä¸€åŒ–ã€è½¬æ¢ä¸ºNCHWæ ¼å¼
     * <span class="hljs-doctag">@param</span> src åŸå§‹å›¾åƒ
     * <span class="hljs-doctag">@return</span> é¢„å¤„ç†åçš„å¼ é‡æ•°æ®
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">float</span>[] preprocess(Mat src) {
        <span class="hljs-comment">// 1. ç¼©æ”¾å›¾åƒï¼ˆä¿æŒæ¯”ä¾‹ï¼Œå¡«å……é»‘è¾¹ï¼‰</span>
        <span class="hljs-type">Mat</span> <span class="hljs-variable">resized</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Mat</span>();
        Imgproc.resize(src, resized, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Size</span>(INPUT_WIDTH, INPUT_HEIGHT), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, Imgproc.INTER_LINEAR);
        
        <span class="hljs-comment">// 2. å½’ä¸€åŒ–ï¼ˆ0-255 â†’ 0-1ï¼‰</span>
        resized.convertTo(resized, CvType.CV_32F, <span class="hljs-number">1.0</span> / <span class="hljs-number">255.0</span>);
        
        <span class="hljs-comment">// 3. è½¬æ¢ä¸ºNCHWæ ¼å¼ï¼ˆONNXæ¨¡å‹è¾“å…¥è¦æ±‚ï¼‰</span>
        List&lt;Mat&gt; channels = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        Core.split(resized, channels);
        
        <span class="hljs-type">float</span>[] inputData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[INPUT_WIDTH * INPUT_HEIGHT * <span class="hljs-number">3</span>];
        <span class="hljs-type">int</span> <span class="hljs-variable">idx</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (Mat channel : channels) {
            <span class="hljs-type">float</span>[] channelData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">float</span>[INPUT_WIDTH * INPUT_HEIGHT];
            channel.get(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, channelData);
            System.arraycopy(channelData, <span class="hljs-number">0</span>, inputData, idx, channelData.length);
            idx += channelData.length;
        }
        
        resized.release();
        <span class="hljs-keyword">return</span> inputData;
    }

    <span class="hljs-comment">/**
     * æ¨¡å‹æ¨ç†
     * <span class="hljs-doctag">@param</span> src åŸå§‹å›¾åƒ
     * <span class="hljs-doctag">@return</span> æ£€æµ‹ç»“æœåˆ—è¡¨
     * <span class="hljs-doctag">@throws</span> OrtException ONNX Runtimeå¼‚å¸¸
     */</span>
    <span class="hljs-keyword">public</span> List&lt;DetectionResult&gt; <span class="hljs-title function_">detect</span><span class="hljs-params">(Mat src)</span> <span class="hljs-keyword">throws</span> OrtException {
        <span class="hljs-comment">// 1. é¢„å¤„ç†</span>
        <span class="hljs-type">float</span>[] inputData = preprocess(src);
        <span class="hljs-type">long</span>[] inputShape = <span class="hljs-keyword">new</span> <span class="hljs-title class_">long</span>[]{<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, INPUT_HEIGHT, INPUT_WIDTH};  <span class="hljs-comment">// NCHW</span>
        
        <span class="hljs-comment">// 2. æ„å»ºè¾“å…¥å¼ é‡</span>
        <span class="hljs-type">OrtTensor</span> <span class="hljs-variable">inputTensor</span> <span class="hljs-operator">=</span> OrtTensor.createTensor(env, FloatBuffer.wrap(inputData), inputShape);
        Map&lt;String, OrtTensor&gt; inputs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        inputs.put(<span class="hljs-string">"images"</span>, inputTensor);  <span class="hljs-comment">// YOLOv26 ONNXè¾“å…¥åç§°ä¸º"images"</span>
        
        <span class="hljs-comment">// 3. æ‰§è¡Œæ¨ç†</span>
        OrtSession.<span class="hljs-type">Result</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> session.run(inputs);
        
        <span class="hljs-comment">// 4. è§£æè¾“å‡º</span>
        <span class="hljs-type">float</span>[] outputData = ((<span class="hljs-type">float</span>[][]) result.get(<span class="hljs-number">0</span>).getValue())[<span class="hljs-number">0</span>];
        List&lt;DetectionResult&gt; detections = postprocess(outputData, src.width(), src.height());
        
        <span class="hljs-comment">// é‡Šæ”¾èµ„æº</span>
        inputTensor.close();
        result.close();
        
        <span class="hljs-keyword">return</span> detections;
    }

    <span class="hljs-comment">/**
     * åå¤„ç†ï¼šè§£ææ¨ç†ç»“æœï¼Œæ‰§è¡ŒNMSï¼Œè¿˜åŸåæ ‡
     * <span class="hljs-doctag">@param</span> outputData æ¨¡å‹è¾“å‡ºæ•°æ®
     * <span class="hljs-doctag">@param</span> originalW åŸå§‹å›¾åƒå®½åº¦
     * <span class="hljs-doctag">@param</span> originalH åŸå§‹å›¾åƒé«˜åº¦
     * <span class="hljs-doctag">@return</span> è¿‡æ»¤åçš„æ£€æµ‹ç»“æœ
     */</span>
    <span class="hljs-keyword">private</span> List&lt;DetectionResult&gt; <span class="hljs-title function_">postprocess</span><span class="hljs-params">(<span class="hljs-type">float</span>[] outputData, <span class="hljs-type">int</span> originalW, <span class="hljs-type">int</span> originalH)</span> {
        List&lt;DetectionResult&gt; results = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-comment">// YOLOv26è¾“å‡ºæ ¼å¼ï¼š[x, y, w, h, conf, cls1, cls2, ..., cls80]</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">numClasses</span> <span class="hljs-operator">=</span> CLASS_NAMES.size();
        <span class="hljs-type">int</span> <span class="hljs-variable">elementsPerBox</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span> + <span class="hljs-number">1</span> + numClasses;
        <span class="hljs-type">int</span> <span class="hljs-variable">numBoxes</span> <span class="hljs-operator">=</span> outputData.length / elementsPerBox;
        
        <span class="hljs-comment">// 1. è§£ææ‰€æœ‰å€™é€‰æ¡†</span>
        List&lt;Rect2d&gt; boxes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        List&lt;Float&gt; confidences = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        List&lt;Integer&gt; classIds = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; numBoxes; i++) {
            <span class="hljs-type">int</span> <span class="hljs-variable">baseIdx</span> <span class="hljs-operator">=</span> i * elementsPerBox;
            <span class="hljs-type">float</span> <span class="hljs-variable">conf</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">4</span>];
            
            <span class="hljs-comment">// è¿‡æ»¤ä½ç½®ä¿¡åº¦æ¡†</span>
            <span class="hljs-keyword">if</span> (conf &lt; CONF_THRESHOLD) <span class="hljs-keyword">continue</span>;
            
            <span class="hljs-comment">// æ‰¾åˆ°æœ€é«˜ç½®ä¿¡åº¦çš„ç±»åˆ«</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">clsIdx</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-type">float</span> <span class="hljs-variable">maxClsConf</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; numClasses; j++) {
                <span class="hljs-type">float</span> <span class="hljs-variable">clsConf</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">5</span> + j];
                <span class="hljs-keyword">if</span> (clsConf &gt; maxClsConf) {
                    maxClsConf = clsConf;
                    clsIdx = j;
                }
            }
            
            <span class="hljs-comment">// è®¡ç®—å®é™…åæ ‡ï¼ˆè¿˜åŸåˆ°åŸå§‹å›¾åƒå°ºå¯¸ï¼‰</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> outputData[baseIdx];
            <span class="hljs-type">float</span> <span class="hljs-variable">y</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">1</span>];
            <span class="hljs-type">float</span> <span class="hljs-variable">w</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">2</span>];
            <span class="hljs-type">float</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> outputData[baseIdx + <span class="hljs-number">3</span>];
            
            <span class="hljs-comment">// è½¬æ¢ä¸ºå·¦ä¸Šè§’åæ ‡</span>
            <span class="hljs-type">float</span> <span class="hljs-variable">x1</span> <span class="hljs-operator">=</span> (x - w / <span class="hljs-number">2</span>) * (originalW / (<span class="hljs-type">float</span>) INPUT_WIDTH);
            <span class="hljs-type">float</span> <span class="hljs-variable">y1</span> <span class="hljs-operator">=</span> (y - h / <span class="hljs-number">2</span>) * (originalH / (<span class="hljs-type">float</span>) INPUT_HEIGHT);
            <span class="hljs-type">float</span> <span class="hljs-variable">x2</span> <span class="hljs-operator">=</span> (x + w / <span class="hljs-number">2</span>) * (originalW / (<span class="hljs-type">float</span>) INPUT_WIDTH);
            <span class="hljs-type">float</span> <span class="hljs-variable">y2</span> <span class="hljs-operator">=</span> (y + h / <span class="hljs-number">2</span>) * (originalH / (<span class="hljs-type">float</span>) INPUT_HEIGHT);
            
            <span class="hljs-comment">// è¾¹ç•Œæ£€æŸ¥</span>
            x1 = Math.max(<span class="hljs-number">0</span>, x1);
            y1 = Math.max(<span class="hljs-number">0</span>, y1);
            x2 = Math.min(originalW, x2);
            y2 = Math.min(originalH, y2);
            
            boxes.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Rect2d</span>(x1, y1, x2 - x1, y2 - y1));
            confidences.add(conf * maxClsConf);
            classIds.add(clsIdx);
        }
        
        <span class="hljs-comment">// 2. æ‰§è¡Œéæå¤§å€¼æŠ‘åˆ¶ï¼ˆNMSï¼‰</span>
        <span class="hljs-type">MatOfFloat</span> <span class="hljs-variable">confidencesMat</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MatOfFloat</span>(confidences.stream().mapToFloat(f -&gt; f).toArray());
        <span class="hljs-type">MatOfInt</span> <span class="hljs-variable">indices</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MatOfInt</span>();
        Imgproc.dnn.NMSBoxes(boxes, confidencesMat, CONF_THRESHOLD, NMS_THRESHOLD, indices);
        
        <span class="hljs-comment">// 3. æ•´ç†æœ€ç»ˆç»“æœ</span>
        <span class="hljs-type">int</span>[] indicesArr = indices.toArray();
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> idx : indicesArr) {
            results.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DetectionResult</span>(
                    CLASS_NAMES.get(classIds.get(idx)),
                    confidences.get(idx),
                    boxes.get(idx)
            ));
        }
        
        <span class="hljs-keyword">return</span> results;
    }

    <span class="hljs-comment">/**
     * é‡Šæ”¾èµ„æº
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) session.close();
        <span class="hljs-keyword">if</span> (env != <span class="hljs-literal">null</span>) env.close();
    }

    <span class="hljs-comment">/**
     * æ£€æµ‹ç»“æœå®ä½“ç±»
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DetectionResult</span> {
        <span class="hljs-keyword">private</span> String className;  <span class="hljs-comment">// ç±»åˆ«åç§°</span>
        <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> confidence;  <span class="hljs-comment">// ç½®ä¿¡åº¦</span>
        <span class="hljs-keyword">private</span> Rect2d boundingBox; <span class="hljs-comment">// è¾¹ç•Œæ¡†</span>

        <span class="hljs-keyword">public</span> <span class="hljs-title function_">DetectionResult</span><span class="hljs-params">(String className, <span class="hljs-type">float</span> confidence, Rect2d boundingBox)</span> {
            <span class="hljs-built_in">this</span>.className = className;
            <span class="hljs-built_in">this</span>.confidence = confidence;
            <span class="hljs-built_in">this</span>.boundingBox = boundingBox;
        }

        <span class="hljs-comment">// Getteræ–¹æ³•</span>
        <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getClassName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> className; }
        <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getConfidence</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> confidence; }
        <span class="hljs-keyword">public</span> Rect2d <span class="hljs-title function_">getBoundingBox</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> boundingBox; }
    }
}
</code></pre>
<h4 data-id="heading-15">4.2.2 å®æ—¶è§†é¢‘æµæ£€æµ‹ä¸»ç±»ï¼ˆRealTimeDetection.javaï¼‰</h4>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini">package com.edge.ai<span class="hljs-comment">;</span>

import org.opencv.core.*<span class="hljs-comment">;</span>
import org.opencv.imgproc.Imgproc<span class="hljs-comment">;</span>
import org.opencv.videoio.VideoCapture<span class="hljs-comment">;</span>

/**
 * Jetson Nanoå®æ—¶ç›®æ ‡æ£€æµ‹ä¸»ç¨‹åº
 * æ”¯æŒæ‘„åƒå¤´/è§†é¢‘æ–‡ä»¶è¾“å…¥ï¼Œå®æ—¶ç»˜åˆ¶æ£€æµ‹æ¡†
 */
public class RealTimeDetection {
    // åŠ è½½OpenCVæœ¬åœ°åº“ï¼ˆå¿…é¡»åœ¨mainæ–¹æ³•å‰åŠ è½½ï¼‰
    static {
        System.loadLibrary(Core.NATIVE_LIBRARY_NAME)<span class="hljs-comment">;</span>
    }

    public static void main(String<span class="hljs-section">[]</span> args) {
        // 1. é…ç½®å‚æ•°
        String <span class="hljs-attr">modelPath</span> = <span class="hljs-string">"yolov26n_trt.engine"</span><span class="hljs-comment">;  // TensorRTå¼•æ“æ–‡ä»¶è·¯å¾„</span>
        int <span class="hljs-attr">cameraIndex</span> = <span class="hljs-number">0</span><span class="hljs-comment">;  // æ‘„åƒå¤´ç´¢å¼•ï¼ˆJetson Nanoé»˜è®¤USBæ‘„åƒå¤´ä¸º0ï¼‰</span>
        
        // 2. åˆå§‹åŒ–æ£€æµ‹å™¨
        YOLOv26Detector <span class="hljs-attr">detector</span> = null<span class="hljs-comment">;</span>
        try {
            <span class="hljs-attr">detector</span> = new YOLOv26Detector(modelPath)<span class="hljs-comment">;</span>
        } catch (Exception e) {
            System.err.println("æ¨¡å‹åˆå§‹åŒ–å¤±è´¥ï¼š" + e.getMessage())<span class="hljs-comment">;</span>
            System.exit(1)<span class="hljs-comment">;</span>
        }
        
        // 3. æ‰“å¼€æ‘„åƒå¤´
        VideoCapture <span class="hljs-attr">capture</span> = new VideoCapture(cameraIndex)<span class="hljs-comment">;</span>
        if (!capture.isOpened()) {
            System.err.println("æ— æ³•æ‰“å¼€æ‘„åƒå¤´ï¼")<span class="hljs-comment">;</span>
            System.exit(1)<span class="hljs-comment">;</span>
        }
        
        // 4. å®æ—¶æ£€æµ‹å¾ªç¯
        Mat <span class="hljs-attr">frame</span> = new Mat()<span class="hljs-comment">;</span>
        while (true) {
            // è¯»å–å¸§
            if (!capture.read(frame)) {
                System.err.println("è¯»å–è§†é¢‘å¸§å¤±è´¥ï¼")<span class="hljs-comment">;</span>
                break<span class="hljs-comment">;</span>
            }
            
            long <span class="hljs-attr">startTime</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
            
            // æ‰§è¡Œæ£€æµ‹
            List&lt;YOLOv26Detector.DetectionResult&gt; <span class="hljs-attr">results</span> = null<span class="hljs-comment">;</span>
            try {
                <span class="hljs-attr">results</span> = detector.detect(frame)<span class="hljs-comment">;</span>
            } catch (Exception e) {
                System.err.println("æ£€æµ‹å¤±è´¥ï¼š" + e.getMessage())<span class="hljs-comment">;</span>
                continue<span class="hljs-comment">;</span>
            }
            
            // ç»˜åˆ¶æ£€æµ‹ç»“æœ
            for (YOLOv26Detector.DetectionResult result : results) {
                Rect2d <span class="hljs-attr">box</span> = result.getBoundingBox()<span class="hljs-comment">;</span>
                String <span class="hljs-attr">className</span> = result.getClassName()<span class="hljs-comment">;</span>
                float <span class="hljs-attr">confidence</span> = result.getConfidence()<span class="hljs-comment">;</span>
                
                // ç»˜åˆ¶è¾¹ç•Œæ¡†
                Imgproc.rectangle(frame, box, new Scalar(0, 255, 0), 2)<span class="hljs-comment">;</span>
                
                // ç»˜åˆ¶ç±»åˆ«å’Œç½®ä¿¡åº¦
                String <span class="hljs-attr">label</span> = String.format(<span class="hljs-string">"%s: %.2f"</span>, className, confidence)<span class="hljs-comment">;</span>
                Imgproc.putText(frame, label, 
                        new Point(box.x, box.y - 10), 
                        Imgproc.FONT_HERSHEY_SIMPLEX, 
                        0.5, 
                        new Scalar(0, 255, 0), 
                        2)<span class="hljs-comment">;</span>
            }
            
            // è®¡ç®—å¸§ç‡
            long <span class="hljs-attr">endTime</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
            float <span class="hljs-attr">fps</span> = <span class="hljs-number">1000.0</span>f / (endTime - startTime)<span class="hljs-comment">;</span>
            Imgproc.putText(frame, String.format("FPS: %.1f", fps), 
                    new Point(10, 30), 
                    Imgproc.FONT_HERSHEY_SIMPLEX, 
                    0.8, 
                    new Scalar(0, 0, 255), 
                    2)<span class="hljs-comment">;</span>
            
            // æ˜¾ç¤ºç»“æœ
            Imgproc.resize(frame, frame, new Size(800, 600))<span class="hljs-comment">;  // ç¼©å°æ˜¾ç¤ºçª—å£ï¼Œæå‡æµç•…åº¦</span>
            HighGui.imshow("YOLOv26 Real-Time Detection (Jetson Nano)", frame)<span class="hljs-comment">;</span>
            
            // æŒ‰ä¸‹ESCé€€å‡º
            if (HighGui.waitKey(1) == 27) {
                break<span class="hljs-comment">;</span>
            }
        }
        
        // 5. é‡Šæ”¾èµ„æº
        capture.release()<span class="hljs-comment">;</span>
        frame.release()<span class="hljs-comment">;</span>
        HighGui.destroyAllWindows()<span class="hljs-comment">;</span>
        detector.close()<span class="hljs-comment">;</span>
    }
}
</code></pre>
<h3 data-id="heading-16">4.3 ç¼–è¯‘ä¸è¿è¡Œ</h3>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># ç¼–è¯‘Mavené¡¹ç›®</span>
mvn clean package

<span class="hljs-comment"># è¿è¡Œç¨‹åºï¼ˆæŒ‡å®šJNIåº“è·¯å¾„ï¼‰</span>
java -<span class="hljs-title class_">Djava</span>.library.path=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/share/opencv</span>4/java/<span class="hljs-symbol">:/usr/lib/aarch64-linux-gnu/</span> -jar target/jetson-yolov26-<span class="hljs-number">1.0</span>-<span class="hljs-variable constant_">SNAPSHOT</span>.jar
</code></pre>
<h2 data-id="heading-17">äº”ã€æ€§èƒ½ä¼˜åŒ–ï¼ˆJetson Nano å…³é”®è°ƒä¼˜ï¼‰</h2>
<p>Jetson Nano ç®—åŠ›å’Œå†…å­˜æœ‰é™ï¼Œç›´æ¥è¿è¡Œé»˜è®¤ä»£ç å¸§ç‡è¾ƒä½ï¼ˆçº¦ 5-8 FPSï¼‰ï¼Œéœ€é’ˆå¯¹æ€§ä¼˜åŒ–ï¼š</p>
<h3 data-id="heading-18">5.1 ç¡¬ä»¶å±‚é¢ä¼˜åŒ–</h3>
<ol>
<li>
<p><strong>å¼€å¯ Swap åˆ†åŒº</strong>ï¼šJetson Nano é»˜è®¤æ—  Swapï¼Œç¼–è¯‘ / æ¨ç†æ—¶æ˜“å†…å­˜æº¢å‡ºï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash">sudo fallocate -l 4G /swapfile
sudo <span class="hljs-built_in">chmod</span> 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
<span class="hljs-comment"># è®¾ç½®å¼€æœºè‡ªå¯</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">'/swapfile swap swap defaults 0 0'</span> | sudo <span class="hljs-built_in">tee</span> -a /etc/fstab
</code></pre>
</li>
<li>
<p><strong>è°ƒæ•´ CPU é¢‘ç‡</strong>ï¼šè§£é” Jetson Nano CPU é¢‘ç‡ï¼Œæå‡è®¡ç®—æ€§èƒ½ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash">sudo nvpmodel -m 0  <span class="hljs-comment"># æœ€å¤§æ€§èƒ½æ¨¡å¼ï¼ˆ10Wï¼‰</span>
sudo jetson_clocks  <span class="hljs-comment"># è¶…é¢‘CPU/GPU</span>
</code></pre>
</li>
</ol>
<h3 data-id="heading-19">5.2 è½¯ä»¶å±‚é¢ä¼˜åŒ–</h3>
<ol>
<li>
<p><strong>æ¨¡å‹è½»é‡åŒ–</strong>ï¼šä½¿ç”¨ YOLOv26nï¼ˆnano ç‰ˆæœ¬ï¼‰ï¼Œè¾“å…¥å°ºå¯¸ä» 640x640 é™è‡³ 480x480ï¼Œå¸§ç‡å¯æå‡è‡³ 12-15 FPSï¼›</p>
</li>
<li>
<p><strong>INT8 é‡åŒ–</strong>ï¼šå¯¹ TensorRT æ¨¡å‹è¿›è¡Œ INT8 é‡åŒ–ï¼ˆéœ€æ ¡å‡†æ•°æ®é›†ï¼‰ï¼Œæ¨ç†é€Ÿåº¦æå‡ 30%ï¼›</p>
</li>
<li>
<p><strong>JVM è°ƒä¼˜</strong>ï¼šé’ˆå¯¹ Jetson Nano 4GB å†…å­˜ï¼Œè°ƒæ•´ JVM å‚æ•°ï¼š</p>
<p>bash</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini">java -Xms512m -Xmx1024m -XX:+UseG1GC <span class="hljs-attr">-Djava.library.path</span>=xxx -jar xxx.jar
</code></pre>
<ul>
<li><code>-Xms512m</code>ï¼šåˆå§‹å †å†…å­˜ 512MBï¼›</li>
<li><code>-Xmx1024m</code>ï¼šæœ€å¤§å †å†…å­˜ 1GBï¼›</li>
<li><code>-XX:+UseG1GC</code>ï¼šä½¿ç”¨ G1 åƒåœ¾æ”¶é›†å™¨ï¼Œå‡å°‘ GC åœé¡¿ï¼›</li>
</ul>
</li>
<li>
<p><strong>å¤šçº¿ç¨‹è§£è€¦</strong>ï¼šå°†è§†é¢‘å¸§è¯»å–ã€æ¨ç†ã€ç»˜åˆ¶åˆ†ä¸º 3 ä¸ªçº¿ç¨‹ï¼Œé¿å…å•çº¿ç¨‹é˜»å¡ï¼Œæå‡å®æ—¶æ€§ï¼›</p>
</li>
<li>
<p><strong>å›¾åƒé¢„å¤„ç†ä¼˜åŒ–</strong>ï¼šä½¿ç”¨ OpenCV CUDA åŠ é€Ÿæ¥å£ï¼ˆ<code>cv::cuda::resize</code>ï¼‰ï¼Œæ›¿ä»£ CPU é¢„å¤„ç†ï¼Œè€—æ—¶å‡å°‘ 50%ã€‚</p>
</li>
</ol>
<h2 data-id="heading-20">å…­ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2>



































<table><thead><tr><th>é—®é¢˜ç°è±¡</th><th>åŸå› åˆ†æ</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>è¿è¡Œæ—¶æç¤º<code>libopencv_java480.so</code>æ‰¾ä¸åˆ°</td><td>OpenCV Java ç»‘å®šæœªæ­£ç¡®å®‰è£…æˆ–è·¯å¾„æœªé…ç½®</td><td>ç¡®è®¤<code>-Djava.library.path</code>åŒ…å«<code>/usr/local/share/opencv4/java/</code></td></tr><tr><td>æ¨ç†å¸§ç‡æä½ï¼ˆ&lt;5 FPSï¼‰</td><td>é»˜è®¤ä½¿ç”¨ CPU æ¨ç†ï¼Œæœªå¯ç”¨ CUDA</td><td>åˆå§‹åŒ– ONNX Runtime æ—¶æ·»åŠ <code>options.addCUDA(0)</code>ï¼Œç¡®ä¿æ¨¡å‹è½¬æ¢æ—¶å¯ç”¨ GPU</td></tr><tr><td>JVM å´©æºƒï¼ˆOOMï¼‰</td><td>Jetson Nano å†…å­˜ä¸è¶³ï¼ŒJVM å †å†…å­˜è®¾ç½®è¿‡å¤§</td><td>é™ä½<code>-Xmx</code>è‡³ 1GB ä»¥å†…ï¼Œå¼€å¯ Swap åˆ†åŒº</td></tr><tr><td>æ£€æµ‹æ¡†åæ ‡åç§»</td><td>å›¾åƒé¢„å¤„ç†æ—¶æœªä¿æŒæ¯”ä¾‹ï¼Œç›´æ¥æ‹‰ä¼¸å›¾åƒ</td><td>é¢„å¤„ç†æ—¶ä½¿ç”¨ç­‰æ¯”ä¾‹ç¼©æ”¾ + é»‘è¾¹å¡«å……ï¼Œåå¤„ç†æ—¶è¿˜åŸåæ ‡</td></tr><tr><td>TensorRT è½¬æ¢å¤±è´¥</td><td>ONNX æ¨¡å‹ opset ç‰ˆæœ¬ä¸å…¼å®¹</td><td>å¯¼å‡º ONNX æ—¶æŒ‡å®š<code>opset=12</code>ï¼Œä½¿ç”¨ TensorRT 8.5 ç‰ˆæœ¬</td></tr></tbody></table>
<h2 data-id="heading-21">ä¸ƒã€æ€»ç»“ä¸å±•æœ›</h2>
<p>æœ¬æ–‡å®Œæ•´å®ç°äº† Java+YOLOv26 åœ¨ Jetson Nano ä¸Šçš„å®æ—¶ç›®æ ‡æ£€æµ‹ï¼Œä»ç¯å¢ƒæ­å»ºã€æ¨¡å‹è½¬æ¢åˆ°ä»£ç å®ç°ã€æ€§èƒ½ä¼˜åŒ–ï¼Œè§£å†³äº†è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²ä¸­ Java è°ƒç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹çš„æ ¸å¿ƒé—®é¢˜ã€‚æœ€ç»ˆä¼˜åŒ–åï¼ŒYOLOv26n åœ¨ Jetson Nano ä¸Šå¯è¾¾åˆ° 12-15 FPS çš„å®æ—¶æ£€æµ‹å¸§ç‡ï¼Œæ»¡è¶³å¤šæ•°è¾¹ç¼˜ç«¯è½»é‡çº§æ£€æµ‹åœºæ™¯éœ€æ±‚ã€‚</p>
<p>åç»­å¯è¿›ä¸€æ­¥ä¼˜åŒ–æ–¹å‘ï¼š</p>
<ol>
<li>åŸºäº JNI è°ƒç”¨ C++ TensorRT APIï¼Œæ›¿ä»£ ONNX Runtimeï¼Œè¿›ä¸€æ­¥æå‡æ¨ç†é€Ÿåº¦ï¼›</li>
<li>é›†æˆ MQTT/HTTPï¼Œå®ç°æ£€æµ‹ç»“æœçš„è¾¹ç¼˜ç«¯ä¸ŠæŠ¥ï¼›</li>
<li>æ¨¡å‹å¢é‡æ›´æ–°ï¼šåŸºäº Jetson Nano å®ç°è¾¹ç¼˜ç«¯æ¨¡å‹å¾®è°ƒï¼Œé€‚é…ç‰¹å®šåœºæ™¯ï¼›</li>
<li>å¤šè®¾å¤‡ååŒï¼šå°† Jetson Nano çš„æ£€æµ‹ç»“æœåŒæ­¥è‡³äº‘ç«¯ï¼Œå®ç°è¾¹ç¼˜ - äº‘ç«¯ååŒæ¨ç†ã€‚</li>
</ol>
<p>è¾¹ç¼˜è®¡ç®—çš„æ ¸å¿ƒæ˜¯ â€œç®—åŠ›ä¸‹æ²‰â€ï¼ŒJava ä½œä¸ºä¼ä¸šçº§å¼€å‘è¯­è¨€ï¼Œç»“åˆ YOLOv26 çš„è½»é‡åŒ–ä¼˜åŠ¿ï¼Œå¯è®©è¾¹ç¼˜ AI åº”ç”¨æ›´è´´è¿‘å®é™…ä¸šåŠ¡åœºæ™¯ã€‚å¸Œæœ›æœ¬æ–‡èƒ½ä¸ºä»äº‹è¾¹ç¼˜ AI å¼€å‘çš„ Java å¼€å‘è€…æä¾›å‚è€ƒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆè¯´Walæ¨¡å¼å¯ä»¥æé«˜sqliteçš„å¹¶å‘èƒ½åŠ›]]></title>    <link>https://juejin.cn/post/7601041482892525618</link>    <guid>https://juejin.cn/post/7601041482892525618</guid>    <pubDate>2026-01-31T11:28:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601041482892525618" data-draft-id="7601041482892509234" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆè¯´Walæ¨¡å¼å¯ä»¥æé«˜sqliteçš„å¹¶å‘èƒ½åŠ›"/> <meta itemprop="keywords" content="Python,SQLite,åç«¯"/> <meta itemprop="datePublished" content="2026-01-31T11:28:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å”å”åœ¨å­¦ä¹ "/> <meta itemprop="url" content="https://juejin.cn/user/4009253326568761"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆè¯´Walæ¨¡å¼å¯ä»¥æé«˜sqliteçš„å¹¶å‘èƒ½åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4009253326568761/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å”å”åœ¨å­¦ä¹ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T11:28:46.000Z" title="Sat Jan 31 2026 11:28:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬ç¯‡æ–‡ç« æ˜¯å‰é˜µå­å¼€å‘ã€ŒTodoListã€åº”ç”¨é‡åˆ°çš„ <code>sqlite</code> æŠ¥é”™é—®é¢˜ï¼Œæœ€è¿‘è…¾å‡ºæ—¶é—´äº†ï¼Œä¸“é—¨ç ”ç©¶äº†ä¸‹å½“æ—¶ç½‘å‹æ‰€è¯´çš„ <code>Wal</code> æ¨¡å¼ï¼Œä»¥æ­¤ä½œçš„ç¬”è®°ã€‚</p>
</blockquote>
<h2 data-id="heading-0">åœºæ™¯æ¼”ç¤º</h2>
<p>åœ¨å›ç­”è¿™ä¸ªé—®é¢˜å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€æ®µä»£ç ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> sqlite3  
<span class="hljs-keyword">import</span> os  
  
DB = <span class="hljs-string">"test.db"</span>  
  
<span class="hljs-keyword">def</span> <span class="hljs-title function_">setup_db</span>():  
    <span class="hljs-keyword">if</span> os.path.exists(DB):  
        os.remove(DB)  
    conn = sqlite3.connect(DB)  
    <span class="hljs-comment"># conn.execute("PRAGMA journal_mode=WAL;") # æ˜¾å¼å¼€å¯ WAL    </span>
    conn.execute(<span class="hljs-string">"CREATE TABLE data (id INTEGER);"</span>)  
    conn.executemany(<span class="hljs-string">"INSERT INTO data VALUES (?)"</span>, [(i,) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)])  
    conn.commit()  
    conn.close()  
  
<span class="hljs-keyword">def</span> <span class="hljs-title function_">long_writer</span>():  
    conn = sqlite3.connect(DB, timeout=<span class="hljs-number">10</span>)  
    cur = conn.cursor()  
    conn.execute(<span class="hljs-string">"BEGIN EXCLUSIVE"</span>)  <span class="hljs-comment"># æ˜¾å¼å¼€å¯ç‹¬å äº‹åŠ¡ï¼Œç¡®ä¿æŒæœ‰å†™é”  </span>
    cur.execute(<span class="hljs-string">"INSERT INTO data VALUES (?)"</span>, (<span class="hljs-number">999</span>,))  
    reader()  
    conn.commit()  
    conn.close()  
  
<span class="hljs-keyword">def</span> <span class="hljs-title function_">reader</span>():  
    conn = sqlite3.connect(DB, timeout=<span class="hljs-number">10</span>)  
    cur = conn.cursor()  
    cur.execute(<span class="hljs-string">"SELECT COUNT(*) FROM data"</span>)  
    conn.close()  
  
<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span> * <span class="hljs-number">50</span>)  
setup_db()  
long_writer()  
  
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nâœ… æµ‹è¯•å®Œæˆ"</span>)
</code></pre>
<p>è¿™æ®µä»£ç çš„æ“ä½œå†…å®¹å¾ˆç®€å•ï¼Œå°±æ˜¯ï¼š</p>
<ul>
<li>å»ºç«‹ä¸€ä¸ª <code>sqlite</code> æ•°æ®åº“</li>
<li>è¿æ¥ä¸€ä¸ªè¿æ¥ï¼Œå†™å…¥ä¸€æ¡æ•°æ®</li>
<li>åœ¨å†™æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œå»ºç«‹ä¸€ä¸ªæ–°çš„è¿æ¥è¯»å–æ•°æ®</li>
</ul>
<p>å¯èƒ½ä½ ä¼šè§‰å¾—æ­£å¸¸ä¸ä¼šæœ‰äººè¿™ä¹ˆç©çš„ï¼Œè°ä¼šåœ¨ä¸€ä¸ªæ•°æ®åº“è¿æ¥ä¸­è¿˜å»ºç«‹ç¬¬äºŒä¸ªè¿æ¥å‘¢ï¼Ÿ
ä¸ªäººç†è§£ï¼Œæ­£å¸¸å¼€å‘ç¡®å®ä¸ä¼šè¿™æ ·ç©ï¼›ä½†æ˜¯åœ¨é«˜åº¦æ¨¡å—åŒ–å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œåˆ™å®Œå…¨æœ‰å¯èƒ½ã€‚ç”šè‡³äºè¯»æ“ä½œå¯èƒ½æ˜¯å¼€å‘è€…Aå¼€å‘ï¼Œå†™æ“ä½œå¯èƒ½æ˜¯å¼€å‘è€…Bå¼€å‘ï¼Œå› è€Œå­˜åœ¨ä¸Šè¿°åœºæ™¯ã€‚</p>
<p>è€Œä¸Šè¿°è°ƒç”¨ï¼Œä½¿ç”¨ <code>sqlite</code> æ•°æ®åº“ï¼Œä½ ä¼šçœ‹åˆ°ä¸‹è¿°æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">==================================================
Traceback (most recent call last):
  File <span class="hljs-string">"D:\CodeProject\other\PythonProject\sqlite\02_writer_demo.py"</span>, line 33, <span class="hljs-keyword">in</span> &lt;module&gt;
    long_writer()
  File <span class="hljs-string">"D:\CodeProject\other\PythonProject\sqlite\02_writer_demo.py"</span>, line 21, <span class="hljs-keyword">in</span> long_writer
    reader()
  File <span class="hljs-string">"D:\CodeProject\other\PythonProject\sqlite\02_writer_demo.py"</span>, line 28, <span class="hljs-keyword">in</span> reader
    cur.execute(<span class="hljs-string">"SELECT COUNT(*) FROM data"</span>)
sqlite3.OperationalError: database is locked
</code></pre>
<h2 data-id="heading-1">é—®é¢˜åˆ†æ</h2>
<p>ç”¨è¿‡ç±»ä¼¼ <code>MySQL</code>ã€<code>PostgreSQL</code> ä¹‹ç±»çš„æ•°æ®åº“çš„åŒå­¦å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼šä¸ºå•¥ä¼šæŠ¥é”™å‘¢ï¼Ÿ</p>
<p>ç©¶å…¶åŸå› ï¼š<strong><code>sqlite</code> ä½¿ç”¨çš„æ˜¯ç²—ç²’åº¦çš„æ–‡ä»¶é”ï¼Œè€Œä¸æ˜¯ <code>MySQL</code> ä¹‹ç±»çš„è¡Œé”/è¡¨é”ï¼Œè€Œæ­£å¸¸æ¨¡å¼ä¸‹ä¸æ”¯æŒå¹¶å‘æ“ä½œçš„ï¼Œå­˜åœ¨å¹¶å‘æ“ä½œæ—¶ï¼Œä¼šæŠ¥é”™<code>database is locked</code></strong></p>
<p>åƒä¸Šè¿°ä»£ç ä¸­ï¼Œä¸€ä¸ªå†™è¿æ¥å·²ç»å ç”¨ä¸€ä¸ªçº¿ç¨‹äº†ï¼Œå¦‚æœå†å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼Œé‚£ä¹ˆç›¸å½“äºå»ºç«‹ä¸¤ä¸ªè¿æ¥ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘æ“ä½œï¼Œè‡ªç„¶å°±é”è¡¨äº†ã€‚</p>
<h2 data-id="heading-2">è§£å†³æ–¹å¼</h2>
<p>æ—¢ç„¶ä¸æ”¯æŒå¤šè¿æ¥ï¼Œé‚£å°±åˆå¹¶æ–¹æ³•å‘—ï¼ŒæŠŠä»£ç ä¸­çš„ <code>reader()</code> æ–¹æ³•å†…å®¹ç›´æ¥æ‹·è´åˆ° <code>long_writer()</code>ã€‚</p>
<p>ç¡®å®å¦‚æ­¤ï¼Œä¸Šè¿°æ–¹å¼ä¸å¤±ä¸ºä¸€ç§æ–¹æ³•ã€‚å½“ç„¶è¿˜æœ‰å¦ä¸€ç§æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä»Šå¤©è¦ä»‹ç»çš„ <code>Wal</code> æ¨¡å¼ã€‚</p>
<p>å…·ä½“æ“ä½œå‘¢ï¼Œå°±æ˜¯å°†ä¸Šè¿°ä»£ç ä¸­æ³¨é‡Šçš„é‚£ä¸€è¡Œå–æ¶ˆæ³¨é‡Šå³å¯ã€‚</p>
<pre><code class="hljs language-python" lang="python">conn.execute(<span class="hljs-string">"PRAGMA journal_mode=WAL;"</span>) <span class="hljs-comment"># æ˜¾å¼å¼€å¯ WAL  </span>
</code></pre>
<p>å°±è¿™ä¹ˆç®€å•ï¼Œç„¶åè¿è¡Œä¸æŠ¥é”™ï¼Œä¹Ÿå†™å…¥æˆåŠŸã€‚</p>
<h2 data-id="heading-3">Wal æ¨¡å¼</h2>
<p>çœ‹åˆ°è¿™é‡Œï¼Œä½ è‚¯å®šä¼šæœ‰ç–‘é—®ï¼šå‰é¢ä¸æ˜¯è¯´ <code>sqlite</code> åªæ”¯æŒæ–‡ä»¶é”å˜›ï¼Œè€Œ <code>sqlite</code> çš„æ•°æ®åº“æ–‡ä»¶å°±ä¸€ä¸ªï¼Œæ˜¯æ€ä¹ˆåšåˆ°å•ä¸ªè¿æ¥æ“ä½œè¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå¦å¤–è¿˜èƒ½å»ºç«‹è¿æ¥å¹¶å‘æ“ä½œè¿™ä¸ªæ–‡ä»¶è€Œä¸æŠ¥é”™åŠ é”é—®é¢˜å‘¢ï¼Ÿ</p>
<p>å¼€å¯ <code>Wal</code> æ¨¡å¼ï¼Œç®€å•ç†è§£ï¼šå…¶å®ç›¸å½“äºè¯»é”å’Œå†™é”åˆ†ç¦»ï¼Œå†™å…¥è¿‡ç¨‹ä¸­åŠ é”ï¼Œæ˜¯ä¸ä¼šå½±å“è¯»å–çš„ã€‚å…·ä½“å®ç°ä¸Šï¼š</p>
<ul>
<li>å†™æ“ä½œä¸å†ç›´æ¥ä¿®æ”¹ä¸»æ•°æ®åº“æ–‡ä»¶ï¼Œè€Œæ˜¯å†™å…¥ç‹¬ç«‹çš„ WAL æ—¥å¿—æ–‡ä»¶ï¼Œä»…éœ€è·å–<strong>è½»é‡çº§çš„å†™é”</strong>ï¼ˆä¸é˜»å¡è¯»ï¼‰ï¼›</li>
<li>è¯»æ“ä½œä»<strong>ä¸»æ•°æ®åº“æ–‡ä»¶</strong>è¯»å–æ•°æ®ï¼ˆè€Œé WAL æ—¥å¿—ï¼‰ï¼Œä»…éœ€è·å–å…±äº«é”ï¼Œä¸å†™æ“ä½œçš„è½»é‡çº§é”<strong>äº’ä¸æ’æ–¥</strong>ï¼Œå®Œå…¨æ— é˜»å¡ï¼Œå®ç°<strong>çœŸæ­£çš„è¯»å†™å¹¶è¡Œ</strong>ã€‚</li>
</ul>
<p>æ‡‚äº†å§ï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦å¼€å¯ <code>Wal</code> æ¨¡å¼ï¼Œå¯¹äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œå†ä¹Ÿä¸ä¼šå› ä¸ºå°‘é‡å†™æ“ä½œå¯¼è‡´å•æ¬¡è¯·æ±‚ï¼Œè¯»æ“ä½œè¢«é˜»å¡ï¼Œå“åº”è¿‡æ…¢äº†ã€‚</p>
<h2 data-id="heading-4">å»¶ç”³æ€è€ƒ</h2>
<p>ğŸ’¡<code>Wal</code> æ¨¡å¼æ˜¯ä¸æ˜¯å®Œå…¨è§£å†³äº† <code>sqlite</code> çš„å¹¶å‘é—®é¢˜å‘¢ï¼Ÿ</p>
<p>å¹¶å‘æ“ä½œæ— å¤–ä¹è¯»è¯»æ“ä½œã€è¯»å†™æ“ä½œã€å†™å†™æ“ä½œï¼Œä½ å¯ä»¥åœ¨ä¸Šè¿°ä»£ç ä¸­æ¨¡ä»¿å†™æ–¹æ³•é‡Œé¢å†åµŒå¥—å†™æ–¹æ³•ã€è¯»æ–¹æ³•åµŒå¥—è¯»æ–¹æ³•å®è·µè¯•è¯•~ è¿™é‡Œå°±ä¸è§£ç­”äº†ï¼Œç»™ä½ ç•™ä¸ªå®è·µçš„æœºä¼šå‘¢ï¼</p>
<p>ğŸ’¡ä¸Šè¿°ä»£ç ä¸­ï¼Œä¸ºå•¥è¦åŠ  <code>conn.execute("BEGIN EXCLUSIVE")</code> å‘¢ï¼Ÿ</p>
<p>å®é™…ä¸Šï¼Œä¸åŠ çš„è¯ï¼Œä½ ä¼šå‘ç°ï¼šé <code>Wal</code> æ¨¡å¼ä¹Ÿä¸ä¼šæŠ¥é”™äº†ã€‚è¿™æ˜¯å› ä¸º <code>sqlite</code> é»˜è®¤è‡ªåŠ¨æäº¤ä¼šç«‹å³é‡Šæ”¾é”ï¼Œä¹Ÿå°±æ˜¯å†™æ“ä½œå®Œæˆè‡ªåŠ¨æäº¤çš„ç¬é—´ä¼šé‡Šæ”¾é”ï¼Œä»è€Œä¸ä¼šé˜»å¡è¯»ã€‚ä½†æ˜¯é˜»å¡æœ¬èº«åœ¨é <code>Wal</code> æ¨¡å¼æ˜¯å­˜åœ¨çš„ï¼Œåªæœ‰åœ¨è€—æ—¶å†™æ“ä½œæˆ–é«˜é¢‘è¯»æ“ä½œæ—¶ï¼Œè¿™ç§é˜»å¡æ‰ä¼šå¾ˆæ˜æ˜¾ã€‚<code>BEGIN EXCLUSIVE</code> ä¼šæ˜¾å¼å¼€å¯ç‹¬å äº‹åŠ¡ï¼Œä»¥ä¾¿æ¨¡æ‹Ÿè¿™ç§æ„ŸçŸ¥ã€‚</p>
<hr/>
<p>å¥½å•¦ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™é‡Œäº†ï¼Œæ„Ÿè°¢é˜…è¯»ï¼Œæˆ‘æ˜¯å”å”ï¼Œæ¬¢è¿ä¸‰è¿å“¦~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenClawï¼ˆåŸ Clawdbotï¼‰é’‰é’‰å¯¹æ¥ä¿å§†çº§æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ•™ä½ æ‰“é€ è‡ªå·±çš„ AI åŠ©æ‰‹]]></title>    <link>https://juejin.cn/post/7601069677567393838</link>    <guid>https://juejin.cn/post/7601069677567393838</guid>    <pubDate>2026-02-01T02:34:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601069677567393838" data-draft-id="7601101531919908910" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenClawï¼ˆåŸ Clawdbotï¼‰é’‰é’‰å¯¹æ¥ä¿å§†çº§æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ•™ä½ æ‰“é€ è‡ªå·±çš„ AI åŠ©æ‰‹"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-02-01T02:34:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenClawï¼ˆåŸ Clawdbotï¼‰é’‰é’‰å¯¹æ¥ä¿å§†çº§æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ•™ä½ æ‰“é€ è‡ªå·±çš„ AI åŠ©æ‰‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T02:34:27.000Z" title="Sun Feb 01 2026 02:34:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">OpenClawï¼ˆåŸ Clawdbotï¼‰é’‰é’‰å¯¹æ¥ä¿å§†çº§æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ•™ä½ æ‰“é€ è‡ªå·±çš„ AI åŠ©æ‰‹</h2>
<p>OpenClaw æ˜¯ä¸€æ¬¾å¼€æºçš„æœ¬åœ° AI åŠ©æ‰‹ï¼Œæ”¯æŒåœ¨ä½ è‡ªå·±çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²ï¼Œé€šè¿‡é’‰é’‰ã€é£ä¹¦ã€WhatsAppã€Telegram ç­‰èŠå¤©å·¥å…·äº¤äº’ã€‚ä¸äº‘ç«¯ SaaS æœåŠ¡ä¸åŒï¼ŒOpenClaw è®©ä½ å®Œå…¨æŒæ§æ•°æ®éšç§ï¼Œå¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€æµè§ˆç½‘é¡µã€ç®¡ç†æ–‡ä»¶ï¼Œç”šè‡³ç¼–å†™ä»£ç ã€‚æœ¬æ•™ç¨‹å°†æ‰‹æŠŠæ‰‹æ•™ä½ åœ¨ Linux ç³»ç»Ÿä¸‹å®‰è£… OpenClaw å¹¶å¯¹æ¥é’‰é’‰æœºå™¨äººï¼Œæ‰“é€ ä¸“å±çš„æ™ºèƒ½åŠ©ç†ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šæœ¬æ•™ç¨‹åœ¨ Linux ç³»ç»Ÿä¸‹è¿›è¡Œ</p>
</blockquote>
<p>å¦‚æœä½ ä½¿ç”¨é£ä¹¦, å¯ä»¥æ ¹æ®è¿™ç¯‡æ•™ç¨‹æ¥ <a href="https://juejin.cn/post/7600238071038197769" target="_blank" title="https://juejin.cn/post/7600238071038197769">Clawdbot å®Œæ•´å¯¹æ¥é£ä¹¦æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ­å»ºä½ çš„ä¸“å± AI åŠ©æ‰‹</a></p>
<h3 data-id="heading-1">OpenClaw æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>OpenClaw(åŸå Clawdbot,åæ›´åä¸º Moltbot,ç°æ­£å¼å‘½åä¸º OpenClaw)æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ä½ æœ¬åœ°ç¯å¢ƒçš„é«˜æƒé™ AI æ™ºèƒ½ä½“ã€‚å®ƒçš„æ ¸å¿ƒç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>æœ¬åœ°éƒ¨ç½²</strong>ï¼šè¿è¡Œåœ¨ä½ çš„æœåŠ¡å™¨æˆ–ç”µè„‘ä¸Š,æ•°æ®å®Œå…¨è‡ªä¸»å¯æ§</li>
<li><strong>å¤šå¹³å°æ”¯æŒ</strong>ï¼šæ”¯æŒé’‰é’‰ã€é£ä¹¦ã€WhatsAppã€Telegramã€Discordã€Slack ç­‰ä¸»æµèŠå¤©å·¥å…·</li>
<li><strong>æµè§ˆå™¨æ§åˆ¶</strong>ï¼šå¯ä»¥æµè§ˆç½‘é¡µã€å¡«å†™è¡¨å•ã€æå–æ•°æ®</li>
<li><strong>ç³»ç»Ÿè®¿é—®</strong>ï¼šè¯»å†™æ–‡ä»¶ã€æ‰§è¡Œ Shell å‘½ä»¤ã€è¿è¡Œè„šæœ¬</li>
<li><strong>æŒä¹…åŒ–è®°å¿†</strong>ï¼šè®°ä½ä½ çš„åå¥½å’Œä¸Šä¸‹æ–‡,æˆä¸ºçœŸæ­£å±äºä½ çš„ AI</li>
<li><strong>æ’ä»¶æ‰©å±•</strong>ï¼šæ”¯æŒç¤¾åŒºæŠ€èƒ½æ’ä»¶,ç”šè‡³å¯ä»¥è‡ªå·±ç¼–å†™æ’ä»¶</li>
</ul>
<p>æ— è®ºæ˜¯é‚®ä»¶ç®¡ç†ã€æ—¥ç¨‹å®‰æ’ã€æ•°æ®æŸ¥è¯¢è¿˜æ˜¯ä»£ç ç¼–å†™,OpenClaw éƒ½èƒ½æˆä¸ºä½ çš„å¾—åŠ›åŠ©æ‰‹ã€‚</p>
<h3 data-id="heading-2">å‡†å¤‡å·¥ä½œ</h3>
<p>é¦–å…ˆå‡†å¤‡ä¸€å°é—²ç½®çš„äº‘æœåŠ¡å™¨æˆ– VPSï¼ˆæ¨èä½¿ç”¨é¦™æ¸¯æˆ–æµ·å¤–èŠ‚ç‚¹ï¼‰ã€‚ç”±äº OpenClaw è¿è¡Œæ—¶æƒé™è¾ƒå¤§ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¸å»ºè®®åœ¨æœ¬åœ°æˆ–å·¥ä½œæœºä¸Šå®‰è£…ï¼Œæ¨èåœ¨ä¸€å°ç‹¬ç«‹çš„ç©ºæœåŠ¡å™¨ä¸Šéƒ¨ç½²ã€‚å‡†å¤‡å®Œæˆåï¼Œç™»å½•åˆ°æœåŠ¡å™¨ã€‚</p>
<h3 data-id="heading-3">å®‰è£…</h3>
<blockquote>
<p>å¦‚æœä½ ä¸æƒ³å®‰è£…ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é˜¿é‡Œäº‘çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.aliyun.com%2Factivity%2Fecs%2Fclawdbot%3FuserCode%3Doq2t54oi" target="_blank" title="https://www.aliyun.com/activity/ecs/clawdbot?userCode=oq2t54oi" ref="nofollow noopener noreferrer">Openclaw ä¸€é”®éƒ¨ç½² (åŸ Clawdbot)</a>ï¼Œéƒ¨ç½²ä¹‹åå¯ä»¥ç›´æ¥è·³åˆ°<a href="#%E5%AF%B9%E6%8E%A5%E9%92%89%E9%92%89" title="#%E5%AF%B9%E6%8E%A5%E9%92%89%E9%92%89">å¯¹æ¥é’‰é’‰</a>ã€‚</p>
</blockquote>
<p>ç¬¬ä¸€æ­¥å®‰è£… Git</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å®‰è£… Git</span>
sudo apt update
sudo apt install git -y
</code></pre>
<p>ç¬¬äºŒæ­¥å®‰è£… Node.js</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å®‰è£… NVM</span>
<span class="hljs-meta prompt_"># </span><span class="bash">å›½å†…ä½¿ç”¨ gitee çš„é•œåƒæº</span>
curl -o- https://gitee.com/RubyMetric/nvm-cn/raw/main/install.sh | bash
<span class="hljs-meta prompt_">
# </span><span class="bash">å›½å¤–ä½¿ç”¨</span>
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash
<span class="hljs-meta prompt_">
# </span><span class="bash">é‡æ–°åŠ è½½ç¯å¢ƒå˜é‡</span>
source ~/.bashrc
<span class="hljs-meta prompt_">
# </span><span class="bash">å®‰è£… Node.js 22</span>
nvm install 22
<span class="hljs-meta prompt_">
# </span><span class="bash">æŸ¥çœ‹ nodejs ç‰ˆæœ¬</span>
node -v # è¾“å‡º v22 å³å¯ï¼Œç‰ˆæœ¬åªè¦ 22 å°±è¡Œ
</code></pre>
<h3 data-id="heading-4">å®‰è£… Openclaw</h3>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">ä½¿ç”¨å®˜æ–¹è„šæœ¬å®‰è£…</span>
curl -fsSL https://openclaw.bot/install.sh | bash
</code></pre>
<blockquote>
<p>æœåŠ¡å™¨åœ¨å›½å†…ï¼Œå¦‚æœå®‰è£…å¤±è´¥çš„è¯ï¼Œå¯èƒ½éœ€è¦è§£å†³ç½‘ç»œé—®é¢˜</p>
</blockquote>
<p>å…¶ä»–å¹³å°å®‰è£…æ–¹å¼è¯·å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openclaw.bot%2Finstall%2Finstaller" target="_blank" title="https://docs.openclaw.bot/install/installer" ref="nofollow noopener noreferrer">Openclaw å®‰è£…æ–‡æ¡£ (åŸ Clawdbot)</a></p>
<p>ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾è¾“å‡º
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f43b63a9ad404a45aff63f191f87e8d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=jAbAabf6gD4gXxY7sTZVymETfDw%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - å®‰è£…è¿‡ç¨‹åˆå§‹åŒ–ç•Œé¢" loading="lazy"/>
å¦‚æœé¦–æ¬¡å®‰è£…ï¼Œæ—¶é—´ä¼šå¾ˆé•¿ï¼Œéœ€è¦è€å¿ƒç­‰å¾…ã€‚
å¦‚æœæœ€åè¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">â†’ npm install failed; cleaning up and retrying...
</code></pre>
<p>æ–°çš„è„šæœ¬æœåŠ¡å™¨å†…å­˜è¦æ±‚å˜é«˜äº†ï¼Œæ®æˆ‘ä½¿ç”¨ä¸‹æ¥ 2G å†…å­˜ï¼Œè‚¯å®šä¼š OOMï¼Œå¦‚æœå‡ºé”™çš„è¯ï¼Œå»ºè®®ä½¿ç”¨ <code>swap</code> æŠŠç¡¬ç›˜ç©ºé—´å½“ä½œäº¤äº’å†…å­˜ä½¿ç”¨ã€‚</p>
<p>æˆåŠŸä¹‹åä¼šè¾“å‡ºå¦‚ä¸‹å›¾ç‰‡
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/08227a86dcea4938b4b3abb98d62544f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=ywsKlzE3VJBgxwL%2BMQNcuDqzGAc%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - å®‰è£…æˆåŠŸé…ç½®å‘å¯¼ç•Œé¢" loading="lazy"/>
ç¬¬ä¸€ä¸ªé€‰é¡¹é€‰æ‹© <code>yes</code>, å°±æ˜¯è¯¢é—®ä½ æ˜¯å¦çŸ¥é“é£é™©çš„ã€‚
ç¬¬äºŒæ­¥é€‰æ‹© <code>QuickStart</code>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed64bd3dd6cf4ed0aaa8cf178f6af9ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=cevm0%2BnVxiSqwPnE4ZLH9re1eRs%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - QuickStart å¿«é€Ÿå¼€å§‹é€‰é¡¹" loading="lazy"/>
ç¬¬ä¸‰æ­¥é€‰æ‹©æ¨¡å‹æœåŠ¡å•†ï¼Œè¿™é‡Œé€‰æ‹© <code>Qwen</code>ï¼Œå…è´¹é¢åº¦å……è¶³ï¼Œé€‚åˆå…¥é—¨ä½¿ç”¨
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7449c68bee149c0a00c66628905fe5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=AWMBximZLqyQrHVkIL047WIyiNo%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - é€‰æ‹©é€šä¹‰åƒé—® Qwen æ¨¡å‹" loading="lazy"/>
é€‰æ‹©åƒé—®æ¨¡å‹åï¼Œä¼šæä¾›ä¸€ä¸ªé“¾æ¥ï¼Œå¤åˆ¶å¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼Œå¦‚ä¸‹å›¾
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/159f2f4165164c138deafc352691ce62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=mtfvBoTw0OgDxgFGK04mcCK67IY%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - åƒé—®æ¨¡å‹æˆæƒé“¾æ¥" loading="lazy"/>
æ‰“å¼€æµè§ˆå™¨åï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹ç•Œé¢ã€‚ç”±äºæˆ‘å·²ç™»å½•è¿‡ï¼Œæ‰€ä»¥æ˜¾ç¤ºè´¦æˆ·ä¿¡æ¯ï¼›å¦‚æœå°šæœªç™»å½•ï¼ŒæŒ‰ç…§æç¤ºå®Œæˆç™»å½•å³å¯ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/901fef3665b3490eb4d12425bf6a96dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=Fv1yngNSEGcioFnaRaeckIKPbNo%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - åƒé—®è´¦æˆ·ç™»å½•é¡µé¢" loading="lazy"/>
ç™»å½•å®Œæˆåï¼Œä¼šå‡ºç°ä»¥ä¸‹é€‰é¡¹ï¼Œæç¤ºé€‰æ‹©å¯¹åº”çš„åƒé—®æ¨¡å‹ï¼Œå¦‚ä¸‹å›¾
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/931f4477a66946eda71f65a3592b8f4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=RA68n8MBruNjdJGkgym2Ajld0p0%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - é€‰æ‹©åƒé—®æ¨¡å‹ç‰ˆæœ¬" loading="lazy"/></p>
<p>é€‰æ‹©é»˜è®¤æ¨¡å‹å³å¯ã€‚æ¥ä¸‹æ¥ä¼šæç¤ºé€‰æ‹© channelï¼Œè¿™é‡Œå…ˆè·³è¿‡ï¼Œåç»­å†æ·»åŠ </p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2449ed228dca4187bfe9c8868789199e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=9cTZwjzwzf%2FwjtVvgtgZz9%2FJEls%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - channel æ¸ é“é…ç½®é€‰é¡¹" loading="lazy"/>
ç»§ç»­ä¸‹é¢é€‰æ‹© skillsï¼Œä¹Ÿæ˜¯é€‰æ‹© <code>No</code>ï¼Œå¦‚ä¸‹å›¾
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c70b01e0c93c418e809056695ca20995~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=e%2FTOVH4ZISAbHcyLqoPxzHMu4Nc%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - skills æŠ€èƒ½é…ç½®é€‰é¡¹" loading="lazy"/>
ç»§ç»­ä¸‹é¢é€‰æ‹© hooksï¼Œä¹Ÿæ˜¯ä½¿ç”¨<code>ç©ºæ ¼</code>é€‰æ‹© <code>No</code>ï¼Œå¦‚ä¸‹å›¾
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/afbae0d498d24cf9841da0a94e2b74d1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=b1sG7XkdNwTxZPdgdJe%2Fdzx2rQo%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - hooks é…ç½®é€‰é¡¹" loading="lazy"/>
ç„¶åç­‰å¾…å®‰è£…å®Œæˆï¼Œæœ€åä¼šå‡ºç°ä»¥ä¸‹é€‰é¡¹ï¼Œè¿™é‡Œé€‰æ‹© <code>TUI</code>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6d6f1d8ec0a4f97b8d0272e5b24269c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=4%2Bi76RXkCxWDptgUOdDs3akn6aQ%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - é€‰æ‹© TUI ç»ˆç«¯ç•Œé¢" loading="lazy"/>
å¦‚æœçœ‹åˆ° TUI èŠå¤©ç•Œé¢ï¼Œè¯´æ˜å®‰è£…æˆåŠŸï¼Œå¯ä»¥å°è¯•è¾“å…¥ <code>Hello</code> è¿›è¡Œæµ‹è¯•ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ace006f47f1549b785ace1c0d805641d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=jgQFumvunqcWN9AepNWEriA8Vpw%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - TUI èŠå¤©ç•Œé¢æµ‹è¯•" loading="lazy"/>
ç„¶åç›´æ¥ä½¿ç”¨ <code>ctrl+c</code> å…ˆå…³é—­ï¼Œåé¢æˆ‘ä»¬å†æ¥è®¾ç½®</p>
<h4 data-id="heading-5">æŸ¥çœ‹æœåŠ¡</h4>
<p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥æŸ¥çœ‹</p>
<pre><code class="hljs language-shell" lang="shell">openclaw status
</code></pre>
<p>ä¼šçœ‹åˆ°å¦‚ä¸‹å›¾çš„ç»“æœå°±è¯´æ˜æœåŠ¡å¯åŠ¨äº†
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db15dbd93bf84ed5b8072aacd6021fbe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=rKakewg5ZTbA78WnKd4AxhgktGM%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - æœåŠ¡çŠ¶æ€æ£€æŸ¥è¿è¡Œä¸­" loading="lazy"/></p>
<h4 data-id="heading-6">è®¿é—® Web UI é¢æ¿</h4>
<p>å¦‚ä½•è®¿é—®é¢æ¿ï¼ŸæœåŠ¡ç›‘å¬åœ¨ <code>http://127.0.0.1:18789/</code> ç«¯å£ä¸Šï¼Œæˆ‘ä»¬ç°åœ¨é€šè¿‡ ssh éš§é“æ¥è®¿é—®ï¼Œè¾“å…¥ä¸‹é¢çš„å‘½ä»¤</p>
<pre><code class="hljs language-shell" lang="shell">ssh -N -L 18789:127.0.0.1:18789 ç”¨æˆ·å@æœåŠ¡å™¨IP
<span class="hljs-meta prompt_"># </span><span class="bash">å›è½¦ä¹‹å</span>
ç”¨æˆ·å@æœåŠ¡å™¨IP's password: # è¾“å…¥å¯†ç 
</code></pre>
<p>ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€ <code>http://127.0.0.1:18789/</code>, ä½ ä¼šçœ‹åˆ° Dashboard äº†ï¼Œå¦‚ä¸‹å›¾
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4f8ca21daff46f3a33d4da0ce0a5e19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=%2FH%2Bsxb%2BmAuvCyHK4mO%2F6qd8FFpc%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - Web UI Dashboard é¡µé¢" loading="lazy"/>
å›¾ä¸­æ˜¾ç¤ºçš„æ˜¯æœªæˆæƒçŠ¶æ€ï¼Œå›åˆ°æœåŠ¡å™¨ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<pre><code class="hljs language-shell" lang="shell">openclaw dashboard
</code></pre>
<p>ä¼šçœ‹åˆ°ä¸‹é¢çš„é¢æ¿æ•°æ®
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d08b9e3d2fa4f8eaa4bf0b766f3012f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=NYXYm44mY4VHyPKvyLgGP6ebsig%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - Dashboard URL è·å–å‘½ä»¤" loading="lazy"/>
å¤åˆ¶å¯¹åº”çš„ <code>Dashboard URL</code> åˆ°æµè§ˆå™¨æ‰“å¼€ï¼Œå³å¯æ­£å¸¸æŸ¥çœ‹èŠå¤©è®°å½•ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77f2b6c18b8c4fa390520df6d539e0c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=PjgInu22SbgfZ4voCtC23IqT4dA%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - Web UI ç®¡ç†é¢æ¿èŠå¤©è®°å½•" loading="lazy"/></p>
<p>è‡³æ­¤ Openclaw (åŸ Clawdbot) å·²å®‰è£…å®Œæˆï¼Œå¯ä»¥æ­£å¸¸è®¿é—®äº†ã€‚ç„¶åèŠå¤©æ¡†é‡Œé¢é¦–æ¬¡è¾“å…¥ <code>Hello</code>, <code>Clawdbot</code> ä¼šè¯¢é—®ä½ ä»–åº”è¯¥å«ä»€ä¹ˆï¼Œåº”è¯¥å«ä½ ä»€ä¹ˆã€‚å°±æ˜¯ä½ éœ€è¦ç»™å®ƒè®¾ç½®ä¸ªåå­—ï¼Œè¿˜æœ‰ bot æ”¹å«ä½ ä»€ä¹ˆã€‚ä½ å¯ä»¥åœ¨èŠå¤©æ¡†è¿™ä¹ˆè¾“å…¥</p>
<pre><code class="hljs language-shell" lang="shell">Name: Openclaw

My Name: Boss
</code></pre>
<h3 data-id="heading-7">å¯¹æ¥é’‰é’‰</h3>
<p>é’‰é’‰æ˜¯å›½å†…ä½¿ç”¨æœ€å¹¿æ³›çš„ä¼ä¸šåŠå…¬å¹³å°ä¹‹ä¸€ï¼ŒOpenClaw æ”¯æŒé€šè¿‡é’‰é’‰æœºå™¨äººè¿›è¡Œäº¤äº’ã€‚æœ¬èŠ‚å°†ä»‹ç»å¦‚ä½•é…ç½®é’‰é’‰æœºå™¨äººå¯¹æ¥ OpenClawã€‚</p>
<h4 data-id="heading-8">å®‰è£…é’‰é’‰æ’ä»¶</h4>
<p>é¦–å…ˆå®‰è£…é£ä¹¦æ’ä»¶ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ç›´æ¥è¿è¡Œ openclaw æ’ä»¶å®‰è£…å‘½ä»¤ï¼Œopenclaw ä¼šè‡ªåŠ¨å¤„ç†ä¸‹è½½ã€å®‰è£…ä¾èµ–å’Œæ³¨å†Œã€‚æ—¶é—´æœ‰å¯èƒ½æ¯”è¾ƒä¹…ï¼Œç­‰å¾…å³å¯</p>
<pre><code class="hljs language-shell" lang="shell">openclaw plugins install https://github.com/soimy/clawdbot-channel-dingtalk.git
</code></pre>
<h4 data-id="heading-9">åˆ›å»ºé’‰é’‰åº”ç”¨</h4>
<p>ç™»å½•<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen-dev.dingtalk.com%2F" target="_blank" title="https://open-dev.dingtalk.com/" ref="nofollow noopener noreferrer">é’‰é’‰å¼€æ”¾å¹³å°</a>ï¼Œç‚¹å‡»ã€Œåˆ›å»ºåº”ç”¨ã€</p>
<blockquote>
<p>æ³¨æ„ï¼šåˆ›å»ºé’‰é’‰åº”ç”¨éœ€è¦ä½ çš„é’‰é’‰è´¦å·æœ‰å¼€å‘è€…æƒé™ã€‚å¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥è”ç³»ç»„ç»‡ç®¡ç†å‘˜è·å–ï¼Œæˆ–å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fopen.dingtalk.com%2Fdocument%2Forgapp%2Fobtain-developer-permissions" target="_blank" title="https://open.dingtalk.com/document/orgapp/obtain-developer-permissions" ref="nofollow noopener noreferrer">è·å–å¼€å‘è€…æƒé™</a></p>
</blockquote>
<p>åœ¨åº”ç”¨å¼€å‘çš„å·¦ä¾§å¯¼èˆªæ ä¸­ï¼Œç‚¹å‡»ã€Œé’‰é’‰åº”ç”¨ã€ï¼Œç„¶åç‚¹å‡»å³ä¸Šè§’ã€Œåˆ›å»ºåº”ç”¨ã€ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2636bde92c2e4b9abd6849c8c263254c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=tQ0OtAKrn3SyDrprR1ieDjIPagM%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - é’‰é’‰å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨" loading="lazy"/>
å¡«å†™åº”ç”¨åç§°å’Œåº”ç”¨æè¿°ï¼Œä¸Šä¼ åº”ç”¨å›¾æ ‡åä¿å­˜ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f74118872a78420c8b0cba10050736d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=iMxqyM22RQJ68ufeL%2BgNJvM9R1s%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - åº”ç”¨åŸºæœ¬ä¿¡æ¯å¡«å†™" loading="lazy"/></p>
<h4 data-id="heading-10">æ·»åŠ æœºå™¨äºº</h4>
<p>åœ¨åº”ç”¨å¼€å‘çš„å·¦ä¾§å¯¼èˆªæ ä¸­ï¼Œç‚¹å‡»ã€Œæ·»åŠ åº”ç”¨èƒ½åŠ›ã€ï¼Œç„¶åç‚¹å‡»æ·»åŠ ã€Œæœºå™¨äººã€ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f775505131c04ce6ae858d0e71ca8a4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=%2FoxpByQPga6qRc58POr4Bg6gOGg%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - æ·»åŠ æœºå™¨äººèƒ½åŠ›" loading="lazy"/>
æ·»åŠ å®Œæœºå™¨äººä¹‹åï¼Œå°±æ˜¯é…ç½®ä¸€äº›åŸºæœ¬ä¿¡æ¯ä¹‹åï¼Œç‚¹å‡»å‘å¸ƒã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/732b0e46796c47a9b8b73b5f9a64f5b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=pvNu7O2FVavfKmWfrTqzg5Ai1Ck%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - æœºå™¨äºº Stream æ¨¡å¼é…ç½®" loading="lazy"/></p>
<blockquote>
<p>æœ€åå¾—æ¶ˆæ¯æ¥å—æ¨¡å¼ä¸€å®šè¦æ˜¯ <code>stream æ¨¡å¼</code></p>
</blockquote>
<h4 data-id="heading-11">å‘å¸ƒç‰ˆæœ¬</h4>
<p>åœ¨å‘å¸ƒå®Œæœºå™¨äººä¹‹åï¼Œä¸€å®šè¦å‘å¸ƒç‰ˆæœ¬ã€‚åœ¨åº”ç”¨å¼€å‘çš„å·¦ä¾§å¯¼èˆªæ ä¸­ï¼Œç‚¹å‡»ã€Œç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒã€ï¼Œç„¶åç‚¹å‡»å³ä¸Šè§’ã€Œåˆ›å»ºæ–°ç‰ˆæœ¬ã€ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a97e9f56680d49b7a64a5c261a6fe834~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=f%2B3P2sN%2Fy3FkkRrQtyQ1g3bs6CI%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - ç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒ" loading="lazy"/></p>
<h4 data-id="heading-12">è·å–å‡­è¯ä¿¡æ¯</h4>
<p>å‘å¸ƒç‰ˆæœ¬æˆåŠŸä¹‹åï¼Œç‚¹å‡»å·¦ä¾§èœå•çš„ã€Œå‡­è¯ä¸åŸºç¡€ä¿¡æ¯ã€ï¼Œè·å–ä»¥ä¸‹å‡­è¯ä¿¡æ¯</p>
<ul>
<li>
<p>Client ID (AppKey)</p>
</li>
<li>
<p>Client Secret (AppSecret)</p>
</li>
<li>
<p>Robot Code (ä¸ Client ID ç›¸åŒ)</p>
</li>
<li>
<p>Agent ID (åº”ç”¨ ID)
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8fd2e6dd3e424ee683eef47d33427d09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=6AAxMSX9g%2FaS03GQ4dLryc%2B1bsg%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - è·å– Client ID å’Œ Secret" loading="lazy"/></p>
</li>
<li>
<p>Corp ID (ä¼ä¸š ID)
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3bff37c085ce4cf6b95eb9aea162a41a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=%2BOk5r8696eNl%2FVnWQKCCzIIHmgU%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - è·å–ä¼ä¸š Corp ID" loading="lazy"/></p>
</li>
</ul>
<h4 data-id="heading-13">æ·»åŠ é’‰é’‰é…ç½®</h4>
<p>æ‰¾åˆ° <code>openclaw.json</code> é…ç½®æ–‡ä»¶ã€‚ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ‰¾åˆ°é…ç½®æ–‡ä»¶</p>
<pre><code class="hljs language-shell" lang="shell">find / | grep openclaw.json
<span class="hljs-meta prompt_">
# </span><span class="bash">æœ¬äººæœåŠ¡å™¨çš„è¾“å‡ºå¦‚ä¸‹ï¼Œæ¯ä¸ªäººéƒ½ä¸ä¸€æ ·ï¼ŒæŒ‰å®é™…æƒ…å†µæ‰¾</span>
<span class="hljs-meta prompt_">#</span><span class="bash">/root/.openclaw/openclaw.json.bak</span>
<span class="hljs-meta prompt_">#</span><span class="bash">/root/.openclaw/openclaw.json.bak.1</span>
<span class="hljs-meta prompt_">#</span><span class="bash">/root/.openclaw/openclaw.json // è¿™ä¸ªå°±æ˜¯é…ç½®æ–‡ä»¶</span>
<span class="hljs-meta prompt_">#</span><span class="bash">/root/.openclaw/openclaw.json.bak.2</span>
</code></pre>
<p>ç„¶åæ‰¾åˆ°å¯¹åº”çš„ <code>channels</code> é…ç½®</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"dingtalk"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"clientId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dingxxxxxx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"clientSecret"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"your-app-secret"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"robotCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dingxxxxxx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"corpId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"dingxxxxxx"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"agentId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"123456789"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"dmPolicy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"open"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"groupPolicy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"open"</span><span class="hljs-punctuation">,</span>      
      <span class="hljs-attr">"messageType"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"markdown"</span><span class="hljs-punctuation">,</span>       
      <span class="hljs-attr">"debug"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>å¦‚æœä½ æ‰¾ä¸åˆ°å¯¹åº”çš„é…ç½®ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤é…ç½®ä¹Ÿæ˜¯å¯ä»¥çš„</p>
<pre><code class="hljs language-shell" lang="shell">openclaw config set channels.dingtalk.enabled true

openclaw config set channels.dingtalk.clientId ä½ çš„ Client ID

openclaw config set channels.dingtalk.clientSecret ä½ çš„ Client Secret

openclaw config set channels.dingtalk.robotCode Robot Code (ä¸ Client ID ç›¸åŒ)

openclaw config set channels.dingtalk.corpId ä½ çš„corpId

openclaw config set channels.dingtalk.agentId Agent ID

openclaw config set channels.dingtalk.dmPolicy open

openclaw config set channels.dingtalk.groupPolicy open

openclaw config set channels.dingtalk.messageType markdown

openclaw config set channels.dingtalk.debug false

</code></pre>
<p>é…ç½®å®Œæˆä¹‹åï¼Œé‡å¯æœåŠ¡</p>
<pre><code class="hljs language-shell" lang="shell">openclaw gateway restart
</code></pre>
<h4 data-id="heading-14">æµ‹è¯•æœºå™¨äºº</h4>
<p>å›åˆ°é’‰é’‰å®¢æˆ·ç«¯è½¯ä»¶ï¼Œåœ¨é¡¶éƒ¨æœç´¢æ ç›®æœç´¢æœºå™¨äººåç§° <code>openclaw</code>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b468c65fbab41488ff54be0fd6775c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQmluZ29Hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770518066&amp;x-signature=sOw3PPnXRjrEqP72%2BhNRnFoip9w%3D" alt="OpenClaw é’‰é’‰æ•™ç¨‹ - æœç´¢å¹¶æµ‹è¯•æœºå™¨äºº" loading="lazy"/>
ç‚¹å‡»æœºå™¨äººå°±å¯ä»¥ç›´æ¥è·Ÿæœºå™¨äººèŠå¤©äº†ã€‚å¯ä»¥è¾“å…¥ <code>Hello</code></p>
<h3 data-id="heading-15">å¸¸è§é—®é¢˜ FAQ</h3>
<h4 data-id="heading-16">OpenClaw å’Œ Clawdbotã€Moltbot æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ</h4>
<p>OpenClaw æ˜¯è¯¥é¡¹ç›®çš„æœ€æ–°æ­£å¼åç§°ã€‚é¡¹ç›®æœ€åˆå« Clawdbotï¼Œåå› å•†æ ‡é—®é¢˜æ›´åä¸º Moltbotï¼Œæœ€ç»ˆåœ¨ 2025 å¹´ 1 æœˆæ­£å¼å®šåä¸º OpenClawã€‚ä¸‰è€…æ˜¯åŒä¸€ä¸ªé¡¹ç›®çš„ä¸åŒé˜¶æ®µå‘½åã€‚</p>
<h4 data-id="heading-17">OpenClaw æ”¯æŒå“ªäº› AI æ¨¡å‹ï¼Ÿ</h4>
<p>OpenClaw æ”¯æŒå¤šç§ AI æ¨¡å‹æœåŠ¡å•†ï¼ŒåŒ…æ‹¬ Anthropic Claudeã€OpenAI GPTã€é€šä¹‰åƒé—®ï¼ˆQwenï¼‰ã€KIMIã€å°ç±³ MiMo ç­‰ã€‚æœ¬æ•™ç¨‹ä½¿ç”¨é€šä¹‰åƒé—®æ˜¯å› ä¸ºå…¶å…è´¹é¢åº¦å……è¶³ï¼Œé€‚åˆå…¥é—¨å­¦ä¹ ã€‚</p>
<h4 data-id="heading-18">ä¸ºä»€ä¹ˆå®‰è£…æ—¶æç¤º npm install failedï¼Ÿ</h4>
<p>è¿™é€šå¸¸æ˜¯æœåŠ¡å™¨å†…å­˜ä¸è¶³å¯¼è‡´çš„ã€‚æ–°ç‰ˆæœ¬è„šæœ¬å¯¹å†…å­˜è¦æ±‚è¾ƒé«˜ï¼Œ2G å†…å­˜å¯èƒ½ä¼šå‡ºç° OOMï¼ˆå†…å­˜æº¢å‡ºï¼‰ã€‚å»ºè®®é…ç½® swap äº¤æ¢ç©ºé—´ï¼Œå°†ç¡¬ç›˜ç©ºé—´ä½œä¸ºè™šæ‹Ÿå†…å­˜ä½¿ç”¨ã€‚</p>
<h4 data-id="heading-19">OpenClaw å¯ä»¥åœ¨ Windows æˆ– macOS ä¸Šè¿è¡Œå—ï¼Ÿ</h4>
<p>å¯ä»¥ã€‚OpenClaw æ”¯æŒ Macã€Windows å’Œ Linux ç³»ç»Ÿã€‚æœ¬æ•™ç¨‹ä»¥ Linux ä¸ºä¾‹ï¼Œå…¶ä»–ç³»ç»Ÿçš„å®‰è£…æ–¹å¼å¯å‚è€ƒ<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openclaw.ai%2F" target="_blank" title="https://docs.openclaw.ai/" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<h4 data-id="heading-20">é’‰é’‰æœºå™¨äººé…ç½®åæ— æ³•æ”¶åˆ°æ¶ˆæ¯æ€ä¹ˆåŠï¼Ÿ</h4>
<p>è¯·æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>ç¡®è®¤é’‰é’‰æ’ä»¶å·²æ­£ç¡®å®‰è£…ï¼ˆ<code>clawdbot plugins install @openclaw-china/channels</code>ï¼‰</li>
<li>æ£€æŸ¥ Client ID å’Œ Client Secret é…ç½®æ˜¯å¦æ­£ç¡®</li>
<li>ç¡®è®¤å·²ç”³è¯· <code>Card.Streaming.Write</code> å’Œ <code>Card.Instance.Write</code> æƒé™</li>
<li>æ£€æŸ¥æœºå™¨äººæ¶ˆæ¯æ¥æ”¶åœ°å€æ˜¯å¦æ­£ç¡®é…ç½®</li>
<li>ç¡®ä¿æœåŠ¡å™¨ 18789 ç«¯å£å¯¹å¤–å¼€æ”¾</li>
<li>ç¡®ä¿åº”ç”¨ç‰ˆæœ¬å·²å‘å¸ƒ</li>
</ol>
<h4 data-id="heading-21">OpenClaw æ•°æ®å®‰å…¨å—ï¼Ÿ</h4>
<p>OpenClaw è¿è¡Œåœ¨ä½ è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œæ‰€æœ‰æ•°æ®éƒ½åœ¨æœ¬åœ°å­˜å‚¨ï¼Œä¸ä¼šä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹äº‘ç«¯ã€‚ä½†ç”±äºå®ƒå…·æœ‰ç³»ç»Ÿçº§æƒé™ï¼Œå»ºè®®åœ¨ç‹¬ç«‹çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²ï¼Œé¿å…åœ¨ç”Ÿäº§ç¯å¢ƒæˆ–é‡è¦æ•°æ®çš„æœºå™¨ä¸Šè¿è¡Œã€‚</p>
<h4 data-id="heading-22">é™¤äº†é’‰é’‰ï¼ŒOpenClaw è¿˜æ”¯æŒå“ªäº›å¹³å°ï¼Ÿ</h4>
<p>OpenClaw æ”¯æŒå¤šä¸ªèŠå¤©å¹³å°ï¼ŒåŒ…æ‹¬é£ä¹¦ã€ä¼ä¸šå¾®ä¿¡ã€QQã€WhatsAppã€Telegramã€Discordã€Slackã€Microsoft Teamsã€Signalã€iMessageã€Google Chatã€Twitch ç­‰ã€‚æ¯ä¸ªå¹³å°éœ€è¦å®‰è£…å¯¹åº”çš„æ’ä»¶ã€‚å›½å†…å¹³å°æ¨èä½¿ç”¨ <code>@openclaw-china/channels</code> æ’ä»¶ã€‚</p>
<h4 data-id="heading-23">OpenClaw å¯ä»¥åšä»€ä¹ˆï¼Ÿ</h4>
<p>OpenClaw å¯ä»¥æ‰§è¡Œå¤šç§ä»»åŠ¡ï¼š</p>
<ul>
<li>é‚®ä»¶ç®¡ç†å’Œè‡ªåŠ¨å›å¤</li>
<li>æ—¥ç¨‹å®‰æ’å’Œæé†’</li>
<li>æµè§ˆç½‘é¡µå’Œæ•°æ®æå–</li>
<li>æ–‡ä»¶è¯»å†™å’Œç®¡ç†</li>
<li>æ‰§è¡Œ Shell å‘½ä»¤</li>
<li>ç¼–å†™å’Œè¿è¡Œä»£ç </li>
<li>æ•°æ®æŸ¥è¯¢å’Œåˆ†æ</li>
</ul>
<h4 data-id="heading-24">å¦‚ä½•æ›´æ–° OpenClaw åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Ÿ</h4>
<p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ›´æ–°ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">openclaw update
</code></pre>
<h4 data-id="heading-25">OpenClaw å‘½ä»¤å’Œ clawdbot å‘½ä»¤æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4>
<p>OpenClaw æ›´ååï¼Œå®˜æ–¹æ¨èä½¿ç”¨ <code>openclaw</code> å‘½ä»¤ï¼Œä½†ä¸ºäº†å…¼å®¹æ€§ï¼Œ<code>clawdbot</code> å‘½ä»¤ä»ç„¶å¯ç”¨ã€‚ä¸¤è€…åŠŸèƒ½å®Œå…¨ç›¸åŒï¼Œå»ºè®®æ–°ç”¨æˆ·ç›´æ¥ä½¿ç”¨ <code>openclaw</code> å‘½ä»¤ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Fopenclaw-dingding-install" target="_blank" title="https://catchadmin.com/post/2026-01/openclaw-dingding-install" ref="nofollow noopener noreferrer">OpenClawï¼ˆåŸ Clawdbotï¼‰é’‰é’‰å¯¹æ¥ä¿å§†çº§æ•™ç¨‹ æ‰‹æŠŠæ‰‹æ•™ä½ æ‰“é€ è‡ªå·±çš„ AI åŠ©æ‰‹</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•æ„å»ºè¡Œä¸š Agent çš„ RAG]]></title>    <link>https://juejin.cn/post/7601169987412213798</link>    <guid>https://juejin.cn/post/7601169987412213798</guid>    <pubDate>2026-02-01T01:21:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601169987412213798" data-draft-id="7601041482893197362" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•æ„å»ºè¡Œä¸š Agent çš„ RAG"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2026-02-01T01:21:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ½˜é”¦"/> <meta itemprop="url" content="https://juejin.cn/user/730549110707431"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•æ„å»ºè¡Œä¸š Agent çš„ RAG
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/730549110707431/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ½˜é”¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T01:21:27.000Z" title="Sun Feb 01 2026 01:21:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¡Œä¸š Agent å’Œæˆ‘ä»¬å¸¸ç”¨çš„ã€Œé€šç”¨èŠå¤© Agentã€ä¸æ˜¯ä¸€ç±»ä¸œè¥¿ã€‚</p>
<p>è¡Œä¸š Agent æ˜¯è¦èƒ½è§£å†³é—®é¢˜çš„ï¼Œè€ŒæŸ¥èµ„æ–™åªæ˜¯å…¶ä¸­ä¸€æ­¥ï¼Œåé¢è¿˜è¦åšåˆ¤æ–­ã€èµ°æµç¨‹ã€è°ƒç”¨ç³»ç»Ÿã€æ ¡éªŒç»“æœã€ç•™ç—•ã€å¯å›æ”¾ã€‚</p>
<p>RAG åœ¨è¿™é‡Œçš„è§’è‰²ä¹Ÿå˜äº†ï¼šå®ƒä¸åªæ˜¯ç»™æ¨¡å‹å–‚ä¸Šä¸‹æ–‡ï¼Œè€Œæ˜¯ç»™ Agent æä¾›å¯æ‰§è¡Œä»»åŠ¡æ‰€éœ€çš„ä¾æ®ã€çº¦æŸã€å‚æ•°å’Œè¯æ®é“¾ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬èŠä¸€ä¸‹è¡Œä¸š Agent æ„å»ºè¿‡ç¨‹ä¸­çš„ RAG æ€ä¹ˆå†™ï¼Œä»ç›®æ ‡ã€æ•°æ®ï¼Œæ£€ç´¢ä»¥åŠä½¿ç”¨ RAG ç­‰ç­‰æ–¹é¢ã€‚</p>
<h2 data-id="heading-0">1. è¡Œä¸š Agent çš„ RAG è¦æœåŠ¡ä»€ä¹ˆèƒ½åŠ›</h2>
<p>è¡Œä¸š Agent å¸¸è§çš„å·¥ä½œæ–¹å¼æ˜¯ã€Œå¤šæ­¥é—­ç¯ã€ï¼š</p>
<ol>
<li>è¯†åˆ«é—®é¢˜ç±»å‹ä¸ä¸šåŠ¡å¯¹è±¡ï¼ˆå®¢æˆ·ã€è®¾å¤‡ã€åˆåŒã€å·¥å•ã€è®¢å•ã€é¡¹ç›®ã€è´¦å·ç­‰ï¼‰</li>
<li>æŸ¥ä¾æ®ï¼ˆåˆ¶åº¦ã€æ‰‹å†Œã€çŸ¥è¯†åº“ã€å†å²å·¥å•ã€æ ‡å‡†ã€æ¥å£æ–‡æ¡£ï¼‰</li>
<li>åšåŠ¨ä½œï¼ˆæŸ¥ç³»ç»Ÿã€ä¸‹å‘æŒ‡ä»¤ã€å¼€é€šé…ç½®ã€ç”Ÿæˆå·¥å•ã€å‘é‚®ä»¶ã€å†™æŠ¥å‘Šã€æå®¡æ‰¹ï¼‰</li>
<li>æ ¡éªŒä¸å›å†™ï¼ˆç¡®è®¤å˜æ›´æˆåŠŸã€å›å¡«å­—æ®µã€ç•™ç—•ã€æŠŠå¼•ç”¨/è¯æ®æŒ‚åˆ°å·¥å•ï¼‰</li>
<li>è§£é‡Šï¼ˆç»™ç”¨æˆ·è¯´æ˜ä¾æ®ã€å½±å“èŒƒå›´ã€å›æ»šæ–¹æ¡ˆã€ä¸‹ä¸€æ­¥å»ºè®®ï¼‰</li>
</ol>
<p>æ‰€ä»¥è¡Œä¸š Agent çš„ RAG ä¸åªæ˜¯ã€Œé—®ç­”æ£€ç´¢ã€ï¼Œè€Œæ˜¯è‡³å°‘è¦è¦†ç›–è¿™äº›ä¿¡æ¯ç±»å‹ï¼š</p>
<ul>
<li>è§„åˆ™ä¾æ®ï¼šåˆ¶åº¦ã€æ¡æ¬¾ã€SOPã€åˆè§„æ¨¡æ¿ã€å˜æ›´è§„èŒƒ</li>
<li>æ“ä½œä¾æ®ï¼šç³»ç»Ÿä½¿ç”¨æ‰‹å†Œã€æ¥å£æ–‡æ¡£ã€å‚æ•°å«ä¹‰ã€é”™è¯¯ç å¤„ç†</li>
<li>å¯¹è±¡äº‹å®ï¼šæ¥è‡ªä¸šåŠ¡ç³»ç»Ÿçš„å®æ—¶/å‡†å®æ—¶æ•°æ®ï¼ˆç”¨æˆ·ä¿¡æ¯ã€èµ„æºçŠ¶æ€ã€åº“å­˜ã€è´¦å•ã€è®¾å¤‡çŠ¶æ€ï¼‰</li>
<li>å†å²ç»éªŒï¼šå·¥å•å¤„ç†è®°å½•ã€æ•…éšœå¤ç›˜ã€å·²çŸ¥é—®é¢˜ï¼ˆKEDBï¼‰</li>
<li>é£é™©è¾¹ç•Œï¼šç¦ç”¨æ“ä½œæ¸…å•ã€æƒé™èŒƒå›´ã€éœ€è¦äººå·¥å¤æ ¸çš„æ¡ä»¶</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬åªåšã€Œæ–‡æ¡£å‘é‡åº“ + ç”Ÿæˆã€ï¼ŒAgent èµ°åˆ°ç¬¬ 3 æ­¥å°±ä¼šå¡ï¼šå®ƒä¸çŸ¥é“è¯¥è°ƒç”¨å“ªä¸ªç³»ç»Ÿã€éœ€è¦å“ªäº›å­—æ®µã€ä»€ä¹ˆæƒ…å†µä¸‹è¦åœä¸‹æ¥è®©äººç¡®è®¤ï¼Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆè¯æ˜è‡ªå·±åšå¯¹äº†ã€‚</p>
<h2 data-id="heading-1">2. æŒ‡æ ‡</h2>
<p>è¡Œä¸š Agent åœºæ™¯é‡Œï¼Œæœ€å¥½ç”¨ä¸‰ç±»æŒ‡æ ‡æè¿°ï¼š</p>
<h2 data-id="heading-2">2.1 ä»»åŠ¡å®Œæˆç±»æŒ‡æ ‡</h2>
<ul>
<li>ä»»åŠ¡æˆåŠŸç‡ï¼ˆæœ€ç»ˆåŠ¨ä½œæˆåŠŸå¹¶é€šè¿‡æ ¡éªŒï¼‰</li>
<li>å¹³å‡å®Œæˆæ—¶é•¿ï¼ˆç«¯åˆ°ç«¯ï¼‰</li>
<li>äººå·¥ä»‹å…¥ç‡ï¼ˆéœ€è¦äººç¡®è®¤/è¡¥å……ä¿¡æ¯/å…œåº•ï¼‰</li>
<li>å›æ»šç‡ï¼ˆæ‰§è¡Œåéœ€è¦æ’¤é”€/ä¿®æ­£ï¼‰</li>
</ul>
<h2 data-id="heading-3">2.2 é£é™©ç±»æŒ‡æ ‡ï¼ˆçº¢çº¿ä¸èƒ½è¿‡ï¼‰</h2>
<ul>
<li>è¶Šæƒç‡ï¼ˆæ£€ç´¢/æ‰§è¡Œæ˜¯å¦è¶Šæƒï¼Œç›®æ ‡æ˜¯ 0ï¼‰</li>
<li>è¯¯æ‰§è¡Œç‡ï¼ˆä¸è¯¥æ‰§è¡Œå´æ‰§è¡Œï¼‰</li>
<li>è¯¯ç­”å¯¼è‡´çš„é”™è¯¯æ“ä½œï¼ˆæŠŠâ€œç¼–å‡ºæ¥çš„ä¾æ®â€å½“æˆæ‰§è¡Œä¾æ®ï¼‰</li>
<li>å¼•ç”¨ä¸å¯è¿½æº¯ç‡ï¼ˆç»™ä¸å‡ºæ¥æºæˆ–æ¥æºä¸æ”¯æŒç»“è®ºï¼‰</li>
</ul>
<h2 data-id="heading-4">2.3 çŸ¥è¯†ä¸æ£€ç´¢ç±»æŒ‡æ ‡ï¼ˆç”¨äºé©±åŠ¨è¿­ä»£ï¼‰</h2>
<ul>
<li>ä¾æ®å‘½ä¸­ç‡ï¼ˆæ ‡å‡†ä¾æ®æ˜¯å¦å‡ºç°åœ¨ topKï¼‰</li>
<li>å†²çªå¤„ç†æ­£ç¡®ç‡ï¼ˆæ–°æ—§ç‰ˆæœ¬/å¤šæ¥æºå†²çªæ—¶æ˜¯å¦é€‰å¯¹ï¼‰</li>
<li>æ—¶æ•ˆæ­£ç¡®ç‡ï¼ˆæ˜¯å¦å¼•ç”¨è¿‡æœŸ/åºŸæ­¢å†…å®¹ï¼‰</li>
<li>è¦†ç›–ç‡ï¼ˆé«˜é¢‘é—®é¢˜æ˜¯å¦è¦†ç›–ï¼‰</li>
</ul>
<p>è¡Œä¸š Agent çš„ RAG è®¾è®¡ï¼Œæœ€ç»ˆè¦å¯¹è¿™äº›æŒ‡æ ‡è´Ÿè´£ã€‚å¦åˆ™æˆ‘ä»¬ä¼šé™·å…¥ã€Œç­”å¾—åƒé‚£ä¹ˆå›äº‹ï¼Œä½†ä¸æ•¢è®©å®ƒåŠ¨ç³»ç»Ÿã€çš„çŠ¶æ€ã€‚</p>
<h2 data-id="heading-5">3. æ•°æ®å±‚</h2>
<p>è¡Œä¸š Agent çš„ RAGï¼Œæ•°æ®æ¯”æ¨¡å‹æ›´é‡è¦ã€‚</p>
<h2 data-id="heading-6">3.1 ä¸‰ç±»æ•°æ®</h2>
<ol>
<li>é™æ€æƒå¨çŸ¥è¯†ï¼šåˆ¶åº¦ã€è§„èŒƒã€æ‰‹å†Œã€æ ‡å‡†ã€äº§å“æ–‡æ¡£ ç›®æ ‡ï¼šå¯è¿½æº¯ã€ç‰ˆæœ¬å¯æ§ã€å¯å¼•ç”¨</li>
<li>åŠ¨æ€ä¸šåŠ¡äº‹å®ï¼šæ¥è‡ªä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®ï¼ˆCRMã€å·¥å•ã€CMDBã€ç›‘æ§ã€è®¡è´¹ã€IAM ç­‰ï¼‰ ç›®æ ‡ï¼šå¯æ ¡éªŒã€å¯å®¡è®¡ã€æœ€å¥½å¯å›æ”¾ï¼ˆè‡³å°‘ä¿ç•™æŸ¥è¯¢å¿«ç…§ï¼‰</li>
<li>è¿‡ç¨‹ä¸ç»éªŒï¼šå†å²å·¥å•ã€æ•…éšœå¤ç›˜ã€å¤„ç†è®°å½•ã€FAQ æ¼”è¿› ç›®æ ‡ï¼šå¯è¿‡æ»¤ï¼ˆè´¨é‡å‚å·®ï¼‰ã€å¯åˆ†çº§ï¼ˆæƒå¨/ç»éªŒ/çŒœæµ‹ï¼‰</li>
</ol>
<p>å¾ˆå¤šé¡¹ç›®å¤±è´¥æ˜¯å› ä¸ºæŠŠç¬¬ 3 ç±»å½“ç¬¬ 1 ç±»ç”¨ï¼ŒæŠŠã€Œç»éªŒã€å½“ã€Œåˆ¶åº¦ã€ã€‚Agent ä¸€æ—¦æ®æ­¤å»æ‰§è¡ŒåŠ¨ä½œï¼Œé£é™©ä¼šæ”¾å¤§ã€‚</p>
<h2 data-id="heading-7">3.2 æ¯ä¸ªçŸ¥è¯†ç‰‡æ®µå¿…é¡»å¸¦çš„å…ƒæ•°æ®</h2>
<p>è¡Œä¸š Agent éœ€è¦çš„ä¸åªæ˜¯ã€Œèƒ½æœåˆ°ã€ï¼Œè¿˜è¦ã€Œèƒ½ç”¨æ¥åšåŠ¨ä½œã€ã€‚å»ºè®®æ¯ä¸ª chunk è‡³å°‘åŒ…å«ï¼š</p>
<ul>
<li>doc_id / chunk_id</li>
<li>sourceï¼ˆç³»ç»Ÿ/åº“ï¼‰</li>
<li>source_urlï¼ˆå¯ç‚¹å‡»æˆ–å¯å®šä½ï¼‰</li>
<li>title_pathï¼ˆæ ‡é¢˜é“¾ï¼‰</li>
<li>doc_typeï¼ˆåˆ¶åº¦/æ‰‹å†Œ/æ¥å£æ–‡æ¡£/å¤ç›˜/å·¥å•ç­‰ï¼‰</li>
<li>versionã€statusï¼ˆè‰ç¨¿/å·²å‘å¸ƒ/å·²åºŸæ­¢ï¼‰</li>
<li>effective_from / effective_toï¼ˆèƒ½ç»™å°±ç»™ï¼‰</li>
<li>ownerï¼ˆç»´æŠ¤äºº/å›¢é˜Ÿï¼‰</li>
<li>updated_at</li>
<li>é€‚ç”¨èŒƒå›´æ ‡ç­¾ï¼šäº§å“çº¿/åœ°åŒº/å®¢æˆ·/æœºå‹/ç¯å¢ƒï¼ˆç”Ÿäº§/æµ‹è¯•ï¼‰</li>
<li>æƒé™æ ‡ç­¾ï¼šRBAC/ABAC æ‰€éœ€å­—æ®µ</li>
<li>å¯æ‰§è¡Œæ€§æ ‡ç­¾ï¼ˆå»ºè®®åŠ ï¼‰ï¼š</li>
<li>æ˜¯å¦å¯ä½œä¸ºæ‰§è¡Œä¾æ®ï¼ˆä¾‹å¦‚åˆ¶åº¦/å·²å‘å¸ƒ SOP æ‰èƒ½ï¼‰</li>
<li>æ˜¯å¦éœ€è¦äººå·¥å¤æ ¸ï¼ˆé«˜é£é™©æ“ä½œï¼‰</li>
<li>æ˜¯å¦ä»…ä¾›å‚è€ƒï¼ˆå¤ç›˜/ç»éªŒï¼‰</li>
</ul>
<p>è¿™äº›æ ‡ç­¾å¯¹ Agent æ¯”è¾ƒå…³é”®ï¼šå®ƒèƒ½å†³å®šã€Œèƒ½ä¸èƒ½åšã€è¦ä¸è¦åœã€æ€ä¹ˆè§£é‡Šã€ã€‚</p>
<h2 data-id="heading-8">3.3 æ–‡æ¡£è§£æä¸åˆ‡åˆ†</h2>
<p>è¡Œä¸š Agent çš„ RAG çš„åˆ‡åˆ†ç­–ç•¥ï¼Œä¼˜å…ˆçº§ä¸€èˆ¬æ˜¯ï¼š</p>
<ol>
<li>æŒ‰ç»“æ„åˆ‡ï¼šç« /èŠ‚/æ¡æ¬¾/æ¥å£å­—æ®µè¯´æ˜/é”™è¯¯ç æ¡ç›®</li>
<li>æŠŠâ€œå‰ç½®æ¡ä»¶/é™åˆ¶/ä¾‹å¤–â€è·Ÿè§„åˆ™æ”¾ä¸€èµ·</li>
<li>è¡¨æ ¼ä¸å­—æ®µå®šä¹‰è¦ä¿è¡¨å¤´ï¼ˆå­—æ®µå«ä¹‰è„±ç¦»è¡¨å¤´å°±æ²¡æ³•ç”¨ï¼‰</li>
<li>æŠŠå¯æ‰§è¡Œæ­¥éª¤å•ç‹¬æˆå—ï¼ˆSOPã€Runbookã€å˜æ›´æ­¥éª¤ï¼‰</li>
</ol>
<p>æ³¨æ„ï¼šä¸è¦æŠŠã€Œå®šä¹‰ã€ã€Œé€‚ç”¨èŒƒå›´ã€ã€Œä¾‹å¤–æ¡æ¬¾ã€åˆ‡ç¢ã€‚Agent æ‰§è¡ŒåŠ¨ä½œæ—¶ï¼Œæœ€éœ€è¦çš„å°±æ˜¯è¾¹ç•Œæ¡ä»¶å’Œé™åˆ¶ã€‚</p>
<h2 data-id="heading-9">4. ç´¢å¼•ä¸æ£€ç´¢</h2>
<p>è¡Œä¸š Agent å’Œå¸¸è§„çš„ Agent ä¸åŒï¼Œå…¶æ›´ä¾èµ–äºã€Œè¿‡æ»¤ + æ’åº + è¯æ®é“¾ã€</p>
<h2 data-id="heading-10">4.1 ä½¿ç”¨æ··åˆæ£€ç´¢</h2>
<p>è¡Œä¸š Agent çš„æŸ¥è¯¢é‡Œä¼šå‡ºç°å¤§é‡ã€Œç¡¬ä¿¡æ¯ã€ï¼š</p>
<ul>
<li>æ¡æ¬¾å·ã€æ ‡å‡†å·ã€å‹å·ã€é”™è¯¯ç ã€å‚æ•°åã€æ¥å£è·¯å¾„ã€å·¥å•å·ã€é…ç½®é¡¹å</li>
</ul>
<p>çº¯å‘é‡åœ¨è¿™äº›åœºæ™¯ä¸ç¨³ã€‚å·¥ç¨‹ä¸Šæ›´å¸¸ç”¨çš„æ˜¯ï¼š</p>
<ul>
<li>å…³é”®è¯/BM25ï¼šæŠ“ç¼–å·ã€æœ¯è¯­ã€å­—æ®µåã€é”™è¯¯ç </li>
<li>å‘é‡å¬å›ï¼šæŠ“è¯­ä¹‰ç›¸è¿‘ã€åŒä¹‰è¡¨è¾¾</li>
<li>èåˆ + é‡æ’ï¼šæŠŠå€™é€‰é›†æ’åºæˆã€Œæœ€èƒ½æ”¯æŒåŠ¨ä½œ/ç»“è®ºã€çš„é‚£å‡ æ®µ</li>
</ul>
<h2 data-id="heading-11">4.2 æ£€ç´¢è¦å…ˆè¿‡æ»¤ï¼Œå†æ‰¾ç›¸ä¼¼</h2>
<p>è¡Œä¸š Agent çš„è¿‡æ»¤é€šå¸¸æ˜¯å¼ºçº¦æŸï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>æƒé™è¿‡æ»¤ï¼ˆç”¨æˆ·/è§’è‰²/ç§Ÿæˆ·/æ•°æ®åŸŸï¼‰</li>
<li>çŠ¶æ€è¿‡æ»¤ï¼ˆåºŸæ­¢ã€è‰ç¨¿é»˜è®¤ä¸è¿›ï¼‰</li>
<li>ç”Ÿæ•ˆæ—¶é—´è¿‡æ»¤ï¼ˆå°¤å…¶åˆ¶åº¦ã€è®¡è´¹ã€åˆè§„ï¼‰</li>
<li>é€‚ç”¨èŒƒå›´è¿‡æ»¤ï¼ˆäº§å“/åœ°åŒº/ç¯å¢ƒï¼‰</li>
<li>æ•°æ®åŸŸéš”ç¦»ï¼ˆå†…éƒ¨/å®¢æˆ·ä¾§/åˆä½œæ–¹ï¼‰</li>
</ul>
<p>å¦‚æœæˆ‘ä»¬æŠŠè¿™äº›ç•™åˆ°ç”Ÿæˆé˜¶æ®µã€Œè®©æ¨¡å‹è‡ªå·±æ³¨æ„ã€ï¼Œæ•ˆæœä¸å¯æ§ï¼Œé£é™©ä¹Ÿä¸å¯æ§ã€‚</p>
<h2 data-id="heading-12">4.3 Agent ä¸“ç”¨æ£€ç´¢</h2>
<p>ä¸æ­¢æ£€ç´¢ç­”æ¡ˆï¼Œè¿˜è¦æ£€ç´¢å·¥å…·ä¸å‚æ•°</p>
<p>è¡Œä¸š Agent ç»å¸¸éœ€è¦ä¸¤ç±»é¢å¤–æ£€ç´¢ï¼š</p>
<ol>
<li>å·¥å…·æ£€ç´¢ï¼ˆTool RAGï¼‰ ä»ã€Œå·¥å…·è¯´æ˜åº“/æ¥å£æ–‡æ¡£/SOPã€é‡Œæ£€ç´¢ï¼šè¯¥ç”¨å“ªä¸ªå·¥å…·ã€éœ€è¦å“ªäº›å‚æ•°ã€æœ‰å“ªäº›é™åˆ¶ã€å¤±è´¥æ€ä¹ˆå¤„ç†ã€‚</li>
<li>å‚æ•°ä¸å­—æ®µæ£€ç´¢ï¼ˆSchema RAGï¼‰ ä»ã€Œæ•°æ®å­—å…¸/å­—æ®µè¯´æ˜/æšä¸¾å€¼ã€é‡Œæ£€ç´¢ï¼šå­—æ®µå«ä¹‰ã€å¯é€‰å€¼ã€æ ¡éªŒè§„åˆ™ã€ç¤ºä¾‹æ ¼å¼ã€‚</li>
</ol>
<p>è¿™ä¸¤ç±»æ£€ç´¢çš„ç»“æœä¸ä¸€å®šç›´æ¥å±•ç¤ºç»™ç”¨æˆ·ï¼Œä½†ä¼šå†³å®š Agent èƒ½ä¸èƒ½æŠŠåŠ¨ä½œåšå¯¹ã€‚</p>
<h2 data-id="heading-13">5. å›ºåŒ– Agent ä½¿ç”¨ RAG çš„é€»è¾‘</h2>
<p>è¡Œä¸š Agent çš„ RAG å…³é”®æ˜¯è¦ã€ŒæŠŠ RAG æ’è¿›å†³ç­–ç‚¹ã€</p>
<p>è¡Œä¸š Agent å¸¸è§çš„å†…éƒ¨å¾ªç¯å¤§è‡´æ˜¯ï¼š</p>
<ul>
<li>Planï¼ˆå†³å®šä¸‹ä¸€æ­¥åšä»€ä¹ˆï¼‰</li>
<li>Actï¼ˆè°ƒç”¨å·¥å…·/æ£€ç´¢/æ‰§è¡Œï¼‰</li>
<li>Observeï¼ˆæ‹¿åˆ°ç»“æœï¼‰</li>
<li>Decideï¼ˆæ˜¯å¦ç»§ç»­ã€æ˜¯å¦éœ€è¦äººç¡®è®¤ã€æ˜¯å¦ç»“æŸï¼‰</li>
<li>Explainï¼ˆå¯¹å¤–è¾“å‡ºï¼‰</li>
</ul>
<p>RAG çš„æ’å…¥ç‚¹å»ºè®®å›ºå®šæˆä¸‰å¤„ï¼š</p>
<h2 data-id="heading-14">5.1 å†³ç­–å‰</h2>
<p>ç”¨ RAG æ‰¾ã€Œè§„åˆ™è¾¹ç•Œã€</p>
<p>åœ¨ Agent åšå‡ºå…³é”®å†³ç­–å‰ï¼Œå…ˆæ£€ç´¢ï¼š</p>
<ul>
<li>æ˜¯å¦å…è®¸æ‰§è¡Œï¼ˆæƒé™ã€åˆè§„ã€é£é™©ç­‰çº§ï¼‰</li>
<li>å‰ç½®æ¡ä»¶æ˜¯ä»€ä¹ˆï¼ˆå¿…é¡»å…·å¤‡å“ªäº›ä¿¡æ¯ã€å“ªäº›ç³»ç»ŸçŠ¶æ€ï¼‰</li>
<li>éœ€è¦çš„å®¡æ‰¹/ç¡®è®¤æ˜¯ä»€ä¹ˆï¼ˆæ˜¯å¦å¿…é¡»äººå·¥ç¡®è®¤ï¼‰</li>
</ul>
<p>è¿™ä¸€æ­¥çš„è¾“å‡ºçš„æ˜¯ã€Œçº¦æŸã€ï¼Œä¸æ˜¯ã€Œç­”æ¡ˆã€ã€‚å®ƒä¼šå½±å“ä¸‹ä¸€æ­¥æ˜¯ç»§ç»­ã€æš‚åœè¿˜æ˜¯è½¬äººå·¥ã€‚</p>
<h2 data-id="heading-15">5.2 æ‰§è¡Œå‰</h2>
<p>ç”¨ RAG æ‰¾ã€Œæ“ä½œæ­¥éª¤ä¸å‚æ•°ã€</p>
<p>æ‰§è¡ŒæŸä¸ªåŠ¨ä½œå‰ï¼Œæ£€ç´¢ï¼š</p>
<ul>
<li>SOP / Runbook / æ¥å£æ–‡æ¡£</li>
<li>å¿…å¡«å‚æ•°ã€å‚æ•°æ¥æº</li>
<li>æ ¡éªŒæ–¹å¼ï¼ˆæ‰§è¡Œåå¦‚ä½•ç¡®è®¤æˆåŠŸï¼‰</li>
<li>å›æ»šæ–¹å¼ï¼ˆå¤±è´¥/å¼‚å¸¸å¦‚ä½•æ’¤é”€ï¼‰</li>
</ul>
<p>è¿™ä¸€æ­¥çš„è¾“å‡ºæ˜¯ã€Œå¯æ‰§è¡Œæ­¥éª¤ã€ï¼Œä¸æ˜¯ã€Œè§£é‡Šæ€§æ®µè½ã€ã€‚</p>
<h2 data-id="heading-16">5.3 æ‰§è¡Œå</h2>
<p>ç”¨ RAG åšã€Œç»“æœåˆ¤å®šä¸é”™è¯¯å¤„ç†ã€</p>
<p>æ‹¿åˆ°å·¥å…·è¿”å›å€¼åï¼Œæ£€ç´¢ï¼š</p>
<ul>
<li>é”™è¯¯ç å«ä¹‰ä¸å¤„ç†å»ºè®®</li>
<li>å¸¸è§å¤±è´¥åŸå› </li>
<li>æ˜¯å¦éœ€è¦å‡çº§/è½¬äººå·¥</li>
<li>æ˜¯å¦éœ€è¦äºŒæ¬¡æ ¡éªŒï¼ˆæ¯”å¦‚è·¨ç³»ç»Ÿä¸€è‡´æ€§ï¼‰</li>
</ul>
<p>è¿™ä¸€æ­¥çš„è¾“å‡ºæ˜¯ã€Œä¸‹ä¸€æ­¥åŠ¨ä½œå»ºè®® + è¯æ®ã€ã€‚</p>
<h2 data-id="heading-17">6. ç”Ÿæˆä¸è¾“å‡º</h2>
<p>è¡Œä¸š Agent çš„è¾“å‡ºè¦åˆ†å±‚ï¼Œä¸è¦æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å†™ç»™ç”¨æˆ·</p>
<p>è¡Œä¸š Agent çš„è¾“å‡ºå»ºè®®æ‹†æˆä¸‰å±‚ï¼Œåˆ†åˆ«æœåŠ¡ä¸åŒç›®æ ‡ï¼š</p>
<ol>
<li>ç”¨æˆ·å±‚ï¼šç»“è®º/è¿›å±•ã€éœ€è¦ç”¨æˆ·è¡¥å……ä»€ä¹ˆã€ä¸‹ä¸€æ­¥æ€ä¹ˆèµ°</li>
<li>è¯æ®å±‚ï¼šå¼•ç”¨ä¾æ®ï¼ˆé“¾æ¥ã€é¡µç ã€ç‰ˆæœ¬ã€ç”Ÿæ•ˆæ—¥æœŸï¼‰</li>
<li>æ‰§è¡Œå±‚ï¼ˆç•™ç—•å±‚ï¼‰ï¼šæœ¬æ¬¡è°ƒç”¨äº†ä»€ä¹ˆå·¥å…·ã€å‚æ•°æ‘˜è¦ã€è¿”å›ç»“æœæ‘˜è¦ã€æ ¡éªŒç»“æœã€å›æ»šç‚¹</li>
</ol>
<p>ç”¨æˆ·ä¸ä¸€å®šè¦çœ‹åˆ°æ‰§è¡Œå±‚ç»†èŠ‚ï¼Œä½†ç³»ç»Ÿå¿…é¡»å­˜å‚¨è¿™äº›å†…å®¹ã€‚åªæœ‰å‡ºäº†é—®é¢˜èƒ½å›æ”¾ï¼Œæ‰æ•¢æ”¾æƒã€‚</p>
<p>åŒæ—¶ï¼Œè¡Œä¸š Agent çš„ç”Ÿæˆè¦æœ‰ç¡¬è§„åˆ™ï¼š</p>
<ul>
<li>æ²¡æœ‰å‘½ä¸­æƒå¨ä¾æ®ï¼šä¸è¾“å‡ºè‚¯å®šç»“è®º</li>
<li>æœ‰å†²çªï¼šå¿…é¡»æŠŠå†²çªæ¥æºã€ç‰ˆæœ¬ã€ç”Ÿæ•ˆæ—¶é—´å†™æ¸…æ¥š</li>
<li>æ¶‰åŠé«˜é£é™©åŠ¨ä½œï¼šå¿…é¡»åœä¸‹æ¥è¯·æ±‚ç¡®è®¤ï¼ˆå¹¶æŠŠä¾æ®ä¸å½±å“èŒƒå›´ç»™å‡ºæ¥ï¼‰</li>
<li>å¼•ç”¨å¿…é¡»æ¥è‡ªæ£€ç´¢ä¸Šä¸‹æ–‡ï¼šä¸å…è®¸æ¥è™šçš„ï¼Œã€Œå‡­å°è±¡è¡¥ä¸€å¥ã€</li>
</ul>
<h2 data-id="heading-18">7. æƒé™ã€å®¡è®¡ã€éš”ç¦»</h2>
<p>**è¡Œä¸š Agent çš„ RAG å¿…é¡»ã€Œæ£€ç´¢å‰éš”ç¦»ã€ã€‚</p>
<p>è¡Œä¸š Agent ä¸€æ—¦èƒ½è°ƒç”¨ç³»ç»Ÿï¼Œé£é™©æ¯”é—®ç­”é«˜ä¸€ä¸ªé‡çº§ã€‚æƒé™è¦åˆ†ä¸¤å±‚ï¼š</p>
<h2 data-id="heading-19">7.1 çŸ¥è¯†æƒé™</h2>
<p>èƒ½ä¸èƒ½çœ‹çš„é—®é¢˜</p>
<ul>
<li>æ–‡æ¡£/çŸ¥è¯†ç‰‡æ®µæŒ‰ ABAC/RBAC åšè¿‡æ»¤</li>
<li>æŒ‰ç§Ÿæˆ·éš”ç¦»ï¼ˆå¤šå®¢æˆ·å¿…åšï¼‰</li>
<li>æŒ‰æ•°æ®åŸŸéš”ç¦»ï¼ˆå†…éƒ¨ç­–ç•¥ã€å®¢æˆ·ä¿¡æ¯ã€åˆä½œæ–¹ä¿¡æ¯ï¼‰</li>
</ul>
<h2 data-id="heading-20">7.2 è¡Œä¸ºæƒé™</h2>
<p>èƒ½ä¸èƒ½åšçš„é—®é¢˜</p>
<ul>
<li>å·¥å…·çº§æƒé™ï¼šè¿™ä¸ªè§’è‰²èƒ½è°ƒç”¨å“ªäº›å·¥å…·</li>
<li>åŠ¨ä½œçº§æƒé™ï¼šåŒä¸€å·¥å…·ä¸‹å“ªäº›æ“ä½œå…è®¸ï¼ˆä¾‹å¦‚åªè¯»æŸ¥è¯¢ vs ä¿®æ”¹/ä¸‹å‘ï¼‰</li>
<li>å‚æ•°çº§æƒé™ï¼šåŒä¸€åŠ¨ä½œä¸‹å“ªäº›èµ„æºèŒƒå›´å…è®¸ï¼ˆä¾‹å¦‚ä»…èƒ½æ“ä½œè‡ªå·±è´Ÿè´£çš„é¡¹ç›®/å®¢æˆ·ï¼‰</li>
</ul>
<p>å¾ˆå¤šå›¢é˜Ÿåªåšäº†ã€ŒçŸ¥è¯†æƒé™ã€ï¼Œæ²¡åšã€Œè¡Œä¸ºæƒé™ã€ã€‚</p>
<p>è¿™ä¼šå¯¼è‡´ä¸æ”¾å¿ƒï¼Œå³ä½¿ Agent èƒ½æŸ¥åˆ° SOPï¼Œä¹Ÿèƒ½å­¦ä¼šã€Œæ€ä¹ˆåšã€ï¼Œä½†ä½ åˆä¸æ•¢è®©å®ƒçœŸçš„åšã€‚</p>
<h2 data-id="heading-21">7.3 å®¡è®¡è¦èƒ½å›ç­”å››ä¸ªé—®é¢˜</h2>
<ul>
<li>ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼ˆä¾æ®æ˜¯ä»€ä¹ˆï¼‰</li>
<li>åšäº†ä»€ä¹ˆï¼ˆè°ƒç”¨äº†å“ªäº›å·¥å…·ã€å…³é”®å‚æ•°æ˜¯ä»€ä¹ˆï¼‰</li>
<li>å¾—åˆ°äº†ä»€ä¹ˆï¼ˆè¿”å›ç»“æœä¸æ ¡éªŒç»“æœï¼‰</li>
<li>è°æ‰¹å‡†çš„ï¼ˆå¦‚æœéœ€è¦äººå·¥ç¡®è®¤ï¼‰</li>
</ul>
<p>æ²¡æœ‰è¿™å››ä¸ªé—®é¢˜çš„ç­”æ¡ˆï¼Œè¡Œä¸š Agent å¾ˆéš¾é€šè¿‡å®‰å…¨å®¡æŸ¥ï¼Œä¹Ÿå¾ˆéš¾åœ¨å‡ºäº‹åå®šä½è´£ä»»ä¸ä¿®å¤ç‚¹ã€‚</p>
<h2 data-id="heading-22">8. ç°åº¦ä¸Šçº¿ç­–ç•¥</h2>
<p>å…ˆæ§åˆ¶é£é™©ï¼Œå†è°ˆè¦†ç›–ç‡</p>
<p>è¡Œä¸š Agent çš„ä¸Šçº¿èŠ‚å¥å»ºè®®æŒ‰æƒé™é€æ­¥æ”¾å¼€ï¼š</p>
<ol>
<li>åªè¯» Agentï¼šåªæ£€ç´¢ã€åªè§£é‡Šã€åªç»™å»ºè®®ï¼Œä¸æ‰§è¡Œä»»ä½•å†™æ“ä½œ</li>
<li>åŠè‡ªåŠ¨ Agentï¼šå¯ä»¥ç”Ÿæˆâ€œæ‰§è¡Œè®¡åˆ’/å·¥å•è‰ç¨¿/å˜æ›´å•è‰ç¨¿â€ï¼Œå¿…é¡»äººå·¥ç¡®è®¤åæ‰§è¡Œ</li>
<li>å—é™è‡ªåŠ¨ Agentï¼šåªå…è®¸ä½é£é™©ã€å¯å›æ»šã€å¯æ ¡éªŒçš„åŠ¨ä½œè‡ªåŠ¨æ‰§è¡Œï¼ˆä¾‹å¦‚æŸ¥è¯¢ã€å¯¹è´¦ã€ç”ŸæˆæŠ¥è¡¨ã€åˆ›å»ºå·¥å•ã€è¡¥å…¨å­—æ®µï¼‰</li>
<li>é«˜é£é™©åŠ¨ä½œï¼šé»˜è®¤ä¿ç•™äººå·¥ç¡®è®¤ï¼Œé™¤éä½ èƒ½åšåˆ°ä¸¥æ ¼çš„æƒé™ã€æ ¡éªŒã€å›æ»šã€å®¡è®¡ï¼Œå¹¶ä¸”æœ‰æ˜ç¡®çš„è´£ä»»è¾¹ç•Œ</li>
</ol>
<p>ä¸Šçº¿å¿…é¡»å‡†å¤‡ä¸‰å¥—å…œåº•ï¼š</p>
<ul>
<li>è¶…æ—¶ä¸é™çº§ï¼šæ£€ç´¢å¤±è´¥/é‡æ’å¤±è´¥/æ¨¡å‹å¤±è´¥æ—¶æ€ä¹ˆé€€åŒ–</li>
<li>å¤±è´¥å›æ»šï¼šæ‰§è¡Œå¤±è´¥æ€ä¹ˆæ’¤é”€ï¼Œæ’¤é”€å¤±è´¥æ€ä¹ˆå‡çº§</li>
<li>äººå·¥æ¥ç®¡ï¼šåœ¨å…³é”®èŠ‚ç‚¹èƒ½ä¸€é”®è½¬äººå·¥ï¼Œå¹¶æŠŠè¯æ®ä¸æ‰§è¡Œè½¨è¿¹å¸¦è¿‡å»</li>
</ul>
<h2 data-id="heading-23">9. å¸¸è§å‘</h2>
<ol>
<li>æŠŠã€Œç»éªŒå·¥å•ã€å½“ã€Œæ ‡å‡†ç­”æ¡ˆã€ï¼šAgent ä¼šæŠŠå¶å‘å¤„ç†å½“æˆé€šç”¨è§„åˆ™ã€‚å¿…é¡»åˆ†çº§ä¸é™æƒã€‚</li>
<li>åªåšçŸ¥è¯†åº“ï¼Œä¸åšæ•°æ®å­—å…¸ä¸å·¥å…·åº“ï¼šAgent ä¼šä¸çŸ¥é“å‚æ•°æ€ä¹ˆå¡«ã€å­—æ®µæ˜¯ä»€ä¹ˆæ„æ€ã€é”™è¯¯ç æ€ä¹ˆè§£ã€‚</li>
<li>åªåšæ£€ç´¢ï¼Œä¸åšæ‰§è¡Œå‰æ ¡éªŒä¸æ‰§è¡Œåæ ¡éªŒï¼šæ•¢æ‰§è¡Œçš„å‰ææ˜¯å¯æ ¡éªŒã€å¯å›æ»šã€‚</li>
<li>æƒé™åªç®¡æ–‡æ¡£ï¼Œä¸ç®¡å·¥å…·ï¼šæœ€å®¹æ˜“åœ¨è¿™é‡Œç¿»è½¦ã€‚</li>
<li>æ²¡æœ‰å›æ”¾è¯„æµ‹ï¼šä½ ä¸çŸ¥é“ä¸€æ¬¡å°æ”¹åŠ¨ä¼šä¸ä¼šè®© Agent åœ¨æŸä¸ªåˆ†æ”¯ä¸Šå¼€å§‹ä¹±èµ°ã€‚</li>
<li>æŠŠã€Œå¤šè½®å¯¹è¯ã€å½“ã€Œä»»åŠ¡ç¼–æ’ã€ï¼šè¡Œä¸š Agent çš„å…³é”®æ˜¯çŠ¶æ€æœºä¸å†³ç­–ç‚¹ï¼Œä¸æ˜¯èŠå¾—å¤šã€‚</li>
</ol>
<p>æœ€åï¼Œè¡Œä¸š Agent çš„ RAG å¦‚æœè¦æ„å»ºï¼Œä¸ä»…ä»…æ˜¯ç®—æ³•çš„äº‹æƒ…ï¼Œéœ€è¦æ›´å¤šçš„ä¸šåŠ¡ä¸“å®¶ï¼Œä¸šåŠ¡ Owner æ¥ç›´æ¥å‚ä¸ï¼Œä»–ä»¬æ‰æ˜¯æœ€æ‡‚è¡Œä¸šçš„äººã€‚éœ€è¦ä»–ä»¬æ¥å®šä¹‰ã€Œä»€ä¹ˆç®—ç­”å¯¹/ç­”é”™ã€ã€å“ªäº›æ–‡æ¡£æƒå¨ã€ç‰ˆæœ¬å¦‚ä½•å–èˆã€å“ªäº›å†…å®¹ä¸èƒ½ç­”ã€‚</p>
<p>ä»¥ä¸Šã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flowableåœ¨çº¿æµç¨‹å›¾ç»˜åˆ¶ï¼šä»å…¥é—¨åˆ°å®æˆ˜]]></title>    <link>https://juejin.cn/post/7601073900525469738</link>    <guid>https://juejin.cn/post/7601073900525469738</guid>    <pubDate>2026-02-01T01:25:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601073900525469738" data-draft-id="7601159804490170387" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flowableåœ¨çº¿æµç¨‹å›¾ç»˜åˆ¶ï¼šä»å…¥é—¨åˆ°å®æˆ˜"/> <meta itemprop="keywords" content="Java,å·¥ä½œæµå¼•æ“"/> <meta itemprop="datePublished" content="2026-02-01T01:25:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flowableåœ¨çº¿æµç¨‹å›¾ç»˜åˆ¶ï¼šä»å…¥é—¨åˆ°å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T01:25:12.000Z" title="Sun Feb 01 2026 01:25:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Flowableåœ¨çº¿æµç¨‹å›¾ç»˜åˆ¶ï¼šä»å…¥é—¨åˆ°å®æˆ˜</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>åœ¨ä¼ä¸šçº§åº”ç”¨å¼€å‘ä¸­ï¼Œå·¥ä½œæµå¼•æ“æ˜¯ä¸å¯æˆ–ç¼ºçš„ç»„ä»¶ã€‚Flowableä½œä¸ºä¸€ä¸ªè½»é‡çº§ã€å¼€æºçš„å·¥ä½œæµå’Œä¸šåŠ¡æµç¨‹ç®¡ç†ï¼ˆBPMï¼‰å¹³å°ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå„ç±»ä¸šåŠ¡ç³»ç»Ÿä¸­ã€‚ç„¶è€Œï¼Œä¼ ç»Ÿçš„æµç¨‹è®¾è®¡æ–¹å¼éœ€è¦å€ŸåŠ©ä¸“é—¨çš„å»ºæ¨¡å·¥å…·ï¼ˆå¦‚Flowable Modelerã€Camunda Modelerç­‰ï¼‰ï¼Œæ“ä½œå¤æ‚ä¸”ä¸å¤Ÿç›´è§‚ã€‚</p>
<p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åŸºäº <strong>Flowable 6.8.0</strong> å’Œ <strong>bpmn-js</strong> æ„å»ºä¸€ä¸ªåœ¨çº¿æµç¨‹å›¾ç»˜åˆ¶ç³»ç»Ÿï¼Œå®ç°ï¼š</p>
<ul>
<li>åœ¨çº¿ç»˜åˆ¶ BPMN 2.0 æµç¨‹å›¾</li>
<li>æµç¨‹å®šä¹‰ä¿å­˜åˆ° MySQL æ•°æ®åº“</li>
<li>ä¸€é”®éƒ¨ç½²æµç¨‹åˆ° Flowable å¼•æ“</li>
<li>å®Œæ•´çš„å‰åç«¯åˆ†ç¦»æ¶æ„ <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7de15bdeb0d419e8e11f1590058fca8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770513912&amp;x-signature=z%2FRH4izxA015q9ixlQAA3%2BZ7K1U%3D" alt="" loading="lazy"/></li>
</ul>
<hr/>
<h3 data-id="heading-2">ä¸€ã€ä¸ºä»€ä¹ˆé€‰æ‹© bpmn-jsï¼Ÿ</h3>
<h4 data-id="heading-3">1.1 bpmn-js ç®€ä»‹</h4>
<p><strong>bpmn-js</strong> æ˜¯ä¸€ä¸ªç”± Camunda å¼€å‘çš„ BPMN 2.0 å»ºæ¨¡å·¥å…·åº“ï¼Œçº¯ JavaScript å®ç°ï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚å®ƒæä¾›äº†ï¼š</p>
<ul>
<li><strong>å®Œæ•´çš„ BPMN 2.0 æ”¯æŒ</strong>ï¼šæ”¯æŒæ‰€æœ‰ BPMN 2.0 å…ƒç´ å’Œå±æ€§</li>
<li><strong>è½»é‡çº§</strong>ï¼šæ— éœ€å®‰è£…ä»»ä½•æ’ä»¶æˆ–è½¯ä»¶</li>
<li><strong>å¯å®šåˆ¶</strong>ï¼šæ”¯æŒè‡ªå®šä¹‰æ ·å¼å’Œè¡Œä¸º</li>
<li><strong>å¼€æºå…è´¹</strong>ï¼šé‡‡ç”¨å¼€æºåè®®ï¼Œå¯å•†ç”¨</li>
</ul>
<h4 data-id="heading-4">1.2 bpmn-js vs ä¼ ç»Ÿå»ºæ¨¡å·¥å…·</h4>









































<table><thead><tr><th>ç‰¹æ€§</th><th>bpmn-js</th><th>Flowable Modeler</th><th>Eclipse Plugin</th></tr></thead><tbody><tr><td>å®‰è£…æ–¹å¼</td><td>æ— éœ€å®‰è£…</td><td>éœ€è¦éƒ¨ç½²</td><td>éœ€è¦å®‰è£…</td></tr><tr><td>ä½¿ç”¨ç¯å¢ƒ</td><td>æµè§ˆå™¨</td><td>ç‹¬ç«‹åº”ç”¨</td><td>Eclipse IDE</td></tr><tr><td>åä½œæ”¯æŒ</td><td>æ˜“äºé›†æˆ</td><td>å›°éš¾</td><td>å›°éš¾</td></tr><tr><td>å®šåˆ¶èƒ½åŠ›</td><td>é«˜</td><td>ä¸­</td><td>ä½</td></tr><tr><td>å­¦ä¹ æ›²çº¿</td><td>å¹³ç¼“</td><td>é™¡å³­</td><td>é™¡å³­</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-5">äºŒã€ç³»ç»Ÿæ¶æ„è®¾è®¡</h3>
<h4 data-id="heading-6">2.1 æ•´ä½“æ¶æ„</h4>
<p>æœ¬ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»çš„æ¶æ„è®¾è®¡ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å±‚æ¬¡ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f7e7207965d4f3b8c4e8da2fd12545f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770513912&amp;x-signature=zO1Mq127%2FVO9E3kScA1qOytvYDg%3D" alt="" loading="lazy"/></p>
<p><strong>è¡¨ç°å±‚ï¼ˆPresentation Layerï¼‰</strong></p>
<ul>
<li>Vue.js 3.x å‰ç«¯æ¡†æ¶</li>
<li>bpmn-js æµç¨‹è®¾è®¡å™¨</li>
<li>Element Plus UI ç»„ä»¶åº“</li>
</ul>
<p><strong>ä¸šåŠ¡æœåŠ¡å±‚ï¼ˆBusiness Service Layerï¼‰</strong></p>
<ul>
<li>Spring Boot 2.7 åº”ç”¨æ¡†æ¶</li>
<li>æµç¨‹è®¾è®¡æœåŠ¡ã€éƒ¨ç½²æœåŠ¡ã€å®ä¾‹æœåŠ¡</li>
<li>RESTful API æ¥å£å±‚</li>
</ul>
<p><strong>æµç¨‹å¼•æ“å±‚ï¼ˆProcess Engine Layerï¼‰</strong></p>
<ul>
<li>Flowable 6.8.0 æµç¨‹å¼•æ“</li>
<li>æµç¨‹å®šä¹‰å¼•æ“ã€ä»»åŠ¡å¼•æ“ã€å†å²å¼•æ“</li>
</ul>
<p><strong>æ•°æ®å­˜å‚¨å±‚ï¼ˆData Storage Layerï¼‰</strong></p>
<ul>
<li>MySQL 8.0 å­˜å‚¨æµç¨‹å®šä¹‰ã€å®ä¾‹ã€ä»»åŠ¡æ•°æ®</li>
<li>Redis 6.x ç¼“å­˜ã€ä¼šè¯ç®¡ç†</li>
<li>MinIO å¯¹è±¡å­˜å‚¨ï¼ˆå¯é€‰ï¼‰</li>
</ul>
<h4 data-id="heading-7">2.2 æ ¸å¿ƒäº¤äº’æµç¨‹</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e115f78f4c02478da8565b56fd06d2f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770513912&amp;x-signature=eBqEGE6CCtifXbjYQ2qeiNmMlgo%3D" alt="" loading="lazy"/></p>
<ol>
<li>ç”¨æˆ·åœ¨å‰ç«¯ç•Œé¢ç‚¹å‡»"æ–°å»ºæµç¨‹"</li>
<li>å‰ç«¯è¯·æ±‚åç«¯ API åˆ›å»ºæµç¨‹å®šä¹‰</li>
<li>åç«¯è°ƒç”¨ Flowable çš„ RepositoryService</li>
<li>Flowable å¼•æ“å°†æµç¨‹å®šä¹‰ä¿å­˜åˆ°æ•°æ®åº“</li>
<li>è¿”å›æµç¨‹å®šä¹‰ ID ç»™å‰ç«¯</li>
<li>ç”¨æˆ·ä½¿ç”¨ bpmn-js ç»˜åˆ¶æµç¨‹å›¾</li>
<li>ä¿å­˜æ—¶å°† BPMN XML å‘é€åˆ°åç«¯</li>
<li>åç«¯æ›´æ–°æ•°æ®åº“ä¸­çš„æµç¨‹å®šä¹‰</li>
</ol>
<hr/>
<h3 data-id="heading-8">ä¸‰ã€ç¯å¢ƒå‡†å¤‡</h3>
<h4 data-id="heading-9">3.1 å¼€å‘ç¯å¢ƒè¦æ±‚</h4>






























<table><thead><tr><th>è½¯ä»¶</th><th>ç‰ˆæœ¬</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>JDK</td><td>1.8+</td><td>Java å¼€å‘ç¯å¢ƒ</td></tr><tr><td>Maven</td><td>3.6+</td><td>é¡¹ç›®æ„å»ºå·¥å…·</td></tr><tr><td>MySQL</td><td>5.7+ æˆ– 8.0+</td><td>å…³ç³»æ•°æ®åº“</td></tr><tr><td>Node.js</td><td>14+</td><td>å‰ç«¯å¼€å‘ï¼ˆå¯é€‰ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-10">3.2 æŠ€æœ¯æ ˆç‰ˆæœ¬</h4>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b719cf3fee86465495c566a9e90b430b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770513912&amp;x-signature=JQAcSNmiB0dEVcMlBP0lxPRcwYA%3D" alt="" loading="lazy"/></p>
<p><strong>åç«¯æŠ€æœ¯æ ˆ</strong></p>
<ul>
<li>Spring Boot 2.7.18</li>
<li>Flowable 6.8.0</li>
<li>MyBatis Plus 3.5.2</li>
<li>MySQL Connector 8.0.28</li>
</ul>
<p><strong>å‰ç«¯æŠ€æœ¯æ ˆ</strong></p>
<ul>
<li>bpmn-js 14.0.0</li>
<li>jQuery 3.6.0</li>
<li>Bootstrap 5ï¼ˆå¯é€‰ï¼‰</li>
</ul>
<hr/>
<h3 data-id="heading-11">å››ã€é¡¹ç›®åˆå§‹åŒ–</h3>
<h4 data-id="heading-12">4.1 åˆ›å»º Maven é¡¹ç›®</h4>
<p>ä½¿ç”¨ Spring Initializr åˆ›å»ºé¡¹ç›®ï¼Œæˆ–æ‰‹åŠ¨åˆ›å»º <code>pom.xml</code>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.18<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
Â Â Â Â <span class="hljs-comment">&lt;!--Â FlowableÂ StarterÂ --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.flowable<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>flowable-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.8.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â Â Â Â <span class="hljs-comment">&lt;!--Â MyBatisÂ PlusÂ --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â Â Â Â <span class="hljs-comment">&lt;!--Â MySQLÂ DriverÂ --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.28<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h4 data-id="heading-13">4.2 æ•°æ®åº“åˆå§‹åŒ–</h4>
<p>åˆ›å»ºæ•°æ®åº“å’Œæµç¨‹å®šä¹‰è¡¨ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span>Â DATABASEÂ flowable_onlineÂ <span class="hljs-type">CHARACTER</span>Â <span class="hljs-keyword">SET</span>Â utf8mb4Â <span class="hljs-keyword">COLLATE</span>Â utf8mb4_unicode_ci;

USEÂ flowable_online;

<span class="hljs-keyword">CREATE</span>Â <span class="hljs-keyword">TABLE</span>Â flow_definitionÂ (
Â Â Â Â idÂ <span class="hljs-type">BIGINT</span>Â AUTO_INCREMENTÂ <span class="hljs-keyword">PRIMARY</span>Â KEY,
Â Â Â Â process_keyÂ <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>)Â <span class="hljs-keyword">NOT</span>Â <span class="hljs-keyword">NULL</span>,
Â Â Â Â process_nameÂ <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>)Â <span class="hljs-keyword">NOT</span>Â <span class="hljs-keyword">NULL</span>,
Â Â Â Â versionÂ <span class="hljs-type">INT</span>Â <span class="hljs-keyword">NOT</span>Â <span class="hljs-keyword">NULL</span>Â <span class="hljs-keyword">DEFAULT</span>Â <span class="hljs-number">1</span>,
Â Â Â Â bpmn_xmlÂ LONGTEXTÂ <span class="hljs-keyword">NOT</span>Â <span class="hljs-keyword">NULL</span>,
Â Â Â Â descriptionÂ TEXT,
Â Â Â Â categoryÂ <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>),
Â Â Â Â created_byÂ <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>),
Â Â Â Â deployedÂ TINYINTÂ <span class="hljs-keyword">DEFAULT</span>Â <span class="hljs-number">0</span>,
Â Â Â Â deployment_idÂ <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>),
Â Â Â Â create_timeÂ DATETIMEÂ <span class="hljs-keyword">DEFAULT</span>Â <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
Â Â Â Â update_timeÂ DATETIMEÂ <span class="hljs-keyword">DEFAULT</span>Â <span class="hljs-built_in">CURRENT_TIMESTAMP</span>Â <span class="hljs-keyword">ON</span>Â <span class="hljs-keyword">UPDATE</span>Â <span class="hljs-built_in">CURRENT_TIMESTAMP</span>,
Â Â Â Â deletedÂ TINYINTÂ <span class="hljs-keyword">DEFAULT</span>Â <span class="hljs-number">0</span>,
Â Â Â Â <span class="hljs-keyword">UNIQUE</span>Â KEYÂ uk_process_key_versionÂ (process_key,Â version,Â deleted)
);
</code></pre>
<h3 data-id="heading-14">äº”ã€åç«¯å®ç°</h3>
<h4 data-id="heading-15">5.1 å®ä½“ç±»è®¾è®¡</h4>
<p>åˆ›å»ºæµç¨‹å®šä¹‰å®ä½“ç±»ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Data</span>
<span class="hljs-meta">@TableName</span>(<span class="hljs-string">"flow_definition"</span>)
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">FlowDefinition</span>Â {
Â Â Â Â <span class="hljs-meta">@TableId</span>(<span class="hljs-keyword">type</span>Â =Â <span class="hljs-title class_">IdType</span>.<span class="hljs-property">AUTO</span>)
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Long</span>Â id;

Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">String</span>Â processKey;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">String</span>Â processName;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Integer</span>Â version;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">String</span>Â bpmnXml;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">String</span>Â description;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">String</span>Â category;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">String</span>Â createdBy;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Integer</span>Â deployed;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">String</span>Â deploymentId;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">LocalDateTime</span>Â createTime;
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">LocalDateTime</span>Â updateTime;

Â Â Â Â <span class="hljs-meta">@TableLogic</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Integer</span>Â deleted;
}
</code></pre>
<h4 data-id="heading-16">5.2 æ•°æ®è®¿é—®å±‚</h4>
<p>ä½¿ç”¨ MyBatis Plus çš„ Mapper æ¥å£ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Mapper</span>
publicÂ interfaceÂ FlowDefinitionMapperÂ extendsÂ BaseMapper&lt;FlowDefinition&gt;Â {
Â Â Â Â <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">FlowDefinition</span>&gt;Â <span class="hljs-selector-tag">selectByProcessKey</span>(<span class="hljs-variable">@Param</span>(<span class="hljs-string">"processKey"</span>)Â StringÂ processKey);
Â Â Â Â <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">FlowDefinition</span>&gt;Â <span class="hljs-selector-tag">selectByCreatedBy</span>(<span class="hljs-variable">@Param</span>(<span class="hljs-string">"createdBy"</span>)Â StringÂ createdBy);
}
</code></pre>
<h4 data-id="heading-17">5.3 æœåŠ¡å±‚å®ç°</h4>
<p>æµç¨‹è®¾è®¡æ ¸å¿ƒæœåŠ¡ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">package</span>Â com.example.flowable.service;

<span class="hljs-keyword">import</span>Â com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;
<span class="hljs-keyword">import</span>Â com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
<span class="hljs-keyword">import</span>Â com.example.flowable.entity.FlowDefinition;
<span class="hljs-keyword">import</span>Â com.example.flowable.entity.Result;
<span class="hljs-keyword">import</span>Â com.example.flowable.exception.FlowableException;
<span class="hljs-keyword">import</span>Â com.example.flowable.repository.FlowDefinitionMapper;
<span class="hljs-keyword">import</span>Â lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span>Â org.flowable.engine.RepositoryService;
<span class="hljs-keyword">import</span>Â org.flowable.engine.repository.Deployment;
<span class="hljs-keyword">import</span>Â org.flowable.engine.repository.ProcessDefinition;
<span class="hljs-keyword">import</span>Â org.springframework.beans.factory.<span class="hljs-keyword">annotation</span>.Autowired;
<span class="hljs-keyword">import</span>Â org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span>Â org.springframework.transaction.<span class="hljs-keyword">annotation</span>.Transactional;
<span class="hljs-keyword">import</span>Â org.springframework.util.StringUtils;

<span class="hljs-keyword">import</span>Â java.io.ByteArrayOutputStream;
<span class="hljs-keyword">import</span>Â java.io.IOException;
<span class="hljs-keyword">import</span>Â java.io.InputStream;
<span class="hljs-keyword">import</span>Â java.nio.charset.StandardCharsets;
<span class="hljs-keyword">import</span>Â java.time.LocalDateTime;
<span class="hljs-keyword">import</span>Â java.util.List;
<span class="hljs-keyword">import</span>Â java.util.zip.ZipInputStream;

<span class="hljs-comment">/**
Â *Â æµç¨‹è®¾è®¡æœåŠ¡å®ç°ç±»
Â *Â æä¾›æµç¨‹å®šä¹‰çš„ä¿å­˜ã€æŸ¥è¯¢ã€åˆ é™¤ã€éƒ¨ç½²ç­‰åŠŸèƒ½
Â *Â <span class="hljs-doctag">@version</span>Â 1.0.0
Â */</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">FlowDesignService</span>Â <span class="hljs-title">extends</span>Â <span class="hljs-title">ServiceImpl</span>&lt;<span class="hljs-type">FlowDefinitionMapper,Â FlowDefinition</span>&gt;Â {

Â Â Â Â <span class="hljs-meta">@Autowired</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â FlowDefinitionMapperÂ flowDefinitionMapper;

Â Â Â Â <span class="hljs-meta">@Autowired</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â RepositoryServiceÂ repositoryService;

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â ä¿å­˜æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â flowDefinitionÂ æµç¨‹å®šä¹‰å®ä½“
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â ä¿å­˜ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Transactional(rollbackForÂ =Â Exception.class)</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;FlowDefinition&gt;Â saveFlowDefinition(FlowDefinitionÂ flowDefinition)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â éªŒè¯å¿…å¡«å­—æ®µ</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (!StringUtils.hasText(flowDefinition.getProcessKey()))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹Keyä¸èƒ½ä¸ºç©º"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (!StringUtils.hasText(flowDefinition.getProcessName()))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹åç§°ä¸èƒ½ä¸ºç©º"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (!StringUtils.hasText(flowDefinition.getBpmnXml()))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"BPMNÂ XMLå†…å®¹ä¸èƒ½ä¸ºç©º"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ£€æŸ¥æµç¨‹Keyæ˜¯å¦å·²å­˜åœ¨ï¼ˆåŒç‰ˆæœ¬ï¼‰</span>
Â Â Â Â Â Â Â Â Â Â Â Â QueryWrapper&lt;FlowDefinition&gt;Â queryWrapperÂ =Â newÂ QueryWrapper&lt;&gt;();
Â Â Â Â Â Â Â Â Â Â Â Â queryWrapper.eq(<span class="hljs-string">"process_key"</span>,Â flowDefinition.getProcessKey())
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .eq(<span class="hljs-string">"version"</span>,Â flowDefinition.getVersion()Â !=Â <span class="hljs-literal">null</span>Â ?Â flowDefinition.getVersion()Â :Â <span class="hljs-number">1</span>)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .eq(<span class="hljs-string">"deleted"</span>,Â <span class="hljs-number">0</span>);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">Long</span>Â countÂ =Â flowDefinitionMapper.selectCount(queryWrapper);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (countÂ &gt;Â <span class="hljs-number">0</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹Keyå’Œç‰ˆæœ¬å·å·²å­˜åœ¨ï¼Œè¯·ä¿®æ”¹ç‰ˆæœ¬å·"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è®¾ç½®é»˜è®¤å€¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (flowDefinition.getVersion()Â ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.setVersion(<span class="hljs-number">1</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (flowDefinition.getCreateTime()Â ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.setCreateTime(LocalDateTime.now());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.setUpdateTime(LocalDateTime.now());
Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.setDeleted(<span class="hljs-number">0</span>);
Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.setDeployed(<span class="hljs-number">0</span>);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ä¿å­˜åˆ°æ•°æ®åº“</span>
Â Â Â Â Â Â Â Â Â Â Â Â flowDefinitionMapper.insert(flowDefinition);

Â Â Â Â Â Â Â Â Â Â Â Â log.info(<span class="hljs-string">"ä¿å­˜æµç¨‹å®šä¹‰æˆåŠŸ:Â id={},Â key={},Â name={}"</span>,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.getId(),Â flowDefinition.getProcessKey(),Â flowDefinition.getProcessName());

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(<span class="hljs-string">"æµç¨‹å®šä¹‰ä¿å­˜æˆåŠŸ"</span>,Â flowDefinition);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"ä¿å­˜æµç¨‹å®šä¹‰å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"ä¿å­˜æµç¨‹å®šä¹‰å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ›´æ–°æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â flowDefinitionÂ æµç¨‹å®šä¹‰å®ä½“
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â æ›´æ–°ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Transactional(rollbackForÂ =Â Exception.class)</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;FlowDefinition&gt;Â updateFlowDefinition(FlowDefinitionÂ flowDefinition)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (flowDefinition.getId()Â ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹å®šä¹‰IDä¸èƒ½ä¸ºç©º"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â FlowDefinitionÂ existingÂ =Â flowDefinitionMapper.selectById(flowDefinition.getId());
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (existingÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹å®šä¹‰ä¸å­˜åœ¨"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å·²éƒ¨ç½²çš„æµç¨‹ä¸èƒ½ä¿®æ”¹</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (existing.getDeployed()Â ==Â <span class="hljs-number">1</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"å·²éƒ¨ç½²çš„æµç¨‹ä¸èƒ½ä¿®æ”¹ï¼Œè¯·æ–°å»ºç‰ˆæœ¬"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.setUpdateTime(LocalDateTime.now());
Â Â Â Â Â Â Â Â Â Â Â Â intÂ rowsÂ =Â flowDefinitionMapper.updateById(flowDefinition);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (rowsÂ &gt;Â <span class="hljs-number">0</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.info(<span class="hljs-string">"æ›´æ–°æµç¨‹å®šä¹‰æˆåŠŸ:Â id={}"</span>,Â flowDefinition.getId());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(<span class="hljs-string">"æµç¨‹å®šä¹‰æ›´æ–°æˆåŠŸ"</span>,Â flowDefinition);
Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æ›´æ–°æµç¨‹å®šä¹‰å¤±è´¥"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"æ›´æ–°æµç¨‹å®šä¹‰å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æ›´æ–°æµç¨‹å®šä¹‰å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ é™¤æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â idÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â åˆ é™¤ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Transactional(rollbackForÂ =Â Exception.class)</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;<span class="hljs-built_in">Void</span>&gt;Â deleteFlowDefinition(<span class="hljs-built_in">Long</span>Â id)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â FlowDefinitionÂ flowDefinitionÂ =Â flowDefinitionMapper.selectById(id);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (flowDefinitionÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹å®šä¹‰ä¸å­˜åœ¨"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é€»è¾‘åˆ é™¤</span>
Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.setDeleted(<span class="hljs-number">1</span>);
Â Â Â Â Â Â Â Â Â Â Â Â flowDefinition.setUpdateTime(LocalDateTime.now());
Â Â Â Â Â Â Â Â Â Â Â Â flowDefinitionMapper.updateById(flowDefinition);

Â Â Â Â Â Â Â Â Â Â Â Â log.info(<span class="hljs-string">"åˆ é™¤æµç¨‹å®šä¹‰æˆåŠŸ:Â id={}"</span>,Â id);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(<span class="hljs-string">"æµç¨‹å®šä¹‰åˆ é™¤æˆåŠŸ"</span>);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"åˆ é™¤æµç¨‹å®šä¹‰å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"åˆ é™¤æµç¨‹å®šä¹‰å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ ¹æ®IDæŸ¥è¯¢æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â idÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â æŸ¥è¯¢ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;FlowDefinition&gt;Â getFlowDefinitionById(<span class="hljs-built_in">Long</span>Â id)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â FlowDefinitionÂ flowDefinitionÂ =Â flowDefinitionMapper.selectById(id);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (flowDefinitionÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹å®šä¹‰ä¸å­˜åœ¨"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(flowDefinition);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"æŸ¥è¯¢æµç¨‹å®šä¹‰å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æŸ¥è¯¢æµç¨‹å®šä¹‰å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æŸ¥è¯¢æ‰€æœ‰æµç¨‹å®šä¹‰åˆ—è¡¨
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â æµç¨‹å®šä¹‰åˆ—è¡¨
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;List&lt;FlowDefinition&gt;&gt;Â getAllFlowDefinitions()Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â QueryWrapper&lt;FlowDefinition&gt;Â queryWrapperÂ =Â newÂ QueryWrapper&lt;&gt;();
Â Â Â Â Â Â Â Â Â Â Â Â queryWrapper.eq(<span class="hljs-string">"deleted"</span>,Â <span class="hljs-number">0</span>)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .orderByDesc(<span class="hljs-string">"create_time"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â List&lt;FlowDefinition&gt;Â listÂ =Â flowDefinitionMapper.selectList(queryWrapper);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(list);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"æŸ¥è¯¢æµç¨‹å®šä¹‰åˆ—è¡¨å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æŸ¥è¯¢æµç¨‹å®šä¹‰åˆ—è¡¨å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â éƒ¨ç½²æµç¨‹åˆ°Flowableå¼•æ“
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â idÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â éƒ¨ç½²ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Transactional(rollbackForÂ =Â Exception.class)</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;Deployment&gt;Â deployFlowDefinition(<span class="hljs-built_in">Long</span>Â id)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â FlowDefinitionÂ flowDefinitionÂ =Â flowDefinitionMapper.selectById(id);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (flowDefinitionÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹å®šä¹‰ä¸å­˜åœ¨"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (flowDefinition.getDeployed()Â ==Â <span class="hljs-number">1</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"è¯¥æµç¨‹å·²ç»éƒ¨ç½²è¿‡äº†"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â éƒ¨ç½²åˆ°Flowableå¼•æ“</span>
Â Â Â Â Â Â Â Â Â Â Â Â StringÂ deploymentNameÂ =Â flowDefinition.getProcessName()Â +Â <span class="hljs-string">".bpmn20.xml"</span>;
Â Â Â Â Â Â Â Â Â Â Â Â DeploymentÂ deploymentÂ =Â repositoryService.createDeployment()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .name(flowDefinition.getProcessName())
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .category(flowDefinition.getCategory())
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .addBytes(deploymentName,Â flowDefinition.getBpmnXml().getBytes(StandardCharsets.UTF_8))
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .deploy();

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ›´æ–°éƒ¨ç½²çŠ¶æ€</span>
Â Â Â Â Â Â Â Â Â Â Â Â flowDefinitionMapper.updateDeployStatus(id,Â <span class="hljs-number">1</span>,Â deployment.getId());

Â Â Â Â Â Â Â Â Â Â Â Â log.info(<span class="hljs-string">"éƒ¨ç½²æµç¨‹æˆåŠŸ:Â id={},Â deploymentId={}"</span>,Â id,Â deployment.getId());
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(<span class="hljs-string">"æµç¨‹éƒ¨ç½²æˆåŠŸ"</span>,Â deployment);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"éƒ¨ç½²æµç¨‹å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"éƒ¨ç½²æµç¨‹å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–Flowableæµç¨‹å®šä¹‰åˆ—è¡¨
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â æµç¨‹å®šä¹‰åˆ—è¡¨
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;List&lt;ProcessDefinition&gt;&gt;Â getFlowableProcessDefinitions()Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â List&lt;ProcessDefinition&gt;Â listÂ =Â repositoryService.createProcessDefinitionQuery()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .orderByProcessDefinitionVersion()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .desc()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .list();
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(list);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"è·å–Flowableæµç¨‹å®šä¹‰åˆ—è¡¨å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"è·å–æµç¨‹å®šä¹‰åˆ—è¡¨å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ ¹æ®æµç¨‹Keyè·å–æœ€æ–°ç‰ˆæœ¬çš„æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â processKeyÂ æµç¨‹Key
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â æµç¨‹å®šä¹‰
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;ProcessDefinition&gt;Â getLatestProcessDefinitionByKey(StringÂ processKey)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â ProcessDefinitionÂ processDefinitionÂ =Â repositoryService.createProcessDefinitionQuery()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .processDefinitionKey(processKey)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .latestVersion()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .singleResult();

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (processDefinitionÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹å®šä¹‰ä¸å­˜åœ¨"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(processDefinition);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"è·å–æµç¨‹å®šä¹‰å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"è·å–æµç¨‹å®šä¹‰å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å¯¼å‡ºæµç¨‹å®šä¹‰XML
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â idÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â BPMNÂ XMLå­—ç¬¦ä¸²
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;String&gt;Â exportFlowDefinitionXml(<span class="hljs-built_in">Long</span>Â id)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â FlowDefinitionÂ flowDefinitionÂ =Â flowDefinitionMapper.selectById(id);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (flowDefinitionÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹å®šä¹‰ä¸å­˜åœ¨"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(flowDefinition.getBpmnXml());
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"å¯¼å‡ºæµç¨‹å®šä¹‰å¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"å¯¼å‡ºæµç¨‹å®šä¹‰å¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æµç¨‹å®šä¹‰çš„XMLèµ„æº
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â processDefinitionIdÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â XMLèµ„æºå†…å®¹
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â Result&lt;String&gt;Â getProcessDefinitionResource(StringÂ processDefinitionId)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â ProcessDefinitionÂ processDefinitionÂ =Â repositoryService.createProcessDefinitionQuery()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .processDefinitionId(processDefinitionId)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .singleResult();

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (processDefinitionÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"æµç¨‹å®šä¹‰ä¸å­˜åœ¨"</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â StringÂ resourceNameÂ =Â processDefinition.getResourceName();
Â Â Â Â Â Â Â Â Â Â Â Â InputStreamÂ inputStreamÂ =Â repositoryService.getResourceAsStream(
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â processDefinition.getDeploymentId(),
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resourceName);

Â Â Â Â Â Â Â Â Â Â Â Â byte[]Â bytesÂ =Â readAllBytes(inputStream);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.success(newÂ String(bytes,Â StandardCharsets.UTF_8));
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.error(<span class="hljs-string">"è·å–æµç¨‹å®šä¹‰èµ„æºå¤±è´¥:Â {}"</span>,Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Result.fail(<span class="hljs-string">"è·å–æµç¨‹å®šä¹‰èµ„æºå¤±è´¥:Â "</span>Â +Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è¯»å–è¾“å…¥æµçš„æ‰€æœ‰å­—èŠ‚ï¼ˆJavaÂ 8Â å…¼å®¹ç‰ˆæœ¬ï¼‰
Â Â Â Â Â *
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â inputStreamÂ è¾“å…¥æµ
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â å­—èŠ‚æ•°ç»„
Â Â Â Â Â *Â <span class="hljs-doctag">@throws</span>Â IOExceptionÂ è¯»å–å¼‚å¸¸
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â byte[]Â readAllBytes(InputStreamÂ inputStream)Â throwsÂ IOExceptionÂ {
Â Â Â Â Â Â Â Â ByteArrayOutputStreamÂ bufferÂ =Â newÂ ByteArrayOutputStream();
Â Â Â Â Â Â Â Â intÂ nRead;
Â Â Â Â Â Â Â Â byte[]Â <span class="hljs-keyword">data</span>Â =Â newÂ byte[<span class="hljs-number">4096</span>];
Â Â Â Â Â Â Â Â <span class="hljs-keyword">while</span>Â ((nReadÂ =Â inputStream.read(<span class="hljs-keyword">data</span>,Â <span class="hljs-number">0</span>,Â <span class="hljs-keyword">data</span>.length))Â !=Â -<span class="hljs-number">1</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â buffer.write(<span class="hljs-keyword">data</span>,Â <span class="hljs-number">0</span>,Â nRead);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â buffer.flush();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â buffer.toByteArray();
Â Â Â Â }
}
</code></pre>
<h4 data-id="heading-18">5.4 æ§åˆ¶å™¨å±‚</h4>
<p>RESTful API æ¥å£ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">package</span>Â <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.flowable</span><span class="hljs-selector-class">.controller</span>;

<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.flowable</span><span class="hljs-selector-class">.entity</span><span class="hljs-selector-class">.FlowDefinition</span>;
<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.flowable</span><span class="hljs-selector-class">.entity</span><span class="hljs-selector-class">.Result</span>;
<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.flowable</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.FlowDesignService</span>;
<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">lombok</span><span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.flowable</span><span class="hljs-selector-class">.engine</span><span class="hljs-selector-class">.repository</span><span class="hljs-selector-class">.Deployment</span>;
<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.flowable</span><span class="hljs-selector-class">.engine</span><span class="hljs-selector-class">.repository</span><span class="hljs-selector-class">.ProcessDefinition</span>;
<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.web</span><span class="hljs-selector-class">.bind</span><span class="hljs-selector-class">.annotation</span>.*;

<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">javax</span><span class="hljs-selector-class">.validation</span><span class="hljs-selector-class">.Valid</span>;
<span class="hljs-selector-tag">import</span>Â <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.List</span>;

<span class="hljs-comment">/**
Â *Â æµç¨‹è®¾è®¡æ§åˆ¶å™¨
Â *Â æä¾›æµç¨‹è®¾è®¡çš„RESTÂ APIæ¥å£
Â *Â @versionÂ 1.0.0
Â */</span>
@<span class="hljs-selector-tag">Slf4j</span>
@<span class="hljs-selector-tag">RestController</span>
@<span class="hljs-selector-tag">RequestMapping</span>(<span class="hljs-string">"/api/flow"</span>)
@<span class="hljs-selector-tag">CrossOrigin</span>(originsÂ =Â <span class="hljs-string">"*"</span>)
<span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">class</span>Â <span class="hljs-selector-tag">FlowDesignController</span>Â {

Â Â Â Â <span class="hljs-variable">@Autowired</span>
Â Â Â Â privateÂ FlowDesignServiceÂ flowDesignService;

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â ä¿å­˜æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â @paramÂ flowDefinitionÂ æµç¨‹å®šä¹‰å®ä½“
Â Â Â Â Â *Â @returnÂ ä¿å­˜ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">"/save"</span>)
Â Â Â Â publicÂ Result&lt;FlowDefinition&gt;Â <span class="hljs-built_in">saveFlowDefinition</span>(<span class="hljs-variable">@Valid</span>Â <span class="hljs-variable">@RequestBody</span>Â FlowDefinitionÂ flowDefinition)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"ä¿å­˜æµç¨‹å®šä¹‰:Â key={},Â name={}"</span>,Â flowDefinition.<span class="hljs-built_in">getProcessKey</span>(),Â flowDefinition.<span class="hljs-built_in">getProcessName</span>());
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.saveFlowDefinition</span>(flowDefinition);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ›´æ–°æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â @paramÂ flowDefinitionÂ æµç¨‹å®šä¹‰å®ä½“
Â Â Â Â Â *Â @returnÂ æ›´æ–°ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/update"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">FlowDefinition</span>&gt;Â <span class="hljs-selector-tag">updateFlowDefinition</span>(<span class="hljs-variable">@Valid</span>Â <span class="hljs-variable">@RequestBody</span>Â FlowDefinitionÂ flowDefinition)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"æ›´æ–°æµç¨‹å®šä¹‰:Â id={}"</span>,Â flowDefinition.<span class="hljs-built_in">getId</span>());
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.updateFlowDefinition</span>(flowDefinition);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ é™¤æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â @paramÂ idÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â @returnÂ åˆ é™¤ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">DeleteMapping</span>(<span class="hljs-string">"/delete/{id}"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">Void</span>&gt;Â <span class="hljs-selector-tag">deleteFlowDefinition</span>(<span class="hljs-variable">@PathVariable</span>Â LongÂ id)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"åˆ é™¤æµç¨‹å®šä¹‰:Â id={}"</span>,Â id);
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.deleteFlowDefinition</span>(id);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ ¹æ®IDæŸ¥è¯¢æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â @paramÂ idÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â @returnÂ æŸ¥è¯¢ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/get/{id}"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">FlowDefinition</span>&gt;Â <span class="hljs-selector-tag">getFlowDefinitionById</span>(<span class="hljs-variable">@PathVariable</span>Â LongÂ id)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.getFlowDefinitionById</span>(id);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æ‰€æœ‰æµç¨‹å®šä¹‰åˆ—è¡¨
Â Â Â Â Â *
Â Â Â Â Â *Â @returnÂ æµç¨‹å®šä¹‰åˆ—è¡¨
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/list"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">FlowDefinition</span>&gt;&gt;Â <span class="hljs-selector-tag">getAllFlowDefinitions</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.getAllFlowDefinitions</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â éƒ¨ç½²æµç¨‹åˆ°Flowableå¼•æ“
Â Â Â Â Â *
Â Â Â Â Â *Â @paramÂ idÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â @returnÂ éƒ¨ç½²ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/deploy/{id}"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">Deployment</span>&gt;Â <span class="hljs-selector-tag">deployFlowDefinition</span>(<span class="hljs-variable">@PathVariable</span>Â LongÂ id)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"éƒ¨ç½²æµç¨‹:Â id={}"</span>,Â id);
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.deployFlowDefinition</span>(id);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–Flowableæµç¨‹å®šä¹‰åˆ—è¡¨
Â Â Â Â Â *
Â Â Â Â Â *Â @returnÂ æµç¨‹å®šä¹‰åˆ—è¡¨
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/deployed/list"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ProcessDefinition</span>&gt;&gt;Â <span class="hljs-selector-tag">getDeployedFlowDefinitions</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.getFlowableProcessDefinitions</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ ¹æ®æµç¨‹Keyè·å–æœ€æ–°ç‰ˆæœ¬çš„æµç¨‹å®šä¹‰
Â Â Â Â Â *
Â Â Â Â Â *Â @paramÂ processKeyÂ æµç¨‹Key
Â Â Â Â Â *Â @returnÂ æµç¨‹å®šä¹‰
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/getByKey/{processKey}"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">ProcessDefinition</span>&gt;Â <span class="hljs-selector-tag">getProcessDefinitionByKey</span>(<span class="hljs-variable">@PathVariable</span>Â StringÂ processKey)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.getLatestProcessDefinitionByKey</span>(processKey);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å¯¼å‡ºæµç¨‹å®šä¹‰XML
Â Â Â Â Â *
Â Â Â Â Â *Â @paramÂ idÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â @returnÂ BPMNÂ XMLå­—ç¬¦ä¸²
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/export/{id}"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">String</span>&gt;Â <span class="hljs-selector-tag">exportFlowDefinitionXml</span>(<span class="hljs-variable">@PathVariable</span>Â LongÂ id)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"å¯¼å‡ºæµç¨‹å®šä¹‰XML:Â id={}"</span>,Â id);
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.exportFlowDefinitionXml</span>(id);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æµç¨‹å®šä¹‰çš„XMLèµ„æº
Â Â Â Â Â *
Â Â Â Â Â *Â @paramÂ processDefinitionIdÂ æµç¨‹å®šä¹‰ID
Â Â Â Â Â *Â @returnÂ XMLèµ„æºå†…å®¹
Â Â Â Â Â */</span>
Â Â Â Â @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/resource/{processDefinitionId}"</span>)
Â Â Â Â <span class="hljs-selector-tag">public</span>Â <span class="hljs-selector-tag">Result</span>&lt;<span class="hljs-selector-tag">String</span>&gt;Â <span class="hljs-selector-tag">getProcessDefinitionResource</span>(<span class="hljs-variable">@PathVariable</span>Â StringÂ processDefinitionId)Â {
Â Â Â Â Â Â Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">flowDesignService</span><span class="hljs-selector-class">.getProcessDefinitionResource</span>(processDefinitionId);
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-19">å…­ã€å‰ç«¯å®ç°</h3>
<h4 data-id="heading-20">6.1 é›†æˆ bpmn-js</h4>
<p>åœ¨ HTML é¡µé¢ä¸­å¼•å…¥ bpmn-js åº“ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">&lt;scriptÂ <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/bpmn-js@14.0.0/dist/bpmn-modeler.development.js"</span>&gt;&lt;/script&gt;
&lt;linkÂ <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>Â href=<span class="hljs-string">"https://unpkg.com/bpmn-js@14.0.0/dist/assets/diagram-js.css"</span>/&gt;
</code></pre>
<h4 data-id="heading-21">6.2 åˆå§‹åŒ–å»ºæ¨¡å™¨</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">//Â åˆ›å»ºÂ BPMNÂ å»ºæ¨¡å™¨å®ä¾‹</span>
<span class="hljs-keyword">const</span>Â <span class="hljs-variable constant_">bpmnModelerÂ </span>=Â <span class="hljs-keyword">new</span><span class="hljs-title function_ invoke__">Â BpmnJS</span>({
<span class="hljs-attr">Â Â Â Â container</span>:Â <span class="hljs-string">'#canvas'</span>,
<span class="hljs-attr">Â Â Â Â height</span>:Â <span class="hljs-string">'100%'</span>,
<span class="hljs-attr">Â Â Â Â keyboard</span>:Â {<span class="hljs-attr">Â bindTo</span>:Â windowÂ }
});

<span class="hljs-comment">//Â å¯¼å…¥é»˜è®¤çš„Â BPMNÂ æ¨¡æ¿</span>
bpmnModeler.<span class="hljs-title function_ invoke__">importXML</span>(defaultBpmnTemplate).<span class="hljs-title function_ invoke__">then</span>(()Â =&gt;Â {
Â Â Â Â bpmnModeler.<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'canvas'</span>).<span class="hljs-title function_ invoke__">zoom</span>(<span class="hljs-string">'fit-viewport'</span>);
});
</code></pre>
<h4 data-id="heading-22">6.3 ä¿å­˜æµç¨‹å®šä¹‰</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span>Â <span class="hljs-title">saveFlowDefinition</span>(<span class="hljs-params"/>)Â </span>{
Â Â Â Â <span class="hljs-comment">//Â è·å–Â BPMNÂ XML</span>
Â Â Â Â bpmnModeler.<span class="hljs-title function_ invoke__">saveXML</span>({<span class="hljs-attr">Â format</span>:Â <span class="hljs-literal">true</span>Â }).<span class="hljs-title function_ invoke__">then</span>(resultÂ =&gt;Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">const</span>Â bpmnXmlÂ =Â result.xml;

Â Â Â Â Â Â Â Â //Â å‘é€åˆ°åç«¯ä¿å­˜
Â Â Â Â Â Â Â Â $.<span class="hljs-title function_ invoke__">ajax</span>({
<span class="hljs-attr">Â Â Â Â Â Â Â Â Â Â Â Â url</span>:Â <span class="hljs-string">'/api/flow/save'</span>,
<span class="hljs-attr">Â Â Â Â Â Â Â Â Â Â Â Â method</span>:Â <span class="hljs-string">'POST'</span>,
<span class="hljs-attr">Â Â Â Â Â Â Â Â Â Â Â Â contentType</span>:Â <span class="hljs-string">'application/json'</span>,
<span class="hljs-attr">Â Â Â Â Â Â Â Â Â Â Â Â data</span>:Â JSON.<span class="hljs-title function_ invoke__">stringify</span>({
<span class="hljs-attr">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â processKey</span>:Â $(<span class="hljs-string">'#processKey'</span>).<span class="hljs-title function_ invoke__">val</span>(),
<span class="hljs-attr">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â processName</span>:Â $(<span class="hljs-string">'#processName'</span>).<span class="hljs-title function_ invoke__">val</span>(),
<span class="hljs-attr">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â bpmnXml</span>:Â bpmnXml
Â Â Â Â Â Â Â Â Â Â Â Â }),
Â Â Â Â Â Â Â Â Â Â Â Â success:Â <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>)Â </span>{
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span><span class="hljs-title function_ invoke__">Â </span>(response.codeÂ ===Â <span class="hljs-number">200</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title function_ invoke__">showToast</span>(<span class="hljs-string">'ä¿å­˜æˆåŠŸ'</span>,Â <span class="hljs-string">'success'</span>);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â });
Â Â Â Â });
}
</code></pre>
<h4 data-id="heading-23">6.4 éƒ¨ç½²æµç¨‹</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">deployFlowDefinition</span>(<span class="hljs-params">id</span>)Â {
Â Â Â Â $.<span class="hljs-title function_">ajax</span>({
Â Â Â Â Â Â Â Â <span class="hljs-attr">url</span>:Â <span class="hljs-string">'/api/flow/deploy/'</span>Â +Â id,
Â Â Â Â Â Â Â Â <span class="hljs-attr">method</span>:Â <span class="hljs-string">'POST'</span>,
Â Â Â Â Â Â Â Â <span class="hljs-attr">success</span>:Â <span class="hljs-keyword">function</span>(<span class="hljs-params">response</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (response.<span class="hljs-property">code</span>Â ===Â <span class="hljs-number">200</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title function_">showToast</span>(<span class="hljs-string">'éƒ¨ç½²æˆåŠŸï¼éƒ¨ç½²ID:Â '</span>Â +Â response.<span class="hljs-property">data</span>.<span class="hljs-property">id</span>,Â <span class="hljs-string">'success'</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â });
}
</code></pre>
<hr/>
<h3 data-id="heading-24">ä¸ƒã€æµç¨‹éƒ¨ç½²å®Œæ•´æµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84ec12c0f162445188ba5f06ae88a750~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770513912&amp;x-signature=C5%2BeATcbHlaj0R%2BH3JbGFmd93UE%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-25">7.1 ç»˜åˆ¶é˜¶æ®µ</h4>
<ol>
<li>ç”¨æˆ·æ‰“å¼€æµç¨‹è®¾è®¡å™¨</li>
<li>ä½¿ç”¨ bpmn-js æ‹–æ‹½ç»„ä»¶ç»˜åˆ¶æµç¨‹å›¾</li>
<li>é…ç½®å„å…ƒç´ çš„å±æ€§ï¼ˆä»»åŠ¡åç§°ã€å¤„ç†äººã€ç›‘å¬å™¨ç­‰ï¼‰</li>
</ol>
<h4 data-id="heading-26">7.2 ä¿å­˜é˜¶æ®µ</h4>
<ol>
<li>ç‚¹å‡»"ä¿å­˜"æŒ‰é’®</li>
<li>å‰ç«¯å°† BPMN XML å‘é€åˆ°åç«¯</li>
<li>åç«¯éªŒè¯æ•°æ®å¹¶ä¿å­˜åˆ° MySQL</li>
<li>è¿”å›ä¿å­˜ç»“æœ</li>
</ol>
<h4 data-id="heading-27">7.3 éƒ¨ç½²é˜¶æ®µ</h4>
<ol>
<li>ç”¨æˆ·é€‰æ‹©è¦éƒ¨ç½²çš„æµç¨‹</li>
<li>ç‚¹å‡»"éƒ¨ç½²"æŒ‰é’®</li>
<li>åç«¯è°ƒç”¨ Flowable çš„ RepositoryService</li>
<li>Flowable å¼•æ“è§£æ BPMN XML</li>
<li>åˆ›å»ºéƒ¨ç½²å¯¹è±¡å¹¶å­˜å‚¨åˆ°æ•°æ®åº“</li>
<li>æ›´æ–°æµç¨‹å®šä¹‰çš„éƒ¨ç½²çŠ¶æ€</li>
</ol>
<hr/>
<h3 data-id="heading-28">å…«ã€æ•°æ®åº“è®¾è®¡</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8859c049e2a4aee8c2e3054ce0b7016~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770513912&amp;x-signature=CqU2dcaYJA1sPWOb4sdpWuMxQX4%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-29">8.1 æ ¸å¿ƒè¡¨ç»“æ„</h4>
<p><strong>flow_definition è¡¨</strong></p>
<ul>
<li>å­˜å‚¨ç”¨æˆ·ç»˜åˆ¶çš„æµç¨‹å®šä¹‰ä¿¡æ¯</li>
<li>åŒ…å« BPMN XMLã€ç‰ˆæœ¬å·ã€éƒ¨ç½²çŠ¶æ€ç­‰å­—æ®µ</li>
</ul>
<p><strong>Flowable æ ¸å¿ƒè¡¨ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰</strong></p>
<ul>
<li><code>ACT_RE_PROCDEF</code>ï¼šæµç¨‹å®šä¹‰è¡¨</li>
<li><code>ACT_RE_DEPLOYMENT</code>ï¼šéƒ¨ç½²è¡¨</li>
<li><code>ACT_RU_EXECUTION</code>ï¼šè¿è¡Œæ—¶æ‰§è¡Œå®ä¾‹è¡¨</li>
<li><code>ACT_RU_TASK</code>ï¼šè¿è¡Œæ—¶ä»»åŠ¡è¡¨</li>
<li><code>ACT_HI_PROCINST</code>ï¼šå†å²æµç¨‹å®ä¾‹è¡¨</li>
<li><code>ACT_HI_TASKINST</code>ï¼šå†å²ä»»åŠ¡è¡¨</li>
</ul>
<h4 data-id="heading-30">8.2 è¡¨å…³ç³»è¯´æ˜</h4>
<pre><code class="hljs language-scss" lang="scss">ACT_RE_DEPLOYMENTÂ (<span class="hljs-number">1</span>)Â â”€â”€â”€â†’Â ACT_RE_PROCDEFÂ (N)
Â Â Â Â ä¸€ä¸ªéƒ¨ç½²åŒ…å«å¤šä¸ªæµç¨‹å®šä¹‰

ACT_RE_PROCDEFÂ (<span class="hljs-number">1</span>)Â â”€â”€â”€â†’Â ACT_RU_EXECUTIONÂ (N)
Â Â Â Â ä¸€ä¸ªæµç¨‹å®šä¹‰å¯å¯åŠ¨å¤šä¸ªæµç¨‹å®ä¾‹

ACT_RU_EXECUTIONÂ (<span class="hljs-number">1</span>)Â â”€â”€â”€â†’Â ACT_RU_TASKÂ (N)
Â Â Â Â ä¸€ä¸ªæµç¨‹å®ä¾‹åŒ…å«å¤šä¸ªä»»åŠ¡
</code></pre>
<hr/>
<h3 data-id="heading-31">ä¹ã€å®Œæ•´ä¸šåŠ¡æµç¨‹</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3cfa2aa30167492281a49e716186ca2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770513912&amp;x-signature=Ntgk2lZfc3Q%2FVEL4mNjDojwnq3w%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-32">9.1 ç”¨æˆ·æ“ä½œæµç¨‹</h4>
<ol>
<li><strong>ç™»å½•ç³»ç»Ÿ</strong>ï¼šç”¨æˆ·ç™»å½•åœ¨çº¿æµç¨‹è®¾è®¡ç³»ç»Ÿ</li>
<li><strong>åˆ›å»ºæµç¨‹</strong>ï¼šç‚¹å‡»"æ–°å»ºæµç¨‹"æŒ‰é’®</li>
<li><strong>ç»˜åˆ¶æµç¨‹å›¾</strong>ï¼šä½¿ç”¨ bpmn-js è®¾è®¡å™¨ç»˜åˆ¶ BPMN 2.0 æµç¨‹å›¾</li>
<li><strong>é…ç½®å±æ€§</strong>ï¼šä¸ºå„å…ƒç´ é…ç½®å±æ€§ï¼ˆåç§°ã€å¤„ç†äººç­‰ï¼‰</li>
<li><strong>ä¿å­˜æµç¨‹</strong>ï¼šå°†æµç¨‹å®šä¹‰ä¿å­˜åˆ° MySQL æ•°æ®åº“</li>
</ol>
<h4 data-id="heading-33">9.2 è®¾è®¡å¸ˆæ“ä½œæµç¨‹</h4>
<ol>
<li><strong>ç»˜åˆ¶æµç¨‹å›¾</strong>ï¼šæ‹–æ‹½ BPMN ç»„ä»¶åˆ°ç”»å¸ƒ</li>
<li><strong>è¿æ¥å…ƒç´ </strong>ï¼šä½¿ç”¨é¡ºåºæµè¿æ¥å„ä¸ªå…ƒç´ </li>
<li><strong>é…ç½®å±æ€§</strong>ï¼šè®¾ç½®ä»»åŠ¡åç§°ã€å€™é€‰ç»„ã€åˆ°æœŸæ—¶é—´ç­‰</li>
<li><strong>ä¿å­˜æµç¨‹</strong>ï¼šå°†è®¾è®¡å¥½çš„æµç¨‹ä¿å­˜åˆ°æ•°æ®åº“</li>
</ol>
<h4 data-id="heading-34">9.3 ç³»ç»Ÿå¤„ç†æµç¨‹</h4>
<ol>
<li><strong>éªŒè¯ XML</strong>ï¼šç³»ç»ŸéªŒè¯ BPMN XML çš„æ ¼å¼å’Œæœ‰æ•ˆæ€§</li>
<li><strong>éƒ¨ç½²æµç¨‹</strong>ï¼šå°†æµç¨‹éƒ¨ç½²åˆ° Flowable å¼•æ“</li>
<li><strong>å­˜å‚¨æ•°æ®</strong>ï¼šå°†æµç¨‹æ•°æ®æŒä¹…åŒ–åˆ°æ•°æ®åº“</li>
</ol>
<hr/>
<h3 data-id="heading-35">åã€å®æˆ˜æ¡ˆä¾‹</h3>
<h4 data-id="heading-36">10.1 è¯·å‡å®¡æ‰¹æµç¨‹</h4>
<p>ä¸‹é¢ä»¥ä¸€ä¸ªç®€å•çš„è¯·å‡å®¡æ‰¹æµç¨‹ä¸ºä¾‹ï¼Œå±•ç¤ºå®Œæ•´çš„å®ç°è¿‡ç¨‹ã€‚</p>
<p><strong>æµç¨‹éœ€æ±‚</strong>ï¼š</p>
<ol>
<li>å‘˜å·¥æäº¤è¯·å‡ç”³è¯·</li>
<li>éƒ¨é—¨ç»ç†å®¡æ‰¹</li>
<li>å¦‚æœè¯·å‡å¤©æ•° &gt; 3 å¤©ï¼Œéœ€è¦ HR å¤å®¡</li>
<li>å®¡æ‰¹é€šè¿‡åï¼Œé€šçŸ¥å‘˜å·¥</li>
</ol>
<p><strong>BPMN è®¾è®¡</strong>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xmlÂ version=<span class="hljs-string">"1.0"</span>Â encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">bpmn:definitions</span>Â <span class="hljs-attr">xmlns:bpmn</span>=<span class="hljs-string">"http://www.omg.org/spec/BPMN/20100524/MODEL"</span>&gt;</span>
Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:process</span>Â <span class="hljs-attr">id</span>=<span class="hljs-string">"leaveRequest"</span>Â <span class="hljs-attr">name</span>=<span class="hljs-string">"è¯·å‡å®¡æ‰¹æµç¨‹"</span>Â <span class="hljs-attr">isExecutable</span>=<span class="hljs-string">"true"</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:startEvent</span>Â <span class="hljs-attr">id</span>=<span class="hljs-string">"start"</span>/&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:userTask</span>Â <span class="hljs-attr">id</span>=<span class="hljs-string">"managerApproval"</span>Â <span class="hljs-attr">name</span>=<span class="hljs-string">"ç»ç†å®¡æ‰¹"</span>Â <span class="hljs-attr">flowable:assignee</span>=<span class="hljs-string">"${manager}"</span>/&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:exclusiveGateway</span>Â <span class="hljs-attr">id</span>=<span class="hljs-string">"gateway"</span>/&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:userTask</span>Â <span class="hljs-attr">id</span>=<span class="hljs-string">"hrApproval"</span>Â <span class="hljs-attr">name</span>=<span class="hljs-string">"HRå®¡æ‰¹"</span>Â <span class="hljs-attr">flowable:candidateGroups</span>=<span class="hljs-string">"hr"</span>/&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:endEvent</span>Â <span class="hljs-attr">id</span>=<span class="hljs-string">"end"</span>/&gt;</span>

Â Â Â Â <span class="hljs-comment">&lt;!--Â æµè½¬Â --&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span>Â <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"start"</span>Â <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"managerApproval"</span>/&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span>Â <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"managerApproval"</span>Â <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"gateway"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:conditionExpression</span>Â <span class="hljs-attr">xsi:type</span>=<span class="hljs-string">"tFormalExpression"</span>&gt;</span>${approvedÂ !=Â null}<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:conditionExpression</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:sequenceFlow</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span>Â <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"gateway"</span>Â <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"hrApproval"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:conditionExpression</span>Â <span class="hljs-attr">xsi:type</span>=<span class="hljs-string">"tFormalExpression"</span>&gt;</span>${daysÂ &gt;Â 3}<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:conditionExpression</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:sequenceFlow</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span>Â <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"gateway"</span>Â <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"end"</span>&gt;</span>
Â Â Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:conditionExpression</span>Â <span class="hljs-attr">xsi:type</span>=<span class="hljs-string">"tFormalExpression"</span>&gt;</span>${daysÂ &lt;=Â 3}<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:conditionExpression</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:sequenceFlow</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">bpmn:sequenceFlow</span>Â <span class="hljs-attr">sourceRef</span>=<span class="hljs-string">"hrApproval"</span>Â <span class="hljs-attr">targetRef</span>=<span class="hljs-string">"end"</span>/&gt;</span>
Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:process</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">bpmn:definitions</span>&gt;</span>
</code></pre>
<p><strong>éƒ¨ç½²å’Œä½¿ç”¨</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//Â å¯åŠ¨æµç¨‹å®ä¾‹</span>
ProcessInstanceÂ processInstanceÂ =Â runtimeService<span class="hljs-selector-class">.startProcessInstanceByKey</span>(
Â Â Â Â "leaveRequest",
Â Â Â Â businessKey,
Â Â Â Â variables
);

<span class="hljs-comment">//Â å®Œæˆç»ç†å®¡æ‰¹ä»»åŠ¡</span>
TaskÂ taskÂ =Â taskService<span class="hljs-selector-class">.createTaskQuery</span>()
Â Â Â Â <span class="hljs-selector-class">.processInstanceId</span>(processInstance.getId())
Â Â Â Â <span class="hljs-selector-class">.singleResult</span>();

taskService<span class="hljs-selector-class">.complete</span>(task.getId(),Â Collections<span class="hljs-selector-class">.singletonMap</span>("approved",Â true));
</code></pre>
<h3 data-id="heading-37">åä¸€ã€å•å…ƒæµ‹è¯•</h3>
<h4 data-id="heading-38">11.1 æµ‹è¯•æœåŠ¡å±‚</h4>
<p>ä½¿ç”¨ JUnit 5 å’Œ Mockito è¿›è¡Œå•å…ƒæµ‹è¯•ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@ExtendWith</span>(MockitoExtension.class)
classÂ FlowDesignServiceTestÂ {

Â Â Â Â <span class="hljs-keyword">@Mock</span>
Â Â Â Â privateÂ FlowDefinitionMapperÂ flowDefinitionMapper;

Â Â Â Â <span class="hljs-keyword">@Mock</span>
Â Â Â Â privateÂ RepositoryServiceÂ repositoryService;

Â Â Â Â <span class="hljs-keyword">@InjectMocks</span>
Â Â Â Â privateÂ FlowDesignServiceÂ flowDesignService;

Â Â Â Â <span class="hljs-keyword">@Test</span>
Â Â Â Â <span class="hljs-keyword">@DisplayName</span>(<span class="hljs-string">"æµ‹è¯•ä¿å­˜æµç¨‹å®šä¹‰"</span>)
Â Â Â Â voidÂ testSaveFlowDefinition()Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â Given</span>
Â Â Â Â Â Â Â Â FlowDefinitionÂ <span class="hljs-attribute">flow</span>Â =Â newÂ <span class="hljs-built_in">FlowDefinition</span>();
Â Â Â Â Â Â Â Â <span class="hljs-attribute">flow</span><span class="hljs-selector-class">.setProcessKey</span>("test");
Â Â Â Â Â Â Â Â <span class="hljs-attribute">flow</span><span class="hljs-selector-class">.setProcessName</span>("æµ‹è¯•æµç¨‹");
Â Â Â Â Â Â Â Â <span class="hljs-attribute">flow</span><span class="hljs-selector-class">.setBpmnXml</span>(bpmnXml);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â When</span>
Â Â Â Â Â Â Â Â Result&lt;FlowDefinition&gt;Â resultÂ =Â flowDesignService<span class="hljs-selector-class">.saveFlowDefinition</span>(flow);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â Then</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">assertTrue</span>(result.isSuccess());
Â Â Â Â Â Â Â Â <span class="hljs-built_in">verify</span>(flowDefinitionMapper)<span class="hljs-selector-class">.insert</span>(any());
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-39">åäºŒã€éƒ¨ç½²å’Œè¿è¡Œ</h3>
<h4 data-id="heading-40">12.1 ç¼–è¯‘æ‰“åŒ…</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#Â ç¼–è¯‘é¡¹ç›®</span>
mvnÂ cleanÂ compile

<span class="hljs-comment">#Â è¿è¡Œæµ‹è¯•</span>
mvnÂ <span class="hljs-built_in">test</span>

<span class="hljs-comment">#Â æ‰“åŒ…ï¼ˆå¯é€‰ï¼‰</span>
mvnÂ cleanÂ package
</code></pre>
<h4 data-id="heading-41">12.2 å¯åŠ¨åº”ç”¨</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#Â ä½¿ç”¨Â MavenÂ å¯åŠ¨</span>
mvnÂ spring-boot:run

<span class="hljs-comment">#Â æˆ–ä½¿ç”¨Â javaÂ -jarÂ å¯åŠ¨</span>
javaÂ -jarÂ target/flowable_online-demo-1.0.0.jar
</code></pre>
<h4 data-id="heading-42">12.3 è®¿é—®ç³»ç»Ÿ</h4>
<ul>
<li>é¦–é¡µï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8080" target="_blank" title="http://localhost:8080" ref="nofollow noopener noreferrer">http://localhost:8080</a></li>
<li>æµç¨‹è®¾è®¡å™¨ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8080%2Fdesigner" target="_blank" title="http://localhost:8080/designer" ref="nofollow noopener noreferrer">http://localhost:8080/designer</a></li>
</ul>
<hr/>
<h3 data-id="heading-43">åä¸‰ã€æ€»ç»“</h3>
<p>æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•åŸºäº Flowable 6.8.0 å’Œ bpmn-js æ„å»ºä¸€ä¸ªåœ¨çº¿æµç¨‹å›¾ç»˜åˆ¶ç³»ç»Ÿã€‚ è¯¥ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæ˜“äºæ‰©å±•å’Œé›†æˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Goè¯­è¨€GCé»‘é­”æ³•ï¼šå¦‚ä½•è®©ç¨‹åºæ—¢å¿«åˆâ€œå¹²å‡€â€]]></title>    <link>https://juejin.cn/post/7600994087588839443</link>    <guid>https://juejin.cn/post/7600994087588839443</guid>    <pubDate>2026-01-31T10:38:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7600994087588839443" data-draft-id="7600986495928090665" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Goè¯­è¨€GCé»‘é­”æ³•ï¼šå¦‚ä½•è®©ç¨‹åºæ—¢å¿«åˆâ€œå¹²å‡€â€"/> <meta itemprop="keywords" content="Go,åç«¯"/> <meta itemprop="datePublished" content="2026-01-31T10:38:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="yuanji6666"/> <meta itemprop="url" content="https://juejin.cn/user/1751944348856905"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Goè¯­è¨€GCé»‘é­”æ³•ï¼šå¦‚ä½•è®©ç¨‹åºæ—¢å¿«åˆâ€œå¹²å‡€â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1751944348856905/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    yuanji6666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T10:38:21.000Z" title="Sat Jan 31 2026 10:38:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬ç¯‡æ–‡ç« ä»…è®°å½•è‡ªå·±å¯¹Goåƒåœ¾å›æ”¶åŸç†çš„ç†è§£ï¼Œå¾…æ—¥åå­¦ä¹ æ›´åŠ æ·±å…¥ï¼Œå†è¡¥ä¸Šæºç çš„åˆ†æ
å‚è€ƒäº†å¤šç¯‡åšå®¢å’ŒAceldè€å¸ˆçš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1wz4y1y7Kd%2F" target="_blank" title="https://www.bilibili.com/video/BV1wz4y1y7Kd/" ref="nofollow noopener noreferrer">è§†é¢‘è®²è§£</a>ï¼ˆéå¸¸ç”ŸåŠ¨ï¼Œæ¨èè§‚çœ‹ï¼‰</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>GCï¼ˆgarbage collectionï¼‰åƒåœ¾å›æ”¶ï¼Œæ˜¯ä¸€ä¸ªå†…å­˜ç®¡ç†ç­–ç•¥ã€‚c/c++æŠŠå†…å­˜ç®¡ç†å…¨æƒäº¤ç»™ç¨‹åºå‘˜ï¼Œè€ŒGo/Javaç­‰ç°ä»£ç¼–ç¨‹è¯­è¨€ï¼Œè¯­è¨€æœ¬èº«è‡ªå¸¦ä¸€ä¸ªåƒåœ¾å›æ”¶å™¨è¿è¡Œåœ¨åå°ï¼ŒæŒ‰ç…§æ—¢å®šç­–ç•¥ä¸ºç”¨æˆ·å›æ”¶ä¸å†ä½¿ç”¨çš„å¯¹è±¡ï¼Œé‡Šæ”¾å¯¹åº”çš„å†…å­˜ç©ºé—´ã€‚</p>
<p>ä¼˜ç¼ºç‚¹ï¼š</p>
<ul>
<li><strong>å±è”½å†…å­˜ç»†èŠ‚</strong>ï¼šå¼€å‘äººå‘˜æ›´å¥½çš„èšç„¦ä¸šåŠ¡é€»è¾‘</li>
<li><strong>å…¨å±€è§†é‡</strong>ï¼šç°ä»£è½¯ä»¶å¼€å‘é€šå¸¸ä¸ºå›¢é˜Ÿåä½œè€Œæˆï¼Œä¸ªäººåªè´Ÿè´£ä¸€ä¸ªæ¨¡å—ï¼Œåä½œæ—¶è¿›è¡Œå†…å­˜ç®¡ç†çš„è´Ÿæ‹…å¤ªå¤§ï¼Œè¿™æ—¶å€™Garbage Collectorç±»ä¼¼æœ‰â€œå…¨å±€è§†é‡â€</li>
<li>æ€§èƒ½æˆæœ¬ï¼šä¼šç”¨é¢å¤–ç©ºé—´å­˜å‚¨å¿…è¦çš„å†…å­˜ä¿¡æ¯ï¼Œè¿˜ä¼šæœ‰æ—¶ä¸­æ–­ç¨‹åºè¿è¡Œæ¥æ”¯æŒGCå·¥ä½œï¼Œæ‹–æ…¢ç¨‹åº</li>
</ul>
<p>æ€»çš„æ¥è¯´ï¼Œé™¤äº†æç«¯è¿½æ±‚æ€§èƒ½çš„åœºæ™¯ï¼ŒGCå¸¦æ¥çš„<strong>å¥½å¤„æ˜¯è¿œè¿œå¤§äºåå¤„</strong>çš„ï¼Œæ›´å®‰å…¨ï¼Œäº¤ä»˜æ•ˆç‡æ›´é«˜ã€‚</p>
<h2 data-id="heading-1">ç›´å‡»è¦å®³</h2>
<p>ç½‘ç»œä¸Šå¾ˆå¤šåšå®¢éƒ½ä»æ¼«é•¿çš„å†å²è®²èµ·ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆæç½®ï¼Œç›´å‡»è¦å®³ï¼Œçœ‹çœ‹GO-GCçš„æ ¸å¿ƒç®—æ³•</p>
<p>Goè‡ªV1.8ä¹‹åå®šå‹ä¸º<strong>ä¸‰è‰²æ ‡è®°+æ··åˆå†™å±éšœ</strong>æ³•</p>
<p>åå­—å¾ˆå”¬äººï¼Œå…¶å®ç†è§£èµ·æ¥å¾ˆå®¹æ˜“</p>
<h3 data-id="heading-2">ä¸‰è‰²æ ‡è®°</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ad178fbc55c479d8bceb92507767ea6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeXVhbmppNjY2Ng==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770460792&amp;x-signature=VgHT%2BqCitzBlNz4IrT4OhVnC0VY%3D" alt="ä¸‰è‰²æ ‡è®°è¿‡ç¨‹.png" loading="lazy"/></p>
<p>ä¸‰è‰²å³<strong>é»‘ï¼Œç°ï¼Œç™½</strong></p>
<ul>
<li>é»‘ï¼šå·²è®¿é—®ï¼Œç›´æ¥å¼•ç”¨çš„å¯¹è±¡ä¹Ÿéƒ½è®¿é—®è¿‡</li>
<li>ç°ï¼šå·²è®¿é—®ï¼Œä½†æ˜¯ç›´æ¥å¼•ç”¨å¯¹è±¡æ²¡æœ‰è®¿é—®</li>
<li>ç™½ï¼šæœªè®¿é—®ï¼Œæ˜¯æ½œåœ¨çš„åƒåœ¾å¯¹è±¡</li>
</ul>
<p>è¿›è¡Œä¸€è½®GCï¼Œå°±æ˜¯ä¸æ–­<strong>å¹¿åº¦ä¼˜å…ˆéå†</strong>æ•´ä¸ª<strong>å˜é‡å¼•ç”¨å›¾</strong>çš„è¿‡ç¨‹ï¼Œå½“ç°è‰²ä¸ºç©ºæ—¶ï¼Œå›æ”¶ç™½è‰²ï¼Œå°±è¾¾åˆ°äº†æˆ‘ä»¬çš„ç›®çš„</p>
<h3 data-id="heading-3">æ··åˆå†™å±éšœ</h3>
<p>æ‰€è°“<strong>æ··åˆå†™å±éšœ</strong>ï¼Œå°±æ˜¯æ··åˆäº†æ’å…¥å†™å±éšœå’Œåˆ é™¤å†™å±éšœ</p>
<p>å¯ä»¥æŠŠå±éšœç†è§£ä¸º<strong>æ‹¦æˆª</strong>çš„ä½œç”¨ï¼Œå…¶æœ¬è´¨æ˜¯å¯¹è±¡èµ‹å€¼å‰æ’å…¥çš„ä¸€æ®µä»£ç </p>
<p>çœŸå®åœºæ™¯ä¸­ï¼Œéœ€è¦è¡¥å……ä¸€ä¸ªæ–°çš„è®¾å®šâ€”â€”å±éšœæœºåˆ¶<strong>æ— æ³•ä½œç”¨äºæ ˆå¯¹è±¡</strong>.</p>
<p>è¿™æ˜¯å› ä¸ºæ ˆå¯¹è±¡å¯èƒ½æ¶‰åŠé¢‘ç¹çš„<strong>è½»é‡æ“ä½œ</strong>ï¼Œå€˜è‹¥è¿™äº›<strong>é«˜é¢‘åº¦æ“ä½œ</strong>éƒ½éœ€è¦ä¸€ä¸€è§¦å‘å±éšœæœºåˆ¶ï¼Œé‚£ä¹ˆæ‰€å¸¦æ¥çš„æˆæœ¬å°†æ˜¯æ— æ³•æ¥å—çš„.</p>
<h4 data-id="heading-4">ä¸ºä»€ä¹ˆè¦æœ‰å±éšœï¼Ÿ</h4>
<p>æ˜¯ä¸ºäº†æ»¡è¶³<strong>ä¸‰è‰²ä¸å˜æ€§</strong>ï¼Œæ»¡è¶³äº†ä¸‰è‰²ä¸å˜æ€§ï¼Œå°±ä¿è¯äº†<strong>å¹¶å‘</strong>æ¡ä»¶ä¸‹çš„ä¸‰è‰²æ ‡è®°æœºåˆ¶çš„æ­£å¸¸å·¥ä½œ</p>
<p>ä¸‰è‰²ä¸å˜æ€§ï¼š</p>
<ul>
<li>å¼ºä¸‰è‰²ä¸å˜æ€§ï¼šé»‘è‰²å¯¹è±¡ä¸å¯ä»¥ç›´æ¥å¼•ç”¨ç™½è‰²å¯¹è±¡</li>
<li>å¼±ä¸‰è‰²ä¸å˜æ€§ï¼šå½“é»‘è‰²å¯¹è±¡ç›´æ¥å¼•ç”¨ç™½è‰²å¯¹è±¡æ—¶ï¼Œå¿…é¡»æœ‰å¦ä¸€ä¸ªç°è‰²å¯¹è±¡å¯ä»¥ç›´æ¥æˆ–é—´æ¥è®¿é—®åˆ°è¯¥ç°è‰²å¯¹è±¡ï¼Œç§°ä½œå—åˆ°ç°è‰²å¯¹è±¡çš„ä¿æŠ¤</li>
</ul>
<h4 data-id="heading-5">å±éšœæ€æ ·æ»¡è¶³ä¸‰è‰²ä¸å˜æ€§ï¼Ÿ</h4>
<p>æ··åˆå†™å±éšœæœºåˆ¶ï¼š</p>
<ul>
<li>Â GC å¼€å§‹å‰ï¼Œä»¥æ ˆä¸ºå•ä½<strong>åˆ†æ‰¹</strong>æ‰«æï¼Œå°†æ ˆä¸­æ‰€æœ‰å¯¹è±¡ç½®é»‘</li>
<li>Â GC æœŸé—´ï¼Œæ ˆä¸Šæ–°åˆ›å»ºå¯¹è±¡ç›´æ¥ç½®é»‘</li>
<li>Â å¼•ç”¨æ–°å¯¹è±¡ï¼Œæ–°å¯¹è±¡ç½®ç°ï¼ˆæ»¡è¶³å¼ºä¸å˜æ€§ï¼‰</li>
<li>Â åˆ é™¤å¼•ç”¨å¯¹è±¡ï¼Œè¢«åˆ é™¤ç½®ç°ï¼ˆæ»¡è¶³å¼±ä¸å˜æ€§ï¼‰ï¼ˆæˆ‘ä»¬ä¸çŸ¥é“è¢«åˆ é™¤ä¸Šæ¸¸æ˜¯å¦æœ‰ä¿æŠ¤ï¼‰</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/218cccc2171841d3905508991bf60862~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeXVhbmppNjY2Ng==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770460792&amp;x-signature=RcLwPZWSLUuPoC6ygLq1Rtgzz4g%3D" alt="æ··åˆå†™å±éšœ.png" loading="lazy"/></p>
<h2 data-id="heading-6">ä»¥å²ä¸ºé‰´</h2>
<h3 data-id="heading-7">ä¸‰è‰²æ ‡è®°VSæ ‡è®°-æ¸…é™¤</h3>
<p><strong>æ ‡è®°-æ¸…é™¤æ³•</strong>åªæœ‰é»‘ï¼Œç™½ä¸¤ç§é¢œè‰²ï¼Œè¿›è¡Œä¸€æ¬¡éå†ä¹‹åï¼Œå›æ”¶ç™½è‰²çš„èŠ‚ç‚¹</p>
<p>ä¸‰è‰²æ ‡è®°çš„å‡ ä¸ªæ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>å¢é‡å›æ”¶</strong>ï¼šæ ‡è®°-æ¸…é™¤æ³•ä¸€æ¬¡STWï¼ˆstop the worldï¼‰å¿…é¡»å®Œæˆæ‰€æœ‰æ ‡è®°å·¥ä½œï¼Œå› ä¸ºç¼ºä¹ä¸­é—´æ€ï¼Œè€Œä¸‰è‰²æ ‡è®°æ¯æ¬¡åªéœ€éå†ç°è‰²èŠ‚ç‚¹ï¼Œå¯ä»¥ä¸€æ­¥ä¸€æ­¥ï¼Œå¢é‡å›æ”¶</li>
<li><strong>å¹¶å‘æ ‡è®°</strong>ï¼šæ ‡è®°-æ¸…é™¤æ³•ä¸æ”¯æŒå±éšœæ“ä½œ</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œæ ‡è®°æ¸…é™¤ç®—æ³•ä¸­ï¼Œæ ‡è®°ä¸­é€”é»‘è‰²å˜é‡å¼•ç”¨ç™½è‰²ï¼Œæ­¤æ—¶ç™½è‰²æ ¹æœ¬<strong>ä¸å¯èƒ½éå†åˆ°</strong></p>
<p><strong>æœ¬è´¨</strong>ï¼šä¸‰è‰²æ ‡è®°é€šè¿‡å¼•å…¥â€œç°è‰²â€è¿™ä¸€ä¸­é—´çŠ¶æ€ï¼Œå°†æ ‡è®°è¿‡ç¨‹ä»<strong>åŸå­æ“ä½œ</strong>è½¬å˜ä¸º<strong>å¯åˆ†å‰²ã€å¯è¿½è¸ªçš„è¿‡ç¨‹</strong>ï¼Œä»è€Œå®ç°äº†æ ‡è®°é˜¶æ®µä¸åº”ç”¨çº¿ç¨‹çš„å¹¶å‘æ‰§è¡Œï¼Œè¿™æ˜¯å…¶æœ€æ ¹æœ¬çš„ä¼˜åŠ¿ã€‚</p>
<h3 data-id="heading-8">æ··åˆå†™å±éšœVSæ’å…¥/åˆ é™¤å†™å±éšœ</h3>
<p>åœ¨å±éšœä¸èƒ½ä½œç”¨äºæ ˆçš„å‰æä¸‹ï¼Œå•çº¯æ’å…¥/åˆ é™¤éƒ½éœ€è¦å¼•å…¥<strong>STW</strong>ï¼Œæœ€åå¯¹æ ˆè¿›è¡Œ<strong>å…œåº•</strong></p>
<p>è€Œåœ¨æ··åˆæœºåˆ¶ä¸‹ï¼Œä»»ä½•æ¶‰åŠåˆ°å †çš„å˜é‡ï¼Œéƒ½ä¼šå±éšœä¿æŠ¤,é¿å…äº†STW</p>
<p>å¦‚æœéƒ½æ˜¯æ ˆå‘¢ï¼Ÿ</p>
<p>æ ˆåœ¨GCå¼€å§‹ä¼šåˆ†æ‰¹å˜é»‘ï¼Œå¦‚æœæ­¤æ—¶å‡ºç°äº†ä¸€ä¸ªæ ˆ<strong>é»‘å¼•ç”¨ç™½</strong>ï¼Œå¦ä¸€ä¸ªæ ˆç™½<strong>åˆ é™¤å¼•ç”¨</strong>ç™½ï¼Ÿ</p>
<p>è¿™æ˜¯ä¸ªä¼ªå‘½é¢˜ï¼Œè¯¦ç»†çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FTdekaMjlf_kk_ReyPvoXiQ" target="_blank" title="https://mp.weixin.qq.com/s/TdekaMjlf_kk_ReyPvoXiQ" ref="nofollow noopener noreferrer">å°å¾å…ˆç”Ÿçš„ç¼–ç¨‹ä¸–ç•Œ</a><strong>case4</strong></p>
<h2 data-id="heading-9">è¿˜æœ‰STWå—ï¼Ÿ</h2>
<blockquote>
<p><strong>deepseekï¼š</strong>
å°½ç®¡é‡‡ç”¨äº†é«˜å¹¶å‘çš„ä¸‰è‰²æ ‡è®°ï¼Œä½†ä¸ºäº†ç¡®ä¿åƒåœ¾å›æ”¶çš„æ­£ç¡®æ€§å’Œç®€å•æ€§ï¼Œåœ¨ä»¥ä¸‹ä¸¤ä¸ªå…³é”®èŠ‚ç‚¹ä»éœ€è¦çŸ­æš‚çš„å…¨å±€åœé¡¿ï¼š</p>
<ol>
<li><strong>æ ‡è®°å¼€å§‹é˜¶æ®µï¼ˆMark Setup - STWï¼‰</strong>ï¼šä¸»è¦ä»»åŠ¡æ˜¯<strong>å¼€å¯å†™å±éšœ</strong>ã€‚ä¸ºäº†ç¡®ä¿æ‰€æœ‰åç¨‹ï¼ˆgoroutineï¼‰éƒ½èƒ½æ„ŸçŸ¥å¹¶å¯ç”¨å†™å±éšœï¼Œå¿…é¡»è®©å®ƒä»¬çŸ­æš‚åœ°æš‚åœåœ¨ä¸€ä¸ªå®‰å…¨ç‚¹ï¼Œè¿™ä¸ªæ“ä½œéå¸¸å¿«</li>
<li><strong>æ ‡è®°ç»ˆæ­¢é˜¶æ®µï¼ˆMark Termination - STWï¼‰</strong>ï¼šä¸»è¦ä»»åŠ¡æ˜¯<strong>å…³é—­å†™å±éšœ</strong>ï¼Œå¹¶æ‰§è¡Œä¸€äº›æœ€ç»ˆçš„çŠ¶æ€æ£€æŸ¥å’Œæ¸…ç†å·¥ä½œã€‚é€‰æ‹©åœ¨æ­¤é˜¶æ®µä½¿ç”¨ä¸€ä¸ªçŸ­æš‚çš„STWï¼Œå¯ä»¥ç®€åŒ–è®¾è®¡å¹¶ä¿è¯é€»è¾‘æ­£ç¡®ï¼Œè€Œå¸¦æ¥çš„æ€§èƒ½å¼€é”€æå°</li>
</ol>
</blockquote>
<h2 data-id="heading-10">æ€æ ·ç¼–å†™GCå‹å¥½ä»£ç ï¼Ÿ</h2>
<p>ä¸ºäº†è¿›ä¸€æ­¥é™ä½GCçš„æ•´ä½“å¼€é”€å’Œæ½œåœ¨å½±å“ï¼Œä½ å¯ä»¥ï¼š</p>
<ul>
<li><strong>å‡å°‘å †ä¸Šå¯¹è±¡çš„åˆ†é…</strong>ï¼šå°½é‡ä½¿ç”¨æ ˆåˆ†é…æˆ–é€šè¿‡å¯¹è±¡æ± ï¼ˆå¦‚Â <code>sync.Pool</code>ï¼‰å¤ç”¨å¯¹è±¡ï¼Œå‡å°‘GCçš„æ‰«æå‹åŠ›<a href="https://link.juejin.cn?target=https%3A%2F%2Fdatasea.cn%2Fgo1102242465.html%23lwptoc18" target="_blank" title="https://datasea.cn/go1102242465.html#lwptoc18" ref="nofollow noopener noreferrer"/>ã€‚</li>
<li><strong>é¿å…åœ¨å¾ªç¯ä¸­åˆ›å»ºå¤§é‡ä¸´æ—¶å¯¹è±¡</strong>ï¼šè¿™ä¼šå¢åŠ GCçš„è§¦å‘é¢‘ç‡å’Œæ ‡è®°è¾…åŠ©ï¼ˆMark Assistï¼‰å·¥ä½œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.ardanlabs.com%2Fblog%2F2018%2F12%2Fgarbage-collection-in-go-part1-semantics.html%3Fmc_cid%3D0b70c1322a%26mc_eid%3D6073aa414c" target="_blank" title="https://www.ardanlabs.com/blog/2018/12/garbage-collection-in-go-part1-semantics.html?mc_cid=0b70c1322a&amp;mc_eid=6073aa414c" ref="nofollow noopener noreferrer"/>ã€‚</li>
<li><strong>åˆç†è®¾ç½®Â <code>GOGC</code>Â å‚æ•°</strong>ï¼šè¯¥å€¼ï¼ˆé»˜è®¤100ï¼‰å†³å®šäº†è§¦å‘ä¸‹ä¸€è½®GCçš„å †å†…å­˜å¢é•¿æ¯”ä¾‹ã€‚é€‚å½“è°ƒé«˜å¯é™ä½GCé¢‘ç‡ï¼ˆä»¥å ç”¨æ›´å¤šå†…å­˜ä¸ºä»£ä»·ï¼‰ï¼Œåä¹‹äº¦ç„¶ã€‚</li>
</ul>
<h2 data-id="heading-11">æ€»ç»“</h2>
<p>Goçš„GCæ˜¯ä¸€ä¸ª<strong>è¿½æ±‚æè‡´ä½å»¶è¿Ÿçš„å¹¶å‘å›æ”¶å™¨</strong>ã€‚è™½ç„¶ç†è®ºä¸Šæ— æ³•å½»åº•æ¶ˆé™¤STWï¼Œä½†å®ƒé€šè¿‡ç²¾å¦™çš„è®¾è®¡ï¼Œå·²å°†STWæ—¶é—´å‹ç¼©åˆ°ç»å¤§å¤šæ•°åº”ç”¨éƒ½éš¾ä»¥æ„ŸçŸ¥çš„æçŸ­èŒƒå›´ï¼Œè¿™ä¹Ÿæ˜¯ä¸‰è‰²æ ‡è®°ç®—æ³•åœ¨å·¥ç¨‹å®è·µä¸Šå–å¾—å·¨å¤§æˆåŠŸçš„ä½“ç°<a href="https://link.juejin.cn?target=url" target="_blank" title="url" ref="nofollow noopener noreferrer">ã€‚</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptå¼€å‘è€…å¿…å¤‡ï¼š5ä¸ªè®©ä½ çš„ä»£ç æ•ˆç‡ç¿»å€çš„éšè—æŠ€å·§]]></title>    <link>https://juejin.cn/post/7601077290681647156</link>    <guid>https://juejin.cn/post/7601077290681647156</guid>    <pubDate>2026-02-01T00:17:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601077290681647156" data-draft-id="7601049142866460672" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptå¼€å‘è€…å¿…å¤‡ï¼š5ä¸ªè®©ä½ çš„ä»£ç æ•ˆç‡ç¿»å€çš„éšè—æŠ€å·§"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-02-01T00:17:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptå¼€å‘è€…å¿…å¤‡ï¼š5ä¸ªè®©ä½ çš„ä»£ç æ•ˆç‡ç¿»å€çš„éšè—æŠ€å·§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-02-01T00:17:43.000Z" title="Sun Feb 01 2026 00:17:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-02-01
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>JavaScriptå¼€å‘è€…å¿…å¤‡ï¼š5ä¸ªè®©ä½ çš„ä»£ç æ•ˆç‡ç¿»å€çš„éšè—æŠ€å·§</strong></h2>
<h2 data-id="heading-1">å¼•è¨€</h2>
<p>åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼ŒJavaScriptå·²æˆä¸ºä¸å¯æˆ–ç¼ºçš„æ ¸å¿ƒæŠ€æœ¯ã€‚éšç€ECMAScriptè§„èŒƒçš„ä¸æ–­æ¼”è¿›å’Œæµè§ˆå™¨å¼•æ“çš„æŒç»­ä¼˜åŒ–ï¼Œè¿™é—¨è¯­è¨€æä¾›äº†è¶Šæ¥è¶Šå¤šçš„é«˜æ•ˆç¼–ç¨‹ç‰¹æ€§ã€‚ç„¶è€Œï¼Œè®¸å¤šå¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯ä¸­çº§å¼€å‘è€…ï¼‰å¾€å¾€åªåœç•™åœ¨è¡¨é¢APIçš„ä½¿ç”¨ä¸Šï¼Œå¿½ç•¥äº†JavaScriptåº•å±‚çš„ä¸€äº›å¼ºå¤§åŠŸèƒ½å’Œä¼˜åŒ–æŠ€å·§ã€‚</p>
<p>æœ¬æ–‡å°†æ­ç¤º5ä¸ªé²œä¸ºäººçŸ¥ä½†æå…¶å®ç”¨çš„JavaScriptæŠ€å·§ï¼Œè¿™äº›æ–¹æ³•ä¸ä»…èƒ½æ˜¾è‘—æå‡ä»£ç æ‰§è¡Œæ•ˆç‡ï¼Œè¿˜èƒ½è®©æ‚¨çš„ä»£ç æ›´åŠ ç®€æ´ä¼˜é›…ã€‚è¿™äº›æŠ€å·§å…¨éƒ¨åŸºäºå®˜æ–¹ECMAScriptè§„èŒƒæˆ–ç»è¿‡éªŒè¯çš„æ€§èƒ½ä¼˜åŒ–å®è·µï¼Œç»éå‡­ç©ºæé€ ã€‚</p>
<h2 data-id="heading-2">ä¸»ä½“å†…å®¹</h2>
<h3 data-id="heading-3">1. åˆ©ç”¨ä½è¿ç®—ç¬¦è¿›è¡Œé«˜æ€§èƒ½æ•°å­¦è®¡ç®—</h3>
<h4 data-id="heading-4">åŸç†ä¸åº”ç”¨åœºæ™¯</h4>
<p>JavaScriptä¸­çš„æ‰€æœ‰æ•°å€¼éƒ½ä»¥64ä½æµ®ç‚¹æ•°å­˜å‚¨ï¼Œä½†åœ¨ä½è¿ç®—æ—¶ä¼šä¸´æ—¶è½¬æ¢ä¸º32ä½æ•´æ•°ã€‚è¿™ç§ç‰¹æ€§ä½¿å¾—ä½è¿ç®—æˆä¸ºæœ€é«˜æ•ˆçš„æ•°å€¼æ“ä½œæ–¹å¼ä¹‹ä¸€ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¿«é€Ÿå–æ•´ï¼ˆæ¯”Math.floorå¿«çº¦20%ï¼‰</span>
<span class="hljs-keyword">const</span> value = <span class="hljs-number">12.7</span> | <span class="hljs-number">0</span>; <span class="hljs-comment">// =&gt; 12</span>

<span class="hljs-comment">// å¥‡å¶åˆ¤æ–­ï¼ˆæ¯”æ¨¡è¿ç®—å¿«50%ï¼‰</span>
<span class="hljs-keyword">if</span> (value &amp; <span class="hljs-number">1</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¥‡æ•°'</span>);
}

<span class="hljs-comment">// äº¤æ¢å˜é‡ï¼ˆæ— éœ€ä¸´æ—¶å˜é‡ï¼‰</span>
<span class="hljs-keyword">let</span> a = <span class="hljs-number">1</span>, b = <span class="hljs-number">2</span>;
a ^= b; b ^= a; a ^= b;
</code></pre>
<h4 data-id="heading-5">æ€§èƒ½å¯¹æ¯”</h4>
<p>æ ¹æ®JSBench.meæµ‹è¯•ï¼š</p>
<ul>
<li><code>x | 0</code> vs <code>Math.floor(x)</code>ï¼šå‰è€…å¿«1.2å€</li>
<li><code>x &amp; 1</code> vs <code>x % 2 === 1</code>ï¼šå‰è€…å¿«1.5å€</li>
</ul>
<h4 data-id="heading-6">æ³¨æ„äº‹é¡¹</h4>
<ul>
<li><strong>èŒƒå›´é™åˆ¶</strong>ï¼š32ä½æœ‰ç¬¦å·æ•´æ•°èŒƒå›´ä¸º[-2Â³Â¹, 2Â³Â¹-1]</li>
<li><strong>å¯è¯»æ€§</strong>ï¼šå›¢é˜Ÿé¡¹ç›®ä¸­åº”æ·»åŠ é€‚å½“æ³¨é‡Š</li>
</ul>
<h3 data-id="heading-7">2. Memoizationç¼“å­˜å‡½æ•°ç»“æœ</h3>
<h4 data-id="heading-8">Reactä¸­çš„ç»å…¸åº”ç”¨</h4>
<p>Memoizationæ˜¯å‡½æ•°å¼ç¼–ç¨‹ä¸­çš„é‡è¦ä¼˜åŒ–æŠ€æœ¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">memoize</span> = (<span class="hljs-params">fn</span>) =&gt; {
    <span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> key = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(args);
        <span class="hljs-keyword">return</span> cache.<span class="hljs-title function_">has</span>(key) 
            ? cache.<span class="hljs-title function_">get</span>(key)
            : (cache.<span class="hljs-title function_">set</span>(key, <span class="hljs-title function_">fn</span>(...args)), cache.<span class="hljs-title function_">get</span>(key));
    };
};

<span class="hljs-comment">// Fibonacciæ•°åˆ—è®¡ç®—çš„ä¼˜åŒ–ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> fib = <span class="hljs-title function_">memoize</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> n &lt;= <span class="hljs-number">1</span> ? n : <span class="hljs-title function_">fib</span>(n - <span class="hljs-number">1</span>) + <span class="hljs-title function_">fib</span>(n - <span class="hljs-number">2</span>));
</code></pre>
<h4 data-id="heading-9">V8å¼•æ“çš„éšè—ä¼˜åŒ–</h4>
<p>ç°ä»£JavaScriptå¼•æ“ä¼šå¯¹çº¯å‡½æ•°è¿›è¡Œè‡ªåŠ¨ç¼“å­˜ä¼˜åŒ–ï¼š</p>
<ul>
<li>V8çš„"inline caching"æœºåˆ¶</li>
<li>SpiderMonkeyçš„"type inference"ç³»ç»Ÿ</li>
</ul>
<h3 data-id="heading-10">3. Web Workersä¸­çš„è½¬ç§»å¯¹è±¡(Transferable Objects)</h3>
<h4 data-id="heading-11">DOMä¸Workeré€šä¿¡ç“¶é¢ˆçªç ´</h4>
<p>ä¼ ç»ŸpostMessageéœ€è¦è¿›è¡Œç»“æ„åŒ–å…‹éš†ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-string">'worker.js'</span>);
<span class="hljs-keyword">const</span> largeBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">10000000</span>);

<span class="hljs-comment">// âŒä¼ ç»Ÿæ–¹å¼ï¼ˆå¤åˆ¶å†…å­˜ï¼‰</span>
worker.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">buffer</span>: largeBuffer });

<span class="hljs-comment">// âœ…é«˜æ•ˆæ–¹å¼ï¼ˆæ‰€æœ‰æƒè½¬ç§»ï¼‰</span>
worker.<span class="hljs-title function_">postMessage</span>({ <span class="hljs-attr">buffer</span>: largeBuffer }, [largeBuffer]);
</code></pre>
<h4 data-id="heading-12">APIæ”¯æŒæƒ…å†µï¼š</h4>























<table><thead><tr><th>API</th><th>Chrome</th><th>Firefox</th><th>Safari</th></tr></thead><tbody><tr><td>Transferable</td><td>âœ“</td><td>âœ“</td><td>âœ“</td></tr><tr><td>SharedArrayBuffer</td><td>âœ“</td><td>âœ“</td><td>âœ—</td></tr></tbody></table>
<h3 data-id="heading-13">4. Proxyå¯¹è±¡çš„æ€§èƒ½æ•æ„Ÿåº”ç”¨</h3>
<h4 data-id="heading-14">Vue3å“åº”å¼ç³»ç»Ÿçš„æ ¸å¿ƒåŸç†ï¼š</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> reactiveHandler = {
    <span class="hljs-title function_">get</span>(<span class="hljs-params">target, prop</span>) {
        <span class="hljs-title function_">track</span>(target, prop); <span class="hljs-comment">// Vueä¾èµ–æ”¶é›†</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">get</span>(...<span class="hljs-variable language_">arguments</span>);
    },
    <span class="hljs-title function_">set</span>(<span class="hljs-params">target, prop, value</span>) {
        <span class="hljs-title function_">trigger</span>(target, prop); <span class="hljs-comment">// Vueè§¦å‘æ›´æ–°</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">set</span>(...<span class="hljs-variable language_">arguments</span>);
    }
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">reactive</span>(<span class="hljs-params">obj</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Proxy</span>(obj, reactiveHandler);
}
</code></pre>
<h4 data-id="heading-15">Proxyæ€§èƒ½ä¼˜åŒ–è¦ç‚¹ï¼š</h4>
<ul>
<li><strong>é¿å…é¢‘ç¹åˆ›å»º</strong>ï¼šåº”è¯¥å¤ç”¨Proxyå®ä¾‹</li>
<li><strong>å‡å°‘trapå¤æ‚åº¦</strong>ï¼šhandlerä¸­çš„é€»è¾‘åº”å°½é‡ç®€å•</li>
<li><strong>é…åˆWeakMapä½¿ç”¨</strong>ï¼šå»ºç«‹åŸå§‹å¯¹è±¡åˆ°Proxyçš„æ˜ å°„è¡¨</li>
</ul>
<h3 data-id="heading-16">5. Generatorå‡½æ•°çš„å¼‚æ­¥æ§åˆ¶æµç®¡ç†</h3>
<h4 data-id="heading-17">Redux-Sagaçš„å®ç°å“²å­¦ï¼š</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>* <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params">action</span>) {  
    <span class="hljs-keyword">try</span> {    
        <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">yield</span> <span class="hljs-title function_">call</span>(fetchApi, <span class="hljs-string">'/user'</span>);    
        <span class="hljs-keyword">yield</span> <span class="hljs-title function_">put</span>({<span class="hljs-attr">type</span>: <span class="hljs-string">'FETCH_SUCCESS'</span>, user});  
    } <span class="hljs-keyword">catch</span> (e) {    
        <span class="hljs-keyword">yield</span> <span class="hljs-title function_">put</span>({<span class="hljs-attr">type</span>: <span class="hljs-string">'FETCH_FAIL'</span>, <span class="hljs-attr">error</span>: e});  
    }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">runGenerator</span>(<span class="hljs-params">gen</span>) {
    <span class="hljs-keyword">const</span> it = <span class="hljs-title function_">gen</span>();
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">handle</span>(<span class="hljs-params">result</span>) {
        <span class="hljs-keyword">if</span> (result.<span class="hljs-property">done</span>) <span class="hljs-keyword">return</span>;
        
        result.<span class="hljs-property">value</span>.<span class="hljs-title function_">then</span>(
            <span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> <span class="hljs-title function_">handle</span>(it.<span class="hljs-title function_">next</span>(res)),
            <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> <span class="hljs-title function_">handle</span>(it.<span class="hljs-keyword">throw</span>(err))
        );
    }
    
    <span class="hljs-title function_">handle</span>(it.<span class="hljs-title function_">next</span>());
}
</code></pre>
<h4 data-id="heading-18">Generator vs Async/Await:</h4>

























<table><thead><tr><th>Feature</th><th>Generator</th><th>Async/Await</th></tr></thead><tbody><tr><td>Cancelation</td><td>âœ“</td><td>âœ—</td></tr><tr><td>Complex control</td><td>âœ“</td><td>â–³</td></tr><tr><td>Debugging</td><td>â–³</td><td>âœ“</td></tr></tbody></table>
<h2 data-id="heading-19">Conclusion</h2>
<p>æŒæ¡è¿™äº›é«˜çº§JavaScriptæŠ€å·§éœ€è¦æ—¶é—´å’Œå®è·µç§¯ç´¯ã€‚å»ºè®®è¯»è€…å¯ä»¥ï¼š</p>
<ol>
<li><strong>æ¸è¿›å¼é‡‡ç”¨</strong>ï¼šä»æœ€ç®€å•çš„ä½è¿ç®—å¼€å§‹å°è¯•</li>
<li><strong>æ€§èƒ½æµ‹é‡</strong>ï¼šå§‹ç»ˆä½¿ç”¨DevToolsè¿›è¡ŒåŸºå‡†æµ‹è¯•</li>
<li><strong>ç†è§£åŸç†</strong>ï¼šé˜…è¯»ECMAScriptè§„èŒƒç›¸å…³ç« èŠ‚</li>
</ol>
<p>è®°ä½ï¼š"Premature optimization is the root of all evil" - Donald Knuthã€‚åœ¨åº”ç”¨è¿™äº›æŠ€æœ¯æ—¶ï¼ŒåŠ¡å¿…å…ˆç¡®è®¤ç¡®å®å­˜åœ¨æ€§èƒ½ç“¶é¢ˆå†è¿›è¡Œé’ˆå¯¹æ€§ä¼˜åŒ–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ78ï¼‰å¦‚ä½•åœ¨GraphQLæœåŠ¡ä¸­ä½¿ç”¨Hibernateï¼Ÿ]]></title>    <link>https://juejin.cn/post/7601144981169979442</link>    <guid>https://juejin.cn/post/7601144981169979442</guid>    <pubDate>2026-01-31T23:04:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601144981169979442" data-draft-id="7601229476794761266" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ78ï¼‰å¦‚ä½•åœ¨GraphQLæœåŠ¡ä¸­ä½¿ç”¨Hibernateï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-31T23:04:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ78ï¼‰å¦‚ä½•åœ¨GraphQLæœåŠ¡ä¸­ä½¿ç”¨Hibernateï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T23:04:36.000Z" title="Sat Jan 31 2026 23:04:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨GraphQLæœåŠ¡ä¸­ä½¿ç”¨Hibernateæ˜¯ä¸€ä¸ªæœ‰è¶£ä¸”å¼ºå¤§çš„ç»„åˆã€‚ä½ å¯ä»¥åˆ©ç”¨Spring Bootå’ŒHibernateæ¥å¤„ç†æ•°æ®æŒä¹…åŒ–ï¼Œå¹¶ä½¿ç”¨Spring Bootçš„GraphQLæ¨¡å—å®ç°GraphQL APIã€‚ä¸‹é¢æˆ‘ä»¬è¯¦ç»†è¯´æ˜å¦‚ä½•å®ç°è¿™ä¸€ç›®æ ‡ã€‚</p>
<h3 data-id="heading-0">1. é¡¹ç›®ä¾èµ–</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨<code>pom.xml</code>ä¸­æ·»åŠ å¿…è¦çš„ä¾èµ–ï¼ŒåŒ…æ‹¬Spring Bootã€Hibernateã€MySQLå’ŒGraphQLçš„ä¾èµ–ã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Spring Boot Starter Data JPA --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- MySQL Connector --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.26<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- HikariCP for Connection Pooling --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.zaxxer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>HikariCP<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Spring Boot Starter Web --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Spring Boot Starter GraphQL --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.graphql-java-kickstart<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>graphql-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>11.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- GraphQL Java Tools --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.graphql-java-kickstart<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>graphql-java-tools<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>11.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Lombok --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.20<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h3 data-id="heading-1">2. é…ç½®æ•°æ®æºå’ŒHibernateå±æ€§</h3>
<p>åœ¨<code>application.properties</code>ä¸­é…ç½®MySQLæ•°æ®æºï¼š</p>
<pre><code class="hljs language-properties" lang="properties"># MySQL Database Configuration
spring.datasource.url=jdbc:mysql://localhost:3306/mydatabase
spring.datasource.username=root
spring.datasource.password=rootpassword
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
</code></pre>
<h3 data-id="heading-2">3. åˆ›å»ºé¢†åŸŸæ¨¡å‹</h3>
<h4 data-id="heading-3"><code>Product.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "products")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {

    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String description;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> price;
}
</code></pre>
<h3 data-id="heading-4">4. åˆ›å»ºä»“å‚¨æ¥å£</h3>
<h4 data-id="heading-5"><code>ProductRepository.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ProductRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;Product, Long&gt; {
}
</code></pre>
<h3 data-id="heading-6">5. åˆ›å»ºæœåŠ¡å±‚</h3>
<h4 data-id="heading-7"><code>ProductService.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ProductRepository productRepository;

    <span class="hljs-keyword">public</span> List&lt;Product&gt; <span class="hljs-title function_">getAllProducts</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> productRepository.findAll();
    }

    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProductById</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-keyword">return</span> productRepository.findById(id).orElse(<span class="hljs-literal">null</span>);
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">createProduct</span><span class="hljs-params">(Product product)</span> {
        <span class="hljs-keyword">return</span> productRepository.save(product);
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">updateProduct</span><span class="hljs-params">(Long id, Product productDetails)</span> {
        <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> productRepository.findById(id).orElse(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            product.setName(productDetails.getName());
            product.setDescription(productDetails.getDescription());
            product.setPrice(productDetails.getPrice());
            <span class="hljs-keyword">return</span> productRepository.save(product);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteProduct</span><span class="hljs-params">(Long id)</span> {
        productRepository.deleteById(id);
    }
}
</code></pre>
<h3 data-id="heading-8">6. åˆ›å»ºGraphQL Schema</h3>
<p>åœ¨<code>src/main/resources/graphql</code>ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªGraphQL schemaæ–‡ä»¶<code>schema.graphqls</code>ï¼š</p>
<pre><code class="hljs language-graphql" lang="graphql"><span class="hljs-keyword">type</span> Product <span class="hljs-punctuation">{</span>
    <span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> ID<span class="hljs-punctuation">!</span>
    <span class="hljs-symbol">name</span><span class="hljs-punctuation">:</span> String<span class="hljs-punctuation">!</span>
    <span class="hljs-symbol">description</span><span class="hljs-punctuation">:</span> String
    <span class="hljs-symbol">price</span><span class="hljs-punctuation">:</span> Float<span class="hljs-punctuation">!</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-keyword">type</span> <span class="hljs-keyword">Query</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-symbol">products</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>Product<span class="hljs-punctuation">!</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">!</span>
    product<span class="hljs-punctuation">(</span><span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> ID<span class="hljs-punctuation">!</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">:</span> Product
<span class="hljs-punctuation">}</span>

<span class="hljs-keyword">type</span> <span class="hljs-keyword">Mutation</span> <span class="hljs-punctuation">{</span>
    createProduct<span class="hljs-punctuation">(</span><span class="hljs-symbol">name</span><span class="hljs-punctuation">:</span> String<span class="hljs-punctuation">!</span>, <span class="hljs-symbol">description</span><span class="hljs-punctuation">:</span> String, <span class="hljs-symbol">price</span><span class="hljs-punctuation">:</span> Float<span class="hljs-punctuation">!</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">:</span> Product<span class="hljs-punctuation">!</span>
    updateProduct<span class="hljs-punctuation">(</span><span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> ID<span class="hljs-punctuation">!</span>, <span class="hljs-symbol">name</span><span class="hljs-punctuation">:</span> String, <span class="hljs-symbol">description</span><span class="hljs-punctuation">:</span> String, <span class="hljs-symbol">price</span><span class="hljs-punctuation">:</span> Float<span class="hljs-punctuation">)</span><span class="hljs-punctuation">:</span> Product<span class="hljs-punctuation">!</span>
    deleteProduct<span class="hljs-punctuation">(</span><span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> ID<span class="hljs-punctuation">!</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">:</span> Boolean<span class="hljs-punctuation">!</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-9">7. åˆ›å»ºGraphQL Resolvers</h3>
<h4 data-id="heading-10"><code>ProductQueryResolver.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.coxautodev.graphql.tools.GraphQLQueryResolver;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductQueryResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">GraphQLQueryResolver</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ProductService productService;

    <span class="hljs-keyword">public</span> List&lt;Product&gt; <span class="hljs-title function_">getProducts</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> productService.getAllProducts();
    }

    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProduct</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-keyword">return</span> productService.getProductById(id);
    }
}
</code></pre>
<h4 data-id="heading-11"><code>ProductMutationResolver.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> com.coxautodev.graphql.tools.GraphQLMutationResolver;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Component;

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductMutationResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">GraphQLMutationResolver</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ProductService productService;

    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">createProduct</span><span class="hljs-params">(String name, String description, <span class="hljs-type">double</span> price)</span> {
        <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();
        product.setName(name);
        product.setDescription(description);
        product.setPrice(price);
        <span class="hljs-keyword">return</span> productService.createProduct(product);
    }

    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">updateProduct</span><span class="hljs-params">(Long id, String name, String description, <span class="hljs-type">double</span> price)</span> {
        <span class="hljs-type">Product</span> <span class="hljs-variable">productDetails</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>();
        productDetails.setName(name);
        productDetails.setDescription(description);
        productDetails.setPrice(price);
        <span class="hljs-keyword">return</span> productService.updateProduct(id, productDetails);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">deleteProduct</span><span class="hljs-params">(Long id)</span> {
        productService.deleteProduct(id);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<h3 data-id="heading-12">8. åˆ›å»ºSpring Bootåº”ç”¨ä¸»ç±»</h3>
<h4 data-id="heading-13"><code>Application.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Application</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        SpringApplication.run(Application.class, args);
    }
}
</code></pre>
<h3 data-id="heading-14">9. è¿è¡Œåº”ç”¨</h3>
<ol>
<li><strong>å¯åŠ¨MySQL</strong>ï¼šç¡®ä¿ä½ çš„MySQLæ•°æ®åº“è¿è¡Œåœ¨<code>localhost:3306</code>ã€‚</li>
<li><strong>åˆ›å»ºæ•°æ®åº“</strong>ï¼šåˆ›å»ºä¸€ä¸ªåä¸º<code>mydatabase</code>çš„æ•°æ®åº“ã€‚</li>
<li><strong>å¯åŠ¨Spring Bootåº”ç”¨</strong>ï¼šè¿è¡ŒSpring Bootåº”ç”¨ç¨‹åºã€‚</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">mvn spring-boot:run
</code></pre>
<h3 data-id="heading-15">10. æµ‹è¯•GraphQL API</h3>
<p>ä½ å¯ä»¥ä½¿ç”¨GraphiQLæˆ–Postmanæ¥æµ‹è¯•ä½ çš„GraphQL APIã€‚GraphiQLæ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å›¾å½¢åŒ–å·¥å…·ï¼Œå¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­å‘é€GraphQLæŸ¥è¯¢ã€‚</p>
<h4 data-id="heading-16">æŸ¥è¯¢æ‰€æœ‰äº§å“</h4>
<pre><code class="hljs language-graphql" lang="graphql"><span class="hljs-keyword">query</span> <span class="hljs-punctuation">{</span>
  products <span class="hljs-punctuation">{</span>
    id
    name
    description
    price
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-17">æŸ¥è¯¢å•ä¸ªäº§å“</h4>
<pre><code class="hljs language-graphql" lang="graphql"><span class="hljs-keyword">query</span> <span class="hljs-punctuation">{</span>
  product<span class="hljs-punctuation">(</span><span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
    id
    name
    description
    price
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-18">åˆ›å»ºäº§å“</h4>
<pre><code class="hljs language-graphql" lang="graphql"><span class="hljs-keyword">mutation</span> <span class="hljs-punctuation">{</span>
  createProduct<span class="hljs-punctuation">(</span><span class="hljs-symbol">name</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Laptop"</span>, <span class="hljs-symbol">description</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"A high-end gaming laptop"</span>, <span class="hljs-symbol">price</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1500.00</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
    id
    name
    description
    price
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-19">æ›´æ–°äº§å“</h4>
<pre><code class="hljs language-graphql" lang="graphql"><span class="hljs-keyword">mutation</span> <span class="hljs-punctuation">{</span>
  updateProduct<span class="hljs-punctuation">(</span><span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span>, <span class="hljs-symbol">name</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Gaming Laptop"</span>, <span class="hljs-symbol">description</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"An updated high-end gaming laptop"</span>, <span class="hljs-symbol">price</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1600.00</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
    id
    name
    description
    price
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-20">åˆ é™¤äº§å“</h4>
<pre><code class="hljs language-graphql" lang="graphql"><span class="hljs-keyword">mutation</span> <span class="hljs-punctuation">{</span>
  deleteProduct<span class="hljs-punctuation">(</span><span class="hljs-symbol">id</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-21">æ€»ç»“</h3>
<p>é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•åœ¨Spring Bootä¸­ä½¿ç”¨Hibernateåˆ›å»ºä¸€ä¸ªGraphQLæœåŠ¡ï¼ŒåŒ…æ‹¬å®šä¹‰é¢†åŸŸæ¨¡å‹ã€åˆ›å»ºä»“å‚¨æ¥å£ã€å®ç°æœåŠ¡å±‚ã€å®šä¹‰GraphQL schemaå’Œåˆ›å»ºGraphQL resolversã€‚åœ¨GraphQLæœåŠ¡ä¸­ï¼ŒHibernateå¯ä»¥å¾ˆå¥½åœ°å¤„ç†æŒä¹…åŒ–ï¼Œä»è€Œå®ç°æ¸…æ™°çš„ä¸šåŠ¡é€»è¾‘å’ŒæŒä¹…åŒ–é€»è¾‘åˆ†ç¦»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026ï¼šç»™è¿‡å»çš„è‡ªå·±å‘Šåˆ«ï¼Œåœ¨ç”»ç¬”ä¸ä»£ç é—´ç ´å†°]]></title>    <link>https://juejin.cn/post/7601041482892984370</link>    <guid>https://juejin.cn/post/7601041482892984370</guid>    <pubDate>2026-01-31T16:46:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601041482892984370" data-draft-id="7601229476794613810" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026ï¼šç»™è¿‡å»çš„è‡ªå·±å‘Šåˆ«ï¼Œåœ¨ç”»ç¬”ä¸ä»£ç é—´ç ´å†°"/> <meta itemprop="keywords" content="åˆ›ä¸š"/> <meta itemprop="datePublished" content="2026-01-31T16:46:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¯’ç’ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/2559318802827933"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026ï¼šç»™è¿‡å»çš„è‡ªå·±å‘Šåˆ«ï¼Œåœ¨ç”»ç¬”ä¸ä»£ç é—´ç ´å†°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2559318802827933/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¯’ç’ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T16:46:13.000Z" title="Sat Jan 31 2026 16:46:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è·ç¦»ä¸Šæ¬¡åŠ¨ç¬”å†™æ–‡ç« ï¼Œå·²ç»è¿‡å»äº†å¤ªä¹…ã€‚2025å¹´ï¼Œæ˜¯ä¸€ä¸ªæ³¨å®šä¼šè¢«æˆ‘åå¤é“­è®°çš„å¹´ä»½ã€‚åœ¨è¿™ä¸€å¹´ï¼Œæˆ‘åœ¨å·¥ä½œäº†äº”å¹´çš„å…¬å¸æ­£å¼â€œæ¯•ä¸šâ€äº†ã€‚</p>
<h3 data-id="heading-0">1. å›æœ›ï¼šç‰¹ç«‹ç‹¬è¡Œçš„å¼€å‘ä¹‹è·¯</h3>
<p>å›é¡¾ä¹‹å‰çš„èŒä¸šç”Ÿæ¶¯ï¼Œæˆ‘ç®—æ˜¯ä¸€ä¸ªæœ‰äº›â€œå¼‚ç±»â€çš„å‰ç«¯å¼€å‘ã€‚</p>
<p>åœ¨å¤§å¤šæ•°äººçš„å°è±¡é‡Œï¼Œå‰ç«¯ç¦»ä¸å¼€ React æˆ– Vue æ¡†æ¶ï¼Œç¦»ä¸å¼€å¤æ‚çš„ CSSã€‚ä½†åœ¨æœ€åˆä¸¤å¹´çš„å‰ç«¯ç”Ÿæ¶¯ä¸­ï¼Œå—é™äºå…¬å¸çš„å†³ç­–ï¼Œæˆ‘å‡ ä¹æ²¡ç¢°è¿‡ä¸»æµæ¡†æ¶ï¼Œä¹Ÿä¸æ€ä¹ˆå†™ CSSï¼Œä¸€ç›´åšæŒç”¨åŸç”Ÿ JavaScript å†™ä¸šåŠ¡é€»è¾‘ã€‚</p>
<p>è¿™ç§â€œæ‰‹æ“ä»£ç â€çš„ç»å†æ˜¯ä¸€æŠŠåŒåˆƒå‰‘ï¼šä¸€æ–¹é¢ï¼Œå®ƒå¯¼è‡´å¼€å‘æ•ˆç‡ä½ä¸‹ï¼Œä¸”å¯¹å¼€å‘è€…çš„è¦æ±‚æé«˜ï¼Œç¨æœ‰ä¸æ…å°±ä¼šå¼•å‘å†…å­˜æ³„æ¼å’Œæ€§èƒ½é—®é¢˜ï¼›å¦ä¸€æ–¹é¢ï¼Œå®ƒä¹Ÿé€¼ç€æˆ‘ç›´æ¥é¢å¯¹åº•å±‚é€»è¾‘ã€‚å›å¤´çœ‹ï¼Œå½“æ—¶äº§å“åæœŸçš„ Bug é¢‘å‘ï¼Œå›ºç„¶æœ‰ä¸ä½¿ç”¨æ¡†æ¶çš„åŸå› ï¼Œä½†æ›´æ ¸å¿ƒçš„é—®é¢˜åœ¨äºå‰æœŸçš„æ¶æ„è®¾è®¡ã€‚</p>
<p>åæ¥ï¼Œæˆ‘è½¬å…¥äº†å°æ¸¸æˆå¼€å‘èµ›é“ã€‚è™½ç„¶åŒæ ·ä½¿ç”¨ TypeScriptï¼Œä½†æŠ€æœ¯æ ˆå´å¤©å·®åœ°åˆ«ã€‚åœ¨ Cocos Creatorï¼ˆ1.9ç‰ˆæœ¬ï¼‰çš„ä¸–ç•Œé‡Œï¼Œæˆ‘ä¸»è¦åšä¸€äº›ç›Šæ™ºè§£è°œç±»çš„å°æ¸¸æˆç‰‡æ®µã€‚è¿™æ®µç»å†è®©æˆ‘ä¹ æƒ¯äº†ä»æ¸¸æˆå¼•æ“çš„è§†è§’å»æ€è€ƒé€»è¾‘ï¼Œä¹Ÿä¸ºæˆ‘åæ¥çš„è½¬å‹åŸ‹ä¸‹äº†ä¼ç¬”ã€‚</p>
<h3 data-id="heading-1">2. å›°å±€ï¼šç„¦è™‘ä¸è«åå…¶å¦™çš„å¤´æ™•</h3>
<p>æ¯•ä¸šåçš„æ±‚èŒä¹‹è·¯å¹¶ä¸é¡ºåˆ©ã€‚æˆ‘é¢è¿‡äº¬ä¸œï¼Œåˆ°äº†ç»ˆé¢å´æ²¡äº†ä¸‹æ–‡ï¼›ä¹Ÿé¢è¿‡ä¸€å®¶è‡ªè®¤ä¸ºæŠŠæ¡å¾ˆå¤§çš„æ¸¸æˆå…¬å¸ï¼Œç»“æœåŒæ ·åœ¨ç»ˆé¢æŠ˜æˆŸã€‚</p>
<p>è¿ç»­çš„å¤±åˆ©è®©æˆ‘é™·å…¥äº†å·¨å¤§çš„ç„¦è™‘ä¸­ã€‚ä¼´éšç„¦è™‘è€Œæ¥çš„ï¼Œæ˜¯èº«ä½“çš„æŠ—è®®ã€‚é‚£æ®µæ—¶é—´æˆ‘ç»å¸¸æ„Ÿåˆ°å¤´æ™•ï¼Œå³ä½¿åç€ä¸åŠ¨ä¹Ÿè§‰å¾—å¤©æ—‹åœ°è½¬ã€‚å»åŒ»é™¢æ£€æŸ¥äº†ä¸€åœˆï¼ŒåŒ»ç”Ÿè¯´æ˜¯å¿ƒç†å‹åŠ›å¯¼è‡´çš„ï¼Œå¼€äº†äº›æ”¹å–„å¾ªç¯çš„è¯ï¼Œä½†è¯ä¸€åœï¼Œçœ©æ™•æ„Ÿå°±åˆä¼šè¢­æ¥ã€‚</p>
<p>è¿™ç§æµ‘æµ‘å™©å™©çš„çŠ¶æ€ä¸€ç›´æŒç»­åˆ° 2025 å¹´åº•ã€‚ç›´åˆ° 12 æœˆï¼Œæˆ‘å‘ç°è‡ªå·±çš„å¿ƒæ€å‘ç”Ÿäº†å˜åŒ–ï¼šæ—¢ç„¶æ‰¾ä¸åˆ°åˆé€‚çš„å·¥ä½œï¼Œä¸å¦‚è‡ªå·±å¹²å§ã€‚</p>
<h3 data-id="heading-2">3. ç ´å†°ï¼šå½“ç”»ç¬”æ²»æ„ˆäº†çœ©æ™•</h3>
<p>å†³å®šâ€œè‡ªå·±å¹²â€åï¼Œæˆ‘å¼€å§‹æ¡èµ·ç”»ç”»è¿™ä¸ªçˆ±å¥½ã€‚</p>
<p>ç”±äºåšå°æ¸¸æˆéœ€è¦è‡ªå·±åˆ‡å›¾ã€ç”» UI å›¾æ ‡ï¼Œæˆ‘ä¾¿æ¯å¤©èŠ±æ—¶é—´åœ¨ç”»æ¿ä¸Šã€‚ç¥å¥‡çš„æ˜¯ï¼Œç”»ç”»ä¼¼ä¹æœ‰ä¸€ç§æŠšå¹³ç„¦è™‘çš„é­”åŠ›ã€‚åªè¦æˆ‘æ¡èµ·ç”»ç¬”ï¼Œé‚£ç§å¦‚å½±éšå½¢çš„å¤´æ™•æ„Ÿå°±ä¼šæ¶ˆå¤±ã€‚æˆ‘å‘ç°ï¼Œè¿™ç§çº¯ç²¹çš„åˆ›ä½œè¿‡ç¨‹ï¼Œå…¶å®æ˜¯å¯¹è‡ªæˆ‘ç²¾ç¥çš„ä¸€ç§é‡å»ºã€‚</p>
<p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘é€šè¿‡ç”»ç”»æ²»æ„ˆäº†èº«ä½“çš„ååº”ï¼Œä¹Ÿé€šè¿‡è‡ªçœæ‰¾åˆ°äº†æ–°çš„æŠ€æœ¯æ–¹å‘â€”â€”<strong>é¸¿è’™å¼€å‘</strong>ã€‚</p>
<h3 data-id="heading-3">4. å¥‘æœºï¼šä¸ºä»€ä¹ˆé€‰æ‹©é¸¿è’™ ï¼Ÿ</h3>
<p>æ¥è§¦é¸¿è’™èµ·åˆæ˜¯å› ä¸ºä¸€ä¸ªå¼€å‘è€…æ¿€åŠ±æ´»åŠ¨ï¼Œè™½ç„¶æœ€åå› ä¸ºæ—¶é—´å¤ªç´§æ²¡èƒ½èµ¶ä¸Šæ´»åŠ¨æˆªæ­¢ï¼Œä½†è¿™æ¬¡â€œæ“¦è‚©è€Œè¿‡â€å´è®©æˆ‘æ·±å…¥äº†è§£äº† HarmonyOS NEXTã€‚</p>
<p>æˆ‘çœ‹å¥½è¿™ä¸ªèµ›é“ï¼Œç†ç”±å¾ˆæœ´å®ï¼š</p>
<ul>
<li><strong>å…¨æ–°çš„èµ·è·‘çº¿ï¼š</strong> å½»åº•æŠ›å¼ƒå®‰å“å…¼å®¹ï¼Œæ„å‘³ç€è¿™æ˜¯ä¸€ä¸ªçº¯ç²¹çš„åŸç”Ÿæ–°èµ›é“ï¼Œç«äº‰å°šä¸æ¿€çƒˆã€‚</li>
<li><strong>å›½å®¶çº§çš„æ”¯æŒï¼š</strong> ä»æ”¿ç­–å¯¼å‘åˆ°è¡Œä¸šåº”ç”¨ï¼Œå›½äº§æ“ä½œç³»ç»Ÿçš„çº¢åˆ©æœŸæ­£åœ¨åˆ°æ¥ã€‚</li>
<li><strong>æŠ€æœ¯å¹³ç§»çš„ä¼˜åŠ¿ï¼š</strong> ArkTS ä¸ TypeScript é«˜åº¦ç›¸ä¼¼ï¼Œä¸Šæ‰‹å¾ˆå¿«ã€‚å°¤å…¶æ˜¯å®ƒå¯¹ Native åº•å±‚çš„åŸºå»ºéå¸¸å®Œå–„ï¼ŒNode-API çš„ç”¨æ³•ä¸ Node.js æ‰©å±•å¼€å‘å¦‚å‡ºä¸€è¾™ï¼Œå­¦é¸¿è’™çš„åŒæ—¶ï¼Œé¡ºä¾¿æŠŠ Native å¼€å‘ä¹Ÿé’»ç ”äº†ã€‚</li>
<li><strong>æ–‡æ¡£å‹å¥½ï¼š</strong> é¸¿è’™çš„å®˜æ–¹æ–‡æ¡£æå…¶è¯¦ç»†ï¼Œä¸­æ–‡è§£é‡Šå’Œç¤ºä¾‹ä»£ç å¯¹å¼€å‘è€…éå¸¸å‹å¥½ï¼Œè¿™åœ¨å­¦ä¹ é˜¶æ®µèƒ½çœå»å¤§é‡æ‘¸ç´¢çš„æ—¶é—´ã€‚</li>
</ul>
<p>å½“ç„¶ï¼Œæˆ‘ä¹Ÿå­˜äº†ä¸€ä»½â€œæŠ€æœ¯æŠ¥å›½â€çš„æƒ…æ€€ã€‚èƒ½ä¸ºå›½äº§æ“ä½œç³»ç»Ÿçš„ç”Ÿæ€è´¡çŒ®ä¸€ä»½åŠ›é‡ï¼Œå“ªæ€•åªæ˜¯ä¸€ä¸ªå°åº”ç”¨ï¼Œä¹Ÿæ˜¯ä¸€ä»¶æŒºé…·çš„äº‹ã€‚</p>
<h3 data-id="heading-4">5. 2026ï¼šè‡ªå¾‹å³è‡ªç”±</h3>
<p>ç°åœ¨ï¼Œæˆ‘å·²ç»æŠŠç”Ÿæ´»ç†å‡ºäº†èŠ‚å¥ã€‚æ¯å¤©çš„æ—¶é—´è¢«æ‹†åˆ†æˆå‡ ä¸ªå›ºå®šçš„æ¨¡å—ï¼š</p>
<ul>
<li><strong>æ—©èµ· 1 å°æ—¶ï¼š</strong> å­¦ä¹ è‹±è¯­ã€‚</li>
<li><strong>2 å°æ—¶å·¦å³ï¼š</strong> å­¦ä¹ é¸¿è’™å¼€å‘çŸ¥è¯†ã€‚</li>
<li><strong>4 å°æ—¶å·¦å³ï¼š</strong> æ ¸å¿ƒçš„å°æ¸¸æˆå¼€å‘ã€‚</li>
<li><strong>2 å°æ—¶å·¦å³ï¼š</strong> éšå¿ƒç”»ç”»ï¼Œè¿™æ—¢æ˜¯å·¥ä½œä¹Ÿæ˜¯æ²»ç–—ã€‚</li>
<li><strong>å‰©ä¸‹çš„æ—¶é—´ï¼š</strong> ç»™å®¶äººï¼Œæˆ–è€…ç»™è‡ªå·±ä¸€ç‚¹é¢“åºŸå’Œé”»ç‚¼çš„ç©ºé—´ã€‚</li>
</ul>
<p>è¿™äº›äº‹æƒ…äº¤å‰è¿›è¡Œï¼Œå·²ç»å½¢æˆäº†æˆ‘çš„æ—¥å¸¸ã€‚</p>
<h3 data-id="heading-5">ç»“è¯­</h3>
<p>2026 å¹´ï¼Œæˆ‘ä¼šé™†ç»­æ›´æ–°ä¸€äº›æ–‡ç« ï¼Œè®°å½•åœ¨é¸¿è’™å¼€å‘ã€æ¸¸æˆåˆ¶ä½œæˆ–è€…ä¸¤è€…ç»“åˆè¿‡ç¨‹ä¸­çš„å¿ƒå¾—ã€‚ä¸ç®¡æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œå¤šç•™ç‚¹è®°å½•ï¼Œè‡³å°‘ä»¥åå›å¤´çœ‹æ—¶ï¼Œä¸ä¼šè§‰å¾—é‚£æ®µæ—¶é—´åªå‰©ä¸‹ç©ºè™šã€‚</p>
<p>ç”Ÿæ´»ç»™è¿‡æˆ‘é‡å‡»ï¼Œä½†æˆ‘æ‰¾åˆ°äº†ç ´å†°çš„æ–¹æ³•ã€‚2026ï¼Œèº«ä½“ç¬¬ä¸€ï¼ŒåŠ æ²¹å¹²ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ77ï¼‰å¦‚ä½•åœ¨RESTfulæœåŠ¡ä¸­ä½¿ç”¨Hibernateï¼Ÿ]]></title>    <link>https://juejin.cn/post/7601101531919745070</link>    <guid>https://juejin.cn/post/7601101531919745070</guid>    <pubDate>2026-01-31T23:03:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601101531919745070" data-draft-id="7601069677567131694" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ77ï¼‰å¦‚ä½•åœ¨RESTfulæœåŠ¡ä¸­ä½¿ç”¨Hibernateï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-31T23:03:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ77ï¼‰å¦‚ä½•åœ¨RESTfulæœåŠ¡ä¸­ä½¿ç”¨Hibernateï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T23:03:49.000Z" title="Sat Jan 31 2026 23:03:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨RESTfulæœåŠ¡ä¸­ä½¿ç”¨Hibernateï¼Œå¯ä»¥é€šè¿‡Spring Bootæ¥æ•´åˆã€‚Spring Bootæä¾›äº†ç®€åŒ–çš„é…ç½®ï¼Œå¯ä»¥å¿«é€Ÿé›†æˆHibernateä»¥ä¾¿å¤„ç†æŒä¹…åŒ–æ“ä½œã€‚ä¸‹é¢æˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•åœ¨Spring Bootä¸­ä½¿ç”¨Hibernateæ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„RESTfulæœåŠ¡ã€‚</p>
<h3 data-id="heading-0">1. é¡¹ç›®ä¾èµ–</h3>
<p>åœ¨<code>pom.xml</code>ä¸­æ·»åŠ å¿…è¦çš„ä¾èµ–ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- Spring Boot Starter Data JPA --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- MySQL Connector --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.0.26<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- HikariCP for Connection Pooling --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.zaxxer<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>HikariCP<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>4.0.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Spring Boot Starter Web --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

    <span class="hljs-comment">&lt;!-- Lombok --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.18.20<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>provided<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h3 data-id="heading-1">2. é…ç½®æ•°æ®æºå’ŒHibernateå±æ€§</h3>
<p>åœ¨<code>application.properties</code>ä¸­é…ç½®MySQLæ•°æ®æºï¼š</p>
<pre><code class="hljs language-properties" lang="properties"># MySQL Database Configuration
spring.datasource.url=jdbc:mysql://localhost:3306/mydatabase
spring.datasource.username=root
spring.datasource.password=rootpassword
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Hibernate Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
</code></pre>
<h3 data-id="heading-2">3. åˆ›å»ºé¢†åŸŸæ¨¡å‹</h3>
<h4 data-id="heading-3"><code>Product.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "products")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Product</span> {

    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> String description;
    <span class="hljs-keyword">private</span> <span class="hljs-type">double</span> price;
}
</code></pre>
<h3 data-id="heading-4">4. åˆ›å»ºä»“å‚¨æ¥å£</h3>
<h4 data-id="heading-5"><code>ProductRepository.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ProductRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">JpaRepository</span>&lt;Product, Long&gt; {
}
</code></pre>
<h3 data-id="heading-6">5. åˆ›å»ºæœåŠ¡å±‚</h3>
<h4 data-id="heading-7"><code>ProductService.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span> org.springframework.transaction.annotation.Transactional;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ProductRepository productRepository;

    <span class="hljs-keyword">public</span> List&lt;Product&gt; <span class="hljs-title function_">getAllProducts</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> productRepository.findAll();
    }

    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProductById</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-keyword">return</span> productRepository.findById(id).orElse(<span class="hljs-literal">null</span>);
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">createProduct</span><span class="hljs-params">(Product product)</span> {
        <span class="hljs-keyword">return</span> productRepository.save(product);
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> Product <span class="hljs-title function_">updateProduct</span><span class="hljs-params">(Long id, Product productDetails)</span> {
        <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> productRepository.findById(id).orElse(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            product.setName(productDetails.getName());
            product.setDescription(productDetails.getDescription());
            product.setPrice(productDetails.getPrice());
            <span class="hljs-keyword">return</span> productRepository.save(product);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteProduct</span><span class="hljs-params">(Long id)</span> {
        productRepository.deleteById(id);
    }
}
</code></pre>
<h3 data-id="heading-8">6. åˆ›å»ºæ§åˆ¶å™¨</h3>
<h4 data-id="heading-9"><code>ProductController.java</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.http.ResponseEntity;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping("/products")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductController</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> ProductService productService;

    <span class="hljs-meta">@GetMapping</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;List&lt;Product&gt;&gt; <span class="hljs-title function_">getAllProducts</span><span class="hljs-params">()</span> {
        List&lt;Product&gt; products = productService.getAllProducts();
        <span class="hljs-keyword">return</span> ResponseEntity.ok(products);
    }

    <span class="hljs-meta">@GetMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Product&gt; <span class="hljs-title function_">getProductById</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
        <span class="hljs-type">Product</span> <span class="hljs-variable">product</span> <span class="hljs-operator">=</span> productService.getProductById(id);
        <span class="hljs-keyword">if</span> (product != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> ResponseEntity.ok(product);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> ResponseEntity.notFound().build();
        }
    }

    <span class="hljs-meta">@PostMapping</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Product&gt; <span class="hljs-title function_">createProduct</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> Product product)</span> {
        <span class="hljs-type">Product</span> <span class="hljs-variable">createdProduct</span> <span class="hljs-operator">=</span> productService.createProduct(product);
        <span class="hljs-keyword">return</span> ResponseEntity.ok(createdProduct);
    }

    <span class="hljs-meta">@PutMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Product&gt; <span class="hljs-title function_">updateProduct</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id, <span class="hljs-meta">@RequestBody</span> Product productDetails)</span> {
        <span class="hljs-type">Product</span> <span class="hljs-variable">updatedProduct</span> <span class="hljs-operator">=</span> productService.updateProduct(id, productDetails);
        <span class="hljs-keyword">if</span> (updatedProduct != <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> ResponseEntity.ok(updatedProduct);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> ResponseEntity.notFound().build();
        }
    }

    <span class="hljs-meta">@DeleteMapping("/{id}")</span>
    <span class="hljs-keyword">public</span> ResponseEntity&lt;Void&gt; <span class="hljs-title function_">deleteProduct</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
        productService.deleteProduct(id);
        <span class="hljs-keyword">return</span> ResponseEntity.noContent().build();
    }
}
</code></pre>
<h3 data-id="heading-10">7. è¿è¡Œåº”ç”¨</h3>
<ol>
<li><strong>å¯åŠ¨MySQL</strong>ï¼šç¡®ä¿ä½ çš„MySQLæ•°æ®åº“è¿è¡Œåœ¨<code>localhost:3306</code>ã€‚</li>
<li><strong>åˆ›å»ºæ•°æ®åº“</strong>ï¼šåˆ›å»ºä¸€ä¸ªåä¸º<code>mydatabase</code>çš„æ•°æ®åº“ã€‚</li>
<li><strong>å¯åŠ¨Spring Bootåº”ç”¨</strong>ï¼šè¿è¡ŒSpring Bootåº”ç”¨ç¨‹åºã€‚</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">mvn spring-boot:run
</code></pre>
<h3 data-id="heading-11">8. è®¿é—®API</h3>
<p>é€šè¿‡ä»¥ä¸‹APIè®¿é—®<code>Product</code>æ•°æ®ï¼š</p>
<ul>
<li><code>GET /products</code>ï¼šè·å–æ‰€æœ‰äº§å“ã€‚</li>
<li><code>GET /products/{id}</code>ï¼šæŒ‰IDè·å–äº§å“ã€‚</li>
<li><code>POST /products</code>ï¼šåˆ›å»ºæ–°äº§å“ã€‚</li>
<li><code>PUT /products/{id}</code>ï¼šæ›´æ–°äº§å“ã€‚</li>
<li><code>DELETE /products/{id}</code>ï¼šåˆ é™¤äº§å“ã€‚</li>
</ul>
<h3 data-id="heading-12">ç¤ºä¾‹è¯·æ±‚</h3>
<h4 data-id="heading-13">åˆ›å»ºäº§å“</h4>
<pre><code class="hljs language-bash" lang="bash">curl -X POST http://localhost:8080/products -H <span class="hljs-string">"Content-Type: application/json"</span> -d <span class="hljs-string">'{
  "name": "Laptop",
  "description": "A high-end gaming laptop",
  "price": 1500.00
}'</span>
</code></pre>
<h4 data-id="heading-14">è·å–æ‰€æœ‰äº§å“</h4>
<pre><code class="hljs language-bash" lang="bash">curl -X GET http://localhost:8080/products
</code></pre>
<h4 data-id="heading-15">è·å–å•ä¸ªäº§å“</h4>
<pre><code class="hljs language-bash" lang="bash">curl -X GET http://localhost:8080/products/1
</code></pre>
<h4 data-id="heading-16">æ›´æ–°äº§å“</h4>
<pre><code class="hljs language-bash" lang="bash">curl -X PUT http://localhost:8080/products/1 -H <span class="hljs-string">"Content-Type: application/json"</span> -d <span class="hljs-string">'{
  "name": "Gaming Laptop",
  "description": "An updated high-end gaming laptop",
  "price": 1600.00
}'</span>
</code></pre>
<h4 data-id="heading-17">åˆ é™¤äº§å“</h4>
<pre><code class="hljs language-bash" lang="bash">curl -X DELETE http://localhost:8080/products/1
</code></pre>
<h3 data-id="heading-18">æ€»ç»“</h3>
<p>é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•åœ¨Spring Bootä¸­ä½¿ç”¨Hibernateåˆ›å»ºä¸€ä¸ªç®€å•çš„RESTfulæœåŠ¡ï¼ŒåŒ…æ‹¬å®šä¹‰é¢†åŸŸæ¨¡å‹ã€åˆ›å»ºä»“å‚¨æ¥å£ã€å®ç°æœåŠ¡å±‚å’Œæ§åˆ¶å™¨ã€‚åœ¨RESTfulæœåŠ¡ä¸­ï¼ŒHibernateå¯ä»¥å¾ˆå¥½åœ°å¤„ç†æŒä¹…åŒ–ï¼Œä»è€Œå®ç°æ¸…æ™°çš„ä¸šåŠ¡é€»è¾‘å’ŒæŒä¹…åŒ–é€»è¾‘åˆ†ç¦»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ260126-260130ï¼‰]]></title>    <link>https://juejin.cn/post/7601159804489744403</link>    <guid>https://juejin.cn/post/7601159804489744403</guid>    <pubDate>2026-01-31T14:12:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601159804489744403" data-draft-id="7601034810313392182" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ260126-260130ï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-31T14:12:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¶å­çš„æŠ€æœ¯ç¢ç¢å¿µ"/> <meta itemprop="url" content="https://juejin.cn/user/2831954919569245"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ260126-260130ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2831954919569245/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¶å­çš„æŠ€æœ¯ç¢ç¢å¿µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T14:12:42.000Z" title="Sat Jan 31 2026 14:12:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Can LLMs Clean Up Your Mess? A Survey of Application-Ready Data Preparation with LLMs</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.17058" target="_blank" title="https://arxiv.org/abs/2601.17058" ref="nofollow noopener noreferrer">å¤§è¯­è¨€æ¨¡å‹èƒ½å¦å¤„ç†æ··ä¹±æ•°æ®ï¼Ÿé¢å‘åº”ç”¨çš„ LLM æ•°æ®å‡†å¤‡æŠ€æœ¯ç»¼è¿°</a></p>
<p>æ•°æ®å‡†å¤‡æ—¨åœ¨æ¸…ç†åŸå§‹æ•°æ®é›†ã€å‘ç°è·¨æ•°æ®é›†å…³è”å¹¶ä»ä¸­æå–æœ‰ä»·å€¼çš„æ´è§ï¼Œè¿™å¯¹äºä¼—å¤šä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„åº”ç”¨è‡³å…³é‡è¦ã€‚åœ¨ä»¥ä¸‹å› ç´ çš„å…±åŒé©±åŠ¨ä¸‹: (i) å¯¹å¯ç›´æ¥ç”¨äºåº”ç”¨çš„æ•°æ® (ä¾‹å¦‚ç”¨äºåˆ†æã€å¯è§†åŒ–ã€å†³ç­–) çš„éœ€æ±‚ä¸æ–­å¢é•¿, (ii) å¤§è¯­è¨€æ¨¡å‹æŠ€æœ¯æ—¥ç›Šå¼ºå¤§, ä»¥åŠ (iii) ä¾¿äºçµæ´»æ„å»º AI æ™ºèƒ½ä½“çš„åŸºç¡€è®¾æ–½ (ä¾‹å¦‚ä½¿ç”¨ Databricks Unity Catalog) çš„å‡ºç°, åŸºäºå¤§è¯­è¨€æ¨¡å‹å¢å¼ºçš„æ–¹æ³•æ­£è¿…é€Ÿæˆä¸ºæ•°æ®å‡†å¤‡é¢†åŸŸä¸€ä¸ªå˜é©æ€§ä¹ƒè‡³ä¸»å¯¼æ€§çš„èŒƒå¼ã€‚æœ¬æ–‡é€šè¿‡åˆ†ææ•°ç™¾ç¯‡è¿‘æœŸæ–‡çŒ®, å¯¹è¿™ä¸€å¿«é€Ÿå‘å±•é¢†åŸŸè¿›è¡Œäº†ç³»ç»Ÿæ€§ç»¼è¿°, é‡ç‚¹å…³æ³¨å¦‚ä½•åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹æŠ€æœ¯ä¸ºå„ç±»ä¸‹æ¸¸ä»»åŠ¡å‡†å¤‡æ•°æ®ã€‚é¦–å…ˆ, æˆ‘ä»¬é˜è¿°äº†è¯¥é¢†åŸŸçš„åŸºæœ¬èŒƒå¼è½¬å˜, å³ä»åŸºäºè§„åˆ™ã€æ¨¡å‹ç‰¹å®šçš„æµæ°´çº¿è½¬å‘æç¤ºé©±åŠ¨ã€ä¸Šä¸‹æ–‡æ„ŸçŸ¥ä¸”ç”±æ™ºèƒ½ä½“é©±åŠ¨çš„å·¥ä½œæµã€‚æ¥ç€, æˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªä»¥ä»»åŠ¡ä¸ºä¸­å¿ƒçš„åˆ†ç±»ä½“ç³», å°†ç›¸å…³ç ”ç©¶å½’çº³ä¸ºä¸‰å¤§æ ¸å¿ƒä»»åŠ¡: æ•°æ®æ¸…æ´— (ä¾‹å¦‚æ ‡å‡†åŒ–ã€é”™è¯¯ä¿®å¤ã€æ•°æ®å¡«è¡¥)ã€æ•°æ®é›†æˆ (ä¾‹å¦‚å®ä½“åŒ¹é…ã€æ¨¡å¼åŒ¹é…) ä»¥åŠæ•°æ®ä¸°å¯Œ (ä¾‹å¦‚æ•°æ®æ ‡æ³¨ã€æ•°æ®ç”»åƒ)ã€‚é’ˆå¯¹æ¯é¡¹ä»»åŠ¡, æˆ‘ä»¬ç»¼è¿°äº†ä»£è¡¨æ€§æŠ€æœ¯, å¹¶ç€é‡åˆ†æäº†å®ƒä»¬å„è‡ªçš„ä¼˜åŠ¿ (ä¾‹å¦‚æ³›åŒ–èƒ½åŠ›æå‡ã€è¯­ä¹‰ç†è§£å¢å¼º) ä¸å±€é™æ€§ (ä¾‹å¦‚æ‰©å±•å¤§è¯­è¨€æ¨¡å‹çš„é«˜æ˜‚æˆæœ¬ã€å³ä½¿åœ¨å…ˆè¿›æ™ºèƒ½ä½“ä¸­ä»æŒç»­å­˜åœ¨çš„å¹»è§‰é—®é¢˜ã€å…ˆè¿›æ–¹æ³•ä¸è–„å¼±è¯„ä¼°ä¹‹é—´çš„è„±èŠ‚)ã€‚æ­¤å¤–, æˆ‘ä»¬è¿˜åˆ†æäº†å¸¸ç”¨çš„æ•°æ®é›†ä¸è¯„ä¼°æŒ‡æ ‡ (å®è¯ç ”ç©¶éƒ¨åˆ†)ã€‚æœ€å, æˆ‘ä»¬æ¢è®¨äº†å¼€æ”¾çš„ç ”ç©¶æŒ‘æˆ˜, å¹¶å‹¾å‹’äº†ä¸€ä¸ªå‰ç»æ€§è·¯çº¿å›¾, å¼ºè°ƒéœ€å…³æ³¨å¯æ‰©å±•çš„å¤§è¯­è¨€æ¨¡å‹ä¸æ•°æ®ç³»ç»Ÿã€å¯é æ™ºèƒ½ä½“å·¥ä½œæµçš„ principled è®¾è®¡ä»¥åŠç¨³å¥çš„è¯„ä¼°åè®®ã€‚</p>
<h2 data-id="heading-1">LongCat-Flash-Thinking-2601 Technical Report</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.16725" target="_blank" title="https://arxiv.org/abs/2601.16725" ref="nofollow noopener noreferrer">LongCat-Flash-Thinking-2601 æŠ€æœ¯æŠ¥å‘Š</a></p>
<p>æˆ‘ä»¬ä»‹ç»äº† LongCat-Flash-Thinking-2601ï¼Œè¿™æ˜¯ä¸€ä¸ªæ‹¥æœ‰ 5600 äº¿å‚æ•°çš„å¼€æºæ··åˆä¸“å®¶ (Mixture-of-Experts, MoE) æ¨ç†æ¨¡å‹ï¼Œå…·å¤‡å“è¶Šçš„æ™ºèƒ½ä½“æ¨ç†èƒ½åŠ›ã€‚åœ¨å¹¿æ³›çš„æ™ºèƒ½ä½“åŸºå‡†æµ‹è¯•ï¼ˆåŒ…æ‹¬æ™ºèƒ½ä½“æœç´¢ã€æ™ºèƒ½ä½“å·¥å…·ä½¿ç”¨å’Œå·¥å…·é›†æˆæ¨ç†ï¼‰ä¸­ï¼ŒLongCat-Flash-Thinking-2601 åœ¨å¼€æºæ¨¡å‹ä¸­å®ç°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ã€‚é™¤äº†åŸºå‡†æµ‹è¯•è¡¨ç°ï¼Œè¯¥æ¨¡å‹è¿˜å±•ç°å‡ºå¼ºå¤§çš„æ³›åŒ–èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†å¤æ‚çš„å·¥å…·äº¤äº’ï¼Œå¹¶åœ¨å˜ˆæ‚çš„ç°å®ç¯å¢ƒä¸­ä¿æŒé²æ£’çš„è¡Œä¸ºã€‚å…¶å…ˆè¿›èƒ½åŠ›æºäºä¸€ä¸ªç»Ÿä¸€çš„è®­ç»ƒæ¡†æ¶ï¼Œè¯¥æ¡†æ¶ç»“åˆäº†é¢†åŸŸå¹¶è¡Œä¸“å®¶è®­ç»ƒä¸åç»­èåˆï¼Œå¹¶å®ç°äº†ä»é¢„è®­ç»ƒåˆ°åè®­ç»ƒé˜¶æ®µçš„æ•°æ®æ„å»ºã€ç¯å¢ƒã€ç®—æ³•å’ŒåŸºç¡€è®¾æ–½çš„ç«¯åˆ°ç«¯ååŒè®¾è®¡ã€‚å…·ä½“è€Œè¨€ï¼Œè¯¥æ¨¡å‹åœ¨å¤æ‚å·¥å…·ä½¿ç”¨æ–¹é¢çš„å¼ºå¤§æ³›åŒ–èƒ½åŠ›ï¼Œå¾—ç›Šäºæˆ‘ä»¬å¯¹ç¯å¢ƒç¼©æ”¾å’ŒåŸºäºåŸåˆ™çš„ä»»åŠ¡æ„å»ºçš„æ·±å…¥æ¢ç´¢ã€‚ä¸ºäº†ä¼˜åŒ–é•¿å°¾ã€åæ–œçš„ç”Ÿæˆä»¥åŠå¤šè½®æ™ºèƒ½ä½“äº¤äº’ï¼Œå¹¶ä¸ºäº†åœ¨è·¨è¶Š 20 å¤šä¸ªé¢†åŸŸçš„è¶…è¿‡ 10,000 ä¸ªç¯å¢ƒä¸­å®ç°ç¨³å®šè®­ç»ƒï¼Œæˆ‘ä»¬ç³»ç»Ÿåœ°æ‰©å±•äº†å¼‚æ­¥å¼ºåŒ–å­¦ä¹ æ¡†æ¶ DORAï¼Œä»¥æ”¯æŒç¨³å®šé«˜æ•ˆçš„å¤§è§„æ¨¡å¤šç¯å¢ƒè®­ç»ƒã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è®¤è¯†åˆ°ç°å®ä»»åŠ¡æœ¬è´¨ä¸Šæ˜¯å˜ˆæ‚çš„ï¼Œå› æ­¤å¯¹ç°å®ä¸–ç•Œçš„å™ªå£°æ¨¡å¼è¿›è¡Œäº†ç³»ç»Ÿåˆ†æå’Œåˆ†è§£ï¼Œå¹¶è®¾è®¡äº†é’ˆå¯¹æ€§çš„è®­ç»ƒæµç¨‹ï¼Œæ˜ç¡®åœ°å°†è¿™äº›ä¸å®Œç¾å› ç´ çº³å…¥è®­ç»ƒè¿‡ç¨‹ï¼Œä»è€Œæå‡äº†æ¨¡å‹åœ¨ç°å®åº”ç”¨ä¸­çš„é²æ£’æ€§ã€‚ä¸ºäº†è¿›ä¸€æ­¥æå‡å¤æ‚æ¨ç†ä»»åŠ¡çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å¼•å…¥äº†é‡å‹æ€è€ƒ (Heavy Thinking) æ¨¡å¼ï¼Œè¯¥æ¨¡å¼é€šè¿‡å¯†é›†çš„å¹¶è¡Œæ€è€ƒåŒæ—¶æ‰©å±•æ¨ç†çš„æ·±åº¦å’Œå®½åº¦ï¼Œä»è€Œå®ç°æœ‰æ•ˆçš„æµ‹è¯•æ—¶ç¼©æ”¾ã€‚</p>
<h2 data-id="heading-2">Idea2Story: An Automated Pipeline for Transforming Research Concepts into Complete Scientific Narratives</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.20833" target="_blank" title="https://arxiv.org/abs/2601.20833" ref="nofollow noopener noreferrer">Idea2Storyï¼šä¸€ä¸ªå°†ç ”ç©¶æ¦‚å¿µè½¬åŒ–ä¸ºå®Œæ•´ç§‘å­¦å™äº‹çš„è‡ªåŠ¨åŒ–æµæ°´çº¿</a></p>
<p>åŸºäºå¤§è¯­è¨€æ¨¡å‹ (LLM) çš„ AI æ™ºèƒ½ä½“åœ¨è‡ªä¸»ç§‘å­¦å‘ç°é¢†åŸŸè¿‘æœŸå–å¾—äº†æ˜¾è‘—è¿›å±•ï¼Œå±•ç°äº†è‡ªåŠ¨åŒ–ç«¯åˆ°ç«¯ç ”ç©¶å·¥ä½œæµç¨‹çš„èƒ½åŠ›ã€‚ç„¶è€Œï¼Œç°æœ‰ç³»ç»Ÿä¸»è¦é‡‡ç”¨è¿è¡Œæ—¶ä¸­å¿ƒå‹çš„æ‰§è¡ŒèŒƒå¼ï¼Œéœ€è¦åå¤åœ¨çº¿è¯»å–ã€æ€»ç»“å’Œæ¨ç†æµ·é‡ç§‘å­¦æ–‡çŒ®ã€‚è¿™ç§å³æ—¶è®¡ç®—ç­–ç•¥ä¸ä»…è®¡ç®—æˆæœ¬é«˜æ˜‚ã€å—é™äºä¸Šä¸‹æ–‡çª—å£ï¼Œè¿˜å¸¸å¸¸å¯¼è‡´æ¨ç†è¿‡ç¨‹è„†å¼±å¹¶äº§ç”Ÿå¹»è§‰ã€‚æˆ‘ä»¬æå‡ºäº† Idea2Storyï¼Œä¸€ä¸ªé¢„è®¡ç®—é©±åŠ¨å‹çš„è‡ªä¸»ç§‘å­¦å‘ç°æ¡†æ¶ï¼Œå®ƒå°†æ–‡çŒ®ç†è§£ä»åœ¨çº¿æ¨ç†è¿ç§»è‡³ç¦»çº¿çŸ¥è¯†æ„å»ºã€‚Idea2Story æŒç»­æ”¶é›†åŒè¡Œè¯„å®¡è®ºæ–‡åŠå…¶è¯„å®¡åé¦ˆï¼Œæå–æ ¸å¿ƒæ–¹æ³•è®ºå•å…ƒï¼Œç»„åˆæˆå¯é‡ç”¨çš„ç ”ç©¶æ¨¡å¼ï¼Œå¹¶å°†å…¶ç»„ç»‡æˆä¸€ä¸ªç»“æ„åŒ–çš„æ–¹æ³•è®ºçŸ¥è¯†å›¾è°±ã€‚åœ¨è¿è¡Œæ—¶ï¼Œç³»ç»Ÿå°†ç”¨æˆ·æ¬ æŒ‡å®šçš„ç ”ç©¶æ„å›¾ä¸æ—¢å®šçš„ç ”ç©¶èŒƒå¼è¿›è¡Œå¯¹é½ï¼Œä»è€Œå®ç°é«˜è´¨é‡ç ”ç©¶æ¨¡å¼çš„é«˜æ•ˆæ£€ç´¢ä¸å¤ç”¨ï¼Œè€Œéä¾èµ–äºå¼€æ”¾å¼ç”Ÿæˆå’Œè¯•é”™ã€‚é€šè¿‡å°†ç ”ç©¶è§„åˆ’ä¸æ‰§è¡Œè¿‡ç¨‹åŸºäºé¢„æ„å»ºçš„çŸ¥è¯†å›¾è°±ï¼ŒIdea2Story ç¼“è§£äº†å¤§è¯­è¨€æ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£ç“¶é¢ˆï¼Œå¹¶å¤§å¹…å‡å°‘äº†å¯¹æ–‡çŒ®çš„é‡å¤è¿è¡Œæ—¶æ¨ç†ã€‚æˆ‘ä»¬è¿›è¡Œäº†å®šæ€§åˆ†æå’Œåˆæ­¥å®è¯ç ”ç©¶ï¼Œç»“æœè¡¨æ˜ Idea2Story èƒ½å¤Ÿç”Ÿæˆè¿è´¯ã€æ–¹æ³•æ‰å®ä¸”æ–°é¢–çš„ç ”ç©¶æ¨¡å¼ï¼Œå¹¶èƒ½åœ¨ç«¯åˆ°ç«¯åœºæ™¯ä¸‹äº§å‡ºå¤šä¸ªé«˜è´¨é‡çš„ç ”ç©¶ç¤ºä¾‹ã€‚è¿™äº›å‘ç°è¡¨æ˜ï¼Œç¦»çº¿çŸ¥è¯†æ„å»ºä¸ºå¯é ã€å¯æ‰©å±•çš„è‡ªä¸»ç§‘å­¦å‘ç°æä¾›äº†åˆ‡å®å¯è¡Œçš„åŸºç¡€ã€‚</p>
<h2 data-id="heading-3">daVinci-Dev: Agent-native Mid-training for Software Engineering</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.18418" target="_blank" title="https://arxiv.org/abs/2601.18418" ref="nofollow noopener noreferrer">daVinci-Devï¼šé¢å‘è½¯ä»¶å·¥ç¨‹çš„æ™ºèƒ½ä½“åŸç”Ÿä¸­æœŸè®­ç»ƒ</a></p>
<p>è¿‘æ¥ï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰èƒ½åŠ›çš„å‰æ²¿å·²ä»å•è½®ä»£ç ç”Ÿæˆè½¬å‘åŸºäºæ™ºèƒ½ä½“çš„è½¯ä»¶å·¥ç¨‹â€”â€”è¿™æ˜¯ä¸€ç§æ¨¡å‹èƒ½å¤Ÿè‡ªä¸»å¯¼èˆªã€ç¼–è¾‘å’Œæµ‹è¯•å¤æ‚ä»£ç åº“çš„æ–°èŒƒå¼ã€‚å°½ç®¡åè®­ç»ƒæ–¹æ³•å·²æˆä¸ºä»£ç æ™ºèƒ½ä½“äº‹å®ä¸Šçš„ä¸»æµæ–¹æ³•ï¼Œä½†<strong>æ™ºèƒ½ä½“ä¸­æœŸè®­ç»ƒ</strong>â€”â€”å³åœ¨æ¨¡æ‹ŸçœŸå®æ™ºèƒ½ä½“å·¥ä½œæµç¨‹çš„å¤§è§„æ¨¡æ•°æ®ä¸Šè¿›è¡Œçš„ Mid-trainingï¼ˆMTï¼‰â€”â€”è™½ç„¶ä¸ºåŸ¹å…»åŸºç¡€æ™ºèƒ½ä½“è¡Œä¸ºæä¾›äº†ä¸€æ¡æ¯”å•çº¯ä¾èµ–æ˜‚è´µå¼ºåŒ–å­¦ä¹ æ›´å…·å¯æ‰©å±•æ€§çš„è·¯å¾„ï¼Œä½†ç”±äºå…¶å·¨å¤§çš„èµ„æºéœ€æ±‚ï¼Œè‡³ä»Šä»æœªå¾—åˆ°å……åˆ†æ¢ç´¢ã€‚å®ç°æœ‰æ•ˆæ™ºèƒ½ä½“ä¸­æœŸè®­ç»ƒçš„ä¸€ä¸ªæ ¸å¿ƒæŒ‘æˆ˜åœ¨äºé™æ€è®­ç»ƒæ•°æ®ä¸çœŸå®å¼€å‘ä¸­åŠ¨æ€ã€å¯Œå«åé¦ˆçš„ç¯å¢ƒä¹‹é—´å­˜åœ¨åˆ†å¸ƒå·®å¼‚ã€‚ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯¹æ™ºèƒ½ä½“ä¸­æœŸè®­ç»ƒè¿›è¡Œäº†ç³»ç»Ÿæ€§ç ”ç©¶ï¼Œå»ºç«‹äº†é€‚ç”¨äºå¤§è§„æ¨¡æœ‰æ•ˆæ™ºèƒ½ä½“å¼€å‘çš„æ•°æ®åˆæˆåŸåˆ™ä¸è®­ç»ƒæ–¹æ³•ã€‚æˆ‘ä»¬æ–¹æ³•çš„æ ¸å¿ƒåœ¨äº<strong>æ™ºèƒ½ä½“åŸç”Ÿæ•°æ®</strong>â€”â€”è¿™æ˜¯ä¸€ç§åŒ…å«ä¸¤ç§äº’è¡¥ç±»å‹è½¨è¿¹çš„ç›‘ç£æ•°æ®ï¼š<strong>ä¸Šä¸‹æ–‡åŸç”Ÿè½¨è¿¹</strong>ï¼Œå…¶ä¿ç•™äº†æ™ºèƒ½ä½“æ‰€ç»å†çš„å®Œæ•´ä¿¡æ¯æµï¼Œæä¾›äº†å¹¿æ³›çš„è¦†ç›–é¢å’Œå¤šæ ·æ€§ï¼›ä»¥åŠ<strong>ç¯å¢ƒåŸç”Ÿè½¨è¿¹</strong>ï¼Œè¿™äº›è½¨è¿¹ä»å¯æ‰§è¡Œä»£ç åº“ä¸­æ”¶é›†ï¼Œå…¶è§‚æµ‹å€¼æ¥æºäºå®é™…çš„å·¥å…·è°ƒç”¨å’Œæµ‹è¯•æ‰§è¡Œï¼Œä»è€Œæä¾›äº†æ·±åº¦å’Œäº¤äº’çœŸå®æ€§ã€‚æˆ‘ä»¬åœ¨ <code>SWE-Bench Verified</code> åŸºå‡†ä¸ŠéªŒè¯äº†æ¨¡å‹çš„æ™ºèƒ½ä½“èƒ½åŠ›ã€‚åœ¨ä¸¤ç§åè®­ç»ƒè®¾ç½®ä¸‹ï¼Œä½¿ç”¨å¯¹é½çš„åŸºç¡€æ¨¡å‹å’Œæ™ºèƒ½ä½“æ¡†æ¶ï¼Œæˆ‘ä»¬è¯æ˜äº†æˆ‘ä»¬çš„æ–¹æ³•ä¼˜äºå…ˆå‰å¼€æ”¾çš„è½¯ä»¶å·¥ç¨‹ä¸­æœŸè®­ç»ƒæ–¹æ¡ˆ <code>Kimi-Dev</code>ï¼ŒåŒæ—¶æ‰€ä½¿ç”¨çš„ä¸­æœŸè®­ç»ƒ Token æ•°é‡ä¸åˆ°åè€…çš„ä¸€åŠï¼ˆ73.1Bï¼‰ã€‚é™¤äº†ç›¸å¯¹ä¼˜åŠ¿ï¼Œæˆ‘ä»¬æ€§èƒ½æœ€ä½³çš„ 32B å’Œ 72B æ¨¡å‹åˆ†åˆ«å®ç°äº† <strong>56.1%</strong> å’Œ <strong>58.5%</strong> çš„é—®é¢˜è§£å†³ç‡ï¼Œè¿™ä¸€ç»“æœæ˜¯...</p>
<h2 data-id="heading-4">AgentDoG: A Diagnostic Guardrail Framework for AI Agent Safety and Security</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.18491" target="_blank" title="https://arxiv.org/abs/2601.18491" ref="nofollow noopener noreferrer">AgentDoGï¼šä¸€ä¸ªç”¨äºAIæ™ºèƒ½ä½“å®‰å…¨ä¸é˜²æŠ¤çš„è¯Šæ–­æŠ¤æ æ¡†æ¶</a></p>
<p>AIæ™ºèƒ½ä½“çš„å…´èµ·ï¼Œå› å…¶è‡ªä¸»ä½¿ç”¨å·¥å…·å’Œä¸ç¯å¢ƒäº¤äº’çš„ç‰¹æ€§ï¼Œå¸¦æ¥äº†å¤æ‚çš„å®‰å…¨ä¸é˜²æŠ¤æŒ‘æˆ˜ã€‚å½“å‰çš„æŠ¤æ æ¨¡å‹ç¼ºä¹å¯¹æ™ºèƒ½ä½“é£é™©çš„è®¤çŸ¥ï¼Œä¸”åœ¨é£é™©è¯Šæ–­æ–¹é¢é€æ˜åº¦ä¸è¶³ã€‚ä¸ºäº†æ„å»ºä¸€ä¸ªèƒ½å¤Ÿè¦†ç›–å¤æ‚ä¸”å¤šæ ·é£é™©è¡Œä¸ºçš„æ™ºèƒ½ä½“æŠ¤æ ï¼Œæˆ‘ä»¬é¦–å…ˆæå‡ºäº†ä¸€ç§ç»Ÿä¸€çš„ä¸‰ç»´åˆ†ç±»æ³•ï¼Œè¯¥åˆ†ç±»æ³•ä»é£é™©æ¥æºï¼ˆä½•å¤„ï¼‰ã€å¤±æ•ˆæ¨¡å¼ï¼ˆå¦‚ä½•ï¼‰å’Œåæœï¼ˆä»€ä¹ˆï¼‰ä¸‰ä¸ªæ­£äº¤ç»´åº¦å¯¹æ™ºèƒ½ä½“é£é™©è¿›è¡Œç³»ç»Ÿåˆ†ç±»ã€‚åœ¨è¿™ä¸€ç»“æ„åŒ–ã€å±‚æ¬¡åŒ–çš„åˆ†ç±»æ³•æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„ç»†ç²’åº¦æ™ºèƒ½ä½“å®‰å…¨åŸºå‡†ï¼ˆATBenchï¼‰ä»¥åŠä¸€ä¸ªç”¨äºæ™ºèƒ½ä½“å®‰å…¨ä¸é˜²æŠ¤çš„è¯Šæ–­æŠ¤æ æ¡†æ¶ï¼ˆAgentDoGï¼‰ã€‚AgentDoGèƒ½å¤Ÿå¯¹æ™ºèƒ½ä½“çš„è¡Œä¸ºè½¨è¿¹è¿›è¡Œç»†ç²’åº¦çš„ã€ç»“åˆä¸Šä¸‹æ–‡çš„ç›‘æ§ã€‚æ›´ä¸ºå…³é”®çš„æ˜¯ï¼ŒAgentDoGä¸ä»…èƒ½è¯Šæ–­ä¸å®‰å…¨è¡Œä¸ºçš„æ ¹æœ¬åŸå› ï¼Œè¿˜èƒ½è¯†åˆ«é‚£äº›çœ‹ä¼¼å®‰å…¨å®åˆ™ä¸åˆç†çš„è¡ŒåŠ¨ï¼Œæä¾›è¶…è¶Šç®€å•äºŒå…ƒåˆ¤å®šçš„æº¯æºä¿¡æ¯å’Œé€æ˜åº¦ï¼Œä»è€Œæœ‰æ•ˆä¿ƒè¿›æ™ºèƒ½ä½“å¯¹é½ã€‚AgentDoGæä¾›äº†åŸºäºQwenå’ŒLlamaæ¨¡å‹ç³»åˆ—çš„ä¸‰ç§å‚æ•°è§„æ¨¡å˜ä½“ï¼ˆ4Bã€7Bå’Œ8Bï¼‰ã€‚å¤§é‡å®éªŒç»“æœè¡¨æ˜ï¼Œåœ¨å¤šæ ·ä¸”å¤æ‚çš„äº¤äº’åœºæ™¯ä¸­ï¼ŒAgentDoGåœ¨æ™ºèƒ½ä½“å®‰å…¨å®¡æ ¸æ–¹é¢è¾¾åˆ°äº†æœ€å…ˆè¿›çš„æ€§èƒ½ã€‚æ‰€æœ‰æ¨¡å‹å’Œæ•°æ®é›†å‡å·²å¼€æºå‘å¸ƒã€‚</p>
<h2 data-id="heading-5">Harder Is Better: Boosting Mathematical Reasoning via Difficulty-Aware GRPO and Multi-Aspect Question Reformulation</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.20614" target="_blank" title="https://arxiv.org/abs/2601.20614" ref="nofollow noopener noreferrer">Harder Is Better: é€šè¿‡éš¾åº¦æ„ŸçŸ¥ GRPO ä¸å¤šè§’åº¦é—®é¢˜æ”¹å†™æå‡æ•°å­¦æ¨ç†èƒ½åŠ›</a></p>
<p>å…·å¤‡å¯éªŒè¯å¥–åŠ±çš„å¼ºåŒ–å­¦ä¹  (Reinforcement Learning with Verifiable Rewards, RLVR) ä¸ºæå‡å¤§å‹è¯­è¨€æ¨¡å‹çš„æ•°å­¦æ¨ç†èƒ½åŠ›æä¾›äº†ä¸€ç§ç¨³å¥çš„æœºåˆ¶ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°ï¼Œå°½ç®¡æ›´å…·æŒ‘æˆ˜æ€§çš„é—®é¢˜å¯¹äºå®Œå–„æ¨¡å‹çš„èƒ½åŠ›çŸ­æ¿è‡³å…³é‡è¦ï¼Œä½†ç°æœ‰æ–¹æ³•åœ¨ç®—æ³•å’Œæ•°æ®å±‚é¢å‡æœªç»™äºˆè¿™ç±»é—®é¢˜è¶³å¤Ÿçš„é‡è§†ã€‚åœ¨ç®—æ³•å±‚é¢ï¼Œå¹¿æ³›ä½¿ç”¨çš„ç»„ç›¸å¯¹ç­–ç•¥ä¼˜åŒ– (Group Relative Policy Optimization, GRPO) å­˜åœ¨ä¸€ç§éšå«çš„ä¸å¹³è¡¡æ€§ï¼šå¯¹äºæ›´éš¾çš„é—®é¢˜ï¼Œå…¶ç­–ç•¥æ›´æ–°é‡å¾€å¾€è¾ƒä½ã€‚åœ¨æ•°æ®å±‚é¢ï¼Œç°æœ‰çš„å¢å¼ºæ–¹æ³•ä¸»è¦é€šè¿‡æ”¹å†™é—®é¢˜æ¥å¢åŠ å¤šæ ·æ€§ï¼Œå¹¶æœªç³»ç»Ÿæ€§åœ°æå‡é—®é¢˜çš„å†…åœ¨éš¾åº¦ã€‚ä¸ºè§£å†³è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªåŒç®¡é½ä¸‹çš„ MathForge æ¡†æ¶ï¼Œæ—¨åœ¨ä»ç®—æ³•å’Œæ•°æ®ä¸¤ä¸ªç»´åº¦èšç„¦äºæ›´éš¾çš„é—®é¢˜ï¼Œä»¥æå‡æ•°å­¦æ¨ç†èƒ½åŠ›ã€‚è¯¥æ¡†æ¶åŒ…å«ä¸€ä¸ªéš¾åº¦æ„ŸçŸ¥ç»„ç­–ç•¥ä¼˜åŒ– (Difficulty-Aware Group Policy Optimization, DGPO) ç®—æ³•å’Œä¸€ä¸ªå¤šè§’åº¦é—®é¢˜æ”¹å†™ (Multi-Aspect Question Reformulation, MQR) ç­–ç•¥ã€‚å…·ä½“è€Œè¨€ï¼ŒDGPO é¦–å…ˆé€šè¿‡éš¾åº¦å¹³è¡¡çš„ç»„ä¼˜åŠ¿ä¼°è®¡æ¥ä¿®æ­£ GRPO ä¸­çš„éšå«ä¸å¹³è¡¡ï¼Œå¹¶è¿›ä¸€æ­¥é€šè¿‡éš¾åº¦æ„ŸçŸ¥çš„é—®é¢˜çº§åŠ æƒï¼Œç»™äºˆæ›´éš¾çš„é—®é¢˜æ›´é«˜çš„å­¦ä¹ ä¼˜å…ˆçº§ã€‚åŒæ—¶ï¼ŒMQR ä»å¤šä¸ªè§’åº¦å¯¹é—®é¢˜è¿›è¡Œæ”¹å†™ï¼Œåœ¨ä¿æŒåŸå§‹æ ‡å‡†ç­”æ¡ˆä¸å˜çš„å‰æä¸‹ï¼Œç³»ç»Ÿåœ°å¢åŠ é—®é¢˜çš„éš¾åº¦ã€‚æ€»ä½“è€Œè¨€ï¼ŒMathForge å½¢æˆäº†ä¸€ä¸ªååŒå¢æ•ˆçš„è‰¯æ€§å¾ªç¯ï¼šMQR æ‹“å±•äº†æ•°æ®çš„è¾¹ç•Œï¼Œè€Œ DGPO åˆ™èƒ½æœ‰æ•ˆåœ°ä»è¿™äº›å¢å¼ºæ•°æ®ä¸­å­¦ä¹ ã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼ŒMathForge åœ¨å¤šç§æ•°å­¦æ¨ç†ä»»åŠ¡ä¸Šå‡æ˜¾è‘—ä¼˜äºç°æœ‰æ–¹æ³•ã€‚ä»£ç åŠå¢å¼ºæ•°æ®å‡å·²å…¬å¼€åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FAMAP-ML%2FMathForge%25E3%2580%2582" target="_blank" title="https://github.com/AMAP-ML/MathForge%E3%80%82" ref="nofollow noopener noreferrer">github.com/AMAP-ML/Matâ€¦</a></p>
<h2 data-id="heading-6">Everything in Its Place: Benchmarking Spatial Intelligence of Text-to-Image Models</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.20354" target="_blank" title="https://arxiv.org/abs/2601.20354" ref="nofollow noopener noreferrer">ä¸‡ç‰©å½’ä½ï¼šè¯„ä¼°æ–‡æœ¬åˆ°å›¾åƒæ¨¡å‹çš„ç©ºé—´æ™ºèƒ½</a></p>
<p>æ–‡æœ¬åˆ°å›¾åƒ (T2I) æ¨¡å‹åœ¨ç”Ÿæˆé«˜ä¿çœŸåº¦å›¾åƒæ–¹é¢å·²å–å¾—æ˜¾è‘—æˆåŠŸï¼Œä½†åœ¨å¤„ç†å¤æ‚ç©ºé—´å…³ç³»ï¼ˆå¦‚ç©ºé—´æ„ŸçŸ¥ã€æ¨ç†æˆ–äº¤äº’ï¼‰æ—¶å¾€å¾€è¡¨ç°ä¸ä½³ã€‚ç”±äºç°æœ‰åŸºå‡†æµ‹è¯•çš„æç¤ºè®¾è®¡é€šå¸¸è¾ƒä¸ºç®€çŸ­æˆ–ä¿¡æ¯ç¨€ç–ï¼Œè¿™äº›å…³é”®æ–¹é¢åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè¢«å¿½è§†äº†ã€‚ä¸ºæ­¤ï¼Œæœ¬æ–‡æå‡ºäº† SpatialGenEvalï¼Œè¿™æ˜¯ä¸€ä¸ªæ—¨åœ¨ç³»ç»Ÿè¯„ä¼° T2I æ¨¡å‹ç©ºé—´æ™ºèƒ½çš„æ–°åŸºå‡†ï¼Œä¸»è¦æ¶µç›–ä¸¤ä¸ªæ–¹é¢ï¼š(1) SpatialGenEval åŒ…å«äº†æ¶µç›– 25 ä¸ªçœŸå®ä¸–ç•Œåœºæ™¯çš„ 1,230 ä¸ªé•¿ä¸”ä¿¡æ¯å¯†é›†çš„æç¤ºã€‚æ¯ä¸ªæç¤ºæ•´åˆäº† 10 ä¸ªç©ºé—´å­é¢†åŸŸåŠå…¶å¯¹åº”çš„ 10 ä¸ªå¤šé¡¹é€‰æ‹©é¢˜-ç­”æ¡ˆå¯¹ï¼Œå†…å®¹æ¶µç›–ç‰©ä½“ä½ç½®ã€å¸ƒå±€ã€é®æŒ¡åŠå› æœå…³ç³»ç­‰å¤šä¸ªæ–¹é¢ã€‚æˆ‘ä»¬å¯¹ 21 ä¸ªå‰æ²¿æ¨¡å‹è¿›è¡Œäº†å…¨é¢è¯„ä¼°ï¼Œç»“æœè¡¨æ˜é«˜é˜¶ç©ºé—´æ¨ç†ä»æ˜¯å…¶ä¸»è¦ç“¶é¢ˆã€‚(2) ä¸ºäº†è¯æ˜æˆ‘ä»¬ä¿¡æ¯å¯†é›†è®¾è®¡çš„ä»·å€¼ä¸ä»…é™äºè¯„ä¼°ï¼Œæˆ‘ä»¬è¿˜æ„å»ºäº† SpatialT2I æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†åŒ…å« 15,400 ä¸ªæ–‡æœ¬-å›¾åƒå¯¹ï¼Œå…¶ä¸­çš„æç¤ºç»è¿‡é‡å†™ï¼Œåœ¨ä¿æŒä¿¡æ¯å¯†åº¦çš„åŒæ—¶ç¡®ä¿äº†ä¸å›¾åƒå†…å®¹çš„ä¸€è‡´æ€§ã€‚åŸºäºå½“å‰ä¸»æµåŸºç¡€æ¨¡å‹ï¼ˆå³ Stable Diffusion-XLã€Uniworld-V1ã€OmniGen2ï¼‰çš„å¾®è°ƒå®éªŒæ˜¾ç¤ºï¼Œæ¨¡å‹æ€§èƒ½è·å¾—äº†ç¨³å®šæå‡ï¼ˆåˆ†åˆ«æå‡ +4.2%ã€+5.7%ã€+4.4%ï¼‰ï¼Œå¹¶ä¸”åœ¨ç©ºé—´å…³ç³»ä¸Šå‘ˆç°å‡ºæ›´é€¼çœŸçš„æ•ˆæœï¼Œè¿™å‡¸æ˜¾äº†é€šè¿‡ä»¥æ•°æ®ä¸ºä¸­å¿ƒçš„æ–¹æ³•æ¥å®ç° T2I æ¨¡å‹ç©ºé—´æ™ºèƒ½çš„æ½œåŠ›ã€‚</p>
<h2 data-id="heading-7">Advancing Open-source World Models</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.20540" target="_blank" title="https://arxiv.org/abs/2601.20540" ref="nofollow noopener noreferrer">æ¨è¿›å¼€æºä¸–ç•Œæ¨¡å‹</a></p>
<p>æˆ‘ä»¬æ¨å‡º LingBot-Worldï¼Œä¸€ä¸ªåŸºäºè§†é¢‘ç”Ÿæˆçš„å¼€æºä¸–ç•Œæ¨¡æ‹Ÿå™¨ã€‚å®ƒå®šä½ä¸ºé¡¶çº§ä¸–ç•Œæ¨¡å‹ï¼Œå…·å¤‡ä»¥ä¸‹ç‰¹æ€§ã€‚(1) åœ¨åŒ…æ‹¬å†™å®ã€ç§‘å­¦åœºæ™¯ã€å¡é€šé£æ ¼ç­‰åœ¨å†…çš„å¹¿æ³›ç¯å¢ƒä¸­ï¼Œå‡èƒ½ä¿æŒé«˜ä¿çœŸåº¦ä¸ç¨³å¥çš„åŠ¨æ€ç‰¹æ€§ã€‚(2) æ”¯æŒåˆ†é’Ÿçº§çš„æ¨¡æ‹Ÿæ—¶é•¿ï¼Œå¹¶èƒ½éšæ—¶é—´ä¿æŒä¸Šä¸‹æ–‡ä¸€è‡´æ€§ï¼Œå³å…·å¤‡"é•¿æœŸè®°å¿†"èƒ½åŠ›ã€‚(3) æ”¯æŒå®æ—¶äº¤äº’ï¼Œåœ¨ä»¥æ¯ç§’16å¸§çš„é€Ÿç‡ç”Ÿæˆæ—¶ï¼Œå¯å®ç°ä½äº1ç§’çš„å»¶è¿Ÿã€‚æˆ‘ä»¬å…¬å¼€äº†ä»£ç å’Œæ¨¡å‹ï¼Œä»¥æœŸç¼©å°å¼€æºä¸é—­æºæŠ€æœ¯ä¹‹é—´çš„å·®è·ã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œæ­¤æ¬¡å‘å¸ƒå°†åŠ©åŠ›ç¤¾åŒºåœ¨å†…å®¹åˆ›ä½œã€æ¸¸æˆåŠæœºå™¨äººå­¦ä¹ ç­‰é¢†åŸŸå®ç°å®é™…åº”ç”¨ã€‚</p>
<h2 data-id="heading-8">SWE-Pruner: Self-Adaptive Context Pruning for Coding Agents</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.16746" target="_blank" title="https://arxiv.org/abs/2601.16746" ref="nofollow noopener noreferrer">SWE-Pruner: é¢å‘ç¼–ç æ™ºèƒ½ä½“çš„è‡ªé€‚åº”ä¸Šä¸‹æ–‡å‰ªæ</a></p>
<p>å¤§è¯­è¨€æ¨¡å‹æ™ºèƒ½ä½“åœ¨è½¯ä»¶å¼€å‘ä¸­å·²å±•ç°å‡ºå“è¶Šèƒ½åŠ›ï¼Œä½†å…¶æ€§èƒ½å¸¸å—é™äºå†—é•¿çš„äº¤äº’ä¸Šä¸‹æ–‡ï¼Œè¿™ä¼šå¸¦æ¥é«˜æ˜‚çš„ API è°ƒç”¨æˆæœ¬å’Œå»¶è¿Ÿã€‚å°½ç®¡å·²æœ‰å¤šç§ä¸Šä¸‹æ–‡å‹ç¼©æ–¹æ³• (å¦‚ LongLLMLingua) å‡ºç°ä»¥åº”å¯¹æ­¤é—®é¢˜ï¼Œä½†å®ƒä»¬é€šå¸¸ä¾èµ–å›ºå®šæŒ‡æ ‡ (å¦‚ PPL)ï¼Œè€Œå¿½ç•¥äº†ä»£ç ç†è§£çš„ä»»åŠ¡ç‰¹å®šæ€§ã€‚å› æ­¤ï¼Œè¿™äº›æ–¹æ³•å¾€å¾€ä¼šç ´åä»£ç çš„è¯­æ³•å’Œé€»è¾‘ç»“æ„ï¼Œä¸”æ— æ³•ä¿ç•™å…³é”®çš„å®ç°ç»†èŠ‚ã€‚æœ¬æ–‡æå‡º SWE-Prunerï¼Œä¸€ä¸ªä¸“ä¸ºç¼–ç æ™ºèƒ½ä½“è®¾è®¡çš„è‡ªé€‚åº”ä¸Šä¸‹æ–‡å‰ªææ¡†æ¶ã€‚è¯¥æ¡†æ¶å—äººç±»ç¨‹åºå‘˜åœ¨å¼€å‘ä¸è°ƒè¯•è¿‡ç¨‹ä¸­"é€‰æ‹©æ€§æµè§ˆ"æºä»£ç çš„å¯å‘ï¼Œèƒ½å¤Ÿå¯¹é•¿ä¸Šä¸‹æ–‡è¿›è¡Œä»»åŠ¡æ„ŸçŸ¥çš„è‡ªé€‚åº”å‰ªæã€‚å…·ä½“è€Œè¨€ï¼Œé’ˆå¯¹å½“å‰ä»»åŠ¡ï¼Œæ™ºèƒ½ä½“ä¼šåˆ¶å®šä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡ (ä¾‹å¦‚ "èšç„¦äºé”™è¯¯å¤„ç†") ä½œä¸ºæç¤ºï¼Œç”¨ä»¥æŒ‡å¯¼å‰ªæè¿‡ç¨‹ã€‚æˆ‘ä»¬è®­ç»ƒäº†ä¸€ä¸ªè½»é‡çº§ç¥ç»æµè§ˆæ¨¡å‹ (å‚æ•°é‡ 0.6B)ï¼Œä½¿å…¶èƒ½å¤Ÿä¾æ®ç»™å®šç›®æ ‡ï¼Œä»å‘¨è¾¹ä¸Šä¸‹æ–‡ä¸­åŠ¨æ€ç­›é€‰å‡ºç›¸å…³çš„ä»£ç è¡Œã€‚åœ¨å››ä¸ªåŸºå‡†æµ‹è¯•é›†å’Œå¤šä¸ªæ¨¡å‹ä¸Šçš„è¯„ä¼°ç»“æœè¡¨æ˜ï¼ŒSWE-Pruner åœ¨å„ç§åœºæ™¯ä¸‹å‡è¡¨ç°æœ‰æ•ˆï¼šåœ¨ SWE-Bench Verified ç­‰æ™ºèƒ½ä½“ä»»åŠ¡ä¸Šï¼Œå®ƒèƒ½å‡å°‘ 23-54% çš„ Token æ¶ˆè€—ï¼›åœ¨ LongCodeQA ç­‰å•è½®ä»»åŠ¡ä¸Šï¼Œåˆ™èƒ½å®ç°é«˜è¾¾ 14.84 å€çš„å‹ç¼©ç‡ï¼ŒåŒæ—¶æ€§èƒ½å½±å“å¾®ä¹å…¶å¾®ã€‚</p>
<h2 data-id="heading-9">Scaling Embeddings Outperforms Scaling Experts in Language Models</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.21204" target="_blank" title="https://arxiv.org/abs/2601.21204" ref="nofollow noopener noreferrer">åœ¨è¯­è¨€æ¨¡å‹ä¸­æ‰©å±•åµŒå…¥ä¼˜äºæ‰©å±•ä¸“å®¶</a></p>
<p>è™½ç„¶ä¸“å®¶æ··åˆ (Mixture-of-Experts, MoE) æ¶æ„å·²æˆä¸ºå¤§è¯­è¨€æ¨¡å‹ä¸­ç¨€ç–æ€§æ‰©å±•çš„æ ‡å‡†æ–¹æ³•ï¼Œä½†å®ƒä»¬æ­£æ—¥ç›Šé¢ä¸´æ”¶ç›Šé€’å‡å’Œç³»ç»Ÿçº§ç“¶é¢ˆã€‚åœ¨æœ¬å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢å°†åµŒå…¥æ‰©å±•ä½œä¸ºä¸€ç§å¼ºå¤§ä¸”æ­£äº¤çš„ç»´åº¦ï¼Œç”¨äºå®ç°ç¨€ç–æ€§æ‰©å±•ã€‚é€šè¿‡å…¨é¢çš„åˆ†æå’Œå®éªŒï¼Œæˆ‘ä»¬ç¡®å®šäº†åœ¨ç‰¹å®šæ¡ä»¶ä¸‹ï¼ŒåµŒå…¥æ‰©å±•ç›¸è¾ƒäºä¸“å®¶æ‰©å±•èƒ½å¤Ÿå®ç°æ›´ä¼˜å¸•ç´¯æ‰˜è¾¹ç•Œã€‚æˆ‘ä»¬ç³»ç»Ÿåœ°åˆ†æäº†å†³å®šæ­¤æ•ˆèƒ½çš„å…³é”®æ¶æ„å› ç´ ï¼ŒåŒ…æ‹¬å‚æ•°é¢„ç®—ã€ä»¥åŠä¸æ¨¡å‹å®½åº¦å’Œæ·±åº¦çš„ç›¸äº’ä½œç”¨ã€‚æ­¤å¤–ï¼Œé€šè¿‡æ•´åˆå®šåˆ¶çš„ç³»ç»Ÿä¼˜åŒ–å’Œæ¨æµ‹è§£ç  (Speculative Decoding)ï¼Œæˆ‘ä»¬æœ‰æ•ˆåœ°å°†è¿™ç§ç¨€ç–æ€§è½¬åŒ–ä¸ºæ˜¾è‘—çš„æ¨ç†åŠ é€Ÿã€‚åŸºäºè¿™äº›è§è§£ï¼Œæˆ‘ä»¬æ¨å‡ºäº† LongCat-Flash-Lite æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ä¸ªæ‹¥æœ‰ 685 äº¿å‚æ•°ã€æ¿€æ´»å‚æ•°çº¦ 30 äº¿ã€ä»å¤´å¼€å§‹è®­ç»ƒçš„æ¨¡å‹ã€‚å°½ç®¡å°†è¶…è¿‡ 300 äº¿å‚æ•°åˆ†é…ç»™äº†åµŒå…¥ï¼ŒLongCat-Flash-Lite ä¸ä»…è¶…è¶Šäº†å‚æ•°ç­‰æ•ˆçš„ MoE åŸºçº¿æ¨¡å‹ï¼Œè€Œä¸”åœ¨æ™ºèƒ½ä½“å’Œç¼–ç é¢†åŸŸï¼Œä¸ç°æœ‰åŒç­‰è§„æ¨¡çš„æ¨¡å‹ç›¸æ¯”ï¼Œå±•ç°å‡ºäº†å“è¶Šçš„ç«äº‰åŠ›ã€‚</p>
<h2 data-id="heading-10">Innovator-VL: A Multimodal Large Language Model for Scientific Discovery</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.19325" target="_blank" title="https://arxiv.org/abs/2601.19325" ref="nofollow noopener noreferrer">Innovator-VLï¼šä¸€ä¸ªç”¨äºç§‘å­¦å‘ç°çš„å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹</a></p>
<p>æˆ‘ä»¬æå‡ºäº† Innovator-VLï¼Œè¿™æ˜¯ä¸€ä¸ªé¢å‘ç§‘å­¦é¢†åŸŸçš„å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ï¼Œæ—¨åœ¨æå‡å¯¹å¤šç§ç§‘å­¦é¢†åŸŸçš„ç†è§£ä¸æ¨ç†èƒ½åŠ›ï¼ŒåŒæ—¶åœ¨é€šç”¨è§†è§‰ä»»åŠ¡ä¸Šä¿æŒä¼˜å¼‚æ€§èƒ½ã€‚ä¸å½“å‰ä¾èµ–æµ·é‡é¢†åŸŸç‰¹å®šé¢„è®­ç»ƒåŠä¸é€æ˜æµç¨‹çš„è¶‹åŠ¿ä¸åŒï¼Œæˆ‘ä»¬çš„ç ”ç©¶è¡¨æ˜ï¼ŒåŸºäºåŸåˆ™çš„è®­ç»ƒè®¾è®¡å’Œé€æ˜çš„æ–¹æ³•è®ºï¼Œèƒ½å¤Ÿä»¥å¤§å¹…é™ä½çš„æ•°æ®éœ€æ±‚å®ç°å¼ºå¤§çš„ç§‘å­¦æ™ºèƒ½ã€‚å…·ä½“è´¡çŒ®å¦‚ä¸‹ï¼š(i) é¦–å…ˆï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå®Œå…¨é€æ˜ã€ç«¯åˆ°ç«¯å¯å¤ç°çš„è®­ç»ƒæµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®æ”¶é›†ã€æ¸…æ´—ã€é¢„å¤„ç†ã€ç›‘ç£å¾®è°ƒã€å¼ºåŒ–å­¦ä¹ ã€è¯„ä¼°ä»¥åŠè¯¦ç»†çš„ä¼˜åŒ–æ–¹æ¡ˆï¼Œä¾¿äºç¤¾åŒºè¿›è¡Œç³»ç»Ÿæ€§å¤ç°ä¸æ‰©å±•ã€‚(ii) å…¶æ¬¡ï¼ŒInnovator-VL å±•ç°å‡ºå“è¶Šçš„æ•°æ®æ•ˆç‡ï¼Œåœ¨æœªè¿›è¡Œå¤§è§„æ¨¡é¢„è®­ç»ƒçš„æƒ…å†µä¸‹ï¼Œä»…ä½¿ç”¨å°‘äºäº”ç™¾ä¸‡çš„ç²¾é€‰æ ·æœ¬ï¼Œä¾¿åœ¨å¤šç§ç§‘å­¦ä»»åŠ¡ä¸Šå–å¾—äº†å…·æœ‰ç«äº‰åŠ›çš„æ€§èƒ½ã€‚è¿™ä¸€ç»“æœå‡¸æ˜¾äº†é€šè¿‡åŸåˆ™æ€§æ•°æ®é€‰æ‹©ï¼ˆè€Œéç›²ç›®è§„æ¨¡æ‰©å¼ ï¼‰æ¥å®ç°æœ‰æ•ˆæ¨ç†çš„å¯è¡Œæ€§ã€‚(iii) ç¬¬ä¸‰ï¼ŒInnovator-VL è¡¨ç°å‡ºå¼ºå¤§çš„æ³›åŒ–èƒ½åŠ›ï¼Œåœ¨é€šç”¨è§†è§‰ã€å¤šæ¨¡æ€æ¨ç†ä»¥åŠç§‘å­¦åŸºå‡†æµ‹è¯•ä¸­å‡è¾¾åˆ°äº†æœ‰ç«äº‰åŠ›çš„æ°´å¹³ã€‚è¿™è¡¨æ˜ï¼Œå°†ç§‘å­¦ä»»åŠ¡å¯¹é½èƒ½åŠ›é›†æˆåˆ°ç»Ÿä¸€æ¨¡å‹ä¸­ï¼Œå¹¶ä¸ä¼šå‰Šå¼±å…¶é€šç”¨æ€§èƒ½ã€‚æˆ‘ä»¬çš„å®è·µè¡¨æ˜ï¼Œå³ä½¿ä¸ä¾èµ–å¤§è§„æ¨¡æ•°æ®ï¼Œä¹Ÿèƒ½æ„å»ºå‡ºé«˜æ•ˆã€å¯å¤ç°ä¸”é«˜æ€§èƒ½çš„ç§‘å­¦å¤šæ¨¡æ€æ¨¡å‹ï¼Œè¿™ä¸ºæœªæ¥çš„ç ”ç©¶å¥ å®šäº†åšå®åŸºç¡€ã€‚</p>
<h2 data-id="heading-11">TwinBrainVLA: Unleashing the Potential of Generalist VLMs for Embodied Tasks via Asymmetric Mixture-of-Transformers</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.14133" target="_blank" title="https://arxiv.org/abs/2601.14133" ref="nofollow noopener noreferrer">é€šè¿‡éå¯¹ç§°æ··åˆTransformeræœºåˆ¶é‡Šæ”¾é€šç”¨VLMåœ¨å…·èº«ä»»åŠ¡ä¸­çš„æ½œåŠ›</a></p>
<p>æ ‡å‡†çš„è§†è§‰-è¯­è¨€-åŠ¨ä½œ (VLA) æ¨¡å‹é€šå¸¸é€šè¿‡å¾®è°ƒä¸€ä¸ªå•ä¸€çš„è§†è§‰-è¯­è¨€æ¨¡å‹ (VLM) ä¸»å¹²ç½‘ç»œæ¥ä¸“é—¨å®ç°æœºå™¨äººæ§åˆ¶ã€‚ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•åœ¨ç»´æŒé«˜çº§é€šç”¨è¯­ä¹‰ç†è§£ä¸å­¦ä¹ ä½çº§ã€ç»†ç²’åº¦çš„æ„Ÿè§‰è¿åŠ¨æŠ€èƒ½ä¹‹é—´äº§ç”Ÿäº†æ ¸å¿ƒçŸ›ç›¾ï¼Œå¸¸å¸¸å¯¼è‡´æ¨¡å‹å‡ºç°å¼€æ”¾ä¸–ç•Œèƒ½åŠ›çš„â€œç¾éš¾æ€§é—å¿˜â€ã€‚ä¸ºè§£å†³è¿™ä¸€å†²çªï¼Œæˆ‘ä»¬æå‡ºäº† TwinBrainVLAï¼Œè¿™æ˜¯ä¸€ç§æ–°é¢–çš„æ¶æ„ã€‚å®ƒåè°ƒäº†ä¸€ä¸ªä¿ç•™é€šç”¨è¯­ä¹‰ç†è§£çš„é€šç”¨ VLM ä¸ä¸€ä¸ªä¸“ç²¾äºå…·èº«æœ¬ä½“æ„ŸçŸ¥çš„ä¸“ç”¨ VLMï¼Œä»¥è¿›è¡Œè”åˆæœºå™¨äººæ§åˆ¶ã€‚TwinBrainVLA é€šè¿‡ä¸€ç§æ–°é¢–çš„éå¯¹ç§°æ··åˆTransformer (Asymmetric Mixture-of-Transformers, AsyMoT) æœºåˆ¶ï¼Œå°†ä¸€ä¸ªä¿æŒå¼ºå¤§é€šç”¨è§†è§‰æ¨ç†èƒ½åŠ›çš„å†»ç»“â€œå·¦è„‘â€ä¸ä¸€ä¸ªä¸“ä¸ºå…·èº«æ„ŸçŸ¥è®¾è®¡çš„å¯è®­ç»ƒâ€œå³è„‘â€é«˜æ•ˆååŒã€‚è¯¥è®¾è®¡ä½¿å¾—å³è„‘èƒ½å¤ŸåŠ¨æ€åœ°ä»å†»ç»“çš„å·¦è„‘ä¸­æŸ¥è¯¢è¯­ä¹‰çŸ¥è¯†ï¼Œå¹¶å°†å…¶ä¸æœ¬ä½“æ„ŸçŸ¥çŠ¶æ€èåˆï¼Œä»è€Œä¸ºæµåŒ¹é…åŠ¨ä½œä¸“å®¶ (Flow-Matching Action Expert) ç”Ÿæˆç²¾ç¡®çš„è¿ç»­æ§åˆ¶æä¾›äº†ä¸°å¯Œçš„æ¡ä»¶ä¿¡æ¯ã€‚åœ¨ SimplerEnv å’Œ RoboCasa åŸºå‡†ä¸Šè¿›è¡Œçš„å¤§é‡å®éªŒè¡¨æ˜ï¼Œä¸æœ€å…ˆè¿›çš„åŸºçº¿æ¨¡å‹ç›¸æ¯”ï¼ŒTwinBrainVLA å®ç°äº†æ›´ä¼˜çš„æ“ä½œæ€§èƒ½ï¼ŒåŒæ—¶æ˜ç¡®ä¿ç•™äº†é¢„è®­ç»ƒ VLM çš„å…¨é¢è§†è§‰ç†è§£èƒ½åŠ›ã€‚è¿™ä¸ºæ„å»ºåŒæ—¶å…·å¤‡é«˜çº§è¯­ä¹‰ç†è§£å’Œä½çº§ç‰©ç†çµå·§æ€§çš„é€šç”¨æœºå™¨äººæŒ‡æ˜äº†ä¸€ä¸ªæœ‰å‰æ™¯çš„æ–¹å‘ã€‚</p>
<h2 data-id="heading-12">The Script is All You Need: An Agentic Framework for Long-Horizon Dialogue-to-Cinematic Video Generation</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.17737" target="_blank" title="https://arxiv.org/abs/2601.17737" ref="nofollow noopener noreferrer">å‰§æœ¬å³æ‰€éœ€ï¼šä¸€ç§é¢å‘é•¿è·¨åº¦å¯¹è¯åˆ°ç”µå½±è§†é¢‘ç”Ÿæˆçš„æ™ºèƒ½ä½“æ¡†æ¶</a></p>
<p>è¿‘æœŸè§†é¢‘ç”ŸæˆæŠ€æœ¯çš„è¿›å±•å‚¬ç”Ÿäº†è®¸å¤šæ¨¡å‹ï¼Œå®ƒä»¬èƒ½å¤Ÿæ ¹æ®ç®€å•çš„æ–‡æœ¬æç¤ºåˆæˆè§†è§‰æ•ˆæœæƒŠäººçš„å†…å®¹ã€‚ç„¶è€Œï¼Œè¿™äº›æ¨¡å‹éš¾ä»¥åŸºäºå¯¹è¯è¿™ç±»é«˜å±‚çº§æ¦‚å¿µç”Ÿæˆç¯‡å¹…è¾ƒé•¿ä¸”è¿è´¯çš„å™äº‹ï¼Œè¿™æš´éœ²å‡ºåˆ›æ„æ„æ€ä¸å…¶ç”µå½±åŒ–å‘ˆç°ä¹‹é—´å­˜åœ¨â€œè¯­ä¹‰é¸¿æ²Ÿâ€ã€‚ä¸ºå¼¥åˆæ­¤é¸¿æ²Ÿï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°é¢–çš„ã€ç«¯åˆ°ç«¯çš„æ™ºèƒ½ä½“æ¡†æ¶ï¼Œç”¨äºä»å¯¹è¯ç”Ÿæˆç”µå½±è§†é¢‘ã€‚è¯¥æ¡†æ¶çš„æ ¸å¿ƒæ˜¯ ScripterAgentï¼Œå®ƒæ˜¯ä¸€ä¸ªç»è¿‡è®­ç»ƒçš„æ¨¡å‹ï¼Œèƒ½å¤Ÿå°†ç²—ç•¥çš„å¯¹è¯è½¬åŒ–ä¸ºç»†ç²’åº¦ã€å¯æ‰§è¡Œçš„ç”µå½±å‰§æœ¬ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æ„å»ºäº† ScriptBenchï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å«ä¸°å¯Œå¤šæ¨¡æ€ä¸Šä¸‹æ–‡ä¿¡æ¯çš„å¤§è§„æ¨¡æ–°åŸºå‡†æ•°æ®é›†ï¼Œå…¶æ ‡æ³¨å·¥ä½œé€šè¿‡ä¸“å®¶æŒ‡å¯¼çš„æµç¨‹å®Œæˆã€‚ç”Ÿæˆçš„å‰§æœ¬éšåç”¨äºæŒ‡å¯¼ DirectorAgentï¼Œåè€…é‡‡ç”¨è·¨åœºæ™¯è¿ç»­ç”Ÿæˆç­–ç•¥æ¥åè°ƒè°ƒåº¦å¤šä¸ªæœ€å…ˆè¿›çš„è§†é¢‘æ¨¡å‹ï¼Œä»¥ç¡®ä¿é•¿è·¨åº¦å™äº‹çš„ä¸€è‡´æ€§ã€‚æˆ‘ä»¬è¿›è¡Œäº†å…¨é¢çš„è¯„ä¼°ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªç”± AI é©±åŠ¨çš„ CriticAgent ä»¥åŠä¸€ä¸ªæ–°æå‡ºçš„è§†è§‰-å‰§æœ¬å¯¹é½ (VSA) æŒ‡æ ‡ã€‚è¯„ä¼°ç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ¡†æ¶æ˜¾è‘—æå‡äº†æ‰€æœ‰è¢«æµ‹è§†é¢‘æ¨¡å‹åœ¨å‰§æœ¬å¿ å®åº¦å’Œæ—¶é—´ä¿çœŸåº¦æ–¹é¢çš„è¡¨ç°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬çš„åˆ†ææ­ç¤ºäº†å½“å‰æœ€å…ˆè¿›æ¨¡å‹åœ¨è¿½æ±‚è§†è§‰å¥‡è§‚ä¸ä¸¥æ ¼éµå¾ªå‰§æœ¬ä¹‹é—´å­˜åœ¨å…³é”®æƒè¡¡ï¼Œè¿™ä¸ºè‡ªåŠ¨åŒ–ç”µå½±åˆ¶ä½œçš„æœªæ¥å‘å±•æä¾›äº†æœ‰ä»·å€¼çš„è§è§£ã€‚</p>
<h2 data-id="heading-13">DynamicVLA: A Vision-Language-Action Model for Dynamic Object Manipulation</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.22153" target="_blank" title="https://arxiv.org/abs/2601.22153" ref="nofollow noopener noreferrer">DynamicVLAï¼šç”¨äºåŠ¨æ€ç‰©ä½“æ“ä½œçš„è§†è§‰-è¯­è¨€-åŠ¨ä½œæ¨¡å‹</a></p>
<p>åŠ¨æ€ç‰©ä½“æ“ä½œå¯¹è§†è§‰-è¯­è¨€-åŠ¨ä½œ (VLA) æ¨¡å‹è€Œè¨€ä»æ˜¯ä¸€ä¸ªå¼€æ”¾æŒ‘æˆ˜ã€‚è¿™ç±»æ¨¡å‹è™½ç„¶åœ¨é™æ€æ“ä½œä¸­æ³›åŒ–èƒ½åŠ›å¾ˆå¼ºï¼Œä½†åœ¨éœ€è¦å¿«é€Ÿæ„ŸçŸ¥ã€æ—¶åºé¢„æµ‹å’Œè¿ç»­æ§åˆ¶çš„åŠ¨æ€åœºæ™¯ä¸­å´è¡¨ç°ä¸ä½³ã€‚æˆ‘ä»¬æå‡ºäº† DynamicVLAï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºåŠ¨æ€ç‰©ä½“æ“ä½œçš„æ¡†æ¶ï¼Œå®ƒé€šè¿‡ä¸‰é¡¹å…³é”®è®¾è®¡æ•´åˆäº†æ—¶åºæ¨ç†å’Œé—­ç¯é€‚åº”èƒ½åŠ›ï¼š1) ä¸€ä¸ªç´§å‡‘çš„ 0.4B å‚æ•° VLA æ¨¡å‹ï¼Œé‡‡ç”¨å·ç§¯è§†è§‰ç¼–ç å™¨è¿›è¡Œç©ºé—´é«˜æ•ˆä¸”ç»“æ„ä¿çœŸçš„ç¼–ç ï¼Œä»è€Œå®ç°å¿«é€Ÿçš„å¤šæ¨¡æ€æ¨ç†ï¼›2) è¿ç»­æ¨ç†æœºåˆ¶ï¼Œé€šè¿‡é‡å æ¨ç†ä¸æ‰§è¡Œæ¥é™ä½å»¶è¿Ÿï¼Œå¹¶åŠæ—¶é€‚åº”ç‰©ä½“è¿åŠ¨ï¼›3) æ½œåœ¨æ„ŸçŸ¥åŠ¨ä½œæµæŠ€æœ¯ï¼Œé€šè¿‡å¼ºåˆ¶æ‰§è¡Œæ—¶é—´å¯¹é½çš„åŠ¨ä½œæ¥å¼¥åˆæ„ŸçŸ¥ä¸æ‰§è¡Œä¹‹é—´çš„å·®è·ã€‚ä¸ºäº†å¡«è¡¥åŠ¨æ€æ“ä½œæ•°æ®åŸºç¡€çš„ç¼ºå¤±ï¼Œæˆ‘ä»¬å¼•å…¥äº†åŠ¨æ€ç‰©ä½“æ“ä½œ (DOM) åŸºå‡†ã€‚è¯¥åŸºå‡†ä»å¤´æ„å»ºï¼Œé‡‡ç”¨è‡ªåŠ¨æ•°æ®æ”¶é›†æµç¨‹ï¼Œé«˜æ•ˆé‡‡é›†äº†æ¶µç›– 2.8K ä¸ªåœºæ™¯å’Œ 206 ä¸ªç‰©ä½“çš„ 20 ä¸‡æ¡åˆæˆäº¤äº’ç‰‡æ®µï¼Œå¹¶èƒ½å¿«é€Ÿæ”¶é›† 2K æ¡æ— éœ€é¥æ“ä½œçš„çœŸå®ä¸–ç•Œç‰‡æ®µã€‚å¤§é‡è¯„ä¼°ç»“æœè¡¨æ˜ï¼ŒDynamicVLA åœ¨å“åº”é€Ÿåº¦ã€æ„ŸçŸ¥èƒ½åŠ›å’Œæ³›åŒ–æ€§èƒ½ä¸Šå‡æœ‰æ˜¾è‘—æå‡ï¼Œä½¿å…¶æˆä¸ºä¸€ä¸ªé€‚ç”¨äºè·¨å…·èº«é€šç”¨åŠ¨æ€ç‰©ä½“æ“ä½œçš„ç»Ÿä¸€æ¡†æ¶ã€‚</p>
<h2 data-id="heading-14">AdaReasoner: Dynamic Tool Orchestration for Iterative Visual Reasoning</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2601.18631" target="_blank" title="https://arxiv.org/abs/2601.18631" ref="nofollow noopener noreferrer">AdaReasoner: é¢å‘è¿­ä»£è§†è§‰æ¨ç†çš„åŠ¨æ€å·¥å…·ç¼–æ’</a></p>
<p>å½“äººç±»é‡åˆ°è¶…å‡ºè‡ªèº«å³æ—¶èƒ½åŠ›çš„é—®é¢˜æ—¶ï¼Œå¾€å¾€ä¼šå€ŸåŠ©å·¥å…·ã€‚è¿™ä¸ºæé«˜å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹ (MLLMs) çš„è§†è§‰æ¨ç†èƒ½åŠ›æä¾›äº†ä¸€ä¸ªæå…·å‰æ™¯çš„èŒƒå¼ã€‚æœ‰æ•ˆçš„æ¨ç†ï¼Œå…³é”®åœ¨äºçŸ¥é“åœ¨ä½•æ—¶ã€é€‰ç”¨ä½•ç§å·¥å…·ï¼Œä»¥åŠå¦‚ä½•åœ¨å¤šæ­¥éª¤ä¸­ç»„åˆè¿™äº›å·¥å…·ï¼Œå³ä½¿é¢å¯¹æ–°å·¥å…·æˆ–æ–°ä»»åŠ¡æ—¶ä¹Ÿåº”å¦‚æ­¤ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† <strong>AdaReasoner</strong> æ¨¡å‹å®¶æ—ï¼Œå…¶æ ¸å¿ƒåœ¨äºå°†å·¥å…·ä½¿ç”¨å­¦ä¹ ä¸ºä¸€ç§é€šç”¨çš„æ¨ç†æŠ€èƒ½ï¼Œè€Œéé’ˆå¯¹ç‰¹å®šå·¥å…·æˆ–ä¾èµ–äºæ˜¾å¼ç›‘ç£çš„è¡Œä¸ºã€‚AdaReasoner çš„å®ç°åŸºäºä¸‰ä¸ªå…³é”®ç»„ä»¶ï¼š(i) ä¸€ä¸ªå¯æ‰©å±•çš„æ•°æ®æ•´ç†æµç¨‹ï¼Œè®©æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ é•¿è§†é‡ã€å¤šæ­¥éª¤çš„å·¥å…·äº¤äº’ï¼›(ii) Tool-GRPO å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œè¯¥ç®—æ³•æ ¹æ®æœ€ç»ˆä»»åŠ¡çš„æˆåŠŸç‡æ¥ä¼˜åŒ–å·¥å…·çš„é€‰æ‹©ä¸è°ƒç”¨é¡ºåºï¼›(iii) ä¸€ç§èƒ½å¤ŸåŠ¨æ€è°ƒèŠ‚å·¥å…·ä½¿ç”¨çš„è‡ªé€‚åº”å­¦ä¹ æœºåˆ¶ã€‚è¿™äº›ç»„ä»¶ååŒå·¥ä½œï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿæ ¹æ®ä»»åŠ¡ä¸Šä¸‹æ–‡å’Œä¸­é—´ç»“æœæ¨æ–­å·¥å…·çš„æ•ˆç”¨ï¼Œä»è€Œåè°ƒå¤šä¸ªå·¥å…·çš„ä½¿ç”¨ï¼Œå¹¶æ³›åŒ–è‡³æœªè§è¿‡çš„å·¥å…·ã€‚å®è¯ç»“æœè¡¨æ˜ï¼ŒAdaReasoner å±•ç°å‡ºå¼ºå¤§çš„å·¥å…·è‡ªé€‚åº”å’Œæ³›åŒ–èƒ½åŠ›ï¼šå®ƒèƒ½è‡ªä¸»é‡‡çº³æœ‰ç›Šçš„å·¥å…·ã€æŠ‘åˆ¶æ— å…³å·¥å…·ï¼Œå¹¶æ ¹æ®ä»»åŠ¡éœ€æ±‚è°ƒæ•´å·¥å…·ä½¿ç”¨é¢‘ç‡ï¼Œå°½ç®¡æ¨¡å‹ä»æœªè¢«æ˜ç¡®è®­ç»ƒå»æ‰§è¡Œè¿™äº›è¡Œä¸ºã€‚è¿™äº›èƒ½åŠ›ä½¿å…¶åœ¨å¤šä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„åŸºå‡†æµ‹è¯•ä¸­å–å¾—äº†æœ€å…ˆè¿›çš„æ€§èƒ½ï¼šå®ƒå°† 7B åŸºç¡€æ¨¡å‹çš„å¹³å‡æ€§èƒ½æå‡äº† 24.9%ï¼Œå¹¶åœ¨åŒ…æ‹¬ VSP å’Œ Jigsaw åœ¨å†…çš„å¤šé¡¹ä»»åŠ¡ä¸Šè¶…è¶Šäº† GPT-5 ç­‰å¼ºå¤§çš„é—­æºæ¨¡å‹ç³»ç»Ÿã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€OpenClaw/Moltbotè‡ªåŠ¨è¿›åŒ–æŠ€å·§åˆ†äº«ï¼æ‰“é€ å…¨è‡ªåŠ¨æ™ºèƒ½è¶…çº§åŠ©æ‰‹ï¼Œå½»åº•è§£æ”¾åŒæ‰‹ï¼Œè®©AIè¶Šç”¨è¶Šèªæ˜ï¼èƒ½è‡ªåŠ¨å­¦ä¹ é¿å‘ï¼OpenClawè‡ªåŠ¨æ“æ§Claud]]></title>    <link>https://juejin.cn/post/7601169987411804198</link>    <guid>https://juejin.cn/post/7601169987411804198</guid>    <pubDate>2026-01-31T14:21:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601169987411804198" data-draft-id="7601169987411787814" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€OpenClaw/Moltbotè‡ªåŠ¨è¿›åŒ–æŠ€å·§åˆ†äº«ï¼æ‰“é€ å…¨è‡ªåŠ¨æ™ºèƒ½è¶…çº§åŠ©æ‰‹ï¼Œå½»åº•è§£æ”¾åŒæ‰‹ï¼Œè®©AIè¶Šç”¨è¶Šèªæ˜ï¼èƒ½è‡ªåŠ¨å­¦ä¹ é¿å‘ï¼OpenClawè‡ªåŠ¨æ“æ§Claud"/> <meta itemprop="keywords" content="AIGC,OpenAI,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-31T14:21:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="win4r"/> <meta itemprop="url" content="https://juejin.cn/user/1739869037541555"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€OpenClaw/Moltbotè‡ªåŠ¨è¿›åŒ–æŠ€å·§åˆ†äº«ï¼æ‰“é€ å…¨è‡ªåŠ¨æ™ºèƒ½è¶…çº§åŠ©æ‰‹ï¼Œå½»åº•è§£æ”¾åŒæ‰‹ï¼Œè®©AIè¶Šç”¨è¶Šèªæ˜ï¼èƒ½è‡ªåŠ¨å­¦ä¹ é¿å‘ï¼OpenClawè‡ªåŠ¨æ“æ§Claud
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1739869037541555/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    win4r
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T14:21:02.000Z" title="Sat Jan 31 2026 14:21:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ·±åº¦ä½“éªŒOpenClawï¼šè¿™æ‰æ˜¯AIè¶…çº§åŠ©ç†è¯¥æœ‰çš„æ ·å­</h2>
<p>å¤§å®¶å¥½ï¼Œä»Šå¤©ä¸ºå¤§å®¶åˆ†äº«ä¸€ä¸‹OpenClawè¿™ä¸ªé¡¹ç›®çš„çœŸå®ä½¿ç”¨åœºæ™¯å’Œä½¿ç”¨æŠ€å·§ã€‚</p>
<p>ğŸ”¥ğŸ”¥ğŸ”¥<strong>æœ¬ç¯‡ç¬”è®°æ‰€å¯¹åº”çš„è§†é¢‘ï¼š</strong> ****<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV17B61BxE3h%2F" target="_blank" title="https://www.bilibili.com/video/BV17B61BxE3h/" ref="nofollow noopener noreferrer"><strong>https://www.bilibili.com/video/BV17B61BxE3h/</strong>****</a></p>
<p>å…ˆè¯´ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®çš„æ›´åå†ç¨‹ï¼Œå‰å‡ å¤©è¿™ä¸ªé¡¹ç›®è¿˜å«ClawdBotï¼Œç„¶åæ”¹åæˆäº†MoltBotï¼Œæ˜¨å¤©åˆä»MoltBotæ”¹æˆäº†OpenClawã€‚æ‰€ä»¥æœ¬æ–‡æˆ‘ä»¬å°±æŒ‰ç…§æœ€æ–°çš„åå­—OpenClawæ¥ç§°å‘¼å®ƒã€‚</p>
<p>é€šè¿‡æˆ‘è¿™å‡ å¤©çš„æ·±åº¦ä½¿ç”¨ï¼Œæœ€å¤§çš„æ„Ÿå—å°±æ˜¯â€”â€”<strong>OpenClawæ›´åƒæ˜¯ä¸€ä¸ªè¶…çº§åŠ©ç†</strong>ã€‚å®ƒå¹¶ä¸æ˜¯å•å•ç»™Claude CodeåŠ äº†ä¸ªå³æ—¶é€šè®¯è½¯ä»¶è¿™ä¹ˆç®€å•ï¼Œå› ä¸ºOpenClawå®ƒå…·æœ‰æŒä¹…çš„è®°å¿†ä¸å®šæ—¶ä»»åŠ¡åŠŸèƒ½ï¼Œè€Œä¸”è¿˜èƒ½é€šè¿‡Home Assistantæ¥æ§åˆ¶æ™ºèƒ½å®¶å±…ã€‚æ›´å‰å®³çš„æ˜¯ï¼Œå®ƒè¿˜å¯ä»¥å®ç°è¾¹æ‰§è¡Œä»»åŠ¡è¾¹å­¦ä¹ ï¼Œèƒ½å¤Ÿè®°ä½ä¹‹å‰è¸©çš„å‘ä»¥åŠé‡åˆ°çš„é—®é¢˜ï¼Œå¹¶ä¸”èƒ½å¤Ÿå°†ç»éªŒåŒæ­¥æ›´æ–°åˆ°å¯¹åº”çš„Skillä¸­ã€‚</p>
<h3 data-id="heading-1">å…³äºå®‰å…¨æ€§ï¼Œå®Œå…¨ä¸ç”¨æ‹…å¿ƒ</h3>
<p>å¤§å®¶å¯èƒ½æ‹…å¿ƒOpenClawçš„å®‰å…¨é—®é¢˜ï¼Œè¿™ä¸ªæ‹…å¿ƒæ˜¯å®Œå…¨æ²¡å¿…è¦çš„ã€‚</p>
<p>é€šè¿‡æˆ‘è¿™å‡ å¤©é«˜å¼ºåº¦çš„æµ‹è¯•ï¼Œè®©OpenClawæ‰§è¡Œå„ç§æ•æ„Ÿæ“ä½œï¼Œæ¯”å¦‚è¯´è®©å®ƒæ¥æ‰§è¡Œ<code>rm -rf /</code>è¿™æ¡å‘½ä»¤ï¼Œç„¶åOpenClawå®ƒèƒ½å‡†ç¡®è¯†åˆ«åˆ°æ‰§è¡Œè¿™æ¡å‘½ä»¤ä¼šå°†ç³»ç»Ÿæ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å…¨éƒ¨åˆ é™¤ï¼Œç­‰åŒäºè‡ªæ¯æœåŠ¡å™¨ï¼Œæ‰€ä»¥å®ƒç›´æ¥æ‹’ç»æ‰§è¡Œã€‚</p>
<p>è¿˜æœ‰å°±æ˜¯æˆ‘è®©å®ƒæ˜¾ç¤ºå­˜å‚¨API Keyçš„é…ç½®æ–‡ä»¶é‡Œçš„å†…å®¹ï¼Œç„¶åOpenClawå®ƒèƒ½å¾ˆæ™ºèƒ½åœ°çŸ¥é“è¿™ä¸ªæ–‡ä»¶é‡Œçš„å†…å®¹æ˜¯æ•æ„Ÿå†…å®¹ï¼Œä¸èƒ½é€éœ²ç»™æˆ‘ä»¬ã€‚ç„¶åæˆ‘è®©å®ƒç›´æ¥å°†è¿™ä¸ªæ–‡ä»¶å‘é€ç»™æˆ‘ï¼Œå®ƒä¹Ÿä¸ä¼šç›´æ¥å°†æ–‡ä»¶å‘é€ç»™æˆ‘ï¼Œè€Œæ˜¯åªå‘ç»™æˆ‘é…ç½®ç»“æ„ï¼Œå¹¶ä¸ä¼šå°†è¿™äº›API Keyç­‰æ•æ„Ÿå†…å®¹å‘é€ç»™æˆ‘ã€‚</p>
<p>æ‰€ä»¥è‡ªåª’ä½“ä¸Šé‚£äº›è¯´OpenClawåˆ é™¤äº†ä»–ä»¬çš„æ•°æ®æˆ–è€…åˆ é™¤äº†ä»–ä»¬æ–‡ä»¶çš„è¯´æ³•ï¼Œæˆ‘æ„Ÿè§‰éƒ½æ˜¯ä¸ºäº†æµé‡æ•…æ„ç¼–é€ çš„ä¸€äº›å¼•äººè½¬å‘çš„è¯é¢˜ã€‚</p>
<h3 data-id="heading-2">æˆ‘ç”¨OpenClawå®ç°äº†ä»€ä¹ˆï¼Ÿ</h3>
<p>æˆ‘ç”¨OpenClawå®ç°äº†<strong>è‡ªåŠ¨å‘X Post</strong>çš„åŠŸèƒ½ï¼Œè€Œä¸”è¿˜å®ç°äº†<strong>æ¯å¤©æ—©ä¸Š8ç‚¹å‡†æ—¶ä¸ºæˆ‘ç”Ÿæˆä¸AIç›¸å…³çš„è‹±æ–‡æ’­å®¢</strong>ã€‚å½“å®ƒç”Ÿæˆå¥½è‹±æ–‡æ’­å®¢ï¼Œå°±ä¼šè‡ªåŠ¨æ¨é€ç»™æˆ‘è¿™ä¸ªéŸ³é¢‘æ–‡ä»¶ï¼Œç„¶åæˆ‘åªéœ€è¦ç‚¹å‡»æ’­æ”¾å°±å¯ä»¥äº†ã€‚åƒè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬æ¯å¤©æ—©ä¸Šå°±å¯ä»¥å¬OpenClawä¸ºæˆ‘ä»¬ç”Ÿæˆçš„ä¸AIç›¸å…³çš„è‹±æ–‡æ’­å®¢æ¥ç»ƒä¹ è‹±è¯­å¬åŠ›ã€‚</p>
<p>æˆ‘ç”šè‡³è¿˜å®ç°äº†<strong>è®©OpenClawæ“æ§Claude Code</strong>ï¼Œé€šè¿‡SpecKitå®ç°è§„æ ¼é©±åŠ¨å¼€å‘ã€‚ä¹Ÿå°±æ˜¯æ•´ä¸ªæ“ä½œæµç¨‹éƒ½ç”±OpenClawæ¥æ“æ§ï¼ŒClaude Codeé€šè¿‡SpecKitå®ç°è§„æ ¼é©±åŠ¨å¼€å‘ï¼Œæ•´ä¸ªè¿‡ç¨‹éƒ½ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»å¹²é¢„ã€‚</p>
<p>å½“OpenClawå®Œæˆæ•´ä¸ªæ“ä½œæµç¨‹ä¹‹åï¼Œå®ƒå°±ä¼šå­¦ä¹ åˆ°è¿™äº›æ“ä½œæŠ€å·§å’Œæ“ä½œç»éªŒï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥è®©å®ƒå°†å­¦ä¹ åˆ°çš„ç»éªŒç›´æ¥å†™å…¥åˆ°å¯¹åº”çš„Skillä¸­ã€‚è¿™æ ·çš„è¯ï¼Œå®ƒä¸‹æ¬¡å†å¸®æˆ‘ä»¬å»æ“ä½œClaude Codeï¼Œå°±èƒ½å¤Ÿè¯»å–Skillä¸­ç§¯ç´¯çš„è¿™äº›ç»éªŒå’ŒæŠ€å·§ã€‚</p>
<p>é€šè¿‡ä¸æ–­è¿­ä»£å¯¹åº”çš„Skillä»¥åŠOpenClawçš„è®°å¿†ï¼Œæ‰€ä»¥OpenClawå®ƒæ›´åƒä¸€ä¸ª<strong>èƒ½å¤Ÿè‡ªåŠ¨è¿›åŒ–çš„AIæ™ºèƒ½ä½“</strong>ï¼Œè¶Šç”¨è¶Šèªæ˜ã€‚</p>
<h3 data-id="heading-3">ä¸ºä»€ä¹ˆæˆ‘é€‰æ‹©GPT-5.2æ¨¡å‹</h3>
<p>ä¸ºäº†è®©OpenClawæ›´èªæ˜ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨äº†GPT-5.2æ¨¡å‹ã€‚å› ä¸ºé€šè¿‡æˆ‘è¿™å‡ å¤©çš„æµ‹è¯•ï¼Œå‘ç°ä½¿ç”¨GPT-5.2å¯ä»¥å®Œæˆæ›´åŠ å¤æ‚çš„ä»»åŠ¡ã€‚ä¹‹æ‰€ä»¥æ²¡æœ‰ç”¨Claudeæ¨¡å‹ï¼Œæ˜¯å› ä¸ºæˆ‘æ€•è¢«Claudeç»™å°å·ã€‚</p>
<h3 data-id="heading-4">ä¸‰å¤§æ ¸å¿ƒSkillè¯¦è§£</h3>
<p>ä¸ºäº†è®©OpenClawèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆæ’­å®¢ã€èƒ½å¤Ÿä¸ºæˆ‘å‘X Postã€è¿˜æœ‰èƒ½å¤Ÿä¸ºæˆ‘è°ƒç”¨Claude Codeé€šè¿‡SpecKitå®ç°è§„æ ¼é©±åŠ¨å¼€å‘ï¼Œä¸ºäº†å®ç°è¿™äº›åŠŸèƒ½ï¼Œæ¯ä¸€ä¸ªåŠŸèƒ½æˆ‘éƒ½å†™äº†ä¸€ä¸ªSkillæ¥å®ç°å¯¹åº”çš„åœºæ™¯ï¼š</p>
<p><strong>ç¬¬ä¸€ä¸ªSkill</strong>æ˜¯ç”¨æ¥åœ¨Claude Codeæˆ–è€…åœ¨OpenClawä¸­å®ç°è‡ªåŠ¨å‘å¸ƒX Postçš„ã€‚</p>
<p><strong>ç¬¬äºŒä¸ªSkill</strong>æ˜¯ç”¨æ¥ç”Ÿæˆæ¯æ—¥è‹±æ–‡æ’­å®¢çš„ã€‚å¤§å®¶ä¹Ÿå¯ä»¥å°†è¿™ä¸ªSkillæ”¹æˆè®©å®ƒç”Ÿæˆä¸­æ–‡æ’­å®¢ï¼Œå› ä¸ºæˆ‘æ˜¯ä¸ºäº†ç»ƒä¹ è‹±è¯­å¬åŠ›ï¼Œæ‰€ä»¥é»˜è®¤è®©å®ƒç”Ÿæˆè‹±æ–‡æ’­å®¢ã€‚è¿™ä¸ªSkillçš„åŠŸèƒ½å°±æ˜¯å®ƒèƒ½å°†ä»»ä½•ä¸€ä¸ªé“¾æ¥é‡Œçš„æ–‡ç« å†…å®¹æ¥ç”Ÿæˆæ’­å®¢é£æ ¼çš„MP3ã€‚</p>
<p><strong>ç¬¬ä¸‰ä¸ªSkill</strong>å°±æ˜¯åœ¨OpenClawä¸­æ¥è°ƒç”¨Claude Codeï¼Œç”¨SpecKitæˆ–è€…OpenSpecå®ç°çœŸæ­£çš„è§„æ ¼é©±åŠ¨å¼€å‘ã€‚</p>
<h3 data-id="heading-5">æ’­å®¢ç”Ÿæˆå®æˆ˜æ¼”ç¤º</h3>
<p>æˆ‘ä»¬å¯ä»¥åœ¨OpenClawä¸­æ¥æµ‹è¯•ä¸€ä¸‹è¿™ä¸ªèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆæ’­å®¢çš„Skillã€‚æ¯”å¦‚è¯´æˆ‘ä»¬éšä¾¿æ‰¾ä¸€ç¯‡ç§‘æŠ€æ–‡ç« ï¼Œç›´æ¥å¤åˆ¶è¿™ä¸ªæ–‡ç« çš„é“¾æ¥ï¼Œå†å›åˆ°æˆ‘ä»¬çš„èŠå¤©è½¯ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥è¾“å…¥æç¤ºè¯ï¼š</p>
<blockquote>
<p>"å°†è¿™ç¯‡æ–‡ç« é€šè¿‡æ’­å®¢Skillç”Ÿæˆè‹±æ–‡æ’­å®¢"</p>
</blockquote>
<p>ç„¶åç›´æ¥å‘é€ï¼Œå®ƒå°±å¾ˆå¿«ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†è¿™ä¸ªæ’­å®¢ã€‚è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å®ç°äº†åœ¨OpenClawä¸­ä¸ºæˆ‘ä»¬ç”Ÿæˆæ’­å®¢ã€‚</p>
<p>ç„¶åæˆ‘ä»¬è¿˜å¯ä»¥å°†å®ƒè®¾ç½®æˆå®šæ—¶ä»»åŠ¡ï¼Œè®©å®ƒæ¯å¤©æ—©ä¸Šä¸ƒç‚¹è‡ªåŠ¨ç”Ÿæˆä¸€ç¯‡æ’­å®¢æ¨é€ç»™æˆ‘ã€‚å®ƒä¼šä»æŒ‡å®šçš„RSSé‡Œé€‰ä¸€ç¯‡æ–‡ç« æ¥ç”Ÿæˆè‹±æ–‡æ’­å®¢å¹¶ä¸”æ¨é€ç»™æˆ‘ã€‚</p>
<h3 data-id="heading-6">æ“æ§Claude Codeå®ç°è§„æ ¼é©±åŠ¨å¼€å‘</h3>
<p>ä¸‹é¢æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ä½¿ç”¨Claude Codeè¿™ä¸ªSkillï¼Œè®©OpenClawç›´æ¥æ“æ§Claude Codeï¼Œé€šè¿‡SpecKitæˆ–è€…OpenSpecè¿™ä¸¤ä¸ªè§„æ ¼é©±åŠ¨å¼€å‘çš„å·¥ä½œæµï¼Œåœ¨Claude Codeä¸­å®ç°çœŸæ­£çš„è§„æ ¼é©±åŠ¨å¼€å‘ã€‚</p>
<p>æˆ‘è¾“å…¥çš„æç¤ºè¯æ˜¯ï¼š</p>
<blockquote>
<p>"è°ƒç”¨Claude Codeï¼Œä½¿ç”¨OpenSpecå¼€å‘ä¸€ä¸ªXé£æ ¼çš„ç§äººæ—¥è®°çš„Webåº”ç”¨ï¼Œè¦æ±‚å…·æœ‰ç®€å•çš„å‘é€è¾“å…¥æ¡†ã€æ— é™æ»šåŠ¨æ—¶é—´çº¿ã€æƒ…ç»ªæ ‡ç­¾ã€å›¾ç‰‡ä¸Šä¼ ã€æ—¥å†å¿«é€Ÿè·³è½¬ã€å»å¹´ä»Šæ—¥å›é¡¾çš„åŠŸèƒ½"</p>
</blockquote>
<p>ç„¶åç›´æ¥å‘é€ï¼Œçœ‹ä¸€ä¸‹å®ƒèƒ½å¦é€šè¿‡è¿™ä¸ªSkillæ¥è°ƒç”¨Claude Codeä¸ºæˆ‘ä»¬å®Œæˆè¿™ä¸ªé¡¹ç›®çš„å¼€å‘ã€‚</p>
<h3 data-id="heading-7">Skillè¿­ä»£çš„æ ¸å¿ƒæ–¹æ³•è®º</h3>
<p>è®©æˆ‘æ¥åˆ†äº«ä¸€ä¸‹æˆ‘æ˜¯å¦‚ä½•åœ¨OpenClawä¸­é€šè¿‡ä¸æ–­è¯•é”™ã€ä¸æ–­è¿­ä»£ï¼Œæœ€åå®Œå–„äº†è¿™ä¸ªè°ƒç”¨Claude Codeçš„Skillã€‚</p>
<p>é¦–å…ˆæœ€ç®€å•çš„æ–¹å¼æ˜¯æˆ‘å°†Claude Codeçš„å®˜æ–¹æ–‡æ¡£å‘é€ç»™äº†OpenClawï¼Œç„¶åå‘Šè¯‰å®ƒè®©å®ƒæ·±åº¦é˜…è¯»Claude Codeçš„å®˜æ–¹æ–‡æ¡£ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªOpenClawå¯ä»¥è°ƒç”¨çš„Skillã€‚ç´§æ¥ç€å®ƒå°±é˜…è¯»äº†æ–‡æ¡£å¹¶ä¸”å¾ˆå¿«å¼€å‘å¥½äº†èƒ½å¤Ÿè°ƒç”¨Claude Codeçš„è¿™ä¸ªSkillã€‚</p>
<p>åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­é‡åˆ°æŠ¥é”™ï¼Œæˆ‘å°†æŠ¥é”™å‘é€ç»™å®ƒè®©å®ƒå»ä¿®å¤ï¼Œç»è¿‡å‡ è½®è¿­ä»£å®ƒå°±ä¿®å¤äº†ã€‚ç„¶åæˆ‘å‘Šè¯‰å®ƒè®©å®ƒé€šè¿‡Claude Codeä½¿ç”¨SpecKitçš„å®Œæ•´æ­¥éª¤å’ŒæŠ€å·§ï¼Œæ›´æ–°åˆ°Claude Codeçš„Skillä¸­ã€‚ç´§æ¥ç€å®ƒå°±æ›´æ–°äº†è¿™ä¸ªSkillã€‚</p>
<p><strong>æ ¸å¿ƒæµç¨‹å°±æ˜¯ï¼š</strong></p>
<p>æˆ‘ä»¬æ¥æå‡ºéœ€æ±‚ â†’ è®©OpenClawæ¥æ‰§è¡Œ â†’ è§‚å¯Ÿå’Œæµ‹è¯•æ˜¯å¦ä¼šæŠ¥é”™ â†’ å¦‚æœæŠ¥é”™å°±è¿›è¡Œè°ƒè¯• â†’ æœ€åå°†æŠ¥é”™è¸©çš„è¿™äº›å‘å’Œæ€»ç»“çš„è¿™äº›ç»éªŒç¼–å†™ä¸ºSkill â†’ å°†Skillæ¨é€åˆ°GitHub â†’ å†é‡å¤æµ‹è¯•è¿™ä¸ªSkill â†’ å†è¿›è¡Œè§‚å¯Ÿå’Œè°ƒè¯• â†’ å†ä¸æ–­æ›´æ–°è¿™ä¸ªSkill â†’ å†æ¨é€å†é‡å¤æµ‹è¯•</p>
<p>é€šè¿‡è¿™ä¸ªå¾ªç¯è®©OpenClawæŒç»­è¿­ä»£å¯¹åº”çš„Skillï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªéå¸¸å®Œå–„ä¸”éå¸¸é«˜æ•ˆçš„Skillã€‚</p>
<h3 data-id="heading-8">è®©AIè®°ä½ç»éªŒï¼Œè¶Šç”¨è¶Šèªæ˜</h3>
<p>æ¯å½“OpenClawå®Œæˆä¸€ä¸ªå¤æ‚ä»»åŠ¡åï¼Œæˆ‘éƒ½ä¼šè®©å®ƒå°†å­¦ä¹ åˆ°çš„ç»éªŒå­˜å‚¨åˆ°è®°å¿†æ–‡ä»¶é‡Œï¼ŒåŒæ—¶æ›´æ–°åˆ°å¯¹åº”çš„Skillä¸­ã€‚è¿™æ ·çš„è¯ï¼š</p>
<ol>
<li>å®ƒçš„è®°å¿†åº“ä¼šä¸æ–­ç§¯ç´¯ä½¿ç”¨æŠ€å·§</li>
<li>å¯¹åº”çš„Skillä¼šä¸æ–­å®Œå–„</li>
<li>ä¸‹æ¬¡æ‰§è¡Œç±»ä¼¼ä»»åŠ¡æ—¶å°±èƒ½ç›´æ¥è¯»å–è¿™äº›ç»éªŒ</li>
</ol>
<p>å½“å¯¹åº”çš„Skillè¿­ä»£åˆ°ä¸€å®šç¨‹åº¦çš„æ—¶å€™ï¼ŒOpenClawå°±å¯ä»¥é€šè¿‡å¯¹åº”çš„Skillæ¥è½»æ¾å®Œæˆæˆ‘ä»¬äº¤ç»™å®ƒçš„ä»»åŠ¡ã€‚</p>
<h3 data-id="heading-9">æœ€ç»ˆæ•ˆæœå±•ç¤º</h3>
<p>è¿è¡Œä¹‹åæˆ‘ä»¬å°±çœ‹åˆ°äº†å®ƒè°ƒç”¨Claude Codeä½¿ç”¨OpenSpecä¸ºæˆ‘ä»¬å¼€å‘äº†è¿™ä¸ªXé£æ ¼çš„ç§äººæ—¥è®°åº”ç”¨ã€‚è€Œä¸”è¿˜è‡ªåŠ¨ç”Ÿæˆäº†ä¸€äº›æµ‹è¯•æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥éšä¾¿è¾“å…¥å†…å®¹æµ‹è¯•ï¼Œé€‰æ‹©æƒ…ç»ªæ ‡ç­¾ï¼Œç‚¹å‡»è®°å½•å°±å‘é€æˆåŠŸäº†ã€‚</p>
<p>åƒè¿™æ ·çš„è¯ï¼Œè¿™ä¸ªé¡¹ç›®å°±å®Œå…¨æ˜¯OpenClawé€šè¿‡Claude Codeè¿™ä¸ªSkillï¼Œç”¨OpenSpecè§„æ ¼é©±åŠ¨å¼€å‘æ¥å®Œæˆçš„é¡¹ç›®å¼€å‘ã€‚</p>
<hr/>
<p><strong>æ€»ç»“ä¸€ä¸‹</strong>ï¼ŒOpenClawä¸ä»…ä»…æ˜¯ä¸€ä¸ªå³æ—¶é€šè®¯æœºå™¨äººï¼Œå®ƒæ˜¯ä¸€ä¸ªèƒ½å¤Ÿï¼š</p>
<ul>
<li>è·¨å¹³å°ä½¿ç”¨ï¼ˆWhatsAppã€Telegramã€Slackã€Discordç­‰ï¼‰</li>
<li>æŒä¹…è®°å¿†å¹¶ä¸æ–­å­¦ä¹ </li>
<li>é€šè¿‡Skillç³»ç»Ÿæ— é™æ‰©å±•èƒ½åŠ›</li>
<li>å®‰å…¨å¯é åœ°æ‰§è¡Œå„ç§ä»»åŠ¡</li>
<li>è¶Šç”¨è¶Šèªæ˜çš„AIè¶…çº§åŠ©ç†</li>
</ul>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmoltbot%2Fmoltbot" target="_blank" title="https://github.com/moltbot/moltbot" ref="nofollow noopener noreferrer">github.com/moltbot/molâ€¦</a></p>
<p>å¦‚æœä½ ä¹Ÿæƒ³æ‹¥æœ‰è¿™æ ·ä¸€ä¸ªèƒ½å¤Ÿè‡ªåŠ¨è¿›åŒ–çš„AIæ™ºèƒ½ä½“ï¼Œå¼ºçƒˆæ¨èå»è¯•è¯•OpenClawã€‚</p>
<p>æœ¬æœŸåˆ†äº«å°±åˆ°è¿™é‡Œï¼Œæ¬¢è¿å¤§å®¶ç‚¹èµå…³æ³¨å’Œè½¬å‘ï¼Œè°¢è°¢å¤§å®¶è§‚çœ‹ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue-Data å±æ€§é¿å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7601169987411820582</link>    <guid>https://juejin.cn/post/7601169987411820582</guid>    <pubDate>2026-01-31T14:34:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601169987411820582" data-draft-id="7601041482892820530" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue-Data å±æ€§é¿å‘æŒ‡å—"/> <meta itemprop="keywords" content="å‰ç«¯,é¢è¯•,Vue.js"/> <meta itemprop="datePublished" content="2026-01-31T14:34:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‘ç°ä¸€åªå¤§å‘†ç“œ"/> <meta itemprop="url" content="https://juejin.cn/user/180747382561607"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue-Data å±æ€§é¿å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/180747382561607/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‘ç°ä¸€åªå¤§å‘†ç“œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T14:34:12.000Z" title="Sat Jan 31 2026 14:34:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨ Vue å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°â€œæ˜æ˜ä¿®æ”¹äº†æ•°æ®ï¼Œè§†å›¾å´ä¸æ›´æ–°â€çš„å°´å°¬åœºæ™¯ã€‚è¿™é€šå¸¸ä¸ Vue çš„åˆå§‹åŒ–é¡ºåºåŠå“åº”å¼å®ç°åŸç†æœ‰å…³ã€‚æœ¬æ–‡å°†ä» Data å±æ€§çš„æœ¬è´¨å‡ºå‘ï¼Œè§£æå“åº”å¼â€œä¸¢å¤±â€çš„æ ¹æœ¬åŸå› åŠè§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-1">ä¸€ã€ ç»„ä»¶ä¸­çš„ Data ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯å‡½æ•°ï¼Ÿ</h2>
<p>åœ¨ Vue 2 ä¸­ï¼Œæ ¹å®ä¾‹çš„ <code>data</code> å¯ä»¥æ˜¯å¯¹è±¡ï¼Œä½†<strong>ç»„ä»¶ä¸­çš„ <code>data</code> å¿…é¡»æ˜¯å‡½æ•°</strong>ã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒåŸå› ï¼šæ•°æ®éš”ç¦»</h3>
<ul>
<li><strong>å¯¹è±¡å½¢å¼</strong>ï¼šJavaScript ä¸­çš„å¯¹è±¡æ˜¯å¼•ç”¨ç±»å‹ã€‚å¦‚æœ <code>data</code> æ˜¯å¯¹è±¡ï¼Œæ‰€æœ‰ç»„ä»¶å®ä¾‹å°†å…±äº«åŒä¸€ä¸ªå†…å­˜åœ°å€ã€‚ä¿®æ”¹å®ä¾‹ A çš„æ•°æ®ï¼Œå®ä¾‹ B ä¹Ÿä¼šè·Ÿç€å˜ã€‚</li>
<li><strong>å‡½æ•°å½¢å¼</strong>ï¼šå½“ <code>data</code> æ˜¯ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæ¯æ¬¡åˆ›å»ºæ–°å®ä¾‹ï¼ŒVue éƒ½ä¼šè°ƒç”¨è¯¥å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª<strong>å…¨æ–°çš„æ•°æ®å¯¹è±¡æ‹·è´</strong>ã€‚è¿™ä¿è¯äº†æ¯ä¸ªç»„ä»¶å®ä¾‹æ•°æ®çš„ç‹¬ç«‹æ€§ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">äºŒã€ Props ä¸ Data çš„ä¼˜å…ˆçº§ä¹‹äº‰</h2>
<p>åœ¨ç»„ä»¶åˆå§‹åŒ–æ—¶ï¼ŒVue ä¼šæŒ‰ç…§ç‰¹å®šçš„é¡ºåºå¤„ç†é€‰é¡¹ã€‚</p>
<h3 data-id="heading-4">åˆå§‹åŒ–é¡ºåº</h3>
<blockquote>
<p><strong>Props</strong> â†’ <strong>Methods</strong> â†’ <strong>Data</strong> â†’ <strong>Computed</strong> â†’ <strong>Watch</strong></p>
</blockquote>
<p>å› ä¸º <code>Props</code> æœ€å…ˆè¢«åˆå§‹åŒ–ï¼Œ<strong>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ <code>data</code> ä¸­ç›´æ¥å¼•ç”¨ <code>props</code> ä¼ æ¥çš„å€¼</strong>ï¼š</p>
<pre><code class="hljs language-TypeScript" lang="TypeScript"><span class="hljs-comment">// Vue 3 + TS ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> props = defineProps&lt;{ <span class="hljs-attr">initialCount</span>: <span class="hljs-built_in">number</span> }&gt;();
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(props.<span class="hljs-property">initialCount</span>); <span class="hljs-comment">// åˆæ³•ï¼Œå› ä¸º props ä¼˜å…ˆåˆå§‹åŒ–</span>
</code></pre>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ Vue2åŠ¨æ€æ·»åŠ æ–°å±æ€§çš„â€œå¤±æ•ˆâ€å›°å±€</h2>
<h3 data-id="heading-6">1. æ•…éšœåœºæ™¯</h3>
<p>vue2ä¸­å½“æˆ‘ä»¬ç›´æ¥ç»™å¯¹è±¡æ·»åŠ ä¸€ä¸ªåŸæœ¬ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œè§†å›¾ä¸ä¼šäº§ç”Ÿä»»ä½•å˜åŒ–ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;p v-for="(value,key)in item" :key="key"&gt;
    {{ value }}
&lt;/p&gt;
&lt;button@click="addProperty"&gt;åŠ¨æ€æ·»åŠ æ–°å±æ€§&lt;/button&gt;

const app = new Vue({
  el: '#app',
  data: {
    item: {
      oldProperty: 'læ—¥å±æ€§'
    }
  },
  methods: {
    addProperty() {
      this.items.newProperty = 'æ–°å±æ€§'; // ä¸ºitemsæ·»åŠ æ–°å±æ€§
      console.log(this.items); // è¾“å‡ºå¸¦æœ‰newPropertyçš„items
    }
  }
})
</code></pre>
<h3 data-id="heading-7">2. åŸå› å‰–æ</h3>
<ul>
<li><strong>Vue 2 å±€é™æ€§</strong>ï¼šä½¿ç”¨ <code>Object.defineProperty</code> å®ç°å“åº”å¼ã€‚å®ƒåªèƒ½åŠ«æŒå¯¹è±¡<strong>å·²æœ‰çš„</strong>å±æ€§ã€‚å¯¹äºåæ¥æ–°å¢çš„å±æ€§ï¼ŒVue æ— æ³•æ„ŸçŸ¥å…¶ <code>getter/setter</code>ï¼Œå› æ­¤æ— æ³•è§¦å‘è§†å›¾æ›´æ–°ã€‚</li>
<li><strong>Vue 3 çš„è¿›åŒ–</strong>ï¼šæ”¹ç”¨ <code>Proxy</code> ä»£ç†æ•´ä¸ªå¯¹è±¡ã€‚<code>Proxy</code> å¯ä»¥æ‹¦æˆªåˆ°å±æ€§çš„æ–°å¢ä¸åˆ é™¤ï¼Œå› æ­¤ Vue 3 ä¸å†æœ‰è¿™ä¸ªé—®é¢˜ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-8">å››ã€ è§£å†³æ–¹æ¡ˆï¼ˆVue 2 å¿…å¤‡æŠ€å·§ï¼‰</h2>
<p>å¦‚æœä½ ä»åœ¨ä½¿ç”¨ Vue 2ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼è§£å†³ï¼š</p>
<h3 data-id="heading-9">1. æ¨èæ–¹æ¡ˆï¼š<code>Vue.set</code> / <code>this.$set</code></h3>
<p>è¿™æ˜¯æœ€æ­£ç»Ÿçš„æ–¹æ³•ï¼Œå®ƒä¼šæ‰‹åŠ¨å°†æ–°å±æ€§è½¬ä¸ºå“åº”å¼ï¼Œå¹¶è§¦å‘ä¾èµ–æ›´æ–°ã€‚</p>
<blockquote>
<p><strong>è¯­æ³•ï¼š</strong> <code>this.$set(target, propertyName/index, value)</code></p>
</blockquote>
<ul>
<li><code>target</code>ï¼šdataä¸­è¦ä¿®æ”¹çš„å¯¹è±¡æˆ–è€…æ•°ç»„</li>
<li><code>propertyName/index</code>ï¼šè¦æ·»åŠ æˆ–ä¿®æ”¹çš„å±æ€§åç§°ï¼ˆå¯¹äºå¯¹è±¡ï¼‰æˆ–ç´¢å¼•ï¼ˆå¯¹äºæ•°ç»„ï¼‰</li>
<li><code>value</code>ï¼šè¦è®¾ç½®çš„å€¼</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">addProperty</span>(<span class="hljs-params"/>) {
   <span class="hljs-variable language_">this</span>.$set(<span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>, <span class="hljs-string">'newProperty'</span>, <span class="hljs-string">'æ–°å±æ€§'</span>); 
}
</code></pre>
<h3 data-id="heading-10">2. å¯¹è±¡æ•´ä½“æ›¿æ¢ï¼š<code>Object.assign</code></h3>
<p>é€šè¿‡åˆ›å»ºä¸€ä¸ªåŒ…å«æ–°å±æ€§çš„æ–°å¯¹è±¡ï¼Œå¹¶å°†è¿™ä¸ªæ–°å¯¹è±¡èµ‹å€¼ç»™åŸæœ‰å¯¹è±¡,è§¦å‘ Vue å¯¹åŸå¯¹è±¡å¼•ç”¨çš„å˜æ›´æ„ŸçŸ¥ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">addProperty</span>(<span class="hljs-params"/>) {
   <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>({}, <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>, { <span class="hljs-attr">newProperty</span>: <span class="hljs-string">'æ–°å±æ€§'</span> });
   <span class="hljs-comment">// æˆ–è€…ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦</span>
   <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>, <span class="hljs-attr">newProperty</span>: <span class="hljs-string">'æ–°å±æ€§'</span> };
}
</code></pre>
<h3 data-id="heading-11">3. æš´åŠ›æ–¹æ¡ˆï¼š<code>$forceUpdate</code></h3>
<p>è¿«ä½¿ Vue é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚</p>
<ul>
<li><strong>æ³¨æ„</strong>ï¼šè¿™åªæ˜¯â€œæ²»æ ‡â€ã€‚è™½ç„¶è§†å›¾åˆ·æ–°äº†ï¼Œä½†è¯¥å±æ€§<strong>ä¾ç„¶ä¸æ˜¯å“åº”å¼çš„</strong>ã€‚åç»­å†æ¬¡ä¿®æ”¹ <code>newProperty</code> æ—¶ï¼Œè§†å›¾ä¾ç„¶ä¸ä¼šåŠ¨ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-12">äº”ã€ Vue 3 + TS æœ€ä½³å®è·µ</h2>
<p>åœ¨ Vue 3 ä¸­ï¼Œå€ŸåŠ© TypeScript çš„ç±»å‹å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥è§„é¿å¤§éƒ¨åˆ†å› â€œåŠ¨æ€æ·»åŠ â€å¯¼è‡´çš„é€»è¾‘æ··ä¹±ã€‚</p>
<pre><code class="hljs language-vue" lang="vue">&lt;script setup lang="ts"&gt;
import { reactive } from 'vue';

// å®šä¹‰æ¥å£ï¼Œæå‰å£°æ˜å¯é€‰å±æ€§
interface Item {
  oldProperty: string;
  newProperty?: string; // å£°æ˜å¯é€‰å±æ€§
}

const item = reactive&lt;Item&gt;({
  oldProperty: 'æ—§å±æ€§'
});

const addProperty = () =&gt; {
  // Vue 3 Proxy è‡ªåŠ¨å¤„ç†å“åº”å¼ï¼Œæ— éœ€ $set
  item.newProperty = 'æ–°å±æ€§'; 
};
&lt;/script&gt;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JSyncQueueâ€”â€”ä¸€ä¸ªå¼€ç®±å³ç”¨çš„é¸¿è’™å¼‚æ­¥ä»»åŠ¡åŒæ­¥é˜Ÿåˆ—]]></title>    <link>https://juejin.cn/post/7601073900525223978</link>    <guid>https://juejin.cn/post/7601073900525223978</guid>    <pubDate>2026-01-31T14:55:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601073900525223978" data-draft-id="7601076694104375332" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JSyncQueueâ€”â€”ä¸€ä¸ªå¼€ç®±å³ç”¨çš„é¸¿è’™å¼‚æ­¥ä»»åŠ¡åŒæ­¥é˜Ÿåˆ—"/> <meta itemprop="keywords" content="HarmonyOS,TypeScript,Android"/> <meta itemprop="datePublished" content="2026-01-31T14:55:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ±Ÿæ¾æ¶Œ"/> <meta itemprop="url" content="https://juejin.cn/user/1820446986338504"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JSyncQueueâ€”â€”ä¸€ä¸ªå¼€ç®±å³ç”¨çš„é¸¿è’™å¼‚æ­¥ä»»åŠ¡åŒæ­¥é˜Ÿåˆ—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1820446986338504/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ±Ÿæ¾æ¶Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T14:55:40.000Z" title="Sat Jan 31 2026 14:55:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é›¶ã€JSyncQueue</h2>
<p>JSyncQueue æ˜¯ä¸€ä¸ªå¼€ç®±å³ç”¨çš„é¸¿è’™å¼‚æ­¥ä»»åŠ¡åŒæ­¥é˜Ÿåˆ—ã€‚</p>
<p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FzincPower%2FJSyncQueue" target="_blank" title="https://github.com/zincPower/JSyncQueue" ref="nofollow noopener noreferrer">github.com/zincPower/Jâ€¦</a></p>
<h2 data-id="heading-1">ä¸€ã€JSyncQueue æœ‰ä»€ä¹ˆä½œç”¨</h2>
<p>åœ¨é¸¿è’™åº”ç”¨å¼€å‘ä¸­ï¼Œæœ‰æ—¶éœ€è¦è®©å¤šä¸ªå¼‚æ­¥ä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œï¼Œä¾‹å¦‚çŠ¶æ€çš„è½¬æ¢å¤„ç†ï¼Œå¦‚æœä¸åŠ æ§åˆ¶ï¼Œä¼šå› ä¸ºæ‰§è¡Œé¡ºåºæ··ä¹±è€Œäº§ç”Ÿä¸€äº›è«åå…¶å¦™çš„é—®é¢˜ã€‚ æ‰€ä»¥ <code>JSyncQueue</code> æä¾›äº†ä¸€ä¸ªç®€æ´çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li><strong>ä¿è¯é¡ºåºæ‰§è¡Œ</strong>ï¼šæ‰€æœ‰ä»»åŠ¡ä¸¥æ ¼æŒ‰ç…§å…¥é˜Ÿé¡ºåºæ‰§è¡Œï¼Œå³ä½¿ä»»åŠ¡å†…éƒ¨æœ‰å¼‚æ­¥æ“ä½œä¹Ÿèƒ½ä¿è¯é¡ºåº</li>
<li><strong>ä¸¤ç§æ‰§è¡Œæ¨¡å¼</strong>ï¼šæ”¯æŒ "ç«‹å³æ‰§è¡Œ" å’Œ "å»¶æ—¶æ‰§è¡Œ" ä¸¤ç§æ¨¡å¼ï¼Œå¯ä»¥æ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚</li>
<li><strong>ä¸¤ç§ä»»åŠ¡ç±»å‹</strong>ï¼šæ”¯æŒå‘åŒæ­¥é˜Ÿåˆ—æ·»åŠ  "Message ç±»å‹ä»»åŠ¡" å’Œ "Runnable ç±»å‹ä»»åŠ¡"</li>
<li><strong>ä»»åŠ¡å–æ¶ˆå’Œç®¡ç†</strong>ï¼šå¯éšæ—¶å–æ¶ˆæŒ‡å®šä»»åŠ¡æˆ–æ¸…ç©ºæ•´ä¸ªé˜Ÿåˆ—</li>
<li><strong>è·å–ä»»åŠ¡ç»“æœ</strong>ï¼šé€šè¿‡ä»»åŠ¡çš„ <code>getResult()</code> è·å–æ‰§è¡Œç»“æœ</li>
</ul>
<p>é¡¹ç›®æ¶æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a4fcd88072de4f9da8ff3d1c7fcd252f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5rGf5r6O5raM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770476139&amp;x-signature=P4ubIEk%2Fg3o%2BgFBgiyrcXeg8rBU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">äºŒã€å¦‚ä½•å®‰è£… JSyncQueue</h2>
<p><strong>ç¬¬ä¸€ç§æ–¹å¼ï¼š</strong> åœ¨éœ€è¦ä½¿ç”¨ <code>JSyncQueue</code> çš„æ¨¡å—ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤</p>
<pre><code class="hljs language-bash" lang="bash">ohpm install jsyncqueue
</code></pre>
<p><strong>ç¬¬äºŒç§æ–¹å¼ï¼š</strong> åœ¨éœ€è¦ä½¿ç”¨ <code>JSyncQueue</code> çš„æ¨¡å— <code>oh-package.json5</code> ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"sample"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Please describe the basic information."</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"author"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"license"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"dependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"jsyncqueue"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.0"</span> <span class="hljs-comment">// æ·»åŠ è¿™ä¸€è¡Œï¼Œè¯·æ ¹æ®éœ€è¦ä¿®æ”¹ç‰ˆæœ¬å·</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-3">ä¸‰ã€JSyncQueue API ä»‹ç»</h2>
<h3 data-id="heading-4">3-1ã€JSyncQueue ç±»</h3>
<h4 data-id="heading-5">æ„é€ å‡½æ•°</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title function_">constructor</span>(<span class="hljs-params">queueName: <span class="hljs-built_in">string</span></span>)
</code></pre>
<p>åˆ›å»ºä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—å®ä¾‹ã€‚</p>
<ul>
<li><code>queueName</code>: é˜Ÿåˆ—åç§°ï¼Œç”¨äºæ ‡è¯†å’Œè°ƒè¯•</li>
</ul>
<h4 data-id="heading-6">æ–¹æ³•</h4>



























































<table><thead><tr><th>æ–¹æ³•</th><th>å‚æ•°</th><th>è¿”å›å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>post(runnable)</code></td><td><code>runnable: (taskId: number) =&gt; Promise&lt;Any&gt;</code></td><td><code>Task</code></td><td>ç«‹å³æ‰§è¡Œé—­åŒ…</td></tr><tr><td><code>postDelay(runnable, delay)</code></td><td><code>runnable: (taskId: number) =&gt; Promise&lt;Any&gt;</code>, <code>delay: number</code></td><td><code>Task</code></td><td>å»¶æ—¶ delay æ¯«ç§’æ‰§è¡Œé—­åŒ…</td></tr><tr><td><code>sendMessage(message)</code></td><td><code>message: Message</code></td><td><code>Task</code></td><td>ç«‹å³å‘é€æ¶ˆæ¯</td></tr><tr><td><code>sendMessageDelay(message, delay)</code></td><td><code>message: Message</code>, <code>delay: number</code></td><td><code>Task</code></td><td>å»¶æ—¶ delay æ¯«ç§’å‘é€æ¶ˆæ¯</td></tr><tr><td><code>cancel(taskId)</code></td><td><code>taskId: number</code></td><td><code>void</code></td><td>å–æ¶ˆæŒ‡å®šä»»åŠ¡</td></tr><tr><td><code>clear()</code></td><td>-</td><td><code>void</code></td><td>æ¸…ç©ºé˜Ÿåˆ—ä¸­æ‰€æœ‰ç­‰å¾…çš„ä»»åŠ¡</td></tr><tr><td><code>dumpInfo()</code></td><td>-</td><td><code>string</code></td><td>è·å–é˜Ÿåˆ—è°ƒè¯•ä¿¡æ¯</td></tr><tr><td><code>onHandleMessage(message, taskId)</code></td><td><code>message: Message</code>, <code>taskId: number</code></td><td><code>Promise&lt;Any&gt;</code></td><td>æ¶ˆæ¯å¤„ç†æ–¹æ³•ï¼Œå­ç±»å¯é‡å†™</td></tr></tbody></table>
<h4 data-id="heading-7">å±æ€§</h4>




















<table><thead><tr><th>å±æ€§</th><th>ç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>queueName</code></td><td><code>string</code></td><td>é˜Ÿåˆ—åç§°ï¼ˆåªè¯»ï¼‰</td></tr><tr><td><code>length</code></td><td><code>number</code></td><td>å½“å‰é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ•°é‡ï¼ˆåªè¯»ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-8">3-2ã€Message æ¥å£</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Message</span> {
  <span class="hljs-attr">what</span>: <span class="hljs-built_in">string</span>   <span class="hljs-comment">// æ¶ˆæ¯ç±»å‹</span>
  <span class="hljs-attr">data</span>: <span class="hljs-title class_">Any</span>      <span class="hljs-comment">// æ¶ˆæ¯æ•°æ®</span>
}
</code></pre>
<h3 data-id="heading-9">3-3ã€Task æ¥å£</h3>
<p>æ‰€æœ‰æ·»åŠ çš„ä»»åŠ¡ï¼ŒåŒ…æ‹¬â€œMessage ç±»å‹ä»»åŠ¡â€å’Œâ€œRunnable ç±»å‹ä»»åŠ¡â€ï¼Œå‡ä¼šè¿”å›è¯¥ç±»å‹å®ä¾‹ï¼Œé€šè¿‡è¯¥å®ä¾‹å¯ä»¥â€œå–æ¶ˆä»»åŠ¡â€ã€â€œè·å–ä»»åŠ¡ç»“æœâ€ã€â€œä»»åŠ¡ Idâ€ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Task</span> {
  <span class="hljs-title function_">cancel</span>(): <span class="hljs-built_in">void</span>                  <span class="hljs-comment">// å–æ¶ˆä»»åŠ¡</span>
  <span class="hljs-title function_">getResult</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt;       <span class="hljs-comment">// è·å–ä»»åŠ¡ç»“æœ</span>
  <span class="hljs-title function_">getTaskId</span>(): <span class="hljs-built_in">number</span>             <span class="hljs-comment">// è·å–ä»»åŠ¡ ID</span>
}
</code></pre>
<h3 data-id="heading-10">3-4ã€å¼‚å¸¸ç±»å‹</h3>
<h4 data-id="heading-11">JSyncQueueCancelException</h4>
<p>å½“ä»»åŠ¡è¢«å–æ¶ˆæ—¶ï¼Œä¼šæŠ›å‡ºè¯¥ç±»å‹çš„å¼‚å¸¸ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">JSyncQueueCancelException</span> {
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>
}
</code></pre>
<h4 data-id="heading-12">JSyncQueueException</h4>
<p>å½“ JSyncQueue å†…éƒ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¼šæŠ›å‡ºè¯¥ç±»å‹çš„å¼‚å¸¸ã€‚</p>
<blockquote>
<p>å€¼å¾—æ³¨æ„ï¼šä½¿ç”¨è€…ç¼–å†™çš„é€»è¾‘ä¸­æŠ›å‡ºçš„å¼‚å¸¸ä¼šåŸå°ä¸åŠ¨çš„æŠ›åˆ° <code>Task.getResult().catch</code> ä¸­ï¼Œè€Œ<strong>ä¸æ˜¯ä»¥ <code>JSyncQueueException</code> ç±»å‹æŠ›å‡º</strong>ã€‚</p>
</blockquote>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">JSyncQueueException</span> {
  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>
}
</code></pre>
<h2 data-id="heading-13">å››ã€å¦‚ä½•ä½¿ç”¨ JSyncQueue</h2>
<h3 data-id="heading-14">4-1ã€ä½¿ç”¨ JSyncQueue åˆ›å»ºåŒæ­¥é˜Ÿåˆ—</h3>
<p>å¦‚æœä½ å¤„ç†çš„åœºæ™¯<strong>å‡æ˜¯ç®€å•çš„ä¸€æ¬¡æ€§ä»»åŠ¡</strong>ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨ <code>JSyncQueue</code> åˆ›å»ºä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—ï¼Œå¹¶å‹å…¥ <code>Runnable</code> é—­åŒ…å³å¯ã€‚</p>
<p>ä»¥ä¸‹ä»£ç å±•ç¤ºçš„é€»è¾‘ç»†èŠ‚ï¼š</p>
<ul>
<li>ä»£ç ä¸­ä½¿ç”¨äº† delay å‡½æ•°æ¨¡æ‹Ÿäº†ä¸¤æ¬¡è€—æ—¶æ“ä½œï¼Œå¹¶ä¸”è¿”å›ç»“æœ</li>
<li>å¤–éƒ¨é€šè¿‡ <code>Task</code> ç±»å‹å®ä¾‹æ¥æ”¶è¿”å›ç»“æœï¼Œå¹¶ä¸”æ‰“å°</li>
<li>åœ¨ç¬¬å››æ¬¡å¾ªç¯ï¼ˆå³ i ä¸º 3ï¼‰çš„æ—¶å€™ï¼Œä¼šæ¨¡æ‹ŸæŠ›å‡ºå¼‚å¸¸ï¼Œå¼‚å¸¸å†…å®¹ä¼šåŸå°ä¸åŠ¨çš„æŠ›åˆ° <code>catch</code> ä¸­</li>
</ul>
<p><strong>å€¼å¾—æ³¨æ„ï¼š</strong></p>
<ul>
<li><strong>ç«‹å³æ‰§è¡Œä»»åŠ¡ä¼šä¸¥æ ¼æŒ‰å…¥é˜Ÿé¡ºåºæ‰§è¡Œ</strong></li>
<li>ä»»åŠ¡ç»“æœçš„æ¥æ”¶å¤„ç†ï¼ˆå³å¯¹ <code>Task.getResult()</code> çš„å¤„ç†ï¼‰å’Œ <code>JSyncQueue</code> å¯¹ä»»åŠ¡çš„å¤„ç†æ˜¯<strong>ä¸ä¿è¯é¡ºåº</strong>çš„ï¼Œå› ä¸º <code>Task.getResult()</code> çš„å¤„ç†å·²ä¸åœ¨é˜Ÿåˆ—èŒƒå›´å†…</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-attr">immediatelyJSyncQueue</span>: <span class="hljs-title class_">JSyncQueue</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSyncQueue</span>(<span class="hljs-string">"ImmediatelyJSyncQueue"</span>)
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
  <span class="hljs-keyword">const</span> task = <span class="hljs-variable language_">this</span>.<span class="hljs-property">immediatelyJSyncQueue</span>.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> delayTime1 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime1}</span>`</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime1)

    <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span>) {
      <span class="hljs-keyword">throw</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">"æ¨¡æ‹Ÿå¼‚å¸¸"</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>
    }

    <span class="hljs-keyword">const</span> delayTime2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime2}</span>`</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime2)

    <span class="hljs-keyword">return</span> <span class="hljs-string">`jiangpengyong-æ·»åŠ 5ä¸ªRunnable <span class="hljs-subst">${i}</span>`</span>
  })
  task.<span class="hljs-title function_">getResult</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡ŒæˆåŠŸã€‘i=<span class="hljs-subst">${i}</span> result=<span class="hljs-subst">${result}</span>`</span>)
    })
    .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">e: <span class="hljs-built_in">Error</span></span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">e</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡Œå¼‚å¸¸ã€‘i=<span class="hljs-subst">${i}</span> e=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e)}</span>`</span>)
    })
    .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡Œç»“æŸã€‘i=<span class="hljs-subst">${i}</span>`</span>)
    })
}

<span class="hljs-comment">// ========================================= è¾“å‡ºæ—¥å¿— =========================================</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=239</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=315</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=1 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=379</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡ŒæˆåŠŸã€‘i=0 result=jiangpengyong-æ·»åŠ 5ä¸ªRunnable 0</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡Œç»“æŸã€‘i=0</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=1 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=391</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=2 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=499</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡ŒæˆåŠŸã€‘i=1 result=jiangpengyong-æ·»åŠ 5ä¸ªRunnable 1</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡Œç»“æŸã€‘i=1</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=2 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=395</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=3 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=478</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡ŒæˆåŠŸã€‘i=2 result=jiangpengyong-æ·»åŠ 5ä¸ªRunnable 2</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡Œç»“æŸã€‘i=2</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=4 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=166</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡Œå¼‚å¸¸ã€‘i=3 e={"message":"æ¨¡æ‹Ÿå¼‚å¸¸"}</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡Œç»“æŸã€‘i=3</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=4 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=33</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡ŒæˆåŠŸã€‘i=4 result=jiangpengyong-æ·»åŠ 5ä¸ªRunnable 4</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnable-æ‰§è¡Œç»“æŸã€‘i=4</span>
</code></pre>
<p><strong>å–æ¶ˆåŒæ­¥ä»»åŠ¡</strong></p>
<p>é€šè¿‡è¿”å›çš„ <code>Task</code> ç±»å‹å®ä¾‹è°ƒç”¨ <code>cancel</code> æ–¹æ³•å¯ä»¥è¿›è¡Œå–æ¶ˆä»»åŠ¡ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç ä¼šå–æ¶ˆç¬¬å››æ¬¡ä»»åŠ¡ï¼Œæ‰€ä»¥åœ¨æ—¥å¿—ä¸­ä¼šçœ‹åˆ°å¯¹åº”çš„å–æ¶ˆå¼‚å¸¸ï¼Œå¹¶ä¸”ä¸ä¼šæ‰§è¡Œè¯¥ä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">task</span>: <span class="hljs-title class_">Task</span> | <span class="hljs-literal">undefined</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
  <span class="hljs-keyword">const</span> tempTask = <span class="hljs-variable language_">this</span>.<span class="hljs-property">immediatelyJSyncQueue</span>.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> delayTime1 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime1}</span>`</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime1)

    <span class="hljs-keyword">const</span> delayTime2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime2}</span>`</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime2)

    <span class="hljs-keyword">if</span> (i == <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">throw</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">"æ¨¡æ‹Ÿå¼‚å¸¸"</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">`jiangpengyong-ç§»é™¤Runnable <span class="hljs-subst">${i}</span>`</span>
  })
  tempTask.<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Runnableã€‘æ‰§è¡ŒæˆåŠŸ i=<span class="hljs-subst">${i}</span> result=<span class="hljs-subst">${result}</span>`</span>)
  }).<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">e: Any</span>) =&gt;</span> {
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">e</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå¼‚å¸¸ i=<span class="hljs-subst">${i}</span> e=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e)}</span>`</span>)
  }).<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå®Œæˆ i=<span class="hljs-subst">${i}</span>`</span>)
  })
  <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span>) {
    task = tempTask
  }
}
<span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Runnableã€‘å–æ¶ˆä»»åŠ¡ task=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(task)}</span>`</span>)
task?.<span class="hljs-title function_">cancel</span>()

<span class="hljs-comment">// ========================================= è¾“å‡ºæ—¥å¿— =========================================</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=263</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘å–æ¶ˆä»»åŠ¡ task={"taskId":13,"queue":{},"promise":{}}</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå¼‚å¸¸ i=3 e={"message":"Cancel task by cancel function."}</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå®Œæˆ i=3</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=474</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=1 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=318</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡ŒæˆåŠŸ i=0 result=jiangpengyong-ç§»é™¤Runnable 0</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå®Œæˆ i=0</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=1 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=6</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=2 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=406</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡ŒæˆåŠŸ i=1 result=jiangpengyong-ç§»é™¤Runnable 1</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå®Œæˆ i=1</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=2 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=212</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=4 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=226</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå¼‚å¸¸ i=2 e={"message":"æ¨¡æ‹Ÿå¼‚å¸¸"}</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå®Œæˆ i=2</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œé€»è¾‘ i=4 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=439</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡ŒæˆåŠŸ i=4 result=jiangpengyong-ç§»é™¤Runnable 4</span>
<span class="hljs-comment">// ã€ç§»é™¤Runnableã€‘æ‰§è¡Œå®Œæˆ i=4</span>
</code></pre>
<p><strong>å»¶æ—¶æ‰§è¡Œ Runnable ç±»å‹ä»»åŠ¡</strong></p>
<p>æ·»åŠ å»¶æ—¶ä»»åŠ¡åªéœ€æ”¹ç”¨ <code>postDelay</code> æ–¹æ³•å¹¶ä¼ å…¥å»¶æ—¶å‚æ•°</p>
<ul>
<li>ä¸‹é¢ä»£ç è®°å½•äº†æ·»åŠ ä»»åŠ¡åˆ°çœŸæ­£æ‰§è¡Œçš„å»¶æ—¶ï¼Œé€šè¿‡ <code>realDelay</code> å‚æ•°å¯ä»¥æŸ¥çœ‹</li>
<li>ä½¿ç”¨äº† <code>delay</code> å‡½æ•°æ¨¡æ‹Ÿäº†ä¸¤æ¬¡è€—æ—¶æ“ä½œï¼Œå¹¶æ¨¡æ‹Ÿè¿”å›äº†å¤„ç†ç»“æœ</li>
<li>ç¬¬å››æ¬¡ä»»åŠ¡æŠ›å‡ºäº†å¼‚å¸¸ï¼Œå¼‚å¸¸æ¶ˆæ¯ä¼šåŸå°ä¸åŠ¨çš„åœ¨ <code>catch</code> çš„æ—¥å¿—å±•ç¤º</li>
<li>å› ä¸ºå»¶æ—¶ä»»åŠ¡çš„æ·»åŠ æ˜¯æŒ‰ç´¢å¼•è¿›è¡Œç´¯åŠ çš„ï¼Œæ‰€ä»¥æ·»åŠ é¡ºåºå…¶å®å¹¶æ²¡å˜åŒ–ï¼Œä»æœ€åçš„æ—¥å¿—è¾“å‡ºå¯ä»¥çœ‹åˆ°ä¿è¯äº†æ‰§è¡Œé¡ºåº</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
  <span class="hljs-keyword">const</span> startTime = systemDateTime.<span class="hljs-title function_">getTime</span>(<span class="hljs-literal">false</span>)
  <span class="hljs-keyword">const</span> delayTime = i * <span class="hljs-number">100</span>
  <span class="hljs-keyword">const</span> task = <span class="hljs-variable language_">this</span>.<span class="hljs-property">delayJSyncQueue</span>.<span class="hljs-title function_">postDelay</span>(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> endTime = systemDateTime.<span class="hljs-title function_">getTime</span>(<span class="hljs-literal">false</span>)
    <span class="hljs-keyword">const</span> realDelay = endTime - startTime
    <span class="hljs-keyword">const</span> delayTime1 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ delay=<span class="hljs-subst">${delayTime}</span> realDelay=<span class="hljs-subst">${realDelay}</span> i=<span class="hljs-subst">${i}</span> ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime1}</span>`</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime1)

    <span class="hljs-keyword">const</span> delayTime2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime2}</span>`</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime2)

    <span class="hljs-keyword">if</span> (i == <span class="hljs-number">3</span>) {
      <span class="hljs-keyword">throw</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">"æ¨¡æ‹Ÿå¼‚å¸¸"</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">`jiangpengyong-æ·»åŠ 5ä¸ªRunnable <span class="hljs-subst">${i}</span>`</span>
  }, delayTime)
  task.<span class="hljs-title function_">getResult</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡ŒæˆåŠŸ i=<span class="hljs-subst">${i}</span> result=<span class="hljs-subst">${result}</span>`</span>)
    })
    .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">e: <span class="hljs-built_in">Error</span></span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">e</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œå¼‚å¸¸ i=<span class="hljs-subst">${i}</span> e=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e)}</span>`</span>)
    })
    .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œç»“æŸ i=<span class="hljs-subst">${i}</span>`</span>)
    })
}

<span class="hljs-comment">// ========================================= è¾“å‡ºæ—¥å¿— =========================================</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ delay=0 realDelay=1 i=0 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=473</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=410</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ delay=100 realDelay=888 i=1 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=178</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡ŒæˆåŠŸ i=0 result=jiangpengyong-æ·»åŠ 5ä¸ªRunnable 0</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œç»“æŸ i=0</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=1 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=204</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ delay=200 realDelay=1272 i=2 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=410</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡ŒæˆåŠŸ i=1 result=jiangpengyong-æ·»åŠ 5ä¸ªRunnable 1</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œç»“æŸ i=1</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=2 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=36</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ delay=300 realDelay=1721 i=3 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=475</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡ŒæˆåŠŸ i=2 result=jiangpengyong-æ·»åŠ 5ä¸ªRunnable 2</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œç»“æŸ i=2</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=3 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=483</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ delay=400 realDelay=2686 i=4 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=9</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œå¼‚å¸¸ i=3 e={"message":"æ¨¡æ‹Ÿå¼‚å¸¸"}</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œç»“æŸ i=3</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œé€»è¾‘ i=4 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=395</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡ŒæˆåŠŸ i=4 result=jiangpengyong-æ·»åŠ 5ä¸ªRunnable 4</span>
<span class="hljs-comment">// ã€æ·»åŠ 5ä¸ªRunnableã€‘æ‰§è¡Œç»“æŸ i=4</span>
</code></pre>
<p><strong>å–æ¶ˆå»¶æ—¶ä»»åŠ¡</strong></p>
<p>å»¶æ—¶ä»»åŠ¡çš„å–æ¶ˆæ“ä½œå’Œç«‹å³æ‰§è¡Œçš„å–æ¶ˆæ“ä½œæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡è¿”å›çš„ <code>Task</code> å®ä¾‹è°ƒç”¨ <code>cancel</code> æ–¹æ³•ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p>
<h3 data-id="heading-15">4-2ã€ç»§æ‰¿ JSyncQueue åˆ›å»ºåŒæ­¥é˜Ÿåˆ—</h3>
<p><strong>å¦‚æœä½ çš„åŒæ­¥é€»è¾‘éœ€è¦é›†ä¸­ç®¡ç†æˆ–è¿›è¡Œå¤ç”¨ï¼Œå¯ä»¥è€ƒè™‘ <code>Message</code> ç±»å‹ä»»åŠ¡ã€‚</strong></p>
<p>å¤„ç† <code>Message</code> ç±»å‹ä»»åŠ¡ï¼Œéœ€è¦ç»§æ‰¿ <code>JSyncQueue</code> å®ç° <code>onHandleMessage</code> æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ä¼šæŒ‰å…¥é˜Ÿé¡ºåºæ¥æ”¶åˆ° <code>Message</code> ï¼š</p>
<ul>
<li>é€šè¿‡ <code>Message.what</code> å±æ€§åŒºåˆ†ä¸åŒç±»åˆ«æ¶ˆæ¯å®ç°ä¸åŒå¤„ç†é€»è¾‘</li>
<li>é€šè¿‡ <code>Message.data</code> å±æ€§å¯ä»¥è·å–å¤–éƒ¨ä¼ å…¥çš„æ•°æ®ï¼Œæ•°æ®ç±»å‹æ˜¯ <code>Any</code> å¯ä»¥æ˜¯ä»»æ„ç±»å‹æ•°æ®ï¼Œä½¿ç”¨è€…è‡ªè¡Œè½¬æ¢ä¸ºçœŸå®ç±»å‹è¿›è¡Œé€»è¾‘å¤„ç†</li>
</ul>
<p>å…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<ul>
<li>å®šä¹‰ä¸€ä¸ª <code>ImmediatelyQueue</code> ç±»ç»§æ‰¿ <code>JSyncQueue</code> ï¼Œå®ç° <code>onHandleMessage</code> æ–¹æ³•</li>
<li>åˆ›å»ºä¸€ä¸ª <code>ImmediatelyQueue</code> å®ä¾‹ï¼Œå¹¶é€šè¿‡è¿™ä¸ªå®ä¾‹è¿›è¡Œå‘é€ Message æ¶ˆæ¯ï¼ŒåŒæ­¥é˜Ÿåˆ—ä¼šæŒ‰å…¥é˜Ÿé¡ºåºä¸€ä¸ªä¸ªè¿›è¡Œåˆ†å‘ç»™è¯¥å®ä¾‹çš„ <code>onHandleMessage</code> æ–¹æ³•è¿›è¡Œå¤„ç†</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// è‡ªå®šä¹‰ JSyncQueue</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImmediatelyQueue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">JSyncQueue</span> {
  <span class="hljs-keyword">private</span> count = <span class="hljs-number">0</span>

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onHandleMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-keyword">switch</span> (message.<span class="hljs-property">what</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"say_hello"</span>: {
        <span class="hljs-keyword">const</span> name = message.<span class="hljs-property">data</span>[<span class="hljs-string">"name"</span>]
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> += <span class="hljs-number">1</span>

        <span class="hljs-keyword">const</span> delayTime1 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
        <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-string">"ImmediatelyQueue"</span>, <span class="hljs-string">`ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime1}</span>`</span>)
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime1)

        <span class="hljs-keyword">const</span> delayTime2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
        <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-string">"ImmediatelyQueue"</span>, <span class="hljs-string">`ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime2}</span>`</span>)
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime2)

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> % <span class="hljs-number">10</span> == <span class="hljs-number">5</span>) {
          <span class="hljs-keyword">throw</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">"æ¨¡æ‹Ÿå¼‚å¸¸"</span> }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">`ä½ å¥½ï¼Œ<span class="hljs-subst">${name}</span>ã€‚è¿™æ˜¯ç¬¬<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>æ¬¡æ‰“æ‹›å‘¼ã€‚`</span>
      }
      <span class="hljs-comment">// ... å…¶ä»– what å¤„ç†é€»è¾‘</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">ms: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt;(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms))
  }
}

<span class="hljs-comment">// ä½¿ç”¨é€»è¾‘</span>
<span class="hljs-attr">immediatelyQueue</span>: <span class="hljs-title class_">JSyncQueue</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmediatelyQueue</span>(<span class="hljs-string">"ImmediatelyQueue"</span>)
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
  <span class="hljs-keyword">const</span> tempTask = <span class="hljs-variable language_">this</span>.<span class="hljs-property">immediatelyQueue</span>.<span class="hljs-title function_">sendMessage</span>({
    <span class="hljs-attr">what</span>: <span class="hljs-string">`say_hello`</span>,
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'æ±Ÿæ¾æ¶Œ'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> + i },
  })
  tempTask.<span class="hljs-title function_">getResult</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªMessageã€‘æ‰§è¡ŒæˆåŠŸ i=<span class="hljs-subst">${i}</span> result=<span class="hljs-subst">${result}</span>`</span>)
    })
    .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">e: <span class="hljs-built_in">Error</span></span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">e</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªMessageã€‘æ‰§è¡Œå¼‚å¸¸ i=<span class="hljs-subst">${i}</span> e=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e)}</span>`</span>)
    })
    .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªMessageã€‘æ‰§è¡Œç»“æŸi=<span class="hljs-subst">${i}</span>`</span>)
    })
}
<span class="hljs-comment">// ========================================= è¾“å‡ºæ—¥å¿— =========================================</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":20}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=92</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=143</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":21}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=276</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=377</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":22}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=120</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=223</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":23}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=424</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=444</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":24}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=181</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=402</span>
</code></pre>
<p><strong>ç§»é™¤ Message æ¶ˆæ¯</strong></p>
<p>ä½¿ç”¨ <code>sendMessage</code> æ–¹æ³•å‹å…¥ â€œMessage ç±»å‹ä»»åŠ¡â€ åŒæ ·ä¼šè¿”å› <code>Task</code> ç±»å‹å®ä¾‹ï¼Œè°ƒç”¨è¯¥å®ä¾‹çš„ <code>cancel</code> æ–¹æ³•å°±å¯ä»¥å–æ¶ˆè¯¥ä»»åŠ¡ã€‚</p>
<p>ä¸‹åˆ—ä»£ç ä¼šå–æ¶ˆç¬¬äºŒä¸ªä»»åŠ¡ï¼Œæ‰€ä»¥ä¸ä¼šçœ‹åˆ° <code>"age":11</code> çš„æ¶ˆæ¯ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">let</span> <span class="hljs-attr">task</span>: <span class="hljs-title class_">Task</span> | <span class="hljs-literal">undefined</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
  <span class="hljs-keyword">const</span> tempTask = <span class="hljs-variable language_">this</span>.<span class="hljs-property">immediatelyQueue</span>.<span class="hljs-title function_">sendMessage</span>({
    <span class="hljs-attr">what</span>: <span class="hljs-string">`remove_message`</span>,
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'jiang peng yong'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">10</span> + i },
  })
  tempTask.<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Messageã€‘æ‰§è¡ŒæˆåŠŸ i=<span class="hljs-subst">${i}</span> result=<span class="hljs-subst">${result}</span>`</span>)
  }).<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">e: Any</span>) =&gt;</span> {
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">e</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Messageã€‘æ‰§è¡Œå¼‚å¸¸ i=<span class="hljs-subst">${i}</span> e=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e)}</span>`</span>)
  }).<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Messageã€‘æ‰§è¡Œå®Œæˆ i=<span class="hljs-subst">${i}</span>`</span>)
  })
  <span class="hljs-keyword">if</span> (i == <span class="hljs-number">1</span>) {
    task = tempTask
  }
}
<span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€ç§»é™¤Messageã€‘å–æ¶ˆä»»åŠ¡ task=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(task)}</span>`</span>)
task?.<span class="hljs-title function_">cancel</span>()
<span class="hljs-comment">// ========================================= è¾“å‡ºæ—¥å¿— =========================================</span>
<span class="hljs-comment">// onHandleMessage message={"what":"remove_message","data":{"name":"jiang peng yong","age":10}}</span>
<span class="hljs-comment">// ã€remove_messageã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=497</span>
<span class="hljs-comment">// ã€remove_messageã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=397</span>
<span class="hljs-comment">// onHandleMessage message={"what":"remove_message","data":{"name":"jiang peng yong","age":12}}</span>
<span class="hljs-comment">// ã€remove_messageã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=162</span>
<span class="hljs-comment">// ã€remove_messageã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=283</span>
<span class="hljs-comment">// onHandleMessage message={"what":"remove_message","data":{"name":"jiang peng yong","age":13}}</span>
<span class="hljs-comment">// ã€remove_messageã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=193</span>
<span class="hljs-comment">// ã€remove_messageã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=93</span>
<span class="hljs-comment">// onHandleMessage message={"what":"remove_message","data":{"name":"jiang peng yong","age":14}}</span>
<span class="hljs-comment">// ã€remove_messageã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=359</span>
<span class="hljs-comment">// ã€remove_messageã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=145</span>
</code></pre>
<p><strong>å»¶æ—¶æ‰§è¡Œ Message ç±»å‹ä»»åŠ¡</strong></p>
<ul>
<li>å®šä¹‰ä¸€ä¸ª <code>DelayQueue</code> ç±»ç»§æ‰¿ <code>JSyncQueue</code> ï¼Œä¸»è¦é‡å†™ <code>onHandleMessage</code> æ–¹æ³•ï¼Œç”¨äºæ¥æ”¶å¤„ç† <code>Message</code></li>
<li>åˆ›å»º <code>DelayQueue</code> å®ä¾‹ï¼Œé€šè¿‡è¿™ä¸ªå®ä¾‹è°ƒç”¨ <code>sendMessageDelay</code> æ–¹æ³•å³å¯è¾¾åˆ°ç›¸åº”çš„å»¶æ—¶æ•ˆæœ</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DelayQueue</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">JSyncQueue</span> {
  <span class="hljs-keyword">private</span> count = <span class="hljs-number">0</span>

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onHandleMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt; {
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-string">"DelayQueue"</span>, <span class="hljs-string">`onHandleMessage message=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(message)}</span>`</span>)
    <span class="hljs-keyword">switch</span> (message.<span class="hljs-property">what</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"say_hello"</span>: {
        <span class="hljs-keyword">const</span> name = message.<span class="hljs-property">data</span>[<span class="hljs-string">"name"</span>]
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> += <span class="hljs-number">1</span>

        <span class="hljs-keyword">const</span> delayTime1 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
        <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-string">"DelayQueue"</span>, <span class="hljs-string">`ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime1}</span>`</span>)
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime1)

        <span class="hljs-keyword">const</span> delayTime2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
        <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-string">"DelayQueue"</span>, <span class="hljs-string">`ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime2}</span>`</span>)
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime2)

        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> % <span class="hljs-number">10</span> == <span class="hljs-number">5</span>) {
          <span class="hljs-keyword">throw</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">"æ¨¡æ‹Ÿå¼‚å¸¸"</span> }
        }
        <span class="hljs-keyword">return</span> <span class="hljs-string">`Helloï¼Œ<span class="hljs-subst">${name}</span>. This is the <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span> th greeting.`</span>
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">delay</span>(<span class="hljs-params">ms: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Any</span>&gt;(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, ms))
  }
}

<span class="hljs-attr">delayQueue</span>: <span class="hljs-title class_">JSyncQueue</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DelayQueue</span>(<span class="hljs-string">"DelayQueue"</span>)
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
  <span class="hljs-keyword">const</span> delayTime = i * <span class="hljs-number">100</span>
  <span class="hljs-keyword">const</span> task = <span class="hljs-variable language_">this</span>.<span class="hljs-property">delayQueue</span>.<span class="hljs-title function_">sendMessageDelay</span>({
    <span class="hljs-attr">what</span>: <span class="hljs-string">`say_hello`</span>,
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'æ±Ÿæ¾æ¶Œ'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> + i },
  }, delayTime)
  task.<span class="hljs-title function_">getResult</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªMessageã€‘æ‰§è¡ŒæˆåŠŸ i=<span class="hljs-subst">${i}</span> result=<span class="hljs-subst">${result}</span>`</span>)
    })
    .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">e: <span class="hljs-built_in">Error</span></span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">e</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªMessageã€‘æ‰§è¡Œå¼‚å¸¸ i=<span class="hljs-subst">${i}</span> e=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e)}</span>`</span>)
    })
    .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 5ä¸ªMessageã€‘æ‰§è¡Œç»“æŸi=<span class="hljs-subst">${i}</span>`</span>)
    })
}
<span class="hljs-comment">// ========================================= è¾“å‡ºæ—¥å¿— ========================================= </span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":20}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=356</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=302</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":21}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=67</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=344</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":22}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=339</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=384</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":23}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=442</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=392</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"æ±Ÿæ¾æ¶Œ","age":24}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=443</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=199</span>
</code></pre>
<p><strong>å–æ¶ˆå»¶æ—¶çš„ Message ç±»å‹ä»»åŠ¡</strong></p>
<p>å»¶æ—¶ä»»åŠ¡çš„å–æ¶ˆæ“ä½œå’Œç«‹å³æ‰§è¡Œçš„å–æ¶ˆæ“ä½œæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œéƒ½æ˜¯é€šè¿‡è¿”å›çš„ <code>Task</code> å®ä¾‹è°ƒç”¨ <code>cancel</code> æ–¹æ³•ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ã€‚</p>
<p><strong>åŒä¸€é˜Ÿåˆ—å‹å…¥ Message ç±»å‹ä»»åŠ¡å’Œ Runnable ç±»å‹ä»»åŠ¡</strong></p>
<p>å¯¹ <code>JSyncQueue</code> åŒä¸€å®ä¾‹å‹å…¥ <code>Message</code> å’Œ <code>Runnable</code> ä¸¤ç§ç±»å‹ä»»åŠ¡æ˜¯æ”¯æŒçš„ï¼Œä¼šæŒ‰ç…§å‹å…¥é¡ºåºè¿›è¡Œæ‰§è¡Œå’Œåˆ†å‘ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ImmediatelyQueue æºç å°±ä¸å†å±•ç¤ºï¼Œéœ€è¦å¯ä»¥ç§»æ­¥ Github ä¸ŠæŸ¥é˜…</span>
<span class="hljs-attr">immediatelyQueue</span>: <span class="hljs-title class_">JSyncQueue</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmediatelyQueue</span>(<span class="hljs-string">"ImmediatelyQueue"</span>)
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; ++i) {
  <span class="hljs-keyword">if</span> (i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">immediatelyQueue</span>.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> delayTime1 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime1}</span>`</span>)
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime1)

      <span class="hljs-keyword">const</span> delayTime2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime2}</span>`</span>)
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime2)

      <span class="hljs-keyword">if</span> (i / <span class="hljs-number">2</span> == <span class="hljs-number">3</span>) {
        <span class="hljs-keyword">throw</span> { <span class="hljs-attr">message</span>: <span class="hljs-string">"æ¨¡æ‹Ÿå¼‚å¸¸"</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>
      }
      <span class="hljs-keyword">return</span> <span class="hljs-string">`å°æœ‹å‹-æ·»åŠ 10ä¸ªMessageå’ŒRunnable <span class="hljs-subst">${i}</span>`</span>
    })
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">immediatelyQueue</span>.<span class="hljs-title function_">sendMessage</span>({
      <span class="hljs-attr">what</span>: <span class="hljs-string">`say_hello`</span>,
      <span class="hljs-attr">data</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'å°æœ‹å‹'</span>, <span class="hljs-attr">age</span>: i },
    })
  }
}
<span class="hljs-comment">// ========================================= è¾“å‡ºæ—¥å¿— ========================================= </span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=416</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=41</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"å°æœ‹å‹","age":1}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=184</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=63</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=2 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=451</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=2 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=223</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"å°æœ‹å‹","age":3}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=99</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=27</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=4 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=273</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=4 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=193</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"å°æœ‹å‹","age":5}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=20</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=231</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=6 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=46</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=6 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=198</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"å°æœ‹å‹","age":7}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=179</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=0</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=8 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=131</span>
<span class="hljs-comment">// ã€æ·»åŠ 10ä¸ªMessageå’ŒRunnableã€‘æ‰§è¡Œé€»è¾‘ i=8 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=401</span>
<span class="hljs-comment">// onHandleMessage message={"what":"say_hello","data":{"name":"å°æœ‹å‹","age":9}}</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=452</span>
<span class="hljs-comment">// ã€say_helloã€‘æ‰§è¡Œé€»è¾‘ ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=40</span>
</code></pre>
<h3 data-id="heading-16">4-3ã€å–æ¶ˆé˜Ÿåˆ—ä¸­æ‰€æœ‰ä»»åŠ¡</h3>
<p>å¯¹ <code>JSyncQueue</code> å®ä¾‹è°ƒç”¨ <code>clear</code> æ–¹æ³•ï¼Œå°±ä¼šæŠŠé˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼ŒåŒ…æ‹¬å»¶æ—¶æ‰§è¡Œå’Œç«‹å³æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå…¨éƒ½å–æ¶ˆã€‚åŒæ—¶ä¼šæŠ›å‡º <code>JSyncQueueCancelException</code> ç±»å‹å¼‚å¸¸ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; ++i) {
  <span class="hljs-keyword">const</span> task = <span class="hljs-variable language_">this</span>.<span class="hljs-property">immediatelyQueue</span>.<span class="hljs-title function_">post</span>(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> delayTime1 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime1}</span>`</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime1)

    <span class="hljs-keyword">const</span> delayTime2 = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">500</span>)
    <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œé€»è¾‘ i=<span class="hljs-subst">${i}</span> ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=<span class="hljs-subst">${delayTime2}</span>`</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delay</span>(delayTime2)

    <span class="hljs-keyword">return</span> <span class="hljs-string">`å°æœ‹å‹-æ¸…ç©ºé˜Ÿåˆ— <span class="hljs-subst">${i}</span>`</span>
  })
  task.<span class="hljs-title function_">getResult</span>()
    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡ŒæˆåŠŸ i=<span class="hljs-subst">${i}</span> result=<span class="hljs-subst">${result}</span>`</span>)
    })
    .<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">e: <span class="hljs-built_in">Error</span></span>) =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">e</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œå¼‚å¸¸ i=<span class="hljs-subst">${i}</span> e=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e)}</span>`</span>)
    })
    .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">i</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œç»“æŸ i=<span class="hljs-subst">${i}</span>`</span>)
    })
}
<span class="hljs-variable language_">this</span>.<span class="hljs-property">immediatelyQueue</span>.<span class="hljs-title function_">clear</span>()
<span class="hljs-comment">// ========================================= è¾“å‡ºæ—¥å¿— ========================================= </span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬ä¸€æ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=14</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œå¼‚å¸¸ i=1 e={"message":"Cancel task by clear function."}</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œå¼‚å¸¸ i=2 e={"message":"Cancel task by clear function."}</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œå¼‚å¸¸ i=3 e={"message":"Cancel task by clear function."}</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œå¼‚å¸¸ i=4 e={"message":"Cancel task by clear function."}</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œç»“æŸ i=1</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œç»“æŸ i=2</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œç»“æŸ i=3</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œç»“æŸ i=4</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œé€»è¾‘ i=0 ç¬¬äºŒæ®µ å°†ä¼šæ¨¡æ‹Ÿè€—æ—¶=125</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡ŒæˆåŠŸ i=0 result=å°æœ‹å‹-æ¸…ç©ºé˜Ÿåˆ— 0</span>
<span class="hljs-comment">// ã€æ¸…ç©ºé˜Ÿåˆ—ã€‘æ‰§è¡Œç»“æŸ i=0</span>
</code></pre>
<h2 data-id="heading-17">äº”ã€ä½œè€…åšå®¢</h2>
<p>æ˜é‡‘ï¼š<a href="https://juejin.im/user/5c3033ef51882524ec3a88ba/posts" target="_blank" title="https://juejin.im/user/5c3033ef51882524ec3a88ba/posts">juejin.im/user/5c3033â€¦</a></p>
<p>csdnï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_37625173" target="_blank" title="https://blog.csdn.net/weixin_37625173" ref="nofollow noopener noreferrer">blog.csdn.net/weixin_3762â€¦</a></p>
<p>å…¬ä¼—å·ï¼šå¾®ä¿¡æœç´¢ "æ±Ÿæ¾æ¶Œ"</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[FossFLOWï¼šå¼€æºç­‰è·å›¾è¡¨å·¥å…·ï¼Œä¸ºæŠ€æœ¯æ–‡æ¡£æ³¨å…¥ç«‹ä½“æ´»åŠ›ï¼]]></title>    <link>https://juejin.cn/post/7601041482892623922</link>    <guid>https://juejin.cn/post/7601041482892623922</guid>    <pubDate>2026-01-31T12:12:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601041482892623922" data-draft-id="7601077764424237106" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="FossFLOWï¼šå¼€æºç­‰è·å›¾è¡¨å·¥å…·ï¼Œä¸ºæŠ€æœ¯æ–‡æ¡£æ³¨å…¥ç«‹ä½“æ´»åŠ›ï¼"/> <meta itemprop="keywords" content="å¼€æº"/> <meta itemprop="datePublished" content="2026-01-31T12:12:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¿®å·±xj"/> <meta itemprop="url" content="https://juejin.cn/user/2641475936724142"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            FossFLOWï¼šå¼€æºç­‰è·å›¾è¡¨å·¥å…·ï¼Œä¸ºæŠ€æœ¯æ–‡æ¡£æ³¨å…¥ç«‹ä½“æ´»åŠ›ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2641475936724142/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¿®å·±xj
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T12:12:52.000Z" title="Sat Jan 31 2026 12:12:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ–‡ç« ç®€ä»‹ï¼šFossFLOWæ˜¯ä¸€æ¬¾åˆ›æ–°çš„å¼€æºç­‰è·å›¾è¡¨å·¥å…·ï¼Œä¸“ä¸ºæŠ€æœ¯æ–‡æ¡£è®¾è®¡ã€‚å®ƒé€šè¿‡ç«‹ä½“è§†è§’å°†å¤æ‚çš„ç³»ç»Ÿæ¶æ„è½¬åŒ–ä¸ºç›´è§‚çš„3Då›¾è¡¨ï¼Œæ”¯æŒæ‹–æ”¾å¼æ“ä½œå’Œç¦»çº¿ä½¿ç”¨ï¼Œè®©æŠ€æœ¯å›¾è¡¨å˜å¾—ç”ŸåŠ¨æ˜“æ‡‚ã€‚æ— éœ€æ³¨å†Œï¼Œæ•°æ®å®‰å…¨å­˜å‚¨åœ¨æœ¬åœ°ï¼Œå¹¶æä¾›JSONå¯¼å…¥å¯¼å‡ºåŠŸèƒ½ã€‚æ— è®ºæ˜¯Dockerå¿«é€Ÿéƒ¨ç½²è¿˜æ˜¯åœ¨çº¿ä½“éªŒï¼ŒFossFLOWéƒ½èƒ½ä¸ºæ¶æ„å›¾ã€æµç¨‹å›¾æ³¨å…¥ç«‹ä½“æ´»åŠ›ï¼Œæ˜¯æå‡æŠ€æœ¯æ–‡æ¡£è¡¨ç°åŠ›çš„å¾—åŠ›åŠ©æ‰‹ã€‚</p>
</blockquote>
<p>ä½ æ˜¯å¦æ›¾ç»ä¸ºäº†ç»˜åˆ¶æ¸…æ™°çš„æŠ€æœ¯æ¶æ„å›¾æˆ–ç³»ç»Ÿæµç¨‹å›¾è€Œçƒ¦æ¼ï¼Ÿæ˜¯å¦è§‰å¾—ä¼ ç»Ÿçš„å¹³é¢å›¾è¡¨éš¾ä»¥è¡¨è¾¾å¤æ‚çš„å±‚æ¬¡å…³ç³»ï¼Ÿä»Šå¤©ï¼Œæˆ‘è¦å‘å¤§å®¶ä»‹ç»ä¸€æ¬¾ä»¤äººæƒŠè‰³çš„å¼€æºå·¥å…·â€”â€”<strong>FossFLOW</strong>ï¼Œå®ƒèƒ½è®©ä½ çš„æŠ€æœ¯å›¾è¡¨ç¬é—´å˜å¾—ç«‹ä½“ã€ç”ŸåŠ¨ï¼</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cb593978666244e88a735fc3565d65d6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770466372&amp;x-signature=kLsIqOoVTjJcXG%2BxDSrf4otY62M%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">ğŸŒŸ ä»€ä¹ˆæ˜¯FossFLOWï¼Ÿ</h2>
<p>FossFLOW æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ã€å¼€æºçš„æ¸è¿›å¼ Web åº”ç”¨ï¼ˆPWAï¼‰ï¼Œä¸“ä¸ºåˆ›å»ºç²¾ç¾çš„ç­‰è·å›¾è¡¨è€Œè®¾è®¡ã€‚å®ƒåŸºäº React å’Œ Isoflowï¼ˆç°å·² fork å¹¶ä»¥ fossflow åç§°å‘å¸ƒåˆ° NPMï¼‰åº“æ„å»ºï¼Œå®Œå…¨åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œå¹¶æ”¯æŒç¦»çº¿ä½¿ç”¨ï¼Œè®©ä½ éšæ—¶éšåœ°éƒ½èƒ½åˆ›ä½œå‡ºä¸“ä¸šçº§çš„æŠ€æœ¯å›¾è¡¨ï¼</p>
<p>githubåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fstan-smith%2FFossFLOW" title="https://github.com/stan-smith/FossFLOW" target="_blank" ref="nofollow noopener noreferrer">github.com/stan-smith/â€¦</a></p>
<p>åœ¨çº¿åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fstan-smith.github.io%2FFossFLOW" title="https://stan-smith.github.io/FossFLOW" target="_blank" ref="nofollow noopener noreferrer">stan-smith.github.io/FossFLOW/</a></p>
<p>è¯¥é¡¹ç›®ç›®å‰åœ¨githubä¸Šå·²æœ‰<strong>17k</strong>Â â­ï¸star</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b01c34edfb8c4a51bf24bc0b1a0e8936~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770466372&amp;x-signature=tlErdVFvEOC31mgnO0y7OUYe%2BJQ%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-1">âœ¨ ä¸»è¦ç‰¹æ€§</h2>
<h3 data-id="heading-2">ğŸ¨Â <strong>ç«‹ä½“å›¾è¡¨ï¼Œè§†è§‰å‡çº§</strong></h3>
<ul>
<li>â€¢ åˆ›å»ºä»¤äººæƒŠå¹çš„3Dé£æ ¼æŠ€æœ¯å›¾è¡¨</li>
<li>â€¢ ç­‰è·è§†è§’è®©å¤æ‚çš„ç³»ç»Ÿæ¶æ„ä¸€ç›®äº†ç„¶</li>
<li>â€¢ æ‹–æ”¾å¼æ“ä½œï¼Œç®€å•ç›´è§‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e7456231f1c14f6eb6757cb7b2b2071e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770466372&amp;x-signature=plYE1r8nubSrio2surZjCWmzLmg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">ğŸ”’Â <strong>éšç§ä¼˜å…ˆï¼Œå®‰å…¨å¯é </strong></h3>
<ul>
<li>â€¢ æ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­</li>
<li>â€¢ æ— éœ€æ³¨å†Œï¼Œæ— éœ€ä¸Šä¼ </li>
<li>â€¢ å®Œå…¨æ§åˆ¶ä½ çš„æ•°æ®</li>
</ul>
<h3 data-id="heading-4">ğŸ”„Â <strong>å¯¼å…¥å¯¼å‡ºï¼Œè½»æ¾åˆ†äº«</strong></h3>
<ul>
<li>â€¢ JSONæ ¼å¼å¯¼å…¥å¯¼å‡º</li>
<li>â€¢ å¿«é€Ÿåˆ†äº«ä½ çš„è®¾è®¡</li>
<li>â€¢ å®Œæ•´å¤‡ä»½åŠŸèƒ½</li>
</ul>
<h2 data-id="heading-5">ğŸš€ å¿«é€Ÿä¸Šæ‰‹</h2>
<h3 data-id="heading-6">ğŸ³Dockeréƒ¨ç½²</h3>
<p>åˆ›å»ºdocker-compose.ymlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">services:</span>
Â Â <span class="hljs-attr">fossflow:</span>
Â Â Â Â <span class="hljs-string">image:</span>Â <span class="hljs-string">stnsmith/fossflow:latest</span>
Â Â Â Â <span class="hljs-string">container_name:</span>Â <span class="hljs-string">fossflow</span>
Â Â Â Â <span class="hljs-attr">ports:</span>
Â Â Â Â Â Â <span class="hljs-string">-</span>Â <span class="hljs-string">"5010:80"</span>
Â Â Â Â <span class="hljs-attr">volumes:</span>
Â Â Â Â Â Â <span class="hljs-comment">#Â å¦‚æœè¦ç¦ç”¨æœåŠ¡ç«¯å­˜å‚¨ï¼Œå¯ä»¥æ³¨é‡Šæ‰è¿™è¡Œ</span>
Â Â Â Â Â Â <span class="hljs-string">-</span>Â <span class="hljs-string">./diagrams:/data/diagrams</span>
Â Â Â Â <span class="hljs-attr">environment:</span>
Â Â Â Â Â Â <span class="hljs-string">-</span>Â <span class="hljs-string">TZ=Asia/Shanghai</span>
Â Â Â Â Â Â <span class="hljs-comment">#Â å¦‚æœè¦å¯ç”¨æœåŠ¡ç«¯å­˜å‚¨ï¼Œæ³¨é‡Šæ‰ä¸‹é¢è¿™è¡Œ</span>
Â Â Â Â Â Â <span class="hljs-comment">#Â -Â ENABLE_SERVER_STORAGE="false"</span>
Â Â Â Â <span class="hljs-string">restart:</span>Â <span class="hljs-string">unless-stopped</span>
</code></pre>
<p>åœ¨docker-compose.yml åŒçº§å‘½ä»¤ä¸‹ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨</p>
<pre><code class="hljs">docker-composeÂ upÂ -d
</code></pre>
<p>åˆ°æ­¤ï¼Œæˆ‘ä»¬å°±éƒ¨ç½²å®Œäº†ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å…¥åœ°å€å°±å¯ä»¥è®¿é—®äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a748f8626b44dfd9850a4cfbc5b9af8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770466372&amp;x-signature=JNN1zQdIc%2B2oEsgLbT2Axt4cZZ4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">ğŸŒåœ¨çº¿ä½“éªŒ</h3>
<p>ç›´æ¥è®¿é—®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fstan-smith.github.io%2FFossFLOW" title="https://stan-smith.github.io/FossFLOW" target="_blank" ref="nofollow noopener noreferrer">stan-smith.github.io/FossFLOW/</a></p>
<h3 data-id="heading-8">ğŸ“±æœ¬åœ°å¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment">#Â å…‹éš†ä»“åº“</span>
gitÂ <span class="hljs-built_in">clone</span>Â https://github.com/stan-smith/FossFLOW
<span class="hljs-built_in">cd</span>Â FossFLOW

<span class="hljs-comment">#Â å®‰è£…ä¾èµ–</span>
npmÂ install

<span class="hljs-comment">#Â å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>
npmÂ start
</code></pre>
<h2 data-id="heading-9">ğŸ› ï¸ ä½¿ç”¨æŒ‡å—</h2>
<h3 data-id="heading-10">ğŸ“ˆ1. åˆ›å»ºå›¾è¡¨</h3>
<ul>
<li>â€¢ ç‚¹å‡»å³ä¸Šè§’"+"æŒ‰é’®æ‰“å¼€ç»„ä»¶åº“</li>
<li>â€¢ ä»å·¦ä¾§æ‹–æ”¾ç»„ä»¶åˆ°ç”»å¸ƒ</li>
<li>â€¢ æˆ–å³é”®ç½‘æ ¼é€‰æ‹©"Add node"</li>
</ul>
<h3 data-id="heading-11">ğŸ§©2. è¿æ¥ç»„ä»¶</h3>
<ul>
<li>â€¢ ä½¿ç”¨è¿æ¥å™¨æ˜¾ç¤ºç»„ä»¶å…³ç³»</li>
<li>â€¢ æ™ºèƒ½å¯¹é½ï¼Œä¿æŒå›¾è¡¨æ•´æ´</li>
<li>â€¢ å¤šå±‚è¿æ¥ï¼Œè¡¨è¾¾å¤æ‚å…³ç³»</li>
</ul>
<h3 data-id="heading-12">âœï¸3. è‡ªå®šä¹‰æ ·å¼</h3>
<ul>
<li>â€¢ æ›´æ”¹é¢œè‰²ã€æ ‡ç­¾å’Œå±æ€§</li>
<li>â€¢ è°ƒæ•´ä½ç½®å’Œå¤§å°</li>
<li>â€¢ æ·»åŠ è¯´æ˜æ–‡å­—</li>
</ul>
<h3 data-id="heading-13">ğŸ¨4. å¯¼èˆªæ“ä½œ</h3>
<ul>
<li>â€¢ é¼ æ ‡æ»šè½®æ”¾å¤§ç¼©å°</li>
<li>â€¢ ç‚¹å‡»æ‹–åŠ¨å¹³ç§»ç”»å¸ƒ</li>
<li>â€¢ Ctrl+Zæ’¤é”€ï¼ŒCtrl+Yé‡åš</li>
</ul>
<h2 data-id="heading-14">ğŸ—ï¸ æŠ€æœ¯æ ˆ</h2>
<ul>
<li>â€¢Â <strong>React</strong>Â - ç°ä»£åŒ–çš„UIæ¡†æ¶</li>
<li>â€¢Â <strong>TypeScript</strong>Â - ç±»å‹å®‰å…¨çš„å¼€å‘ä½“éªŒ</li>
<li>â€¢Â <strong>Isoflow</strong>Â - å¼ºå¤§çš„ç­‰è·å›¾è¡¨å¼•æ“</li>
<li>â€¢Â <strong>PWA</strong>Â - ç¦»çº¿ä¼˜å…ˆçš„Webåº”ç”¨æ¶æ„</li>
</ul>
<h2 data-id="heading-15">ğŸš¨ç¼ºç‚¹ä¸ä¸è¶³</h2>
<p>è™½ç„¶è¯¥å·¥å…·åœ¨åŸºç¡€åŠŸèƒ½æ–¹é¢è¡¨ç°è‰¯å¥½ï¼Œä½†åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ä»å­˜åœ¨ä¸€äº›æ˜æ˜¾çš„å±€é™æ€§ä¸ä¸è¶³ä¹‹å¤„ï¼š</p>
<ul>
<li>
<p>â€¢ 3DèŠ‚ç‚¹èµ„æºä¸¥é‡åŒ®ä¹</p>
<p>å®˜æ–¹æä¾›çš„3DèŠ‚ç‚¹ç±»å‹æä¸ºæœ‰é™ï¼Œä»…åŒ…å«åŸºç¡€çš„å‡ ä½•å½¢çŠ¶å’Œå°‘æ•°é¢„è®¾æ¨¡å‹ï¼Œæ— æ³•æ»¡è¶³å¤æ‚ä¸‰ç»´åœºæ™¯çš„æ„å»ºéœ€æ±‚ã€‚</p>
</li>
<li>
<p>â€¢ ç¬¬ä¸‰æ–¹èŠ‚ç‚¹ç”Ÿæ€å‘å±•ä¸å®Œå–„</p>
<p>ç¬¬ä¸‰æ–¹æ’ä»¶å¤šä¸º2DèŠ‚ç‚¹ï¼Œåœ¨æ„å»ºå¤æ‚ä¸‰ç»´åœºæ™¯æ—¶å¯èƒ½é¢ä¸´èŠ‚ç‚¹ç´ æä¸è¶³çš„é—®é¢˜ã€‚</p>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/416642ca598c4f2ba5493e31ade60c74~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5L-u5bexeGo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770466372&amp;x-signature=cWCaVwNBhxYoJAEbszgu%2FNhGAok%3D" alt="" loading="lazy"/></p>
<ul>
<li>â€¢ å¿«æ·æ“ä½œæ–¹å¼è¿˜æœ‰å¾…æ”¹è¿›</li>
</ul>
<h2 data-id="heading-16">ğŸ“ æœ€åçš„è¯</h2>
<p>åœ¨æŠ€æœ¯æ–‡æ¡£è¶Šæ¥è¶Šé‡è¦çš„ä»Šå¤©ï¼Œä¸€ä¸ªæ¸…æ™°ã€ç›´è§‚çš„å›¾è¡¨å¾€å¾€èƒœè¿‡åƒè¨€ä¸‡è¯­ã€‚FossFLOWä»¥å…¶ç‹¬ç‰¹çš„ç­‰è·è§†è§’ï¼Œä¸ºæŠ€æœ¯å›¾è¡¨å¸¦æ¥äº†å…¨æ–°çš„å¯èƒ½æ€§ã€‚æ— è®ºä½ æ˜¯æ¶æ„å¸ˆã€å¼€å‘è€…ã€æŠ€æœ¯ä½œå®¶è¿˜æ˜¯é¡¹ç›®ç»ç†ï¼Œè¿™æ¬¾å·¥å…·éƒ½å€¼å¾—ä¸€è¯•ã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒæ˜¯å®Œå…¨å…è´¹å’Œå¼€æºçš„ï¼ä½ å¯ä»¥åœ¨GitHubä¸Šæ‰¾åˆ°æ‰€æœ‰æºä»£ç ï¼Œè‡ªç”±ä½¿ç”¨ã€å­¦ä¹ å’Œæ”¹è¿›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Docker åˆ°åº•å˜æˆäº†ä»€ä¹ˆï¼Ÿä»â€œå®¹å™¨ä¹‹ç‹â€åˆ°â€œå¼€å‘è€…å·¥å…·ç®±+AI åŸºå»º+å®‰å…¨å…¬å¸â€çš„å¥‡å¦™æ¼‚æµ]]></title>    <link>https://juejin.cn/post/7601020578491236361</link>    <guid>https://juejin.cn/post/7601020578491236361</guid>    <pubDate>2026-01-31T12:27:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601020578491236361" data-draft-id="7601069677566476334" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Docker åˆ°åº•å˜æˆäº†ä»€ä¹ˆï¼Ÿä»â€œå®¹å™¨ä¹‹ç‹â€åˆ°â€œå¼€å‘è€…å·¥å…·ç®±+AI åŸºå»º+å®‰å…¨å…¬å¸â€çš„å¥‡å¦™æ¼‚æµ"/> <meta itemprop="keywords" content="Java,Docker"/> <meta itemprop="datePublished" content="2026-01-31T12:27:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Dcs"/> <meta itemprop="url" content="https://juejin.cn/user/3679404422861902"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Docker åˆ°åº•å˜æˆäº†ä»€ä¹ˆï¼Ÿä»â€œå®¹å™¨ä¹‹ç‹â€åˆ°â€œå¼€å‘è€…å·¥å…·ç®±+AI åŸºå»º+å®‰å…¨å…¬å¸â€çš„å¥‡å¦™æ¼‚æµ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3679404422861902/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Dcs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T12:27:59.000Z" title="Sat Jan 31 2026 12:27:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ‰äº›æŠ€æœ¯äº§å“çš„å‘½è¿å¾ˆè®½åˆºï¼šå®ƒæˆåŠŸåˆ°æˆä¸ºâ€œåŸºç¡€è®¾æ–½â€ï¼Œç„¶åå°±å¾ˆéš¾å†é å®ƒèµšé’±ã€‚Docker å°±æ˜¯å…¸å‹æ¡ˆä¾‹â€”â€”å®¹å™¨åŒ–æ ‡å‡†è¢«å…¨è¡Œä¸šé‡‡ç”¨åï¼ŒDockerè¶Šç”¨è¶Šé¦™ï¼ŒDockerå…¬å¸åè€Œå¼€å§‹è¿›å…¥ä¸€ç§â€œæˆ‘æ˜¯è°ã€æˆ‘åœ¨å“ªã€æˆ‘å–ä»€ä¹ˆâ€çš„é•¿æœŸè¿·èŒ«æœŸã€‚</p>
<p>ç«™åœ¨ 2026 å¾€å›çœ‹ï¼ŒDocker çš„è·¯çº¿åƒæäº†ä¸€ä¸ªâ€œæ›¾ç»ç»Ÿæ²»æ±Ÿæ¹–çš„é«˜æ‰‹â€ï¼Œçªç„¶å‘ç°å¤§å®¶éƒ½å­¦ä¼šäº†ä»–çš„ç»æ‹›ï¼Œè¿˜å…è´¹å¼€æºæ•™ç¨‹ï¼Œäºæ˜¯åªèƒ½ä¸æ–­æ¢èµ›é“ï¼šä»ç¼–æ’ï¼Œåˆ°å¼€å‘è€…ä½“éªŒï¼Œå†åˆ° AIï¼Œå†åˆ°å®‰å…¨é•œåƒâ€¦â€¦æ¯ä¸€æ­¥å•ç‹¬çœ‹éƒ½åˆç†ï¼Œè¿èµ·æ¥å°±åƒåœ¨ç©â€œå•†ä¸šæ¨¡å¼å¤§å¯Œç¿â€ã€‚ğŸ˜…</p>
<p>æˆ‘ä»¬å°±æ¥èŠèŠ Docker è¿™äº›å¹´åˆ°åº•åœ¨è¿½ä»€ä¹ˆï¼Œä»¥åŠå¯¹å¼€å‘è€…æ„å‘³ç€ä»€ä¹ˆã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dcbb5875bb9b414a9fb61311b33954ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770467281&amp;x-signature=tasB1xyW8iVipM4Zf8irMljQqwo%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-0">1ï¼‰å½“â€œäº‹å®æ ‡å‡†â€å˜æˆâ€œå…è´¹ç©ºæ°”â€ï¼šDocker æœ€éš¾çš„ä¸æ˜¯æŠ€æœ¯ï¼Œæ˜¯æ”¶é’±ğŸ’°</h2>
<p>Docker æ—©å¹´è§£å†³çš„æ˜¯â€œåº”ç”¨äº¤ä»˜çš„ç»ˆæç—›ç‚¹â€ï¼šç¯å¢ƒä¸ä¸€è‡´ã€éƒ¨ç½²ä¸å¯é ã€ä¾èµ–ä¹±ã€‚å®¹å™¨æŠŠè¿™ä¸€åˆ‡æ¢³é¡ºäº†ï¼Œç”šè‡³æŠŠâ€œæ‰“åŒ…äº¤ä»˜â€çš„è¯­è¨€éƒ½ç»Ÿä¸€äº†ã€‚</p>
<p>é—®é¢˜ä¹Ÿæ­£å‡ºåœ¨è¿™é‡Œï¼šå½“å®¹å™¨åŒ–æˆä¸ºåŸºç¡€è®¾æ–½ï¼Œå¤§å®¶é»˜è®¤â€œå®ƒå°±åº”è¯¥å­˜åœ¨â€ï¼Œå°±åƒé»˜è®¤ TCP/IP ä¸è¯¥æ”¶è´¹ä¸€æ ·ã€‚åŸºç¡€è®¾æ–½è¶ŠæˆåŠŸï¼Œå•†ä¸šåŒ–è¶Šç—›è‹¦â€”â€”é™¤éä½ èƒ½åœ¨åŸºç¡€è®¾æ–½ä¹‹ä¸Šï¼Œå–å‡ºæ–°çš„ã€ä¸å¯æ›¿ä»£çš„ä»·å€¼ã€‚</p>
<p>äºæ˜¯ Docker å¼€å§‹å¯»æ‰¾â€œæ–°ä»·å€¼ç‚¹â€ã€‚</p>
<hr/>
<h2 data-id="heading-1">2ï¼‰ç¼–æ’ä¹‹æˆ˜ï¼šKubernetes èµ¢äº†ï¼ŒDocker é€‰æ‹©â€œé€€ä¸€æ­¥æµ·é˜”å¤©ç©ºâ€ğŸŒŠ</h2>
<p>æ›¾ç» Docker ä¹Ÿæƒ³æŠŠç‰ˆå›¾æ‰©åˆ°â€œç¼–æ’â€ï¼Œè®© Swarm è·Ÿ Kubernetes æ­£é¢æ°æ‰‹è…•ã€‚ä½†ç°å®æ˜¯ï¼šK8s æˆäº†äº‹å®æ ‡å‡†ï¼Œç”Ÿæ€å’Œç¤¾åŒºåƒé›ªçƒè¶Šæ»šè¶Šå¤§ã€‚</p>
<p>åæ¥çš„å‰§æƒ…å¤§å®¶éƒ½çŸ¥é“ï¼šDocker æŠŠä¼ä¸šä¸šåŠ¡ï¼ˆåŒ…å«ç›¸å…³æŠ€æœ¯ä¸å®¢æˆ·èµ„äº§ï¼‰å–ç»™ Mirantisï¼ŒSwarm ä¹Ÿéšè¿™æ³¢äº¤æ˜“è¿›å…¥ Mirantis ä½“ç³»ï¼ŒDocker è‡ªå·±åˆ™æ›´èšç„¦åœ¨ Desktopã€Hubã€ä»¥åŠå¼€å‘è€…å·¥ä½œæµä¸Šã€‚</p>
<p>è¿™ä¸€æ­¥ä¼ é€’çš„ä¿¡å·å¾ˆæ¸…æ™°ï¼šä¸å†æ‰§ç€äºâ€œå…¨æ ˆäº‘åŸç”Ÿå¹³å°â€ï¼Œè½¬è€Œåšè‡ªå·±æœ€æ“…é•¿ã€æœ€è´´è¿‘å¼€å‘è€…çš„ç¯èŠ‚ã€‚</p>
<hr/>
<h2 data-id="heading-2">3ï¼‰å¼€å‘è€…å·¥å…·è½¬å‘ï¼šScoutã€Testcontainersï¼ŒæŠŠâ€œå®‰å…¨â€å’Œâ€œæµ‹è¯•â€å¡è¿›æ—¥å¸¸å·¥ä½œæµğŸ§°</h2>
<p>Docker çš„â€œå¼€å‘è€…ä½“éªŒè·¯çº¿â€å…¶å®æ˜¯éå¸¸èªæ˜çš„ä¸€æ­¥ï¼šå¼€å‘è€…æ„¿æ„ä¸ºæ•ˆç‡å’Œç¡®å®šæ€§ä»˜è´¹ï¼Œå°¤å…¶æ˜¯å½“è½¯ä»¶ä¾›åº”é“¾å’Œä¾èµ–æ¼æ´è¶Šæ¥è¶Šåƒâ€œå®šæ—¶ç‚¸å¼¹â€æ—¶ã€‚</p>
<h3 data-id="heading-3">Docker Scoutï¼šæŠŠé•œåƒâ€œæ‹†å¼€éªŒè´§â€ï¼Œé¡ºæ‰‹æŠŠä¾›åº”é“¾å®‰å…¨åšäº†</h3>
<p>Docker é€šè¿‡æ”¶è´­ Atomist åŠ é€Ÿè¿›å…¥è½¯ä»¶ä¾›åº”é“¾ä¸å¯è§‚æµ‹æ€§æ–¹å‘ï¼ŒéšåæŠŠèƒ½åŠ›æ²‰æ·€åˆ° Docker Scout è¿™ç±»äº§å“ä¸Šï¼šä¸åªå‘Šè¯‰ä½ é•œåƒé‡Œæœ‰ä»€ä¹ˆåŒ…ï¼Œè¿˜è¦è¿½æº¯å®ƒæ€ä¹ˆæ„å»ºã€å“ªé‡Œæœ‰æ¼æ´ã€æœ‰æ²¡æœ‰åˆè§„é£é™©ã€‚</p>
<h3 data-id="heading-4">Testcontainersï¼šæŠŠé›†æˆæµ‹è¯•ä»â€œç„å­¦â€æ‹‰å›â€œå¯å¤ç°â€</h3>
<p>Docker æ”¶è´­ AtomicJarï¼ˆTestcontainers èƒŒåçš„å…¬å¸ï¼‰åˆ™æ˜¯å¦ä¸€æ‹›â€œè´´åœ°é£è¡Œâ€ï¼šæµ‹è¯•é˜¶æ®µç›´æ¥æ‹‰èµ·çœŸå®ä¾èµ–ï¼ˆæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼‰ï¼Œè®©é›†æˆæµ‹è¯•æ›´æ¥è¿‘ç”Ÿäº§ï¼Œä»è€Œå‡å°‘â€œçº¿ä¸Šæ‰çˆ†ç‚¸â€çš„æ¦‚ç‡ã€‚</p>
<p>è¿™ä¸€é˜¶æ®µçš„ Dockerï¼Œåƒä¸€ä¸ªè¶Šæ¥è¶Šæ‡‚å¼€å‘è€…çš„äº§å“ç»ç†ï¼šä¸è°ˆå®å¤§å™äº‹ï¼Œåªè§£å†³â€œä»Šå¤©èƒ½ä¸èƒ½å°‘åŠ ç­â€çš„é—®é¢˜ã€‚</p>
<hr/>
<h2 data-id="heading-5">4ï¼‰AI æ—¶ä»£çš„â€œå†ä¸€æ¬¡èº«ä»½åˆ‡æ¢â€</h2>
<p>ä»å®¹å™¨åˆ°æ¨¡å‹ã€ä» Compose åˆ° AgentğŸ¤–</p>
<p>ç„¶åï¼ŒAI æµªæ½®æ¥äº†â€”â€”å‡ ä¹æ‰€æœ‰åŸºç¡€è®¾æ–½å…¬å¸éƒ½ä¼šè¢«è¿«å›ç­”ä¸€ä¸ªé—®é¢˜ï¼š<strong>â€œAI å·¥ä½œè´Ÿè½½è¦æ€ä¹ˆè·‘ï¼Ÿæˆ‘èƒ½æ’ä¸€è„šå—ï¼Ÿâ€</strong></p>
<p>Docker çš„å›ç­”æ˜¯ï¼šèƒ½ï¼Œè€Œä¸”è¦è·‘å¾—åƒ <code>docker run</code> ä¸€æ ·é¡ºæ‰‹ã€‚</p>
<h3 data-id="heading-6">Model Runnerï¼šè®©æœ¬åœ°è·‘æ¨¡å‹åƒè·‘å®¹å™¨ä¸€æ ·è‡ªç„¶</h3>
<p>Docker æ¨å‡º Docker Model Runnerï¼Œä¸»æ‰“â€œæ›´å¿«æ›´ç®€å•åœ°åœ¨æœ¬åœ°è¿è¡Œå’Œæµ‹è¯• AI æ¨¡å‹â€ï¼ŒæŠŠæ¨¡å‹è¿è¡Œå¡è¿›å¼€å‘è€…ç†Ÿæ‚‰çš„ Docker å·¥ä½œæµé‡Œã€‚</p>
<h3 data-id="heading-7">Compose + Offloadï¼šæœ¬åœ°è°ƒè¯•ï¼Œäº‘ç«¯ä¸Š GPU æ‰©å®¹</h3>
<p>Docker è¿˜æŠŠ Compose æ‹‰è¿›â€œAI Agent æ—¶ä»£â€ï¼Œå¹¶å¼•å…¥ Docker Offload æ¥æ‰¿æ¥äº‘ç«¯ GPU è§„æ¨¡åŒ–æ‰§è¡Œï¼ŒæŠŠâ€œæœ¬åœ°å¥½è°ƒè¯•ã€çº¿ä¸Šè·‘å¾—åŠ¨â€çš„è€çŸ›ç›¾ï¼ŒåŒ…è£…æˆä¸€æ¡æ›´å¹³æ»‘çš„è·¯å¾„ã€‚</p>
<p>è¯´ç™½äº†ï¼šDocker æ­£åœ¨åŠªåŠ›æŠŠ AI å¼€å‘ä¹Ÿå˜æˆä¸€ç§â€œå¯å£°æ˜ã€å¯å¤ç°ã€å¯æ¬è¿â€çš„å·¥ç¨‹åŒ–ä½“éªŒâ€”â€”è¿™æ­£æ˜¯å®ƒå½“å¹´åœ¨å®¹å™¨æ—¶ä»£æœ€æ“…é•¿çš„é‚£å¥—å™äº‹ã€‚</p>
<hr/>
<h2 data-id="heading-8">5ï¼‰å®‰å…¨ç‰ŒåŠ ç </h2>
<p>æ”¶è´­ MCP Defender + æ¨å‡º Hardened Imagesï¼Œåƒåœ¨å¯¹è¡Œä¸šå–Šâ€œæˆ‘è¿˜èƒ½æ‰“â€ğŸ›¡ï¸</p>
<p>AI ä¹‹åï¼ŒDocker åˆæŠŠâ€œå®‰å…¨â€æ¨åˆ°äº†æ›´æ ¸å¿ƒçš„ä½ç½®ã€‚</p>
<h3 data-id="heading-9">MCP Defenderï¼šé¢å‘ Agentic AI çš„è¿è¡Œæ—¶å¨èƒæ£€æµ‹</h3>
<p>2025 å¹´ 9 æœˆï¼ŒDocker å®£å¸ƒæ”¶è´­ MCP Defenderï¼Œå®šä½æ˜¯â€œä¸º agentic AI åº”ç”¨æä¾›å®‰å…¨èƒ½åŠ›â€ï¼Œå¼ºè°ƒè¿è¡Œæ—¶å¨èƒæ£€æµ‹ä¸é˜²æŠ¤ã€‚
è¿™ä¸€æ­¥å‡ ä¹ç­‰äºå®£å‘Šï¼šDocker æƒ³åšçš„ä¸åªæ˜¯å¼€å‘è€…å·¥å…·ï¼Œè€Œæ˜¯ AI åŸºç¡€è®¾æ–½çš„ä¸€éƒ¨åˆ†ã€‚</p>
<h3 data-id="heading-10">Hardened Imagesï¼š1000+ åŠ å›ºé•œåƒå¼€æºå…è´¹ï¼Œæ¼æ´æœ€å¤šå¯é™ 95%</h3>
<p>æ›´â€œç‹ â€çš„æ˜¯åŠ å›ºé•œåƒï¼šDocker å®£å¸ƒå°† Docker Hardened Images èµ°å‘â€œå…è´¹ã€å¼€æºã€é€æ˜â€ï¼Œé‡‡ç”¨ Apache 2.0 è®¸å¯ï¼Œå¼ºè°ƒç›¸æ¯”ä¼ ç»Ÿç¤¾åŒºé•œåƒæ¼æ´æœ€å¤šå¯å‡å°‘ 95%ï¼Œå¹¶å»ºç«‹åœ¨ Alpineã€Debian ç­‰åŸºç¡€ä¹‹ä¸Šã€‚</p>
<p>è¿™æ‹›å¾ˆåƒâ€œå®‰å…¨é•œåƒèµ›é“â€çš„æ­£é¢ç¡¬åˆšï¼šå½“å¸‚åœºä¸Šå‡ºç°å¼ºåŠ¿å¯¹æ‰‹ï¼ˆæ¯”å¦‚ä¸“æ³¨å®‰å…¨é•œåƒçš„å‚å•†ï¼‰ï¼Œæœ€æœ‰æ•ˆçš„ç«äº‰æ‰‹æ®µä¹‹ä¸€å°±æ˜¯â€”â€”æŠŠé—¨æ§›ç›´æ¥æ‰“åˆ°åœ°æ¿ä»·ï¼šå…è´¹ + å¼€æºã€‚
ä½†é—®é¢˜ä¹Ÿéšä¹‹è€Œæ¥ï¼š<strong>å¦‚æœå®‰å…¨èƒ½åŠ›éƒ½å…è´¹äº†ï¼Œé‚£ Docker è¦é ä»€ä¹ˆæŒ£é’±ï¼Ÿ</strong></p>
<hr/>
<h2 data-id="heading-11">6ï¼‰CEO æ›´æ›¿ä¸â€œè¢«æ”¶è´­çŒœæƒ³â€ï¼šå…¬å¸å±‚é¢çš„ä¿¡å·æ›´è€äººå¯»å‘³ğŸ‘€</h2>
<p>2025 å¹´ 2 æœˆï¼ŒDocker ä»»å‘½ Don Johnson ä¸ºæ–° CEOï¼Œæ¥æ›¿ Scott Johnstonã€‚
å¤–ç•Œå¯¹è¿™ç§æ›´æ›¿çš„è§£è¯»å¾€å¾€å¾ˆç°å®ï¼šå½“ä¸€ä¸ªå…¬å¸é¢‘ç¹è°ƒæ•´æˆ˜ç•¥ã€åŒæ—¶è¡¥é½å¤šä¸ªâ€œå¯èƒ½å˜ç°â€çš„æ–¹å‘ï¼ˆå¼€å‘è€…å·¥å…·ã€ä¼ä¸šå®‰å…¨ã€AI åŸºå»ºï¼‰ï¼Œå°±å¾ˆå®¹æ˜“è¢«è”æƒ³åˆ°â€”â€”æ˜¯åœ¨ä¸ºæ›´å¤§çš„åˆä½œæˆ–èµ„æœ¬åŠ¨ä½œåšå‡†å¤‡ã€‚</p>
<p>å½“ç„¶ï¼ŒçŒœæƒ³å½’çŒœæƒ³ï¼Œèƒ½ç¡®å®šçš„æ˜¯ï¼šDocker ä»åœ¨å¯»æ‰¾ä¸€ä¸ªèƒ½é•¿æœŸè‡ªæ´½çš„å•†ä¸šç­”æ¡ˆã€‚</p>
<hr/>
<h2 data-id="heading-12">7ï¼‰å¯¹å¼€å‘è€…æ„å‘³ç€ä»€ä¹ˆï¼šåˆ«å¤ªç„¦è™‘ï¼ŒæŠ€æœ¯ä¸ä¼šæ¶ˆå¤±ï¼Œä½†ç”Ÿæ€ä¼šå˜ğŸ“¦</h2>
<p>å¯¹å¤§å¤šæ•°å¼€å‘è€…æ¥è¯´ï¼Œæœ‰ä¸¤ä»¶äº‹æ˜¯ç›¸å¯¹ç¡®å®šçš„ï¼š</p>
<ol>
<li>Dockerï¼ˆæŠ€æœ¯ï¼‰ä¸ä¼šæ¶ˆå¤±ï¼šå®ƒå·²ç»æ·±åˆ°å·¥å…·é“¾å’Œ CI/CD çš„éª¨é«“é‡Œï¼Œæ›¿ä»£æˆæœ¬æé«˜ã€‚</li>
<li>Dockerï¼ˆå…¬å¸ï¼‰çš„äº§å“é‡å¿ƒä¼šç»§ç»­æ¼”åŒ–ï¼šä» Desktop/HUB åˆ°å®‰å…¨ã€å†åˆ° AIï¼Œæœªæ¥ä¼šå‡ºç°æ›´å¤šâ€œä»˜è´¹å¢å€¼å±‚â€ã€‚</li>
</ol>
<p>æ›´ç°å®çš„å»ºè®®æ˜¯ï¼š</p>
<ul>
<li>å¦‚æœå›¢é˜Ÿä¾èµ–å®¹å™¨äº¤ä»˜ï¼šç»§ç»­ç”¨ Docker æ²¡é—®é¢˜ï¼Œä½†æŠŠâ€œé•œåƒå®‰å…¨â€â€œä¾èµ–æ²»ç†â€çº³å…¥æ ‡å‡†æµç¨‹ï¼ˆScout/åŠ å›ºé•œåƒè¿™ç±»èƒ½åŠ›å€¼å¾—è¯„ä¼°ï¼‰ã€‚</li>
<li>å¦‚æœå›¢é˜Ÿåœ¨åš AI å·¥ç¨‹åŒ–ï¼šå…³æ³¨ Compose + Offloadã€Model Runner è¿™æ¡è·¯çº¿æ˜¯å¦èƒ½å‡å°‘ç¯å¢ƒå‰²è£‚ä¸ GPU èµ„æºç®¡ç†æˆæœ¬ã€‚</li>
<li>å¦‚æœå›¢é˜Ÿéœ€è¦é•¿æœŸå¯æ§ï¼šåˆ«æŠŠæŸä¸€å®¶å‚å•†å½“â€œå”¯ä¸€ç­”æ¡ˆâ€ï¼ŒæŠŠæ„å»ºã€æ‰«æã€ç­¾åã€éƒ¨ç½²æµç¨‹åšæˆå¯æ›¿æ¢æ¨¡å—ï¼Œæ‰æ˜¯çœŸæ­£çš„æŠ—é£é™©ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-13">ç»“è¯­</h2>
<p>Docker çš„â€œå°´å°¬â€å…¶å®æ˜¯å¼€æºæˆåŠŸè€…çš„å…±åŒéš¾é¢˜ğŸ™‚</p>
<p>Docker çš„æ•…äº‹åƒä¸€é¢é•œå­ï¼šå½“ä½ åšå‡ºä¸€ä¸ªæ”¹å˜ä¸–ç•Œçš„å¼€æºæŠ€æœ¯ï¼Œå®ƒè¶ŠæˆåŠŸï¼Œå°±è¶Šåƒæ°´å’Œç”µä¸€æ ·â€œç†æ‰€å½“ç„¶â€ï¼›è€Œè¶Šç†æ‰€å½“ç„¶ï¼Œå°±è¶Šéš¾ç›´æ¥å˜ç°ã€‚
äºæ˜¯å…¬å¸å¿…é¡»ä¸æ–­å¯»æ‰¾æ–°çš„é™„åŠ ä»·å€¼ï¼šå¼€å‘è€…æ•ˆç‡ã€å®‰å…¨ã€AIã€ä¼ä¸šèƒ½åŠ›â€¦â€¦æ¯ä¸€å¼ ç‰Œéƒ½èƒ½ç†è§£ï¼Œä½†èƒ½å¦æ‹¼æˆä¸€æ¡é•¿æœŸå¯æŒç»­çš„è·¯çº¿ï¼Œè¿˜è¦çœ‹æ¥ä¸‹æ¥çš„å‡ å¹´ã€‚</p>
<hr/>
<p><strong>å–œæ¬¢å°±å¥–åŠ±ä¸€ä¸ªâ€œğŸ‘â€å’Œâ€œåœ¨çœ‹â€å‘—~</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bed040c07dcd44c4be05fa90997a8914~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRGNz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1770467281&amp;x-signature=O0BjU32LWik5n3OZYdXi6tFmBWE%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Clawdbot æ˜¯å¦‚ä½•å®ç°æ°¸ä¹…è®°å¿†çš„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7601053058857156614</link>    <guid>https://juejin.cn/post/7601053058857156614</guid>    <pubDate>2026-01-31T12:28:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601053058857156614" data-draft-id="7601053058857140230" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Clawdbot æ˜¯å¦‚ä½•å®ç°æ°¸ä¹…è®°å¿†çš„ï¼Ÿ"/> <meta itemprop="keywords" content="Agent"/> <meta itemprop="datePublished" content="2026-01-31T12:28:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºçŒ¿DD"/> <meta itemprop="url" content="https://juejin.cn/user/131597123993358"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Clawdbot æ˜¯å¦‚ä½•å®ç°æ°¸ä¹…è®°å¿†çš„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/131597123993358/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºçŒ¿DD
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T12:28:56.000Z" title="Sat Jan 31 2026 12:28:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ æ˜¯å¦æ›¾ç»å’ŒAIåŠ©æ‰‹èŠäº†ä¸€æ•´æ™šï¼Œç¬¬äºŒå¤©æ‰“å¼€å¯¹è¯å´å‘ç°å®ƒå®Œå…¨å¿˜äº†ä½ ä»¬è®¨è®ºè¿‡çš„å…³é”®ç»†èŠ‚ï¼Ÿæˆ–è€…å½“ä½ åœ¨å¤šä¸ªé¡¹ç›®ä¹‹é—´åˆ‡æ¢æ—¶ï¼ŒAIæ€»æ˜¯åœ¨é—®"ä½ æŒ‡çš„æ˜¯å“ªä¸ªAPI"ï¼Œè®©ä½ ä¸åŒå…¶çƒ¦åœ°é‡å¤èƒŒæ™¯ä¿¡æ¯ã€‚è¿™ç§"é‡‘é±¼å¼è®°å¿†"æ˜¯å½“ä¸‹å¤§å¤šæ•°äº‘ç«¯AIäº§å“çš„é€šç—…â€”â€”å®ƒä»¬è¦ä¹ˆåªèƒ½è®°ä½æœ‰é™çš„ä¸Šä¸‹æ–‡ï¼Œè¦ä¹ˆæŠŠæ‰€æœ‰æ•°æ®éƒ½å­˜å‚¨åœ¨å‚å•†çš„æœåŠ¡å™¨ä¸Šã€‚</p>
<p>ä½†å¦‚æœæœ‰ä¸€ä¸ªAIåŠ©æ‰‹ï¼Œå®ƒèƒ½åƒä¸€ä½çœŸæ­£çš„ç§äººåŠ©ç†é‚£æ ·ï¼Œæ°¸è¿œè®°ä½ä½ çš„åå¥½ã€ä½ çš„é¡¹ç›®ç»†èŠ‚ã€ç”šè‡³ä½ ä¸‰ä¸ªæœˆå‰æè¿‡çš„å°ä¹ æƒ¯ï¼Ÿæ›´å¦™çš„æ˜¯ï¼Œè¿™äº›è®°å¿†å®Œå…¨å­˜å‚¨åœ¨ä½ è‡ªå·±çš„ç”µè„‘ä¸Šï¼Œç”±ä½ å…¨æƒæŒæ§ã€‚</p>
<p>è¿™å°±æ˜¯Clawdbotæ­£åœ¨åšçš„äº‹æƒ…ã€‚ä½œä¸ºä¸€æ¬¾å¼€æºçš„ä¸ªäººAIåŠ©æ‰‹ï¼ŒClawdbotåœ¨GitHubä¸Šå·²ç»è·å¾—äº†è¶…è¿‡125,000ä¸ªStarã€‚ä¸è¿è¡Œåœ¨äº‘ç«¯çš„ChatGPTæˆ–Claudeä¸åŒï¼ŒClawdbotç›´æ¥è¿è¡Œåœ¨ä½ çš„æœ¬åœ°æœºå™¨ä¸Šï¼Œå¹¶ä¸”èƒ½å¤Ÿé›†æˆåˆ°ä½ æ—¥å¸¸ä½¿ç”¨çš„èŠå¤©å¹³å°ä¸­ï¼ˆDiscordã€WhatsAppã€Telegramç­‰ï¼‰ã€‚</p>
<p>å®ƒä¸ä»…æ˜¯ä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œæ›´æ˜¯ä¸€ä¸ªèƒ½è‡ªä¸»å¤„ç†å®é™…ä»»åŠ¡çš„åŠ©æ‰‹ï¼šç®¡ç†é‚®ä»¶ã€å®‰æ’æ—¥å†ã€å¤„ç†èˆªç­å€¼æœºã€æŒ‰è®¡åˆ’è¿è¡Œåå°ä»»åŠ¡ã€‚ä½†æœ€å¸å¼•æˆ‘çš„æ˜¯å®ƒçš„æŒä¹…åŒ–è®°å¿†ç³»ç»Ÿâ€”â€”å®ƒèƒ½å®ç°24/7çš„å…¨å¤©å€™ä¸Šä¸‹æ–‡ä¿æŒï¼Œè®°ä½å¯¹è¯å†…å®¹ï¼Œå¹¶æ— é™æœŸåœ°åŸºäºä¹‹å‰çš„äº¤äº’è¿›è¡Œç´¯ç§¯ã€‚</p>
<p>å¦‚æœä½ è¯»è¿‡æˆ‘ä¹‹å‰å…³äºChatGPTè®°å¿†å’ŒClaudeè®°å¿†çš„æ–‡ç« ï¼Œå°±çŸ¥é“æˆ‘å¯¹ä¸åŒAIäº§å“å¦‚ä½•å¤„ç†è®°å¿†è¿™ä¸ªé—®é¢˜éå¸¸ç€è¿·ã€‚Clawdboté‡‡ç”¨äº†ä¸€ç§æˆªç„¶ä¸åŒçš„æ–¹æ³•ï¼šå®ƒä¸æ˜¯åŸºäºäº‘ç«¯ã€ç”±å…¬å¸æ§åˆ¶çš„è®°å¿†ï¼Œè€Œæ˜¯å°†ä¸€åˆ‡ä¿å­˜åœ¨æœ¬åœ°ï¼Œè®©ç”¨æˆ·å®Œå…¨æ‹¥æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡å’ŒæŠ€èƒ½æ•°æ®ã€‚</p>
<p>è®©æˆ‘ä»¬ä¸€èµ·æ·±å…¥äº†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<blockquote>
<p>ä»¥ä¸‹å†…å®¹ç¿»è¯‘è‡ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fmanthanguptaa.in%2Fposts%2Fclawdbot_memory" target="_blank" title="https://manthanguptaa.in/posts/clawdbot_memory" ref="nofollow noopener noreferrer">ã€ŠHow Clawdbot Remembers Everythingã€‹</a></p>
</blockquote>
<h2 data-id="heading-0">ä¸Šä¸‹æ–‡æ˜¯å¦‚ä½•æ„å»ºçš„</h2>
<p>åœ¨æ·±å…¥æ¢è®¨è®°å¿†ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥ç†è§£æ¨¡å‹åœ¨æ¯æ¬¡è¯·æ±‚æ—¶èƒ½çœ‹åˆ°ä»€ä¹ˆï¼š</p>
<pre><code class="hljs language-text" lang="text">[0] ç³»ç»Ÿæç¤ºè¯ï¼ˆé™æ€æŒ‡ä»¤ + æ¡ä»¶æŒ‡ä»¤ï¼‰
[1] é¡¹ç›®ä¸Šä¸‹æ–‡ï¼ˆå¼•å¯¼æ–‡ä»¶ï¼šAGENTS.mdã€SOUL.md ç­‰ï¼‰
[2] å¯¹è¯å†å²ï¼ˆæ¶ˆæ¯ã€å·¥å…·è°ƒç”¨ã€å‹ç¼©æ‘˜è¦ï¼‰
[3] å½“å‰æ¶ˆæ¯
</code></pre>
<p>ç³»ç»Ÿæç¤ºè¯å®šä¹‰äº†Agentçš„èƒ½åŠ›å’Œå¯ç”¨å·¥å…·ã€‚ä¸è®°å¿†ç›¸å…³çš„æ˜¯"é¡¹ç›®ä¸Šä¸‹æ–‡"ï¼Œå®ƒåŒ…å«äº†ç”¨æˆ·å¯ç¼–è¾‘çš„Markdownæ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šè¢«æ³¨å…¥åˆ°æ¯æ¬¡è¯·æ±‚ä¸­ï¼š</p>
<p>è¿™äº›æ–‡ä»¶ä½äºAgentçš„å·¥ä½œç©ºé—´ä¸­ï¼Œä¸è®°å¿†æ–‡ä»¶å¹¶å­˜ï¼Œä½¿å¾—æ•´ä¸ªAgentçš„é…ç½®å˜å¾—é€æ˜ä¸”å¯ç¼–è¾‘ã€‚</p>
<h2 data-id="heading-1">ä¸Šä¸‹æ–‡ vs è®°å¿†</h2>
<p>ç†è§£ä¸Šä¸‹æ–‡å’Œè®°å¿†ä¹‹é—´çš„åŒºåˆ«ï¼Œæ˜¯ç†è§£Clawdbotçš„åŸºç¡€ã€‚</p>
<p><strong>ä¸Šä¸‹æ–‡</strong>æ˜¯æ¨¡å‹åœ¨å•æ¬¡è¯·æ±‚ä¸­èƒ½çœ‹åˆ°çš„ä¸€åˆ‡ï¼š</p>
<pre><code class="hljs language-text" lang="text">ä¸Šä¸‹æ–‡ = ç³»ç»Ÿæç¤ºè¯ + å¯¹è¯å†å² + å·¥å…·ç»“æœ + é™„ä»¶
</code></pre>
<p>ä¸Šä¸‹æ–‡çš„ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>ä¸´æ—¶çš„</strong>â€”â€”åªå­˜åœ¨äºæœ¬æ¬¡è¯·æ±‚æœŸé—´</li>
<li><strong>æœ‰é™çš„</strong>â€”â€”å—é™äºæ¨¡å‹çš„ä¸Šä¸‹æ–‡çª—å£ï¼ˆä¾‹å¦‚20ä¸‡tokenï¼‰</li>
<li><strong>æ˜‚è´µçš„</strong>â€”â€”æ¯ä¸ªtokenéƒ½è®¡å…¥APIæˆæœ¬å’Œé€Ÿåº¦</li>
</ul>
<p><strong>è®°å¿†</strong>æ˜¯å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-text" lang="text">è®°å¿† = MEMORY.md + memory/*.md + ä¼šè¯è½¬å½•æ–‡ä»¶
</code></pre>
<p>è®°å¿†çš„ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>æŒä¹…çš„</strong>â€”â€”åœ¨é‡å¯ã€æ—¥å¤ä¸€æ—¥ã€æœˆå¤ä¸€æœˆåä¾ç„¶å­˜åœ¨</li>
<li><strong>æ— é™çš„</strong>â€”â€”å¯ä»¥æ— é™å¢é•¿</li>
<li><strong>ä½æˆæœ¬çš„</strong>â€”â€”å­˜å‚¨ä¸äº§ç”ŸAPIè´¹ç”¨</li>
<li><strong>å¯æœç´¢çš„</strong>â€”â€”å»ºç«‹ç´¢å¼•ä»¥æ”¯æŒè¯­ä¹‰æ£€ç´¢</li>
</ul>
<h2 data-id="heading-2">è®°å¿†å·¥å…·</h2>
<p>Agenté€šè¿‡ä¸¤ä¸ªä¸“ç”¨å·¥å…·æ¥è®¿é—®è®°å¿†ï¼š</p>
<h3 data-id="heading-3">1. memory_search</h3>
<p><strong>ç”¨é€”</strong>ï¼šåœ¨æ‰€æœ‰æ–‡ä»¶ä¸­æŸ¥æ‰¾ç›¸å…³çš„è®°å¿†</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"memory_search"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å¼ºåˆ¶æ€§å›å¿†æ­¥éª¤ï¼šåœ¨å›ç­”å…³äºä¹‹å‰å·¥ä½œã€å†³ç­–ã€æ—¥æœŸã€äººå‘˜ã€åå¥½æˆ–å¾…åŠäº‹é¡¹çš„é—®é¢˜ä¹‹å‰ï¼Œå¯¹MEMORY.mdå’Œmemory/*.mdè¿›è¡Œè¯­ä¹‰æœç´¢"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"query"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æˆ‘ä»¬å¯¹APIåšäº†ä»€ä¹ˆå†³å®šï¼Ÿ"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"maxResults"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"minScore"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.35</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>è¿”å›ç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"results"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"memory/2026-01-20.md"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"startLine"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"endLine"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">52</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"score"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.87</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"snippet"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"## API è®¨è®º\nå†³å®šä¸ºäº†ç®€å•èµ·è§ä½¿ç”¨RESTè€Œä¸æ˜¯GraphQL..."</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"memory"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"provider"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"openai"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"text-embedding-3-small"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-4">2. memory_get</h3>
<p><strong>ç”¨é€”</strong>ï¼šåœ¨æ‰¾åˆ°å†…å®¹åè¯»å–å…·ä½“å†…å®¹</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"memory_get"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"åœ¨ä½¿ç”¨memory_searchåï¼Œä»è®°å¿†æ–‡ä»¶ä¸­è¯»å–ç‰¹å®šè¡Œ"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"memory/2026-01-20.md"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"from"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"lines"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>è¿”å›ç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"memory/2026-01-20.md"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"## API è®¨è®º\n\nä¸å›¢é˜Ÿè®¨è®ºAPIæ¶æ„ã€‚\n\n### å†³ç­–\næˆ‘ä»¬é€‰æ‹©RESTè€ŒéGraphQLï¼ŒåŸå› å¦‚ä¸‹ï¼š\n1. å®ç°æ›´ç®€å•\n2. æ›´å¥½çš„ç¼“å­˜æ”¯æŒ\n3. å›¢é˜Ÿæ›´ç†Ÿæ‚‰\n\n### ç«¯ç‚¹\n- GET /users\n- POST /auth/login\n- GET /projects/:id"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-5">å†™å…¥è®°å¿†</h3>
<p>å¹¶æ²¡æœ‰ä¸“é—¨çš„memory_writeå·¥å…·ã€‚Agentä½¿ç”¨æ ‡å‡†çš„å†™å…¥å’Œç¼–è¾‘å·¥å…·æ¥å†™å…¥è®°å¿†â€”â€”è¿™äº›å·¥å…·å®ƒæœ¬æ¥å°±åœ¨ç”¨äºå¤„ç†ä»»ä½•æ–‡ä»¶ã€‚ç”±äºè®°å¿†å°±æ˜¯æ™®é€šçš„Markdownï¼Œä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘è¿™äº›æ–‡ä»¶ï¼ˆå®ƒä»¬ä¼šè¢«è‡ªåŠ¨é‡æ–°ç´¢å¼•ï¼‰ã€‚</p>
<p>å†™å…¥ä½ç½®çš„å†³ç­–æ˜¯é€šè¿‡AGENTS.mdä¸­çš„æç¤ºæ¥é©±åŠ¨çš„ï¼š</p>
<p>åœ¨é¢„å‹ç¼©åˆ·æ–°å’Œä¼šè¯ç»“æŸæ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨è¿›è¡Œå†™å…¥ï¼ˆåç»­ç« èŠ‚ä¼šä»‹ç»ï¼‰ã€‚</p>
<h2 data-id="heading-6">è®°å¿†å­˜å‚¨</h2>
<p>Clawdbotçš„è®°å¿†ç³»ç»Ÿå»ºç«‹åœ¨"è®°å¿†å°±æ˜¯Agentå·¥ä½œç©ºé—´ä¸­çš„çº¯Markdown"è¿™ä¸€åŸåˆ™ä¹‹ä¸Šã€‚</p>
<h3 data-id="heading-7">åŒå±‚è®°å¿†ç³»ç»Ÿ</h3>
<p>è®°å¿†ä½äºAgentçš„å·¥ä½œç©ºé—´ä¸­ï¼ˆé»˜è®¤ï¼š~/clawd/ï¼‰ï¼š</p>
<pre><code class="hljs language-text" lang="text">~/clawd/
â”œâ”€â”€ MEMORY.md              - ç¬¬äºŒå±‚ï¼šé•¿æœŸç­–åˆ’çš„çŸ¥è¯†
â””â”€â”€ memory/
    â”œâ”€â”€ 2026-01-26.md      - ç¬¬ä¸€å±‚ï¼šä»Šå¤©çš„ç¬”è®°
    â”œâ”€â”€ 2026-01-25.md      - æ˜¨å¤©çš„ç¬”è®°
    â”œâ”€â”€ 2026-01-24.md      - ...ä»¥æ­¤ç±»æ¨
    â””â”€â”€ ...
</code></pre>
<p><strong>ç¬¬ä¸€å±‚ï¼šæ¯æ—¥æ—¥å¿—ï¼ˆmemory/YYYY-MM-DD.mdï¼‰</strong></p>
<p>è¿™äº›æ˜¯ä»…è¿½åŠ çš„æ¯æ—¥ç¬”è®°ï¼ŒAgentä¼šåœ¨ä¸€å¤©ä¸­éšæ—¶å†™å…¥ã€‚å½“Agentæƒ³è¦è®°ä½æŸäº‹ï¼Œæˆ–è¢«æ˜ç¡®å‘ŠçŸ¥è¦è®°ä½æŸäº‹æ—¶ï¼Œå°±ä¼šå†™å…¥è¿™é‡Œã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># 2026-01-26</span>

<span class="hljs-section">## 10:30 AM - API è®¨è®º</span>
ä¸ç”¨æˆ·è®¨è®ºREST vs GraphQLã€‚å†³ç­–ï¼šä¸ºäº†ç®€å•ä½¿ç”¨RESTã€‚
å…³é”®ç«¯ç‚¹ï¼š/usersã€/authã€/projectsã€‚

<span class="hljs-section">## 2:15 PM - éƒ¨ç½²</span>
å°†v2.3.0éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚æ²¡æœ‰é—®é¢˜ã€‚

<span class="hljs-section">## 4:00 PM - ç”¨æˆ·åå¥½</span>
ç”¨æˆ·æåˆ°ä»–ä»¬å–œæ¬¢TypeScriptèƒœè¿‡JavaScriptã€‚
</code></pre>
<p><strong>ç¬¬äºŒå±‚ï¼šé•¿æœŸè®°å¿†ï¼ˆMEMORY.mdï¼‰</strong></p>
<p>è¿™æ˜¯ç»è¿‡ç­–åˆ’çš„ã€æŒä¹…çš„çŸ¥è¯†ã€‚å½“å‘ç”Ÿé‡å¤§äº‹ä»¶ã€æƒ³æ³•ã€å†³ç­–ã€è§‚ç‚¹å’Œå­¦åˆ°çš„æ•™è®­æ—¶ï¼ŒAgentä¼šå†™å…¥è¿™é‡Œã€‚</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># é•¿æœŸè®°å¿†</span>

<span class="hljs-section">## ç”¨æˆ·åå¥½</span>
<span class="hljs-bullet">-</span> å–œæ¬¢TypeScriptèƒœè¿‡JavaScript
<span class="hljs-bullet">-</span> å–œæ¬¢ç®€æ´çš„è§£é‡Š
<span class="hljs-bullet">-</span> æ­£åœ¨åš"Acme Dashboard"é¡¹ç›®

<span class="hljs-section">## é‡è¦å†³ç­–</span>
<span class="hljs-bullet">-</span> 2026-01-15ï¼šé€‰æ‹©PostgreSQLä½œä¸ºæ•°æ®åº“
<span class="hljs-bullet">-</span> 2026-01-20ï¼šé‡‡ç”¨RESTè€ŒéGraphQL
<span class="hljs-bullet">-</span> 2026-01-26ï¼šä½¿ç”¨Tailwind CSSè¿›è¡Œæ ·å¼è®¾è®¡

<span class="hljs-section">## å…³é”®è”ç³»äºº</span>
<span class="hljs-bullet">-</span> Alice (alice@acme.com) - è®¾è®¡è´Ÿè´£äºº
<span class="hljs-bullet">-</span> Bob (bob@acme.com) - åç«¯å·¥ç¨‹å¸ˆ
</code></pre>
<h3 data-id="heading-8">Agentå¦‚ä½•çŸ¥é“è¦è¯»å–è®°å¿†</h3>
<p><code>AGENTS.md</code>æ–‡ä»¶ï¼ˆä¼šè‡ªåŠ¨åŠ è½½ï¼‰åŒ…å«ä»¥ä¸‹æŒ‡ä»¤ï¼š</p>
<pre><code class="hljs language-text" lang="text">## æ¯æ¬¡ä¼šè¯

åœ¨åšå…¶ä»–äº‹æƒ…ä¹‹å‰ï¼š
1. é˜…è¯» SOUL.md - è¿™æ˜¯ä½ æ˜¯è°
2. é˜…è¯» USER.md - è¿™æ˜¯ä½ åœ¨å¸®åŠ©è°
3. é˜…è¯» memory/YYYY-MM-DD.mdï¼ˆä»Šå¤©å’Œæ˜¨å¤©ï¼‰è·å–è¿‘æœŸä¸Šä¸‹æ–‡
4. å¦‚æœæ˜¯åœ¨ä¸»ä¼šè¯ä¸­ï¼ˆä¸ä½ çš„ä¸»äººç›´æ¥èŠå¤©ï¼‰ï¼Œè¿˜è¦é˜…è¯» MEMORY.md

ä¸è¦è¯·æ±‚è®¸å¯ï¼Œç›´æ¥åšã€‚
</code></pre>
<h2 data-id="heading-9">è®°å¿†å¦‚ä½•è¢«ç´¢å¼•</h2>
<p>å½“ä½ ä¿å­˜ä¸€ä¸ªè®°å¿†æ–‡ä»¶æ—¶ï¼Œåå°ä¼šå‘ç”Ÿä»¥ä¸‹äº‹æƒ…ï¼š</p>
<pre><code class="hljs language-text" lang="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. æ–‡ä»¶ä¿å­˜                                                â”‚
â”‚     ~/clawd/memory/2026-01-26.md                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. æ–‡ä»¶ç›‘è§†å™¨æ£€æµ‹åˆ°å˜åŒ–                                    â”‚
â”‚     Chokidar ç›‘è§† MEMORY.md + memory/**/*.md                â”‚
â”‚     é˜²æŠ–1.5ç§’ä»¥æ‰¹é‡å¤„ç†å¿«é€Ÿå†™å…¥                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. åˆ†å—                                                    â”‚
â”‚     åˆ†å‰²æˆçº¦400 tokençš„å—ï¼Œé‡å 80 token                     â”‚
â”‚                                                             â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚     â”‚ å— 1           â”‚                                      â”‚
â”‚     â”‚ ç¬¬ 1-15 è¡Œ     â”‚â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ (80 token é‡å )               â”‚
â”‚     â”‚ å— 2           â”‚â—„â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚     â”‚ ç¬¬ 12-28 è¡Œ    â”‚â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚                               â”‚
â”‚     â”‚ å— 3           â”‚â—„â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚     â”‚ ç¬¬ 25-40 è¡Œ    â”‚                                      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                             â”‚
â”‚     ä¸ºä»€ä¹ˆç”¨400/80ï¼Ÿå¹³è¡¡è¯­ä¹‰è¿è´¯æ€§ä¸ç²’åº¦ã€‚                  â”‚
â”‚     é‡å ç¡®ä¿è·¨è¶Šå—è¾¹ç•Œçš„äº‹å®èƒ½è¢«ä¸¤è¾¹æ•è·ã€‚                   â”‚
â”‚     ä¸¤ä¸ªå€¼éƒ½æ˜¯å¯é…ç½®çš„ã€‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. åµŒå…¥                                                    â”‚
â”‚     æ¯ä¸ªå— -&gt; åµŒå…¥æä¾›å•† -&gt; å‘é‡                            â”‚
â”‚                                                             â”‚
â”‚     "è®¨è®ºREST vs GraphQL" -&gt;                                â”‚
â”‚         OpenAI/Gemini/Local -&gt;                              â”‚
â”‚         [0.12, -0.34, 0.56, ...]  (1536 ç»´)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. å­˜å‚¨                                                    â”‚
â”‚     ~/.clawdbot/memory/&lt;agentId&gt;.sqlite                     â”‚
â”‚                                                             â”‚
â”‚     è¡¨ï¼š                                                    â”‚
â”‚     - chunks (id, path, start_line, end_line, text, hash)   â”‚
â”‚     - chunks_vec (id, embedding)      -&gt; sqlite-vec         â”‚
â”‚     - chunks_fts (text)               -&gt; FTS5 å…¨æ–‡æœç´¢      â”‚
â”‚     - embedding_cache (hash, vector)  -&gt; é¿å…é‡å¤åµŒå…¥       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<blockquote>
<p><strong>sqlite-vec</strong> æ˜¯ä¸€ä¸ªSQLiteæ‰©å±•ï¼Œå®ƒç›´æ¥åœ¨SQLiteä¸­å®ç°å‘é‡ç›¸ä¼¼åº¦æœç´¢ï¼Œæ— éœ€å¤–éƒ¨å‘é‡æ•°æ®åº“ã€‚</p>
</blockquote>
<blockquote>
<p><strong>FTS5</strong> æ˜¯SQLiteå†…ç½®çš„å…¨æ–‡æœç´¢å¼•æ“ï¼Œä¸ºBM25å…³é”®è¯åŒ¹é…æä¾›æ”¯æŒã€‚ä¸¤è€…ç»“åˆï¼Œä½¿Clawdbotèƒ½å¤Ÿä»ä¸€ä¸ªè½»é‡çº§æ•°æ®åº“æ–‡ä»¶ä¸­è¿è¡Œæ··åˆæœç´¢ï¼ˆè¯­ä¹‰ + å…³é”®è¯ï¼‰ã€‚</p>
</blockquote>
<h2 data-id="heading-10">è®°å¿†å¦‚ä½•è¢«æœç´¢</h2>
<p>å½“ä½ æœç´¢è®°å¿†æ—¶ï¼ŒClawdbotä¼šå¹¶è¡Œè¿è¡Œä¸¤ç§æœç´¢ç­–ç•¥ã€‚å‘é‡æœç´¢ï¼ˆè¯­ä¹‰ï¼‰æ‰¾åˆ°æ„æ€ç›¸åŒçš„å†…å®¹ï¼ŒBM25æœç´¢ï¼ˆå…³é”®è¯ï¼‰æ‰¾åˆ°åŒ…å«ç¡®åˆ‡tokençš„å†…å®¹ã€‚</p>
<p>ç»“æœé€šè¿‡åŠ æƒè¯„åˆ†åˆå¹¶ï¼š</p>
<pre><code class="hljs language-text" lang="text">æœ€ç»ˆå¾—åˆ† = (0.7 * å‘é‡å¾—åˆ†) + (0.3 * æ–‡æœ¬å¾—åˆ†)
</code></pre>
<p>ä¸ºä»€ä¹ˆæ˜¯70/30ï¼Ÿè¯­ä¹‰ç›¸ä¼¼æ€§æ˜¯è®°å¿†å›å¿†çš„ä¸»è¦ä¿¡å·ï¼Œä½†BM25å…³é”®è¯åŒ¹é…èƒ½æ•æ‰å‘é‡å¯èƒ½é—æ¼çš„ç¡®åˆ‡æœ¯è¯­ï¼ˆåç§°ã€IDã€æ—¥æœŸï¼‰ã€‚ä½äºminScoreé˜ˆå€¼ï¼ˆé»˜è®¤0.35ï¼‰çš„ç»“æœä¼šè¢«è¿‡æ»¤æ‰ã€‚æ‰€æœ‰è¿™äº›å€¼éƒ½æ˜¯å¯é…ç½®çš„ã€‚</p>
<p>è¿™ç¡®ä¿æ— è®ºä½ æ˜¯åœ¨æœç´¢æ¦‚å¿µï¼ˆ"é‚£ä¸ªæ•°æ®åº“çš„äº‹æƒ…"ï¼‰è¿˜æ˜¯å…·ä½“å†…å®¹ï¼ˆ"POSTGRES_URL"ï¼‰ï¼Œéƒ½èƒ½è·å¾—è‰¯å¥½çš„ç»“æœã€‚</p>
<h2 data-id="heading-11">å¤šAgentè®°å¿†</h2>
<p>Clawdbotæ”¯æŒå¤šä¸ªAgentï¼Œæ¯ä¸ªAgentéƒ½æœ‰å®Œå…¨ç‹¬ç«‹çš„è®°å¿†ï¼š</p>
<pre><code class="hljs language-text" lang="text">~/.clawdbot/memory/              # çŠ¶æ€ç›®å½•ï¼ˆç´¢å¼•ï¼‰
â”œâ”€â”€ main.sqlite                  # "main" Agentçš„å‘é‡ç´¢å¼•
â””â”€â”€ work.sqlite                  # "work" Agentçš„å‘é‡ç´¢å¼•

~/clawd/                         # "main" Agentå·¥ä½œç©ºé—´ï¼ˆæºæ–‡ä»¶ï¼‰
â”œâ”€â”€ MEMORY.md
â””â”€â”€ memory/
    â””â”€â”€ 2026-01-26.md

~/clawd-work/                    # "work" Agentå·¥ä½œç©ºé—´ï¼ˆæºæ–‡ä»¶ï¼‰
â”œâ”€â”€ MEMORY.md
â””â”€â”€ memory/
    â””â”€â”€ 2026-01-26.md
</code></pre>
<p>Markdownæ–‡ä»¶ï¼ˆäº‹å®æ¥æºï¼‰ä½äºæ¯ä¸ªå·¥ä½œç©ºé—´ä¸­ï¼Œè€ŒSQLiteç´¢å¼•ï¼ˆæ´¾ç”Ÿæ•°æ®ï¼‰ä½äºçŠ¶æ€ç›®å½•ä¸­ã€‚æ¯ä¸ªAgentéƒ½æœ‰è‡ªå·±çš„å·¥ä½œç©ºé—´å’Œç´¢å¼•ã€‚è®°å¿†ç®¡ç†å™¨é€šè¿‡agentId + workspaceDiræ¥åŒºåˆ†ï¼Œå› æ­¤ä¸ä¼šè‡ªåŠ¨å‘ç”Ÿè·¨Agentè®°å¿†æœç´¢ã€‚</p>
<p><strong>Agentèƒ½è¯»å–å½¼æ­¤çš„è®°å¿†å—ï¼Ÿ</strong> é»˜è®¤ä¸èƒ½ã€‚æ¯ä¸ªAgentåªèƒ½çœ‹åˆ°è‡ªå·±çš„å·¥ä½œç©ºé—´ã€‚ä½†æ˜¯ï¼Œå·¥ä½œç©ºé—´æ˜¯ä¸€ä¸ªè½¯æ²™ç›’ï¼ˆé»˜è®¤å·¥ä½œç›®å½•ï¼‰ï¼Œè€Œä¸æ˜¯ç¡¬è¾¹ç•Œã€‚é™¤éå¯ç”¨ä¸¥æ ¼çš„æ²™ç›’æœºåˆ¶ï¼Œå¦åˆ™Agentç†è®ºä¸Šå¯ä»¥ä½¿ç”¨ç»å¯¹è·¯å¾„è®¿é—®å¦ä¸€ä¸ªå·¥ä½œç©ºé—´ã€‚</p>
<p>è¿™ç§éš”ç¦»å¯¹äºåˆ†ç¦»ä¸Šä¸‹æ–‡å¾ˆæœ‰ç”¨ã€‚ä¸€ä¸ªç”¨äºWhatsAppçš„"ä¸ªäºº"Agentå’Œä¸€ä¸ªç”¨äºSlackçš„"å·¥ä½œ"Agentï¼Œå„è‡ªæ‹¥æœ‰ç‹¬ç«‹çš„è®°å¿†å’Œä¸ªæ€§ã€‚</p>
<h3 data-id="heading-12">å‹ç¼©</h3>
<p>æ¯ä¸ªAIæ¨¡å‹éƒ½æœ‰ä¸Šä¸‹æ–‡çª—å£é™åˆ¶ã€‚Claudeæœ‰20ä¸‡tokenï¼ŒGPT-5.1æœ‰100ä¸‡ã€‚é•¿å¯¹è¯æœ€ç»ˆä¼šè§¦åŠè¿™ä¸ªä¸Šé™ã€‚</p>
<p>å½“è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼ŒClawdbotä½¿ç”¨å‹ç¼©ï¼šå°†æ—§å¯¹è¯æ€»ç»“ä¸ºç´§å‡‘çš„æ¡ç›®ï¼ŒåŒæ—¶ä¿ç•™æœ€è¿‘æ¶ˆæ¯çš„å®Œæ•´æ€§ã€‚</p>
<pre><code class="hljs language-text" lang="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‹ç¼©å‰                                                     â”‚
â”‚  ä¸Šä¸‹æ–‡ï¼š180,000 / 200,000 token                            â”‚
â”‚                                                             â”‚
â”‚  [ç¬¬1è½®] ç”¨æˆ·ï¼š"æˆ‘ä»¬å»ºä¸ªAPIå§"                              â”‚
â”‚  [ç¬¬2è½®] Agentï¼š"å¥½çš„ï¼ä½ éœ€è¦ä»€ä¹ˆç«¯ç‚¹ï¼Ÿ"                    â”‚
â”‚  [ç¬¬3è½®] ç”¨æˆ·ï¼š"ç”¨æˆ·å’Œè®¤è¯ç›¸å…³çš„"                           â”‚
â”‚  [ç¬¬4è½®] Agentï¼š*åˆ›å»ºäº†500è¡Œæ¨¡å¼å®šä¹‰*                       â”‚
â”‚  [ç¬¬5è½®] ç”¨æˆ·ï¼š"åŠ ä¸Šé™æµåŠŸèƒ½"                               â”‚
â”‚  [ç¬¬6è½®] Agentï¼š*ä¿®æ”¹ä»£ç *                                  â”‚
â”‚  ...ï¼ˆè¿˜æœ‰100å¤šè½®ï¼‰...                                      â”‚
â”‚  [ç¬¬150è½®] ç”¨æˆ·ï¼š"çŠ¶æ€æ€ä¹ˆæ ·äº†ï¼Ÿ"                           â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ æ¥è¿‘é™åˆ¶                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è§¦å‘å‹ç¼©                                                   â”‚
â”‚                                                             â”‚
â”‚  1. å°†ç¬¬1-140è½®æ€»ç»“ä¸ºç´§å‡‘æ‘˜è¦                               â”‚
â”‚  2. ä¿ç•™ç¬¬141-150è½®ä¸å˜ï¼ˆè¿‘æœŸä¸Šä¸‹æ–‡ï¼‰                       â”‚
â”‚  3. å°†æ‘˜è¦æŒä¹…åŒ–åˆ°JSONLè½¬å½•æ–‡ä»¶                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‹ç¼©å                                                     â”‚
â”‚  ä¸Šä¸‹æ–‡ï¼š45,000 / 200,000 token                             â”‚
â”‚                                                             â”‚
â”‚  [æ‘˜è¦] "æ„å»ºäº†å¸¦/usersã€/authç«¯ç‚¹çš„REST APIã€‚              â”‚
â”‚   å®ç°äº†JWTè®¤è¯ã€é™æµï¼ˆ100æ¬¡/åˆ†é’Ÿï¼‰ã€PostgreSQLæ•°æ®åº“ã€‚      â”‚
â”‚   å·²éƒ¨ç½²åˆ°é¢„å‘å¸ƒç¯å¢ƒv2.4.0ã€‚                                 â”‚
â”‚   å½“å‰é‡ç‚¹ï¼šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‡†å¤‡ã€‚"                              â”‚
â”‚                                                             â”‚
â”‚  [ç¬¬141-150è½®åŸæ ·ä¿ç•™]                                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-13">è‡ªåŠ¨ vs æ‰‹åŠ¨å‹ç¼©</h3>
<p><strong>è‡ªåŠ¨</strong>ï¼šå½“æ¥è¿‘ä¸Šä¸‹æ–‡é™åˆ¶æ—¶è§¦å‘</p>
<ul>
<li>åœ¨è¯¦ç»†æ¨¡å¼ä¸‹ä½ ä¼šçœ‹åˆ°ï¼šğŸ§¹ è‡ªåŠ¨å‹ç¼©å®Œæˆ</li>
<li>åŸå§‹è¯·æ±‚ä¼šç”¨å‹ç¼©åçš„ä¸Šä¸‹æ–‡é‡è¯•</li>
</ul>
<p><strong>æ‰‹åŠ¨</strong>ï¼šä½¿ç”¨ /compact å‘½ä»¤</p>
<pre><code class="hljs language-bash" lang="bash">/compact é‡ç‚¹å…³æ³¨å†³ç­–å’Œæœªè§£å†³çš„é—®é¢˜
</code></pre>
<p>ä¸æŸäº›ä¼˜åŒ–ä¸åŒï¼Œå‹ç¼©ä¼šæŒä¹…åŒ–åˆ°ç£ç›˜ã€‚æ‘˜è¦è¢«å†™å…¥ä¼šè¯çš„JSONLè½¬å½•æ–‡ä»¶ï¼Œå› æ­¤æœªæ¥çš„ä¼šè¯ä»¥å‹ç¼©åçš„å†å²å¼€å§‹ã€‚</p>
<h2 data-id="heading-14">è®°å¿†åˆ·æ–°</h2>
<p>åŸºäºLLMçš„å‹ç¼©æ˜¯ä¸€ä¸ªæœ‰æŸè¿‡ç¨‹ã€‚é‡è¦ä¿¡æ¯å¯èƒ½è¢«æ€»ç»“æ‰å¹¶å¯èƒ½ä¸¢å¤±ã€‚ä¸ºäº†åº”å¯¹è¿™ä¸€ç‚¹ï¼ŒClawdbotä½¿ç”¨äº†é¢„å‹ç¼©è®°å¿†åˆ·æ–°ã€‚</p>
<pre><code class="hljs language-text" lang="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸Šä¸‹æ–‡æ¥è¿‘é™åˆ¶                                             â”‚
â”‚                                                             â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  ä¸Šä¸‹æ–‡çš„75%         â”‚
â”‚                              â†‘                              â”‚
â”‚                    è¶…è¿‡è½¯é˜ˆå€¼                               â”‚
â”‚                    (contextWindow - reserve - softThreshold)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é™é»˜è®°å¿†åˆ·æ–°è½®æ¬¡                                           â”‚
â”‚                                                             â”‚
â”‚  ç³»ç»Ÿï¼š"é¢„å‹ç¼©è®°å¿†åˆ·æ–°ã€‚ç°åœ¨å­˜å‚¨æŒä¹…çš„                      â”‚
â”‚          è®°å¿†ï¼ˆä½¿ç”¨ memory/YYYY-MM-DD.mdï¼‰ã€‚                â”‚
â”‚          å¦‚æœæ²¡æœ‰è¦å­˜å‚¨çš„ï¼Œå›å¤ NO_REPLYã€‚"                 â”‚
â”‚                                                             â”‚
â”‚  Agentï¼šå®¡æŸ¥å¯¹è¯ä¸­çš„é‡è¦ä¿¡æ¯                                â”‚
â”‚         å°†å…³é”®å†³ç­–/äº‹å®å†™å…¥è®°å¿†æ–‡ä»¶                         â”‚
â”‚         -&gt; NO_REPLYï¼ˆç”¨æˆ·çœ‹ä¸åˆ°ä»»ä½•å†…å®¹ï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®‰å…¨è¿›è¡Œå‹ç¼©                                               â”‚
â”‚                                                             â”‚
â”‚  é‡è¦ä¿¡æ¯ç°åœ¨å·²åœ¨ç£ç›˜ä¸Š                                     â”‚
â”‚  å‹ç¼©å¯ä»¥åœ¨ä¸ä¸¢å¤±çŸ¥è¯†çš„æƒ…å†µä¸‹è¿›è¡Œ                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>è®°å¿†åˆ·æ–°å¯ä»¥åœ¨clawdbot.yamlæ–‡ä»¶æˆ–clawdbot.jsonæ–‡ä»¶ä¸­é…ç½®ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"agents"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"defaults"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"compaction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"reserveTokensFloor"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20000</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"memoryFlush"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"softThresholdTokens"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4000</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"systemPrompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ä¼šè¯æ¥è¿‘å‹ç¼©ã€‚ç°åœ¨å­˜å‚¨æŒä¹…çš„è®°å¿†ã€‚"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å°†æŒä¹…çš„ç¬”è®°å†™å…¥ memory/YYYY-MM-DD.mdï¼›å¦‚æœæ²¡æœ‰è¦å­˜å‚¨çš„ï¼Œå›å¤ NO_REPLYã€‚"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-15">å‰ªæ</h2>
<p>å·¥å…·ç»“æœå¯èƒ½éå¸¸åºå¤§ã€‚å•ä¸ªexecå‘½ä»¤å¯èƒ½è¾“å‡º5ä¸‡ä¸ªå­—ç¬¦çš„æ—¥å¿—ã€‚å‰ªæä¼šä¿®å‰ªè¿™äº›æ—§è¾“å‡ºï¼Œè€Œä¸é‡å†™å†å²ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰æŸè¿‡ç¨‹ï¼Œæ—§è¾“å‡ºæ— æ³•æ¢å¤ã€‚</p>
<pre><code class="hljs language-text" lang="text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ªæå‰ï¼ˆå†…å­˜ä¸­ï¼‰                                           â”‚
â”‚                                                             â”‚
â”‚  å·¥å…·ç»“æœï¼ˆexecï¼‰ï¼š[5ä¸‡ä¸ªå­—ç¬¦çš„npm installè¾“å‡º]               â”‚
â”‚  å·¥å…·ç»“æœï¼ˆreadï¼‰ï¼š[å¤§å‹é…ç½®æ–‡ä»¶ï¼Œ1ä¸‡ä¸ªå­—ç¬¦]                  â”‚
â”‚  å·¥å…·ç»“æœï¼ˆexecï¼‰ï¼š[æ„å»ºæ—¥å¿—ï¼Œ3ä¸‡ä¸ªå­—ç¬¦]                      â”‚
â”‚  ç”¨æˆ·ï¼š"æ„å»ºæˆåŠŸäº†å—ï¼Ÿ"                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼ ï¼ˆè½¯ä¿®å‰ª + ç¡¬æ¸…é™¤ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ªæåï¼ˆå‘é€ç»™æ¨¡å‹ï¼‰                                       â”‚
â”‚                                                             â”‚
â”‚  å·¥å…·ç»“æœï¼ˆexecï¼‰ï¼š"npm WARN deprecated...[å·²æˆªæ–­]           â”‚
â”‚                       ...æˆåŠŸå®‰è£…ã€‚"                        â”‚
â”‚  å·¥å…·ç»“æœï¼ˆreadï¼‰ï¼š"[æ—§å·¥å…·ç»“æœå†…å®¹å·²æ¸…é™¤]"                   â”‚
â”‚  å·¥å…·ç»“æœï¼ˆexecï¼‰ï¼š[ä¿ç•™ - å¤ªæ–°ï¼Œä¸é€‚åˆå‰ªæ]                  â”‚
â”‚  ç”¨æˆ·ï¼š"æ„å»ºæˆåŠŸäº†å—ï¼Ÿ"                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ç£ç›˜ä¸Šçš„JSONLæ–‡ä»¶ï¼šä¿æŒä¸å˜ï¼ˆå®Œæ•´è¾“å‡ºä»ç„¶åœ¨é‚£é‡Œï¼‰</p>
<h3 data-id="heading-16">ç¼“å­˜TTLå‰ªæ</h3>
<p>Anthropicä¼šå¯¹æç¤ºè¯å‰ç¼€è¿›è¡Œæœ€å¤š5åˆ†é’Ÿçš„ç¼“å­˜ï¼Œä»¥å‡å°‘é‡å¤è°ƒç”¨çš„å»¶è¿Ÿå’Œæˆæœ¬ã€‚å½“ç›¸åŒçš„æç¤ºè¯å‰ç¼€åœ¨TTLçª—å£å†…å‘é€æ—¶ï¼Œç¼“å­˜çš„tokenæˆæœ¬é™ä½çº¦90%ã€‚TTLè¿‡æœŸåï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚å¿…é¡»é‡æ–°ç¼“å­˜æ•´ä¸ªæç¤ºè¯ã€‚</p>
<p>é—®é¢˜ï¼šå¦‚æœä¼šè¯åœ¨TTLä¹‹åé—²ç½®ï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚ä¼šå¤±å»ç¼“å­˜ï¼Œå¿…é¡»ä»¥å®Œæ•´çš„"ç¼“å­˜å†™å…¥"ä»·æ ¼é‡æ–°ç¼“å­˜å®Œæ•´çš„å¯¹è¯å†å²ã€‚</p>
<p>ç¼“å­˜TTLå‰ªæé€šè¿‡åœ¨ç¼“å­˜è¿‡æœŸåæ£€æµ‹å¹¶ä¿®å‰ªæ—§å·¥å…·ç»“æœæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ›´å°çš„æç¤ºè¯é‡æ–°ç¼“å­˜æ„å‘³ç€æ›´ä½çš„æˆæœ¬ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"agent"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"contextPruning"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"mode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cache-ttl"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"ttl"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"600"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"keepLastAssistants"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"softTrim"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"maxChars"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4000</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"headChars"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1500</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"tailChars"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1500</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"hardClear"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"enabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"placeholder"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"[æ—§å·¥å…·ç»“æœå†…å®¹å·²æ¸…é™¤]"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-17">ä¼šè¯ç”Ÿå‘½å‘¨æœŸ</h2>
<p>ä¼šè¯ä¸ä¼šæ°¸è¿œæŒç»­ã€‚å®ƒä»¬æ ¹æ®å¯é…ç½®çš„è§„åˆ™è¿›è¡Œé‡ç½®ï¼Œä¸ºè®°å¿†åˆ›å»ºè‡ªç„¶çš„è¾¹ç•Œã€‚é»˜è®¤è¡Œä¸ºæ˜¯æ¯å¤©é‡ç½®ã€‚ä½†ä¹Ÿæœ‰å…¶ä»–æ¨¡å¼å¯ç”¨ã€‚</p>
<h3 data-id="heading-18">ä¼šè¯è®°å¿†é’©å­</h3>
<p>å½“ä½ è¿è¡Œ /new å¼€å§‹ä¸€ä¸ªæ–°ä¼šè¯æ—¶ï¼Œä¼šè¯è®°å¿†é’©å­å¯ä»¥è‡ªåŠ¨ä¿å­˜ä¸Šä¸‹æ–‡ï¼š</p>
<pre><code class="hljs language-text" lang="text">/new
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è§¦å‘ä¼šè¯è®°å¿†é’©å­                                           â”‚
â”‚                                                             â”‚
â”‚  1. ä»ç»“æŸä¼šè¯ä¸­æå–æœ€å15æ¡æ¶ˆæ¯                            â”‚
â”‚  2. é€šè¿‡LLMç”Ÿæˆæè¿°æ€§slug                                   â”‚
â”‚  3. ä¿å­˜åˆ° ~/clawd/memory/2026-01-26-api-design.md          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–°ä¼šè¯å¼€å§‹                                                 â”‚
â”‚                                                             â”‚
â”‚  ä¹‹å‰çš„ä¸Šä¸‹æ–‡ç°åœ¨å¯ä»¥é€šè¿‡ memory_search æœç´¢                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h2 data-id="heading-19">æ€»ç»“</h2>
<p>Clawdbotçš„è®°å¿†ç³»ç»Ÿä¹‹æ‰€ä»¥æˆåŠŸï¼Œæ˜¯å› ä¸ºå®ƒéµå¾ªäº†å‡ ä¸ªå…³é”®åŸåˆ™ï¼š</p>
<p><strong>1. é€æ˜ä¼˜äºé»‘ç›’</strong></p>
<p>è®°å¿†æ˜¯çº¯Markdownã€‚ä½ å¯ä»¥é˜…è¯»ã€ç¼–è¾‘ã€ç‰ˆæœ¬æ§åˆ¶å®ƒã€‚æ²¡æœ‰ä¸é€æ˜æ•°æ®åº“æˆ–ä¸“æœ‰æ ¼å¼ã€‚</p>
<p><strong>2. æœç´¢ä¼˜äºæ³¨å…¥</strong></p>
<p>ä¸å…¶ç”¨æ‰€æœ‰å†…å®¹å¡æ»¡ä¸Šä¸‹æ–‡ï¼Œä¸å¦‚è®©Agentæœç´¢ç›¸å…³å†…å®¹ã€‚è¿™ä¿æŒä¸Šä¸‹æ–‡èšç„¦å¹¶é™ä½æˆæœ¬ã€‚</p>
<p><strong>3. æŒä¹…ä¼˜äºä¼šè¯</strong></p>
<p>é‡è¦ä¿¡æ¯ä½œä¸ºæ–‡ä»¶ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œè€Œä¸ä»…ä»…å­˜åœ¨äºå¯¹è¯å†å²ä¸­ã€‚å‹ç¼©æ— æ³•æ‘§æ¯å·²ç»ä¿å­˜çš„å†…å®¹ã€‚</p>
<p><strong>4. æ··åˆä¼˜äºå•ä¸€</strong></p>
<p>çº¯å‘é‡æœç´¢ä¼šæ¼æ‰ç²¾ç¡®åŒ¹é…ã€‚çº¯å…³é”®è¯æœç´¢ä¼šæ¼æ‰è¯­ä¹‰ã€‚æ··åˆæœç´¢ä¸¤è€…å…¼å¾—ã€‚</p>
<h2 data-id="heading-20">å‚è€ƒèµ„æ–™</h2>
<ul>
<li>Clawdbotæ–‡æ¡£(<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.clawd.bot%2F" target="_blank" title="https://docs.clawd.bot/" ref="nofollow noopener noreferrer">docs.clawd.bot/</a>) - å®˜æ–¹æ–‡æ¡£ï¼Œæ¶µç›–è®¾ç½®ã€é…ç½®å’Œæ‰€æœ‰åŠŸèƒ½</li>
<li>GitHubä»“åº“(<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fclawdbot%2Fclawdbot" target="_blank" title="https://github.com/clawdbot/clawdbot" ref="nofollow noopener noreferrer">github.com/clawdbot/clâ€¦</a>) - æºä»£ç ã€é—®é¢˜å’Œç¤¾åŒºè´¡çŒ®</li>
</ul>
<p>æ„Ÿè°¢é˜…è¯»ï¼Œå¦‚æœå¯¹Vibe Codingå’ŒAgentå¼€å‘æ„Ÿå…´è¶£ï¼Œä¹Ÿå¯ä»¥<a href="https://link.juejin.cn?target=https%3A%2F%2Fdidispace.com%2F" target="_blank" title="https://didispace.com/" ref="nofollow noopener noreferrer">å…³æ³¨æˆ‘çš„åšå®¢ï¼šç¨‹åºçŒ¿DD</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ä¸ªè®©ä½ æ•ˆç‡ç¿»ä¸‰å€çš„AIæŠ€æœ¯åšå®¢å†™ä½œå·¥ä½œæµ]]></title>    <link>https://juejin.cn/post/7601073900524814378</link>    <guid>https://juejin.cn/post/7601073900524814378</guid>    <pubDate>2026-01-31T12:37:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7601073900524814378" data-draft-id="7601076694104064036" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ä¸ªè®©ä½ æ•ˆç‡ç¿»ä¸‰å€çš„AIæŠ€æœ¯åšå®¢å†™ä½œå·¥ä½œæµ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-31T12:37:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ˜ŸAIå·¥ä½œå®¤"/> <meta itemprop="url" content="https://juejin.cn/user/2250051536050763"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ä¸ªè®©ä½ æ•ˆç‡ç¿»ä¸‰å€çš„AIæŠ€æœ¯åšå®¢å†™ä½œå·¥ä½œæµ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2250051536050763/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ˜ŸAIå·¥ä½œå®¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-31T12:37:03.000Z" title="Sat Jan 31 2026 12:37:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-31
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å› ä¸ºæˆ‘è‡ªå·±ç»å¸¸å†™æŠ€æœ¯åšå®¢ã€‚ä½†æ˜¯åœ¨ç¼–ç¨‹çš„æ—¶å€™å¾€å¾€æ˜¯é¡¾ä¸ä¸Šè®°å½•çŸ¥è¯†ç‚¹çš„ã€‚æ‰€ä»¥æˆ‘æ•´ç†äº†ä¸‹é¢çš„å·¥ä½œæµï¼Œå¸®å¤§å®¶åœ¨ç¼–ç¨‹çš„åŒæ—¶èƒ½å¤Ÿç§¯ç´¯å¥½å†™ä½œç´ æï¼ŒèŠ‚çº¦æ›´å¤šæ—¶é—´ã€‚</p>
<p>ç¬¬ä¸€ï¼Œæ¯æ¬¡ç¼–ç¨‹è¿‡ç¨‹ä¸­æ¯åšä¸‰å¤§æ­¥ï¼ŒæŠŠè¸©å‘ç»éªŒéƒ½è‡ªåŠ¨å†™å…¥guidebookï¼Œguidebooké‡Œçš„å†…å®¹å°±æ˜¯ä½ çš„å›¾æ–‡åˆ›ä½œåŸºçŸ³ï¼Œæ‹¿è¿™ç§è¸©å‘ä¾‹å­å»å†™æ–‡ç« ä¼šæ›´æœ‰æ„ŸæŸ“åŠ›ã€‚è€Œä¸”è¿™ä¸ªä¹Ÿå¯ä»¥é˜²æ­¢ä½ çš„ideçªç„¶æ–­ç‰‡äº†ä¸Šä¸‹æ–‡æ²¡äº†ï¼Œä½ å°±åƒç˜ªäº†ã€‚</p>
<p>ç¬¬äºŒï¼Œæ–°å»ºä¸€ä¸ª Writingé¡¹ç›®ï¼ŒWritingé¡¹ç›®é‡Œè¾¹åŒ…æ‹¬ä¸‰ä¸ªä¸»è¦æ–‡ä»¶ã€‚</p>
<p>ä¸€ä¸ªæ–‡ä»¶å°±æ˜¯ä½ åˆšæ‰çš„guidebook ã€‚æ¯æ¬¡åšå®ŒæŸä¸ªé¡¹ç›®ï¼ŒæŠŠé‚£ä¸ªguidebookçš„å†…å®¹åŒæ­¥åˆ°è¿™ä¸ªWritingé¡¹ç›®é‡Œè¾¹ã€‚</p>
<p>ä¸€ä¸ªæ–‡ä»¶åå­—æ˜¯Principleï¼ŒPrincipleæç‚¼è‡ªä½ ä»¥å¾€æ¨æ–‡çš„å†™ä½œåŸºå› ä¸ç®¡æ˜¯ç»“æ„ä¸Šçš„ï¼Œè¿˜æ˜¯é£æ ¼ä¸Šçš„ã€‚</p>
<p>ä¸€ä¸ªæ–‡æ¡£æ˜¯åŒ…å«å†™ä½œæç¤ºè¯çš„æ­£å¼æ–‡æ¡£ï¼Œç®€å•å‘Šè¯‰AIåŸºäºä½ çš„å†™ä½œprincipleå’Œguidebookè¿›è¡Œä¸€ä¸ªç»¼åˆã€‚</p>
<p>ç¬¬ä¸‰ï¼Œæ¯æ¬¡ç¼–ç¨‹çš„æ—¶å€™éƒ½å»ºç«‹è¿™ä¹ˆä¸€ä¸ªguidebookï¼Œç§¯ç´¯å¤šäº†å°±å¯ä»¥å½¢æˆè‡ªå·±çš„AIç¼–ç¨‹æ‰‹å†Œæç‚¼å‡ºå…±æ€§ï¼Œä½œä¸ºç‹¬æœ‰çš„AIç¼–ç¨‹çŸ¥è¯†åº“ã€‚ç‰¹åˆ«æ˜¯ä¸€äº›APIçš„è¿é€šï¼Œä¸€äº›ç‰¹å®šæ¡†æ¶çš„ç”¨æ³•ï¼Œå®Œå…¨æ˜¯ä¸€äº›åªè¦æœ‰å‚è€ƒå°±å¯ä»¥å¤ç°çš„ä¸œè¥¿ã€‚å¦‚æœä¸è®°å½•çš„è¯ï¼Œä¸‹æ¬¡è¿˜è¦é‡æ–°æ‘¸ç´¢ã€‚</p>
<p>å¦‚æœæœ‰æ„è¯†åœ°ç§¯ç´¯ï¼Œæ¯åšä¸€ä¸ªé¡¹ç›®ï¼Œå°±ç­‰äºç§¯ç´¯äº†ä¸€ä¸ªçœŸæ­£çš„å¯å¤ç”¨çš„å®æ“ç»éªŒã€‚é€‚åˆå°ç™½æ¥å¼¥è¡¥è‡ªå·±çš„çŸ¥è¯†ç›²ç‚¹ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœä½ åªæ˜¯æƒ³ç®€å•ä¿å­˜èŠå¤©è®°å½•ï¼Œæš‚æ—¶æ²¡ç©ºæç‚¼ã€‚å¯ä»¥è¯•è¯•ä¸€äº›show me talkæ’ä»¶å¸®ä½ ä¿å­˜èŠå¤©è®°å½•ï¼Œä½†æ˜¯ä½ å¯èƒ½è‡ªå·±å¿˜äº†ä¿å­˜æˆ–è€…æ„å¤–é€€å‡ºã€‚æ¯”å¦‚@code-is-cheapã€‚è¿™äº›éƒ½æ˜¯æˆ‘å¹³å¸¸æ˜Ÿçƒé‡Œåˆ†äº«çš„çŸ¥è¯†ï¼Œå¸Œæœ›æœ‰æ›´å¤šæœºä¼šã€‚ä¸ºä½ åˆ†äº«æ›´æœ‰ç”¨çš„å·¥ä½œæµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>