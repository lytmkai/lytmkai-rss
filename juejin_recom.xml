<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[é¸¿è’™å¼‚æ­¥å¹¶å‘ async/await æœ€ä½³å®è·µï¼Œä»£ç ç¬é—´ä¼˜é›…]]></title>    <link>https://juejin.cn/post/7595527937832861750</link>    <guid>https://juejin.cn/post/7595527937832861750</guid>    <pubDate>2026-01-16T08:00:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595527937832861750" data-draft-id="7595552420047585323" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¸¿è’™å¼‚æ­¥å¹¶å‘ async/await æœ€ä½³å®è·µï¼Œä»£ç ç¬é—´ä¼˜é›…"/> <meta itemprop="keywords" content="HarmonyOS,ArkTS,ArkUI"/> <meta itemprop="datePublished" content="2026-01-16T08:00:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¸¿è’™å¼‚æ­¥å¹¶å‘ async/await æœ€ä½³å®è·µï¼Œä»£ç ç¬é—´ä¼˜é›…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T08:00:48.000Z" title="Fri Jan 16 2026 08:00:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Helloï¼Œå…„å¼Ÿä»¬ï¼Œæˆ‘æ˜¯ V å“¥ï¼</p>
<p>è¿˜è®°å¾—ä»¥å‰å†™ Android æˆ–è€…æ—©æœŸ JavaScript çš„æ—¶å€™ï¼Œé‚£ä¸ªä¼ è¯´ä¸­çš„**â€œå›è°ƒåœ°ç‹±â€**å—ï¼Ÿ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ªä»£ç æ¼”ç¤ºï¼šè®©äººå´©æºƒçš„é‡‘å­—å¡”</span>
<span class="hljs-title function_">login</span>(user, <span class="hljs-function">(<span class="hljs-params">res1</span>) =&gt;</span> {
  <span class="hljs-title function_">getUserInfo</span>(res1.<span class="hljs-property">id</span>, <span class="hljs-function">(<span class="hljs-params">res2</span>) =&gt;</span> {
    <span class="hljs-title function_">getOrders</span>(res2.<span class="hljs-property">token</span>, <span class="hljs-function">(<span class="hljs-params">res3</span>) =&gt;</span> {
      <span class="hljs-title function_">getDetail</span>(res3.<span class="hljs-property">orderId</span>, <span class="hljs-function">(<span class="hljs-params">res4</span>) =&gt;</span> {
        <span class="hljs-comment">// ç»ˆäºç»“æŸäº†... ä»£ç å·²ç»ç¼©è¿›åˆ°å±å¹•å¤–è¾¹äº†</span>
      })
    })
  })
})
</code></pre>
<p>è¿™ç§ä»£ç ï¼Œç»´æŠ¤èµ·æ¥ç®€ç›´æ˜¯å™©æ¢¦ï¼ä½†åœ¨é¸¿è’™ ArkTS çš„ API 21 ç¯å¢ƒä¸‹ï¼Œå…„å¼Ÿä»¬åƒä¸‡åˆ«å†è¿™ä¹ˆå†™äº†ï¼ArkTS æ˜¯åŸºäº TypeScript çš„ï¼Œå®ƒåŸç”Ÿæ”¯æŒéå¸¸å¼ºå¤§çš„ <strong><code>async/await</code></strong> è¯­æ³•ã€‚</p>
<p>ä»Šå¤© V å“¥å°±å¸¦ä½ æŠŠè¿™æ®µâ€œé‡‘å­—å¡”â€æ‹å¹³ï¼Œç”¨ <strong>åŒæ­¥çš„é€»è¾‘å†™å¼‚æ­¥çš„ä»£ç </strong>ï¼Œä¼˜é›…å¾—åƒå–ä¸‹åˆèŒ¶ä¸€æ ·ï¼</p>
<hr/>
<h2 data-id="heading-0">æ ¸å¿ƒå¿ƒæ³•ï¼šæŠŠâ€œç­‰å¾…â€å˜æˆâ€œæš‚åœâ€</h2>
<p>å…„å¼Ÿä»¬ï¼Œè®°ä½ V å“¥è¿™ä¸¤ä¸ªå£è¯€ï¼š</p>
<ol>
<li><strong><code>async</code></strong>ï¼šåŠ åœ¨å‡½æ•°å®šä¹‰å‰é¢ï¼Œè¡¨ç¤ºâ€œè¿™é‡Œé¢æœ‰è€—æ—¶çš„æ´»å„¿â€ã€‚</li>
<li><strong><code>await</code></strong>ï¼šåŠ åœ¨è€—æ—¶çš„è°ƒç”¨å‰é¢ï¼Œè¡¨ç¤ºâ€œ<strong>ç­‰ç€è¿™å„¿å¹²å®Œï¼Œå†å»å¹²ä¸‹ä¸€è¡Œï¼Œä½†åˆ«æŠŠç•Œé¢å¡æ­»</strong>â€ã€‚</li>
</ol>
<p>æœ‰äº†è¿™ä¸¤ä¸ªç¥å™¨ï¼Œå¼‚æ­¥ä»£ç å†™å‡ºæ¥å°±åƒåœ¨å†™å°å­¦ä½œæ–‡ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œä¸€è¡Œä¸€è¡Œè¯»ï¼Œé€»è¾‘æ¸…æ™°æ— æ¯”ã€‚</p>
<hr/>
<h2 data-id="heading-1">å®æˆ˜ä»£ç æ¡ˆä¾‹</h2>
<p>ä¸ºäº†è®©å¤§å®¶ç›´è§‚æ„Ÿå—ï¼ŒV å“¥å†™äº†ä¸€ä¸ªå®Œæ•´çš„ Demoã€‚å’±ä»¬æ¨¡æ‹Ÿä¸‰ä¸ªå¸¸è§çš„çœŸå®åœºæ™¯ï¼š</p>
<ol>
<li><strong>ä¸²è¡Œæ‰§è¡Œ</strong>ï¼šå…ˆç™»å½•ï¼Œå†æ‹¿ç”¨æˆ·ä¿¡æ¯ã€‚</li>
<li><strong>å¹¶å‘æ‰§è¡Œ</strong>ï¼šåŒæ—¶æ‹‰å–â€œå¹¿å‘Šé…ç½®â€å’Œâ€œé¦–é¡µæ¨èâ€ã€‚</li>
<li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šä¼˜é›…åœ°æ•è·ç½‘ç»œé”™è¯¯ã€‚</li>
</ol>
<p><strong>æ“ä½œæ­¥éª¤ï¼š</strong> æ‰“å¼€ä½ çš„ DevEco Studio 6.0ï¼Œæ–°å»ºä¸€ä¸ª ArkTS é¡µé¢ï¼ŒæŠŠä¸‹é¢çš„ä»£ç å®Œæ•´å¤åˆ¶è¿›å»ï¼Œç›´æ¥è¿è¡Œï¼</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> promptAction <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.promptAction'</span>;

<span class="hljs-comment">/**
 * Vå“¥çš„æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚ç±»
 * åœ¨çœŸå®é¡¹ç›®ä¸­ï¼Œè¿™é‡Œä¼šæ¢æˆ httpRequest æˆ–è€… ç½‘ç»œåº“
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkSimulator</span> {
  <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥è€—æ—¶æ“ä½œï¼Œè¿”å› Promise</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">request</span>(<span class="hljs-attr">apiName</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">data</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">delay</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// æ¨¡æ‹Ÿ 20% çš„æ¦‚ç‡å¤±è´¥</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &lt; <span class="hljs-number">0.2</span>) {
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`<span class="hljs-subst">${apiName}</span> è¯·æ±‚å¤±è´¥ï¼Œç½‘ç»œä¸ç»™åŠ›ï¼`</span>));
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>(<span class="hljs-string">`<span class="hljs-subst">${apiName}</span> è¿”å›çš„æ•°æ®: <span class="hljs-subst">${data}</span>`</span>);
        }
      }, delay);
    });
  }
}

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">AsyncAwaitDemo</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">resultLog</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Vå“¥å‡†å¤‡å¥½è¾“å‡ºæ—¥å¿—äº†...'</span>;
  <span class="hljs-meta">@State</span> <span class="hljs-attr">isLoading</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'é¸¿è’™ async/await å®æˆ˜å®éªŒå®¤'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">20</span> })

      <span class="hljs-comment">// åœºæ™¯ä¸€ï¼šä¸²è¡Œæ‰§è¡Œ</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åœºæ™¯1ï¼šä¸²è¡Œæ‰§è¡Œ (ç™»å½• -&gt; è·å–ä¿¡æ¯)'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">15</span> })
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testSequential</span>();
        })

      <span class="hljs-comment">// åœºæ™¯äºŒï¼šå¹¶å‘æ‰§è¡Œ</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åœºæ™¯2ï¼šå¹¶å‘æ‰§è¡Œ (åŒæ—¶æ‹‰å–é…ç½®å’Œå¹¿å‘Š)'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">15</span> })
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testParallel</span>();
        })

      <span class="hljs-comment">// åœºæ™¯ä¸‰ï¼šå¼‚å¸¸æ•è·</span>
      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åœºæ™¯3ï¼šå¼‚å¸¸æ•è· (æ¨¡æ‹Ÿå¤±è´¥é‡è¯•)'</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">15</span> })
        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testErrorHandling</span>();
        })

      <span class="hljs-comment">// æ—¥å¿—æ˜¾ç¤ºåŒºåŸŸ</span>
      <span class="hljs-title class_">Column</span>() {
        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#333333'</span>)
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'40%'</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">15</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)
      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)
      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })

      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span>) {
        <span class="hljs-title class_">LoadingProgress</span>()
          .<span class="hljs-title function_">width</span>(<span class="hljs-number">30</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">30</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })
          .<span class="hljs-title function_">color</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>)
      }

    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">20</span> })
  }

  <span class="hljs-comment">/**
   * Vå“¥è§£æï¼šåœºæ™¯1 - ä¸²è¡Œæ‰§è¡Œ
   * ç‰¹ç‚¹ï¼šä¸€æ­¥æ¥ä¸€æ­¥ï¼Œä¸‹ä¸€æ­¥ä¾èµ–ä¸Šä¸€æ­¥çš„ç»“æœã€‚
   * ä»£ç é€»è¾‘ï¼šå®Œå…¨æ˜¯çº¿æ€§çš„ï¼ŒåƒåŒæ­¥ä»£ç ä¸€æ ·æ˜“è¯»ï¼
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testSequential</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> = <span class="hljs-string">'1. å¼€å§‹ç™»å½•...\n'</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Vå“¥é‡ç‚¹ï¼šawait ä¼šæš‚åœå‡½æ•°æ‰§è¡Œï¼Œç›´åˆ° Promise resolve</span>
      <span class="hljs-comment">// è¿™é‡Œæ¨¡æ‹Ÿå…ˆç™»å½•ï¼Œè€—æ—¶ 1000ms</span>
      <span class="hljs-keyword">let</span> loginRes = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'LoginAPI'</span>, <span class="hljs-string">'Token123'</span>, <span class="hljs-number">1000</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   <span class="hljs-subst">${loginRes}</span>\n`</span>;

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">'2. æ­£åœ¨è·å–ç”¨æˆ·ä¿¡æ¯...\n'</span>;
      <span class="hljs-comment">// ä¾èµ–ä¸Šé¢çš„ Tokenï¼Œç»§ç»­ await</span>
      <span class="hljs-keyword">let</span> userRes = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'GetUserInfo'</span>, <span class="hljs-string">'Vå“¥çš„å¤§å'</span>, <span class="hljs-number">800</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   <span class="hljs-subst">${userRes}</span>\n`</span>;

      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">'âœ… å…¨éƒ¨å®Œæˆï¼(ä¸²è¡Œæ€»è€—æ—¶çº¦ 1.8s)'</span>;
      
      promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'ä¸²è¡Œæ‰§è¡Œå®Œæˆ'</span> });

    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`âŒ å‡ºé”™äº†: <span class="hljs-subst">${error.message}</span>`</span>;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * Vå“¥è§£æï¼šåœºæ™¯2 - å¹¶å‘æ‰§è¡Œ
   * ç‰¹ç‚¹ï¼šä¸¤ä¸ªè¯·æ±‚äº’ä¸ä¾èµ–ï¼ŒåŒæ—¶å‘å‡ºï¼Œè°å…ˆå›æ¥è°å…ˆç»“æŸã€‚
   * ä¼˜åŠ¿ï¼šé€Ÿåº¦æœ€å¿«ï¼æ€»è€—æ—¶ = ä¸¤ä¸ªè¯·æ±‚ä¸­æœ€æ…¢çš„é‚£ä¸ªï¼Œè€Œä¸æ˜¯ä¸¤è€…ä¹‹å’Œã€‚
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testParallel</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> = <span class="hljs-string">'1. åŒæ—¶å¯åŠ¨å¤šä¸ªä»»åŠ¡...\n'</span>;

    <span class="hljs-comment">// è®°å½•å¼€å§‹æ—¶é—´</span>
    <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Vå“¥é‡ç‚¹ï¼šPromise.all()</span>
      <span class="hljs-comment">// æŠŠæ‰€æœ‰è¦å¹¶å‘çš„ Promise æ”¾è¿›æ•°ç»„é‡Œ</span>
      <span class="hljs-comment">// await ä¼šç­‰æ•°ç»„é‡Œæ‰€æœ‰çš„ Promise éƒ½ resolve æ‰ç»§ç»­</span>
      <span class="hljs-keyword">let</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
        <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'GetConfig'</span>, <span class="hljs-string">'ç³»ç»Ÿé…ç½®'</span>, <span class="hljs-number">1500</span>), <span class="hljs-comment">// å‡è®¾è¿™ä¸ªæ…¢</span>
        <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'GetBanner'</span>, <span class="hljs-string">'å¹¿å‘Šå›¾ç‰‡'</span>, <span class="hljs-number">1000</span>)  <span class="hljs-comment">// å‡è®¾è¿™ä¸ªå¿«</span>
      ]);

      <span class="hljs-comment">// results æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé¡ºåºå’Œä½ ä¼ å…¥çš„é¡ºåºä¸€è‡´ï¼Œä¸ç®¡è°å…ˆå›æ¥</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   <span class="hljs-subst">${results[<span class="hljs-number">0</span>]}</span>\n`</span>; <span class="hljs-comment">// ç¬¬ä¸€ä¸ªç»“æœ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   <span class="hljs-subst">${results[<span class="hljs-number">1</span>]}</span>\n`</span>; <span class="hljs-comment">// ç¬¬äºŒä¸ªç»“æœ</span>

      <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`âœ… å…¨éƒ¨å®Œæˆï¼(å¹¶å‘æ€»è€—æ—¶çº¦ <span class="hljs-subst">${duration}</span>msï¼Œæ¯”ä¸²è¡Œå¿«ï¼)`</span>;
      
      promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'å¹¶å‘æ‰§è¡Œå®Œæˆ'</span> });

    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`âŒ å‡ºé”™äº†: <span class="hljs-subst">${error.message}</span>`</span>;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">/**
   * Vå“¥è§£æï¼šåœºæ™¯3 - å¼‚å¸¸å¤„ç†
   * ç‰¹ç‚¹ï¼šasync/await ä¸‹ï¼Œæˆ‘ä»¬ç”¨ try...catch...finally ä»£æ›¿ .then().catch()
   * è¿™æ¯”ä¼ ç»Ÿçš„ Promise é“¾å¼è°ƒç”¨è¦ç›´è§‚å¾—å¤šï¼Œåƒå¤„ç† Java å¼‚å¸¸ä¸€æ ·èˆ’æœã€‚
   */</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testErrorHandling</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> = <span class="hljs-string">'å°è¯•å‘é€è¯·æ±‚ (æ¨¡æ‹Ÿ20%å¤±è´¥ç‡)...\n'</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è¿™é‡Œçš„è¯·æ±‚å¯èƒ½ä¼šæŠ›å‡º Error</span>
      <span class="hljs-keyword">let</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NetworkSimulator</span>.<span class="hljs-title function_">request</span>(<span class="hljs-string">'RiskyAPI'</span>, <span class="hljs-string">'è¯•è¯•è¿æ°”'</span>, <span class="hljs-number">1000</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   æˆåŠŸ: <span class="hljs-subst">${data}</span>`</span>;
      promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·æ±‚æˆåŠŸ'</span> });

    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-comment">// Vå“¥é‡ç‚¹ï¼šä¸€æ—¦ä»»ä½•ä¸€æ­¥ await æŠ¥é”™ï¼Œç›´æ¥è·³è¿› catch</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   æ•è·åˆ°å¼‚å¸¸: <span class="hljs-subst">${error.message}</span>\n`</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultLog</span> += <span class="hljs-string">`   è¿™é‡Œå¯ä»¥è¿›è¡Œé‡è¯•é€»è¾‘...`</span>;
      
      promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·æ±‚è¢«æ‹¦æˆª'</span> });

    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-comment">// Vå“¥é‡ç‚¹ï¼šfinally æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ</span>
      <span class="hljs-comment">// é€‚åˆç”¨æ¥å…³é—­ Loading å¼¹çª—</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isLoading</span> = <span class="hljs-literal">false</span>;
    }
  }
}
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6818be9281524d31a73fff7d7edfe3d9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aiB5ZOl54ix57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769155247&amp;x-signature=zL9R6ZeXyZSmko98g2VPgKpHfNU%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">V å“¥çš„ä»£ç æ·±åº¦è§£æ</h2>
<p>å…„å¼Ÿä»¬ï¼Œä»£ç èƒ½è·‘äº†ï¼Œå’±ä»¬å¾—æ‡‚åŸç†ï¼Œä¸ç„¶é¢è¯•çš„æ—¶å€™è¦æŒ‚ï¼</p>
<h3 data-id="heading-3">1. ä¸ºä»€ä¹ˆ async/await ä¸ä¼šå¡æ­»ç•Œé¢ï¼Ÿ</h3>
<p>è¿™å°±æ˜¯å¹¶å‘ç¼–ç¨‹çš„é­”åŠ›ã€‚
å½“ä½ å†™ <code>let res = await someRequest()</code> çš„æ—¶å€™ï¼ŒArkTS çš„è¿è¡Œæ—¶ä¼šæŠŠ<strong>å½“å‰ä»»åŠ¡çš„æŒ‚èµ·</strong>ï¼ŒæŠŠä¸»çº¿ç¨‹çš„æ§åˆ¶æƒäº¤è¿˜ç»™ UI ç³»ç»Ÿã€‚
è¿™å°±å¥½æ¯”ä½ å»æ’é˜Ÿä¹°å¥¶èŒ¶ï¼Œä½ å«æœåŠ¡å‘˜åšå¥¶èŒ¶ï¼ˆå‘èµ·è¯·æ±‚ï¼‰ï¼Œä½ ç«™åœ¨æ—è¾¹ç­‰ï¼ˆawaitï¼‰ï¼Œä½†**åº—é‡Œçš„å…¶ä»–äººï¼ˆUIçº¿ç¨‹ï¼‰**ä¾ç„¶å¯ä»¥ç»§ç»­è¿›åº—ä¹°ä¸œè¥¿ã€‚åªæœ‰å½“ä½ çš„å¥¶èŒ¶å¥½äº†ï¼ˆPromise resolveï¼‰ï¼Œä½ æ‰æ‹¿ç€å¥¶èŒ¶èµ°äººï¼ˆä»£ç ç»§ç»­å¾€ä¸‹èµ°ï¼‰ã€‚</p>
<h3 data-id="heading-4">2. Promise.all æ˜¯æ€§èƒ½ä¼˜åŒ–çš„åˆ©å™¨</h3>
<p>åœ¨åœºæ™¯ 2 ä¸­ï¼ŒV å“¥æ¼”ç¤ºäº† <code>Promise.all</code>ã€‚
å¦‚æœä½ çš„é¦–é¡µæœ‰ 5 ä¸ªæ¥å£ï¼Œäº’ä¸ä¾èµ–ï¼Œä½ åƒä¸‡åˆ«å†™ 5 è¡Œ awaitï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ é”™è¯¯å†™æ³•ï¼šæ…¢å¾—è¦æ­»</span>
<span class="hljs-keyword">let</span> a = <span class="hljs-keyword">await</span> <span class="hljs-title function_">req1</span>(); <span class="hljs-comment">// ç­‰1ç§’</span>
<span class="hljs-keyword">let</span> b = <span class="hljs-keyword">await</span> <span class="hljs-title function_">req2</span>(); <span class="hljs-comment">// å†ç­‰1ç§’</span>
<span class="hljs-comment">// ... æ€»è€—æ—¶ 5ç§’</span>
</code></pre>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âœ… V å“¥æ­£ç¡®å†™æ³•ï¼šé£å¿«</span>
<span class="hljs-keyword">let</span> results = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">req1</span>(), <span class="hljs-title function_">req2</span>(), <span class="hljs-title function_">req3</span>(), <span class="hljs-title function_">req4</span>(), <span class="hljs-title function_">req5</span>()]);
<span class="hljs-comment">// æ€»è€—æ—¶ = æœ€æ…¢çš„é‚£ä¸ªæ¥å£ (å‡è®¾æ˜¯ 1.2ç§’)</span>
</code></pre>
<p>è¿™å¯æ˜¯å®æ‰“å®çš„æ€§èƒ½æå‡ï¼Œç”¨æˆ·æ‰“å¼€ App çš„é€Ÿåº¦ç›´æ¥è‚‰çœ¼å¯è§å˜å¿«ï¼</p>
<h3 data-id="heading-5">3. ä¸è¦å¿˜è®°äº† try-catch</h3>
<p>ä»¥å‰å†™ Promise é“¾ï¼Œå¦‚æœä¸åŠ  <code>.catch()</code>ï¼ŒæŠ¥é”™äº†å¯èƒ½å°±åƒçŸ³æ²‰å¤§æµ·ï¼Œé™é»˜å¤±è´¥ã€‚
ç”¨äº† <code>async/await</code>ï¼Œ<strong>ä¸€å®šè¦</strong> åŒ…è£¹åœ¨ <code>try...catch</code> é‡Œã€‚è¿™æ˜¯å¯¹è‡ªå·±ä»£ç è´Ÿè´£ï¼Œä¹Ÿæ˜¯å¯¹ç”¨æˆ·è´Ÿè´£ã€‚</p>
<hr/>
<h2 data-id="heading-6">æ€»ç»“</h2>
<p>æ¥æ¥æ¥ï¼ŒV å“¥ç¨å¾®å°ç»“ä¸€ä¸‹ï¼š</p>
<ol>
<li><strong>é€»è¾‘å¤æ‚ï¼Ÿ</strong> ç”¨ <code>async/await</code> æ‹å¹³é‡‘å­—å¡”ã€‚</li>
<li><strong>è¯·æ±‚å¤šä¸”æ…¢ï¼Ÿ</strong> ç”¨ <code>Promise.all</code> å¹¶è¡ŒåŠ é€Ÿã€‚</li>
<li><strong>æ€•å‡ºé”™ï¼Ÿ</strong> ç”¨ <code>try/catch</code> ç¨³ç¨³å…œåº•ã€‚</li>
</ol>
<p>åœ¨ DevEco Studio 6.0 é‡Œï¼Œè¿™å¥—ç»„åˆæ‹³ç”¨ç†Ÿç»ƒäº†ï¼Œä½ çš„ä»£ç è´¨é‡å’Œå¼€å‘æ•ˆç‡ç»å¯¹èƒ½ç”©å¼€åŒè¡Œä¸€æ¡è¡—ã€‚</p>
<p>æˆ‘æ˜¯ V å“¥ï¼Œæ‹’ç»å›è°ƒåœ°ç‹±ï¼Œä»ä»Šå¤©å¼€å§‹ï¼å’±ä»¬ä¸‹æœŸè§ï¼ğŸ‘‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ”¥1ç¯‡ææ‡‚AIé€šè¯†:å¤§ç™½è¯æ‹†è§£æ ¸å¿ƒç‚¹]]></title>    <link>https://juejin.cn/post/7595610998033727515</link>    <guid>https://juejin.cn/post/7595610998033727515</guid>    <pubDate>2026-01-16T07:25:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595610998033727515" data-draft-id="7595626157909213193" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ”¥1ç¯‡ææ‡‚AIé€šè¯†:å¤§ç™½è¯æ‹†è§£æ ¸å¿ƒç‚¹"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-16T07:25:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ”¥1ç¯‡ææ‡‚AIé€šè¯†:å¤§ç™½è¯æ‹†è§£æ ¸å¿ƒç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T07:25:11.000Z" title="Fri Jan 16 2026 07:25:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šå¢æ—­</p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>éšç€ AI æŠ€æœ¯ä»å®éªŒå®¤èµ°å‘æ—¥å¸¸ï¼Œâ€œæœºå™¨å­¦ä¹ â€â€œå¤§æ¨¡å‹â€â€œTransformerâ€â€œMOEâ€ ç­‰è¯æ±‡å·²ä¸å†æ˜¯æŠ€æœ¯åœˆçš„ä¸“å±ã€‚ä»æ™ºèƒ½èŠå¤©åŠ©æ‰‹åˆ°ç”µå•†æ¨èï¼Œä»è¯­éŸ³è¯†åˆ«åˆ°è‡ªåŠ¨é©¾é©¶ï¼ŒAI æ­£ä»¥å¤šå…ƒå½¢æ€èå…¥ç”Ÿæ´»ã€‚è¿™ç¯‡æ–‡ç« æŒ‰ â€œåŸºç¡€â†’æ ¸å¿ƒâ†’ä¼˜åŒ–â†’è½åœ°â†’å·¥å…·â†’æœ¯è¯­â€ çš„é€»è¾‘ï¼Œç”¨æœ€é€šä¿—çš„å¤§ç™½è¯ï¼ŒæŠŠ AI é€šè¯†æŠ€æœ¯ç‚¹è®²é€ã€‚å¸®åŠ©ä½ æˆ‘ä»–å¥¹å»ºç«‹æ›´å®Œæ•´çš„ AI è®¤çŸ¥æ¡†æ¶ï¼Œç†è§£æŠ€æœ¯èƒŒåçš„æ ¸å¿ƒé€»è¾‘ä¸å®é™…ä»·å€¼ï¼Œâ€œçœ‹é€â€ AI æŠ€æœ¯çš„åº•å±‚é€»è¾‘ï¼Œè®©å¤æ‚æ¦‚å¿µå˜å¾—æ¸…æ™°æ˜“æ‡‚ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-1">ä¸€ã€åŸºç¡€æ¦‚å¿µï¼ˆææ‡‚ AI çš„ â€œåº•å±‚é€»è¾‘â€ï¼‰</h2>
<h3 data-id="heading-2">1. ä»€ä¹ˆæ˜¯ AIï¼ˆäººå·¥æ™ºèƒ½ï¼‰ï¼Ÿ</h3>
<p>AI æœ¬è´¨å°±æ˜¯ â€œè®©æœºå™¨åƒäººä¸€æ ·æ€è€ƒã€å¹²æ´»â€ çš„æŠ€æœ¯ä½“ç³» â€”â€” ä¸ç”¨äººä¸€æ­¥æ­¥æŒ‡æŒ¥ï¼Œæœºå™¨èƒ½è‡ªå·±å­¦è§„å¾‹ã€åšå†³ç­–ã€‚æ¯”å¦‚æ‰‹æœºäººè„¸è¯†åˆ«ã€èŠå¤©æœºå™¨äººã€è‡ªåŠ¨é©¾é©¶ï¼Œéƒ½æ˜¯ AI çš„å…·ä½“åº”ç”¨ã€‚å®ƒä¸æ˜¯å•ä¸€æŠ€æœ¯ï¼Œè€Œæ˜¯ä¸€å †æŠ€æœ¯çš„ â€œæ€»ç§°â€ï¼Œå°±åƒ â€œå®¶ç”µâ€ åŒ…å«å†°ç®±ã€ç”µè§†ä¸€æ ·ã€‚è¿™å¼ ç½‘ä¸Šæµè¡Œçš„å›¾æ¦‚è¿°äº†äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰éšç€æ—¶é—´æ¨ç§»çš„å‘å±•å†ç¨‹ï¼Œä»æ—©æœŸé˜¶æ®µåˆ°æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ä»¥åŠå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å‡ºç°ã€‚</p>
<p>ï»¿</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/daa11585169c437f8b058f602f61fc0a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153111&amp;x-signature=I7cedMjtba%2FN8BFKucvxk4dKCJA%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<h3 data-id="heading-3">2. ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ã€å¼ºåŒ–å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ï¼Œå®ƒä»¬çš„å…³ç³»ï¼Ÿ</h3>
<p>è¿™ä»¨æ˜¯ AI çš„ â€œæ ¸å¿ƒæ–¹æ³•è®ºâ€ï¼Œæ˜¯ â€œå¤§åœˆå¥—å°åœˆâ€ çš„å…³ç³»ï¼š</p>
<p>â€¢<strong>æœºå™¨å­¦ä¹ </strong>ï¼šAI çš„ â€œåŸºç¡€å­¦ä¹ æ³•â€â€”â€” è®©æœºå™¨åƒ â€œå­¦ç”Ÿåˆ·é¢˜â€ï¼Œä»æ•°æ®é‡Œè‡ªå·±æ‰¾è§„å¾‹ï¼ˆæ¯”å¦‚çœ‹ 1000 å¼ çŒ«çš„ç…§ç‰‡ï¼Œè‡ªå·±æ€»ç»“ â€œå°–è€³æœµ = çŒ«â€ï¼‰ï¼Œä¸ç”¨äººé€æ¡æ•™è§„åˆ™ã€‚</p>
<p>â€¢<strong>æ·±åº¦å­¦ä¹ </strong>ï¼šæœºå™¨å­¦ä¹ çš„ â€œé«˜çº§ç‰ˆâ€â€”â€” ç»™æœºå™¨é…äº† â€œå¤šå±‚æ€è€ƒå¤§è„‘â€ï¼ˆç¥ç»ç½‘ç»œï¼‰ï¼Œèƒ½åˆ†å±‚æŒ–æ•°æ®çš„æ·±å±‚è§„å¾‹ï¼ˆæ¯”å¦‚å…ˆçœ‹çŒ«çš„è½®å»“ï¼Œå†çœ‹ç»†èŠ‚ï¼Œæœ€ååˆ¤æ–­ï¼‰ï¼Œé€‚åˆå¤„ç†å›¾ç‰‡ã€é•¿æ–‡æœ¬ç­‰å¤æ‚ä»»åŠ¡ã€‚</p>
<p>â€¢<strong>å¼ºåŒ–å­¦ä¹ </strong>ï¼šæœºå™¨å­¦ä¹ çš„ â€œç‰¹è®­æ³•â€â€”â€” è®©æœºå™¨åƒ â€œå® ç‰©å­¦æŠ€èƒ½â€ï¼Œåšå¯¹äº†ç»™å¥–åŠ±ï¼ˆèµ¢æ£‹åŠ åˆ†ï¼‰ï¼Œåšé”™äº†ç»™æƒ©ç½šï¼ˆè¾“æ£‹æ‰£åˆ†ï¼‰ï¼Œåå¤è¯•é”™åä¼˜åŒ–ç­–ç•¥ï¼Œæ¯”å¦‚ AI ç©æ¸¸æˆã€ä¸‹å›´æ£‹éƒ½é å®ƒã€‚</p>
<p>å…³ç³»æ€»ç»“ï¼šæœºå™¨å­¦ä¹ æ˜¯ â€œæ€»æ–¹æ³•â€ï¼Œæ·±åº¦å­¦ä¹ æ˜¯ â€œé«˜çº§åˆ†æ”¯â€ï¼Œå¼ºåŒ–å­¦ä¹ æ˜¯ â€œè®­ç»ƒæŠ€å·§â€ï¼Œä¸‰è€…å¸¸æ­é…ä½¿ç”¨ï¼ˆæ¯”å¦‚ ChatGPT ç”¨æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œé å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–å›ç­”ï¼‰ã€‚</p>
<h3 data-id="heading-4">3. æœºå™¨å­¦ä¹ ä¸‰å¤§èŒƒå¼</h3>
<p>èŒƒå¼å°±æ˜¯ â€œæ•™æœºå™¨å¹²æ´»çš„å…·ä½“æ–¹å¼â€ï¼Œæ ¸å¿ƒåŒºåˆ«æ˜¯ â€œç»™ä¸ç»™æœºå™¨â€˜æ ‡å‡†ç­”æ¡ˆâ€™â€ï¼ˆæ ‡å‡†ç­”æ¡ˆå« â€œæ ‡ç­¾â€ï¼Œæ¯”å¦‚ â€œè¿™å¼ æ˜¯çŒ«â€ï¼‰ï¼š</p>





























<table><thead><tr><th>èŒƒå¼ç±»å‹</th><th>é€šä¿—ç±»æ¯”</th><th>æ ¸å¿ƒé€»è¾‘</th><th>å®é™…åº”ç”¨</th></tr></thead><tbody><tr><td>ç›‘ç£å­¦ä¹ </td><td>åš â€œå¸¦ç­”æ¡ˆçš„ä¹ é¢˜å†Œâ€</td><td>ç»™æœºå™¨çš„æ‰€æœ‰æ•°æ®éƒ½æ ‡å¥½ â€œå¯¹é”™ / ç»“æœâ€ï¼Œæœºå™¨å­¦å®Œåç›´æ¥å¥—ç”¨è§„å¾‹</td><td>åƒåœ¾é‚®ä»¶è¯†åˆ«ã€ç¿»è¯‘è½¯ä»¶ã€å›¾ç‰‡åˆ†ç±»</td></tr><tr><td>æ— ç›‘ç£å­¦ä¹ </td><td>æ•´ç† â€œæ— æ ‡ç­¾çš„æ‚ç‰©â€</td><td>åªç»™æœºå™¨åŸå§‹æ•°æ®ï¼Œä¸æ ‡ç­”æ¡ˆï¼Œè®©å®ƒè‡ªå·±æ‰¾åˆ†ç±» / è§„å¾‹</td><td>ç”µå•† â€œçŒœä½ å–œæ¬¢â€ã€å®¢æˆ·ç¾¤ä½“åˆ’åˆ†ã€å¼‚å¸¸äº¤æ˜“æ£€æµ‹</td></tr><tr><td>åŠç›‘ç£å­¦ä¹ </td><td>åš â€œä¸€åŠæœ‰ç­”æ¡ˆçš„ä¹ é¢˜å†Œâ€</td><td>å°‘é‡æ•°æ®æ ‡ç­”æ¡ˆï¼ˆæ•™åŸºç¡€è§„å¾‹ï¼‰ï¼Œå¤§é‡æ•°æ®æ— ç­”æ¡ˆï¼ˆè®©æœºå™¨ä¸¾ä¸€åä¸‰ï¼‰</td><td>æ–¹è¨€è¯†åˆ«ã€ç½•è§ç–¾ç—…è¯Šæ–­ï¼ˆæ ‡æ³¨æ•°æ®å°‘çš„åœºæ™¯ï¼‰</td></tr></tbody></table>
<p>è¡¥å……ï¼šå¼ºåŒ–å­¦ä¹ ä¹Ÿå¸¸è¢«å•ç‹¬åˆ—ä¸ºä¸€ç±»ï¼Œæ ¸å¿ƒæ˜¯ â€œé å¥–åŠ± / æƒ©ç½šè¯•é”™å­¦ä¹ â€ã€‚</p>
<h3 data-id="heading-5">4. ä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ</h3>
<p>ç¥ç»ç½‘ç»œæ˜¯æ·±åº¦å­¦ä¹ çš„ â€œæ ¸å¿ƒéª¨æ¶â€ï¼Œæ¨¡ä»¿äººè„‘ç¥ç»å…ƒçš„è¿æ¥æ–¹å¼ï¼Œæœ¬è´¨æ˜¯ â€œæŒ‰å±‚æ’åˆ—çš„å°è®¡ç®—å•å…ƒé›†åˆâ€ï¼Œåƒ â€œå·¥å‚æµæ°´çº¿â€ï¼š</p>
<p>â€¢<strong>è¾“å…¥å±‚</strong>ï¼šâ€œåŸææ–™å…¥å£â€â€”â€” æ¥æ”¶åŸå§‹æ•°æ®ï¼ˆæ¯”å¦‚å›¾ç‰‡åƒç´ ã€æ–‡å­—ï¼‰ï¼›</p>
<p>â€¢<strong>éšè—å±‚</strong>ï¼šâ€œæ ¸å¿ƒåŠ å·¥è½¦é—´â€â€”â€” å±‚æ•°è¶Šå¤šï¼Œæ·±åº¦å­¦ä¹ è¶Š â€œæ·±â€ï¼Œè´Ÿè´£ä¸€æ­¥æ­¥æå–æ•°æ®ç‰¹å¾ï¼ˆä»è½®å»“åˆ°ç»†èŠ‚ï¼‰ï¼›</p>
<p>â€¢<strong>è¾“å‡ºå±‚</strong>ï¼šâ€œæˆå“å‡ºå£â€â€”â€” è¾“å‡ºæœ€ç»ˆç»“æœï¼ˆæ¯”å¦‚ â€œè¿™æ˜¯çŒ«â€â€œç¿»è¯‘ç»“æœâ€ï¼‰ã€‚</p>
<p>æ¯ä¸ª â€œå°è®¡ç®—å•å…ƒâ€ï¼ˆç¥ç»å…ƒï¼‰å°±åƒ â€œå°è®¡ç®—å™¨â€ï¼Œç­›é€‰æœ‰ç”¨ä¿¡æ¯ã€å¼±åŒ–æ— ç”¨ä¿¡æ¯ï¼Œè®­ç»ƒæ¨¡å‹å°±æ˜¯è°ƒæ•´è¿™äº›å•å…ƒçš„ â€œå·¥ä½œè§„åˆ™â€ï¼Œè®©å®ƒè¶Šæ¥è¶Šç²¾å‡†ã€‚</p>
<h3 data-id="heading-6">5. ä¸ºä»€ä¹ˆæ·±åº¦å­¦ä¹ è¦ â€œæ·±â€ï¼Ÿ</h3>
<p>â€œæ·±â€ æŒ‡ç¥ç»ç½‘ç»œçš„ â€œéšè—å±‚å¤šâ€ï¼Œä¸æ˜¯ä¸ºäº†å‡‘æ•°ï¼Œè€Œæ˜¯ä¸ºäº† â€œæŒ–æ·±å±‚è§„å¾‹â€ï¼š</p>
<p>â€¢1 å±‚ç½‘ç»œï¼ˆæµ…ï¼‰ï¼šåªèƒ½çœ‹è¡¨é¢ä¿¡æ¯ï¼ˆæ¯”å¦‚å›¾ç‰‡çš„åƒç´ é¢œè‰²ï¼‰ï¼Œåˆ†ä¸æ¸…çŒ«å’Œç‹—ï¼›</p>
<p>â€¢3 å±‚ç½‘ç»œï¼ˆä¸­æ·±ï¼‰ï¼šç¬¬ 1 å±‚çœ‹ â€œè¾¹ç¼˜ / æ˜æš—â€â†’ç¬¬ 2 å±‚æ‹¼ â€œè€³æœµ / åœ†å½¢è½®å»“â€â†’ç¬¬ 3 å±‚åˆ¤æ–­ â€œå°–è€³æœµ = çŒ«ã€åœ†å½¢ = çƒâ€ï¼›</p>
<p>â€¢10 å±‚ä»¥ä¸Šç½‘ç»œï¼ˆæ·±ï¼‰ï¼šèƒ½åˆ†å±‚æå–ç‰¹å¾ï¼ˆå…ˆè½®å»“â†’å†ç»†èŠ‚â†’å†é€»è¾‘ï¼‰ï¼Œæ¯”å¦‚è¯†åˆ« â€œå°ç‹—åœ¨è¿½è´è¶â€ï¼Œèƒ½çœ‹æ‡‚ â€œåŠ¨ä½œâ€ å’Œ â€œåœºæ™¯â€ã€‚</p>
<p>ç®€å•è¯´ï¼šâ€œæ·±â€ çš„æœ¬è´¨æ˜¯ â€œåˆ†å±‚æå–ç‰¹å¾â€ï¼šä»è¡¨é¢çš„ â€œåƒç´  / æ–‡å­—â€ï¼ŒæŒ–åˆ°æ·±å±‚çš„ â€œé€»è¾‘ / åœºæ™¯â€ï¼›ä»»åŠ¡è¶Šå¤æ‚ï¼ˆå†™å°è¯´ã€è§£æ•°å­¦é¢˜ï¼‰ï¼Œè¶Šéœ€è¦ â€œæ·±â€ ç½‘ç»œï¼Œæ‰èƒ½ä»è¡¨é¢æ•°æ®æŒ–åˆ°æ ¸å¿ƒé€»è¾‘ã€‚</p>
<h3 data-id="heading-7">6. ä»€ä¹ˆæ˜¯é¢„è®­ç»ƒï¼Ÿ</h3>
<p>é¢„è®­ç»ƒå°±æ˜¯ç»™å¤§æ¨¡å‹ â€œæ‰“åŸºç¡€â€â€”â€” ç”¨æµ·é‡é€šç”¨æ•°æ®ï¼ˆæ¯”å¦‚å‡ ç™¾ä¸‡æœ¬ä¹¦ã€ç½‘é¡µï¼‰è®©æ¨¡å‹å…ˆå­¦ â€œé€šç”¨çŸ¥è¯†â€ï¼ˆè¯­æ³•ã€å¸¸è¯†ã€é€»è¾‘ï¼‰ï¼Œç›¸å½“äºè®©å­¦ç”Ÿå…ˆè¯»å®Œå°å­¦åˆ°å¤§å­¦çš„é€šè¯†è¯¾ç¨‹ï¼Œå…·å¤‡åŸºæœ¬èƒ½åŠ›ã€‚</p>
<p>é¢„è®­ç»ƒåçš„æ¨¡å‹å°±åƒ â€œæœ‰åŸºç¡€çš„å­¦éœ¸â€ï¼Œä¸ç”¨å†ä»é›¶å­¦èµ·ï¼Œåç»­åªéœ€é’ˆå¯¹æ€§åŸ¹è®­ï¼ˆå¾®è°ƒï¼‰ï¼Œå°±èƒ½é€‚é…å…·ä½“ä»»åŠ¡ï¼ˆæ¯”å¦‚å½“å®¢æœã€å†™ä»£ç ï¼‰ã€‚</p>
<h3 data-id="heading-8">7. ä»€ä¹ˆæ˜¯å¤§æ¨¡å‹ LLMï¼Ÿ</h3>
<p>LLM æ˜¯ â€œå¤§è¯­è¨€æ¨¡å‹â€ çš„ç¼©å†™ï¼Œæ ¸å¿ƒæ˜¯ â€œç”¨è¶…å¤§ç¥ç»ç½‘ç»œï¼Œå­¦æµ·é‡æ–‡å­—æ•°æ®ï¼Œèƒ½åƒäººä¸€æ ·ç†è§£å’Œç”Ÿæˆè¯­è¨€â€â€”â€” é€šä¿—è¯´å°±æ˜¯ â€œè¯»è¿‡å…¨ä¸–ç•Œä¹¦çš„è¶…çº§å­¦éœ¸â€ã€‚</p>
<p>â€œå¤§â€ ä½“ç°åœ¨ä¸‰ç‚¹ï¼š</p>
<p>â€¢å‚æ•°é‡å¤§ï¼šç›¸å½“äº â€œå­¦éœ¸çš„è„‘ç»†èƒå¤šâ€ï¼Œèƒ½å­˜æ›´å¤šçŸ¥è¯†ï¼ˆæ¯”å¦‚ GPT-4 æœ‰ä¸‡äº¿çº§å‚æ•°ï¼‰ï¼›</p>
<p>â€¢æ•°æ®é‡å¤šï¼šç›¸å½“äº â€œå­¦éœ¸è¯»çš„ä¹¦å¤šâ€ï¼Œè¦†ç›–ä¹¦ç±ã€è®ºæ–‡ã€ç½‘é¡µç­‰ï¼ŒçŸ¥è¯†æ¸Šåšï¼›</p>
<p>â€¢èƒ½åŠ›å…¨ï¼šèƒ½èŠå¤©ã€å†™æ–‡æ¡ˆã€è§£æ•°å­¦é¢˜ã€ç¼–ä»£ç ï¼Œä¸ç”¨ä¸“é—¨è®­ç»ƒã€‚</p>
<h3 data-id="heading-9">8. ä»€ä¹ˆæ˜¯å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼Ÿ</h3>
<p>â€œæ¨¡æ€â€ å°±æ˜¯ AI èƒ½å¤„ç†çš„ â€œä¿¡æ¯ç±»å‹â€ï¼ˆæ–‡å­—ã€å›¾ç‰‡ã€è¯­éŸ³ã€è§†é¢‘ï¼‰ï¼Œå¤šæ¨¡æ€å¤§æ¨¡å‹å°±æ˜¯ â€œå…¨èƒ½é€‰æ‰‹â€â€”â€” èƒ½åŒæ—¶å¤„ç†å¤šç§ä¿¡æ¯ï¼š</p>
<p>â€¢æ¯”å¦‚ä½ å‘ä¸€å¼ é£æ™¯ç…§ï¼Œå®ƒèƒ½æè¿°å†…å®¹ã€é…è¯—ï¼Œè¿˜èƒ½æŠŠè¯—è¯»å‡ºæ¥ï¼›</p>
<p>â€¢å¸¸è§ä¾‹å­ï¼šGPT-4Vã€æ–‡å¿ƒä¸€è¨€å¤šæ¨¡æ€ç‰ˆï¼Œèƒ½çœ‹å›¾ç‰‡ã€å¬è¯­éŸ³ã€å†™æ–‡å­—ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-10">äºŒã€æ ¸å¿ƒæ¶æ„ä¸æœºåˆ¶ï¼ˆAI çš„ â€œåº•å±‚éª¨æ¶â€ï¼‰</h2>
<h3 data-id="heading-11">1. ä¼ ç»Ÿæ¶æ„ä¸æ¼”è¿›ï¼šä»€ä¹ˆæ˜¯ RNN/LSTM/GRUï¼Ÿ</h3>
<p>åœ¨ Transformer å‡ºç°å‰ï¼Œå¤„ç†æ–‡å­—ã€è¯­éŸ³ç­‰ â€œåºåˆ—æ•°æ®â€ï¼ˆæœ‰å…ˆåé¡ºåºçš„æ•°æ®ï¼‰é è¿™äº›æ¶æ„ï¼š</p>
<p>â€¢<strong>RNN</strong>ï¼šâ€œé€å­—å¤„ç†â€ çš„æ¶æ„ â€”â€” åƒè¯»æ–‡ç« é€å­—å¿µï¼Œåªèƒ½è®°ä½æœ€è¿‘çš„ä¿¡æ¯ï¼Œå¤„ç†é•¿æ–‡æœ¬ä¼š â€œå¿˜äº‹â€ï¼ˆæ¯”å¦‚è¯» 1000 å­—æ–‡ç« ï¼Œåé¢å¿˜äº†å‰é¢ï¼‰ï¼›</p>
<p>â€¢<strong>LSTM/GRU</strong>ï¼šRNN çš„ â€œå‡çº§ç‰ˆâ€â€”â€” åŠ äº† â€œè®°å¿†å•å…ƒâ€ï¼Œèƒ½è®°ä½æ›´å¤šé•¿è·ç¦»ä¿¡æ¯ï¼Œä½†æ•ˆç‡è¿˜æ˜¯ä½ï¼Œå¤„ç†è¶…é•¿æ–‡æœ¬ä»åƒåŠ›ã€‚</p>
<p>è¿™äº›æ¶æ„æ˜¯ AI çš„ â€œè€åŸºå»ºâ€ï¼Œç°åœ¨ä¸»æµå¤§æ¨¡å‹å·²ä¸ç”¨ï¼Œä½†äº†è§£å®ƒä»¬èƒ½æ›´å¥½ç†è§£ Transformer çš„åˆ›æ–°ã€‚</p>
<h3 data-id="heading-12">2. ç°ä»£å¤§æ¨¡å‹åŸºçŸ³ï¼šä»€ä¹ˆæ˜¯ Transformer æ¶æ„ï¼Ÿ</h3>
<p>Transformer æ¶æ„æ˜¯ä¸€ç§ä»¥ â€œå¹¶è¡Œè®¡ç®— + è‡ªæ³¨æ„åŠ›æœºåˆ¶â€ ä¸ºæ ¸å¿ƒçš„ç¥ç»ç½‘ç»œç»“æ„ï¼Œèƒ½é«˜æ•ˆæ•æ‰æ•°æ®ï¼ˆå¦‚æ–‡å­—ï¼‰é—´çš„å…³è”å…³ç³»ï¼Œæ˜¯ç°ä»£å¤§æ¨¡å‹ï¼ˆå¦‚ ChatGPTã€DeepSeekï¼‰çš„åŸºç¡€éª¨æ¶ã€‚2017 å¹´ç”± Google æå‡ºï¼Œæ˜¯å¤§æ¨¡å‹ â€œé«˜æ•ˆè¿è¡Œâ€ çš„å…³é”®â€”â€” å†³å®šäº†æ¨¡å‹èƒ½è·‘å¤šå¿«ã€å¤„ç†å¤šé•¿æ–‡æœ¬ã€æ•ˆæœå¤šå¥½ï¼Œå½»åº•è§£å†³äº†ä¼ ç»Ÿæ¶æ„çš„ç—›ç‚¹ï¼š</p>
<p>â€¢æ ¸å¿ƒåˆ›æ–°ï¼šâ€œå¹¶è¡Œè®¡ç®— + æ³¨æ„åŠ›æœºåˆ¶â€â€”â€” ä¸ç”¨é€å­—å¤„ç†ï¼Œèƒ½åŒæ—¶åˆ†æå¤šä¸ªå…³é”®è¯ï¼Œè¿˜èƒ½è®°ä½è¯ä¸è¯çš„å…³ç³»ï¼Œåˆå¿«åˆå‡†ï¼›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b24f4b72e34841bf830659b83f57847f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153111&amp;x-signature=jNXWMIKEgskzQQybMbt%2B1bklkQA%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>â€¢æ ¸å¿ƒç»“æ„ï¼šåˆ† â€œç¼–ç å™¨ï¼ˆEncoderï¼‰â€ å’Œ â€œè§£ç å™¨ï¼ˆDecoderï¼‰â€â€”â€” ç¼–ç å™¨è´Ÿè´£ â€œç†è§£ä¿¡æ¯â€ï¼ˆæ¯”å¦‚è¯»æ–‡ç« ï¼‰ï¼Œè§£ç å™¨è´Ÿè´£ â€œç”Ÿæˆä¿¡æ¯â€ï¼ˆæ¯”å¦‚å†™æ–‡ç« ï¼‰ï¼›</p>
<p>ï»¿</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4bd91b6a0e004a59988db4a2ffb4b698~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153111&amp;x-signature=e7WulIpGuhX1PMah%2FfZtR%2BAtLxU%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ç®€å•è¯´ï¼ŒTransformer æ¶æ„å°±æ˜¯è®© AI èƒ½åŒæ—¶çœ‹æ‡‚æ–‡å­—é—´çš„å…³è”ã€è¿˜èƒ½å¿«é€Ÿå¤„ç†é•¿æ–‡æœ¬çš„ â€œé«˜æ•ˆå¤§è„‘éª¨æ¶â€ï½ã€‚</p>
<h3 data-id="heading-13">3. ä»€ä¹ˆæ˜¯ä½ç½®ç¼–ç ï¼Ÿ</h3>
<p>Transformer æ¶æ„æœ¬èº« â€œä¸è®¤è¯†æ–‡å­—é¡ºåºâ€â€”â€” å¦‚æœä¸åŠ ä½ç½®ç¼–ç ï¼Œæœºå™¨ä¼šæŠŠ â€œæˆ‘æ‰“ä½ â€ å’Œ â€œä½ æ‰“æˆ‘â€ å½“æˆä¸€å›äº‹ã€‚ä½ç½®ç¼–ç çš„æ ¸å¿ƒä½œç”¨æ˜¯ â€œæ ‡è®°æ–‡å­—çš„å…ˆåé¡ºåºâ€ï¼Œè®©æœºå™¨ç†è§£è¯­åºé€»è¾‘ã€‚</p>
<p>â€¢é€šä¿—è§£é‡Š</p>
<p>â—¦æ¯”å¦‚å¤„ç†å¥å­ â€œå°æ˜åƒè‹¹æœâ€ï¼šä½ç½®ç¼–ç ç»™ â€œå°æ˜â€ è´´ â€œ1 å·â€ã€â€œåƒâ€ è´´ â€œ2 å·â€ã€â€œè‹¹æœâ€ è´´ â€œ3 å·â€ï¼›</p>
<p>â—¦æœºå™¨çœ‹åˆ°æ ‡ç­¾åï¼Œå°±çŸ¥é“ â€œ1 å·ï¼ˆå°æ˜ï¼‰åš 2 å·ï¼ˆåƒï¼‰åŠ¨ä½œï¼Œå¯¹è±¡æ˜¯ 3 å·ï¼ˆè‹¹æœï¼‰â€ï¼Œä¸ä¼šæåé€»è¾‘ï¼›</p>
<p>â—¦æ³¨æ„ï¼šä½ç½®ç¼–ç ä¸æ˜¯ç®€å•çš„ 1ã€2ã€3ï¼Œè€Œæ˜¯ç”¨ç‰¹æ®Šæ•°å­—ç¼–ç ï¼Œè®©æœºå™¨åŒæ—¶ç†è§£ â€œç›¸é‚»è¯å…³ç³»æ›´è¿‘â€ï¼ˆå¦‚ â€œåƒâ€ å’Œ â€œå°æ˜â€â€œè‹¹æœâ€ çš„å…³ç³»æ¯” â€œå°æ˜â€ å’Œ â€œè‹¹æœâ€ æ›´è¿‘ï¼‰ã€‚</p>
<p>â€¢æ ¸å¿ƒä½œç”¨</p>
<p>â—¦ä½ç½®ç¼–ç è§£å†³äº† â€œè¯­åºæ··ä¹±â€ çš„é—®é¢˜ï¼Œè®©æœºå™¨èƒ½æ­£ç¡®ç†è§£ â€œä¸»è°“å®¾â€â€œå…ˆåé¡ºåºâ€ ç­‰è¯­è¨€é€»è¾‘ï¼Œæ˜¯å¤„ç†æ–‡æœ¬ä»»åŠ¡çš„å…³é”®å°æŠ€å·§ã€‚</p>
<h3 data-id="heading-14">4. è¯­ä¹‰ç†è§£å¼•æ“ï¼šä»€ä¹ˆæ˜¯æ³¨æ„åŠ›æ¨¡å‹ã€è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€å¤šå¤´æ³¨æ„åŠ›ï¼Ÿ</h3>
<p>è¿™ä»¨æ˜¯ Transformer çš„ â€œæ ¸å¿ƒèƒ½åŠ›â€ï¼Œæœ¬è´¨æ˜¯è®©æœºå™¨ â€œæŠ“é‡ç‚¹ã€ç†å…³ç³»â€ï¼š</p>

























<table><thead><tr><th>æ¦‚å¿µåç§°</th><th>é€šä¿—ç±»æ¯”</th><th>æ ¸å¿ƒä½œç”¨ ï¼ˆè¾“å…¥å¥å­ â€œåŒ—äº¬çš„æ•…å®«å’Œä¸Šæµ·çš„ä¸œæ–¹æ˜ç ï¼Œå“ªä¸ªæ›´é€‚åˆæ‹ç…§ï¼Ÿï¼‰</th></tr></thead><tbody><tr><td>æ³¨æ„åŠ›æ¨¡å‹</td><td>è¯»ä¹¦æ—¶ â€œåˆ’é‡ç‚¹â€</td><td>ä»æµ·é‡ä¿¡æ¯ä¸­ç­›é€‰å‡ºå…³é”®å†…å®¹ï¼ˆå¦‚ â€œåŒ—äº¬â€â€œæ•…å®«â€â€œæ‹ç…§â€ï¼‰</td></tr><tr><td>è‡ªæ³¨æ„åŠ›æœºåˆ¶</td><td>åˆ’é‡ç‚¹å â€œåˆ†æå…³ç³»â€</td><td>ä¸ä»…æ‰¾é‡ç‚¹ï¼Œè¿˜èƒ½ç†æ¸…é‡ç‚¹é—´çš„å…³è”ï¼ˆå¦‚ â€œåŒ—äº¬æœ‰æ•…å®«ï¼Œæ•…å®«é€‚åˆæ‹ç…§â€ï¼‰</td></tr><tr><td>å¤šå¤´æ³¨æ„åŠ›</td><td>ç”¨ â€œå¤šå‰¯çœ¼é•œçœ‹é‡ç‚¹â€</td><td>ä»å¤šä¸ªè§’åº¦æŠ“é‡ç‚¹ï¼ˆä¸€å‰¯çœ‹ â€œè°åšä»€ä¹ˆâ€ï¼Œä¸€å‰¯çœ‹ â€œåœ¨å“ªé‡Œåšâ€ï¼Œä¸€å‰¯çœ‹ â€œæ€ä¹ˆåšâ€ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-15">5. æ³¨æ„åŠ›ä¼˜åŒ–å‡çº§ï¼šä»€ä¹ˆæ˜¯ MLAã€NSA å’Œä»£ç†æ³¨æ„åŠ›ï¼Ÿ</h3>
<p>æ™®é€šæ³¨æ„åŠ›æœºåˆ¶å¤„ç†é•¿æ–‡æœ¬ï¼ˆæ¯”å¦‚ 10 ä¸‡å­—æŠ¥å‘Šï¼‰æ—¶ï¼Œä¼š â€œå†…å­˜ä¸å¤Ÿã€è·‘ä¸åŠ¨â€ï¼Œè¿™ä¸‰ä¸ªæ˜¯ â€œä¼˜åŒ–ç‰ˆâ€ï¼Œæ ¸å¿ƒæ˜¯ â€œçœèµ„æºã€ææ•ˆç‡â€ï¼š</p>





























<table><thead><tr><th>æŠ€æœ¯åç§°</th><th>é€šä¿—ç±»æ¯”</th><th>æ ¸å¿ƒé€»è¾‘</th><th>åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>å¤šå¤´æ½œåœ¨æ³¨æ„åŠ›ï¼ˆMLAï¼‰</td><td>æŠŠåšä¹¦åšæˆ â€œæ€ç»´å¯¼å›¾â€</td><td>å‹ç¼©å…³é”®ä¿¡æ¯ï¼Œå‡å°‘å†…å­˜å ç”¨ï¼ˆå¦‚æŠŠ 10 ä¸‡å­—æŠ¥å‘Šçš„é‡ç‚¹å‹ç¼©æˆ 1000 å­—ï¼‰</td><td>å¦‚DeepSeek å¯å¤„ç† 12 ä¸‡å­—é•¿æ–‡æœ¬</td></tr><tr><td>åŸç”Ÿç¨€ç–æ³¨æ„åŠ›ï¼ˆNSAï¼‰</td><td>è¯»ä¹¦åªçœ‹ â€œæ ¸å¿ƒæ®µè½â€</td><td>è·³è¿‡æ— ç”¨ä¿¡æ¯ï¼Œåªåˆ†æå…³é”®å†…å®¹çš„å…³ç³»ï¼ˆå¦‚å¿½ç•¥ â€œçš„ã€äº†ã€å—â€ ç­‰è™šè¯ï¼‰</td><td>å¦‚è¶…é•¿ç¯‡å°è¯´åˆ†æã€è®ºæ–‡æ‘˜è¦</td></tr><tr><td>ä»£ç†æ³¨æ„åŠ›</td><td>å…ˆçœ‹ â€œç›®å½•â€ å†çœ‹æ­£æ–‡</td><td>ç”¨ â€œæ‘˜è¦ / ç›®å½•â€ æ›¿ä»£åŸæ–‡æ‰¾é‡ç‚¹ï¼Œå†å¯¹åº”åˆ°åŸæ–‡ï¼ˆå¦‚å…ˆçœ‹ä¹¦ç±ç›®å½•ï¼Œå†é’ˆå¯¹æ€§çœ‹ç« èŠ‚ï¼‰</td><td>å¦‚ç™¾ä¸‡å­—çº§æ–‡æ¡£å¤„ç†ã€çŸ¥è¯†åº“é—®ç­”</td></tr></tbody></table>
<p>ä¸‰è€…çš„æ ¸å¿ƒæ€è·¯éƒ½æ˜¯ â€œæŠ“å¤§æ”¾å°â€ï¼Œåœ¨ä¸å½±å“ç†è§£æ•ˆæœçš„å‰æä¸‹ï¼Œé€šè¿‡å‹ç¼©ä¿¡æ¯ã€å‡å°‘è®¡ç®—é‡ï¼Œå®ç°é•¿æ–‡æœ¬çš„é«˜æ•ˆå¤„ç†ã€‚</p>
<h3 data-id="heading-16">6. ç”Ÿæˆé€»è¾‘å·®å¼‚ï¼šä»€ä¹ˆæ˜¯è‡ªå›å½’ç”Ÿæˆä¸éè‡ªå›å½’ç”Ÿæˆï¼Ÿ</h3>
<p>å¤§æ¨¡å‹ç”Ÿæˆæ–‡å­—çš„ä¸¤ç§æ ¸å¿ƒæ–¹å¼ï¼š</p>
<p>â€¢<strong>è‡ªå›å½’ç”Ÿæˆ</strong>ï¼šâ€œé€å­—å†™â€â€”â€” åƒäººå†™å­—ä¸€æ ·ï¼Œå†™å®Œä¸€ä¸ªå­—å†å†™ä¸‹ä¸€ä¸ªï¼Œèƒ½ä¿è¯é€»è¾‘è¿è´¯ï¼ŒChatGPTã€DeepSeek éƒ½ç”¨è¿™ç§ï¼›</p>
<p>â€¢<strong>éè‡ªå›å½’ç”Ÿæˆ</strong>ï¼šâ€œåŒæ—¶å†™å¤šä¸ªå­—â€â€”â€” æ•ˆç‡é«˜ï¼Œä½†å®¹æ˜“é€»è¾‘æ··ä¹±ï¼Œé€‚åˆå¯¹é€Ÿåº¦è¦æ±‚é«˜ã€å¯¹è¿è´¯æ€§è¦æ±‚ä½çš„åœºæ™¯ï¼ˆæ¯”å¦‚ç®€å•ç¿»è¯‘ï¼‰ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-17">ä¸‰ã€æ¨¡å‹ä¼˜åŒ–ä¸é€‚é…æŠ€æœ¯ï¼ˆè®© AI æ›´å®ç”¨ã€æ›´æ˜“éƒ¨ç½²ï¼‰</h2>
<h3 data-id="heading-18">1. ä»€ä¹ˆæ˜¯ MOE æ··åˆä¸“å®¶æ¶æ„ï¼Ÿ</h3>
<p>MOEï¼ˆMixture of Expertsï¼‰å³æ··åˆä¸“å®¶æ¶æ„ï¼Œæ ¸å¿ƒæ˜¯è®© â€œä¸“ä¸šçš„äººå¹²ä¸“ä¸šçš„äº‹â€â€”â€” æ¨¡å‹é‡Œæœ‰å¤šä¸ª â€œä¸“å®¶æ¨¡å—â€ï¼Œæ¯ä¸ªæ¨¡å—åªæ“…é•¿ä¸€ä¸ªé¢†åŸŸï¼Œå¤„ç†ä»»åŠ¡æ—¶åªæ¿€æ´»ç›¸å…³ä¸“å®¶ï¼Œæ—¢çœç®—åŠ›åˆé«˜æ•ˆã€‚<strong>ä¸»è¦ç»“æ„æ‹†è§£å¦‚ä¸‹ï¼š</strong></p>
<p>ï»¿</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19a8576af52049dbaf4617e70b97898d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153111&amp;x-signature=NtUV4z2F9%2FVkI8lR7yJf1eKWcm4%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>1.<strong>ä¸“å®¶æ¨¡å—</strong>ï¼šä¸åŒç§‘å®¤çš„åŒ»ç”Ÿï¼Œæ¯ä¸ªä¸“å®¶åªæ“…é•¿ä¸€ä¸ªé¢†åŸŸï¼ˆå¦‚ â€œä»£ç ä¸“å®¶â€ ä¸“åšç¼–ç¨‹ï¼Œâ€œæ•°å­¦ä¸“å®¶â€ ä¸“è§£éš¾é¢˜ï¼Œâ€œä¸­æ–‡ä¸“å®¶â€ ä¸“å¤„ç†è¯—è¯å’Œå¯¹è¯ï¼‰ï¼›</p>
<p>2.<strong>é—¨æ§ç½‘ç»œ</strong>ï¼šåŒ»é™¢å¯¼è¯Šå°ï¼Œè¾“å…¥ä»»åŠ¡åå…ˆ â€œåˆ¤æ–­ä»»åŠ¡ç±»å‹â€ï¼ˆå¦‚ â€œæ€ä¹ˆå†™ Python ä»£ç â€ å±äºç¼–ç¨‹ä»»åŠ¡ï¼‰ï¼›æ¥æ”¶è¾“å…¥ä»»åŠ¡åï¼Œé€šè¿‡è®¡ç®—åˆ¤æ–­ä»»åŠ¡ç±»å‹ï¼Œç­›é€‰å‡ºæœ€é€‚åˆå¤„ç†è¯¥ä»»åŠ¡çš„ 1-2 ä¸ªä¸“å®¶æ¨¡å—ï¼›</p>
<p>3.<strong>é«˜æ•ˆåä½œ</strong>ï¼šåªå«é†’éœ€è¦çš„ä¸“å®¶ï¼Œä¸ä¼šè®©æ— å…³ä¸“å®¶å‚ä¸ï¼ˆå¦‚ç¼–ç¨‹ä»»åŠ¡åªæ¿€æ´» â€œä»£ç ä¸“å®¶â€ï¼Œä¸æ‰“æ‰° â€œæ•°å­¦ä¸“å®¶â€ï¼‰ã€‚</p>
<p><strong>å®é™…æ¡ˆä¾‹ï¼šDeepSeek-V3 çš„ MOE æ¶æ„</strong></p>
<p>â€¢æ€»å‚æ•°é‡ï¼š6710 äº¿ï¼ˆç›¸å½“äº 256 ä¸ªä¸“å®¶æ¨¡å—ï¼‰ï¼›</p>
<p>â€¢æ¿€æ´»æ•°é‡ï¼šå¤„ç†ä»»åŠ¡æ—¶åªæ¿€æ´» 370 äº¿å‚æ•°ï¼ˆ8 ä¸ªä¸“å®¶æ¨¡å—ï¼‰ï¼›</p>
<p>â€¢ä¼˜åŠ¿ï¼šç®—åŠ›æµªè´¹å°‘ï¼Œè®­ç»ƒæˆæœ¬ä»…ä¸ºä¼ ç»Ÿæ¨¡å‹çš„ 1/3ï¼Œå¤„ç†ä»»åŠ¡é€Ÿåº¦æ›´å¿«ã€‚</p>
<h3 data-id="heading-19">2. ä»€ä¹ˆæ˜¯æ•°æ®å¹¶è¡Œã€æ¨¡å‹å¹¶è¡Œã€å¼ é‡å¹¶è¡Œï¼Ÿ</h3>
<p>å¤§æ¨¡å‹å‚æ•°é‡å¤ªå¤§ï¼ˆæ¯”å¦‚ä¸‡äº¿çº§ï¼‰ï¼Œå•å°ç”µè„‘è£…ä¸ä¸‹ã€è®­ä¸åŠ¨ï¼Œè¿™ä¸‰ç§æ˜¯ â€œåˆ†å·¥è®­ç»ƒâ€ çš„æ–¹å¼ï¼š</p>
<p>â€¢<strong>æ•°æ®å¹¶è¡Œ</strong>ï¼šå¤šå°ç”µè„‘ â€œä¸€èµ·ç»ƒä¸åŒæ‰¹æ¬¡çš„æ•°æ®â€â€”â€” æ¯”å¦‚ç”²ç»ƒç¬¬ 1-100 æ¡ï¼Œä¹™ç»ƒç¬¬ 101-200 æ¡ï¼Œæœ€åæ±‡æ€»ç»éªŒï¼›</p>
<p>â€¢<strong>æ¨¡å‹å¹¶è¡Œ</strong>ï¼šå¤šå°ç”µè„‘ â€œå„è´Ÿè´£æ¨¡å‹çš„ä¸€éƒ¨åˆ†â€â€”â€” æ¯”å¦‚ç”²è´Ÿè´£è¾“å…¥å±‚ï¼Œä¹™è´Ÿè´£éšè—å±‚ï¼Œåˆ†å·¥åä½œï¼›</p>
<p>â€¢<strong>å¼ é‡å¹¶è¡Œ</strong>ï¼šæŠŠæ¨¡å‹çš„ â€œè®¡ç®—ä»»åŠ¡æ‹†åˆ†â€â€”â€” æ¯”å¦‚ä¸€ä¸ªå¤æ‚è®¡ç®—æ‹†æˆ 3 ä»½ï¼Œ3 å°ç”µè„‘åŒæ—¶ç®—ï¼ŒåŠ å¿«é€Ÿåº¦ã€‚</p>
<h3 data-id="heading-20">3. ä»€ä¹ˆæ˜¯é‡åŒ–ã€çŸ¥è¯†è’¸é¦ã€å‰ªæï¼Ÿ</h3>
<p>å¤§æ¨¡å‹åŸæœ¬ â€œç¬¨é‡â€ï¼ˆéœ€è¶…å¤§å†…å­˜ï¼‰ï¼Œè¿™ä¸‰ç§æ˜¯ â€œç»™æ¨¡å‹ç˜¦èº«â€ çš„æŠ€æœ¯ï¼Œè®©å®ƒèƒ½è£…åœ¨æ™®é€šç”µè„‘ã€æ‰‹æœºä¸Šï¼š</p>
<p>â€¢<strong>é‡åŒ–</strong>ï¼šæŠŠæ¨¡å‹é‡Œçš„ â€œç²¾å‡†æ•°å­—ç®€åŒ–â€â€”â€” æ¯”å¦‚ â€œ1.23456â€ æ”¹æˆ â€œ1.23â€ï¼ŒåƒæŠŠ 4K ç…§ç‰‡è½¬æˆæ¸…æ™°ç¼©ç•¥å›¾ï¼Œä½“ç§¯å˜å°ä½†æ ¸å¿ƒä¿¡æ¯ä¸å˜ï¼›</p>
<p>â€¢<strong>çŸ¥è¯†è’¸é¦</strong>ï¼šè®© â€œå°æ¨¡å‹å­¦å¤§æ¨¡å‹çš„æœ¬äº‹â€â€”â€” å¤§æ¨¡å‹åƒ â€œæ•™æˆâ€ï¼Œå°æ¨¡å‹åƒ â€œå­¦ç”Ÿâ€ï¼Œå­¦ç”Ÿå­¦æ•™æˆçš„æ ¸å¿ƒçŸ¥è¯†ï¼Œä½“ç§¯å˜å° 10 å€ä»ä¿ç²¾åº¦ï¼›</p>
<p>â€¢<strong>å‰ªæ</strong>ï¼šç»™æ¨¡å‹ â€œåˆ æ— ç”¨éƒ¨åˆ†â€â€”â€” å»æ‰æ¨¡å‹é‡Œæ²¡ç”¨çš„å‚æ•°ï¼ˆæ¯”å¦‚å¾ˆå°‘ç”¨åˆ°çš„ â€œå°è®¡ç®—å•å…ƒâ€ï¼‰ï¼Œè®©å®ƒæ›´è½»å·§ã€‚</p>
<h3 data-id="heading-21">4. ä»€ä¹ˆæ˜¯æ¨¡å‹å‹ç¼©ï¼Ÿ</h3>
<p>å°±æ˜¯æŠŠé‡åŒ–ã€è’¸é¦ã€å‰ªæç­‰æŠ€æœ¯ â€œæ‰“åŒ…ä½¿ç”¨â€ï¼Œç»¼åˆç»™æ¨¡å‹ç˜¦èº«ï¼Œæ¯”å¦‚æŠŠ 10GB çš„å¤§æ¨¡å‹å‹ç¼©åˆ° 1GBï¼Œé€‚é…æ‰‹æœºã€æ™ºèƒ½æ‰‹è¡¨ç­‰èµ„æºå—é™è®¾å¤‡ã€‚</p>
<h3 data-id="heading-22">5. ä»€ä¹ˆæ˜¯æ¨¡å‹å¾®è°ƒï¼ˆFine-tuningï¼‰ï¼Ÿ</h3>
<p>å¾®è°ƒå°±æ˜¯ç»™ â€œæœ‰åŸºç¡€çš„ AI å­¦éœ¸â€ åš â€œå²—å‰åŸ¹è®­â€â€”â€” é¢„è®­ç»ƒæ¨¡å‹å·²ç»ä¼šé€šç”¨çŸ¥è¯†ï¼ˆä¼šè¯´è¯ã€æ‡‚å¸¸è¯†ï¼‰ï¼Œå¾®è°ƒæ—¶ç”¨å°‘é‡ä¸“é¡¹æ•°æ®ï¼ˆæ¯”å¦‚å…¬å¸å®¢æœå¯¹è¯ï¼‰ï¼Œæ•™å®ƒåšå…·ä½“äº‹ï¼š</p>
<p>â€¢æµç¨‹ï¼šé€šç”¨å¤§æ¨¡å‹â†’è¾“å…¥ä¸“é¡¹æ•°æ®â†’è®­ç»ƒå‡ å¤©â†’è¾“å‡ºä¸“é¡¹æ¨¡å‹ï¼ˆæ¯”å¦‚å®¢æœ AIï¼‰ï¼›</p>
<p>â€¢ä¼˜åŠ¿ï¼šçœæ•°æ®ã€çœæ—¶é—´ï¼Œä¸ç”¨ä»é›¶è®­ç»ƒï¼›å­¦å®Œä¸“é¡¹æŠ€èƒ½åï¼Œä»ä¼šèŠå¤©ã€ç®—æ•°å­¦é¢˜ç­‰é€šç”¨èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-23">6. ä»€ä¹ˆæ˜¯ LoRAã€QLoRAï¼Ÿ</h3>
<p>æ™®é€šå¾®è°ƒä»éœ€è¦ä¸å°‘ç®—åŠ›ï¼Œè¿™ä¿©æ˜¯ â€œè½»é‡çº§å¾®è°ƒâ€ æŠ€æœ¯ï¼š</p>
<p>â€¢æ ¸å¿ƒé€»è¾‘ï¼šä¸æ”¹å˜å¤§æ¨¡å‹çš„æ ¸å¿ƒå‚æ•°ï¼Œåªç»™å®ƒåŠ  â€œå°æ’ä»¶â€ï¼ˆå°‘é‡æ–°å‚æ•°ï¼‰ï¼Œæ•™æ’ä»¶ä¸“é¡¹æŠ€èƒ½ï¼›</p>
<p>â€¢ä¼˜åŠ¿ï¼šç”¨æ™®é€šç”µè„‘å°±èƒ½åšï¼Œæˆæœ¬ä½ã€é€Ÿåº¦å¿«ï¼Œé€‚åˆä¸­å°ä¼ä¸šå’Œä¸ªäººã€‚</p>
<h3 data-id="heading-24">7. ä»€ä¹ˆæ˜¯é¢†åŸŸè‡ªé€‚åº”ï¼ˆDomain Adaptationï¼‰ï¼Ÿ</h3>
<p>è®©å¤§æ¨¡å‹ â€œé€‚é…ç‰¹å®šè¡Œä¸šâ€â€”â€” æ¯”å¦‚ç»™é€šç”¨å¤§æ¨¡å‹å–‚åŒ»ç–—æ•°æ®ï¼Œè®©å®ƒå­¦ä¼šçœ‹ç—…å†ã€ç­”åŒ»ç–—é—®é¢˜ï¼›å–‚é‡‘èæ•°æ®ï¼Œè®©å®ƒæ‡‚è‚¡ç¥¨ã€åŸºé‡‘ï¼Œæˆä¸ºè¡Œä¸šä¸“ç”¨æ¨¡å‹ã€‚</p>
<h3 data-id="heading-25">8. ä»€ä¹ˆæ˜¯ RLHFï¼ˆäººç±»åé¦ˆå¼ºåŒ–å­¦ä¹ ï¼‰ï¼Ÿ</h3>
<p>è®©æ¨¡å‹çš„è¾“å‡º â€œç¬¦åˆäººç±»åå¥½â€â€”â€” æ¯”å¦‚æ¨¡å‹å›ç­”åï¼Œäººç»™æ‰“åˆ†ï¼ˆå¥½ / ä¸å¥½ï¼‰ï¼Œå†ç”¨è¿™äº›åˆ†æ•°è®­ç»ƒæ¨¡å‹ï¼Œè®©å®ƒè¶Šæ¥è¶Šæ‡‚ â€œäººå–œæ¬¢ä»€ä¹ˆæ ·çš„å›ç­”â€ï¼ˆæ¯”å¦‚æ›´ç¤¼è²Œã€æ›´ç²¾å‡†ï¼‰ã€‚</p>
<h3 data-id="heading-26">9. ä»€ä¹ˆæ˜¯ RAGã€KAGï¼Ÿ</h3>
<p>è§£å†³å¤§æ¨¡å‹ â€œçŸ¥è¯†è¿‡æ—¶ã€ä¸æ‡‚ä¸“ä¸šé¢†åŸŸâ€ çš„é—®é¢˜ï¼š</p>
<p>â€¢<strong>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰</strong> ï¼šAI â€œå¼€å·è€ƒè¯•â€â€”â€” å›ç­”é—®é¢˜å‰ï¼Œå…ˆä»å¤–éƒ¨çŸ¥è¯†åº“ï¼ˆæ¯”å¦‚å…¬å¸æ–‡æ¡£ã€æœ€æ–°æ–°é—»ï¼‰æŸ¥ç›¸å…³ä¿¡æ¯ï¼Œå†ç»“åˆè‡ªå·±çš„çŸ¥è¯†ç”Ÿæˆç­”æ¡ˆï¼Œæ¯”å¦‚é—® â€œ2025 å¹´æœ€æ–°æ”¿ç­–â€ï¼Œå®ƒä¼šå…ˆæŸ¥ 2025 å¹´çš„èµ„æ–™ï¼›</p>
<p>â€¢<strong>KAGï¼ˆçŸ¥è¯†å¢å¼ºç”Ÿæˆï¼‰</strong> ï¼šAI â€œæŠŠçŸ¥è¯†ç‚¹è®°ç‰¢å†ç­”é¢˜â€â€”â€” é¢„è®­ç»ƒæ—¶å°±æŠŠç»“æ„åŒ–çŸ¥è¯†ï¼ˆæ¯”å¦‚ç™¾ç§‘è¯æ¡ã€è¡Œä¸šæœ¯è¯­ï¼‰èå…¥æ¨¡å‹ï¼Œä¸ç”¨ä¸´æ—¶æŸ¥ï¼Œé€‚åˆå›ç­”å›ºå®šå¸¸è¯†ï¼ˆæ¯”å¦‚ â€œç‰›é¡¿ä¸‰å¤§å®šå¾‹â€ï¼‰ã€‚</p>
<h3 data-id="heading-27">10. ä»€ä¹ˆæ˜¯äº‹å®æ ¸æŸ¥ï¼ˆFact-checkingï¼‰ï¼Ÿ</h3>
<p>å‡å°‘å¤§æ¨¡å‹ â€œèƒ¡è¯´å…«é“â€ï¼ˆå¹»è§‰ï¼‰çš„æŠ€æœ¯ â€”â€” æ¨¡å‹ç”Ÿæˆç­”æ¡ˆåï¼Œè‡ªåŠ¨æ ¸å¯¹äº‹å®ï¼ˆæ¯”å¦‚æŸ¥èµ„æ–™ç¡®è®¤ â€œåŒ—äº¬åˆ°ä¸Šæµ·çš„è·ç¦»â€ï¼‰ï¼Œçº æ­£é”™è¯¯ä¿¡æ¯ï¼Œè®©å›ç­”æ›´é è°±ã€‚</p>
<h3 data-id="heading-28">11. ä»€ä¹ˆæ˜¯å¯¹é½ï¼ˆAlignmentï¼‰ä¸å®‰å…¨æŠ¤æ ï¼ˆSafety Guardrailsï¼‰ï¼Ÿ</h3>
<p>â€¢<strong>å¯¹é½</strong>ï¼šè®©æ¨¡å‹çš„ç›®æ ‡å’Œäººç±»ä¸€è‡´ â€”â€” æ¯”å¦‚ä¸ç”Ÿæˆæœ‰å®³å†…å®¹ã€ä¸æ’’è°ï¼›</p>
<p>â€¢<strong>å®‰å…¨æŠ¤æ </strong>ï¼šç»™æ¨¡å‹ â€œè®¾ç¦åŒºâ€â€”â€” ç¦æ­¢ç”Ÿæˆæš´åŠ›ã€æ­§è§†ç­‰æœ‰å®³å†…å®¹ï¼Œç¡®ä¿ä½¿ç”¨å®‰å…¨ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-29">å››ã€å…¸å‹æ¨¡å‹ä¸ç”Ÿæ€å®è·µï¼ˆä»ç†è®ºåˆ°åº”ç”¨ï¼‰</h2>
<h3 data-id="heading-30">1. ä¸»æµå¤§æ¨¡å‹åˆ†ç±»ä¸ä»£è¡¨</h3>
<p>â€¢<strong>é€šç”¨å¤§æ¨¡å‹</strong>ï¼šèƒ½åº”å¯¹å¤šç§ä»»åŠ¡ï¼Œæ¯”å¦‚ GPT ç³»åˆ—ï¼ˆOpenAIï¼‰ã€æ–‡å¿ƒä¸€è¨€ï¼ˆç™¾åº¦ï¼‰ã€Llama ç³»åˆ—ï¼ˆMetaï¼‰ã€é€šä¹‰åƒé—®ï¼ˆé˜¿é‡Œï¼‰ã€Qwenï¼ˆé˜¿é‡Œäº‘ï¼‰ï¼›</p>
<p>â€¢<strong>å‚ç›´é¢†åŸŸå¤§æ¨¡å‹</strong>ï¼šä¸“æ³¨æŸä¸€è¡Œä¸šï¼Œæ¯”å¦‚åŒ»ç–—å¤§æ¨¡å‹ï¼ˆçœ‹ç—…å†ã€è¾…åŠ©è¯Šæ–­ï¼‰ã€æ³•å¾‹å¤§æ¨¡å‹ï¼ˆæŸ¥æ³•æ¡ã€å†™åˆåŒï¼‰ã€ç¼–ç¨‹å¤§æ¨¡å‹ï¼ˆDeepSeek-Coderã€GitHub Copilotï¼‰ã€‚</p>
<h3 data-id="heading-31">2. å…¸å‹åˆ›æ–°æ¡ˆä¾‹ï¼šDeepSeek çš„æ ¸å¿ƒåˆ›æ–°ç‚¹</h3>
<p>DeepSeek çš„æ ¸å¿ƒåˆ›æ–°å›´ç»• â€œé«˜æ•ˆã€ä½æˆæœ¬ã€é«˜é€‚é…â€ å±•å¼€ï¼Œé€šè¿‡æ¶æ„ä¼˜åŒ–ã€è®­ç»ƒæ–¹æ³•åˆ›æ–°ç­‰ï¼Œå®ç°äº† â€œç”¨æ›´å°‘èµ„æºåšå‡ºé«˜æ€§èƒ½æ¨¡å‹â€ çš„ç›®æ ‡ï¼Œè®©å¤§æ¨¡å‹æ›´æ˜“æ™®åŠã€‚</p>
<p><strong>æ ¸å¿ƒåˆ›æ–°ç‚¹ï¼š</strong></p>
<p>â—¦<strong>é«˜æ•ˆæ¶æ„è®¾è®¡ï¼šMOE+MLA</strong>ç»“åˆæ··åˆä¸“å®¶æ¶æ„ï¼ˆMOEï¼‰å’Œå¤šå¤´æ½œåœ¨æ³¨æ„åŠ›ï¼ˆMLAï¼‰ï¼Œ6710 äº¿æ€»å‚æ•°é‡ä»…æ¿€æ´» 370 äº¿å‚æ•°å¤„ç†ä»»åŠ¡ï¼ŒåŒæ—¶é€šè¿‡ MLA å‹ç¼©é•¿æ–‡æœ¬ä¿¡æ¯ï¼Œæ”¯æŒ 12 ä¸‡å­—é•¿æ–‡æœ¬å¤„ç†ï¼Œç®—åŠ›æˆæœ¬é™ä½ 70% ä»¥ä¸Šã€‚</p>
<p>â—¦<strong>ä½æˆæœ¬è®­ç»ƒæŠ€æœ¯ï¼šå¼ºåŒ–å­¦ä¹  + çŸ¥è¯†è’¸é¦</strong>é‡‡ç”¨ GRPO å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼Œæ— éœ€å¤§é‡äººå·¥æ ‡æ³¨æ•°æ®ï¼Œé€šè¿‡ â€œè¯•é”™åé¦ˆâ€ ä¼˜åŒ–æ¨¡å‹æ¨ç†èƒ½åŠ›ï¼›ç»“åˆåŠ¨æ€çŸ¥è¯†è’¸é¦æŠ€æœ¯ï¼Œå°†å¤§æ¨¡å‹èƒ½åŠ›è¿ç§»è‡³å°æ¨¡å‹ï¼Œä½“ç§¯å‡å°‘ 40% ä»ä¿æŒç²¾åº¦ï¼Œè®­ç»ƒæˆæœ¬ä»…ä¸º GPT-4 çš„ 1/18ã€‚</p>
<p>â—¦<strong>é«˜é€‚é…æ€§éƒ¨ç½²ï¼šå¤šåœºæ™¯ + è½»é‡åŒ–</strong>æ¨å‡ºé€šç”¨æ¨¡å‹ã€ç¼–ç¨‹æ¨¡å‹ï¼ˆDeepSeek-Coderï¼‰ã€æ¨ç†æ¨¡å‹ï¼ˆDeepSeek-R1ï¼‰ç­‰ç³»åˆ—äº§å“ï¼Œé€‚é…ä¸åŒåœºæ™¯ï¼›æ”¯æŒæœ¬åœ°ã€äº‘ç«¯ã€è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²ï¼Œæ™®é€š GPU å³å¯è¿è¡Œï¼Œä¼ä¸šå¯å¿«é€Ÿé›†æˆåˆ°é‡‘èã€æ•™è‚²ã€åŒ»ç–—ç­‰è¡Œä¸šã€‚</p>
<p>â—¦<strong>å¼ºæ¨ç†èƒ½åŠ›ï¼šåˆ†æ­¥æ€è€ƒæœºåˆ¶</strong>åŸºäºå¼ºåŒ–å­¦ä¹ å®ç° â€œåˆ†æ­¥æ¨ç†â€ï¼Œæ¨¡å‹å¤„ç†æ•°å­¦ã€ç¼–ç¨‹ç­‰å¤æ‚ä»»åŠ¡æ—¶ï¼Œä¼šåƒäººç±»ä¸€æ ·æ‹†è§£æ­¥éª¤ã€é€æ­¥æ±‚è§£ï¼Œå‡†ç¡®ç‡æ¯”è‚© OpenAI o1 ç³»åˆ—ã€‚</p>
<h3 data-id="heading-32">3. éƒ¨ç½²å½¢æ€ï¼šäº‘ç«¯ã€è¾¹ç¼˜ã€æœ¬åœ°éƒ¨ç½²</h3>
<p>â€¢<strong>äº‘ç«¯éƒ¨ç½²</strong>ï¼šæ¨¡å‹å­˜åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ç½‘ç»œä½¿ç”¨ï¼ˆæ¯”å¦‚ ChatGPT ç½‘é¡µç‰ˆï¼‰ï¼Œä¸ç”¨è‡ªå·±è£…ï¼›</p>
<p>â€¢<strong>æœ¬åœ°éƒ¨ç½²</strong>ï¼šæŠŠæ¨¡å‹è£…åœ¨è‡ªå·±çš„ç”µè„‘ã€æœåŠ¡å™¨ä¸Šï¼Œç¦»çº¿ä¹Ÿèƒ½ç”¨ï¼Œé€‚åˆæ³¨é‡æ•°æ®éšç§çš„åœºæ™¯ï¼›</p>
<p>â€¢<strong>è¾¹ç¼˜éƒ¨ç½²</strong>ï¼šæŠŠæ¨¡å‹è£…åœ¨è¾¹ç¼˜è®¾å¤‡ä¸Šï¼ˆæ¯”å¦‚æ‰‹æœºã€æ™ºèƒ½æ‘„åƒå¤´ï¼‰ï¼Œå“åº”å¿«ã€ä¸å ç½‘ç»œå¸¦å®½ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-33">äº”ã€å¸¸ç”¨å·¥å…·ä¸äº¤äº’æŠ€æœ¯ï¼ˆé«˜æ•ˆç”¨ AIï¼‰</h2>
<h3 data-id="heading-34">1. ä»€ä¹ˆæ˜¯æç¤ºå·¥ç¨‹ï¼ˆPrompt Engineeringï¼‰ï¼Ÿ</h3>
<p>å°±æ˜¯ â€œæ•™ AI æ€ä¹ˆè¯´è¯â€â€”â€” é€šè¿‡ä¼˜åŒ–è¾“å…¥æŒ‡ä»¤ï¼ˆæç¤ºè¯ï¼‰ï¼Œè®© AI è¾“å‡ºç¬¦åˆé¢„æœŸçš„ç»“æœï¼š</p>
<p>â€¢æ¯”å¦‚åªè¯´ â€œå†™æ—…æ¸¸æ”»ç•¥â€ï¼Œæ•ˆæœä¸€èˆ¬ï¼›ä½†è¯´ â€œå†™ä¸€ç¯‡é€‚åˆäº²å­å®¶åº­çš„åŒ—äº¬ 3 æ—¥æ¸¸æ”»ç•¥ï¼Œå«æ™¯ç‚¹ã€é¤é¥®ã€äº¤é€šï¼Œè¯­è¨€ç®€æ´â€ï¼Œç»“æœæ›´ç²¾å‡†ï¼›</p>
<p>â€¢æ ¸å¿ƒï¼šæŒ‡ä»¤æ¸…æ™°ã€é€»è¾‘æ˜ç¡®ï¼Œå¸® AI æ‡‚ä½ çš„éœ€æ±‚ã€‚</p>
<h3 data-id="heading-35">2. å…³äºæç¤ºå­¦ä¹ ä¸­çš„æ€ç»´é“¾ã€è‡ªæ°æ€§å’Œæ€ç»´æ ‘ï¼Ÿ</h3>
<p>â€¢<strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong></p>
<p>æ€ç»´é“¾ï¼šè®© AI â€œä¼šå†™æ­¥éª¤â€ï¼›</p>
<p>è‡ªæ´½æ€§ï¼šè®© AI â€œä¼šæŸ¥ç­”æ¡ˆâ€ï¼›</p>
<p>æ€ç»´æ ‘ï¼šè®© AIâ€œä¼šæ‹†éš¾é¢˜ã€é€‰æ€è·¯â€ï¼›éƒ½æ˜¯ä¸ºäº†è®© AI çš„å›ç­”æ›´é è°±ï¼Œåªæ˜¯ç®€å•é—®é¢˜ç”¨æ€ç»´é“¾ï¼Œæ˜“å‡ºé”™é—®é¢˜åŠ è‡ªæ´½æ€§ï¼Œå¤æ‚é—®é¢˜ç”¨æ€ç»´æ ‘ï½</p>
<p>â€¢ä¸‰è€…<strong>å¯¹æ¯”</strong></p>





























<table><thead><tr><th>æ¦‚å¿µ</th><th>é€šä¿—ç±»æ¯”</th><th>æ ¸å¿ƒåŠ¨ä½œ</th><th>é€‚åˆåœºæ™¯</th></tr></thead><tbody><tr><td>æ€ç»´é“¾ï¼ˆCoTï¼‰</td><td>å†™è§£é¢˜æ­¥éª¤</td><td>å•ä¸€çº¿æ€§æ¨ç†ï¼ˆä¸€æ­¥ä¸€æ­¥ï¼‰</td><td>ç®€å•ã€æœ‰æ˜ç¡®æ­¥éª¤çš„é—®é¢˜</td></tr><tr><td>è‡ªæ´½æ€§</td><td>åå¤æ£€æŸ¥ä½œä¸š</td><td>å¤šè½®ç‹¬ç«‹éªŒè¯ï¼ˆæ¢æ€è·¯é‡ç®—ï¼‰</td><td>æ˜“å‡ºé”™ã€ç»“æœä¸ç¡®å®šçš„é—®é¢˜</td></tr><tr><td>æ€ç»´æ ‘ï¼ˆToTï¼‰</td><td>æ‹†éš¾é¢˜ + å¤šæ¡æ€è·¯æ¢ç´¢</td><td>å¤šåˆ†æ”¯æ¨ç†ï¼ˆæ‹†åˆ† + é€‰ä¼˜ï¼‰</td><td>å¤æ‚ã€å¤šé€‰é¡¹ã€éœ€æƒè¡¡çš„é—®é¢˜</td></tr></tbody></table>
<p>â€¢<strong>ä¸¾ä¾‹ï¼š</strong></p>
<p>1.ç”¨æ€ç»´æ ‘ï¼ˆToTï¼‰æ‹†é—®é¢˜ï¼šæŠŠå¤§é¢˜æ‹†æˆ 3 ä¸ªå°é¢˜ï¼Œæ¯ä¸ªå°é¢˜æƒ³ 2 ç§è§£æ³•ï¼›</p>
<p>2.ç”¨æ€ç»´é“¾ï¼ˆCoTï¼‰å†™æ­¥éª¤ï¼šæ¯ä¸ªè§£æ³•éƒ½å†™è¯¦ç»†æ¨å¯¼ï¼›</p>
<p>3.ç”¨è‡ªæ´½æ€§éªŒè¯ï¼šæ¯ä¸ªå°é¢˜çš„ 2 ç§è§£æ³•ç»“æœä¸€è‡´ï¼Œå†æ±‡æ€»å¤§é¢˜ç­”æ¡ˆã€‚</p>
<h3 data-id="heading-36">3. ä»€ä¹ˆæ˜¯å°‘æ ·æœ¬ / é›¶æ ·æœ¬æç¤ºï¼Ÿ</h3>
<p>æç¤ºå·¥ç¨‹çš„ â€œè¿›é˜¶æŠ€å·§â€ï¼š</p>
<p>â€¢<strong>å°‘æ ·æœ¬æç¤ºï¼šç»™ AI â€œå‡ ä¸ªä¾‹å­â€â€”â€” æ¯”å¦‚è®©å®ƒç¿»è¯‘æ–¹è¨€ï¼Œå…ˆç»™ 2 ä¸ª â€œæ–¹è¨€â†’æ™®é€šè¯â€ çš„ä¾‹å­ï¼Œå®ƒå°±ä¼šæ¨¡ä»¿ï¼›</strong></p>
<p>â€¢<strong>é›¶æ ·æœ¬æç¤ºï¼šä¸ç»™ä¾‹å­ï¼Œç›´æ¥è®© AI åšä»»åŠ¡ â€”â€” æ¯”å¦‚è®©å®ƒå†™ä¸€é¦–è¯—ï¼Œå…¨é å®ƒè‡ªå·±çš„çŸ¥è¯†ã€‚</strong></p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-37">å…­ã€é«˜é¢‘æœ¯è¯­ï¼ˆè¯»æ‡‚ AI æ–‡æ¡£çš„å…³é”®è¯ï¼‰</h2>
<p>1.<strong>Token</strong>ï¼šAI å¤„ç†æ–‡å­—çš„ â€œæœ€å°å•ä½â€â€”â€” ä¸­æ–‡æ˜¯å•ä¸ªå­—æˆ–è¯è¯­ï¼ˆæ¯”å¦‚ â€œæˆ‘ / çˆ± / AIâ€ï¼‰ï¼Œè‹±æ–‡æ˜¯å•è¯æˆ–è¯æ ¹ï¼Œæ¨¡å‹èƒ½å¤„ç†çš„ Token æ•°é‡å†³å®šäº†æ–‡æœ¬é•¿åº¦ï¼ˆæ¯”å¦‚ 4096 ä¸ª Token çº¦ 3000 ä¸­æ–‡å­—ï¼‰ï¼›</p>
<p>2.<strong>æ ‡ç­¾ï¼ˆLabelï¼‰</strong> ï¼šæ•°æ®çš„ â€œæ ‡å‡†ç­”æ¡ˆâ€ï¼Œæ¯”å¦‚ â€œè¿™å¼ æ˜¯çŒ«â€ï¼›</p>
<p>3.<strong>æ‰¹æ¬¡ï¼ˆBatchï¼‰</strong> ï¼šè®­ç»ƒæ—¶ä¸€æ¬¡å–‚ç»™æ¨¡å‹çš„æ•°æ®é‡ï¼ˆæ¯”å¦‚ä¸€æ¬¡å–‚ 32 æ¡æ–‡æœ¬ï¼‰ï¼›</p>
<p>4.<strong>è®­ç»ƒæ­¥é•¿ï¼ˆStepï¼‰</strong> ï¼šæ¨¡å‹å¤„ç†ä¸€æ‰¹æ•°æ® + è°ƒæ•´ä¸€æ¬¡å‚æ•°ï¼Œç®— 1 ä¸ª Stepï¼ˆè¡¡é‡è®­ç»ƒè¿›åº¦ï¼‰ï¼›</p>
<p>5.<strong>è½®æ¬¡ï¼ˆEpochï¼‰</strong> ï¼šæŠŠæ‰€æœ‰è®­ç»ƒæ•°æ®å®Œæ•´å­¦ä¸€éï¼Œç®— 1 ä¸ª Epochï¼ˆæ¯”å¦‚ 10 ä¸‡æ¡æ•°æ®ï¼Œæ¯æ‰¹ 32 æ¡ï¼Œçº¦ 3125 ä¸ª Step=1 ä¸ª Epochï¼‰ã€‚</p>
<p>6.<strong>ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰</strong> ï¼šAI çš„ â€œèŠå¤©è®°å¿†â€â€”â€” è®°ä½ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œæ¯”å¦‚ä½ å…ˆé—® â€œåŒ—äº¬å¤©æ°”â€ï¼Œå†é—® â€œç©¿ä»€ä¹ˆâ€ï¼ŒAI çŸ¥é“ä½ æŒ‡åŒ—äº¬ï¼›</p>
<p>7.<strong>ä¸Šä¸‹æ–‡çª—å£ï¼ˆContext Windowï¼‰</strong> ï¼šAI èƒ½è®°ä½çš„ â€œå¯¹è¯é•¿åº¦ä¸Šé™â€â€”â€” æ¯”å¦‚ 4096 ä¸ª Token çª—å£ï¼Œè¶…è¿‡å°±ä¼šå¿˜å‰é¢çš„å†…å®¹ï¼›</p>
<p>8.<strong>å¤šè½®å¯¹è¯ï¼ˆMulti-turn Conversationï¼‰</strong> ï¼šå’Œ AI èŠå¥½å‡ è½®ï¼ˆæ¯”å¦‚é—®é—®é¢˜â†’è¿½æ›´â†’å†é—®ï¼‰ï¼ŒAI èƒ½è¿è´¯å›åº”ï¼›</p>
<p>9.<strong>Agentï¼ˆAI æ™ºèƒ½ä½“ï¼‰</strong> ï¼šâ€œæœ‰è‡ªä¸»èƒ½åŠ›çš„ AI åŠ©æ‰‹â€â€”â€” ä¸ç”¨ä½ ä¸€æ­¥æ­¥æŒ‡æŒ¥ï¼Œèƒ½è‡ªå·±ç†è§£ä»»åŠ¡ã€ç”¨å·¥å…·ã€è§£å†³é—®é¢˜ï¼ˆæ¯”å¦‚è®©å®ƒè§„åˆ’æ—…æ¸¸ï¼Œè‡ªå·±æŸ¥æ™¯ç‚¹ã€è®¢é…’åº—ï¼‰ï¼›</p>
<p>10.<strong>A2Aï¼ˆAgent-to-Agentï¼‰</strong> ï¼šA2Aæ˜¯è°·æ­Œå…¬å¼€çš„ä¸€ä¸ªåè®®ï¼Œå®ƒèƒ½å¤Ÿå®ç°ä¸åŒçš„Agentä¹‹é—´èƒ½å¤Ÿå®ç°ç›´æ¥äº’é€šï¼Œè®©æ™ºèƒ½ä½“ä¹‹é—´èƒ½å¤Ÿåä½œèµ·æ¥è§£å†³å¤šä»»åŠ¡çš„é—®é¢˜ï¼›A2Aæ˜¯è®©å¤šä¸ªAgentèƒ½å¤Ÿè¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªèƒ½åŠ›æ›´åŠ å¼ºå¤§çš„Agentï¼Œè§£å†³å¤šä¸ªAgentçš„é€šä¿¡æ•ˆç‡é—®é¢˜ã€‚ç®€å•è¯´å°±æ˜¯å¤šä¸ª AI æ™ºèƒ½ä½“ â€œåä½œå¹²æ´»â€â€”â€” æ¯”å¦‚ä¸€ä¸ªæŸ¥èµ„æ–™ã€ä¸€ä¸ªå†™æ–‡æ¡ˆã€ä¸€ä¸ªæ ¡å¯¹ï¼ŒåˆåŠ›å®Œæˆå¤æ‚ä»»åŠ¡ã€‚</p>
<p>11.<strong>å¹»è§‰ï¼ˆHallucinationï¼‰</strong> ï¼šAI â€œèƒ¡è¯´å…«é“â€â€”â€” ç¼–é€ ä¸å­˜åœ¨çš„äº‹å®ï¼ˆæ¯”å¦‚å‡æ–°é—»ã€å‡æ•°æ®ï¼‰ã€‚</p>
<p>12.<strong>MCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰</strong> ï¼šMCPï¼ˆModel Context Protocolï¼‰å³ â€œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®â€ï¼Œç®€å•è¯´å°±æ˜¯AI èŠå¤©çš„ â€œè®°å¿†ç®¡ç†è§„åˆ™â€â€”â€” è§„å®šèƒ½è®°å¤šå°‘è½®å¯¹è¯ã€ä¼˜å…ˆä¿ç•™ä»€ä¹ˆä¿¡æ¯ï¼Œç¡®ä¿è¿è´¯åˆçœå†…å­˜ã€‚MCPè®©æ‰€æœ‰çš„APIã€å·¥å…·ã€æ•°æ®æºèƒ½å¤ŸæŒ‰ç…§ç»Ÿä¸€çš„åè®®é€šä¿¡ï¼Œåªè¦æŒ‰æ­¤è§„èŒƒï¼Œè¿™äº›å·¥å…·éƒ½å¯ä»¥è¢«å¼€å‘è€…ç›´æ¥è°ƒç”¨ï¼›MCPè§£å†³äº†æ­å»ºå•ä¸ªAgentçš„æ•ˆç‡é—®é¢˜ï¼Œè®©æ­å»ºå•ä¸ªAgentçš„æ•ˆç‡å˜å¾—æ›´é«˜ã€‚</p>
<p>13.<strong>AGIï¼ˆé€šç”¨äººå·¥æ™ºèƒ½ï¼‰</strong> ï¼šAI çš„ â€œç»ˆæç›®æ ‡â€â€”â€” å…·å¤‡äººç±»çº§æ™ºæ…§ï¼Œèƒ½åšä»»ä½•äººç±»èƒ½åšçš„äº‹ï¼ˆåšé¥­ã€ç¼–ç¨‹ã€ç§‘ç ”ï¼‰ï¼Œç›®å‰è¿˜åœ¨ç†è®ºé˜¶æ®µï¼›</p>
<p>14.<strong>ASIï¼ˆè¶…çº§äººå·¥æ™ºèƒ½ï¼‰</strong> ï¼šæ¯”äººç±»æ™ºæ…§è¿˜å¼ºçš„ AIï¼Œç›®å‰ä»…å­˜åœ¨äºè®¾æƒ³ä¸­ã€‚</p>
<hr/>
<p>ï»¿</p>
<h2 data-id="heading-38">ç»“è¯­</h2>
<p>AI æŠ€æœ¯çš„æ ¸å¿ƒé€»è¾‘å¯æ¦‚æ‹¬ä¸º â€œä»æ•°æ®æ‰¾è§„å¾‹åˆ°è½åœ°å®ç”¨â€ çš„é€’è¿›è¿‡ç¨‹ï¼Œæœ¬è´¨ç®€æ´ä¸”å±‚å±‚èšç„¦ï¼š</p>
<p>æ ¸å¿ƒæ˜¯è®©æœºå™¨ä»æ•°æ®ä¸­å­¦ä¹ è§„å¾‹ â€”â€” æœºå™¨å­¦ä¹ æ˜¯åŸºç¡€ â€œæ‰¾è§„å¾‹â€ï¼Œæ·±åº¦å­¦ä¹ æ˜¯ â€œå¤šå±‚é€’è¿›æ‰¾è§„å¾‹â€ï¼Œå¤§æ¨¡å‹åˆ™æ˜¯ â€œæµ·é‡æ•°æ® + å¤šå±‚æ¶æ„â€ çš„é«˜æ•ˆæ‰¾è§„å¾‹ã€‚å…·ä½“é€šè¿‡å››å±‚å®ç°ï¼š</p>
<p>1.åŸºç¡€å±‚ï¼šæœºå™¨å­¦ä¹ è®©æœºå™¨ â€œä»æ•°æ®ä¸­æ‰¾è§„å¾‹â€ï¼Œç¥ç»ç½‘ç»œæ˜¯å®ç°è¿™ä¸€ç›®æ ‡çš„ â€œéª¨æ¶â€ï¼›</p>
<p>2.è¿›é˜¶å±‚ï¼šTransformer æ¶æ„ + æ³¨æ„åŠ›æœºåˆ¶è®©æœºå™¨ â€œé«˜æ•ˆæ‰¾è§„å¾‹ã€è®°é‡ç‚¹â€ï¼Œè§£å†³é•¿æ–‡æœ¬ã€é«˜éš¾åº¦ä»»åŠ¡ï¼›</p>
<p>3.ä¼˜åŒ–å±‚ï¼šé‡åŒ–ã€è’¸é¦ã€å¾®è°ƒã€MOE ç­‰æŠ€æœ¯è®©æœºå™¨ â€œå˜å°ã€å˜å¿«ã€å˜ä¾¿å®œâ€ï¼Œé€‚é…æ›´å¤šåœºæ™¯ï¼›</p>
<p>4.åº”ç”¨å±‚ï¼šå¤§æ¨¡å‹ï¼ˆå¦‚ ChatGPTã€DeepSeekï¼‰æ˜¯æœ€ç»ˆæˆæœï¼Œç›´æ¥æœåŠ¡äºæ—¥å¸¸èŠå¤©ã€åŠå…¬ã€ç¼–ç¨‹ç­‰éœ€æ±‚ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« è¦†ç›– AI å…¨é“¾è·¯çŸ¥è¯†ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°æ¶æ„ã€ä¼˜åŒ–æŠ€æœ¯ã€è½åœ°åº”ç”¨åŠæœ¯è¯­ï¼Œå¸Œæœ›èƒ½åœ¨æ­¤æ‰¾åˆ°è‡ªå·±éœ€è¦çš„å†…å®¹ã€‚è€Œå­¦ä¹  AI çš„å…³é”®ï¼Œæ­£å¦‚ Transformer æ¶æ„çš„é€»è¾‘ â€”â€” å…ˆæŒæ¡æ•´ä½“å…¨è²Œä¸åŸºæœ¬åŸç†ï¼Œå†å±‚å±‚æ·±å…¥å‰–æç»†èŠ‚.....</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»…ä¸¤å°ç¼“å­˜èŠ‚ç‚¹ï¼Œå¦‚ä½•æ”¯æ’‘ 1.45TB/s å¤§ååä¸šåŠ¡]]></title>    <link>https://juejin.cn/post/7595610998032826395</link>    <guid>https://juejin.cn/post/7595610998032826395</guid>    <pubDate>2026-01-16T05:35:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595610998032826395" data-draft-id="7595513077220343854" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»…ä¸¤å°ç¼“å­˜èŠ‚ç‚¹ï¼Œå¦‚ä½•æ”¯æ’‘ 1.45TB/s å¤§ååä¸šåŠ¡"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-16T05:35:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="JuiceFS"/> <meta itemprop="url" content="https://juejin.cn/user/2665636828032446"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»…ä¸¤å°ç¼“å­˜èŠ‚ç‚¹ï¼Œå¦‚ä½•æ”¯æ’‘ 1.45TB/s å¤§ååä¸šåŠ¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2665636828032446/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    JuiceFS
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T05:35:04.000Z" title="Fri Jan 16 2026 05:35:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>éšç€é¢å‘å¤§è§„æ¨¡å¹¶å‘è¯»å–ä¸æ•°æ®åˆ†å‘çš„ä¸šåŠ¡éœ€æ±‚å¢åŠ ï¼Œå¦‚å½±è§†æ¸²æŸ“ç­‰åœºæ™¯ï¼Œä¼ ç»Ÿå­˜å‚¨æ–¹æ¡ˆï¼ˆå¦‚ NASï¼‰åœ¨å¹¶å‘å®¢æˆ·ç«¯æ•°é‡å¢åŠ æ—¶ï¼Œå¾€å¾€éœ€è¦æŠ•å…¥æ›´å¤šç¼“å­˜èµ„æºï¼›ä¸ºäº†æå‡å“åº”æ—¶æ•ˆï¼Œé€šå¸¸è¿˜éœ€æå‰è¿›è¡Œæ•°æ®é¢„çƒ­ï¼Œä¸ä»…å¸¦æ¥é¢å¤–çš„æ—¶é—´å¼€é”€ï¼Œä¹Ÿè¿›ä¸€æ­¥åŠ é‡äº†èµ„æºè´Ÿæ‹…ã€‚</p>
<p>JuiceFS ä½œä¸ºä¸€ç§åŸºäºå¯¹è±¡å­˜å‚¨çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œé€šè¿‡å…¶é«˜æ€§èƒ½æ¶æ„ï¼Œåˆ©ç”¨åˆ†å¸ƒå¼ç¼“å­˜èšåˆååé‡å¹¶é™ä½å»¶è¿Ÿï¼Œèƒ½å¤Ÿåœ¨å¤§è§„æ¨¡å®¢æˆ·ç«¯å¹¶å‘è¯»å–æ—¶æä¾›é«˜æ•ˆæ”¯æŒã€‚æœ¬æ–‡åˆ†äº«çš„æ˜¯æˆ‘ä»¬è¿‘æœŸåœ¨å®é™…æµ‹è¯•ä¸­çš„ä¸€ä¸ªæ¡ˆä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åˆ©ç”¨ 4,000 å°ä¸šåŠ¡èŠ‚ç‚¹æˆåŠŸèšåˆäº† 1.45TB/s çš„å¸¦å®½ï¼Œå¹¶åœ¨æ­¤è¿‡ç¨‹ä¸­é€šè¿‡å¼•å…¥äºŒçº§ç¼“å­˜æ± ï¼Œä¿éšœäº†ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</p>
<p>é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸ºé«˜å¹¶å‘ã€å¤§ååéœ€æ±‚åœºæ™¯ä¸­çš„å­˜å‚¨ç“¶é¢ˆæä¾›ä¸€ä¸ªåˆ‡å®å¯è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶å€Ÿæ­¤æŠ›ç –å¼•ç‰ï¼Œæ¬¢è¿å¤§å®¶å…±åŒæ¢ç´¢å­˜å‚¨ä¼˜åŒ–çš„æ€è·¯ä¸æ–¹æ³•ã€‚</p>
<h2 data-id="heading-0">01 ä¼ ç»Ÿ NASï¼šèŠ‚ç‚¹è¶Šå¤šï¼Œå­˜å‚¨è¶Šæ…¢</h2>
<p>è¯¥å®¢æˆ·ä¸ºå½±è§†æ¸²æŸ“å†œåœºç”¨æˆ·ï¼Œæ—¥å¸¸ä½œä¸šä¸­ä¼šåŒæ—¶å¯åŠ¨æ•°åƒå° Windows èŠ‚ç‚¹è¿›è¡Œæ¸²æŸ“ã€‚</p>
<ul>
<li><strong>ä¸šåŠ¡ç‰¹ç‚¹</strong>ï¼šæ¯å°èŠ‚ç‚¹åœ¨æ¸²æŸ“æ—¶éœ€åŒæ—¶è¯»å–ä¸€æ‰¹æ–‡ä»¶ï¼ˆå¤§éƒ¨åˆ†ä¸ºé‡å¤ç´ æï¼‰åˆ°æœ¬åœ°ã€‚</li>
<li><strong>åŸæœ‰ç—›ç‚¹</strong>ï¼šåŸå…¬æœ‰äº‘ NAS å­˜å‚¨ï¼ˆSMB æŒ‚è½½ï¼‰åœ¨èŠ‚ç‚¹æ•°å¢å¤šæ—¶ï¼Œä¸å¾—ä¸ä¸æ–­å¢åŠ åç«¯ SMB æœåŠ¡èŠ‚ç‚¹æ¥åº”å¯¹æ¿€å¢çš„æµé‡å’Œ IOPSï¼Œå¯¼è‡´ç®¡ç†å¤æ‚åº¦å’Œæˆæœ¬ç›´çº¿ä¸Šå‡ã€‚å½“å¹¶å‘èŠ‚ç‚¹è¶…è¿‡ 1,000 å°æ—¶ï¼Œå­˜å‚¨ç³»ç»Ÿå¾€å¾€ä¸å ªé‡è´Ÿã€‚</li>
<li><strong>æ ¸å¿ƒéœ€æ±‚</strong>ï¼šè¿«åˆ‡éœ€è¦ä¸€ç§åœ¨å­˜å‚¨åº•åº§ä¹‹å¤–ï¼Œèƒ½å¤Ÿåˆ†æ‹…ä¸šåŠ¡ååå‹åŠ›çš„èƒ½åŠ›ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73608659d8f44ab9911c4f99ed4dc76a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769146503&amp;x-signature=IGNCMgX%2Fo4wlqJk9z28pw2Fu%2ByA%3D" alt="" loading="lazy"/></p>
<p>åœ¨ SMB æœåŠ¡æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªå®¢æˆ·ç«¯éƒ½éœ€è¦ä» SMB å­˜å‚¨è¯»å–å…¨é‡æ•°æ®ã€‚å¯¼è‡´æœåŠ¡ç«¯æµé‡é•¿æœŸé«˜ä½ï¼Œç®¡ç†å‘˜éœ€è¦æŒç»­ç›‘æ§ SMB æœåŠ¡çš„å¥åº·çŠ¶å†µï¼Œä¸€æ—¦æ¥è¿‘æœ€å¤§è´Ÿè·ï¼Œå°±éœ€è¦åŠæ—¶è¿›è¡Œæ‰©å®¹ï¼Œæä¾›ä¸é›†ç¾¤è§„æ¨¡åŒ¹é…çš„å­˜å‚¨èƒ½åŠ›ï¼Œè¿ç»´å‹åŠ›æ˜¾è‘—å¢åŠ ã€‚</p>
<h2 data-id="heading-1">02 é—²ç½®èµ„æºåˆ©ç”¨ï¼šç”¨å¤§é‡ä¸šåŠ¡èŠ‚ç‚¹åšåˆ†å¸ƒå¼ç¼“å­˜</h2>
<p>JuiceFS åœ¨ç¤¾åŒºç‰ˆ 1.3 åŠä¼ä¸šç‰ˆ 5.2 ä¹‹åå‘å¸ƒäº†å…¨æ–°çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fjuicefs.com%2Fdocs%2Fzh%2Fcloud%2Fgetting_started%23windows-installation" target="_blank" title="https://juicefs.com/docs/zh/cloud/getting_started#windows-installation" ref="nofollow noopener noreferrer">Windows å®¢æˆ·ç«¯</a>ï¼Œæ”¯æŒé€šè¿‡ <code>.exe</code> è¿›ç¨‹å°†æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ä¸ºæœ¬åœ°ç›˜ï¼Œä½¿ç”¨æ–¹å¼ä¸ Linux ç±»ä¼¼ã€‚</p>
<p>ä½†åœ¨æµ·é‡å®¢æˆ·ç«¯åœºæ™¯ä¸‹ï¼Œå¦‚æœä»…å°†ä¸šåŠ¡åˆ‡æ¢ä¸ºæ ‡å‡†çš„ã€ŒJuiceFS æŒ‚è½½ç‚¹ â€”â€” åˆ†å¸ƒå¼ç¼“å­˜ â€”â€” å¯¹è±¡å­˜å‚¨ã€é“¾è·¯ï¼Œæµé‡ä¼šé›†ä¸­æ‰“åˆ°ç‹¬ç«‹ç¼“å­˜å±‚ï¼Œå¯èƒ½æˆä¸ºæ–°çš„æ€§èƒ½ç“¶é¢ˆã€‚ä¸å…¶ä¸æ–­æ‰©å®¹ä¸“ç”¨çš„ç¼“å­˜èŠ‚ç‚¹ï¼Œä¸å¦‚è½¬æ¢æ€è·¯ï¼š<strong>åˆ©ç”¨æµ·é‡ä¸šåŠ¡èŠ‚ç‚¹è‡ªèº«çš„é—²ç½®å¸¦å®½å’Œç£ç›˜ï¼Œå°†å®ƒä»¬æ± åŒ–ä¸ºä¸€ä¸ªå·¨å¤§çš„åˆ†å¸ƒå¼ç¼“å­˜æ± ã€‚</strong></p>
<ul>
<li><strong>JuiceFS åˆ†å¸ƒå¼ç¼“å­˜æ¨¡å¼ï¼ˆP2P æ¨¡å¼ï¼‰</strong>ï¼šåŒä¸€ä»½æ–‡ä»¶åªéœ€åœ¨é›†ç¾¤å†…è¯»å–ä¸€æ¬¡ï¼Œåç»­å…¶ä»–èŠ‚ç‚¹ç›´æ¥ä» P2P ç¼“å­˜æ± çš„é‚»è¿‘èŠ‚ç‚¹è·å–ã€‚</li>
<li><strong>å¯¹è±¡å­˜å‚¨ä¾§</strong>ï¼šå›æºæµé‡æä½ï¼Œæ–‡ä»¶é¦–æ¬¡å†·è¯»åï¼Œåç»­æµé‡å‡ ä¹å…¨ç”±ç¼“å­˜æ± æ‰¿æ‹…ã€‚</li>
<li><strong>èµ„æºè¦æ±‚</strong>ï¼šæ— éœ€ä¸“ç”¨ç¼“å­˜ç¡¬ä»¶ï¼Œä»…éœ€æ¯ä¸ªä¸šåŠ¡èŠ‚ç‚¹è´¡çŒ®éƒ¨åˆ†ç£ç›˜å’Œå¸¦å®½ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œ<strong>æˆ‘ä»¬æ²¡æœ‰é…ç½®ä»»ä½•ä¸€å°ç‹¬ç«‹ç¼“å­˜èŠ‚ç‚¹ã€‚æ‰€æœ‰çš„ä¸šåŠ¡èŠ‚ç‚¹æ—¢æ˜¯æ¶ˆè´¹è€…ï¼Œä¹Ÿæ˜¯æä¾›è€…</strong>ï¼ˆP2P æ¨¡å¼ï¼‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c3e05c72b0d6407b8f0c3aa0ba458e6a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769146503&amp;x-signature=9oa9KiCrbiUMk08uRLTZ%2BvqoddA%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-2">03 å®æµ‹æ¡ˆä¾‹ï¼š4,000 å°ä¸šåŠ¡èŠ‚ç‚¹èšåˆåˆ° 1.45TB/s çš„å·¨å¤§åå</h2>
<p><strong>æµ‹è¯•ä»»åŠ¡</strong>ï¼šæ¯å° Windows æœºå™¨åœ¨æ— é¢„çƒ­ï¼ˆå†·è¯»ï¼‰çš„æƒ…å†µä¸‹ï¼Œè¯»å– 16 ä¸ª 2GB çš„å¤§æ–‡ä»¶ã€‚ ç»Ÿè®¡æ‰€æœ‰èŠ‚ç‚¹è¯»å®Œçš„æ€»è€—æ—¶ï¼Œå¹¶è§‚å¯Ÿå„èŠ‚ç‚¹çš„è€—æ—¶æ–¹å·®ï¼Œä»¥åŠæ˜¯å¦å­˜åœ¨é•¿å°¾æ•ˆåº”ã€‚</p>
<p><strong>é…ç½®ç­–ç•¥</strong>ï¼šå°† 4,000 ä¸ªèŠ‚ç‚¹æ‹†åˆ†ä¸ºå¤šä¸ªå­ç»„ï¼ˆæ¯ç»„ 500 ä¸ªèŠ‚ç‚¹ï¼‰ã€‚16 ä¸ª 2GB çš„æ•°æ®å—ä¼šæ•£åˆ—åˆ†å¸ƒåœ¨ç»„å†…èŠ‚ç‚¹ä¸­ï¼Œé¿å…æ‰€æœ‰èŠ‚ç‚¹åŒæ—¶å›æºå¯¹è±¡å­˜å‚¨ï¼Œé€ æˆæ‹¥å¡ã€‚</p>
<p>é‚£ä¹ˆç°åœ¨ JuiceFS å®¢æˆ·ç«¯çš„å†·è¯»æµç¨‹å°±å˜ä¸ºï¼š</p>
<ol>
<li>Windows å®¢æˆ·ç«¯è¯»å– 16 ä¸ª 2GB çš„æ–‡ä»¶ï¼Œé€šè¿‡ä¸€è‡´æ€§å“ˆå¸Œæ‹“æ‰‘å®šä½è¿™äº›æ•°æ®å—åœ¨ 500 ä¸ªç¼“å­˜ç»„å†…çš„è´Ÿè´£èŠ‚ç‚¹ï¼Œå‘å…¶å‘èµ·è¯·æ±‚ã€‚</li>
<li>ç¼“å­˜èŠ‚ç‚¹æ”¶åˆ°äº†æ•°æ®å—è¯·æ±‚åï¼Œå‘ç°æœ¬åœ°æœªå‘½ä¸­ç¼“å­˜ï¼ˆå†·è¯»ï¼‰ï¼Œåˆ™å›æºå¯¹è±¡å­˜å‚¨æ‹‰å–æ•°æ®å—ï¼Œæ‹‰å–å®Œæˆåå°†æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”å†™å…¥æœ¬åœ°ç¼“å­˜ï¼Œä¾›åç»­è¯·æ±‚å¤ç”¨ã€‚</li>
<li>å½“å®¢æˆ·ç«¯ä»æ‰€æœ‰ç¼“å­˜æœåŠ¡èŠ‚ç‚¹è·å–å®Œæ•´æ•°æ®å—åï¼Œæµ‹è¯•ç»“æŸï¼Œç»Ÿè®¡æ‰€æœ‰å®¢æˆ·ç«¯è¯»å®Œçš„è€—æ—¶åˆ†å¸ƒï¼ˆæœ€å¤§å€¼ã€æœ€å°å€¼ï¼‰ï¼Œç”¨äºè¯„ä¼°æ–¹å·®ä¸é•¿å°¾æƒ…å†µã€‚</li>
</ol>
<p>ä¸‹é¢æ˜¯ä¸åŒå®¢æˆ·ç«¯èŠ‚ç‚¹æ•°é‡è¯»å–è¿™æ‰¹ 16*2GB å¤§æ–‡ä»¶çš„æ—¶é—´ç»“æœï¼š</p>



































<table><thead><tr><th align="center">å®¢æˆ·ç«¯å°æ•°</th><th align="left">èšåˆååæœ€é«˜</th><th align="left">æ€»è€—æ—¶ï¼ˆèŒƒå›´/å¹³å‡ï¼‰</th></tr></thead><tbody><tr><td align="center">2,000 å°</td><td align="left"><strong>729GB/s</strong></td><td align="left">92s~136s å¹³å‡ 107s</td></tr><tr><td align="center">2,500 å°</td><td align="left"><strong>921GB/s</strong></td><td align="left">87s~109s å¹³å‡ 98s</td></tr><tr><td align="center">3,000 å°</td><td align="left"><strong>1.11TB/s</strong></td><td align="left">93s~121s å¹³å‡ 106s</td></tr><tr><td align="center">3,500 å°</td><td align="left"><strong>1.34TB/s</strong></td><td align="left">89~112s å¹³å‡ 100s</td></tr><tr><td align="center">4,000 å°</td><td align="left"><strong>1.45TB/s</strong></td><td align="left">92s~115s å¹³å‡ 101s</td></tr></tbody></table>
<p>ä¸åŒæ•°é‡å®¢æˆ·ç«¯ï¼ŒJuiceFS èšåˆååè¡¨ç°</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5569fb6c97df4846aef07c566dc1a80c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769146503&amp;x-signature=ndOp28trk%2FxpSc7GusT%2F2lFyRAY%3D" alt="" loading="lazy"/></p>
<p>æ•´ä½“ç»“æœå„æ–¹é¢éƒ½ç¬¦åˆé¢„æœŸï¼š</p>
<ul>
<li><strong>ç¨³å®šæ€§</strong>ï¼šæ— è®ºæ˜¯ 2,000 å°è¿˜æ˜¯ 4,000 å°ï¼Œè¯»å®Œæ•°æ®çš„æ€»è€—æ—¶éƒ½ç¨³å®šåœ¨ 100 ç§’å·¦å³ã€‚</li>
<li><strong>æ‰©å±•æ€§</strong>ï¼š<strong>4,000 å°èŠ‚ç‚¹æˆåŠŸèšåˆå‡º 1.45TB/s çš„è¶…å¤§å¸¦å®½ï¼Œç†è®ºä¸Šï¼Œåœ¨å…ƒæ•°æ®èƒ½å¤Ÿæ‰¿è½½çš„å‰æä¸‹ï¼Œè¯¥æ¶æ„å¯å®ç°æŒç»­çš„æ°´å¹³æ‰©å±•ï¼Œèƒ½å¤Ÿæ”¯æŒè¾¾åˆ°ä¸‡å°çº§åˆ«çš„ç¼“å­˜èŠ‚ç‚¹è§„æ¨¡ã€‚</strong></li>
</ul>
<p>ä¸šåŠ¡èŠ‚ç‚¹çš„æŒ‚è½½å‚æ•°å‚è€ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash">juicefs.exe mount juice-fs X: --cache-group=primary --buffer-size=4096 --enable-kernel-cache --as-root --subgroups=8
</code></pre>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬æœªä½¿ç”¨ä¸€å°ç‹¬ç«‹çš„ç¼“å­˜æœåŠ¡èŠ‚ç‚¹ï¼Œä»…é ç”¨æˆ·çš„ä¸šåŠ¡èŠ‚ç‚¹å°±èšåˆäº† 1.45TB/s çš„è¯»å–èƒ½åŠ›ã€‚è¿‡å®¢é€šæˆ·ç«¯èŠ‚ç‚¹ç»„æˆçš„åˆ†å¸ƒå¼ç¼“å­˜å±‚ï¼Œæˆ‘ä»¬ä»¥é›¶æˆæœ¬å°†ç»å¤§å¤šæ•°æµé‡ä»å¯¹è±¡å­˜å‚¨ä¸­åˆ†æµï¼Œå‡è½»äº†åº•å±‚å­˜å‚¨çš„è´Ÿæ‹…ã€‚</p>
<p>å®é™…ä¸šåŠ¡ä¸­ï¼Œæœªå¿…èƒ½è¾¾åˆ°å¦‚æ­¤é«˜çš„ååèƒ½åŠ›ï¼Œå› ä¸ºç¼“å­˜æ•ˆç›Šé€šå¸¸ä¸æ•°æ®é‡å¤åº¦ç›¸å…³ã€‚åœ¨å®é™…åœºæ™¯ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¯»å–çš„æ–‡ä»¶å¹¶ä¸å®Œå…¨ç›¸åŒã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿™ä¸€æ–¹æ¡ˆä»ç„¶æ˜¯æœ‰æ•ˆçš„å­˜å‚¨æ‰©å±•æ–¹æ³•ï¼Œå³ä½¿åªæœ‰éƒ¨åˆ†æå‡ï¼Œä¹Ÿèƒ½å¸¦æ¥éå¸¸å¯è§‚çš„æ”¶ç›Šï¼Œä¸”å‡ ä¹ä¸éœ€è¦é¢å¤–çš„æˆæœ¬æŠ•å…¥ã€‚</p>
<h2 data-id="heading-3">04 ç¨³å®šæ€§å¢å¼ºï¼šä¸¤çº§åˆ†å¸ƒå¼ç¼“å­˜</h2>
<p>ç¼“å­˜æ•ˆæœè™½ç„¶ç‚¸è£‚ï¼Œä½†å®¢æˆ·å¯¹ç³»ç»Ÿçš„ç¨³å®šæ€§æå‡ºäº†æ‹…å¿§ã€‚ä¾‹å¦‚ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä¸šåŠ¡èŠ‚ç‚¹åœ¨å®Œæˆä»»åŠ¡åä¼šç«‹å³é”€æ¯ï¼Œè€Œè¿™äº›ä¸šåŠ¡èŠ‚ç‚¹åŒæ—¶ä¹Ÿæ˜¯ç¼“å­˜èŠ‚ç‚¹ã€‚å½“å¤§é‡ä¸šåŠ¡èŠ‚ç‚¹çªç„¶ä¸‹çº¿æ—¶ï¼ŒåŸæœ¬å­˜å‚¨åœ¨è¿™äº›èŠ‚ç‚¹ä¸Šçš„ç¼“å­˜ä¹Ÿéšä¹‹ä¸¢å¤±ï¼Œå¯¼è‡´å¤§é‡æµé‡å›æºè‡³å¯¹è±¡å­˜å‚¨ï¼Œè¿›è€Œä½¿å¯¹è±¡å­˜å‚¨æˆä¸ºç“¶é¢ˆï¼Œå½±å“æ•´ä½“ç¨³å®šæ€§ã€‚ä¸ºäº†è§£å†³å› ä¸šåŠ¡èŠ‚ç‚¹æ³¢åŠ¨å¼•å‘çš„ç¼“å­˜æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸¤çº§åˆ†å¸ƒå¼ç¼“å­˜æ–¹æ¡ˆï¼Œæ¶æ„å›¾å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dd3953e1d679410cb5bbe11fea476677~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgSnVpY2VGUw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769146503&amp;x-signature=mCuro4zhvMMiZV47agYkk%2FIfgnU%3D" alt="" loading="lazy"/></p>
<p>ç¬¬äºŒå±‚ç¼“å­˜æ± ï¼ˆL2ï¼‰ä½äºç¬¬ä¸€å±‚ï¼ˆL1ï¼‰ç¼“å­˜æ± å’Œå¯¹è±¡å­˜å‚¨ä¹‹é—´ã€‚å½“ L1 æœªå‘½ä¸­æ—¶ï¼Œæ•°æ®é¦–å…ˆä¼šä» L2 è·å–ï¼›å¦‚æœ L2 ç¼“å­˜ä¹Ÿæœªå‘½ä¸­ï¼Œåˆ™å›æºåˆ°å¯¹è±¡å­˜å‚¨ã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆæŠµæ¶ˆ L1 ç¼“å­˜èŠ‚ç‚¹æ³¢åŠ¨å¸¦æ¥çš„å½±å“ã€‚åŠ å…¥ L2 ç¼“å­˜æ± åï¼Œè¯»å–æµç¨‹å‘ç”Ÿäº†ä»¥ä¸‹å˜åŒ–ï¼š</p>
<ul>
<li>åœ¨ Windows å®¢æˆ·ç«¯è¯»å– 16 ä¸ª 2GB çš„æ–‡ä»¶ï¼Œé€šè¿‡ä¸€è‡´æ€§å“ˆå¸Œæ‹“æ‰‘ç¡®å®šæ•°æ®å—æ‰€åœ¨ L1 ç¼“å­˜ç»„ä¸­çš„ç‰¹å®šèŠ‚ç‚¹ï¼›å¹¶åŒæ—¶å‘ L2 ç¼“å­˜ç»„è¯·æ±‚æ•°æ®ã€‚</li>
<li>ç”±äºæ˜¯å†·è¯»ï¼ŒL2 ç¼“å­˜ç»„ä¸­æ²¡æœ‰æ•°æ®ï¼ŒL2 ç¼“å­˜èŠ‚ç‚¹ä¼šå‘å¯¹è±¡å­˜å‚¨å‘èµ·è¯·æ±‚å¹¶å¡«å…… L2 ç¼“å­˜æ± ã€‚</li>
<li>æ•°æ®å—ä» L2 ç¼“å­˜æ± è¿”å›è‡³ L1 ç¼“å­˜æ± å¹¶è¿›è¡Œå¡«å……ï¼Œç„¶åç”± L1 ç¼“å­˜æ± å†…çš„èŠ‚ç‚¹è‡ªè¡Œè¿›è¡Œç‚¹å¯¹ç‚¹ï¼ˆP2Pï¼‰åˆ†å‘ã€‚</li>
<li><strong>æ­¤æ—¶ï¼Œå¤§éƒ¨åˆ†æµé‡é›†ä¸­åœ¨ L1 ç¼“å­˜æ± ï¼ŒL2 åªå¤„ç†æå°‘æ•°å›æºå¯¹è±¡å­˜å‚¨çš„æµé‡ï¼Œå› æ­¤å³ä½¿ L2 åªæœ‰å°‘æ•°å‡ ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿä¸ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚L2 ç¼“å­˜æ± çš„ä½œç”¨æ˜¯å°±è¿‘æ›¿ä»£å¯¹è±¡å­˜å‚¨ï¼Œé™ä½å»¶è¿Ÿã€‚</strong></li>
</ul>
<p>å³ä½¿å¤§é‡ L1 ä¸šåŠ¡èŠ‚ç‚¹ä¸‹çº¿ï¼Œç¼“å­˜æ‹“æ‰‘å‘ç”Ÿå˜åŒ–å¹¶éœ€è¦é‡æ–°ä¸‹è½½æ•°æ®å—ï¼Œæ•°æ®ä»å¯ä» L2 ç¼“å­˜æ± å°±è¿‘è·å–ã€‚åªè¦åˆç†æ§åˆ¶ä¸‹çº¿æ¯”ä¾‹ï¼Œä¸šåŠ¡å‡ ä¹ä¸å—å½±å“ã€‚</p>
<p>L2 ç¼“å­˜ç»„æŒ‚è½½å‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">juicefs mount juice-fs /jfs-cache --cache-group=secondary --cache-size=-1 --cache-dir=/data* --free-space-ratio=0.01 --buffer-size=10240 --max-downloads=400
</code></pre>
<p>L1ï¼ˆä¸šåŠ¡èŠ‚ç‚¹ï¼‰æŒ‚è½½å‚æ•°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">juicefs.exe mount juice-fs X: --cache-group=primary --second-group=secondary --buffer-size=4096 --enable-kernel-cache --as-root --subgroups=8
</code></pre>
<p><strong>æ­¤å¤–ï¼Œä¸¤çº§åˆ†å¸ƒå¼ç¼“å­˜è¿˜éå¸¸é€‚ç”¨äºéœ€è¦é‡å¤åˆ©ç”¨å·²æœ‰ç¼“å­˜æ± çš„åœºæ™¯</strong>ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€æ‰¹ä½äºåŒ—äº¬çš„ç¼“å­˜æ± ä¸šåŠ¡ï¼Œæ€»å®¹é‡ä¸º 2PiBï¼Œç¼“å­˜æ± åä¸º cache-group-bjã€‚çªç„¶ï¼Œä¸Šæµ·çš„ä¸šåŠ¡ä¹Ÿéœ€è¦ä½¿ç”¨ç›¸åŒçš„æ•°æ®ï¼Œè€Œè¿™äº›æ•°æ®ä¸åŒ—äº¬çš„æ•°æ®å‡ ä¹å®Œå…¨ç›¸åŒã€‚å¦‚æœä¸å¸Œæœ›é‡æ–°ä»åŒ—äº¬çš„å¯¹è±¡å­˜å‚¨ä¸­é¢„çƒ­è¿™ 2PiB çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸Šæµ·çš„ç¼“å­˜ç»„ä¸­é…ç½® <code>--second-group=cache-group-bj</code>ã€‚è¿™æ ·ï¼Œå½“ä¸Šæµ·çš„ä¸šåŠ¡è¯·æ±‚æ•°æ®æ—¶ï¼Œå°†ä¼˜å…ˆé€šè¿‡ä¸“çº¿ä»åŒ—äº¬çš„ç¼“å­˜æ± è¯»å–æ•°æ®ï¼Œé€Ÿåº¦éå¸¸å¿«ä¸”å»¶è¿Ÿç¨³å®šï¼ˆåœ¨ 2ms ä»¥å†…ï¼‰ï¼Œå…å»äº†é‡å¤é¢„çƒ­æ•°æ®çš„å¤æ‚è¿‡ç¨‹ï¼Œèƒ½å¤Ÿç›´æ¥å¯åŠ¨ä¸šåŠ¡ï¼Œæå¤§åœ°æ–¹ä¾¿äº†æ“ä½œã€‚</p>
<h2 data-id="heading-4">05 å°ç»“</h2>
<p>é€šè¿‡æœ¬æ¬¡ 4,000 èŠ‚ç‚¹çš„æé™å‹æµ‹ï¼Œæˆ‘ä»¬æˆåŠŸå°†è®¡ç®—é›†ç¾¤çš„å¤§è§„æ¨¡é—²ç½®èµ„æºè½¬åŒ–ä¸ºé«˜è¾¾ 1.45TB/s çš„å­˜å‚¨æ± ï¼›è€ŒäºŒçº§ç¼“å­˜çš„å¼•å…¥ï¼Œæœ‰æ•ˆè§£å†³äº†â€œæœ€åä¸€å…¬é‡Œâ€çš„ç¨³å®šæ€§é¡¾è™‘ã€‚é€šè¿‡ä½¿ç”¨ JuiceFS è¿™å¥—å­˜å‚¨è½¯ä»¶æ¶æ„ï¼Œå¯å……åˆ†æŒ–æ˜å®¢æˆ·ç«¯é›†ç¾¤çš„æ½œèƒ½ï¼Œåœ¨ä¸å¢åŠ é¢å¤–ç¡¬ä»¶æˆæœ¬çš„æƒ…å†µä¸‹ï¼Œå®ç°äº†æ€§èƒ½çš„æ˜¾è‘—æå‡ã€‚</p>
<p>æœ¬æ–¹æ¡ˆé€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li><strong>é«˜å¹¶å‘é‡å¤è¯»å–åœºæ™¯</strong>ï¼šå¦‚æ¨¡å‹è®­æ¨æ•°æ®è°ƒç”¨ã€å®¹å™¨é•œåƒåˆ†å‘ã€å½±è§†æ¸²æŸ“ç­‰ï¼ŒèŠ‚ç‚¹è¶Šå¤šï¼ŒP2P ç¼“å­˜æ”¶ç›Šè¶Šå¤§ï¼›</li>
<li><strong>å¼¹æ€§è®¡ç®—åœºæ™¯</strong>ï¼šä¸šåŠ¡èŠ‚ç‚¹ç»å¸¸å¤§è§„æ¨¡æ‰©ç¼©å®¹ï¼ˆå¦‚ Spot Instancesï¼‰ï¼Œåˆ©ç”¨äºŒçº§ç¼“å­˜æ¶æ„å¯ç¡®ä¿æ•°æ®è®¿é—®çš„è¿ç»­æ€§ä¸ç¨³å®šæ€§ï¼›</li>
<li><strong>æ··åˆäº‘/å¤šäº‘æ¶æ„</strong>ï¼šåˆ©ç”¨äºŒçº§ç¼“å­˜æœºåˆ¶å¯ä»¥å¤ç”¨å¼‚åœ°ç¼“å­˜æ± èµ„æºï¼Œæœ€å¤§ç¨‹åº¦å‡å°‘é‡å¤é¢„çƒ­å¸¦æ¥çš„å¯¹è±¡å­˜å‚¨è°ƒç”¨å’Œä¼ è¾“æˆæœ¬ã€‚</li>
</ul>
<p>æˆ‘ä»¬å¸Œæœ›æœ¬æ–‡ä¸­çš„ä¸€äº›å®è·µç»éªŒï¼Œèƒ½ä¸ºæ­£åœ¨é¢ä¸´ç±»ä¼¼é—®é¢˜çš„å¼€å‘è€…æä¾›å‚è€ƒï¼Œå¦‚æœæœ‰å…¶ä»–ç–‘é—®æ¬¢è¿åŠ å…¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fjuicefs.com%2F" target="_blank" title="https://juicefs.com/" ref="nofollow noopener noreferrer">JuiceFS ç¤¾åŒº</a>ä¸å¤§å®¶å…±åŒäº¤æµã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Qunaré…’åº—æœç´¢æ’åºæ¨¡å‹çš„æ¼”è¿›]]></title>    <link>https://juejin.cn/post/7595626157908869129</link>    <guid>https://juejin.cn/post/7595626157908869129</guid>    <pubDate>2026-01-16T06:36:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595626157908869129" data-draft-id="7594813727053070370" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Qunaré…’åº—æœç´¢æ’åºæ¨¡å‹çš„æ¼”è¿›"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„,æ“ä½œç³»ç»Ÿ"/> <meta itemprop="datePublished" content="2026-01-16T06:36:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å»å“ªå„¿æŠ€æœ¯æ²™é¾™"/> <meta itemprop="url" content="https://juejin.cn/user/2251436075786791"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Qunaré…’åº—æœç´¢æ’åºæ¨¡å‹çš„æ¼”è¿›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2251436075786791/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å»å“ªå„¿æŠ€æœ¯æ²™é¾™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T06:36:01.000Z" title="Fri Jan 16 2026 06:36:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»27åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h3>
<p>åœ¨ç”¨æˆ·åœ¨çº¿æµè§ˆé…’åº—æ—¶ï¼Œæ—…è¡Œå¹³å°éœ€è¦è§£å†³ä¸€ä¸ªé‡è¦é—®é¢˜ï¼šå¦‚ä½•æ›´å¥½åœ°ä¸ºç”¨æˆ·æŒ‘é€‰é€‚åˆçš„é…’åº—ï¼Œå¹¶é™ä½ç”¨æˆ·é€‰æ‹©çš„è´¹åŠ›åº¦ã€‚è€Œä¸ºç”¨æˆ·æŒ‘é€‰ç¬¦åˆéœ€æ±‚çš„é…’åº—ï¼Œéœ€è¦åƒäººåƒé¢çš„æ¨¡å‹æ’åºã€‚åœ¨å»å“ªå„¿ï¼ˆQunarï¼‰APPä¸­ï¼Œè§¦å‘ä¸ªæ€§åŒ–æ’åºçš„åœºæ™¯ä¸»è¦æ˜¯æ¬¢è¿åº¦æ’åºï¼ˆè§å›¾1ï¼‰ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/030c148d0fef4833bc48244848ee773e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=iuKj3qAYd6gOHRCAiyK4AEipxwE%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾1 Qunaré…’åº—æœç´¢äº§å“å½¢æ€</p>
<h3 data-id="heading-1">äºŒã€Qunaré…’åº—æœç´¢æ’åºæ¶æ„</h3>
<p>Qunaré…’åº—æœç´¢æ¨èç³»ç»Ÿçš„æ€»ä½“æµç¨‹å¯ä»¥åˆ†æˆå››å—ï¼Œä¸»è¦æ˜¯å¬å›ã€ç²—æ’ã€ç²¾æ’ã€é‡æ’ã€‚å…¶ä¸­ç²¾æ’ä¸»è¦ä¼šæ ¹æ®ç”¨æˆ·çš„æœç´¢å…³é”®è¯å’Œå…¶ä»–ç›¸å…³ä¿¡æ¯ï¼Œé€‰å‡ºä¸ç”¨æˆ·éœ€æ±‚æœ€ç›¸ç¬¦åˆçš„é…’åº—ï¼Œç¡®ä¿åœ¨æœç´¢ç»“æœä¸­ï¼Œç”¨æˆ·èƒ½å¤Ÿçœ‹åˆ°é‚£äº›ä¸å…¶éœ€æ±‚æœ€ç›¸å…³çš„é…’åº—ã€‚è€ŒQunaré…’åº—é•¿æœŸä¼˜åŒ–çš„ä¸šåŠ¡ç›®æ ‡æ˜¯s2oï¼Œå³ä¸‹å•ç”¨æˆ·æ•°/æœç´¢ç”¨æˆ·æ•°ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e976df357f39491d86bf0eb55927c8c2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=J4FS6mJjGyxn6kSjDix5UKzojpY%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾2 Qunaræœç´¢æ¶æ„</p>
<h3 data-id="heading-2">ä¸‰ã€Qunaré…’åº—æœç´¢ç²¾æ’æ’åºçš„å‘å±•å†ç¨‹</h3>
<p>ç¬¬ä¸€é˜¶æ®µå‡çº§æœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œé…’åº—æœç´¢ä¸šåŠ¡å‡†å¤‡ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹æ›¿æ¢äººå·¥è§„åˆ™æ’åºã€‚ä¸ºäº†èƒ½å¿«é€Ÿä¸Šçº¿éªŒè¯æ¨¡å‹æ•ˆæœï¼Œå¹¶è€ƒè™‘åˆ°é…’åº—ä¸šåŠ¡å¤©ç”Ÿè‡ªå¸¦å¤§é‡è¿ç»­ç‰¹å¾ï¼Œå¦‚é…’åº—ä»·æ ¼ã€é…’åº—è·ç¦»ç­‰ï¼Œæˆ‘ä»¬é€‰æ‹©äº†å¯¹è¿ç»­ç‰¹å¾æ¯”è¾ƒå‹å¥½çš„æ ‘æ¨¡å‹LambdaMartæ¨¡å‹ã€‚</p>
<p>ç¬¬äºŒé˜¶æ®µå‡çº§æ·±åº¦æ¨¡å‹ï¼ŒLambdaMartæ’åºæ¨¡å‹å¸¸ç”¨çš„è¿­ä»£ä¼˜åŒ–æ‰‹æ®µï¼Œå¦‚æ·»åŠ ç‰¹å¾ã€æ ·æœ¬è°ƒæ•´ç­‰å‡ ä¹å·²ç»æ— æ³•å¸¦æ¥å¢é‡æ”¶ç›Šï¼Œå› æ­¤æˆ‘ä»¬å‡†å¤‡å‡çº§æˆæ¯”æ ‘æ¨¡å‹å¤©èŠ±æ¿æ›´é«˜çš„æ·±åº¦æ¨¡å‹æ¶æ„LambdaDNNã€‚</p>
<p>ç¬¬ä¸‰é˜¶æ®µå‡çº§å¤šç›®æ ‡æ¨¡å‹ï¼ŒLambdaDNNæ’åºæ¨¡å‹ä¸»è¦è¿˜æ˜¯èšç„¦å•ç›®æ ‡å»ºæ¨¡ï¼ˆCTCVRï¼‰ï¼Œè€Œå¤šç›®æ ‡å»ºæ¨¡æ›´å¥½çš„è€ƒè™‘äº†æ’åºå…¨ç©ºé—´çš„æ›å…‰æ ·æœ¬ï¼Œç»¼åˆè€ƒè™‘äº†ä¸‹å•å‰çš„ç”¨æˆ·ç‚¹å‡»è¡Œä¸ºï¼Œé™ä½æ ·æœ¬åå·®é—®é¢˜ï¼Œæˆ‘ä»¬å€Ÿé‰´äº†Googleçš„MMOEæ¨¡å‹ï¼ŒåŒæ—¶å­¦ä¹ CTRç›®æ ‡ä»»åŠ¡å’ŒCTCVRç›®æ ‡ä»»åŠ¡ã€‚</p>
<p>ç¬¬å››é˜¶æ®µå‡çº§å¤šåœºæ™¯å¤šç›®æ ‡æ¨¡å‹ï¼Œé…’åº—ä¸šåŠ¡æœç´¢åœºæ™¯åˆ†ä¸ºåŒåŸç©ºæœã€å¼‚åœ°ç©ºæœç­‰ï¼Œæ¯ä¸ªåœºæ™¯å•ç‹¬ä¸€ä¸ªæ¨¡å‹ï¼Œä½¿å¾—ç»´æŠ¤æˆæœ¬å¾ˆé«˜ï¼Œå¹¶ä¸”ç”¨æˆ·å‡ºè¡Œæ—¶ï¼Œä¼šåœ¨å¤šä¸ªåœºæ™¯ï¼ˆåŒåŸæœç´¢ã€å¼‚åœ°æœç´¢ï¼‰ä¸‹æœç´¢æ‰¾åˆ°ç¬¦åˆè‡ªå·±æœŸæœ›çš„é…’åº—ã€‚è‹¥å°†å¤šä¸ªåœºæ™¯åˆ†åˆ«å•ç‹¬è®­ç»ƒæ¨¡å‹ï¼Œä¼šä½¿å¾—ç”¨æˆ·è¿è´¯çš„æœç´¢è¡Œä¸ºå‰²è£‚ï¼Œå­¦ä¹ ä¸åˆ°ç”¨æˆ·åœ¨ä¸åŒåœºæ™¯ä¸‹çš„å·®å¼‚å’Œå…±æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æå‡ºå°†ä¿¡æ¯è¡¨å¾æ‹†åˆ†ï¼Œèåˆå¤šåœºæ™¯æ ·æœ¬çš„å¤šåœºæ™¯å¤šç›®æ ‡æ¨¡å‹ã€‚</p>
<p>ä¸‹é¢å…·ä½“é˜è¿°æˆ‘ä»¬åœ¨Qunaré…’åº—æœç´¢æ’åºæ¨¡å‹çš„æ¼”è¿›ã€‚</p>
<h3 data-id="heading-3">å››ã€Qunaré…’åº—æœç´¢ç²¾æ’æ’åºç®—æ³•çš„è¿­ä»£</h3>
<p>æ’åºå­¦ä¹ ï¼ˆLearning to Rankï¼‰æ˜¯ä¸€ä¸ªç›‘ç£å­¦ä¹ è¿‡ç¨‹ï¼Œç»™å®šä¸€ä¸ªqueryï¼Œæœç´¢å¼•æ“ä¼šå¬å›ä¸€ç³»åˆ—ç›¸å…³çš„itemï¼Œç„¶åå¯¹è¿™äº›å¬å›çš„itemè¿›è¡Œæ’åºï¼Œæœ€åå°†Top Nçš„itemè¾“å‡ºã€‚è€Œæ’åºé—®é¢˜å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªæ¨¡å‹ f(q,d)æ¥å¯¹è¯¥queryä¸‹çš„itemè¿›è¡Œæ’åºï¼Œåˆ†ä¸ºPointWiseï¼ŒPairWiseï¼ŒListWiseä¸‰ç§æ’åºå­¦ä¹ æ–¹å¼ã€‚</p>
<p>PointWiseï¼šè¾“å…¥ç©ºé—´ä¸­æ ·æœ¬æ˜¯å•ä¸ª itemï¼ˆå’Œå¯¹åº” queryï¼‰æ„æˆçš„ç‰¹å¾å‘é‡ï¼Œè¾“å‡ºç©ºé—´ä¸­æ ·æœ¬æ˜¯å•ä¸ª itemï¼ˆå’Œå¯¹åº” queryï¼‰çš„ç›¸å…³åº¦ï¼Œæ˜¯å°†æ‰€æœ‰ç”¨æˆ·çš„æ ·æœ¬ç©ºé—´çš„æ ·æœ¬åŒç­‰å¯¹å¾…ã€‚</p>
<p>PairWiseï¼šè¾“å…¥ç©ºé—´ä¸­æ ·æœ¬æ˜¯ï¼ˆåŒä¸€ query å¯¹åº”çš„ï¼‰ä¸¤ä¸ªitemæ„æˆçš„ä¸¤ä¸ªç‰¹å¾å‘é‡ï¼Œè¾“å‡ºç©ºé—´ä¸­æ ·æœ¬å¯¹çš„ååºå…³ç³»ï¼Œæ­¤æ–¹æ³•å­¦ä¹ äº†åŒä¸€ä¸ªqueryä¸‹çš„ä¸¤ä¸ªæ ·æœ¬å¯¹æ¯”åå¥½ã€‚</p>
<p>ListWiseï¼šè¾“å…¥ç©ºé—´ä¸­æ ·æœ¬æ˜¯ï¼ˆåŒä¸€ query å¯¹åº”çš„ï¼‰æ‰€æœ‰itemæ„æˆçš„å¤šä¸ªç‰¹å¾å‘é‡åˆ—è¡¨ï¼Œè¾“å‡ºç©ºé—´æ˜¯åŒä¸€ä¸ªqueryä¸‹çš„æœ€ä¼˜æ’åºåˆ—è¡¨ï¼Œæ˜¯pairwiseå’Œlambdaæ¢¯åº¦çš„ç»“åˆï¼Œå¦‚LambdaMartç®—æ³•ï¼Œå¯¹æ•´ä¸ªåˆ—è¡¨å»ºæ¨¡ï¼Œå­¦ä¹ ä¸€ä¸ªæœ€ä¼˜æ’åºåˆ—è¡¨ã€‚</p>















<table><thead><tr><th>pointWise</th><th>pairWise</th><th>listWise</th></tr></thead><tbody><tr><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e465e1ee37546e2a082c2453b5efb31~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=XEThDzGzChSk93nvwrmVC%2FLat5s%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be0b25796d3448eab81e26e6200ea2fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=eZ1nu4KZzD%2BmEFeOZyTnp85IUYQ%3D" alt="" loading="lazy"/></td><td><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86f7b1da238e4f408166fea126d137ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=vULzqmFWqcAISTjuc%2B9dE8b6A5M%3D" alt="" loading="lazy"/></td></tr></tbody></table>
<p>æ¨¡å‹çš„é¢„æµ‹ç›®æ ‡ä¸ä¸šåŠ¡æŒ‡æ ‡ä¹‹é—´å­˜åœ¨ä¸€å®šçš„å·®è·ï¼ŒPointwiseæ³¨é‡å•ä¸ªç‰©å“çš„ç‚¹å‡»ç‡ï¼Œå¯¹æ‰€æœ‰è¯·æ±‚ä¸‹çš„ç‰©å“åŒç­‰å¯¹å¾…ï¼Œä¸æœç´¢ä¸šåŠ¡æŒ‡æ ‡å­˜åœ¨è¾ƒå¤§çš„Gapï¼Œè€Œæœç´¢ä¸šåŠ¡æ›´å…³æ³¨åœ¨é¡µé¢å¤´éƒ¨çš„æœç´¢ç»“æœçš„ä¼˜åŠ£ã€‚</p>
<p>å› æ­¤ï¼ŒåˆæœŸé˜¶æ®µæˆ‘ä»¬é€‰æ‹©äº†æ›´é€‚åˆæœç´¢æ’åºçš„Listwiseæ–¹å¼å­¦ä¹ æ¨¡å‹ï¼Œå³LambdaMartæ ‘æ¨¡å‹ä½œä¸ºbaseæ¨¡å‹ï¼ŒåŒæ—¶æ ‘æ¨¡å‹ä¸éœ€è¦åšå¤§é‡çš„ç‰¹å¾å¤„ç†ï¼Œå¯ä»¥å¿«é€Ÿä¸Šçº¿éªŒè¯æ•ˆæœã€æ‹¿åˆ°æ”¶ç›Šã€‚</p>
<h4 data-id="heading-4">1. ç”±LambdaMartæ¨¡å‹å‡çº§åˆ°LambdaDNNæ¨¡å‹</h4>
<p>å°†æ’åºæ¨¡å‹ä»LambdaMartå‡çº§åˆ°LambdaDNNæ¨¡å‹ä¸»è¦è€ƒè™‘åˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>æ—…æ¸¸å…·æœ‰å¼ºçƒˆçš„èŠ‚å‡æ—¥å‘¨æœŸå±æ€§ï¼Œéœ€è¦é•¿æ—¶é—´çª—çš„å¤§è§„æ¨¡æ•°æ®å­¦ä¹ ã€‚è€Œæ ‘æ¨¡å‹å®¹é‡æœ‰é™ï¼Œéšç€æ•°æ®è§„æ¨¡çš„å¢åŠ ï¼Œå¾ˆéš¾å¾ˆå¥½çš„è¡¨è¾¾æ•°æ®å†…éƒ¨éšè—çš„çŸ¥è¯†ã€‚LambdaDNNèƒ½å¤Ÿå®ç°æ›´å¤æ‚çš„æ¨¡å‹ï¼Œä¸”å…·å¤‡å¼ºå¤§çš„è¡¨å¾èƒ½åŠ›ï¼Œæœ‰æ›´é«˜çš„å¤©èŠ±æ¿ã€‚</li>
<li>åŸºäºæ·±åº¦å­¦ä¹ çš„æ¨¡å‹ï¼Œå…·æœ‰æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œå’Œå¤„ç†é«˜ç»´ç¨€ç–æ•°æ®çš„èƒ½åŠ›ï¼Œæ­¤å¤–åº”ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹åå¯ä»¥æ›´å¥½çš„åº”ç”¨æ–°çš„ç ”ç©¶æˆæœï¼Œæ¯”å¦‚åé¢ä»‹ç»çš„å¤šç›®æ ‡æ’åºã€‚</li>
</ul>
<p>æ ‘æ¨¡å‹å’Œæ·±åº¦æ¨¡å‹çš„ä¸»è¦åŒºåˆ«è§è¡¨1ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f18a285af81a420e9e4fdad5d7eb6108~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=dF%2BxcPEzjX0Llhta%2BvXvoaI8l9c%3D" alt="a44cfa7ec9874f8d0a95ed9b79884305.png" loading="lazy"/></p>
<h4 data-id="heading-5">2. LambdaDNNæ¨¡å‹å®è·µ</h4>
<p>ä¸ºäº†éªŒè¯æ·±åº¦æ¨¡å‹çš„æœ‰æ•ˆæ€§ï¼Œæˆ‘ä»¬æ§åˆ¶äº†lossçš„å­¦ä¹ æ–¹å¼ï¼Œç»Ÿä¸€ä¸ºlistwiseæ–¹å¼ï¼Œå”¯ä¸€å˜é‡åªæ˜¯æ¨¡å‹çš„ç»“æ„ã€‚è€ŒLambdaDNNæ¨¡å‹æ˜¯å°†ç¥ç»ç½‘ç»œDNNä¸LamdaRank [2] å®šä¹‰çš„NDCGæ’åºæŒ‡æ ‡æ¢¯åº¦ç›¸ç»“åˆï¼Œæ¼”è¿›å‡ºäº†LambdaDNNï¼Œæ˜¯ä¸€ç§listwiseçš„å­¦ä¹ æ–¹å¼ã€‚å› æ­¤æˆ‘ä»¬å°è¯•å°†LambdaDNNæ¨¡å‹åº”ç”¨åœ¨äº†Qunaræœç´¢æ¨èä¸‹çš„ç²¾æ’é˜¶æ®µï¼Œ</p>
<p>æ¨¡å‹å­¦ä¹ ç›®æ ‡å®šä¹‰ä¸ºæ›å…‰è½¬åŒ–ç‡ï¼ˆctcvrï¼‰ã€‚LambdaDNNçš„æ­å»ºä¸»è¦åŒ…æ‹¬äº†æ¡†æ¶é€‰å‹ã€æ ·æœ¬æ„é€ ã€ç‰¹å¾å·¥ç¨‹ã€æ¨¡å‹ç¦»çº¿è®­ç»ƒåŠçº¿ä¸ŠåŒ–ï¼Œå…¶ä¸­æ ·æœ¬ä¸ç‰¹å¾å†³å®šäº†æ¨¡å‹æ•ˆæœçš„ä¸Šé™ã€‚æ¥ä¸‹æ¥åˆ†åˆ«ä»‹ç»ä¸‹è¿™å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<h5 data-id="heading-6">2.1 æ¡†æ¶é€‰å‹</h5>
<p>TensorFlow Ranking (TFR) æ˜¯ TensorFlow å®˜æ–¹å¼€å‘çš„ LTR æ¡†æ¶ï¼Œæ—¨åœ¨åŸºäº TensorFlow å¼€å‘å’Œæ•´åˆ LTR ç›¸å…³çš„æŠ€æœ¯ï¼Œä½¿å¼€å‘äººå‘˜å¯ä»¥æ›´åŠ æ–¹ä¾¿çš„è¿›è¡Œ LTR ç®—æ³•çš„å¼€å‘ã€‚TFR ä½¿ç”¨äº† Estimator APIï¼Œæä¾›äº†æ’åºä»»åŠ¡å¸¸è§çš„æŸå¤±å‡½æ•°å’ŒæŒ‡æ ‡è®¡ç®—å®ç°ï¼Œæ¯”å¦‚ listwise Loss å’Œ NDCGæŒ‡æ ‡ã€‚</p>
<p>æ ¹æ®è®­ç»ƒæµç¨‹ï¼Œæ¨¡å—ç»“æ„å¯ä»¥åˆ†æˆç‰¹å¾è¾“å…¥ã€ç‰¹å¾è½¬æ¢ã€æ¨¡å‹æ‰“åˆ†å’ŒæŸå¤±è®¡ç®—ç­‰æ¨¡å—ã€‚è¿™æ ·çš„æ¨¡å—åˆ’åˆ†å¯ä»¥æé«˜åç»­å¿«é€Ÿè¿­ä»£çš„ä¾¿åˆ©æ€§å’Œçµæ´»æ€§ï¼Œè€Œä¸ç”¨å…³æ³¨äºå„ç§å®æ–½ä¸Šçš„ç»†èŠ‚ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46c9f88896d04b62955d7c15426048ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=c0Lk9FUAZD7fFIyfho785K1RB9A%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾3 TFRankingæ¡†æ¶</p>
<p>å¦‚ä¸Šå›¾3æ‰€ç¤ºï¼Œmodel_fn å‚æ•°å†…éœ€è¦è‡ªå·±è®¾è®¡å’Œå¼€å‘çš„ç®—æ³•æ¨¡å‹æ¨¡å—ã€‚åœ¨è¿™ä¸ª model_fn ä¸­ï¼Œéœ€è¦è‡ªè¡Œè®¾è®¡æ¨¡å‹ç»“æ„ (Scoring Function)ï¼Œç„¶åç”¨æ¨¡å‹è®¡ç®—çš„ logit å’Œ label æ¥è®¡ç®— Loss å’Œ Metricsï¼Œæœ€ååˆ©ç”¨ Optimizer æ¥è¿›è¡Œæ¨¡å‹çš„ä¼˜åŒ–ã€‚å›¾3ä¸­çš„ä¸‹æ–¹éƒ¨åˆ†ä¸ºä½¿ç”¨ TFR æœåŠ¡çš„æ•´ä¸ªæµç¨‹ã€‚</p>
<p>ä¸ºäº†é…åˆ TFR æ¡†æ¶ä¸­çš„ LTR ç›¸å…³çš„ Loss å’Œ Metrics æ¥å®ç° LTR çš„è®­ç»ƒï¼Œè®­ç»ƒæ•°æ®éœ€è¦ä»¥ listwise çš„å½¢å¼ç»„ç»‡ã€‚å³LTR æ¨¡å‹ä¸ä¸€æ¬¡åªå¯¹ä¸€ä¸ªitemè¿›è¡Œåˆ†ç±»çš„æ ‡å‡†åˆ†ç±»æ¨¡å‹ä¸åŒï¼Œå®ƒä¼šå°†æ•´ä¸ªitemsåˆ—è¡¨æ¥æ”¶è¾“å…¥ï¼Œå¹¶å­¦ä¹ æ’åºï¼Œå……åˆ†æå‡æ•´ä¸ªliståˆ—è¡¨çš„æ•ˆç”¨ï¼Œå¦‚å›¾4æ‰€ç¤ºã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35f1b0bc8ad846c1b12835b31e1ff1db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=SJbAjGqzjFbEd33Pq%2BZCemzdVxs%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾4 listwiseçš„å­¦ä¹ æ–¹å¼</p>
<h5 data-id="heading-7">2.2 æ¨¡å‹ç»“æ„</h5>
<p>æˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å‹ç»“æ„ï¼Œå€Ÿé‰´äº†Airbnbçš„æ·±åº¦å­¦ä¹ [3]æ¨¡å‹æ¼”è¿›çš„ç»éªŒï¼Œæ¨¡å‹æ¢ç´¢çš„åŸåˆ™æ˜¯ä»ç®€å•åˆ°å¤æ‚ï¼Œé€æ­¥ç§¯ç´¯ç»éªŒï¼Œé’ˆå¯¹ç‰¹å¾æ•°é‡ä¸å¤šçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨éå¸¸æ·±çš„ç½‘ç»œï¼Œä¼šå¯¼è‡´è¿‡æ‹Ÿåˆã€‚å› æ­¤ï¼Œå¦‚å›¾5æ‰€ç¤ºï¼Œé‡‡ç”¨äº†ç®€å•2å±‚éšè—å±‚çš„é‡‘å­—å¡”ç½‘ç»œç»“æ„ã€‚</p>
<p>å¯¹ä¸€ä¸ªqueryä¸‹çš„æ ·æœ¬è®¡ç®—Lambda Lossï¼Œä¼˜åŒ–ç½‘ç»œå‚æ•°ã€‚å…¶ä¸­ï¼Œæ¨¡å‹è°ƒä¼˜å‚æ•°ï¼Œbatch sizeä¸º1024ï¼ŒåŠ å…¥dropoutå’ŒBatch Normalizationï¼ˆBNï¼‰ï¼Œæ¢¯åº¦ä¼˜åŒ–å™¨æ˜¯Adamï¼Œå­¦ä¹ ç‡ä¸º0.01ã€‚è¾“å…¥ç‰¹å¾ä»…ä¸º77ç»´ï¼Œéšè—å±‚ç¥ç»å…ƒæ•°ä¸º[128ï¼Œ86]ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3e9e9ca5a1b49008405301c2cd77764~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=sOg9Q15hSmzp2zBuldyRlgMZVs4%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾5 æ¨¡å‹ç»“æ„</p>
<h5 data-id="heading-8">2.3 æ ·æœ¬æ„é€ </h5>
<p>ä¸ºäº†è®­ç»ƒlistwiseæ¨¡å‹ï¼Œéœ€è¦æ„é€ æ ·æœ¬æ¥è¡¨ç¤ºç”¨æˆ·çš„æŸ¥è¯¢queryå’Œitemä¹‹é—´çš„å…³ç³»ã€‚å›¾6(å·¦å›¾)æ˜¾ç¤ºäº†ä¸€ä¸ªå…¸å‹çš„ç”¨æˆ·æœç´¢æ—…ç¨‹çš„ç®€åŒ–ç¤ºä¾‹ï¼Œå…¶ä¸­å®¢æˆ·åœ¨å¤šå¤©å†…è¿›è¡Œå¤šæ¬¡queryæœç´¢ï¼Œå¹¶ç‚¹å‡»å¤šä¸ªæœç´¢ç»“æœä»¥æŸ¥çœ‹å…¶è¯¦ç»†é¡µé¢ï¼Œæœ€ç»ˆåœ¨ç¬¬Mæ—¥query#3ä¸‹çš„ç»“æœåˆ—è¡¨ä¸­ç”¨æˆ·ç‚¹å‡»äº†é…’åº—ï¼ˆhotel-bï¼‰å’Œä¸‹å•äº†é…’åº—ï¼ˆhotel-dï¼‰ï¼Œæ•´ä¸ªä¼šè¯ä»¥ç”¨æˆ·ä¸‹å•é…’åº—æˆåŠŸç»“æŸã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e73372caac2496ea7a067f68e712fc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=zg%2BsK07AYu7CPp%2F3tCVxNDVcsys%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾6 ç”¨æˆ·æœç´¢è¡Œä¸ºç¤ºä¾‹</p>
<p>åœ¨æˆ‘ä»¬çš„ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œçº¿ä¸Šä¸šåŠ¡ä¼˜åŒ–ç›®æ ‡ä¸ºä¸‹å•è½¬åŒ–ç‡ï¼Œå¯¹åº”ç¦»çº¿å»ºæ¨¡ç›®æ ‡ä¸ºæ›å…‰è½¬åŒ–ç‡ï¼ˆctcvrï¼‰ï¼Œå³ä»searchåˆ°orderçš„è½¬åŒ–ï¼Œè®­ç»ƒçš„ç›®æ ‡æ˜¯ä»æ›å…‰åˆ°ä¸‹å•çš„è½¬åŒ–ã€‚</p>
<ul>
<li>liståˆ—è¡¨é€‰æ‹©ï¼š
<ul>
<li>åœ¨ä»¥Listwiseæ–¹å¼å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬åªä½¿ç”¨å«æœ‰æˆåŠŸä¸‹å•çš„æœç´¢åˆ—è¡¨ï¼ˆDay Mçš„query#3ï¼‰ä¸ºListè®­ç»ƒæ ·æœ¬ï¼ŒDay1å’ŒDay2ä¸‹çš„æ— ä¸‹å•åˆ—è¡¨æ ·æœ¬å°†ä¸¢å¼ƒï¼Œæ ‡ç­¾è§å›¾6ï¼ˆå³å›¾ï¼‰ï¼›</li>
<li>åŸå› æ˜¯è‹¥å°†åªæœ‰ç‚¹å‡»æ ‡ç­¾çš„liståŠ å…¥è®­ç»ƒï¼Œåœ¨è®¡ç®—NDCGæ—¶ï¼Œä¸ç®¡ç‚¹å‡»æ ‡ç­¾çš„å€¼æ˜¯0.01è¿˜æ˜¯1ï¼Œndcgçš„å€¼éƒ½æ˜¯ä¸€æ ·ï¼Œæ­¤æ—¶è®¡ç®—LambdaLossæ—¶ï¼Œæ¨¡å‹ä¼šæ›´å€¾å‘äºåªæœ‰ç‚¹å‡»çš„listï¼Œé‡ç‚¹ä¼˜åŒ–äº†ctrã€‚</li>
</ul>
</li>
<li>æ­£æ ·æœ¬æ„é€ ï¼š
<ul>
<li>ä¸‹å•é…’åº—æ ‡ç­¾1ï¼›</li>
<li>ç‚¹å‡»é…’åº—æ ‡ç­¾0.01ï¼Œæ ‡ç­¾å€¼è¡¨ç¤ºæ ·æœ¬å’Œqueryçš„ç›¸å…³åº¦å¤§å°ï¼Œå¯æ ¹æ®å®éªŒæ•ˆæœè°ƒæ•´ï¼ˆç‚¹å‡»å’Œä¸‹å•ç›¸å…³åº¦æ¯”å€¼æˆ‘ä»¬æ˜¯æ•°æ®ç»Ÿè®¡å¾—æ¥ï¼‰ã€‚æˆ‘ä»¬è®¤ä¸ºç”¨æˆ·ç‚¹å‡»è¿‡çš„é…’åº—æ˜¯å…·æœ‰ä¸€å®šçš„å–œå¥½ï¼Œä¸èƒ½ç®€å•çš„è®¾ç½®æ ‡ç­¾ä¸º0ã€‚</li>
</ul>
</li>
<li>è´Ÿæ ·æœ¬æ„é€ ï¼š
<ul>
<li>hard negative sampleï¼šæ›å…‰æœªä¸‹å•ä¸”æœªç‚¹å‡»çš„é…’åº—ï¼›</li>
<li>easy negative sampleï¼šåœ¨åŒä¸€ä¸ªliståˆ—è¡¨ä¸­ï¼Œé‡‡æ ·liståˆ—è¡¨æœ€åº•éƒ¨çš„nå®¶(&lt;&lt;å½“æ¬¡è¯·æ±‚æ›å…‰é…’åº—æ•°)æœªæ›å…‰çš„é…’åº—ï¼Œæ ‡ç­¾ä¸º0ã€‚ç”±äºçº¿ä¸Šç²¾æ’æ’åºå®¶æ•°è¾ƒå¤šï¼Œåªé€‰å–æ›å…‰æ ·æœ¬è®­ç»ƒï¼Œæ¨¡å‹å¯¹easyè´Ÿæ ·æœ¬å­¦ä¹ ä¸å¥½ã€‚æ¨èç»“æœä¼šæœ‰éƒ¨åˆ†ä½è´¨é‡é…’åº—ï¼Œéœ€è¦é‡‡æ ·éƒ¨åˆ†ä½è´¨é…’åº—ä½œä¸ºeasy negative sampleï¼Œä¿®æ­£çº¿ä¸Šçº¿ä¸‹æ ·æœ¬åˆ†å¸ƒåå·®ï¼Œæå‡æ¨¡å‹æ³›åŒ–èƒ½åŠ›ã€‚</li>
</ul>
</li>
<li>æ ·æœ¬é‡ï¼šæ¨¡å‹è®­ç»ƒçš„æ ·æœ¬ä»¥æ—¶é—´ç»´åº¦åˆ‡åˆ†ï¼Œ30å¤©ä¸ºè®­ç»ƒé›†ï¼Œ7å¤©ä½œä¸ºéªŒè¯é›†ï¼Œ7å¤©ä½œä¸ºæµ‹è¯•é›†ã€‚</li>
</ul>
<p>å·¥ç¨‹å®è·µï¼šListwiseå­¦ä¹ æ–¹å¼çš„Lambdaæ¢¯åº¦éœ€è¦å¯¹åŒQueryä¸‹çš„æ ·æœ¬è¿›è¡Œè®¡ç®—ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹æ ·æœ¬è¿›è¡Œé¢„å¤„ç†ï¼šå°†åŒä¸€ä¸ªæŸ¥è¯¢(Query)çš„æ ·æœ¬èšåˆåœ¨ä¸€èµ·ï¼Œé‡‡ç”¨ExampleListWithContextç¼–ç æ–¹å¼ï¼Œå°†è¿™äº›æ ·æœ¬æ‰“åŒ…è¿›ä¸€ä¸ªTFRecordä¸­ã€‚ç”±äºæ¯æ¬¡è¯·æ±‚Queryå¬å›çš„itemæ•°ä¸ä¸€æ ·ï¼Œå¯¹äºå¯å˜Sizeçš„Queryæ ·æœ¬åœ¨æ‹‰å–æ•°æ®è¿›è¡Œè®­ç»ƒæ—¶éœ€è¦æ³¨æ„ï¼ŒTFä¼šè‡ªåŠ¨è¡¥é½Mini-Batchå†…æ¯ä¸ªæ ·æœ¬å¤§å°ä¸€è‡´ã€‚</p>
<h5 data-id="heading-9">2.4ç‰¹å¾å·¥ç¨‹</h5>
<p>ç‰¹å¾å·¥ç¨‹ä¸»è¦åŒ…æ‹¬ç‰¹å¾æ„å»ºã€ç‰¹å¾åˆ†æã€ç‰¹å¾å¤„ç†ï¼Œä»¥åŠç‰¹å¾é€‰æ‹©ç­‰ï¼š</p>
<p><strong>ç‰¹å¾æ„å»ºï¼š</strong></p>
<ul>
<li>ç”¨æˆ·ç‰¹å¾ï¼šç”¨æˆ·è¡Œä¸ºç‰¹å¾ï¼Œå¦‚è¿‡å»1å¹´ä¸‹å•çš„æ¬¡æ•°ï¼Œä¸‹å•è¯¥é…’åº—çš„æ¬¡æ•°ï¼Œç”¨æˆ·ç”»åƒç­‰</li>
<li>é…’åº—ç‰¹å¾ï¼šå±æ€§ç‰¹å¾ç­‰ï¼Œå¦‚ä»·æ ¼ï¼Œæ¡£æ¬¡ï¼Œæ˜Ÿçº§ï¼Œç‚¹å‡»ç‡ï¼Œè½¬åŒ–ç‡ï¼ŒèŠ‚å‡æ—¥ç­‰</li>
<li>äº¤å‰ç‰¹å¾ï¼šç”¨æˆ·åˆ°é…’åº—çš„è·ç¦»ï¼Œpoiåˆ°é…’åº—çš„è·ç¦»ç­‰</li>
<li>ä¸Šä¸‹æ–‡ç‰¹å¾ï¼šæ—¶é—´ï¼Œæœç´¢åœºæ™¯ç­‰</li>
</ul>
<p><strong>æ„å»ºåŸåˆ™ï¼š</strong></p>
<ul>
<li>é˜²æ­¢ç‰¹å¾ç©¿è¶Š</li>
<li>å°½é‡å’Œä¸šåŠ¡ç›¸å…³</li>
<li>æœ‰åŒºåˆ†æ€§ï¼Œå°½é‡ä½¿ç‰¹å¾èƒ½å¾ˆå¥½çš„åŒºåˆ†å‡ºæ­£è´Ÿæ ·æœ¬ã€‚</li>
</ul>
<p><strong>ç‰¹å¾é€‰æ‹©ï¼š</strong></p>
<ul>
<li>æ·±åº¦æ¨¡å‹ç›¸å¯¹äºæ ‘æ¨¡å‹å¯¹ç‰¹å¾å€¼çš„å¤§å°æ›´æ•æ„Ÿï¼Œæ²¡æœ‰åƒæ ‘æ¨¡å‹ä¸€æ ·æœ‰è‡ªåŠ¨ç‰¹å¾é€‰æ‹©åŠŸèƒ½ï¼Œå¼•å…¥ä¸€äº›å†—ä½™ç‰¹å¾ä¼šå¢å¤§æ·±åº¦æ¨¡å‹çš„å™ªå£°ã€‚å› æ­¤æˆ‘ä»¬åŸºäºLambdaMartçš„ç‰¹å¾é‡è¦æ€§æ’åºï¼Œé€‰å–æœ€é‡è¦çš„ç‰¹å¾è®­ç»ƒLambdaDnnï¼Œå¦‚å›¾7æ‰€ç¤ºï¼Œtop49ç»´ï¼ˆæ€»ç»´åº¦æ˜¯200ç»´ï¼‰æ—¶ï¼Œæµ‹è¯•é›†åˆçš„ndcg@10æŒ‡æ ‡ï¼ˆtest_ndcgï¼‰å’Œå…¨é‡ç‰¹å¾ndcg@10ï¼ˆorigin_test_ndcgï¼‰ç›¸æ¯”æŒå¹³ï¼Œä¸”ç‰¹å¾åœ¨top25ç»´æ—¶æŒ‡æ ‡ä¸åœ¨å¢é•¿ã€‚è€ƒè™‘åˆ°æ·±åº¦æ¨¡å‹çš„å‚æ•°ç©ºé—´æ›´å¤§ï¼Œå­¦ä¹ èƒ½åŠ›æ›´å¼ºï¼Œæˆ‘ä»¬åœ¨top49ç»´ç‰¹å¾çš„åŸºç¡€ä¸Šï¼ŒåŸºäºäººå·¥ç»éªŒåˆæŒ‘é€‰äº†28ç»´ç‰¹å¾ï¼Œä¸€å…±77ç»´ã€‚</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5f97d6acfe2f4dcd870fee8b89fd7f39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=CFy1WTk%2BLM%2FjFSCYEuK2O%2FJsLRg%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾7 é€‰æ‹©ä¸åŒtopæ•°é‡çš„ç‰¹å¾è®­ç»ƒåçš„æ¨¡å‹æ•ˆæœ</p>
<p><strong>ç‰¹å¾åˆ†æï¼š</strong></p>
<p>æ·±åº¦æ¨¡å‹å¯¹ç‰¹å¾å¤§å°è¾ƒä¸ºæ•æ„Ÿï¼Œå› æ­¤ç‰¹å¾å¤„ç†çš„å¥½åç›´æ¥å½±å“åç»­æ¨¡å‹çš„è¡¨ç°ã€‚</p>
<ul>
<li>é•¿å°¾åˆ†å¸ƒï¼šä¾‹å¦‚ç‚¹å‡»ç‡ã€ç‚¹å‡»æ¬¡æ•°ç­‰ç‰¹å¾ï¼Œ80%çš„å€¼åˆ†å¸ƒåœ¨é è¿‘0çš„é™„è¿‘ï¼Œè‹¥ç›´æ¥åŠ å…¥æ¨¡å‹è®­ç»ƒï¼Œç”±äºå€¼å·®è·å¤ªå°ï¼Œå’Œå…¶ä»–ç‰¹å¾ç›¸æ¯”æ²¡æœ‰åŒºåˆ†æ€§ï¼Œå› æ­¤éœ€è¦åšä¸€äº›logå˜æ¢åä¸ºæ­£æ€åˆ†å¸ƒï¼Œæ›´æœ‰åˆ©äºæ¨¡å‹æ”¶æ•›ã€‚å¦‚ä¸‹è¡¨ï¼š</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/020bbec932a1457295073a1bb73a80a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=Nyfl8xGaxl4mXHDmjf%2BHMQDa6Xc%3D" alt="6ba3501906803be67bc43b369df8b67b.png" loading="lazy"/></p>
<ul>
<li>æ­£æ€åˆ†å¸ƒï¼šä»·æ ¼ç­‰å–å€¼è¾ƒå¤§è¿ç»­ç‰¹å¾ï¼Œä½¿ç”¨äº†æœ€å¤§æœ€å°å½’ä¸€åŒ–æ–¹æ³•ï¼Œå°†ç‰¹å¾å€¼éƒ½è½¬åŒ–ä¸º0-1ä¹‹é—´çš„æ•°å€¼ã€‚</li>
<li>ç¼ºå¤±å€¼å¡«è¡¥ï¼šåœ¨è®­ç»ƒæ ·æœ¬ä¸­ä¸å¯é¿å…åœ°æœ‰éƒ¨åˆ†è¿ç»­ç‰¹å¾å­˜åœ¨ç¼ºå¤±å€¼ï¼Œåˆç†å¤„ç†ç¼ºå¤±å€¼ä¼šå¯¹æœ€ç»ˆæ•ˆæœæœ‰ä¸€å®šå¸®åŠ©ã€‚å¡«è¡¥ç¼ºå¤±å€¼çš„æ–¹å¼æœ‰ï¼š
<ul>
<li>å–é›¶å€¼ï¼Œä¼šå¯¼è‡´ç›¸åº”æƒé‡æ— æ³•è¿›è¡Œæ›´æ–°ï¼Œæ”¶æ•›é€Ÿåº¦å‡æ…¢ã€‚</li>
<li>å–å¹³å‡å€¼ä¹Ÿç•¥æ˜¾æ­¦æ–­ï¼Œæ¯•ç«Ÿä¸åŒçš„ç‰¹å¾ç¼ºå¤±æ‰€è¡¨ç¤ºçš„å«ä¹‰å¯èƒ½ä¸å°½ç›¸åŒã€‚</li>
<li>æˆ‘ä»¬å¸Œæœ›ç¥ç»ç½‘ç»œä¹Ÿå¯ä»¥é€šè¿‡å­¦ä¹ çš„æ–¹å¼è‡ªé€‚åº”åœ°å¤„ç†ç¼ºå¤±å€¼ï¼Œè€Œä¸æ˜¯äººä¸ºè®¾ç½®é»˜è®¤å€¼ã€‚å¯¹è¾ƒä¸ºé‡è¦çš„ç‰¹å¾ï¼ˆç‰¹å¾é‡è¦åº¦å¯é€šè¿‡æ¨¡å‹çš„ä¿¡æ¯å¢ç›Šå¾—åˆ†å¾—åˆ°ï¼‰ï¼Œä¸”ç¼ºå¤±ç‡è¾ƒå¤§çš„ï¼Œå¡«è¡¥å€¼ä¸º0ï¼ŒåŒæ—¶å¯¹ç¼ºå¤±ç‰¹å¾å­¦ä¹ ä¸€ä¸ªç¼ºå¤±æƒé‡ï¼Œå¦‚ä¸‹å…¬å¼æ‰€ç¤ºï¼š</li>
</ul>
</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/242195055ceb4845980ea7fe670e1412~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=bGeg6MBXCJhvjZz%2BhkD8OG2YaVk%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬é€šè¿‡ä¸Šè¿°å˜æ¢æ–¹å¼ï¼Œè®©æ‰€æœ‰ç‰¹å¾èŒƒå›´åœ¨0-1ä¹‹é—´æˆ–è€…0é™„è¿‘ï¼Œåœ¨è¾“å…¥æ¨¡å‹åç»è¿‡ä¸€å±‚bnæ“ä½œè¿›è¡Œæ­£æ€åˆ†å¸ƒå¤„ç†ã€‚å½“ç„¶è¿˜æœ‰å…¶ä»–å¤„ç†æ–¹å¼ï¼Œå…·ä½“è¿˜è¦æ ¹æ®è‡ªå·±ä¸šåŠ¡é€‰æ‹©åˆé€‚çš„å¤„ç†æ–¹å¼ã€‚</p>
<h5 data-id="heading-10">2.5 å®éªŒè¯„ä¼°</h5>
<p>baselineæ¨¡å‹å³LambdaMartï¼Œç¦»çº¿ndcg@10æ•ˆæœå¦‚ä¸‹è¡¨ï¼ŒLambdaDnnçº¿ä¸Šè½¬åŒ–ç‡æå‡0.5%ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2df1297120f343a7a846f49b23cf1444~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=8WqxqrvSK4qIrQ6wXsWvSMZIuWo%3D" alt="61f15fcf5396064c9e98db66661b2597.png" loading="lazy"/></p>
<h4 data-id="heading-11">3. å¤šç›®æ ‡æ¨¡å‹ä¼˜åŒ–</h4>
<p>åœ¨ç±»ä¼¼ç”µå•†æœç´¢æ¨èç³»ç»Ÿä¸­ï¼Œç”¨æˆ·çš„è¡Œä¸ºé€šå¸¸æŒ‰ç…§ä¸€ç§åºåˆ—åŒ–çš„æ¨¡å¼è¿›è¡Œï¼Œå³é¦–å…ˆæ˜¯æ›å…‰ï¼Œç„¶åæ˜¯ç‚¹å‡»ï¼Œæœ€åæ˜¯è½¬åŒ–ã€‚å› æ­¤ï¼ŒCTCVRæ¨¡å‹çš„ä½œç”¨æ˜¯é¢„ä¼°åœ¨æ›å…‰å‘ç”Ÿåçš„è½¬åŒ–æ¦‚ç‡ã€‚</p>
<h5 data-id="heading-12">3.1 ä¸ºä»€ä¹ˆé€‰æ‹©å¤šç›®æ ‡å»ºæ¨¡ï¼Ÿ</h5>
<p><strong>å•ç›®æ ‡æ–¹å¼ç¼ºé™·ï¼š</strong></p>
<p>1ï¼‰æ ·æœ¬é€‰æ‹©åå·®é—®é¢˜</p>
<ul>
<li>è®­ç»ƒé˜¶æ®µï¼šListwiseæ¨¡å¼è®­ç»ƒæ ·æœ¬æ˜¯ç”¨æˆ·æœ€åä¸€æ¬¡åœ¨Day Mæ—¥query#3ä¸‹çš„ä¸‹å•åˆ—è¡¨ï¼Œä¸‹å•å‰çš„è¡Œä¸ºåˆ—è¡¨éƒ½è¢«ä¸¢å¼ƒã€‚</li>
<li>åœ¨çº¿æ¨æ–­ï¼šquery#1ã€query#2çš„åˆ—è¡¨éƒ½ä¼šç»è¿‡æ¨ç†ï¼Œæ­¤æ—¶æ ·æœ¬æ˜¯æœ‰é€‰æ‹©åå·®çš„ï¼Œç¦»çº¿è®­ç»ƒå’Œåœ¨çº¿æ¨ç†æ ·æœ¬åˆ†å¸ƒä¸ä¸€è‡´ï¼Œæ¨¡å‹å¾ˆéš¾å­¦ä¹ åˆ°çœŸå®æ ·æœ¬åˆ†å¸ƒä¿¡æ¯ï¼Œå¯¼è‡´æ¨¡å‹çš„æ³›åŒ–æ€§èƒ½é™ä½ï¼›</li>
<li>å¯¹æ— ä¸‹å•è¡Œä¸ºçš„ç”¨æˆ·å­¦ä¹ æ•ˆæœè¾ƒå·®</li>
</ul>
<p>2ï¼‰æ¨¡å‹åˆ†å¯è§£é‡Šæ€§å·®</p>
<ul>
<li>Listwiseæ¨¡å¼å­¦ä¹ çš„è¾“å‡ºæ˜¯ååºå…³ç³»ï¼Œå€¼èŒƒå›´è¾ƒå¤§ï¼Œä¸æ˜¯åœ¨[0-1]ä¹‹é—´ï¼Œä¸”æ¯ä¸€æ¬¡è¯·æ±‚çš„å€¼èŒƒå›´åŒºé—´ä¸åŒï¼Œå¯¹åç»­ä¸šåŠ¡é‡æ’ç­–ç•¥è°ƒæ•´éš¾åº¦è¾ƒå¤§ã€‚è‹¥å½’ä¸€åŒ–åˆ°[0-1]åï¼Œä¸åƒå®é™…cträ¸€æ ·å…·æœ‰ç‰©ç†å«ä¹‰ã€‚</li>
</ul>
<p>3ï¼‰æ•°æ®ç¨€ç–ï¼Œæ¨¡å‹æ³›åŒ–èƒ½åŠ›ä¸è¶³</p>
<ul>
<li>è‹¥pointwiseæ¨¡å¼åªä½¿ç”¨æ›å…‰å’Œä¸‹å•æ ·æœ¬è®­ç»ƒCTCVRç›®æ ‡æ—¶ï¼Œä¸‹å•æ•°æ®éå¸¸ç¨€ç–ï¼Œä¸‹å•æ ·æœ¬çš„æ•°é‡è¿œè¿œå°äºæ›å…‰æ ·æœ¬ã€‚è€Œåˆ©ç”¨CTRä»»åŠ¡çš„ä¸°å¯Œæ•°æ®å¯ä»¥å¸®åŠ©CTCVRä»»åŠ¡å…‹æœæ•°æ®ç¨€ç–æ€§é—®é¢˜ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œé¢„æµ‹æ€§èƒ½</li>
</ul>
<p><strong>å¤šç›®æ ‡ä¼˜åŠ¿ï¼š</strong></p>
<p>1ï¼‰ç¼“è§£æ ·æœ¬åå·®ï¼ŒåŠç¨€ç–æ€§</p>
<ul>
<li>å°†æ›å…‰ç‚¹å‡»ä¸‹å•éƒ½å¯ä»¥åŠ å…¥åˆ°æ¨¡å‹ä¸­å­¦ä¹ </li>
</ul>
<p>2ï¼‰å¯è§£é‡Šæ€§å¥½</p>
<ul>
<li>è¾“å‡ºå€¼æ˜¯æ¦‚ç‡æ„ä¹‰ï¼Œæ›´å¥½èåˆåé¢çš„é‡æ’åŠ æƒç­–ç•¥ï¼›</li>
</ul>
<p>3ï¼‰ä¿ƒè¿›ä½œç”¨</p>
<ul>
<li>é€šè¿‡å…±äº«ä¸€äº›æµ…å±‚æ¬¡çš„ç‰¹å¾ï¼Œå¤šä»»åŠ¡å­¦ä¹ å¯ä»¥å€ŸåŠ©å½¼æ­¤ä¹‹é—´çš„ç›¸ä¼¼æ€§å’Œå·®å¼‚æ€§æ¥ä¿ƒè¿›å­¦ä¹ è¿‡ç¨‹</li>
</ul>
<p>4ï¼‰çº¦æŸä½œç”¨</p>
<ul>
<li>å½“å¤šä¸ªä»»åŠ¡åŒæ—¶è¿›è¡Œåå‘ä¼ æ’­æ—¶ï¼Œç”±äºä¸åŒä»»åŠ¡å…·æœ‰ä¸åŒçš„å™ªå£°æ¨¡å¼ï¼Œå¤šç›®æ ‡å¯ä»¥å°†å¤šä¸ªä»»åŠ¡çš„åé¦ˆä¿¡æ¯ç»“åˆèµ·æ¥ï¼Œå¹³å‡å™ªå£°æ¨¡å¼ï¼Œä»è€Œå¾—åˆ°æ›´ä¸€èˆ¬å’Œç¨³å®šçš„è¡¨å¾ï¼Œæœ‰ç‚¹åƒæ­£åˆ™åŒ–çš„ä½œç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç›¸å¯¹äºå•ä¸ªä»»åŠ¡ï¼Œæ¨¡å‹çš„è¿‡æ‹Ÿåˆé£é™©ä¼šé™ä½ï¼Œæ³›åŒ–èƒ½åŠ›ä¼šæé«˜ã€‚</li>
</ul>
<h5 data-id="heading-13">3.2 å¤šç›®æ ‡å»ºæ¨¡é€‰å‹</h5>
<p>MMOEæ˜¯è°·æ­Œ18å¹´æå‡ºçš„æ¨¡å‹ç»“æ„ï¼Œå…¶æ€æƒ³æ˜¯æ‰€æœ‰ç›®æ ‡å…±äº«å¤šä¸ªexpertsï¼Œä½†æ˜¯è€ƒè™‘åˆ°ä¸åŒä»»åŠ¡ä¹‹é—´çš„å·®å¼‚æ€§ï¼Œä¸ºæ¯ä¸€ä¸ªç›®æ ‡è®¾ç½®ä¸€ä¸ªgateé—¨æ§ç½‘ç»œï¼Œç”¨æ¥æ§åˆ¶ä¸åŒç›®æ ‡é€‰æ‹©æ¯ä¸ªexpertçš„ä¿¡å·å æ¯”ï¼Œç±»ä¼¼äºweighted sum poolingæ“ä½œã€‚</p>
<p>MMOEï¼ˆå¦‚å›¾8æ‰€ç¤ºï¼‰é€šè¿‡å…±äº«expertså­¦ä¹ åˆ°ä¸åŒä»»åŠ¡çš„è”ç³»å’Œå·®å¼‚ï¼Œæé«˜äº†æ¯ä¸ªä»»åŠ¡çš„å­¦ä¹ æ•ˆç‡å’Œè´¨é‡ï¼ŒåŒæ—¶é€šè¿‡gatesæ¥å¹³è¡¡å¤šä¸ªä»»åŠ¡å¯¹expertsä¿¡å·çš„é€‰æ‹©ï¼Œä¸è¦æ±‚ç›®æ ‡ä¹‹é—´å¿…é¡»æ˜¯é«˜ç›¸å…³æ€§çš„ï¼ŒMMOEæ˜¯ä¸šç•Œé€šç”¨çš„å¤šç›®æ ‡å®ç°ç®—æ³•ã€‚</p>
<p>å¤šç›®æ ‡å»ºæ¨¡æ›´å¥½çš„è€ƒè™‘äº†æ’åºå…¨ç©ºé—´çš„æ›å…‰æ ·æœ¬ï¼Œç»¼åˆè€ƒè™‘äº†ä¸‹å•å‰çš„ç”¨æˆ·ç‚¹å‡»è¡Œä¸ºï¼Œé™ä½æ ·æœ¬åå·®é—®é¢˜ï¼Œå¼•å…¥äº†å¤šä¸ªä¸“å®¶ã€2ä¸ªç›®æ ‡ä»»åŠ¡ã€ä¸€ä¸ªCTRç›®æ ‡ä»»åŠ¡å’Œä¸€ä¸ªCTCVRç›®æ ‡ä»»åŠ¡ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13cd33a45b334a079829c586a29a9183~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=QqL9TVZAcK4beXbAo8D67gCuoNM%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾8 MMOEç½‘ç»œç»“æ„</p>
<h5 data-id="heading-14">3.3 MMOEæ ·æœ¬é€‰æ‹©</h5>
<p>1ï¼‰åªé€‰å–æœ‰è¡Œä¸ºçš„æœç´¢åˆ—è¡¨ï¼Œå³è¯¥åˆ—è¡¨æ˜¯æœ‰è¢«ç‚¹å‡»æˆ–è¢«ä¸‹å•çš„é…’åº—çš„åˆ—è¡¨ï¼›</p>
<ul>
<li>åŸå› ï¼šæ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ç›¸å·®è¾ƒå¤§ï¼Œè¿‡æ»¤ä¸€éƒ¨åˆ†è®¤ä¸ºæ— æ•ˆè´Ÿæ ·æœ¬ï¼›å…¶æ¬¡è®­ç»ƒæ—¶é¿å…æ²¡æœ‰æ­£è¡Œä¸ºç”¨æˆ·çš„å½±å“ï¼Œåœ¨ä¸€æ‰¹æ•°æ®ä¸­å¦‚æœæŸä¸ªç”¨æˆ·å¯¹æ‰€æœ‰å±•ç¤ºçš„ç‰©å“éƒ½æ²¡æœ‰ç‚¹å‡»ç­‰è¡Œä¸ºï¼Œåº”å½“è¿‡æ»¤æ‰è¯¥ç”¨æˆ·çš„è®°å½•ï¼ˆæ²¡æœ‰æ­£è¡Œä¸ºç”¨æˆ·åªæä¾›è´Ÿä¾‹ï¼Œçœ‹ä¸å‡ºç”¨æˆ·å–œå¥½ï¼Œå¯¹æ¨¡å‹è®­ç»ƒæ²¡æœ‰å¸®åŠ©ï¼‰ã€‚</li>
</ul>
<p>2ï¼‰é€‰å–æ¯ä¸ªåˆ—è¡¨çš„æ›å…‰æ ·æœ¬ï¼Œä»¥åŠæ¯ä¸ªåˆ—è¡¨çš„æœ€åº•éƒ¨æœªæ›å…‰çš„nå®¶é…’åº—ä½œä¸ºeasy negative sampleï¼Œé˜²æ­¢æ’åºå‡ºä¸€äº›è¾ƒå·®çš„é…’åº—ã€‚</p>
<p>3ï¼‰åŒä¸€ä¸ªè¯·æ±‚åˆ—è¡¨ä¸­çš„é…’åº—è¢«ç‚¹å‡»å¤šæ¬¡çš„ï¼Œåªè®°å½•ä¸€æ¬¡ç‚¹å‡»è¡Œä¸ºï¼Œå³ä¸€æ¬¡ç‚¹å‡»æ­£æ ·æœ¬ã€‚</p>
<h5 data-id="heading-15">3.4 MMOEè®­ç»ƒè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜</h5>
<p>1ï¼‰å®é™…çš„ä¸šåŠ¡æ•°æ®ä¸­ï¼Œæ›å…‰åˆ°è½¬åŒ–è¿‡äºç¨€ç–ï¼Œå…·ä½“è®­ç»ƒè¿‡ç¨‹ä¸­ctcvrçš„lossæ˜æ˜¾æ¯”ctrçš„losså°ã€‚ä¸ºäº†ä½¿å¾—2ä¸ªç›®æ ‡ä»»åŠ¡çš„lossçš„é‡çº§ä¸€è‡´ï¼Œå¹¶æ²¡æœ‰é‡‡ç”¨lossåŠ æƒå¤„ç†ï¼Œè€Œæ˜¯åœ¨æ ·æœ¬æ„é€ è¿‡ç¨‹ä¸­å¯¹ä¸‹å•æ ·æœ¬è¿›è¡Œä¸Šé‡‡æ ·å¤åˆ¶ï¼Œä¿æŒæ­£è´Ÿæ ·æœ¬1:1ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ä½¿å¾—ç›®æ ‡losså¤§å°é‡çº§ä¸€æ ·ã€‚</p>
<p>è¿™æ ·åœ¨è®­ç»ƒshuffleæ—¶ï¼Œä¸ä¼šä½¿å¾—ä¸€ä¸ªæ­£æ ·æœ¬åœ¨batchå†…é‡å¤å‡ºç°Næ¬¡ï¼Œä½¿å¾—ctcvrä»»åŠ¡æ³›åŒ–æ€§æ›´å¥½ï¼ŒåŒæ—¶å¯¹cträ»»åŠ¡ä¸­çš„ä¸Šé‡‡æ ·è¿‡çš„ç‚¹å‡»æ ·æœ¬è¿›è¡Œé™æƒå¤„ç†ï¼Œæ¢å¤åŸå…ˆæ ·æœ¬åˆ†å¸ƒã€‚</p>
<p>2ï¼‰gate networkè¾“å‡ºè¿›å…¥é¥±å’ŒåŒºï¼Œåå‘ä¼ æ’­æ¢¯åº¦æ¶ˆå¤±ï¼š</p>
<p>expert gateè¾“å‡ºï¼Œæ˜¯ç”±è¾“å…¥ç‰¹å¾ç»è¿‡é—¨ç½‘ç»œåsoftmaxå¾—åˆ°ï¼Œåœ¨è®­ç»ƒçš„è¿‡ç¨‹ä¸­ï¼Œç»è¿‡ä¸€æ®µè¿­ä»£æ¬¡æ•°ï¼Œé—¨æ§ç½‘ç»œçš„è¾“å…¥å€¼æ–¹å·®å˜å¤§ï¼Œç»è¿‡softmaxågate networkå¤§éƒ¨åˆ†è¾“å‡ºæ˜¯0ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œmulti expertçš„ä¼˜åŠ¿å°±æ²¡åŠæ³•å‘æŒ¥å‡ºæ¥ï¼Œ</p>
<p>ä¸€ç§è§£å†³æ–¹å¼æ˜¯dropoutï¼Œä¾ç„¶è§£å†³ä¸äº†éƒ¨åˆ†å€¼åå¤§çš„é—®é¢˜ï¼›å¦ä¸€ç§æ–¹å¼å¯¹è¿›å…¥softmaxä¹‹å‰çš„å¾—åˆ†ï¼Œè¿›è¡Œå¾—åˆ†é™¤ä»¥ä¸€ä¸ªlambdaå¹³æ»‘å¤„ç†ï¼ˆå³ï¼Œæ¸©åº¦ç³»æ•°çš„è°ƒèŠ‚ï¼‰ï¼Œç¼“è§£éƒ¨åˆ†ä¸“å®¶é€€åŒ–ç°è±¡ï¼›è¿™é‡Œå–lambdaä¸ºè¾“å…¥ç‰¹å¾çš„ç»´åº¦ï¼Œä¹Ÿå¯ä»¥å‚è€ƒself-attentionã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b0118f6a54044ce39a428fb4bfa5eb78~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=EgkKNgifd7oyugJLm%2BfverfEzJI%3D" alt="å¾®ä¿¡å›¾ç‰‡_2026-01-14_153851_295.png" loading="lazy"/></p>
<p>å¦‚ä¸‹è¡¨æŒ‡æ•°eå‡½æ•°æ›²çº¿ä¸­æ‰€ç¤ºï¼Œxçš„åŸŸèŒƒå›´åœ¨[-10,10]åŒºé—´æ—¶ï¼Œsoftmaxçš„å€¼å¾ˆå®¹æ˜“åœ¨xå°äº-2.5æ—¶ä¸º0ï¼Œxå¤§äº10æ—¶ä¸º1ã€‚å¦‚æœå°†xç¼©æ”¾å°ºåº¦ä¸º1/100ï¼Œå°±ä¼šç¼“è§£é€€åŒ–é—®é¢˜ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/30798f72e0334d6dbe3b5bd9678c0c4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=aL2ZZJA2fid2p7Mygh3OlD8XXws%3D" alt="3b9aedd9a2ea098fd6d5f8fb47021e6d.png" loading="lazy"/></p>
<h5 data-id="heading-16">3.5 å®éªŒç»“æœ</h5>
<p>çº¿ä¸Šé¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬ä¼šåŠ æƒèåˆä¸¤ä¸ªç›®æ ‡é¢„æµ‹å€¼ä½œä¸ºæ’åºåˆ†ï¼Œè€Œèåˆæƒé‡å¯ä»¥é€šè¿‡ç¦»çº¿æ•°æ®æ‹Ÿåˆå¾—åˆ°ã€‚</p>
<p>ä»ä¸‹è¡¨ä¸­ï¼Œæˆ‘ä»¬çš„MMOEæœ€ç»ˆçš„ç¦»çº¿æŒ‡æ ‡NDCG@10æ²¡æœ‰æå‡ï¼Œä¸»è¦çš„åŸå› æ˜¯æµ‹è¯•é›†æ˜¯åªèƒ½åœ¨æœ‰ä¸‹å•çš„è¯·æ±‚ä¸Šé¢„æµ‹ï¼Œè€Œlambdaç›´æ¥å­¦ä¹ çš„ndcgç›®æ ‡ï¼Œæ‰€ä»¥ndcgæ›´é«˜ã€‚è€Œå¤šç›®æ ‡çº¿ä¸Šçš„ctræœ‰æ˜æ˜¾æå‡ï¼Œçº¿ä¸Šç‚¹å‡»ç‡æå‡2%ï¼Œè½¬åŒ–ç‡æŒå¹³ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1176845db93740caa18c492ce2534015~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=277IzinRpbECKQIFvO2oFx%2FfMCk%3D" alt="e69c4c99b5bbf117b81801da690150a3.png" loading="lazy"/></p>
<h4 data-id="heading-17">4. å¤šåœºæ™¯å¤šç›®æ ‡ä¼˜åŒ–</h4>
<h5 data-id="heading-18">4.1 ä¸šåŠ¡èƒŒæ™¯</h5>
<p>åœ¨ç”¨æˆ·å‡ºè¡Œæƒ³è¦é¢„å®šé…’åº—æ—¶ï¼Œæœç´¢é…’åº—åˆ—è¡¨æ˜¯ä¸€ä¸ªå¸¸è§çš„è¡Œä¸ºã€‚æ ¹æ®ç”¨æˆ·æ‰€å¤„ç©ºé—´ä¸åŒã€æœç´¢è¡Œä¸ºä¸åŒï¼Œåˆ†ä¸ºï¼šå¼‚åœ°ç©ºæœï¼ŒåŒåŸç©ºæœç­‰åœºæ™¯ï¼Œå¹¶ä¸”ä¸€ä¸ªç”¨æˆ·ä¼šè·¨ä¸åŒåœºæ™¯è¿›è¡Œæœç´¢ã€‚è€Œä¹‹å‰æ¨¡å‹å»ºæ¨¡ï¼Œæ¯ä¸ªåœºæ™¯å•ç‹¬è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œä¸€æ˜¯æ ‘æ¨¡å‹å®¹é‡å°ç­‰å†å²åŸå› å»¶ç»­å•ç‹¬å»ºæ¨¡ï¼ŒäºŒæ˜¯æ¯ä¸ªåœºæ™¯ä¸‹æ‰€ä½¿ç”¨çš„ç‰¹å¾ä¸ä¸€æ ·ï¼Œç‰¹å¾çš„ç´¢å¼•ä¹Ÿæ²¡æœ‰å¯¹é½ã€‚</p>
<p>å•ç‹¬å»ºæ¨¡ä¸ä¼šå—åˆ°å…¶ä»–åœºæ™¯ä¸‹çš„ç‰¹å¾å½±å“ï¼Œå…¶æ¬¡ä¹Ÿå¯å­¦åˆ°å•ä¸ªåœºæ™¯ç‹¬æœ‰çš„ä¸€äº›ç‰¹ç‚¹ã€‚ä½†æ˜¯å¸¦æ¥çš„é—®é¢˜æ˜¯ä¸åŒåœºæ™¯ä¸‹çš„å…±æœ‰ä¿¡æ¯æ— æ³•ç›¸äº’å…±äº«ã€æ— æ³•è¿ç§»å­¦ä¹ ï¼Œé€ æˆäº†ä¿¡æ¯å­¤å²›ã€‚å› ä¸ºåŒä¸€ä¸ªç”¨æˆ·ä¼šåœ¨ä¸åŒåœºæ™¯ä¸‹éƒ½æœ‰æœç´¢è¡Œä¸ºï¼Œå°†åŒä¸€ä¸ªç”¨æˆ·è¡Œä¸ºæ ·æœ¬åˆ†å¼€å»ºæ¨¡æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ï¼ŒåŒæ—¶å¯¹å¤šä¸ªæ¨¡å‹çš„ç»´æŠ¤æˆæœ¬ä¹Ÿå¾ˆé«˜ã€‚</p>
<p>å› æ­¤ï¼Œå‡çº§åˆ°äº†MMOEæ¨¡å‹åï¼Œæˆ‘ä»¬è€ƒè™‘å°†å‡ ä¸ªåœºæ™¯ä¸‹çš„æ ·æœ¬èåˆå­¦ä¹ ä¸€ä¸ªæ¨¡å‹ï¼Œå®—æ—¨æ˜¯æ—¢å¯ä»¥å­¦ä¹ åˆ°åœºæ™¯é—´ç‹¬æœ‰ä¿¡æ¯ï¼Œä¹Ÿèƒ½è¿ç§»å­¦ä¹ ä¸åŒåœºæ™¯ä¸‹çš„å…±æœ‰ä¿¡æ¯ã€‚</p>
<h5 data-id="heading-19">4.2 å¤šåœºæ™¯æ ·æœ¬å¦‚ä½•è¿›è¡Œèåˆï¼Ÿ</h5>
<p>ä¸åŒåœºæ™¯ä¸‹ç”¨æˆ·å’Œitemå­˜åœ¨é‡å ï¼Œå…·æœ‰ä¸€å®šå…±æ€§ï¼Œä¸åŒåœºæ™¯ä¸‹çš„ç”¨æˆ·è¡Œä¸ºï¼Œå…·æœ‰ä¸€å®šå·®å¼‚æ€§ï¼›ä¸åŒä»»åŠ¡ä¹‹é—´å…·æœ‰ä¸åŒçš„ç¨€ç–æ€§ï¼ŒåŒæ—¶ä¹Ÿå­˜åœ¨ç›¸äº’å½±å“ï¼›å¦‚æœåœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­å¿½ç•¥äº†å¤šåœºæ™¯å’Œå¤šä»»åŠ¡ä¹‹é—´çš„å…±æ€§å’Œå·®å¼‚æ€§ï¼Œä¼šå½±å“å»ºæ¨¡æ•ˆæœï¼Œå¦‚æœå¤šä¸ªåœºæ™¯å’Œä»»åŠ¡ä¸èƒ½å¾ˆå¥½åœ°è¿›è¡Œå¹³è¡¡ï¼Œä¼šå­˜åœ¨åœºæ™¯è··è··æ¿å’Œ ä»»åŠ¡è··è··æ¿ç°è±¡ã€‚</p>
<p>ä¸€å¼€å§‹æˆ‘ä»¬ä¹Ÿæ˜¯è°ƒç ”äº†ç›®å‰ä¸åŒåœºæ™¯ä¸‹å»ºæ¨¡çš„æ–¹å¼ï¼Œå¦‚é˜¿é‡ŒSTARã€HMOEç­‰å¤šåœºæ™¯å»ºæ¨¡æ–¹å¼ï¼Œä½†æ˜¯æ•ˆæœä¸ä½³ã€‚åŸå› æ˜¯STARã€HMOEæ¨¡å‹éƒ½æ˜¯å¯¹ä¸åŒåœºæ™¯ä¸‹çš„åˆ†å¸ƒå·®å¼‚è¾ƒå¤§çš„æ ·æœ¬è¿›è¡Œå»ºæ¨¡ï¼Œä¼šæœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœã€‚ä¾‹å¦‚ã€æ·˜å®çš„å•†å“çš„ä¸»æœåˆ—è¡¨æ¨èã€å’Œä¸»é¡µçš„çŒœä½ å–œæ¬¢ç­‰ä¸åŒçš„å¤šä¸ªé¢‘é“çš„å»ºæ¨¡ï¼Œè€Œåœ¨å»å“ªå„¿çš„é…’åº—åœºæ™¯ï¼Œå…¶å®è¿˜éƒ½æ˜¯ä¸€ä¸ªé¢‘é“ï¼Œç”¨æˆ·çš„è¡Œä¸ºåˆ†å¸ƒéƒ½æ˜¯ä¸€è‡´çš„ï¼Œåœ¨ç›®çš„åœ°ç¡®å®šçš„å‰æä¸‹ï¼Œæ— è®ºæ˜¯poiæœç´¢ã€åŒåŸæœç´¢ï¼Œéƒ½æ˜¯æƒ³é¢„å®šç›®çš„åœ°ä¸‹çš„ç¬¦åˆéœ€æ±‚çš„é…’åº—ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å°è¯•äº†ç›´æ¥å°†å¤šä¸ªåœºæ™¯çš„æ ·æœ¬æ”¾åœ¨ä¸€èµ·å­¦ä¹ ï¼ŒåŒæ—¶ç‰¹å¾ä¸€èµ·è¾“å…¥åˆ°MMOEä¸­ï¼Œç®€å•çš„hard-shareæ•ˆæœæ¯”STARã€HMOEæ•ˆæœä¼šå¥½ã€‚æˆ‘ä»¬å°†è®­ç»ƒå®Œçš„æ¨¡å‹ï¼Œè¾“å‡ºæ¯ä¸ªåœºæ™¯çš„ä¸“å®¶æƒé‡ï¼Œæ¥åˆ†æä¸åŒåœºæ™¯ä¸‹çš„æƒé‡æ˜¯å¦åˆ†å¸ƒä¸€æ ·ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/620531d072224d5fb4bc9ea125aeb245~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=AzAfm2Qg2IYUrVHG95Qh3jUcXig%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾9 ä¸åŒåœºæ™¯ä¸‹æ ·æœ¬åœ¨ä¸“å®¶ä¸‹çš„æƒé‡å æ¯”</p>
ä»å›¾9æ¥çœ‹ï¼Œä¸åŒåœºæ™¯ä¸‹çš„ä¸“å®¶æƒé‡ï¼Œåˆ†å¸ƒå‡ ä¹ä¸€è‡´ï¼Œæœ€é«˜çš„æƒé‡æ˜¯ä¸“å®¶2ã€‚ä¾§é¢éªŒè¯äº†ï¼Œåœ¨æˆ‘ä»¬çš„ä¸šåŠ¡ä¸‹åœºæ™¯é—´çš„åˆ†å¸ƒå·®å¼‚æ²¡æœ‰å¾ˆå¤§ã€‚çº¿ä¸Šçš„ä¸‹å•è½¬åŒ–ç›¸å¯¹æå‡0.56%ã€‚
<h5 data-id="heading-20">4.3 å¤šåœºæ™¯ä¸‹ç‰¹å¾å¦‚ä½•å¯¹é½ï¼Ÿ</h5>
<p>å¯¹äºé…’åº—ä¸šåŠ¡ä¸‹çš„ç‰¹å¾ï¼Œç‰¹å¾ä¸»è¦åˆ†ä¸º4ç±»ï¼š</p>
<ul>
<li>åœºæ™¯æ— å…³ç‰¹å¾ï¼šå¦‚é…’åº—ä»·æ ¼ã€ç”¨æˆ·ç‚¹å‡»æ¬¡æ•°ã€ä¸‹å•æ¬¡æ•°ç­‰</li>
<li>åœºæ™¯å…±æœ‰ç‰¹å¾ï¼šå¦‚é…’åº—åœ¨poiä¸‹çš„è½¬åŒ–ç‡ã€ç‚¹å‡»ç‡ç­‰ï¼Œæ­¤æ—¶ç‰¹å¾ä¼šå…±ç”¨ä¸€ä¸ªç‰¹å¾ç´¢å¼•</li>
<li>åœºæ™¯ç‹¬æœ‰ç‰¹å¾ï¼šå¦‚åŒåŸç©ºæœä¸‹ç”¨æˆ·è·ç¦»é…’åº—çš„è·ç¦»ï¼Œpoiåœºæ™¯ä¸‹poiè·ç¦»é…’åº—çš„è·ç¦»ç­‰ï¼Œæ­¤æ—¶ï¼Œç‰¹å¾ç´¢å¼•ä¸å…±ç”¨</li>
<li>åœºæ™¯æ ‡è¯†ç‰¹å¾ï¼šä¸»è¦å°±æ˜¯åœºæ™¯ ID ç±»ç‰¹å¾</li>
</ul>
<p>å¦‚ä¸Šæ‰€è¿°ï¼Œè¾“å…¥éƒ¨åˆ†ï¼Œå°†åœºæ™¯çš„domainä¿¡æ¯ä½œä¸ºç‰¹å¾å’Œåœºæ™¯å…±æœ‰ç‰¹å¾ä¸€èµ·æ‹¼æ¥è¾“å…¥åˆ°æ„ŸçŸ¥ç½‘ç»œä¸­ï¼ŒæŠ½å–åœºæ™¯é—´å…±æ€§ä¿¡æ¯ï¼›å°†åœºæ™¯çš„domainä¿¡æ¯ä½œä¸ºç‰¹å¾å’Œåœºæ™¯ç‰¹æœ‰ç‰¹å¾ä¸€èµ·æ‹¼æ¥è¾“å…¥åˆ°æ„ŸçŸ¥ç½‘ç»œä¸­ï¼ŒæŠ½å–åœºæ™¯é—´å·®å¼‚ä¿¡æ¯ï¼›</p>
<p>å¦‚æœç»Ÿä¸€ä½œä¸ºMMOEçš„è¾“å…¥ç›´æ¥è¾“å…¥ï¼Œæ¨¡å‹æ— æ³•å¾ˆå¥½çš„å­¦ä¹ åˆ°ä¸åŒåœºæ™¯çš„å·®å¼‚ï¼Œè‹¥äººä¸ºå…ˆéªŒçš„åˆ†ä¸ºä¸Šè¿°å‡ ç±»ç‰¹å¾ï¼Œæ‹‰å¹³åœºæ™¯ç‰¹å¾ä¹‹é—´çš„å·®å¼‚ã€‚å¯ä»¥ä½¿å¾—æ¨¡å‹åœ¨ä¸€ä¸ªç¨³å®šçš„æ ·æœ¬åˆ†å¸ƒä¸‹å­¦ä¹ ï¼Œå¢å¼ºæ¨¡å‹å¯¹ç”¨æˆ·è·¨åŸŸè¡Œä¸ºçš„åº•å±‚æ„ŸçŸ¥èƒ½åŠ›ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d28ab86b110f4bce87e3ed19d8c457a9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=fA7N5%2B6eD21BrF4FennTBtmF0b8%3D" alt="å¾®ä¿¡å›¾ç‰‡_2026-01-14_154104_798.png" loading="lazy"/></p>
<p align="center">å›¾10 å¤šåœºæ™¯å¤šç›®æ ‡ç½‘ç»œç»“æ„</p>
<h5 data-id="heading-21">4.4 å®éªŒè¯„ä¼°</h5>
<ul>
<li>åœ¨v2é˜¶æ®µå¤šåœºæ™¯æ ·æœ¬åˆå¹¶æ—¶ï¼Œndcg@10æŒ‡æ ‡æå‡ä¸å¤§ï¼Œå¤šä¸ªåœºæ™¯ä¸‹çš„æ ·æœ¬èåˆåï¼Œç½‘ç»œçš„å‚æ•°é‡ä¸èƒ½å¾ˆå¥½çš„è¡¨è¾¾å‡ºåœºæ™¯é—´çš„ç‰¹æ€§ã€‚</li>
<li>å› æ­¤ï¼Œå°†ç½‘ç»œä¸“å®¶æ•°æ‰©å¤§åˆ°8ä¸ªï¼Œå¸Œæœ›æ¯ä¸ªä¸“å®¶èƒ½å……åˆ†å­¦ä¹ åˆ°åœºæ™¯é—´å·®å¼‚ï¼Œç¦»çº¿æŒ‡æ ‡ndcg@10ç›¸å¯¹v1æå‡0.19%ï¼Œä¸Šçº¿åï¼Œs2oæŒ‡æ ‡æå‡0.46%ï¼Œå¦å¤–ï¼Œæˆ‘ä»¬åšäº†å…¶ä»–çš„ä¸“å®¶æ•°é‡çš„å®éªŒï¼Œå‘ç°å¢åŠ 9ä¸ªä»¥åï¼ŒndcgæŒ‡æ ‡æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ã€‚</li>
<li>ä¸ºäº†æ›´å¥½çš„å¯¹é½åœºæ™¯çš„ç‰¹å¾å·®å¼‚ï¼Œæˆ‘ä»¬å¯¹è¾“å…¥ç‰¹å¾åˆ†ç±»å»ºæ¨¡è¾“å…¥MMOEï¼ˆv4ï¼‰ã€‚æ­¤æ—¶ï¼Œç¦»çº¿æŒ‡æ ‡ndcg@10ç›¸å¯¹æå‡0.22%ï¼Œä¸Šçº¿åï¼Œs2oæŒ‡æ ‡æå‡0.51%ã€‚</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26887a13085a47f6a05120a1c194a068~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=941VOboOfo8q4E3QLFF%2FD%2F8aABY%3D" alt="f523e796169819e3bd5fd590008d0956.png" loading="lazy"/></p>
<h4 data-id="heading-22">5. ç‰¹å¾é€‰æ‹©</h4>
<h5 data-id="heading-23">5.1 ä¸ºä»€ä¹ˆéœ€è¦åšç‰¹å¾é€‰æ‹©ï¼Ÿ</h5>
<p>éšç€Qunaré…’åº—æ’åºæ¨¡å‹ä¸šåŠ¡éœ€æ±‚çš„è¿­ä»£ï¼Œè¶Šæ¥è¶Šå¤šçš„ç‰¹å¾è¢«å¼•å…¥æ¨¡å‹ä¸­ï¼Œå¯¼è‡´å‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>å†—ä½™ç‰¹å¾å¢å¤š
<ul>
<li>æœ‰äº›ç‰¹å¾å¯èƒ½ä¸å½“ä¸‹çš„é—®é¢˜æ— å…³ã€‚è¿™æ„å‘³ç€å®ƒä»¬ä¸æ¨¡å‹è¦è§£å†³çš„ä»»åŠ¡å®Œå…¨æ— å…³ï¼Œä¸¢å¼ƒä¸ç›¸å…³çš„ç‰¹å¾å¯ä»¥é˜²æ­¢æ¨¡å‹å¾—åˆ°æ— å…³ç‰¹å¾ä¸Šå¯èƒ½æºå¸¦çš„è™šå‡ç›¸å…³æ€§ï¼Œä»è€Œé¿å…è¿‡æ‹Ÿåˆã€‚</li>
</ul>
</li>
<li>ç»´åº¦ç¾éš¾
<ul>
<li>ç‰¹å¾é€‰æ‹©æŠ€æœ¯åœ¨å…·æœ‰è®¸å¤šç‰¹å¾ä½†è®­ç»ƒç¤ºä¾‹å¾ˆå°‘çš„åœºæ™¯ä¸­å°¤ä¸ºé‡è¦ã€‚è¿™ç§æƒ…å†µå—åˆ°æ‰€è°“çš„ç»´åº¦ç¾éš¾çš„å½±å“ï¼šåœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œæ¯ä¸ªè®­ç»ƒç¤ºä¾‹éƒ½ä¸å…¶ä»–æ‰€æœ‰ç¤ºä¾‹ç›¸è·ç”šè¿œï¼Œå› æ­¤æ¨¡å‹æ— æ³•å­¦ä¹ ä»»ä½•æœ‰ç”¨çš„æ¨¡å¼ã€‚</li>
</ul>
</li>
<li>è®­ç»ƒæ—¶é—´é•¿
<ul>
<li>ç‰¹å¾è¶Šå¤šï¼Œè®­ç»ƒæ—¶é—´å°±è¶Šé•¿ã€‚è¿™ç§æƒè¡¡çš„å…·ä½“ç»†èŠ‚å–å†³äºæ‰€ä½¿ç”¨çš„ç‰¹å®šå­¦ä¹ ç®—æ³•ï¼Œä½†åœ¨éœ€è¦å®æ—¶è¿›è¡Œå†è®­ç»ƒçš„æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦é™åˆ¶åœ¨å‡ ä¸ªæœ€ä½³ç‰¹å¾ä¸­è¿›è¡Œã€‚</li>
</ul>
</li>
<li>éƒ¨ç½²å·¥ä½œæˆæœ¬é«˜
<ul>
<li>ç‰¹å¾è¶Šå¤šï¼Œæœºå™¨å­¦ä¹ ç³»ç»Ÿåœ¨ç”Ÿäº§ä¸­å°±è¶Šå¤æ‚ã€‚è¿™ä¼šå¸¦æ¥å¤šç§é£é™©ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºé«˜ç»´æŠ¤å·¥ä½œé‡ã€çº çº·ã€æœªç”³æŠ¥çš„ä½¿ç”¨è€…æˆ–çº æ­£çº§è”ã€‚</li>
</ul>
</li>
<li>å¯è§£é‡Šæ€§å·®
<ul>
<li>ç”±äºç‰¹å¾å¤ªå¤šï¼Œæˆ‘ä»¬å¤±å»äº†æ¨¡å‹çš„å¯è§£é‡Šæ€§ã€‚è™½ç„¶å¯¹æ¨¡å‹ç»“æœçš„è§£é‡Šå¹¶ä¸æ€»æ˜¯ä¸»è¦çš„å»ºæ¨¡ç›®æ ‡ï¼Œä½†é€šå¸¸å¾ˆé‡è¦ï¼Œåœ¨æŸäº›å—ç›‘ç®¡çš„é¢†åŸŸï¼Œç”šè‡³å¯èƒ½æ˜¯æ³•å¾‹è¦æ±‚ã€‚</li>
</ul>
</li>
</ul>
<h5 data-id="heading-24">5.2 ä¼ ç»Ÿç‰¹å¾é€‰æ‹©æ–¹æ³•</h5>
<ul>
<li>æ— ç›‘ç£çš„ç‰¹å¾é€‰æ‹©æ–¹æ³•</li>
<li>åŒ…è£…å™¨ç‰¹å¾é€‰æ‹©æ–¹æ³•</li>
<li>è¿‡æ»¤å™¨ç‰¹å¾é€‰æ‹©æ–¹æ³•</li>
<li>Borutaï¼ˆå¸ƒå°”å¡”ï¼‰æ–¹æ³•</li>
</ul>
<p>ä¸Šè¿°ä¼ ç»Ÿæ–¹æ³•æ›´é€‚åˆæ•°é‡å°ï¼Œè®­ç»ƒæ—¶é—´çŸ­ï¼Œæ¨¡å‹ç®€å•çš„åœºæ™¯ã€‚è€Œæˆ‘ä»¬æ·±åº¦æ¨¡å‹é‡‡ç”¨äº†åŸºäºdropout çš„ç‰¹å¾é€‰æ‹©ï¼Œå€Ÿé‰´äº†è®ºæ–‡Dropout Feature Ranking for Deep Learning Models çš„å·¥ä½œã€‚</p>
<h5 data-id="heading-25">5.3 ä½¿ç”¨å˜åˆ†dropoutæ¥åšç‰¹å¾çš„æ’åº</h5>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd6610248cf4492aaed4e594ac015450~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=tWSu32VhRWdNZJtv0mnYD9BfZ38%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾11 dropoutçš„è®­ç»ƒå‰åçš„ä¸¢å¼ƒæ¦‚ç‡ç¤ºæ„å›¾</p>
<p>åŸºäºä¸¤é˜¶æ®µï¼Œç¬¬ä¸€é˜¶æ®µéœ€è¦å…ˆè®­ç»ƒä¸€ä¸ªpretrained Model è¿™æ ·å…ˆå­¦ä¹ æ¨¡å‹çš„å‚æ•°ï¼Œç¬¬äºŒé˜¶æ®µå›ºå®šæ¨¡å‹å‚æ•°ä¸åšæ¢¯åº¦æ›´æ–°ï¼Œå¯¹è¾“å…¥çš„ç‰¹å¾å¢åŠ ä¸€ä¸ªdropoutä¸¢å¼ƒå˜é‡ï¼ˆå¯å¯¼ï¼‰ä¸è¾“å…¥ç‰¹å¾å…ƒç´ ç›¸ä¹˜ï¼Œè¿™ä¸ªé˜¶æ®µçš„ä¸»è¦ç›®çš„æ˜¯ä¼˜åŒ–è¯¥dropoutä¸¢å¼ƒæ¦‚ç‡ã€‚</p>
<p>å¦‚å›¾11æ‰€ç¤ºï¼Œè®ºæ–‡æå‡ºäº†Dropout Feature Rankingæ–¹æ³•ï¼Œåœ¨è®­ç»ƒå®Œåï¼Œå¯ä»¥è·å–åˆ°æ¯ä¸ªç‰¹å¾çš„é‡è¦åº¦ã€‚</p>
<p>æœ¬è´¨çš„æ€æƒ³æ˜¯å°†ä¸å¯å¯¼çš„ç¦»æ•£å˜é‡dropoutï¼Œé‡‡ç”¨Concrete relaxationæ“ä½œï¼Œå¯¹ç¬¦åˆä¼¯åŠªåˆ©åˆ†å¸ƒçš„ç¦»æ•£å˜é‡è¿‘ä¼¼ä¼°è®¡ä¸ºä¸€ä¸ªè¿ç»­å¯å¯¼å˜é‡ã€‚æ¾å¼›ä¸ºè¿ç»­æ€§çš„å™ªå£°æ‰°åŠ¨è¿‡ç¨‹ï¼Œä½¿å…¶å¯ä»¥è¿›è¡Œæ¢¯åº¦æ›´æ–°ã€‚å¹¶å¯¹1-dropout_rateæ·»åŠ æ­£åˆ™ï¼Œä½¿å…¶åœ¨è®­ç»ƒä¸­å°½å¯èƒ½æœ€å°åŒ–ã€‚å›¾12 ä¸­çš„på°±æ˜¯ç‰¹å¾çš„ä¸¢å¼ƒæ¦‚ç‡ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/81b817f69e9042f1be01342919c68fe8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=3NG00dQ5uG1A4WOXDhwkHjT3jxo%3D" alt="" loading="lazy"/></p>
<p align="center">å›¾12 dropout layerå±‚</p>
<p>è¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹ï¼š</p>
<ul>
<li>é€šç”¨æ€§é«˜ï¼šå¯ä»¥åº”ç”¨äºä»»ä½•æ·±åº¦å­¦ä¹ æ¨¡å‹</li>
<li>ç®€å•æ–¹ä¾¿ï¼šåœ¨è®­ç»ƒå¥½çš„æ¨¡å‹åªè¿›è¡Œä¸€æ¬¡dropoutå‚æ•°è®­ç»ƒå³å¯å¾—å‡ºç‰¹å¾é‡è¦æ€§æ’åºï¼Œæ— éœ€è¿›è¡Œå¤šæ¬¡å®éªŒæ¥å‰”é™¤ç‰¹å¾</li>
<li>æ•ˆæœå¯é ï¼šè¯¥æ–¹æ³•åœ¨å®é™…ä¸šåŠ¡åº”ç”¨ä¸­å±•ç°å‡ºäº†å‡ºè‰²çš„ç‰¹å¾ç­›é€‰æ•ˆæœã€‚</li>
</ul>
<h5 data-id="heading-26">å®éªŒæ•ˆæœï¼š</h5>
<p>1ã€ä¸ºäº†éªŒè¯æ— æ•ˆç‰¹å¾ä¼šå½±å“æ¨¡å‹çš„æ•ˆæœï¼Œæˆ‘ä»¬åœ¨æ¨¡å‹çš„åŸç‰¹å¾åŸºç¡€ä¸Šå¢åŠ äº†10ä¸ªéšæœºç”Ÿæˆçš„å™ªå£°ç”Ÿæˆå™ªå£°ç‰¹å¾ï¼ˆåœ¨æŸäº›ç‰¹å¾ä¸Šæ·»åŠ å‡åŒ€åˆ†å¸ƒå™ªå£°ã€é«˜æ–¯åˆ†å¸ƒå™ªå£°ç­‰ï¼‰</p>
<p>2ã€åŠ ä¸ŠDFRå±‚åï¼Œåˆ å‡äº†14ç»´ç‰¹å¾åï¼Œæ¨¡å‹æ•ˆæœä¸ä½†æ²¡æœ‰ä¸‹é™ï¼Œåè€Œæœ‰å¾®å¼±çš„æå‡ã€‚åˆ é™¤ç‰¹å¾é‡æ–°è®­ç»ƒæ¨¡å‹ï¼Œçº¿ä¸Šè½¬åŒ–ç‡æå‡0.2%ã€‚</p>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94ac2afe054b45b690a6a39c3907ef33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=LbydBDARjkm5MJjZffdDZ%2F2yzCg%3D" alt="4cbe3a5269eb4687a95e6edaaaa684d3.png" loading="lazy"/></p>
<p>3ã€ä½¿ç”¨DFRç®—æ³•åï¼Œç‰¹å¾é‡è¦æ€§å¦‚ä¸‹ï¼š</p>
<ul>
<li>åŸºæœ¬ä¸Šæ˜¯å®æ—¶ç‰¹å¾æ›´é‡è¦</li>
<li>æˆ‘ä»¬å°†ä½äºå¯¹ç…§ç‰¹å¾ï¼ˆé«˜æ–¯å™ªå£°ï¼‰é‡è¦åº¦åˆ†çš„ç‰¹å¾åˆ é™¤ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€äº›å†—ä½™ç‰¹å¾ã€‚</li>
</ul>
<p align="center"><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/df6bad579cdc49b9b72d422a46eabd1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y675ZOq5YS_5oqA5pyv5rKZ6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769150161&amp;x-signature=zLYMWwRJjzNyKUsDuWfq9KcujpQ%3D" alt="973e23cd3794b64133c5763dbd144d8d.png" loading="lazy"/></p>
<h2 data-id="heading-27">äº”ã€é˜¶æ®µæ€»ç»“å’Œæœªæ¥è§„åˆ’</h2>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»Qunaråœ¨é…’åº—æœç´¢ç²¾æ’æ¨¡å‹ä¸Šçš„æ¼”è¿›å®è·µï¼Œä»å®éªŒæ•ˆæœæ¥çœ‹ï¼Œè¯æ˜äº†æ·±åº¦æ¨¡å‹åœ¨é…’åº—æœç´¢æ’åºçš„æœ‰æ•ˆæ€§ï¼Œä»¥åŠåˆç†å¼•å…¥å¤šåœºæ™¯ç‰¹å¾é—´çš„å·®å¼‚å»ºæ¨¡å¯ä»¥è®©æ¨¡å‹æ›´å¥½çš„ç†è§£æ•°æ®ã€‚</p>
<p>å¯¹äºæ¥ä¸‹æ¥çš„æ·±åº¦æ¨¡å‹ä¼˜åŒ–ï¼šå€Ÿé‰´listwiseçš„å»ºæ¨¡æ–¹å¼ï¼Œå°†pointwise losså’Œlistwise lossèåˆï¼Œæ—¢å¯ä»¥å­¦ä¹ æ’åºï¼Œåˆå¯ä»¥å­¦ä¹ åˆ¤åˆ«åˆ†ç±»ã€‚</p>
<p>[1]Chris J.C. Burges. 2010. From RankNet to LambdaRank to LambdaMART: An Overview. Technical Report. <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.microsoft.com%2Fen-us%2Fresearch%2Fpublication%2Ffrom-ranknet-to-lambdarank-to-lambdamart-an-overview%2F" target="_blank" title="https://www.microsoft.com/en-us/research/publication/from-ranknet-to-lambdarank-to-lambdamart-an-overview/" ref="nofollow noopener noreferrer">www.microsoft.com/en-us/reseaâ€¦</a></p>
<p>[2] Rama Kumar Pasumarthi, Sebastian Bruch, Xuanhui Wang, Cheng Li, Michael Bendersky, Marc Najork, Jan Pfeifer, Nadav Golbandi, Rohan Anil, Stephan Wolf.</p>
<p>TF-Ranking: Scalable TensorFlow Library for Learning-to-Rank.KDD 2019.</p>
<p>[3] Haldar M, Abdool M, Ramanathan P, et al. Applying deep learning to airbnb search[C]//Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining. 2019: 1927-1935.</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaåŒäº²å§”æ´¾æ¨¡å‹å·¥ä½œåŸç†]]></title>    <link>https://juejin.cn/post/7595472747455676431</link>    <guid>https://juejin.cn/post/7595472747455676431</guid>    <pubDate>2026-01-16T01:51:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595472747455676431" data-draft-id="7595400254348378127" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaåŒäº²å§”æ´¾æ¨¡å‹å·¥ä½œåŸç†"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-16T01:51:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ITæ©˜å­çš®"/> <meta itemprop="url" content="https://juejin.cn/user/3148645291002232"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaåŒäº²å§”æ´¾æ¨¡å‹å·¥ä½œåŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3148645291002232/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ITæ©˜å­çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T01:51:41.000Z" title="Fri Jan 16 2026 01:51:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€åŒäº²å§”æ´¾æ¨¡å‹çš„æ ¸å¿ƒæœºåˆ¶</h2>
<h3 data-id="heading-1">1.1 ç±»åŠ è½½å™¨çš„å±‚çº§ç»“æ„</h3>
<p>Javaç±»åŠ è½½å™¨é‡‡ç”¨<strong>æ ‘å½¢å±‚çº§ç»“æ„</strong>ï¼ŒåŒ…å«ä¸‰ç±»æ ¸å¿ƒåŠ è½½å™¨ï¼š</p>
<ul>
<li><strong>Bootstrap ClassLoaderï¼ˆå¯åŠ¨ç±»åŠ è½½å™¨ï¼‰</strong> ï¼šç”±C++å®ç°ï¼Œè´Ÿè´£åŠ è½½JVMæ ¸å¿ƒç±»åº“ï¼ˆå¦‚<code>java.lang.*</code>ï¼‰ï¼Œä½äº<code>&lt;JAVA_HOME&gt;/lib</code>ç›®å½•ã€‚</li>
<li><strong>Extension ClassLoaderï¼ˆæ‰©å±•ç±»åŠ è½½å™¨ï¼‰</strong> ï¼šåŠ è½½<code>&lt;JAVA_HOME&gt;/lib/ext</code>ç›®å½•æˆ–<code>java.ext.dirs</code>æŒ‡å®šçš„æ‰©å±•ç±»ã€‚</li>
<li><strong>Application ClassLoaderï¼ˆåº”ç”¨ç±»åŠ è½½å™¨ï¼‰</strong> ï¼šé»˜è®¤åŠ è½½ç”¨æˆ·ç±»è·¯å¾„ï¼ˆClasspathï¼‰ä¸Šçš„ç±»ï¼Œæ˜¯è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„çˆ¶åŠ è½½å™¨ã€‚</li>
</ul>
<p>ä¸‰è€…é€šè¿‡ç»„åˆå…³ç³»å½¢æˆå±‚çº§ï¼Œè€Œéç»§æ‰¿ã€‚</p>
<h3 data-id="heading-2">1.2 åŒäº²å§”æ´¾çš„å·¥ä½œæµç¨‹</h3>
<p>å½“ç±»åŠ è½½å™¨æ”¶åˆ°åŠ è½½è¯·æ±‚æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li><strong>æ£€æŸ¥ç¼“å­˜</strong>ï¼šè‹¥å½“å‰åŠ è½½å™¨å·²åŠ è½½è¯¥ç±»ï¼Œç›´æ¥è¿”å›ã€‚</li>
<li><strong>å§”æ´¾çˆ¶åŠ è½½å™¨</strong>ï¼šé€’å½’è¯·æ±‚çˆ¶åŠ è½½å™¨åŠ è½½ï¼ˆç›´è‡³Bootstrapï¼‰ã€‚</li>
<li><strong>çˆ¶åŠ è½½å¤±è´¥åè‡ªåŠ è½½</strong>ï¼šè‹¥çˆ¶åŠ è½½å™¨æ— æ³•åŠ è½½ï¼Œå½“å‰åŠ è½½å™¨è°ƒç”¨<code>findClass()</code>æ–¹æ³•åŠ è½½ã€‚</li>
</ol>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ClassLoaderæºç æ ¸å¿ƒé€»è¾‘ï¼ˆç®€åŒ–ï¼‰</span>
protected Class&lt;?&gt; <span class="hljs-built_in">loadClass</span>(String name, boolean resolve) {
    synchronized (getClassLoadingLock(name)) {
        Class&lt;?&gt; c = <span class="hljs-built_in">findLoadedClass</span>(name);
        if (c == null) {
            try {
                if (parent != null) {
                    c = parent<span class="hljs-selector-class">.loadClass</span>(name, false); <span class="hljs-comment">// å§”æ´¾çˆ¶åŠ è½½å™¨</span>
                } else {
                    c = <span class="hljs-built_in">findBootstrapClassOrNull</span>(name); <span class="hljs-comment">// BootstrapåŠ è½½</span>
                }
            } catch (ClassNotFoundException ignored) {}
            if (c == null) {
                c = <span class="hljs-built_in">findClass</span>(name); <span class="hljs-comment">// è‡ªåŠ è½½</span>
            }
        }
        if (resolve) <span class="hljs-built_in">resolveClass</span>(c);
        return c;
    }
}
</code></pre>
<p>æ­¤æµç¨‹ç¡®ä¿<strong>ç±»åŠ è½½è¯·æ±‚æœ€ç»ˆç”±æœ€é¡¶å±‚çš„Bootstrapå°è¯•å¤„ç†</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-3">äºŒã€åŒäº²å§”æ´¾çš„æ ¸å¿ƒä¼˜åŠ¿</h2>
<h3 data-id="heading-4">2.1 å®‰å…¨æ€§ä¿éšœ</h3>
<ul>
<li><strong>æ ¸å¿ƒç±»åº“ä¿æŠ¤</strong>ï¼šç”¨æˆ·è‡ªå®šä¹‰çš„<code>java.lang.String</code>ç­‰ç±»ä¼šè¢«BootstrapåŠ è½½å™¨æ‹¦æˆªï¼Œé¿å…ç¯¡æ”¹æ ¸å¿ƒAPIã€‚</li>
<li><strong>æ²™ç®±éš”ç¦»</strong>ï¼šæ¶æ„ä»£ç æ— æ³•é€šè¿‡è¦†ç›–æ ¸å¿ƒç±»å®ç°æ”»å‡»ã€‚</li>
</ul>
<h3 data-id="heading-5">2.2 å”¯ä¸€æ€§ä¸ç¨³å®šæ€§</h3>
<ul>
<li><strong>ç±»å”¯ä¸€æ€§</strong>ï¼šç±»ç”±<strong>å…¨é™å®šå+åŠ è½½å™¨å®ä¾‹</strong>å…±åŒæ ‡è¯†ï¼Œé¿å…é‡å¤åŠ è½½ã€‚</li>
<li><strong>èµ„æºä¸€è‡´æ€§</strong>ï¼šç¡®ä¿<code>System.getProperty("java.version")</code>ç­‰å…¨å±€èµ„æºåŠ è½½ä¸€è‡´æ€§ã€‚</li>
</ul>
<h3 data-id="heading-6">2.3 æ€§èƒ½ä¼˜åŒ–</h3>
<ul>
<li>å‡å°‘é‡å¤ç±»åŠ è½½çš„å¼€é”€ï¼Œå°¤å…¶å¯¹é¢‘ç¹ä½¿ç”¨çš„ç±»ï¼ˆå¦‚é›†åˆæ¡†æ¶ï¼‰æ•ˆæœæ˜¾è‘—ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-7">ä¸‰ã€ç ´ååŒäº²å§”æ´¾çš„å…¸å‹åœºæ™¯</h2>
<h3 data-id="heading-8">3.1 SPIæœºåˆ¶ï¼ˆæœåŠ¡æä¾›æ¥å£ï¼‰</h3>
<ul>
<li>
<p><strong>é—®é¢˜</strong>ï¼š<code>java.sql.Driver</code>ç”±BootstrapåŠ è½½ï¼Œä½†å…·ä½“å®ç°ï¼ˆå¦‚MySQLé©±åŠ¨ï¼‰éœ€ç”±åº”ç”¨ç±»åŠ è½½å™¨åŠ è½½ã€‚</p>
</li>
<li>
<p><strong>å®ç°</strong>ï¼šé€šè¿‡<code>Thread.currentThread().getContextClassLoader()</code>è·å–ä¸Šä¸‹æ–‡åŠ è½½å™¨ï¼Œæ‰“ç ´å§”æ´¾é“¾ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// JDBCé©±åŠ¨åŠ è½½ç¤ºä¾‹
ServiceLoader&lt;Driver&gt; <span class="hljs-attr">loader</span> = ServiceLoader.load(Driver.class, Thread.currentThread().getContextClassLoader())<span class="hljs-comment">;</span>
</code></pre>
</li>
</ul>
<h3 data-id="heading-9">3.2 åº”ç”¨æœåŠ¡å™¨çƒ­éƒ¨ç½²</h3>
<ul>
<li>
<p><strong>Tomcatçš„WebappClassLoader</strong>ï¼šä¼˜å…ˆä»<code>WEB-INF/lib</code>åŠ è½½ç±»ï¼Œè€Œéå§”æ´¾ç»™çˆ¶åŠ è½½å™¨ï¼Œå®ç°Webåº”ç”¨éš”ç¦»ã€‚</p>
</li>
<li>
<p><strong>ä»£ç ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// Tomcatç±»åŠ è½½é€»è¾‘ï¼ˆç®€åŒ–ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-title class_">Class</span>&lt;?&gt; <span class="hljs-title function_">loadClass</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> name</span>) {
    <span class="hljs-keyword">if</span> (name.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"com.example.app"</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">findClass</span>(name); <span class="hljs-comment">// è‡ªä¼˜å…ˆåŠ è½½</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">loadClass</span>(name);
}
</code></pre>
</li>
</ul>
<h3 data-id="heading-10">3.3 æ¨¡å—åŒ–æ¡†æ¶ï¼ˆOSGiï¼‰</h3>
<ul>
<li><strong>åŠ¨æ€æ¨¡å—åŠ è½½</strong>ï¼šæ¯ä¸ªBundleæ‹¥æœ‰ç‹¬ç«‹ç±»åŠ è½½å™¨ï¼Œæ”¯æŒçƒ­æ’æ‹”ã€‚</li>
<li><strong>é€‰æ‹©æ€§å§”æ´¾</strong>ï¼šä»…å¯¹<code>java.*</code>ç­‰æ ¸å¿ƒåŒ…å§”æ´¾ï¼Œå…¶ä»–åŒ…ç”±è‡ªèº«åŠ è½½ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-11">å››ã€ç ´ååŒäº²å§”æ´¾çš„åæœä¸é£é™©</h2>
<h3 data-id="heading-12">4.1 ç±»é‡å¤åŠ è½½ä¸ç±»å‹å†²çª</h3>
<ul>
<li>
<p><strong>é—®é¢˜</strong>ï¼šä¸åŒåŠ è½½å™¨åŠ è½½åŒåç±»ï¼ˆå¦‚<code>com.user.User</code>ï¼‰ï¼Œå¯¼è‡´<code>ClassCastException</code>ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// ç¤ºä¾‹ï¼šä¸¤ä¸ªWebåº”ç”¨åŠ è½½ä¸åŒç‰ˆæœ¬çš„Log4j
ClassLoader <span class="hljs-attr">loader1</span> = app1.getClassLoader()<span class="hljs-comment">;</span>
ClassLoader <span class="hljs-attr">loader2</span> = app2.getClassLoader()<span class="hljs-comment">;</span>
Class&lt;?&gt; <span class="hljs-attr">log4j1</span> = loader1.loadClass(<span class="hljs-string">"org.apache.log4j.Logger"</span>)<span class="hljs-comment">;</span>
Class&lt;?&gt; <span class="hljs-attr">log4j2</span> = loader2.loadClass(<span class="hljs-string">"org.apache.log4j.Logger"</span>)<span class="hljs-comment">;</span>
// log4j1 != log4j2ï¼Œç±»å‹ä¸å…¼å®¹
</code></pre>
</li>
</ul>
<h3 data-id="heading-13">4.2 æ ¸å¿ƒç±»åº“ç¯¡æ”¹é£é™©</h3>
<ul>
<li><strong>æ¶æ„ä»£ç æ³¨å…¥</strong>ï¼šè‹¥ç»•è¿‡åŒäº²å§”æ´¾åŠ è½½ä¼ªé€ çš„<code>java.lang.Runtime</code>ï¼Œå¯èƒ½æ‰§è¡Œå±é™©æ“ä½œã€‚</li>
</ul>
<h3 data-id="heading-14">4.3 å†…å­˜æ³„æ¼ä¸ç±»å¸è½½å¤±è´¥</h3>
<ul>
<li><strong>ç±»åŠ è½½å™¨æ³„æ¼</strong>ï¼šè‡ªå®šä¹‰åŠ è½½å™¨æŒæœ‰é™æ€å¼•ç”¨ï¼ˆå¦‚ç¼“å­˜ï¼‰ï¼Œå¯¼è‡´å…¶æ— æ³•è¢«GCå›æ”¶ï¼Œè¿å¸¦ç±»ä¹Ÿæ— æ³•å¸è½½ã€‚</li>
<li><strong>å…ƒç©ºé—´OOM</strong>ï¼šé¢‘ç¹åŠ è½½/å¸è½½ç±»å¯¼è‡´å…ƒç©ºé—´è†¨èƒ€ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-15">äº”ã€æœ€ä½³å®è·µä¸è°ƒä¼˜å»ºè®®</h2>
<h3 data-id="heading-16">5.1 è°¨æ…æ‰“ç ´åŒäº²å§”æ´¾</h3>
<ul>
<li><strong>é™å®šèŒƒå›´</strong>ï¼šä»…åœ¨å¿…è¦æ—¶ï¼ˆå¦‚SPIã€çƒ­éƒ¨ç½²ï¼‰å±€éƒ¨æ‰“ç ´ï¼Œé¿å…å…¨å±€ç ´åã€‚</li>
<li><strong>éš”ç¦»ç­–ç•¥</strong>ï¼šä½¿ç”¨ç‹¬ç«‹ç±»åŠ è½½å™¨åŠ è½½é«˜é£é™©ä»£ç ï¼Œå¹¶é™åˆ¶å…¶æƒé™ã€‚</li>
</ul>
<h3 data-id="heading-17">5.2 ç±»åŠ è½½å™¨ç®¡ç†</h3>
<ul>
<li>
<p><strong>å¼±å¼•ç”¨ç¼“å­˜</strong>ï¼šå¯¹<code>Class</code>å¯¹è±¡ä½¿ç”¨<code>WeakReference</code>ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-built_in">WeakReference</span>&lt;Class<span class="hljs-meta">&lt;?</span>&gt;&gt; clazzRef = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakReference</span>&lt;&gt;(MyClass.<span class="hljs-keyword">class</span>);
</code></pre>
</li>
<li>
<p><strong>æ¸…ç†æœºåˆ¶</strong>ï¼šåœ¨Webåº”ç”¨åœæ­¢æ—¶ï¼Œæ˜¾å¼å¸è½½ç±»åŠ è½½å™¨å¹¶é‡Šæ”¾èµ„æºã€‚</p>
</li>
</ul>
<h3 data-id="heading-18">5.3 ç›‘æ§ä¸è°ƒè¯•</h3>
<ul>
<li>
<p><strong>JVMå‚æ•°</strong>ï¼š</p>
<ul>
<li><code>-verbose:class</code>ï¼šè·Ÿè¸ªç±»åŠ è½½è¿‡ç¨‹ã€‚</li>
<li><code>-XX:+TraceClassLoading</code>ï¼šè¾“å‡ºè¯¦ç»†åŠ è½½æ—¥å¿—ã€‚</li>
</ul>
</li>
<li>
<p><strong>å·¥å…·åˆ†æ</strong>ï¼šä½¿ç”¨JConsoleã€VisualVMç›‘æ§ç±»åŠ è½½å™¨çŠ¶æ€ã€‚</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-19">å…­ã€æ€»ç»“</h2>
<p>åŒäº²å§”æ´¾æ¨¡å‹é€šè¿‡<strong>å±‚çº§å§”æ´¾ã€å”¯ä¸€æ€§ä¿éšœ</strong>å’Œ<strong>å®‰å…¨éš”ç¦»</strong>ï¼Œæˆä¸ºJavaç±»åŠ è½½æœºåˆ¶çš„åŸºçŸ³ã€‚å°½ç®¡åœ¨SPIã€çƒ­éƒ¨ç½²ç­‰åœºæ™¯ä¸­éœ€çµæ´»æ‰“ç ´è¯¥æ¨¡å‹ï¼Œä½†å¼€å‘è€…éœ€æ·±åˆ»ç†è§£å…¶é£é™©ï¼Œé€šè¿‡<strong>éš”ç¦»åŠ è½½ã€ä¸¥æ ¼èµ„æºç®¡ç†</strong>å’Œ<strong>ç›‘æ§è°ƒä¼˜</strong>è§„é¿æ½œåœ¨é—®é¢˜ã€‚æœªæ¥ï¼Œéšç€æ¨¡å—åŒ–ç³»ç»Ÿï¼ˆå¦‚Project Jigsawï¼‰çš„æ™®åŠï¼Œç±»åŠ è½½æœºåˆ¶å°†æ›´è¶‹ç²¾ç»†åŒ–ï¼Œä½†åŒäº²å§”æ´¾çš„æ ¸å¿ƒæ€æƒ³ä»å°†å»¶ç»­ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬ä¹ç«  èµ„æºåŠ è½½æ–°ç‰¹æ€§Suspense åŸç”Ÿåè°ƒåŸç†ä¸å®æˆ˜]]></title>    <link>https://juejin.cn/post/7595478717985243145</link>    <guid>https://juejin.cn/post/7595478717985243145</guid>    <pubDate>2026-01-16T01:22:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595478717985243145" data-draft-id="7590309337861570601" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬ä¹ç«  èµ„æºåŠ è½½æ–°ç‰¹æ€§Suspense åŸç”Ÿåè°ƒåŸç†ä¸å®æˆ˜"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯æ¡†æ¶,React.js"/> <meta itemprop="datePublished" content="2026-01-16T01:22:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ€•æµªçŒ«"/> <meta itemprop="url" content="https://juejin.cn/user/2832784963939438"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Reactä»å…¥é—¨åˆ°å‡ºé—¨ç¬¬ä¹ç«  èµ„æºåŠ è½½æ–°ç‰¹æ€§Suspense åŸç”Ÿåè°ƒåŸç†ä¸å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2832784963939438/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ€•æµªçŒ«
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T01:22:30.000Z" title="Fri Jan 16 2026 01:22:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï½ æåˆ° React çš„ Suspenseï¼Œå¾ˆå¤šå¼€å‘è€…çš„ç¬¬ä¸€å°è±¡æ˜¯â€œç”¨æ¥åšä»£ç åˆ†å‰²â€æˆ–â€œé…åˆ lazy åŠ è½½ç»„ä»¶â€ã€‚ä½†åœ¨ React 19 ä¹‹å‰ï¼ŒSuspense åœ¨èµ„æºåŠ è½½åœºæ™¯ä¸‹å§‹ç»ˆæœ‰ä¸ªè‡´å‘½çŸ­æ¿ï¼šæ— æ³•åŸç”Ÿåè°ƒå¤šä¸ªå¼‚æ­¥èµ„æºçš„åŠ è½½çŠ¶æ€ï¼Œå¯¼è‡´æˆ‘ä»¬éœ€è¦å†™å¤§é‡æ¨¡æ¿ä»£ç å¤„ç†â€œå¤šèµ„æºå¹¶è¡ŒåŠ è½½â€â€œä¾èµ–èµ„æºä¸²è¡ŒåŠ è½½â€ç­‰åœºæ™¯ã€‚</p>
<p>React 19 å½»åº•è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œæ¨å‡ºäº† <strong>Suspense åŸç”Ÿåè°ƒ</strong> ç‰¹æ€§ï¼Œè®©å¤šèµ„æºåŠ è½½çš„çŠ¶æ€ç®¡ç†å˜å¾—æç®€ã€‚ä»Šå¤©è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°±ä»â€œæ—§ç‰ˆ Suspense çš„ç—›ç‚¹â€å‡ºå‘ï¼Œä¸€æ­¥æ­¥æ‹†è§£ React 19 åŸç”Ÿåè°ƒçš„æ ¸å¿ƒåŸç†ï¼Œå†é€šè¿‡ 4 ä¸ªé«˜é¢‘å®æˆ˜æ¡ˆä¾‹ï¼Œå¸¦ä½ å½»åº•æŒæ¡è¿™ä¸ªæ–°ç‰¹æ€§çš„ç”¨æ³•ï¼Œè®©èµ„æºåŠ è½½é€»è¾‘æ›´æ¸…æ™°ã€ä»£ç æ›´ç®€æ´ï½</p>
<h2 data-id="heading-0">ä¸€ã€å…ˆå›é¡¾ï¼šæ—§ç‰ˆ Suspense çš„èµ„æºåŠ è½½ç—›ç‚¹</h2>
<p>åœ¨ React 19 ä¹‹å‰ï¼ŒSuspense è™½ç„¶èƒ½å¤„ç†å•ä¸ªå¼‚æ­¥èµ„æºçš„â€œåŠ è½½ä¸­ fallbackâ€ï¼Œä½†é¢å¯¹å¤šèµ„æºåŠ è½½åœºæ™¯æ—¶ï¼Œå°±æ˜¾å¾—åŠ›ä¸ä»å¿ƒäº†ã€‚æˆ‘ä»¬å…ˆé€šè¿‡ä¸¤ä¸ªå¸¸è§åœºæ™¯ï¼Œçœ‹çœ‹æ—§ç‰ˆ Suspense çš„é—®é¢˜æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-1">1. ç—›ç‚¹ 1ï¼šå¤šèµ„æºå¹¶è¡ŒåŠ è½½ï¼Œéœ€æ‰‹åŠ¨ç®¡ç†æ•´ä½“çŠ¶æ€</h3>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦åœ¨é¡µé¢ä¸­åŒæ—¶åŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€å’Œâ€œç”¨æˆ·è®¢å•åˆ—è¡¨â€ä¸¤ä¸ªå¼‚æ­¥èµ„æºï¼Œè¦æ±‚ä¸¤ä¸ªèµ„æºéƒ½åŠ è½½å®Œæˆåå†å±•ç¤ºé¡µé¢ï¼ŒåŠ è½½è¿‡ç¨‹ä¸­æ˜¾ç¤ºç»Ÿä¸€çš„ loadingã€‚åœ¨ React 19 ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç®¡ç†ä¸¤ä¸ªèµ„æºçš„åŠ è½½çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19 ä¹‹å‰ï¼šå¤šèµ„æºå¹¶è¡ŒåŠ è½½çš„ç¹çå®ç°</span>
<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// å¼‚æ­¥è¯·æ±‚å‡½æ•°</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/orders'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserDashboard</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// æ‰‹åŠ¨ç®¡ç†ä¸¤ä¸ªèµ„æºçš„åŠ è½½çŠ¶æ€å’Œç»“æœ</span>
  <span class="hljs-keyword">const</span> [user, setUser] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [orders, setOrders] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-title function_">setError</span>(<span class="hljs-literal">null</span>);

    <span class="hljs-comment">// å¹¶è¡Œè¯·æ±‚ä¸¤ä¸ªèµ„æº</span>
    <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([<span class="hljs-title function_">fetchUser</span>(), <span class="hljs-title function_">fetchOrders</span>()])
      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">[userData, ordersData]</span>) =&gt;</span> {
        <span class="hljs-title function_">setUser</span>(userData);
        <span class="hljs-title function_">setOrders</span>(ordersData);
      })
      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-title function_">setError</span>(err.<span class="hljs-property">message</span>))
      .<span class="hljs-title function_">finally</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>));
  }, []);

  <span class="hljs-comment">// æ‰‹åŠ¨å¤„ç† loading å’Œ error çŠ¶æ€</span>
  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½å¤±è´¥ï¼š{error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (!user || !orders) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„ä»ªè¡¨ç›˜<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æˆ‘çš„è®¢å•<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {orders.map((order) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{order.id}</span>&gt;</span>{order.title} - ï¿¥{order.amount}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>è¿™ç§å†™æ³•çš„é—®é¢˜å¾ˆæ˜æ˜¾ï¼š<strong>éœ€è¦æ‰‹åŠ¨ç”¨ useState ç®¡ç†å¤šä¸ªèµ„æºçš„çŠ¶æ€ï¼Œç”¨ Promise.all åè°ƒå¹¶è¡Œé€»è¾‘ï¼Œä»£ç æ¨¡æ¿åŒ–ä¸¥é‡</strong>ã€‚å¦‚æœèµ„æºæ•°é‡å¢åŠ åˆ° 3 ä¸ªã€4 ä¸ªï¼ŒçŠ¶æ€ç®¡ç†ä¼šå˜å¾—æ›´åŠ æ··ä¹±ã€‚</p>
<h3 data-id="heading-2">2. ç—›ç‚¹ 2ï¼šä¾èµ–èµ„æºä¸²è¡ŒåŠ è½½ï¼Œé€»è¾‘åµŒå¥—å†—ä½™</h3>
<p>å†çœ‹ä¸€ä¸ªæ›´å¤æ‚çš„åœºæ™¯ï¼šåŠ è½½â€œç”¨æˆ·è®¢å•è¯¦æƒ…â€éœ€è¦å…ˆåŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€ï¼ˆè·å–ç”¨æˆ· IDï¼‰ï¼Œå†æ ¹æ®ç”¨æˆ· ID åŠ è½½â€œè®¢å•åˆ—è¡¨â€ï¼Œæœ€åæ ¹æ®è®¢å• ID åŠ è½½â€œè®¢å•è¯¦æƒ…â€ã€‚è¿™ç§ä¸²è¡Œä¾èµ–çš„åœºæ™¯ï¼Œåœ¨æ—§ç‰ˆ React ä¸­éœ€è¦åµŒå¥—å¤šå±‚ Promiseï¼Œé€»è¾‘ç¹çï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// React 19 ä¹‹å‰ï¼šä¸²è¡Œèµ„æºåŠ è½½çš„åµŒå¥—å®ç°</span>
function <span class="hljs-built_in">OrderDetail</span>() {
  const <span class="hljs-selector-attr">[user, setUser]</span> = <span class="hljs-built_in">useState</span>(null);
  const <span class="hljs-selector-attr">[order, setOrder]</span> = <span class="hljs-built_in">useState</span>(null);
  const <span class="hljs-selector-attr">[detail, setDetail]</span> = <span class="hljs-built_in">useState</span>(null);
  const <span class="hljs-selector-attr">[loading, setLoading]</span> = <span class="hljs-built_in">useState</span>(true);
  const <span class="hljs-selector-attr">[error, setError]</span> = <span class="hljs-built_in">useState</span>(null);

  <span class="hljs-built_in">useEffect</span>(() =&gt; {
    <span class="hljs-built_in">setLoading</span>(true);
    <span class="hljs-built_in">setError</span>(null);

    <span class="hljs-comment">// ä¸²è¡Œè¯·æ±‚ï¼šç”¨æˆ·ä¿¡æ¯ â†’ è®¢å•åˆ—è¡¨ â†’ è®¢å•è¯¦æƒ…</span>
    <span class="hljs-built_in">fetchUser</span>()
      <span class="hljs-selector-class">.then</span>((userData) =&gt; {
        <span class="hljs-built_in">setUser</span>(userData);
        return <span class="hljs-built_in">fetchOrders</span>(userData.id); <span class="hljs-comment">// ä¾èµ–ç”¨æˆ· ID</span>
      })
      <span class="hljs-selector-class">.then</span>((ordersData) =&gt; {
        const firstOrder = ordersData<span class="hljs-selector-attr">[0]</span>;
        <span class="hljs-built_in">setOrder</span>(firstOrder);
        return <span class="hljs-built_in">fetchOrderDetail</span>(firstOrder.id); <span class="hljs-comment">// ä¾èµ–è®¢å• ID</span>
      })
      <span class="hljs-selector-class">.then</span>((detailData) =&gt; {
        <span class="hljs-built_in">setDetail</span>(detailData);
      })
      <span class="hljs-selector-class">.catch</span>((err) =&gt; <span class="hljs-built_in">setError</span>(err.message))
      <span class="hljs-selector-class">.finally</span>(() =&gt; <span class="hljs-built_in">setLoading</span>(false));
  }, <span class="hljs-selector-attr">[]</span>);

  if (loading) return &lt;<span class="hljs-selector-tag">div</span>&gt;åŠ è½½ä¸­...&lt;/<span class="hljs-selector-tag">div</span>&gt;;
  if (error) return &lt;<span class="hljs-selector-tag">div</span>&gt;åŠ è½½å¤±è´¥ï¼š{error}&lt;/<span class="hljs-selector-tag">div</span>&gt;;
  if (!user || !order || !detail) return null;

  return (
    &lt;div&gt;
      &lt;h2&gt;{user.name} çš„è®¢å•è¯¦æƒ…&lt;/h2&gt;
      &lt;p&gt;è®¢å•å·ï¼š{order.id}&lt;/p&gt;
      &lt;p&gt;å•†å“ï¼š{detail.goodsName}&lt;/p&gt;
      &lt;p&gt;é‡‘é¢ï¼šï¿¥{detail.amount}&lt;/p&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<p>è¿™ç§åµŒå¥—å†™æ³•ä¸ä»…å¯è¯»æ€§å·®ï¼Œè€Œä¸”ä¸€æ—¦æŸä¸ªç¯èŠ‚éœ€è¦ä¿®æ”¹ï¼ˆæ¯”å¦‚å¢åŠ ä¸€ä¸ªä¾èµ–èµ„æºï¼‰ï¼Œå°±éœ€è¦æ”¹åŠ¨å¤šå±‚ä»£ç ï¼Œç»´æŠ¤æˆæœ¬æé«˜ã€‚</p>
<h3 data-id="heading-3">3. ç—›ç‚¹æ€»ç»“ï¼šæ—§ç‰ˆ Suspense ä¸ºä½•â€œä¸çœå¿ƒâ€ï¼Ÿ</h3>
<p>æ—§ç‰ˆ Suspense ä¹‹æ‰€ä»¥æ— æ³•è§£å†³è¿™äº›é—®é¢˜ï¼Œæ ¸å¿ƒåŸå› æ˜¯ï¼š<strong>ä¸å…·å¤‡åŸç”Ÿçš„èµ„æºåè°ƒèƒ½åŠ›</strong>ã€‚å®ƒåªèƒ½ç›‘å¬å•ä¸ªç»„ä»¶å†…éƒ¨çš„å¼‚æ­¥èµ„æºï¼ˆæ¯”å¦‚é€šè¿‡ use() æˆ– lazy åŠ è½½çš„èµ„æºï¼‰ï¼Œæ— æ³•æ„ŸçŸ¥å¤šä¸ªç»„ä»¶ã€å¤šä¸ªèµ„æºä¹‹é—´çš„ä¾èµ–å…³ç³»å’ŒåŠ è½½é¡ºåºã€‚å› æ­¤ï¼Œå¼€å‘è€…å¿…é¡»æ‰‹åŠ¨ç”¨ Promise æˆ–çŠ¶æ€ç®¡ç†åº“æ¥åè°ƒè¿™äº›èµ„æºï¼Œå¯¼è‡´ä»£ç å†—ä½™ã€é€»è¾‘å¤æ‚ã€‚</p>
<h2 data-id="heading-4">äºŒã€React 19 æ ¸å¿ƒå‡çº§ï¼šSuspense åŸç”Ÿåè°ƒåŸç†</h2>
<p>React 19 ä¸º Suspense æ–°å¢äº† <strong>åŸç”Ÿåè°ƒèƒ½åŠ›</strong>ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯ï¼š<strong>è‡ªåŠ¨æ„ŸçŸ¥å¹¶åè°ƒå¤šä¸ªå¼‚æ­¥èµ„æºçš„åŠ è½½çŠ¶æ€ï¼Œæ”¯æŒå¹¶è¡Œã€ä¸²è¡Œç­‰å¤šç§åŠ è½½ç­–ç•¥ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†çŠ¶æ€</strong>ã€‚è¿™ä¸€ç‰¹æ€§å½»åº•è§£å†³äº†æ—§ç‰ˆçš„ç—›ç‚¹ï¼Œè®©å¤šèµ„æºåŠ è½½å˜å¾—æç®€ã€‚</p>
<h3 data-id="heading-5">1. æ ¸å¿ƒæ¦‚å¿µï¼šä»€ä¹ˆæ˜¯â€œåŸç”Ÿåè°ƒâ€ï¼Ÿ</h3>
<p>Suspense åŸç”Ÿåè°ƒï¼Œç®€å•æ¥è¯´å°±æ˜¯ï¼š<strong>å½“å¤šä¸ªå¼‚æ­¥èµ„æºè¢« Suspense åŒ…è£¹æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨æ”¶é›†æ‰€æœ‰èµ„æºçš„åŠ è½½çŠ¶æ€ï¼Œæ ¹æ®ä½ æŒ‡å®šçš„ç­–ç•¥ï¼ˆå¹¶è¡Œ/ä¸²è¡Œï¼‰ç­‰å¾…èµ„æºåŠ è½½å®Œæˆï¼Œå†ç»Ÿä¸€æ¸²æŸ“å†…å®¹ï¼›æœŸé—´åªæ˜¾ç¤ºä¸€ä¸ª fallbackï¼Œé”™è¯¯ä¹Ÿä¼šè¢«ç»Ÿä¸€æ•è·</strong>ã€‚</p>
<p>å…³é”®å˜åŒ–åœ¨äºï¼šReact 19 è®© Suspense ä»â€œå•ä¸ªèµ„æºçš„åŠ è½½å®¹å™¨â€å‡çº§ä¸ºâ€œå¤šä¸ªèµ„æºçš„åè°ƒå™¨â€ï¼Œèƒ½å¤Ÿä¸»åŠ¨ç®¡ç†å¤šä¸ªèµ„æºçš„åŠ è½½ç”Ÿå‘½å‘¨æœŸã€‚</p>
<h3 data-id="heading-6">2. æ ¸å¿ƒåŸç†ï¼š3 æ­¥å®ç°èµ„æºåè°ƒ</h3>
<p>Suspense åŸç”Ÿåè°ƒçš„åº•å±‚åŸç†ï¼Œä¾èµ–äº React 19 å¯¹â€œå¼‚æ­¥èµ„æºè°ƒåº¦ç³»ç»Ÿâ€çš„å‡çº§ï¼Œæ ¸å¿ƒæµç¨‹å¯ä»¥æ‹†è§£ä¸º 3 æ­¥ï¼š</p>
<ol>
<li>
<p><strong>èµ„æºæ”¶é›†é˜¶æ®µ</strong>ï¼šå½“ Suspense ç»„ä»¶æ¸²æŸ“æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨è¿½è¸ªå…¶å†…éƒ¨æ‰€æœ‰é€šè¿‡ use() æ¶ˆè´¹çš„å¼‚æ­¥èµ„æºï¼ˆæˆ–é€šè¿‡ lazy åŠ è½½çš„ç»„ä»¶ï¼‰ï¼Œå°†è¿™äº›èµ„æºçš„ Promise æ”¶é›†åˆ°ä¸€ä¸ªâ€œèµ„æºé˜Ÿåˆ—â€ä¸­ï¼›</p>
</li>
<li>
<p><strong>åŠ è½½åè°ƒé˜¶æ®µ</strong>ï¼šReact æ ¹æ® Suspense çš„é…ç½®ï¼ˆé»˜è®¤å¹¶è¡Œï¼Œå¯é€šè¿‡é…ç½®å®ç°ä¸²è¡Œï¼‰ï¼Œåè°ƒèµ„æºé˜Ÿåˆ—çš„åŠ è½½é¡ºåºï¼š</p>
<ol>
<li>å¹¶è¡Œç­–ç•¥ï¼šåŒæ—¶è§¦å‘æ‰€æœ‰èµ„æºçš„åŠ è½½ï¼Œç­‰å¾…æ‰€æœ‰èµ„æºéƒ½å†³è®®ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰ï¼›</li>
<li>ä¸²è¡Œç­–ç•¥ï¼šæŒ‰èµ„æºçš„ä¾èµ–å…³ç³»ä¾æ¬¡è§¦å‘åŠ è½½ï¼Œå‰ä¸€ä¸ªèµ„æºæˆåŠŸåå†åŠ è½½ä¸‹ä¸€ä¸ªï¼›</li>
</ol>
</li>
<li>
<p><strong>çŠ¶æ€ç»Ÿä¸€é˜¶æ®µ</strong>ï¼šåœ¨èµ„æºåŠ è½½è¿‡ç¨‹ä¸­ï¼ŒSuspense å§‹ç»ˆæ˜¾ç¤º fallbackï¼›å½“æ‰€æœ‰èµ„æºéƒ½æˆåŠŸåŠ è½½ï¼ŒSuspense ä¼šæ¸²æŸ“å†…éƒ¨å†…å®¹ï¼›å¦‚æœä»»ä½•ä¸€ä¸ªèµ„æºåŠ è½½å¤±è´¥ï¼Œé”™è¯¯ä¼šè¢« ErrorBoundary ç»Ÿä¸€æ•è·ã€‚</p>
</li>
</ol>
<h4 data-id="heading-7">Suspense åŸç”Ÿåè°ƒæµç¨‹å›¾</h4>
<h3 data-id="heading-8">3. å…³é”®æŠ€æœ¯ï¼šReact 19 å¦‚ä½•è¿½è¸ªèµ„æºä¾èµ–ï¼Ÿ</h3>
<p>Suspense åŸç”Ÿåè°ƒçš„æ ¸å¿ƒæŠ€æœ¯æ”¯æ’‘ï¼Œæ˜¯ React 19 å¯¹ <code>use()</code> Hook çš„å¢å¼ºå’Œâ€œèµ„æºä¾èµ–è¿½è¸ªæœºåˆ¶â€ï¼š</p>
<ul>
<li><strong>use() å¢å¼º</strong>ï¼šReact 19 ä¸­çš„ use() ä¸ä»…èƒ½æ¶ˆè´¹å•ä¸ª Promiseï¼Œè¿˜èƒ½å°†å…¶å¯¹åº”çš„èµ„æºæ³¨å†Œåˆ°æœ€è¿‘çš„ Suspense ç»„ä»¶ä¸­ï¼Œè®© Suspense æ„ŸçŸ¥åˆ°è¿™ä¸ªèµ„æºçš„å­˜åœ¨ï¼›</li>
<li><strong>ä¾èµ–è¿½è¸ª</strong>ï¼šReact ä¼šåœ¨ç»„ä»¶æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡â€œä¸Šä¸‹æ–‡â€è®°å½•å½“å‰ Suspense ç»„ä»¶ä¸èµ„æºçš„å¯¹åº”å…³ç³»ï¼Œå½¢æˆä¸€ä¸ªâ€œèµ„æºä¾èµ–æ ‘â€ã€‚å½“èµ„æºçŠ¶æ€å˜åŒ–æ—¶ï¼ŒReact èƒ½é€šè¿‡è¿™ä¸ªæ ‘å¿«é€Ÿå®šä½åˆ°å¯¹åº”çš„ Suspense ç»„ä»¶ï¼Œè§¦å‘é‡æ–°åè°ƒã€‚</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼ŒReact 19 è®© Suspense å’Œ use() å½¢æˆäº†â€œçˆ¶å­å…³ç³»â€ï¼šSuspense æ˜¯â€œåè°ƒå™¨â€ï¼Œuse() æ¶ˆè´¹çš„èµ„æºæ˜¯â€œè¢«åè°ƒçš„å­èŠ‚ç‚¹â€ï¼Œåè°ƒå™¨ç»Ÿä¸€ç®¡ç†æ‰€æœ‰å­èŠ‚ç‚¹çš„åŠ è½½çŠ¶æ€ã€‚</p>
<h2 data-id="heading-9">ä¸‰ã€å®æˆ˜æ¼”ç»ƒï¼š4 ä¸ªé«˜é¢‘åœºæ™¯ç©è½¬ Suspense åŸç”Ÿåè°ƒ</h2>
<p>ç†è§£äº†æ ¸å¿ƒåŸç†åï¼Œæˆ‘ä»¬é€šè¿‡ 4 ä¸ªçœŸå®ä¸šåŠ¡åœºæ™¯ï¼Œçœ‹çœ‹ React 19 Suspense åŸç”Ÿåè°ƒå¦‚ä½•è½åœ°ã€‚æ‰€æœ‰æ¡ˆä¾‹éƒ½åŸºäºâ€œuse() + Suspense + ErrorBoundaryâ€çš„ç»„åˆï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†ä»»ä½•åŠ è½½çŠ¶æ€ã€‚</p>
<h3 data-id="heading-10">åœºæ™¯ 1ï¼šå¤šèµ„æºå¹¶è¡ŒåŠ è½½ï¼ˆåŸºç¡€ç”¨æ³•ï¼‰</h3>
<p>éœ€æ±‚ï¼šåŒæ—¶åŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€å’Œâ€œè®¢å•åˆ—è¡¨â€ï¼Œå…¨éƒ¨åŠ è½½å®Œæˆåå±•ç¤ºé¡µé¢ï¼Œç»Ÿä¸€æ˜¾ç¤º loadingï¼Œé”™è¯¯ç»Ÿä¸€æ•è·ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19ï¼šSuspense åŸç”Ÿåè°ƒå®ç°å¤šèµ„æºå¹¶è¡ŒåŠ è½½</span>
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// 1. å®šä¹‰å¼‚æ­¥è¯·æ±‚å‡½æ•°ï¼ˆè¿”å› Promiseï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user'</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç”¨æˆ·ä¿¡æ¯åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/orders'</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è®¢å•åˆ—è¡¨åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-comment">// 2. å­ç»„ä»¶ï¼šåˆ†åˆ«ä½¿ç”¨ use() æ¶ˆè´¹èµ„æº</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserInfo</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchUser</span>()); <span class="hljs-comment">// æ¶ˆè´¹ç”¨æˆ·èµ„æº</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„ä»ªè¡¨ç›˜<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span>;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>()); <span class="hljs-comment">// æ¶ˆè´¹è®¢å•èµ„æº</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æˆ‘çš„è®¢å•<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {orders.map((order) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{order.id}</span>&gt;</span>{order.title} - ï¿¥{order.amount}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 3. ErrorBoundary ç»„ä»¶ï¼ˆç»Ÿä¸€æ•è·é”™è¯¯ï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">React.Component</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-variable language_">super</span>(props);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> };
  }

  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getDerivedStateFromError</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span>, error };
  }

  <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>.<span class="hljs-property">hasError</span>) {
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½å¤±è´¥ï¼š{this.state.error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">props</span>.<span class="hljs-property">children</span>;
  }
}

<span class="hljs-comment">// 4. çˆ¶ç»„ä»¶ï¼šç”¨ Suspense åŒ…è£¹æ‰€æœ‰å­ç»„ä»¶ï¼Œå®ç°åŸç”Ÿåè°ƒ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserDashboard</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">UserInfo</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ ¸å¿ƒç®€åŒ–ç‚¹ï¼š</p>
<ul>
<li>å»æ‰äº†æ‰€æœ‰æ‰‹åŠ¨ç®¡ç†çš„ loadingã€errorã€æ•°æ®çŠ¶æ€ï¼›</li>
<li>æ— éœ€ç”¨ Promise.all åè°ƒå¹¶è¡Œèµ„æºï¼ŒSuspense ä¼šè‡ªåŠ¨æ”¶é›† UserInfo å’Œ OrderList ä¸­çš„ä¸¤ä¸ªèµ„æºï¼Œå¹¶è¡ŒåŠ è½½ï¼›</li>
<li>åŠ è½½çŠ¶æ€å’Œé”™è¯¯çŠ¶æ€åˆ†åˆ«ç”± Suspense å’Œ ErrorBoundary ç»Ÿä¸€å¤„ç†ï¼Œä»£ç é€»è¾‘æåº¦ç®€æ´ã€‚</li>
</ul>
<h3 data-id="heading-11">åœºæ™¯ 2ï¼šä¾èµ–èµ„æºä¸²è¡ŒåŠ è½½ï¼ˆé€šè¿‡åµŒå¥— Suspense å®ç°ï¼‰</h3>
<p>éœ€æ±‚ï¼šå…ˆåŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€ï¼ˆè·å– user.idï¼‰ï¼Œå†æ ¹æ® user.id åŠ è½½â€œè®¢å•åˆ—è¡¨â€ï¼Œæœ€åæ ¹æ® order.id åŠ è½½â€œè®¢å•è¯¦æƒ…â€ï¼Œä¸²è¡Œæ‰§è¡Œï¼Œç»Ÿä¸€æ˜¾ç¤º loadingã€‚</p>
<p>å®ç°æ€è·¯ï¼šåˆ©ç”¨ <strong>åµŒå¥— Suspense</strong> å®ç°ä¸²è¡ŒåŠ è½½ã€‚å› ä¸ºå†…å±‚ Suspense ä¼šç­‰å¾…å¤–å±‚ Suspense ä¸­çš„èµ„æºåŠ è½½å®Œæˆåï¼Œæ‰ä¼šæ¸²æŸ“è‡ªèº«å†…å®¹ï¼Œä»è€Œè§¦å‘å†…å±‚èµ„æºçš„åŠ è½½ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19ï¼šåµŒå¥— Suspense å®ç°ä¸²è¡Œèµ„æºåŠ è½½</span>
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// å¼‚æ­¥è¯·æ±‚å‡½æ•°ï¼ˆè®¢å•å’Œè¯¦æƒ…ä¾èµ–å‰åºèµ„æºçš„ IDï¼‰</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/user'</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç”¨æˆ·ä¿¡æ¯åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params">userId</span>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/orders?userId=<span class="hljs-subst">${userId}</span>`</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è®¢å•åˆ—è¡¨åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrderDetail</span>(<span class="hljs-params">orderId</span>) {
  <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/orders/<span class="hljs-subst">${orderId}</span>/detail`</span>);
  <span class="hljs-keyword">if</span> (!res.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'è®¢å•è¯¦æƒ…åŠ è½½å¤±è´¥'</span>);
  <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>();
}

<span class="hljs-comment">// å­ç»„ä»¶ 1ï¼šåŠ è½½ç”¨æˆ·ä¿¡æ¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">User</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchUser</span>());
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„è®¢å•è¯¦æƒ…<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•åˆ—è¡¨ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{user.id}</span> /&gt;</span> {/* ä¼ å…¥ user.id ç»™ä¸‹ä¸€å±‚ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å­ç»„ä»¶ 2ï¼šåŠ è½½è®¢å•åˆ—è¡¨ï¼ˆä¾èµ– user.idï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>(userId));
  <span class="hljs-keyword">const</span> firstOrder = orders[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰è®¢å•ï¼š{firstOrder.id}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•è¯¦æƒ…ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderDetail</span> <span class="hljs-attr">orderId</span>=<span class="hljs-string">{firstOrder.id}</span> /&gt;</span> {/* ä¼ å…¥ order.id ç»™ä¸‹ä¸€å±‚ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// å­ç»„ä»¶ 3ï¼šåŠ è½½è®¢å•è¯¦æƒ…ï¼ˆä¾èµ– order.idï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderDetail</span>(<span class="hljs-params">{ orderId }</span>) {
  <span class="hljs-keyword">const</span> detail = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrderDetail</span>(orderId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å•†å“ï¼š{detail.goodsName}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é‡‘é¢ï¼šï¿¥{detail.amount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>çŠ¶æ€ï¼š{detail.status}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// çˆ¶ç»„ä»¶ï¼šæœ€å¤–å±‚ Suspense ç»Ÿä¸€ç®¡ç†æ•´ä½“åŠ è½½çŠ¶æ€</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderDetailPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>æ•´ä½“åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">User</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ul>
<li>å¤–å±‚ Suspense åŒ…è£¹ User ç»„ä»¶ï¼Œç­‰å¾… fetchUser å®Œæˆï¼›</li>
<li>User ç»„ä»¶åŠ è½½å®Œæˆåï¼Œæ¸²æŸ“å†…å±‚ Suspense å’Œ OrderList ç»„ä»¶ï¼Œè§¦å‘ fetchOrdersï¼ˆä¾èµ– user.idï¼‰ï¼›</li>
<li>OrderList ç»„ä»¶åŠ è½½å®Œæˆåï¼Œæ¸²æŸ“æœ€å†…å±‚ Suspense å’Œ OrderDetail ç»„ä»¶ï¼Œè§¦å‘ fetchOrderDetailï¼ˆä¾èµ– order.idï¼‰ï¼›</li>
<li>æ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œæœ€å¤–å±‚ Suspense ä¼šæ˜¾ç¤ºæ•´ä½“ loadingï¼Œä¹Ÿå¯ä»¥ä¸ºæ¯ä¸€å±‚è®¾ç½®å•ç‹¬çš„ fallbackï¼Œå®ç°æ›´ç²¾ç»†çš„åŠ è½½çŠ¶æ€å±•ç¤ºã€‚</li>
</ul>
<h3 data-id="heading-12">åœºæ™¯ 3ï¼šæ··åˆåŠ è½½ç­–ç•¥ï¼ˆéƒ¨åˆ†å¹¶è¡Œ + éƒ¨åˆ†ä¸²è¡Œï¼‰</h3>
<p>éœ€æ±‚ï¼šåŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€åï¼Œå¹¶è¡ŒåŠ è½½â€œè®¢å•åˆ—è¡¨â€å’Œâ€œç”¨æˆ·æ”¶è—â€ï¼Œæœ€ååŠ è½½â€œè®¢å•è¯¦æƒ…â€ã€‚å³ï¼šä¸²è¡Œï¼ˆç”¨æˆ·ï¼‰â†’ å¹¶è¡Œï¼ˆè®¢å•+æ”¶è—ï¼‰â†’ ä¸²è¡Œï¼ˆè¯¦æƒ…ï¼‰ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19ï¼šæ··åˆåŠ è½½ç­–ç•¥ï¼ˆä¸²è¡Œ+å¹¶è¡Œï¼‰</span>
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// å¼‚æ­¥è¯·æ±‚å‡½æ•°</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params">userId</span>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchCollections</span>(<span class="hljs-params">userId</span>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrderDetail</span>(<span class="hljs-params">orderId</span>) { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-comment">// å¹¶è¡ŒåŠ è½½è®¢å•å’Œæ”¶è—çš„ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderAndCollection</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ä¸¤ä¸ªç»„ä»¶å¹¶è¡ŒåŠ è½½ï¼Œç”±å†…å±‚ Suspense åè°ƒ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{userId}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">CollectionList</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{userId}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// è®¢å•åˆ—è¡¨ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>(userId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æˆ‘çš„è®¢å•<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>{orders.map(o =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{o.id}</span>&gt;</span>{o.title}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// æ”¶è—åˆ—è¡¨ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">CollectionList</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> collections = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchCollections</span>(userId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>æˆ‘çš„æ”¶è—<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>{collections.map(c =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{c.id}</span>&gt;</span>{c.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// è®¢å•è¯¦æƒ…ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderDetail</span>(<span class="hljs-params">{ orderId }</span>) {
  <span class="hljs-keyword">const</span> detail = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrderDetail</span>(orderId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>è®¢å•è¯¦æƒ…<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å•†å“ï¼š{detail.goodsName}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// çˆ¶ç»„ä»¶ï¼šé€šè¿‡åµŒå¥— Suspense å®ç°æ··åˆç­–ç•¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">MixedLoadPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½ç”¨æˆ·ä¿¡æ¯ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">UserWrapper</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserWrapper</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchUser</span>());
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„ä¸ªäººä¸­å¿ƒ<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      {/* å¹¶è¡ŒåŠ è½½è®¢å•å’Œæ”¶è— */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•å’Œæ”¶è—ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderAndCollection</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{user.id}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
      {/* åŠ è½½è®¢å•è¯¦æƒ…ï¼ˆä¾èµ–è®¢å•åˆ—è¡¨ï¼‰ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•è¯¦æƒ…ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">OrderDetail</span> <span class="hljs-attr">orderId</span>=<span class="hljs-string">"123"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ ¸å¿ƒæ€è·¯ï¼šé€šè¿‡â€œä¸åŒå±‚çº§çš„ Suspense åŒ…è£¹ä¸åŒçš„èµ„æºç»„åˆâ€ï¼Œå®ç°æ··åˆåŠ è½½ç­–ç•¥ã€‚å¤–å±‚ Suspense ç®¡ç†ä¸²è¡Œç¯èŠ‚ï¼Œå†…å±‚ Suspense ç®¡ç†å¹¶è¡Œç¯èŠ‚ï¼Œé€»è¾‘æ¸…æ™°ï¼Œå¯æ‰©å±•æ€§å¼ºã€‚</p>
<h3 data-id="heading-13">åœºæ™¯ 4ï¼šåŠ¨æ€èµ„æºåŠ è½½ï¼ˆæ ¹æ®ç”¨æˆ·æ“ä½œåŠ è½½èµ„æºï¼‰</h3>
<p>éœ€æ±‚ï¼šé¡µé¢åˆå§‹åªåŠ è½½â€œç”¨æˆ·ä¿¡æ¯â€ï¼Œç”¨æˆ·ç‚¹å‡»â€œæŸ¥çœ‹è®¢å•â€æŒ‰é’®åï¼Œå†åŠ è½½â€œè®¢å•åˆ—è¡¨â€ï¼Œç‚¹å‡»æŒ‰é’®æ—¶æ˜¾ç¤º loadingã€‚</p>
<p>å®ç°æ€è·¯ï¼šç”¨ useState æ§åˆ¶åŠ¨æ€èµ„æºçš„åŠ è½½æ—¶æœºï¼Œåªæœ‰å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼Œæ‰æ¸²æŸ“ä¾èµ–è®¢å•èµ„æºçš„ç»„ä»¶ï¼ŒSuspense ä¼šè‡ªåŠ¨æ•è·è¿™ä¸ªåŠ¨æ€åŠ è½½çš„èµ„æºã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// React 19ï¼šåŠ¨æ€èµ„æºåŠ è½½ï¼ˆç”¨æˆ·æ“ä½œè§¦å‘ï¼‰</span>
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span>, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* ... */</span> }
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchOrders</span>(<span class="hljs-params">userId</span>) { <span class="hljs-comment">/* ... */</span> }

<span class="hljs-comment">// è®¢å•åˆ—è¡¨ç»„ä»¶ï¼ˆåŠ¨æ€åŠ è½½ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>(userId));
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
      {orders.map(o =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{o.id}</span>&gt;</span>{o.title} - ï¿¥{o.amount}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchUser</span>());
  <span class="hljs-keyword">const</span> [showOrders, setShowOrders] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>); <span class="hljs-comment">// æ§åˆ¶æ˜¯å¦åŠ è½½è®¢å•</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name} çš„é¡µé¢<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowOrders(true)}&gt;æŸ¥çœ‹è®¢å•<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* åŠ¨æ€åŠ è½½è®¢å•èµ„æºï¼šåªæœ‰ showOrders ä¸º true æ—¶æ‰æ¸²æŸ“ */}
      {showOrders &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½è®¢å•ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">OrderList</span> <span class="hljs-attr">userId</span>=<span class="hljs-string">{user.id}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// çˆ¶ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">DynamicLoadPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ è½½ç”¨æˆ·ä¿¡æ¯ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">UserPage</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}
</code></pre>
<p>æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ul>
<li>åˆå§‹çŠ¶æ€ä¸‹ï¼ŒshowOrders ä¸º falseï¼ŒOrderList ç»„ä»¶ä¸æ¸²æŸ“ï¼ŒfetchOrders ä¸ä¼šè¢«è§¦å‘ï¼›</li>
<li>ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼ŒshowOrders å˜ä¸º trueï¼ŒOrderList ç»„ä»¶æ¸²æŸ“ï¼Œuse(fetchOrders()) è§¦å‘è¯·æ±‚ï¼›</li>
<li>Suspense æ•è· fetchOrders çš„åŠ è½½çŠ¶æ€ï¼Œæ˜¾ç¤º fallbackï¼ŒåŠ è½½å®Œæˆåå±•ç¤ºè®¢å•åˆ—è¡¨ã€‚</li>
</ul>
<h2 data-id="heading-14">å››ã€é¿å‘æŒ‡å—ï¼šä½¿ç”¨ Suspense åŸç”Ÿåè°ƒçš„ 6 ä¸ªå…³é”®æ³¨æ„ç‚¹</h2>
<p>åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæœ‰å‡ ä¸ªå®¹æ˜“è¸©å‘çš„ç‚¹ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œé¿å…å‡ºç°çŠ¶æ€æ··ä¹±æˆ–æ€§èƒ½é—®é¢˜ã€‚</p>
<h3 data-id="heading-15">1. å¿…é¡»é…åˆ use() æ¶ˆè´¹èµ„æº</h3>
<p>Suspense åŸç”Ÿåè°ƒåªèƒ½æ„ŸçŸ¥é€šè¿‡ <code>use()</code> æ¶ˆè´¹çš„å¼‚æ­¥èµ„æºï¼ˆæˆ–é€šè¿‡ <code>React.lazy</code> åŠ è½½çš„ç»„ä»¶ï¼‰ã€‚å¦‚æœç›´æ¥åœ¨ç»„ä»¶ä¸­ç”¨ Promise.then å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼ŒSuspense æ— æ³•æ•è·å…¶çŠ¶æ€ï¼Œæ— æ³•è¿›è¡Œåè°ƒã€‚</p>
<p>é”™è¯¯ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// é”™è¯¯ï¼šç›´æ¥ç”¨ Promise.thenï¼ŒSuspense æ— æ³•æ„ŸçŸ¥</span>
function <span class="hljs-built_in">OrderList</span>() {
  const <span class="hljs-selector-attr">[orders, setOrders]</span> = <span class="hljs-built_in">useState</span>(null);
  <span class="hljs-built_in">useEffect</span>(() =&gt; {
    <span class="hljs-built_in">fetchOrders</span>()<span class="hljs-selector-class">.then</span>(setOrders);
  }, <span class="hljs-selector-attr">[]</span>);
  return &lt;<span class="hljs-selector-tag">ul</span>&gt;{orders<span class="hljs-selector-class">.map</span>(o =&gt; &amp;lt;li key={o.id}&amp;gt;{o.title}&amp;lt;/li&amp;gt;)}&amp;lt;/<span class="hljs-selector-tag">ul</span>&amp;gt;;
}
</code></pre>
<p>æ­£ç¡®ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ­£ç¡®ï¼šç”¨ use() æ¶ˆè´¹èµ„æºï¼ŒSuspense å¯æ„ŸçŸ¥</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">OrderList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> orders = <span class="hljs-title function_">use</span>(<span class="hljs-title function_">fetchOrders</span>());
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>{orders.map(o =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{o.id}</span>&gt;</span>{o.title}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>)}<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-16">2. é”™è¯¯å¿…é¡»ç”¨ ErrorBoundary æ•è·</h3>
<p>Suspense åªå¤„ç†â€œåŠ è½½ä¸­â€çŠ¶æ€ï¼Œä¸å¤„ç†â€œåŠ è½½å¤±è´¥â€çŠ¶æ€ã€‚å¦‚æœä»»ä½•ä¸€ä¸ªèµ„æºåŠ è½½å¤±è´¥ï¼Œä¼šæŠ›å‡ºé”™è¯¯ï¼Œå¿…é¡»ç”¨ ErrorBoundary ç»„ä»¶æ•è·ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ•´ä¸ªåº”ç”¨å´©æºƒã€‚</p>
<h3 data-id="heading-17">3. åµŒå¥— Suspense çš„ fallback ä¼˜å…ˆçº§</h3>
<p>å½“å­˜åœ¨åµŒå¥— Suspense æ—¶ï¼Œ<strong>å†…å±‚ Suspense çš„ fallback ä¼šè¦†ç›–å¤–å±‚çš„ fallback</strong>ã€‚å¦‚æœéœ€è¦æ˜¾ç¤ºæ•´ä½“åŠ è½½çŠ¶æ€ï¼Œå¯ä»¥åœ¨æœ€å¤–å±‚è®¾ç½®ä¸€ä¸ªå…¨å±€ fallbackï¼Œå†…å±‚è®¾ç½®å±€éƒ¨ fallbackï¼Œå®ç°åˆ†å±‚åŠ è½½æç¤ºã€‚</p>
<h3 data-id="heading-18">4. é¿å…è¿‡åº¦åµŒå¥— Suspense</h3>
<p>è™½ç„¶åµŒå¥— Suspense å¯ä»¥å®ç°å¤æ‚çš„åŠ è½½ç­–ç•¥ï¼Œä½†è¿‡åº¦åµŒå¥—ä¼šå¢åŠ  React çš„åè°ƒæˆæœ¬ï¼Œå½±å“æ€§èƒ½ã€‚å»ºè®®æ ¹æ®å®é™…éœ€æ±‚ï¼Œåˆç†åˆ’åˆ† Suspense çš„å±‚çº§ï¼Œé¿å…ä¸å¿…è¦çš„åµŒå¥—ã€‚</p>
<h3 data-id="heading-19">5. åŠ¨æ€èµ„æºåŠ è½½çš„çŠ¶æ€é‡ç½®</h3>
<p>å½“åŠ¨æ€åŠ è½½çš„èµ„æºï¼ˆå¦‚åœºæ™¯ 4 ä¸­çš„è®¢å•åˆ—è¡¨ï¼‰éœ€è¦é‡æ–°åŠ è½½æ—¶ï¼ˆæ¯”å¦‚ç”¨æˆ·åˆ‡æ¢äº†ç”¨æˆ· IDï¼‰ï¼Œåªéœ€ä¿®æ”¹èµ„æºä¾èµ–çš„å‚æ•°ï¼ˆå¦‚ userIdï¼‰ï¼ŒSuspense ä¼šè‡ªåŠ¨é‡æ–°åè°ƒï¼Œè§¦å‘æ–°çš„è¯·æ±‚ï¼Œæ— éœ€æ‰‹åŠ¨é‡ç½®çŠ¶æ€ã€‚</p>
<h3 data-id="heading-20">6. ä¸æ”¯æŒåŒæ­¥èµ„æºçš„åè°ƒ</h3>
<p>Suspense åŸç”Ÿåè°ƒåªé’ˆå¯¹â€œå¼‚æ­¥èµ„æºâ€ï¼ˆè¿”å› Promise çš„èµ„æºï¼‰ã€‚å¦‚æœèµ„æºæ˜¯åŒæ­¥çš„ï¼ˆå¦‚ç›´æ¥å¯¼å…¥çš„é™æ€æ•°æ®ï¼‰ï¼ŒSuspense ä¸ä¼šå¯¹å…¶è¿›è¡Œåè°ƒï¼Œä¼šç›´æ¥æ¸²æŸ“å†…å®¹ã€‚</p>
<h2 data-id="heading-21">äº”ã€æ ¸å¿ƒæ€»ç»“</h2>
<p>ä»Šå¤©æˆ‘ä»¬è¯¦ç»†æ‹†è§£äº† React 19 Suspense åŸç”Ÿåè°ƒçš„æ ¸å¿ƒåŸç†å’Œå®æˆ˜ç”¨æ³•ï¼Œæ ¸å¿ƒè¦ç‚¹æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ol start="4">
<li>
<p><strong>æ ¸å¿ƒä»·å€¼</strong>ï¼šSuspense ä»â€œå•ä¸ªèµ„æºåŠ è½½å®¹å™¨â€å‡çº§ä¸ºâ€œå¤šèµ„æºåè°ƒå™¨â€ï¼Œè‡ªåŠ¨æ„ŸçŸ¥å¹¶åè°ƒå¤šä¸ªå¼‚æ­¥èµ„æºçš„åŠ è½½çŠ¶æ€ï¼Œæ”¯æŒå¹¶è¡Œã€ä¸²è¡Œã€æ··åˆç­‰å¤šç§åŠ è½½ç­–ç•¥ï¼Œå½»åº•æ¶ˆé™¤èµ„æºåŠ è½½çš„æ¨¡æ¿ä»£ç ï¼›</p>
</li>
<li>
<p><strong>æ ¸å¿ƒåŸç†</strong>ï¼šé€šè¿‡â€œèµ„æºæ”¶é›†-åŠ è½½åè°ƒ-çŠ¶æ€ç»Ÿä¸€â€ä¸‰æ­¥æµç¨‹ï¼Œç»“åˆ use() çš„å¢å¼ºå’Œèµ„æºä¾èµ–è¿½è¸ªæœºåˆ¶ï¼Œå®ç°å¤šèµ„æºçš„è‡ªåŠ¨åè°ƒï¼›</p>
</li>
<li>
<p><strong>å®æˆ˜å…³é”®</strong>ï¼š</p>
<ol>
<li>å¹¶è¡ŒåŠ è½½ï¼šç”¨ä¸€ä¸ª Suspense åŒ…è£¹æ‰€æœ‰èµ„æºç»„ä»¶ï¼›</li>
<li>ä¸²è¡ŒåŠ è½½ï¼šç”¨åµŒå¥— Suspense æŒ‰ä¾èµ–é¡ºåºåŒ…è£¹ç»„ä»¶ï¼›</li>
<li>åŠ¨æ€åŠ è½½ï¼šç”¨çŠ¶æ€æ§åˆ¶èµ„æºç»„ä»¶çš„æ¸²æŸ“æ—¶æœºï¼›</li>
<li>é”™è¯¯å¤„ç†ï¼šå¿…é¡»é…åˆ ErrorBoundary ç»Ÿä¸€æ•è·é”™è¯¯ã€‚</li>
</ol>
</li>
<li>
<p><strong>é¿å‘è¦ç‚¹</strong>ï¼šå¿…é¡»ç”¨ use() æ¶ˆè´¹èµ„æºï¼Œé¿å…è¿‡åº¦åµŒå¥—ï¼Œé”™è¯¯å¤„ç†ä¸èƒ½å°‘ã€‚</p>
</li>
</ol>
<h2 data-id="heading-22">å…­ã€è¿›é˜¶å­¦ä¹ æ–¹å‘</h2>
<p>æŒæ¡äº† Suspense åŸç”Ÿåè°ƒçš„åŸºç¡€ç”¨æ³•åï¼Œå¯ä»¥è¿›ä¸€æ­¥å­¦ä¹ ä»¥ä¸‹å†…å®¹ï¼Œæ·±åŒ–ç†è§£ï¼š</p>
<ul>
<li>Suspense ä¸ React 19 Action çš„ååŒï¼šå¦‚ä½•ç”¨ Action å¤„ç†è¡¨å•æäº¤åçš„èµ„æºé‡æ–°åŠ è½½ï¼›</li>
<li>Suspense æœåŠ¡å™¨ç»„ä»¶ï¼ˆServer Componentsï¼‰çš„ç»“åˆï¼šåœ¨æœåŠ¡ç«¯æ¸²æŸ“åœºæ™¯ä¸‹å¦‚ä½•ä¼˜åŒ–èµ„æºåŠ è½½ï¼›</li>
<li>èµ„æºé¢„åŠ è½½ç­–ç•¥ï¼šå¦‚ä½•é€šè¿‡ preload ç­‰æ–¹å¼ä¼˜åŒ– Suspense çš„åŠ è½½ä½“éªŒï¼›</li>
<li>æºç é˜…è¯»ï¼šæŸ¥çœ‹ React 19 æºç ä¸­ Suspense åè°ƒå™¨çš„å®ç°ï¼ˆé‡ç‚¹çœ‹ react-reconciler åŒ…ä¸­çš„ Suspenseç›¸å…³é€»è¾‘ï¼‰ã€‚</li>
</ul>
<p>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—ã€è½¬å‘ï½ æœ‰ä»»ä½•é—®é¢˜ä¹Ÿå¯ä»¥åœ¨è¯„è®ºåŒºç•™è¨€äº¤æµï½ æˆ‘ä»¬ä¸‹æœŸå†è§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[InheritableThreadLocalä»å…¥é—¨åˆ°æ”¾å¼ƒ]]></title>    <link>https://juejin.cn/post/7595771085393100851</link>    <guid>https://juejin.cn/post/7595771085393100851</guid>    <pubDate>2026-01-16T07:37:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595771085393100851" data-draft-id="7595513077221031982" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="InheritableThreadLocalä»å…¥é—¨åˆ°æ”¾å¼ƒ"/> <meta itemprop="keywords" content="ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-16T07:37:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¬ä¸œäº‘å¼€å‘è€…"/> <meta itemprop="url" content="https://juejin.cn/user/2634854380340008"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            InheritableThreadLocalä»å…¥é—¨åˆ°æ”¾å¼ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2634854380340008/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¬ä¸œäº‘å¼€å‘è€…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T07:37:49.000Z" title="Fri Jan 16 2026 07:37:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šç”°è¶…è¾‰</p>
<h2 data-id="heading-0">èƒŒæ™¯ï¼š</h2>
<p>ä¸€ä¸ªä¸Šçº¿äº†å¾ˆä¹…ä½†æ˜¯è¯·æ±‚é‡å¾ˆä½(å¹³å‡æ¯å¤©ä¸€ä¸¤æ¬¡)çš„å†å²åŠŸèƒ½çªç„¶å‡ºç°ç©ºæŒ‡é’ˆæŠ¥é”™ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8380d11214154ca3aa1ede7eee0545aa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=lNRjruk4rpSlLh5PfSXQySnxpTw%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>æˆ‘ä»¬ç¿»å¼€ä»£ç å®šä½åˆ°å¯¹åº”çš„æŠ¥é”™ä»£ç ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4e753899bf0648b5b420f592accee9ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=CKX7XSnUlViROzcJ4fZ0BtOvDoc%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ç»“åˆå †æ ˆå’Œä»£ç å¯ä»¥ç¡®å®šæ˜¯ç”±äºbdIdJobMapçš„å€¼ä¸ºnullå¯¼è‡´å¾€bdIdEmployeeJobMapè¿™ä¸ªmapä¸­putAllçš„æ—¶å€™ç©ºæŒ‡é’ˆäº†ã€‚</p>
<p>è€ŒbdIdJobMapåˆå–è‡ªemployeeJobMapThread.get(); é‚£ä¹ˆè¿™ä¸ªemployeeJobMapThreadåˆæ˜¯ä½•ç‰©ï¼Ÿ</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7a90ab3d7ce7464ea281c7ec4c9c9482~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=mUEQtevsu7H%2Fvrz6fgm2xUXhSiw%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>å“¦è±ï¼ŒemployeeJobMapThreadå±…ç„¶æ˜¯ä¸ªInheritableThreadLocalã€‚</p>
<p>æ¢³ç†ä¸€ä¸‹æŠ¥é”™ä»£ç çš„ä¸Šä¸‹æ–‡é€»è¾‘å¦‚ä¸‹ï¼š</p>
<p>1.é¦–å…ˆåœ¨å½“å‰ä¸»çº¿ç¨‹ä¸­å¯¹InheritableThreadLocalç±»å‹å˜é‡employeeJobMapThreadè¿›è¡Œèµ‹å€¼</p>
<p>2.æŠŠè€—æ—¶æ“ä½œæäº¤åˆ°çº¿ç¨‹æ± ä¸­å¼‚æ­¥æ‰§è¡Œï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡ä¸­å»è·å–employeeJobMapThreadçš„å€¼ï¼ˆå…¶ä¸­çº¿ç¨‹æ± é…ç½®çš„coreSize/maxSizeå‡ä¸º4ï¼Œqueueå¤§å°ä¸º3000ï¼‰</p>
<p>3.åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡ŒemployeeJobMapThread.remove()ï¼Œåœ¨å¼‚æ­¥ä»»åŠ¡å®Œæˆä¹‹åæ²¡æœ‰æ‰§è¡ŒemployeeJobMapThread.remove()</p>
<p>4.æœ€ååœ¨å¼‚æ­¥ä»»åŠ¡ä¸­é€šè¿‡employeeJobMapThreadè·å–åˆ°çš„å€¼ä¸ºnullå¯¼è‡´åç»­æ“ä½œç©ºæŒ‡é’ˆ</p>
<p>ï»¿</p>
<h2 data-id="heading-1">æ˜¯å¦å’Œæœ€è¿‘çš„ä¸Šçº¿æœ‰å…³ï¼Ÿ</h2>
<p>ç›¸ä¿¡å¤§å®¶éƒ½æœ‰è¿™æ ·çš„å…±è¯†ï¼šçº¿ä¸Šå‡ºç°æŠ¥é”™ï¼Œé¦–å…ˆæ€€ç–‘æ˜¯å¦å’Œæœ€è¿‘çš„ä¸Šçº¿æœ‰å…³ç³»ã€‚</p>
<p>æˆ‘ä»¬åšçš„ç¬¬ä¸€ä»¶äº‹æƒ…ä¹Ÿæ˜¯æ’æŸ¥äº†è¿‘æœŸçš„ä¸Šçº¿åŠŸèƒ½ï¼Œä»ä¸Šçº¿çš„åŠŸèƒ½ç‚¹å’Œç›¸å…³ä»£ç ä¸Šæ¥çœ‹éƒ½å’Œè¿™æ¬¡æŠ¥é”™çš„ä»£ç æ²¡ä»€ä¹ˆå…³ç³»ï¼Œ</p>
<p>å› æ­¤åˆæ­¥æ’é™¤äº†è¿™ä¸ªåŸå› ã€‚æ‰€ä»¥æ¥ä¸‹æ¥åªèƒ½è¿›ä¸€æ­¥äº†è§£ä»£ç æ¥æ’æŸ¥åŸå› äº†ã€‚</p>
<p>è¦ææ¸…æ¥šå½“å‰æŠ¥é”™çš„æ ¹å› ï¼Œæ¯«æ— ç–‘é—®è‚¯å®šæ˜¯è¦ç¿»è¿‡InheritableThreadLocalè¿™åº§å°å±±å•¦ã€‚</p>
<p>ï»¿</p>
<h2 data-id="heading-2">ç®€å•èŠä¸‹InheritableThreadLocalï¼š</h2>
<p>æèµ·ThreadLocalï¼Œå¤§å®¶åº”è¯¥ç›¸å¯¹éƒ½æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œæ¯”å¦‚å­˜æ”¾ç™»å½•ç”¨æˆ·ä¿¡æ¯åˆ°ThreadLocalå˜é‡ä¸­ï¼Œç„¶ååœ¨æ¥å£å±‚å¯ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„è·å–ç™»å½•ç”¨æˆ·ï¼Œå¸®åŠ©å¼€å‘ææ•ˆã€‚</p>
<p>ä½†æ˜¯å¯¹äºInheritableThreadLocalï¼Œæœ‰ä¸å°‘åŒå­¦éƒ½ä¸å¤ªäº†è§£ã€‚</p>
<p>æŒ‘é‡ç‚¹æ¥è¯´ï¼ŒInheritableThreadLocalç›¸æ¯”ThreadLocalå¤šä¸€ä¸ªèƒ½åŠ›ï¼šåœ¨åˆ›å»ºå­çº¿ç¨‹Threadæ—¶ï¼Œå­çº¿ç¨‹Threadä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalä¿¡æ¯åˆ°å­çº¿ç¨‹ä¸­ï¼Œè¿›è€Œå®ç°åœ¨åœ¨å­çº¿ç¨‹è·å–çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼çš„ç›®çš„ã€‚</p>
<p>ä¸¾ä¸ªç®€å•çš„æ —å­å¯¹æ¯”ä¸‹InheritableThreadLocalå’ŒThreadLocalï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">InheritableThreadLocalTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final ThreadLocal&lt;String&gt; threadLocal = <span class="hljs-keyword">new</span> ThreadLocal&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final InheritableThreadLocal&lt;String&gt; inheritableThreadLocal = <span class="hljs-keyword">new</span> InheritableThreadLocal&lt;&gt;();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        testThreadLocal();
        testInheritableThreadLocal();
    }

    <span class="hljs-comment">/**
     * threadLocalæµ‹è¯•
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testThreadLocal</span>()</span> {
        <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®å€¼åˆ°threadLocal</span>
        threadLocal.<span class="hljs-keyword">set</span>(<span class="hljs-string">"æˆ‘æ˜¯çˆ¶çº¿ç¨‹threadLocalçš„å€¼"</span>);

        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å¹¶å¯åŠ¨</span>
        <span class="hljs-keyword">new</span> Thread(() -&gt; {
            <span class="hljs-comment">// åœ¨å­çº¿ç¨‹é‡Œé¢æ— æ³•è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„threadLocalï¼Œç»“æœä¸ºnull</span>
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ä»å­çº¿ç¨‹è·å–åˆ°threadLocalçš„å€¼: "</span> + threadLocal.<span class="hljs-keyword">get</span>());
        }).start();
    }

    <span class="hljs-comment">/**
     * inheritableThreadLocalæµ‹è¯•
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">testInheritableThreadLocal</span>()</span> {
        <span class="hljs-comment">// åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªå€¼åˆ°inheritableThreadLocal</span>
        inheritableThreadLocal.<span class="hljs-keyword">set</span>(<span class="hljs-string">"æˆ‘æ˜¯çˆ¶çº¿ç¨‹inheritableThreadLocalçš„å€¼"</span>);

        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å¹¶å¯åŠ¨</span>
        <span class="hljs-keyword">new</span> Thread(() -&gt; {
            <span class="hljs-comment">// åœ¨å­çº¿ç¨‹é‡Œé¢å¯ä»¥è‡ªåŠ¨è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocal</span>
            System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ä»å­çº¿ç¨‹è·å–åˆ°inheritableThreadLocalçš„å€¼: "</span> + inheritableThreadLocal.<span class="hljs-keyword">get</span>());
        }).start();
    }

}
</code></pre>
<p>æ‰§è¡Œç»“æœï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a27e0ced731d449a9422895fdee5fa21~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=1hL1sus%2FV6jSF6Bi1VeFiWZ6oN8%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>å¯ä»¥çœ‹åˆ°å­çº¿ç¨‹ä¸­å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼ï¼Œä½†ä¸èƒ½è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„threadLocalå€¼ã€‚</p>
<p>ä¸ºä»€ä¹ˆInheritableThreadLocalèƒ½å¤Ÿåšåˆ°è¿™ç‚¹å‘¢ï¼Ÿ</p>
<p>æ˜¯å› ä¸ºåœ¨çˆ¶çº¿ç¨‹åˆ›å»ºå­çº¿ç¨‹Threadçš„æ—¶å€™ï¼ŒThreadçš„æ„é€ å™¨å†…éƒ¨ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalåˆ°å­çº¿ç¨‹ã€‚</p>
<p>Threadæºç è¿™ä¸¤å¤„åœ°æ–¹è§£é‡Šäº†åŸå› ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/29640a537a864efba81c146cd6d4bdd9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=sBTcTh2NFsxVBa%2BbsOce6IVUnpM%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>initæ–¹æ³•å†…éƒ¨å®ç°ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/254227b472ae40ec981fd97a27d667d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=Oc8n%2FZtoMYleuxcPSS1t%2BhFN1BA%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ï»¿</p>
<p>é€šè¿‡è¿™ä¸ªç®€å•çš„ä»‹ç»å¯ä»¥å¸®åŠ©å¯¹äºInheritableThreadLocalä¸äº†è§£çš„åŒå­¦æœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ï¼Œæœ¬æ–‡ä¸æ˜¯ä¸“é—¨ä»‹ç»InheritableThreadLocalçš„æ·±å…¥åŸç†ï¼Œæ‰€ä»¥å°±ä¸å±•å¼€èŠäº†ï¼Œå¤§å®¶æ„Ÿå…´è¶£å¯ä»¥è‡ªå·±è¿›ä¸€æ­¥æ¢ç´¢ã€‚</p>
<h2 data-id="heading-3">éªŒè¯InheritableThreadLocal+çº¿ç¨‹æ± ï¼š</h2>
<p>å‰é¢ä»‹ç»äº†InheritableThreadLocalå¯ä»¥è‡ªåŠ¨æŠŠçˆ¶çº¿ç¨‹çš„InheritableThreadLocalä¿¡æ¯ç»§æ‰¿åˆ°å­çº¿ç¨‹Threadä¸­ã€‚</p>
<p>ä½†æ˜¯åœ¨ä¸šåŠ¡é¡¹ç›®ä¸­çœŸæ­£éœ€è¦ç”¨åˆ°å­çº¿ç¨‹çš„æ—¶å€™æ­£ç»äººè°è‡ªå·±new Threadï¼Œå’±å¯æ˜¯ç”¨çº¿ç¨‹æ± çš„ã€‚</p>
<p>å½“ç„¶äº†ï¼Œå°±åƒæ–‡ç« å¼€å¤´è¯´æ˜çš„ï¼Œè¿™æ¬¡æŠ¥é”™çš„ä»£ç é‡Œé¢ä¹Ÿç”¨çº¿ç¨‹æ± æ¥æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚</p>
<p>é‚£ä¹ˆInheritableThreadLocal+çº¿ç¨‹æ± çš„ç»„åˆä¼šæ‘©æ“¦å‡ºä»€ä¹ˆæ ·çš„ç«èŠ±å‘¢ï¼Ÿ</p>
<p>æˆ‘æŠŠè¿™æ¬¡æŠ¥é”™çš„ä»£ç ç²¾ç®€ä¹‹åå¾—åˆ°ä¸‹é¢çš„ç¤ºä¾‹ï¼ˆå®é™…ä»£ç ä¸­å¾€InheritableThreadLocalèµ‹çš„å€¼ç±»å‹ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œåé¢ä¼šæåˆ°ï¼‰ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.dada.bd.data.service;

<span class="hljs-keyword">import</span> java.util.concurrent.LinkedBlockingQueue;
<span class="hljs-keyword">import</span> java.util.concurrent.ThreadPoolExecutor;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritableThreadLocalWithThreadPoolTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> InheritableThreadLocal&lt;String&gt; inheritableThreadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InheritableThreadLocal</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">threadPoolExecutor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">2</span>,
            <span class="hljs-number">2</span>,
            <span class="hljs-number">0L</span>,
            TimeUnit.MILLISECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(<span class="hljs-number">3000</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy()
    );

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        testInheritableThreadLocalWithThreadPool();
        threadPoolExecutor.shutdown();
    }

    <span class="hljs-comment">/**
     * inheritableThreadLocal+çº¿ç¨‹æ± æµ‹è¯•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInheritableThreadLocalWithThreadPool</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// 1. åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªå€¼åˆ°inheritableThreadLocal</span>
        inheritableThreadLocal.set(<span class="hljs-string">"æˆ‘æ˜¯çˆ¶çº¿ç¨‹inheritableThreadLocalçš„å€¼"</span>);

        <span class="hljs-comment">// 2. æäº¤å¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
        threadPoolExecutor.execute(() -&gt; {
            <span class="hljs-comment">// 3. åœ¨çº¿ç¨‹æ± -å­çº¿ç¨‹é‡Œé¢å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå—ï¼Ÿ</span>
            System.out.println(<span class="hljs-string">"ä»çº¿ç¨‹æ± -å­çº¿ç¨‹è·å–åˆ°inheritableThreadLocalçš„å€¼: "</span> + inheritableThreadLocal.get());
        });

        <span class="hljs-comment">// 4. æ¸…é™¤inheritableThreadLocal</span>
        inheritableThreadLocal.remove();
    }

}
</code></pre>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65927ab9fd254ce889a230fadecc03c0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=JekI5yxB4la9CisD6N%2Bx4qZ5sII%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>æ‰§è¡Œç»“æœå¦‚å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°åœ¨çº¿ç¨‹æ± é‡Œé¢ä¹Ÿå¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æä¸‹InheritableThreadLocal+çº¿ç¨‹æ± çš„æ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d855bd2f3a949e08b221a9a2a80fd00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=PV28SF83kkUQRHLZEiefGOhyI3w%3D" alt="" loading="lazy"/></p>
<p>ï»¿</p>
<p>ä¹Ÿå°±è¯´åªæœ‰åœ¨ä»¥ä¸‹è¿™ä¸¤ä¸ªåœºæ™¯ä¸‹æ‰ä¼šç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalï¼š</p>
<p>1.çº¿ç¨‹æ± å½“å‰çº¿ç¨‹æ•° &lt; æ ¸å¿ƒçº¿ç¨‹æ•°</p>
<p>2.çº¿ç¨‹æ± å½“å‰çº¿ç¨‹æ•° &gt;= æ ¸å¿ƒçº¿ç¨‹æ•° &amp;&amp; é˜Ÿåˆ—å·²æ»¡ &amp;&amp; çº¿ç¨‹æ•° &lt; æœ€å¤§çº¿ç¨‹æ•°ï¼ˆæœ¬æ¬¡çº¿ä¸ŠæŠ¥é”™çš„ä»£ç ä½¿ç”¨çš„çº¿ç¨‹æ± è®¾ç½®çš„coreSizeå’ŒmaxSizeä¸€è‡´ï¼Œæ‰€ä»¥èµ°ä¸åˆ°è¯¥åœºæ™¯ï¼‰</p>
<p>å…¶ä»–æƒ…å†µéƒ½æ˜¯åœ¨å¤ç”¨çº¿ç¨‹æ± ç°æœ‰çš„Threadï¼Œè‡ªç„¶ä¹Ÿå°±ä¸ä¼šç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalã€‚</p>
<p>æˆ‘ä»¬æäº¤å¤šä¸ªå¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± æ¥éªŒè¯ä¸‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.dada.bd.data.service;

<span class="hljs-keyword">import</span> java.util.concurrent.LinkedBlockingQueue;
<span class="hljs-keyword">import</span> java.util.concurrent.ThreadPoolExecutor;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritableThreadLocalWithThreadPoolTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> InheritableThreadLocal&lt;String&gt; inheritableThreadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InheritableThreadLocal</span>&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">threadPoolExecutor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">2</span>,
            <span class="hljs-number">2</span>,
            <span class="hljs-number">0L</span>,
            TimeUnit.MILLISECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(<span class="hljs-number">3000</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy()
    );

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"å¼ ä¸‰"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"æå››"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"ç‹äº”"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"èµµå…­"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"å­™ä¸ƒ"</span>);
        threadPoolExecutor.shutdown();
    }

    <span class="hljs-comment">/**
     * inheritableThreadLocal+çº¿ç¨‹æ± æµ‹è¯•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInheritableThreadLocalWithThreadPool</span><span class="hljs-params">(String param)</span> {
        <span class="hljs-comment">// 1. åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªå€¼åˆ°inheritableThreadLocal</span>
        inheritableThreadLocal.set(param);

        <span class="hljs-comment">// 2. æäº¤å¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
        threadPoolExecutor.execute(() -&gt; {
            <span class="hljs-comment">// 3. åœ¨çº¿ç¨‹æ± -å­çº¿ç¨‹é‡Œé¢å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå—ï¼Ÿ</span>
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å: "</span> + Thread.currentThread().getName() + <span class="hljs-string">", çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼: "</span> + param + <span class="hljs-string">", å­çº¿ç¨‹è·å–åˆ°inheritableThreadLocalçš„å€¼: "</span> + inheritableThreadLocal.get());
        });

        <span class="hljs-comment">// 4. æ¸…é™¤inheritableThreadLocal</span>
        inheritableThreadLocal.remove();
    }

}
</code></pre>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5c89ea48a0e742979b98f8b6c0931014~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=9B1N%2F47SLWKdWmw0pLtTvQPkHlU%3D" alt="" loading="lazy"/></p>
<p>ï»¿</p>
<p>æ‰§è¡Œç»“æœç”¨è¡¨æ ¼å½¢å¼å±•ç¤ºå¦‚ä¸‹ï¼š</p>






























<table><thead><tr><th>æ­¥éª¤</th><th>ä½¿ç”¨çº¿ç¨‹æ± </th><th>ç»“æœè§£é‡Šè¯´æ˜</th></tr></thead><tbody><tr><td>æäº¤ç¬¬ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡å€¼ä¸ºã€å¼ ä¸‰ã€‘</td><td>åˆ›å»ºThreadï¼špool-1-thread-1</td><td>è‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼ã€å¼ ä¸‰ã€‘åˆ°pool-1-thread-1</td></tr><tr><td>æäº¤ç¬¬äºŒä¸ªå¼‚æ­¥ä»»åŠ¡å€¼ä¸ºã€æå››ã€‘</td><td>åˆ›å»ºThreadï¼špool-1-thread-2</td><td>è‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼ã€æå››ã€‘åˆ°pool-1-thread-2</td></tr><tr><td>æäº¤ç¬¬ä¸‰ä¸ªå¼‚æ­¥ä»»åŠ¡å€¼ä¸ºã€ç‹äº”ã€‘</td><td>å¤ç”¨Threadï¼špool-1-thread-1</td><td>æ²¡æœ‰è‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼ã€ç‹äº”ã€‘ï¼Œæ‰€ä»¥æ‹¿åˆ°äº†ç¬¬ä¸€ä¸ªä»»åŠ¡æäº¤æ—¶Threadç»§æ‰¿ä¸‹æ¥çš„å€¼ã€å¼ ä¸‰ã€‘</td></tr><tr><td>æäº¤ç¬¬å››ä¸ªå¼‚æ­¥ä»»åŠ¡å€¼ä¸ºã€èµµå…­ã€‘</td><td>å¤ç”¨Threadï¼špool-1-thread-2</td><td>æ²¡æœ‰è‡ªåŠ¨ç»§æ‰¿çˆ¶çº¿ç¨‹çš„InheritableThreadLocalå€¼ã€èµµå…­ã€‘ï¼Œæ‰€ä»¥æ‹¿åˆ°äº†ç¬¬ä¸€ä¸ªä»»åŠ¡æäº¤æ—¶Threadç»§æ‰¿ä¸‹æ¥çš„å€¼ã€æå››ã€‘</td></tr></tbody></table>
<p><strong>å¯ä»¥çœ‹åˆ°InheritableThreadLocal+çº¿ç¨‹æ± çš„ç»„åˆï¼Œä¼šé¢ä¸´InheritableThreadLocalæ±¡æŸ“çš„é—®é¢˜ï¼Œå³å¼‚æ­¥ä»»åŠ¡å¯èƒ½å–åˆ°å…¶ä»–çˆ¶çº¿ç¨‹è®¾ç½®çš„InheritableThreadLocalå€¼ã€‚</strong></p>
<p>æœ‰åŒå­¦ä¼šæåˆ°æˆ‘ä»¬ä¸æ˜¯åœ¨ä»£ç é‡Œé¢åŠ äº†inheritableThreadLocal.remove()æ¥æ¸…é™¤inheritableThreadLocalçš„å—ï¼Ÿä¸ºä»€ä¹ˆæ²¡æœ‰æ¸…é™¤æ‰å‘¢ï¼Ÿ</p>
<p>è¿™æ˜¯å› ä¸ºæ­¤æ—¶æˆ‘ä»¬æ¸…é™¤çš„åªæ˜¯çˆ¶çº¿ç¨‹çš„inheritableThreadLocalï¼Œè€Œæ²¡æœ‰æ¸…é™¤å­çº¿ç¨‹çš„inheritableThreadLocalçš„ç¼˜æ•…ã€‚</p>
<p>ï»¿</p>
<h2 data-id="heading-4">ä¸ºä»€ä¹ˆInheritableThreadLocalæ±¡æŸ“å¯¹çº¿ä¸Šæ²¡æœ‰äº§ç”Ÿå½±å“ï¼Ÿ</h2>
<p>æ—¢ç„¶InheritableThreadLocal+çº¿ç¨‹æ± çš„ç»„åˆï¼Œä¼šå­˜åœ¨InheritableThreadLocalæ±¡æŸ“çš„é—®é¢˜ï¼Œé‚£å²‚ä¸æ˜¯çº¿ä¸ŠæŠ¥é”™çš„è¿™æ®µä»£ç ä¹Ÿå­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Ÿ</p>
<p>å†æ¬¡æ£€æŸ¥ä»£ç ï¼Œç¡®è®¤å†å²ä»£ç çš„ç¡®å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œ</p>
<p>ä½†æ˜¯ï¼Œè¿™ä¸ªä»£ç ä¸Šçº¿2å¹´å¤šä¸ºå•¥ä¸€ç›´ç¨³å®šè¿è¡Œä¸”æ²¡æœ‰ç”¨æˆ·åé¦ˆè¿‡åŠŸèƒ½æœ‰é—®é¢˜ï¼Ÿåªæœ‰æœ€è¿‘çªç„¶å‡ºç°æŠ¥é”™ï¼Ÿä¸€æ—¶ä¹‹é—´è„‘è¢‹æ‡µæ‡µçš„ã€‚</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef1c66e8947748688c007ad7de5b3089~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=RWhvCgfynIz91Xgnmv8Ojil9hvE%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ä»”ç»†æ£€ä»£ç ä¹‹åå‘ç°ï¼š</p>
<p>è¿™æ®µä»£ç åœ¨çˆ¶å­çº¿ç¨‹ä¹‹é—´é€šè¿‡InheritableThreadLocalç±»å‹å˜é‡employeeJobMapThreadä¼ é€’çš„å€¼æ˜¯ã€å…¨é‡çš„&lt;äººå‘˜Id, è¯¥äººå‘˜åŸºæœ¬ä¿¡æ¯&gt;ç»“æ„çš„mapã€‘ï¼Œå¯ä»¥è¿‘ä¹çœ‹åšæ˜¯ä¸€ä¸ªä¸å˜çš„å¸¸é‡ï¼Œæ‰€ä»¥è™½ç„¶å¼‚æ­¥ä»»åŠ¡ä¼šæ‹¿åˆ°æ±¡æŸ“çš„æ•°æ®ï¼Œä¹Ÿæ˜¯æ­£å¸¸å¯ä»¥ç”¨çš„ï¼Œæ²¡æœ‰äº§ç”Ÿä¸šåŠ¡å½±å“ã€‚</p>
<p>è¿™ç§æ„Ÿè§‰æ€ä¹ˆè¯´å‘¢ï¼Œåªèƒ½è¯´æ„Ÿå¹å‰äººçš„æ™ºæ…§ï¼ŒæŠŠå‡ ä¹ä¸å¯èƒ½åšåˆ°äº†å¯èƒ½~</p>
<p>å¥½äº†ï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬è§£é‡Šäº†ä¸ºä»€ä¹ˆè¿™æ®µä»£ç ä¸Šçº¿è¿™ä¹ˆä¹…ä¸€ç›´æ²¡é—®é¢˜ï¼Œ<strong>å› ä¸ºä»£ç ç¡®å®æœ‰InheritableThreadLocalæ±¡æŸ“é—®é¢˜ï¼Œä½†è¢«æ±¡æŸ“äº†ä¹Ÿä¸å½±å“ä½¿ç”¨ã€‚ã€‚ã€‚æ‰€ä»¥ä»æœ€ç»ˆç»“æœæ¥çœ‹ç¡®å®å¯ä»¥æ­£å¸¸è¿è¡Œã€‚</strong></p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b1a0c1c64314867a7a181d04306b3fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=wI8FplIjVejiaiVxWKw%2FTxvOghc%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ï»¿</p>
<h2 data-id="heading-5">ä»€ä¹ˆåŸå› å¯¼è‡´å­çº¿ç¨‹è·å–åˆ°çš„InheritableThreadLocalå€¼æ˜¯nullï¼Ÿ</h2>
<p>ä½†æ˜¯ã€‚ã€‚ã€‚è¯´äº†è¿™ä¹ˆå¤šï¼Œè¿˜æ˜¯ä¸èƒ½è§£é‡Šä¸ºä»€ä¹ˆçº¿ä¸Šä»£ç è·å–åˆ°çš„inheritableThreadLocalå€¼ä¼šæ˜¯nullã€‚</p>
<p>1.éš¾é“çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼å¯èƒ½ä¼šæ˜¯nullï¼Ÿ</p>
<p>æ£€æŸ¥ä»£ç å‘ç°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalä¸å¯èƒ½ä¸ºnullï¼Œé¡¶å¤šä¼šæ˜¯ç©ºé›†åˆï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6a80e4335b56443fbc540d1c2c701d94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=OIHRC0xFlp8KPnfvg6yYLTj80TU%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ï»¿</p>
<p>2.éš¾é“æ˜¯çº¿ç¨‹æ± åˆ›å»ºä¹‹åé€šè¿‡prestartAllCoreThreadsåˆå§‹åŒ–äº†æ ¸å¿ƒçº¿ç¨‹ï¼Œåœ¨æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„æ—¶å€™ï¼Œéƒ½æ˜¯å¤ç”¨çš„å·²æœ‰çº¿ç¨‹å¯¼è‡´çš„ï¼Ÿ</p>
<p>æ£€æŸ¥äº†å¯¹åº”çº¿ç¨‹æ± çš„åˆå§‹åŒ–ä»£ç ï¼Œå‘ç°å¹¶æ²¡æœ‰åˆå§‹åŒ–æ ¸å¿ƒçº¿ç¨‹ï¼Œä¹Ÿæ’é™¤äº†è¿™ä¸ªå¯èƒ½ã€‚è€Œä¸”å¦‚æœçœŸçš„æ˜¯è¯¥åŸå› 22å¹´ä¸Šçº¿ä¹‹ååŠŸèƒ½ä¸€å®šæ˜¯æœ‰é—®é¢˜çš„ï¼Œå‰é¢è¯´è¿‡ï¼Œè¯¥åŠŸèƒ½ä¸Šçº¿ä¹‹åæ²¡äººåé¦ˆè¿‡å¼‚å¸¸ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥æ’é™¤è¯¥åŸå› ã€‚</p>
<p>ï»¿</p>
<p>â€¢è¯¥åŠŸèƒ½22å¹´ä¸Šçº¿ä¹‹é—´2å¹´å¤šä¸€ç›´æ²¡äººåé¦ˆï¼Œå¤§æ¦‚ç‡è¯¥åŠŸèƒ½ä¹‹å‰å¾ˆé•¿æ—¶é—´æ˜¯æ­£å¸¸çš„ï¼Œè¿‘æœŸç”±äºæŸä¸ªåŸå› å¯¼è‡´åŠŸèƒ½å¼‚å¸¸</p>
<p>â€¢è™½ç„¶å†å²ä»£ç çš„ç”¨æ³•å­˜åœ¨å­ä»»åŠ¡ä¸­è·å–åˆ°çš„InheritableThreadLocalè¢«æ±¡æŸ“çš„é—®é¢˜ï¼Œä½†æ˜¯è¢«æ±¡æŸ“çš„å€¼ä¹Ÿèƒ½ç”¨ï¼Œä¸å½±å“æ­£ç¡®æ€§</p>
<p>â€¢åªè¦çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹åˆå§‹åŒ–çš„æ—¶å€™ç»§æ‰¿äº†æ­£ç¡®çš„InheritableThreadLocalå€¼ï¼Œåç»­å°±ä¸ä¼šè¢«æ¸…é™¤æ‰ï¼Œä¹Ÿå°±å¯ä»¥æ­£å¸¸è¿è¡ŒåŠŸèƒ½</p>
<p>ä»è¿™äº›å·²çŸ¥çš„ä¿¡æ¯æ¥æ¨æ–­ï¼Œå¯ä»¥æ¨æ–­å‡ºè¿™æ®µå†å²ä»£ç å†™æ³•è™½ç„¶æœ‰éšæ‚£ï¼Œä½†æ˜¯ä¸æ˜¯å¼•å‘å½“å‰ç©ºæŒ‡é’ˆçš„çš„åŸå› ã€‚</p>
<p>3.å‰©ä¸‹çš„åªæœ‰ä¸€ç§å¯èƒ½ï¼š<strong>å­˜åœ¨çº¿ç¨‹æ± çš„å…±ç”¨ã€‚</strong></p>
<p><strong>åœ¨æ‰§è¡Œè¿™ä¸ªæŠ¥é”™çš„å¼‚æ­¥ä»»åŠ¡çš„æ—¶å€™ï¼Œå¤ç”¨äº†æŸä¸ªå·²æœ‰çš„çº¿ç¨‹Aï¼Œå¹¶ä¸”å½“æ—¶åˆ›å»ºè¯¥çº¿ç¨‹Açš„æ—¶å€™ï¼Œæ²¡æœ‰ç»§æ‰¿InheritableThreadLocalï¼Œè¿›è€Œå¯¼è‡´åé¢å¤ç”¨è¯¥çº¿ç¨‹çš„æ—¶å€™ï¼Œä»InheritableThreadLocalè·å–åˆ°çš„å€¼ä¸ºnullã€‚</strong></p>
<p><strong>è€Œåªè¦æ˜¯é€šè¿‡è¿™æ®µå†å²ä»£ç åˆ›å»ºçš„çº¿ç¨‹ä¸€å®šæ˜¯æ²¡é—®é¢˜çš„ï¼Œæ‰€ä»¥ä¸€å®šæ˜¯å­˜åœ¨å…¶ä»–ä¸šåŠ¡å…±ç”¨äº†è¿™ä¸ªçº¿ç¨‹æ± ï¼Œå¹¶ä¸”è¿™ä¸ªä¸šåŠ¡ä¼˜å…ˆæ‰§è¡Œè¿›è€Œåˆå§‹åŒ–äº†çº¿ç¨‹æ± çš„çº¿ç¨‹ï¼Œå¯¼è‡´çº¿ç¨‹æ± çš„çº¿ç¨‹æ²¡æœ‰ç»§æ‰¿InheritableThreadLocalã€‚</strong></p>
<p>å¦‚ä¸‹ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.dada.bd.data.service;

<span class="hljs-keyword">import</span> java.util.concurrent.LinkedBlockingQueue;
<span class="hljs-keyword">import</span> java.util.concurrent.ThreadPoolExecutor;
<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InheritableThreadLocalWithThreadPoolTest</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> InheritableThreadLocal&lt;String&gt; inheritableThreadLocal = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InheritableThreadLocal</span>&lt;&gt;();
    <span class="hljs-comment">// è¿™é‡Œçº¿ç¨‹æ± core/maxæ•°é‡éƒ½åªæœ‰2</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ThreadPoolExecutor</span> <span class="hljs-variable">threadPoolExecutor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>(
            <span class="hljs-number">2</span>,
            <span class="hljs-number">2</span>,
            <span class="hljs-number">0L</span>,
            TimeUnit.MILLISECONDS,
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedBlockingQueue</span>&lt;Runnable&gt;(<span class="hljs-number">3000</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.CallerRunsPolicy()
    );

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// å…ˆæ‰§è¡Œäº†ä¸æ¶‰åŠInheritableThreadLocalçš„å­ä»»åŠ¡åˆå§‹åŒ–çº¿ç¨‹æ± çº¿ç¨‹</span>
        testAnotherFunction();
        testAnotherFunction();
        <span class="hljs-comment">// åæ‰§è¡Œäº†æœ¬æ¬¡çš„å†å²ä»£ç ï¼Œå…¶æ¶‰åŠInheritableThreadLocal</span>
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"å¼ ä¸‰"</span>);
        testInheritableThreadLocalWithThreadPool(<span class="hljs-string">"æå››"</span>);
        threadPoolExecutor.shutdown();
    }

    <span class="hljs-comment">/**
     * inheritableThreadLocal+çº¿ç¨‹æ± æµ‹è¯•
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testInheritableThreadLocalWithThreadPool</span><span class="hljs-params">(String param)</span> {
        <span class="hljs-comment">// 1. åœ¨ä¸»çº¿ç¨‹ä¸­è®¾ç½®ä¸€ä¸ªå€¼åˆ°inheritableThreadLocal</span>
        inheritableThreadLocal.set(param);

        <span class="hljs-comment">// 2. æäº¤å¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
        threadPoolExecutor.execute(() -&gt; {
            <span class="hljs-comment">// 3. åœ¨çº¿ç¨‹æ± -å­çº¿ç¨‹é‡Œé¢å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå—ï¼Ÿ</span>
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å: "</span> + Thread.currentThread().getName() + <span class="hljs-string">", çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå€¼: "</span> + param + <span class="hljs-string">", å­çº¿ç¨‹è·å–åˆ°inheritableThreadLocalçš„å€¼: "</span> + inheritableThreadLocal.get());
        });

        <span class="hljs-comment">// 4. æ¸…é™¤inheritableThreadLocal</span>
        inheritableThreadLocal.remove();
    }

    <span class="hljs-comment">/**
     * æ¨¡æ‹Ÿå¦ä¸€ä¸ªç‹¬ç«‹çš„åŠŸèƒ½
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testAnotherFunction</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æäº¤å¼‚æ­¥ä»»åŠ¡åˆ°çº¿ç¨‹æ± </span>
        threadPoolExecutor.execute(() -&gt; {
            <span class="hljs-comment">// åœ¨çº¿ç¨‹æ± -å­çº¿ç¨‹é‡Œé¢å¯ä»¥è·å–åˆ°çˆ¶çº¿ç¨‹è®¾ç½®çš„inheritableThreadLocalå—ï¼Ÿ</span>
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å: "</span> + Thread.currentThread().getName() + <span class="hljs-string">", çº¿ç¨‹æ± -å­çº¿ç¨‹æ‘¸ä¸ªé±¼"</span>);
        });
    }

}
</code></pre>
<p>æ‰§è¡Œç»“æœï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dec173b5ceb94d0e9b2682e36554882a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=VKoOVd2tvXKIH2Rbfbr%2FMTM%2Bv%2B8%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>åœ¨é¡¹ç›®é‡Œé¢æœä¸€ä¸‹çœ‹çœ‹ï¼ŒæœçœŸå¦‚æ­¤ï¼Œæœ‰2å‡ºåœ°æ–¹åœ¨ç”¨è¿™ä¸ªçº¿ç¨‹æ± ï¼Œå¹¶ä¸”å¦å¤–çš„ä¸€å¤„ä»£ç ä¸­æäº¤çš„å¼‚æ­¥ä»»åŠ¡ä¸æ¶‰åŠinheritableThreadLocalï¼š</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1b7252364dd40c481b0e04bd6072312~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=371YiGglilqaZ8puW6D2WRpgPbQ%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p>
<p>é€»è¾‘æ‰§è¡Œé¡ºåºä¸ºï¼š<strong>åˆ›å»ºçº¿ç¨‹æ±  - æ‰§è¡ŒåŠŸèƒ½A - æ‰§è¡ŒåŠŸèƒ½A - æ‰§è¡ŒåŠŸèƒ½B</strong></p>
<p>å…¶ä¸­ï¼š</p>
<p>åŠŸèƒ½Aå…¨æµç¨‹å‡ä¸æ¶‰åŠInheritableThreadLocal</p>
<p>åŠŸèƒ½Bå¯¹åº”æŠ¥é”™çš„ä»£ç ï¼Œä¸»çº¿ç¨‹è®¾ç½®InheritableThreadLocalå¹¶ä¸”åœ¨å­çº¿ç¨‹ä½¿ç”¨</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f046ff6251fe43288c764d29f334b68e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=LU9oGqcE5yfyvlF9i%2FmxCc9UuK4%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>è‡³æ­¤ï¼Œçº¿ä¸ŠæŠ¥é”™çš„æ ¹å› ç¡®å®šäº†ï¼š<strong>å°±æ˜¯å› ä¸ºInheritableThreadLocal + çº¿ç¨‹æ± å…±ç”¨å¯¼è‡´ã€‚</strong></p>
<p>ï»¿</p>
<p>æ‰©å±•ä¸€ä¸‹ï¼š</p>
<p>å‡å¦‚æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·å‘¢ï¼š<strong>åˆ›å»ºçº¿ç¨‹æ±  - æ‰§è¡ŒåŠŸèƒ½B - æ‰§è¡ŒåŠŸèƒ½B - æ‰§è¡ŒåŠŸèƒ½A</strong></p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0d5962f26cae4b19a6f07e377fadf0b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=7SQpylxXpoblgFCyH5h4bOzgiTA%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p>ç»“å±€å±…ç„¶æ˜¯ä¸€åˆ‡å®‰å¥½ã€‚</p>
<p>ï»¿</p>
<p>å‡å¦‚æ‰§è¡Œé¡ºåºæ˜¯è¿™æ ·å‘¢ï¼š<strong>åˆ›å»ºçº¿ç¨‹æ±  - æ‰§è¡ŒåŠŸèƒ½B - æ‰§è¡ŒåŠŸèƒ½A - æ‰§è¡ŒåŠŸèƒ½B</strong></p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0fd8326d9c354a66a1a0bcc0f5cb14dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=R5vDd%2FKkFxDw9dabEwbESC%2BMlHM%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<p><strong>å‘ç°äº†å—ï¼Ÿå¦‚æœåº”ç”¨å¯åŠ¨ä¹‹ååŠŸèƒ½Bå…ˆæ‰§è¡Œå¹¶ä¸”åˆå§‹åŒ–äº†çº¿ç¨‹æ± æ‰€æœ‰æ ¸å¿ƒçº¿ç¨‹ï¼Œé‚£ä¹ˆä¸€åˆ‡æ­£å¸¸ï¼Œå¦åˆ™å°±å¯èƒ½æŠ¥é”™ã€‚</strong></p>
<p><strong>ä¹Ÿå°±æ˜¯è¯´åŠŸèƒ½Bæ˜¯å¦æ­£å¸¸è¿˜çœ‹è¿æ°”çš„ï¼Œè¿æ°”å¥½å°±æ­£å¸¸æ‰§è¡Œï¼Œè¿æ°”ä¸å¥½å°±æŠ¥ç©ºæŒ‡é’ˆçš„é”™ã€‚</strong></p>
<p>ï»¿</p>
<p>è¿™ä½ æ•¢ä¿¡ï¼Ÿ</p>
<p>ï»¿</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f53a48af60c44188eb202b8ef47b72a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lqs5Lic5LqR5byA5Y-R6ICF:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769153869&amp;x-signature=nxqA6HGHqejuSeVLmqFBwKKPDFg%3D" alt="" loading="lazy"/></p>
<p>ï»¿ï»¿</p>
<h2 data-id="heading-6">å°æ’æ›²ï¼š</h2>
<p>è¿™ä¸ªé—®é¢˜çš„æ’æŸ¥å½“ä¸­è¿˜é‡åˆ°äº†2ä¸ªå°æ’æ›²ï¼š</p>
<p>æ’æ›²1ï¼š</p>
<p>æœ€åˆæ€€ç–‘æ˜¯çº¿ç¨‹æ± å¤ç”¨å¯¼è‡´çš„ï¼Œä½†æ˜¯åœ¨IDEAé‡Œé¢æœä»£ç çš„æ—¶å€™ç²—å¿ƒå¤§æ„æ²¡æœ‰çœ‹åˆ°å…¶ä»–åœ°æ–¹åœ¨å¤ç”¨çº¿ç¨‹æ± ã€‚</p>
<p>å› æ­¤æœŸé—´ä¸€åº¦è‡ªæˆ‘æ€€ç–‘è§é¬¼äº†ï¼Œå¯¼è‡´æœ¬æ¥å¯ä»¥ä¸€ä¸¤ä¸ªå°æ—¶ç¡®å®šæ ¹å› çš„ï¼Œç»“æœé¥¶äº†å¼¯è·¯å¤šèŠ±äº†ä¸¤ä¸ªå°æ—¶æ‰ç¡®å®šæ ¹å› ã€‚</p>
<p>æ‰€ä»¥è¯´<strong>æ’æŸ¥é—®é¢˜çš„æ—¶å€™æ¯ä¸€æ­¥éƒ½è¦ä¿æŒç»†å¿ƒï¼Œå¾—å‡ºçš„æ¯ä¸€ä¸ªç»“è®ºéƒ½åº”è¯¥æ˜¯è¯æ®ç¡®å‡¿ï¼Œç†ç”±å……åˆ†</strong>ï¼Œ</p>
<p>å¦åˆ™ä¼šè®©è‡ªå·±å…œå…œè½¬è½¬æµªè´¹å®è´µçš„æ—¶é—´ã€‚</p>
<p>ï»¿</p>
<p>æ’æ›²2ï¼š</p>
<p>æ’æŸ¥ä»£ç çš„æ—¶å€™å‘ç°å¼‚æ­¥ä»»åŠ¡ä»£ç æ²¡æœ‰åšä»»ä½•çš„å¼‚å¸¸å¤„ç†ï¼Œè¿™å…¶å®æ˜¯å¾ˆå‘çš„ã€‚</p>
<p>æœ‰ç»éªŒçš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œ<strong>çº¿ç¨‹æ± é‡Œé¢æäº¤å¼‚æ­¥ä»»åŠ¡å¦‚æœæ²¡æœ‰åšå¼‚å¸¸å¤„ç†ï¼Œå‡ºç°å¼‚å¸¸çš„è¯ä¸ä¼šæœ‰ä»»ä½•çš„æ—¥å¿—ä¿¡æ¯ã€‚</strong></p>
<p>æœ¬åœ°è¿è¡Œçš„æ—¶å€™ä¼šæ‰“å°åˆ°æ§åˆ¶å°ï¼Œä½†æ˜¯çº¿ä¸Šæ§åˆ¶å°çš„ä¿¡æ¯å¯ä¸ä¼šè®°å½•åˆ°æ—¥å¿—é‡Œé¢ã€‚</p>
<p>æ‰€ä»¥ç»å¸¸é‡åˆ°å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œç»“æœä¸ç¬¦åˆé¢„æœŸï¼Œä½†æ˜¯çº¿ä¸Šæ²¡æœ‰ä»»ä½•ç›¸å…³æ—¥å¿—å°±æ˜¯è¿™ä¸ªåŸå› ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œæœ‰æ—¥å¿—æ˜¯å› ä¸ºä½¿ç”¨çš„çº¿ç¨‹æ± æ˜¯äºŒæ¬¡å°è£…è¿‡çš„ï¼Œé‡Œé¢å¯¹å¼‚æ­¥ä»»åŠ¡åšäº†å…œåº•çš„å¼‚å¸¸è®°å½•ã€‚</p>
<p>ï»¿</p>
<h2 data-id="heading-7">æ€»ç»“ï¼š</h2>
<p>å‰é¢åˆ†æåˆ°äº†å¯¼è‡´ç©ºæŒ‡é’ˆçš„åŸå› æ˜¯çº¿ç¨‹æ± å…±ç”¨å¯¼è‡´çš„è€ä»£ç æŠ¥é”™ï¼Œè€Œå…±ç”¨è¿™ä¸ªçº¿ç¨‹æ± çš„ä»£ç æ˜¯æ–°ä¸Šçº¿çš„åŠŸèƒ½å¼•å…¥çš„ã€‚</p>
<p>è¿™å°±æ‰“è„¸äº†å¼€å¤´æˆ‘ä»¬æ£€æŸ¥äº†ä¸Šçº¿çš„åŠŸèƒ½ä¸æ­¤æ— å…³ï¼Œå®åˆ™æœ‰å…³ã€‚</p>
<p>åªæ˜¯æˆ‘ä»¬è¯„ä¼°å¤ç”¨çº¿ç¨‹æ± çš„å½±å“æ—¶ï¼Œå¾ˆéš¾æƒ³åˆ°ä¼šæœ‰è¿™æ ·çš„å½±å“ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šè€ƒè™‘ï¼š</p>
<p>1.æ˜¯å¦ä¼šå½±å“å…±ç”¨è¯¥çº¿ç¨‹æ± çš„è€åŠŸèƒ½å“åº”æ—¶é—´è¾¹é•¿</p>
<p>2.æ˜¯å¦å­˜åœ¨çˆ¶å­ä»»åŠ¡å…±ç”¨çº¿ç¨‹æ± å¯¼è‡´å¯èƒ½äº§ç”Ÿæ­»é”</p>
<p>é’ˆå¯¹InheritableThreadLocalï¼Œæˆ‘ä¸ªäººçš„å»ºè®®æ˜¯ï¼š</p>
<p>1.InheritableThreadLocalï¼ˆå…¶å®ThreadLocalä¹Ÿä¸€æ ·ï¼‰ä¸é€‚åˆåº”ç”¨äºä¸šåŠ¡ä»£ç ä¸­ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯éšå¼çš„å‚æ•°ä¼ é€’ï¼Œè€Œä¸šåŠ¡ç³»ç»Ÿä¸­å¥½ç»´æŠ¤çš„ä»£ç åº”å½“æ˜¯æ˜¾å¼çš„å‚æ•°ä¼ é€’ï¼ˆæˆ‘ä»¬è¿™ä¸ªçº¿ä¸Šé—®é¢˜å°±é‡‡ç”¨è¯¥æ–¹å¼ï¼‰</p>
<p>2.æ¡†æ¶ç±»ä»£ç æ‰æ˜¯InheritableThreadLocalå’ŒThreadLocalä¸»è¦å‘å…‰å‘çƒ­çš„åœ°æ–¹ï¼Œå› ä¸ºå¯¹åº”çš„ç ”å‘æ°´å¹³é€šå¸¸è¾ƒé«˜ï¼Œä¸”ä»£ç ç»è¿‡ä¸¥æ ¼æµ‹è¯•éªŒè¯ï¼Œå¹¶ä¸”è¾ƒå°‘å˜åŠ¨ã€‚è€Œä¸šåŠ¡ç³»ç»Ÿç ”å‘æ°´å¹³å‚å·®ä¸é½ï¼Œä¸”ç»å¸¸ä¼šå‘ç”ŸåŒæ­¥æ“ä½œå˜å¼‚æ­¥ç­‰</p>
<p>3.è™½ç„¶InheritableThreadLocalä¸å»ºè®®åœ¨ä¸šåŠ¡ä»£ç ä¸­ä½¿ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯éœ€è¦æŒæ¡å®ƒï¼Œä¸ä¸ºåˆ«çš„ï¼Œåªæœ‰æŒæ¡å®ƒçš„ä¼˜ç¼ºç‚¹æ‰èƒ½å‘Šè¯‰è‡ªå·±å’Œä»–äººä¸ºä»€ä¹ˆåº”è¯¥åœ¨ä¸šåŠ¡ä»£ç ä¸­æ”¾å¼ƒä½¿ç”¨å®ƒ</p>
<p>ï»¿</p>
<p>é’ˆå¯¹å¦‚ä½•æœ‰æ•ˆçš„åº”å¯¹ä¸šåŠ¡ç ”å‘é‡åˆ°çš„ä¸€äº›â€œç–‘éš¾æ‚ç—‡â€ï¼Œæˆ‘çš„å»ºè®®æ˜¯ï¼š</p>
<p>1.å¤§èƒ†æå‡ºåˆç†çš„å‡è®¾ï¼Œå°å¿ƒè°¨æ…è¿›è¡ŒéªŒè¯</p>
<p>2.æ²¡æœ‰å……è¶³ç†ç”±ï¼Œä¸è¦è½»æ˜“ä¸‹ç»“è®º</p>
<p>3.æ²¡æœ‰å¤´ç»ªæ—¶ï¼Œä¼‘æ¯ä¸€ä¸‹ï¼Œæˆ–æ‰¾åˆé€‚çš„äººä¸€èµ·æ¢è®¨ï¼Œç»™è‡ªå·±æ‰“å¼€æ–°çš„æ€è·¯</p>
<p>ï»¿</p>
<p>æœ€åï¼Œæ„¿å¤©ä¸‹æ²¡æœ‰æ•…éšœï¼Œæ²¡æœ‰çº¿ä¸Šé—®é¢˜ï¼Œæ²¡æœ‰bugã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€]]></title>    <link>https://juejin.cn/post/7595495896134647834</link>    <guid>https://juejin.cn/post/7595495896134647834</guid>    <pubDate>2026-01-15T23:48:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595495896134647834" data-draft-id="7595478717984849929" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€"/> <meta itemprop="keywords" content="åç«¯,PHP"/> <meta itemprop="datePublished" content="2026-01-15T23:48:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="BingoGo"/> <meta itemprop="url" content="https://juejin.cn/user/993614242266077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/993614242266077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    BingoGo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-15T23:48:00.000Z" title="Thu Jan 15 2026 23:48:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€</h2>
<h3 data-id="heading-1">parse_url() èƒ½ç”¨ï¼Œä½†ä¸å¤Ÿç”¨</h3>
<p>å¤šå¹´æ¥ï¼ŒPHP å¼€å‘è€…å¤„ç† URL çš„æ–¹å¼å¤§åŒå°å¼‚ï¼š</p>
<ul>
<li>ç”¨ <code>parse_url()</code> æ‹†åˆ†å„éƒ¨åˆ†</li>
<li>ç”¨ <code>rawurlencode()</code> / <code>urlencode()</code> è½¬ä¹‰</li>
<li>ç”¨å­—ç¬¦ä¸²æ‹¼æ¥é‡å»ºæœ€ç»ˆ URL</li>
<li>é‡åˆ°"å¥‡æ€ª"è¾“å…¥æ—¶ï¼Œå†ä¸Šå‡ ä¸ªæ­£åˆ™</li>
</ul>
<p>å¤§å¤šæ•°æƒ…å†µä¸‹è¿™å¥—æµç¨‹èƒ½è·‘é€šã€‚é—®é¢˜åœ¨äºï¼ŒURL å¤„ç†æ°æ°æ˜¯é‚£ç§"åœ¨è¾¹è§’æƒ…å†µä¸‹å‡ºé—®é¢˜"çš„é¢†åŸŸï¼šç¼–ç ã€fragmentã€userinfoã€å›½é™…åŒ–åŸŸåã€"ç­‰ä»·ä½†ä¸ç›¸åŒ"çš„ URLï¼Œä»¥åŠå„ç§åªåœ¨ç”Ÿäº§æ—¥å¿—é‡Œæ‰å†’å‡ºæ¥çš„è¾¹ç¼˜åœºæ™¯ã€‚</p>
<p>PHP 8.5 æä¾›äº†ä¸€ä¸ªå†…ç½®æ›¿ä»£æ–¹æ¡ˆï¼šä¸€ä¸ªå§‹ç»ˆå¯ç”¨çš„ URI æ‰©å±•ï¼Œæä¾› API æ¥æŒ‰ç…§ RFC 3986 å’Œ WHATWG URL æ ‡å‡†è§£æã€ä¿®æ”¹ URL/URIã€‚</p>
<p>å¦‚æœ"æ ‡å‡†"äºŒå­—è®©ä½ è§‰å¾—æŠ½è±¡ï¼Œè¿™é‡Œç»™å‡ºå®é™…å«ä¹‰ï¼š</p>
<ul>
<li>æ‹¿åˆ° URI/URL å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ•°ç»„ + å­—ç¬¦ä¸²æ‹¼æ¥ã€‚</li>
<li>ç”¨å®‰å…¨çš„ç»„ä»¶ getter å’Œä¸å¯å˜çš„ <code>with*()</code> æ–¹æ³•ã€‚</li>
<li>ä½ å¯ä»¥é€‰æ‹© RFC 3986 è¡Œä¸ºï¼ˆä¸¥æ ¼ URIï¼Œ"åŸå§‹ vs è§„èŒƒåŒ–è§£ç "ï¼‰æˆ–æµè§ˆå™¨é£æ ¼çš„ WHATWG è¡Œä¸ºï¼ˆUnicode/IDNAã€è½¯é”™è¯¯ã€è‡ªåŠ¨ç¼–ç ï¼‰ã€‚</li>
</ul>
<p>æœ¬æ–‡æ˜¯ä¸€ç¯‡å®æˆ˜æ•™ç¨‹ï¼Œé‡ç‚¹è®²ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆæ‰‹åŠ¨è§£æå®¹æ˜“å‡ºé”™ï¼Œ</li>
<li>æ–° URI å¯¹è±¡æ€ä¹ˆç”¨ï¼Œ</li>
<li>å¦‚ä½•å®‰å…¨åœ°ä¿®æ”¹/è§„èŒƒåŒ–ï¼Œ</li>
<li>åœ¨é‡å®šå‘ã€ç­¾åé“¾æ¥ç­‰å®‰å…¨æ•æ„Ÿåœºæ™¯ä¸‹å¦‚ä½•ä½¿ç”¨ã€‚</li>
</ul>
<p>ä¸è®²å‡çº§æŒ‡å—ï¼Œä¸è®²åºŸå¼ƒæ¸…å•â€”â€”åªè®² URI æ‰©å±•ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fcatchadmin.com%2Fpost%2F2026-01%2Fphp85-uri-extension-safer-cleaner-urls" target="_blank" title="https://catchadmin.com/post/2026-01/php85-uri-extension-safer-cleaner-urls" ref="nofollow noopener noreferrer">åŸæ–‡ åˆ«å†æ‰‹å†™ URL è§£æå™¨äº†ï¼šPHP 8.5 URI æ‰©å±•è®© URL å¤„ç†æ›´å®‰å…¨ã€æ›´å¹²å‡€</a></p>
<h3 data-id="heading-2">æ‰‹åŠ¨ URL è§£æçš„é—®é¢˜</h3>
<h4 data-id="heading-3">parse_url() ä¸è§£ç ï¼ˆè€Œä¸”å¾ˆå®¹æ˜“å¿˜ï¼‰</h4>
<p>PHP çš„ <code>parse_url()</code> è¿”å›å„ç»„ä»¶ï¼Œä½†<strong>ä¸ä¼š</strong> URL è§£ç å®ƒä»¬ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$u</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-string">"https://example.com/t%65st?name=Ali%63e#fr%61g"</span>);
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u</span>[<span class="hljs-string">'path'</span>]);   <span class="hljs-comment">// "/t%65st"</span>
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u</span>[<span class="hljs-string">'query'</span>]);  <span class="hljs-comment">// "name=Ali%63e"</span>
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u</span>[<span class="hljs-string">'fragment'</span>]); <span class="hljs-comment">// "fr%61g"</span>
</code></pre>
<p>å¦‚æœä½ åœ¨æ¯”è¾ƒè·¯å¾„æˆ–åº”ç”¨è·¯ç”±è§„åˆ™æ—¶æ²¡æœ‰ç»Ÿä¸€è§£ç /è§„èŒƒåŒ–ï¼Œå¯èƒ½ä¼šæŠŠç­‰ä»·çš„ URI å½“æˆä¸åŒçš„æ¥å¤„ç†ã€‚</p>
<p>æ›´ç³Ÿçš„æ˜¯ï¼šå›¢é˜Ÿå¾€å¾€æ··ç”¨ï¼š</p>
<ul>
<li>æœ‰äº›åœ°æ–¹ç”¨è§£ç åçš„å€¼ï¼Œ</li>
<li>æœ‰äº›åœ°æ–¹ç”¨åŸå§‹å€¼ï¼Œ</li>
<li>å†åŠ ä¸Šæ•£è½åœ¨å„å¤„çš„ä¸´æ—¶è§£ç é€»è¾‘ã€‚</li>
</ul>
<p>è¿™ç§æ··ä¹±å¾ˆå®¹æ˜“åŸ‹ä¸‹éšè”½ bug å’Œå®‰å…¨éšæ‚£ã€‚</p>
<h4 data-id="heading-4">å­—ç¬¦ä¸²æ‹¼æ¥å®¹æ˜“æ‹¼å‡º"å·®ä¸€ç‚¹å¯¹"çš„ URL</h4>
<p>æ‰‹åŠ¨é‡å»º URL å®¹æ˜“çŠ¯çš„é”™ï¼š</p>
<ul>
<li>æ¼æ‰ <code>?</code> æˆ– <code>#</code></li>
<li>é‡å¤ç¼–ç </li>
<li>å®Œå…¨æ²¡ç¼–ç </li>
<li>ç¼–ç é”™äº†ä¸œè¥¿ï¼ˆæ¯”å¦‚æŠŠæ•´ä¸ª query string ç¼–ç è€Œä¸æ˜¯åªç¼–ç  valueï¼‰</li>
<li>ä¸¢å¤±æˆ–æ‰“ä¹±å‚æ•°é¡ºåº</li>
<li>ç©º query/fragment å¤„ç†ä¸å½“</li>
</ul>
<p>ä¸€ä¸ªå¸¸è§çš„"å·®ä¸€ç‚¹å¯¹"å‡½æ•°ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addQueryParam</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$url</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$key</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$value</span></span>): <span class="hljs-title">string</span>
</span>{
    <span class="hljs-variable">$parts</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$url</span>);
    <span class="hljs-variable">$query</span> = <span class="hljs-variable">$parts</span>[<span class="hljs-string">'query'</span>] ?? <span class="hljs-string">''</span>;
    <span class="hljs-variable">$query</span> .= (<span class="hljs-variable">$query</span> === <span class="hljs-string">''</span> ? <span class="hljs-string">''</span> : <span class="hljs-string">'&amp;'</span>) . <span class="hljs-variable">$key</span> . <span class="hljs-string">'='</span> . <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$value</span>);
    <span class="hljs-variable">$out</span> = <span class="hljs-variable">$parts</span>[<span class="hljs-string">'scheme'</span>] . <span class="hljs-string">'://'</span> . <span class="hljs-variable">$parts</span>[<span class="hljs-string">'host'</span>] . (<span class="hljs-variable">$parts</span>[<span class="hljs-string">'path'</span>] ?? <span class="hljs-string">''</span>);
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$query</span> !== <span class="hljs-string">''</span>) {
        <span class="hljs-variable">$out</span> .= <span class="hljs-string">'?'</span> . <span class="hljs-variable">$query</span>;
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$parts</span>[<span class="hljs-string">'fragment'</span>])) {
        <span class="hljs-variable">$out</span> .= <span class="hljs-string">'#'</span> . <span class="hljs-variable">$parts</span>[<span class="hljs-string">'fragment'</span>];
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable">$out</span>;
}
</code></pre>
<p>çœ‹èµ·æ¥æ²¡é—®é¢˜ã€‚ç›´åˆ°é‡åˆ°ï¼š</p>
<ul>
<li>æ²¡æœ‰ scheme/host çš„ URLï¼ˆç›¸å¯¹ URLï¼‰ï¼Œ</li>
<li>å¸¦ userinfo/port çš„ URLï¼Œ</li>
<li>å·²ç»ç¼–ç è¿‡çš„å€¼ï¼Œ</li>
<li>éœ€è¦ <code>rawurlencode()</code> è§„åˆ™ï¼ˆRFC 3986ï¼‰çš„å‚æ•°ï¼Œ</li>
<li>åº”è¯¥åŸæ ·ä¿ç•™çš„ fragmentã€‚</li>
</ul>
<h4 data-id="heading-5">ç­‰ä»·çš„ URL ä¸ä¸€å®šæ˜¯ç›¸åŒçš„å­—ç¬¦ä¸²</h4>
<p>ä¸‹é¢è¿™äº›å¯ä»¥æŒ‡å‘åŒä¸€ä¸ªèµ„æºï¼Œä½†å­—ç¬¦ä¸²ä¸åŒï¼š</p>
<ul>
<li>scheme/host å¤§å°å†™ä¸åŒï¼ˆ<code>HTTPS://EXAMPLE.com</code>ï¼‰</li>
<li>path ä¸­ <code>%65</code> vs <code>e</code>ï¼ˆ<code>/t%65st</code> vs <code>/test</code>ï¼‰</li>
<li>path ä¸­çš„ç‚¹å·æ®µï¼ˆ<code>/foo/../bar/</code>ï¼‰</li>
<li>é»˜è®¤ç«¯å£ï¼ˆhttps çš„ <code>:443</code>ï¼‰</li>
</ul>
<p>å¦‚æœä½ æŠŠ URL å½“æˆçº¯å­—ç¬¦ä¸²å¤„ç†ï¼Œè¦ä¹ˆï¼š</p>
<ul>
<li>ç¼“å­˜/è·¯ç”±å‡ºç°è¯¡å¼‚é—®é¢˜ï¼Œ</li>
<li>è¦ä¹ˆå®‰å…¨æ£€æŸ¥è¢«ç»•è¿‡ï¼Œå› ä¸ºä½ æ¯”è¾ƒçš„æ˜¯"é”™è¯¯çš„è¡¨ç¤ºå½¢å¼"ã€‚</li>
</ul>
<h4 data-id="heading-6">IDNAï¼ˆå›½é™…åŒ–åŸŸåï¼‰è¿˜æ¶‰åŠå®‰å…¨é—®é¢˜</h4>
<p>å¦‚æœä½ å…è®¸ç”¨æˆ·æäº¤ URLï¼Œå›½é™…åŒ–åŸŸåå¯èƒ½æ˜¯åˆæ³•çš„â€”â€”ä½†ä¹Ÿå¯èƒ½é€ æˆæ··æ·†ã€‚åŸŸåå¯ä»¥ç”¨ Unicode æˆ– punycodeï¼ˆASCII å½¢å¼ï¼‰è¡¨ç¤ºã€‚RFC è®¨è®ºä¸­æ˜ç¡®æŒ‡å‡ºäººä¸ºé£é™©ï¼špunycode åŸŸååœ¨ Unicode æ¸²æŸ“æ—¶å¯èƒ½çœ‹èµ·æ¥åƒä¸€ä¸ªç†Ÿæ‚‰çš„ã€ä½†å®é™…ä¸åŒçš„åŸŸåã€‚</p>
<p>è¿™ä¸æ˜¯ä½ æƒ³ç”¨æ­£åˆ™"æ‰‹åŠ¨å¤„ç†"ç„¶åç¥ˆç¥·æ²¡é—®é¢˜çš„äº‹ã€‚</p>
<h3 data-id="heading-7">URI æ‰©å±•çš„æ¦‚å¿µï¼šURI å¯¹è±¡ + ä¸¤å¥—æ ‡å‡†</h3>
<p>PHP 8.5 çš„ URI æ‰©å±•æä¾›ä¸¤ä¸ªä¸»è¦ç±»ï¼š</p>
<ul>
<li><code>Uri\Rfc3986\Uri</code>ï¼ˆRFC 3986 åˆè§„ï¼Œä¸¥æ ¼ URI è§„åˆ™ï¼‰</li>
<li><code>Uri\WhatWg\Url</code>ï¼ˆWHATWG URL åˆè§„ï¼Œæµè§ˆå™¨é£æ ¼çš„ URL è§„åˆ™ï¼‰</li>
</ul>
<p>é…å¥—çš„ç±»å‹åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>Uri\InvalidUriException</code></li>
<li><code>Uri\WhatWg\InvalidUrlException</code></li>
<li><code>Uri\WhatWg\UrlValidationError</code> å’Œ <code>UrlValidationErrorType</code></li>
<li><code>Uri\UriComparisonMode</code>ï¼ˆç”¨äºæ¯”è¾ƒï¼‰</li>
</ul>
<p>ä¸€ä¸ªå…³é”®è®¾è®¡å†³ç­–ï¼šä¸¤ä¸ªå®ç°éƒ½æ˜¯ readonly ä¸”ä»¥ä¸å¯å˜æ–¹å¼ä½¿ç”¨â€”â€”<code>withPath()</code>ã€<code>withQuery()</code> ç­‰æ–¹æ³•è¿”å›æ–°å®ä¾‹ã€‚</p>
<p>å¦ä¸€ä¸ªè¦ç‚¹ï¼šè¿™ä¸ªæ‰©å±•åœ¨ PHP 8.5 ä¸­å§‹ç»ˆå¯ç”¨ï¼Œåº•å±‚ç”±ä»¥ä¸‹åº“é©±åŠ¨ï¼š</p>
<ul>
<li>uriparserï¼ˆç”¨äº RFC 3986ï¼‰</li>
<li>Lexborï¼ˆç”¨äº WHATWG URLï¼‰</li>
</ul>
<p>æ‰€ä»¥ä½ ä¸éœ€è¦ç¬¬ä¸‰æ–¹åº“å°±èƒ½è·å¾—åˆç†çš„ URL å¤„ç†èƒ½åŠ›ã€‚</p>
<h3 data-id="heading-8">åˆ›å»ºå’Œè§£æ URIï¼šä»å­—ç¬¦ä¸²åˆ°ç»„ä»¶</h3>
<h4 data-id="heading-9">æœ€ç®€å•çš„æƒ…å†µï¼šè§£æä¸€ä¸ª HTTP URL å¹¶è®¿é—®å„éƒ¨åˆ†</h4>
<p>RFC 3986ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://php.net/releases/8.5/en.php"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>(); <span class="hljs-comment">// "https"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>();   <span class="hljs-comment">// "php.net"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>();   <span class="hljs-comment">// "/releases/8.5/en.php"</span>
</code></pre>
<p>WHATWGï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com/path?query=1#frag"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>();      <span class="hljs-comment">// "https"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>();   <span class="hljs-comment">// "example.com"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>();        <span class="hljs-comment">// "/path"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getQuery</span>();       <span class="hljs-comment">// "query=1"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getFragment</span>();    <span class="hljs-comment">// "frag"</span>
</code></pre>
<p>æ³¨æ„ï¼šWHATWG çš„ getter æ•…æ„ä¸è¿”å›åˆ†éš”ç¬¦ï¼ˆå¦‚ <code>:</code> <code>/</code> <code>?</code> <code>#</code>ï¼‰ã€‚</p>
<h4 data-id="heading-10">æ„é€ å‡½æ•°æŠ›å¼‚å¸¸ï¼›parse() è¿”å› null</h4>
<p>ä¸¤ä¸ªå®ç°éƒ½æ”¯æŒä¸¤ç§è§£æé£æ ¼ï¼š</p>
<ul>
<li>æ„é€ å‡½æ•°ï¼šæ— æ•ˆæ—¶æŠ›å¼‚å¸¸</li>
<li><code>parse()</code>ï¼šæ— æ•ˆæ—¶è¿”å› null</li>
</ul>
<p>RFC 3986 è¡Œä¸ºï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">InvalidUriException</span>;

<span class="hljs-keyword">try</span> {
    <span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"not a uri"</span>);
} <span class="hljs-keyword">catch</span> (InvalidUriException <span class="hljs-variable">$e</span>) {
    <span class="hljs-comment">// æ‹’ç»è¾“å…¥</span>
}

<span class="hljs-variable">$uri</span> = <span class="hljs-title class_">Uri</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-string">"not a uri"</span>);
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$uri</span>); <span class="hljs-comment">// null</span>
</code></pre>
<p>WHATWG è¡Œä¸ºæä¾›æ›´ä¸°å¯Œçš„é”™è¯¯ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">InvalidUrlException</span>;

<span class="hljs-keyword">try</span> {
    <span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"invalid url"</span>);
} <span class="hljs-keyword">catch</span> (InvalidUrlException <span class="hljs-variable">$e</span>) {
    <span class="hljs-comment">// $e-&gt;errors åŒ…å« UrlValidationError å®ä¾‹</span>
}

<span class="hljs-variable">$errors</span> = [];
<span class="hljs-variable">$url</span> = <span class="hljs-title class_">Url</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-string">"invalid url"</span>, <span class="hljs-literal">null</span>, <span class="hljs-variable">$errors</span>);
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$url</span>);    <span class="hljs-comment">// null</span>
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$errors</span>); <span class="hljs-comment">// UrlValidationError æ•°ç»„</span>
</code></pre>
<p>è¿™ç§åŒºåˆ†ï¼ˆç¡¬é”™è¯¯ vs è½¯é”™è¯¯ vs parse-and-return-nullï¼‰åœ¨ RFC ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚</p>
<h4 data-id="heading-11">Base URL å’Œå¼•ç”¨è§£æï¼ˆç›¸å¯¹ â†’ ç»å¯¹ï¼‰</h4>
<p>æœ‰äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä½ ä¸å†éœ€è¦æ‰‹åŠ¨æ£€æŸ¥æ˜¯å¦ä»¥ <code>/</code> å¼€å¤´ç„¶åæ‹¼æ¥ã€‚</p>
<p>åœ¨æ„é€ å‡½æ•°æˆ– <code>parse()</code> ä¸­ä½¿ç”¨ base URLï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$base</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://example.com"</span>);
<span class="hljs-variable">$uri</span>  = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"/foo"</span>, <span class="hljs-variable">$base</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">toString</span>(); <span class="hljs-comment">// "https://example.com/foo"</span>
</code></pre>
<p>WHATWG ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$base</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com"</span>);
<span class="hljs-variable">$url</span>  = <span class="hljs-title class_">Url</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-string">"/foo"</span>, <span class="hljs-variable">$base</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>(); <span class="hljs-comment">// "https://example.com/foo"</span>
</code></pre>
<p>æ‰©å±•è¿˜æä¾›äº†ä¾¿æ·çš„ <code>resolve()</code> æ–¹æ³•ï¼Œä»¥å½“å‰å¯¹è±¡ä½œä¸º baseã€‚</p>
<h3 data-id="heading-12">å®‰å…¨ä¿®æ”¹ï¼šè®¾ç½®/æ›¿æ¢ pathã€queryã€fragmentï¼ˆä¸å¯å˜ï¼‰</h3>
<p>æ‹¿åˆ°å¯¹è±¡åï¼Œå¯ä»¥ç”¨ <code>with*()</code> æ–¹æ³•ä¿®æ”¹ç»„ä»¶ã€‚è¿™äº›æ–¹æ³•è¿”å›æ–°å®ä¾‹ï¼ŒåŸå¯¹è±¡ä¿æŒä¸å˜ã€‚</p>
<h4 data-id="heading-13">RFC 3986ï¼šwithPath()ã€withQuery()ã€withFragment()</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://example.com/products?sort=asc#top"</span>);

<span class="hljs-variable">$updated</span> = <span class="hljs-variable">$uri</span>
    -&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-string">"/products/123"</span>)
    -&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-string">"sort=desc&amp;ref=home"</span>)
    -&gt;<span class="hljs-title function_ invoke__">withFragment</span>(<span class="hljs-string">"reviews"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">toString</span>();     <span class="hljs-comment">// åŸå¯¹è±¡ä¸å˜</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$updated</span>-&gt;<span class="hljs-title function_ invoke__">toString</span>(); <span class="hljs-comment">// ä¿®æ”¹åçš„</span>
</code></pre>
<p>RFC 3986 æä¾›"åŸå§‹"å’Œ"è§„èŒƒåŒ–è§£ç "ä¸¤ç§ getterï¼ˆä¸‹ä¸€èŠ‚è¯¦è¿°ï¼‰ï¼Œä»¥åŠ <code>toString()</code> å’Œ <code>toRawString()</code> æ–¹æ³•ã€‚</p>
<h4 data-id="heading-14">WHATWGï¼šåŒæ ·çš„æ€è·¯ï¼Œå¤–åŠ  ASCII/Unicode å­—ç¬¦ä¸²è¾“å‡º</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com/"</span>);

<span class="hljs-variable">$new</span> = <span class="hljs-variable">$url</span>
    -&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-string">"/search"</span>)
    -&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-string">"q=php+8.5"</span>)
    -&gt;<span class="hljs-title function_ invoke__">withFragment</span>(<span class="hljs-string">"results"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$new</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$new</span>-&gt;<span class="hljs-title function_ invoke__">toUnicodeString</span>();
</code></pre>
<p>WHATWG æœ‰ <code>toAsciiString()</code> å’Œ <code>toUnicodeString()</code> ä¸¤ç§è¾“å‡ºï¼Œåˆ†åˆ«ç”¨äºæœºå™¨å¤„ç†å’Œäººç±»å±•ç¤ºã€‚</p>
<h4 data-id="heading-15">ä¸€ä¸ªå°ä½†é‡è¦çš„è¡Œä¸ºï¼šè¾“å…¥ä¸­çš„åˆ†éš”ç¬¦</h4>
<p>ä½¿ç”¨ WHATWG æ—¶ï¼Œå¦‚æœä½ åœ¨è®¾ç½® query/fragment æ—¶ä¸å°å¿ƒåŒ…å«äº† <code>?</code> æˆ– <code>#</code>ï¼Œå®ƒä¼šæŠŠå®ƒä»¬å½“ä½œåˆ†éš”ç¬¦å¹¶å»æ‰ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com/"</span>);
<span class="hljs-variable">$url</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-string">"?foo"</span>);
<span class="hljs-variable">$url</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">withFragment</span>(<span class="hljs-string">"#bar"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getQuery</span>();    <span class="hljs-comment">// "foo"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getFragment</span>(); <span class="hljs-comment">// "bar"</span>
</code></pre>
<p>è¿™ä¸ªè¡Œä¸ºåœ¨æ–‡æ¡£ä¸­æœ‰æ˜ç¡®è¯´æ˜ã€‚</p>
<h3 data-id="heading-16">è§„èŒƒåŒ–ä¸ç¼–ç ï¼šé¿å…é‡å¤ç¼–ç å’Œ"å¥‡æ€ªå­—ç¬¦"</h3>
<p>URI æ‰©å±•çš„ä»·å€¼ä¸æ­¢äº API è®¾è®¡â€”â€”å®ƒè®©ä½ èƒ½æ§åˆ¶ URL çš„è¡¨ç¤ºå½¢å¼ã€‚</p>
<h4 data-id="heading-17">RFC 3986 ç»™ä½ ä¸¤ç§è¡¨ç¤ºï¼šåŸå§‹ vs è§„èŒƒåŒ–è§£ç </h4>
<p>å¯¹äºå¤§å¤šæ•°ç»„ä»¶ï¼Œ<code>Uri\Rfc3986\Uri</code> æš´éœ²ï¼š</p>
<ul>
<li>rawï¼šè§£æå™¨ç»™å‡ºçš„å½¢å¼ï¼ˆæœ€æ¥è¿‘åŸå§‹è¾“å…¥ï¼‰</li>
<li>è§„èŒƒåŒ–è§£ç ï¼šè§„èŒƒåŒ– + ç™¾åˆ†å·è§£ç ï¼Œæ„åœ¨æˆä¸ºè§„èŒƒå½¢å¼ä¸”å¯å¾€è¿”è½¬æ¢</li>
</ul>
<p>RFC è§£é‡Šäº†ä¸ºä»€ä¹ˆéœ€è¦ä¸¤ç§å½¢å¼ä»¥åŠä½•æ—¶ä½¿ç”¨â€”â€”ç­¾åæ–¹å’Œ API å®¢æˆ·ç«¯é€šå¸¸åå¥½ rawï¼Œè€Œè·¯ç”±/ç¼“å­˜é€šå¸¸åå¥½è§„èŒƒåŒ–è§£ç ã€‚</p>
<p>å…·ä½“æ•ˆæœï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://%61pple:p%61ss@ex%61mple.com:433/foob%61r?%61bc=%61bc#%61bc"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawHost</span>(); <span class="hljs-comment">// "ex%61mple.com"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>();    <span class="hljs-comment">// "example.com"</span>

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawPath</span>(); <span class="hljs-comment">// "/foob%61r"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>();    <span class="hljs-comment">// "/foobar"</span>

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawQuery</span>(); <span class="hljs-comment">// "%61bc=%61bc"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getQuery</span>();    <span class="hljs-comment">// "abc=abc"</span>
</code></pre>
<p>è§„èŒƒåŒ–ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"HTTPS://EXAMPLE.COM/foo/../bar/"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawScheme</span>(); <span class="hljs-comment">// "HTTPS"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>();    <span class="hljs-comment">// "https"</span>

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawHost</span>(); <span class="hljs-comment">// "EXAMPLE.COM"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>();    <span class="hljs-comment">// "example.com"</span>

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawPath</span>(); <span class="hljs-comment">// "/foo/../bar/"</span>
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>();    <span class="hljs-comment">// "/bar/"</span>
</code></pre>
<h4 data-id="heading-18">WHATWG åœ¨ä¿®æ”¹æ—¶è‡ªåŠ¨ç¼–ç æŸäº›å­—ç¬¦</h4>
<p>å¦‚æœä½ è®¾ç½®çš„ path åŒ…å«è¯¥ç»„ä»¶å¿…é¡»ç™¾åˆ†å·ç¼–ç çš„å­—ç¬¦ï¼ŒWHATWG ä¼šè‡ªåŠ¨ç¼–ç ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://example.com"</span>);
<span class="hljs-variable">$url</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-string">"/?#:"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>(); <span class="hljs-comment">// "/%3F%23:"</span>
</code></pre>
<p>è¿™èƒ½é˜²æ­¢æ„å¤–æ„å»ºå‡ºæŸåçš„ URLã€‚</p>
<h4 data-id="heading-19">"é‡å¤ç¼–ç "é™·é˜±ï¼ˆä»¥åŠæ–° API å¦‚ä½•å¸®å¿™ï¼‰</h4>
<p>é‡å¤ç¼–ç é€šå¸¸è¿™æ ·å‘ç”Ÿï¼š</p>
<ol>
<li>ä½ ç”¨ <code>rawurlencode()</code> ç¼–ç ä¸€ä¸ªå€¼ï¼Œå› ä¸º"å®ƒè¦æ”¾è¿› URL"</li>
<li>ä½ æ‰‹åŠ¨æŠŠå®ƒåŠ åˆ° query string</li>
<li>åæ¥æŸå¤„åˆç¼–ç äº†ä¸€æ¬¡ï¼ˆæ¡†æ¶ã€ä»£ç†ã€å®¢æˆ·ç«¯ï¼‰</li>
</ol>
<p>ä½¿ç”¨ URI å¯¹è±¡ï¼Œä¸€ä¸ªå¥½åšæ³•æ˜¯ï¼š</p>
<ul>
<li>æ•°æ®ä¿æŒä¸ºæ™®é€šå­—ç¬¦ä¸²ï¼ˆæœªç¼–ç ï¼‰</li>
<li>ç”¨ <code>http_build_query()</code> æ„å»º queryï¼ˆæˆ–ä½ åå¥½çš„ç¼–ç å™¨ï¼‰</li>
<li>æŠŠç»“æœä¼ ç»™ <code>withQuery()</code></li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-variable">$base</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://example.com/search"</span>);

<span class="hljs-variable">$params</span> = [
    <span class="hljs-string">'q'</span> =&gt; <span class="hljs-string">'php 8.5 uri'</span>,
    <span class="hljs-string">'tag'</span> =&gt; <span class="hljs-string">'url/encoding'</span>,
];

<span class="hljs-comment">// RFC 3986 é£æ ¼ç¼–ç ï¼ˆç©ºæ ¼ç”¨ %20 è€Œé +ï¼‰</span>
<span class="hljs-variable">$query</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">'+'</span>, <span class="hljs-string">'%20'</span>, <span class="hljs-title function_ invoke__">http_build_query</span>(<span class="hljs-variable">$params</span>));

<span class="hljs-variable">$uri</span> = <span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-variable">$query</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">toString</span>();
</code></pre>
<p><code>http_build_query()</code> ä¸ä¸€å®šé€‚åˆæ‰€æœ‰åœºæ™¯ï¼Œä½†å¥½å¤„æ˜¯ç¼–ç è§„åˆ™é›†ä¸­åœ¨ä¸€å¤„ï¼Œè€Œéæ•£è½åœ¨å„ç§å­—ç¬¦ä¸²æ‹¼æ¥é‡Œã€‚</p>
<p>å¦‚æœç¡®å®éœ€è¦å¯¹ path æ®µè¿›è¡Œ RFC 3986 åŸå§‹ç¼–ç ï¼ŒPHP çš„ <code>rawurlencode()</code> éµå¾ª RFC 3986 è§„åˆ™ã€‚</p>
<h3 data-id="heading-20">éªŒè¯ç”¨æˆ·è¾“å…¥çš„ URLï¼šå®ç”¨çš„æœ€ä½è§„åˆ™</h3>
<p>å¦‚æœè¾“å…¥æ¥è‡ªç”¨æˆ·ï¼ˆæˆ–ä¸å¯ä¿¡æ¥æºï¼‰ï¼ŒéªŒè¯åº”è¯¥æœ‰æ˜ç¡®çš„ç«‹åœºã€‚</p>
<p>å¯¹äºä½ æ‰“ç®— fetch æˆ–è·³è½¬çš„ URLï¼Œä¸€ä¸ªåŠ¡å®çš„å®‰å…¨å¯¼å‘æ¨¡å¼ï¼š</p>
<ul>
<li>å¿…é¡»è§£ææˆåŠŸï¼ˆç¡¬é”™è¯¯ç›´æ¥æ‹’ç»ï¼‰</li>
<li>åªå…è®¸ http / https</li>
<li>URL ä¸­ä¸èƒ½æœ‰ç”¨æˆ·å/å¯†ç </li>
<li>åŸŸåç™½åå•ï¼ˆç”¨ ASCII å½¢å¼æ¯”è¾ƒï¼‰</li>
<li>å¯é€‰ï¼šé™åˆ¶ç«¯å£</li>
<li>å¯é€‰ï¼šè¦æ±‚ç»å¯¹ URLï¼ˆæˆ–ç›¸å¯¹ URL åŸºäºå·²çŸ¥ base è§£æï¼‰</li>
</ul>
<h4 data-id="heading-21">ä¸¥æ ¼éªŒè¯ helperï¼ˆWHATWG ç‰ˆæœ¬ï¼‰</h4>
<p>WHATWG é€‚åˆå¤„ç†"æµè§ˆå™¨é£æ ¼"URL å’Œ IDNAã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">InvalidUrlException</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateExternalUrl</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$input</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$allowedHosts</span></span>): <span class="hljs-title">Url</span>
</span>{
    <span class="hljs-keyword">try</span> {
        <span class="hljs-variable">$softErrors</span> = [];
        <span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-variable">$input</span>, <span class="hljs-literal">null</span>, <span class="hljs-variable">$softErrors</span>);
    } <span class="hljs-keyword">catch</span> (InvalidUrlException <span class="hljs-variable">$e</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Invalid URL."</span>);
    }

    <span class="hljs-comment">// Scheme ç™½åå•</span>
    <span class="hljs-variable">$scheme</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>();
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$scheme</span>, [<span class="hljs-string">'http'</span>, <span class="hljs-string">'https'</span>], <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Unsupported scheme."</span>);
    }

    <span class="hljs-comment">// ç¦æ­¢å‡­è¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getUsername</span>() !== <span class="hljs-literal">null</span> || <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getPassword</span>() !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Credentials in URL are not allowed."</span>);
    }

    <span class="hljs-comment">// Host ç™½åå•ï¼ˆASCII æ¯”è¾ƒï¼‰</span>
    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$host</span> === <span class="hljs-literal">null</span> || !<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$host</span>), <span class="hljs-variable">$allowedHosts</span>, <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Host not allowed."</span>);
    }

    <span class="hljs-comment">// å¯é€‰ï¼šç«¯å£é™åˆ¶</span>
    <span class="hljs-variable">$port</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getPort</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$port</span> !== <span class="hljs-literal">null</span> &amp;&amp; !<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$port</span>, [<span class="hljs-number">80</span>, <span class="hljs-number">443</span>], <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Port not allowed."</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$url</span>;
}
</code></pre>
<p>å‡ ç‚¹è¯´æ˜ï¼š</p>
<ul>
<li><code>Url</code> å³ä½¿è§£ææˆåŠŸä¹Ÿå¯èƒ½è¿”å›è½¯é”™è¯¯ã€‚RFC è§£é‡Šäº†"è½¯ vs ç¡¬"æ¨¡å‹ï¼Œå¹¶ç»™å‡ºäº†è§£æç»§ç»­ä½†æŠ¥å‘ŠéªŒè¯é”™è¯¯çš„ä¾‹å­ã€‚</li>
<li>WHATWG åŒæ—¶æš´éœ² <code>getAsciiHost()</code> å’Œ <code>getUnicodeHost()</code>ï¼›æ¯”è¾ƒé€šå¸¸ç”¨ ASCIIï¼Œå±•ç¤ºç”¨ Unicodeã€‚</li>
</ul>
<h4 data-id="heading-22">RFC 3986 éªŒè¯ï¼šä¸¥æ ¼ URI è§£æ + è§„èŒƒåŒ–é€‰é¡¹</h4>
<p>å¦‚æœä½ åœ¨éªŒè¯é€šç”¨ URIï¼ˆä¸åªæ˜¯ HTTP URLï¼‰ï¼Œæˆ–è€…ä½ å…³å¿ƒ raw vs è§„èŒƒåŒ–è§£ç çš„è¡¨ç¤ºï¼Œ<code>Uri\Rfc3986\Uri</code> æ˜¯ä¸ªå¥½é€‰æ‹©ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">InvalidUriException</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateHttpUri</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$input</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$allowedHosts</span></span>): <span class="hljs-title">Uri</span>
</span>{
    <span class="hljs-keyword">try</span> {
        <span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-variable">$input</span>);
    } <span class="hljs-keyword">catch</span> (InvalidUriException <span class="hljs-variable">$e</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Invalid URI."</span>);
    }

    <span class="hljs-variable">$scheme</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>();
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$scheme</span>, [<span class="hljs-string">'http'</span>, <span class="hljs-string">'https'</span>], <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Unsupported scheme."</span>);
    }

    <span class="hljs-comment">// Userinfo åœ¨å¤§å¤šæ•° Web åº”ç”¨ä¸­æ˜¯ä¸ªå‘</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getUserInfo</span>() !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Userinfo is not allowed."</span>);
    }

    <span class="hljs-variable">$host</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$host</span> === <span class="hljs-literal">null</span> || !<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$host</span>), <span class="hljs-variable">$allowedHosts</span>, <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Host not allowed."</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$uri</span>;
}
</code></pre>
<h3 data-id="heading-23">å®é™…ç”¨ä¾‹ï¼šç­¾åé“¾æ¥ã€å®‰å…¨é‡å®šå‘ã€è§„èŒƒ URL</h3>
<h4 data-id="heading-24">ç”¨ä¾‹ï¼šç­¾åé“¾æ¥è€Œä¸ç ´åç¼–ç </h4>
<p>ç­¾å URLï¼ˆHMAC tokenã€ä¸´æ—¶è®¿é—®é“¾æ¥ã€CDN è®¤è¯ï¼‰å¯¹è¡¨ç¤ºå½¢å¼æå…¶æ•æ„Ÿã€‚ä¸€ä¸ªå°çš„"è§„èŒƒåŒ–å˜æ›´"å°±èƒ½ä½¿ç­¾åå¤±æ•ˆã€‚</p>
<p>è¿™ä¹Ÿæ˜¯ RFC æ˜ç¡®æŒ‡å‡º"API å®¢æˆ·ç«¯æˆ–ç­¾åæ–¹"é€šå¸¸åå¥½åŸå§‹è¡¨ç¤ºçš„åŸå› ã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„ç­¾å URL æ–¹æ³•ï¼š</p>
<ol>
<li>æ„å»º URL</li>
<li>å¯¹ç¨³å®šçš„å­—ç¬¦ä¸²è¡¨ç¤ºè®¡ç®—ç­¾å</li>
<li>æŠŠç­¾åä½œä¸º query å‚æ•°åŠ è¿›å»</li>
</ol>
<p>ç¤ºä¾‹ï¼Œä½¿ç”¨ RFC 3986 å’Œ <code>toRawString()</code> ç­¾åï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">signUri</span>(<span class="hljs-params">Uri <span class="hljs-variable">$uri</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$secret</span></span>): <span class="hljs-title">Uri</span>
</span>{
    <span class="hljs-comment">// å½“ä½ æƒ³é¿å…æ„å¤–è½¬æ¢æ—¶ï¼Œç”¨ raw string</span>
    <span class="hljs-variable">$baseString</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">toRawString</span>();
    <span class="hljs-variable">$sig</span> = <span class="hljs-title function_ invoke__">hash_hmac</span>(<span class="hljs-string">'sha256'</span>, <span class="hljs-variable">$baseString</span>, <span class="hljs-variable">$secret</span>);

    <span class="hljs-variable">$query</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getRawQuery</span>();
    <span class="hljs-variable">$query</span> = <span class="hljs-variable">$query</span> ? <span class="hljs-variable">$query</span> . <span class="hljs-string">'&amp;'</span> : <span class="hljs-string">''</span>;
    <span class="hljs-variable">$query</span> .= <span class="hljs-string">'sig='</span> . <span class="hljs-title function_ invoke__">rawurlencode</span>(<span class="hljs-variable">$sig</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-variable">$query</span>);
}

<span class="hljs-variable">$uri</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://download.example.com/file/%2Fsafe?expires=1736035200"</span>);
<span class="hljs-variable">$signed</span> = <span class="hljs-title function_ invoke__">signUri</span>(<span class="hljs-variable">$uri</span>, <span class="hljs-string">"super-secret-key"</span>);

<span class="hljs-keyword">echo</span> <span class="hljs-variable">$signed</span>-&gt;<span class="hljs-title function_ invoke__">toRawString</span>();
</code></pre>
<p>ä¸¤ä¸ªè¦ç‚¹ï¼š</p>
<ul>
<li>ä½ æ˜¯æ•…æ„é€‰æ‹© raw çš„ï¼Œå› ä¸ºç­¾åå…³å¿ƒçš„æ˜¯"çº¿ä¸Šå®é™…å‘é€çš„æ˜¯ä»€ä¹ˆ"ã€‚</li>
<li>query æ„å»ºä»ç„¶è¦å°å¿ƒï¼Œé¿å…ç¼–ç é”™è¯¯ã€‚</li>
</ul>
<p>å¦‚æœä½ çš„ç­¾åç®—æ³•éœ€è¦è§„èŒƒå½¢å¼ï¼ˆæœ‰äº›ç¡®å®éœ€è¦ï¼‰ï¼Œå¯ä»¥æ•…æ„å¯¹ <code>toString()</code> ç­¾åâ€”â€”ä½†è¦çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ„å¤–è¿™ä¹ˆåšã€‚</p>
<h4 data-id="heading-25">ç”¨ä¾‹ï¼šå®‰å…¨é‡å®šå‘ï¼ˆé¿å…å¼€æ”¾é‡å®šå‘ + è§£ææ··æ·†ï¼‰</h4>
<p>å®‰å…¨é‡å®šå‘é—®é¢˜é€šå¸¸é•¿è¿™æ ·ï¼š</p>
<ol>
<li>ä½ æœ‰ <code>/login?next=&lt;something&gt;</code></li>
<li>ç™»å½•åè·³è½¬åˆ° next</li>
<li>æ”»å‡»è€…å°è¯• <code>next=https://evil.com</code> æˆ–å„ç§å˜ä½“</li>
</ol>
<p>ä¸€ä¸ªå¥å£®çš„æ¨¡å¼æ˜¯ï¼š</p>
<ol>
<li>æŠŠç”¨æˆ·è¾“å…¥è§£æä¸ºç›¸å¯¹ URL æˆ–ç»å¯¹ URL</li>
<li>ç›¸å¯¹ URL åŸºäºä½ è‡ªå·±çš„å·²çŸ¥ base è§£æ</li>
<li>éªŒè¯ host/scheme æ˜¯ä½ çš„ï¼ˆæˆ–åœ¨å…è®¸åˆ—è¡¨ä¸­ï¼‰</li>
</ol>
<p>ä½¿ç”¨ WHATWGï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeRedirectTarget</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$next</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$appBase</span></span>): <span class="hljs-title">string</span>
</span>{
    <span class="hljs-variable">$base</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-variable">$appBase</span>);

    <span class="hljs-comment">// å®‰å…¨è§£æç›¸å¯¹å¼•ç”¨</span>
    <span class="hljs-variable">$errors</span> = [];
    <span class="hljs-variable">$resolved</span> = <span class="hljs-title class_">Url</span>::<span class="hljs-title function_ invoke__">parse</span>(<span class="hljs-variable">$next</span>, <span class="hljs-variable">$base</span>, <span class="hljs-variable">$errors</span>);

    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$resolved</span> === <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>(); <span class="hljs-comment">// fallback</span>
    }

    <span class="hljs-comment">// åªå…è®¸åŒ host</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$resolved</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>() ?? <span class="hljs-string">''</span>) !== <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>() ?? <span class="hljs-string">''</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
    }

    <span class="hljs-comment">// åªå…è®¸ http/https</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$resolved</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>(), [<span class="hljs-string">'http'</span>, <span class="hljs-string">'https'</span>], <span class="hljs-literal">true</span>)) {
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$base</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$resolved</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
}

<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">safeRedirectTarget</span>(<span class="hljs-string">"/dashboard"</span>, <span class="hljs-string">"https://app.example.com"</span>);
</code></pre>
<p>è¿™é‡Œç”¨åˆ°äº† base URL è§£æå’Œå¼•ç”¨è§£æåŠŸèƒ½ã€‚</p>
<h4 data-id="heading-26">ç”¨ä¾‹ï¼šè§„èŒƒ URLï¼ˆSEO å’Œç¼“å­˜çš„ä¸€è‡´è¡¨ç¤ºï¼‰</h4>
<p>è§„èŒƒåŒ–é€šå¸¸æ„å‘³ç€ï¼š</p>
<ul>
<li>scheme/host å°å†™</li>
<li>ç§»é™¤ path ä¸­çš„ç‚¹å·æ®µ</li>
<li>ç§»é™¤é»˜è®¤ç«¯å£</li>
<li>query ä¿æŒä¸€è‡´ï¼ˆæœ‰æ—¶æ’åºï¼‰</li>
<li>å†³å®šå¦‚ä½•å¤„ç†æœ«å°¾æ–œæ </li>
</ul>
<p>ä½¿ç”¨ <code>Uri\Rfc3986\Uri</code>ï¼Œä½ å·²ç»å¯ä»¥é€šè¿‡ <code>get*()</code> vs <code>getRaw*()</code>ï¼ˆä»¥åŠ <code>toString()</code> vs <code>toRawString()</code>ï¼‰æ¸…æ™°åœ°è·å¾—è§„èŒƒåŒ–è¡Œä¸ºã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„è§„èŒƒåŒ–ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">canonicalizeForCache</span>(<span class="hljs-params">Uri <span class="hljs-variable">$uri</span></span>): <span class="hljs-title">Uri</span>
</span>{
    <span class="hljs-comment">// ä»è§„èŒƒåŒ–è§£ç çš„éƒ¨åˆ†å¼€å§‹</span>
    <span class="hljs-variable">$uri</span> = <span class="hljs-variable">$uri</span>
        -&gt;<span class="hljs-title function_ invoke__">withScheme</span>(<span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getScheme</span>())
        -&gt;<span class="hljs-title function_ invoke__">withHost</span>(<span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getHost</span>())
        -&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getPath</span>());

    <span class="hljs-comment">// ä¸ºç¼“å­˜ key æ’åº query å‚æ•°ï¼ˆè¿™æ˜¯ä¸€ç§ç­–ç•¥é€‰æ‹©ï¼‰</span>
    <span class="hljs-variable">$query</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">getQuery</span>();
    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$query</span>) {
        <span class="hljs-title function_ invoke__">parse_str</span>(<span class="hljs-variable">$query</span>, <span class="hljs-variable">$params</span>);
        <span class="hljs-title function_ invoke__">ksort</span>(<span class="hljs-variable">$params</span>);
        <span class="hljs-variable">$sorted</span> = <span class="hljs-title function_ invoke__">http_build_query</span>(<span class="hljs-variable">$params</span>, <span class="hljs-string">''</span>, <span class="hljs-string">'&amp;'</span>, PHP_QUERY_RFC3986);
        <span class="hljs-variable">$uri</span> = <span class="hljs-variable">$uri</span>-&gt;<span class="hljs-title function_ invoke__">withQuery</span>(<span class="hljs-variable">$sorted</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-variable">$uri</span>;
}

<span class="hljs-variable">$u</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"HTTPS://EXAMPLE.COM/foo/../bar/?b=2&amp;a=1"</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">canonicalizeForCache</span>(<span class="hljs-variable">$u</span>)-&gt;<span class="hljs-title function_ invoke__">toString</span>();
</code></pre>
<p>è¿™ä¸ªå‡½æ•°ä¸è¯•å›¾è¦†ç›–æ‰€æœ‰è§„èŒƒåŒ–ç­–ç•¥ï¼ˆé‚£æ˜¯åº”ç”¨å±‚é¢çš„äº‹ï¼‰ï¼Œä½†ç»“æ„åŒ– API çš„å¥½å¤„æ˜¯ï¼šè§„åˆ™å¯ä»¥æ˜¾å¼æ„å»ºã€å¯ä»¥æµ‹è¯•ã€‚</p>
<h3 data-id="heading-27">ä» parse_url() + å­—ç¬¦ä¸²æ‹¼æ¥è¿ç§»ï¼ˆä¸ç—›è‹¦ï¼‰</h3>
<p>ä½ ä¸éœ€è¦ä¸€æ¬¡æ€§é‡å†™æ‰€æœ‰ä»£ç ã€‚æœ€ç®€å•çš„è¿ç§»è·¯å¾„æ˜¯ï¼š</p>
<p><strong>1. æ‰¾å‡º URL å¤„ç†å¯¹å®‰å…¨æ•æ„Ÿæˆ–å®¹æ˜“å‡º bug çš„åœ°æ–¹ï¼š</strong></p>
<ul>
<li>é‡å®šå‘</li>
<li>webhook éªŒè¯</li>
<li>ç­¾å URL</li>
<li>åŸŸåç™½åå•</li>
<li>è·¯ç”±/ç¼“å­˜ key</li>
</ul>
<p><strong>2. å…ˆæ›¿æ¢è¿™äº›ã€‚</strong></p>
<p><strong>3. çº¯å±•ç¤ºç”¨é€”çš„ç®€å•è§£æï¼Œç­‰åˆ°æœ‰å¿…è¦æ—¶å†å¤„ç†ã€‚</strong></p>
<h4 data-id="heading-28">è¿ç§»å‰ï¼šæ•°ç»„è§£æ + æ‰‹åŠ¨é‡å»º</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-variable">$parts</span> = <span class="hljs-title function_ invoke__">parse_url</span>(<span class="hljs-variable">$input</span>);
<span class="hljs-variable">$host</span>  = <span class="hljs-variable">$parts</span>[<span class="hljs-string">'host'</span>] ?? <span class="hljs-literal">null</span>;

<span class="hljs-keyword">if</span> (<span class="hljs-variable">$host</span> !== <span class="hljs-string">'example.com'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">"Bad host"</span>);
}

<span class="hljs-variable">$newUrl</span> = <span class="hljs-variable">$parts</span>[<span class="hljs-string">'scheme'</span>] . <span class="hljs-string">'://'</span> . <span class="hljs-variable">$parts</span>[<span class="hljs-string">'host'</span>] . <span class="hljs-string">'/new-path'</span>;
</code></pre>
<p>é—®é¢˜ï¼š</p>
<ul>
<li>æ²¡å¤„ç† portã€userinfoã€fragmentã€ç›¸å¯¹ URL</li>
<li>æ²¡æœ‰è§„èŒƒåŒ–</li>
<li>æ²¡æœ‰è§„èŒƒåŒ–é€‰æ‹©</li>
<li>å®¹æ˜“æ„å»ºå‡ºæ— æ•ˆè¾“å‡º</li>
</ul>
<h4 data-id="heading-29">è¿ç§»åï¼šä½¿ç”¨ Url/Uriï¼Œæ”¹åŠ¨å±€éƒ¨åŒ–</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;

<span class="hljs-variable">$url</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-variable">$input</span>);

<span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">getAsciiHost</span>() ?? <span class="hljs-string">''</span>) !== <span class="hljs-string">'example.com'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Bad host"</span>);
}

<span class="hljs-variable">$new</span> = <span class="hljs-variable">$url</span>-&gt;<span class="hljs-title function_ invoke__">withPath</span>(<span class="hljs-string">'/new-path'</span>);
<span class="hljs-keyword">echo</span> <span class="hljs-variable">$new</span>-&gt;<span class="hljs-title function_ invoke__">toAsciiString</span>();
</code></pre>
<p>ä»£ç æ›´çŸ­ï¼Œæ„å›¾æ›´æ˜ç¡®ï¼Œç»†èŠ‚ä¸Šæ›´éš¾å‡ºé”™ã€‚</p>
<h4 data-id="heading-30">RFC 3986 å’Œ WHATWG æ€ä¹ˆé€‰ï¼ˆç»éªŒæ³•åˆ™ï¼‰</h4>
<p><strong>ä½¿ç”¨ <code>Uri\WhatWg\Url</code> å½“ï¼š</strong></p>
<ul>
<li>ä½ åœ¨å¤„ç†æ¥è‡ªæµè§ˆå™¨/ç”¨æˆ·çš„ HTTP(S) URL</li>
<li>ä½ éœ€è¦ IDNA/Unicode åŸŸåå¤„ç†ï¼ˆ<code>getUnicodeHost()</code> ç”¨äºå±•ç¤ºï¼Œ<code>getAsciiHost()</code> ç”¨äºæ¯”è¾ƒï¼‰</li>
<li>ä½ æƒ³è¦ WHATWG è§£æè¡Œä¸ºå’Œé”™è¯¯æŠ¥å‘Šï¼ˆè½¯é”™è¯¯ï¼‰</li>
</ul>
<p><strong>ä½¿ç”¨ <code>Uri\Rfc3986\Uri</code> å½“ï¼š</strong></p>
<ul>
<li>ä½ åœ¨å¤„ç†"Web URL"ä¹‹å¤–çš„é€šç”¨ URI</li>
<li>ä½ éœ€è¦ raw vs è§„èŒƒåŒ–è§£ç çš„è¡¨ç¤º</li>
<li>ä½ åœ¨åšç­¾åæˆ–åè®®å±‚é¢çš„å·¥ä½œï¼Œè¡¨ç¤ºå½¢å¼å¾ˆé‡è¦</li>
</ul>
<p>RFC æ˜ç¡®åŒºåˆ†äº†è¿™ä¸¤ç§æ–¹æ³•ï¼ŒåŒ…æ‹¬ Unicode/IDNA æ”¯æŒçš„å·®å¼‚ã€‚</p>
<h3 data-id="heading-31">é™„åŠ å†…å®¹ï¼šæ­£ç¡®æ¯”è¾ƒ URLï¼ˆequals() ä»¥åŠä¸ºä»€ä¹ˆæ²¡æœ‰ __toString()ï¼‰</h3>
<p>ä¸€ä¸ªå€¼å¾—ç•™æ„çš„è®¾è®¡ï¼šå†…ç½® URI ç±»æ•…æ„ä¸å®ç° <code>__toString()</code>ï¼Œå› ä¸ºæ¾æ•£æ¯”è¾ƒï¼ˆ<code>==</code>ï¼‰å®¹æ˜“å‡ºé”™ã€‚</p>
<p>å–è€Œä»£ä¹‹ï¼Œä½ ç”¨ <code>equals()</code> æ¯”è¾ƒï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">Rfc3986</span>\<span class="hljs-title">Uri</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">UriComparisonMode</span>;

<span class="hljs-variable">$u1</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://example.COM#foo"</span>);
<span class="hljs-variable">$u2</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uri</span>(<span class="hljs-string">"https://EXAMPLE.COM"</span>);

<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u1</span>-&gt;<span class="hljs-title function_ invoke__">equals</span>(<span class="hljs-variable">$u2</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$u1</span>-&gt;<span class="hljs-title function_ invoke__">equals</span>(<span class="hljs-variable">$u2</span>, <span class="hljs-title class_">UriComparisonMode</span>::<span class="hljs-variable constant_">IncludeFragment</span>)); <span class="hljs-comment">// false</span>
</code></pre>
<p>WHATWG ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">WhatWg</span>\<span class="hljs-title">Url</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Uri</span>\<span class="hljs-title">UriComparisonMode</span>;

<span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https:////example.COM/"</span>);
<span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Url</span>(<span class="hljs-string">"https://EXAMPLE.COM"</span>);

<span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">equals</span>(<span class="hljs-variable">$b</span>)); <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-32">ç»“è®º</h3>
<p>PHP 8.5 çš„ URI æ‰©å±•çœ‹èµ·æ¥æ˜¯ä¸ªå°åŠŸèƒ½ï¼Œç”¨ä¸€æ®µæ—¶é—´åæ‰ä¼šå‘ç°å®ƒæŒ¡æ‰äº†å¤šå°‘ç»†å¾®çš„ URL bugã€‚</p>
<p>æ ¸å¿ƒä»·å€¼åœ¨äº<strong>æ§åˆ¶</strong>ï¼š</p>
<ul>
<li>ä½ å¯ä»¥é€‰æ‹© RFC 3986 vs WHATWG è¯­ä¹‰ã€‚</li>
<li>ä½ å¯ä»¥å†³å®šè¦ raw è¿˜æ˜¯è§„èŒƒåŒ–è§£ç çš„è¡¨ç¤ºã€‚</li>
<li>ä½ å¯ä»¥ä¸å¯å˜ä¸”å®‰å…¨åœ°ä¿®æ”¹ç»„ä»¶ã€‚</li>
<li>ä½ å¯ä»¥ç”¨æ›´éš¾æ„å¤–å‰Šå¼±çš„æ–¹å¼éªŒè¯å’Œæ¯”è¾ƒ URLã€‚</li>
</ul>
<p>å¦‚æœä½ æ›¾ç»å‘å¸ƒè¿‡ä¸€ä¸ª"å¿«é€Ÿ URL ä¿®å¤"ï¼Œåæ¥åœ¨å®‰å…¨æŠ¥å‘Šæˆ–ç”Ÿäº§äº‹æ•…ä¸­çœ‹åˆ°å®ƒï¼Œè¿™ä¸ªæ‰©å±•å€¼å¾—å°½æ—©é‡‡ç”¨â€”â€”ä»é‡å®šå‘å’Œç­¾å URL å¼€å§‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaç»“åˆå¤§æ¨¡å‹æ–‡ç”Ÿå›¾å®æˆ˜]]></title>    <link>https://juejin.cn/post/7595513077220524078</link>    <guid>https://juejin.cn/post/7595513077220524078</guid>    <pubDate>2026-01-16T06:13:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595513077220524078" data-draft-id="7595619510042181670" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaç»“åˆå¤§æ¨¡å‹æ–‡ç”Ÿå›¾å®æˆ˜"/> <meta itemprop="keywords" content="AIGC"/> <meta itemprop="datePublished" content="2026-01-16T06:13:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaç»“åˆå¤§æ¨¡å‹æ–‡ç”Ÿå›¾å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T06:13:45.000Z" title="Fri Jan 16 2026 06:13:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Javaç»“åˆå¤§æ¨¡å‹æ–‡ç”Ÿå›¾å®æˆ˜</p>
<blockquote>
<p><strong>å¯¼è¯»</strong>ï¼šéšç€AIGCæŠ€æœ¯çš„å¿«é€Ÿå‘å±•ï¼Œæ–‡ç”Ÿå›¾å·²æˆä¸ºè½¯ä»¶å¼€å‘ä¸­çš„çƒ­é—¨åŠŸèƒ½ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œä½¿ç”¨Javaç»“åˆOpenAIçš„DALL-Eæ¨¡å‹ï¼Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„æ–‡ç”Ÿå›¾ç³»ç»Ÿã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€æŠ€æœ¯èƒŒæ™¯ä¸é€‰å‹</h2>
<p>2023å¹´å…¨çƒAIGCå¸‚åœºè§„æ¨¡è¾¾åˆ°150äº¿ç¾å…ƒï¼Œé¢„è®¡2025å¹´å°†çªç ´500äº¿ç¾å…ƒã€‚Javaä½œä¸ºä¼ä¸šçº§å¼€å‘çš„ä¸»åŠ›è¯­è¨€ï¼Œä¸AIå¤§æ¨¡å‹çš„ç»“åˆæ­£æˆä¸ºå¼€å‘è€…å…³æ³¨çš„ç„¦ç‚¹ã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆé€‰æ‹©OpenAI DALL-Eï¼Ÿ</h2>
<pre><code class="hljs">âœ… æŠ€æœ¯æˆç†Ÿï¼šAPIç¨³å®šï¼Œæ–‡æ¡£å®Œå–„
âœ… æ•ˆæœä¼˜è´¨ï¼šç”Ÿæˆå›¾ç‰‡è´¨é‡é«˜
âœ… é›†æˆä¾¿æ·ï¼šæä¾›å®˜æ–¹Java SDK
âœ… å•†ä¸šå‹å¥½ï¼šæ¸…æ™°çš„å®šä»·æ¨¡å‹
</code></pre>
<h2 data-id="heading-2"><strong>äºŒã€ç³»ç»Ÿæ¶æ„è®¾è®¡</strong></h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1386ab3fc2e54d8b89e8e7231e1eef67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=4mGg5JlUAxHy7AE4eaF8tCb0R%2F0%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-3"><strong>å…­å±‚æ¶æ„ä½“ç³»</strong>ï¼š</h2>
<pre><code class="hljs">1ï¸âƒ£ è¡¨ç°å±‚ï¼šReact/Vueå‰ç«¯
2ï¸âƒ£Â APIç½‘å…³å±‚ï¼šè®¤è¯æˆæƒã€æµé‡ç®¡ç†
3ï¸âƒ£ åº”ç”¨æœåŠ¡å±‚ï¼šä¸šåŠ¡é€»è¾‘ç¼–æ’
4ï¸âƒ£ ä¸šåŠ¡é€»è¾‘å±‚ï¼šæ ¸å¿ƒç®—æ³•å¤„ç†
5ï¸âƒ£ æ•°æ®å±‚ï¼šMySQL/Redis/MongoDB
6ï¸âƒ£Â AIæœåŠ¡å±‚ï¼šOpenAIÂ DALL-Eè°ƒç”¨
</code></pre>
<h2 data-id="heading-4"><strong>ä¸‰ã€æ ¸å¿ƒä»£ç å®ç°</strong></h2>
<h2 data-id="heading-5">æ ¸å¿ƒä¾èµ–é…ç½®</h2>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
Â  Â Â <span class="hljs-comment">&lt;!-- Spring Boot Webflux --&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-webflux<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â  Â Â <span class="hljs-comment">&lt;!-- OpenAI Client --&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.theokanning.openai-gpt3-java<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>service<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.17.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

Â  Â Â <span class="hljs-comment">&lt;!-- Caffeineç¼“å­˜ --&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.ben-manes.caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â  Â  Â  Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â  Â Â <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h2 data-id="heading-6"><strong>æ ¸å¿ƒç±»å›¾</strong></h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/27d9893693224fbf9d2ada3fa85bdcaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=gJeyeXKTZvrzeN8PaJjqHNC6v8U%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7"><strong>äº”ä¸ªæ ¸å¿ƒç±»</strong>ï¼š</h2>
<pre><code class="hljs">ğŸ”¹ ImageControllerï¼šå¤„ç†HTTPè¯·æ±‚
ğŸ”¹ OpenAiImageServiceï¼šè°ƒç”¨OpenAI API
ğŸ”¹ ImageRequestï¼šè¯·æ±‚å‚æ•°å°è£…
ğŸ”¹ ImageResponseï¼šå“åº”ç»“æœå°è£…
ğŸ”¹ CacheServiceï¼šç¼“å­˜ç®¡ç†
</code></pre>
<h2 data-id="heading-8">æ ¸å¿ƒä»£ç ç¤ºä¾‹</h2>
<h2 data-id="heading-9">ImageRequest - è¯·æ±‚æ¨¡å‹</h2>
<pre><code class="hljs language-arduino" lang="arduino">package com.example.textToImage.model;

<span class="hljs-keyword">import</span> lombok.AllArgsConstructor;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> lombok.NoArgsConstructor;

<span class="hljs-keyword">import</span> javax.validation.constraints.*;

<span class="hljs-comment">/**
 * æ–‡ç”Ÿå›¾è¯·æ±‚å‚æ•°
 */</span>
@Data
@NoArgsConstructor
@AllArgsConstructor
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageRequest</span> {

    <span class="hljs-comment">/**
     * æç¤ºè¯
     */</span>
    @<span class="hljs-built_in">NotBlank</span>(message = <span class="hljs-string">"æç¤ºè¯ä¸èƒ½ä¸ºç©º"</span>)
    @<span class="hljs-built_in">Size</span>(max = <span class="hljs-number">1000</span>, message = <span class="hljs-string">"æç¤ºè¯é•¿åº¦ä¸èƒ½è¶…è¿‡1000å­—ç¬¦"</span>)
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> prompt;

    <span class="hljs-comment">/**
     * å›¾ç‰‡å°ºå¯¸
     */</span>
    @<span class="hljs-built_in">NotNull</span>(message = <span class="hljs-string">"å›¾ç‰‡å°ºå¯¸ä¸èƒ½ä¸ºç©º"</span>)
    <span class="hljs-keyword">private</span> ImageSize size = ImageSize.S1024X1024;

    <span class="hljs-comment">/**
     * å›¾ç‰‡æ•°é‡
     */</span>
    @<span class="hljs-built_in">Min</span>(value = <span class="hljs-number">1</span>, message = <span class="hljs-string">"å›¾ç‰‡æ•°é‡è‡³å°‘ä¸º1"</span>)
    @<span class="hljs-built_in">Max</span>(value = <span class="hljs-number">10</span>, message = <span class="hljs-string">"å›¾ç‰‡æ•°é‡æœ€å¤šä¸º10"</span>)
    <span class="hljs-keyword">private</span> Integer n = <span class="hljs-number">1</span>;

    <span class="hljs-comment">/**
     * å›¾ç‰‡é£æ ¼
     */</span>
    <span class="hljs-keyword">private</span> ImageStyle style = ImageStyle.VIVID;

    <span class="hljs-comment">/**
     * ç”¨æˆ·IDï¼ˆç”¨äºç¼“å­˜ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> userId;

    <span class="hljs-comment">/**
     * å›¾ç‰‡å°ºå¯¸æšä¸¾
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ImageSize</span> {
        <span class="hljs-built_in">S256X256</span>(<span class="hljs-string">"256x256"</span>),
        <span class="hljs-built_in">S512X512</span>(<span class="hljs-string">"512x512"</span>),
        <span class="hljs-built_in">S1024X1024</span>(<span class="hljs-string">"1024x1024"</span>);

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> value;

        <span class="hljs-built_in">ImageSize</span>(<span class="hljs-type">String</span> value) {
            <span class="hljs-keyword">this</span>.value = value;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> value;
        }
    }

    <span class="hljs-comment">/**
     * å›¾ç‰‡é£æ ¼æšä¸¾
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ImageStyle</span> {
        <span class="hljs-built_in">NATURAL</span>(<span class="hljs-string">"natural"</span>),
        <span class="hljs-built_in">VIVID</span>(<span class="hljs-string">"vivid"</span>);

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> value;

        <span class="hljs-built_in">ImageStyle</span>(<span class="hljs-type">String</span> value) {
            <span class="hljs-keyword">this</span>.value = value;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-type">String</span> <span class="hljs-title">getValue</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> value;
        }
    }
}
</code></pre>
<h2 data-id="heading-10">ImageController - RESTæ¥å£</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">package</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.controller</span>;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ImageRequest</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ImageResponse</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">com</span><span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.OpenAiImageService</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">lombok</span><span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.http</span><span class="hljs-selector-class">.ResponseEntity</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">org</span><span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.web</span><span class="hljs-selector-class">.bind</span><span class="hljs-selector-class">.annotation</span>.*;

<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">javax</span><span class="hljs-selector-class">.validation</span><span class="hljs-selector-class">.Valid</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Arrays</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.List</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.CompletableFuture</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">/**
 * æ–‡ç”Ÿå›¾æ§åˆ¶å™¨
 *
 * æä¾›RESTful APIæ¥å£
 */</span>
@<span class="hljs-selector-tag">Slf4j</span>
@<span class="hljs-selector-tag">RestController</span>
@<span class="hljs-selector-tag">RequestMapping</span>(<span class="hljs-string">"/api/images"</span>)
@<span class="hljs-selector-tag">CrossOrigin</span>(origins = <span class="hljs-string">"*"</span>)
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">ImageController</span> {

    <span class="hljs-variable">@Autowired</span>
    private OpenAiImageService imageService;

    <span class="hljs-comment">/**
     * ç”Ÿæˆå›¾ç‰‡ - åŒæ­¥æ¥å£
     */</span>
    <span class="hljs-variable">@PostMapping</span>
    public ResponseEntity&lt;ImageResponse&gt; <span class="hljs-built_in">generateImage</span>(<span class="hljs-variable">@Valid</span> <span class="hljs-variable">@RequestBody</span> ImageRequest request) {
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"æ”¶åˆ°å›¾ç‰‡ç”Ÿæˆè¯·æ±‚: prompt={}, size={}"</span>, request.<span class="hljs-built_in">getPrompt</span>(), request.<span class="hljs-built_in">getSize</span>());

        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">ImageResponse</span> <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">imageService</span><span class="hljs-selector-class">.generateImage</span>(request);

            <span class="hljs-selector-tag">if</span> (response.<span class="hljs-built_in">getSuccess</span>()) {
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(response);
            } <span class="hljs-selector-tag">else</span> {
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()<span class="hljs-selector-class">.body</span>(response);
            }
        } <span class="hljs-selector-tag">catch</span> (Exception e) {
            <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"å›¾ç‰‡ç”Ÿæˆè¯·æ±‚å¤„ç†å¤±è´¥"</span>, e);
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()
                    <span class="hljs-selector-class">.body</span>(ImageResponse.<span class="hljs-built_in">builder</span>()
                            .<span class="hljs-built_in">error</span>(e.<span class="hljs-built_in">getMessage</span>())
                            .<span class="hljs-built_in">success</span>(false)
                            .<span class="hljs-built_in">build</span>());
        }
    }

    <span class="hljs-comment">/**
     * ç”Ÿæˆå›¾ç‰‡ - å¼‚æ­¥æ¥å£
     */</span>
    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/async"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">CompletableFuture</span>&lt;<span class="hljs-selector-tag">ResponseEntity</span>&lt;<span class="hljs-selector-tag">ImageResponse</span>&gt;&gt; <span class="hljs-selector-tag">generateImageAsync</span>(<span class="hljs-variable">@Valid</span> <span class="hljs-variable">@RequestBody</span> ImageRequest request) {
        <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.info</span>(<span class="hljs-string">"æ”¶åˆ°å¼‚æ­¥å›¾ç‰‡ç”Ÿæˆè¯·æ±‚: prompt={}"</span>, request.<span class="hljs-built_in">getPrompt</span>());

        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">CompletableFuture</span><span class="hljs-selector-class">.supplyAsync</span>(() -&gt; {
            <span class="hljs-selector-tag">try</span> {
                <span class="hljs-selector-tag">ImageResponse</span> <span class="hljs-selector-tag">response</span> = <span class="hljs-selector-tag">imageService</span><span class="hljs-selector-class">.generateImage</span>(request);

                <span class="hljs-selector-tag">if</span> (response.<span class="hljs-built_in">getSuccess</span>()) {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(response);
                } <span class="hljs-selector-tag">else</span> {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()<span class="hljs-selector-class">.body</span>(response);
                }
            } <span class="hljs-selector-tag">catch</span> (Exception e) {
                <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"å¼‚æ­¥å›¾ç‰‡ç”Ÿæˆè¯·æ±‚å¤„ç†å¤±è´¥"</span>, e);
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()
                        <span class="hljs-selector-class">.body</span>(ImageResponse.<span class="hljs-built_in">builder</span>()
                                .<span class="hljs-built_in">error</span>(e.<span class="hljs-built_in">getMessage</span>())
                                .<span class="hljs-built_in">success</span>(false)
                                .<span class="hljs-built_in">build</span>());
            }
        });
    }

    <span class="hljs-comment">/**
     * æ‰¹é‡ç”Ÿæˆå›¾ç‰‡
     */</span>
    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/batch"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">CompletableFuture</span>&lt;<span class="hljs-selector-tag">ResponseEntity</span>&lt;<span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ImageResponse</span>&gt;&gt;&gt; <span class="hljs-selector-tag">generateImages</span>(
            <span class="hljs-variable">@Valid</span> <span class="hljs-variable">@RequestBody</span> List&lt;ImageRequest&gt; requests) {

        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">CompletableFuture</span><span class="hljs-selector-class">.supplyAsync</span>(() -&gt; {
            <span class="hljs-selector-tag">try</span> {
                <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ImageResponse</span>&gt; <span class="hljs-selector-tag">responses</span> = <span class="hljs-selector-tag">requests</span><span class="hljs-selector-class">.stream</span>()
                        <span class="hljs-selector-class">.map</span>(<span class="hljs-attribute">imageService</span>::generateImage)
                        <span class="hljs-selector-class">.collect</span>(Collectors.<span class="hljs-built_in">toList</span>());

                <span class="hljs-selector-tag">boolean</span> <span class="hljs-selector-tag">allSuccess</span> = <span class="hljs-selector-tag">responses</span><span class="hljs-selector-class">.stream</span>()<span class="hljs-selector-class">.allMatch</span>(<span class="hljs-attribute">ImageResponse</span>::getSuccess);

                <span class="hljs-selector-tag">if</span> (allSuccess) {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(responses);
                } <span class="hljs-selector-tag">else</span> {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()<span class="hljs-selector-class">.body</span>(responses);
                }
            } <span class="hljs-selector-tag">catch</span> (Exception e) {
                <span class="hljs-selector-tag">log</span><span class="hljs-selector-class">.error</span>(<span class="hljs-string">"æ‰¹é‡å›¾ç‰‡ç”Ÿæˆè¯·æ±‚å¤„ç†å¤±è´¥"</span>, e);
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.internalServerError</span>()
                        <span class="hljs-selector-class">.body</span>(Arrays.<span class="hljs-built_in">asList</span>(ImageResponse.<span class="hljs-built_in">builder</span>()
                                .<span class="hljs-built_in">error</span>(e.<span class="hljs-built_in">getMessage</span>())
                                .<span class="hljs-built_in">success</span>(false)
                                .<span class="hljs-built_in">build</span>()));
            }
        });
    }

    <span class="hljs-comment">/**
     * ç”Ÿæˆç¤ºä¾‹å›¾ç‰‡
     */</span>
    @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/examples"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ResponseEntity</span>&lt;<span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ImageRequest</span>&gt;&gt; <span class="hljs-selector-tag">getExampleRequests</span>() {
        <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">ImageRequest</span>&gt; <span class="hljs-selector-tag">examples</span> = <span class="hljs-selector-tag">Arrays</span><span class="hljs-selector-class">.asList</span>(
                <span class="hljs-built_in">createExampleRequest</span>(<span class="hljs-string">"ä¸€åªå¯çˆ±çš„å¡é€šçŒ«ï¼Œååœ¨èŠ±å›­é‡Œï¼Œé˜³å…‰æ˜åªš"</span>, ImageRequest.ImageSize.S1024X1024, <span class="hljs-number">1</span>, ImageRequest.ImageStyle.VIVID),
                <span class="hljs-built_in">createExampleRequest</span>(<span class="hljs-string">"ç°ä»£åŸå¸‚å¤©é™…çº¿ï¼Œå¤œæ™šï¼Œéœ“è™¹ç¯"</span>, ImageRequest.ImageSize.S1024X1024, <span class="hljs-number">1</span>, ImageRequest.ImageStyle.NATURAL),
                <span class="hljs-built_in">createExampleRequest</span>(<span class="hljs-string">"æŠ½è±¡è‰ºæœ¯ï¼Œå½©è‰²å‡ ä½•å½¢çŠ¶"</span>, ImageRequest.ImageSize.S512X512, <span class="hljs-number">2</span>, ImageRequest.ImageStyle.VIVID)
        );

        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(examples);
    }

    <span class="hljs-comment">/**
     * æ£€æŸ¥æœåŠ¡çŠ¶æ€
     */</span>
    @<span class="hljs-selector-tag">GetMapping</span>(<span class="hljs-string">"/health"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ResponseEntity</span>&lt;<span class="hljs-selector-tag">String</span>&gt; <span class="hljs-selector-tag">healthCheck</span>() {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(<span class="hljs-string">"Image Generation Service is running"</span>);
    }

    <span class="hljs-comment">/**
     * åˆ›å»ºè¯·æ±‚
     */</span>
    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">ImageRequest</span> <span class="hljs-selector-tag">createExampleRequest</span>(String prompt, ImageRequest.ImageSize size, int n, ImageRequest.ImageStyle style) {
        <span class="hljs-selector-tag">ImageRequest</span> <span class="hljs-selector-tag">request</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">ImageRequest</span>();
        <span class="hljs-selector-tag">request</span><span class="hljs-selector-class">.setPrompt</span>(prompt);
        <span class="hljs-selector-tag">request</span><span class="hljs-selector-class">.setSize</span>(size);
        <span class="hljs-selector-tag">request</span><span class="hljs-selector-class">.setN</span>(n);
        <span class="hljs-selector-tag">request</span><span class="hljs-selector-class">.setStyle</span>(style);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">request</span>;
    }
}
</code></pre>
<h2 data-id="heading-11"><strong>OpenAiImageService</strong></h2>
<pre><code class="hljs language-scss" lang="scss">package com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.service</span>;

import com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ApiKeyConfig</span>;
import com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ImageRequest</span>;
import com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.textToImage</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.ImageResponse</span>;
import com<span class="hljs-selector-class">.theokanning</span><span class="hljs-selector-class">.openai</span><span class="hljs-selector-class">.image</span><span class="hljs-selector-class">.CreateImageRequest</span>;
import com<span class="hljs-selector-class">.theokanning</span><span class="hljs-selector-class">.openai</span><span class="hljs-selector-class">.image</span><span class="hljs-selector-class">.ImageResult</span>;
import com<span class="hljs-selector-class">.theokanning</span><span class="hljs-selector-class">.openai</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.OpenAiService</span>;
import lombok<span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.cache</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Cacheable</span>;
import org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.stereotype</span><span class="hljs-selector-class">.Service</span>;

import java<span class="hljs-selector-class">.time</span><span class="hljs-selector-class">.Duration</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Arrays</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Collections</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.List</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.UUID</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">/**
 * OpenAIæ–‡ç”Ÿå›¾æœåŠ¡å®ç°
 *
 * ä½¿ç”¨DALL-E 3/2æ¨¡å‹ç”Ÿæˆå›¾ç‰‡
 * æ”¯æŒå¤šç§å‚æ•°é…ç½®
 */</span>
<span class="hljs-keyword">@Slf</span>4j
<span class="hljs-keyword">@Service</span>
public class OpenAiImageService {

    <span class="hljs-keyword">@Autowired</span>
    private ApiKeyConfig apiKeyConfig;

    <span class="hljs-comment">/**
     * ç”Ÿæˆå›¾ç‰‡
     */</span>
    <span class="hljs-keyword">@Cacheable</span>(value = <span class="hljs-string">"images"</span>, key = <span class="hljs-string">"#request.prompt + '_' + #request.size + '_' + #request.style"</span>)
    public ImageResponse generateImage(ImageRequest request) {
        long startTime = System<span class="hljs-selector-class">.currentTimeMillis</span>();
        String requestId = UUID<span class="hljs-selector-class">.randomUUID</span>()<span class="hljs-selector-class">.toString</span>();

        try {
            <span class="hljs-comment">// åˆ›å»ºOpenAIæœåŠ¡</span>
            OpenAiService service = <span class="hljs-built_in">createOpenAiService</span>();

            <span class="hljs-comment">// æ„å»ºè¯·æ±‚å‚æ•°</span>
            CreateImageRequest imageRequest = <span class="hljs-built_in">buildCreateImageRequest</span>(request);

            <span class="hljs-comment">// è°ƒç”¨APIç”Ÿæˆå›¾ç‰‡</span>
            ImageResult result = service<span class="hljs-selector-class">.createImage</span>(imageRequest);

            <span class="hljs-comment">// æ„å»ºå“åº”</span>
            ImageResponse response = <span class="hljs-built_in">buildResponse</span>(request, requestId, result, startTime);

            log<span class="hljs-selector-class">.info</span>("å›¾ç‰‡ç”ŸæˆæˆåŠŸ: requestId={}, prompt={}", requestId, request.getPrompt());
            return response;

        } catch (Exception e) {
            log<span class="hljs-selector-class">.error</span>("å›¾ç‰‡ç”Ÿæˆå¤±è´¥: requestId={}, prompt={}", requestId, request.getPrompt(), e);
            return <span class="hljs-built_in">buildErrorResponse</span>(requestId, e.getMessage(), startTime);
        }
    }

    <span class="hljs-comment">/**
     * åˆ›å»ºOpenAIæœåŠ¡
     */</span>
    private OpenAiService <span class="hljs-built_in">createOpenAiService</span>() {
        if (apiKeyConfig.getUseProxy() &amp;&amp; apiKeyConfig<span class="hljs-selector-class">.getProxy</span>() != null) {
            <span class="hljs-comment">// ä»£ç†é…ç½®ï¼ˆç¤ºä¾‹ï¼‰</span>
            return new <span class="hljs-built_in">OpenAiService</span>(apiKeyConfig.getOpenaiKey(), Duration<span class="hljs-selector-class">.ofSeconds</span>(apiKeyConfig.getTimeout()));
        } else {
            <span class="hljs-comment">// ç›´æ¥è¿æ¥</span>
            return new <span class="hljs-built_in">OpenAiService</span>(apiKeyConfig.getOpenaiKey(), Duration<span class="hljs-selector-class">.ofSeconds</span>(apiKeyConfig.getTimeout()));
        }
    }

    <span class="hljs-comment">/**
     * æ„å»ºå›¾ç‰‡è¯·æ±‚
     */</span>
    private CreateImageRequest <span class="hljs-built_in">buildCreateImageRequest</span>(ImageRequest request) {
        return CreateImageRequest<span class="hljs-selector-class">.builder</span>()
                <span class="hljs-selector-class">.prompt</span>(request.getPrompt())
                <span class="hljs-selector-class">.n</span>(request.getN())
                <span class="hljs-selector-class">.size</span>(request.getSize()<span class="hljs-selector-class">.getValue</span>())
                <span class="hljs-selector-class">.responseFormat</span>("url")
                <span class="hljs-selector-class">.user</span>(request.getUserId() != null ? request<span class="hljs-selector-class">.getUserId</span>() : <span class="hljs-string">"anonymous"</span>)
                .<span class="hljs-built_in">build</span>();
    }

    <span class="hljs-comment">/**
     * æ„å»ºæˆåŠŸå“åº”
     */</span>
    private ImageResponse <span class="hljs-built_in">buildResponse</span>(ImageRequest request, String requestId,
                                       ImageResult result, long startTime) {
        List&lt;String&gt; urls = Arrays<span class="hljs-selector-class">.asList</span>(result.getData()<span class="hljs-selector-class">.stream</span>()
                <span class="hljs-selector-class">.map</span>(image -&gt; image.getUrl())
                <span class="hljs-selector-class">.toArray</span>(String[]::new));

        List&lt;String&gt; imageIds = Collections<span class="hljs-selector-class">.emptyList</span>(); <span class="hljs-comment">// æš‚æ—¶ä½¿ç”¨ç©ºåˆ—è¡¨</span>

        return ImageResponse<span class="hljs-selector-class">.builder</span>()
                <span class="hljs-selector-class">.requestId</span>(requestId)
                <span class="hljs-selector-class">.prompt</span>(request.getPrompt())
                <span class="hljs-selector-class">.createdAt</span>(java.time.LocalDateTime.now())
                <span class="hljs-selector-class">.urls</span>(urls)
                <span class="hljs-selector-class">.imageIds</span>(imageIds)
                <span class="hljs-selector-class">.duration</span>(System.currentTimeMillis() - startTime)
                <span class="hljs-selector-class">.success</span>(true)
                <span class="hljs-selector-class">.build</span>();
    }

    <span class="hljs-comment">/**
     * æ„å»ºé”™è¯¯å“åº”
     */</span>
    private ImageResponse <span class="hljs-built_in">buildErrorResponse</span>(String requestId, String errorMessage, long startTime) {
        return ImageResponse<span class="hljs-selector-class">.builder</span>()
                <span class="hljs-selector-class">.requestId</span>(requestId)
                <span class="hljs-selector-class">.error</span>(errorMessage)
                <span class="hljs-selector-class">.createdAt</span>(java.time.LocalDateTime.now())
                <span class="hljs-selector-class">.duration</span>(System.currentTimeMillis() - startTime)
                <span class="hljs-selector-class">.success</span>(false)
                <span class="hljs-selector-class">.build</span>();
    }
}
</code></pre>
<h2 data-id="heading-12">å››ã€ä¸šåŠ¡æµç¨‹è¯¦è§£</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0805a9c66498428b80e59e848aa70aaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=T83iGvnktqU8tT1ADDDbTOGRDlo%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-13"><strong>8æ­¥å®Œæ•´æµç¨‹</strong>ï¼š</h2>
<pre><code class="hljs">1ï¸âƒ£ ç”¨æˆ·è¾“å…¥æ–‡æœ¬ï¼šå‰ç«¯æäº¤æ–‡æœ¬æè¿°
2ï¸âƒ£ å‚æ•°éªŒè¯ï¼šæ ¡éªŒå‚æ•°æ ¼å¼å’Œå†…å®¹
3ï¸âƒ£ ç¼“å­˜æŸ¥è¯¢ï¼šæ£€æŸ¥æ˜¯å¦å·²ç”Ÿæˆè¿‡
4ï¸âƒ£ æ„å»ºAPIè¯·æ±‚ï¼šç»„è£…OpenAIè¯·æ±‚
5ï¸âƒ£ è°ƒç”¨OpenAIï¼šå‘é€å›¾ç‰‡ç”Ÿæˆè¯·æ±‚
6ï¸âƒ£ æ¥æ”¶å“åº”ï¼šè·å–å›¾ç‰‡URL
7ï¸âƒ£ å¤„ç†ç»“æœï¼šä¿å­˜åˆ°æ•°æ®åº“
8ï¸âƒ£ è¿”å›å›¾ç‰‡ï¼šå“åº”ç»™ç”¨æˆ·
</code></pre>
<h2 data-id="heading-14">æ—¶åºå›¾</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2caa60ec4ec946d7b19738e5a807eb95~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=5Q5ko1T06kut0cPjPe8Y1ntAsco%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-15"><strong>å…³é”®äº¤äº’æµç¨‹</strong>ï¼š</h2>
<p>å‰ç«¯â†’æ§åˆ¶å™¨ï¼šPOSTè¯·æ±‚</p>
<p>æ§åˆ¶å™¨â†’æœåŠ¡ï¼šå‚æ•°éªŒè¯</p>
<p>æœåŠ¡â†’ç¼“å­˜ï¼šæŸ¥è¯¢ç¼“å­˜</p>
<p>æœåŠ¡â†’OpenAIï¼šAPIè°ƒç”¨</p>
<p>OpenAIâ†’æœåŠ¡ï¼šè¿”å›å›¾ç‰‡URL</p>
<p>æœåŠ¡â†’ç¼“å­˜ï¼šæ›´æ–°ç¼“å­˜</p>
<p>æœåŠ¡â†’æ§åˆ¶å™¨ï¼šè¿”å›å“åº”</p>
<h2 data-id="heading-16">äº”ã€ç¼“å­˜æœºåˆ¶ä¼˜åŒ–</h2>
<h2 data-id="heading-17">å¤šçº§ç¼“å­˜ç­–ç•¥</h2>
<h2 data-id="heading-18">L1 - Caffeineæœ¬åœ°ç¼“å­˜</h2>
<p>è¯»å†™é€Ÿåº¦å¿«ï¼Œé€‚åˆçƒ­ç‚¹æ•°æ®</p>
<p>å‡å°‘ç½‘ç»œè°ƒç”¨</p>
<h2 data-id="heading-19">L2 - Redisåˆ†å¸ƒå¼ç¼“å­˜</h2>
<p>æ”¯æŒé›†ç¾¤ï¼Œå®¹é‡å¤§</p>
<p>é›†ç¾¤ç¯å¢ƒæ•°æ®å…±äº«</p>
<h2 data-id="heading-20">L3 - OpenAI APIç¼“å­˜</h2>
<p>ç¬¬ä¸‰æ–¹æœåŠ¡è‡ªå¸¦ç¼“å­˜</p>
<p>é™ä½APIæˆæœ¬</p>
<h2 data-id="heading-21">Caffeine</h2>
<pre><code class="hljs language-csharp" lang="csharp">package com.example.textToImage.demo;

import com.github.benmanes.caffeine.cache.Cache;
import com.github.benmanes.caffeine.cache.Caffeine;
import com.github.benmanes.caffeine.cache.Expiry;
import org.springframework.stereotype.Component;

import java.util.concurrent.TimeUnit;

<span class="hljs-comment">/**
 * Caffeineç¼“å­˜æ¼”ç¤ºç±»
 *
 * Caffeineç¼“å­˜çš„åŸºæœ¬ç”¨æ³•å’Œé«˜çº§ç‰¹æ€§
 */</span>
@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CaffeineDemo</span> {

    <span class="hljs-comment">/**
     * åˆ›å»ºåŸºç¡€ç¼“å­˜
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Cache</span>&lt;<span class="hljs-title">String</span>, <span class="hljs-title">String</span>&gt; <span class="hljs-title">createBasicCache</span>()</span> {
        <span class="hljs-keyword">return</span> Caffeine.newBuilder()
                .maximumSize(<span class="hljs-number">1000</span>) <span class="hljs-comment">// æœ€å¤§ç¼“å­˜æ•°é‡</span>
                .expireAfterWrite(<span class="hljs-number">1</span>, TimeUnit.HOURS) <span class="hljs-comment">// å†™å…¥å1å°æ—¶è¿‡æœŸ</span>
                .build();
    }

    <span class="hljs-comment">/**
     * å¸¦æœ‰è‡ªå®šä¹‰è¿‡æœŸç­–ç•¥çš„ç¼“å­˜
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Cache</span>&lt;<span class="hljs-title">String</span>, <span class="hljs-title">Object</span>&gt; <span class="hljs-title">createCustomExpiryCache</span>()</span> {
        <span class="hljs-keyword">return</span> Caffeine.newBuilder()
                .expireAfter(<span class="hljs-keyword">new</span> Expiry&lt;String, Object&gt;() {
                    @Override
                    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">long</span> <span class="hljs-title">expireAfterCreate</span>(<span class="hljs-params">String key, Object <span class="hljs-keyword">value</span>, <span class="hljs-built_in">long</span> currentTime</span>)</span> {
                        <span class="hljs-keyword">return</span> TimeUnit.MINUTES.toNanos(<span class="hljs-number">30</span>); <span class="hljs-comment">// åˆ›å»ºå30åˆ†é’Ÿè¿‡æœŸ</span>
                    }

                    @Override
                    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">long</span> <span class="hljs-title">expireAfterUpdate</span>(<span class="hljs-params">String key, Object <span class="hljs-keyword">value</span>, <span class="hljs-built_in">long</span> currentTime, <span class="hljs-built_in">long</span> currentDuration</span>)</span> {
                        <span class="hljs-keyword">return</span> currentDuration; <span class="hljs-comment">// æ›´æ–°æ—¶ä¸é‡ç½®è¿‡æœŸæ—¶é—´</span>
                    }

                    @Override
                    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">long</span> <span class="hljs-title">expireAfterRead</span>(<span class="hljs-params">String key, Object <span class="hljs-keyword">value</span>, <span class="hljs-built_in">long</span> currentTime, <span class="hljs-built_in">long</span> currentDuration</span>)</span> {
                        <span class="hljs-keyword">return</span> currentDuration; <span class="hljs-comment">// è¯»å–æ—¶ä¸é‡ç½®è¿‡æœŸæ—¶é—´</span>
                    }
                })
                .maximumSize(<span class="hljs-number">500</span>)
                .build();
    }

    <span class="hljs-comment">/**
     * å¸¦æœ‰ç»Ÿè®¡ä¿¡æ¯çš„ç¼“å­˜
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Cache&lt;String, String&gt; <span class="hljs-title">createStatsCache</span>()</span> {
        <span class="hljs-keyword">return</span> Caffeine.newBuilder()
                .maximumSize(<span class="hljs-number">1000</span>)
                .recordStats() <span class="hljs-comment">// å¼€å¯ç»Ÿè®¡åŠŸèƒ½</span>
                .expireAfterWrite(<span class="hljs-number">1</span>, TimeUnit.HOURS)
                .build();
    }

    <span class="hljs-comment">/**
     * ç¼“å­˜æ“ä½œ
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">demonstrateCacheOperations</span>()</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"=== Caffeineç¼“å­˜æ¼”ç¤º ==="</span>);

        <span class="hljs-comment">// åˆ›å»ºç¼“å­˜</span>
        Cache&lt;String, String&gt; cache = createBasicCache();

        <span class="hljs-comment">// 1. åŸºæœ¬æ“ä½œ</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\n1. åŸºæœ¬ç¼“å­˜æ“ä½œ:"</span>);

        <span class="hljs-comment">// å­˜å‚¨</span>
        cache.put(<span class="hljs-string">"user:1001"</span>, <span class="hljs-string">"å¼ ä¸‰"</span>);
        cache.put(<span class="hljs-string">"user:1002"</span>, <span class="hljs-string">"æå››"</span>);
        cache.put(<span class="hljs-string">"user:1003"</span>, <span class="hljs-string">"ç‹äº”"</span>);

        <span class="hljs-comment">// è·å–</span>
        String user1 = cache.getIfPresent(<span class="hljs-string">"user:1001"</span>);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"è·å–ç”¨æˆ·1001: "</span> + user1);

        <span class="hljs-comment">// ä½¿ç”¨computeIfAbsentï¼ˆåŸå­æ“ä½œï¼‰</span>
        String user4 = cache.<span class="hljs-keyword">get</span>(<span class="hljs-string">"user:1004"</span>, k -&gt; <span class="hljs-string">"æ–°ç”¨æˆ·"</span> + k.substring(k.lastIndexOf(<span class="hljs-string">":"</span>) + <span class="hljs-number">1</span>));
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"è·å–ç”¨æˆ·1004: "</span> + user4);

        <span class="hljs-comment">// 2. ç»Ÿè®¡ä¿¡æ¯</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\n2. ç¼“å­˜ç»Ÿè®¡:"</span>);
        Cache&lt;String, String&gt; statsCache = createStatsCache();

        <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€äº›æ“ä½œ</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
            statsCache.put(<span class="hljs-string">"key:"</span> + i, <span class="hljs-string">"value:"</span> + i);
        }

        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">50</span>; i++) {
            statsCache.getIfPresent(<span class="hljs-string">"key:"</span> + i);
        }

        <span class="hljs-comment">// æ‰“å°ç»Ÿè®¡ä¿¡æ¯</span>
        com.github.benmanes.caffeine.cache.stats.CacheStats stats = statsCache.stats();
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç¼“å­˜å‘½ä¸­æ¬¡æ•°: "</span> + stats.hitCount());
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç¼“å­˜æœªå‘½ä¸­æ¬¡æ•°: "</span> + stats.missCount());
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç¼“å­˜å‘½ä¸­ç‡: "</span> + stats.hitRate());
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"åŠ è½½æ—¶é—´: "</span> + stats.totalLoadTime() + <span class="hljs-string">" ns"</span>);

        <span class="hljs-comment">// 3. æ‰‹åŠ¨å¤±æ•ˆ</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\n3. ç¼“å­˜å¤±æ•ˆ:"</span>);
        cache.invalidate(<span class="hljs-string">"user:1001"</span>); <span class="hljs-comment">// å•ä¸ªkeyå¤±æ•ˆ</span>
        cache.invalidateAll(); <span class="hljs-comment">// å…¨éƒ¨å¤±æ•ˆ</span>

        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ç¼“å­˜æ¼”ç¤ºå®Œæˆ!"</span>);
    }

    <span class="hljs-comment">/**
     * å›¾ç‰‡ç¼“å­˜åœºæ™¯
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">demonstrateImageCache</span>()</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\n=== å›¾ç‰‡ç¼“å­˜æ¼”ç¤º ==="</span>);

        Cache&lt;String, <span class="hljs-built_in">byte</span>[]&gt; imageCache = Caffeine.newBuilder()
                .maximumSize(<span class="hljs-number">100</span>) <span class="hljs-comment">// ç¼“å­˜100å¼ å›¾ç‰‡</span>
                .maximumWeight(<span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>) <span class="hljs-comment">// æœ€å¤§10MB</span>
                .expireAfterWrite(<span class="hljs-number">24</span>, TimeUnit.HOURS) <span class="hljs-comment">// 24å°æ—¶è¿‡æœŸ</span>
                .build();

        <span class="hljs-comment">// æ¨¡æ‹Ÿå›¾ç‰‡æ•°æ®</span>
        <span class="hljs-built_in">byte</span>[] smallImage = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">50</span> * <span class="hljs-number">1024</span>]; <span class="hljs-comment">// 50KB</span>
        <span class="hljs-built_in">byte</span>[] largeImage = <span class="hljs-keyword">new</span> <span class="hljs-built_in">byte</span>[<span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>]; <span class="hljs-comment">// 2MB</span>

        <span class="hljs-comment">// å­˜å‚¨å›¾ç‰‡</span>
        imageCache.put(<span class="hljs-string">"image:small"</span>, smallImage);
        imageCache.put(<span class="hljs-string">"image:large"</span>, largeImage);

        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å°å›¾ç‰‡ç¼“å­˜çŠ¶æ€: "</span> +
            (imageCache.getIfPresent(<span class="hljs-string">"image:small"</span>) != <span class="hljs-literal">null</span> ? <span class="hljs-string">"å·²ç¼“å­˜"</span> : <span class="hljs-string">"æœªç¼“å­˜"</span>));
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å¤§å›¾ç‰‡ç¼“å­˜çŠ¶æ€: "</span> +
            (imageCache.getIfPresent(<span class="hljs-string">"image:large"</span>) != <span class="hljs-literal">null</span> ? <span class="hljs-string">"å·²ç¼“å­˜"</span> : <span class="hljs-string">"æœªç¼“å­˜"</span>));

        <span class="hljs-comment">// è·å–ç¼“å­˜ç»Ÿè®¡</span>
        com.github.benmanes.caffeine.cache.stats.CacheStats stats = imageCache.stats();
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å›¾ç‰‡ç¼“å­˜å‘½ä¸­ç‡: "</span> + String.format(<span class="hljs-string">"%.2f%%"</span>, stats.hitRate() * <span class="hljs-number">100</span>));
    }
}
</code></pre>
<h2 data-id="heading-22">æ•°æ®æµè½¬</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b40904f168e40d0a82d234f2f1c85d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=sokObZi%2FIcvu5uom26rRt4gDaEU%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-23"><strong>æ™ºèƒ½ç¼“å­˜æŸ¥è¯¢æµç¨‹</strong>ï¼š</h2>
<pre><code class="hljs">1ã€ç”¨æˆ·å‘èµ·è¯·æ±‚
2ã€éªŒè¯å¹¶æŸ¥è¯¢ç¼“å­˜
3ã€ç¼“å­˜æœªå‘½ä¸­è°ƒç”¨API
4ã€OpenAIç”Ÿæˆå›¾ç‰‡
5ã€å¤„ç†ç»“æœå¹¶ç¼“å­˜
6ã€è¿”å›ç»“æœç»™ç”¨æˆ·
</code></pre>
<h2 data-id="heading-24">å…­ã€æ€§èƒ½ä¼˜åŒ–ä¸éƒ¨ç½²</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e20de3c3a4d44566993e0949d237dc71~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769148824&amp;x-signature=QCo8%2Fedj%2BFofoXqJgW4SjfNJA30%3D" alt="éƒ¨ç½²å›¾.png" loading="lazy"/></p>
<h2 data-id="heading-25">JVMå‚æ•°ä¼˜åŒ–</h2>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-deletion">-Xms2g -Xmx4gÂ </span>
<span class="hljs-deletion">-XX:+UseG1GCÂ </span>
<span class="hljs-deletion">-XX:MaxGCPauseMillis=200</span>
</code></pre>
<h2 data-id="heading-26">å¼‚æ­¥å¤„ç†é…ç½®</h2>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Configuration</span>
<span class="hljs-variable">@EnableAsync</span>
publicÂ classÂ AsyncConfigÂ {
Â  Â Â <span class="hljs-variable">@Bean</span>
Â  Â Â publicÂ ExecutorÂ <span class="hljs-built_in">taskExecutor</span>() {
Â  Â  Â  Â Â <span class="hljs-selector-tag">ThreadPoolTaskExecutor</span>Â <span class="hljs-selector-tag">executor</span> =Â 
Â  Â  Â  Â  Â  Â Â <span class="hljs-selector-tag">new</span>Â <span class="hljs-selector-tag">ThreadPoolTaskExecutor</span>();
Â  Â  Â  Â  <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setCorePoolSize</span>(<span class="hljs-number">5</span>);
Â  Â  Â  Â  <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setMaxPoolSize</span>(<span class="hljs-number">20</span>);
Â  Â  Â  Â  <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setQueueCapacity</span>(<span class="hljs-number">100</span>);
Â  Â  Â  Â Â <span class="hljs-selector-tag">return</span>Â <span class="hljs-selector-tag">executor</span>;
Â  Â  }
}
</code></pre>
<h2 data-id="heading-27">ä¸ƒã€æ€»ç»“</h2>
<h2 data-id="heading-28">å¤šæ¨¡æ€èåˆ</h2>
<pre><code class="hljs">æ–‡+å›¾â†’å›¾
å›¾+å›¾â†’è§†é¢‘
AR/VRå†…å®¹ç”Ÿæˆ
</code></pre>
<h2 data-id="heading-29">æœ¬åœ°åŒ–éƒ¨ç½²</h2>
<pre><code class="hljs">æ¨¡å‹å°å‹åŒ–
æ¨ç†ä¼˜åŒ–
æˆæœ¬å¯æ§
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ArcGIS Pro å®ç°å½±åƒæ³¢æ®µåˆæˆ]]></title>    <link>https://juejin.cn/post/7595878718171496484</link>    <guid>https://juejin.cn/post/7595878718171496484</guid>    <pubDate>2026-01-17T07:17:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718171496484" data-draft-id="7595878718171447332" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ArcGIS Pro å®ç°å½±åƒæ³¢æ®µåˆæˆ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T07:17:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="GISä¹‹è·¯"/> <meta itemprop="url" content="https://juejin.cn/user/4346787284915481"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ArcGIS Pro å®ç°å½±åƒæ³¢æ®µåˆæˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4346787284915481/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    GISä¹‹è·¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:17:49.000Z" title="Sat Jan 17 2026 07:17:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">^Â å…³æ³¨æˆ‘ï¼Œå¸¦ä½ ä¸€èµ·å­¦GISÂ ^</h2>
<h2 data-id="heading-1">å‰è¨€</h2>
<blockquote>
<p>â</p>
<p>é€šå¸¸ï¼Œæˆ‘ä»¬ä¸‹è½½çš„å«æ˜Ÿå½±åƒæ•°æ®æ¯ä¸ªæ³¢æ®µéƒ½å­˜åœ¨ä¸€ä¸ªå•ç‹¬çš„æ³¢æ®µä¸­ï¼Œä½†æ˜¯åœ¨ç”Ÿäº§å®è·µä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ç”±å„ä¸ªæ³¢æ®µç»„æˆçš„å®Œæ•´æ•°æ®é›†ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è¿›è¡Œæ³¢æ®µåˆæˆæ“ä½œã€‚</p>
</blockquote>
<p>æœ¬èŠ‚ä¸»è¦è®²è§£å¦‚ä½•åœ¨<code>ArcGIS Pro</code>ä¸­å®ç°TIFFå½±åƒæ³¢æ®µåˆæˆã€‚</p>
<h2 data-id="heading-2">1. è½¯ä»¶ç¯å¢ƒ</h2>
<p>æœ¬æ–‡ä½¿ç”¨ä»¥ä¸‹è½¯ä»¶ç¯å¢ƒï¼Œä»…ä¾›å‚è€ƒã€‚</p>
<p>æ—¶é—´ï¼š2026 å¹´</p>
<p>æ“ä½œè½¯ä»¶ï¼šArcGIS Pro 3.5</p>
<p>æ“ä½œç³»ç»Ÿï¼šwindows 11</p>
<h2 data-id="heading-3">2. ä¸‹è½½å«æ˜Ÿå½±åƒæ•°æ®</h2>
<p>ä¿—è¯è¯´å·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šï¼Œæ•°æ®å°±æ˜¯è½¯ä»¶çš„åŸºçŸ³ï¼Œæ²¡æœ‰æ•°æ®ï¼Œå†ç¾å¥½çš„è®¾æƒ³éƒ½æ˜¯ç©ºä¸­æ¥¼é˜ã€‚å› æ­¤ï¼Œç¬¬ä¸€æ­¥éœ€è¦ä¸‹è½½é¥æ„Ÿå½±åƒæ•°æ®ã€‚</p>
<p>ä½†æ˜¯ï¼Œå½±åƒæ•°æ®åœ¨å“ªé‡Œä¸‹è½½å‘¢ï¼Ÿåˆ«ç€æ€¥ï¼Œæœ¬æ–‡éƒ½ç»™ä½ æ•´ç†å¥½äº†ã€‚</p>
<p>æ•°æ®ä¸‹è½½å¯å‚è€ƒæ–‡ç« ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F5c_J7f0xkUXEv7_z0eNweQ" target="_blank" title="https://mp.weixin.qq.com/s/5c_J7f0xkUXEv7_z0eNweQ" ref="nofollow noopener noreferrer">GIS å½±åƒæ•°æ®æºä»‹ç»</a></strong></p>
<hr/>
<p>å¦‚ä¸‹ï¼Œè¿™æ˜¯æˆ‘åœ¨ã€åœ°ç†ç©ºé—´æ•°æ®äº‘ã€‘å¹³å°ä¸‹è½½çš„<code>landsat8</code>é¥æ„Ÿå½±åƒã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d84b92a0b40d4034963934177df1a031~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=of2Fly6Jshn0NSPXuxWzZhYbV80%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">3. ArcGIS Pro è½¯ä»¶å®‰è£…</h2>
<p>è¦æƒ³ä½¿ç”¨<code>ArcGIS Pro</code>å®ç°å½±åƒæ³¢æ®µåˆæˆï¼Œé‚£ä½ å¾—å®‰è£…å¥½<code>ArcGIS Pro</code>è½¯ä»¶ã€‚</p>
<p>ä½†æ˜¯ï¼Œè½¯ä»¶å®‰è£…è¯´æ˜ä¸åœ¨æœ¬æ–‡çš„æ•™ç¨‹ä¹‹å†…ï¼Œå°±ä¸è¿›è¡Œä»‹ç»äº†ï¼Œè¯·æœªå®‰è£…çš„åŒå­¦è‡ªè¡Œè§£å†³ã€‚</p>
<h2 data-id="heading-5">4. æ³¢æ®µåˆæˆ</h2>
<p>å¥½äº†ï¼Œç»è¿‡ä¸Šé¢ä¸€å †åºŸè¯ï¼Œä¸‹é¢æ­£å¼è¿›å…¥ä¸»é¢˜ï¼Œè¿›è¡Œå®æ“ã€‚</p>
<p>å¦‚æœæœ‰è¿‡<code>ArcGIS</code>ç‰ˆæœ¬è½¯ä»¶åŸºç¡€çš„åŒå­¦ï¼Œå¯ä»¥å¾ˆå¿«å®Œæˆï¼Œå› ä¸º<code>ArcGIS Pro</code>å’Œ<code>ArcGIS</code>çš„å·¥å…·è®¾ç½®å¤§ä½“ç›¸åŒã€‚</p>
<p>æˆ‘ä»¬é¦–å…ˆéœ€è¦æ‰¾åˆ°æ•°æ®å¤„ç†å·¥å…·ç®±ã€‚ç‚¹å‡»èœå•æ åˆ†ææŒ‰é’®<code>Analysis</code>ï¼Œç„¶åå†ç‚¹å‡»å·¥å…·<code>Tools</code><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f7c8076dc07845479102d90dd17d308a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=OSDuOcG9NRBTxxGad5f1WlZlJ4U%3D" alt="" loading="lazy"/></p>
<p>æˆ–è€…ç‚¹å‡»è½¯ä»¶æœç´¢æ¡†ä¸­ï¼Œå…¶ä¸­ä¼šå‡ºç°æ¨èçš„åœ°ç†å¤„ç†å·¥å…·ç®±ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5fff6d3407a4e3fb2f8374db9359252~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=X%2Fx9moBCXTD6c%2FQQoVqsTsQ%2BLPs%3D" alt="" loading="lazy"/></p>
<p>æ‰“å¼€å·¥å…·ä¹‹åï¼Œç‚¹å‡»æ•°æ®æ•°æ®å¤„ç†å·¥å…·<code>Data Management Tools</code>ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f1b3e6e05dec4467bd3e8cc4b681b24d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=iebeNhWxQ7lVOPMgrOmx7O72sG0%3D" alt="" loading="lazy"/></p>
<p>ç„¶åä¾æ¬¡ç‚¹å‡»æ …æ ¼<code>Raster</code>ã€æ …æ ¼å¤„ç†<code>Raster Processing</code>ã€æ³¢æ®µåˆæˆ<code>Composite Bands</code>å³å¯ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8f510cb90a704b508a978116ba2ef779~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=AG0UNLFjvlcGr5GK9ZclORqIJYI%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœä½ è§‰å¾—ä¸Šè¿°æ“ä½œè·¯å¾„å¤ªé•¿ï¼Œæˆ–è€…ä½ ç†Ÿæ‚‰æ“ä½œå·¥å…·åç§°çš„è¯ï¼Œå¯ä»¥ç›´æ¥åœ¨é¡µé¢é¡¶éƒ¨æœç´¢æ¡†è¾“å…¥å·¥å…·åç§°<code>Composite Bands</code>è¿›è¡Œæ£€ç´¢ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ec6b42d3a9c24b4084223de64da05b7c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=flCgGSeanif6XunNBJTROOpdmpk%3D" alt="" loading="lazy"/>åˆæˆ–è€…åœ¨åœ°ç†å¤„ç†æœç´¢æ¡†è¾“å…¥å·¥å…·åç§°<code>Composite Bands</code>è¿›è¡Œæ£€ç´¢ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8b25223e45d456ca4e3abab70ecb9ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=uewFzBIH4aBse9eAYUXx0R5GtOw%3D" alt="" loading="lazy"/></p>
<p>æ‰“å¼€æ³¢æ®µåˆæˆå·¥å…·ï¼Œå…ˆåœ¨è¾“å…¥æ …æ ¼ä¸­é€‰æ‹©éœ€è¦è¿›è¡Œåˆæˆçš„æ³¢æ®µæ•°æ®ï¼Œç„¶åé€‰æ‹©è¾“å‡ºä½ç½®ï¼Œæœ€åç‚¹å‡»è¿è¡Œã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89bacb94e89a4131ab6db1d68c3a1f2b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=usZeSG6NRqEdp5fd4rzI5%2B8nnyQ%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä¸‹ä¸ºæ³¢æ®µ4ã€æ³¢æ®µ3ã€æ³¢æ®µ2åˆæˆçš„å½©è‰²æ•ˆæœå›¾ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/34917ce015fd4ce5ade7870358129a15~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=MNASd9tuC3QJLLRCmt16Popl%2FCQ%3D" alt="" loading="lazy"/></p>
<p>å¦‚ä¸‹ä¸ºæ³¢æ®µ5ã€æ³¢æ®µ4ã€æ³¢æ®µ3åˆæˆçš„å½©è‰²æ•ˆæœå›¾ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3587d067d40a452a861ee370223a94fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=M7mI4xsjsA1YzXz9QXb1%2BHchzoA%3D" alt="" loading="lazy"/></p>
<p>å¯åœ¨å±æ€§ä¸­æŸ¥çœ‹æºæ•°æ®ä¿¡æ¯ï¼Œå…¶ä¸­ä¸‰ä¸ªæ³¢æ®µæ˜¾ç¤ºå¦‚ä¸‹ã€‚<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/443efe33146949759ecf91f538658ada~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=W0KAGiPSKV0nywM84wscE6SFm%2FY%3D" alt="" loading="lazy"/></p>
<p><strong><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a464e74f3dd1474297f5c6b912c7c142~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=DrwtKbkVjkCn%2BWP5e32RMwsFZAs%3D" alt="" loading="lazy"/></strong></p>
<blockquote>
<p>â</p>
<p>OpenLayersç¤ºä¾‹æ•°æ®ä¸‹è½½ï¼Œè¯·åœ¨å…¬ä¼—å·åå°å›å¤ï¼š<strong>olæ•°æ®</strong></p>
<p>å…¨å›½ä¿¡æ¯åŒ–å·¥ç¨‹å¸ˆï¼GIS åº”ç”¨æ°´å¹³è€ƒè¯•èµ„æ–™ï¼Œè¯·åœ¨å…¬ä¼—å·åå°å›å¤ï¼š<strong>GISè€ƒè¯•</strong></p>
</blockquote>
<blockquote>
<p>â</p>
<p><em><strong>GISä¹‹è·¯</strong></em> å…¬ä¼—å·å·²ç»æ¥å…¥äº†<strong>æ™ºèƒ½</strong> <strong>åŠ©æ‰‹</strong>ï¼Œå¯ä»¥åœ¨å¯¹è¯æ¡†è¿›è¡Œæé—®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æœç´¢å†å²æ–‡ç« è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
</blockquote>
<p>éƒ½çœ‹åˆ°è¿™äº†ï¼Œä¸è¦å¿˜è®°<em><strong>ç‚¹èµã€æ”¶è—</strong></em> <strong>+</strong> <em><strong>å…³æ³¨</strong></em> å“¦ <strong>ï¼</strong></p>
<p>æœ¬å·ä¸å®šæ—¶æ›´æ–°æœ‰å…³Â <em><strong>GISå¼€å‘</strong></em> ç›¸å…³å†…å®¹ï¼Œ<em><strong>æ¬¢è¿å…³æ³¨Â <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/98fb3fd9bb7a4811aea7749e685e59ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=xDF%2Bixl%2FX68BrkFtZzyeGWri1zs%3D" alt="" loading="lazy"/><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/73ee6be123244a598088074583d02a14~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=2D81qCPIatgudDFCfp6FwhehdK4%3D" alt="" loading="lazy"/></strong></em></p>
<hr/>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7df248a6f1614c67a274cebeaad1fd51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=aQ2DqpsmJynDTpbZt5kktnADd2g%3D" alt="" loading="lazy"/></p>
<p>Â  Â <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca3c1964cf644a608241df989ebf3ed7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgR0lT5LmL6Lev:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769239069&amp;x-signature=zzPiuq4%2BaowJ0pxpdjAM1Gx%2FwNA%3D" alt="" loading="lazy"/>Â </p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwOTEzNjI5NQ%3D%3D%26mid%3D2247487953%26idx%3D1%26sn%3D0b2d5aeefdb290583cf8cdd82f3c2077%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwOTEzNjI5NQ==&amp;mid=2247487953&amp;idx=1&amp;sn=0b2d5aeefdb290583cf8cdd82f3c2077&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">GeoTools å¼€å‘åˆé›†ï¼ˆå…¨ï¼‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzkwOTEzNjI5NQ%3D%3D%26mid%3D2247487119%26idx%3D1%26sn%3Dc313efa84c27bf933ef2f2a47991ef2d%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzkwOTEzNjI5NQ==&amp;mid=2247487119&amp;idx=1&amp;sn=c313efa84c27bf933ef2f2a47991ef2d&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">OpenLayers å¼€å‘åˆé›†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FwkHv2NnJfuPhtyjJcFLrEQ" target="_blank" title="https://mp.weixin.qq.com/s/wkHv2NnJfuPhtyjJcFLrEQ" ref="nofollow noopener noreferrer">GDAL å®ç°çŸ¢é‡æ•°æ®è½¬æ¢å¤„ç†ï¼ˆå…¨ï¼‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FMZIQ57Ka3NQfKFi9AuEQEg" target="_blank" title="https://mp.weixin.qq.com/s/MZIQ57Ka3NQfKFi9AuEQEg" ref="nofollow noopener noreferrer">GDAL å®ç°æŠ•å½±è½¬æ¢</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FQVFiW5C5wXQ6a1WODCaH0g" target="_blank" title="https://mp.weixin.qq.com/s/QVFiW5C5wXQ6a1WODCaH0g" ref="nofollow noopener noreferrer">è‡ªç„¶èµ„æºéƒ¨å…šç»„å…³äºè‹—æ³½ç­‰4ååŒå¿—èŒåŠ¡ä»»å…çš„é€šçŸ¥</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FSX2u2ww1iNOtqR5m3BE93g" target="_blank" title="https://mp.weixin.qq.com/s/SX2u2ww1iNOtqR5m3BE93g" ref="nofollow noopener noreferrer">å›½äº§ç‰ˆçš„Google Earthï¼Œå‰æ—ä¸€å·å«æ˜ŸAppâ€œå…±ç”Ÿåœ°çƒâ€æ¥äº†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FfWufqSyplniNj4Q3BRRbAQ" target="_blank" title="https://mp.weixin.qq.com/s/fWufqSyplniNj4Q3BRRbAQ" ref="nofollow noopener noreferrer">2026å¹´å…¨å›½è‡ªç„¶èµ„æºå·¥ä½œä¼šè®®å¬å¼€</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FRq7mCSrKU7DA7WRGDEy6Cg" target="_blank" title="https://mp.weixin.qq.com/s/Rq7mCSrKU7DA7WRGDEy6Cg" ref="nofollow noopener noreferrer">æ—¥æœ¬æ¬²æ‰“é€ â€œæœ¬åœŸç‰ˆâ€æ˜Ÿé“¾ç³»ç»Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FEqpOD--IdOUO6gyzwBc6RA" target="_blank" title="https://mp.weixin.qq.com/s/EqpOD--IdOUO6gyzwBc6RA" ref="nofollow noopener noreferrer">å‰æ—ä¸€å·å›½å†…é¦–å¼ é«˜åˆ†è¾¨ç‡å½©è‰²å¤œå…‰å«æ˜Ÿå½±åƒå‘å¸ƒ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FznfhqB1_3JbQHG7CEqWSCw" target="_blank" title="https://mp.weixin.qq.com/s/znfhqB1_3JbQHG7CEqWSCw" ref="nofollow noopener noreferrer">2025 å¹´åº¦ä¿¡åˆ›é¢†å†›ä¼ä¸šåå•å‡ºç‚‰ï¼</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½ çš„æ‰‹åŠ¿å†²çªè§£å†³äº†å—ï¼Ÿé¸¿è’™äº‹ä»¶æ‹¦æˆªæœºåˆ¶å…¨è§£æ]]></title>    <link>https://juejin.cn/post/7595552420047568939</link>    <guid>https://juejin.cn/post/7595552420047568939</guid>    <pubDate>2026-01-16T08:00:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595552420047568939" data-draft-id="7595552420047552555" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½ çš„æ‰‹åŠ¿å†²çªè§£å†³äº†å—ï¼Ÿé¸¿è’™äº‹ä»¶æ‹¦æˆªæœºåˆ¶å…¨è§£æ"/> <meta itemprop="keywords" content="HarmonyOS,ArkTS,ArkUI"/> <meta itemprop="datePublished" content="2026-01-16T08:00:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¨å“¥çˆ±ç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/2242659450109575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½ çš„æ‰‹åŠ¿å†²çªè§£å†³äº†å—ï¼Ÿé¸¿è’™äº‹ä»¶æ‹¦æˆªæœºåˆ¶å…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2242659450109575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¨å“¥çˆ±ç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T08:00:04.000Z" title="Fri Jan 16 2026 08:00:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å“ˆå–½ï¼Œå…„å¼Ÿä»¬ï¼Œæˆ‘æ˜¯ V å“¥ï¼
åœ¨é¸¿è’™å¼€å‘ä¸­ï¼Œå°¤å…¶æ˜¯åšå¤æ‚çš„äº¤äº’é¡µé¢ï¼ˆæ¯”å¦‚<strong>åˆ—è¡¨é‡Œå¥—æŒ‰é’®</strong>ã€<strong>æ¨ªæ»‘èœå•</strong>ã€<strong>åœ°å›¾ç¼©æ”¾</strong>ï¼‰æ—¶ï¼Œæ‰‹åŠ¿äº‹ä»¶å°±åƒæ˜¯ä¸€ç¾¤è°ƒçš®çš„å­©å­ï¼Œè°éƒ½æƒ³æŠ¢ç€æ¥ç›˜ã€‚å¦‚æœä½ ä¸ç®¡å¥½ä»–ä»¬ï¼ŒAppçš„ä½“éªŒä¼šå·®å¼ºäººæ„ã€‚</p>
<p>å…³äºé¸¿è’™API 21 çš„äº‹ä»¶æ‹¦æˆªæœºåˆ¶ã€‚è¿™ä¸‰æ‹›ï¼Œä¸“æ²»å„ç§â€œä¹±è·³â€ã€â€œè¯¯è§¦â€å’Œâ€œæ»‘åŠ¨å¤±æ•ˆâ€ã€‚ä»£ç æˆ‘éƒ½ç»™ä½ å†™å¥½äº†ï¼Œç›´æ¥å¤åˆ¶å°±èƒ½æ²»å¥½ä½ çš„ Appï¼</p>
<hr/>
<h2 data-id="heading-0">ç—›ç‚¹ä¸€ï¼šç‚¹å‡»å†’æ³¡ â€”â€” â€œæˆ‘ç‚¹çš„æŒ‰é’®ï¼Œä½ å…³åˆ—è¡¨ä»€ä¹ˆäº‹ï¼Ÿâ€</h2>
<h3 data-id="heading-1">ğŸ“œ æ¡ˆå‘ç°åœº</h3>
<p>æœ€å¸¸è§çš„åœºæ™¯ï¼šä¸€ä¸ª <code>ListItem</code> æœ¬èº«æ˜¯å¯ä»¥ç‚¹å‡»è·³è½¬è¯¦æƒ…çš„ï¼Œä½†é‡Œé¢æœ‰ä¸€ä¸ªâ€œåˆ é™¤â€æŒ‰é’®ã€‚
ç”¨æˆ·æƒ³ç‚¹åˆ é™¤ï¼Œç»“æœæ‰‹æŒ‡ç¨å¾®åäº†ä¸€ç‚¹ç‚¹ï¼Œæˆ–è€…ç³»ç»Ÿåˆ¤å®šå¤±è¯¯ï¼Œä¸ä»…åˆ é™¤äº†æ•°æ®ï¼Œè¿˜é¡ºæ‰‹è·³åˆ°äº†è¯¦æƒ…é¡µã€‚ç”¨æˆ·ä½“éªŒæå…¶ç³Ÿç³•ã€‚</p>
<h3 data-id="heading-2">ğŸ” åŸç†å‰–æ</h3>
<p>è¿™æ˜¯å…¸å‹çš„<strong>äº‹ä»¶å†’æ³¡</strong>ã€‚è§¦æ‘¸äº‹ä»¶ä»å­ç»„ä»¶ï¼ˆæŒ‰é’®ï¼‰ä¼ é€’åˆ°çˆ¶ç»„ä»¶ï¼ˆåˆ—è¡¨é¡¹ï¼‰ã€‚å­ç»„ä»¶å¤„ç†å®Œäº†ï¼Œå¦‚æœæ²¡è¯´â€œåˆ«ä¼ äº†â€ï¼Œçˆ¶ç»„ä»¶å°±ä¼šè§‰å¾—ï¼šâ€œå“¦ï¼Ÿæœ‰äººç‚¹äº†æˆ‘çš„åœ°ç›˜ï¼Ÿé‚£æˆ‘ä¹Ÿå“åº”ä¸€ä¸‹å§ã€‚â€</p>
<h3 data-id="heading-3">âœ… V å“¥çš„ä¸€æ‹›åˆ¶æ•Œï¼šhitTestBehavior</h3>
<p>æˆ‘ä»¬è¦åšçš„å°±æ˜¯ï¼š<strong>ç»™å­ç»„ä»¶ï¼ˆæŒ‰é’®ï¼‰è®¾ä¸ªâ€œè·¯éšœâ€ï¼Œå‘Šè¯‰çˆ¶ç»„ä»¶ï¼šè¿™äº‹æˆ‘åŠäº†ï¼Œä½ åˆ«æ’æ‰‹ï¼</strong></p>
<hr/>
<h2 data-id="heading-4">ç—›ç‚¹äºŒï¼šæ»‘åŠ¨æ‰“æ¶ â€”â€” â€œæˆ‘æƒ³æ¨ªæ»‘ï¼Œä½ éè¦ç«–ç€æ»šï¼Ÿâ€</h2>
<h3 data-id="heading-5">ğŸ“œ æ¡ˆå‘ç°åœº</h3>
<p>ä½ åœ¨åšä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨ï¼Œè¿›åº¦æ¡æ”¯æŒæ¨ªå‘æ‹–åŠ¨ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªæ’­æ”¾å™¨æ˜¯æ”¾åœ¨ä¸€ä¸ª <code>Scroll</code>ï¼ˆå‚ç›´æ»šåŠ¨ï¼‰å®¹å™¨é‡Œçš„ã€‚
å½“ä½ æƒ³æ‹–åŠ¨è¿›åº¦æ¡æ—¶ï¼Œæ‰‹æŒ‡ç¨å¾®å¸¦ç‚¹å‚ç›´è§’åº¦ï¼Œé¡µé¢å°±å¼€å§‹ä¸Šä¸‹æ»šåŠ¨ï¼Œè¿›åº¦æ¡æ ¹æœ¬æ‹–ä¸åŠ¨ã€‚</p>
<h3 data-id="heading-6">ğŸ” åŸç†å‰–æ</h3>
<p>çˆ¶å®¹å™¨çš„ <code>VerticalScroll</code>ï¼ˆå‚ç›´æ»šåŠ¨æ‰‹åŠ¿ï¼‰å’Œå­ç»„ä»¶çš„ <code>PanGesture</code>ï¼ˆæ‹–åŠ¨æ‰‹åŠ¿ï¼‰å‘ç”Ÿäº†<strong>ç«äº‰</strong>ã€‚ç³»ç»Ÿä¸çŸ¥é“ä½ æ˜¯æƒ³åˆ‡æ­Œè¿˜æ˜¯æƒ³çœ‹æ­Œè¯ã€‚</p>
<h3 data-id="heading-7">âœ… V å“¥çš„ä¸€æ‹›åˆ¶æ•Œï¼šPanGesture &amp; ParallelGesture</h3>
<p>æˆ‘ä»¬éœ€è¦ç²¾ç»†åŒ–æ§åˆ¶æ‰‹åŠ¿çš„<strong>æ–¹å‘</strong>å’Œ<strong>å¹¶å‘æ¨¡å¼</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-8">ä»£ç æ¡ˆä¾‹</h2>
<p>æˆ‘ä»¬æ‰“å¼€ DevEco Studio 6.0ï¼Œæ–°å»ºä¸€ä¸ªé¡µé¢ <code>GestureDemo.ets</code>ã€‚è¿™æ®µä»£ç åŒ…å«äº†ä¸Šé¢ä¸¤ä¸ªé—®é¢˜çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼Œè·‘ä¸€éä½ å°±å…¨æ‡‚äº†ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> promptAction <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.promptAction'</span>;

<span class="hljs-meta">@Entry</span>
<span class="hljs-meta">@Component</span>
struct <span class="hljs-title class_">GestureDemo</span> {
  <span class="hljs-meta">@State</span> <span class="hljs-attr">deleteLog</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'æ“ä½œæ—¥å¿—ï¼šç­‰å¾…æ“ä½œ...'</span>;

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-title class_">Column</span>() {
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Vå“¥çš„æ‰‹åŠ¿å†²çªè¯Šç–—å®¤'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)
        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">20</span> })

      <span class="hljs-comment">// ==========================================</span>
      <span class="hljs-comment">// åœºæ™¯ä¸€ï¼šç‚¹å‡»å†²çªï¼ˆå†’æ³¡é—®é¢˜ï¼‰</span>
      <span class="hljs-comment">// ==========================================</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'åœºæ™¯1ï¼šåˆ—è¡¨é¡¹ç‚¹å‡» vs æŒ‰é’®ç‚¹å‡»'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#666'</span>)

      <span class="hljs-comment">// æ¨¡æ‹Ÿä¸€ä¸ªåˆ—è¡¨é¡¹</span>
      <span class="hljs-title class_">Row</span>() {
        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Vå“¥çš„é¸¿è’™å®æˆ˜æ•™ç¨‹.mp4'</span>)
          .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)
        
        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'åˆ é™¤'</span>)
          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)
          .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span> })
          <span class="hljs-comment">// --- Vå“¥çš„å…³é”®ç¥æŠ€ ---</span>
          <span class="hljs-comment">// HitTestMode.Block è¡¨ç¤ºï¼šæˆ‘ï¼ˆæŒ‰é’®ï¼‰æ˜¯æŒ¡ç®­ç‰Œã€‚</span>
          <span class="hljs-comment">// åªè¦ç‚¹å‡»è½åœ¨æŒ‰é’®åŒºåŸŸï¼Œå°±ç”±æˆ‘å¤„ç†ï¼Œç»ä¸ä¼ ç»™çˆ¶ç»„ä»¶ Rowã€‚</span>
          <span class="hljs-comment">// è¿™æ ·çˆ¶ç»„ä»¶çš„ onClick å°±ä¸ä¼šè¢«è¯¯è§¦äº†ï¼</span>
          .<span class="hljs-title function_">hitTestBehavior</span>(<span class="hljs-title class_">HitTestMode</span>.<span class="hljs-property">Block</span>)
          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteLog</span> = <span class="hljs-string">'ğŸ”¥ æ“ä½œï¼šç‚¹å‡»äº†ã€åˆ é™¤ã€‘æŒ‰é’®ï¼ˆçˆ¶ç»„ä»¶è¢«æ‹¦æˆªï¼‰'</span>;
            promptAction.<span class="hljs-title function_">showToast</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'åˆ é™¤æˆåŠŸï¼'</span> });
          })
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">padding</span>(<span class="hljs-number">15</span>)
      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)
      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">8</span>)
      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">20</span> })
      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// ç‚¹å‡» Row çš„ç©ºç™½å¤„ä¼šè§¦å‘è¿™é‡Œï¼Œä½†ç‚¹æŒ‰é’®ä¸ä¼š</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteLog</span> = <span class="hljs-string">'ğŸ“– æ“ä½œï¼šç‚¹å‡»äº†ã€åˆ—è¡¨é¡¹ã€‘ï¼Œåº”è¯¥è·³è½¬è¯¦æƒ…'</span>;
      })

      <span class="hljs-comment">// ==========================================</span>
      <span class="hljs-comment">// åœºæ™¯äºŒï¼šæ»‘åŠ¨å†²çªï¼ˆçºµæ¨ªé—®é¢˜ï¼‰</span>
      <span class="hljs-comment">// ==========================================</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'åœºæ™¯2ï¼šç«–å‘æ»šåŠ¨ vs æ¨ªå‘æ‹–æ‹½'</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#666'</span>)

      <span class="hljs-comment">// å¤–å±‚ï¼šç«–å‘æ»šåŠ¨å®¹å™¨</span>
      <span class="hljs-title class_">Scroll</span>() {
        <span class="hljs-title class_">Column</span>() {
          <span class="hljs-title class_">Text</span>(<span class="hljs-string">'è¿™æ˜¯é¡¶éƒ¨å†…å®¹'</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>)

          <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºæ¨ªå‘æ‹–æ‹½çš„åŒºåŸŸ</span>
          <span class="hljs-title class_">Row</span>() {
            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'æ‹–åŠ¨æˆ‘ -&gt; '</span>)
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
            <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">toString</span>())
              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)
          }
          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)
          .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)
          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Orange</span>)
          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">8</span>)
          .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)
          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })
          <span class="hljs-comment">// --- Vå“¥çš„å…³é”®ç¥æŠ€ ---</span>
          <span class="hljs-comment">// 1. å®šä¹‰ä¸€ä¸ªæ¨ªå‘æ‹–åŠ¨æ‰‹åŠ¿</span>
          .<span class="hljs-title function_">gesture</span>(
            <span class="hljs-title class_">PanGesture</span>({ <span class="hljs-attr">direction</span>: <span class="hljs-title class_">PanDirection</span>.<span class="hljs-property">Horizontal</span> })
              .<span class="hljs-title function_">onActionStart</span>(<span class="hljs-function">() =&gt;</span> {
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteLog</span> = <span class="hljs-string">'ğŸ¤š æ“ä½œï¼šå¼€å§‹ã€æ¨ªå‘ã€‘æ‹–æ‹½'</span>;
              })
              .<span class="hljs-title function_">onActionUpdate</span>(<span class="hljs-function">(<span class="hljs-params">event: GestureEvent</span>) =&gt;</span> {
                <span class="hljs-comment">// Vå“¥æ¼”ç¤ºï¼šç®€å•ç´¯åŠ ä¸€ä¸‹åç§»é‡</span>
                <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> += event.<span class="hljs-property">offsetX</span>;
              })
          )

          <span class="hljs-title class_">Text</span>(<span class="hljs-string">'è¿™æ˜¯åº•éƒ¨å†…å®¹ï¼Œå¤šæ’‘å¼€ç‚¹é«˜åº¦'</span>)
            .<span class="hljs-title function_">height</span>(<span class="hljs-number">400</span>)
            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span>)
        }
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      }
      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
      .<span class="hljs-title function_">height</span>(<span class="hljs-number">300</span>)
      .<span class="hljs-title function_">scrollable</span>(<span class="hljs-title class_">ScrollDirection</span>.<span class="hljs-property">Vertical</span>) <span class="hljs-comment">// ç”³æ˜ç«–å‘æ»šåŠ¨</span>
      .<span class="hljs-title function_">border</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span> })

      <span class="hljs-comment">// æ—¥å¿—æ˜¾ç¤º</span>
      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">deleteLog</span>)
        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)
        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#333'</span>)
        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })
        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)
        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">5</span>)
        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#E0E0E0'</span>)

    }
    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)
    .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">20</span> })
  }

  <span class="hljs-comment">// ç”¨äºå­˜å‚¨æ»‘å—å€¼çš„å˜é‡</span>
  <span class="hljs-meta">@State</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;
}
</code></pre>
<hr/>
<h2 data-id="heading-9">å¤ç›˜ä¸€ä¸‹ï¼šæ‰‹åŠ¿æœºåˆ¶çš„ä¸‰ä¸ªâ€œæŒ¡ç®­ç‰Œâ€</h2>
<p>ä»£ç è·‘é€šäº†ï¼Œå’±ä»¬å¾—æŠŠ API 21 é‡Œçš„è¿™å‡ ä¸ªå‚æ•°åƒé€ï¼Œä»¥åé‡åˆ°å˜ç§ Bug ä¹Ÿèƒ½ä¸€æ‹›åˆ¶æ•Œã€‚</p>
<h3 data-id="heading-10">1. hitTestBehavior çš„å››ä¸ªå¢ƒç•Œ</h3>
<p>è¿™æ˜¯æœ€å¸¸ç”¨çš„å±æ€§ï¼Œä¿®é¥°åœ¨ç»„ä»¶ä¸Šã€‚</p>
<ul>
<li>
<p><strong><code>HitTestMode.Default</code>ï¼ˆé»˜è®¤ï¼‰</strong>ï¼š</p>
<ul>
<li>ç‰¹ç‚¹ï¼šè¯¥è°æ˜¯è°ã€‚å¦‚æœç»„ä»¶æœ¬èº«æ˜¯ <code>Button</code> è¿™ç±»å¯ç‚¹å‡»çš„ï¼Œå®ƒå°±æ‹¦æˆªï¼›å¦‚æœæ˜¯ <code>Text</code> è¿™ç§ï¼Œå®ƒå°±æ”¾è¡Œç»™çˆ¶ç»„ä»¶ã€‚</li>
<li><strong>V å“¥åæ§½</strong>ï¼šæœ‰æ—¶å€™ç³»ç»Ÿè¯¯åˆ¤ï¼Œå¯¼è‡´å¸ƒå±€é€æ˜çš„ <code>Row</code> æŒ¡ä½äº†ä¸‹å±‚æŒ‰é’®ï¼Œè¿™æ—¶å€™ä½ å°±å¾—æ”¹å®ƒã€‚</li>
</ul>
</li>
<li>
<p><strong><code>HitTestMode.None</code>ï¼ˆé€æ˜äººï¼‰</strong>ï¼š</p>
<ul>
<li>ç‰¹ç‚¹ï¼š<strong>æˆ‘ä¸æ‹¦æˆª</strong>ã€‚ç‚¹å‡»æˆ‘è¿™ä¸ªåŒºåŸŸï¼Œå°±å¥½åƒæˆ‘ä¸å­˜åœ¨ä¸€æ ·ï¼Œäº‹ä»¶ç›´æ¥ç©¿é€æˆ‘ï¼Œä¼ ç»™æˆ‘çš„å­©å­æˆ–è€…å…„å¼Ÿã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šä½ åšäº†ä¸€ä¸ªå¤æ‚çš„èƒŒæ™¯å¸ƒå±€ï¼Œä½†ä¸æƒ³å®ƒæŒ¡ä½èƒŒåçš„æŒ‰é’®ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>HitTestMode.Block</code>ï¼ˆæ‹¦è·¯è™ï¼‰</strong>ï¼šğŸŒŸ <strong>V å“¥æ¨è</strong></p>
<ul>
<li>ç‰¹ç‚¹ï¼š<strong>æˆ‘å…¨æ”¶äº†</strong>ã€‚ä¸ç®¡æˆ‘ä¸‹é¢æ˜¯ä»€ä¹ˆï¼Œåªè¦ç‚¹åˆ°æˆ‘ï¼Œæˆ‘å°±å¤„ç†ï¼Œç»ä¸å¾€å¤–ä¼ ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šè¿™å°±æ˜¯å’±ä»¬ä»£ç é‡Œè§£å†³â€œåˆ—è¡¨é‡Œå¥—æŒ‰é’®â€çš„ç¥å™¨ã€‚ç»™æŒ‰é’®åŠ ä¸Šå®ƒï¼Œçˆ¶ç»„ä»¶å†ä¹Ÿä¸ä¼šè¯¯è§¦è·³è½¬ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>HitTestMode.Transparent</code>ï¼ˆä¼ å£°ç­’ï¼‰</strong>ï¼š</p>
<ul>
<li>ç‰¹ç‚¹ï¼šæˆ‘æ‹¦æˆªåˆ°äº‹ä»¶åï¼Œå¤„ç†å®Œï¼Œè¿˜è¦ä¼ ç»™çˆ¶ç»„ä»¶ã€‚</li>
<li><strong>åœºæ™¯</strong>ï¼šå¾ˆå°‘ç”¨ï¼Œé™¤éä½ æƒ³å®ç°â€œç‚¹å­ç»„ä»¶ï¼Œçˆ¶å­ä¸€èµ·åŠ¨â€çš„æ•ˆæœï¼ˆé€šå¸¸ä¸æ¨èï¼Œå®¹æ˜“ä¹±ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-11">2. æ‰‹åŠ¿çš„ä¼˜å…ˆçº§</h3>
<p>å¦‚æœä¸¤ä¸ªæ‰‹åŠ¿éƒ½æƒ³å“åº”ï¼Œå¬è°çš„ï¼Ÿ</p>
<ul>
<li><strong>ç³»ç»Ÿé»˜è®¤</strong>ï¼š<code>TapGesture</code> (ç‚¹å‡») &gt; <code>LongPressGesture</code> (é•¿æŒ‰) &gt; <code>PanGesture</code> (æ‹–åŠ¨) &gt; <code>PinchGesture</code> (æåˆ)ã€‚</li>
<li><strong>æ‰‹åŠ¨å¹²é¢„</strong>ï¼šå¦‚æœä½ æƒ³å¼ºè¡Œè®©æŸä¸ªæ‰‹åŠ¿ä¼˜å…ˆï¼Œå¯ä»¥ç”¨ <code>priorityGesture</code> åŒ…è£¹æ‰‹åŠ¿ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript">    .<span class="hljs-title function_">gesture</span>(
      <span class="hljs-comment">// å³ä½¿çˆ¶ç»„ä»¶æƒ³æ»šåŠ¨ï¼Œå­ç»„ä»¶çš„æ¨ªå‘æ‹–åŠ¨ä¼˜å…ˆçº§æ›´é«˜</span>
      <span class="hljs-title function_">priorityGesture</span>(<span class="hljs-title class_">PanGesture</span>({ <span class="hljs-attr">direction</span>: <span class="hljs-title class_">PanDirection</span>.<span class="hljs-property">Horizontal</span> }))
    )
</code></pre>
<h3 data-id="heading-12">3. å¹¶å‘æ‰‹åŠ¿</h3>
<p>å¦‚æœä¸¤ä¸ªæ‰‹åŠ¿å¯ä»¥<strong>åŒæ—¶å‘ç”Ÿ</strong>ï¼ˆæ¯”å¦‚ä¸€è¾¹ç¼©æ”¾ä¸€è¾¹æ—‹è½¬ï¼‰ï¼Œç”¨ <code>GestureGroup</code> é…åˆ <code>GestureMode.Parallel</code>ã€‚
ä¸è¿‡ï¼Œå¯¹äºå¤§å¤šæ•°â€œçºµæ¨ªå†²çªâ€ï¼Œé¸¿è’™ç³»ç»Ÿ API 21 å·²ç»èƒ½å¾ˆæ™ºèƒ½åœ°é€šè¿‡ <code>PanGesture</code> çš„ <code>direction</code> å±æ€§è‡ªåŠ¨åŒºåˆ†æ–¹å‘äº†ã€‚å¦‚æœä½ å‘ç°å®ƒåˆ†ä¸æ¸…ï¼Œé€šå¸¸æ˜¯<strong>å¸ƒå±€é‡å </strong>æˆ–è€…<strong>è§¦æ‘¸åŒºåŸŸè®¾ç½®ä¸åˆç†</strong>å¯¼è‡´çš„ã€‚</p>
<hr/>
<h2 data-id="heading-13">å°ç»“ä¸€ä¸‹</h2>
<p>ä¸‹æ¬¡å†åšåˆ—è¡¨ã€ç›¸å†Œã€æ’­æ”¾å™¨çš„æ—¶å€™ï¼ŒæŠŠè¿™ä¸‰æ‹›æ‹¿å‡ºæ¥ï¼Œäº§å“ç»ç†çœ‹ä½ çš„çœ¼ç¥ç»å¯¹ä¸ä¸€æ ·ï¼</p>
<ol>
<li><strong>æ€•è¯¯è§¦ï¼ˆç‚¹å‡»å†²çªï¼‰</strong>ï¼šç»™æŒ‰é’®åŠ  <strong><code>hitTestBehavior(HitTestMode.Block)</code></strong>ã€‚</li>
<li><strong>æ€•æŠ¢æ»‘ï¼ˆæ»‘åŠ¨å†²çªï¼‰</strong>ï¼šç»™å­ç»„ä»¶ç»‘å®šæ˜ç¡®æ–¹å‘çš„ <strong><code>PanGesture</code></strong>ï¼Œå¿…è¦æ—¶åŠ  <strong><code>priorityGesture</code></strong>ã€‚</li>
<li><strong>æ€•é€ä¼ </strong>ï¼šç»™é®æŒ¡å±‚åŠ  <strong><code>hitTestBehavior(HitTestMode.None)</code></strong>ã€‚</li>
</ol>
<p>æˆ‘æ˜¯Vå“¥ï¼Œå’±ä»¬ä¸‹æœŸæŠ€æœ¯å¤ç›˜è§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Linuxã€‘æ–‡ä»¶ç³»ç»Ÿä¸ fsck.ext4 ä¿®å¤ - æˆ‘è¸©è¿‡çš„å‘ä¸æ€»ç»“]]></title>    <link>https://juejin.cn/post/7595994039108173860</link>    <guid>https://juejin.cn/post/7595994039108173860</guid>    <pubDate>2026-01-17T07:27:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595994039108173860" data-draft-id="7595878718171562020" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Linuxã€‘æ–‡ä»¶ç³»ç»Ÿä¸ fsck.ext4 ä¿®å¤ - æˆ‘è¸©è¿‡çš„å‘ä¸æ€»ç»“"/> <meta itemprop="keywords" content="è¿ç»´,Linux"/> <meta itemprop="datePublished" content="2026-01-17T07:27:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Kidaçš„èººå¹³å°å±‹"/> <meta itemprop="url" content="https://juejin.cn/user/1684864740889758"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Linuxã€‘æ–‡ä»¶ç³»ç»Ÿä¸ fsck.ext4 ä¿®å¤ - æˆ‘è¸©è¿‡çš„å‘ä¸æ€»ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1684864740889758/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Kidaçš„èººå¹³å°å±‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:27:41.000Z" title="Sat Jan 17 2026 07:27:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ‰¿æ¥ä¸Šä¸€å›ï¼Œè¿™æœŸä¾ç„¶æ˜¯ Linux çš„æ€»ç»“ã€‚ä½†è¿™æ¬¡æˆ‘æƒ³èŠèŠæ–‡ä»¶ç³»ç»Ÿå’Œ fsckï¼Œè¿™ä¸ªæˆ‘è¸©è¿‡åƒç™¾éçš„å‘ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€é¦–å…ˆä»€ä¹ˆæ˜¯ fsckï¼Ÿ</h2>
<p>åœ¨æˆ‘æ—©æœŸä½¿ç”¨ Linux çš„æ—¶å€™ï¼Œå¯¹ç£ç›˜é—®é¢˜çš„ç†è§£éå¸¸è‚¤æµ…ï¼š</p>
<blockquote>
<p>â€œç³»ç»Ÿèµ·ä¸æ¥äº†ï¼Ÿé‚£å°± fsck ä¸€ä¸‹è¯•è¯•ã€‚â€</p>
</blockquote>
<p>ç›´åˆ°æˆ‘é‡åˆ° <strong>ext4 åˆ†åŒºæ— æ³•æŒ‚è½½ã€ç³»ç»Ÿè¿›å…¥ emergency modeã€fsck ç›´æ¥æŠ¥é”™</strong>ï¼Œæˆ‘æ‰æ„è¯†åˆ°ï¼š<br/>
<strong>fsck ä¸æ˜¯â€œä¸‡èƒ½ä¿®å¤é”®â€ï¼Œè€Œæ˜¯â€œæœ€åçš„å¤–ç§‘æ‰‹æœ¯åˆ€â€ã€‚</strong></p>
<p>ç†è§£ä¸‹é¢ä¸‰ä»¶äº‹ï¼Œå¯¹æˆ‘æ¥è¯´æ˜¯åˆ†æ°´å²­ï¼š</p>
<ol>
<li><strong>ä»€ä¹ˆæ—¶å€™èƒ½ç”¨ fsckï¼Œä»€ä¹ˆæ—¶å€™ç»å¯¹ä¸èƒ½ç”¨</strong></li>
<li><strong>fsck åˆ°åº•åœ¨â€œä¿®ä»€ä¹ˆâ€</strong></li>
<li><strong>å“ªäº›å‚æ•°ä¼šæ•‘å‘½ï¼Œå“ªäº›å‚æ•°ä¼šæ¯æ•°æ®</strong></li>
</ol>
<h2 data-id="heading-1">äºŒã€fsck åœ¨ Linux ä¸­çš„å®šä½</h2>
<p>ä»æœ¬è´¨ä¸Šè®²ï¼š</p>
<blockquote>
<p><strong>fsckï¼ˆFile System Consistency Checkï¼‰æ˜¯ç”¨æ¥â€œæ ¡éªŒå¹¶ä¿®å¤æ–‡ä»¶ç³»ç»Ÿç»“æ„ä¸€è‡´æ€§â€çš„å·¥å…·ï¼Œè€Œä¸æ˜¯æ•°æ®æ¢å¤å·¥å…·ã€‚</strong></p>
</blockquote>
<p>å®ƒä¸»è¦æ£€æŸ¥å’Œä¿®å¤çš„æ˜¯ï¼š</p>
<ul>
<li>superblockï¼ˆè¶…çº§å—ï¼‰</li>
<li>inode è¡¨</li>
<li>block bitmap</li>
<li>inode bitmap</li>
<li>ç›®å½•ç»“æ„ä¸å¼•ç”¨å…³ç³»</li>
</ul>
<p><strong>å€¼å¾—æ³¨æ„çš„æ˜¯ fsck å…³å¿ƒçš„æ˜¯â€œç»“æ„æ˜¯å¦ä¸€è‡´â€ï¼Œå®ƒæ˜¯ä¸ä¿è¯ä½ çš„æ–‡ä»¶å†…å®¹â€œæ­£ç¡®æˆ–å®Œæ•´â€çš„ã€‚</strong></p>
<h2 data-id="heading-2">ä¸‰ã€åœ¨ fsck ä¹‹å‰å¿…åšçš„ä¸‰ä»¶äº‹ï¼ˆé‡ç‚¹ï¼‰</h2>
<h3 data-id="heading-3">1.ç¡®è®¤åˆ†åŒºæ²¡æœ‰è¢«æŒ‚è½½</h3>
<p>fsck å¯¹â€œå·²æŒ‚è½½åˆ†åŒºâ€æ‰§è¡Œæ˜¯æå…¶å±é™©çš„è¡Œä¸ºã€‚æˆ‘é€šå¸¸ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">mount | grep sda
lsblk
</code></pre>
<p>å¦‚æœæ˜¯æ ¹åˆ†åŒºï¼š</p>
<ul>
<li>å¿…é¡»è¿›å…¥å•ç”¨æˆ·æ¨¡å¼</li>
<li>æˆ–ä½¿ç”¨ Live CD / æ•‘æ´ç³»ç»Ÿ</li>
</ul>
<h3 data-id="heading-4">2.èƒ½å¤‡ä»½å°±å…ˆå¤‡ä»½ï¼ˆå“ªæ€•æ˜¯ ddï¼‰</h3>
<p>å¦‚æœç£ç›˜è¿˜èƒ½è¯»ï¼Œæˆ‘è‡³å°‘ä¼šåšä¸€ä»½åŸå§‹é•œåƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">dd</span> <span class="hljs-keyword">if</span>=/dev/sda of=/backup/sda.img bs=4M status=progress
</code></pre>
<p>æˆ‘å®æ„¿æ…¢ï¼Œæ€»æ¯”äº‹ååæ‚”å¼ºã€‚</p>
<h3 data-id="heading-5">3.ææ¸…æ¥šæ–‡ä»¶ç³»ç»Ÿç±»å‹</h3>
<pre><code class="hljs language-bash" lang="bash">blkid
lsblk -f
</code></pre>
<p>ç¡®è®¤æ˜¯ ext4ï¼Œè€Œä¸æ˜¯ xfs / btrfs</p>
<h2 data-id="heading-6">å››ã€fsck.ext4 çš„æ ¸å¿ƒç”¨æ³•</h2>
<h3 data-id="heading-7">1.åŸºç¡€æ£€æŸ¥ï¼ˆåªè¯»ï¼Œä¸ä¿®æ”¹ï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">fsck.ext4 -n /dev/sda1
</code></pre>
<p>ä¸€èˆ¬æˆ‘ä¼šé‡‡ç”¨ -nï¼ˆä¸åšä»»ä½•ä¿®æ”¹ï¼‰å‚æ•°å…ˆåšä¸€æ¬¡è¯„ä¼°ï¼Œå…ˆçœ‹æŸåç¨‹åº¦ã€‚</p>
<h3 data-id="heading-8">2.è‡ªåŠ¨ä¿®å¤ï¼ˆè¸©å‘æœ€å¤šï¼‰</h3>
<pre><code class="hljs language-bash" lang="bash">fsck.ext4 -y /dev/sda1
</code></pre>
<p>è¿™å¯ä»¥ç®—æ˜¯æˆ‘è¸©å‘æœ€å¤šçš„å‚æ•°ï¼Œ-yï¼ˆå¯¹æ‰€æœ‰ä¿®å¤è¯¢é—®è‡ªåŠ¨å›ç­” yesï¼‰ã€‚ä»¥å‰å¸¸ç”¨ï¼Œç°åœ¨çš„è¯åªåœ¨æˆ‘å·²ç»æœ‰å¤‡ä»½ï¼Œæˆ–åˆ«æ— é€‰æ‹©æ—¶ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-9">3.æŒ‡å®šå¤‡ç”¨ superblock ä¿®å¤</h3>
<p>è¿™æ˜¯æˆ‘æœ€å¸¸â€œæ•‘æ´»â€åˆ†åŒºçš„ä¸€æ‹›ã€‚å…ˆæŸ¥çœ‹å¤‡ç”¨ superblockï¼š</p>
<pre><code class="hljs language-bash" lang="bash">dumpe2fs /dev/sda1 | grep -i superblock
</code></pre>
<p>ç„¶åæŒ‡å®šä¸€ä¸ªï¼š</p>
<pre><code class="hljs language-bash" lang="bash">fsck.ext4 -b 32768 /dev/sda1
</code></pre>
<h2 data-id="heading-10">äº”ã€lost+foundï¼Ÿ</h2>
<p>fsck ä¿®å¤åï¼Œç»å¸¸ä¼šçœ‹åˆ°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">/lost+found
</code></pre>
<p>é‡Œé¢æ˜¯ï¼š</p>
<ul>
<li>æ‰¾ä¸åˆ°åŸç›®å½•ç»“æ„çš„ inode</li>
<li>æ–‡ä»¶åé€šå¸¸æ˜¯æ•°å­—</li>
</ul>
<p>æˆ‘çš„è¿‡å¾€ç»éªŒæ˜¯è‹¥æ˜¯å°æ–‡ä»¶ï¼Œé‚£ä¸€èˆ¬å†…å®¹è¿˜ç®—æ˜¯å®Œæ•´çš„ï¼Œå¦‚æœæ˜¯å¤§æ–‡ä»¶ï¼ˆè­¬å¦‚ï¼Œæ•°æ®åº“ã€é•œåƒç­‰ï¼‰é‚£ä¹ˆå¯ç”¨æ€§å°±ä¸é«˜äº†ï¼Œé‚£å¦‚æœæ˜¯ç›®å½•ç»“æ„çš„è¯ï¼Œé‚£åŸºæœ¬å°±ä¸å¯èƒ½å®Œå…¨æ¢å¤çš„ã€‚é‚£ä¹ˆæˆ‘çš„åšæ³•æ˜¯ï¼š</p>
<ul>
<li>é€ä¸ª file + less åˆ¤æ–­</li>
<li>èƒ½ç¡®è®¤ç”¨é€”çš„ï¼Œæ‰‹åŠ¨å½’ä½</li>
<li>å…¶ä½™é•¿æœŸç•™æ¡£ï¼Œä¸è½»æ˜“åˆ é™¤</li>
</ul>
<h2 data-id="heading-11">å…­ã€æˆ‘è¸©è¿‡çš„å‘ï¼ˆè¡€çš„æ•™è®­ï¼‰</h2>
<h3 data-id="heading-12">1.åœ¨å·²æŒ‚è½½çš„æ ¹åˆ†åŒºä¸Šè·‘ fsck</h3>
<p>ç»“æœå¯æƒ³è€ŒçŸ¥ï¼Œæ–‡ä»¶ç³»ç»ŸçŠ¶æ€ç›´æ¥æ··ä¹±ï¼Œæœ€ååªèƒ½è¿›æ•‘æ´ç³»ç»Ÿé‡ä¿®ã€‚è¿™ä¹Ÿè®©æˆ‘æ„è¯†åˆ° â€œfsck â‰  åœ¨çº¿ä¿®å¤å·¥å…·â€ è¿™ä¸ªé“ç†ã€‚</p>
<h3 data-id="heading-13">2.å¯¹ XFS åˆ†åŒºä½¿ç”¨ fsck.ext4</h3>
<p>fsck æ ¹æœ¬å°±â€œçœ‹ä¸æ‡‚â€ï¼Œå¹¶ä¸”é€ æˆäºŒæ¬¡æŸåã€‚åé¢æˆ‘çŸ¥é“äº† XFS ç”¨ xfs_repairï¼Œåªæœ‰ ext4 æ‰ç”¨ fsck.ext4ã€‚</p>
<h2 data-id="heading-14">ä¸ƒã€æˆ‘ç°åœ¨çš„åšæ³•</h2>
<p>è¯´å®è¯ï¼Œæˆ‘å¹¶ä¸æƒ³ç»å¸¸ç”¨ fsckã€‚ç°åœ¨æˆ‘æ›´å€¾å‘äºï¼š</p>
<ul>
<li>RAID + å®šæœŸ SMART æ£€æµ‹</li>
<li>UPS é˜²æ–­ç”µ</li>
<li>æ—¥å¿—ä¸ä¸šåŠ¡æ•°æ®åˆ†ç›˜</li>
<li>å…³é”®æ•°æ® å¿«ç…§ + å¤‡ä»½</li>
<li>æ–°ç³»ç»Ÿä¼˜å…ˆè€ƒè™‘ btrfs / zfs</li>
</ul>
<p>fsck å¯¹æˆ‘æ¥è¯´ï¼Œå·²ç»å˜æˆäº†â€œæœ€åçš„æ­¢è¡€æ‰‹æ®µâ€ï¼Œè€Œä¸æ˜¯å¸¸è§„ç»´æŠ¤æ–¹å¼ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Caffeineå…¥é—¨åˆ°å®æˆ˜]]></title>    <link>https://juejin.cn/post/7595841630677106739</link>    <guid>https://juejin.cn/post/7595841630677106739</guid>    <pubDate>2026-01-17T07:46:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595841630677106739" data-draft-id="7595842144906625074" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Caffeineå…¥é—¨åˆ°å®æˆ˜"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-17T07:46:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Caffeineå…¥é—¨åˆ°å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:46:22.000Z" title="Sat Jan 17 2026 07:46:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>é«˜æ€§èƒ½Javaç¼“å­˜æ¡†æ¶å®æˆ˜ï¼Œè®©ä½ ç§’æ‡‚ç¼“å­˜ä¼˜åŒ–</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å½“ä»Šé«˜å¹¶å‘çš„äº’è”ç½‘åº”ç”¨ä¸­ï¼Œç¼“å­˜å·²ç»æˆä¸ºæå‡ç³»ç»Ÿæ€§èƒ½çš„å…³é”®æŠ€æœ¯ä¹‹ä¸€ã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œæ·±å…¥æµ…å‡ºåœ°å­¦ä¹ Caffeineè¿™æ¬¾é«˜æ€§èƒ½çš„Javaç¼“å­˜æ¡†æ¶ï¼Œå¹¶é€šè¿‡å®é™…æ¡ˆä¾‹è®©ä½ æŒæ¡ç¼“å­˜æŠ€æœ¯çš„ç²¾é«“ã€‚</p>
<h2 data-id="heading-1">1. Caffeineç®€ä»‹</h2>
<p>Caffeineæ˜¯ä¸€ä¸ªåŸºäºJavaçš„é«˜æ€§èƒ½ç¼“å­˜åº“ï¼Œç”±Googleå¼€å‘å¹¶å¼€æºã€‚å®ƒè¢«è®¤ä¸ºæ˜¯Javaç¼“å­˜é¢†åŸŸçš„ç‹è€…ï¼Œåœ¨æ€§èƒ½æµ‹è¯•ä¸­è¡¨ç°ä¼˜å¼‚ã€‚</p>
<h3 data-id="heading-2">ä¸ºä»€ä¹ˆé€‰æ‹©Caffeineï¼Ÿ</h3>
<ul>
<li><strong>é«˜æ€§èƒ½</strong>ï¼šé‡‡ç”¨å…ˆè¿›çš„ç®—æ³•ï¼Œè¯»å†™æ€§èƒ½å“è¶Š</li>
<li><strong>åŠŸèƒ½ä¸°å¯Œ</strong>ï¼šæ”¯æŒå¤šç§è¿‡æœŸç­–ç•¥ã€å¼‚æ­¥åŠ è½½ã€ç»Ÿè®¡ä¿¡æ¯ç­‰</li>
<li><strong>çº¿ç¨‹å®‰å…¨</strong>ï¼šå¹¶å‘æ€§èƒ½ä¼˜ç§€</li>
<li><strong>æ˜“äºä½¿ç”¨</strong>ï¼šAPIè®¾è®¡ç®€æ´ç›´è§‚</li>
<li><strong>æ´»è·ƒç¤¾åŒº</strong>ï¼šæŒç»­ç»´æŠ¤å’Œæ›´æ–°</li>
</ul>
<h3 data-id="heading-3">æ¶æ„è®¾è®¡</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a3e6e0d899e14fbaaafafa3123056baf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=hfMSuIcQysmqzw2OjT3WiDv4Wtw%3D" alt="" loading="lazy"/></p>
<p>Caffeineçš„æ ¸å¿ƒæ¶æ„åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç¼“å­˜å®¹å™¨</strong>ï¼šä½¿ç”¨ConcurrentHashMapä½œä¸ºåº•å±‚æ•°æ®ç»“æ„</li>
<li><strong>è®¿é—®ç­–ç•¥</strong>ï¼šé‡‡ç”¨Window TinyLFUç®—æ³•è¿›è¡Œé¢‘ç‡ç»Ÿè®¡</li>
<li><strong>æ·˜æ±°ç­–ç•¥</strong>ï¼šåŸºäºæ—¶é—´çª—å£å’Œé¢‘ç‡çš„æ··åˆæ·˜æ±°ç­–ç•¥</li>
<li><strong>äº‹ä»¶æœºåˆ¶</strong>ï¼šæ”¯æŒç›‘å¬ç¼“å­˜çš„å„ç§äº‹ä»¶</li>
</ol>
<h2 data-id="heading-4">2. å¿«é€Ÿå…¥é—¨</h2>
<h3 data-id="heading-5">Mavenä¾èµ–</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.ben-manes.caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1.8<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-6">åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Cache</span>;
<span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Caffeine</span>;
<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">BasicCacheExample</span>Â {
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">main</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>[]Â args</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åˆ›å»ºç¼“å­˜</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Cache</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">String</span>&gt;Â cacheÂ =Â <span class="hljs-title class_">Caffeine</span>.<span class="hljs-title function_">newBuilder</span>()
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">maximumSize</span>(<span class="hljs-number">1000</span>)Â <span class="hljs-comment">//Â æœ€å¤§ç¼“å­˜æ•°é‡</span>
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">expireAfterWrite</span>(<span class="hljs-number">10</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)Â <span class="hljs-comment">//Â å†™å…¥å10åˆ†é’Ÿè¿‡æœŸ</span>
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">build</span>();

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å­˜å‚¨æ•°æ®</span>
Â Â Â Â Â Â Â Â cache.<span class="hljs-title function_">put</span>(<span class="hljs-string">"key1"</span>,Â <span class="hljs-string">"value1"</span>);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·å–æ•°æ®</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">String</span>Â valueÂ =Â cache.<span class="hljs-title function_">getIfPresent</span>(<span class="hljs-string">"key1"</span>);
Â Â Â Â Â Â Â Â <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ç¼“å­˜å€¼:Â "</span>Â +Â value);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·å–æˆ–è®¡ç®—</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">String</span>Â value2Â =Â cache.<span class="hljs-title function_">get</span>(<span class="hljs-string">"key2"</span>,Â kÂ -&gt;Â <span class="hljs-string">"defaultValue"</span>);
Â Â Â Â Â Â Â Â <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ç¼“å­˜å€¼:Â "</span>Â +Â value2);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç§»é™¤æ•°æ®</span>
Â Â Â Â Â Â Â Â cache.<span class="hljs-title function_">invalidate</span>(<span class="hljs-string">"key1"</span>);
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-7">3. æ ¸å¿ƒæ¦‚å¿µ</h2>
<h3 data-id="heading-8">3.1 Cache vs LoadingCache vs AsyncLoadingCache</h3>
<p>Caffeineæä¾›äº†ä¸‰ç§ç¼“å­˜ç±»å‹ï¼š</p>
<ol>
<li><strong>Cache</strong>ï¼šåŸºç¡€ç¼“å­˜ï¼Œéœ€è¦æ‰‹åŠ¨ç®¡ç†æ•°æ®</li>
<li><strong>LoadingCache</strong>ï¼šè‡ªåŠ¨åŠ è½½æ•°æ®çš„ç¼“å­˜</li>
<li><strong>AsyncLoadingCache</strong>ï¼šå¼‚æ­¥åŠ è½½æ•°æ®çš„ç¼“å­˜</li>
</ol>
<h3 data-id="heading-9">3.2 è¿‡æœŸç­–ç•¥</h3>
<p>Caffeineæä¾›äº†ä¸‰ç§è¿‡æœŸç­–ç•¥ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Caffeine<span class="hljs-selector-class">.newBuilder</span>()
Â Â Â Â <span class="hljs-selector-class">.expireAfterWrite</span>(<span class="hljs-number">10</span>,Â TimeUnit.MINUTES)Â <span class="hljs-comment">//Â å†™å…¥åè¿‡æœŸ</span>
Â Â Â Â <span class="hljs-selector-class">.expireAfterAccess</span>(<span class="hljs-number">5</span>,Â TimeUnit.MINUTES)Â Â <span class="hljs-comment">//Â æœ€åè®¿é—®åè¿‡æœŸ</span>
Â Â Â Â <span class="hljs-selector-class">.expireAfter</span>(<span class="hljs-number">30</span>,Â TimeUnit.MINUTES);Â Â Â Â Â Â Â <span class="hljs-comment">//Â è‡ªå®šä¹‰è¿‡æœŸé€»è¾‘</span>
</code></pre>
<h3 data-id="heading-10">3.3 æ·˜æ±°ç­–ç•¥</h3>
<pre><code class="hljs language-scss" lang="scss">Caffeine<span class="hljs-selector-class">.newBuilder</span>()
Â Â Â Â <span class="hljs-selector-class">.maximumSize</span>(<span class="hljs-number">1000</span>)Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŸºäºæ•°é‡</span>
Â Â Â Â <span class="hljs-selector-class">.maximumWeight</span>(<span class="hljs-number">10000</span>)Â Â Â Â Â Â <span class="hljs-comment">//Â åŸºäºæƒé‡</span>
Â Â Â Â <span class="hljs-selector-class">.weakKeys</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼±å¼•ç”¨é”®</span>
Â Â Â Â <span class="hljs-selector-class">.weakValues</span>()Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼±å¼•ç”¨å€¼</span>
Â Â Â Â <span class="hljs-selector-class">.softValues</span>();Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è½¯å¼•ç”¨å€¼</span>
</code></pre>
<h2 data-id="heading-11">4. é«˜çº§ç‰¹æ€§</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ff936a2d76c04f1aaf866ccba450d2fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=vIDzfY5%2B20eLh9huJFxIDK%2FnZbk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-12">4.1 å¼‚æ­¥åŠ è½½</h3>
<pre><code class="hljs language-ini" lang="ini">AsyncLoadingCache&lt;String,Â User&gt;Â <span class="hljs-attr">asyncCache</span>Â =Â Caffeine.newBuilder()
Â Â Â Â .maximumSize(1000)
Â Â Â Â .expireAfterWrite(10,Â TimeUnit.MINUTES)
Â Â Â Â .buildAsync(keyÂ -&gt;Â loadUserFromDatabase(key))<span class="hljs-comment">;</span>

//Â å¼‚æ­¥è·å–
CompletableFuture&lt;User&gt;Â <span class="hljs-attr">userFuture</span>Â =Â asyncCache.get(<span class="hljs-string">"user1"</span>)<span class="hljs-comment">;</span>
userFuture.thenAccept(userÂ -&gt;Â {
Â Â Â Â System.out.println("è·å–ç”¨æˆ·:Â "Â +Â user.getName())<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-13">4.2 äº‹ä»¶ç›‘å¬</h3>
<pre><code class="hljs language-vbnet" lang="vbnet">Cache&lt;<span class="hljs-type">String</span>,Â <span class="hljs-type">String</span>&gt;Â cacheÂ =Â Caffeine.newBuilder()
Â Â Â Â .maximumSize(<span class="hljs-number">1000</span>)
Â Â Â Â .removalListener((<span class="hljs-keyword">key</span>,Â value,Â cause)Â -&gt;Â {
Â Â Â Â Â Â Â Â System.out.println(<span class="hljs-string">"ç¼“å­˜ç§»é™¤:Â "</span>Â +Â <span class="hljs-keyword">key</span>Â +Â <span class="hljs-string">"Â -&gt;Â "</span>Â +Â valueÂ +Â <span class="hljs-string">",Â åŸå› :Â "</span>Â +Â cause);
Â Â Â Â })
Â Â Â Â .build();
</code></pre>
<h3 data-id="heading-14">4.3 ç»Ÿè®¡ä¿¡æ¯</h3>
<pre><code class="hljs language-scss" lang="scss">Cache&lt;String,Â String&gt;Â cacheÂ =Â Caffeine<span class="hljs-selector-class">.newBuilder</span>()
Â Â Â Â <span class="hljs-selector-class">.maximumSize</span>(<span class="hljs-number">1000</span>)
Â Â Â Â <span class="hljs-selector-class">.recordStats</span>()Â <span class="hljs-comment">//Â å¯ç”¨ç»Ÿè®¡</span>
Â Â Â Â <span class="hljs-selector-class">.build</span>();

<span class="hljs-comment">//Â ä½¿ç”¨ç¼“å­˜...</span>
cache<span class="hljs-selector-class">.put</span>("key1",Â "value1");
cache<span class="hljs-selector-class">.getIfPresent</span>("key1");

<span class="hljs-comment">//Â è·å–ç»Ÿè®¡ä¿¡æ¯</span>
CacheStatsÂ statsÂ =Â cache<span class="hljs-selector-class">.stats</span>();
System<span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>("å‘½ä¸­ç‡:Â "Â +Â stats.hitRate());
System<span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>("åŠ è½½æ—¶é—´:Â "Â +Â stats.averageLoadPenalty());
System<span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>("è¯·æ±‚æ•°:Â "Â +Â stats.requestCount());
</code></pre>
<h2 data-id="heading-15">5. Spring Booté›†æˆ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aff82efaf278437f8045c4dae72c58be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=x8wXynqrw1CSWo8vv794U8KA5Sg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-16">5.1 æ·»åŠ ä¾èµ–</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-cache<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.github.ben-manes.caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>caffeine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-17">5.2 é…ç½®ç±»</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Caffeine</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">CacheManager</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">EnableCaching</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">CaffeineCacheManager</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">context</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Bean</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">context</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Configuration</span>;
<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableCaching</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">CacheConfig</span>Â {

Â Â Â Â <span class="hljs-meta">@Bean</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">CacheManager</span>Â <span class="hljs-title function_">cacheManager</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">CaffeineCacheManager</span>Â cacheManagerÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">CaffeineCacheManager</span>();
Â Â Â Â Â Â Â Â cacheManager.<span class="hljs-title function_">setCaffeine</span>(<span class="hljs-title function_">caffeineCacheBuilder</span>());
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â cacheManager;
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Caffeine</span>&lt;<span class="hljs-title class_">Object</span>,Â <span class="hljs-title class_">Object</span>&gt;Â <span class="hljs-title function_">caffeineCacheBuilder</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Caffeine</span>.<span class="hljs-title function_">newBuilder</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">initialCapacity</span>(<span class="hljs-number">100</span>)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">maximumSize</span>(<span class="hljs-number">1000</span>)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">expireAfterWrite</span>(<span class="hljs-number">10</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">recordStats</span>();
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-18">5.3 ä½¿ç”¨æ³¨è§£</h3>
<pre><code class="hljs language-typescript" lang="typescript">packageÂ com.<span class="hljs-property">example</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">demo</span>.<span class="hljs-property">service</span>;

<span class="hljs-keyword">import</span>Â com.<span class="hljs-property">example</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">demo</span>.<span class="hljs-property">model</span>.<span class="hljs-property">User</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">CacheEvict</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">CachePut</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">Cacheable</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Service</span>;

<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.*;
<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">ConcurrentHashMap</span>;
<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserService</span>Â {

Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“å­˜å‚¨</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â finalÂ <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">User</span>&gt;Â userMapÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">UserService</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åˆå§‹åŒ–ä¸€äº›æµ‹è¯•æ•°æ®</span>
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(1L,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">User</span>(1L,Â <span class="hljs-string">"å¼ ä¸‰"</span>,Â <span class="hljs-string">"zhangsan@example.com"</span>,Â <span class="hljs-string">"13800138000"</span>));
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(2L,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">User</span>(2L,Â <span class="hljs-string">"æå››"</span>,Â <span class="hljs-string">"lisi@example.com"</span>,Â <span class="hljs-string">"13900139000"</span>));
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(3L,Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">User</span>(3L,Â <span class="hljs-string">"ç‹äº”"</span>,Â <span class="hljs-string">"wangwu@example.com"</span>,Â <span class="hljs-string">"13700137000"</span>));
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¸¦ç¼“å­˜ï¼‰
Â Â Â Â Â *Â <span class="hljs-doctag">@param</span>Â userIdÂ ç”¨æˆ·ID
Â Â Â Â Â *Â <span class="hljs-doctag">@return</span>Â ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Cacheable</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"#userId"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">User</span>Â <span class="hljs-title function_">getUserById</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢è€—æ—¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MILLISECONDS</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">100</span>);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InterruptedException</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">interrupt</span>();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-title class_">User</span>Â userÂ =Â userMap.<span class="hljs-title function_">get</span>(userId);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨:Â "</span>Â +Â userId);
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå¼‚æ­¥ï¼‰
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">CompletableFuture</span>&lt;<span class="hljs-title class_">User</span>&gt;Â <span class="hljs-title function_">getUserByIdAsync</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">CompletableFuture</span>.<span class="hljs-title function_">supplyAsync</span>(()Â -&gt;Â <span class="hljs-title function_">getUserById</span>(userId));
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Cacheable</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"'all'"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt;Â <span class="hljs-title function_">getAllUsers</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢è€—æ—¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MILLISECONDS</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">200</span>);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InterruptedException</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">interrupt</span>();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ArrayList</span>&lt;&gt;(userMap.<span class="hljs-title function_">values</span>());
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ›å»ºç”¨æˆ·
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@CachePut</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"#user.id"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">User</span>Â <span class="hljs-title function_">createUser</span>(<span class="hljs-params">UserÂ user</span>)Â {
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(user.<span class="hljs-title function_">getId</span>(),Â user);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ›´æ–°ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@CachePut</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"#user.id"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">User</span>Â <span class="hljs-title function_">updateUser</span>(<span class="hljs-params">UserÂ user</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (!userMap.<span class="hljs-title function_">containsKey</span>(user.<span class="hljs-title function_">getId</span>()))Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨:Â "</span>Â +Â user.<span class="hljs-title function_">getId</span>());
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â user.<span class="hljs-title function_">setUpdateTime</span>(<span class="hljs-title class_">LocalDateTime</span>.<span class="hljs-title function_">now</span>());
Â Â Â Â Â Â Â Â userMap.<span class="hljs-title function_">put</span>(user.<span class="hljs-title function_">getId</span>(),Â user);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ é™¤ç”¨æˆ·
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@CacheEvict</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"#userId"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">deleteUser</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">User</span>Â removedÂ =Â userMap.<span class="hljs-title function_">remove</span>(userId);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (removedÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">throw</span>Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"ç”¨æˆ·ä¸å­˜åœ¨:Â "</span>Â +Â userId);
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@Cacheable</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â keyÂ =Â <span class="hljs-string">"'batch:'Â +Â #userIds.hashCode()"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">User</span>&gt;Â <span class="hljs-title function_">batchGetUsers</span>(<span class="hljs-params"><span class="hljs-built_in">Set</span>&lt;Long&gt;Â userIds</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ‰¹é‡æŸ¥è¯¢è€—æ—¶</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MILLISECONDS</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">150</span>);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InterruptedException</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">interrupt</span>();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">User</span>&gt;Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">HashMap</span>&lt;&gt;();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">Long</span>Â userIdÂ :Â userIds)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">User</span>Â userÂ =Â userMap.<span class="hljs-title function_">get</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ !=Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(userId,Â user);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â result;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ ¹æ®ç”¨æˆ·åæ¨¡ç³ŠæŸ¥è¯¢
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt;Â <span class="hljs-title function_">searchUsersByUsername</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â keyword</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">User</span>&gt;Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">User</span>Â userÂ :Â userMap.<span class="hljs-title function_">values</span>())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (user.<span class="hljs-title function_">getUsername</span>().<span class="hljs-title function_">contains</span>(keyword))Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">add</span>(user);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â result;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@CacheEvict</span>(valueÂ =Â <span class="hljs-string">"users"</span>,Â allEntriesÂ =Â <span class="hljs-literal">true</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">clearAllCache</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"æ¸…ç©ºæ‰€æœ‰ç”¨æˆ·ç¼“å­˜"</span>);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç”¨æˆ·æ€»æ•°
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â longÂ <span class="hljs-title function_">getUserCount</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userMap.<span class="hljs-title function_">size</span>();
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-19">6. ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ</h2>
<h3 data-id="heading-20">6.1 ç¼“å­˜é›ªå´©ä¸å‡»ç©¿</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ae45c5ae2c644e7b19813de7bb61db4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=s5Bj%2B0%2FpD1TT%2FcUtgYIihfc%2BzFI%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-21">ç¼“å­˜é›ªå´©è§£å†³æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">//Â 1.Â è®¾ç½®éšæœºè¿‡æœŸæ—¶é—´</span>
Caffeine.newBuilder()
Â Â Â Â .expireAfterWrite(<span class="hljs-number">10</span>Â +Â <span class="hljs-keyword">new</span>Â Random().nextInt(<span class="hljs-number">5</span>),Â TimeUnit.MINUTES);

<span class="hljs-comment">//Â 2.Â ä½¿ç”¨äº’æ–¥é”</span>
<span class="hljs-keyword">private</span>Â finalÂ LockÂ <span class="hljs-keyword">lock</span>Â =Â <span class="hljs-keyword">new</span>Â ReentrantLock();

<span class="hljs-function"><span class="hljs-keyword">public</span>Â UserÂ <span class="hljs-title">getUserWithLock</span>(<span class="hljs-params">LongÂ id</span>)</span>Â {
Â Â Â Â UserÂ userÂ =Â cache.getIfPresent(id);
Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ !=Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">lock</span>.<span class="hljs-keyword">lock</span>();
Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŒé‡æ£€æŸ¥</span>
Â Â Â Â Â Â Â Â userÂ =Â cache.getIfPresent(id);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (userÂ !=Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â userÂ =Â userRepository.findById(id);
Â Â Â Â Â Â Â Â cache.put(id,Â user);
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â user;
Â Â Â Â }Â <span class="hljs-keyword">finally</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">lock</span>.unlock();
Â Â Â Â }
}
</code></pre>
<h4 data-id="heading-22">ç¼“å­˜å‡»ç©¿è§£å†³æ–¹æ¡ˆ</h4>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">//Â ä½¿ç”¨Caffeineçš„å¼‚æ­¥åŠ è½½</span>
AsyncLoadingCache&lt;Long,Â User&gt;Â asyncCacheÂ =Â Caffeine<span class="hljs-selector-class">.newBuilder</span>()
Â Â Â Â <span class="hljs-selector-class">.maximumSize</span>(<span class="hljs-number">1000</span>)
Â Â Â Â <span class="hljs-selector-class">.expireAfterWrite</span>(<span class="hljs-number">10</span>,Â TimeUnit.MINUTES)
Â Â Â Â <span class="hljs-selector-class">.buildAsync</span>(keyÂ -&gt;Â loadUserFromDatabase(key));

publicÂ UserÂ <span class="hljs-built_in">getUser</span>(LongÂ id)Â {
Â Â Â Â returnÂ asyncCache<span class="hljs-selector-class">.get</span>(id)<span class="hljs-selector-class">.join</span>();
}
</code></pre>
<h3 data-id="heading-23">6.2 ç¼“å­˜é¢„çƒ­</h3>
<pre><code class="hljs language-scss" lang="scss">packageÂ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.caffeine</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.cache</span>;

importÂ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.caffeine</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.model</span><span class="hljs-selector-class">.User</span>;
importÂ com<span class="hljs-selector-class">.example</span><span class="hljs-selector-class">.caffeine</span><span class="hljs-selector-class">.demo</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.UserService</span>;
importÂ lombok<span class="hljs-selector-class">.extern</span><span class="hljs-selector-class">.slf4j</span><span class="hljs-selector-class">.Slf4j</span>;
importÂ org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.beans</span><span class="hljs-selector-class">.factory</span><span class="hljs-selector-class">.annotation</span><span class="hljs-selector-class">.Autowired</span>;
importÂ org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.boot</span><span class="hljs-selector-class">.CommandLineRunner</span>;
importÂ org<span class="hljs-selector-class">.springframework</span><span class="hljs-selector-class">.stereotype</span><span class="hljs-selector-class">.Component</span>;

importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Arrays</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.List</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.CompletableFuture</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.ExecutorService</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.Executors</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.concurrent</span><span class="hljs-selector-class">.TimeUnit</span>;
importÂ java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">/**
Â *Â ç¼“å­˜é¢„çƒ­å¯åŠ¨å™¨
Â *
Â *Â åŠŸèƒ½ï¼š
Â *Â 1.Â åœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨é¢„çƒ­çƒ­ç‚¹æ•°æ®åˆ°ç¼“å­˜
Â *Â 2.Â æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥é¢„çƒ­æ–¹å¼
Â *Â 3.Â æ”¯æŒæ‰¹é‡é¢„çƒ­
Â *Â 4.Â æä¾›é¢„çƒ­è¿›åº¦ç›‘æ§
Â *Â 5.Â å¼‚å¸¸å¤„ç†å’Œé‡è¯•æœºåˆ¶
Â */</span>
<span class="hljs-keyword">@Slf</span>4j
<span class="hljs-keyword">@Component</span>
publicÂ classÂ CacheWarmupRunnerÂ implementsÂ CommandLineRunnerÂ {

Â Â Â Â <span class="hljs-keyword">@Autowired</span>
Â Â Â Â privateÂ UserServiceÂ userService;

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­é…ç½®
Â Â Â Â Â */</span>
Â Â Â Â privateÂ staticÂ classÂ WarmupConfigÂ {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç”¨æˆ·IDåˆ—è¡¨ï¼ˆå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚é…ç½®ï¼‰</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ List&lt;Long&gt;Â HOT_USER_IDSÂ =Â Arrays<span class="hljs-selector-class">.asList</span>(<span class="hljs-number">1</span>L,Â <span class="hljs-number">2</span>L,Â <span class="hljs-number">3</span>L,Â <span class="hljs-number">4</span>L,Â <span class="hljs-number">5</span>L);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­æ‰¹æ¬¡å¤§å°</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ intÂ BATCH_SIZEÂ =Â <span class="hljs-number">3</span>;

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â çº¿ç¨‹æ± å¤§å°</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ intÂ THREAD_POOL_SIZEÂ =Â <span class="hljs-number">2</span>;

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ˜¯å¦å¯ç”¨å¼‚æ­¥é¢„çƒ­</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ booleanÂ ASYNC_WARMUPÂ =Â true;

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æœ€å¤§é‡è¯•æ¬¡æ•°</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ intÂ MAX_RETRY_TIMESÂ =Â <span class="hljs-number">3</span>;

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é‡è¯•é—´éš”ï¼ˆæ¯«ç§’ï¼‰</span>
Â Â Â Â Â Â Â Â privateÂ staticÂ finalÂ longÂ RETRY_INTERVALÂ =Â <span class="hljs-number">1000</span>L;
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">@Override</span>
Â Â Â Â publicÂ voidÂ run(String...Â args)Â throwsÂ ExceptionÂ {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("å¼€å§‹æ‰§è¡Œç¼“å­˜é¢„çƒ­...");
Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System<span class="hljs-selector-class">.currentTimeMillis</span>();

Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (WarmupConfig.ASYNC_WARMUP)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¼‚æ­¥é¢„çƒ­</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">asyncWarmup</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŒæ­¥é¢„çƒ­</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">syncWarmup</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â longÂ endTimeÂ =Â System<span class="hljs-selector-class">.currentTimeMillis</span>();
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("ç¼“å­˜é¢„çƒ­å®Œæˆï¼è€—æ—¶:Â {}Â ms",Â endTimeÂ -Â startTime);

Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("ç¼“å­˜é¢„çƒ­å¤±è´¥ï¼é”™è¯¯ä¿¡æ¯:Â {}",Â e.getMessage(),Â e);
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åŒæ­¥é¢„çƒ­æ–¹å¼
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">syncWarmup</span>()Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("ä½¿ç”¨åŒæ­¥æ–¹å¼é¢„çƒ­ç¼“å­˜...");

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ³•1ï¼šé€ä¸ªé¢„çƒ­</span>
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é€ä¸ªé¢„çƒ­ç”¨æˆ·æ•°æ®...");
Â Â Â Â Â Â Â Â forÂ (LongÂ userIdÂ :Â WarmupConfig.HOT_USER_IDS)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupSingleUser</span>(userId);
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ³•2ï¼šæ‰¹é‡é¢„çƒ­</span>
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("æ‰¹é‡é¢„çƒ­ç”¨æˆ·æ•°æ®...");
Â Â Â Â Â Â Â Â <span class="hljs-built_in">batchWarmupUsers</span>(WarmupConfig.HOT_USER_IDS);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ–¹æ³•3ï¼šé¢„çƒ­æ‰€æœ‰ç”¨æˆ·</span>
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­æ‰€æœ‰ç”¨æˆ·æ•°æ®...");
Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupAllUsers</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â å¼‚æ­¥é¢„çƒ­æ–¹å¼
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">asyncWarmup</span>()Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("ä½¿ç”¨å¼‚æ­¥æ–¹å¼é¢„çƒ­ç¼“å­˜...");

Â Â Â Â Â Â Â Â ExecutorServiceÂ executorÂ =Â Executors<span class="hljs-selector-class">.newFixedThreadPool</span>(WarmupConfig.THREAD_POOL_SIZE);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åˆ›å»ºå¼‚æ­¥é¢„çƒ­ä»»åŠ¡</span>
Â Â Â Â Â Â Â Â List&lt;CompletableFuture&lt;Void&gt;&gt;Â futuresÂ =Â WarmupConfig<span class="hljs-selector-class">.HOT_USER_IDS</span><span class="hljs-selector-class">.stream</span>()
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.map</span>(userIdÂ -&gt;Â CompletableFuture.runAsync(()Â -&gt;Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupSingleUserWithRetry</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("é¢„çƒ­ç”¨æˆ·Â {}Â å¤±è´¥:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â },Â executor))
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.collect</span>(Collectors.toList());

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ</span>
Â Â Â Â Â Â Â Â CompletableFuture<span class="hljs-selector-class">.allOf</span>(futures.toArray(newÂ CompletableFuture[<span class="hljs-number">0</span>]))
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.whenComplete</span>((result,Â ex)Â -&gt;Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (exÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("éƒ¨åˆ†é¢„çƒ­ä»»åŠ¡å¤±è´¥",Â ex);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("æ‰€æœ‰é¢„çƒ­ä»»åŠ¡å®Œæˆ");
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â executor<span class="hljs-selector-class">.shutdown</span>();
Â Â Â Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-selector-class">.join</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­å•ä¸ªç”¨æˆ·æ•°æ®ï¼ˆå¸¦é‡è¯•æœºåˆ¶ï¼‰
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupSingleUserWithRetry</span>(LongÂ userId)Â {
Â Â Â Â Â Â Â Â intÂ retryCountÂ =Â <span class="hljs-number">0</span>;
Â Â Â Â Â Â Â Â booleanÂ successÂ =Â false;

Â Â Â Â Â Â Â Â whileÂ (retryCountÂ &lt;Â WarmupConfig.MAX_RETRY_TIMESÂ &amp;&amp;Â !success)Â {
Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupSingleUser</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â successÂ =Â true;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.debug</span>("ç”¨æˆ·Â {}Â é¢„çƒ­æˆåŠŸï¼Œå°è¯•æ¬¡æ•°:Â {}",Â userId,Â retryCountÂ +Â <span class="hljs-number">1</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â retryCount++;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (retryCountÂ &gt;=Â WarmupConfig.MAX_RETRY_TIMES)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("ç”¨æˆ·Â {}Â é¢„çƒ­å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ <span class="hljs-built_in">RuntimeException</span>("é¢„çƒ­ç”¨æˆ·Â "Â +Â userIdÂ +Â "Â å¤±è´¥",Â e);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.warn</span>("ç”¨æˆ·Â {}Â é¢„çƒ­å¤±è´¥ï¼Œç¬¬{}æ¬¡é‡è¯•ã€‚é”™è¯¯:Â {}",Â userId,Â retryCount,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread<span class="hljs-selector-class">.sleep</span>(WarmupConfig.RETRY_INTERVAL);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (InterruptedExceptionÂ ie)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread<span class="hljs-selector-class">.currentThread</span>()<span class="hljs-selector-class">.interrupt</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â throwÂ newÂ <span class="hljs-built_in">RuntimeException</span>("é¢„çƒ­è¢«ä¸­æ–­",Â ie);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­å•ä¸ªç”¨æˆ·
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupSingleUser</span>(LongÂ userId)Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­ç”¨æˆ·:Â {}",Â userId);
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç”¨æˆ·åŸºæœ¬ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â UserÂ userÂ =Â userService<span class="hljs-selector-class">.getUserById</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.debug</span>("ç”¨æˆ·Â {}Â åŸºæœ¬ä¿¡æ¯é¢„çƒ­å®Œæˆ",Â userId);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç›¸å…³æ•°æ®ï¼ˆå¦‚æœæœ‰ï¼‰</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupRelatedData</span>(user);

Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("é¢„çƒ­ç”¨æˆ·Â {}Â å¤±è´¥:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡é¢„çƒ­ç”¨æˆ·æ•°æ®
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">batchWarmupUsers</span>(List&lt;Long&gt;Â userIds)Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("æ‰¹é‡é¢„çƒ­ç”¨æˆ·:Â {}",Â userIds);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æŒ‰æ‰¹æ¬¡å¤„ç†</span>
Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â <span class="hljs-number">0</span>;Â iÂ &lt;Â userIds.size();Â <span class="hljs-selector-tag">i</span>Â +=Â WarmupConfig<span class="hljs-selector-class">.BATCH_SIZE</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â intÂ endÂ =Â Math<span class="hljs-selector-class">.min</span>(iÂ +Â WarmupConfig.BATCH_SIZE,Â userIds.size());
Â Â Â Â Â Â Â Â Â Â Â Â List&lt;Long&gt;Â batchÂ =Â userIds<span class="hljs-selector-class">.subList</span>(i,Â end);

Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­ç¬¬Â {}Â æ‰¹ï¼Œç”¨æˆ·ID:Â {}",Â (iÂ /Â WarmupConfig.BATCH_SIZE)Â +Â <span class="hljs-number">1</span>,Â batch);

Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰¹é‡æŸ¥è¯¢</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Map&lt;Long,Â User&gt;Â usersÂ =Â userService<span class="hljs-selector-class">.batchGetUsers</span>(newÂ HashSet&lt;&gt;(batch));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("æ‰¹é‡é¢„çƒ­å®Œæˆï¼ŒæˆåŠŸé¢„çƒ­Â {}Â ä¸ªç”¨æˆ·",Â users.size());

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ æ‰¹æ¬¡é—´é—´éš”ï¼Œé¿å…å‹åŠ›è¿‡å¤§</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (endÂ &lt;Â userIds.size())Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">500</span>);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("æ‰¹é‡é¢„çƒ­å¤±è´¥:Â {}",Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å•ä¸ªé¢„çƒ­é™çº§</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â forÂ (LongÂ userIdÂ :Â batch)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupSingleUser</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ ex)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("é™çº§é¢„çƒ­ç”¨æˆ·Â {}Â å¤±è´¥:Â {}",Â userId,Â ex.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­æ‰€æœ‰ç”¨æˆ·
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupAllUsers</span>()Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("å¼€å§‹é¢„çƒ­æ‰€æœ‰ç”¨æˆ·æ•°æ®...");
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â List&lt;User&gt;Â allUsersÂ =Â userService<span class="hljs-selector-class">.getAllUsers</span>();
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­æ‰€æœ‰ç”¨æˆ·å®Œæˆï¼Œå…±Â {}Â ä¸ªç”¨æˆ·",Â allUsers.size());
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç”¨æˆ·çš„å…¶ä»–å…³è”æ•°æ®</span>
Â Â Â Â Â Â Â Â Â Â Â Â forÂ (UserÂ userÂ :Â allUsers)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupRelatedData</span>(user);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ é—´éš”ï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½è¿‡å¤šæ•°æ®</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Thread<span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">100</span>);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("é¢„çƒ­æ‰€æœ‰ç”¨æˆ·å¤±è´¥:Â {}",Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â throwÂ e;
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­ç›¸å…³æ•°æ®
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupRelatedData</span>(UserÂ user)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„çƒ­ç”¨æˆ·çš„è¡Œä¸ºæ•°æ®</span>
Â Â Â Â Â Â Â Â <span class="hljs-built_in">warmupUserActivities</span>(user.getId());
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â é¢„çƒ­ç”¨æˆ·è¡Œä¸ºæ•°æ®
Â Â Â Â Â */</span>
Â Â Â Â privateÂ voidÂ <span class="hljs-built_in">warmupUserActivities</span>(LongÂ userId)Â {
Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è°ƒç”¨è¡Œä¸ºæœåŠ¡é¢„çƒ­</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â activityService.warmupUserActivities(userId);</span>
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.debug</span>("é¢„çƒ­ç”¨æˆ·Â {}Â çš„è¡Œä¸ºæ•°æ®",Â userId);
Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.warn</span>("é¢„çƒ­ç”¨æˆ·Â {}Â çš„è¡Œä¸ºæ•°æ®å¤±è´¥:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â }
Â Â Â Â }


Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â éªŒè¯é¢„çƒ­ç»“æœ
Â Â Â Â Â */</span>
Â Â Â Â publicÂ voidÂ <span class="hljs-built_in">verifyWarmupResult</span>()Â {
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("éªŒè¯é¢„çƒ­ç»“æœ...");
Â Â Â Â Â Â Â Â intÂ successCountÂ =Â <span class="hljs-number">0</span>;
Â Â Â Â Â Â Â Â intÂ totalCountÂ =Â WarmupConfig<span class="hljs-selector-class">.HOT_USER_IDS</span><span class="hljs-selector-class">.size</span>();
Â Â Â Â Â Â Â Â forÂ (LongÂ userIdÂ :Â WarmupConfig.HOT_USER_IDS)Â {
Â Â Â Â Â Â Â Â Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æµ‹è¯•ç¼“å­˜æ˜¯å¦å‘½ä¸­</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System<span class="hljs-selector-class">.nanoTime</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â UserÂ userÂ =Â userService<span class="hljs-selector-class">.getUserById</span>(userId);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â longÂ endTimeÂ =Â System<span class="hljs-selector-class">.nanoTime</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â longÂ durationÂ =Â TimeUnit<span class="hljs-selector-class">.NANOSECONDS</span><span class="hljs-selector-class">.toMillis</span>(endTimeÂ -Â startTime);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (durationÂ &lt;Â <span class="hljs-number">10</span>)Â {Â <span class="hljs-comment">//Â å¦‚æœå“åº”æ—¶é—´å°äº10msï¼Œè¯´æ˜å‘½ä¸­äº†ç¼“å­˜</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â successCount++;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.debug</span>("ç”¨æˆ·Â {}Â ç¼“å­˜é¢„çƒ­éªŒè¯æˆåŠŸï¼Œå“åº”æ—¶é—´:Â {}Â ms",Â userId,Â duration);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.warn</span>("ç”¨æˆ·Â {}Â ç¼“å­˜é¢„çƒ­éªŒè¯å¤±è´¥ï¼Œå“åº”æ—¶é—´:Â {}Â ms",Â userId,Â duration);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.error</span>("éªŒè¯ç”¨æˆ·Â {}Â å¤±è´¥:Â {}",Â userId,Â e.getMessage());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â log<span class="hljs-selector-class">.info</span>("é¢„çƒ­ç»“æœéªŒè¯å®Œæˆï¼ŒæˆåŠŸç‡:Â {}Â /Â {}Â ({:.<span class="hljs-number">2</span>f}%)",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â successCount,Â totalCount,Â (double)Â successCountÂ /Â totalCountÂ *Â <span class="hljs-number">100</span>);
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-24">6.3 ç¼“å­˜ç›‘æ§</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e4458c72707476fb32e692560b310cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=wky0TvmiONYywhTeIPUlOrfciO0%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-typescript" lang="typescript">Â <span class="hljs-meta">@Autowired</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">CacheManager</span>Â cacheManager;
Â Â Â Â <span class="hljs-comment">//Â é¢„è­¦é˜ˆå€¼é…ç½®</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AlertThreshold</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å‘½ä¸­ç‡é˜ˆå€¼ï¼ˆä½äºæ­¤å€¼å‘å‡ºè­¦å‘Šï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ doubleÂ <span class="hljs-variable constant_">MIN_HIT_RATE</span>Â =Â <span class="hljs-number">0.8</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¹³å‡åŠ è½½æ—¶é—´é˜ˆå€¼ï¼ˆè¶…è¿‡æ­¤å€¼å‘å‡ºè­¦å‘Šï¼‰</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ longÂ <span class="hljs-variable constant_">MAX_AVG_LOAD_TIME_MS</span>Â =Â <span class="hljs-number">100</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å†…å­˜ä½¿ç”¨ç‡é˜ˆå€¼</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ doubleÂ <span class="hljs-variable constant_">MAX_MEMORY_USAGE_PERCENT</span>Â =Â <span class="hljs-number">80.0</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é”™è¯¯ç‡é˜ˆå€¼</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ doubleÂ <span class="hljs-variable constant_">MAX_ERROR_RATE</span>Â =Â <span class="hljs-number">0.01</span>;
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç¼“å­˜å¤§å°é˜ˆå€¼</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">static</span>Â finalÂ longÂ <span class="hljs-variable constant_">MAX_CACHE_SIZE</span>Â =Â <span class="hljs-number">10000</span>;
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æ‰€æœ‰ç¼“å­˜çš„ç»Ÿè®¡ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/stats"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">ResponseEntity</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;&gt;Â <span class="hljs-title function_">getAllCacheStats</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è·å–æ‰€æœ‰ç¼“å­˜åç§°</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;Â cacheNamesÂ =Â cacheManager.<span class="hljs-title function_">getCacheNames</span>();
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"timestamp"</span>,Â <span class="hljs-title class_">LocalDateTime</span>.<span class="hljs-title function_">now</span>());
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"cacheNames"</span>,Â cacheNames);
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"cacheCount"</span>,Â cacheNames.<span class="hljs-title function_">size</span>());
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç»Ÿè®¡æ±‡æ€»</span>
Â Â Â Â Â Â Â Â <span class="hljs-title class_">CacheSummary</span>Â summaryÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">CacheSummary</span>();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â (<span class="hljs-title class_">String</span>Â cacheNameÂ :Â cacheNames)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;Â cacheStatÂ =Â <span class="hljs-title function_">getCacheStat</span>(cacheName);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(cacheName,Â cacheStat);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ±‡æ€»ç»Ÿè®¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â summary.<span class="hljs-title function_">aggregate</span>(cacheStat);
Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è·å–ç¼“å­˜Â {}Â çš„ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:Â {}"</span>,Â cacheName,Â e.<span class="hljs-title function_">getMessage</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(cacheName,Â <span class="hljs-string">"è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:Â "</span>Â +Â e.<span class="hljs-title function_">getMessage</span>());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"summary"</span>,Â summary);
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"health"</span>,Â <span class="hljs-title function_">getCacheHealthStatus</span>(summary));
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">ResponseEntity</span>.<span class="hljs-title function_">ok</span>(result);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–æŒ‡å®šç¼“å­˜çš„ç»Ÿè®¡ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/stats/{cacheName}"</span>)
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">ResponseEntity</span>&lt;<span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;&gt;Â <span class="hljs-title function_">getCacheStat</span>(<span class="hljs-params"><span class="hljs-meta">@PathVariable</span>Â <span class="hljs-built_in">String</span>Â cacheName</span>)Â {
Â Â Â Â Â Â Â Â log.<span class="hljs-title function_">info</span>(<span class="hljs-string">"è·å–ç¼“å­˜Â {}Â çš„ç»Ÿè®¡ä¿¡æ¯"</span>,Â cacheName);
Â Â Â Â Â Â Â Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">String</span>,Â <span class="hljs-title class_">Object</span>&gt;Â resultÂ =Â <span class="hljs-keyword">new</span>Â <span class="hljs-title class_">HashMap</span>&lt;&gt;();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Cache</span>Â springCacheÂ =Â cacheManager.<span class="hljs-title function_">getCache</span>(cacheName);
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (springCacheÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">ResponseEntity</span>.<span class="hljs-title function_">notFound</span>().<span class="hljs-title function_">build</span>();
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Object</span>Â nativeCacheÂ =Â springCache.<span class="hljs-title function_">getNativeCache</span>();
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (nativeCacheÂ <span class="hljs-keyword">instanceof</span>Â <span class="hljs-title class_">Cache</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Cache</span>&lt;?,Â ?&gt;Â cacheÂ =Â (<span class="hljs-title class_">Cache</span>&lt;?,Â ?&gt;)Â nativeCache;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">CacheStats</span>Â statsÂ =Â cache.<span class="hljs-title function_">stats</span>();
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŸºæœ¬ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"name"</span>,Â cacheName);
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"size"</span>,Â <span class="hljs-title function_">estimateCacheSize</span>(cache));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"estimatedMemoryUsage"</span>,Â <span class="hljs-title function_">estimateMemoryUsage</span>(cache));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ç»Ÿè®¡æ•°æ®</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"requestCount"</span>,Â stats.<span class="hljs-title function_">requestCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"hitCount"</span>,Â stats.<span class="hljs-title function_">hitCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"missCount"</span>,Â stats.<span class="hljs-title function_">missCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"hitRate"</span>,Â stats.<span class="hljs-title function_">hitRate</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"missRate"</span>,Â stats.<span class="hljs-title function_">missRate</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â åŠ è½½ç»Ÿè®¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"loadSuccessCount"</span>,Â stats.<span class="hljs-title function_">loadSuccessCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"loadFailureCount"</span>,Â stats.<span class="hljs-title function_">loadFailureCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"loadFailureRate"</span>,Â <span class="hljs-title function_">calculateLoadFailureRate</span>(stats));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"totalLoadTime"</span>,Â stats.<span class="hljs-title function_">totalLoadTime</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"averageLoadPenalty"</span>,Â stats.<span class="hljs-title function_">averageLoadPenalty</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·˜æ±°ç»Ÿè®¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"evictionCount"</span>,Â stats.<span class="hljs-title function_">evictionCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"evictionWeight"</span>,Â stats.<span class="hljs-title function_">evictionWeight</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å…¶ä»–ç»Ÿè®¡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"rejectionCount"</span>,Â stats.<span class="hljs-title function_">rejectionCount</span>());
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è®¡ç®—è¡ç”ŸæŒ‡æ ‡</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"errorRate"</span>,Â <span class="hljs-title function_">calculateErrorRate</span>(stats));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"loadSuccessRate"</span>,Â <span class="hljs-title function_">calculateLoadSuccessRate</span>(stats));
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â é¢„è­¦ä¿¡æ¯</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"alerts"</span>,Â <span class="hljs-title function_">checkCacheAlerts</span>(cacheName,Â stats,Â cache.<span class="hljs-title function_">estimatedSize</span>()));
Â Â Â Â Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"error"</span>,Â <span class="hljs-string">"ä¸æ”¯æŒçš„ç¼“å­˜ç±»å‹:Â "</span>Â +Â nativeCache.<span class="hljs-title function_">getClass</span>().<span class="hljs-title function_">getName</span>());
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">Exception</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"è·å–ç¼“å­˜Â {}Â ç»Ÿè®¡ä¿¡æ¯å¤±è´¥:Â {}"</span>,Â cacheName,Â e.<span class="hljs-title function_">getMessage</span>());
Â Â Â Â Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"error"</span>,Â e.<span class="hljs-title function_">getMessage</span>());
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â result.<span class="hljs-title function_">put</span>(<span class="hljs-string">"timestamp"</span>,Â <span class="hljs-title class_">LocalDateTime</span>.<span class="hljs-title function_">now</span>());
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">ResponseEntity</span>.<span class="hljs-title function_">ok</span>(result);
Â Â Â Â }
</code></pre>
<h2 data-id="heading-25">7. æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d2dffb22ad91461a8f99e3004d37810b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769240782&amp;x-signature=wNJ8gy1A7MDRs2dww%2FMgRI0bpkg%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-26">7.1 æ‰¹é‡åŠ è½½ä¼˜åŒ–</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â æ‰¹é‡åŠ è½½ä¼˜åŒ–</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">BatchUserService</span>Â {

Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-keyword">final</span>Â AsyncLoadingCache&lt;<span class="hljs-built_in">Long</span>,Â User&gt;Â userCache;

Â Â Â Â <span class="hljs-keyword">public</span>Â BatchUserService()Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>.userCacheÂ =Â Caffeine.newBuilder()
Â Â Â Â Â Â Â Â Â Â Â Â .maximumSize(<span class="hljs-number">1000</span>)
Â Â Â Â Â Â Â Â Â Â Â Â .expireAfterWrite(<span class="hljs-number">10</span>,Â TimeUnit.MINUTES)
Â Â Â Â Â Â Â Â Â Â Â Â .buildAsync(<span class="hljs-keyword">this</span>::batchLoadUsers);
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">private</span>Â Map&lt;<span class="hljs-built_in">Long</span>,Â User&gt;Â batchLoadUsers(Set&lt;<span class="hljs-built_in">Long</span>&gt;Â userIds)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (userIds.isEmpty())Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â Collections.emptyMap();
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ‰¹é‡æŸ¥è¯¢æ•°æ®åº“</span>
Â Â Â Â Â Â Â Â List&lt;User&gt;Â usersÂ =Â userRepository.findAllById(userIds);

Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è½¬æ¢ä¸ºMap</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â users.stream()
Â Â Â Â Â Â Â Â Â Â Â Â .collect(Collectors.toMap(User::getId,Â userÂ -&gt;Â user));
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">public</span>Â Map&lt;<span class="hljs-built_in">Long</span>,Â User&gt;Â getUsers(Set&lt;<span class="hljs-built_in">Long</span>&gt;Â userIds)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userCache.getAll(userIds).join();
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-27">8. å®æˆ˜æ¡ˆä¾‹</h2>
<h3 data-id="heading-28">8.1 ç”¨æˆ·ä¿¡æ¯ç¼“å­˜æœåŠ¡</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Cache</span>;
<span class="hljs-keyword">import</span>Â com.<span class="hljs-property">github</span>.<span class="hljs-property">benmanes</span>.<span class="hljs-property">caffeine</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">Caffeine</span>;
<span class="hljs-keyword">import</span>Â org.<span class="hljs-property">springframework</span>.<span class="hljs-property">stereotype</span>.<span class="hljs-property">Service</span>;

<span class="hljs-keyword">import</span>Â java.<span class="hljs-property">util</span>.<span class="hljs-property">concurrent</span>.<span class="hljs-property">TimeUnit</span>;

<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserInfoCacheService</span>Â {

Â Â Â Â <span class="hljs-keyword">private</span>Â finalÂ <span class="hljs-title class_">Cache</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">UserInfo</span>&gt;Â userInfoCache;

Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">UserInfoCacheService</span>()Â {
Â Â Â Â Â Â Â Â <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfoCache</span>Â =Â <span class="hljs-title class_">Caffeine</span>.<span class="hljs-title function_">newBuilder</span>()
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">maximumSize</span>(<span class="hljs-number">10000</span>)
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">expireAfterWrite</span>(<span class="hljs-number">30</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">expireAfterAccess</span>(<span class="hljs-number">10</span>,Â <span class="hljs-title class_">TimeUnit</span>.<span class="hljs-property">MINUTES</span>)
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">recordStats</span>()
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">build</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">UserInfo</span>Â <span class="hljs-title function_">getUserInfo</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userInfoCache.<span class="hljs-title function_">get</span>(userId,Â <span class="hljs-attr">this</span>::loadUserInfoFromDB);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">UserInfo</span>&gt;Â <span class="hljs-title function_">batchGetUserInfo</span>(<span class="hljs-params"><span class="hljs-built_in">Set</span>&lt;Long&gt;Â userIds</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userInfoCache.<span class="hljs-title function_">getAll</span>(userIds,Â <span class="hljs-attr">this</span>::batchLoadUserInfoFromDB);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ›´æ–°ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">updateUserInfo</span>(<span class="hljs-params">LongÂ userId,Â UserInfoÂ userInfo</span>)Â {
Â Â Â Â Â Â Â Â userInfoCache.<span class="hljs-title function_">put</span>(userId,Â userInfo);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â åˆ é™¤ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-built_in">void</span>Â <span class="hljs-title function_">removeUserInfo</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â userInfoCache.<span class="hljs-title function_">invalidate</span>(userId);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â è·å–ç¼“å­˜ç»Ÿè®¡
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">CacheStats</span>Â <span class="hljs-title function_">getCacheStats</span>(<span class="hljs-params"/>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userInfoCache.<span class="hljs-title function_">stats</span>();
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â ä»æ•°æ®åº“åŠ è½½ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">UserInfo</span>Â <span class="hljs-title function_">loadUserInfoFromDB</span>(<span class="hljs-params">LongÂ userId</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">try</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">100</span>);Â <span class="hljs-comment">//Â æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢è€—æ—¶</span>
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">catch</span>Â (<span class="hljs-title class_">InterruptedException</span>Â e)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">interrupt</span>();
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userRepository.<span class="hljs-title function_">findById</span>(userId);
Â Â Â Â }

Â Â Â Â <span class="hljs-comment">/**
Â Â Â Â Â *Â æ‰¹é‡ä»æ•°æ®åº“åŠ è½½ç”¨æˆ·ä¿¡æ¯
Â Â Â Â Â */</span>
Â Â Â Â <span class="hljs-keyword">private</span>Â <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">Long</span>,Â <span class="hljs-title class_">UserInfo</span>&gt;Â <span class="hljs-title function_">batchLoadUserInfoFromDB</span>(<span class="hljs-params"><span class="hljs-built_in">Set</span>&lt;Long&gt;Â userIds</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â userRepository.<span class="hljs-title function_">findAllById</span>(userIds).<span class="hljs-title function_">stream</span>()
Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">collect</span>(<span class="hljs-title class_">Collectors</span>.<span class="hljs-title function_">toMap</span>(<span class="hljs-title class_">UserInfo</span>::getId,Â <span class="hljs-title class_">Function</span>.<span class="hljs-title function_">identity</span>()));
Â Â Â Â }
}
</code></pre>
<h2 data-id="heading-29">9. æ€»ç»“</h2>
<p>Caffeineä½œä¸ºJavaç¼“å­˜é¢†åŸŸçš„ä½¼ä½¼è€…ï¼Œå‡­å€Ÿå…¶å‡ºè‰²çš„æ€§èƒ½å’Œä¸°å¯Œçš„åŠŸèƒ½ï¼Œå·²ç»æˆä¸ºè®¸å¤šé¡¹ç›®çš„é¦–é€‰ç¼“å­˜æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[5å¤§æ ¸å¿ƒåˆ†æç»´åº¦+3ç§å¯è§†åŒ–æ–¹æ¡ˆï¼šè„‘è‚¿ç˜¤å¤§æ•°æ®åˆ†æç³»ç»Ÿå…¨è§£æ æ¯•ä¸šè®¾è®¡ é€‰é¢˜æ¨è æ¯•è®¾é€‰é¢˜ æ•°æ®åˆ†æ æœºå™¨å­¦ä¹ ]]></title>    <link>https://juejin.cn/post/7595859552347979828</link>    <guid>https://juejin.cn/post/7595859552347979828</guid>    <pubDate>2026-01-17T07:51:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595859552347979828" data-draft-id="7595878718171234340" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="5å¤§æ ¸å¿ƒåˆ†æç»´åº¦+3ç§å¯è§†åŒ–æ–¹æ¡ˆï¼šè„‘è‚¿ç˜¤å¤§æ•°æ®åˆ†æç³»ç»Ÿå…¨è§£æ æ¯•ä¸šè®¾è®¡ é€‰é¢˜æ¨è æ¯•è®¾é€‰é¢˜ æ•°æ®åˆ†æ æœºå™¨å­¦ä¹ "/> <meta itemprop="keywords" content="åç«¯,Python,å¤§æ•°æ®"/> <meta itemprop="datePublished" content="2026-01-17T07:51:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è®¡ç®—æœºç¼–ç¨‹æŒ‡å¯¼å¸ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/881156097585216"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            5å¤§æ ¸å¿ƒåˆ†æç»´åº¦+3ç§å¯è§†åŒ–æ–¹æ¡ˆï¼šè„‘è‚¿ç˜¤å¤§æ•°æ®åˆ†æç³»ç»Ÿå…¨è§£æ æ¯•ä¸šè®¾è®¡ é€‰é¢˜æ¨è æ¯•è®¾é€‰é¢˜ æ•°æ®åˆ†æ æœºå™¨å­¦ä¹ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/881156097585216/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è®¡ç®—æœºç¼–ç¨‹æŒ‡å¯¼å¸ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T07:51:17.000Z" title="Sat Jan 17 2026 07:51:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è„‘è‚¿ç˜¤æ•°æ®å¯è§†åŒ–åˆ†ç³»ç»Ÿ-ç®€ä»‹</h2>
<p>æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºHadoop+Sparkçš„å¤§æ•°æ®åˆ†æå¹³å°ï¼Œä¸“æ³¨äºè„‘è‚¿ç˜¤åŒ»ç–—æ•°æ®çš„å¯è§†åŒ–ç ”ç©¶ã€‚ç³»ç»Ÿåç«¯é‡‡ç”¨Pythonè¯­è¨€ï¼Œç»“åˆDjangoæ¡†æ¶æ„å»ºæœåŠ¡æ¥å£ï¼Œå¹¶åˆ©ç”¨Sparkè¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„é«˜æ•ˆå¤„ç†ä¸è®¡ç®—ã€‚åŸå§‹è„‘è‚¿ç˜¤æ•°æ®å­˜å‚¨äºHadoopåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆHDFSï¼‰ä¸­ï¼Œé€šè¿‡Spark SQLå¯¹æ•°æ®è¿›è¡Œæ¸…æ´—ã€è½¬æ¢å’Œå¤šç»´åº¦èšåˆåˆ†æã€‚åˆ†æåŠŸèƒ½æ¶µç›–æ‚£è€…äººå£å­¦ç‰¹å¾ã€è‚¿ç˜¤ä¸´åºŠç‰¹å¾ã€æ²»ç–—æ–¹æ¡ˆä¸é¢„åæ•ˆæœã€ä¸´åºŠç—‡çŠ¶å…³è”æ€§ä»¥åŠé«˜é£é™©å› ç´ æ¢ç´¢ç­‰äº”å¤§æ ¸å¿ƒæ¨¡å—ã€‚å¤„ç†åçš„ç»“æœç»ç”±Django APIä¼ é€’è‡³å‰ç«¯ï¼Œå‰ç«¯åˆ™è¿ç”¨Vueæ¡†æ¶ç»“åˆElementUIç»„ä»¶åº“ä¸Echartså›¾è¡¨åº“ï¼Œå°†å¤æ‚çš„æ•°æ®å…³ç³»è½¬åŒ–ä¸ºç›´è§‚çš„äº¤äº’å¼å›¾è¡¨ï¼Œå¦‚æ€§åˆ«å¹´é¾„åˆ†å¸ƒã€è‚¿ç˜¤ä½ç½®ä¸æ¶æ€§ç¨‹åº¦å…³è”ã€ä¸åŒæ²»ç–—æ–¹æ¡ˆç”Ÿå­˜ç‡å¯¹æ¯”ç­‰ï¼Œä¸ºåŒ»ç–—ç ”ç©¶è€…å’Œä¸´åºŠåŒ»ç”Ÿæä¾›ä¸€ä¸ªå…¨é¢ã€é«˜æ•ˆçš„æ•°æ®æ´å¯Ÿå·¥å…·ã€‚</p>
<h2 data-id="heading-1">è„‘è‚¿ç˜¤æ•°æ®å¯è§†åŒ–åˆ†ç³»ç»Ÿ-æŠ€æœ¯</h2>
<p>å¼€å‘è¯­è¨€ï¼šPythonæˆ–Java
å¤§æ•°æ®æ¡†æ¶ï¼šHadoop+Sparkï¼ˆæœ¬æ¬¡æ²¡ç”¨Hiveï¼Œæ”¯æŒå®šåˆ¶ï¼‰
åç«¯æ¡†æ¶ï¼šDjango+Spring Boot(Spring+SpringMVC+Mybatis)
å‰ç«¯ï¼šVue+ElementUI+Echarts+HTML+CSS+JavaScript+jQuery
è¯¦ç»†æŠ€æœ¯ç‚¹ï¼šHadoopã€HDFSã€Sparkã€Spark SQLã€Pandasã€NumPy
æ•°æ®åº“ï¼šMySQL</p>
<h2 data-id="heading-2">è„‘è‚¿ç˜¤æ•°æ®å¯è§†åŒ–åˆ†ç³»ç»Ÿ-èƒŒæ™¯</h2>
<p>é€‰é¢˜èƒŒæ™¯
éšç€åŒ»ç–—ä¿¡æ¯åŒ–è¿›ç¨‹çš„åŠ å¿«ï¼ŒåŒ»é™¢ç§¯ç´¯äº†æµ·é‡çš„è„‘è‚¿ç˜¤æ‚£è€…è¯Šç–—æ•°æ®ï¼Œè¿™äº›æ•°æ®åŒ…å«äº†ä»æ‚£è€…åŸºæœ¬ä¿¡æ¯åˆ°å¤æ‚æ²»ç–—æ–¹æ¡ˆçš„å¤šä¸ªç»´åº¦ã€‚è„‘è‚¿ç˜¤æœ¬èº«ä½œä¸ºä¸€ç§å¤æ‚çš„ç–¾ç—…ï¼Œå…¶æˆå› ã€å‘å±•å’Œæ²»ç–—æ•ˆæœå—åˆ°ä¼—å¤šå› ç´ äº¤ç»‡å½±å“ã€‚é¢å¯¹å¦‚æ­¤åºå¤§ä¸”å…³ç³»é”™ç»¼å¤æ‚çš„æ•°æ®é›†ï¼Œä¼ ç»Ÿçš„ç»Ÿè®¡åˆ†æå·¥å…·å¾€å¾€æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œéš¾ä»¥å¿«é€Ÿã€å…¨é¢åœ°æ­ç¤ºéšè—åœ¨æ•°æ®èƒŒåçš„è§„å¾‹ã€‚å¦‚ä½•æœ‰æ•ˆåˆ©ç”¨è¿™äº›å®è´µçš„æ•°æ®èµ„äº§ï¼Œä»ä¸­å‘ç°æœ‰ä»·å€¼çš„ä¸´åºŠæ´è§ï¼Œè¾…åŠ©åŒ»ç”Ÿè¿›è¡Œæ›´ç²¾å‡†çš„è¯Šæ–­å’Œæ²»ç–—å†³ç­–ï¼Œæˆä¸ºäº†å½“å‰åŒ»ç–—é¢†åŸŸé¢ä¸´çš„ä¸€ä¸ªå®é™…é—®é¢˜ã€‚å› æ­¤ï¼Œæ„å»ºä¸€ä¸ªèƒ½å¤Ÿå¤„ç†å’Œåˆ†æè¿™ç±»å¤æ‚æ•°æ®çš„ç³»ç»Ÿæ˜¾å¾—å°¤ä¸ºå¿…è¦ã€‚</p>
<p>é€‰é¢˜æ„ä¹‰
æœ¬è¯¾é¢˜çš„æ„ä¹‰åœ¨äºå°†å‰æ²¿çš„å¤§æ•°æ®æŠ€æœ¯åº”ç”¨äºå…·ä½“çš„åŒ»ç–—æ•°æ®åˆ†æåœºæ™¯ä¸­ï¼Œå…·æœ‰å¾ˆå¼ºçš„å®è·µä»·å€¼ã€‚ä»æŠ€æœ¯å±‚é¢çœ‹ï¼Œå®ƒå®Œæ•´åœ°å®è·µäº†ä»æ•°æ®å­˜å‚¨ã€åˆ†å¸ƒå¼è®¡ç®—åˆ°å‰ç«¯å¯è§†åŒ–çš„å…¨æµç¨‹ï¼Œå·©å›ºäº†å¯¹Hadoopå’ŒSparkç”Ÿæ€çš„ç†è§£ä¸åº”ç”¨èƒ½åŠ›ã€‚ä»åº”ç”¨è§’åº¦çœ‹ï¼Œç³»ç»Ÿé€šè¿‡å¤šç»´åº¦çš„äº¤äº’å¼å›¾è¡¨ï¼Œå°†åŸæœ¬æ¯ç‡¥çš„è„‘è‚¿ç˜¤æ•°æ®å˜å¾—ç›´è§‚æ˜“æ‡‚ï¼Œèƒ½å¤Ÿå¸®åŠ©åŒ»å­¦ä¸“ä¸šçš„å­¦ç”Ÿæˆ–åˆçº§ç ”ç©¶äººå‘˜å¿«é€ŸæŠŠæ¡æ•°æ®ç‰¹å¾ï¼Œå‘ç°ä¸€äº›æ½œåœ¨çš„ä¸´åºŠå…³è”æ¨¡å¼ï¼Œæ¯”å¦‚ç‰¹å®šå¹´é¾„æ®µçš„é«˜å‘è‚¿ç˜¤ç±»å‹æˆ–ä¸åŒæ²»ç–—æ–¹æ¡ˆçš„ç–—æ•ˆå¯¹æ¯”ã€‚è™½ç„¶ä½œä¸ºä¸€ä¸ªæ¯•ä¸šè®¾è®¡ï¼Œå…¶åˆ†ææ·±åº¦å’Œæ¨¡å‹ç²¾åº¦æœ‰é™ï¼Œä½†å®ƒä¸ºæ¢ç´¢åŒ»ç–—æ•°æ®çš„ä»·å€¼æä¾›äº†ä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•å’Œæ€è·¯ï¼Œå±•ç¤ºäº†å¤§æ•°æ®æŠ€æœ¯åœ¨ç²¾å‡†åŒ»ç–—é¢†åŸŸçš„åº”ç”¨æ½œåŠ›ã€‚</p>
<h2 data-id="heading-3">è„‘è‚¿ç˜¤æ•°æ®å¯è§†åŒ–åˆ†ç³»ç»Ÿ-è§†é¢‘å±•ç¤º</h2>
<p>[video(video-53oW3KNj-1768628790189)(type-csdn)(url-<a href="https://link.juejin.cn?target=https%3A%2F%2Flive.csdn.net%2Fv%2Fembed%2F510509)(image-https%3A%2F%2Fi-blog.csdnimg.cn%2Fdirect%2Fba107941315b4411b07040a15571a3d1.png)(title-%25E5%259F%25BA%25E4%25BA%258EHadoop%2BSpark%25E7%259A%2584%25E8%2584%2591%25E8%2582%25BF%25E7%2598%25A4%25E6%2595%25B0%25E6%258D%25AE%25E5%258F%25AF%25E8%25A7%2586%25E5%258C%2596%25E5%2588%2586%25E7%25B3%25BB%25E7%25BB%259F" target="_blank" title="https://live.csdn.net/v/embed/510509)(image-https://i-blog.csdnimg.cn/direct/ba107941315b4411b07040a15571a3d1.png)(title-%E5%9F%BA%E4%BA%8EHadoop+Spark%E7%9A%84%E8%84%91%E8%82%BF%E7%98%A4%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E7%B3%BB%E7%BB%9F" ref="nofollow noopener noreferrer">live.csdn.net/v/embed/510â€¦</a>)]</p>
<h2 data-id="heading-4">è„‘è‚¿ç˜¤æ•°æ®å¯è§†åŒ–åˆ†ç³»ç»Ÿ-å›¾ç‰‡å±•ç¤º</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b1ca6479f27640cea8fc037c722e9626~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=L0L4Ooc%2BC%2BVlgNYPQq3nDbOt%2BAk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61167753b6894641894b32b7db9fb88d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=czPlR0ro48G9eNe2e7Wp7OQ%2B9ME%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ef857ad3c8f470ab1f897a47ed43b19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=V%2Bw1wUNaYt8rgqSj9RndYKmQiBE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d34aff6a7fc54254b5da103426ef75c6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=k12dpiENNLtfduJjMg9ISoNFvb0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d51ab6cab7144bfb9e3c3bddfd65c128~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=Ne8fzBXWEk31IeFo3Iq%2BhCRzZCM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4517d050331f47d98cb50fec03307c63~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=aMU5wKvmetBFw%2BWL1qBC%2Bj2VKzg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8bf6a4bb6e794084babc2721a675edd8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=4bFpALfQjiyQfdqLAob4BCFqyi0%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b64fe039a2e3403c9b66be7c381c5f72~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=Uf5IHjRxrequrUB30UpDqS0t4xk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ebbdbb846879468591e47ed6cd5b03ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=G0yXRlkvPLkgPWOMFnDKSjd3CUg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8668a1825a574a5da064bd933f3bc979~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=CMK7xL3HL4W7t%2BvwZ2hWvxBpKpo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/66a048459d774ab3bc78a6a73acdbca9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6K6h566X5py657yW56iL5oyH5a-85biI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769241077&amp;x-signature=9wk1%2FM%2BH1lWcRTGtc6i0MMbP6NY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-5">è„‘è‚¿ç˜¤æ•°æ®å¯è§†åŒ–åˆ†ç³»ç»Ÿ-ä»£ç å±•ç¤º</h2>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> pyspark.sql <span class="hljs-keyword">import</span> SparkSession, functions <span class="hljs-keyword">as</span> F
<span class="hljs-keyword">from</span> pyspark.sql.types <span class="hljs-keyword">import</span> IntegerType
spark = SparkSession.builder.appName(<span class="hljs-string">"BrainTumorAnalysis"</span>).getOrCreate()
df = spark.read.csv(<span class="hljs-string">"hdfs://path/to/brain_tumor_data.csv"</span>, header=<span class="hljs-literal">True</span>, inferSchema=<span class="hljs-literal">True</span>)
<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_age_gender_distribution</span>():
    age_group_df = df.withColumn(<span class="hljs-string">"Age_Group"</span>, F.when((df.Age &lt; <span class="hljs-number">18</span>), <span class="hljs-string">"å°‘å¹´"</span>).when((df.Age &gt;= <span class="hljs-number">18</span>) &amp; (df.Age &lt; <span class="hljs-number">40</span>), <span class="hljs-string">"é’å¹´"</span>).when((df.Age &gt;= <span class="hljs-number">40</span>) &amp; (df.Age &lt; <span class="hljs-number">60</span>), <span class="hljs-string">"ä¸­å¹´"</span>).otherwise(<span class="hljs-string">"è€å¹´"</span>))
    result_df = age_group_df.groupBy(<span class="hljs-string">"Age_Group"</span>, <span class="hljs-string">"Gender"</span>).count().orderBy(<span class="hljs-string">"Age_Group"</span>, <span class="hljs-string">"Gender"</span>)
    result_df.show()
    <span class="hljs-keyword">return</span> result_df
<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_treatment_survival</span>():
    treatment_df = df.withColumn(<span class="hljs-string">"Treatment_Combination"</span>, F.concat_ws(<span class="hljs-string">"+"</span>, F.when(df.Surgery_Performed == <span class="hljs-string">"Yes"</span>, <span class="hljs-string">"æ‰‹æœ¯"</span>), F.when(df.Radiation_Treatment == <span class="hljs-string">"Yes"</span>, <span class="hljs-string">"æ”¾ç–—"</span>), F.when(df.Chemotherapy == <span class="hljs-string">"Yes"</span>, <span class="hljs-string">"åŒ–ç–—"</span>)))
    survival_df = treatment_df.groupBy(<span class="hljs-string">"Treatment_Combination"</span>).agg(F.avg(<span class="hljs-string">"Survival_Rate"</span>).alias(<span class="hljs-string">"Average_Survival_Rate"</span>), F.count(<span class="hljs-string">"*"</span>).alias(<span class="hljs-string">"Patient_Count"</span>)).orderBy(F.desc(<span class="hljs-string">"Average_Survival_Rate"</span>))
    survival_df.show()
    <span class="hljs-keyword">return</span> survival_df
<span class="hljs-keyword">def</span> <span class="hljs-title function_">analyze_correlation</span>():
    correlation_df = df.select(<span class="hljs-string">"Age"</span>, <span class="hljs-string">"Tumor_Size"</span>, <span class="hljs-string">"Survival_Rate"</span>, <span class="hljs-string">"Tumor_Growth_Rate"</span>).na.drop()
    age_size_corr = correlation_df.stat.corr(<span class="hljs-string">"Age"</span>, <span class="hljs-string">"Tumor_Size"</span>)
    age_survival_corr = correlation_df.stat.corr(<span class="hljs-string">"Age"</span>, <span class="hljs-string">"Survival_Rate"</span>)
    size_survival_corr = correlation_df.stat.corr(<span class="hljs-string">"Tumor_Size"</span>, <span class="hljs-string">"Survival_Rate"</span>)
    growth_survival_corr = correlation_df.stat.corr(<span class="hljs-string">"Tumor_Growth_Rate"</span>, <span class="hljs-string">"Survival_Rate"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹´é¾„ä¸è‚¿ç˜¤å°ºå¯¸çš„ç›¸å…³ç³»æ•°: <span class="hljs-subst">{age_size_corr}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹´é¾„ä¸ç”Ÿå­˜ç‡çš„ç›¸å…³ç³»æ•°: <span class="hljs-subst">{age_survival_corr}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è‚¿ç˜¤å°ºå¯¸ä¸ç”Ÿå­˜ç‡çš„ç›¸å…³ç³»æ•°: <span class="hljs-subst">{size_survival_corr}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"è‚¿ç˜¤ç”Ÿé•¿é€Ÿç‡ä¸ç”Ÿå­˜ç‡çš„ç›¸å…³ç³»æ•°: <span class="hljs-subst">{growth_survival_corr}</span>"</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">"age_size"</span>: age_size_corr, <span class="hljs-string">"age_survival"</span>: age_survival_corr, <span class="hljs-string">"size_survival"</span>: size_survival_corr, <span class="hljs-string">"growth_survival"</span>: growth_survival_corr}
</code></pre>
<h2 data-id="heading-6">è„‘è‚¿ç˜¤æ•°æ®å¯è§†åŒ–åˆ†ç³»ç»Ÿ-ç»“è¯­</h2>
<p>è¿™ä¸ªé¡¹ç›®å®Œæ•´èµ°é€šäº†å¤§æ•°æ®åˆ†ææµç¨‹ï¼Œä»Hadoopå­˜å‚¨åˆ°Sparkè®¡ç®—ï¼Œå†åˆ°å‰ç«¯å¯è§†åŒ–ï¼ŒæŠ€æœ¯æ ˆå¾ˆæ‰å®ã€‚å¸Œæœ›èƒ½ç»™æ­£åœ¨åšæ¯•è®¾çš„åŒå­¦ä¸€ç‚¹å¯å‘ã€‚å¦‚æœè§‰å¾—æœ‰å¸®åŠ©ï¼Œåˆ«å¿˜äº†ç‚¹èµæ”¶è—ï¼Œä½ çš„æ”¯æŒæ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ï¼</p>
<p>åˆšè‚å®Œè¿™ä¸ªåŸºäºSparkçš„è„‘è‚¿ç˜¤åˆ†ææ¯•è®¾ï¼Œæ„Ÿè§‰å¤´å‘åˆæ‰äº†ä¸å°‘ğŸ˜‚ã€‚æ•°æ®æ¸…æ´—å’Œç‰¹å¾å·¥ç¨‹çœŸçš„å¤ªç£¨äººäº†ï¼Œä½†æœ€åçœ‹åˆ°Echartså›¾è¡¨å‡ºæ¥çš„é‚£ä¸€åˆ»ï¼Œå€¼äº†ï¼å¤§å®¶é€‰é¢˜éƒ½å®šäº†å—ï¼Ÿè¯„è®ºåŒºèŠèŠï¼Œäº’ç›¸é¿å‘å•Šï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[nestjså­¦ä¹ 3ï¼šæ ¸å¿ƒæ¦‚å¿µæ‰«ç›²]]></title>    <link>https://juejin.cn/post/7595873251165257769</link>    <guid>https://juejin.cn/post/7595873251165257769</guid>    <pubDate>2026-01-17T03:21:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595873251165257769" data-draft-id="7595491816776040489" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="nestjså­¦ä¹ 3ï¼šæ ¸å¿ƒæ¦‚å¿µæ‰«ç›²"/> <meta itemprop="keywords" content="NestJS"/> <meta itemprop="datePublished" content="2026-01-17T03:21:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸€æ±Ÿä¸œæµæ°´"/> <meta itemprop="url" content="https://juejin.cn/user/1151943917181880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            nestjså­¦ä¹ 3ï¼šæ ¸å¿ƒæ¦‚å¿µæ‰«ç›²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1151943917181880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸€æ±Ÿä¸œæµæ°´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T03:21:02.000Z" title="Sat Jan 17 2026 03:21:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å£°æ˜ï¼šæœ¬æ–‡æ¥è‡ªäºå…‰ç¥çš„æ–‡ç« ï¼Œå¤åˆ¶åˆ°è¿™é‡Œåªæ˜¯ä¸ºäº†è‡ªå·±æ›´å¥½çš„å¤ä¹ ã€‚</p>
<p>Nest æ˜¯å¯¹æ ‡ Java çš„ Spring æ¡†æ¶çš„åç«¯æ¡†æ¶ï¼Œå®ƒæœ‰å¾ˆå¤šæ¦‚å¿µã€‚å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œä¸Šæ¥å°±æ¥è§¦è¿™äº›æ¦‚å¿µå¯èƒ½ä¼šæœ‰ç‚¹æ‡µï¼Œä»Šå¤©ä¸»è¦æ˜¯è¿‡ä¸€ä¸‹æ¦‚å¿µã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡ä¸åŒçš„ url æ¥è®¿é—®åç«¯æ¥å£ï¼š/user/create ã€/user/listã€/book/createã€/book/listï¼Œä¸åŒçš„ url æ˜¯ä¸åŒçš„è·¯ç”±ã€‚</p>
<p>è¿™äº›è·¯ç”±åœ¨ Controller é‡Œå£°æ˜ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3181246e60004f85bfefc5afe96ebc49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=uGDa6K40G5cxVK9E%2BuxiHQifeGs%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨ class ä¸Šå’Œå®ƒæ–¹æ³•çš„æ–¹æ³•ä¸ŠåŠ ä¸Š @Controllerã€@Getã€@Post çš„è£…é¥°å™¨å°±å¯ä»¥äº†ã€‚</p>
<p>controlleré‡Œé¢çš„æ–¹æ³•ï¼Œæ¯”å¦‚ createã€findAllç­‰å«åš <code>handler</code>ï¼Œæ˜¯å¤„ç†è·¯ç”±çš„ã€‚</p>
<p>post çš„è¯·æ±‚ä½“ï¼Œget çš„è¯·æ±‚å‚æ•°ï¼Œéƒ½å¯ä»¥é€šè¿‡è£…é¥°æ¥å–ï¼š</p>
<p>é€šè¿‡ @Param å– url ä¸­çš„å‚æ•°ï¼Œæ¯”å¦‚ /user/111 é‡Œçš„ 111:</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b18cdebe39f49f88aa9d6bda3772bcd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=dFTUpGAxAyyq6akjUa7e3NTFI%2Fk%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡ @Query æ¥å– url ä¸­çš„ query å‚æ•°ï¼Œæ¯”å¦‚ /user/xx?id=222 é‡Œçš„ 222</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b2cb2c2484d46aa87bd119e16022472~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=m9aWInXUgnqYm0bYXpVcNmJ1%2BUM%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡ @Body å– /book/create çš„è¯·æ±‚ä½“å†…å®¹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e3fde21f100a4369b1fb0b2e88b0579f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=4NX0db%2B15cH5JGysqbc2CMQYNlU%3D" alt="image.png" loading="lazy"/></p>
<p>é‚£<code>@Paramã€@Queryã€@Body</code>è£…é¥°å™¨åœ¨å…¶ä¸­èµ·äº†ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ</p>
<ul>
<li>å½“ NestJS åº”ç”¨å¯åŠ¨ã€åŠ è½½æ§åˆ¶å™¨ç±»æ—¶ï¼Œè£…é¥°å™¨ä¼š<strong>å…ˆæ‰§è¡Œ</strong>ï¼ˆè£…é¥°å™¨çš„æ‰§è¡Œæ—¶æœºæ˜¯ç±» / æ–¹æ³•å®šä¹‰æ—¶ï¼Œè€Œéè¯·æ±‚åˆ°æ¥æ—¶ï¼‰ï¼Œ<code>@Param('id')</code> çš„æ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-string">'reflect-metadata'</span>; 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Param</span>(<span class="hljs-params">paramKey?: string</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">target: object, methodKey: string | symbol, paramIndex: number</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">METADATA_KEY</span> = <span class="hljs-string">'nest:params:metadata'</span>;
        <span class="hljs-comment">// å…ˆè·å–è¯¥æ–¹æ³•å·²æœ‰çš„å…ƒæ•°æ®</span>
        <span class="hljs-keyword">const</span> existingMetadata = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">getMetadata</span>(<span class="hljs-variable constant_">METADATA_KEY</span>, target, methodKey) || [];
        existingMetadata[paramIndex] = { 
            <span class="hljs-attr">type</span>: <span class="hljs-string">'param'</span>, <span class="hljs-comment">// æ ‡è¯†å‚æ•°ç±»å‹æ˜¯è·¯ç”±å‚æ•° </span>
            <span class="hljs-attr">key</span>: paramKey, <span class="hljs-comment">// è¦æå–çš„å‚æ•°åï¼ˆæ¯”å¦‚ 'id'ï¼‰ </span>
        };
        <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">defineMetadata</span>(<span class="hljs-variable constant_">METADATA_KEY</span>, existingMetadata, target, methodKey);
}
</code></pre>
<ul>
<li>å½“å®¢æˆ·ç«¯å‘èµ· <code>GET /users/123</code> è¯·æ±‚æ—¶ï¼ŒNestJS çš„åº•å±‚ HTTP é€‚é…å™¨ï¼ˆExpress/Fastifyï¼‰è§£æè¯·æ±‚ï¼Œå¾—åˆ° <code>request</code> å¯¹è±¡ï¼Œå…¶ä¸­ <code>request.params = { id: '123' }</code>ã€‚NestJS ä¼šåˆ›å»ºæ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆExecutionContextï¼‰ï¼ŒæŠŠ <code>request</code>ã€<code>response</code>ã€è·¯ç”±åŒ¹é…ç»“æœç­‰éƒ½å°è£…è¿›å»ã€‚NestJS çš„å‚æ•°å¤„ç†å™¨ï¼ˆParameter Handlerï¼‰ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getParamValue</span>(<span class="hljs-params">target: object, methodKey: string, paramIndex: number, context: ExecutionContext</span>) {
  <span class="hljs-comment">// 1. è·å–æ­¥éª¤ 1 ä¸­å­˜å…¥çš„å…ƒæ•°æ®</span>
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">METADATA_KEY</span> = <span class="hljs-string">'nest:params:metadata'</span>;
  <span class="hljs-keyword">const</span> paramMetadata = <span class="hljs-title class_">Reflect</span>.<span class="hljs-title function_">getMetadata</span>(<span class="hljs-variable constant_">METADATA_KEY</span>, target, methodKey)[paramIndex];
  
  <span class="hljs-comment">// 2. ä»ä¸Šä¸‹æ–‡è·å– request å¯¹è±¡</span>
  <span class="hljs-keyword">const</span> request = context.<span class="hljs-title function_">switchToHttp</span>().<span class="hljs-title function_">getRequest</span>();
  
  <span class="hljs-comment">// 3. æ ¹æ®å…ƒæ•°æ®æå–å¯¹åº”å€¼</span>
  <span class="hljs-keyword">if</span> (paramMetadata.<span class="hljs-property">type</span> === <span class="hljs-string">'param'</span>) {
    <span class="hljs-comment">// å¦‚æœæŒ‡å®šäº† keyï¼ˆæ¯”å¦‚ 'id'ï¼‰ï¼Œå–å•ä¸ªå€¼ï¼›å¦åˆ™å–æ•´ä¸ª params å¯¹è±¡</span>
    <span class="hljs-keyword">return</span> paramMetadata.<span class="hljs-property">key</span> ? request.<span class="hljs-property">params</span>[paramMetadata.<span class="hljs-property">key</span>] : request.<span class="hljs-property">params</span>;
  }
}
</code></pre>
<ul>
<li>NestJS æŠŠä¸Šé¢æå–åˆ°çš„ <code>'123'</code> èµ‹å€¼ç»™ <code>findOne</code> æ–¹æ³•çš„ç¬¬ 0 ä¸ªå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯ <code>id</code>ï¼‰ï¼Œæ‰§è¡Œ <code>findOne</code> å‡½æ•°æ—¶<code>id</code> è¢«èµ‹å€¼ä¸º <code>'123'</code>ã€‚</li>
</ul>
<p>æ€»çš„æ¥è¯´å°±æ˜¯è¿™æ ·ï¼š</p>
<ol>
<li>
<p><strong>å®šä¹‰å…ƒæ•°æ®</strong>ï¼šåº”ç”¨å¯åŠ¨æ—¶ï¼Œ<code>@Param</code> è£…é¥°å™¨é€šè¿‡ <code>Reflect.defineMetadata</code> æŠŠå‚æ•°è¦ä»å“ªé‡Œå–å€¼çš„è§„åˆ™å­˜åœ¨æ–¹æ³•çš„å…ƒæ•°æ®ä¸­ï¼›</p>
</li>
<li>
<p><strong>è¿è¡Œæ—¶æ³¨å…¥</strong>ï¼šè¯·æ±‚åˆ°æ¥æ—¶ï¼ŒNestJS å…ˆé€šè¿‡ <code>Reflect.getMetadata</code> è¯»å–å…ƒæ•°æ®ï¼Œå†ä»è¯·æ±‚ä¸Šä¸‹æ–‡çš„ <code>request.params</code> ä¸­æå–å¯¹åº”å€¼ï¼Œæœ€åæ³¨å…¥åˆ°å‡½æ•°å‚æ•°ä¸­æ‰§è¡Œï¼›</p>
</li>
<li>
<p><strong>æ ¸å¿ƒä¾èµ–</strong>ï¼šæ•´ä¸ªè¿‡ç¨‹çš„åŸºç¡€æ˜¯ <code>Reflect Metadata</code> APIï¼Œå®ƒè®© NestJS èƒ½ â€œè®°ä½â€ è£…é¥°å™¨çš„è§„åˆ™ï¼Œå®ç°å‚æ•°çš„è‡ªåŠ¨æ³¨å…¥ï¼Œ<strong>æ— éœ€æ‰‹åŠ¨æ“ä½œ <code>request</code> å¯¹è±¡</strong>ã€‚</p>
</li>
</ol>
<blockquote>
<p>æ¡†æ¶è¿™æ ·åšçš„å¥½å¤„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>å¥½å¤„æ˜¯æˆ‘ä»¬æ— éœ€æ‰‹åŠ¨å¤„ç†<code>request</code>å¯¹è±¡ï¼Œå…¨æ˜¯æ¡†æ¶å¸®æˆ‘ä»¬åšäº†ã€‚ä½ åœ¨å†™expressæ—¶æ˜¯ä¸æ˜¯è‡ªå·±ä»requestå¯¹è±¡ä¸­è·å–å‚æ•°ï¼Œç‰¹åˆ«ç¹çã€‚</p>
</blockquote>
<p>å›å½’æ­£é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´Â <strong>controller æ˜¯å¤„ç†è·¯ç”±å’Œè§£æè¯·æ±‚å‚æ•°çš„</strong>ã€‚</p>
<p>è¯·æ±‚å‚æ•°è§£æå‡ºæ¥äº†ï¼Œä¸‹ä¸€æ­¥å°±æ˜¯åšä¸šåŠ¡é€»è¾‘çš„å¤„ç†äº†ï¼Œè¿™äº›ä¸œè¥¿ä¸å†™åœ¨ controller é‡Œï¼Œè€Œæ˜¯æ”¾åœ¨ service é‡Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/144f7d1085724893bf3ddbdf4311f099~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=g%2BpUfqYehgfL%2Bd%2Fj0MHSJAwC35U%3D" alt="image.png" loading="lazy"/></p>
<p><strong>service é‡Œåšä¸šåŠ¡é€»è¾‘çš„å…·ä½“å®ç°ï¼Œæ¯”å¦‚æ“ä½œæ•°æ®åº“ç­‰</strong></p>
<p>åŒç†ï¼Œ/book/listã€/book/create æ¥å£æ˜¯åœ¨å¦ä¸€ä¸ª BookController é‡Œï¼Œå®ƒçš„ä¸šåŠ¡é€»è¾‘å®ç°ä¹Ÿæ˜¯åœ¨ BookService é‡Œã€‚</p>
<p>å¾ˆæ˜æ˜¾ï¼ŒUserController å’Œ UserService æ˜¯ä¸€å—çš„ï¼ŒBookController å’Œ BookService æ˜¯ä¸€å—çš„ã€‚</p>
<p>æ‰€ä»¥ï¼ŒNest æœ‰äº†æ¨¡å—çš„åˆ’åˆ†ï¼Œæ¯ä¸ªæ¨¡å—é‡Œéƒ½åŒ…å« controller å’Œ serviceï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1c452baa95e24e109258a584904a769f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=faqdr2kQaPV9ffyB9QKkSY2UT1w%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡ @Module å£°æ˜æ¨¡å—ï¼Œå®ƒåŒ…å« controllers å’Œ providersã€‚</p>
<p>ä¸ºå•¥ä¸æ˜¯ services è€Œæ˜¯ providers å‘¢ï¼Ÿ</p>
<p>å› ä¸º Nest å®ç°äº†ä¸€å¥—ä¾èµ–æ³¨å…¥æœºåˆ¶ï¼Œå«åš IoCï¼ˆInverse of Control åè½¬æ§åˆ¶ï¼‰ã€‚</p>
<p>ç®€å•è¯´å°±æ˜¯ä½ åªéœ€è¦å£°æ˜ä¾èµ–äº†å•¥å°±è¡Œï¼Œä¸éœ€è¦æ‰‹åŠ¨å» new ä¾èµ–ï¼ŒNest çš„ IoC å®¹å™¨ä¼šè‡ªåŠ¨ç»™ä½ åˆ›å»ºå¹¶æ³¨å…¥ä¾èµ–ã€‚</p>
<p>æ¯”å¦‚è¿™ä¸ª UserController ä¾èµ–äº† JwtServiceï¼Œé‚£åªéœ€è¦é€šè¿‡ @Inject å£°æ˜ä¾èµ–ï¼Œç„¶åå°±å¯ä»¥åœ¨æ–¹æ³•é‡Œç”¨äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b39ec6743c2f4051a84af012f2644b70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=NiWMSzXFfWWKLavk%2B3jHitYF3%2FA%3D" alt="image.png" loading="lazy"/></p>
<p>è¿è¡Œçš„æ—¶å€™ä¼šè‡ªåŠ¨æŸ¥æ‰¾è¿™ä¸ª JwtServcie çš„å®ä¾‹æ¥æ³¨å…¥ã€‚</p>
<p><strong>åœ¨ @Module é‡Œçš„ providers æ•°ç»„é‡Œï¼Œå°±æ˜¯å£°æ˜è¦å¾€ IoC å®¹å™¨é‡Œæä¾›çš„å¯¹è±¡ï¼Œæ‰€ä»¥è¿™é‡Œå«åš providersã€‚</strong></p>
<p>provider æœ‰å¾ˆå¤šç§å†™æ³•ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4410d7fe085748d39efd8949f4e47248~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=8nnerrkKgLvTDerPZvPZW%2FvdVqI%3D" alt="image.png" loading="lazy"/></p>
<p>é»˜è®¤çš„ XxxService åªæ˜¯ä¸€ç§ç®€åŒ–çš„å†™æ³•ã€‚</p>
<p>è¿˜å¯ä»¥ç›´æ¥ useValue åˆ›å»ºï¼Œé€šè¿‡ useFactory åˆ›å»ºç­‰ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad7a6761a1e74507baa6c7e49a3e2769~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=JmvkW7WSlLixwdKaC1V84jJz7Ac%3D" alt="image.png" loading="lazy"/></p>
<p>åˆšæ‰æåˆ°äº† IoC ä¼šè‡ªåŠ¨ä»å®¹å™¨ä¸­æŸ¥æ‰¾å®ä¾‹æ¥æ³¨å…¥ï¼Œæ³¨å…¥çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š</p>
<p><strong>å±æ€§æ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥ã€‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/67e2068d805f4e25901c6fcf5e04a162~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=VUyJvI5Tn6WJBGI%2BGMA32NiPVrw%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ç§å†™åœ¨æ„é€ å™¨é‡Œçš„ä¾èµ–ï¼Œå°±æ˜¯æ„é€ å™¨æ³¨å…¥ã€‚</p>
<p>@Inject å†™åœ¨å±æ€§ä¸Šçš„ä¾èµ–ï¼Œå°±æ˜¯å±æ€§æ³¨å…¥ã€‚</p>
<p>æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯æ³¨å…¥çš„æ—¶æœºä¸åŒã€‚</p>
<p>æ¯ä¸ªæ¨¡å—éƒ½ä¼šåŒ…å« controllerã€serviceã€moduleã€dtoã€entities è¿™äº›ä¸œè¥¿ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/accdd60bafff4c5b9ffeaaeb0274cbe1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=d2%2BhuQzY2waoUohU7aCZJ2Upgwk%3D" alt="image.png" loading="lazy"/></p>
<p>controller æ˜¯å¤„ç†è·¯ç”±ï¼Œè§£æè¯·æ±‚å‚æ•°çš„ã€‚</p>
<p>service æ˜¯å¤„ç†ä¸šåŠ¡é€»è¾‘çš„ï¼Œæ¯”å¦‚æ“ä½œæ•°æ®åº“ã€‚</p>
<p>dto æ˜¯å°è£…è¯·æ±‚å‚æ•°çš„ã€‚</p>
<p>entities æ˜¯å°è£…å¯¹åº”æ•°æ®åº“è¡¨çš„å®ä½“çš„ã€‚</p>
<p>nest åº”ç”¨è·‘èµ·æ¥åï¼Œä¼šä» AppModule å¼€å§‹è§£æï¼Œåˆå§‹åŒ– IoC å®¹å™¨ï¼ŒåŠ è½½æ‰€æœ‰çš„ service åˆ°å®¹å™¨é‡Œï¼Œç„¶åè§£æ controller é‡Œçš„è·¯ç”±ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥æ¥æ”¶è¯·æ±‚äº†ã€‚</p>
<p>åº”ç”¨ä¸­ä¼šæœ‰å¾ˆå¤š controllerã€serviceï¼Œé‚£å¦‚æœæ˜¯è·¨å¤šä¸ª controller çš„é€»è¾‘å‘¢ï¼Ÿ</p>
<p>è¿™ç§åœ¨ Nest æä¾›äº† AOP ï¼ˆAspect Oriented Programming é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰çš„æœºåˆ¶</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cbe82217eb164362b240efc1c3dae1e0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=QkkKSKL182OVLuGYMv7%2BHroFwEU%3D" alt="image.png" loading="lazy"/></p>
<p>å…·ä½“æ¥è¯´ï¼Œæœ‰ Middlewareã€Guardã€Interceptorã€Pipeã€Exception Filter è¿™äº”ç§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b377262312524529acbf6e47cdd404e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=xwuk%2FP%2F8q6Pqf%2FJrkzTLCb4fBfg%3D" alt="image.png" loading="lazy"/></p>
<p>å®ƒä»¬éƒ½æ˜¯åœ¨ç›®æ ‡ controller çš„ handler å‰åï¼Œé¢å¤–åŠ ä¸€æ®µé€»è¾‘çš„ã€‚</p>
<p>æ¯”å¦‚ä½ å¯ä»¥é€šè¿‡ interceptor å®ç°è¯·æ±‚åˆ°å“åº”çš„æ—¶é—´çš„è®°å½•ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f084f2355e184a6d98d3e04f979465ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=9ExCE89cD8xOanwtI4L%2FIV2PXuo%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™ç§é€»è¾‘é€‚åˆæ”¾åœ¨ controller é‡Œä¹ˆï¼Ÿ</p>
<p>ä¸é€‚åˆï¼Œè¿™ç§é€šç”¨é€»è¾‘åº”è¯¥é€šè¿‡ interceptor ç­‰æ–¹å¼æŠ½ç¦»å‡ºæ¥ï¼Œç„¶åéœ€è¦ç”¨çš„æ—¶å€™åœ¨ controller ä¸Šå£°æ˜ä¸€ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b30e27c45f1a4d5d9e78e2bdf074189f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5LiA5rGf5Lic5rWB5rC0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769224862&amp;x-signature=DGqdYLUY1bbWke9dZkY9WHHq71g%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥ç†è§£ä¸‹ <code>@UseInterceptors</code>çš„é€»è¾‘ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Intercept</span>(<span class="hljs-params">interceptor: { before?: <span class="hljs-built_in">Function</span>; after?: <span class="hljs-built_in">Function</span> }</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span> (<span class="hljs-params">target: any, propertyKey: string, descriptor: PropertyDescriptor</span>) {
    <span class="hljs-comment">// ä¿å­˜åŸå§‹æ–¹æ³•</span>
    <span class="hljs-keyword">const</span> originalMethod = descriptor.<span class="hljs-property">value</span>;

    <span class="hljs-comment">// é‡å†™æ–¹æ³•</span>
    descriptor.<span class="hljs-property">value</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">...args: any[]</span>) {
      <span class="hljs-comment">// æ‰§è¡Œå‰ç½®æ‹¦æˆªé€»è¾‘</span>
      <span class="hljs-keyword">if</span> (interceptor.<span class="hljs-property">before</span>) {
        interceptor.<span class="hljs-title function_">before</span>(args);
      }

      <span class="hljs-comment">// è°ƒç”¨åŸå§‹æ–¹æ³•</span>
      <span class="hljs-keyword">const</span> result = originalMethod.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);

      <span class="hljs-comment">// æ‰§è¡Œåç½®æ‹¦æˆªé€»è¾‘</span>
      <span class="hljs-keyword">if</span> (interceptor.<span class="hljs-property">after</span>) {
        interceptor.<span class="hljs-title function_">after</span>(result);
      }

      <span class="hljs-comment">// è¿”å›åŸå§‹æ–¹æ³•çš„ç»“æœ</span>
      <span class="hljs-keyword">return</span> result;
    };

    <span class="hljs-keyword">return</span> descriptor;
  };
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">MyClass</span> {
  @<span class="hljs-title class_">Intercept</span>({
    <span class="hljs-attr">before</span>: <span class="hljs-function">(<span class="hljs-params">args: any[]</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[BEFORE] Method is about to be called with args: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(args)}</span>`</span>);
    },
    <span class="hljs-attr">after</span>: <span class="hljs-function">(<span class="hljs-params">result: any</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[AFTER] Method returned: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);
    },
  })
  <span class="hljs-title function_">myMethod</span>(<span class="hljs-params">arg1: string, arg2: number</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Executing myMethod"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Received: <span class="hljs-subst">${arg1}</span>, <span class="hljs-subst">${arg2}</span>`</span>;
  }
}

<span class="hljs-keyword">const</span> instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyClass</span>();
instance.<span class="hljs-title function_">myMethod</span>(<span class="hljs-string">"Hello"</span>, <span class="hljs-number">42</span>);

</code></pre>
<p>è¿™äº›å°±æ˜¯ Nest çš„æ ¸å¿ƒæ¦‚å¿µäº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é«˜å¹¶å‘ Kafka æ¶ˆæ¯å‘é€ï¼šåŸºäº Go çš„å¹¶å‘å®‰å…¨å®ç°ä¸æœ€ä½³å®è·µ]]></title>    <link>https://juejin.cn/post/7595871887000420352</link>    <guid>https://juejin.cn/post/7595871887000420352</guid>    <pubDate>2026-01-17T03:33:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595871887000420352" data-draft-id="7595871887000403968" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é«˜å¹¶å‘ Kafka æ¶ˆæ¯å‘é€ï¼šåŸºäº Go çš„å¹¶å‘å®‰å…¨å®ç°ä¸æœ€ä½³å®è·µ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-17T03:33:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Kevin666"/> <meta itemprop="url" content="https://juejin.cn/user/1549628692501449"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é«˜å¹¶å‘ Kafka æ¶ˆæ¯å‘é€ï¼šåŸºäº Go çš„å¹¶å‘å®‰å…¨å®ç°ä¸æœ€ä½³å®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1549628692501449/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Kevin666
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T03:33:05.000Z" title="Sat Jan 17 2026 03:33:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨é«˜ååä¸šåŠ¡åœºæ™¯ä¸­ï¼ŒKafka ä½œä¸ºåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ˜¯å®ç°æ¶ˆæ¯å¼‚æ­¥æŠ•é€’ã€å‰Šå³°å¡«è°·çš„æ ¸å¿ƒç»„ä»¶ã€‚è€ŒåŸºäº Go è¯­è¨€å¼€å‘ Kafka ç”Ÿäº§è€…æ—¶ï¼Œå¦‚ä½•é€šè¿‡å¹¶å‘æå‡å‘é€é€Ÿåº¦ï¼ŒåŒæ—¶ä¿è¯å¹¶å‘å®‰å…¨ï¼Œæ˜¯å¾ˆå¤šå¼€å‘è€…é¢ä¸´çš„æ ¸å¿ƒé—®é¢˜ã€‚æœ¬æ–‡å°†é€šè¿‡ä¸€ä¸ªå®é™…åœºæ™¯ï¼Œæ‹†è§£ã€Œå¤šç”Ÿäº§è€… + å¤šåç¨‹ã€çš„å¹¶å‘æ¨¡å‹ï¼Œè¯¦è§£å…¶å¹¶å‘å®‰å…¨æ€§ï¼Œå¹¶åŸºäºå¼€æºç»„ä»¶å®Œæˆå¯è½åœ°çš„å®ç°ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€åœºæ™¯èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆéœ€è¦å¹¶å‘å‘é€ Kafka æ¶ˆæ¯ï¼Ÿ</h2>
<p>åœ¨å†…å®¹å®¡æ ¸ã€æ—¥å¿—é‡‡é›†ã€æ•°æ®åŒæ­¥ç­‰ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¸¸å¸¸ä¼šé‡åˆ°æ¯ç§’æ•°ä¸‡æ¡ç”šè‡³æ•°åä¸‡æ¡æ¶ˆæ¯çš„å‘é€éœ€æ±‚ã€‚å•ç”Ÿäº§è€…å®ä¾‹çš„å¤„ç†èƒ½åŠ›å­˜åœ¨ä¸Šé™ï¼Œå—é™äºç½‘ç»œ IOã€æ¶ˆæ¯æ‰¹é‡æ‰“åŒ…ã€æœåŠ¡å™¨èµ„æºç­‰å› ç´ ï¼Œæ— æ³•æ»¡è¶³é«˜å¹¶å‘æŠ•é€’è¦æ±‚ï¼Œå®¹æ˜“å‡ºç°æ¶ˆæ¯ç§¯å‹ã€å‘é€å»¶è¿Ÿå‡é«˜ç­‰é—®é¢˜ã€‚</p>
<p>Go è¯­è¨€å‡­å€Ÿå…¶è½»é‡çº§åç¨‹ï¼ˆGoroutineï¼‰çš„ä¼˜åŠ¿ï¼Œèƒ½å¤Ÿè½»æ¾å®ç°é«˜å¹¶å‘å¤„ç†ã€‚è€Œã€Œå¤šç”Ÿäº§è€… + å¤šåç¨‹ã€çš„å¹¶å‘æ¨¡å‹ï¼Œæ­£æ˜¯çªç ´å•ç”Ÿäº§è€…æ€§èƒ½ç“¶é¢ˆï¼Œå®ç°é«˜ååæ¶ˆæ¯å‘é€çš„æœ€ä¼˜æ–¹æ¡ˆä¹‹ä¸€ã€‚</p>
<p>æœ¬æ–‡å°†åŸºäºå¼€æºçš„ <code>sarama</code> åº“ï¼ˆKafka å®˜æ–¹æ¨èçš„ Go è¯­è¨€å®¢æˆ·ç«¯ï¼‰ï¼Œå®ç°é«˜å¹¶å‘ Kafka æ¶ˆæ¯å‘é€ï¼Œå¹¶é‡ç‚¹è§£ç­”ï¼š<strong>å¹¶å‘åœºæ™¯ä¸‹ï¼ŒKafka æ¶ˆæ¯å‘é€çš„å®‰å…¨æ€§å¦‚ä½•ä¿è¯ï¼Ÿ</strong></p>
<h2 data-id="heading-1">äºŒã€æ ¸å¿ƒç–‘é—®ï¼šå¹¶å‘å‘é€ Kafka æ¶ˆæ¯ï¼Œä¼šå­˜åœ¨å®‰å…¨é—®é¢˜å—ï¼Ÿ</h2>
<p>å¾ˆå¤šå¼€å‘è€…åœ¨å®ç°å¹¶å‘å‘é€æ—¶ï¼Œéƒ½ä¼šæœ‰è¿™æ ·çš„é¡¾è™‘ï¼šå¤šä¸ªåç¨‹åŒæ—¶è°ƒç”¨æ¶ˆæ¯å‘é€æ–¹æ³•ï¼Œä¼šä¸ä¼šå‡ºç°æ•°æ®ç«äº‰ã€æ¶ˆæ¯ä¸¢å¤±ã€æ¶ˆæ¯é”™ä¹±ç­‰é—®é¢˜ï¼Ÿ</p>
<p>ç­”æ¡ˆå…ˆæŠ›å‡ºæ¥ï¼š<strong>åˆç†çš„å¹¶å‘è®¾è®¡ä¸‹ï¼ŒKafka æ¶ˆæ¯å‘é€æ˜¯å¹¶å‘å®‰å…¨çš„</strong>ã€‚å…·ä½“å¯ä»ä¸¤ä¸ªæ ¸å¿ƒå±‚é¢ä¿éšœï¼Œè¿™ä¹Ÿæ˜¯æœ¬æ–‡å®ç°çš„æ ¸å¿ƒä¾æ®ã€‚</p>
<h3 data-id="heading-2">1. æ¶ˆæ¯å‘é€æ–¹æ³•æœ¬èº«ï¼šæ— çŠ¶æ€ã€æ— å…±äº«ï¼Œå¤©ç„¶å¹¶å‘å®‰å…¨</h3>
<p>æ¶ˆæ¯å‘é€çš„æ ¸å¿ƒæ–¹æ³•ï¼Œæœ¬èº«åªè´Ÿè´£å‚æ•°ä¼ é€’å’Œåº•å±‚å®¢æˆ·ç«¯è°ƒç”¨ï¼Œä¸ç»´æŠ¤ä»»ä½•å…¨å±€çŠ¶æ€ã€é™æ€å˜é‡ï¼Œä¹Ÿä¸ä¿®æ”¹ä¼ å…¥å‚æ•°çš„å†…å®¹ã€‚æ¯ä¸ªè°ƒç”¨éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¤šä¸ªåç¨‹åŒæ—¶è°ƒç”¨ä¸ä¼šç›¸äº’å¹²æ‰°ã€‚</p>
<h3 data-id="heading-3">2. å¼€æº Kafka å®¢æˆ·ç«¯ï¼ˆsaramaï¼‰ï¼šç”Ÿäº§è€…å®ä¾‹åç¨‹å®‰å…¨</h3>
<p><code>sarama</code> åº“å®ç°çš„ Kafka ç”Ÿäº§è€…ï¼ˆ<code>sarama.SyncProducer</code>/<code>sarama.AsyncProducer</code>ï¼‰æœ¬èº«æ˜¯åç¨‹å®‰å…¨çš„ï¼Œæ”¯æŒå¤šä¸ªåç¨‹åŒæ—¶è°ƒç”¨å…¶å‘é€æ–¹æ³•ã€‚åº•å±‚é€šè¿‡é”æœºåˆ¶ã€å†…éƒ¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¤„ç†å¹¶å‘è¯·æ±‚çš„ç«äº‰é—®é¢˜ï¼Œå¼€å‘è€…æ— éœ€æ‰‹åŠ¨å¤„ç†åŒæ­¥é”ï¼Œé™ä½äº†å¹¶å‘å¼€å‘çš„å¤æ‚åº¦ã€‚</p>
<h3 data-id="heading-4">3. é¢å¤–ä¿éšœï¼šã€Œä¸€ä¸ªåç¨‹å¯¹åº”ä¸€ä¸ªç‹¬ç«‹ç”Ÿäº§è€…å®ä¾‹ã€</h3>
<p>å³ä½¿åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå®¢æˆ·ç«¯ç”Ÿäº§è€…å®ä¾‹éåç¨‹å®‰å…¨ï¼ˆæå°‘å‡ºç°ï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ã€Œä¸€ä¸ªåç¨‹å¯¹åº”ä¸€ä¸ªç‹¬ç«‹ç”Ÿäº§è€…å®ä¾‹ã€çš„è®¾è®¡ï¼Œé¿å…å…±äº«å®ä¾‹çš„ç«äº‰é—®é¢˜ï¼Œå®ç°åŒé‡ä¿éšœã€‚è¿™ä¹Ÿæ˜¯æœ¬æ–‡å®ç°çš„æ ¸å¿ƒè®¾è®¡æ€è·¯ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€å¯è½åœ°å®ç°ï¼šåŸºäº sarama çš„é«˜å¹¶å‘ Kafka ç”Ÿäº§è€…</h2>
<h3 data-id="heading-6">1. å‰æœŸå‡†å¤‡ï¼šå®‰è£… sarama å¼€æºåº“</h3>
<p>é¦–å…ˆå®‰è£…å®˜æ–¹æ¨èçš„<code>sarama</code>åº“ï¼Œè¿™æ˜¯å®ç° Kafka æ¶ˆæ¯å‘é€çš„åŸºç¡€ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">go get github.com/Shopify/sarama
</code></pre>
<h3 data-id="heading-7">2. å…¨å±€é…ç½®å®šä¹‰ï¼šæ›¿æ¢ä¸šåŠ¡å˜é‡ï¼Œç»Ÿä¸€é…ç½®ç®¡ç†</h3>
<p>æˆ‘ä»¬å…ˆå®šä¹‰å…¨å±€çš„é…ç½®å¸¸é‡å’Œé€šé“ï¼Œæ›¿æ¢åŸä¸šåŠ¡ä»£ç ä¸­çš„ç§æœ‰å˜é‡ï¼Œä¿è¯ä»£ç çš„å¯å¤ç”¨æ€§ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
	<span class="hljs-string">"context"</span>
	<span class="hljs-string">"log"</span>
	<span class="hljs-string">"os"</span>
	<span class="hljs-string">"os/signal"</span>
	<span class="hljs-string">"syscall"</span>
	<span class="hljs-string">"time"</span>

	<span class="hljs-string">"github.com/Shopify/sarama"</span>
)

<span class="hljs-comment">// å…¨å±€é…ç½®ï¼šæ›¿æ¢åŸä¸šåŠ¡ä¸­çš„ MAX_WORKERSã€JobQueã€JobQuitChan</span>
<span class="hljs-keyword">const</span> (
	<span class="hljs-comment">// å¹¶å‘ç”Ÿäº§è€…æ•°é‡ï¼ˆå¯æ ¹æ®ä¸šåŠ¡éœ€æ±‚ã€æœåŠ¡å™¨èµ„æºè°ƒæ•´ï¼‰</span>
	ConcurrentProducerNum = <span class="hljs-number">5</span>
	<span class="hljs-comment">// ä»»åŠ¡é€šé“ç¼“å†²åŒºå¤§å°ï¼šé˜²æ­¢åç¨‹é˜»å¡ï¼Œå‰Šå³°å¡«è°·</span>
	JobChanBufferSize = <span class="hljs-number">10000</span>
)

<span class="hljs-comment">// æ¶ˆæ¯ä»»åŠ¡ç»“æ„ä½“ï¼šæ›¿æ¢åŸä¸šåŠ¡ä¸­çš„ jobï¼Œå°è£…å‘é€æ‰€éœ€çš„æ ¸å¿ƒæ•°æ®</span>
<span class="hljs-keyword">type</span> KafkaSendJob <span class="hljs-keyword">struct</span> {
	Ctx  context.Context <span class="hljs-comment">// ä¸Šä¸‹æ–‡ï¼šç”¨äºè¶…æ—¶æ§åˆ¶ã€å–æ¶ˆæ“ä½œ</span>
	Msg  []<span class="hljs-type">byte</span>          <span class="hljs-comment">// å¾…å‘é€çš„æ¶ˆæ¯å†…å®¹</span>
	Key  <span class="hljs-type">string</span>          <span class="hljs-comment">// Kafkaæ¶ˆæ¯Keyï¼šç”¨äºåˆ†åŒºè·¯ç”±</span>
}

<span class="hljs-comment">// å…¨å±€å˜é‡ï¼šä»»åŠ¡é€šé“å’Œé€€å‡ºé€šé“</span>
<span class="hljs-keyword">var</span> (
	<span class="hljs-comment">// æ¶ˆæ¯ä»»åŠ¡é€šé“ï¼šæ¥æ”¶å¾…å‘é€çš„æ¶ˆæ¯ä»»åŠ¡</span>
	KafkaJobChan = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> KafkaSendJob, JobChanBufferSize)
	<span class="hljs-comment">// åç¨‹é€€å‡ºé€šé“ï¼šç”¨äºä¼˜é›…å…³é—­æ‰€æœ‰ç”Ÿäº§è€…åç¨‹</span>
	ProducerQuitChan = <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> <span class="hljs-keyword">struct</span>{}, ConcurrentProducerNum)
	<span class="hljs-comment">// Kafkaé›†ç¾¤åœ°å€ï¼šæ›¿æ¢åŸä¸šåŠ¡ä¸­çš„ kafkaEnv.ProducerEnv.Cluster</span>
	KafkaBrokerList = []<span class="hljs-type">string</span>{<span class="hljs-string">"127.0.0.1:9092"</span>}
	<span class="hljs-comment">// Kafkaä¸»é¢˜ï¼šæ›¿æ¢åŸä¸šåŠ¡ä¸­çš„ kafkaEnv.ProducerEnv.KafkaTopic</span>
	KafkaTopic = <span class="hljs-string">"test_high_concurrency_topic"</span>
)
</code></pre>
<h3 data-id="heading-8">3. æ ¸å¿ƒå®ç° 1ï¼šåˆå§‹åŒ–å¤šç”Ÿäº§è€…ï¼Œå¯åŠ¨å¹¶å‘åç¨‹</h3>
<p>è¿™éƒ¨åˆ†å¯¹åº”åŸä¸šåŠ¡ä¸­çš„<code>InitProducers</code>å‡½æ•°ï¼Œæˆ‘ä»¬åŸºäº<code>sarama</code>åˆ›å»ºå¤šä¸ªç”Ÿäº§è€…å®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹å¯¹åº”ä¸€ä¸ªç‹¬ç«‹åç¨‹ï¼Œå®ç°å¹¶å‘å‘é€ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// InitKafkaProducers åˆå§‹åŒ–å¤šä¸ªKafkaç”Ÿäº§è€…å®ä¾‹ï¼Œå¯åŠ¨å¹¶å‘å‘é€åç¨‹</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">InitKafkaProducers</span><span class="hljs-params">()</span></span> <span class="hljs-type">error</span> {
	<span class="hljs-comment">// 1. é…ç½®saramaç”Ÿäº§è€…å‚æ•°</span>
	saramaConfig := sarama.NewConfig()
	<span class="hljs-comment">// è®¾ç½®ç”Ÿäº§è€…ACKçº§åˆ«ï¼š-1=ç­‰å¾…æ‰€æœ‰å‰¯æœ¬ç¡®è®¤ï¼Œä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±</span>
	saramaConfig.Producer.RequiredAcks = sarama.WaitForAll
	<span class="hljs-comment">// å¯ç”¨æ¶ˆæ¯æ‰¹é‡å‘é€ï¼šæå‡å‘é€ååé‡</span>
	saramaConfig.Producer.Flush.Bytes = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> <span class="hljs-comment">// æ‰¹é‡å‘é€é˜ˆå€¼ï¼š1MB</span>
	saramaConfig.Producer.Flush.Frequency = <span class="hljs-number">50</span> * time.Millisecond <span class="hljs-comment">// æ‰¹é‡å‘é€é—´éš”ï¼š50ms</span>
	<span class="hljs-comment">// é…ç½®æ¶ˆæ¯åºåˆ—åŒ–æ ¼å¼</span>
	saramaConfig.Producer.Return.Successes = <span class="hljs-literal">true</span>
	saramaConfig.Producer.Return.Errors = <span class="hljs-literal">true</span>
	<span class="hljs-comment">// è®¾ç½®ç‰ˆæœ¬å…¼å®¹ï¼ˆæ ¹æ®ä½ çš„Kafkaé›†ç¾¤ç‰ˆæœ¬è°ƒæ•´ï¼‰</span>
	saramaConfig.Version = sarama.V2_8_1_0

	<span class="hljs-comment">// 2. å¾ªç¯åˆ›å»ºå¤šä¸ªç”Ÿäº§è€…å®ä¾‹ï¼Œå¯åŠ¨å¯¹åº”åç¨‹</span>
	<span class="hljs-keyword">for</span> i := <span class="hljs-number">1</span>; i &lt;= ConcurrentProducerNum; i++ {
		<span class="hljs-comment">// åˆ›å»ºåŒæ­¥ç”Ÿäº§è€…å®ä¾‹ï¼ˆåŒæ­¥å‘é€ï¼šç­‰å¾…å‘é€ç»“æœè¿”å›ï¼Œä¾¿äºé‡è¯•ï¼‰</span>
		producer, err := sarama.NewSyncProducer(KafkaBrokerList, saramaConfig)
		<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
			log.Printf(<span class="hljs-string">"åˆ›å»ºç¬¬%dä¸ªKafkaç”Ÿäº§è€…å¤±è´¥ï¼š%v"</span>, i, err)
			<span class="hljs-keyword">return</span> err
		}
		log.Printf(<span class="hljs-string">"ç¬¬%dä¸ªKafkaç”Ÿäº§è€…åˆ›å»ºæˆåŠŸï¼Œå·²å¯åŠ¨å¯¹åº”å‘é€åç¨‹"</span>, i)

		<span class="hljs-comment">// å¯åŠ¨ç‹¬ç«‹åç¨‹ï¼Œå¤„ç†æ¶ˆæ¯å‘é€ä»»åŠ¡ï¼ˆæ¯ä¸ªåç¨‹ç‹¬å ä¸€ä¸ªç”Ÿäº§è€…å®ä¾‹ï¼‰</span>
		<span class="hljs-keyword">go</span> RunKafkaProducer(producer, i)
	}

	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}
</code></pre>
<h3 data-id="heading-9">4. æ ¸å¿ƒå®ç° 2ï¼šåç¨‹ä¸šåŠ¡é€»è¾‘ï¼Œå¤„ç†æ¶ˆæ¯å‘é€ä»»åŠ¡</h3>
<p>è¿™éƒ¨åˆ†å¯¹åº”åŸä¸šåŠ¡ä¸­çš„<code>Run</code>å‡½æ•°ï¼Œæ¯ä¸ªåç¨‹ä»ä»»åŠ¡é€šé“ä¸­è·å–æ¶ˆæ¯ï¼Œè°ƒç”¨å‘é€æ–¹æ³•å®ŒæˆæŠ•é€’ï¼Œå¹¶æ”¯æŒä¼˜é›…é€€å‡ºï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// RunKafkaProducer å•ä¸ªç”Ÿäº§è€…åç¨‹çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¾ªç¯å¤„ç†æ¶ˆæ¯ä»»åŠ¡</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">RunKafkaProducer</span><span class="hljs-params">(producer sarama.SyncProducer, producerID <span class="hljs-type">int</span>)</span></span> {
	<span class="hljs-comment">// ä¼˜é›…é€€å‡ºï¼šå…³é—­ç”Ÿäº§è€…å®ä¾‹ï¼Œé‡Šæ”¾èµ„æº</span>
	<span class="hljs-keyword">defer</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
		<span class="hljs-keyword">if</span> err := producer.Close(); err != <span class="hljs-literal">nil</span> {
			log.Printf(<span class="hljs-string">"ç¬¬%dä¸ªç”Ÿäº§è€…å…³é—­å¤±è´¥ï¼š%v"</span>, producerID, err)
		} <span class="hljs-keyword">else</span> {
			log.Printf(<span class="hljs-string">"ç¬¬%dä¸ªç”Ÿäº§è€…å·²æ­£å¸¸å…³é—­"</span>, producerID)
		}
		<span class="hljs-comment">// æ•è·åç¨‹panicï¼Œé˜²æ­¢å•ä¸ªåç¨‹å¼‚å¸¸å¯¼è‡´æ•´ä¸ªæœåŠ¡å´©æºƒ</span>
		<span class="hljs-keyword">if</span> r := <span class="hljs-built_in">recover</span>(); r != <span class="hljs-literal">nil</span> {
			log.Printf(<span class="hljs-string">"ç¬¬%dä¸ªç”Ÿäº§è€…åç¨‹å‘ç”Ÿpanicï¼š%v"</span>, producerID, r)
		}
	}()

	log.Printf(<span class="hljs-string">"ç¬¬%dä¸ªç”Ÿäº§è€…åç¨‹å·²å¯åŠ¨ï¼Œå¼€å§‹ç›‘å¬æ¶ˆæ¯ä»»åŠ¡"</span>, producerID)

	<span class="hljs-comment">// å¾ªç¯ç›‘å¬ä»»åŠ¡é€šé“å’Œé€€å‡ºé€šé“</span>
	<span class="hljs-keyword">for</span> {
		<span class="hljs-keyword">select</span> {
		<span class="hljs-comment">// ä»ä»»åŠ¡é€šé“è·å–å¾…å‘é€çš„æ¶ˆæ¯</span>
		<span class="hljs-keyword">case</span> job := &lt;-KafkaJobChan:
			<span class="hljs-comment">// è®°å½•å‘é€æŒ‡æ ‡ï¼ˆæ­¤å¤„ç®€åŒ–ï¼Œå®é™…å¯æ¥å…¥Prometheusï¼‰</span>
			log.Printf(<span class="hljs-string">"ç¬¬%dä¸ªç”Ÿäº§è€…è·å–åˆ°æ¶ˆæ¯ä»»åŠ¡ï¼Œæ¶ˆæ¯é•¿åº¦ï¼š%d"</span>, producerID, <span class="hljs-built_in">len</span>(job.Msg))
			<span class="hljs-comment">// è°ƒç”¨å‘é€æ–¹æ³•ï¼Œæ”¯æŒ3æ¬¡é‡è¯•</span>
			err := RetryKafkaMsgSend(producer, job, <span class="hljs-number">3</span>)
			<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
				log.Printf(<span class="hljs-string">"ç¬¬%dä¸ªç”Ÿäº§è€…æ¶ˆæ¯å‘é€å¤±è´¥ï¼ˆå·²é‡è¯•3æ¬¡ï¼‰ï¼š%v"</span>, producerID, err)
			}
		<span class="hljs-comment">// æ¥æ”¶é€€å‡ºä¿¡å·ï¼Œä¼˜é›…å…³é—­åç¨‹</span>
		<span class="hljs-keyword">case</span> &lt;-ProducerQuitChan:
			log.Printf(<span class="hljs-string">"ç¬¬%dä¸ªç”Ÿäº§è€…æ¥æ”¶åˆ°é€€å‡ºä¿¡å·ï¼Œå³å°†åœæ­¢å·¥ä½œ"</span>, producerID)
			<span class="hljs-keyword">return</span>
		}
	}
}
</code></pre>
<h3 data-id="heading-10">5. æ ¸å¿ƒå®ç° 3ï¼šæ¶ˆæ¯å‘é€ä¸é‡è¯•æœºåˆ¶</h3>
<p>è¿™éƒ¨åˆ†å¯¹åº”åŸä¸šåŠ¡ä¸­çš„<code>MsgSend</code>å’Œ<code>RetryMsgSend</code>å‡½æ•°ï¼Œå®ç°æ¶ˆæ¯çš„æ ¸å¿ƒå‘é€é€»è¾‘ï¼Œå¹¶æ·»åŠ é‡è¯•æœºåˆ¶ï¼Œä¿è¯æ¶ˆæ¯æŠ•é€’çš„å¯é æ€§ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// KafkaMsgSend æ ¸å¿ƒæ¶ˆæ¯å‘é€æ–¹æ³•ï¼Œè°ƒç”¨saramaç”Ÿäº§è€…å®Œæˆæ¶ˆæ¯æŠ•é€’</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">KafkaMsgSend</span><span class="hljs-params">(producer sarama.SyncProducer, job KafkaSendJob)</span></span> <span class="hljs-type">error</span> {
	<span class="hljs-comment">// æ„å»ºKafkaæ¶ˆæ¯</span>
	msg := &amp;sarama.ProducerMessage{
		Topic: KafkaTopic,
		Key:   sarama.StringEncoder(job.Key),
		Value: sarama.ByteEncoder(job.Msg),
	}

	<span class="hljs-comment">// è°ƒç”¨saramaåŒæ­¥å‘é€æ–¹æ³•</span>
	partition, offset, err := producer.SendMessage(msg)
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		<span class="hljs-keyword">return</span> err
	}

	<span class="hljs-comment">// å‘é€æˆåŠŸï¼Œæ‰“å°æ—¥å¿—ï¼ˆå®é™…åœºæ™¯å¯çœç•¥æˆ–æ¥å…¥ç›‘æ§ï¼‰</span>
	log.Printf(<span class="hljs-string">"æ¶ˆæ¯å‘é€æˆåŠŸï¼šåˆ†åŒº=%dï¼Œåç§»é‡=%d"</span>, partition, offset)
	<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
}

<span class="hljs-comment">// RetryKafkaMsgSend æ¶ˆæ¯å‘é€é‡è¯•æœºåˆ¶ï¼Œæ”¯æŒæŒ‡å®šé‡è¯•æ¬¡æ•°</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">RetryKafkaMsgSend</span><span class="hljs-params">(producer sarama.SyncProducer, job KafkaSendJob, retryTimes <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">error</span> {
	<span class="hljs-keyword">var</span> err <span class="hljs-type">error</span>

	<span class="hljs-comment">// å¾ªç¯é‡è¯•å‘é€</span>
	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; retryTimes; i++ {
		err = KafkaMsgSend(producer, job)
		<span class="hljs-keyword">if</span> err == <span class="hljs-literal">nil</span> {
			<span class="hljs-comment">// å‘é€æˆåŠŸï¼Œç›´æ¥è¿”å›</span>
			<span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>
		}

		<span class="hljs-comment">// å‘é€å¤±è´¥ï¼Œæ‰“å°é‡è¯•æ—¥å¿—ï¼Œå»¶è¿Ÿåé‡è¯•ï¼ˆæŒ‡æ•°é€€é¿ï¼Œä¼˜åŒ–ç‰ˆå¯è°ƒæ•´ï¼‰</span>
		log.Printf(<span class="hljs-string">"æ¶ˆæ¯å‘é€ç¬¬%dæ¬¡å¤±è´¥ï¼Œå³å°†é‡è¯•ï¼š%v"</span>, i+<span class="hljs-number">1</span>, err)
		time.Sleep(time.Duration(i+<span class="hljs-number">1</span>) * <span class="hljs-number">100</span> * time.Millisecond)
	}

	<span class="hljs-comment">// æ‰€æœ‰é‡è¯•æ¬¡æ•°è€—å°½ï¼Œè¿”å›æœ€ç»ˆé”™è¯¯</span>
	<span class="hljs-keyword">return</span> err
}
</code></pre>
<h3 data-id="heading-11">6. ä¼˜é›…å…³é—­ï¼šå¤„ç†ç³»ç»Ÿä¿¡å·ï¼Œä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±</h3>
<p>åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒæœåŠ¡åœæ­¢æ—¶éœ€è¦ä¼˜é›…å…³é—­ç”Ÿäº§è€…ï¼Œé˜²æ­¢æ­£åœ¨å‘é€çš„æ¶ˆæ¯ä¸¢å¤±ï¼Œæˆ‘ä»¬é€šè¿‡ç›‘å¬ç³»ç»Ÿä¿¡å·å®ç°è¿™ä¸€åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// SetupGracefulShutdown é…ç½®ä¼˜é›…å…³é—­ï¼Œå¤„ç†ç³»ç»Ÿåœæ­¢ä¿¡å·</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">SetupGracefulShutdown</span><span class="hljs-params">()</span></span> {
	<span class="hljs-comment">// åˆ›å»ºç³»ç»Ÿä¿¡å·é€šé“</span>
	sigChan := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">chan</span> os.Signal, <span class="hljs-number">1</span>)
	<span class="hljs-comment">// ç›‘å¬SIGINTï¼ˆCtrl+Cï¼‰å’ŒSIGTERMï¼ˆå®¹å™¨åœæ­¢ï¼‰ä¿¡å·</span>
	signal.Notify(sigChan, syscall.SIGINT, syscall.SIGTERM)

	<span class="hljs-comment">// é˜»å¡ç­‰å¾…ç³»ç»Ÿä¿¡å·</span>
	&lt;-sigChan
	log.Println(<span class="hljs-string">"æ¥æ”¶åˆ°ç³»ç»Ÿåœæ­¢ä¿¡å·ï¼Œå¼€å§‹ä¼˜é›…å…³é—­Kafkaç”Ÿäº§è€…..."</span>)

	<span class="hljs-comment">// 1. å…³é—­ä»»åŠ¡é€šé“ï¼Œåœæ­¢æ¥æ”¶æ–°ä»»åŠ¡</span>
	<span class="hljs-built_in">close</span>(KafkaJobChan)
	log.Println(<span class="hljs-string">"æ¶ˆæ¯ä»»åŠ¡é€šé“å·²å…³é—­ï¼Œä¸å†æ¥æ”¶æ–°ä»»åŠ¡"</span>)

	<span class="hljs-comment">// 2. å‘æ‰€æœ‰ç”Ÿäº§è€…åç¨‹å‘é€é€€å‡ºä¿¡å·</span>
	<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; ConcurrentProducerNum; i++ {
		ProducerQuitChan &lt;- <span class="hljs-keyword">struct</span>{}{}
	}
	<span class="hljs-built_in">close</span>(ProducerQuitChan)
	log.Println(<span class="hljs-string">"å·²å‘æ‰€æœ‰ç”Ÿäº§è€…åç¨‹å‘é€é€€å‡ºä¿¡å·"</span>)

	<span class="hljs-comment">// 3. ç­‰å¾…æ‰€æœ‰åç¨‹é€€å‡ºï¼ˆæ­¤å¤„ç®€åŒ–ï¼Œå®é™…å¯é€šè¿‡sync.WaitGroupå®ç°ç²¾å‡†ç­‰å¾…ï¼‰</span>
	time.Sleep(<span class="hljs-number">5</span> * time.Second)
	log.Println(<span class="hljs-string">"Kafkaç”Ÿäº§è€…ä¼˜é›…å…³é—­å®Œæˆï¼ŒæœåŠ¡é€€å‡º"</span>)
}
</code></pre>
<h3 data-id="heading-12">7. æµ‹è¯•ä¸»å‡½æ•°ï¼šæ¨¡æ‹Ÿæ¶ˆæ¯ç”Ÿäº§ï¼ŒéªŒè¯å¹¶å‘æ•ˆæœ</h3>
<p>æœ€åï¼Œæˆ‘ä»¬ç¼–å†™ä¸»å‡½æ•°ï¼Œæ¨¡æ‹Ÿé«˜å¹¶å‘æ¶ˆæ¯ç”Ÿäº§ï¼ŒéªŒè¯æ•´ä¸ªæ–¹æ¡ˆçš„å¯è¡Œæ€§ï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
	<span class="hljs-comment">// 1. åˆå§‹åŒ–Kafkaç”Ÿäº§è€…</span>
	err := InitKafkaProducers()
	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
		log.Fatalf(<span class="hljs-string">"åˆå§‹åŒ–Kafkaç”Ÿäº§è€…å¤±è´¥ï¼š%v"</span>, err)
	}

	<span class="hljs-comment">// 2. é…ç½®ä¼˜é›…å…³é—­</span>
	<span class="hljs-keyword">go</span> SetupGracefulShutdown()

	<span class="hljs-comment">// 3. æ¨¡æ‹Ÿç”Ÿäº§1000æ¡æµ‹è¯•æ¶ˆæ¯ï¼ŒæŠ•é€’åˆ°ä»»åŠ¡é€šé“</span>
	<span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">()</span></span> {
		<span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++ {
			job := KafkaSendJob{
				Ctx:  context.Background(),
				Msg:  []<span class="hljs-type">byte</span>(fmt.Sprintf(<span class="hljs-string">"é«˜å¹¶å‘æµ‹è¯•æ¶ˆæ¯ï¼š%d"</span>, i)),
				Key:  fmt.Sprintf(<span class="hljs-string">"test_key_%d"</span>, i%<span class="hljs-number">10</span>), <span class="hljs-comment">// å‡åŒ€åˆ†å¸ƒåˆ°10ä¸ªåˆ†åŒº</span>
			}
			<span class="hljs-comment">// æŠ•é€’ä»»åŠ¡åˆ°é€šé“ï¼ˆéé˜»å¡ï¼Œåˆ©ç”¨ç¼“å†²åŒºå‰Šå³°ï¼‰</span>
			<span class="hljs-keyword">select</span> {
			<span class="hljs-keyword">case</span> KafkaJobChan &lt;- job:
			<span class="hljs-keyword">default</span>:
				log.Printf(<span class="hljs-string">"æ¶ˆæ¯ä»»åŠ¡é€šé“å·²æ»¡ï¼Œä¸¢å¼ƒç¬¬%dæ¡æ¶ˆæ¯"</span>, i)
			}
			<span class="hljs-comment">// æ¨¡æ‹Ÿæ¶ˆæ¯ç”Ÿäº§é—´éš”</span>
			time.Sleep(<span class="hljs-number">1</span> * time.Millisecond)
		}
		log.Println(<span class="hljs-string">"1000æ¡æµ‹è¯•æ¶ˆæ¯å·²å…¨éƒ¨æŠ•é€’åˆ°ä»»åŠ¡é€šé“"</span>)
	}()

	<span class="hljs-comment">// 4. é˜»å¡ä¸»çº¿ç¨‹ï¼Œä¿æŒæœåŠ¡è¿è¡Œ</span>
	<span class="hljs-keyword">select</span> {}
}
</code></pre>
<h2 data-id="heading-13">å››ã€å…³é”®æ€»ç»“ï¼šå¹¶å‘å®‰å…¨çš„æ ¸å¿ƒä¿éšœä¸æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-14">1. å¹¶å‘å®‰å…¨çš„æ ¸å¿ƒä¿éšœ</h3>
<ol>
<li><strong><code>KafkaMsgSend</code> æ–¹æ³•å¤©ç„¶å®‰å…¨</strong>ï¼šæ— å†…éƒ¨å…±äº«çŠ¶æ€ï¼Œä»…åšå‚æ•°ä¼ é€’å’Œ<code>sarama</code>æ–¹æ³•è°ƒç”¨ï¼Œå¤šä¸ªåç¨‹åŒæ—¶è°ƒç”¨æ— å¹²æ‰°ï¼›</li>
<li><strong><code>sarama</code> ç”Ÿäº§è€…åç¨‹å®‰å…¨</strong>ï¼šåº•å±‚å°è£…äº†é”æœºåˆ¶å’Œå¹¶å‘å¤„ç†é€»è¾‘ï¼Œæ”¯æŒå¤šåç¨‹å…±äº«è°ƒç”¨ï¼›</li>
<li><strong>ã€Œä¸€ä¸ªåç¨‹ä¸€ä¸ªç”Ÿäº§è€…ã€çš„è®¾è®¡</strong>ï¼šé¿å…å…±äº«å®ä¾‹çš„ç«äº‰é—®é¢˜ï¼Œå³ä½¿å®¢æˆ·ç«¯éåç¨‹å®‰å…¨ï¼Œä¹Ÿèƒ½ä¿è¯å¹¶å‘å®‰å…¨ï¼ŒåŒæ—¶æå‡å‘é€æ•ˆç‡ï¼›</li>
<li><strong>panic æ•è·ä¸ä¼˜é›…å…³é—­</strong>ï¼šé˜²æ­¢å•ä¸ªåç¨‹å¼‚å¸¸æ‰©æ•£ï¼Œä¿è¯æœåŠ¡ç¨³å®šæ€§ï¼Œé¿å…æ¶ˆæ¯ä¸¢å¤±ã€‚</li>
</ol>
<h3 data-id="heading-15">2. æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>åˆç†é…ç½®å¹¶å‘æ•°</strong>ï¼š<code>ConcurrentProducerNum</code> ä¸å®œè¿‡å¤§ï¼Œéœ€ç»“åˆæœåŠ¡å™¨ CPUã€å†…å­˜å’Œ Kafka é›†ç¾¤å¤„ç†èƒ½åŠ›è°ƒæ•´ï¼Œä¸€èˆ¬å»ºè®®ä¸ CPU æ ¸å¿ƒæ•°ç›¸å½“ï¼›</li>
<li><strong>å¯ç”¨æ‰¹é‡å‘é€</strong>ï¼šé€šè¿‡<code>sarama</code>çš„æ‰¹é‡é…ç½®ï¼Œå‡å°‘ç½‘ç»œè¯·æ±‚æ¬¡æ•°ï¼Œå¤§å¹…æå‡ååé‡ï¼›</li>
<li><strong>æ·»åŠ é‡è¯•æœºåˆ¶</strong>ï¼šé’ˆå¯¹ç½‘ç»œæŠ–åŠ¨ã€Kafka é›†ç¾¤ä¸´æ—¶ä¸å¯ç”¨ç­‰åœºæ™¯ï¼Œé‡è¯•æœºåˆ¶èƒ½æå‡æ¶ˆæ¯æŠ•é€’çš„å¯é æ€§ï¼›</li>
<li><strong>ä½¿ç”¨é€šé“ç¼“å†²åŒº</strong>ï¼šä»»åŠ¡é€šé“çš„ç¼“å†²åŒºèƒ½æœ‰æ•ˆå‰Šå³°å¡«è°·ï¼Œé¿å…é«˜å¹¶å‘åœºæ™¯ä¸‹çš„åç¨‹é˜»å¡ï¼›</li>
<li><strong>ä¼˜é›…å…³é—­ä¸å¯å°‘</strong>ï¼šæœåŠ¡åœæ­¢æ—¶ï¼Œå…ˆå…³é—­ä»»åŠ¡é€šé“ï¼Œå†ç­‰å¾…ç”Ÿäº§è€…åç¨‹å¤„ç†å®Œå‰©ä½™æ¶ˆæ¯ï¼Œæœ€åå…³é—­ç”Ÿäº§è€…å®ä¾‹ï¼Œé˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ã€‚</li>
</ol>
<h2 data-id="heading-16">äº”ã€æ‰©å±•åœºæ™¯</h2>
<ol>
<li>è‹¥è¿½æ±‚æ›´é«˜çš„ååé‡ï¼Œå¯ä½¿ç”¨ <code>sarama.AsyncProducer</code>ï¼ˆå¼‚æ­¥ç”Ÿäº§è€…ï¼‰ï¼Œè¿›ä¸€æ­¥æå‡å¹¶å‘æ€§èƒ½ï¼›</li>
<li>å¯æ¥å…¥ Prometheus ç›‘æ§ï¼Œç»Ÿè®¡æ¶ˆæ¯å‘é€æˆåŠŸç‡ã€å»¶è¿Ÿã€ç§¯å‹é‡ç­‰æŒ‡æ ‡ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥ï¼›</li>
<li>å¯æ·»åŠ æ¶ˆæ¯æŒä¹…åŒ–æœºåˆ¶ï¼Œå¯¹äºå‘é€å¤±è´¥çš„æ¶ˆæ¯ï¼Œè½åœ°åˆ°æœ¬åœ°æ–‡ä»¶æˆ–æ•°æ®åº“ï¼Œåç»­è¿›è¡Œé‡è¯•è¡¥å¿ï¼Œå®ç°æ¶ˆæ¯é›¶ä¸¢å¤±ã€‚</li>
</ol>
<h2 data-id="heading-17">æ€»ç»“</h2>
<p>æœ¬æ–‡åŸºäºå¼€æºçš„<code>sarama</code>åº“ï¼Œå®ç°äº†é«˜å¹¶å‘ Kafka æ¶ˆæ¯å‘é€çš„æ–¹æ¡ˆï¼Œæ—¢ä¿è¯äº†å‘é€é€Ÿåº¦ï¼Œåˆè§£å†³äº†å¹¶å‘å®‰å…¨çš„æ ¸å¿ƒé—®é¢˜ã€‚ã€Œå¤šç”Ÿäº§è€… + å¤šåç¨‹ã€çš„æ¨¡å‹ï¼Œå……åˆ†å‘æŒ¥äº† Go è¯­è¨€åç¨‹çš„ä¼˜åŠ¿ï¼Œèƒ½å¤Ÿæ»¡è¶³å¤§å¤šæ•°é«˜ååä¸šåŠ¡åœºæ™¯çš„éœ€æ±‚ã€‚åŒæ—¶ï¼Œæ–‡ä¸­çš„æœ€ä½³å®è·µå’Œæ‰©å±•æ–¹æ¡ˆï¼Œä¹Ÿä¸ºç”Ÿäº§ç¯å¢ƒçš„è½åœ°æä¾›äº†å‚è€ƒï¼Œå¸®åŠ©å¼€å‘è€…é¿å¼€å¸¸è§çš„å‘ï¼Œæ„å»ºç¨³å®šã€é«˜æ•ˆçš„ Kafka æ¶ˆæ¯å‘é€æœåŠ¡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ“ Java IOæµå®Œå…¨æŒ‡å—ï¼šä»å­—èŠ‚æµåˆ°é«˜çº§æ“ä½œ]]></title>    <link>https://juejin.cn/post/7595868336594731027</link>    <guid>https://juejin.cn/post/7595868336594731027</guid>    <pubDate>2026-01-17T03:44:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595868336594731027" data-draft-id="7595800318519263238" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ“ Java IOæµå®Œå…¨æŒ‡å—ï¼šä»å­—èŠ‚æµåˆ°é«˜çº§æ“ä½œ"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2026-01-17T03:44:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ€»ä¼šè½å¶"/> <meta itemprop="url" content="https://juejin.cn/user/766787307710060"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ“ Java IOæµå®Œå…¨æŒ‡å—ï¼šä»å­—èŠ‚æµåˆ°é«˜çº§æ“ä½œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/766787307710060/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ€»ä¼šè½å¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T03:44:19.000Z" title="Sat Jan 17 2026 03:44:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ“ Java IOæµå®Œå…¨æŒ‡å—ï¼šä»å­—èŠ‚æµåˆ°é«˜çº§æ“ä½œ</h2>
<h3 data-id="heading-1">ğŸ¯ å‰è¨€</h3>
<p>Java I/Oæµæ˜¯å¤„ç†è¾“å…¥è¾“å‡ºçš„æ ¸å¿ƒAPIï¼Œç”¨äºè¯»å†™æ–‡ä»¶ã€ç½‘ç»œé€šä¿¡ç­‰ã€‚æŒæ¡IOæµæ˜¯Javaç¨‹åºå‘˜çš„å¿…å¤‡æŠ€èƒ½ï¼è®©æˆ‘ä»¬ä¸€èµ·æ¥ç³»ç»Ÿå­¦ä¹ å§~ ğŸ˜Š</p>
<h3 data-id="heading-2">ğŸ“Š IOæµä½“ç³»æ€»è§ˆ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">Java IOæµ
â”œâ”€â”€ æŒ‰æ•°æ®ç±»å‹åˆ†
â”‚ Â  â”œâ”€â”€ å­—èŠ‚æµï¼ˆ<span class="hljs-built_in">Byte</span> Streamsï¼‰
â”‚ Â  â”‚ Â  â”œâ”€â”€ InputStreamï¼ˆæŠ½è±¡ç±»ï¼‰
â”‚ Â  â”‚ Â  â””â”€â”€ OutputStreamï¼ˆæŠ½è±¡ç±»ï¼‰
â”‚ Â  â””â”€â”€ å­—ç¬¦æµï¼ˆCharacter Streamsï¼‰
â”‚ Â  Â  Â  â”œâ”€â”€ Readerï¼ˆæŠ½è±¡ç±»ï¼‰
â”‚ Â  Â  Â  â””â”€â”€ Writerï¼ˆæŠ½è±¡ç±»ï¼‰
â”œâ”€â”€ æŒ‰åŠŸèƒ½åˆ†
â”‚ Â  â”œâ”€â”€ èŠ‚ç‚¹æµï¼ˆç›´æ¥æ“ä½œæ•°æ®æºï¼‰
â”‚ Â  â””â”€â”€ å¤„ç†æµï¼ˆåŒ…è£…èŠ‚ç‚¹æµï¼Œå¢å¼ºåŠŸèƒ½ï¼‰
â””â”€â”€ ç‰¹æ®Šæµ
 Â   â”œâ”€â”€ å¯¹è±¡æµï¼ˆåºåˆ—åŒ–ï¼‰
 Â   â”œâ”€â”€ æ‰“å°æµ
 Â   â”œâ”€â”€ è½¬æ¢æµ
 Â   â””â”€â”€ å‹ç¼©æµ
</code></pre>
<h3 data-id="heading-3">ğŸ”¢ å­—èŠ‚æµï¼ˆByte Streamsï¼‰</h3>
<h4 data-id="heading-4"><strong>FileOutputStream</strong> - å­—èŠ‚è¾“å‡ºæµ ğŸ’¾</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.FileOutputStream;
<span class="hljs-keyword">import</span> java.io.IOException;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileOutputStreamDemo</span> {
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
 Â  Â  Â  Â <span class="hljs-comment">// æ–¹æ³•1ï¼šç›´æ¥ä½¿ç”¨æ–‡ä»¶è·¯å¾„</span>
 Â  Â  Â  Â <span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos1</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
 Â  Â  Â  Â <span class="hljs-comment">// æ–¹æ³•2ï¼šä½¿ç”¨Fileå¯¹è±¡ï¼ˆæ›´çµæ´»ï¼‰</span>
 Â  Â  Â  Â <span class="hljs-comment">// FileOutputStream fos2 = new FileOutputStream(new File("test.txt"));</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-keyword">try</span> {
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 1. åˆ›å»ºå¯¹è±¡ï¼ˆä¼šæ¸…ç©ºåŸæ–‡ä»¶å†…å®¹ï¼‰</span>
 Â  Â  Â  Â  Â  Â fos1 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"test.txt"</span>);
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 2. å†™å…¥æ•°æ®</span>
 Â  Â  Â  Â  Â  Â fos1.write(<span class="hljs-number">97</span>); Â  Â  Â  Â  Â  <span class="hljs-comment">// å†™å…¥å­—èŠ‚ 'a'</span>
 Â  Â  Â  Â  Â  Â fos1.write(<span class="hljs-string">"\r\n"</span>.getBytes()); Â <span class="hljs-comment">// æ¢è¡Œ</span>
 Â  Â  Â  Â  Â  Â fos1.write(<span class="hljs-string">"Hello Java!"</span>.getBytes());
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 3. ç»­å†™æ¨¡å¼ï¼ˆä¸ä¼šæ¸…ç©ºåŸå†…å®¹ï¼‰</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"test.txt"</span>, <span class="hljs-literal">true</span>);
 Â  Â  Â  Â  Â  Â fos2.write(<span class="hljs-string">"\nè¿½åŠ å†…å®¹"</span>.getBytes());
 Â  Â  Â  Â  Â  Â fos2.close();
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   } <span class="hljs-keyword">finally</span> {
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 4. é‡Šæ”¾èµ„æºï¼ˆå¿…é¡»æ‰§è¡Œï¼‰</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">try</span> {
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> (fos1 != <span class="hljs-literal">null</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â fos1.close();
 Â  Â  Â  Â  Â  Â  Â   }
 Â  Â  Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }
 Â   }
}
</code></pre>
<h5 data-id="heading-5">ğŸ’¡ æ³¨æ„äº‹é¡¹ï¼š</h5>
<ul>
<li>æ¢è¡Œç¬¦ï¼šWindowsç”¨ <code>\r\n</code>ï¼ŒLinux/Macç”¨ <code>\n</code></li>
<li>è·¯å¾„ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œä½†çˆ¶ç›®å½•å¿…é¡»å­˜åœ¨</li>
<li>ä½¿ç”¨ try-with-resources æ›´å®‰å…¨ï¼ˆJava 7+ï¼‰</li>
</ul>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¨èï¼šä½¿ç”¨try-with-resourcesè‡ªåŠ¨å…³é—­æµ</span>
<span class="hljs-keyword">try</span> (<span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"test.txt"</span>)) {
 Â  Â fos.write(<span class="hljs-string">"è‡ªåŠ¨å…³é—­æµï¼Œå®‰å…¨ï¼"</span>.getBytes());
} <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â e.printStackTrace();
}
</code></pre>
<h4 data-id="heading-6"><strong>FileInputStream</strong> - å­—èŠ‚è¾“å…¥æµ ğŸ“–</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.FileInputStream;
<span class="hljs-keyword">import</span> java.io.IOException;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileInputStreamDemo</span> {
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
 Â  Â  Â  Â <span class="hljs-comment">// 1. å•ä¸ªå­—èŠ‚è¯»å–ï¼ˆæ•ˆç‡ä½ï¼‰</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"test.txt"</span>)) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">int</span> b;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">while</span> ((b = fis.read()) != -<span class="hljs-number">1</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â System.out.print((<span class="hljs-type">char</span>) b);
 Â  Â  Â  Â  Â   }
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 2. å­—èŠ‚æ•°ç»„è¯»å–ï¼ˆé«˜æ•ˆæ¨èï¼‰</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"test.txt"</span>)) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">1024</span>]; Â <span class="hljs-comment">// 1KBç¼“å†²åŒº</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-type">int</span> len;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">while</span> ((len = fis.read(buffer)) != -<span class="hljs-number">1</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â System.out.println(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(buffer, <span class="hljs-number">0</span>, len));
 Â  Â  Â  Â  Â   }
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 3. è¯»å–æŒ‡å®šé•¿åº¦</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"test.txt"</span>)) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">byte</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">5</span>];
 Â  Â  Â  Â  Â  Â <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> fis.read(buffer, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>); Â <span class="hljs-comment">// æœ€å¤šè¯»5ä¸ªå­—èŠ‚</span>
 Â  Â  Â  Â  Â  Â System.out.println(<span class="hljs-string">"è¯»å–äº† "</span> + len + <span class="hljs-string">" å­—èŠ‚"</span>);
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â   }
}
</code></pre>
<h3 data-id="heading-7">ğŸ”¤ å­—ç¬¦æµï¼ˆCharacter Streamsï¼‰</h3>
<h4 data-id="heading-8"><strong>FileReader</strong> - å­—ç¬¦è¾“å…¥æµ ğŸ“š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.FileReader;
<span class="hljs-keyword">import</span> java.io.IOException;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileReaderDemo</span> {
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
 Â  Â  Â  Â <span class="hljs-comment">// 1. å•ä¸ªå­—ç¬¦è¯»å–</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileReader</span> <span class="hljs-variable">fr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(<span class="hljs-string">"test.txt"</span>)) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">int</span> ch;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">while</span> ((ch = fr.read()) != -<span class="hljs-number">1</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â System.out.print((<span class="hljs-type">char</span>) ch);
 Â  Â  Â  Â  Â   }
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 2. å­—ç¬¦æ•°ç»„è¯»å–ï¼ˆæ¨èï¼‰</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileReader</span> <span class="hljs-variable">fr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(<span class="hljs-string">"test.txt"</span>)) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">char</span>[] chars = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[<span class="hljs-number">1024</span>];
 Â  Â  Â  Â  Â  Â <span class="hljs-type">int</span> len;
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">while</span> ((len = fr.read(chars)) != -<span class="hljs-number">1</span>) {
 Â  Â  Â  Â  Â  Â  Â  Â System.out.print(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(chars, <span class="hljs-number">0</span>, len));
 Â  Â  Â  Â  Â   }
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 3. è¯»å–åˆ°æŒ‡å®šæ•°ç»„ä½ç½®</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileReader</span> <span class="hljs-variable">fr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(<span class="hljs-string">"test.txt"</span>)) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">char</span>[] chars = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[<span class="hljs-number">10</span>];
 Â  Â  Â  Â  Â  Â <span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> fr.read(chars, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>); Â <span class="hljs-comment">// ä»æ•°ç»„ç´¢å¼•2å¼€å§‹å­˜ï¼Œæœ€å¤šè¯»5ä¸ª</span>
 Â  Â  Â  Â  Â  Â System.out.println(<span class="hljs-string">"å®é™…è¯»å–å­—ç¬¦æ•°ï¼š"</span> + len);
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â   }
}
</code></pre>
<h4 data-id="heading-9"><strong>FileWriter</strong> - å­—ç¬¦è¾“å‡ºæµ ğŸ“</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.FileWriter;
<span class="hljs-keyword">import</span> java.io.IOException;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileWriterDemo</span> {
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
 Â  Â  Â  Â <span class="hljs-comment">// 1. åŸºæœ¬å†™å…¥</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileWriter</span> <span class="hljs-variable">fw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileWriter</span>(<span class="hljs-string">"output.txt"</span>)) {
 Â  Â  Â  Â  Â  Â fw.write(<span class="hljs-string">"Hello World!\n"</span>);
 Â  Â  Â  Â  Â  Â fw.write(<span class="hljs-number">65</span>); Â <span class="hljs-comment">// å†™å…¥å­—ç¬¦ 'A'</span>
 Â  Â  Â  Â  Â  Â fw.write(<span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[]{<span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'D'</span>});
 Â  Â  Â  Â  Â  Â fw.write(<span class="hljs-string">"Javaç¼–ç¨‹"</span>, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>); Â <span class="hljs-comment">// å†™å…¥"Java"</span>
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 2. è¿½åŠ æ¨¡å¼</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileWriter</span> <span class="hljs-variable">fw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileWriter</span>(<span class="hljs-string">"output.txt"</span>, <span class="hljs-literal">true</span>)) {
 Â  Â  Â  Â  Â  Â fw.write(<span class="hljs-string">"\nè¿™æ˜¯è¿½åŠ çš„å†…å®¹"</span>);
 Â  Â  Â  Â  Â  Â fw.flush(); Â <span class="hljs-comment">// åˆ·æ–°ç¼“å†²åŒºï¼Œç«‹å³å†™å…¥</span>
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 3. å†™å…¥å­—ç¬¦æ•°ç»„çš„ä¸€éƒ¨åˆ†</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">FileWriter</span> <span class="hljs-variable">fw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileWriter</span>(<span class="hljs-string">"output.txt"</span>)) {
 Â  Â  Â  Â  Â  Â <span class="hljs-type">char</span>[] data = {<span class="hljs-string">'J'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-string">'v'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-string">'ç¼–'</span>, <span class="hljs-string">'ç¨‹'</span>};
 Â  Â  Â  Â  Â  Â fw.write(data, <span class="hljs-number">0</span>, <span class="hljs-number">4</span>); Â <span class="hljs-comment">// åªå†™å…¥"Java"</span>
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â   }
}
</code></pre>
<h3 data-id="heading-10">ğŸ”„ ç¼–ç ä¸è§£ç è¯¦è§£</h3>
<h4 data-id="heading-11"><strong>ç¼–ç è¿‡ç¨‹</strong> ğŸ”¡â†’ğŸ”¢</h4>
<pre><code class="hljs language-csharp" lang="csharp">import java.util.Arrays;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EncodingDemo</span> {
 Â  Â <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>) throws Exception</span> {
 Â  Â  Â  Â String str = <span class="hljs-string">"aiä½ å“Ÿâ¤"</span>;
 Â  Â  Â  Â 
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"=== ä¸åŒç¼–ç æ–¹å¼æ¯”è¾ƒ ==="</span>);
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 1. å¹³å°é»˜è®¤ç¼–ç ï¼ˆé€šå¸¸æ˜¯UTF-8ï¼‰</span>
 Â  Â  Â  Â <span class="hljs-built_in">byte</span>[] defaultBytes = str.getBytes();
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"é»˜è®¤ç¼–ç ï¼ˆ"</span> + System.getProperty(<span class="hljs-string">"file.encoding"</span>) + <span class="hljs-string">"ï¼‰ï¼š"</span>);
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(Arrays.toString(defaultBytes));
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å­—èŠ‚æ•°ï¼š"</span> + defaultBytes.length);
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 2. UTF-8ç¼–ç ï¼ˆå˜é•¿ï¼Œä¸­æ–‡3-4å­—èŠ‚ï¼‰</span>
 Â  Â  Â  Â <span class="hljs-built_in">byte</span>[] utf8Bytes = str.getBytes(<span class="hljs-string">"UTF-8"</span>);
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\nUTF-8ç¼–ç ï¼š"</span>);
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(Arrays.toString(utf8Bytes));
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å­—èŠ‚æ•°ï¼š"</span> + utf8Bytes.length);
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 3. GBKç¼–ç ï¼ˆä¸­æ–‡2å­—èŠ‚ï¼‰</span>
 Â  Â  Â  Â <span class="hljs-built_in">byte</span>[] gbkBytes = str.getBytes(<span class="hljs-string">"GBK"</span>);
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\nGBKç¼–ç ï¼š"</span>);
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(Arrays.toString(gbkBytes));
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å­—èŠ‚æ•°ï¼š"</span> + gbkBytes.length);
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 4. ISO-8859-1ï¼ˆä¸æ”¯æŒä¸­æ–‡ï¼Œä¼šä¸¢å¤±ä¿¡æ¯ï¼‰</span>
 Â  Â  Â  Â <span class="hljs-built_in">byte</span>[] isoBytes = str.getBytes(<span class="hljs-string">"ISO-8859-1"</span>);
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"\nISO-8859-1ç¼–ç ï¼ˆä¸æ”¯æŒä¸­æ–‡ï¼‰ï¼š"</span>);
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(Arrays.toString(isoBytes));
 Â  Â  Â  Â System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"è§£ç åï¼š"</span> + <span class="hljs-keyword">new</span> String(isoBytes, <span class="hljs-string">"ISO-8859-1"</span>));
 Â   }
}
</code></pre>
<h4 data-id="heading-12"><strong>è§£ç è¿‡ç¨‹</strong> ğŸ”¢â†’ğŸ”¡</h4>
<pre><code class="hljs language-ini" lang="ini">public class DecodingDemo {
 Â  Â public static void main(String<span class="hljs-section">[]</span> args) throws Exception {
 Â  Â  Â  Â String <span class="hljs-attr">original</span> = <span class="hljs-string">"ä½ å¥½JavağŸ‰"</span><span class="hljs-comment">;</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â // 1. æ­£ç¡®è§£ç ï¼ˆç¼–ç è§£ç ä¸€è‡´ï¼‰
 Â  Â  Â  Â byte<span class="hljs-section">[]</span> <span class="hljs-attr">utf8Bytes</span> = original.getBytes(<span class="hljs-string">"UTF-8"</span>)<span class="hljs-comment">;</span>
 Â  Â  Â  Â String <span class="hljs-attr">correct</span> = new String(utf8Bytes, <span class="hljs-string">"UTF-8"</span>)<span class="hljs-comment">;</span>
 Â  Â  Â  Â System.out.println("æ­£ç¡®è§£ç ï¼š" + correct)<span class="hljs-comment">;</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â // 2. é”™è¯¯è§£ç ï¼ˆç¼–ç è§£ç ä¸ä¸€è‡´ï¼‰
 Â  Â  Â  Â byte<span class="hljs-section">[]</span> <span class="hljs-attr">gbkBytes</span> = original.getBytes(<span class="hljs-string">"GBK"</span>)<span class="hljs-comment">;</span>
 Â  Â  Â  Â String <span class="hljs-attr">wrong1</span> = new String(gbkBytes, <span class="hljs-string">"UTF-8"</span>)<span class="hljs-comment">;</span>
 Â  Â  Â  Â System.out.println("é”™è¯¯è§£ç ï¼ˆGBKâ†’UTF-8ï¼‰ï¼š" + wrong1)<span class="hljs-comment">;</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â // 3. æ¢å¤ä¹±ç 
 Â  Â  Â  Â byte<span class="hljs-section">[]</span> <span class="hljs-attr">wrongBytes</span> = wrong1.getBytes(<span class="hljs-string">"UTF-8"</span>)<span class="hljs-comment">;</span>
 Â  Â  Â  Â String <span class="hljs-attr">recovered</span> = new String(wrongBytes, <span class="hljs-string">"GBK"</span>)<span class="hljs-comment">;</span>
 Â  Â  Â  Â System.out.println("æ¢å¤åï¼š" + recovered)<span class="hljs-comment">;</span>
 Â   }
}
</code></pre>
<h3 data-id="heading-13">âš¡ ç¼“å†²æµï¼ˆé«˜æ•ˆæµï¼‰</h3>
<h4 data-id="heading-14"><strong>å­—èŠ‚ç¼“å†²æµ</strong> ğŸš€</h4>
<pre><code class="hljs language-ini" lang="ini">import java.io.*<span class="hljs-comment">;</span>

public class BufferedStreamDemo {
    public static void main(String<span class="hljs-section">[]</span> args) {
        String <span class="hljs-attr">srcFile</span> = <span class="hljs-string">"largefile.mp4"</span><span class="hljs-comment">;</span>
        String <span class="hljs-attr">destFile</span> = <span class="hljs-string">"copy.mp4"</span><span class="hljs-comment">;</span>
        
        // 1. åŸºæœ¬æ‹·è´ï¼ˆå•ä¸ªå­—èŠ‚ï¼Œæ…¢ï¼ï¼‰
        long <span class="hljs-attr">start1</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
        try (FileInputStream <span class="hljs-attr">fis</span> = new FileInputStream(srcFile)<span class="hljs-comment">;</span>
             FileOutputStream <span class="hljs-attr">fos</span> = new FileOutputStream(<span class="hljs-string">"copy1.mp4"</span>)) {
            int b<span class="hljs-comment">;</span>
            while ((<span class="hljs-attr">b</span> = fis.read()) != -<span class="hljs-number">1</span>) {
                fos.write(b)<span class="hljs-comment">;</span>
            }
        } catch (IOException e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
        long <span class="hljs-attr">end1</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
        System.out.println("åŸºæœ¬æ‹·è´è€—æ—¶ï¼š" + (end1 - start1) + "ms")<span class="hljs-comment">;</span>
        
        // 2. ç¼“å†²æµæ‹·è´ï¼ˆé«˜æ•ˆï¼‰
        long <span class="hljs-attr">start2</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
        try (BufferedInputStream <span class="hljs-attr">bis</span> = new BufferedInputStream(
                new FileInputStream(srcFile))<span class="hljs-comment">;</span>
             BufferedOutputStream <span class="hljs-attr">bos</span> = new BufferedOutputStream(
                new FileOutputStream("copy2.mp4"))) {
            int b<span class="hljs-comment">;</span>
            while ((<span class="hljs-attr">b</span> = bis.read()) != -<span class="hljs-number">1</span>) {
                bos.write(b)<span class="hljs-comment">;</span>
            }
        } catch (IOException e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
        long <span class="hljs-attr">end2</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
        System.out.println("ç¼“å†²æµæ‹·è´è€—æ—¶ï¼š" + (end2 - start2) + "ms")<span class="hljs-comment">;</span>
        
        // 3. ç¼“å†²æµ+æ•°ç»„ï¼ˆæœ€å¿«ï¼‰
        long <span class="hljs-attr">start3</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
        try (BufferedInputStream <span class="hljs-attr">bis</span> = new BufferedInputStream(
                new FileInputStream(srcFile))<span class="hljs-comment">;</span>
             BufferedOutputStream <span class="hljs-attr">bos</span> = new BufferedOutputStream(
                new FileOutputStream("copy3.mp4"))) {
            byte<span class="hljs-section">[]</span> <span class="hljs-attr">buffer</span> = new byte[<span class="hljs-number">8192</span>]<span class="hljs-comment">;  // 8KBç¼“å†²åŒº</span>
            int len<span class="hljs-comment">;</span>
            while ((<span class="hljs-attr">len</span> = bis.read(buffer)) != -<span class="hljs-number">1</span>) {
                bos.write(buffer, 0, len)<span class="hljs-comment">;</span>
            }
        } catch (IOException e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
        long <span class="hljs-attr">end3</span> = System.currentTimeMillis()<span class="hljs-comment">;</span>
        System.out.println("ç¼“å†²æµ+æ•°ç»„æ‹·è´è€—æ—¶ï¼š" + (end3 - start3) + "ms")<span class="hljs-comment">;</span>
    }
}
</code></pre>
<h4 data-id="heading-15"><strong>å­—ç¬¦ç¼“å†²æµ</strong> ğŸ“š</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.*;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BufferedReaderWriterDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// 1. BufferedReader - æŒ‰è¡Œè¯»å–</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">BufferedReader</span> <span class="hljs-variable">br</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileReader</span>(<span class="hljs-string">"test.txt"</span>))) {
            String line;
            <span class="hljs-type">int</span> <span class="hljs-variable">lineNumber</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
            <span class="hljs-keyword">while</span> ((line = br.readLine()) != <span class="hljs-literal">null</span>) {
                System.out.println(lineNumber++ + <span class="hljs-string">": "</span> + line);
            }
        } <span class="hljs-keyword">catch</span> (IOException e) {
            e.printStackTrace();
        }
        
        <span class="hljs-comment">// 2. BufferedWriter - é«˜æ•ˆå†™å…¥</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">BufferedWriter</span> <span class="hljs-variable">bw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedWriter</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileWriter</span>(<span class="hljs-string">"output.txt"</span>))) {
            bw.write(<span class="hljs-string">"ç¬¬ä¸€è¡Œ"</span>);
            bw.newLine();  <span class="hljs-comment">// è·¨å¹³å°æ¢è¡Œ</span>
            bw.write(<span class="hljs-string">"ç¬¬äºŒè¡Œ"</span>);
            bw.flush();  <span class="hljs-comment">// ç«‹å³å†™å…¥</span>
            
            <span class="hljs-comment">// æ‰¹é‡å†™å…¥</span>
            String[] lines = {<span class="hljs-string">"ç¬¬ä¸‰è¡Œ"</span>, <span class="hljs-string">"ç¬¬å››è¡Œ"</span>, <span class="hljs-string">"ç¬¬äº”è¡Œ"</span>};
            <span class="hljs-keyword">for</span> (String l : lines) {
                bw.write(l);
                bw.newLine();
            }
        } <span class="hljs-keyword">catch</span> (IOException e) {
            e.printStackTrace();
        }
        
        <span class="hljs-comment">// 3. æ ‡å‡†è¾“å…¥è¯»å–</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">BufferedReader</span> <span class="hljs-variable">consoleReader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in))) {
            System.out.print(<span class="hljs-string">"è¯·è¾“å…¥ï¼š"</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> consoleReader.readLine();
            System.out.println(<span class="hljs-string">"æ‚¨è¾“å…¥çš„æ˜¯ï¼š"</span> + input);
        } <span class="hljs-keyword">catch</span> (IOException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<h3 data-id="heading-16">ğŸ”€ è½¬æ¢æµï¼ˆInputStreamReader/OutputStreamWriterï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.*;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConvertStreamDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 1. è¯»å–GBKç¼–ç æ–‡ä»¶ï¼Œè½¬æ¢ä¸ºUTF-8</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">InputStreamReader</span> <span class="hljs-variable">isr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"gbkfile.txt"</span>), <span class="hljs-string">"GBK"</span>);
             <span class="hljs-type">OutputStreamWriter</span> <span class="hljs-variable">osw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStreamWriter</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"utf8file.txt"</span>), <span class="hljs-string">"UTF-8"</span>)) {
            
            <span class="hljs-type">char</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[<span class="hljs-number">1024</span>];
            <span class="hljs-type">int</span> len;
            <span class="hljs-keyword">while</span> ((len = isr.read(buffer)) != -<span class="hljs-number">1</span>) {
                osw.write(buffer, <span class="hljs-number">0</span>, len);
            }
        }
        
        <span class="hljs-comment">// 2. æ§åˆ¶å°æŒ‡å®šç¼–ç è¯»å–</span>
        System.out.println(<span class="hljs-string">"è¯·è¾“å…¥ä¸­æ–‡ï¼š"</span>);
        <span class="hljs-keyword">try</span> (<span class="hljs-type">BufferedReader</span> <span class="hljs-variable">br</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in, <span class="hljs-string">"GBK"</span>))) {
            <span class="hljs-type">String</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> br.readLine();
            System.out.println(<span class="hljs-string">"æ‚¨è¾“å…¥çš„æ˜¯ï¼š"</span> + input);
            
            <span class="hljs-comment">// ä»¥UTF-8ä¿å­˜</span>
            <span class="hljs-keyword">try</span> (<span class="hljs-type">OutputStreamWriter</span> <span class="hljs-variable">osw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStreamWriter</span>(
                    <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"input.txt"</span>), <span class="hljs-string">"UTF-8"</span>)) {
                osw.write(input);
            }
        }
        
        <span class="hljs-comment">// 3. æ–‡ä»¶ç¼–ç æ£€æµ‹å’Œè½¬æ¢</span>
        convertFileEncoding(<span class="hljs-string">"source.txt"</span>, <span class="hljs-string">"GBK"</span>, <span class="hljs-string">"target.txt"</span>, <span class="hljs-string">"UTF-8"</span>);
    }
    
    <span class="hljs-comment">// é€šç”¨ç¼–ç è½¬æ¢æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">convertFileEncoding</span><span class="hljs-params">(String srcFile, String srcCharset,
                                          String destFile, String destCharset)</span> 
                                          <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-keyword">try</span> (<span class="hljs-type">InputStreamReader</span> <span class="hljs-variable">isr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(srcFile), srcCharset);
             <span class="hljs-type">OutputStreamWriter</span> <span class="hljs-variable">osw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStreamWriter</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(destFile), destCharset)) {
            
            <span class="hljs-type">char</span>[] buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">char</span>[<span class="hljs-number">4096</span>];
            <span class="hljs-type">int</span> len;
            <span class="hljs-keyword">while</span> ((len = isr.read(buffer)) != -<span class="hljs-number">1</span>) {
                osw.write(buffer, <span class="hljs-number">0</span>, len);
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-17">ğŸ’¾ åºåˆ—åŒ–æµï¼ˆObjectInputStream/ObjectOutputStreamï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.*;
<span class="hljs-keyword">import</span> java.util.Date;

<span class="hljs-comment">// å¿…é¡»å®ç°Serializableæ¥å£</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {
    <span class="hljs-comment">// åºåˆ—åŒ–ç‰ˆæœ¬IDï¼Œé˜²æ­¢ç±»ä¿®æ”¹åååºåˆ—åŒ–å¤±è´¥</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;
    
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">transient</span> String password;  <span class="hljs-comment">// transientä¿®é¥°çš„å­—æ®µä¸åºåˆ—åŒ–</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;
    <span class="hljs-keyword">private</span> Date birthday;
    
    <span class="hljs-comment">// æ„é€ æ–¹æ³•ã€getter/setterçœç•¥...</span>
    
    <span class="hljs-comment">// è‡ªå®šä¹‰åºåˆ—åŒ–è¿‡ç¨‹ï¼ˆå¯é€‰ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeObject</span><span class="hljs-params">(ObjectOutputStream oos)</span> <span class="hljs-keyword">throws</span> IOException {
        oos.defaultWriteObject();  <span class="hljs-comment">// é»˜è®¤åºåˆ—åŒ–</span>
        <span class="hljs-comment">// è‡ªå®šä¹‰åºåˆ—åŒ–é€»è¾‘</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(ObjectInputStream ois)</span> 
            <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException {
        ois.defaultReadObject();  <span class="hljs-comment">// é»˜è®¤ååºåˆ—åŒ–</span>
        <span class="hljs-comment">// è‡ªå®šä¹‰ååºåˆ—åŒ–é€»è¾‘</span>
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SerializationDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"123456"</span>, <span class="hljs-number">25</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());
        
        <span class="hljs-comment">// 1. åºåˆ—åŒ–ï¼ˆå¯¹è±¡â†’å­—èŠ‚ï¼‰</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"user.dat"</span>))) {
            oos.writeObject(user);
            oos.writeInt(<span class="hljs-number">100</span>);  <span class="hljs-comment">// å¯ä»¥å†™å…¥åŸºæœ¬ç±»å‹</span>
            oos.writeObject(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());
        } <span class="hljs-keyword">catch</span> (IOException e) {
            e.printStackTrace();
        }
        
        <span class="hljs-comment">// 2. ååºåˆ—åŒ–ï¼ˆå­—èŠ‚â†’å¯¹è±¡ï¼‰</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">ois</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"user.dat"</span>))) {
            <span class="hljs-type">User</span> <span class="hljs-variable">readUser</span> <span class="hljs-operator">=</span> (User) ois.readObject();
            <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> ois.readInt();
            <span class="hljs-type">Date</span> <span class="hljs-variable">date</span> <span class="hljs-operator">=</span> (Date) ois.readObject();
            
            System.out.println(<span class="hljs-string">"ç”¨æˆ·åï¼š"</span> + readUser.getName());
            System.out.println(<span class="hljs-string">"å¯†ç ï¼š"</span> + readUser.getPassword());  <span class="hljs-comment">// null</span>
        } <span class="hljs-keyword">catch</span> (IOException | ClassNotFoundException e) {
            e.printStackTrace();
        }
        
        <span class="hljs-comment">// 3. åºåˆ—åŒ–é›†åˆ</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"list.dat"</span>))) {
            java.util.List&lt;User&gt; users = <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.util.ArrayList&lt;&gt;();
            users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-string">"111"</span>, <span class="hljs-number">30</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()));
            users.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"ç‹äº”"</span>, <span class="hljs-string">"222"</span>, <span class="hljs-number">28</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()));
            oos.writeObject(users);
        } <span class="hljs-keyword">catch</span> (IOException e) {
            e.printStackTrace();
        }
    }
}
</code></pre>
<h3 data-id="heading-18">ğŸ–¨ï¸ æ‰“å°æµï¼ˆPrintStream/PrintWriterï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.io.*;
<span class="hljs-keyword">import</span> java.util.Date;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrintStreamDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// 1. PrintStreamï¼ˆå­—èŠ‚æ‰“å°æµï¼‰</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">PrintStream</span> <span class="hljs-variable">ps</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintStream</span>(<span class="hljs-string">"print.txt"</span>)) {
            ps.println(<span class="hljs-string">"Hello PrintStream!"</span>);
            ps.printf(<span class="hljs-string">"å½“å‰æ—¶é—´ï¼š%tF %tT%n"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());
            ps.print(<span class="hljs-string">"ä¸æ¢è¡Œ"</span>);
            ps.println(<span class="hljs-string">"æ¥ç€å†™"</span>);
            
            <span class="hljs-comment">// ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œç”¨checkError()æ£€æŸ¥</span>
            ps.write(<span class="hljs-number">65</span>);  <span class="hljs-comment">// 'A'</span>
            <span class="hljs-keyword">if</span> (ps.checkError()) {
                System.err.println(<span class="hljs-string">"å†™å…¥å‡ºé”™ï¼"</span>);
            }
        }
        
        <span class="hljs-comment">// 2. PrintWriterï¼ˆå­—ç¬¦æ‰“å°æµï¼Œæ›´å¸¸ç”¨ï¼‰</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">PrintWriter</span> <span class="hljs-variable">pw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintWriter</span>(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileWriter</span>(<span class="hljs-string">"print2.txt"</span>), <span class="hljs-literal">true</span>)) {  <span class="hljs-comment">// trueè¡¨ç¤ºè‡ªåŠ¨åˆ·æ–°</span>
            
            pw.println(<span class="hljs-string">"=== å­¦ç”Ÿä¿¡æ¯ ==="</span>);
            pw.printf(<span class="hljs-string">"å§“åï¼š%-10s å¹´é¾„ï¼š%d%n"</span>, <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-number">20</span>);
            pw.printf(<span class="hljs-string">"åˆ†æ•°ï¼š%.2f%n"</span>, <span class="hljs-number">95.5</span>);
            pw.println(<span class="hljs-string">"=============="</span>);
            
            <span class="hljs-comment">// æ”¯æŒé“¾å¼è°ƒç”¨</span>
            pw.append(<span class="hljs-string">"è¿½åŠ å†…å®¹"</span>)
              .append(<span class="hljs-string">"\n"</span>)
              .append(<span class="hljs-string">"å¦ä¸€è¡Œ"</span>);
        }
        
        <span class="hljs-comment">// 3. é‡å®šå‘System.out</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">PrintStream</span> <span class="hljs-variable">fileOut</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintStream</span>(<span class="hljs-string">"system_out.txt"</span>)) {
            <span class="hljs-type">PrintStream</span> <span class="hljs-variable">originalOut</span> <span class="hljs-operator">=</span> System.out;
            System.setOut(fileOut);  <span class="hljs-comment">// é‡å®šå‘</span>
            
            System.out.println(<span class="hljs-string">"è¿™è¡Œä¼šå†™åˆ°æ–‡ä»¶é‡Œ"</span>);
            System.out.println(<span class="hljs-string">"æ§åˆ¶å°çœ‹ä¸åˆ°æˆ‘"</span>);
            
            System.setOut(originalOut);  <span class="hljs-comment">// æ¢å¤</span>
            System.out.println(<span class="hljs-string">"å›åˆ°æ§åˆ¶å°"</span>);
        }
        
        <span class="hljs-comment">// 4. æ ¼å¼åŒ–è¾“å‡º</span>
        <span class="hljs-keyword">try</span> (<span class="hljs-type">PrintWriter</span> <span class="hljs-variable">pw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrintWriter</span>(<span class="hljs-string">"format.txt"</span>)) {
            pw.printf(<span class="hljs-string">"å•†å“\tå•ä»·\tæ•°é‡\tå°è®¡%n"</span>);
            pw.printf(<span class="hljs-string">"%-10s\t%8.2f\t%4d\t%8.2f%n"</span>, 
                     <span class="hljs-string">"Javaä¹¦"</span>, <span class="hljs-number">89.50</span>, <span class="hljs-number">2</span>, <span class="hljs-number">179.00</span>);
            pw.printf(<span class="hljs-string">"%-10s\t%8.2f\t%4d\t%8.2f%n"</span>,
                     <span class="hljs-string">"é¼ æ ‡"</span>, <span class="hljs-number">150.00</span>, <span class="hljs-number">1</span>, <span class="hljs-number">150.00</span>);
            pw.printf(<span class="hljs-string">"%-10s\t%8s\t%4s\t%8.2f%n"</span>,
                     <span class="hljs-string">""</span>, <span class="hljs-string">""</span>, <span class="hljs-string">"åˆè®¡"</span>, <span class="hljs-number">329.00</span>);
        }
    }
}
</code></pre>
<h3 data-id="heading-19">ğŸ“¦ å‹ç¼©ä¸è§£å‹ç¼©æµ</h3>
<pre><code class="hljs language-ini" lang="ini">import java.io.*<span class="hljs-comment">;</span>
import java.util.zip.*<span class="hljs-comment">;</span>
import java.util.Enumeration<span class="hljs-comment">;</span>

public class ZipDemo {
    public static void main(String<span class="hljs-section">[]</span> args) {
        // 1. å•ä¸ªæ–‡ä»¶å‹ç¼©
        try (FileInputStream <span class="hljs-attr">fis</span> = new FileInputStream(<span class="hljs-string">"test.txt"</span>)<span class="hljs-comment">;</span>
             FileOutputStream <span class="hljs-attr">fos</span> = new FileOutputStream(<span class="hljs-string">"test.zip"</span>)<span class="hljs-comment">;</span>
             ZipOutputStream <span class="hljs-attr">zos</span> = new ZipOutputStream(fos)) {
            
            ZipEntry <span class="hljs-attr">entry</span> = new ZipEntry(<span class="hljs-string">"test.txt"</span>)<span class="hljs-comment">;</span>
            zos.putNextEntry(entry)<span class="hljs-comment">;</span>
            
            byte<span class="hljs-section">[]</span> <span class="hljs-attr">buffer</span> = new byte[<span class="hljs-number">1024</span>]<span class="hljs-comment">;</span>
            int len<span class="hljs-comment">;</span>
            while ((<span class="hljs-attr">len</span> = fis.read(buffer)) != -<span class="hljs-number">1</span>) {
                zos.write(buffer, 0, len)<span class="hljs-comment">;</span>
            }
            zos.closeEntry()<span class="hljs-comment">;</span>
        } catch (IOException e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
        
        // 2. å¤šä¸ªæ–‡ä»¶å‹ç¼©
        String<span class="hljs-section">[]</span> <span class="hljs-attr">files</span> = {<span class="hljs-string">"file1.txt"</span>, <span class="hljs-string">"file2.txt"</span>, <span class="hljs-string">"file3.txt"</span>}<span class="hljs-comment">;</span>
        try (ZipOutputStream <span class="hljs-attr">zos</span> = new ZipOutputStream(
                new FileOutputStream("multi.zip"))) {
            
            for (String file : files) {
                try (FileInputStream <span class="hljs-attr">fis</span> = new FileInputStream(file)) {
                    ZipEntry <span class="hljs-attr">entry</span> = new ZipEntry(file)<span class="hljs-comment">;</span>
                    zos.putNextEntry(entry)<span class="hljs-comment">;</span>
                    
                    byte<span class="hljs-section">[]</span> <span class="hljs-attr">buffer</span> = new byte[<span class="hljs-number">1024</span>]<span class="hljs-comment">;</span>
                    int len<span class="hljs-comment">;</span>
                    while ((<span class="hljs-attr">len</span> = fis.read(buffer)) != -<span class="hljs-number">1</span>) {
                        zos.write(buffer, 0, len)<span class="hljs-comment">;</span>
                    }
                    zos.closeEntry()<span class="hljs-comment">;</span>
                }
            }
        } catch (IOException e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
        
        // 3. è§£å‹ç¼©
        try (ZipInputStream <span class="hljs-attr">zis</span> = new ZipInputStream(
                new FileInputStream("multi.zip"))) {
            
            ZipEntry entry<span class="hljs-comment">;</span>
            while ((<span class="hljs-attr">entry</span> = zis.getNextEntry()) != null) {
                System.out.println("è§£å‹: " + entry.getName())<span class="hljs-comment">;</span>
                
                // åˆ›å»ºç›®å½•ç»“æ„
                File <span class="hljs-attr">file</span> = new File(<span class="hljs-string">"extracted/"</span> + entry.getName())<span class="hljs-comment">;</span>
                if (entry.isDirectory()) {
                    file.mkdirs()<span class="hljs-comment">;</span>
                } else {
                    file.getParentFile().mkdirs()<span class="hljs-comment">;</span>
                    
                    try (FileOutputStream <span class="hljs-attr">fos</span> = new FileOutputStream(file)) {
                        byte<span class="hljs-section">[]</span> <span class="hljs-attr">buffer</span> = new byte[<span class="hljs-number">1024</span>]<span class="hljs-comment">;</span>
                        int len<span class="hljs-comment">;</span>
                        while ((<span class="hljs-attr">len</span> = zis.read(buffer)) != -<span class="hljs-number">1</span>) {
                            fos.write(buffer, 0, len)<span class="hljs-comment">;</span>
                        }
                    }
                }
                zis.closeEntry()<span class="hljs-comment">;</span>
            }
        } catch (IOException e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
        
        // 4. ä½¿ç”¨ZipFileç±»ï¼ˆæ›´æ–¹ä¾¿ï¼‰
        try (ZipFile <span class="hljs-attr">zipFile</span> = new ZipFile(<span class="hljs-string">"multi.zip"</span>)) {
            Enumeration&lt;? extends ZipEntry&gt; <span class="hljs-attr">entries</span> = zipFile.entries()<span class="hljs-comment">;</span>
            
            while (entries.hasMoreElements()) {
                ZipEntry <span class="hljs-attr">entry</span> = entries.nextElement()<span class="hljs-comment">;</span>
                System.out.println("æ–‡ä»¶: " + entry.getName() + 
                                 " å¤§å°: " + entry.getSize())<span class="hljs-comment">;</span>
                
                if (!entry.isDirectory()) {
                    try (InputStream <span class="hljs-attr">is</span> = zipFile.getInputStream(entry)) {
                        // å¤„ç†æ–‡ä»¶å†…å®¹
                    }
                }
            }
        } catch (IOException e) {
            e.printStackTrace()<span class="hljs-comment">;</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-20">ğŸ”§ Apache Commons IO å·¥å…·åº“</h3>
<h4 data-id="heading-21"><strong>æ·»åŠ ä¾èµ–</strong> ğŸ“¦</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- Maven --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-io<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.13.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-22"><strong>å¸¸ç”¨å·¥å…·ç±»</strong> ğŸ› ï¸</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.commons.io.FileUtils;
<span class="hljs-keyword">import</span> org.apache.commons.io.IOUtils;
<span class="hljs-keyword">import</span> org.apache.commons.io.FilenameUtils;
<span class="hljs-keyword">import</span> org.apache.commons.io.FileExistsUtils;
â€‹
<span class="hljs-keyword">import</span> java.io.*;
<span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;
<span class="hljs-keyword">import</span> java.util.List;
â€‹
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CommonsIODemo</span> {
 Â  Â <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
 Â  Â  Â  Â <span class="hljs-comment">// 1. FileUtils - æ–‡ä»¶æ“ä½œç¥å™¨</span>
 Â  Â  Â  Â <span class="hljs-type">File</span> <span class="hljs-variable">src</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"source.txt"</span>);
 Â  Â  Â  Â <span class="hljs-type">File</span> <span class="hljs-variable">dest</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"backup.txt"</span>);
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// å¤åˆ¶æ–‡ä»¶</span>
 Â  Â  Â  Â FileUtils.copyFile(src, dest);
 Â  Â  Â  Â FileUtils.copyFile(src, dest, <span class="hljs-literal">true</span>); Â <span class="hljs-comment">// å¼ºåˆ¶è¦†ç›–</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// å¤åˆ¶ç›®å½•</span>
 Â  Â  Â  Â FileUtils.copyDirectory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"srcDir"</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"destDir"</span>));
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// è¯»å–æ–‡ä»¶å†…å®¹</span>
 Â  Â  Â  Â <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> FileUtils.readFileToString(src, <span class="hljs-string">"UTF-8"</span>);
 Â  Â  Â  Â List&lt;String&gt; lines = FileUtils.readLines(src, <span class="hljs-string">"UTF-8"</span>);
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// å†™å…¥æ–‡ä»¶</span>
 Â  Â  Â  Â FileUtils.writeStringToFile(dest, <span class="hljs-string">"Hello Commons IO"</span>, <span class="hljs-string">"UTF-8"</span>);
 Â  Â  Â  Â FileUtils.writeLines(dest, <span class="hljs-string">"UTF-8"</span>, lines, <span class="hljs-literal">true</span>); Â <span class="hljs-comment">// trueè¡¨ç¤ºè¿½åŠ </span>
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// åˆ é™¤ç›®å½•ï¼ˆåŒ…æ‹¬å­ç›®å½•ï¼‰</span>
 Â  Â  Â  Â FileUtils.deleteDirectory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"tempDir"</span>));
 Â  Â  Â  Â FileUtils.forceDelete(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"file.txt"</span>)); Â <span class="hljs-comment">// å¼ºåˆ¶åˆ é™¤</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// æ¸…ç©ºç›®å½•</span>
 Â  Â  Â  Â FileUtils.cleanDirectory(<span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">"cache"</span>));
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 2. IOUtils - æµæ“ä½œç®€åŒ–</span>
 Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"input.txt"</span>);
 Â  Â  Â  Â  Â  Â  <span class="hljs-type">OutputStream</span> <span class="hljs-variable">os</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"output.txt"</span>)) {
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// å¤åˆ¶æµï¼ˆè‡ªåŠ¨å¤„ç†ç¼“å†²å’Œå…³é—­ï¼‰</span>
 Â  Â  Â  Â  Â  Â IOUtils.copy(is, os);
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// è¯»å–å…¨éƒ¨å­—èŠ‚</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-type">byte</span>[] bytes = IOUtils.toByteArray(is);
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// è¯»å–ä¸ºå­—ç¬¦ä¸²</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-type">String</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> IOUtils.toString(is, <span class="hljs-string">"UTF-8"</span>);
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// å†™å…¥å­—ç¬¦ä¸²åˆ°æµ</span>
 Â  Â  Â  Â  Â  Â IOUtils.write(<span class="hljs-string">"Hello"</span>, os, <span class="hljs-string">"UTF-8"</span>);
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// å…³é—­å¤šä¸ªæµ</span>
 Â  Â  Â  Â  Â  Â IOUtils.closeQuietly(is, os); Â <span class="hljs-comment">// é™é»˜å…³é—­ï¼Œä¸æŠ›å¼‚å¸¸</span>
 Â  Â  Â  Â  Â  Â 
 Â  Â  Â  Â  Â  Â <span class="hljs-comment">// 3. èµ„æºå¤åˆ¶ï¼ˆè‡ªåŠ¨å…³é—­ï¼‰</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">try</span> (<span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"a.txt"</span>);
 Â  Â  Â  Â  Â  Â  Â  Â  <span class="hljs-type">OutputStream</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"b.txt"</span>)) {
 Â  Â  Â  Â  Â  Â  Â  Â IOUtils.copy(in, out);
 Â  Â  Â  Â  Â   }
 Â  Â  Â   }
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 3. FilenameUtils - æ–‡ä»¶åå¤„ç†</span>
 Â  Â  Â  Â <span class="hljs-type">String</span> <span class="hljs-variable">filename</span> <span class="hljs-operator">=</span> <span class="hljs-string">"C:/test/file.txt"</span>;
 Â  Â  Â  Â 
 Â  Â  Â  Â System.out.println(<span class="hljs-string">"æ‰©å±•å: "</span> + FilenameUtils.getExtension(filename));
 Â  Â  Â  Â System.out.println(<span class="hljs-string">"æ–‡ä»¶åï¼ˆæ— æ‰©å±•åï¼‰: "</span> + FilenameUtils.getBaseName(filename));
 Â  Â  Â  Â System.out.println(<span class="hljs-string">"å®Œæ•´æ–‡ä»¶å: "</span> + FilenameUtils.getName(filename));
 Â  Â  Â  Â System.out.println(<span class="hljs-string">"è·¯å¾„: "</span> + FilenameUtils.getFullPath(filename));
 Â  Â  Â  Â System.out.println(<span class="hljs-string">"è§„èŒƒè·¯å¾„: "</span> + FilenameUtils.normalize(filename));
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// è·¯å¾„æ¯”è¾ƒ</span>
 Â  Â  Â  Â <span class="hljs-type">boolean</span> <span class="hljs-variable">same</span> <span class="hljs-operator">=</span> FilenameUtils.equals(
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"C:/test/../test/file.txt"</span>, 
 Â  Â  Â  Â  Â  Â <span class="hljs-string">"C:/test/file.txt"</span>); Â <span class="hljs-comment">// true</span>
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 4. FileSystemUtils - æ–‡ä»¶ç³»ç»Ÿå·¥å…·</span>
 Â  Â  Â  Â <span class="hljs-type">long</span> <span class="hljs-variable">freeSpace</span> <span class="hljs-operator">=</span> FileSystemUtils.freeSpaceKb(<span class="hljs-string">"C:"</span>);
 Â  Â  Â  Â System.out.println(<span class="hljs-string">"Cç›˜å‰©ä½™ç©ºé—´: "</span> + freeSpace + <span class="hljs-string">"KB"</span>);
 Â  Â  Â  Â 
 Â  Â  Â  Â <span class="hljs-comment">// 5. ç›‘æ§æ–‡ä»¶å˜åŒ–</span>
 Â  Â  Â  Â <span class="hljs-comment">// FileAlterationMonitor monitor = new FileAlterationMonitor(1000);</span>
 Â  Â  Â  Â <span class="hljs-comment">// FileAlterationObserver observer = new FileAlterationObserver("watchDir");</span>
 Â  Â  Â  Â <span class="hljs-comment">// observer.addListener(new FileAlterationListenerAdaptor() {</span>
 Â  Â  Â  Â <span class="hljs-comment">// Â  Â  public void onFileCreate(File file) {</span>
 Â  Â  Â  Â <span class="hljs-comment">// Â  Â  Â  Â  System.out.println("åˆ›å»º: " + file.getName());</span>
 Â  Â  Â  Â <span class="hljs-comment">// Â  Â  }</span>
 Â  Â  Â  Â <span class="hljs-comment">// });</span>
 Â  Â  Â  Â <span class="hljs-comment">// monitor.addObserver(observer);</span>
 Â  Â  Â  Â <span class="hljs-comment">// monitor.start();</span>
 Â   }
}
</code></pre>
<h3 data-id="heading-23">ğŸ¯ æœ€ä½³å®è·µæ€»ç»“</h3>
<h4 data-id="heading-24"><strong>1. é€‰æ‹©æ­£ç¡®çš„æµç±»å‹</strong></h4>






























<table><thead><tr><th>åœºæ™¯</th><th>æ¨èæµ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æ–‡æœ¬æ–‡ä»¶</td><td>FileReader/FileWriter</td><td>å­—ç¬¦æµå¤„ç†æ–‡æœ¬æ›´åˆé€‚</td></tr><tr><td>äºŒè¿›åˆ¶æ–‡ä»¶</td><td>FileInputStream/FileOutputStream</td><td>å›¾ç‰‡ã€è§†é¢‘ç­‰ç”¨å­—èŠ‚æµ</td></tr><tr><td>éœ€è¦é«˜æ•ˆ</td><td>BufferedXXX</td><td>æ€»æ˜¯ä½¿ç”¨ç¼“å†²æµæå‡æ€§èƒ½</td></tr><tr><td>ç½‘ç»œä¼ è¾“</td><td>å­—èŠ‚æµ</td><td>ç½‘ç»œä¼ è¾“éƒ½æ˜¯å­—èŠ‚</td></tr></tbody></table>
<h4 data-id="heading-25"><strong>2. èµ„æºç®¡ç†è§„èŒƒ</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// âŒ é”™è¯¯ï¼šå¿˜è®°å…³é—­æµ</span>
<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"file.txt"</span>);
<span class="hljs-comment">// å¤„ç†æ•°æ®...</span>
<span class="hljs-comment">// fis.close();  // å¿˜è®°è°ƒç”¨</span>
â€‹
<span class="hljs-comment">// âœ… æ­£ç¡®1ï¼štry-with-resourcesï¼ˆJava 7+ï¼‰</span>
<span class="hljs-keyword">try</span> (<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"file.txt"</span>);
 Â  Â  <span class="hljs-type">FileOutputStream</span> <span class="hljs-variable">fos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"output.txt"</span>)) {
 Â  Â <span class="hljs-comment">// è‡ªåŠ¨å…³é—­</span>
}
â€‹
<span class="hljs-comment">// âœ… æ­£ç¡®2ï¼šä¼ ç»Ÿtry-catch-finally</span>
<span class="hljs-type">FileInputStream</span> <span class="hljs-variable">fis</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;
<span class="hljs-keyword">try</span> {
 Â  Â fis = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"file.txt"</span>);
 Â  Â <span class="hljs-comment">// å¤„ç†æ•°æ®</span>
} <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â e.printStackTrace();
} <span class="hljs-keyword">finally</span> {
 Â  Â <span class="hljs-keyword">if</span> (fis != <span class="hljs-literal">null</span>) {
 Â  Â  Â  Â <span class="hljs-keyword">try</span> {
 Â  Â  Â  Â  Â  Â fis.close();
 Â  Â  Â   } <span class="hljs-keyword">catch</span> (IOException e) {
 Â  Â  Â  Â  Â  Â e.printStackTrace();
 Â  Â  Â   }
 Â   }
}
</code></pre>
<h4 data-id="heading-26"><strong>3. æ€§èƒ½ä¼˜åŒ–å»ºè®®</strong></h4>
<pre><code class="hljs language-ini" lang="ini">// ç¼“å†²åŒºå¤§å°é€‰æ‹©ï¼ˆç»éªŒå€¼ï¼‰
byte<span class="hljs-section">[]</span> <span class="hljs-attr">buffer</span> = new byte[<span class="hljs-number">8192</span>]<span class="hljs-comment">; Â // 8KB - é€‚åˆå¤§å¤šæ•°åœºæ™¯</span>
// æˆ–
char<span class="hljs-section">[]</span> <span class="hljs-attr">charBuffer</span> = new char[<span class="hljs-number">8192</span>]<span class="hljs-comment">;</span>
â€‹
// æ‰¹é‡æ“ä½œä¼˜äºå•å­—èŠ‚æ“ä½œ
while ((<span class="hljs-attr">len</span> = input.read(buffer)) != -<span class="hljs-number">1</span>) {
 Â  Â output.write(buffer, 0, len)<span class="hljs-comment">; Â // æ‰¹é‡å†™å…¥</span>
}
â€‹
// ä½¿ç”¨NIOï¼ˆå¤§æ–‡ä»¶æˆ–é«˜å¹¶å‘ï¼‰
Path <span class="hljs-attr">source</span> = Paths.get(<span class="hljs-string">"largefile.iso"</span>)<span class="hljs-comment">;</span>
Path <span class="hljs-attr">target</span> = Paths.get(<span class="hljs-string">"copy.iso"</span>)<span class="hljs-comment">;</span>
Files.copy(source, target, StandardCopyOption.REPLACE_EXISTING)<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-27"><strong>4. ç¼–ç å¤„ç†é»„é‡‘æ³•åˆ™</strong></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åŸåˆ™ï¼šç¼–ç è§£ç å¿…é¡»ä¸€è‡´</span>
<span class="hljs-type">String</span> <span class="hljs-variable">text</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ä½ å¥½ä¸–ç•Œ"</span>;
â€‹
<span class="hljs-comment">// ä¿å­˜æ—¶æŒ‡å®šç¼–ç </span>
<span class="hljs-keyword">try</span> (<span class="hljs-type">OutputStreamWriter</span> <span class="hljs-variable">osw</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OutputStreamWriter</span>(
 Â  Â  Â  Â <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">"file.txt"</span>), StandardCharsets.UTF_8)) {
 Â  Â osw.write(text);
}
â€‹
<span class="hljs-comment">// è¯»å–æ—¶ä½¿ç”¨ç›¸åŒç¼–ç </span>
<span class="hljs-keyword">try</span> (<span class="hljs-type">InputStreamReader</span> <span class="hljs-variable">isr</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(
 Â  Â  Â  Â <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">"file.txt"</span>), StandardCharsets.UTF_8)) {
 Â  Â <span class="hljs-comment">// è¯»å–...</span>
}
â€‹
<span class="hljs-comment">// ç½‘é¡µå¤„ç†ä½¿ç”¨UTF-8</span>
response.setCharacterEncoding(<span class="hljs-string">"UTF-8"</span>);
request.setCharacterEncoding(<span class="hljs-string">"UTF-8"</span>);
</code></pre>
<h3 data-id="heading-28">ğŸš€ å¿«é€Ÿå‚è€ƒå¡</h3>






















































<table><thead><tr><th>æ“ä½œ</th><th>å­—èŠ‚æµ</th><th>å­—ç¬¦æµ</th><th>ç¼“å†²æµ</th><th>Commons IO</th></tr></thead><tbody><tr><td><strong>è¯»å–æ–‡ä»¶</strong></td><td><code>FileInputStream</code></td><td><code>FileReader</code></td><td><code>BufferedReader</code></td><td><code>FileUtils.readFileToString()</code></td></tr><tr><td><strong>å†™å…¥æ–‡ä»¶</strong></td><td><code>FileOutputStream</code></td><td><code>FileWriter</code></td><td><code>BufferedWriter</code></td><td><code>FileUtils.writeStringToFile()</code></td></tr><tr><td><strong>å¤åˆ¶æ–‡ä»¶</strong></td><td>æ‰‹åŠ¨å¾ªç¯</td><td>æ‰‹åŠ¨å¾ªç¯</td><td>ç¼“å†²+æ•°ç»„</td><td><code>FileUtils.copyFile()</code></td></tr><tr><td><strong>è¯»å–è¡Œ</strong></td><td>N/A</td><td><code>readLine()</code></td><td><code>BufferedReader.readLine()</code></td><td><code>FileUtils.readLines()</code></td></tr><tr><td><strong>å¤„ç†ç¼–ç </strong></td><td>å­—èŠ‚æ•°ç»„+String</td><td><code>InputStreamReader</code></td><td>æŒ‡å®šCharset</td><td>è‡ªåŠ¨UTF-8</td></tr><tr><td><strong>å…³é—­èµ„æº</strong></td><td>try-with-resources</td><td>try-with-resources</td><td>try-with-resources</td><td>è‡ªåŠ¨ç®¡ç†</td></tr></tbody></table>
<h3 data-id="heading-29">ğŸ“ å¸¸è§é—®é¢˜è§£ç­”</h3>
<p><strong>Q: å­—èŠ‚æµå’Œå­—ç¬¦æµæ€ä¹ˆé€‰æ‹©ï¼Ÿ</strong> A: æ–‡æœ¬ç”¨å­—ç¬¦æµï¼ˆReader/Writerï¼‰ï¼ŒäºŒè¿›åˆ¶æ•°æ®ç”¨å­—èŠ‚æµï¼ˆInputStream/OutputStreamï¼‰</p>
<p><strong>Q: ä¸ºä»€ä¹ˆç”¨ç¼“å†²æµï¼Ÿ</strong> A: å‡å°‘ç‰©ç†è¯»å†™æ¬¡æ•°ï¼Œæå‡æ€§èƒ½å‡ ååˆ°å‡ ç™¾å€ï¼</p>
<p><strong>Q: å¦‚ä½•å¤„ç†å¤§æ–‡ä»¶ï¼Ÿ</strong> A: ä½¿ç”¨ç¼“å†²æµ+é€‚å½“ç¼“å†²åŒºï¼Œæˆ–è€ƒè™‘NIOçš„FileChannel</p>
<p><strong>Q: ä¸­æ–‡ä¹±ç æ€ä¹ˆè§£å†³ï¼Ÿ</strong> A: ç¡®ä¿ç¼–ç ä¸€è‡´ï¼Œæ¨èç»Ÿä¸€ä½¿ç”¨UTF-8</p>
<p><strong>Q: æµä¸ºä»€ä¹ˆè¦å…³é—­ï¼Ÿ</strong> A: é‡Šæ”¾ç³»ç»Ÿèµ„æºï¼Œé¿å…å†…å­˜æ³„æ¼å’Œæ–‡ä»¶é”å®š</p>
<p>å¸Œæœ›è¿™ç¯‡å…¨é¢çš„IOæµæŒ‡å—èƒ½å¸®åŠ©ä½ ï¼ç¼–ç¨‹æ„‰å¿«ï¼ ğŸš€ğŸ’»</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringAIå¿«é€Ÿä¸Šæ‰‹æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7595858353660461090</link>    <guid>https://juejin.cn/post/7595858353660461090</guid>    <pubDate>2026-01-17T04:09:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858353660461090" data-draft-id="7592803747471917106" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringAIå¿«é€Ÿä¸Šæ‰‹æ•™ç¨‹"/> <meta itemprop="keywords" content="Spring Boot"/> <meta itemprop="datePublished" content="2026-01-17T04:09:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="devlogix01"/> <meta itemprop="url" content="https://juejin.cn/user/2701937351075513"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringAIå¿«é€Ÿä¸Šæ‰‹æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2701937351075513/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    devlogix01
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T04:09:26.000Z" title="Sat Jan 17 2026 04:09:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="github">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">01-SpringAIçš„ä»‹ç»</h2>
<p><strong>Spring AI</strong> æ˜¯ç”± VMware / Spring å›¢é˜Ÿæ¨å‡ºçš„ä¸€ä¸ª <strong>é¢å‘ AI çš„ Spring å®˜æ–¹é¡¹ç›®</strong>ï¼Œç›®æ ‡æ˜¯è®© Java / Spring å¼€å‘è€… <strong>åƒç”¨ Spring Dataã€Spring Security ä¸€æ ·ï¼Œç”¨ç»Ÿä¸€ã€è§„èŒƒçš„æ–¹å¼æ¥å…¥å¤§æ¨¡å‹ï¼ˆLLMï¼‰å’Œ AI èƒ½åŠ›</strong>ã€‚</p>
<p>ä¸€å¥è¯ç†è§£ï¼š   <strong>Spring AI = ç»™å¤§æ¨¡å‹ç”¨çš„ Spring Framework</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2507e2c2e46c49b79270824041199b65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGV2bG9naXgwMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769227766&amp;x-signature=RJR3F8qFwIUmcNM3adlsHCs%2FBtc%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">02-åˆ›å»ºé¡¹ç›®è¿œç¨‹è°ƒç”¨deepseekå¤§æ¨¡å‹</h2>
<p>1 åˆ›å»ºé¡¹ç›®
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/965c31c9ed9e4a86ae39a3193d383331~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGV2bG9naXgwMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769227766&amp;x-signature=rH14fobITTqfAWHXT2DNiyHBPXM%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-2">Releases - Use Maven Central</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!-- Maven Central is included by default in Maven builds.
     You usually donâ€™t need to configure it explicitly,
     but it's shown here for clarity. --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>central<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.maven.apache.org/maven2<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
</code></pre>
<h4 data-id="heading-3">Snapshots - Add Snapshot Repositories</h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">repositories</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>spring-snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Spring Snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">releases</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">releases</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">repository</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>Central Portal Snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>central-portal-snapshots<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">url</span>&gt;</span>https://central.sonatype.com/repository/maven-snapshots/<span class="hljs-tag">&lt;/<span class="hljs-name">url</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">releases</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>false<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">releases</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">snapshots</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">enabled</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">enabled</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">snapshots</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">repository</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">repositories</span>&gt;</span>
</code></pre>
<p>deepseek dependency</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-model-deepseek<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>ChatController.java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.controller;

<span class="hljs-keyword">import</span> org.springframework.ai.chat.messages.UserMessage;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.model.ChatResponse;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.prompt.Prompt;
<span class="hljs-keyword">import</span> org.springframework.ai.deepseek.DeepSeekChatModel;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
<span class="hljs-keyword">import</span> reactor.core.publisher.Flux;
<span class="hljs-keyword">import</span> java.util.Map;

<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DeepSeekChatModel chatModel;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatController</span><span class="hljs-params">(DeepSeekChatModel chatModel)</span> {
        <span class="hljs-built_in">this</span>.chatModel = chatModel;
    }

    <span class="hljs-meta">@GetMapping("/ai/generate")</span>
    <span class="hljs-keyword">public</span> Map <span class="hljs-title function_">generate</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message)</span> {
        <span class="hljs-keyword">return</span> Map.of(<span class="hljs-string">"generation"</span>, chatModel.call(message));
    }

    <span class="hljs-meta">@GetMapping(value = "/ai/generateStream", produces = "text/html; charset=UTF-8")</span>
    <span class="hljs-keyword">public</span> Flux&lt;String&gt; <span class="hljs-title function_">generateStream</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message)</span> {
        <span class="hljs-type">var</span> <span class="hljs-variable">prompt</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Prompt</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserMessage</span>(message));
        <span class="hljs-keyword">return</span> chatModel.stream(prompt).map(ChatResponse -&gt; ChatResponse.getResult().getOutput().getText());
    }
}
</code></pre>
<p>æµ‹è¯•æ¥å£</p>
<p><code>http://localhost:8080/ai/generateStream?message=è®²ä¸ªç¬‘è¯</code></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e6c48a8cd86749f691ebad3c1f8ec7ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGV2bG9naXgwMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769227766&amp;x-signature=gqVLCi4%2FnL3FrmPh9per90nFLxk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">03-SpringAIè°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹ollama</h2>
<p>1 å¼•å…¥ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
   <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-model-ollama<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>2 é…ç½®yml</p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-comment"># In application.yml</span>
<span class="hljs-attr">server:</span>
  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span>
  <span class="hljs-attr">error:</span>
    <span class="hljs-attr">include-message:</span> <span class="hljs-string">always</span>
    <span class="hljs-attr">include-binding-errors:</span> <span class="hljs-string">always</span>
    <span class="hljs-attr">include-stacktrace:</span> <span class="hljs-string">on_param</span>
    <span class="hljs-attr">include-exception:</span> <span class="hljs-literal">false</span>

<span class="hljs-attr">spring:</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">deepseek:</span>
      <span class="hljs-attr">api-key:</span> <span class="hljs-string">sk-7fee8ebd8c0744ac9c1d91d9f0d81372</span>
    <span class="hljs-attr">ollama:</span>
      <span class="hljs-attr">chat:</span>
        <span class="hljs-attr">model:</span> <span class="hljs-string">deepseek-r1-1.5b</span>
</code></pre>
<p>3 chatController.java è°ƒç”¨æœ¬åœ°ollamaçš„å¤§æ¨¡å‹</p>
<pre><code class="hljs language-typescript" lang="typescript">package org.<span class="hljs-property">example</span>.<span class="hljs-property">springaidemo</span>.<span class="hljs-property">controller</span>;

<span class="hljs-keyword">import</span> jakarta.<span class="hljs-property">annotation</span>.<span class="hljs-property">Resource</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">ai</span>.<span class="hljs-property">chat</span>.<span class="hljs-property">messages</span>.<span class="hljs-property">UserMessage</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">ai</span>.<span class="hljs-property">chat</span>.<span class="hljs-property">prompt</span>.<span class="hljs-property">Prompt</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">ai</span>.<span class="hljs-property">ollama</span>.<span class="hljs-property">OllamaChatModel</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">web</span>.<span class="hljs-property">bind</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">GetMapping</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">web</span>.<span class="hljs-property">bind</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">RequestParam</span>;
<span class="hljs-keyword">import</span> org.<span class="hljs-property">springframework</span>.<span class="hljs-property">web</span>.<span class="hljs-property">bind</span>.<span class="hljs-property">annotation</span>.<span class="hljs-property">RestController</span>;
<span class="hljs-keyword">import</span> reactor.<span class="hljs-property">core</span>.<span class="hljs-property">publisher</span>.<span class="hljs-property">Flux</span>;
<span class="hljs-keyword">import</span> java.<span class="hljs-property">util</span>.<span class="hljs-property">Map</span>;

<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">OllamaChatModel</span> chatModel;


    <span class="hljs-meta">@GetMapping</span>(<span class="hljs-string">"/ai/generate"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Map</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params"><span class="hljs-meta">@RequestParam</span>(value = <span class="hljs-string">"message"</span>, defaultValue = <span class="hljs-string">"Tell me a joke"</span>) <span class="hljs-built_in">String</span> message</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Map</span>.<span class="hljs-title function_">of</span>(<span class="hljs-string">"generation"</span>, chatModel.<span class="hljs-title function_">call</span>(message));
    }

    <span class="hljs-meta">@GetMapping</span>(value = <span class="hljs-string">"/ai/generateStream"</span>, produces = <span class="hljs-string">"text/html; charset=UTF-8"</span>)
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Flux</span>&lt;<span class="hljs-title class_">String</span>&gt; <span class="hljs-title function_">generateStream</span>(<span class="hljs-params"><span class="hljs-meta">@RequestParam</span>(value = <span class="hljs-string">"message"</span>, defaultValue = <span class="hljs-string">"Tell me a joke"</span>) <span class="hljs-built_in">String</span> message</span>) {
        <span class="hljs-keyword">var</span> prompt = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Prompt</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserMessage</span>(message));
        <span class="hljs-keyword">return</span> chatModel.<span class="hljs-title function_">stream</span>(prompt).<span class="hljs-title function_">map</span>(<span class="hljs-title class_">ChatResponse</span> -&gt; <span class="hljs-title class_">ChatResponse</span>.<span class="hljs-title function_">getResult</span>().<span class="hljs-title function_">getOutput</span>().<span class="hljs-title function_">getText</span>());
    }
}
</code></pre>
<h2 data-id="heading-5">04-SpringAIåˆ›å»ºChatClientç¤ºä¾‹å®ç°AIäººè®¾</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.controller;


<span class="hljs-keyword">import</span> jakarta.annotation.Resource;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.ai.deepseek.DeepSeekChatModel;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
<span class="hljs-keyword">import</span> reactor.core.publisher.Flux;

<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {

    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DeepSeekChatModel chatModel;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatController</span><span class="hljs-params">(DeepSeekChatModel chatModel)</span> {
        <span class="hljs-built_in">this</span>.chatModel = chatModel;
    }


    <span class="hljs-meta">@GetMapping("/ai/generate")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">generate</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message)</span> {
        <span class="hljs-keyword">return</span>  chatClient.prompt(<span class="hljs-string">"ä½ æ˜¯aiåŠ©æ‰‹å°é»‘"</span>).user( message).call().content();

    }

    <span class="hljs-meta">@GetMapping(value = "/ai/generateStream", produces = "text/html; charset=UTF-8")</span>
    <span class="hljs-keyword">public</span> Flux&lt;String&gt; <span class="hljs-title function_">generateStream</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message)</span> {
        <span class="hljs-keyword">return</span>  chatClient.prompt(<span class="hljs-string">"ä½ æ˜¯aiåŠ©æ‰‹å°é»‘"</span>).user( message).stream().content();
    }
}
</code></pre>
<p>æµ‹è¯•
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2fba5ef9c07643e092b3c0b3eac6e9b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGV2bG9naXgwMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769227766&amp;x-signature=qpk%2B%2BBl4Y6EATRXcZBUV%2Bh4Fws0%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">05-SpringAIå®ç°è®°å½•ä¸Šä¸‹æ–‡</h2>
<p><strong>1 åˆ›å»ºæ•°æ®åº“</strong></p>
<p>æ‰“å¼€ navicat è¿›è¡Œåˆ›å»º</p>
<p>æ•°æ®åº“çš„åç§°å°±å«</p>
<p>20260110-ai</p>
<p>å­—ç¬¦é›†ç¼–ç é€‰æ‹©ä¸º utf8mb4</p>
<p>åˆ›å»ºæˆåŠŸ</p>
<p>ç‚¹å‡» æŸ¥è¯¢çš„é€‰é¡¹</p>
<p>ç„¶åæŠŠèŠå¤©è®°å½•è¡¨çš„ sql è¯­å¥ç»™å¤åˆ¶ç²˜è´´è¿›æ¥</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `sys_history` (
  `id` <span class="hljs-type">bigint</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="hljs-string">'åºåˆ—å·'</span>,
  `datetime` datetime <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'èŠå¤©æ—¶é—´'</span>,
  `content` longtext <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_unicode_ci COMMENT <span class="hljs-string">'èŠå¤©å†…å®¹'</span>,
  `role` <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-type">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_unicode_ci <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">'user'</span> COMMENT <span class="hljs-string">'è§’è‰²'</span>,
  `sessionId` <span class="hljs-type">bigint</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'ä¼šè¯Id'</span>,
  <span class="hljs-keyword">PRIMARY</span> KEY (`id`) <span class="hljs-keyword">USING</span> BTREE
) ENGINE<span class="hljs-operator">=</span>InnoDB AUTO_INCREMENT<span class="hljs-operator">=</span><span class="hljs-number">227</span> <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4 <span class="hljs-keyword">COLLATE</span><span class="hljs-operator">=</span>utf8mb4_unicode_ci ROW_FORMAT<span class="hljs-operator">=</span><span class="hljs-keyword">DYNAMIC</span> COMMENT<span class="hljs-operator">=</span><span class="hljs-string">'èŠå¤©è®°å½•'</span>;
</code></pre>
<p><strong>2 å¯¼å…¥ä¾èµ–åæ ‡</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-comment">&lt;!--Mysqlé©±åŠ¨        --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.3.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-comment">&lt;!--  Mybatisâ€”â€”Plus æ’ä»¶    --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-jsqlparser<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-comment">&lt;!--  Mybatisâ€”â€”Plus     --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-spring-boot3-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><strong>3 é…ç½®æ•°æ®æº</strong></p>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-attr">datasource:</span>
  <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span>
  <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://localhost:3306/20260110-ai?allowPublicKeyRetrieval=true&amp;useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai</span>
  <span class="hljs-attr">username:</span> <span class="hljs-string">root</span>
  <span class="hljs-attr">password:</span> <span class="hljs-string">root</span>
</code></pre>
<p><strong>4 é…ç½®å…¶ä»–æ–‡ä»¶å¤¹</strong></p>
<p>config/AiConfig.java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.entity.impl;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;

<span class="hljs-keyword">import</span> org.example.springaidemo.entity.History;
<span class="hljs-keyword">import</span> org.example.springaidemo.mapper.HistoryMapper;
<span class="hljs-keyword">import</span> org.example.springaidemo.service.HistoryService;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;



<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HistoryServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ServiceImpl</span>&lt;HistoryMapper, History&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HistoryService</span> {

}
</code></pre>
<p>config/MybatisPlusConfig.java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.config;


<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;

<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.mybatis.spring.annotation.MapperScan;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;

<span class="hljs-meta">@Configuration</span>

<span class="hljs-meta">@MapperScan("org.example.springaidemo.mapper")</span>
<span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisPlusConfig</span> {
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> MybatisPlusInterceptor <span class="hljs-title function_">mybatisPlusInterceptor</span><span class="hljs-params">()</span> {
        <span class="hljs-type">MybatisPlusInterceptor</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MybatisPlusInterceptor</span>();
        <span class="hljs-keyword">return</span> interceptor;
    }
}
</code></pre>
<p>entity/History.java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.entity;


<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;
<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;
<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;
<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.annotation.JsonFormat;
<span class="hljs-keyword">import</span> io.swagger.v3.oas.annotations.media.Schema;
<span class="hljs-keyword">import</span> lombok.AllArgsConstructor;
<span class="hljs-keyword">import</span> lombok.Builder;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> lombok.NoArgsConstructor;

<span class="hljs-keyword">import</span> java.io.Serializable;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;


<span class="hljs-comment">/**
 * èŠå¤©è®°å½•å®ä½“ç±»
 */</span>

<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@Builder(toBuilder = true)</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-meta">@NoArgsConstructor</span>
<span class="hljs-meta">@TableName("sys_history")</span>

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">History</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;

    <span class="hljs-meta">@TableId(value = "id", type = IdType.AUTO)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Schema(title = "èŠå¤©æ—¶é—´")</span>
    <span class="hljs-meta">@TableField("datetime")</span>

    <span class="hljs-meta">@JsonFormat( pattern = "yyyy-MM-dd HH:mm:ss")</span>
    <span class="hljs-keyword">private</span> LocalDateTime datetime;
    <span class="hljs-meta">@Schema(title = "èŠå¤©å†…å®¹")</span>
    <span class="hljs-meta">@TableField("content")</span>

    <span class="hljs-keyword">private</span> String content;
    <span class="hljs-meta">@Schema(title = "è§’è‰²")</span>
    <span class="hljs-meta">@TableField("role")</span>

    <span class="hljs-keyword">private</span> String role;
    <span class="hljs-meta">@Schema(title = "ä¼šè¯Id")</span>
    <span class="hljs-meta">@TableField("sessionId")</span>

    <span class="hljs-keyword">private</span> Long sessionId;
}
</code></pre>
<p>service/HistoryService.java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.service;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;
<span class="hljs-keyword">import</span> org.example.springaidemo.entity.History;


<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">HistoryService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IService</span>&lt;History&gt; {

}
</code></pre>
<p>service/impl/HistoryServiceImpl.java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.service.impl;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;

<span class="hljs-keyword">import</span> org.example.springaidemo.entity.History;
<span class="hljs-keyword">import</span> org.example.springaidemo.mapper.HistoryMapper;
<span class="hljs-keyword">import</span> org.example.springaidemo.service.HistoryService;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;



<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HistoryServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ServiceImpl</span>&lt;HistoryMapper, History&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">HistoryService</span> {

}
</code></pre>
<p>mapper/HistoryMapper.java</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.mapper;

<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;
<span class="hljs-keyword">import</span> org.apache.ibatis.annotations.Mapper;
<span class="hljs-keyword">import</span> org.example.springaidemo.entity.History;


<span class="hljs-meta">@Mapper</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">HistoryMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;History&gt; {

}
</code></pre>
<p>æ›´æ–°chatController.java</p>
<p>ä½¿ç”¨MyBatis-Plusè¿›è¡Œæ•°æ®åº“æ“ä½œ</p>
<p>Spring AIæ¡†æ¶çš„å„ç§ç»„ä»¶ï¼ˆChatClientã€æ¶ˆæ¯ç±»å‹ç­‰ï¼‰</p>
<p>DeepSeekå’ŒOllamaä¸¤ä¸ªAIæ¨¡å‹ï¼ˆè™½ç„¶å¯¼å…¥äº†Ollamaä½†æœªä½¿ç”¨ï¼‰</p>
<p>å“åº”å¼ç¼–ç¨‹åº“Reactorçš„Flux</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.controller;


<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
<span class="hljs-keyword">import</span> jakarta.annotation.Resource;
<span class="hljs-keyword">import</span> org.example.springaidemo.entity.History;
<span class="hljs-keyword">import</span> org.example.springaidemo.service.HistoryService;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.messages.AssistantMessage;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.messages.Message;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.messages.UserMessage;
<span class="hljs-keyword">import</span> org.springframework.ai.deepseek.DeepSeekChatModel;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
<span class="hljs-keyword">import</span> reactor.core.publisher.Flux;

<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.stream.Collectors;

<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {
    <span class="hljs-comment">//ä¾èµ–æ³¨å…¥</span>
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DeepSeekChatModel chatModel;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> HistoryService historyService;

    <span class="hljs-comment">//æ„é€ å‡½æ•°æ³¨å…¥</span>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatController</span><span class="hljs-params">(DeepSeekChatModel chatModel)</span> {
        <span class="hljs-built_in">this</span>.chatModel = chatModel;
    }

    <span class="hljs-comment">/*
    * HTTP GETç«¯ç‚¹ï¼š/ai/generate
    æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º"Tell me a joke"
    è¿”å›AIåŠ©æ‰‹"å°é»‘"å¯¹ç”¨æˆ·æ¶ˆæ¯çš„åŒæ­¥å“åº”å†…å®¹
    * */</span>
    <span class="hljs-meta">@GetMapping("/ai/generate")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">generate</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message)</span> {
        <span class="hljs-keyword">return</span>  chatClient.prompt(<span class="hljs-string">"ä½ æ˜¯aiåŠ©æ‰‹å°é»‘"</span>).user( message).call().content();

    }

    <span class="hljs-meta">@GetMapping(value = "/ai/generateStream", produces = "text/html; charset=UTF-8")</span>
    <span class="hljs-keyword">public</span> Flux&lt;String&gt; <span class="hljs-title function_">generateStream</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message,
                                       <span class="hljs-meta">@RequestParam(value = "sessionId", defaultValue = " 1 ")</span> <span class="hljs-type">long</span> sessionId
                                       )</span> {
        <span class="hljs-comment">//ç”¨æˆ·æ¶ˆæ¯ä¿å­˜</span>
        <span class="hljs-type">History</span> <span class="hljs-variable">userhistory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">History</span>();
        userhistory.setDatetime(LocalDateTime.now());
        userhistory.setRole(<span class="hljs-string">"user"</span>);
        userhistory.setContent(message);
        userhistory.setSessionId(sessionId);
        historyService.save(userhistory); <span class="hljs-comment">//åˆ›å»ºå¹¶ä¿å­˜ç”¨æˆ·å‘é€çš„æ¶ˆæ¯åˆ°æ•°æ®åº“</span>

        <span class="hljs-comment">//è·å–å†å²å¯¹è¯</span>
        <span class="hljs-comment">//æŸ¥è¯¢æŒ‡å®šä¼šè¯IDçš„æ‰€æœ‰å†å²è®°å½•</span>
        <span class="hljs-comment">//æ’é™¤åˆšåˆšä¿å­˜çš„å½“å‰ç”¨æˆ·æ¶ˆæ¯ï¼ˆé¿å…é‡å¤ï¼‰</span>
        List&lt;History&gt; histories = historyService.list(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;History&gt;().eq(History::getSessionId, sessionId).ne(History::getId , userhistory.getId())
        ) ;

        <span class="hljs-comment">//è½¬æ¢å†å²æ¶ˆæ¯æ ¼å¼: å°†å†å²è®°å½•è½¬æ¢ä¸ºAIæ¨¡å‹èƒ½ç†è§£çš„æ¶ˆæ¯æ ¼å¼</span>
        List&lt;Message&gt; messages = histories.stream().map(history -&gt;
                <span class="hljs-string">"user"</span>.equals(history.getRole())?<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserMessage</span>(history.getContent()):<span class="hljs-keyword">new</span> <span class="hljs-title class_">AssistantMessage</span>(history.getContent())).collect(Collectors.toList());

        <span class="hljs-comment">//æ•°ç»„ ç”¨æ¥ç´¯ç§¯AIæµå¼å›å¤å†…å®¹</span>
        <span class="hljs-comment">//ä½¿ç”¨æ•°ç»„æ˜¯ä¸ºäº†åœ¨lambdaè¡¨è¾¾å¼ä¸­èƒ½å¤Ÿä¿®æ”¹å˜é‡</span>
        StringBuilder[] builder = {<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>()};

        <span class="hljs-comment">//æ„å»ºåŒ…å«ä¸Šä¸‹æ–‡çš„AIè¯·æ±‚å¹¶è¿”å›æµå¼å“åº”</span>
        Flux&lt;String&gt; stream = chatClient.prompt(<span class="hljs-string">"ä½ æ˜¯aiåŠ©æ‰‹å°é»‘"</span>).user( message).messages( messages).stream().content();
        <span class="hljs-keyword">return</span>  stream.doOnNext(s -&gt; builder[<span class="hljs-number">0</span>].append(s)) <span class="hljs-comment">//å½“AIè¿”å›æ¯ä¸ªç‰‡æ®µæ—¶ï¼Œå°†å…¶è¿½åŠ åˆ°builderä¸­è¿›è¡Œç´¯ç§¯</span>
                .doOnComplete(() -&gt; {
                    <span class="hljs-type">History</span> <span class="hljs-variable">aihistory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">History</span>();
                    aihistory.setId(<span class="hljs-literal">null</span>);
                    aihistory.setDatetime(LocalDateTime.now());
                    aihistory.setRole(<span class="hljs-string">"assistant"</span>);
                    aihistory.setContent(builder[<span class="hljs-number">0</span>].toString());
                    aihistory.setSessionId(sessionId);
                    historyService.save(aihistory);
                });
        <span class="hljs-comment">/*
        å½“AIæµå¼å›å¤å®Œæˆåï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
        åˆ›å»ºæ–°çš„å†å²è®°å½•å¯¹è±¡
        è®¾ç½®æ—¶é—´æˆ³
        è®¾ç½®è§’è‰²ä¸º"assistant"
        å°†ç´¯ç§¯çš„å®Œæ•´å›å¤å†…å®¹ä¿å­˜
        è®¾ç½®ä¼šè¯ID
        ä¿å­˜åˆ°æ•°æ®åº“
        è¿™ç§æ–¹å¼ç¡®ä¿äº†åªæœ‰åœ¨AIå®Œå…¨ç”Ÿæˆå›å¤åï¼Œæ‰ä¼šå°†å…¶ä¿å­˜åˆ°å†å²è®°å½•ä¸­ï¼ŒåŒæ—¶ä¿æŒäº†æµå¼å“åº”çš„å®æ—¶æ€§*/</span>
    }
}
</code></pre>
<h2 data-id="heading-7">06-è¯­ä¹‰å‘é‡åŒ–ã€å‘é‡æ•°æ®åº“ã€RAGçš„æ¦‚å¿µ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e243d5d55b42430fb96499a218aa2fbd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGV2bG9naXgwMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769227766&amp;x-signature=xIm672r%2F7cPLR6YDpRUqTuZhokk%3D" alt="image.png" loading="lazy"/></p>
<h4 data-id="heading-8">1 RAG æ£€ç´¢å¢å¼ºç”Ÿæˆ Retrieval Augmented Generated</h4>
<p>æ–‡æœ¬è¯»å– - æ–‡æœ¬åˆ†å‰² - è½¬å‘é‡åŒ– - å­˜å‘é‡æ•°æ®åº“
ç”¨æˆ·é—®é¢˜ - å‘é‡åŒ– - æ£€ç´¢ç›¸å…³å†…å®¹ - æ„é€ prompt - å¤§æ¨¡å‹ç”Ÿæˆç­”æ¡ˆ</p>
<h2 data-id="heading-9">07-SpringAIå®ç°è¯­ä¹‰å‘é‡åŒ–</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.spring.io%2Fspring-ai%2Freference%2Fapi%2Fembeddings.html" target="_blank" title="https://docs.spring.io/spring-ai/reference/api/embeddings.html" ref="nofollow noopener noreferrer">docs.spring.io/spring-ai/râ€¦</a></p>
<p>å¯¼å…¥çš„ä¾èµ–</p>
<pre><code class="hljs language-java" lang="java">        &lt;dependency&gt;
            &lt;groupId&gt;com.alibaba.cloud.ai&lt;/groupId&gt;
            &lt;artifactId&gt;spring-ai-alibaba-starter-dashscope&lt;/artifactId&gt;
        &lt;/dependency&gt;
    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.alibaba.cloud.ai&lt;/groupId&gt;
                &lt;artifactId&gt;spring-ai-alibaba-bom&lt;/artifactId&gt;
                &lt;version&gt;<span class="hljs-number">1.0</span><span class="hljs-number">.0</span><span class="hljs-number">.2</span>&lt;/version&gt;
                &lt;type&gt;pom&lt;/type&gt;
                &lt;scope&gt;<span class="hljs-keyword">import</span>&lt;/scope&gt;
            &lt;/dependency&gt;
    &lt;/dependencyManagement&gt;
</code></pre>
<p>é…ç½®ç¤ºä¾‹</p>
<pre><code class="hljs language-yml" lang="yml">    <span class="hljs-attr">ollama:</span>
      <span class="hljs-attr">chat:</span>
        <span class="hljs-attr">model:</span> <span class="hljs-string">deepseek-r1:8b</span>
      <span class="hljs-attr">embedding:</span>
        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">false</span>
    <span class="hljs-attr">dashscope:</span>
      <span class="hljs-attr">api-key:</span> 
      <span class="hljs-attr">embedding:</span>
        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span>
        <span class="hljs-attr">options:</span>
          <span class="hljs-attr">model:</span> <span class="hljs-string">text-embedding-v4</span>
</code></pre>
<p>ç¤ºä¾‹æ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java">   <span class="hljs-meta">@GetMapping("/ai/embedding")</span>
    <span class="hljs-keyword">public</span> Map <span class="hljs-title function_">embed</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message)</span> {
        <span class="hljs-type">EmbeddingResponse</span> <span class="hljs-variable">embeddingResponse</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.embeddingModel.embedForResponse(List.of(message));
        <span class="hljs-keyword">return</span> Map.of(<span class="hljs-string">"embedding"</span>, embeddingResponse);
    }
</code></pre>
<h2 data-id="heading-10">08-SpringAIå®ç°æ–‡æœ¬åˆ†å‰²</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.spring.io%2Fspring-ai%2Freference%2Fapi%2Fetl-pipeline.html" target="_blank" title="https://docs.spring.io/spring-ai/reference/api/etl-pipeline.html" ref="nofollow noopener noreferrer">docs.spring.io/spring-ai/râ€¦</a></p>
<p>å› ä¸ºåœ¨æ—¥å¸¸å·¥ä½œçš„è¿‡ç¨‹ä¸­, æ–‡æœ¬éƒ½æ˜¯ä»¥æ–‡æ¡£çš„å½¢å¼è¿›è¡Œå­˜å‚¨çš„, å¸¸è§çš„æ–‡æ¡£æ ¼å¼æœ‰ txt æ–‡ä»¶ã€markdown æ–‡ä»¶ã€pdf æ–‡ä»¶, éœ€è¦æŠŠè¿™ä¸ªæ–‡æ¡£ç»™è¯»å‡ºæ¥, è¯»å‡ºæ¥æ–‡æ¡£ä»¥åæ‰èƒ½è¿›è¡Œåˆ†å‰², SpringAI ç»™æˆ‘ä»¬å®šä¹‰äº†æ–‡æœ¬è¯»å–çš„è§„èŒƒè§„èŒƒæ¥å£, åŒæ—¶ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¤šç±»å‹çš„æ–‡æœ¬é˜…è¯»å·¥å…· , ä¾‹å¦‚ JSON ç±»å‹çš„ã€txt ç±»å‹çš„ã€MarkDown ç±»å‹çš„ã€PDF ç±»å‹ç­‰</p>
<p>PDF çš„æœ‰ä¸¤ç§è¯»å–æ–¹å¼</p>
<p>ä¸€ç§æ˜¯æŒ‰é¡µè¯»å–</p>
<p>å¦å¤–ä¸€ç§æ˜¯æŒ‰ç« èŠ‚è¯»å–</p>
<p>ä»–ä»¬éƒ½æ˜¯æŒ‰ç…§ SpringAI çš„æ¥å£è¿›è¡Œå®ç°ï¼Œç‰¹åˆ«çš„è§„èŒƒ</p>
<p>1 æ·»åŠ ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-pdf-document-reader<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>2 æµ‹è¯•æ–¹æ³•</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">testPdf</span><span class="hljs-params">()</span>{
    <span class="hljs-type">PagePdfDocumentReader</span> <span class="hljs-variable">pdfReader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PagePdfDocumentReader</span>(<span class="hljs-string">"classpath:/é˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œ(ç»ˆæç‰ˆ).pdf"</span>,
            PdfDocumentReaderConfig.builder()
                    .withPageTopMargin(<span class="hljs-number">0</span>)
                    .withPageExtractedTextFormatter(ExtractedTextFormatter.builder()
                            .withNumberOfTopTextLinesToDelete(<span class="hljs-number">0</span>)
                            .build())
                    .withPagesPerDocument(<span class="hljs-number">1</span>)
                    .build());
    System.out.println( pdfReader.read().size());
}
</code></pre>
<p>3 æŒ‰Tokenè¿›è¡Œåˆ†å‰²</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-meta">@Test</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">testPdf</span><span class="hljs-params">()</span>{
    <span class="hljs-type">PagePdfDocumentReader</span> <span class="hljs-variable">pdfReader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PagePdfDocumentReader</span>(<span class="hljs-string">"classpath:/é˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œ(ç»ˆæç‰ˆ).pdf"</span>,
            PdfDocumentReaderConfig.builder()
                    .withPageTopMargin(<span class="hljs-number">0</span>)
                    .withPageExtractedTextFormatter(ExtractedTextFormatter.builder()
                            .withNumberOfTopTextLinesToDelete(<span class="hljs-number">0</span>)
                            .build())
                    .withPagesPerDocument(<span class="hljs-number">1</span>)
                    .build());


    <span class="hljs-type">TokenTextSplitter</span> <span class="hljs-variable">splitter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TokenTextSplitter</span>(<span class="hljs-number">1000</span>, <span class="hljs-number">400</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100000</span>, <span class="hljs-literal">true</span>);
    splitter.apply(pdfReader.read()).forEach(document -&gt; {
    System.out.printf(Arrays.toString(embeddingModel.embed(document)));
    });
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/011678f6ada64f0894d60f4e9ced7589~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGV2bG9naXgwMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769227766&amp;x-signature=gMU%2FUqM14enbAfdbdM7w6gAAmGU%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-11">09-SpringAIå®ç°å‘é‡æ•°æ®åº“çš„å­˜å‚¨</h2>
<p>1 docker é…ç½®</p>
<p>ç»´åº¦é€‰æ‹© 1024 ä¿æŒä¸€è‡´
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5ede2e0d01443c78ee84e308589fa7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZGV2bG9naXgwMQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769227766&amp;x-signature=KqCKGEWr3UfTMMlKBcpUzgyAlqc%3D" alt="image.png" loading="lazy"/></p>
<p>2 ä¾èµ–</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.ai<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-ai-starter-vector-store-qdrant<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<pre><code class="hljs language-yml" lang="yml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">ai:</span>
    <span class="hljs-attr">vectorstore:</span>
      <span class="hljs-attr">qdrant:</span>
        <span class="hljs-attr">host:</span> <span class="hljs-string">localhost</span>
        <span class="hljs-attr">port:</span> <span class="hljs-number">6334</span>
        <span class="hljs-attr">collection-name:</span> <span class="hljs-string">vector_store</span>
</code></pre>
<h2 data-id="heading-12">10-SpringAIå®ç°æ£€ç´¢å¢å¼º</h2>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> org.example.springaidemo.controller;


<span class="hljs-keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
<span class="hljs-keyword">import</span> jakarta.annotation.Resource;
<span class="hljs-keyword">import</span> org.example.springaidemo.entity.History;
<span class="hljs-keyword">import</span> org.example.springaidemo.service.HistoryService;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.client.ChatClient;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.messages.AssistantMessage;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.messages.Message;
<span class="hljs-keyword">import</span> org.springframework.ai.chat.messages.UserMessage;
<span class="hljs-keyword">import</span> org.springframework.ai.deepseek.DeepSeekChatModel;
<span class="hljs-keyword">import</span> org.springframework.ai.document.Document;
<span class="hljs-keyword">import</span> org.springframework.ai.embedding.EmbeddingModel;
<span class="hljs-keyword">import</span> org.springframework.ai.embedding.EmbeddingResponse;
<span class="hljs-keyword">import</span> org.springframework.ai.vectorstore.VectorStore;
<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;
<span class="hljs-keyword">import</span> reactor.core.publisher.Flux;

<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> java.util.stream.Collectors;

<span class="hljs-meta">@RestController</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {
    <span class="hljs-comment">//ä¾èµ–æ³¨å…¥</span>
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DeepSeekChatModel chatModel;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> ChatClient chatClient;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> HistoryService historyService;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> EmbeddingModel embeddingModel;
    <span class="hljs-meta">@Resource</span>
    <span class="hljs-keyword">private</span> VectorStore vectorStore;


    <span class="hljs-comment">//æ„é€ å‡½æ•°æ³¨å…¥</span>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChatController</span><span class="hljs-params">(DeepSeekChatModel chatModel)</span> {
        <span class="hljs-built_in">this</span>.chatModel = chatModel;
    }

    <span class="hljs-comment">/*
    * HTTP GETç«¯ç‚¹ï¼š/ai/generate
    æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º"Tell me a joke"
    è¿”å›AIåŠ©æ‰‹"å°é»‘"å¯¹ç”¨æˆ·æ¶ˆæ¯çš„åŒæ­¥å“åº”å†…å®¹
    * */</span>
    <span class="hljs-meta">@GetMapping("/ai/generate")</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">generate</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message)</span> {
        <span class="hljs-keyword">return</span>  chatClient.prompt(<span class="hljs-string">"ä½ æ˜¯aiåŠ©æ‰‹å°é»‘"</span>).user( message).call().content();

    }

    <span class="hljs-meta">@GetMapping(value = "/ai/generateStream", produces = "text/html; charset=UTF-8")</span>
    <span class="hljs-keyword">public</span> Flux&lt;String&gt; <span class="hljs-title function_">generateStream</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message,
                                       <span class="hljs-meta">@RequestParam(value = "sessionId", defaultValue = " 1 ")</span> <span class="hljs-type">long</span> sessionId
                                       )</span> {

        List&lt;Document&gt; documentList = vectorStore.similaritySearch(message);
        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">contextBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();
        documentList.forEach(document -&gt; contextBuilder.append(document).append(<span class="hljs-string">"\n"</span>));
        <span class="hljs-type">String</span> <span class="hljs-variable">prompt</span>  <span class="hljs-operator">=</span> <span class="hljs-string">"ä½ æ˜¯ç¼–ç¨‹åŠ©æ‰‹å°çº¢ , ä»¥ä¸‹æ˜¯æœ¬æ¬¡ä¼šè¯ä¼ é€’çš„ä¿¡æ¯"</span>+contextBuilder.toString()+
                <span class="hljs-string">"/n è¯·æ ¹æ®ä»¥ä¸Šä¿¡æ¯ï¼Œå›ç­”ç”¨æˆ·çš„é—®é¢˜ï¼š"</span>+message;
        <span class="hljs-comment">//ç”¨æˆ·æ¶ˆæ¯ä¿å­˜</span>
        <span class="hljs-type">History</span> <span class="hljs-variable">userhistory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">History</span>();
        userhistory.setDatetime(LocalDateTime.now());
        userhistory.setRole(<span class="hljs-string">"user"</span>);
        userhistory.setContent(message);
        userhistory.setSessionId(sessionId);
        historyService.save(userhistory); <span class="hljs-comment">//åˆ›å»ºå¹¶ä¿å­˜ç”¨æˆ·å‘é€çš„æ¶ˆæ¯åˆ°æ•°æ®åº“</span>

        <span class="hljs-comment">//è·å–å†å²å¯¹è¯</span>
        <span class="hljs-comment">//æŸ¥è¯¢æŒ‡å®šä¼šè¯IDçš„æ‰€æœ‰å†å²è®°å½•</span>
        <span class="hljs-comment">//æ’é™¤åˆšåˆšä¿å­˜çš„å½“å‰ç”¨æˆ·æ¶ˆæ¯ï¼ˆé¿å…é‡å¤ï¼‰</span>
        List&lt;History&gt; histories = historyService.list(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">LambdaQueryWrapper</span>&lt;History&gt;().eq(History::getSessionId, sessionId).ne(History::getId , userhistory.getId())
        ) ;

        <span class="hljs-comment">//è½¬æ¢å†å²æ¶ˆæ¯æ ¼å¼: å°†å†å²è®°å½•è½¬æ¢ä¸ºAIæ¨¡å‹èƒ½ç†è§£çš„æ¶ˆæ¯æ ¼å¼</span>
        List&lt;Message&gt; messages = histories.stream().map(history -&gt;
                <span class="hljs-string">"user"</span>.equals(history.getRole())?<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserMessage</span>(history.getContent()):<span class="hljs-keyword">new</span> <span class="hljs-title class_">AssistantMessage</span>(history.getContent())).collect(Collectors.toList());

        <span class="hljs-comment">//æ•°ç»„ ç”¨æ¥ç´¯ç§¯AIæµå¼å›å¤å†…å®¹</span>
        <span class="hljs-comment">//ä½¿ç”¨æ•°ç»„æ˜¯ä¸ºäº†åœ¨lambdaè¡¨è¾¾å¼ä¸­èƒ½å¤Ÿä¿®æ”¹å˜é‡</span>
        StringBuilder[] builder = {<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>()};

        <span class="hljs-comment">//æ„å»ºåŒ…å«ä¸Šä¸‹æ–‡çš„AIè¯·æ±‚å¹¶è¿”å›æµå¼å“åº”</span>
        Flux&lt;String&gt; stream = chatClient.prompt(prompt).user( message).messages( messages).stream().content();
        <span class="hljs-keyword">return</span>  stream.doOnNext(s -&gt; builder[<span class="hljs-number">0</span>].append(s)) <span class="hljs-comment">//å½“AIè¿”å›æ¯ä¸ªç‰‡æ®µæ—¶ï¼Œå°†å…¶è¿½åŠ åˆ°builderä¸­è¿›è¡Œç´¯ç§¯</span>
                .doOnComplete(() -&gt; {
                    <span class="hljs-type">History</span> <span class="hljs-variable">aihistory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">History</span>();
                    aihistory.setId(<span class="hljs-literal">null</span>);
                    aihistory.setDatetime(LocalDateTime.now());
                    aihistory.setRole(<span class="hljs-string">"assistant"</span>);
                    aihistory.setContent(builder[<span class="hljs-number">0</span>].toString());
                    aihistory.setSessionId(sessionId);
                    historyService.save(aihistory);
                });
        <span class="hljs-comment">/*
        å½“AIæµå¼å›å¤å®Œæˆåï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
        åˆ›å»ºæ–°çš„å†å²è®°å½•å¯¹è±¡
        è®¾ç½®æ—¶é—´æˆ³
        è®¾ç½®è§’è‰²ä¸º"assistant"
        å°†ç´¯ç§¯çš„å®Œæ•´å›å¤å†…å®¹ä¿å­˜
        è®¾ç½®ä¼šè¯ID
        ä¿å­˜åˆ°æ•°æ®åº“
        è¿™ç§æ–¹å¼ç¡®ä¿äº†åªæœ‰åœ¨AIå®Œå…¨ç”Ÿæˆå›å¤åï¼Œæ‰ä¼šå°†å…¶ä¿å­˜åˆ°å†å²è®°å½•ä¸­ï¼ŒåŒæ—¶ä¿æŒäº†æµå¼å“åº”çš„å®æ—¶æ€§*/</span>
    }

    <span class="hljs-meta">@GetMapping("/ai/embedding")</span>
    <span class="hljs-keyword">public</span> Map <span class="hljs-title function_">embed</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(value = "message", defaultValue = "Tell me a joke")</span> String message)</span> {
        <span class="hljs-type">EmbeddingResponse</span> <span class="hljs-variable">embeddingResponse</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.embeddingModel.embedForResponse(List.of(message));
        <span class="hljs-keyword">return</span> Map.of(<span class="hljs-string">"embedding"</span>, embeddingResponse);
    }
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å½“ Golang é‡è§å·¥ä¸š 4.0ï¼šä»â€œåˆ¶é€ â€åˆ°â€œæ™ºé€ â€çš„æ•°å­—åŒ–è·ƒè¿]]></title>    <link>https://juejin.cn/post/7595878718171037732</link>    <guid>https://juejin.cn/post/7595878718171037732</guid>    <pubDate>2026-01-17T04:13:00.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718171037732" data-draft-id="7595794942087446563" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å½“ Golang é‡è§å·¥ä¸š 4.0ï¼šä»â€œåˆ¶é€ â€åˆ°â€œæ™ºé€ â€çš„æ•°å­—åŒ–è·ƒè¿"/> <meta itemprop="keywords" content="åç«¯,Go,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-17T04:13:00.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä»£ç æ‰³æ‰‹"/> <meta itemprop="url" content="https://juejin.cn/user/177501539672379"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å½“ Golang é‡è§å·¥ä¸š 4.0ï¼šä»â€œåˆ¶é€ â€åˆ°â€œæ™ºé€ â€çš„æ•°å­—åŒ–è·ƒè¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/177501539672379/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä»£ç æ‰³æ‰‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T04:13:00.000Z" title="Sat Jan 17 2026 04:13:00 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ä¸Šä¸€ç¯‡å…³äºæ­£åˆ™çš„ç¡¬æ ¸æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æµ…å°è¾„æ­¢åœ°æåˆ°äº† FSMï¼ˆæœ‰é™çŠ¶æ€æœºï¼‰ã€‚æœ¬æƒ³åœ¨è¯„è®ºåŒºå’Œå¤§å®¶æ¥ä¸€åœºâ€œåå±±è®ºå‰‘â€ï¼Œæ¢è®¨å®ƒçš„èŠ±å¼å®ç°ï¼Œä½†è½¬å¿µä¸€æƒ³ï¼Œå…‰è°ˆç†è®ºæœªå…æ¯ç‡¥ã€‚</p>
<p>æ­£å¥½æœ€è¿‘åœ¨ç ”ç©¶å·¥ä¸š 4.0 çš„æ•°å­—åŒ–è½¬å‹ï¼Œä»Šå¤©ä¸å¦¨æ¢ä¸ªè§†è§’ï¼Œä»¥<strong>å·¥ä¸šæ•°å­—åŒ–æµç¨‹ç®¡ç†</strong>ä¸ºä¾‹ï¼Œå¸¦å¤§å®¶çœ‹çœ‹ Golang æ˜¯å¦‚ä½•æŒ‡æŒ¥åºå¤§çš„ç‰©ç†å·¥å‚è¿è½¬çš„ã€‚å½“ç„¶ï¼Œä½œä¸ºâ€œè€æœ‹å‹â€çš„ FSM çŠ¶æ€æœºï¼Œä¹Ÿä¼šåœ¨å…¶ä¸­æ‰®æ¼”å…³é”®è§’è‰²ï¼Œè®©æˆ‘ä»¬ä¸€æ¢ç©¶ç«Ÿï¼</p>
<blockquote>
<p><strong>ğŸ’¡ ç‚¹é‡‘ä¹‹å¥ï¼š</strong>
ä»£ç çš„ä¼˜é›…ï¼Œä¸ä»…åœ¨äºé€»è¾‘çš„é—­ç¯ï¼Œæ›´åœ¨äºå¯¹ç‰©ç†ä¸–ç•Œçš„æ•¬ç•ä¸ç²¾å‡†æ§åˆ¶ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">01 æ ¸å¿ƒæ¶æ„ï¼šç»™å·¥å‚è£…ä¸Šâ€œå¤§è„‘â€</h2>
<p>æˆ‘ä»¬çš„ç³»ç»Ÿç”±ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶æ„æˆï¼Œå®ƒä»¬å„å¸å…¶èŒï¼Œåƒæäº†å·¥å‚é‡Œçš„å„ä¸ªéƒ¨é—¨ï¼š</p>
<ul>
<li><strong>Workflow Engineï¼ˆç¼–æ’å¼•æ“ï¼‰</strong>ï¼šè´Ÿè´£å®šä¹‰å·¥åºï¼ˆä¸Šæ–™ -&gt; ç»„è£… -&gt; è´¨æ£€ -&gt; ä¸‹æ–™ï¼‰ï¼Œå®ƒæ˜¯ç”Ÿäº§çº¿çš„â€œè¯´æ˜ä¹¦â€ã€‚</li>
<li><strong>Schedulerï¼ˆè°ƒåº¦å™¨ï¼‰</strong>ï¼šè´Ÿè´£åˆ†å‘ä»»åŠ¡ï¼Œå†³å®šè°å…ˆåšã€è°ååšï¼Œå®ƒæ˜¯å·¥å‚çš„â€œæŒ‡æŒ¥å®˜â€ã€‚</li>
<li><strong>Stationï¼ˆå·¥ç«™ï¼‰</strong>ï¼šå®é™…å¹²æ´»çš„èŠ‚ç‚¹ï¼Œæ¨¡æ‹Ÿç‰©ç†è®¾å¤‡çš„æ‰§è¡Œã€‚</li>
</ul>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆé€‰æ‹© Goï¼Ÿ</h3>
<p>å·¥ä¸šåœºæ™¯å¯¹<strong>å¹¶å‘</strong>å’Œ<strong>å®æ—¶æ€§</strong>è¦æ±‚æé«˜ã€‚Go è¯­è¨€åŸç”Ÿçš„ <code>goroutine</code> å’Œ <code>channel</code> æœºåˆ¶ï¼Œå¤©ç”Ÿå°±æ˜¯ä¸ºå¤„ç†è¿™ç§é«˜å¹¶å‘æµæ°´çº¿è€Œç”Ÿçš„ã€‚</p>
<hr/>
<h2 data-id="heading-2">02 ç—›ç‚¹ä¸€ï¼šè€æ¿çš„ VIP è®¢å•è¦æ’é˜Ÿï¼</h2>
<p>åœ¨ä¼ ç»Ÿé˜Ÿåˆ—ï¼ˆFIFOï¼‰ä¸­ï¼Œå…ˆæ¥ååˆ°æ˜¯é“å¾‹ã€‚ä½†åœ¨å·¥ä¸šç”Ÿäº§ä¸­ï¼Œç¼ºæ–™è¡¥å•ã€åŠ æ€¥æ ·å“æ˜¯å¸¸æ€ã€‚å¦‚æœä¸€ä¸ªç´§æ€¥è®¢å•è¢«å µåœ¨å‡ åƒä¸ªæ™®é€šè®¢å•åé¢ï¼Œå·¥å‚å¯èƒ½é¢ä¸´å·¨é¢è¿çº¦é‡‘ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šä¼˜å…ˆçº§é˜Ÿåˆ— (Priority Queue)</strong></p>
<p>æˆ‘ä»¬åˆ©ç”¨ Go æ ‡å‡†åº“ <code>container/heap</code> å®ç°äº†ä¸€ä¸ªæœ€å°å †ï¼ˆMin-Heapï¼‰ï¼Œä½†è¿™é‡Œæˆ‘ä»¬åå…¶é“è€Œè¡Œä¹‹ï¼ŒæŒ‰ä¼˜å…ˆçº§ä»å¤§åˆ°å°æ’åºã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æ ¸å¿ƒä»£ç ç‰‡æ®µï¼šè®© VIP èµ°ç»¿è‰²é€šé“</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(pq PriorityQueue)</span></span> Less(i, j <span class="hljs-type">int</span>) <span class="hljs-type">bool</span> {
    <span class="hljs-comment">// ä¼˜å…ˆçº§é«˜çš„æ’å‰é¢ï¼</span>
    <span class="hljs-keyword">return</span> pq[i].Product.Priority &gt; pq[j].Product.Priority
}

<span class="hljs-comment">// è°ƒåº¦å™¨é€»è¾‘</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Scheduler)</span></span> SubmitTask(p *types.Product) {
    s.mu.Lock()
    heap.Push(&amp;s.pq, &amp;Item{Product: p}) <span class="hljs-comment">// æ— è®ºä½•æ—¶æäº¤ï¼Œè‡ªåŠ¨æ’åº</span>
    s.cond.Signal() <span class="hljs-comment">// å”¤é†’æ²‰ç¡çš„å·¥äºº</span>
    s.mu.Unlock()
}
</code></pre>
<p><strong>æ•ˆæœï¼š</strong> å“ªæ€•æ™®é€šè®¢å•æ’äº† 100 ç±³é•¿ï¼Œåªè¦ VIP è®¢å•ä¸€æäº¤ï¼Œä¸‹ä¸€ä¸ªç©ºé—²çš„å·¥ä½å°±æ˜¯å®ƒçš„ã€‚è¿™å°±æ˜¯<strong>ç®—æ³•çš„ç‰¹æƒ</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-3">03 ç—›ç‚¹äºŒï¼šè´¨æ£€ä¸åˆæ ¼ï¼Œå‰é¢çš„å·¥åºç™½åšäº†ï¼Ÿ</h2>
<p>å‡è®¾ä¸€ä¸ªç”µæ± åŒ…ç»è¿‡äº†â€œç”µèŠ¯ç»„è£…â€å’Œâ€œç„Šæ¥â€ï¼Œç»“æœåœ¨â€œè´¨æ£€â€ç¯èŠ‚å‘ç°ç”µå‹å¼‚å¸¸ã€‚è¿™æ—¶å€™ç›´æ¥ä¸¢å¼ƒæ˜¯ä¸å¤Ÿçš„ï¼Œæˆ‘ä»¬éœ€è¦<strong>é€†å‘ç‰©æµ</strong>â€”â€”æ‹†è§£ã€å›æ”¶ã€è®°å½•ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šSaga äº‹åŠ¡æ¨¡å¼ + FSM çŠ¶æ€æœº</strong></p>
<p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒSaga ç”¨äºå¤„ç†é•¿äº‹åŠ¡ã€‚åœ¨å·¥å‚é‡Œï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥ä¿è¯<strong>æœ€ç»ˆä¸€è‡´æ€§</strong>ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¼•å…¥äº† <strong>FSM (æœ‰é™çŠ¶æ€æœº)</strong> æ¥ç²¾å‡†ç®¡ç†å·¥ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œç¡®ä¿çŠ¶æ€æµè½¬ï¼ˆå¦‚ <code>PROCESSING</code> -&gt; <code>QUALITY_CHECK</code> -&gt; <code>FAILED</code>ï¼‰çš„åˆæ³•æ€§ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// ç¼–æ’å¼•æ“çš„æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *WorkflowEngine)</span></span> Process(p *types.Product) {
    <span class="hljs-comment">// åˆå§‹åŒ– FSM</span>
    productFSM := fsm.NewFSM(p.ID)
    _ = productFSM.Fire(fsm.EventStart) <span class="hljs-comment">// çŠ¶æ€æµè½¬ï¼šCREATED -&gt; PROCESSING</span>

    <span class="hljs-keyword">for</span> _, step := <span class="hljs-keyword">range</span> sequence {
        <span class="hljs-comment">// ... æ‰§è¡Œå·¥åº ...</span>
        <span class="hljs-keyword">if</span> !res.Success {
            _ = productFSM.Fire(fsm.EventFail) <span class="hljs-comment">// çŠ¶æ€æµè½¬ï¼š-&gt; FAILED</span>
            <span class="hljs-comment">// âš ï¸ æŠ¥è­¦ï¼è§¦å‘ç†”æ–­ä¸è¡¥å¿</span>
            e.rollback(executedStations, p, productFSM)
            <span class="hljs-keyword">return</span>
        }
    }
    _ = productFSM.Fire(fsm.EventFinish) <span class="hljs-comment">// çŠ¶æ€æµè½¬ï¼š-&gt; COMPLETED</span>
}
</code></pre>
<p>è¿™ä¸ä»…æ˜¯ä»£ç å±‚é¢çš„å›æ»šï¼Œæ›´æ˜¯ç‰©ç†ä¸–ç•Œçš„â€œåæ‚”è¯â€ã€‚</p>
<hr/>
<h2 data-id="heading-4">04 ç—›ç‚¹ä¸‰ï¼šæ•ˆç‡è‡³ä¸Šï¼Œèƒ½å¹¶è¡Œçš„ç»ä¸ä¸²è¡Œï¼</h2>
<p>ä¼ ç»Ÿçš„æµæ°´çº¿å¾€å¾€æ˜¯çº¿æ€§çš„ï¼Œä½†ç°ä»£å·¥å‚ä¸­ï¼Œå¾ˆå¤šå·¥åºå¯ä»¥å¹¶è¡Œå¤„ç†ã€‚ä¾‹å¦‚ï¼Œåœ¨ç»„è£…åº•ç›˜çš„åŒæ—¶ï¼Œå¯ä»¥å¹¶è¡Œè¿›è¡Œè½¦èº«å–·æ¶‚ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šæŠ½è±¡æ¥å£ä¸å¹¶å‘ç¼–æ’</strong></p>
<p>æˆ‘ä»¬å°† <code>Station</code> æŠ½è±¡ä¸ºæ¥å£ï¼Œå¹¶åˆ©ç”¨ Go å¼ºå¤§çš„ <code>sync.WaitGroup</code> å®ç°å·¥åºçš„å¹¶è¡Œæ‰§è¡Œã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// executeStep æ‰§è¡Œå•ä¸ªæ­¥éª¤ï¼Œæ”¯æŒå¹¶è¡Œå·¥ç«™</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(e *WorkflowEngine)</span></span> executeStep(step types.WorkflowStep, p *types.Product) {
    <span class="hljs-keyword">var</span> wg sync.WaitGroup
    <span class="hljs-keyword">for</span> _, sID := <span class="hljs-keyword">range</span> step.StationIDs {
        wg.Add(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">go</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(s station.Station)</span></span> {
            <span class="hljs-keyword">defer</span> wg.Done()
            s.Execute(p) <span class="hljs-comment">// å¹¶å‘æ‰§è¡Œï¼</span>
        }(st)
    }
    wg.Wait() <span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰å¹¶è¡Œå·¥åºå®Œæˆ</span>
}
</code></pre>
<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬ä¸ä»…æé«˜äº†ç”Ÿäº§æ•ˆç‡ï¼Œè¿˜è§£è€¦äº†å…·ä½“çš„å·¥ç«™å®ç°ï¼Œä¸ºæœªæ¥æ¥å…¥çœŸå®çš„ç¡¬ä»¶æ§åˆ¶æ¥å£æ‰“ä¸‹äº†åŸºç¡€ã€‚</p>
<hr/>
<h2 data-id="heading-5">05 ç—›ç‚¹å››ï¼šç³»ç»Ÿå´©æºƒï¼Œæ•°æ®å…¨ä¸¢ï¼Ÿ</h2>
<p>å·¥å‚åœç”µæˆ–æœåŠ¡å™¨å®•æœºæ˜¯ä¸å¯é¿å…çš„ã€‚å¦‚æœé‡å¯åï¼Œæ‰€æœ‰æ­£åœ¨æ’é˜Ÿçš„è®¢å•éƒ½æ¶ˆå¤±äº†ï¼Œé‚£å°†æ˜¯ç¾éš¾æ€§çš„ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼šWAL (Write-Ahead Logging) æŒä¹…åŒ–</strong></p>
<p>æˆ‘ä»¬å€Ÿé‰´æ•°æ®åº“çš„è®¾è®¡ï¼Œå¼•å…¥äº† <strong>WAL é¢„å†™æ—¥å¿—</strong>ã€‚åœ¨ä»»åŠ¡è¿›å…¥å†…å­˜é˜Ÿåˆ—å‰ï¼Œå…ˆå†™å…¥ç£ç›˜æ—¥å¿—ã€‚ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨é‡æ”¾æ—¥å¿—ï¼Œæ¢å¤æœªå®Œæˆçš„ä»»åŠ¡ã€‚</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// æäº¤ä»»åŠ¡æ—¶ï¼šå…ˆå†™æ—¥å¿—ï¼Œå†å…¥å†…å­˜</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Scheduler)</span></span> SubmitTask(p *types.Product) {
    <span class="hljs-keyword">if</span> err := s.wal.Append(p); err != <span class="hljs-literal">nil</span> {
        <span class="hljs-comment">// å¤„ç†é”™è¯¯...</span>
    }
    heap.Push(&amp;s.pq, &amp;Item{Product: p})
}

<span class="hljs-comment">// å¯åŠ¨æ—¶ï¼šä»æ—¥å¿—æ¢å¤</span>
<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(s *Scheduler)</span></span> RecoverTasks() {
    tasks := s.wal.Recover()
    <span class="hljs-keyword">for</span> _, p := <span class="hljs-keyword">range</span> tasks {
        heap.Push(&amp;s.pq, &amp;Item{Product: p})
    }
}
</code></pre>
<hr/>
<h2 data-id="heading-6">06 æ€»ç»“ä¸å±•æœ›</h2>
<p>é€šè¿‡è¿™ä¸ª Demoï¼Œæˆ‘ä»¬ä¸ä»…å¤ä¹ äº† Go çš„å¹¶å‘æ¨¡å‹ï¼Œæ›´çœ‹åˆ°äº†æŠ€æœ¯åœ¨å®ä½“äº§ä¸šä¸­çš„å·¨å¤§æ½œåŠ›ã€‚</p>
<ul>
<li><strong>PriorityQueue</strong> è§£å†³äº†èµ„æºåˆ†é…çš„å…¬å¹³ä¸æ•ˆç‡é—®é¢˜ã€‚</li>
<li><strong>Saga + FSM</strong> è§£å†³äº†é•¿æµç¨‹ä¸­çš„å®¹é”™ä¸çŠ¶æ€ç®¡ç†é—®é¢˜ã€‚</li>
<li><strong>å¹¶å‘ç¼–æ’</strong> æå‡äº†ç”Ÿäº§æ•ˆç‡ã€‚</li>
<li><strong>WAL æŒä¹…åŒ–</strong> ä¿è¯äº†æ•°æ®çš„å¯é æ€§ã€‚</li>
<li><strong>Prometheus ç›‘æ§</strong> è®©ç³»ç»ŸçŠ¶æ€ä¸€ç›®äº†ç„¶ã€‚</li>
</ul>
<p>å·¥ä¸š 4.0 ä¸ä»…ä»…æ˜¯ç¡¬ä»¶çš„å‡çº§ï¼Œæ›´æ˜¯è½¯ä»¶æ¶æ„çš„é©å‘½ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬çš„æ¯ä¸€è¡Œä»£ç ï¼Œéƒ½å¯èƒ½é©±åŠ¨ç€ç°å®ä¸–ç•Œä¸­æŸä¸ªé½¿è½®çš„è½¬åŠ¨ã€‚</p>
<p><strong>Talk is cheap, show me the code.</strong>
å¦‚æœä½ å¯¹æºç æ„Ÿå…´è¶£ï¼Œæ¬¢è¿åœ¨åå°å›å¤ <strong>â€œå·¥ä¸š4.0â€</strong> è·å–å®Œæ•´ GitHub ä»“åº“åœ°å€ï¼Œä¸€èµ·æ¢è®¨ Golang åœ¨ç‰©è”ç½‘é¢†åŸŸçš„æ›´å¤šå¯èƒ½ï¼</p>
<hr/>
<p><strong>ğŸ‘‡ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Ÿâ€œç‚¹èµâ€ï¼Œâ€œæ”¶è—â€ï¼Œâ€œåˆ†äº«â€ï¼Œè®©æŠ€æœ¯æ›´æœ‰æ¸©åº¦ï¼</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ Elasticsearch ç®¡ç† agentic è®°å¿†]]></title>    <link>https://juejin.cn/post/7595858760133673023</link>    <guid>https://juejin.cn/post/7595858760133673023</guid>    <pubDate>2026-01-17T05:54:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858760133673023" data-draft-id="7595911076013785124" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ Elasticsearch ç®¡ç† agentic è®°å¿†"/> <meta itemprop="keywords" content="Elasticsearch"/> <meta itemprop="datePublished" content="2026-01-17T05:54:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Elasticsearch"/> <meta itemprop="url" content="https://juejin.cn/user/2612095360441448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ Elasticsearch ç®¡ç† agentic è®°å¿†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2612095360441448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Elasticsearch
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T05:54:49.000Z" title="Sat Jan 17 2026 05:54:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»34åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½œè€…ï¼šæ¥è‡ª ElasticÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fauthor%2Fsomeshwaran-mohankumar" title="https://www.elastic.co/search-labs/author/someshwaran-mohankumar" target="_blank" ref="nofollow noopener noreferrer">Someshwaran Mohankumar</a></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00cfc15cfd814ee897d28d128bc95581~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=bQdHJS8FskRZYpZB700BCFklEJo%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡ä½¿ç”¨ Elasticsearch ç®¡ç†è®°å¿†æ¥åˆ›å»ºæ›´å…·ä¸Šä¸‹æ–‡æ„ŸçŸ¥ä¸”æ›´é«˜æ•ˆçš„ä»£ç†ã€‚</p>
<p>Agent Builder ç°åœ¨ä»¥æŠ€æœ¯é¢„è§ˆç‰ˆçš„å½¢å¼æä¾›ã€‚ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcloud.elastic.co%2Fregistration%3Futm_source%3Dagentic-ai-category%26utm_medium%3Dsearch-labs%26utm_campaign%3Dagent-builder" title="https://cloud.elastic.co/registration?utm_source=agentic-ai-category&amp;utm_medium=search-labs&amp;utm_campaign=agent-builder" target="_blank" ref="nofollow noopener noreferrer">Elastic Cloud Trial</a> å¼€å§‹ä½“éªŒï¼Œå¹¶åœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fdocs%2Fsolutions%2Fsearch%2Felastic-agent-builder%3Futm_source%3Dagentic-ai-category%26utm_medium%3Dsearch-labs%26utm_campaign%3Dagent-builder" title="https://www.elastic.co/docs/solutions/search/elastic-agent-builder?utm_source=agentic-ai-category&amp;utm_medium=search-labs&amp;utm_campaign=agent-builder" target="_blank" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>æŸ¥çœ‹ Agent Builder çš„æ–‡æ¡£ã€‚</p>
<hr/>
<p>åœ¨æ–°å…´çš„ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F151232162" title="https://elasticstack.blog.csdn.net/article/details/151232162" target="_blank" ref="nofollow noopener noreferrer">context engineering</a></strong> é¢†åŸŸï¼Œç»™ AI agent åœ¨æ­£ç¡®æ—¶é—´æä¾›æ­£ç¡®ä¿¡æ¯è‡³å…³é‡è¦ã€‚context engineering ä¸­æœ€é‡è¦çš„æ–¹é¢ä¹‹ä¸€æ˜¯ç®¡ç† AI çš„ <strong>memory</strong>ã€‚å°±åƒäººç±»ä¸€æ ·ï¼ŒAI ç³»ç»Ÿä¾èµ–çŸ­æœŸ memory å’Œé•¿æœŸ memory æ¥å›å¿†ä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ› large language model (<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F134747557" title="https://elasticstack.blog.csdn.net/article/details/134747557" target="_blank" ref="nofollow noopener noreferrer">LLM</a>) agent è¿›è¡Œé€»è¾‘å¯¹è¯ã€è®°ä½ç”¨æˆ·åå¥½ï¼Œæˆ–åœ¨ä¹‹å‰çš„ç»“æœæˆ–å“åº”åŸºç¡€ä¸Šç»§ç»­å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå®ƒä»¬é…å¤‡æœ‰æ•ˆçš„ memory æœºåˆ¶ã€‚</p>
<p>æ¯•ç«Ÿï¼Œä¸Šä¸‹æ–‡ä¸­çš„ä¸€åˆ‡éƒ½ä¼šå½±å“ AI çš„å“åº”ã€‚åƒåœ¾è¿›, åƒåœ¾å‡ºåŒæ ·é€‚ç”¨ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»çŸ­æœŸå’Œé•¿æœŸ memory å¯¹ AI agent çš„æ„ä¹‰ï¼Œå…·ä½“åŒ…æ‹¬ï¼š</p>
<ul>
<li>çŸ­æœŸ memory å’Œé•¿æœŸ memory çš„åŒºåˆ«ã€‚</li>
<li>å®ƒä»¬å¦‚ä½•ä¸åŸºäº vector database çš„ retrieval-augmented generation (<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F134396254" title="https://elasticstack.blog.csdn.net/article/details/134396254" target="_blank" ref="nofollow noopener noreferrer">RAG</a>) æŠ€æœ¯ï¼ˆå¦‚ Elasticsearchï¼‰ç›¸å…³ï¼Œä»¥åŠä¸ºä»€ä¹ˆéœ€è¦è°¨æ…ç®¡ç† memoryã€‚</li>
<li>å¿½è§† memory çš„é£é™©ï¼ŒåŒ…æ‹¬ context overflow å’Œ context poisoningã€‚</li>
<li>æœ€ä½³å®è·µï¼Œå¦‚ context pruningã€summarizingï¼Œä»¥åŠåªæ£€ç´¢ç›¸å…³å†…å®¹ï¼Œä»¥ä¿æŒ agent çš„ memory æ—¢æœ‰ç”¨åˆå®‰å…¨ã€‚</li>
</ul>
<p>æœ€åï¼Œæˆ‘ä»¬è¿˜ä¼šä»‹ç» memory å¦‚ä½•åœ¨ multi-agent ç³»ç»Ÿä¸­å…±äº«å’Œä¼ æ’­ï¼Œä½¿ agent èƒ½åœ¨ä½¿ç”¨ Elasticsearch æ—¶åä½œè€Œä¸äº§ç”Ÿæ··ä¹±ã€‚</p>
<h2 data-id="heading-0">AI agent ä¸­çš„çŸ­æœŸè®°å¿†ä¸é•¿æœŸè®°å¿†</h2>
<p>AI agent çš„çŸ­æœŸè®°å¿†é€šå¸¸æŒ‡å³æ—¶çš„å¯¹è¯ä¸Šä¸‹æ–‡æˆ–çŠ¶æ€ â€”â€” æœ¬è´¨ä¸Šæ˜¯å½“å‰çš„èŠå¤©è®°å½•æˆ–æ´»è·ƒä¼šè¯ä¸­çš„æœ€è¿‘æ¶ˆæ¯ã€‚è¿™åŒ…æ‹¬ç”¨æˆ·çš„æœ€æ–°æŸ¥è¯¢å’Œæœ€è¿‘çš„æ¥å›äº¤æµã€‚è¿™ä¸äººåœ¨è¿›è¡Œå¯¹è¯æ—¶å¿ƒä¸­ä¿æŒçš„ä¿¡æ¯éå¸¸ç›¸ä¼¼ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c43c707eb794c65b7c3fd7aa95f6f23~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=857UdLfIQeSx3pxvD%2FbdOv43Eqc%3D" alt="" loading="lazy"/> Image source:Â  <a href="https://link.juejin.cn?target=https%3A%2F%2Flangchain.ai.github.io%2Flanggraphjs%2Fconcepts%2Fmemory" title="https://langchain.ai.github.io/langgraphjs/concepts/memory" target="_blank" ref="nofollow noopener noreferrer">langchain.ai.github.io/langgraphjsâ€¦</a></p>
<p>AI æ¡†æ¶é€šå¸¸å°†è¿™ç§çŸ­æš‚è®°å¿†ä½œä¸º agent çŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ checkpointer å­˜å‚¨å¯¹è¯çŠ¶æ€ï¼Œå°±åƒ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Flanggraph%2Fpersistence%23checkpoints" title="https://docs.langchain.com/oss/python/langgraph/persistence#checkpoints" target="_blank" ref="nofollow noopener noreferrer">LangGraph ç¤ºä¾‹</a>ä¸­å±•ç¤ºçš„é‚£æ ·ï¼‰ã€‚çŸ­æœŸè®°å¿†æ˜¯<strong>ä¼šè¯èŒƒå›´çš„</strong>ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå­˜åœ¨äºå•ä¸ªå¯¹è¯æˆ–ä»»åŠ¡ä¸­ï¼Œå¹¶åœ¨è¯¥ä¼šè¯ç»“æŸæ—¶é‡ç½®æˆ–æ¸…é™¤ï¼Œé™¤éè¢«æ˜¾å¼ä¿å­˜åˆ°å…¶ä»–åœ°æ–¹ã€‚ä¼šè¯ç»‘å®šçš„çŸ­æœŸè®°å¿†ç¤ºä¾‹å°±æ˜¯ ChatGPT ä¸­å¯ç”¨çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fhelp.openai.com%2Fen%2Farticles%2F8914046-temporary-chat-faq" title="https://help.openai.com/en/articles/8914046-temporary-chat-faq" target="_blank" ref="nofollow noopener noreferrer">ä¸´æ—¶èŠå¤©è®°å½•</a>ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6cc2de7d82454b3bb5aa74a758618d5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=uYT761e7KhYYaGqoH4Fpwz2tNJU%3D" alt="" loading="lazy"/> å›¾ç‰‡æ¥æº:Â :Â  <a href="https://link.juejin.cn?target=http%3A%2F%2F%3A%2520https%3A%2F%2Fdocs.langchain.com%2Foss%2Fpython%2Flanggraph%2Fpersistence%23memory-store" title="http://:%20https://docs.langchain.com/oss/python/langgraph/persistence#memory-store" target="_blank" ref="nofollow noopener noreferrer">docs.langchain.com/oss/python/â€¦</a></p>
<p>å¦ä¸€æ–¹é¢ï¼Œé•¿æœŸè®°å¿†æŒ‡çš„æ˜¯è·¨å¯¹è¯æˆ–ä¼šè¯æŒç»­å­˜åœ¨çš„ä¿¡æ¯ã€‚è¿™æ˜¯ agent éšæ—¶é—´ä¿ç•™çš„çŸ¥è¯†ã€æ—©å…ˆå­¦åˆ°çš„äº‹å®ã€ç”¨æˆ·åå¥½ï¼Œæˆ–æˆ‘ä»¬è¦æ±‚å®ƒæ°¸ä¹…è®°ä½çš„ä»»ä½•æ•°æ®ã€‚</p>
<p>é•¿æœŸè®°å¿†é€šå¸¸é€šè¿‡å­˜å‚¨åœ¨å¤–éƒ¨æ¥æºï¼ˆå¦‚æ–‡ä»¶æˆ–<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Felasticsearch%2Fvector-database" title="https://www.elastic.co/elasticsearch/vector-database" target="_blank" ref="nofollow noopener noreferrer">å‘é‡æ•°æ®åº“</a>ï¼‰å¹¶è¿›è¡Œæ£€ç´¢æ¥å®ç°ï¼Œè¿™äº›æ¥æºåœ¨å½“å‰ä¸Šä¸‹æ–‡çª—å£ä¹‹å¤–ã€‚ä¸çŸ­æœŸèŠå¤©è®°å½•ä¸åŒï¼Œé•¿æœŸè®°å¿†ä¸ä¼šè‡ªåŠ¨åŒ…å«åœ¨æ¯ä¸ª prompt ä¸­ã€‚ç›¸åï¼ŒåŸºäºç‰¹å®šåœºæ™¯ï¼Œagent å¿…é¡»åœ¨è°ƒç”¨ç›¸å…³å·¥å…·æ—¶å›å¿†æˆ–æ£€ç´¢å®ƒã€‚å®é™…ä¸­ï¼Œé•¿æœŸè®°å¿†å¯èƒ½åŒ…æ‹¬ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ã€agent å…ˆå‰ç”Ÿæˆçš„ç­”æ¡ˆæˆ–åˆ†æï¼Œæˆ–å¯æŸ¥è¯¢çš„çŸ¥è¯†åº“ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæ—…è¡Œè§„åˆ’ agentï¼ŒçŸ­æœŸè®°å¿†ä¼šåŒ…å«å½“å‰è¡Œç¨‹æŸ¥è¯¢çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ—¥æœŸã€ç›®çš„åœ°ã€é¢„ç®—ï¼‰åŠèŠå¤©ä¸­çš„ä»»ä½•åç»­é—®é¢˜ï¼›è€Œé•¿æœŸè®°å¿†å¯ä»¥å­˜å‚¨ç”¨æˆ·çš„ä¸€èˆ¬æ—…è¡Œåå¥½ã€è¿‡å»çš„è¡Œç¨‹ä»¥åŠä¹‹å‰ä¼šè¯ä¸­å…±äº«çš„å…¶ä»–äº‹å®ã€‚å½“ç”¨æˆ·ä¹‹åå†æ¬¡è®¿é—®æ—¶ï¼Œagent å¯ä»¥ä»è¿™ä¸ªé•¿æœŸå­˜å‚¨ä¸­è°ƒç”¨ä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·å–œæ¬¢æµ·æ»©å’Œå±±è„‰ï¼Œå¹³å‡é¢„ç®—ä¸º INR 100,000ï¼Œæœ‰æ—…è¡Œæ„¿æœ›æ¸…å•ï¼Œåå¥½ä½“éªŒå†å²å’Œæ–‡åŒ–è€Œéå„¿ç«¥å‹å¥½æ™¯ç‚¹ï¼‰ï¼Œè¿™æ ·æ¯æ¬¡å°±ä¸éœ€è¦æŠŠç”¨æˆ·å½“ä½œç©ºç™½ã€‚</p>
<p>çŸ­æœŸè®°å¿†ï¼ˆèŠå¤©è®°å½•ï¼‰æä¾›å³æ—¶ä¸Šä¸‹æ–‡å’Œè¿ç»­æ€§ï¼Œè€Œé•¿æœŸè®°å¿†æä¾›æ›´å¹¿æ³›çš„ä¸Šä¸‹æ–‡ä¾› agent åœ¨éœ€è¦æ—¶å‚è€ƒã€‚å¤§å¤šæ•°å…ˆè¿›çš„ AI agent æ¡†æ¶åŒæ—¶æ”¯æŒä¸¤è€…ï¼šå®ƒä»¬è·Ÿè¸ªæœ€è¿‘å¯¹è¯ä»¥ç»´æŒä¸Šä¸‹æ–‡ï¼Œå¹¶æä¾›åœ¨é•¿æœŸå­˜å‚¨ä¸­æŸ¥æ‰¾æˆ–å­˜å‚¨ä¿¡æ¯çš„æœºåˆ¶ã€‚ç®¡ç†çŸ­æœŸè®°å¿†ç¡®ä¿å…¶ä¿æŒåœ¨ä¸Šä¸‹æ–‡çª—å£å†…ï¼Œè€Œç®¡ç†é•¿æœŸè®°å¿†åˆ™å¸®åŠ© agent åŸºäºä¹‹å‰çš„äº’åŠ¨å’Œç”¨æˆ·ç‰¹å¾æä¾›æ›´æœ‰ä¾æ®çš„å›ç­”ã€‚</p>
<h2 data-id="heading-1">ä¸Šä¸‹æ–‡å·¥ç¨‹ä¸­çš„è®°å¿†ä¸ RAG</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/147134f94236443b8b7e8e69e71700f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=LmKLipWoTrGjBwKaVkx7xwPQh54%3D" alt="" loading="lazy"/> Image source:Â  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fhumanlayer%2F12-factor-agents%2Fblob%2Fmain%2Fcontent%2Ffactor-03-own-your-context-window.md" title="https://github.com/humanlayer/12-factor-agents/blob/main/content/factor-03-own-your-context-window.md" target="_blank" ref="nofollow noopener noreferrer">github.com/humanlayer/â€¦</a></p>
<h3 data-id="heading-2">åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬å¦‚ä½•ä¸º AI agent æä¾›æœ‰ç”¨çš„é•¿æœŸè®°å¿†ï¼Ÿ</h3>
<p>ä¸€ç§å¸¸ç”¨çš„é•¿æœŸè®°å¿†æ–¹æ³•æ˜¯<strong>è¯­ä¹‰è®°å¿†</strong>ï¼Œé€šå¸¸é€šè¿‡å€’æ•°æ’åºå¢å¼ºç”Ÿæˆï¼ˆ<strong>RAG, Retrieval-Augmented Generation</strong>ï¼‰å®ç°ã€‚è¿™æ¶‰åŠå°† LLM ä¸å¤–éƒ¨çŸ¥è¯†åº“æˆ–æ”¯æŒå‘é‡çš„å­˜å‚¨ï¼ˆå¦‚ Elasticsearchï¼‰ç»“åˆã€‚å½“ LLM éœ€è¦è¶…å‡º prompt æˆ–å†…ç½®è®­ç»ƒçš„ä¿¡æ¯æ—¶ï¼Œå®ƒä¼šå¯¹ Elasticsearch è¿›è¡Œè¯­ä¹‰æ£€ç´¢ï¼Œå¹¶å°†æœ€ç›¸å…³çš„ç»“æœæ³¨å…¥åˆ° prompt ä¸­ä½œä¸ºä¸Šä¸‹æ–‡ã€‚è¿™æ ·ï¼Œæ¨¡å‹çš„æœ‰æ•ˆä¸Šä¸‹æ–‡ä¸ä»…åŒ…æ‹¬æœ€è¿‘å¯¹è¯ï¼ˆçŸ­æœŸè®°å¿†ï¼‰ï¼Œè¿˜åŒ…æ‹¬å³æ—¶è·å–çš„ç›¸å…³é•¿æœŸäº‹å®ã€‚LLM éšååŸºäºè‡ªèº«æ¨ç†å’Œæ£€ç´¢åˆ°çš„ä¿¡æ¯æ¥ç”Ÿæˆå›ç­”ï¼Œæœ‰æ•ˆåœ°ç»“åˆçŸ­æœŸè®°å¿†å’Œé•¿æœŸè®°å¿†ï¼Œä»è€Œæä¾›æ›´å‡†ç¡®ã€ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å“åº”ã€‚</p>
<p><strong>Elasticsearch</strong> å¯ä»¥ç”¨äºä¸º AI agent å®ç°é•¿æœŸè®°å¿†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªé«˜çº§ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä» Elasticsearch ä¸­æ£€ç´¢ä¸Šä¸‹æ–‡ä»¥å®ç°é•¿æœŸè®°å¿†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/14432fb8d97745118733b3eb0c5d52f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=UrGN7f27dhP0pwrGcozYJpVudeU%3D" alt="" loading="lazy"/></p>
<p>è¿™æ ·ï¼Œagent é€šè¿‡æœç´¢ç›¸å…³æ•°æ®æ¥ â€œè®°ä½â€ï¼Œè€Œä¸æ˜¯æŠŠæ‰€æœ‰å†…å®¹éƒ½å­˜å‚¨åœ¨æœ‰é™çš„ prompt ä¸­ï¼Œå¦åˆ™<strong>ä¼šå¸¦æ¥ä¸åŒé£é™©</strong>ã€‚</p>
<h3 data-id="heading-3">ä½¿ç”¨ RAG é…åˆ Elasticsearch æˆ–ä»»ä½•å‘é‡å­˜å‚¨æœ‰å¤šä¸ªå¥½å¤„ï¼š</h3>
<p>é¦–å…ˆï¼Œå®ƒå°†æ¨¡å‹çš„çŸ¥è¯†æ‰©å±•åˆ°è®­ç»ƒæˆªæ­¢æ—¥æœŸä¹‹å¤–ã€‚agent å¯ä»¥æ£€ç´¢ LLM å¯èƒ½ä¸çŸ¥é“çš„æœ€æ–°ä¿¡æ¯æˆ–ç‰¹å®šé¢†åŸŸæ•°æ®ã€‚è¿™å¯¹äºæ¶‰åŠè¿‘æœŸäº‹ä»¶æˆ–ä¸“ä¸šä¸»é¢˜çš„é—®é¢˜è‡³å…³é‡è¦ã€‚</p>
<p>å…¶æ¬¡ï¼ŒæŒ‰éœ€æ£€ç´¢ä¸Šä¸‹æ–‡æœ‰åŠ©äºå‡å°‘å¹»è§‰ï¼Œå°¤å…¶æ˜¯å› ä¸º LLM æ²¡æœ‰é’ˆå¯¹ä½ ç‰¹å®šç”¨ä¾‹ä¸­çš„ä¸“æœ‰æˆ–é«˜åº¦ä¸“ä¸šåŒ–æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œè¿™å¾ˆå¯èƒ½å¯¼è‡´å¹»è§‰ã€‚ä¸å…¶è®© LLM æ ¹æ®è¯„ä¼°æ¿€åŠ±å»çŒœæµ‹æˆ–è™šæ„ä¿¡æ¯ï¼ˆå¦‚æœ€è¿‘ OpenAI è®ºæ–‡ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2509.04664" title="https://arxiv.org/pdf/2509.04664" target="_blank" ref="nofollow noopener noreferrer">Why Language Models Hallucinate</a>ã€‹æŒ‡å‡ºçš„ï¼‰ï¼Œæ¨¡å‹å¯ä»¥é€šè¿‡æ¥è‡ª Elasticsearch çš„äº‹å®å¼•ç”¨æ¥è½åœ°ã€‚è‡ªç„¶åœ°ï¼ŒLLM çš„å¯é æ€§ä¾èµ–äºå‘é‡å­˜å‚¨ä¸­æ•°æ®çš„å‡†ç¡®æ€§ï¼Œç›¸å…³æ•°æ®ä¼šæ ¹æ®æ ¸å¿ƒç›¸å…³æ€§æŒ‡æ ‡è¢«æ£€ç´¢å‡ºæ¥ã€‚</p>
<p>ç¬¬ä¸‰ï¼ŒRAG å…è®¸ agent ä½¿ç”¨è¿œå¤§äºä»»ä½• prompt å®¹é‡çš„çŸ¥è¯†åº“ã€‚æ— éœ€å°†æ•´ç¯‡æ–‡æ¡£ï¼ˆå¦‚é•¿ç¯‡ç ”ç©¶è®ºæ–‡æˆ–æ”¿ç­–æ–‡ä»¶ï¼‰æ¨å…¥ä¸Šä¸‹æ–‡çª—å£è€Œå†’ç€è¿‡è½½æˆ–æ— å…³<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.google.com%2Fdocument%2Fd%2F15je2KBUgkYKuR2jxGVCGVaa2UhXzwL11cTv8ikC1-z8%2Fedit%3Ftab%3Dt.0%23heading%3Dh.p9dxm9xxrnvp" title="https://docs.google.com/document/d/15je2KBUgkYKuR2jxGVCGVaa2UhXzwL11cTv8ikC1-z8/edit?tab=t.0#heading=h.p9dxm9xxrnvp" target="_blank" ref="nofollow noopener noreferrer">ä¸Šä¸‹æ–‡ä¿¡æ¯æ±¡æŸ“</a>æ¨¡å‹æ¨ç†çš„é£é™©ï¼ŒRAG ä½¿ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F152072259" title="https://elasticstack.blog.csdn.net/article/details/152072259" target="_blank" ref="nofollow noopener noreferrer">åˆ†å—</a>ç­–ç•¥ã€‚å¤§å‹æ–‡æ¡£è¢«æ‹†åˆ†ä¸ºè¾ƒå°ã€è¯­ä¹‰æ˜ç¡®çš„ç‰‡æ®µï¼Œç³»ç»Ÿåªæ£€ç´¢ä¸æŸ¥è¯¢æœ€ç›¸å…³çš„å‡ ä¸ªç‰‡æ®µã€‚è¿™æ ·ï¼Œæ¨¡å‹æ— éœ€ç™¾ä¸‡ token çš„ä¸Šä¸‹æ–‡å°±èƒ½æ˜¾å¾—çŸ¥è¯†ä¸°å¯Œï¼›åªéœ€è®¿é—®æ›´å¤§è¯­æ–™åº“ä¸­æ­£ç¡®çš„ç‰‡æ®µå³å¯ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/630535cbca7f423fb7d47c0269b03be7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=%2FPdPVCNBY1%2BjuKsUudwXoiWwqqA%3D" alt="" loading="lazy"/> Image source:Â  <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.meibel.ai%2Fpost%2Funderstanding-the-impact-of-increasing-llm-context-windows" title="https://www.meibel.ai/post/understanding-the-impact-of-increasing-llm-context-windows" target="_blank" ref="nofollow noopener noreferrer">www.meibel.ai/post/undersâ€¦</a></p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œéšç€ LLM ä¸Šä¸‹æ–‡çª—å£çš„å¢å¤§ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fnews%2F1m-context" title="https://www.anthropic.com/news/1m-context" target="_blank" ref="nofollow noopener noreferrer">ä¸€äº›æ¨¡å‹ç°åœ¨æ”¯æŒæ•°åä¸‡ç”šè‡³æ•°ç™¾ä¸‡ token</a>ï¼‰ï¼Œå…³äº RAG æ˜¯å¦ â€œè¿‡æ—¶â€ çš„è®¨è®ºå‡ºç°äº†ã€‚ä¸ºä»€ä¹ˆä¸æŠŠæ‰€æœ‰æ•°æ®éƒ½æ”¾å…¥ prompt å‘¢ï¼Ÿå¦‚æœä½ ä¹Ÿæœ‰ç±»ä¼¼æƒ³æ³•ï¼Œå¯ä»¥å‚è€ƒæˆ‘åŒäº‹ Jeffrey Rengifo å’Œ Eduard Martin çš„ç²¾å½©æ–‡ç« ã€Š<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F149288509" title="https://elasticstack.blog.csdn.net/article/details/149288509" target="_blank" ref="nofollow noopener noreferrer">ä¸Šä¸‹æ–‡æ›´é•¿ â‰  æ›´å¥½ï¼šä¸ºä»€ä¹ˆ RAG ä»ç„¶é‡è¦</a>ã€‹ã€‚è¿™ç§æ–¹æ³•é¿å…äº† â€œåƒåœ¾è¿›ï¼Œåƒåœ¾å‡ºâ€ çš„é—®é¢˜ï¼šLLM å…³æ³¨å°‘é‡é‡è¦ç‰‡æ®µï¼Œè€Œä¸æ˜¯å¤„ç†å¤§é‡å™ªå£°ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå°† Elasticsearch æˆ–ä»»ä½•å‘é‡å­˜å‚¨é›†æˆåˆ° AI agent æ¶æ„ä¸­ï¼Œå¯ä»¥æä¾›<strong>é•¿æœŸè®°å¿†</strong>ã€‚agent å°†çŸ¥è¯†å­˜å‚¨åœ¨å¤–éƒ¨ï¼Œå¹¶åœ¨éœ€è¦æ—¶æ‹‰å…¥ä½œä¸ºè®°å¿†ä¸Šä¸‹æ–‡ã€‚è¿™å¯ä»¥å®ç°ä¸ºä¸€ç§æ¶æ„ï¼šæ¯æ¬¡ç”¨æˆ·æŸ¥è¯¢åï¼Œagent åœ¨ Elasticsearch ä¸­æœç´¢ç›¸å…³ä¿¡æ¯ï¼Œç„¶åå°†æœ€ç›¸å…³ç»“æœè¿½åŠ åˆ° prompt ä¸­ï¼Œå†è°ƒç”¨ LLMã€‚å¦‚æœå›ç­”åŒ…å«æœ‰ç”¨çš„æ–°ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥å°†å…¶ä¿å­˜å›é•¿æœŸå­˜å‚¨ï¼ˆå½¢æˆå­¦ä¹ çš„åé¦ˆå¾ªç¯ï¼‰ã€‚é€šè¿‡ä½¿ç”¨è¿™ç§åŸºäºæ£€ç´¢çš„è®°å¿†ï¼Œagent å¯ä»¥ä¿æŒä¿¡æ¯æ›´æ–°ï¼Œæ— éœ€åœ¨æ¯ä¸ª prompt ä¸­å¡å…¥å®ƒçŸ¥é“çš„æ‰€æœ‰å†…å®¹ï¼Œå³ä¾¿ä¸Šä¸‹æ–‡çª—å£æ”¯æŒä¸€ç™¾ä¸‡ tokenã€‚è¿™ä¸€æŠ€æœ¯æ˜¯ä¸Šä¸‹æ–‡å·¥ç¨‹çš„åŸºçŸ³ï¼Œç»“åˆäº†ä¿¡æ¯æ£€ç´¢å’Œç”Ÿæˆå¼ AI çš„ä¼˜åŠ¿ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ LangGraph checkpoint ç³»ç»Ÿåœ¨ä¼šè¯æœŸé—´ç®¡ç†çŸ­æœŸè®°å¿†çš„å†…å­˜å¯¹è¯çŠ¶æ€ç¤ºä¾‹ã€‚ï¼ˆå‚è€ƒæˆ‘ä»¬çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FsomeshwaranM%2Felastic-context-engineering-short-term-long-term-memory" title="https://github.com/someshwaranM/elastic-context-engineering-short-term-long-term-memory" target="_blank" ref="nofollow noopener noreferrer">ä¸Šä¸‹æ–‡å·¥ç¨‹æ”¯æŒåº”ç”¨</a>ã€‚ï¼‰</p>
<pre><code class="hljs language-ini" lang="ini">`

1.  <span class="hljs-comment"># Initialize chat memory (<span class="hljs-doctag">Note:</span> This is in-memory only, not persistent)</span>
<span class="hljs-attr">2.  memory</span> = MemorySaver()

4.  <span class="hljs-comment"># Create a LangGraph agent</span>
<span class="hljs-attr">5.  langgraph_agent</span> = create_react_agent(model=llm, tools=tools, checkpointer=memory)

7.  ...
8.  ...
9.  <span class="hljs-comment"># Only process and display checkpoints if verbose mode is enabled</span>
10.  if args.verbose:
11.      <span class="hljs-comment"># List all checkpoints that match a given configuration</span>
<span class="hljs-attr">12.      checkpoints</span> = memory.list({<span class="hljs-string">"configurable"</span>: {<span class="hljs-string">"thread_id"</span>: <span class="hljs-string">"1"</span>}})
13.      <span class="hljs-comment"># Process the checkpoints</span>
14.      process_checkpoints(checkpoints)

`AIå†™ä»£ç !<span class="hljs-section">[]</span>(https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p>ä»¥ä¸‹æ˜¯å®ƒå¦‚ä½•å­˜å‚¨ checkpoint çš„æ–¹å¼ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">`</span>

<span class="hljs-attr">1.  Checkpoint:</span>
<span class="hljs-attr">2.  Timestamp:</span> <span class="hljs-number">2025-12-30T09:19:41.691087+00:00</span>
<span class="hljs-attr">3.  Checkpoint ID:</span> <span class="hljs-string">1f0e560a-c2fa-69ec-8001-14ee5373f9cf</span>
<span class="hljs-attr">4.  User:</span> <span class="hljs-string">Hi</span> <span class="hljs-string">I'm</span> <span class="hljs-string">Som,</span> <span class="hljs-string">how</span> <span class="hljs-string">are</span> <span class="hljs-string">you?</span> <span class="hljs-string">(Message</span> <span class="hljs-attr">ID:</span> <span class="hljs-string">ad0a8415-5392-4a58-85ad-84154875bbf2)</span>
<span class="hljs-attr">5.  Agent:</span> <span class="hljs-string">Hi</span> <span class="hljs-string">Som!</span> <span class="hljs-string">I'm</span> <span class="hljs-string">doing</span> <span class="hljs-string">well,</span> <span class="hljs-string">thank</span> <span class="hljs-string">you!</span> <span class="hljs-string">How</span> <span class="hljs-string">about</span> <span class="hljs-string">you?</span> <span class="hljs-string">(Message</span> <span class="hljs-attr">ID:</span> 
<span class="hljs-number">6</span><span class="hljs-string">.</span>  <span class="hljs-string">56d31efb-14e3-4148-806e-24a839799ece)</span>
<span class="hljs-attr">7.  Agent:</span>  <span class="hljs-string">(Message</span> <span class="hljs-attr">ID:</span> <span class="hljs-string">lc_run--019b6e8e-553f-7b52-8796-a8b1fbb206a4-0)</span>

<span class="hljs-attr">9.  Checkpoint:</span>
<span class="hljs-attr">10.  Timestamp:</span> <span class="hljs-number">2025-12-30T09:19:40.350507+00:00</span>
<span class="hljs-attr">11.  Checkpoint ID:</span> <span class="hljs-string">1f0e560a-b631-6a08-8000-7796d108109a</span>
<span class="hljs-attr">12.  User:</span> <span class="hljs-string">Hi</span> <span class="hljs-string">I'm</span> <span class="hljs-string">Som,</span> <span class="hljs-string">how</span> <span class="hljs-string">are</span> <span class="hljs-string">you?</span> <span class="hljs-string">(Message</span> <span class="hljs-attr">ID:</span> <span class="hljs-string">ad0a8415-5392-4a58-85ad-84154875bbf2)</span>
<span class="hljs-attr">13.  Agent:</span> <span class="hljs-string">Hi</span> <span class="hljs-string">Som!</span> <span class="hljs-string">I'm</span> <span class="hljs-string">doing</span> <span class="hljs-string">well,</span> <span class="hljs-string">thank</span> <span class="hljs-string">you!</span> <span class="hljs-string">How</span> <span class="hljs-string">about</span> <span class="hljs-string">you?</span> <span class="hljs-string">(Message</span> <span class="hljs-attr">ID:</span> 
<span class="hljs-number">14</span><span class="hljs-string">.</span>  <span class="hljs-string">56d31efb-14e3-4148-806e-24a839799ece)</span>

<span class="hljs-attr">16.  Checkpoint:</span>
<span class="hljs-attr">17.  Timestamp:</span> <span class="hljs-number">2025-12-30T09:19:40.349027+00:00</span>
<span class="hljs-attr">18.  Checkpoint ID:</span> <span class="hljs-string">1f0e560a-b62e-6010-bfff-cbebe1d865f6</span>

<span class="hljs-string">`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)</span>
</code></pre>
<p>å¯¹äºé•¿æœŸè®°å¿†ï¼Œä»¥ä¸‹æ˜¯æˆ‘ä»¬å¦‚ä½•åœ¨ Elasticsearch ä¸Šæ‰§è¡Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F145485873" title="https://elasticstack.blog.csdn.net/article/details/145485873" target="_blank" ref="nofollow noopener noreferrer">è¯­ä¹‰æœç´¢</a>ï¼šåœ¨å°† checkpoint æ€»ç»“å¹¶ç´¢å¼•åˆ° Elasticsearch åï¼Œä½¿ç”¨å‘é‡åµŒå…¥ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Felasticstack.blog.csdn.net%2Farticle%2Fdetails%2F134748014" title="https://elasticstack.blog.csdn.net/article/details/134748014" target="_blank" ref="nofollow noopener noreferrer">vector embeddings</a>Â ï¼‰æ£€ç´¢ç›¸å…³çš„å†å²å¯¹è¯ã€‚</p>
<pre><code class="hljs language-python" lang="python">`

<span class="hljs-number">1.</span>  Functions: 
<span class="hljs-number">2.</span>  retrieve_from_elasticsearch() 

<span class="hljs-number">4.</span>  <span class="hljs-comment"># Enhanced Elasticsearch retrieval with rank_window and verbose display</span>
<span class="hljs-number">5.</span>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">retrieve_from_elasticsearch</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span>, k: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span>, rank_window: <span class="hljs-built_in">int</span> = <span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">tuple</span>[<span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>]], <span class="hljs-built_in">str</span>]:
<span class="hljs-number">6.</span>      <span class="hljs-string">"""
7.      Retrieve context from Elasticsearch with score-based ranking

9.      Args:
10.          query: Search query
11.          k: Number of results to return
12.          rank_window: Number of candidates to retrieve before ranking (default: args.rank_window)

14.      Returns:
15.          Tuple of (retrieved_documents, formatted_context_string)
16.      """</span>
<span class="hljs-number">17.</span>      <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> es_client <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> es_index_name:
<span class="hljs-number">18.</span>          <span class="hljs-keyword">return</span> [], <span class="hljs-string">"Elasticsearch is not available. Cannot search long-term memory."</span>

<span class="hljs-number">20.</span>      <span class="hljs-keyword">if</span> rank_window <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
<span class="hljs-number">21.</span>          rank_window = args.rank_window

<span class="hljs-number">23.</span>      <span class="hljs-keyword">try</span>:
<span class="hljs-number">24.</span>          <span class="hljs-comment"># Check if index exists and has documents</span>
<span class="hljs-number">25.</span>          <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> es_client.indices.exists(index=es_index_name):
<span class="hljs-number">26.</span>              <span class="hljs-keyword">return</span> [], <span class="hljs-string">"No previous conversations stored in long-term memory yet."</span>

<span class="hljs-number">28.</span>          <span class="hljs-comment"># Get document count</span>
<span class="hljs-number">29.</span>          <span class="hljs-keyword">try</span>:
<span class="hljs-number">30.</span>              doc_count = es_client.count(index=es_index_name)[<span class="hljs-string">"count"</span>]
<span class="hljs-number">31.</span>              <span class="hljs-keyword">if</span> doc_count == <span class="hljs-number">0</span>:
<span class="hljs-number">32.</span>                  <span class="hljs-keyword">return</span> [], <span class="hljs-string">"Long-term memory is empty. No previous conversations to search."</span>
<span class="hljs-number">33.</span>          <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
<span class="hljs-number">34.</span>              <span class="hljs-keyword">return</span> [], <span class="hljs-string">f"Error checking memory: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>

<span class="hljs-number">36.</span>          <span class="hljs-comment"># Generate embedding for the query</span>
<span class="hljs-number">37.</span>          <span class="hljs-keyword">try</span>:
<span class="hljs-number">38.</span>              query_embedding = embeddings.embed_query(query)
<span class="hljs-number">39.</span>          <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
<span class="hljs-number">40.</span>              <span class="hljs-keyword">return</span> [], <span class="hljs-string">f"Error generating embedding: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>

<span class="hljs-number">42.</span>          <span class="hljs-comment"># Perform semantic search using kNN with rank_window</span>
<span class="hljs-number">43.</span>          <span class="hljs-keyword">try</span>:
<span class="hljs-number">44.</span>              search_body = {
<span class="hljs-number">45.</span>                  <span class="hljs-string">"knn"</span>: {
<span class="hljs-number">46.</span>                      <span class="hljs-string">"field"</span>: <span class="hljs-string">"vector"</span>,
<span class="hljs-number">47.</span>                      <span class="hljs-string">"query_vector"</span>: query_embedding,
<span class="hljs-number">48.</span>                      <span class="hljs-string">"k"</span>: k,
<span class="hljs-number">49.</span>                      <span class="hljs-string">"num_candidates"</span>: rank_window  <span class="hljs-comment"># Retrieve more candidates, then rank top k</span>
<span class="hljs-number">50.</span>                  },
<span class="hljs-number">51.</span>                  <span class="hljs-string">"_source"</span>: [<span class="hljs-string">"text"</span>, <span class="hljs-string">"content"</span>, <span class="hljs-string">"message_type"</span>, <span class="hljs-string">"timestamp"</span>, <span class="hljs-string">"thread_id"</span>],
<span class="hljs-number">52.</span>                  <span class="hljs-string">"size"</span>: k
<span class="hljs-number">53.</span>              }

<span class="hljs-number">55.</span>              response = es_client.search(index=es_index_name, body=search_body)

<span class="hljs-number">57.</span>              <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> response.get(<span class="hljs-string">"hits"</span>) <span class="hljs-keyword">or</span> <span class="hljs-built_in">len</span>(response[<span class="hljs-string">"hits"</span>][<span class="hljs-string">"hits"</span>]) == <span class="hljs-number">0</span>:
<span class="hljs-number">58.</span>                  <span class="hljs-keyword">return</span> [], <span class="hljs-string">"No relevant previous conversations found in long-term memory."</span>

<span class="hljs-number">60.</span>              <span class="hljs-comment"># Extract documents with scores</span>
<span class="hljs-number">61.</span>              retrieved_docs = []
<span class="hljs-number">62.</span>              <span class="hljs-keyword">for</span> hit <span class="hljs-keyword">in</span> response[<span class="hljs-string">"hits"</span>][<span class="hljs-string">"hits"</span>]:
<span class="hljs-number">63.</span>                  source = hit[<span class="hljs-string">"_source"</span>]
<span class="hljs-number">64.</span>                  score = hit[<span class="hljs-string">"_score"</span>]
<span class="hljs-number">65.</span>                  retrieved_docs.append({
<span class="hljs-number">66.</span>                      <span class="hljs-string">"content"</span>: source.get(<span class="hljs-string">"content"</span>, source.get(<span class="hljs-string">"text"</span>, <span class="hljs-string">""</span>)),
<span class="hljs-number">67.</span>                      <span class="hljs-string">"message_type"</span>: source.get(<span class="hljs-string">"message_type"</span>, <span class="hljs-string">"unknown"</span>),
<span class="hljs-number">68.</span>                      <span class="hljs-string">"timestamp"</span>: source.get(<span class="hljs-string">"timestamp"</span>, <span class="hljs-string">"unknown"</span>),
<span class="hljs-number">69.</span>                      <span class="hljs-string">"thread_id"</span>: source.get(<span class="hljs-string">"thread_id"</span>, <span class="hljs-string">"unknown"</span>),
<span class="hljs-number">70.</span>                      <span class="hljs-string">"score"</span>: score
<span class="hljs-number">71.</span>                  })

<span class="hljs-number">73.</span>              <span class="hljs-comment"># Format context string</span>
<span class="hljs-number">74.</span>              context_parts = []
<span class="hljs-number">75.</span>              <span class="hljs-keyword">for</span> i, doc <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(retrieved_docs, <span class="hljs-number">1</span>):
<span class="hljs-number">76.</span>                  context_parts.append(doc[<span class="hljs-string">"content"</span>])

<span class="hljs-number">78.</span>              context_string = <span class="hljs-string">"\n\n"</span>.join(context_parts)

<span class="hljs-number">80.</span>              <span class="hljs-comment"># Verbose display</span>
<span class="hljs-number">81.</span>              <span class="hljs-keyword">if</span> args.verbose:
<span class="hljs-number">82.</span>                  rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n[bold yellow]ğŸ” RETRIEVAL ANALYSIS[/bold yellow]"</span>)
<span class="hljs-number">83.</span>                  rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">"="</span>*<span class="hljs-number">80</span>)
<span class="hljs-number">84.</span>                  rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[blue]Query:[/blue] <span class="hljs-subst">{query}</span>"</span>)
<span class="hljs-number">85.</span>                  rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[blue]Retrieved:[/blue] <span class="hljs-subst">{<span class="hljs-built_in">len</span>(retrieved_docs)}</span> documents (from <span class="hljs-subst">{rank_window}</span> candidates)"</span>)
<span class="hljs-number">86.</span>                  rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[blue]Total context length:[/blue] <span class="hljs-subst">{<span class="hljs-built_in">len</span>(context_string)}</span> characters\n"</span>)

<span class="hljs-number">88.</span>                  <span class="hljs-keyword">for</span> i, doc <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(retrieved_docs, <span class="hljs-number">1</span>):
<span class="hljs-number">89.</span>                      rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[cyan]ğŸ“„ Document <span class="hljs-subst">{i}</span> | Score: <span class="hljs-subst">{doc[<span class="hljs-string">'score'</span>]:<span class="hljs-number">.4</span>f}</span> | Type: <span class="hljs-subst">{doc[<span class="hljs-string">'message_type'</span>]}</span>[/cyan]"</span>)
<span class="hljs-number">90.</span>                      rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[cyan]   Timestamp: <span class="hljs-subst">{doc[<span class="hljs-string">'timestamp'</span>]}</span> | Thread: <span class="hljs-subst">{doc[<span class="hljs-string">'thread_id'</span>]}</span>[/cyan]"</span>)
<span class="hljs-number">91.</span>                      content_preview = doc[<span class="hljs-string">'content'</span>][:<span class="hljs-number">200</span>] + <span class="hljs-string">"..."</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(doc[<span class="hljs-string">'content'</span>]) &gt; <span class="hljs-number">200</span> <span class="hljs-keyword">else</span> doc[<span class="hljs-string">'content'</span>]
<span class="hljs-number">92.</span>                      rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[cyan]   Content: <span class="hljs-subst">{content_preview}</span>[/cyan]"</span>)
<span class="hljs-number">93.</span>                      rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">80</span>)

<span class="hljs-number">95.</span>              <span class="hljs-keyword">return</span> retrieved_docs, context_string

<span class="hljs-number">97.</span>          <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
<span class="hljs-number">98.</span>              <span class="hljs-keyword">return</span> [], <span class="hljs-string">f"Error searching memory: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>

<span class="hljs-number">100.</span>      <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
<span class="hljs-number">101.</span>          <span class="hljs-keyword">return</span> [], <span class="hljs-string">f"Error accessing long-term memory: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)æ”¶èµ·ä»£ç å—![](https://csdnimg.cn/release/blogv2/dist/pc/img/arrowup-line-top-White.png)
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨ LangGraph çš„ checkpoint åœ¨ Elasticsearch ä¸­ç´¢å¼•å’Œè·å–çŸ­æœŸè®°å¿†ä¸é•¿æœŸè®°å¿†ï¼Œè®©æˆ‘ä»¬èŠ±ç‚¹æ—¶é—´ç†è§£ä¸ºä»€ä¹ˆç´¢å¼•å’Œå¯¼å‡ºå®Œæ•´å¯¹è¯å¯èƒ½å­˜åœ¨é£é™©ã€‚</p>
<h2 data-id="heading-4">ä¸ç®¡ç†ä¸Šä¸‹æ–‡è®°å¿†çš„é£é™©</h2>
<p>åœ¨è®¨è®ºä¸Šä¸‹æ–‡å·¥ç¨‹ï¼Œä»¥åŠçŸ­æœŸè®°å¿†å’Œé•¿æœŸè®°å¿†æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½å¦‚æœä¸å¦¥å–„ç®¡ç† agent çš„è®°å¿†å’Œä¸Šä¸‹æ–‡ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p>
<p>ä¸å¹¸çš„æ˜¯ï¼Œå½“ AI çš„ä¸Šä¸‹æ–‡å˜å¾—éå¸¸é•¿æˆ–åŒ…å«é”™è¯¯ä¿¡æ¯æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°å¾ˆå¤šé—®é¢˜ã€‚éšç€ä¸Šä¸‹æ–‡çª—å£å¢å¤§ï¼Œä¼šå‡ºç°<strong>æ–°çš„å¤±è´¥æ¨¡å¼</strong>ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ä¸Šä¸‹æ–‡æ±¡æŸ“</li>
<li>ä¸Šä¸‹æ–‡åˆ†å¿ƒ</li>
<li>ä¸Šä¸‹æ–‡æ··æ·†</li>
<li>ä¸Šä¸‹æ–‡å†²çª</li>
<li>ä¸Šä¸‹æ–‡æ³„éœ²å’ŒçŸ¥è¯†å†²çª</li>
<li>å¹»è§‰å’Œé”™è¯¯ä¿¡æ¯</li>
</ul>
<p>è®©æˆ‘ä»¬åˆ†è§£è¿™äº›é—®é¢˜ï¼Œä»¥åŠç”±äºä¸Šä¸‹æ–‡ç®¡ç†ä¸å½“å¯èƒ½äº§ç”Ÿçš„å…¶ä»–é£é™©ï¼š</p>
<h3 data-id="heading-5">ä¸Šä¸‹æ–‡æ±¡æŸ“</h3>
<p>ä¸Šä¸‹æ–‡æ±¡æŸ“æŒ‡é”™è¯¯æˆ–æœ‰å®³ä¿¡æ¯è¿›å…¥ä¸Šä¸‹æ–‡å¹¶ â€œæ±¡æŸ“â€ æ¨¡å‹åç»­è¾“å‡ºã€‚ä¸€ä¸ªå¸¸è§ä¾‹å­æ˜¯æ¨¡å‹äº§ç”Ÿçš„å¹»è§‰è¢«å½“ä½œäº‹å®ï¼Œæ’å…¥å¯¹è¯å†å²ä¸­ã€‚æ¨¡å‹éšåå¯èƒ½åœ¨åç»­å›ç­”ä¸­åŸºäºè¯¥é”™è¯¯ç»§ç»­æ¨ç†ï¼Œé”™è¯¯ä¸æ–­ç´¯ç§¯ã€‚åœ¨è¿­ä»£ agent å¾ªç¯ä¸­ï¼Œä¸€æ—¦é”™è¯¯ä¿¡æ¯è¿›å…¥å…±äº«ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚åœ¨ agent å·¥ä½œç¬”è®°çš„æ€»ç»“ä¸­ï¼‰ï¼Œå®ƒå¯èƒ½è¢«åå¤å¼ºåŒ–ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fstorage.googleapis.com%2Fdeepmind-media%2Fgemini%2Fgemini_v2_5_report.pdf" title="https://storage.googleapis.com/deepmind-media/gemini/gemini_v2_5_report.pdf" target="_blank" ref="nofollow noopener noreferrer">DeepMind çš„ç ”ç©¶äººå‘˜åœ¨å‘å¸ƒ Gemini 2.5 æŠ¥å‘Šæ—¶</a>ï¼ˆæ‘˜è¦ï¼Œå¯æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.dbreunig.com%2F2025%2F06%2F17%2Fan-agentic-case-study-playing-pok%25C3%25A9mon-with-gemini.html" title="https://www.dbreunig.com/2025/06/17/an-agentic-case-study-playing-pok%C3%A9mon-with-gemini.html" target="_blank" ref="nofollow noopener noreferrer">æ­¤å¤„</a>ï¼‰è§‚å¯Ÿåˆ°ï¼Œä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„ PokÃ©mon ç©æ¸¸æˆ agent ä¸­å‡ºç°äº†è¿™ç§æƒ…å†µï¼šå¦‚æœ agent å¹»è§‰äº†é”™è¯¯çš„æ¸¸æˆçŠ¶æ€ï¼Œå¹¶ä¸”è¯¥çŠ¶æ€è¢«è®°å½•åœ¨ä¸Šä¸‹æ–‡ä¸­ï¼ˆå®ƒçš„ç›®æ ‡è®°å¿†ï¼‰ï¼Œagent ä¼šå›´ç»•ä¸€ä¸ªä¸å¯èƒ½å®ç°çš„ç›®æ ‡å½¢æˆ<strong>è’è°¬ç­–ç•¥</strong>å¹¶é™·å…¥å›°å¢ƒã€‚æ¢å¥è¯è¯´ï¼Œè¢«æ±¡æŸ“çš„è®°å¿†å¯èƒ½è®© agent æ— ä¼‘æ­¢åœ°èµ°å‘é”™è¯¯è·¯å¾„ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1272ac46d4e04c52a0aa64dba15d6053~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=ONfrl7N4Qw33Ap0moS2UbmZg5vU%3D" alt="" loading="lazy"/> agent å·¥å…·æ¦‚è§ˆï¼ˆZhang, 2025ï¼‰ã€‚å¤§åœ°å›¾çš„è¿·é›¾ç³»ç»Ÿåœ¨æ¢ç´¢è¿‡çš„åŒºåŸŸä¼šè‡ªåŠ¨å­˜å‚¨è¯¥æ ¼å­ï¼Œå¹¶æ ‡è®°è®¿é—®è®¡æ•°å™¨ã€‚æ ¼å­ç±»å‹ä» RAM ä¸­è®°å½•ã€‚agent å·¥å…·ï¼ˆpathfinderã€boulder_puzzle_strategistï¼‰æ˜¯ Gemini 2.5 Pro çš„æç¤ºå®ä¾‹ã€‚pathfinder ç”¨äºå¯¼èˆªï¼Œboulder_puzzle_strategist ç”¨äºè§£å†³ Victory Road åœ°ä¸‹åŸçš„å²©çŸ³è°œé¢˜ã€‚<br/>
å›¾ç‰‡æ¥æºï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fstorage.googleapis.com%2Fdeepmind-media%2Fgemini%2Fgemini_v2_5_report.pdf" title="https://storage.googleapis.com/deepmind-media/gemini/gemini_v2_5_report.pdf" target="_blank" ref="nofollow noopener noreferrer">storage.googleapis.com/deepmind-meâ€¦</a> - ç¬¬68é¡µã€‚</p>
<p>ä¸Šä¸‹æ–‡æ±¡æŸ“å¯èƒ½æ— æ„å‘ç”Ÿï¼ˆå‡ºé”™ï¼‰æˆ–æ¶æ„å‘ç”Ÿï¼Œä¾‹å¦‚é€šè¿‡æç¤ºæ³¨å…¥æ”»å‡»ï¼ˆprompt injectionï¼‰ï¼Œç”¨æˆ·æˆ–ç¬¬ä¸‰æ–¹å·å·æ’å…¥éšè—æŒ‡ä»¤æˆ–é”™è¯¯ä¿¡æ¯ï¼Œä½¿ agent è®°ä½å¹¶æ‰§è¡Œã€‚</p>
<p><strong>æ¨èçš„å¯¹ç­–</strong>ï¼š</p>
<p>æ ¹æ® <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.wiz.io%2Facademy%2Fdata-poisoning" title="https://www.wiz.io/academy/data-poisoning" target="_blank" ref="nofollow noopener noreferrer">Wiz</a>ã€<a href="https://link.juejin.cn?target=https%3A%2F%2Fzerlo.net%2Fen%2Fblog%2Fwhat-is-llm-data-poisoning" title="https://zerlo.net/en/blog/what-is-llm-data-poisoning" target="_blank" ref="nofollow noopener noreferrer">Zerlo</a> å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fresearch%2Fsmall-samples-poison" title="https://www.anthropic.com/research/small-samples-poison" target="_blank" ref="nofollow noopener noreferrer">Anthropic</a> çš„è§è§£ï¼Œé˜²æ­¢ä¸Šä¸‹æ–‡æ±¡æŸ“çš„æªæ–½ä¾§é‡äºé˜»æ­¢é”™è¯¯æˆ–è¯¯å¯¼ä¿¡æ¯è¿›å…¥ LLM çš„ promptã€ä¸Šä¸‹æ–‡çª—å£æˆ–æ£€ç´¢æµç¨‹ã€‚å…³é”®æ­¥éª¤åŒ…æ‹¬ï¼š</p>
<ul>
<li>æŒç»­æ£€æŸ¥ä¸Šä¸‹æ–‡ï¼šç›‘æ§å¯¹è¯æˆ–æ£€ç´¢æ–‡æœ¬ï¼Œå‘ç°ä»»ä½•å¯ç–‘æˆ–æœ‰å®³å†…å®¹ï¼Œè€Œä¸ä»…ä»…æ˜¯åˆå§‹ promptã€‚</li>
<li>ä½¿ç”¨å¯ä¿¡æ¥æºï¼šæ ¹æ®å¯ä¿¡åº¦è¯„åˆ†æˆ–æ ‡è®°æ–‡æ¡£ï¼Œä½¿ç³»ç»Ÿåå¥½å¯é ä¿¡æ¯ï¼Œå¿½ç•¥ä½è¯„åˆ†æ•°æ®ã€‚</li>
<li>å‘ç°å¼‚å¸¸æ•°æ®ï¼šä½¿ç”¨å·¥å…·æ£€æµ‹å¥‡æ€ªã€å¼‚å¸¸æˆ–è¢«æ“æ§çš„å†…å®¹ï¼Œå¹¶åœ¨æ¨¡å‹ä½¿ç”¨å‰ç§»é™¤ã€‚</li>
<li>è¿‡æ»¤è¾“å…¥è¾“å‡ºï¼šå¢åŠ ä¿æŠ¤æªæ–½ï¼Œé˜²æ­¢æœ‰å®³æˆ–è¯¯å¯¼æ–‡æœ¬è½»æ˜“è¿›å…¥ç³»ç»Ÿæˆ–è¢«æ¨¡å‹é‡å¤ã€‚</li>
<li>ç”¨å¹²å‡€æ•°æ®æ›´æ–°æ¨¡å‹ï¼šå®šæœŸç”¨éªŒè¯è¿‡çš„ä¿¡æ¯åˆ·æ–°ç³»ç»Ÿï¼Œä»¥å¯¹æŠ—ä»»ä½•æ¼ç½‘çš„åæ•°æ®ã€‚</li>
<li>äººå·¥å¹²é¢„ï¼šè®©äººå®¡æ ¸é‡è¦è¾“å‡ºæˆ–å°†å…¶ä¸å·²çŸ¥å¯ä¿¡æ¥æºå¯¹æ¯”ã€‚</li>
</ul>
<p>ç®€å•çš„ç”¨æˆ·ä¹ æƒ¯ä¹Ÿæœ‰å¸®åŠ©ï¼Œæ¯”å¦‚é‡ç½®é•¿å¯¹è¯ï¼Œä»…åˆ†äº«ç›¸å…³ä¿¡æ¯ï¼Œå°†å¤æ‚ä»»åŠ¡æ‹†æˆå°æ­¥éª¤ï¼Œä»¥åŠåœ¨æ¨¡å‹å¤–ä¿æŒå¹²å‡€çš„ç¬”è®°ã€‚</p>
<p>è¿™äº›æªæ–½å…±åŒå½¢æˆåˆ†å±‚é˜²æŠ¤ï¼Œä¿æŠ¤ LLM å…å—ä¸Šä¸‹æ–‡æ±¡æŸ“ï¼Œä½¿è¾“å‡ºå‡†ç¡®å¯ä¿¡ã€‚</p>
<p>å¦‚æœæ²¡æœ‰ä¸Šè¿°å¯¹ç­–ï¼Œagent å¯èƒ½è®°ä½æ”»å‡»è€…æ’å…¥çš„æŒ‡ä»¤ï¼Œå¦‚å¿½ç•¥ä¹‹å‰çš„æŒ‡å—æˆ–æ— å…³äº‹å®ï¼Œä»è€Œäº§ç”Ÿæœ‰å®³è¾“å‡ºã€‚</p>
<h3 data-id="heading-6">ä¸Šä¸‹æ–‡å¹²æ‰°</h3>
<p>ä¸Šä¸‹æ–‡å¹²æ‰°æ˜¯æŒ‡ä¸Šä¸‹æ–‡å˜å¾—éå¸¸é•¿ï¼Œä»¥è‡³äºæ¨¡å‹è¿‡åº¦å…³æ³¨ä¸Šä¸‹æ–‡ï¼Œè€Œå¿½ç•¥äº†å®ƒåœ¨è®­ç»ƒä¸­å­¦åˆ°çš„çŸ¥è¯†ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œè¿™ç±»ä¼¼ç¾éš¾æ€§é—å¿˜ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCatastrophic_interference" title="https://en.wikipedia.org/wiki/Catastrophic_interference" target="_blank" ref="nofollow noopener noreferrer">catastrophic forgetting</a>ï¼‰ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å‹å®é™…ä¸Š â€œå¿˜è®°â€äº† å…¶åŸºç¡€çŸ¥è¯†ï¼Œè€Œè¿‡åº¦ä¾èµ–å‘ˆç°åœ¨å®ƒé¢å‰çš„ä¿¡æ¯ã€‚ä»¥å‰çš„ç ”ç©¶è¡¨æ˜ï¼Œå½“ prompt éå¸¸é•¿æ—¶ï¼ŒLLM å¾€å¾€ä¼šå¤±å»ç„¦ç‚¹ã€‚</p>
<p>ä¾‹å¦‚ï¼ŒGemini 2.5 agent æ”¯æŒç™¾ä¸‡ token çš„çª—å£ï¼Œä½†ä¸€æ—¦ä¸Šä¸‹æ–‡è¶…è¿‡æŸä¸ªç‚¹ï¼ˆå®éªŒä¸­çº¦ 100,000 tokenï¼‰ï¼Œå®ƒå°±å¼€å§‹<strong>è¿‡åˆ†é‡å¤è¿‡å»çš„æ“ä½œ</strong>ï¼Œè€Œä¸æ˜¯æå‡ºæ–°è§£å†³æ–¹æ¡ˆã€‚ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œagent æˆäº†å…¶åºå¤§å†å²çš„å›šå¾’ã€‚å®ƒä¸æ–­æŸ¥çœ‹é•¿é•¿çš„è¿‡å»æ“ä½œæ—¥å¿—ï¼ˆä¸Šä¸‹æ–‡ï¼‰å¹¶æ¨¡ä»¿ï¼Œè€Œä¸æ˜¯åˆ©ç”¨å…¶åŸºç¡€è®­ç»ƒçŸ¥è¯†æ¥åˆ¶å®šæ–°çš„åˆ›æ–°ç­–ç•¥ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ac2b8677f84495e8ec1e39d4dea18a3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=hp5m%2BB8rhbVJIZWipyu09h99TLY%3D" alt="" loading="lazy"/> Imgage source:Â  <a href="https://link.juejin.cn?target=https%3A%2F%2Fstorage.googleapis.com%2Fdeepmind-media%2Fgemini%2Fgemini_v2_5_report.pdf" title="https://storage.googleapis.com/deepmind-media/gemini/gemini_v2_5_report.pdf" target="_blank" ref="nofollow noopener noreferrer">storage.googleapis.com/deepmind-meâ€¦</a>Â - page18.</p>
<p>è¿™æ˜¯é€‚å¾—å…¶åçš„ã€‚æˆ‘ä»¬å¸Œæœ›æ¨¡å‹ä½¿ç”¨ç›¸å…³ä¸Šä¸‹æ–‡æ¥è¾…åŠ©æ¨ç†ï¼Œè€Œä¸æ˜¯è¦†ç›–å®ƒçš„æ€è€ƒèƒ½åŠ›ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå³ä½¿æ˜¯æ‹¥æœ‰å·¨å¤§çª—å£çš„æ¨¡å‹ï¼Œä¹Ÿä¼šå‡ºç°è¿™ç§ä¸Šä¸‹æ–‡è¡°å‡ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fresearch.trychroma.com%2Fcontext-rot" title="https://research.trychroma.com/context-rot" target="_blank" ref="nofollow noopener noreferrer">context rot</a>ï¼‰ï¼šéšç€æ·»åŠ çš„ token å¢å¤šï¼Œå…¶æ€§èƒ½ä¼šä¸å‡åŒ€ä¸‹é™ã€‚è¿™ä¼¼ä¹å­˜åœ¨ä¸€ä¸ªæ³¨æ„åŠ›é¢„ç®—ã€‚å°±åƒäººç±»çš„å·¥ä½œè®°å¿†æœ‰é™ä¸€æ ·ï¼ŒLLM å¯¹ token çš„å…³æ³¨èƒ½åŠ›æ˜¯æœ‰é™çš„ï¼Œå½“é¢„ç®—è¢«æ‹‰ä¼¸æ—¶ï¼Œå…¶ç²¾åº¦å’Œä¸“æ³¨åº¦ä¼šä¸‹é™ã€‚</p>
<p>ä½œä¸ºç¼“è§£æªæ–½ï¼Œå¯ä»¥é€šè¿‡åˆ†å—ï¼ˆchunkingï¼‰ã€å·¥ç¨‹åŒ–å…³é”®ä¿¡æ¯ã€å®šæœŸä¸Šä¸‹æ–‡æ€»ç»“ï¼Œä»¥åŠä½¿ç”¨è¯„åˆ†è¯„ä¼°å’Œç›‘æ§æŠ€æœ¯æ¥é˜²æ­¢ä¸Šä¸‹æ–‡å¹²æ‰°ã€‚</p>
<p>è¿™äº›æ–¹æ³•è®©æ¨¡å‹åœ¨ç›¸å…³ä¸Šä¸‹æ–‡å’ŒåŸºç¡€è®­ç»ƒä¹‹é—´ä¿æŒæ‰å®çš„åŸºç¡€ï¼Œé™ä½å¹²æ‰°é£é™©ï¼Œå¹¶æé«˜æ•´ä½“æ¨ç†è´¨é‡ã€‚</p>
<h3 data-id="heading-7">ä¸Šä¸‹æ–‡æ··æ·†</h3>
<p>ä¸Šä¸‹æ–‡æ··æ·†æ˜¯æŒ‡ä¸Šä¸‹æ–‡ä¸­å¤šä½™å†…å®¹è¢«æ¨¡å‹ç”¨äºç”Ÿæˆä½è´¨é‡å“åº”çš„æƒ…å†µã€‚ä¸€ä¸ªå…¸å‹ä¾‹å­æ˜¯ç»™ agent æä¾›å¤§é‡å·¥å…·æˆ– API å®šä¹‰ã€‚å¦‚æœè¿™äº›å·¥å…·ä¸­æœ‰è®¸å¤šä¸å½“å‰ä»»åŠ¡æ— å…³ï¼Œæ¨¡å‹ä»å¯èƒ½ä¸é€‚å½“åœ°å°è¯•ä½¿ç”¨å®ƒä»¬ï¼Œä»…ä»…å› ä¸ºå®ƒä»¬å‡ºç°åœ¨ä¸Šä¸‹æ–‡ä¸­ã€‚å®éªŒå‘ç°ï¼Œå¦‚æœæä¾›çš„å·¥å…·æˆ–æ–‡æ¡£è¶…è¿‡å®é™…éœ€è¦ï¼Œåè€Œä¼šæŸå®³æ€§èƒ½ã€‚agent å¯èƒ½å¼€å§‹å‡ºé”™ï¼Œæ¯”å¦‚è°ƒç”¨é”™è¯¯çš„å‡½æ•°æˆ–å¼•ç”¨æ— å…³æ–‡æœ¬ã€‚</p>
<p>åœ¨ä¸€ä¸ªæ¡ˆä¾‹ä¸­ï¼Œä¸€ä¸ªå°å‹ <strong>Llama 3.1 8B</strong> æ¨¡å‹åœ¨è€ƒè™‘ 46 ä¸ªå·¥å…·æ—¶ä»»åŠ¡å¤±è´¥ï¼Œä½†åªç»™ 19 ä¸ªå·¥å…·æ—¶å´æˆåŠŸã€‚é¢å¤–çš„å·¥å…·é€ æˆäº†æ··æ·†ï¼Œå³ä½¿ä¸Šä¸‹æ–‡é•¿åº¦åœ¨é™åˆ¶èŒƒå›´å†…ã€‚æ ¹æœ¬é—®é¢˜æ˜¯ï¼Œprompt ä¸­çš„ä»»ä½•ä¿¡æ¯éƒ½ä¼šè¢«æ¨¡å‹å…³æ³¨ã€‚å¦‚æœæ¨¡å‹ä¸çŸ¥é“è¦å¿½ç•¥æŸäº›å†…å®¹ï¼Œè¿™äº›å†…å®¹å¯èƒ½ä»¥ä¸å¸Œæœ›çš„æ–¹å¼å½±å“è¾“å‡ºã€‚æ— å…³ä¿¡æ¯å¯èƒ½ â€œæŠ¢èµ°â€ æ¨¡å‹çš„æ³¨æ„åŠ›ï¼Œä½¿å…¶åç¦»æ–¹å‘ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªæ— å…³æ–‡æ¡£å¯èƒ½å¯¼è‡´ agent å›ç­”ä¸é—®é¢˜ä¸åŒçš„å†…å®¹ï¼‰ã€‚ä¸Šä¸‹æ–‡æ··æ·†é€šå¸¸è¡¨ç°ä¸ºæ¨¡å‹ç”Ÿæˆèåˆæ— å…³ä¸Šä¸‹æ–‡çš„ä½è´¨é‡å“åº”ã€‚å‚è§ç ”ç©¶è®ºæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2411.15399" title="https://arxiv.org/pdf/2411.15399" target="_blank" ref="nofollow noopener noreferrer">å°‘å³æ˜¯å¤šï¼šä¼˜åŒ–è¾¹ç¼˜è®¾å¤‡ä¸ŠLLMæ‰§è¡Œçš„å‡½æ•°è°ƒç”¨</a>ã€‚</p>
<p>è¿™æé†’æˆ‘ä»¬ï¼Œæ›´å¤šçš„ä¸Šä¸‹æ–‡å¹¶ä¸æ€»æ˜¯æ›´å¥½ï¼Œå°¤å…¶æ˜¯å½“å®ƒæ²¡æœ‰ç»è¿‡ç›¸å…³æ€§<strong>ç­›é€‰</strong>æ—¶ã€‚</p>
<h3 data-id="heading-8">ä¸Šä¸‹æ–‡å†²çª</h3>
<p>ä¸Šä¸‹æ–‡å†²çªæ˜¯æŒ‡<strong>ä¸Šä¸‹æ–‡ä¸­çš„éƒ¨åˆ†ä¿¡æ¯å½¼æ­¤çŸ›ç›¾</strong>ï¼Œå¯¼è‡´å†…éƒ¨ä¸ä¸€è‡´ï¼Œä»è€Œå¹²æ‰°æ¨¡å‹çš„æ¨ç†ã€‚å½“ agent ç´¯ç§¯äº†å¤šä¸ªç›¸äº’å†²çªçš„ä¿¡æ¯æ—¶ï¼Œå°±å¯èƒ½å‘ç”Ÿå†²çªã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ª agent ä»ä¸¤ä¸ªæ¥æºè·å–æ•°æ®ï¼šä¸€ä¸ªè¯´èˆªç­ A ä¸‹åˆ 5 ç‚¹èµ·é£ï¼Œå¦ä¸€ä¸ªè¯´èˆªç­ A ä¸‹åˆ 6 ç‚¹èµ·é£ã€‚å¦‚æœè¿™ä¸¤ä¸ªäº‹å®éƒ½å‡ºç°åœ¨ä¸Šä¸‹æ–‡ä¸­ï¼Œæ¨¡å‹æ— æ³•åˆ¤æ–­å“ªä¸ªæ­£ç¡®ï¼›å®ƒå¯èƒ½ä¼šå›°æƒ‘ï¼Œæˆ–è€…ç”Ÿæˆé”™è¯¯æˆ–ä¸ä¸€è‡´çš„ç­”æ¡ˆã€‚</p>
<p>ä¸Šä¸‹æ–‡å†²çªä¹Ÿå¸¸å‡ºç°åœ¨å¤šè½®å¯¹è¯ä¸­ï¼Œæ¨¡å‹<strong>æ—©æœŸçš„å›ç­”</strong>å°è¯•ä»ç•™åœ¨ä¸Šä¸‹æ–‡ä¸­ï¼Œè€Œåç»­æ”¹è¿›çš„ä¿¡æ¯ä¹Ÿåœ¨ä¸Šä¸‹æ–‡é‡Œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/daeb5998c9614b98a2a82edc6660f34b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=ShRPc4MNVro5NOMpqMr9brpf3uQ%3D" alt="" loading="lazy"/> Image source:Â  <a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2505.06120" title="https://arxiv.org/pdf/2505.06120" target="_blank" ref="nofollow noopener noreferrer">LLMS gets lost in the mult-turn conversation</a>Â (Page04)</p>
<p>å¾®è½¯ å’Œ Salesforce çš„ä¸€é¡¹<a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fpdf%2F2505.06120" title="https://arxiv.org/pdf/2505.06120" target="_blank" ref="nofollow noopener noreferrer">ç ”ç©¶è¡¨æ˜</a>ï¼Œå¦‚æœæŠŠä¸€ä¸ªå¤æ‚æŸ¥è¯¢æ‹†åˆ†æˆå¤šä¸ª chatbot è½®æ¬¡ï¼ˆé€æ­¥æ·»åŠ ç»†èŠ‚ï¼‰ï¼Œæœ€ç»ˆå‡†ç¡®ç‡ä¼šæ˜¾è‘—ä¸‹é™ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒæŠŠæ‰€æœ‰ç»†èŠ‚ä¸€æ¬¡æ€§æ”¾è¿›ä¸€ä¸ª prompt çš„æ•ˆæœæ›´å¥½ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæ—©æœŸè½®æ¬¡ä¸­åŒ…å«äº†æ¨¡å‹ç»™å‡ºçš„ä¸å®Œæ•´æˆ–é”™è¯¯çš„ä¸­é—´ç­”æ¡ˆï¼Œè€Œè¿™äº›å†…å®¹ä¼šä¸€ç›´ç•™åœ¨ä¸Šä¸‹æ–‡ä¸­ã€‚å½“æ¨¡å‹åæ¥å°è¯•åœ¨æ‰€æœ‰ä¿¡æ¯é½å…¨çš„æƒ…å†µä¸‹ä½œç­”æ—¶ï¼Œå®ƒçš„è®°å¿†ä¸­ä»ç„¶åŒ…å«è¿™äº›é”™è¯¯å°è¯•ï¼Œè¿™äº›å†…å®¹ä¸ä¿®æ­£åçš„ä¿¡æ¯å‘ç”Ÿå†²çªï¼Œå¯¼è‡´æ¨¡å‹åç¦»æ­£ç¡®æ–¹å‘ã€‚æœ¬è´¨ä¸Šï¼Œå¯¹è¯çš„ä¸Šä¸‹æ–‡ä¸è‡ªèº«å‘ç”Ÿäº†å†²çªã€‚æ¨¡å‹å¯èƒ½ä¼šæ— æ„ä¸­ä½¿ç”¨è¿‡æ—¶çš„ä¸Šä¸‹æ–‡ç‰‡æ®µï¼ˆæ¥è‡ªæ—©æœŸè½®æ¬¡ï¼‰ï¼Œè€Œè¿™äº›å†…å®¹åœ¨æ–°ä¿¡æ¯åŠ å…¥åå·²ç»ä¸å†é€‚ç”¨ã€‚</p>
<p>åœ¨ agent ç³»ç»Ÿä¸­ï¼Œä¸Šä¸‹æ–‡å†²çªå°¤å…¶å±é™©ï¼Œå› ä¸º agent å¯èƒ½ä¼šç»„åˆæ¥è‡ªä¸åŒå·¥å…·æˆ–å­ agent çš„è¾“å‡ºã€‚å¦‚æœè¿™äº›è¾“å‡ºå½¼æ­¤ä¸ä¸€è‡´ï¼Œèšåˆåçš„ä¸Šä¸‹æ–‡å°±ä¼šå˜å¾—ä¸ä¸€è‡´ã€‚agent åœ¨è¯•å›¾è°ƒå’Œè¿™äº›çŸ›ç›¾æ—¶ï¼Œå¯èƒ½ä¼šå¡ä½æˆ–ç”Ÿæˆæ¯«æ— æ„ä¹‰çš„ç»“æœã€‚é˜²æ­¢ä¸Šä¸‹æ–‡å†²çªéœ€è¦ç¡®ä¿ä¸Šä¸‹æ–‡æ˜¯<strong>æœ€æ–°ä¸”ä¸€è‡´</strong>çš„ï¼Œä¾‹å¦‚æ¸…é™¤æˆ–æ›´æ–°ä»»ä½•è¿‡æ—¶çš„ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸è¦æ··åˆæœªç»ä¸€è‡´æ€§éªŒè¯çš„æ¥æºã€‚</p>
<h3 data-id="heading-9">ä¸Šä¸‹æ–‡æ³„æ¼ä¸çŸ¥è¯†å†²çª</h3>
<p>åœ¨å¤šä¸ª agent æˆ–å¤šä¸ªç”¨æˆ·å…±äº«åŒä¸€ä¸ªè®°å¿†å­˜å‚¨çš„ç³»ç»Ÿä¸­ï¼Œä¿¡æ¯åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¹‹é—´ç›¸äº’æ³„æ¼æ˜¯ä¸€ä¸ªé£é™©ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä¸¤ä¸ªä¸åŒç”¨æˆ·çš„æ•°æ® embeddings å­˜åœ¨äºåŒä¸€ä¸ª vector database ä¸­ï¼Œä½†æ²¡æœ‰é€‚å½“çš„è®¿é—®æ§åˆ¶ï¼Œé‚£ä¹ˆåœ¨å›ç­”ç”¨æˆ· A çš„æŸ¥è¯¢æ—¶ï¼Œagent å¯èƒ½ä¼šæ„å¤–æ£€ç´¢åˆ°ç”¨æˆ· B çš„è®°å¿†ã€‚è¿™ç§è·¨ä¸Šä¸‹æ–‡æ³„æ¼å¯èƒ½æš´éœ²éšç§ä¿¡æ¯ï¼Œæˆ–è€…è‡³å°‘ä¼šè®©å›ç­”å˜å¾—æ··ä¹±ã€‚</p>
<p>æ ¹æ® OWASP Top 10 for LLM Applicationsï¼Œå¤šç§Ÿæˆ·çš„ vector database å¿…é¡»é˜²èŒƒè¿™ç§æ³„æ¼ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dfce731ce6664250aac63244419d890f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=0ux%2BInQrE5t4U0BLrrnPBJ60pJg%3D" alt="" loading="lazy"/> Image source:Â  <a href="https://link.juejin.cn?target=https%3A%2F%2Fwtit.com%2Fblog%2F2025%2F04%2F17%2Fowasp-top-10-for-llm-applications-2025" title="https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025" target="_blank" ref="nofollow noopener noreferrer">wtit.com/blog/2025/0â€¦</a></p>
<p>æ ¹æ® <a href="https://link.juejin.cn?target=https%3A%2F%2Fwtit.com%2Fblog%2F2025%2F04%2F17%2Fowasp-top-10-for-llm-applications-2025%2F" title="https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/" target="_blank" ref="nofollow noopener noreferrer">LLM08:2025 Vector å’Œ Embedding å¼±ç‚¹</a>ï¼Œå¸¸è§é£é™©ä¹‹ä¸€æ˜¯ä¸Šä¸‹æ–‡æ³„æ¼ï¼š</p>
<blockquote>
<p>åœ¨å¤šç§Ÿæˆ·ç¯å¢ƒä¸­ï¼Œå¤šä¸ªç”¨æˆ·ç±»åˆ«æˆ–åº”ç”¨å…±äº«åŒä¸€ä¸ª vector database æ—¶ï¼Œå­˜åœ¨ç”¨æˆ·æˆ–æŸ¥è¯¢ä¹‹é—´å‘ç”Ÿä¸Šä¸‹æ–‡æ³„æ¼çš„é£é™©ã€‚å½“æ¥è‡ªå¤šä¸ªæ•°æ®æºçš„æ•°æ®ç›¸äº’çŸ›ç›¾æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°æ•°æ®è”é‚¦çš„çŸ¥è¯†å†²çªé”™è¯¯ã€‚å½“ LLM æ— æ³•ç”¨ Retrieval Augmentation è·å–çš„æ–°æ•°æ®è¦†ç›–å…¶åœ¨è®­ç»ƒæœŸé—´å­¦åˆ°çš„æ—§çŸ¥è¯†æ—¶ï¼Œä¹Ÿä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</p>
</blockquote>
<p>å¦ä¸€ä¸ªæ–¹é¢æ˜¯ï¼ŒLLM å¯èƒ½å¾ˆéš¾ç”¨ memory ä¸­çš„æ–°ä¿¡æ¯å»è¦†ç›–å®ƒå†…ç½®çš„çŸ¥è¯†ã€‚å¦‚æœæ¨¡å‹åœ¨è®­ç»ƒæ—¶å­¦è¿‡æŸä¸ªäº‹å®ï¼Œè€Œæ£€ç´¢åˆ°çš„ context è¯´çš„æ˜¯ç›¸åçš„å†…å®¹ï¼Œæ¨¡å‹å¯èƒ½ä¼šæ··æ·†ï¼Œä¸çŸ¥é“è¯¥ä¿¡å“ªä¸€ä¸ªã€‚å¦‚æœæ²¡æœ‰åˆé€‚çš„è®¾è®¡ï¼Œagent å¯èƒ½ä¼šæ··åˆä¸åŒçš„ contextï¼Œæˆ–è€…æ— æ³•ç”¨æ–°çš„è¯æ®æ›´æ–°æ—§çŸ¥è¯†ï¼Œä»è€Œå¯¼è‡´é™ˆæ—§æˆ–é”™è¯¯çš„ç­”æ¡ˆã€‚</p>
<h3 data-id="heading-10"><strong>å¹»è§‰ï¼ˆhallucinationsï¼‰å’Œé”™è¯¯ä¿¡æ¯ï¼ˆmisinformationï¼‰</strong></h3>
<p>å³ä½¿åœ¨æ²¡æœ‰é•¿ context çš„æƒ…å†µä¸‹ï¼Œå¹»è§‰ï¼ˆLLM ç¼–é€ çœ‹èµ·æ¥åˆç†ä½†å®é™…ä¸Šæ˜¯é”™è¯¯çš„ä¿¡æ¯ï¼‰ä¹Ÿæ˜¯ä¸€ä¸ªå·²çŸ¥é—®é¢˜ï¼Œè€Œç³Ÿç³•çš„ memory ç®¡ç†ä¼šæ”¾å¤§è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¦‚æœ agent çš„ memory ç¼ºå°‘ä¸€ä¸ªå…³é”®äº‹å®ï¼Œæ¨¡å‹å¯èƒ½ä¼š<strong>ç”¨çŒœæµ‹æ¥å¡«è¡¥ç©ºç™½</strong>ï¼›è€Œå¦‚æœè¿™ä¸ªçŒœæµ‹éšåè¿›å…¥äº† contextï¼ˆæ±¡æŸ“äº† contextï¼‰ï¼Œé”™è¯¯å°±ä¼šæŒç»­å­˜åœ¨ã€‚</p>
<p>OWASP LLM å®‰å…¨æŠ¥å‘Šï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwtit.com%2Fblog%2F2025%2F04%2F17%2Fowasp-top-10-for-llm-applications-2025%2F" title="https://wtit.com/blog/2025/04/17/owasp-top-10-for-llm-applications-2025/" target="_blank" ref="nofollow noopener noreferrer">LLM09:2025 Misinformation</a>ï¼‰å°†é”™è¯¯ä¿¡æ¯åˆ—ä¸ºä¸€ä¸ªæ ¸å¿ƒæ¼æ´ï¼šLLM å¯èƒ½ç”Ÿæˆè‡ªä¿¡ä½†æé€ çš„ç­”æ¡ˆï¼Œè€Œç”¨æˆ·å¯èƒ½ä¼šè¿‡åº¦ä¿¡ä»»å®ƒä»¬ã€‚ä¸€ä¸ªæ‹¥æœ‰ä¸è‰¯æˆ–è¿‡æ—¶ long-term memory çš„ agentï¼Œå¯èƒ½ä¼šè‡ªä¿¡åœ°å¼•ç”¨å»å¹´è¿˜æ­£ç¡®ã€ä½†ç°åœ¨å·²ç»é”™è¯¯çš„ä¿¡æ¯ï¼Œé™¤éå®ƒçš„ memory èƒ½ä¿æŒæ›´æ–°ã€‚</p>
<p>ç”¨æˆ·æˆ– agent è‡ªèº«ï¼ˆåœ¨å¾ªç¯ä¸­ï¼‰å¯¹ AI è¾“å‡ºçš„è¿‡åº¦ä¾èµ–ï¼Œä¼šè®©é—®é¢˜æ›´åŠ ä¸¥é‡ã€‚å¦‚æœæ²¡æœ‰äººå»æ£€æŸ¥ memory é‡Œçš„ä¿¡æ¯ï¼Œagent å¯èƒ½ä¼šä¸æ–­ç§¯ç´¯é”™è¯¯å†…å®¹ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¸¸å¸¸ä½¿ç”¨ RAG æ¥å‡å°‘å¹»è§‰ï¼šé€šè¿‡æ£€ç´¢æƒå¨æ¥æºï¼Œæ¨¡å‹å°±ä¸å¿…å»ç¼–é€ äº‹å®ã€‚ä½†å¦‚æœæ£€ç´¢æ‹‰å–äº†é”™è¯¯çš„æ–‡æ¡£ï¼ˆä¾‹å¦‚åŒ…å«é”™è¯¯ä¿¡æ¯çš„æ–‡æ¡£ï¼‰ï¼Œæˆ–è€…æ—©æœŸçš„å¹»è§‰æ²¡æœ‰è¢«æ¸…ç†ï¼Œç³»ç»Ÿå°±å¯èƒ½åœ¨æ•´ä¸ªè¡ŒåŠ¨è¿‡ç¨‹ä¸­ä¼ æ’­è¿™äº›é”™è¯¯ä¿¡æ¯ã€‚</p>
<p><strong>æ€»ç»“</strong>ï¼šæœªèƒ½æ­£ç¡®ç®¡ç† memory ä¼šå¯¼è‡´<strong>ä¸æ­£ç¡®å’Œå…·æœ‰è¯¯å¯¼æ€§çš„è¾“å‡º</strong>ï¼Œè€Œåœ¨é«˜é£é™©åœºæ™¯ä¸‹ï¼ˆä¾‹å¦‚é‡‘èæˆ–åŒ»ç–—é¢†åŸŸç»™å‡ºé”™è¯¯å»ºè®®ï¼‰å°¤å…¶å…·æœ‰ç ´åæ€§ã€‚ä¸€ä¸ª agent éœ€è¦æœ‰æœºåˆ¶å»éªŒè¯æˆ–çº æ­£å…¶ memory å†…å®¹ï¼Œè€Œä¸æ˜¯æ— æ¡ä»¶åœ°ä¿¡ä»» context ä¸­çš„ä»»ä½•ä¿¡æ¯ã€‚</p>
<p>æ€»ä¹‹ï¼Œç»™ AI agent ä¸€ä¸ªæ— é™é•¿çš„ memoryï¼Œæˆ–è€…æŠŠæ‰€æœ‰å¯èƒ½çš„ä¸œè¥¿ä¸€è‚¡è„‘ä¸¢è¿›å®ƒçš„ contextï¼Œå¹¶ä¸æ˜¯æˆåŠŸçš„åšæ³•ã€‚</p>
<h2 data-id="heading-11"><strong>LLM åº”ç”¨ä¸­ memory ç®¡ç†çš„æœ€ä½³å®è·µ</strong></h2>
<p>ä¸ºäº†é¿å…ä¸Šè¿°é—®é¢˜ï¼Œå¼€å‘è€…å’Œç ”ç©¶äººå‘˜æ€»ç»“äº†ä¸€äº›ç”¨äº<strong>ç®¡ç† AI ç³»ç»Ÿä¸­ context å’Œ memory çš„æœ€ä½³å®è·µ</strong>ã€‚è¿™äº›å®è·µçš„ç›®æ ‡æ˜¯è®© AI çš„å·¥ä½œ context ä¿æŒç²¾ç®€ã€ç›¸å…³ä¸”æœ€æ–°ã€‚ä¸‹é¢æ˜¯ä¸€äº›å…³é”®ç­–ç•¥ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•å‘æŒ¥ä½œç”¨çš„ç¤ºä¾‹ã€‚</p>
<h3 data-id="heading-12"><strong>RAGï¼šä½¿ç”¨æœ‰é’ˆå¯¹æ€§çš„ context</strong></h3>
<p>å‰é¢çš„ç« èŠ‚å·²ç»ä»‹ç»äº†å¾ˆå¤šå…³äº RAG çš„å†…å®¹ï¼Œè¿™é‡Œä½œä¸ºä¸€ç»„ç®€æ˜çš„å®è·µæé†’ï¼š</p>
<ul>
<li>ä½¿ç”¨æœ‰é’ˆå¯¹æ€§çš„æ£€ç´¢ï¼Œè€Œä¸æ˜¯æ‰¹é‡åŠ è½½ï¼šåªæ£€ç´¢æœ€ç›¸å…³çš„ chunkï¼Œè€Œä¸æ˜¯æŠŠæ•´ä¸ªæ–‡æ¡£æˆ–å®Œæ•´çš„å¯¹è¯å†å²éƒ½å¡è¿› promptã€‚</li>
<li>å°† RAG è§†ä¸ºå³æ—¶ï¼ˆjust-in-timeï¼‰çš„ memory å¬å›ï¼šåªåœ¨éœ€è¦æ—¶æ‰æ‹‰å– contextï¼Œè€Œä¸æ˜¯åœ¨å¤šè½®å¯¹è¯ä¸­ä¸€ç›´æºå¸¦æ‰€æœ‰å†…å®¹ã€‚</li>
<li>ä¼˜å…ˆä½¿ç”¨ä¸ç›¸å…³æ€§ç›¸å…³çš„æ£€ç´¢ç­–ç•¥ï¼šä¾‹å¦‚ top-k è¯­ä¹‰æœç´¢ã€å€’æ•°æ’åºèåˆï¼ˆReciprocal Rank Fusionï¼‰ï¼Œæˆ– tool loadout è¿‡æ»¤ï¼Œæœ‰åŠ©äºå‡å°‘å™ªå£°å¹¶æå‡ groundingã€‚</li>
<li>æ›´å¤§çš„ context window å¹¶ä¸èƒ½æ¶ˆé™¤å¯¹ RAG çš„éœ€æ±‚ï¼šä¸¤ä¸ªé«˜åº¦ç›¸å…³çš„æ®µè½ï¼Œå‡ ä¹æ€»æ˜¯æ¯” 20 é¡µæ¾æ•£ç›¸å…³çš„å†…å®¹æ›´æœ‰æ•ˆã€‚</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒRAG çš„é‡ç‚¹ä¸æ˜¯åŠ å…¥æ›´å¤š contextï¼Œè€Œæ˜¯åŠ å…¥<strong>æ­£ç¡®çš„ context</strong>ã€‚</p>
<h3 data-id="heading-13"><strong>å·¥å…·é…ç½®ï¼ˆ Tool loadout ï¼‰</strong></h3>
<p>å·¥å…·é…ç½®æ˜¯æŒ‡åªç»™æ¨¡å‹å®ŒæˆæŸä¸ªä»»åŠ¡<strong>çœŸæ­£éœ€è¦çš„å·¥å…·</strong>ã€‚è¿™ä¸ªæœ¯è¯­æ¥è‡ªæ¸¸æˆï¼šä½ ä¼šé€‰æ‹©ä¸€ä¸ªé€‚åˆå½“å‰æƒ…å¢ƒçš„ loadoutã€‚å·¥å…·å¤ªå¤šä¼šæ‹–æ…¢ä½ ï¼›å·¥å…·é€‰é”™ä¼šç›´æ¥å¤±è´¥ã€‚æ ¹æ®ç ”ç©¶è®ºæ–‡ <em><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2411.15399" title="https://arxiv.org/abs/2411.15399" target="_blank" ref="nofollow noopener noreferrer">Less is More</a></em>ï¼ŒLLM çš„è¡Œä¸ºä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ä¸€æ—¦å·¥å…·æ•°é‡è¶…è¿‡çº¦ 30 ä¸ªï¼Œæè¿°å°±å¼€å§‹ç›¸äº’é‡å ï¼Œæ¨¡å‹ä¼šå˜å¾—å›°æƒ‘ï¼›è¶…è¿‡çº¦ 100 ä¸ªå·¥å…·ï¼Œå‡ ä¹å¿…ç„¶å¤±è´¥ã€‚è¿™ä¸æ˜¯ context window çš„é—®é¢˜ï¼Œè€Œæ˜¯ <strong>context æ··ä¹±</strong>ã€‚</p>
<p>ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆæ˜¯ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2505.03275" title="https://arxiv.org/abs/2505.03275" target="_blank" ref="nofollow noopener noreferrer">RAG-MCP</a></strong>ã€‚ä¸å…¶æŠŠæ‰€æœ‰å·¥å…·ä¸€è‚¡è„‘å¡è¿› promptï¼Œä¸å¦‚æŠŠå·¥å…·æè¿°å­˜è¿›å‘é‡æ•°æ®åº“ï¼Œç„¶åæ¯æ¬¡è¯·æ±‚åªæ£€ç´¢æœ€ç›¸å…³çš„å·¥å…·ã€‚å®é™…æ•ˆæœæ˜¯ï¼šloadout ä¿æŒå°è€Œèšç„¦ï¼Œprompt æ˜æ˜¾å˜çŸ­ï¼Œå·¥å…·é€‰æ‹©çš„å‡†ç¡®ç‡æœ€é«˜å¯ä»¥æå‡åˆ°åŸæ¥çš„ 3 å€ã€‚</p>
<p>æ›´å°çš„æ¨¡å‹ä¼šæ›´æ—©æ’ä¸Šè¿™å µå¢™ã€‚ç ”ç©¶æ˜¾ç¤ºï¼Œä¸€ä¸ª 8B æ¨¡å‹åœ¨é¢å¯¹å‡ åä¸ªå·¥å…·æ—¶ä¼šå¤±è´¥ï¼Œä½†åœ¨ç²¾ç®€ loadout ä¹‹åå´èƒ½æˆåŠŸã€‚åŠ¨æ€é€‰æ‹©å·¥å…· â€”â€” æœ‰æ—¶å…ˆè®© LLM è‡ªå·±æ¨ç†å®ƒéœ€è¦å“ªäº›å·¥å…· â€”â€” å¯ä»¥å°†æ€§èƒ½æå‡ 44%ï¼ŒåŒæ—¶é™ä½åŠŸè€—å’Œå»¶è¿Ÿã€‚ç»“è®ºæ˜¯ï¼šå¤§å¤šæ•° agent å®é™…ä¸Šåªéœ€è¦å°‘é‡å·¥å…·ï¼Œä½†éšç€ç³»ç»Ÿè§„æ¨¡å¢é•¿ï¼Œå·¥å…·é…ç½®å’Œ RAG-MCP ä¼šæˆä¸ºä¸€ç­‰é‡è¦çš„è®¾è®¡å†³ç­–ã€‚</p>
<h3 data-id="heading-14"><strong>Context å‰ªæï¼šé™åˆ¶èŠå¤©å†å²é•¿åº¦</strong></h3>
<p>å¦‚æœä¸€æ¬¡å¯¹è¯æŒç»­å¾ˆå¤šè½®ï¼Œç´¯ç§¯çš„èŠå¤©å†å²å¯èƒ½ä¼šå˜å¾—å¤ªå¤§ï¼Œæ— æ³•æ”¾å…¥ contextï¼Œæˆ–è€…å¯¹æ¨¡å‹æ¥è¯´è¿‡äºå¹²æ‰°ã€‚</p>
<p>Trimmingï¼ˆå¯¹è¯ä¿®å‰ªï¼‰ æŒ‡çš„æ˜¯åœ¨å¯¹è¯ä¸æ–­å¢é•¿æ—¶ï¼Œä»¥ç¨‹åºæ–¹å¼ç§»é™¤æˆ–ç¼©çŸ­ä¸é‚£ä¹ˆé‡è¦çš„å¯¹è¯éƒ¨åˆ†ã€‚ä¸€ç§æœ€ç®€å•çš„å½¢å¼æ˜¯åœ¨è¾¾åˆ°æŸä¸ªé™åˆ¶æ—¶ä¸¢å¼ƒæœ€æ—©çš„å¯¹è¯è½®æ¬¡ï¼Œåªä¿ç•™æœ€è¿‘çš„ N æ¡æ¶ˆæ¯ã€‚æ›´å¤æ‚çš„å‰ªææ–¹å¼å¯èƒ½ä¼šç§»é™¤æ— å…³çš„å²”é¢˜å†…å®¹ï¼Œæˆ–å·²ç»ä¸å†éœ€è¦çš„æ—§æŒ‡ä»¤ã€‚ç›®æ ‡æ˜¯<strong>è®© context window ä¸è¢«è¿‡æ—¶çš„ä¿¡æ¯å¼„ä¹±</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœ agent åœ¨ 10 è½®ä¹‹å‰å·²ç»è§£å†³äº†ä¸€ä¸ªå­é—®é¢˜ï¼Œè€Œç°åœ¨å·²ç»è¿›å…¥æ–°çš„é˜¶æ®µï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠé‚£ä¸€æ®µå†å²ä» context ä¸­åˆ é™¤ï¼ˆå‰ææ˜¯ä¹‹åä¸å†éœ€è¦å®ƒï¼‰ã€‚è®¸å¤šåŸºäºèŠå¤©çš„å®ç°éƒ½ä¼šè¿™æ ·åšï¼šå®ƒä»¬ç»´æŠ¤ä¸€ä¸ªæ»šåŠ¨çš„æœ€è¿‘æ¶ˆæ¯çª—å£ã€‚</p>
<p>Trimming ä¹Ÿå¯ä»¥å¾ˆç®€å•ï¼Œæ¯”å¦‚åœ¨å¯¹è¯è¢«æ€»ç»“å®Œæˆï¼Œæˆ–è¢«åˆ¤æ–­ä¸ºæ— å…³ä¹‹åï¼Œå°± â€œå¿˜è®°â€ æœ€æ—©çš„éƒ¨åˆ†ã€‚è¿™æ ·åšå¯ä»¥é™ä½ context overflow é”™è¯¯çš„é£é™©ï¼ŒåŒæ—¶å‡å°‘ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.google.com%2Fdocument%2Fd%2F15je2KBUgkYKuR2jxGVCGVaa2UhXzwL11cTv8ikC1-z8%2Fedit%3Ftab%3Dt.0%23heading%3Dh.kuopole01bum" title="https://docs.google.com/document/d/15je2KBUgkYKuR2jxGVCGVaa2UhXzwL11cTv8ikC1-z8/edit?tab=t.0#heading=h.kuopole01bum" target="_blank" ref="nofollow noopener noreferrer">context å¹²æ‰°</a>ï¼Œè®©æ¨¡å‹ä¸ä¼šè¢«æ—§çš„æˆ–è·‘é¢˜çš„å†…å®¹åˆ†æ•£æ³¨æ„åŠ›ã€‚è¿™ç§æ–¹å¼éå¸¸ç±»ä¼¼äººç±»çš„è¡Œä¸ºï¼šæˆ‘ä»¬ä¸ä¼šè®°ä½ä¸€å°æ—¶æ¼”è®²ä¸­çš„æ¯ä¸€å¥è¯ï¼Œä½†ä¼šä¿ç•™é‡ç‚¹ã€‚</p>
<p>å¦‚æœä½ å¯¹ context å‰ªææ„Ÿåˆ°å›°æƒ‘ï¼Œæ­£å¦‚ä½œè€… Drew Breunig æåˆ°çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.dbreunig.com%2F2025%2F06%2F26%2Fhow-to-fix-your-context.html%23tool-loadout%3A~%3Atext%3DProvence%2520is%2520fast%252C%2520accurate%252C%2520simple%2520to%2520use%252C%2520and%2520relatively%2520small%2520%25E2%2580%2593%2520only%25201.75%2520GB.%2520You%2520can%2520call%2520it%2520in%2520a%2520few%2520lines%252C%2520like%2520so%253A" title="https://www.dbreunig.com/2025/06/26/how-to-fix-your-context.html#tool-loadout:~:text=Provence%20is%20fast%2C%20accurate%2C%20simple%20to%20use%2C%20and%20relatively%20small%20%E2%80%93%20only%201.75%20GB.%20You%20can%20call%20it%20in%20a%20few%20lines%2C%20like%20so%3A" target="_blank" ref="nofollow noopener noreferrer">é‚£æ ·</a>ï¼Œä½¿ç”¨ Provenceï¼ˆ<code>[naver/provence-reranker-debertav3-v1](https://huggingface.co/naver/provence-reranker-debertav3-v1 "naver/provence-reranker-debertav3-v1")</code>ï¼‰æ¨¡å‹â€”â€”ä¸€ä¸ªè½»é‡çº§ï¼ˆ1.75 GBï¼‰ã€é«˜æ•ˆä¸”å‡†ç¡®çš„ context å‰ªæå™¨ï¼Œç”¨äº question answering â€”â€” å¯ä»¥å¸¦æ¥æ˜æ˜¾å¸®åŠ©ã€‚å®ƒå¯ä»¥æ ¹æ®ç»™å®š queryï¼ŒæŠŠå¤§å‹æ–‡æ¡£è£å‰ªä¸ºåªåŒ…å«æœ€ç›¸å…³çš„æ–‡æœ¬ã€‚ä½ å¯ä»¥åœ¨ç‰¹å®šçš„æ—¶é—´é—´éš”è°ƒç”¨å®ƒã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬åœ¨ä»£ç ä¸­è°ƒç”¨ <code>provence-reranker</code> æ¨¡å‹æ¥å‰ªæ context çš„æ–¹å¼ï¼š</p>
<pre><code class="hljs language-python" lang="python">`

<span class="hljs-number">1.</span>  <span class="hljs-comment"># Context pruning with Provence</span>
<span class="hljs-number">2.</span>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">prune_with_provence</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span>, context: <span class="hljs-built_in">str</span>, threshold: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">float</span>] = <span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">str</span>:
<span class="hljs-number">3.</span>      <span class="hljs-string">"""
4.      Prune context using Provence reranker model

6.      Args:
7.          query: User's query/question
8.          context: Original context to prune
9.          threshold: Relevance threshold (0-1) for Provence reranker.
10.                     If None, uses args.pruning_threshold.
11.                     0.1 = conservative (recommended, no performance drop)
12.                     0.3-0.5 = moderate to aggressive pruning

14.      Returns:
15.          Pruned context with only relevant sentences
16.      """</span>
<span class="hljs-number">17.</span>      <span class="hljs-keyword">if</span> provence_model <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
<span class="hljs-number">18.</span>          <span class="hljs-keyword">return</span> context

<span class="hljs-number">20.</span>      <span class="hljs-keyword">if</span> threshold <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
<span class="hljs-number">21.</span>          threshold = args.pruning_threshold

<span class="hljs-number">23.</span>      <span class="hljs-keyword">try</span>:
<span class="hljs-number">24.</span>          <span class="hljs-comment"># Use Provence's process method</span>
<span class="hljs-number">25.</span>          provence_output = provence_model.process(
<span class="hljs-number">26.</span>              question=query,
<span class="hljs-number">27.</span>              context=context,
<span class="hljs-number">28.</span>              threshold=threshold,
<span class="hljs-number">29.</span>              always_select_title=<span class="hljs-literal">False</span>,
<span class="hljs-number">30.</span>              enable_warnings=<span class="hljs-literal">False</span>
<span class="hljs-number">31.</span>          )

<span class="hljs-number">33.</span>          <span class="hljs-comment"># Extract pruned context from output</span>
<span class="hljs-number">34.</span>          pruned_context = provence_output.get(<span class="hljs-string">'pruned_context'</span>, context)
<span class="hljs-number">35.</span>          reranking_score = provence_output.get(<span class="hljs-string">'reranking_score'</span>, <span class="hljs-number">0.0</span>)

<span class="hljs-number">37.</span>          <span class="hljs-comment"># Log statistics</span>
<span class="hljs-number">38.</span>          original_length = <span class="hljs-built_in">len</span>(context)
<span class="hljs-number">39.</span>          pruned_length = <span class="hljs-built_in">len</span>(pruned_context)
<span class="hljs-number">40.</span>          reduction_pct = ((original_length - pruned_length) / original_length * <span class="hljs-number">100</span>) <span class="hljs-keyword">if</span> original_length &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>

<span class="hljs-number">42.</span>          <span class="hljs-keyword">if</span> args.verbose:
<span class="hljs-number">43.</span>              rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[cyan]ğŸ“Š Pruning stats: <span class="hljs-subst">{pruned_length}</span>/<span class="hljs-subst">{original_length}</span> chars (<span class="hljs-subst">{reduction_pct:<span class="hljs-number">.1</span>f}</span>% reduction, threshold=<span class="hljs-subst">{threshold:<span class="hljs-number">.2</span>f}</span>, rerank_score=<span class="hljs-subst">{reranking_score:<span class="hljs-number">.3</span>f}</span>)[/cyan]"</span>)

<span class="hljs-number">45.</span>          <span class="hljs-keyword">return</span> pruned_context <span class="hljs-keyword">if</span> pruned_context <span class="hljs-keyword">else</span> context

<span class="hljs-number">47.</span>      <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
<span class="hljs-number">48.</span>          rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[yellow]âš ï¸ Error in Provence pruning: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>[/yellow]"</span>)
<span class="hljs-number">49.</span>          rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[yellow]âš ï¸ Falling back to original context[/yellow]"</span>)
<span class="hljs-number">50.</span>          <span class="hljs-keyword">return</span> context

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)æ”¶èµ·ä»£ç å—![](https://csdnimg.cn/release/blogv2/dist/pc/img/arrowup-line-top-White.png)
</code></pre>
<p>æˆ‘ä»¬ä½¿ç”¨ Provence reranker æ¨¡å‹ï¼ˆ<code>naver/provence-reranker-debertav3-v1</code>ï¼‰æ¥å¯¹å¥å­çš„ç›¸å…³æ€§è¿›è¡Œæ‰“åˆ†ã€‚åŸºäºé˜ˆå€¼çš„è¿‡æ»¤ä¼šä¿ç•™é«˜äºç›¸å…³æ€§é˜ˆå€¼çš„å¥å­ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ª fallback æœºåˆ¶ï¼šå¦‚æœå‰ªæå¤±è´¥ï¼Œå°±è¿”å›åŸå§‹ contextã€‚æœ€åï¼Œåœ¨ verbose æ¨¡å¼ä¸‹ï¼Œé€šè¿‡ç»Ÿè®¡æ—¥å¿—æ¥è·Ÿè¸ª context ç¼©å‡çš„ç™¾åˆ†æ¯”ã€‚</p>
<h3 data-id="heading-15"><strong>Context æ€»ç»“ï¼šå‹ç¼©è¾ƒæ—§çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å®Œå…¨ä¸¢å¼ƒ</strong></h3>
<p>Summarization æ˜¯ trimming çš„ä¸€ä¸ªé…å¥—æ–¹æ³•ã€‚å½“å†å²è®°å½•æˆ–çŸ¥è¯†åº“å˜å¾—è¿‡å¤§æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ LLM ç”Ÿæˆä¸€ä»½å…³é”®ç‚¹çš„ç®€è¦æ€»ç»“ï¼Œå¹¶åœ¨åç»­ä½¿ç”¨è¿™ä»½æ€»ç»“æ¥æ›¿ä»£å®Œæ•´å†…å®¹ï¼Œå°±åƒæˆ‘ä»¬åœ¨ä¸Šé¢çš„ä»£ç ä¸­æ‰€åšçš„ä¸€æ ·ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ª AI assistant å·²ç»è¿›è¡Œäº† 50 è½®å¯¹è¯ï¼Œé‚£ä¹ˆåœ¨ç¬¬ 51 è½®æ—¶ï¼Œä¸å…¶æŠŠå…¨éƒ¨ 50 è½®éƒ½å‘é€ç»™æ¨¡å‹ï¼ˆå¾ˆå¯èƒ½æ”¾ä¸ä¸‹ï¼‰ï¼Œç³»ç»Ÿå¯ä»¥æŠŠç¬¬ 1â€“40 è½®äº¤ç»™æ¨¡å‹ç”Ÿæˆä¸€æ®µæ€»ç»“ï¼Œç„¶ååœ¨ä¸‹ä¸€æ¬¡ prompt ä¸­åªæä¾›è¿™æ®µæ€»ç»“åŠ ä¸Šæœ€è¿‘çš„ 10 è½®å¯¹è¯ã€‚è¿™æ ·ï¼Œæ¨¡å‹ä»ç„¶çŸ¥é“ä¹‹å‰è®¨è®ºäº†ä»€ä¹ˆï¼Œè€Œä¸éœ€è¦æ¯ä¸€ä¸ªç»†èŠ‚ã€‚æ—©æœŸçš„ chatbot ç”¨æˆ·ä¼šæ‰‹åŠ¨è¿™æ ·åšï¼Œæ¯”å¦‚é—®ï¼šâ€œä½ èƒ½æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢èŠè¿‡çš„å†…å®¹å—ï¼Ÿâ€ç„¶ååœ¨ä¸€ä¸ªæ–°çš„ session ä¸­åŸºäºæ€»ç»“ç»§ç»­ã€‚ç°åœ¨ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯ä»¥è‡ªåŠ¨åŒ–å®Œæˆã€‚Summarization ä¸ä»…å¯ä»¥èŠ‚çœ context window ç©ºé—´ï¼Œè¿˜å¯ä»¥é€šè¿‡å»é™¤å¤šä½™ç»†èŠ‚ã€åªä¿ç•™å…³é”®ä¿¡æ¯ï¼Œæ¥å‡å°‘ <strong>context æ··æ·† / å¹²æ‰°</strong>ã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ OpenAI æ¨¡å‹ï¼ˆä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä»»ä½• LLMï¼‰æ¥å‹ç¼© contextï¼Œåœ¨ä¿ç•™æ‰€æœ‰ç›¸å…³ä¿¡æ¯çš„åŒæ—¶ï¼Œæ¶ˆé™¤å†—ä½™å’Œé‡å¤å†…å®¹ã€‚</p>
<pre><code class="hljs language-python" lang="python">`

<span class="hljs-number">1.</span>  <span class="hljs-comment"># Context summarization</span>
<span class="hljs-number">2.</span>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">summarize_context</span>(<span class="hljs-params">query: <span class="hljs-built_in">str</span>, context: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
<span class="hljs-number">3.</span>      <span class="hljs-string">"""
4.      Summarize context using LLM to reduce duplication and focus on relevant information

6.      Args:
7.          query: User's query/question
8.          context: Context to summarize

10.      Returns:
11.          Summarized context
12.      """</span>
<span class="hljs-number">13.</span>      <span class="hljs-keyword">try</span>:
<span class="hljs-number">14.</span>          summary_prompt = <span class="hljs-string">f"""You are an expert at summarizing conversation context.

16.  Your task: Analyze the provided conversation context and produce a condensed summary that fully answers or supports the user's specific question.

18.  The summary must:
19.  1. Preserve every fact, detail, and information that directly relates to the question
20.  2. Eliminate redundancy and duplicate information
21.  3. Maintain chronological flow when relevant
22.  4. Focus on information that helps answer: "<span class="hljs-subst">{query}</span>"

24.  Context to summarize:
25.  <span class="hljs-subst">{context}</span>

27.  Provide a concise summary that preserves all relevant information:"""</span>

<span class="hljs-number">29.</span>          summary = llm.invoke(summary_prompt).content

<span class="hljs-number">31.</span>          <span class="hljs-keyword">if</span> args.verbose:
<span class="hljs-number">32.</span>              original_length = <span class="hljs-built_in">len</span>(context)
<span class="hljs-number">33.</span>              summary_length = <span class="hljs-built_in">len</span>(summary)
<span class="hljs-number">34.</span>              reduction_pct = ((original_length - summary_length) / original_length * <span class="hljs-number">100</span>) <span class="hljs-keyword">if</span> original_length &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>
<span class="hljs-number">35.</span>              rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[cyan]ğŸ“ Summarization stats: <span class="hljs-subst">{summary_length}</span>/<span class="hljs-subst">{original_length}</span> chars (<span class="hljs-subst">{reduction_pct:<span class="hljs-number">.1</span>f}</span>% reduction)[/cyan]"</span>)

<span class="hljs-number">37.</span>          <span class="hljs-keyword">return</span> summary

<span class="hljs-number">39.</span>      <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
<span class="hljs-number">40.</span>          rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[yellow]âš ï¸ Error in context summarization: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>[/yellow]"</span>)
<span class="hljs-number">41.</span>          rich.<span class="hljs-built_in">print</span>(<span class="hljs-string">f"[yellow]âš ï¸ Falling back to original context[/yellow]"</span>)
<span class="hljs-number">42.</span>          <span class="hljs-keyword">return</span> context

`AIå†™ä»£ç ![](https://csdnimg.cn/release/blogv2/dist/pc/img/runCode/icon-arrowwhite.png)
</code></pre>
<p>é‡è¦çš„æ˜¯ï¼Œå½“ context è¢«æ€»ç»“ä¹‹åï¼Œæ¨¡å‹å°±ä¸å¤ªå®¹æ˜“è¢«çç¢çš„ç»†èŠ‚æˆ–è¿‡å»çš„é”™è¯¯å‹å®ï¼ˆå‰ææ˜¯ summary æ˜¯å‡†ç¡®çš„ï¼‰ã€‚</p>
<p>ä½†æ˜¯ï¼Œsummarization å¿…é¡»éå¸¸å°å¿ƒã€‚ä¸€ä¸ªä¸å¥½çš„ summary å¯èƒ½ä¼šé—æ¼å…³é”®ç»†èŠ‚ï¼Œç”šè‡³å¼•å…¥é”™è¯¯ã€‚æœ¬è´¨ä¸Šï¼Œè¿™åˆæ˜¯ä¸€æ¬¡ç»™æ¨¡å‹çš„ promptï¼ˆâ€œsummarize thisâ€ï¼‰ï¼Œå› æ­¤å®ƒå¯èƒ½ä¼š hallucinateï¼Œæˆ–è€…ä¸¢å¤±ç»†å¾®å·®åˆ«ã€‚æœ€ä½³å®è·µæ˜¯<strong>å¢é‡å¼ summarization</strong>ï¼Œå¹¶ä¸”å¯èƒ½è¦ä¿ç•™ä¸€äº›è§„èŒƒæ€§çš„äº‹å®ï¼Œä¸å¯¹å®ƒä»¬åšæ€»ç»“ã€‚</p>
<p>å°½ç®¡å¦‚æ­¤ï¼Œsummarization å·²è¢«è¯æ˜éå¸¸æœ‰ç”¨ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.google.com%2Fdocument%2Fd%2F15je2KBUgkYKuR2jxGVCGVaa2UhXzwL11cTv8ikC1-z8%2Fedit%3Ftab%3Dt.0%23heading%3Dh.kuopole01bum" title="https://docs.google.com/document/d/15je2KBUgkYKuR2jxGVCGVaa2UhXzwL11cTv8ikC1-z8/edit?tab=t.0#heading=h.kuopole01bum" target="_blank" ref="nofollow noopener noreferrer">åœ¨ Gemini agent çš„åœºæ™¯ä¸­</a>ï¼Œå¤§çº¦æ¯ ~100k tokens å¯¹ context åšä¸€æ¬¡æ€»ç»“ï¼Œæ˜¯å¯¹æŠ—æ¨¡å‹åå¤é‡å¤è‡ªèº«è¡Œä¸ºçš„ä¸€ç§æ–¹å¼ã€‚è¿™ä¸ª summary å°±åƒæ˜¯å¯¹è¯æˆ–æ•°æ®çš„å‹ç¼©è®°å¿†ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬å¯ä»¥è®© agent å®šæœŸè°ƒç”¨ä¸€ä¸ª summarization å‡½æ•°ï¼ˆå¯èƒ½æ˜¯ä¸€ä¸ªæ›´å°çš„ LLMï¼Œæˆ–è€…ä¸€ä¸ªä¸“ç”¨æµç¨‹ï¼‰ï¼Œå¯¹å¯¹è¯å†å²æˆ–é•¿æ–‡æ¡£è¿›è¡Œæ€»ç»“ï¼Œç„¶åç”¨ç”Ÿæˆçš„ summary æ›¿æ¢ prompt ä¸­çš„åŸå§‹å†…å®¹ã€‚è¿™ç§ç­–ç•¥è¢«å¹¿æ³›ç”¨äºä¿æŒ context åœ¨é™åˆ¶èŒƒå›´å†…ï¼Œå¹¶æç‚¼å…³é”®ä¿¡æ¯ã€‚</p>
<h3 data-id="heading-16"><strong>Context éš”ç¦»ï¼ˆcontext quarantineï¼‰ï¼šåœ¨å¯èƒ½çš„æƒ…å†µä¸‹éš”ç¦» context</strong></h3>
<p>è¿™ä¸€ç‚¹åœ¨å¤æ‚çš„ agent ç³»ç»Ÿæˆ–å¤šæ­¥éª¤ workflow ä¸­å°¤å…¶é‡è¦ã€‚Context segmentation çš„æ€æƒ³æ˜¯ï¼ŒæŠŠä¸€ä¸ªå¤§ä»»åŠ¡æ‹†åˆ†æˆæ›´å°ã€å½¼æ­¤éš”ç¦»çš„ä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æœ‰è‡ªå·±çš„ contextï¼Œè¿™æ ·å°±ä¸ä¼šç§¯ç´¯ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¿¡æ¯çš„å·¨å¤§ contextã€‚æ¯ä¸ª subagent æˆ– subtask éƒ½åœ¨ä¸€ä¸ªé«˜åº¦èšç„¦çš„ context ä¸­å¤„ç†é—®é¢˜ï¼Œç„¶åç”±ä¸€ä¸ªæ›´é«˜å±‚çš„ agentã€supervisor æˆ– coordinator æ¥æ•´åˆè¿™äº›ç»“æœã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97373df8834e42ad9c1e8b3512540916~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRWxhc3RpY3NlYXJjaA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769234088&amp;x-signature=uG7u2Xb1YmrUFYBplbP%2Bp2PY4Zo%3D" alt="" loading="lazy"/> å¤š agent æ¶æ„å®é™…è¿è¡Œï¼šç”¨æˆ·æŸ¥è¯¢é€šè¿‡ä¸€ä¸ª lead agent æµåŠ¨ï¼Œè¯¥ agent åˆ›å»ºä¸“é—¨çš„ subagents å¹¶è¡Œæœç´¢ä¸åŒæ–¹é¢ã€‚<br/>
å›¾ç‰‡æ¥æº: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Fmulti-agent-research-system" title="https://www.anthropic.com/engineering/multi-agent-research-system" target="_blank" ref="nofollow noopener noreferrer">www.anthropic.com/engineeringâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Fmulti-agent-research-system" title="https://www.anthropic.com/engineering/multi-agent-research-system" target="_blank" ref="nofollow noopener noreferrer">Anthropic çš„ç ”ç©¶ç­–ç•¥ä½¿ç”¨å¤šä¸ª subagents</a>ï¼Œæ¯ä¸ª subagent è°ƒæŸ¥é—®é¢˜çš„ä¸åŒæ–¹é¢ï¼Œæ‹¥æœ‰è‡ªå·±çš„ context windowï¼ŒåŒæ—¶ç”±ä¸€ä¸ª lead agent é˜…è¯»è¿™äº› subagents çš„æç‚¼ç»“æœã€‚è¿™ç§å¹¶è¡Œã€æ¨¡å—åŒ–çš„æ–¹æ³•æ„å‘³ç€æ²¡æœ‰å•ä¸€çš„ context window ä¼šè¿‡äºè‡ƒè‚¿ã€‚å®ƒè¿˜å‡å°‘äº†æ— å…³ä¿¡æ¯æ··å…¥çš„å¯èƒ½æ€§ï¼Œæ¯ä¸ªçº¿ç¨‹ä¿æŒä¸»é¢˜ç›¸å…³ï¼ˆæ²¡æœ‰ context æ··ä¹±ï¼‰ï¼Œåœ¨å›ç­”ç‰¹å®šå­é—®é¢˜æ—¶ä¸ä¼šæºå¸¦ä¸å¿…è¦çš„è´Ÿæ‹…ã€‚ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œè¿™å°±åƒè¿è¡Œç‹¬ç«‹çš„æ€ç»´çº¿ç¨‹ï¼Œåªå…±äº«ç»“æœï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ€ç»´è¿‡ç¨‹ã€‚</p>
<p>åœ¨å¤š agent ç³»ç»Ÿä¸­ï¼Œè¿™ç§æ–¹æ³•è‡³å…³é‡è¦ã€‚å¦‚æœ Agent A å¤„ç†ä»»åŠ¡ Aï¼ŒAgent B å¤„ç†ä»»åŠ¡ Bï¼Œé™¤éç¡®å®éœ€è¦ï¼Œå¦åˆ™æ²¡æœ‰ç†ç”±è®©ä»»ä¸€ agent æ¶ˆè€—å¦ä¸€ä¸ªçš„å®Œæ•´ contextã€‚ç›¸åï¼Œagents åªäº¤æ¢å¿…è¦çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼ŒAgent A å¯ä»¥é€šè¿‡ä¸€ä¸ª supervisor agent å°†å…¶å‘ç°çš„ç»¼åˆæ€»ç»“ä¼ ç»™ Agent Bï¼ŒåŒæ—¶æ¯ä¸ª subagent ä¿æŒè‡ªå·±ä¸“ç”¨çš„ context çº¿ç¨‹ã€‚è¿™ç§è®¾ç½®ä¸éœ€è¦ human-in-the-loop å¹²é¢„ï¼›å®ƒä¾èµ–äºä¸€ä¸ªå¸¦å¯ç”¨å·¥å…·çš„ supervisory agentï¼Œå¹¶è¿›è¡Œæœ€å°ä¸”å¯æ§çš„ context å…±äº«ã€‚</p>
<p>å°½ç®¡å¦‚æ­¤ï¼Œè®¾è®¡ç³»ç»Ÿæ—¶è®© agents æˆ–å·¥å…·ä»¥æœ€å°å¿…è¦ context é‡å è¿è¡Œå¯ä»¥å¤§å¤§å¢å¼ºæ¸…æ™°åº¦å’Œæ€§èƒ½ã€‚å¯ä»¥æŠŠå®ƒçœ‹ä½œ AI çš„ microservicesï¼Œæ¯ä¸ªç»„ä»¶å¤„ç†è‡ªå·±çš„ contextï¼Œç„¶åä»¥å¯æ§æ–¹å¼ä¼ é€’æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå•ä¸€åºå¤§çš„ contextã€‚è¿™äº›æœ€ä½³å®è·µé€šå¸¸ç»“åˆä½¿ç”¨ã€‚å®ƒè¿˜å…è®¸ä½ ä¿®å‰ªçç¢å†å²ï¼Œæ€»ç»“é‡è¦çš„æ—§æ¶ˆæ¯æˆ–å¯¹è¯ï¼Œå°†è¯¦ç»†æ—¥å¿—å¸è½½åˆ° Elasticsearch ä»¥ä¾›é•¿æœŸ context ä½¿ç”¨ï¼Œå¹¶åœ¨éœ€è¦æ—¶é€šè¿‡æ£€ç´¢å–å›ç›¸å…³å†…å®¹ã€‚</p>
<p>å¦‚å‰æ‰€è¿°ï¼ŒæŒ‡å¯¼åŸåˆ™æ˜¯ context æ˜¯æœ‰é™ä¸”å®è´µçš„èµ„æºã€‚ä½ å¸Œæœ› prompt ä¸­çš„æ¯ä¸ª token éƒ½ç‰©æœ‰æ‰€å€¼ï¼Œå³å®ƒåº”å½“æå‡è¾“å‡ºè´¨é‡ã€‚å¦‚æœ memory ä¸­çš„æŸäº›å†…å®¹ä¸èµ·ä½œç”¨ï¼ˆæˆ–æ›´ç³Ÿï¼Œè¿˜ä¼šé€ æˆæ··ä¹±ï¼‰ï¼Œé‚£ä¹ˆå®ƒåº”å½“è¢«ä¿®å‰ªã€æ€»ç»“æˆ–æ’é™¤ã€‚</p>
<p>ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åƒç¼–ç¨‹ä»£ç ä¸€æ ·ç¼–ç¨‹ contextï¼Œå†³å®šåŒ…å«å“ªäº›ä¿¡æ¯ã€å¦‚ä½•æ ¼å¼åŒ–ä»¥åŠä½•æ—¶çœç•¥æˆ–æ›´æ–°ã€‚éµå¾ªè¿™äº›å®è·µï¼Œæˆ‘ä»¬å¯ä»¥èµ‹äºˆ LLM agents æ‰€éœ€çš„ contextï¼Œä½¿å…¶æ‰§è¡Œä»»åŠ¡è€Œä¸å—å‰é¢æè¿°çš„å¤±è´¥æ¨¡å¼å½±å“ã€‚ç»“æœæ˜¯ agent èƒ½è®°ä½åº”è¯¥è®°ä½çš„ï¼Œå¿˜è®°ä¸éœ€è¦çš„ï¼Œå¹¶åœ¨éœ€è¦æ—¶åŠæ—¶æ£€ç´¢æ‰€éœ€å†…å®¹ã€‚</p>
<h2 data-id="heading-17">ç»“è®º</h2>
<p>Memory å¹¶ä¸æ˜¯ä½ ç»™ agent æ·»åŠ çš„ä¸œè¥¿ï¼Œè€Œæ˜¯ä½ è®¾è®¡çš„ä¸œè¥¿ã€‚Short-term memory æ˜¯ agent çš„å·¥ä½œè‰ç¨¿æ¿ï¼Œlong-term memory æ˜¯å…¶æŒä¹…çŸ¥è¯†åº“ã€‚RAG æ˜¯ä¸¤è€…ä¹‹é—´çš„æ¡¥æ¢ï¼Œå°†è¢«åŠ¨çš„æ•°æ®å­˜å‚¨ï¼ˆå¦‚ Elasticsearchï¼‰è½¬åŒ–ä¸ºå¯ä¸»åŠ¨è°ƒç”¨çš„æœºåˆ¶ï¼Œä»è€Œæ”¯æŒè¾“å‡ºå¹¶ä¿æŒ agent çš„å®æ—¶æ€§ã€‚</p>
<p>ä½† memory æ˜¯æŠŠåŒåˆƒå‰‘ã€‚ä¸€æ—¦ä½ è®© context æ— é™åˆ¶å¢é•¿ï¼Œå°±ä¼šå¼•å…¥ poisoningã€distractionã€confusion å’Œ clashï¼Œåœ¨å…±äº«ç³»ç»Ÿä¸­ç”šè‡³å¯èƒ½å‘ç”Ÿæ•°æ®æ³„æ¼ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœ€é‡è¦çš„ memory å·¥ä½œä¸æ˜¯ â€œå­˜å‚¨æ›´å¤šâ€ï¼Œè€Œæ˜¯ â€œæ›´å¥½åœ°ç­–åˆ’â€ï¼šé€‰æ‹©æ€§æ£€ç´¢ã€ç§¯æä¿®å‰ªã€è°¨æ…æ€»ç»“ï¼Œå¹¶é¿å…æ··åˆæ— å…³ contextï¼Œé™¤éä»»åŠ¡ç¡®å®è¦æ±‚ã€‚</p>
<p>åœ¨å®è·µä¸­ï¼Œè‰¯å¥½çš„ context engineering å°±åƒè‰¯å¥½çš„ç³»ç»Ÿè®¾è®¡ï¼šæ›´å°ã€è¶³å¤Ÿçš„ contextï¼Œç»„ä»¶ä¹‹é—´å—æ§çš„æ¥å£ï¼Œä»¥åŠåŸå§‹çŠ¶æ€ä¸å®é™…å¸Œæœ›æ¨¡å‹çœ‹åˆ°çš„ç²¾ç‚¼çŠ¶æ€ä¹‹é—´çš„æ¸…æ™°åˆ†ç¦»ã€‚åšå¾—å¯¹ï¼Œä½ ä¸ä¼šå¾—åˆ°ä¸€ä¸ªè®°ä½ä¸€åˆ‡çš„ agen tâ€”â€” ä½ ä¼šå¾—åˆ°ä¸€ä¸ªåœ¨æ­£ç¡®æ—¶é—´è®°ä½æ­£ç¡®äº‹æƒ…ã€å‡ºäºæ­£ç¡®åŸå› çš„ agentã€‚</p>
<p>åŸæ–‡ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.elastic.co%2Fsearch-labs%2Fblog%2Fagentic-memory-management-elasticsearch" title="https://www.elastic.co/search-labs/blog/agentic-memory-management-elasticsearch" target="_blank" ref="nofollow noopener noreferrer">www.elastic.co/search-labsâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨15ä¸ªæŠ€å·§è®©Pythonç¨‹åºé£é€Ÿè¿è¡Œ]]></title>    <link>https://juejin.cn/post/7595911076013801508</link>    <guid>https://juejin.cn/post/7595911076013801508</guid>    <pubDate>2026-01-17T05:57:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595911076013801508" data-draft-id="7460009465326239770" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨15ä¸ªæŠ€å·§è®©Pythonç¨‹åºé£é€Ÿè¿è¡Œ"/> <meta itemprop="keywords" content="æµ‹è¯•"/> <meta itemprop="datePublished" content="2026-01-17T05:57:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è½¯ä»¶æµ‹è¯•æ‚è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/4004881767865897"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨15ä¸ªæŠ€å·§è®©Pythonç¨‹åºé£é€Ÿè¿è¡Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4004881767865897/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è½¯ä»¶æµ‹è¯•æ‚è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T05:57:45.000Z" title="Sat Jan 17 2026 05:57:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¤©æˆ‘ä»¬å°±æ¥èŠèŠå¦‚ä½•ç”¨15ä¸ªæŠ€å·§è®©Pythonç¨‹åºé£é€Ÿè¿è¡Œã€‚è¿™äº›æŠ€å·§ä¸ä»…èƒ½è®©ä»£ç è·‘å¾—æ›´å¿«ï¼Œè¿˜èƒ½è®©ä½ çš„ç¼–ç¨‹æ€ç»´æ›´åŠ ä¸¥è°¨ã€‚</p>
<h2 data-id="heading-0">1. ä½¿ç”¨å†…ç½®å‡½æ•°å’Œåº“</h2>
<p>Pythonè‡ªå¸¦äº†å¾ˆå¤šé«˜æ•ˆçš„å†…ç½®å‡½æ•°å’Œåº“ï¼Œå®ƒä»¬é€šå¸¸æ¯”ä½ è‡ªå·±å†™çš„ä»£ç è¦å¿«å¾—å¤šã€‚å°½é‡ä½¿ç”¨è¿™äº›ç°æˆçš„å·¥å…·ï¼Œè€Œä¸æ˜¯è‡ªå·±é‡æ–°å‘æ˜è½®å­ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#Â ä¸æ¨èï¼šæ‰‹åŠ¨è®¡ç®—åˆ—è¡¨å…ƒç´ ä¹‹å’Œ</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">sum_list_manual</span>(<span class="hljs-params">lst</span>):
Â Â Â Â totalÂ =Â <span class="hljs-number">0</span>
Â Â Â Â <span class="hljs-keyword">for</span>Â numÂ <span class="hljs-keyword">in</span>Â lst:
Â Â Â Â Â Â Â Â totalÂ +=Â num
Â Â Â Â <span class="hljs-keyword">return</span>Â total

<span class="hljs-comment">#Â æ¨èï¼šä½¿ç”¨å†…ç½®sumå‡½æ•°</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">sum_list_builtin</span>(<span class="hljs-params">lst</span>):
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-built_in">sum</span>(lst)

<span class="hljs-comment">#Â æµ‹è¯•</span>
numbersÂ =Â [<span class="hljs-number">1</span>,Â <span class="hljs-number">2</span>,Â <span class="hljs-number">3</span>,Â <span class="hljs-number">4</span>,Â <span class="hljs-number">5</span>]
<span class="hljs-built_in">print</span>(sum_list_manual(numbers))Â Â <span class="hljs-comment">#Â è¾“å‡º:Â 15</span>
<span class="hljs-built_in">print</span>(sum_list_builtin(numbers))Â Â <span class="hljs-comment">#Â è¾“å‡º:Â 15</span>
</code></pre>
<h2 data-id="heading-1">2. ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼ä»£æ›¿å¾ªç¯</h2>
<p>åˆ—è¡¨æ¨å¯¼å¼ä¸ä»…æ›´ç®€æ´ï¼Œè€Œä¸”æ‰§è¡Œé€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#Â ä¸æ¨èï¼šä½¿ç”¨forå¾ªç¯åˆ›å»ºå¹³æ–¹æ•°åˆ—è¡¨</span>
<span class="hljs-attr">squares_loop</span>Â =Â []
forÂ iÂ inÂ range(10):
Â Â Â Â squares_loop.append(iÂ **Â 2)

<span class="hljs-comment">#Â æ¨èï¼šä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼</span>
<span class="hljs-attr">squares_comprehension</span>Â =Â [iÂ **Â <span class="hljs-number">2</span>Â forÂ iÂ inÂ range(<span class="hljs-number">10</span>)]

print(squares_loop)Â Â <span class="hljs-comment">#Â è¾“å‡º:Â [0,Â 1,Â 4,Â 9,Â 16,Â 25,Â 36,Â 49,Â 64,Â 81]</span>
print(squares_comprehension)Â Â <span class="hljs-comment">#Â è¾“å‡º:Â [0,Â 1,Â 4,Â 9,Â 16,Â 25,Â 36,Â 49,Â 64,Â 81]</span>
</code></pre>
<h2 data-id="heading-2">3. ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼èŠ‚çœå†…å­˜</h2>
<p>å½“ä½ å¤„ç†å¤§æ•°æ®é›†æ—¶ï¼Œç”Ÿæˆå™¨è¡¨è¾¾å¼å¯ä»¥èŠ‚çœå¤§é‡å†…å­˜ï¼Œå› ä¸ºå®ƒåªåœ¨éœ€è¦æ—¶ç”Ÿæˆæ•°æ®ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#Â ä¸æ¨èï¼šä½¿ç”¨åˆ—è¡¨å­˜å‚¨æ‰€æœ‰å¹³æ–¹æ•°</span>
squares_listÂ =Â [iÂ **Â <span class="hljs-number">2</span>Â <span class="hljs-keyword">for</span>Â iÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>)]

<span class="hljs-comment">#Â æ¨èï¼šä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼</span>
squares_generatorÂ =Â (iÂ **Â <span class="hljs-number">2</span>Â <span class="hljs-keyword">for</span>Â iÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>))

<span class="hljs-comment">#Â è®¡ç®—æ€»å’Œ</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>(squares_list))Â Â <span class="hljs-comment">#Â éœ€è¦å¤§é‡å†…å­˜</span>
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">sum</span>(squares_generator))Â Â <span class="hljs-comment">#Â å†…å­˜ä½¿ç”¨è¾ƒå°‘</span>
</code></pre>
<h2 data-id="heading-3">4. ä½¿ç”¨<code>set</code>è¿›è¡Œæˆå‘˜æ£€æŸ¥</h2>
<p>é›†åˆï¼ˆ<code>set</code>ï¼‰çš„æ•°æ®ç»“æ„æŸ¥æ‰¾å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(1)ï¼Œè€Œåˆ—è¡¨ï¼ˆ<code>list</code>ï¼‰æ˜¯O(n)ã€‚å› æ­¤ï¼Œå¦‚æœéœ€è¦é¢‘ç¹è¿›è¡Œæˆå‘˜æ£€æŸ¥ï¼Œä½¿ç”¨<code>set</code>ä¼šæ›´å¿«ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#Â ä¸æ¨èï¼šä½¿ç”¨åˆ—è¡¨è¿›è¡Œæˆå‘˜æ£€æŸ¥</span>
my_listÂ =Â <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>))
<span class="hljs-keyword">if</span>Â <span class="hljs-number">999999</span>Â <span class="hljs-keyword">in</span>Â my_list:
Â Â Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"Found!"</span>)

<span class="hljs-comment">#Â æ¨èï¼šä½¿ç”¨é›†åˆè¿›è¡Œæˆå‘˜æ£€æŸ¥</span>
my_setÂ =Â <span class="hljs-built_in">set</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1000000</span>))
<span class="hljs-keyword">if</span>Â <span class="hljs-number">999999</span>Â <span class="hljs-keyword">in</span>Â my_set:
Â Â Â Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"Found!"</span>)
</code></pre>
<h2 data-id="heading-4">5. ä½¿ç”¨å­—å…¸ä»£æ›¿å¤šé‡æ¡ä»¶åˆ¤æ–­</h2>
<p>å½“æœ‰å¤šä¸ªæ¡ä»¶åˆ¤æ–­æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å­—å…¸æ¥ç®€åŒ–ä»£ç ï¼Œå¹¶æé«˜æ•ˆç‡ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#Â ä¸æ¨èï¼šä½¿ç”¨å¤šé‡if-else</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">get_grade</span>(<span class="hljs-params">score</span>):
Â Â Â Â <span class="hljs-keyword">if</span>Â scoreÂ &gt;=Â <span class="hljs-number">90</span>:
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">'A'</span>
Â Â Â Â <span class="hljs-keyword">elif</span>Â scoreÂ &gt;=Â <span class="hljs-number">80</span>:
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">'B'</span>
Â Â Â Â <span class="hljs-keyword">elif</span>Â scoreÂ &gt;=Â <span class="hljs-number">70</span>:
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">'C'</span>
Â Â Â Â <span class="hljs-keyword">else</span>:
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">'D'</span>

<span class="hljs-comment">#Â æ¨èï¼šä½¿ç”¨å­—å…¸æ˜ å°„</span>
grade_mappingÂ =Â {
Â Â Â Â (<span class="hljs-number">90</span>,Â <span class="hljs-number">100</span>):Â <span class="hljs-string">'A'</span>,
Â Â Â Â (<span class="hljs-number">80</span>,Â <span class="hljs-number">89</span>):Â <span class="hljs-string">'B'</span>,
Â Â Â Â (<span class="hljs-number">70</span>,Â <span class="hljs-number">79</span>):Â <span class="hljs-string">'C'</span>,
Â Â Â Â (<span class="hljs-number">0</span>,Â <span class="hljs-number">69</span>):Â <span class="hljs-string">'D'</span>
}

<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">get_grade_dict</span>(<span class="hljs-params">score</span>):
Â Â Â Â <span class="hljs-keyword">for</span>Â key,Â valueÂ <span class="hljs-keyword">in</span>Â grade_mapping.items():
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â key[<span class="hljs-number">0</span>]Â &lt;=Â scoreÂ &lt;=Â key[<span class="hljs-number">1</span>]:
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â value

<span class="hljs-built_in">print</span>(get_grade(<span class="hljs-number">85</span>))Â Â <span class="hljs-comment">#Â è¾“å‡º:Â B</span>
<span class="hljs-built_in">print</span>(get_grade_dict(<span class="hljs-number">85</span>))Â Â <span class="hljs-comment">#Â è¾“å‡º:Â B</span>
</code></pre>
<h2 data-id="heading-5">6. ä½¿ç”¨å±€éƒ¨å˜é‡æé«˜æ€§èƒ½</h2>
<p>å±€éƒ¨å˜é‡çš„è®¿é—®é€Ÿåº¦æ¯”å…¨å±€å˜é‡å¿«ã€‚å› æ­¤ï¼Œåœ¨å¾ªç¯ä¸­å°½é‡ä½¿ç”¨å±€éƒ¨å˜é‡ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta">#Â ä¸æ¨èï¼šä½¿ç”¨å…¨å±€å˜é‡</span>
global_varÂ =Â <span class="hljs-number">10</span>
<span class="hljs-function">defÂ <span class="hljs-title">increment_global</span>():
Â Â Â Â <span class="hljs-keyword">global</span>Â global_var
Â Â Â Â <span class="hljs-keyword">for</span>Â _Â <span class="hljs-keyword">in</span>Â <span class="hljs-title">range</span>(<span class="hljs-params"><span class="hljs-number">1000000</span></span>):
Â Â Â Â Â Â Â Â global_varÂ +</span>=Â <span class="hljs-number">1</span>

<span class="hljs-meta">#Â æ¨èï¼šä½¿ç”¨å±€éƒ¨å˜é‡</span>
<span class="hljs-function">defÂ <span class="hljs-title">increment_local</span>():
Â Â Â Â local_var</span>Â =Â <span class="hljs-number">10</span>
Â Â Â Â <span class="hljs-keyword">for</span>Â _Â <span class="hljs-function"><span class="hljs-keyword">in</span>Â <span class="hljs-title">range</span>(<span class="hljs-params"><span class="hljs-number">1000000</span></span>):
Â Â Â Â Â Â Â Â local_varÂ +</span>=Â <span class="hljs-number">1</span>

increment_global()Â Â <span class="hljs-meta">#Â è¾ƒæ…¢</span>
increment_local()Â Â Â <span class="hljs-meta">#Â è¾ƒå¿«</span>
</code></pre>
<h2 data-id="heading-6">7. ä½¿ç”¨<code>functools.lru_cache</code>ç¼“å­˜ç»“æœ</h2>
<p>å¯¹äºè€—æ—¶çš„å‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥ä½¿ç”¨<code>functools.lru_cache</code>æ¥ç¼“å­˜ç»“æœï¼Œé¿å…é‡å¤è®¡ç®—ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span>Â functools

<span class="hljs-comment">#Â ä¸æ¨èï¼šæ¯æ¬¡è°ƒç”¨éƒ½é‡æ–°è®¡ç®—</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">fibonacci</span>(<span class="hljs-params">n</span>):
Â Â Â Â <span class="hljs-keyword">if</span>Â nÂ &lt;=Â <span class="hljs-number">1</span>:
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â n
Â Â Â Â <span class="hljs-keyword">return</span>Â fibonacci(n-<span class="hljs-number">1</span>)Â +Â fibonacci(n-<span class="hljs-number">2</span>)

<span class="hljs-comment">#Â æ¨èï¼šä½¿ç”¨ç¼“å­˜</span>
<span class="hljs-meta">@functools.lru_cache(<span class="hljs-params">maxsize=<span class="hljs-literal">None</span></span>)</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">fibonacci_cached</span>(<span class="hljs-params">n</span>):
Â Â Â Â <span class="hljs-keyword">if</span>Â nÂ &lt;=Â <span class="hljs-number">1</span>:
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â n
Â Â Â Â <span class="hljs-keyword">return</span>Â fibonacci_cached(n-<span class="hljs-number">1</span>)Â +Â fibonacci_cached(n-<span class="hljs-number">2</span>)

<span class="hljs-built_in">print</span>(fibonacci(<span class="hljs-number">30</span>))Â Â <span class="hljs-comment">#Â è¾ƒæ…¢</span>
<span class="hljs-built_in">print</span>(fibonacci_cached(<span class="hljs-number">30</span>))Â Â <span class="hljs-comment">#Â è¾ƒå¿«</span>
</code></pre>
<h2 data-id="heading-7">8. ä½¿ç”¨<code>numpy</code>å¤„ç†æ•°å€¼è®¡ç®—</h2>
<p><code>numpy</code>æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨äºç§‘å­¦è®¡ç®—çš„åº“ï¼Œå®ƒæä¾›äº†é«˜æ•ˆçš„æ•°ç»„æ“ä½œåŠŸèƒ½ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-lua" lang="lua">importÂ numpyÂ asÂ np

#Â ä¸æ¨èï¼šä½¿ç”¨çº¯Pythonåˆ—è¡¨è¿›è¡ŒçŸ©é˜µä¹˜æ³•
matrix_aÂ =Â <span class="hljs-string">[[1,Â 2],Â [3,Â 4]]</span>
matrix_bÂ =Â <span class="hljs-string">[[5,Â 6],Â [7,Â 8]]</span>

resultÂ =Â <span class="hljs-string">[[0,Â 0],Â [0,Â 0]]</span>
<span class="hljs-keyword">for</span>Â iÂ <span class="hljs-keyword">in</span>Â range(<span class="hljs-built_in">len</span>(matrix_a)):
Â Â Â Â <span class="hljs-keyword">for</span>Â jÂ <span class="hljs-keyword">in</span>Â range(<span class="hljs-built_in">len</span>(matrix_b[<span class="hljs-number">0</span>])):
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â kÂ <span class="hljs-keyword">in</span>Â range(<span class="hljs-built_in">len</span>(matrix_b)):
Â Â Â Â Â Â Â Â Â Â Â Â result[i][j]Â +=Â matrix_a[i][k]Â *Â matrix_b[k][j]

#Â æ¨èï¼šä½¿ç”¨numpyè¿›è¡ŒçŸ©é˜µä¹˜æ³•
matrix_a_npÂ =Â np.array(matrix_a)
matrix_b_npÂ =Â np.array(matrix_b)
result_npÂ =Â np.dot(matrix_a_np,Â matrix_b_np)

<span class="hljs-built_in">print</span>(result)Â Â #Â è¾“å‡º:Â <span class="hljs-string">[[19,Â 22],Â [43,Â 50]]</span>
<span class="hljs-built_in">print</span>(result_np)Â Â #Â è¾“å‡º:Â <span class="hljs-string">[[19Â 22]Â [43Â 50]]</span>
</code></pre>
<h2 data-id="heading-8">9. ä½¿ç”¨<code>pandas</code>å¤„ç†æ•°æ®</h2>
<p><code>pandas</code>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ•°æ®åˆ†æåº“ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†è¡¨æ ¼æ•°æ®ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">importÂ pandasÂ asÂ pd

<span class="hljs-comment">#Â ä¸æ¨èï¼šä½¿ç”¨çº¯Pythonå­—å…¸å’Œåˆ—è¡¨å¤„ç†æ•°æ®</span>
<span class="hljs-attr">data</span>Â =Â {<span class="hljs-string">'Name'</span>:Â [<span class="hljs-string">'Alice'</span>,Â <span class="hljs-string">'Bob'</span>,Â <span class="hljs-string">'Charlie'</span>],Â <span class="hljs-string">'Age'</span>:Â [<span class="hljs-number">25</span>,Â <span class="hljs-number">30</span>,Â <span class="hljs-number">35</span>]}
<span class="hljs-attr">ages</span>Â =Â [ageÂ forÂ ageÂ inÂ data[<span class="hljs-string">'Age'</span>]Â ifÂ ageÂ &gt;Â <span class="hljs-number">30</span>]

<span class="hljs-comment">#Â æ¨èï¼šä½¿ç”¨pandaså¤„ç†æ•°æ®</span>
<span class="hljs-attr">df</span>Â =Â pd.DataFrame(data)
<span class="hljs-attr">filtered_df</span>Â =Â df[df[<span class="hljs-string">'Age'</span>]Â &gt;Â <span class="hljs-number">30</span>]

print(ages)Â Â <span class="hljs-comment">#Â è¾“å‡º:Â [35]</span>
print(filtered_df)Â Â <span class="hljs-comment">#Â è¾“å‡º:Â Â Â Â Â Â NameÂ Â Age</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">#Â 2Â Â CharlieÂ Â Â 35</span>
</code></pre>
<h2 data-id="heading-9">10. ä½¿ç”¨<code>multiprocessing</code>è¿›è¡Œå¹¶è¡Œå¤„ç†</h2>
<p>å¦‚æœä½ çš„ä»»åŠ¡æ˜¯å¯ä»¥å¹¶è¡ŒåŒ–çš„ï¼Œé‚£ä¹ˆä½¿ç”¨<code>multiprocessing</code>æ¨¡å—å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span>Â multiprocessing

<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">square</span>(<span class="hljs-params">x</span>):
Â Â Â Â <span class="hljs-keyword">return</span>Â xÂ **Â <span class="hljs-number">2</span>

<span class="hljs-comment">#Â ä¸æ¨èï¼šä¸²è¡Œå¤„ç†</span>
results_serialÂ =Â [square(i)Â <span class="hljs-keyword">for</span>Â iÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]

<span class="hljs-comment">#Â æ¨èï¼šå¹¶è¡Œå¤„ç†</span>
poolÂ =Â multiprocessing.Pool()
results_parallelÂ =Â pool.<span class="hljs-built_in">map</span>(square,Â <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>))
pool.close()
pool.join()

<span class="hljs-built_in">print</span>(results_serial)Â Â <span class="hljs-comment">#Â è¾“å‡º:Â [0,Â 1,Â 4,Â 9,Â 16,Â 25,Â 36,Â 49,Â 64,Â 81]</span>
<span class="hljs-built_in">print</span>(results_parallel)Â Â <span class="hljs-comment">#Â è¾“å‡º:Â [0,Â 1,Â 4,Â 9,Â 16,Â 25,Â 36,Â 49,Â 64,Â 81]</span>
</code></pre>
<h2 data-id="heading-10">11. ä½¿ç”¨<code>asyncio</code>è¿›è¡Œå¼‚æ­¥ç¼–ç¨‹</h2>
<p>å¯¹äºI/Oå¯†é›†å‹ä»»åŠ¡ï¼Œä½¿ç”¨<code>asyncio</code>å¯ä»¥æé«˜ç¨‹åºçš„å“åº”é€Ÿåº¦ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span>Â asyncio

<span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">fetch_data</span>():
Â Â Â Â <span class="hljs-keyword">await</span>Â asyncio.sleep(<span class="hljs-number">1</span>)
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"DataÂ fetched"</span>

<span class="hljs-comment">#Â ä¸æ¨èï¼šåŒæ­¥ç­‰å¾…</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">sync_fetch</span>():
Â Â Â Â <span class="hljs-keyword">import</span>Â time
Â Â Â Â time.sleep(<span class="hljs-number">1</span>)
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"DataÂ fetched"</span>

<span class="hljs-comment">#Â æ¨èï¼šå¼‚æ­¥ç­‰å¾…</span>
<span class="hljs-keyword">async</span>Â <span class="hljs-keyword">def</span>Â <span class="hljs-title function_">main</span>():
Â Â Â Â resultÂ =Â <span class="hljs-keyword">await</span>Â fetch_data()
Â Â Â Â <span class="hljs-built_in">print</span>(result)

asyncio.run(main())Â Â <span class="hljs-comment">#Â è¾“å‡º:Â DataÂ fetched</span>
</code></pre>
<h2 data-id="heading-11">12. ä½¿ç”¨<code>cython</code>ç¼–è¯‘Pythonä»£ç </h2>
<p><code>cython</code>å¯ä»¥å°†Pythonä»£ç ç¼–è¯‘æˆCä»£ç ï¼Œä»è€Œæé«˜æ‰§è¡Œé€Ÿåº¦ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment">#Â ä¸æ¨èï¼šçº¯Pythonä»£ç </span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">slow_function</span>(<span class="hljs-params">n</span>):
Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-built_in">sum</span>(iÂ *Â iÂ <span class="hljs-keyword">for</span>Â iÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(n))

<span class="hljs-comment">#Â æ¨èï¼šä½¿ç”¨Cythonç¼–è¯‘</span>
<span class="hljs-comment">#Â åœ¨æ–‡ä»¶slow_function.pyxä¸­å®šä¹‰</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">fast_function</span>(<span class="hljs-params"><span class="hljs-built_in">int</span>Â n</span>):
Â Â Â Â cdefÂ <span class="hljs-built_in">int</span>Â i,Â resultÂ =Â <span class="hljs-number">0</span>
Â Â Â Â <span class="hljs-keyword">for</span>Â iÂ <span class="hljs-keyword">in</span>Â <span class="hljs-built_in">range</span>(n):
Â Â Â Â Â Â Â Â resultÂ +=Â iÂ *Â i
Â Â Â Â <span class="hljs-keyword">return</span>Â result

<span class="hljs-comment">#Â ç¼–è¯‘å¹¶å¯¼å…¥</span>
<span class="hljs-keyword">from</span>Â distutils.coreÂ <span class="hljs-keyword">import</span>Â setup
<span class="hljs-keyword">from</span>Â Cython.BuildÂ <span class="hljs-keyword">import</span>Â cythonize

setup(ext_modules=cythonize(<span class="hljs-string">"slow_function.pyx"</span>))

<span class="hljs-keyword">from</span>Â slow_functionÂ <span class="hljs-keyword">import</span>Â fast_function

<span class="hljs-built_in">print</span>(slow_function(<span class="hljs-number">1000000</span>))Â Â <span class="hljs-comment">#Â è¾ƒæ…¢</span>
<span class="hljs-built_in">print</span>(fast_function(<span class="hljs-number">1000000</span>))Â Â <span class="hljs-comment">#Â è¾ƒå¿«</span>
</code></pre>
<h2 data-id="heading-12">13. ä½¿ç”¨<code>numba</code>åŠ é€Ÿæ•°å€¼è®¡ç®—</h2>
<p><code>numba</code>å¯ä»¥é€šè¿‡å³æ—¶ç¼–è¯‘æŠ€æœ¯åŠ é€Ÿæ•°å€¼è®¡ç®—ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span>Â numba

<span class="hljs-meta">@numba.jit</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">fast_sum</span>(<span class="hljs-params">a,Â b</span>):
Â Â Â Â <span class="hljs-keyword">return</span>Â aÂ +Â b

<span class="hljs-comment">#Â ä¸æ¨èï¼šçº¯PythonåŠ æ³•</span>
<span class="hljs-keyword">def</span>Â <span class="hljs-title function_">slow_sum</span>(<span class="hljs-params">a,Â b</span>):
Â Â Â Â <span class="hljs-keyword">return</span>Â aÂ +Â b

<span class="hljs-built_in">print</span>(slow_sum(<span class="hljs-number">10</span>,Â <span class="hljs-number">20</span>))Â Â <span class="hljs-comment">#Â è¾“å‡º:Â 30</span>
<span class="hljs-built_in">print</span>(fast_sum(<span class="hljs-number">10</span>,Â <span class="hljs-number">20</span>))Â Â <span class="hljs-comment">#Â è¾“å‡º:Â 30</span>
</code></pre>
<h2 data-id="heading-13">14. ä½¿ç”¨<code>cProfile</code>è¿›è¡Œæ€§èƒ½åˆ†æ</h2>
<p>åœ¨ä¼˜åŒ–ä»£ç ä¹‹å‰ï¼Œå…ˆä½¿ç”¨<code>cProfile</code>æ‰¾å‡ºç“¶é¢ˆæ‰€åœ¨ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function"><span class="hljs-keyword">import</span>Â cProfile

defÂ <span class="hljs-title">profile_me</span><span class="hljs-params">()</span>:
Â Â Â Â totalÂ =</span>Â <span class="hljs-number">0</span>
Â Â Â Â <span class="hljs-function"><span class="hljs-keyword">for</span>Â iÂ inÂ <span class="hljs-title">range</span><span class="hljs-params">(<span class="hljs-number">1000000</span>)</span>:
Â Â Â Â Â Â Â Â totalÂ +=</span>Â i
Â Â Â Â <span class="hljs-keyword">return</span>Â total

cProfile.<span class="hljs-built_in">run</span>(<span class="hljs-string">'profile_me()'</span>)
</code></pre>
<h2 data-id="heading-14">15. ä½¿ç”¨<code>line_profiler</code>è¿›è¡Œé€è¡Œåˆ†æ</h2>
<p><code>line_profiler</code>å¯ä»¥å¸®åŠ©ä½ æ‰¾åˆ°å…·ä½“å“ªä¸€è¡Œä»£ç æœ€è€—æ—¶ã€‚</p>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment">#Â å®‰è£…line_profiler</span>
<span class="hljs-comment">#Â pipÂ installÂ line_profiler</span>

@profile
defÂ function_to_profile():
Â Â Â Â <span class="hljs-attr">a</span>Â =Â <span class="hljs-number">2</span>
Â Â Â Â <span class="hljs-attr">b</span>Â =Â <span class="hljs-number">3</span>
Â Â Â Â <span class="hljs-attr">c</span>Â =Â aÂ +Â b
Â Â Â Â returnÂ c

function_to_profile()
</code></pre>
<h2 data-id="heading-15">å®æˆ˜æ¡ˆä¾‹ï¼šä¼˜åŒ–å›¾åƒå¤„ç†ç®—æ³•</h2>
<p>å‡è®¾ä½ éœ€è¦ç¼–å†™ä¸€ä¸ªå›¾åƒå¤„ç†ç¨‹åºï¼Œå°†ä¸€å¼ å›¾ç‰‡è½¬æ¢ä¸ºç°åº¦å›¾ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•åº”ç”¨ä¸Šè¿°æŠ€å·§æ¥ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<p><strong>åŸå§‹ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-function">fromÂ PILÂ <span class="hljs-keyword">import</span>Â Image

defÂ <span class="hljs-title">to_grayscale</span><span class="hljs-params">(image_path)</span>:
Â Â Â Â imageÂ =</span>Â Image.<span class="hljs-built_in">open</span>(image_path)
Â Â Â Â width,Â heightÂ =Â image.size
Â Â Â Â grayscale_imageÂ =Â Image.<span class="hljs-built_in">new</span>(<span class="hljs-string">'L'</span>,Â (width,Â height))

Â Â Â Â <span class="hljs-keyword">for</span>Â xÂ inÂ <span class="hljs-built_in">range</span>(width):
Â Â Â Â Â Â Â Â <span class="hljs-keyword">for</span>Â yÂ inÂ <span class="hljs-built_in">range</span>(height):
Â Â Â Â Â Â Â Â Â Â Â Â r,Â g,Â bÂ =Â image.<span class="hljs-built_in">getpixel</span>((x,Â y))
Â Â Â Â Â Â Â Â Â Â Â Â grayÂ =Â <span class="hljs-built_in">int</span>(<span class="hljs-number">0.299</span>Â *Â rÂ +Â <span class="hljs-number">0.587</span>Â *Â gÂ +Â <span class="hljs-number">0.114</span>Â *Â b)
Â Â Â Â Â Â Â Â Â Â Â Â grayscale_image.<span class="hljs-built_in">putpixel</span>((x,Â y),Â gray)

Â Â Â Â grayscale_image.<span class="hljs-built_in">save</span>(<span class="hljs-string">'grayscale.jpg'</span>)

<span class="hljs-built_in">to_grayscale</span>(<span class="hljs-string">'input.jpg'</span>)
</code></pre>
<p><strong>ä¼˜åŒ–åçš„ä»£ç ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">importÂ numpyÂ asÂ np
fromÂ PILÂ importÂ Image

defÂ <span class="hljs-built_in">to_grayscale_optimized</span>(image_path):
Â Â Â Â imageÂ =Â Image.<span class="hljs-built_in">open</span>(image_path).<span class="hljs-built_in">convert</span>(<span class="hljs-string">'RGB'</span>)
Â Â Â Â image_arrayÂ =Â np.<span class="hljs-built_in">array</span>(image)
Â Â Â Â grayscale_arrayÂ =Â np.<span class="hljs-built_in">dot</span>(image_array[...,Â :<span class="hljs-number">3</span>],Â [<span class="hljs-number">0.299</span>,Â <span class="hljs-number">0.587</span>,Â <span class="hljs-number">0.114</span>]).<span class="hljs-built_in">astype</span>(np.uint8)
Â Â Â Â grayscale_imageÂ =Â Image.<span class="hljs-built_in">fromarray</span>(grayscale_array,Â <span class="hljs-string">'L'</span>)
Â Â Â Â grayscale_image.<span class="hljs-built_in">save</span>(<span class="hljs-string">'grayscale.jpg'</span>)

<span class="hljs-built_in">to_grayscale_optimized</span>(<span class="hljs-string">'input.jpg'</span>)
</code></pre>
<p>åœ¨è¿™ä¸ªå®æˆ˜æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>numpy</code>æ¥è¿›è¡Œé«˜æ•ˆçš„æ•°ç»„æ“ä½œï¼Œé¿å…äº†æ˜¾å¼çš„åŒé‡å¾ªç¯ï¼Œä»è€Œå¤§å¤§æé«˜äº†ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ã€‚</p>
<h2 data-id="heading-16">æ€»ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†15ä¸ªè®©Pythonç¨‹åºé£é€Ÿè¿è¡Œçš„æŠ€å·§ï¼ŒåŒ…æ‹¬ä½¿ç”¨å†…ç½®å‡½æ•°å’Œåº“ã€åˆ—è¡¨æ¨å¯¼å¼ã€ç”Ÿæˆå™¨è¡¨è¾¾å¼ã€é›†åˆæˆå‘˜æ£€æŸ¥ã€å­—å…¸æ˜ å°„ã€å±€éƒ¨å˜é‡ã€ç¼“å­˜ç»“æœã€<code>numpy</code>å’Œ<code>pandas</code>åº“ã€å¹¶è¡Œå’Œå¼‚æ­¥å¤„ç†ã€<code>cython</code>å’Œ<code>numba</code>ç¼–è¯‘ã€æ€§èƒ½åˆ†æå·¥å…·ç­‰ã€‚é€šè¿‡è¿™äº›æŠ€å·§ï¼Œä½ å¯ä»¥å†™å‡ºæ›´é«˜æ•ˆã€æ›´ä¼˜é›…çš„Pythonä»£ç ã€‚</p>
<p><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fitem.jd.com%2F13967704.html" title="https://link.juejin.cn/?target=https%3A%2F%2Fitem.jd.com%2F13967704.html" target="_blank">æµ‹è¯•æ–°äººå¯ä»¥å­¦ä¹ ã€Šæµ‹è¯•äººçš„ Python å·¥å…·ä¹¦ã€‹ä¹¦ç±</a>ã€<a href="https://link.juejin.cn/?target=https%3A%2F%2Fitem.jd.com%2F13543572.html" title="https://link.juejin.cn/?target=https%3A%2F%2Fitem.jd.com%2F13543572.html" target="_blank">ã€Šæ€§èƒ½æµ‹è¯• JMeter å®æˆ˜ã€‹ä¹¦ç±</a></strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‹’ç»â€œé¢æ¡ä»£ç â€ï¼šNestJS æ˜¯å¦‚ä½•ç”¨ DI å’Œæ¨¡å—åŒ–é‡å¡‘ Node.js åç«¯çš„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595808703074140186</link>    <guid>https://juejin.cn/post/7595808703074140186</guid>    <pubDate>2026-01-17T05:57:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595808703074140186" data-draft-id="7595831738234273801" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‹’ç»â€œé¢æ¡ä»£ç â€ï¼šNestJS æ˜¯å¦‚ä½•ç”¨ DI å’Œæ¨¡å—åŒ–é‡å¡‘ Node.js åç«¯çš„ï¼Ÿ"/> <meta itemprop="keywords" content="NestJS"/> <meta itemprop="datePublished" content="2026-01-17T05:57:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç™½å…°åœ°ç©ºç“¶"/> <meta itemprop="url" content="https://juejin.cn/user/191753514127514"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‹’ç»â€œé¢æ¡ä»£ç â€ï¼šNestJS æ˜¯å¦‚ä½•ç”¨ DI å’Œæ¨¡å—åŒ–é‡å¡‘ Node.js åç«¯çš„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/191753514127514/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç™½å…°åœ°ç©ºç“¶
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T05:57:47.000Z" title="Sat Jan 17 2026 05:57:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>å‰è¨€</strong>ï¼šåœ¨ Node.js ç”Ÿæ€ä¸­ï¼ŒExpress å’Œ Koa ç»Ÿæ²»äº†å¤šå¹´ã€‚å®ƒä»¬ç®€å•çµæ´»ï¼Œä½†åœ¨é¢å¯¹å¤§å‹ä¼ä¸šçº§é¡¹ç›®æ—¶ï¼Œå¼€å‘è€…å¾€å¾€ä¼šé™·å…¥â€œæ¶æ„æ··ä¹±â€ã€â€œä¾èµ–è€¦åˆâ€ã€â€œç¼ºä¹è§„èŒƒâ€çš„æ³¥æ½­ã€‚</p>
<p><strong>NestJS</strong> çš„å‡ºç°ï¼Œå°†åç«¯å¼€å‘ä»â€œè„šæœ¬å¼â€è½¬å‘äº†çœŸæ­£çš„â€œå·¥ç¨‹åŒ–â€ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œæ›´æ˜¯ä¸€å¥—èåˆäº† OOPï¼ˆé¢å‘å¯¹è±¡ï¼‰ã€FPï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼‰å’Œ FRPï¼ˆå‡½æ•°å“åº”å¼ç¼–ç¨‹ï¼‰çš„æ¶æ„å“²å­¦ã€‚æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥ NestJS çš„æ ¸å¿ƒï¼Œç†è§£é‚£äº›ç²¾å¦™çš„è®¾è®¡æ¨¡å¼ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€å·¥å‚æ¨¡å¼ä¸å…¥å£è®¾è®¡ï¼šä¸€åˆ‡ä» <code>main.ts</code> è¯´èµ·</h2>
<p>å¾ˆå¤šæ–°æ‰‹çœ‹åˆ° <code>main.ts</code> è§‰å¾—å¹³å¹³æ— å¥‡ï¼Œä½†è¿™é‡Œè—ç€ NestJS çš„ç¬¬ä¸€ä¸ªè®¾è®¡æ¨¡å¼ï¼š<strong>å·¥å‚æ¨¡å¼</strong>ã€‚</p>
<p>TypeScript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.ts</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">NestFactory</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/core'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">AppModule</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.module'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">bootstrap</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> <span class="hljs-title class_">NestFactory</span>.<span class="hljs-title function_">create</span>(<span class="hljs-title class_">AppModule</span>);
  <span class="hljs-keyword">await</span> app.<span class="hljs-title function_">listen</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> ?? <span class="hljs-number">3000</span>);
}
<span class="hljs-title function_">bootstrap</span>();
</code></pre>
<h3 data-id="heading-1">1. ä¸ºä»€ä¹ˆæ˜¯ <code>NestFactory</code>ï¼Ÿ</h3>
<p>NestJS å¹¶æ²¡æœ‰è®©æˆ‘ä»¬ç›´æ¥ <code>new App()</code>ï¼Œè€Œæ˜¯é€šè¿‡ <code>NestFactory.create()</code> æ¥æ„å»ºåº”ç”¨ã€‚è¿™ä¸ä»…ä»…æ˜¯ä¸ºäº†åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œå®ƒåœ¨å¹•åå®Œæˆäº†å…³é”®çš„<strong>åˆå§‹åŒ–å·¥ä½œ</strong>ï¼š</p>
<ul>
<li><strong>IoC å®¹å™¨è£…è½½</strong>ï¼šæ‰«ææ•´ä¸ªæ¨¡å—æ ‘ï¼Œè§£ææ‰€æœ‰ç±»ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</li>
<li><strong>å¹³å°æ— å…³æ€§</strong>ï¼šNestJS é»˜è®¤åŸºäº Expressï¼Œä½†å¯ä»¥é€šè¿‡å·¥å‚è½»æ¾åˆ‡æ¢åˆ°åº•å±‚æ›´å¿«çš„ Fastifyï¼Œè€Œæ— éœ€ä¿®æ”¹ä¸šåŠ¡ä»£ç ã€‚</li>
</ul>
<h3 data-id="heading-2">2. <code>??</code> è¿ç®—ç¬¦çš„æ·±æ„</h3>
<p>æ³¨æ„ <code>process.env.PORT ?? 3000</code>ã€‚è¿™æ˜¯ ES2020 çš„ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦ã€‚</p>
<ul>
<li><strong>ä¼ ç»Ÿå†™æ³•</strong>ï¼š<code>PORT || 3000</code>ã€‚å¦‚æœç¯å¢ƒå˜é‡è¯¯ä¼ äº† <code>0</code>ï¼Œ<code>||</code> ä¼šå°†å…¶è§†ä¸ºå‡å€¼ä»è€Œä½¿ç”¨ 3000ï¼Œå¯¼è‡´é€»è¾‘é”™è¯¯ã€‚</li>
<li><strong>ä¸¥è°¨å†™æ³•</strong>ï¼š<code>??</code> ä»…åœ¨ <code>undefined</code> æˆ– <code>null</code> æ—¶å›é€€ã€‚è¿™ä½“ç°äº†ä¼ä¸šçº§å¼€å‘ä¸­å¯¹<strong>é…ç½®ä¸¥è°¨æ€§</strong>çš„è¦æ±‚ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">äºŒã€æ¨¡å—ç³»ç»Ÿï¼šä¹é«˜ç§¯æœ¨å¼çš„æ¶æ„åŸºçŸ³</h2>
<p>åœ¨ Express ä¸­ï¼Œæˆ‘ä»¬å¸¸é€šè¿‡æ–‡ä»¶å¤¹æ¥ç»„ç»‡ä»£ç ï¼›è€Œåœ¨ NestJS ä¸­ï¼Œ<strong>Moduleï¼ˆæ¨¡å—ï¼‰</strong> æ˜¯ç»„ç»‡ä»£ç çš„ç‰©ç†è¾¹ç•Œã€‚</p>
<p>TypeScript</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Module</span>({
  <span class="hljs-attribute">imports</span>: [UsersModule, DatabaseModule], <span class="hljs-comment">// å¯¼å…¥å…¶ä»–æ¨¡å—</span>
  <span class="hljs-attribute">controllers</span>: [AppController],           <span class="hljs-comment">// æ³¨å†Œæ§åˆ¶å™¨</span>
  <span class="hljs-attribute">providers</span>: [AppService],                <span class="hljs-comment">// æ³¨å†ŒæœåŠ¡</span>
  <span class="hljs-attribute">exports</span>: [AppService]                   <span class="hljs-comment">// å¯¼å‡ºæœåŠ¡ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨</span>
})
export class AppModule {}
</code></pre>
<h3 data-id="heading-4">æ¶æ„æ€è€ƒï¼šä¸ºä»€ä¹ˆè¦å¼ºåˆ¶æ¨¡å—åŒ–ï¼Ÿ</h3>
<ol>
<li><strong>ä¾èµ–éš”ç¦»</strong>ï¼šæ¯ä¸ªæ¨¡å—å°±åƒä¸€ä¸ªç‹¬ç«‹çš„â€œå¾®æœåŠ¡â€å•å…ƒï¼Œæ‹¥æœ‰è‡ªå·±çš„ä¸Šä¸‹æ–‡ã€‚</li>
<li><strong>æ˜¾å¼ä¾èµ–</strong>ï¼šé€šè¿‡ <code>imports</code> å’Œ <code>exports</code>ï¼Œæ¨¡å—é—´çš„ä¾èµ–å…³ç³»æ¸…æ™°å¯è§ï¼Œæ‹’ç»â€œéšå¼å¼•ç”¨â€å¸¦æ¥çš„ç»´æŠ¤å™©æ¢¦ã€‚</li>
<li><strong>å¾ªç¯ä¾èµ–æ£€æµ‹</strong>ï¼šNestJS åœ¨ç¼–è¯‘æœŸå°±èƒ½åˆ©ç”¨æ¨¡å—å›¾è°±æ£€æµ‹å‡º A ä¾èµ– Bï¼ŒB ä¾èµ– A çš„æ­»é”é—®é¢˜ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€æ ¸å¿ƒçµé­‚ï¼šä¾èµ–æ³¨å…¥ (Dependency Injection)</h2>
<p>è¿™æ˜¯ NestJS æœ€åŠé€€æ–°æ‰‹ï¼Œä¹Ÿæ˜¯æœ€å¼ºå¤§çš„ç‰¹æ€§ã€‚</p>
<h3 data-id="heading-6">1. ä»€ä¹ˆæ˜¯ DIï¼Ÿ</h3>
<ul>
<li><strong>æ§åˆ¶åè½¬ (IoC)</strong> ï¼šä¸è¦è‡ªå·±åœ¨ä»£ç é‡Œ <code>new Service()</code>ï¼Œè€Œæ˜¯å‘æ¡†æ¶â€œç”³è¯·â€ä¸€ä¸ª Serviceã€‚</li>
<li><strong>ä¾èµ–æ³¨å…¥ (DI)</strong> ï¼šæ¡†æ¶ï¼ˆIoC å®¹å™¨ï¼‰åœ¨è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨æŠŠä½ éœ€è¦çš„å¯¹è±¡å¡ç»™ä½ ã€‚</li>
</ul>
<h3 data-id="heading-7">2. å®æˆ˜å¯¹æ¯”</h3>
<p><strong>âŒ ä¼ ç»Ÿå†™æ³•ï¼ˆå¼ºè€¦åˆï¼‰ï¼š</strong></p>
<p>TypeScript</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AppController</span> {
  <span class="hljs-keyword">private</span> appService;
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.appService = new AppService(); <span class="hljs-comment">// è‡ªå·±åˆ›å»ºï¼Œéš¾ä»¥æµ‹è¯•ï¼Œéš¾ä»¥æ›¿æ¢</span>
  }
}
</code></pre>
<p><strong>âœ… NestJS å†™æ³•ï¼ˆæ¾è€¦åˆï¼‰ï¼š</strong></p>
<p>TypeScript</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Controller</span>()
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppController</span> {
  <span class="hljs-comment">// åªéœ€è¦å£°æ˜ç±»å‹ï¼ŒNestJS è‡ªåŠ¨æ³¨å…¥å®ä¾‹</span>
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> appService: AppService</span>) {} 
}
</code></pre>
<h3 data-id="heading-8">3. é«˜çº§ç©æ³•ï¼šè‡ªå®šä¹‰ Provider</h3>
<p>DI ä¸ä»…ä»…èƒ½æ³¨å…¥ç±»ï¼Œè¿˜èƒ½æ³¨å…¥<strong>å€¼</strong>æˆ–<strong>å¼‚æ­¥è¿æ¥</strong>ï¼ˆå¦‚æ•°æ®åº“è¿æ¥æ± ï¼‰ã€‚</p>
<p>TypeScript</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// database.module.ts</span>
<span class="hljs-keyword">const</span> dbProvider = {
  <span class="hljs-attr">provide</span>: <span class="hljs-string">'PG_CONNECTION'</span>, <span class="hljs-comment">// ä»¤ç‰Œ (Token)</span>
  <span class="hljs-attr">useValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pool</span>({ <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>, ... }) <span class="hljs-comment">// ç›´æ¥æ³¨å…¥ä¸€ä¸ªè¿æ¥æ± å®ä¾‹</span>
};

<span class="hljs-meta">@Module</span>({
  <span class="hljs-attr">providers</span>: [dbProvider],
  <span class="hljs-attr">exports</span>: [<span class="hljs-string">'PG_CONNECTION'</span>] <span class="hljs-comment">// å¯¼å‡ºç»™å…¶ä»–æ¨¡å—ç”¨</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseModule</span> {}
</code></pre>
<p>åœ¨ Service ä¸­ä½¿ç”¨ï¼š</p>
<p>TypeScript</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">constructor</span>(<span class="hljs-variable">@Inject</span>(<span class="hljs-string">'PG_CONNECTION'</span>) private <span class="hljs-attribute">conn</span>: Pool) {}
</code></pre>
<p>è¿™ç§è®¾è®¡è®©ç¬¬ä¸‰æ–¹åº“çš„é›†æˆå˜å¾—å¼‚å¸¸ä¼˜é›…ä¸”æ˜“äºç®¡ç†ã€‚</p>
<hr/>
<h2 data-id="heading-9">å››ã€è£…é¥°å™¨</h2>
<p>NestJS ä»£ç é‡Œåˆ°å¤„éƒ½æ˜¯ <code>@Get</code>, <code>@Controller</code>, <code>@Injectable</code>ã€‚è¿™äº›<strong>è£…é¥°å™¨ (Decorators)</strong> åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯<strong>å…ƒæ•°æ® (Metadata) çš„è½½ä½“</strong>ã€‚</p>
<p>å½“ä½ åœ¨ç±»ä¸Šå†™ <code>@Controller('cats')</code> æ—¶ï¼ŒNestJS å¹¶ä¸ä¼šä¿®æ”¹è¿™ä¸ªç±»ï¼Œè€Œæ˜¯é€šè¿‡ <code>Reflect Metadata</code> API åœ¨è¿™ä¸ªç±»ä¸Šæ‰“äº†ä¸€ä¸ªâ€œæ ‡ç­¾â€ã€‚</p>
<p><strong>è¿è¡Œæµç¨‹è§£æï¼š</strong></p>
<ol>
<li><strong>ç¼–è¯‘æœŸ</strong>ï¼šTS ä¿ç•™è£…é¥°å™¨ä¿¡æ¯ã€‚</li>
<li><strong>å¯åŠ¨æ—¶</strong>ï¼šNestJS æ‰«ææ‰€æœ‰ç±»ï¼Œè¯»å–è¿™äº›å…ƒæ•°æ®ã€‚</li>
<li><strong>è·¯ç”±æ˜ å°„</strong>ï¼šå‘ç° <code>@Get('list')</code>ï¼Œå°±è‡ªåŠ¨ç”Ÿæˆä¸€æ¡ <code>GET /cats/list</code> çš„è·¯ç”±è§„åˆ™ã€‚</li>
</ol>
<p>è¿™ç§<strong>å£°æ˜å¼ç¼–ç¨‹</strong>å¤§å¤§å‡å°‘äº†æ ·æ¿ä»£ç ï¼Œè®©å¼€å‘è€…ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘è€Œéåº•å±‚å®ç°ã€‚</p>
<hr/>
<h2 data-id="heading-10">äº”ã€HTTP è¯­ä¹‰åŒ–ï¼šRESTful çš„æœ€ä½³å®è·µ</h2>
<p>NestJS ä¸¥æ ¼éµå¾ª RESTful è§„èŒƒï¼Œæä¾›äº†å®Œæ•´çš„åŠ¨è¯è£…é¥°å™¨ã€‚</p>









































<table><thead><tr><th><strong>è£…é¥°å™¨</strong></th><th><strong>å¯¹åº”åŠ¨ä½œ</strong></th><th><strong>è¯­ä¹‰åœºæ™¯</strong></th><th><strong>æ¶æ„å¸ˆå¤‡æ³¨</strong></th></tr></thead><tbody><tr><td><code>@Get()</code></td><td>GET</td><td>æŸ¥è¯¢èµ„æº</td><td>å¹‚ç­‰ï¼Œä¸åº”äº§ç”Ÿå‰¯ä½œç”¨</td></tr><tr><td><code>@Post()</code></td><td>POST</td><td>åˆ›å»ºèµ„æº</td><td>éå¹‚ç­‰ï¼Œå¸¸ç”¨äºæ–°å»º</td></tr><tr><td><code>@Put()</code></td><td>PUT</td><td><strong>å…¨é‡</strong>æ›¿æ¢</td><td>å¹‚ç­‰ï¼Œä¾‹å¦‚ä¸Šä¼ æ–°å¤´åƒè¦†ç›–æ—§å¤´åƒ</td></tr><tr><td><code>@Patch()</code></td><td>PATCH</td><td><strong>å±€éƒ¨</strong>æ›´æ–°</td><td>éå¹‚ç­‰ï¼Œä¾‹å¦‚åªä¿®æ”¹ç”¨æˆ·çš„æ˜µç§°å­—æ®µ</td></tr><tr><td><code>@Delete()</code></td><td>DELETE</td><td>åˆ é™¤èµ„æº</td><td>å¹‚ç­‰</td></tr></tbody></table>
<p><strong>é¢è¯•é‡ç‚¹ï¼šPUT vs PATCH</strong></p>
<ul>
<li><strong>PUT</strong> æ˜¯â€œæ•´ä½“è¦†ç›–â€ï¼Œå¦‚æœåªä¼ äº† <code>name</code> æ²¡ä¼  <code>age</code>ï¼Œ<code>age</code> å¯èƒ½ä¼šè¢«ç½®ç©ºã€‚</li>
<li><strong>PATCH</strong> æ˜¯â€œå·®é‡è¡¥ä¸â€ï¼Œåªæ›´æ–°ä½ ä¼ é€’çš„å­—æ®µã€‚</li>
<li>åœ¨ NestJS DTO è®¾è®¡ä¸­ï¼ŒPUT çš„ DTO å­—æ®µé€šå¸¸å…¨æ˜¯å¿…å¡«çš„ï¼Œè€Œ PATCH çš„ DTO å­—æ®µå…¨æ˜¯å¯é€‰çš„ (<code>@IsOptional()</code>)ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-11">å…­ã€æ•°æ®åº“é›†æˆï¼šå…¨å±€æ¨¡å—ä¸å•ä¾‹æ¨¡å¼</h2>
<p>åœ¨ä¼ä¸šçº§åº”ç”¨ä¸­ï¼Œæ•°æ®åº“è¿æ¥ï¼ˆDatabase Connectionï¼‰æ˜¯å…¸å‹çš„<strong>åŸºç¡€è®¾æ–½èµ„æº</strong>ã€‚æˆ‘ä»¬ä¸å¸Œæœ›æ¯ä¸ªæ¨¡å—éƒ½å»å»ºç«‹ä¸€ä¸ªæ–°çš„è¿æ¥æ± ã€‚</p>
<h3 data-id="heading-12">æœ€ä½³å®è·µï¼š<code>@Global()</code></h3>
<p>TypeScript</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Global</span>() <span class="hljs-comment">// å…³é”®ï¼šæ ‡è®°ä¸ºå…¨å±€æ¨¡å—</span>
<span class="hljs-variable">@Module</span>({
  <span class="hljs-attribute">providers</span>: [...databaseProviders],
  <span class="hljs-attribute">exports</span>: [...databaseProviders],
})
export class DatabaseModule {}
</code></pre>
<p><strong>è®¾è®¡å“²å­¦ï¼š</strong></p>
<ul>
<li><strong>å…¨å±€å•ä¾‹</strong>ï¼šåŠ ä¸Š <code>@Global()</code> åï¼Œ<code>DatabaseModule</code> åªéœ€è¦åœ¨ <code>AppModule</code> å¯¼å…¥ä¸€æ¬¡ï¼Œå…¨åº”ç”¨çš„æ‰€æœ‰æ¨¡å—éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨å…¶å¯¼å‡ºçš„ Providerï¼Œæ— éœ€é‡å¤å¯¼å…¥ã€‚</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šç¡®ä¿æ•´ä¸ªåº”ç”¨åªç»´æŠ¤ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œé¿å…è¿æ¥æ•°çˆ†ç‚¸ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-13">ä¸ƒã€ç»“è¯­</h2>
<p>NestJS çš„å­¦ä¹ æ›²çº¿è™½ç„¶æ¯” Express é™¡å³­ï¼Œä½†å®ƒå¸¦æ¥çš„å›æŠ¥æ˜¯å·¨å¤§çš„ã€‚</p>
<ul>
<li><strong>ä»â€œæ€ä¹ˆå†™â€åˆ°â€œæ€ä¹ˆè®¾è®¡â€</strong> ï¼šå®ƒå¼ºè¿«ä½ å»æ€è€ƒä»£ç çš„ç»“æ„ã€è¾¹ç•Œå’Œä¾èµ–ã€‚</li>
<li><strong>ä»â€œå•å…µä½œæˆ˜â€åˆ°â€œå›¢é˜Ÿåä½œâ€</strong> ï¼šè§„èŒƒåŒ–çš„æ¶æ„ä½¿å¾—å›¢é˜Ÿæˆå‘˜å¯ä»¥æ— ç¼è¡”æ¥å½¼æ­¤çš„ä»£ç ã€‚</li>
</ul>
<p>å½“ä½ æŒæ¡äº† <strong>å·¥å‚æ¨¡å¼</strong> çš„å¯åŠ¨æµç¨‹ã€<strong>æ¨¡å—åŒ–</strong> çš„ç»„ç»‡æ–¹å¼ã€<strong>ä¾èµ–æ³¨å…¥</strong> çš„è§£è€¦æ€ç»´ä»¥åŠ <strong>è£…0  é¥°å™¨</strong> çš„å…ƒç¼–ç¨‹èƒ½åŠ›ï¼Œä½ å°±çœŸæ­£æ¨å¼€äº†ä¼ä¸šçº§ Node.js å¼€å‘çš„å¤§é—¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaå¹¿æ’­ â€”å¦‚ä½•åˆ©ç”¨å¹¿æ’­åšæœåŠ¡å‘ç°]]></title>    <link>https://juejin.cn/post/7595858760133738559</link>    <guid>https://juejin.cn/post/7595858760133738559</guid>    <pubDate>2026-01-17T06:11:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858760133738559" data-draft-id="7595868336594960403" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaå¹¿æ’­ â€”å¦‚ä½•åˆ©ç”¨å¹¿æ’­åšæœåŠ¡å‘ç°"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-17T06:11:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·98512003583"/> <meta itemprop="url" content="https://juejin.cn/user/1927871600799337"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaå¹¿æ’­ â€”å¦‚ä½•åˆ©ç”¨å¹¿æ’­åšæœåŠ¡å‘ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1927871600799337/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·98512003583
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T06:11:25.000Z" title="Sat Jan 17 2026 06:11:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>é€šè¿‡å¹¿æ’­å¯ä»¥åœ¨å±€åŸŸç½‘å†…å¹¿æ’­ä¿¡æ¯ï¼Œå¹¿æ’­æ¥æ”¶ç«¯é€šè¿‡ç›‘å¬å¹¿æ’­ä¿¡æ¯ï¼Œå¯ä»¥è‡ªåŠ¨å‘ç°å±€åŸŸç½‘å†…æ‰€æœ‰çš„è®¾å¤‡/æœåŠ¡ä¿¡æ¯ã€‚</p>
</blockquote>
<h2 data-id="heading-0">1. å‘é€å¹¿æ’­</h2>
<p>åœ¨ Java ä¸­é€šè¿‡å°† DatagramSocket è®¾ç½® <code>setBroadcast(true)</code> æ¥å‘é€å¹¿æ’­ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">DatagramSocket</span> <span class="hljs-variable">socket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatagramSocket</span>();
socket.setBroadcast(<span class="hljs-literal">true</span>);
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¹¿æ’­å†…å®¹</span>
<span class="hljs-type">byte</span>[] broadcastContent = <span class="hljs-string">"å¹¿æ’­å†…å®¹"</span>.getBytes();
<span class="hljs-comment">// å‘é€å¹¿æ’­çš„æŒ‡å®šç«¯å£</span>
<span class="hljs-type">int</span> <span class="hljs-variable">broadcastPort</span> <span class="hljs-operator">=</span> <span class="hljs-number">12135</span>;
<span class="hljs-comment">// å‘é€å¹¿æ’­çš„åœ°å€</span>
<span class="hljs-type">InetAddress</span> <span class="hljs-variable">broadcastAddress</span> <span class="hljs-operator">=</span> InetAddress.getByName(<span class="hljs-string">"255.255.255.255"</span>);
<span class="hljs-comment">// æ„å»ºå¹¿æ’­æ•°æ®åŒ…</span>
<span class="hljs-type">DatagramPacket</span> <span class="hljs-variable">packet</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatagramPacket</span>(broadcastContent, broadcastContent.length,  broadcastAddress, broadcastPort);
socket.send(pocket);
</code></pre>
<ul>
<li>broadcastAddress(255.255.255.255): è¡¨ç¤ºå‘é€åˆ°æœ¬åœ°ç½‘ç»œä¸­çš„æ‰€æœ‰è®¾å¤‡ï¼Œå¹¶ä¸”ä¸ä¼šè¢«è·¯ç”±å™¨è½¬å‘åˆ°å…¶ä»–ç½‘ç»œï¼Œæ„å‘³ç€è¯¥ç½‘ç»œæ•°æ®åŒ…ä¼šå¹¿æ’­åˆ°å±€åŸŸç½‘ä¸­çš„æ‰€æœ‰è®¾å¤‡ã€‚</li>
<li>broadcastPort(12135): è¡¨ç¤ºå‘é€åˆ°è¯¥ç«¯å£ï¼Œå¹¿æ’­æ•°æ®åŒ…åªèƒ½å‘é€åˆ°ä¸€ä¸ªç«¯å£ï¼Œä¸èƒ½å‘é€åˆ°å¤šä¸ªç«¯å£ã€‚</li>
</ul>
<p>é™¤äº†é€šè¿‡ 255.255.255.255 ä¹Ÿå¯ä»¥è®¾ç½®å‘é€åˆ°æŒ‡å®šçš„å­ç½‘çš„æ‰€æœ‰ä¸»æœºã€‚å¦‚ï¼š 192.168.1.255ã€‚
å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è·å–å½“å‰ä¸»æœºæ‰€åœ¨å­ç½‘çš„æ‰€æœ‰å¹¿æ’­åœ°å€åˆ—è¡¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;InetAddress&gt; <span class="hljs-title function_">listAllBroadcastAddresses</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SocketException {  
    List&lt;InetAddress&gt; broadcastList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    <span class="hljs-comment">// è·å–æ‰€æœ‰çš„ç½‘ç»œæ¥å£  </span>
    Enumeration&lt;NetworkInterface&gt; interfaces = NetworkInterface.getNetworkInterfaces();  
    <span class="hljs-keyword">while</span> (interfaces.hasMoreElements()) {  
        <span class="hljs-type">NetworkInterface</span> <span class="hljs-variable">networkInterface</span> <span class="hljs-operator">=</span> interfaces.nextElement();  
		<span class="hljs-comment">// å‰”é™¤æœ¬åœ°å›ç¯åœ°å€(127.0.0.1) ä»¥åŠæœªå¯ç”¨çš„æ¥å£</span>
        <span class="hljs-keyword">if</span> (networkInterface.isLoopback() || !networkInterface.isUp()) {  
            <span class="hljs-keyword">continue</span>;  
        }  
		<span class="hljs-comment">// æå–æ¯ä¸ªåœ°å€çš„å¹¿æ’­åœ°å€</span>
        networkInterface.getInterfaceAddresses().stream()  
                .map(InterfaceAddress::getBroadcast)  
                .filter(Objects::nonNull)  
                .forEach(broadcastList::add);  
    }  
    <span class="hljs-keyword">return</span> broadcastList;  
}
</code></pre>
<p>è¿™æ ·å°±å¯ä»¥ä»åˆ—è¡¨ä¸­é€‰æ‹©å‘å“ªä¸€ä¸ªå­ç½‘å‘é€å¹¿æ’­ä¿¡æ¯ï¼Œæˆ–æ˜¯éå†åˆ—è¡¨éƒ½å‘é€ã€‚</p>
<h2 data-id="heading-1">2. æ¥æ”¶å¹¿æ’­</h2>
<p>æ¥æ”¶å¹¿æ’­åŒæ ·æ˜¯é€šè¿‡ DatagramSocket ç±»ï¼Œä½†ä¸éœ€è¦è®¾ç½®ä¸ºå¹¿æ’­æ¨¡å¼ï¼Œéœ€è¦ç›‘å¬æœ¬åœ°ç«¯å£ï¼Œè¿™ä¸ªç«¯å£ä¹Ÿå°±æ˜¯å¹¿æ’­å‘é€ç«¯å¹¿æ’­çš„ç«¯å£ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ç›‘å¬ç«¯å£</span>
<span class="hljs-type">DatagramSocket</span> <span class="hljs-variable">socket</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatagramSocket</span>(<span class="hljs-number">12135</span>);

<span class="hljs-type">byte</span>[] receiveBuff = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">1024</span>];

<span class="hljs-type">DatagramPacket</span> <span class="hljs-variable">packet</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatagramPacket</span>(receiveBuff, receiveBuff.length);

<span class="hljs-comment">// é˜»å¡å¼ç­‰å¾…æ¥æ”¶å¹¿æ’­ä¿¡æ¯</span>
socket.receive(packet);

<span class="hljs-comment">// è§£æå¹¿æ’­ä¿¡æ¯</span>
<span class="hljs-type">String</span> <span class="hljs-variable">receiveContent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(packet.getData(), <span class="hljs-number">0</span>, packet.getLength());

System.out.println(<span class="hljs-string">"æ¥æ”¶åˆ°å¹¿æ’­ä¿¡æ¯ :"</span> + receiveContent);

</code></pre>
<h2 data-id="heading-2">3. åº”ç”¨</h2>
<p>é€šè¿‡å¹¿æ’­çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥åšåˆ°å±€åŸŸç½‘å†…çš„è‡ªåŠ¨æœåŠ¡å‘ç°ã€‚æ¯”å¦‚ä»¥ä¸‹æŠ€æœ¯éƒ½æ˜¯é€šè¿‡å¹¿æ’­æ¥åšåˆ°çš„</p>
<ol>
<li>DHCPï¼Œ å®¢æˆ·ç«¯é€šè¿‡å¹¿æ’­ 255.255.255.255ï¼Œ67ç«¯å£å‘ç°DHCPæœåŠ¡å™¨ã€‚</li>
<li>æ‰“å°æœºï¼Œç‰©è”ç½‘è®¾å¤‡çš„è®¾å¤‡å‘ç°</li>
<li>å±€åŸŸç½‘æ¸¸æˆæœåŠ¡å™¨çš„æœåŠ¡å‘ç°</li>
</ol>
<h3 data-id="heading-3">3.1 æœåŠ¡å‘ç°æµç¨‹</h3>
<ol>
<li>å®¢æˆ·ç«¯å‘å±€åŸŸç½‘çš„æŒ‡å®šç«¯å£å®šæœŸå‘é€å¹¿æ’­ä¿¡æ¯ã€‚</li>
<li>æœåŠ¡ç«¯åœ¨æŒ‡å®šç«¯å£ç›‘å¬æ‰€æœ‰å®¢æˆ·ç«¯çš„å¹¿æ’­ä¿¡æ¯ã€‚</li>
<li>æœåŠ¡ç«¯è§£ææ¥æ”¶åˆ°çš„å¹¿æ’­ä¿¡æ¯ï¼Œè·å–ä¸å®¢æˆ·ç«¯çš„é€šä¿¡æ–¹å¼ï¼ˆé€šä¿¡æ–¹å¼è‡ªå®šä¹‰ï¼Œå¯ä»¥é€šè¿‡TCPåè®®ï¼ŒHTTPåè®®....ï¼‰</li>
<li>ä»¥TCPåè®®ä¸ºä¾‹ï¼Œå®¢æˆ·ç«¯å‘é€çš„æ•°æ®åŒ…ä¸­åº”è¯¥æœ‰é€šä¿¡ç«¯å£ï¼ŒæœåŠ¡ç«¯é€šè¿‡è¯¥ç«¯å£ä¸å®¢æˆ·ç«¯è¿›è¡ŒåŒå‘é€šä¿¡ã€‚</li>
<li>æœåŠ¡ç«¯ç»´æŠ¤å·²è¿æ¥çš„å®¢æˆ·ç«¯åˆ—è¡¨ã€‚</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
participant A as å®¢æˆ·ç«¯
participant C as å±€åŸŸç½‘
participant B as æœåŠ¡å‘ç°ç«¯

A --&gt;&gt; C: å®šæœŸå‘é€å¹¿æ’­æ•°æ®åŒ…
B --&gt;&gt; C: ç›‘å¬å¹¿æ’­æ•°æ®åŒ…
C --&gt;&gt; B: ç›‘å¬åˆ°å¹¿æ’­æ•°æ®åŒ… 

B -&gt;&gt; B: è§£ææ•°æ®åŒ…ï¼Œè·å–é€šä¿¡ç«¯å£ä¸å®¢æˆ·ç«¯IP

B -&gt;&gt; A: è¯·æ±‚ä¸å®¢æˆ·ç«¯é€šä¿¡
A -&gt;&gt; B: å“åº”æœåŠ¡ç«¯è¯·æ±‚
B -&gt;&gt; B: æ›´æ–°å®¢æˆ·ç«¯åˆ—è¡¨

A -&gt;&gt; B: å®¢æˆ·ç«¯ä¸‹çº¿è¯·æ±‚
B -&gt;&gt; B: æ›´æ–°å®¢æˆ·ç«¯åˆ—è¡¨
</code></pre>
<h3 data-id="heading-4">3.2 æ³¨æ„ç‚¹</h3>
<ol>
<li>å¹¿æ’­çš„æ•°æ®æ„å‘³ç€å¯ä»¥è¢«ç½‘ç»œä¸­æ‰€æœ‰çš„è®¾å¤‡ç›‘å¬åˆ°ï¼Œå› æ­¤å¯ä»¥åœ¨å¹¿æ’­æ•°æ®åŒ…æ—¶åšå¥½æ•°æ®åŠ å¯†ã€‚</li>
<li>åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯è¿›è¡ŒåŒå‘è¿æ¥æ—¶åšèº«ä»½éªŒè¯</li>
<li>æ§åˆ¶å¹¿æ’­é¢‘ç‡ï¼Œå¦‚30ç§’ä¸€æ¬¡ï¼Œé«˜é¢‘å¹¿æ’­ä¼šå ç”¨å¸¦å®½ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¨èä¸€ä¸ªè¶…å¥½ç”¨çš„å…¨æ ˆé€šç”¨ç€‘å¸ƒæµå¸ƒå±€åº“ universal-waterfall-layout]]></title>    <link>https://juejin.cn/post/7595858063502606370</link>    <guid>https://juejin.cn/post/7595858063502606370</guid>    <pubDate>2026-01-17T04:00:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858063502606370" data-draft-id="7595864836359618612" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¨èä¸€ä¸ªè¶…å¥½ç”¨çš„å…¨æ ˆé€šç”¨ç€‘å¸ƒæµå¸ƒå±€åº“ universal-waterfall-layout"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T04:00:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Summerä¸ç§ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/3798155850693484"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¨èä¸€ä¸ªè¶…å¥½ç”¨çš„å…¨æ ˆé€šç”¨ç€‘å¸ƒæµå¸ƒå±€åº“ universal-waterfall-layout
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3798155850693484/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Summerä¸ç§ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T04:00:39.000Z" title="Sat Jan 17 2026 04:00:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œç€‘å¸ƒæµå¸ƒå±€ï¼ˆMasonry Layoutï¼‰ä¸€ç›´æ˜¯ä¸€ä¸ªè®©äººåˆçˆ±åˆæ¨çš„éœ€æ±‚ã€‚çˆ±å®ƒæ˜¯å› ä¸ºå®ƒèƒ½æå¤§æå‡å›¾ç‰‡ç±»åº”ç”¨ï¼ˆå¦‚ Pinterestã€å°çº¢ä¹¦ï¼‰çš„è§†è§‰ä½“éªŒå’Œç©ºé—´åˆ©ç”¨ç‡ï¼›æ¨å®ƒæ˜¯å› ä¸ºå®ç°èµ·æ¥å‘ç‚¹æ»¡æ»¡â€”â€”å›¾ç‰‡é«˜åº¦ä¸å›ºå®šã€çª—å£ç¼©æ”¾é‡æ’ã€æ¡†æ¶å…¼å®¹æ€§é—®é¢˜ç­‰ç­‰ã€‚</p>
<p>ä»Šå¤©ç»™å¤§å®¶æ¨èä¸€ä¸ªæœ€è¿‘å‘ç°çš„å®è—å¼€æºåº“ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Funiversal-waterfall-layout" target="_blank" title="https://www.npmjs.com/package/universal-waterfall-layout" ref="nofollow noopener noreferrer">universal-waterfall-layout</a></strong>ã€‚</p>
<p>æ­£å¦‚å…¶åï¼Œä¸ä»…ä»…æ˜¯ç»™ Vue ç”¨ï¼Œä¹Ÿä¸ä»…ä»…æ˜¯ç»™ React ç”¨ï¼Œå®ƒæ˜¯ä¸€ä¸ª**é€šç”¨ï¼ˆUniversalï¼‰**çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">ä¸ºä»€ä¹ˆé€‰æ‹©å®ƒï¼Ÿ</h2>
<p>ç°åœ¨çš„å¸‚é¢ä¸Šçš„ç€‘å¸ƒæµæ’ä»¶å¾€å¾€ç»‘å®šç‰¹å®šæ¡†æ¶ï¼Œæˆ–è€…åŒ…ä½“ç§¯è¿‡å¤§ã€‚è€Œ <code>universal-waterfall-layout</code> æœ‰å‡ ä¸ªéå¸¸å‡»ä¸­ç—›ç‚¹çš„ç‰¹æ€§ï¼š</p>
<h3 data-id="heading-1">1. ğŸš€ å…¨æ ˆé€šç”¨ï¼Œä¸€æ¬¡å­¦ä¹ </h3>
<p>æ— è®ºä½ æ˜¯ <strong>Vue 3</strong> çˆ±å¥½è€…ï¼Œè¿˜æ˜¯ <strong>React</strong> æ‹¥è¶¸ï¼Œç”šè‡³æ˜¯ <strong>åŸç”Ÿ JS</strong> çš„æ­»å¿ ç²‰ï¼Œè¿™ä¸ªåº“éƒ½èƒ½æ— ç¼æ”¯æŒã€‚å®ƒçš„æ ¸å¿ƒé€»è¾‘æ˜¯ç”¨åŸç”Ÿ TypeScript ç¼–å†™çš„ï¼Œé›¶ä¾èµ–ï¼Œä»…ä»…åœ¨æ ¸å¿ƒä¹‹ä¸Šå°è£…äº†è½»é‡çº§çš„ Vue å’Œ React ç»„ä»¶é€‚é…å±‚ã€‚</p>
<h3 data-id="heading-2">2. âš¡ï¸ å†…ç½®"åˆšéœ€"åŠŸèƒ½</h3>
<p>å¾ˆå¤šç€‘å¸ƒæµæ’ä»¶åªç®¡å¸ƒå±€ï¼Œä¸ç®¡ä½“éªŒã€‚ä½†è¿™ä¸ªåº“åœ¨ <code>v1.0.3</code> ç‰ˆæœ¬ä¸­è´´å¿ƒåœ°åŠ å…¥äº†å¾ˆå¤šå®æˆ˜åˆšéœ€åŠŸèƒ½ï¼š</p>
<ul>
<li><strong>éª¨æ¶å± (Skeleton Loading)</strong>: æ•°æ®è¿˜æ²¡å›æ¥ï¼Ÿç›´æ¥é€šè¿‡ props å¼€å¯åŠ è½½çŠ¶æ€ï¼Œè‡ªå¸¦è„‰å†²åŠ¨ç”»çš„éª¨æ¶å±ï¼Œæ‹’ç»ç™½å±ã€‚</li>
<li><strong>ç©ºçŠ¶æ€ (Empty State)</strong>: åˆ—è¡¨ä¸ºç©ºæ—¶è‡ªåŠ¨æ˜¾ç¤ºå ä½æç¤ºï¼Œä¸å†éœ€è¦è‡ªå·±å†™ <code>v-if/v-else</code>ã€‚</li>
<li><strong>å›¾ç‰‡æ‡’åŠ è½½ (Lazy Load)</strong>: å†…ç½®åŸç”Ÿå›¾ç‰‡æ‡’åŠ è½½æ”¯æŒï¼Œæ€§èƒ½ç›´æ¥æ‹‰æ»¡ï¼Œä¸éœ€è¦å†å¼•å…¥é¢å¤–çš„ lazyload åº“ã€‚</li>
</ul>
<h3 data-id="heading-3">3. ğŸ“ ä¸¤ç§æ ¸å¿ƒå¸ƒå±€ç­–ç•¥</h3>
<p>å®ƒä¸ä»…ä»…æ˜¯ç®€å•çš„â€œæ’åˆ—â€ï¼Œè¿˜æä¾›äº†ä¸¤ç§æœ€å¸¸ç”¨çš„å“åº”å¼ç­–ç•¥ï¼š</p>
<ul>
<li><strong>å›ºå®šåˆ—å®½ (Fixed Column Width)</strong>: æŒ‡å®šæ¯åˆ— <code>250px</code>ï¼Œå®¹å™¨ä¼šè‡ªåŠ¨è®¡ç®—èƒ½æ”¾ä¸‹å‡ åˆ—ï¼Œå¹¶<strong>è‡ªåŠ¨å±…ä¸­</strong>ã€‚é€‚åˆå¤§å±å±•ç¤ºã€‚</li>
<li><strong>å›ºå®šåˆ—æ•° (Fixed Column Count)</strong>: æŒ‡å®šâ€œæˆ‘è¦ 3 åˆ—â€ï¼Œæ— è®ºå±å¹•å¤šå¤§ï¼Œå®½åº¦éƒ½ä¼šè‡ªåŠ¨æ‹‰ä¼¸å¡«æ»¡ã€‚é€‚åˆç§»åŠ¨ç«¯ H5ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">å¿«é€Ÿä¸Šæ‰‹</h2>
<h3 data-id="heading-5">å®‰è£…</h3>
<p>éå¸¸ç®€å•ï¼Œä½“ç§¯ä¹Ÿå¾ˆå°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install universal-waterfall-layout
<span class="hljs-comment"># æˆ–è€…</span>
pnpm add universal-waterfall-layout
</code></pre>
<h3 data-id="heading-6">via Vue 3</h3>
<p>åœ¨ Vue ä¸­ä½¿ç”¨éå¸¸ä¸æ»‘ï¼Œä½ å¯ä»¥ç›´æ¥åˆ©ç”¨ <code>slot</code> æ¥è‡ªå®šä¹‰åŠ è½½ä¸­å’Œç©ºçŠ¶æ€çš„ UIï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;Waterfall 
    :gap="20" 
    :columnWidth="250"
    :loading="isLoading"
    :lazyload="true"
  &gt;
    &lt;!-- æ•°æ®åˆ—è¡¨ --&gt;
    &lt;div v-for="item in items" :key="item.id" class="card"&gt;
      &lt;img :src="item.image" alt="" /&gt;
      &lt;p&gt;{{ item.title }}&lt;/p&gt;
    &lt;/div&gt;
    
    &lt;!-- è‡ªå®šä¹‰åŠ è½½éª¨æ¶ --&gt;
    &lt;template #loading&gt;
       &lt;div class="my-skeleton"&gt;æ­£åœ¨åŠ è½½ç²¾å½©å†…å®¹...&lt;/div&gt;
    &lt;/template&gt;

    &lt;!-- è‡ªå®šä¹‰ç©ºçŠ¶æ€ --&gt;
    &lt;template #empty&gt;
       &lt;div class="empty-box"&gt;æš‚æ— ç›¸å…³æ•°æ®&lt;/div&gt;
    &lt;/template&gt;
  &lt;/Waterfall&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { Waterfall } from 'universal-waterfall-layout/vue';
import { ref } from 'vue';

const isLoading = ref(true);
const items = ref([]);

// æ¨¡æ‹Ÿè¯·æ±‚
setTimeout(() =&gt; {
  items.value = [{/*...*/}, {/*...*/}];
  isLoading.value = false;
}, 1000);
&lt;/script&gt;
</code></pre>
<h3 data-id="heading-7">via React</h3>
<p>React ç‰ˆæœ¬åŒæ ·æ‹¥æœ‰ä¼˜ç§€çš„ç±»å‹æç¤ºï¼ˆTypeScript Friendlyï¼‰ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Waterfall</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'universal-waterfall-layout/react'</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">MyGallery</span> = (<span class="hljs-params">{ data, loading }</span>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Waterfall</span> 
      <span class="hljs-attr">gap</span>=<span class="hljs-string">{15}</span> 
      <span class="hljs-attr">columnCount</span>=<span class="hljs-string">{3}</span> // <span class="hljs-attr">ç§»åŠ¨ç«¯å¸¸ç”¨</span>ï¼š<span class="hljs-attr">å›ºå®š3åˆ—</span>
      <span class="hljs-attr">loading</span>=<span class="hljs-string">{loading}</span>
      <span class="hljs-attr">lazyload</span>=<span class="hljs-string">{true}</span>
      <span class="hljs-attr">loadingComponent</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading Skeleton...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
      emptyComponent={<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Nothing here yet!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
    &gt;
      {data.map(item =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card"</span>&gt;</span>
           <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{item.url}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Waterfall</span>&gt;</span></span>
  );
};
</code></pre>
<hr/>
<h3 data-id="heading-8">via Vanilla JS (åŸç”Ÿ HTML)</h3>
<p>å¦‚æœä½ ä¸ä½¿ç”¨ä»»ä½•æ¡†æ¶ï¼Œæˆ–è€…åœ¨ä¼ ç»Ÿçš„ HTML é¡µé¢ä¸­ä½¿ç”¨ï¼Œä¹Ÿå®Œå…¨æ²¡é—®é¢˜ã€‚æ ¸å¿ƒåº“æä¾›äº†ç›´æ¥æ“ä½œ DOM çš„èƒ½åŠ›ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"waterfall-container"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"..."</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"..."</span> /&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- ... --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFallCore</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'universal-waterfall-layout'</span>;

  <span class="hljs-keyword">const</span> container = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'waterfall-container'</span>);
  
  <span class="hljs-keyword">const</span> waterfall = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFallCore</span>({
    <span class="hljs-attr">container</span>: container, <span class="hljs-comment">// å¿…å¡«ï¼šå®¹å™¨ DOM å…ƒç´ </span>
    <span class="hljs-attr">gap</span>: <span class="hljs-number">15</span>,              <span class="hljs-comment">// é—´è·</span>
    <span class="hljs-attr">columnWidth</span>: <span class="hljs-number">220</span>,     <span class="hljs-comment">// å›ºå®šåˆ—å®½ç­–ç•¥</span>
    <span class="hljs-attr">lazyload</span>: <span class="hljs-literal">true</span>        <span class="hljs-comment">// å¼€å¯æ‡’åŠ è½½</span>
  });
  
  <span class="hljs-comment">// å¦‚æœåç»­é€šè¿‡ JS åŠ¨æ€æ·»åŠ äº†å…ƒç´ ï¼Œå¯ä»¥æ‰‹åŠ¨è§¦å‘å¸ƒå±€æ›´æ–°</span>
  <span class="hljs-comment">// waterfall.updateItems();</span>
  <span class="hljs-comment">// waterfall.layout();</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<hr/>
<h2 data-id="heading-9">ç»“è¯­</h2>
<p>åœ¨é€ è½®å­æ³›æ»¥çš„ä»Šå¤©ï¼Œæ‰¾åˆ°ä¸€ä¸ª<strong>å…‹åˆ¶ä¸”å¥½ç”¨</strong>çš„åº“å¹¶ä¸å®¹æ˜“ã€‚<code>universal-waterfall-layout</code> æ²¡æœ‰è¿‡åº¦å°è£…ï¼Œä½†æŠŠæœ€æ ¸å¿ƒçš„<strong>å¸ƒå±€ç®—æ³•</strong>ã€<strong>å“åº”å¼å¤„ç†</strong>å’Œ<strong>åŠ è½½ä½“éªŒ</strong>åšå¾—éå¸¸æ‰å®ã€‚</p>
<p>å¦‚æœä½ æ­£åœ¨å¼€å‘å›¾ç‰‡æµã€å•†å“å¢™æˆ–è€…ä½œå“é›†å±•ç¤ºé¡µé¢ï¼Œå¼ºçƒˆæ¨èè¯•ä¸€è¯•ï¼</p>
<p>ğŸ”— <strong>NPM åœ°å€</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Funiversal-waterfall-layout" target="_blank" title="https://www.npmjs.com/package/universal-waterfall-layout" ref="nofollow noopener noreferrer">universal-waterfall-layout</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½¿ç”¨ LangChain.js åœ¨nodeç«¯ è¿æ¥glmå¤§æ¨¡å‹ç¤ºä¾‹]]></title>    <link>https://juejin.cn/post/7595868336594911251</link>    <guid>https://juejin.cn/post/7595868336594911251</guid>    <pubDate>2026-01-17T04:47:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595868336594911251" data-draft-id="7595868336594862099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½¿ç”¨ LangChain.js åœ¨nodeç«¯ è¿æ¥glmå¤§æ¨¡å‹ç¤ºä¾‹"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T04:47:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kevinIcoding"/> <meta itemprop="url" content="https://juejin.cn/user/400700903005726"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½¿ç”¨ LangChain.js åœ¨nodeç«¯ è¿æ¥glmå¤§æ¨¡å‹ç¤ºä¾‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/400700903005726/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kevinIcoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T04:47:12.000Z" title="Sat Jan 17 2026 04:47:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½¿ç”¨ LangChain åœ¨åç«¯è¿æ¥å¤§æ¨¡å‹ï¼šå®è·µæŒ‡å— ğŸš€</h2>
<blockquote>
<p>æœ¬æ–‡ä»¥å®æˆ˜é¡¹ç›®ä»£ç ä¸ºä¾‹ï¼ŒåŒ…å«å®Œæ•´åç«¯æ¥å…¥ã€æµå¼ï¼ˆSSEï¼‰å®ç°ã€å‰ç«¯æ¥æ”¶ç¤ºä¾‹ä¸è°ƒè¯•æ–¹æ³•ï¼Œè¯»è€…å¯ç›´æ¥å¤åˆ¶è¿è¡Œã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ä»‹ç» âœ¨</h3>
<p>éšç€å¤§æ¨¡å‹åœ¨å„ç±»åº”ç”¨ä¸­çš„æ™®åŠï¼Œåç«¯å¦‚ä½•ç¨³å¥åœ°æ¥å…¥å¹¶æŠŠæ¨¡å‹èƒ½åŠ›ä»¥ API/æµå¼æ–¹å¼å¯¹å¤–æä¾›ï¼Œæˆä¸ºå¸¸è§éœ€æ±‚ã€‚æœ¬æ–‡åŸºäº LangChainï¼ˆJSï¼‰æ¼”ç¤ºå¦‚ä½•åœ¨ Node.js åç«¯ï¼ˆKoaï¼‰ä¸­ï¼š</p>
<ul>
<li>åˆå§‹åŒ–å¹¶è°ƒç”¨å¤§æ¨¡å‹ï¼ˆç¤ºä¾‹ä½¿ç”¨æ™ºè°± GLM çš„æ¥å…¥æ–¹å¼ï¼‰</li>
<li>æ”¯æŒæ™®é€šè¯·æ±‚ä¸æµå¼ï¼ˆServer-Sent Eventsï¼ŒSSEï¼‰å“åº”</li>
<li>åœ¨å‰ç«¯ç”¨ fetch è¯»å–æµå¹¶å®ç°æ‰“å­—æœºæ•ˆæœ</li>
</ul>
<p>é€‚ç”¨äººç¾¤ï¼šç†Ÿæ‚‰ JS/TSã€Node.jsã€å‰ç«¯åŸºæœ¬çŸ¥è¯†ï¼Œæƒ³æŠŠæ¨¡å‹èƒ½åŠ›æ”¾åˆ°åç«¯å¹¶å¯¹å¤–æä¾› API çš„å·¥ç¨‹å¸ˆã€‚</p>
<hr/>
<h3 data-id="heading-2">ä¸€ã€å‡†å¤‡ä¸ä¾èµ– ğŸ§©</h3>
<p>ç¯å¢ƒï¼šNode.js 16+ã€‚</p>
<p>å®‰è£…ä¾èµ–ï¼ˆKoa ç¤ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install koa koa-router koa-bodyparser @koa/cors dotenv
npm install @langchain/openai @langchain/core
</code></pre>
<p>åœ¨é¡¹ç›®æ ¹åˆ›å»º <code>.env</code>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">ZHIPU_API_KEY</span>=ä½ çš„_api_key_here
<span class="hljs-attr">PORT</span>=<span class="hljs-number">3001</span>
</code></pre>
<blockquote>
<p>æç¤ºï¼šä¸åŒæ¨¡å‹æä¾›æ–¹çš„ baseURL ä¸è®¤è¯å­—æ®µä¼šä¸åŒï¼Œè¯·æ ¹æ®æä¾›æ–¹æ–‡æ¡£è°ƒæ•´ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">äºŒã€åç«¯ï¼šæœåŠ¡å°è£…ï¼ˆchatServiceï¼‰ğŸ”§</h3>
<p>æŠŠæ¨¡å‹è°ƒç”¨å°è£…åˆ°æœåŠ¡å±‚ï¼Œæä¾›æ™®é€šè°ƒç”¨ä¸æµå¼è°ƒç”¨æ¥å£ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// backend/src/services/chatService.js</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatOpenAI</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/openai"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">HumanMessage</span>, <span class="hljs-title class_">SystemMessage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@langchain/core/messages"</span>;

<span class="hljs-keyword">const</span> chatService = {
  <span class="hljs-attr">llm</span>: <span class="hljs-literal">null</span>,

  <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">llm</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">llm</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatOpenAI</span>({
        <span class="hljs-attr">openAIApiKey</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">ZHIPU_API_KEY</span>,
        <span class="hljs-attr">modelName</span>: <span class="hljs-string">"glm-4.5-flash"</span>,
        <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>,
        <span class="hljs-attr">configuration</span>: { <span class="hljs-attr">baseURL</span>: <span class="hljs-string">"https://open.bigmodel.cn/api/paas/v4/"</span> },
      });
    }
  },

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params">message, conversationHistory = []</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
    <span class="hljs-keyword">const</span> messages = [
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">SystemMessage</span>(<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„ AI åŠ©æ‰‹ï¼Œä½¿ç”¨ä¸­æ–‡å›ç­”é—®é¢˜ã€‚"</span>),
      ...conversationHistory.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span>
        msg.<span class="hljs-property">role</span> === <span class="hljs-string">"user"</span>
          ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">HumanMessage</span>(msg.<span class="hljs-property">content</span>)
          : <span class="hljs-keyword">new</span> <span class="hljs-title class_">SystemMessage</span>(msg.<span class="hljs-property">content</span>),
      ),
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">HumanMessage</span>(message),
    ];

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">llm</span>.<span class="hljs-title function_">invoke</span>(messages);
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">content</span>: response.<span class="hljs-property">content</span>,
        <span class="hljs-attr">usage</span>: response.<span class="hljs-property">usage_metadata</span>,
      };
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"èŠå¤©æœåŠ¡é”™è¯¯:"</span>, error);
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span> };
    }
  },

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendMessageStream</span>(<span class="hljs-params">message, conversationHistory = []</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
    <span class="hljs-keyword">const</span> messages = [
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">SystemMessage</span>(<span class="hljs-string">"ä½ æ˜¯ä¸€ä¸ªæœ‰å¸®åŠ©çš„ AI åŠ©æ‰‹ï¼Œä½¿ç”¨ä¸­æ–‡å›ç­”é—®é¢˜ã€‚"</span>),
      ...conversationHistory.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span>
        msg.<span class="hljs-property">role</span> === <span class="hljs-string">"user"</span>
          ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">HumanMessage</span>(msg.<span class="hljs-property">content</span>)
          : <span class="hljs-keyword">new</span> <span class="hljs-title class_">SystemMessage</span>(msg.<span class="hljs-property">content</span>),
      ),
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">HumanMessage</span>(message),
    ];

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// å‡è®¾ llm.stream è¿”å›å¼‚æ­¥è¿­ä»£å™¨ï¼Œé€ chunk è¿”å› { content }</span>
      <span class="hljs-keyword">const</span> stream = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">llm</span>.<span class="hljs-title function_">stream</span>(messages);
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, stream };
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æµå¼èŠå¤©æœåŠ¡é”™è¯¯:"</span>, error);
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span> };
    }
  },
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> chatService;
</code></pre>
<p>è¯´æ˜ï¼šå®é™… SDK æ¥å£åï¼ˆå¦‚ <code>invoke</code>ã€<code>stream</code>ï¼‰è¯·ä¾æ®ä½ æ‰€ç”¨çš„ LangChain / provider ç‰ˆæœ¬è°ƒæ•´ã€‚</p>
<hr/>
<h3 data-id="heading-4">ä¸‰ã€æ§åˆ¶å™¨ï¼šæ™®é€šä¸ SSE æµå¼ï¼ˆKoaï¼‰ğŸŒŠ</h3>
<p>SSE è¦ç‚¹ï¼šéœ€è¦ç›´æ¥å†™åŸç”Ÿ <code>res</code>ï¼Œå¹¶è®¾ç½® <code>ctx.respond = false</code>ï¼Œé˜²æ­¢ Koa åœ¨ä¸­é—´ä»¶é“¾ç»“æŸæ—¶è¦†ç›–å“åº”æˆ–è¿”å› 404ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// backend/src/controllers/chatController.js</span>
<span class="hljs-keyword">import</span> chatService <span class="hljs-keyword">from</span> <span class="hljs-string">"../services/chatService.js"</span>;

<span class="hljs-keyword">const</span> chatController = {
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params">ctx</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> { message, conversationHistory = [] } = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">body</span>;
      <span class="hljs-keyword">if</span> (!message) {
        ctx.<span class="hljs-property">status</span> = <span class="hljs-number">400</span>;
        ctx.<span class="hljs-property">body</span> = { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">"æ¶ˆæ¯å†…å®¹ä¸èƒ½ä¸ºç©º"</span> };
        <span class="hljs-keyword">return</span>;
      }
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> chatService.<span class="hljs-title function_">sendMessage</span>(
        message,
        conversationHistory,
      );
      <span class="hljs-keyword">if</span> (result.<span class="hljs-property">success</span>) ctx.<span class="hljs-property">body</span> = result;
      <span class="hljs-keyword">else</span> {
        ctx.<span class="hljs-property">status</span> = <span class="hljs-number">500</span>;
        ctx.<span class="hljs-property">body</span> = result;
      }
    } <span class="hljs-keyword">catch</span> (error) {
      ctx.<span class="hljs-property">status</span> = <span class="hljs-number">500</span>;
      ctx.<span class="hljs-property">body</span> = { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">"æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"</span> };
    }
  },

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">sendMessageStream</span>(<span class="hljs-params">ctx</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> { message, conversationHistory = [] } = ctx.<span class="hljs-property">request</span>.<span class="hljs-property">body</span>;
      <span class="hljs-keyword">if</span> (!message) {
        ctx.<span class="hljs-property">status</span> = <span class="hljs-number">400</span>;
        ctx.<span class="hljs-property">body</span> = { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">"æ¶ˆæ¯å†…å®¹ä¸èƒ½ä¸ºç©º"</span> };
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> chatService.<span class="hljs-title function_">sendMessageStream</span>(
        message,
        conversationHistory,
      );
      <span class="hljs-keyword">if</span> (!result.<span class="hljs-property">success</span>) {
        ctx.<span class="hljs-property">status</span> = <span class="hljs-number">500</span>;
        ctx.<span class="hljs-property">body</span> = result;
        <span class="hljs-keyword">return</span>;
      }

      ctx.<span class="hljs-title function_">set</span>(<span class="hljs-string">"Content-Type"</span>, <span class="hljs-string">"text/event-stream"</span>);
      ctx.<span class="hljs-title function_">set</span>(<span class="hljs-string">"Cache-Control"</span>, <span class="hljs-string">"no-cache"</span>);
      ctx.<span class="hljs-title function_">set</span>(<span class="hljs-string">"Connection"</span>, <span class="hljs-string">"keep-alive"</span>);
      ctx.<span class="hljs-property">status</span> = <span class="hljs-number">200</span>;
      <span class="hljs-comment">// å…³é”®ï¼šè®©æˆ‘ä»¬ç›´æ¥æ“ä½œ Node åŸç”Ÿ res</span>
      ctx.<span class="hljs-property">respond</span> = <span class="hljs-literal">false</span>;

      <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> chunk <span class="hljs-keyword">of</span> result.<span class="hljs-property">stream</span>) {
        <span class="hljs-keyword">const</span> content = chunk.<span class="hljs-property">content</span>;
        <span class="hljs-keyword">if</span> (content) ctx.<span class="hljs-property">res</span>.<span class="hljs-title function_">write</span>(<span class="hljs-string">`data: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify({ content })}</span>\n\n`</span>);
      }

      ctx.<span class="hljs-property">res</span>.<span class="hljs-title function_">write</span>(<span class="hljs-string">"data: [DONE]\n\n"</span>);
      ctx.<span class="hljs-property">res</span>.<span class="hljs-title function_">end</span>();
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æµå¼æ§åˆ¶å™¨é”™è¯¯:"</span>, error);
      ctx.<span class="hljs-property">status</span> = <span class="hljs-number">500</span>;
      ctx.<span class="hljs-property">body</span> = { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">"æœåŠ¡å™¨å†…éƒ¨é”™è¯¯"</span> };
    }
  },
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> chatController;
</code></pre>
<hr/>
<h3 data-id="heading-5">å››ã€è·¯ç”±ä¸å¯åŠ¨ ğŸŒ</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// backend/src/routes/index.js</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Router</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"koa-router"</span>;
<span class="hljs-keyword">import</span> chatController <span class="hljs-keyword">from</span> <span class="hljs-string">"../controllers/chatController.js"</span>;
<span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Router</span>({ <span class="hljs-attr">prefix</span>: <span class="hljs-string">"/api"</span> });
router.<span class="hljs-title function_">post</span>(<span class="hljs-string">"/chat"</span>, chatController.<span class="hljs-property">sendMessage</span>);
router.<span class="hljs-title function_">post</span>(<span class="hljs-string">"/chat/stream"</span>, chatController.<span class="hljs-property">sendMessageStream</span>);
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router;

<span class="hljs-comment">// backend/src/app.js</span>
<span class="hljs-keyword">import</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">"dotenv"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Koa</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"koa"</span>;
<span class="hljs-keyword">import</span> bodyParser <span class="hljs-keyword">from</span> <span class="hljs-string">"koa-bodyparser"</span>;
<span class="hljs-keyword">import</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">"@koa/cors"</span>;
<span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">"./routes/index.js"</span>;

dotenv.<span class="hljs-title function_">config</span>();
<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Koa</span>();
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>({ <span class="hljs-attr">origin</span>: <span class="hljs-string">"*"</span>, <span class="hljs-attr">credentials</span>: <span class="hljs-literal">true</span> }));
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">bodyParser</span>());
app.<span class="hljs-title function_">use</span>(router.<span class="hljs-title function_">routes</span>());
app.<span class="hljs-title function_">use</span>(router.<span class="hljs-title function_">allowedMethods</span>());
app.<span class="hljs-title function_">listen</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">3001</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"Server running"</span>));
</code></pre>
<hr/>
<h3 data-id="heading-6">äº”ã€å‰ç«¯ï¼šæ¥æ”¶ SSE æµå¹¶å®ç°â€œæ‰“å­—æœºâ€æ•ˆæœ âŒ¨ï¸</h3>
<p>å‰ç«¯ç”¨ <code>fetch</code> + ReadableStream è¯»å– SSE åç«¯å‘é€çš„ chunkï¼ˆæ ¼å¼ä¸º <code>data: {...}\n\n</code>ï¼‰ã€‚ä¸‹é¢ç»™å‡ºç®€æ´ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// frontend/src/services/chatService.ts (æ ¸å¿ƒç‰‡æ®µ)</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendMessageStream</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">
  message,
  conversationHistory,
  onChunk,
  onComplete,
  onError,
</span>) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">"/api/chat/stream"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ message, conversationHistory }),
    });

    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"ç½‘ç»œè¯·æ±‚å¤±è´¥"</span>);
    <span class="hljs-keyword">const</span> reader = response.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>();
    <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>();

    <span class="hljs-keyword">let</span> buffer = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
      <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>();
      <span class="hljs-keyword">if</span> (done) <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">const</span> chunk = decoder.<span class="hljs-title function_">decode</span>(value);
      <span class="hljs-comment">// ç®€å•æŒ‰è¡Œè§£æ SSE data: è¡Œ</span>
      <span class="hljs-keyword">const</span> lines = chunk.<span class="hljs-title function_">split</span>(<span class="hljs-string">"\n"</span>);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> line <span class="hljs-keyword">of</span> lines) {
        <span class="hljs-keyword">if</span> (line.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">"data: "</span>)) {
          <span class="hljs-keyword">const</span> data = line.<span class="hljs-title function_">slice</span>(<span class="hljs-number">6</span>);
          <span class="hljs-keyword">if</span> (data === <span class="hljs-string">"[DONE]"</span>) {
            <span class="hljs-title function_">onComplete</span>();
            <span class="hljs-keyword">return</span>;
          }
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> parsed = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
            <span class="hljs-keyword">if</span> (parsed.<span class="hljs-property">content</span>) <span class="hljs-title function_">onChunk</span>(parsed.<span class="hljs-property">content</span>);
          } <span class="hljs-keyword">catch</span> (e) {}
        }
      }
    }
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-title function_">onError</span>(err.<span class="hljs-property">message</span> || <span class="hljs-string">"æµå¼è¯·æ±‚å¤±è´¥"</span>);
  }
};
</code></pre>
<p>æ‰“å­—æœºæ•ˆæœæ€è·¯ï¼ˆå‰ç«¯ï¼‰ğŸ“Œï¼š</p>
<ul>
<li>åç«¯ chunk é€šå¸¸æ˜¯æŒ‰å°æ®µè¿”å›ï¼Œå‰ç«¯æŠŠæ¯ä¸ª chunk è¿½åŠ åˆ° <code>buffer</code>ã€‚</li>
<li>ç”¨ä¸€ä¸ªå®šæ—¶å™¨ä»¥å›ºå®šé€Ÿåº¦ï¼ˆå¦‚ 20â€“40ms/å­—ç¬¦ï¼‰æŠŠ <code>buffer</code> çš„å­—ç¬¦é€ä¸ªç§»åŠ¨åˆ°å±•ç¤ºå†…å®¹ï¼Œä½¿æ–‡æœ¬é€å­—å‡ºç°ã€‚</li>
<li>onComplete æ—¶å¿«é€Ÿæ˜¾ç¤ºå‰©ä½™å­—ç¬¦å¹¶åœæ­¢å®šæ—¶å™¨ã€‚</li>
</ul>
<p>ä½ å¯ä»¥å‚è€ƒé¡¹ç›®ä¸­ <code>App.tsx</code> çš„å®ç°ï¼ˆå·²å®ç°é€ chunk è¿½åŠ ä¸æ‰“å­—æœºæ¸²æŸ“é€»è¾‘ï¼‰ã€‚</p>
<hr/>
<p>App.tsx</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MessageList</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/MessageList"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">ChatInput</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./components/ChatInput"</span>;
<span class="hljs-keyword">import</span> { chatService, <span class="hljs-title class_">Message</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"./services/chatService"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"./App.css"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title class_">App</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span> = <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> [messages, setMessages] = useState&lt;<span class="hljs-title class_">Message</span>[]&gt;([]);
  <span class="hljs-keyword">const</span> [isStreaming, setIsStreaming] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleSendMessage</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">message: <span class="hljs-built_in">string</span></span>) =&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-attr">userMessage</span>: <span class="hljs-title class_">Message</span> = { <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: message };
    <span class="hljs-title function_">setMessages</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, userMessage]);
    <span class="hljs-title function_">setIsStreaming</span>(<span class="hljs-literal">true</span>);

    <span class="hljs-keyword">let</span> assistantContent = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">const</span> conversationHistory = messages;

    <span class="hljs-keyword">await</span> chatService.<span class="hljs-title function_">sendMessageStream</span>(
      message,
      conversationHistory,
      <span class="hljs-function">(<span class="hljs-params">chunk: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        assistantContent += chunk;
        <span class="hljs-title function_">setMessages</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> newMessages = [...prev];
          <span class="hljs-keyword">const</span> lastMessage = newMessages[newMessages.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>];
          <span class="hljs-keyword">if</span> (lastMessage &amp;&amp; lastMessage.<span class="hljs-property">role</span> === <span class="hljs-string">"assistant"</span>) {
            lastMessage.<span class="hljs-property">content</span> = assistantContent;
          } <span class="hljs-keyword">else</span> {
            newMessages.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-attr">content</span>: assistantContent });
          }
          <span class="hljs-keyword">return</span> newMessages;
        });
      },
      <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">setIsStreaming</span>(<span class="hljs-literal">false</span>);
      },
      <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">string</span></span>) =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"æµå¼å“åº”é”™è¯¯:"</span>, error);
        <span class="hljs-title function_">setMessages</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [
          ...prev,
          { <span class="hljs-attr">role</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">"æŠ±æ­‰ï¼Œå‘ç”Ÿäº†é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚"</span> },
        ]);
        <span class="hljs-title function_">setIsStreaming</span>(<span class="hljs-literal">false</span>);
      },
    );
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>ğŸ¤– LangChain + æ™ºè°± GLM<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>AI èŠå¤©åŠ©æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app-main"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">MessageList</span> <span class="hljs-attr">messages</span>=<span class="hljs-string">{messages}</span> <span class="hljs-attr">isStreaming</span>=<span class="hljs-string">{isStreaming}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ChatInput</span> <span class="hljs-attr">onSendMessage</span>=<span class="hljs-string">{handleSendMessage}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isStreaming}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;
</code></pre>
<p>MessageList</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { useRef, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Message</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"../services/chatService"</span>;

<span class="hljs-keyword">interface</span> <span class="hljs-title class_">MessageListProps</span> {
  <span class="hljs-attr">messages</span>: <span class="hljs-title class_">Message</span>[];
  <span class="hljs-attr">isStreaming</span>: <span class="hljs-built_in">boolean</span>;
}

<span class="hljs-keyword">const</span> <span class="hljs-title class_">MessageList</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">FC</span>&lt;<span class="hljs-title class_">MessageListProps</span>&gt; = <span class="hljs-function">(<span class="hljs-params">{ messages, isStreaming }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> messagesEndRef = useRef&lt;<span class="hljs-title class_">HTMLDivElement</span>&gt;(<span class="hljs-literal">null</span>);

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    messagesEndRef.<span class="hljs-property">current</span>?.<span class="hljs-title function_">scrollIntoView</span>({ <span class="hljs-attr">behavior</span>: <span class="hljs-string">"smooth"</span> });
  }, [messages, isStreaming]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-list"</span>&gt;</span>
      {messages.length === 0 ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"empty-state"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ğŸ‘‹ æ¬¢è¿ä½¿ç”¨ LangChain + æ™ºè°± GLM èŠå¤©åŠ©æ‰‹ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å¼€å§‹æé—®å§ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©ä½  ğŸ’¬<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ) : (
        messages.map((msg, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">message</span> ${<span class="hljs-attr">msg.role</span>}`}&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-avatar"</span>&gt;</span>
              {msg.role === "user" ? "ğŸ‘¤" : "ğŸ¤–"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-content"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-role"</span>&gt;</span>
                {msg.role === "user" ? "ç”¨æˆ·" : "AI åŠ©æ‰‹"}
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-text"</span>&gt;</span>{msg.content}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))
      )}
      {isStreaming &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message assistant"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-avatar"</span>&gt;</span>ğŸ¤–<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-content"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-role"</span>&gt;</span>AI åŠ©æ‰‹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-text streaming"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"typing-indicator"</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{messagesEndRef}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">MessageList</span>;
</code></pre>
<h3 data-id="heading-7">å…­ã€è°ƒè¯•å»ºè®®ä¸å¸¸è§å‘ âš ï¸</h3>
<ul>
<li>404ï¼šç¡®è®¤å‰ç«¯è¯·æ±‚è·¯å¾„ <code>/api/chat/stream</code> ä¸è·¯ç”±å‰ç¼€ä¸€è‡´ï¼›å¼€å‘æ—¶è‹¥ä½¿ç”¨ Viteï¼Œè¯·åœ¨ <code>vite.config.ts</code> é…ç½® proxy åˆ°åç«¯ç«¯å£ã€‚</li>
<li>SSE è¿”å› 404/ç©ºå“åº”ï¼šç¡®è®¤æ§åˆ¶å™¨é‡Œ <code>ctx.respond = false</code> å·²è®¾ç½®ï¼Œå¹¶ä¸”åœ¨è®¾ç½® header åç«‹å³å¼€å§‹ <code>ctx.res.write</code>ã€‚</li>
<li>headers already sentï¼šä¸è¦åœ¨å†™å…¥åŸç”Ÿ <code>res</code> åå†æ¬¡è®¾ç½® <code>ctx.body</code> æˆ– <code>ctx.status</code>ã€‚</li>
<li>CORSï¼šè‹¥è·¨åŸŸï¼Œç¡®ä¿åç«¯ CORS é…ç½®å…è®¸ <code>Content-Type</code>ã€<code>Authorization</code> ç­‰å¿…è¦ headerã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8">ä¸ƒã€å¿«é€Ÿä¸Šæ‰‹æµ‹è¯•å‘½ä»¤ ğŸ§ª</h3>
<p>å¯åŠ¨åç«¯ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨ backend ç›®å½•ä¸‹</span>
node src/app.js
<span class="hljs-comment"># æˆ–ä½¿ç”¨ nodemon</span>
npx nodemon src/app.js
</code></pre>
<p>ç”¨ curl æµ‹è¯•æµå¼ï¼ˆæŸ¥çœ‹å¿«é€Ÿè¿”å›æµï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">curl -N -H <span class="hljs-string">"Content-Type: application/json"</span> -X POST http://localhost:3001/api/chat/stream -d <span class="hljs-string">'{"message":"ä½ å¥½","conversationHistory":[]} '</span>
</code></pre>
<p>ä½ åº”èƒ½çœ‹åˆ°ç±»ä¼¼ï¼š</p>
<pre><code class="hljs language-css" lang="css">data: {"<span class="hljs-attribute">content</span>":<span class="hljs-string">"ä½ "</span>}
data: {"<span class="hljs-attribute">content</span>":<span class="hljs-string">"å¥½"</span>}
data: [DONE]
</code></pre>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2026 å¹´ Node.js + TS å¼€å‘ï¼šåˆ«å†çº ç»“ nodemon äº†ï¼ŒèŠèŠçƒ­ç¼–è¯‘çš„æœ€ä¼˜è§£]]></title>    <link>https://juejin.cn/post/7595911076013899812</link>    <guid>https://juejin.cn/post/7595911076013899812</guid>    <pubDate>2026-01-17T06:18:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595911076013899812" data-draft-id="7595859552347701300" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2026 å¹´ Node.js + TS å¼€å‘ï¼šåˆ«å†çº ç»“ nodemon äº†ï¼ŒèŠèŠçƒ­ç¼–è¯‘çš„æœ€ä¼˜è§£"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2026-01-17T06:18:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="donecoding"/> <meta itemprop="url" content="https://juejin.cn/user/3192637500430093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2026 å¹´ Node.js + TS å¼€å‘ï¼šåˆ«å†çº ç»“ nodemon äº†ï¼ŒèŠèŠçƒ­ç¼–è¯‘çš„æœ€ä¼˜è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3192637500430093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    donecoding
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T06:18:21.000Z" title="Sat Jan 17 2026 06:18:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å¼€å‘ Node.js æœåŠ¡ç«¯æ—¶ï¼Œâ€œä¿®æ”¹ä»£ç  -&gt; è‡ªåŠ¨ç”Ÿæ•ˆâ€çš„å¼€å‘ä½“éªŒï¼ˆå³çƒ­ç¼–è¯‘/çƒ­æ›´æ–°ï¼‰æ˜¯å½±å“æ•ˆç‡çš„å…³é”®ã€‚éšç€Â <strong>Node.js 23+</strong> Â åŸç”Ÿæ”¯æŒ TS ä»¥åŠÂ <strong>Vite 5</strong>Â çš„æ™®åŠï¼Œæˆ‘ä»¬çš„å·¥å…·é“¾å·²ç»å‘ç”Ÿäº†å·¨å¤§çš„æ›´è¿­ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬æ·±åº¦æ‹†è§£ä¸‰ç§ä¸»æµçš„ Node.js TS å¼€å‘å®ç°æ–¹å¼ï¼Œå¸®ä½ é€‰å‡ºæœ€é€‚åˆ 2026 å¹´æ¶æ„çš„æ–¹æ¡ˆã€‚</p>
<hr/>
<p>ä¸€ã€ æ–¹æ¡ˆå¯¹æ¯”å¤§ç›˜ç‚¹</p>

































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>æ ¸å¿ƒåŸç†</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>tsx (Watch Mode)</strong></td><td>åŸºäº esbuild çš„æé€Ÿé‡å¯</td><td>é›¶é…ç½®ã€æ€§èƒ½å¼ºã€ç”Ÿæ€ä½æ›¿ä»£ nodemon</td><td>æ¯æ¬¡ä¿®æ”¹é‡å¯æ•´ä¸ªè¿›ç¨‹ï¼ŒçŠ¶æ€ä¸¢å¤±</td><td>å°å‹æœåŠ¡ã€å·¥å…·è„šæœ¬</td></tr><tr><td><strong>vite-node</strong></td><td>åŸºäº Vite çš„æ¨¡å—åŠ è½½å™¨</td><td>å®Œç¾ç»§æ‰¿ Vite é…ç½®ã€æ”¯æŒæ¨¡å—çº§ HMR</td><td>é…ç½®ç›¸å¯¹å¤æ‚ï¼Œéœ€æ‰‹åŠ¨å¤„ç† HMR é€»è¾‘</td><td>ä¸­å¤§å‹ Vite å…¨æ ˆé¡¹ç›®</td></tr><tr><td><strong>Node.js åŸç”Ÿ</strong></td><td>Node 23+ Type Stripping</td><td>æ— éœ€ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œå®˜æ–¹æ ‡å‡†</td><td>éœ€é«˜ç‰ˆæœ¬ Nodeï¼ŒåŠŸèƒ½ç›¸å¯¹å•ä¸€</td><td>è¿½æ±‚æç®€ã€å‰ç»æ€§å®éªŒ</td></tr></tbody></table>
<hr/>
<p>äºŒã€ æ–¹æ¡ˆè¯¦è§£</p>
<ol>
<li>ç°ä»£æ›¿ä»£è€…ï¼š<code>tsx</code>Â â€”â€” å‘Šåˆ« nodemon + ts-node</li>
</ol>
<p>è¿‡å»æˆ‘ä»¬å¸¸ç”¨Â <code>nodemon --exec ts-node</code>ï¼Œä½†åœ¨ ESM æ—¶ä»£ï¼Œè¿™å¥—ç»„åˆç»å¸¸æŠ¥Â <code>ERR_UNKNOWN_FILE_EXTENSION</code>Â é”™è¯¯ã€‚</p>
<p><strong><code>tsx</code></strong>Â å†…éƒ¨é›†æˆäº†Â <strong>esbuild</strong>ï¼Œå®ƒæ˜¯ç›®å‰ Node 18+ ç¯å¢ƒä¸‹æœ€ç¨³å¥çš„æ–¹æ¡ˆã€‚</p>
<ul>
<li>
<p><strong>å®ç°çƒ­ç¼–è¯‘ï¼š</strong></p>
<p>bash</p>
<pre><code class="hljs language-css" lang="css">npx tsx <span class="hljs-attr">--watch</span> <span class="hljs-attribute">src</span>/index<span class="hljs-selector-class">.ts</span>
</code></pre>
<p>è¯·è°¨æ…ä½¿ç”¨æ­¤ç±»ä»£ç ã€‚</p>
</li>
<li>
<p><strong>ä¸ºä»€ä¹ˆé€‰å®ƒï¼š</strong> Â å®ƒä¸éœ€è¦é¢å¤–çš„åŠ è½½å™¨é…ç½®ï¼ˆ--loaderï¼‰ï¼Œä¸”Â <code>watch</code>Â æ¨¡å¼éå¸¸æ™ºèƒ½ï¼Œé‡å¯é€Ÿåº¦åœ¨æ¯«ç§’çº§ã€‚</p>
</li>
</ul>
<ol start="2">
<li>å¼€å‘è€…ä½“éªŒå¤©èŠ±æ¿ï¼š<code>vite-node</code>Â â€”â€” çœŸæ­£çš„ HMR</li>
</ol>
<p>å¦‚æœä½ å·²ç»åœ¨é¡¹ç›®ä¸­ä½¿ç”¨Â <strong>Vite 5</strong>ï¼Œé‚£ä¹ˆÂ <code>vite-node</code>Â æ˜¯ä¸äºŒä¹‹é€‰ã€‚å®ƒä¸ä»…æ˜¯â€œé‡å¯â€ï¼Œè€Œæ˜¯â€œçƒ­æ›¿æ¢â€ã€‚</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>å…±äº«é…ç½®</strong>ï¼šç›´æ¥å¤ç”¨Â <code>vite.config.ts</code>Â ä¸­çš„Â <code>alias</code>Â å’Œæ’ä»¶ã€‚</li>
<li><strong>æŒ‰éœ€ç¼–è¯‘</strong>ï¼šåªç¼–è¯‘å½“å‰è¿è¡Œåˆ°çš„æ¨¡å—ï¼Œé¡¹ç›®è¶Šå¤§ä¼˜åŠ¿è¶Šæ˜æ˜¾ã€‚</li>
</ul>
</li>
<li>
<p><strong>å®ç°çƒ­æ›´æ–°ï¼ˆä¸é‡å¯è¿›ç¨‹ï¼‰ï¼š</strong></p>
<p>typescript</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/index.ts</span>
<span class="hljs-keyword">import</span> { app } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app'</span>;
<span class="hljs-keyword">let</span> server = app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>) {
  <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">hot</span>.<span class="hljs-title function_">accept</span>(<span class="hljs-string">'./app'</span>, <span class="hljs-function">(<span class="hljs-params">newModule</span>) =&gt;</span> {
    server.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// ä¼˜é›…å…³é—­æ—§æœåŠ¡</span>
    server = newModule.<span class="hljs-property">app</span>.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>); <span class="hljs-comment">// å¯åŠ¨æ–°é€»è¾‘ï¼ŒDBè¿æ¥å¯å¤ç”¨</span>
  });
}
</code></pre>
<p>è¯·è°¨æ…ä½¿ç”¨æ­¤ç±»ä»£ç ã€‚</p>
</li>
</ul>
<ol start="3">
<li>å®˜æ–¹æ­£ç»Ÿï¼šNode.js åŸç”Ÿæ”¯æŒ</li>
</ol>
<p>å¦‚æœä½ èƒ½ä½¿ç”¨Â <strong>Node.js 23.6+</strong> ï¼Œé‚£ä¹ˆå¯ä»¥æ‘†è„±æ‰€æœ‰æ„å»ºå·¥å…·ã€‚</p>
<ul>
<li><strong>è¿è¡Œï¼š</strong> Â <code>node --watch src/index.ts</code></li>
<li><strong>ç‚¹è¯„ï¼š</strong> Â è¿™æ˜¯æœªæ¥çš„è¶‹åŠ¿ï¼Œä½†åœ¨ 2026 å¹´ï¼Œç”±äºç”Ÿäº§ç¯å¢ƒå¾€å¾€è¿˜åœç•™åœ¨ Node 18/20 LTSï¼Œè¯¥æ–¹æ¡ˆç›®å‰æ›´å¤šç”¨äºæœ¬åœ°è½»é‡çº§å¼€å‘ã€‚</li>
</ul>
<hr/>
<p>ä¸‰ã€ é¿å‘æŒ‡å—ï¼šVite 5 æ‰“åŒ… Node æœåŠ¡çš„æŠ¥é”™</p>
<p>åœ¨å®ç°çƒ­ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœä½ å°è¯•ç”¨ Vite æ‰“åŒ… Node æœåŠ¡ï¼Œå¯èƒ½ä¼šé‡åˆ°ï¼š</p>
<blockquote>
<p><code>Invalid value for option "preserveEntrySignatures" - setting this option to false is not supported for "output.preserveModules"</code></p>
</blockquote>
<p><strong>åŸå› ï¼š</strong> Â å½“ä½ å¼€å¯Â <code>preserveModules: true</code>Â æƒ³ä¿æŒæºç ç›®å½•ç»“æ„è¾“å‡ºæ—¶ï¼ŒRollup æ— æ³•åœ¨â€œå¼ºåˆ¶ä¿ç•™æ¨¡å—â€çš„åŒæ—¶åˆâ€œæ‘‡æ ‘ä¼˜åŒ–ï¼ˆTree Shakingï¼‰â€æ‰å…¥å£å¯¼å‡ºã€‚</p>
<p><strong>ä¿®å¤æ–¹æ¡ˆï¼š</strong><br/>
åœ¨Â <code>vite.config.ts</code>Â ä¸­æ˜ç¡®è®¾ç½®ï¼š</p>
<p>typescript</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">build:</span> {
  <span class="hljs-attr">rollupOptions:</span> {
    <span class="hljs-attr">preserveEntrySignatures:</span> <span class="hljs-string">'exports-only'</span>, <span class="hljs-string">//</span> <span class="hljs-string">æ˜¾å¼å£°æ˜ä¿ç•™å¯¼å‡º</span>
    <span class="hljs-attr">output:</span> {
      <span class="hljs-attr">preserveModules:</span> <span class="hljs-literal">true</span>
    }
  }
}
</code></pre>
<p>è¯·è°¨æ…ä½¿ç”¨æ­¤ç±»ä»£ç ã€‚</p>
<hr/>
<p>å››ã€ æ€»ç»“ï¼šæˆ‘è¯¥é€‰å“ªä¸ªï¼Ÿ</p>
<ol>
<li><strong>å¦‚æœä½ åªæƒ³å¿«é€Ÿå†™ä¸ªæ¥å£ï¼Œä¸æƒ³æŠ˜è…¾é…ç½®</strong>ï¼šè¯·ç›´æ¥ä½¿ç”¨Â <strong><code>tsx</code></strong>ã€‚å®ƒæ˜¯ 2026 å¹´ nodemon çš„å®Œç¾ç»§æ‰¿è€…ã€‚</li>
<li><strong>å¦‚æœä½ åœ¨åšå¤æ‚å…¨æ ˆé¡¹ç›®ï¼Œæˆ–è€…æœ‰å¤§é‡çš„è·¯å¾„åˆ«å</strong>ï¼šè¯·ä½¿ç”¨Â <strong><code>vite-node</code></strong>ã€‚å®ƒèƒ½è®©ä½ åœ¨ Node ç«¯è·å¾—è·Ÿå‰ç«¯ React/Vue ç¼–å†™æ—¶ä¸€æ ·ä¸æ»‘çš„ HMR ä½“éªŒã€‚</li>
<li><strong>å¦‚æœæ˜¯ä¸ºäº†éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒ</strong>ï¼šæ— è®ºå¼€å‘ç¯å¢ƒç”¨ä»€ä¹ˆï¼Œç”Ÿäº§ç¯å¢ƒè¯·åŠ¡å¿…é€šè¿‡Â <code>vite build</code>Â äº§å‡ºçº¯å‡€çš„ JSï¼Œå¹¶ä½¿ç”¨Â <code>node dist/index.js</code>Â è¿è¡Œã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€2026æœ€æ–°æœ€å…¨ã€‘AIæ¶æ„èƒ½åŠ›-æ–°ä¸€ä»£æ¶æ„å›¾ç»˜åˆ¶æ–¹æ³•è®º]]></title>    <link>https://juejin.cn/post/7595873251165175849</link>    <guid>https://juejin.cn/post/7595873251165175849</guid>    <pubDate>2026-01-17T02:57:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595873251165175849" data-draft-id="7595800318519017478" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€2026æœ€æ–°æœ€å…¨ã€‘AIæ¶æ„èƒ½åŠ›-æ–°ä¸€ä»£æ¶æ„å›¾ç»˜åˆ¶æ–¹æ³•è®º"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-17T02:57:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Calvad0s"/> <meta itemprop="url" content="https://juejin.cn/user/650557396898199"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€2026æœ€æ–°æœ€å…¨ã€‘AIæ¶æ„èƒ½åŠ›-æ–°ä¸€ä»£æ¶æ„å›¾ç»˜åˆ¶æ–¹æ³•è®º
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/650557396898199/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Calvad0s
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T02:57:02.000Z" title="Sat Jan 17 2026 02:57:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<h2 data-id="heading-0">ä¸€ã€ä¼ ç»ŸITæ¶æ„å›¾ç»˜åˆ¶ç—›ç‚¹å’ŒAIæ¶æ„å›¾ç»˜åˆ¶ä»‹ç»</h2>
<h3 data-id="heading-1">1.1 ç»˜å›¾ç—›ç‚¹</h3>
<p>éœ€æ±‚èƒŒæ™¯ï¼š<strong>åšé¡¹ç›®çš„ç¬¬ä¸€æ­¥éƒ½ç¦»ä¸å¼€ç”»å›¾ï¼Œä¼ ç»ŸITæ¶æ„å›¾ç»˜åˆ¶çš„ç—›ç‚¹</strong></p>
<ul>
<li>
<p><strong>ç»˜åˆ¶æ•ˆç‡ä½</strong></p>
<ul>
<li><strong>æ‰‹åŠ¨ç»˜åˆ¶è€—æ—¶</strong>ï¼šä½¿ç”¨Visioã€Draw.ioã€ProcessOnç­‰å·¥å…·æ‰‹åŠ¨ç»˜åˆ¶ï¼Œä¸€ä¸ªå¤æ‚æ¶æ„å›¾éœ€è¦2-4å°æ—¶</li>
<li><strong>åå¤ä¿®æ”¹ç¹ç</strong>ï¼šæ¶æ„è°ƒæ•´åéœ€è¦æ‰‹åŠ¨ä¿®æ”¹æ¯ä¸ªç»„ä»¶ã€è¿çº¿ã€æ ‡æ³¨ï¼Œå·¥ä½œé‡å¤§</li>
<li><strong>ç‰ˆæœ¬ç®¡ç†å›°éš¾</strong>ï¼šå¤šç‰ˆæœ¬æ¶æ„å›¾éš¾ä»¥å¯¹æ¯”ï¼Œå®¹æ˜“ä¸¢å¤±å†å²ç‰ˆæœ¬</li>
</ul>
</li>
<li>
<p><strong>ç»˜åˆ¶è´¨é‡ä¸ç¨³å®š</strong></p>
<ul>
<li><strong>æ ‡å‡†åŒ–ç¨‹åº¦ä½</strong>ï¼šä¸åŒäººå‘˜ç»˜åˆ¶é£æ ¼ä¸ç»Ÿä¸€ï¼Œç¼ºä¹ç»Ÿä¸€æ ‡å‡†</li>
<li><strong>å®¹æ˜“å‡ºé”™é—æ¼</strong>ï¼šæ‰‹åŠ¨ç»˜åˆ¶å®¹æ˜“é—æ¼ç»„ä»¶ã€è¿æ¥é”™è¯¯ã€æ ‡æ³¨ä¸è§„èŒƒ</li>
<li><strong>ä¸“ä¸šé—¨æ§›é«˜</strong>ï¼šæ–°äººéœ€è¦å­¦ä¹ å·¥å…·ä½¿ç”¨ï¼Œç»˜åˆ¶ä¸“ä¸šæ¶æ„å›¾éœ€è¦ç»éªŒç§¯ç´¯</li>
</ul>
</li>
<li>
<p><strong>ç»´æŠ¤æˆæœ¬é«˜</strong></p>
<ul>
<li><strong>åŒæ­¥æ›´æ–°å›°éš¾</strong>ï¼šä»£ç å˜æ›´åï¼Œæ¶æ„å›¾éš¾ä»¥åŒæ­¥æ›´æ–°ï¼Œå®¹æ˜“è¿‡æ—¶</li>
<li><strong>å¤šäººåä½œå†²çª</strong>ï¼šå›¢é˜Ÿå¤šäººç¼–è¾‘åŒä¸€æ¶æ„å›¾ï¼Œå®¹æ˜“å‡ºç°å†²çªå’Œé‡å¤å·¥ä½œ</li>
<li><strong>æ–‡æ¡£åŒ–æˆæœ¬é«˜</strong>ï¼šéœ€è¦ä¸“é—¨ç»´æŠ¤æ¶æ„æ–‡æ¡£ï¼Œå¢åŠ å›¢é˜Ÿå·¥ä½œè´Ÿæ‹…</li>
</ul>
</li>
</ul>
<h3 data-id="heading-2">1.2Â ä»€ä¹ˆæ˜¯AIæ¶æ„å›¾ç»˜åˆ¶ï¼Ÿ</h3>
<h4 data-id="heading-3">å®šä¹‰</h4>
<p>AIæ¶æ„å›¾ç»˜åˆ¶æ˜¯åˆ©ç”¨AIå¤§æ¨¡å‹èƒ½åŠ›ï¼Œé€šè¿‡è‡ªç„¶è¯­è¨€æè¿°è‡ªåŠ¨ç”ŸæˆITæ¶æ„å›¾çš„æŠ€æœ¯æ–¹æ¡ˆã€‚</p>
<p><strong>ç®€å•è¯´</strong>ï¼Œå°±åƒå¯¹AIè¯´"ç”»ä¸€ä¸ªå¾®æœåŠ¡æ¶æ„å›¾ï¼ŒåŒ…å«ç½‘å…³ã€ç”¨æˆ·æœåŠ¡ã€è®¢å•æœåŠ¡ã€æ•°æ®åº“"ï¼ŒAIå°±èƒ½è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šçš„æ¶æ„å›¾ã€‚</p>
<p><strong>æ ¸å¿ƒèƒ½åŠ›åŒ…æ‹¬</strong>ï¼š</p>
<ul>
<li><strong>è‡ªç„¶è¯­è¨€ç†è§£</strong>ï¼šç†è§£ä½ çš„æ¶æ„éœ€æ±‚æè¿°ï¼Œæå–å…³é”®ç»„ä»¶å’Œå…³ç³»</li>
<li><strong>æ™ºèƒ½å¸ƒå±€è®¾è®¡</strong>ï¼šè‡ªåŠ¨è®¾è®¡ç»„ä»¶ä½ç½®ã€è¿çº¿æ–¹å¼ï¼Œä¿è¯å›¾è¡¨æ¸…æ™°ç¾è§‚</li>
<li><strong>å¤šæ ¼å¼æ”¯æŒ</strong>ï¼šæ”¯æŒDraw.ioã€Mermaidã€PlantUMLç­‰å¤šç§æ ¼å¼è¾“å‡º</li>
<li><strong>æ¶æ„æ¨¡å¼è¯†åˆ«</strong>ï¼šè¯†åˆ«å¾®æœåŠ¡ã€åˆ†å±‚æ¶æ„ã€äº‹ä»¶é©±åŠ¨ç­‰å¸¸è§æ¶æ„æ¨¡å¼</li>
</ul>
<h4 data-id="heading-4">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li><strong>æ–°é¡¹ç›®æ¶æ„è®¾è®¡</strong>ï¼šå¿«é€Ÿç”Ÿæˆåˆå§‹æ¶æ„å›¾ï¼Œç”¨äºæŠ€æœ¯æ–¹æ¡ˆè¯„å®¡</li>
<li><strong>ç°æœ‰ç³»ç»Ÿæ¢³ç†</strong>ï¼šé€šè¿‡ä»£ç åˆ†æè‡ªåŠ¨ç”Ÿæˆç°æœ‰ç³»ç»Ÿæ¶æ„å›¾</li>
<li><strong>æŠ€æœ¯æ–¹æ¡ˆè¯„å®¡</strong>ï¼šå¿«é€Ÿäº§å‡ºå¤šä¸ªæ¶æ„æ–¹æ¡ˆå¯¹æ¯”å›¾</li>
<li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šç»Ÿä¸€æ¶æ„å›¾æ ‡å‡†ï¼Œæé«˜å›¢é˜Ÿæ²Ÿé€šæ•ˆç‡</li>
</ul>
<h4 data-id="heading-5">AIæ¶æ„å›¾ç»˜åˆ¶å·¥å…·ç±»å‹</h4>
<ul>
<li><strong>AIå¢å¼ºå‹ç»˜å›¾å·¥å…·</strong>ï¼šå¦‚next-ai-draw-ioï¼Œåœ¨ä¼ ç»Ÿç»˜å›¾å·¥å…·åŸºç¡€ä¸Šé›†æˆAIèƒ½åŠ›</li>
<li><strong>ä»£ç ç”Ÿæˆå›¾è¡¨å·¥å…·</strong>ï¼šå¦‚Mermaidï¼Œé€šè¿‡ä»£ç æè¿°ç”Ÿæˆå›¾è¡¨ï¼ŒAIè¾…åŠ©ä»£ç ç”Ÿæˆ</li>
<li><strong>æ³¨æ„ï¼šä¼ ç»Ÿçš„ITç»˜å›¾å·¥å…·ï¼Œ ä¹Ÿåœ¨é€æ­¥åŠ å…¥AIç»˜å›¾åŠŸèƒ½</strong></li>
</ul>
<h4 data-id="heading-6">æ³¨æ„äº‹é¡¹</h4>
<ul>
<li><strong>AIç”Ÿæˆçš„æ¶æ„å›¾éœ€è¦äººå·¥å®¡æ ¸</strong>ï¼šAIå¯èƒ½ä¸ç†è§£ä¸šåŠ¡ç»†èŠ‚ï¼Œéœ€è¦æŠ€æœ¯ä¸“å®¶æ ¡éªŒï¼ˆ<strong>ä¾æ—§ç¦»ä¸å¼€åŸºç¡€æ¶æ„èƒ½åŠ›</strong>ï¼‰</li>
<li><strong>æŒç»­ä¼˜åŒ–æç¤ºè¯</strong>ï¼šæ›´å¥½çš„æè¿°èƒ½ç”Ÿæˆæ›´å‡†ç¡®çš„æ¶æ„å›¾</li>
<li><strong>ç»“åˆä»£ç åŒæ­¥æ›´æ–°</strong>ï¼šå»ºè®®å°†æ¶æ„å›¾çº³å…¥ç‰ˆæœ¬æ§åˆ¶ï¼Œé…åˆä»£ç å˜æ›´è‡ªåŠ¨æ›´æ–°</li>
<li><strong>é€‰æ‹©åˆé€‚å·¥å…·</strong>ï¼šä¸åŒå·¥å…·é€‚åˆä¸åŒåœºæ™¯ï¼Œéœ€è¦æ ¹æ®å›¢é˜Ÿéœ€æ±‚é€‰æ‹©</li>
</ul>
<h2 data-id="heading-7">äºŒã€å·¥ç¨‹å¸ˆç”»æ¶æ„å›¾çš„ç§˜å¯†æ­¦å™¨-Mermaid</h2>
<h3 data-id="heading-8">2.1 ä¸ºä»€ä¹ˆéœ€è¦Mermaidï¼Ÿ</h3>
<ul>
<li><strong>å›¾è¡¨ç»´æŠ¤å›°éš¾</strong>ï¼šä¼ ç»Ÿå›¾ç‰‡æ ¼å¼éš¾ä»¥ç‰ˆæœ¬æ§åˆ¶ï¼Œä¿®æ”¹éº»çƒ¦</li>
<li><strong>æ–‡æ¡£è‡ªåŠ¨åŒ–éœ€æ±‚</strong>ï¼šéœ€è¦åœ¨Markdownç­‰æ–‡æ¡£ä¸­åµŒå…¥å›¾è¡¨</li>
<li><strong>å›¢é˜Ÿåä½œéœ€è¦</strong>ï¼šä»£ç åŒ–å›¾è¡¨ä¾¿äºå›¢é˜Ÿåä½œå’Œå®¡æŸ¥</li>
</ul>
<h3 data-id="heading-9">2.2 ä»€ä¹ˆæ˜¯Mermaidï¼Ÿ</h3>
<h4 data-id="heading-10"><strong>æ ¸å¿ƒå®šä¹‰</strong></h4>
<ul>
<li><strong>Mermaid æ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„å¼€æºå›¾è¡¨ç”Ÿæˆåº“</strong></li>
<li>å…è®¸ç”¨æˆ·é€šè¿‡<strong>ç®€æ´çš„æ–‡æœ¬è¯­æ³•</strong>ï¼ˆç±»ä¼¼ Markdownï¼‰æ¥å®šä¹‰æµç¨‹å›¾ã€æ—¶åºå›¾ã€ç±»å›¾ç­‰ï¼Œå¹¶è‡ªåŠ¨æ¸²æŸ“ä¸º SVG æˆ– PNG å›¾åƒ</li>
</ul>
<h4 data-id="heading-11"><strong>ç‰¹ç‚¹</strong></h4>
<ul>
<li><strong>ä»£ç å³æ–‡æ¡£</strong>ï¼šå›¾è¡¨å®šä¹‰å°±æ˜¯ä»£ç ï¼Œå¯ä»¥ç‰ˆæœ¬æ§åˆ¶ã€ä»£ç å®¡æŸ¥</li>
<li><strong>å¤šå›¾è¡¨ç±»å‹</strong>ï¼šæ”¯æŒæµç¨‹å›¾ã€æ—¶åºå›¾ã€ç±»å›¾ã€æ¶æ„å›¾ã€ç”˜ç‰¹å›¾ç­‰</li>
<li><strong>å¹¿æ³›æ”¯æŒ</strong>ï¼šGitHubã€GitLabã€Notionã€Typoraç­‰å¹³å°éƒ½æ”¯æŒMermaid</li>
<li><strong>AIç»˜åˆ¶æ¶æ„å›¾éœ€è¦</strong>ï¼šåˆ©ç”¨AIå¤§æ¨¡å‹ç»˜åˆ¶ä¸šåŠ¡æ¶æ„å›¾-å‡ºé”™å°‘çš„æƒ…å†µä¸‹é‡‡ç”¨è¿™ä¸ªæœ€å¥½</li>
</ul>
<h4 data-id="heading-12"><strong>åœ¨çº¿æ–‡æ¡£åœ°å€</strong></h4>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmermaid.nodejs.cn%2F" title="https://mermaid.nodejs.cn/" target="_blank" ref="nofollow noopener noreferrer">mermaid.nodejs.cn/</a></p>
<h3 data-id="heading-13">2.3 Mermaidæ”¯æŒçš„å›¾è¡¨ç±»å‹</h3>
<ul>
<li><strong>æµç¨‹å›¾ï¼ˆFlowchartï¼‰</strong> ï¼šç”¨äºä¸šåŠ¡æµç¨‹ã€ç®—æ³•æµç¨‹</li>
<li><strong>æ—¶åºå›¾ï¼ˆSequence Diagramï¼‰</strong> ï¼šç”¨äºå±•ç¤ºç³»ç»Ÿäº¤äº’æ—¶åº</li>
<li><strong>ç±»å›¾ï¼ˆClass Diagramï¼‰</strong> ï¼šç”¨äºå±•ç¤ºç±»ç»“æ„å’Œå…³ç³»</li>
<li><strong>æ¶æ„å›¾ï¼ˆC4 Context/Containerï¼‰</strong> ï¼šç”¨äºå±•ç¤ºç³»ç»Ÿæ¶æ„</li>
<li><strong>çŠ¶æ€å›¾ï¼ˆState Diagramï¼‰</strong> ï¼šç”¨äºå±•ç¤ºçŠ¶æ€è½¬æ¢</li>
<li><strong>ç”˜ç‰¹å›¾ï¼ˆGantt Chartï¼‰</strong> ï¼šç”¨äºé¡¹ç›®ç®¡ç†</li>
<li><strong>å®ä½“å…³ç³»å›¾ï¼ˆER Diagramï¼‰</strong> ï¼šç”¨äºæ•°æ®åº“è®¾è®¡</li>
</ul>
<h3 data-id="heading-14">2.4Â æ¶æ„å›¾è¯­æ³•ç¤ºä¾‹</h3>
<pre><code class="hljs language-css" lang="css">graph TB
    subgraph ç½‘å…³å±‚
        <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[API Gateway]</span>
    end
    
    subgraph æœåŠ¡å±‚
        <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[User Service]</span>
        C<span class="hljs-selector-attr">[Order Service]</span>
        D<span class="hljs-selector-attr">[Payment Service]</span>
    end
    
    subgraph æ•°æ®å±‚
        E<span class="hljs-selector-attr">[(MySQL)]</span>
        F<span class="hljs-selector-attr">[(Redis)]</span>
    end
    
    <span class="hljs-selector-tag">A</span> --&gt; <span class="hljs-selector-tag">B</span>
    <span class="hljs-selector-tag">A</span> --&gt; C
    <span class="hljs-selector-tag">A</span> --&gt; D
    <span class="hljs-selector-tag">B</span> --&gt; E
    C --&gt; E
    D --&gt; E
    <span class="hljs-selector-tag">B</span> --&gt; F
    C --&gt; F
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbe06c865e3b44728f8538a685fcdbfa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FsdmFkMHM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769223422&amp;x-signature=DIeR%2Bxr5DrjvmfefkQNAhBMgqWU%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹</p>
<h2 data-id="heading-15">ä¸‰ã€Mermaidåœ¨çº¿åœ°å€ç»˜åˆ¶æ¶æ„å›¾ä¸Šæ‰‹å®æˆ˜</h2>
<p>åœ¨çº¿è¿è¡Œåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmermaid-live.nodejs.cn%2Fedit" title="https://mermaid-live.nodejs.cn/edit" target="_blank" ref="nofollow noopener noreferrer">mermaid-live.nodejs.cn/edit</a></p>
<h3 data-id="heading-16">3.1Â æ¡ˆä¾‹å®æˆ˜ï¼šå¾®æœåŠ¡æ¶æ„å›¾ç»˜åˆ¶</h3>
<h4 data-id="heading-17">éœ€æ±‚è¯´æ˜</h4>
<ul>
<li>ç»˜åˆ¶å®Œæ•´çš„å¾®æœåŠ¡æ¶æ„å›¾</li>
<li>åŒ…å«ç½‘å…³å±‚ã€æœåŠ¡å±‚ã€æ•°æ®å±‚</li>
<li>å±•ç¤ºå„ç»„ä»¶ä¹‹é—´çš„å…³ç³»</li>
</ul>
<h4 data-id="heading-18">æ­¥éª¤</h4>
<ul>
<li>æ‰“å¼€åœ¨çº¿ç¼–è¾‘å™¨ï¼Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmermaid.live%2F" title="https://mermaid.live/" target="_blank" ref="nofollow noopener noreferrer">mermaid.live/</a></li>
<li>å¤åˆ¶ä»¥ä¸‹ä»£ç åˆ°å·¦ä¾§ç¼–è¾‘åŒº</li>
</ul>

<pre><code class="hljs language-sql" lang="sql">graph TB
    subgraph å®¢æˆ·ç«¯å±‚
        Web[Webå‰ç«¯]
        App[ç§»åŠ¨App]
    <span class="hljs-keyword">end</span>
    
    subgraph ç½‘å…³å±‚
        Gateway[API Gateway<span class="hljs-operator">&lt;</span>br<span class="hljs-operator">/</span><span class="hljs-operator">&gt;</span>Spring Cloud Gateway]
    <span class="hljs-keyword">end</span>
    
    subgraph æœåŠ¡æ³¨å†Œå‘ç°
        Nacos[Nacosæ³¨å†Œä¸­å¿ƒ]
    <span class="hljs-keyword">end</span>
    
    subgraph å¾®æœåŠ¡å±‚
        UserService[ç”¨æˆ·æœåŠ¡<span class="hljs-operator">&lt;</span>br<span class="hljs-operator">/</span><span class="hljs-operator">&gt;</span><span class="hljs-keyword">User</span> Service]
        OrderService[è®¢å•æœåŠ¡<span class="hljs-operator">&lt;</span>br<span class="hljs-operator">/</span><span class="hljs-operator">&gt;</span><span class="hljs-keyword">Order</span> Service]
        ProductService[å•†å“æœåŠ¡<span class="hljs-operator">&lt;</span>br<span class="hljs-operator">/</span><span class="hljs-operator">&gt;</span>Product Service]
        PaymentService[æ”¯ä»˜æœåŠ¡<span class="hljs-operator">&lt;</span>br<span class="hljs-operator">/</span><span class="hljs-operator">&gt;</span>Payment Service]
    <span class="hljs-keyword">end</span>
    
    subgraph ä¸­é—´ä»¶å±‚
        Redis[(Redisç¼“å­˜)]
        MQ[æ¶ˆæ¯é˜Ÿåˆ—<span class="hljs-operator">&lt;</span>br<span class="hljs-operator">/</span><span class="hljs-operator">&gt;</span>RocketMQ]
    <span class="hljs-keyword">end</span>
    
    subgraph æ•°æ®å±‚
        MySQL[(MySQLæ•°æ®åº“)]
    <span class="hljs-keyword">end</span>
    
    Web <span class="hljs-comment">--&gt; Gateway</span>
    App <span class="hljs-comment">--&gt; Gateway</span>
    Gateway <span class="hljs-comment">--&gt; Nacos</span>
    Gateway <span class="hljs-comment">--&gt; UserService</span>
    Gateway <span class="hljs-comment">--&gt; OrderService</span>
    Gateway <span class="hljs-comment">--&gt; ProductService</span>
    Gateway <span class="hljs-comment">--&gt; PaymentService</span>
    
    UserService <span class="hljs-comment">--&gt; Nacos</span>
    OrderService <span class="hljs-comment">--&gt; Nacos</span>
    ProductService <span class="hljs-comment">--&gt; Nacos</span>
    PaymentService <span class="hljs-comment">--&gt; Nacos</span>
    
    UserService <span class="hljs-comment">--&gt; Redis</span>
    OrderService <span class="hljs-comment">--&gt; Redis</span>
    ProductService <span class="hljs-comment">--&gt; Redis</span>
    
    UserService <span class="hljs-comment">--&gt; MySQL</span>
    OrderService <span class="hljs-comment">--&gt; MySQL</span>
    ProductService <span class="hljs-comment">--&gt; MySQL</span>
    PaymentService <span class="hljs-comment">--&gt; MySQL</span>
    
    OrderService <span class="hljs-comment">--&gt; MQ</span>
    PaymentService <span class="hljs-comment">--&gt; MQ</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de518a5eb1154ae8bafec3a554818c19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FsdmFkMHM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769223422&amp;x-signature=tsumorGw9ydYQnXfP1Zj7na6aoM%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹</p>
<h3 data-id="heading-19">3.2 Mermaidåœ¨é¡¹ç›®ä¸­çš„åº”ç”¨</h3>
<ul>
<li><strong>READMEæ–‡æ¡£</strong>ï¼šåœ¨é¡¹ç›®READMEä¸­æ·»åŠ æ¶æ„å›¾</li>
<li><strong>æŠ€æœ¯æ–‡æ¡£</strong>ï¼šåœ¨æŠ€æœ¯è®¾è®¡æ–‡æ¡£ä¸­åµŒå…¥æ¶æ„å›¾</li>
<li><strong>Wikiæ–‡æ¡£</strong>ï¼šåœ¨é¡¹ç›®Wikiä¸­ä½¿ç”¨Mermaidå›¾è¡¨</li>
<li><strong>ä»£ç æ³¨é‡Š</strong>ï¼šåœ¨ä»£ç æ³¨é‡Šä¸­ä½¿ç”¨Mermaidå±•ç¤ºé€»è¾‘æµç¨‹</li>
</ul>
<h2 data-id="heading-20">å››ã€AIæ¶æ„å›¾ç»˜åˆ¶å·¥å…·å¯¹æ¯”å’Œé€‰æ‹©æŒ‡å—</h2>
<h3 data-id="heading-21">4.1 éœ€æ±‚èƒŒæ™¯</h3>
<ul>
<li>
<p>çŸ¥é“äº†å¸¸è§çš„æ¶æ„å›¾å¯ä»¥é‡‡ç”¨Mermaidä»£ç è¿›è¡Œç»˜åˆ¶</p>
</li>
<li>
<p>æˆ‘ä»¬å°±å¯ä»¥è®©AIè¾…åŠ©ç”ŸæˆMermaidæ¶æ„å›¾ä»£ç ï¼Œå¸‚åœºæœ‰å¾ˆå¤šå·¥å…·</p>
</li>
<li>
<p>ä¸»è¦åˆ†ä¸¤ç±»</p>
<ul>
<li><strong>ä½¿ç”¨AIç¼–è¾‘å™¨</strong>ï¼šåœ¨Cursorã€Qoderç­‰AIç¼–è¾‘å™¨ä¸­æè¿°éœ€æ±‚ï¼ŒAIç”ŸæˆMermaidä»£ç </li>
<li><strong>ä½¿ç”¨åœ¨çº¿AIç”»å›¾</strong>ï¼šåœ¨processONã€next-ai-draw-io ç­‰ç½‘ç«™ä¸­ç›´æ¥ä¸­æè¿°éœ€æ±‚ï¼ŒAIç”ŸæˆMermaidä»£ç </li>
</ul>
</li>
</ul>
<h3 data-id="heading-22">4.2 ä¸»æµAIæ¶æ„å›¾ç»˜åˆ¶å·¥å…·</h3>
<h4 data-id="heading-23">åœ¨çº¿ç½‘ç«™ï¼š<strong>ProcessOn</strong></h4>
<ul>
<li>
<p><strong>å®šä½</strong>ï¼šåœ¨çº¿åä½œå¼æ€ç»´å¯¼å›¾ä¸æµç¨‹å›¾å·¥å…·ï¼Œæ”¯æŒ AI è¾…åŠ©ç»˜å›¾</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼šè½»é‡åŒ–æ“ä½œã€å®æ—¶åä½œã€æ¨¡æ¿ä¸°å¯Œã€AI å¿«é€Ÿç”Ÿæˆå›¾è¡¨</p>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ€ç»´å¯¼å›¾åˆ›ä½œã€æµç¨‹å›¾ç»˜åˆ¶ã€é¡¹ç›®ç®¡ç†ç”˜ç‰¹å›¾ã€å›¢é˜Ÿéœ€æ±‚æ¢³ç†ã€æ¶æ„åŸå‹è®¾è®¡</p>
</li>
<li>
<p>ä¼˜åŠ¿</p>
<ul>
<li>å…å®‰è£…åœ¨çº¿ä½¿ç”¨ï¼Œè·¨è®¾å¤‡åŒæ­¥ï¼Œæ”¯æŒå¤šäººå®æ—¶åä½œç¼–è¾‘ï¼Œå›¢é˜Ÿæ²Ÿé€šæ•ˆç‡é«˜</li>
<li>å†…ç½®æµ·é‡è¡Œä¸šæ¨¡æ¿ï¼ˆæµç¨‹å›¾ / æ€ç»´å¯¼å›¾ / ER å›¾ / æ¶æ„å›¾ç­‰ï¼‰ï¼Œæ–°æ‰‹æ˜“ä¸Šæ‰‹</li>
<li>AI è¾…åŠ©åŠŸèƒ½å¯ä¸€é”®ç”Ÿæˆå›¾è¡¨æ¡†æ¶ã€ä¼˜åŒ–æ’ç‰ˆï¼Œé™ä½å¤æ‚ç»˜å›¾é—¨æ§›</li>
</ul>
</li>
<li>
<p>åŠ£åŠ¿</p>
<ul>
<li>å…è´¹ç‰ˆæœ‰èŠ‚ç‚¹æ•°é‡å’Œæ–‡ä»¶æ•°é‡é™åˆ¶ï¼Œé«˜çº§åŠŸèƒ½éœ€å¼€é€šä¼šå‘˜</li>
<li>å®Œå…¨ä¾èµ–ç½‘ç»œç¯å¢ƒï¼Œç¦»çº¿çŠ¶æ€ä¸‹æ— æ³•ç¼–è¾‘å·²ä¿å­˜æ–‡ä»¶</li>
</ul>
</li>
<li>
<p><strong>æç¤ºè¯ç¤ºä¾‹</strong>ï¼š</p>
</li>
</ul>

<pre><code class="hljs language-diff" lang="diff">å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªå¾®æœåŠ¡æ¶æ„å›¾ï¼ŒåŒ…å«ï¼š
<span class="hljs-deletion">- APIç½‘å…³ä½œä¸ºå…¥å£</span>
<span class="hljs-deletion">- ç”¨æˆ·æœåŠ¡ã€è®¢å•æœåŠ¡ã€å•†å“æœåŠ¡ã€æ”¯ä»˜æœåŠ¡</span>
<span class="hljs-deletion">- NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒ</span>
<span class="hljs-deletion">- Redisç¼“å­˜å’ŒMySQLæ•°æ®åº“</span>
<span class="hljs-deletion">- å±•ç¤ºæ‰€æœ‰ç»„ä»¶ä¹‹é—´çš„è¿æ¥å…³ç³»</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-24">åœ¨çº¿ç½‘ç«™ï¼š<strong>next-ai-draw-io</strong></h4>
<ul>
<li>
<p><strong>å®šä½</strong>ï¼šåŸºäºDraw.ioçš„AIå¢å¼ºç‰ˆ</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼šåŠŸèƒ½å¼ºå¤§ã€ä¸“ä¸šç»˜å›¾ã€AIè¾…åŠ©ç”Ÿæˆ</p>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¤æ‚æ¶æ„å›¾ã€ä¸“ä¸šæ–‡æ¡£ã€å›¢é˜Ÿåä½œ</p>
</li>
<li>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>ç»§æ‰¿äº†Draw.ioçš„æ‰€æœ‰ä¸“ä¸šåŠŸèƒ½ï¼ŒAIè¾…åŠ©æå‡ç»˜åˆ¶æ•ˆç‡</li>
<li>æ”¯æŒå¤šç§æ ¼å¼å¯¼å‡ºï¼Œå›¾è¡¨è´¨é‡ä¸“ä¸šè§„èŒƒ</li>
</ul>
</li>
<li>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>éœ€è¦å­¦ä¹ Draw.ioåŸºæœ¬æ“ä½œï¼Œåœ¨çº¿ç‰ˆæœ¬å¯èƒ½å—ç½‘ç»œå½±å“ï¼Œå¤æ‚å›¾è¡¨ç”Ÿæˆå¯èƒ½éœ€è¦å¤šæ¬¡å¯¹è¯</li>
</ul>
</li>
</ul>
<h4 data-id="heading-25"><strong>Mermaid + AIç¼–è¾‘å™¨</strong></h4>
<ul>
<li>
<p><strong>å®šä½</strong>ï¼šä»£ç åŒ–å›¾è¡¨ç”Ÿæˆå·¥å…·</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼šä»£ç å³æ–‡æ¡£ã€ç‰ˆæœ¬æ§åˆ¶å‹å¥½ã€æ˜“äºç»´æŠ¤</p>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ–‡æ¡£åµŒå…¥ã€ç‰ˆæœ¬æ§åˆ¶</p>
</li>
<li>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>å›¾è¡¨ä»£ç å¯ä»¥ç‰ˆæœ¬æ§åˆ¶ã€æ˜“äºç»´æŠ¤å’Œæ›´æ–°</li>
<li>å¹¿æ³›å¹³å°æ”¯æŒï¼Œç»“åˆAIç¼–è¾‘å™¨å¿«é€Ÿç”Ÿæˆ</li>
</ul>
</li>
<li>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>éœ€è¦å­¦ä¹ Mermaidè¯­æ³•ï¼Œå¤æ‚å¸ƒå±€æ§åˆ¶ç›¸å¯¹å›°éš¾ï¼Œå¯è§†åŒ–ç¼–è¾‘èƒ½åŠ›è¾ƒå¼±</li>
</ul>
</li>
</ul>
<h4 data-id="heading-26"><strong>PlantUML + AIè¾…åŠ©</strong></h4>
<ul>
<li>
<p><strong>å®šä½</strong>ï¼šUMLå›¾è¡¨ç”Ÿæˆå·¥å…·</p>
</li>
<li>
<p><strong>ç‰¹ç‚¹</strong>ï¼šä¸“ä¸šUMLæ”¯æŒã€ä»£ç ç”Ÿæˆã€å¤šæ ¼å¼è¾“å‡º</p>
</li>
<li>
<p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šUMLè®¾è®¡ã€ç³»ç»Ÿè®¾è®¡ã€æ–‡æ¡£ç”Ÿæˆ</p>
</li>
<li>
<p><strong>ä¼˜åŠ¿</strong>ï¼š</p>
<ul>
<li>ä¸“ä¸šçš„UMLå›¾è¡¨æ”¯æŒï¼Œä»£ç åŒ–å®šä¹‰ä¾¿äºç»´æŠ¤ï¼Œæ”¯æŒå¤šç§å›¾è¡¨ç±»å‹</li>
</ul>
</li>
<li>
<p><strong>åŠ£åŠ¿</strong>ï¼š</p>
<ul>
<li>è¯­æ³•ç›¸å¯¹å¤æ‚ï¼Œä¸»è¦ç”¨äºUMLå›¾è¡¨ï¼Œå­¦ä¹ æˆæœ¬è¾ƒé«˜</li>
</ul>
</li>
</ul>















































<table><thead><tr><th><strong>å¯¹æ¯”ç»´åº¦</strong></th><th><strong>next-ai-draw-io</strong></th><th><strong>Mermaid+AI</strong></th><th><strong>PlantUML+AI</strong></th></tr></thead><tbody><tr><td><strong>å­¦ä¹ æˆæœ¬</strong></td><td>ä¸­ç­‰ï¼ˆéœ€å­¦Draw.ioï¼‰</td><td>ä½ï¼ˆè¯­æ³•ç®€å•ï¼‰</td><td>é«˜ï¼ˆè¯­æ³•å¤æ‚ï¼‰</td></tr><tr><td><strong>ç»˜åˆ¶æ•ˆç‡</strong></td><td>é«˜ï¼ˆAIè¾…åŠ©ï¼‰</td><td>é«˜ï¼ˆAIç”Ÿæˆï¼‰</td><td>ä¸­ï¼ˆéœ€å†™ä»£ç ï¼‰</td></tr><tr><td><strong>ç‰ˆæœ¬æ§åˆ¶</strong></td><td>ä¸­ç­‰ï¼ˆæ–‡ä»¶æ ¼å¼ï¼‰</td><td>é«˜ï¼ˆä»£ç æ ¼å¼ï¼‰</td><td>é«˜ï¼ˆä»£ç æ ¼å¼ï¼‰</td></tr><tr><td><strong>å›¾è¡¨è´¨é‡</strong></td><td>é«˜ï¼ˆä¸“ä¸šæ ‡å‡†ï¼‰</td><td>ä¸­é«˜</td><td>é«˜ï¼ˆUMLæ ‡å‡†ï¼‰</td></tr><tr><td><strong>ç»´æŠ¤æˆæœ¬</strong></td><td>ä¸­ï¼ˆæ‰‹åŠ¨ç»´æŠ¤ï¼‰</td><td>ä½ï¼ˆä»£ç ç»´æŠ¤ï¼‰</td><td>ä½ï¼ˆä»£ç ç»´æŠ¤ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å¤æ‚æ¶æ„ã€ä¸“ä¸šæ–‡æ¡£</td><td>æ–‡æ¡£åµŒå…¥ã€åä½œ</td><td>UMLè®¾è®¡</td></tr></tbody></table>
<h3 data-id="heading-27">4.3 é€‰æ‹©æŒ‡å—</h3>
<h4 data-id="heading-28">åœºæ™¯ä¸€ï¼šæ–°é¡¹ç›®æ¶æ„è®¾è®¡</h4>
<p>æ¨èå·¥å…·ï¼š<strong>next-ai-draw-io</strong></p>
<p>åŸå› ï¼šéœ€è¦ä¸“ä¸šç¾è§‚çš„æ¶æ„å›¾ç”¨äºæŠ€æœ¯æ–¹æ¡ˆè¯„å®¡ï¼ŒAIè¾…åŠ©å¯ä»¥å¿«é€Ÿç”Ÿæˆé«˜è´¨é‡å›¾è¡¨ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼ï¼šé€šè¿‡å¯¹è¯æè¿°æ¶æ„éœ€æ±‚ï¼ŒAIç”Ÿæˆå›¾è¡¨åæ‰‹åŠ¨å¾®è°ƒã€‚</p>
<h4 data-id="heading-29">åœºæ™¯äºŒï¼šæŠ€æœ¯æ–‡æ¡£ç¼–å†™</h4>
<p>æ¨èå·¥å…·ï¼šMermaid + AIç¼–è¾‘å™¨</p>
<p>åŸå› ï¼šæ–‡æ¡£éœ€è¦åµŒå…¥å›¾è¡¨ï¼ŒMermaidå¯ä»¥ç›´æ¥åœ¨Markdownä¸­ä½¿ç”¨ï¼Œç‰ˆæœ¬æ§åˆ¶å‹å¥½ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼ï¼šåœ¨AIç¼–è¾‘å™¨ä¸­æè¿°éœ€æ±‚ï¼ŒAIç”ŸæˆMermaidä»£ç ï¼ŒåµŒå…¥æ–‡æ¡£ã€‚</p>
<h4 data-id="heading-30">åœºæ™¯ä¸‰ï¼šç°æœ‰ç³»ç»Ÿæ¢³ç†</h4>
<p>æ¨èå·¥å…·ï¼šMermaid + AIä»£ç åˆ†æå·¥å…·ï¼ˆCursorã€Qoderï¼‰</p>
<p>åŸå› ï¼šè‡ªåŠ¨åˆ†æä»£ç ç”Ÿæˆæ¶æ„å›¾ï¼Œæ•ˆç‡æœ€é«˜ï¼Œåç»­ç”¨Mermaidç»´æŠ¤ã€‚</p>
<p>ä½¿ç”¨æ–¹å¼ï¼šå·¥å…·è‡ªåŠ¨åˆ†æä»£ç ï¼Œç”ŸæˆMermaidä»£ç ï¼Œçº³å…¥ç‰ˆæœ¬æ§åˆ¶ã€‚</p>
<h2 data-id="heading-31">äº”ã€ä»€ä¹ˆæ˜¯next-ai-draw-ioå’ŒAIæ¶æ„å›¾å®æˆ˜</h2>
<h3 data-id="heading-32">5.1 ä»€ä¹ˆæ˜¯next-ai-draw-ioï¼Ÿ</h3>
<p>next-ai-draw-ioæ˜¯åŸºäºDraw.ioçš„AIå¢å¼ºç‰ˆæœ¬ï¼Œé›†æˆäº†AIå¤§æ¨¡å‹èƒ½åŠ›ï¼Œæ”¯æŒé€šè¿‡è‡ªç„¶è¯­è¨€æè¿°è‡ªåŠ¨ç”Ÿæˆæ¶æ„å›¾ã€‚</p>
<p><strong>ç®€å•è¯´</strong>ï¼Œå°±åƒç»™Draw.ioè£…äº†ä¸€ä¸ª"AIåŠ©æ‰‹"ï¼Œä½ å¯ä»¥ç”¨æ–‡å­—æè¿°æ¶æ„ï¼ŒAIå¸®ä½ è‡ªåŠ¨ç”»å›¾ã€‚</p>
<ul>
<li>
<p><strong>æŠ€æœ¯ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li><strong>åŸºäºDraw.io</strong>ï¼šç»§æ‰¿äº†Draw.ioçš„æ‰€æœ‰åŠŸèƒ½å’Œä¼˜åŠ¿</li>
<li><strong>AIèƒ½åŠ›é›†æˆ</strong>ï¼šé›†æˆäº†GPTã€Claudeç­‰å¤§æ¨¡å‹ï¼Œæ”¯æŒæ™ºèƒ½ç»˜å›¾</li>
<li><strong>å®æ—¶ç”Ÿæˆ</strong>ï¼šæ”¯æŒå®æ—¶å¯¹è¯ç”Ÿæˆå’Œç¼–è¾‘æ¶æ„å›¾</li>
<li><strong>å¤šæ ¼å¼å¯¼å‡º</strong>ï¼šæ”¯æŒPNGã€SVGã€PDFç­‰å¤šç§æ ¼å¼å¯¼å‡º</li>
</ul>
</li>
<li>
<p>èµ„æ–™åœ°å€</p>
<ul>
<li>GitHubåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FDayuanJiang%2Fnext-ai-draw-io" title="https://github.com/DayuanJiang/next-ai-draw-io" target="_blank" ref="nofollow noopener noreferrer">github.com/DayuanJiangâ€¦</a></li>
</ul>
</li>
</ul>
<h3 data-id="heading-33">5.2Â ä¸ºä»€ä¹ˆéœ€è¦next-ai-draw-ioï¼Ÿ</h3>
<h4 data-id="heading-34">éœ€æ±‚èƒŒæ™¯</h4>
<ul>
<li><strong>Draw.ioåŠŸèƒ½å¼ºå¤§ä½†æ“ä½œå¤æ‚</strong>ï¼šä¸“ä¸šç»˜å›¾åŠŸèƒ½å¤šï¼Œä½†å­¦ä¹ æˆæœ¬é«˜</li>
<li><strong>æ¶æ„å›¾ç»˜åˆ¶æ•ˆç‡ä½</strong>ï¼šæ‰‹åŠ¨ç»˜åˆ¶å¤æ‚æ¶æ„å›¾éœ€è¦å¤§é‡æ—¶é—´</li>
<li><strong>éœ€è¦AIè¾…åŠ©æå‡æ•ˆç‡</strong>ï¼šå¸Œæœ›é€šè¿‡AIèƒ½åŠ›å¿«é€Ÿç”Ÿæˆä¸“ä¸šæ¶æ„å›¾</li>
</ul>
<h4 data-id="heading-35">æ ¸å¿ƒä½œç”¨</h4>
<ul>
<li><strong>æå‡ç»˜åˆ¶æ•ˆç‡</strong>ï¼šé€šè¿‡AIè¾…åŠ©ï¼Œç»˜åˆ¶æ—¶é—´ä»å°æ—¶çº§é™åˆ°åˆ†é’Ÿçº§</li>
<li><strong>é™ä½å­¦ä¹ æˆæœ¬</strong>ï¼šæ— éœ€æ·±å…¥å­¦ä¹ Draw.ioå¤æ‚åŠŸèƒ½ï¼Œç”¨è‡ªç„¶è¯­è¨€æè¿°å³å¯</li>
<li><strong>ä¿æŒä¸“ä¸šæ ‡å‡†</strong>ï¼šç”Ÿæˆçš„å›¾è¡¨ç¬¦åˆä¸“ä¸šè§„èŒƒï¼Œé£æ ¼ç»Ÿä¸€</li>
<li><strong>æ”¯æŒè¿­ä»£ä¼˜åŒ–</strong>ï¼šå¯ä»¥ä¸æ–­é€šè¿‡å¯¹è¯ä¼˜åŒ–å’Œå®Œå–„æ¶æ„å›¾</li>
</ul>
<h3 data-id="heading-36">5.3 æ¡ˆä¾‹å®æˆ˜</h3>
<h4 data-id="heading-37">éœ€æ±‚è¯´æ˜</h4>
<ul>
<li>å¿«é€Ÿç”Ÿæˆä¸€ä¸ªå¾®æœåŠ¡æ¶æ„å›¾</li>
<li>åŒ…å«APIç½‘å…³ã€ç”¨æˆ·æœåŠ¡ã€è®¢å•æœåŠ¡ã€æ”¯ä»˜æœåŠ¡ã€å•†å“æœåŠ¡</li>
<li>åŒ…å«Redisç¼“å­˜ã€MySQLæ•°æ®åº“</li>
</ul>
<h4 data-id="heading-38">å®æˆ˜æ­¥éª¤</h4>
<p><strong>æ­¥éª¤1ï¼šè®¿é—®next-ai-draw-io</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">è®¿é—®åœ°å€ï¼šhttps:<span class="hljs-comment">//next-ai-drawio.jiang.jp/zh</span>
æˆ–ä½¿ç”¨æœ¬åœ°éƒ¨ç½²ç‰ˆæœ¬
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>æ­¥éª¤2ï¼šä½¿ç”¨AIå¯¹è¯ç”Ÿæˆæ¶æ„å›¾</strong></p>
<pre><code class="hljs language-diff" lang="diff">å¯¹è¯ç¤ºä¾‹ï¼š

ç”¨æˆ·ï¼šå¸®æˆ‘ç”»ä¸€ä¸ªå¾®æœåŠ¡æ¶æ„å›¾ï¼ŒåŒ…å«ä»¥ä¸‹æœåŠ¡ï¼š
<span class="hljs-deletion">- APIç½‘å…³ï¼ˆGatewayï¼‰</span>
<span class="hljs-deletion">- ç”¨æˆ·æœåŠ¡ï¼ˆUser Serviceï¼‰</span>
<span class="hljs-deletion">- è®¢å•æœåŠ¡ï¼ˆOrder Serviceï¼‰</span>
<span class="hljs-deletion">- æ”¯ä»˜æœåŠ¡ï¼ˆPayment Serviceï¼‰</span>
<span class="hljs-deletion">- å•†å“æœåŠ¡ï¼ˆProduct Serviceï¼‰</span>
ä½¿ç”¨Redisä½œä¸ºç¼“å­˜ï¼ŒMySQLä½œä¸ºæ•°æ®åº“

AIï¼šæ­£åœ¨ä¸ºæ‚¨ç”Ÿæˆå¾®æœåŠ¡æ¶æ„å›¾...
å·²ç”Ÿæˆæ¶æ„å›¾ï¼ŒåŒ…å«ï¼š
<span class="hljs-deletion">- APIç½‘å…³ä½œä¸ºç»Ÿä¸€å…¥å£</span>
<span class="hljs-deletion">- äº”ä¸ªå¾®æœåŠ¡é€šè¿‡ç½‘å…³æš´éœ²æ¥å£</span>
<span class="hljs-deletion">- Redisç¼“å­˜å±‚ç”¨äºæé«˜æ€§èƒ½</span>
<span class="hljs-deletion">- MySQLæ•°æ®åº“å­˜å‚¨æŒä¹…åŒ–æ•°æ®</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c9e2d1e419eb4f309fd0397822d30c65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FsdmFkMHM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769223422&amp;x-signature=CJwo6DlXb8Lhoysyzu387w%2BKIZg%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹</p>
<p><strong>æ­¥éª¤3ï¼šä¼˜åŒ–å’Œå®Œå–„æ¶æ„å›¾</strong></p>
<pre><code class="hljs">ç”¨æˆ·ï¼šæ·»åŠ æœåŠ¡æ³¨å†Œä¸­å¿ƒNacosï¼Œå¹¶å°†æ‰€æœ‰æœåŠ¡æ³¨å†Œåˆ°Nacos

AIï¼šå·²æ·»åŠ NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œæ‰€æœ‰å¾®æœåŠ¡å·²æ³¨å†Œåˆ°Nacos
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>æ­¥éª¤4ï¼šå¯¼å‡ºæ¶æ„å›¾</strong></p>
<blockquote>
<p>å¯¼å‡ºæ ¼å¼ï¼š</p>
<ul>
<li>PNGï¼šç”¨äºæ–‡æ¡£æ’å…¥</li>
<li>SVGï¼šç”¨äºç½‘é¡µå±•ç¤º</li>
<li>PDFï¼šç”¨äºæ‰“å°</li>
<li>Draw.ioæ ¼å¼ï¼šç”¨äºåç»­ç¼–è¾‘</li>
</ul>
</blockquote>
<h2 data-id="heading-39">å…­ã€AIæ¶æ„å›¾ç»˜åˆ¶ç»¼åˆå®æˆ˜å’Œæœ€ä½³å®è·µ</h2>
<h3 data-id="heading-40">6.1 éœ€æ±‚è¯´æ˜</h3>
<ul>
<li>
<p><strong>é¡¹ç›®èƒŒæ™¯</strong>ï¼šç”µå•†å¾®æœåŠ¡ç³»ç»Ÿ</p>
</li>
<li>
<p><strong>åŠŸèƒ½æ¨¡å—</strong>ï¼š</p>
<ul>
<li>ç”¨æˆ·ç®¡ç†ã€å•†å“ç®¡ç†ã€è®¢å•ç®¡ç†ã€æ”¯ä»˜ç®¡ç†</li>
<li>è´­ç‰©è½¦ã€æ¨èç³»ç»Ÿã€æ¶ˆæ¯é€šçŸ¥</li>
</ul>
</li>
<li>
<p><strong>æŠ€æœ¯æ ˆ</strong>ï¼š</p>
<ul>
<li>ç½‘å…³ï¼šSpring Cloud Gateway</li>
<li>æ³¨å†Œä¸­å¿ƒï¼šNacos</li>
<li>æœåŠ¡ï¼šSpring Bootå¾®æœåŠ¡</li>
<li>ç¼“å­˜ï¼šRedis</li>
<li>æ•°æ®åº“ï¼šMySQL</li>
<li>æ¶ˆæ¯é˜Ÿåˆ—ï¼šRabbitMQ</li>
<li>æœç´¢å¼•æ“ï¼šElasticsearch</li>
</ul>
</li>
</ul>
<h3 data-id="heading-41">6.2 å®æˆ˜æ­¥éª¤</h3>
<h4 data-id="heading-42"><strong>æ­¥éª¤1ï¼šä½¿ç”¨AIç”ŸæˆåŸºç¡€æ¶æ„å›¾ï¼ˆnext-ai-draw-ioï¼‰</strong></h4>
<pre><code class="hljs language-markdown" lang="markdown">AIå¯¹è¯æç¤ºè¯ï¼š

å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªç”µå•†å¾®æœåŠ¡ç³»ç»Ÿæ¶æ„å›¾ï¼ŒåŒ…å«ï¼š
<span class="hljs-bullet">1.</span> APIç½‘å…³å±‚ï¼šSpring Cloud Gateway
<span class="hljs-bullet">2.</span> æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼šNacos
<span class="hljs-bullet">3.</span> å¾®æœåŠ¡å±‚ï¼š
<span class="hljs-bullet">   -</span> ç”¨æˆ·æœåŠ¡
<span class="hljs-bullet">   -</span> å•†å“æœåŠ¡
<span class="hljs-bullet">   -</span> è®¢å•æœåŠ¡
<span class="hljs-bullet">   -</span> æ”¯ä»˜æœåŠ¡
<span class="hljs-bullet">   -</span> è´­ç‰©è½¦æœåŠ¡
<span class="hljs-bullet">   -</span> æ¨èæœåŠ¡
<span class="hljs-bullet">   -</span> æ¶ˆæ¯æœåŠ¡
<span class="hljs-bullet">4.</span> ä¸­é—´ä»¶å±‚ï¼š
<span class="hljs-bullet">   -</span> Redisç¼“å­˜
<span class="hljs-bullet">   -</span> RabbitMQæ¶ˆæ¯é˜Ÿåˆ—
<span class="hljs-bullet">   -</span> Elasticsearchæœç´¢å¼•æ“
<span class="hljs-bullet">5.</span> æ•°æ®å±‚ï¼š
<span class="hljs-bullet">   -</span> MySQLä¸»ä»æ•°æ®åº“
è¯·å±•ç¤ºå„ç»„ä»¶ä¹‹é—´çš„è¿æ¥å…³ç³»å’Œæ•°æ®æµå‘
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/749449cfdbaa4b95907b0b1603c8a071~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FsdmFkMHM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769223422&amp;x-signature=Z6q6iHJ74VyxmO3SLLExnoi6a%2Bw%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<h4 data-id="heading-43"><strong>æ­¥éª¤2ï¼šè½¬æ¢ä¸ºMermaidä»£ç ï¼ˆä¾¿äºæ–‡æ¡£ç»´æŠ¤ï¼‰</strong></h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ef5659110954e249152db771e788038~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FsdmFkMHM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769223422&amp;x-signature=k%2BGjQCnpqdUb3fCSqveD0Q9NjhY%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹ç¼–è¾‘</p>
<h4 data-id="heading-44">æ­¥éª¤ä¸‰ï¼šé¡¹ç›®æ ¹ç›®å½•åˆ›å»ºmdæ–‡æ¡£ï¼Œå°†ç”Ÿæˆçš„Mermaidä»£ç å¤åˆ¶åˆ°é‡Œé¢</h4>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">graph</span> <span class="hljs-selector-tag">TD</span>
    %% æ ·å¼å®šä¹‰
    <span class="hljs-selector-tag">classDef</span> <span class="hljs-selector-tag">client</span> <span class="hljs-selector-tag">fill</span>:<span class="hljs-selector-id">#d5e8d4</span>,<span class="hljs-selector-tag">stroke</span>:<span class="hljs-selector-id">#82b366</span>,<span class="hljs-selector-tag">stroke-width</span>:<span class="hljs-number">2px</span>
    <span class="hljs-selector-tag">classDef</span> <span class="hljs-selector-tag">gateway</span> <span class="hljs-selector-tag">fill</span>:<span class="hljs-selector-id">#1ba1e2</span>,<span class="hljs-selector-tag">stroke</span>:<span class="hljs-selector-id">#006EAF</span>,<span class="hljs-selector-tag">stroke-width</span>:<span class="hljs-number">2px</span>,<span class="hljs-selector-tag">color</span>:<span class="hljs-selector-id">#fff</span>
    <span class="hljs-selector-tag">classDef</span> <span class="hljs-selector-tag">service</span> <span class="hljs-selector-tag">fill</span>:<span class="hljs-selector-id">#f8cecc</span>,<span class="hljs-selector-tag">stroke</span>:<span class="hljs-selector-id">#b85450</span>,<span class="hljs-selector-tag">stroke-width</span>:<span class="hljs-number">2px</span>
    <span class="hljs-selector-tag">classDef</span> <span class="hljs-selector-tag">registry</span> <span class="hljs-selector-tag">fill</span>:<span class="hljs-selector-id">#966699</span>,<span class="hljs-selector-tag">stroke</span>:<span class="hljs-selector-id">#6c5278</span>,<span class="hljs-selector-tag">stroke-width</span>:<span class="hljs-number">2px</span>,<span class="hljs-selector-tag">color</span>:<span class="hljs-selector-id">#fff</span>
    <span class="hljs-selector-tag">classDef</span> <span class="hljs-selector-tag">middleware</span> <span class="hljs-selector-tag">fill</span>:<span class="hljs-selector-id">#82b366</span>,<span class="hljs-selector-tag">stroke</span>:<span class="hljs-selector-id">#669933</span>,<span class="hljs-selector-tag">stroke-width</span>:<span class="hljs-number">2px</span>,<span class="hljs-selector-tag">color</span>:<span class="hljs-selector-id">#fff</span>
    <span class="hljs-selector-tag">classDef</span> <span class="hljs-selector-tag">database</span> <span class="hljs-selector-tag">fill</span>:<span class="hljs-selector-id">#d79b00</span>,<span class="hljs-selector-tag">stroke</span>:<span class="hljs-selector-id">#A66C00</span>,<span class="hljs-selector-tag">stroke-width</span>:<span class="hljs-number">2px</span>,<span class="hljs-selector-tag">color</span>:<span class="hljs-selector-id">#fff</span>

    %% å®¢æˆ·ç«¯å±‚
    <span class="hljs-selector-tag">Client</span><span class="hljs-selector-attr">[å®¢æˆ·ç«¯]</span>:::<span class="hljs-selector-tag">client</span>

    %% <span class="hljs-selector-tag">API</span>ç½‘å…³å±‚
    <span class="hljs-selector-tag">Gateway</span><span class="hljs-selector-attr">[Spring Cloud Gateway]</span>:::<span class="hljs-selector-tag">gateway</span>

    %% å¾®æœåŠ¡å±‚
    <span class="hljs-selector-tag">subgraph</span> å¾®æœåŠ¡å±‚
        <span class="hljs-selector-tag">UserService</span><span class="hljs-selector-attr">[ç”¨æˆ·æœåŠ¡]</span>:::<span class="hljs-selector-tag">service</span>
        <span class="hljs-selector-tag">ProductService</span><span class="hljs-selector-attr">[å•†å“æœåŠ¡]</span>:::<span class="hljs-selector-tag">service</span>
        <span class="hljs-selector-tag">OrderService</span><span class="hljs-selector-attr">[è®¢å•æœåŠ¡]</span>:::<span class="hljs-selector-tag">service</span>
        <span class="hljs-selector-tag">PaymentService</span><span class="hljs-selector-attr">[æ”¯ä»˜æœåŠ¡]</span>:::<span class="hljs-selector-tag">service</span>
        <span class="hljs-selector-tag">CartService</span><span class="hljs-selector-attr">[è´­ç‰©è½¦æœåŠ¡]</span>:::<span class="hljs-selector-tag">service</span>
        <span class="hljs-selector-tag">RecommendService</span><span class="hljs-selector-attr">[æ¨èæœåŠ¡]</span>:::<span class="hljs-selector-tag">service</span>
        <span class="hljs-selector-tag">MessageService</span><span class="hljs-selector-attr">[æ¶ˆæ¯æœåŠ¡]</span>:::<span class="hljs-selector-tag">service</span>
    <span class="hljs-selector-tag">end</span>

    %% æœåŠ¡æ³¨å†Œä¸­å¿ƒ
    <span class="hljs-selector-tag">subgraph</span> æœåŠ¡æ³¨å†Œä¸­å¿ƒ
        <span class="hljs-selector-tag">Nacos</span><span class="hljs-selector-attr">[Nacos]</span>:::<span class="hljs-selector-tag">registry</span>
    <span class="hljs-selector-tag">end</span>

    %% ä¸­é—´ä»¶å±‚
    <span class="hljs-selector-tag">subgraph</span> ä¸­é—´ä»¶å±‚
        <span class="hljs-selector-tag">Redis</span><span class="hljs-selector-attr">[Redisç¼“å­˜]</span>:::<span class="hljs-selector-tag">middleware</span>
        <span class="hljs-selector-tag">RabbitMQ</span><span class="hljs-selector-attr">[RabbitMQæ¶ˆæ¯é˜Ÿåˆ—]</span>:::<span class="hljs-selector-tag">middleware</span>
        <span class="hljs-selector-tag">Elasticsearch</span><span class="hljs-selector-attr">[Elasticsearch]</span>:::<span class="hljs-selector-tag">middleware</span>
    <span class="hljs-selector-tag">end</span>

    %% æ•°æ®å±‚
    <span class="hljs-selector-tag">subgraph</span> æ•°æ®å±‚
        <span class="hljs-selector-tag">MySQLMaster</span><span class="hljs-selector-attr">[MySQLä¸»åº“]</span>:::<span class="hljs-selector-tag">database</span>
        <span class="hljs-selector-tag">MySQLSlave</span><span class="hljs-selector-attr">[MySQLä»åº“]</span>:::<span class="hljs-selector-tag">database</span>
    <span class="hljs-selector-tag">end</span>

    %% è¿æ¥å…³ç³»
    <span class="hljs-selector-tag">Client</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">Gateway</span>

    <span class="hljs-selector-tag">Gateway</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">UserService</span>
    <span class="hljs-selector-tag">Gateway</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">ProductService</span>
    <span class="hljs-selector-tag">Gateway</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">OrderService</span>
    <span class="hljs-selector-tag">Gateway</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">PaymentService</span>
    <span class="hljs-selector-tag">Gateway</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">CartService</span>
    <span class="hljs-selector-tag">Gateway</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">RecommendService</span>
    <span class="hljs-selector-tag">Gateway</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">MessageService</span>

    %% æœåŠ¡æ³¨å†Œï¼ˆè™šçº¿ï¼‰
    <span class="hljs-selector-tag">UserService</span> <span class="hljs-selector-tag">-</span><span class="hljs-selector-class">.-</span>&gt;|æœåŠ¡æ³¨å†Œ| <span class="hljs-selector-tag">Nacos</span>
    <span class="hljs-selector-tag">ProductService</span> <span class="hljs-selector-tag">-</span><span class="hljs-selector-class">.-</span>&gt;|æœåŠ¡æ³¨å†Œ| <span class="hljs-selector-tag">Nacos</span>
    <span class="hljs-selector-tag">OrderService</span> <span class="hljs-selector-tag">-</span><span class="hljs-selector-class">.-</span>&gt;|æœåŠ¡æ³¨å†Œ| <span class="hljs-selector-tag">Nacos</span>
    <span class="hljs-selector-tag">PaymentService</span> <span class="hljs-selector-tag">-</span><span class="hljs-selector-class">.-</span>&gt;|æœåŠ¡æ³¨å†Œ| <span class="hljs-selector-tag">Nacos</span>
    <span class="hljs-selector-tag">CartService</span> <span class="hljs-selector-tag">-</span><span class="hljs-selector-class">.-</span>&gt;|æœåŠ¡æ³¨å†Œ| <span class="hljs-selector-tag">Nacos</span>
    <span class="hljs-selector-tag">RecommendService</span> <span class="hljs-selector-tag">-</span><span class="hljs-selector-class">.-</span>&gt;|æœåŠ¡æ³¨å†Œ| <span class="hljs-selector-tag">Nacos</span>
    <span class="hljs-selector-tag">MessageService</span> <span class="hljs-selector-tag">-</span><span class="hljs-selector-class">.-</span>&gt;|æœåŠ¡æ³¨å†Œ| <span class="hljs-selector-tag">Nacos</span>

    %% <span class="hljs-selector-tag">Redis</span>è¿æ¥
    <span class="hljs-selector-tag">UserService</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">Redis</span>
    <span class="hljs-selector-tag">ProductService</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">Redis</span>
    <span class="hljs-selector-tag">CartService</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">Redis</span>

    %% <span class="hljs-selector-tag">RabbitMQ</span>è¿æ¥
    <span class="hljs-selector-tag">OrderService</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">RabbitMQ</span>
    <span class="hljs-selector-tag">PaymentService</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">RabbitMQ</span>
    <span class="hljs-selector-tag">MessageService</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">RabbitMQ</span>

    %% <span class="hljs-selector-tag">Elasticsearch</span>è¿æ¥
    <span class="hljs-selector-tag">ProductService</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">Elasticsearch</span>
    <span class="hljs-selector-tag">RecommendService</span> <span class="hljs-selector-tag">--</span>&gt; <span class="hljs-selector-tag">Elasticsearch</span>

    %% <span class="hljs-selector-tag">MySQL</span>ä¸»åº“è¿æ¥ï¼ˆå†™æ“ä½œï¼‰
    <span class="hljs-selector-tag">UserService</span> <span class="hljs-selector-tag">--</span>&gt;|å†™| <span class="hljs-selector-tag">MySQLMaster</span>
    <span class="hljs-selector-tag">OrderService</span> <span class="hljs-selector-tag">--</span>&gt;|å†™| <span class="hljs-selector-tag">MySQLMaster</span>
    <span class="hljs-selector-tag">PaymentService</span> <span class="hljs-selector-tag">--</span>&gt;|å†™| <span class="hljs-selector-tag">MySQLMaster</span>
    <span class="hljs-selector-tag">ProductService</span> <span class="hljs-selector-tag">--</span>&gt;|å†™| <span class="hljs-selector-tag">MySQLMaster</span>

    %% <span class="hljs-selector-tag">MySQL</span>ä¸»ä»å¤åˆ¶
    <span class="hljs-selector-tag">MySQLMaster</span> <span class="hljs-selector-tag">-</span><span class="hljs-selector-class">.-</span>&gt;|è¯»å†™åˆ†ç¦»| <span class="hljs-selector-tag">MySQLSlave</span>

    %% <span class="hljs-selector-tag">MySQL</span>ä»åº“è¿æ¥ï¼ˆè¯»æ“ä½œï¼‰
    <span class="hljs-selector-tag">UserService</span> <span class="hljs-selector-tag">--</span>&gt;|è¯»| <span class="hljs-selector-tag">MySQLSlave</span>
    <span class="hljs-selector-tag">ProductService</span> <span class="hljs-selector-tag">--</span>&gt;|è¯»| <span class="hljs-selector-tag">MySQLSlave</span>
    <span class="hljs-selector-tag">OrderService</span> <span class="hljs-selector-tag">--</span>&gt;|è¯»| <span class="hljs-selector-tag">MySQLSlave</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/28f8dec5f9764ffcb5b3d47d5dc43469~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQ2FsdmFkMHM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769223422&amp;x-signature=Gisr0RbjjWopj8p4BixMRO65RzY%3D" alt="" loading="lazy"/><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/>â€‹</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä½ çœŸçš„ä¼šç”¨ Python çš„ print å—ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595842144906592306</link>    <guid>https://juejin.cn/post/7595842144906592306</guid>    <pubDate>2026-01-17T06:42:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595842144906592306" data-draft-id="7595808703074222106" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä½ çœŸçš„ä¼šç”¨ Python çš„ print å—ï¼Ÿ"/> <meta itemprop="keywords" content="Python,ç¼–ç¨‹è¯­è¨€"/> <meta itemprop="datePublished" content="2026-01-17T06:42:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="databook"/> <meta itemprop="url" content="https://juejin.cn/user/3526889035006702"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä½ çœŸçš„ä¼šç”¨ Python çš„ print å—ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3526889035006702/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    databook
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T06:42:15.000Z" title="Sat Jan 17 2026 06:42:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼ä»Šå¤©æˆ‘ä»¬æ¥èŠèŠ<code>Python</code>é‡Œæœ€ <strong>â€œå¹³å¹³æ— å¥‡â€</strong> å´åˆæ— å¤„ä¸åœ¨çš„<code>print()</code>å‡½æ•°ã€‚</p>
<p>ä½œä¸º<code>Python</code>å¼€å‘è€…ï¼Œæˆ‘ä»¬å‡ ä¹æ¯å¤©éƒ½åœ¨ç”¨å®ƒï¼Œä½†ä½ çœŸçš„äº†è§£å®ƒçš„æ‰€æœ‰ç©æ³•å—ï¼Ÿ</p>
<p>å…¶å®å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬åªç”¨äº†å®ƒ 10% çš„åŠŸåŠ›ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥æ‰’ä¸€æ‰’ <code>print</code> å‡½æ•°çš„â€œéšç§˜è§’è½â€ã€‚</p>
<p>æŒæ¡äº†å®ƒçš„å‡ ä¸ªå‚æ•°ï¼Œä¿è¯è®©ä½ åœ¨åŒäº‹çœ¼ä¸­ç¬é—´å˜èº« <code>Python</code> èµ„æ·±ç©å®¶ï¼</p>
<h2 data-id="heading-0">1. åŸºç¡€ç©æ³•ï¼šä¸ä»…ä»…æ˜¯æ‰“å°ä¸€ä¸ªå­—ç¬¦ä¸²</h2>
<p>å¦‚æœä½ æŠŠé¼ æ ‡æ‚¬åœåœ¨ <code>print</code> å‡½æ•°ä¸Šï¼Œä½ ä¼šå‘ç°å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°å…¶å®æ˜¯ <code>*args</code>ï¼ˆæˆ–è€…å« <code>*objects</code>ï¼‰ã€‚</p>
<p>é‚£ä¸ªæ˜Ÿå· <code>*</code> æ„å‘³ç€å®ƒæ˜¯ <strong>â€œè´ªå©ªâ€</strong> çš„--ä½ å¯ä»¥ç»™å®ƒå¡è¿›ä¸€ä¸ªï¼Œç”šè‡³æ— æ•°ä¸ªå¯¹è±¡ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ™®é€šç©å®¶</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¯›è‚š"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"é¸­è‚ "</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"é›ªèŠ±è‚¥ç‰›"</span>)

<span class="hljs-comment"># è¿›é˜¶ç©å®¶ï¼šä¸€æ¬¡æ€§æ‰“å°å¤šä¸ª</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ¯›è‚š"</span>, <span class="hljs-string">"é¸­è‚ "</span>, <span class="hljs-string">"é›ªèŠ±è‚¥ç‰›"</span>)
<span class="hljs-comment"># è¾“å‡ºï¼šæ¯›è‚š é¸­è‚  é›ªèŠ±è‚¥ç‰›</span>
</code></pre>
<p>æ›´é…·çš„æ˜¯ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªåˆ—è¡¨ï¼Œä½ å¯ä»¥ç›´æ¥é€šè¿‡<strong>è§£åŒ…</strong>ï¼ˆ<code>Unpacking</code>ï¼‰æŠŠå®ƒâ€œç‚¸â€å¼€ä¼ ç»™ <code>print</code>ï¼š</p>
<pre><code class="hljs language-python" lang="python">hotpot_list = [<span class="hljs-string">"è™¾æ»‘"</span>, <span class="hljs-string">"å®½ç²‰"</span>, <span class="hljs-string">"å¨ƒå¨ƒèœ"</span>]
<span class="hljs-built_in">print</span>(hotpot_list)
<span class="hljs-comment"># è¾“å‡ºï¼š['è™¾æ»‘', 'å®½ç²‰', 'å¨ƒå¨ƒèœ']</span>

<span class="hljs-comment"># åŠ ä¸Šæ˜Ÿå· * è¿›è¡Œè§£åŒ…</span>
<span class="hljs-built_in">print</span>(*hotpot_list)
<span class="hljs-comment"># è¾“å‡ºï¼šè™¾æ»‘ å®½ç²‰ å¨ƒå¨ƒèœ</span>
</code></pre>
<p>åŠ ä¸Š<code>*</code>å·ï¼Œåˆ—è¡¨çš„æ–¹æ‹¬å·æ²¡äº†ï¼Œé€—å·ä¹Ÿæ²¡äº†ï¼Œç›´æ¥å˜æˆäº†æ¸…çˆ½çš„ç©ºæ ¼åˆ†éš”ã€‚</p>
<h2 data-id="heading-1">2. æ‹’ç»åƒç¯‡ä¸€å¾‹çš„ç©ºæ ¼ï¼šsep å‚æ•°</h2>
<p>ç»†å¿ƒçš„ä½ å¯èƒ½å‘ç°äº†ï¼Œä¸Šé¢æ‰“å°å¤šä¸ªå…ƒç´ æ—¶ï¼Œé»˜è®¤æ˜¯ç”¨ç©ºæ ¼éš”å¼€çš„ã€‚</p>
<p>å¦‚æœä½ æƒ³æ‰“å°ä¸€ä¸ªæ—¥æœŸï¼Œæˆ–è€…ç”Ÿæˆä¸€ä¸ª <code>CSV</code> æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œç©ºæ ¼å°±æ˜¾å¾—å¾ˆå°´å°¬äº†ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œ<code>sep</code>ï¼ˆ<strong>separator åˆ†éš”ç¬¦</strong>ï¼‰å‚æ•°é—ªäº®ç™»åœºã€‚</p>
<p>æ¯”å¦‚ï¼šæ ¼å¼åŒ–æ—¥æœŸ</p>
<pre><code class="hljs language-python" lang="python">year = <span class="hljs-number">2026</span>
month = <span class="hljs-number">1</span>
day = <span class="hljs-number">15</span>

<span class="hljs-comment"># é»˜è®¤æƒ…å†µ</span>
<span class="hljs-built_in">print</span>(year, month, day)
<span class="hljs-comment"># è¾“å‡ºï¼š2026 1 15 ï¼ˆä¸å¤ªå¥½çœ‹ï¼‰</span>

<span class="hljs-comment"># ä½¿ç”¨ sep å‚æ•°</span>
<span class="hljs-built_in">print</span>(year, month, day, sep=<span class="hljs-string">"-"</span>)
<span class="hljs-comment"># è¾“å‡ºï¼š2026-1-15 ï¼ˆè¿™å°±å¯¹äº†ï¼ï¼‰</span>
</code></pre>
<p>æˆ–è€…ç”Ÿæˆä¸€ä¸ªç«–çº¿åˆ†å‰²çš„æ ‡é¢˜æ ·å¼ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-built_in">print</span>(<span class="hljs-string">"Python"</span>, <span class="hljs-string">"Java"</span>, <span class="hljs-string">"C++"</span>, sep=<span class="hljs-string">" | "</span>)
<span class="hljs-comment"># è¾“å‡ºï¼šPython | Java | C++</span>
</code></pre>
<p>åªè¦ä½ æ„¿æ„ï¼Œ<strong>åˆ†éš”ç¬¦</strong>å¯ä»¥æ˜¯<strong>ä»»ä½•å­—ç¬¦</strong>ï¼Œç”šè‡³æ˜¯<strong>ä¸€æ®µè¯</strong>ã€‚</p>
<h2 data-id="heading-2">3. æ§åˆ¶ç»“å°¾çš„è‰ºæœ¯ï¼šend å‚æ•°</h2>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>print</code> å‡½æ•°æ˜¯ä¸ªâ€œæ€¥æ€§å­â€ï¼Œæ¯æ‰“å°å®Œä¸€æ¬¡ï¼Œå®ƒéƒ½ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬æ•²ä¸€ä¸ªå›è½¦æ¢è¡Œï¼ˆ<code>\n</code>ï¼‰ã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿ç»­å†™ä¸‰ä¸ª <code>print</code>ï¼Œå®ƒä»¬ä¼šæ˜¾ç¤ºåœ¨ä¸‰è¡Œã€‚</p>
<p>ä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³æŠŠä¸¤å¥è¯è¿åœ¨ä¸€èµ·ï¼Œæˆ–è€…åœ¨åŒä¸€è¡Œè¾“å‡ºå†…å®¹ï¼Œè¿™æ—¶å°±éœ€è¦ <code>end</code> å‚æ•°å‡ºé©¬äº†ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-built_in">print</span>(<span class="hljs-string">"å‡¶æ‰‹å…¶å®æ˜¯"</span>, end=<span class="hljs-string">"......"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"ç®¡å®¶ï¼"</span>)
<span class="hljs-comment"># è¾“å‡ºï¼šå‡¶æ‰‹å…¶å®æ˜¯......ç®¡å®¶ï¼</span>
</code></pre>
<p>è¿™æ ·ï¼Œä¸¤è¡Œä»£ç çš„è¾“å‡ºæ— ç¼è¡”æ¥åœ¨äº†ä¸€èµ·ã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼š å¦‚æœä½ æŠŠ <code>end</code> è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²æˆ–è€…éæ¢è¡Œç¬¦ï¼Œè®°å¾—åœ¨æœ€åé€‚å½“åœ°åŠ ä¸€ä¸ªæ¢è¡Œï¼Œå¦åˆ™ä½ çš„ç»ˆç«¯æç¤ºç¬¦å¯èƒ½ä¼šå°´å°¬åœ°æŒ¤åœ¨æ–‡å­—åé¢ã€‚</p>
<h2 data-id="heading-3">4. å·å·è®°ç¬”å½•ï¼šfile å‚æ•°</h2>
<p>è¿™æ˜¯å¾ˆå¤šåˆå­¦è€…æœ€å®¹æ˜“å¿½ç•¥çš„å‚æ•°ã€‚</p>
<p><code>print</code> é»˜è®¤æ˜¯å°†å†…å®¹è¾“å‡ºåˆ° <code>sys.stdout</code>ï¼ˆä¹Ÿå°±æ˜¯ä½ çš„å±å¹•/æ§åˆ¶å°ï¼‰ï¼Œä½†å…¶å®ï¼Œå®ƒå®Œå…¨å¯ä»¥æŠŠå†…å®¹â€œæ‰“å°â€åˆ°æ–‡ä»¶é‡Œã€‚</p>
<p>è¿™å°±ç›¸å½“äºä½ è‡ªå·±å†™äº†ä¸€ä¸ªè¿·ä½ ç‰ˆçš„æ—¥å¿—è®°å½•å™¨ï¼ˆ<code>Logger</code>ï¼‰ï¼Œéå¸¸é€‚åˆå¿«é€Ÿè°ƒè¯•æˆ–è®°å½•è„šæœ¬è¿è¡Œç»“æœã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ç”¨äºè¿½åŠ å†…å®¹</span>
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"æ‘¸é±¼æ—¥å¿—.txt"</span>, <span class="hljs-string">"a"</span>, encoding=<span class="hljs-string">"utf-8"</span>) <span class="hljs-keyword">as</span> f:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"10:00 - å–äº†ä¸€æ¯å’–å•¡"</span>, file=f)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"10:30 - åˆ·äº†ä¸€ä¼šå„¿æ¨ç‰¹"</span>, file=f)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"11:00 - ç›¯ç€å±å¹•å‘å‘†"</span>, file=f)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ—¥å¿—è®°å½•å®Œæ¯•ï¼Œè¯·æŸ¥çœ‹ æ‘¸é±¼æ—¥å¿—.txt"</span>)
</code></pre>
<p>è¿è¡Œå®Œè¿™æ®µä»£ç ï¼Œæ§åˆ¶å°åªä¼šæ˜¾ç¤ºæœ€åä¸€å¥æç¤ºï¼Œè€Œä½ çš„ <strong>â€œæ‘¸é±¼è®°å½•â€</strong> å·²ç»æ‚„æ‚„ä¿å­˜åœ¨äº† txt æ–‡ä»¶é‡Œã€‚</p>
<p>è™½ç„¶å¯¹äºå¤§å‹é¡¹ç›®æˆ‘ä»¬æ¨èç”¨ <code>logging</code> æ¨¡å—ï¼Œä½†åœ¨è¿™ä¸ªè„šæœ¬å†™çš„å°å·¥å…·é‡Œï¼Œç”¨ <code>file</code> å‚æ•°ç®€ç›´ä¸è¦å¤ªæ–¹ä¾¿ã€‚</p>
<h2 data-id="heading-4">5. æ‹’ç»å¡é¡¿ï¼Œå®æ—¶åˆ·æ–°ï¼šflush å‚æ•°</h2>
<p>æœ€åè¿™ä¸ªå‚æ•° <code>flush</code>ï¼Œå¸¸å¸¸è®©æ–°æ‰‹æ‘¸ä¸ç€å¤´è„‘ã€‚</p>
<p>è®¡ç®—æœºä¸ºäº†æ•ˆç‡ï¼Œé€šå¸¸ä¼šæœ‰ <strong>â€œç¼“å†²åŒºâ€</strong> çš„æ¦‚å¿µã€‚</p>
<p>å½“ä½  <code>print</code> ä¸œè¥¿æ—¶ï¼Œå®ƒä¸ä¸€å®šä¼šç«‹åˆ»æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œè€Œæ˜¯æ”’å¤Ÿäº†ä¸€æ³¢å†ä¸€èµ·åå‡ºæ¥ï¼ˆç‰¹åˆ«æ˜¯å½“ä½ æ²¡æœ‰æ¢è¡Œçš„æ—¶å€™ï¼‰ã€‚</p>
<p>è¿™ä¼šå¯¼è‡´æœ‰æ—¶å€™ä½ å†™äº†ä»£ç ï¼Œå±å¹•å´åƒå¡æ­»äº†ä¸€æ ·åŠå¤©æ²¡ååº”ã€‚</p>
<p>å¦‚æœä½ æƒ³åšä¸€ä¸ªå€’è®¡æ—¶æˆ–è€…è¿›åº¦æ¡ï¼Œå°±éœ€è¦å°† <code>flush</code> è®¾ç½®ä¸º <code>True</code>ï¼Œå¼ºåˆ¶è®¡ç®—æœºï¼šâ€œåˆ«æ”’äº†ï¼Œç«‹åˆ»ç»™æˆ‘æ˜¾ç¤ºå‡ºæ¥ï¼â€</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> time

<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ­£åœ¨å…¥ä¾µç³»ç»Ÿ"</span>, end=<span class="hljs-string">""</span>)

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"."</span>, end=<span class="hljs-string">""</span>, flush=<span class="hljs-literal">True</span>) <span class="hljs-comment"># å…³é”®åœ¨è¿™é‡Œï¼</span>
    time.sleep(<span class="hljs-number">0.5</span>)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"\nå…¥ä¾µæˆåŠŸï¼"</span>)
</code></pre>
<p>å¦‚æœä½ ä¸åŠ  <code>flush=True</code>ï¼Œä½ å¯èƒ½ä¼šå‘ç°å±å¹•å¡é¡¿äº† <code>2.5</code> ç§’ï¼Œç„¶åä¸€æ¬¡æ€§è¹¦å‡ºäº”ä¸ªç‚¹ã€‚</p>
<p>åŠ ä¸Šä¹‹åï¼Œä½ å°±èƒ½çœ‹åˆ°é‚£ç§ <strong>â€œå˜Ÿ...å˜Ÿ...å˜Ÿ...â€</strong> çš„åŠ¨æ€åŠ è½½æ•ˆæœäº†ã€‚</p>
<h2 data-id="heading-5">6. æ€»ç»“</h2>
<p>è™½ç„¶åœ¨ <code>90%</code> çš„æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æœ€ç®€å•çš„ <code>print(x)</code>ï¼Œä½†ç¼–ç¨‹çš„ä¹è¶£å¾€å¾€éšè—åœ¨å‰©ä¸‹çš„ <code>10%</code> é‡Œã€‚</p>
<ul>
<li><code>*args</code>ï¼šè®©ä½ å¯ä»¥ä¸€æ¬¡æ‰“å°å¤šä¸ªå®è´ï¼Œæˆ–è€…è§£åŒ…åˆ—è¡¨ã€‚</li>
<li><code>sep</code>ï¼šè®©ä½ è‡ªå®šä¹‰å…ƒç´ ä¹‹é—´çš„èƒ¶æ°´ã€‚</li>
<li><code>end</code>ï¼šè®©ä½ æ§åˆ¶è¯æœ‰æ²¡æœ‰è¯´å®Œï¼ˆæ¢ä¸æ¢è¡Œï¼‰ã€‚</li>
<li><code>file</code>ï¼šè®©ä½ æŠŠè¯æ‚„æ‚„è¯´ç»™æ–‡ä»¶å¬ã€‚</li>
<li><code>flush</code>ï¼šè®©ä½ æ‹’ç»å»¶è¿Ÿï¼Œå³åˆ»å…‘ç°ã€‚</li>
</ul>
<p>æŒæ¡äº†è¿™äº›ï¼Œä¸‹æ¬¡æœ‰æœºä¼šå°±ç»™åŒäº‹éœ²ä¸€æ‰‹ï¼</p>
<p>Happy Coding!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring AI Alibabaä¸ Agent Scopeåˆ°åº•é€‰å“ªä¸ªï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595878718171316260</link>    <guid>https://juejin.cn/post/7595878718171316260</guid>    <pubDate>2026-01-17T06:42:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718171316260" data-draft-id="7596181746061082651" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring AI Alibabaä¸ Agent Scopeåˆ°åº•é€‰å“ªä¸ªï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯,äººå·¥æ™ºèƒ½,Java"/> <meta itemprop="datePublished" content="2026-01-17T06:42:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æƒ³ç”¨offeræ‰“ç‰Œ"/> <meta itemprop="url" content="https://juejin.cn/user/578781641968972"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring AI Alibabaä¸ Agent Scopeåˆ°åº•é€‰å“ªä¸ªï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/578781641968972/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æƒ³ç”¨offeræ‰“ç‰Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T06:42:50.000Z" title="Sat Jan 17 2026 06:42:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.8;font-weight:400;font-size:16px;word-spacing:2px;letter-spacing:2px;overflow-x:hidden;color:#3e3e3e;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:1.2em;border-bottom:2px solid #ef7060;word-spacing:0!important;letter-spacing:0!important;font-size:inherit;line-height:inherit;display:block;font-weight:400;background:#ef7060;color:#fff;padding:10px;border-top-right-radius:3px;border-top-left-radius:3px;margin-right:3px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="monokai">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#272822;color:#ddd}.hljs-keyword,.hljs-literal,.hljs-name,.hljs-selector-tag,.hljs-strong,.hljs-tag{color:#f92672}.hljs-code{color:#66d9ef}.hljs-class .hljs-title{color:#fff}.hljs-attribute,.hljs-link,.hljs-regexp,.hljs-symbol{color:#bf79db}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-emphasis,.hljs-section,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-string,.hljs-subst,.hljs-template-tag,.hljs-template-variable,.hljs-title,.hljs-type,.hljs-variable{color:#a6e22e}.hljs-comment,.hljs-deletion,.hljs-meta,.hljs-quote{color:#75715e}.hljs-doctag,.hljs-keyword,.hljs-literal,.hljs-section,.hljs-selector-id,.hljs-selector-tag,.hljs-title,.hljs-type{font-weight:700}</style><h2 data-id="heading-0">å¼•è¨€</h2>
<p>Spring AI Alibaba å’Œ Agent Scope <strong>è™½ç„¶éƒ½å‡ºè‡ªé˜¿é‡Œå·´å·´</strong>ï¼Œä½†å®ƒä»¬çš„æ ¸å¿ƒè®¾è®¡ç†å¿µã€é€‚ç”¨åœºæ™¯ä»¥åŠå¯¹â€œAgentï¼ˆæ™ºèƒ½ä½“ï¼‰â€çš„å®šä¹‰æœ‰æœ¬è´¨çš„åŒºåˆ«ã€‚é‚£æˆ‘ä»¬æ€ä¹ˆæ ¹æ®è‡ªå·±çš„åœºæ™¯æ¥é€‰æ‹©ä¸åŒçš„æ¡†æ¶å‘¢ï¼Ÿä»Šå¤©å°±æ¥è®²è®²è¿™ä¸¤è€…é€‚ç”¨çš„ä¸åŒåœºæ™¯ä¸ç›¸å…³æ¦‚å¿µï¼Œåç¨³æ‰¶å¥½ï¼</p>
<h2 data-id="heading-1">æ¦‚å¿µçº æ­£</h2>
<p>æœ‰äº›äººæ€»æ˜¯è®¤ä¸ºchatbot(ChatGPTã€DeepSeekç­‰)å°±æ˜¯Agentï¼Œå…¶å®æ˜¯é”™è¯¯çš„ã€‚</p>
<p>Agent = LLM(å¤§è„‘) + Memory(è®°å¿†) + Planning(è§„åˆ’) + Tool calling(å·¥å…·è°ƒç”¨)</p>
<p>ä¸“ä¸šçš„agentèƒ½å¸®ä½ è§£å†³ä¸“ä¸šé¢†åŸŸçš„é—®é¢˜ï¼Œè‡ªä¸»çº é”™ï¼Œè‡ªä¸»è§£å†³ã€‚</p>
<h2 data-id="heading-2">ç›®å‰çš„ä¸¤å¤§å‘å±•æ–¹å‘</h2>
<p>æ— è®ºæ˜¯ä»€ä¹ˆAIæ¡†æ¶ï¼Œéƒ½å‡ ä¹æ˜¯è¿™ä¸¤ç§å‘å±•æ–¹å‘ä¸­çš„ä¸€ç§ï¼Œç¬¬ä¸€ç§æ˜¯workflow(å·¥ä½œæµ)ï¼Œç¬¬äºŒç§æ˜¯Agentic(æ™ºèƒ½ä½“è‡ªä¸»æ¨¡å¼)ã€‚ä½†æœ‰è¶£çš„æ˜¯ï¼Œç°åœ¨çš„æ¡†æ¶å‘å±•è™½ç„¶å¤§ä½“æ˜¯å…¶ä¸­çš„ä¸€ç§ï¼Œä½†æ˜¯å†…éƒ¨çš„ä¸œè¥¿æ­£åœ¨æœç€ä¸¤ç§èŒƒå¼èåˆèµ°ã€‚</p>
<p>å› ä¸ºçº¯ç²¹çš„ Agent å¤ªä¸å¯æ§ï¼Œçº¯ç²¹çš„ Workflow å¤ªæ­»æ¿ï¼Œç°åœ¨è¡Œä¸šæ­£åœ¨å¾€ä¸­é—´èµ°ï¼Œå‡ºç°äº†ä¸€ä¸ªæ–°è¯å« <strong>Flow Engineering (æµç¨‹å·¥ç¨‹)</strong> ã€‚</p>
<p><strong>ç›®å‰çš„æœ€ä½³å®è·µæ˜¯ï¼š</strong> <strong>â€œå¤–å±‚æ˜¯ Workflowï¼ŒèŠ‚ç‚¹æ˜¯ Agentâ€</strong> æˆ–è€… <strong>â€œå¤§å±€å¯æ§ï¼Œå±€éƒ¨è‡ªä¸»â€</strong></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥è®²è®²ä¸¤ç§æ¨¡å¼æœ‰ä»€ä¹ˆä¸åŒå§</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d80a4e0ac29a4e8b9d76e6db3e89c036~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oOz55Sob2ZmZXLmiZPniYw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769236969&amp;x-signature=A6lz%2BRp58YL%2FiNUbxNkFzZ2zHds%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">Workflowæ¨¡å¼(å·¥ä½œæµ)</h3>
<p>è¿™ç§æ¨¡å¼è®¤ä¸ºï¼š<strong>LLM æ˜¯ä¸€ä¸ªä¸å¯é çš„â€œå‡½æ•°â€ï¼Œæˆ‘ä»¬éœ€è¦ç”¨å¯é çš„ä»£ç ç»“æ„æŠŠå®ƒâ€œæ¡†â€ä½ã€‚</strong> å®ƒä¸ç›¸ä¿¡ AI çš„è‡ªä¸»è§„åˆ’èƒ½åŠ›ï¼Œè€Œæ˜¯ç›¸ä¿¡<strong>äººç±»å·¥ç¨‹å¸ˆçš„æ¶æ„è®¾è®¡èƒ½åŠ›</strong>ã€‚</p>
<h4 data-id="heading-4">è¿è¡Œæœºåˆ¶</h4>
<ul>
<li>
<p><strong>ç»“æ„</strong>ï¼šæ˜¾å¼å®šä¹‰ <code>A -&gt; B -&gt; C</code> çš„è·¯å¾„ã€‚</p>
</li>
<li>
<p><strong>æ§åˆ¶æƒ</strong>ï¼š<strong>100% åœ¨ä»£ç ä¾§</strong>ã€‚ä½ ï¼ˆå¼€å‘è€…ï¼‰å†³å®šä½•æ—¶è°ƒç”¨ LLMï¼ŒPrompt æ˜¯ä»€ä¹ˆï¼Œè¾“å‡ºæ€ä¹ˆè§£æï¼Œè§£æå¤±è´¥æ€ä¹ˆé‡è¯•ã€‚</p>
</li>
<li>
<p><strong>å…¸å‹æ¨¡å¼</strong>ï¼š</p>
<ul>
<li><strong>Prompt Chaining (æç¤ºè¯é“¾)</strong> ï¼šStep 1 çš„è¾“å‡ºä½œä¸º Step 2 çš„è¾“å…¥ã€‚</li>
<li><strong>Router (è·¯ç”±)</strong> ï¼šå…ˆç”¨ä¸€ä¸ªå°æ¨¡å‹åˆ†ç±»ï¼ˆæ˜¯â€œé€€æ¬¾â€è¿˜æ˜¯â€œå’¨è¯¢â€ï¼Ÿï¼‰ï¼Œç„¶å <code>if-else</code> èµ°åˆ°ä¸åŒçš„å¤„ç†é“¾è·¯ã€‚</li>
<li><strong>Parallelization (å¹¶è¡Œ)</strong> ï¼šåŒæ—¶è®© LLM ç¿»è¯‘æˆ 3 ç§è¯­è¨€ï¼Œæœ€åèšåˆç»“æœã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-5">åç«¯è§†è§’ç±»æ¯”</h4>
<ul>
<li><strong>Java</strong>: å°±åƒ <code>CompletableFuture</code> çš„ç¼–æ’ï¼Œæˆ–è€… Spring Cloud Data Flowã€‚</li>
<li><strong>Go</strong>: å°±åƒé€šè¿‡ Channel ä¸²è”çš„ä¸€ç»„ Goroutine Pipelineã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š<strong>å¹‚ç­‰æ€§é«˜ã€å»¶è¿Ÿä½ã€å¯æµ‹è¯•</strong>ã€‚ä½ å†™ä¸ªå•å…ƒæµ‹è¯•ï¼Œè¾“å…¥ A å¿…ç„¶å¾—åˆ° Bï¼ˆæˆ–è€…è¯¯å·®åœ¨å¯æ§èŒƒå›´å†…ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-6">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li><strong>RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰</strong> ï¼šæœç´¢ -&gt; æ’åº -&gt; ç”Ÿæˆã€‚è·¯å¾„æå…¶å›ºå®šã€‚</li>
<li><strong>å®ä½“æå– / ç»“æ„åŒ–æ•°æ®å¤„ç†</strong>ï¼šä» PDF æå–å‘ç¥¨é‡‘é¢ã€‚</li>
<li><strong>é«˜é£é™©ä¸šåŠ¡</strong>ï¼šé‡‘èé£æ§ã€åŒ»ç–—å»ºè®®ï¼ˆå¿…é¡»æœ‰äººç±»å®šä¹‰çš„ Checkpointï¼‰</li>
</ul>
<h3 data-id="heading-7">Agentic æ¨¡å¼ (æ™ºèƒ½ä½“ / è‡ªä¸»æ¨¡å¼)</h3>
<p><strong>æ ¸å¿ƒç†å¿µï¼šCognitive Architecture (è®¤çŸ¥æ¶æ„)</strong></p>
<p>è¿™ç§æ¨¡å¼è®¤ä¸ºï¼š<strong>LLM æ˜¯ä¸€ä¸ªâ€œå¤§è„‘â€ï¼Œæˆ‘ä»¬åº”è¯¥ç»™å®ƒå·¥å…·å’Œç›®æ ‡ï¼Œè®©å®ƒè‡ªå·±æ‰¾è·¯ã€‚</strong> å®ƒå®¹å¿è¿‡ç¨‹çš„<strong>ä¸ç¡®å®šæ€§</strong>ï¼Œä»¥æ¢å–è§£å†³<strong>å¤æ‚ã€æœªçŸ¥é—®é¢˜</strong>çš„èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-8">è¿è¡Œæœºåˆ¶ï¼šLoop (å¾ªç¯)</h4>
<ul>
<li>
<p><strong>ç»“æ„</strong>ï¼š<code>While(ä»»åŠ¡æœªå®Œæˆ) { è§‚å¯Ÿ -&gt; æ€è€ƒ -&gt; è¡ŒåŠ¨ }</code>ã€‚</p>
</li>
<li>
<p><strong>æ§åˆ¶æƒ</strong>ï¼š<strong>åœ¨ LLM ä¾§</strong>ã€‚ç³»ç»Ÿåªç»™ä¸€ä¸ªç›®æ ‡ï¼ˆ"å¸®æˆ‘å†™ä¸ªè´ªåƒè›‡æ¸¸æˆ"ï¼‰ï¼ŒLLM è‡ªä¸»å†³å®šæ˜¯å…ˆå†™ä»£ç ï¼Œè¿˜æ˜¯å…ˆæŸ¥åº“ï¼Œè¿˜æ˜¯å…ˆä¿®å¤æŠ¥é”™ã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒèŒƒå¼</strong>ï¼š</p>
<ul>
<li><strong>ReAct (Reason + Act)</strong> ï¼šæ¨ç†å’Œè¡ŒåŠ¨äº¤æ›¿è¿›è¡Œã€‚</li>
<li><strong>Reflection (åæ€)</strong> ï¼šåšå®Œäº†è‡ªå·±æ£€æŸ¥ä¸€éï¼Œâ€œæˆ‘æœ‰ Bug å—ï¼Ÿæœ‰çš„è¯é‡å†™â€ã€‚</li>
<li><strong>Multi-Agent (å¤šæ™ºèƒ½ä½“)</strong> ï¼šæ¨¡æ‹Ÿäººç±»ç»„ç»‡ï¼ŒRole A (äº§å“ç»ç†) -&gt; Role B (ç¨‹åºå‘˜) -&gt; Role C (æµ‹è¯•)ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-9">åç«¯è§†è§’ç±»æ¯”</h4>
<ul>
<li><strong>æ¶æ„</strong>ï¼š<strong>äº‹ä»¶é©±åŠ¨æ¶æ„ (EDA) + æ¶ˆæ¯æ€»çº¿</strong>ã€‚è¿™æ›´åƒæ˜¯<strong>å¾®æœåŠ¡ç¼–èˆ (Choreography)</strong> ï¼ŒæœåŠ¡ä¹‹é—´é€šè¿‡ Topic äº¤äº’ï¼Œæ²¡æœ‰ä¸­å¿ƒåŒ–çš„ä¸Šå¸è§†è§’æ§åˆ¶æµç¨‹ã€‚</li>
<li><strong>Go</strong>: å°±åƒä¸€ä¸ªæ­»å¾ªç¯çš„ <code>select</code>ï¼Œæ ¹æ®ä¸åŒçš„ä¿¡å·åŠ¨æ€å†³å®šæ‰§è¡Œå“ªä¸ª <code>case</code>ã€‚</li>
<li><strong>ç‰¹ç‚¹</strong>ï¼š<strong>ä¸Šé™æé«˜ï¼Œä¸‹é™æä½</strong>ã€‚å®ƒå¯èƒ½å†™å‡ºæƒŠä¸–éª‡ä¿—çš„ä»£ç ï¼Œä¹Ÿå¯èƒ½åœ¨ä¸€ä¸ªæ­»å¾ªç¯é‡Œç©ºè½¬çƒ§é’±ï¼Œç›´åˆ° Token è€—å°½ã€‚</li>
</ul>
<h4 data-id="heading-10">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li><strong>å¼€æ”¾å¼ä»»åŠ¡</strong>ï¼šâ€œè°ƒç ”ä¸€ä¸‹ç°åœ¨çš„ AI å¸‚åœºç«å“å¹¶å†™ä»½æŠ¥å‘Šâ€ã€‚ï¼ˆæ²¡æ³•å†™æ­»æ­¥éª¤ï¼Œå› ä¸ºæœç´¢ç»“æœæ˜¯ä¸ç¡®å®šçš„ï¼‰</li>
<li><strong>ä»£ç ç”Ÿæˆä¸è‡ªåŠ¨ä¿®å¤</strong>ï¼šDevin ç±»äº§å“ã€‚</li>
<li><strong>å¤æ‚ä»¿çœŸ</strong>ï¼šæ¨¡æ‹Ÿç»æµç³»ç»Ÿã€æ¸¸æˆ NPC</li>
</ul>
<h2 data-id="heading-11">AgentScope java å’Œ Spring AI Alibabaçš„åŒºåˆ«</h2>
<p>ç®€å•æ¥è¯´ï¼Œä¸¤è€…çš„æ ¸å¿ƒè®¾è®¡ç†å¿µå’Œæ“…é•¿é¢†åŸŸä¸åŒã€‚</p>
<ul>
<li>
<p>AgentScope Javaï¼šæ˜¯ä¸€ä¸ªåŸç”Ÿä¸º Agentic èŒƒå¼è®¾è®¡çš„æ¡†æ¶ã€‚å®ƒçš„æ ¸å¿ƒæ˜¯ â€œAgentâ€ï¼Œæ—¨åœ¨å¸®åŠ©ä½ æ„å»ºä»¥ Agent ä¸ºä¸­å¿ƒã€å…·å¤‡è‡ªä¸»æ€è€ƒå’Œè¡ŒåŠ¨èƒ½åŠ›çš„æ™ºèƒ½åº”ç”¨ã€‚</p>
</li>
<li>
<p>Spring AI Alibabaï¼šæ›´ä¾§é‡äº Workflow ç¼–æ’ã€‚å®ƒä»¥ Spring AI ç”Ÿæ€å’Œå›¾ï¼ˆGraphï¼‰æ€æƒ³ä¸ºåŸºç¡€ï¼Œæ“…é•¿å°† AI èƒ½åŠ›ä½œä¸ºå·¥å…·ï¼Œèå…¥åˆ°é¢„å®šä¹‰çš„å·¥ä½œæµä¸­ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5482ba0a791e483fbeee5361a92c2deb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oOz55Sob2ZmZXLmiZPniYw=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769236969&amp;x-signature=jzTPFPe%2Fj9%2ByjLVbVxLa5x5%2FX%2FE%3D" alt="96ef27d99d419d3f61205a687f93a27a.jpg" loading="lazy"/></p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯åˆ†ä¸šåŠ¡åœºæ™¯é€‰ç”¨ä¸åŒçš„æ¡†æ¶ï¼š</p>
<ul>
<li>å¦‚æœä½ è¿½æ±‚ç¨³å®šã€æµç¨‹å¯æ§ï¼Œå¸Œæœ›AIæ ¹æ®ç¼–æ’çš„å·¥ä½œæµæ¥ä½œä¸šï¼Œåœºæ™¯æ˜¯RAGã€æ™ºèƒ½å®¢æœã€è¾…åŠ©å·¥å…·ç­‰ç­‰ï¼Œé‚£å°±é€‰æ‹©Spring AI Alibabaã€‚ç®€å•ç¼–æ’å¯ä»¥ä½¿ç”¨Agent FrameWorkï¼Œå¤æ‚ç¼–æ’å¯ä»¥ä½¿ç”¨æ›´åŠ åº•å±‚çš„Graphã€‚</li>
<li>å¦‚æœä½ è¿½æ±‚è‡ªä¸»ã€å¤šè§’è‰²åšå¼ˆï¼Œå¸Œæœ›AIå¯ä»¥æ›´åŠ è‡ªä¸»çš„æ¥å†³å®šå¦‚ä½•å®Œæˆè¦æ±‚ï¼Œåœºæ™¯æ˜¯åšç±»ä¼¼Manusã€è™šæ‹Ÿå›¢é˜Ÿç­‰ï¼Œé‚£å°±å¯ä»¥é€‰æ‹©Agent Scopeã€‚</li>
</ul>



































<table><thead><tr><th><strong>ç‰¹æ€§</strong></th><th><strong>Spring AI Alibaba</strong></th><th><strong>Agent Scope</strong></th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒç†å¿µ</strong></td><td><strong>Workflow-Centric (å·¥ä½œæµä¸ºä¸­å¿ƒ)</strong></td><td><strong>Agent-Centric (æ™ºèƒ½ä½“ä¸ºä¸­å¿ƒ)</strong></td></tr><tr><td><strong>æ§åˆ¶æƒ</strong></td><td><strong>å¼€å‘è€…æŒæ¡æ§åˆ¶æƒ</strong>ã€‚ä½ å®šä¹‰å¥½æµç¨‹å›¾ï¼ˆGraphï¼‰ï¼ŒAI åœ¨èŠ‚ç‚¹å†…æ‰§è¡Œä»»åŠ¡ã€‚</td><td><strong>æ¨¡å‹æŒæ¡éƒ¨åˆ†æ§åˆ¶æƒ</strong>ã€‚AI æ ¹æ® ReAct èŒƒå¼è‡ªä¸»å†³å®šä¸‹ä¸€æ­¥è°ƒç”¨ä»€ä¹ˆå·¥å…·æˆ–è”ç³»å“ªä¸ª Agentã€‚</td></tr><tr><td><strong>é€šä¿¡æ¨¡å¼</strong></td><td>ä¼ ç»Ÿçš„æœåŠ¡è°ƒç”¨ã€Event-Drivenã€‚</td><td><strong>æ¶ˆæ¯é©±åŠ¨ (Message-Passing)</strong> ã€‚ç±»ä¼¼ Actor æ¨¡å‹ï¼ŒAgent ä¹‹é—´äº’å‘æ¶ˆæ¯ã€‚</td></tr><tr><td><strong>æŠ€æœ¯æ ˆ</strong></td><td><strong>çº¯ Java</strong> (åŸºäº Spring Boot ç”Ÿæ€)ã€‚</td><td><strong>Python (ä¸»æ‰“)</strong> + <strong>Java ç‰ˆæœ¬</strong>ã€‚</td></tr><tr><td><strong>æœ€å¼ºé¡¹</strong></td><td>é›†æˆä¼ä¸šç°æœ‰ä¸šåŠ¡ã€RAGï¼ˆæ£€ç´¢å¢å¼ºï¼‰ã€ç¡®å®šæ€§é«˜çš„ä»»åŠ¡ç¼–æ’ã€‚</td><td>å¤šæ™ºèƒ½ä½“åä½œï¼ˆMulti-Agentï¼‰ã€å¤æ‚ä»¿çœŸæ¨¡æ‹Ÿã€å®¹é”™ä¸è‡ªæˆ‘ä¿®æ­£ã€‚</td></tr></tbody></table>
<p>ä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯é€‰æ‹©äº†Spring AI Alibabaå°±ä¸èƒ½ä½¿ç”¨ReAct Agentç­‰ï¼Œç›¸åï¼Œè¯¥æœ‰çš„å…¨éƒ¨éƒ½æœ‰ï¼Œåé¢Spring AI Alibabaè¿˜ä¼šå¼•å…¥Agent Scopeæ¥æé«˜A2Aèƒ½åŠ›ã€‚</p>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>ä¸¤ä¸ªæ¡†æ¶æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ˜¯ä¾§é‡ç‚¹å’Œè®¾è®¡æ€æƒ³éƒ½æœ‰ä¸åŒï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯æ¥è¿›è¡Œé€‰æ‹©ã€‚</p>
<p>å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« ç»™ä½ å¸¦æ¥äº†ä¸é”™çš„ä½“æ„Ÿï¼Œé‚£å°±ç‚¹èµ + æ”¶è— + å…³æ³¨å§ï¼Œè¿™æ˜¯æˆ‘æ›´æ–°çš„æœ€å¤§åŠ¨åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Codexé…åˆchorme-devtools-mcpä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7595859552347815988</link>    <guid>https://juejin.cn/post/7595859552347815988</guid>    <pubDate>2026-01-17T06:50:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595859552347815988" data-draft-id="7595858063502540834" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Codexé…åˆchorme-devtools-mcpä½¿ç”¨"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½,Chrome"/> <meta itemprop="datePublished" content="2026-01-17T06:50:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ —é¼ æ€ª"/> <meta itemprop="url" content="https://juejin.cn/user/3544481220790648"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Codexé…åˆchorme-devtools-mcpä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3544481220790648/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ —é¼ æ€ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T06:50:36.000Z" title="Sat Jan 17 2026 06:50:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€”â€” åŸºäº Codex CLI çš„æµè§ˆå™¨è¿è¡Œæ€ AI è°ƒè¯•æ–¹æ¡ˆ</p>
<blockquote>
<p>æœ¬æ–‡é‡ç‚¹è®°å½• <strong>chrome-devtools-mcp</strong> åœ¨ Windows ç¯å¢ƒä¸‹çš„å®‰è£…ã€é…ç½®ä¸ä½¿ç”¨å®è·µï¼Œ<br/>
ä»¥åŠå®ƒå¦‚ä½•ä¸ <strong>Codex CLI</strong> åä½œï¼Œæ„å»ºä¸€ä¸ªå…·å¤‡<strong>çœŸå®æµè§ˆå™¨è¿è¡Œæ€æ„ŸçŸ¥èƒ½åŠ›</strong>çš„ AI å·¥ç¨‹è°ƒè¯•ç¯å¢ƒã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦ chrome-devtools-mcpï¼Ÿ</h2>
<p>åœ¨å‰ç«¯å·¥ç¨‹å®è·µä¸­ï¼Œå¾ˆå¤šé—®é¢˜<strong>ä»…é ä»£ç æ˜¯æ— æ³•å®šä½çš„</strong>ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>æ¥å£è¯·æ±‚å¤±è´¥ï¼Œä½†ä»£ç çœ‹ä¸å‡ºé—®é¢˜</li>
<li>Cookie / Token åœ¨ WebViewã€iOSã€ç™»å½•è·³è½¬ä¸­ä¸¢å¤±</li>
<li>æŸäº›é€»è¾‘åªåœ¨çœŸå®æµè§ˆå™¨è¿è¡Œæ€æ‰ä¼šè§¦å‘</li>
<li>Console æŠ¥é”™ã€Network è¡Œä¸ºä¸ä»£ç ä¸ä¸€è‡´</li>
</ul>
<p>ä¼ ç»Ÿ AI ç¼–ç¨‹å·¥å…·çš„å±€é™åœ¨äºï¼š</p>
<ul>
<li>åªèƒ½â€œçœ‹ä»£ç â€</li>
<li>æ— æ³•æ„ŸçŸ¥çœŸå®æµè§ˆå™¨çš„ <strong>Network / DOM / Console</strong></li>
</ul>
<h3 data-id="heading-1">chrome-devtools-mcp çš„æ ¸å¿ƒä»·å€¼</h3>
<p><strong>chrome-devtools-mcp</strong> é€šè¿‡ Chrome DevTools Protocolï¼ˆCDPï¼‰ï¼Œè®© AI Agent èƒ½å¤Ÿï¼š</p>
<ul>
<li>å¯åŠ¨å¹¶æ§åˆ¶çœŸå® Chrome</li>
<li>è¯»å– Network è¯·æ±‚ä¸å“åº”</li>
<li>æŸ¥çœ‹ Console æŠ¥é”™</li>
<li>åˆ†æ DOM çŠ¶æ€</li>
<li>ç»“åˆè¿è¡Œæ€åå‘å®šä½ä»£ç é—®é¢˜</li>
</ul>
<p>è¿™ä½¿ AI ä»â€œä»£ç åˆ†æå™¨â€ï¼Œå‡çº§ä¸º <strong>å·¥ç¨‹çº§è°ƒè¯•åŠ©æ‰‹</strong>ã€‚</p>
<hr/>
<h3 data-id="heading-2">å…·ä½“æµç¨‹</h3>
<ol>
<li>å®‰è£…Codex CLIï¼Œå¤§éƒ¨åˆ†å¼€å‘æƒ…å†µä¸‹å¤§å®¶å¯èƒ½ä½¿ç”¨ Vscode ä¸­ Codex æ’ä»¶å¤šä¸€ç‚¹ï¼Œä½†æ˜¯ VsCodeä¸­Codexæ’ä»¶å¹¶ä¸æ”¯æŒæ‹“å±•å®‰è£…mcpï¼Œæ‰€ä»¥å…ˆå®‰è£…
<a href="https://link.juejin.cn?target=https%3A%2F%2Fdevelopers.openai.com%2Fcodex%2Fcli" target="_blank" title="https://developers.openai.com/codex/cli" ref="nofollow noopener noreferrer">codex cli</a></li>
</ol>

<pre><code class="hljs language-perl" lang="perl"><span class="hljs-comment"># Node ç‰ˆæœ¬è¦æ±‚ &gt;= 22</span>
nvm install <span class="hljs-number">22</span>
nvm <span class="hljs-keyword">use</span> <span class="hljs-number">22.22</span>.<span class="hljs-number">0</span>

npm install -g @openai/codex
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/711c4e74ec1447e58880c007d7e141e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qCX6byg5oCq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769237436&amp;x-signature=W0cY95XCk%2Bgvs5e6OfLUw%2F4PZyA%3D" alt="image.png" loading="lazy"/>
2. ç„¶åç™»å½•Codex CLI</p>
<pre><code class="hljs language-arduino" lang="arduino">codex <span class="hljs-comment">// å‘½ä»¤è¿›å…¥codex å¯¹è¯</span>
codex login  <span class="hljs-comment">// æˆæƒç™»å½•</span>
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a7ace38e5e9c468c9bcff67410d477b4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qCX6byg5oCq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769237436&amp;x-signature=6tIr%2F0JrjcTeIn9bxALOqWLBj3Y%3D" alt="image.png" loading="lazy"/>
å®Œæˆæµè§ˆå™¨æˆæƒåï¼Œå³å¯åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨ Codex CLIã€‚</p>
<ol start="3">
<li>å®‰è£… chrome-devtools-mcp</li>
</ol>

<pre><code class="hljs language-sql" lang="sql">codex mcp <span class="hljs-keyword">add</span> chrome<span class="hljs-operator">-</span>devtools <span class="hljs-comment">-- npx chrome-devtools-mcp@latest</span>
</code></pre>
<p>æ‰“å¼€codexé…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸‹é…ç½®ï¼Œå› ä¸ºæˆ‘çš„ chrom å®‰è£…åœ¨äº†Dç›˜
C:\Users\Administrator.codex\config.toml (å…¨å±€å®‰è£…é»˜è®¤è·¯å¾„)</p>
<pre><code class="hljs language-ini" lang="ini">è¯¥å‘½ä»¤ä¼šå°† `chrome-devtools-mcp` æ³¨å†Œä¸º Codex å¯ç”¨çš„ MCP Serverã€‚
<span class="hljs-section">[mcp_servers.chrome-devtools]</span>
<span class="hljs-attr">command</span> = <span class="hljs-string">"cmd"</span>
<span class="hljs-attr">args</span> = [
  <span class="hljs-string">"/c"</span>,
  <span class="hljs-string">"npx"</span>,
  <span class="hljs-string">"-y"</span>,
  <span class="hljs-string">"chrome-devtools-mcp@latest"</span>
]

!<span class="hljs-section">[image.png]</span>(https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e5245d1aa5f3407cb738588390e9817e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qCX6byg5oCq:q75.awebp?<span class="hljs-attr">rk3s</span>=f64ab15b&amp;x-expires=<span class="hljs-number">1769237436</span>&amp;x-signature=LgJ0gBB%<span class="hljs-number">2</span>B9py4afoNAf46iHkI3DA%<span class="hljs-number">3</span>D)
<span class="hljs-attr">env</span> = { 
  <span class="hljs-attr">SystemRoot</span> = <span class="hljs-string">"C:\\Windows"</span>,
  <span class="hljs-attr">CHROME_PATH</span> = <span class="hljs-string">"D:\\software\\chrome\\Google\\Chrome\\Application\\chrome.exe"</span>
}

<span class="hljs-attr">startup_timeout_ms</span> = <span class="hljs-number">30000</span>

// æ— éœ€æ‰§è¡Œchrome.exe <span class="hljs-attr">--remote-debugging-port</span>=<span class="hljs-number">9222</span> ä»–ä¼šè‡ªè¡Œå¯åŠ¨
</code></pre>
<p>4.  æ¥ä¸‹æ¥å°±å¤§åŠŸå‘Šæˆï¼Œå¯ä»¥è¾“å…¥å‘½ä»¤æ“æ§æµè§ˆå™¨
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e239129e4baf4598a0d8c3ded7cf75cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5qCX6byg5oCq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769237436&amp;x-signature=i4orkBK1CXZLc8fiqVgYcx1r7Rk%3D" alt="image.png" loading="lazy"/></p>
<p>æ€»ç»“ï¼šå½“å‰é˜¶æ®µä¾§é‡ <strong>ç¯å¢ƒä¸æ–¹æ¡ˆæ­å»º</strong>ã€‚ï¼Œåç»­æœ‰åœ¨æ—¥å¸¸ç¼–ç ä¸­è°ƒè¯•ä½¿ç”¨ä¸Šçš„ä½“éªŒåœ¨åé¦ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[éƒ¨ç½²ç¿»è½¦ç°åœºï¼šé‚£äº›å¹´æˆ‘ä»¬è¸©è¿‡çš„å‘]]></title>    <link>https://juejin.cn/post/7595878718171250724</link>    <guid>https://juejin.cn/post/7595878718171250724</guid>    <pubDate>2026-01-17T06:08:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595878718171250724" data-draft-id="7595911076013850660" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="éƒ¨ç½²ç¿»è½¦ç°åœºï¼šé‚£äº›å¹´æˆ‘ä»¬è¸©è¿‡çš„å‘"/> <meta itemprop="keywords" content="CI/CD"/> <meta itemprop="datePublished" content="2026-01-17T06:08:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜Agions"/> <meta itemprop="url" content="https://juejin.cn/user/360295545187751"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            éƒ¨ç½²ç¿»è½¦ç°åœºï¼šé‚£äº›å¹´æˆ‘ä»¬è¸©è¿‡çš„å‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295545187751/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜Agions
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T06:08:06.000Z" title="Sat Jan 17 2026 06:08:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‡Œæ™¨ä¸‰ç‚¹ï¼Œç”Ÿäº§ç¯å¢ƒç‚¸äº†</h2>
<p>å‘¨äº”æ™šä¸Š 11 ç‚¹ï¼Œä½ åˆšå‡†å¤‡å…³ç”µè„‘ä¸‹ç­ã€‚</p>
<p>"åº”è¯¥æ²¡äº‹å§ï¼Ÿå°±æ”¹äº†ä¸€è¡Œä»£ç ã€‚"</p>
<p>ä½ ç‚¹å‡»äº†éƒ¨ç½²æŒ‰é’®ã€‚</p>
<p>ä¸‰åˆ†é’Ÿåï¼Œè¿ç»´ç¾¤ç‚¸äº†ï¼š</p>
<p>"ç½‘ç«™æ‰“ä¸å¼€äº†ï¼"
"æ•°æ®åº“è¿æ¥å¤±è´¥ï¼"
"ç”¨æˆ·ç–¯ç‹‚æŠ•è¯‰ï¼"
"è€æ¿åœ¨é—®æ€ä¹ˆå›äº‹ï¼"</p>
<p>ä½ çš„æ‰‹å¼€å§‹å‘æŠ–ï¼Œå†·æ±—ç›´å†’ã€‚</p>
<p><strong>è¿™ä¸æ˜¯ç”µå½±æƒ…èŠ‚ï¼Œè¿™æ˜¯æ¯ä¸ªå¼€å‘è€…éƒ½å¯èƒ½ç»å†çš„å™©æ¢¦ã€‚</strong></p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥èŠèŠé‚£äº›å¹´æˆ‘ä»¬åœ¨éƒ¨ç½²æ—¶è¸©è¿‡çš„å‘ï¼Œä»¥åŠå¦‚ä½•é¿å…å®ƒä»¬ã€‚</p>
<hr/>
<h2 data-id="heading-1">é”™è¯¯ 1ï¼šç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒæ”¹ä»£ç </h2>
<h3 data-id="heading-2">ç¾éš¾ç°åœº</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># SSH è¿æ¥åˆ°ç”Ÿäº§æœåŠ¡å™¨</span>
ssh root@production-server

<span class="hljs-comment"># ç›´æ¥ä¿®æ”¹ä»£ç </span>
vim /var/www/app/index.js

<span class="hljs-comment"># æ”¹å®Œé‡å¯æœåŠ¡</span>
pm2 restart app

<span class="hljs-comment"># ç»“æœï¼šç½‘ç«™æŒ‚äº†ï¼Œè€Œä¸”ä¸çŸ¥é“æ”¹äº†ä»€ä¹ˆ ğŸ’¥</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ</strong></p>
<ul>
<li>"å°±æ”¹ä¸€è¡Œï¼Œå¾ˆå¿«çš„"</li>
<li>"æµ‹è¯•ç¯å¢ƒå¤ªæ…¢äº†"</li>
<li>"ç´§æ€¥ä¿®å¤ï¼Œæ¥ä¸åŠèµ°æµç¨‹"</li>
</ul>
<p><strong>ä¸ºä»€ä¹ˆä¼šç¿»è½¦ï¼Ÿ</strong></p>
<ol>
<li><strong>æ²¡æœ‰ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šæ”¹äº†ä»€ä¹ˆï¼Ÿè°æ”¹çš„ï¼Ÿä»€ä¹ˆæ—¶å€™æ”¹çš„ï¼Ÿå…¨éƒ½ä¸çŸ¥é“</li>
<li><strong>æ— æ³•å›æ»š</strong>ï¼šå‡ºé—®é¢˜äº†æƒ³æ¢å¤ï¼Ÿå¯¹ä¸èµ·ï¼Œæ²¡æœ‰å¤‡ä»½</li>
<li><strong>æ²¡æœ‰æµ‹è¯•</strong>ï¼šç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒæµ‹è¯•ï¼Œç”¨æˆ·å°±æ˜¯ä½ çš„æµ‹è¯•å‘˜</li>
<li><strong>å›¢é˜Ÿä¸çŸ¥æƒ…</strong>ï¼šå…¶ä»–äººä¸çŸ¥é“ä½ æ”¹äº†ä»€ä¹ˆï¼Œåç»­ç»´æŠ¤ä¸€è„¸æ‡µé€¼</li>
</ol>
<h3 data-id="heading-3">æ­£ç¡®å§¿åŠ¿ï¼šæ°¸è¿œä¸è¦ç›´æ¥æ”¹ç”Ÿäº§ç¯å¢ƒ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âœ… æ­£ç¡®çš„æµç¨‹</span>

<span class="hljs-comment"># 1. åœ¨æœ¬åœ°å¼€å‘åˆ†æ”¯ä¿®æ”¹</span>
git checkout -b hotfix/urgent-bug
<span class="hljs-comment"># ä¿®æ”¹ä»£ç ...</span>
git add .
git commit -m <span class="hljs-string">"fix: ä¿®å¤ç´§æ€¥ bug"</span>

<span class="hljs-comment"># 2. æ¨é€åˆ°è¿œç¨‹ä»“åº“</span>
git push origin hotfix/urgent-bug

<span class="hljs-comment"># 3. åˆ›å»º Pull Requestï¼Œä»£ç å®¡æŸ¥</span>
<span class="hljs-comment"># 4. åˆå¹¶åˆ°ä¸»åˆ†æ”¯</span>
<span class="hljs-comment"># 5. è§¦å‘ CI/CD è‡ªåŠ¨éƒ¨ç½²</span>

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨ Git Flow</span>
git flow hotfix start urgent-bug
<span class="hljs-comment"># ä¿®æ”¹ä»£ç ...</span>
git flow hotfix finish urgent-bug
</code></pre>
<p><strong>é»„é‡‘æ³•åˆ™ï¼š</strong></p>
<ul>
<li>âœ… æ‰€æœ‰ä»£ç ä¿®æ”¹éƒ½è¦ç»è¿‡ç‰ˆæœ¬æ§åˆ¶</li>
<li>âœ… æ‰€æœ‰éƒ¨ç½²éƒ½è¦ç»è¿‡ CI/CD æµç¨‹</li>
<li>âœ… ç”Ÿäº§ç¯å¢ƒåªè¯»ï¼Œä¸å¯å†™</li>
<li>âœ… ç´§æ€¥ä¿®å¤ä¹Ÿè¦èµ°æµç¨‹ï¼ˆå¯ä»¥ç®€åŒ–ï¼Œä½†ä¸èƒ½è·³è¿‡ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-4">é”™è¯¯ 2ï¼šæ²¡æœ‰å›æ»šè®¡åˆ’ï¼Œå‡ºé—®é¢˜å°±æ…Œäº†</h2>
<h3 data-id="heading-5">ç¾éš¾ç°åœº</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># éƒ¨ç½²æ–°ç‰ˆæœ¬</span>
./deploy.sh v2.0.0

<span class="hljs-comment"># 5 åˆ†é’Ÿåå‘ç°é—®é¢˜</span>
<span class="hljs-comment"># æƒ³å›æ»šï¼Œä½†æ˜¯...</span>

<span class="hljs-comment"># âŒ æ²¡æœ‰ä¿ç•™æ—§ç‰ˆæœ¬</span>
<span class="hljs-comment"># âŒ æ•°æ®åº“å·²ç»è¿ç§»ï¼Œæ— æ³•å›é€€</span>
<span class="hljs-comment"># âŒ é…ç½®æ–‡ä»¶è¢«è¦†ç›–</span>
<span class="hljs-comment"># âŒ ä¸çŸ¥é“æ€ä¹ˆå›æ»š</span>

<span class="hljs-comment"># ç»“æœï¼šç½‘ç«™æŒ‚äº† 2 å°æ—¶ï¼ŒæŸå¤±æƒ¨é‡</span>
</code></pre>
<p><strong>çœŸå®æ¡ˆä¾‹ï¼š</strong></p>
<p>æŸç”µå•†ç½‘ç«™åœ¨åŒåä¸€å½“å¤©éƒ¨ç½²æ–°ç‰ˆæœ¬ï¼Œç»“æœæ”¯ä»˜åŠŸèƒ½å‡ºç° bugã€‚å› ä¸ºæ²¡æœ‰å›æ»šæ–¹æ¡ˆï¼Œå·¥ç¨‹å¸ˆèŠ±äº† 3 å°æ—¶æ‰ä¿®å¤ï¼ŒæŸå¤±è®¢å•æ•°åƒä¸‡ã€‚</p>
<h3 data-id="heading-6">æ­£ç¡®å§¿åŠ¿ï¼šéƒ¨ç½²å‰å…ˆå‡†å¤‡å¥½å›æ»šæ–¹æ¡ˆ</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âœ… è“ç»¿éƒ¨ç½²ï¼ˆBlue-Green Deploymentï¼‰</span>

<span class="hljs-comment"># 1. ä¿ç•™æ—§ç‰ˆæœ¬ï¼ˆè“è‰²ç¯å¢ƒï¼‰</span>
<span class="hljs-comment"># 2. éƒ¨ç½²æ–°ç‰ˆæœ¬åˆ°æ–°ç¯å¢ƒï¼ˆç»¿è‰²ç¯å¢ƒï¼‰</span>
<span class="hljs-comment"># 3. åˆ‡æ¢æµé‡åˆ°ç»¿è‰²ç¯å¢ƒ</span>
<span class="hljs-comment"># 4. è§‚å¯Ÿä¸€æ®µæ—¶é—´</span>
<span class="hljs-comment"># 5. å¦‚æœæœ‰é—®é¢˜ï¼Œç«‹å³åˆ‡å›è“è‰²ç¯å¢ƒ</span>

<span class="hljs-comment"># Nginx é…ç½®ç¤ºä¾‹</span>
upstream backend {
    server blue.example.com:3000;   <span class="hljs-comment"># æ—§ç‰ˆæœ¬</span>
    <span class="hljs-comment"># server green.example.com:3000;  # æ–°ç‰ˆæœ¬ï¼ˆæ³¨é‡Šæ‰ï¼‰</span>
}

<span class="hljs-comment"># éƒ¨ç½²æ–°ç‰ˆæœ¬åï¼Œåªéœ€è¦ä¿®æ”¹é…ç½®</span>
upstream backend {
    <span class="hljs-comment"># server blue.example.com:3000;   # æ—§ç‰ˆæœ¬ï¼ˆæ³¨é‡Šæ‰ï¼‰</span>
    server green.example.com:3000;  <span class="hljs-comment"># æ–°ç‰ˆæœ¬</span>
}

<span class="hljs-comment"># é‡è½½ Nginxï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰</span>
nginx -s reload

<span class="hljs-comment"># å¦‚æœå‡ºé—®é¢˜ï¼Œç«‹å³åˆ‡å›</span>
upstream backend {
    server blue.example.com:3000;   <span class="hljs-comment"># åˆ‡å›æ—§ç‰ˆæœ¬</span>
}
nginx -s reload
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âœ… Kubernetes æ»šåŠ¨æ›´æ–° + å¿«é€Ÿå›æ»š</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">strategy:</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">RollingUpdate</span>
    <span class="hljs-attr">rollingUpdate:</span>
      <span class="hljs-attr">maxSurge:</span> <span class="hljs-number">1</span>        <span class="hljs-comment"># æœ€å¤šå¤šå‡º 1 ä¸ª Pod</span>
      <span class="hljs-attr">maxUnavailable:</span> <span class="hljs-number">0</span>  <span class="hljs-comment"># æœ€å¤š 0 ä¸ª Pod ä¸å¯ç”¨</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
        <span class="hljs-attr">image:</span> <span class="hljs-string">myapp:v2.0.0</span>

<span class="hljs-comment"># éƒ¨ç½²</span>
<span class="hljs-string">kubectl</span> <span class="hljs-string">apply</span> <span class="hljs-string">-f</span> <span class="hljs-string">deployment.yaml</span>

<span class="hljs-comment"># æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€</span>
<span class="hljs-string">kubectl</span> <span class="hljs-string">rollout</span> <span class="hljs-string">status</span> <span class="hljs-string">deployment/myapp</span>

<span class="hljs-comment"># å¦‚æœå‡ºé—®é¢˜ï¼Œä¸€é”®å›æ»š</span>
<span class="hljs-string">kubectl</span> <span class="hljs-string">rollout</span> <span class="hljs-string">undo</span> <span class="hljs-string">deployment/myapp</span>

<span class="hljs-comment"># å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬</span>
<span class="hljs-string">kubectl</span> <span class="hljs-string">rollout</span> <span class="hljs-string">undo</span> <span class="hljs-string">deployment/myapp</span> <span class="hljs-string">--to-revision=2</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… ä½¿ç”¨ PM2 çš„éƒ¨ç½²å’Œå›æ»š</span>
<span class="hljs-comment">// ecosystem.config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">apps</span>: [{
    <span class="hljs-attr">name</span>: <span class="hljs-string">'myapp'</span>,
    <span class="hljs-attr">script</span>: <span class="hljs-string">'./app.js'</span>,
    <span class="hljs-attr">instances</span>: <span class="hljs-number">4</span>,
    <span class="hljs-attr">exec_mode</span>: <span class="hljs-string">'cluster'</span>,
    <span class="hljs-attr">env</span>: {
      <span class="hljs-attr">NODE_ENV</span>: <span class="hljs-string">'production'</span>
    }
  }],
  <span class="hljs-attr">deploy</span>: {
    <span class="hljs-attr">production</span>: {
      <span class="hljs-attr">user</span>: <span class="hljs-string">'deploy'</span>,
      <span class="hljs-attr">host</span>: <span class="hljs-string">'production-server'</span>,
      <span class="hljs-attr">ref</span>: <span class="hljs-string">'origin/main'</span>,
      <span class="hljs-attr">repo</span>: <span class="hljs-string">'git@github.com:user/repo.git'</span>,
      <span class="hljs-attr">path</span>: <span class="hljs-string">'/var/www/myapp'</span>,
      <span class="hljs-string">'post-deploy'</span>: <span class="hljs-string">'npm install &amp;&amp; pm2 reload ecosystem.config.js'</span>
    }
  }
}

<span class="hljs-comment">// éƒ¨ç½²</span>
pm2 deploy production

<span class="hljs-comment">// å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</span>
pm2 deploy production revert <span class="hljs-number">1</span>
</code></pre>
<p><strong>å›æ»šæ£€æŸ¥æ¸…å•ï¼š</strong></p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> ä»£ç å¯ä»¥å¿«é€Ÿå›æ»šï¼ˆä¿ç•™æ—§ç‰ˆæœ¬ï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æ•°æ®åº“è¿ç§»å¯é€†ï¼ˆæˆ–è€…åˆ†ä¸¤æ­¥éƒ¨ç½²ï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é…ç½®æ–‡ä»¶æœ‰å¤‡ä»½</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> é™æ€èµ„æºæœ‰ç‰ˆæœ¬æ§åˆ¶</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> æœ‰å›æ»šæ¼”ç»ƒï¼ˆå®šæœŸæµ‹è¯•å›æ»šæµç¨‹ï¼‰</li>
<li class="task-list-item"><input type="checkbox" disabled="disabled"/> å›æ»šæ—¶é—´ &lt; 5 åˆ†é’Ÿ</li>
</ul>
<hr/>
<h2 data-id="heading-7">é”™è¯¯ 3ï¼šæ•°æ®åº“è¿ç§»å’Œä»£ç éƒ¨ç½²ä¸€èµ·æ</h2>
<h3 data-id="heading-8">ç¾éš¾ç°åœº</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âŒ é”™è¯¯çš„åšæ³•ï¼šåŒæ—¶éƒ¨ç½²ä»£ç å’Œæ•°æ®åº“è¿ç§»</span>

<span class="hljs-comment"># deploy.sh</span>
git pull
npm install
npm run db:migrate  <span class="hljs-comment"># æ•°æ®åº“è¿ç§»</span>
pm2 restart app     <span class="hljs-comment"># é‡å¯åº”ç”¨</span>

<span class="hljs-comment"># ç»“æœï¼š</span>
<span class="hljs-comment"># 1. è¿ç§»è¿‡ç¨‹ä¸­ï¼Œæ—§ä»£ç è®¿é—®æ–°è¡¨ç»“æ„ â†’ æŠ¥é”™</span>
<span class="hljs-comment"># 2. è¿ç§»å¤±è´¥ï¼Œä½†ä»£ç å·²ç»éƒ¨ç½² â†’ ä¸å…¼å®¹</span>
<span class="hljs-comment"># 3. æƒ³å›æ»šï¼Œä½†æ•°æ®åº“å·²ç»æ”¹äº† â†’ æ•°æ®ä¸¢å¤±é£é™©</span>
</code></pre>
<p><strong>çœŸå®æ¡ˆä¾‹ï¼š</strong></p>
<p>æŸç¤¾äº¤å¹³å°åœ¨éƒ¨ç½²æ—¶ï¼ŒåŒæ—¶æ‰§è¡Œäº†"åˆ é™¤æ—§å­—æ®µ"çš„æ•°æ®åº“è¿ç§»å’Œ"ä½¿ç”¨æ–°å­—æ®µ"çš„ä»£ç éƒ¨ç½²ã€‚ç»“æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­ï¼Œéƒ¨åˆ†æœåŠ¡å™¨è¿˜åœ¨ä½¿ç”¨æ—§ä»£ç è®¿é—®å·²åˆ é™¤çš„å­—æ®µï¼Œå¯¼è‡´å¤§é‡æŠ¥é”™ã€‚</p>
<h3 data-id="heading-9">æ­£ç¡®å§¿åŠ¿ï¼šæ•°æ®åº“è¿ç§»åˆ†ä¸‰æ­¥èµ°</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âœ… æ­£ç¡®çš„åšæ³•ï¼šå‘åå…¼å®¹çš„æ•°æ®åº“è¿ç§»</span>

<span class="hljs-comment"># === ç¬¬ä¸€æ­¥ï¼šæ·»åŠ æ–°å­—æ®µï¼ˆä¸åˆ é™¤æ—§å­—æ®µï¼‰===</span>
<span class="hljs-comment"># è¿ç§»è„šæœ¬ 001_add_new_column.sql</span>
ALTER TABLE <span class="hljs-built_in">users</span> ADD COLUMN email_verified BOOLEAN DEFAULT FALSE;

<span class="hljs-comment"># éƒ¨ç½²è¿ç§»</span>
npm run db:migrate

<span class="hljs-comment"># æ­¤æ—¶ï¼šæ—§ä»£ç å’Œæ–°ä»£ç éƒ½èƒ½æ­£å¸¸è¿è¡Œ</span>

<span class="hljs-comment"># === ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²æ–°ä»£ç ï¼ˆåŒæ—¶æ”¯æŒæ–°æ—§å­—æ®µï¼‰===</span>
<span class="hljs-comment"># æ–°ä»£ç </span>
class User {
  async <span class="hljs-function"><span class="hljs-title">save</span></span>() {
    // åŒæ—¶å†™å…¥æ–°æ—§å­—æ®µ
    await db.query(`
      UPDATE <span class="hljs-built_in">users</span>
      SET
        email_verified = <span class="hljs-variable">$1</span>,
        is_verified = <span class="hljs-variable">$1</span>  -- æ—§å­—æ®µä¹Ÿæ›´æ–°
      WHERE <span class="hljs-built_in">id</span> = <span class="hljs-variable">$2</span>
    `, [this.emailVerified, this.id])
  }

  async <span class="hljs-function"><span class="hljs-title">load</span></span>() {
    // ä¼˜å…ˆè¯»å–æ–°å­—æ®µï¼Œfallback åˆ°æ—§å­—æ®µ
    const user = await db.query(<span class="hljs-string">'SELECT * FROM users WHERE id = $1'</span>, [this.id])
    this.emailVerified = user.email_verified ?? user.is_verified
  }
}

<span class="hljs-comment"># éƒ¨ç½²æ–°ä»£ç </span>
git pull
npm install
pm2 restart app

<span class="hljs-comment"># æ­¤æ—¶ï¼šæ–°æ—§ä»£ç éƒ½èƒ½æ­£å¸¸è¿è¡Œ</span>

<span class="hljs-comment"># === ç¬¬ä¸‰æ­¥ï¼šè§‚å¯Ÿä¸€æ®µæ—¶é—´åï¼Œåˆ é™¤æ—§å­—æ®µ ===</span>
<span class="hljs-comment"># ç­‰å¾… 1-2 å‘¨ï¼Œç¡®è®¤æ²¡é—®é¢˜å</span>
<span class="hljs-comment"># è¿ç§»è„šæœ¬ 002_remove_old_column.sql</span>
ALTER TABLE <span class="hljs-built_in">users</span> DROP COLUMN is_verified;

<span class="hljs-comment"># éƒ¨ç½²è¿ç§»</span>
npm run db:migrate
</code></pre>
<p><strong>æ•°æ®åº“è¿ç§»é»„é‡‘æ³•åˆ™ï¼š</strong></p>
<ol>
<li><strong>å‘åå…¼å®¹</strong>ï¼šæ–°è¿ç§»ä¸èƒ½ç ´åæ—§ä»£ç </li>
<li><strong>åˆ†æ­¥è¿›è¡Œ</strong>ï¼šæ·»åŠ  â†’ éƒ¨ç½²ä»£ç  â†’ åˆ é™¤</li>
<li><strong>å¯å›æ»š</strong>ï¼šæ¯ä¸ªè¿ç§»éƒ½è¦æœ‰å›æ»šè„šæœ¬</li>
<li><strong>å°æ­¥å¿«è·‘</strong>ï¼šä¸€æ¬¡è¿ç§»åªåšä¸€ä»¶äº‹</li>
</ol>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… ä½¿ç”¨è¿ç§»å·¥å…·ï¼ˆKnex.js ç¤ºä¾‹ï¼‰</span>
<span class="hljs-comment">// migrations/20250117_add_email_verified.js</span>
<span class="hljs-built_in">exports</span>.<span class="hljs-property">up</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">knex</span>) {
  <span class="hljs-keyword">return</span> knex.<span class="hljs-property">schema</span>.<span class="hljs-title function_">table</span>(<span class="hljs-string">'users'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">table</span>) {
    table.<span class="hljs-title function_">boolean</span>(<span class="hljs-string">'email_verified'</span>).<span class="hljs-title function_">defaultTo</span>(<span class="hljs-literal">false</span>)
  })
}

<span class="hljs-built_in">exports</span>.<span class="hljs-property">down</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">knex</span>) {
  <span class="hljs-keyword">return</span> knex.<span class="hljs-property">schema</span>.<span class="hljs-title function_">table</span>(<span class="hljs-string">'users'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">table</span>) {
    table.<span class="hljs-title function_">dropColumn</span>(<span class="hljs-string">'email_verified'</span>)
  })
}

<span class="hljs-comment">// æ‰§è¡Œè¿ç§»</span>
knex <span class="hljs-attr">migrate</span>:latest

<span class="hljs-comment">// å›æ»šè¿ç§»</span>
knex <span class="hljs-attr">migrate</span>:rollback
</code></pre>
<hr/>
<h2 data-id="heading-10">é”™è¯¯ 4ï¼šç¯å¢ƒå˜é‡ç®¡ç†æ··ä¹±</h2>
<h3 data-id="heading-11">ç¾éš¾ç°åœº</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ç¡¬ç¼–ç é…ç½®</span>
<span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">database</span>: {
    <span class="hljs-attr">host</span>: <span class="hljs-string">'localhost'</span>,
    <span class="hljs-attr">port</span>: <span class="hljs-number">5432</span>,
    <span class="hljs-attr">username</span>: <span class="hljs-string">'admin'</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">'admin123'</span>  <span class="hljs-comment">// å¯†ç å†™æ­»åœ¨ä»£ç é‡Œï¼</span>
  },
  <span class="hljs-attr">apiKey</span>: <span class="hljs-string">'sk-1234567890abcdef'</span>,  <span class="hljs-comment">// API å¯†é’¥ä¹Ÿå†™æ­»ï¼</span>
  <span class="hljs-attr">debug</span>: <span class="hljs-literal">true</span>  <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒè¿˜å¼€ç€ debugï¼</span>
}

<span class="hljs-comment">// æäº¤åˆ° Git</span>
git add config.<span class="hljs-property">js</span>
git commit -m <span class="hljs-string">"add config"</span>
git push

<span class="hljs-comment">// ç»“æœï¼š</span>
<span class="hljs-comment">// 1. å¯†ç æ³„éœ²åˆ° GitHub</span>
<span class="hljs-comment">// 2. æ‰€æœ‰ç¯å¢ƒç”¨åŒä¸€ä¸ªé…ç½®</span>
<span class="hljs-comment">// 3. æ”¹é…ç½®è¦é‡æ–°éƒ¨ç½²ä»£ç </span>
</code></pre>
<h3 data-id="heading-12">æ­£ç¡®å§¿åŠ¿ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡å’Œå¯†é’¥ç®¡ç†</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âœ… ä½¿ç”¨ .env æ–‡ä»¶ï¼ˆä¸æäº¤åˆ° Gitï¼‰</span>

<span class="hljs-comment"># .env.exampleï¼ˆæäº¤åˆ° Gitï¼Œä½œä¸ºæ¨¡æ¿ï¼‰</span>
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=your_username
DATABASE_PASSWORD=your_password
API_KEY=your_api_key
NODE_ENV=development

<span class="hljs-comment"># .envï¼ˆä¸æäº¤åˆ° Gitï¼ŒåŒ…å«çœŸå®å¯†é’¥ï¼‰</span>
DATABASE_HOST=prod-db.example.com
DATABASE_PORT=5432
DATABASE_USER=prod_user
DATABASE_PASSWORD=super_secret_password_123
API_KEY=sk-real-api-key-here
NODE_ENV=production

<span class="hljs-comment"># .gitignore</span>
.<span class="hljs-built_in">env</span>
.env.local
.<span class="hljs-built_in">env</span>.*.<span class="hljs-built_in">local</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… ä»£ç ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡</span>
<span class="hljs-built_in">require</span>(<span class="hljs-string">"dotenv"</span>).<span class="hljs-title function_">config</span>()

<span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">database</span>: {
    <span class="hljs-attr">host</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DATABASE_HOST</span>,
    <span class="hljs-attr">port</span>: <span class="hljs-built_in">parseInt</span>(process.<span class="hljs-property">env</span>.<span class="hljs-property">DATABASE_PORT</span>),
    <span class="hljs-attr">username</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DATABASE_USER</span>,
    <span class="hljs-attr">password</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">DATABASE_PASSWORD</span>,
  },
  <span class="hljs-attr">apiKey</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">API_KEY</span>,
  <span class="hljs-attr">debug</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> !== <span class="hljs-string">"production"</span>,
}

<span class="hljs-comment">// éªŒè¯å¿…éœ€çš„ç¯å¢ƒå˜é‡</span>
<span class="hljs-keyword">const</span> requiredEnvVars = [
  <span class="hljs-string">"DATABASE_HOST"</span>,
  <span class="hljs-string">"DATABASE_USER"</span>,
  <span class="hljs-string">"DATABASE_PASSWORD"</span>,
  <span class="hljs-string">"API_KEY"</span>,
]

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> envVar <span class="hljs-keyword">of</span> requiredEnvVars) {
  <span class="hljs-keyword">if</span> (!process.<span class="hljs-property">env</span>[envVar]) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Missing required environment variable: <span class="hljs-subst">${envVar}</span>`</span>)
  }
}
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âœ… Docker Compose ç®¡ç†ç¯å¢ƒå˜é‡</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">"3.8"</span>
<span class="hljs-attr">services:</span>
  <span class="hljs-attr">app:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">myapp:latest</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">NODE_ENV=production</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DATABASE_HOST=${DATABASE_HOST}</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">DATABASE_PASSWORD=${DATABASE_PASSWORD}</span>
    <span class="hljs-attr">env_file:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">.env.production</span>
    <span class="hljs-attr">secrets:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db_password</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">api_key</span>

<span class="hljs-attr">secrets:</span>
  <span class="hljs-attr">db_password:</span>
    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span>
  <span class="hljs-attr">api_key:</span>
    <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span>
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âœ… Kubernetes Secrets</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Secret</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">app-secrets</span>
<span class="hljs-attr">type:</span> <span class="hljs-string">Opaque</span>
<span class="hljs-attr">data:</span>
  <span class="hljs-attr">database-password:</span> <span class="hljs-string">c3VwZXJfc2VjcmV0X3Bhc3N3b3Jk</span> <span class="hljs-comment"># base64 ç¼–ç </span>
  <span class="hljs-attr">api-key:</span> <span class="hljs-string">c2stcmVhbC1hcGkta2V5LWhlcmU=</span>

<span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
          <span class="hljs-attr">image:</span> <span class="hljs-string">myapp:latest</span>
          <span class="hljs-attr">env:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">DATABASE_PASSWORD</span>
              <span class="hljs-attr">valueFrom:</span>
                <span class="hljs-attr">secretKeyRef:</span>
                  <span class="hljs-attr">name:</span> <span class="hljs-string">app-secrets</span>
                  <span class="hljs-attr">key:</span> <span class="hljs-string">database-password</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">API_KEY</span>
              <span class="hljs-attr">valueFrom:</span>
                <span class="hljs-attr">secretKeyRef:</span>
                  <span class="hljs-attr">name:</span> <span class="hljs-string">app-secrets</span>
                  <span class="hljs-attr">key:</span> <span class="hljs-string">api-key</span>
</code></pre>
<p><strong>ç¯å¢ƒå˜é‡ç®¡ç†æœ€ä½³å®è·µï¼š</strong></p>
<ol>
<li><strong>æ°¸è¿œä¸è¦æäº¤å¯†é’¥åˆ° Git</strong></li>
<li><strong>ä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡</strong>ï¼ˆAWS Secrets Managerã€HashiCorp Vaultï¼‰</li>
<li><strong>ä¸åŒç¯å¢ƒä½¿ç”¨ä¸åŒçš„å¯†é’¥</strong></li>
<li><strong>å®šæœŸè½®æ¢å¯†é’¥</strong></li>
<li><strong>æœ€å°æƒé™åŸåˆ™</strong>ï¼ˆæ¯ä¸ªæœåŠ¡åªèƒ½è®¿é—®å®ƒéœ€è¦çš„å¯†é’¥ï¼‰</li>
</ol>
<hr/>
<h2 data-id="heading-13">é”™è¯¯ 5ï¼šæ²¡æœ‰å¥åº·æ£€æŸ¥ï¼Œéƒ¨ç½²å®Œå°±ä¸ç®¡äº†</h2>
<h3 data-id="heading-14">ç¾éš¾ç°åœº</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âŒ ç®€å•ç²—æš´çš„éƒ¨ç½²è„šæœ¬</span>
<span class="hljs-comment">#!/bin/bash</span>
git pull
npm install
pm2 restart app

<span class="hljs-built_in">echo</span> <span class="hljs-string">"éƒ¨ç½²å®Œæˆï¼"</span>
<span class="hljs-comment"># ç„¶åå°±ä¸ç®¡äº†...</span>

<span class="hljs-comment"># å®é™…æƒ…å†µï¼š</span>
<span class="hljs-comment"># - åº”ç”¨å¯åŠ¨å¤±è´¥äº†ï¼Œä½† pm2 æ˜¾ç¤º "online"</span>
<span class="hljs-comment"># - æ•°æ®åº“è¿æ¥ä¸ä¸Šï¼Œä½†æ²¡äººçŸ¥é“</span>
<span class="hljs-comment"># - å†…å­˜æ³„æ¼ï¼Œ1 å°æ—¶åæœåŠ¡æŒ‚äº†</span>
<span class="hljs-comment"># - ç”¨æˆ·ç–¯ç‹‚æŠ•è¯‰ï¼Œä½†ç›‘æ§æ²¡æŠ¥è­¦</span>
</code></pre>
<h3 data-id="heading-15">æ­£ç¡®å§¿åŠ¿ï¼šå®Œå–„çš„å¥åº·æ£€æŸ¥å’Œç›‘æ§</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… å®ç°å¥åº·æ£€æŸ¥ç«¯ç‚¹</span>
<span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">"express"</span>)
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()

<span class="hljs-comment">// ç®€å•çš„å¥åº·æ£€æŸ¥</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/health"</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">status</span>: <span class="hljs-string">"ok"</span> })
})

<span class="hljs-comment">// è¯¦ç»†çš„å¥åº·æ£€æŸ¥</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/health/detailed"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">const</span> health = {
    <span class="hljs-attr">status</span>: <span class="hljs-string">"ok"</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
    <span class="hljs-attr">uptime</span>: process.<span class="hljs-title function_">uptime</span>(),
    <span class="hljs-attr">checks</span>: {},
  }

  <span class="hljs-comment">// æ£€æŸ¥æ•°æ®åº“è¿æ¥</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> db.<span class="hljs-title function_">query</span>(<span class="hljs-string">"SELECT 1"</span>)
    health.<span class="hljs-property">checks</span>.<span class="hljs-property">database</span> = { <span class="hljs-attr">status</span>: <span class="hljs-string">"ok"</span> }
  } <span class="hljs-keyword">catch</span> (error) {
    health.<span class="hljs-property">checks</span>.<span class="hljs-property">database</span> = {
      <span class="hljs-attr">status</span>: <span class="hljs-string">"error"</span>,
      <span class="hljs-attr">message</span>: error.<span class="hljs-property">message</span>,
    }
    health.<span class="hljs-property">status</span> = <span class="hljs-string">"error"</span>
  }

  <span class="hljs-comment">// æ£€æŸ¥ Redis è¿æ¥</span>
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> redis.<span class="hljs-title function_">ping</span>()
    health.<span class="hljs-property">checks</span>.<span class="hljs-property">redis</span> = { <span class="hljs-attr">status</span>: <span class="hljs-string">"ok"</span> }
  } <span class="hljs-keyword">catch</span> (error) {
    health.<span class="hljs-property">checks</span>.<span class="hljs-property">redis</span> = {
      <span class="hljs-attr">status</span>: <span class="hljs-string">"error"</span>,
      <span class="hljs-attr">message</span>: error.<span class="hljs-property">message</span>,
    }
    health.<span class="hljs-property">status</span> = <span class="hljs-string">"error"</span>
  }

  <span class="hljs-comment">// æ£€æŸ¥ç£ç›˜ç©ºé—´</span>
  <span class="hljs-keyword">const</span> diskUsage = <span class="hljs-keyword">await</span> <span class="hljs-title function_">checkDiskUsage</span>()
  <span class="hljs-keyword">if</span> (diskUsage &gt; <span class="hljs-number">90</span>) {
    health.<span class="hljs-property">checks</span>.<span class="hljs-property">disk</span> = {
      <span class="hljs-attr">status</span>: <span class="hljs-string">"warning"</span>,
      <span class="hljs-attr">usage</span>: <span class="hljs-string">`<span class="hljs-subst">${diskUsage}</span>%`</span>,
    }
    health.<span class="hljs-property">status</span> = <span class="hljs-string">"warning"</span>
  } <span class="hljs-keyword">else</span> {
    health.<span class="hljs-property">checks</span>.<span class="hljs-property">disk</span> = {
      <span class="hljs-attr">status</span>: <span class="hljs-string">"ok"</span>,
      <span class="hljs-attr">usage</span>: <span class="hljs-string">`<span class="hljs-subst">${diskUsage}</span>%`</span>,
    }
  }

  <span class="hljs-comment">// æ£€æŸ¥å†…å­˜ä½¿ç”¨</span>
  <span class="hljs-keyword">const</span> memUsage = process.<span class="hljs-title function_">memoryUsage</span>()
  health.<span class="hljs-property">checks</span>.<span class="hljs-property">memory</span> = {
    <span class="hljs-attr">status</span>: <span class="hljs-string">"ok"</span>,
    <span class="hljs-attr">heapUsed</span>: <span class="hljs-string">`<span class="hljs-subst">${(memUsage.heapUsed / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>).toFixed(<span class="hljs-number">2</span>)}</span> MB`</span>,
    <span class="hljs-attr">heapTotal</span>: <span class="hljs-string">`<span class="hljs-subst">${(memUsage.heapTotal / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>).toFixed(<span class="hljs-number">2</span>)}</span> MB`</span>,
  }

  <span class="hljs-keyword">const</span> statusCode = health.<span class="hljs-property">status</span> === <span class="hljs-string">"ok"</span> ? <span class="hljs-number">200</span> : <span class="hljs-number">503</span>
  res.<span class="hljs-title function_">status</span>(statusCode).<span class="hljs-title function_">json</span>(health)
})

<span class="hljs-comment">// å°±ç»ªæ£€æŸ¥ï¼ˆReadiness Probeï¼‰</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/ready"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-comment">// æ£€æŸ¥åº”ç”¨æ˜¯å¦å‡†å¤‡å¥½æ¥æ”¶æµé‡</span>
  <span class="hljs-keyword">const</span> isReady = <span class="hljs-keyword">await</span> <span class="hljs-title function_">checkIfReady</span>()
  <span class="hljs-keyword">if</span> (isReady) {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">ready</span>: <span class="hljs-literal">true</span> })
  } <span class="hljs-keyword">else</span> {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">503</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">ready</span>: <span class="hljs-literal">false</span> })
  }
})

<span class="hljs-comment">// å­˜æ´»æ£€æŸ¥ï¼ˆLiveness Probeï¼‰</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/alive"</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-comment">// ç®€å•æ£€æŸ¥è¿›ç¨‹æ˜¯å¦è¿˜æ´»ç€</span>
  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">json</span>({ <span class="hljs-attr">alive</span>: <span class="hljs-literal">true</span> })
})
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âœ… Kubernetes å¥åº·æ£€æŸ¥é…ç½®</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
          <span class="hljs-attr">image:</span> <span class="hljs-string">myapp:latest</span>
          <span class="hljs-attr">ports:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-attr">containerPort:</span> <span class="hljs-number">3000</span>

          <span class="hljs-comment"># å­˜æ´»æ¢é’ˆï¼šæ£€æŸ¥å®¹å™¨æ˜¯å¦è¿˜æ´»ç€</span>
          <span class="hljs-attr">livenessProbe:</span>
            <span class="hljs-attr">httpGet:</span>
              <span class="hljs-attr">path:</span> <span class="hljs-string">/alive</span>
              <span class="hljs-attr">port:</span> <span class="hljs-number">3000</span>
            <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">30</span> <span class="hljs-comment"># å¯åŠ¨å 30 ç§’å¼€å§‹æ£€æŸ¥</span>
            <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">10</span> <span class="hljs-comment"># æ¯ 10 ç§’æ£€æŸ¥ä¸€æ¬¡</span>
            <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">5</span> <span class="hljs-comment"># è¶…æ—¶æ—¶é—´ 5 ç§’</span>
            <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">3</span> <span class="hljs-comment"># å¤±è´¥ 3 æ¬¡åé‡å¯å®¹å™¨</span>

          <span class="hljs-comment"># å°±ç»ªæ¢é’ˆï¼šæ£€æŸ¥å®¹å™¨æ˜¯å¦å‡†å¤‡å¥½æ¥æ”¶æµé‡</span>
          <span class="hljs-attr">readinessProbe:</span>
            <span class="hljs-attr">httpGet:</span>
              <span class="hljs-attr">path:</span> <span class="hljs-string">/ready</span>
              <span class="hljs-attr">port:</span> <span class="hljs-number">3000</span>
            <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">10</span>
            <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">5</span>
            <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">3</span>
            <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">3</span>

          <span class="hljs-comment"># å¯åŠ¨æ¢é’ˆï¼šæ£€æŸ¥å®¹å™¨æ˜¯å¦å¯åŠ¨æˆåŠŸ</span>
          <span class="hljs-attr">startupProbe:</span>
            <span class="hljs-attr">httpGet:</span>
              <span class="hljs-attr">path:</span> <span class="hljs-string">/health</span>
              <span class="hljs-attr">port:</span> <span class="hljs-number">3000</span>
            <span class="hljs-attr">initialDelaySeconds:</span> <span class="hljs-number">0</span>
            <span class="hljs-attr">periodSeconds:</span> <span class="hljs-number">5</span>
            <span class="hljs-attr">timeoutSeconds:</span> <span class="hljs-number">3</span>
            <span class="hljs-attr">failureThreshold:</span> <span class="hljs-number">30</span> <span class="hljs-comment"># æœ€å¤šç­‰å¾… 150 ç§’ï¼ˆ30 * 5ï¼‰</span>
</code></pre>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âœ… éƒ¨ç½²åè‡ªåŠ¨éªŒè¯è„šæœ¬</span>
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"å¼€å§‹éƒ¨ç½²..."</span>

<span class="hljs-comment"># 1. éƒ¨ç½²æ–°ç‰ˆæœ¬</span>
kubectl apply -f deployment.yaml

<span class="hljs-comment"># 2. ç­‰å¾…éƒ¨ç½²å®Œæˆ</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ç­‰å¾…éƒ¨ç½²å®Œæˆ..."</span>
kubectl rollout status deployment/myapp --<span class="hljs-built_in">timeout</span>=5m

<span class="hljs-comment"># 3. æ£€æŸ¥å¥åº·çŠ¶æ€</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æ£€æŸ¥å¥åº·çŠ¶æ€..."</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> {1..30}; <span class="hljs-keyword">do</span>
  HTTP_CODE=$(curl -s -o /dev/null -w <span class="hljs-string">"%{http_code}"</span> http://myapp.example.com/health)

  <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$HTTP_CODE</span>"</span> == <span class="hljs-string">"200"</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… å¥åº·æ£€æŸ¥é€šè¿‡"</span>
    <span class="hljs-built_in">break</span>
  <span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"â³ ç­‰å¾…æœåŠ¡å°±ç»ª... (<span class="hljs-variable">$i</span>/30)"</span>
    <span class="hljs-built_in">sleep</span> 10
  <span class="hljs-keyword">fi</span>

  <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$i</span> -eq 30 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"âŒ å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œå¼€å§‹å›æ»š"</span>
    kubectl rollout undo deployment/myapp
    <span class="hljs-built_in">exit</span> 1
  <span class="hljs-keyword">fi</span>
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># 4. å†’çƒŸæµ‹è¯•</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"æ‰§è¡Œå†’çƒŸæµ‹è¯•..."</span>
SMOKE_TEST_RESULT=$(curl -s http://myapp.example.com/api/test)

<span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$SMOKE_TEST_RESULT</span> == *<span class="hljs-string">"success"</span>* ]]; <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"âœ… å†’çƒŸæµ‹è¯•é€šè¿‡"</span>
<span class="hljs-keyword">else</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"âŒ å†’çƒŸæµ‹è¯•å¤±è´¥ï¼Œå¼€å§‹å›æ»š"</span>
  kubectl rollout undo deployment/myapp
  <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># 5. ç›‘æ§å…³é”®æŒ‡æ ‡</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"ç›‘æ§å…³é”®æŒ‡æ ‡ 5 åˆ†é’Ÿ..."</span>
<span class="hljs-built_in">sleep</span> 300

ERROR_RATE=$(curl -s <span class="hljs-string">"http://prometheus.example.com/api/v1/query?query=rate(http_requests_total{status=~'5..'}[5m])"</span>)

<span class="hljs-keyword">if</span> (( $(echo "<span class="hljs-variable">$ERROR_RATE</span> &gt; <span class="hljs-number">0.01</span>" | bc -l) )); <span class="hljs-keyword">then</span>
  <span class="hljs-built_in">echo</span> <span class="hljs-string">"âŒ é”™è¯¯ç‡è¿‡é«˜ï¼Œå¼€å§‹å›æ»š"</span>
  kubectl rollout undo deployment/myapp
  <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>

<span class="hljs-built_in">echo</span> <span class="hljs-string">"ğŸ‰ éƒ¨ç½²æˆåŠŸï¼"</span>
</code></pre>
<hr/>
<h2 data-id="heading-16">é”™è¯¯ 6ï¼šå‘¨äº”ä¸‹åˆéƒ¨ç½²ï¼Œå‘¨æœ«èƒŒé”…</h2>
<h3 data-id="heading-17">ç¾éš¾ç°åœº</h3>
<pre><code class="hljs language-swift" lang="swift">å‘¨äº”ä¸‹åˆ <span class="hljs-number">5</span>:<span class="hljs-number">30</span>
å¼€å‘ï¼šå°±ä¸€ä¸ªå°æ”¹åŠ¨ï¼Œéƒ¨ç½²ä¸€ä¸‹å§
è¿ç»´ï¼šè¡Œå§ï¼Œåæ­£é©¬ä¸Šä¸‹ç­äº†

å‘¨äº”æ™šä¸Š <span class="hljs-number">8</span>:<span class="hljs-number">00</span>
ç”¨æˆ·ï¼šç½‘ç«™æ€ä¹ˆæ‰“ä¸å¼€äº†ï¼Ÿ

å‘¨äº”æ™šä¸Š <span class="hljs-number">8</span>:<span class="hljs-number">30</span>
è€æ¿ï¼š<span class="hljs-meta">@å…¨ä½“æˆå‘˜</span> ç´§æ€¥ä¼šè®®

å‘¨å…­å‡Œæ™¨ <span class="hljs-number">3</span>:<span class="hljs-number">00</span>
å›¢é˜Ÿï¼šç»ˆäºä¿®å¥½äº†<span class="hljs-operator">...</span>

å‘¨ä¸€æ—©ä¸Š
è€æ¿ï¼šä»¥åå‘¨äº”ä¸å‡†éƒ¨ç½²ï¼
</code></pre>
<p><strong>çœŸå®æ•°æ®ï¼š</strong></p>
<ul>
<li>70% çš„ç”Ÿäº§äº‹æ•…å‘ç”Ÿåœ¨å‘¨äº”ä¸‹åˆåˆ°å‘¨æ—¥</li>
<li>å‘¨äº”éƒ¨ç½²çš„å›æ»šç‡æ˜¯å¹³æ—¶çš„ 3 å€</li>
<li>å‘¨æœ«ä¿®å¤é—®é¢˜çš„å¹³å‡æ—¶é—´æ˜¯å·¥ä½œæ—¥çš„ 2 å€</li>
</ul>
<h3 data-id="heading-18">æ­£ç¡®å§¿åŠ¿ï¼šåˆ¶å®šéƒ¨ç½²æ—¶é—´çª—å£</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âœ… éƒ¨ç½²æ—¶é—´è§„åˆ™</span>

<span class="hljs-string">å…è®¸éƒ¨ç½²çš„æ—¶é—´ï¼š</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">å‘¨ä¸€åˆ°å‘¨å››ï¼š10:00</span> <span class="hljs-bullet">-</span> <span class="hljs-number">16</span><span class="hljs-string">:00</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">å‘¨äº”ï¼š10:00</span> <span class="hljs-bullet">-</span> <span class="hljs-number">14</span><span class="hljs-string">:00ï¼ˆç•™å‡ºæ—¶é—´è§‚å¯Ÿï¼‰</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">å‘¨æœ«å’ŒèŠ‚å‡æ—¥ï¼šç¦æ­¢éƒ¨ç½²ï¼ˆé™¤éç´§æ€¥æƒ…å†µï¼‰</span>

<span class="hljs-string">ç¦æ­¢éƒ¨ç½²çš„æ—¶é—´ï¼š</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">ä¸šåŠ¡é«˜å³°æœŸï¼ˆå¦‚ç”µå•†çš„æ™šä¸Š</span> <span class="hljs-number">8</span><span class="hljs-number">-10</span> <span class="hljs-string">ç‚¹ï¼‰</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">é‡å¤§æ´»åŠ¨å‰åï¼ˆå¦‚åŒåä¸€ã€æ˜¥èŠ‚ï¼‰</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">ä¸‹ç­å‰</span> <span class="hljs-number">2</span> <span class="hljs-string">å°æ—¶</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">å‘¨äº”ä¸‹åˆ</span>

<span class="hljs-string">ç´§æ€¥éƒ¨ç½²æµç¨‹ï¼š</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">éœ€è¦æŠ€æœ¯è´Ÿè´£äººæ‰¹å‡†</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">éœ€è¦å®Œæ•´çš„å›æ»šæ–¹æ¡ˆ</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">éœ€è¦ç›¸å…³äººå‘˜å¾…å‘½</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">éœ€è¦è¯¦ç»†çš„é£é™©è¯„ä¼°</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… è‡ªåŠ¨æ£€æŸ¥éƒ¨ç½²æ—¶é—´</span>
<span class="hljs-comment">// deploy-time-check.js</span>
<span class="hljs-keyword">const</span> moment = <span class="hljs-built_in">require</span>(<span class="hljs-string">"moment"</span>)

<span class="hljs-keyword">function</span> <span class="hljs-title function_">canDeploy</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> now = <span class="hljs-title function_">moment</span>()
  <span class="hljs-keyword">const</span> hour = now.<span class="hljs-title function_">hour</span>()
  <span class="hljs-keyword">const</span> day = now.<span class="hljs-title function_">day</span>() <span class="hljs-comment">// 0 = å‘¨æ—¥, 6 = å‘¨å…­</span>

  <span class="hljs-comment">// å‘¨æœ«ç¦æ­¢éƒ¨ç½²</span>
  <span class="hljs-keyword">if</span> (day === <span class="hljs-number">0</span> || day === <span class="hljs-number">6</span>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">allowed</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">reason</span>: <span class="hljs-string">"å‘¨æœ«ç¦æ­¢éƒ¨ç½²"</span>,
    }
  }

  <span class="hljs-comment">// å‘¨äº”ä¸‹åˆ 2 ç‚¹åç¦æ­¢éƒ¨ç½²</span>
  <span class="hljs-keyword">if</span> (day === <span class="hljs-number">5</span> &amp;&amp; hour &gt;= <span class="hljs-number">14</span>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">allowed</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">reason</span>: <span class="hljs-string">"å‘¨äº”ä¸‹åˆ 2 ç‚¹åç¦æ­¢éƒ¨ç½²"</span>,
    }
  }

  <span class="hljs-comment">// å·¥ä½œæ—¥åªå…è®¸ 10:00 - 16:00 éƒ¨ç½²</span>
  <span class="hljs-keyword">if</span> (hour &lt; <span class="hljs-number">10</span> || hour &gt;= <span class="hljs-number">16</span>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">allowed</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">reason</span>: <span class="hljs-string">"åªå…è®¸åœ¨ 10:00 - 16:00 éƒ¨ç½²"</span>,
    }
  }

  <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦åœ¨ä¸šåŠ¡é«˜å³°æœŸ</span>
  <span class="hljs-keyword">if</span> (hour &gt;= <span class="hljs-number">20</span> &amp;&amp; hour &lt;= <span class="hljs-number">22</span>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">allowed</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">reason</span>: <span class="hljs-string">"ä¸šåŠ¡é«˜å³°æœŸç¦æ­¢éƒ¨ç½²"</span>,
    }
  }

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">allowed</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">reason</span>: <span class="hljs-string">"å¯ä»¥éƒ¨ç½²"</span>,
  }
}

<span class="hljs-comment">// åœ¨ CI/CD æµç¨‹ä¸­ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> deployCheck = <span class="hljs-title function_">canDeploy</span>()
<span class="hljs-keyword">if</span> (!deployCheck.<span class="hljs-property">allowed</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`âŒ éƒ¨ç½²è¢«é˜»æ­¢: <span class="hljs-subst">${deployCheck.reason}</span>`</span>)
  process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>)
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… <span class="hljs-subst">${deployCheck.reason}</span>`</span>)
</code></pre>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âœ… GitHub Actions éƒ¨ç½²æ—¶é—´é™åˆ¶</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Production</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> [<span class="hljs-string">main</span>]

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">check-deploy-time:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Check</span> <span class="hljs-string">if</span> <span class="hljs-string">deployment</span> <span class="hljs-string">is</span> <span class="hljs-string">allowed</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          HOUR=$(date +%H)
          DAY=$(date +%u)  # 1-7 (å‘¨ä¸€åˆ°å‘¨æ—¥)
</span>
          <span class="hljs-comment"># å‘¨æœ«ç¦æ­¢éƒ¨ç½²</span>
          <span class="hljs-string">if</span> [ <span class="hljs-string">$DAY</span> <span class="hljs-string">-eq</span> <span class="hljs-number">6</span> ] <span class="hljs-string">||</span> [ <span class="hljs-string">$DAY</span> <span class="hljs-string">-eq</span> <span class="hljs-number">7</span> ]<span class="hljs-string">;</span> <span class="hljs-string">then</span>
            <span class="hljs-string">echo</span> <span class="hljs-string">"âŒ å‘¨æœ«ç¦æ­¢éƒ¨ç½²"</span>
            <span class="hljs-string">exit</span> <span class="hljs-number">1</span>
          <span class="hljs-string">fi</span>

          <span class="hljs-comment"># å‘¨äº”ä¸‹åˆ 2 ç‚¹åç¦æ­¢éƒ¨ç½²</span>
          <span class="hljs-string">if</span> [ <span class="hljs-string">$DAY</span> <span class="hljs-string">-eq</span> <span class="hljs-number">5</span> ] <span class="hljs-string">&amp;&amp;</span> [ <span class="hljs-string">$HOUR</span> <span class="hljs-string">-ge</span> <span class="hljs-number">14</span> ]<span class="hljs-string">;</span> <span class="hljs-string">then</span>
            <span class="hljs-string">echo</span> <span class="hljs-string">"âŒ å‘¨äº”ä¸‹åˆ 2 ç‚¹åç¦æ­¢éƒ¨ç½²"</span>
            <span class="hljs-string">exit</span> <span class="hljs-number">1</span>
          <span class="hljs-string">fi</span>

          <span class="hljs-comment"># åªå…è®¸ 10:00 - 16:00 éƒ¨ç½²</span>
          <span class="hljs-string">if</span> [ <span class="hljs-string">$HOUR</span> <span class="hljs-string">-lt</span> <span class="hljs-number">10</span> ] <span class="hljs-string">||</span> [ <span class="hljs-string">$HOUR</span> <span class="hljs-string">-ge</span> <span class="hljs-number">16</span> ]<span class="hljs-string">;</span> <span class="hljs-string">then</span>
            <span class="hljs-string">echo</span> <span class="hljs-string">"âŒ åªå…è®¸åœ¨ 10:00 - 16:00 éƒ¨ç½²"</span>
            <span class="hljs-string">exit</span> <span class="hljs-number">1</span>
          <span class="hljs-string">fi</span>

          <span class="hljs-string">echo</span> <span class="hljs-string">"âœ… å¯ä»¥éƒ¨ç½²"</span>

  <span class="hljs-attr">deploy:</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">check-deploy-time</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          # éƒ¨ç½²é€»è¾‘...
</span></code></pre>
<hr/>
<h2 data-id="heading-19">é”™è¯¯ 7ï¼šæ²¡æœ‰ç°åº¦å‘å¸ƒï¼Œä¸€ä¸Šçº¿å°±å…¨é‡</h2>
<h3 data-id="heading-20">ç¾éš¾ç°åœº</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># âŒ ç›´æ¥å…¨é‡éƒ¨ç½²</span>
kubectl <span class="hljs-built_in">set</span> image deployment/myapp myapp=myapp:v2.0.0

<span class="hljs-comment"># ç»“æœï¼š</span>
<span class="hljs-comment"># - æ–°ç‰ˆæœ¬æœ‰ bugï¼Œå½±å“æ‰€æœ‰ç”¨æˆ·</span>
<span class="hljs-comment"># - å‘ç°é—®é¢˜æ—¶å·²ç»æ¥ä¸åŠäº†</span>
<span class="hljs-comment"># - å›æ»šéœ€è¦æ—¶é—´ï¼ŒæŸå¤±å·²ç»é€ æˆ</span>
</code></pre>
<p><strong>çœŸå®æ¡ˆä¾‹ï¼š</strong></p>
<p>æŸè§†é¢‘ç½‘ç«™ç›´æ¥å…¨é‡éƒ¨ç½²æ–°ç‰ˆæœ¬ï¼Œç»“æœæ–°ç‰ˆæœ¬çš„è§†é¢‘æ’­æ”¾å™¨åœ¨æŸäº›æµè§ˆå™¨ä¸Šæ— æ³•æ­£å¸¸å·¥ä½œã€‚ç­‰å‘ç°é—®é¢˜æ—¶ï¼Œå·²ç»æœ‰æ•°ç™¾ä¸‡ç”¨æˆ·å—å½±å“ï¼ŒæŠ•è¯‰ç”µè¯æ‰“çˆ†äº†å®¢æœã€‚</p>
<h3 data-id="heading-21">æ­£ç¡®å§¿åŠ¿ï¼šç°åº¦å‘å¸ƒï¼ˆé‡‘ä¸é›€éƒ¨ç½²ï¼‰</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âœ… Kubernetes é‡‘ä¸é›€éƒ¨ç½²</span>

<span class="hljs-comment"># 1. ä¿ç•™æ—§ç‰ˆæœ¬ï¼ˆ90% æµé‡ï¼‰</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">myapp-stable</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">9</span> <span class="hljs-comment"># 90% çš„ Pod</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">myapp</span>
        <span class="hljs-attr">version:</span> <span class="hljs-string">v1.0.0</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
          <span class="hljs-attr">image:</span> <span class="hljs-string">myapp:v1.0.0</span>

<span class="hljs-meta">---</span>
<span class="hljs-comment"># 2. éƒ¨ç½²æ–°ç‰ˆæœ¬ï¼ˆ10% æµé‡ï¼‰</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">apps/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Deployment</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">myapp-canary</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># 10% çš„ Pod</span>
  <span class="hljs-attr">template:</span>
    <span class="hljs-attr">metadata:</span>
      <span class="hljs-attr">labels:</span>
        <span class="hljs-attr">app:</span> <span class="hljs-string">myapp</span>
        <span class="hljs-attr">version:</span> <span class="hljs-string">v2.0.0</span>
    <span class="hljs-attr">spec:</span>
      <span class="hljs-attr">containers:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
          <span class="hljs-attr">image:</span> <span class="hljs-string">myapp:v2.0.0</span>

<span class="hljs-meta">---</span>
<span class="hljs-comment"># 3. Service åŒæ—¶æŒ‡å‘ä¸¤ä¸ªç‰ˆæœ¬</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Service</span>
<span class="hljs-attr">metadata:</span>
  <span class="hljs-attr">name:</span> <span class="hljs-string">myapp</span>
<span class="hljs-attr">spec:</span>
  <span class="hljs-attr">selector:</span>
    <span class="hljs-attr">app:</span> <span class="hljs-string">myapp</span> <span class="hljs-comment"># ä¸åŒºåˆ†ç‰ˆæœ¬ï¼Œæµé‡è‡ªåŠ¨åˆ†é…</span>
  <span class="hljs-attr">ports:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-attr">port:</span> <span class="hljs-number">80</span>
      <span class="hljs-attr">targetPort:</span> <span class="hljs-number">3000</span>
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… ä½¿ç”¨ Nginx å®ç°ç°åº¦å‘å¸ƒ</span>
<span class="hljs-comment">// nginx.conf</span>
upstream backend_stable {
    server stable-<span class="hljs-number">1.</span>example.<span class="hljs-property">com</span>:<span class="hljs-number">3000</span>;
    server stable-<span class="hljs-number">2.</span>example.<span class="hljs-property">com</span>:<span class="hljs-number">3000</span>;
    server stable-<span class="hljs-number">3.</span>example.<span class="hljs-property">com</span>:<span class="hljs-number">3000</span>;
}

upstream backend_canary {
    server canary-<span class="hljs-number">1.</span>example.<span class="hljs-property">com</span>:<span class="hljs-number">3000</span>;
}

server {
    listen <span class="hljs-number">80</span>;

    location / {
        # <span class="hljs-number">10</span>% æµé‡åˆ°é‡‘ä¸é›€ç‰ˆæœ¬
        <span class="hljs-keyword">if</span> ($request_id ~* <span class="hljs-string">"^[0-9a-f]$"</span>) {
            proxy_pass <span class="hljs-attr">http</span>:<span class="hljs-comment">//backend_canary;</span>
            <span class="hljs-keyword">break</span>;
        }

        # <span class="hljs-number">90</span>% æµé‡åˆ°ç¨³å®šç‰ˆæœ¬
        proxy_pass <span class="hljs-attr">http</span>:<span class="hljs-comment">//backend_stable;</span>
    }
}
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… åŸºäºç”¨æˆ·çš„ç°åº¦å‘å¸ƒ</span>
<span class="hljs-comment">// feature-flag.js</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FeatureFlag</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canaryUsers</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([
      <span class="hljs-string">"user123"</span>, <span class="hljs-comment">// å†…éƒ¨æµ‹è¯•ç”¨æˆ·</span>
      <span class="hljs-string">"user456"</span>,
      <span class="hljs-comment">// ...</span>
    ])
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canaryPercentage</span> = <span class="hljs-number">10</span> <span class="hljs-comment">// 10% çš„ç”¨æˆ·</span>
  }

  <span class="hljs-title function_">shouldUseCanary</span>(<span class="hljs-params">userId</span>) {
    <span class="hljs-comment">// 1. ç™½åå•ç”¨æˆ·å§‹ç»ˆä½¿ç”¨é‡‘ä¸é›€ç‰ˆæœ¬</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">canaryUsers</span>.<span class="hljs-title function_">has</span>(userId)) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }

    <span class="hljs-comment">// 2. æ ¹æ®ç”¨æˆ· ID å“ˆå¸Œå†³å®š</span>
    <span class="hljs-keyword">const</span> hash = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">hashUserId</span>(userId)
    <span class="hljs-keyword">return</span> hash % <span class="hljs-number">100</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">canaryPercentage</span>
  }

  <span class="hljs-title function_">hashUserId</span>(<span class="hljs-params">userId</span>) {
    <span class="hljs-keyword">let</span> hash = <span class="hljs-number">0</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; userId.<span class="hljs-property">length</span>; i++) {
      hash = (hash &lt;&lt; <span class="hljs-number">5</span>) - hash + userId.<span class="hljs-title function_">charCodeAt</span>(i)
      hash = hash &amp; hash
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">abs</span>(hash)
  }
}

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> featureFlag = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FeatureFlag</span>()

app.<span class="hljs-title function_">get</span>(<span class="hljs-string">"/api/data"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">const</span> userId = req.<span class="hljs-property">user</span>.<span class="hljs-property">id</span>

  <span class="hljs-keyword">if</span> (featureFlag.<span class="hljs-title function_">shouldUseCanary</span>(userId)) {
    <span class="hljs-comment">// ä½¿ç”¨æ–°ç‰ˆæœ¬é€»è¾‘</span>
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">getDataV2</span>())
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// ä½¿ç”¨æ—§ç‰ˆæœ¬é€»è¾‘</span>
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>(<span class="hljs-keyword">await</span> <span class="hljs-title function_">getDataV1</span>())
  }
})
</code></pre>
<p><strong>ç°åº¦å‘å¸ƒæµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span> éƒ¨ç½²é‡‘ä¸é›€ç‰ˆæœ¬ï¼ˆ5% æµé‡ï¼‰
   â†“
<span class="hljs-bullet">2.</span> è§‚å¯Ÿ 30 åˆ†é’Ÿ
<span class="hljs-bullet">   -</span> é”™è¯¯ç‡æ­£å¸¸ï¼Ÿ
<span class="hljs-bullet">   -</span> å“åº”æ—¶é—´æ­£å¸¸ï¼Ÿ
<span class="hljs-bullet">   -</span> ç”¨æˆ·æŠ•è¯‰ï¼Ÿ
   â†“
<span class="hljs-bullet">3.</span> å¦‚æœæ­£å¸¸ï¼Œæ‰©å¤§åˆ° 25% æµé‡
   â†“
<span class="hljs-bullet">4.</span> è§‚å¯Ÿ 1 å°æ—¶
   â†“
<span class="hljs-bullet">5.</span> å¦‚æœæ­£å¸¸ï¼Œæ‰©å¤§åˆ° 50% æµé‡
   â†“
<span class="hljs-bullet">6.</span> è§‚å¯Ÿ 2 å°æ—¶
   â†“
<span class="hljs-bullet">7.</span> å¦‚æœæ­£å¸¸ï¼Œå…¨é‡å‘å¸ƒ
   â†“
<span class="hljs-bullet">8.</span> è§‚å¯Ÿ 24 å°æ—¶åï¼Œä¸‹çº¿æ—§ç‰ˆæœ¬
</code></pre>
<hr/>
<h2 data-id="heading-22">éƒ¨ç½²æœ€ä½³å®è·µæ€»ç»“</h2>
<h3 data-id="heading-23">1. è‡ªåŠ¨åŒ–ä¸€åˆ‡</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># âœ… å®Œæ•´çš„ CI/CD æµç¨‹</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">CI/CD</span> <span class="hljs-string">Pipeline</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> [<span class="hljs-string">main</span>]

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">test:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">tests</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">test</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">linter</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">lint</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Security</span> <span class="hljs-string">scan</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">audit</span>

  <span class="hljs-attr">build:</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">test</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">Docker</span> <span class="hljs-string">image</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">docker</span> <span class="hljs-string">build</span> <span class="hljs-string">-t</span> <span class="hljs-string">myapp:${{</span> <span class="hljs-string">github.sha</span> <span class="hljs-string">}}</span> <span class="hljs-string">.</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Push</span> <span class="hljs-string">to</span> <span class="hljs-string">registry</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">docker</span> <span class="hljs-string">push</span> <span class="hljs-string">myapp:${{</span> <span class="hljs-string">github.sha</span> <span class="hljs-string">}}</span>

  <span class="hljs-attr">deploy-canary:</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">build</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">canary</span> <span class="hljs-string">(10%)</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          kubectl set image deployment/myapp-canary \
            myapp=myapp:${{ github.sha }}
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Wait</span> <span class="hljs-string">and</span> <span class="hljs-string">monitor</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          sleep 300  # ç­‰å¾… 5 åˆ†é’Ÿ
          ./scripts/check-metrics.sh
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Rollback</span> <span class="hljs-string">if</span> <span class="hljs-string">needed</span>
        <span class="hljs-attr">if:</span> <span class="hljs-string">failure()</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">kubectl</span> <span class="hljs-string">rollout</span> <span class="hljs-string">undo</span> <span class="hljs-string">deployment/myapp-canary</span>

  <span class="hljs-attr">deploy-production:</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">deploy-canary</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">production</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          kubectl set image deployment/myapp \
            myapp=myapp:${{ github.sha }}
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Monitor</span> <span class="hljs-string">deployment</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          kubectl rollout status deployment/myapp
          ./scripts/smoke-test.sh
</span></code></pre>
<h3 data-id="heading-24">2. ç›‘æ§å’Œå‘Šè­¦</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… éƒ¨ç½²åè‡ªåŠ¨ç›‘æ§å…³é”®æŒ‡æ ‡</span>
<span class="hljs-keyword">const</span> metrics = {
  <span class="hljs-comment">// é”™è¯¯ç‡</span>
  <span class="hljs-attr">errorRate</span>: {
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.01</span>, <span class="hljs-comment">// 1%</span>
    <span class="hljs-attr">query</span>: <span class="hljs-string">'rate(http_requests_total{status=~"5.."}[5m])'</span>,
  },

  <span class="hljs-comment">// å“åº”æ—¶é—´</span>
  <span class="hljs-attr">responseTime</span>: {
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// 1 ç§’</span>
    <span class="hljs-attr">query</span>: <span class="hljs-string">"histogram_quantile(0.95, http_request_duration_seconds)"</span>,
  },

  <span class="hljs-comment">// CPU ä½¿ç”¨ç‡</span>
  <span class="hljs-attr">cpuUsage</span>: {
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">80</span>, <span class="hljs-comment">// 80%</span>
    <span class="hljs-attr">query</span>: <span class="hljs-string">"rate(process_cpu_seconds_total[5m]) * 100"</span>,
  },

  <span class="hljs-comment">// å†…å­˜ä½¿ç”¨ç‡</span>
  <span class="hljs-attr">memoryUsage</span>: {
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">85</span>, <span class="hljs-comment">// 85%</span>
    <span class="hljs-attr">query</span>: <span class="hljs-string">"(process_resident_memory_bytes / node_memory_MemTotal_bytes) * 100"</span>,
  },
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">monitorDeployment</span>(<span class="hljs-params">duration = <span class="hljs-number">300000</span></span>) {
  <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()

  <span class="hljs-keyword">while</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - startTime &lt; duration) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [name, metric] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(metrics)) {
      <span class="hljs-keyword">const</span> value = <span class="hljs-keyword">await</span> <span class="hljs-title function_">queryPrometheus</span>(metric.<span class="hljs-property">query</span>)

      <span class="hljs-keyword">if</span> (value &gt; metric.<span class="hljs-property">threshold</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`âŒ <span class="hljs-subst">${name}</span> è¶…è¿‡é˜ˆå€¼: <span class="hljs-subst">${value}</span> &gt; <span class="hljs-subst">${metric.threshold}</span>`</span>)
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">rollback</span>()
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>
      }
    }

    <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">30000</span>) <span class="hljs-comment">// æ¯ 30 ç§’æ£€æŸ¥ä¸€æ¬¡</span>
  }

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"âœ… ç›‘æ§é€šè¿‡"</span>)
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
}
</code></pre>
<h3 data-id="heading-25">3. éƒ¨ç½²æ£€æŸ¥æ¸…å•</h3>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## éƒ¨ç½²å‰æ£€æŸ¥</span>

<span class="hljs-bullet">-</span> [ ] ä»£ç å·²ç»è¿‡ Code Review
<span class="hljs-bullet">-</span> [ ] æ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡ï¼ˆå•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€E2E æµ‹è¯•ï¼‰
<span class="hljs-bullet">-</span> [ ] å·²åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯
<span class="hljs-bullet">-</span> [ ] æ•°æ®åº“è¿ç§»è„šæœ¬å·²å‡†å¤‡å¥½ï¼ˆä¸”å¯å›æ»šï¼‰
<span class="hljs-bullet">-</span> [ ] é…ç½®æ–‡ä»¶å·²æ›´æ–°
<span class="hljs-bullet">-</span> [ ] ä¾èµ–é¡¹å·²æ›´æ–°
<span class="hljs-bullet">-</span> [ ] æ–‡æ¡£å·²æ›´æ–°
<span class="hljs-bullet">-</span> [ ] å›æ»šæ–¹æ¡ˆå·²å‡†å¤‡å¥½
<span class="hljs-bullet">-</span> [ ] ç›¸å…³äººå‘˜å·²é€šçŸ¥
<span class="hljs-bullet">-</span> [ ] åœ¨å…è®¸çš„éƒ¨ç½²æ—¶é—´çª—å£å†…

<span class="hljs-section">## éƒ¨ç½²ä¸­æ£€æŸ¥</span>

<span class="hljs-bullet">-</span> [ ] å¥åº·æ£€æŸ¥é€šè¿‡
<span class="hljs-bullet">-</span> [ ] æ—¥å¿—æ²¡æœ‰å¼‚å¸¸
<span class="hljs-bullet">-</span> [ ] å…³é”®æŒ‡æ ‡æ­£å¸¸ï¼ˆé”™è¯¯ç‡ã€å“åº”æ—¶é—´ã€CPUã€å†…å­˜ï¼‰
<span class="hljs-bullet">-</span> [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
<span class="hljs-bullet">-</span> [ ] å¤–éƒ¨æœåŠ¡è¿æ¥æ­£å¸¸
<span class="hljs-bullet">-</span> [ ] ç¼“å­˜æ­£å¸¸å·¥ä½œ

<span class="hljs-section">## éƒ¨ç½²åæ£€æŸ¥</span>

<span class="hljs-bullet">-</span> [ ] å†’çƒŸæµ‹è¯•é€šè¿‡
<span class="hljs-bullet">-</span> [ ] å…³é”®ä¸šåŠ¡æµç¨‹æ­£å¸¸ï¼ˆç™»å½•ã€æ”¯ä»˜ã€ä¸‹å•ç­‰ï¼‰
<span class="hljs-bullet">-</span> [ ] ç›‘æ§æŒ‡æ ‡æ­£å¸¸
<span class="hljs-bullet">-</span> [ ] æ²¡æœ‰ç”¨æˆ·æŠ•è¯‰
<span class="hljs-bullet">-</span> [ ] æ—¥å¿—æ²¡æœ‰å¼‚å¸¸
<span class="hljs-bullet">-</span> [ ] è§‚å¯Ÿè‡³å°‘ 30 åˆ†é’Ÿ
</code></pre>
<hr/>
<h2 data-id="heading-26">å†™åœ¨æœ€åï¼šéƒ¨ç½²ä¸æ˜¯ç»“æŸï¼Œè€Œæ˜¯å¼€å§‹</h2>
<p>å¾ˆå¤šäººè§‰å¾—ä»£ç å†™å®Œã€éƒ¨ç½²ä¸Šçº¿å°±å®Œäº‹äº†ã€‚</p>
<p><strong>ä½†å®é™…ä¸Šï¼Œéƒ¨ç½²åªæ˜¯å¼€å§‹ã€‚</strong></p>
<p>ä¸€ä¸ªæˆç†Ÿçš„éƒ¨ç½²æµç¨‹åº”è¯¥åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>è‡ªåŠ¨åŒ–æµ‹è¯•</strong>ï¼šç¡®ä¿ä»£ç è´¨é‡</li>
<li><strong>è‡ªåŠ¨åŒ–éƒ¨ç½²</strong>ï¼šå‡å°‘äººä¸ºé”™è¯¯</li>
<li><strong>ç°åº¦å‘å¸ƒ</strong>ï¼šé™ä½é£é™©</li>
<li><strong>å¥åº·æ£€æŸ¥</strong>ï¼šåŠæ—¶å‘ç°é—®é¢˜</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šå¿«é€Ÿå“åº”</li>
<li><strong>å¿«é€Ÿå›æ»š</strong>ï¼šæ­¢æŸåŠæ—¶</li>
<li><strong>äº‹åå¤ç›˜</strong>ï¼šæŒç»­æ”¹è¿›</li>
</ol>
<p><strong>è®°ä½è¿™äº›é»„é‡‘æ³•åˆ™ï¼š</strong></p>
<ul>
<li>âœ… æ°¸è¿œä¸è¦ç›´æ¥åœ¨ç”Ÿäº§ç¯å¢ƒæ”¹ä»£ç </li>
<li>âœ… æ°¸è¿œè¦æœ‰å›æ»šæ–¹æ¡ˆ</li>
<li>âœ… æ•°æ®åº“è¿ç§»è¦å‘åå…¼å®¹</li>
<li>âœ… ç¯å¢ƒå˜é‡ä¸è¦æäº¤åˆ° Git</li>
<li>âœ… éƒ¨ç½²åè¦ç›‘æ§å…³é”®æŒ‡æ ‡</li>
<li>âœ… å‘¨äº”ä¸‹åˆä¸è¦éƒ¨ç½²</li>
<li>âœ… å…ˆç°åº¦ï¼Œå†å…¨é‡</li>
</ul>
<p><strong>2026 å¹´äº†ï¼Œåˆ«å†è®©éƒ¨ç½²æˆä¸ºå™©æ¢¦ã€‚</strong></p>
<p>ä¸‹æ¬¡éƒ¨ç½²å‰ï¼Œå…ˆé—®è‡ªå·±ï¼š</p>
<ul>
<li>å¦‚æœå‡ºé—®é¢˜ï¼Œæˆ‘èƒ½åœ¨ 5 åˆ†é’Ÿå†…å›æ»šå—ï¼Ÿ</li>
<li>æˆ‘æœ‰ç›‘æ§å’Œå‘Šè­¦å—ï¼Ÿ</li>
<li>æˆ‘åœ¨åˆé€‚çš„æ—¶é—´éƒ¨ç½²å—ï¼Ÿ</li>
<li>æˆ‘æœ‰ç°åº¦å‘å¸ƒå—ï¼Ÿ</li>
</ul>
<p>å¦‚æœç­”æ¡ˆéƒ½æ˜¯"æ˜¯"ï¼Œé‚£å°±æ”¾å¿ƒéƒ¨ç½²å§ã€‚</p>
<p>å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªæ˜¯"å¦"ï¼Œé‚£å°±å…ˆå®Œå–„æµç¨‹ï¼Œå†éƒ¨ç½²ã€‚</p>
<p><strong>è®°ä½ï¼šéƒ¨ç½²ä¸æ˜¯èµŒåšï¼Œè€Œæ˜¯å·¥ç¨‹ã€‚</strong></p>
<hr/>
<h2 data-id="heading-27">å½©è›‹ï¼šä¸€é”®éƒ¨ç½²è„šæœ¬æ¨¡æ¿</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># deploy.sh - ç”Ÿäº§çº§éƒ¨ç½²è„šæœ¬</span>

<span class="hljs-built_in">set</span> -e  <span class="hljs-comment"># é‡åˆ°é”™è¯¯ç«‹å³é€€å‡º</span>

<span class="hljs-comment"># é¢œè‰²è¾“å‡º</span>
RED=<span class="hljs-string">'\033[0;31m'</span>
GREEN=<span class="hljs-string">'\033[0;32m'</span>
YELLOW=<span class="hljs-string">'\033[1;33m'</span>
NC=<span class="hljs-string">'\033[0m'</span> <span class="hljs-comment"># No Color</span>

<span class="hljs-comment"># é…ç½®</span>
APP_NAME=<span class="hljs-string">"myapp"</span>
ENVIRONMENT=<span class="hljs-string">"production"</span>
HEALTH_CHECK_URL=<span class="hljs-string">"https://myapp.example.com/health"</span>
ROLLBACK_ON_FAILURE=<span class="hljs-literal">true</span>

<span class="hljs-comment"># æ—¥å¿—å‡½æ•°</span>
<span class="hljs-function"><span class="hljs-title">log_info</span></span>() {
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${GREEN}</span>[INFO]<span class="hljs-variable">${NC}</span> <span class="hljs-variable">$1</span>"</span>
}

<span class="hljs-function"><span class="hljs-title">log_warn</span></span>() {
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${YELLOW}</span>[WARN]<span class="hljs-variable">${NC}</span> <span class="hljs-variable">$1</span>"</span>
}

<span class="hljs-function"><span class="hljs-title">log_error</span></span>() {
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${RED}</span>[ERROR]<span class="hljs-variable">${NC}</span> <span class="hljs-variable">$1</span>"</span>
}

<span class="hljs-comment"># æ£€æŸ¥éƒ¨ç½²æ—¶é—´</span>
<span class="hljs-function"><span class="hljs-title">check_deploy_time</span></span>() {
    HOUR=$(<span class="hljs-built_in">date</span> +%H)
    DAY=$(<span class="hljs-built_in">date</span> +%u)

    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$DAY</span> -eq 6 ] || [ <span class="hljs-variable">$DAY</span> -eq 7 ]; <span class="hljs-keyword">then</span>
        log_error <span class="hljs-string">"å‘¨æœ«ç¦æ­¢éƒ¨ç½²"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>

    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$DAY</span> -eq 5 ] &amp;&amp; [ <span class="hljs-variable">$HOUR</span> -ge 14 ]; <span class="hljs-keyword">then</span>
        log_error <span class="hljs-string">"å‘¨äº”ä¸‹åˆ 2 ç‚¹åç¦æ­¢éƒ¨ç½²"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>

    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$HOUR</span> -lt 10 ] || [ <span class="hljs-variable">$HOUR</span> -ge 16 ]; <span class="hljs-keyword">then</span>
        log_error <span class="hljs-string">"åªå…è®¸åœ¨ 10:00 - 16:00 éƒ¨ç½²"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>

    log_info <span class="hljs-string">"éƒ¨ç½²æ—¶é—´æ£€æŸ¥é€šè¿‡"</span>
}

<span class="hljs-comment"># å¥åº·æ£€æŸ¥</span>
<span class="hljs-function"><span class="hljs-title">health_check</span></span>() {
    log_info <span class="hljs-string">"æ‰§è¡Œå¥åº·æ£€æŸ¥..."</span>

    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> {1..30}; <span class="hljs-keyword">do</span>
        HTTP_CODE=$(curl -s -o /dev/null -w <span class="hljs-string">"%{http_code}"</span> <span class="hljs-variable">$HEALTH_CHECK_URL</span>)

        <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$HTTP_CODE</span>"</span> == <span class="hljs-string">"200"</span> ]; <span class="hljs-keyword">then</span>
            log_info <span class="hljs-string">"å¥åº·æ£€æŸ¥é€šè¿‡"</span>
            <span class="hljs-built_in">return</span> 0
        <span class="hljs-keyword">fi</span>

        log_warn <span class="hljs-string">"ç­‰å¾…æœåŠ¡å°±ç»ª... (<span class="hljs-variable">$i</span>/30)"</span>
        <span class="hljs-built_in">sleep</span> 10
    <span class="hljs-keyword">done</span>

    log_error <span class="hljs-string">"å¥åº·æ£€æŸ¥å¤±è´¥"</span>
    <span class="hljs-built_in">return</span> 1
}

<span class="hljs-comment"># å›æ»š</span>
<span class="hljs-function"><span class="hljs-title">rollback</span></span>() {
    log_error <span class="hljs-string">"éƒ¨ç½²å¤±è´¥ï¼Œå¼€å§‹å›æ»š..."</span>
    kubectl rollout undo deployment/<span class="hljs-variable">$APP_NAME</span>
    log_info <span class="hljs-string">"å›æ»šå®Œæˆ"</span>
}

<span class="hljs-comment"># ä¸»æµç¨‹</span>
<span class="hljs-function"><span class="hljs-title">main</span></span>() {
    log_info <span class="hljs-string">"å¼€å§‹éƒ¨ç½² <span class="hljs-variable">$APP_NAME</span> åˆ° <span class="hljs-variable">$ENVIRONMENT</span>"</span>

    <span class="hljs-comment"># 1. æ£€æŸ¥éƒ¨ç½²æ—¶é—´</span>
    check_deploy_time

    <span class="hljs-comment"># 2. æ‹‰å–æœ€æ–°ä»£ç </span>
    log_info <span class="hljs-string">"æ‹‰å–æœ€æ–°ä»£ç ..."</span>
    git pull origin main

    <span class="hljs-comment"># 3. è¿è¡Œæµ‹è¯•</span>
    log_info <span class="hljs-string">"è¿è¡Œæµ‹è¯•..."</span>
    npm <span class="hljs-built_in">test</span> || {
        log_error <span class="hljs-string">"æµ‹è¯•å¤±è´¥"</span>
        <span class="hljs-built_in">exit</span> 1
    }

    <span class="hljs-comment"># 4. æ„å»ºé•œåƒ</span>
    log_info <span class="hljs-string">"æ„å»º Docker é•œåƒ..."</span>
    VERSION=$(git rev-parse --short HEAD)
    docker build -t <span class="hljs-variable">$APP_NAME</span>:<span class="hljs-variable">$VERSION</span> .

    <span class="hljs-comment"># 5. æ¨é€é•œåƒ</span>
    log_info <span class="hljs-string">"æ¨é€é•œåƒåˆ°ä»“åº“..."</span>
    docker push <span class="hljs-variable">$APP_NAME</span>:<span class="hljs-variable">$VERSION</span>

    <span class="hljs-comment"># 6. éƒ¨ç½²</span>
    log_info <span class="hljs-string">"éƒ¨ç½²åˆ° Kubernetes..."</span>
    kubectl <span class="hljs-built_in">set</span> image deployment/<span class="hljs-variable">$APP_NAME</span> <span class="hljs-variable">$APP_NAME</span>=<span class="hljs-variable">$APP_NAME</span>:<span class="hljs-variable">$VERSION</span>

    <span class="hljs-comment"># 7. ç­‰å¾…éƒ¨ç½²å®Œæˆ</span>
    log_info <span class="hljs-string">"ç­‰å¾…éƒ¨ç½²å®Œæˆ..."</span>
    kubectl rollout status deployment/<span class="hljs-variable">$APP_NAME</span> --<span class="hljs-built_in">timeout</span>=5m || {
        <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$ROLLBACK_ON_FAILURE</span>"</span> = <span class="hljs-literal">true</span> ]; <span class="hljs-keyword">then</span>
            rollback
        <span class="hljs-keyword">fi</span>
        <span class="hljs-built_in">exit</span> 1
    }

    <span class="hljs-comment"># 8. å¥åº·æ£€æŸ¥</span>
    health_check || {
        <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$ROLLBACK_ON_FAILURE</span>"</span> = <span class="hljs-literal">true</span> ]; <span class="hljs-keyword">then</span>
            rollback
        <span class="hljs-keyword">fi</span>
        <span class="hljs-built_in">exit</span> 1
    }

    <span class="hljs-comment"># 9. å†’çƒŸæµ‹è¯•</span>
    log_info <span class="hljs-string">"æ‰§è¡Œå†’çƒŸæµ‹è¯•..."</span>
    npm run smoke-test || {
        <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$ROLLBACK_ON_FAILURE</span>"</span> = <span class="hljs-literal">true</span> ]; <span class="hljs-keyword">then</span>
            rollback
        <span class="hljs-keyword">fi</span>
        <span class="hljs-built_in">exit</span> 1
    }

    <span class="hljs-comment"># 10. ç›‘æ§</span>
    log_info <span class="hljs-string">"ç›‘æ§å…³é”®æŒ‡æ ‡ 5 åˆ†é’Ÿ..."</span>
    <span class="hljs-built_in">sleep</span> 300

    log_info <span class="hljs-string">"ğŸ‰ éƒ¨ç½²æˆåŠŸï¼"</span>
    log_info <span class="hljs-string">"ç‰ˆæœ¬: <span class="hljs-variable">$VERSION</span>"</span>
    log_info <span class="hljs-string">"æ—¶é—´: <span class="hljs-subst">$(date)</span>"</span>
}

<span class="hljs-comment"># æ‰§è¡Œ</span>
main
</code></pre>
<p>ç°åœ¨ï¼Œå»å»ºç«‹ä¸€ä¸ªè®©äººæ”¾å¿ƒçš„éƒ¨ç½²æµç¨‹å§ï¼ğŸš€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[electron preload.jsè°ƒè¯•æŠ€å·§ignore listï¼šContent scripts injected by extensions]]></title>    <link>https://juejin.cn/post/7595847940620943410</link>    <guid>https://juejin.cn/post/7595847940620943410</guid>    <pubDate>2026-01-17T04:19:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595847940620943410" data-draft-id="7595808703073861658" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="electron preload.jsè°ƒè¯•æŠ€å·§ignore listï¼šContent scripts injected by extensions"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-17T04:19:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xu__yanfeng"/> <meta itemprop="url" content="https://juejin.cn/user/3052689432524861"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            electron preload.jsè°ƒè¯•æŠ€å·§ignore listï¼šContent scripts injected by extensions
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3052689432524861/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xu__yanfeng
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T04:19:23.000Z" title="Sat Jan 17 2026 04:19:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½¿ç”¨electronå¼€å‘å·¥å…·æ—¶ï¼Œæˆ‘ä½¿ç”¨åˆ°äº†viteï¼Œä¸ºäº†ä½¿ç”¨vue devserveråŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œé€šå¸¸åœ¨devç¯å¢ƒï¼ŒBrowserWindowä¼šåŠ è½½dev serverçš„urlï¼Œä¹Ÿå°±æ˜¯è¿™æ ·å­</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> win = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BrowserWindow</span>({});
win.<span class="hljs-title function_">loadURL</span>(<span class="hljs-string">"http://localhost:8065/"</span>);
</code></pre>
<p>ä½†æ˜¯æˆ‘è¿˜æƒ³ä½¿ç”¨nodejsçš„ç‰¹æ€§ï¼Œå¾ˆæ˜æ˜¾åœ¨webé¡µé¢ä¸è¡Œï¼Œæˆ‘ä¸æƒ³å†™åœ¨ä¸»è¿›ç¨‹ï¼Œå› ä¸ºéœ€è¦ipcé€šè®¯ï¼Œå¾ˆéº»çƒ¦ã€‚</p>
<p>çœ‹åˆ°å¯ä»¥é€šè¿‡preload.jsæ¥å®ç°æˆ‘çš„éœ€æ±‚ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">let</span> win = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BrowserWindow</span>({
    <span class="hljs-attr">sandbox</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">contextIsolation</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">preload</span>: <span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">'./preload.js'</span>),
});
win.<span class="hljs-title function_">loadURL</span>(<span class="hljs-string">"http://localhost:8065/"</span>);
</code></pre>
<p>åœ¨preload.jsé‡Œé¢æ³¨å…¥ä¸€ä¸ªå…¨å±€å˜é‡ç»™æ¸²æŸ“ç•Œé¢ä½¿ç”¨ï¼Œæœ€é‡è¦çš„æ˜¯ç›´æ¥å¯ä»¥åœ¨preloadè„šæ­¥é‡Œé¢å†™nodejsçš„é€»è¾‘äº†</p>
<pre><code class="hljs language-arduino" lang="arduino">contextBridge.<span class="hljs-built_in">exposeInMainWorld</span>(<span class="hljs-string">"gss"</span>, gss)
</code></pre>
<p>ç°åœ¨é—®é¢˜æ¥äº†ï¼Œæˆ‘è¦è°ƒè¯•è¿™ä¸ªpreload.jsï¼Œå‘ç°åœ¨devtoolsé‡Œé¢èƒ½çœ‹åˆ°preload.jsçš„æ‰“å°ï¼Œä¹Ÿèƒ½å¤Ÿä¸‹æ–­ç‚¹ï¼Œä½†æ˜¯æ— æ³•æ­¥è¿›ï¼Œå¦‚æœæˆ‘é€è¡Œè°ƒè¯•ï¼Œå°±å¯¼è‡´æ¯ä¸€è¡Œæˆ‘éƒ½éœ€è¦ä¸‹æ–­ç‚¹ï¼Œéå¸¸éš¾å—ã€‚</p>
<h2 data-id="heading-0">è§£å†³åŠæ³•</h2>
<p>æŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œå‘ç°æ˜¯chromeçš„ignore listçš„é—®é¢˜ï¼Œå› ä¸ºpreload.jså±äºæ³¨å…¥çš„è„šæœ¬ï¼Œæ‰€ä»¥å¯¼è‡´è¢«å¿½ç•¥äº†</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a1958926fda404190e0ac7b175623c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeHVfX3lhbmZlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769228362&amp;x-signature=KabE2x6lcnuDyxqleJYMeF6Zako%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3a606cfae7ff4e88b53e39a4746db776~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeHVfX3lhbmZlbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769228362&amp;x-signature=8Gp5vCl5Wkl68TFGuA72dH3cIFg%3D" alt="image.png" loading="lazy"/></p>
<p>å–æ¶ˆé€‰ä¸­å³å¯ï¼Œç°åœ¨å¯ä»¥é€è¡Œè°ƒè¯•preload.jsäº†ï¼Œå¼€å‘èµ·æ¥éå¸¸ä¸æ»‘ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åª’ä½“é‡‡é›†æ ‡å‡†è‰æ¡ˆ ä¸ Chromium éŸ³é¢‘é‡‡é›†å®ç°ç®€ä»‹]]></title>    <link>https://juejin.cn/post/7595495896135581722</link>    <guid>https://juejin.cn/post/7595495896135581722</guid>    <pubDate>2026-01-16T02:55:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595495896135581722" data-draft-id="7595484390428606499" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åª’ä½“é‡‡é›†æ ‡å‡†è‰æ¡ˆ ä¸ Chromium éŸ³é¢‘é‡‡é›†å®ç°ç®€ä»‹"/> <meta itemprop="keywords" content="å‰ç«¯,éŸ³è§†é¢‘å¼€å‘,Chrome"/> <meta itemprop="datePublished" content="2026-01-16T02:55:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­—èŠ‚æ¶æ„å‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/1530175206729016"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åª’ä½“é‡‡é›†æ ‡å‡†è‰æ¡ˆ ä¸ Chromium éŸ³é¢‘é‡‡é›†å®ç°ç®€ä»‹
            <!----> <!----></h1> <div class="container team-follow" data-v-d326b38e="" data-v-61fb5e44=""><div class="left" data-v-d326b38e=""><a href="/team/6984296204297306148/posts" data-v-d326b38e=""><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ce530e92b8f474a93c7599c70cb7e25~tplv-k3u1fbpfcp-watermark.image" class="icon" data-v-d326b38e=""/></a> <div class="content" data-v-d326b38e=""><div style="display: flex" data-v-d326b38e=""><a href="/team/6984296204297306148/posts" data-v-d326b38e=""><p class="title-line" data-v-d326b38e=""><span title="å­—èŠ‚æ¶æ„å‰ç«¯" class="title" data-v-d326b38e="">å­—èŠ‚æ¶æ„å‰ç«¯</span> <img src="//lf-web-assets.juejin.cn/obj/juejin-web/xitu_juejin_web/255e400027b783cbad76dc41527e7695.svg" alt="team icon" class="team-icon" data-v-d326b38e=""/></p></a></div> <div class="meta-box team" data-v-d326b38e="" data-v-61fb5e44=""><time datetime="2026-01-16T02:55:47.000Z" title="Fri Jan 16 2026 02:55:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-d326b38e="" data-v-61fb5e44="">
                2026-01-16
              </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-d326b38e="" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-d326b38e="" data-v-61fb5e44=""/></svg> <span class="views-count" style="display:none;" data-v-d326b38e="" data-v-61fb5e44="">
                2
              </span> <span class="read-time" data-v-d326b38e="" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d326b38e="" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-d326b38e="" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-d326b38e="" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-d326b38e="" data-v-61fb5e44=""/></svg>
                é˜…è¯»19åˆ†é’Ÿ
              </span> <!----> <!----></div></div></div> <button class="jj-follow-button follow-btn" style="display:none;" data-v-b60b2868="" data-v-d326b38e=""><span data-v-b60b2868="" data-v-d326b38e=""><i class="byte-icon byte-icon--plus" data-v-d326b38e=""><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48"><path fill="none" d="M0 0h48v48H0z"/><path d="M24.7 4c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8V22h16.7c.4 0 .6 0 .8.1.2.1.3.2.4.4.1.2.1.3.1.8v1.4c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1H26v16.7c0 .4 0 .6-.1.8-.1.2-.2.3-.4.4-.2.1-.3.1-.8.1h-1.4c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8V26H5.3c-.4 0-.6 0-.8-.1-.2-.1-.3-.2-.4-.4-.1-.2-.1-.3-.1-.8v-1.4c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1H22V5.3c0-.4 0-.6.1-.8.1-.2.2-.3.4-.4.2-.1.3-.1.8-.1h1.4z"/></svg></i>
        å…³æ³¨
      </span></button></div> <div class="team-user block-hidden" data-v-61fb5e44=""><div class="avatar jj-avatar avatar" data-v-03256cc6="" data-v-61fb5e44=""><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8AQMAAAAAMksxAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAA5JREFUKM9jGAWjAAcAAAIcAAE27nY6AAAAAElFTkSuQmCC" alt="avatar" class="lazy avatar-img" data-v-5244ef91="" data-v-03256cc6=""/> </div> <!----> <span class="position ellipsis" data-v-61fb5e44="">
              FE @å­—èŠ‚è·³åŠ¨
            </span></div> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<ul>
<li>ç®€è¦ä»‹ç» W3C Media Capture and Streams è‰æ¡ˆä¸­é‡‡é›†éƒ¨åˆ†çš„çº¦å®š</li>
<li>ç²—ç•¥ä»‹ç» Chromium çš„å¤šè¿›ç¨‹æ¶æ„ä»¥åŠéŸ³é¢‘é‡‡é›†åŠŸèƒ½çš„å®ç°</li>
</ul>
</blockquote>
<h2 data-id="heading-0">Media Capture and Streams</h2>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯ Media Capture and Streams TR</h3>
<p>Media Capture and Streams æ˜¯ç”± W3C WebRTC Working Group æå‡ºçš„è§„èŒƒè‰æ¡ˆï¼Œä¸»è¦å®šä¹‰äº†è·å–æœ¬åœ°åª’ä½“çš„ JavaScript APIã€‚ç›®å‰è¯¥è‰æ¡ˆå¤„äº CRD (Candidate Recommend Draft) çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥è¢«ç§°ä¸ºæŠ€æœ¯æŠ¥å‘Šï¼ˆTechnical Report, TRï¼‰</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3.org%2FTR%2Fmediacapture-streams%2F" target="_blank" title="https://www.w3.org/TR/mediacapture-streams/" ref="nofollow noopener noreferrer">www.w3.org/TR/mediacapâ€¦</a></p>
<p>è™½ç„¶ W3C å¼ºè°ƒï¼ŒW3C CRD ä¸èƒ½ï¼ˆMUST NOTï¼‰ä»¥ W3C æ ‡å‡†çš„åä¹‰å¼•ç”¨ã€‚å¹¶ä¸”ï¼ŒW3C CRD å¯èƒ½æˆä¸º W3C æ ‡å‡†ï¼Œä¹Ÿå¯èƒ½ä¸ä¼šæˆä¸º W3C æ ‡å‡†ã€‚ä½†æˆªè‡³ç›®å‰ï¼Œä¸»æµæµè§ˆå™¨éƒ½å‚è€ƒäº†è¿™ä»½è‰æ¡ˆè¿›è¡Œäº†å®ç°ã€‚å„ä½ Web å¼€å‘è€…å¤§å¯æ”¾å¿ƒä½¿ç”¨ç›¸å…³ API å¼€å‘è‡ªå·±çš„ç½‘é¡µåº”ç”¨ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4735081ee9b14f30b64cab4c5f4a8b7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=w6TcJaFTupkB6tNiA%2BUwObpkGb4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-2">è‰æ¡ˆåŒ…å«çš„ API</h3>
<p>è¿™ä»½è‰æ¡ˆåŒ…å«äº†ä¸¤å¤§ç±» APIï¼šMediaStreamã€MediaDevicesã€‚</p>
<ul>
<li>
<p>MediaStream: ä¸»è¦åŒ…å« MediaStreamã€MediaStreamTrack ä¸¤å¤§ç±»ã€‚</p>
<ul>
<li>MediaStreamTrack: ä»ä¸€ä¸ªåª’ä½“æºè·å–çš„ã€å•ä¸€ç±»å‹çš„åª’ä½“ã€‚ï¼ˆä¾‹å¦‚ï¼šæ¥è‡ªæ‘„åƒå¤´çš„è§†é¢‘ï¼‰</li>
<li>MediaStream: ç”±å¤šä¸ª MediaStreamTrack æ„æˆçš„ä¸€ä¸ªå•å…ƒï¼Œå¯ä»¥è¢«å½•åˆ¶æˆ–è€…åœ¨ Media Element ä¸Šæ¸²æŸ“ã€‚</li>
</ul>
</li>
<li>
<p>MediaDevices: æ‰©å±•è‡ª Navigator æ¥å£ï¼Œä¸»è¦åŒ…å«æšä¸¾åª’ä½“è®¾å¤‡ã€è·å–åª’ä½“æµä¸¤ç±»ã€‚</p>
<ul>
<li>enumerateDevices: æ”¶é›†æµè§ˆå™¨å¯ç”¨çš„åª’ä½“è¾“å…¥è®¾å¤‡å’Œåª’ä½“è¾“å‡ºè®¾å¤‡ã€‚</li>
<li>getUserMedia: å‘ç”¨æˆ·ç”³è¯·æƒé™ï¼Œè·å–ç”¨æˆ·çš„æ‘„åƒå¤´æˆ–è€…å…¶ä»–çš„éŸ³è§†é¢‘è¾“å…¥ä¿¡æ¯ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-3">æ€æ ·ä½¿ç”¨è¿™äº› API</h3>
<p>ä¸‹é¢çš„å®ä¾‹ä»£ç ç®€å•å±•ç¤ºäº†å¦‚ä½•é‡‡é›†æ‘„åƒå¤´æµï¼Œå¹¶å°†æµæ¸²æŸ“åˆ°åª’ä½“å…ƒç´ ä¸Šã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> startBtn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"startBtn"</span>); <span class="hljs-comment">// &lt;button&gt;</span>
<span class="hljs-keyword">const</span> videoPlayer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"videoPlayer"</span>); <span class="hljs-comment">// &lt;video&gt;</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">captureCamera</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// çº¦æŸ</span>
    <span class="hljs-keyword">const</span> constraints = {
      <span class="hljs-attr">video</span>: {
        <span class="hljs-attr">width</span>: <span class="hljs-number">640</span>,
        <span class="hljs-attr">height</span>: <span class="hljs-number">480</span>,
      },
      <span class="hljs-attr">audio</span>: <span class="hljs-literal">true</span>,
    };

    <span class="hljs-comment">// é‡‡é›†</span>
    <span class="hljs-keyword">const</span> stream = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-title function_">getUserMedia</span>(constraints);

    <span class="hljs-comment">// æ’­æ”¾</span>
    videoPlayer.<span class="hljs-property">srcObject</span> = stream;
    videoPlayer.<span class="hljs-title function_">play</span>();
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
  }
}

startBtn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"click"</span>, captureCamera);
</code></pre>
<p>ä¸Šè¿°ä»£ç ä¸­åŒ…å«äº†ä¸‰ä¸ªé‡è¦çš„æ­¥éª¤ï¼š</p>
<ol>
<li>
<p>çº¦æŸï¼šå‘æµè§ˆå™¨æä¾›æ‰€éœ€è¦çš„åª’ä½“æµçš„ä¿¡æ¯ã€‚</p>
<ol>
<li>æ¯ç§åª’ä½“éƒ½å¯ä»¥æŒ‡å®šå…¶çº¦æŸ</li>
<li>åªè®¾ç½®ä¸º true è¡¨ç¤ºéœ€è¦è¿™ä¸ªåª’ä½“æµï¼Œä½†æ²¡æœ‰ä»»ä½•é™åˆ¶</li>
</ol>
</li>
</ol>
<blockquote>
<p>JSï¼šæµè§ˆå™¨ï¼Œè¯·ç»™æˆ‘ä¸€ä¸ªåˆ†è¾¨ç‡ 640x480 çš„è§†é¢‘æµï¼Œå†æ¥ä¸€ä¸ªéŸ³é¢‘æµã€‚å“ªä¸ªè®¾å¤‡çš„éƒ½å¯ä»¥ã€‚</p>
</blockquote>
<ol start="2">
<li>é‡‡é›†ï¼šå°†çº¦æŸä¼ å…¥ getUserMedia æ¥å£ã€‚è¯¥æ¥å£å°†ä»¥ Promise å½¢å¼è¿”å›ä¸€ä¸ª MediaStreamã€‚</li>
</ol>
<blockquote>
<p>[ç­‰äº†ä¸€ä¼š]</p>
<p>æµè§ˆå™¨ï¼šå¥½å˜ï¼Œä½ è¦çš„ä¸¤ä¸ªæµã€‚æ‰“åŒ…æ”¾ä¸€èµ·äº†ã€‚</p>
</blockquote>
<ol start="3">
<li>æ’­æ”¾ï¼šè¯¥è‰æ¡ˆä¸­ä¹Ÿæä¾›äº†åœ¨ HTMLMediaElement ä¸Šæ¸²æŸ“è¿™äº›æµçš„æ¥å£ã€‚å°† MediaElement çš„ srcObject è®¾ç½®ä¸ºæƒ³è¦æ’­æ”¾çš„æµã€‚ç„¶åè°ƒç”¨ play å³å¯ã€‚</li>
</ol>
<p>ä¸»è¦æ³¨æ„çš„æ˜¯ï¼Œä¼ ç»™ getUserMedia æ¥å£çš„å‚æ•°è¢«ç§°ä½œâ€œçº¦æŸâ€ã€‚è¿™æ˜¯å› ä¸ºè¯¥æ¥å£æœ€ç»ˆè¿”å›çš„æµå¯èƒ½ä¸çº¦æŸä¸ä¸€è‡´ã€‚è¿™å°±æ¶‰åŠåˆ°è®¾ç½®ã€èƒ½åŠ›ä¸çº¦æŸçš„åŒºåˆ«äº†ã€‚</p>
<h3 data-id="heading-4">è®¾ç½®ã€èƒ½åŠ›ä¸çº¦æŸ</h3>
<h4 data-id="heading-5">Setting è®¾ç½®</h4>
<p>è®¾ç½®è¡¨ç¤ºä¸€ä¸ªåª’ä½“æºå½“å‰æ‰€åº”ç”¨çš„å‚æ•°ã€‚æ˜¾ç„¶ï¼Œè¿™ä¸ªå‚æ•°éœ€è¦æ˜¯åªè¯»çš„ã€‚</p>
<p>è¿™é‡Œä»¥ä¸Šæ–‡é‡‡é›†åˆ°çš„éŸ³è§†é¢‘è½¨é“ä¸ºä¾‹ï¼Œåˆ†åˆ«è°ƒç”¨ <code>getSettings()</code> æ¥å£ã€‚å¯ä»¥å‘ç°æ¥å£è¿”å›äº†å¦‚ä¸‹å†…å®¹ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// audio</span>
{
    <span class="hljs-attr">autoGainControl</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">channelCount</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">deviceId</span>: <span class="hljs-string">"cc0e809ba21cc1e8a1403b835d13ea3a4e8541f438d0b31989294cace5f43ec2"</span>,
    <span class="hljs-attr">echoCancellation</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">groupId</span>: <span class="hljs-string">"075cbccd30ba3337cf5d990a77525475153112df8066833c3213706ceeab2b42"</span>,
    <span class="hljs-attr">latency</span>: <span class="hljs-number">0.01</span>,
    <span class="hljs-attr">noiseSuppression</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">sampleRate</span>: <span class="hljs-number">48000</span>,
    <span class="hljs-attr">sampleSize</span>: <span class="hljs-number">16</span>,
    <span class="hljs-attr">voiceIsolation</span>: <span class="hljs-literal">false</span>
}
<span class="hljs-comment">// video</span>
{
    <span class="hljs-attr">aspectRatio</span>: <span class="hljs-number">1.3333333333333333</span>,
    <span class="hljs-attr">deviceId</span>: <span class="hljs-string">"d1216494e164337d39248c6d9610a0e7038ec774998f758665270dcaaae29093"</span>,
    <span class="hljs-attr">frameRate</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">groupId</span>: <span class="hljs-string">"f9b73b0dac3ff31397c5bb01df58e1256aa1acc930d2634f7d090b24da06a513"</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">480</span>,
    <span class="hljs-attr">resizeMode</span>: <span class="hljs-string">"none"</span>,
    <span class="hljs-attr">width</span>: <span class="hljs-number">640</span>
}
</code></pre>
<p>è¿™ä¸¤ä¸ªå¯¹è±¡è¯¦ç»†æè¿°äº†éŸ³è§†é¢‘æº<strong>æ­£åœ¨åº”ç”¨</strong>çš„å‚æ•°ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°å¯¹äºè§†é¢‘çš„åˆ†è¾¨ç‡çº¦æŸä¹Ÿç”Ÿæ•ˆäº†ã€‚</p>
<p>ä¸€äº›å¸¸ç”¨çš„å­—æ®µå«ä¹‰å¦‚ä¸‹æ‰€ç¤ºï¼Œä¸åšèµ˜è¿°ã€‚</p>
<p>éŸ³é¢‘</p>
<ul>
<li><code>deviceId</code>ï¼šè®¾å¤‡ ID</li>
<li><code>channelCount</code>: å£°é“æ•°</li>
<li><code>autoGainControl</code>ï¼šè‡ªåŠ¨å¢ç›Šæ§åˆ¶</li>
<li><code>echoCancellation</code>ï¼šå›å£°æ¶ˆé™¤</li>
<li><code>noiseSuppression</code>ï¼šå™ªå£°æŠ‘åˆ¶</li>
</ul>
<p>è§†é¢‘</p>
<ul>
<li><code>deviceId</code>: è®¾å¤‡ ID</li>
<li><code>width</code>ï¼šç”»é¢å®½åº¦</li>
<li><code>height</code>ï¼šç”»é¢é«˜åº¦</li>
<li><code>frameRate</code>ï¼šå¸§ç‡</li>
</ul>
<h4 data-id="heading-6">Capability èƒ½åŠ›</h4>
<p>èƒ½åŠ›æ˜¯æŒ‡åª’ä½“æºæ”¯æŒå“ªäº›å‚æ•°ï¼Œæ¯ä¸ªå‚æ•°çš„èŒƒå›´å¦‚ä½•ã€‚</p>
<p>ä¾‹å¦‚ï¼šä¸€ä¸ªæ‘„åƒå¤´å¯èƒ½æ”¯æŒ 640x480@60, 1920x1080@30 ç­‰å¤šç§åˆ†è¾¨ç‡ã€å¸§ç‡ç»„åˆã€‚ä¸€ä¸ªéº¦å…‹é£å¯èƒ½æ”¯æŒ 48000Hz é‡‡æ ·ç‡ï¼Œä¹Ÿæ”¯æŒ 44100Hz é‡‡æ ·ç‡ã€‚</p>
<p>ç„¶è€Œé€šè¿‡ä¸Šé¢ä¸¤ä¸ªä¾‹å­ï¼Œå°±å¯ä»¥å‘ç°å®Œæ•´åˆ—ä¸¾è®¾å¤‡èƒ½åŠ›æ˜¯å‡ ä¹ä¸å¯èƒ½çš„ã€‚</p>
<ol>
<li>å‚æ•°ç§ç±»å¾ˆå¤šï¼Œæ¯ä¸ªå‚æ•°åˆæœ‰ä¸åŒçš„å–å€¼èŒƒå›´ã€‚ä½¿ç”¨çº¦æŸåˆ—è¡¨è¿›è¡Œæè¿°ï¼Œå°†è·å¾—éå¸¸å¤šçš„ç»„åˆï¼Œæ— æ³•å®Œæ•´åˆ—ä¸¾ã€‚</li>
<li>è¿‡äºè¯¦ç»†çš„èƒ½åŠ›é›†åˆå¾ˆå®¹æ˜“ç”¨æ¥ä½œä¸ºè®¾å¤‡æŒ‡çº¹ã€‚</li>
</ol>
<p>å› æ­¤ <code>getCapability()</code> åªèƒ½è·å–å·²ç»é‡‡é›†åˆ°çš„æµæ‰€å¯¹åº”çš„åª’ä½“æºçš„å‚æ•°ã€‚</p>
<p>è¿˜æ˜¯ä»¥ä¸Šé¢çš„é‡‡é›†åˆ°çš„éŸ³è§†é¢‘è½¨é“ä¸ºä¾‹ã€‚åˆ†åˆ«è°ƒç”¨ <code>getCapability()</code> æ¥å£ï¼Œå¯ä»¥çœ‹åˆ°è¿™ä¸¤ä¸ªè®¾å¤‡çš„èƒ½åŠ›åˆ—è¡¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// audio</span>
{
    <span class="hljs-attr">autoGainControl</span>: [<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>],
    <span class="hljs-attr">channelCount</span>: {<span class="hljs-attr">max</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">1</span>},
    <span class="hljs-attr">deviceId</span>: <span class="hljs-string">"cc0e809ba21cc1e8a1403b835d13ea3a4e8541f438d0b31989294cace5f43ec2"</span>,
    <span class="hljs-attr">echoCancellation</span>:  [<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>],
    <span class="hljs-attr">groupId</span>: <span class="hljs-string">"6190ef675de1872a2190edd82ee43c58899d1d6b0c6a613113de98cf3650c1c8"</span>,
    <span class="hljs-attr">latency</span>: {<span class="hljs-attr">max</span>: <span class="hljs-number">0.085333</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">0.002666</span>},
    <span class="hljs-attr">noiseSuppression</span>:  [<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>],
    <span class="hljs-attr">sampleRate</span>: {<span class="hljs-attr">max</span>: <span class="hljs-number">48000</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">48000</span>},
    <span class="hljs-attr">sampleSize</span>: {<span class="hljs-attr">max</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">16</span>},
    <span class="hljs-attr">voiceIsolation</span>:  [<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>],
}
<span class="hljs-comment">// video</span>
{
    <span class="hljs-attr">aspectRatio</span>: {<span class="hljs-attr">max</span>: <span class="hljs-number">1920</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">0.0005208333333333333</span>},
    <span class="hljs-attr">deviceId</span>: <span class="hljs-string">"d1216494e164337d39248c6d9610a0e7038ec774998f758665270dcaaae29093"</span>,
    <span class="hljs-attr">facingMode</span>: [],
    <span class="hljs-attr">frameRate</span>: {<span class="hljs-attr">max</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>},
    <span class="hljs-attr">groupId</span>: <span class="hljs-string">"ebfbdd93ec4d8fc55a6e98ba59961767621761d27110e22c64a2033d26e19246"</span>,
    <span class="hljs-attr">height</span>: {<span class="hljs-attr">max</span>: <span class="hljs-number">1920</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">1</span>},
    <span class="hljs-attr">resizeMode</span>: [<span class="hljs-string">'none'</span>, <span class="hljs-string">'crop-and-scale'</span>],
    <span class="hljs-attr">width</span>: {<span class="hljs-attr">max</span>: <span class="hljs-number">1920</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">1</span>}
}
</code></pre>
<p>å¯ä»¥å‘ç°ï¼Œèƒ½åŠ›æœ‰ä»¥ä¸‹å‡ ç§æè¿°å½¢å¼ã€‚</p>
<ul>
<li>åˆ—è¡¨ï¼šè¡¨ç¤ºå¯ä»¥ä½¿ç”¨åˆ—è¡¨ä¸­çš„å…¶ä¸­ä¸€é¡¹ã€‚</li>
<li>æœ€å¤§å€¼ä¸æœ€å°å€¼ï¼šè¡¨ç¤ºå¯ä»¥ä½¿ç”¨è¿™ä¸ªèŒƒå›´å†…çš„å€¼ã€‚</li>
</ul>
<h4 data-id="heading-7">Constraints çº¦æŸ</h4>
<p>çº¦æŸè¿™ä¸ªæ¦‚å¿µæ¯”è¾ƒæŠ½è±¡ã€‚å¯ä»¥ç†è§£ä¸ºè¿™æ˜¯ä¸€ç§æè¿°ç½‘é¡µåº”ç”¨æ‰€éœ€åª’ä½“æµçš„ç‰¹å¾çš„æ¥å£ã€‚å‘åª’ä½“æºæä¾›çº¦æŸï¼Œå°†å½±å“åª’ä½“æºå¦‚ä½•æä¾›å°½å¯èƒ½ç¬¦åˆè¦æ±‚çš„åª’ä½“æµã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3d86870e0db646e5965f2f39c1262161~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=bNwunC7KPn2%2FxPQF2q2aCXq8RfQ%3D" alt="" loading="lazy"/></p>
<p>æ­£å¦‚å‰é¢çš„ä¾‹å­ï¼Œç½‘é¡µåº”ç”¨çš„éœ€æ±‚æ˜¯ä¸€ä¸ªå®½ 640pxã€é«˜ 480px çš„è§†é¢‘æµã€‚è¿™ä¸ªéœ€æ±‚æ˜¯çº¦æŸã€‚åª’ä½“æºåœ¨åº”ç”¨è¿™ä¸ªçº¦æŸæ—¶ï¼Œä¼šæ ¹æ®åª’ä½“æºçš„èƒ½åŠ›é€‰æ‹©æœ€æ¥è¿‘çš„è®¾ç½®ï¼Œç”Ÿæˆåª’ä½“æµã€‚</p>
<p>é™¤äº†ä¸Šæ–‡çº¦æŸå¯ä»¥é€šè¿‡å•ä¸€å€¼æ¥è®¾ç½®çº¦æŸä»¥å¤–ï¼Œè¿˜å¯ä»¥æœ‰å¦‚ä¸‹å½¢å¼çš„çº¦æŸã€‚</p>
<ul>
<li>
<p><code>{max, mix}</code>ï¼šè¡¨ç¤ºä¸€ä¸ªèŒƒå›´ã€‚</p>
<ul>
<li>ä¾‹å¦‚ï¼š<code>width: {max: 1080, min: 720}</code></li>
</ul>
</li>
<li>
<p><code>{exact}</code>ï¼šè¡¨ç¤ºç²¾ç¡®å€¼ï¼Œä¸æ»¡è¶³çº¦æŸæ—¶æŠ¥é”™ã€‚</p>
<ul>
<li>ä¾‹å¦‚ï¼š<code>deviceId: {exact: 'd1216494'}</code></li>
</ul>
</li>
<li>
<p><code>{ideal}</code>ï¼šè¡¨ç¤ºç†æƒ³å€¼ï¼Œä¸æ»¡è¶³æ—¶æµè§ˆå™¨å¯èƒ½ä¼šåº”ç”¨å…¶ä»–æ¥è¿‘çš„è®¾ç½®ã€‚</p>
<ul>
<li>ä¾‹å¦‚ï¼š<code>deviceId: {ideal: 'd1216494'}</code></li>
<li>Â Â æ­¤å¤–ï¼Œè¿˜æ”¯æŒè¿›é˜¶çº¦æŸï¼ˆadvanced constraintï¼‰ã€‚è¿™äº›çº¦æŸçš„ä¼˜å…ˆçº§å°†å°äºæ™®é€šçº¦æŸã€‚</li>
</ul>
</li>
</ul>
<p>é‚£ä¹ˆæµè§ˆå™¨åº”è¯¥å¦‚ä½•å®ç°è¿™ä¸ª é€šè¿‡çº¦æŸè·å¾—è®¾ç½® çš„ç®—æ³•å‘¢ï¼Ÿè¿™ä»½è‰æ¡ˆä¸­å®šä¹‰äº† <code>SelectSetting</code> ç®—æ³•ã€‚</p>
<h4 data-id="heading-8"><code>SelectSetting</code> ç®—æ³•</h4>
<p><code>SelectSetting</code> ç®—æ³•çš„ç›®æ ‡å°±æ˜¯åœ¨å¤šä¸ªå€™é€‰è®¾ç½®ä¸­ï¼Œé€‰å‡ºä¸€ä¸ªç¬¦åˆçº¦æŸçš„è®¾ç½®ã€‚å½“ç„¶ï¼Œå¦‚æœæ²¡åŠæ³•æ»¡è¶³è¦æ±‚çš„è¯éœ€è¦æŠ¥é”™ã€‚</p>
<p><code>SelectSetting</code>ç®—æ³•çš„è¾“å…¥åˆ†åˆ«æ˜¯ä¸€ç»„å€™é€‰è®¾ç½® Candidates å’Œä¸€ä¸ªçº¦æŸ ConstraintSet (CS)ã€‚</p>
<ol>
<li>é€‰æ‹© CS ä¸­çš„æ™®é€šçº¦æŸï¼Œä¸æ‰€æœ‰å€™é€‰è®¾ç½®è¿›è¡ŒåŒ¹é…ã€‚å¦‚æœåŒ¹é…å¤±è´¥ç›´æ¥è¿”å›ç©ºå€¼ã€‚</li>
<li>éå† CS ä¸­çš„è¿›é˜¶çº¦æŸç»„ï¼Œå¦‚æœåŒ¹é…å¤±è´¥åˆ™åˆ é™¤è¿™ä¸ªçº¦æŸã€‚</li>
<li>é€‰æ‹©æœ€ç»ˆä¿ç•™ä¸‹æ¥çš„å€™é€‰è®¾ç½®ï¼Œè¿™ä¸ªå€™é€‰è®¾ç½®å¿…é¡»ï¼ˆMUSTï¼‰æ˜¯åŒ¹é…è·ç¦»æœ€å°çš„å€™é€‰è®¾ç½®ä¹‹ä¸€ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3b71b168fca4f7c9aa9583c1976788c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=z0dxwwcAeZeS0mIvVL4dpI6hxeg%3D" alt="" loading="lazy"/></p>
<p>W3C è‰æ¡ˆä¹Ÿå®šä¹‰äº†è®¡ç®—åŒ¹é…è·ç¦»ï¼ˆfitness distanceï¼‰çš„ç®—æ³•ï¼Œå…·ä½“å¦‚ä¸‹å›¾ã€‚</p>
<p>ç®—æ³•çš„è¾“å…¥æ˜¯ä¸€ä¸ªå€™é€‰è®¾ç½® Setting ä¸ä¸€ä¸ªçº¦æŸ CSã€‚</p>
<ol>
<li>éå†çº¦æŸä¸­çš„çº¦æŸåç§°ï¼ˆConstraintName, nameï¼‰ä¸çº¦æŸå€¼ï¼ˆConstraintValue, valueï¼‰ã€‚</li>
<li>å¯¹æ¯ä¸€ä¸ª nameï¼Œåšå›¾ä¸­çš„å„ç§åˆ¤æ–­ï¼Œè®¡ç®—å‡ºæ¯ä¸ª name å¯¹åº”çš„åˆ†æ•°ã€‚</li>
<li>æœ€ç»ˆæ±‚å’Œå¾—åˆ°æœ€ç»ˆåˆ†æ•°ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca2c9784203b41098cc91bb0f5de4d3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=BqLeMozvR1B1FITQXBaszx0mh8Y%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">W3C è‰æ¡ˆä¸­çš„ <code>getUserMedia</code> æ–¹æ³•</h3>
<p>ç»“åˆä¸Šæ–‡æˆ‘ä»¬äº†è§£åˆ°ï¼Œ<code>getUserMedia</code> éœ€è¦å¤„ç†çº¦æŸå’Œèƒ½åŠ›çš„åŒ¹é…ï¼Œç”Ÿæˆä¸€å¥—ç¬¦åˆè¦æ±‚çš„è®¾ç½®ï¼Œæ ¹æ®è®¾ç½®ç”Ÿæˆåª’ä½“æµã€‚å› æ­¤ <code>getUserMedia</code> æ–¹æ³•çš„æ ¸å¿ƒä¸ºä¸Šæ–‡æåˆ°çš„åŒ¹é…çº¦æŸçš„ç®—æ³•ã€‚</p>
<p>ä½† W3C è‰æ¡ˆè€ƒè™‘åˆ°éšç§ä¸å®‰å…¨é—®é¢˜ï¼Œå®šä¹‰äº†å¤šç§éœ€è¦æŠ›å‡ºé”™è¯¯çš„æƒ…å†µï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒä¸‹å›¾ã€‚ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p>
<ol>
<li>é‡‡é›†æµç¨‹éœ€è¦å¾—åˆ°ç”¨æˆ·çš„æˆæƒã€‚å½“æ²¡æœ‰è¢«æ‹’ç»æ—¶ï¼Œä¼šåœ¨å®Œæˆçº¦æŸåŒ¹é…åå†å¼¹çª—ç”³è¯·æƒé™ã€‚è€Œåœ¨è¢«æ‹’ç»æ—¶ä¼šç›´æ¥è·³è¿‡çº¦æŸåŒ¹é…æµç¨‹ã€‚</li>
<li>é‡‡é›†æµç¨‹éœ€è¦é¡µé¢å¤„äº active / in view / focued ç­‰æ´»è·ƒçŠ¶æ€ã€‚ä»è€Œé™åˆ¶äº†æ¶æ„ä»£ç åœ¨æœªç»ç”¨æˆ·åŒæ„æ—¶é™é»˜æ‰“å¼€æ‘„åƒå¤´æˆ–è€…éº¦å…‹é£ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d451b190f9a47938b6bfee733e6b523~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=3xvnS6FrqeFJacQxWHWqID1fQJk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-10">Chromium å¤šè¿›ç¨‹æ¶æ„</h2>
<blockquote>
<p>ä»¥ä¸‹å†…å®¹æ¥è‡ªä¸ªäººé˜…è¯» Chromium æ–‡æ¡£å’Œä»£ç çš„æ€»ç»“ï¼Œå¯èƒ½å­˜åœ¨é”™è¯¯å’Œç¼ºæ¼ï¼Œæ¬¢è¿æ–§æ­£ã€‚</p>
</blockquote>
<p>åœ¨ä¸Šæ–‡ä¸­ä»‹ç»äº† W3C Media Capture and Streams è‰æ¡ˆçš„ä¸€äº›é‡è¦æ¦‚å¿µã€‚ä¹Ÿä»‹ç»äº†è‰æ¡ˆä¸­å¯¹ <code>getUserMedia</code> æ–¹æ³•çš„æè¿°ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½åº”è¯¥ä¸¥æ ¼éµå®ˆè¿™ä¸ªæ ‡å‡†è‰æ¡ˆã€‚ä½†åœ¨å®è·µä¸­ï¼Œéƒ¨åˆ†æµè§ˆå™¨å¯èƒ½å¤„äºå¤šæ–¹æƒè¡¡ï¼Œæ€»ä¼šä¸è¿™ä»½è‰æ¡ˆå­˜åœ¨ä¸€å®šçš„åå·®ã€‚æœ¬æ–‡ä»¥ Chrome çš„å¼€æºé¡¹ç›®ï¼šChromium ä¸ºä¾‹ï¼Œç®€å•äº†è§£æµè§ˆå™¨æ˜¯å¦‚ä½•å®ç° <code>getUserMedia</code> æ¥å£çš„ã€‚</p>
<p>åœ¨é˜…è¯»æºç ä¹‹å‰ï¼Œéœ€è¦å¯¹ Chromium é¡¹ç›®æœ‰ä¸€äº›æ•´ä½“è®¤çŸ¥ã€‚è¿™äº›çŸ¥è¯†æœ‰åŠ©äºé™ä½é˜…è¯»éš¾åº¦ã€‚</p>
<h3 data-id="heading-11">å¤šè¿›ç¨‹æ¶æ„</h3>
<blockquote>
<p>æ­£å¦‚ç°ä»£æ“ä½œç³»ç»Ÿä¸€æ ·ï¼Œä½¿ç”¨å¤šä¸ªè¿›ç¨‹å°†åº”ç”¨åˆ†ç¦»ï¼Œä»è€Œæé«˜å¥å£®æ€§ã€‚Chromium æ¶æ„çš„ç›®æ ‡ä¹Ÿæ˜¯ä¸ºäº†è¿™ç§æ›´å¥å£®çš„è®¾è®¡ã€‚</p>
</blockquote>
<p>Chromium ä½¿ç”¨å¤šè¿›ç¨‹ç»“æ„ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ä¸ªå¥½å¤„ã€‚</p>
<ol>
<li>å¯ä»¥é˜²æ­¢å•ä¸ªè¿›ç¨‹çš„æ„å¤–é”™è¯¯ç ´åæ•´ä¸ªç¨‹åºã€‚</li>
<li>å¯ä»¥éš”ç¦»å•ä¸ªè¿›ç¨‹ï¼Œæ§åˆ¶å…¶è®¿é—®èŒƒå›´ã€‚</li>
</ol>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/157fc28d54de45fb9900a8565f843e79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=94%2Fs9ypqsKxwSyldLVfVNpW5xv4%3D" alt="" loading="lazy"/></p>
<ul>
<li>Browser è¿›ç¨‹ï¼šä¹Ÿè¢«è§†ä¸ºä¸»è¿›ç¨‹ã€‚Browser è¿›ç¨‹è´Ÿè´£æ¸²æŸ“ UIã€ç®¡ç†å…¶ä»– renderer è¿›ç¨‹ã€æ¥ç®¡ renderer è¿›ç¨‹ä¸­å¯¹äºæ“ä½œç³»ç»Ÿçš„è°ƒç”¨ç­‰åŠŸèƒ½ã€‚</li>
<li>Renderer è¿›ç¨‹ï¼šç”¨æ¥å¤„ç†ç½‘é¡µå†…å®¹ï¼Œè¿™éƒ¨åˆ†é€šå¸¸åŒ…å« Blinkã€V8 ç­‰å¼•æ“ã€‚</li>
</ul>
<p>æ­¤å¤–ï¼Œéšç€æµè§ˆå™¨å¤æ‚ç¨‹åº¦çš„æé«˜ï¼Œbrowser è¿›ç¨‹çš„æ‰€è´Ÿè´£çš„å·¥ä½œå°†ä¼šæ„ˆå‘è‡ƒè‚¿ã€‚å› æ­¤å½“å‰å¾ˆå¤šå·¥ä½œä» browser è¿›ç¨‹ä¸­åˆ†ç¦»ï¼Œä»¥ service çš„å½¢å¼æä¾›ç»™ browser è¿›ç¨‹æˆ– renderer è¿›ç¨‹ã€‚ä¸»è¦çš„ service éƒ½åˆ—ä¸¾åœ¨æœ€é¡¶å±‚çš„ <code>//services</code> ç›®å½•ä¸‹ã€‚</p>
<ul>
<li>audio: ä¸»è¦ç”¨äºå¤„ç†éŸ³é¢‘é‡‡é›†ç›¸å…³åŠŸèƒ½</li>
<li>video_capture: ä¸»è¦ç”¨äºå¤„ç†è§†é¢‘é‡‡é›†ç›¸å…³åŠŸèƒ½</li>
<li>webnn: ç”¨äºå®ç° Web Neural Network API çš„æœåŠ¡ã€‚ä¸»è¦é€šè¿‡è°ƒç”¨æ“ä½œç³»ç»Ÿçš„ç¡¬ä»¶åŠ é€Ÿæœºå™¨å­¦ä¹  API æ¥å®ç°å¯¹åº”åŠŸèƒ½ã€‚</li>
</ul>
<h3 data-id="heading-12">è·¨è¿›ç¨‹é€šä¿¡ - Mojo</h3>
<p>Mojo æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ IPC æ¡†æ¶ï¼Œå®ƒè¯ç”Ÿäº chromium ï¼Œç”¨æ¥å®ç° chromium è¿›ç¨‹å†…/è¿›ç¨‹é—´çš„é€šä¿¡ã€‚ä¸»è¦æä¾›ä¸‰ä¸ª IPC é€šä¿¡æœºåˆ¶ï¼šMessagePipeï¼ŒDataPipe å’Œ SharedBufferã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/64a9951e6aff4616b4d07e1120547723~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=G1FqTgZ7%2BqZgz%2FXN%2B9FgphvHs0U%3D" alt="" loading="lazy"/></p>
<ul>
<li>MessagePipe: ç”¨äºè¿›ç¨‹é—´çš„åŒå‘é€šä¿¡ã€‚åº•å±‚ä½¿ç”¨ Channel é€šé“ã€‚</li>
<li>DataPipe: ç”¨äºè¿›ç¨‹é—´çš„å•å‘ æ•°æ®å— ä¼ é€’ã€‚åº•å±‚ä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„ Shared Memoryã€‚</li>
<li>SharedBuffer: ç”¨æˆ·è¿›ç¨‹é—´çš„åŒå‘æ•°æ®å—ä¼ é€’ã€‚åº•å±‚ä¹Ÿæ˜¯ Shared Memoryã€‚</li>
</ul>
<p>Mojo çš„åœ¨ä½¿ç”¨ä¸­çš„æœ€å¤§ç‰¹ç‚¹æ˜¯æä¾›ä¸€å¥—æ–¹ä¾¿çš„ç»‘å®šæ¥å£ã€‚å¯ä»¥é€šè¿‡åˆ›å»º .mojom æ–‡ä»¶å®Œæˆæ¥å£å®šä¹‰ï¼Œç”± BUILD.gn ä¸­å¢åŠ å¯¹åº”çš„ç¼–è¯‘ä»£ç å°±å¯ä»¥ç”Ÿæˆæºä»£ç æ–‡ä»¶ã€‚ï¼ˆè¿™äº›æºä»£ç æ–‡ä»¶ä¹Ÿæ˜¯ä½¿ Chromium æºç è·³è½¬è¾ƒä¸ºå›°éš¾çš„åŸå› ï¼‰ã€‚</p>
<h3 data-id="heading-13">è·¨çº¿ç¨‹é€šä¿¡ - ä»»åŠ¡é˜Ÿåˆ—</h3>
<p>Chromium åœ¨ä»£ç ä¸­å¤§é‡ä½¿ç”¨ä»»åŠ¡é˜Ÿåˆ—æ¥æé«˜å¹¶å‘èƒ½åŠ›ï¼Œä½†åœ¨ä¸åŒåœºæ™¯ä¸­å¯¹äºä»»åŠ¡é˜Ÿåˆ—çš„è¦æ±‚å„æœ‰ä¸åŒã€‚Chromium åœ¨è¿™é‡Œè®¾è®¡äº†å¤šç§ä»»åŠ¡é˜Ÿåˆ—æ»¡è¶³ä¸åŒéœ€æ±‚ã€‚</p>
<ul>
<li>TaskRunnerï¼šæ™®é€šçš„ä»»åŠ¡é˜Ÿåˆ—ã€‚ä½¿ç”¨çº¿ç¨‹æ± æ¶ˆè´¹ä»»åŠ¡ï¼Œä¸ä¿è¯ä»»åŠ¡æ‰§è¡Œé¡ºåºã€‚</li>
<li>SequencedTaskRunner: é¢å¤–ä¿è¯ä»»åŠ¡æ‰§è¡Œé¡ºåºçš„é˜Ÿåˆ—ã€‚éµå¾ªå…ˆå…¥å…ˆå‡ºåŸåˆ™ï¼Œä½†ä¸ä¿è¯ä»»åŠ¡åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œã€‚</li>
<li>SingleThreadTaskRunner: é¢å¤–ä¿è¯åœ¨åŒä¸€çº¿ç¨‹æ‰§è¡Œçš„æœ‰åºé˜Ÿåˆ—ã€‚</li>
</ul>
<h2 data-id="heading-14">å¦‚ä½•è·å–ã€é˜…è¯» Chromium æºç </h2>
<h3 data-id="heading-15">å¦‚ä½•è·å–å¹¶ç¼–è¯‘ Chromium</h3>
<p>Chromium å¼€æºé¡¹ç›®æä¾›çš„éå¸¸å®Œæ•´çš„å·¥å…·é“¾å’Œæ–‡æ¡£ï¼Œå¦‚æœä½ çš„ç½‘ç»œæƒ…å†µè¾ƒå¥½ã€å­˜å‚¨ç©ºé—´è¾ƒå……è¶³ã€è®¾å¤‡æ€§èƒ½è¾ƒå¥½ï¼Œå¯ä»¥å°è¯•è‡ªå·±ç¼–è¯‘ Chromiumã€‚åªéœ€è¦å‚è€ƒå®˜ç½‘æ–‡æ¡£å³å¯ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.chromium.org%2Fdevelopers%2Fhow-tos%2Fget-the-code%2F" target="_blank" title="https://www.chromium.org/developers/how-tos/get-the-code/" ref="nofollow noopener noreferrer">www.chromium.org/developers/â€¦</a></p>
<p>ä¸»è¦æ³¨æ„çš„æ˜¯ï¼ŒChromium å®Œæ•´ git å†å²+ æºç  + ä¸€æ¬¡å…¨é‡ç¼–è¯‘çš„äº§ç‰©å¤§çº¦ 200 GBã€‚å¦‚æœæƒ³å‡å°‘å¯¹å­˜å‚¨ç©ºé—´çš„å ç”¨ï¼Œå¯ä»¥è€ƒè™‘ shallow fetch ç­‰æ–¹å¼å‡å°‘ git å†å²æ–‡ä»¶çš„å¤§å°ã€‚</p>
<h3 data-id="heading-16">å¦‚ä½•é˜…è¯»</h3>
<h4 data-id="heading-17">åœ¨çº¿é˜…è¯»</h4>
<p>å¦‚æœä½ æ˜¯å¦æœ‰ä¸‹è½½æºç ï¼Œéƒ½æ¨èé€‰æ‹©åœ¨çº¿é˜…è¯» Chromium ä»£ç ã€‚åœ¨çº¿ç‰ˆæœ¬ Chromium ä»£ç ä¸ä»…åŠ è½½éå¸¸å¿«ï¼Œè€Œä¸”è¿˜æœ‰éå¸¸å®Œå–„çš„å¼•ç”¨è°ƒç”¨æŸ¥æ‰¾åŠŸèƒ½ã€‚é™¤äº†æ²¡åŠæ³•è°ƒæ•´å­—ä½“å¤–è¿˜æ˜¯éå¸¸å®ç”¨çš„ã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fsource.chromium.org%2Fchromium%2Fchromium%2Fsrc" target="_blank" title="https://source.chromium.org/chromium/chromium/src" ref="nofollow noopener noreferrer">source.chromium.org/chromium/châ€¦</a></p>
<p>å¦‚æœä½ æ‰§å¿µæƒ³ä½¿ç”¨æœ¬åœ°ä»£ç é˜…è¯»ï¼Œé‚£ä¹ˆä½ è¿˜è¦è‡³å°‘è¿›è¡Œä»¥ä¸‹å‡ ä¸ªæ­¥éª¤æ‰èƒ½æ„‰å¿«åœ°å¼€å§‹ç¬¦å·è·³è½¬ã€‚</p>
<h4 data-id="heading-18">å¦‚æœä½ ä½¿ç”¨ Visual Studio Code</h4>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fchromium.googlesource.com%2Fchromium%2Fsrc.git%2F%2B%2FHEAD%2Fdocs%2Fclangd.md" target="_blank" title="https://chromium.googlesource.com/chromium/src.git/+/HEAD/docs/clangd.md" ref="nofollow noopener noreferrer">chromium.googlesource.com/chromium/srâ€¦</a></p>
</blockquote>
<p>ä½¿ç”¨ VSCode çš„è¯ï¼Œéœ€è¦ä¾èµ–äº clangd æ’ä»¶ã€‚ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ã€‚</p>
<ol>
<li>å®Œæ•´ç¼–è¯‘ Chromium</li>
<li>ç”Ÿæˆ compile_commands.json æ–‡ä»¶ã€‚å…¶ä¸­ <code>out/Default</code> ä¸ºç¼–è¯‘äº§ç‰©æ‰€åœ¨ä½ç½®ã€‚</li>
</ol>

<pre><code class="hljs language-sql" lang="sql">tools<span class="hljs-operator">/</span>clang<span class="hljs-operator">/</span>scripts<span class="hljs-operator">/</span>generate_compdb.py <span class="hljs-operator">-</span>p <span class="hljs-keyword">out</span><span class="hljs-operator">/</span><span class="hljs-keyword">Default</span> <span class="hljs-operator">&gt;</span> compile_commands.json
</code></pre>
<p>3.  å¼€å§‹ç´¢å¼•ã€‚åå°ç´¢å¼•é€šå¸¸æ˜¯è‡ªåŠ¨å¼€å§‹çš„ã€‚ç´¢å¼•è€—æ—¶ä¸è®¾å¤‡æ€§èƒ½é«˜åº¦ç›¸å…³ï¼Œå¯èƒ½åœ¨ 2 å°æ—¶ï¼ˆMacBook Pro, M2 proï¼‰è‡³ 7 å°æ—¶ï¼ˆMacBook Air, M2ï¼‰ä¸ç­‰ã€‚</p>
<p>clangd æœ‰æ—¶ä¼šå› ä¸ºå•ä¸€æ–‡ä»¶å‡ºç°å¤§é‡æŠ¥é”™ï¼Œè€Œåœæ­¢åˆ†æã€‚å¯ä»¥é€šè¿‡é…ç½® .clangd æ–‡ä»¶æé«˜é”™è¯¯æ•°é‡ä¸Šçº¿ï¼Œä»è€Œå¾—åˆ°æ›´å¤šæ–‡ä»¶åˆ†æç»“æœã€‚</p>
<pre><code class="hljs language-ini" lang="ini">CompileFlags:
  Add: <span class="hljs-attr">-ferror-limit</span>=<span class="hljs-number">100</span>
</code></pre>
<h4 data-id="heading-19">å¦‚æœä½ ä½¿ç”¨ JetBrains CLion</h4>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fchromium.googlesource.com%2Fchromium%2Fsrc.git%2F%2B%2FHEAD%2Fdocs%2Fclion.md" target="_blank" title="https://chromium.googlesource.com/chromium/src.git/+/HEAD/docs/clion.md" ref="nofollow noopener noreferrer">chromium.googlesource.com/chromium/srâ€¦</a></p>
</blockquote>
<p>CLion ä¾èµ–äº CMake è¿›è¡Œè¯­æ³•åˆ†æï¼Œæ‰€ä»¥éœ€è¦æ­£ç¡®é…ç½® CMakeLists.txt ã€‚CMakeLists.txt æ–‡ä»¶éœ€è¦ä¸ src æ–‡ä»¶å¤¹åœ¨åŒä¸€ç›®å½•ã€‚æ–‡ä»¶å†…å®¹å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-css" lang="css">.
â”œâ”€â”€ CMakeLists<span class="hljs-selector-class">.txt</span>
â””â”€â”€ <span class="hljs-attribute">src</span>
</code></pre>
<pre><code class="hljs language-make" lang="make">cmake_minimum_required(VERSION 3.10)
project(chromium)

set(CMAKE_CXX_STANDARD 14)

include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src)
include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/out/Default/gen)
include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/third_party/protobuf/src)
include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/third_party/googletest/src/googletest/<span class="hljs-keyword">include</span>)
include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/third_party/googletest/src/googlemock/<span class="hljs-keyword">include</span>)
include_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/third_party/abseil-cpp)

<span class="hljs-comment"># The following file used is irrelevant, it's only to improve CLion</span>
<span class="hljs-comment"># performance. Leaving at least 1 file is required in order for CLion</span>
<span class="hljs-comment"># to provide code completion, navigation, etc.</span>
add_executable(chromium src/components/omnibox/browser/document_provider.cc)
</code></pre>
<h3 data-id="heading-20">å¦‚ä½•è·å–æ—¥å¿—</h3>
<pre><code class="hljs language-bash" lang="bash">currentTime=`<span class="hljs-built_in">date</span> <span class="hljs-string">"+%Y%m%d_%H%M%S"</span>`
filePath=<span class="hljs-variable">${HOME}</span>/chrome_debug_<span class="hljs-variable">${currentTime}</span>.<span class="hljs-built_in">log</span>
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --enable-logging --v=1 --log-file=<span class="hljs-variable">${filePath}</span> &amp;
<span class="hljs-built_in">sleep</span> 1
open -a Console <span class="hljs-variable">${filePath}</span>
</code></pre>
<p>ä»¥ä¸Šæ–¹æ³•å¯ä»¥åœ¨ macOS ä¸Šè·å–æ—¥å¿—ï¼Œæ—¥å¿—å­˜æ”¾äºç”¨æˆ·ç›®å½•ä¸‹ã€‚é€šå¸¸æ­£å¼å‘å¸ƒç‰ˆæœ¬çš„ Chrome åªèƒ½è·å– VERBOSE1 çº§åˆ«çš„æ—¥å¿—ï¼Œè€Œä¸”ä¸åŒ…å«ä»£ç ä¸­çš„å„é¡¹æ–­è¨€æ£€æŸ¥ã€‚</p>
<h2 data-id="heading-21">Chromium ä¸­çš„ getUserMedia</h2>
<h3 data-id="heading-22">Chromium getUserMedia éŸ³é¢‘æµç¨‹å›¾</h3>
<p>Chromium çš„éº¦å…‹é£éŸ³é¢‘é‡‡é›†ä¸»è¦åŒ…å«è·å–è®¾å¤‡èƒ½åŠ›ã€æ£€æŸ¥è®¾å¤‡çº¦æŸã€åˆ›å»º Streamã€åˆ›å»º Trackã€å¯åŠ¨ Track è¿™å‡ ä¸ªæ­¥éª¤ã€‚è‡³å°‘æ¶‰åŠåˆ°ä¸‰ä¸ªè¿›ç¨‹é—´çš„é€šä¿¡ï¼ŒåŒ…å«è‡³å°‘å››ä¸ªæ¨¡å—ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d5bdada5617847f695bb87dbacace35d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=5o%2FiWA0bAVNFLpGOYFISAMsmelE%3D" alt="" loading="lazy"/></p>
<ul>
<li>renderer è¿›ç¨‹ï¼šä¸»è¦é€šè¿‡ UserMediaProcessor å¯¹è±¡æµè½¬ UserMediaRequest ä¸­çš„çŠ¶æ€ï¼Œä¸»è¦å®ç°å„ç§æ£€æŸ¥åŠŸèƒ½ã€‚</li>
<li>browser è¿›ç¨‹ï¼šä¸»è¦é€šè¿‡ MediaStreamManager å¯¹è±¡ç®¡ç†æ‰€æœ‰åª’ä½“æµã€‚</li>
<li>audio è¿›ç¨‹ï¼šä¸»è¦ä½œä¸ºæ“ä½œç³»ç»Ÿ API çš„é€‚é…å±‚ï¼Œè°ƒç”¨æ“ä½œç³»ç»Ÿæä¾›çš„éŸ³é¢‘æ¥å£ã€‚</li>
</ul>
<h3 data-id="heading-23">ä¸»è¦æ¨¡å—çš„æµè½¬</h3>
<h4 data-id="heading-24">UserMediaProcessor</h4>
<blockquote>
<p>ä½äº third_party/blink/renderer/modules/mediastream/user_media_processor.cc</p>
</blockquote>
<p>è¯¥æ¨¡å—ä½äº renderer è¿›ç¨‹ä¸­ï¼Œä¸»è¦ç”¨äºå¤„ç† getUserMedia è¯·æ±‚ã€‚</p>
<ul>
<li>æ¯æ¬¡åªèƒ½åˆ›å»ºä¸€ä¸ª MediaStream</li>
<li>åœ¨å„ä¸ªå‡½æ•°ä¸­æµè½¬ UserMediaRequest å¯¹è±¡ï¼Œä»¥é˜Ÿåˆ—æ–¹å¼å¤„ç†ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e042520dcb2947ee841dff68d9c26e82~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=7UVJf84LV5aacZiOaeObAu90b7M%3D" alt="" loading="lazy"/></p>
<h4 data-id="heading-25">Chromium ä¸­çš„ SelectSetting ç®—æ³•</h4>
<blockquote>
<p>ä½äº third_party/blink/renderer/modules/mediastream/media_stream_constraints_util_audio.cc</p>
</blockquote>
<p>å¯ä»¥å‘ç°è¿™æ®µä»£ç åŸºæœ¬ç¬¦åˆ W3C è‰æ¡ˆä¸­çš„ SelectSetting ç®—æ³•ã€‚åŒ…å«å…ˆå¤„ç†åŸºæœ¬çº¦æŸï¼ˆç»¿è‰²åŒºåŸŸï¼‰ï¼Œå†å¤„ç†è¿›é˜¶çº¦æŸï¼ˆæ©™è‰²åŒºåŸŸï¼‰ã€‚ä½†æ¯”è¾ƒæ˜¾è‘—çš„æ˜¯ï¼ŒChromium å¿½ç•¥äº†ä¸åŒ setting çš„åŒ¹é…è·ç¦»éƒ¨åˆ†ï¼ˆç´«è‰²åŒºåŸŸï¼‰ã€‚</p>
<pre><code class="hljs language-c++" lang="c++">    <span class="hljs-function">AudioCaptureSettings <span class="hljs-title">SelectSettingsAudioCapture</span><span class="hljs-params">(
        <span class="hljs-type">const</span> AudioDeviceCaptureCapabilities&amp; capabilities,
        <span class="hljs-type">const</span> MediaConstraints&amp; constraints,
        mojom::blink::MediaStreamType stream_type,
        <span class="hljs-type">bool</span> should_disable_hardware_noise_suppression,
        <span class="hljs-type">bool</span> is_reconfiguration_allowed)</span> </span>{
      <span class="hljs-keyword">if</span> (capabilities.<span class="hljs-built_in">empty</span>())
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">AudioCaptureSettings</span>();

      std::string media_stream_source = <span class="hljs-built_in">GetMediaStreamSource</span>(constraints);
      std::string default_device_id;
      <span class="hljs-type">bool</span> is_device_capture = media_stream_source.<span class="hljs-built_in">empty</span>();
      <span class="hljs-keyword">if</span> (is_device_capture)
        default_device_id = capabilities.<span class="hljs-built_in">begin</span>()-&gt;<span class="hljs-built_in">DeviceID</span>().<span class="hljs-built_in">Utf8</span>();

      <span class="hljs-function">CandidatesContainer <span class="hljs-title">candidates</span><span class="hljs-params">(capabilities, stream_type, media_stream_source,
                                     default_device_id, is_reconfiguration_allowed)</span></span>;
      <span class="hljs-built_in">DCHECK</span>(!candidates.<span class="hljs-built_in">IsEmpty</span>());

      <span class="hljs-keyword">auto</span>* failed_constraint_name =
          candidates.<span class="hljs-built_in">ApplyConstraintSet</span>(constraints.<span class="hljs-built_in">Basic</span>());
      <span class="hljs-keyword">if</span> (failed_constraint_name)
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">AudioCaptureSettings</span>(failed_constraint_name);

      <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; advanced_set : constraints.<span class="hljs-built_in">Advanced</span>()) {
        CandidatesContainer copy = candidates;
        failed_constraint_name = candidates.<span class="hljs-built_in">ApplyConstraintSet</span>(advanced_set);
        <span class="hljs-keyword">if</span> (failed_constraint_name)
          candidates = std::<span class="hljs-built_in">move</span>(copy);
      }
      <span class="hljs-built_in">DCHECK</span>(!candidates.<span class="hljs-built_in">IsEmpty</span>());

      <span class="hljs-comment">// Score is ignored as it is no longer needed.</span>
      AudioCaptureSettings settings;
      std::<span class="hljs-built_in">tie</span>(std::ignore, settings) = candidates.<span class="hljs-built_in">SelectSettingsAndScore</span>(
          constraints.<span class="hljs-built_in">Basic</span>(),
          media_stream_source == blink::kMediaStreamSourceDesktop,
          should_disable_hardware_noise_suppression);

      <span class="hljs-keyword">return</span> settings;
    }
</code></pre>
<p>è§‚å¯Ÿ <code>ApplyConstraintSet</code> å‡½æ•°ï¼Œè¿™é‡ŒåŸºæœ¬ä¸Šå¯¹åº” W3C è‰æ¡ˆä¸­çš„ fitness_distance çš„éƒ¨åˆ†ã€‚å¯ä»¥å‘ç°å…¶å® Chromium å®Œå…¨æ²¡æœ‰å‚è€ƒè‰æ¡ˆä¸­çš„æµç¨‹ã€‚ä»£ç å°†çº¦æŸåˆ†ä¸ºå››ç±»ï¼šdeviceIdã€groupIdã€number ä¸ booleanã€processing_basedã€‚å…¶ä¸­ processing_based è¡¨ç¤ºéœ€è¦ä½¿ç”¨ WebRTC æ¨¡å—æä¾›çš„éŸ³é¢‘å¤„ç†åŠŸèƒ½çš„çº¦æŸã€‚</p>
<p>è¿™ç§è®¡ç®—æ–¹å¼æ˜¾ç„¶ä¹Ÿæ²¡åŠæ³•å¾—å‡ºä¸€ä¸ªåˆ†æ•°ï¼Œå› æ­¤åœ¨ <code>SelectSettingsAudioCapture</code> å‡½æ•°çš„æ³¨é‡Šä¸­ï¼Œä¹Ÿæ˜æ˜¾è¡¨ç¤ºå› ä¸ºä¸å†éœ€è¦ scoreï¼Œæ‰€ä»¥å°† score å¿½ç•¥ã€‚</p>
<pre><code class="hljs language-c++" lang="c++">    <span class="hljs-comment">// class DeviceContainer</span>
      <span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">char</span>* <span class="hljs-title">ApplyConstraintSet</span><span class="hljs-params">(<span class="hljs-type">const</span> ConstraintSet&amp; constraint_set)</span> </span>{
        <span class="hljs-type">const</span> <span class="hljs-type">char</span>* failed_constraint_name;

        failed_constraint_name =
            device_id_container_.<span class="hljs-built_in">ApplyConstraintSet</span>(constraint_set.device_id);
        <span class="hljs-keyword">if</span> (failed_constraint_name)
          <span class="hljs-keyword">return</span> failed_constraint_name;

        failed_constraint_name =
            group_id_container_.<span class="hljs-built_in">ApplyConstraintSet</span>(constraint_set.group_id);
        <span class="hljs-keyword">if</span> (failed_constraint_name)
          <span class="hljs-keyword">return</span> failed_constraint_name;

        <span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; kNumBooleanContainerIds; ++i) {
          <span class="hljs-keyword">auto</span>&amp; info = kBooleanPropertyContainerInfoMap[i];
          failed_constraint_name =
              boolean_containers_[info.index].<span class="hljs-built_in">ApplyConstraintSet</span>(
                  constraint_set.*(info.constraint_member));
          <span class="hljs-keyword">if</span> (failed_constraint_name)
            <span class="hljs-keyword">return</span> failed_constraint_name;
        }

        <span class="hljs-comment">// For each processing based container, apply the constraints and only fail</span>
        <span class="hljs-comment">// if all of them failed.</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">auto</span> it = processing_based_containers_.<span class="hljs-built_in">begin</span>();
             it != processing_based_containers_.<span class="hljs-built_in">end</span>();) {
          <span class="hljs-built_in">DCHECK</span>(!it-&gt;<span class="hljs-built_in">IsEmpty</span>());
          failed_constraint_name = it-&gt;<span class="hljs-built_in">ApplyConstraintSet</span>(constraint_set);
          <span class="hljs-keyword">if</span> (failed_constraint_name)
            it = processing_based_containers_.<span class="hljs-built_in">erase</span>(it);
          <span class="hljs-keyword">else</span>
            ++it;
        }
        <span class="hljs-keyword">if</span> (processing_based_containers_.<span class="hljs-built_in">empty</span>()) {
          <span class="hljs-built_in">DCHECK_NE</span>(failed_constraint_name, <span class="hljs-literal">nullptr</span>);
          <span class="hljs-keyword">return</span> failed_constraint_name;
        }

        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
      }
</code></pre>
<h4 data-id="heading-26">MediaStreamManager</h4>
<blockquote>
<p>ä½äº content/browser/renderer_host/media/media_stream_manager.cc</p>
</blockquote>
<p>è¯¥æ¨¡å—ä½äº browser è¿›ç¨‹ä¸­ï¼Œä¸»è¦ç”¨äºåˆ›å»ºå’Œå…³é—­åª’ä½“è®¾å¤‡ï¼Œç®¡ç† MediaStreamã€‚</p>
<ul>
<li>åœ¨å„ä¸ªå‡½æ•°ä¸­æµè½¬ DeviceRequest å¯¹è±¡</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ca2414bcc064da6b5cdea37618d4aec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=gKPPeRzhc0XzmxzZPgK8mLm1R4c%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-27">ä½¿ç”¨è¿™äº› API å¯ä»¥åšåˆ°ä»€ä¹ˆ</h2>
<p>Media Capture and Streams API ä¸»è¦æ”¯æŒäº†é‡‡é›†ç”¨æˆ·éŸ³è§†é¢‘æµçš„åŠŸèƒ½ã€‚ç»“åˆå…¶ä»– Web API å¯ä»¥å®ç°å¤šç§åŠŸèƒ½ã€‚</p>
<ul>
<li>ç»“åˆ WebRTC APIï¼Œå¯ä»¥å°†æ‘„åƒå¤´æµå’ŒéŸ³é¢‘æµå‘é€å…¶ä»–ç”¨æˆ·ï¼Œå®ç°å®æ—¶ä¼šè®®ç­‰åŠŸèƒ½ã€‚</li>
<li>ç»“åˆ WebAudio APIï¼Œå¯ä»¥å°†éŸ³é¢‘æµè¿›è¡Œå¤„ç†ï¼Œå®ç°å„ç§æ··éŸ³æ•ˆæœã€‚</li>
</ul>
<p>ä¸‹é¢ä»¥æ‹ç…§åŠŸèƒ½ä¸ºä¾‹ï¼Œç®€å•ä»‹ç»ä¸Šè¿° API çš„ä½¿ç”¨æ–¹æ³•ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9c303b794c804193b56be9ef9dac141b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2X6IqC5p625p6E5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769137163&amp;x-signature=ouEfIoT0cMPZLdUBzFpLuiBzwhI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-28">é¢„è§ˆè§†é¢‘æµ</h3>
<p>è¿™éƒ¨åˆ†ä¸ä¸Šæ–‡ç›¸åŒï¼Œéœ€è¦æ‰§è¡Œä¸‰ä¸ªæ­¥éª¤ã€‚è®¾ç½®çº¦æŸã€é‡‡é›†ã€æ’­æ”¾ã€‚å¯ä»¥ç›´æ¥æ²¿ç”¨ä¸Šæ–‡æä¾›çš„ä»£ç ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">previewCamera</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> videoPlayer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"videoPlayer"</span>); <span class="hljs-comment">// &lt;video&gt;</span>
  <span class="hljs-keyword">if</span> (!videoPlayer || !(videoPlayer <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">HTMLVideoElement</span>)) {
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// çº¦æŸ</span>
    <span class="hljs-keyword">const</span> constraints = {
      <span class="hljs-attr">video</span>: {<span class="hljs-attr">width</span>: <span class="hljs-number">640</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">480</span>},
    };
    <span class="hljs-comment">// é‡‡é›†</span>
    <span class="hljs-keyword">const</span> stream = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-title function_">getUserMedia</span>(constraints);
    <span class="hljs-comment">// æ’­æ”¾</span>
    videoPlayer.<span class="hljs-property">srcObject</span> = stream;
    videoPlayer.<span class="hljs-title function_">play</span>();
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
  }
}
</code></pre>
<h3 data-id="heading-29">è·å–å¯ç”¨è®¾å¤‡</h3>
<p>æ­¤å¤„å¯ä»¥ä½¿ç”¨æšä¸¾ç”¨æˆ·è®¾å¤‡æ¥å£å®ç°ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦è°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œè·å–è®¾å¤‡ä¿¡æ¯åˆ—è¡¨ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> devices = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-title function_">enumerateDevices</span>();
</code></pre>
<p>è®¾å¤‡ä¿¡æ¯åˆ—è¡¨ä¸­åŒ…å«è®¾å¤‡åç§°ã€è®¾å¤‡ ID ç­‰ä¿¡æ¯ã€‚è®¾å¤‡åç§°å¯ä»¥ç”¨æ¥ä½œä¸ºç”¨æˆ·å±•ç¤ºï¼Œè®¾å¤‡ ID åˆ™éœ€è¦ä¼ ç»™çº¦æŸæ›´æ–°è§†é¢‘æµã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">reloadDevices</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> selector = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"device-select"</span>);
  <span class="hljs-keyword">if</span> (!selector || !(selector <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">HTMLSelectElement</span>)) {
    <span class="hljs-keyword">return</span>;
  }
  selector.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">""</span>;
  <span class="hljs-comment">// è·å–è®¾å¤‡åˆ—è¡¨</span>
  <span class="hljs-keyword">const</span> devices = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-title function_">enumerateDevices</span>();
  <span class="hljs-comment">// åˆ›å»ºé€‰é¡¹</span>
  devices.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">device</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (device.<span class="hljs-property">kind</span> === <span class="hljs-string">"videoinput"</span>) {
      <span class="hljs-keyword">const</span> option = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"option"</span>);
      option.<span class="hljs-property">value</span> = device.<span class="hljs-property">deviceId</span>;
      option.<span class="hljs-property">text</span> = device.<span class="hljs-property">label</span> || <span class="hljs-string">`Camera <span class="hljs-subst">${selector.length + <span class="hljs-number">1</span>}</span>`</span>;
      selector.<span class="hljs-title function_">appendChild</span>(option);
    }
  });
}
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">previewCamera</span>(<span class="hljs-params">deviceId</span>) {
  <span class="hljs-keyword">const</span> videoPlayer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"videoPlayer"</span>); <span class="hljs-comment">// &lt;video&gt;</span>
  <span class="hljs-keyword">if</span> (!videoPlayer || !(videoPlayer <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">HTMLVideoElement</span>)) {
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-comment">// æ¸…é™¤æ­£åœ¨é¢„è§ˆçš„æµ</span>
  <span class="hljs-keyword">const</span> stream = videoPlayer.<span class="hljs-property">srcObject</span>;
  <span class="hljs-keyword">if</span> (stream <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">MediaStream</span>) {
    stream?.<span class="hljs-title function_">getTracks</span>().<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">track</span>) =&gt;</span> {
      track.<span class="hljs-title function_">stop</span>();
    });
  }
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// çº¦æŸ</span>
    <span class="hljs-keyword">const</span> constraints = {
      <span class="hljs-attr">video</span>: {<span class="hljs-attr">width</span>: <span class="hljs-number">640</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">480</span>},
    };
    <span class="hljs-keyword">if</span> (deviceId) {
      constraints.<span class="hljs-property">video</span>.<span class="hljs-property">deviceId</span> = { <span class="hljs-attr">exact</span>: deviceId };
    }
    <span class="hljs-comment">// é‡‡é›†</span>
    <span class="hljs-keyword">const</span> stream = <span class="hljs-keyword">await</span> navigator.<span class="hljs-property">mediaDevices</span>.<span class="hljs-title function_">getUserMedia</span>(constraints);
    <span class="hljs-comment">// æ’­æ”¾</span>
    videoPlayer.<span class="hljs-property">srcObject</span> = stream;
    videoPlayer.<span class="hljs-title function_">play</span>();
  } <span class="hljs-keyword">catch</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
  }
}
</code></pre>
<h3 data-id="heading-30">æ‹ç…§</h3>
<p>æ‹ç…§çš„éƒ¨åˆ†å¯ä»¥ä½¿ç”¨ Canvas API çš„ <code>drawImage</code> æ¥å£ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"canvas"</span>);
<span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">"2d"</span>);
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">capture</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> videoPlayer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">"videoPlayer"</span>); <span class="hljs-comment">// &lt;video&gt;</span>
  <span class="hljs-keyword">if</span> (!videoPlayer || !(videoPlayer <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">HTMLVideoElement</span>)) {
    <span class="hljs-keyword">return</span>;
  }
  canvas.<span class="hljs-property">width</span> = videoPlayer.<span class="hljs-property">videoWidth</span>;
  canvas.<span class="hljs-property">height</span> = videoPlayer.<span class="hljs-property">videoHeight</span>;
  <span class="hljs-keyword">if</span> (!ctx) {
    <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Canvas 2d Context is not supported'</span>);
  }
  ctx.<span class="hljs-title function_">drawImage</span>(videoPlayer, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);
  <span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">"img"</span>);
  img.<span class="hljs-property">src</span> = canvas.<span class="hljs-title function_">toDataURL</span>(<span class="hljs-string">"image/png"</span>);
  <span class="hljs-keyword">const</span> photoView = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">".photo-view"</span>);
  <span class="hljs-keyword">if</span> (photoView) {
    photoView.<span class="hljs-title function_">appendChild</span>(img);
  }
}
</code></pre>
<h2 data-id="heading-31">æ€»ç»“</h2>
<ol>
<li>W3C æ ‡å‡†é€šå¸¸ä»æ˜“ç”¨æ€§ã€å®‰å…¨æ€§ä¸Šè¿›è¡Œè€ƒé‡ã€‚å¾ˆå¤šåŠŸèƒ½éƒ½ä¼šå°è¯•é¿å…è¢«ç”¨æ¥æ”¶é›†è®¾å¤‡æŒ‡çº¹ã€‚</li>
<li>Chromium å¼€æºé¡¹ç›®æä¾›äº†éå¸¸å®Œå–„çš„å·¥å…·é“¾ã€‚é™¤å»ç½‘ç»œå› ç´ ï¼Œé€šå¸¸å¾ˆå¿«å°±å¯ä»¥å¼€å§‹ç¼–è¯‘ Chromiumã€‚</li>
<li>Chromium å¼€æºé¡¹ç›®ä¸­åŒ…å«å¤§é‡ä¼˜ç§€çš„è®¾è®¡ï¼Œéå¸¸å€¼å¾—å‚è€ƒå’Œå­¦ä¹ ã€‚ä½†åŒæ—¶ï¼Œä½œä¸ºå†å²è¾ƒä¸ºæ‚ ä¹…çš„å¼€æºé¡¹ç›®ï¼Œä»£ç çš„ç»„ç»‡ç»“æ„å’Œå®ç°ä¸å¯é¿å…çš„å­˜åœ¨ä¸€äº›ç‘•ç–µã€‚é€šå¸¸é¡¹ç›®æˆå‘˜ä¹Ÿä¼šè®¤çœŸå¯¹å¾…å„ç§ç±»å‹çš„æäº¤ï¼Œæ‰€ä»¥ä¹Ÿæ¬¢è¿å„ä½å°è¯•å‚ä¸è¿› Chromium å¼€æºé¡¹ç›®ä¸­æ¥ã€‚</li>
</ol>
<h2 data-id="heading-32">ä¸€äº›æ³¨é‡Š</h2>
<ol>
<li>W3C è‰æ¡ˆä¸­é€šå¸¸ä½¿ç”¨ç”¨æˆ·ä»£ç†ï¼ˆUser Agentï¼‰è¿™ä¸ªæ¦‚å¿µã€‚ä¸ºäº†å’Œ <code>navigator.userAgent</code> è¿›è¡ŒåŒºåˆ†ï¼Œæœ¬æ–‡ç»Ÿä¸€ç¿»è¯‘ä¸º â€œæµè§ˆå™¨â€ ã€‚ä½†å®é™…ä¸Šæµè§ˆå™¨åªæ˜¯ä¸€ç§ç”¨æˆ·ä»£ç†ï¼Œä¸‹è½½ç®¡ç†å™¨ã€çˆ¬è™«ç­‰ä¹Ÿå¯ä»¥ç§°ä¸ºæ˜¯ç”¨æˆ·ä»£ç†ã€‚</li>
</ol>
<h2 data-id="heading-33">å‚è€ƒæ–‡çŒ®ä¸èµ„æ–™</h2>
<ol>
<li>W3C Media Capture and Streams è‰æ¡ˆ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3.org%2FTR%2Fmediacapture-streams%2F" target="_blank" title="https://www.w3.org/TR/mediacapture-streams/" ref="nofollow noopener noreferrer">www.w3.org/TR/mediacapâ€¦</a></li>
<li>W3C ç»„ç»‡å…³äº TR çš„è¦æ±‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.w3.org%2Fstandards%2Ftypes%2F%23CRD" target="_blank" title="https://www.w3.org/standards/types/#CRD" ref="nofollow noopener noreferrer">www.w3.org/standards/tâ€¦</a></li>
<li>Chromium å¤šè¿›ç¨‹æ¶æ„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.chromium.org%2Fdevelopers%2Fdesign-documents%2Fmulti-process-architecture%2F" target="_blank" title="https://www.chromium.org/developers/design-documents/multi-process-architecture/" ref="nofollow noopener noreferrer">www.chromium.org/developers/â€¦</a></li>
<li>ä¸€ç¯‡éå¸¸è¯¦ç»†ä»‹ç» mojo çš„åŸç†å’Œä½¿ç”¨æ–¹å¼çš„æ–‡ç«  <a href="https://link.juejin.cn?target=https%3A%2F%2Fkeyou.github.io%2Fblog%2F2020%2F01%2F03%2FChromium-Mojo%26IPC%2F" target="_blank" title="https://keyou.github.io/blog/2020/01/03/Chromium-Mojo&amp;IPC/" ref="nofollow noopener noreferrer">keyou.github.io/blog/2020/0â€¦</a></li>
<li>MDN å…³äºç”¨æˆ·ä»£ç†æ¦‚å¿µçš„è§£é‡Š <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FGlossary%2FUser_agent" target="_blank" title="https://developer.mozilla.org/en-US/docs/Glossary/User_agent" ref="nofollow noopener noreferrer">developer.mozilla.org/en-US/docs/â€¦</a></li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºNettyçš„WebSocketè‡ªåŠ¨è§£å†³æ‹†åŒ…ç²˜åŒ…é—®é¢˜]]></title>    <link>https://juejin.cn/post/7595494087879000115</link>    <guid>https://juejin.cn/post/7595494087879000115</guid>    <pubDate>2026-01-16T02:23:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595494087879000115" data-draft-id="7595492075119788059" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºNettyçš„WebSocketè‡ªåŠ¨è§£å†³æ‹†åŒ…ç²˜åŒ…é—®é¢˜"/> <meta itemprop="keywords" content="åç«¯,Java,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-16T02:23:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SimonKing"/> <meta itemprop="url" content="https://juejin.cn/user/4001878056904584"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºNettyçš„WebSocketè‡ªåŠ¨è§£å†³æ‹†åŒ…ç²˜åŒ…é—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4001878056904584/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SimonKing
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T02:23:38.000Z" title="Fri Jan 16 2026 02:23:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šã€ç¼–ç¨‹æœèŠ±å¤•æ‹¾ã€‘ï¼Œå¯è·å–é¦–å‘å†…å®¹ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd1f6146c66c4974930eb586976bee26~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769135018&amp;x-signature=UJ6NrGaxuJomZKuRLOAp6to1Qi8%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">01 å¼•è¨€</h2>
<p>æˆ‘ä»¬åšäº†<code>Websocket</code>çš„æ¡ˆä¾‹ï¼Œå¹¶æ²¡æœ‰åƒ<code>TCP</code>åè®®ä¸€æ ·å¤„ç†æ‹†åŒ…å’Œç²˜åŒ…é—®é¢˜ã€‚<code>Websocket</code>åŸºäº<code>Frame</code>å·²ç»è‡ªåŠ¨å¸®æˆ‘ä»¬è§£å†³äº†æ‹†åŒ…å’Œç²˜åŒ…é—®é¢˜ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹æ˜¯æ€ä¹ˆè§£å†³çš„ï¼</p>
<h2 data-id="heading-1">02 WebSocketFrame</h2>
<p><code>WebSocketFrame</code>æ˜¯ Netty ä¸­ç”¨äºè¡¨ç¤º <code>WebSocket</code> åè®®æ•°æ®å¸§çš„æŠ½è±¡åŸºç±»ã€‚åœ¨ <code>WebSocket</code> é€šä¿¡ä¸­ï¼Œæ‰€æœ‰æ•°æ®ï¼ˆæ–‡æœ¬ã€äºŒè¿›åˆ¶ã€æ§åˆ¶å¸§ç­‰ï¼‰éƒ½é€šè¿‡å¸§çš„å½¢å¼è¿›è¡Œä¼ è¾“ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f72c1cf960f24096b4f291a88d20f695~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769135018&amp;x-signature=T9ceNMjd92Eh4%2BDt1M1%2F1yp2BIA%3D" alt="" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒå±æ€§</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bffec7866caa4d3eb1c05596f93f0229~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769135018&amp;x-signature=PGNGxzSIyz3V%2B4Go0%2BF9eOIWdoU%3D" alt="" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// å¸§çš„æœ€ç»ˆæ ‡å¿—ä½ï¼ˆFINï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> finalFragment;

<span class="hljs-comment">// ä¿ç•™ä½ï¼ˆRSV1, RSV2, RSV3ï¼‰</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> rsv;
</code></pre>
<p><code>finalFragment</code>å‚æ•°æ˜¯è§£å†³æ‹†åŒ…ç²˜åŒ…çš„å…³é”®æ ‡å¿—ä½ã€‚</p>
<h2 data-id="heading-2">03 å¤„ç†æµç¨‹</h2>
<h3 data-id="heading-3">3.1 è°ƒç”¨é“¾</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22ec68ad7c1b4cef8b7624a47e327bf6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769135018&amp;x-signature=hNqbuQ0v8AFiM5Fyp4lyNiMfLAA%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-4">3.2 è§£ç å…³é”®ç±»</h3>
<p><code>io.netty.handler.codec.http.websocketx.WebSocket08FrameDecoder</code></p>
<p><code>WebSocket</code>åè®®å®šä¹‰äº†æ˜ç¡®çš„å¸§æ ¼å¼ï¼Œæ¯ä¸ªå¸§éƒ½æœ‰æ˜ç¡®çš„è¾¹ç•Œæ ‡è¯†ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/90e8bc5f5f7644339e8d0da30f4f8eba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769135018&amp;x-signature=dJP8YktQrrU0o3KelxMPgwYeVX0%3D" alt="" loading="lazy"/></p>
<p><strong>å…³é”®å­—æ®µï¼š</strong></p>
<ul>
<li><strong>FINä½ï¼ˆ1ä½ï¼‰</strong>ï¼šæ ‡è¯†æ˜¯å¦æ˜¯æ¶ˆæ¯çš„æœ€åä¸€ä¸ªå¸§</li>
<li><strong>opcodeï¼ˆ4ä½ï¼‰</strong>ï¼šæ“ä½œç ï¼Œæ ‡è¯†å¸§ç±»å‹ï¼ˆæ–‡æœ¬ã€äºŒè¿›åˆ¶ã€æ§åˆ¶å¸§ç­‰ï¼‰</li>
<li><strong>MASKä½ï¼ˆ1ä½ï¼‰</strong>ï¼šæ ‡è¯†æ˜¯å¦æ©ç </li>
<li><strong>Payload lengthï¼ˆ7ä½ï¼‰</strong>ï¼šè´Ÿè½½é•¿åº¦ï¼Œè‡ªåŠ¨æ‰©å±•</li>
</ul>
<p>è€Œ<code>WebSocket08FrameDecoder</code>ä¸“é—¨å®šä¹‰äº†è§£æå¸§çš„å­—æ®µã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ecb4699413a445e8ad95c84168cab6f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769135018&amp;x-signature=BXliWt%2FarFiZ93IC6M%2FCrE6AdQ0%3D" alt="" loading="lazy"/></p>
<p>å…¶ä¸­å…³é”®çš„ä»£ç å—ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">byte</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> in.readByte();
frameFinalFlag = (b &amp; <span class="hljs-number">0x80</span>) != <span class="hljs-number">0</span>;
</code></pre>
<p><code>(b &amp; 0x80) != 0</code>æ˜¯ç”¨äºæ£€æµ‹æŸä¸ªå­—èŠ‚ b çš„æœ€é«˜ä½ï¼ˆå³ç¬¬7ä½ï¼Œä»å³å¾€å·¦æ•°ï¼‰æ˜¯å¦ä¸º1ã€‚å¦‚æœä¸º1ï¼Œåˆ™è¿”å›trueï¼Œè¡¨ç¤ºæ•°æ®å·²ç»è¯»å®Œã€‚è¿™é‡Œæ­£æ˜¯è§£å†³æ‹†åŒ…ç²˜åŒ…çš„å…³é”®æ ‡å¿—ä½ã€‚</p>
<h3 data-id="heading-5">3.3 æ•´ä¸ªè§£ææµç¨‹</h3>
<ul>
<li><strong>é•¿åº¦å­—æ®µè§£æ</strong>ï¼šé¦–å…ˆè¯»å–å¸§å¤´éƒ¨ï¼Œè§£æpayloadé•¿åº¦</li>
<li><strong>åŠ¨æ€è¯»å–</strong>ï¼šæ ¹æ®é•¿åº¦å­—æ®µå€¼ï¼Œè¯»å–ç›¸åº”å­—èŠ‚æ•°çš„æ•°æ®</li>
<li><strong>å¸§å®Œæ•´æ€§æ£€æŸ¥</strong>ï¼šæ£€æŸ¥FINä½ï¼Œç¡®å®šæ¶ˆæ¯æ˜¯å¦ç»“æŸ</li>
<li><strong>æ¶ˆæ¯èšåˆ</strong>ï¼šå¯¹äºåˆ†ç‰‡æ¶ˆæ¯ï¼ˆFIN=0ï¼‰ï¼Œè‡ªåŠ¨ç¼“å­˜å’Œé‡ç»„</li>
</ul>
<h2 data-id="heading-6">04 å°ç»“</h2>
<p><code>WebSocket</code>çš„æ‹†åŒ…ç²˜åŒ…é—®é¢˜å·²ç»å¦¥å–„è§£å†³ï¼Œå¼€å‘è€…åªéœ€è¦é…ç½®<code>WebSocketServerProtocolHandler</code>ï¼ŒNettyå°±ä¼šåœ¨åˆé€‚çš„æ—¶æœºè‡ªåŠ¨åˆ›å»ºå’Œé…ç½®<code>WebSocket13FrameDecoder</code>ã€‚ä¸ºæˆ‘ä»¬è§£å†³å›°æ‰°ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºä»€ä¹ˆä½ çš„ Prompt è¶Šå†™è¶Šé•¿ï¼Œæ•ˆæœå´è¶Šæ¥è¶Šå·®ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595808703074074650</link>    <guid>https://juejin.cn/post/7595808703074074650</guid>    <pubDate>2026-01-17T05:10:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595808703074074650" data-draft-id="7595841630676795443" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºä»€ä¹ˆä½ çš„ Prompt è¶Šå†™è¶Šé•¿ï¼Œæ•ˆæœå´è¶Šæ¥è¶Šå·®ï¼Ÿ"/> <meta itemprop="keywords" content="AIGC,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-17T05:10:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¥¿é™µ"/> <meta itemprop="url" content="https://juejin.cn/user/4353721774379054"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºä»€ä¹ˆä½ çš„ Prompt è¶Šå†™è¶Šé•¿ï¼Œæ•ˆæœå´è¶Šæ¥è¶Šå·®ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4353721774379054/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¥¿é™µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T05:10:05.000Z" title="Sat Jan 17 2026 05:10:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åœ¨æ—©æœŸé˜¶æ®µä¸»è¦ä»¥å¯¹è¯æœºå™¨äººçš„å½¢å¼å‡ºç°ï¼Œç”¨æˆ·é€šè¿‡è‡ªç„¶è¯­è¨€å‘æ¨¡å‹æé—®ï¼Œæ¨¡å‹è¿”å›ä¸€æ®µçœ‹ä¼¼æ™ºèƒ½çš„æ–‡æœ¬ç»“æœã€‚è¿™ä¸€é˜¶æ®µï¼Œæ¨¡å‹èƒ½åŠ›çš„å‘æŒ¥é«˜åº¦ä¾èµ–ç”¨æˆ·å¦‚ä½•æé—®ï¼ŒåŒä¸€ä¸ªé—®é¢˜ï¼Œç”¨ä¸åŒçš„æè¿°æ–¹å¼ï¼Œå¾€å¾€ä¼šå¾—åˆ°è´¨é‡å·®å¼‚å·¨å¤§çš„ç»“æœã€‚</p>
<p>åœ¨è¿™ç§èƒŒæ™¯ä¸‹ï¼Œ<code>æç¤ºè¯å·¥ç¨‹</code>ä½œä¸ºä¸€é—¨é¢å‘å¤§è¯­è¨€æ¨¡å‹çš„è¾“å…¥è®¾è®¡æ–¹æ³•è®ºé€æ¸æˆå‹ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦å¸®åŠ©å¤§å®¶å¿«é€Ÿäº†è§£<code>æç¤ºè¯å·¥ç¨‹</code>çš„æœ¬è´¨ä»¥åŠåœ¨ä¹¦å†™æŠ€å·§ã€‚</p>
<h2 data-id="heading-1">ä»€ä¹ˆæ˜¯æç¤ºè¯å·¥ç¨‹ï¼Ÿ</h2>
<p>æç¤ºè¯å·¥ç¨‹çš„æœ¬è´¨å°±æ˜¯<strong>åœ¨æœ‰é™ä¸Šä¸‹æ–‡çª—å£å†…ï¼Œæœ€å¤§åŒ–æ¨¡å‹è¾“å‡ºçš„ç¡®å®šæ€§ä¸å¯ç”¨æ€§ï¼Œå‡å°‘æ¨¡å‹è‡ªç”±å‘æŒ¥çš„ç©ºé—´</strong>ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æä¾›ä¸€ç§æç¤ºè¯ä¹¦å†™èŒƒå¼æ¥ç¡®ä¿å¤§æ¨¡å‹èƒ½å¤Ÿç²¾å‡†åœ°æŒ‰ç…§ç”¨æˆ·çš„è¦æ±‚è¾“å‡ºé«˜è´¨é‡çš„å†…å®¹ã€‚</p>
<p><strong>âŒ å·®æç¤ºè¯</strong></p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘åšä¸€ä¸ªä¸ªäººå¾…åŠæ¸…å•é¡µé¢
</code></pre>
<p>å¯¹äºè¿™æ®µæç¤ºè¯ï¼ŒAI ä¸çŸ¥é“ç”¨ä»€ä¹ˆæŠ€æœ¯ã€ä»€ä¹ˆé£æ ¼ã€è¦å“ªäº›åŠŸèƒ½ã€æœ‰ä»€ä¹ˆé™åˆ¶ã€‚ç»“æœå°±æ˜¯ AI è‡ªç”±å‘æŒ¥ï¼Œç”Ÿæˆçš„ä»£ç å’Œé¡¹ç›®è§„èŒƒä¸ç¬¦åˆã€‚</p>
<p><strong>âœ… å¥½æç¤ºè¯</strong></p>
<pre><code class="hljs language-jsx" lang="jsx">## è§’è‰²
ä½ æ˜¯ä¸€ä¸ªæ“…é•¿ <span class="hljs-title class_">React</span> å’Œç”¨æˆ·ä½“éªŒè®¾è®¡çš„å‰ç«¯å¼€å‘è€…ã€‚

## èƒŒæ™¯
æˆ‘éœ€è¦åšä¸€ä¸ªä¸ªäººå¾…åŠæ¸…å•ç½‘é¡µï¼Œç”¨æ¥è®°å½•æ¯å¤©çš„å¾…åŠä»»åŠ¡ï¼Œç°åœ¨å·²ç»å®Œæ•´åŸºæœ¬åŠŸèƒ½çš„å¼€å‘ã€‚

## ä»»åŠ¡
å®ç°ä»»åŠ¡çš„<span class="hljs-string">"æ‹–æ‹½æ’åº"</span>åŠŸèƒ½ï¼Œè®©ç”¨æˆ·å¯ä»¥é€šè¿‡æ‹–æ‹½è°ƒæ•´ä»»åŠ¡é¡ºåºã€‚

## è¦æ±‚
- æ‹–æ‹½æ—¶è¢«æ‹–åŠ¨çš„ä»»åŠ¡åŠé€æ˜
- æ”¾ç½®ä½ç½®æœ‰æ˜æ˜¾çš„è§†è§‰æŒ‡ç¤ºçº¿
- æ‹–æ‹½å®Œæˆåé¡ºåºç«‹å³æ›´æ–°

## çº¦æŸ
- æŠ€æœ¯æ ˆä¸º <span class="hljs-title class_">React</span> + <span class="hljs-title class_">TypeScript</span> + <span class="hljs-title class_">Tailwind</span> <span class="hljs-variable constant_">CSS</span>
- ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹æ‹–æ‹½åº“ï¼ˆå¦‚ react-beautiful-dndï¼‰
- ç”¨åŸç”Ÿ <span class="hljs-title class_">HTML5</span> æ‹–æ‹½ <span class="hljs-variable constant_">API</span>
- ä»£ç è¦æœ‰è¯¦ç»†æ³¨é‡Šï¼Œæˆ‘æ˜¯æ‹–æ‹½ <span class="hljs-variable constant_">API</span> çš„åˆå­¦è€…

## è¾“å‡ºæ ¼å¼
å®Œæ•´çš„ <span class="hljs-title class_">React</span> ç»„ä»¶ä»£ç ï¼ŒåŒ…å«ï¼š
<span class="hljs-number">1.</span> ç»„ä»¶æ–‡ä»¶ï¼ˆ<span class="hljs-title class_">TypeScript</span>ï¼‰
<span class="hljs-number">2.</span> å…³é”®é€»è¾‘çš„ä¸­æ–‡æ³¨é‡Š
<span class="hljs-number">3.</span> ç®€å•çš„ä½¿ç”¨è¯´æ˜
</code></pre>
<h2 data-id="heading-2">æç¤ºè¯å¸¸è§é—®é¢˜</h2>
<p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œæç¤ºè¯çš„è´¨é‡å‚å·®ä¸é½ï¼Œä»¥ä¸‹æ˜¯å‡ ç±»æœ€å¸¸è§çš„é—®é¢˜åŠå…¶æœ¬è´¨åŸå› ã€‚</p>
<h3 data-id="heading-3">ä¿¡æ¯é‡è¿‡å¤š</h3>
<p>æˆ‘æƒ³è®© AI å¸®æˆ‘åšä¸€ä¸ªå¾…åŠæ¸…å•åº”ç”¨ï¼Œäºæ˜¯å°†æ‰€æœ‰æƒ³æ³•ä¸€æ¬¡æ€§åˆ—å‡ºï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘åšä¸€ä¸ªå¾…åŠæ¸…å•åº”ç”¨ï¼Œè¦æœ‰æ·»åŠ ä»»åŠ¡ã€åˆ é™¤ä»»åŠ¡ã€ç¼–è¾‘ä»»åŠ¡ã€
æ ‡è®°å®Œæˆã€è®¾ç½®ä¼˜å…ˆçº§ã€è®¾ç½®æˆªæ­¢æ—¥æœŸã€åˆ†ç±»æ ‡ç­¾ã€æœç´¢åŠŸèƒ½ã€
æ•°æ®ç»Ÿè®¡ã€å¯¼å‡ºåŠŸèƒ½ï¼Œè¿˜è¦æœ‰æš—é»‘æ¨¡å¼ï¼Œæœ€å¥½èƒ½åŒæ­¥åˆ°äº‘ç«¯ï¼Œ
æ”¯æŒå¤šè®¾å¤‡ä½¿ç”¨ï¼Œç•Œé¢è¦å¥½çœ‹ï¼Œç”¨ <span class="hljs-title class_">React</span> å†™ï¼Œè¦æœ‰åŠ¨ç”»æ•ˆæœã€‚
</code></pre>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼šæ— ç»“æ„ã€æ— é‡ç‚¹ã€‚AI å¯èƒ½ä¼šå¿½ç•¥å…³é”®ä¿¡æ¯ï¼Œè¾“å‡ºä¸æŸäº›è¦æ±‚å†²çªã€‚</p>
<h3 data-id="heading-4">ä¿¡æ¯é‡å¤ªå°‘</h3>
<p>æˆ‘æƒ³è®© AI å¸®æˆ‘å†™ä¸ªæŒ‰é’®ç»„ä»¶ï¼Œåªæœ‰ä¸€å¥éœ€æ±‚ï¼Œæ²¡æœ‰ä»»ä½•èƒŒæ™¯ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘å†™ä¸€ä¸ªæŒ‰é’®ç»„ä»¶
</code></pre>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼šç¼ºå°‘ä¸Šä¸‹æ–‡ã€‚ä¸Šä¸‹æ–‡å¯èƒ½æ˜¯ï¼š</p>
<ul>
<li>é¡¹ç›®çš„æŠ€æœ¯æ ˆ</li>
<li>æŒ‰é’®éœ€è¦çš„åŠŸèƒ½</li>
<li>æœŸæœ›çš„æ ·å¼é£æ ¼</li>
</ul>
<p>æœ€ç»ˆ AI åªèƒ½ç»™ä¸€ä¸ªé€šç”¨çš„ç»“æœã€‚</p>
<h3 data-id="heading-5">æ²¡æœ‰ç›®æ ‡</h3>
<p>æˆ‘æƒ³è®© AI å¸®æˆ‘ä¼˜åŒ–ä»£ç ï¼Œä½†ä¸ç»™ä¼˜åŒ–ç›®æ ‡ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘ä¼˜åŒ–ä¸€ä¸‹è¿™æ®µä»£ç ï¼š
[ç²˜è´´äº†ä¸€æ®µä»£ç ]
</code></pre>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼šåªæœ‰åŠ¨ä½œï¼Œæ²¡æœ‰ç»“æœã€‚ä¼˜åŒ–æŒ‡ä»£ä¸æ˜ç¡®â€”â€”æ˜¯ä½“ç§¯ã€æ€§èƒ½è¿˜æ˜¯å¯è¯»æ€§ï¼Ÿæœ€ç»ˆè¾“å‡ºçš„ç»“æœå¿…ç„¶ä¸ç¬¦åˆé¢„æœŸã€‚</p>
<h3 data-id="heading-6">æ²¡æœ‰çº¦æŸ</h3>
<p>æˆ‘æƒ³è®© AI å¸®æˆ‘å†™ä¸€ä¸ªè¾“å…¥æ¡†ç»„ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰æ·»åŠ ç›¸å…³çº¦æŸï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx">å¸®æˆ‘å†™ä¸€ä¸ªè¾“å…¥æ¡†ç»„ä»¶ã€‚

æŠ€æœ¯æ ˆï¼š<span class="hljs-title class_">React</span> + <span class="hljs-title class_">TypeScript</span> + <span class="hljs-variable constant_">SCSS</span>
</code></pre>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼šAI å®¹æ˜“å¼•å…¥é¢å¤–çš„å‡è®¾ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>ä½¿ç”¨ä¸å…¼å®¹çš„ ui ç»„ä»¶åº“ï¼Œä¾‹å¦‚ antdã€‚</li>
<li>ä½¿ç”¨å¤æ‚çš„çŠ¶æ€ç®¡ç†æœºåˆ¶ã€‚</li>
</ul>
<p>å¯¼è‡´æœ€ç»ˆè¾“å‡º<strong>ä¸å¯æ§</strong>ï¼Œéšæ€§å¼•å…¥é”™è¯¯å‡è®¾ã€‚</p>
<h2 data-id="heading-7">æç¤ºè¯æ¨¡æ¿</h2>
<p>äº†è§£äº†å¸¸è§é—®é¢˜åï¼Œæˆ‘ä»¬éœ€è¦ä¸€å¥—ç»“æ„åŒ–çš„æ–¹æ³•æ¥é¿å…å®ƒä»¬ã€‚è¿™å°±æ˜¯æç¤ºè¯æ¨¡æ¿çš„ä»·å€¼æ‰€åœ¨ã€‚</p>
<h3 data-id="heading-8">æç¤ºè¯çš„å›°æ‰°</h3>
<p>æˆ‘ä»¬ç°åœ¨çŸ¥é“åœ¨ä½¿ç”¨ AI æ—¶ï¼Œæä¾›çš„ä¸Šä¸‹æ–‡è¶Šæ¸…æ™°ï¼ŒAI ç»™å‡ºçš„å›ç­”å°±ä¼šè¶Šç¬¦åˆé¢„æœŸã€‚ä½†æ˜¯æ¯æ¬¡å†™æç¤ºè¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¤§æ¦‚ç‡è¿˜æ˜¯ä¼šé™·å…¥è¿™æ ·çš„çŠ¶æ€ï¼š</p>
<blockquote>
<p>æˆ‘è¦å…ˆç»™ AI æŒ‡å®šä¸€ä¸ªè§’è‰²ï¼Œå‘Šè¯‰ä»–èƒŒæ™¯å’Œä»»åŠ¡ï¼Œè¿˜æœ‰çº¦æŸã€è¦æ±‚ã€æŠ€æœ¯æ ˆâ€¦â€¦çº¦æŸè¦åŒ…å«ä»€ä¹ˆå†…å®¹ï¼Ÿè¦æ±‚è¦å†™ä»€ä¹ˆï¼ŸæŠ€æœ¯æ ˆè¦æ”¾åˆ°å“ªé‡Œï¼Ÿ</p>
</blockquote>
<p>è¿™ä¼šç»™ AI ä½¿ç”¨è€…å¸¦æ¥å¾ˆå¤§çš„è®¤çŸ¥è´Ÿæ‹…ï¼Œæˆ‘ä»¬åŒæ—¶è¦æ€è€ƒ"è¯´ä»€ä¹ˆ"å’Œ"æ€ä¹ˆè¯´"ã€‚è€Œæ¨¡æ¿çš„ä»·å€¼ï¼Œå°±æ˜¯<strong>æŠŠ"æ€ä¹ˆè¯´"å˜æˆå›ºå®šæ ¼å¼ï¼Œè®©ä½ ä¸“æ³¨äº"è¯´ä»€ä¹ˆ"</strong>ã€‚</p>
<p>è¿™ä¸å‰ç«¯çš„å¼€å‘æ¡†æ¶ï¼ˆReact/Vueï¼‰å¾ˆç±»ä¼¼ï¼šåœ¨æ²¡æœ‰æ¡†æ¶ä¹‹å‰ï¼Œå¼€å‘è€…æ—¢è¦å…³æ³¨ä¸šåŠ¡ï¼ŒåŒæ—¶è¿˜éœ€è¦å…³æ³¨ DOM æ›´æ–°åŠæ€§èƒ½é—®é¢˜ï¼›éšç€æ¡†æ¶çš„æ¨å‡ºï¼Œå‰ç«¯å¼€å‘è€…èƒ½æŠŠæ›´å¤šçš„ç²¾åŠ›æ”¾åˆ°ä¸šåŠ¡åŠŸèƒ½å¼€å‘ä¸Šã€‚</p>
<h3 data-id="heading-9">æ¨¡æ¿ç›®æ ‡</h3>
<p>æç¤ºè¯æ¨¡æ¿çš„ç›®æ ‡æ˜¯<strong>å‡å°‘ä½¿ç”¨è€…çš„æ€è€ƒè´Ÿæ‹…å¹¶æé«˜ AI è¾“å‡ºçš„ç¨³å®šæ€§</strong>ã€‚ä½†æ¨¡æ¿å¹¶ä¸æ˜¯ç»ˆæç›®æ ‡ï¼Œå› ä¸ºå›ºå®šçš„æ¨¡æ¿åè€Œä¼šé™åˆ¶çµæ´»æ€§ã€‚å› æ­¤åœ¨ä¸åŒé˜¶æ®µã€ä¸åŒåœºæ™¯ï¼Œä½¿ç”¨è€…å¯ä»¥å¯¹æ¨¡æ¿è¿›è¡Œè°ƒæ•´ï¼š</p>





















<table><thead><tr><th><strong>é˜¶æ®µ</strong></th><th><strong>åšæ³•</strong></th></tr></thead><tbody><tr><td>åˆçº§é˜¶æ®µ</td><td>ä¸¥æ ¼æŒ‰æ¡†æ¶å¡«å†™ï¼Œç¡®ä¿ä¸é—æ¼</td></tr><tr><td>ç†Ÿç»ƒé˜¶æ®µ</td><td>æ ¹æ®ä»»åŠ¡å¤æ‚åº¦ç®€åŒ–æˆ–æ‰©å±•</td></tr><tr><td>é«˜æ‰‹é˜¶æ®µ</td><td>æ¡†æ¶å†…åŒ–æˆç›´è§‰ï¼Œè‡ªç„¶åœ°ç»„ç»‡ä¿¡æ¯</td></tr></tbody></table>
<h3 data-id="heading-10">æ¨èæ¨¡æ¿</h3>
<p>æ¨¡æ¿ç»“æ„ï¼š</p>













































<table><thead><tr><th><strong>ä¸»é¢˜</strong></th><th><strong>å¿…å¡«ç¨‹åº¦</strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td>è§’è‰²</td><td>å¿…é¡»</td><td>è®© AI æˆä¸ºæŸä¸ªé¢†åŸŸçš„ä¸“å®¶</td></tr><tr><td>èƒŒæ™¯</td><td>å¿…é¡»</td><td>è®© AI æå‰äº†è§£ä»»åŠ¡çš„èƒŒæ™¯çŸ¥è¯†</td></tr><tr><td>ä»»åŠ¡</td><td>å¿…é¡»</td><td>å‘Šè¯‰ AI è¦åšä»€ä¹ˆ</td></tr><tr><td>è¦æ±‚</td><td>æ¨è</td><td>å‘Šè¯‰ AI ä»»åŠ¡å®Œæˆçš„æ ‡å‡†</td></tr><tr><td>çº¦æŸ</td><td>æ¨è</td><td>ä¸º AI åˆ’å®šè¾¹ç•Œï¼Œé˜²æ­¢è‡ªç”±å‘æŒ¥</td></tr><tr><td>æ ¼å¼</td><td>å¯é€‰</td><td>å‘Šè¯‰ AI æœ€ç»ˆè¾“å‡ºå†…å®¹çš„æ ¼å¼</td></tr><tr><td>ç¤ºä¾‹</td><td>å¯é€‰</td><td>ç”¨å®é™…çš„ä¾‹å­å‘Šè¯‰ AI è¦æ€ä¹ˆåš</td></tr></tbody></table>
<p>æ¨¡æ¿ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">## è§’è‰²</span>
ä½ æ˜¯ä¸€ä¸ªæ“…é•¿ React å’Œç»„ä»¶å¼€å‘çš„çš„å‰ç«¯å¼€å‘è€…ã€‚

<span class="hljs-section">## èƒŒæ™¯</span>
æˆ‘ä½¿ç”¨ react å¼€å‘äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶åº“ï¼Œé‡Œé¢åŒ…å«äº†xxä¸ªç»„ä»¶ï¼Œç»„ä»¶åç§°å¦‚ä¸‹xxxã€‚

<span class="hljs-section">## ä»»åŠ¡</span>
å¸®æˆ‘ä¸ºæ¯ä¸ªç»„ä»¶ç”Ÿæˆä¸€ä»½ mdr æ–‡ä»¶ï¼Œè¡¨ç¤ºè¯¥ç»„ä»¶çš„ä½¿ç”¨è¯¦ç»†è¯´æ˜ã€‚

<span class="hljs-section">## è¦æ±‚</span>
<span class="hljs-bullet">-</span> æ–‡æ¡£è¦åŒ…å«ç»„ä»¶çš„ APIã€ä½¿ç”¨ç¤ºä¾‹ã€xxxã€‚

<span class="hljs-section">## çº¦æŸ</span>
<span class="hljs-bullet">-</span> ä½¿ç”¨ md è¯­æ³•ã€‚
<span class="hljs-bullet">-</span> å¿…é¡»ä¿è¯ API çš„å®Œæ•´ï¼Œä¸èƒ½æ¼æ‰å†…å®¹ã€‚

<span class="hljs-section">## è¾“å‡ºæ ¼å¼</span>
Title: ç»„ä»¶åç§°

description: ç»„ä»¶æè¿°

APIï¼š
xxx

Examplesï¼š
xxx

<span class="hljs-section">## ç¤ºä¾‹</span>

Title: Alert

description: è­¦ç¤ºç»„ä»¶

API:

| å‚æ•° | è¯´æ˜ | ç±»å‹ | é»˜è®¤å€¼ | ç‰ˆæœ¬ |
| --- | --- | --- | --- | --- |
| action | è‡ªå®šä¹‰æ“ä½œé¡¹ | ReactNode | - | 4.9.0 |
| afterClose | å…³é—­åŠ¨ç”»ç»“æŸåè§¦å‘çš„å›è°ƒå‡½æ•° | () =&gt; void | - |  |
| banner | æ˜¯å¦ç”¨ä½œé¡¶éƒ¨å…¬å‘Š | boolean | false |  |

</code></pre>
<h2 data-id="heading-11">è¿›é˜¶æç¤ºè¯æŠ€å·§</h2>
<h3 data-id="heading-12"><strong>Few-shot Prompting</strong></h3>
<p>Few-shot çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ç»™ AI å‡ ä¸ªä¾‹å­ï¼Œè®©ä»–å…ˆæŒ‰ç…§ä¾‹å­å­¦ä¹ ï¼Œç†è§£ä»»åŠ¡å¤„ç†æµç¨‹åŠæœ€ç»ˆçš„å†…å®¹è¾“å‡ºã€‚è¿™ç§æ¨¡å¼èƒ½å¤Ÿæ›´é«˜æ•ˆçš„è®© AI ç†è§£ç”¨æˆ·çš„æ„å›¾ï¼Œè¿™å’Œäººå­¦ä¹ æ–°ä¸œè¥¿ä¸€æ ·ï¼Œç›´æ¥çœ‹ç¤ºèŒƒæ¯”è¯»æ–‡æ¡£æ›´é«˜æ•ˆã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">ä»»åŠ¡ï¼šä¸º <span class="hljs-title class_">React</span> ç»„ä»¶ç”Ÿæˆ <span class="hljs-title class_">TypeScript</span> <span class="hljs-title class_">Props</span> ç±»å‹å®šä¹‰

ç¤ºä¾‹<span class="hljs-number">1</span>ï¼š
ç»„ä»¶æè¿°ï¼šä¸€ä¸ªæ˜¾ç¤ºä»»åŠ¡æ ‡é¢˜çš„ç»„ä»¶ï¼Œæ ‡é¢˜å¿…å¡«ï¼Œå¯é€‰æ˜¾ç¤ºå®ŒæˆçŠ¶æ€
è¾“å‡ºï¼š
interface <span class="hljs-title class_">TaskTitleProps</span> {
  <span class="hljs-attr">title</span>: string;           <span class="hljs-comment">// ä»»åŠ¡æ ‡é¢˜ï¼Œå¿…å¡«</span>
  isCompleted?: boolean;   <span class="hljs-comment">// å®ŒæˆçŠ¶æ€ï¼Œå¯é€‰</span>
}

ç¤ºä¾‹<span class="hljs-number">2</span>ï¼š
ç»„ä»¶æè¿°ï¼šä¸€ä¸ªæŒ‰é’®ç»„ä»¶ï¼Œæ˜¾ç¤ºæ–‡å­—å¿…å¡«ï¼Œç‚¹å‡»äº‹ä»¶å¿…å¡«ï¼Œå¯é€‰ç¦ç”¨çŠ¶æ€
è¾“å‡ºï¼š
interface <span class="hljs-title class_">ButtonProps</span> {
  <span class="hljs-attr">label</span>: string;           <span class="hljs-comment">// æŒ‰é’®æ–‡å­—ï¼Œå¿…å¡«</span>
  <span class="hljs-attr">onClick</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">void</span>;     <span class="hljs-comment">// ç‚¹å‡»äº‹ä»¶ï¼Œå¿…å¡«</span>
  disabled?: boolean;      <span class="hljs-comment">// ç¦ç”¨çŠ¶æ€ï¼Œå¯é€‰</span>
}
</code></pre>
<p>ç¤ºä¾‹è™½ç„¶èƒ½å¤Ÿæ›´é«˜æ•ˆçš„å¸®åŠ© AI ç†è§£ä»»åŠ¡ï¼Œä½†æ˜¯è¿‡å¤šçš„ç¤ºä¾‹ä¹Ÿä¼šåŠ å¤§ token çš„æ¶ˆè€—ï¼Œå› æ­¤ç¤ºä¾‹ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè¦éµå¾ª<strong>å°‘è€Œç²¾çš„åŸåˆ™</strong>ï¼Œé€šè¿‡ 2ï½5 ä¸ªä¾‹å­å°†å…¸å‹çš„åœºæ™¯ã€å¤šæ ·æ€§åœºæ™¯ä»¥åŠè¾¹ç•Œåœºæ™¯åˆ—ä¸¾å‡ºæ¥ã€‚</p>
<h3 data-id="heading-13"><strong>Chain of Thought</strong></h3>
<p>Chain of Thought çš„æ ¸å¿ƒæ€æƒ³æ˜¯å‘Šè¯‰ AI è®©ä»–ä¸€æ­¥æ­¥æ€è€ƒæ¨ç†ï¼Œè¾“å‡ºæ¨ç†å†…å®¹ï¼Œè€Œä¸æ˜¯ç›´æ¥ç»™ç­”æ¡ˆã€‚å°±åƒè§£æ•°å­¦é¢˜ä¸€æ ·ï¼ŒæŠŠè§£é¢˜çš„æ¯ä¸€æ­¥éƒ½å†™å‡ºæ¥ï¼Œè¿™æ ·å¾€å¾€èƒ½è®© AI è¾“å‡ºæ›´å‡†ç¡®çš„ç­”æ¡ˆã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">## è§’è‰²
ä½ æ˜¯ä¸€ä¸ªæ“…é•¿ <span class="hljs-title class_">React</span> å’Œç»„ä»¶å¼€å‘çš„çš„å‰ç«¯å¼€å‘è€…ã€‚

## èƒŒæ™¯
æˆ‘ä½¿ç”¨ react å¼€å‘äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶åº“ï¼Œé‡Œé¢åŒ…å«äº†xxä¸ªç»„ä»¶ã€‚

## ä»»åŠ¡
å¸®æˆ‘ç»™ä¿®æ”¹çš„ react ç»„ä»¶è¡¥å……æ–°çš„å•æµ‹ã€‚

### ä¿®æ”¹ç‚¹åˆ†ææ­¥éª¤
- åˆ†æç»„ä»¶çš„ propsï¼Œæ‰¾å‡ºæ–°å¢/åˆ å‡/ä¿®æ”¹çš„å‚æ•°ï¼Œå¹¶è¾“å‡ºå‡ºæ¥ã€‚
- åˆ†æç»„ä»¶çš„å†…éƒ¨é€»è¾‘ï¼Œæ‰¾å‡ºæ–°å¢/åˆ é™¤/ä¿®æ”¹çš„é€»è¾‘ï¼Œå¹¶è¾“å‡ºå‡ºæ¥ã€‚

</code></pre>
<p>è¿™ç§æ¨¡å¼åœ¨å¤æ‚çš„åœºæ™¯ä¸­ä¼šå¤§å¤§æå‡è¾“å‡ºæ•ˆæœï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨ä¸€äº›å±€é™ï¼š</p>
<ul>
<li>è¾“å‡ºå†…å®¹çš„é•¿åº¦ä¼šå¤§å¤§å¢åŠ ï¼Œå¢åŠ  Token çš„æ¶ˆè€—ã€‚</li>
<li>å¯¹äºæŸäº›ç®€å•ä»»åŠ¡ï¼Œå¼ºè¡Œä½¿ç”¨è¯¥æ¨¡å¼å¯èƒ½åè€Œä¼šé™ä½æ•ˆæœã€‚</li>
<li>å¦‚æœæ¨ç†çš„è¿‡ç¨‹ä¸­æŸä¸€æ­¥å‡ºé”™ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¥ä¸‹æ¥æ­¥éª¤éƒ½ä¼šå‡ºé”™ï¼Œéœ€è¦é…åˆ Self-Critique æ¥æ£€æŸ¥ã€‚</li>
</ul>
<h3 data-id="heading-14"><strong>Self-Critique</strong></h3>
<p>ä¸äººç±»ä¸€æ ·ï¼ŒAI å¹¶éæ€»èƒ½åœ¨é¦–æ¬¡å°è¯•æ—¶å°±ç”Ÿæˆæœ€ä½³è¾“å‡ºï¼ŒSelf-Critique çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨ AI ç”Ÿæˆå†…å®¹ä¹‹åï¼Œè®© AI å†è‡ªæˆ‘æ£€æŸ¥ä¸€éï¼Œå‘ç°å¹¶ä¿®å¤é—®é¢˜ã€‚è¿™ä¸ªå’Œæˆ‘ä»¬è€ƒè¯•ç­”é¢˜ä¸€æ ·ï¼Œåšå®Œä¹‹åå†æ£€æŸ¥ä¸€éå¾€å¾€èƒ½å‘ç°é—æ¼çš„ç»†èŠ‚æˆ–è€…å†™é”™çš„é¢˜ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">## è§’è‰²
ä½ æ˜¯ä¸€ä¸ªæ“…é•¿ <span class="hljs-title class_">React</span> å’Œç»„ä»¶å¼€å‘çš„çš„å‰ç«¯å¼€å‘è€…ã€‚

## èƒŒæ™¯
æˆ‘ä½¿ç”¨ react å¼€å‘äº†ä¸€ä¸ªåŸºç¡€ç»„ä»¶åº“ï¼Œé‡Œé¢åŒ…å«äº†xxä¸ªç»„ä»¶ã€‚

## ä»»åŠ¡
å¸®æˆ‘ç»™ä¿®æ”¹çš„ react ç»„ä»¶è¡¥å……æ–°çš„å•æµ‹ã€‚

## ä¿®æ”¹ç‚¹åˆ†ææ­¥éª¤
- åˆ†æç»„ä»¶çš„ propsï¼Œæ‰¾å‡ºæ–°å¢/åˆ å‡/ä¿®æ”¹çš„å‚æ•°ï¼Œå¹¶è¾“å‡ºå‡ºæ¥ã€‚
- åˆ†æç»„ä»¶çš„å†…éƒ¨é€»è¾‘ï¼Œæ‰¾å‡ºæ–°å¢/åˆ é™¤/ä¿®æ”¹çš„é€»è¾‘ï¼Œå¹¶è¾“å‡ºå‡ºæ¥ã€‚

## è¦æ±‚

- ç”Ÿæˆå®Œä¹‹åï¼Œè¯·ä¸¥æ ¼è‡ªæŸ¥
	- æ˜¯å¦è¦†ç›–äº†æ‰€æœ‰ä¿®æ”¹ç‚¹ã€‚
	- æ¯ä¸ªä¿®æ”¹ç‚¹æ˜¯å¦è¦†ç›–äº†æ‰€æœ‰è¾¹ç•Œæƒ…å†µï¼ˆç©ºå€¼ã€ç©ºå­—ç¬¦ä¸²ã€åªæœ‰ç©ºæ ¼ï¼‰
</code></pre>
<p>è¿™ç§æ¨¡å¼ä¸‹ä¼šè®© AI æ‰®æ¼”ä¸€ä¸ªå®¡æŸ¥è€…çš„è§’è‰²é‡æ–°å®¡ä¸‹ç”Ÿæˆçš„å†…å®¹ï¼Œæé«˜å†…å®¹çš„å‡†ç¡®æ€§ï¼Œä½†æ˜¯ä¹Ÿæœ‰å®ƒçš„å±€é™ï¼š</p>
<ul>
<li>å¢åŠ  Token çš„æ¶ˆè€—ï¼Œè¿™ç§æ¨¡å¼æ›´æ¨èåœ¨å¤æ‚çš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚</li>
<li>AI å¯èƒ½å‡ºç°è‡ªæˆ‘è®¤å¯çš„åå·®ï¼Œè®¤ä¸ºè¾“å‡ºæ˜¯æ²¡é—®é¢˜çš„ï¼Œæ­¤æ—¶<strong>éœ€è¦ä¸¥æ ¼ç»™ AI è®¾å®šå®¡æŸ¥è€…çš„è§’è‰²</strong>ã€‚</li>
</ul>
<h2 data-id="heading-15">æ€»ç»“</h2>
<p>æœ¬æ–‡å›´ç»•ã€Œæç¤ºè¯å·¥ç¨‹ã€å±•å¼€ï¼Œä»èƒŒæ™¯ã€æ ¸å¿ƒç›®æ ‡ã€å¸¸è§é—®é¢˜ã€ç»“æ„åŒ–æ¨¡æ¿ï¼Œåˆ° Few-shotã€Chain of Thoughtã€Self-Critique ç­‰è¿›é˜¶æŠ€å·§ï¼Œç³»ç»Ÿæ€§åœ°è¯´æ˜äº†ä¸€ä»¶äº‹ï¼š</p>
<blockquote>
<p>æç¤ºè¯å·¥ç¨‹çš„æœ¬è´¨ï¼Œä¸æ˜¯â€œå¦‚ä½•æŠŠè¯è¯´å¾—æ›´æ¼‚äº®â€ï¼Œè€Œæ˜¯å¦‚ä½•é€šè¿‡ç»“æ„åŒ–ä¸Šä¸‹æ–‡ï¼Œé™ä½å¤§æ¨¡å‹è¾“å‡ºçš„ä¸ç¡®å®šæ€§ã€‚</p>
</blockquote>
<p>ç„¶è€Œï¼Œè¿™ç§æç¤ºè¯ä¼˜åŒ–çš„æ€è·¯ä¹Ÿå¸¦æ¥äº†æ–°çš„å·¥ç¨‹é—®é¢˜ï¼š<strong>æç¤ºè¯è¶Šæ¥è¶Šé•¿ã€ç»“æ„è¶Šæ¥è¶Šå¤æ‚ï¼Œæœ€ç»ˆç›´æ¥åæ˜ ä¸º Token ä½“ç§¯çš„æŒç»­è†¨èƒ€</strong>ã€‚</p>
<p>å› æ­¤ï¼Œåœ¨å®é™…å·¥ç¨‹ä¸­ï¼Œæç¤ºè¯ä¼˜åŒ–å¹¶ä¸ç­‰åŒäºå†™å¾—è¶Šè¯¦ç»†è¶Šå¥½ï¼Œè€Œæ˜¯éœ€è¦åœ¨<strong>ä¿¡æ¯å……åˆ†æ€§ä¸ Token æˆæœ¬ä¹‹é—´å–å¾—å¹³è¡¡</strong>ã€‚å¦‚ä½•æ§åˆ¶ä¸Šä¸‹æ–‡è§„æ¨¡ã€é¿å…æ— æ•ˆä¿¡æ¯å †ç§¯ã€å¹¶åœ¨å¤æ‚ä»»åŠ¡ä¸­æŒç»­æä¾›åˆšåˆšå¥½çš„ä¸Šä¸‹æ–‡ï¼Œæˆä¸ºæç¤ºè¯å·¥ç¨‹ä¹‹åå¿…é¡»é¢å¯¹çš„æ ¸å¿ƒé—®é¢˜ã€‚</p>
<h2 data-id="heading-16">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Fprompt-engineering" target="_blank" title="https://platform.openai.com/docs/guides/prompt-engineering" ref="nofollow noopener noreferrer">OpenAI Prompt Engineering Guide</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.anthropic.com%2Fclaude%2Fdocs%2Fprompt-engineering" target="_blank" title="https://docs.anthropic.com/claude/docs/prompt-engineering" ref="nofollow noopener noreferrer">Anthropic Prompt Engineering</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2005.14165" target="_blank" title="https://arxiv.org/abs/2005.14165" ref="nofollow noopener noreferrer">Few-shot Prompting</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2201.11903" target="_blank" title="https://arxiv.org/abs/2201.11903" ref="nofollow noopener noreferrer">Chain of Thought</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2303.17651" target="_blank" title="https://arxiv.org/abs/2303.17651" ref="nofollow noopener noreferrer">Self-Critique</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIç¼–ç¨‹å‡ºæµ·é—¨æ§›é™ä½ï¼ŒPayPalå¯å¼€é€šå›½å†…ä¸ªäººè´¦æˆ·]]></title>    <link>https://juejin.cn/post/7595858353660559394</link>    <guid>https://juejin.cn/post/7595858353660559394</guid>    <pubDate>2026-01-17T05:21:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858353660559394" data-draft-id="7595864836359733300" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIç¼–ç¨‹å‡ºæµ·é—¨æ§›é™ä½ï¼ŒPayPalå¯å¼€é€šå›½å†…ä¸ªäººè´¦æˆ·"/> <meta itemprop="keywords" content="åç«¯,é¢è¯•,GitHub"/> <meta itemprop="datePublished" content="2026-01-17T05:21:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å·ç¦åŒå­¦"/> <meta itemprop="url" content="https://juejin.cn/user/3456520291098686"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIç¼–ç¨‹å‡ºæµ·é—¨æ§›é™ä½ï¼ŒPayPalå¯å¼€é€šå›½å†…ä¸ªäººè´¦æˆ·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3456520291098686/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å·ç¦åŒå­¦
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T05:21:59.000Z" title="Sat Jan 17 2026 05:21:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æ˜¨å¤©ï¼ŒPayPalä¸­å›½æ­£å¼æ”¯æŒä¸ªäººå–å®¶è´¦æˆ·æ³¨å†Œï¼Œä¸ºç‹¬ç«‹å¼€å‘è€…ã€å°å¾®åˆ›ä¸šè€…å’Œä»äº‹æµ·å¤–äº§å“é”€å”®çš„ä¸ªäººç”¨æˆ·æä¾›äº†æ›´ä¾¿æ·çš„è·¨å¢ƒæ”¶æ¬¾æ¸ é“ã€‚ä¸‹é¢ä¸ºæ‚¨è¯¦ç»†ä»‹ç»ç”³è¯·æµç¨‹å’Œå¸¸è§é—®é¢˜</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3da7118fb5e641338b90df2136847de7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769232119&amp;x-signature=g19mE3MlW60gOsFrb1VOSZhszvM%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">ä¸€ã€ç”³è¯·æµç¨‹</h2>
<p><strong>1. è®¿é—®ç”³è¯·å…¥å£</strong></p>
<p>å‰å¾€PayPalå®˜æ–¹é¡µé¢ï¼ˆ<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.paypal.cn%2Fportal%2Faccount-selection%25EF%25BC%2589%25EF%25BC%258C%25E9%2580%2589%25E6%258B%25A9%25E2%2580%259C%25E4%25B8%25AA%25E4%25BA%25BA%25E5%258D%2596%25E5%25AE%25B6%25E2%2580%259D%25E8%25B4%25A6%25E6%2588%25B7%25E7%25B1%25BB%25E5%259E%258B%25E3%2580%2582" target="_blank" title="https://www.paypal.cn/portal/account-selection%EF%BC%89%EF%BC%8C%E9%80%89%E6%8B%A9%E2%80%9C%E4%B8%AA%E4%BA%BA%E5%8D%96%E5%AE%B6%E2%80%9D%E8%B4%A6%E6%88%B7%E7%B1%BB%E5%9E%8B%E3%80%82" ref="nofollow noopener noreferrer">www.paypal.cn/portal/accoâ€¦</a></p>
<p><strong>2. è´¦æˆ·æ³¨å†Œ</strong></p>
<p>ä½¿ç”¨é‚®ç®±å’Œæ‰‹æœºå·åˆ›å»ºæ–°è´¦æˆ·ã€‚å¦‚æ›¾æ³¨å†Œè¿‡PayPalï¼Œéœ€ä½¿ç”¨æ–°é‚®ç®±å®Œæˆç”³è¯·ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fa86039fed5405d90de5708f8da6d19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769232119&amp;x-signature=eTiYrpdVFDC7h9lsaJP%2B0gf8T8Q%3D" alt="img" loading="lazy"/></p>
<p><strong>3. å®ŒæˆéªŒè¯</strong></p>
<p>ä¾æ¬¡å®Œæˆæ‰‹æœºçŸ­ä¿¡éªŒè¯å’Œé‚®ç®±éªŒè¯ã€‚</p>
<p><strong>4. èº«ä»½è®¤è¯</strong></p>
<p>æäº¤èº«ä»½è¯ä¿¡æ¯å¹¶è¿›è¡Œäººè„¸è¯†åˆ«è®¤è¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/85332dec8b244d8ab2c83278e6da034c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769232119&amp;x-signature=mmLT5Nh7EQNieRghR3Hlc3cppDY%3D" alt="img" loading="lazy"/></p>
<p><strong>5. å¡«å†™å•†ä¸šä¿¡æ¯</strong></p>
<p>å¦‚å®å¡«å†™èŒä¸šå’Œå•†å“/è¡Œä¸šä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>
<p>èŒä¸šï¼šå·¥ç¨‹æŠ€æœ¯äººå‘˜</p>
</li>
<li>
<p>è¡Œä¸šï¼šè®¡ç®—æœºè½¯ä»¶å¼€å‘æœåŠ¡</p>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/937fb59a407e4a88bf42a0983ac9d42e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769232119&amp;x-signature=F83AcbBnihwbPnqOSscjLWczNXo%3D" alt="img" loading="lazy"/></p>
<p><strong>6. æäº¤å®¡æ ¸</strong></p>
<p>ä¿¡æ¯æäº¤åï¼Œé€šå¸¸30åˆ†é’Ÿå†…å³å¯å®Œæˆå®¡æ ¸ã€‚é€šè¿‡åå³å¯é›†æˆä½¿ç”¨PayPalæ”¶æ¬¾åŠŸèƒ½ã€‚</p>
<h2 data-id="heading-1">äºŒã€å¸¸è§é—®é¢˜è§£ç­”</h2>
<p><strong>1. è´¹ç”¨æ ‡å‡†</strong></p>
<ul>
<li>æ‰‹ç»­è´¹ï¼š0.5%ï¼ˆé™æ—¶ä¼˜æƒ ï¼Œæ ‡å‡†è´¹ç‡ä¸º1.0%ï¼‰</li>
<li>å¢å€¼ç¨ï¼š6%ï¼ˆç”±PayPalä»£ç¼´ï¼‰</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e78e07bf98284f829b6ca6f3cebfa7a4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769232119&amp;x-signature=%2Bdvo7kM2IQ2afnPPBQJIageJ8GE%3D" alt="img" loading="lazy"/></p>
<p><strong>2. å¤–æ±‡é¢åº¦ä¸ç”³æŠ¥</strong></p>
<ul>
<li>æ— éœ€ä¸ªäººé€ç¬”ç”³æŠ¥ï¼Œç”±PayPalç»Ÿä¸€å‘é“¶è¡Œç”³æŠ¥</li>
<li>ä¸å ç”¨ä¸ªäººå¤–æ±‡é¢åº¦ï¼Œä½†PayPalä¼šæ ¹æ®æ”¿ç­–è®¾ç½®æ”¶æ¬¾é¢åº¦é™åˆ¶</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/502d6559520b4c5fbf5bbf822d9b2fc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Y2356aP5ZCM5a2m:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769232119&amp;x-signature=hQrDM2nR2bLG6kLveAfQvQmsmfI%3D" alt="img" loading="lazy"/></p>
<p><strong>3. ç¨åŠ¡æ³¨æ„äº‹é¡¹</strong></p>
<p>å»ºè®®ç”¨æˆ·å…³æ³¨ä¸ªäººå¹´åº¦æ‰€å¾—ç¨ç”³æŠ¥è¦æ±‚ï¼Œç¡®ä¿åˆè§„ã€‚</p>
<h2 data-id="heading-2">ç»“è¯­</h2>
<p>PayPalä¸ªäººå–å®¶è´¦æˆ·çš„æ¨å‡ºï¼Œé™ä½äº†ä¸ªäººä»äº‹è·¨å¢ƒä¸šåŠ¡çš„é—¨æ§›ï¼Œä¸ºç‹¬ç«‹å¼€å‘è€…å’Œå°å¾®åˆ›ä¸šè€…æä¾›äº†æ›´ä¾¿æ·çš„æ”¶æ¬¾æ¸ é“ã€‚å»ºè®®æœ‰éœ€æ±‚çš„ç”¨æˆ·å°½æ—©å®Œæˆè´¦æˆ·å¼€é€šï¼Œä¸ºæµ·å¤–ä¸šåŠ¡å‘å±•æ‰“å¥½åŸºç¡€ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸ºå•¥ Array.isArray åˆ¤æ–­æ•°ç»„æœ€é è°±ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7595437351461945359</link>    <guid>https://juejin.cn/post/7595437351461945359</guid>    <pubDate>2026-01-16T03:12:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595437351461945359" data-draft-id="7595472747456299023" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸ºå•¥ Array.isArray åˆ¤æ–­æ•°ç»„æœ€é è°±ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-16T03:12:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜å°å¯’"/> <meta itemprop="url" content="https://juejin.cn/user/694547078987287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸ºå•¥ Array.isArray åˆ¤æ–­æ•°ç»„æœ€é è°±ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547078987287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜å°å¯’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T03:12:01.000Z" title="Fri Jan 16 2026 03:12:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ <code>JavaScript</code> ä¸­ï¼Œå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºæ•°ç»„æ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ã€‚</p>
<h2 data-id="heading-0">1ã€æ–¹å¼ä¸€ï¼šJSON.stringify</h2>
<p>å¯ä»¥é€šè¿‡ <code>JSON.stringify</code> åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œç„¶ååˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä»¥ <code>["</code> å¼€å¤´ï¼Œä»¥ <code>"]</code> ç»“å°¾æ¥åˆ¤æ–­æ˜¯å¦ä¸ºæ•°ç»„ã€‚è¿™å…¶å®å’Œä½¿ç”¨ <code>JSON.stringify(obj) === '{}'</code> åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ç©ºå¯¹è±¡çš„æ€è·¯ç±»ä¼¼ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(arr).<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'['</span>) &amp;&amp; <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(arr).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">']'</span>)); <span class="hljs-comment">// true</span>
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>å…¼å®¹æ€§å¥½ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>éœ€è¦åºåˆ—åŒ–æ€§èƒ½è¾ƒå·®ã€‚</li>
<li>æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨çš„æ•°æ®ï¼Œä¼šæŠ¥é”™ <code>TypeError: Converting circular structure to JSON</code>ã€‚</li>
<li>åˆ¤æ–­ä»£ç ä¹Ÿè¾ƒä¸ºå¤æ‚ã€‚</li>
</ul>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = [];
arr[<span class="hljs-number">0</span>] = arr; <span class="hljs-comment">// æ·»åŠ å¾ªç¯å¼•ç”¨</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(arr).<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'['</span>) &amp;&amp; <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(arr).<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">']'</span>)); <span class="hljs-comment">// æŠ¥é”™ TypeError: Converting circular structure to JSON</span>
</code></pre>
<h2 data-id="heading-1">2ã€æ–¹å¼äºŒï¼šinstanceof</h2>
<p><code>instanceof</code> å¯ä»¥åˆ¤æ–­æŸä¸ªå®ä¾‹æ˜¯å¦å±äºæŸç§ç±»å‹ï¼Œå®ƒå†…éƒ¨ä¼šé€šè¿‡åŸå‹é“¾å¾€ä¸Šä¸€çº§ä¸€çº§æŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å’Œå½“å‰å¯¹è±¡çš„åŸå‹ç›¸ç­‰çš„åŸå‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);      <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>({} <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);      <span class="hljs-comment">// false</span>
</code></pre>
<p>ä½†æ˜¯<strong>åŸå‹é“¾æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„</strong>ï¼Œæ‰€ä»¥ <code>instanceof</code> åˆ¤æ–­ç»“æœå¯èƒ½ä¸å‡†ç¡®ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <code>Object.setPrototypeOf(target, newProto)</code> æ¥ä¿®æ”¹åŸå‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = {};
<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">setPrototypeOf</span>(arr, <span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯è·¨ <code>iframe</code> è¿›è¡Œåˆ¤æ–­æ—¶ï¼Œ<code>instanceof</code> åˆ¤æ–­ç»“æœå¯èƒ½ä¸å‡†ç¡®ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">const</span> iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'iframe'</span>);
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(iframe);
    <span class="hljs-keyword">const</span> iframeArray = iframe.<span class="hljs-property">contentWindow</span>.<span class="hljs-property">Array</span>;
    <span class="hljs-keyword">const</span> iframeArr = <span class="hljs-keyword">new</span> <span class="hljs-title function_">iframeArray</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(iframeArr <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Array</span>);  <span class="hljs-comment">// false</span>
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>è¿™é‡Œå…¶å® <code>iframeArr</code> æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä½†æ˜¯ <code>instanceof</code> åˆ¤æ–­ç»“æœå´æ˜¯ <code>false</code>ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ç®€å•ç›´è§‚ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>é€šè¿‡ <code>Object.setPrototypeOf</code> ä¿®æ”¹åŸå‹ååˆ¤æ–­ä¸å‡†ç¡®ã€‚</li>
<li>è·¨ <code>iframe</code> å¤±æ•ˆã€‚</li>
</ul>
<h2 data-id="heading-2">3ã€æ–¹å¼ä¸‰ï¼šconstructor å±æ€§</h2>
<p>æ¯ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª <code>constructor</code> å±æ€§ï¼ŒæŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥é€šè¿‡ <code>constructor</code> å±æ€§å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå®ä¾‹æ˜¯å¦å±äºæŸä¸ªç±»å‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>([].<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Array</span>);  <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>({}.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Array</span>);  <span class="hljs-comment">// false</span>
</code></pre>
<p>ç„¶è€Œå’ŒåŸå‹ä¸€æ ·ï¼Œ<code>constructor</code> å±æ€§ä¹Ÿæ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = [];
arr.<span class="hljs-property">constructor</span> = <span class="hljs-title class_">Object</span>; <span class="hljs-comment">// ä¿®æ”¹ constructor</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Array</span>); <span class="hljs-comment">// falseï¼ˆè¢«ä¿®æ”¹äº†å¯¼è‡´åˆ¤æ–­é”™è¯¯ï¼‰</span>
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ç®€å•ç›´è§‚ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li><code>constructor</code> å¯è¢«ä¿®æ”¹ï¼Œåˆ¤æ–­ä¸å‡†ç¡®ã€‚</li>
</ul>
<h2 data-id="heading-3">4ã€æ–¹å¼å››ï¼šObject.prototype.toString.call</h2>
<p><code>Object.prototype.toString.call()</code> æ˜¯ <code>JavaScript</code> ä¸­ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ç±»å‹æ£€æµ‹æ–¹æ³•ï¼Œå®ƒå¯ä»¥è·å–ä»»æ„å€¼çš„å†…éƒ¨ <code>[[Class]]</code> å±æ€§ï¼Œå¹¶ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›å…¶ç±»å‹ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(arr) === <span class="hljs-string">'[object Array]'</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p>å®ƒæ˜¯ä¸€ä¸ªæ£€æµ‹æ•°æ®ç±»å‹çš„<strong>æ ‡å‡†æ–¹æ³•</strong>ï¼Œå®ƒä¸ä»…å¯ä»¥æ£€æŸ¥æ•°ç»„ <code>Array</code>ã€å¯¹è±¡ <code>Object</code>ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹å’Œå…¶å®ƒå¼•ç”¨ç±»å‹åƒ<code>æ—¥æœŸ Date</code>ã€ <code>æ­£åˆ™ regexp</code> ç­‰éƒ½å¯ä»¥åˆ¤æ–­å‡ºæ¥ï¼Œå®é™…å¼€å‘ä¸­é€šå¸¸ä¼šæŠŠå®ƒå°è£…æˆä¸€ä¸ªé€šç”¨çš„ç±»å‹æ£€æµ‹æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åˆ¤æ–­ç‰¹å®šç±»å‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isType</span>(<span class="hljs-params">value, type</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(value) === <span class="hljs-string">`[object <span class="hljs-subst">${type}</span>]`</span>;
}

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isType</span>([], <span class="hljs-string">'Array'</span>));     <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isType</span>({}, <span class="hljs-string">'Object'</span>));    <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isType</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(), <span class="hljs-string">'Date'</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">isType</span>(<span class="hljs-regexp">/abc/</span>, <span class="hljs-string">'RegExp'</span>)); <span class="hljs-comment">// true</span>
</code></pre>
<p>ä½†æ˜¯åœ¨ <code>es6</code> çš„ <code>Symbol</code>å‡ºç°ä¹‹åï¼Œå¯ä»¥é€šè¿‡ <code>Symbol.toStringTag</code> å±æ€§æ¥æ§åˆ¶å…¶è¿”å›å€¼ï¼Œä¹Ÿä¼šå¯¼è‡´å…¶åˆ¤æ–­ä¸å‡†ç¡®ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = {
  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">toStringTag</span>]: <span class="hljs-string">'Array'</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(arr) === <span class="hljs-string">'[object Array]'</span>); <span class="hljs-comment">// true</span>
</code></pre>
<p><code>Symbol.toStringTag</code> ä¹Ÿå¯ä»¥æ”¯æŒè®¾ç½®ä¸ºä»»æ„å€¼ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> obj = {
  [<span class="hljs-title class_">Symbol</span>.<span class="hljs-property">toStringTag</span>]: <span class="hljs-string">'111'</span> <span class="hljs-comment">// å¯ä»¥è®¾ç½®ä¸ºä»»æ„å€¼</span>
}
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">toString</span>.<span class="hljs-title function_">call</span>(obj)); <span class="hljs-comment">// [object 111]</span>
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>ç®€å•ç›´è§‚ã€‚</li>
<li>ä¸ä»…å¯ä»¥åˆ¤æ–­æ•°ç»„ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹å’Œå…¶å®ƒå¼•ç”¨æ•°æ®ç±»å‹ <code>Date</code>ã€<code>Regexp</code> ä¹Ÿå¯ä»¥ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>ä»£ç è¾ƒé•¿ï¼Œå¹¶ä¸”å¯é€šè¿‡ <code>Symbol.toStringTag</code> ä¿®æ”¹åˆ¤æ–­ç»“æœã€‚</li>
</ul>
<h2 data-id="heading-4">5ã€æ–¹å¼äº”ï¼šArray.isArrayï¼ˆæœ€æ¨èï¼‰</h2>
<p><code>Array.isArray()</code> æ˜¯ <code>Array</code> çš„ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå¯ä»¥åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºæ•°ç»„ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> arr = [];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(arr));  <span class="hljs-comment">// true</span>
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ul>
<li>æœ€å¯é ã€‚</li>
<li>ç®€å•ç›´è§‚ã€‚</li>
</ul>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<ul>
<li>å…¼å®¹æ€§é—®é¢˜ï¼Œåªæ”¯æŒ <code>IE9+</code>ã€‚</li>
</ul>
<h2 data-id="heading-5">ä¸ºä»€ä¹ˆ Array.isArray æ˜¯æœ€é è°±çš„å‘¢ï¼Ÿ</h2>
<p><strong>1. é€šè¿‡åˆ¤æ–­å†…éƒ¨å­˜å‚¨çš„æ•°æ®ç»“æ„æ˜¯å¦ç¬¦åˆæ•°ç»„çš„æ•°æ®ç»“æ„å®šä¹‰</strong>ã€‚</p>
<p>æ•°ç»„æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼š</p>
<ul>
<li>å®ƒæ˜¯ä¸€ç§çº¿æ€§è¡¨æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±æ˜¯å®ƒé‡Œé¢çš„æ•°æ®æ˜¯æ’æˆä¸€æ¡çº¿ä¸€æ ·çš„ï¼Œå®ƒçš„æ•°æ®åªæœ‰å‰å’Œåä¸¤ä¸ªæ–¹å‘ã€‚é™¤äº†æ•°ç»„ï¼Œé˜Ÿåˆ—ã€æ ˆã€é“¾æ¥ä¹Ÿæ˜¯çº¿æ€§è¡¨æ•°æ®ç»“æ„ã€‚</li>
<li>è¿ç»­çš„å†…å­˜ç©ºé—´ã€‚å°±æ˜¯è¯´æ•°æ®ä¸­çš„å…ƒç´ åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­å­˜å‚¨çš„ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥æ•°æ®å¯ä»¥å®ç°<strong>éšæœºè®¿é—®</strong>ï¼Œä¹Ÿå°±æ˜¯è®¿é—®æ•°æ®ä¸­çš„æ¯ä¸ªå…ƒç´ èŠ±çš„æ—¶é—´å°±æ˜¯ä¸€æ ·çš„ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ <code>O(1)</code>ï¼ŒæŸ¥è¯¢æ•°æ®ç‰¹åˆ«å¿«ã€‚</li>
</ul>
<p><strong>2. å®ƒæ˜¯ä¸€ä¸ªåŸç”Ÿæ–¹æ³•ï¼Œå†…éƒ¨<code> C++</code> ç¼–ç å®ç°ï¼Œæˆ‘ä»¬ä» js ä»£ç å±‚é¢æ— æ³•åˆ¤æ–­æ•°æ®å†…éƒ¨çš„å­˜å‚¨ç»“æ„ï¼Œä¹Ÿå°±æ— æ³•æ¨¡æ‹Ÿå®ç°ã€‚</strong></p>
<h2 data-id="heading-6">å°ç»“</h2>









































<table><thead><tr><th>åˆ¤æ–­æ˜¯å¦æ˜¯æ•°ç»„çš„æ–¹æ³•</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td>Array.isArray()</td><td>æ ‡å‡†ã€è·¨ç¯å¢ƒã€æœ€å¯é </td><td>å…¼å®¹æ€§é—®é¢˜ï¼Œåªæ”¯æŒIE9+</td><td>â­â­â­â­â­</td></tr><tr><td>Object.prototype.toString.call()</td><td>æœ€å…¼å®¹ã€å¯é </td><td>ä»£ç è¾ƒé•¿ï¼Œå¹¶ä¸”å¯é€šè¿‡ Symbol.toStringTag ä¿®æ”¹åˆ¤æ–­ç»“æœ</td><td>â­â­â­â­</td></tr><tr><td>instanceof</td><td>ç®€å•ç›´è§‚</td><td>é€šè¿‡ Object.setPrototypeOf ä¿®æ”¹åŸå‹ååˆ¤æ–­ä¸å‡†ç¡®ï¼Œè·¨ iframe å¤±æ•ˆ</td><td>â­â­â­</td></tr><tr><td>constructor</td><td>ç®€å•</td><td>constructor å¯è¢«ä¿®æ”¹</td><td>â­â­</td></tr><tr><td>JSON.stringify</td><td>å…¼å®¹æ€§å¥½</td><td>æ— æ³•å¤„ç†å¾ªç¯å¼•ç”¨ã€æ€§èƒ½å·®</td><td>â­</td></tr></tbody></table>
<p>åœ¨å¹³æ—¶å®é™…å‰ç«¯é¡¹ç›®å¼€å‘ä¸­ï¼Œå¦‚æœéœ€è¦åˆ¤æ–­æ˜¯å¦æ˜¯æ•°ç»„ï¼Œç›´æ¥ç”¨ <code>Array.isArray()</code> å°±å¥½äº†ï¼Œå®ƒå†…éƒ¨é€šè¿‡ <code>C++</code> ç¼–ç å®ç°ï¼Œåˆ¤æ–­å…¶å­˜å‚¨ç»“æ„æ˜¯å¦ä¸ºæ•°ç»„ï¼Œæ˜¯æœ€å¯é çš„åˆ¤æ–­æ–¹æ³•ï¼Œå¦‚æœéœ€è¦å°è£…ä¸€ä¸ªé€šç”¨çš„æ•°æ®ç±»å‹åˆ¤æ–­æ–¹æ³•ï¼Œå¯ä»¥é‡‡ç”¨ <code>Object.prototype.toString.call()</code>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptå¼€å‘è€…å¿…çŸ¥çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼šå‘Šåˆ«console.logæ—¶ä»£ï¼]]></title>    <link>https://juejin.cn/post/7595858063502639138</link>    <guid>https://juejin.cn/post/7595858063502639138</guid>    <pubDate>2026-01-17T04:19:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858063502639138" data-draft-id="7595858353660510242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptå¼€å‘è€…å¿…çŸ¥çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼šå‘Šåˆ«console.logæ—¶ä»£ï¼"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T04:19:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ©™çš„ç™¾å®ç®±"/> <meta itemprop="url" content="https://juejin.cn/user/1638743356481367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptå¼€å‘è€…å¿…çŸ¥çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼šå‘Šåˆ«console.logæ—¶ä»£ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1638743356481367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ©™çš„ç™¾å®ç®±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T04:19:20.000Z" title="Sat Jan 17 2026 04:19:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>JavaScriptå¼€å‘è€…å¿…çŸ¥çš„5ä¸ªé«˜æ•ˆè°ƒè¯•æŠ€å·§ï¼šå‘Šåˆ«console.logæ—¶ä»£ï¼</strong></h2>
<h3 data-id="heading-1">å¼•è¨€</h3>
<p>åœ¨JavaScriptå¼€å‘ä¸­ï¼Œè°ƒè¯•æ˜¯ä¸å¯é¿å…çš„ä¸€éƒ¨åˆ†ã€‚å°½ç®¡<code>console.log</code>æ˜¯æœ€ç®€å•ç›´æ¥çš„è°ƒè¯•å·¥å…·ï¼Œä½†å®ƒè¿œéæœ€é«˜æ•ˆçš„æ–¹å¼ã€‚éšç€ç°ä»£æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„æ—¥ç›Šå¼ºå¤§ï¼Œä»¥åŠNode.jsç”Ÿæ€çš„æˆç†Ÿï¼Œå¼€å‘è€…æ‹¥æœ‰äº†æ›´å¤šé«˜æ•ˆçš„è°ƒè¯•æ–¹æ³•ã€‚æœ¬æ–‡å°†ä»‹ç»5ä¸ªä¸“ä¸šçº§çš„JavaScriptè°ƒè¯•æŠ€å·§ï¼Œå¸®åŠ©ä½ å½»åº•å‘Šåˆ«â€œ<code>console.log</code>æ³›æ»¥â€çš„æ—¶ä»£ï¼Œæå‡å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚</p>
<hr/>
<h3 data-id="heading-2">1. ä½¿ç”¨æ–­ç‚¹è°ƒè¯•ï¼ˆBreakpointsï¼‰</h3>
<h4 data-id="heading-3">ä¸ºä»€ä¹ˆæ–­ç‚¹æ¯”<code>console.log</code>æ›´å¼ºå¤§ï¼Ÿ</h4>
<p>æ–­ç‚¹è°ƒè¯•å…è®¸ä½ åœ¨ä»£ç æ‰§è¡Œçš„ç‰¹å®šä½ç½®æš‚åœç¨‹åºï¼ŒæŸ¥çœ‹å½“å‰çš„å˜é‡çŠ¶æ€ã€è°ƒç”¨æ ˆä»¥åŠä½œç”¨åŸŸé“¾ã€‚ç›¸æ¯”<code>console.log</code>ï¼Œæ–­ç‚¹æä¾›äº†åŠ¨æ€çš„ã€äº¤äº’å¼çš„è°ƒè¯•ä½“éªŒï¼Œæ— éœ€åå¤ä¿®æ”¹ä»£ç å¹¶åˆ·æ–°é¡µé¢ã€‚</p>
<h4 data-id="heading-4">å¦‚ä½•è®¾ç½®æ–­ç‚¹ï¼Ÿ</h4>
<ol>
<li>
<p><strong>æµè§ˆå™¨ä¸­çš„æ–­ç‚¹</strong>ï¼š</p>
<ul>
<li>åœ¨Chrome DevToolsçš„â€œSourcesâ€é¢æ¿ä¸­ï¼Œæ‰¾åˆ°ç›®æ ‡æ–‡ä»¶å¹¶ç‚¹å‡»è¡Œå·æ·»åŠ æ–­ç‚¹ã€‚</li>
<li>ä½¿ç”¨æ¡ä»¶æ–­ç‚¹ï¼ˆå³é”®ç‚¹å‡»è¡Œå·é€‰æ‹©â€œAdd conditional breakpointâ€ï¼‰ï¼Œä»…åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶æš‚åœæ‰§è¡Œã€‚</li>
<li>ä½¿ç”¨DOMæ–­ç‚¹ï¼ˆElementsé¢æ¿å³é”®DOMèŠ‚ç‚¹ï¼‰ç›‘å¬DOMç»“æ„å˜åŒ–æˆ–äº‹ä»¶è§¦å‘ã€‚</li>
</ul>
</li>
<li>
<p><strong>Node.jsä¸­çš„æ–­ç‚¹</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>debugger</code>å…³é”®å­—ç»“åˆ<code>--inspect</code>æ ‡å¿—å¯åŠ¨Node.jsåº”ç”¨ï¼š
<pre><code class="hljs language-bash" lang="bash">node --inspect your-script.js
</code></pre>
</li>
<li>é€šè¿‡Chrome DevToolsè¿æ¥åˆ°Node.jsè¿›ç¨‹è¿›è¡Œè°ƒè¯•ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-5">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>å¤æ‚é€»è¾‘çš„é€æ­¥è·Ÿè¸ªã€‚</li>
<li>å¼‚æ­¥ä»£ç çš„æ‰§è¡Œé¡ºåºåˆ†æã€‚</li>
<li>æ€§èƒ½é—®é¢˜çš„å®šä½ï¼ˆç»“åˆPerformanceé¢æ¿ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-6">2. åˆ©ç”¨æ—¥å¿—å¢å¼ºå·¥å…·ï¼ˆConsole APIçš„é«˜çº§ç”¨æ³•ï¼‰</h3>
<p>å¦‚æœä½ ä»ç„¶éœ€è¦æ—¥å¿—è¾“å‡ºï¼Œä¸å¦¨è¯•è¯•<code>console</code>å¯¹è±¡çš„æ›´å¤šåŠŸèƒ½ï¼Œè€Œä¸ä»…ä»…æ˜¯<code>console.log</code>ï¼š</p>
<h4 data-id="heading-7"><code>console.table()</code></h4>
<p>ä»¥è¡¨æ ¼å½¢å¼æ‰“å°æ•°ç»„æˆ–å¯¹è±¡ï¼Œä¾¿äºç»“æ„åŒ–æ•°æ®çš„å¯è§†åŒ–ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> users = [{ <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> }, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> }];
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">table</span>(users);
</code></pre>
<h4 data-id="heading-8"><code>console.group()</code>å’Œ<code>console.groupEnd()</code></h4>
<p>å°†ç›¸å…³æ—¥å¿—åˆ†ç»„æ˜¾ç¤ºï¼Œé¿å…è¾“å‡ºæ··ä¹±ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">group</span>(<span class="hljs-string">'User Details'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Name: Alice'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Age: 25'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">groupEnd</span>();
</code></pre>
<h4 data-id="heading-9"><code>console.time()</code>å’Œ<code>console.timeEnd()</code></h4>
<p>æµ‹é‡ä»£ç å—çš„æ‰§è¡Œæ—¶é—´ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'API Call'</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/data'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'API Call'</span>); <span class="hljs-comment">// è¾“å‡º: API Call: 120ms</span>
</code></pre>
<h4 data-id="heading-10"><code>console.trace()</code></h4>
<p>æ‰“å°å‡½æ•°è°ƒç”¨çš„å †æ ˆè½¨è¿¹ï¼Œå¿«é€Ÿå®šä½é—®é¢˜æ¥æºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"/>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">trace</span>(<span class="hljs-string">'Trace from foo'</span>);
}
<span class="hljs-title function_">foo</span>();
</code></pre>
<hr/>
<h3 data-id="heading-11">3. Chrome DevToolsçš„â€œé»‘ç§‘æŠ€â€</h3>
<p>ç°ä»£æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·æä¾›äº†è®¸å¤šä¸ä¸ºäººçŸ¥çš„é«˜æ•ˆåŠŸèƒ½ï¼š</p>
<h4 data-id="heading-12"><strong>å³æ—¶è¡¨è¾¾å¼ï¼ˆLive Expressionsï¼‰</strong></h4>
<p>åœ¨DevToolsçš„Consoleé¢æ¿ä¸­ç‚¹å‡»â€œEyeâ€å›¾æ ‡ï¼Œæ·»åŠ ä¸€ä¸ªå®æ—¶æ›´æ–°çš„è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ç›‘æ§æŸä¸ªå˜é‡çš„å€¼å˜åŒ–ï¼Œæ— éœ€åå¤æ‰‹åŠ¨è¾“å…¥å‘½ä»¤ã€‚</p>
<h4 data-id="heading-13"><strong>ç½‘ç»œè¯·æ±‚é‡æ”¾ä¸ä¿®æ”¹</strong></h4>
<p>åœ¨Networké¢æ¿ä¸­å³é”®è¯·æ±‚ï¼Œé€‰æ‹©â€œReplay XHRâ€æˆ–â€œEdit and Replayâ€ï¼Œç›´æ¥ä¿®æ”¹è¯·æ±‚å‚æ•°å¹¶é‡æ–°å‘é€ï¼Œé€‚åˆæµ‹è¯•APIè¾¹ç•Œæ¡ä»¶ã€‚</p>
<h4 data-id="heading-14"><strong>å†…å­˜ä¸æ€§èƒ½åˆ†æ</strong></h4>
<ul>
<li><strong>Memoryé¢æ¿</strong>ï¼šæ•è·å †å¿«ç…§ï¼ŒæŸ¥æ‰¾å†…å­˜æ³„æ¼ã€‚</li>
<li><strong>Performanceé¢æ¿</strong>ï¼šå½•åˆ¶å¹¶åˆ†æè¿è¡Œæ—¶æ€§èƒ½ç“¶é¢ˆã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-15">4. Node.jsè°ƒè¯•ä¸é”™è¯¯è¿½è¸ªå·¥å…·</h3>
<p>å¯¹äºåç«¯æˆ–å…¨æ ˆå¼€å‘è€…ï¼ŒNode.jsç”Ÿæ€æä¾›äº†å¼ºå¤§çš„å·¥å…·é“¾ï¼š</p>
<h4 data-id="heading-16"><strong>å†…ç½®Debuggeræ¨¡å—</strong></h4>
<p>é€šè¿‡<code>node inspect your-script.js</code>å¯åŠ¨äº¤äº’å¼è°ƒè¯•ä¼šè¯ï¼Œæ”¯æŒæ­¥è¿›ï¼ˆstep over/intoï¼‰ã€è§‚å¯Ÿè¡¨è¾¾å¼ç­‰æ“ä½œã€‚</p>
<h4 data-id="heading-17"><strong>VS Codeé›†æˆè°ƒè¯•</strong></h4>
<p>é…ç½®<code>.vscode/launch.json</code>æ–‡ä»¶åï¼Œå¯ç›´æ¥åœ¨VS Codeä¸­æ‰“æ–­ç‚¹å’Œè°ƒè¯•Node.jsåº”ç”¨ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0.2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"configurations"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"request"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"launch"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Debug Node"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"program"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"${workspaceFolder}/app.js"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-18"><strong>é”™è¯¯è¿½è¸ªæœåŠ¡ï¼ˆSentry, New Relicï¼‰</strong></h4>
<p>é›†æˆSentryç­‰å·¥å…·å¯æ•è·ç”Ÿäº§ç¯å¢ƒçš„å¼‚å¸¸å¹¶ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šï¼ˆåŒ…æ‹¬è°ƒç”¨æ ˆã€ç¯å¢ƒå˜é‡ç­‰ï¼‰ï¼Œè¿œè¶…æœ¬åœ°<code>try-catch + console.error</code>çš„èƒ½åŠ›èŒƒå›´ã€‚</p>
<hr/>
<h3 data-id="heading-19">5. Source Mapä¸ç”Ÿäº§ç¯å¢ƒè°ƒè¯•</h3>
<p>ç”Ÿäº§ç¯å¢ƒçš„ä»£ç é€šå¸¸ç»è¿‡å‹ç¼©å’Œæ··æ·†ï¼Œä½†é€šè¿‡Source Mapå¯ä»¥è¿˜åŸåŸå§‹ä»£ç ç»“æ„è¿›è¡Œè°ƒè¯•ï¼š</p>
<h4 data-id="heading-20"><strong>ç”ŸæˆSource Map</strong></h4>
<p>åœ¨Webpackã€Rollupç­‰æ„å»ºå·¥å…·ä¸­å¯ç”¨é…ç½®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// webpack.config.js</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">devtool</span>: <span class="hljs-string">'source-map'</span>,
};
</code></pre>
<h4 data-id="heading-21"><strong>æµè§ˆå™¨åŠ è½½Source Map</strong></h4>
<p>ç¡®ä¿ç”Ÿäº§ç¯å¢ƒçš„JSæ–‡ä»¶æœ«å°¾åŒ…å«æ³¨é‡Šæ˜ å°„è·¯å¾„ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//# sourceMappingURL=app.min.js.map</span>
</code></pre>
<h4 data-id="heading-22"><strong>Node.jsçš„Source Mapæ”¯æŒ</strong></h4>
<p>é€šè¿‡<code>--enable-source-maps</code>æ ‡å¿—è¿è¡ŒNode.jsåº”ç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">node --enable-source-maps app.js
</code></pre>
<hr/>
<h3 data-id="heading-23">æ€»ç»“</h3>
<p>ä»åŸå§‹çš„<code>console.log</code>åˆ°ç°ä»£çš„æ–­ç‚¹è°ƒè¯•ã€æ€§èƒ½åˆ†æå’Œç”Ÿäº§ç¯å¢ƒè¿½è¸ªï¼ŒJavaScriptå¼€å‘è€…æ‹¥æœ‰ä¸°å¯Œçš„å·¥å…·é“¾æ¥åº”å¯¹å„ç§å¤æ‚çš„è°ƒè¯•åœºæ™¯ã€‚æŒæ¡è¿™äº›æŠ€å·§ä¸ä»…èƒ½å¤§å¹…æå‡æ•ˆç‡ï¼Œè¿˜èƒ½å¸®åŠ©ä½ æ›´æ·±å…¥åœ°ç†è§£ä»£ç çš„è¿è¡Œæœºåˆ¶å’Œæ½œåœ¨é—®é¢˜ã€‚ä¸‹ä¸€æ¬¡å½“ä½ å‡†å¤‡éšæ‰‹å†™ä¸€ä¸ª<code>console.log</code>æ—¶â€”â€”ä¸å¦¨å…ˆæƒ³æƒ³æ˜¯å¦æœ‰æ›´é«˜æ•ˆçš„æ›¿ä»£æ–¹æ¡ˆï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ§  DeepGEMMï¼šå½“çŸ©é˜µä¹˜æ³•é‡ä¸Šæ·±åº¦å­¦ä¹ çš„æµªæ¼« âœ¨]]></title>    <link>https://juejin.cn/post/7596181746060967963</link>    <guid>https://juejin.cn/post/7596181746060967963</guid>    <pubDate>2026-01-17T04:26:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596181746060967963" data-draft-id="7596181746060951579" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ§  DeepGEMMï¼šå½“çŸ©é˜µä¹˜æ³•é‡ä¸Šæ·±åº¦å­¦ä¹ çš„æµªæ¼« âœ¨"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T04:26:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ§  DeepGEMMï¼šå½“çŸ©é˜µä¹˜æ³•é‡ä¸Šæ·±åº¦å­¦ä¹ çš„æµªæ¼« âœ¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T04:26:31.000Z" title="Sat Jan 17 2026 04:26:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸŒ ä¸€ã€åºç« ï¼šä¸ºä»€ä¹ˆæ˜¯ GEMMï¼Ÿ</h2>
<p>åœ¨æ·±åº¦å­¦ä¹ çš„ä¸–ç•Œé‡Œï¼Œæœ‰ä¸€ä¸ªä¸ä¸ºäººçŸ¥çš„çœŸç†ï¼š</p>
<blockquote>
<p><strong>æ‰€æœ‰çš„ç®—å­ï¼Œæœ€ç»ˆéƒ½èƒ½å½’ç»“ä¸ºçŸ©é˜µä¹˜æ³•ã€‚</strong></p>
</blockquote>
<p>æ— è®ºæ˜¯å·ç§¯ã€å…¨è¿æ¥ã€Transformers çš„æ³¨æ„åŠ›å±‚ï¼Œè¿˜æ˜¯é‚£å †èŠ±å“¨çš„å½’ä¸€åŒ–æ“ä½œï¼Œæœ€ç»ˆéƒ½éœ€è¦é  â€œçŸ©é˜µä¹˜æ³•â€ æ¥å‘ç”µã€‚<br/>
äºæ˜¯ï¼Œ<strong>GEMMï¼ˆGeneral Matrix Multiplyï¼‰</strong> ä¹Ÿå°±æˆäº†æ•´ä¸ª AI è®­ç»ƒä¸æ¨ç†çš„çµé­‚å¼•æ“ã€‚</p>
<p>æˆ–è€…æ›´é€šä¿—åœ°è¯´ï¼š</p>
<blockquote>
<p>Deep Learning æ²¡äº† GEMMï¼Œå°±åƒå’–å•¡å¤±å»äº†å’–å•¡å› ï¼ŒReact å¤±å»äº†è™šæ‹Ÿ DOMï¼Œç¨‹åºå‘˜å¤±å»äº†å‘¨äº”æ™šä¸Šã€‚â˜•</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">âš™ï¸ äºŒã€ä»€ä¹ˆæ˜¯ GEMMï¼Ÿ</h2>
<blockquote>
<p>General Matrix Multiplyï¼š<br/>
è®¡ç®—ä¸¤ä¸ªçŸ©é˜µ <code>A</code> å’Œ <code>B</code> çš„ä¹˜ç§¯ï¼Œç»“æœæ˜¯çŸ©é˜µ <code>C</code>ã€‚</p>
</blockquote>
<p>ç”¨é€šä¿—çš„è¯­è¨€æ‹†å¼€æ¥è¯´ï¼š</p>
<ul>
<li>
<p><strong>è¾“å…¥ï¼š</strong></p>
<ul>
<li><code>A</code>ï¼Œå¤§å°ä¸º (m, n)</li>
<li><code>B</code>ï¼Œå¤§å°ä¸º (n, k)</li>
</ul>
</li>
<li>
<p><strong>è¾“å‡ºï¼š</strong></p>
<ul>
<li><code>C</code>ï¼Œå¤§å°ä¸º (m, k)</li>
</ul>
</li>
</ul>
<p>æ¯ä¸€ä¸ªå…ƒç´  <code>C[i][j]</code> éƒ½æ˜¯ <code>A</code> çš„ç¬¬ <code>i</code> è¡Œä¸ <code>B</code> çš„ç¬¬ <code>j</code> åˆ—çš„â€œç‚¹ç§¯â€ã€‚</p>
<p>å¦‚æœç”¨è¯­è¨€æè¿°è¿™ä¸ªç‚¹ç§¯ï¼š</p>
<blockquote>
<p>æŠŠ <code>A[i]</code> è¿™ä¸€æ•´è¡Œå½“ä½œä¸€ä¸ªå‘é‡ï¼Œä¹˜ä»¥ <code>B</code> çš„ç¬¬ <code>j</code> åˆ—ï¼Œç„¶åæŠŠæ¯ä¸€é¡¹ç›¸ä¹˜ï¼Œå†å…¨éƒ¨åŠ åœ¨ä¸€èµ·ã€‚</p>
</blockquote>
<p>ğŸ’¡ <strong>è¿™æ˜¯æ‰€æœ‰ GPU åŠ é€Ÿçš„æ ¹æœ¬æ“ä½œã€‚</strong></p>
<hr/>
<h2 data-id="heading-2">ğŸ’¥ ä¸‰ã€DeepGEMMï¼šä¸æ­¢æ˜¯ä¹˜æ³•ï¼Œè€Œæ˜¯â€œæ·±åº¦çš„ä¹˜æ³•â€</h2>
<p>DeepGEMM çš„æ¦‚å¿µå¯ä»¥ç†è§£ä¸ºï¼š</p>
<blockquote>
<p><strong>å°†ä¼ ç»Ÿçš„ GEMM æ“ä½œä¸æ·±åº¦å­¦ä¹ ç®—å­èåˆï¼Œé€šè¿‡ç¼–è¯‘ä¼˜åŒ–ä¸ç¡¬ä»¶è´´åˆï¼Œå®ç°æè‡´ç®—åŠ›åˆ©ç”¨ã€‚</strong></p>
</blockquote>
<p>æ¢å¥è¯è¯´ â€”â€”<br/>
DeepGEMM æ˜¯é‚£ä¸ªâ€œæ‡‚ç¡¬ä»¶çš„çŸ©é˜µä¹˜æ³•â€ ğŸŒªï¸</p>
<h3 data-id="heading-3">ğŸ§© å…³é”®æ€æƒ³</h3>
<ol>
<li><strong>æ•°æ®å—åŒ– (Tiling)</strong><br/>
æŠŠå·¨å¤§çš„çŸ©é˜µåˆ†å—ï¼Œè®©æ¯ä¸ªçº¿ç¨‹å—åœ¨ GPU çš„å¯„å­˜å™¨æˆ–å…±äº«å†…å­˜ä¸­å®Œæˆä¸€å°éƒ¨åˆ†å·¥ä½œã€‚</li>
<li><strong>æµæ°´çº¿å¹¶è¡Œ (Pipeline Parallelism)</strong><br/>
æ¯ä¸€ä¸ª SMï¼ˆStreaming Multiprocessorï¼‰åƒå·¥å‚ç”Ÿäº§çº¿ä¸€æ ·ï¼Œä¸åœæ¥æ”¶ä¸‹ä¸€æ‰¹æ•°æ®ã€‚</li>
<li><strong>æŒ‡ä»¤èåˆ (FMA / TensorCore Magic)</strong><br/>
â€œä¹˜ä¸€ä¸‹åŠ ä¸€ä¸‹â€â†’ â€œä¸€æ¬¡ä¹˜åŠ æ“ä½œâ€<br/>
è¿™å°±æ˜¯ Tensor Core å’Œ FMA (Fused Multiply-Add) å‘å…‰å‘çƒ­çš„åœ°æ–¹ âœ¨</li>
<li><strong>é‡åŒ–ä¸ä½ç²¾åº¦ (FP16 / INT8)</strong><br/>
ç”¨æ›´å°‘çš„æ¯”ç‰¹è¡¨ç¤ºæ•°å€¼ï¼Œè®©ååç¿»å€ï¼å“ªæ€•ç¨æœ‰â€œä¸ç²¾å‡†â€ï¼Œæ¨¡å‹ä¹Ÿè¿˜èƒ½å­¦ä¼šäººè¯ ğŸ˜</li>
</ol>
<hr/>
<h2 data-id="heading-4">ğŸ“œ å››ã€è®©æˆ‘ä»¬å†™ä¸€ä¸ª ï¼šJavaScript å®è·µç¯‡</h2>
<p>è™½ç„¶ JS å¹¶ä¸æ˜¯çŸ©é˜µä¹˜æ³•çš„æœ€ä½³æ‹æ¡£ï¼ˆç›¸æ¯”äº CUDAï¼Œå®ƒç®€ç›´å°±æ˜¯ç”µåŠ¨è½¦å»èµ›è½¦èµ›é“ ğŸ˜‚ï¼‰ï¼Œ<br/>
ä½†æˆ‘ä»¬ä»ç„¶èƒ½ä½“ä¼š GEMM çš„çµé­‚ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ªçº¯å‰ç«¯çš„ DeepGEMM å°å®éªŒ ğŸ‘‡</p>
<pre><code class="hljs language-ini" lang="ini">// ğŸš€ DeepGEMM.js
// ç”¨æœ€æœ´ç´ çš„æ–¹å¼â€œæ„Ÿå—â€çŸ©é˜µä¹˜æ³•çš„é­…åŠ›

function deepGEMM(A, B) {
  const <span class="hljs-attr">m</span> = A.length<span class="hljs-comment">;</span>
  const <span class="hljs-attr">n</span> = A[<span class="hljs-number">0</span>].length<span class="hljs-comment">;</span>
  const <span class="hljs-attr">k</span> = B[<span class="hljs-number">0</span>].length<span class="hljs-comment">;</span>

  // åˆå§‹åŒ–ç»“æœçŸ©é˜µ C
  const <span class="hljs-attr">C</span> = Array.from({ length: m }, () =&gt; Array(k).fill(<span class="hljs-number">0</span>))<span class="hljs-comment">;</span>

  // è®©æˆ‘ä»¬æ„Ÿå—ä¸€ä¸‹çŸ©é˜µä¹˜æ³•çš„â€œæ·±åº¦â€
  console.time("DeepGEMM Execution")<span class="hljs-comment">;</span>

  for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; m; i++) {</span>
    for (let <span class="hljs-attr">j</span> = <span class="hljs-number">0</span><span class="hljs-comment">; j &lt; k; j++) {</span>
      let <span class="hljs-attr">sum</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
      for (let <span class="hljs-attr">t</span> = <span class="hljs-number">0</span><span class="hljs-comment">; t &lt; n; t++) {</span>
        sum += A<span class="hljs-section">[i]</span><span class="hljs-section">[t]</span> * B<span class="hljs-section">[t]</span><span class="hljs-section">[j]</span><span class="hljs-comment">; // âœ¨ ä¸€æ¬¡ç›¸ä¹˜ï¼Œä¸€æ¬¡çµé­‚ç¢°æ’ï¼</span>
      }
      C<span class="hljs-section">[i]</span><span class="hljs-section">[j]</span> = sum<span class="hljs-comment">;</span>
    }
  }

  console.timeEnd("DeepGEMM Execution")<span class="hljs-comment">;</span>

  return C<span class="hljs-comment">;</span>
}

// æµ‹è¯•ä¸€ä¸‹ï¼
const <span class="hljs-attr">A</span> = [
  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
  [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],
]<span class="hljs-comment">;</span>

const <span class="hljs-attr">B</span> = [
  [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>],
  [<span class="hljs-number">9</span>, <span class="hljs-number">10</span>],
  [<span class="hljs-number">11</span>, <span class="hljs-number">12</span>],
]<span class="hljs-comment">;</span>

console.table(deepGEMM(A, B))<span class="hljs-comment">;</span>
</code></pre>
<p>è¾“å‡ºç»“æœï¼š</p>
<pre><code class="hljs language-perl" lang="perl">DeepGEMM Execution: <span class="hljs-number">0</span>.08ms
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (<span class="hljs-keyword">index</span>) â”‚   <span class="hljs-number">0</span>   â”‚   <span class="hljs-number">1</span>   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    <span class="hljs-number">0</span>    â”‚  <span class="hljs-number">58</span>   â”‚  <span class="hljs-number">64</span>   â”‚
â”‚    <span class="hljs-number">1</span>    â”‚ <span class="hljs-number">139</span>   â”‚ <span class="hljs-number">154</span>   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ğŸ‰ Task Doneï¼ä½ åˆšåˆšå®Œæˆäº†è‡ªå·±çš„ç¬¬ä¸€ä¸ª <em>DeepGEMM Demo</em>ï¼</p>
<hr/>
<h2 data-id="heading-5">ğŸ§® äº”ã€å¦‚æœæˆ‘ä»¬ä¸æ»¡è¶³äº CPU å‘¢ï¼Ÿ</h2>
<p>é‚£å°±è¦è¯·å‡º GPU åŠ é€Ÿ â€”â€” ä½¿ç”¨ WebGPU æˆ–è€… CUDAã€‚</p>
<p>åœ¨ DeepGEMM çš„çœŸæ­£å®ç°ä¸­ï¼Œä¼šç»å†è¿™äº›é˜¶æ®µï¼š</p>
<ol>
<li><strong>Block åˆ†å—ä¸ Memory Coalescing</strong></li>
<li><strong>Shared Memory Reuse</strong></li>
<li><strong>Tensor Core æŒ‡ä»¤èåˆ</strong></li>
<li><strong>Asynchronous Pipeline Load</strong></li>
<li><strong>Instruction-Level Parallelism</strong></li>
</ol>
<p>æ¯ä¸€æ­¥éƒ½åƒæ˜¯ä¸€åœº <strong>ç¼–è¯‘å™¨ä¸ç¡¬ä»¶å·¥ç¨‹å¸ˆçš„å…±èˆ</strong>ã€‚ğŸ’ƒğŸ•º</p>
<hr/>
<h2 data-id="heading-6">ğŸŒ å…­ã€å»¶ä¼¸æ€è€ƒï¼šDeepGEMM çš„å“²å­¦æ„ä¹‰</h2>
<p>DeepGEMM ä¸ä»…ä»…æ˜¯é«˜æ€§èƒ½è®¡ç®—çš„ä»£è¡¨ï¼Œ<br/>
æ›´æ˜¯ä¸€ç§è®¡ç®—æ€ç»´çš„å…·è±¡åŒ–ã€‚</p>
<p>å®ƒå‘Šè¯‰æˆ‘ä»¬ï¼š</p>
<blockquote>
<p>â€œä»»ä½•å¤æ‚çš„æ™ºèƒ½ï¼ŒèƒŒåéƒ½ç¦»ä¸å¼€æœ€ç®€å•çš„ä¹˜ä¸åŠ ã€‚â€</p>
</blockquote>
<p>è¿™åƒæäº†äººç”Ÿï¼š</p>
<ul>
<li>æˆ‘ä»¬çš„æ¯ä¸€æ¬¡åŠªåŠ›ï¼ˆä¹˜æ³•ï¼‰ï¼Œ</li>
<li>éƒ½ä¼šç»å†ç°å®çš„åé¦ˆï¼ˆåŠ æ³•ï¼‰ï¼Œ</li>
<li>ç´¯ç§¯æˆæœ€ç»ˆçš„è‡ªæˆ‘çŸ©é˜µï¼ˆCï¼‰ã€‚ğŸ’«</li>
</ul>
<hr/>
<h2 data-id="heading-7">ğŸ§© ä¸ƒã€ç»“è¯­ï¼šè®©ä¹˜æ³•ç»§ç»­å‘å…‰</h2>
<p>DeepGEMM å¹¶ä¸æ˜¯ç»ˆç‚¹ï¼Œè€Œæ˜¯èµ·ç‚¹ã€‚<br/>
éšç€ç¡¬ä»¶çš„å‘å±•ï¼Œæˆ‘ä»¬æ­£åœ¨è¿æ¥ä¸€ä¸ªâ€œç®—åŠ›ç¾å­¦â€çš„æ—¶ä»£ã€‚<br/>
åœ¨é‚£ä¸ªæ—¶ä»£ï¼ŒFP8ã€BF16ã€Int4 å°†æˆä¸ºè‰ºæœ¯å®¶çš„è°ƒè‰²ç›˜ï¼Œ<br/>
è€Œæˆ‘ä»¬â€”â€”ç¨‹åºå‘˜ï¼Œå°±æ˜¯çŸ©é˜µçš„è¯—äººã€‚ğŸ–‹ï¸</p>
<hr/>
<p><strong>ğŸ‡ è‡´æ•¬æ¯ä¸€ä½åœ¨ GPU é£æ‰‡å£°ä¸­ç¼–è¯‘çš„ä½ ã€‚</strong><br/>
<strong>â€”â€” DeepGEMMï¼Œæ˜¯ä¹˜æ³•ï¼Œæ˜¯è‰ºæœ¯ï¼Œæ˜¯æµªæ¼«ã€‚</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[âš¡ FlashMLAï¼šè®©æ³¨æ„åŠ›é£èµ·æ¥çš„ã€Œé—ªç”µç®—æœ¯ã€ ğŸš€]]></title>    <link>https://juejin.cn/post/7595800318519361542</link>    <guid>https://juejin.cn/post/7595800318519361542</guid>    <pubDate>2026-01-17T04:31:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595800318519361542" data-draft-id="7595831738234109961" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="âš¡ FlashMLAï¼šè®©æ³¨æ„åŠ›é£èµ·æ¥çš„ã€Œé—ªç”µç®—æœ¯ã€ ğŸš€"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T04:31:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            âš¡ FlashMLAï¼šè®©æ³¨æ„åŠ›é£èµ·æ¥çš„ã€Œé—ªç”µç®—æœ¯ã€ ğŸš€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T04:31:01.000Z" title="Sat Jan 17 2026 04:31:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>â€œå¦‚æœè¯´ Transformer æ˜¯æ·±åº¦å­¦ä¹ çš„çµé­‚ï¼Œé‚£ä¹ˆ Multi-Head Attention å°±æ˜¯é‚£é¢—ä¸æ–­é—ªè€€çš„æ˜Ÿå­ã€‚è€Œ FlashMLA â€”â€” è®©é‚£é¢—æ˜Ÿç‡ƒçƒ§å¾—æ›´å¿«ã€æ›´äº®ã€æ›´æ™ºèƒ½ã€‚â€<br/>
â€”â€” ä¸€ä½æ²‰è¿· GPU å†…æ ¸è°ƒä¼˜çš„è®¡ç®—æœºç§‘å­¦å®¶ ğŸŒŒ</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸŒ ä¸€ã€ä»€ä¹ˆæ˜¯ FlashMLAï¼Ÿ</h2>
<p>é¦–å…ˆï¼Œæ¥ç‚¹æ­£ç»å®šä¹‰ï¼Œä½†æˆ‘ä»¬è¦è®²å¾—æ¯”è®ºæ–‡æ›´å®¹æ˜“æ¶ˆåŒ–ï¼š</p>
<blockquote>
<p><strong>FlashMLA = Flash Multi-Head Linear Attention</strong></p>
</blockquote>
<p>ğŸ’¡ å®ƒæ˜¯ä¸€ä¸ªç”¨äºé«˜æ•ˆå®ç° <strong>å¤šå¤´æ³¨æ„åŠ› (Multi-Head Attention)</strong> çš„ä¼˜åŒ–ç®—æ³•ï¼Œç›®æ ‡æ˜¯ï¼š</p>
<ol>
<li><strong>æ›´å¿«</strong>ï¼ˆæ¯”ä¼ ç»Ÿæ³¨æ„åŠ›å¿«å¤šå€ï¼‰âš¡</li>
<li><strong>æ›´çœå†…å­˜</strong>ï¼ˆå°‘å¾—åƒ Transformer åƒä½è„‚é¥®é£Ÿï¼‰ğŸ¥—</li>
<li><strong>æ›´ç¨³å®š</strong>ï¼ˆé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€æ•°å€¼æº¢å‡ºï¼‰ğŸ§˜</li>
</ol>
<hr/>
<h2 data-id="heading-1">ğŸ­ äºŒã€Attention çš„æµªæ¼«ä¸ä»£ä»·</h2>
<p>æƒ³è±¡ä¸€ä¸ªåœºæ™¯ï¼š</p>
<blockquote>
<p>æ¯ä¸ªè¯éƒ½åœ¨é—®ï¼šâ€œæˆ‘åº”è¯¥æ³¨æ„è°ï¼Ÿâ€ ğŸ¤”<br/>
ç„¶åè®¡ç®—æœºå¸®å®ƒç®—å‡ºï¼šè°æœ€é‡è¦ ğŸ§ ã€‚</p>
</blockquote>
<p>è¿™å°±æ˜¯æ³¨æ„åŠ›æœºåˆ¶çš„æœ¬è´¨ï¼š</p>
<p>æ¯ä¸ªè¯ï¼ˆQuery, Qï¼‰ä¼šå»åŒ¹é…æ‰€æœ‰è¯ï¼ˆKey, Kï¼‰ï¼Œå¹¶ä½¿ç”¨ä»–ä»¬çš„å†…å®¹ï¼ˆValue, Vï¼‰è¿›è¡ŒåŠ æƒæ±‚å’Œã€‚</p>
<p>å¦‚æœä½ å¤©èµ‹å¼‚ç¦€è®°å¾—è®ºæ–‡åŸç†ï¼ˆæˆ‘ä»¬é¿å¼€å…¬å¼ï¼‰ï¼Œ<br/>
æ ¸å¿ƒæ€æƒ³å…¶å®å¾ˆç®€å•ğŸ‘‡ï¼š</p>

























<table><thead><tr><th align="left">ä½ æä¾›çš„</th><th align="left">å®ƒä»£è¡¨çš„ä¸œè¥¿</th></tr></thead><tbody><tr><td align="left">Q</td><td align="left">æˆ‘æ˜¯è°</td></tr><tr><td align="left">K</td><td align="left">åˆ«äººæ˜¯è°</td></tr><tr><td align="left">V</td><td align="left">åˆ«äººæœ‰ä»€ä¹ˆä»·å€¼</td></tr><tr><td align="left">Softmax(QÂ·Káµ€)V</td><td align="left">æˆ‘è¦ä»åˆ«äººé‚£é‡Œå­¦åˆ°ç‚¹ä»€ä¹ˆ</td></tr></tbody></table>
<p>ğŸ’¡ é—®é¢˜æ˜¯ï¼š<br/>
è¿™ä¸ªè®¡ç®—æ˜¯ <strong>ã€Œå…¨é‡ nÃ—n çº§åˆ«ã€</strong> çš„ï¼<br/>
å½“å¥å­é•¿ç‚¹ï¼Œæ¯”å¦‚ 8k tokens æ—¶ï¼Œæ˜¾å­˜ç›´æ¥çˆ†ç‚¸ ğŸ’£ã€‚</p>
<hr/>
<h2 data-id="heading-2">ğŸ§© ä¸‰ã€FlashMLAï¼šæ³¨æ„åŠ›ä¸å†â€œå…¨å±€æ‰«æâ€</h2>
<p>ä¼ ç»Ÿæ³¨æ„åŠ›çš„é—®é¢˜åœ¨äºå®ƒè®¡ç®—çš„å¤æ‚åº¦æ˜¯ <strong>O(nÂ²)</strong> ï¼Œ<br/>
è€Œ FlashMLA çš„çµé­‚å°±æ˜¯ï¼š</p>
<blockquote>
<p>ğŸ‘‰ â€œè®©æ³¨æ„åŠ›æµå¼è®¡ç®—ï¼Œåªçœ‹è¯¥çœ‹çš„ï¼â€</p>
</blockquote>
<hr/>
<h3 data-id="heading-3">ğŸ§  FlashMLA çš„æ ¸å¿ƒé­”æ³•</h3>
<ol>
<li><strong>åˆ†å— (Tiling / Streaming Chunking)</strong><br/>
å°†åºåˆ—åˆ†æˆå°å—ï¼ˆæ¯”å¦‚ 256ï½512 tokensï¼‰ï¼Œåªåœ¨å—ä¸å—ä¹‹é—´è¿›è¡Œå±€éƒ¨è®¡ç®—ã€‚<br/>
è¿™è®©è®¡ç®—æ›´é«˜æ•ˆï¼Œä¹Ÿè®©æ˜¾å­˜æ›´ç¨³å®šã€‚</li>
<li><strong>åœ¨çº¿ Softmax (Online Normalization)</strong><br/>
ä¸å†ä¸€æ¬¡æ€§è®¡ç®—æ‰€æœ‰æ³¨æ„åŠ›å¾—åˆ†ï¼Œè€Œæ˜¯è¾¹è®¡ç®—è¾¹å½’ä¸€åŒ–ï¼Œ<br/>
åƒè¾¹èµ°è¾¹å–çš„è‡ªåŠ¨æ€§å’–å•¡æœº â˜•ã€‚</li>
<li><strong>å¯„å­˜å™¨çº§æµæ°´çº¿ (Register-level Pipelining)</strong><br/>
æ¯ä¸ª GPU çº¿ç¨‹å—éƒ½åƒä¸ªå°æœºå…³ï¼Œ<br/>
â€œä¸€è¾¹ç®—å¾—åˆ°ï¼Œä¸€è¾¹æ›´æ–°è¾“å‡ºâ€ â€”â€” å°±åƒè¾¹æ´—è¢œå­è¾¹ç”©å¹²ä¸€æ ·æœ‰èŠ‚å¥ ğŸš¿ã€‚</li>
<li><strong>æ•°å€¼ç¨³å®šæ€§ä¼˜åŒ–</strong><br/>
FlashMLA ä¼šç»´æŠ¤ä¸€ä¸ª â€œå½“å‰æœ€å¤§ logitâ€ çš„ç¼“å­˜ï¼Œ<br/>
é˜²æ­¢ softmax çš„æŒ‡æ•°éƒ¨åˆ† overflowï¼ˆå°±åƒé˜²æ­¢æƒ…ç»ªæº¢å‡º ğŸ˜…ï¼‰ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-4">âš™ï¸ å››ã€æµ…å°è¾„æ­¢ï¼šJSç‰ˆ FlashMLA ç®€æ˜“ç¤ºæ„</h2>
<blockquote>
<p>ğŸŒˆ æ³¨æ„ï¼šè¿™åªæ˜¯â€œæ€æƒ³æ¨¡æ‹Ÿâ€ï¼ŒçœŸæ­£çš„ FlashMLA æ˜¯åœ¨ CUDA çº§åˆ«å®ç°çš„ã€‚</p>
</blockquote>
<p>ä¸‹é¢è¿™ä¸ª JS å°ç¤ºä¾‹å±•ç¤ºäº†ã€Œå—çŠ¶æ³¨æ„åŠ› + åœ¨çº¿ Softmaxã€æ€æƒ³ğŸ‘‡ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// âš¡ FlashMLA.js - è¶…è½»é‡ç‰ˆçº¿æ€§å—æ³¨æ„åŠ›

function flashMLA(Q, K, V, <span class="hljs-attr">blockSize</span> = <span class="hljs-number">4</span>) {
  const <span class="hljs-attr">n</span> = Q.length<span class="hljs-comment">;</span>
  const <span class="hljs-attr">d</span> = Q[<span class="hljs-number">0</span>].length<span class="hljs-comment">;</span>
  const <span class="hljs-attr">output</span> = Array.from({ length: n }, () =&gt; Array(d).fill(<span class="hljs-number">0</span>))<span class="hljs-comment">;</span>
  
  console.time("FlashMLA Execution")<span class="hljs-comment">;</span>

  for (let <span class="hljs-attr">i</span> = <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; n; i += blockSize) {</span>
    const <span class="hljs-attr">endI</span> = Math.min(i + blockSize, n)<span class="hljs-comment">;</span>
    for (let <span class="hljs-attr">j</span> = <span class="hljs-number">0</span><span class="hljs-comment">; j &lt; n; j += blockSize) {</span>
      const <span class="hljs-attr">endJ</span> = Math.min(j + blockSize, n)<span class="hljs-comment">;</span>
      for (let <span class="hljs-attr">ii</span> = i<span class="hljs-comment">; ii &lt; endI; ii++) {</span>
        let <span class="hljs-attr">weightedSum</span> = Array(d).fill(<span class="hljs-number">0</span>)<span class="hljs-comment">;</span>
        let <span class="hljs-attr">weightSum</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
        let <span class="hljs-attr">maxScore</span> = -Infinity<span class="hljs-comment">;</span>
        
        // Step 1: è®¡ç®— local attention logits
        for (let <span class="hljs-attr">jj</span> = j<span class="hljs-comment">; jj &lt; endJ; jj++) {</span>
          let <span class="hljs-attr">score</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
          for (let <span class="hljs-attr">k</span> = <span class="hljs-number">0</span><span class="hljs-comment">; k &lt; d; k++) score += Q[ii][k] * K[jj][k];</span>
          <span class="hljs-attr">maxScore</span> = Math.max(maxScore, score)<span class="hljs-comment">;</span>
        }
        // Step 2: å½’ä¸€åŒ– + è¾“å‡ºæ›´æ–°
        for (let <span class="hljs-attr">jj</span> = j<span class="hljs-comment">; jj &lt; endJ; jj++) {</span>
          let <span class="hljs-attr">score</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
          for (let <span class="hljs-attr">k</span> = <span class="hljs-number">0</span><span class="hljs-comment">; k &lt; d; k++) score += Q[ii][k] * K[jj][k];</span>
          const <span class="hljs-attr">weight</span> = Math.exp(score - maxScore)<span class="hljs-comment">;</span>
          for (let <span class="hljs-attr">k</span> = <span class="hljs-number">0</span><span class="hljs-comment">; k &lt; d; k++) weightedSum[k] += weight * V[jj][k];</span>
          weightSum += weight<span class="hljs-comment">;</span>
        }
        for (let <span class="hljs-attr">k</span> = <span class="hljs-number">0</span><span class="hljs-comment">; k &lt; d; k++) output[ii][k] += weightedSum[k] / weightSum;</span>
      }
    }
  }

  console.timeEnd("FlashMLA Execution")<span class="hljs-comment">;</span>
  return output<span class="hljs-comment">;</span>
}

// ğŸ”¬ æµ‹è¯•
const <span class="hljs-attr">Q</span> = [[<span class="hljs-number">0.5</span>, <span class="hljs-number">0.2</span>], [<span class="hljs-number">0.1</span>, <span class="hljs-number">0.9</span>], [<span class="hljs-number">0.4</span>, <span class="hljs-number">0.3</span>]]<span class="hljs-comment">;</span>
const <span class="hljs-attr">K</span> = [[<span class="hljs-number">0.6</span>, <span class="hljs-number">0.1</span>], [<span class="hljs-number">0.2</span>, <span class="hljs-number">0.7</span>], [<span class="hljs-number">0.9</span>, <span class="hljs-number">0.5</span>]]<span class="hljs-comment">;</span>
const <span class="hljs-attr">V</span> = [[<span class="hljs-number">1</span>, <span class="hljs-number">0</span>], [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>]]<span class="hljs-comment">;</span>

console.table(flashMLA(Q, K, V, 2))<span class="hljs-comment">;</span>
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs language-perl" lang="perl">FlashMLA Execution: <span class="hljs-number">0</span>.<span class="hljs-number">06</span>ms
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (<span class="hljs-keyword">index</span>) â”‚    <span class="hljs-number">0</span>    â”‚    <span class="hljs-number">1</span>    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    <span class="hljs-number">0</span>    â”‚ <span class="hljs-number">0</span>.<span class="hljs-number">72</span>    â”‚ <span class="hljs-number">0</span>.<span class="hljs-number">21</span>    â”‚
â”‚    <span class="hljs-number">1</span>    â”‚ <span class="hljs-number">0</span>.<span class="hljs-number">29</span>    â”‚ <span class="hljs-number">0</span>.<span class="hljs-number">67</span>    â”‚
â”‚    <span class="hljs-number">2</span>    â”‚ <span class="hljs-number">0</span>.<span class="hljs-number">51</span>    â”‚ <span class="hljs-number">0</span>.<span class="hljs-number">43</span>    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p>ğŸš€ å®ƒæ¯”æ ‡å‡†çš„å…¨é‡æ³¨æ„åŠ›æ›´è½»ã€æ›´ä¸æ»‘ã€å ç”¨å†…å­˜æ›´ä½ã€‚</p>
<hr/>
<h2 data-id="heading-5">ğŸ§¬ äº”ã€FlashMLA ä¸ FlashAttention çš„å·®åˆ«</h2>




















<table><thead><tr><th align="left">æ¨¡å—</th><th align="left">ç‰¹ç‚¹</th><th align="left">å®ç°å±‚çº§</th></tr></thead><tbody><tr><td align="left"><strong>FlashAttention</strong></td><td align="left">ç»å…¸å—åŒ–æ³¨æ„åŠ›ï¼Œä½¿ç”¨åœ¨çº¿ softmax</td><td align="left">CUDA Kernel</td></tr><tr><td align="left"><strong>FlashMLA</strong></td><td align="left">å°†å—è®¡ç®—è¿›ä¸€æ­¥çº¿æ€§åŒ–ï¼Œé€‚é…æ›´å¤§æ¨¡å‹å’Œä½ç²¾åº¦è®­ç»ƒ</td><td align="left">CUDA / CUTLASS / Tensor Core</td></tr></tbody></table>
<p>âœ¨ FlashMLA å¯ä»¥çœ‹ä½œæ˜¯ â€œFlashAttention çš„ä¸‹ä¸€ä»£ä¼˜åŒ–ç‰ˆâ€ï¼Œ<br/>
å®ƒå‘ä¸‹æ·±å…¥åˆ° tensor core æŒ‡ä»¤å±‚ï¼Œå‘ä¸Šæ”¯æŒ FP8ã€BF16 ç­‰æ··åˆç²¾åº¦ã€‚</p>
<hr/>
<h2 data-id="heading-6">ğŸ”‹ å…­ã€åº•å±‚èƒ½é‡ï¼šä¸ºä»€ä¹ˆå¿«ï¼Ÿ</h2>
<blockquote>
<p>ğŸ“¦ å†…å­˜è®¿é—®æ‰æ˜¯çœŸæ­£çš„ç“¶é¢ˆï¼Œè€Œä¸æ˜¯ç®—åŠ›ã€‚</p>
</blockquote>
<p>FlashMLA é€šè¿‡ã€Œé‡æ’è®¡ç®—é¡ºåºã€å®ç°æ•°æ®å±€éƒ¨æ€§æœ€å¤§åŒ–ï¼š</p>
<ul>
<li>æ‰€éœ€çš„ K/V æ•°æ®åœ¨å¯„å­˜å™¨çº§ç¼“å­˜ä¸­ï¼Œé¿å…é¢‘ç¹å†…å­˜ I/Oï¼›</li>
<li>Softmax çš„å½’ä¸€åŒ–è¿‡ç¨‹åœ¨çº¿å®Œæˆï¼Œé¿å…å·¨é‡ä¸´æ—¶çŸ©é˜µå­˜å‚¨ï¼›</li>
<li>æ¯ä¸€æ­¥éƒ½åœ¨ tensor core ä¸Šå®Œæˆ fused multiply-addã€‚</li>
</ul>
<p>è¿™å°±åƒï¼š</p>
<blockquote>
<p>æŠŠâ€œå…ˆå…¨éƒ¨ä¹˜å®Œå†åŠ â€å˜æˆâ€œè¾¹ä¹˜è¾¹åŠ è¾¹å–å’–å•¡â€ â˜•ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-7">ğŸ“– ä¸ƒã€ä¸€ä¸ªæ•°å­¦ä¸Šä¸ä¸¥è‚ƒçš„ç±»æ¯” ğŸ¨</h2>
<p>å¦‚æœåŸå§‹æ³¨æ„åŠ›æ˜¯ï¼š</p>
<blockquote>
<p>â€œä¸€åœºå…¨å‘˜ä¼šè®®â€ï¼Œå¤§å®¶è¦äº’ç›¸å…³å¿ƒï¼Œäº¤æµå®Œå†åšå†³å®šã€‚</p>
</blockquote>
<p>é‚£ä¹ˆ FlashMLA å°±æ˜¯ï¼š</p>
<blockquote>
<p>â€œé«˜æ•ˆçš„å°ç»„ä¼šè®®â€ï¼Œ<br/>
æ¯ç»„å…ˆå†…éƒ¨å¯¹é½ï¼Œå†åªå‘ç›¸é‚»ç»„æ±‡æŠ¥ï¼Œ<br/>
æˆæœ¬ä½è¿˜æ•ˆç‡é«˜ â€”â€” å…³é”®æ˜¯æ²¡äººæ‰“çŒç¡ ğŸ˜´ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-8">ğŸŒˆ å…«ã€å°¾å£°ï¼šç®—åŠ›çš„è¯—å­¦</h2>
<p>åœ¨ AI æ¨¡å‹å·¨å¤§çš„è®¡ç®—æ´ªæµä¸­ï¼Œ<br/>
FlashMLA æ˜¯æŠ€æœ¯ä¸è‰ºæœ¯ç»“åˆçš„å…¸èŒƒï¼š</p>
<ul>
<li>å®ƒè®©ç®—æ³•è´´è¿‘ç¡¬ä»¶çš„å‘¼å¸ï¼›</li>
<li>å®ƒè®©æ•°å­¦åœ¨å¯„å­˜å™¨ä¹‹é—´èˆè¹ˆï¼›</li>
<li>å®ƒè®©æ¯ä¸€ä¸ª bitï¼Œéƒ½ä¸ºæ™ºèƒ½é—ªå…‰ã€‚âš™ï¸âœ¨</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Sceneä¸Groupæœºåˆ¶ç­”ç–‘ï¼šæ·±å…¥ç†è§£ooderAI Agentåä½œæ¡†æ¶]]></title>    <link>https://juejin.cn/post/7595858760133623871</link>    <guid>https://juejin.cn/post/7595858760133623871</guid>    <pubDate>2026-01-17T05:00:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858760133623871" data-draft-id="7595878718171136036" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Sceneä¸Groupæœºåˆ¶ç­”ç–‘ï¼šæ·±å…¥ç†è§£ooderAI Agentåä½œæ¡†æ¶"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T05:00:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Sceneä¸Groupæœºåˆ¶ç­”ç–‘ï¼šæ·±å…¥ç†è§£ooderAI Agentåä½œæ¡†æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T05:00:18.000Z" title="Sat Jan 17 2026 05:00:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ooderAI Agentç³»ç»Ÿä¸­ï¼ŒSceneï¼ˆåœºæ™¯ï¼‰å’ŒGroupï¼ˆç»„ï¼‰æ˜¯å®ç°å¤šAgentåä½œçš„æ ¸å¿ƒæœºåˆ¶ã€‚æœ¬æ–‡é€šè¿‡é—®ç­”å½¢å¼ï¼Œæ·±å…¥è§£ç­”Sceneä¸Groupæœºåˆ¶çš„è®¾è®¡ç†å¿µã€å®ç°åŸç†å’Œæœ€ä½³å®è·µï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨è¿™ä¸€åä½œæ¡†æ¶ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€æ ¸å¿ƒæ¦‚å¿µä¸è®¾è®¡ç†å¿µ</h2>
<h3 data-id="heading-1">Q1: Sceneå’ŒGroupçš„æ ¸å¿ƒæ¦‚å¿µæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>A1:</strong></p>
<ul>
<li><strong>Sceneï¼ˆåœºæ™¯ï¼‰</strong>ï¼šæ˜¯Agentå’ŒSkillåä½œçš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œç”¨äºæè¿°ç‰¹å®šçš„ä¸šåŠ¡æˆ–æŠ€æœ¯ä¸Šä¸‹æ–‡ï¼Œå®šä¹‰äº†åä½œçš„è§„åˆ™ã€ç›®æ ‡å’Œçº¦æŸæ¡ä»¶ã€‚</li>
<li><strong>Groupï¼ˆåœºæ™¯ç»„ï¼‰</strong>ï¼šæ˜¯åŸºäºSceneè‡ªåŠ¨å½¢æˆçš„åä½œç»„ï¼Œç”¨äºç®¡ç†åŒä¸€åœºæ™¯ä¸‹çš„Skillåä½œï¼ŒåŒ…å«å®é™…å‚ä¸åä½œçš„Skillåˆ—è¡¨ã€ç»„æ‰€æœ‰è€…å’Œç»„ç®¡ç†è§„åˆ™ã€‚</li>
<li><strong>SceneDeclarationï¼ˆåœºæ™¯å£°æ˜ï¼‰</strong>ï¼šç”¨äºSkillå£°æ˜æ”¯æŒæŸä¸ªSceneï¼Œæˆ–Route/MCPå£°æ˜Sceneæ‰€æœ‰è€…çš„æœºåˆ¶ï¼Œå®ç°åä½œèµ„æºçš„è‡ªåŠ¨å‘ç°å’Œç»„ç»‡ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d317a57329804beb84ee569602778e75~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769230818&amp;x-signature=XLhyl8k%2Bflh0bvX%2BVwJWdNRYeoo%3D" alt="Mermaid Diagram" loading="lazy"/></p>
<h3 data-id="heading-2">Q2: å¦‚ä½•å¹³è¡¡æŠ€æœ¯åœºæ™¯å’Œä¸šåŠ¡åœºæ™¯çš„å…³ç³»ï¼Ÿ</h3>
<p><strong>A2:</strong></p>
<ul>
<li><strong>æŠ€æœ¯åœºæ™¯</strong>ï¼šä½œä¸ºå¹³å°æä¾›çš„åº•å±‚èƒ½åŠ›æ¡†æ¶ï¼Œå®šä¹‰äº†Agentå’ŒSkillåä½œçš„åŸºç¡€è§„åˆ™å’Œçº¦æŸï¼Œé’ˆå¯¹å¼€å‘è€…å’Œå¹³å°ç»´æŠ¤è€…ã€‚</li>
<li><strong>ä¸šåŠ¡åœºæ™¯</strong>ï¼šä½œä¸ºå¼€å‘è€…è‡ªè¡Œå®šä¹‰çš„ä¸Šå±‚åº”ç”¨åˆ†ç±»ï¼Œç”¨äºå°†åº”ç”¨è¿›è¡Œå½’ç±»æ ‡å‡†åŒ–ï¼Œæ–¹ä¾¿åä½œå’Œç®¡ç†ã€‚</li>
<li><strong>å¹³è¡¡æœºåˆ¶</strong>ï¼šé‡‡ç”¨åˆ†ç¦»è®¾è®¡ï¼ŒæŠ€æœ¯åœºæ™¯æä¾›åŸºç¡€æ¡†æ¶ç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§å’Œå®‰å…¨æ€§ï¼Œä¸šåŠ¡åœºæ™¯å…è®¸å¼€å‘è€…çµæ´»æ‰©å±•æ»¡è¶³ä¸åŒä¸šåŠ¡éœ€æ±‚ï¼ŒåŒæ—¶é€šè¿‡åœºæ™¯æ˜ å°„æœºåˆ¶å»ºç«‹å…³è”ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44891a105aa94d018b88a26b8fd7c5f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769230818&amp;x-signature=R8%2BOLEP0NRNOnUAf58m086iPw1I%3D" alt="Mermaid Diagram" loading="lazy"/></p>
<h3 data-id="heading-3">Q3: Sceneä¸Groupæœºåˆ¶çš„è®¾è®¡ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>A3:</strong></p>
<ul>
<li>å®ç°Agentå’ŒSkillä¹‹é—´çš„è‡ªä¸»åä½œ</li>
<li>æ”¯æŒåŠ¨æ€å½¢æˆçš„åä½œå›¢é˜Ÿ</li>
<li>æé«˜ç³»ç»Ÿçš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§</li>
<li>ç¡®ä¿ç³»ç»Ÿåœ¨å„ç§æƒ…å†µä¸‹çš„å¯é æ€§</li>
<li>æ”¯æŒå¼€å‘è€…è‡ªå®šä¹‰æ‰©å±•</li>
</ul>
<h2 data-id="heading-4">äºŒã€åœºæ™¯ä¸åœºæ™¯ç»„ç®¡ç†</h2>
<h3 data-id="heading-5">Q4: ä¸€ä¸ªåœºæ™¯ä¸‹æ˜¯å¦å¯ä»¥å½¢æˆå¤šä¸ªåœºæ™¯ç»„ï¼Ÿ</h3>
<p><strong>A4:</strong></p>
<p>æ˜¯çš„ï¼Œæ”¯æŒä¸€ä¸ªåœºæ™¯ä¸‹å½¢æˆå¤šä¸ªåœºæ™¯ç»„ã€‚è®¾è®¡ç‰¹ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>ç”±mcpAgentä½œä¸ºå¤šGroupçš„ç®¡ç†è€…</li>
<li>ç”±skillflowå‘èµ·å¹¶è¿›è¡Œè°ƒåº¦åä½œ</li>
<li>é‡‡ç”¨"routeAgentå£°æ˜ï¼ŒendAgentä¸»åŠ¨åŠ å…¥"çš„å‘ç°æœºåˆ¶</li>
<li>routeAgentè‡ªå·±ç»´æŠ¤ç»„æˆå‘˜å’Œé“¾è·¯å…³ç³»</li>
</ul>
<h3 data-id="heading-6">Q5: å¤šä¸ªåœºæ™¯ç»„å¦‚ä½•åŒºåˆ†å’Œç®¡ç†ï¼Ÿ</h3>
<p><strong>A5:</strong></p>
<ul>
<li><strong>è§’è‰²åŒºåˆ†</strong>ï¼šåœºæ™¯ç”±å¼€å‘è€…è‡ªè¡Œå£°æ˜æ˜¯å¬é›†è€…è¿˜æ˜¯åŠ å…¥è€…ï¼ŒrouteAgentå…·å¤‡å»ºç»„èƒ½åŠ›ï¼ŒendAgentåªèƒ½å£°æ˜åŠ å…¥</li>
<li><strong>å‘ç°æœºåˆ¶</strong>ï¼šrouteAgentå£°æ˜åœºæ™¯ï¼ŒendAgentæ‰«æå‘ç°ç„¶åä¸»åŠ¨åŠ å…¥</li>
<li><strong>ç®¡ç†è´£ä»»</strong>ï¼šrouteAgentè‡ªå·±ç»´æŠ¤ç»„æˆå‘˜å’Œé“¾è·¯å…³ç³»</li>
<li><strong>å‘½åè§„åˆ™</strong>ï¼šåœºæ™¯ä»…åœ¨åŒä¸€ä¸ªmcpAgentå†…èµ·ä½œç”¨ï¼Œå‘½åç”±skillID+skillCap+mcpidç»„æˆå”¯ä¸€æ ‡è¯†</li>
</ul>
<h3 data-id="heading-7">Q6: åœºæ™¯ç»„çš„å‘½åè§„åˆ™å¦‚ä½•è®¾è®¡ï¼Ÿ</h3>
<p><strong>A6:</strong></p>
<ul>
<li>åœºæ™¯ä»…åœ¨åŒä¸€ä¸ªmcpAgentå†…èµ·ä½œç”¨</li>
<li>å‘½åè§„åˆ™ï¼š<code>group_skillId_skillCap_mcpAgentId</code></li>
<li>ç”±skillID+skillCap+mcpidç»„æˆå”¯ä¸€æ ‡è¯†</li>
<li>æ”¯æŒåŠ¨æ€ç”Ÿæˆå’Œè‡ªå®šä¹‰ä¸¤ç§æ–¹å¼</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€è§’è‰²è®¾è®¡ä¸åä½œæ¨¡å¼</h2>
<h3 data-id="heading-9">Q7: å½“å‰åªå®šä¹‰äº†agentRouteå’ŒendAgentä¸¤ç§è§’è‰²ï¼Œæ˜¯å¦è¶³å¤Ÿè¦†ç›–æ‰€æœ‰åä½œæ¨¡å¼ï¼Ÿ</h3>
<p><strong>A7:</strong></p>
<ul>
<li><strong>æ ¸å¿ƒåä½œè¦†ç›–</strong>ï¼šagentRouteå’ŒendAgentçš„ç»„åˆèƒ½å¤Ÿè¦†ç›–å¤§éƒ¨åˆ†åŸºç¡€åä½œæ¨¡å¼</li>
<li><strong>å¼€å‘è€…è‡ªå®šä¹‰</strong>ï¼šè®¾è®¡æ”¯æŒå¼€å‘è€…è‡ªå®šä¹‰è§’è‰²çš„æœºåˆ¶ï¼Œå…è®¸åŸºäºæ ¸å¿ƒè§’è‰²è¿›è¡Œæ‰©å±•</li>
<li><strong>ç³»ç»Ÿçº§è§’è‰²</strong>ï¼šæ˜ç¡®äº†mcpAgentã€AIServerå’Œskillflowçš„è§’è‰²å®šä½</li>
</ul>
<h3 data-id="heading-10">Q8: ç³»ç»Ÿçº§è§’è‰²ï¼ˆmcpAgentã€AIServerã€skillflowï¼‰çš„å®šä½æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>A8:</strong></p>
<ul>
<li><strong>mcpAgent</strong>ï¼šå•ä¸€è§’è‰²çš„ç»Ÿä¸€è¿è¡Œç¯å¢ƒï¼Œæä¾›èµ„æºç®¡ç†å’ŒåŸºç¡€æœåŠ¡ï¼Œä½œä¸ºå¤šåœºæ™¯ç»„çš„ç®¡ç†è€…</li>
<li><strong>AIServer</strong>ï¼šå…¨å±€è°ƒåº¦å’Œå†³ç­–è€…ï¼Œæä¾›æ™ºèƒ½å†³ç­–æ”¯æŒï¼Œè·¨mcpAgentåä½œåè°ƒ</li>
<li><strong>skillflow</strong>ï¼šæµç¨‹ç¼–æ’å’Œä»»åŠ¡å‘èµ·è€…ï¼Œåªå®šä¹‰åˆ°ç»„çº§åˆ«æˆ–ç‹¬ç«‹Skillï¼Œä¸å‚ä¸åœºæ™¯ç»„å†…éƒ¨è°ƒåº¦</li>
</ul>
<h3 data-id="heading-11">Q9: ä¸åŒè§’è‰²ä¹‹é—´çš„åä½œå…³ç³»æ˜¯æ€æ ·çš„ï¼Ÿ</h3>
<p><strong>A9:</strong></p>
<ul>
<li><strong>agentRouteä¸endAgent</strong>ï¼šagentRouteè´Ÿè´£ä»»åŠ¡æ¥æ”¶ã€åˆ†å‘å’Œç»“æœèšåˆï¼ŒendAgentè´Ÿè´£å…·ä½“ä»»åŠ¡æ‰§è¡Œ</li>
<li><strong>mcpAgentä¸åœºæ™¯ç»„</strong>ï¼šmcpAgentç®¡ç†åœºæ™¯ç»„çš„åŸºç¡€ä¿¡æ¯ï¼Œä½œä¸ºå¤šåœºæ™¯ç»„çš„ç®¡ç†è€…</li>
<li><strong>AIServerä¸åœºæ™¯ç»„</strong>ï¼šAIServeræä¾›å…¨å±€æ™ºèƒ½å†³ç­–æ”¯æŒï¼Œä¸ç›´æ¥å‚ä¸åœºæ™¯ç»„å†…éƒ¨åä½œ</li>
<li><strong>skillflowä¸åœºæ™¯ç»„</strong>ï¼šskillflowå‘èµ·è·¨åœºæ™¯ç»„çš„åä½œè¯·æ±‚ï¼Œåè°ƒå¤šä¸ªåœºæ™¯ç»„çš„å·¥ä½œ</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/35fe97dbb7464d95bc179dc6c93e3631~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769230818&amp;x-signature=po916A%2F1jzpg0Ao%2BqMVJcPHSV18%3D" alt="Mermaid Diagram" loading="lazy"/></p>
<h2 data-id="heading-12">å››ã€è‡ªä¸»åä½œæœºåˆ¶</h2>
<h3 data-id="heading-13">Q10: ä»€ä¹ˆæ˜¯è‡ªä¸»åä½œç‰¹æ€§ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªè®¾è®¡ï¼Ÿ</h3>
<p><strong>A10:</strong></p>
<ul>
<li><strong>è‡ªä¸»åä½œ</strong>ï¼šæŒ‡åœºæ™¯ç»„åœ¨mcpæœåŠ¡ä¸ç¨³å®šæˆ–å¤–éƒ¨å‡ºç°é—®é¢˜æ—¶ï¼Œä»èƒ½ç‹¬ç«‹è¿è¡Œå’Œåä½œçš„èƒ½åŠ›</li>
<li><strong>è®¾è®¡åŸå› </strong>ï¼šç¡®ä¿ç³»ç»Ÿåœ¨å„ç§æƒ…å†µä¸‹çš„å¯é æ€§ï¼Œæé«˜ç³»ç»Ÿçš„é²æ£’æ€§å’Œå®¹é”™èƒ½åŠ›</li>
<li><strong>å®ç°æ–¹å¼</strong>ï¼š
<ul>
<li>åœºæ™¯ç»„å†…åä½œè‡ªæ²»ï¼Œä¸ä¾èµ–å¤–éƒ¨æœåŠ¡</li>
<li>mcpæœåŠ¡é™çº§æœºåˆ¶ï¼Œè‡ªåŠ¨åˆ‡æ¢åˆ°è‡ªä¸»æ¨¡å¼</li>
<li>æŠ€èƒ½è‡ªä¸»å‘ç°ä¸åä½œï¼Œæ— éœ€å¤–éƒ¨å¹²é¢„</li>
<li>å…³é”®çŠ¶æ€æœ¬åœ°æŒä¹…åŒ–ï¼Œç¡®ä¿æœåŠ¡æ¢å¤åç»§ç»­è¿è¡Œ</li>
</ul>
</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c047be3ed1194942909b7a92587c5d65~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769230818&amp;x-signature=BAvx6DsHI%2BT7OsMd1EiogJAIAGU%3D" alt="Mermaid Diagram" loading="lazy"/></p>
<h3 data-id="heading-14">Q11: skillflowä¸ºä»€ä¹ˆä¸å‚ä¸åœºæ™¯ç»„å†…éƒ¨è°ƒåº¦ï¼Ÿ</h3>
<p><strong>A11:</strong></p>
<ul>
<li>è®¾è®¡åŸåˆ™ï¼šä¿æŒåœºæ™¯ç»„çš„è‡ªæ²»æ€§ï¼Œç¡®ä¿åœ¨mcpæœåŠ¡ä¸ç¨³å®šæ—¶ä»èƒ½ç‹¬ç«‹åä½œ</li>
<li>åŠŸèƒ½å®šä½ï¼šskillflowåªå®šä¹‰åˆ°ç»„çº§åˆ«æˆ–ç‹¬ç«‹Skillï¼Œè´Ÿè´£æµç¨‹ç¼–æ’å’Œä»»åŠ¡å‘èµ·</li>
<li>åä½œæ–¹å¼ï¼šé€šè¿‡å‘åœºæ™¯ç»„åˆ†é…ä»»åŠ¡ï¼Œæ¥æ”¶æ‰§è¡Œç»“æœï¼Œå®ç°è·¨åœºæ™¯ç»„åä½œ</li>
</ul>
<h3 data-id="heading-15">Q12: è‡ªä¸»åä½œæ¨¡å¼ä¸‹ï¼Œåœºæ™¯ç»„å¦‚ä½•è¿è¡Œï¼Ÿ</h3>
<p><strong>A12:</strong></p>
<ul>
<li>æœ¬åœ°åŠ è½½åœºæ™¯ç»„ä¿¡æ¯ï¼Œåˆå§‹åŒ–æŠ€èƒ½çŠ¶æ€ç›‘æ§</li>
<li>å¯åŠ¨æœ¬åœ°ä»»åŠ¡è°ƒåº¦ï¼ŒåŸºäºæœ¬åœ°æŠ€èƒ½çŠ¶æ€å’Œèƒ½åŠ›è¿›è¡Œä»»åŠ¡åˆ†é…</li>
<li>å®šæœŸæ£€æµ‹æŠ€èƒ½çŠ¶æ€ï¼Œå‘ç°å¼‚å¸¸æ—¶è‡ªåŠ¨è°ƒæ•´ä»»åŠ¡åˆ†é…</li>
<li>å®šæœŸæ£€æµ‹mcpæœåŠ¡çŠ¶æ€ï¼Œè‡ªåŠ¨åˆ‡æ¢åä½œæ¨¡å¼</li>
<li>å…³é”®çŠ¶æ€æœ¬åœ°æŒä¹…åŒ–ï¼Œç¡®ä¿æœåŠ¡æ¢å¤åç»§ç»­è¿è¡Œ</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/793b958e937f4e27999b4c809ad8425c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT25lQ29kZUNO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769230818&amp;x-signature=rech4udAo4p5ELL21ZUX76T3zF4%3D" alt="Mermaid Diagram" loading="lazy"/></p>
<h2 data-id="heading-16">äº”ã€ç³»ç»Ÿé›†æˆä¸æ‰©å±•</h2>
<h3 data-id="heading-17">Q13: å¦‚ä½•æ”¯æŒå¼€å‘è€…è‡ªå®šä¹‰è§’è‰²ï¼Ÿ</h3>
<p><strong>A13:</strong></p>
<ul>
<li>è®¾è®¡è§’è‰²åŸºç±»ï¼Œå®šä¹‰æ ¸å¿ƒèƒ½åŠ›</li>
<li>æ ¸å¿ƒè§’è‰²ï¼ˆagentRouteã€endAgentï¼‰ä½œä¸ºåŸºç¡€å®ç°</li>
<li>æä¾›è§’è‰²å·¥å‚ï¼Œæ”¯æŒè‡ªå®šä¹‰è§’è‰²æ³¨å†Œå’Œè·å–</li>
<li>æ”¯æŒè§’è‰²èƒ½åŠ›åˆ†å±‚ï¼Œåˆ†ä¸ºæ ¸å¿ƒèƒ½åŠ›å’Œæ‰©å±•èƒ½åŠ›</li>
<li>æ”¯æŒåŸºäºæ ¸å¿ƒè§’è‰²çš„ç»§æ‰¿å’Œæ‰©å±•</li>
</ul>
<h3 data-id="heading-18">Q14: Sceneä¸Groupæœºåˆ¶å¦‚ä½•ä¸ç°æœ‰ç³»ç»Ÿé›†æˆï¼Ÿ</h3>
<p><strong>A14:</strong></p>
<ul>
<li>æä¾›å®Œæ•´çš„APIæ¥å£ï¼Œæ”¯æŒä¸ç°æœ‰ç³»ç»Ÿçš„é›†æˆ</li>
<li>æ”¯æŒå¤šç§é€šä¿¡åè®®ï¼Œæ–¹ä¾¿ä¸åŒç³»ç»Ÿé—´çš„äº¤äº’</li>
<li>è®¾è®¡çµæ´»çš„æ‰©å±•æœºåˆ¶ï¼Œæ”¯æŒè‡ªå®šä¹‰åœºæ™¯ç±»å‹å’Œè§’è‰²</li>
<li>æä¾›è¯¦ç»†çš„æ–‡æ¡£å’Œç¤ºä¾‹ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿé›†æˆ</li>
</ul>
<h3 data-id="heading-19">Q15: å¦‚ä½•æ‰©å±•Sceneä¸Groupæœºåˆ¶ä»¥æ»¡è¶³ç‰¹å®šä¸šåŠ¡éœ€æ±‚ï¼Ÿ</h3>
<p><strong>A15:</strong></p>
<ul>
<li>åŸºäºæ ¸å¿ƒè§’è‰²æ‰©å±•è‡ªå®šä¹‰è§’è‰²ï¼Œå®ç°ç‰¹å®šä¸šåŠ¡é€»è¾‘</li>
<li>è‡ªå®šä¹‰åœºæ™¯ç±»å‹ï¼Œæ»¡è¶³ç‰¹å®šä¸šåŠ¡åœºæ™¯éœ€æ±‚</li>
<li>æ‰©å±•å‘½ä»¤ä½“ç³»ï¼Œæ”¯æŒç‰¹å®šä¸šåŠ¡æ“ä½œ</li>
<li>å®ç°è‡ªå®šä¹‰çš„åœºæ™¯å‘ç°å’Œç»„å½¢æˆæœºåˆ¶</li>
<li>é›†æˆç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå¢å¼ºç³»ç»Ÿèƒ½åŠ›</li>
</ul>
<h2 data-id="heading-20">å…­ã€æœ€ä½³å®è·µä¸å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-21">Q16: å¦‚ä½•é€‰æ‹©åˆé€‚çš„è§’è‰²ç±»å‹ï¼Ÿ</h3>
<p><strong>A16:</strong></p>
<ul>
<li>å¯¹äºéœ€è¦åè°ƒå’Œç®¡ç†èƒ½åŠ›çš„ç»„ä»¶ï¼Œä½¿ç”¨agentRouteè§’è‰²</li>
<li>å¯¹äºåªéœ€è¦æ‰§è¡Œå…·ä½“ä»»åŠ¡çš„ç»„ä»¶ï¼Œä½¿ç”¨endAgentè§’è‰²</li>
<li>å¯¹äºç³»ç»Ÿçº§ç®¡ç†å’Œè°ƒåº¦ï¼Œä½¿ç”¨mcpAgentæˆ–AIServerè§’è‰²</li>
<li>å¯¹äºæµç¨‹ç¼–æ’ï¼Œä½¿ç”¨skillflow</li>
</ul>
<h3 data-id="heading-22">Q17: å¦‚ä½•ç¡®ä¿åœºæ™¯ç»„çš„å®‰å…¨æ€§ï¼Ÿ</h3>
<p><strong>A17:</strong></p>
<ul>
<li>å®ç°åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ï¼Œé™åˆ¶ä¸åŒè§’è‰²çš„æ“ä½œæƒé™</li>
<li>é‡‡ç”¨å®‰å…¨çš„é€šä¿¡åè®®ï¼Œä¿æŠ¤æ•°æ®ä¼ è¾“å®‰å…¨</li>
<li>å®ç°åœºæ™¯ç»„çš„è®¿é—®æ§åˆ¶ï¼Œé™åˆ¶éæˆæƒç»„ä»¶çš„åŠ å…¥</li>
<li>å®šæœŸå®¡è®¡åœºæ™¯ç»„çš„æ“ä½œæ—¥å¿—ï¼Œå‘ç°å¼‚å¸¸è¡Œä¸º</li>
</ul>
<h3 data-id="heading-23">Q18: å¦‚ä½•ä¼˜åŒ–åœºæ™¯ç»„çš„æ€§èƒ½ï¼Ÿ</h3>
<p><strong>A18:</strong></p>
<ul>
<li>åˆç†è®¾è®¡åœºæ™¯ç»„çš„å¤§å°ï¼Œé¿å…è¿‡å¤§çš„åœºæ™¯ç»„</li>
<li>ä¼˜åŒ–ä»»åŠ¡åˆ†é…ç®—æ³•ï¼Œæé«˜ä»»åŠ¡æ‰§è¡Œæ•ˆç‡</li>
<li>å®ç°æŠ€èƒ½çŠ¶æ€çš„å®æ—¶ç›‘æ§ï¼ŒåŠæ—¶è°ƒæ•´ä»»åŠ¡åˆ†é…</li>
<li>é‡‡ç”¨é«˜æ•ˆçš„é€šä¿¡æœºåˆ¶ï¼Œå‡å°‘é€šä¿¡å¼€é”€</li>
<li>å®ç°ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘é‡å¤è®¡ç®—</li>
</ul>
<h2 data-id="heading-24">ä¸ƒã€æ€»ç»“</h2>
<p>Sceneä¸Groupæœºåˆ¶æ˜¯ooderAI Agentç³»ç»Ÿå®ç°å¤šAgentåä½œçš„æ ¸å¿ƒæ¡†æ¶ï¼Œé€šè¿‡æ¸…æ™°çš„è®¾è®¡ç†å¿µã€çµæ´»çš„è§’è‰²ä½“ç³»å’Œå¯é çš„è‡ªä¸»åä½œæœºåˆ¶ï¼Œä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„åä½œå·¥å…·ã€‚</p>
<p>ç†è§£å’ŒæŒæ¡Sceneä¸Groupæœºåˆ¶çš„è®¾è®¡åŸç†å’Œæœ€ä½³å®è·µï¼Œå¯¹äºæ„å»ºé«˜æ•ˆã€å¯é çš„å¤šAgentç³»ç»Ÿè‡³å…³é‡è¦ã€‚å¸Œæœ›æœ¬æ–‡çš„é—®ç­”èƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œåº”ç”¨è¿™ä¸€æœºåˆ¶ï¼Œæ„å»ºå‡ºæ›´åŠ æ™ºèƒ½ã€çµæ´»çš„Agentåº”ç”¨ã€‚</p>
<p>æœªæ¥ï¼Œæˆ‘ä»¬å°†ç»§ç»­å®Œå–„Sceneä¸Groupæœºåˆ¶ï¼Œæ”¯æŒæ›´å¤šçš„åä½œæ¨¡å¼å’Œæ‰©å±•èƒ½åŠ›ï¼Œä¸ºå¼€å‘è€…æä¾›æ›´åŠ ä¸°å¯Œçš„åä½œå·¥å…·å’Œæ›´å¥½çš„å¼€å‘ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸš€2026å¹´Skillså…ƒå¹´æ­£å¼å¼€å¯ï¼è°·æ­ŒAntigravityæ”¯æŒAgent Skillsï¼Œå½»åº•æ”¹å†™ä¼ ç»ŸAIç¼–ç¨‹ï¼ä¿å§†çº§æ•™ç¨‹ä»å®‰è£…åˆ°åˆ›å»ºåˆ°è°ƒç”¨ï¼UI UX Pro Max Skillså®æµ‹æ•ˆæœè¶…é¢„æœŸ]]></title>    <link>https://juejin.cn/post/7595425302968647721</link>    <guid>https://juejin.cn/post/7595425302968647721</guid>    <pubDate>2026-01-16T06:35:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595425302968647721" data-draft-id="7595491816776646697" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸš€2026å¹´Skillså…ƒå¹´æ­£å¼å¼€å¯ï¼è°·æ­ŒAntigravityæ”¯æŒAgent Skillsï¼Œå½»åº•æ”¹å†™ä¼ ç»ŸAIç¼–ç¨‹ï¼ä¿å§†çº§æ•™ç¨‹ä»å®‰è£…åˆ°åˆ›å»ºåˆ°è°ƒç”¨ï¼UI UX Pro Max Skillså®æµ‹æ•ˆæœè¶…é¢„æœŸ"/> <meta itemprop="keywords" content="Agent,Claude,VibeCoding"/> <meta itemprop="datePublished" content="2026-01-16T06:35:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="win4r"/> <meta itemprop="url" content="https://juejin.cn/user/1739869037541555"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸš€2026å¹´Skillså…ƒå¹´æ­£å¼å¼€å¯ï¼è°·æ­ŒAntigravityæ”¯æŒAgent Skillsï¼Œå½»åº•æ”¹å†™ä¼ ç»ŸAIç¼–ç¨‹ï¼ä¿å§†çº§æ•™ç¨‹ä»å®‰è£…åˆ°åˆ›å»ºåˆ°è°ƒç”¨ï¼UI UX Pro Max Skillså®æµ‹æ•ˆæœè¶…é¢„æœŸ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1739869037541555/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    win4r
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T06:35:44.000Z" title="Fri Jan 16 2026 06:35:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    54
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€ä»€ä¹ˆæ˜¯ Agent Skillsï¼Ÿ</h2>
<p>Agent Skills æ˜¯ä¸€ç§ç”± Anthropic æœ€åˆå¼€å‘å¹¶ä½œä¸º<strong>å¼€æ”¾æ ‡å‡†</strong>å‘å¸ƒçš„æ™ºèƒ½ä½“èƒ½åŠ›æ‰©å±•æ ¼å¼ã€‚å®ƒçš„æ ¸å¿ƒç†å¿µæ˜¯ï¼šæ™ºèƒ½ä½“è™½ç„¶è¶Šæ¥è¶Šå¼ºå¤§ï¼Œä½†å¾€å¾€ç¼ºä¹å®Œæˆå®é™…å·¥ä½œæ‰€éœ€çš„<strong>é¢†åŸŸä¸Šä¸‹æ–‡å’Œç¨‹åºåŒ–çŸ¥è¯†</strong>ã€‚Skills é€šè¿‡è®©æ™ºèƒ½ä½“æŒ‰éœ€åŠ è½½ç‰¹å®šäºå…¬å¸ã€å›¢é˜Ÿã€ç”¨æˆ·çš„çŸ¥è¯†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>ğŸ”¥ğŸ”¥ğŸ”¥æœ¬ç¯‡ç¬”è®°æ‰€å¯¹åº”çš„è§†é¢‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1FQkwByEAY%2F" target="_blank" title="https://www.bilibili.com/video/BV1FQkwByEAY/" ref="nofollow noopener noreferrer">www.bilibili.com/video/BV1FQâ€¦</a></p>
<p>ä»æŠ€æœ¯è§’åº¦çœ‹ï¼Œä¸€ä¸ª Skill å°±æ˜¯ä¸€ä¸ªåŒ…å« <code>SKILL.md</code> æ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼Œå†…å«å…ƒæ•°æ®ï¼ˆåç§°ã€æè¿°ï¼‰å’Œ Markdown æ ¼å¼çš„æŒ‡ä»¤ï¼Œå‘Šè¯‰æ™ºèƒ½ä½“å¦‚ä½•æ‰§è¡Œç‰¹å®šä»»åŠ¡ã€‚Skills è¿˜å¯ä»¥æ†ç»‘è„šæœ¬ã€æ¨¡æ¿å’Œå‚è€ƒææ–™ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€å¦‚ä½•åœ¨ Antigravity IDE ä¸­ä½¿ç”¨ Skills</h2>
<h3 data-id="heading-2">1. Skills çš„å­˜æ”¾ä½ç½®</h3>
<p>æ ¹æ® Antigravity å®˜æ–¹æ–‡æ¡£ï¼Œæ”¯æŒä¸¤ç§ç±»å‹çš„ Skillsï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">ä½ç½®ä½œç”¨èŒƒå›´é€‚ç”¨åœºæ™¯&lt;workspace-root&gt;<span class="hljs-regexp">/.agent/</span>skills/&lt;skill-folder&gt;<span class="hljs-regexp">/å·¥ä½œåŒºçº§åˆ«é¡¹ç›®ç‰¹å®šçš„å·¥ä½œæµï¼Œå¦‚å›¢é˜Ÿéƒ¨ç½²æµç¨‹ã€æµ‹è¯•è§„èŒƒ~/</span>.<span class="hljs-property">gemini</span>/antigravity/skills/&lt;skill-folder&gt;/å…¨å±€çº§åˆ«è·¨é¡¹ç›®çš„ä¸ªäººå·¥å…·æˆ–é€šç”¨å·¥å…·
</code></pre>
<h3 data-id="heading-3">2. åˆ›å»ºä¸€ä¸ª Skill</h3>
<p>åˆ›å»º Skill çš„åŸºæœ¬æ­¥éª¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">.agent/skills/
â””â”€â”€â”€ my-skill/
     â””â”€â”€â”€ SKILL.md
</code></pre>
<p>æ¯ä¸ª Skill å¿…é¡»æœ‰ä¸€ä¸ªå¸¦ YAML frontmatter çš„ <code>SKILL.md</code> æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">my-skill</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Helps</span> <span class="hljs-string">with</span> <span class="hljs-string">a</span> <span class="hljs-string">specific</span> <span class="hljs-string">task.</span> <span class="hljs-string">Use</span> <span class="hljs-string">when</span> <span class="hljs-string">you</span> <span class="hljs-string">need</span> <span class="hljs-string">to</span> <span class="hljs-string">do</span> <span class="hljs-string">X</span> <span class="hljs-string">or</span> <span class="hljs-string">Y.</span>
<span class="hljs-meta">---</span>
<span class="hljs-comment"># My Skill</span>

<span class="hljs-string">Detailed</span> <span class="hljs-string">instructions</span> <span class="hljs-string">for</span> <span class="hljs-string">the</span> <span class="hljs-string">agent</span> <span class="hljs-string">go</span> <span class="hljs-string">here.</span>

<span class="hljs-comment">## When to use this skill</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">Use</span> <span class="hljs-string">this</span> <span class="hljs-string">when...</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">This</span> <span class="hljs-string">is</span> <span class="hljs-string">helpful</span> <span class="hljs-string">for...</span>

<span class="hljs-comment">## How to use it</span>
<span class="hljs-string">Step-by-step</span> <span class="hljs-string">guidance,</span> <span class="hljs-string">conventions,</span> <span class="hljs-string">and</span> <span class="hljs-string">patterns</span> <span class="hljs-string">the</span> <span class="hljs-string">agent</span> <span class="hljs-string">should</span> <span class="hljs-string">follow.</span>
</code></pre>
<h3 data-id="heading-4">3. Frontmatter å­—æ®µè§„èŒƒ</h3>
<p><strong>æ³¨æ„</strong>ï¼šAgent Skills å¼€æ”¾æ ‡å‡†ä¸ Antigravity å®ç°åœ¨ <code>name</code> å­—æ®µä¸Šå­˜åœ¨å·®å¼‚ï¼š</p>















































<table><thead><tr><th>å­—æ®µ</th><th>Agent Skills æ ‡å‡†</th><th>Antigravity å®ç°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>name</code></td><td><strong>å¿…éœ€</strong></td><td>å¯é€‰</td><td>1-64å­—ç¬¦ï¼Œå°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦ã€‚Antigravity å…è®¸çœç•¥ï¼Œé»˜è®¤ä½¿ç”¨æ–‡ä»¶å¤¹å</td></tr><tr><td><code>description</code></td><td><strong>å¿…éœ€</strong></td><td><strong>å¿…éœ€</strong></td><td>æè¿°æŠ€èƒ½åŠŸèƒ½å’Œè§¦å‘åœºæ™¯ï¼Œæœ€å¤š1024å­—ç¬¦</td></tr><tr><td><code>license</code></td><td>å¯é€‰</td><td>å¯é€‰</td><td>è®¸å¯è¯ä¿¡æ¯</td></tr><tr><td><code>compatibility</code></td><td>å¯é€‰</td><td>å¯é€‰</td><td>ç¯å¢ƒè¦æ±‚è¯´æ˜ï¼Œæœ€å¤š500å­—ç¬¦</td></tr><tr><td><code>metadata</code></td><td>å¯é€‰</td><td>å¯é€‰</td><td>è‡ªå®šä¹‰é”®å€¼å¯¹ï¼Œç”¨äºå­˜å‚¨é¢å¤–å±æ€§</td></tr><tr><td><code>allowed-tools</code></td><td>å¯é€‰ï¼ˆå®éªŒæ€§ï¼‰</td><td>å¯é€‰ï¼ˆå®éªŒæ€§ï¼‰</td><td>é¢„æˆæƒå·¥å…·åˆ—è¡¨ï¼Œå„å¹³å°æ”¯æŒç¨‹åº¦ä¸åŒ</td></tr></tbody></table>
<p><strong>å…³äº description çš„æ’°å†™å»ºè®®</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨ç¬¬ä¸‰äººç§°æè¿°</li>
<li>åŒ…å«å¸®åŠ©æ™ºèƒ½ä½“è¯†åˆ«ä»»åŠ¡çš„å…³é”®è¯</li>
<li>å¥½çš„ç¤ºä¾‹ï¼š<code>"Generates unit tests for Python code using pytest conventions."</code></li>
<li>å·®çš„ç¤ºä¾‹ï¼š<code>"Helps with tests."</code></li>
</ul>
<h3 data-id="heading-5">4. Skill æ–‡ä»¶å¤¹ç»“æ„</h3>
<p>è™½ç„¶ <code>SKILL.md</code> æ˜¯å”¯ä¸€å¿…éœ€çš„æ–‡ä»¶ï¼Œä½†å¯ä»¥åŒ…å«é¢å¤–èµ„æºï¼š</p>
<pre><code class="hljs language-bash" lang="bash">.agent/skills/my-skill/
â”œâ”€â”€â”€ SKILL.md          <span class="hljs-comment"># ä¸»æŒ‡ä»¤æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰</span>
â”œâ”€â”€â”€ scripts/          <span class="hljs-comment"># è¾…åŠ©è„šæœ¬ï¼ˆå¯é€‰ï¼‰</span>
â”œâ”€â”€â”€ examples/         <span class="hljs-comment"># å‚è€ƒå®ç°ï¼ˆå¯é€‰ï¼‰</span>
â””â”€â”€â”€ resources/        <span class="hljs-comment"># æ¨¡æ¿å’Œå…¶ä»–èµ„æºï¼ˆå¯é€‰ï¼‰</span>
</code></pre>
<p>æ ¹æ® Agent Skills è§„èŒƒï¼Œæ¨èçš„ç›®å½•ç»“æ„æ˜¯ <code>scripts/</code>ã€<code>references/</code>ã€<code>assets/</code>ï¼Œä½† Antigravity æ–‡æ¡£ä¸­ä½¿ç”¨çš„æ˜¯ <code>scripts/</code>ã€<code>examples/</code>ã€<code>resources/</code>ï¼Œä¸¤è€…å…¼å®¹ã€‚</p>
<h3 data-id="heading-6">5. æ™ºèƒ½ä½“å¦‚ä½•ä½¿ç”¨ Skills â€”â€” æ¸è¿›å¼æŠ«éœ²æ¨¡å¼</h3>
<p>Skills é‡‡ç”¨<strong>æ¸è¿›å¼æŠ«éœ²</strong>ï¼ˆProgressive Disclosureï¼‰æ¨¡å¼æ¥é«˜æ•ˆç®¡ç†ä¸Šä¸‹æ–‡çª—å£ï¼š</p>
<pre><code class="hljs language-objectivec" lang="objectivec">é˜¶æ®µåŠ¨ä½œä¸Šä¸‹æ–‡æ¶ˆè€—å‘ç°å¯¹è¯å¼€å§‹æ—¶ï¼Œæ™ºèƒ½ä½“åŠ è½½æ‰€æœ‰å¯ç”¨ Skills çš„åç§°å’Œæè¿°çº¦<span class="hljs-number">100</span> tokensæ¿€æ´»å¦‚æœæŸä¸ª Skill ä¸ä»»åŠ¡ç›¸å…³ï¼Œæ™ºèƒ½ä½“è¯»å–å®Œæ•´çš„ <span class="hljs-built_in">SKILL</span>.md å†…å®¹å»ºè®®&lt;<span class="hljs-number">5000</span> tokensæ‰§è¡Œæ™ºèƒ½ä½“æŒ‰ç…§æŒ‡ä»¤æ‰§è¡Œï¼ŒæŒ‰éœ€åŠ è½½å¼•ç”¨çš„æ–‡ä»¶æˆ–æ‰§è¡Œæ†ç»‘çš„ä»£ç æŒ‰éœ€åŠ è½½
</code></pre>
<p><strong>å…³äºè‡ªåŠ¨è§¦å‘ä¸æ˜¾å¼è°ƒç”¨</strong>ï¼š</p>
<ul>
<li>åœ¨ Antigravity ä¸­ï¼Œæ™ºèƒ½ä½“ä¼šæ ¹æ®ä»»åŠ¡æè¿°å’Œ Skill çš„ description è‡ªåŠ¨åˆ¤æ–­æ˜¯å¦æ¿€æ´»ç›¸å…³ Skill</li>
<li>å¦‚æœä½ æƒ³ç¡®ä¿ä½¿ç”¨æŸä¸ª Skillï¼Œå¯ä»¥åœ¨å¯¹è¯ä¸­æåŠå®ƒçš„åç§°</li>
<li>éƒ¨åˆ†å…¶ä»–å¹³å°ï¼ˆå¦‚ OpenAI Codexï¼‰ä¹Ÿæä¾›é€šè¿‡ç•Œé¢æˆ–å‘½ä»¤æ˜¾å¼é€‰æ‹© Skill çš„æ–¹å¼</li>
</ul>
<h3 data-id="heading-7">6. æœ€ä½³å®è·µ</h3>
<pre><code class="hljs language-bash" lang="bash">åŸåˆ™è¯´æ˜ä¿æŒä¸“æ³¨æ¯ä¸ª Skill åªåšä¸€ä»¶äº‹ï¼Œé¿å…<span class="hljs-string">"ä¸‡èƒ½å‹"</span> Skillæ¸…æ™°æè¿°description æ˜¯æ™ºèƒ½ä½“åˆ¤æ–­æ˜¯å¦ä½¿ç”¨ Skill çš„å…³é”®ï¼Œè¦å…·ä½“è¯´æ˜åŠŸèƒ½å’Œé€‚ç”¨åœºæ™¯è„šæœ¬ä½œä¸ºé»‘ç›’å¦‚æœ Skill åŒ…å«è„šæœ¬ï¼Œå»ºè®®æ™ºèƒ½ä½“å…ˆç”¨ --<span class="hljs-built_in">help</span> è¿è¡Œè€Œéé˜…è¯»å…¨éƒ¨æºç åŒ…å«å†³ç­–æ ‘å¯¹äºå¤æ‚ Skillï¼Œæ·»åŠ å¸®åŠ©æ™ºèƒ½ä½“æ ¹æ®æƒ…å†µé€‰æ‹©æ­£ç¡®æ–¹æ³•çš„ç« èŠ‚æ§åˆ¶å¤§å°ä¸» SKILL.md å»ºè®®æ§åˆ¶åœ¨ 500 è¡Œä»¥å†…ï¼Œè¯¦ç»†å‚è€ƒææ–™æ”¾å…¥å•ç‹¬æ–‡ä»¶
</code></pre>
<h3 data-id="heading-8">7. å®æˆ˜ç¤ºä¾‹ï¼šä»£ç å®¡æŸ¥ Skill</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-meta">---</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">code-review</span>
<span class="hljs-attr">description:</span> <span class="hljs-string">Reviews</span> <span class="hljs-string">code</span> <span class="hljs-string">changes</span> <span class="hljs-string">for</span> <span class="hljs-string">bugs,</span> <span class="hljs-string">style</span> <span class="hljs-string">issues,</span> <span class="hljs-string">and</span> <span class="hljs-string">best</span> <span class="hljs-string">practices.</span> <span class="hljs-string">Use</span> <span class="hljs-string">when</span> <span class="hljs-string">reviewing</span> <span class="hljs-string">PRs</span> <span class="hljs-string">or</span> <span class="hljs-string">checking</span> <span class="hljs-string">code</span> <span class="hljs-string">quality.</span>
<span class="hljs-meta">---</span>
<span class="hljs-comment"># Code Review Skill</span>

<span class="hljs-string">When</span> <span class="hljs-string">reviewing</span> <span class="hljs-string">code,</span> <span class="hljs-attr">follow these steps:</span>

<span class="hljs-comment">## Review checklist</span>
<span class="hljs-number">1</span><span class="hljs-string">.</span> <span class="hljs-string">**Correctness**:</span> <span class="hljs-string">Does</span> <span class="hljs-string">the</span> <span class="hljs-string">code</span> <span class="hljs-string">do</span> <span class="hljs-string">what</span> <span class="hljs-string">it's</span> <span class="hljs-string">supposed</span> <span class="hljs-string">to?</span>
<span class="hljs-number">2</span><span class="hljs-string">.</span> <span class="hljs-string">**Edge</span> <span class="hljs-string">cases**:</span> <span class="hljs-string">Are</span> <span class="hljs-string">error</span> <span class="hljs-string">conditions</span> <span class="hljs-string">handled?</span>
<span class="hljs-number">3</span><span class="hljs-string">.</span> <span class="hljs-string">**Style**:</span> <span class="hljs-string">Does</span> <span class="hljs-string">it</span> <span class="hljs-string">follow</span> <span class="hljs-string">project</span> <span class="hljs-string">conventions?</span>
<span class="hljs-number">4</span><span class="hljs-string">.</span> <span class="hljs-string">**Performance**:</span> <span class="hljs-string">Are</span> <span class="hljs-string">there</span> <span class="hljs-string">obvious</span> <span class="hljs-string">inefficiencies?</span>

<span class="hljs-comment">## How to provide feedback</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">Be</span> <span class="hljs-string">specific</span> <span class="hljs-string">about</span> <span class="hljs-string">what</span> <span class="hljs-string">needs</span> <span class="hljs-string">to</span> <span class="hljs-string">change</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">Explain</span> <span class="hljs-string">why,</span> <span class="hljs-string">not</span> <span class="hljs-string">just</span> <span class="hljs-string">what</span>
<span class="hljs-bullet">-</span> <span class="hljs-string">Suggest</span> <span class="hljs-string">alternatives</span> <span class="hljs-string">when</span> <span class="hljs-string">possible</span>
</code></pre>
<hr/>
<h2 data-id="heading-9">ä¸‰ã€Agent Skills çš„ç”Ÿæ€é‡‡çº³</h2>
<p>Agent Skills å·²è¢«ä¼—å¤šä¸»æµ AI å¼€å‘å·¥å…·é‡‡çº³ï¼ŒåŒ…æ‹¬ï¼š</p>
<pre><code class="hljs language-css" lang="css">å¹³å°è¯´æ˜GitHub CopilotåŒ…å« VS <span class="hljs-selector-tag">Code</span> æŒ‡å—OpenAI Codexæ”¯æŒæ˜¾å¼é€‰æ‹© SkillCursorIDE é›†æˆæ”¯æŒVS <span class="hljs-selector-tag">Code</span>é€šè¿‡æ‰©å±•æ”¯æŒClaude CodeAnthropic å®˜æ–¹äº§å“Gemini CLIGoogle å‘½ä»¤è¡Œå·¥å…·OpenCodeã€Ampã€Gooseã€Factoryã€Lettaå„æœ‰æ–‡æ¡£æåŠå…¼å®¹ç»“æ„
</code></pre>
<p>è¿™æ„å‘³ç€ï¼š<strong>ä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„éƒ¨ç½²</strong>ã€‚ä¸ºä¸€ä¸ªå¹³å°åˆ›å»ºçš„ Skill å¯ä»¥åœ¨æ‰€æœ‰å…¼å®¹å¹³å°ä¸Šè¿è¡Œã€‚</p>
<hr/>
<h2 data-id="heading-10">å››ã€Antigravity IDE æ”¯æŒ Agent Skills çš„é‡å¤§æ„ä¹‰</h2>
<h3 data-id="heading-11">1. ä»"é€šç”¨æ™ºèƒ½"åˆ°"ä¸“ä¸šèƒ½åŠ›"çš„è·¨è¶Š</h3>
<p>ä¼ ç»Ÿ AI åŠ©æ‰‹ä¾èµ–é¢„è®­ç»ƒçŸ¥è¯†ï¼Œè€Œ Skills å…è®¸æ™ºèƒ½ä½“<strong>æŒ‰éœ€è·å–é¢†åŸŸä¸“ä¸šçŸ¥è¯†</strong>ï¼š</p>
<ul>
<li>æ³•å¾‹å®¡æŸ¥æµç¨‹ã€æ•°æ®åˆ†æç®¡é“ã€è´¢åŠ¡å®¡è®¡è§„èŒƒç­‰ä¸“ä¸šçŸ¥è¯†å¯ä»¥è¢«å°è£…ä¸º Skill</li>
<li>æ™ºèƒ½ä½“ä»"ä»€ä¹ˆéƒ½çŸ¥é“ä¸€ç‚¹"å˜æˆ"éœ€è¦æ—¶æˆä¸ºä¸“å®¶"</li>
</ul>
<h3 data-id="heading-12">2. çŸ¥è¯†çš„å¯ç®¡ç†æ€§ä¸å¯å®¡è®¡æ€§</h3>
<p>Skills ä»¥æ–‡ä»¶å½¢å¼å­˜åœ¨ï¼Œå¸¦æ¥äº†ä¼ ç»Ÿæç¤ºè¯æ— æ³•å®ç°çš„ä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>ç‰ˆæœ¬æ§åˆ¶</strong>ï¼šå¯ä»¥ç”¨ Git è¿½è¸ªçŸ¥è¯†çš„æ¼”å˜</li>
<li><strong>å¯å®¡è®¡</strong>ï¼šå›¢é˜Ÿå¯ä»¥å®¡æŸ¥æ™ºèƒ½ä½“éµå¾ªçš„å…·ä½“æŒ‡ä»¤</li>
<li><strong>å¯å¤ç°</strong>ï¼šç›¸åŒçš„ Skill äº§ç”Ÿä¸€è‡´çš„è¡Œä¸ºæ¨¡å¼</li>
</ul>
<h3 data-id="heading-13">3. ç»„ç»‡çŸ¥è¯†çš„æ ‡å‡†åŒ–æ•è·</h3>
<p>å¯¹äºä¼ä¸šè€Œè¨€ï¼ŒSkills æä¾›äº†ä¸€ç§<strong>å°†éšæ€§çŸ¥è¯†è½¬åŒ–ä¸ºæ˜¾æ€§èµ„äº§</strong>çš„æ–¹å¼ï¼š</p>
<ul>
<li>èµ„æ·±å‘˜å·¥çš„ç»éªŒå¯ä»¥ç¼–ç ä¸º Skills</li>
<li>æ–°å‘˜å·¥é€šè¿‡æ™ºèƒ½ä½“å³å¯è®¿é—®ç»„ç»‡æœ€ä½³å®è·µ</li>
<li>çŸ¥è¯†ä¸å†éšäººå‘˜æµåŠ¨è€Œæµå¤±</li>
</ul>
<hr/>
<h2 data-id="heading-14">äº”ã€Agent Skills çš„é‡å¤§æŠ€æœ¯è¿›æ­¥</h2>
<h3 data-id="heading-15">1. å¼€æ”¾æ ‡å‡†å¸¦æ¥çš„äº’æ“ä½œæ€§</h3>
<p>Agent Skills æ ¼å¼ç”± Anthropic å¼€å‘å¹¶ä½œä¸ºå¼€æ”¾æ ‡å‡†å‘å¸ƒï¼Œè¢«å¹¿æ³›é‡‡çº³ã€‚è¿™å®ç°äº†ï¼š</p>
<ul>
<li><strong>ä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„éƒ¨ç½²</strong>ï¼šä¸ºä¸€ä¸ªå¹³å°åˆ›å»ºçš„ Skill å¯ä»¥è·¨å¹³å°ä½¿ç”¨</li>
<li><strong>ç”Ÿæ€åä½œ</strong>ï¼šä¸åŒå‚å•†çš„å·¥å…·å¯ä»¥å…±äº«åŒä¸€å¥— Skills</li>
<li><strong>é¿å…é”å®š</strong>ï¼šç”¨æˆ·æŠ•èµ„çš„çŸ¥è¯†èµ„äº§ä¸ä¼šè¢«ç»‘å®šåœ¨å•ä¸€å¹³å°</li>
</ul>
<h3 data-id="heading-16">2. ä¸Šä¸‹æ–‡æ•ˆç‡çš„é©å‘½æ€§æå‡</h3>
<p>æ¸è¿›å¼æŠ«éœ²æ¨¡å¼æ˜¯å¯¹ä¸Šä¸‹æ–‡çª—å£çš„<strong>æ™ºèƒ½ç®¡ç†</strong>ï¼Œè§£å†³äº† AI å¼€å‘å·¥å…·é¢ä¸´çš„æ ¸å¿ƒæŒ‘æˆ˜â€”â€”å¦‚ä½•åœ¨æœ‰é™çš„ä¸Šä¸‹æ–‡çª—å£ä¸­å¡å…¥è¶³å¤Ÿçš„ä¿¡æ¯ï¼š</p>
<ul>
<li>å¯åŠ¨æ—¶åªåŠ è½½çº¦ 100 tokens çš„å…ƒæ•°æ®</li>
<li>æ¿€æ´»æ—¶åŠ è½½å®Œæ•´æŒ‡ä»¤ï¼ˆå»ºè®® &lt; 5000 tokensï¼‰</li>
<li>èµ„æºæ–‡ä»¶æŒ‰éœ€åŠ è½½</li>
</ul>
<h3 data-id="heading-17">3. ä»"å·¥å…·è°ƒç”¨"åˆ°"èƒ½åŠ›æ‰©å±•"çš„èŒƒå¼è½¬æ¢</h3>
<p>ä¸ MCPï¼ˆModel Context Protocolï¼‰ç­‰å·¥å…·åè®®ç›¸æ¯”ï¼ŒSkills æä¾›çš„æ˜¯æ›´é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼š</p>
<ul>
<li><strong>MCP</strong> å‘Šè¯‰æ™ºèƒ½ä½“"ä½ å¯ä»¥æ‰§è¡Œè¿™ä¸ªæ“ä½œ"ï¼ˆæä¾›å·¥å…·ï¼‰</li>
<li><strong>Skills</strong> å‘Šè¯‰æ™ºèƒ½ä½“"åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŒ‰ç…§è¿™ä¸ªæµç¨‹ï¼Œä½¿ç”¨è¿™äº›å·¥å…·"ï¼ˆæä¾›ä½¿ç”¨å·¥å…·çš„æµç¨‹åŒ–çŸ¥è¯†ï¼‰</li>
</ul>
<p>ä¸¤è€…æ˜¯<strong>äº’è¡¥è€Œéæ›¿ä»£</strong>çš„å…³ç³»ï¼šMCP æ‰©å±•æ™ºèƒ½ä½“èƒ½åšä»€ä¹ˆï¼ŒSkills æŒ‡å¯¼æ™ºèƒ½ä½“å¦‚ä½•åšã€‚</p>
<h3 data-id="heading-18">4. ä»£ç†è‡ªä¸»æ€§çš„æ–°æ°´å¹³</h3>
<p>Skills çš„è®¾è®¡è®©æ™ºèƒ½ä½“èƒ½å¤Ÿ<strong>è‡ªä¸»åˆ¤æ–­ä½•æ—¶éœ€è¦é¢å¤–èƒ½åŠ›</strong>ï¼š</p>
<ul>
<li>æ— éœ€ç”¨æˆ·æ˜¾å¼æŒ‡å®šä½¿ç”¨å“ªä¸ª Skillï¼ˆä½†å¯ä»¥æ˜¾å¼æŒ‡å®šä»¥æé«˜ç¡®å®šæ€§ï¼‰</li>
<li>æ™ºèƒ½ä½“æ ¹æ®ä»»åŠ¡æè¿°è‡ªåŠ¨åŒ¹é…æœ€ç›¸å…³çš„ Skill</li>
<li>å®ç°äº†èƒ½åŠ›çš„åŠ¨æ€å‘ç°ä¸åº”ç”¨</li>
</ul>
<hr/>
<h2 data-id="heading-19">å…­ã€æ€»ç»“</h2>
<p>Antigravity IDE å¯¹ Agent Skills çš„æ”¯æŒæ ‡å¿—ç€ AI è¾…åŠ©å¼€å‘ä»"å¯¹è¯å¼åŠ©æ‰‹"å‘"å¯å®šåˆ¶ä¸“ä¸šä»£ç†"çš„é‡è¦æ¼”è¿›ã€‚</p>
<p>Skills çš„æ ¸å¿ƒä»·å€¼åœ¨äºä¸‰ç‚¹ï¼š</p>
<ol>
<li><strong>çŸ¥è¯†å¤–ç½®åŒ–</strong>ï¼šå°†é¢†åŸŸçŸ¥è¯†ä»æ¨¡å‹æƒé‡ä¸­è§£è€¦ï¼Œå˜æˆå¯ç¼–è¾‘ã€å¯ç‰ˆæœ¬æ§åˆ¶çš„æ–‡ä»¶</li>
<li><strong>ä¸Šä¸‹æ–‡é«˜æ•ˆåŒ–</strong>ï¼šé€šè¿‡æ¸è¿›å¼æŠ«éœ²ï¼Œåœ¨æœ‰é™çª—å£ä¸­æœ€å¤§åŒ–æœ‰æ•ˆä¿¡æ¯å¯†åº¦</li>
<li><strong>èƒ½åŠ›ç”Ÿæ€åŒ–</strong>ï¼šé€šè¿‡å¼€æ”¾æ ‡å‡†ï¼Œå®ç°è·¨å¹³å°çš„çŸ¥è¯†å…±äº«ä¸å¤ç”¨</li>
</ol>
<p>è¿™ç§æ¶æ„çš„æ·±è¿œæ„ä¹‰åœ¨äºï¼šå®ƒå°† AI çš„èƒ½åŠ›è¾¹ç•Œä»æ¨¡å‹æœ¬èº«çš„è®­ç»ƒæ•°æ®ï¼Œæ‰©å±•åˆ°äº†äººç±»å¯ä»¥éšæ—¶æ³¨å…¥çš„ä»»ä½•é¢†åŸŸçŸ¥è¯†ã€‚è¿™æ˜¯è¿ˆå‘çœŸæ­£"å¯ç¼–ç¨‹æ™ºèƒ½"çš„å…³é”®ä¸€æ­¥ã€‚</p>
<hr/>
<p><strong>ä¿¡æ¯æ¥æº</strong>ï¼š</p>
<ul>
<li>Antigravity å®˜æ–¹æ–‡æ¡£ï¼š<code>antigravity.google/docs/skills</code></li>
<li>Agent Skills å¼€æ”¾æ ‡å‡†ï¼š<code>agentskills.io</code></li>
</ul>
<h2 data-id="heading-20">ä¸ƒã€é«˜çº§ç”¨æ³•</h2>
<h3 data-id="heading-21">åŸºç¡€</h3>
<ol>
<li>
<p>ä¸“æ³¨å•ä¸€ä»»åŠ¡ + æ¸…æ™°è§¦å‘æè¿°ï¼ˆæœ€ä½³å®è·µæ ¸å¿ƒï¼‰</p>
<ul>
<li>é¿å…â€œä¸‡èƒ½æŠ€èƒ½â€ï¼Œæ¯ä¸ªæŠ€èƒ½åªè§£å†³ä¸€ç±»é—®é¢˜ï¼ˆå¦‚â€œä»£ç å®¡æŸ¥â€æˆ–â€œè®®äº‹å½•æ¸…ä¹¦â€ï¼‰ã€‚</li>
<li>Description å†™æ˜â€œä½•æ—¶ç”¨â€ï¼šä¾‹å¦‚ â€œå½“ç”¨æˆ·è¦æ±‚ä»£ç å®¡æŸ¥æ—¶ï¼Œä½¿ç”¨æ­¤æŠ€èƒ½æ£€æŸ¥å®‰å…¨è§„åˆ™å’Œå‘½åè§„èŒƒâ€ã€‚</li>
<li>ä¼˜åŠ¿ï¼šAgent è‡ªåŠ¨åˆ¤æ–­åŠ è½½ï¼Œå‡å°‘ä¸Šä¸‹æ–‡æ±¡æŸ“ã€‚</li>
</ul>
</li>
<li>
<p>åŒ…å«å†³ç­–æ ‘ + è„šæœ¬è‡ªåŠ¨åŒ–ï¼ˆå¤„ç†å¤æ‚åœºæ™¯ï¼‰</p>
<ul>
<li>åœ¨ <a href="https://link.juejin.cn?target=http%3A%2F%2FSKILL.md" target="_blank" title="http://SKILL.md" ref="nofollow noopener noreferrer">SKILL.md</a> æ·»åŠ å†³ç­–åˆ†æ”¯ï¼šå¦‚â€œå¦‚æœä»£ç æ¶‰åŠæ•°æ®åº“ï¼Œå…ˆæ£€æŸ¥ SQL æ³¨å…¥é£é™©â€ã€‚</li>
<li>åµŒå…¥è„šæœ¬ï¼ˆPython/Bashï¼‰ï¼šå¤„ç†ç¡®å®šæ€§ä»»åŠ¡ï¼ˆå¦‚æ•°æ®éªŒè¯ã€Git æ“ä½œï¼‰ã€‚</li>
<li>ç¤ºä¾‹ï¼šä»£ç å®¡æŸ¥æŠ€èƒ½ â†’ Agent å…ˆè¿è¡Œ --help æ£€æŸ¥è„šæœ¬ï¼Œå†æ‰§è¡Œã€‚ç”¨æˆ· ç§°â€œè¿™ç»ˆäºä¸ç”¨åƒåŸå§‹äººä¸€æ ·é‡å¤é€ è½®å­â€ã€‚</li>
</ul>
</li>
<li>
<p>å›¢é˜ŸçŸ¥è¯†èµ„äº§åŒ– + æš—é»™çŸ¥å›ºåŒ–ï¼ˆä¼ä¸šçº§é«˜çº§ç”¨æ³•ï¼‰</p>
<ul>
<li>å°†â€œè´ç‰¹å…°ç»éªŒâ€ï¼ˆè°ƒæŸ¥æŠ€å·§ã€å‘å¸ƒæµç¨‹ï¼‰å†™æˆæŠ€èƒ½ï¼ŒGit ç®¡ç†å…±äº«ã€‚</li>
<li>å…¨å±€æŠ€èƒ½ï¼šå…¬å¸è§„èŒƒï¼ˆå¦‚å®‰å…¨è§„åˆ™ï¼‰æ”¾å…¨å±€è·¯å¾„ï¼Œæ‰€æœ‰ Agent è‡ªåŠ¨ç»§æ‰¿ã€‚</li>
<li>éå·¥ç¨‹å¸ˆåœºæ™¯ï¼šå†…å®¹åˆ›ä½œï¼ˆè‡ªå®šä¹‰æ–‡ä½“ï¼‰ã€ç«å“ç ”ç©¶ï¼ˆå›ºå®šè°ƒæŸ¥é¡¹ï¼‰ã€æ—¥æŠ¥/å‘¨æŠ¥ï¼ˆç¤¾å†…æ¨¡æ¿ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p>ä¸ Antigravity åŸç”ŸåŠŸèƒ½ç»„åˆï¼ˆå‘æŒ¥å¹³å°ä¼˜åŠ¿ï¼‰</p>
<ul>
<li>ç»“åˆ Browser Subagentï¼šæŠ€èƒ½ä¸­åµŒå…¥æµè§ˆå™¨æ“ä½œï¼ˆå¦‚è‡ªåŠ¨æµ‹è¯•ç½‘é¡µï¼‰ã€‚</li>
<li>å¤š Agent å¹¶è¡Œï¼ˆAgent Managerï¼‰ï¼šä¸€ä¸ªæŠ€èƒ½ç®¡ä»£ç ï¼Œä¸€ä¸ªç®¡æµ‹è¯•ï¼ŒInbox ç»Ÿä¸€å®¡æ‰¹ã€‚</li>
<li>Artifacts éªŒè¯ï¼šæŠ€èƒ½è¾“å‡ºå¸¦æˆªå›¾/å½•å±ï¼Œä¾¿äºå®¡æ ¸ã€‚</li>
</ul>
</li>
<li>
<p>è·¨å·¥å…·è¿ç§» + å¼€æºæŠ€èƒ½å¸‚åœºï¼ˆç”Ÿæ€é«˜çº§ç©æ³•ï¼‰</p>
<ul>
<li>å¼€æ”¾æ ‡å‡†ï¼šæŠ€èƒ½å¯è¿ç§»åˆ° Claudeã€Cursorã€VS Code ç­‰ã€‚</li>
<li>å¼€æºèµ„æºï¼šAnthropic å®˜æ–¹æŠ€èƒ½åº“ã€Skillsmp å¸‚åœºã€‚</li>
<li>ç”¨æˆ·å»ºè®®ï¼šAI ç›´æ¥ç”ŸæˆæŠ€èƒ½ï¼ˆå¦‚â€œæŒ‰æ–‡æ¡£åˆ›å»ºä»£ç å®¡æŸ¥æŠ€èƒ½â€ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-22">é«˜çº§</h3>
<ol>
<li>é“¾å¼æŠ€èƒ½è°ƒç”¨ï¼ˆSkill Chainingï¼‰åœ¨ä¸€ä¸ªæŠ€èƒ½çš„ <a href="https://link.juejin.cn?target=http%3A%2F%2FSKILL.md" target="_blank" title="http://SKILL.md" ref="nofollow noopener noreferrer">SKILL.md</a> æœ«å°¾æ˜ç¡®å†™å‡ºâ€œä¸‹ä¸€æ­¥æ¨èæŠ€èƒ½â€ï¼ŒAgent ä¼šè‡ªåŠ¨å»ºè®®æˆ–ç›´æ¥è°ƒç”¨åç»­æŠ€èƒ½ã€‚ä¾‹å¦‚ä»£ç ç”ŸæˆæŠ€èƒ½ç»“æŸåè‡ªåŠ¨è§¦å‘â€œä»£ç å®¡æŸ¥æŠ€èƒ½â€ + â€œå•å…ƒæµ‹è¯•æŠ€èƒ½â€ã€‚ç”¨è¿™ç§æ–¹å¼æŠŠä¸€ä¸ªå¤æ‚é¡¹ç›®æ‹†æˆ 5-6 ä¸ªæŠ€èƒ½é“¾ï¼Œæ•´ä½“å®Œæˆæ—¶é—´ç¼©çŸ­ 60%ï¼Œé¿å…ä¸€æ¬¡æ€§æç¤ºè¿‡é•¿ã€‚</li>
<li>æ¡ä»¶è§¦å‘ + åŠ¨æ€å‚æ•°æ³¨å…¥åœ¨ description ä¸­ä½¿ç”¨å ä½ç¬¦ï¼ˆå¦‚ {language}ã€{project_type}ï¼‰ï¼ŒAgent ä¼šæ ¹æ®ä¸Šä¸‹æ–‡åŠ¨æ€å¡«å……è§¦å‘æ¡ä»¶ã€‚æŠ€å·§ï¼šç»“åˆ YAML å…ƒæ•°æ®å†™å¤šæ¡ description å˜ä½“ã€‚è¿™è®©åŒä¸€ä¸ªæŠ€èƒ½èƒ½é€‚é…å‰ç«¯/åç«¯/æ•°æ®ç®¡é“ç­‰å¤šç§åœºæ™¯ï¼Œæ— éœ€å¤åˆ¶å¤šä»½ã€‚</li>
<li>åµŒå…¥å¤–éƒ¨å·¥å…·è°ƒç”¨è„šæœ¬ï¼ˆTool Use Integrationï¼‰æŠ€èƒ½é‡Œç›´æ¥å†™ Python è„šæœ¬è°ƒç”¨ Google Cloud APIã€GitHub API æˆ–ç¬¬ä¸‰æ–¹æœåŠ¡ï¼ˆå¦‚ SerpAPI æœç´¢ï¼‰ã€‚Agent ä¼šè‡ªåŠ¨è¯·æ±‚æƒé™æ‰§è¡Œã€‚ç»éªŒï¼š è­¦å‘Šï¼Œå¿…é¡»åœ¨æŠ€èƒ½å¼€å¤´å£°æ˜æ‰€éœ€æƒé™ï¼Œå¦åˆ™ Agent ä¼šæ‹’ç»æ‰§è¡Œï¼›å®æˆ˜ä¸­ç”¨äºè‡ªåŠ¨åŒ–ç«å“ç›‘æ§ï¼Œçœå»æ‰‹åŠ¨å¤åˆ¶ç²˜è´´ã€‚</li>
<li>æŠ€èƒ½ç‰ˆæœ¬ç®¡ç† + Git é›†æˆæŠŠæ•´ä¸ª .agent/skills ç›®å½•æ”¾å…¥ Git ä»“åº“ï¼Œç”¨åˆ†æ”¯ç®¡ç†ä¸åŒç‰ˆæœ¬ã€‚æŠ€å·§ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2FSKILL.md" target="_blank" title="http://SKILL.md" ref="nofollow noopener noreferrer">SKILL.md</a> é¡¶éƒ¨åŠ  version å­—æ®µï¼ŒAgent ä¼šæç¤ºâ€œæ£€æµ‹åˆ°æ–°ç‰ˆæœ¬ï¼Œæ˜¯å¦å‡çº§ï¼Ÿâ€ã€‚å›¢é˜Ÿåä½œç¥å™¨ï¼Œé¿å…â€œæ¯ä¸ªäººæŠ€èƒ½ä¸ä¸€è‡´â€å¯¼è‡´è¾“å‡ºåå·®ã€‚</li>
<li>å¤šè¯­è¨€/å¤šæ¨¡æ€æŠ€èƒ½ä¸€ä¸ªæŠ€èƒ½æ–‡ä»¶å¤¹é‡ŒåŒæ—¶æ”¾ <a href="https://link.juejin.cn?target=http%3A%2F%2FSKILL.zh.md" target="_blank" title="http://SKILL.zh.md" ref="nofollow noopener noreferrer">SKILL.zh.md</a> å’Œ <a href="https://link.juejin.cn?target=http%3A%2F%2FSKILL.en.md" target="_blank" title="http://SKILL.en.md" ref="nofollow noopener noreferrer">SKILL.en.md</a>ï¼ŒAgent æ ¹æ®ç”¨æˆ·è¯­è¨€è‡ªåŠ¨åŠ è½½å¯¹åº”ç‰ˆæœ¬ã€‚è¿›é˜¶ï¼šåŠ å…¥å›¾åƒ/éŸ³é¢‘ç¤ºä¾‹ï¼ˆArtifactsï¼‰ï¼Œç”¨äºè§†è§‰è®¾è®¡æˆ–è¯­éŸ³è½¬å†™åœºæ™¯ã€‚éè‹±è¯­ç”¨æˆ·ç¦åˆ©å·¨å¤§ï¼Œ ç”¨æ­¤æ‰“é€ â€œä¸­æ–‡ä¸“å±å†™ä½œæŠ€èƒ½â€ï¼Œé£æ ¼ä¸€è‡´æ€§æé«˜ã€‚</li>
<li>æ‡’åŠ è½½ + åˆ†å±‚è®¾è®¡ï¼ˆProgressive Loadingï¼‰æŠŠæŠ€èƒ½æ‹†æˆ <a href="https://link.juejin.cn?target=http%3A%2F%2Fcore.md" target="_blank" title="http://core.md" ref="nofollow noopener noreferrer">core.md</a>ï¼ˆå§‹ç»ˆåŠ è½½ï¼Œè½»é‡æè¿°ï¼‰å’Œ advanced/ å­æ–‡ä»¶å¤¹ï¼ˆæŒ‰éœ€åŠ è½½è¯¦ç»†è„šæœ¬ï¼‰ã€‚æŠ€å·§ï¼šæ ¸å¿ƒéƒ¨åˆ†åªæ”¾è§¦å‘æ¡ä»¶å’Œç®€è¦æ­¥éª¤ï¼Œå¤æ‚é€»è¾‘æ”¾å­æ–‡ä»¶ã€‚ç»éªŒï¼šæœ‰æ•ˆé˜²æ­¢ä¸Šä¸‹æ–‡çª—å£çˆ†ç‚¸ï¼Œå¤§å‹é¡¹ç›®ï¼ˆ&gt;10k tokensï¼‰ä¹Ÿèƒ½æµç•…è¿è¡Œã€‚</li>
<li>å®‰å…¨å®¡è®¡æŠ€èƒ½ï¼ˆSelf-Audit Patternï¼‰åˆ›å»ºä¸€ä¸ªä¸“ç”¨â€œå®‰å…¨å®¡æŸ¥â€æŠ€èƒ½ï¼Œæ‰€æœ‰å…¶ä»–æŠ€èƒ½è¾“å‡ºå‰å¼ºåˆ¶ç»è¿‡å®ƒæ£€æŸ¥ï¼ˆé€šè¿‡é“¾å¼è°ƒç”¨ï¼‰ã€‚åŒ…å«å¸¸è§æ¼æ´æ¸…å•å’Œè‡ªåŠ¨åŒ–æ‰«æè„šæœ¬ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒå¿…å¤‡ï¼Œæ›¾å‘ç°å¤šä¸ªæ½œåœ¨æ•°æ®æ³„éœ²é£é™©ï¼Œâ€œå®å¯æ…¢ä¸€ç‚¹ï¼Œä¹Ÿä¸è¦å‡ºäº‹â€ã€‚</li>
<li>å¤š Agent åä½œæŠ€èƒ½ç¼–æ’ä½¿ç”¨ Agent Manager æ—¶ï¼Œä¸ºæ¯ä¸ªå­ Agent åˆ†é…ä¸“å±æŠ€èƒ½é›†ï¼ˆä¸åŒå…¨å±€å­ç›®å½•ï¼‰ã€‚æŠ€å·§ï¼šä¸» Agent çš„æŠ€èƒ½é‡Œå†™â€œåˆ†é…ä»»åŠ¡ç»™ Tester Agent / Writer Agentâ€ã€‚å¹¶è¡Œå¤„ç†å¤æ‚ä»»åŠ¡ï¼ˆå¦‚åŒæ—¶å†™ä»£ç  + å†™æ–‡æ¡£ + ç”»å›¾ï¼‰ï¼Œæ•ˆç‡ç¿»å€ï¼Œä½†éœ€è¦ç²¾å¿ƒè®¾è®¡ Inbox å®¡æ‰¹æµã€‚</li>
<li>è‡ªé€‚åº”/è‡ªæˆ‘ä¼˜åŒ–æŠ€èƒ½ï¼ˆMeta-Skillsï¼‰åˆ›å»ºä¸€ä¸ªâ€œæŠ€èƒ½ä¼˜åŒ–å¸ˆâ€æŠ€èƒ½ï¼šè¾“å…¥ç°æœ‰æŠ€èƒ½ + é¡¹ç›®åé¦ˆï¼ŒAgent è‡ªåŠ¨ç”Ÿæˆæ”¹è¿›ç‰ˆ <a href="https://link.juejin.cn?target=http%3A%2F%2FSKILL.md" target="_blank" title="http://SKILL.md" ref="nofollow noopener noreferrer">SKILL.md</a>ã€‚æŠ€å·§ï¼šè®© Agent å…ˆåˆ†æè¿‡å» 10 æ¬¡å¯¹è¯æ—¥å¿—ï¼Œå†é‡å†™ descriptionã€‚ç”¨äº†ä¸€å‘¨åï¼ŒæŠ€èƒ½è§¦å‘å‡†ç¡®ç‡ä» 70% æå‡åˆ° 95%ï¼Œå ªç§°â€œæŠ€èƒ½çš„æŠ€èƒ½â€ã€‚</li>
<li>æŠ€èƒ½å¸‚åœºåŒ–ä¸ç¤¾åŒºå¤ç”¨æŠŠä¼˜ç§€æŠ€èƒ½æ‰“åŒ…ä¸Šä¼ åˆ° Skillsmp æˆ– GitHub å¼€æºå¸‚åœºï¼ŒåŠ ä¸Šè¯¦ç»† README å’Œæ¼”ç¤ºè§†é¢‘ã€‚æŠ€å·§ï¼šç”¨æ ‡å‡†åŒ–æ¨¡æ¿ï¼ˆnameã€tagsã€preview ç¤ºä¾‹ï¼‰ï¼Œä¾¿äºä»–äººä¸€é”®å¯¼å…¥ã€‚ä¸€äº›ç”¨æˆ·å·²å¼€å§‹å°èŒƒå›´å˜ç°ï¼ˆä»˜è´¹æŠ€èƒ½åŒ…ï¼‰ï¼Œç¤¾åŒºåé¦ˆâ€œæœ€å¥½çš„æŠ€èƒ½å¾€å¾€æ¥è‡ªçœŸå®é¡¹ç›®ç—›ç‚¹â€ã€‚</li>
</ol>
<h3 data-id="heading-23">æ€»ç»“</h3>
<ul>
<li>è°ƒè¯•ç¬¬ä¸€åŸåˆ™ï¼šä»»ä½•æŠ€èƒ½ä¸ç†æƒ³æ—¶ï¼Œå…ˆè®© Agent â€œè§£é‡Šä½ ä¸ºä»€ä¹ˆæ²¡è§¦å‘è¿™ä¸ªæŠ€èƒ½â€ï¼Œç„¶åé’ˆå¯¹æ€§ä¼˜åŒ– descriptionã€‚</li>
<li>ä»ç®€å•å¼€å§‹ï¼šæ–°æ‰‹åˆ«æ€¥ç€å†™å¤æ‚è„šæœ¬ï¼Œå…ˆç”¨çº¯ Markdown å›ºåŒ–æœ€ä½³å®è·µï¼Œé€æ­¥åŠ è„šæœ¬ã€‚</li>
<li>æ€§èƒ½ç›‘æ§ï¼šå¼€å¯ Antigravity çš„æ—¥å¿—æ¨¡å¼ï¼Œè§‚å¯ŸæŠ€èƒ½åŠ è½½æ¬¡æ•°å’Œ token æ¶ˆè€—ï¼Œå®šæœŸç²¾ç®€ä½é¢‘æŠ€èƒ½ã€‚</li>
<li>é£é™©æ§åˆ¶ï¼šæ‰€æœ‰å«è„šæœ¬æŠ€èƒ½ï¼Œå…ˆåœ¨æ²™ç®±é¡¹ç›®æµ‹è¯• 3-5 æ¬¡ï¼Œå†æ¨åˆ°ç”Ÿäº§ã€‚</li>
<li>æœªæ¥è¶‹åŠ¿ï¼šä¼°è®¡ 2026 ä¸‹åŠå¹´ä¼šå‡ºâ€œæŠ€èƒ½å•†åº—â€å®˜æ–¹æ”¯æŒï¼Œå»ºè®®ç°åœ¨å°±å¼€å§‹ç§¯ç´¯ä¸ªäººæŠ€èƒ½åº“ã€‚</li>
</ul>
<h2 data-id="heading-24"><strong>ğŸš€UI UX Pro Max</strong> å®˜æ–¹ CLI å·¥å…·ä¸€é”®å®‰è£…ï¼š</h2>
<pre><code class="hljs language-css" lang="css">npm install -g uipro-cli
cd /path/<span class="hljs-selector-tag">to</span>/your/project
uipro init <span class="hljs-attr">--ai</span> claude    # æˆ– <span class="hljs-attribute">cursor</span>ã€windsurfã€copilotã€<span class="hljs-attribute">all</span> ç­‰
</code></pre>
<h3 data-id="heading-25">âš¡ï¸prompt</h3>
<pre><code class="hljs language-css" lang="css">/ui-ux-pro-max Build <span class="hljs-selector-tag">a</span> React Native e-commerce app UI with product listings, cart, and checkout <span class="hljs-attribute">flow</span>
</code></pre>
<pre><code class="hljs language-vbnet" lang="vbnet">/ui-ux-pro-max Build a complete Todo List app <span class="hljs-keyword">using</span> SwiftUI <span class="hljs-keyword">with</span>:

- Add <span class="hljs-built_in">new</span> tasks <span class="hljs-keyword">with</span> title <span class="hljs-built_in">and</span> <span class="hljs-keyword">optional</span> due <span class="hljs-type">date</span>
- Mark tasks <span class="hljs-keyword">as</span> complete/incomplete  
- Swipe <span class="hljs-keyword">to</span> delete tasks
- Filter <span class="hljs-keyword">by</span>: All, Active, Completed
- Persist data locally <span class="hljs-keyword">using</span> SwiftData
- Dark mode support
- Clean minimalist aesthetic

<span class="hljs-symbol">Target:</span> iOS <span class="hljs-number">17</span>+
</code></pre>
<pre><code class="hljs language-diff" lang="diff">/ui-ux-pro-max Design and build a productivity-focused Todo List app in SwiftUI:

Features:
<span class="hljs-deletion">- Task creation with title, notes, priority (low/medium/high), and due date</span>
<span class="hljs-deletion">- Categories/tags for organizing tasks</span>
<span class="hljs-deletion">- Mark complete with satisfying animation</span>
<span class="hljs-deletion">- Swipe actions: delete, edit, move to category</span>
<span class="hljs-deletion">- Today view showing due tasks</span>
<span class="hljs-deletion">- Search and filter functionality</span>
<span class="hljs-deletion">- Local notifications for due dates</span>

Design:
<span class="hljs-deletion">- Modern iOS aesthetic</span>
<span class="hljs-deletion">- Soft color palette for productivity</span>
<span class="hljs-deletion">- Smooth micro-interactions</span>
<span class="hljs-deletion">- Support both light and dark mode</span>

Stack: SwiftUI + SwiftData for iOS 17+
</code></pre>
<pre><code class="hljs language-arduino" lang="arduino">/ui-ux-pro-max Build a SwiftUI Todo app with a Neumorphism design style. 
Include add task, complete task, <span class="hljs-keyword">and</span> <span class="hljs-keyword">delete</span>. Use soft shadows <span class="hljs-keyword">and</span> subtle depth.
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[WebSocket åœ¨ Spring Boot ä¸­çš„å®æˆ˜è§£æï¼šå®æ—¶é€šä¿¡çš„æŠ€æœ¯åˆ©å™¨]]></title>    <link>https://juejin.cn/post/7595423299061661705</link>    <guid>https://juejin.cn/post/7595423299061661705</guid>    <pubDate>2026-01-15T16:25:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595423299061661705" data-draft-id="7595433213590618121" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="WebSocket åœ¨ Spring Boot ä¸­çš„å®æˆ˜è§£æï¼šå®æ—¶é€šä¿¡çš„æŠ€æœ¯åˆ©å™¨"/> <meta itemprop="keywords" content="åç«¯,WebSocket,Spring Boot"/> <meta itemprop="datePublished" content="2026-01-15T16:25:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‹æ¸¡è‹‡"/> <meta itemprop="url" content="https://juejin.cn/user/729731453429159"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            WebSocket åœ¨ Spring Boot ä¸­çš„å®æˆ˜è§£æï¼šå®æ—¶é€šä¿¡çš„æŠ€æœ¯åˆ©å™¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/729731453429159/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‹æ¸¡è‹‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-15T16:25:45.000Z" title="Thu Jan 15 2026 16:25:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body&gt;:first-child{margin-top:0!important}.markdown-body&gt;:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li&gt;p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre&gt;code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">WebSocket åœ¨ Spring Boot ä¸­çš„å®æˆ˜è§£æï¼šå®æ—¶é€šä¿¡çš„æŠ€æœ¯åˆ©å™¨</h2>
<h3 data-id="heading-1">ä¸€ã€å¼•è¨€ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ WebSocketï¼Ÿ</h3>
<p>åœ¨ä¼ ç»Ÿçš„ Web åº”ç”¨ä¸­ï¼Œå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ˜¯ <strong>è¯·æ±‚-å“åº”</strong> æ¨¡å¼ï¼šå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¤„ç†åè¿”å›ç»“æœã€‚è¿™ç§æ¨¡å¼é€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯ï¼Œä½†åœ¨éœ€è¦ <strong>å®æ—¶åŒå‘é€šä¿¡</strong> çš„åœºæ™¯ä¸‹ï¼ˆå¦‚èŠå¤©å®¤ã€è‚¡ç¥¨è¡Œæƒ…ã€åœ¨çº¿åä½œã€æ¸¸æˆç­‰ï¼‰ï¼Œé¢‘ç¹è½®è¯¢ï¼ˆPollingï¼‰æˆ–é•¿è½®è¯¢ï¼ˆLong Pollingï¼‰ä¼šå¸¦æ¥é«˜å»¶è¿Ÿã€é«˜å¼€é”€çš„é—®é¢˜ã€‚</p>
<p><strong>WebSocket</strong> åè®®åº”è¿è€Œç”Ÿâ€”â€”å®ƒæä¾›äº†ä¸€ç§<strong>å…¨åŒå·¥ã€ä½å»¶è¿Ÿã€æŒä¹…åŒ–</strong>çš„é€šä¿¡é€šé“ï¼Œå…è®¸æœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ï¼Œå½»åº•æ”¹å˜äº† Web å®æ—¶äº¤äº’çš„æ ¼å±€ã€‚</p>
<p>åœ¨ Spring Boot ç”Ÿæ€ä¸­ï¼Œé€šè¿‡ <code>spring-boot-starter-websocket</code> æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾é›†æˆ WebSocketï¼Œå¹¶ç»“åˆ STOMPï¼ˆSimple Text-Oriented Messaging Protocolï¼‰å®ç°æ›´é«˜çº§çš„æ¶ˆæ¯è·¯ç”±ä¸è®¢é˜…æœºåˆ¶ã€‚</p>
<h4 data-id="heading-2">1.1 ä»â€œè½®è¯¢â€åˆ°â€œé•¿è¿æ¥â€çš„è¿›åŒ–å²</h4>
<p>åœ¨WebSocketå‡ºç°ä¹‹å‰ï¼Œå®ç°å®æ—¶é€šä¿¡ä¸»è¦é è¿™äº›â€œåœŸåŠæ³•â€ï¼š</p>

























<table><thead><tr><th align="left">æŠ€æœ¯æ–¹æ¡ˆ</th><th align="left">å·¥ä½œåŸç†</th><th align="left">ç¼ºç‚¹</th></tr></thead><tbody><tr><td align="left"><strong>çŸ­è½®è¯¢</strong></td><td align="left">å®¢æˆ·ç«¯æ¯éš”å‡ ç§’é—®ä¸€æ¬¡ï¼šâ€œæœ‰æ–°æ¶ˆæ¯å—ï¼Ÿâ€</td><td align="left">æµªè´¹å¸¦å®½ï¼Œå®æ—¶æ€§å·®</td></tr><tr><td align="left"><strong>é•¿è½®è¯¢</strong></td><td align="left">å®¢æˆ·ç«¯é—®â€œæœ‰æ–°æ¶ˆæ¯å—ï¼Ÿâ€ï¼ŒæœåŠ¡å™¨holdä½ï¼Œæœ‰æ¶ˆæ¯æ‰å›å¤</td><td align="left">è¿æ¥å ç”¨æ—¶é—´é•¿ï¼ŒæœåŠ¡å™¨å‹åŠ›å¤§</td></tr><tr><td align="left"><strong>SSE</strong></td><td align="left">æœåŠ¡å™¨å•å‘æ¨é€ï¼Œå®¢æˆ·ç«¯åªèƒ½æ¥æ”¶</td><td align="left">å•å‘é€šä¿¡ï¼ŒåŠŸèƒ½æœ‰é™</td></tr></tbody></table>
<p><strong>WebSocketçš„ç™»åœºæ”¹å˜äº†æ¸¸æˆè§„åˆ™ï¼š</strong></p>
<ul>
<li><strong>ä¸€æ¬¡æ¡æ‰‹ï¼ŒæŒä¹…è¿æ¥</strong>ï¼šå»ºç«‹è¿æ¥åï¼ŒåŒå‘é€šé“ä¸€ç›´æ‰“å¼€</li>
<li><strong>æœåŠ¡ç«¯ä¸»åŠ¨æ¨é€</strong>ï¼šæœåŠ¡å™¨æƒ³ä»€ä¹ˆæ—¶å€™å‘å°±ä»€ä¹ˆæ—¶å€™å‘</li>
<li><strong>æä½çš„é€šä¿¡å¼€é”€</strong>ï¼šæ²¡æœ‰HTTPå¤´éƒ¨çš„é‡å¤ä¼ è¾“</li>
</ul>
<h4 data-id="heading-3">1.2 WebSocket vs HTTPï¼šæœ¬è´¨åŒºåˆ«</h4>
<p><strong>HTTPäº¤äº’æµç¨‹ï¼ˆåƒå‘çŸ­ä¿¡ï¼‰ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f5e586c4d78c48799860ae34d620f854~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5rih6IuH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769099145&amp;x-signature=HDegd5hYl2MWabm74ElThDo%2FKEg%3D" alt="HTTPäº¤äº’" loading="lazy"/></p>
<p><strong>æ¯æ¬¡è¯·æ±‚éƒ½è¦é‡å¤ï¼šå»ºç«‹TCPè¿æ¥ â†’ TLSæ¡æ‰‹ â†’ å‘é€HTTPå¤´éƒ¨ â†’ ä¼ è¾“æ•°æ® â†’ æ–­å¼€è¿æ¥</strong></p>
<p><strong>WebSocketäº¤äº’æµç¨‹ï¼ˆåƒæ‰“ç”µè¯ï¼‰ï¼š</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e25d267ea9847a68f4fc0deaba7ac96~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5rih6IuH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769099145&amp;x-signature=a%2FEpynyLQWG3BKK44QCmkhNSPEQ%3D" alt="WebSocket" loading="lazy"/></p>
<p>äºŒè€…çš„å…³é”®åŒºåˆ«ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/63ee2d4c27dc4ae8b828ed6c465d852c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5rih6IuH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769099145&amp;x-signature=WVZE36xvZMuWU3C4OJDrhG7uOjU%3D" alt="å±€éƒ¨æˆªå–_20260116_002240.png" loading="lazy"/></p>
<h3 data-id="heading-4">äºŒã€Spring Boot ä¸­çš„ WebSocket æŠ€æœ¯æ ˆ</h3>
<p>Spring å¯¹ WebSocket çš„æ”¯æŒåˆ†ä¸ºä¸¤ä¸ªå±‚æ¬¡ï¼š</p>




















<table><thead><tr><th>å±‚çº§</th><th>æŠ€æœ¯</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>åº•å±‚</strong></td><td><code>javax.websocket</code> æˆ– Spring åŸç”Ÿ WebSocket</td><td>ç›´æ¥å¤„ç†åŸå§‹ WebSocket æ¶ˆæ¯</td></tr><tr><td><strong>é«˜å±‚</strong></td><td><strong>STOMP over WebSocket</strong></td><td>åŸºäºæ¶ˆæ¯ä»£ç†çš„å‘å¸ƒ/è®¢é˜…æ¨¡å‹ï¼Œæ›´æ˜“å¼€å‘</td></tr></tbody></table>
<blockquote>
<p>âœ… <strong>æ¨èä½¿ç”¨ STOMP</strong>ï¼šå®ƒæä¾›äº†ç±»ä¼¼ JMS çš„è¯­ä¹‰ï¼ˆç›®çš„åœ°ã€è®¢é˜…ã€å¹¿æ’­ï¼‰ï¼Œé€‚åˆå¤æ‚ä¸šåŠ¡åœºæ™¯ã€‚</p>
</blockquote>
<h4 data-id="heading-5">2.1 æ ¸å¿ƒæ³¨è§£ä¸ç±»</h4>

























<table><thead><tr><th>ç»„ä»¶</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>@EnableWebSocketMessageBroker</code></td><td>å¯ç”¨ WebSocket æ¶ˆæ¯ä»£ç†</td></tr><tr><td><code>WebSocketMessageBrokerConfigurer</code></td><td>é…ç½® STOMP ç«¯ç‚¹ä¸æ¶ˆæ¯ä»£ç†</td></tr><tr><td><code>@MessageMapping</code></td><td>æ˜ å°„å®¢æˆ·ç«¯å‘é€åˆ°ç‰¹å®šè·¯å¾„çš„æ¶ˆæ¯</td></tr><tr><td><code>SimpMessagingTemplate</code></td><td>æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯</td></tr></tbody></table>
<h4 data-id="heading-6">2.2 ä¸‰æ­¥å¿«é€Ÿé›†æˆ</h4>
<p><strong>ç¬¬ä¸€æ­¥ï¼šæ·»åŠ ä¾èµ–</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p><strong>ç¬¬äºŒæ­¥ï¼šé…ç½®WebSocket</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableWebSocket</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebSocketConfigurer</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerWebSocketHandlers</span><span class="hljs-params">(WebSocketHandlerRegistry registry)</span> {
        <span class="hljs-comment">// æ³¨å†Œå¤„ç†å™¨ï¼ŒæŒ‡å®šè¿æ¥è·¯å¾„</span>
        registry.addHandler(myWebSocketHandler(), <span class="hljs-string">"/ws"</span>)
                .setAllowedOrigins(<span class="hljs-string">"*"</span>)  <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒè¦é™åˆ¶å…·ä½“åŸŸå</span>
                .withSockJS();  <span class="hljs-comment">// ä¸ºä¸æ”¯æŒWebSocketçš„æµè§ˆå™¨æä¾›é™çº§æ–¹æ¡ˆ</span>
    }
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> WebSocketHandler <span class="hljs-title function_">myWebSocketHandler</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyWebSocketHandler</span>();
    }
}
</code></pre>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šå®ç°æ ¸å¿ƒå¤„ç†å™¨</strong></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyWebSocketHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">TextWebSocketHandler</span> {
    
    <span class="hljs-comment">// ä¿å­˜æ‰€æœ‰æ´»è·ƒè¿æ¥</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, WebSocketSession&gt; sessions = 
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterConnectionEstablished</span><span class="hljs-params">(WebSocketSession session)</span> {
        <span class="hljs-comment">// è¿æ¥å»ºç«‹æ—¶è°ƒç”¨</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> extractUserId(session);
        sessions.put(userId, session);
        log.info(<span class="hljs-string">"ç”¨æˆ· {} è¿æ¥æˆåŠŸï¼Œå½“å‰åœ¨çº¿: {} äºº"</span>, userId, sessions.size());
        
        <span class="hljs-comment">// å‘é€æ¬¢è¿æ¶ˆæ¯</span>
        session.sendMessage(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextMessage</span>(<span class="hljs-string">"è¿æ¥æˆåŠŸï¼"</span>));
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleTextMessage</span><span class="hljs-params">(WebSocketSession session, 
                                     TextMessage message)</span> {
        <span class="hljs-comment">// å¤„ç†å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> message.getPayload();
        log.info(<span class="hljs-string">"æ”¶åˆ°æ¶ˆæ¯: {}"</span>, payload);
        
        <span class="hljs-comment">// å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œæ¯”å¦‚å¹¿æ’­æˆ–å®šå‘å›å¤</span>
        handleMessage(session, payload);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">afterConnectionClosed</span><span class="hljs-params">(WebSocketSession session, 
                                      CloseStatus status)</span> {
        <span class="hljs-comment">// è¿æ¥å…³é—­æ—¶è°ƒç”¨</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> extractUserId(session);
        sessions.remove(userId);
        log.info(<span class="hljs-string">"ç”¨æˆ· {} æ–­å¼€è¿æ¥ï¼ŒåŸå› : {}"</span>, userId, status);
    }
}
</code></pre>
<h4 data-id="heading-7">2.3 è¿›é˜¶ï¼šä½¿ç”¨STOMPåè®®</h4>
<h5 data-id="heading-8">2.3.1 ä»€ä¹ˆæ˜¯STOMPï¼Ÿ</h5>
<p>STOMPï¼ˆSimple Text Oriented Messaging Protocolï¼‰æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡æœ¬åè®®ï¼Œå®ƒä¸ºWebSocketæä¾›äº†æ›´é«˜çº§çš„æ¶ˆæ¯æ¨¡å¼ã€‚å¦‚æœè¯´åŸå§‹çš„WebSocketæ˜¯"è£¸å¥”"ï¼Œé‚£ä¹ˆSTOMPå°±æ˜¯ç»™å®ƒç©¿ä¸Šäº†"åè®®çš„å¤–è¡£"ã€‚</p>
<p><strong>STOMPçš„æ ¸å¿ƒæ¦‚å¿µï¼š</strong></p>
<ul>
<li><strong>Destinationï¼ˆç›®çš„åœ°ï¼‰</strong>ï¼šæ¶ˆæ¯å‘é€çš„ç›®æ ‡åœ°å€</li>
<li><strong>SUBSCRIBEï¼ˆè®¢é˜…ï¼‰</strong>ï¼šå®¢æˆ·ç«¯è®¢é˜…æŸä¸ªç›®çš„åœ°</li>
<li><strong>SENDï¼ˆå‘é€ï¼‰</strong>ï¼šå®¢æˆ·ç«¯å‘ç›®çš„åœ°å‘é€æ¶ˆæ¯</li>
<li><strong>MESSAGEï¼ˆæ¶ˆæ¯ï¼‰</strong>ï¼šæœåŠ¡å™¨å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯</li>
</ul>
<h5 data-id="heading-9">2.3.2 STOMPåè®®ç»“æ„</h5>
<p>ä¸€ä¸ªç®€å•çš„STOMPå¸§ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">SEND
destination:/app/chat
content-type:application/json
content-length:23

{<span class="hljs-string">"text"</span>:<span class="hljs-string">"Hello World!"</span>}
</code></pre>
<p>å“åº”å¸§ï¼š</p>
<pre><code class="hljs language-perl" lang="perl">MESSAGE
destination:<span class="hljs-regexp">/topic/</span>chat
content-type:application/json
content-<span class="hljs-keyword">length</span>:<span class="hljs-number">45</span>
subscription:<span class="hljs-function"><span class="hljs-keyword">sub</span>-0
<span class="hljs-title">message</span>-<span class="hljs-title">id</span>:<span class="hljs-title">msg</span>-123

</span>{<span class="hljs-string">"user"</span>:<span class="hljs-string">"Tom"</span>,<span class="hljs-string">"text"</span>:<span class="hljs-string">"Hello World!"</span>}
</code></pre>
<h5 data-id="heading-10">2.3.3 SpringBootä¸­çš„STOMPé…ç½®</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableWebSocketMessageBroker</span>  <span class="hljs-comment">// å¯ç”¨STOMPæ¶ˆæ¯ä»£ç†</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketStompConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">WebSocketMessageBrokerConfigurer</span> {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerStompEndpoints</span><span class="hljs-params">(StompEndpointRegistry registry)</span> {
        <span class="hljs-comment">// æ³¨å†ŒSTOMPç«¯ç‚¹</span>
        registry.addEndpoint(<span class="hljs-string">"/ws-stomp"</span>)
                .setAllowedOrigins(<span class="hljs-string">"*"</span>)
                .withSockJS();  <span class="hljs-comment">// SockJSæ”¯æŒ</span>
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">configureMessageBroker</span><span class="hljs-params">(MessageBrokerRegistry registry)</span> {
        <span class="hljs-comment">// é…ç½®æ¶ˆæ¯ä»£ç†</span>
        registry.enableSimpleBroker(<span class="hljs-string">"/topic"</span>, <span class="hljs-string">"/queue"</span>);  <span class="hljs-comment">// å®¢æˆ·ç«¯è®¢é˜…çš„å‰ç¼€</span>
        registry.setApplicationDestinationPrefixes(<span class="hljs-string">"/app"</span>);  <span class="hljs-comment">// å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯çš„å‰ç¼€</span>
        registry.setUserDestinationPrefix(<span class="hljs-string">"/user"</span>);  <span class="hljs-comment">// ç”¨æˆ·ç§ä¿¡å‰ç¼€</span>
    }
}
</code></pre>
<h5 data-id="heading-11">2.3.4 STOMPæ§åˆ¶å™¨ç¤ºä¾‹</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Controller</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChatController</span> {
    
    <span class="hljs-comment">// å¤„ç†å‘é€åˆ°/app/chatçš„æ¶ˆæ¯</span>
    <span class="hljs-meta">@MessageMapping("/chat")</span>
    <span class="hljs-meta">@SendTo("/topic/chat")</span>  <span class="hljs-comment">// å¹¿æ’­ç»™æ‰€æœ‰è®¢é˜…/topic/chatçš„å®¢æˆ·ç«¯</span>
    <span class="hljs-keyword">public</span> ChatMessage <span class="hljs-title function_">handleChatMessage</span><span class="hljs-params">(ChatMessage message)</span> {
        message.setTimestamp(LocalDateTime.now());
        log.info(<span class="hljs-string">"æ”¶åˆ°èŠå¤©æ¶ˆæ¯: {}"</span>, message);
        <span class="hljs-keyword">return</span> message;
    }
    
    <span class="hljs-comment">// å¤„ç†ç§ä¿¡</span>
    <span class="hljs-meta">@MessageMapping("/private")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendPrivateMessage</span><span class="hljs-params">(<span class="hljs-meta">@Payload</span> PrivateMessage message,
                                   SimpMessageHeaderAccessor headerAccessor)</span> {
        <span class="hljs-comment">// è·å–å‘é€è€…</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">sender</span> <span class="hljs-operator">=</span> headerAccessor.getUser().getName();
        
        <span class="hljs-comment">// ä½¿ç”¨convertAndSendToUserå‘é€ç»™ç‰¹å®šç”¨æˆ·</span>
        simpMessagingTemplate.convertAndSendToUser(
            message.getRecipient(),  <span class="hljs-comment">// æ¥æ”¶è€…ç”¨æˆ·å</span>
            <span class="hljs-string">"/queue/private"</span>,        <span class="hljs-comment">// ç”¨æˆ·ç§ä¿¡é˜Ÿåˆ—</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">PrivateMessage</span>(sender, message.getRecipient(), message.getContent())
        );
    }
    
    <span class="hljs-comment">// å¤„ç†è®¢é˜…é€šçŸ¥</span>
    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleSessionSubscribe</span><span class="hljs-params">(SessionSubscribeEvent event)</span> {
        <span class="hljs-type">StompHeaderAccessor</span> <span class="hljs-variable">headers</span> <span class="hljs-operator">=</span> StompHeaderAccessor.wrap(event.getMessage());
        <span class="hljs-type">String</span> <span class="hljs-variable">destination</span> <span class="hljs-operator">=</span> headers.getDestination();
        <span class="hljs-type">String</span> <span class="hljs-variable">sessionId</span> <span class="hljs-operator">=</span> headers.getSessionId();
        
        log.info(<span class="hljs-string">"Session {} è®¢é˜…äº† {}"</span>, sessionId, destination);
    }
}
</code></pre>
<h5 data-id="heading-12">2.4.5 å‰ç«¯STOMPå®¢æˆ·ç«¯ç¤ºä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿æ¥STOMPæœåŠ¡å™¨</span>
<span class="hljs-keyword">const</span> socket = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SockJS</span>(<span class="hljs-string">'/ws-stomp'</span>);
<span class="hljs-keyword">const</span> stompClient = <span class="hljs-title class_">Stomp</span>.<span class="hljs-title function_">over</span>(socket);

<span class="hljs-comment">// è¿æ¥æˆåŠŸå›è°ƒ</span>
stompClient.<span class="hljs-title function_">connect</span>({}, <span class="hljs-keyword">function</span>(<span class="hljs-params">frame</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Connected: '</span> + frame);
    
    <span class="hljs-comment">// è®¢é˜…å…¬å…±èŠå¤©é¢‘é“</span>
    stompClient.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">'/topic/chat'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) {
        <span class="hljs-keyword">const</span> chatMsg = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message.<span class="hljs-property">body</span>);
        <span class="hljs-title function_">showMessage</span>(chatMsg);
    });
    
    <span class="hljs-comment">// è®¢é˜…ä¸ªäººç§ä¿¡é˜Ÿåˆ—</span>
    stompClient.<span class="hljs-title function_">subscribe</span>(<span class="hljs-string">'/user/queue/private'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) {
        <span class="hljs-keyword">const</span> privateMsg = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message.<span class="hljs-property">body</span>);
        <span class="hljs-title function_">showPrivateMessage</span>(privateMsg);
    });
});

<span class="hljs-comment">// å‘é€èŠå¤©æ¶ˆæ¯</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> message = {
        <span class="hljs-attr">content</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'message'</span>).<span class="hljs-property">value</span>,
        <span class="hljs-attr">sender</span>: currentUser
    };
    stompClient.<span class="hljs-title function_">send</span>(<span class="hljs-string">"/app/chat"</span>, {}, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(message));
}

<span class="hljs-comment">// å‘é€ç§ä¿¡</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sendPrivateMessage</span>(<span class="hljs-params">toUser, content</span>) {
    <span class="hljs-keyword">const</span> message = {
        <span class="hljs-attr">recipient</span>: toUser,
        <span class="hljs-attr">content</span>: content
    };
    stompClient.<span class="hljs-title function_">send</span>(<span class="hljs-string">"/app/private"</span>, {}, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(message));
}
</code></pre>
<h3 data-id="heading-13">ä¸‰ã€WebSocketçš„æ ¸å¿ƒæŠ€æœ¯è¦ç‚¹</h3>
<h4 data-id="heading-14">3.1 è¿æ¥ç”Ÿå‘½å‘¨æœŸç®¡ç†</h4>
<p>è¿æ¥ç”Ÿå‘½å‘¨æœŸåŒ…æ‹¬å››ä¸ªå…³é”®é˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µéœ€è¦å¤„ç†ä¸åŒçš„ä¸šåŠ¡é€»è¾‘ï¼š</p>
<h5 data-id="heading-15">å»ºç«‹è¿æ¥æ—¶ï¼ˆafterConnectionEstablishedï¼‰éœ€è¦å¤„ç†ï¼š</h5>
<ol>
<li><strong>éªŒè¯ç”¨æˆ·èº«ä»½</strong> - æ£€æŸ¥tokenæˆ–sessionï¼Œç¡®ä¿è¿æ¥åˆæ³•æ€§</li>
<li><strong>åˆå§‹åŒ–ä¼šè¯çŠ¶æ€</strong> - åˆ›å»ºç”¨æˆ·ä¼šè¯ä¸Šä¸‹æ–‡ï¼Œä¿å­˜å¿…è¦ä¿¡æ¯</li>
<li><strong>é€šçŸ¥ç›¸å…³æœåŠ¡ç”¨æˆ·ä¸Šçº¿</strong> - æ›´æ–°ç”¨æˆ·åœ¨çº¿çŠ¶æ€ï¼Œé€šçŸ¥å¥½å‹</li>
<li><strong>å‘é€æœªè¯»æ¶ˆæ¯</strong> - æ¨é€ç¦»çº¿æœŸé—´ç§¯ç´¯çš„æ¶ˆæ¯</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketLifecycleManager</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onOpen</span><span class="hljs-params">(String sessionId, String userId)</span> {
        <span class="hljs-comment">// 1. éªŒè¯ç”¨æˆ·èº«ä»½</span>
        <span class="hljs-keyword">if</span> (!userService.validateToken(userId, getToken(sessionId))) {
            closeConnection(sessionId, CloseStatus.NOT_ACCEPTABLE);
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// 2. åˆå§‹åŒ–ä¼šè¯çŠ¶æ€</span>
        <span class="hljs-type">SessionContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SessionContext</span>(userId, sessionId);
        sessionStore.save(sessionId, context);
        
        <span class="hljs-comment">// 3. é€šçŸ¥ç›¸å…³æœåŠ¡ç”¨æˆ·ä¸Šçº¿</span>
        presenceService.userOnline(userId);
        notifyFriends(userId, <span class="hljs-literal">true</span>); <span class="hljs-comment">// é€šçŸ¥å¥½å‹ç”¨æˆ·ä¸Šçº¿</span>
        
        <span class="hljs-comment">// 4. å‘é€æœªè¯»æ¶ˆæ¯</span>
        List&lt;Message&gt; unreadMessages = messageService.getUnreadMessages(userId);
        unreadMessages.forEach(msg -&gt; sendMessage(sessionId, msg));
    }
}
</code></pre>
<h5 data-id="heading-16">æ¶ˆæ¯å¤„ç†æ—¶ï¼ˆhandleTextMessageï¼‰éœ€è¦å¤„ç†ï¼š</h5>
<ol>
<li><strong>æ¶ˆæ¯æ ¼å¼éªŒè¯</strong> - æ£€æŸ¥JSONæ ¼å¼ã€å¿…è¦å­—æ®µ</li>
<li><strong>ä¸šåŠ¡é€»è¾‘å¤„ç†</strong> - æ ¹æ®æ¶ˆæ¯ç±»å‹æ‰§è¡Œä¸åŒä¸šåŠ¡</li>
<li><strong>æ¶ˆæ¯æŒä¹…åŒ–</strong> - ä¿å­˜åˆ°æ•°æ®åº“ï¼Œç¡®ä¿ä¸ä¸¢å¤±</li>
<li><strong>å“åº”æˆ–è½¬å‘</strong> - å›å¤å‘é€è€…æˆ–è½¬å‘ç»™å…¶ä»–ç”¨æˆ·</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(String sessionId, String rawMessage)</span> {
    <span class="hljs-comment">// 1. æ¶ˆæ¯æ ¼å¼éªŒè¯</span>
    Message message;
    <span class="hljs-keyword">try</span> {
        message = jsonMapper.readValue(rawMessage, Message.class);
        validateMessage(message);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        sendError(sessionId, <span class="hljs-string">"æ¶ˆæ¯æ ¼å¼é”™è¯¯"</span>);
        <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// 2. ä¸šåŠ¡é€»è¾‘å¤„ç†</span>
    <span class="hljs-keyword">switch</span> (message.getType()) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"CHAT"</span>:
            handleChatMessage(sessionId, message);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"COMMAND"</span>:
            handleCommand(sessionId, message);
            <span class="hljs-keyword">break</span>;
        <span class="hljs-comment">// ... å…¶ä»–æ¶ˆæ¯ç±»å‹</span>
    }
    
    <span class="hljs-comment">// 3. æ¶ˆæ¯æŒä¹…åŒ–</span>
    messageService.saveMessage(message);
    
    <span class="hljs-comment">// 4. å“åº”æˆ–è½¬å‘</span>
    <span class="hljs-keyword">if</span> (message.needResponse()) {
        sendResponse(sessionId, createResponse(message));
    }
    <span class="hljs-keyword">if</span> (message.needForward()) {
        forwardMessage(message.getTarget(), message);
    }
}
</code></pre>
<h5 data-id="heading-17">è¿æ¥å…³é—­æ—¶ï¼ˆafterConnectionClosedï¼‰éœ€è¦å¤„ç†ï¼š</h5>
<ol>
<li><strong>æ¸…ç†ä¼šè¯èµ„æº</strong> - é‡Šæ”¾å†…å­˜ï¼Œå…³é—­ç›¸å…³èµ„æº</li>
<li><strong>æ›´æ–°ç”¨æˆ·çŠ¶æ€ä¸ºç¦»çº¿</strong> - æ ‡è®°ç”¨æˆ·ä¸‹çº¿æ—¶é—´</li>
<li><strong>è®°å½•æ–­å¼€åŸå› </strong> - ç”¨äºåˆ†æè¿æ¥ç¨³å®šæ€§</li>
<li><strong>é€šçŸ¥ç›¸å…³æœåŠ¡</strong> - é€šçŸ¥å¥½å‹ç”¨æˆ·ä¸‹çº¿</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClose</span><span class="hljs-params">(String sessionId, CloseStatus status)</span> {
    <span class="hljs-comment">// 1. æ¸…ç†ä¼šè¯èµ„æº</span>
    <span class="hljs-type">SessionContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> sessionStore.remove(sessionId);
    <span class="hljs-keyword">if</span> (context != <span class="hljs-literal">null</span>) {
        context.cleanup();
    }
    
    <span class="hljs-comment">// 2. æ›´æ–°ç”¨æˆ·çŠ¶æ€ä¸ºç¦»çº¿</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> getUserIdFromSession(sessionId);
    presenceService.userOffline(userId);
    
    <span class="hljs-comment">// 3. è®°å½•æ–­å¼€åŸå› </span>
    connectionLogService.logDisconnect(sessionId, userId, status.getCode(), status.getReason());
    
    <span class="hljs-comment">// 4. é€šçŸ¥ç›¸å…³æœåŠ¡</span>
    notifyFriends(userId, <span class="hljs-literal">false</span>); <span class="hljs-comment">// é€šçŸ¥å¥½å‹ç”¨æˆ·ä¸‹çº¿</span>
    cleanupUserSubscriptions(userId); <span class="hljs-comment">// æ¸…ç†ç”¨æˆ·çš„æ‰€æœ‰è®¢é˜…</span>
}
</code></pre>
<h5 data-id="heading-18">é”™è¯¯æ—¶ï¼ˆhandleTransportErrorï¼‰éœ€è¦å¤„ç†ï¼š</h5>
<ol>
<li><strong>è®°å½•é”™è¯¯æ—¥å¿—</strong> - è¯¦ç»†è®°å½•å¼‚å¸¸ä¿¡æ¯</li>
<li><strong>å°è¯•æ¢å¤è¿æ¥</strong> - å¯¹äºå¯æ¢å¤é”™è¯¯å°è¯•é‡è¿</li>
<li><strong>é€šçŸ¥ç›‘æ§ç³»ç»Ÿ</strong> - è§¦å‘å‘Šè­¦ï¼Œäººå·¥å¹²é¢„</li>
<li><strong>ä¼˜é›…é™çº§</strong> - åˆ‡æ¢åˆ°å¤‡ç”¨é€šä¿¡æ–¹å¼</li>
</ol>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onError</span><span class="hljs-params">(String sessionId, Throwable error)</span> {
    <span class="hljs-comment">// 1. è®°å½•é”™è¯¯æ—¥å¿—</span>
    log.error(<span class="hljs-string">"WebSocketè¿æ¥é”™è¯¯ sessionId: {}"</span>, sessionId, error);
    
    <span class="hljs-comment">// 2. å°è¯•æ¢å¤è¿æ¥ï¼ˆå¦‚æœæ˜¯ç½‘ç»œæ³¢åŠ¨ç­‰ä¸´æ—¶é”™è¯¯ï¼‰</span>
    <span class="hljs-keyword">if</span> (isRecoverableError(error)) {
        scheduleReconnection(sessionId);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// 3. é€šçŸ¥ç›‘æ§ç³»ç»Ÿ</span>
        alertService.sendAlert(<span class="hljs-string">"WebSocketè¿æ¥å¼‚å¸¸"</span>, 
            <span class="hljs-string">"Session: "</span> + sessionId + <span class="hljs-string">", Error: "</span> + error.getMessage());
        
        <span class="hljs-comment">// 4. ä¼˜é›…é™çº§</span>
        fallbackToHttp(sessionId, getUserIdFromSession(sessionId));
        closeConnection(sessionId, CloseStatus.SERVER_ERROR);
    }
}
</code></pre>
<h4 data-id="heading-19">3.2 å¿ƒè·³æœºåˆ¶ä¸å¥åº·æ£€æŸ¥</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeartbeatConfig</span> {
    
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> ServletServerContainerFactoryBean <span class="hljs-title function_">createWebSocketContainer</span><span class="hljs-params">()</span> {
        <span class="hljs-type">ServletServerContainerFactoryBean</span> <span class="hljs-variable">container</span> <span class="hljs-operator">=</span> 
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletServerContainerFactoryBean</span>();
        
        <span class="hljs-comment">// é‡è¦é…ç½®</span>
        container.setMaxSessionIdleTimeout(<span class="hljs-number">300000L</span>);     <span class="hljs-comment">// 5åˆ†é’Ÿæ— æ´»åŠ¨æ–­å¼€</span>
        container.setMaxTextMessageBufferSize(<span class="hljs-number">8192</span>);     <span class="hljs-comment">// æœ€å¤§æ¶ˆæ¯å¤§å°</span>
        container.setMaxBinaryMessageBufferSize(<span class="hljs-number">8192</span>);
        container.setAsyncSendTimeout(<span class="hljs-number">5000L</span>);           <span class="hljs-comment">// å¼‚æ­¥å‘é€è¶…æ—¶</span>
        
        <span class="hljs-keyword">return</span> container;
    }
}

<span class="hljs-comment">// å¿ƒè·³æ£€æµ‹å®ç°</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeartbeatService</span> {
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">ScheduledExecutorService</span> <span class="hljs-variable">scheduler</span> <span class="hljs-operator">=</span> 
        Executors.newScheduledThreadPool(<span class="hljs-number">1</span>);
    
    <span class="hljs-meta">@PostConstruct</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startHeartbeat</span><span class="hljs-params">()</span> {
        scheduler.scheduleAtFixedRate(() -&gt; {
            checkConnections();
            sendPing();
        }, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, TimeUnit.SECONDS);  <span class="hljs-comment">// æ¯30ç§’æ£€æµ‹ä¸€æ¬¡</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkConnections</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æ£€æŸ¥æ‰€æœ‰è¿æ¥çš„å¥åº·çŠ¶æ€</span>
        <span class="hljs-comment">// ç§»é™¤åƒµå°¸è¿æ¥</span>
        <span class="hljs-comment">// è®°å½•è¿æ¥ç»Ÿè®¡ä¿¡æ¯</span>
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendPing</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// å‘æ‰€æœ‰æ´»è·ƒè¿æ¥å‘é€pingæ¶ˆæ¯</span>
        <span class="hljs-comment">// å¤„ç†æœªå“åº”pongçš„è¿æ¥</span>
    }
}
</code></pre>
<h4 data-id="heading-20">3.3 æ¶ˆæ¯å¯é æ€§ä¸é‡è¿æœºåˆ¶</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReliableMessageService</span> {
    
    <span class="hljs-comment">// æ¶ˆæ¯ç¡®è®¤æœºåˆ¶</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendWithAck</span><span class="hljs-params">(String sessionId, String message)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">msgId</span> <span class="hljs-operator">=</span> generateMsgId();
        
        <span class="hljs-comment">// å‘é€æ¶ˆæ¯</span>
        webSocketHandler.send(sessionId, wrapMessage(msgId, message));
        
        <span class="hljs-comment">// å¯åŠ¨ç¡®è®¤è®¡æ—¶å™¨</span>
        scheduler.schedule(() -&gt; {
            <span class="hljs-keyword">if</span> (!isAcked(msgId)) {
                log.warn(<span class="hljs-string">"æ¶ˆæ¯ {} æœªç¡®è®¤ï¼Œå°è¯•é‡å‘"</span>, msgId);
                retrySend(sessionId, msgId, message);
            }
        }, <span class="hljs-number">5</span>, TimeUnit.SECONDS);
    }
    
    <span class="hljs-comment">// å®¢æˆ·ç«¯é‡è¿å¤„ç†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleReconnect</span><span class="hljs-params">(String oldSessionId, String newSessionId)</span> {
        <span class="hljs-comment">// 1. è½¬ç§»ä¼šè¯çŠ¶æ€</span>
        <span class="hljs-comment">// 2. é‡å‘æœªç¡®è®¤æ¶ˆæ¯</span>
        <span class="hljs-comment">// 3. æ¢å¤è®¢é˜…å…³ç³»</span>
        <span class="hljs-comment">// 4. æ›´æ–°ä¼šè¯æ˜ å°„</span>
    }
    
    <span class="hljs-comment">// æ¶ˆæ¯å»é‡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDuplicate</span><span class="hljs-params">(String msgId)</span> {
        <span class="hljs-comment">// åŸºäºRedisæˆ–æœ¬åœ°ç¼“å­˜å®ç°</span>
        <span class="hljs-comment">// é˜²æ­¢é‡å¤å¤„ç†æ¶ˆæ¯</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<h3 data-id="heading-21">å››ã€å®æˆ˜ï¼šå†™ä¸€ä¸ªç›‘æ§SpringBootåº”ç”¨çš„å®æ—¶ç›‘æ§å‘Šè­¦ç³»ç»Ÿ</h3>
<p><strong>Spring Insight</strong> æ˜¯æˆ‘çš„ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œç›®å‰æ­£åœ¨ç´§å¼ çš„å¼€å‘ä¸­ã€‚é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fiweidujiang%2Fspring-insight" target="_blank" title="https://github.com/iweidujiang/spring-insight" ref="nofollow noopener noreferrer">github.com/iweidujiangâ€¦</a>ï¼Œæ¬¢è¿å…³æ³¨ï¼Œé¡ºä¾¿æ±‚ä¸ª starï¼Œå“ˆå“ˆã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b544b3fc6cc4226b44bec969557395b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6IuP5rih6IuH:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769099145&amp;x-signature=ylqjw2lys0Tuw%2F0ukmfTtsM2TO8%3D" alt="æ±‚æ±‚ä½ åœ¨çº¿ç¼–è¾‘-æ±‚å…³æ³¨å…¬ä¼—å·è¡¨æƒ…åŒ…é…å›¾-å›¾å¸æœº" loading="lazy"/></p>
<p>åœ¨ç›‘æ§è¯Šæ–­ç±»å·¥å…·ä¸­ï¼ŒWebSocket å¯ä»¥ï¼š</p>
<ol>
<li><strong>å®æ—¶å‘Šè­¦</strong>ï¼šç¬¬ä¸€æ—¶é—´å‘ç°é—®é¢˜</li>
<li><strong>åŠ¨æ€æ‹“æ‰‘</strong>ï¼šå®æ—¶å±•ç¤ºå¾®æœåŠ¡ä¾èµ–å˜åŒ–</li>
<li><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šå®æ—¶æ¨é€æŒ‡æ ‡æ•°æ®</li>
<li><strong>åœ¨çº¿è¯Šæ–­</strong>ï¼šå®æ—¶æŸ¥çœ‹æ—¥å¿—å’Œè·Ÿè¸ªä¿¡æ¯</li>
</ol>
<p>ä¾‹ï¼Œå®æ—¶ç»Ÿè®¡å½“å‰ç›‘æ§ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * å¹¿æ’­å®æ—¶ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ¯5ç§’ä¸€æ¬¡ï¼‰
 */</span>
<span class="hljs-meta">@Scheduled(fixedDelay = 5000)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">broadcastStats</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">if</span> (connectionCount.get() == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// è·å–æœ€æ–°æ•°æ®</span>
        <span class="hljs-type">var</span> <span class="hljs-variable">collectorStats</span> <span class="hljs-operator">=</span> dataCollectorService.getCollectorStats();
        <span class="hljs-type">var</span> <span class="hljs-variable">serviceStats</span> <span class="hljs-operator">=</span> dataCollectorService.getServiceStats();
        <span class="hljs-type">var</span> <span class="hljs-variable">errorAnalysis</span> <span class="hljs-operator">=</span> dataCollectorService.getErrorAnalysis(<span class="hljs-number">1</span>); <span class="hljs-comment">// æœ€è¿‘1å°æ—¶</span>

        <span class="hljs-comment">// æ„å»ºæ¶ˆæ¯</span>
        Map&lt;String, Object&gt; data = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        data.put(<span class="hljs-string">"collectorStats"</span>, collectorStats);
        data.put(<span class="hljs-string">"serviceStats"</span>, serviceStats.subList(<span class="hljs-number">0</span>, Math.min(<span class="hljs-number">5</span>, serviceStats.size())));
        data.put(<span class="hljs-string">"errorAnalysis"</span>, errorAnalysis.subList(<span class="hljs-number">0</span>, Math.min(<span class="hljs-number">5</span>, errorAnalysis.size())));
        data.put(<span class="hljs-string">"timestamp"</span>, Instant.now().toString());
        data.put(<span class="hljs-string">"cacheSize"</span>, dataCollectorService.getCacheSize());

        <span class="hljs-type">WebSocketMessage</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketMessage</span>();
        message.setType(<span class="hljs-string">"STATS_UPDATE"</span>);
        message.setData(data);

        <span class="hljs-comment">// å¹¿æ’­æ¶ˆæ¯</span>
        messagingTemplate.convertAndSend(<span class="hljs-string">"/topic/stats"</span>, message);
        log.debug(<span class="hljs-string">"å¹¿æ’­å®æ—¶ç»Ÿè®¡ä¿¡æ¯"</span>);

    } <span class="hljs-keyword">catch</span> (Exception e) {
        log.error(<span class="hljs-string">"å¹¿æ’­å®æ—¶ç»Ÿè®¡ä¿¡æ¯å¤±è´¥"</span>, e);
    }
}
</code></pre>
<h3 data-id="heading-22">äº”ã€å…¶ä»–å…¸å‹ä½¿ç”¨åœºæ™¯</h3>



































<table><thead><tr><th>åœºæ™¯</th><th>è¯´æ˜</th><th>WebSocket ä¼˜åŠ¿</th></tr></thead><tbody><tr><td><strong>åœ¨çº¿å®¢æœ/èŠå¤©ç³»ç»Ÿ</strong></td><td>ç”¨æˆ·ä¸å®¢æœå®æ—¶å¯¹è¯</td><td>ä½å»¶è¿Ÿã€æ”¯æŒå¤šæˆ¿é—´</td></tr><tr><td><strong>è‚¡ç¥¨/é‡‘èè¡Œæƒ…æ¨é€</strong></td><td>å®æ—¶ä»·æ ¼æ›´æ–°</td><td>å‡å°‘æœåŠ¡å™¨å‹åŠ›ï¼Œé¿å…è½®è¯¢</td></tr><tr><td><strong>ååŒç¼–è¾‘</strong></td><td>å¤šäººåŒæ—¶ç¼–è¾‘æ–‡æ¡£</td><td>å®æ—¶åŒæ­¥æ“ä½œï¼Œå†²çªæ£€æµ‹</td></tr><tr><td><strong>æ¸¸æˆçŠ¶æ€åŒæ­¥</strong></td><td>å¤šäººåœ¨çº¿å°æ¸¸æˆ</td><td>é«˜é¢‘æ¶ˆæ¯ä¼ é€’ï¼Œæ¯«ç§’çº§å“åº”</td></tr><tr><td><strong>IoT è®¾å¤‡ç›‘æ§</strong></td><td>ä¼ æ„Ÿå™¨æ•°æ®ä¸ŠæŠ¥</td><td>é•¿è¿æ¥èŠ‚çœèµ„æº</td></tr></tbody></table>
<p><strong>âœ… ç”¨WebSocketï¼š</strong></p>
<ul>
<li>å®æ—¶åŒå‘é€šä¿¡éœ€æ±‚ï¼ˆèŠå¤©ã€åä½œï¼‰</li>
<li>é«˜é¢‘æ•°æ®æ¨é€ï¼ˆç›‘æ§ã€è¡Œæƒ…ï¼‰</li>
<li>ä½å»¶è¿Ÿè¦æ±‚ï¼ˆæ¸¸æˆã€å®æ—¶æ§åˆ¶ï¼‰</li>
<li>æœåŠ¡ç«¯ä¸»åŠ¨é€šçŸ¥ï¼ˆå‘Šè­¦ã€çŠ¶æ€æ›´æ–°ï¼‰</li>
</ul>
<p><strong>âŒ ä¸ç”¨WebSocketï¼š</strong></p>
<ul>
<li>ç®€å•çš„è¯·æ±‚-å“åº”æ¨¡å¼ï¼ˆREST APIè¶³å¤Ÿï¼‰</li>
<li>å®¢æˆ·ç«¯å¶å°”æ‹‰å–æ•°æ®ï¼ˆç”¨HTTPè½®è¯¢ï¼‰</li>
<li>å•å‘ä¿¡æ¯æµï¼ˆè€ƒè™‘SSEï¼‰</li>
<li>ç§»åŠ¨ç«¯å¼±ç½‘ç»œç¯å¢ƒï¼ˆå¯èƒ½è¿æ¥ä¸ç¨³å®šï¼‰</li>
</ul>
<h3 data-id="heading-23">å…­ã€æ€»ç»“</h3>
<p>WebSocket æ˜¯æ„å»ºç°ä»£å®æ—¶ Web åº”ç”¨çš„åŸºçŸ³ã€‚Spring Boot é€šè¿‡ç®€æ´çš„é…ç½®å’Œå¼ºå¤§çš„ STOMP æ”¯æŒï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿå¿«é€Ÿå®ç°é«˜æ€§èƒ½ã€å¯æ‰©å±•çš„åŒå‘é€šä¿¡ç³»ç»Ÿã€‚</p>
<blockquote>
<p><strong>è®°ä½</strong>ï¼šä¸æ˜¯æ‰€æœ‰åœºæ™¯éƒ½éœ€è¦ WebSocketã€‚å¯¹äºä½é¢‘æ›´æ–°ï¼ˆå¦‚æ¯åˆ†é’Ÿä¸€æ¬¡ï¼‰ï¼Œä¼ ç»Ÿ REST + å®šæ—¶è½®è¯¢å¯èƒ½æ›´ç®€å•ã€‚ä½†åœ¨<strong>é«˜é¢‘ã€ä½å»¶è¿Ÿã€äº‹ä»¶é©±åŠ¨</strong>çš„åœºæ™¯ä¸‹ï¼ŒWebSocket å‡ ä¹æ˜¯å”¯ä¸€é€‰æ‹©ã€‚</p>
</blockquote>
<hr/>
<p>æˆ‘çš„æŠ€æœ¯æ€è€ƒå’Œå®è·µï¼Œç»Ÿä¸€æ²‰æ·€åœ¨è¿™äº›åœ°æ–¹ï¼š</p>
<p>ğŸŒ å¾®ä¿¡å…¬ä¼—å·ï¼šã€Œè‹æ¸¡è‹‡ã€</p>
<p>æ¨é€æœ€ç¨³å®šï¼Œé€‚åˆæ·±åº¦é˜…è¯»</p>
<p>â­ï¸ æ˜é‡‘ï¼šã€Œè‹æ¸¡è‹‡ã€</p>
<p><a href="https://juejin.cn/user/729731453429159" target="_blank" title="https://juejin.cn/user/729731453429159">juejin.cn/user/729731â€¦</a></p>
<p>ğŸ’¡ çŸ¥ä¹ï¼šã€Œè‹æ¸¡è‹‡ã€</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fiweidujiang" target="_blank" title="https://www.zhihu.com/people/iweidujiang" ref="nofollow noopener noreferrer">www.zhihu.com/people/iweiâ€¦</a></p>
<p>ğŸ“˜ CSDNï¼šã€Œè‹æ¸¡è‹‡ã€</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fiweidujiang" target="_blank" title="https://blog.csdn.net/iweidujiang" ref="nofollow noopener noreferrer">blog.csdn.net/iweidujiang</a></p>
<p>ğŸ™ GitHubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fiweidujiang" target="_blank" title="https://github.com/iweidujiang" ref="nofollow noopener noreferrer">github.com/iweidujiang</a></p>
<p>æ‰€æœ‰ä»£ç çš„æºå¤´ï¼ŒåŒ…æ‹¬ Spring Insight å¼€æºé¡¹ç›®ï¼Œæ„Ÿè°¢ Star â­</p>
<p>éå¸¸æ„Ÿè°¢ä½ å…³æ³¨æˆ‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«æ‰‹å†™å»¶è¿Ÿï¼Android Ink API 1.0 æ­£å¼ç‰ˆé‡ç£…å‘å¸ƒï¼Œ4ms æè‡´ä½“éªŒè§¦æ‰‹å¯åŠ]]></title>    <link>https://juejin.cn/post/7595478717985062921</link>    <guid>https://juejin.cn/post/7595478717985062921</guid>    <pubDate>2026-01-16T00:47:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595478717985062921" data-draft-id="7595495896134713370" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«æ‰‹å†™å»¶è¿Ÿï¼Android Ink API 1.0 æ­£å¼ç‰ˆé‡ç£…å‘å¸ƒï¼Œ4ms æè‡´ä½“éªŒè§¦æ‰‹å¯åŠ"/> <meta itemprop="keywords" content="Android,Android Jetpack"/> <meta itemprop="datePublished" content="2026-01-16T00:47:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é»„æ—æ™´"/> <meta itemprop="url" content="https://juejin.cn/user/3985057546510423"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«æ‰‹å†™å»¶è¿Ÿï¼Android Ink API 1.0 æ­£å¼ç‰ˆé‡ç£…å‘å¸ƒï¼Œ4ms æè‡´ä½“éªŒè§¦æ‰‹å¯åŠ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3985057546510423/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é»„æ—æ™´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T00:47:24.000Z" title="Fri Jan 16 2026 00:47:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>2025å¹´12æœˆ17æ—¥ï¼ŒGoogle æ­£å¼å‘å¸ƒ Android Ink API 1.0 ç¨³å®šç‰ˆï¼Œè¿™æ˜¯ä¸€ä¸ªè®©è§¦æ§ç¬”åº”ç”¨å¼€å‘å˜å¾—å‰æ‰€æœªæœ‰ç®€å•çš„ Jetpack åº“ã€‚Google Docsã€Google Photosã€Chrome PDFã€Circle to Search ç­‰æ˜æ˜Ÿåº”ç”¨éƒ½åœ¨ä½¿ç”¨å®ƒï¼</p>
</blockquote>
<h2 data-id="heading-0">Ink API æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<h3 data-id="heading-1">èƒŒæ™¯ï¼šä¸ºä»€ä¹ˆéœ€è¦ Ink APIï¼Ÿ</h3>
<p>ç”¨æˆ·æœŸæœ›è§¦æ§ç¬”ä½“éªŒèƒ½åƒåœ¨çº¸ä¸Šä¹¦å†™ä¸€æ ·æµç•…è‡ªç„¶ã€‚è™½ç„¶ Android æ—©å·²é€šè¿‡æ¡†æ¶çº§ API å°†ä¹¦å†™å»¶è¿Ÿé™è‡³æƒŠäººçš„ <strong>4 æ¯«ç§’</strong>ï¼ˆå‡ ä¹æ— æ³•æ„ŸçŸ¥ï¼‰ï¼Œä½†å¼€å‘è€…ä»ç„¶é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ï¼š</p>
<ul>
<li>ğŸ¨ ç¬”è§¦ç”Ÿæˆç®—æ³•å¤æ‚</li>
<li>ğŸ–Œï¸ æ¸²æŸ“æ€§èƒ½ä¼˜åŒ–å›°éš¾</li>
<li>ğŸ“ å‡ ä½•è®¡ç®—ï¼ˆæ“¦é™¤ã€é€‰æ‹©ï¼‰ç¹ç</li>
<li>âš¡ ä½å»¶è¿Ÿå®ç°é—¨æ§›é«˜</li>
</ul>
<p><strong>Ink API åº”è¿è€Œç”Ÿï¼</strong> å®ƒå°†è¿™äº›å¤æ‚çš„åº•å±‚é€»è¾‘å°è£…æˆç®€æ´çš„ APIï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿä¸“æ³¨äºæ‰“é€ ç‹¬ç‰¹çš„åº”ç”¨åŠŸèƒ½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/49036255e47a486e9ff9a0f0ae04e90c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769129243&amp;x-signature=JsAAItP5N9F%2B4hs1oFS3an%2Bifq0%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">æ ¸å¿ƒç‰¹æ€§</h3>

























<table><thead><tr><th>ç‰¹æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ğŸš€ <strong>è¶…ä½å»¶è¿Ÿ</strong></td><td>åŸºäº Jetpack Graphics Libraryï¼Œæä¾› 4ms çº§å“åº”</td></tr><tr><td>ğŸ§© <strong>æ¨¡å—åŒ–è®¾è®¡</strong></td><td>æŒ‰éœ€å¼•å…¥ï¼Œçµæ´»ç»„åˆ</td></tr><tr><td>ğŸ¯ <strong>Compose ä¼˜å…ˆ</strong></td><td>å®Œç¾é€‚é… Jetpack Compose</td></tr><tr><td>ğŸ“± <strong>å¹¿æ³›å…¼å®¹</strong></td><td>æ”¯æŒ Android 5.0 (API 21) åŠä»¥ä¸Š</td></tr></tbody></table>
<h3 data-id="heading-3">è°åœ¨ç”¨ï¼Ÿ</h3>
<p>Ink API å·²ç»åœ¨å¤šæ¬¾ <strong>Google æ ¸å¿ƒåº”ç”¨</strong>ä¸­å¤§è§„æ¨¡ä½¿ç”¨ï¼š</p>
<ul>
<li>âœ… <strong>Google Docs</strong> - æ–‡æ¡£æ ‡æ³¨</li>
<li>âœ… <strong>Google Photos</strong> - ç…§ç‰‡ç¼–è¾‘</li>
<li>âœ… <strong>Chrome PDF</strong> - PDF æ‰¹æ³¨</li>
<li>âœ… <strong>Circle to Search</strong> - åœˆé€‰æœç´¢</li>
<li>âœ… <strong>Pixel Studio</strong> - åˆ›æ„ç»˜ç”»</li>
<li>âœ… <strong>YouTube Effect Maker</strong> - ç‰¹æ•ˆåˆ¶ä½œ</li>
</ul>
<blockquote>
<p>Circle to Search å›¢é˜Ÿåé¦ˆï¼š"é›†æˆè¿‡ç¨‹éå¸¸é¡ºåˆ©ï¼Œä¸€å‘¨å†…å°±æ„å»ºäº†å¯å·¥ä½œçš„åŸå‹ï¼"</p>
</blockquote>
<hr/>
<h2 data-id="heading-4">æ¨¡å—æ¶æ„è¯¦è§£</h2>
<p>Ink API é‡‡ç”¨ <strong>äº”å¤§æ ¸å¿ƒæ¨¡å—</strong> çš„æ¶æ„è®¾è®¡ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Ink API                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Strokes    â”‚    Brush     â”‚   Geometry   â”‚   Rendering    â”‚
â”‚   ç¬”è§¦æ¨¡å—    â”‚   ç”»ç¬”æ¨¡å—    â”‚   å‡ ä½•æ¨¡å—    â”‚    æ¸²æŸ“æ¨¡å—     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Authoring (å®æ—¶åˆ›ä½œæ¨¡å—)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>








































<table><thead><tr><th>æ¨¡å—</th><th>Gradle ä¾èµ–</th><th>åŠŸèƒ½è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ink-strokes</strong></td><td><code>ink-strokes</code></td><td>å¢¨è¿¹è¾“å…¥çš„æ•°æ®ç»“æ„ä¸è¡¨ç¤º</td></tr><tr><td><strong>ink-brush</strong></td><td><code>ink-brush-compose</code></td><td>å£°æ˜å¼å®šä¹‰ç”»ç¬”é£æ ¼ï¼ˆé¢œè‰²ã€ç²—ç»†ã€ç±»å‹ï¼‰</td></tr><tr><td><strong>ink-geometry</strong></td><td><code>ink-geometry-compose</code></td><td>å‡ ä½•æ“ä½œï¼šæ“¦é™¤ã€é€‰æ‹©ã€ç¢°æ’æ£€æµ‹</td></tr><tr><td><strong>ink-rendering</strong></td><td><code>ink-rendering</code></td><td>é«˜æ•ˆæ¸²æŸ“ç¬”è§¦åˆ°å±å¹•</td></tr><tr><td><strong>ink-authoring</strong></td><td><code>ink-authoring-compose</code></td><td>å¤„ç†å®æ—¶è¾“å…¥ï¼Œç”Ÿæˆå¹³æ»‘ç¬”è§¦</td></tr><tr><td><strong>ink-storage</strong></td><td><code>ink-storage</code></td><td>ç¬”è§¦åºåˆ—åŒ–ä¸æŒä¹…åŒ–å­˜å‚¨</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-5">å¿«é€Ÿä¸Šæ‰‹</h2>
<h3 data-id="heading-6">æ·»åŠ ä¾èµ–</h3>
<p>åœ¨ <code>build.gradle.kts</code> ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">dependencies {
    <span class="hljs-keyword">val</span> ink_version = <span class="hljs-string">"1.0.0"</span>

    <span class="hljs-comment">// æ ¸å¿ƒä¾èµ–</span>
    implementation(<span class="hljs-string">"androidx.ink:ink-nativeloader:<span class="hljs-variable">$ink_version</span>"</span>)
    implementation(<span class="hljs-string">"androidx.ink:ink-strokes:<span class="hljs-variable">$ink_version</span>"</span>)
    implementation(<span class="hljs-string">"androidx.ink:ink-rendering:<span class="hljs-variable">$ink_version</span>"</span>)

    <span class="hljs-comment">// Compose é›†æˆ</span>
    implementation(<span class="hljs-string">"androidx.ink:ink-authoring-compose:<span class="hljs-variable">$ink_version</span>"</span>)
    implementation(<span class="hljs-string">"androidx.ink:ink-brush-compose:<span class="hljs-variable">$ink_version</span>"</span>)
    implementation(<span class="hljs-string">"androidx.ink:ink-geometry-compose:<span class="hljs-variable">$ink_version</span>"</span>)

    <span class="hljs-comment">// å¯é€‰ï¼šå­˜å‚¨æ”¯æŒ</span>
    implementation(<span class="hljs-string">"androidx.ink:ink-storage:<span class="hljs-variable">$ink_version</span>"</span>)
}
</code></pre>
<h3 data-id="heading-7">åˆ›å»ºç”»ç¬”</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.ink.brush.Brush
<span class="hljs-keyword">import</span> androidx.ink.brush.StockBrushes
<span class="hljs-keyword">import</span> androidx.compose.ui.graphics.Color

<span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªé»‘è‰²å‹æ„Ÿç”»ç¬”</span>
<span class="hljs-keyword">val</span> blackPen = Brush.createWithComposeColor(
    family = StockBrushes.pressurePen(),  <span class="hljs-comment">// å‹æ„Ÿç¬”</span>
    colorIntArgb = Color.Black.toArgb(),
    size = <span class="hljs-number">5f</span>,                             <span class="hljs-comment">// ç¬”è§¦ç²—ç»†</span>
    epsilon = <span class="hljs-number">0.1f</span>                         <span class="hljs-comment">// ç²¾åº¦å‚æ•°</span>
)

<span class="hljs-comment">// åˆ›å»ºè§å…‰ç¬”æ•ˆæœ</span>
<span class="hljs-keyword">val</span> highlighter = Brush.createWithComposeColor(
    family = StockBrushes.highlighter(),
    colorIntArgb = Color.Yellow.toArgb(),
    size = <span class="hljs-number">20f</span>,
    epsilon = <span class="hljs-number">0.1f</span>
)

<span class="hljs-comment">// åŸºäºç°æœ‰ç”»ç¬”ä¿®æ”¹é¢œè‰²</span>
<span class="hljs-keyword">val</span> redPen = blackPen.copyWithComposeColor(
    color = Color.Red.toArgb()
)
</code></pre>
<p><strong>StockBrushes å†…ç½®ç”»ç¬”ç±»å‹ï¼š</strong></p>
<ul>
<li><code>pressurePen()</code> - å‹æ„Ÿé’¢ç¬”</li>
<li><code>highlighter()</code> - è§å…‰ç¬”</li>
<li><code>marker()</code> - é©¬å…‹ç¬”</li>
<li><code>pressure()</code> - é€šç”¨å‹æ„Ÿç¬”</li>
</ul>
<h3 data-id="heading-8">å®ç°ç»˜å›¾ç”»å¸ƒ</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.compose.foundation.Canvas
<span class="hljs-keyword">import</span> androidx.compose.foundation.layout.Box
<span class="hljs-keyword">import</span> androidx.compose.foundation.layout.fillMaxSize
<span class="hljs-keyword">import</span> androidx.compose.runtime.*
<span class="hljs-keyword">import</span> androidx.compose.ui.Modifier
<span class="hljs-keyword">import</span> androidx.compose.ui.graphics.Matrix
<span class="hljs-keyword">import</span> androidx.ink.authoring.InProgressStrokes
<span class="hljs-keyword">import</span> androidx.ink.rendering.android.canvas.CanvasStrokeRenderer
<span class="hljs-keyword">import</span> androidx.ink.strokes.Stroke

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">InkCanvas</span><span class="hljs-params">(
    modifier: <span class="hljs-type">Modifier</span> = Modifier
)</span></span> {
    <span class="hljs-comment">// å·²å®Œæˆçš„ç¬”è§¦åˆ—è¡¨</span>
    <span class="hljs-keyword">var</span> finishedStrokes <span class="hljs-keyword">by</span> remember { mutableStateOf(listOf&lt;Stroke&gt;()) }

    <span class="hljs-comment">// å½“å‰ä½¿ç”¨çš„ç”»ç¬”</span>
    <span class="hljs-keyword">var</span> currentBrush <span class="hljs-keyword">by</span> remember { mutableStateOf(blackPen) }

    <span class="hljs-comment">// ç¬”è§¦æ¸²æŸ“å™¨</span>
    <span class="hljs-keyword">val</span> strokeRenderer = remember { CanvasStrokeRenderer.create() }

    Box(modifier = modifier.fillMaxSize()) {

        <span class="hljs-comment">// åº•å±‚ Canvasï¼šæ¸²æŸ“å·²å®Œæˆçš„"å¹²"ç¬”è§¦</span>
        Canvas(modifier = Modifier.fillMaxSize()) {
            finishedStrokes.forEach { stroke -&gt;
                strokeRenderer.draw(
                    stroke = stroke,
                    canvas = drawContext.canvas.nativeCanvas,
                    strokeToScreenTransform = Matrix()
                )
            }
        }

        <span class="hljs-comment">// é¡¶å±‚ï¼šå®æ—¶æ¸²æŸ“æ­£åœ¨ç»˜åˆ¶çš„"æ¹¿"ç¬”è§¦</span>
        InProgressStrokes(
            modifier = Modifier.fillMaxSize(),
            defaultBrush = currentBrush,
            onStrokesFinished = { newStrokes -&gt;
                <span class="hljs-comment">// å°†å®Œæˆçš„ç¬”è§¦æ·»åŠ åˆ°åˆ—è¡¨</span>
                finishedStrokes = finishedStrokes + newStrokes
            }
        )
    }
}
</code></pre>
<p><strong>å…³é”®æ¦‚å¿µï¼šæ¹¿å¢¨ä¸å¹²å¢¨</strong></p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·ç»˜åˆ¶ä¸­ â”€â”€â–º æ¹¿å¢¨ (InProgressStrokes)
                 â”‚
                 â–¼ æ‰‹æŒ‡/ç¬”æŠ¬èµ·
            å¹²å¢¨ (Canvas æ¸²æŸ“)
</code></pre>
<ul>
<li><strong>æ¹¿å¢¨ (Wet Ink)</strong>ï¼šæ­£åœ¨ç»˜åˆ¶çš„ç¬”è§¦ï¼Œç”± <code>InProgressStrokes</code> å®æ—¶æ¸²æŸ“</li>
<li><strong>å¹²å¢¨ (Dry Ink)</strong>ï¼šå·²å®Œæˆçš„ç¬”è§¦ï¼Œé€šè¿‡ <code>CanvasStrokeRenderer</code> æ¸²æŸ“åˆ° Canvas</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01e62df42d7b4da69e8b6c0eac69de39~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769129243&amp;x-signature=rqgSGIEWi8BeUi5P%2BU%2FcjfuiTMg%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-9">å®ç°æ©¡çš®æ“¦åŠŸèƒ½</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.ink.geometry.MutableVec
<span class="hljs-keyword">import</span> androidx.ink.geometry.MutableSegment
<span class="hljs-keyword">import</span> androidx.ink.geometry.MutableParallelogram
<span class="hljs-keyword">import</span> androidx.ink.geometry.AffineTransform

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Eraser</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> eraserSize: <span class="hljs-built_in">Float</span> = <span class="hljs-number">20f</span>
) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> previousPoint: MutableVec? = <span class="hljs-literal">null</span>

    <span class="hljs-comment">/**
     * æ“¦é™¤ä¸æ©¡çš®æ“¦è·¯å¾„ç›¸äº¤çš„ç¬”è§¦
     */</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">eraseAt</span><span class="hljs-params">(
        currentX: <span class="hljs-type">Float</span>,
        currentY: <span class="hljs-type">Float</span>,
        strokes: <span class="hljs-type">MutableList</span>&lt;<span class="hljs-type">Stroke</span>&gt;
    )</span></span> {
        <span class="hljs-keyword">val</span> prev = previousPoint
        previousPoint = MutableVec(currentX, currentY)

        <span class="hljs-comment">// ç¬¬ä¸€ä¸ªç‚¹ï¼Œæ— æ³•å½¢æˆçº¿æ®µ</span>
        <span class="hljs-keyword">if</span> (prev == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>

        <span class="hljs-comment">// æ„å»ºæ“¦é™¤è·¯å¾„çº¿æ®µ</span>
        <span class="hljs-keyword">val</span> segment = MutableSegment(
            prev,
            MutableVec(currentX, currentY)
        )

        <span class="hljs-comment">// åˆ›å»ºå¸¦æœ‰å®½åº¦çš„æ“¦é™¤åŒºåŸŸï¼ˆå¹³è¡Œå››è¾¹å½¢ï¼‰</span>
        <span class="hljs-keyword">val</span> eraseArea = MutableParallelogram()
            .populateFromSegmentAndPadding(segment, eraserSize / <span class="hljs-number">2</span>)

        <span class="hljs-comment">// ç§»é™¤ä¸æ“¦é™¤åŒºåŸŸç›¸äº¤çš„ç¬”è§¦</span>
        strokes.removeAll { stroke -&gt;
            stroke.shape.intersects(
                eraseArea,
                AffineTransform.IDENTITY
            )
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">reset</span><span class="hljs-params">()</span></span> {
        previousPoint = <span class="hljs-literal">null</span>
    }
}
</code></pre>
<h3 data-id="heading-10">å®Œæ•´ç¤ºä¾‹ï¼šå¸¦å·¥å…·æ çš„ç»˜å›¾åº”ç”¨</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">DrawingApp</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">var</span> strokes <span class="hljs-keyword">by</span> remember { mutableStateOf(listOf&lt;Stroke&gt;()) }
    <span class="hljs-keyword">var</span> currentTool <span class="hljs-keyword">by</span> remember { mutableStateOf(Tool.PEN) }
    <span class="hljs-keyword">var</span> brushColor <span class="hljs-keyword">by</span> remember { mutableStateOf(Color.Black) }
    <span class="hljs-keyword">var</span> brushSize <span class="hljs-keyword">by</span> remember { mutableStateOf(<span class="hljs-number">5f</span>) }

    <span class="hljs-keyword">val</span> currentBrush <span class="hljs-keyword">by</span> remember(brushColor, brushSize) {
        derivedStateOf {
            Brush.createWithComposeColor(
                family = StockBrushes.pressurePen(),
                colorIntArgb = brushColor.toArgb(),
                size = brushSize,
                epsilon = <span class="hljs-number">0.1f</span>
            )
        }
    }

    Column(modifier = Modifier.fillMaxSize()) {
        <span class="hljs-comment">// å·¥å…·æ </span>
        ToolBar(
            currentTool = currentTool,
            onToolChange = { currentTool = it },
            currentColor = brushColor,
            onColorChange = { brushColor = it },
            currentSize = brushSize,
            onSizeChange = { brushSize = it },
            onClear = { strokes = emptyList() }
        )

        <span class="hljs-comment">// ç”»å¸ƒ</span>
        Box(modifier = Modifier.weight(<span class="hljs-number">1f</span>)) {
            <span class="hljs-keyword">when</span> (currentTool) {
                Tool.PEN -&gt; {
                    InkCanvas(
                        brush = currentBrush,
                        finishedStrokes = strokes,
                        onStrokesFinished = { strokes = strokes + it }
                    )
                }
                Tool.ERASER -&gt; {
                    EraserCanvas(
                        strokes = strokes.toMutableList(),
                        onStrokesChanged = { strokes = it }
                    )
                }
            }
        }
    }
}

<span class="hljs-keyword">enum</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Tool</span> { PEN, ERASER }
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/198eab8b612d4a90a832f359ea0b0444~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6buE5p6X5pm0:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769129243&amp;x-signature=Y%2B8Lf3yhTc6pKgp8FEvEmifaSCU%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-11">è¿›é˜¶åŠŸèƒ½</h2>
<h3 data-id="heading-12">ç¬”è§¦åºåˆ—åŒ–ä¸å­˜å‚¨</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> androidx.ink.storage.StrokeEncoder
<span class="hljs-keyword">import</span> androidx.ink.storage.StrokeDecoder

<span class="hljs-comment">// åºåˆ—åŒ–ç¬”è§¦</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">saveStrokes</span><span class="hljs-params">(strokes: <span class="hljs-type">List</span>&lt;<span class="hljs-type">Stroke</span>&gt;)</span></span>: ByteArray {
    <span class="hljs-keyword">return</span> StrokeEncoder.encode(strokes)
}

<span class="hljs-comment">// ååºåˆ—åŒ–ç¬”è§¦</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadStrokes</span><span class="hljs-params">(<span class="hljs-keyword">data</span>: <span class="hljs-type">ByteArray</span>)</span></span>: List&lt;Stroke&gt; {
    <span class="hljs-keyword">return</span> StrokeDecoder.decode(<span class="hljs-keyword">data</span>)
}
</code></pre>
<h3 data-id="heading-13">è‡ªå®šä¹‰ç”»ç¬”å®¶æ—</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@OptIn(ExperimentalInkCustomBrushApi::class)</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">loadCustomBrush</span><span class="hljs-params">(context: <span class="hljs-type">Context</span>)</span></span>: BrushFamily {
    <span class="hljs-comment">// ä» raw èµ„æºåŠ è½½ gzipped protocol buffer æ ¼å¼çš„ç”»ç¬”å®šä¹‰</span>
    <span class="hljs-keyword">return</span> context.resources.openRawResource(R.raw.calligraphy).use {
        BrushFamily.decode(it)
    }
}
</code></pre>
<h3 data-id="heading-14">åæ ‡ç³»ç»Ÿè½¬æ¢</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// æ”¯æŒç”»å¸ƒç¼©æ”¾å’Œå¹³ç§»</span>
<span class="hljs-keyword">val</span> transform = Matrix().apply {
    scale(zoomLevel, zoomLevel)
    translate(offsetX, offsetY)
}

strokeRenderer.draw(
    stroke = stroke,
    canvas = canvas,
    strokeToScreenTransform = transform
)
</code></pre>
<hr/>
<h2 data-id="heading-15">æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-16">âœ… æ¨èåšæ³•</h3>
<ol>
<li><strong>åˆ†ç¦»æ¹¿å¢¨å’Œå¹²å¢¨å±‚</strong> - ä½¿ç”¨ <code>InProgressStrokes</code> å¤„ç†å®æ—¶ç»˜åˆ¶ï¼Œ<code>Canvas</code> å¤„ç†å·²å®Œæˆç¬”è§¦</li>
<li><strong>åŠæ—¶æäº¤ç¬”è§¦</strong> - åœ¨ <code>onStrokesFinished</code> å›è°ƒä¸­ç«‹å³å¤„ç†å®Œæˆçš„ç¬”è§¦</li>
<li><strong>å¤ç”¨æ¸²æŸ“å™¨</strong> - ä½¿ç”¨ <code>remember</code> ç¼“å­˜ <code>CanvasStrokeRenderer</code> å®ä¾‹</li>
<li><strong>åˆç†è®¾ç½® epsilon</strong> - ä¸€èˆ¬ 0.1f å³å¯æ»¡è¶³å¤§å¤šæ•°åœºæ™¯</li>
</ol>
<h3 data-id="heading-17">âŒ é¿å…åšæ³•</h3>
<ol>
<li>ä¸è¦åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œå¤§é‡ç¬”è§¦çš„å‡ ä½•è¿ç®—</li>
<li>ä¸è¦é¢‘ç¹åˆ›å»ºæ–°çš„ Brush å¯¹è±¡</li>
<li>ä¸è¦å¿½ç•¥åæ ‡ç³»ç»Ÿè½¬æ¢</li>
</ol>
<hr/>
<h2 data-id="heading-18">ç‰ˆæœ¬å†ç¨‹</h2>



































<table><thead><tr><th>ç‰ˆæœ¬</th><th>æ—¥æœŸ</th><th>é‡è¦æ›´æ–°</th></tr></thead><tbody><tr><td><strong>1.0.0</strong></td><td>2025.12.17</td><td>ğŸ‰ <strong>æ­£å¼ç‰ˆå‘å¸ƒ</strong></td></tr><tr><td>1.0.0-beta02</td><td>2025.11.19</td><td>è‡ªå®šä¹‰ä½å»¶è¿Ÿå½¢çŠ¶ API</td></tr><tr><td>1.0.0-alpha07</td><td>2025.10.08</td><td>è§å…‰ç¬”è‡ªé‡å å‚æ•°ã€å¹³æ»‘ç®—æ³•ä¼˜åŒ–</td></tr><tr><td>1.0.0-alpha05</td><td>2025.06.18</td><td>Compose äº’æ“ä½œæ¨¡å—</td></tr><tr><td>1.0.0-alpha01</td><td>2024.10.10</td><td>é¦–ä¸ª Alpha ç‰ˆæœ¬</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-19">æ€»ç»“</h2>
<p>Android Ink API 1.0 çš„æ­£å¼å‘å¸ƒï¼Œæ ‡å¿—ç€è§¦æ§ç¬”åº”ç”¨å¼€å‘è¿›å…¥äº†ä¸€ä¸ªæ–°æ—¶ä»£ï¼š</p>
<ul>
<li>ğŸ“‰ <strong>å¼€å‘é—¨æ§›å¤§å¹…é™ä½</strong> - æ— éœ€æ·±å…¥ç†è§£åº•å±‚æ¸²æŸ“å’Œå‡ ä½•ç®—æ³•</li>
<li>âš¡ <strong>æ€§èƒ½å¼€ç®±å³ç”¨</strong> - 4ms è¶…ä½å»¶è¿Ÿï¼Œæµç•…å¦‚çº¸</li>
<li>ğŸ§© <strong>æ¨¡å—åŒ–æŒ‰éœ€å¼•å…¥</strong> - ä»ç®€å•ç»˜å›¾åˆ°å¤æ‚ç¼–è¾‘å™¨éƒ½èƒ½æ»¡è¶³</li>
<li>ğŸ¢ <strong>ç”Ÿäº§ç¯å¢ƒéªŒè¯</strong> - Google æ ¸å¿ƒåº”ç”¨èƒŒä¹¦</li>
</ul>
<p>æ— è®ºä½ æ˜¯æƒ³å¼€å‘ç¬”è®°åº”ç”¨ã€åˆ›æ„ç»˜ç”»å·¥å…·ï¼Œè¿˜æ˜¯ä¸ºç°æœ‰åº”ç”¨æ·»åŠ æ‰¹æ³¨åŠŸèƒ½ï¼ŒInk API éƒ½æ˜¯ä½ çš„æœ€ä½³é€‰æ‹©ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯ç›‘æµ‹ç•Œé¢å†…å­˜æ³„æ¼]]></title>    <link>https://juejin.cn/post/7595755710732140559</link>    <guid>https://juejin.cn/post/7595755710732140559</guid>    <pubDate>2026-01-16T07:39:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595755710732140559" data-draft-id="7595755710732124175" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯ç›‘æµ‹ç•Œé¢å†…å­˜æ³„æ¼"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-16T07:39:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°å°å°å°å®‡"/> <meta itemprop="url" content="https://juejin.cn/user/3386151546662077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯ç›‘æµ‹ç•Œé¢å†…å­˜æ³„æ¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3386151546662077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°å°å°å°å®‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-16T07:39:35.000Z" title="Fri Jan 16 2026 07:39:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-16
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    44
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰ç«¯ç›‘æµ‹ç•Œé¢å†…å­˜æ³„æ¼é€šå¸¸åˆ†ä¸º<strong>å¼€å‘é˜¶æ®µçš„æ’æŸ¥ï¼ˆéä»£ç æ–¹æ¡ˆï¼‰<strong>å’Œ</strong>è‡ªåŠ¨åŒ–/ç”Ÿäº§ç¯å¢ƒçš„ç›‘æ§ï¼ˆä»£ç æ–¹æ¡ˆï¼‰</strong>ã€‚</p>
<p>ä»¥ä¸‹æ˜¯è¯¦ç»†çš„ä»£ç æ–¹æ¡ˆå’Œéä»£ç æ–¹æ¡ˆã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€ éä»£ç æ–¹æ¡ˆï¼ˆå¼€å‘ä¸è°ƒè¯•é˜¶æ®µï¼‰</h3>
<p>ä¸»è¦ä¾èµ–æµè§ˆå™¨è‡ªå¸¦çš„å¼€å‘è€…å·¥å…·ï¼ˆChrome DevToolsï¼‰ï¼Œè¿™æ˜¯æœ€ç›´è§‚ã€æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚</p>
<h4 data-id="heading-1">1. Performance é¢æ¿ï¼ˆå®è§‚ç›‘æµ‹ï¼‰</h4>
<p>ç”¨äºè§‚å¯Ÿå†…å­˜éšæ—¶é—´å˜åŒ–çš„è¶‹åŠ¿ã€‚</p>
<ul>
<li><strong>æ“ä½œæ­¥éª¤</strong>ï¼š
<ol>
<li>æ‰“å¼€ Chrome DevTools -&gt; <strong>Performance</strong> æ ‡ç­¾ã€‚</li>
<li>å‹¾é€‰ <strong>Memory</strong> é€‰é¡¹ã€‚</li>
<li>ç‚¹å‡»å½•åˆ¶ï¼ˆRecordï¼‰ï¼Œåœ¨é¡µé¢ä¸Šæ‰§è¡Œä¸€ç³»åˆ—æ“ä½œï¼ˆå¦‚ï¼šæ‰“å¼€å¼¹çª— -&gt; å…³é—­å¼¹çª—ï¼Œé‡å¤å¤šæ¬¡ï¼‰ã€‚</li>
<li>åœæ­¢å½•åˆ¶ã€‚</li>
</ol>
</li>
<li><strong>åˆ†æ</strong>ï¼š
<ul>
<li>æŸ¥çœ‹ <strong>JS Heap</strong> æ›²çº¿ã€‚</li>
<li><strong>æ­£å¸¸æƒ…å†µ</strong>ï¼šå†…å­˜ä¸Šå‡åï¼Œè§¦å‘ GCï¼ˆåƒåœ¾å›æ”¶ï¼‰ä¼šå›è½åˆ°åŸºå‡†çº¿ï¼ˆé”¯é½¿çŠ¶ï¼‰ã€‚</li>
<li><strong>æ³„æ¼è¿¹è±¡</strong>ï¼šå†…å­˜é˜¶æ¢¯å¼ä¸Šå‡ï¼Œæ¯æ¬¡ GC åæœ€ä½ç‚¹éƒ½æ¯”ä¸Šä¸€æ¬¡é«˜ï¼Œè¯´æ˜æœ‰å¯¹è±¡æ— æ³•è¢«å›æ”¶ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-2">2. Memory é¢æ¿ - Heap Snapshotï¼ˆå¾®è§‚å®šä½ï¼‰</h4>
<p>ç”¨äºç²¾ç¡®å®šä½æ˜¯ä»€ä¹ˆå¯¹è±¡æ³„æ¼äº†ã€‚</p>
<ul>
<li><strong>æ“ä½œæ­¥éª¤</strong>ï¼š
<ol>
<li>æ‰“å¼€ <strong>Memory</strong> æ ‡ç­¾ã€‚</li>
<li>é€‰æ‹© <strong>Heap snapshot</strong>ã€‚</li>
<li>åœ¨æ“ä½œå‰æ‹ä¸€å¼ å¿«ç…§ï¼ˆSnapshot 1ï¼‰ã€‚</li>
<li>æ‰§è¡Œæ“ä½œï¼ˆå¦‚ç»„ä»¶åŠ è½½å†å¸è½½ï¼‰ã€‚</li>
<li>å†æ‹ä¸€å¼ å¿«ç…§ï¼ˆSnapshot 2ï¼‰ã€‚</li>
</ol>
</li>
<li><strong>åˆ†æ</strong>ï¼š
<ul>
<li>åœ¨ Snapshot 2 ä¸­é€‰æ‹© <strong>Comparison</strong>ï¼ˆå¯¹æ¯”ï¼‰è§†å›¾ï¼Œå¯¹æ¯” Snapshot 1ã€‚</li>
<li>é‡ç‚¹å…³æ³¨ <strong>Detached DOM tree</strong>ï¼ˆåˆ†ç¦»çš„ DOM æ ‘ï¼‰ã€‚è¿™é€šå¸¸æ„å‘³ç€ DOM èŠ‚ç‚¹å·²ä»é¡µé¢ç§»é™¤ï¼Œä½† JS ä¸­ä»æœ‰å¼•ç”¨ï¼ˆå¦‚æœªè§£ç»‘çš„äº‹ä»¶ç›‘å¬å™¨ï¼‰ï¼Œå¯¼è‡´æ— æ³•å›æ”¶ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-3">3. Task Managerï¼ˆä»»åŠ¡ç®¡ç†å™¨ï¼‰</h4>
<ul>
<li><strong>æ“ä½œ</strong>ï¼šChrome æµè§ˆå™¨ä¸­æŒ‰ <code>Shift + Esc</code>ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šæŸ¥çœ‹å½“å‰ Tab é¡µé¢çš„æ€»ä½“å†…å­˜å ç”¨ï¼ˆMemory Footprintï¼‰ã€‚å¦‚æœé¡µé¢é™æ­¢ä¸åŠ¨ä½†æ•°å€¼æŒç»­ä¸Šæ¶¨ï¼Œè¯´æ˜å­˜åœ¨æ³„æ¼ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">äºŒã€ ä»£ç æ–¹æ¡ˆï¼ˆè‡ªåŠ¨åŒ–æµ‹è¯•ä¸çº¿ä¸Šç›‘æ§ï¼‰</h3>
<p>ä»£ç æ–¹æ¡ˆä¸»è¦ç”¨äº CI/CD æµç¨‹ä¸­çš„å›å½’æµ‹è¯•ï¼Œæˆ–ç”Ÿäº§ç¯å¢ƒçš„å¼‚å¸¸ä¸ŠæŠ¥ã€‚</p>
<h4 data-id="heading-5">1. ä½¿ç”¨ Puppeteer ç¼–å†™è‡ªåŠ¨åŒ–æ£€æµ‹è„šæœ¬</h4>
<p>è¿™æ˜¯ç›®å‰æœ€ä¸»æµçš„è‡ªåŠ¨åŒ–æ£€æµ‹æ–¹æ¡ˆã€‚é€šè¿‡æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼Œå¹¶åœ¨æ“ä½œå‰åå¼ºåˆ¶æ‰§è¡Œåƒåœ¾å›æ”¶ï¼Œå¯¹æ¯”å †å†…å­˜å¤§å°ã€‚</p>
<p><strong>å…³é”®ç‚¹</strong>ï¼šå¯åŠ¨ Chrome æ—¶éœ€è¦å¼€å¯ <code>--js-flags="--expose-gc"</code> ä»¥ä¾¿åœ¨ä»£ç ä¸­æ‰‹åŠ¨è§¦å‘ GCã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// monitor-leak.js</span>
<span class="hljs-keyword">const</span> puppeteer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'puppeteer'</span>);

(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> puppeteer.<span class="hljs-title function_">launch</span>({
    <span class="hljs-attr">headless</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// æ–¹ä¾¿è°ƒè¯•è§‚å¯Ÿ</span>
    <span class="hljs-attr">args</span>: [<span class="hljs-string">'--js-flags="--expose-gc"'</span>] <span class="hljs-comment">// å…³é”®ï¼šå…è®¸æ‰‹åŠ¨è§¦å‘åƒåœ¾å›æ”¶</span>
  });
  
  <span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">newPage</span>();
  <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">goto</span>(<span class="hljs-string">'http://localhost:8080/target-page'</span>);

  <span class="hljs-comment">// 1. è·å–åŸºå‡†å†…å­˜</span>
  <span class="hljs-keyword">await</span> page.evaluate(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">gc</span>()); <span class="hljs-comment">// å¼ºåˆ¶ GC</span>
  <span class="hljs-keyword">const</span> initialMemory = <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">metrics</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`åˆå§‹ JSHeapSize: <span class="hljs-subst">${initialMemory.JSHeapUsedSize / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>}</span> MB`</span>);

  <span class="hljs-comment">// 2. æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼ˆé‡å¤å¤šæ¬¡ä»¥æ”¾å¤§æ³„æ¼æ•ˆæœï¼‰</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
    <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">click</span>(<span class="hljs-string">'#open-dialog-btn'</span>);
    <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">waitForSelector</span>(<span class="hljs-string">'.dialog'</span>);
    <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">click</span>(<span class="hljs-string">'#close-dialog-btn'</span>);
    <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">waitForSelector</span>(<span class="hljs-string">'.dialog'</span>, { <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span> });
  }

  <span class="hljs-comment">// 3. å†æ¬¡å¼ºåˆ¶ GC å¹¶æ£€æµ‹</span>
  <span class="hljs-keyword">await</span> page.evaluate(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">gc</span>());
  <span class="hljs-keyword">const</span> finalMemory = <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">metrics</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`æ“ä½œå JSHeapSize: <span class="hljs-subst">${finalMemory.JSHeapUsedSize / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>}</span> MB`</span>);

  <span class="hljs-keyword">const</span> diff = finalMemory.<span class="hljs-property">JSHeapUsedSize</span> - initialMemory.<span class="hljs-property">JSHeapUsedSize</span>;
  
  <span class="hljs-comment">// 4. è®¾ç½®é˜ˆå€¼åˆ¤æ–­ï¼ˆä¾‹å¦‚å¢é•¿è¶…è¿‡ 1MB è§†ä¸ºæ³„æ¼ï¼‰</span>
  <span class="hljs-keyword">if</span> (diff &gt; <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`æ£€æµ‹åˆ°å†…å­˜æ³„æ¼! å¢é•¿é‡: <span class="hljs-subst">${diff / <span class="hljs-number">1024</span>}</span> KB`</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å†…å­˜ä½¿ç”¨æ­£å¸¸'</span>);
  }

  <span class="hljs-keyword">await</span> browser.<span class="hljs-title function_">close</span>();
})();
</code></pre>
<h4 data-id="heading-6">2. ç”Ÿäº§ç¯å¢ƒè¿è¡Œæ—¶ç›‘æ§ (<code>performance.memory</code>)</h4>
<p>è™½ç„¶ <code>performance.memory</code> æ˜¯éæ ‡å‡† APIï¼ˆä¸»è¦ Chrome æ”¯æŒï¼‰ï¼Œä½†å®ƒæ˜¯çº¿ä¸Šè·å–å†…å­˜æ•°æ®çš„å”¯ä¸€ä½æˆæœ¬é€”å¾„ã€‚</p>
<p>å¯ä»¥å°†å…¶å°è£…ä¸º Hook æˆ–å·¥å…·å‡½æ•°ï¼Œå®šæœŸä¸ŠæŠ¥ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * ç®€å•çš„å†…å­˜ç›‘æ§ä¸ŠæŠ¥å‡½æ•°
 * å»ºè®®åœ¨é¡µé¢ç©ºé—²æ—¶æˆ–å®šæœŸæ‰§è¡Œ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">reportMemoryUsage</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ä»… Chrome/Edge æ”¯æŒ</span>
  <span class="hljs-keyword">if</span> (performance &amp;&amp; performance.<span class="hljs-property">memory</span>) {
    <span class="hljs-keyword">const</span> {
      jsHeapSizeLimit, <span class="hljs-comment">// å†…å­˜å¤§å°é™åˆ¶</span>
      totalJSHeapSize, <span class="hljs-comment">// å¯ä½¿ç”¨çš„å†…å­˜</span>
      usedJSHeapSize   <span class="hljs-comment">// å®é™…ä½¿ç”¨çš„å†…å­˜</span>
    } = performance.<span class="hljs-property">memory</span>;

    <span class="hljs-keyword">const</span> usedMB = usedJSHeapSize / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>;
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`å½“å‰å†…å­˜ä½¿ç”¨: <span class="hljs-subst">${usedMB.toFixed(<span class="hljs-number">2</span>)}</span> MB`</span>);

    <span class="hljs-comment">// è®¾ç½®æŠ¥è­¦é˜ˆå€¼ï¼Œä¾‹å¦‚è¶…è¿‡ 50MB æˆ– å æ¯”è¿‡é«˜æ—¶ä¸ŠæŠ¥</span>
    <span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡Œçš„æ•°å€¼åŒ…å«æœªå›æ”¶çš„åƒåœ¾ï¼Œä»…ä½œè¶‹åŠ¿å‚è€ƒ</span>
    <span class="hljs-keyword">if</span> (usedMB &gt; <span class="hljs-number">50</span>) {
      <span class="hljs-comment">// sendToAnalytics({ type: 'memory_warning', value: usedMB });</span>
    }
  }
}

<span class="hljs-comment">// ç¤ºä¾‹ï¼šæ¯ 10 ç§’é‡‡æ ·ä¸€æ¬¡</span>
<span class="hljs-built_in">setInterval</span>(reportMemoryUsage, <span class="hljs-number">10000</span>);
</code></pre>
<h4 data-id="heading-7">3. ä½¿ç”¨ Meta çš„ MemLab</h4>
<p>MemLab æ˜¯ Meta (Facebook) å¼€æºçš„ä¸“é—¨ç”¨äºæŸ¥æ‰¾ JavaScript å†…å­˜æ³„æ¼çš„æ¡†æ¶ï¼Œå®ƒåŸºäº Puppeteerï¼Œä½†å°è£…äº†æ›´å®Œå–„çš„åˆ†æé€»è¾‘ï¼ˆè‡ªåŠ¨è¯†åˆ« Detached DOMï¼‰ã€‚</p>
<p><strong>å·¥ä½œæµç¨‹</strong>ï¼š</p>
<ol>
<li>å¯¼èˆªåˆ°é¡µé¢ã€‚</li>
<li>æ‰§è¡Œæ“ä½œã€‚</li>
<li>è¿”å›åˆå§‹çŠ¶æ€ã€‚</li>
<li>MemLab è‡ªåŠ¨åˆ†æå¿«ç…§å·®å¼‚ï¼Œå¯»æ‰¾æœªé‡Šæ”¾çš„å¯¹è±¡ã€‚</li>
</ol>
<p><strong>é…ç½®æ–‡ä»¶ç¤ºä¾‹ (<code>memlab-scenario.js</code>)</strong>:</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-comment">// åˆå§‹è®¿é—®åœ°å€</span>
  <span class="hljs-attr">url</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-string">'http://localhost:3000'</span>,

  <span class="hljs-comment">// äº¤äº’æ“ä½œï¼šé€šå¸¸æ˜¯è§¦å‘æ³„æ¼çš„æ“ä½œ</span>
  <span class="hljs-attr">action</span>: <span class="hljs-keyword">async</span> (page) =&gt; {
    <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">click</span>(<span class="hljs-string">'button#trigger-action'</span>);
    <span class="hljs-comment">// ç­‰å¾…æ“ä½œå®Œæˆ</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(r, <span class="hljs-number">500</span>));
  },

  <span class="hljs-comment">// å›é€€æ“ä½œï¼šè¯•å›¾è®©é¡µé¢å›åˆ°åˆå§‹çŠ¶æ€</span>
  <span class="hljs-attr">back</span>: <span class="hljs-keyword">async</span> (page) =&gt; {
    <span class="hljs-keyword">await</span> page.<span class="hljs-title function_">click</span>(<span class="hljs-string">'button#reset-state'</span>);
    <span class="hljs-comment">// ç­‰å¾…çŠ¶æ€æ¢å¤</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">r</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(r, <span class="hljs-number">500</span>));
  },

  <span class="hljs-comment">// è¿‡æ»¤è§„åˆ™ï¼šåªå…³æ³¨ç‰¹å®šçš„æ³„æ¼å¯¹è±¡ï¼ˆå¯é€‰ï¼‰</span>
  <span class="hljs-attr">leakFilter</span>: <span class="hljs-function">(<span class="hljs-params">node, snapshot, leakerRoots</span>) =&gt;</span> {
    <span class="hljs-comment">// ä¾‹å¦‚åªå…³æ³¨åˆ†ç¦»çš„ DOM å…ƒç´ </span>
    <span class="hljs-keyword">return</span> node.<span class="hljs-property">type</span> === <span class="hljs-string">'native'</span> &amp;&amp; node.<span class="hljs-property">name</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">' Detached'</span>); 
  },
};
</code></pre>
<p><em>è¿è¡Œå‘½ä»¤</em>: <code>memlab run --scenario memlab-scenario.js</code></p>
<h4 data-id="heading-8">4. ä½¿ç”¨ <code>FinalizationRegistry</code> (ç°ä»£æµè§ˆå™¨ API)</h4>
<p>ç”¨äºåœ¨å¼€å‘é˜¶æ®µé€šè¿‡ä»£ç ç²¾ç¡®ç›‘å¬æŸä¸ªå¯¹è±¡æ˜¯å¦è¢«å›æ”¶ã€‚å¦‚æœå¯¹è±¡åº”è¯¥è¢«é”€æ¯ä½†é•¿æ—¶é—´æœªæ”¶åˆ°å›è°ƒï¼Œå¯èƒ½å­˜åœ¨æ³„æ¼ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è°ƒè¯•å·¥å…·ç±»ï¼šç”¨äºç›‘æµ‹ç»„ä»¶æˆ–å¯¹è±¡æ˜¯å¦è¢«å›æ”¶</span>
<span class="hljs-keyword">const</span> registry = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FinalizationRegistry</span>(<span class="hljs-function">(<span class="hljs-params">heldValue</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ… å¯¹è±¡ [<span class="hljs-subst">${heldValue}</span>] å·²è¢«åƒåœ¾å›æ”¶`</span>);
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">observeObject</span>(<span class="hljs-params">obj, name</span>) {
  registry.<span class="hljs-title function_">register</span>(obj, name);
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ï¼ˆä¾‹å¦‚åœ¨ Vue/React ç»„ä»¶ä¸­ï¼‰</span>
<span class="hljs-comment">// mounted / useEffect:</span>
<span class="hljs-comment">// let heavyObject = { data: new Array(10000) };</span>
<span class="hljs-comment">// observeObject(heavyObject, 'MyHeavyData');</span>
<span class="hljs-comment">// heavyObject = null; // è§£é™¤å¼•ç”¨ï¼Œç†è®ºä¸Šåº”è¯¥è§¦å‘ä¸Šé¢çš„å›è°ƒ</span>
</code></pre>
<h3 data-id="heading-9">æ€»ç»“å»ºè®®</h3>
<ol>
<li><strong>æ—¥å¸¸å¼€å‘</strong>ï¼šé‡åˆ°é¡µé¢å¡é¡¿æˆ– Crashï¼Œé¦–é€‰ <strong>Chrome DevTools Memory é¢æ¿</strong> æŠ“å¿«ç…§å¯¹æ¯”ï¼Œé‡ç‚¹æŸ¥ <strong>Detached DOM</strong>ã€‚</li>
<li><strong>æŒç»­é›†æˆ</strong>ï¼šå¼•å…¥ <strong>MemLab</strong> æˆ–ç¼–å†™ <strong>Puppeteer</strong> è„šæœ¬ï¼Œé’ˆå¯¹å…³é”®æ ¸å¿ƒé“¾è·¯ï¼ˆå¦‚é•¿æ—¶é—´é©»ç•™çš„å•é¡µåº”ç”¨è·¯ç”±åˆ‡æ¢ï¼‰è¿›è¡Œå›å½’æµ‹è¯•ã€‚</li>
<li><strong>çº¿ä¸Šç›‘æ§</strong>ï¼šåˆ©ç”¨ <code>performance.memory</code> è¿›è¡Œç²—ç²’åº¦çš„è¶‹åŠ¿ç›‘æ§ï¼Œç»“åˆé”™è¯¯ç›‘æ§å¹³å°ï¼ˆå¦‚ Sentryï¼‰æ’æŸ¥ OOMï¼ˆOut of Memoryï¼‰å´©æºƒã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­ç§˜OoderAIå¤šAgentåä½œæ ¸å¿ƒï¼Sceneä¸Groupæœºåˆ¶è®©æ™ºèƒ½åä½œæ•ˆç‡ç¿»å€]]></title>    <link>https://juejin.cn/post/7595868336594632723</link>    <guid>https://juejin.cn/post/7595868336594632723</guid>    <pubDate>2026-01-17T03:21:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595868336594632723" data-draft-id="7595858760133296191" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­ç§˜OoderAIå¤šAgentåä½œæ ¸å¿ƒï¼Sceneä¸Groupæœºåˆ¶è®©æ™ºèƒ½åä½œæ•ˆç‡ç¿»å€"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-17T03:21:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OneCodeCN"/> <meta itemprop="url" content="https://juejin.cn/user/1427583415622366"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­ç§˜OoderAIå¤šAgentåä½œæ ¸å¿ƒï¼Sceneä¸Groupæœºåˆ¶è®©æ™ºèƒ½åä½œæ•ˆç‡ç¿»å€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1427583415622366/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OneCodeCN
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T03:21:24.000Z" title="Sat Jan 17 2026 03:21:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨AIæŠ€æœ¯é£é€Ÿè¿­ä»£çš„ä»Šå¤©ï¼Œå¤šAgentç³»ç»Ÿæ—©å·²ä¸æ˜¯å†·é—¨æ¦‚å¿µï¼Œè€Œæ˜¯æ”¯æ’‘å¤æ‚ä»»åŠ¡é«˜æ•ˆè½åœ°çš„æ ¸å¿ƒæ¶æ„ã€‚ä½†å¦‚ä½•è®©æµ·é‡Agentã€Skillè‡ªä¸»ç»„é˜Ÿåä½œï¼Œé¿å…â€œå„è‡ªä¸ºæˆ˜â€ï¼ŸOoderAI Agentç³»ç»Ÿç»™å‡ºäº†åˆ›æ–°ç­”æ¡ˆâ€”â€”Sceneï¼ˆåœºæ™¯ï¼‰ä¸Groupï¼ˆç»„ï¼‰æœºåˆ¶ï¼Œå ªç§°å¤§è§„æ¨¡å¤šAgentåä½œçš„â€œæ™ºèƒ½å¼•æ“â€ã€‚</p>
<p>ä»Šå¤©å°±ä»5W+Howè§’åº¦ï¼Œç”¨é€šä¿—è¯­è¨€æ‹†è§£è¿™ä¸€æ ¸å¿ƒæœºåˆ¶ï¼Œå†ç»“åˆå®æˆ˜æ¡ˆä¾‹å¸¦ä½ çœ‹æ‡‚ï¼Œå®ƒå¦‚ä½•è®©å¤šAgentåä½œä»â€œæ··ä¹±ååŒâ€å˜â€œç²¾å‡†é«˜æ•ˆâ€ï¼</p>
<h2 data-id="heading-0">å…ˆææ‡‚ï¼šSceneä¸Groupåˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</h2>
<p>å¾ˆå¤šäººè§‰å¾—å¤šAgentåä½œå¤æ‚ï¼Œæœ¬è´¨æ˜¯æ²¡ç†æ¸…â€œåä½œè¾¹ç•Œâ€å’Œâ€œæ‰§è¡Œå•å…ƒâ€ï¼Œè€ŒSceneä¸Groupæ°å¥½è§£å†³äº†è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p>
<h2 data-id="heading-1">Sceneï¼ˆåœºæ™¯ï¼‰ï¼šåä½œçš„â€œä¸Šä¸‹æ–‡èˆå°â€</h2>
<p>Sceneä¸æ˜¯å…·ä½“çš„æ‰§è¡Œç»„ä»¶ï¼Œè€Œæ˜¯ä¸ºå¤šAgentã€Skillåˆ’å®šçš„â€œåä½œèŒƒå›´â€ã€‚å®ƒå°±åƒä¸€ä¸ªå®šåˆ¶åŒ–èˆå°ï¼Œæ˜ç¡®äº†â€œåœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œè°èƒ½å‚ä¸ã€è¦åšä»€ä¹ˆã€è¦éµå®ˆä»€ä¹ˆè§„åˆ™â€ï¼Œæ¯”å¦‚â€œç³»ç»Ÿåˆå§‹åŒ–â€â€œå·¥ä½œæ—¥æŠ¥ç”Ÿæˆâ€éƒ½å±äºä¸åŒåœºæ™¯ï¼Œæ¯ä¸ªåœºæ™¯éƒ½æœ‰ä¸“å±çš„åä½œç›®æ ‡å’Œçº¦æŸã€‚</p>
<h2 data-id="heading-2">Groupï¼ˆåœºæ™¯ç»„ï¼‰ï¼šåä½œçš„â€œå®æˆ˜å°é˜Ÿâ€</h2>
<p>å¦‚æœè¯´Sceneæ˜¯èˆå°è„šæœ¬ï¼ŒGroupå°±æ˜¯æ ¹æ®è„šæœ¬ç»„å»ºçš„â€œå®æˆ˜å°é˜Ÿâ€ã€‚å®ƒæ˜¯Sceneçš„å…·ä½“è½åœ°å½¢å¼ï¼ŒåŒ…å«äº†å®é™…å‚ä¸åä½œçš„Agent/Skillåˆ—è¡¨ã€è´Ÿè´£äººå’Œç®¡ç†è§„åˆ™ï¼Œæ˜¯å¤šAgentçœŸæ­£å¼€å±•åä½œçš„æ‰§è¡Œå•å…ƒã€‚</p>
<h2 data-id="heading-3">å…³é”®è¡¥å……ï¼šSceneDeclarationï¼ˆåœºæ™¯å£°æ˜ï¼‰</h2>
<p>è¿™æ˜¯â€œå°é˜Ÿè‡ªåŠ¨ç»„å»ºâ€çš„æ ¸å¿ƒé€»è¾‘â€”â€”Skillé€šè¿‡å®ƒå£°æ˜â€œæˆ‘èƒ½æ”¯æŒå“ªä¸ªåœºæ™¯â€ï¼ŒRoute/MCPé€šè¿‡å®ƒå£°æ˜â€œæˆ‘è´Ÿè´£å“ªä¸ªåœºæ™¯â€ï¼Œç³»ç»Ÿæ®æ­¤è‡ªåŠ¨å‘ç°èµ„æºã€ç»„å»ºå›¢é˜Ÿï¼Œæ— éœ€äººå·¥é…ç½®ã€‚</p>
<h2 data-id="heading-4">ä¸¤å¤§åœºæ™¯ç±»å‹ï¼Œè¦†ç›–å…¨é“¾è·¯éœ€æ±‚</h2>
<p>OoderAIçš„åœºæ™¯ç±»å‹åˆ†ä¸¤ç±»ï¼Œä»ç³»ç»Ÿè¿ç»´åˆ°ä¸šåŠ¡è½åœ°å…¨è¦†ç›–ï¼š</p>
<ul>
<li><strong>æ ¸å¿ƒåœºæ™¯ç±»å‹</strong>ï¼šé¢å‘ç³»ç»Ÿå†…éƒ¨æ“ä½œï¼Œæ¯”å¦‚åˆå§‹åŒ–ï¼ˆinitï¼‰ã€å‡çº§ï¼ˆupgradeï¼‰ã€ç›‘æ§ï¼ˆmonitorï¼‰ã€æ•°æ®ä¼ è¾“ï¼ˆdata_transferï¼‰ç­‰ï¼Œä¿éšœç³»ç»Ÿç¨³å®šè¿è¡Œã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯ç±»å‹</strong>ï¼šé¢å‘å®é™…ä¸šåŠ¡ï¼Œæ¯”å¦‚æ™ºèƒ½å®¶å±…ï¼ˆsmartHomeï¼‰ã€æ™ºèƒ½åŠå…¬ï¼ˆsmartOfficeï¼‰ã€å·¥ä¸šè‡ªåŠ¨åŒ–ï¼ˆindustrialAutomationï¼‰ã€åº”æ€¥å“åº”ï¼ˆemergencyResponseï¼‰ç­‰ï¼Œç›´æ¥èµ‹èƒ½ä¸šåŠ¡ã€‚</li>
</ul>
<h2 data-id="heading-5">è°æ¥å‚ä¸ï¼Ÿåä½œè§’è‰²ä¸æ—¶æœºå¤§ç›˜ç‚¹</h2>
<h2 data-id="heading-6">ä¸‰å¤§æ ¸å¿ƒè§’è‰²ï¼Œåˆ†å·¥æ˜ç¡®ä¸æ··ä¹±</h2>
<ol>
<li><strong>Sceneæ‰€æœ‰è€…</strong>ï¼šåªèƒ½æ˜¯Routeæˆ–MCPï¼Œè´Ÿè´£ç®¡ç†åœºæ™¯ä¸‹æ‰€æœ‰Groupçš„ç”Ÿå‘½å‘¨æœŸï¼Œæ¥æ”¶æœ€ç»ˆåä½œç»“æœã€‚</li>
<li><strong>Skillï¼ˆæŠ€èƒ½ç»„ä»¶ï¼‰</strong> ï¼šå®é™…å¹²æ´»çš„â€œæ‰§è¡Œè€…â€ï¼Œåˆ†ä¸¤ç§è§’è‰²â€”â€”agentRouteï¼ˆèšåˆä¸­ç»§ï¼Œè´Ÿè´£ä»»åŠ¡åˆ†è§£ã€ç»“æœæ±‡æ€»ï¼‰å’ŒendAgentï¼ˆç»ˆç«¯ï¼Œè´Ÿè´£å…·ä½“å­ä»»åŠ¡æ‰§è¡Œï¼‰ã€‚</li>
<li><strong>SceneManagerï¼ˆåœºæ™¯ç®¡ç†å™¨ï¼‰</strong> ï¼šâ€œå¤§è„‘ä¸­æ¢â€ï¼Œè´Ÿè´£å¤„ç†å£°æ˜è¯·æ±‚ã€è‡ªåŠ¨åˆ›å»º/æ›´æ–°/è§£æ•£Groupã€é€šçŸ¥å„è§’è‰²çŠ¶æ€å˜æ›´ã€‚</li>
</ol>
<h2 data-id="heading-7">â° ä½•æ—¶ç”Ÿæ•ˆï¼Ÿç”Ÿå‘½å‘¨æœŸè‡ªåŠ¨è”åŠ¨</h2>
<p>æ•´ä¸ªæœºåˆ¶æ— éœ€äººå·¥å¹²é¢„ï¼Œå…¨æµç¨‹è‡ªåŠ¨è§¦å‘ï¼š</p>
<h2 data-id="heading-8">å®æˆ˜æ¡ˆä¾‹ï¼šå·¥ä½œæ—¥æŠ¥è‡ªåŠ¨ç”Ÿæˆï¼Œè§£æ”¾åŒæ‰‹ï¼</h2>
<p>å…‰è¯´ç†è®ºå¤ªæŠ½è±¡ï¼Œç»“åˆå®é™…ä¸šåŠ¡åœºæ™¯æ›´æ˜“ç†è§£ã€‚ä»¥â€œæ¯æ—¥å·¥ä½œæ—¥æŠ¥è‡ªåŠ¨ç”Ÿæˆâ€ä¸ºä¾‹ï¼Œçœ‹Sceneä¸Groupæœºåˆ¶å¦‚ä½•è½åœ°ï¼š</p>
<h2 data-id="heading-9">åœºæ™¯é…ç½®</h2>
<p>åœºæ™¯ç±»å‹ï¼šREPORTINGï¼ˆæŠ¥å‘Šç”Ÿæˆåœºæ™¯ï¼‰ï¼›æ‰€æœ‰è€…ï¼šRouteèŠ‚ç‚¹ï¼ˆroute_001ï¼‰ï¼›å‚ä¸Skillï¼š</p>
<ul>
<li>å·¥ä½œæ—¥æŠ¥Skillï¼ˆagentRouteï¼‰ï¼šæ±‡æ€»æ•°æ®ã€ç”Ÿæˆæ—¥æŠ¥ï¼›</li>
<li>OAç³»ç»ŸSkillï¼ˆendAgentï¼‰ï¼šè·å–å®¡æ‰¹æ•°æ®ï¼›</li>
<li>é¡¹ç›®ç®¡ç†Skillï¼ˆendAgentï¼‰ï¼šè·å–é¡¹ç›®è¿›åº¦ï¼›</li>
<li>é‚®ä»¶Skillï¼ˆendAgentï¼‰ï¼šå‘é€æ—¥æŠ¥é‚®ä»¶ã€‚</li>
</ul>
<h2 data-id="heading-10">æ‰§è¡Œæµç¨‹</h2>
<h2 data-id="heading-11">âœ¨ è®¾è®¡äº®ç‚¹ï¼šä¸ºä»€ä¹ˆè¿™å¥—æœºåˆ¶æ›´èƒ½æ‰“ï¼Ÿ</h2>
<p>ç›¸æ¯”ä¼ ç»Ÿå¤šAgentåä½œæ¨¡å¼ï¼ŒOoderAIçš„Sceneä¸Groupæœºåˆ¶æœ‰ä¸‰å¤§æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li><strong>è‡ªä¸»åä½œï¼Œé›¶äººå·¥å¹²é¢„</strong>ï¼šSkillè‡ªåŠ¨å£°æ˜ã€ç³»ç»Ÿè‡ªåŠ¨ç»„é˜Ÿï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®åä½œå…³ç³»ï¼Œå¤§å¹…é™ä½ç®¡ç†æˆæœ¬ï¼›</li>
<li><strong>åŠ¨æ€æ‰©å±•ï¼Œé€‚é…å˜åŒ–</strong>ï¼šSkillæ”¯æŒçƒ­æ’æ‹”ï¼Œæ–°å¢ã€ç§»é™¤éƒ½èƒ½è‡ªåŠ¨è°ƒæ•´Groupï¼Œé€‚é…ä¸šåŠ¡å’Œç³»ç»Ÿçš„åŠ¨æ€å˜åŒ–ï¼›</li>
<li><strong>ç²¾å‡†åŒ¹é…ï¼Œæ•ˆç‡æ‹‰æ»¡</strong>ï¼šæŒ‰åœºæ™¯ç»„ç»‡èµ„æºï¼Œä»»åŠ¡ä¸èƒ½åŠ›ç²¾å‡†å¯¹åº”ï¼Œå¹¶è¡Œæ‰§è¡Œ+æ•…éšœè‡ªåŠ¨åˆ‡æ¢ï¼Œèµ„æºåˆ©ç”¨ç‡å’Œé²æ£’æ€§åŒæå‡ã€‚</li>
</ul>
<h2 data-id="heading-12">æœªæ¥æ–¹å‘ï¼šè§£é”æ›´å¤šåä½œå¯èƒ½</h2>
<p>è¿™å¥—æœºåˆ¶å¹¶éç»ˆç‚¹ï¼Œæœªæ¥è¿˜å°†æŒç»­ä¼˜åŒ–å‡çº§ï¼š</p>
<ul>
<li>ä¸°å¯Œåœºæ™¯ç±»å‹ï¼šæ–°å¢é‡‘èã€åˆ¶é€ ç­‰å‚ç›´è¡Œä¸šåœºæ™¯ï¼Œæ”¯æŒè‡ªå®šä¹‰åœºæ™¯ï¼›</li>
<li>å®Œå–„Groupæœºåˆ¶ï¼šåŒä¸€åœºæ™¯æ”¯æŒå¤šGroupï¼Œå®ç°è´Ÿè½½å‡è¡¡å’Œèµ„æºéš”ç¦»ï¼›</li>
<li>è·¨åœºæ™¯åä½œï¼šæ‰“é€šä¸åŒåœºæ™¯çš„åä½œå£å’ï¼Œå®ç°æ›´å¤æ‚çš„ä¸šåŠ¡é—­ç¯ã€‚</li>
</ul>
<h2 data-id="heading-13">ç»“è¯­</h2>
<p>OoderAIçš„Sceneä¸Groupæœºåˆ¶ï¼Œæœ¬è´¨æ˜¯ä¸ºå¤šAgentåä½œæ­å»ºäº†ä¸€å¥—â€œè‡ªç»„ç»‡ã€è‡ªé€‚é…ã€é«˜æ•ˆç‡â€çš„åº•å±‚æ¡†æ¶ï¼Œè§£å†³äº†å¤§è§„æ¨¡åä½œä¸­çš„å¤æ‚æ€§ã€æ‰©å±•æ€§éš¾é¢˜ã€‚æ— è®ºæ˜¯æ™ºèƒ½å®¶å±…ã€æ™ºèƒ½åŠå…¬ï¼Œè¿˜æ˜¯å·¥ä¸šè‡ªåŠ¨åŒ–ã€æ™ºæ…§åŸå¸‚ï¼Œè¿™å¥—æœºåˆ¶éƒ½èƒ½æˆä¸ºæ ¸å¿ƒæ”¯æ’‘ã€‚</p>
<p>ä½ è§‰å¾—è¿™ç§æ™ºèƒ½åä½œæœºåˆ¶ï¼Œè¿˜èƒ½åº”ç”¨åœ¨å“ªäº›åœºæ™¯ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€è®¨è®ºï¼Œä¸€èµ·æ¢ç´¢AIåä½œçš„æ— é™å¯èƒ½ï½</p>
<p>#AIæŠ€æœ¯ #å¤šAgentç³»ç»Ÿ #æ™ºèƒ½åä½œ #OoderAI</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸‰åˆ†é’Ÿè¯´æ¸…æ¥š ReAct Agent çš„æŠ€æœ¯å®ç°]]></title>    <link>https://juejin.cn/post/7595410455223320586</link>    <guid>https://juejin.cn/post/7595410455223320586</guid>    <pubDate>2026-01-15T16:25:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595410455223320586" data-draft-id="7595410455223304202" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸‰åˆ†é’Ÿè¯´æ¸…æ¥š ReAct Agent çš„æŠ€æœ¯å®ç°"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-15T16:25:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="indieAI"/> <meta itemprop="url" content="https://juejin.cn/user/4488643649743614"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸‰åˆ†é’Ÿè¯´æ¸…æ¥š ReAct Agent çš„æŠ€æœ¯å®ç°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4488643649743614/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    indieAI
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-15T16:25:21.000Z" title="Thu Jan 15 2026 16:25:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-15
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ReAct Agent æŠ€æœ¯å®ç°ä¸»è¦ä¾èµ–äº<strong>ç²¾å¿ƒè®¾è®¡çš„ Prompt æ¨¡æ¿</strong>ã€<strong>è¾“å‡ºè§£æå™¨</strong>å’Œ<strong>æ‰§è¡Œå¾ªç¯</strong>ä¸‰å¤§æ ¸å¿ƒæœºåˆ¶ã€‚</p>
<hr/>
<h2 data-id="heading-0">1. æ ¸å¿ƒ Prompt å·¥ç¨‹</h2>
<p>LangChain ä½¿ç”¨ç‰¹å®šçš„ Prompt æ¨¡æ¿å¼•å¯¼ LLM æŒ‰ <code>Thought â†’ Action â†’ Observation</code> æ ¼å¼è¾“å‡ºï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç®€åŒ–çš„ Prompt ç»“æ„</span>
template = <span class="hljs-string">"""
ç”¨ä»¥ä¸‹å·¥å…·å›ç­”é—®é¢˜ï¼š

å·¥å…·: 
- search: æœç´¢å¼•æ“, è¾“å…¥: "æŸ¥è¯¢è¯"
- calculator: è®¡ç®—å™¨, è¾“å…¥: "ç®—å¼"

ç°åœ¨å¼€å§‹ï¼

é—®é¢˜: {input}
Thought: {agent_scratchpad}
"""</span>
</code></pre>
<p><strong>å…³é”®è®¾è®¡ï¼š</strong></p>
<ul>
<li><strong><code>agent_scratchpad</code></strong>  ï¼šå­˜å‚¨å†å² Thought-Action-Observation é“¾ï¼Œç¡®ä¿ä¸Šä¸‹æ–‡è¿ç»­</li>
<li><strong>å·¥å…·æè¿°</strong>ï¼šæ¯ä¸ªå·¥å…·éƒ½æœ‰æ ‡å‡†åŒ–æè¿°ï¼Œå¸®åŠ© LLM ç†è§£ä½•æ—¶ä½¿ç”¨</li>
<li><strong>Few-shot ç¤ºä¾‹</strong>ï¼šå†…ç½®å…¸å‹äº¤äº’æ ·ä¾‹ï¼Œæ•™ä¼š LLM è¾“å‡ºæ ¼å¼</li>
</ul>
<hr/>
<h2 data-id="heading-1">2. è¾“å‡ºè§£ææœºåˆ¶</h2>
<p>LLM è¾“å‡ºçº¯æ–‡æœ¬åï¼Œé€šè¿‡ <code>AgentOutputParser</code> è§£æç»“æ„åŒ–æ•°æ®ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># LLM è¾“å‡ºç¤ºä¾‹æ–‡æœ¬</span>
<span class="hljs-string">"""
Thought: éœ€è¦è®¡ç®— 2+2*2
Action: calculator
Action Input: "2+2*2"
"""</span>
</code></pre>
<p><strong>è§£æè¿‡ç¨‹ï¼š</strong></p>
<ol>
<li><strong>æ­£åˆ™åŒ¹é…</strong>ï¼šæå– <code>Thought:</code>/<code>Action:</code>/<code>Action Input:</code> å—</li>
<li><strong>æ ¼å¼éªŒè¯</strong>ï¼šç¡®ä¿ç¬¦åˆé¢„å®š schemaï¼Œå¦åˆ™è§¦å‘æ ¼å¼é”™è¯¯å¤„ç†</li>
<li><strong>å·¥å…·æ˜ å°„</strong>ï¼šå°† Action å­—ç¬¦ä¸²æ˜ å°„åˆ°å…·ä½“å·¥å…·å®ä¾‹</li>
</ol>
<p><strong>å…³é”®ä»£ç ï¼ˆç®€åŒ–ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ReActParser</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">parse</span>(<span class="hljs-params">self, text: <span class="hljs-built_in">str</span></span>):
        thought = re.search(<span class="hljs-string">r"Thought: (.*?)\n"</span>, text).group(<span class="hljs-number">1</span>)
        action = re.search(<span class="hljs-string">r"Action: (.*?)\n"</span>, text).group(<span class="hljs-number">1</span>)
        action_input = re.search(<span class="hljs-string">r"Action Input: (.*?)\n"</span>, text).group(<span class="hljs-number">1</span>)
        <span class="hljs-keyword">return</span> AgentAction(tool=action, <span class="hljs-built_in">input</span>=action_input, log=thought)
</code></pre>
<hr/>
<h2 data-id="heading-2">3. AgentExecutor å¾ªç¯æ§åˆ¶</h2>
<p>è¿™æ˜¯ ReAct çš„"å¤§è„‘"ï¼Œç®¡ç†æ•´ä¸ªæ‰§è¡Œæµç¨‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AgentExecutor</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, query</span>):
        <span class="hljs-comment"># åˆå§‹åŒ–</span>
        scratchpad = <span class="hljs-string">""</span>  <span class="hljs-comment"># äº¤äº’å†å²</span>
        steps = <span class="hljs-number">0</span>
        
        <span class="hljs-keyword">while</span> steps &lt; max_iterations:
            <span class="hljs-comment"># 1. è°ƒç”¨ LLM ç”Ÿæˆä¸‹ä¸€æ­¥</span>
            llm_output = self.llm(
                prompt.<span class="hljs-built_in">format</span>(<span class="hljs-built_in">input</span>=query, agent_scratchpad=scratchpad)
            )
            
            <span class="hljs-comment"># 2. è§£æè¾“å‡º</span>
            action = self.output_parser(llm_output)
            
            <span class="hljs-comment"># 3. åˆ¤æ–­ç»ˆæ­¢æ¡ä»¶</span>
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(action, AgentFinish):
                <span class="hljs-keyword">return</span> action.return_values[<span class="hljs-string">"output"</span>]
            
            <span class="hljs-comment"># 4. æ‰§è¡Œå·¥å…·</span>
            observation = self.tools[action.tool].run(action.<span class="hljs-built_in">input</span>)
            
            <span class="hljs-comment"># 5. æ›´æ–° scratchpad</span>
            scratchpad += <span class="hljs-string">f"<span class="hljs-subst">{action.log}</span>\nObservation: <span class="hljs-subst">{observation}</span>\nThought: "</span>
            
            steps += <span class="hljs-number">1</span>
        
        <span class="hljs-keyword">return</span> <span class="hljs-string">"è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°"</span>
</code></pre>
<p><strong>å…³é”®è®¾è®¡æ¨¡å¼ï¼š</strong></p>
<ul>
<li><strong>while å¾ªç¯</strong>  ï¼šå®ç° Thought-Action-Observation å¾ªç¯</li>
<li><strong>scratchpad ç´¯ç§¯</strong>ï¼šå°†æ¯è½®ç»“æœè¿½åŠ ï¼Œå½¢æˆå®Œæ•´ä¸Šä¸‹æ–‡</li>
<li><strong>ç»ˆæ­¢åˆ¤æ–­</strong>ï¼šå½“è§£æå‡º <code>AgentFinish</code> æ—¶è¿”å›æœ€ç»ˆç»“æœ</li>
</ul>
<hr/>
<h2 data-id="heading-3">4. å·¥å…·è°ƒç”¨æ¶æ„</h2>
<p>å·¥å…·é€šè¿‡æ ‡å‡†åŒ–æ¥å£é›†æˆï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseTool</span>:
    name: <span class="hljs-built_in">str</span>  <span class="hljs-comment"># å·¥å…·å”¯ä¸€æ ‡è¯†</span>
    description: <span class="hljs-built_in">str</span>  <span class="hljs-comment"># ç»™ LLM çœ‹çš„è¯´æ˜</span>
    args_schema: BaseModel  <span class="hljs-comment"># å‚æ•°ç»“æ„</span>
    
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_run</span>(<span class="hljs-params">self, <span class="hljs-built_in">input</span>: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-comment"># å…·ä½“å®ç°</span>
        <span class="hljs-keyword">pass</span>
</code></pre>
<p><strong>åŠ¨æ€æ³¨å†Œæœºåˆ¶ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å·¥å…·è‡ªåŠ¨å‘ç°</span>
tools = [
    Tool(name=<span class="hljs-string">"search"</span>, func=search_api, description=<span class="hljs-string">"æœç´¢å¼•æ“..."</span>),
    Tool(name=<span class="hljs-string">"calculator"</span>, func=calculate, description=<span class="hljs-string">"è®¡ç®—å™¨..."</span>)
]

<span class="hljs-comment"># ä¼ é€’ç»™ Agent</span>
agent = create_react_agent(llm, tools, prompt)
</code></pre>
<hr/>
<h2 data-id="heading-4">5. é”™è¯¯å¤„ç†ä¸é²æ£’æ€§</h2>
<p><strong>å¸¸è§é”™è¯¯ç±»å‹ï¼š</strong></p>
<ul>
<li><strong>æ ¼å¼é”™è¯¯</strong>ï¼šLLM æœªæŒ‰æŒ‡å®šæ ¼å¼è¾“å‡º â†’ æ•è·å¼‚å¸¸å¹¶é‡æ–°æç¤º</li>
<li><strong>å·¥å…·ä¸å­˜åœ¨</strong>ï¼šLLM å¹»æƒ³äº†ä¸å­˜åœ¨çš„å·¥å…· â†’ è¿”å›é”™è¯¯ Observation</li>
<li><strong>å‚æ•°é”™è¯¯</strong>ï¼šå·¥å…·è°ƒç”¨å‚æ•°æ ¼å¼ä¸å¯¹ â†’ æ•è·å¼‚å¸¸å¹¶åé¦ˆ</li>
</ul>
<p><strong>è‡ªæˆ‘ä¿®å¤æœºåˆ¶ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">except</span> OutputParserException:
    <span class="hljs-comment"># å°†é”™è¯¯ä¿¡æ¯åŠ å…¥ scratchpadï¼Œè®© LLM è‡ªæˆ‘çº æ­£</span>
    scratchpad += <span class="hljs-string">f"è§£æé”™è¯¯ï¼Œè¯·ä¸¥æ ¼éµå¾ªæ ¼å¼ï¼šAction: tool_name\nAction Input: input\n"</span>
    <span class="hljs-keyword">continue</span>  <span class="hljs-comment"># é‡æ–°å¾ªç¯</span>
</code></pre>
<hr/>
<h2 data-id="heading-5">6. è®°å¿†ç®¡ç†</h2>
<p>ReAct Agent çš„è®°å¿†ä½“ç°åœ¨ä¸¤ä¸ªå±‚é¢ï¼š</p>
<p><strong>çŸ­æœŸè®°å¿†ï¼ˆæ ¸å¿ƒï¼‰ï¼š</strong></p>
<ul>
<li><code>agent_scratchpad</code>ï¼šå½“å‰ä»»åŠ¡çš„äº¤äº’å†å²</li>
<li>æ¯è½®å¾ªç¯è‡ªåŠ¨æ¸…ç©ºï¼Œä»»åŠ¡ç»“æŸå³ä¸¢å¼ƒ</li>
</ul>
<p><strong>é•¿æœŸè®°å¿†ï¼ˆå¯é€‰ï¼‰ï¼š</strong></p>
<ul>
<li>é›†æˆ <code>ConversationBufferMemory</code> å®ç°å¤šè½®å¯¹è¯</li>
<li>åœ¨ Prompt ä¸­æ³¨å…¥å†å²å¯¹è¯æ‘˜è¦</li>
</ul>
<hr/>
<h2 data-id="heading-6">æŠ€æœ¯å®ç°æ€»ç»“</h2>



































<table><thead><tr><th>ç»„ä»¶</th><th>å®ç°æ–¹å¼</th><th>å…³é”®æŠ€æœ¯</th></tr></thead><tbody><tr><td><strong>æ¨ç†ç”Ÿæˆ</strong></td><td>Prompt Engineering + LLM è°ƒç”¨</td><td>Few-shotã€Scratchpad</td></tr><tr><td><strong>è¡ŒåŠ¨è§£æ</strong></td><td>æ­£åˆ™/ç»“æ„åŒ–è¾“å‡ºè§£æ</td><td>Pydanticã€OutputParser</td></tr><tr><td><strong>å·¥å…·æ‰§è¡Œ</strong></td><td>æ ‡å‡†åŒ–æ¥å£ + åŠ¨æ€è°ƒç”¨</td><td>BaseToolã€å›è°ƒæœºåˆ¶</td></tr><tr><td><strong>å¾ªç¯æ§åˆ¶</strong></td><td>While å¾ªç¯ + çŠ¶æ€æœº</td><td>AgentExecutorã€ç»ˆæ­¢åˆ¤æ–­</td></tr><tr><td><strong>é”™è¯¯æ¢å¤</strong></td><td>å¼‚å¸¸æ•è· + ä¸Šä¸‹æ–‡åé¦ˆ</td><td>Try-Exceptã€è‡ªæˆ‘ä¿®å¤</td></tr></tbody></table>
<p>è¿™ç§è®¾è®¡å°†<strong>ç¡®å®šæ€§ä»£ç é€»è¾‘</strong>ï¼ˆå¾ªç¯ã€è§£æï¼‰ä¸<strong>éç¡®å®šæ€§ LLM ç”Ÿæˆ</strong>å®Œç¾ç»“åˆï¼Œæ—¢ä¿è¯äº†æµç¨‹å¯æ§ï¼Œåˆå……åˆ†å‘æŒ¥äº† LLM çš„çµæ´»æ€§ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é€šè¿‡è‹±ä¼Ÿè¾¾å¹³å°å…è´¹è°ƒç”¨ GLM4.7 æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7595871887000485888</link>    <guid>https://juejin.cn/post/7595871887000485888</guid>    <pubDate>2026-01-17T03:39:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595871887000485888" data-draft-id="7595871887000453120" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é€šè¿‡è‹±ä¼Ÿè¾¾å¹³å°å…è´¹è°ƒç”¨ GLM4.7 æ•™ç¨‹"/> <meta itemprop="keywords" content="åç«¯,å‰ç«¯,LLM"/> <meta itemprop="datePublished" content="2026-01-17T03:39:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­æ´‹"/> <meta itemprop="url" content="https://juejin.cn/user/1099167359835015"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é€šè¿‡è‹±ä¼Ÿè¾¾å¹³å°å…è´¹è°ƒç”¨ GLM4.7 æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1099167359835015/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­æ´‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T03:39:36.000Z" title="Sat Jan 17 2026 03:39:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{font-family:-apple-system,BlinkMacSystemFont,PingFang SC,Helvetica Neue,Helvetica,Arial,sans-serif;word-break:break-word;line-height:1.75;font-weight:200;font-size:16px;overflow-x:hidden;color:#666;letter-spacing:.5px}.markdown-body a{text-decoration:none;color:#0064c8;position:relative}.markdown-body a:after{content:"";position:absolute;bottom:-2px;left:0;width:100%;height:1px;background-color:rgba(0,100,200,.7);transform:scale(0);transition:all .4s ease-in-out}.markdown-body a:link:hover:after{transform:scale(1)}.markdown-body code{padding:2px 4px;font-size:.9em;font-family:Menlo,Monaco,Consolas,Courier New,monospace;border-radius:2px;background-color:rgba(0,46,70,.0431);color:#39f}.markdown-body strong{font-weight:400}.markdown-body em{color:#ff6a00}.markdown-body del,.markdown-body s{color:#bbb}.markdown-body small{font-size:.8em;color:#bbb}.markdown-body kbd{margin:0 .1em;padding:5px 8px 3px;border:1px solid #d1d5d9;border-radius:3px;box-shadow:0 1px 0 0 #e3e4e6,inset 0 0 0 2px #fff;background-color:#eee;font-weight:600;font-size:.8em;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;white-space:nowrap;color:#666}.markdown-body kbd:first-child{margin-left:0}.markdown-body kbd:last-child{margin-right:0}.markdown-body img{display:block;border:0;max-width:calc(100% - 20px);min-width:20px;min-height:20px;margin:0 10px;box-shadow:0 2px 8px 2px rgba(0,0,0,.2);transition:all .25s ease-in-out}.markdown-body img:hover{transform:translateY(-4px)}.markdown-body blockquote,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{line-height:inherit;font-size:inherit;color:inherit}.markdown-body blockquote:first-child,.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child,.markdown-body ol:first-child,.markdown-body p:first-child,.markdown-body pre:first-child,.markdown-body table:first-child,.markdown-body ul:first-child{margin-top:0}.markdown-body blockquote:last-child,.markdown-body h1:last-child,.markdown-body h2:last-child,.markdown-body h3:last-child,.markdown-body h4:last-child,.markdown-body h5:last-child,.markdown-body h6:last-child,.markdown-body ol:last-child,.markdown-body p:last-child,.markdown-body pre:last-child,.markdown-body table:last-child,.markdown-body ul:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:1.6em 0 .6em;color:#333;font-weight:400;position:relative}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{position:absolute;left:-2em}.markdown-body h1{font-size:1.75em}.markdown-body h1:before{content:"#"}.markdown-body h1:first-child{margin-top:0}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.35em}.markdown-body h4{font-size:1.2em}.markdown-body h5{font-size:1.1em}.markdown-body h6{font-size:1em}.markdown-body blockquote,.markdown-body ol,.markdown-body pre,.markdown-body table,.markdown-body ul{margin:1em 0}.markdown-body p{margin:.7em 0;word-break:break-word}.markdown-body pre{padding:8px 12px;color:#666;background-color:rgba(0,46,70,.0431);border:1px solid #ebebeb;tab-size:4;white-space:pre-wrap;line-height:1.4}.markdown-body pre code{color:inherit;background-color:transparent;padding:0}.markdown-body ol,.markdown-body ul{margin:1em 0 1em 2em;padding:0;line-height:1.5!important;font-size:inherit;color:inherit}.markdown-body ol:first-child,.markdown-body ul:first-child{margin-top:0}.markdown-body ol:last-child,.markdown-body ul:last-child{margin-bottom:0}.markdown-body ol li,.markdown-body ul li{margin:.5em 0;list-style:inherit}.markdown-body ul{list-style:disc outside}.markdown-body ul ul{list-style-type:circle}.markdown-body ul ul ul{list-style-type:square}.markdown-body ol{list-style:decimal outside}.markdown-body ol ol{list-style-type:lower-alpha}.markdown-body ol ol ol{list-style-type:lower-roman}.markdown-body blockquote{font-size:.9em;padding:8px 20px 8px 15px;color:#666;border-left:5px solid rgba(0,100,200,.7);background-color:rgba(0,100,200,.1)}.markdown-body table{border-collapse:collapse;border-spacing:0;max-width:100%;min-width:50%;word-wrap:break-word;color:inherit}.markdown-body table thead tr{background-color:#f4f6f7}.markdown-body table td,.markdown-body table th{padding:4px 16px;font-size:.95em;text-align:left;color:inherit;border:0;min-width:72px}.markdown-body table td[align=center],.markdown-body table th[align=center]{text-align:center}.markdown-body table td[align=right],.markdown-body table th[align=right]{text-align:right}.markdown-body table th{border-bottom:2px solid #e3e4e6;color:#333;font-weight:400;white-space:nowrap}.markdown-body table td{border-bottom:1px solid #ebebeb}.markdown-body hr{margin:1.5em 0;padding:0;border:0;background:linear-gradient(90deg,rgba(0,46,70,.0431),#ebebeb 50%,rgba(0,46,70,.0431));height:1px}.markdown-body br{content:"";display:block}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘åœ¨æŠ˜è…¾ AI Agent å’Œæ¨¡å‹æ¥å…¥ç›¸å…³çš„äº‹æƒ…æ—¶ï¼Œæ„å¤–å‘ç°è‹±ä¼Ÿè¾¾å±…ç„¶æä¾›äº†ä¸€ä¸ª<strong>é¢å‘å¼€å‘è€…ã€å¯ä»¥å…è´¹è°ƒç”¨æ¨¡å‹ API çš„å¹³å°</strong>ã€‚æ›´å…³é”®çš„æ˜¯ï¼Œè¿™ä¸ªå¹³å°ä¸Šä¸ä»…èƒ½ç”¨åˆ°ä¸€äº›ä¸»æµå¼€æºæ¨¡å‹ï¼Œè¿˜èƒ½ç›´æ¥ä½¿ç”¨æœ€è¿‘çƒ­åº¦å¾ˆé«˜ï¼Œå·ç§°å¼€æº Coding èƒ½åŠ›æœ€å¼ºçš„ <strong>GLM4.7</strong>ï¼Œä»¥åŠç»¼åˆè¡¨ç°ç›¸å½“ç¨³çš„ <strong>minimax-m2.1</strong>ã€‚</p>
<p>è¯´å®è¯ï¼Œåœ¨å¦‚ä»Š API å‡ ä¹å…¨é¢ token è®¡è´¹ã€éšä¾¿ä¸€ä¸ªå¤æ‚ä»»åŠ¡å°±è½»æ¾å‡ åä¸‡ç”šè‡³ä¸Šç™¾ä¸‡ token çš„èƒŒæ™¯ä¸‹ï¼Œè¿™ç§å¯ä»¥æ­£ç»åšå¼€å‘å®éªŒã€ä¸ç”¨ä¸€ä¸Šæ¥å°±çƒ§é’±çš„å¹³å°ï¼Œå¯¹ä¸ªäººå¼€å‘è€…å’Œå­¦ä¹ é˜¶æ®µçš„äººæ¥è¯´éå¸¸å‹å¥½ã€‚æ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¸»è¦åšä¸‰ä»¶äº‹ï¼š</p>
<ul>
<li>ä»‹ç» NVIDIA Build å¹³å°æœ¬èº«èƒ½åšä»€ä¹ˆ</li>
<li>è®°å½•ä»æ³¨å†Œåˆ°å®é™…è°ƒç”¨ API çš„å®Œæ•´æµç¨‹</li>
<li>åˆ†äº«ä¸€æ®µçœŸå®ä½¿ç”¨ä¸‹æ¥çš„æ¨¡å‹ä½“éªŒä¸é™åˆ¶</li>
</ul>
<p>æ•´ä½“åå®è·µï¼Œç»“è®ºä¹Ÿä¼šå°½é‡åŸºäºå®é™…ä½¿ç”¨æƒ…å†µå±•å¼€ã€‚</p>
<h2 data-id="heading-1">NVIDIA Build æ¨¡å‹å¹³å°</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fbuild.nvidia.com%2F" target="_blank" title="https://build.nvidia.com/" ref="nofollow noopener noreferrer">NVIDIA Build</a>å¯ä»¥ç†è§£ä¸ºè‹±ä¼Ÿè¾¾å®˜æ–¹æä¾›çš„ä¸€ä¸ªæ¨¡å‹é›†æˆä¸è°ƒè¯•å¹³å°ã€‚å¹³å°ä¸Šå·²ç»éƒ¨ç½²äº†å¤§é‡æ¨¡å‹ï¼Œæ¶µç›–æ–‡ç”Ÿæ–‡ï¼ˆChat / Reasoning / Codingï¼‰ã€æ–‡ç”Ÿå›¾ / å›¾ç”Ÿæ–‡ã€è¯­éŸ³ç›¸å…³ç­‰æ¨¡å‹ã€‚ç›®å‰å¹³å°ä¸Šå¯è§çš„æ¨¡å‹æ•°é‡åœ¨ 200+ï¼ŒåŸºæœ¬è¦†ç›–äº†å¸‚é¢ä¸Šä¸»æµçš„å¼€æºæ¨¡å‹ç”Ÿæ€ï¼Œä¾‹å¦‚ï¼š<code>deepseek-R1 / deepseek-v3.x</code>ã€<code>qwen3 / qwen-coder</code>ã€<code>kimi-k2</code>ã€<code>minimax-m2.1</code>ã€<code>z-ai/glm4.7</code>ï¼Œå¹³å°æœ¬èº«è¿˜æä¾›äº†åœ¨çº¿ Playgroundï¼ˆæ”¯æŒå‚æ•°è°ƒèŠ‚ã€tools è°ƒç”¨ï¼‰ã€OpenAI é£æ ¼çš„ API æ¥å£ã€æ¨¡å‹ç¤ºä¾‹ä»£ç ä¸€é”®ç”Ÿæˆç­‰èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-2">æ³¨å†Œè´¦å·ä¸ API Key ç”³è¯·</h2>
<h3 data-id="heading-3">è´¦å·æ³¨å†Œè¯´æ˜</h3>
<p>æ³¨æ„ï¼š<strong>ç–‘ä¼¼å› ä¸ºè¿‘æœŸæ³¨å†Œç”¨æˆ·æ¿€å¢ï¼Œæ–°è´¦å·å­˜åœ¨ä¸€å®šæ¦‚ç‡æ— æ³•æ­£å¸¸ç”³è¯· API Key</strong> çš„é—®é¢˜ã€‚åœ¨ä¸å½±å“è´¦å·åˆè§„æ€§çš„å‰æä¸‹ï¼Œæ¯”è¾ƒç¨³å¦¥çš„åšæ³•æ˜¯ä½¿ç”¨<strong>éå›½å†…å¸¸è§çš„é‚®ç®±</strong>æ³¨å†Œï¼Œä¾‹å¦‚ç›¸å¯¹å°‘è§çš„é‚®ç®±ï¼ˆyeah.netï¼‰ï¼Œæˆ–å›½å¤–é‚®ç®±(gmail.com)ç­‰ï¼Œä»¥åŠæ³¨å†Œæ—¶ä½¿ç”¨æµè§ˆå™¨æ— ç—•çª—å£ï¼Œé¿å…å†å²çŠ¶æ€å¹²æ‰°ã€‚</p>
<h3 data-id="heading-4">åˆ›å»ºè´¦å·</h3>
<p>è®¿é—®ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fbuild.nvidia.com%2F" target="_blank" title="https://build.nvidia.com/" ref="nofollow noopener noreferrer">build.nvidia.com/</a> ï¼Œç‚¹å‡»å·¦ä¸Šè§’ <strong>Login</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b103bcb121e4b92997716e42efea20a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=Brr8okxw7rTPyJBuWG%2FgkoEAx6U%3D" alt="" loading="lazy"/></p>
<p>åœ¨å¼¹çª—ä¸­è¾“å…¥é‚®ç®±å¹¶ç‚¹å‡» <strong>Next</strong>ï¼Œéšåå¡«å†™æ³¨å†Œä¿¡æ¯å¹¶å®ŒæˆäººæœºéªŒè¯ã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼šåœ¨â€œæ›´å¤šæ³¨å†Œé€‰é¡¹â€ä¸­å¯ä»¥çœ‹åˆ° QQã€å¾®ä¿¡ç­‰æ–¹å¼ï¼Œä½†<strong>ä¸å»ºè®®ä½¿ç”¨ç¬¬ä¸‰æ–¹å¿«æ·ç™»å½•</strong>ã€‚åœ¨å½“å‰é˜¶æ®µï¼Œä½¿ç”¨è¿™äº›æ–¹å¼æ³¨å†Œåï¼Œè´¦å·æ›´å®¹æ˜“å‡ºç° API æƒé™å—é™çš„æƒ…å†µã€‚</p>
<p>å®Œæˆæ³¨å†Œåï¼Œä¼šè¿›å…¥ä¸€äº›åä¸ªæ€§åŒ–è®¾ç½®çš„æ­¥éª¤ï¼ˆä¾‹å¦‚åç§°ã€åå¥½é€‰é¡¹ï¼‰ï¼ŒæŒ‰éœ€å¡«å†™å³å¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/65ef4933fe0c4f3784e1a3fc197933f3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=5%2FwfX9tui9SraYNTg4Hupff42tg%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœè´¦å·çŠ¶æ€æ­£å¸¸ï¼Œç¨ç­‰ç‰‡åˆ»åï¼Œé¡µé¢é¡¶éƒ¨ä¼šå‡ºç°æç¤ºï¼š</p>
<blockquote>
<p>Please verify your account to get API access</p>
</blockquote>
<p>ç‚¹å‡»å³ä¸Šè§’çš„ <strong>Verify</strong> è¿›å…¥éªŒè¯æµç¨‹ã€‚</p>
<h3 data-id="heading-5">æ‰‹æœºå·éªŒè¯</h3>
<p>åœ¨éªŒè¯å¼¹çª—ä¸­ï¼Œå°†é»˜è®¤çš„ <code>+1</code> ä¿®æ”¹ä¸º <code>+86</code>ï¼Œè¾“å…¥å›½å†…æ‰‹æœºå·å³å¯ã€‚è¿™é‡Œä¸éœ€è¦åˆ»æ„è§„é¿ï¼Œ<strong>å›½å†…æ‰‹æœºå·æ˜¯å¯ä»¥æ­£å¸¸é€šè¿‡éªŒè¯çš„</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad2356a45e9f4c0dbd306d690845649e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=%2BtMj0ainuJj%2BdRZXg%2BRfwtRcU%2BU%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡» <strong>Send Code via SMS</strong>ï¼Œå®ŒæˆéªŒè¯ç éªŒè¯ã€‚</p>
<h3 data-id="heading-6">åˆ›å»º API Key</h3>
<p>éªŒè¯å®Œæˆåï¼Œç‚¹å‡»å³ä¸Šè§’å¤´åƒï¼Œè¿›å…¥ <strong>API Keys</strong> ç®¡ç†é¡µé¢ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fc4c0fd35017478dadf4084d4ba3b368~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=HpeZQD5fYUs0tU7kdbSKdl%2FxAi0%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœè´¦å·çŠ¶æ€æ­£å¸¸ï¼Œè¿™é‡Œå¯ä»¥çœ‹åˆ° <strong>Generate API Key</strong> æŒ‰é’®ã€‚</p>
<p>ç‚¹å‡»åï¼Œè¾“å…¥ä¸€ä¸ª Key åç§°ï¼ˆä»…ç”¨äºåŒºåˆ†ï¼‰ï¼Œè¿‡æœŸæ—¶é—´é€‰æ‹© <strong>Never Expire</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a3dbc4603fc460bbd06523eb6266437~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=mcBGpsr5tERRwoDYCs2tOD8%2FPUc%3D" alt="" loading="lazy"/></p>
<p>ç”Ÿæˆå®Œæˆåï¼Œå¤åˆ¶å¹¶å¦¥å–„ä¿å­˜è¯¥ API Keyï¼Œåç»­è°ƒç”¨åªä¼šå±•ç¤ºä¸€æ¬¡ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8ed4634695a840cfa43ead7232ca0898~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=AorWlJIijrbuopJpK6Mmit1TCMI%3D" alt="" loading="lazy"/></p>
<p>å¦‚æœåœ¨ API Keys é¡µé¢<strong>å®Œå…¨çœ‹ä¸åˆ°ç”ŸæˆæŒ‰é’®</strong>ï¼Œè€Œæ˜¯ç±»ä¼¼ä¸‹å›¾æ‰€ç¤ºçš„æç¤ºç•Œé¢ï¼ŒåŸºæœ¬å¯ä»¥ç¡®è®¤è¯¥è´¦å·å½“å‰æ— æ³•ä½¿ç”¨ API åŠŸèƒ½ï¼Œå»ºè®®æ›´æ¢è´¦å·é‡æ–°æ³¨å†Œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e0da567adbd84ab9ba70b7b921e16552~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=ItiBjLzZVfYd1TJrTNYk%2FIpLL3Q%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-7">ä½¿ç”¨ API Key è°ƒç”¨</h2>
<h3 data-id="heading-8">æœ¬åœ°å®¢æˆ·ç«¯é…ç½®</h3>
<p>åªè¦æ˜¯æ”¯æŒ OpenAI é£æ ¼æ¥å£çš„å®¢æˆ·ç«¯åŸºæœ¬éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œæˆ‘è¿™é‡Œä»¥ <strong>Jan</strong> ä¸ºä¾‹ã€‚</p>
<p>è¿›å…¥è®¾ç½®é¡µï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„æ¨¡å‹æä¾›å•†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8a46ac9e304c4ba9945ea995c5a90e79~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=a9gOm3gYEZt7ObDaCr6Fr%2BkEVok%3D" alt="" loading="lazy"/></p>
<ul>
<li>Provider Nameï¼šè‡ªå®šä¹‰ï¼ˆä¾‹å¦‚ <code>Nvidia</code>ï¼‰</li>
<li>API Keyï¼šå¡«å†™åˆšåˆšç”Ÿæˆçš„ Key</li>
<li>Base URLï¼š<code>https://integrate.api.nvidia.com/v1</code></li>
</ul>
<p>å®Œæˆåæ·»åŠ æ¨¡å‹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/752a3fe2f9dc4913bc8412f860ad9b24~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=Q2TwhrDHPKH7Ovt0yh8yGiOfXuk%3D" alt="" loading="lazy"/></p>
<p>ä¾‹å¦‚æ·»åŠ  GLM4.7ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">z-ai/glm4.7
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4a00a548b3824ca9bb09eacfb707fc77~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=uo%2BKocP1XfEhcImWmqYTPx%2BjUtk%3D" alt="" loading="lazy"/></p>
<p>æ–°å»ºä¼šè¯å¹¶é€‰æ‹©è¯¥æ¨¡å‹åï¼Œå³å¯æ­£å¸¸å¯¹è¯ã€‚ä»ä½“æ„Ÿä¸Šçœ‹ï¼Œ<strong>åœ¨æ™®é€šå¯¹è¯åœºæ™¯ä¸‹ token è¾“å‡ºé€Ÿåº¦éå¸¸å¿«</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/22f46afcb9044b528c50531a933c40a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=DRZS7Zh9gceQF2StOqzgSvtnUDY%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-9">è·å–æ¨¡å‹åˆ—è¡¨</h3>
<p>Jan ä¹Ÿæ”¯æŒç›´æ¥è°ƒç”¨ <code>/models</code> æ¥å£è·å–æ¨¡å‹åˆ—è¡¨ï¼Œç‚¹å‡»åˆ·æ–°å³å¯è‡ªåŠ¨æ‹‰å–å¹¶æ·»åŠ ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1ad64f38967c42949440cbb5695b17ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=uIYkyjk50bwROKAgSRp9j34brQY%3D" alt="" loading="lazy"/></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li><code>/models</code> è¿”å›çš„æ˜¯å¹³å°<strong>å…¨é‡æ¨¡å‹åˆ—è¡¨</strong></li>
<li>å…¶ä¸­åŒ…å«æ–‡ç”Ÿå›¾ã€è¯­éŸ³ã€å¤šæ¨¡æ€ç­‰æ¨¡å‹</li>
<li>å¹¶éæ‰€æœ‰æ¨¡å‹éƒ½æ”¯æŒ chat / text-to-text</li>
</ul>
<p>å› æ­¤ï¼Œå¦‚æœåœ¨å®¢æˆ·ç«¯ä¸­ç›´æ¥é€‰æ‹©ä¸æ”¯æŒ chat çš„æ¨¡å‹å‘é€æ¶ˆæ¯ï¼Œä¼šç›´æ¥æŠ¥é”™ï¼Œè¿™æ˜¯<strong>æ¨¡å‹èƒ½åŠ›ä¸åŒ¹é…</strong>ï¼Œä¸æ˜¯æ¥å£é—®é¢˜ã€‚</p>
<h2 data-id="heading-10">Playground ä¸æ¨¡å‹è°ƒè¯•</h2>
<p>åœ¨ NVIDIA Build å¹³å°çš„ Models é¡µé¢ä¸­ï¼Œå¯ä»¥é€šè¿‡æœç´¢ Chat / Reasoning ç­›é€‰æ”¯æŒçš„æ¨¡å‹ï¼Œæˆ–è€…åœ¨ Playground é¡µé¢çš„å·¦ä¸Šè§’çœ‹åˆ°æ‰€æœ‰æ”¯æŒæ–‡ç”Ÿæ–‡çš„æ¨¡å‹åˆ—è¡¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9d10ecd182d4eeab24233882ee14551~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=DgA9ssgU8TjGL0vKFifuwz17PWc%3D" alt="" loading="lazy"/></p>
<p>ä»¥ <strong>kimi-k2</strong> ä¸ºä¾‹ï¼Œç‚¹å‡»æ¨¡å‹åå¯ä»¥è¿›å…¥åœ¨çº¿è°ƒè¯•ç•Œé¢ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4f18f1dbc51c4217a34d47b3bfa10b3b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=cGow3gQ2UuOeT5XdU1vVjZruuQc%3D" alt="" loading="lazy"/></p>
<ul>
<li>å·¦ä¾§ Toolsï¼šå¯å¯ç”¨æ¨¡å‹æ”¯æŒçš„å·¥å…·</li>
<li>å³ä¾§ Parametersï¼šæ§åˆ¶æ¸©åº¦ã€æœ€å¤§ token ç­‰å‚æ•°</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9332a1a84ad342dba58db1b9a75436e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=2RqsyAYXhvM6pygml%2FGuZucTS0Q%3D" alt="" loading="lazy"/></p>
<p>ç‚¹å‡»å³ä¸Šè§’ <strong>View Code</strong>ï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°å¯¹åº”çš„ API è°ƒç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ Base URLã€Model IDã€Messages ç»“æ„ç­‰ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8220aa5dd032480a92d9699a8db14b7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=EudFWnPeIR8W2nhPbf1Iz3xD4Ac%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-11">Tools è°ƒç”¨ç¤ºä¾‹</h3>
<p>åœ¨éƒ¨åˆ†æ¨¡å‹ä¸­å¯ä»¥ç›´æ¥å¯ç”¨ toolsï¼Œè¿™é‡Œä»¥ <strong>minimax-m2</strong> ä¸ºä¾‹æ¼”ç¤ºã€‚</p>
<p>å¯ç”¨ <code>get_current_weather</code> å·¥å…·åï¼Œè¯¢é—®æŸåœ°å¤©æ°”ï¼Œæ¨¡å‹ä¼šè‡ªåŠ¨è¿›è¡Œ tools è§„åˆ’ä¸è°ƒç”¨ï¼Œå¹¶è¿”å›ç»“æœã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/133238bdfa2b4e72a5ad4d294146a96f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=aS%2FT5zOLAIL3E3UFKGQtF6FLnno%3D" alt="" loading="lazy"/></p>
<p>å†æ¬¡ç‚¹å‡» <strong>View Code</strong>ï¼Œå¯ä»¥çœ‹åˆ°å®Œæ•´çš„ tools è°ƒç”¨ç¤ºä¾‹ä»£ç ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f3107e80a844ed29bbd6bbca5e2b597~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2Q5rSL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769225975&amp;x-signature=woR8GHdZKBIEqh7Xw0phKiRhJNk%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-12">æ¨¡å‹ä¸æ¥å£</h2>
<p>NVIDIA Build æä¾›çš„æ˜¯ <strong>OpenAI é£æ ¼ API</strong>ï¼Œæ¥å£å±‚é¢å…¼å®¹ <code>chat.completions</code> / <code>responses</code>ï¼Œæ˜¯å¦æ”¯æŒ <code>chat</code>ã€<code>tools</code>ã€å¤šæ¨¡æ€ï¼Œå–å†³äºæ¨¡å‹æœ¬èº«ã€‚æ‰€ä»¥ï¼Œæœ€ç¨³å¦¥çš„æ–¹å¼ä»ç„¶æ˜¯åœ¨å¹³å° Models é¡µé¢ä¸­ç­›é€‰ <code>chat</code> / <code>reasoning</code>ï¼Œå†å†³å®šæ˜¯å¦æ¥å…¥åˆ°æœ¬åœ°å®¢æˆ·ç«¯æˆ–ä»£ç ä¸­ã€‚</p>
<h2 data-id="heading-13">ä½¿ç”¨ä½“éªŒä¸é™åˆ¶</h2>
<p>è¯´ä¸€ä¸‹ <strong>GLM4.7</strong> è¿™ä¸ªæ¨¡å‹ã€‚å®ƒå¹¶ä¸æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ç”¨ï¼Œåœ¨åˆšå‘å¸ƒä¸ä¹…æ—¶æˆ‘å°±å·²ç»é€šè¿‡ä¸€äº›ç¬¬ä¸‰æ–¹ API ä¾›åº”å•†æ¥è§¦è¿‡ï¼Œè¿™æ¬¡ç®—æ˜¯ç¬¬äºŒæ¬¡è¾ƒå®Œæ•´åœ°ä½¿ç”¨ã€‚ç»¼åˆä¸¤æ¬¡å®é™…å¼€å‘ä½“éªŒï¼Œè¯´å®è¯ä½“æ„Ÿå¹¶ä¸ç®—å¥½ã€‚</p>
<p>é¦–å…ˆä¸€ä¸ªæ¯”è¾ƒæ˜æ˜¾çš„é—®é¢˜æ˜¯ï¼Œåœ¨æˆ‘ç›®å‰å¸¸ç”¨çš„æ¨¡å‹é‡Œï¼ˆæ¯”å¦‚ qwen-codeã€gpt-5.1ã€gpt-5.2ã€Claude ç­‰ï¼‰ï¼Œ<strong>åªæœ‰ GLM4.7 ä¼šåœ¨ç”Ÿæˆçš„æ–‡ä»¶å¤´éƒ¨æ’å…¥ Markdown çš„ä»£ç å—æ ‡è®°</strong>ã€‚è¿™ä¸ªé—®é¢˜åœ¨ä»£ç ç¼–è¾‘å’Œæ–‡ä»¶ç”Ÿæˆåœºæ™¯ä¸‹å°¤å…¶å½±å“ä½“éªŒï¼Œéœ€è¦é¢å¤–æ¸…ç†ï¼Œçœ‹èµ·æ¥å°±å¾ˆè ¢ã€‚</p>
<p>å…¶æ¬¡æ˜¯æ‰§è¡Œæ•ˆç‡é—®é¢˜ï¼Œè¿™ä¸€ç‚¹è®©æˆ‘æ„Ÿè§‰å¾ˆå¥‡æ€ªã€‚<strong>çº¯å¯¹è¯åœºæ™¯ä¸‹å®ƒçš„å“åº”é€Ÿåº¦æ˜¯å¾ˆå¿«çš„</strong>ï¼Œä½†ä¸€æ—¦è¿›å…¥å¹²æ´»æ¨¡å¼ï¼Œæ¯”å¦‚ç¨å¾®å¤æ‚ä¸€ç‚¹çš„ä»»åŠ¡ç¼–æ’ã€ä»£ç ä¿®æ”¹æˆ–å¤šæ­¥æ‰§è¡Œï¼Œ<strong>å•ä¸ªä»»åŠ¡å¯èƒ½ä¼šè·‘åå‡ ç”šè‡³äºŒååˆ†é’Ÿ</strong>ã€‚é—®é¢˜ä¸åœ¨äºæˆ‘ä¸èƒ½æ¥å—æ¨¡å‹æ‰§è¡Œå¤æ‚ä»»åŠ¡è€—æ—¶ï¼Œè€Œæ˜¯è¿‡ç¨‹ä¸­<strong>å¶å°”ä¼šå‡ºç°æ˜æ˜¾çš„åœé¡¿æˆ–å¡ä½ä¸€æ®µæ—¶é—´å†ç»§ç»­</strong>ï¼ŒèŠ‚å¥éå¸¸ä¸ç¨³å®šã€‚</p>
<p>ä¸€å¼€å§‹æˆ‘ä¹Ÿæ€€ç–‘æ˜¯ API è°ƒç”¨é¢‘ç‡æˆ–é™æµå¯¼è‡´çš„ï¼Œä½†åæ¥åœ¨åŒæ ·çš„å®¢æˆ·ç«¯ã€åŒæ ·çš„ä»»åŠ¡å¤æ‚åº¦ä¸‹åˆ‡æ¢åˆ° <strong>minimax-m2</strong>ï¼Œå‘ç°å¹¶ä¸æ˜¯è¿™ä¸ªåŸå› ã€‚minimax çš„æ•´ä½“æ‰§è¡ŒèŠ‚å¥è¦é¡ºç•…å¾—å¤šï¼Œè°ƒç”¨ä¹Ÿæ›´æ¿€è¿›ï¼Œç”šè‡³å¯ä»¥è½»æ¾è·‘åˆ° <strong>40 æ¬¡ / åˆ†é’Ÿ</strong> çš„å¹³å°ä¸Šé™ï¼Œå½“ç„¶ä»£ä»·å°±æ˜¯ä¸€æ—¦è§„åˆ’ç¨å¾®æ¿€è¿›ï¼Œå°±å¾ˆå®¹æ˜“ç›´æ¥æ’ä¸Šé™æµï¼Œæ¥å£æŠ¥é”™ï¼Œä»»åŠ¡ä¸­æ–­ã€‚</p>
<p>ä»å¹³å°å±‚é¢æ¥çœ‹ï¼Œè¿™ä¸ªå¹³å°æ•´ä½“ä½“éªŒå…¶å®æ˜¯<strong>éå¸¸ä¸é”™çš„</strong>ï¼šæ¨¡å‹é€‰æ‹©å¤šã€æ¥å…¥æˆæœ¬ä½ã€ç¤ºä¾‹æ¸…æ™°ï¼Œå¯¹å­¦ä¹ å’Œå®éªŒé˜¶æ®µçš„å¼€å‘è€…éå¸¸å‹å¥½ã€‚å¹³å°çš„é™åˆ¶ä¹Ÿæ¯”è¾ƒç›´è§‚æ˜ç¡®ï¼Œæ¯”å¦‚ API è°ƒç”¨é¢‘ç‡é™åˆ¶åœ¨ <strong>40 æ¬¡ / åˆ†é’Ÿ</strong>ï¼Œè¶…å‡ºåç›´æ¥è¿”å›é”™è¯¯ï¼Œè¿™ä¸€ç‚¹åœ¨ minimax-m2 ä¸Šä½“ç°å¾—å°¤ä¸ºæ˜æ˜¾ã€‚</p>
<p>å›åˆ° <strong>GLM4.7</strong> æœ¬èº«ï¼Œå®¢è§‚æ¥è¯´å®ƒçš„åŠŸèƒ½æ˜¯å®Œå…¨æ­£å¸¸çš„ï¼šå·¥å…·è°ƒç”¨æ²¡é—®é¢˜ï¼Œä»£ç ç¼–è¾‘èƒ½ç”¨ï¼Œå¯¹è¯é€Ÿåº¦ä¹Ÿå¿«ï¼Œåªæ˜¯åœ¨<strong>å¤æ‚ä»»åŠ¡æ‰§è¡Œé˜¶æ®µæ˜æ˜¾åæ…¢ï¼Œä¸”ç¨³å®šæ€§ä¸å¤Ÿå¥½</strong>ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œminimax-m2 åœ¨ç›¸åŒæ¡ä»¶ä¸‹æ‰§è¡ŒèŠ‚å¥æ›´çº¿æ€§ã€æ›´å¬è¯ï¼Œåªæ˜¯æ›´å®¹æ˜“è§¦å‘å¹³å°é™æµ <em>ï¼ˆå½“ç„¶äº†ï¼Œå› ä¸ºé¢‘ç¹è§¦å‘é™æµæ‰€ä»¥æˆ‘ä¹Ÿæ²¡æ·±åº¦ä½¿ç”¨ minimaxï¼‰</em>ã€‚</p>
<p>æ€»ç»“æ¥è¯´ï¼ŒGLM4.7 å¹¶ä¸æ˜¯ä¸èƒ½å¹²æ´»ï¼Œä½†<strong>å®é™…å¼€å‘ä½“éªŒä¸€èˆ¬</strong>ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦é•¿æ—¶é—´ã€è¿ç»­æ‰§è¡Œä»»åŠ¡çš„åœºæ™¯ä¸‹ï¼Œæ•ˆç‡å’ŒèŠ‚å¥ä¸Šçš„é—®é¢˜ä¼šè¢«æ”¾å¤§ã€‚</p>
<h2 data-id="heading-14">ç»“è¯­</h2>
<p>å®è¯è¯´ï¼Œè¿™ä¸ªå¹³å°åœ¨å½“å‰è¿™ä¸ªæ—¶é—´ç‚¹ï¼ŒçœŸçš„ç®—æ˜¯<strong>ç›¸å½“è‰¯å¿ƒçš„å­˜åœ¨</strong>ã€‚å¯¹æƒ³å­¦ä¹  AI Agentã€å·¥å…·è°ƒç”¨ã€å¤šæ¨¡å‹ç¼–æ’çš„å¼€å‘è€…æ¥è¯´ï¼Œèƒ½å¤Ÿåœ¨ä¸é¢å¤–ä»˜è´¹çš„æƒ…å†µä¸‹åå¤è¯•é”™ï¼Œæœ¬èº«å°±å¾ˆæœ‰ä»·å€¼ã€‚</p>
<p>å½“ç„¶äº†ï¼Œå¹³å°ç­–ç•¥å’Œé£æ§çŠ¶æ€å¯èƒ½éšæ—¶å˜åŒ–ï¼Œå¦‚æœåªæ˜¯æƒ³ç™½å«–ä¸€ç‚¹ä½“éªŒï¼Œå»ºè®®è¿˜æ˜¯<strong>å°½æ—©æ³¨å†Œ</strong>ï¼Œè‡³å°‘åœ¨è´¦å·çŠ¶æ€æ­£å¸¸çš„å‰æä¸‹ï¼ŒæŠŠ API Key æ‹¿åˆ°æ‰‹ã€‚</p>
<p>è‡³äºæ¨¡å‹æ€ä¹ˆé€‰ï¼Œå»ºè®®å¤šè¯•ã€å¤šå¯¹æ¯”ï¼Œåˆ«è¿·ä¿¡å•ä¸€æ¨¡å‹ã€‚èƒ½ç¨³å®šæŠŠæ´»å¹²å®Œçš„æ¨¡å‹ï¼Œæ‰æ˜¯å¥½æ¨¡å‹ã€‚</p>
<h2 data-id="heading-15">ç›¸å…³é“¾æ¥</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.pangcy.cn%2F2026%2F01%2F17%2FAI%2520%25E5%25B7%25A5%25E5%2585%25B7%25E4%25B8%258E%25E6%258A%2580%25E6%259C%25AF%2FAI%2520%25E6%258E%25A5%25E5%258F%25A3%2F%25E8%258B%25B1%25E4%25BC%259F%25E8%25BE%25BE%25E5%2585%258D%25E8%25B4%25B9%25E6%25A8%25A1%25E5%259E%258BAPI%2F" target="_blank" title="https://blog.pangcy.cn/2026/01/17/AI%20%E5%B7%A5%E5%85%B7%E4%B8%8E%E6%8A%80%E6%9C%AF/AI%20%E6%8E%A5%E5%8F%A3/%E8%8B%B1%E4%BC%9F%E8%BE%BE%E5%85%8D%E8%B4%B9%E6%A8%A1%E5%9E%8BAPI/" ref="nofollow noopener noreferrer">è‹±ä¼Ÿè¾¾å…è´¹æ¨¡å‹API</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MotionEvent]]></title>    <link>https://juejin.cn/post/7595858063502065698</link>    <guid>https://juejin.cn/post/7595858063502065698</guid>    <pubDate>2026-01-17T01:45:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7595858063502065698" data-draft-id="7595831648825557032" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MotionEvent"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-17T01:45:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XRay"/> <meta itemprop="url" content="https://juejin.cn/user/3966693685869288"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MotionEvent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3966693685869288/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XRay
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-17T01:45:47.000Z" title="Sat Jan 17 2026 01:45:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-17
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç®€ä»‹</h2>
<p>MotionEvent ç”¨äºè¡¨ç¤ºè¾“å…¥äº‹ä»¶ï¼Œæ¯”å¦‚ç”±æ‰‹æŒ‡ã€æ™ºèƒ½ç¬”ç­‰è§¦å‘çš„è¾“å…¥äº‹ä»¶ã€‚</p>
<h2 data-id="heading-1">å•ç‚¹è§¦æ§</h2>
<p>å•ä¸ªæ‰‹æŒ‡è§¦æ‘¸å±å¹•å°±æ˜¯å±äºå•ç‚¹è§¦æ§çš„èŒƒç•´ï¼Œä¸»è¦æ¶‰åŠä»¥ä¸‹å‡ ä¸ªäº‹ä»¶ï¼š</p>
<ol>
<li>ACTION_DOWNï¼Œæ‰‹æŒ‡åˆæ¬¡æ¥è§¦åˆ°å±å¹•æ—¶è§¦å‘ã€‚</li>
<li>ACTION_MOVEï¼Œæ‰‹æŒ‡åœ¨å±å¹•ä¸Šæ»‘åŠ¨æ—¶è§¦å‘ï¼Œä¸€èˆ¬ä¼šå¤šæ¬¡è§¦å‘ã€‚</li>
<li>ACTION_UPï¼Œæ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶è§¦å‘ã€‚</li>
<li>ACTION_CANCELï¼Œäº‹ä»¶è¢«ä¸Šå±‚æ‹¦æˆªæ—¶è§¦å‘ã€‚</li>
<li>ACTION_OUTSIDEï¼Œæ‰‹æŒ‡ä¸åœ¨æ§ä»¶åŒºåŸŸæ—¶è§¦å‘ã€‚</li>
</ol>
<p>ä¸»è¦æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š</p>
<ol>
<li>getAction()ï¼Œè·å–äº‹ä»¶ç±»å‹ã€‚</li>
<li>getX()ã€getY()ï¼Œè·å¾—è§¦æ‘¸ç‚¹åœ¨å½“å‰ View èŒƒå›´å†…çš„ç›¸å¯¹åæ ‡ã€‚</li>
<li>getRawX()ã€getRawY()ï¼Œè·å¾—è§¦æ‘¸ç‚¹åœ¨æ•´ä¸ªå±å¹•èŒƒå›´å†…çš„ç›¸å¯¹åæ ‡ã€‚</li>
</ol>
<p>å…¶ä¸­æœ‰ä¸¤ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„äº‹ä»¶ï¼šACTION_CANCEL å’Œ ACTION_OUTSIDEï¼Œå®ƒä»¬æ˜¯ç”±ç³»ç»Ÿè‡ªå·±å‘å‡ºæ¥çš„ã€‚</p>
<p>åœ¨ä¸Šå±‚çš„ View å›æ”¶äº‹ä»¶å¤„ç†æƒçš„æ—¶å€™ï¼Œå­ View ä¼šæ”¶åˆ° ACTION_CANCEL äº‹ä»¶ã€‚</p>
<p>æ¯”å¦‚åœ¨å‚ç›´æ–¹å‘çš„ RecyclerView ä¸­ï¼Œå¦‚æœåœ¨ Adapter ä¸­ç»™ ItemView æ·»åŠ è§¦æ‘¸äº‹ä»¶ç›‘å¬ï¼Œç„¶åä¸Šä¸‹æ»‘åŠ¨ RecyclerView ï¼ŒItemView ä¼šæ”¶åˆ° ACTION_CANCEL äº‹ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-kt" lang="kt"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAdapter</span>(<span class="hljs-keyword">var</span> mData: MutableList&lt;<span class="hljs-built_in">Int</span>&gt;): RecyclerView.Adapter&lt;MyAdapter.ViewHolder&gt;() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> TAG = MyAdapter::<span class="hljs-keyword">class</span>.java.simpleName

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreateViewHolder</span><span class="hljs-params">(parent: <span class="hljs-type">ViewGroup</span>, viewType: <span class="hljs-type">Int</span>)</span></span>: ViewHolder {
        <span class="hljs-keyword">return</span> ViewHolder(ItemMyBinding.inflate(LayoutInflater.from(parent.context), parent, <span class="hljs-literal">false</span>))
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getItemCount</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> {
        <span class="hljs-keyword">return</span> mData.size
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onBindViewHolder</span><span class="hljs-params">(holder: <span class="hljs-type">ViewHolder</span>, position: <span class="hljs-type">Int</span>)</span></span> {
        holder.binding.tvNum.text = mData[position].toString()
        <span class="hljs-comment">// ç»™ ItemView æ·»åŠ è§¦æ‘¸äº‹ä»¶ç›‘å¬</span>
        holder.binding.root.setOnTouchListener { v, event -&gt;
            Log.d(TAG, <span class="hljs-string">"itemView onTouchEvent:<span class="hljs-subst">${event?.action}</span>"</span>)
            <span class="hljs-literal">true</span>
        }
    }

    <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewHolder</span>(<span class="hljs-keyword">val</span> binding: ItemMyBinding) : RecyclerView.ViewHolder(binding.root)
}
</code></pre>
<p>è¿™é‡Œ RecyclerView ä¼šå…ˆæ”¶åˆ°äº†ä¸€ä¸ª ACTION_DOWN äº‹ä»¶ï¼Œç”±äºè¿™ä¸ªå¯èƒ½æ˜¯ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥å®ƒå…ˆä¼ é€’ç»™å¯¹åº” ItemViewï¼Œè¯¢é—® ItemView æ˜¯å¦éœ€è¦å¤„ç†è¿™ä¸ªäº‹ä»¶ï¼Œæ¥ä¸‹æ¥åˆæ”¶åˆ°ä¸€ä¸ª ACTION_MOVE äº‹ä»¶ï¼Œä¸”ç§»åŠ¨çš„æ–¹å‘å’Œ RecyclerView çš„å¯æ»‘åŠ¨æ–¹å‘ä¸€è‡´ï¼ŒRecyclerView åˆ¤æ–­è¿™ä¸ªäº‹ä»¶æ˜¯æ»šåŠ¨äº‹ä»¶ï¼Œäºæ˜¯è¦æ”¶å›äº‹ä»¶å¤„ç†æƒï¼Œè¿™æ—¶å€™å¯¹åº”çš„ ItemView ä¼šæ”¶åˆ°ä¸€ä¸ª ACTION_CANCELï¼Œå¹¶ä¸”ä¸ä¼šå†æ”¶åˆ°åç»­äº‹ä»¶äº†ã€‚</p>
<p>ACTION_OUTSIDE äº‹ä»¶ç”¨åˆ°çš„å‡ ç‡å¾ˆå°ï¼Œæœ‰å…´è¶£çš„è‡ªå·±å»ç ”ç©¶ã€‚</p>
<h2 data-id="heading-2">å¤šç‚¹è§¦æ§</h2>
<p>ä» Android 2.2 (API 8) å¼€å§‹æ”¯æŒå¤šç‚¹è§¦æ§ï¼Œå¤šç‚¹è§¦æ§ä¸»è¦æ¶‰åŠä»¥ä¸‹å‡ ä¸ªäº‹ä»¶ï¼š</p>
<ol>
<li>ACTION_DOWNï¼Œç¬¬ä¸€æ ¹æ‰‹æŒ‡åˆæ¬¡æ¥è§¦åˆ°å±å¹•æ—¶è§¦å‘ã€‚</li>
<li>ACTION_MOVEï¼Œæ‰‹æŒ‡åœ¨å±å¹•ä¸Šæ»‘åŠ¨æ—¶è§¦å‘ï¼Œä¸€èˆ¬ä¼šå¤šæ¬¡è§¦å‘ã€‚</li>
<li>ACTION_UPï¼Œæœ€åä¸€æ ¹æ‰‹æŒ‡ç¦»å¼€å±å¹•æ—¶è§¦å‘ã€‚</li>
<li>ACTION_POINTER_DOWNï¼Œæœ‰éä¸»è¦çš„æ‰‹æŒ‡æŒ‰ä¸‹ï¼ˆå³æŒ‰ä¸‹ä¹‹å‰å·²ç»æœ‰æ‰‹æŒ‡åœ¨å±å¹•ä¸Šï¼‰æ—¶è§¦å‘ã€‚</li>
<li>ACTION_POINTER_UPï¼Œæœ‰éä¸»è¦çš„æ‰‹æŒ‡æŠ¬èµ·ï¼ˆå³æŠ¬èµ·ä¹‹åä»ç„¶æœ‰æ‰‹æŒ‡åœ¨å±å¹•ä¸Šï¼‰æ—¶è§¦å‘ã€‚</li>
</ol>
<p>ä¸»è¦æ¶‰åŠä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š</p>
<ol>
<li>getActionMasked()ï¼Œä¸ getAction() ç±»ä¼¼ï¼Œå¤šç‚¹è§¦æ§å¿…é¡»ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è·å–äº‹ä»¶ç±»å‹ã€‚</li>
<li>getActionIndex()ï¼Œè·å–è¯¥äº‹ä»¶çš„ pointerIndexã€‚</li>
<li>getPointerCount()ï¼Œè·å–è§¦æ‘¸çš„ Pointerï¼ˆæ‰‹æŒ‡ï¼‰çš„ä¸ªæ•°ã€‚</li>
<li>getPointerId(int pointerIndex)ï¼Œè·å– Pointerï¼ˆæ‰‹æŒ‡ï¼‰çš„ idï¼Œç³»ç»Ÿä¼šç»™æ¯æ ¹æ‰‹æŒ‡æŒ‰ä¸‹çš„æ—¶å€™åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ idï¼ˆæŒ‰ä¸‹ä¼šè§¦å‘ ACTION_DOWN æˆ–è€… ACTION_POINTER_DOWNï¼‰ï¼Œè¿™ä¸ª id ç›´åˆ°è¯¥æ‰‹æŒ‡ç¦»å¼€å±å¹•ï¼ˆè§¦å‘ ACTION_UP æˆ–è€… ACTION_POINTER_UPï¼‰æˆ–è€…æ‰‹åŠ¿è¢« Cancelï¼ˆè§¦å‘ ACTION_CANCELï¼‰æ‰ä¼šå¤±æ•ˆã€‚</li>
<li>findPointerIndex(int pointerId)ï¼Œé€šè¿‡ pointerId è·å– pointerIndexï¼Œå¤§éƒ¨åˆ† MotionEvent ä¸­çš„æ–¹æ³•éƒ½ä½¿ç”¨ pointerIndex ä½œä¸ºå‚æ•°ï¼ŒpointerIndex çš„å€¼æœ€å°æ˜¯ 0 ï¼Œæœ€å¤§å°äº getPointerCount()ã€‚</li>
<li>getX(int pointerIndex)ã€getY(int pointerIndex)ï¼Œè·å–æŸæ ¹æ‰‹æŒ‡åœ¨å½“å‰ View èŒƒå›´å†…çš„ç›¸å¯¹åæ ‡ã€‚</li>
</ol>
<h3 data-id="heading-3">getActionMasked()</h3>
<p>å¤šæŒ‡è§¦æ‘¸å±å¹•æ—¶ï¼Œç³»ç»Ÿä¸ºäº†åŒºåˆ† Pointer çš„åŒæ—¶åŒºåˆ† äº‹ä»¶ç±»å‹ ï¼Œä½¿ç”¨äº†ä¸€ä¸ª int ç±»å‹ï¼ˆå…± 32 ä½ï¼‰æ¥åŒæ—¶è¡¨ç¤º pointerIndex å’Œ äº‹ä»¶ç±»å‹ï¼Œå…¶ä¸­æœ€ä½çš„ 8 ä½ï¼ˆ0x000000ffï¼‰è¡¨ç¤ºäº‹ä»¶ç±»å‹ï¼Œæ¬¡ä½çš„ 8 ä½ï¼ˆ0x0000ff00ï¼‰è¡¨ç¤º pointerIndexã€‚</p>
<p>è¿è¡Œå¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-kt" lang="kt"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyLinearLayout</span> <span class="hljs-meta">@JvmOverloads</span> <span class="hljs-keyword">constructor</span>(
    context: Context,
    attributeSet: AttributeSet? = <span class="hljs-literal">null</span>,
    defStyleAttr: <span class="hljs-built_in">Int</span> = <span class="hljs-number">0</span>
) : LinearLayout(context, attributeSet, defStyleAttr) {

    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> TAG = MyLinearLayout::<span class="hljs-keyword">class</span>.java.simpleName
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onInterceptTouchEvent</span><span class="hljs-params">(ev: <span class="hljs-type">MotionEvent</span>?)</span></span>: <span class="hljs-built_in">Boolean</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onTouchEvent</span><span class="hljs-params">(event: <span class="hljs-type">MotionEvent</span>?)</span></span>: <span class="hljs-built_in">Boolean</span> {
        Log.d(TAG, <span class="hljs-string">"onTouchEvent action:<span class="hljs-subst">${event?.action}</span>"</span>)
        Log.d(TAG, <span class="hljs-string">"onTouchEvent actionIndex:<span class="hljs-subst">${event?.actionIndex}</span>"</span>)
        Log.d(TAG, <span class="hljs-string">"onTouchEvent actionMasked:<span class="hljs-subst">${event?.actionMasked}</span>"</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>
    }
}
</code></pre>
<p>ä¾æ¬¡åœ¨ MyLinearLayout ä¸­æŒ‰ä¸‹ 4 æ ¹æ‰‹æŒ‡åæ‰“å°å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs">onTouchEvent action:0
onTouchEvent actionIndex:0
onTouchEvent actionMasked:0

onTouchEvent action:261
onTouchEvent actionIndex:1
onTouchEvent actionMasked:5

onTouchEvent action:517
onTouchEvent actionIndex:2
onTouchEvent actionMasked:5

onTouchEvent action:773
onTouchEvent actionIndex:3
onTouchEvent actionMasked:5
</code></pre>
<p>æŠŠ action çš„å€¼è½¬æˆ 16 è¿›åˆ¶å¹¶ä¸äº‹ä»¶ç±»å‹å¯¹åº”ä¸Šï¼Œåšæˆè¡¨æ ¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>

























<table><thead><tr><th>æ‰‹æŒ‡æŒ‰ä¸‹</th><th>è§¦å‘äº‹ä»¶(æ•°å€¼)</th></tr></thead><tbody><tr><td>ç¬¬1ä¸ªæ‰‹æŒ‡æŒ‰ä¸‹</td><td>ACTION_DOWN (0x0000<strong>00</strong>00)</td></tr><tr><td>ç¬¬2ä¸ªæ‰‹æŒ‡æŒ‰ä¸‹</td><td>ACTION_POINTER_DOWN (0x0000<strong>01</strong>05)</td></tr><tr><td>ç¬¬3ä¸ªæ‰‹æŒ‡æŒ‰ä¸‹</td><td>ACTION_POINTER_DOWN (0x0000<strong>02</strong>05)</td></tr><tr><td>ç¬¬4ä¸ªæ‰‹æŒ‡æŒ‰ä¸‹</td><td>ACTION_POINTER_DOWN (0x0000<strong>03</strong>05)</td></tr></tbody></table>
<p>å¾ˆå®¹æ˜“å°±å¯ä»¥å‘ç°å®ƒä»¬çš„å¯¹åº”å…³ç³»ï¼Œè¿™é‡Œ event?.action è¿”å›çš„å°±æ˜¯è¿™ä¸ª int ç±»å‹çš„å€¼ï¼Œevent?.actionMasked è¿”å›çš„æ˜¯ä½ 8 ä½çš„å€¼ç”¨äºè¡¨ç¤ºäº‹ä»¶ç±»å‹ï¼Œevent?.actionIndex è¿”å›çš„æ˜¯æ¬¡ä½çš„ 8 ä½çš„å€¼ç”¨äºè¡¨ç¤º pointerIndexã€‚å…¶å®é€šè¿‡æºç ä¹Ÿå¯ä»¥å‘ç°å®ƒä»¬çš„å…³ç³»ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">ACTION_MASK</span> <span class="hljs-operator">=</span> <span class="hljs-number">0xff</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">ACTION_POINTER_INDEX_MASK</span> <span class="hljs-operator">=</span> <span class="hljs-number">0xff00</span>;
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">ACTION_POINTER_INDEX_SHIFT</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAction</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> nativeGetAction(mNativePtr);
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getActionMasked</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// å–ä½ 8 ä½</span>
    <span class="hljs-keyword">return</span> nativeGetAction(mNativePtr) &amp; ACTION_MASK;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getActionIndex</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// å–æ¬¡ä½çš„ 8 ä½ï¼Œç„¶åå³ç§» 8 ä½</span>
    <span class="hljs-keyword">return</span> (nativeGetAction(mNativePtr) &amp; ACTION_POINTER_INDEX_MASK)
            &gt;&gt; ACTION_POINTER_INDEX_SHIFT;
}
</code></pre>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒgetActionIndex() åªåœ¨ down å’Œ up æ—¶æœ‰æ•ˆï¼Œmove æ—¶æ˜¯æ— æ•ˆçš„ã€‚</strong> è¦æƒ³åœ¨ move çš„æ—¶å€™è¿½è¸ªäº‹ä»¶å°±éœ€è¦ä½¿ç”¨ pointerIdã€‚</p>
<p>è§¦æ‘¸äº‹ä»¶ä¸­ Pointer å‡ºç°çš„çš„æ¬¡åºä¸æ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥ pointerIndex çš„å€¼ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ï¼Œä½†æ˜¯ pointerId åœ¨ Pointer ä¿æŒ active æœŸé—´æ˜¯ä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨ getPointerId(pointerIndex: Int) æ¥è·å–è·å–å…¶ idï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ¥ä¸‹æ¥çš„ä¸€ç³»åˆ—è§¦æ‘¸äº‹ä»¶ä¸­è¿½è¸ªè¿™ä¸ª Pointerã€‚å¯ä»¥ä½¿ç”¨ findPointerIndex(pointerId: Int) æ¥è·å–åé¢çš„è§¦æ‘¸äº‹ä»¶ä¸­è¿™ä¸ª Pointer çš„ pointerIndexã€‚</p>
<h2 data-id="heading-4">å†å²æ•°æ®(æ‰¹å¤„ç†)</h2>
<p>ç”±äºæˆ‘ä»¬çš„è®¾å¤‡éå¸¸çµæ•ï¼Œæ‰‹æŒ‡ç¨å¾®ç§»åŠ¨ä¸€ä¸‹å°±ä¼šäº§ç”Ÿä¸€ä¸ªç§»åŠ¨äº‹ä»¶ï¼Œæ‰€ä»¥ç§»åŠ¨äº‹ä»¶ä¼šäº§ç”Ÿå¾—ç‰¹åˆ«é¢‘ç¹ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œç³»ç»Ÿä¼šå°†è¿‘æœŸçš„å¤šä¸ªç§»åŠ¨äº‹ä»¶ï¼ˆmoveï¼‰æŒ‰ç…§äº‹ä»¶å‘ç”Ÿçš„é¡ºåºè¿›è¡Œæ’åºæ‰“åŒ…æ”¾åœ¨åŒä¸€ä¸ª MotionEvent ä¸­ï¼Œä¸ä¹‹å¯¹åº”çš„äº§ç”Ÿäº†ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<ol>
<li>getHistorySize()ï¼Œè·å–å†å²äº‹ä»¶é›†åˆå¤§å°ã€‚</li>
<li>getHistoricalX(int pos)ã€getHistoricalY(int pos)ï¼Œè·å–ç¬¬ pos ä¸ªå†å²äº‹ä»¶çš„ x å’Œ y åæ ‡ (pos &lt; getHistorySize())ã€‚</li>
<li>getHistoricalX(int pointerIndex, int pos)ã€getHistoricalY(int pointerIndex, int pos)ï¼Œè·å–ç¬¬ pointerIndex ä¸ªæ‰‹æŒ‡çš„ç¬¬ pos ä¸ªå†å²äº‹ä»¶çš„ x å’Œ y åæ ‡ï¼ˆpointerIndex &lt; getPointerCount(), pos &lt; getHistorySize()ï¼‰ã€‚</li>
</ol>
<p>æ³¨æ„å†å²æ•°æ®åªæœ‰ ACTION_MOVE äº‹ä»¶ï¼Œå†å²æ•°æ®å•ç‚¹è§¦æ§å’Œå¤šç‚¹è§¦æ§å‡å¯ä»¥ç”¨ã€‚</p>
<p>è¦æŒ‰é¡ºåºå¤„ç†è¿™ä¸€æ‰¹ä¸­çš„æ‰€æœ‰åæ ‡ï¼Œéœ€è¦å…ˆå¤„ç†è¿™ä¸€æ‰¹ä¸­çš„ historical åæ ‡ï¼Œç„¶åå¤„ç† current åæ ‡ã€‚current Pointer çš„åæ ‡å¯ä»¥é€šè¿‡ getX(int) å’Œ getY(int) æ‹¿åˆ°ï¼Œhistorical åæ ‡å¯ä»¥é€šè¿‡ getHistoricalX(int, int)å’Œ getHistoricalY(int, int) æ‹¿åˆ°ã€‚å®˜æ–¹ç»™å‡ºäº†ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">printSamples</span><span class="hljs-params">(MotionEvent ev)</span> {
    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">historySize</span> <span class="hljs-operator">=</span> ev.getHistorySize();
    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">pointerCount</span> <span class="hljs-operator">=</span> ev.getPointerCount();
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; h &lt; historySize; h++) {
        System.out.printf(<span class="hljs-string">"At time %d:"</span>, ev.getHistoricalEventTime(h));
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; p &lt; pointerCount; p++) {
            System.out.printf(<span class="hljs-string">" pointer %d: (%f,%f)"</span>,
                    ev.getPointerId(p), ev.getHistoricalX(p, h), ev.getHistoricalY(p, h));
        }
    }
    System.out.printf(<span class="hljs-string">"At time %d:"</span>, ev.getEventTime());
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; p &lt; pointerCount; p++) {
        System.out.printf(<span class="hljs-string">" pointer %d: (%f,%f)"</span>,
                ev.getPointerId(p), ev.getX(p), ev.getY(p));
    }
}
</code></pre>
<h2 data-id="heading-5">é¼ æ ‡äº‹ä»¶</h2>
<p>è§¦æ§ç¬”äº‹ä»¶å’Œæ‰‹æŒ‡äº‹ä»¶å¤„ç†æµç¨‹å¤§è‡´ç›¸åŒï¼Œé¼ æ ‡äº‹ä»¶åˆ™ä¸ä¸€æ ·ï¼Œé¼ æ ‡ç›¸å…³çš„å‡ ä¸ªäº‹ä»¶å¦‚ä¸‹ï¼š</p>
<ol>
<li>ACTION_HOVER_ENTERï¼ŒæŒ‡é’ˆç§»å…¥åˆ°çª—å£æˆ–è€… View åŒºåŸŸï¼Œä½†æ²¡æœ‰æŒ‰ä¸‹ã€‚</li>
<li>ACTION_HOVER_MOVEï¼ŒæŒ‡é’ˆåœ¨çª—å£æˆ–è€… View åŒºåŸŸç§»åŠ¨ï¼Œä½†æ²¡æœ‰æŒ‰ä¸‹ã€‚</li>
<li>ACTION_HOVER_EXITï¼ŒæŒ‡é’ˆç§»å‡ºåˆ°çª—å£æˆ–è€… View åŒºåŸŸï¼Œä½†æ²¡æœ‰æŒ‰ä¸‹ã€‚</li>
<li>ACTION_SCROLLï¼Œæ»šè½®æ»šåŠ¨ï¼Œå¯ä»¥è§¦å‘æ°´å¹³æ»šåŠ¨ï¼ˆAXIS_HSCROLLï¼‰æˆ–è€…å‚ç›´æ»šåŠ¨ï¼ˆAXIS_VSCROLLï¼‰ã€‚</li>
</ol>
<p>æ³¨æ„ï¼š<br/></p>
<ol>
<li>è¿™äº›äº‹ä»¶ç±»å‹æ˜¯ å®‰å“4.0 (API 14) æ‰æ·»åŠ çš„ã€‚</li>
<li>ä½¿ç”¨ getActionMasked() è·å¾—è¿™äº›äº‹ä»¶ç±»å‹ã€‚</li>
<li>è¿™äº›äº‹ä»¶ä¸ä¼šä¼ é€’åˆ° onTouchEvent(MotionEvent)ï¼Œè€Œæ˜¯ä¼ é€’åˆ° onGenericMotionEvent(MotionEvent)ã€‚</li>
</ol>
<h2 data-id="heading-6">è¾“å…¥è®¾å¤‡çš„ç±»å‹</h2>
<p>é€šè¿‡ getToolType(pointerIndex: Int) å¯ä»¥è·å– Pointer çš„ç±»å‹ï¼Œ ç±»å‹åŒ…æ‹¬æœ‰ï¼š</p>
<ul>
<li>TOOL_TYPE_UNKNOWNï¼ˆæœªçŸ¥ç±»å‹ï¼‰ï¼›</li>
<li>TOOL_TYPE_FINGERï¼ˆæ‰‹æŒ‡ï¼‰ï¼›</li>
<li>TOOL_TYPE_STYLUSï¼ˆç¬”ï¼‰ï¼›</li>
<li>TOOL_TYPE_MOUSEï¼ˆé¼ æ ‡ï¼‰ï¼›</li>
<li>TOOL_TYPE_ERASERï¼ˆæ©¡çš®æ“¦ï¼‰ç­‰ï¼›<br/></li>
</ul>
<p>æ³¨æ„è¿™é‡Œçš„å‚æ•°æ˜¯ pointerIndexï¼Œè€Œä¸æ˜¯ pointerIdã€‚</p>
<h2 data-id="heading-7">å‚è€ƒèµ„æ–™</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroid%2Fview%2FMotionEvent%3Fhl%3Den%23getRawX(kotlin.Int)" target="_blank" title="https://developer.android.google.cn/reference/kotlin/android/view/MotionEvent?hl=en#getRawX(kotlin.Int)" ref="nofollow noopener noreferrer">MotionEvent</a><br/>
<a href="https://juejin.cn/post/6844903449344081934?searchId=202505192159596EC98FF62235B0BBD448" target="_blank" title="https://juejin.cn/post/6844903449344081934?searchId=202505192159596EC98FF62235B0BBD448">MotionEvent è¯¦è§£</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>