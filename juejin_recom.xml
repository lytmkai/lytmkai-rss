<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[Kotlin/Ktor å®è·µï¼šåˆ©ç”¨ MCP ä»é›¶æ‰“é€  AI Agent æœåŠ¡ç«¯æŒ‡å—]]></title>    <link>https://juejin.cn/post/7582958136258183204</link>    <guid>https://juejin.cn/post/7582958136258183204</guid>    <pubDate>2025-12-14T10:13:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582958136258183204" data-draft-id="7582854603061395498" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Kotlin/Ktor å®è·µï¼šåˆ©ç”¨ MCP ä»é›¶æ‰“é€  AI Agent æœåŠ¡ç«¯æŒ‡å—"/> <meta itemprop="keywords" content="Kotlin,Agent,MCP"/> <meta itemprop="datePublished" content="2025-12-14T10:13:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="KotlinKUGè´µå·"/> <meta itemprop="url" content="https://juejin.cn/user/2946346893987704"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Kotlin/Ktor å®è·µï¼šåˆ©ç”¨ MCP ä»é›¶æ‰“é€  AI Agent æœåŠ¡ç«¯æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2946346893987704/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    KotlinKUGè´µå·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T10:13:50.000Z" title="Sun Dec 14 2025 10:13:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘ä¸€ç›´åœ¨ç”¨<code>NodeJS</code>å¼„MCPåº”ç”¨ï¼Œæ³¨æ„åˆ°SDKæä¾›äº†ä¸€ä¸ªKotlinçš„ç‰ˆæœ¬ï¼Œå°è¯•åå‘ç°å±…ç„¶æ˜¯åŸºäºKtorçš„ï¼Œç´¢æ€§è¯•äº†ä¸‹ç”¨Kotlinæ¥æ­å»ºMCPåº”ç”¨ï¼Œå®è·µåè¯æ˜è¿™æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œæ¯”å¦‚å®˜æ–¹Koogä¹Ÿæ˜¯é…äº†Ktorï¼ŒKtorè¿™ç§å°ä½“é‡webæ¡†æ¶å°±å¾ˆé€‚åˆåšè¿™ç§ä¸­é—´å±‚æœåŠ¡æ¥ä½¿ç”¨ã€‚</p>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fsetruth%2Fkotlin-mcp-application" target="_blank" title="https://github.com/setruth/kotlin-mcp-application" ref="nofollow noopener noreferrer">GitHubçš„Demoï¼ŒåŒ…å«AI-Agentå’ŒMCPServer,ä»…ä¾›å‚è€ƒ</a></p>
</blockquote>
<h2 data-id="heading-1">MCPç®€ä»‹</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2f01c281dc234167a8b3bee7d68c83b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS290bGluS1VH6LS15bee:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312029&amp;x-signature=gxmBch%2BlJQiq2vF6zWqaZTkpwAs%3D" alt="QQ_1765638549366.png" loading="lazy"/></p>
<p>ç®€å•æ¥è¯´å°±æ˜¯åŸºäºMCPåè®®å¯¹ä¼ ç»Ÿçš„AI-Agentè¿›è¡Œèµ‹èƒ½ï¼Œè®©AI-Agentå’Œå·¥å…·æœåŠ¡æœ‰ä¸€ä¸ªçº¦å®šçš„åè®®è¿›è¡Œé€šè®¯ï¼Œé€šè¿‡MCPå‘Šè¯‰AI-Agentå·¥å…·è°ƒç”¨ç«¯ç‚¹å¹¶æä¾›æœåŠ¡ä¸Šçš„å·¥å…·ä¿¡æ¯è¿›è¡Œæ³¨å†Œã€‚åœ¨AIå¯¹è¯æ—¶è®©AIä¼˜å…ˆå»é€‰æ‹©å·¥å…·ï¼Œæ‹¿åˆ°é€‰æ‹©çš„å·¥å…·åé€šè¿‡å‘ŠçŸ¥çš„æ“ä½œç«¯ç‚¹å¯¹MCPServeræœåŠ¡è¿›è¡Œè°ƒç”¨ï¼Œç„¶åè·å–åˆ°ç»“æœåäº¤ç»™AIä¸€å¹¶åˆ†æã€‚<strong>è¾¾åˆ°æ•°æ®ä¸è¿‡æ—¶ï¼Œå‡†ç¡®æ€§é«˜ï¼Œä¸è®­ç»ƒAIçš„å‰æä¸‹å®šåˆ¶åŒ–AIææ•°æ®æ¨ç†</strong></p>
<h2 data-id="heading-2">æŠ€æœ¯æ ˆ</h2>
<ul>
<li>AIéƒ¨ç½²ï¼šOllamaéƒ¨ç½²ä¸€ä¸ª<code>DeepseekR1-1.5B</code>æ¨¡å‹(ä¸ªäººç”µè„‘æœ‰é™ğŸ˜…ï¼Œæœ‰æ¡ä»¶çš„å»ºè®®7Bä»¥ä¸Š)</li>
<li>MCPServer: <code>Kotlin</code>,<code>ktor-server</code>,<code>modelcontextprotocol-kotlin-sdk</code></li>
<li>AI-Agent(MCP-Client): <code>Kotlin</code>,<code>ktor-server</code>,<code>ktor-client</code>,<code>modelcontextprotocol-kotlin-sdk</code>,</li>
</ul>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmodelcontextprotocol.io%2Fdocs%2Fdevelop%2Fbuild-server%23kotlin" target="_blank" title="https://modelcontextprotocol.io/docs/develop/build-server#kotlin" ref="nofollow noopener noreferrer">modelcontextprotocolæ–‡æ¡£</a></p>
<h2 data-id="heading-3">ç›®æ ‡å®ç°</h2>
<p>æˆ‘ä»¬æœ¬åœ°éƒ¨ç½²çš„AIæ˜¯ä¸å…·å¤‡è”ç½‘åŠŸèƒ½æ‰€ä»¥å®ƒæ— æ³•è·å–å½“å‰æ—¶é—´ï¼Œæˆ‘ä»¬é€šè¿‡æä¾›æ—¶é—´é€‰æ‹©å·¥å…·è¾¾åˆ°æœ¬åœ°AIä¹Ÿèƒ½æœ‰å½“å‰æ—¶é—´æ„ŸçŸ¥çš„èƒ½åŠ›</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57a56fa4316e4343b4fb98167190bc51~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS290bGluS1VH6LS15bee:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312029&amp;x-signature=m8BSx2xrTzrcaLA4z0KdK5NZtiE%3D" alt="QQ_1765699970722.png" loading="lazy"/></p>
<h2 data-id="heading-4">å®ç°MCP Server</h2>
<p>MCPServeræœ¬èº«æ˜¯ä¸å…·å¤‡WebæœåŠ¡èƒ½åŠ›çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—ä¾é Ktor-Serverå»æŠŠä»–æŒ‚è½½åˆ°æˆ‘ä»¬çš„WebæœåŠ¡ä¸Šè®©ä»–æˆä¸ºä¸€ä¸ªç‹¬ç«‹å¯è¢«è¿œç«¯è°ƒç”¨çš„æœåŠ¡</p>
<h3 data-id="heading-5">æ ¸å¿ƒä¾èµ–</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">plugins {
    kotlin(<span class="hljs-string">"jvm"</span>) version <span class="hljs-string">"2.2.0"</span>
    id(<span class="hljs-string">"io.ktor.plugin"</span>) version <span class="hljs-string">"3.3.3"</span>
}
<span class="hljs-keyword">val</span> mcpVersion = <span class="hljs-string">"0.8.1"</span>
implementation(<span class="hljs-string">"io.modelcontextprotocol:kotlin-sdk:<span class="hljs-subst">${mcpVersion}</span>"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-core-jvm"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-netty-jvm"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-serialization-jackson"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-content-negotiation"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-sse"</span>)
</code></pre>
<h3 data-id="heading-6">1.åˆ›å»ºMCPSeverçš„è¿è¡Œç¤ºä¾‹</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> mcpServer = Server(
    Implementation(
        name = <span class="hljs-string">"kotlin mcp server"</span>,
        version = <span class="hljs-string">"1.0.0"</span>
    ),
    ServerOptions(
        capabilities = ServerCapabilities(tools = ServerCapabilities.Tools(listChanged = <span class="hljs-literal">true</span>))
    )
)
</code></pre>
<h3 data-id="heading-7">2.åˆ›å»ºå·¥å…·</h3>
<p>åˆ›å»ºè¿è¡Œå®ä¾‹ä»¥åæˆ‘ä»¬å°±å¯ä»¥åŸºäºå¾€æœåŠ¡å®¹å™¨ä¸­æ³¨å†Œå·¥å…·äº†</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//å†™ä¸€ä¸ªæ‰©å±•å‡½æ•°æ ¹æ®addToolå‡½æ•°çš„è§„èŒƒåˆ›å»ºä¸€ä¸ªè·å–æ—¶é—´çš„å·¥å…·</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> Server.<span class="hljs-title">registerCurrentTimeTool</span><span class="hljs-params">()</span></span> {
    addTool(
        name = <span class="hljs-string">"get_current_time"</span>,
        description = <span class="hljs-string">"""
         è·å–å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨æ ¼å¼æ¨¡å¼ï¼ˆå¦‚ 'yyyy-MM-dd HH:mm:ss'ï¼‰æ¥æŒ‡å®šè¿”å›æ ¼å¼ã€‚
        """</span>.trimIndent(),
        inputSchema = ToolSchema(
            properties = buildJsonObject {
                putJsonObject(<span class="hljs-string">"format_pattern"</span>) {
                    put(<span class="hljs-string">"type"</span>, <span class="hljs-string">"string"</span>)
                    put(<span class="hljs-string">"description"</span>, <span class="hljs-string">"ç”¨äºæ ¼å¼åŒ–æ—¶é—´çš„æ¨¡å¼ï¼Œä¾‹å¦‚ 'yyyy-MM-dd HH:mm:ss'ã€‚"</span>)
                }
            },
        ),

        handler = { request -&gt;
            <span class="hljs-keyword">val</span> userPattern: String? = request.arguments
                ?.<span class="hljs-keyword">get</span>(<span class="hljs-string">"format_pattern"</span>)
                ?.jsonPrimitive
                ?.contentOrNull
            log.info { <span class="hljs-string">"è¯·æ±‚å‚æ•°: <span class="hljs-variable">$userPattern</span>"</span> }
            <span class="hljs-keyword">val</span> formatPattern: String = userPattern ?: run {
                log.warn { <span class="hljs-string">" ä¸Šæ¸¸è¯·æ±‚æ—¶é—´å·¥å…·æœªæä¾›å‚æ•°ï¼Œä½¿ç”¨é»˜è®¤æ ¼å¼åŒ–"</span> }
                <span class="hljs-string">"yyyyå¹´MMæœˆddæ—¥ HH:mm:ss (zzz)"</span>
            }
            <span class="hljs-keyword">val</span> formatter = DateTimeFormatter.ofPattern(formatPattern)
                .withZone(ZoneId.systemDefault())
            <span class="hljs-keyword">val</span> currentTime = Instant.now()
            <span class="hljs-keyword">val</span> formattedTime = formatter.format(currentTime)
            <span class="hljs-keyword">return</span><span class="hljs-symbol">@addTool</span> CallToolResult(
                content = listOf(TextContent(formattedTime))
            )
        }
    )
}
</code></pre>
<h3 data-id="heading-8">3.åˆ›å»ºTransportè¿æ¥æ¡¥æ¢</h3>
<p>MCPServeræä¾›ä¸åŒçš„è¿æ¥ä½¿ç”¨æ–¹å¼ï¼Œæ¯”å¦‚SSEï¼Œå†…éƒ¨IOè°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—é€‰ç”¨ä¸€ä¸ªè¿æ¥å™¨æ¥è¿›è¡Œè¿æ¥ã€‚ç”±äºæˆ‘ä»¬æ˜¯åˆ©ç”¨Ktor-serveræ¥æŒ‚è½½æä¾›è¿œç«¯è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨SSEçš„Transportï¼Œå¹¶ä¸”SDKå†…ç½®çš„SSETransportæ˜¯åŸºäºKtorå®ç°çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠKtorçš„Calläº¤ç»™SSETransportå¤„ç†ï¼Œéå¸¸çš„æ–¹ä¾¿ã€‚</p>
<h4 data-id="heading-9">åˆ›å»ºå¯¹åº”AI-Agentçš„Transportç®¡ç†</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//AI-Agentçš„Transportä¼šè¯ç®¡ç†</span>
<span class="hljs-comment">//è€ƒè™‘åˆ°å¯èƒ½ä¼šæœ‰å¤šä¸ªAI-Agentè¿›è¡ŒSSEè¿æ¥ï¼ŒæŠŠä»–ä»¬å¯¹åº”çš„Transportå·¥å…·ç®¡ç†å½’å±èµ·æ¥</span>
<span class="hljs-keyword">object</span> SessionManager {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sessions: ConcurrentHashMap&lt;String, SseServerTransport&gt; = ConcurrentHashMap()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addSession</span><span class="hljs-params">(transport: <span class="hljs-type">SseServerTransport</span>)</span></span> {
        sessions[transport.sessionId] = transport
        transport.onClose {
            sessions.remove(transport.sessionId)
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getTransport</span><span class="hljs-params">(sessionId: <span class="hljs-type">String</span>)</span></span>: SseServerTransport? {
        <span class="hljs-keyword">return</span> sessions[sessionId]
    }
    <span class="hljs-comment">//å¯è‡ªè¡Œæ‰©å±•ä¼šè¯åˆ é™¤ç­‰å®Œå–„ä¼šè¯ç®¡ç†ï¼Œç¤ºä¾‹ä»…ä¾›æµç¨‹è¿è¡Œå‚è€ƒ</span>
}
</code></pre>
<h4 data-id="heading-10">1. åˆ›å»ºMCPServerçš„SSEè¿æ¥ç‚¹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//åˆ©ç”¨Ktor-Serveræä¾›AI-Agentè¿æ¥çš„SSEè¯·æ±‚</span>
<span class="hljs-keyword">val</span> postEndpoint = <span class="hljs-string">"post"</span>
sse(<span class="hljs-string">"mcp/sse"</span>) {
    <span class="hljs-comment">//åˆ›å»ºä¸MCPServerçš„è¿æ¥å¤„ç†å™¨ï¼Œå¹¶ä¸”æä¾›SSEè¯·æ±‚ç”¨æˆ·è°ƒç”¨ç«¯ç‚¹,å’Œsseçš„ä¼šè¯æä¾›è¿æ¥å™¨ä½¿ç”¨å“åº”</span>
    <span class="hljs-comment">//è¿™é‡Œçš„è°ƒç”¨ç«¯ç‚¹AI-Agentå®¢æˆ·ç«¯çš„SDKä¼šè‡ªåŠ¨åŒ¹é…åˆ°mcp/${postEndpoint}ä¸‹</span>
    <span class="hljs-keyword">val</span> transport = SseServerTransport(postEndpoint, <span class="hljs-keyword">this</span>)
    mcpServer.createSession(transport) <span class="hljs-comment">//è¿™ç©æ„è™½ç„¶æ˜¯æŒ‚èµ·çš„ï¼Œä½†æ˜¯ä¸ä¼šä¸€ç›´æŒ‚èµ·ï¼ï¼ï¼è¿˜æ˜¯ä¼šå¾€ä¸‹æ‰§è¡Œ</span>
    SessionManager.addSession(transport)
    <span class="hljs-keyword">while</span> (isActive) { <span class="hljs-comment">//é¿å…sse{}æ‰§è¡Œå®Œæ¯•åå¯¼è‡´çš„ä¼šè¯ç»“æŸTransportæ— æ³•ä½¿ç”¨ä¼šè¯å“åº”</span>
        delay(<span class="hljs-number">100</span>)
    }
}
</code></pre>
<h4 data-id="heading-11">2. åˆ›å»ºMCPServerçš„æ“ä½œç«¯ç‚¹</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> postEndpoint = <span class="hljs-string">"post"</span>
<span class="hljs-comment">//åˆ›å»ºè°ƒç”¨ç«¯ç‚¹è¯·æ±‚(æ˜¯POST)</span>
post(<span class="hljs-string">"sse/<span class="hljs-subst">${postEndpoint}</span>"</span>) {
    <span class="hljs-comment">//æŸ¥è¯¢AI-Agentçš„ä¼šè¯Id</span>
    <span class="hljs-keyword">val</span> sessionId = call.queryParameters[<span class="hljs-string">"sessionId"</span>] ?: run {
        call.respondText(<span class="hljs-string">"æ²¡æœ‰sessionIdå‚æ•°ï¼Œä¸çŸ¥é“ä½ æ˜¯å“ªä¸€ä¸ªSSEä¼šè¯"</span>, status = HttpStatusCode.BadRequest)
        <span class="hljs-keyword">return</span><span class="hljs-symbol">@post</span>
    }
     <span class="hljs-comment">//æŸ¥è¯¢å¯¹åº”çš„Transportå·¥å…·</span>
    <span class="hljs-keyword">val</span> transport = SessionManager.getTransport(sessionId)
        ?: run {
            call.respondText(<span class="hljs-string">"æ— æ•ˆä¼šè¯Idï¼Œå¯¹åº”çš„ä¼šè¯å·²ç»å…³é—­äº†"</span>, status = HttpStatusCode.Unauthorized)
            <span class="hljs-keyword">return</span><span class="hljs-symbol">@post</span>
        }
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">//æŠŠä¼šè¯ä¸Šä¸‹é—®äº¤ç»™ transport.handlePostMessageè¿›è¡Œå¤„ç†</span>
        <span class="hljs-comment">//è¿™é‡Œé¢ä¼šè‡ªåŠ¨æ ¹æ®ä¸Šæ¸¸å‘æ¥MCPå†…å®¹çº¦å®šå»è¿›è¡Œç›¸å…³æ“ä½œç„¶åå“åº”</span>
        <span class="hljs-comment">//æ³¨æ„: è¿™é‡Œå¹¶ä¸ä¼šè¿›è¡Œå“åº”éœ€è¦çš„æ•°æ®ï¼Œä»–åªä¼šå“åº”ä¸€ä¸ªæ¥å—çŠ¶æ€ï¼Œå®é™…ä¸Šæ•°æ®çš„å“åº”æ˜¯èµ°çš„SSE</span>
        transport.handlePostMessage(call)
    } <span class="hljs-keyword">catch</span> (e: Exception) {
        <span class="hljs-keyword">if</span> (!call.response.isCommitted) {
            call.respondText(<span class="hljs-string">"MCPæœåŠ¡å¤„ç†å‡ºé”™: <span class="hljs-subst">${e.message}</span>"</span>, status = HttpStatusCode.InternalServerError)
        }
    }
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b256d76f94243ada858e6dca937bcbe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS290bGluS1VH6LS15bee:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312029&amp;x-signature=LtJ46%2Bz1kxM0hCzOUpPP5ZxDMWg%3D" alt="QQ_1765701744631.png" loading="lazy"/></p>
<h3 data-id="heading-12">å®Œæ•´çš„MCPServerè·¯ç”±</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> io.ktor.http.HttpStatusCode
<span class="hljs-keyword">import</span> io.ktor.server.response.respondText
<span class="hljs-keyword">import</span> io.ktor.server.routing.Route
<span class="hljs-keyword">import</span> io.ktor.server.routing.post
<span class="hljs-keyword">import</span> io.ktor.server.sse.sse
<span class="hljs-keyword">import</span> io.modelcontextprotocol.kotlin.sdk.server.Server
<span class="hljs-keyword">import</span> io.modelcontextprotocol.kotlin.sdk.server.ServerOptions
<span class="hljs-keyword">import</span> io.modelcontextprotocol.kotlin.sdk.server.SseServerTransport
<span class="hljs-keyword">import</span> io.modelcontextprotocol.kotlin.sdk.types.Implementation
<span class="hljs-keyword">import</span> io.modelcontextprotocol.kotlin.sdk.types.ServerCapabilities
<span class="hljs-keyword">import</span> kotlinx.coroutines.delay
<span class="hljs-keyword">import</span> kotlinx.coroutines.isActive
<span class="hljs-keyword">import</span> java.util.concurrent.ConcurrentHashMap

<span class="hljs-comment">/**
 *
 * <span class="hljs-doctag">@author</span> setruth
 * <span class="hljs-doctag">@date</span> 2025/12/13
 * <span class="hljs-doctag">@time</span> 12:21
 */</span>

<span class="hljs-keyword">object</span> SessionManager {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sessions: ConcurrentHashMap&lt;String, SseServerTransport&gt; = ConcurrentHashMap()

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">addSession</span><span class="hljs-params">(transport: <span class="hljs-type">SseServerTransport</span>)</span></span> {
        sessions[transport.sessionId] = transport
        transport.onClose {
            sessions.remove(transport.sessionId)
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getTransport</span><span class="hljs-params">(sessionId: <span class="hljs-type">String</span>)</span></span>: SseServerTransport? {
        <span class="hljs-keyword">return</span> sessions[sessionId]
    }
}


<span class="hljs-function"><span class="hljs-keyword">fun</span> Route.<span class="hljs-title">mcpServer</span><span class="hljs-params">(
    path: <span class="hljs-type">String</span>,
    toolConfiguration: <span class="hljs-type">Server</span>.() -&gt; <span class="hljs-type">Unit</span>,
)</span></span> {
    <span class="hljs-keyword">val</span> mcpServer = Server(
        Implementation(
            name = <span class="hljs-string">"kotlin mcp server"</span>,
            version = <span class="hljs-string">"1.0.0"</span>
        ),
        ServerOptions(
            capabilities = ServerCapabilities(tools = ServerCapabilities.Tools(listChanged = <span class="hljs-literal">true</span>))
        )
    )

    mcpServer.toolConfiguration()

    <span class="hljs-keyword">val</span> postEndpoint = <span class="hljs-string">"post"</span>
    sse(<span class="hljs-string">"<span class="hljs-variable">$path</span>/sse"</span>) {
        <span class="hljs-keyword">val</span> transport = SseServerTransport(postEndpoint, <span class="hljs-keyword">this</span>)
        mcpServer.createSession(transport)
        SessionManager.addSession(transport)
        <span class="hljs-keyword">while</span> (isActive) {
            delay(<span class="hljs-number">100</span>)
        }
    }
    post(<span class="hljs-string">"<span class="hljs-variable">$path</span>/<span class="hljs-subst">${postEndpoint}</span>"</span>) {
        <span class="hljs-keyword">val</span> sessionId = call.queryParameters[<span class="hljs-string">"sessionId"</span>] ?: run {
            call.respondText(<span class="hljs-string">"æ²¡æœ‰sessionIdå‚æ•°ï¼Œä¸çŸ¥é“ä½ æ˜¯å“ªä¸€ä¸ªSSEä¼šè¯"</span>, status = HttpStatusCode.BadRequest)
            <span class="hljs-keyword">return</span><span class="hljs-symbol">@post</span>
        }
        <span class="hljs-keyword">val</span> transport = SessionManager.getTransport(sessionId)
            ?: run {
                call.respondText(<span class="hljs-string">"æ— æ•ˆä¼šè¯Idï¼Œå¯¹åº”çš„ä¼šè¯å·²ç»å…³é—­äº†"</span>, status = HttpStatusCode.Unauthorized)
                <span class="hljs-keyword">return</span><span class="hljs-symbol">@post</span>
            }
        <span class="hljs-keyword">try</span> {
            transport.handlePostMessage(call)
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            <span class="hljs-keyword">if</span> (!call.response.isCommitted) {
                call.respondText(<span class="hljs-string">"MCPæœåŠ¡å¤„ç†å‡ºé”™: <span class="hljs-subst">${e.message}</span>"</span>, status = HttpStatusCode.InternalServerError)
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-13">è¿è¡ŒMCPServer</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> MCP_PORT = <span class="hljs-number">3000</span>

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    embeddedServer(Netty, port = MCP_PORT, host = <span class="hljs-string">"127.0.0.1"</span>, module = Application::module)
        .start(wait = <span class="hljs-literal">true</span>)
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> Application.<span class="hljs-title">module</span><span class="hljs-params">()</span></span> {
    install(ContentNegotiation) {
        jackson()
    }
    install(SSE)
    routing {
        mcpServer(<span class="hljs-string">"/mcp"</span>) { <span class="hljs-comment">// é…ç½®è·¯ç”±</span>
            registerCurrentTimeTool() <span class="hljs-comment">//æ³¨å†Œè·å–æ—¶é—´å·¥å…·å·¥å…·</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-14">MCPServerçš„è¿æ¥æµ‹è¯•</h3>
<p>è®¿é—®<code>127.0.0.1:3000/mcp/sse</code>åæˆ‘ä»¬ä¼šè·å–åˆ°McpServerå“åº”è¿‡æ¥çš„<code>endpoint</code>äº‹ä»¶,å½“AI-Agent(MCPClient)è¿æ¥åå°±ä¼šæ‹¿åˆ°è°ƒç”¨ç«¯ç‚¹çš„ä¿¡æ¯ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šé¢å†™çš„postï¼Œå¹¶ä¸”æä¾›äº†ä¼šè¯Idä¿¡æ¯ã€‚ä¸Šæ¸¸åé¢POSTè¯·æ±‚<code>/mcp/post</code>è·¯å¾„çš„æ—¶å€™å°±ä¼šå¸¦ä¸Šä¼šè¯Idçš„å‚æ•°ï¼Œæˆ‘ä»¬å°±èƒ½æ‹¿åˆ°å»æä¾›å¯¹åº”çš„Transportå·¥å…·å»å¤„ç†è°ƒç”¨äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bbf8dd66668c46ef81400aba465c2e2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS290bGluS1VH6LS15bee:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312029&amp;x-signature=1fzy71u8kT2he2sANHJ5u9sQF%2F4%3D" alt="QQ_1765698591339.png" loading="lazy"/></p>
<h2 data-id="heading-15">å®ç°AI-Agent(MCPClient)</h2>
<p>ä¸MCPServeräº¤äº’çš„æ˜¯MCPClientï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´MCPClientéƒ½æ˜¯å’ŒAI-Agentå¤„äºä¸€ä¸ªæœåŠ¡ä¸­æ‰€ä»¥è¿™é‡Œå°±ç›´æ¥æ•´åˆèµ·æ¥äº†ã€‚ç„¶åKoogä¹Ÿæœ‰Ktorçš„SDKï¼Œåˆ©ç”¨KtoræœåŠ¡ç»“åˆKoogå»ä»£ç†AIå°±éå¸¸æµç•…äº†å†åŠ ä¸ŠMCPClientæ¥ä½¿ç”¨ã€‚</p>
<h3 data-id="heading-16">æ ¸å¿ƒä¾èµ–</h3>
<pre><code class="hljs language-kotlin" lang="kotlin">plugins {
    kotlin(<span class="hljs-string">"jvm"</span>) version <span class="hljs-string">"2.2.0"</span>
    id(<span class="hljs-string">"io.ktor.plugin"</span>) version <span class="hljs-string">"3.3.3"</span>
}
<span class="hljs-keyword">val</span> mcpVersion = <span class="hljs-string">"0.8.1"</span>
implementation(<span class="hljs-string">"io.modelcontextprotocol:kotlin-sdk:<span class="hljs-subst">${mcpVersion}</span>"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-core-jvm"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-netty-jvm"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-serialization-jackson"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-content-negotiation"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-sse"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-cors"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-server-config-yaml"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-client-core"</span>)
implementation(<span class="hljs-string">"io.ktor:ktor-client-cio"</span>)
implementation(<span class="hljs-string">"ai.koog:koog-ktor:0.5.4"</span>)
</code></pre>
<h3 data-id="heading-17">1. åˆ›å»ºMCPClient</h3>
<h4 data-id="heading-18">1.1 åˆ›å»ºMCPClient</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> mcpClient: Client = Client(clientInfo = Implementation(name = <span class="hljs-string">"kotlin mcp client"</span>, version = <span class="hljs-string">"1.0.0"</span>))
</code></pre>
<h4 data-id="heading-19">1.2 åˆ›å»ºè¿æ¥å™¨</h4>
<p>æˆ‘ä»¬æ˜¯ä½¿ç”¨çš„SDKå»åˆ›å»ºMCPServerçš„Transportè¿æ¥å™¨ï¼Œæ‰€ä»¥Clientä¹Ÿæ˜¯æœ‰å¯¹åº”çš„Transportå»è¿›è¡Œè¿æ¥ï¼Œé¿å…é€šè®¯æ–¹å¼çš„ä¸ç»Ÿä¸€</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//åˆ©ç”¨Ktor-clientå»ä½œä¸ºå‘é€MCPè¯·æ±‚çš„å®¢æˆ·ç«¯</span>
<span class="hljs-keyword">val</span> mcpSeverReqClient = HttpClient(CIO) {
    install(SSE)
    install(Logging)
}
<span class="hljs-comment">//ç”±äºMCPServeræˆ‘ä»¬åˆ›å»ºçš„æ˜¯SSEçš„è¿æ¥å™¨ï¼Œæ‰€ä»¥è¿™è¾¹ä¹Ÿç”¨SSEçš„</span>
<span class="hljs-keyword">val</span> transport = SseClientTransport(
    mcpSeverReqClient,
    serverScriptPath, <span class="hljs-comment">//MCPSerberçš„SSEè¯·æ±‚åœ°å€è·¯å¾„</span>
    <span class="hljs-number">5.</span>seconds,
)
</code></pre>
<h4 data-id="heading-20">1.3 è·å–è¿æ¥MCPServerå¹¶è·å–å·¥å…·ä¿¡æ¯å­˜å‚¨</h4>
<p>åˆ›å»ºå¥½MCPClientå’ŒTransportåæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Clientå»è¿æ¥Transportï¼Œè®©Transportå»ä»£ç†Clientçš„æ‰€æœ‰æ“ä½œå»å’ŒMCPSevrerè¿›è¡Œäº¤äº’äº†</p>
<pre><code class="hljs language-kotlin" lang="kotlin">mcpClient.connect(transport) <span class="hljs-comment">// æŒ‚èµ·-&gt; è·å–ä¸MCPServerçš„SSEè¿æ¥</span>
<span class="hljs-keyword">val</span> toolsResult = mcpClient.listTools() <span class="hljs-comment">// æŒ‚èµ·-&gt; è·å–å·¥å…·åˆ—è¡¨ </span>
tools = toolsResult.tools.map { <span class="hljs-comment">//å¤„ç†ä¸€ä¸‹è¿‡æ»¤è°ƒä¸€äº›æ— ç”¨çš„å·¥å…·å…ƒæ•°æ®é¿å…å¹²æ‰°AIåˆ¤æ–­</span>
    LLMTool(
        name = it.name,
        description = it.description ?: <span class="hljs-string">""</span>,
        parameters = extractSimplifiedProperties(it), <span class="hljs-comment">//è‡ªå†™çš„å‡½æ•°ä¸æ˜¯å†…éƒ¨çš„</span>
    )
}
toolsFormatStr = <span class="hljs-string">""" //æä¾›å·¥å…·åˆ—è¡¨Promptæç¤º
    ## IV. å¯ç”¨å·¥å…·åˆ—è¡¨:<span class="hljs-subst">${mapper.writeValueAsString(tools)}</span>
"""</span>.trimIndent() 
</code></pre>
<h4 data-id="heading-21">1.4 æä¾›å·¥å…·è°ƒç”¨å‡½æ•°</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//å½“ç»™AIPromptè¿›è¡Œè§„èŒƒåååªéœ€è¦è·å–AIçš„å›ç­”å»è§£æå·¥å…·nameå’Œå¯¹åº”å‚æ•°å³å¯ï¼Œåˆ©ç”¨MCPClientå°±èƒ½å»è°ƒç”¨å¯¹åº”çš„Tool</span>
<span class="hljs-comment">//å¦‚æœéœ€è¦æ‰©å±•å¯ä»¥å’ŒAIçº¦å®šæ›´å¤šä¿¡æ¯æ¯”å¦‚å¸¦ä¸Šä¸åŒçš„MCPServerçš„æ ‡ç­¾ å°±èƒ½å®ç°è°ƒç”¨ä¸åŒMCPClientå»è·å–å¯¹åº”çš„å·¥å…·ä¿¡æ¯</span>
<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">executeTool</span><span class="hljs-params">(name: <span class="hljs-type">String</span>, input: <span class="hljs-type">Map</span>&lt;<span class="hljs-type">String</span>, Any&gt;)</span></span>: String {
    <span class="hljs-keyword">val</span> toolResult = mcpClient.callTool(name, input)
    <span class="hljs-comment">//è¿™é‡Œåªæ˜¯æ¼”ç¤ºTextçš„æ•°æ®æµå“åº”æ—¶çš„å¤„ç†ï¼Œå¯¹åº”æˆ‘ä»¬çš„get_current_timeå·¥å…·å“åº”ç±»å‹</span>
    <span class="hljs-keyword">val</span> textContent = toolResult.content.find { it.type == ContentTypes.TEXT }
    <span class="hljs-keyword">if</span> (textContent == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"æ— å†…å®¹"</span>
    }
    <span class="hljs-keyword">return</span> (textContent <span class="hljs-keyword">as</span> TextContent).text
}
</code></pre>
<h4 data-id="heading-22">å®Œæ•´MCPClient</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> log = KotlinLogging.logger { }
<span class="hljs-comment">// å·¥å…·å‚æ•°</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMToolProperty</span>(
    <span class="hljs-keyword">val</span> name: String,
    <span class="hljs-keyword">val</span> type: String,
    <span class="hljs-keyword">val</span> description: String,
)
<span class="hljs-comment">// å·¥å…·å®šä¹‰</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LLMTool</span>(
    <span class="hljs-keyword">val</span> name: String,
    <span class="hljs-keyword">val</span> description: String,
    <span class="hljs-keyword">val</span> parameters: List&lt;LLMToolProperty&gt;,
)

<span class="hljs-comment">/**
 *
 * <span class="hljs-doctag">@author</span> setruth
 * <span class="hljs-doctag">@date</span> 2025/12/13
 * <span class="hljs-doctag">@time</span> 13:31
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MCPClient</span>() : AutoCloseable {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> mcpClient: Client = Client(clientInfo = Implementation(name = <span class="hljs-string">"kotlin mcp client"</span>, version = <span class="hljs-string">"1.0.0"</span>))
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> mcpSeverReqClient = HttpClient(CIO) {
        install(SSE)
        install(Logging)
    }
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> tools: List&lt;LLMTool&gt; = listOf()
    <span class="hljs-keyword">var</span> toolsFormatStr = <span class="hljs-string">""</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">connectToServer</span><span class="hljs-params">(serverScriptPath: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">val</span> transport = SseClientTransport(
                mcpSeverReqClient,
                serverScriptPath,
                <span class="hljs-number">5.</span>seconds,
            )
            mcpClient.connect(transport)
            <span class="hljs-keyword">val</span> toolsResult = mcpClient.listTools()
            tools = toolsResult.tools.map {
                <span class="hljs-keyword">val</span> tool= LLMTool(
                    name = it.name,
                    description = it.description ?: <span class="hljs-string">""</span>,
                    parameters = extractSimplifiedProperties(it),
                )
                log.info { <span class="hljs-string">"å·¥å…·: <span class="hljs-variable">$tool</span>"</span> }
                tool
            }
            toolsFormatStr = <span class="hljs-string">"""
                ## IV. å¯ç”¨å·¥å…·åˆ—è¡¨:<span class="hljs-subst">${mapper.writeValueAsString(tools)}</span>
            """</span>.trimIndent()
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            log.error(e) { <span class="hljs-string">"MCPæœåŠ¡è¿æ¥å¤±è´¥: <span class="hljs-subst">${e.message}</span>"</span> }
        }
    }

    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">executeTool</span><span class="hljs-params">(name: <span class="hljs-type">String</span>, input: <span class="hljs-type">Map</span>&lt;<span class="hljs-type">String</span>, Any&gt;)</span></span>: String {
        <span class="hljs-keyword">val</span> toolResult = mcpClient.callTool(name, input)
        <span class="hljs-keyword">val</span> textContent = toolResult.content.find { it.type == ContentTypes.TEXT }
        <span class="hljs-keyword">if</span> (textContent == <span class="hljs-literal">null</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-string">"æ— å†…å®¹"</span>
        }
        <span class="hljs-keyword">return</span> (textContent <span class="hljs-keyword">as</span> TextContent).text
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">close</span><span class="hljs-params">()</span></span> {
        runBlocking {
            mcpClient.close()
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">extractSimplifiedProperties</span><span class="hljs-params">(sdkTool: <span class="hljs-type">Tool</span>)</span></span>: List&lt;LLMToolProperty&gt; {
        <span class="hljs-keyword">val</span> toolNode: JsonNode = <span class="hljs-keyword">try</span> {
            mapper.valueToTree(sdkTool)
        } <span class="hljs-keyword">catch</span> (e: Exception) {
            <span class="hljs-keyword">return</span> emptyList()
        }

        <span class="hljs-keyword">val</span> propertiesNode = toolNode
            .<span class="hljs-keyword">get</span>(<span class="hljs-string">"inputSchema"</span>)
            ?.<span class="hljs-keyword">get</span>(<span class="hljs-string">"properties"</span>)

        <span class="hljs-keyword">if</span> (propertiesNode == <span class="hljs-literal">null</span> || !propertiesNode.isObject) {
            <span class="hljs-keyword">return</span> emptyList()
        }

        <span class="hljs-keyword">val</span> paramsList = mutableListOf&lt;LLMToolProperty&gt;()
        propertiesNode.properties().forEach { (paramName, detailsNode) -&gt;
            <span class="hljs-keyword">val</span> typeContentNode = detailsNode.<span class="hljs-keyword">get</span>(<span class="hljs-string">"type"</span>)
            <span class="hljs-keyword">val</span> type = typeContentNode?.<span class="hljs-keyword">get</span>(<span class="hljs-string">"content"</span>)?.asText() ?: typeContentNode?.asText() ?: <span class="hljs-string">"string"</span>

            <span class="hljs-keyword">val</span> descriptionContentNode = detailsNode.<span class="hljs-keyword">get</span>(<span class="hljs-string">"description"</span>)
            <span class="hljs-keyword">val</span> description = descriptionContentNode?.<span class="hljs-keyword">get</span>(<span class="hljs-string">"content"</span>)?.asText() ?: descriptionContentNode?.asText()
            ?: <span class="hljs-string">"æ— æè¿°"</span>

            paramsList.add(
                LLMToolProperty(
                    name = paramName,
                    type = type.trim(),
                    description = description.trim()
                )
            )
        }

        <span class="hljs-keyword">return</span> paramsList
    }
}
</code></pre>
<h3 data-id="heading-23">2. å®ç°AI-Agent</h3>
<h4 data-id="heading-24">2.1 ç³»ç»ŸPromptå®šä¹‰</h4>
<p>AIæ˜¯å¦èƒ½é€‰æ‹©å’Œé€‰æ‹©æ˜¯å¦å‡†ç¡®ï¼Œåœ¨æˆ‘ä»¬ä¸è®­ç»ƒAIçš„å‰æä¸‹å°±åªèƒ½é å †å’Œè°ƒæ•´Promptæç¤ºè¾¾åˆ°å‡†ç¡®æ•ˆæœ</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> SystemPromptBase = <span class="hljs-string">"""ä½ æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ AI åŠ©æ‰‹ã€‚ä½ çš„å›å¤å¿…é¡»ä¸¥æ ¼éµå¾ªä»¥ä¸‹è§„åˆ™ï¼Œå›å¤å†…å®¹å¿…é¡»æ˜¯**çº¯å‡€**çš„å·¥å…·è°ƒç”¨ JSON **æˆ–** **çº¯å‡€**çš„è‡ªç„¶è¯­è¨€æ–‡æœ¬ï¼Œç»ä¸å…è®¸æ··åˆã€‚

## I. å·¥å…·è°ƒç”¨æ¨¡å¼ï¼šå†³ç­–ä¸è¾“å‡º ( STRICT JSON MODE )

1. **è§¦å‘æ¡ä»¶ï¼š** ä»…å½“ç”¨æˆ·çš„è¯·æ±‚å†…å®¹ä¸**å¯ç”¨å·¥å…·åˆ—è¡¨ä¸­çš„ä»»ä¸€å·¥å…·æè¿°**ç›´æ¥ç›¸å…³æ—¶ï¼Œæ‰å†³å®šä½¿ç”¨å·¥å…·ã€‚
2. **å¯ç”¨æ€§é™åˆ¶ï¼š** ä½ åªå…è®¸ä½¿ç”¨å½“å‰ä¸Šä¸‹æ–‡ä¸­æä¾›çš„å·¥å…·ã€‚**ä¸¥ç¦**è‡ªè¡Œç¼–é€ ã€çŒœæµ‹æˆ–è°ƒç”¨ä»»ä½•ä¸å­˜åœ¨çš„å·¥å…·æˆ–å‡½æ•°ã€‚
3. **æœ€ç»ˆæ ¼å¼ï¼ˆå¿…é¡»ï¼‰ï¼š** å¦‚æœä½ å†³å®šè°ƒç”¨å·¥å…·ï¼Œä½ çš„å›å¤**å¿…é¡»ä¸”åªèƒ½**æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€**æœªç»ä»»ä½•åŒ…è£¹**çš„ JSON å­—ç¬¦ä¸²ã€‚æ ¼å¼å¿…é¡»ä¸¥æ ¼ä¸ºï¼š
   {"name": "å·¥å…·å", "input": {å‚æ•°å1: å€¼1, å‚æ•°å2: å€¼2}}
   âš ï¸ **å‚æ•°æ³¨æ„ï¼š** `input` çš„å€¼å¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ **JSON å¯¹è±¡ï¼ˆMapï¼‰**ï¼ŒåŒ…å«å·¥å…·æ‰€éœ€çš„æ‰€æœ‰å¿…å¡«å‚æ•°ã€‚
4. **çº¯å‡€è¾“å‡ºï¼ˆæ ¸å¿ƒï¼‰ï¼š** å·¥å…·è°ƒç”¨ JSON **å‰å**åŠ**å†…éƒ¨**ï¼Œ**ç»ä¸å…è®¸**åŒ…å«ä»¥ä¸‹ä»»ä½•å†…å®¹ï¼š
   * Markdown æ ‡è®°ï¼ˆåŒ…æ‹¬ ```ã€**ã€#ï¼‰
   * ä»»ä½•è§£é‡Šã€æ¨ç†ã€æ€è€ƒè¿‡ç¨‹ï¼ˆåŒ…æ‹¬ &lt;think&gt; æ ‡ç­¾ï¼‰
   * é¢å¤–çš„ç©ºè¡Œã€æ¢è¡Œç¬¦æˆ–å¤šä½™çš„ç©ºæ ¼ã€‚
   * ä»»ä½•é™¤ JSON ç»“æ„æœ¬èº«ä»¥å¤–çš„æ–‡æœ¬ã€‚

## II. çº¯æ–‡æœ¬æ¨¡å¼ï¼šç›´æ¥å›å¤ ( PLAIN TEXT MODE )

5. **å›å¤æ¡ä»¶ä¸æ„å›¾ï¼š** å¦‚æœä½ ä¸éœ€è¦è°ƒç”¨å·¥å…·ï¼Œæˆ–è€…ç”¨æˆ·çš„è¯·æ±‚ä¸ä»»ä½•å¯ç”¨å·¥å…·å‡ä¸ç›¸å…³ï¼Œä½ **å¿…é¡»ä½œä¸º AI åŠ©æ‰‹ç›´æ¥ã€å®Œæ•´åœ°å›ç­”ç”¨æˆ·çš„é—®é¢˜æˆ–è¯·æ±‚**ã€‚
6. **æ ¼å¼æ’é™¤ï¼š** åœ¨çº¯æ–‡æœ¬å›å¤ä¸­ï¼Œ**ä¸¥ç¦**åŒ…å«ä»»ä½• JSON æ ¼å¼æ ‡è®°ï¼ˆèŠ±æ‹¬å· {}ã€æ–¹æ‹¬å· []ã€åŒå¼•å· "ï¼‰æˆ–ä»»ä½•å¯èƒ½è¢«è¯¯è¯†åˆ«ä¸ºç»“æ„åŒ–æ•°æ®çš„ç¬¦å·ã€‚å›å¤å¿…é¡»æ˜¯è‡ªç„¶ã€æœ‰å¸®åŠ©çš„è¯­è¨€æ–‡æœ¬ã€‚
## III. æœ€ç»ˆæ ¡éªŒ

7. **å”¯ä¸€æ€§ï¼š** æœ€ç»ˆçš„è¾“å‡º**åªèƒ½**æ˜¯ I æ¨¡å¼ä¸‹çš„**çº¯å‡€ JSON å­—ç¬¦ä¸²**ï¼Œ**æˆ–**æ˜¯ II æ¨¡å¼ä¸‹çš„**çº¯å‡€æ–‡æœ¬**ã€‚ä¸å…è®¸åŒæ—¶å‡ºç°æˆ–æ··åˆã€‚
"""</span>
</code></pre>
<h4 data-id="heading-25">2.2 åˆ›å»ºå¯¹è¯è·¯ç”±</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> Route.<span class="hljs-title">appRoute</span><span class="hljs-params">()</span></span> {
    runBlocking {
        log.info { <span class="hljs-string">"å°è¯•è¿æ¥ MCP æœåŠ¡å™¨..."</span> }
        mcpClient.connectToServer(<span class="hljs-string">"http://127.0.0.1:3000/mcp/sse"</span>)
    }
    post(<span class="hljs-string">"chat"</span>) {
        <span class="hljs-keyword">val</span> userInput = call.receive&lt;UserQuery&gt;()
        call.respond(HttpStatusCode.OK, ResData(mcpProcess(userInput.query)))
    }
}
</code></pre>
<h4 data-id="heading-26">2.3 åˆ›å»ºå¯¹è¯æµç¨‹(æ ¸å¿ƒ)</h4>
<blockquote>
<h5 data-id="heading-27">åŸºäºMCPä½¿ç”¨å·¥å…·çš„å¯¹è¯æµç¨‹</h5>
<ol>
<li>
<p><strong>åˆå§‹è¯·æ±‚ä¸å†³ç­–ï¼š</strong></p>
<ul>
<li><strong>è¾“å…¥ï¼š</strong> æ¥æ”¶<code>ç”¨æˆ·è¯¢é—®</code>å’Œ<code>ç³»ç»Ÿçº¦æŸ</code>åŠ <code>å·¥å…·æè¿°</code>ã€‚</li>
<li><strong>åŠ¨ä½œï¼š</strong> ç¬¬ä¸€æ¬¡è¯¢é—® LLM è¿›è¡Œ<strong>å·¥å…·é€‰æ‹©</strong> ã€‚</li>
</ul>
</li>
<li>
<p><strong>å·¥å…·é€‰æ‹©è§£æï¼š</strong></p>
<ul>
<li><strong>ç»“æœï¼š</strong> è§£æ LLM çš„å›å¤ï¼Œåˆ¤æ–­æ˜¯ç›´æ¥å›å¤ï¼Œè¿˜æ˜¯å·¥å…·è°ƒç”¨è¯·æ±‚ ã€‚</li>
</ul>
</li>
<li>
<p><strong>å·¥å…·æ‰§è¡Œ</strong></p>
<ul>
<li><strong>è°ƒç”¨ï¼š</strong> è‹¥ LLM é€‰æ‹©å·¥å…·ï¼Œä½¿ç”¨ <code>MCPClient</code> è¿›è¡Œè¿œç«¯å·¥å…·è°ƒç”¨ã€‚</li>
<li><strong>è·å–ï¼š</strong> é˜»å¡ç­‰å¾…å¹¶æ¥æ”¶å·¥å…·ç»“æœ ã€‚</li>
</ul>
</li>
<li>
<p><strong>äºŒæ¬¡è¯¢é—®ä¸ç»“æŸ</strong></p>
<ul>
<li><strong>è¾“å…¥ï¼š</strong> å°†å·¥å…·ç»“æœä½œä¸º<strong>å¯¹è¯å†å²</strong>çš„ä¸€éƒ¨åˆ†ã€‚</li>
<li><strong>åŠ¨ä½œï¼š</strong> ç¬¬äºŒæ¬¡è¯¢é—® LLM è¿›è¡Œ<strong>æœ€ç»ˆæ¨ç†ç”Ÿæˆå›å¤å“åº”ç»™å®¢æˆ·ç«¯</strong>ã€‚</li>
</ul>
</li>
</ol>
<hr/>
</blockquote>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> RoutingContext.<span class="hljs-title">mcpProcess</span><span class="hljs-params">(input: <span class="hljs-type">String</span>)</span></span>: String {
    <span class="hljs-comment">// åˆ›å»ºé¡¶å±‚ç¬¬ä¸€æ¬¡ä¼šè¯ï¼Œå¸¦ä¸Šå·¥å…·æè¿°å’Œç³»ç»Ÿçº¦æŸè§„åˆ™</span>
    <span class="hljs-keyword">val</span> topPrompt = SystemPromptBase.trimIndent() + <span class="hljs-string">"\n\n"</span> + mcpClient.toolsFormatStr
    <span class="hljs-keyword">val</span> aiSelectPrompt = prompt(UUID.randomUUID().toString()) {
        system(topPrompt)
        user(input)
    }
    <span class="hljs-comment">// è·å–å·¥å…·é€‰æ‹©ç»“æœ</span>
    <span class="hljs-keyword">val</span> messages = askAI(aiSelectPrompt).toText(<span class="hljs-literal">true</span>, <span class="hljs-string">"aié€‰æ‹©å·¥å…·è¯¢é—®"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (<span class="hljs-keyword">val</span> result = selectTool(messages)) {
        <span class="hljs-keyword">is</span> SelectResult.NoSelect -&gt; { <span class="hljs-comment">// AIæ²¡é€‰æ‹©å·¥å…·ç›´æ¥è¿”å›AIå›å¤</span>
            log.info { <span class="hljs-string">"AIæœªé€‰æ‹©å·¥å…·,ç›´æ¥è¿”å›: <span class="hljs-variable">$messages</span>"</span> }
            result.message
        }

        <span class="hljs-keyword">is</span> SelectResult.Select -&gt; { <span class="hljs-comment">// AIé€‰æ‹©å·¥å…·åè¿›è¡Œå·¥å…·è°ƒç”¨</span>
            log.info { <span class="hljs-string">"AIå·²é€‰æ‹©å·¥å…·: <span class="hljs-subst">${result.name}</span>,å‚æ•°: <span class="hljs-subst">${result.input}</span>"</span> }
            <span class="hljs-comment">//ä½¿ç”¨mcpClientè¿›è¡Œè¿œç«¯å·¥å…·è°ƒç”¨</span>
            <span class="hljs-keyword">val</span> toolRes = mcpClient.executeTool(result.name, result.input)
            log.info { <span class="hljs-string">"å·¥å…·è¿”å›: <span class="hljs-variable">$toolRes</span>"</span> }
            <span class="hljs-comment">// å¸¦å·¥å…·é…åˆå†å²å¯¹è¯è®©AIä¸€å¹¶åˆ†æå›å¤</span>
            <span class="hljs-keyword">val</span> resultPrompt = prompt(aiSelectPrompt) {
                system(<span class="hljs-string">"ä½¿ç”¨çš„å·¥å…·<span class="hljs-subst">${result.name}</span>å·²è¿”å›çš„æ•°æ®æ—¶:<span class="hljs-subst">${toolRes}</span>ï¼ŒåŸºäºè¿™ä¸ªå·¥å…·ç»™çš„æ•°æ®å»æ€è€ƒå†æ¬¡å›å¤ä¹‹å‰çš„è¯¢é—®ï¼Œå¹¶ä¸”ä¸è¦å¸¦ä¸Šå·¥å…·çš„ä»»ä½•ä¿¡æ¯"</span>)
            }
            askAI(resultPrompt).toText(<span class="hljs-literal">true</span>, <span class="hljs-string">"aiå¸¦ä¸Šå·¥å…·ç»“æœå»æ€è€ƒ"</span>)
        }
    }
}
</code></pre>
<h4 data-id="heading-28">å®Œæ•´AI-Agent</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResData</span>(<span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span>: String)
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserQuery</span>(<span class="hljs-keyword">val</span> query: String)
<span class="hljs-keyword">sealed</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SelectResult</span> {
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NoSelect</span>(<span class="hljs-keyword">val</span> message: String) : SelectResult()
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Select</span>(<span class="hljs-keyword">val</span> name: String, <span class="hljs-keyword">val</span> input: Map&lt;String, Any&gt;) : SelectResult()
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> log = KotlinLogging.logger { }


<span class="hljs-function"><span class="hljs-keyword">fun</span> Route.<span class="hljs-title">appRoute</span><span class="hljs-params">()</span></span> {
    runBlocking {
        log.info { <span class="hljs-string">"å°è¯•è¿æ¥ MCP æœåŠ¡å™¨..."</span> }
        mcpClient.connectToServer(<span class="hljs-string">"http://127.0.0.1:3000/mcp/sse"</span>)
    }
    post(<span class="hljs-string">"chat"</span>) {
        <span class="hljs-keyword">val</span> userInput = call.receive&lt;UserQuery&gt;()
        call.respond(HttpStatusCode.OK, ResData(mcpProcess(userInput.query)))
    }
}

<span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> RoutingContext.<span class="hljs-title">mcpProcess</span><span class="hljs-params">(input: <span class="hljs-type">String</span>)</span></span>: String {
    <span class="hljs-comment">// åˆ›å»ºé¡¶å±‚ç¬¬ä¸€æ¬¡ä¼šè¯ï¼Œå¸¦ä¸Šå·¥å…·æè¿°å’Œç³»ç»Ÿçº¦æŸè§„åˆ™</span>
    <span class="hljs-keyword">val</span> topPrompt = SystemPromptBase.trimIndent() + <span class="hljs-string">"\n\n"</span> + mcpClient.toolsFormatStr
    <span class="hljs-keyword">val</span> aiSelectPrompt = prompt(UUID.randomUUID().toString()) {
        system(topPrompt)
        user(input)
    }
    <span class="hljs-comment">// è·å–å·¥å…·é€‰æ‹©ç»“æœ</span>
    <span class="hljs-keyword">val</span> messages = askAI(aiSelectPrompt).toText(<span class="hljs-literal">true</span>, <span class="hljs-string">"aié€‰æ‹©å·¥å…·è¯¢é—®"</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (<span class="hljs-keyword">val</span> result = selectTool(messages)) {
        <span class="hljs-keyword">is</span> SelectResult.NoSelect -&gt; { <span class="hljs-comment">// AIæ²¡é€‰æ‹©å·¥å…·ç›´æ¥è¿”å›AIå›å¤</span>
            log.info { <span class="hljs-string">"AIæœªé€‰æ‹©å·¥å…·,ç›´æ¥è¿”å›: <span class="hljs-variable">$messages</span>"</span> }
            result.message
        }

        <span class="hljs-keyword">is</span> SelectResult.Select -&gt; { <span class="hljs-comment">// AIé€‰æ‹©å·¥å…·åè¿›è¡Œå·¥å…·è°ƒç”¨</span>
            log.info { <span class="hljs-string">"AIå·²é€‰æ‹©å·¥å…·: <span class="hljs-subst">${result.name}</span>,å‚æ•°: <span class="hljs-subst">${result.input}</span>"</span> }
            <span class="hljs-comment">//ä½¿ç”¨mcpClientè¿›è¡Œè¿œç«¯å·¥å…·è°ƒç”¨</span>
            <span class="hljs-keyword">val</span> toolRes = mcpClient.executeTool(result.name, result.input)
            log.info { <span class="hljs-string">"å·¥å…·è¿”å›: <span class="hljs-variable">$toolRes</span>"</span> }
            <span class="hljs-comment">// å¸¦å·¥å…·é…åˆå†å²å¯¹è¯è®©AIä¸€å¹¶åˆ†æå›å¤</span>
            <span class="hljs-keyword">val</span> resultPrompt = prompt(aiSelectPrompt) {
                system(<span class="hljs-string">"ä½¿ç”¨çš„å·¥å…·<span class="hljs-subst">${result.name}</span>å·²è¿”å›çš„æ•°æ®æ—¶:<span class="hljs-subst">${toolRes}</span>ï¼ŒåŸºäºè¿™ä¸ªå·¥å…·ç»™çš„æ•°æ®å»æ€è€ƒå†æ¬¡å›å¤ä¹‹å‰çš„è¯¢é—®ï¼Œå¹¶ä¸”ä¸è¦å¸¦ä¸Šå·¥å…·çš„ä»»ä½•ä¿¡æ¯"</span>)
            }
            askAI(resultPrompt).toText(<span class="hljs-literal">true</span>, <span class="hljs-string">"aiå¸¦ä¸Šå·¥å…·ç»“æœå»æ€è€ƒ"</span>)
        }
    }
}

<span class="hljs-comment">/**
 * åŸºäºå’ŒAIçº¦å®šçš„`{"name": "å·¥å…·å", "input": {å‚æ•°å1: å€¼1, å‚æ•°å2: å€¼2}}`è§„åˆ™å»è§£æAIæ˜¯å¦é€‰æ‹©äº†å·¥å…·
 * 
 * <span class="hljs-doctag">@param</span> messages AIå“åº”æ–‡æœ¬
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">selectTool</span><span class="hljs-params">(messages: <span class="hljs-type">String</span>)</span></span>: SelectResult {
    <span class="hljs-keyword">if</span> (!messages.startsWith(<span class="hljs-string">"{"</span>) || !messages.endsWith(<span class="hljs-string">"}"</span>)) {
        <span class="hljs-keyword">return</span> SelectResult.NoSelect(messages)
    }
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">val</span> toolCall = mapper.readValue&lt;SelectResult.Select&gt;(messages)
        <span class="hljs-keyword">if</span> (toolCall.name.isBlank()) {
            <span class="hljs-keyword">return</span> SelectResult.NoSelect(messages)
        }
        <span class="hljs-keyword">return</span> toolCall
    } <span class="hljs-keyword">catch</span> (e: Exception) {
        log.error(e) { <span class="hljs-string">"è§£æå·¥å…·è°ƒç”¨å¤±è´¥,åŸå§‹ä¿¡æ¯:<span class="hljs-subst">${messages}</span>"</span> }
        <span class="hljs-keyword">return</span> SelectResult.NoSelect(messages)
    }
}

<span class="hljs-comment">/**
 * å°†æ¶ˆæ¯å“åº”åˆ—è¡¨è½¬æ¢ä¸ºå‹ç¼©åçš„æ–‡æœ¬å†…å®¹
 *
 * <span class="hljs-doctag">@param</span> showRawThink æ˜¯å¦æ˜¾ç¤ºAIåŸå§‹æ€è€ƒå†…å®¹ï¼Œé»˜è®¤ä¸ºfalse
 * <span class="hljs-doctag">@param</span> step æ­¥éª¤æ ‡è¯†ç¬¦ï¼Œç”¨äºæ—¥å¿—è¾“å‡ºï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²
 * <span class="hljs-doctag">@return</span> æ¸…ç†å¹¶å‹ç¼©åçš„æ–‡æœ¬å†…å®¹
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> List<span class="hljs-type">&lt;Message.Response&gt;</span>.<span class="hljs-title">toText</span><span class="hljs-params">(showRawThink: <span class="hljs-type">Boolean</span> = <span class="hljs-literal">false</span>, step: <span class="hljs-type">String</span> = <span class="hljs-string">""</span>)</span></span>: String {
    <span class="hljs-comment">// åˆå¹¶æ‰€æœ‰å“åº”å†…å®¹</span>
    <span class="hljs-keyword">val</span> mergeText = joinToString(separator = <span class="hljs-string">""</span>) { it.content }
    <span class="hljs-keyword">if</span> (showRawThink) {
        log.info { <span class="hljs-string">"<span class="hljs-variable">$step</span> AIåŸå§‹æ€è€ƒ:<span class="hljs-subst">${mergeText}</span>"</span> }
    }

    <span class="hljs-comment">// ç§»é™¤&lt;think&gt;æ ‡ç­¾åŠå…¶åŒ…å«çš„å†…å®¹</span>
    <span class="hljs-keyword">val</span> thinkRegex = Regex(<span class="hljs-string">"""&lt;think&gt;[\s\S]*?&lt;/think&gt;"""</span>)
    <span class="hljs-keyword">val</span> cleanedContent = mergeText.replace(thinkRegex, <span class="hljs-string">""</span>)
    <span class="hljs-comment">// å‹ç¼©è¿ç»­çš„ç©ºç™½å­—ç¬¦ä¸ºå•ä¸ªç©ºæ ¼</span>
    <span class="hljs-keyword">val</span> whitespaceRegex = Regex(<span class="hljs-string">"""\s+"""</span>)
    <span class="hljs-keyword">val</span> compressedContent = cleanedContent.replace(whitespaceRegex, <span class="hljs-string">" "</span>)
    <span class="hljs-keyword">return</span> compressedContent.trim()
}

<span class="hljs-comment">/**
 * å‘AIæ¨¡å‹å‘é€è¯¢é—®å¹¶è·å–å“åº”ç»“æœ
 *
 * <span class="hljs-doctag">@param</span> prompt è¦å‘é€ç»™AIæ¨¡å‹çš„æç¤ºä¿¡æ¯
 * <span class="hljs-doctag">@return</span> AIæ¨¡å‹è¿”å›çš„æ¶ˆæ¯å“åº”åˆ—è¡¨
 */</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> RoutingContext.<span class="hljs-title">askAI</span><span class="hljs-params">(prompt: <span class="hljs-type">Prompt</span>)</span></span>: List&lt;Message.Response&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">//Koogçš„æ¨¡å‹æ”¶å½•å¹¶éƒ¨ç½²å¾ˆå®Œæ•´ï¼Œæœ‰ä¸€äº›å¾—è‡ªå·±å»å®šä¹‰ ç‰¹åˆ«æ˜¯Ollamaä¸­çš„</span>
        <span class="hljs-keyword">return</span> llm().execute(prompt, DEEPSEEK_R1_1_5B)
    } <span class="hljs-keyword">catch</span> (e: Exception) {
        log.error(e) { <span class="hljs-string">"LLMæ‰§è¡Œå¤±è´¥"</span> }
        <span class="hljs-keyword">throw</span> e
    }
}
</code></pre>
<h3 data-id="heading-29">åˆ›å»ºAI-AgentæœåŠ¡</h3>
<h4 data-id="heading-30">yamlé…ç½®</h4>
<p>é€‰æ‹©KOOGçš„KtorSDKä»¥ååªéœ€è¦é…ç½®ä»£ç†æ–¹å’Œåœ°å€å³å¯ï¼Œå¦‚æœæœ‰å¯†é’¥éœ€è¦å†™å…¥<code>apikey</code></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.koog.ai%2Fktor-plugin%2F" target="_blank" title="https://docs.koog.ai/ktor-plugin/" ref="nofollow noopener noreferrer">Ktor - Koog</a></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">koog:</span>
  <span class="hljs-attr">ollama:</span>
    <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">baseUrl:</span> <span class="hljs-string">http://localhost:11434</span>
<span class="hljs-attr">ktor:</span>
  <span class="hljs-attr">application:</span>
        <span class="hljs-attr">modules:</span>
            <span class="hljs-bullet">-</span> <span class="hljs-string">com.setruth.mcp.client.MainKt.module</span>
  <span class="hljs-attr">deployment:</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">3001</span>
</code></pre>
<h4 data-id="heading-31">ä¸»ç¨‹åº</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> mapper = jacksonObjectMapper()
<span class="hljs-keyword">val</span> mcpClient = MCPClient()
<span class="hljs-comment">/**
 *
 * <span class="hljs-doctag">@author</span> setruth
 * <span class="hljs-doctag">@date</span> 2025/12/13
 * <span class="hljs-doctag">@time</span> 13:27
 */</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">main</span><span class="hljs-params">(args: <span class="hljs-type">Array</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span>: <span class="hljs-built_in">Unit</span> = io.ktor.server.netty.EngineMain.main(args)


<span class="hljs-function"><span class="hljs-keyword">fun</span> Application.<span class="hljs-title">module</span><span class="hljs-params">()</span></span> {
    monitor.subscribe(ApplicationStopping) { application -&gt;
        mcpClient.close()
    }
    install(ContentNegotiation) {
        jackson()
    }
    install(Koog)
    install(SSE)
    install(CORS){
        anyMethod()
        anyHost()
        allowCredentials = <span class="hljs-literal">true</span>
        allowNonSimpleContentTypes = <span class="hljs-literal">true</span>
    }
    routing {
        staticResources(<span class="hljs-string">"/"</span>, <span class="hljs-string">"static"</span>)
        appRoute()
    }
}
</code></pre>
<h3 data-id="heading-32">AI-Agentè¿è¡Œæµ‹è¯•</h3>
<p>è¿è¡Œåæˆ‘ä»¬çœ‹åˆ°è·å–åˆ°äº†å·¥å…·ï¼Œæ¥ä¸‹æ¥è¿æ¥æˆ‘ä»¬çš„<code>localhost:3000/chat</code>å»é€šè¿‡AI-Agentå’ŒAIå¯¹è¯çœ‹æ˜¯å¦èƒ½æ­£ç¡®é€‰æ‹©å·¥å…·</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a86c1897acb84ac08615bed4e3bd93e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS290bGluS1VH6LS15bee:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312029&amp;x-signature=3LIxn2%2F6lp%2FjwWB9CDL0MOUTIBs%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-33">å®è·µç»“æœ</h2>
<blockquote>
<p>å½“è¯¢é—®AIåå­—çš„æ—¶å€™AIæ²¡æœ‰é€‰æ‹©å·¥å…·ç›´æ¥å›å¤æˆ‘ä»¬äº†âœ”ï¸</p>
<p>å½“æˆ‘ä»¬é—®æ—¶é—´çš„æ—¶å€™AIé€‰æ‹©äº†æˆ‘ä»¬çš„è·å–æ—¶é—´å·¥å…·æ‹¿åˆ°äº†æ—¶é—´å»è¿›è¡Œåˆ†æå›å¤âœ”ï¸</p>
</blockquote>
<p>è‡ªæ­¤æˆ‘ä»¬åˆ©ç”¨MCPæœåŠ¡å¯¹AIè¿›è¡Œäº†èƒ½åŠ›å¢å¼ºï¼Œå¹¶ä¸”æ˜¯åŸºäºæˆ‘ä»¬ç»™çš„æ•°æ®æ¥è¿›è¡Œå›å¤å›ç­”ï¼Œä¿è¯äº†å‡†ç¡®æ€§ä¹Ÿé¿å…äº†å¹»è§‰é—®é¢˜</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fdf0b6d245be440581d4bc8738a06772~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgS290bGluS1VH6LS15bee:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312029&amp;x-signature=4rC5mHFgY5Jjp8dnuQp9kfyHux0%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-34">æ³¨æ„äº‹é¡¹</h2>
<p>AIæ¨ç†é€‰æ‹©å·¥å…·å¾ˆå¤§ä¸€å®šç¨‹åº¦ä¸Šå¾—çœ‹AIæœ¬èº«ï¼Œå°æ¨¡å‹æœ¬èº«æ¨ç†èƒ½åŠ›æ˜¯éå¸¸å·®åŠ²çš„ï¼Œå¾ˆéš¾æŒ‰ç…§ä½ çš„è§„èŒƒæ¥å®Œæ•´å“åº”ç»™ä½ ï¼Œè€Œä¸”å¯¹ä¸Šä¸‹æ–‡çš„åˆ†æä¹Ÿæœ‰é™ï¼Œæˆ‘æ‹¿1.5Bå½“æ—¶éƒ½è°ƒäº†å¥½ä¸€ä¼šPromptï¼Œæ‹¿7Bè™½ç„¶æ¨ç†èƒ½åŠ›å¥½ç‚¹ï¼Œä½†æ˜¯å¯¹äºè¿™ç§é•¿Promptçš„çº¦æŸAIå¾ˆå¤šæ—¶å€™ä¹Ÿæ¯”è¾ƒæ­»è„‘ç­‹ï¼Œå½“æˆ‘æ¢åœ¨çº¿APIæ¯”å¦‚Deepseekåï¼Œå¾ˆå®Œç¾çš„è¾¾åˆ°äº†é¢„è®¡æ•ˆæœã€‚æ‰€ä»¥å½“è°ƒPromptæ­»æ´»æ•ˆæœä¸å¯¹çš„æƒ…å†µä¸‹å»ºè®®è¯•è¯•æ¢ä¸ªå¤§ç‚¹çš„æ¨¡å‹ï¼Œæ¨èå…ˆæ‹¿åœ¨çº¿AIæ¥å…¥æ¥è¿›è¡ŒPromptè°ƒæ•´ï¼Œå†æ ¹æ®å°ç‚¹çš„æ¨¡å‹é€æ­¥ç²¾ç»†åŒ–ï¼Œå¹¶ä¸”å¤§æ¨¡å‹ä¹Ÿèƒ½ç†è§£æ›´å¤šçš„å·¥å…· è€Œä¸åªæ˜¯ç®€å•çš„æ—¶é—´è·å–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸŒ WebAIGCçš„æŠ€æœ¯æ™®æƒ ï¼šé™ä½åˆ›ä½œé—¨æ§›è¿˜æ˜¯åŠ å‰§æ•°å­—é¸¿æ²Ÿï¼Ÿ]]></title>    <link>https://juejin.cn/post/7583234966634643490</link>    <guid>https://juejin.cn/post/7583234966634643490</guid>    <pubDate>2025-12-14T10:20:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583234966634643490" data-draft-id="7583168260797300776" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸŒ WebAIGCçš„æŠ€æœ¯æ™®æƒ ï¼šé™ä½åˆ›ä½œé—¨æ§›è¿˜æ˜¯åŠ å‰§æ•°å­—é¸¿æ²Ÿï¼Ÿ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,AIGC"/> <meta itemprop="datePublished" content="2025-12-14T10:20:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸŒ WebAIGCçš„æŠ€æœ¯æ™®æƒ ï¼šé™ä½åˆ›ä½œé—¨æ§›è¿˜æ˜¯åŠ å‰§æ•°å­—é¸¿æ²Ÿï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T10:20:19.000Z" title="Sun Dec 14 2025 10:20:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§© ä¸€ã€AIGCçš„å´›èµ·ï¼šåˆ›é€ åŠ›çš„â€œè’¸æ±½æœºæ—¶ä»£â€</h2>
<p>å›é¡¾äººç±»ç§‘æŠ€å²ï¼Œæ¯æ¬¡<strong>ç®—åŠ›çš„è·ƒè¿</strong>éƒ½ä¼šå¸¦æ¥ä¸€åœºæ€æƒ³ä¸ç”Ÿäº§åŠ›çš„é©å‘½ã€‚ä»æ‰“å­”å¡åˆ°GPUå¹¶è¡Œè®¡ç®—ï¼Œå¦‚ä»Šæˆ‘ä»¬è¿æ¥äº†â€œ<strong>AIGCï¼ˆAI Generated Contentï¼‰</strong> â€çš„æ´ªæµã€‚<br/>
è€Œâ€œ<strong>WebAIGC</strong>â€è¿™ä¸€æ¦‚å¿µï¼Œåˆ™æ˜¯AIGCæŠ€æœ¯ä¸Webç”Ÿæ€çš„ç»“åˆä½“â€”â€”å°±åƒè’¸æ±½æœºè£…ä¸Šäº†è½®å­ï¼Œä»å·¥å‚é©¶å…¥äº†æ¯ä¸ªäººçš„æµè§ˆå™¨ã€‚</p>
<p>è¿‡å»ï¼Œåˆ›ä½œé«˜è´¨é‡ç½‘é¡µã€æ’ç”»ã€éŸ³ä¹æˆ–æ–‡ç« éœ€è¦æ‰å®çš„çŸ¥è¯†å‚¨å¤‡ä¸è€å¿ƒè°ƒè¯•çš„æŠ€èƒ½ã€‚<br/>
ä½†ä»Šå¤©ï¼Œä¸€ä¸ªæ–°äººä¹Ÿèƒ½åœ¨å‡ åˆ†é’Ÿå†…ç”Ÿæˆç‚«é…·çš„ç½‘é¡µã€è¯—æ„çš„æ–‡ç« ã€ç”šè‡³æ¸¸æˆåŸå‹ã€‚</p>
<blockquote>
<p>ğŸ§™â€â™‚ï¸ å¯ä»¥è¯´ï¼ŒAIæˆäº†â€œæ•°å­—æ—¶ä»£çš„ç»‡å¥³â€ï¼Œè€Œäººç±»æ­£åœ¨å­¦ç€å½“â€œæ”¾ç¾Šçš„æ‡’æ±‰â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">âš™ï¸ äºŒã€åº•å±‚è§†è§’ï¼šä»ç®—å­åˆ°æµè§ˆå™¨çš„â€œåˆ›ä½œæµæ°´çº¿â€</h2>
<p>ä»ç³»ç»Ÿå±‚è§’åº¦çœ‹ï¼ŒWebAIGCçš„èƒŒåå¹¶ä¸æ˜¯â€œé­”æ³•â€ï¼Œè€Œæ˜¯ä¸€åœºåºå¤§çš„è®¡ç®—åä½œã€‚</p>
<h3 data-id="heading-2">ğŸ§  1. æ¨¡å‹ç®—å­ä¸Tokenæµè½¬</h3>
<p>åœ¨æ·±åº¦å­¦ä¹ æ¡†æ¶åº•å±‚ï¼Œæ¯ä¸ªAIGCç”Ÿæˆç»“æœéƒ½æ¥è‡ª<strong>ç®—å­ï¼ˆOperatorï¼‰<strong>çš„å±‚å±‚è°ƒç”¨å’Œ</strong>Tokenæ¦‚ç‡åˆ†å¸ƒ</strong>çš„é‡é‡‡æ ·ã€‚<br/>
æ¯ä¸€æ¬¡ä½ è¾“å…¥ä¸€å¥æç¤ºè¯ï¼ˆpromptï¼‰ï¼Œå®è´¨ä¸Šæ˜¯è§¦å‘äº†ä¸€åœºå¤šç»´åº¦çš„å‘é‡å¬å”¤ä»ªå¼ã€‚<br/>
ç³»ç»Ÿä¼šå°†æ–‡æœ¬æ˜ å°„æˆé«˜ç»´å‘é‡ï¼Œåœ¨ä¸€ä¸ªåºå¤§çš„è¯­ä¹‰ç©ºé—´ä¸­â€œæ‰©æ•£â€ä¸â€œæ”¶æ•›â€ï¼Œç›´è‡³ç”Ÿæˆç¬¦åˆè¯­å¢ƒçš„è¾“å‡ºã€‚</p>
<h3 data-id="heading-3">ğŸŒ 2. è·¨ç«¯éƒ¨ç½²ä¸æ¨ç†ä¼˜åŒ–</h3>
<p>ä¸ºäº†è®©AIGCåœ¨ç½‘é¡µç«¯ä¹Ÿèƒ½æµç•…è¿è¡Œï¼Œåº•å±‚é‡‡ç”¨äº†å¤šç§ä¼˜åŒ–ç­–ç•¥ï¼š</p>
<ul>
<li><strong>WebAssemblyï¼ˆWASMï¼‰</strong> ï¼šè®©C++æˆ–CUDAçš„ç®—åŠ›é­”æ³•èƒ½å®‰å…¨åœ°åœ¨æµè§ˆå™¨ä¸­æ–½å±•ã€‚</li>
<li><strong>ONNX Runtime Web</strong>ï¼šè·¨æ¡†æ¶æ¨¡å‹æ¨ç†ï¼Œåƒæ˜¯AIçš„â€œé€šç”¨ç¿»è¯‘å™¨â€ã€‚</li>
<li><strong>é‡åŒ–ä¸è’¸é¦æŠ€æœ¯</strong>ï¼šå‡å°‘æ¨¡å‹ä½“ç§¯ï¼Œç‰ºç‰²è½»å¾®ç²¾åº¦ï¼Œè·å¾—â€œä¸æ»‘ä½“éªŒâ€ã€‚</li>
</ul>
<p>è¿™äº›æŠ€æœ¯è®©AIä¸å†æ˜¯â€œäº‘ç«¯çš„ç¥è°•â€ï¼Œè€Œå˜æˆâ€œç”¨æˆ·æœ¬åœ°çš„åˆä½œè€…â€ã€‚</p>
<hr/>
<h2 data-id="heading-4">âœ¨ ä¸‰ã€æŠ€æœ¯æ™®æƒ ï¼šæ°‘ä¸»åŒ–åˆ›ä½œçš„æ˜¥å¤©ï¼Ÿ</h2>
<p>WebAIGCçš„æŠ€æœ¯æ™®æƒ ç¡®å®åœ¨<strong>é™ä½åˆ›ä½œé—¨æ§›</strong>ã€‚</p>
<h3 data-id="heading-5">ğŸ¨ 1. äººäººéƒ½æ˜¯åˆ›ä½œè€…</h3>
<p>è¿‡å»ï¼Œä¸€ä¸ªç½‘é¡µå¯èƒ½éœ€è¦æŒæ¡CSSã€JSã€åç«¯æ¡†æ¶ï¼›<br/>
ç°åœ¨ï¼Œåªè¦è¾“å…¥ä¸€å¥è¯ï¼šâ€œå¸®æˆ‘ç”Ÿæˆä¸€ä¸ªå¸¦æ˜Ÿç©ºèƒŒæ™¯çš„äº¤äº’å¼åç‰‡é¡µâ€ï¼ŒAIå°±èƒ½ç»™å‡ºè¿‘ä¹å®Œç¾çš„ç»“æœã€‚<br/>
ç”šè‡³ä½ å¯ä»¥ç›´æ¥è¿è¡Œä¸‹é¢è¿™æ®µ <strong>JS ç¤ºä¾‹</strong>ï¼Œä½“éªŒâ€œAIä»£ç é­”æ³•â€ ğŸŒ ï¼š</p>
<pre><code class="hljs language-css" lang="css">// ğŸª„ åŸºäºAIGCç†å¿µçš„ç®€æ˜“ç½‘é¡µç”Ÿæˆå™¨æ¨¡æ‹Ÿ
function generatePage(prompt) {
  const moods = <span class="hljs-selector-attr">[<span class="hljs-string">"âœ¨"</span>, <span class="hljs-string">"ğŸ”¥"</span>, <span class="hljs-string">"ğŸŒˆ"</span>, <span class="hljs-string">"ğŸ§ "</span>]</span>;
  const randomMood = moods<span class="hljs-selector-attr">[Math.floor(Math.random() * moods.length)]</span>;
  
  return `
    &lt;<span class="hljs-selector-tag">div</span> style="<span class="hljs-attribute">font-family</span>:Arial; <span class="hljs-attribute">text-align</span>:center; <span class="hljs-attribute">padding</span>:<span class="hljs-number">2rem</span>;"&gt;
      &lt;<span class="hljs-selector-tag">h1</span>&gt;${randomMood} AIGC åˆ›ä½œç»“æœ&lt;/<span class="hljs-selector-tag">h1</span>&gt;
      &lt;<span class="hljs-selector-tag">p</span>&gt;Prompt: ${prompt}&lt;/<span class="hljs-selector-tag">p</span>&gt;
      &lt;<span class="hljs-selector-tag">p</span> style="<span class="hljs-attribute">color</span>:gray;"&gt;ç½‘é¡µç”±AIæƒ³è±¡ç”Ÿæˆï¼Œç”¨å¿ƒè°ƒæ ¡çš„äººç±»åŠ æŒã€‚&lt;/<span class="hljs-selector-tag">p</span>&gt;
    &lt;/<span class="hljs-selector-tag">div</span>&gt;
  `;
}

// ç¤ºä¾‹è°ƒç”¨
document<span class="hljs-selector-class">.body</span><span class="hljs-selector-class">.innerHTML</span> = generatePage("ç”Ÿæˆä¸€é¡µè®²è¿°æ•°å­—å¹³æƒçš„ç½‘é¡µ");
</code></pre>
<p>è¿™ç§â€œè°ƒç”¨å³åˆ›é€ â€çš„èŒƒå¼ï¼Œè®©æŠ€æœ¯ä¸è‰ºæœ¯ä¹‹é—´çš„è¾¹ç•Œé€æ¸æ¨¡ç³Šã€‚</p>
<hr/>
<h2 data-id="heading-6">ğŸŒŠ å››ã€éšå¿§ï¼šæŠ€æœ¯æ™®æƒ ï¼Œè¿˜æ˜¯æ•°å­—é¸¿æ²Ÿçš„å¦ä¸€ç§åŠ å‰§ï¼Ÿ</h2>
<p>AIGCçš„æ™®æƒ ä¹Ÿéšè—ç€ä¸€ä¸ªæ‚–è®ºï¼š<br/>
<strong>å½“é—¨æ§›é™ä½æ—¶ï¼Œæ–°çš„é—¨æ§›åˆåœ¨æ›´é«˜çš„ç»´åº¦æ‚„ç„¶å‡ºç°ã€‚</strong></p>
<h3 data-id="heading-7">ğŸ§© 1. ç®—åŠ›é¸¿æ²Ÿ</h3>
<p>è¡¨é¢ä¸Šï¼Œäººäººå¯ä»¥ç”¨AIåˆ›ä½œï¼›ä½†åº•å±‚ç®—åŠ›ä¾ç„¶æŒæ¡åœ¨å°‘æ•°å¤§æ¨¡å‹å‚å•†æ‰‹ä¸­ã€‚<br/>
æƒ³è¦â€œè‡ªç”±â€ç”Ÿæˆé«˜æ¸…åŠ¨æ€å†…å®¹ï¼Œä½ å¯èƒ½éœ€è¦å¼ºå¤§çš„GPUæˆ–ä»˜è´¹APIã€‚</p>
<blockquote>
<p>è´«ç©·é™åˆ¶äº†åˆ›é€ åŠ›ï¼Œä¹Ÿé™åˆ¶äº†ç®—åŠ›çš„å¸¦å®½ã€‚</p>
</blockquote>
<h3 data-id="heading-8">ğŸ”’ 2. æ•°æ®ä¸ç‰ˆæƒé—®é¢˜</h3>
<p>AIçš„â€œçŸ¥è¯†â€å¾€å¾€æ¥è‡ªæµ·é‡æ•°æ®çš„è®­ç»ƒã€‚åˆ›ä½œæ°‘ä¸»åŒ–çš„åŒæ—¶ï¼Œä¹Ÿæ©ç›–äº†<strong>åŸåˆ›æ€§çš„ç¨€é‡Š</strong>ã€‚<br/>
æœªæ¥çš„æ•°å­—åˆ›ä½œï¼Œä¹Ÿè®¸è¦é¢å¯¹ä¸€ä¸ªæ›´å“²å­¦çš„é—®é¢˜ï¼š</p>
<blockquote>
<p>â€œå½“æ¯ä¸ªäººéƒ½èƒ½åˆ›é€ å†…å®¹ï¼Œå†…å®¹æœ¬èº«è¿˜å…·å¤‡æ„ä¹‰å—ï¼Ÿâ€</p>
</blockquote>
<h3 data-id="heading-9">ğŸ§­ 3. æ•™è‚²ä¸è®¤çŸ¥å·®è·</h3>
<p>æŒæ¡Promptå·¥ç¨‹æŠ€å·§ã€ç†è§£æ¨¡å‹åå·®ï¼Œè¿™äº›ä»éœ€è¦æŠ€æœ¯ç´ å…»ã€‚<br/>
æ–°çš„â€œæ–‡ç›²â€ï¼Œä¸å†æ˜¯ä¸è¯†å­—çš„äººï¼Œè€Œæ˜¯ä¸ä¼šä¸AIå¯¹è¯çš„äººã€‚</p>
<hr/>
<h2 data-id="heading-10">ğŸš€ äº”ã€æœªæ¥ç•…æƒ³ï¼šè®©AIæˆä¸ºæ¡¥è€Œéå¢™</h2>
<p>è¦é¿å…æ•°å­—é¸¿æ²Ÿçš„åŠ å‰§ï¼Œæˆ‘ä»¬éœ€è¦çš„ä¸ä»…æ˜¯æŠ€æœ¯æ™®æƒ ï¼Œæ›´æ˜¯<strong>è®¤çŸ¥æ™®æƒ </strong>ã€‚<br/>
è¿™åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>å¼€æºæ¨¡å‹ä¸æœ¬åœ°åŒ–æ¨ç†æ¡†æ¶</strong>ï¼Œè®©æ›´å¤šèµ„æºæœ‰é™åœ°åŒºä¹Ÿèƒ½ä½¿ç”¨AIGCã€‚</li>
<li><strong>æ•°å­—ç´ å…»æ•™è‚²</strong>ï¼Œåœ¨å­¦æ ¡ä¸ç¤¾åŒºæ™®åŠAIå·¥å…·ä½¿ç”¨å’Œä¼¦ç†ã€‚</li>
<li><strong>è·¨é¢†åŸŸåˆä½œ</strong>ï¼šè®©è‰ºæœ¯å®¶ã€ç¨‹åºå‘˜ã€å“²å­¦å®¶å…±åŒå‚ä¸AIçš„åˆ›é€ ç”Ÿæ€ã€‚</li>
</ol>
<p>AIä¸æ˜¯è¦â€œå–ä»£äººç±»â€ï¼Œè€Œæ˜¯å¸®åŠ©äººç±»<strong>æ‰¾å›åˆ›é€ çš„åˆå¿ƒ</strong>ã€‚<br/>
æ¯•ç«Ÿï¼Œæ­£å¦‚å¤å¸Œè…Šå“²äººæ‰€è¯´ï¼šâ€œæŠ€æœ¯çš„ç»ˆææ„ä¹‰ï¼Œä¸æ˜¯æŒæ§ï¼Œè€Œæ˜¯ç†è§£ã€‚â€</p>
<hr/>
<h2 data-id="heading-11">ğŸŒˆ å…­ã€ç»“è¯­ï¼šå½“AIå˜å¾—â€œæ¸©æŸ”â€</h2>
<p>AIæŠ€æœ¯å¦‚é£ï¼Œèƒ½å¸¦æ¥æš–æ„ï¼Œä¹Ÿèƒ½æ€èµ·é£æš´ã€‚<br/>
<strong>å…³é”®åœ¨äºï¼Œæˆ‘ä»¬æ˜¯å¦èƒ½è®©æŠ€æœ¯çš„é£ï¼Œå¹è¿›æ¯ä¸ªäººçš„éº¦ç”°ï¼Œè€Œä¸æ˜¯å°‘æ•°äººçš„èŠ±å›­ã€‚</strong></p>
<blockquote>
<p>ğŸŒ WebAIGCçš„æ™®æƒ ï¼Œä¸ä»…æ„å‘³ç€â€œè®©äººäººèƒ½åˆ›ä½œâ€ï¼Œ<br/>
æ›´æ„å‘³ç€â€œè®©äººäººèƒ½ç†è§£åˆ›ä½œçš„æ„ä¹‰â€ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Next.jsç¬¬åä¸‰ç« (ç¼“å­˜ç»„ä»¶)]]></title>    <link>https://juejin.cn/post/7582958136258215972</link>    <guid>https://juejin.cn/post/7582958136258215972</guid>    <pubDate>2025-12-14T10:23:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582958136258215972" data-draft-id="7582958136258199588" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Next.jsç¬¬åä¸‰ç« (ç¼“å­˜ç»„ä»¶)"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-14T10:23:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°æ»¡zs"/> <meta itemprop="url" content="https://juejin.cn/user/2463384809252397"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Next.jsç¬¬åä¸‰ç« (ç¼“å­˜ç»„ä»¶)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2463384809252397/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°æ»¡zs
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T10:23:12.000Z" title="Sun Dec 14 2025 10:23:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç¼“å­˜ç»„ä»¶(Cache Components)</h2>
<h4 data-id="heading-1">ä»€ä¹ˆæ˜¯Cache Components?</h4>
<p>Cache Components æ˜¯Next.js(16)ç‰ˆæœ¬ç‰¹æœ‰çš„æœºåˆ¶ï¼Œå®ç°äº†<code>é™æ€å†…å®¹</code> <code>åŠ¨æ€å†…å®¹</code> <code>ç¼“å­˜å†…å®¹</code>çš„æ··åˆç¼–æ’ã€‚ä¿ç•™äº†é™æ€å†…å®¹çš„åŠ è½½é€Ÿåº¦ï¼Œåˆå…·å¤‡åŠ¨æ€æ¸²æŸ“çš„çµæ´»æ€§ï¼Œè§£å†³äº†<code>é™æ€å†…å®¹(åŠ è½½å¿«ä½†æ— æ³•å®æ—¶æ›´æ–°æ•°æ®)</code>å’Œ<code>åŠ¨æ€å†…å®¹(åŠ è½½æ…¢ä½†å¯ä»¥å®æ—¶æ›´æ–°æ•°æ®)</code>æƒè¡¡çš„é—®é¢˜ã€‚</p>
<ul>
<li>
<p>é™æ€å†…å®¹: æ„å»º(<code>npm run build</code>)æ—¶è¿›è¡Œé¢„æ¸²æŸ“ï¼Œä¾‹å¦‚ <code>ã€Œæœ¬åœ°æ–‡ä»¶ã€ã€Œæ¨¡å—å¯¼å…¥ã€ã€Œçº¯è®¡ç®—ã€ï¼ˆæ— ç½‘ç»œè¯·æ±‚ã€æ— ç”¨æˆ·ç›¸å…³æ•°æ®ï¼‰</code>,ä¼šè¢«ç›´æ¥ç¼–è¯‘æˆ<code>HTML</code>ç¬é—´åŠ è½½ã€ç«‹å³å“åº”ã€‚</p>
</li>
<li>
<p>åŠ¨æ€å†…å®¹ï¼šç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶æ‰å¼€å§‹æ¸²æŸ“çš„å†…å®¹ï¼Œä¾èµ– â€œå®æ—¶æ•°æ®â€ æˆ– â€œç”¨æˆ·ä¸ªæ€§åŒ–ä¿¡æ¯â€ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å¯èƒ½ç”Ÿæˆä¸åŒç»“æœï¼Œä¸ä¼šè¢«ç¼“å­˜ã€‚ä¾‹å¦‚<code>ã€Œå®æ—¶æ•°æ®æºã€ï¼ˆå¦‚å®æ—¶æ¥å£ã€æ•°æ®åº“å®æ—¶æŸ¥è¯¢ï¼‰æˆ–ã€Œç”¨æˆ·è¯·æ±‚ä¸Šä¸‹æ–‡ã€ï¼ˆå¦‚ Cookieã€è¯·æ±‚å¤´ã€URL å‚æ•°ï¼‰</code>ã€‚</p>
</li>
<li>
<p>ç¼“å­˜å†…å®¹ï¼šç¼“å­˜å†…å®¹çš„æœ¬è´¨å°±æ˜¯ç¼“å­˜åŠ¨æ€æ•°æ®ï¼Œç¼“å­˜ä¹‹åä¼šè¢«çº³å…¥<code>é™æ€å¤–å£³(Static Shell)</code>,é™æ€å¤–å£³å°±ç±»ä¼¼äº<code>æ¯›å¯æˆ¿</code>ï¼Œä¼šæå‰æŠŠç»“æ„æ­å»ºå¥½ï¼Œåç»­åœ¨é€šè¿‡(æµå¼ä¼ è¾“)å¡«å……é‡Œé¢çš„åŠ¨æ€å†…å®¹ã€‚</p>
</li>
</ul>





















<table><thead><tr><th>ä¼ ç»Ÿæ–¹æ¡ˆ</th><th>Cache Components</th></tr></thead><tbody><tr><td>é™æ€é¡µé¢ï¼šæ•°æ®æ— æ³•å®æ—¶æ›´æ–°</td><td>æ”¯æŒç¼“å­˜å†…å®¹é‡æ–°éªŒè¯ï¼ŒåŠ¨æ€å†…å®¹æµå¼è¡¥å……</td></tr><tr><td>åŠ¨æ€é¡µé¢ï¼šåˆå§‹åŠ è½½æ…¢ã€æœåŠ¡å™¨å‹åŠ›å¤§</td><td>é™æ€å¤–å£³ä¼˜å…ˆè¿”å›ï¼ŒåŠ¨æ€å†…å®¹å¹¶è¡Œæ¸²æŸ“</td></tr><tr><td>å®¢æˆ·ç«¯æ¸²æŸ“ï¼šbundle ä½“ç§¯å¤§ã€é¦–å±æ…¢</td><td>æœåŠ¡å™¨é¢„æ¸²æŸ“æ ¸å¿ƒå†…å®¹ï¼Œå®¢æˆ·ç«¯ä»…è¡¥å……åŠ¨æ€éƒ¨åˆ†</td></tr></tbody></table>
<h4 data-id="heading-2">å¯ç”¨Cache Components</h4>
<p>Cache Components ä¸ºå¯é€‰åŠŸèƒ½ï¼Œéœ€åœ¨ Next é…ç½®æ–‡ä»¶ä¸­æ˜¾å¼å¯ç”¨ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { <span class="hljs-title class_">NextConfig</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"next"</span>;

<span class="hljs-keyword">const</span> <span class="hljs-attr">nextConfig</span>: <span class="hljs-title class_">NextConfig</span> = {
  <span class="hljs-attr">cacheComponents</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// å¯ç”¨ç¼“å­˜ç»„ä»¶</span>
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> nextConfig;
</code></pre>
<h5 data-id="heading-3">1. é™æ€å†…å®¹å±•ç¤º</h5>
<p>é€‚ç”¨åœºæ™¯ï¼šä»…ä¾èµ–åŒæ­¥ I/Oï¼ˆå¦‚ fs.readFileSyncï¼‰ã€æ¨¡å—å¯¼å…¥ã€çº¯è®¡ç®—çš„ç»„ä»¶</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'node:fs'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> data = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">'data.json'</span>, <span class="hljs-string">'utf-8'</span>) <span class="hljs-comment">//æœ¬åœ°æ–‡ä»¶è¯»å–</span>
    <span class="hljs-keyword">const</span> json = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data)
    <span class="hljs-keyword">const</span> impData = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../../../data.json'</span>) <span class="hljs-comment">//æ¨¡å—å¯¼å…¥</span>
    <span class="hljs-keyword">const</span> names = impData.<span class="hljs-property">list</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span>=&gt;</span>item.<span class="hljs-property">name</span>).<span class="hljs-title function_">join</span>(<span class="hljs-string">','</span>) <span class="hljs-comment">//çº¯è®¡ç®—</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(impData)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(names)
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                {json.list.map((item: any) =&gt; (
                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>{item.name} - {item.age}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                ))}
            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f95aabdf399e4a2d95c79ed6f10f6f33~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312592&amp;x-signature=RnQ7Mi0mGCLUMhn9%2BqvzEcigj2I%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-4">2.1 åŠ¨æ€å†…å®¹å±•ç¤º</h5>
<p>é€‚ç”¨åœºæ™¯ï¼šfetchè¯·æ±‚ã€cookiesã€headersç­‰åŠ¨æ€æ•°æ®</p>
<blockquote>
<p>åŠ¨æ€å†…å®¹å¿…é¡»é…åˆSuspenseä½¿ç”¨ã€‚</p>
</blockquote>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">import</span> { cookies } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/headers"</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">DynamicContent</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://www.mocklib.com/mock/random/name'</span>) <span class="hljs-comment">//éšæœºç”Ÿæˆä¸€ä¸ªåç§°</span>
    <span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> data.<span class="hljs-title function_">json</span>()
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json)
    <span class="hljs-keyword">const</span> cookieStore = <span class="hljs-keyword">await</span> <span class="hljs-title function_">cookies</span>() <span class="hljs-comment">//è·å–cookie</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(cookieStore)
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>åŠ¨æ€å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>åç§°ï¼š{json.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ¨æ€å†…å®¹Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">DynamicContent</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/676b89ba6c6d42d6ab7c9a92394cc9ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312592&amp;x-signature=Kxp5U%2BwHvBNPLJuel8WBCsP8NWU%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-5">2.2 å®ç°åŸç†</h5>
<p>Next.js ä¼šé€šè¿‡<code>(Partial Prerendering/PPR)</code>æŠ€æœ¯,å®ç°é™æ€å¤–å£³(Static Shell)æ¸²æŸ“ï¼Œæä¾›å ä½ç¬¦ï¼Œå½“ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œå†é€šè¿‡æµå¼ä¼ è¾“(Streaming)å¡«å……é‡Œé¢çš„åŠ¨æ€å†…å®¹ï¼Œä»¥æ­¤æå‡é¦–å±åŠ è½½é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/adc6b9ee874949d8a9d0f691ec8706ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312592&amp;x-signature=A1zRfCxECpKB8uaQy3lxpmtTirA%3D" alt="image.png" loading="lazy"/></p>
<p>æˆ‘ä»¬è§‚å¯Ÿä¸Šå›¾</p>
<ul>
<li>
<p><code>&lt;h1&gt;Home&lt;/h1&gt;</code>ï¼š çº¯é™æ€å†…å®¹ï¼Œå±äºé™æ€å¤–å£³çš„ä¸€éƒ¨åˆ†ï¼Œæ„å»º / è¯·æ±‚æ—¶ç›´æ¥æ¸²æŸ“ï¼Œæµè§ˆå™¨èƒ½ç«‹å³æ˜¾ç¤ºã€‚</p>
</li>
<li>
<p><code>&lt;template id="B:0"&gt;&lt;/template&gt;</code> åŠ¨æ€å†…å®¹çš„å®¹å™¨æ¨¡æ¿ï¼Œåç»­ç”¨æ¥æŒ‚è½½å¼‚æ­¥åŠ è½½çš„åŠ¨æ€å†…å®¹</p>
</li>
<li>
<p><code>&lt;div&gt;åŠ¨æ€å†…å®¹Loading...&lt;/div&gt;</code>ï¼šå ä½ç¬¦ï¼ˆfallbackï¼‰ï¼Œå±äºé™æ€å¤–å£³çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨åŠ¨æ€å†…å®¹åŠ è½½å®Œæˆå‰æ˜¾ç¤ºã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/030007fe15934d0f83f932a99648ac2f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312592&amp;x-signature=nGnY%2FrvETk%2BlJalRcMgijMwztQs%3D" alt="image.png" loading="lazy"/></p>
<ul>
<li>
<p>è¿™ä¸ª <code>&lt;div&gt;</code> åˆå§‹ä¸º hiddenï¼Œæ˜¯æœåŠ¡å™¨å¼‚æ­¥æ¸²æŸ“å®Œæˆçš„åŠ¨æ€å†…å®¹ï¼Œç­‰å¾…å®¢æˆ·ç«¯è„šæœ¬è§¦å‘åæ›¿æ¢åˆ°å ä½ç¬¦ä½ç½®ã€‚</p>
</li>
<li>
<p>id="S:0" ä¸å‰é¢çš„ <code>&lt;template id="B:0"&gt;</code> ä¸€ä¸€å¯¹åº”ï¼Œæ˜¯ â€œåŠ¨æ€å†…å®¹ - å ä½ç¬¦â€ çš„å…³è”æ ‡è¯†ã€‚</p>
</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/704fcb36a784467f820198b31d07b674~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312592&amp;x-signature=1NjqnpghA8GewBhv6z99wmixCoE%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-ts" lang="ts">$RC(<span class="hljs-string">"B:0"</span>, <span class="hljs-string">"S:0"</span>) <span class="hljs-comment">// å…³é”®è°ƒç”¨ï¼šå…³è” B:0 å ä½ç¬¦å’Œ S:0 åŠ¨æ€å†…å®¹</span>
</code></pre>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>C</mi><mtext>ï¼ˆ</mtext><mi>R</mi><mi>e</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>C</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>R</mi><mi>e</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>c</mi><mi>e</mi><mtext>ï¼‰ï¼šæ‰¾åˆ°</mtext><mi>i</mi><mi>d</mi><mo>=</mo><mi mathvariant="normal">"</mi><mi>B</mi><mo>:</mo><mn>0</mn><mi mathvariant="normal">"</mi><mtext>çš„å ä½ç¬¦å’Œ</mtext><mi>i</mi><mi>d</mi><mo>=</mo><mi mathvariant="normal">"</mi><mi>S</mi><mo>:</mo><mn>0</mn><mi mathvariant="normal">"</mi><mtext>çš„åŠ¨æ€å†…å®¹ï¼Œå°†å…¶åŠ å…¥æ›¿æ¢é˜Ÿåˆ—</mtext></mrow><annotation encoding="application/x-tex">RCï¼ˆReact Content Replaceï¼‰ï¼šæ‰¾åˆ° id="B:0" çš„å ä½ç¬¦å’Œ id="S:0" çš„åŠ¨æ€å†…å®¹ï¼Œå°†å…¶åŠ å…¥æ›¿æ¢é˜Ÿåˆ— </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.07153em;">RC</span><span class="mord cjk_fallback">ï¼ˆ</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.07153em;">tC</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.00773em;">tR</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">pl</span><span class="mord mathnormal">a</span><span class="mord mathnormal">ce</span><span class="mord cjk_fallback">ï¼‰ï¼šæ‰¾åˆ°</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord">"</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord">0"</span><span class="mord cjk_fallback">çš„å ä½ç¬¦å’Œ</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord">"</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">:</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord">0"</span><span class="mord cjk_fallback">çš„åŠ¨æ€å†…å®¹ï¼Œå°†å…¶åŠ å…¥æ›¿æ¢é˜Ÿåˆ—</span></span></span></span></span>RBã€‚</li>
<li>$RVï¼ˆReact Content Renderï¼‰ï¼šåœ¨åŠ¨ç”»å¸§ / è¶…æ—¶åæ‰§è¡Œæ›¿æ¢ï¼Œç§»é™¤åŠ è½½å ä½ç¬¦ï¼Œå°†åŠ¨æ€å†…å®¹æ’å…¥åˆ°é¡µé¢ä¸­ï¼Œå®Œæˆæœ€ç»ˆæ¸²æŸ“ã€‚</li>
</ul>
<h5 data-id="heading-6">2.3 éç¡®å®šæ“ä½œ</h5>
<p>ä¾‹å¦‚: <code>éšæœºæ•°</code>ã€<code>æ—¶é—´æˆ³</code>ç­‰éç¡®å®šæ“ä½œï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å¯èƒ½ç”Ÿæˆä¸åŒç»“æœã€‚</p>
<p>ç›´æ¥ä½¿ç”¨å°±ä¼šæŠ¥é”™å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>Error: Route "/home" used <code>Math.random()</code> before accessing either uncached data (e.g. <code>fetch()</code>) or Request data (e.g. <code>cookies()</code>, <code>headers()</code>, <code>connection()</code>, and <code>searchParams</code>). Accessing random values synchronously in a Server Component requires reading one of these data sources first. Alternatively, consider moving this expression into a Client Component or Cache Component. See more info here: <a href="https://link.juejin.cn?target=https%3A%2F%2Fnextjs.org%2Fdocs%2Fmessages%2Fnext-prerender-random" target="_blank" title="https://nextjs.org/docs/messages/next-prerender-random" ref="nofollow noopener noreferrer">nextjs.org/docs/messagâ€¦</a>
at DynamicContent (page.tsx:5:25)
at Home (page.tsx:27:17)</p>
</blockquote>
<p>è§£å†³æ–¹æ¡ˆï¼š</p>
<p>ä½¿ç”¨SuspenseåŒ…è£¹ï¼Œç„¶åä½¿ç”¨connectionè¡¨ç¤ºä¸è¦é¢„æ¸²æŸ“è¿™éƒ¨åˆ†ã€‚</p>
<p>Next.jsé»˜è®¤ä¼šå°è¯•å°½å¯èƒ½å¤šåœ°é™æ€é¢„æ¸²æŸ“é¡µé¢å†…å®¹ã€‚ä½†åƒ <code>Math.random()</code> è¿™æ ·çš„å€¼æ¯æ¬¡è°ƒç”¨ç»“æœéƒ½ä¸åŒï¼Œå¦‚æœåœ¨é¢„æ¸²æŸ“æ—¶æ‰§è¡Œï¼Œé‚£è¿™ä¸ª"éšæœºå€¼"å°±è¢«å›ºå®šäº†ï¼Œå¤±å»äº†æ„ä¹‰ã€‚
é€šè¿‡åœ¨ Math.random() ä¹‹å‰è°ƒç”¨ await connection()ï¼Œä½ æ˜ç¡®å‘Šè¯‰ Next.jsï¼š</p>
<ul>
<li>ä¸è¦é¢„æ¸²æŸ“è¿™éƒ¨åˆ†</li>
<li>ç­‰çœŸæ­£æœ‰ç”¨æˆ·è¯·æ±‚æ—¶å†æ‰§è¡Œ</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">import</span> { connection } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/server"</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">DynamicContent</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">connection</span>() <span class="hljs-comment">//ä½¿ç”¨connectionè¡¨ç¤ºä¸è¦é¢„æ¸²æŸ“è¿™éƒ¨åˆ†</span>
    <span class="hljs-keyword">const</span> random = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(random, now)
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>åŠ¨æ€å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>åç§°ï¼š{random}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>æ—¶é—´ï¼š{now}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ¨æ€å†…å®¹Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">DynamicContent</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<h5 data-id="heading-7">3. ç¼“å­˜å†…å®¹å±•ç¤º</h5>
<p>ç¼“å­˜ç»„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨<code>use cache</code>å£°æ˜è¿™æ˜¯ä¸€ä¸ªç¼“å­˜ç»„ä»¶ï¼Œç„¶åä½¿ç”¨<code>cacheLife</code>å£°æ˜ç¼“å­˜æ—¶é—´ã€‚</p>
<p>cacheLifeå‚æ•°ï¼š</p>
<ul>
<li><code>stale</code>ï¼šå®¢æˆ·ç«¯åœ¨æ­¤æ—¶é—´å†…ç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼Œä¸å‘æœåŠ¡å™¨å‘è¯·æ±‚<code>(å•ä½:ç§’)</code></li>
<li><code>revalidate</code>ï¼šè¶…è¿‡æ­¤æ—¶é—´åï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚æ—¶ä¼šåœ¨åå°é‡æ–°ç”Ÿæˆå†…å®¹<code>(å•ä½:ç§’)</code></li>
<li><code>expire</code>ï¼šè¶…è¿‡æ­¤æ—¶é—´æ— è®¿é—®ï¼Œç¼“å­˜å®Œå…¨å¤±æ•ˆï¼Œä¸‹æ¬¡è¯·æ±‚éœ€è¦ç­‰å¾…é‡æ–°è®¡ç®—<code>(å•ä½:ç§’)</code></li>
</ul>
<p>é¢„è®¾å‚æ•°:</p>






















































<table><thead><tr><th>Profile</th><th>é€‚ç”¨åœºæ™¯</th><th>stale</th><th>revalidate</th><th>expire</th></tr></thead><tbody><tr><td>seconds</td><td>å®æ—¶æ•°æ®ï¼ˆè‚¡ç¥¨ã€æ¯”åˆ†ï¼‰</td><td>30ç§’</td><td>1ç§’</td><td>1åˆ†é’Ÿ</td></tr><tr><td>minutes</td><td>é¢‘ç¹æ›´æ–°ï¼ˆç¤¾äº¤åŠ¨æ€ï¼‰</td><td>5åˆ†é’Ÿ</td><td>1åˆ†é’Ÿ</td><td>1å°æ—¶</td></tr><tr><td>hours</td><td>æ¯æ—¥å¤šæ¬¡æ›´æ–°ï¼ˆåº“å­˜ã€å¤©æ°”ï¼‰</td><td>5åˆ†é’Ÿ</td><td>1å°æ—¶</td><td>1å¤©</td></tr><tr><td>days</td><td>æ¯æ—¥æ›´æ–°ï¼ˆåšå®¢æ–‡ç« ï¼‰</td><td>5åˆ†é’Ÿ</td><td>1å¤©</td><td>1å‘¨</td></tr><tr><td>weeks</td><td>æ¯å‘¨æ›´æ–°ï¼ˆæ’­å®¢ï¼‰</td><td>5åˆ†é’Ÿ</td><td>1å‘¨</td><td>30å¤©</td></tr><tr><td>max</td><td>å¾ˆå°‘å˜åŒ–ï¼ˆæ³•å¾‹é¡µé¢ï¼‰</td><td>5åˆ†é’Ÿ</td><td>30å¤©</td><td>1å¹´</td></tr></tbody></table>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">import</span> { cacheLife } <span class="hljs-keyword">from</span> <span class="hljs-string">"next/cache"</span>

<span class="hljs-keyword">const</span> <span class="hljs-title function_">DynamicContent</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-string">'use cache'</span>
    <span class="hljs-title function_">cacheLife</span>(<span class="hljs-string">"hours"</span>) <span class="hljs-comment">//ä½¿ç”¨é¢„è®¾å‚æ•°</span>
    <span class="hljs-comment">//cacheLife({stale: 30, revalidate: 1, expire: 1}) //ä½¿ç”¨è‡ªå®šä¹‰å‚æ•°</span>
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://www.mocklib.com/mock/random/name'</span>)
    <span class="hljs-keyword">const</span> json = <span class="hljs-keyword">await</span> data.<span class="hljs-title function_">json</span>()
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(json)
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>åŠ¨æ€å†…å®¹<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>åç§°ï¼š{json.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Home</span>(<span class="hljs-params"/>) {

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>åŠ¨æ€å†…å®¹Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">DynamicContent</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3df9733f502044349a3b3b351098553e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCP5ruhenM=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766312592&amp;x-signature=avUfm6e1smUSYWWY04XJHBq239Y%3D" alt="8.gif" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[âš™ï¸ WebAssemblyåœ¨AIGCæ¨ç†ä¸­çš„ä¼˜åŒ–ç»†èŠ‚]]></title>    <link>https://juejin.cn/post/7583168260797317160</link>    <guid>https://juejin.cn/post/7583168260797317160</guid>    <pubDate>2025-12-14T10:24:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583168260797317160" data-draft-id="7583249151551864866" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="âš™ï¸ WebAssemblyåœ¨AIGCæ¨ç†ä¸­çš„ä¼˜åŒ–ç»†èŠ‚"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LLM,Trae"/> <meta itemprop="datePublished" content="2025-12-14T10:24:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="LeonGao"/> <meta itemprop="url" content="https://juejin.cn/user/3976252950591149"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            âš™ï¸ WebAssemblyåœ¨AIGCæ¨ç†ä¸­çš„ä¼˜åŒ–ç»†èŠ‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3976252950591149/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    LeonGao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T10:24:19.000Z" title="Sun Dec 14 2025 10:24:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body blockquote&gt;:first-child{margin-top:0}.markdown-body blockquote&gt;:last-child{margin-bottom:0}.markdown-body{overflow:hidden;line-height:1.75;font-size:15px;background-image:linear-gradient(90deg,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0),linear-gradient(1turn,rgba(72,42,10,.05) 5%,rgba(72,42,10,0) 0);background-size:20px 20px;background-position:50%;padding-top:0!important}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{position:relative;display:flex;border-bottom:5px solid #6d4e00;line-height:35px;letter-spacing:1px;font-size:25px;padding-left:25px;color:#664900;text-shadow:1px 1px 1px #8a6200;padding-bottom:0}.markdown-body h1:before{content:"";display:flex;position:absolute;left:0;top:3px;bottom:0;margin:auto;width:20px;height:20px;background-size:20px 20px;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC")}.markdown-body h2{position:relative;padding:0 0 0 20px;font-size:20px;font-weight:700;color:#614500}.markdown-body h2:before{content:"";position:absolute;top:3px;bottom:0;left:0;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAAAQlBMVEVHcEwlRnqtZBj76q4lRnolRnolRnolRnolRnokRnr/gGtrVUeLXDBKTl+hYSHasW7Ik0zs0JG4dCvUdEE0SW+rYxrLQJfjAAAACnRSTlMA////0H/xUaMi5MCoTwAACfVJREFUeNrtnQl3qygUgJ9GXAqosfL//+pgmgXwXmRNJGdu55xO+6rx8+6I8O9fehmGriN93zdN07bVXdpW/ih/SbpuGP6dXbpOXv7z2i3S9ISck2eQOnAhMHG64VQQbmrAaM4B05GmipaGdB+m6BNQPBXzMYtKR3EPbB/RS5eY4g+lIW9WBqnySCvVMrzRpqqs0g9nwVg5p1KYlHEchRT5bftp+y3n6xlQDjAkABtrKULU9f377ev+4/1/NiT+URRiZRhrcZP6WLa/Gq005BORaqXsdYEuHPIP798ZxSyt6d5sVfxJESRCsvB32lfXwhRjnUBGmKXNoJQe04VIASJqRC/9G7yDsyQMiloYz+0pHYghEoPISAGgpDSvHsCoMwmA0mfjSG5UOsqah2RodkljzMkhZZdamiEDB8+Nsbk9T04yGNljDXGOZZ6u0+Tj9DuvbyNJBuPO0ABtLNPlJtfZJ4CNNCWJoY8gddwxNpm9YrHh9DEkBoeMud4Kma8XRZaYpBJOYvg59U9wOsblMvmGrzQe30dyqFZ1dxPfO0FT5BOdw989THVs4q1TFk+iN4PMu7CaLpd4EJOExNaJLE4d0xQKYpJ0cY5Ozcwwu6WOu2cs9TUYxPB4b4fvLRzTUXbT1HH7y0BnB0j6CAehkPFfFzd1TMsi6sU1/P4VM9NiISHBlYnBMR+kad075sXlmMehj1twnfTUqJH4GJfqIKte7S72emPnHbdiYHIB0e6ATjKq1UoTaFh6wBL2csMIVo9fH/v6QRHAgoxrOHQQxG/36tC1ODmGOeBGBRmXalgcdhDQ1xF1vI6a3DF2d4r7G1enOUgNOshlFq7qUCxrca9ldiCam7ilxRbP6JbOYsYtfLFmkcXEgLG1DN/6eroxHjqh5bh+Uw27e1oWVK7pN+AqwzUcq/UYTPw8nWufLFBHN2zcxLRYlmGPs6rA2Wy0uJe/E7TknbHIa1WH1bLA8DAj3JpxET+FCNCWZ5uNT6jxTPZK/1mXoCBeKlGLRT2lP69XN3XdqqCojKX1ZVda6iD2McjeXSHa0I+AHd2InGAJgjRVM6gOBfygDrarRJnho6eQBbrns+HkcNUCWtYClJa66qFgPbqqZEBTCOAgRqxCOhQBWpZeIC6QBq91hEoI5unTjsMsK9DCFigY9WNn19hgVCrELalrTw6WnYMYzjHhQ2/7G2xTx1HvwpzSe4cVi5ORQQwMW9+72FU5L4gGsa6Yu1RcDeIhs64Qs8izt0vGH+n9/IKaIlYpM2UqkYOrwwq5CgBjWpyGtxaonxe4KaJ3hx+7O0HaqVkxLBPj8FmBVmjNevIUFhUuDmMq5NDV9RwyPe/95IvxAhG7ymqxHGE5sZJL2kPLUhUinkXfrnFwGFwXD99djNLSFh/meXEb2B6Oyiwm0I7BC+OlTlOVPk9K8CIYzu5YHwKDTI6XAo5lz3WEqEXwQRKhh5cyLa6D81P4PXBw984as9YaGXHwx4Ba8rmOldUat/BHt9cQ38AaljnBdCJqs60OcXVDJZP//ZwSWtV9FpHNtgg22KuYx/U2tB5Mcp1TYOiphNhiFjgWeJ3DL2OZpuuUisIoUyzZEJ76I+LmyqWdv8LwnEiwMYczihjxeqtBsuFJSTg2oD1ETQx4v6D1VleSZW1xCwvAfVGWpQ069kgrQksAUW2rReYzsboIjSABuDQX0QJwB9cnZVgWVgE31vrklAJnEmVObykgYCk/VGX5OlpuKb5eiovUAvJ2tMstw0kIkNdpiSA91K6XA6K8CVCyr4PePhTo65q3DyX7OpTbSVk1PB62mhJ9HSpSqtKaESxsFRm0tLBVcvTV+vbBrLRK4hC7aitN9B0ZpX6vNMgjGIt5ZdmMv32KrmprD1afsPd4FEhThK0+WfTl3kpd482AGvG3jQdZK1+t8ireDswhofigRb3fxfI/4jj+xkffUX/1ccxxhEP9qyyBEH9Cx9vhf8TB7eiSpBHjZVSa4whQMJC1TqIR6q8RERtjOr2ID0yx3oYi0oAIvZCPz4eG64p3ObuREeOHUIR3MBVJwq9yll5P7KHdiPBOiOoRa/AjXz21J3k04l+i8OjErj4kaXWQiIVO/EvA+KLRAEnUVomtjPd6SvR3RLoeMT54nKFH1EqtkkEGFaQuTlSQrsxhRiOIt51S/Ho8B11+FUlwRaHnU4utEI38/mgSjRJ8PhWEtN6Z6WcncQOU4efjKoh3zfi7/+DfhPrwOZ9a/iYBiVJJxPlei3CqIDTYEqAPFow5/c71fAdVIwmo4n+cTIGbr2n9NULAE5ifcNNS63hvEOFk0wxYnICBBZ0I9xERBVILF0uggNdxuOkR4S6ngvgPmArzHv4KpMKGQFjQ+Rw6q9dC6R6dgZaJF7RVWIH0BTY9h+fz0ohHOyLuy+He/hN4GUR3/RxcBx2f76izarI9CaXmzRmhNQuSfIgJkva5GzN6HJbhQxCNsDGDSh56plmef6sg2eaXPsYBt5W+H6VE6omG6hOS1w4hiTWiThbJ1YO+RSO1vrpMlomf6nhQGz0m7qT6W04XOUHyzhZ4rkG+0hxL66oDW9mnPWyL3TMmssxyQUwr01CHX7b2OvUIaqS48TnMtAoEQTQixJeAlDfSiGmk/l8jpwIpTyFqOfeNIHWBooC036ERtUQp2tm/CKT5jjySbxTlvUVj2yhjvyWDVL3yfKRojXwLSEWUp7q0PBAKPp7m5YGoT3WH7wAZ1BeOywNZv3Gak/LIqriwxbQ5jaTcsEW1eb+FvoWo+zr5V/IUOvNtsapU2zJXSyj0xVB13sPfq0kkZA7dubIIKXIlJ8Cy7u+BN22RVcr+peOuxHdcBbA04FAVmEoEtO5vX55K4KVZS1QJvBBzU1rgUl8JapBNYIowLoZtD9NWRTWKqqe36L48BSz8QPH9epqqIDehlh2UuqocEmrdV7AvhuRoM74m80yeDIEX3ppreNN235FxV58DNjhswn5K8zK21+5ctjut6NmUIoy9tVvitnHr2VDM3ahtW8KQ/Vbsp9GGiWHfk8skyTSFz9/HdxhHe4uR/RxX/mG1SGXwypcDJNmCMfucZ/C1CuCQUbiBUDYbe7tiRkZX8GIat50d+wqR1fdN7ygGzrHrcN4kGFHK02cil5M6INgQVsvnNz77T5PqUFYJJInYmIBplJfP5On4eiOwYfhuCD44oLyYVs43rI1rk3H7usttzq8Qo3j84vavN9mOkAeuq8dHEd9NtCVKX51Oen+MM6IEYvz5StOehKLpIjD+nKU5AQWJpLizdB+1sb5LQvFRxbSJVGHmSdK/0WWaPguEYmcSJ68aWkK6rAw6jwSSCmrTWVHT96R7HwHANEgqybVJL+E2vE2q7Uu91Gr73SbbNUvZDtiOlCeIv4r/AI+0XUwz1lvcAAAAAElFTkSuQmCC");background-size:100% 100%;background-repeat:no-repeat;width:15px;height:15px;margin:auto}.markdown-body h3{width:100%;text-align:left;margin:20px 10px 0 0;font-size:18px;font-weight:700;display:inline-block;padding-left:10px;padding-bottom:0;border-left:5px solid #8f6600;color:#614500}.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:700;color:#a37400}.markdown-body h4{font-size:17px}.markdown-body h5,.markdown-body h6{display:flex;align-items:center}.markdown-body h5:after,.markdown-body h6:after{display:inline-block;border:2px solid #fff6e0;color:rgba(189,134,0,.5);border-radius:50%;text-align:center;margin-left:5px}.markdown-body h5{font-size:14px}.markdown-body h5:after{content:"5";width:15px;height:15px;line-height:15px;font-size:13px}.markdown-body h6{font-size:12px}.markdown-body h6:after{content:"6";width:13px;height:13px;line-height:13px;font-size:12px}.markdown-body p{color:#412c0c;letter-spacing:1px;font-weight:400;margin-bottom:16px}.markdown-body img{max-width:100%;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#755300;font-weight:400;border-bottom:1px solid #755300;font-weight:bolder;text-decoration:none}.markdown-body table{width:100%!important;margin:0;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border-spacing:0}.markdown-body table img{box-shadow:none}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body thead tr th{text-align:center}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;box-sizing:border-box;border:1px solid rgba(72,42,10,.1)}.markdown-body blockquote{position:relative;text-size-adjust:100%;line-height:25px;font-weight:400;border-radius:10px;font-style:normal;text-align:left;box-sizing:inherit;border:1px solid #ffd87a;background-color:rgba(189,134,0,.5);margin:20px 0;padding:20px}.markdown-body blockquote p{color:#fff6e0;letter-spacing:2px;margin:0}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;color:#cc9100;font-size:34px;font-weight:700}.markdown-body blockquote:before{content:"â";top:8px;left:5px}.markdown-body blockquote:after{content:"â";right:5px;bottom:-5px}.markdown-body strong{color:#c28a00;font-weight:bolder}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{color:#c28a00}.markdown-body em strong{font-style:normal;color:#c28a00;background-color:#8a6200}.markdown-body s{color:#c28a00}.markdown-body hr{border-top:1px solid #805b00}.markdown-body code,.markdown-body li code,.markdown-body p code{color:#996d00;background-color:rgba(130,98,0,.3)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit;color:#858585;font-family:bold;letter-spacing:1px}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection,.markdown-body img::selection{color:rgba(189,134,0,.5);background-color:#fff}.markdown-body a::selection,.markdown-body b::selection,.markdown-body del::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:transparent}.markdown-body pre&gt;code::selection{background-color:rgba(189,134,0,.5)}.markdown-body .math .math-inline::selection,.markdown-body blockquote::selection,.markdown-body ol::selection,.markdown-body p::selection,.markdown-body strong::selection,.markdown-body table::selection,.markdown-body ul::selection{background-color:rgba(189,134,0,.5)}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ğŸ§© ä¸€ã€ä¸ºä»€ä¹ˆè¦ç”¨WASMæ¥åšAIæ¨ç†ï¼Ÿ</h2>
<p>åœ¨æµè§ˆå™¨ä¸­åšAIæ¨ç†çœ‹èµ·æ¥åƒâ€œæ‹¿æ‰‹ç”µç­’ç…§å¤ªé˜³â€â€”â€”<br/>
JavaScriptè§£é‡Šæ…¢ã€å†…å­˜ä¸å¯æ§ã€ç±»å‹ä¸ç¨³å®šã€ç¼ºä¹SIMDå¹¶è¡Œã€‚</p>
<p>è€Œ<strong>WASM</strong>ï¼ˆWebAssemblyï¼‰å‡ºç°åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠåŸæœ¬ç¼–è¯‘åœ¨æœåŠ¡å™¨ä¸Šçš„C++/Rustæ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œ<br/>
ç›´æ¥<strong>ç¼–è¯‘æˆä¸€ç§é«˜é€Ÿã€å¼ºç±»å‹ã€æ¥è¿‘åŸç”Ÿçš„ä½çº§å­—èŠ‚ç æ ¼å¼</strong>ï¼Œç”±æµè§ˆå™¨ç›´æ¥è¿è¡Œã€‚</p>
<p>ç®€è€Œè¨€ä¹‹ï¼š</p>
<blockquote>
<p>ä»¥å‰AIè¦é â€œäº‘ç®—åŠ›â€ï¼Œç°åœ¨AIå¯ä»¥é â€œæµè§ˆå™¨è‚Œè‚‰â€ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-1">ğŸ§  äºŒã€åº•å±‚æ¶æ„é€Ÿå†™ï¼šAIæ¨ç†åœ¨WASMä¸­çš„â€œæ—…ç¨‹â€</h2>
<p>ä¸€ä¸ªå…¸å‹çš„AIGCæ¨ç†è¿‡ç¨‹ï¼ˆå¦‚æ–‡æœ¬ç”Ÿæˆæˆ–å›¾åƒæ‰©æ•£ï¼‰åœ¨Webç«¯çš„æ‰§è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">Prompt</span>]  
   â†“  
Tokenizerï¼ˆJSå±‚ï¼‰  
   â†“  
ONNX/WASMæ¨¡å— â†’ Linear/Conv ç®—å­è®¡ç®—
   â†“  
Softmax é‡‡æ ·  
   â†“  
è¾“å‡ºToken â†’ ç”Ÿæˆç»“æœ
</code></pre>
<p><strong>å…³é”®åœ¨äºä¸­é—´é‚£ä¸€æ­¥ï¼š</strong></p>
<blockquote>
<p>â€œONNX/WASMæ¨¡å—â€ é€šè¿‡WASMå±‚å®ç°äº†åº•å±‚çŸ©é˜µä¹˜æ³•ã€æ¿€æ´»å‡½æ•°ã€å½’ä¸€åŒ–ç­‰ç®—å­ã€‚</p>
</blockquote>
<p>è¿™äº›ç®—å­éƒ½æ˜¯<strong>ç¥ç»ç½‘ç»œçš„â€œåº•å±‚è‚Œè‚‰â€</strong> ï¼Œ<br/>
ä¼˜åŒ–å®ƒä»¬çš„æ€§èƒ½ï¼ŒAIçš„è¿è¡Œé€Ÿåº¦å°±èƒ½æå‡å¥½å‡ ä¸ªæ•°é‡çº§ã€‚</p>
<hr/>
<h2 data-id="heading-2">ğŸ§® ä¸‰ã€æ ¸å¿ƒä¼˜åŒ–ç­–ç•¥ï¼šWASMåœ¨æ¨ç†å±‚çš„â€œæ€§èƒ½é­”æ³•â€</h2>
<hr/>
<h3 data-id="heading-3">1. SIMDï¼ˆå•æŒ‡ä»¤å¤šæ•°æ®ï¼‰å¹¶è¡Œï¼šè®©AIâ€œå¤§å£åç®—â€</h3>
<p>ä¼ ç»ŸJavaScriptå¾ªç¯å¤„ç†çŸ©é˜µä¹˜æ³•æ•ˆç‡ä½ä¸‹ã€‚<br/>
è€ŒWASMæ”¯æŒ<strong>SIMDæŒ‡ä»¤é›†</strong>ï¼ˆSingle Instruction Multiple Dataï¼‰åï¼Œå¯ä»¥ä¸€æ¬¡æ€§è®©CPUåŒæ—¶å¤„ç†4ï½8ä¸ªæµ®ç‚¹æ•°ã€‚</p>
<p><strong>ç±»æ¯”è¯´æ˜ï¼š</strong></p>
<blockquote>
<p>JSåƒç”¨ç­·å­å¤¹è±†å­ï¼ŒWASM SIMDåƒç”¨é“²å­ç«¯èµ·åŠç¢—ã€‚ğŸ¥¢ â†’ ğŸ¥„</p>
</blockquote>
<pre><code class="hljs language-css" lang="css">// ç¤ºä¾‹ï¼šåˆ©ç”¨WASM SIMDå®ç°çŸ¢é‡åŠ æ³•
// ï¼ˆä¼ªç¤ºä¾‹ï¼Œç”¨JSè¡¨è¾¾WASMæ€è·¯ï¼‰
function vectorAddSIMD(<span class="hljs-selector-tag">a</span>, <span class="hljs-selector-tag">b</span>) {
  const len = <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.length</span>;
  const c = new Float32Array(len);
  
  for (let <span class="hljs-selector-tag">i</span> = <span class="hljs-number">0</span>; <span class="hljs-selector-tag">i</span> &lt; len; <span class="hljs-selector-tag">i</span> += <span class="hljs-number">4</span>) {
    c<span class="hljs-selector-attr">[i]</span> = <span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[i]</span> + <span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[i]</span>;
    c<span class="hljs-selector-attr">[i+1]</span> = <span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[i+1]</span> + <span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[i+1]</span>;
    c<span class="hljs-selector-attr">[i+2]</span> = <span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[i+2]</span> + <span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[i+2]</span>;
    c<span class="hljs-selector-attr">[i+3]</span> = <span class="hljs-selector-tag">a</span><span class="hljs-selector-attr">[i+3]</span> + <span class="hljs-selector-tag">b</span><span class="hljs-selector-attr">[i+3]</span>;
  }
  return c;
}
</code></pre>
<p>åœ¨çœŸå®WASMä¸­ï¼Œè¿™æ ·çš„å¾ªç¯ä¼šè¢«SIMDæŒ‡ä»¤å¹¶è¡ŒåŒ–æˆå•æ¡ç¡¬ä»¶æŒ‡ä»¤ï¼Œä»è€Œå®ç°è¿‘ä¼¼åŸç”Ÿæ€§èƒ½ã€‚</p>
<hr/>
<h3 data-id="heading-4">2. Memory Heap ä¼˜åŒ–ï¼šè®©AIçš„â€œè„‘å®¹é‡â€ä¸å†ç¢ç‰‡åŒ–</h3>
<p>åœ¨AIæ¨ç†ä¸­ï¼Œå¤§é‡çš„Tensorï¼ˆå¼ é‡ï¼‰éœ€è¦åˆ†é…å’Œé‡Šæ”¾å†…å­˜ã€‚<br/>
å¦‚æœåƒJSé‚£æ ·é¢‘ç¹GCï¼ˆåƒåœ¾å›æ”¶ï¼‰ï¼Œæ€§èƒ½ä¼šæ€¥å‰§ä¸‹é™ã€‚</p>
<p>WASMæä¾›äº†<strong>çº¿æ€§å†…å­˜æ¨¡å‹ï¼ˆLinear Memory Modelï¼‰</strong> ï¼š</p>
<ul>
<li>æ‰€æœ‰Tensoræ•°æ®è¿ç»­åˆ†å¸ƒåœ¨ä¸€å—å¯æ‰©å±•å †åŒºï¼›</li>
<li>ç”±C++/Rustçš„å†…å­˜åˆ†é…å™¨æ‰‹åŠ¨ç®¡ç†ï¼›</li>
<li>é¿å…JavaScriptå¯¹è±¡åŒ–æŸè€—ã€‚</li>
</ul>
<blockquote>
<p>ç®€å•è¯´ï¼šWASMä¸å¯„å®¿äºJSçš„ä¸–ç•Œï¼Œè€Œæ˜¯å¦å¼€ä¸€é—´å®¿èˆï¼Œå†…å­˜ä¸€å­—æ’å¼€ï¼Œå†·é™å¾—åƒä¸ªè®¡ç®—æœºè€ƒå¤ç°åœºã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-5">3. å¤šçº¿ç¨‹ä¸å…±äº«å†…å­˜ï¼šWASM Workersåœ¨æ¨ç†ä¸­çš„ç”¨æ­¦ä¹‹åœ°</h3>
<p>åœ¨å¯ç”¨ <strong>WebAssembly Threads + SharedArrayBuffer</strong> æ”¯æŒçš„ç¯å¢ƒä¸‹ï¼Œå¯ä»¥å¼€å¯çœŸæ­£æ„ä¹‰ä¸Šçš„å¤šçº¿ç¨‹æ¨ç†ï¼š</p>






























<table><thead><tr><th align="left">æ¨¡å—</th><th align="center">çº¿ç¨‹æ•°</th><th align="left">åŠŸèƒ½</th></tr></thead><tbody><tr><td align="left">Token Embedding</td><td align="center">1</td><td align="left">ä¸²è¡Œæ˜ å°„è¾“å…¥æ–‡æœ¬</td></tr><tr><td align="left">Attention Layer</td><td align="center">4</td><td align="left">å¹¶è¡Œè®¡ç®— Key/Query/Product</td></tr><tr><td align="left">Feedforward Layer</td><td align="center">4</td><td align="left">æ‰¹é‡çŸ©é˜µä¹˜æ³•</td></tr><tr><td align="left">Output Softmax</td><td align="center">1</td><td align="left">æ±‡æ€»è¾“å‡ºç»“æœ</td></tr></tbody></table>
<p>è¿™æ ·ä¸€ä¸ªæµè§ˆå™¨æ¨ç†å®ä¾‹ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸CPUæ€§èƒ½ï¼Œç”šè‡³åœ¨ç¬”è®°æœ¬ä¸Šå®ç°<strong>æ¥è¿‘GPUçš„é€Ÿåº¦</strong>ï¼ˆå–å†³äºæ¨¡å‹å¤§å°ï¼‰ã€‚</p>
<hr/>
<h3 data-id="heading-6">4. é‡åŒ–è®¡ç®—ï¼šæ•°å­¦ä¸æ˜¯â€œè¶Šç²¾ç¡®è¶Šå¥½â€</h3>
<p>AIGCæ¨ç†å¾ˆå¤šæ—¶å€™ä¸éœ€è¦é«˜ç²¾åº¦æµ®ç‚¹è®¡ç®—ã€‚<br/>
æ¯”å¦‚ï¼Œä»32ä½æµ®ç‚¹ï¼ˆ<code>float32</code>ï¼‰é™åˆ°8ä½æ•´æ•°ï¼ˆ<code>int8</code>ï¼‰å³å¯å¤§å¹…å‡å°‘å†…å­˜å’Œå¸¦å®½ã€‚</p>
<p>åœ¨WASMç«¯ï¼Œæ‰§è¡Œæµç¨‹å¯ç®€åŒ–ä¸ºï¼š</p>
<pre><code class="hljs language-go" lang="go"><span class="hljs-type">float32</span> tensor â†’ <span class="hljs-type">int8</span> tensor
<span class="hljs-type">int8</span> Ã— <span class="hljs-type">int8</span> â†’ <span class="hljs-type">int32</span> accumulate
<span class="hljs-type">int32</span> â†’ <span class="hljs-type">float32</span> normalize
</code></pre>
<blockquote>
<p>æ•°å­¦æ„ä¹‰ä¸Šç²¾ç¡®æŸå¤±ï¼Œä½†æ„ŸçŸ¥ä¸Šå‡ ä¹æ— å·®å¼‚ã€‚<br/>
æ¨¡å‹å˜è½»åï¼Œåœ¨æµè§ˆå™¨å°±èƒ½â€œè·‘å¾—åŠ¨â€ã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-7">5. å›¾ä¼˜åŒ– &amp; Operator Fusionï¼šåˆå¹¶ç®—å­ï¼Œå°‘èµ°å¼¯è·¯</h3>
<p>WASMç«¯æ¨ç†æ¡†æ¶ï¼ˆå¦‚ <strong>ONNX Runtime Webã€WebDNN</strong>ï¼‰ä¼šåœ¨æ‰§è¡Œå‰è¿›è¡Œå›¾ä¼˜åŒ–ï¼š</p>
<ul>
<li><strong>å±‚èåˆï¼ˆFusionï¼‰</strong> ï¼šå¦‚å°† â€œLayerNorm + MatMul + Addâ€ èæˆä¸€ä¸ªé«˜æ•ˆkernel</li>
<li><strong>å¸¸é‡æŠ˜å ï¼ˆConstant Foldingï¼‰</strong> ï¼šé¢„å…ˆè®¡ç®—å›ºå®šå€¼ï¼Œå‡å°‘è¿è¡Œæ—¶æ“ä½œ</li>
<li><strong>æ•°æ®å¸ƒå±€ä¼˜åŒ–</strong>ï¼šä» <code>NHWC</code> â†’ <code>NCHW</code> æ¥å‡å°‘ç¼“å­˜miss</li>
</ul>
<p>ç»“æœï¼šæ¨ç†è¿‡ç¨‹æ›´çŸ­ã€æ›´å¿«ã€èƒ½è€—æ›´ä½ã€‚</p>
<hr/>
<h2 data-id="heading-8">ğŸŒ å››ã€å®æˆ˜æ¼”ç¤ºï¼šç”¨WASMåŠ è½½ä¸€ä¸ªAIGCæ¨¡å‹</h2>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">InferenceSession</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'onnxruntime-web'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">runAIGCModel</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> session = <span class="hljs-keyword">await</span> <span class="hljs-title class_">InferenceSession</span>.<span class="hljs-title function_">create</span>(<span class="hljs-string">'model.onnx'</span>, {
    <span class="hljs-attr">executionProviders</span>: [<span class="hljs-string">'wasm'</span>],
    <span class="hljs-attr">graphOptimizationLevel</span>: <span class="hljs-string">'all'</span>,
  });

  <span class="hljs-keyword">const</span> input = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Float32Array</span>([<span class="hljs-comment">/* prompt embedding */</span>]);
  <span class="hljs-keyword">const</span> feeds = { <span class="hljs-string">'input'</span>: <span class="hljs-keyword">new</span> ort.<span class="hljs-title class_">Tensor</span>(<span class="hljs-string">'float32'</span>, input, [<span class="hljs-number">1</span>, <span class="hljs-number">512</span>]) };

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">'AIæ¨ç†'</span>);
  <span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> session.<span class="hljs-title function_">run</span>(feeds);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">'AIæ¨ç†'</span>);

  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'è¾“å‡ºToken:'</span>, results.<span class="hljs-property">output</span>.<span class="hljs-property">data</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>));
}

<span class="hljs-title function_">runAIGCModel</span>();
</code></pre>
<p>ğŸ’¡ <strong>ä¼˜åŒ–æç¤ºï¼š</strong></p>
<ul>
<li>æµè§ˆå™¨é¡»å¯ç”¨ <code>SharedArrayBuffer</code></li>
<li>å¯ä¼˜å…ˆåŠ è½½ <code>.wasm</code> äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆé¿å…Base64åŠ è½½è€—æ—¶ï¼‰</li>
<li>è‹¥æ”¯æŒ WebNNï¼ˆæµè§ˆå™¨åŸç”ŸAI APIï¼‰ï¼Œå¯æ··åˆä½¿ç”¨åšè¿›ä¸€æ­¥åŠ é€Ÿ</li>
</ul>
<hr/>
<h2 data-id="heading-9">ğŸ” äº”ã€å°ç»“ &amp; å‘å±•è¶‹åŠ¿</h2>



































<table><thead><tr><th>ä¼˜åŒ–æ–¹å‘</th><th>æŠ€æœ¯æ‰‹æ®µ</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>å¹¶è¡ŒåŠ é€Ÿ</td><td>SIMD + Threads</td><td>åŠ é€ŸçŸ©é˜µè¿ç®—</td></tr><tr><td>å†…å­˜ç®¡ç†</td><td>Linear Memory</td><td>é¿å…GCå¡é¡¿</td></tr><tr><td>æ¨¡å‹å‹ç¼©</td><td>é‡åŒ–/è’¸é¦</td><td>å¯åŠ¨æ›´å¿«</td></tr><tr><td>å›¾ä¼˜åŒ–</td><td>Kernelèåˆ</td><td>å°‘ç®—å†—ä½™æ“ä½œ</td></tr><tr><td>æœªæ¥è¶‹åŠ¿</td><td>WebGPU + WebNN</td><td>GPUçº§æµè§ˆå™¨æ¨ç†</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ251208-251212ï¼‰]]></title>    <link>https://juejin.cn/post/7583535861645344814</link>    <guid>https://juejin.cn/post/7583535861645344814</guid>    <pubDate>2025-12-14T10:56:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583535861645344814" data-draft-id="7583530023358840870" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ251208-251212ï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-14T10:56:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¶å­çš„æŠ€æœ¯ç¢ç¢å¿µ"/> <meta itemprop="url" content="https://juejin.cn/user/2831954919569245"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¯å‘¨AIè®ºæ–‡é€Ÿé€’ï¼ˆ251208-251212ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2831954919569245/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¶å­çš„æŠ€æœ¯ç¢ç¢å¿µ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T10:56:45.000Z" title="Sun Dec 14 2025 10:56:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Wan-Move: Motion-controllable Video Generation via Latent Trajectory Guidance</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.08765" target="_blank" title="https://arxiv.org/abs/2512.08765" ref="nofollow noopener noreferrer">Wan-Move: é€šè¿‡æ½œåœ¨è½¨è¿¹å¼•å¯¼å®ç°è¿åŠ¨å¯æ§çš„è§†é¢‘ç”Ÿæˆ</a></p>
<p>æˆ‘ä»¬æå‡ºäº† Wan-Moveï¼Œä¸€ä¸ªç®€å•ä¸”å¯æ‰©å±•çš„æ¡†æ¶ï¼Œæ—¨åœ¨ä¸ºè§†é¢‘ç”Ÿæˆæ¨¡å‹å¼•å…¥è¿åŠ¨æ§åˆ¶èƒ½åŠ›ã€‚ç°æœ‰çš„è¿åŠ¨å¯æ§æ–¹æ³•é€šå¸¸é¢ä¸´æ§åˆ¶ç²’åº¦ç²—ç³™å’Œå¯æ‰©å±•æ€§æœ‰é™çš„é—®é¢˜ï¼Œä½¿å…¶è¾“å‡ºéš¾ä»¥æ»¡è¶³å®é™…åº”ç”¨éœ€æ±‚ã€‚é€šè¿‡å®ç°ç²¾ç¡®ä¸”é«˜è´¨é‡çš„è¿åŠ¨æ§åˆ¶ï¼Œæˆ‘ä»¬ç¼©å°äº†è¿™ä¸€å·®è·ã€‚æˆ‘ä»¬çš„æ ¸å¿ƒæ€æƒ³æ˜¯ç›´æ¥ä½¿åŸå§‹çš„æ¡ä»¶ç‰¹å¾å…·å¤‡è¿åŠ¨æ„ŸçŸ¥èƒ½åŠ›ï¼Œä»è€ŒæŒ‡å¯¼è§†é¢‘åˆæˆã€‚å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨å¯†é›†ç‚¹è½¨è¿¹æ¥è¡¨ç¤ºç‰©ä½“è¿åŠ¨ï¼Œä»¥å®ç°å¯¹åœºæ™¯çš„ç»†ç²’åº¦æ§åˆ¶ã€‚æ¥ç€ï¼Œæˆ‘ä»¬å°†è¿™äº›è½¨è¿¹æ˜ å°„åˆ°æ½œåœ¨ç©ºé—´ï¼Œå¹¶æ²¿æ¯æ¡è½¨è¿¹ä¼ æ’­ç¬¬ä¸€å¸§çš„ç‰¹å¾ï¼Œä»è€Œç”Ÿæˆä¸€ä¸ªå¯¹é½çš„æ—¶ç©ºç‰¹å¾å›¾ï¼Œè¯¥å›¾å®šä¹‰äº†æ¯ä¸ªåœºæ™¯å…ƒç´ åº”å¦‚ä½•è¿åŠ¨ã€‚æ­¤ç‰¹å¾å›¾ä½œä¸ºæ›´æ–°å¾—åˆ°çš„æ½œåœ¨æ¡ä»¶ï¼Œå¯ä»¥æ— ç¼é›†æˆåˆ°ç°æˆçš„å›¾åƒåˆ°è§†é¢‘æ¨¡å‹ï¼ˆä¾‹å¦‚ Wan-I2V-14Bï¼‰ä¸­ï¼Œä½œä¸ºè¿åŠ¨å¼•å¯¼ï¼Œè€Œæ— éœ€æ”¹å˜ä»»ä½•æ¨¡å‹æ¶æ„ã€‚è¯¥æ–¹æ³•æ— éœ€è¾…åŠ©è¿åŠ¨ç¼–ç å™¨ï¼Œå¹¶ä½¿å¾—åŸºç¡€æ¨¡å‹çš„å¾®è°ƒå…·å¤‡è‰¯å¥½çš„å¯æ‰©å±•æ€§ã€‚é€šè¿‡å¤§è§„æ¨¡è®­ç»ƒï¼ŒWan-Move èƒ½å¤Ÿç”Ÿæˆ 5 ç§’ã€480p çš„è§†é¢‘ï¼Œç”¨æˆ·ç ”ç©¶è¡¨æ˜å…¶è¿åŠ¨å¯æ§æ€§å¯ä¸ Kling 1.5 Pro çš„å•†ä¸šç‰ˆ Motion Brush ç›¸åª²ç¾ã€‚ä¸ºäº†æ”¯æŒå…¨é¢è¯„ä¼°ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥è®¾è®¡äº† MoveBenchï¼Œè¿™æ˜¯ä¸€ä¸ªç²¾å¿ƒæ„å»ºçš„åŸºå‡†æµ‹è¯•ï¼ŒåŒ…å«å¤šæ ·åŒ–çš„å†…å®¹ç±»åˆ«å’Œç»è¿‡æ··åˆéªŒè¯çš„æ ‡æ³¨ã€‚å…¶æ˜¾è‘—ç‰¹ç‚¹åœ¨äºæ•°æ®é‡æ›´å¤§ã€è§†é¢‘æ—¶é•¿æ›´é•¿ä»¥åŠé«˜è´¨é‡çš„è¿åŠ¨æ ‡æ³¨ã€‚åœ¨ MoveBench å’Œå…¬å…±æ•°æ®é›†ä¸Šè¿›è¡Œçš„å¤§é‡å®éªŒä¸€è‡´è¯æ˜äº† Wan-Move å“è¶Šçš„è¿åŠ¨ç”Ÿæˆè´¨é‡ã€‚ä»£ç ã€æ¨¡å‹å’ŒåŸºå‡†æ•°æ®å‡å·²å…¬å¼€ã€‚</p>
<h2 data-id="heading-1">Visionary: The World Model Carrier Built on WebGPU-Powered Gaussian Splatting Platform</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.08478" target="_blank" title="https://arxiv.org/abs/2512.08478" ref="nofollow noopener noreferrer">Visionary: åŸºäº WebGPU é«˜æ–¯æ³¼æº…å¹³å°çš„ä¸–ç•Œæ¨¡å‹è½½ä½“</a></p>
<p>ç¥ç»æ¸²æŸ“ï¼Œç‰¹åˆ«æ˜¯ 3D é«˜æ–¯æ³¼æº… (3D Gaussian Splatting, 3DGS) æŠ€æœ¯ï¼Œå·²è¿…é€Ÿå‘å±•æˆä¸ºæ„å»ºä¸–ç•Œæ¨¡å‹çš„å…³é”®ç»„ä»¶ã€‚ç„¶è€Œï¼Œç°æœ‰çš„æŸ¥çœ‹å™¨è§£å†³æ–¹æ¡ˆå¾€å¾€è¾ƒä¸ºåˆ†æ•£ã€ç¬¨é‡æˆ–å—ä¼ ç»Ÿæµæ°´çº¿é™åˆ¶ï¼Œå¯¼è‡´éƒ¨ç½²éš¾åº¦å¤§ï¼Œä¸”å¯¹åŠ¨æ€å†…å®¹ä¸ç”Ÿæˆæ¨¡å‹çš„æ”¯æŒæœ‰é™ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† Visionaryï¼Œä¸€ä¸ªå¼€æ”¾çš„ã€åŸºäº Web çš„åŸç”Ÿå¹³å°ï¼Œç”¨äºå®æ—¶æ¸²æŸ“å„ç±»é«˜æ–¯æ³¼æº…ä¸ç½‘æ ¼æ•°æ®ã€‚è¯¥å¹³å°åŸºäºé«˜æ•ˆçš„ WebGPU æ¸²æŸ“å™¨æ„å»ºï¼Œå¹¶é›†æˆäº†æ¯å¸§ ONNX æ¨ç†èƒ½åŠ›ï¼Œä»è€Œåœ¨ä¿æŒè½»é‡çº§ã€â€œå³ç‚¹å³ç”¨â€æµè§ˆå™¨ä½“éªŒçš„åŒæ—¶ï¼Œå®ç°äº†åŠ¨æ€ç¥ç»å¤„ç†ã€‚Visionary å¼•å…¥äº†ä¸€ä¸ªæ ‡å‡†åŒ–çš„é«˜æ–¯ç”Ÿæˆå™¨æ¥å£ï¼Œä¸ä»…æ”¯æŒæ ‡å‡† 3DGS æ¸²æŸ“ï¼Œè¿˜å…è®¸ä»¥å³æ’å³ç”¨çš„æ–¹å¼ï¼Œåœ¨æ¯å¸§ç”Ÿæˆæˆ–æ›´æ–°é«˜æ–¯åˆ†å¸ƒã€‚è¿™ç§æ¨ç†èƒ½åŠ›ä¹Ÿä½¿å¾—å‰é¦ˆå¼ç”Ÿæˆåå¤„ç†å¾—ä»¥åº”ç”¨ã€‚æ­¤å¤–ï¼Œå¹³å°è¿˜æä¾›äº†ä¸€ä¸ª three.js åº“æ’ä»¶ï¼Œå…¶ç®€æ´çš„ TypeScript API ä¾¿äºæ— ç¼é›†æˆåˆ°ç°æœ‰ Web åº”ç”¨ç¨‹åºä¸­ã€‚å®éªŒè¡¨æ˜ï¼Œåœ¨ç›¸åŒçš„ 3DGS èµ„æºä¸‹ï¼Œå¾—ç›ŠäºåŸºäº GPU çš„å›¾å…ƒæ’åºï¼ŒVisionary ç›¸æ¯”ç°æœ‰ Web æŸ¥çœ‹å™¨å®ç°äº†æ›´ä¼˜çš„æ¸²æŸ“æ•ˆç‡ã€‚ç›®å‰ï¼Œå®ƒå·²æ”¯æŒå¤šç§å˜ä½“ï¼ŒåŒ…æ‹¬åŸºäº MLP çš„ 3DGSã€4DGSã€ç¥ç»åŒ–èº«ä»¥åŠé£æ ¼è½¬æ¢æˆ–å¢å¼ºç½‘ç»œã€‚é€šè¿‡åœ¨æµè§ˆå™¨ä¸­ç›´æ¥ç»Ÿä¸€æ¨ç†ä¸æ¸²æŸ“ï¼ŒVisionary æ˜¾è‘—é™ä½äº† 3DGS ç³»åˆ—æ–¹æ³•çš„å¤ç°ã€æ¯”è¾ƒä¸éƒ¨ç½²é—¨æ§›ï¼Œä¸ºé‡å»ºå¼ä¸ç”Ÿæˆå¼ä¸¤ç§èŒƒå¼æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„ä¸–ç•Œæ¨¡å‹è½½ä½“ã€‚</p>
<h2 data-id="heading-2">Native Parallel Reasoner: Reasoning in Parallelism via Self-Distilled Reinforcement Learning</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.07461" target="_blank" title="https://arxiv.org/abs/2512.07461" ref="nofollow noopener noreferrer">åŸç”Ÿå¹¶è¡Œæ¨ç†å™¨ï¼šé€šè¿‡è‡ªè’¸é¦å¼ºåŒ–å­¦ä¹ å®ç°å¹¶è¡Œæ¨ç†</a></p>
<p>æˆ‘ä»¬æå‡ºäº†åŸç”Ÿå¹¶è¡Œæ¨ç†å™¨ (Native Parallel Reasoner, NPR)ï¼Œè¿™æ˜¯ä¸€ä¸ªå…æ•™å¸ˆæ¡†æ¶ï¼Œèƒ½å¤Ÿä½¿å¤§è¯­è¨€æ¨¡å‹ (LLMs) è‡ªæˆ‘è¿›åŒ–å‡ºçœŸæ­£çš„å¹¶è¡Œæ¨ç†èƒ½åŠ›ã€‚NPR é€šè¿‡ä¸‰é¡¹å…³é”®åˆ›æ–°ï¼Œå°†æ¨¡å‹ä»é¡ºåºå¼å¤„ç†è½¬å˜ä¸ºåŸç”Ÿå¹¶è¡Œè®¤çŸ¥ï¼š1) ä¸€ç§è‡ªè’¸é¦æ¸è¿›è®­ç»ƒèŒƒå¼ï¼Œæ— éœ€å¤–éƒ¨ç›‘ç£ï¼Œå³å¯ä»â€œå†·å¯åŠ¨â€æ ¼å¼å‘ç°è¿‡æ¸¡åˆ°ä¸¥æ ¼çš„æ‹“æ‰‘çº¦æŸï¼›2) ä¸€ç§æ–°é¢–çš„å¹¶è¡Œæ„ŸçŸ¥ç­–ç•¥ä¼˜åŒ– (Parallel-Aware Policy Optimization, PAPO) ç®—æ³•ï¼Œè¯¥ç®—æ³•ç›´æ¥åœ¨æ‰§è¡Œå›¾å†…éƒ¨ä¼˜åŒ–åˆ†æ”¯ç­–ç•¥ï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿé€šè¿‡è¯•é”™è¿›è¡Œè‡ªé€‚åº”åˆ†è§£ï¼›ä»¥åŠ 3) ä¸€ä¸ªç¨³å¥çš„ NPR å¼•æ“ï¼Œå®ƒé‡æ„äº† SGLang çš„å†…å­˜ç®¡ç†ä¸æµç¨‹æ§åˆ¶ï¼Œä»è€Œæ”¯æŒç¨³å®šã€å¤§è§„æ¨¡å¹¶è¡Œå¼ºåŒ–å­¦ä¹ è®­ç»ƒã€‚åœ¨å…«é¡¹æ¨ç†åŸºå‡†æµ‹è¯•ä¸Šï¼ŒåŸºäº Qwen3-4B è®­ç»ƒçš„ NPR å®ç°äº†é«˜è¾¾ 24.5% çš„æ€§èƒ½æå‡å’Œé«˜è¾¾ 4.6 å€çš„æ¨ç†åŠ é€Ÿã€‚ä¸å…ˆå‰å¸¸éœ€å›é€€è‡³è‡ªå›å½’è§£ç çš„åŸºçº¿æ–¹æ³•ä¸åŒï¼ŒNPR å®ç°äº† 100% çš„çœŸæ­£å¹¶è¡Œæ‰§è¡Œï¼Œä»è€Œä¸ºè‡ªæˆ‘è¿›åŒ–ã€é«˜æ•ˆä¸”å¯æ‰©å±•çš„æ™ºèƒ½ä½“æ¨ç†æ ‘ç«‹äº†æ–°æ ‡å‡†ã€‚</p>
<h2 data-id="heading-3">T-pro 2.0: An Efficient Russian Hybrid-Reasoning Model and Playground</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.10430" target="_blank" title="https://arxiv.org/abs/2512.10430" ref="nofollow noopener noreferrer">T-pro 2.0ï¼šä¸€ä¸ªé«˜æ•ˆçš„ä¿„è¯­æ··åˆæ¨ç†æ¨¡å‹ä¸æµ‹è¯•å¹³å°</a></p>
<p>æˆ‘ä»¬æ¨å‡º T-pro 2.0ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€æ”¾æƒé‡çš„ä¿„è¯­å¤§è¯­è¨€æ¨¡å‹ (LLM)ï¼Œä¸“æ³¨äºæ··åˆæ¨ç†å¹¶å®ç°äº†é«˜æ•ˆæ¨æ–­ã€‚è¯¥æ¨¡å‹æ”¯æŒç›´æ¥å›ç­”å’Œæ¨ç†è½¨è¿¹ç”Ÿæˆï¼Œé€šè¿‡é‡‡ç”¨ä¸€ä¸ªé’ˆå¯¹è¥¿é‡Œå°”å­—ç¬¦ä¼˜åŒ–çš„å¯†é›† Tokenizer ä»¥åŠä¸€ä¸ªç»è¿‡é€‚é…çš„ EAGLE æ¨æµ‹è§£ç æµæ°´çº¿ï¼Œæœ‰æ•ˆé™ä½äº†å»¶è¿Ÿã€‚ä¸ºäº†ä¿ƒè¿›å¯å¤ç°å’Œå¯æ‰©å±•çš„ç ”ç©¶ï¼Œæˆ‘ä»¬åœ¨ Hugging Face ä¸Šå‘å¸ƒäº†æ¨¡å‹æƒé‡ã€T-Wix 500k æŒ‡ä»¤æ•°æ®é›†ã€T-Math æ¨ç†åŸºå‡†ä»¥åŠ EAGLE æƒé‡ã€‚è¿™äº›èµ„æºä½¿ç”¨æˆ·èƒ½å¤Ÿç ”ç©¶ä¿„è¯­æ¨ç†ä»»åŠ¡ï¼Œå¹¶å¯å¯¹æ¨¡å‹åŠæ¨æ–­æµæ°´çº¿è¿›è¡Œæ‰©å±•æˆ–é€‚é…ã€‚ä¸€ä¸ªå…¬å¼€çš„ Web æ¼”ç¤ºæä¾›äº†æ¨ç†æ¨¡å¼ä¸éæ¨ç†æ¨¡å¼ï¼Œå¹¶å±•ç¤ºäº†æˆ‘ä»¬çš„æ¨æ–­æŠ€æœ¯æ ˆåœ¨ä¸åŒä»»åŠ¡ä¸Šæ‰€å¸¦æ¥çš„åŠ é€Ÿæ•ˆæœã€‚å› æ­¤ï¼ŒT-pro 2.0 ä½œä¸ºä¸€ä¸ªå¼€æ”¾æ˜“ç”¨çš„ç³»ç»Ÿï¼Œå¯ç”¨äºæ„å»ºå’Œè¯„ä¼°é«˜æ•ˆã€å®ç”¨çš„ä¿„è¯­å¤§è¯­è¨€æ¨¡å‹åº”ç”¨ã€‚</p>
<h2 data-id="heading-4">TwinFlow: Realizing One-step Generation on Large Models with Self-adversarial Flows</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.05150" target="_blank" title="https://arxiv.org/abs/2512.05150" ref="nofollow noopener noreferrer">TwinFlow: åŸºäºè‡ªå¯¹æŠ—æµçš„å¤§æ¨¡å‹ä¸€æ­¥ç”Ÿæˆæ–¹æ³•</a></p>
<p>è¿‘æœŸï¼Œå¤§å‹å¤šæ¨¡æ€ç”Ÿæˆæ¨¡å‹åœ¨å›¾åƒå’Œè§†é¢‘ç­‰å¤šæ¨¡æ€ç”Ÿæˆä»»åŠ¡ä¸Šå±•ç°å‡ºå“è¶Šèƒ½åŠ›ã€‚è¿™äº›æ¨¡å‹é€šå¸¸åŸºäºæ‰©æ•£æ¨¡å‹å’ŒæµåŒ¹é…ç­‰å¤šæ­¥æ¡†æ¶æ„å»ºï¼Œå…¶å›ºæœ‰çš„å¤šæ­¥æ¨ç†è¿‡ç¨‹ï¼ˆé€šå¸¸éœ€è¦ 40-100 æ¬¡å‡½æ•°è¯„ä¼° (NFEs)ï¼‰é™åˆ¶äº†æ¨ç†æ•ˆç‡ã€‚å°½ç®¡å·²æœ‰å¤šç§å°‘æ­¥æ¨ç†æ–¹æ³•æ—¨åœ¨åŠ é€Ÿï¼Œä½†ç°æœ‰æ–¹æ¡ˆä»å­˜åœ¨æ˜æ˜¾ä¸è¶³ã€‚ä¸»æµçš„åŸºäºè’¸é¦çš„æ–¹æ³•ï¼Œå¦‚æ¸è¿›è’¸é¦å’Œä¸€è‡´æ€§è’¸é¦ï¼Œè¦ä¹ˆéœ€è¦è¿­ä»£çš„è’¸é¦æµç¨‹ï¼Œè¦ä¹ˆåœ¨æä½æ­¥æ•°ï¼ˆ&lt; 4-NFEï¼‰ä¸‹æ€§èƒ½æ˜¾è‘—ä¸‹é™ã€‚åŒæ—¶ï¼Œå°†å¯¹æŠ—è®­ç»ƒèå…¥è’¸é¦è¿‡ç¨‹ï¼ˆä¾‹å¦‚ DMD/DMD2 å’Œ SANA-Sprintï¼‰ä»¥æå‡æ€§èƒ½ï¼Œä¼šå› å¼•å…¥é¢å¤–çš„è¾…åŠ©è®­ç»ƒæ¨¡å‹è€Œå¯¼è‡´è®­ç»ƒä¸ç¨³å®šã€å¤æ‚åº¦å¢åŠ ä»¥åŠé«˜æ˜‚çš„ GPU å†…å­˜å¼€é”€ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬æå‡ºäº† TwinFlowï¼Œä¸€ä¸ªç”¨äºè®­ç»ƒä¸€æ­¥ç”Ÿæˆæ¨¡å‹çš„ç®€æ´é«˜æ•ˆæ¡†æ¶ã€‚è¯¥æ¡†æ¶æ— éœ€ä¾èµ–å›ºå®šçš„é¢„è®­ç»ƒæ•™å¸ˆæ¨¡å‹ï¼Œä¸”åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é¿å…äº†ä½¿ç”¨æ ‡å‡†çš„å¯¹æŠ—ç½‘ç»œï¼Œå› è€Œéå¸¸é€‚åˆæ„å»ºå¤§è§„æ¨¡é«˜æ•ˆæ¨¡å‹ã€‚åœ¨æ–‡ç”Ÿå›¾ä»»åŠ¡ä¸Šï¼Œæˆ‘ä»¬çš„æ–¹æ³•ä»…éœ€ 1-NFE å³å¯è·å¾— 0.83 çš„ GenEval åˆ†æ•°ï¼Œæ€§èƒ½ä¼˜äº SANA-Sprintï¼ˆåŸºäº GAN æŸå¤±çš„æ¡†æ¶ï¼‰å’Œ RCGMï¼ˆåŸºäºä¸€è‡´æ€§çš„æ¡†æ¶ï¼‰ç­‰å¼ºåŸºçº¿ã€‚å°¤ä¸ºé‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨ Qwen-Image-20B ä¸Šè¿›è¡Œå…¨å‚æ•°è®­ç»ƒï¼ŒéªŒè¯äº† TwinFlow çš„å¯æ‰©å±•æ€§ï¼Œå¹¶å°†å…¶æˆåŠŸè½¬æ¢ä¸ºä¸€ä¸ªé«˜æ•ˆçš„å°‘æ­¥ç”Ÿæˆå™¨ã€‚ä»…ä½¿ç”¨ 1-NFEï¼Œæˆ‘ä»¬çš„æ–¹æ³•åœ¨ GenEval å’Œ DPG-Bench åŸºå‡†æµ‹è¯•ä¸Šçš„æ€§èƒ½å³å¯ä¸åŸç‰ˆ 100-NFE æ¨¡å‹ç›¸åª²ç¾ï¼Œåœ¨è´¨é‡ä»…æœ‰è½»å¾®ä¸‹é™çš„åŒæ—¶ï¼Œå°†è®¡ç®—æˆæœ¬é™ä½äº† <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100</mn><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">100\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">100</span><span class="mord">Ã—</span></span></span></span></span>ã€‚é¡¹ç›®é¡µé¢è§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fzhenglin-cheng.com%2Ftwinflow%25E3%2580%2582" target="_blank" title="https://zhenglin-cheng.com/twinflow%E3%80%82" ref="nofollow noopener noreferrer">zhenglin-cheng.com/twinflowã€‚</a></p>
<h2 data-id="heading-5">StereoWorld: Geometry-Aware Monocular-to-Stereo Video Generation</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.09363" target="_blank" title="https://arxiv.org/abs/2512.09363" ref="nofollow noopener noreferrer">StereoWorld: å‡ ä½•æ„ŸçŸ¥çš„å•ç›®åˆ°ç«‹ä½“è§†é¢‘ç”Ÿæˆ</a></p>
<p>éšç€ XR è®¾å¤‡çš„æ—¥ç›Šæ™®åŠï¼Œå¸‚åœºå¯¹é«˜è´¨é‡ç«‹ä½“è§†é¢‘çš„éœ€æ±‚å¼ºåŠ²å¢é•¿ï¼Œä½†å…¶åˆ¶ä½œè¿‡ç¨‹ä¾ç„¶æˆæœ¬é«˜æ˜‚ä¸”æ˜“äº§ç”Ÿä¼ªå½±ã€‚ä¸ºåº”å¯¹è¿™ä¸€æŒ‘æˆ˜ï¼Œæˆ‘ä»¬æå‡ºäº† StereoWorldï¼Œè¿™æ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æ¡†æ¶ï¼Œå®ƒé€šè¿‡æ”¹é€ ä¸€ä¸ªé¢„è®­ç»ƒçš„è§†é¢‘ç”Ÿæˆå™¨ï¼Œå®ç°äº†é«˜ä¿çœŸçš„å•ç›®åˆ°ç«‹ä½“è§†é¢‘ç”Ÿæˆã€‚æˆ‘ä»¬çš„æ¡†æ¶ä½¿æ¨¡å‹èƒ½å¤Ÿä»¥è¾“å…¥çš„å•ç›®è§†é¢‘ä¸ºæ¡ä»¶ï¼ŒåŒæ—¶åˆ©ç”¨å‡ ä½•æ„ŸçŸ¥çš„æ­£åˆ™åŒ–å¯¹ç”Ÿæˆè¿‡ç¨‹è¿›è¡Œæ˜¾å¼ç›‘ç£ï¼Œä»è€Œç¡®ä¿ä¸‰ç»´ç»“æ„çš„ä¿çœŸåº¦ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜é›†æˆäº†ä¸€ä¸ªæ—¶ç©ºåˆ†å—æ–¹æ¡ˆï¼Œä»¥å®ç°é«˜æ•ˆçš„é«˜åˆ†è¾¨ç‡è§†é¢‘åˆæˆã€‚ä¸ºäº†æ”¯æŒå¤§è§„æ¨¡è®­ç»ƒä¸è¯„ä¼°ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªé«˜æ¸…ç«‹ä½“è§†é¢‘æ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«è¶…è¿‡ 1100 ä¸‡å¸§è§†é¢‘ï¼Œå…¶å†…å®¹å‡ä¸è‡ªç„¶çš„äººç±»ç³å­”é—´è·ç¦» (IPD) å¯¹é½ã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼ŒStereoWorld çš„æ€§èƒ½æ˜¾è‘—ä¼˜äºç°æœ‰æ–¹æ³•ï¼Œèƒ½å¤Ÿç”Ÿæˆå…·æœ‰å“è¶Šè§†è§‰ä¿çœŸåº¦å’Œå‡ ä½•ä¸€è‡´æ€§çš„ç«‹ä½“è§†é¢‘ã€‚é¡¹ç›®ç½‘é¡µåœ°å€ä¸º <a href="https://link.juejin.cn?target=https%3A%2F%2Fke-xing.github.io%2FStereoWorld%2F%25E3%2580%2582" target="_blank" title="https://ke-xing.github.io/StereoWorld/%E3%80%82" ref="nofollow noopener noreferrer">ke-xing.github.io/StereoWorldâ€¦</a></p>
<h2 data-id="heading-6">Beyond Real: Imaginary Extension of Rotary Position Embeddings for Long-Context LLMs</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.07525" target="_blank" title="https://arxiv.org/abs/2512.07525" ref="nofollow noopener noreferrer">è¶…è¶Šå®æ•°ï¼šæ—‹è½¬ä½ç½®ç¼–ç çš„è™šæ•°æ‰©å±•åŠå…¶åœ¨é•¿ä¸Šä¸‹æ–‡å¤§è¯­è¨€æ¨¡å‹ä¸­çš„åº”ç”¨</a></p>
<p>æ—‹è½¬ä½ç½®ç¼–ç  (RoPE) é€šè¿‡åœ¨å¤å¹³é¢ä¸Šå¯¹æŸ¥è¯¢å’Œé”®å‘é‡æ–½åŠ æ—‹è½¬ï¼Œå·²æˆä¸ºå¤§è¯­è¨€æ¨¡å‹ (LLMs) ä¸­ç¼–ç åºåˆ—é¡ºåºçš„æ ‡å‡†æ–¹æ¡ˆã€‚ç„¶è€Œï¼Œåœ¨æ ‡å‡†çš„å®ç°ä¸­ï¼Œæ³¨æ„åŠ›åˆ†æ•°çš„è®¡ç®—ä»…ä½¿ç”¨äº†å¤æ•°å€¼ç‚¹ç§¯çš„å®éƒ¨ã€‚è¿™ç§ç®€åŒ–ä¸¢å¼ƒäº†åŒ…å«å®è´µç›¸ä½ä¿¡æ¯çš„è™šéƒ¨ï¼Œå¯èƒ½å¯¼è‡´å¯¹å»ºæ¨¡é•¿ä¸Šä¸‹æ–‡ä¾èµ–è‡³å…³é‡è¦çš„å…³ç³»ç»†èŠ‚ä¸¢å¤±ã€‚æœ¬æ–‡æå‡ºä¸€ç§æ‰©å±•æ–¹æ³•ï¼Œé‡æ–°çº³å…¥äº†è¿™ä¸€è¢«ä¸¢å¼ƒçš„è™šéƒ¨ã€‚æˆ‘ä»¬çš„æ–¹æ³•åˆ©ç”¨å®Œæ•´çš„å¤æ•°å€¼è¡¨ç¤ºï¼Œæ„å»ºäº†ä¸€ä¸ªåŒåˆ†é‡çš„æ³¨æ„åŠ›åˆ†æ•°ã€‚æˆ‘ä»¬ä»ç†è®ºå’Œå®éªŒä¸Šè¯æ˜ï¼Œè¯¥æ–¹æ³•é€šè¿‡ä¿ç•™æ›´å¤šçš„ä½ç½®ä¿¡æ¯ï¼Œæå‡äº†å¯¹é•¿ä¸Šä¸‹æ–‡ä¾èµ–çš„å»ºæ¨¡èƒ½åŠ›ã€‚æ­¤å¤–ï¼Œåœ¨ä¸€ç³»åˆ—é•¿ä¸Šä¸‹æ–‡è¯­è¨€å»ºæ¨¡åŸºå‡†æµ‹è¯•ä¸Šçš„è¯„ä¼°è¡¨æ˜ï¼Œç›¸è¾ƒäºæ ‡å‡† RoPEï¼Œæˆ‘ä»¬çš„æ–¹æ³•èƒ½æŒç»­æå‡æ¨¡å‹æ€§èƒ½ï¼Œä¸”éšç€ä¸Šä¸‹æ–‡é•¿åº¦çš„å¢åŠ ï¼Œå…¶ä¼˜åŠ¿æ„ˆå‘æ˜¾è‘—ã€‚ä»£ç å¼€æºåœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOpenMOSS%2Frope_pp%25E3%2580%2582" target="_blank" title="https://github.com/OpenMOSS/rope_pp%E3%80%82" ref="nofollow noopener noreferrer">github.com/OpenMOSS/roâ€¦</a></p>
<h2 data-id="heading-7">Preserving Source Video Realism: High-Fidelity Face Swapping for Cinematic Quality</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Farxiv.org%2Fabs%2F2512.07951" target="_blank" title="https://arxiv.org/abs/2512.07951" ref="nofollow noopener noreferrer">ä¿æŒæºè§†é¢‘çœŸå®æ„Ÿï¼šå®ç°ç”µå½±çº§è´¨é‡çš„é«˜ä¿çœŸäººè„¸äº¤æ¢</a></p>
<p>è§†é¢‘äººè„¸äº¤æ¢åœ¨ç”µå½±å’Œå¨±ä¹åˆ¶ä½œä¸­è‡³å…³é‡è¦ã€‚ç„¶è€Œï¼Œå¯¹äºé•¿ä¸”å¤æ‚çš„è§†é¢‘åºåˆ—ï¼Œå®ç°é«˜ä¿çœŸåº¦å’Œæ—¶é—´ä¸€è‡´æ€§ä»æ˜¯ä¸€ä¸ªé‡å¤§æŒ‘æˆ˜ã€‚å—è¿‘æœŸå‚è€ƒå¼•å¯¼å›¾åƒç¼–è¾‘æŠ€æœ¯è¿›å±•çš„å¯å‘ï¼Œæˆ‘ä»¬æ¢ç´¢èƒ½å¦ç±»ä¼¼åœ°åˆ©ç”¨æºè§†é¢‘ä¸­ä¸°å¯Œçš„è§†è§‰å±æ€§ï¼Œæ¥åŒæ—¶æå‡è§†é¢‘äººè„¸äº¤æ¢çš„ä¿çœŸåº¦ä¸æ—¶é—´è¿è´¯æ€§ã€‚åŸºäºæ­¤ï¼Œæœ¬æ–‡æå‡ºäº†é¦–ä¸ªè§†é¢‘å‚è€ƒå¼•å¯¼çš„äººè„¸äº¤æ¢æ¨¡å‹â€”â€”LivingSwapã€‚æˆ‘ä»¬çš„æ–¹æ³•ä»¥å…³é”®å¸§ä½œä¸ºæ¡ä»¶ä¿¡å·ï¼Œå¼•å…¥ç›®æ ‡èº«ä»½ç‰¹å¾ï¼Œä»è€Œå®ç°çµæ´»å¯æ§çš„ç¼–è¾‘ã€‚é€šè¿‡ç»“åˆå…³é”®å¸§æ¡ä»¶ä¸è§†é¢‘å‚è€ƒå¼•å¯¼ï¼Œæ¨¡å‹èƒ½å¤Ÿè¿›è¡Œæ—¶åºæ‹¼æ¥ï¼Œç¡®ä¿åœ¨é•¿è§†é¢‘åºåˆ—ä¸­ç¨³å®šä¿æŒèº«ä»½å¹¶å®ç°é«˜ä¿çœŸé‡å»ºã€‚ä¸ºäº†è§£å†³å‚è€ƒå¼•å¯¼è®­ç»ƒæ•°æ®ç¨€ç¼ºçš„é—®é¢˜ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªé…å¯¹çš„äººè„¸äº¤æ¢æ•°æ®é›† Face2Faceï¼Œå¹¶é€šè¿‡åè½¬æ•°æ®å¯¹æ¥ç¡®ä¿å¯é çš„çœŸå€¼ç›‘ç£ã€‚å¤§é‡å®éªŒè¡¨æ˜ï¼Œæˆ‘ä»¬çš„æ–¹æ³•å–å¾—äº†æœ€å…ˆè¿›çš„ç»“æœï¼Œèƒ½å¤Ÿå°†ç›®æ ‡èº«ä»½ä¸æºè§†é¢‘çš„è¡¨æƒ…ã€å…‰ç…§å’Œè¿åŠ¨æ— ç¼èåˆï¼ŒåŒæ—¶æ˜¾è‘—å‡å°‘äº†ç”Ÿäº§æµç¨‹ä¸­çš„äººå·¥å·¥ä½œé‡ã€‚é¡¹ç›®ç½‘é¡µï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Faim-uofa.github.io%2FLivingSwap" target="_blank" title="https://aim-uofa.github.io/LivingSwap" ref="nofollow noopener noreferrer">aim-uofa.github.io/LivingSwap</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥MCPæœ¬è´¨â€”â€”ç¼–å†™è‡ªå®šä¹‰MCP Serverå¹¶é€šè¿‡Cursorè°ƒç”¨]]></title>    <link>https://juejin.cn/post/7583324039303184435</link>    <guid>https://juejin.cn/post/7583324039303184435</guid>    <pubDate>2025-12-14T09:15:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583324039303184435" data-draft-id="7583567658252337178" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥MCPæœ¬è´¨â€”â€”ç¼–å†™è‡ªå®šä¹‰MCP Serverå¹¶é€šè¿‡Cursorè°ƒç”¨"/> <meta itemprop="keywords" content="å‰ç«¯,MCP"/> <meta itemprop="datePublished" content="2025-12-14T09:15:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å¤©æ‰­ç "/> <meta itemprop="url" content="https://juejin.cn/user/3349589831715801"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥MCPæœ¬è´¨â€”â€”ç¼–å†™è‡ªå®šä¹‰MCP Serverå¹¶é€šè¿‡Cursorè°ƒç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3349589831715801/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å¤©æ‰­ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:15:19.000Z" title="Sun Dec 14 2025 09:15:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>è¿™ç¯‡æ–‡ç« å°†æ·±å…¥æ¢è®¨ <strong>MCP (Model Context Protocol)</strong> çš„æ ¸å¿ƒåŸç†ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰å¤©æ°”å·¥å…·ç¤ºä¾‹ï¼Œæ­ç¤º AI æ¨¡å‹å¦‚ä½•ä¸æœ¬åœ°ç³»ç»Ÿè¿›è¡Œé«˜æ•ˆã€å®‰å…¨çš„äº¤äº’ã€‚</p>
<hr/>
<h3 data-id="heading-0">å®æˆ˜é…ç½®ï¼šå¯åŠ¨ä½ çš„è‡ªå®šä¹‰ MCP Server</h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é…ç½®å¹¶è¿è¡Œä¸€ä¸ªè‡ªå®šä¹‰çš„ MCP Serverï¼Œè¯¥ Server èƒ½å¤Ÿè·å–ç”µè„‘æ‰€åœ¨åœ°çš„å®æ—¶æ—¶é—´å’Œå¤©æ°”ï¼ˆä¸ä½¿ç”¨ä»£ç†çš„å‰æä¸‹ï¼‰ã€‚</p>
<h4 data-id="heading-1">æ­¥éª¤ 1: ä»£ç å‡†å¤‡</h4>
<p>ä¸‹é¢æ˜¯æˆ‘ç¼–å†™çš„ MCP Server ï¼Œä½ å¯ä»¥å°†ä»£ç åº“æ‹‰å–åˆ°æœ¬åœ°ç›®å½•</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FObjecteee%2Fmcp%2Ftree%2Fmain%2FmyMCP" target="_blank" title="https://github.com/Objecteee/mcp/tree/main/myMCP" ref="nofollow noopener noreferrer">github.com/Objecteee/mâ€¦</a></p>
<h4 data-id="heading-2">æ­¥éª¤ 2: Cursor é…ç½®</h4>
<p>åœ¨ Cursor IDE çš„ <code>mcp.json</code> é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼ŒæŒ‡å®šä½ çš„æœ¬åœ° Server è„šæœ¬çš„è·¯å¾„ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"Real Weather Tool"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"E:\project\mcp\myMCP\index.js"</span>  # è¯·ç¡®ä¿è¿™é‡Œæ˜¯ä½ çš„æœ¬åœ°æ–‡ä»¶è·¯å¾„
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é…ç½®å®Œæˆåï¼Œæ‚¨å³å¯åœ¨ Cursor çš„å¯¹è¯æ¡†ä¸­é€šè¿‡è‡ªç„¶è¯­è¨€è°ƒç”¨è¿™ä¸ªå·¥å…·ï¼Œä¾‹å¦‚è¯¢é—®ï¼šâ€œç°åœ¨çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿâ€</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a3c959432f94e9ab583cc7755007981~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766308519&amp;x-signature=DmcVhZw2EJvO%2Fc50wzw%2BjoNdu3E%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-3">1. æ ¸å¿ƒæ¶æ„ï¼šä»€ä¹ˆæ˜¯ MCPï¼Ÿ</h3>
<p><strong>MCP (Model Context Protocol)</strong> æ˜¯ç”± Anthropic æå‡ºçš„ä¸€ç§å¼€æ”¾åè®®ï¼Œæ—¨åœ¨è§£å†³ <strong>å¤§å‹è¯­è¨€æ¨¡å‹ (LLM)</strong> ä¸ <strong>å¤–éƒ¨ä¸–ç•Œï¼ˆæœ¬åœ°æ–‡ä»¶ã€æ•°æ®åº“ã€API ç­‰ï¼‰</strong> ä¹‹é—´çš„ä¿¡æ¯é¸¿æ²Ÿã€‚</p>
<ul>
<li><strong>æ²¡æœ‰ MCP æ—¶ï¼š</strong> LLM ä»…ä¾èµ–è®­ç»ƒæ•°æ®ï¼Œæ— æ³•æ„ŸçŸ¥å¤–éƒ¨ä¸–ç•Œçš„å®æ—¶çŠ¶æ€ï¼ˆå¦‚å½“å‰æ—¶é—´ã€å®æ—¶å¤©æ°”ã€æœ¬åœ°ä»£ç ç»“æ„ï¼‰ã€‚å®ƒå°±åƒä¸€ä¸ªâ€œå­¤å²›ä¸Šçš„æ™ºè€…â€ã€‚</li>
<li><strong>æœ‰äº† MCPï¼š</strong> æˆ‘ä»¬ä¸º LLM æä¾›äº†ä¸€ä¸ªæ ‡å‡†åŒ–çš„â€œå·¥å…·æ’åº§â€ã€‚ä»»ä½•éµå¾ª MCP åè®®çš„å¤–éƒ¨ç¨‹åºï¼ˆå³ <strong>MCP Server</strong>ï¼‰éƒ½å¯ä»¥æ’å…¥è¿™ä¸ªæ’åº§ï¼Œä½¿ LLM èƒ½å¤Ÿ <strong>æ§åˆ¶</strong> è¿™äº›å·¥å…·å¹¶ <strong>è·å–</strong> å®æ—¶æ•°æ®ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">2. æœ¬è´¨åŸç†ï¼šCursor å¦‚ä½•è¿æ¥å¹¶è°ƒç”¨å·¥å…·ï¼Ÿ</h3>
<p>Cursor è¿æ¥å’Œè°ƒç”¨è‡ªå®šä¹‰ Server çš„è¿‡ç¨‹ï¼Œæœ¬è´¨ä¸Šæ˜¯åŸºäº <strong>æ ‡å‡†è¾“å…¥/è¾“å‡º (Stdio)</strong> çš„ <strong>è¿›ç¨‹é—´é€šä¿¡ (IPC)</strong> ï¼Œå®ƒé‡‡ç”¨ <strong>JSON-RPC</strong> æ ¼å¼è¿›è¡Œæ•°æ®äº¤æ¢ã€‚æˆ‘ä»¬å¯ä»¥å°†æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p>
<h4 data-id="heading-5">é˜¶æ®µä¸€ï¼šæ¡æ‰‹ï¼ˆHandshakeï¼‰ä¸å·¥å…·å‘ç°</h4>
<ol>
<li><strong>å¯åŠ¨å­è¿›ç¨‹ï¼š</strong> å½“ä½ åœ¨ Cursor ä¸­ä¿å­˜ <code>mcp.json</code> é…ç½®åï¼ŒCursor ä¼šåœ¨åå°å¯åŠ¨ä¸€ä¸ª <strong>å­è¿›ç¨‹ (Child Process)</strong> ï¼Œæ‰§è¡Œä½ æŒ‡å®šçš„ <code>node index.js</code> è„šæœ¬ã€‚</li>
<li><strong>å‘é€è¯¢é—®ï¼š</strong> Cursorï¼ˆçˆ¶è¿›ç¨‹ï¼‰é€šè¿‡ <strong>æ ‡å‡†è¾“å…¥ (stdin)</strong> å‘ä½ çš„è„šæœ¬å‘é€ä¸€æ¡ JSON-RPC æ ¼å¼çš„æ¶ˆæ¯ï¼Œè¯·æ±‚è·å–å¯ç”¨çš„å·¥å…·åˆ—è¡¨ã€‚</li>
<li><strong>è¿”å›åˆ—è¡¨ï¼š</strong> ä½ çš„è„šæœ¬ï¼ˆå­è¿›ç¨‹ï¼‰æ”¶åˆ°è¯·æ±‚åï¼Œä¼šé€šè¿‡ <strong>æ ‡å‡†è¾“å‡º (stdout)</strong> è¿”å›ä¸€ä¸ªåŒ…å«å…¶æ‰€æœ‰å·¥å…·å®šä¹‰ï¼ˆå¦‚ <code>TimeWeatherReporter</code>ï¼‰çš„ JSON å“åº”ã€‚è¿™å¯¹åº”äºä»£ç ä¸­çš„ <code>server.setRequestHandler(ListToolsRequestSchema...)</code>ã€‚</li>
</ol>
<h4 data-id="heading-6">é˜¶æ®µäºŒï¼šå¾…å‘½ä¸å·¥å…·è°ƒç”¨</h4>
<ol>
<li><strong>å¾…å‘½ï¼š</strong> åªè¦ Cursor ä¸å…³é—­ï¼Œä½ çš„è„šæœ¬è¿›ç¨‹å°±ä¼šåœ¨åå°æŒç»­è¿è¡Œï¼Œç­‰å¾…è°ƒç”¨æŒ‡ä»¤ã€‚</li>
<li><strong>LLM è§¦å‘ï¼š</strong> ç”¨æˆ·åœ¨èŠå¤©æ¡†è¾“å…¥æŒ‡ä»¤ï¼ˆå¦‚â€œç°åœ¨çš„å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿâ€ï¼‰ï¼ŒCursor å†…ç½®çš„ AI æ¨¡å‹åˆ†æè¯·æ±‚ï¼Œå†³å®šè°ƒç”¨å“ªä¸ªå·¥å…·ã€‚</li>
<li><strong>å‘é€æŒ‡ä»¤ï¼š</strong> Cursor å‘ä½ çš„è„šæœ¬å‘é€ä¸€æ¡ JSON-RPC <strong>è°ƒç”¨è¯·æ±‚</strong>ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„å·¥å…·åç§°å’Œå‚æ•°ã€‚</li>
<li><strong>æ‰§è¡Œä»»åŠ¡ï¼š</strong> ä½ çš„è„šæœ¬æ¥æ”¶æŒ‡ä»¤ï¼Œæ‰§è¡Œç›¸åº”çš„å†…éƒ¨å‡½æ•°ï¼ˆä¾‹å¦‚è¯·æ±‚ <code>wttr.in</code> è·å–å¤©æ°”ï¼‰ã€‚</li>
<li><strong>åé¦ˆç»“æœï¼š</strong> è„šæœ¬å°†æ‰§è¡Œç»“æœæ‰“åŒ…æˆ JSONï¼Œé€šè¿‡ <strong>stdout</strong> å‘å›ç»™ Cursorã€‚</li>
<li><strong>ç»“æœå±•ç¤ºï¼š</strong> Cursor æ¥æ”¶åˆ°å·¥å…·è¾“å‡ºçš„åŸå§‹æ•°æ®ï¼Œå°†å…¶ä½œä¸º <strong>ä¸Šä¸‹æ–‡</strong> ä¼ é€’ç»™ AI æ¨¡å‹ï¼Œç”±æ¨¡å‹ç»„ç»‡æˆè‡ªç„¶è¯­è¨€çš„ç­”æ¡ˆå›å¤ç”¨æˆ·ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-7">3. ä»£ç å±‚é¢çš„å…³é”®å®ç°ï¼šMCP Server è¿è¡Œæœºåˆ¶ (<code>index.js</code>)</h3>
<p>æˆ‘ä»¬çš„æ³¨æ„åŠ›ä¸è¦æ”¾åœ¨ä»£ç çš„å®ç°ä¸Šï¼Œè¦æ”¾åœ¨ä»£ç çš„æµç¨‹ä¸Šï¼Œå› ä¸ºMCPåªæ˜¯ä¸€ç§è§„èŒƒã€‚</p>
<p>è¿™ä¸ª Node.js è„šæœ¬é€šè¿‡éµå¾ª MCP è§„èŒƒï¼Œå¹¶åˆ©ç”¨æ ‡å‡†è¾“å…¥/è¾“å‡ºæµ (Stdio) å®ç°é€šä¿¡ã€‚ä»¥ä¸‹æ˜¯é©±åŠ¨ MCP Server è¿è¡Œçš„äº”ä¸ªå…³é”®ä»£ç ç‰‡æ®µï¼š</p>
<h4 data-id="heading-8">3.1 æ ¸å¿ƒæ¨¡å—å¯¼å…¥ï¼šå®šä¹‰åè®®ä¸ä¼ è¾“å±‚</h4>

























<table><thead><tr><th><strong>ä»£ç ç‰‡æ®µ</strong></th><th><strong>ä½œç”¨æè¿°</strong></th><th><strong>æ ¸å¿ƒåŸç†</strong></th></tr></thead><tbody><tr><td><code>import { Server } from "@modelcontextprotocol/sdk/server/index.js";</code></td><td><strong>Server å®ä¾‹</strong></td><td>MCP æœåŠ¡ç«¯æ ¸å¿ƒç±»ï¼Œè´Ÿè´£å¤„ç† JSON-RPC è¯·æ±‚å’Œå“åº”ã€‚</td></tr><tr><td><code>import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";</code></td><td><strong>Stdio ä¼ è¾“å±‚</strong></td><td>å£°æ˜é€šä¿¡è½½ä½“æ˜¯åŸºäº <strong>æ ‡å‡†è¾“å…¥/è¾“å‡º (stdin/stdout)</strong> ï¼Œè€Œéç½‘ç»œç«¯å£ã€‚</td></tr><tr><td><code>import { CallToolRequestSchema, ListToolsRequestSchema } from ...</code></td><td><strong>åè®®å®šä¹‰</strong></td><td>å¯¼å…¥è¯·æ±‚çš„ JSON Schemaï¼Œç”¨äºè§£æ Cursor å‘æ¥çš„ä¸åŒç±»å‹çš„æŒ‡ä»¤ã€‚</td></tr></tbody></table>
<h4 data-id="heading-9">3.2 åˆå§‹åŒ– MCP æœåŠ¡å™¨</h4>
<pre><code class="hljs language-vbscript" lang="vbscript"><span class="hljs-keyword">const</span> <span class="hljs-built_in">server</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Server</span>(
  {
    name: <span class="hljs-string">"simple-weather-server"</span>,
    version: <span class="hljs-string">"1.0.0"</span>,
  },
  {
    capabilities: {
      tools: {},
    },
  }
);
</code></pre>
<p><strong>ä½œç”¨ï¼š</strong> åˆ›å»ºæœåŠ¡å™¨å®ä¾‹ã€‚<code>capabilities.tools: {}</code> æ˜ç¡®å‘Šè¯‰ MCPï¼Œè¯¥æœåŠ¡å™¨å…·å¤‡æä¾›å·¥å…·çš„èƒ½åŠ›ã€‚</p>
<h4 data-id="heading-10">3.3 æ³¨å†Œå·¥å…·åˆ—è¡¨ï¼šå“åº”â€œæ¡æ‰‹â€è¯·æ±‚</h4>
<pre><code class="hljs language-php" lang="php">server.<span class="hljs-title function_ invoke__">setRequestHandler</span>(ListToolsRequestSchema, <span class="hljs-title function_ invoke__">async</span> () =&gt; {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">tools</span>: [
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"TimeWeatherReporter"</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">"Get current system time and weather..."</span>,
        <span class="hljs-attr">inputSchema</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">properties</span>: {
            <span class="hljs-attr">location</span>: {
              <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
              <span class="hljs-attr">description</span>: <span class="hljs-string">"Optional. City name (e.g. 'Beijing')..."</span>,
            },
          },
          <span class="hljs-attr">required</span>: [],
        },
      },
    ],
  };
});
</code></pre>
<p><strong>ä½œç”¨</strong>  è¿™æ˜¯<strong>æ¡æ‰‹é˜¶æ®µï¼ˆHandshakeï¼‰</strong> çš„å…³é”®ã€‚å½“ Cursor é¦–æ¬¡å¯åŠ¨å­è¿›ç¨‹æ—¶ï¼Œä¼šå‘é€ <code>ListToolsRequestSchema</code> è¯·æ±‚ã€‚è¯¥ä»£ç ç‰‡æ®µè´Ÿè´£è¿”å›ä¸€ä¸ªæ¸…æ™°çš„ <strong>JSON Schema</strong> æè¿°ï¼š</p>
<ul>
<li><strong>name:</strong> å·¥å…·çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚</li>
<li><strong>description:</strong> ä¾› AI ç†è§£å·¥å…·ç”¨é€”çš„è‡ªç„¶è¯­è¨€æè¿°ã€‚</li>
<li><strong>inputSchema:</strong> <strong>JSON Schema</strong> æ ¼å¼çš„å‚æ•°å®šä¹‰ï¼ŒAI ä¾èµ–æ­¤ä¿¡æ¯æ¥æ„é€ æ­£ç¡®çš„è°ƒç”¨å‚æ•°ã€‚</li>
</ul>
<h4 data-id="heading-11">3.4 å¤„ç†å·¥å…·è°ƒç”¨ï¼šæ‰§è¡Œä¸šåŠ¡é€»è¾‘</h4>
<pre><code class="hljs language-csharp" lang="csharp">server.setRequestHandler(CallToolRequestSchema, <span class="hljs-keyword">async</span> (request) =&gt; {
  <span class="hljs-keyword">if</span> (request.<span class="hljs-keyword">params</span>.name === <span class="hljs-string">"TimeWeatherReporter"</span>) {
    <span class="hljs-keyword">const</span> location = request.<span class="hljs-keyword">params</span>.arguments?.location;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> getSystemStyleWeather(location); <span class="hljs-comment">// è°ƒç”¨å®é™…çš„ä¸šåŠ¡å‡½æ•°</span>
  }
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error(<span class="hljs-string">"Tool not found"</span>);
});
</code></pre>
<p><strong>ä½œç”¨ï¼š</strong> è¿™æ˜¯<strong>æ‰§è¡Œé˜¶æ®µï¼ˆExecutionï¼‰</strong> çš„æ ¸å¿ƒã€‚å½“ Cursor çš„ AI å†³å®šè°ƒç”¨å·¥å…·æ—¶ï¼Œä¼šå‘é€ <code>CallToolRequestSchema</code> è¯·æ±‚ã€‚è¿™æ®µä»£ç æ ¹æ® <code>request.params.name</code> åŒ¹é…åˆ°å¯¹åº”çš„ä¸šåŠ¡é€»è¾‘ (<code>getSystemStyleWeather</code>)ï¼Œæ‰§è¡Œåå°†ç»“æœè¿”å›ç»™ Cursorã€‚</p>
<h4 data-id="heading-12">3.5 å¯åŠ¨æœåŠ¡å™¨ï¼šè¿æ¥åˆ° Stdio æµ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StdioServerTransport</span>();
  <span class="hljs-keyword">await</span> server.<span class="hljs-title function_">connect</span>(transport);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Simple Weather MCP Server running on stdio"</span>);
}
</code></pre>
<p><strong>ä½œç”¨ï¼š</strong> <strong>è¿æ¥ç‚¹ã€‚</strong> <code>StdioServerTransport()</code> åˆ›å»ºäº†ä¼ è¾“é€šé“ï¼Œ<code>server.connect(transport)</code> åˆ™å°†æœåŠ¡å™¨å®ä¾‹ç»‘å®šåˆ°è¿™ä¸ªé€šé“ä¸Šã€‚è‡³æ­¤ï¼Œæ‚¨çš„ Node.js è„šæœ¬å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥é€šè¿‡ <code>stdin/stdout</code> ä¸ Cursor è¿›ç¨‹è¿›è¡ŒåŒå‘é€šä¿¡ã€‚</p>
<hr/>
<h3 data-id="heading-13">4. æ€»ç»“ï¼šMCP çš„æœ¬è´¨</h3>






























<table><thead><tr><th><strong>è§’è‰²</strong></th><th><strong>å®ä½“</strong></th><th><strong>èŒè´£</strong></th></tr></thead><tbody><tr><td><strong>é›‡ä¸» (Client)</strong></td><td>Cursor IDE (çˆ¶è¿›ç¨‹)</td><td>å¯åŠ¨å¹¶ç›‘æ§å·¥å…·ï¼Œå‘é€è°ƒç”¨æŒ‡ä»¤ï¼Œæ¥æ”¶å¹¶å¤„ç†ç»“æœã€‚</td></tr><tr><td><strong>é›‡å‘˜ (Server)</strong></td><td><code>node index.js</code> (å­è¿›ç¨‹)</td><td>æ¥æ”¶æŒ‡ä»¤ï¼Œæ‰§è¡Œå®é™…ä»»åŠ¡ï¼ˆå¦‚ API è°ƒç”¨ã€æ–‡ä»¶è¯»å†™ï¼‰ï¼Œè¿”å›åŸå§‹æ•°æ®ã€‚</td></tr><tr><td><strong>å·¥ä½œåˆåŒ (Protocol)</strong></td><td>MCP åè®®</td><td>è§„å®šäº†æ¡æ‰‹å’Œè°ƒç”¨è¿‡ç¨‹ä¸­ JSON æ•°æ®çš„ç»“æ„å’Œæ ‡å‡†ã€‚</td></tr><tr><td><strong>å¯¹è®²æœº (Transport)</strong></td><td>Stdio (æ ‡å‡†è¾“å…¥/è¾“å‡º)</td><td>å®ç°æœ¬åœ°çˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹ä¹‹é—´å³æ—¶ã€å®‰å…¨çš„é€šä¿¡ã€‚</td></tr></tbody></table>
<p>MCP çš„ç²¾å¦™ä¹‹å¤„åœ¨äºå®ƒçš„<strong>è§£è€¦æ€§</strong>å’Œ<strong>å®‰å…¨æ€§</strong>ï¼šCursor å®¢æˆ·ç«¯æ— éœ€å…³å¿ƒä½ çš„ Server æ˜¯ç”¨ Node.jsã€Python è¿˜æ˜¯ Go ç¼–å†™ã€‚åªè¦ä½ çš„ç¨‹åºç¬¦åˆ MCP åè®®ï¼Œèƒ½å¤Ÿé€šè¿‡å‘½ä»¤è¡Œæµæ¥æ”¶å’Œå‘é€ JSON æ•°æ®ï¼Œå®ƒå°±èƒ½æ— ç¼åœ°æˆä¸º AI çš„å¤–éƒ¨å·¥å…·ï¼Œæå¤§åœ°æ‰©å±•äº† LLM çš„èƒ½åŠ›è¾¹ç•Œã€‚</p>
<hr/>
<p><strong>è‡ªå®šä¹‰MCP Serverä»£ç </strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Server</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/index.js"</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StdioServerTransport</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/server/stdio.js"</span>;
<span class="hljs-keyword">import</span> {
  <span class="hljs-title class_">CallToolRequestSchema</span>,
  <span class="hljs-title class_">ListToolsRequestSchema</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">"@modelcontextprotocol/sdk/types.js"</span>;
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">"axios"</span>;
<span class="hljs-keyword">import</span> { z } <span class="hljs-keyword">from</span> <span class="hljs-string">"zod"</span>;

<span class="hljs-comment">// 1. Initialize MCP Server</span>
<span class="hljs-keyword">const</span> server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"simple-weather-server"</span>,
    <span class="hljs-attr">version</span>: <span class="hljs-string">"1.0.0"</span>,
  },
  {
    <span class="hljs-attr">capabilities</span>: {
      <span class="hljs-attr">tools</span>: {},
    },
  }
);

<span class="hljs-comment">// 2. Define Tool Logic using wttr.in (No API Key required)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getSystemStyleWeather</span>(<span class="hljs-params">location</span>) {
  <span class="hljs-comment">// --- Get Real Local Time (System Time) ---</span>
  <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();
  <span class="hljs-keyword">const</span> localTime = now.<span class="hljs-title function_">toLocaleTimeString</span>(<span class="hljs-string">"zh-CN"</span>, {
    <span class="hljs-attr">hour</span>: <span class="hljs-string">"2-digit"</span>,
    <span class="hljs-attr">minute</span>: <span class="hljs-string">"2-digit"</span>,
    <span class="hljs-attr">second</span>: <span class="hljs-string">"2-digit"</span>,
    <span class="hljs-attr">hour12</span>: <span class="hljs-literal">false</span>,
  });
  <span class="hljs-keyword">const</span> localDate = now.<span class="hljs-title function_">toLocaleDateString</span>(<span class="hljs-string">"zh-CN"</span>);

  <span class="hljs-comment">// --- Determine URL ---</span>
  <span class="hljs-comment">// wttr.in automatically detects location by IP if no location is provided</span>
  <span class="hljs-comment">// format=j1 gives us a JSON response</span>
  <span class="hljs-keyword">let</span> url = <span class="hljs-string">"https://wttr.in/?format=j1"</span>;
  <span class="hljs-keyword">if</span> (location) {
    url = <span class="hljs-string">`https://wttr.in/<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(location)}</span>?format=j1`</span>;
  }

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(url);
    <span class="hljs-keyword">const</span> data = response.<span class="hljs-property">data</span>;
    
    <span class="hljs-comment">// Parse wttr.in specific JSON structure</span>
    <span class="hljs-keyword">const</span> current = data.<span class="hljs-property">current_condition</span>[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">const</span> area = data.<span class="hljs-property">nearest_area</span>[<span class="hljs-number">0</span>];

    <span class="hljs-keyword">const</span> weatherInfo = {
      <span class="hljs-attr">location</span>: location || area.<span class="hljs-property">areaName</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span>, <span class="hljs-comment">// Use detected name if no input</span>
      <span class="hljs-attr">region</span>: area.<span class="hljs-property">region</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span>,
      <span class="hljs-attr">condition</span>: current.<span class="hljs-property">weatherDesc</span>[<span class="hljs-number">0</span>].<span class="hljs-property">value</span>,
      <span class="hljs-attr">temperature_c</span>: current.<span class="hljs-property">temp_C</span>,
      <span class="hljs-attr">feelslike_c</span>: current.<span class="hljs-property">FeelsLikeC</span>,
      <span class="hljs-attr">humidity</span>: current.<span class="hljs-property">humidity</span>,
      <span class="hljs-attr">wind_kph</span>: current.<span class="hljs-property">windspeedKmph</span>,
      <span class="hljs-attr">data_source</span>: <span class="hljs-string">"wttr.in (IP-based auto-location)"</span>
    };

    <span class="hljs-comment">// --- Construct Result ---</span>
    <span class="hljs-keyword">const</span> result = {
      <span class="hljs-attr">status</span>: <span class="hljs-string">"success"</span>,
      <span class="hljs-attr">tool</span>: <span class="hljs-string">"SystemWeatherReporter"</span>,
      <span class="hljs-attr">system_time</span>: <span class="hljs-string">`<span class="hljs-subst">${localDate}</span> <span class="hljs-subst">${localTime}</span>`</span>,
      <span class="hljs-attr">weather</span>: weatherInfo
    };

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">content</span>: [
        {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>),
        },
      ],
    };

  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">content</span>: [{ <span class="hljs-attr">type</span>: <span class="hljs-string">"text"</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">`Unable to fetch weather data. Please check your network connection. Error: <span class="hljs-subst">${error.message}</span>`</span> }],
      <span class="hljs-attr">isError</span>: <span class="hljs-literal">true</span>,
    };
  }
}

<span class="hljs-comment">// 3. Register Tools</span>
server.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">ListToolsRequestSchema</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">tools</span>: [
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"TimeWeatherReporter"</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">"Get current system time and weather. Automatically detects location if not specified. No API key required."</span>,
        <span class="hljs-attr">inputSchema</span>: {
          <span class="hljs-attr">type</span>: <span class="hljs-string">"object"</span>,
          <span class="hljs-attr">properties</span>: {
            <span class="hljs-attr">location</span>: {
              <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
              <span class="hljs-attr">description</span>: <span class="hljs-string">"Optional. City name (e.g. 'Beijing'). If omitted, uses auto-detection."</span>,
            },
          },
          <span class="hljs-attr">required</span>: [],
        },
      },
    ],
  };
});

<span class="hljs-comment">// 4. Handle Tool Calls</span>
server.<span class="hljs-title function_">setRequestHandler</span>(<span class="hljs-title class_">CallToolRequestSchema</span>, <span class="hljs-keyword">async</span> (request) =&gt; {
  <span class="hljs-keyword">if</span> (request.<span class="hljs-property">params</span>.<span class="hljs-property">name</span> === <span class="hljs-string">"TimeWeatherReporter"</span>) {
    <span class="hljs-keyword">const</span> location = request.<span class="hljs-property">params</span>.<span class="hljs-property">arguments</span>?.<span class="hljs-property">location</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">getSystemStyleWeather</span>(location);
  }
  <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Tool not found"</span>);
});

<span class="hljs-comment">// 5. Start Server</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> transport = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StdioServerTransport</span>();
  <span class="hljs-keyword">await</span> server.<span class="hljs-title function_">connect</span>(transport);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Simple Weather MCP Server running on stdio"</span>);
}

<span class="hljs-title function_">main</span>().<span class="hljs-keyword">catch</span>(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Server error:"</span>, error);
  process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
});

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React æ–°æ‰‹æ‘é€šå…³æŒ‡å—ï¼šçŠ¶æ€ã€ç»„ä»¶ä¸é­”æ³• UI ğŸ§™â€â™‚ï¸]]></title>    <link>https://juejin.cn/post/7583234966634233890</link>    <guid>https://juejin.cn/post/7583234966634233890</guid>    <pubDate>2025-12-14T09:07:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583234966634233890" data-draft-id="7583225356904464424" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React æ–°æ‰‹æ‘é€šå…³æŒ‡å—ï¼šçŠ¶æ€ã€ç»„ä»¶ä¸é­”æ³• UI ğŸ§™â€â™‚ï¸"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,React.js"/> <meta itemprop="datePublished" content="2025-12-14T09:07:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaoxue_"/> <meta itemprop="url" content="https://juejin.cn/user/4065372122398027"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React æ–°æ‰‹æ‘é€šå…³æŒ‡å—ï¼šçŠ¶æ€ã€ç»„ä»¶ä¸é­”æ³• UI ğŸ§™â€â™‚ï¸
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4065372122398027/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    xiaoxue_
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:07:45.000Z" title="Sun Dec 14 2025 09:07:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">React å…¥é—¨ï¼šä» JSX åˆ°ç»„ä»¶åŒ–ï¼Œæå®šæ ¸å¿ƒçŸ¥è¯†ç‚¹ ğŸš€</h2>
<h3 data-id="heading-1">ä¸€ã€ ä»€ä¹ˆæ˜¯ React &amp; ä¸ºä»€ä¹ˆé€‰æ‹© Reactï¼ŸğŸ¯</h3>
<p>å¦‚æœä½ é—®å‰ç«¯åœˆçš„ç¨‹åºçŒ¿ â€œç°åœ¨æœ€ç«çš„ UI åº“æ˜¯ä»€ä¹ˆâ€ï¼Œåæœ‰å…«ä¹ä¼šå¬åˆ° â€œReactâ€ è¿™ä¸ªåå­—ã€‚ç®€å•æ¥è¯´ï¼ŒReact æ˜¯ Facebookï¼ˆç°åœ¨çš„ Metaï¼‰æ¨å‡ºçš„ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ï¼Œå®ƒå°±åƒä¸€ä¸ªè¶…çº§é«˜æ•ˆçš„ â€œUI å»ºç­‘å¸ˆâ€ï¼Œè®©æˆ‘ä»¬èƒ½è½»æ¾æ­å»ºå‡ºäº¤äº’ä¸°å¯Œã€æ€§èƒ½èƒ½æ‰“çš„ç½‘é¡µã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦å­¦ React å‘¢ï¼Ÿâ€œreact ä¸€å¼€å§‹å°±æ˜¯ç»„ä»¶æ€æƒ³ï¼Œéå¸¸çš„çº¯ç²¹â€ã€‚å’Œä¼ ç»Ÿå‰ç«¯å¼€å‘ç›¸æ¯”ï¼ŒReact æœ‰ä¸‰ä¸ª â€œæ’’æ‰‹é”â€ï¼šå“åº”å¼ï¼ˆæ•°æ®å˜äº† UI è‡ªåŠ¨æ›´ï¼‰ã€æ•°æ®ç»‘å®šï¼ˆæ•°æ®å’Œ UI æ‰‹æ‹‰æ‰‹ï¼‰ã€ç»„ä»¶åŒ–ï¼ˆæŠŠé¡µé¢æ‹†æˆä¸€å—å—å¯å¤ç”¨çš„ â€œç§¯æœ¨â€ï¼‰ã€‚è™½ç„¶æœ‰äººè¯´å®ƒå…¥é—¨é—¨æ§›æ¯” Vue é«˜ä¸€ç‚¹ï¼Œä½†ä¸€æ—¦ä¸Šæ‰‹ï¼Œä½ ä¼šå‘ç°è¿™ç§ â€œæ¿€è¿›â€ çš„è®¾è®¡æ€è·¯ç‰¹åˆ«é€‚åˆå¤æ‚åº”ç”¨å¼€å‘ï¼Œæ¯•ç«Ÿè°ä¸æƒ³å†™ä¸€æ¬¡ä»£ç åˆ°å¤„å¤ç”¨å‘¢ï¼Ÿ</p>
<h3 data-id="heading-2">äºŒã€ JSX è¯­æ³•ï¼šåœ¨ JS é‡Œå†™ HTMLï¼Ÿè¿™æ“ä½œæœ‰ç‚¹ç§€ï¼âœ¨</h3>
<h4 data-id="heading-3">2.1 ä»€ä¹ˆæ˜¯ JSXï¼Ÿ</h4>
<p>ç¬¬ä¸€æ¬¡çœ‹åˆ° JSX ä»£ç çš„åŒå­¦å¯èƒ½ä¼šæ‡µï¼šâ€œè¿™åˆ°åº•æ˜¯ JS è¿˜æ˜¯ HTMLï¼Ÿâ€ å…¶å®å®˜æ–¹è§£é‡Šå¾ˆç›´ç™½ â€”â€”<strong>JSX å°±æ˜¯ â€œXML in JSâ€</strong> ï¼ˆåœ¨ JavaScript é‡Œå†™ XMLï¼‰ï¼Œè€Œæˆ‘ä»¬ç†Ÿæ‚‰çš„ HTMLï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„ XMLã€‚</p>
<p>çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// JSXå†™æ³•</span>
<span class="hljs-keyword">const</span> element = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>JSX æ˜¯ React ä¸­ç”¨äºæè¿°ç”¨æˆ·ç•Œé¢çš„è¯­æ³•æ‰©å±•<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span>

<span class="hljs-comment">// ç­‰æ•ˆçš„åŸç”ŸJSå†™æ³•ï¼ˆJSXçš„ç¼–è¯‘ç»“æœï¼‰</span>
<span class="hljs-keyword">const</span> element2 = <span class="hljs-title function_">createElement</span>(<span class="hljs-string">'h2'</span>, <span class="hljs-literal">null</span>,<span class="hljs-string">'JSX æ˜¯ React ä¸­ç”¨äºæè¿°ç”¨æˆ·ç•Œé¢çš„è¯­æ³•æ‰©å±•'</span>);
</code></pre>
<p>è¿™ä¸¤è¡Œä»£ç æ•ˆæœå®Œå…¨ä¸€æ ·ï¼Œä½†æ˜¾ç„¶ JSX ç‰ˆæœ¬æ›´åƒ â€œäººè¯â€ã€‚æ‰€ä»¥è¯´ï¼ŒJSX æœ¬è´¨æ˜¯<code>createElement</code>å‡½æ•°çš„è¯­æ³•ç³–ï¼Œå®ƒçš„å­˜åœ¨å°±æ˜¯ä¸ºäº†è®©æˆ‘ä»¬å†™ UI æ—¶å°‘æ‰ç‚¹å¤´å‘ï¼Œæ¯•ç«Ÿè°æ„¿æ„å¯¹ç€ä¸€å †åµŒå¥—çš„å‡½æ•°è°ƒç”¨æµæ³ªå‘¢ï¼Ÿ</p>
<h4 data-id="heading-4">2.2 JSX çš„åŸºæœ¬è¯­æ³•</h4>
<p>è™½ç„¶ JSX çœ‹èµ·æ¥åƒ HTMLï¼Œä½†å®ƒæœ‰å‡ ä¸ª â€œå°æ€ªç™–â€ éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>
<p><strong>å¿…é¡»æœ‰æ ¹å…ƒç´ åŒ…è£¹</strong>å°±åƒå¿«é€’å¿…é¡»æœ‰åŒ…è£…ç›’ï¼ŒJSX è¿”å›çš„å†…å®¹ä¹Ÿå¾—æœ‰ä¸ª â€œæ ¹å®¹å™¨â€ã€‚æ¯”å¦‚ä¸‹é¢ç”¨<code>&lt;div&gt;</code>å½“å®¹å™¨ï¼Œä¹Ÿå¯ä»¥ç”¨ React æä¾›çš„<code>&lt;Fragment&gt;</code>ï¼ˆæ–‡æ¡£ç¢ç‰‡ï¼‰å½“ â€œéšå½¢å®¹å™¨â€ï¼Œé¿å…å¤šä¸€å±‚ä¸å¿…è¦çš„ DOM èŠ‚ç‚¹ã€‚</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ­£ç¡®ï¼šæœ‰æ ¹å…ƒç´ åŒ…è£¹</span>
<span class="hljs-keyword">return</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>content<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
)

<span class="hljs-comment">// é”™è¯¯ï¼šæ²¡æœ‰æ ¹å…ƒç´ </span>
<span class="hljs-keyword">return</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>content<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
)
</code></pre>
</li>
<li>
<p><strong>class è¦å†™æˆ className</strong>ï¼Œå¦‚æœä½ åœ¨ JSX é‡Œå†™<code>&lt;div class="box"&gt;</code>ï¼ŒReact ä¼šç»™ä½ æŠ›é”™ â€”â€” å› ä¸º<code>class</code>æ˜¯ JavaScript çš„å…³é”®å­—ï¼Œæ‰€ä»¥å¾—æ”¹ç”¨<code>className</code>ã€‚æ¯”å¦‚ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-ini" lang="ini">// æ­£ç¡®å†™æ³•
&lt;span <span class="hljs-attr">className</span>=<span class="hljs-string">"title"</span>&gt;Hello&lt;/span&gt;

// é”™è¯¯å†™æ³•ï¼ˆä¼šæŠ¥é”™ï¼‰
&lt;span <span class="hljs-attr">class</span>=<span class="hljs-string">"title"</span>&gt;Hello&lt;/span&gt;
</code></pre>
</li>
<li>
<p><strong>è¡¨è¾¾å¼è¦ç”¨å¤§æ‹¬å·åŒ…èµ·æ¥</strong>æƒ³åœ¨ JSX é‡Œæ’å…¥å˜é‡æˆ–è¡¨è¾¾å¼ï¼Ÿç”¨<code>{}</code>å°±è¡Œï¼æ¯”å¦‚ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> name = <span class="hljs-string">"React"</span>;
<span class="hljs-keyword">const</span> isLoggedIn = <span class="hljs-literal">true</span>;

<span class="hljs-comment">// æ’å…¥å˜é‡</span>
<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello {name}!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;

<span class="hljs-comment">// æ’å…¥æ¡ä»¶è¡¨è¾¾å¼</span>
<span class="hljs-keyword">return</span> {isLoggedIn ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å·²ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span> : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æœªç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>};
</code></pre>
</li>
</ol>
<h3 data-id="heading-5">ä¸‰ã€ ç»„ä»¶åŒ–ï¼šå‰ç«¯å¼€å‘çš„ â€œä¹é«˜ç§¯æœ¨â€ğŸ§©</h3>
<h4 data-id="heading-6">3.1 ä»€ä¹ˆæ˜¯ç»„ä»¶ï¼Ÿ</h4>
<p>ç»„ä»¶å°±åƒç½‘é¡µçš„ â€œåŠŸèƒ½æ¨¡å—â€â€”â€” æŠŠ HTMLã€CSSã€JS æ‰“åŒ…æˆä¸€ä¸ªç‹¬ç«‹å•å…ƒï¼Œå®Œæˆç‰¹å®šåŠŸèƒ½ã€‚æ¯”å¦‚ä¸‹é¢çš„<code>JuejinHeader</code>æ˜¯å¤´éƒ¨ç»„ä»¶ï¼Œ<code>Ariticles</code>æ˜¯æ–‡ç« åˆ—è¡¨ç»„ä»¶ï¼Œå®ƒä»¬å°±åƒä¹é«˜ç§¯æœ¨ï¼Œæ‹¼åœ¨ä¸€èµ·å°±æˆäº†å®Œæ•´é¡µé¢ã€‚</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¤´éƒ¨ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">JuejinHeader</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span>(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>JueJiné¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-comment">// æ–‡ç« åˆ—è¡¨ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">Ariticles</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span>(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      Articles
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<h4 data-id="heading-7">3.2 ä¸ºä»€ä¹ˆ React é€‰å‡½æ•°å½“ç»„ä»¶ï¼Ÿ</h4>
<p>React é‡Œçš„ç»„ä»¶å¤§å¤šæ˜¯å‡½æ•°ï¼Œè¿™å¯ä¸æ˜¯éšä¾¿é€‰çš„ã€‚å‡½æ•°é€‚åˆåšç»„ä»¶ï¼Œå› ä¸ºèƒ½å°† JSX + é€»è¾‘å°è£…æˆä¸€ä¸ªç»„ä»¶ã€‚æƒ³æƒ³çœ‹ï¼Œå‡½æ•°æ¥æ”¶å‚æ•°ã€å¤„ç†é€»è¾‘ã€è¿”å›ç»“æœï¼Œç»„ä»¶æ¥æ”¶æ•°æ®ã€å¤„ç†äº¤äº’ã€è¿”å› UIï¼Œç®€ç›´æ˜¯å¤©é€ åœ°è®¾ï¼</p>
<p>æ¯”å¦‚æœ€ç®€åŒ–çš„ç»„ä»¶é•¿è¿™æ ·ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¸€ä¸ªç®€å•çš„ç­¾åˆ°ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">Checkin</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span>(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Checkin<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p>ä¸€è¡Œä¸å¤šä¸€è¡Œä¸å°‘ï¼Œé€»è¾‘å’Œ UI å®Œç¾èåˆï½</p>
<h4 data-id="heading-8">3.3 æ ¹ç»„ä»¶ä¸å­ç»„ä»¶ç»„åˆå½¢æˆç»„ä»¶æ ‘</h4>
<p>æ•´ä¸ª React åº”ç”¨å°±åƒä¸€æ£µå¤§æ ‘ï¼Œæœ‰ä¸€ä¸ª â€œæ ¹ç»„ä»¶â€ï¼Œå…¶ä»–ç»„ä»¶éƒ½æ˜¯å®ƒçš„ â€œå­ç»„ä»¶â€ã€‚ä»¥æ˜é‡‘é¦–é¡µä¸ºä¾‹å±•ç¤ºæ ¹ç»„ä»¶ã€å­ç»„ä»¶ä»¥åŠç»„ä»¶æ ‘çš„çŸ¥è¯†å†…å®¹ã€‚ä¸‹é¢ä»£ç çš„<code>JuejinHeader</code>ã€<code>Ariticles</code>éƒ½æ˜¯<code>APP</code>çš„å­ç»„ä»¶ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0c35fc6835ad49209e1e507e53a0d5a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3h1ZV8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766308065&amp;x-signature=72aKSAetDB30TDjCdvgsp3%2BPz9I%3D" alt="QQ20251214-161150.png" loading="lazy"/></p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">JuejinHeader</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span>(
    <span class="hljs-comment">// jsx æœ€å¤–å±‚</span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>JueJiné¦–é¡µ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Ariticles</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span>(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      Articles
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Checkin</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span>(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      Checkin
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">TopArticles</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span>(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      TopArticles
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}



<span class="hljs-comment">// æ ¹ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">APP</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// å­ç»„ä»¶ä»¬</span>
  <span class="hljs-keyword">return</span>(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello <span class="hljs-tag">&lt;<span class="hljs-name">b</span>&gt;</span>React!<span class="hljs-tag">&lt;/<span class="hljs-name">b</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span> */}
      {/* å¤´éƒ¨ç»„ä»¶ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">JuejinHeader</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
        {/* ç»„ä»¶ä¹Ÿå’Œhtml ä¸€æ ·å£°æ˜ï¼Œè‡ªå®šä¹‰ç»„ä»¶ */}
        {/* ç»„ä»¶åŒ–è®©æˆ‘ä»¬åƒæ­ç§¯æœ¨ä¸€æ ·ç»„åˆæˆé¡µé¢ */}
        <span class="hljs-tag">&lt;<span class="hljs-name">Ariticles</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">aside</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Checkin</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">TopArticles</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-variable constant_">APP</span> 
</code></pre>
<p>ç»„ä»¶æ ‘ä»¥ä¸€ä¸ª<strong>æ ¹ç»„ä»¶</strong>ä¸ºèµ·ç‚¹ï¼ˆå°±åƒæ ‘å¹²ï¼‰ï¼Œå…¶ä»–ç»„ä»¶ä½œä¸º â€œå­ç»„ä»¶â€ï¼ˆæ ‘æå’Œæ ‘å¶ï¼‰åµŒå¥—åœ¨å…¶ä¸­ï¼Œå½¢æˆæ˜ç¡®çš„å±‚çº§å…³ç³»ã€‚æ•´ä¸ª React åº”ç”¨çš„ UI ç»“æ„ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€æ£µç»„ä»¶æ ‘çš„å¯è§†åŒ–å‘ˆç°ã€‚ä¸Šé¢è¿™æ®µä»£ç å½¢æˆçš„ç»„ä»¶æ ‘ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-css" lang="css">APPï¼ˆæ ¹ï¼‰
â”œâ”€ JuejinHeader
â””â”€ <span class="hljs-selector-tag">main</span>
   â”œâ”€ Ariticles
   â””â”€ <span class="hljs-selector-tag">aside</span>
      â”œâ”€ Checkin
      â””â”€ TopArticles
</code></pre>
<h3 data-id="heading-9">å››ã€ çŠ¶æ€ï¼šè®©ç»„ä»¶ â€œåŠ¨â€ èµ·æ¥çš„é­”æ³•ğŸ“¦</h3>
<h4 data-id="heading-10">4.1 ä»€ä¹ˆæ˜¯ state çŠ¶æ€ï¼Ÿ</h4>
<p>å¦‚æœè¯´ç»„ä»¶æ˜¯ â€œèº«ä½“â€ï¼Œé‚£çŠ¶æ€ï¼ˆstateï¼‰å°±æ˜¯ â€œçµé­‚â€â€”â€” å®ƒæ˜¯ç»„ä»¶å†…éƒ¨çš„ â€œæ•°æ®ä»“åº“â€ï¼Œå†³å®šäº†ç»„ä»¶çš„æ ·å­å’Œè¡Œä¸ºã€‚æ¯”å¦‚ç”¨æˆ·æ˜¯å¦ç™»å½•ã€å¾…åŠäº‹é¡¹åˆ—è¡¨ã€å½“å‰æ˜¾ç¤ºçš„åå­—ï¼Œè¿™äº›éƒ½æ˜¯çŠ¶æ€ã€‚</p>
<h4 data-id="heading-11">4.2 useStateï¼šçŠ¶æ€ç®¡ç†çš„ â€œé‡‘é’¥åŒ™â€</h4>
<p>React æä¾›äº†<code>useState</code>è¿™ä¸ªé’©å­å‡½æ•°æ¥ç®¡ç†çŠ¶æ€ï¼Œå®ƒçš„ç”¨æ³•å°±åƒ â€œæ‹†ç›²ç›’â€ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¼•å…¥useState</span>
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// å£°æ˜çŠ¶æ€ï¼šåˆå§‹å€¼ä¸º"vue"ï¼ŒsetNameç”¨äºæ›´æ–°çŠ¶æ€</span>
<span class="hljs-keyword">const</span> [name, setName] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">"vue"</span>);
</code></pre>
<p>è¿™å‡ è¡Œä»£ç åšäº†ä¸‰ä»¶äº‹ï¼š</p>
<ol>
<li>å£°æ˜äº†ä¸€ä¸ªå«<code>name</code>çš„çŠ¶æ€ï¼Œåˆå§‹å€¼æ˜¯ â€œvueâ€</li>
<li>å¾—åˆ°ä¸€ä¸ªæ›´æ–°çŠ¶æ€çš„å‡½æ•°<code>setName</code></li>
<li>å½“<code>setName</code>è¢«è°ƒç”¨æ—¶ï¼Œç»„ä»¶ä¼šé‡æ–°æ¸²æŸ“ï¼ŒUI è‡ªåŠ¨æ›´æ–°</li>
</ol>
<p>æ¯”å¦‚ 3 ç§’åæ›´æ–°çŠ¶æ€ï¼Œé¡µé¢ä¼šè‡ªåŠ¨å˜åŒ–ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// 3ç§’åå°†nameä»"vue"æ”¹ä¸º"react"</span>
<span class="hljs-built_in">setTimeout</span>(() =&gt; {
  <span class="hljs-built_in">setName</span>("react");
}, <span class="hljs-number">3000</span>);
</code></pre>
<p><strong>æ•ˆæœå±•ç¤ºï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f485aad6376d450da53e8940fcd781ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3h1ZV8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766308065&amp;x-signature=FlyQL1waew9Og52Uc%2F6QUEL9ruk%3D" alt="QQ20251214-16249.gif" loading="lazy"/></p>
<h4 data-id="heading-12">4.3 å¤šç§çŠ¶æ€ç®¡ç†</h4>
<p>ä¸€ä¸ªç»„ä»¶å¯ä»¥æœ‰å¤šä¸ªçŠ¶æ€ï¼Œå°±åƒä¸€ä¸ªäººå¯ä»¥æœ‰ â€œå§“åâ€â€œå¹´é¾„â€â€œèŒä¸šâ€ å¤šä¸ªå±æ€§ã€‚æ¯”å¦‚åŒæ—¶ç®¡ç†ä¸‰ä¸ªçŠ¶æ€ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// æ¡†æ¶åç§°çŠ¶æ€</span>
<span class="hljs-keyword">const</span> [name, setName] = <span class="hljs-title function_ invoke__">useState</span>(<span class="hljs-string">"vue"</span>);

<span class="hljs-comment">// å¾…åŠäº‹é¡¹åˆ—è¡¨çŠ¶æ€</span>
<span class="hljs-keyword">const</span> [todos, setTodos] = <span class="hljs-title function_ invoke__">useState</span>([
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"å­¦ä¹ react"</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"å­¦ä¹ node"</span>, <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span> }
]);

<span class="hljs-comment">// ç™»å½•çŠ¶æ€</span>
<span class="hljs-keyword">const</span> [isLoggedIn, setIsLonggedIn] = <span class="hljs-title function_ invoke__">useState</span>(<span class="hljs-literal">false</span>);
</code></pre>
<p>æ¯ä¸ªçŠ¶æ€ç‹¬ç«‹ç®¡ç†ï¼Œäº’ä¸å¹²æ‰°ï¼Œä»£ç é€»è¾‘æ¸…æ™°å¾—å¾ˆï½</p>
<h3 data-id="heading-13">äº”ã€ æ¸²æŸ“ï¼šè®©æ•°æ® â€œé•¿â€ æˆ UI çš„è‰ºæœ¯ğŸ–Œï¸</h3>
<h4 data-id="heading-14">5.1 æ¡ä»¶æ¸²æŸ“ï¼šæ ¹æ®çŠ¶æ€ â€œå˜é­”æœ¯â€</h4>
<p>React é‡Œçš„æ¡ä»¶æ¸²æŸ“å°±åƒ â€œif-elseâ€ çš„å¯è§†åŒ–ç‰ˆæœ¬ï¼ŒjSXä¸­ä¸èƒ½ç›´æ¥ä½¿ç”¨â€œif-elseâ€è¯­æ³•ï¼ˆå› ä¸º JSX å¤§æ‹¬å·<code>{}</code>å†…åªèƒ½æ”¾<strong>è¡¨è¾¾å¼</strong>ï¼Œè€Œ<code>if else</code>æ˜¯è¯­å¥ï¼‰ï¼Œé€šå¸¸ä½¿ç”¨ä¸‰ç›®è¿ç®—ç¬¦ä»£æ›¿ã€‚æ¯”å¦‚åˆ¤æ–­å¾…åŠäº‹é¡¹æ˜¯å¦ä¸ºç©ºï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æœ‰æ•°æ®æ—¶æ˜¾ç¤ºåˆ—è¡¨ï¼Œæ— æ•°æ®æ—¶æ˜¾ç¤ºæç¤º</span>
todos.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> ? (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    {/* åˆ—è¡¨å†…å®¹ */}
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span>
) : (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æš‚æ— å¾…åŠäº‹é¡¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
)
</code></pre>
<p>ç™»å½•çŠ¶æ€çš„æ˜¾ç¤ºä¹Ÿæ˜¯åŒç†ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ ¹æ®ç™»å½•çŠ¶æ€æ˜¾ç¤ºä¸åŒå†…å®¹</span>
{isLoggedIn ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å·²ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span> : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æœªç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>}
</code></pre>
<h4 data-id="heading-15">5.2 åˆ—è¡¨æ¸²æŸ“ï¼šç”¨ map () æ‰¹é‡ â€œç”Ÿäº§â€ UI</h4>
<p>å½“éœ€è¦æ¸²æŸ“åˆ—è¡¨ï¼ˆæ¯”å¦‚å¾…åŠäº‹é¡¹ã€å•†å“åˆ—è¡¨ï¼‰æ—¶ï¼Œ<code>map()</code>æ–¹æ³•å°±æ˜¯ç¥å™¨ã€‚æ¯”å¦‚æ¸²æŸ“ todos åˆ—è¡¨ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript">&lt;ul&gt;
  {
    todos.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> (
      <span class="hljs-comment">// æ¯ä¸ªåˆ—è¡¨é¡¹å¿…é¡»æœ‰å”¯ä¸€key</span>
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>&gt;</span>
        {todo.title}
      <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span>
    ))
  }
&lt;/ul&gt;
</code></pre>
<p>è¿™é‡Œæœ‰ä¸ªå°ç»†èŠ‚ï¼šæ¯ä¸ªåˆ—è¡¨é¡¹å¿…é¡»åŠ <code>key</code>å±æ€§ï¼ˆé€šå¸¸ç”¨å”¯ä¸€ IDï¼‰ï¼Œè¿™æ˜¯ React çš„ â€œæ€§èƒ½æš—å·â€ï¼Œå¸®åŠ©å®ƒå¿«é€Ÿè¯†åˆ«å“ªäº›é¡¹æ²¡å˜ï¼Œé¿å…é‡å¤æ¸²æŸ“ â€”â€” ä¸åŠ  key è™½ç„¶èƒ½è¿è¡Œï¼Œä½†å¯èƒ½ä¼šæœ‰æ€§èƒ½é—®é¢˜å“¦ï¼</p>
<h3 data-id="heading-16">å…­ã€ äº‹ä»¶å¤„ç†ï¼šç»™ç»„ä»¶ â€œè£…å¼€å…³â€ğŸ”Œ</h3>
<p>React é‡Œçš„äº‹ä»¶å¤„ç†å°±åƒç»™ç»„ä»¶è£…å¼€å…³ï¼Œç‚¹å‡»ã€è¾“å…¥ç­‰æ“ä½œéƒ½ä¼šè§¦å‘å¯¹åº”çš„å‡½æ•°ã€‚è¯­æ³•ä¸Šæœ‰ä¸ªå°ç‰¹ç‚¹ï¼šäº‹ä»¶åè¦ç”¨é©¼å³°å‘½åï¼ˆæ¯”å¦‚<code>onClick</code>è€Œä¸æ˜¯<code>onclick</code>ï¼‰ã€‚</p>
<p>æ¯”å¦‚ç™»å½•æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼š</p>
<p>jsx</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ‡æ¢ç™»å½•çŠ¶æ€çš„å‡½æ•°</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleLogin</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">setIsLonggedIn</span>(!isLoggedIn);
};

<span class="hljs-comment">// æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleLogin}</span>&gt;</span>
  {isLoggedIn ? "é€€å‡ºç™»å½•" : "ç™»å½•"}
<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
</code></pre>
<p>ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œ<code>toggleLogin</code>å‡½æ•°ä¼šåˆ‡æ¢<code>isLoggedIn</code>çŠ¶æ€ï¼ŒæŒ‰é’®æ–‡å­—å’Œç™»å½•çŠ¶æ€æ˜¾ç¤ºä¼šè‡ªåŠ¨æ›´æ–° â€”â€” è¿™å°±æ˜¯ â€œæ•°æ®é©±åŠ¨ UIâ€ çš„é­…åŠ›ï¼Œæˆ‘ä»¬åªéœ€è¦ç®¡æ•°æ®æ€ä¹ˆå˜ï¼ŒUI è‡ªç„¶ä¼šè·Ÿä¸Šã€‚</p>
<h3 data-id="heading-17">ä¸ƒã€å®æˆ˜æ¼”ç»ƒ-ç®€å•çš„å­¦ä¹ ä»»åŠ¡æ¸…å•ç™»é™†ç•Œé¢</h3>
<h4 data-id="heading-18">7.1 ä»£ç å±•ç¤ºï¼š</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// JSX è´Ÿè´£UI</span>
<span class="hljs-comment">// use ä½¿ç”¨</span>
<span class="hljs-comment">// state æ•°æ®çŠ¶æ€</span>

<span class="hljs-keyword">import</span> {useState} <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./App.css'</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// const name = "vue";</span>
    <span class="hljs-comment">// useState ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„</span>
    <span class="hljs-comment">// æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯çŠ¶æ€å€¼ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯æ›´æ–°çŠ¶æ€å€¼çš„å‡½æ•°</span>
    <span class="hljs-keyword">const</span> [name,setName] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">"vue"</span>);
    <span class="hljs-keyword">const</span> [todos, setTodos] = <span class="hljs-title function_">useState</span>([{
        <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">title</span>: <span class="hljs-string">"å­¦ä¹ react"</span>,
        <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span>,
    },
    {
        <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
        <span class="hljs-attr">title</span>: <span class="hljs-string">"å­¦ä¹ node"</span>,
        <span class="hljs-attr">done</span>: <span class="hljs-literal">false</span>,

    }]);
    <span class="hljs-keyword">const</span> [isLoggedIn,setIsLonggedIn] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-title function_">setName</span>(<span class="hljs-string">"react"</span>);
    },<span class="hljs-number">3000</span>);
    <span class="hljs-comment">// ç»„ä»¶çš„æ•°æ®ä¸šåŠ¡ã€äº¤äº’ç­‰</span>
    <span class="hljs-comment">// JSX jsé‡Œé¢ï¼Œclass æ˜¯js å…³é”®å­— ä¸èƒ½ç”¨ï¼Œç”¨className</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">toggleLogin</span> = (<span class="hljs-params"/>) =&gt; {
        <span class="hljs-title function_">setIsLonggedIn</span>(!isLoggedIn);
    }
    <span class="hljs-keyword">return</span>(
        <span class="hljs-comment">// æ–‡æ¡£ç¢ç‰‡æ ‡ç­¾</span>
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"title"</span>&gt;</span>{name}!<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            {
                todos.length &gt; 0 ? (
                    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                        {
                            todos.map((todo) =&gt; (
                                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>&gt;</span>
                                    {todo.title}
                                <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                            ))
                        }
                    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
                ) : (<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æš‚æ— å¾…åŠäº‹é¡¹<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>)
            }
            {isLoggedIn ? <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å·²ç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>:<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æœªç™»å½•<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span> = <span class="hljs-string">{toggleLogin}</span>&gt;</span>
                {isLoggedIn?"é€€å‡ºç™»å½•":"ç™»å½•"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>
</code></pre>
<h4 data-id="heading-19">7.2 é¡¹ç›®ä»‹ç»</h4>
<p>è¿™ä¸ªé¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº React çš„ç®€å•ç¤ºä¾‹ï¼Œä¸»è¦å±•ç¤ºäº† React çš„æ ¸å¿ƒç‰¹æ€§ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p>
<ol>
<li>
<p><strong>æŠ€æœ¯åŸºç¡€</strong>ï¼šä½¿ç”¨ React æ¡†æ¶å¼€å‘ï¼Œé‡‡ç”¨ JSX è¯­æ³•æè¿° UI ç•Œé¢ï¼Œé€šè¿‡<code>import</code>å¼•å…¥ React çš„<code>useState</code>ï¼ˆçŠ¶æ€ç®¡ç†ï¼‰APIã€‚</p>
</li>
<li>
<p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼š</p>
<ul>
<li>åŠ¨æ€æ–‡æœ¬å±•ç¤ºï¼šé€šè¿‡<code>name</code>çŠ¶æ€æ§åˆ¶æ ‡é¢˜æ–‡æœ¬ï¼Œåˆå§‹æ˜¾ç¤º "Hello vue!"ï¼Œ3 ç§’åè‡ªåŠ¨æ›´æ–°ä¸º "Hello react!"ã€‚</li>
<li>å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼šåŸºäº<code>todos</code>çŠ¶æ€æ¸²æŸ“å¾…åŠäº‹é¡¹åˆ—è¡¨ï¼Œè‹¥åˆ—è¡¨ä¸ºç©ºåˆ™æ˜¾ç¤º "æš‚æ— å¾…åŠäº‹é¡¹"ã€‚</li>
<li>ç™»å½•çŠ¶æ€åˆ‡æ¢ï¼šé€šè¿‡<code>isLoggedIn</code>çŠ¶æ€ç®¡ç†ç™»å½•çŠ¶æ€ï¼Œç‚¹å‡»æŒ‰é’®å¯åˆ‡æ¢ "ç™»å½• / é€€å‡ºç™»å½•" çŠ¶æ€ï¼Œå¹¶åŒæ­¥æ˜¾ç¤ºå¯¹åº”çš„çŠ¶æ€æ–‡æœ¬ã€‚</li>
</ul>
</li>
<li>
<p><strong>React ç‰¹æ€§ä½“ç°</strong>ï¼š</p>
<ul>
<li>çŠ¶æ€ç®¡ç†ï¼šä½¿ç”¨<code>useState</code>é’©å­ç®¡ç†ç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼ˆ<code>name</code>ã€<code>todos</code>ã€<code>isLoggedIn</code>ï¼‰ï¼Œé€šè¿‡çŠ¶æ€æ›´æ–°å‡½æ•°ï¼ˆå¦‚<code>setName</code>ã€<code>setIsLonggedIn</code>ï¼‰è§¦å‘ UI é‡æ–°æ¸²æŸ“ã€‚</li>
<li>æ¡ä»¶æ¸²æŸ“ï¼šé€šè¿‡ä¸‰å…ƒè¡¨è¾¾å¼æ ¹æ®çŠ¶æ€ï¼ˆå¦‚<code>todos.length</code>ã€<code>isLoggedIn</code>ï¼‰åŠ¨æ€å±•ç¤ºä¸åŒ UI å†…å®¹ã€‚</li>
<li>JSX è¯­æ³•ï¼šåœ¨ JavaScript ä¸­ç›´æ¥ç¼–å†™ç±»ä¼¼ HTML çš„æ ‡ç­¾ï¼ŒåŒæ—¶æ”¯æŒåµŒå…¥å˜é‡ï¼ˆå¦‚<code>{name}</code>ï¼‰å’Œè¡¨è¾¾å¼ã€‚</li>
</ul>
</li>
</ol>
<p>æ•´ä½“æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º React çŠ¶æ€ä¸ UI è”åŠ¨ã€ç»„ä»¶åŒ–å¼€å‘æ€æƒ³çš„åŸºç¡€ç¤ºä¾‹ã€‚</p>
<h4 data-id="heading-20">7.3 æ•ˆæœäº®ä¸ªç›¸</h4>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9b93e6df4af9439090396625c897814d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgeGlhb3h1ZV8=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766308065&amp;x-signature=Nrf9SD%2BvbhoFONtoYVaUMhJs8Gw%3D" alt="QQ20251214-164631.gif" loading="lazy"/></p>
<h3 data-id="heading-21">å…«ã€ æ€»ç»“ï¼šReact æ ¸å¿ƒçŸ¥è¯†æ¸…å• &amp; ç»“è¯­ğŸ“</h3>
<h4 data-id="heading-22">8.1 çŸ¥è¯†æ¸…å•</h4>
<ol>
<li>React æ˜¯ä¸“æ³¨äº UI çš„åº“ï¼Œæ ¸å¿ƒæ˜¯ç»„ä»¶åŒ–å’Œå“åº”å¼</li>
<li>JSX æ˜¯ â€œJS é‡Œå†™ XMLâ€ çš„è¯­æ³•ç³–ï¼Œç®€åŒ– UI å¼€å‘</li>
<li>ç»„ä»¶æ˜¯å‡½æ•°ï¼Œå°è£… UI å’Œé€»è¾‘ï¼Œå¯ç»„åˆæˆç»„ä»¶æ ‘</li>
<li>ç”¨<code>useState</code>ç®¡ç†çŠ¶æ€ï¼ŒçŠ¶æ€å˜åˆ™ UI å˜</li>
<li>æ¡ä»¶æ¸²æŸ“ç”¨ä¸‰ç›®è¿ç®—ç¬¦ï¼Œåˆ—è¡¨æ¸²æŸ“ç”¨<code>map()</code>+<code>key</code></li>
<li>äº‹ä»¶å¤„ç†ç”¨é©¼å³°å‘½åï¼Œç»‘å®šå‡½æ•°æ“ä½œçŠ¶æ€</li>
</ol>
<h4 data-id="heading-23">8.2 ç»“è¯­</h4>
<p>å­¦ React å°±åƒå­¦æ­ç§¯æœ¨ â€”â€” ä¸€å¼€å§‹å¯èƒ½è§‰å¾— â€œè¿™é›¶ä»¶æ€ä¹ˆæ‹¼â€ï¼Œä½†æŒæ¡äº† JSXã€ç»„ä»¶ã€çŠ¶æ€è¿™äº› â€œåŸºç¡€å—â€ åï¼Œä½ ä¼šå‘ç°å†å¤æ‚çš„é¡µé¢ä¹Ÿèƒ½ä¸€æ­¥æ­¥æ­å‡ºæ¥ã€‚</p>
<p>React æ›´åŠ æ¿€è¿›ï¼Œä½†è¿™ç§æ¿€è¿›æ°æ°è®©å®ƒæˆä¸ºå‰ç«¯å¼€å‘çš„ â€œç‘å£«å†›åˆ€â€â€”â€” æ— è®ºæ˜¯å°åº”ç”¨è¿˜æ˜¯å¤§å‹é¡¹ç›®ï¼Œéƒ½èƒ½åº”å¯¹è‡ªå¦‚ã€‚ç°åœ¨ï¼Œä½ å·²ç»æŒæ¡äº† React çš„æ ¸å¿ƒæ¦‚å¿µï¼Œæ¥ä¸‹æ¥å°±åŠ¨æ‰‹å†™å†™ä»£ç å§ï¼Œæ¯•ç«Ÿå®è·µæ‰æ˜¯æœ€å¥½çš„è€å¸ˆï¼ğŸ’ª</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¢å‘ Trait ç¼–ç¨‹ (Trait-Driven Design)]]></title>    <link>https://juejin.cn/post/7583344281738838062</link>    <guid>https://juejin.cn/post/7583344281738838062</guid>    <pubDate>2025-12-14T09:16:06.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583344281738838062" data-draft-id="7583324039302692915" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¢å‘ Trait ç¼–ç¨‹ (Trait-Driven Design)"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2025-12-14T09:16:06.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ²æ£®"/> <meta itemprop="url" content="https://juejin.cn/user/4455643804079608"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¢å‘ Trait ç¼–ç¨‹ (Trait-Driven Design)
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4455643804079608/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ²æ£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:16:06.000Z" title="Sun Dec 14 2025 09:16:06 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç”¨ trait åšæ¡¥æ¥ï¼Œä½¿ç”¨ trait æä¾›æ§åˆ¶åè½¬ï¼Œç”¨ trait å®ç° SOLID åŸåˆ™,è¿™ä¸‰ä¸ªæ¦‚å¿µå…¶å®æ˜¯ç›¸è¾…ç›¸æˆçš„ï¼Œæ ¸å¿ƒç›®çš„åªæœ‰ä¸€ä¸ªï¼š<strong>è§£è€¦ï¼ˆDecouplingï¼‰</strong> ã€‚è®©ä½ çš„ä»£ç åƒä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼Œå¯ä»¥éšæ„æ‹†å¸ã€æ›¿æ¢ã€æ‹¼è£…ã€‚</p>
<h3 data-id="heading-0">1. ç”¨ Trait åšæ¡¥æ¥ (The Bridge Pattern)</h3>
<p><strong>æ¦‚å¿µè§£é‡Šï¼š</strong> Â æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€å †**â€œå½¢çŠ¶â€ <strong>ï¼ˆåœ†ã€æ–¹ï¼‰ï¼Œè¿˜æœ‰ä¸€å †</strong>â€œæ¸²æŸ“å¹³å°â€**ï¼ˆWindowsã€Macï¼‰ã€‚</p>
<ul>
<li>
<p>å¦‚æœä¸è§£è€¦ï¼Œä½ éœ€è¦å†™ï¼š<code>WindowsCircle</code>,Â <code>MacCircle</code>,Â <code>WindowsSquare</code>,Â <code>MacSquare</code>... (M Ã— N çš„çˆ†ç‚¸ç»„åˆ)ã€‚</p>
</li>
<li>
<p><strong>æ¡¥æ¥æ¨¡å¼</strong>ï¼šæŠŠâ€œå½¢çŠ¶â€å’Œâ€œæ¸²æŸ“â€åˆ†å¼€ã€‚å½¢çŠ¶é‡Œæ‹¿ç€ä¸€ä¸ªâ€œæ¸²æŸ“å™¨â€çš„ Traitã€‚</p>
<ul>
<li>å½¢çŠ¶åªç®¡ç®—å¤§å°ã€‚</li>
<li>æ¸²æŸ“å™¨åªç®¡ç”»ç”»ã€‚</li>
<li>ä¸­é—´ç”¨ Trait è¿æ¥ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong> Â <strong>å°†æŠ½è±¡éƒ¨åˆ†ï¼ˆå½¢çŠ¶ï¼‰ä¸å®ç°éƒ¨åˆ†ï¼ˆæ¸²æŸ“ï¼‰åˆ†ç¦»ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚</strong></p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 1. å®ç°éƒ¨åˆ†ï¼šå®šä¹‰æ¸²æŸ“å™¨çš„è¡Œä¸º</span>
<span class="hljs-keyword">trait</span> <span class="hljs-title class_">Renderer</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">render_circle</span>(&amp;<span class="hljs-keyword">self</span>, radius: <span class="hljs-type">f64</span>);
}

<span class="hljs-comment">// å…·ä½“å®ç° Aï¼šWindows æ¸²æŸ“å™¨</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">WindowsRenderer</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Renderer</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">WindowsRenderer</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">render_circle</span>(&amp;<span class="hljs-keyword">self</span>, radius: <span class="hljs-type">f64</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Windows API ç»˜åˆ¶: åœ†å½¢ (åŠå¾„ {})"</span>, radius);
    }
}

<span class="hljs-comment">// å…·ä½“å®ç° Bï¼šMac æ¸²æŸ“å™¨</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">MacRenderer</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Renderer</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">MacRenderer</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">render_circle</span>(&amp;<span class="hljs-keyword">self</span>, radius: <span class="hljs-type">f64</span>) {
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"Mac API ç»˜åˆ¶: åœ†å½¢ (åŠå¾„ {}) -- é«˜æ¸…Retina"</span>, radius);
    }
}

<span class="hljs-comment">// 2. æŠ½è±¡éƒ¨åˆ†ï¼šå½¢çŠ¶</span>
<span class="hljs-comment">// æ³¨æ„ï¼šè¿™é‡ŒæŒæœ‰çš„æ˜¯ Renderer çš„ Trait Object</span>
<span class="hljs-comment">// è¿™å°±æ˜¯â€œæ¡¥â€ï¼šShape é€šè¿‡è¿™ä¸ªæ¡¥ï¼Œè¿æ¥åˆ°äº†å…·ä½“çš„æ¸²æŸ“å™¨</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Circle</span> {
    radius: <span class="hljs-type">f64</span>,
    renderer: <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> Renderer&gt;, 
}

<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Circle</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(radius: <span class="hljs-type">f64</span>, renderer: <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> Renderer&gt;) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">Self</span> { radius, renderer }
    }

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">draw</span>(&amp;<span class="hljs-keyword">self</span>) {
        <span class="hljs-comment">// Circle ä¸éœ€è¦çŸ¥é“æ˜¯ Windows è¿˜æ˜¯ Macï¼Œåªç®¡è°ƒç”¨ trait</span>
        <span class="hljs-keyword">self</span>.renderer.<span class="hljs-title function_ invoke__">render_circle</span>(<span class="hljs-keyword">self</span>.radius);
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">win_circle</span> = Circle::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-number">10.0</span>, <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(WindowsRenderer));
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">mac_circle</span> = Circle::<span class="hljs-title function_ invoke__">new</span>(<span class="hljs-number">20.0</span>, <span class="hljs-type">Box</span>::<span class="hljs-title function_ invoke__">new</span>(MacRenderer));

    win_circle.<span class="hljs-title function_ invoke__">draw</span>();
    mac_circle.<span class="hljs-title function_ invoke__">draw</span>();
}
</code></pre>
<hr/>
<h3 data-id="heading-1">2. ä½¿ç”¨ Trait æä¾›æ§åˆ¶åè½¬ (IoC / Dependency Injection)</h3>
<p><strong>æ¦‚å¿µè§£é‡Šï¼š</strong> Â è¿™ä¹Ÿæ˜¯<strong>ä¾èµ–æ³¨å…¥ (DI)</strong> Â çš„æ ¸å¿ƒã€‚</p>
<ul>
<li><strong>ä¼ ç»Ÿæ–¹å¼ (æ§åˆ¶æƒåœ¨å†…éƒ¨)</strong> ï¼šä½ æ˜¯é€ è½¦çš„ï¼Œä½ åœ¨è½¦é‡Œ<strong>ç›´æ¥é€ </strong>äº†ä¸€ä¸ª V8 å¼•æ“ã€‚ä½ æƒ³æ¢ç”µåŠ¨æœºï¼Ÿä¸è¡Œï¼Œç„Šæ­»äº†ã€‚</li>
<li><strong>IoC æ–¹å¼ (æ§åˆ¶æƒåœ¨å¤–éƒ¨)</strong> ï¼šä½ æ˜¯é€ è½¦çš„ï¼Œä½ ç•™äº†ä¸ª<strong>å¼•æ“æ¥å£ (Trait)</strong> ã€‚è½¦é€ å¥½çš„æ—¶å€™ï¼Œ<strong>å¤–éƒ¨</strong>å¡ç»™ä½ ä»€ä¹ˆå¼•æ“ï¼Œä½ å°±ç”¨ä»€ä¹ˆå¼•æ“ã€‚</li>
</ul>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong> Â <strong>ä¸è¦è‡ªå·±åˆ›å»ºä¾èµ–ï¼Œå‘å¤–ç•Œï¼ˆè°ƒç”¨è€…ï¼‰è¦ä¾èµ–ã€‚</strong></p>
<p><strong>æ‰‹æ•² Demoï¼š</strong></p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// 1. å®šä¹‰ä¾èµ–çš„æ ‡å‡† (Trait)</span>
<span class="hljs-keyword">trait</span> <span class="hljs-title class_">Engine</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">start</span>(&amp;<span class="hljs-keyword">self</span>);
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">V8Engine</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Engine</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">V8Engine</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">start</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"V8 å¼•æ“: è½°è½°è½°ï¼"</span>); }
}

<span class="hljs-keyword">struct</span> <span class="hljs-title class_">ElectricMotor</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Engine</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">ElectricMotor</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">start</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç”µæœº: æ»‹æ»‹æ»‹ (é™éŸ³)"</span>); }
}

<span class="hljs-comment">// 2. é«˜å±‚æ¨¡å— (Car)</span>
<span class="hljs-comment">// æ³›å‹ T: Engine æ„å‘³ç€ï¼šåªè¦ä½ èƒ½è·‘ï¼Œæˆ‘å°±èƒ½è£…</span>
<span class="hljs-comment">// è¿™å°±æ˜¯ IoCï¼šCar ä¸ä¾èµ–å…·ä½“çš„ V8Engineï¼Œåªä¾èµ– Engine æ¥å£</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Car</span>&lt;T: Engine&gt; {
    engine: T,
}

<span class="hljs-keyword">impl</span>&lt;T: Engine&gt; Car&lt;T&gt; {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(engine: T) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> {
        <span class="hljs-keyword">Self</span> { engine }
    }

    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">drive</span>(&amp;<span class="hljs-keyword">self</span>) {
        <span class="hljs-keyword">self</span>.engine.<span class="hljs-title function_ invoke__">start</span>();
        <span class="hljs-built_in">println!</span>(<span class="hljs-string">"è½¦åŠ¨äº†ï¼"</span>);
    }
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-comment">// 3. åœ¨å¤–éƒ¨æ³¨å…¥ä¾èµ–</span>
    <span class="hljs-comment">// ä»Šå¤©æƒ³å¼€æ²¹è½¦</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">gas_car</span> = Car::<span class="hljs-title function_ invoke__">new</span>(V8Engine);
    gas_car.<span class="hljs-title function_ invoke__">drive</span>();

    <span class="hljs-comment">// æ˜å¤©æƒ³å¼€ç”µè½¦ (Car çš„ä»£ç ä¸€è¡Œéƒ½ä¸ç”¨æ”¹ï¼)</span>
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">electric_car</span> = Car::<span class="hljs-title function_ invoke__">new</span>(ElectricMotor);
    electric_car.<span class="hljs-title function_ invoke__">drive</span>();
}
</code></pre>
<hr/>
<h3 data-id="heading-2">3. ç”¨ Trait å®ç° SOLID åŸåˆ™</h3>
<p>SOLID æ˜¯äº”ä¸ªåŸåˆ™ï¼ŒTrait åœ¨ Rust é‡Œæœ€å¸¸ä½“ç°çš„æ˜¯Â <strong>ISP (æ¥å£éš”ç¦»åŸåˆ™)</strong> Â å’ŒÂ <strong>OCP (å¼€é—­åŸåˆ™)</strong> ã€‚</p>
<ul>
<li>
<p><strong>æ¥å£éš”ç¦» (ISP)</strong> ï¼šä¸è¦æä¸€ä¸ªä¸‡èƒ½çš„â€œä¸Šå¸æ¥å£â€ã€‚æŠŠå¤§æ¥å£æ‹†æˆå° Traitã€‚</p>
<ul>
<li><em>é”™è¯¯ï¼š</em> Â <code>trait Worker { å†™ä»£ç (); è¿˜ä¼šæ‰«åœ°(); }</code>Â -&gt; ç¨‹åºå‘˜è¢«è¿«å®ç°æ‰«åœ°ã€‚</li>
<li><em>æ­£ç¡®ï¼š</em> Â <code>trait Coder { å†™ä»£ç (); }</code>Â å’ŒÂ <code>trait Cleaner { æ‰«åœ°(); }</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>å¼€é—­åŸåˆ™ (OCP)</strong> ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚</p>
<ul>
<li>æƒ³åŠ æ–°åŠŸèƒ½ï¼Ÿå®ç°æ–°çš„ Traitï¼Œä¸è¦å»æ”¹è€çš„ Structã€‚</li>
</ul>
</li>
</ul>
<p><strong>æ‰‹æ•² Demo (æ¥å£éš”ç¦»åŸåˆ™ ISP)ï¼š</strong></p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// --- é”™è¯¯çš„è®¾è®¡ ---</span>
<span class="hljs-comment">// trait SuperWorker {</span>
<span class="hljs-comment">//     fn code(&amp;self);</span>
<span class="hljs-comment">//     fn clean(&amp;self);</span>
<span class="hljs-comment">// }</span>
<span class="hljs-comment">// è¿™ç§è®¾è®¡ä¸‹ï¼Œæœºå™¨äººè¢«è¿«è¦å®ç° cleanï¼Œä¿æ´é˜¿å§¨è¢«è¿«è¦å®ç° codeï¼Œéå¸¸ç—›è‹¦ã€‚</span>

<span class="hljs-comment">// --- æ­£ç¡®çš„è®¾è®¡ (æ¥å£éš”ç¦») ---</span>

<span class="hljs-comment">// 1. æ‹†åˆ†ç»†ç²’åº¦çš„ Trait</span>
<span class="hljs-keyword">trait</span> <span class="hljs-title class_">Coder</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">write_code</span>(&amp;<span class="hljs-keyword">self</span>);
}

<span class="hljs-keyword">trait</span> <span class="hljs-title class_">Cleaner</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">clean_floor</span>(&amp;<span class="hljs-keyword">self</span>);
}

<span class="hljs-comment">// 2. å®ç°è€…æŒ‰éœ€ç»„åˆ</span>

<span class="hljs-comment">// ç¨‹åºå‘˜ï¼šåªä¼šå†™ä»£ç </span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Programmer</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Coder</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Programmer</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">write_code</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ­£åœ¨å†™ Rust..."</span>); }
}

<span class="hljs-comment">// ä¿æ´äººå‘˜ï¼šåªä¼šæ‰«åœ°</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Janitor</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Cleaner</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">Janitor</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">clean_floor</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"æ­£åœ¨æ‹–åœ°..."</span>); }
}

<span class="hljs-comment">// è¶…çº§ç®¡å®¶ï¼šæ—¢ä¼šå†™ä»£ç ï¼Œåˆä¼šæ‰«åœ°</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">SuperButler</span>;
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Coder</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">SuperButler</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">write_code</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç®¡å®¶å†™è„šæœ¬è‡ªåŠ¨åŒ–..."</span>); }
}
<span class="hljs-keyword">impl</span> <span class="hljs-title class_">Cleaner</span> <span class="hljs-keyword">for</span> <span class="hljs-title class_">SuperButler</span> {
    <span class="hljs-keyword">fn</span> <span class="hljs-title function_">clean_floor</span>(&amp;<span class="hljs-keyword">self</span>) { <span class="hljs-built_in">println!</span>(<span class="hljs-string">"ç®¡å®¶æ¸…ç†æœåŠ¡å™¨ç°å°˜..."</span>); }
}

<span class="hljs-comment">// 3. ä¸šåŠ¡ç³»ç»Ÿ</span>
<span class="hljs-comment">// è¿™é‡Œå±•ç¤ºäº† trait bounds çš„å¨åŠ›ï¼šæˆ‘åªè¦æ±‚ä½ ä¼šå†™ä»£ç ï¼Œä¸ç®¡ä½ æ˜¯ä¸æ˜¯ç®¡å®¶</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">software_company_hire</span>&lt;T: Coder&gt;(worker: T) {
    worker.<span class="hljs-title function_ invoke__">write_code</span>();
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">dev</span> = Programmer;
    <span class="hljs-keyword">let</span> <span class="hljs-keyword"/><span class="hljs-variable">butler</span> = SuperButler;
    
    <span class="hljs-title function_ invoke__">software_company_hire</span>(dev);
    <span class="hljs-title function_ invoke__">software_company_hire</span>(butler); <span class="hljs-comment">// ç®¡å®¶ä¹Ÿèƒ½è¢«å½•ç”¨ï¼Œå› ä¸ºä»–å®ç°äº† Coder</span>
    
    <span class="hljs-comment">// let aunt = Janitor;</span>
    <span class="hljs-comment">// software_company_hire(aunt); // âŒ ç¼–è¯‘æŠ¥é”™ï¼ä¿æ´é˜¿å§¨ä¸ä¼šå†™ä»£ç ï¼Œç³»ç»Ÿå¾ˆå®‰å…¨ã€‚</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-3">4. æ¶æ„å¿ƒæ³•ï¼šå¦‚ä½•åŸºäº Trait åšè®¾è®¡ï¼Ÿ</h3>
<p>å¦‚æœä½ æƒ³åœ¨ Rust ä¸­åƒæ¶æ„å¸ˆä¸€æ ·æ€è€ƒï¼Œè¯·éµå¾ªä»¥ä¸‹Â <strong>ä¸‰æ­¥èµ°</strong>Â æµç¨‹ï¼š</p>
<h4 data-id="heading-4">ç¬¬ä¸€æ­¥ï¼šè¡Œä¸ºä¼˜å…ˆ (Behavior First)</h4>
<p>ä¸è¦å…ˆå»æƒ³Â <code>struct User</code>Â é‡Œæœ‰å“ªäº›å­—æ®µï¼ˆid, name...ï¼‰ã€‚Â <strong>å…ˆæƒ³è¿™ä¸ªä¸œè¥¿èƒ½å¹²ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li>å®ƒèƒ½å­˜æ•°æ®åº“å—ï¼Ÿ -&gt;Â <code>trait Repository</code></li>
<li>å®ƒèƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ -&gt;Â <code>trait Serialize</code></li>
<li>å®ƒèƒ½æ˜¾ç¤ºå—ï¼Ÿ -&gt;Â <code>trait Display</code></li>
</ul>
<h4 data-id="heading-5">ç¬¬äºŒæ­¥ï¼šä¾èµ–æŠ½è±¡ (Depend on Traits)</h4>
<p>åœ¨ä½ çš„æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆService å±‚ / Domain å±‚ï¼‰é‡Œï¼Œ<strong>ç¦æ­¢å‡ºç°å…·ä½“çš„ Struct</strong>ã€‚</p>
<ul>
<li>ä¸è¦å†™Â <code>fn save(db: MySQL)</code></li>
<li>è¦å†™Â <code>fn save(db: &amp;impl Database)</code>Â è¿™èƒ½ä¿è¯ä½ ä»¥åæŠŠ MySQL æ¢æˆ Redis æ—¶ï¼Œæ ¸å¿ƒä¸šåŠ¡ä»£ç ä¸€è¡Œéƒ½ä¸ç”¨æ”¹ã€‚</li>
</ul>
<h4 data-id="heading-6">ç¬¬ä¸‰æ­¥ï¼šå¤–å±‚æ³¨å…¥ (Inject from Outside)</h4>
<p>åœ¨Â <code>main.rs</code>Â æˆ–æœ€å¤–å±‚å…¥å£ï¼Œæ‰å»åˆ›å»ºå…·ä½“çš„Â <code>Struct</code>ï¼ˆæ¯”å¦‚Â <code>MySQLConnection</code>ï¼‰ï¼Œç„¶åæŠŠå®ƒä»¬å¡è¿›æ ¸å¿ƒé€»è¾‘é‡Œã€‚</p>
<hr/>
<h3 data-id="heading-7">æ€»ç»“å¯¹ç…§</h3>

























<table><thead><tr><th>æ¦‚å¿µ</th><th>æ ¸å¿ƒæ€æƒ³</th><th>Rust è¡¨ç°å½¢å¼</th></tr></thead><tbody><tr><td><strong>Bridge (æ¡¥æ¥)</strong></td><td><strong>æ‹¼è£…</strong></td><td><code>struct A</code>Â å†…éƒ¨æŒæœ‰Â <code>Box&lt;dyn B_Trait&gt;</code>ï¼ŒA å§”æ‰˜ B å¹²æ´»ã€‚</td></tr><tr><td><strong>IoC (æ§åˆ¶åè½¬)</strong></td><td><strong>ç´¢è¦</strong></td><td><code>struct A&lt;T: B_Trait&gt;</code>ï¼ŒA ä¸è‡ªå·±é€  Bï¼Œè€Œæ˜¯è®©åˆ«äººä¼ è¿›æ¥ã€‚</td></tr><tr><td><strong>SOLID (æ¥å£éš”ç¦»)</strong></td><td><strong>æ‹†åˆ†</strong></td><td>åˆ«å†™å¤§ Traitï¼Œå†™å¤šä¸ªå° Trait (<code>trait A</code>,Â <code>trait B</code>)ï¼Œç„¶åÂ <code>impl A for X</code>,Â <code>impl B for X</code>ã€‚</td></tr></tbody></table>
<p>åœ¨ Rust ä»£ç çš„<strong>å­—é¢å†™æ³•</strong>ï¼ˆMechanismï¼‰ä¸Šï¼Œå®ƒä»¬é•¿å¾—ç¡®å®<strong>å‡ ä¹ä¸€æ¨¡ä¸€æ ·</strong>ã€‚</p>
<ul>
<li><strong>æ­¥éª¤ 1</strong>ï¼šå®šä¹‰Â <code>trait</code>ï¼ˆå®šè§„çŸ©ï¼‰ã€‚</li>
<li><strong>æ­¥éª¤ 2</strong>ï¼š<code>struct</code>Â å®ç°Â <code>trait</code>ï¼ˆåšå…·ä½“çš„äº‹ï¼‰ã€‚</li>
<li><strong>æ­¥éª¤ 3</strong>ï¼šåœ¨å¦ä¸€ä¸ªåœ°æ–¹æ‹¿ç€Â <code>trait</code>Â æ¥è°ƒç”¨ï¼ˆå¤šæ€ï¼‰ã€‚</li>
</ul>
<p><strong>ä½†æ˜¯ï¼</strong> Â è™½ç„¶æ‰‹é‡Œçš„â€œé”¤å­â€ï¼ˆTraitï¼‰æ˜¯åŒä¸€ä¸ªï¼Œä½†æˆ‘ä»¬æ•²æ‰“çš„â€œé’‰å­â€ï¼ˆè®¾è®¡æ„å›¾ï¼‰æ˜¯å®Œå…¨ä¸åŒçš„ã€‚</p>
<p>ä¸ºäº†å¸®ä½ åŒºåˆ†è¿™ä¸‰è€…ï¼Œæˆ‘ä»¬ä¸è¦çœ‹**â€œæ€ä¹ˆå†™â€ <strong>ï¼ˆå› ä¸ºå†™æ³•éƒ½ä¸€æ ·ï¼‰ï¼Œæˆ‘ä»¬è¦çœ‹</strong>â€œè§£å†³ä»€ä¹ˆçŸ›ç›¾â€**ã€‚</p>
<p>æˆ‘æŠŠè¿™ä¸‰ä¸ªä¸œè¥¿çš„<strong>æ ¸å¿ƒå…³æ³¨ç‚¹</strong>æ‹†è§£ç»™ä½ çœ‹ï¼Œä½ å°±æ˜ç™½äº†ã€‚</p>
<hr/>
<h3 data-id="heading-8">1. æ¡¥æ¥æ¨¡å¼ (Bridge)</h3>
<p><strong>æ ¸å¿ƒçŸ›ç›¾ï¼šè§£å†³â€œM Ã— Nâ€çš„ç±»çˆ†ç‚¸é—®é¢˜ã€‚</strong></p>
<ul>
<li>
<p><strong>åœºæ™¯</strong>ï¼šä½ æœ‰Â <strong>Mç§å½¢çŠ¶</strong>Â (åœ†ã€æ–¹ã€ä¸‰è§’...) å’ŒÂ <strong>Nç§å¹³å°</strong>Â (Windows, Mac, Linux...)ã€‚</p>
</li>
<li>
<p><strong>ä¸ç”¨çš„åæœ</strong>ï¼šä½ éœ€è¦å†™Â <code>WinCircle</code>,Â <code>MacCircle</code>,Â <code>WinSquare</code>,Â <code>MacSquare</code>... ä¸€å…±éœ€è¦å†™Â <strong>M Ã— N</strong>Â ä¸ªç»“æ„ä½“ã€‚</p>
</li>
<li>
<p><strong>ç”¨äº† Trait (æ¡¥æ¥)</strong> ï¼šæŠŠâ€œå¹³å°æ¸²æŸ“â€æŠ½æˆ Traitã€‚</p>
<ul>
<li>å½¢çŠ¶åªç®¡å½¢çŠ¶çš„é€»è¾‘ã€‚</li>
<li>å¹³å°åªç®¡æ¸²æŸ“çš„é€»è¾‘ã€‚</li>
<li><strong>å½¢çŠ¶ç»“æ„ä½“é‡Œâ€œåŒ…â€ç€ä¸€ä¸ªæ¸²æŸ“ Trait</strong>ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç‰¹å¾å†™æ³•</strong>ï¼š ç»“æ„ä½“å†…éƒ¨<strong>é•¿æœŸæŒæœ‰</strong>è¿™ä¸ª Trait å¯¹è±¡ã€‚</p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Circle</span> {
    <span class="hljs-comment">// ã€ç‰¹å¾ã€‘ï¼šç»“æ„ä½“å†…éƒ¨æ‹¥æœ‰ä¸€ä¸ª Trait å¯¹è±¡ä½œä¸ºå­—æ®µ</span>
    <span class="hljs-comment">// è¿™å°±æ˜¯â€œæ¡¥â€ï¼ŒCircle é€šè¿‡è¿™ä¸ªå­—æ®µè¿æ¥åˆ°äº†å…·ä½“çš„å®ç°</span>
    renderer: <span class="hljs-type">Box</span>&lt;<span class="hljs-keyword">dyn</span> Renderer&gt;, 
}
</code></pre>
</li>
</ul>
<h3 data-id="heading-9">2. æ§åˆ¶åè½¬ (IoC / DI)</h3>
<p><strong>æ ¸å¿ƒçŸ›ç›¾ï¼šè§£å†³â€œè°æ¥åˆ›å»ºä¾èµ–â€çš„é—®é¢˜ã€‚</strong></p>
<ul>
<li>
<p><strong>åœºæ™¯</strong>ï¼šé€ è½¦ã€‚</p>
</li>
<li>
<p><strong>ä¸ç”¨çš„åæœ</strong>ï¼šåœ¨Â <code>Car::new()</code>Â é‡Œé¢å†™æ­»Â <code>let engine = V8Engine::new()</code>ã€‚ä»¥åæƒ³æ¢ç”µæœºï¼Œå¿…é¡»æ”¹Â <code>Car</code>Â çš„æºç ï¼Œé‡æ–°ç¼–è¯‘ã€‚</p>
</li>
<li>
<p><strong>ç”¨äº† Trait (IoC)</strong> ï¼š</p>
<ul>
<li><code>Car</code>Â ä¸è‡ªå·±Â <code>new</code>Â å¼•æ“ã€‚</li>
<li><code>Car</code>Â å‘å¤–é¢å–Šï¼šâ€œè°è¦ç”¨æˆ‘ï¼Œè°æŠŠå¼•æ“ä¼ ç»™æˆ‘ï¼â€</li>
</ul>
</li>
<li>
<p><strong>ç‰¹å¾å†™æ³•</strong>ï¼š é‡ç‚¹åœ¨Â <strong>æ„é€ å‡½æ•°</strong>Â æˆ–Â <strong>æ³›å‹å‚æ•°</strong>Â ä¸Šã€‚</p>
<p>Rust</p>
<pre><code class="hljs language-rust" lang="rust"><span class="hljs-comment">// ã€ç‰¹å¾ã€‘ï¼šæˆ‘ä¸æŒæœ‰ç‰¹å®šçš„ V8ï¼Œæˆ‘é€šè¿‡æ³›å‹ T è¦æ±‚å¤–éƒ¨æ³¨å…¥</span>
<span class="hljs-keyword">struct</span> <span class="hljs-title class_">Car</span>&lt;T: Engine&gt; {
    engine: T 
}

<span class="hljs-comment">// æ„é€ æ—¶ï¼Œä¾èµ–æ˜¯ä»â€œå¤–é¢â€ä¼ è¿›æ¥çš„ï¼Œè€Œä¸æ˜¯é‡Œé¢é€ å‡ºæ¥çš„</span>
<span class="hljs-keyword">fn</span> <span class="hljs-title function_">new</span>(engine: T) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-keyword">Self</span> { ... } 
</code></pre>
</li>
</ul>
<h3 data-id="heading-10">3. SOLID ä¸­çš„ ISP (æ¥å£éš”ç¦»)</h3>
<p><strong>æ ¸å¿ƒçŸ›ç›¾ï¼šè§£å†³â€œå¼ºè¿«å®ç°æ²¡ç”¨æ–¹æ³•â€çš„é—®é¢˜ã€‚</strong></p>
<ul>
<li>
<p><strong>åœºæ™¯</strong>ï¼šç»™å·¥äººæ´¾æ´»ã€‚</p>
</li>
<li>
<p><strong>ä¸ç”¨çš„åæœ</strong>ï¼šå®šä¹‰äº†ä¸€ä¸ªå¤§ TraitÂ <code>Worker</code>ï¼Œé‡Œé¢æœ‰Â <code>code()</code>Â å’ŒÂ <code>clean()</code>ã€‚ç»“æœä¿æ´é˜¿å§¨è¢«è¿«å®ç°Â <code>code()</code>ï¼ˆåªèƒ½å†™ç©ºå‡½æ•°ï¼‰ï¼Œç¨‹åºå‘˜è¢«è¿«å®ç°Â <code>clean()</code>ã€‚</p>
</li>
<li>
<p><strong>ç”¨äº† Trait (ISP)</strong> ï¼š</p>
<ul>
<li><strong>æŠŠå¤§ Trait æ‹†ç¢</strong>ã€‚</li>
<li><code>trait Coder { code() }</code></li>
<li><code>trait Cleaner { clean() }</code></li>
</ul>
</li>
<li>
<p><strong>ç‰¹å¾å†™æ³•</strong>ï¼š é‡ç‚¹åœ¨Â <strong>Trait çš„å®šä¹‰</strong>Â é˜¶æ®µï¼Œè€Œä¸æ˜¯è°ƒç”¨é˜¶æ®µã€‚</p>
<p>Rust</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-comment">// ã€ç‰¹å¾ã€‘ï¼šTrait å®šä¹‰å¾—å¾ˆå°ã€å¾ˆçº¯ç²¹</span>
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Coder</span> </span>{ <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">code</span>(<span class="hljs-params">&amp;<span class="hljs-built_in">self</span></span>)</span>; }
<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Cleaner</span> </span>{ <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">clean</span>(<span class="hljs-params">&amp;<span class="hljs-built_in">self</span></span>)</span>; }

<span class="hljs-comment">// å…·ä½“çš„ struct åªå®ç°å®ƒçœŸæ­£éœ€è¦çš„é‚£éƒ¨åˆ†</span>
impl Coder <span class="hljs-keyword">for</span> Programmer { ... }
</code></pre>
</li>
</ul>
<hr/>
<h3 data-id="heading-11">ä¸€å¼ å›¾æ€»ç»“â€œæ„å›¾â€çš„åŒºåˆ«</h3>
<p>å‡è®¾ä½ æ‰‹é‡Œæ‹¿ç€ä¸€æŠŠÂ <strong>èºä¸åˆ€</strong>ï¼ˆTraitï¼‰ï¼š</p>
<ol>
<li>
<p><strong>æ¡¥æ¥ (Bridge)</strong> ï¼š</p>
<ul>
<li>ä½ æŠŠèºä¸åˆ€<strong>ç²˜åœ¨</strong>æœºæ¢°è‡‚ä¸Šã€‚</li>
<li><strong>æ„å›¾</strong>ï¼šç»„åˆã€‚æœºæ¢°è‡‚è´Ÿè´£åŠ¨ï¼Œèºä¸åˆ€è´Ÿè´£è½¬ï¼Œå®ƒä¿©ç»„åˆæˆä¸€ä¸ªæ–°å·¥å…·ã€‚</li>
<li><em>ä»£ç å…³æ³¨ç‚¹ï¼šStruct é‡Œçš„å­—æ®µã€‚</em></li>
</ul>
</li>
<li>
<p><strong>æ§åˆ¶åè½¬ (IoC)</strong> ï¼š</p>
<ul>
<li>ä½ æŠŠèºä¸åˆ€<strong>é€’ç»™</strong>è£…ä¿®å¸ˆå‚…ã€‚</li>
<li><strong>æ„å›¾</strong>ï¼šç»™äºˆã€‚å¸ˆå‚…ä¸éœ€è¦è‡ªå·±é€ èºä¸åˆ€ï¼Œä½ ç»™ä»–ä»€ä¹ˆï¼Œä»–å°±ç”¨ä»€ä¹ˆã€‚</li>
<li><em>ä»£ç å…³æ³¨ç‚¹ï¼šå‡½æ•°çš„å‚æ•°ï¼ˆæ³›å‹/Dynï¼‰ã€‚</em></li>
</ul>
</li>
<li>
<p><strong>æ¥å£éš”ç¦» (ISP)</strong> ï¼š</p>
<ul>
<li>ä½ æŠŠç‘å£«å†›åˆ€æ‹†å¼€ï¼Œ<strong>å•ç‹¬é€ </strong>äº†ä¸€æŠŠèºä¸åˆ€å’Œä¸€æŠŠå‰ªåˆ€ã€‚</li>
<li><strong>æ„å›¾</strong>ï¼šç²¾ç®€ã€‚ä¸éœ€è¦å‰ªåˆ€çš„äººï¼Œä¸è¦ç¡¬å¡ç»™ä»–ä¸€æŠŠç‘å£«å†›åˆ€ã€‚</li>
<li><em>ä»£ç å…³æ³¨ç‚¹ï¼šTrait å®šä¹‰çš„ç²’åº¦ã€‚</em></li>
</ul>
</li>
</ol>
<h3 data-id="heading-12">ä½ çš„æ€»ç»“ä¿®æ­£</h3>
<p>ä½ ä¹‹å‰çš„æ€»ç»“æ˜¯ï¼š</p>
<blockquote>
<p>â€œæ€æƒ³éƒ½æ˜¯å…ˆæœ‰trait ç„¶ååŸºäºè¿™ä¸ªtraitçš„structï¼Œç„¶åå®šä¹‰ä¸€ä¸ªæ–¹æ³•...ç„¶åç›´æ¥è°ƒâ€</p>
</blockquote>
<p>è¿™æè¿°çš„æ˜¯Â <strong>Rust çš„è¯­æ³•æœºåˆ¶</strong>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥å‡åä¸€ä¸‹ï¼š</p>
<ul>
<li><strong>Bridge</strong>Â æ˜¯åˆ©ç”¨è¿™ä¸ªæœºåˆ¶åšÂ <strong>å†…éƒ¨ç»„åˆ</strong>Â (Composition)ã€‚</li>
<li><strong>IoC</strong>Â æ˜¯åˆ©ç”¨è¿™ä¸ªæœºåˆ¶åšÂ <strong>å¤–éƒ¨æ³¨å…¥</strong>Â (Injection)ã€‚</li>
<li><strong>ISP</strong>Â æ˜¯åˆ©ç”¨è¿™ä¸ªæœºåˆ¶åšÂ <strong>æ¥å£æ‹†åˆ†</strong>Â (Segregation)ã€‚</li>
</ul>
<p>å®ƒä»¬ç¡®å®æ˜¯ç”¨åŒä¸€ç§ç –å¤´ï¼ˆTraitï¼‰ç›–å‡ºæ¥çš„ä¸‰ç§ä¸åŒåŠŸèƒ½çš„æˆ¿å­ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[jdk9ä¸­çš„moduleæ¨¡å—åŒ–]]></title>    <link>https://juejin.cn/post/7583226204033368105</link>    <guid>https://juejin.cn/post/7583226204033368105</guid>    <pubDate>2025-12-14T09:51:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583226204033368105" data-draft-id="7583226204033351721" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="jdk9ä¸­çš„moduleæ¨¡å—åŒ–"/> <meta itemprop="keywords" content="åç«¯,Java,Java EE"/> <meta itemprop="datePublished" content="2025-12-14T09:51:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è€ƒè™‘è€ƒè™‘"/> <meta itemprop="url" content="https://juejin.cn/user/4406498335157287"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            jdk9ä¸­çš„moduleæ¨¡å—åŒ–
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4406498335157287/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è€ƒè™‘è€ƒè™‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:51:01.000Z" title="Sun Dec 14 2025 09:51:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>åœ¨<code>JDK9</code>å‘å¸ƒä¹‹åï¼Œå¼•å…¥äº†ä¸€ä¸ªç³»ç»Ÿæ¨¡å—åŒ–æ¦‚å¿µï¼ŒJDK 9æ¨¡å—åŒ–ç³»ç»Ÿå¯ä»¥ä¸ºæ¯ä¸ªæ¨¡å—åˆ†åˆ«å®šä¹‰ç±»è·¯å¾„å’Œä¾èµ–é¡¹ï¼Œä»è€Œä½¿æ¯ä¸ªæ¨¡å—æ›´åŠ æ¸…æ™°å’Œç‹¬ç«‹</p>
<h3 data-id="heading-1">æ¨¡å—åŒ–ä½¿ç”¨</h3>
<p>æ–°å»ºä¸€ä¸ª<code>maven</code>å·¥ç¨‹ï¼Œç„¶åå¼•å…¥ä¸€ä¸ªæ–‡ä»¶<code>module-info.java</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/48105425365d4f259a8a7f258e905cad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICD6JmR6ICD6JmR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310661&amp;x-signature=Y5UIm%2FrFnqKSoSytj2Qu%2Ba4jD2E%3D" alt="image.png" loading="lazy"/>
å¯ä»¥ç”¨æ–°çš„å…³é”®è¯moduleæ¥å£°æ˜ä¸€ä¸ªæ¨¡å—</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">module</span> hello1 {
}
</code></pre>
<p>å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ae270b4d3644ad6a9ca0b603f38438c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICD6JmR6ICD6JmR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310661&amp;x-signature=s0846Lt1nUqv0dTFjL5G1n2lSvs%3D" alt="image.png" loading="lazy"/>
åç»­å¼•å…¥äº†ä¸€ä¸ªæ–°åŒ…ï¼Œè¦ä½¿ç”¨ï¼Œå¾—å†<code>module-info.java</code>å¼•å…¥</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9d67653ba88a4cb7a522b78ed719fa86~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ICD6JmR6ICD6JmR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310661&amp;x-signature=QyGLG5cRSpPzmNwDItennqTs16U%3D" alt="image.png" loading="lazy"/>
æ‰èƒ½ä½¿ç”¨ï¼Œä¸ç„¶ä¼šæŠ¥é”™</p>
<h3 data-id="heading-2">æ€»ç»“</h3>
<p>Javaæ¨¡å—åŒ–ç³»ç»Ÿï¼Œå³ <strong>Java Platform Module System</strong>ï¼Œæ˜¯JDK 9ä¸­çš„ä¸€é¡¹é©å‘½æ€§æ”¹è¿›ï¼Œæ—¨åœ¨ä¼˜åŒ–å¤§å‹é¡¹ç›®çš„å¼€å‘æ•ˆç‡å’Œç»´æŠ¤æˆæœ¬ï¼Œåç»­å†å¾ˆå¤šé¡¹ç›®ä¸­è¢«ä½¿ç”¨</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‹¿æ React ç»„ä»¶é€šè®¯ï¼šä»çˆ¶å­åˆ°è·¨ç»„ä»¶çš„ã€Œä¼ åŠŸç§˜ç±ã€]]></title>    <link>https://juejin.cn/post/7582958136258150436</link>    <guid>https://juejin.cn/post/7582958136258150436</guid>    <pubDate>2025-12-14T09:43:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582958136258150436" data-draft-id="7582862885107531826" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‹¿æ React ç»„ä»¶é€šè®¯ï¼šä»çˆ¶å­åˆ°è·¨ç»„ä»¶çš„ã€Œä¼ åŠŸç§˜ç±ã€"/> <meta itemprop="keywords" content="React.js,å‰ç«¯,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-14T09:43:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é£æ­¢ä½•å®‰å•Š"/> <meta itemprop="url" content="https://juejin.cn/user/2517239724512420"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‹¿æ React ç»„ä»¶é€šè®¯ï¼šä»çˆ¶å­åˆ°è·¨ç»„ä»¶çš„ã€Œä¼ åŠŸç§˜ç±ã€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2517239724512420/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é£æ­¢ä½•å®‰å•Š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:43:59.000Z" title="Sun Dec 14 2025 09:43:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä½ æœ‰æ²¡æœ‰è¿‡è¿™ç§å´©æºƒæ—¶åˆ»ï¼Ÿå†™ <strong>React ç»„ä»¶</strong>æ—¶ï¼Œæƒ³è®©çˆ¶å­ç»„ä»¶äº’é€šæ•°æ®ï¼Œç»“æœä»£ç è¶Šå†™è¶Šä¹±ï¼›å…„å¼Ÿç»„ä»¶æƒ³ä¼ ä¸ªå€¼ï¼Œç»•äº†å…«å±‚çˆ¶ç»„ä»¶è¿˜æ²¡æå®šâ€¦â€¦ ä¸ºå•¥åˆ«äººçš„ React ç»„ä»¶ä¼ å€¼ä¸æ»‘ï¼Ÿåˆ«æ…Œï¼ç§˜å¯†éƒ½åœ¨è¿™ï¼ä»Šå¤©å’±ä»¬ç”¨ <strong>ã€Œæ­¦ä¾ ä¼ åŠŸã€</strong> çš„æ€è·¯ï¼Œ<strong>React ç»„ä»¶</strong>é€šè®¯çš„å‘ï¼Œä¸€ç¯‡å¸®ä½ å¡«å¹³ï¼</p>
<h3 data-id="heading-1">ä¸€ã€çˆ¶å­ç»„ä»¶ï¼šçˆ¶ä¼ å­çš„ã€Œå•å‘ç§˜ç±ã€</h3>
<p>æƒ³è±¡ä¸€ä¸‹ï¼š<strong>çˆ¶ç»„ä»¶</strong>æ˜¯<strong>æ­¦æ—ç›Ÿä¸»</strong>ï¼Œæ‰‹é‡Œæœ‰æœ¬ <strong>ã€Šä¹é˜´çœŸç»ã€‹ï¼ˆå˜é‡ï¼‰</strong>ï¼Œæƒ³ä¼ ç»™<strong>å­ç»„ä»¶</strong>è¿™ä¸ªå°å¾’å¼Ÿã€‚<strong>ä½†è§„çŸ©æ˜¯ï¼š</strong></p>
<blockquote>
<p><strong>å¾’å¼Ÿåªèƒ½çœ‹ï¼Œä¸èƒ½æ”¹ï¼</strong></p>
</blockquote>
<h4 data-id="heading-2">ä¼ åŠŸæ­¥éª¤ï¼š</h4>
<ol>
<li><strong>çˆ¶ç»„ä»¶å‘åŠŸ</strong>ï¼šåœ¨å­ç»„ä»¶æ ‡ç­¾ä¸Šç»‘å®šå±æ€§ï¼ˆæŠŠç§˜ç±é€’å‡ºå»ï¼‰</li>
<li><strong>å­ç»„ä»¶æ¥åŠŸ</strong>ï¼šé€šè¿‡Â <code>props</code>Â æ¥æ”¶ï¼ˆåŒæ‰‹æ¥ä½ç§˜ç±ï¼‰</li>
</ol>
<h4 data-id="heading-3">çœ‹ä¸ªä¾‹å­ï¼š</h4>
<p>çˆ¶ç»„ä»¶ï¼ˆç›Ÿä¸»ï¼‰æŠŠÂ <code>state.name</code>Â ä¼ ç»™å­ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// çˆ¶ç»„ä»¶ Parent.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./Child"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-keyword">const</span> state = {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'henry'</span> <span class="hljs-comment">// è¿™æ˜¯è¦ä¼ çš„ã€Œç§˜ç±ã€</span>
    };
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>çˆ¶ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">msg</span> = <span class="hljs-string">{state.name}/</span>&gt;</span> {/* ç»‘å®šå±æ€§ msgï¼ŒæŠŠç§˜ç±é€’å‡ºå» */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
}
</code></pre>
<p>å­ç»„ä»¶ï¼ˆå¾’å¼Ÿï¼‰ç”¨Â <code>props</code>Â æ¥æ”¶ï¼Œä½†<strong>ä¸èƒ½ä¿®æ”¹</strong>ï¼ˆç§˜ç±æ˜¯åªè¯»çš„ï¼ï¼‰ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// å­ç»„ä»¶ Child.jsx</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(props); <span class="hljs-comment">// èƒ½çœ‹åˆ° {msg: 'henry'}</span>
    <span class="hljs-comment">// props.msg = 'harvest'; // âŒ æŠ¥é”™ï¼props æ˜¯åªè¯»çš„ï¼Œä¸èƒ½æ”¹ï¼</span>
    <span class="hljs-keyword">return</span> (
        {<span class="hljs-comment">/* å±•ç¤ºæ¥æ”¶åˆ°çš„ã€Œç§˜ç±ã€ */</span>}
        &lt;div&gt;å­ç»„ä»¶ -- {props.<span class="hljs-property">msg</span>}&lt;/div&gt; 
    );
}
</code></pre>
<p>æ‰“å°ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/146786c2aee042c5a927b8bd469ca77d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310238&amp;x-signature=8Jht3dxDra9C4r54P2IfXVJxPRo%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä¿®æ”¹å€¼ä¼š<strong>æŠ¥é”™</strong>ï¼ˆåªè¯»ï¼Œä¸èƒ½æ”¹ï¼ï¼‰ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f72903720c1436faaab44fdd7165e0f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310238&amp;x-signature=kjxWCo9vuhvJUZOWisP%2FuHiMSlU%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">äºŒã€å­çˆ¶ç»„ä»¶ï¼šå­ä¼ çˆ¶çš„ã€Œåå‘ä¼ åŠŸã€</h3>
<p>è¿™æ¬¡åè¿‡æ¥ï¼š<strong>å­ç»„ä»¶</strong>æ˜¯å¾’å¼Ÿï¼Œç»ƒå‡ºäº†<strong>æ–°æ‹›å¼ï¼ˆå˜é‡ï¼‰</strong>ï¼Œæƒ³ä¼ ç»™çˆ¶ç»„ä»¶ç›Ÿä¸»ã€‚ä½†å¾’å¼Ÿä¸èƒ½ç›´æ¥å¡ç»™ç›Ÿä¸»ï¼Œå¾—<strong>è®©ç›Ÿä¸»é€’ä¸ªã€Œæ¥æ”¶è¢‹ã€ï¼ˆå‡½æ•°ï¼‰ï¼Œå¾’å¼ŸæŠŠæ‹›å¼è£…è¿›å»</strong>ã€‚</p>
<h4 data-id="heading-5">ä¼ åŠŸæ­¥éª¤ï¼š</h4>
<ol>
<li><strong>çˆ¶ç»„ä»¶é€’è¢‹</strong>ï¼šå®šä¹‰æ¥æ”¶æ•°æ®çš„å‡½æ•°ï¼ˆå‡†å¤‡å¥½æ¥æ”¶è¢‹ï¼‰</li>
<li><strong>çˆ¶ä¼ å­è¢‹</strong>ï¼šæŠŠå‡½æ•°é€šè¿‡Â <code>props</code>Â ä¼ ç»™å­ç»„ä»¶ï¼ˆæŠŠè¢‹å­é€’è¿‡å»ï¼‰</li>
<li><strong>å­ç»„ä»¶è£…æ‹›</strong>ï¼šè°ƒç”¨å‡½æ•°å¹¶ä¼ æ•°æ®ï¼ˆæŠŠæ–°æ‹›å¼è£…è¿›è¢‹å­ï¼‰</li>
</ol>
<h4 data-id="heading-6">ä»£ç ä¾‹å­ï¼š</h4>
<p>çˆ¶ç»„ä»¶å‡†å¤‡ã€Œæ¥æ”¶è¢‹ã€<code>getNum</code>ï¼Œä¼ ç»™å­ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// çˆ¶ç»„ä»¶ Parent.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./Child"</span>
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">1</span>);
    <span class="hljs-comment">// å®šä¹‰ã€Œæ¥æ”¶è¢‹ã€ï¼šæ”¶åˆ°æ•°æ®åæ›´æ–°è‡ªå·±çš„çŠ¶æ€</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">getNum</span> = (<span class="hljs-params">n</span>) =&gt; {
        <span class="hljs-title function_">setCount</span>(n);
    }
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>çˆ¶ç»„ä»¶äºŒ -- {count}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">getNum</span> = <span class="hljs-string">{getNum}/</span>&gt;</span> {/* æŠŠè¢‹å­é€’è¿‡å» */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
}
</code></pre>
<p>å­ç»„ä»¶è°ƒç”¨Â <code>getNum</code>ï¼ŒæŠŠè‡ªå·±çš„Â <code>state.num</code>Â ä¼ è¿‡å»ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// å­ç»„ä»¶ Child.jsx</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Child</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-keyword">const</span> state = {
        <span class="hljs-attr">num</span>: <span class="hljs-number">100</span> <span class="hljs-comment">// è‡ªå·±ç»ƒçš„æ–°æ‹›å¼</span>
    };
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">send</span>(<span class="hljs-params"/>) {
        props.<span class="hljs-title function_">getNum</span>(state.<span class="hljs-property">num</span>); <span class="hljs-comment">// æŠŠæ–°æ‹›å¼è£…è¿›è¢‹å­</span>
    }
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>å­ç»„ä»¶äºŒ<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{send}</span>&gt;</span>å‘é€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span> {/* ç‚¹æŒ‰é’®ä¼ åŠŸ */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p>ç‚¹å‡»å‘é€å‰ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/815973cc0dfe4dca8bc53eebe030d810~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310238&amp;x-signature=Dp6X4gn6ytRuB5JxXvAnBe%2BXsn0%3D" alt="image.png" loading="lazy"/></p>
<p>ç‚¹å‡»å‘é€åï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/99fcfbc430504d5d81c34eac865329cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310238&amp;x-signature=m3%2BnHV3lrL9kBulmU%2BgSjObFsPQ%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™æ ·æˆ‘ä»¬å°±æˆåŠŸçš„æŠŠå­ç»„ä»¶çš„å˜é‡ä¼ ç»™äº†çˆ¶ç»„ä»¶ã€‚è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº†<code>useState</code>ï¼Œè‡³äºå®ƒçš„ä½œç”¨æˆ‘ä»¬æš‚æ—¶å…ˆä¸è®²ï¼Œæˆ‘ä»¬å…ˆææ‡‚é€šè®¯ã€‚</p>
<h3 data-id="heading-7">ä¸‰ã€å…„å¼Ÿç»„ä»¶ï¼šã€Œçˆ¶ç»„ä»¶å½“ä¸­é—´å•†ã€</h3>
<p>å…„å¼Ÿç»„ä»¶åƒä¸¤ä¸ªå¸ˆå…„å¼Ÿï¼Œæƒ³äº’ç›¸ä¼ åŠŸï¼Ÿå¾—å…ˆæŠŠæ‹›å¼ä¼ ç»™ç›Ÿä¸»<strong>çˆ¶ç»„ä»¶</strong>ï¼ˆä¸­é—´å•†ï¼‰ï¼Œå†è®©çˆ¶ç»„ä»¶è½¬ç»™å¦ä¸€ä¸ªå…„å¼Ÿã€‚</p>
<h4 data-id="heading-8">ä¼ åŠŸæ­¥éª¤ï¼š</h4>
<ol>
<li><strong>å¼Ÿ 1 ä¼ çˆ¶</strong>ï¼šå¼Ÿ 1 æŠŠæ•°æ®ä¼ ç»™çˆ¶ç»„ä»¶</li>
<li><strong>çˆ¶ä¼ å¼Ÿ 2</strong>ï¼šçˆ¶ç»„ä»¶æŠŠæ•°æ®ä¼ ç»™å¼Ÿ 2</li>
</ol>
<h4 data-id="heading-9">ä¾æ—§ä»£ç ï¼š</h4>
<p>çˆ¶ç»„ä»¶å½“ä¸­é—´å•†ï¼Œæ¥æ”¶ Child1 çš„æ•°æ®ï¼Œå†ä¼ ç»™ Child2ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// çˆ¶ç»„ä»¶ Parent.jsx</span>
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child1</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./Child1"</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child2</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./Child2"</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-keyword">let</span> [message, setMessage] = <span class="hljs-title function_">useState</span>();
    <span class="hljs-comment">// æ¥æ”¶ Child1 çš„æ•°æ®</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">getMeg</span> = (<span class="hljs-params">msg</span>) =&gt; {
        <span class="hljs-title function_">setMessage</span>(msg);
    }
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>çˆ¶ç»„ä»¶ä¸‰<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Child1</span> <span class="hljs-attr">getMeg</span> = <span class="hljs-string">{getMeg}</span> /&gt;</span> {/* æ”¶ Child1 çš„æ•°æ® */}
            <span class="hljs-tag">&lt;<span class="hljs-name">Child2</span> <span class="hljs-attr">msg</span> = <span class="hljs-string">{message}/</span>&gt;</span> {/* æŠŠæ•°æ®ä¼ ç»™ Child2 */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><strong>Child1ï¼ˆå…„ï¼‰</strong> ä¼ æ•°æ®ç»™çˆ¶ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// Child1.jsx</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Child1</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-keyword">const</span> state = {
        <span class="hljs-attr">msg</span>: <span class="hljs-string">'3.1'</span>
    };
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">send</span>(<span class="hljs-params"/>) {
        props.<span class="hljs-title function_">getMeg</span>(state.<span class="hljs-property">msg</span>); <span class="hljs-comment">// ä¼ ç»™çˆ¶ç»„ä»¶</span>
    }
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>å­ç»„ä»¶3.1<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{send}</span>&gt;</span>å‘é€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><strong>Child2ï¼ˆå¼Ÿï¼‰</strong> æ¥æ”¶çˆ¶ç»„ä»¶ä¼ æ¥çš„æ•°æ®ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// Child2.jsx</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Child2</span>(<span class="hljs-params">props</span>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>å­ç»„ä»¶3.2 -- {props.msg}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span> {/* å±•ç¤ºå…„ä¼ æ¥çš„æ•°æ® */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    )
}
</code></pre>
<p><strong>å‘é€å‰ï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/944fe96fc69e403a85cb18d23a57bd55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310238&amp;x-signature=m0rTB3ECxT7%2F0s94a64nAuGynbs%3D" alt="image.png" loading="lazy"/></p>
<p><strong>å‘é€åï¼š</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5ea7511984024c938ad5874a0ca87f1c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310238&amp;x-signature=edttww7uTKNIHRyLCs3iwVdXHDE%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æ­¤è¿™èˆ¬ï¼Œ<strong>å­ç»„ä»¶3.2</strong>å°±æˆåŠŸæ¥æ”¶åˆ°äº†<strong>å­ç»„ä»¶3.1</strong>çš„ä¼ é€’ä¿¡æ¯ã€‚</p>
<h3 data-id="heading-10">å››ã€è·¨ç»„ä»¶é€šä¿¡ï¼šã€ŒContext å…¨å±€å¹¿æ’­ã€</h3>
<p>å¦‚æœç»„ä»¶åµŒå¥—äº†å¥½å¤šå±‚ï¼ˆæ¯”å¦‚çˆ¶â†’å­â†’å­™â†’é‡å­™ï¼‰ï¼Œä¸€å±‚å±‚ä¼ åŠŸå¤ªéº»çƒ¦äº†ï¼è¿™æ—¶å€™ç”¨Â <code>Context</code>Â å°±åƒ <strong>ã€Œæ­¦æ—å¹¿æ’­ã€</strong>ï¼šçˆ¶ç»„ä»¶æŠŠæ•°æ®å¹¿æ’­å‡ºå»ï¼Œæ‰€æœ‰åä»£ç»„ä»¶éƒ½èƒ½ç›´æ¥æ”¶åˆ°ã€‚</p>
<h4 data-id="heading-11">å¹¿æ’­æ­¥éª¤ï¼š</h4>
<ol>
<li><strong>çˆ¶ç»„ä»¶å»ºå¹¿æ’­å°</strong>ï¼šç”¨Â <code>createContext</code>Â åˆ›å»ºä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œç”¨Â <code>Provider</code>Â å¹¿æ’­æ•°æ®</li>
<li><strong>åä»£ç»„ä»¶æ”¶å¹¿æ’­</strong>ï¼šç”¨Â <code>useContext</code>Â æ¥æ”¶å¹¿æ’­çš„å†…å®¹</li>
</ol>
<h4 data-id="heading-12">è¿˜æ˜¯ä»£ç ï¼š</h4>
<p>çˆ¶ç»„ä»¶å»ºå¹¿æ’­å°ï¼Œå¹¿æ’­ã€Œçˆ¶ç»„ä»¶çš„æ•°æ®ã€ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// çˆ¶ç»„ä»¶ Parent.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Child1</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./Child1"</span>;
<span class="hljs-keyword">import</span> { createContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-comment">// åˆ›å»ºä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆå¹¿æ’­å°ï¼‰</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">Context</span> = <span class="hljs-title function_">createContext</span>() 
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Parent</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>çˆ¶ç»„ä»¶å››<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            {/* ç”¨ Provider å¹¿æ’­æ•°æ®ï¼Œvalue æ˜¯è¦ä¼ çš„å†…å®¹ */}
            <span class="hljs-tag">&lt;<span class="hljs-name">Context.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{</span>'<span class="hljs-attr">çˆ¶ç»„ä»¶çš„æ•°æ®</span>'}&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Child1</span>/&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">Context.Provider</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
}
</code></pre>
<p>å­™ç»„ä»¶ç›´æ¥æ”¶å¹¿æ’­ï¼ˆä¸ç”¨ç»è¿‡å­ç»„ä»¶ï¼‰ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// å­™ç»„ä»¶ Child2.jsx</span>
<span class="hljs-keyword">import</span> { useContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Context</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./Parent'</span> <span class="hljs-comment">// å¼•å…¥å¹¿æ’­å°</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Child2</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> msg = <span class="hljs-title function_">useContext</span>(<span class="hljs-title class_">Context</span>) <span class="hljs-comment">// ç›´æ¥æ¥æ”¶å¹¿æ’­å†…å®¹</span>
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>å­™å­ç»„ä»¶ --- {msg}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span> {/* å±•ç¤ºå¹¿æ’­çš„å†…å®¹ */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
}
</code></pre>
<p>å¦å¤–é™„ä¸Šå­ç»„ä»¶ä»£ç ï¼š</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Child2</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./Child2"</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Child1</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>å­ç»„ä»¶<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Child2</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
}
</code></pre>
<p>ç»“æœå­™å­ç»„ä»¶æˆåŠŸå¾—åˆ°çˆ¶ç»„ä»¶çš„æ•°æ®ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0a19627caf14d7e8e16d3239b512039~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6aOO5q2i5L2V5a6J5ZWK:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310238&amp;x-signature=gGKgp2rYGBnVJQIWCWXRG1NJ%2Bes%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-13">äº”ã€æ¸©é¦¨æç¤º</h3>
<p>åˆ«å¿˜äº†<code>App.jsx</code>å’Œ<code>main.jsx</code>æ–‡ä»¶ï¼å‰é¢çš„æ‰€æœ‰ç»“æœéƒ½éœ€è¦è¿™ä¸¤ä¸ª<strong>å¤§ä½¬</strong>çš„æ”¯æŒã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// App.jsx</span>
<span class="hljs-comment">// import Parent from "./demo1/Parent"</span>
<span class="hljs-comment">// import Parent from "./demo2/Parent"</span>
<span class="hljs-comment">// import Parent from "./demo3/Parent"</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Parent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./demo4/Parent"</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Parent</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">Parent</span>&gt;</span></span>
    )
}
</code></pre>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-comment">// main.jsx</span>
<span class="hljs-keyword">import</span> { createRoot } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom/client'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.jsx'</span>

<span class="hljs-title function_">createRoot</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>)).<span class="hljs-title function_">render</span>(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span></span>
)
</code></pre>
<p>è¿™ä¸¤ä»½æ˜¯åˆ›å»º<code>React</code>è‡ªå¸¦çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æé†’ä¸€ä¸‹å¤§å®¶åˆ«å¿˜äº†ï¼</p>
<h3 data-id="heading-14">å…­ã€æ€»ç»“ï¼šç»„ä»¶é€šè®¯ã€Œæ­¦åŠŸè°±ã€</h3>






























<table><thead><tr><th>é€šè®¯åœºæ™¯</th><th>æ–¹æ³•</th><th>æ ¸å¿ƒæ€è·¯</th></tr></thead><tbody><tr><td>çˆ¶å­ç»„ä»¶</td><td>props ä¼ å€¼</td><td>çˆ¶ä¼ å­ï¼Œå­åªè¯»</td></tr><tr><td>å­çˆ¶ç»„ä»¶</td><td>props ä¼ å‡½æ•°</td><td>çˆ¶ç»™å‡½æ•°ï¼Œå­è°ƒç”¨ä¼ æ•°æ®</td></tr><tr><td>å…„å¼Ÿç»„ä»¶</td><td>çˆ¶ç»„ä»¶ä¸­è½¬</td><td>å­â†’çˆ¶â†’å¦ä¸€ä¸ªå­</td></tr><tr><td>è·¨ç»„ä»¶</td><td>Contextï¼ˆä¸Šä¸‹æ–‡ï¼‰</td><td>çˆ¶å¹¿æ’­ï¼Œåä»£ç›´æ¥æ”¶</td></tr></tbody></table>
<h2 data-id="heading-15">ç»“è¯­</h2>
<p>å…¶å® React ç»„ä»¶é€šè®¯çš„æ ¸å¿ƒï¼Œä»æ¥éƒ½ä¸æ˜¯æ­»è®°ç¡¬èƒŒæ­¥éª¤ï¼Œè€Œæ˜¯<strong>æ‰¾å‡†æ•°æ®çš„æµå‘</strong>ã€‚çˆ¶å­ä¼ å€¼ç”¨Â <code>props</code>Â å•å‘ä¼ é€’ï¼Œå­çˆ¶ä¼ å€¼å€Ÿå‡½æ•°åå‘æ­æ¡¥ï¼Œå…„å¼Ÿç»„ä»¶é çˆ¶ç»„ä»¶å½“ â€œä¸­è½¬ç«™â€ï¼Œè·¨å±‚çº§é€šä¿¡å°±ç”¨Â <code>Context</code>Â æ‰“ç ´åµŒå¥—å£å’ã€‚</p>
<p>è¿™äº›æ–¹æ³•æ²¡æœ‰ä¼˜åŠ£ä¹‹åˆ†ï¼Œåªæœ‰åœºæ™¯ä¹‹åˆ«ã€‚æ–°æ‰‹é˜¶æ®µå…ˆæŠŠÂ <code>props</code>Â å’Œå‡½æ•°ä¼ å€¼ç»ƒç†Ÿï¼Œå†é€æ­¥å°è¯•Â <code>Context</code>ï¼Œç”šè‡³åç»­å­¦ä¹ çš„ Redux ç­‰çŠ¶æ€ç®¡ç†åº“ï¼Œéƒ½æ˜¯åœ¨è¿™ä¸ªåŸºç¡€ä¸Šçš„å»¶ä¼¸ã€‚</p>
<p><strong>è®°ä½ï¼š</strong></p>
<blockquote>
<p><strong>ç»„ä»¶é€šè®¯</strong>çš„<strong>æœ¬è´¨</strong>ï¼Œå°±æ˜¯è®©æ•°æ®åœ¨åˆé€‚çš„ç»„ä»¶é—´æœ‰åºæµåŠ¨ã€‚ç°åœ¨å°±æ‰“å¼€ç¼–è¾‘å™¨ï¼ŒæŠŠè¿™äº›ä¾‹å­æ•²ä¸€éï¼Œä½ ä¼šå‘ç°ï¼Œé‚£äº›æ›¾ç»è®©ä½ å¤´ç–¼çš„ä¼ å€¼é—®é¢˜ï¼Œæ—©å°±è¿åˆƒè€Œè§£äº†ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°†flutteræ‰“æˆaaråŒ…åµŒå…¥åˆ°å®‰å“]]></title>    <link>https://juejin.cn/post/7583530023358693414</link>    <guid>https://juejin.cn/post/7583530023358693414</guid>    <pubDate>2025-12-14T09:44:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583530023358693414" data-draft-id="7583535861644918830" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°†flutteræ‰“æˆaaråŒ…åµŒå…¥åˆ°å®‰å“"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-14T09:44:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ‡’å¾—ä¸æƒ³èµ·åå­—"/> <meta itemprop="url" content="https://juejin.cn/user/3731068456799563"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°†flutteræ‰“æˆaaråŒ…åµŒå…¥åˆ°å®‰å“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3731068456799563/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ‡’å¾—ä¸æƒ³èµ·åå­—
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:44:08.000Z" title="Sun Dec 14 2025 09:44:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Flutter Module æ‰“åŒ…æˆ AAR å¹¶é›†æˆåˆ° Android é¡¹ç›®</h2>
<h3 data-id="heading-1">ä¸€ã€åˆ›å»º Flutter Module</h3>
<p>å¦‚æœä½  <strong>è¿˜æ²¡æœ‰ Flutter Module</strong></p>
<pre><code class="hljs language-bash" lang="bash">flutter create -t module flutter_module
</code></pre>
<h3 data-id="heading-2">äºŒã€æ„å»º Flutter AAR</h3>
<h4 data-id="heading-3">æ‰§è¡Œ AAR æ„å»ºå‘½ä»¤</h4>
<pre><code class="hljs language-bash" lang="bash">flutter build aar
</code></pre>
<h4 data-id="heading-4">æ„å»ºäº§ç‰©ä½ç½®</h4>
<pre><code class="hljs language-text" lang="text">flutter_module/build/host/outputs/repo/
</code></pre>
<h4 data-id="heading-5">æ„å»ºæ§åˆ¶å°è¾“å‡º</h4>
<p>åœ¨ä¸‹é¢çš„é…ç½®ä¸­ä¼šç”¨åˆ°</p>
<pre><code class="hljs language-sql" lang="sql">  <span class="hljs-number">1.</span> <span class="hljs-keyword">Open</span> <span class="hljs-operator">&lt;</span>host<span class="hljs-operator">&gt;</span>\app\build.gradle
  <span class="hljs-number">2.</span> Ensure you have the repositories configured, otherwise <span class="hljs-keyword">add</span> them:

      String storageUrl <span class="hljs-operator">=</span> System.env.FLUTTER_STORAGE_BASE_URL ?: "https://storage.googleapis.com"
      repositories {
        maven {
            url <span class="hljs-string">'E:\lumosproject\module\lumos\build\host\outputs\repo'</span>
        }
        maven {
            url "$storageUrl/download.flutter.io"
        }
      }

  <span class="hljs-number">3.</span> Make the host app depend <span class="hljs-keyword">on</span> the Flutter <span class="hljs-keyword">module</span>:

    dependencies {
      debugImplementation <span class="hljs-string">'com.example.lumos:flutter_debug:1.0'</span>
      profileImplementation <span class="hljs-string">'com.example.lumos:flutter_profile:1.0'</span>
      releaseImplementation <span class="hljs-string">'com.example.lumos:flutter_release:1.0'</span>
    }


  <span class="hljs-number">4.</span> <span class="hljs-keyword">Add</span> the `profile` build type:

    android {
      buildTypes {
        profile {
          initWith debug
        }
      }
    }

</code></pre>
<hr/>
<h3 data-id="heading-6">ä¸‰ã€Android å®¿ä¸»é¡¹ç›®é›†æˆ AAR</h3>
<h4 data-id="heading-7">1. ä¿®æ”¹MyApp/app/build.gradle</h4>
<p>ä½ ç›®å‰ç°æœ‰çš„ Android é¡¹ç›®å¯èƒ½æ”¯æŒÂ <code>mips</code>Â æˆ–Â <code>x86</code>Â ä¹‹ç±»çš„æ¶æ„ï¼Œç„¶è€Œï¼ŒFlutterÂ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.flutter.cn%2Fresources%2Ffaq%23what-devices-and-os-versions-does-flutter-run-on" target="_blank" title="https://docs.flutter.cn/resources/faq#what-devices-and-os-versions-does-flutter-run-on" ref="nofollow noopener noreferrer">å½“å‰ä»…æ”¯æŒ</a>Â ä¸ºÂ <code>x86_64</code>ï¼Œ<code>armeabi-v7a</code>Â å’ŒÂ <code>arm64-v8a</code>Â æ„å»ºé¢„ç¼–ï¼ˆAOTï¼‰çš„åº“ã€‚</p>
<p>å¯ä»¥è€ƒè™‘ä½¿ç”¨Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Ftools%2Fgradle-api%2F4.2%2Fcom%2Fandroid%2Fbuild%2Fapi%2Fdsl%2FNdk%23abiFilters%3Akotlin.collections.MutableSet" target="_blank" title="https://developer.android.google.cn/reference/tools/gradle-api/4.2/com/android/build/api/dsl/Ndk#abiFilters:kotlin.collections.MutableSet" ref="nofollow noopener noreferrer"><code>abiFilters</code></a>Â è¿™ä¸ª Android Gradle æ’ä»¶ API æ¥æŒ‡å®š APK ä¸­æ”¯æŒçš„æ¶æ„ï¼Œä»è€Œé¿å…Â <code>libflutter.so</code>Â æ— æ³•ç”Ÿæˆè€Œå¯¼è‡´åº”ç”¨è¿è¡Œæ—¶å´©æºƒï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š</p>
<h5 data-id="heading-8">Groovy ç‰ˆ</h5>
<pre><code class="hljs language-arduino" lang="arduino">android {
    defaultConfig {
        ndk {
            <span class="hljs-comment">// Filter for architectures supported by Flutter</span>
            abiFilters <span class="hljs-string">"armeabi-v7a"</span>, <span class="hljs-string">"arm64-v8a"</span>, <span class="hljs-string">"x86_64"</span>
        }
    }
}
</code></pre>
<h5 data-id="heading-9">Kotlin DSL</h5>
<pre><code class="hljs language-arduino" lang="arduino">android {
    defaultConfig {
        ndk {
            <span class="hljs-comment">// Filter for architectures supported by Flutter</span>
            abiFilters += <span class="hljs-built_in">listOf</span>(<span class="hljs-string">"armeabi-v7a"</span>, <span class="hljs-string">"arm64-v8a"</span>, <span class="hljs-string">"x86_64"</span>)
        }
    }
}
</code></pre>
<hr/>
<h4 data-id="heading-10">2. é…ç½® <code>settings.gradle(.kts)</code></h4>
<p><strong>åœ¨å›½å†…ï¼Œéœ€è¦ä½¿ç”¨é•œåƒç«™ç‚¹ä»£æ›¿Â <code>storage.googleapis.com</code>ã€‚æœ‰å…³é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼Œå‚è§Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.flutter.cn%2Fcommunity%2Fchina" target="_blank" title="https://docs.flutter.cn/community/china" ref="nofollow noopener noreferrer">åœ¨ä¸­å›½ç½‘ç»œç¯å¢ƒä¸‹ä½¿ç”¨ Flutter</a>Â é¡µé¢ã€‚</strong></p>
<h5 data-id="heading-11">Groovy ç‰ˆ</h5>
<pre><code class="hljs language-groovy" lang="groovy">dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    String storageUrl = System.env.FLUTTER_STORAGE_BASE_URL ?: "https://storage.flutter-io.cn"
    repositories {

        google()
        mavenCentral()
        maven {
            url 'E:/lumosproject/module/lumos/build/host/outputs/repo'
        }
        maven {
            url "$storageUrl/download.flutter.io"
        }
    }
}
</code></pre>
<h5 data-id="heading-12">Kotlin DSL</h5>
<pre><code class="hljs language-kotlin" lang="kotlin">dependencyResolutionManagement {
    repositoriesMode.<span class="hljs-keyword">set</span>(RepositoriesMode.PREFER_SETTINGS)
    repositories {
        google()
        mavenCentral()
        maven(<span class="hljs-string">"https://storage.googleapis.com/download.flutter.io"</span>)
    }
}
</code></pre>
<hr/>
<h4 data-id="heading-13">3. æ·»åŠ ä¾èµ–ï¼ˆapp/build.gradleï¼‰</h4>
<p>è¿™é‡Œæ·»åŠ çš„ä¾èµ–éƒ½æ˜¯build aar æ§åˆ¶å°è¾“å‡ºçš„å†…å®¹</p>
<h5 data-id="heading-14">groovyç‰ˆ</h5>
<pre><code class="hljs language-groovy" lang="groovy">dependencies {
   debugImplementation 'com.example.untitled:flutter_debug:1.0'
   profileImplementation 'com.example.untitled:flutter_profile:1.0'
   releaseImplementation 'com.example.untitled:flutter_release:1.0'
}
</code></pre>
<h5 data-id="heading-15">Kotlin DSL</h5>
<pre><code class="hljs language-scss" lang="scss">dependencies {
<span class="hljs-built_in">debugImplementation</span>("com.example.flutter_module:flutter_debug:<span class="hljs-number">1.0</span>")    
<span class="hljs-built_in">releaseImplementation</span>("com.example.flutter_module:flutter_release:<span class="hljs-number">1.0</span>")   
<span class="hljs-built_in">add</span>("profileImplementation", "com.example.flutter_module:flutter_profile:<span class="hljs-number">1.0</span>") 
}
</code></pre>
<h4 data-id="heading-16">4. æ·»åŠ <code>profile</code> build type(app/build.gradle)</h4>
<p>åœ¨<strong>buildTypes</strong>ä¸­æ·»åŠ </p>
<h5 data-id="heading-17">groovyç‰ˆ</h5>
<pre><code class="hljs language-lua" lang="lua">profile {
    initWith <span class="hljs-built_in">debug</span>
}
</code></pre>
<h5 data-id="heading-18">Kotlin DSL</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">create</span>(<span class="hljs-params"><span class="hljs-string">"profile"</span></span>) { <span class="hljs-title function_">initWith</span>(<span class="hljs-title function_">getByName</span>(<span class="hljs-string">"debug"</span>)) }
</code></pre>
<hr/>
<h3 data-id="heading-19">å››ã€Android å¯åŠ¨ Flutter é¡µé¢</h3>
<h4 data-id="heading-20">1.åœ¨ AndroidManifest.xml ä¸­æ·»åŠ  FlutterActivity</h4>
<p>Flutter æä¾›äº†Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fapi.flutter-io.cn%2Fjavadoc%2Fio%2Fflutter%2Fembedding%2Fandroid%2FFlutterActivity.html" target="_blank" title="https://api.flutter-io.cn/javadoc/io/flutter/embedding/android/FlutterActivity.html" ref="nofollow noopener noreferrer"><code>FlutterActivity</code></a>ï¼Œç”¨äºåœ¨ Android åº”ç”¨å†…éƒ¨å±•ç¤ºä¸€ä¸ª Flutter çš„äº¤äº’ç•Œé¢ã€‚å’Œå…¶ä»–çš„Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fandroid%2Fapp%2FActivity" target="_blank" title="https://developer.android.google.cn/reference/android/app/Activity" ref="nofollow noopener noreferrer"><code>Activity</code></a>Â ä¸€æ ·ï¼Œ<code>FlutterActivity</code>Â å¿…é¡»åœ¨é¡¹ç›®çš„Â <code>AndroidManifest.xml</code>Â æ–‡ä»¶ä¸­æ³¨å†Œã€‚å°†ä¸‹è¾¹çš„ XML ä»£ç æ·»åŠ åˆ°ä½ çš„Â <code>AndroidManifest.xml</code>Â æ–‡ä»¶ä¸­çš„Â <code>application</code>Â æ ‡ç­¾å†…</p>
<pre><code class="hljs language-ini" lang="ini">&lt;activity
  android:<span class="hljs-attr">name</span>=<span class="hljs-string">"io.flutter.embedding.android.FlutterActivity"</span>
  android:<span class="hljs-attr">theme</span>=<span class="hljs-string">"@style/LaunchTheme"</span>   android:configChanges=<span class="hljs-string">"orientation|keyboardHidden|keyboard|screenSize|locale|layoutDirection|fontScale|screenLayout|density|uiMode"</span>
  android:<span class="hljs-attr">hardwareAccelerated</span>=<span class="hljs-string">"true"</span>
  android:<span class="hljs-attr">windowSoftInputMode</span>=<span class="hljs-string">"adjustResize"</span>
  /&gt;
</code></pre>
<hr/>
<h4 data-id="heading-21">2. åŠ è½½ FlutterActivity</h4>
<p>ç¡®ä¿ä½¿ç”¨å¦‚ä¸‹çš„è¯­å¥å¯¼å…¥ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-keyword">import</span> io.flutter.embedding.android.FlutterActivity;
</code></pre>
<pre><code class="hljs language-kotlin" lang="kotlin">MyButton(onClick = {
    startActivity(
        FlutterActivity.createDefaultIntent(<span class="hljs-keyword">this</span>)
    )
})

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MyButton</span><span class="hljs-params">(onClick: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    Button(onClick = onClick) {
        Text(<span class="hljs-string">"Launch Flutter!"</span>)
    }
}
</code></pre>
<p>ä¸Šè¿°çš„ä¾‹å­å‡å®šäº†ä½ çš„ Dart ä»£ç å…¥å£æ˜¯è°ƒç”¨Â <code>main()</code>ï¼Œå¹¶ä¸”ä½ çš„ Flutter åˆå§‹è·¯ç”±æ˜¯ '/'ã€‚ Dart ä»£ç å…¥å£ä¸èƒ½é€šè¿‡Â <code>Intent</code>Â æ”¹å˜ï¼Œä½†æ˜¯åˆå§‹è·¯ç”±å¯ä»¥é€šè¿‡Â <code>Intent</code>Â æ¥ä¿®æ”¹ã€‚ä¸‹é¢çš„ä¾‹å­è®²è§£äº†å¦‚ä½•æ‰“å¼€ä¸€ä¸ªè‡ªå®šä¹‰ Flutter åˆå§‹è·¯ç”±çš„Â <code>FlutterActivity</code>ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin">MyButton(onClick = {
  startActivity(
    FlutterActivity
      .withNewEngine()
      .initialRoute(<span class="hljs-string">"/my_route"</span>)
      .build(<span class="hljs-keyword">this</span>)
  )
})

<span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MyButton</span><span class="hljs-params">(onClick: () -&gt; <span class="hljs-type">Unit</span>)</span></span> {
    Button(onClick = onClick) {
        Text(<span class="hljs-string">"Launch Flutter!"</span>)
    }
}
</code></pre>
<hr/>
<h4 data-id="heading-22">3. ä½¿ç”¨ç¼“å­˜ Engineï¼ˆæ¨èï¼‰</h4>
<p>æ¯ä¸€ä¸ªÂ <code>FlutterActivity</code>Â é»˜è®¤ä¼šåˆ›å»ºå®ƒè‡ªå·±çš„Â <code>FlutterEngine</code>ã€‚æ¯ä¸€ä¸ªÂ <code>FlutterEngine</code>Â ä¼šæœ‰ä¸€ä¸ªæ˜æ˜¾çš„é¢„çƒ­æ—¶é—´ã€‚è¿™æ„å‘³ç€åŠ è½½ä¸€ä¸ªæ ‡å‡†çš„Â <code>FlutterActivity</code>Â æ—¶ï¼Œåœ¨ä½ çš„ Flutter äº¤äº’é¡µé¢å¯è§ä¹‹å‰ä¼šæœ‰ä¸€ä¸ªçŸ­æš‚çš„å»¶è¿Ÿã€‚æƒ³è¦æœ€å°åŒ–è¿™ä¸ªå»¶è¿Ÿæ—¶é—´ï¼Œä½ å¯ä»¥åœ¨æŠµè¾¾ä½ çš„Â <code>FlutterActivity</code>Â ä¹‹å‰ï¼Œåˆå§‹åŒ–ä¸€ä¸ªÂ <code>FlutterEngine</code>ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªå·²ç»é¢„çƒ­å¥½çš„Â <code>FlutterEngine</code>ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
  <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> flutterEngine : FlutterEngine

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">super</span>.onCreate()

    <span class="hljs-comment">// Instantiate a FlutterEngine.</span>
    flutterEngine = FlutterEngine(<span class="hljs-keyword">this</span>)

    <span class="hljs-comment">// Start executing Dart code to pre-warm the FlutterEngine.</span>
    flutterEngine.dartExecutor.executeDartEntrypoint(
      DartExecutor.DartEntrypoint.createDefault()
    )

    <span class="hljs-comment">// Cache the FlutterEngine to be used by FlutterActivity.</span>
    FlutterEngineCache
      .getInstance()
      .put(<span class="hljs-string">"my_engine_id"</span>, flutterEngine)
  }
}
</code></pre>
<h5 data-id="heading-23">ä½¿ç”¨</h5>
<pre><code class="hljs language-kotlin" lang="kotlin">myButton.setOnClickListener {
  startActivity(
    FlutterActivity
      .withCachedEngine(<span class="hljs-string">"my_engine_id"</span>)
      .build(<span class="hljs-keyword">this</span>)
  )
}
</code></pre>
<h5 data-id="heading-24">ä¸ºç¼“å­˜çš„ FlutterEngine è®¾ç½®åˆå§‹è·¯ç”±</h5>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyApplication</span> : <span class="hljs-type">Application</span>() {
  <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> flutterEngine : FlutterEngine
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">super</span>.onCreate()
    <span class="hljs-comment">// Instantiate a FlutterEngine.</span>
    flutterEngine = FlutterEngine(<span class="hljs-keyword">this</span>)
    <span class="hljs-comment">// Configure an initial route.</span>
    flutterEngine.navigationChannel.setInitialRoute(<span class="hljs-string">"your/route/here"</span>);
    <span class="hljs-comment">// Start executing Dart code to pre-warm the FlutterEngine.</span>
    flutterEngine.dartExecutor.executeDartEntrypoint(
      DartExecutor.DartEntrypoint.createDefault()
    )
    <span class="hljs-comment">// Cache the FlutterEngine to be used by FlutterActivity or FlutterFragment.</span>
    FlutterEngineCache
      .getInstance()
      .put(<span class="hljs-string">"my_engine_id"</span>, flutterEngine)
  }
}
</code></pre>
<h6 data-id="heading-25">é€šè¿‡è®¾ç½®è·¯ç”±çš„æ–¹å¼å¯ä»¥é…ç½®ç¼“å­˜å¼•æ“åœ¨æ‰§è¡Œ Dart å…¥å£ç‚¹ä¹‹å‰ä½¿ç”¨è‡ªå®šä¹‰åˆå§‹è·¯ç”±</h6>
<hr/>
<h3 data-id="heading-26">äº”ã€Flutter ä¸ Android é€šä¿¡</h3>
<h4 data-id="heading-27">MethodChannelæ–¹å¼</h4>
<h4 data-id="heading-28">Flutter</h4>
<p>æ·»åŠ åˆ°åˆé€‚çš„åœ°æ–¹</p>
<pre><code class="hljs language-dart" lang="dart"><span class="hljs-keyword">static</span> <span class="hljs-keyword">const</span> methodChannel = MethodChannel(<span class="hljs-string">'com.bluetoothCharacteristic'</span>);
methodChannel.setMethodCallHandler(_handleMethod);
Future&lt;<span class="hljs-built_in">dynamic</span>&gt; _handleMethod(MethodCall call) <span class="hljs-keyword">async</span> {
  <span class="hljs-keyword">switch</span> (call.method) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'bluetoothCharacteristic'</span>:
      <span class="hljs-comment">// è®¾ç½®è®¾å¤‡å†™å…¥ç‰¹å¾</span>
      _device.setWriteCharacteristic(
        call.arguments <span class="hljs-keyword">as</span> BluetoothCharacteristic,
      );
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">throw</span> PlatformException(code: <span class="hljs-string">'Unrecognized Method'</span>);
  }
}
</code></pre>
<hr/>
<h4 data-id="heading-29">Android</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">
<span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> methodChannel: MethodChannel
methodChannel = MethodChannel(
    flutterEngine.dartExecutor.binaryMessenger,
    <span class="hljs-string">"com.bluetoothCharacteristic"</span>
)
</code></pre>
<h5 data-id="heading-30">ä½¿ç”¨</h5>
<pre><code class="hljs language-ini" lang="ini">Button(
    <span class="hljs-attr">onClick</span> = {
        val <span class="hljs-attr">intent</span> = FlutterActivity
            .withCachedEngine("my_engine_id")
            .build(activity)
        methodChannel.invokeMethod(
            "bluetoothCharacteristic",
            "00002a37-0000-1000-8000-00805f9b34fb"
        )<span class="hljs-comment">;</span>
        activity.startActivity(intent)
    },
    <span class="hljs-attr">modifier</span> = Modifier.padding(<span class="hljs-number">16</span>.dp)
) {
    Text("è·³è½¬åˆ°flutteré¡µé¢")
}
</code></pre>
<p>MethodChannel ä¸­çš„ <code>com.bluetoothCharacteristic</code> å’ŒmethodChannel.invokeMethodä¸­çš„<code>bluetoothCharacterstic</code>å¿…é¡»å’Œ Flutter ä¸­ä¿æŒä¸€è‡´ï¼Œå¦åˆ™æ¥æ”¶ä¸åˆ°æ•°æ®ã€‚</p>
<h4 data-id="heading-31">EventChannelæ–¹å¼</h4>
<p>EventChannelçš„ä½¿ç”¨æ–¹å¼å¤§è‡´å’ŒMethodChannelç›¸åŒï¼Œæˆ‘è¿™é‡Œå°±æŠŠä¸»è¦ä»£ç å¤åˆ¶ä¸‹æ¥äº†ã€‚</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">ComponentActivity</span>() {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> flutterEngine: FlutterEngine
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> eventChannel: EventChannel
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> eventDataSink: EventChannel.EventSink? = <span class="hljs-literal">null</span>
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        enableEdgeToEdge()
        <span class="hljs-comment">// åˆ›å»º FlutterEngine</span>
        flutterEngine = FlutterEngine(<span class="hljs-keyword">this</span>)
        <span class="hljs-comment">//è®¾ç½®åˆå§‹è·¯ç”±</span>
        flutterEngine.navigationChannel.setInitialRoute(<span class="hljs-string">"/settings"</span>)
        <span class="hljs-comment">// å¯åŠ¨ Flutter å¼•æ“</span>
        flutterEngine.dartExecutor.executeDartEntrypoint(
            DartExecutor.DartEntrypoint.createDefault()
        )
        <span class="hljs-comment">// è®¾ç½® EventChannel ç”¨äºå®æ—¶æ•°æ®ä¼ è¾“</span>
        eventChannel = EventChannel(flutterEngine.dartExecutor, <span class="hljs-string">"com.example.flutter_aar_demo/event_channel"</span>)
        eventChannel.setStreamHandler(<span class="hljs-keyword">object</span> : EventChannel.StreamHandler {
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onListen</span><span class="hljs-params">(arguments: <span class="hljs-type">Any</span>?, events: <span class="hljs-type">EventChannel</span>.<span class="hljs-type">EventSink</span>?)</span></span> {
                eventDataSink = events
                startRealTimeDataTransmission()
            }
            <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCancel</span><span class="hljs-params">(arguments: <span class="hljs-type">Any</span>?)</span></span> {
                eventDataSink = <span class="hljs-literal">null</span>
            }
        })
        <span class="hljs-comment">// ç¼“å­˜ FlutterEngine</span>
        FlutterEngineCache.getInstance().put(<span class="hljs-string">"my_engine_id"</span>, flutterEngine)
    }
</code></pre>
<hr/>
<p>æˆ‘è¿™é‡Œçš„å®‰å“ä½¿ç”¨çš„æ˜¯groovyçš„åˆ›å»ºæ–¹å¼Kotlin DSLçš„æ–¹å¼æ˜¯æˆ‘ç›´æ¥ä»å®˜ç½‘å¤åˆ¶çš„ä»£ç å¯èƒ½æœ‰ä¸æ­£ç¡®çš„åœ°æ–¹å…·ä½“è¯·æŸ¥çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.flutter.cn%2Fadd-to-app%2Fandroid%2Fproject-setup" target="_blank" title="https://docs.flutter.cn/add-to-app/android/project-setup" ref="nofollow noopener noreferrer">å°† Flutter module é›†æˆåˆ° Android é¡¹ç›®</a>ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[â€œå—æ§ç»„ä»¶â€çš„è¯…å’’ï¼šä¸ºä»€ä¹ˆä½ éœ€è¦ React Hook Form + Zod æ¥æ‹¯æ•‘ä½ çš„é”®ç›˜ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7582997593090506771</link>    <guid>https://juejin.cn/post/7582997593090506771</guid>    <pubDate>2025-12-14T09:46:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582997593090506771" data-draft-id="7581025279645843494" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="â€œå—æ§ç»„ä»¶â€çš„è¯…å’’ï¼šä¸ºä»€ä¹ˆä½ éœ€è¦ React Hook Form + Zod æ¥æ‹¯æ•‘ä½ çš„é”®ç›˜ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,React.js"/> <meta itemprop="datePublished" content="2025-12-14T09:46:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤§å¸ƒå¸ƒå°†å†›"/> <meta itemprop="url" content="https://juejin.cn/user/1535361573994189"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            â€œå—æ§ç»„ä»¶â€çš„è¯…å’’ï¼šä¸ºä»€ä¹ˆä½ éœ€è¦ React Hook Form + Zod æ¥æ‹¯æ•‘ä½ çš„é”®ç›˜ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1535361573994189/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤§å¸ƒå¸ƒå°†å†›
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:46:35.000Z" title="Sun Dec 14 2025 09:46:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€ï¼šä½ çš„æ‰‹æŒ‡ç´¯å—ï¼Ÿ</h2>
<p>ä¸Šä¸€ç¯‡å’±ä»¬èŠäº†æŠŠ Tabs çŠ¶æ€æ”¾è¿› URL é‡Œï¼Œè¿™å°±å¥½æ¯”ç»™äº†ä½ çš„åº”ç”¨ä¸€ä¸ªâ€œèº«ä»½è¯â€ï¼Œèµ°åˆ°å“ªéƒ½åœ¨ã€‚</p>
<p>ä½†åœ¨è¿™ä¸ª Tab ä¸‹é¢ï¼Œå¾€å¾€è—ç€å‰ç«¯å¼€å‘æœ€å¤§çš„å™©æ¢¦â€”â€”<strong>è¡¨å•</strong>ã€‚</p>
<p>ä½ æ˜¯ä¸æ˜¯è¿˜åœ¨è¿™ä¹ˆå†™ä»£ç ï¼Ÿ
ä¸€ä¸ªç®€å•çš„æ³¨å†Œé¡µï¼Œä½ å®šä¹‰äº† <code>username</code>, <code>password</code>, <code>email</code>, <code>confirmPassword</code> å››ä¸ª <code>useState</code>ã€‚
ç„¶åå†™äº†å››ä¸ª <code>handleXxxChange</code> å‡½æ•°ã€‚
æ¯æ¬¡ç”¨æˆ·æ•²ä¸€ä¸ªé”®ç›˜ï¼ŒReact å°±é‡æ–°æ¸²æŸ“ä¸€æ¬¡ç»„ä»¶ï¼ˆRe-renderï¼‰ã€‚
å¦‚æœè¡¨å•æœ‰ 50 é¡¹ï¼Œä½ åœ¨ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†æ‰“å­—ï¼Œæ•´ä¸ªé¡µé¢å¡å¾—åƒæ˜¯åœ¨æ”¾ PPTã€‚</p>
<p>è¿˜æœ‰é‚£ä¸ªè¯¥æ­»çš„æ ¡éªŒé€»è¾‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">if</span> (!email.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'@'</span>)) { ... }
<span class="hljs-keyword">if</span> (password.<span class="hljs-property">length</span> &lt; <span class="hljs-number">8</span>) { ... }
<span class="hljs-keyword">if</span> (password !== confirmPassword) { ... }
</code></pre>
<p>è¿™äº› <code>if-else</code> åƒé¢æ¡ä¸€æ ·ç¼ ç»•åœ¨ä½ çš„ç»„ä»¶é‡Œã€‚å†™åˆ°æœ€åï¼Œä½ éƒ½ä¸çŸ¥é“è‡ªå·±æ˜¯åœ¨å†™ UI è¿˜æ˜¯åœ¨å†™é€»è¾‘åˆ¤æ–­ã€‚</p>
<p>å…„å¼Ÿï¼Œæ”¾ä¸‹ä½ æ‰‹é‡Œçš„ <code>useState</code>ã€‚æ˜¯æ—¶å€™å¼•å…¥ <strong>React Hook Form</strong> å’Œ <strong>Zod</strong> è¿™å¯¹â€œé»„é‡‘æ­æ¡£â€äº†ã€‚</p>
<h2 data-id="heading-1">è§‚å¿µé‡å¡‘ï¼šå—æ§ vs éå—æ§</h2>
<p>React å®˜æ–¹æ–‡æ¡£æ—©æœŸæ•™æˆ‘ä»¬è¦ç”¨â€œå—æ§ç»„ä»¶â€ï¼ˆControlled Componentsï¼‰ï¼Œä¹Ÿå°±æ˜¯ <code>value</code> ç»‘å®š stateï¼Œ<code>onChange</code> æ›´æ–° stateã€‚</p>
<p>ä½†è¿™åœ¨å¤æ‚è¡¨å•åœºæ™¯ä¸‹ï¼Œç®€ç›´æ˜¯<strong>æ€§èƒ½æ€æ‰‹</strong>ã€‚</p>
<p><strong>React Hook Form (RHF)</strong> çš„æ ¸å¿ƒå“²å­¦æ˜¯å›å½’ HTML çš„æœ¬è´¨ï¼š<strong>éå—æ§ç»„ä»¶ï¼ˆUncontrolled Componentsï¼‰</strong> ã€‚ å®ƒåˆ©ç”¨ <code>ref</code> ç›´æ¥æ¥ç®¡åŸç”Ÿ DOM å…ƒç´ ã€‚</p>
<ul>
<li>ä½ æ‰“å­—æ—¶ï¼ŒReact <strong>ä¸</strong> æ¸²æŸ“ã€‚</li>
<li>åªæœ‰æ ¡éªŒæŠ¥é”™æˆ–æäº¤æ—¶ï¼ŒReact æ‰ä»‹å…¥ã€‚</li>
</ul>
<p>è¿™å°±å¥½æ¯”ï¼Œä»¥å‰ä½ æ˜¯å‚€å„¡å¸ˆï¼Œæ‰‹è¦æŠŠç€æ¯ä¸€ä¸ªæœ¨å¶çš„å…³èŠ‚åŠ¨ï¼ˆå—æ§ï¼‰ï¼›ç°åœ¨ä½ ç»™äº†æœ¨å¶ä¸€ä¸ªæŒ‡ä»¤â€œå¾€å‰èµ°â€ï¼ˆéå—æ§ï¼‰ï¼Œå®ƒè‡ªå·±å°±èµ°äº†ï¼Œä½ åªç®¡ç»ˆç‚¹ã€‚</p>
<h2 data-id="heading-2">å®æˆ˜æ¼”ç»ƒï¼šä» 50 è¡Œä»£ç ç¼©å‡åˆ° 10 è¡Œ</h2>
<p>å‡è®¾æˆ‘ä»¬è¦å†™ä¸€ä¸ªå¸¦æœ‰æ ¡éªŒçš„ç”¨æˆ·è¡¨å•ã€‚</p>
<h3 data-id="heading-3">âŒ ç—›è‹¦çš„ä¼ ç»Ÿå†™æ³•ï¼ˆuseStateï¼‰ï¼š</h3>
<pre><code class="hljs language-const" lang="const">  const [values, setValues] = useState({ name: '', age: 0 });
  const [errors, setErrors] = useState({});

  const handleChange = (e) =&gt; {
    // 1. æ›´æ–°çŠ¶æ€ï¼ˆè§¦å‘é‡æ¸²æŸ“ï¼‰
    setValues({ ...values, [e.target.name]: e.target.value });
    // 2. è¿˜è¦åœ¨è¿™é‡Œæ‰‹å†™æ ¡éªŒé€»è¾‘ï¼Œæˆ–è€…ç­‰æäº¤æ—¶æ ¡éªŒ
    // ...é€»è¾‘çœç•¥ï¼Œå·²ç»æƒ³åäº†
  };

  return (
    &lt;form&gt;
      &lt;input name="name" value={values.name} onChange={handleChange} /&gt;
      &lt;input name="age" value={values.age} onChange={handleChange} /&gt;
    &lt;/form&gt;
  );
};
</code></pre>
<h3 data-id="heading-4">âœ… çˆ½ç¿»å¤©çš„ RHF å†™æ³•ï¼š</h3>
<pre><code class="hljs language-import" lang="import">
const BetterForm = () =&gt; {
  // register: æ³¨å†Œå™¨ï¼Œç›¸å½“äº ref + onChange çš„è¯­æ³•ç³–
  // handleSubmit: å¸®ä½ å¤„ç† `e.preventDefault` å’Œæ•°æ®æ”¶é›†
  // formState: æ‰€æœ‰çš„é”™è¯¯çŠ¶æ€éƒ½åœ¨è¿™
  const { register, handleSubmit, formState: { errors } } = useForm();

  const onSubmit = (data) =&gt; console.log(data); // data ç›´æ¥å°±æ˜¯ {name:..., age:...}

  return (
    &lt;form onSubmit={handleSubmit(onSubmit)}&gt;
      {/* ä¹Ÿå°±æ˜¯ä¸€å¥è¯çš„äº‹ */}
      &lt;input {...register("name", { required: true })} /&gt;
      {errors.name &amp;&amp; &lt;span&gt;åå­—å¿…å¡«&lt;/span&gt;}
      
      &lt;input {...register("age")} /&gt;
      
      &lt;button type="submit"&gt;æäº¤&lt;/button&gt;
    &lt;/form&gt;
  );
};
</code></pre>
<p>çœ‹åˆ°æ²¡æœ‰ï¼Ÿæ²¡æœ‰ <code>useState</code>ï¼Œæ²¡æœ‰ <code>handleChange</code>ã€‚ <code>register</code> å‡½æ•°ç»™ä½ çš„ Input æ³¨å…¥äº†åŸæœ¬éœ€è¦æ‰‹å†™çš„ <code>name</code>, <code>onBlur</code>, <code>onChange</code>, <code>ref</code>ã€‚ä¸€åˆ‡éƒ½åœ¨é»‘ç›’é‡Œè‡ªåŠ¨å®Œæˆäº†ã€‚</p>
<h2 data-id="heading-5">çµé­‚ä¼´ä¾£ï¼šZod ç™»åœº</h2>
<p>RHF è§£å†³äº†æ•°æ®æ”¶é›†å’Œæ€§èƒ½é—®é¢˜ï¼Œä½†æ ¡éªŒè§„åˆ™å¦‚æœå†™åœ¨ JSX é‡Œï¼ˆæ¯”å¦‚ <code>{ required: true, minLength: 10 }</code>ï¼‰ï¼Œè¿˜æ˜¯å¾ˆä¹±ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œä½ éœ€è¦ <strong>Zod</strong>ã€‚ Zod æ˜¯ä¸€ä¸ª TypeScript ä¼˜å…ˆçš„ Schema å£°æ˜åº“ã€‚ç®€å•è¯´ï¼Œå°±æ˜¯<strong>æŠŠæ ¡éªŒé€»è¾‘ä» UI é‡ŒæŠ½ç¦»å‡ºæ¥ï¼Œå˜æˆä¸€ä»½â€œè¯´æ˜ä¹¦â€</strong> ã€‚</p>
<h3 data-id="heading-6">1. å®šä¹‰è¯´æ˜ä¹¦ (Schema)</h3>
<pre><code class="hljs language-import" lang="import">
const schema = z.object({
  username: z.string().min(2, "åå­—å¤ªçŸ­äº†ï¼Œå†é•¿ç‚¹"),
  email: z.string().email("è¿™æ ¹æœ¬ä¸æ˜¯é‚®ç®±"),
  age: z.number().min(18, "æœªæˆå¹´äººè¯·ç»•é“").max(100),
  // ç”šè‡³å¯ä»¥åšå¤æ‚çš„ä¾èµ–æ ¡éªŒ
  password: z.string().min(6),
  confirm: z.string()
}).refine((data) =&gt; data.password === data.confirm, {
  message: "ä¸¤æ¬¡å¯†ç ä¸å¯¹å•Šå…„å¼Ÿ",
  path: ["confirm"], // é”™è¯¯æ˜¾ç¤ºåœ¨ confirm å­—æ®µä¸‹
});
</code></pre>
<h3 data-id="heading-7">2. è¿æ¥ RHF å’Œ Zod</h3>
<p>æˆ‘ä»¬éœ€è¦ä¸€ä¸ªâ€œä¸­é—´äººâ€ï¼š<code>@hookform/resolvers</code>ã€‚</p>
<pre><code class="hljs language-import" lang="import">import { zodResolver } from '@hookform/resolvers/zod';

const BestForm = () =&gt; {
  const { 
    register, 
    handleSubmit, 
    formState: { errors, isDirty } // isDirty å¾ˆæœ‰ç”¨ï¼
  } = useForm({
    resolver: zodResolver(schema) // âœ¨ æ³¨å…¥çµé­‚
  });

  return (
    &lt;form onSubmit={handleSubmit(saveData)}&gt;
      &lt;input {...register("username")} /&gt;
      &lt;p className="text-red-500"&gt;{errors.username?.message}&lt;/p&gt;
      
      {/* ...å…¶ä»–å­—æ®µ... */}
      
      &lt;button type="submit"&gt;æäº¤&lt;/button&gt;
    &lt;/form&gt;
  );
};
</code></pre>
<p>ç°åœ¨ï¼Œä½ çš„ JSX æå…¶å¹²å‡€ã€‚æ‰€æœ‰çš„æ ¡éªŒé€»è¾‘éƒ½åœ¨ <code>schema</code> å¯¹è±¡é‡Œã€‚æƒ³æ”¹è§„åˆ™ï¼Ÿå»æ”¹ <code>schema</code> å°±è¡Œï¼Œä¸ç”¨åŠ¨ç»„ä»¶ã€‚</p>
<h2 data-id="heading-8">å›åº”å¼€å¤´ï¼šé˜²æ­¢â€œæ‰‹æ»‘å…³ç½‘é¡µâ€</h2>
<p>è¿˜è®°å¾—å‰è¨€é‡Œè¯´çš„é‚£ä¸ªæ‚²å‰§å—ï¼Ÿç”¨æˆ·å¡«äº†ä¸€åŠï¼Œæ‰‹æ»‘å…³äº† Tabã€‚</p>
<p>RHF æä¾›äº†ä¸€ä¸ªç¥å±æ€§ï¼š<code>isDirty</code>ï¼ˆè¡¨å•æ˜¯å¦è¢«å¼„è„äº†/æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼‰ã€‚</p>
<p>é…åˆ React Router çš„ <code>useBlocker</code> (v6.x) æˆ–è€…ä¼ ç»Ÿçš„ <code>window.onbeforeunload</code>ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾å®ç°<strong>æ‹¦æˆª</strong>ã€‚</p>
<pre><code class="hljs language-import" lang="import">
// ä¸€ä¸ªç®€å•çš„æ‹¦æˆª Hook
const usePreventLeave = (isDirty) =&gt; {
  useEffect(() =&gt; {
    const handleBeforeUnload = (e) =&gt; {
      if (isDirty) {
        e.preventDefault();
        // ç°ä»£æµè§ˆå™¨é€šå¸¸ä¸æ”¯æŒè‡ªå®šä¹‰æ–‡æœ¬ï¼Œä½†è¿™ä¼šè§¦å‘æµè§ˆå™¨çš„é»˜è®¤å¼¹çª—
        e.returnValue = ''; 
      }
    };
    
    window.addEventListener('beforeunload', handleBeforeUnload);
    return () =&gt; window.removeEventListener('beforeunload', handleBeforeUnload);
  }, [isDirty]);
};

// åœ¨ç»„ä»¶é‡Œä½¿ç”¨
const MyForm = () =&gt; {
  const { formState: { isDirty } } = useForm();
  
  // åªè¦ç”¨æˆ·æ”¹äº†ä¸€ä¸ªå­—ï¼ŒisDirty å°±å˜æˆ trueï¼Œé˜²å®ˆæ¨¡å¼å¼€å¯
  usePreventLeave(isDirty); 
  
  return &lt;form&gt;...&lt;/form&gt;;
}
</code></pre>
<p>ç°åœ¨ï¼Œåªè¦ç”¨æˆ·åŠ¨äº†è¡¨å•ï¼Œè¯•å›¾å…³é—­æˆ–åˆ·æ–°é¡µé¢æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šå¼¹å‡ºä¸€ä¸ªæ— æƒ…çš„è­¦å‘Šæ¡†ï¼šâ€œæ‚¨æœ‰æœªä¿å­˜çš„æ›´æ”¹ï¼Œç¡®å®šè¦ç¦»å¼€å—ï¼Ÿâ€ã€‚ PM å†ä¹Ÿä¸ç”¨æ‹…å¿ƒç”¨æˆ·æŠ•è¯‰æ•°æ®ä¸¢äº†ã€‚</p>
<hr/>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p><strong>React Hook Form + Zod</strong> æ˜¯ç°ä»£ React å¼€å‘çš„â€œå·¥ä¸šæ ‡å‡†â€ã€‚</p>
<ul>
<li><strong>RHF</strong> è´Ÿè´£ DOM äº¤äº’å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œè®©ä½ çš„é¡µé¢ä¸æ»‘é¡ºç•…ã€‚</li>
<li><strong>Zod</strong> è´Ÿè´£æ•°æ®ç»“æ„å’Œé€»è¾‘æ ¡éªŒï¼Œä¿è¯ä½ çš„æ•°æ®å¹²å‡€å¯é ã€‚</li>
<li><strong>TypeScript</strong> è‡ªåŠ¨æ¨å¯¼ç±»å‹ï¼Œè®©ä½ å†™ä»£ç æœ‰è‡ªåŠ¨è¡¥å…¨ã€‚</li>
</ul>
<p>å½“ä½ ç†Ÿç»ƒæŒæ¡è¿™ä¸€å¥—ç»„åˆæ‹³ï¼Œä½ ä¼šå‘ç°å†™è¡¨å•ä¸å†æ˜¯æŠ˜ç£¨ï¼Œç”šè‡³æœ‰ä¸€ç§è§£å‹çš„å¿«æ„Ÿã€‚</p>
<p>å¥½äº†ï¼Œæˆ‘è¦å»æŠŠé‚£ä¸ªåµŒå¥—äº† 10 å±‚ <code>if-else</code> æ ¡éªŒçš„å±å±±ç»™é‡æ„äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3662da28f40c48eeae6e5e162a3b563b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSn5biD5biD5bCG5Yab:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310395&amp;x-signature=LlziG%2FBDofYX4kiQrFmkAx29gss%3D" alt="438783fa67714fda959e8e52adb9245d.webp" loading="lazy"/></p>
<hr/>
<blockquote>
<p><strong>ä¸‹æœŸé¢„å‘Š</strong>ï¼šè¡¨å•æ•°æ®é‡å¦‚æœä¸æ­¢ 50 é¡¹ï¼Œè€Œæ˜¯ 10,000 é¡¹å‘¢ï¼Ÿ æ¯”å¦‚ä¸€ä¸ªè¶…é•¿çš„â€œç”¨æˆ·ç®¡ç†åˆ—è¡¨â€ï¼Œæˆ–è€…ä¸€ä¸ªå³æ—¶æ»šåŠ¨çš„â€œæ—¥å¿—ç›‘æ§å°â€ã€‚å¦‚æœä½ æŠŠè¿™ 10,000 ä¸ª <code>div</code> ç›´æ¥æ¸²æŸ“å‡ºæ¥ï¼Œæµè§ˆå™¨ä¼šç›´æ¥æ­»æœºã€‚ ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬æ¥èŠèŠ <strong>â€œè™šæ‹Ÿæ»šåŠ¨ (Virtual Scrolling) æŠ€æœ¯â€</strong> ã€‚æ•™ä½ å¦‚ä½•ç”¨ <code>react-window</code> æ¬ºéª—ç”¨æˆ·çš„çœ¼ç›ï¼Œè®©æ— é™åˆ—è¡¨åƒå¾·èŠ™ä¸€æ ·çºµäº«ä¸æ»‘ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¢ç´¢ Kotlin çš„ä¸å¯å˜é›†åˆåº“]]></title>    <link>https://juejin.cn/post/7583225356904972328</link>    <guid>https://juejin.cn/post/7583225356904972328</guid>    <pubDate>2025-12-14T09:41:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583225356904972328" data-draft-id="7583168260797268008" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¢ç´¢ Kotlin çš„ä¸å¯å˜é›†åˆåº“"/> <meta itemprop="keywords" content="Kotlin,Android Jetpack"/> <meta itemprop="datePublished" content="2025-12-14T09:41:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å–œç†Šçš„Btm"/> <meta itemprop="url" content="https://juejin.cn/user/2933927254689597"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¢ç´¢ Kotlin çš„ä¸å¯å˜é›†åˆåº“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2933927254689597/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å–œç†Šçš„Btm
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:41:57.000Z" title="Sun Dec 14 2025 09:41:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">æ¢ç´¢ Kotlin çš„ä¸å¯å˜é›†åˆåº“</h2>
<p>Kotlin çš„æ ‡å‡†é›†åˆï¼ˆList, Set, Mapï¼‰é»˜è®¤æ˜¯å¯å˜çš„ï¼Œè¿™å¯èƒ½å¯¼è‡´æœªé¢„æœŸçš„ä¿®æ”¹ã€‚ä¸ºäº†åœ¨ API å±‚å¼ºåˆ¶å®ç°ä¸å¯å˜æ€§ï¼ŒJetBrains å¼•å…¥äº† Kotlin ä¸å¯å˜é›†åˆåº“ ã€‚è¯¥åº“æä¾›äº†ä¸€ç»„çœŸæ­£ä¸å¯å˜çš„é›†åˆç±»å‹ï¼Œå¯ä»¥é˜²æ­¢æ„å¤–ä¿®æ”¹ï¼Œå¹¶å¢å¼ºåœ¨å¹¶å‘æˆ–å¤šçº¿ç¨‹ç¯å¢ƒä¸­çš„å®‰å…¨æ€§ã€‚</p>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆä½¿ç”¨ä¸å¯å˜é›†åˆï¼Ÿ</h3>
<p>è™½ç„¶ Kotlin å·²ç»æä¾›äº† listOf()ã€setOf() å’Œ mapOf() ç”¨äºåªè¯»é›†åˆï¼Œä½†å®ƒä»¬å¹¶éçœŸæ­£ä¸å¯å˜ ã€‚å¦‚æœè¿™äº›é›†åˆåœ¨å…¶ä»–åœ°æ–¹è¢«å¼•ç”¨ï¼Œå…¶åº•å±‚é›†åˆä»å¯èƒ½è¢«ä¿®æ”¹ã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> list = mutableListOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>)
<span class="hljs-keyword">val</span> readOnlyList: List&lt;String&gt; = list  
list.add(<span class="hljs-string">"D"</span>)  <span class="hljs-comment">// ä¿®æ”¹åŸå§‹åˆ—è¡¨  </span>
println(readOnlyList) <span class="hljs-comment">// è¾“å‡º: [A, B, C, D]  </span>

(readOnlyList <span class="hljs-keyword">as</span> MutableList).add(<span class="hljs-string">"E"</span>)
println(readOnlyList) <span class="hljs-comment">// è¾“å‡º: [A, B, C, D, E]</span>
</code></pre>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒImmutable Collections åº“ æä¾›äº†åœ¨è¿è¡Œæ—¶ä¿è¯ä¸å¯å˜æ€§çš„é›†åˆã€‚</p>
<h3 data-id="heading-2">å…³é”®ç‰¹æ€§</h3>
<ol>
<li>çœŸæ­£ä¸å¯å˜ â€”â€” ä¸€æ—¦åˆ›å»ºï¼Œå°±æ— æ³•è¢«ä¿®æ”¹ã€‚</li>
<li>å¤šçº¿ç¨‹å®‰å…¨ â€”â€” é¿å…åœ¨å¹¶å‘ç¯å¢ƒä¸­å‡ºç°æ„å¤–çš„ä¿®æ”¹ã€‚</li>
<li>æ€§èƒ½ä¼˜åŒ– â€”â€” é€šè¿‡ç»“æ„å…±äº«æ¥é˜²æ­¢ä¸å¿…è¦çš„å¤åˆ¶ã€‚</li>
</ol>
<h3 data-id="heading-3">å¦‚ä½•ä½¿ç”¨ Kotlin ä¸å¯å˜é›†åˆ</h3>
<h4 data-id="heading-4">1. æ·»åŠ ä¾èµ–é¡¹</h4>
<p>é¦–å…ˆï¼Œåœ¨ä½ çš„ build.gradle.kts ä¸­åŒ…å« Immutable Collections ä¾èµ–é¡¹ï¼š</p>
<pre><code class="hljs language-java" lang="java">dependencies {
    implementation(<span class="hljs-string">"org.jetbrains.kotlinx:kotlinx-collections-immutable:0.4.0"</span>)
}
</code></pre>
<h4 data-id="heading-5">2. åˆ›å»ºä¸å¯å˜é›†åˆ</h4>
<p>è¯¥åº“æä¾›äº† persistentListOf()ã€persistentSetOf() å’Œ persistentMapOf() æ¥åˆ›å»ºä¸å¯å˜é›†åˆï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> kotlinx.collections.immutable.*

<span class="hljs-keyword">val</span> immutableList = persistentListOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>)
<span class="hljs-keyword">val</span> immutableSet = persistentSetOf(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)
<span class="hljs-keyword">val</span> immutableMap = persistentMapOf(<span class="hljs-string">"key1"</span> to <span class="hljs-number">100</span>, <span class="hljs-string">"key2"</span> to <span class="hljs-number">200</span>)
</code></pre>
<h4 data-id="heading-6">3. æ·»åŠ å’Œç§»é™¤å…ƒç´ </h4>
<p>ç”±äºè¿™äº›é›†åˆæ˜¯ä¸å¯å˜çš„ï¼Œä¿®æ”¹æ“ä½œè¿”å› ä¸€ä¸ªæ–°çš„ä¿®æ”¹åçš„å‰¯æœ¬ ï¼Œè€Œä¸æ˜¯æ›´æ”¹åŸå§‹é›†åˆï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> newList = immutableList.add(<span class="hljs-string">"D"</span>) <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªæ–°åˆ—è¡¨</span>
println(newList)  <span class="hljs-comment">// è¾“å‡º: [A, B, C, D]</span>

<span class="hljs-keyword">val</span> newMap = immutableMap.put(<span class="hljs-string">"key3"</span>, <span class="hljs-number">300</span>)
println(newMap)   <span class="hljs-comment">// è¾“å‡º: {key1=100, key2=200, key3=300}</span>
</code></pre>
<p>åŸå§‹çš„ immutableList å’Œ immutableMap ä¿æŒä¸å˜ï¼</p>
<h3 data-id="heading-7">æ€§èƒ½è€ƒè™‘</h3>
<p>ä¸æ™®é€šçš„ä¸å¯å˜é›†åˆï¼ˆä¿®æ”¹æ—¶éœ€è¦å®Œæ•´å¤åˆ¶ï¼‰ä¸åŒï¼Œ æŒä¹…é›†åˆä½¿ç”¨ç»“æ„å…±äº« ã€‚è¿™æ„å‘³ç€ä¿®æ”¹ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆï¼ŒåŒæ—¶å¤ç”¨åŸå§‹é›†åˆä¸­æœªæ”¹å˜çš„éƒ¨åˆ†ï¼Œä»è€Œæé«˜æ€§èƒ½å’Œå†…å­˜æ•ˆç‡ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‘ä¸€ä¸ªæŒä¹…åŒ–åˆ—è¡¨æ·»åŠ ä¸€ä¸ªå…ƒç´ ä¸ä¼šåˆ›å»ºå®Œæ•´çš„å‰¯æœ¬ï¼Œè€Œæ˜¯é‡ç”¨å¤§éƒ¨åˆ†ç°æœ‰ç»“æ„ï¼š</p>
<pre><code class="hljs language-code" lang="code">Original:  [A, B, C]  
New List:  [A, B, C, D] (ä»…"D"æ˜¯æ–°åˆ†é…çš„)  
</code></pre>
<p>è¿™ä½¿å¾—ä¸å¯å˜é›†åˆå³ä½¿åœ¨å¤„ç†å¤§å‹æ•°æ®é›†æ—¶ä¹Ÿéå¸¸é«˜æ•ˆã€‚</p>
<h3 data-id="heading-8">Compose ä¸­çš„ä¼˜åŠ¿</h3>
<p>ä¸å¯å˜é›†åˆåœ¨ Jetpack Compose ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬ä¼˜åŒ–äº† çŠ¶æ€ç®¡ç†å’Œé‡ç»„ ã€‚åœ¨ Compose åº”ç”¨ç¨‹åºä¸­ï¼Œå®ƒä»¬çš„é‡è¦æ€§ä½“ç°åœ¨ä»¥ä¸‹æ–¹é¢ï¼š</p>
<h4 data-id="heading-9">1. é¿å…ä¸å¿…è¦çš„é‡ç»„</h4>
<ul>
<li>Compose ä¼šè·Ÿè¸ªçŠ¶æ€å˜åŒ–ä»¥å†³å®šä½•æ—¶é‡ç»„ UI å…ƒç´ ã€‚</li>
<li>å¯å˜åˆ—è¡¨ã€é›†åˆæˆ–æ˜ å°„å¯èƒ½ä¼šè§¦å‘ ä¸å¿…è¦çš„é‡ç»„ ï¼Œå³ä½¿æ•°æ®å¹¶æœªå‘ç”Ÿå˜åŒ–ã€‚</li>
<li>ä¸å¯å˜é›†åˆç¡®ä¿çŠ¶æ€ä¿æŒ ç¨³å®š ï¼Œé˜²æ­¢ä¸å¿…è¦çš„é‡æ–°ç»„åˆã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Composable</span>
<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">MyListScreen</span><span class="hljs-params">(items: <span class="hljs-type">List</span>&lt;<span class="hljs-type">String</span>&gt;)</span></span> {
    LazyColumn {
        items(items) { item -&gt;
            Text(text = item)
        }
    }
}
</code></pre>
<p>å¦‚æœ items æ˜¯ä¸€ä¸ª å¯å˜åˆ—è¡¨ ï¼Œå³ä½¿é‡æ–°åˆ†é…ç›¸åŒçš„å€¼ ä¹Ÿä¼šè§¦å‘é‡ç»„ ã€‚ä½¿ç”¨ ä¸å¯å˜é›†åˆ å¦‚ PersistentList å¯ä»¥ç¡®ä¿ Compose èƒ½å¤Ÿè¯†åˆ«æ•°æ®æ˜¯å¦æœªå‘ç”Ÿå˜åŒ–ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">val</span> items = remember { persistentListOf(<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>) }
MyListScreen(items)
</code></pre>
<h4 data-id="heading-10">2. çŠ¶æ€ç¨³å®šæ€§ä»¥æé«˜æ€§èƒ½</h4>
<ul>
<li>Compose é€šè¿‡è·³è¿‡é‡ç»„æ¥ä¼˜åŒ–æ¸²æŸ“ï¼Œå½“çŠ¶æ€å¯¹è±¡æ˜¯ ç¨³å®šçš„ æ—¶ã€‚</li>
<li>ä¸å¯å˜é›†åˆä½¿ç”¨ç»“æ„å…±äº« ï¼Œè¿™æ„å‘³ç€ä¿®æ”¹åªä¼šå½±å“æ”¹å˜çš„éƒ¨åˆ†ï¼Œè€Œå…¶ä½™éƒ¨åˆ†åˆ™è¢«å¤ç”¨ã€‚</li>
<li>è¿™åœ¨å¤§å‹åˆ—è¡¨æˆ–å¤æ‚çš„ UI å±‚æ¬¡ç»“æ„ä¸­èƒ½å¸¦æ¥æ›´å¥½çš„æ€§èƒ½ã€‚</li>
</ul>
<h4 data-id="heading-11">3. å¯é¢„æµ‹çš„ UI è¡Œä¸º</h4>
<ul>
<li>ç”±äºä¸å¯å˜é›†åˆåœ¨åˆ›å»ºåä¸èƒ½è¢«ä¿®æ”¹ ï¼Œå®ƒä»¬å¯ä»¥é˜²æ­¢æ„å¤–çš„å˜å¼‚ï¼Œä»è€Œé¿å…å¯¼è‡´ä¸å¯é¢„æµ‹çš„ UI æ›´æ–°ã€‚</li>
<li>è¿™åœ¨çŠ¶æ€é©±åŠ¨æ¶æ„ï¼ˆMVIã€Redux ç­‰ï¼‰ ä¸­å°¤å…¶æœ‰ç”¨ï¼Œç¡®ä¿åªæœ‰åœ¨å¿…è¦æ—¶æ‰æ›´æ–° UIã€‚</li>
</ul>
<h4 data-id="heading-12">4. çº¿ç¨‹å®‰å…¨</h4>
<ul>
<li>åœ¨ä½¿ç”¨åç¨‹ï¼ˆFlowsã€LiveData ç­‰ï¼‰ çš„ Compose åº”ç”¨ä¸­ï¼Œä¸å¯å˜é›†åˆå¯ä»¥é˜²æ­¢å¤šä¸ªçº¿ç¨‹æ›´æ–°çŠ¶æ€æ—¶å‡ºç°ç«æ€æ¡ä»¶ã€‚</li>
<li>å®ƒä»¬ç¡®ä¿åœ¨ ViewModelsã€ä»“åº“å’Œ UI ç»„ä»¶ä¹‹é—´å®‰å…¨åœ°ä¼ é€’æ•°æ®ã€‚</li>
</ul>
<h3 data-id="heading-13">ä½•æ—¶ä½¿ç”¨ä¸å¯å˜é›†åˆï¼Ÿ</h3>
<ul>
<li>âœ… å‡½æ•°å¼ç¼–ç¨‹ â€“ é¼“åŠ±ä½¿ç”¨ä¸å¯å˜æ€§ä»¥å®ç°æ›´å®‰å…¨çš„æ•°æ®è½¬æ¢ã€‚</li>
<li>âœ… çº¿ç¨‹å®‰å…¨ â€“ é˜²æ­¢åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å‡ºç°æ„å¤–çš„ä¿®æ”¹ã€‚</li>
<li>âœ… é˜²æ­¢é”™è¯¯ â€“ å‡å°‘ç”±äºæ„å¤–ä¿®æ”¹è€Œå¯¼è‡´çš„ä¸å¯é¢„è§çš„å‰¯ä½œç”¨ã€‚</li>
<li>âœ… çŠ¶æ€ç®¡ç† â€“ æœ‰åŠ©äºä¼˜åŒ–é‡ç»„å¹¶æå‡ UI æ€§èƒ½ã€‚</li>
</ul>
<h3 data-id="heading-14">ç»“è®º</h3>
<p>Kotlin çš„ä¸å¯å˜é›†åˆåº“æä¾›äº† çœŸæ­£ä¸å¯å˜ ã€ é«˜æ•ˆ ä¸” å®‰å…¨ çš„é›†åˆï¼Œä½¿å®ƒä»¬æˆä¸ºå‡½æ•°å¼ç¼–ç¨‹ã€å¹¶å‘åº”ç”¨å’Œ Jetpack Compose å¼€å‘çš„ç†æƒ³é€‰æ‹©ã€‚é€šè¿‡ä½¿ç”¨ æŒä¹…åŒ–é›†åˆ ï¼Œä½ å¯ä»¥ç¼–å†™æ›´å®‰å…¨ä¸”å¯é¢„æµ‹çš„ Kotlin ä»£ç ã€‚</p>
<h4 data-id="heading-15">åŸæ–‡é“¾æ¥</h4>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcarrion.dev%2Fen%2Fposts%2Fimmutable-collections%2F" target="_blank" title="https://carrion.dev/en/posts/immutable-collections/" ref="nofollow noopener noreferrer">æ¢ç´¢ Kotlin çš„ä¸å¯å˜é›†åˆåº“</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AIå·¥å…·é€‰æ‹©å›°éš¾ç—‡ï¼ŸSpring AIå¸®ä½ çœæ‰64%çš„ä»¤ç‰Œè´¹ç”¨]]></title>    <link>https://juejin.cn/post/7583225356904988712</link>    <guid>https://juejin.cn/post/7583225356904988712</guid>    <pubDate>2025-12-14T09:53:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583225356904988712" data-draft-id="7583023456306249780" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AIå·¥å…·é€‰æ‹©å›°éš¾ç—‡ï¼ŸSpring AIå¸®ä½ çœæ‰64%çš„ä»¤ç‰Œè´¹ç”¨"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2025-12-14T09:53:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="martinzh"/> <meta itemprop="url" content="https://juejin.cn/user/2524134426030232"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AIå·¥å…·é€‰æ‹©å›°éš¾ç—‡ï¼ŸSpring AIå¸®ä½ çœæ‰64%çš„ä»¤ç‰Œè´¹ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524134426030232/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    martinzh
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T09:53:05.000Z" title="Sun Dec 14 2025 09:53:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä½ çš„AIåŠ©æ‰‹æ˜¯ä¸ª"å·¥å…·å›¤ç§¯ç‹‚"å—ï¼Ÿ</h2>
<p>æƒ³è±¡ä¸€ä¸‹è¿™ä¸ªåœºæ™¯ï¼šä½ è®©AIåŠ©æ‰‹å¸®ä½ æŸ¥ä¸ªå¤©æ°”ï¼Œç»“æœå®ƒå¸¦ç€50ä¸ªå·¥å…·ç®±å‡ºé—¨äº†â€”â€”æœ‰ä¿®ç”µè„‘çš„ã€åšé¥­çš„ã€ä¿®è½¦çš„ã€ç”šè‡³è¿˜æœ‰åšæ ¸é…¸çš„å·¥å…·ï¼è¿™å°±åƒä½ åªæƒ³æ‹§ä¸ªèºä¸ï¼Œå´èƒŒç€æ•´ä¸ªäº”é‡‘åº—å‡ºé—¨ä¸€æ ·è’è°¬ã€‚</p>
<p>æ›´è¦å‘½çš„æ˜¯ï¼Œæ¯æ¬¡å®ƒå‡ºé—¨å‰éƒ½è¦æŠŠæ‰€æœ‰å·¥å…·çš„è¯´æ˜ä¹¦è¯»ä¸€éï¼Œå…‰æ˜¯ç¿»è¯´æ˜ä¹¦å°±èŠ±äº†ä½ 55000ä¸ªä»¤ç‰Œçš„è´¹ç”¨ã€‚è€Œä½ åªæ˜¯æƒ³çŸ¥é“æ˜å¤©è¦ä¸è¦å¸¦ä¼å•Šï¼</p>
<p>è¿™å°±æ˜¯ç°åœ¨AIå·¥å…·è°ƒç”¨çš„çœŸå®å†™ç…§ã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥èŠèŠSpring AIæ˜¯å¦‚ä½•æ²»å¥½AIçš„"å·¥å…·é€‰æ‹©å›°éš¾ç—‡"çš„ã€‚</p>
<h2 data-id="heading-1">å½“å‰AIå·¥å…·è°ƒç”¨çš„"ç¾éš¾ç°åœº"</h2>
<p>è®©æˆ‘ä»¬å…ˆçœ‹çœ‹ä¼ ç»Ÿçš„AIå·¥å…·è°ƒç”¨æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3eeaac9e066b47cf88a155ac385f342f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbWFydGluemg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310785&amp;x-signature=cRT6J4dkvq2I2JHjbc5pC0GM6Ik%3D" alt="å›¾1ï¼šä¼ ç»Ÿå·¥å…·è°ƒç”¨çš„&quot;å¸¦ç€å¤§ç‚®æ‰“èšŠå­&quot;ç°åœº" loading="lazy"/></p>
<p>å›¾1ï¼šä¼ ç»Ÿå·¥å…·è°ƒç”¨çš„"å¸¦ç€å¤§ç‚®æ‰“èšŠå­"ç°åœº</p>
<h3 data-id="heading-2">é—®é¢˜ä¸€ï¼šä¸Šä¸‹æ–‡è†¨èƒ€ç—‡</h3>
<p>å°±åƒæœ‰ä¸ªåŒäº‹å¼€ä¼šå‰è¦æŠŠæ‰€æœ‰å¯èƒ½ç”¨åˆ°çš„æ–‡ä»¶éƒ½æ‰“å°å‡ºæ¥ï¼Œå³ä½¿åªè®¨è®ºä¸€ä¸ªè®®é¢˜ã€‚AIä¹Ÿæ˜¯è¿™æ ·ï¼Œå®ƒè¦æŠŠæ‰€æœ‰å·¥å…·çš„å®šä¹‰éƒ½åŠ è½½åˆ°ä¸Šä¸‹æ–‡é‡Œï¼Œå“ªæ€•ä½ åªæ˜¯æƒ³æŸ¥ä¸ªå¤©æ°”ã€‚</p>
<h3 data-id="heading-3">é—®é¢˜äºŒï¼šé€‰æ‹©å›°éš¾ç—‡</h3>
<p>å½“AIé¢å¯¹30+ä¸ªåå­—ç›¸ä¼¼çš„å·¥å…·æ—¶ï¼Œå°±åƒä½ åœ¨è¶…å¸‚é¢å¯¹50ç§æ´—å‘æ°´ä¸€æ ·æ‡µé€¼ã€‚<code>getWeather()</code>ã€<code>getCurrentWeather()</code>ã€<code>fetchWeatherData()</code>...å¤©å“ªï¼Œå®ƒä»¬çœ‹èµ·æ¥éƒ½èƒ½æŸ¥å¤©æ°”ï¼</p>
<h3 data-id="heading-4">é—®é¢˜ä¸‰ï¼šé’±åŒ…å‡ºè¡€ç—‡</h3>
<p>æ¯æ¬¡è°ƒç”¨éƒ½ä¸ºç”¨ä¸åˆ°çš„å·¥å…·å®šä¹‰ä¹°å•ï¼Œå°±åƒç‚¹å¤–å–å¿…é¡»æŠŠæ•´ä¸ªèœå•éƒ½ä¹°ä¸‹æ¥ï¼Œå³ä½¿ä½ åªæƒ³è¦ä¸€ç¢—é¢ã€‚</p>
<h2 data-id="heading-5">Spring AIçš„"æŒ‰éœ€ç‚¹èœ"è§£å†³æ–¹æ¡ˆ</h2>
<p>Spring AIå¼•å…¥äº†ä¸€ä¸ªå«"å·¥å…·æœç´¢å·¥å…·"çš„èªæ˜åšæ³•ï¼Œå°±åƒç»™AIé…äº†ä¸ªæ™ºèƒ½ç®¡å®¶ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/02fbbf6070ad4c55b6ce47ece33344fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbWFydGluemg=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766310785&amp;x-signature=ihOIMxRceZmI4eAQAeYJrmE61qM%3D" alt="å›¾2ï¼šSpring AIçš„&quot;æŒ‰éœ€ç‚¹èœ&quot;å·¥å…·å‘ç°æµç¨‹" loading="lazy"/></p>
<p>å›¾2ï¼šSpring AIçš„"æŒ‰éœ€ç‚¹èœ"å·¥å…·å‘ç°æµç¨‹</p>
<p>è¿™ä¸ªè¿‡ç¨‹å°±åƒè¿™æ ·ï¼š</p>
<ol>
<li><strong>AI</strong>: "è€æ¿ï¼Œæˆ‘è¦æŸ¥å¤©æ°”çš„å·¥å…·"</li>
<li><strong>å·¥å…·æœç´¢å·¥å…·</strong>: "ç¨ç­‰ï¼Œæˆ‘ç»™æ‚¨æ‰¾æ‰¾...æ‰¾åˆ°äº†ï¼Œè¿™ä¸ª<code>weather</code>å·¥å…·åº”è¯¥åˆæ‚¨æ„"</li>
<li><strong>AI</strong>: "å®Œç¾ï¼å°±ç”¨å®ƒäº†"</li>
</ol>
<p>è€Œä¸æ˜¯ä¼ ç»Ÿçš„ï¼š</p>
<ol>
<li><strong>AI</strong>: "è€æ¿ï¼Œè¿™é‡Œæœ‰ä¿®ç”µè„‘ã€åšé¥­ã€ä¿®è½¦ã€æŸ¥å¤©æ°”ã€åšæ ¸é…¸...50ä¸ªå·¥å…·ï¼Œæˆ‘è¯¥ç”¨å“ªä¸ªï¼Ÿ"</li>
<li><strong>å¤§è„‘</strong>: "å´©æºƒ..."</li>
</ol>
<h2 data-id="heading-6">çœŸå®åœºæ™¯ï¼šä¸Šæµ·ç©¿æ­åŠ©æ‰‹</h2>
<p>è®©æˆ‘ä»¬çœ‹ä¸ªå…·ä½“ä¾‹å­ã€‚å‡è®¾ä½ è¦å¼€å‘ä¸€ä¸ªAIç©¿æ­åŠ©æ‰‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">StyleAdvisorApp</span>Â {
Â Â Â Â 
Â Â Â Â <span class="hljs-meta">@Bean</span>
Â Â Â Â <span class="hljs-title class_">CommandLineRunner</span>Â <span class="hljs-title function_">demo</span>(<span class="hljs-params">ChatClient.BuilderÂ builder,Â ToolSearcherÂ toolSearcher</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â argsÂ -&gt;Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â è¿™é‡Œæ³¨å†Œäº†100å¤šä¸ªå·¥å…·ï¼Œä½†AIä¸€å¼€å§‹çœ‹ä¸åˆ°ï¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">var</span>Â advisorÂ =Â <span class="hljs-title class_">ToolSearchToolCallAdvisor</span>.<span class="hljs-title function_">builder</span>()
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">toolSearcher</span>(toolSearcher)
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">build</span>();

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">ChatClient</span>Â chatClientÂ =Â builder
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">defaultTools</span>(<span class="hljs-keyword">new</span>Â <span class="hljs-title class_">StyleTools</span>())Â <span class="hljs-comment">//Â å·å·æ³¨å†Œ100+å·¥å…·</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">defaultAdvisors</span>(advisor)Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å¯åŠ¨"æ™ºèƒ½ç®¡å®¶"æ¨¡å¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .<span class="hljs-title function_">build</span>();

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">var</span>Â answerÂ =Â chatClient.<span class="hljs-title function_">prompt</span>(<span class="hljs-string">""</span><span class="hljs-string">"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â å¸®æˆ‘è§„åˆ’ä»Šå¤©åœ¨ä¸Šæµ·çš„ç©¿æ­å»ºè®®ï¼Œ
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â é¡ºä¾¿æ¨èå‡ å®¶ç°åœ¨è¿˜å¼€é—¨çš„æœè£…åº—ã€‚
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "</span><span class="hljs-string">""</span>).<span class="hljs-title function_">call</span>().<span class="hljs-title function_">content</span>();
Â Â Â Â Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(answer);
Â Â Â Â Â Â Â Â };
Â Â Â Â }

Â Â Â Â <span class="hljs-keyword">static</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">StyleTools</span>Â {
Â Â Â Â Â Â Â Â <span class="hljs-meta">@Tool</span>(descriptionÂ =Â <span class="hljs-string">"è·å–æŒ‡å®šä½ç½®å’Œæ—¶é—´çš„å¤©æ°”"</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">String</span>Â <span class="hljs-title function_">weather</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â location,Â <span class="hljs-built_in">String</span>Â time</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å°±åƒé—®å¤©æ°”é¢„æŠ¥å‘˜</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"é˜³å…‰æ˜åªšï¼Œ15Â°Cï¼Œé€‚åˆè½»è–„å¤–å¥—"</span>;
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-meta">@Tool</span>(descriptionÂ =Â <span class="hljs-string">"è·å–æŒ‡å®šä½ç½®å’Œæ—¶é—´è¥ä¸šçš„æœè£…åº—"</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;Â <span class="hljs-title function_">clothingStores</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â location,Â <span class="hljs-built_in">String</span>Â time</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å°±åƒé—®æœ¬åœ°å‘å¯¼</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-title class_">Arrays</span>.<span class="hljs-title function_">asList</span>(<span class="hljs-string">"H&amp;M"</span>,Â <span class="hljs-string">"Zara"</span>,Â <span class="hljs-string">"Uniqlo"</span>);
Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â <span class="hljs-meta">@Tool</span>(descriptionÂ =Â <span class="hljs-string">"è·å–æŒ‡å®šä½ç½®çš„å½“å‰æ—¶é—´"</span>)
Â Â Â Â Â Â Â Â <span class="hljs-keyword">public</span>Â <span class="hljs-title class_">String</span>Â <span class="hljs-title function_">currentTime</span>(<span class="hljs-params"><span class="hljs-built_in">String</span>Â location</span>)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å°±åƒçœ‹æ‰‹è¡¨</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â <span class="hljs-string">"2025-12-08T11:30"</span>;
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â 
Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â ...è¿˜æœ‰å…¶ä»–97ä¸ªå·¥å…·</span>
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-7">AIçš„èªæ˜å·¥ä½œæµç¨‹</h3>
<ol>
<li><strong>ç”¨æˆ·</strong>: "å¸®æˆ‘è§„åˆ’ä¸Šæµ·ç©¿æ­"</li>
<li><strong>AI</strong>: "æˆ‘éœ€è¦æ—¶é—´å·¥å…·" â†’ å‘ç°å¹¶è·å–<code>currentTime</code></li>
<li><strong>AI</strong>: "çŸ¥é“æ—¶é—´äº†ï¼Œç°åœ¨éœ€è¦å¤©æ°”å·¥å…·" â†’ å‘ç°å¹¶è·å–<code>weather</code></li>
<li><strong>AI</strong>: "æœ‰äº†å¤©æ°”ï¼Œéœ€è¦æ‰¾æœè£…åº—" â†’ å‘ç°å¹¶è·å–<code>clothingStores</code></li>
<li><strong>AI</strong>: "å®Œç¾ï¼åŸºäº15Â°Cçš„é˜³å…‰å¤©æ°”ï¼Œæ¨èè½»è–„å¤–å¥—ï¼Œé™„è¿‘çš„H&amp;Mã€Zaraéƒ½åœ¨è¥ä¸š"</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹AIåª"çœ‹åˆ°"äº†3ä¸ªçœŸæ­£éœ€è¦çš„å·¥å…·ï¼Œè€Œä¸æ˜¯å…¨éƒ¨100ä¸ªï¼</p>
<h2 data-id="heading-8">æ€§èƒ½æ•°æ®ï¼šçœé’±æ•ˆæœæœ‰å¤šæƒŠäººï¼Ÿ</h2>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å®é™…æµ‹è¯•æ•°æ®ï¼ˆè™½ç„¶ä½œè€…å¾ˆè¯šå®åœ°è¯´è¿™æ˜¯åˆæ­¥æµ‹è¯•ï¼Œä½†æ•°æ®è¿˜æ˜¯å¾ˆæœ‰è¯´æœåŠ›çš„ï¼‰ï¼š</p>
<h3 data-id="heading-9">Luceneæœç´¢ç­–ç•¥ç»“æœ</h3>





























<table><thead><tr><th>AIæ¨¡å‹</th><th>ä¼ ç»Ÿæ–¹å¼ä»¤ç‰Œæ•°</th><th>Spring AIæ–¹å¼</th><th>èŠ‚çœæ¯”ä¾‹</th></tr></thead><tbody><tr><td>Gemini</td><td>5,375</td><td>2,165</td><td>60% ğŸ’°</td></tr><tr><td>OpenAI</td><td>7,175</td><td>4,706</td><td>34% ğŸ’°</td></tr><tr><td>Anthropic</td><td>17,342</td><td>6,273</td><td>64% ğŸ’°</td></tr></tbody></table>
<p>è¿™äº›æ•°å­—æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li><strong>Geminiç”¨æˆ·</strong>: åŸæ¥èŠ±100å—ï¼Œç°åœ¨åªèŠ±40å—ï¼Œçœäº†ä¸€é¡¿ç«é”…é’±</li>
<li><strong>OpenAIç”¨æˆ·</strong>: åŸæ¥èŠ±100å—ï¼Œç°åœ¨èŠ±66å—ï¼Œçœäº†ä¸€æ¯å¥¶èŒ¶é’±</li>
<li><strong>Anthropicç”¨æˆ·</strong>: åŸæ¥èŠ±100å—ï¼Œç°åœ¨åªèŠ±36å—ï¼Œè¿™ç®€ç›´æ˜¯åŠä»·ä¼˜æƒ åˆ¸å•Šï¼</li>
</ul>
<h3 data-id="heading-10">ä¸ºä»€ä¹ˆèƒ½çœè¿™ä¹ˆå¤šï¼Ÿ</h3>
<p>å°±åƒç‚¹å¤–å–ä¸€æ ·ï¼š</p>
<p><strong>ä¼ ç»Ÿæ–¹å¼</strong>:</p>
<ul>
<li>å¿…é¡»æŠŠæ•´ä¸ªèœå•éƒ½ä¹°ä¸‹æ¥ï¼ˆæ‰€æœ‰å·¥å…·å®šä¹‰ï¼‰</li>
<li>å³ä½¿ä½ åªè¦ä¸€ç¢—é¢</li>
</ul>
<p><strong>Spring AIæ–¹å¼</strong>:</p>
<ul>
<li>æœåŠ¡å‘˜é—®ä½ æƒ³è¦ä»€ä¹ˆï¼ˆå·¥å…·æœç´¢ï¼‰</li>
<li>åªä¸ºä½ ç‚¹çš„èœä»˜è´¹ï¼ˆæŒ‰éœ€åŠ è½½å·¥å…·ï¼‰</li>
</ul>
<h2 data-id="heading-11">ä¸‰ç§æœç´¢ç­–ç•¥ï¼šæ€»æœ‰ä¸€æ¬¾é€‚åˆä½ </h2>
<p>Spring AIæä¾›äº†ä¸‰ç§å·¥å…·æœç´¢ç­–ç•¥ï¼Œå°±åƒä¸‰ç§ä¸åŒçš„å›¾ä¹¦é¦†ç®¡ç†å‘˜ï¼š</p>
<h3 data-id="heading-12">1. è¯­ä¹‰æœç´¢ï¼ˆVectorToolSearcherï¼‰</h3>
<p>è¿™ä¸ªç®¡ç†å‘˜å¾ˆèªæ˜ï¼Œä½ è¯´"æˆ‘æƒ³è¦åšé¥­ç›¸å…³çš„"ï¼Œä»–ä¼šç»™ä½ æ‰¾åˆ°ç‚’èœã€çƒ˜ç„™ã€è°ƒæ–™ç­‰æ‰€æœ‰ç›¸å…³å·¥å…·ã€‚</p>
<p><strong>é€‚åˆåœºæ™¯</strong>: è‡ªç„¶è¯­è¨€æè¿°ï¼Œæ¨¡ç³ŠæŸ¥æ‰¾</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â ç”¨æˆ·è¯´ï¼šæˆ‘æƒ³å¤„ç†å›¾ç‰‡</span>
<span class="hljs-comment">//Â å®ƒä¼šæ‰¾åˆ°ï¼šresizeImage,Â cropImage,Â filterImageÂ ç­‰</span>
</code></pre>
<h3 data-id="heading-13">2. å…³é”®è¯æœç´¢ï¼ˆLuceneToolSearcherï¼‰</h3>
<p>è¿™ä¸ªç®¡ç†å‘˜æ¯”è¾ƒç›´æ¥ï¼Œä½ è¯´"weather"ï¼Œä»–å°±æ‰¾æ‰€æœ‰åŒ…å«"weather"çš„å·¥å…·ã€‚</p>
<p><strong>é€‚åˆåœºæ™¯</strong>: ç²¾ç¡®åŒ¹é…ï¼Œå·²çŸ¥å·¥å…·å</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â ç”¨æˆ·è¯´ï¼šweather</span>
<span class="hljs-comment">//Â å®ƒä¼šæ‰¾åˆ°ï¼šgetWeather,Â getCurrentWeather,Â fetchWeatherDataÂ ç­‰</span>
</code></pre>
<h3 data-id="heading-14">3. æ­£åˆ™è¡¨è¾¾å¼æœç´¢ï¼ˆRegexToolSearcherï¼‰</h3>
<p>è¿™ä¸ªç®¡ç†å‘˜æ˜¯ä¸ªæŠ€æœ¯å®…ï¼Œæ‡‚å„ç§æ¨¡å¼åŒ¹é…ã€‚</p>
<p><strong>é€‚åˆåœºæ™¯</strong>: å·¥å…·å‘½åæœ‰è§„å¾‹</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â æ¨¡å¼ï¼šget_*_data</span>
<span class="hljs-comment">//Â å®ƒä¼šæ‰¾åˆ°ï¼šget_weather_data,Â get_user_data,Â get_stock_dataÂ ç­‰</span>
</code></pre>
<h2 data-id="heading-15">ä»€ä¹ˆæ—¶å€™è¯¥ç”¨Spring AIçš„å·¥å…·æœç´¢ï¼Ÿ</h2>
<h3 data-id="heading-16">é€‚åˆä½¿ç”¨çš„æƒ…å†µï¼ˆæ¨èæŒ‡æ•°â­â­â­â­â­ï¼‰</h3>
<p>å°±åƒä»¥ä¸‹æƒ…å†µï¼Œä½ ç»å¯¹éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼š</p>
<ol>
<li>
<p><strong>å·¥å…·è¶…å¸‚ç—‡å€™ç¾¤</strong>: ç³»ç»Ÿé‡Œæœ‰20+ä¸ªå·¥å…·</p>
<ul>
<li>å°±åƒä½ çš„å·¥å…·ç®±é‡Œæœ‰20æŠŠä¸åŒçš„èºä¸åˆ€</li>
</ul>
</li>
<li>
<p><strong>ä»¤ç‰Œçƒ§é’±ç—‡</strong>: å·¥å…·å®šä¹‰è¶…è¿‡5000ä¸ªä»¤ç‰Œ</p>
<ul>
<li>å°±åƒæ¯æ¬¡å‡ºé—¨éƒ½è¦èƒŒç€ç™¾ç§‘å…¨ä¹¦</li>
</ul>
</li>
<li>
<p><strong>MCPå¤šæœåŠ¡å™¨ç¯å¢ƒ</strong>: è¿æ¥å¤šä¸ªMCPæœåŠ¡å™¨</p>
<ul>
<li>å°±åƒåŒæ—¶åœ¨æ·˜å®ã€äº¬ä¸œã€æ‹¼å¤šå¤šå¼€åº—</li>
</ul>
</li>
<li>
<p><strong>å·¥å…·é€‰æ‹©å›°éš¾ç—‡</strong>: AIè€æ˜¯é€‰é”™å·¥å…·</p>
<ul>
<li>å°±åƒè€æ˜¯æ‹¿èœåˆ€å»å‰Šé“…ç¬”</li>
</ul>
</li>
</ol>
<h3 data-id="heading-17">ä¸é€‚åˆä½¿ç”¨çš„æƒ…å†µï¼ˆä¼ ç»Ÿæ–¹å¼æ›´å¥½ï¼‰</h3>
<ol>
<li>
<p><strong>æç®€å·¥å…·åº“</strong>: å°‘äº20ä¸ªå·¥å…·</p>
<ul>
<li>å°±åƒä½ åªæœ‰ä¸€æŠŠç‘å£«å†›åˆ€ï¼Œç›´æ¥ç”¨å°±å¥½</li>
</ul>
</li>
<li>
<p><strong>é«˜é¢‘å…¨èƒ½å·¥å…·</strong>: æ¯æ¬¡å¯¹è¯éƒ½è¦ç”¨æ‰€æœ‰å·¥å…·</p>
<ul>
<li>å°±åƒå¨å¸ˆæ¯é“èœéƒ½è¦ç”¨éæ‰€æœ‰è°ƒæ–™</li>
</ul>
</li>
<li>
<p><strong>è¶…ç´§å‡‘å®šä¹‰</strong>: å·¥å…·å®šä¹‰éƒ½å¾ˆç®€çŸ­</p>
<ul>
<li>å°±åƒè¯´æ˜ä¹¦åªæœ‰ä¸€å¥è¯</li>
</ul>
</li>
</ol>
<h2 data-id="heading-18">å¿«é€Ÿä¸Šæ‰‹ï¼š5åˆ†é’Ÿæå®šé…ç½®</h2>
<p>æƒ³è¯•è¯•è¿™ä¸ªçœé’±ç¥å™¨ï¼Ÿæ¥ï¼Œ5åˆ†é’Ÿæå®šï¼š</p>
<h3 data-id="heading-19">1. æ·»åŠ ä¾èµ–ï¼ˆå°±åƒè£…æ’ä»¶ï¼‰</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springaicommunity<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>tool-search-tool<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>

<span class="hljs-comment">&lt;!--Â é€‰æ‹©ä¸€ä¸ªæœç´¢ç­–ç•¥ï¼Œæˆ‘æ¨èLuceneÂ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springaicommunity<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>tool-searcher-lucene<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
Â Â Â Â <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-20">2. é…ç½®å·¥å…·æœç´¢ï¼ˆå°±åƒé›‡ä¸ªç®¡å®¶ï¼‰</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">AIConfig</span>Â {
Â Â Â Â 
Â Â Â Â <span class="hljs-meta">@Bean</span>
Â Â Â Â <span class="hljs-keyword">public</span>Â ToolSearchToolCallAdvisorÂ toolSearchAdvisor(ToolSearcherÂ searcher)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">return</span>Â ToolSearchToolCallAdvisor.builder()
Â Â Â Â Â Â Â Â Â Â Â Â .toolSearcher(searcher)
Â Â Â Â Â Â Â Â Â Â Â Â .maxResults(<span class="hljs-number">5</span>)Â <span class="hljs-comment">//Â æœ€å¤šè¿”å›5ä¸ªå·¥å…·ï¼Œé˜²æ­¢é€‰æ‹©å›°éš¾ç—‡å¤å‘</span>
Â Â Â Â Â Â Â Â Â Â Â Â .build();
Â Â Â Â }
}
</code></pre>
<h3 data-id="heading-21">3. ä½¿ç”¨ï¼ˆå°±åƒå¹³å¸¸ä¸€æ ·èŠå¤©ï¼‰</h3>
<pre><code class="hljs language-ini" lang="ini">//Â AIä¼šè‡ªåŠ¨æŒ‰éœ€å‘ç°å·¥å…·ï¼Œä½ ä»€ä¹ˆéƒ½ä¸ç”¨ç®¡ï¼
varÂ <span class="hljs-attr">response</span>Â =Â chatClient.prompt(<span class="hljs-string">"å¸®æˆ‘æŸ¥æŸ¥æ˜å¤©åŒ—äº¬çš„å¤©æ°”"</span>).call().content()<span class="hljs-comment">;</span>
</code></pre>
<p>å°±è¿™ä¹ˆç®€å•ï¼AIä¼šè‡ªåŠ¨å˜èªæ˜ï¼Œè´¦å•ä¼šè‡ªåŠ¨å˜å°ã€‚</p>
<h2 data-id="heading-22">å®é™…åº”ç”¨ï¼šä¸ºä»€ä¹ˆJavaå¼€å‘è€…éœ€è¦å…³å¿ƒè¿™ä¸ªï¼Ÿ</h2>
<p>ä½ å¯èƒ½ä¼šé—®ï¼š"æˆ‘å°±æ˜¯ä¸ªJavaåç«¯å¼€å‘ï¼Œä¸ºä»€ä¹ˆè¦å…³å¿ƒAIçš„å·¥å…·è°ƒç”¨ï¼Ÿ"</p>
<h3 data-id="heading-23">ç°å®åœºæ™¯ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ</h3>
<p>å‡è®¾ä½ åœ¨å¼€å‘ä¸€ä¸ªç”µå•†çš„æ™ºèƒ½å®¢æœç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Service</span>
publicÂ classÂ CustomerServiceAIÂ {
Â Â Â Â 
Â Â Â Â <span class="hljs-comment">//Â ä½ çš„ç³»ç»Ÿéœ€è¦è¿™äº›èƒ½åŠ›</span>
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"æŸ¥è¯¢è®¢å•çŠ¶æ€"</span>)Â publicÂ OrderStatusÂ <span class="hljs-built_in">getOrderStatus</span>(StringÂ orderId)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"æŸ¥è¯¢ç‰©æµä¿¡æ¯"</span>)Â publicÂ ShippingInfoÂ <span class="hljs-built_in">getShippingInfo</span>(StringÂ trackingId)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"å¤„ç†é€€æ¬¾ç”³è¯·"</span>)Â publicÂ RefundResultÂ <span class="hljs-built_in">processRefund</span>(StringÂ orderId)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"æŸ¥è¯¢å•†å“ä¿¡æ¯"</span>)Â publicÂ ProductInfoÂ <span class="hljs-built_in">getProductInfo</span>(StringÂ productId)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯"</span>)Â publicÂ UserInfoÂ <span class="hljs-built_in">getUserInfo</span>(StringÂ userId)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"å‘é€é‚®ä»¶é€šçŸ¥"</span>)Â publicÂ voidÂ <span class="hljs-built_in">sendEmail</span>(StringÂ to,Â StringÂ subject)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"æŸ¥è¯¢åº“å­˜"</span>)Â publicÂ intÂ <span class="hljs-built_in">getInventory</span>(StringÂ productId)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"æŸ¥è¯¢ä¼˜æƒ åˆ¸"</span>)Â publicÂ List&lt;Coupon&gt;Â <span class="hljs-built_in">getCoupons</span>(StringÂ userId)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"è®¡ç®—è¿è´¹"</span>)Â publicÂ BigDecimalÂ <span class="hljs-built_in">calculateShipping</span>(StringÂ address)Â {...}
Â Â Â Â <span class="hljs-variable">@Tool</span>(<span class="hljs-string">"æŸ¥è¯¢å”®åæ”¿ç­–"</span>)Â publicÂ StringÂ <span class="hljs-built_in">getReturnPolicy</span>()Â {...}
Â Â Â Â <span class="hljs-comment">//Â ...Â è¿˜æœ‰40ä¸ªå·¥å…·</span>
}
</code></pre>
<p><strong>ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜</strong>:</p>
<ul>
<li>ç”¨æˆ·é—®ï¼š"æˆ‘çš„è®¢å•ä»€ä¹ˆæ—¶å€™åˆ°ï¼Ÿ"</li>
<li>AIæ¥æ”¶åˆ°50ä¸ªå·¥å…·å®šä¹‰ï¼ˆåŒ…æ‹¬å¾ˆå¤šä¸ç›¸å…³çš„ï¼‰</li>
<li>ä»¤ç‰Œè´¹ç”¨çˆ†ç‚¸ï¼Œå“åº”é€Ÿåº¦æ…¢</li>
</ul>
<p><strong>Spring AIå·¥å…·æœç´¢çš„ä¼˜åŠ¿</strong>:</p>
<ul>
<li>AIåªè·å–<code>getOrderStatus</code>å’Œ<code>getShippingInfo</code>ç›¸å…³å·¥å…·</li>
<li>ä»¤ç‰Œä½¿ç”¨é‡å‡å°‘60%</li>
<li>å“åº”æ›´å¿«ï¼Œç”¨æˆ·æ›´æ»¡æ„</li>
<li>è¿è¥æˆæœ¬å¤§å¹…ä¸‹é™</li>
</ul>
<h3 data-id="heading-24">ä¸ºä»€ä¹ˆJavaå¼€å‘è€…è¦å­¦è¿™ä¸ªï¼Ÿ</h3>
<ol>
<li><strong>æˆæœ¬æ§åˆ¶</strong>: åœ¨AIåº”ç”¨ä¸­ï¼Œä»¤ç‰Œå°±æ˜¯çœŸé‡‘ç™½é“¶</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>: æ›´å°‘çš„ä¸Šä¸‹æ–‡æ„å‘³ç€æ›´å¿«çš„å“åº”</li>
<li><strong>ç³»ç»Ÿæ‰©å±•æ€§</strong>: å¯ä»¥è½»æ¾æ·»åŠ æ›´å¤šå·¥å…·è€Œä¸å½±å“æ€§èƒ½</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>: æ›´å‡†ç¡®çš„å·¥å…·é€‰æ‹©æ„å‘³ç€æ›´å¥½çš„æœåŠ¡è´¨é‡</li>
</ol>
<h2 data-id="heading-25">æ³¨æ„äº‹é¡¹ï¼šä¸æ˜¯ä¸‡èƒ½è¯</h2>
<p>è™½ç„¶Spring AIçš„å·¥å…·æœç´¢å¾ˆæ£’ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<h3 data-id="heading-26">è€æ¨¡å‹å¯èƒ½"å­¦ä¸ä¼š"</h3>
<p>å°±åƒæ•™ä½ çˆ·çˆ·ç”¨æ™ºèƒ½æ‰‹æœºä¸€æ ·ï¼Œæœ‰äº›è€ç‰ˆæœ¬çš„AIæ¨¡å‹å¯èƒ½æä¸å®šè¿™å¥—æµç¨‹ã€‚è¿™æ—¶å€™ä½ å¯èƒ½éœ€è¦ï¼š</p>
<ul>
<li>æ·»åŠ æ›´è¯¦ç»†çš„æç¤ºä¿¡æ¯</li>
<li>æ¢ä¸ªæœç´¢ç­–ç•¥è¯•è¯•</li>
<li>æˆ–è€…é…åˆ"AIåˆ¤å®˜"æ¨¡å¼æ¥ç¡®ä¿æ•ˆæœ</li>
</ul>
<h3 data-id="heading-27">æ›´å¤šè¯·æ±‚ vs æ›´å°‘ä»¤ç‰Œ</h3>
<p>è¿™æ˜¯ä¸ªç»å…¸çš„æ—¶é—´æ¢ç©ºé—´çš„é—®é¢˜ï¼š</p>
<ul>
<li>ä¼ ç»Ÿæ–¹å¼ï¼š3-4æ¬¡è¯·æ±‚ï¼Œä½†æ¯æ¬¡éƒ½å¾ˆ"é‡"</li>
<li>å·¥å…·æœç´¢ï¼š4-5æ¬¡è¯·æ±‚ï¼Œä½†æ¯æ¬¡éƒ½å¾ˆ"è½»"</li>
</ul>
<p>å°±åƒå¿«é€’ä¸€æ ·ï¼Œä½ æ˜¯æ„¿æ„ä¸€æ¬¡æ¬ä¸ªå¤§ç®±å­ï¼Œè¿˜æ˜¯åˆ†å‡ æ¬¡æ¬å°åŒ…è£¹ï¼Ÿ</p>
<h2 data-id="heading-28">æœªæ¥å±•æœ›ï¼šè¿™åªæ˜¯å¼€å§‹</h2>
<p>Spring AIå›¢é˜Ÿæ­£åœ¨è€ƒè™‘æŠŠè¿™ä¸ªåŠŸèƒ½åŠ å…¥æ ¸å¿ƒæ¡†æ¶ï¼Œè¿™æ„å‘³ç€ï¼š</p>
<ol>
<li><strong>æ›´å¥½çš„é›†æˆ</strong>: ä¸éœ€è¦é¢å¤–ä¾èµ–</li>
<li><strong>æ›´å¤šç­–ç•¥</strong>: å¯èƒ½ä¼šæœ‰æ›´æ™ºèƒ½çš„æœç´¢ç®—æ³•</li>
<li><strong>æ›´å¼ºå…¼å®¹æ€§</strong>: æ”¯æŒæ›´å¤šAIæ¨¡å‹</li>
</ol>
<p>åŒæ—¶ï¼Œä»–ä»¬è¿˜åœ¨ç ”ç©¶ï¼š</p>
<ul>
<li><strong>é¢„é€‰å·¥å…·é¡¾é—®</strong>: åœ¨AIè°ƒç”¨å‰å°±é€‰å¥½å·¥å…·</li>
<li><strong>AIåˆ¤å®˜æ¨¡å¼</strong>: ç¡®ä¿é€‰æ‹©çš„å·¥å…·çœŸæ­£è§£å†³äº†é—®é¢˜</li>
</ul>
<h2 data-id="heading-29">æ€»ç»“ï¼šAIå·¥å…·ç®¡ç†çš„"æ–­èˆç¦»"å“²å­¦</h2>
<p>Spring AIçš„å·¥å…·æœç´¢æ¨¡å¼æœ¬è´¨ä¸Šå°±æ˜¯AIç‰ˆçš„"æ–­èˆç¦»"ï¼š</p>
<ul>
<li><strong>æ–­</strong>: æ–­æ‰ä¸å¿…è¦çš„å·¥å…·å®šä¹‰ä¼ è¾“</li>
<li><strong>èˆ</strong>: èˆå¼ƒ"å…¨å®¶æ¡¶"å¼çš„å·¥å…·åŠ è½½</li>
<li><strong>ç¦»</strong>: è¿œç¦»ä»¤ç‰Œæµªè´¹å’Œé€‰æ‹©å›°éš¾</li>
</ul>
<p>å®ƒå‘Šè¯‰æˆ‘ä»¬ä¸€ä¸ªé“ç†ï¼š<strong>æœ‰æ—¶å€™ï¼Œå°‘å³æ˜¯å¤š</strong>ã€‚</p>
<p>å½“ä½ çš„AIåŠ©æ‰‹ä¸å†æ˜¯ä¸ª"å·¥å…·å›¤ç§¯ç‹‚"ï¼Œè€Œæ˜¯ä¸ª"æŒ‰éœ€ä¸“å®¶"æ—¶ï¼Œä½ ä¼šå‘ç°ï¼š</p>
<ul>
<li>è´¦å•å˜å°äº†</li>
<li>å“åº”å˜å¿«äº†</li>
<li>å‡†ç¡®æ€§æé«˜äº†</li>
<li>å¼€å‘æ•ˆç‡upäº†</li>
</ul>
<p>æ‰€ä»¥ï¼Œå¦‚æœä½ æ­£åœ¨å¼€å‘AIåº”ç”¨ï¼Œç‰¹åˆ«æ˜¯éœ€è¦å¤§é‡å·¥å…·é›†æˆçš„åœºæ™¯ï¼Œä¸å¦¨è¯•è¯•Spring AIçš„å·¥å…·æœç´¢æ¨¡å¼ã€‚</p>
<p>è®©AIå­¦ä¼š"æ–­èˆç¦»"ï¼Œè®©ä½ çš„é’±åŒ…æ¾å£æ°”ï¼</p>
<hr/>
<p><em>æƒ³äº†è§£æ›´å¤šSpring AIçš„é»‘ç§‘æŠ€ï¼Ÿå…³æ³¨æˆ‘ä»¬çš„JavaæŠ€æœ¯åˆ†äº«ï¼Œæ¯å‘¨ä¸ºä½ å¸¦æ¥æœ€å®ç”¨çš„å¼€å‘æŠ€å·§ï¼</em></p>
<p>åŸæ–‡é“¾æ¥ï¼š <a href="https://link.juejin.cn?target=https%3A%2F%2Fjishuba.cn%2Farticle%2Fai%25e5%25b7%25a5%25e5%2585%25b7%25e9%2580%2589%25e6%258b%25a9%25e5%259b%25b0%25e9%259a%25be%25e7%2597%2587%25ef%25bc%259fspring-ai%25e5%25b8%25ae%25e4%25bd%25a0%25e7%259c%2581%25e6%258e%258964%25e7%259a%2584%25e4%25bb%25a4%25e7%2589%258c%25e8%25b4%25b9%25e7%2594%25a8%2F" target="_blank" title="https://jishuba.cn/article/ai%e5%b7%a5%e5%85%b7%e9%80%89%e6%8b%a9%e5%9b%b0%e9%9a%be%e7%97%87%ef%bc%9fspring-ai%e5%b8%ae%e4%bd%a0%e7%9c%81%e6%8e%8964%e7%9a%84%e4%bb%a4%e7%89%8c%e8%b4%b9%e7%94%a8/" ref="nofollow noopener noreferrer">jishuba.cn/article/ai%â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¹³é¢å‡ ä½•ï¼šå¦‚ä½•ç»˜åˆ¶ä¸€ä¸ªæ˜Ÿå½¢ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7583023456305643572</link>    <guid>https://juejin.cn/post/7583023456305643572</guid>    <pubDate>2025-12-14T07:34:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583023456305643572" data-draft-id="7582939860874870819" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¹³é¢å‡ ä½•ï¼šå¦‚ä½•ç»˜åˆ¶ä¸€ä¸ªæ˜Ÿå½¢ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-14T07:34:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯è¥¿ç“œå“¥"/> <meta itemprop="url" content="https://juejin.cn/user/2066737589133015"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¹³é¢å‡ ä½•ï¼šå¦‚ä½•ç»˜åˆ¶ä¸€ä¸ªæ˜Ÿå½¢ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2066737589133015/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯è¥¿ç“œå“¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T07:34:29.000Z" title="Sun Dec 14 2025 07:34:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å‰ç«¯è¥¿ç“œå“¥ã€‚</p>
<p>ä¹Ÿæ˜¯æœ‰ä¸€ä¸ªæœˆæ²¡å†™æ–‡ç« äº†ã€‚ä¸»è¦æ˜¯ AI å¤ªå¼ºäº†ï¼Œç®€å•çš„ä¸œè¥¿å·²ç»æ²¡æœ‰å†™çš„å¿…è¦çš„ï¼Œå¤æ‚çš„ä¸å¥½å†™ã€‚ä½†å¤šå°‘è¿˜æ˜¯è¦å†™ç‚¹ã€‚</p>
<p>ä»Šå¤©æˆ‘ä»¬æ¥ç»˜åˆ¶ Figma çš„æ˜Ÿå½¢ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b2efef9f6bc4b9287c566cf66556794~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6KW_55Oc5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766302469&amp;x-signature=cMet9MfOfp4sHLrM%2FnUho%2Bx%2FCW0%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ˜Ÿå½¢çš„ç»˜åˆ¶ï¼Œæ¯”è¾ƒç®€å•ï¼Œå…¶å®å°±æ˜¯æ±‚ä¸¤ä¸ªåŒå¿ƒåœ†çš„å†…æ¥æ­£å¤šè¾¹å½¢çš„ç‚¹ï¼Œå°†ä¸¤ç»„ç‚¹ä¸¤ä¸¤è¿æ¥å³å¯ã€‚</p>
<p>æ–¹æ³•çš„å‚æ•°æœ‰ï¼šwidthã€heightã€countã€innerScaleã€‚æ–¹æ³•ç­¾åä¸ºï¼š</p>
<pre><code class="hljs language-less" lang="less">(
Â  <span class="hljs-attribute">width</span>:Â number,
Â  <span class="hljs-attribute">height</span>:Â number,
Â  <span class="hljs-attribute">count</span>:Â number,
Â  <span class="hljs-attribute">innerScale</span>:Â number,
) =&gt; Point[];

</code></pre>
<p>é¦–å…ˆæ˜¯ <strong>å½’ä¸€</strong>ï¼Œæ±‚å‡ºå®½é«˜ä¸º 1 çš„çŸ©å½¢ä¸‹ï¼ˆå…¶å®ä¹Ÿæ˜¯åŠå¾„ä¸º 0.5 çš„åŸå‹ï¼‰çš„å†…æ¥å¤šè¾¹å½¢çš„ç‚¹é›†ã€‚</p>
<p>ä»æœ€é¡¶éƒ¨çš„ç‚¹å¼€å§‹ï¼Œä¸æ–­åœ°æ—‹è½¬ <code>360 / count</code> çš„è§’åº¦ï¼Œå¾—åˆ° count ä¸ªç‚¹ã€‚ä¸­å¿ƒç‚¹æ˜¯åæ ‡åŸç‚¹ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">constÂ <span class="hljs-attr">getInnerRegularPolygon</span> = (radius:Â number, count:Â number): Point[] =&gt; {
constÂ <span class="hljs-attr">p</span> = { x:Â <span class="hljs-number">0</span>, y: -radius }<span class="hljs-comment">;</span>
constÂ points: Point<span class="hljs-section">[]</span> = <span class="hljs-section">[p]</span><span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">dAngle</span> = (Math.PI *Â <span class="hljs-number">2</span>) / count<span class="hljs-comment">;</span>

forÂ (letÂ <span class="hljs-attr">i</span> =Â <span class="hljs-number">1</span><span class="hljs-comment">; i &lt; count; i++) {</span>
Â  Â  points.push(rotate(p, dAngle * i))<span class="hljs-comment">;</span>
Â  }

returnÂ points<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">rotate</span> =Â (p: Point, rad:Â number) =&gt;Â {
returnÂ {
Â  Â  x: p.x *Â Math.cos(rad) - p.y *Â Math.sin(rad),
Â  Â  y: p.x *Â Math.sin(rad) + p.y *Â Math.cos(rad),
Â  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

</code></pre>
<p>è¿™é‡Œæ˜¯åŸºäºç¬¬ä¸€ä¸ªç‚¹ï¼Œä¸æ–­åœ°åº”ç”¨ä¸€ä¸ªæ–°çš„æ—‹è½¬è§’åº¦ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æ–¹æ¡ˆæ˜¯åŸºäºä¸Šä¸€ä¸ªç‚¹ï¼ŒåšåŒæ ·çš„å¢é‡æ—‹è½¬çŸ©é˜µï¼Œä½†ä¸æ˜¯å¾ˆå»ºè®®ï¼Œè¿™æ˜¯ä¸€ç§ â€œç´¯åŠ â€ çš„ç­–ç•¥ï¼Œä¼šå¯¼è‡´è¯¯å·®çš„ç´¯åŠ ã€‚</p>
<p><strong>ä¸­é—´æ­¥éª¤è¶Šå¤šï¼Œè¯¯å·®å°±ç´¯åŠ çš„è¶Šå¤§</strong>ã€‚ç±»ä¼¼çš„æœ‰å¯¹å›¾å½¢çš„ç§»åŠ¨ï¼ŒåŸºäºèµ·ç‚¹çš„ä½ç§»ä¼šæ›´å¯é ï¼ŒåŸºäº mousemove çš„ä¸Šä¸€ä¸ªç‚¹ä½ç§»åˆ™ä¼šæœ‰å¾ˆå¤šé—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8c58e51f901447689df9a1f9ce3a216~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6KW_55Oc5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766302469&amp;x-signature=y4jkwHBAL1FOJgnEf6ixA%2BlXOwc%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥æ˜¯ç»˜åˆ¶æ›´å°å†…æ¥å¤šè¾¹å½¢ã€‚</p>
<p>åŠå¾„æ”¹ä¸º innerScale å°±å¥½äº†ã€‚innerScale ä»£è¡¨çš„å°åœ†æ˜¯ç›¸å¯¹å¤§åœ†çš„å¤§å°ã€‚</p>
<p>ä¸è¿‡èµ·ç‚¹çš„ä½ç½®éœ€è¦è°ƒæ•´ä¸‹ï¼Œè¦é¡ºæ—¶é’ˆæ—‹è½¬ <code>360 / count / 2</code> çš„è§’åº¦ï¼Œç„¶åå†åŸºäºè¿™ä¸ªç‚¹å»æ—‹è½¬ã€‚</p>
<p>å¦åˆ™ä½ å¯èƒ½å¾—åˆ°ä¸‹é¢è¿™æ ·ä¸€ä¸ªå¤šè¾¹å½¢ç¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4465032e773442a6b978d56a6f4fc3c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6KW_55Oc5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766302469&amp;x-signature=jwVey8WdA72QKJt89BUYoHKwbnU%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>æ‰€ä»¥éœ€è¦æ”¹é€ ä¸‹ getInnerRegularPolygonï¼Œæä¾›ä¸ªèµ·å§‹è§’åº¦ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">constÂ <span class="hljs-attr">getInnerRegularPolygon</span> = (
Â  radius:Â number,
Â  count:Â number,
Â  startAngle:Â <span class="hljs-attr">number</span>Â =Â <span class="hljs-number">0</span>,
): Point<span class="hljs-section">[]</span> =&gt; {
letÂ <span class="hljs-attr">p</span> = { x:Â <span class="hljs-number">0</span>, y: -radius }<span class="hljs-comment">;</span>
ifÂ (startAngle) {
Â  Â  <span class="hljs-attr">p</span> = rotate(p, startAngle)<span class="hljs-comment">;</span>
Â  }
constÂ points: Point<span class="hljs-section">[]</span> = <span class="hljs-section">[p]</span><span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">dAngle</span> = (Math.PI *Â <span class="hljs-number">2</span>) / count<span class="hljs-comment">;</span>

forÂ (letÂ <span class="hljs-attr">i</span> =Â <span class="hljs-number">1</span><span class="hljs-comment">; i &lt; count; i++) {</span>
Â  Â  points.push(rotate(p, dAngle * i))<span class="hljs-comment">;</span>
Â  }

returnÂ points<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

</code></pre>
<p>ç„¶åæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå¤§çš„æ­£å¤šè¾¹å½¢ï¼Œå’Œä¸€ä¸ªå°çš„æ­ªäº†ç‚¹çš„æ­£å¤šè¾¹å½¢ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e7d0daec0e048f5b561375cb041da5e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6KW_55Oc5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766302469&amp;x-signature=GffkI9ocFXCNt25MxrpBEQRul4o%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç‚¹æ˜¯å¯¹äº†ï¼Œå°±æ˜¯ç‚¹çš„é¡ºåºè¦è°ƒæ•´ä¸‹ã€‚æˆ‘ä»¬å¯¹å¤§å¤šè¾¹å½¢å’Œå°å¤šè¾¹å½¢çš„ä¸¤ç»„ç‚¹ï¼Œä¸¤ä¸¤é¡ºæ’ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">constÂ <span class="hljs-attr">outerPoints</span> = getInnerRegularPolygon(<span class="hljs-number">1</span>, count)<span class="hljs-comment">;</span>
constÂ <span class="hljs-attr">innerPoints</span> = getInnerRegularPolygon(
Â  innerScale,
Â  count,
Â Â Math.PI / count,
)<span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">points</span> = []<span class="hljs-comment">;</span>
forÂ (letÂ <span class="hljs-attr">i</span> =Â <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; count; i++) {</span>
Â  points.push(outerPoints<span class="hljs-section">[i]</span>)<span class="hljs-comment">;</span>
Â  points.push(innerPoints<span class="hljs-section">[i]</span>)<span class="hljs-comment">;</span>
}

</code></pre>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬ç»˜åˆ¶äº†ä¸€ä¸ª 2x2 åœ†çš„å†…æ¥æ˜Ÿå½¢ã€‚ï¼ˆåˆ°è¿™é‡Œæ‰å‘ç° 1x1 è¦ä¼ å…¥ 0.5 æˆ–è€…æ”¹å¤šè¾¹å½¢ç®—æ³•å®ç°æ‰è¡Œï¼Œæƒ³äº†ä¸‹ 2x2 ä¹Ÿé—®é¢˜ä¸å¤§ï¼‰</p>
<p>åé¢æˆ‘ä»¬ç»™è¿™äº›ç‚¹<strong>æ”¾å¤§å’Œä½ç§»</strong>å°±é½æ´»äº†ã€‚<code>scale(width/2, height/2) * translate(width/2, height/2)</code></p>
<pre><code class="hljs language-ini" lang="ini">forÂ (letÂ <span class="hljs-attr">i</span> =Â <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; points.length; i++) {</span>
Â  points<span class="hljs-section">[i]</span>.<span class="hljs-attr">x</span> = points[i].x * halfWidth + halfWidth<span class="hljs-comment">;</span>
Â  points<span class="hljs-section">[i]</span>.<span class="hljs-attr">y</span> = points[i].y * halfHeight + halfHeight<span class="hljs-comment">;</span>
}

returnÂ points<span class="hljs-comment">;</span>

</code></pre>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86d82c6ad6b3469cae9e25dce7ba617a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6KW_55Oc5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766302469&amp;x-signature=WAYV1x9bJ3f63s6HT6o2yoj7LLk%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<h2 data-id="heading-0">ä½“éªŒ</h2>
<p>çº¿ä¸Šä½“éªŒåœ°å€ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgeo-play-nv7v.vercel.app%2Fsrc%2Fpage%2Fstar%255C%255C%255C%255C_public%2Findex.html" target="_blank" title="https://geo-play-nv7v.vercel.app/src/page/star%5C%5C%5C%5C_public/index.html" ref="nofollow noopener noreferrer">geo-play-nv7v.vercel.app/src/page/stâ€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc246fb51cd84571b6d75374da7583cc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv6KW_55Oc5ZOl:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766302469&amp;x-signature=8RQKb6JcsRzalmav6XUcR0ayme4%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç‰¹æ®Šçš„ï¼ŒinnerScale æ˜¯ 1 çš„è¯ï¼Œå°±ä¼šè®© n è§’æ˜Ÿå½¢å˜æˆ 2n å¤šè¾¹å½¢ã€‚</p>
<p>å¦å¤–ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ<strong>åŒ…å›´ç›’å…¶å®æ˜¯ä¸€ä¸ªåœ†å½¢ï¼Œè€Œä¸æ˜¯çŸ©å½¢</strong>ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Figma çš„ <strong>æ˜Ÿå½¢å’Œå¤šè¾¹å½¢åœ¨çŸ©å½¢åŒ…å›´ç›’ä¸‹ä¼šæœ‰ç©ºéš™</strong> çš„åŸå› ã€‚å› ä¸ºåŒ…å›´ç›’å®ƒä¸æ˜¯åœ†å½¢çš„ã€‚</p>
<h2 data-id="heading-1">ä»£ç å®ç°</h2>
<pre><code class="hljs language-ini" lang="ini">interfaceÂ Point {
Â  x:Â number<span class="hljs-comment">;</span>
Â  y:Â number<span class="hljs-comment">;</span>
}

constÂ <span class="hljs-attr">getInnerRegularPolygon</span> = (
Â  radius:Â number,
Â  count:Â number,
Â  startAngle:Â <span class="hljs-attr">number</span>Â =Â <span class="hljs-number">0</span>,
): Point<span class="hljs-section">[]</span> =&gt; {
letÂ <span class="hljs-attr">p</span> = { x:Â <span class="hljs-number">0</span>, y: -radius }<span class="hljs-comment">;</span>
ifÂ (startAngle) {
Â  Â  <span class="hljs-attr">p</span> = rotate(p, startAngle)<span class="hljs-comment">;</span>
Â  }
constÂ points: Point<span class="hljs-section">[]</span> = <span class="hljs-section">[p]</span><span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">dAngle</span> = (Math.PI *Â <span class="hljs-number">2</span>) / count<span class="hljs-comment">;</span>

forÂ (letÂ <span class="hljs-attr">i</span> =Â <span class="hljs-number">1</span><span class="hljs-comment">; i &lt; count; i++) {</span>
Â  Â  points.push(rotate(p, dAngle * i))<span class="hljs-comment">;</span>
Â  }

returnÂ points<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">rotate</span> =Â (p: Point, rad:Â number) =&gt;Â {
returnÂ {
Â  Â  x: p.x *Â Math.cos(rad) - p.y *Â Math.sin(rad),
Â  Â  y: p.x *Â Math.sin(rad) + p.y *Â Math.cos(rad),
Â  }<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>

exportconstÂ <span class="hljs-attr">getStarPoints</span> = (
Â  width:Â number,
Â  height:Â number,
Â  count:Â number,
Â  innerScale:Â number,
): Point<span class="hljs-section">[]</span> =&gt; {
constÂ <span class="hljs-attr">outerPoints</span> = getInnerRegularPolygon(<span class="hljs-number">1</span>, count)<span class="hljs-comment">;</span>
constÂ <span class="hljs-attr">innerPoints</span> = getInnerRegularPolygon(
Â  Â  innerScale,
Â  Â  count,
Â  Â Â Math.PI / count,
Â  )<span class="hljs-comment">;</span>

constÂ <span class="hljs-attr">points</span> = []<span class="hljs-comment">;</span>
forÂ (letÂ <span class="hljs-attr">i</span> =Â <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; count; i++) {</span>
Â  Â  points.push(outerPoints<span class="hljs-section">[i]</span>)<span class="hljs-comment">;</span>
Â  Â  points.push(innerPoints<span class="hljs-section">[i]</span>)<span class="hljs-comment">;</span>
Â  }

constÂ <span class="hljs-attr">halfWidth</span> = width /Â <span class="hljs-number">2</span><span class="hljs-comment">;</span>
constÂ <span class="hljs-attr">halfHeight</span> = height /Â <span class="hljs-number">2</span><span class="hljs-comment">;</span>

// scale(width/2, height/2) * translate(width/2, height/2)
forÂ (letÂ <span class="hljs-attr">i</span> =Â <span class="hljs-number">0</span><span class="hljs-comment">; i &lt; points.length; i++) {</span>
Â  Â  points<span class="hljs-section">[i]</span>.<span class="hljs-attr">x</span> = points[i].x * halfWidth + halfWidth<span class="hljs-comment">;</span>
Â  Â  points<span class="hljs-section">[i]</span>.<span class="hljs-attr">y</span> = points[i].y * halfHeight + halfHeight<span class="hljs-comment">;</span>
Â  }

returnÂ points<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>


</code></pre>
<h2 data-id="heading-2">ç»“å°¾</h2>
<p>æ˜Ÿå½¢ï¼Œæœ¬è´¨æ˜¯ä¸¤ä¸ªå¤šè¾¹å½¢çš„ç‚¹çš„äº¤æ›¿è¿æ¥ã€‚</p>
<p>å‡ ä½•ç®—æ³•å¾ˆæœ‰è¶£å§ã€‚</p>
<p>æˆ‘æ˜¯å‰ç«¯è¥¿ç“œå“¥ï¼Œå…³æ³¨æˆ‘ï¼Œå­¦ä¹ æ›´å¤šå¹³é¢å‡ ä½•çŸ¥è¯†ã€‚</p>
<hr/>
<p>ç›¸å…³é˜…è¯»ï¼Œ</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzI0NTc2NTEyNA%3D%3D%26mid%3D2247487888%26idx%3D1%26sn%3D784c37807b3eb9b1ae5dc98831303bf8%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzI0NTc2NTEyNA==&amp;mid=2247487888&amp;idx=1&amp;sn=784c37807b3eb9b1ae5dc98831303bf8&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">å¹³é¢å‡ ä½•ï¼šæ±‚å†…æ¥æˆ–å¤–åˆ‡äºåœ†çš„æ­£å¤šè¾¹å½¢</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzI0NTc2NTEyNA%3D%3D%26mid%3D2247488043%26idx%3D1%26sn%3Dccc0eacea698caa718e492e8034c0f34%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzI0NTc2NTEyNA==&amp;mid=2247488043&amp;idx=1&amp;sn=ccc0eacea698caa718e492e8034c0f34&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer">å¹³é¢å‡ ä½•ï¼šåˆ¤æ–­ç‚¹æ˜¯å¦åœ¨å¤šè¾¹å½¢å†…ï¼ˆå°„çº¿æ³•ï¼‰</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 ç»„ä»¶æ‡’åŠ è½½æ·±åº¦è§£æï¼šä»åŸç†åˆ°æè‡´ä¼˜åŒ–çš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7583528177558306866</link>    <guid>https://juejin.cn/post/7583528177558306866</guid>    <pubDate>2025-12-14T07:50:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583528177558306866" data-draft-id="7583528177558290482" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 ç»„ä»¶æ‡’åŠ è½½æ·±åº¦è§£æï¼šä»åŸç†åˆ°æè‡´ä¼˜åŒ–çš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-14T07:50:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 ç»„ä»¶æ‡’åŠ è½½æ·±åº¦è§£æï¼šä»åŸç†åˆ°æè‡´ä¼˜åŒ–çš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T07:50:38.000Z" title="Sun Dec 14 2025 07:50:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>æ‘˜è¦</strong></h2>
<p>ç»„ä»¶æ‡’åŠ è½½æ˜¯ç°ä»£å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒæŠ€æœ¯ï¼ŒVue3 æä¾›äº†å¤šç§å¼ºå¤§çš„æ‡’åŠ è½½æ–¹æ¡ˆã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ Vue3 ä¸­ç»„ä»¶æ‡’åŠ è½½çš„å®ç°åŸç†ã€ä½¿ç”¨åœºæ™¯ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼Œé€šè¿‡è¯¦ç»†çš„ä»£ç ç¤ºä¾‹ã€æ‰§è¡Œæµç¨‹åˆ†æå’Œå®é™…é¡¹ç›®æ¡ˆä¾‹ï¼Œå¸®åŠ©ä½ å…¨é¢æŒæ¡ Vue3 ç»„ä»¶æ‡’åŠ è½½çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ã€‚</p>
<hr/>
<h2 data-id="heading-1"><strong>ä¸€ã€ ä»€ä¹ˆæ˜¯ç»„ä»¶æ‡’åŠ è½½ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong></h2>
<h3 data-id="heading-2"><strong>1.1 ä¼ ç»Ÿç»„ä»¶åŠ è½½çš„é—®é¢˜</strong></h3>
<p>åœ¨ä¼ ç»Ÿçš„ Vue åº”ç”¨ä¸­ï¼Œæ‰€æœ‰ç»„ä»¶é€šå¸¸è¢«æ‰“åŒ…åˆ°ä¸€ä¸ª JavaScript æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ä¼ ç»ŸåŒæ­¥å¯¼å…¥æ–¹å¼</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Home</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Home.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">About</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/About.vue'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Contact</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./components/Contact.vue'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>({
  <span class="hljs-attr">components</span>: {
    <span class="hljs-title class_">Home</span>,
    <span class="hljs-title class_">About</span>,
    <span class="hljs-title class_">Contact</span>
  }
})
</code></pre>
<p><strong>ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š</strong></p>
<ul>
<li><strong>é¦–å±åŠ è½½ç¼“æ…¢</strong>ï¼šç”¨æˆ·éœ€è¦ä¸‹è½½æ•´ä¸ªåº”ç”¨ä»£ç æ‰èƒ½çœ‹åˆ°é¦–å±å†…å®¹</li>
<li><strong>èµ„æºæµªè´¹</strong>ï¼šç”¨æˆ·å¯èƒ½æ°¸è¿œä¸ä¼šè®¿é—®æŸäº›é¡µé¢ï¼Œä½†ä¾ç„¶åŠ è½½äº†å¯¹åº”ç»„ä»¶</li>
<li><strong>ç”¨æˆ·ä½“éªŒå·®</strong>ï¼šç‰¹åˆ«æ˜¯å¯¹äºç§»åŠ¨ç«¯ç”¨æˆ·å’Œç½‘ç»œæ¡ä»¶è¾ƒå·®çš„åœºæ™¯</li>
<li><strong>ç¼“å­˜æ•ˆç‡ä½</strong>ï¼šæ•´ä¸ªåº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ï¼Œä»»ä½•æ”¹åŠ¨éƒ½ä¼šä½¿ç¼“å­˜å¤±æ•ˆ</li>
</ul>
<h3 data-id="heading-3"><strong>1.2 ç»„ä»¶æ‡’åŠ è½½çš„è§£å†³æ–¹æ¡ˆ</strong></h3>
<p>æ‡’åŠ è½½ï¼ˆLazy Loadingï¼‰ä¹Ÿç§°ä¸ºä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰ï¼Œå®ƒå…è®¸æˆ‘ä»¬å°†ä»£ç åˆ†å‰²æˆå¤šä¸ª chunkï¼Œåªåœ¨éœ€è¦æ—¶åŠ è½½ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‡’åŠ è½½æ–¹å¼</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">Home</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/Home.vue'</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title function_">About</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/About.vue'</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title function_">Contact</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-string">'./components/Contact.vue'</span>)
</code></pre>
<p><strong>æ‡’åŠ è½½çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>æ›´å¿«çš„é¦–å±åŠ è½½</strong>ï¼šåªåŠ è½½å½“å‰é¡µé¢éœ€è¦çš„ä»£ç </li>
<li><strong>æŒ‰éœ€åŠ è½½</strong>ï¼šæ ¹æ®ç”¨æˆ·æ“ä½œåŠ¨æ€åŠ è½½ç»„ä»¶</li>
<li><strong>æ›´å¥½çš„ç¼“å­˜</strong>ï¼šç‹¬ç«‹çš„ chunk å¯ä»¥ç‹¬ç«‹ç¼“å­˜</li>
<li><strong>ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ</strong>ï¼šå‡å°‘åˆå§‹åŠ è½½æ—¶é—´</li>
</ul>
<hr/>
<h2 data-id="heading-4"><strong>äºŒã€ Vue3 ç»„ä»¶æ‡’åŠ è½½æ ¸å¿ƒæ¦‚å¿µ</strong></h2>
<h3 data-id="heading-5"><strong>2.1 æ‡’åŠ è½½çš„å·¥ä½œåŸç†</strong></h3>
<p><strong>æµç¨‹å›¾ï¼šç»„ä»¶æ‡’åŠ è½½å®Œæ•´å·¥ä½œæµç¨‹</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[ç”¨æˆ·è®¿é—®åº”ç”¨] --&gt; B[åŠ è½½ä¸»åŒ… main.js]
    B --&gt; C[æ¸²æŸ“é¦–å±å†…å®¹]
    C --&gt; D{ç”¨æˆ·è§¦å‘æ‡’åŠ è½½?}
    
    D -- è·¯ç”±åˆ‡æ¢ --&gt; E[åŠ è½½å¯¹åº”è·¯ç”±ç»„ä»¶]
    D -- æ¡ä»¶æ¸²æŸ“ --&gt; F[åŠ è½½æ¡ä»¶ç»„ä»¶]
    D -- ç”¨æˆ·äº¤äº’ --&gt; G[åŠ è½½äº¤äº’ç»„ä»¶]
    
    E --&gt; H[æ˜¾ç¤ºåŠ è½½çŠ¶æ€]
    F --&gt; H
    G --&gt; H
    
    H --&gt; I[ç½‘ç»œè¯·æ±‚å¯¹åº”chunk]
    I --&gt; J{åŠ è½½æˆåŠŸ?}
    J -- æ˜¯ --&gt; K[æ¸²æŸ“æ‡’åŠ è½½ç»„ä»¶]
    J -- å¦ --&gt; L[æ˜¾ç¤ºé”™è¯¯çŠ¶æ€]
    
    K --&gt; M[ç»„ä»¶æ¿€æ´»ä½¿ç”¨]
    L --&gt; N[æä¾›é‡è¯•æœºåˆ¶]
</code></pre>
<h3 data-id="heading-6"><strong>2.2 æ‡’åŠ è½½çš„æ ¸å¿ƒæ¦‚å¿µ</strong></h3>
<ul>
<li><strong>ä»£ç åˆ†å‰²</strong>ï¼šå°†ä»£ç æ‹†åˆ†æˆå¤šä¸ªå°å—ï¼ˆchunksï¼‰</li>
<li><strong>åŠ¨æ€å¯¼å…¥</strong>ï¼šä½¿ç”¨ <code>import()</code> å‡½æ•°åœ¨è¿è¡Œæ—¶åŠ è½½æ¨¡å—</li>
<li><strong>ç»„ä»¶å·¥å‚</strong>ï¼šè¿”å› Promise çš„å‡½æ•°ï¼Œè§£æä¸ºç»„ä»¶å®šä¹‰</li>
<li><strong>åŠ è½½çŠ¶æ€</strong>ï¼šåœ¨ç»„ä»¶åŠ è½½æœŸé—´æ˜¾ç¤ºçš„å›é€€å†…å®¹</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šåŠ è½½å¤±è´¥æ—¶çš„é™çº§æ–¹æ¡ˆ</li>
</ul>
<hr/>
<h2 data-id="heading-7"><strong>ä¸‰ã€ Vue3 ç»„ä»¶æ‡’åŠ è½½åŸºç¡€å®ç°</strong></h2>
<h3 data-id="heading-8"><strong>3.1 ä½¿ç”¨ defineAsyncComponent å®ç°æ‡’åŠ è½½</strong></h3>
<p>Vue3 æä¾›äº† <code>defineAsyncComponent</code> å‡½æ•°æ¥åˆ›å»ºå¼‚æ­¥ç»„ä»¶ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="basic-lazy-demo"&gt;
    &lt;h2&gt;åŸºç¡€æ‡’åŠ è½½ç¤ºä¾‹&lt;/h2&gt;
    
    &lt;div class="controls"&gt;
      &lt;button @click="showLazyComponent = !showLazyComponent" class="btn-primary"&gt;
        {{ showLazyComponent ? 'éšè—' : 'æ˜¾ç¤º' }} æ‡’åŠ è½½ç»„ä»¶
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;div class="component-area"&gt;
      &lt;!-- åŒæ­¥åŠ è½½çš„ç»„ä»¶ --&gt;
      &lt;div v-if="!showLazyComponent" class="sync-component"&gt;
        &lt;h3&gt;åŒæ­¥åŠ è½½çš„ç»„ä»¶&lt;/h3&gt;
        &lt;p&gt;è¿™ä¸ªç»„ä»¶åœ¨ä¸»åŒ…ä¸­ï¼Œç«‹å³å¯ç”¨&lt;/p&gt;
      &lt;/div&gt;

      &lt;!-- æ‡’åŠ è½½çš„ç»„ä»¶ --&gt;
      &lt;Suspense v-else&gt;
        &lt;template #default&gt;
          &lt;LazyBasicComponent /&gt;
        &lt;/template&gt;
        &lt;template #fallback&gt;
          &lt;div class="loading-state"&gt;
            &lt;div class="spinner"&gt;&lt;/div&gt;
            &lt;p&gt;æ‡’åŠ è½½ç»„ä»¶åŠ è½½ä¸­...&lt;/p&gt;
          &lt;/div&gt;
        &lt;/template&gt;
      &lt;/Suspense&gt;
    &lt;/div&gt;

    &lt;div class="bundle-info"&gt;
      &lt;h3&gt;æ‰“åŒ…ä¿¡æ¯åˆ†æ&lt;/h3&gt;
      &lt;div class="info-grid"&gt;
        &lt;div class="info-item"&gt;
          &lt;span&gt;ä¸»åŒ…å¤§å°:&lt;/span&gt;
          &lt;strong&gt;~15KB&lt;/strong&gt;
        &lt;/div&gt;
        &lt;div class="info-item"&gt;
          &lt;span&gt;æ‡’åŠ è½½ç»„ä»¶å¤§å°:&lt;/span&gt;
          &lt;strong&gt;~8KB (å•ç‹¬chunk)&lt;/strong&gt;
        &lt;/div&gt;
        &lt;div class="info-item"&gt;
          &lt;span&gt;åŠ è½½æ–¹å¼:&lt;/span&gt;
          &lt;strong&gt;æŒ‰éœ€åŠ è½½&lt;/strong&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, defineAsyncComponent } from 'vue'

const showLazyComponent = ref(false)

// ä½¿ç”¨ defineAsyncComponent å®šä¹‰æ‡’åŠ è½½ç»„ä»¶
const LazyBasicComponent = defineAsyncComponent(() =&gt; 
  import('./components/LazyBasicComponent.vue')
)
&lt;/script&gt;

&lt;style scoped&gt;
.basic-lazy-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
  font-family: Arial, sans-serif;
}

.controls {
  margin: 20px 0;
  text-align: center;
}

.btn-primary {
  padding: 12px 24px;
  background: #42b883;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  transition: background 0.3s;
}

.btn-primary:hover {
  background: #369870;
}

.component-area {
  margin: 30px 0;
  min-height: 200px;
}

.sync-component {
  padding: 30px;
  background: #e3f2fd;
  border: 2px solid #2196f3;
  border-radius: 8px;
  text-align: center;
}

.sync-component h3 {
  margin: 0 0 15px 0;
  color: #1976d2;
}

.loading-state {
  padding: 40px;
  background: #fff3e0;
  border: 2px dashed #ff9800;
  border-radius: 8px;
  text-align: center;
  color: #e65100;
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #ff9800;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.bundle-info {
  margin-top: 30px;
  padding: 20px;
  background: #f5f5f5;
  border-radius: 8px;
}

.bundle-info h3 {
  margin: 0 0 15px 0;
  color: #333;
}

.info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
}

.info-item {
  display: flex;
  justify-content: space-between;
  padding: 12px;
  background: white;
  border-radius: 6px;
  border-left: 4px solid #42b883;
}

.info-item span {
  color: #666;
}

.info-item strong {
  color: #2c3e50;
}
&lt;/style&gt;
</code></pre>
<p><strong>LazyBasicComponent.vue</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="lazy-basic-component"&gt;
    &lt;h3&gt;ğŸš€ æ‡’åŠ è½½ç»„ä»¶å·²åŠ è½½!&lt;/h3&gt;
    &lt;div class="component-content"&gt;
      &lt;p&gt;è¿™ä¸ªç»„ä»¶æ˜¯é€šè¿‡æ‡’åŠ è½½æ–¹å¼åŠ¨æ€åŠ è½½çš„&lt;/p&gt;
      &lt;div class="features"&gt;
        &lt;div class="feature"&gt;
          &lt;span class="icon"&gt;ğŸ“¦&lt;/span&gt;
          &lt;span&gt;ç‹¬ç«‹ chunk&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class="feature"&gt;
          &lt;span class="icon"&gt;âš¡&lt;/span&gt;
          &lt;span&gt;æŒ‰éœ€åŠ è½½&lt;/span&gt;
        &lt;/div&gt;
        &lt;div class="feature"&gt;
          &lt;span class="icon"&gt;ğŸ¯&lt;/span&gt;
          &lt;span&gt;æ€§èƒ½ä¼˜åŒ–&lt;/span&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;p class="load-time"&gt;ç»„ä»¶åŠ è½½æ—¶é—´: {{ loadTime }}&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted } from 'vue'

const loadTime = ref('')

onMounted(() =&gt; {
  loadTime.value = new Date().toLocaleTimeString()
  console.log('LazyBasicComponent å·²æŒ‚è½½')
})
&lt;/script&gt;

&lt;style scoped&gt;
.lazy-basic-component {
  padding: 30px;
  background: #e8f5e8;
  border: 2px solid #4caf50;
  border-radius: 8px;
  text-align: center;
}

.lazy-basic-component h3 {
  margin: 0 0 20px 0;
  color: #2e7d32;
  font-size: 24px;
}

.component-content {
  max-width: 400px;
  margin: 0 auto;
}

.features {
  display: flex;
  justify-content: space-around;
  margin: 25px 0;
  padding: 20px;
  background: white;
  border-radius: 8px;
}

.feature {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.feature .icon {
  font-size: 24px;
}

.feature span:last-child {
  font-size: 14px;
  color: #666;
}

.load-time {
  margin: 20px 0 0 0;
  padding: 10px;
  background: #2c3e50;
  color: white;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-9"><strong>3.2 è·¯ç”±çº§åˆ«çš„æ‡’åŠ è½½</strong></h3>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè·¯ç”±çº§åˆ«çš„æ‡’åŠ è½½æ˜¯æœ€å¸¸è§çš„åº”ç”¨åœºæ™¯ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// router/index.js</span>
<span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>

<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/Home.vue'</span>)  <span class="hljs-comment">// æ‡’åŠ è½½é¦–é¡µ</span>
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/about'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'About'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/About.vue'</span>) <span class="hljs-comment">// æ‡’åŠ è½½å…³äºé¡µ</span>
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/products'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Products'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/Products.vue'</span>) <span class="hljs-comment">// æ‡’åŠ è½½äº§å“é¡µ</span>
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/contact'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Contact'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/Contact.vue'</span>) <span class="hljs-comment">// æ‡’åŠ è½½è”ç³»é¡µ</span>
  }
]

<span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({
  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(),
  routes
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router
</code></pre>
<p><strong>å¸¦åŠ è½½çŠ¶æ€çš„è·¯ç”±æ‡’åŠ è½½ï¼š</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="route-lazy-demo"&gt;
    &lt;h2&gt;è·¯ç”±çº§åˆ«æ‡’åŠ è½½ç¤ºä¾‹&lt;/h2&gt;
    
    &lt;nav class="nav-tabs"&gt;
      &lt;router-link 
        v-for="tab in tabs" 
        :key="tab.path"
        :to="tab.path"
        class="nav-tab"
        active-class="active"
      &gt;
        {{ tab.name }}
      &lt;/router-link&gt;
    &lt;/nav&gt;

    &lt;div class="route-content"&gt;
      &lt;RouterView v-slot="{ Component }"&gt;
        &lt;Suspense&gt;
          &lt;template #default&gt;
            &lt;component :is="Component" /&gt;
          &lt;/template&gt;
          &lt;template #fallback&gt;
            &lt;div class="route-loading"&gt;
              &lt;div class="loading-content"&gt;
                &lt;div class="spinner large"&gt;&lt;/div&gt;
                &lt;p&gt;é¡µé¢åŠ è½½ä¸­...&lt;/p&gt;
                &lt;div class="loading-dots"&gt;
                  &lt;span&gt;&lt;/span&gt;
                  &lt;span&gt;&lt;/span&gt;
                  &lt;span&gt;&lt;/span&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/template&gt;
        &lt;/Suspense&gt;
      &lt;/RouterView&gt;
    &lt;/div&gt;

    &lt;div class="route-info"&gt;
      &lt;h3&gt;è·¯ç”±æ‡’åŠ è½½ä¿¡æ¯&lt;/h3&gt;
      &lt;div class="chunk-status"&gt;
        &lt;div 
          v-for="chunk in chunkStatus" 
          :key="chunk.name"
          class="chunk-item"
          :class="chunk.status"
        &gt;
          &lt;span class="chunk-name"&gt;{{ chunk.name }}&lt;/span&gt;
          &lt;span class="chunk-status"&gt;{{ chunk.status }}&lt;/span&gt;
          &lt;span class="chunk-size"&gt;{{ chunk.size }}&lt;/span&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, watch } from 'vue'
import { useRoute } from 'vue-router'

const route = useRoute()

const tabs = [
  { path: '/', name: 'é¦–é¡µ' },
  { path: '/about', name: 'å…³äºæˆ‘ä»¬' },
  { path: '/products', name: 'äº§å“æœåŠ¡' },
  { path: '/contact', name: 'è”ç³»æˆ‘ä»¬' }
]

const chunkStatus = ref([
  { name: 'home', status: 'loaded', size: '15KB' },
  { name: 'about', status: 'pending', size: '12KB' },
  { name: 'products', status: 'pending', size: '25KB' },
  { name: 'contact', status: 'pending', size: '8KB' }
])

// ç›‘å¬è·¯ç”±å˜åŒ–ï¼Œæ¨¡æ‹Ÿ chunk åŠ è½½çŠ¶æ€
watch(() =&gt; route.name, (newRouteName) =&gt; {
  const chunkName = newRouteName.toLowerCase()
  chunkStatus.value.forEach(chunk =&gt; {
    if (chunk.name === chunkName) {
      chunk.status = 'loaded'
    }
  })
})
&lt;/script&gt;

&lt;style scoped&gt;
.route-lazy-demo {
  max-width: 1000px;
  margin: 0 auto;
  padding: 20px;
}

.nav-tabs {
  display: flex;
  background: #f8f9fa;
  border-radius: 8px;
  padding: 5px;
  margin: 20px 0;
}

.nav-tab {
  flex: 1;
  padding: 12px 20px;
  text-align: center;
  text-decoration: none;
  color: #666;
  border-radius: 6px;
  transition: all 0.3s;
}

.nav-tab:hover {
  background: #e9ecef;
  color: #333;
}

.nav-tab.active {
  background: #42b883;
  color: white;
}

.route-content {
  min-height: 400px;
  margin: 30px 0;
}

.route-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 300px;
  background: #f8f9fa;
  border-radius: 8px;
  border: 2px dashed #dee2e6;
}

.loading-content {
  text-align: center;
  color: #666;
}

.spinner.large {
  width: 60px;
  height: 60px;
  border: 6px solid #f3f3f3;
  border-top: 6px solid #42b883;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}

.loading-dots {
  display: flex;
  justify-content: center;
  gap: 4px;
  margin-top: 15px;
}

.loading-dots span {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #42b883;
  animation: bounce 1.4s infinite ease-in-out;
}

.loading-dots span:nth-child(1) { animation-delay: -0.32s; }
.loading-dots span:nth-child(2) { animation-delay: -0.16s; }

@keyframes bounce {
  0%, 80%, 100% {
    transform: scale(0);
  }
  40% {
    transform: scale(1);
  }
}

.route-info {
  margin-top: 30px;
  padding: 20px;
  background: #2c3e50;
  border-radius: 8px;
  color: white;
}

.route-info h3 {
  margin: 0 0 15px 0;
  color: #42b883;
}

.chunk-status {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.chunk-item {
  display: flex;
  justify-content: space-between;
  padding: 12px 15px;
  background: #34495e;
  border-radius: 6px;
  transition: all 0.3s;
}

.chunk-item.loaded {
  border-left: 4px solid #27ae60;
}

.chunk-item.pending {
  border-left: 4px solid #f39c12;
  opacity: 0.7;
}

.chunk-name {
  font-weight: bold;
  color: #ecf0f1;
}

.chunk-status {
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: bold;
  text-transform: uppercase;
}

.chunk-item.loaded .chunk-status {
  background: #27ae60;
  color: white;
}

.chunk-item.pending .chunk-status {
  background: #f39c12;
  color: white;
}

.chunk-size {
  color: #bdc3c7;
  font-family: 'Courier New', monospace;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-10"><strong>å››ã€ é«˜çº§æ‡’åŠ è½½é…ç½®ä¸ä¼˜åŒ–</strong></h2>
<h3 data-id="heading-11"><strong>4.1 å®Œæ•´çš„å¼‚æ­¥ç»„ä»¶é…ç½®</strong></h3>
<p>Vue3 çš„ <code>defineAsyncComponent</code> æ”¯æŒå®Œæ•´çš„é…ç½®é€‰é¡¹ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="advanced-lazy-demo"&gt;
    &lt;h2&gt;é«˜çº§æ‡’åŠ è½½é…ç½®&lt;/h2&gt;
    
    &lt;div class="controls"&gt;
      &lt;button @click="loadComponent('success')" class="btn-success"&gt;
        åŠ è½½æˆåŠŸç»„ä»¶
      &lt;/button&gt;
      &lt;button @click="loadComponent('error')" class="btn-error"&gt;
        åŠ è½½é”™è¯¯ç»„ä»¶
      &lt;/button&gt;
      &lt;button @click="loadComponent('timeout')" class="btn-warning"&gt;
        åŠ è½½è¶…æ—¶ç»„ä»¶
      &lt;/button&gt;
      &lt;button @click="loadComponent('delay')" class="btn-info"&gt;
        åŠ è½½å»¶è¿Ÿç»„ä»¶
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;div class="component-area"&gt;
      &lt;AdvancedAsyncComponent 
        v-if="currentComponent"
        :key="componentKey"
      /&gt;
    &lt;/div&gt;

    &lt;div class="config-info"&gt;
      &lt;h3&gt;å¼‚æ­¥ç»„ä»¶é…ç½®è¯´æ˜&lt;/h3&gt;
      &lt;div class="config-grid"&gt;
        &lt;div class="config-item"&gt;
          &lt;h4&gt;loader&lt;/h4&gt;
          &lt;p&gt;ç»„ä»¶åŠ è½½å‡½æ•°ï¼Œè¿”å› Promise&lt;/p&gt;
        &lt;/div&gt;
        &lt;div class="config-item"&gt;
          &lt;h4&gt;loadingComponent&lt;/h4&gt;
          &lt;p&gt;åŠ è½½è¿‡ç¨‹ä¸­æ˜¾ç¤ºçš„ç»„ä»¶&lt;/p&gt;
        &lt;/div&gt;
        &lt;div class="config-item"&gt;
          &lt;h4&gt;errorComponent&lt;/h4&gt;
          &lt;p&gt;åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºçš„ç»„ä»¶&lt;/p&gt;
        &lt;/div&gt;
        &lt;div class="config-item"&gt;
          &lt;h4&gt;delay&lt;/h4&gt;
          &lt;p&gt;å»¶è¿Ÿæ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼ˆé¿å…é—ªçƒï¼‰&lt;/p&gt;
        &lt;/div&gt;
        &lt;div class="config-item"&gt;
          &lt;h4&gt;timeout&lt;/h4&gt;
          &lt;p&gt;åŠ è½½è¶…æ—¶æ—¶é—´&lt;/p&gt;
        &lt;/div&gt;
        &lt;div class="config-item"&gt;
          &lt;h4&gt;onError&lt;/h4&gt;
          &lt;p&gt;é”™è¯¯å¤„ç†å›è°ƒå‡½æ•°&lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, defineAsyncComponent } from 'vue'
import LoadingSpinner from './components/LoadingSpinner.vue'
import ErrorDisplay from './components/ErrorDisplay.vue'

const currentComponent = ref(null)
const componentKey = ref(0)

// æ¨¡æ‹Ÿä¸åŒåŠ è½½åœºæ™¯çš„ç»„ä»¶
const componentConfigs = {
  success: () =&gt; import('./components/SuccessComponent.vue'),
  error: () =&gt; Promise.reject(new Error('æ¨¡æ‹ŸåŠ è½½é”™è¯¯')),
  timeout: () =&gt; new Promise(() =&gt; {}), // æ°¸è¿œä¸ä¼š resolve
  delay: () =&gt; new Promise(resolve =&gt; {
    setTimeout(() =&gt; {
      resolve(import('./components/DelayedComponent.vue'))
    }, 3000)
  })
}

// é«˜çº§å¼‚æ­¥ç»„ä»¶é…ç½®
const AdvancedAsyncComponent = defineAsyncComponent({
  // åŠ è½½å™¨å‡½æ•°
  loader: () =&gt; currentComponent.value?.loader() || Promise.reject(new Error('æœªé€‰æ‹©ç»„ä»¶')),
  
  // åŠ è½½ä¸­æ˜¾ç¤ºçš„ç»„ä»¶
  loadingComponent: LoadingSpinner,
  
  // åŠ è½½å¤±è´¥æ˜¾ç¤ºçš„ç»„ä»¶
  errorComponent: ErrorDisplay,
  
  // å»¶è¿Ÿæ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼ˆé¿å…é—ªçƒï¼‰
  delay: 200,
  
  // è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  timeout: 5000,
  
  // é”™è¯¯å¤„ç†å‡½æ•°
  onError: (error, retry, fail, attempts) =&gt; {
    console.error(`ç»„ä»¶åŠ è½½å¤±è´¥ (å°è¯•æ¬¡æ•°: ${attempts}):`, error)
    
    // æœ€å¤šé‡è¯• 3 æ¬¡
    if (attempts &lt;= 3) {
      console.log(`ç¬¬ ${attempts} æ¬¡é‡è¯•...`)
      retry()
    } else {
      fail()
    }
  },
  
  // å¯æŒ‚èµ·ï¼ˆSuspense ç›¸å…³ï¼‰
  suspensible: false
})

const loadComponent = (type) =&gt; {
  currentComponent.value = {
    loader: componentConfigs[type],
    type: type
  }
  componentKey.value++ // å¼ºåˆ¶é‡æ–°åˆ›å»ºç»„ä»¶
}
&lt;/script&gt;

&lt;style scoped&gt;
.advanced-lazy-demo {
  padding: 20px;
  max-width: 1000px;
  margin: 0 auto;
}

.controls {
  display: flex;
  gap: 15px;
  justify-content: center;
  margin: 30px 0;
  flex-wrap: wrap;
}

.btn-success { background: #27ae60; }
.btn-error { background: #e74c3c; }
.btn-warning { background: #f39c12; }
.btn-info { background: #3498db; }

.btn-success, .btn-error, .btn-warning, .btn-info {
  color: white;
  border: none;
  padding: 12px 20px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.3s;
}

.btn-success:hover { background: #229954; }
.btn-error:hover { background: #c0392b; }
.btn-warning:hover { background: #e67e22; }
.btn-info:hover { background: #2980b9; }

.component-area {
  min-height: 300px;
  margin: 30px 0;
  border: 2px dashed #ddd;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.config-info {
  margin-top: 40px;
  padding: 25px;
  background: #f8f9fa;
  border-radius: 8px;
}

.config-info h3 {
  margin: 0 0 20px 0;
  color: #2c3e50;
  text-align: center;
}

.config-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
}

.config-item {
  padding: 20px;
  background: white;
  border-radius: 8px;
  border-left: 4px solid #42b883;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.config-item h4 {
  margin: 0 0 10px 0;
  color: #42b883;
  font-size: 16px;
}

.config-item p {
  margin: 0;
  color: #666;
  line-height: 1.5;
}
&lt;/style&gt;
</code></pre>
<p><strong>LoadingSpinner.vue</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="loading-spinner"&gt;
    &lt;div class="spinner-container"&gt;
      &lt;div class="spinner"&gt;&lt;/div&gt;
      &lt;p&gt;ç»„ä»¶åŠ è½½ä¸­...&lt;/p&gt;
      &lt;div class="progress"&gt;
        &lt;div class="progress-bar" :style="progressStyle"&gt;&lt;/div&gt;
      &lt;/div&gt;
      &lt;p class="hint"&gt;è¿™é€šå¸¸å¾ˆå¿«ï¼Œè¯·è€å¿ƒç­‰å¾…&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted, onUnmounted } from 'vue'

const progress = ref(0)
let progressInterval

onMounted(() =&gt; {
  progressInterval = setInterval(() =&gt; {
    progress.value = Math.min(progress.value + Math.random() * 10, 90)
  }, 200)
})

onUnmounted(() =&gt; {
  clearInterval(progressInterval)
})

const progressStyle = {
  width: `${progress.value}%`
}
&lt;/script&gt;

&lt;style scoped&gt;
.loading-spinner {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  text-align: center;
}

.spinner-container {
  max-width: 300px;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #42b883;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.progress {
  width: 100%;
  height: 6px;
  background: #f0f0f0;
  border-radius: 3px;
  margin: 15px 0;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  background: linear-gradient(90deg, #42b883, #369870);
  border-radius: 3px;
  transition: width 0.3s ease;
}

.hint {
  font-size: 12px;
  color: #999;
  margin: 10px 0 0 0;
}
&lt;/style&gt;
</code></pre>
<p><strong>ErrorDisplay.vue</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="error-display"&gt;
    &lt;div class="error-container"&gt;
      &lt;div class="error-icon"&gt;âŒ&lt;/div&gt;
      &lt;h3&gt;ç»„ä»¶åŠ è½½å¤±è´¥&lt;/h3&gt;
      &lt;p class="error-message"&gt;{{ error?.message || 'æœªçŸ¥é”™è¯¯' }}&lt;/p&gt;
      &lt;div class="error-actions"&gt;
        &lt;button @click="retry" class="retry-btn"&gt;
          ğŸ”„ é‡è¯•åŠ è½½
        &lt;/button&gt;
        &lt;button @click="reset" class="reset-btn"&gt;
          ğŸ  è¿”å›é¦–é¡µ
        &lt;/button&gt;
      &lt;/div&gt;
      &lt;p class="error-hint"&gt;å¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼Œè¯·è”ç³»æŠ€æœ¯æ”¯æŒ&lt;/p&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
const props = defineProps({
  error: {
    type: Error,
    default: null
  }
})

const emit = defineEmits(['retry'])

const retry = () =&gt; {
  emit('retry')
}

const reset = () =&gt; {
  window.location.href = '/'
}
&lt;/script&gt;

&lt;style scoped&gt;
.error-display {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  text-align: center;
}

.error-container {
  max-width: 400px;
  padding: 30px;
  background: #fff5f5;
  border: 2px solid #fed7d7;
  border-radius: 8px;
}

.error-icon {
  font-size: 48px;
  margin-bottom: 20px;
}

.error-container h3 {
  margin: 0 0 15px 0;
  color: #e53e3e;
}

.error-message {
  color: #718096;
  margin-bottom: 20px;
  padding: 10px;
  background: white;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}

.error-actions {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-bottom: 15px;
}

.retry-btn, .reset-btn {
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.3s;
}

.retry-btn {
  background: #4299e1;
  color: white;
}

.retry-btn:hover {
  background: #3182ce;
}

.reset-btn {
  background: #e2e8f0;
  color: #4a5568;
}

.reset-btn:hover {
  background: #cbd5e0;
}

.error-hint {
  font-size: 12px;
  color: #a0aec0;
  margin: 0;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-12"><strong>4.2 æ¡ä»¶æ‡’åŠ è½½ä¸é¢„åŠ è½½</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="conditional-lazy-demo"&gt;
    &lt;h2&gt;æ¡ä»¶æ‡’åŠ è½½ä¸é¢„åŠ è½½ç­–ç•¥&lt;/h2&gt;
    
    &lt;div class="strategies"&gt;
      &lt;div class="strategy"&gt;
        &lt;h3&gt;1. æ¡ä»¶æ‡’åŠ è½½&lt;/h3&gt;
        &lt;div class="demo-section"&gt;
          &lt;label class="toggle-label"&gt;
            &lt;input type="checkbox" v-model="enableHeavyComponent"&gt;
            å¯ç”¨é‡å‹ç»„ä»¶
          &lt;/label&gt;
          &lt;div class="component-container"&gt;
            &lt;HeavyComponent v-if="enableHeavyComponent" /&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;

      &lt;div class="strategy"&gt;
        &lt;h3&gt;2. é¢„åŠ è½½ç­–ç•¥&lt;/h3&gt;
        &lt;div class="demo-section"&gt;
          &lt;div class="preload-buttons"&gt;
            &lt;button @click="preloadComponent('chart')" class="preload-btn"&gt;
              é¢„åŠ è½½å›¾è¡¨ç»„ä»¶
            &lt;/button&gt;
            &lt;button @click="preloadComponent('editor')" class="preload-btn"&gt;
              é¢„åŠ è½½ç¼–è¾‘å™¨
            &lt;/button&gt;
          &lt;/div&gt;
          &lt;div class="preload-status"&gt;
            &lt;div 
              v-for="item in preloadStatus" 
              :key="item.name"
              class="status-item"
              :class="item.status"
            &gt;
              &lt;span&gt;{{ item.name }}&lt;/span&gt;
              &lt;span class="status-dot"&gt;&lt;/span&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;

      &lt;div class="strategy"&gt;
        &lt;h3&gt;3. å¯è§æ—¶åŠ è½½&lt;/h3&gt;
        &lt;div class="demo-section"&gt;
          &lt;div class="scroll-container"&gt;
            &lt;div 
              v-for="n in 10" 
              :key="n"
              class="scroll-item"
            &gt;
              &lt;p&gt;å†…å®¹åŒºå— {{ n }}&lt;/p&gt;
              &lt;LazyWhenVisible v-if="n === 5" /&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, reactive, defineAsyncComponent, onMounted } from 'vue'

// 1. æ¡ä»¶æ‡’åŠ è½½
const enableHeavyComponent = ref(false)
const HeavyComponent = defineAsyncComponent(() =&gt; 
  import('./components/HeavyComponent.vue')
)

// 2. é¢„åŠ è½½ç­–ç•¥
const preloadStatus = reactive([
  { name: 'å›¾è¡¨ç»„ä»¶', status: 'pending' },
  { name: 'ç¼–è¾‘å™¨ç»„ä»¶', status: 'pending' }
])

const preloadedComponents = {}

const preloadComponent = async (type) =&gt; {
  const index = preloadStatus.findIndex(item =&gt; item.name.includes(type))
  if (index === -1) return

  preloadStatus[index].status = 'loading'
  
  try {
    if (type === 'chart') {
      preloadedComponents.chart = await import('./components/ChartComponent.vue')
    } else if (type === 'editor') {
      preloadedComponents.editor = await import('./components/EditorComponent.vue')
    }
    
    preloadStatus[index].status = 'loaded'
    console.log(`${type} ç»„ä»¶é¢„åŠ è½½å®Œæˆ`)
  } catch (error) {
    preloadStatus[index].status = 'error'
    console.error(`${type} ç»„ä»¶é¢„åŠ è½½å¤±è´¥:`, error)
  }
}

// 3. å¯è§æ—¶åŠ è½½
const LazyWhenVisible = defineAsyncComponent(() =&gt; 
  import('./components/LazyWhenVisible.vue')
)

// æ¨¡æ‹Ÿé¢„åŠ è½½
onMounted(() =&gt; {
  // ç©ºé—²æ—¶é¢„åŠ è½½å¯èƒ½ç”¨åˆ°çš„ç»„ä»¶
  if ('requestIdleCallback' in window) {
    requestIdleCallback(() =&gt; {
      preloadComponent('chart')
    })
  }
})
&lt;/script&gt;

&lt;style scoped&gt;
.conditional-lazy-demo {
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.strategies {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: 30px;
  margin: 30px 0;
}

.strategy {
  padding: 25px;
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #e9ecef;
}

.strategy h3 {
  margin: 0 0 20px 0;
  color: #2c3e50;
  font-size: 18px;
}

.demo-section {
  min-height: 200px;
}

.toggle-label {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 15px;
  cursor: pointer;
  font-weight: bold;
  color: #333;
}

.component-container {
  min-height: 150px;
  border: 2px dashed #ddd;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.preload-buttons {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.preload-btn {
  padding: 10px 16px;
  background: #3498db;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background 0.3s;
}

.preload-btn:hover {
  background: #2980b9;
}

.preload-status {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.status-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 12px;
  background: white;
  border-radius: 4px;
  border-left: 4px solid #bdc3c7;
}

.status-item.pending {
  border-left-color: #f39c12;
}

.status-item.loading {
  border-left-color: #3498db;
}

.status-item.loaded {
  border-left-color: #27ae60;
}

.status-item.error {
  border-left-color: #e74c3c;
}

.status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: #bdc3c7;
}

.status-item.pending .status-dot { background: #f39c12; }
.status-item.loading .status-dot { 
  background: #3498db;
  animation: pulse 1.5s infinite;
}
.status-item.loaded .status-dot { background: #27ae60; }
.status-item.error .status-dot { background: #e74c3c; }

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.scroll-container {
  height: 300px;
  overflow-y: auto;
  border: 1px solid #e0e0e0;
  border-radius: 6px;
  padding: 10px;
}

.scroll-item {
  padding: 20px;
  margin: 10px 0;
  background: white;
  border-radius: 4px;
  border: 1px solid #f0f0f0;
  min-height: 80px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.scroll-item p {
  margin: 0;
  color: #666;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-13"><strong>äº”ã€ æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</strong></h2>
<h3 data-id="heading-14"><strong>5.1 Webpack æ‰“åŒ…ä¼˜åŒ–é…ç½®</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vue.config.js</span>
<span class="hljs-keyword">const</span> { defineConfig } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@vue/cli-service'</span>)
<span class="hljs-keyword">const</span> <span class="hljs-title class_">BundleAnalyzerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-bundle-analyzer'</span>).<span class="hljs-property">BundleAnalyzerPlugin</span>

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">transpileDependencies</span>: <span class="hljs-literal">true</span>,
  
  <span class="hljs-attr">configureWebpack</span>: {
    <span class="hljs-attr">optimization</span>: {
      <span class="hljs-attr">splitChunks</span>: {
        <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
        <span class="hljs-attr">cacheGroups</span>: {
          <span class="hljs-comment">// ç¬¬ä¸‰æ–¹åº“å•ç‹¬æ‰“åŒ…</span>
          <span class="hljs-attr">vendor</span>: {
            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,
            <span class="hljs-attr">name</span>: <span class="hljs-string">'vendors'</span>,
            <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
            <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>
          },
          <span class="hljs-comment">// Vue ç›¸å…³åº“å•ç‹¬æ‰“åŒ…</span>
          <span class="hljs-attr">vue</span>: {
            <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/](vue|vue-router|vuex)[\\/]/</span>,
            <span class="hljs-attr">name</span>: <span class="hljs-string">'vue-vendors'</span>,
            <span class="hljs-attr">priority</span>: <span class="hljs-number">30</span>,
            <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>
          },
          <span class="hljs-comment">// å…¬å…±ä»£ç æå–</span>
          <span class="hljs-attr">common</span>: {
            <span class="hljs-attr">name</span>: <span class="hljs-string">'common'</span>,
            <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>,
            <span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>,
            <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>
          }
        }
      }
    },
    <span class="hljs-attr">plugins</span>: [
      <span class="hljs-comment">// æ‰“åŒ…åˆ†æå·¥å…·ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰</span>
      process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">'development'</span> &amp;&amp; 
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">BundleAnalyzerPlugin</span>({
        <span class="hljs-attr">analyzerMode</span>: <span class="hljs-string">'server'</span>,
        <span class="hljs-attr">openAnalyzer</span>: <span class="hljs-literal">false</span>
      })
    ].<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>)
  },
  
  <span class="hljs-attr">chainWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =&gt;</span> {
    <span class="hljs-comment">// é¢„åŠ è½½é…ç½®</span>
    config.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">'preload'</span>).<span class="hljs-title function_">tap</span>(<span class="hljs-function"><span class="hljs-params">options</span> =&gt;</span> {
      options[<span class="hljs-number">0</span>] = {
        <span class="hljs-attr">rel</span>: <span class="hljs-string">'preload'</span>,
        <span class="hljs-title function_">as</span>(<span class="hljs-params">entry</span>) {
          <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/\.css$/</span>.<span class="hljs-title function_">test</span>(entry)) <span class="hljs-keyword">return</span> <span class="hljs-string">'style'</span>
          <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/\.(woff|woff2)$/</span>.<span class="hljs-title function_">test</span>(entry)) <span class="hljs-keyword">return</span> <span class="hljs-string">'font'</span>
          <span class="hljs-keyword">return</span> <span class="hljs-string">'script'</span>
        },
        <span class="hljs-attr">include</span>: <span class="hljs-string">'initial'</span>,
        <span class="hljs-attr">fileBlacklist</span>: [<span class="hljs-regexp">/\.map$/</span>, <span class="hljs-regexp">/hot-update\.js$/</span>]
      }
      <span class="hljs-keyword">return</span> options
    })
    
    <span class="hljs-comment">//  prefetch é…ç½®</span>
    config.<span class="hljs-title function_">plugin</span>(<span class="hljs-string">'prefetch'</span>).<span class="hljs-title function_">tap</span>(<span class="hljs-function"><span class="hljs-params">options</span> =&gt;</span> {
      options[<span class="hljs-number">0</span>] = {
        <span class="hljs-attr">rel</span>: <span class="hljs-string">'prefetch'</span>,
        <span class="hljs-attr">include</span>: <span class="hljs-string">'asyncChunks'</span>
      }
      <span class="hljs-keyword">return</span> options
    })
  }
})
</code></pre>
<h3 data-id="heading-15"><strong>5.2 æ€§èƒ½ç›‘æ§ä¸é”™è¯¯è¿½è¸ª</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="performance-monitor"&gt;
    &lt;h2&gt;æ‡’åŠ è½½æ€§èƒ½ç›‘æ§&lt;/h2&gt;
    
    &lt;div class="metrics-dashboard"&gt;
      &lt;div class="metric-cards"&gt;
        &lt;div class="metric-card"&gt;
          &lt;div class="metric-value"&gt;{{ metrics.totalLoads }}&lt;/div&gt;
          &lt;div class="metric-label"&gt;æ€»åŠ è½½æ¬¡æ•°&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="metric-card"&gt;
          &lt;div class="metric-value"&gt;{{ metrics.averageLoadTime }}ms&lt;/div&gt;
          &lt;div class="metric-label"&gt;å¹³å‡åŠ è½½æ—¶é—´&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="metric-card"&gt;
          &lt;div class="metric-value"&gt;{{ metrics.successRate }}%&lt;/div&gt;
          &lt;div class="metric-label"&gt;æˆåŠŸç‡&lt;/div&gt;
        &lt;/div&gt;
        &lt;div class="metric-card"&gt;
          &lt;div class="metric-value"&gt;{{ metrics.cacheHits }}&lt;/div&gt;
          &lt;div class="metric-label"&gt;ç¼“å­˜å‘½ä¸­&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;

      &lt;div class="load-timeline"&gt;
        &lt;h3&gt;ç»„ä»¶åŠ è½½æ—¶é—´çº¿&lt;/h3&gt;
        &lt;div class="timeline"&gt;
          &lt;div 
            v-for="event in loadEvents" 
            :key="event.id"
            class="timeline-event"
            :class="event.status"
          &gt;
            &lt;div class="event-time"&gt;{{ event.timestamp }}&lt;/div&gt;
            &lt;div class="event-name"&gt;{{ event.name }}&lt;/div&gt;
            &lt;div class="event-duration"&gt;{{ event.duration }}ms&lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, reactive, onMounted } from 'vue'

const metrics = reactive({
  totalLoads: 0,
  averageLoadTime: 0,
  successRate: 100,
  cacheHits: 0
})

const loadEvents = ref([])

// ç›‘æ§ç»„ä»¶åŠ è½½æ€§èƒ½
const monitorComponentLoad = (componentName) =&gt; {
  const startTime = performance.now()
  const eventId = Date.now()
  
  const loadEvent = {
    id: eventId,
    name: componentName,
    timestamp: new Date().toLocaleTimeString(),
    status: 'loading',
    duration: 0
  }
  
  loadEvents.value.unshift(loadEvent)
  if (loadEvents.value.length &gt; 10) {
    loadEvents.value.pop()
  }
  
  metrics.totalLoads++
  
  return {
    success: () =&gt; {
      const endTime = performance.now()
      const duration = endTime - startTime
      
      loadEvent.status = 'success'
      loadEvent.duration = Math.round(duration)
      
      // æ›´æ–°å¹³å‡åŠ è½½æ—¶é—´
      const totalTime = metrics.averageLoadTime * (metrics.totalLoads - 1) + duration
      metrics.averageLoadTime = Math.round(totalTime / metrics.totalLoads)
    },
    error: () =&gt; {
      const endTime = performance.now()
      const duration = endTime - startTime
      
      loadEvent.status = 'error'
      loadEvent.duration = Math.round(duration)
      
      // æ›´æ–°æˆåŠŸç‡
      const successCount = Math.floor(metrics.totalLoads * (metrics.successRate / 100))
      metrics.successRate = Math.round((successCount / metrics.totalLoads) * 100)
    },
    cacheHit: () =&gt; {
      metrics.cacheHits++
    }
  }
}

// ç¤ºä¾‹ï¼šç›‘æ§ç»„ä»¶åŠ è½½
const loadMonitoredComponent = async (componentName) =&gt; {
  const monitor = monitorComponentLoad(componentName)
  
  try {
    // æ¨¡æ‹Ÿç»„ä»¶åŠ è½½
    await new Promise(resolve =&gt; setTimeout(resolve, Math.random() * 1000 + 500))
    
    // æ£€æŸ¥æ˜¯å¦ç¼“å­˜å‘½ä¸­
    if (Math.random() &gt; 0.7) {
      monitor.cacheHit()
    }
    
    monitor.success()
    return true
  } catch (error) {
    monitor.error()
    return false
  }
}

// æ¨¡æ‹Ÿä¸€äº›åŠ è½½äº‹ä»¶
onMounted(async () =&gt; {
  const components = ['é¦–é¡µ', 'ç”¨æˆ·é¢æ¿', 'è®¾ç½®é¡µé¢', 'æ•°æ®åˆ†æ', 'æ–‡æ¡£æŸ¥çœ‹']
  
  for (const component of components) {
    await loadMonitoredComponent(component)
    await new Promise(resolve =&gt; setTimeout(resolve, 1000))
  }
})
&lt;/script&gt;

&lt;style scoped&gt;
.performance-monitor {
  padding: 20px;
  max-width: 1000px;
  margin: 0 auto;
}

.metrics-dashboard {
  margin: 30px 0;
}

.metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.metric-card {
  padding: 25px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  text-align: center;
  border-top: 4px solid #42b883;
}

.metric-value {
  font-size: 32px;
  font-weight: bold;
  color: #2c3e50;
  margin-bottom: 8px;
}

.metric-label {
  color: #7f8c8d;
  font-size: 14px;
}

.load-timeline {
  background: white;
  border-radius: 8px;
  padding: 25px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.load-timeline h3 {
  margin: 0 0 20px 0;
  color: #2c3e50;
}

.timeline {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.timeline-event {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 15px;
  border-radius: 6px;
  border-left: 4px solid #bdc3c7;
  transition: all 0.3s;
}

.timeline-event.loading {
  border-left-color: #3498db;
  background: #ebf5fb;
}

.timeline-event.success {
  border-left-color: #27ae60;
  background: #eafaf1;
}

.timeline-event.error {
  border-left-color: #e74c3c;
  background: #fdedec;
}

.event-time {
  font-size: 12px;
  color: #7f8c8d;
  min-width: 80px;
}

.event-name {
  flex: 1;
  font-weight: 500;
  color: #2c3e50;
}

.event-duration {
  font-family: 'Courier New', monospace;
  font-weight: bold;
  color: #34495e;
  min-width: 60px;
  text-align: right;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-16"><strong>å…­ã€ å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯</strong></h2>
<h3 data-id="heading-17"><strong>6.1 å¤§å‹ç®¡ç†ç³»ç»Ÿçš„æ‡’åŠ è½½ç­–ç•¥</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/utils/lazyLoading.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createLazyComponent</span> = (<span class="hljs-params">loader, options = {}</span>) =&gt; {
  <span class="hljs-keyword">const</span> defaultOptions = {
    <span class="hljs-attr">loadingComponent</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/components/Loading/LoadingState.vue'</span>),
    <span class="hljs-attr">errorComponent</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/components/Error/ErrorState.vue'</span>),
    <span class="hljs-attr">delay</span>: <span class="hljs-number">200</span>,
    <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
    <span class="hljs-attr">retryAttempts</span>: <span class="hljs-number">3</span>
  }
  
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">defineAsyncComponent</span>({
    loader,
    ...defaultOptions,
    ...options
  })
}

<span class="hljs-comment">// ä¸šåŠ¡ç»„ä»¶æ‡’åŠ è½½</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyUserManagement</span> = <span class="hljs-title function_">createLazyComponent</span>(
  <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/UserManagement.vue'</span>),
  { <span class="hljs-attr">timeout</span>: <span class="hljs-number">15000</span> }
)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyDataAnalytics</span> = <span class="hljs-title function_">createLazyComponent</span>(
  <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/DataAnalytics.vue'</span>)
)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyReportGenerator</span> = <span class="hljs-title function_">createLazyComponent</span>(
  <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/ReportGenerator.vue'</span>)
)

<span class="hljs-comment">// åŠŸèƒ½æ¨¡å—æ‡’åŠ è½½</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyRichEditor</span> = <span class="hljs-title function_">createLazyComponent</span>(
  <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/components/Editors/RichEditor.vue'</span>)
)

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyChartLibrary</span> = <span class="hljs-title function_">createLazyComponent</span>(
  <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/components/Charts/ChartLibrary.vue'</span>)
)

<span class="hljs-comment">// é¢„åŠ è½½ç­–ç•¥</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">preloadCriticalComponents</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-string">'requestIdleCallback'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
    <span class="hljs-title function_">requestIdleCallback</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// é¢„åŠ è½½å…³é”®ç»„ä»¶</span>
      <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/views/Dashboard.vue'</span>)
      <span class="hljs-keyword">import</span>(<span class="hljs-string">'@/components/Common/SearchBox.vue'</span>)
    })
  }
}

<span class="hljs-comment">// è·¯ç”±çº§åˆ«çš„åˆ†ç»„æ‡’åŠ è½½</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">createRouteGroup</span> = (<span class="hljs-params">groupName</span>) =&gt; {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">user</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: "user-group" */</span> <span class="hljs-string">`@/views/<span class="hljs-subst">${groupName}</span>/User.vue`</span>),
    <span class="hljs-attr">profile</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: "user-group" */</span> <span class="hljs-string">`@/views/<span class="hljs-subst">${groupName}</span>/Profile.vue`</span>),
    <span class="hljs-attr">settings</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-comment">/* webpackChunkName: "user-group" */</span> <span class="hljs-string">`@/views/<span class="hljs-subst">${groupName}</span>/Settings.vue`</span>)
  }
}
</code></pre>
<h3 data-id="heading-18"><strong>6.2 åŸºäºç”¨æˆ·è¡Œä¸ºçš„æ™ºèƒ½é¢„åŠ è½½</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="smart-preload-demo"&gt;
    &lt;h2&gt;æ™ºèƒ½é¢„åŠ è½½ç­–ç•¥&lt;/h2&gt;
    
    &lt;div class="user-journey"&gt;
      &lt;div class="journey-step" @mouseenter="preloadStep('products')"&gt;
        &lt;h3&gt;1. æµè§ˆäº§å“&lt;/h3&gt;
        &lt;p&gt;é¼ æ ‡æ‚¬åœé¢„åŠ è½½äº§å“è¯¦æƒ…&lt;/p&gt;
      &lt;/div&gt;
      
      &lt;div class="journey-step" @click="preloadStep('checkout')"&gt;
        &lt;h3&gt;2. åŠ å…¥è´­ç‰©è½¦&lt;/h3&gt;
        &lt;p&gt;ç‚¹å‡»é¢„åŠ è½½ç»“ç®—é¡µé¢&lt;/p&gt;
      &lt;/div&gt;
      
      &lt;div class="journey-step" @touchstart="preloadStep('payment')"&gt;
        &lt;h3&gt;3. ç»“ç®—æ”¯ä»˜&lt;/h3&gt;
        &lt;p&gt;è§¦æ‘¸é¢„åŠ è½½æ”¯ä»˜ç»„ä»¶&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="preload-strategies"&gt;
      &lt;h3&gt;é¢„åŠ è½½ç­–ç•¥çŠ¶æ€&lt;/h3&gt;
      &lt;div class="strategy-grid"&gt;
        &lt;div 
          v-for="strategy in strategies" 
          :key="strategy.name"
          class="strategy-item"
          :class="strategy.status"
        &gt;
          &lt;div class="strategy-icon"&gt;{{ strategy.icon }}&lt;/div&gt;
          &lt;div class="strategy-info"&gt;
            &lt;div class="strategy-name"&gt;{{ strategy.name }}&lt;/div&gt;
            &lt;div class="strategy-desc"&gt;{{ strategy.description }}&lt;/div&gt;
          &lt;/div&gt;
          &lt;div class="strategy-status"&gt;{{ strategy.status }}&lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, reactive, onMounted } from 'vue'

const strategies = reactive([
  {
    name: 'æ‚¬åœé¢„åŠ è½½',
    description: 'é¼ æ ‡æ‚¬åœæ—¶é¢„åŠ è½½ç›®æ ‡ç»„ä»¶',
    icon: 'ğŸ–±ï¸',
    status: 'ç­‰å¾…è§¦å‘',
    trigger: 'mouseenter'
  },
  {
    name: 'ç‚¹å‡»é¢„åŠ è½½',
    description: 'ç”¨æˆ·ç‚¹å‡»æ—¶é¢„åŠ è½½ä¸‹ä¸€é¡µé¢',
    icon: 'ğŸ‘†',
    status: 'ç­‰å¾…è§¦å‘',
    trigger: 'click'
  },
  {
    name: 'è§¦æ‘¸é¢„åŠ è½½',
    description: 'ç§»åŠ¨ç«¯è§¦æ‘¸æ—¶é¢„åŠ è½½',
    icon: 'ğŸ“±',
    status: 'ç­‰å¾…è§¦å‘',
    trigger: 'touchstart'
  },
  {
    name: 'ç©ºé—²é¢„åŠ è½½',
    description: 'æµè§ˆå™¨ç©ºé—²æ—¶é¢„åŠ è½½',
    icon: 'ğŸ’¤',
    status: 'ç­‰å¾…è§¦å‘',
    trigger: 'idle'
  }
])

const preloadedComponents = new Set()

const preloadStep = async (step) =&gt; {
  const strategy = strategies.find(s =&gt; s.trigger === step)
  if (strategy &amp;&amp; strategy.status === 'ç­‰å¾…è§¦å‘') {
    strategy.status = 'åŠ è½½ä¸­...'
    
    try {
      // æ¨¡æ‹Ÿç»„ä»¶é¢„åŠ è½½
      await new Promise(resolve =&gt; setTimeout(resolve, 1000))
      
      strategy.status = 'å·²åŠ è½½'
      preloadedComponents.add(step)
      console.log(`âœ… ${step} ç»„ä»¶é¢„åŠ è½½å®Œæˆ`)
    } catch (error) {
      strategy.status = 'åŠ è½½å¤±è´¥'
      console.error(`âŒ ${step} ç»„ä»¶é¢„åŠ è½½å¤±è´¥:`, error)
    }
  }
}

// ç©ºé—²æ—¶é¢„åŠ è½½
onMounted(() =&gt; {
  if ('requestIdleCallback' in window) {
    requestIdleCallback(() =&gt; {
      const idleStrategy = strategies.find(s =&gt; s.trigger === 'idle')
      if (idleStrategy) {
        idleStrategy.status = 'å·²åŠ è½½'
        preloadedComponents.add('common')
        console.log('ğŸ•’ ç©ºé—²æ—¶é¢„åŠ è½½å®Œæˆ')
      }
    })
  }
})
&lt;/script&gt;

&lt;style scoped&gt;
.smart-preload-demo {
  padding: 20px;
  max-width: 1000px;
  margin: 0 auto;
}

.user-journey {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.journey-step {
  padding: 30px;
  background: white;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s;
}

.journey-step:hover {
  border-color: #42b883;
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(66, 184, 131, 0.2);
}

.journey-step h3 {
  margin: 0 0 10px 0;
  color: #2c3e50;
}

.journey-step p {
  margin: 0;
  color: #7f8c8d;
  font-size: 14px;
}

.preload-strategies {
  margin-top: 40px;
}

.preload-strategies h3 {
  margin: 0 0 20px 0;
  color: #2c3e50;
}

.strategy-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 15px;
}

.strategy-item {
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 20px;
  background: white;
  border-radius: 8px;
  border-left: 4px solid #bdc3c7;
  transition: all 0.3s;
}

.strategy-item.ç­‰å¾…è§¦å‘ {
  border-left-color: #f39c12;
}

.strategy-item.åŠ è½½ä¸­ {
  border-left-color: #3498db;
}

.strategy-item.å·²åŠ è½½ {
  border-left-color: #27ae60;
}

.strategy-item.åŠ è½½å¤±è´¥ {
  border-left-color: #e74c3c;
}

.strategy-icon {
  font-size: 24px;
}

.strategy-info {
  flex: 1;
}

.strategy-name {
  font-weight: bold;
  color: #2c3e50;
  margin-bottom: 4px;
}

.strategy-desc {
  font-size: 12px;
  color: #7f8c8d;
}

.strategy-status {
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: bold;
  text-transform: uppercase;
}

.strategy-item.ç­‰å¾…è§¦å‘ .strategy-status {
  background: #fff3cd;
  color: #856404;
}

.strategy-item.åŠ è½½ä¸­ .strategy-status {
  background: #d1ecf1;
  color: #0c5460;
}

.strategy-item.å·²åŠ è½½ .strategy-status {
  background: #d4edda;
  color: #155724;
}

.strategy-item.åŠ è½½å¤±è´¥ .strategy-status {
  background: #f8d7da;
  color: #721c24;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-19"><strong>ä¸ƒã€ æ€»ç»“</strong></h2>
<h3 data-id="heading-20"><strong>7.1 Vue3 ç»„ä»¶æ‡’åŠ è½½çš„æ ¸å¿ƒä»·å€¼</strong></h3>
<ol>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæ˜¾è‘—å‡å°‘é¦–å±åŠ è½½æ—¶é—´ï¼Œæå‡ç”¨æˆ·ä½“éªŒ</li>
<li><strong>èµ„æºæ•ˆç‡</strong>ï¼šæŒ‰éœ€åŠ è½½ï¼Œé¿å…èµ„æºæµªè´¹</li>
<li><strong>ç¼“å­˜ä¼˜åŒ–</strong>ï¼šç‹¬ç«‹çš„ chunk å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜</li>
<li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šåˆç†çš„åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†æå‡ç”¨æˆ·æ»¡æ„åº¦</li>
</ol>
<h3 data-id="heading-21"><strong>7.2 æ‡’åŠ è½½å®ç°æ–¹å¼æ€»ç»“</strong></h3>



































<table><thead><tr><th>æ–¹å¼</th><th>é€‚ç”¨åœºæ™¯</th><th>ä¼˜ç‚¹</th><th>ç¼ºç‚¹</th></tr></thead><tbody><tr><td><code>defineAsyncComponent</code></td><td>æ¡ä»¶æ¸²æŸ“ç»„ä»¶</td><td>é…ç½®çµæ´»ï¼Œé”™è¯¯å¤„ç†å®Œå–„</td><td>éœ€è¦æ‰‹åŠ¨ç®¡ç†åŠ è½½çŠ¶æ€</td></tr><tr><td>è·¯ç”±æ‡’åŠ è½½</td><td>é¡µé¢çº§ç»„ä»¶</td><td>å¤©ç„¶çš„ä¸šåŠ¡åˆ†å‰²ï¼Œå®ç°ç®€å•</td><td>é¡µé¢åˆ‡æ¢å¯èƒ½æœ‰å»¶è¿Ÿ</td></tr><tr><td>Suspense + å¼‚æ­¥ç»„ä»¶</td><td>éœ€è¦åŠ è½½çŠ¶æ€çš„åœºæ™¯</td><td>å£°æ˜å¼ï¼Œä»£ç ç®€æ´</td><td>éœ€è¦ Vue3 æ”¯æŒ</td></tr><tr><td>åŠ¨æ€ import()</td><td>æ¨¡å—çº§æ‡’åŠ è½½</td><td>æ ‡å‡†è¯­æ³•ï¼Œé€šç”¨æ€§å¼º</td><td>éœ€è¦é…åˆæ„å»ºå·¥å…·</td></tr></tbody></table>
<h3 data-id="heading-22"><strong>7.3 æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ</strong></h3>
<ol>
<li><strong>åˆç†åˆ†å‰²ä»£ç </strong>ï¼šæŒ‰ç…§ä¸šåŠ¡æ¨¡å—å’ŒåŠŸèƒ½è¿›è¡Œä»£ç åˆ†å‰²</li>
<li><strong>é¢„åŠ è½½ç­–ç•¥</strong>ï¼šæ ¹æ®ç”¨æˆ·è¡Œä¸ºé¢„æµ‹å¹¶é¢„åŠ è½½å¯èƒ½éœ€è¦çš„ç»„ä»¶</li>
<li><strong>åŠ è½½çŠ¶æ€ç®¡ç†</strong>ï¼šæä¾›å‹å¥½çš„åŠ è½½åé¦ˆå’Œé”™è¯¯å¤„ç†</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šåˆ©ç”¨æµè§ˆå™¨ç¼“å­˜å’Œ Service Worker</li>
<li><strong>ç›‘æ§åˆ†æ</strong>ï¼šæŒç»­ç›‘æ§åŠ è½½æ€§èƒ½ï¼Œä¼˜åŒ–åˆ†å‰²ç­–ç•¥</li>
</ol>
<h3 data-id="heading-23"><strong>7.4 æ³¨æ„äº‹é¡¹</strong></h3>
<ul>
<li><strong>é¿å…è¿‡åº¦åˆ†å‰²</strong>ï¼šå¤ªå¤šçš„ chunk ä¼šå¢åŠ  HTTP è¯·æ±‚å¼€é”€</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå¿…é¡»å¤„ç†åŠ è½½å¤±è´¥çš„æƒ…å†µ</li>
<li><strong>æµ‹è¯•è¦†ç›–</strong>ï¼šç¡®ä¿æ‡’åŠ è½½ç»„ä»¶åœ¨å„ç§ç½‘ç»œæ¡ä»¶ä¸‹çš„è¡¨ç°</li>
<li><strong>SEO è€ƒè™‘</strong>ï¼šæœåŠ¡ç«¯æ¸²æŸ“æ—¶éœ€è¦è€ƒè™‘æ‡’åŠ è½½ç»„ä»¶çš„å¤„ç†</li>
</ul>
<p>Vue3 çš„ç»„ä»¶æ‡’åŠ è½½ä¸ºç°ä»£å‰ç«¯åº”ç”¨æä¾›äº†å¼ºå¤§çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µã€‚é€šè¿‡åˆç†è¿ç”¨å„ç§æ‡’åŠ è½½ç­–ç•¥ï¼Œå¯ä»¥æ˜¾è‘—æå‡åº”ç”¨æ€§èƒ½ï¼Œæ”¹å–„ç”¨æˆ·ä½“éªŒã€‚</p>
<hr/>
<p><strong>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—å’Œè¯„è®ºï¼æœ‰ä»»ä½•é—®é¢˜éƒ½å¯ä»¥åœ¨è¯„è®ºåŒºè®¨è®ºã€‚</strong><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/56fbf480de944f1abddbb1f63627f457~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YyX6L6wYWxr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766303438&amp;x-signature=KXYGhlyeLzHdsqRxSvIS3ZgEffE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è§£æ”¾åŒæ‰‹ï¼ä½¿ç”¨Cursor+Figma MCP é«˜æ•ˆè¿˜åŸå“åº”å¼è®¾è®¡ç¨¿]]></title>    <link>https://juejin.cn/post/7583528177558634546</link>    <guid>https://juejin.cn/post/7583528177558634546</guid>    <pubDate>2025-12-14T08:07:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583528177558634546" data-draft-id="7583324039302168627" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è§£æ”¾åŒæ‰‹ï¼ä½¿ç”¨Cursor+Figma MCP é«˜æ•ˆè¿˜åŸå“åº”å¼è®¾è®¡ç¨¿"/> <meta itemprop="keywords" content="å‰ç«¯,MCP"/> <meta itemprop="datePublished" content="2025-12-14T08:07:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¤©å¤©æ‰­ç "/> <meta itemprop="url" content="https://juejin.cn/user/3349589831715801"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è§£æ”¾åŒæ‰‹ï¼ä½¿ç”¨Cursor+Figma MCP é«˜æ•ˆè¿˜åŸå“åº”å¼è®¾è®¡ç¨¿
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3349589831715801/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¤©å¤©æ‰­ç 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:07:03.000Z" title="Sun Dec 14 2025 08:07:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å¦‚ä»Šçš„å¿«é€Ÿè¿­ä»£å‘¨æœŸä¸­ï¼Œå¦‚ä½•é«˜æ•ˆã€ç²¾å‡†åœ°å°†è®¾è®¡ç¨¿è½¬åŒ–ä¸ºé«˜è´¨é‡çš„è·¨å¹³å°ä»£ç ï¼Œä¸€ç›´æ˜¯å‰ç«¯å’Œç§»åŠ¨ç«¯å¼€å‘è€…çš„æ ¸å¿ƒç—›ç‚¹ã€‚</p>
<p>ä¼ ç»Ÿçš„â€œåˆ‡å›¾â€å’Œâ€œåƒç´ çº§è¿˜åŸâ€æµç¨‹ä¸ä»…è€—æ—¶ï¼Œè¿˜ææ˜“äº§ç”Ÿä¿¡æ¯åå·®ã€‚</p>
<p>å¥½æ¶ˆæ¯æ˜¯ï¼ŒFigma å®˜æ–¹æ¨å‡ºçš„ <strong>Model Component Protocol (MCP)</strong> æœåŠ¡ï¼Œç»“åˆ AI ä»£ç ç¥å™¨ <strong>Cursor</strong>ï¼Œæ­£åœ¨å½»åº•é¢ è¦†è¿™ä¸€å·¥ä½œæµã€‚æœ¬æ–‡å°†ä¸ºæ‚¨æ­ç¤ºå¦‚ä½•é€šè¿‡è¿™ä¸€é»„é‡‘ç»„åˆï¼Œå°†è®¾è®¡åˆ°ä»£ç çš„æµç¨‹ç¼©çŸ­åˆ°<strong>åˆ†é’Ÿçº§</strong>ï¼Œå®ç° <strong>90%</strong> çš„è§†è§‰è¿˜åŸåº¦ã€‚</p>
<hr/>
<h2 data-id="heading-0">Figma MCP è§£å†³äº†ä»€ä¹ˆå®é™…é—®é¢˜ï¼Ÿ</h2>
<p><strong>ä¸€å¥è¯æ€»ç»“ï¼š</strong> é€šè¿‡ MCP ç›´æ¥è¯»å– Figma æ–‡ä»¶çš„<strong>ç»“æ„åŒ–è®¾è®¡æ•°æ®</strong>ï¼Œç»“åˆ Cursor çš„ä»£ç æ™ºèƒ½ï¼Œå®ç°å¤šå¹³å° UI ä»£ç çš„è‡ªåŠ¨åŒ–ã€ç²¾å‡†ç”Ÿæˆã€‚</p>






























<table><thead><tr><th><strong>ç—›ç‚¹</strong></th><th><strong>è§£å†³æ–¹æ¡ˆï¼ˆCursor + Figma MCPï¼‰</strong></th><th><strong>æ•ˆæœ</strong></th></tr></thead><tbody><tr><td><strong>ä¿¡æ¯åå·®</strong></td><td>ç›´æ¥è·å–ç²¾ç¡®çš„å°ºå¯¸ã€é¢œè‰²ã€é—´è·ç­‰æ ¸å¿ƒæ•°æ®ã€‚</td><td>æ¶ˆé™¤â€œæ‰‹æŠ–â€å’Œâ€œçœ‹é”™â€çš„é£é™©ã€‚</td></tr><tr><td><strong>é‡å¤åŠ³åŠ¨</strong></td><td>è‡ªåŠ¨åŒ–ç”ŸæˆåŸºç¡€ UI ç»“æ„ä»£ç  (å¦‚ Android XML, iOS SwiftUI, H5, RN)ã€‚</td><td>å¤§å¹…å‡å°‘æ¨¡æ¿ä»£ç çš„ç¼–å†™æ—¶é—´ã€‚</td></tr><tr><td><strong>è·¨å¹³å°ä¸ä¸€è‡´</strong></td><td>åŒä¸€è®¾è®¡æºç”Ÿæˆå¤šå¹³å°ä»£ç ã€‚</td><td>æå‡ä¸åŒå¹³å°é—´ UI çš„è§†è§‰å’Œç»“æ„ç»Ÿä¸€æ€§ã€‚</td></tr><tr><td><strong>è¿­ä»£é€Ÿåº¦æ…¢</strong></td><td>ä»è®¾è®¡åˆ°å¯ç”¨ä»£ç è€—æ—¶æ•°å¤©/æ•°å°æ—¶ã€‚</td><td>ä»è®¾è®¡åˆ°å¯ç”¨ä»£ç ä»…éœ€<strong>å‡ åˆ†é’Ÿ</strong>ã€‚</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-1">ä¸€ã€Cursor + Figma MCP è¿æ¥æµç¨‹</h2>
<p>Figma å®˜æ–¹åœ¨ 9 æœˆä»½æ¨å‡º MCP æœåŠ¡åï¼Œè¿æ¥æµç¨‹å·²ç»å¤§å¤§ç®€åŒ–ï¼Œå‘Šåˆ«äº†ä¹‹å‰ç¹ççš„ç¬¬ä¸‰æ–¹æ’ä»¶è¿æ¥æ–¹å¼ã€‚</p>
<h3 data-id="heading-2">1.1 ä¸€é”®è¿æ¥é…ç½®</h3>
<p>æ•´ä¸ªé…ç½®è¿‡ç¨‹ç°åœ¨æ˜¯æ ‡å‡†åŒ–çš„ï¼Œç®€å•å¯é ï¼š</p>
<ol>
<li>
<p>è¿›å…¥ Figma å®˜æ–¹ MCP æœåŠ¡é¡µé¢ã€‚<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.figma.com%2Fmcp-catalog%2F" target="_blank" title="https://link.juejin.cn/?target=https%3A%2F%2Fwww.figma.com%2Fmcp-catalog%2F">æœåŠ¡é¡µé¢</a></p>
</li>
<li>
<p>ç‚¹å‡» Cursor ä¸­çš„ <strong>â€œAdd MCP to Cursorâ€</strong> ã€‚
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db88d7e7b281464382247d3899185703~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766304423&amp;x-signature=%2FCVaf7d0SFfZcWzf9hRaD88IMs4%3D" alt="image.png" loading="lazy"/></p>
</li>
<li>
<p>ç³»ç»Ÿå°†è·³è½¬è‡³ Cursor å®¢æˆ·ç«¯ï¼Œç‚¹å‡» <strong>Install</strong>ã€‚</p>
</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/799209a1baf54ee397e47773e224569b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766304423&amp;x-signature=zM0HCgKWcgguyTvWEFmY3uyyWNI%3D" alt="image.png" loading="lazy"/></p>
<ol start="7">
<li>
<p>ç‚¹å‡» <strong>Connect</strong> å¼€å§‹èº«ä»½éªŒè¯ã€‚</p>
</li>
<li>
<p>åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ç‚¹å‡» <strong>Open</strong>ï¼Œç„¶åç‚¹å‡» <strong>Allow access</strong> å®Œæˆæˆæƒã€‚</p>
</li>
</ol>
<p align="center"><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/68a69e3081474fe291e184db3b3f5918~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766304423&amp;x-signature=Lg8r98EL0PTxtIUaWlyIhoGQYzw%3D" alt="image.png" width="70%" loading="lazy"/></p>
<h3 data-id="heading-3">1.2  å¼€å§‹ä½¿ç”¨ MCP æœåŠ¡</h3>
<p>é…ç½®å®Œæˆåï¼Œæ‚¨å°±å¯ä»¥å°†è®¾è®¡æ•°æ®å–‚ç»™ Cursor äº†ï¼š</p>
<ol>
<li>åœ¨ Figma å®¢æˆ·ç«¯ä¸­ï¼Œç¡®ä¿åˆ‡æ¢åˆ° <strong>Dev Mode</strong>ï¼ˆè¿™é‡Œéœ€è¦å°†Figmaå‡çº§åˆ°ä¸“ä¸šç‰ˆæˆ–è€…æ•™è‚²ç‰ˆï¼Œå¯ä»¥çœ‹çœ‹æŸé±¼ï¼‰ã€‚</li>
<li>é€‰æ‹©æ‚¨æƒ³è¦ç”Ÿæˆä»£ç çš„<strong>å›¾å±‚æˆ–ç»„ä»¶</strong>ã€‚</li>
<li>å³é”®ç‚¹å‡»ï¼Œé€‰æ‹© <strong>Copy link to selection</strong>ã€‚</li>
</ol>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0098a045a7b147cbb2d5af3deed35911~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766304423&amp;x-signature=riFpF9bVzdhritRGTHwz52ygKZE%3D" alt="image.png" loading="lazy"/></p>
<ol start="4">
<li>å°†å¤åˆ¶çš„é“¾æ¥ç²˜è´´åˆ° Cursor çš„è¾“å…¥æ¡†æˆ–èŠå¤©ç•Œé¢ä¸­ï¼Œå¹¶æå‡ºæ‚¨çš„ä»£ç ç”Ÿæˆè¯·æ±‚ï¼ˆä¾‹å¦‚ï¼šâ€œä¸ºæˆ‘ç”Ÿæˆè¿™æ®µè®¾è®¡çš„ Android XML ä»£ç â€ï¼‰ã€‚</li>
</ol>
<p><strong>ä¸‹é¢æ˜¯æˆ‘å’ŒAIå¯¹è¯çš„æµç¨‹ä»¥åŠæœ€åçš„æ•ˆæœå›¾</strong></p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section"># ä»»åŠ¡ï¼šä¸¥æ ¼å¤åˆ»å“åº”å¼ Figma ç»„ä»¶</span>
<span class="hljs-strong">**1. ç›®æ ‡è®¾è®¡å›¾é“¾æ¥ï¼ˆå« Node IDï¼‰ï¼š**</span>

{ https://www.figma.com/design/c4BVKzIN4oVNuxV9OzUhC8/Untitled?node-id=1-616&amp;t=IiXRzf3Lq5QE7N3K-4 }

<span class="hljs-strong">**2. æ ¸å¿ƒè¦æ±‚ï¼š**</span>

<span class="hljs-bullet">-</span> <span class="hljs-strong">**å¤åˆ»èŒƒå›´ï¼š**</span> è¯·ä¸¥æ ¼å¤åˆ»é“¾æ¥æŒ‡å‘çš„ã€é¦–é¡µ/ç‰¹å®šæ¡†æ¶åç§°ã€‘ä¸­çš„<span class="hljs-strong">**ä¸»è¦å¯¼èˆªæ  (Header/Navbar)**</span> å’Œ<span class="hljs-strong">**è‹±é›„åŒº (Hero Section)**</span>ã€‚

<span class="hljs-bullet">-</span> <span class="hljs-strong">**å“åº”å¼å¤„ç†ï¼š**</span> å¿…é¡»ä½¿ç”¨ Figma MCP è·å–è®¾è®¡ç¨¿ä¸­çš„æ‰€æœ‰<span class="hljs-strong">**å“åº”å¼æ–­ç‚¹**</span>ï¼ˆä¾‹å¦‚ Desktopã€Tabletã€Mobileï¼‰ã€‚ä»£ç å¿…é¡»ä½¿ç”¨åª’ä½“æŸ¥è¯¢ï¼ˆMedia Queriesï¼‰æˆ–æ¡†æ¶çš„å“åº”å¼å·¥å…·ï¼ˆå¦‚ Tailwind CSS çš„ <span class="hljs-code">`md:`</span>ã€<span class="hljs-code">`lg:`</span> å‰ç¼€ï¼‰æ¥ç²¾ç¡®å®ç°ä¸åŒæ–­ç‚¹ä¸‹çš„å¸ƒå±€ã€é—´è·å’Œå­—ä½“å¤§å°å˜åŒ–ã€‚

<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ ·å¼ä¸¥æ ¼æ€§ï¼š**</span> æ‰€æœ‰é¢œè‰²ã€å­—ä½“ã€åœ†è§’ã€å†…/å¤–è¾¹è·ã€é˜´å½±å¿…é¡»ä¸¥æ ¼åŒ¹é… Figma ä¸­å®šä¹‰çš„è®¾è®¡ Tokenã€‚

<span class="hljs-strong">**3. æŠ€æœ¯æ ˆå’Œæ ¼å¼ï¼š**</span>

<span class="hljs-bullet">-</span> <span class="hljs-strong">**è¯­è¨€/æ¡†æ¶ï¼š**</span> React (æˆ– Next.js)ã€‚

<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ ·å¼æ–¹æ¡ˆï¼š**</span> Tailwind CSS (æ¨èç”¨äºå“åº”å¼)ï¼Œæˆ–è€… CSS Modulesã€‚

<span class="hljs-bullet">-</span> <span class="hljs-strong">**æ–‡ä»¶åï¼š**</span> è¯·å°†ä»£ç æ‹†åˆ†æˆä¸¤ä¸ªæ–‡ä»¶ï¼š<span class="hljs-code">`Header.jsx`</span> å’Œ <span class="hljs-code">`HeroSection.jsx`</span>ã€‚

<span class="hljs-strong">**4. é¢å¤–åŠŸèƒ½/å·¥å…·è°ƒç”¨æŒ‡ç¤ºï¼š**</span>

<span class="hljs-bullet">-</span> <span class="hljs-strong">**Design Tokenï¼š**</span> è¯·ä¼˜å…ˆè°ƒç”¨ <span class="hljs-code">`figma/get_color_styles`</span> å’Œ <span class="hljs-code">`figma/get_text_styles`</span> ç­‰ MCP å·¥å…·æ¥æå–å¹¶å®šä¹‰é¢œè‰²å˜é‡å’Œå­—ä½“æ ·å¼ï¼Œä½œä¸ºä»£ç çš„å¸¸é‡æˆ– Tailwind é…ç½®çš„æ‰©å±•ã€‚

<span class="hljs-bullet">-</span> <span class="hljs-strong">**äº¤äº’å ä½ç¬¦ï¼š**</span> å¯¼èˆªæ ä¸­çš„é“¾æ¥ä½¿ç”¨ <span class="hljs-code">`&lt;a href="#"&gt;`</span> ä½œä¸ºå ä½ç¬¦ã€‚

---

è¯·å¼€å§‹ç”Ÿæˆä»£ç ï¼Œä½ç½®ä¸ºfigmaMcpã€‚

ä½ è¦è°ƒç”¨æˆ‘é…ç½®å¥½çš„ figmamcp server
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f3b47dafa94401f91bb0d7cbd38fa60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766304423&amp;x-signature=c8%2FysDjrizV%2Ba3LoJcmL7tSVGRU%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-ini" lang="ini">å†æ¬¡æ ¹æ®è®¾è®¡ç¨¿æ£€æŸ¥æœ‰æ²¡æœ‰ä¸åˆç†çš„åœ°æ–¹https://www.figma.com/design/c4BVKzIN4oVNuxV9OzUhC8/Untitled?<span class="hljs-attr">node-id</span>=<span class="hljs-number">1</span>-<span class="hljs-number">616</span>&amp;t=IiXRzf3Lq5QE7N3K-<span class="hljs-number">4</span> ï¼Œå¹¶ä¿®æ”¹ï¼Œè¦è¾¾æˆä¸€æ¯”ä¸€å¤åˆ»
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/41c3fadb2fe1450c9c3c31cb5c4fe5e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5aSp5aSp5omt56CB:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766304423&amp;x-signature=G8YWWRTEVKktmwGAdNPEJJCIvzs%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">äºŒã€ä½¿ç”¨Figma MCPçš„æ³¨æ„äº‹é¡¹å’Œè§„èŒƒ</h2>
<p>ä½¿ç”¨ Figma MCPï¼ˆModel Component Protocolï¼‰è§„èŒƒä¸ Cursor è¿™æ ·çš„ AI ç¼–ç å·¥å…·ç»“åˆæ—¶ï¼Œè¦å®ç°é«˜æ•ˆã€å‡†ç¡®çš„ä»£ç ç”Ÿæˆï¼Œæ‚¨éœ€è¦æ³¨æ„çš„è¦ç‚¹å¯ä»¥æ€»ç»“ä¸º <strong>"è®¾è®¡çºªå¾‹"</strong> å’Œ <strong>"AI å¼•å¯¼"</strong> ä¸¤ä¸ªæ–¹é¢ã€‚</p>
<p>Figma MCP çš„ä½œç”¨æ˜¯æä¾›ç»“æ„åŒ–æ•°æ®ï¼Œä½†æ•°æ®çš„è´¨é‡å’Œæ¸…æ™°åº¦å®Œå…¨å–å†³äºè®¾è®¡å¸ˆåœ¨ Figma ä¸­çš„æ“ä½œã€‚</p>
<hr/>
<h3 data-id="heading-5">1.è®¾è®¡å¸ˆéœ€è¦æ³¨æ„çš„â€œè®¾è®¡çºªå¾‹â€</h3>
<p><strong>AI ç”Ÿæˆä»£ç çš„è´¨é‡ï¼Œ90% å–å†³äº Figma æ–‡ä»¶çš„è§„èŒƒç¨‹åº¦ã€‚</strong> ä¸ºäº†è®© AI èƒ½å‡†ç¡®åœ°â€œç†è§£â€è®¾è®¡ç¨¿ï¼Œè®¾è®¡å¸ˆå¿…é¡»åšåˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<h4 data-id="heading-6">ï¼ˆ1ï¼‰ ç»“æ„åŒ–ç»„ä»¶æ˜¯åŸºç¡€</h4>
<ul>
<li><strong>ä½¿ç”¨ Auto Layoutï¼ˆè‡ªåŠ¨å¸ƒå±€ï¼‰ï¼š</strong> è¿™æ˜¯å®ç°å“åº”å¼è®¾è®¡çš„æ ¸å¿ƒã€‚ç¡®ä¿æ‰€æœ‰çš„å¸ƒå±€ï¼ˆå°¤å…¶æ˜¯åˆ—è¡¨ã€å¡ç‰‡ã€ä¾§è¾¹æ ç­‰ï¼‰éƒ½ä½¿ç”¨ Auto Layoutï¼Œå¹¶è®¾ç½®æ­£ç¡®çš„å¡«å……ï¼ˆPaddingï¼‰å’Œé—´è·ï¼ˆGapï¼‰ã€‚AI ä¾èµ– Auto Layout æ¥è¯†åˆ« <code>Flexbox</code>ã€<code>StackView</code> æˆ– <code>Column/Row</code> ç­‰å¸ƒå±€ç»“æ„ã€‚</li>
<li><strong>æ¸…æ™°çš„å›¾å±‚å‘½åï¼š</strong> <strong>è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ã€‚</strong> å›¾å±‚åç§°åº”è¯¥æ˜¯è¯­ä¹‰åŒ–çš„ï¼ˆä¾‹å¦‚ï¼š<code>Item/ProductCard</code>ã€<code>Button/Primary</code>ã€<code>List/RecentOrders</code>ï¼‰ã€‚é¿å…ä½¿ç”¨é»˜è®¤çš„åç§°ï¼ˆä¾‹å¦‚ï¼š<code>Rectangle 1</code>ã€<code>Group 4</code>ï¼‰ã€‚</li>
<li><strong>ç»„ä»¶åŒ–å’Œå˜ä½“ï¼š</strong> å°½å¯èƒ½å°†è®¾è®¡å…ƒç´ æŠ½è±¡ä¸º <strong>Figma ç»„ä»¶</strong>å’Œ<strong>å˜ä½“ï¼ˆVariantsï¼‰</strong> ã€‚è¿™èƒ½è®© AI è¯†åˆ«å‡ºå“ªäº›æ˜¯å¯å¤ç”¨çš„æ¨¡å—ï¼Œå¹¶ç”Ÿæˆç»„ä»¶ä»£ç ï¼ˆä¾‹å¦‚ React Components æˆ– SwiftUI Viewsï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-7">ï¼ˆ2ï¼‰ ç»Ÿä¸€ä½¿ç”¨è®¾è®¡ Token/å˜é‡</h4>
<ul>
<li><strong>ä½¿ç”¨ Figma Variablesï¼ˆå˜é‡/ä»¤ç‰Œï¼‰ï¼š</strong> é¢œè‰²ã€å­—ä½“å¤§å°ã€é—´è·ï¼ˆSpacingï¼‰ç­‰å±æ€§ï¼Œåº”ç»Ÿä¸€ä½¿ç”¨ Figma çš„ <strong>Variablesï¼ˆè®¾è®¡ä»¤ç‰Œï¼‰</strong> ã€‚AI æ¥æ”¶åˆ°çš„æ•°æ®å°†æ˜¯ <code>$color-primary-500</code> è€Œé <code>#007AFF</code>ï¼Œè¿™èƒ½è®©ç”Ÿæˆçš„ä»£ç ç›´æ¥æ˜ å°„åˆ°æ‚¨çš„<strong>ä¼ä¸šä»£ç ä¸»é¢˜</strong>ã€‚</li>
<li><strong>å­—ä½“å’Œæ ·å¼ä¸€è‡´æ€§ï¼š</strong> ç¡®ä¿æ‰€æœ‰æ–‡æœ¬éƒ½é“¾æ¥åˆ°åŒä¸€å¥—<strong>æ–‡æœ¬æ ·å¼</strong>ã€‚</li>
</ul>
<h4 data-id="heading-8">ï¼ˆ3ï¼‰ æ˜ç¡®çš„äº¤ä»˜çŠ¶æ€</h4>
<ul>
<li><strong>ä½¿ç”¨ Dev Mode Statusesï¼š</strong> è®¾è®¡å¸ˆåº”è¯¥åˆ©ç”¨ <strong>Figma Dev Mode</strong> ä¸­çš„çŠ¶æ€æ ‡è®°ï¼ˆå¦‚ <code>Ready for dev</code>ï¼‰æ¥æ˜ç¡®å‘ŠçŸ¥å¼€å‘è€…å’Œ AI <strong>å“ªäº›éƒ¨åˆ†å¯ä»¥å¼€å§‹ä½¿ç”¨äº†</strong>ï¼Œé¿å… AI è¯»å–åˆ°æ­£åœ¨ä¿®æ”¹ä¸­çš„è®¾è®¡ç¨¿ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">2. å¼€å‘è€…éœ€è¦æ³¨æ„çš„â€œAI å¼•å¯¼â€</h3>
<p>å³ä½¿è®¾è®¡ç¨¿éå¸¸è§„èŒƒï¼ŒAI é»˜è®¤ç”Ÿæˆçš„ä»£ç ä¹Ÿå¯èƒ½ä¸ç¬¦åˆä¼ä¸šçº§é¡¹ç›®çš„æŠ€æœ¯æ ˆã€‚å¼€å‘è€…éœ€è¦é€šè¿‡ <strong>Cursor Rules</strong> ç­‰æ–¹å¼å¯¹ AI è¿›è¡ŒäºŒæ¬¡çº¦æŸå’Œå¼•å¯¼ã€‚</p>
<h4 data-id="heading-10">ï¼ˆ1ï¼‰ å¼ºåˆ¶ç»„ä»¶åº“æ›¿æ¢</h4>
<ul>
<li>
<p><strong>åˆ¶å®š Cursor Rulesï¼š</strong> é’ˆå¯¹ä¸Šæ–‡æåˆ°çš„<strong>ä¼ä¸šç»„ä»¶åº“é€‚é…é—®é¢˜</strong>ï¼Œåˆ©ç”¨ Cursor çš„è§„åˆ™é…ç½®èƒ½åŠ›ï¼Œè®¾å®šæ›¿æ¢é€»è¾‘ã€‚</p>
<ul>
<li><strong>ç¤ºä¾‹è§„åˆ™ï¼š</strong> å¦‚æœ AI è¯†åˆ«åˆ° Figma ä¸­å›¾å±‚åä¸º <code>Button/Primary</code>ï¼Œåˆ™å¼ºåˆ¶ç”Ÿæˆçš„ä»£ç ä¸æ˜¯ <code>&lt;button&gt;</code> æˆ– <code>&lt;TextView&gt;</code>ï¼Œè€Œæ˜¯ <code>&lt;MyCustomUIButton.Primary /&gt;</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong>è¾“å…¥æç¤ºï¼ˆPromptï¼‰å¼•å¯¼ï¼š</strong> åœ¨ç²˜è´´ Figma é“¾æ¥æ—¶ï¼Œæ˜ç¡®å‘ŠçŸ¥ Cursor åº”è¯¥ä½¿ç”¨å“ªä¸ªæŠ€æœ¯æ ˆå’Œç»„ä»¶åº“ã€‚</p>
<ul>
<li><strong>ç¤ºä¾‹ Promptï¼š</strong> â€œè¯·ä¸ºæˆ‘ç”Ÿæˆè¿™æ®µè®¾è®¡çš„ <strong>Android Compose UI</strong> ä»£ç ï¼Œå¹¶ç¡®ä¿ä½¿ç”¨æˆ‘ä»¬å›¢é˜Ÿçš„ <strong>"Dewu-Design-System"</strong> ä¸­çš„ç»„ä»¶ã€‚â€</li>
</ul>
</li>
</ul>
<h4 data-id="heading-11">ï¼ˆ2ï¼‰ è§£å†³åŠ¨æ€å¸ƒå±€çš„è¯­ä¹‰åŒ–é—®é¢˜</h4>
<ul>
<li>
<p><strong>å›¾å±‚å‘½åçº¦å®šï¼ˆä¸è®¾è®¡å¸ˆåä½œï¼‰ï¼š</strong> ä¸è®¾è®¡å¸ˆå›¢é˜Ÿçº¦å®šä¸€å¥—ç»Ÿä¸€çš„åˆ—è¡¨å‘½åè§„åˆ™ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li><strong>å•ä¸ª Itemï¼š</strong> å›¾å±‚åå¿…é¡»ä»¥ <code>item_</code> æˆ– <code>_card</code> ç»“å°¾ã€‚</li>
<li><strong>åˆ—è¡¨å®¹å™¨ï¼š</strong> å›¾å±‚åå¿…é¡»ä»¥ <code>list_</code> æˆ– <code>_container</code> ç»“å°¾ã€‚</li>
</ul>
</li>
<li>
<p><strong>Rules å¼ºåˆ¶ç”ŸæˆåŠ¨æ€ç»“æ„ï¼š</strong> å°†ä¸Šè¿°å‘½åçº¦å®šæ¤å…¥ Cursor Rules ä¸­ï¼Œå¼ºåˆ¶ AI åœ¨è¯†åˆ«åˆ°è¿™äº›å‰ç¼€æ—¶ï¼Œç”Ÿæˆ <strong><code>RecyclerView</code></strong>ã€<strong><code>LazyColumn</code></strong> æˆ– <strong><code>FlatList</code></strong> è¿™æ ·çš„åŠ¨æ€åˆ—è¡¨ç»“æ„ï¼Œè€Œä¸æ˜¯ä¸€å †é™æ€ Viewã€‚</p>
</li>
</ul>
<h4 data-id="heading-12">ï¼ˆ3ï¼‰ å¤„ç†å›¾ç‰‡å’Œæœ¬åœ°èµ„æº</h4>
<ul>
<li><strong>èµ„æºç¼ºå¤±æ˜¯å¸¸æ€ï¼š</strong> ç›®å‰ï¼ŒAI æ— æ³•è‡ªåŠ¨ä¸‹è½½æœ¬åœ°å›¾ç‰‡èµ„æºã€‚æ‚¨éœ€è¦<strong>æ‰‹åŠ¨ä¸‹è½½</strong>å¹¶æ›¿æ¢ä»£ç ä¸­çš„å ä½ç¬¦ã€‚</li>
<li><strong>Placeholder å‘½åï¼š</strong> ç¡®ä¿è®¾è®¡ç¨¿ä¸­å›¾ç‰‡çš„å›¾å±‚å‘½åæ˜¯æ¸…æ™°çš„ï¼ˆä¾‹å¦‚ï¼š<code>icon_user_avatar</code>ï¼‰ï¼Œè¿™æ ·ç”Ÿæˆçš„ä»£ç ä¸­å¯¹èµ„æºçš„å¼•ç”¨åç§°ä¹Ÿä¼šæ›´æ¸…æ™°ï¼Œæ–¹ä¾¿æ‚¨æ›¿æ¢ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«â€œçŒœéœ€æ±‚â€å¼ç¼–ç¨‹ï¼šè¿™ä¸ªå¼€æºå·¥å…·è®© AI ç¼–ç å˜å¾—çœŸæ­£çš„å¯æ§]]></title>    <link>https://juejin.cn/post/7583234966633971746</link>    <guid>https://juejin.cn/post/7583234966633971746</guid>    <pubDate>2025-12-14T07:57:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583234966633971746" data-draft-id="7582939860874887203" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«â€œçŒœéœ€æ±‚â€å¼ç¼–ç¨‹ï¼šè¿™ä¸ªå¼€æºå·¥å…·è®© AI ç¼–ç å˜å¾—çœŸæ­£çš„å¯æ§"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-14T07:57:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸–ç•Œé‚£ä¹ˆå“’å“’"/> <meta itemprop="url" content="https://juejin.cn/user/2285242287142777"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«â€œçŒœéœ€æ±‚â€å¼ç¼–ç¨‹ï¼šè¿™ä¸ªå¼€æºå·¥å…·è®© AI ç¼–ç å˜å¾—çœŸæ­£çš„å¯æ§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2285242287142777/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸–ç•Œé‚£ä¹ˆå“’å“’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T07:57:08.000Z" title="Sun Dec 14 2025 07:57:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    14
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ AI ç¼–ç¨‹åŠ©æ‰‹å¤§è¡Œå…¶é“çš„ä»Šå¤©ï¼Œä½œä¸ºå¼€å‘è€…ï¼Œäº«å—ç€â€œä¸€å¥è¯ç”Ÿæˆä»£ç â€çš„ä¾¿åˆ©çš„åŒæ—¶ï¼Œä¹Ÿå¸¸å¸¸é™·å…¥ä¸€ç§æ–°çš„ç„¦è™‘ï¼šAI çœŸçš„ç†è§£æˆ‘ä»¬è¦ä»€ä¹ˆå—ï¼Ÿ</p>
<p>ä½ å¤§æ¦‚ä¹Ÿç»å†è¿‡è¿™æ ·çš„åœºæ™¯ï¼šè®© AI â€œåŠ ä¸ªç™»å½•åŠŸèƒ½â€ï¼Œç»“æœå®ƒè‡ªä½œä¸»å¼ å¼•å…¥äº† OAuth2ã€çŸ­ä¿¡éªŒè¯ç ã€å›¾å½¢éªŒè¯ç ä¸‰å¥—æ–¹æ¡ˆï¼›æˆ–è€…è®©å®ƒâ€œä¼˜åŒ–æ€§èƒ½â€ï¼Œå®ƒç›´æ¥é‡å†™äº†æ•´ä¸ªæ•°æ®å±‚ï¼Œå´æ²¡é—®ä½ æ˜¯å¦å…¼å®¹æ—§æ¥å£ã€‚é—®é¢˜ä¸åœ¨äº AI èƒ½åŠ›ä¸è¶³ï¼Œè€Œåœ¨äºâ€”â€”<strong>éœ€æ±‚ä»æœªè¢«æ¸…æ™°é”å®š</strong>ã€‚</p>
<p>ä¸Šä¸Šå‘¨åˆ· Githubï¼Œå‘ç°ä¸€ä¸ªåä¸º <strong>OpenSpec</strong> çš„å¼€æºé¡¹ç›®æ­£è¯•å›¾è§£å†³è¿™ä¸€ç—›ç‚¹ã€‚å®ƒä¸å–ä»£ä½ çš„ AI å·¥å…·ï¼Œè€Œæ˜¯ä¸ºå®ƒä»¬åŠ ä¸Šä¸€å¥—â€œè§„èŒƒé©±åŠ¨å¼€å‘â€ SDDï¼ˆSpec-Driven Developmentï¼‰çš„å·¥ä½œæµï¼Œè®©äººç±»å’Œ AI åœ¨å†™ç¬¬ä¸€è¡Œä»£ç å‰ï¼Œå…ˆå°±â€œåšä»€ä¹ˆâ€è¾¾æˆå…±è¯†ã€‚</p>
<hr/>
<h3 data-id="heading-0">ä»€ä¹ˆæ˜¯ OpenSpecï¼Ÿ</h3>
<p>OpenSpec æ˜¯ç”± Fission AI å›¢é˜Ÿå‘èµ·çš„ä¸€ä¸ªè½»é‡çº§å¼€å‘æ¡†æ¶ï¼Œæ ¸å¿ƒç†å¿µå¾ˆç®€å•ï¼š<strong>å…ˆå†™è§„æ ¼ï¼ˆspecï¼‰ï¼Œå†å†™ä»£ç </strong>ã€‚</p>
<p>å®ƒåœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸¤ä¸ªå…³é”®ç›®å½•ï¼š</p>
<ul>
<li><code>openspec/specs/</code>ï¼šå­˜æ”¾å½“å‰ç³»ç»Ÿçš„çœŸå®è¡Œä¸ºè§„èŒƒï¼ˆå³â€œäº‹å®æ¥æºâ€ï¼‰</li>
<li><code>openspec/changes/</code>ï¼šå­˜æ”¾æ­£åœ¨æè®®ä¸­çš„åŠŸèƒ½å˜æ›´ï¼ˆåŒ…æ‹¬ææ¡ˆã€ä»»åŠ¡æ¸…å•å’Œè§„æ ¼å·®å¼‚ï¼‰</li>
</ul>
<p>æ•´ä¸ªæµç¨‹å›´ç»•å››ä¸ªæ­¥éª¤å±•å¼€ï¼š<strong>èµ·è‰ â†’ è¯„å®¡ â†’ å®æ–½ â†’ å½’æ¡£</strong>ã€‚AI åŠ©æ‰‹å…¨ç¨‹å‚ä¸ï¼Œä½†æ‰€æœ‰è¾“å‡ºéƒ½åŸºäºæ˜ç¡®çš„ specï¼Œè€Œéæ¨¡ç³Šçš„èŠå¤©ä¸Šä¸‹æ–‡ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œ<strong>æ— éœ€ API å¯†é’¥ï¼Œä¸ç»‘å®šç‰¹å®šå¹³å°</strong>ã€‚æ— è®ºä½ ç”¨ Cursorã€Copilotã€Claude è¿˜æ˜¯å…¶ä»–æ”¯æŒ AGENTS.md åè®®çš„å·¥å…·ï¼Œéƒ½èƒ½æ— ç¼æ¥å…¥ã€‚</p>
<hr/>
<h3 data-id="heading-1">å®æˆ˜æ¼”ç¤ºï¼šç»™åšå®¢ç³»ç»ŸåŠ â€œç‚¹èµâ€åŠŸèƒ½</h3>
<p>å‡è®¾ä½ æ­£åœ¨ç»´æŠ¤ä¸€ä¸ªåšå®¢ç³»ç»Ÿï¼Œç°åœ¨è¦æ·»åŠ â€œç”¨æˆ·ç‚¹èµâ€åŠŸèƒ½ã€‚ä¼ ç»Ÿåšæ³•å¯èƒ½æ˜¯ç›´æ¥å¯¹ AI è¯´ï¼šâ€œå¸®æˆ‘åŠ ä¸ªç‚¹èµæŒ‰é’®ã€‚â€ä½†ç”¨ OpenSpecï¼Œä½ ä¼šè¿™æ ·åšï¼š</p>
<h4 data-id="heading-2">ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–é¡¹ç›®</h4>
<pre><code class="hljs language-kotlin" lang="kotlin">npm install -g <span class="hljs-meta">@fission</span>-ai/openspec
cd <span class="hljs-keyword">super</span>-blog-site
openspec <span class="hljs-keyword">init</span>
</code></pre>
<p>å·¥å…·ä¼šå¼•å¯¼ä½ é€‰æ‹©å¸¸ç”¨çš„ AI åŠ©æ‰‹ï¼ˆå¦‚ Cursorã€Claudeï¼‰ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆé…ç½®å’Œ <code>AGENTS.md</code> æ–‡ä»¶ã€‚</p>
<h4 data-id="heading-3">ç¬¬äºŒæ­¥ï¼šåˆ›å»ºå˜æ›´ææ¡ˆ</h4>
<pre><code class="hljs language-shell" lang="shell">/openspec:proposal  è¯·ä¸ºåšå®¢ç³»ç»Ÿåˆ›å»ºä¸€ä¸ª OpenSpec å˜æ›´ææ¡ˆï¼Œç”¨äºæ·»åŠ ç‚¹èµåŠŸèƒ½ï¼Œè¦æ±‚å·²ç™»å½•ç”¨æˆ·å¯ç‚¹èµï¼Œæ¯äººæ¯ç¯‡æ–‡ç« åªèƒ½ç‚¹ä¸€æ¬¡ã€‚â€
</code></pre>
<p>AI ä¼šè‡ªåŠ¨ç”Ÿæˆä»¥ä¸‹ç»“æ„ï¼š</p>
<pre><code class="hljs language-text" lang="text">openspec/
â””â”€â”€ changes/
    â””â”€â”€ add-blog-like/
        â”œâ”€â”€ proposal.md      # åŠŸèƒ½èƒŒæ™¯ä¸ç›®æ ‡
        â”œâ”€â”€ tasks.md         # å®ç°ä»»åŠ¡æ¸…å•
        â””â”€â”€ specs/blog/spec.md  # æ–°å¢çš„è§„æ ¼ï¼ˆDelta æ ¼å¼ï¼‰
</code></pre>
<p>å…¶ä¸­ <code>spec.md</code> ä¼šæ˜ç¡®å†™å‡ºï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-section">### Requirement: åšå®¢ç‚¹èµåŠŸèƒ½</span>
ç³»ç»Ÿ MUST å…è®¸å·²è®¤è¯ç”¨æˆ·å¯¹æ–‡ç« ç‚¹èµï¼Œä¸”æ¯äººæ¯ç¯‡æ–‡ç« ä»…é™ä¸€æ¬¡ã€‚

<span class="hljs-section">#### Scenario: é¦–æ¬¡ç‚¹èµ</span>
<span class="hljs-bullet">-</span> WHEN ç”¨æˆ·ç‚¹å‡»ç‚¹èµ
<span class="hljs-bullet">-</span> THEN ç‚¹èµæ•° +1ï¼Œä¸”è®°å½•è¯¥ç”¨æˆ·å·²ç‚¹èµ

<span class="hljs-section">#### Scenario: é‡å¤ç‚¹èµ</span>
<span class="hljs-bullet">-</span> WHEN ç”¨æˆ·å†æ¬¡ç‚¹å‡»
<span class="hljs-bullet">-</span> THEN ä¸å¢åŠ è®¡æ•°ï¼Œå¹¶æç¤ºâ€œå·²ç‚¹èµâ€
</code></pre>
<h4 data-id="heading-4">ç¬¬ä¸‰æ­¥ï¼šè¯„å®¡ä¸è°ƒæ•´</h4>
<p>ä½ å¯ä»¥ç”¨å‘½ä»¤æŸ¥çœ‹ææ¡ˆç»†èŠ‚ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">openspec <span class="hljs-keyword">show</span> <span class="hljs-keyword">add</span><span class="hljs-operator">-</span>blog<span class="hljs-operator">-</span><span class="hljs-keyword">like</span>
</code></pre>
<p>å¦‚æœå‘ç°é—æ¼ï¼ˆæ¯”å¦‚å¿˜äº†â€œå–æ¶ˆç‚¹èµâ€ï¼‰ï¼Œåªéœ€å‘Šè¯‰ AI è¡¥å……ï¼Œå®ƒä¼šæ›´æ–° spec å’Œä»»åŠ¡ã€‚</p>
<h4 data-id="heading-5">ç¬¬å››æ­¥ï¼šå®æ–½ä¸å½’æ¡£</h4>
<p>ç¡®è®¤æ— è¯¯åï¼Œè¯´ï¼š</p>
<blockquote>
<p>â€œå¼€å§‹å®ç°è¿™ä¸ªç‚¹èµåŠŸèƒ½ã€‚â€</p>
</blockquote>
<p>AI å°†ä¸¥æ ¼æŒ‰ <code>tasks.md</code> ç”Ÿæˆæ•°æ®åº“è¡¨ã€API æ¥å£å’Œå‰ç«¯ç»„ä»¶ã€‚å®Œæˆåï¼Œæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-sql" lang="sql">openspec archive <span class="hljs-keyword">add</span><span class="hljs-operator">-</span>blog<span class="hljs-operator">-</span><span class="hljs-keyword">like</span> <span class="hljs-comment">--yes</span>
</code></pre>
<p>æ­¤æ—¶ï¼Œæ–°è§„æ ¼è‡ªåŠ¨åˆå¹¶è¿› <code>openspec/specs/</code>ï¼Œæˆä¸ºç³»ç»Ÿæ–‡æ¡£çš„ä¸€éƒ¨åˆ†ï¼Œè€Œå˜æ›´è®°å½•è¢«å½’æ¡£ï¼Œå…¨ç¨‹å¯è¿½æº¯ã€‚</p>
<hr/>
<h3 data-id="heading-6">ä¸ºä»€ä¹ˆå¼€å‘è€…éœ€è¦å®ƒï¼Ÿ</h3>
<ul>
<li><strong>å‡å°‘è¿”å·¥</strong>ï¼šAI ä¸å†â€œè‡ªç”±å‘æŒ¥â€ï¼Œæ‰€æœ‰è¾“å‡ºæœ‰æ®å¯ä¾ã€‚</li>
<li><strong>æ´»æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šæ¯æ¬¡å½’æ¡£éƒ½æ˜¯å¯¹ç³»ç»Ÿè¡Œä¸ºçš„ä¸€æ¬¡æ­£å¼è®°å½•ã€‚</li>
<li><strong>å›¢é˜Ÿåä½œæ›´é¡ºç•…</strong>ï¼šæ–°äººçœ‹ <code>specs/</code> å°±èƒ½ç†è§£ç³»ç»Ÿè®¾è®¡ï¼Œæ— éœ€ç¿»èŠå¤©è®°å½•ã€‚</li>
<li><strong>é€‚é…ç°æœ‰é¡¹ç›®</strong>ï¼šç‰¹åˆ«é€‚åˆå¯¹å·²æœ‰ç³»ç»Ÿåšå¢é‡æ”¹è¿›ï¼ˆ1â†’n åœºæ™¯ï¼‰ï¼Œè€Œéä»…é™ä»é›¶å¼€å§‹ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-7">ä¸ GitHub å®˜æ–¹ spec-kit å¯¹æ¯”ï¼šä¸¤ç§â€œè§„èŒƒé©±åŠ¨â€çš„ä¸åŒè·¯å¾„</h3>
<p>GitHub åœ¨ 2024 å¹´åº•æ¨å‡ºçš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fgithub%2Fspec-kit" target="_blank" title="https://github.com/github/spec-kit" ref="nofollow noopener noreferrer">spec-kit</a> åŒæ ·å€¡å¯¼â€œSpec-Driven Developmentâ€ï¼ˆè§„èŒƒé©±åŠ¨å¼€å‘ï¼‰ï¼Œå…¶æ ¸å¿ƒç›®æ ‡æ˜¯<strong>è®©è§„æ ¼æˆä¸ºå¯æ‰§è¡Œçš„èµ·ç‚¹ï¼Œè€Œéæ–‡æ¡£ç»ˆç‚¹</strong>ã€‚å®ƒç”± GitHub å†…éƒ¨å›¢é˜Ÿå­µåŒ–ï¼Œæ·±åº¦é›†æˆ Copilotï¼Œå¹¶å¼ºè°ƒé€šè¿‡ <code>/constitution</code>ã€<code>/specify</code>ã€<code>/plan</code>ã€<code>/tasks</code>ã€<code>/implement</code> ç­‰æ–œæ å‘½ä»¤æ„å»ºä¸€ä¸ªç»“æ„åŒ–å¼€å‘æµç¨‹ã€‚</p>
<p>ä¹çœ‹ä¹‹ä¸‹ï¼ŒOpenSpec ä¸ spec-kit ç†å¿µé«˜åº¦ä¸€è‡´ï¼Œä½†æ·±å…¥ä½¿ç”¨åä¼šå‘ç°ï¼Œå®ƒä»¬ä»£è¡¨äº†ä¸¤ç§ä¸åŒçš„å·¥ç¨‹æ€ç»´ï¼š</p>








































<table><thead><tr><th>ç»´åº¦</th><th><strong>OpenSpec</strong></th><th><strong>GitHub spec-kit</strong></th></tr></thead><tbody><tr><td><strong>æ ¸å¿ƒç›®æ ‡</strong></td><td><strong>ç®¡ç†å˜æ›´çš„ç”Ÿå‘½å‘¨æœŸ</strong><br/>â€”â€”èšç„¦â€œå¦‚ä½•å®‰å…¨åœ°ä¿®æ”¹ç°æœ‰ç³»ç»Ÿâ€</td><td><strong>å¼•å¯¼ä»é›¶æ„å»ºé«˜è´¨é‡åº”ç”¨</strong><br/>â€”â€”èšç„¦â€œå¦‚ä½•ä»æ¨¡ç³Šæƒ³æ³•ç”Ÿæˆå¯é å®ç°â€</td></tr><tr><td><strong>å·¥ä½œæµé‡å¿ƒ</strong></td><td>å›´ç»• <strong>å˜æ›´ææ¡ˆï¼ˆChange Proposalï¼‰</strong><br/>ï¼ˆèµ·è‰ â†’ è¯„å®¡ â†’ å®æ–½ â†’ å½’æ¡£ï¼‰</td><td>å›´ç»• <strong>åŠŸèƒ½å¼€å‘é˜¶æ®µï¼ˆDevelopment Phasesï¼‰</strong><br/>ï¼ˆå®šä¹‰åŸåˆ™ â†’ å†™ spec â†’ åˆ¶å®šè®¡åˆ’ â†’ æ‹†è§£ä»»åŠ¡ â†’ æ‰§è¡Œï¼‰</td></tr><tr><td><strong>é¡¹ç›®çŠ¶æ€å‡è®¾</strong></td><td>é»˜è®¤é¡¹ç›®å·²å­˜åœ¨ï¼ˆbrownfieldï¼‰<br/>å¼ºè°ƒä¸ç°æœ‰ä»£ç /æ–‡æ¡£å…±å­˜</td><td>æ›´é€‚åˆæ–°é¡¹ç›®æˆ–ç‹¬ç«‹åŠŸèƒ½æ¨¡å—ï¼ˆgreenfieldï¼‰<br/>å¸¸ä¼´éš <code>specify init</code> åˆ›å»ºå…¨æ–°ç›®å½•</td></tr><tr><td><strong>è§„æ ¼ç»„ç»‡æ–¹å¼</strong></td><td>ä½¿ç”¨ <strong>Deltaï¼ˆå¢é‡ï¼‰æ¨¡å¼</strong><br/>å˜æ›´æœŸé—´ä»…æè¿°å·®å¼‚ï¼Œå½’æ¡£æ—¶æ‰åˆå¹¶åˆ°ä¸»å¹² specs</td><td>è§„æ ¼ç›´æ¥å†™å…¥ <code>specs/&lt;feature&gt;/spec.md</code><br/>æ¯ä¸ªåŠŸèƒ½å¯¹åº”ä¸€ä¸ªå®Œæ•´ spec æ–‡ä»¶</td></tr><tr><td><strong>ç”¨æˆ·è§’è‰²</strong></td><td>é€‚åˆ <strong>ç»´æŠ¤è€…/è¿­ä»£è€…</strong><br/>ï¼ˆå¦‚ç»™ SaaS äº§å“åŠ æ–°åŠŸèƒ½ã€é‡æ„æ—§æ¨¡å—ï¼‰</td><td>é€‚åˆ <strong>åˆ›å»ºè€…/æ¢ç´¢è€…</strong><br/>ï¼ˆå¦‚ MVP å¼€å‘ã€æŠ€æœ¯åŸå‹éªŒè¯ã€åˆ›æ„å®éªŒï¼‰</td></tr><tr><td><strong>è¾“å‡ºäº§ç‰©</strong></td><td>å¼ºè°ƒ <strong>å¯å®¡è®¡çš„å˜æ›´è®°å½•</strong><br/>ï¼ˆarchive ä¸­ä¿ç•™å®Œæ•´ä¸Šä¸‹æ–‡ï¼‰</td><td>å¼ºè°ƒ <strong>å¯æ‰§è¡Œçš„å·¥ç¨‹èµ„äº§</strong><br/>ï¼ˆè‡ªåŠ¨ç”Ÿæˆ plan.mdã€data-model.mdã€contracts ç­‰ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-8">ä¸¾ä¸ªä¾‹å­ï¼š</h4>
<ul>
<li>å¦‚æœä½ è¦<strong>ä¸ºå…¬å¸å†…éƒ¨ CRM ç³»ç»Ÿæ–°å¢â€œå®¢æˆ·æ ‡ç­¾åˆ†ç»„â€åŠŸèƒ½</strong>ï¼Œä¸”è¯¥ç³»ç»Ÿå·²æœ‰å¤æ‚æƒé™æ¨¡å‹å’Œæ•°æ®åº“ç»“æ„ï¼Œ<strong>OpenSpec</strong> èƒ½è®©ä½ æ¸…æ™°éš”ç¦»æœ¬æ¬¡å˜æ›´çš„å½±å“èŒƒå›´ï¼Œé¿å… AI è¯¯æ”¹æ— å…³é€»è¾‘ã€‚</li>
<li>å¦‚æœä½ è¦<strong>ä»é›¶å¼€å§‹åšä¸€ä¸ªç…§ç‰‡æ•´ç†å·¥å…·</strong>ï¼Œä¸ç¡®å®šç”¨ React è¿˜æ˜¯ Svelteï¼Œæ•°æ®åº“é€‰ SQLite è¿˜æ˜¯ IndexedDBï¼Œ<strong>spec-kit</strong> èƒ½å¸®ä½ é€šè¿‡å¤šè½® <code>/plan</code> å’Œ <code>/tasks</code> æ¢ç´¢ä¸åŒæŠ€æœ¯æ ˆï¼Œå¹¶ç”Ÿæˆå®Œæ•´çš„æ¶æ„æ–‡æ¡£ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-9">æ€»ç»“ï¼šä¸æ˜¯æ›¿ä»£ï¼Œè€Œæ˜¯äº’è¡¥</h3>
<p>spec-kit åƒæ˜¯ä¸€ä½<strong>ç»éªŒä¸°å¯Œçš„æ¶æ„å¸ˆ</strong>ï¼Œæ“…é•¿ä»ç™½çº¸å¼€å§‹æ­å»ºä¸€åº§ç»“æ„ä¸¥è°¨çš„å¤§å¦ï¼›<br/>
OpenSpec åˆ™åƒä¸€ä½<strong>è°¨æ…çš„æ”¹é€ å·¥ç¨‹å¸ˆ</strong>ï¼Œä¸“æ³¨äºåœ¨ä¸ç ´ååŸæœ‰å»ºç­‘çš„å‰æä¸‹ï¼Œç²¾å‡†åµŒå…¥æ–°åŠŸèƒ½ã€‚</p>
<p>ä¸¤è€…éƒ½è¯•å›¾è§£å†³â€œAI ç¼–ç¨‹ç¼ºä¹ç¡®å®šæ€§â€çš„æ ¹æœ¬é—®é¢˜ï¼Œåªæ˜¯åˆ‡å…¥è§’åº¦ä¸åŒã€‚<br/>
å¯¹äºå¤§å¤šæ•°æ­£åœ¨ç»´æŠ¤çº¿ä¸Šç³»ç»Ÿçš„å›¢é˜Ÿè€Œè¨€ï¼Œ<strong>OpenSpec çš„å¢é‡å¼ã€ä½ä¾µå…¥ã€é«˜å¯è¿½æº¯ç‰¹æ€§ï¼Œå¯èƒ½æ›´å®¹æ˜“èå…¥ç°æœ‰ç ”å‘æµç¨‹</strong>ã€‚è€Œ spec-kit åˆ™åœ¨åˆ›æ–°æ¢ç´¢å’Œæ ‡å‡†åŒ–å¯åŠ¨é˜¶æ®µå±•ç°å‡ºå¼ºå¤§å¼•å¯¼åŠ›ã€‚</p>
<p>æ— è®ºé€‰æ‹©å“ªä¸€ç§ï¼Œå®ƒä»¬å…±åŒä¼ é€’äº†ä¸€ä¸ªä¿¡å·ï¼š<strong>æœªæ¥çš„é«˜æ•ˆå¼€å‘ï¼Œä¸å†æ˜¯è°å†™ä»£ç æ›´å¿«ï¼Œè€Œæ˜¯è°èƒ½æŠŠâ€œæ„å›¾â€è¡¨è¾¾å¾—æ›´æ¸…æ™°ã€æ›´ç»“æ„åŒ–ã€æ›´å¯éªŒè¯</strong>ã€‚</p>
<blockquote>
<p>æ­£å¦‚ spec-kit README æ‰€è¨€ï¼šâ€œSpecifications become executable, directly generating working implementations.â€<br/>
è€Œ OpenSpec åˆ™è¡¥å……é“ï¼šâ€œAnd every change to that specification must be reviewed, implemented, and archived â€” just like code.â€</p>
</blockquote>
<hr/>
<h3 data-id="heading-10">å†™åœ¨æœ€å</h3>
<p>AI ä¸ä¼šå–ä»£ç¨‹åºå‘˜ï¼Œä½†ä¼šé‡å¡‘å¼€å‘æµç¨‹ã€‚OpenSpec çš„å‡ºç°ï¼Œæ ‡å¿—ç€æˆ‘ä»¬æ­£ä»â€œè®© AI çŒœéœ€æ±‚â€èµ°å‘â€œä¸ AI å…±åŒå®šä¹‰éœ€æ±‚â€ã€‚</p>
<p>å®ƒä¸ç‚«æŠ€ï¼Œä¸å †æ¦‚å¿µï¼Œåªæ˜¯é»˜é»˜åœ¨ä»£ç ä¹‹å‰ï¼ŒåŠ äº†ä¸€é“â€œç¡®è®¤é”®â€ã€‚è€Œè¿™ï¼Œæˆ–è®¸æ­£æ˜¯å¯æ§ã€å¯é ã€å¯åä½œçš„ AI ç¼–ç¨‹æ—¶ä»£çœŸæ­£å¼€å§‹çš„åœ°æ–¹ã€‚</p>
<blockquote>
<p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FFission-AI%2FOpenSpec" target="_blank" title="https://github.com/Fission-AI/OpenSpec" ref="nofollow noopener noreferrer">github.com/Fission-AI/â€¦</a><br/>
<strong>æ¨èå°è¯•</strong>ï¼šåœ¨ä¸‹ä¸€ä¸ªåŠŸèƒ½å¼€å‘å‰ï¼Œå…ˆè¿è¡Œ <code>openspec init</code> â€”â€” ä½ å¯èƒ½ä¼šæƒŠè®¶äºï¼Œå½“ AI çœŸæ­£â€œæ‡‚ä½ â€æ—¶ï¼Œæ•ˆç‡èƒ½æœ‰å¤šé«˜ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¡ºåºè¡¨ä¸é“¾è¡¨ï¼šå¤´æ’æ³•ä¸å°¾æ’æ³•è¯¦è§£]]></title>    <link>https://juejin.cn/post/7583344281735151662</link>    <guid>https://juejin.cn/post/7583344281735151662</guid>    <pubDate>2025-12-14T07:47:31.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583344281735151662" data-draft-id="7582207260199698486" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¡ºåºè¡¨ä¸é“¾è¡¨ï¼šå¤´æ’æ³•ä¸å°¾æ’æ³•è¯¦è§£"/> <meta itemprop="keywords" content="æ•°æ®ç»“æ„,Cè¯­è¨€,C++"/> <meta itemprop="datePublished" content="2025-12-14T07:47:31.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°çŒªçŒªå±"/> <meta itemprop="url" content="https://juejin.cn/user/495244328305367"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¡ºåºè¡¨ä¸é“¾è¡¨ï¼šå¤´æ’æ³•ä¸å°¾æ’æ³•è¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/495244328305367/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°çŒªçŒªå±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T07:47:31.000Z" title="Sun Dec 14 2025 07:47:31 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    4
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0"><strong>ä¸€ã€å‰è¨€</strong></h2>
<p>åœ¨ç¨‹åºä¸–ç•Œé‡Œï¼Œæ•°æ®ç»“æ„æœ¬è´¨ä¸Šæ˜¯ä¸€ç§<strong>æ•°æ®å­˜å‚¨ä¸ç»„ç»‡ç­–ç•¥</strong>ã€‚</p>
<h3 data-id="heading-1">é¡ºåºè¡¨ï¼ˆArrayï¼‰ï¼šåƒå·¥å‚æµæ°´çº¿</h3>
<p>é¡ºåºè¡¨å¯ä»¥ç±»æ¯”ä¸ºä¸€æ¡å·¥å‚æµæ°´çº¿ï¼Œæ‰€æœ‰ç‰©å“æŒ‰ç…§é¡ºåºæ”¾åœ¨<strong>è¿ç»­ä¸”å›ºå®šçš„ä½ç½®</strong>ä¸Šã€‚</p>
<ul>
<li>æ¯ä¸ªä½ç½®éƒ½å¯ä»¥é€šè¿‡ç¼–å·ç›´æ¥è®¿é—®</li>
<li>æƒ³è¦è·å–ç¬¬ N ä¸ªå…ƒç´ ï¼Œå‡ ä¹æ˜¯ç¬é—´å®Œæˆï¼ˆéšæœºè®¿é—®æ•ˆç‡é«˜ï¼‰</li>
<li>ä½†å¦‚æœåœ¨ä¸­é—´æ’å…¥æˆ–åˆ é™¤å…ƒç´ ï¼Œåé¢çš„ç‰©å“å°±å¿…é¡»æ•´ä½“æ¬åŠ¨ï¼Œä»£ä»·è¾ƒé«˜</li>
</ul>
<blockquote>
<p>ğŸ‘‰ å®ƒçš„ä¼˜åŠ¿åœ¨äº<strong>æŸ¥æ‰¾å¿«</strong>ï¼ŒåŠ£åŠ¿åœ¨äº<strong>æ’å…¥å’Œåˆ é™¤ä¸çµæ´»</strong>ã€‚</p>
</blockquote>
<h3 data-id="heading-2">é“¾è¡¨ï¼ˆLinked Listï¼‰ï¼šåƒä¸€åˆ—ç«è½¦</h3>
<p>é“¾è¡¨æ›´åƒæ˜¯ä¸€åˆ—ç«è½¦ï¼Œæ¯èŠ‚è½¦å¢åªçŸ¥é“<strong>ä¸‹ä¸€èŠ‚è½¦å¢çš„ä½ç½®</strong>ï¼Œè€Œä¸æ˜¯æ•´ä½“çš„ç¼–å·é¡ºåºã€‚</p>
<ul>
<li>æŸ¥æ‰¾æŸä¸€èŠ‚è½¦å¢æ—¶ï¼Œå¿…é¡»ä»è½¦å¤´ä¸€èŠ‚ä¸€èŠ‚å‘åèµ°</li>
<li>è½¦å¢ä¹‹é—´é€šè¿‡â€œè¿æ¥å…³ç³»â€ä¸²è”ï¼Œè€Œä¸æ˜¯è¿ç»­æ‘†æ”¾</li>
<li>ä¸€æ—¦æ‰¾åˆ°ç›®æ ‡ä½ç½®ï¼Œæ’å…¥æˆ–åˆ é™¤è½¦å¢åªéœ€è¦ä¿®æ”¹è¿æ¥å…³ç³»ï¼Œä¸å½±å“å…¶ä»–è½¦å¢</li>
</ul>
<blockquote>
<p>ğŸ‘‰ å®ƒçš„ä¼˜åŠ¿åœ¨äº<strong>å·²çŸ¥ä½ç½®æ—¶æ’å…¥ã€åˆ é™¤é«˜æ•ˆ</strong>ï¼ŒåŠ£åŠ¿åœ¨äº<strong>æŸ¥æ‰¾æ•ˆç‡ä½</strong>ã€‚</p>
</blockquote>
<h2 data-id="heading-3">äºŒã€ä»€ä¹ˆæ˜¯å¤´æ’æ³•å’Œå°¾æ’æ³•ï¼Ÿ</h2>
<p>åœ¨æ•°æ®ç»“æ„ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å‘å·²æœ‰çš„æ•°æ®ç»“æ„ä¸­æ·»åŠ æ–°å…ƒç´ ã€‚æ ¹æ®æ’å…¥çš„ä½ç½®ä¸åŒï¼Œå¸¸è§æœ‰ä¸¤ç§æ–¹å¼ï¼š<strong>å¤´æ’æ³•</strong>å’Œ<strong>å°¾æ’æ³•</strong>ã€‚</p>
<h3 data-id="heading-4">å¤´æ’æ³•ï¼ˆHead Insertionï¼‰</h3>
<p><strong>æ¦‚å¿µ</strong>ï¼šå°†æ–°å…ƒç´ æ’å…¥åˆ°æ•°æ®ç»“æ„çš„<strong>æœ€å‰é¢</strong>ã€‚<br/>
<strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>æ–°å…ƒç´ æ€»æ˜¯æˆä¸ºâ€œç¬¬ä¸€ä¸ªå…ƒç´ â€ï¼ŒåŸæ¥çš„å…ƒç´ å¾€åé¡ºå»¶<br/></li>
<li>å¯¹é“¾è¡¨æ¥è¯´ï¼Œåªéœ€æ”¹å˜å¤´ç»“ç‚¹çš„æŒ‡é’ˆå³å¯ï¼Œæ“ä½œé«˜æ•ˆ<br/></li>
<li>å¯¹é¡ºåºè¡¨æ¥è¯´ï¼Œéœ€è¦å°†æ•°ç»„ä¸­å·²æœ‰çš„å…ƒç´ æ•´ä½“å‘åç§»åŠ¨ï¼Œæ•ˆç‡è¾ƒä½</li>
</ul>
<h3 data-id="heading-5">å°¾æ’æ³•ï¼ˆTail Insertionï¼‰</h3>
<p><strong>æ¦‚å¿µ</strong>ï¼šå°†æ–°å…ƒç´ æ’å…¥åˆ°æ•°æ®ç»“æ„çš„<strong>æœ«å°¾</strong>ã€‚<br/>
<strong>ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>æ–°å…ƒç´ æ’åœ¨å·²æœ‰å…ƒç´ ä¹‹åï¼Œé¡ºåºä¸è¾“å…¥ä¸€è‡´</li>
<li>é“¾è¡¨éœ€è¦ç»´æŠ¤å°¾æŒ‡é’ˆæ‰èƒ½é«˜æ•ˆæ’å…¥</li>
<li>é¡ºåºè¡¨ç›´æ¥åœ¨æ•°ç»„æœ«å°¾æ”¾ç½®æ–°å…ƒç´ ï¼Œæ•ˆç‡é«˜</li>
</ul>
<h3 data-id="heading-6">æ€»ç»“</h3>
<blockquote>
<p>ç†è§£å¤´æ’æ³•å’Œå°¾æ’æ³•çš„æœ¬è´¨ï¼Œå°±æ˜¯<strong>æ˜ç¡®æ–°å…ƒç´ æ’å…¥çš„ä½ç½®</strong>å’Œ<strong>å¯¹æ•°æ®é¡ºåºçš„å½±å“</strong>ï¼Œå†å»é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„å’Œæ“ä½œæ–¹æ³•ã€‚</p>
</blockquote>


























<table><thead><tr><th>æ’å…¥æ–¹å¼</th><th>æ’å…¥ä½ç½®</th><th>é¡ºåºæ•ˆæœ</th><th>æ“ä½œå¤æ‚åº¦ï¼ˆé“¾è¡¨ï¼‰</th><th>æ“ä½œå¤æ‚åº¦ï¼ˆé¡ºåºè¡¨ï¼‰</th></tr></thead><tbody><tr><td>å¤´æ’æ³•</td><td>å‰é¢</td><td>è¾“å…¥é€†åº</td><td>O(1)</td><td>O(n)</td></tr><tr><td>å°¾æ’æ³•</td><td>åé¢</td><td>è¾“å…¥é¡ºåº</td><td>O(1)</td><td>O(1)</td></tr></tbody></table>
<h2 data-id="heading-7">ä¸‰ã€é¡ºåºè¡¨çš„å¤´æ’æ³•ä¸å°¾æ’æ³•</h2>
<p>é¡ºåºè¡¨ï¼ˆArrayï¼‰æ˜¯ç”¨æ•°ç»„å®ç°çš„æ•°æ®ç»“æ„ï¼Œå…ƒç´ åœ¨å†…å­˜ä¸­è¿ç»­å­˜å‚¨ã€‚å®ƒçš„æ’å…¥æ–¹å¼å—å­˜å‚¨æ–¹å¼é™åˆ¶ï¼Œå¤´æ’æ³•å’Œå°¾æ’æ³•çš„å®ç°æ–¹å¼æœ‰æ‰€ä¸åŒã€‚</p>
<h3 data-id="heading-8">é¡ºåºè¡¨å¤´æ’æ³•</h3>
<p><strong>åŸç†</strong>ï¼š</p>
<ul>
<li>æ–°å…ƒç´ æ’å…¥æ•°ç»„å¼€å¤´ <code>L.data[0]</code></li>
<li>åŸæœ‰å…ƒç´ æ•´ä½“å‘åç§»åŠ¨ä¸€ä½</li>
<li>æ’å…¥åï¼Œé¡ºåºè¡¨é•¿åº¦ <code>L.length</code> åŠ  1</li>
</ul>
<p><strong>æ­¥éª¤</strong>ï¼š</p>
<ol>
<li>åˆå§‹åŒ–é¡ºåºè¡¨ï¼Œè®¾ç½®é•¿åº¦ä¸º 0ã€‚</li>
<li>å¾ªç¯è¾“å…¥æ•°æ®ï¼Œç›´åˆ°é‡åˆ°ç»“æŸæ ‡è¯†ç¬¦ï¼ˆå¦‚ <code>9999</code>ï¼‰ã€‚</li>
<li>æ¯æ¬¡æ–°å…ƒç´ æ’å…¥æ•°ç»„é¦–ä½ <code>L.data[0]</code>ã€‚</li>
<li>å°†åŸæœ‰å…ƒç´ æ•´ä½“åç§»ï¼Œä¿æŒé¡ºåºå®Œæ•´ã€‚</li>
<li><code>L.length++</code>ï¼Œè¡¨ç¤ºé¡ºåºè¡¨é•¿åº¦å¢åŠ ã€‚</li>
</ol>
<h4 data-id="heading-9">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXSIZE 100</span>

<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> {
    <span class="hljs-type">int</span> data[MAXSIZE];
    <span class="hljs-type">int</span> length;
} SqList;

<span class="hljs-comment">// æ‰“å°é¡ºåºè¡¨</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printList</span><span class="hljs-params">(SqList L)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; L.length; i++) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, L.data[i]);
        <span class="hljs-keyword">if</span> (i != L.length - <span class="hljs-number">1</span>) {
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">" "</span>);
        }
    }
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
}
<span class="hljs-comment">// é¡ºåºè¡¨-å¤´æ’æ³•</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    SqList L;
    L.length = <span class="hljs-number">0</span>;
    <span class="hljs-type">int</span> n;
    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n) != <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;   <span class="hljs-comment">// è¾“å…¥å¼‚å¸¸</span>
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">9999</span>) <span class="hljs-keyword">break</span>;              <span class="hljs-comment">// ç‰¹æ®Šç»“æŸæ ‡å¿—</span>
        <span class="hljs-keyword">if</span> (L.length &gt;= MAXSIZE) { <span class="hljs-comment">// è¶Šç•Œæ£€æŸ¥</span>
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"é¡ºåºè¡¨å·²æ»¡ï¼Œæ— æ³•æ’å…¥æ›´å¤šå…ƒç´ ï¼\n"</span>);
            <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-comment">// å°†å·²æœ‰å…ƒç´ åç§»</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = L.length; j &gt; <span class="hljs-number">0</span>; j--) {
            L.data[j] = L.data[j - <span class="hljs-number">1</span>];
        }
        L.data[<span class="hljs-number">0</span>] = n;
        L.length++;
    }
    <span class="hljs-built_in">printList</span>(L);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-10">é¡ºåºè¡¨å°¾æ’æ³•</h3>
<p><strong>åŸç†</strong></p>
<ul>
<li>æ–°å…ƒç´ æ”¾åœ¨æ•°ç»„ä¸­å½“å‰æœ€åä¸€ä¸ªæœ‰æ•ˆä½ç½® <code>L.data[L.length]</code></li>
<li>æ’å…¥åï¼Œé¡ºåºè¡¨é•¿åº¦ <code>L.length</code> åŠ  1</li>
</ul>
<p><strong>æ­¥éª¤</strong>ï¼š</p>
<ol>
<li>åˆå§‹åŒ–é¡ºåºè¡¨ï¼Œè®¾ç½®é•¿åº¦ä¸º 0ã€‚</li>
<li>å¾ªç¯è¾“å…¥æ•°æ®ï¼Œç›´åˆ°é‡åˆ°ç»“æŸæ ‡è¯†ç¬¦ï¼ˆå¦‚ <code>9999</code>ï¼‰ã€‚</li>
<li>æ¯æ¬¡æ–°å…ƒç´ æ”¾åˆ° <code>L.data[L.length]</code> ä½ç½®ã€‚</li>
<li><code>L.length++</code>ï¼Œè¡¨ç¤ºé¡ºåºè¡¨é•¿åº¦å¢åŠ ã€‚</li>
</ol>
<h4 data-id="heading-11">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">define</span> MAXSIZE 100</span>

<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> {
    <span class="hljs-type">int</span> data[MAXSIZE];
    <span class="hljs-type">int</span> length;
} SqList;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printList</span><span class="hljs-params">(SqList L)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; L.length; i++) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, L.data[i]);
        <span class="hljs-keyword">if</span> (i != L.length - <span class="hljs-number">1</span>) {
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">" "</span>);
        }
    }
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
}

<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    SqList L;
    L.length = <span class="hljs-number">0</span>;
    <span class="hljs-type">int</span> n;

    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n) != <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;   <span class="hljs-comment">// è¾“å…¥å¼‚å¸¸</span>
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">9999</span>) <span class="hljs-keyword">break</span>;              <span class="hljs-comment">// ç‰¹æ®Šç»“æŸæ ‡å¿—</span>
        <span class="hljs-keyword">if</span> (L.length &gt;= MAXSIZE) {         <span class="hljs-comment">// è¶Šç•Œæ£€æŸ¥</span>
            <span class="hljs-built_in">printf</span>(<span class="hljs-string">"é¡ºåºè¡¨å·²æ»¡ï¼Œæ— æ³•æ’å…¥æ›´å¤šå…ƒç´ ï¼\n"</span>);
            <span class="hljs-keyword">break</span>;
        }

        <span class="hljs-comment">// å°¾æ’æ³•ï¼šç›´æ¥æ”¾åœ¨æ•°ç»„æœ«å°¾</span>
        L.data[L.length] = n;
        L.length++;
    }

    <span class="hljs-built_in">printList</span>(L);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-12">å››ã€é¡ºåºè¡¨çš„å¤´æ’æ³•ä¸å°¾æ’æ³•</h2>
<h3 data-id="heading-13">é“¾è¡¨å¤´æ’æ³•</h3>
<p><strong>åŸç†</strong></p>
<ul>
<li>æ–°ç»“ç‚¹æ’å…¥é“¾è¡¨å¤´éƒ¨ï¼ˆå¤´ç»“ç‚¹åï¼‰ï¼ŒåŸæœ‰é“¾è¡¨é€šè¿‡æŒ‡é’ˆè‡ªåŠ¨è¡”æ¥</li>
<li>æ’å…¥åï¼Œé“¾è¡¨é•¿åº¦å¢åŠ </li>
<li>å¤´æ’æ³•ä¼šå¯¼è‡´æœ€ç»ˆé“¾è¡¨é¡ºåºä¸è¾“å…¥é¡ºåºç›¸å</li>
</ul>
<p><strong>æ­¥éª¤</strong></p>
<ol>
<li>åˆå§‹åŒ–å¸¦å¤´ç»“ç‚¹çš„é“¾è¡¨ï¼Œå¤´ç»“ç‚¹ <code>L</code> æŒ‡é’ˆç½®ç©ºæˆ– <code>next = NULL</code></li>
<li>å¾ªç¯è¾“å…¥æ•°æ®ï¼Œç›´åˆ°é‡åˆ°ç»“æŸæ ‡è¯†ç¬¦ï¼ˆå¦‚ <code>9999</code>ï¼‰</li>
<li>æ¯æ¬¡æ–°å»ºç»“ç‚¹ <code>p</code></li>
<li>å°†æ–°ç»“ç‚¹ <code>p-&gt;next</code> æŒ‡å‘åŸé“¾è¡¨ç¬¬ä¸€ä¸ªç»“ç‚¹ <code>L-&gt;next</code></li>
<li>å¤´ç»“ç‚¹ <code>L-&gt;next</code> æŒ‡å‘æ–°ç»“ç‚¹ <code>p</code></li>
</ol>
<h4 data-id="heading-14">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>

<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">LNode</span> {
    <span class="hljs-type">int</span> data;
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">LNode</span> *next;
} LNode, *LinkList;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printList</span><span class="hljs-params">(LinkList L)</span> </span>{
    L = L-&gt;next;  <span class="hljs-comment">// è·³è¿‡å¤´ç»“ç‚¹</span>
    <span class="hljs-keyword">while</span> (L != <span class="hljs-literal">NULL</span>) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, L-&gt;data);
        <span class="hljs-keyword">if</span> (L-&gt;next != <span class="hljs-literal">NULL</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">" "</span>);
        L = L-&gt;next;
    }
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
}
<span class="hljs-comment">// é“¾è¡¨-å¤´æ’æ³•</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    LinkList L = (LinkList)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(LNode)); <span class="hljs-comment">// å¤´ç»“ç‚¹</span>
    L-&gt;next = <span class="hljs-literal">NULL</span>;
    <span class="hljs-type">int</span> n;

    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n) != <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;    <span class="hljs-comment">// è¾“å…¥å¼‚å¸¸</span>
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">9999</span>) <span class="hljs-keyword">break</span>;   <span class="hljs-comment">// ç‰¹æ®Šç»“æŸæ ‡å¿—</span>
        LinkList p = (LinkList)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(LNode));
        p-&gt;data = n;
        p-&gt;next = L-&gt;next;
        L-&gt;next = p;
    }

    <span class="hljs-built_in">printList</span>(L);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 data-id="heading-15">é“¾è¡¨å°¾æ’æ³•</h3>
<p><strong>åŸç†</strong></p>
<ul>
<li>æ–°ç»“ç‚¹æ’å…¥é“¾è¡¨å°¾éƒ¨ï¼Œé€šè¿‡å°¾æŒ‡é’ˆ <code>tail</code> ç»´æŠ¤é“¾è¡¨æœ«ç«¯</li>
<li>æ’å…¥åï¼Œé“¾è¡¨é•¿åº¦å¢åŠ </li>
<li>å°¾æ’æ³•ä¿æŒè¾“å…¥é¡ºåºä¸é“¾è¡¨é¡ºåºä¸€è‡´</li>
</ul>
<p><strong>æ­¥éª¤</strong></p>
<ol>
<li>åˆå§‹åŒ–å¸¦å¤´ç»“ç‚¹çš„é“¾è¡¨ï¼Œå¤´ç»“ç‚¹ <code>L</code> æŒ‡é’ˆç½®ç©ºæˆ– <code>next = NULL</code></li>
<li>è®¾ç½®å°¾æŒ‡é’ˆ <code>tail = L</code></li>
<li>å¾ªç¯è¾“å…¥æ•°æ®ï¼Œç›´åˆ°é‡åˆ°ç»“æŸæ ‡è¯†ç¬¦ï¼ˆå¦‚ <code>9999</code>ï¼‰</li>
<li>æ¯æ¬¡æ–°å»ºç»“ç‚¹ <code>p</code>ï¼Œ<code>p-&gt;next = NULL</code></li>
<li>å°¾æŒ‡é’ˆ <code>tail-&gt;next</code> æŒ‡å‘æ–°ç»“ç‚¹ <code>p</code></li>
<li>æ›´æ–°å°¾æŒ‡é’ˆ <code>tail = p</code></li>
</ol>
<h4 data-id="heading-16">ä»£ç ç¤ºä¾‹</h4>
<pre><code class="hljs language-c++" lang="c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>

<span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">LNode</span> {
    <span class="hljs-type">int</span> data;
    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">LNode</span> *next;
} LNode, *LinkList;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">printList</span><span class="hljs-params">(LinkList L)</span> </span>{
    L = L-&gt;next;  <span class="hljs-comment">// è·³è¿‡å¤´ç»“ç‚¹</span>
    <span class="hljs-keyword">while</span> (L != <span class="hljs-literal">NULL</span>) {
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d"</span>, L-&gt;data);
        <span class="hljs-keyword">if</span> (L-&gt;next != <span class="hljs-literal">NULL</span>) <span class="hljs-built_in">printf</span>(<span class="hljs-string">" "</span>);
        L = L-&gt;next;
    }
    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);
}

<span class="hljs-comment">// é“¾è¡¨-å°¾æ’æ³•</span>
<span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{
    LinkList L = (LinkList)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(LNode)); <span class="hljs-comment">// å¤´ç»“ç‚¹</span>
    L-&gt;next = <span class="hljs-literal">NULL</span>;
    LinkList tail = L; <span class="hljs-comment">// å°¾æŒ‡é’ˆåˆå§‹åŒ–ä¸ºå¤´ç»“ç‚¹</span>
    <span class="hljs-type">int</span> n;

    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>) {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">scanf</span>(<span class="hljs-string">"%d"</span>, &amp;n) != <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// è¾“å…¥å¼‚å¸¸</span>
        <span class="hljs-keyword">if</span> (n == <span class="hljs-number">9999</span>) <span class="hljs-keyword">break</span>;             <span class="hljs-comment">// ç‰¹æ®Šç»“æŸæ ‡å¿—</span>

        LinkList p = (LinkList)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(LNode));
        p-&gt;data = n;
        p-&gt;next = <span class="hljs-literal">NULL</span>;

        <span class="hljs-comment">// å°¾æ’æ³•</span>
        tail-&gt;next = p;
        tail = p;
    }

    <span class="hljs-built_in">printList</span>(L);
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h2 data-id="heading-17">æ€»ç»“</h2>
<p>å¤´æ’æ³•å’Œå°¾æ’æ³•æ˜¯é¡ºåºè¡¨ä¸é“¾è¡¨ä¸­æœ€åŸºç¡€çš„æ’å…¥æ“ä½œï¼Œå®ƒä»¬ä½“ç°äº†ä¸åŒæ•°æ®ç»“æ„çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>é¡ºåºè¡¨</strong>ä¾èµ–è¿ç»­å†…å­˜ï¼Œå¤´æ’éœ€è¦ç§»åŠ¨å…ƒç´ ï¼Œå°¾æ’æ•ˆç‡é«˜ï¼›</li>
<li><strong>é“¾è¡¨</strong>é€šè¿‡æŒ‡é’ˆè¿æ¥ï¼Œæ’å…¥çµæ´»ï¼Œå¤´æ’é€†åºæ„å»ºï¼Œå°¾æ’é¡ºåºæ„å»ºï¼›</li>
<li><strong>é€‰æ‹©åŸåˆ™</strong>ï¼šæ ¹æ®æ˜¯å¦éœ€è¦ä¿æŒè¾“å…¥é¡ºåºã€æ˜¯å¦é¢‘ç¹åœ¨å¼€å¤´æ’å…¥ã€ä»¥åŠæ•ˆç‡è¦æ±‚æ¥é€‰æ‹©é€‚åˆçš„æ–¹æ³•ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[RSA çš„æ ¸å¿ƒåŸç†]]></title>    <link>https://juejin.cn/post/7582997593090244627</link>    <guid>https://juejin.cn/post/7582997593090244627</guid>    <pubDate>2025-12-14T08:14:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582997593090244627" data-draft-id="7582904081864491049" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="RSA çš„æ ¸å¿ƒåŸç†"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2025-12-14T08:14:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°è™ç‰™007"/> <meta itemprop="url" content="https://juejin.cn/user/3940246036155640"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            RSA çš„æ ¸å¿ƒåŸç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3940246036155640/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°è™ç‰™007
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:14:43.000Z" title="Sun Dec 14 2025 08:14:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>RSA çš„æ•°å­¦åŸç†æœ¬è´¨æ˜¯<strong>ä¸‰å¤§æ•°å­¦åŸºçŸ³</strong>ï¼š<strong>è´¨æ•°åˆ†è§£éš¾é¢˜</strong>ã€<strong>æ¬§æ‹‰å®šç†</strong>ã€<strong>æ¨¡é€†å…ƒ</strong>ã€‚</p>
<p>ä¸‹é¢ç”¨ã€Œå…¬å¼ + æ­¥éª¤ + ä¾‹å­ã€çš„æ–¹å¼ï¼Œä¸€æ­¥æ­¥æ‹†è§£ï¼Œå…¨ç¨‹ä¸è·³å…³é”®é€»è¾‘ï¼Œä¿è¯ä½ èƒ½çœ‹æ‡‚ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€å…ˆæ˜ç¡® 3 ä¸ªæ ¸å¿ƒæ•°å­¦æ¦‚å¿µï¼ˆå¿…é¡»æ‡‚ï¼‰</h3>
<p>åœ¨è®² RSA ä¹‹å‰ï¼Œå…ˆææ‡‚è¿™ 3 ä¸ªåŸºç¡€ï¼Œå¦åˆ™åé¢ä¼šæ‡µï¼š</p>
<ol>
<li>
<p><strong>è´¨æ•°ï¼ˆç´ æ•°ï¼‰</strong> ï¼šåªèƒ½è¢« 1 å’Œè‡ªèº«æ•´é™¤çš„æ•°ï¼Œæ¯”å¦‚Â <code>2,3,5,7,11...</code>ã€‚</p>
</li>
<li>
<p><strong>æ¬§æ‹‰å‡½æ•° Ï†(n)</strong> ï¼š</p>
<ul>
<li>å®šä¹‰ï¼šå°äºÂ <code>n</code>Â ä¸”ä¸Â <code>n</code>Â <strong>äº’è´¨</strong>ï¼ˆæœ€å¤§å…¬çº¦æ•°ä¸º 1ï¼‰çš„æ­£æ•´æ•°çš„ä¸ªæ•°ã€‚</li>
<li>å…³é”®æ€§è´¨ï¼šè‹¥Â <code>n = pÃ—q</code>ï¼ˆ<code>p</code>ã€<code>q</code>Â æ˜¯ä¸ç›¸ç­‰çš„è´¨æ•°ï¼‰ï¼Œåˆ™Â <code>Ï†(n) = (p-1)Ã—(q-1)</code>ã€‚ä¾‹ï¼š<code>p=3, q=5 â†’ n=15 â†’ Ï†(15)=(3-1)Ã—(5-1)=8</code>ï¼ˆéªŒè¯ï¼š1,2,4,7,8,11,13,14 å…± 8 ä¸ªï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ¨¡é€†å…ƒ</strong>ï¼š</p>
<ul>
<li>å®šä¹‰ï¼šå¯¹äºæ•´æ•°Â <code>a</code>Â å’ŒÂ <code>m</code>ï¼Œå¦‚æœå­˜åœ¨æ•´æ•°Â <code>b</code>ï¼Œä½¿å¾—Â <code>(aÃ—b) mod m = 1</code>ï¼Œåˆ™Â <code>b</code>Â æ˜¯Â <code>a</code>Â çš„æ¨¡Â <code>m</code>Â é€†å…ƒã€‚</li>
<li>å­˜åœ¨æ¡ä»¶ï¼š<code>a</code>Â å’ŒÂ <code>m</code>Â <strong>äº’è´¨</strong>ã€‚ä¾‹ï¼š<code>a=3, m=10 â†’ 3Ã—7=21 â†’ 21 mod 10=1 â†’ 7 æ˜¯ 3 çš„æ¨¡ 10 é€†å…ƒ</code>ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-1">äºŒã€RSA å¯†é’¥ç”Ÿæˆçš„ 5 ä¸ªæ­¥éª¤ï¼ˆæ ¸å¿ƒï¼‰</h3>
<p>RSA çš„å¯†é’¥å¯¹ï¼ˆå…¬é’¥ + ç§é’¥ï¼‰å°±æ˜¯é€šè¿‡è¿™ 5 æ­¥ç®—å‡ºæ¥çš„ï¼Œæˆ‘ä»¬ç”¨<strong>å°è´¨æ•°ä¸¾ä¾‹</strong>ï¼ˆå®é™…ç”¨å‡ ç™¾ä½çš„å¤§è´¨æ•°ï¼‰ã€‚</p>
<h4 data-id="heading-2">æ­¥éª¤ 1ï¼šé€‰ä¸¤ä¸ªä¸ç›¸ç­‰çš„å¤§è´¨æ•°Â <code>p</code>Â å’ŒÂ <code>q</code></h4>
<p>ä¸ºäº†æ–¹ä¾¿è®¡ç®—ï¼Œæˆ‘ä»¬é€‰å°è´¨æ•°ï¼š<code>p = 61</code>ï¼Œ<code>q = 53</code>ï¼ˆå®é™…åœºæ™¯ä¸­Â <code>p</code>Â å’ŒÂ <code>q</code>Â æ˜¯å‡ ç™¾ä½çš„è´¨æ•°ï¼Œç›¸ä¹˜åçš„Â <code>n</code>Â æ˜¯å‡ ç™¾ä½çš„å¤§æ•°ï¼‰</p>
<h4 data-id="heading-3">æ­¥éª¤ 2ï¼šè®¡ç®—Â <code>n = p Ã— q</code>ï¼ˆå…¬é’¥çš„æ ¸å¿ƒå‚æ•°ï¼‰</h4>
<p><code>n = 61 Ã— 53 = 3233</code></p>
<ul>
<li><code>n</code>Â çš„ä½œç”¨ï¼šä½œä¸º<strong>æ¨¡</strong>ï¼Œå…¬é’¥å’Œç§é’¥éƒ½éœ€è¦å®ƒï¼Œæ˜¯å…¬å¼€çš„ã€‚</li>
<li>å®‰å…¨æ€§å…³é”®ï¼šç ´è§£ RSA å¿…é¡»ä»Â <code>n</code>Â åæ¨å‡ºÂ <code>p</code>Â å’ŒÂ <code>q</code>ï¼Œä½†å¤§æ•°åˆ†è§£æéš¾ã€‚</li>
</ul>
<h4 data-id="heading-4">æ­¥éª¤ 3ï¼šè®¡ç®—æ¬§æ‹‰å‡½æ•°Â <code>Ï†(n) = (p-1) Ã— (q-1)</code></h4>
<p><code>Ï†(3233) = (61-1) Ã— (53-1) = 60 Ã— 52 = 3120</code></p>
<ul>
<li><code>Ï†(n)</code>Â æ˜¯<strong>ç§æœ‰çš„</strong>ï¼Œç»å¯¹ä¸èƒ½å…¬å¼€ã€‚</li>
</ul>
<h4 data-id="heading-5">æ­¥éª¤ 4ï¼šé€‰ä¸€ä¸ªæ•´æ•°Â <code>e</code>ï¼Œæ»¡è¶³ä¸¤ä¸ªæ¡ä»¶</h4>
<ol>
<li><code>1 &lt; e &lt; Ï†(n)</code></li>
<li><code>e</code>Â å’ŒÂ <code>Ï†(n)</code>Â <strong>äº’è´¨</strong>ï¼ˆæœ€å¤§å…¬çº¦æ•°ä¸º 1ï¼‰</li>
</ol>
<p>æˆ‘ä»¬é€‰Â <code>e = 17</code>ï¼ˆè¡Œä¸šå¸¸ç”¨Â <code>e=65537</code>ï¼Œæ˜¯å›ºå®šå€¼ï¼‰éªŒè¯ï¼š<code>gcd(17, 3120) = 1</code>ï¼ˆäº’è´¨ï¼Œç¬¦åˆæ¡ä»¶ï¼‰</p>
<ul>
<li><code>e</code>Â æ˜¯<strong>å…¬é’¥çš„å¦ä¸€ä¸ªæ ¸å¿ƒå‚æ•°</strong>ï¼Œå’ŒÂ <code>n</code>Â ä¸€èµ·ç»„æˆå…¬é’¥Â <code>(e, n)</code>ã€‚</li>
</ul>
<h4 data-id="heading-6">æ­¥éª¤ 5ï¼šè®¡ç®—Â <code>e</code>Â çš„æ¨¡Â <code>Ï†(n)</code>Â é€†å…ƒÂ <code>d</code>ï¼ˆç§é’¥æ ¸å¿ƒå‚æ•°ï¼‰</h4>
<p>æ‰¾ä¸€ä¸ªæ•´æ•°Â <code>d</code>ï¼Œæ»¡è¶³Â <code>(e Ã— d) mod Ï†(n) = 1</code>ä»£å…¥æ•°å€¼ï¼š<code>(17 Ã— d) mod 3120 = 1</code>é€šè¿‡è®¡ç®—å¯å¾—Â <code>d = 2753</code>ï¼ˆéªŒè¯ï¼š<code>17Ã—2753=46801 â†’ 46801 mod 3120 = 1</code>ï¼Œç¬¦åˆæ¡ä»¶ï¼‰</p>
<ul>
<li><code>d</code>Â æ˜¯<strong>ç§é’¥çš„æ ¸å¿ƒå‚æ•°</strong>ï¼Œå’ŒÂ <code>n</code>Â ä¸€èµ·ç»„æˆç§é’¥Â <code>(d, n)</code>ï¼Œç»å¯¹ä¿å¯†ã€‚</li>
</ul>
<h4 data-id="heading-7">æœ€ç»ˆå¯†é’¥å¯¹</h4>
<ul>
<li>å…¬é’¥Â <code>(e, n) = (17, 3233)</code>Â â†’ å…¬å¼€ç»™æ‰€æœ‰äºº</li>
<li>ç§é’¥Â <code>(d, n) = (2753, 3233)</code>Â â†’ è‡ªå·±ä¿ç®¡ï¼Œç»ä¸æ³„éœ²</li>
</ul>
<h3 data-id="heading-8">ä¸‰ã€RSA åŠ å¯†å’Œè§£å¯†çš„æ•°å­¦å…¬å¼</h3>
<p>RSA çš„åŠ å¯†å’Œè§£å¯†éƒ½æ˜¯<strong>æ¨¡å¹‚è¿ç®—</strong>ï¼Œå…¬å¼éå¸¸ç®€æ´ï¼š</p>
<ul>
<li>æ˜æ–‡ï¼š<code>m</code>ï¼ˆè¦åŠ å¯†çš„æ•°æ®ï¼Œå¿…é¡»Â <code>m &lt; n</code>ï¼‰</li>
<li>å¯†æ–‡ï¼š<code>c</code>ï¼ˆåŠ å¯†åçš„æ•°æ®ï¼‰</li>
</ul>
<h4 data-id="heading-9">1. åŠ å¯†ï¼ˆç”¨å…¬é’¥Â <code>(e, n)</code>ï¼‰</h4>
<p><code>c = m^e mod n</code></p>
<ul>
<li>ä»»ä½•äººéƒ½èƒ½ç”¨å…¬é’¥åŠ å¯†ï¼Œä½†åªæœ‰ç§é’¥èƒ½è§£å¯†ã€‚</li>
</ul>
<h4 data-id="heading-10">2. è§£å¯†ï¼ˆç”¨ç§é’¥Â <code>(d, n)</code>ï¼‰</h4>
<p><code>m = c^d mod n</code></p>
<ul>
<li>åªæœ‰æŒæœ‰ç§é’¥çš„äººï¼Œæ‰èƒ½ç®—å‡ºæ˜æ–‡ã€‚</li>
</ul>
<h3 data-id="heading-11">å››ã€å®é™…ä¸¾ä¾‹ï¼šåŠ å¯†è§£å¯†å…¨è¿‡ç¨‹</h3>
<p>æˆ‘ä»¬ç”¨ä¸Šé¢çš„å¯†é’¥å¯¹ï¼ŒåŠ å¯†æ˜æ–‡Â <code>m = 65</code>ï¼ˆæ¯”å¦‚ 65 å¯¹åº”å­—æ¯ 'A'ï¼‰</p>
<h4 data-id="heading-12">æ­¥éª¤ 1ï¼šåŠ å¯†ï¼ˆå…¬é’¥Â <code>(17, 3233)</code>ï¼‰</h4>
<p><code>c = 65^17 mod 3233</code>è®¡ç®—ç»“æœï¼š<code>c = 2790</code></p>
<ul>
<li>å¯†æ–‡å°±æ˜¯Â <code>2790</code>ï¼Œå¯ä»¥å…¬å¼€ä¼ è¾“ã€‚</li>
</ul>
<h4 data-id="heading-13">æ­¥éª¤ 2ï¼šè§£å¯†ï¼ˆç§é’¥Â <code>(2753, 3233)</code>ï¼‰</h4>
<p><code>m = 2790^2753 mod 3233</code>è®¡ç®—ç»“æœï¼š<code>m = 65</code></p>
<ul>
<li>æˆåŠŸè¿˜åŸæ˜æ–‡ï¼</li>
</ul>
<h3 data-id="heading-14">äº”ã€RSA æ•°å­—ç­¾åçš„æ•°å­¦åŸç†ï¼ˆå’Œ App ç­¾åç›¸å…³ï¼‰</h3>
<p>ä½ ä¹‹å‰åšçš„ App ç­¾åï¼Œæœ¬è´¨æ˜¯ RSA ç­¾åï¼Œå…¬å¼å’ŒåŠ å¯†ç›¸åï¼š</p>
<ol>
<li><strong>ç­¾å</strong>ï¼šç”¨ç§é’¥Â <code>(d, n)</code>Â åŠ å¯†æ˜æ–‡çš„å“ˆå¸Œå€¼Â <code>h``s = h^d mod n</code>Â â†’Â <code>s</code>Â å°±æ˜¯æ•°å­—ç­¾å</li>
<li><strong>éªŒè¯</strong>ï¼šç”¨å…¬é’¥Â <code>(e, n)</code>Â è§£å¯†ç­¾åï¼Œå¯¹æ¯”å“ˆå¸Œå€¼<code>h' = s^e mod n</code>Â â†’ å¦‚æœÂ <code>h' = h</code>ï¼Œè¯´æ˜ç­¾ååˆæ³•</li>
</ol>
<p><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼šåªæœ‰ç§é’¥æŒæœ‰è€…èƒ½ç”Ÿæˆç­¾åï¼Œä»»ä½•äººéƒ½èƒ½ç”¨å…¬é’¥éªŒè¯ â€”â€” è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ App ç­¾åèƒ½é˜²ç¯¡æ”¹ã€é˜²ä¼ªé€ ã€‚</p>
<h3 data-id="heading-15">å…­ã€RSA å®‰å…¨æ€§çš„æ•°å­¦æœ¬è´¨</h3>
<p>RSA ä¹‹æ‰€ä»¥å®‰å…¨ï¼Œæ ¸å¿ƒæ˜¯ **â€œå¤§æ•°åˆ†è§£éš¾é¢˜â€ çš„å•å‘æ€§ **ï¼š</p>
<ol>
<li><strong>æ­£å‘è®¡ç®—å®¹æ˜“</strong>ï¼šä¸¤ä¸ªå‡ ç™¾ä½çš„å¤§è´¨æ•°Â <code>p</code>Â å’ŒÂ <code>q</code>ï¼Œç›¸ä¹˜å¾—åˆ°Â <code>n</code>Â å¾ˆç®€å•ï¼›</li>
<li><strong>åå‘è®¡ç®—æéš¾</strong>ï¼šä»å‡ ç™¾ä½çš„Â <code>n</code>Â åæ¨å‡ºÂ <code>p</code>Â å’ŒÂ <code>q</code>ï¼Œç°æœ‰è®¡ç®—æœºéœ€è¦<strong>å‡ ç™¾ä¸‡å¹´</strong>æ‰èƒ½ç®—å‡ºæ¥ï¼›</li>
<li><strong>ç ´è§£çš„å”¯ä¸€é€”å¾„</strong>ï¼šå¿…é¡»çŸ¥é“Â <code>d</code>ï¼Œè€ŒÂ <code>d</code>Â çš„è®¡ç®—ä¾èµ–Â <code>Ï†(n)</code>ï¼Œ<code>Ï†(n)</code>Â åˆä¾èµ–Â <code>p</code>Â å’ŒÂ <code>q</code>â€”â€” æ²¡æœ‰Â <code>p</code>Â å’ŒÂ <code>q</code>ï¼Œå°±æ°¸è¿œç®—ä¸å‡ºÂ <code>d</code>ã€‚</li>
</ol>
<h3 data-id="heading-16">ä¸ƒã€è¡¥å……ï¼šä¸ºä»€ä¹ˆå®é™… RSA è¦ç»“åˆå“ˆå¸Œç®—æ³•ï¼Ÿ</h3>
<p>å› ä¸º RSA åªèƒ½åŠ å¯†<strong>å°äºÂ <code>n</code>Â çš„æ•°æ®</strong>ï¼Œè€ŒÂ <code>n</code>Â æ˜¯å‡ ç™¾ä½çš„æ•°ï¼Œç›´æ¥åŠ å¯†å¤§æ–‡ä»¶æ•ˆç‡æä½ã€‚æ‰€ä»¥å®é™…æµç¨‹æ˜¯ï¼š</p>
<ol>
<li>å¯¹å¤§æ–‡ä»¶ï¼ˆå¦‚ APKï¼‰è®¡ç®—å“ˆå¸Œå€¼Â <code>h</code>ï¼ˆå¦‚ SHA256ï¼‰â†’ å¾—åˆ°çŸ­å­—ç¬¦ä¸²ï¼›</li>
<li>ç”¨ç§é’¥åŠ å¯†Â <code>h</code>Â â†’ ç”Ÿæˆæ•°å­—ç­¾åï¼›</li>
<li>éªŒè¯æ—¶ï¼Œå…ˆç®—æ–‡ä»¶å“ˆå¸Œï¼Œå†ç”¨å…¬é’¥è§£å¯†ç­¾åå¯¹æ¯” â€”â€” æ—¢é«˜æ•ˆåˆå®‰å…¨ã€‚</li>
</ol>
<h3 data-id="heading-17">æ€»ç»“</h3>
<p>RSA çš„æ•°å­¦åŸç†å¯ä»¥æµ“ç¼©ä¸º 3 å¥è¯ï¼š</p>
<ol>
<li>å¯†é’¥ç”Ÿæˆï¼šåŸºäºè´¨æ•°åˆ†è§£å’Œæ¬§æ‹‰å®šç†ï¼Œç®—å‡ºå…¬é’¥Â <code>(e,n)</code>Â å’Œç§é’¥Â <code>(d,n)</code>ï¼›</li>
<li>åŠ è§£å¯†ï¼šå…¬é’¥åŠ å¯†æ˜¯Â <code>m^e mod n</code>ï¼Œç§é’¥è§£å¯†æ˜¯Â <code>c^d mod n</code>ï¼›</li>
<li>å®‰å…¨æ€§ï¼šä¾èµ–å¤§æ•°åˆ†è§£çš„å•å‘æ€§ï¼Œç°æœ‰æŠ€æœ¯æ— æ³•ç ´è§£ã€‚</li>
</ol>
<p>è¿™ä¸ªæ•°å­¦é€»è¾‘çœ‹ä¼¼ç®€å•ï¼Œå´æ˜¯äº’è”ç½‘å®‰å…¨çš„åŸºçŸ³ â€”â€” ä» HTTPS åˆ° App ç­¾åï¼Œéƒ½ç¦»ä¸å¼€å®ƒï¼</p>
<h2 data-id="heading-18">æ¬§æ‹‰å‡½æ•°æ²¡æ‡‚ï¼Ÿæˆ‘è¯¦ç»†è®²ä¸‹</h2>
<p>æ¬§æ‹‰å‡½æ•°ï¼ˆÏ† å‡½æ•°ï¼‰æ˜¯ç†è§£ RSA çš„æ ¸å¿ƒé—¨æ§›ï¼Œå’±ä»¬ç”¨ã€Œå®šä¹‰â†’æ€§è´¨â†’ä¾‹å­â†’å®æˆ˜è®¡ç®—ã€å››æ­¥æ‹†è§£ï¼Œå…¨ç¨‹ä¸ç”¨å¤æ‚å…¬å¼ï¼Œåªè®²æœ¬è´¨å’Œå®ç”¨ç»“è®ºï¼š</p>
<h3 data-id="heading-19">ä¸€ã€å…ˆæŠŠæ¬§æ‹‰å‡½æ•°è¯´äººè¯ï¼šæ ¸å¿ƒå®šä¹‰</h3>
<p>æ¬§æ‹‰å‡½æ•°Â <code>Ï†(n)</code>Â çš„å”¯ä¸€ä½œç”¨ï¼š<strong>è®¡ç®— â€œå°äºç­‰äº n ä¸”å’Œ n äº’è´¨çš„æ­£æ•´æ•°çš„ä¸ªæ•°â€</strong> ã€‚</p>
<h4 data-id="heading-20">å…³é”®å‰ç½®ï¼šä»€ä¹ˆæ˜¯ â€œäº’è´¨â€ï¼Ÿ</h4>
<p>ä¸¤ä¸ªæ•°çš„Â <strong>æœ€å¤§å…¬çº¦æ•°ï¼ˆgcdï¼‰= 1</strong>ï¼Œå°±è¯´è¿™ä¸¤ä¸ªæ•°äº’è´¨ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>5 å’Œ 8ï¼šgcd (5,8)=1 â†’ äº’è´¨ï¼›</li>
<li>6 å’Œ 8ï¼šgcd (6,8)=2 â†’ ä¸äº’è´¨ï¼›</li>
<li>1 å’Œä»»ä½•æ•°ï¼šgcd (1,x)=1 â†’ 1 å’Œæ‰€æœ‰æ•°éƒ½äº’è´¨ï¼ˆé‡è¦ç»“è®ºï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-21">æ¬§æ‹‰å‡½æ•°çš„è®¡ç®—ç¤ºä¾‹ï¼ˆä»ç®€å•åˆ°å¤æ‚ï¼‰</h4>






















































<table><thead><tr><th>n å€¼</th><th>å°äºç­‰äº n çš„æ­£æ•´æ•°</th><th>å…¶ä¸­å’Œ n äº’è´¨çš„æ•°</th><th>Ï†(n) ç»“æœ</th><th>éªŒè¯</th></tr></thead><tbody><tr><td>1</td><td>[1]</td><td>[1]</td><td>1</td><td>åªæœ‰ 1 ä¸ª</td></tr><tr><td>2</td><td>[1,2]</td><td>[1]</td><td>1</td><td>2 å’Œ 1 äº’è´¨ï¼Œå’Œè‡ªå·±ä¸äº’è´¨</td></tr><tr><td>3</td><td>[1,2,3]</td><td>[1,2]</td><td>2</td><td>3 å’Œ 1ã€2 éƒ½äº’è´¨</td></tr><tr><td>4</td><td>[1,2,3,4]</td><td>[1,3]</td><td>2</td><td>4 å’Œ 1ã€3 äº’è´¨ï¼ˆå’Œ 2ã€4 ä¸äº’è´¨ï¼‰</td></tr><tr><td>5</td><td>[1,2,3,4,5]</td><td>[1,2,3,4]</td><td>4</td><td>è´¨æ•°å’Œæ‰€æœ‰å°äºå®ƒçš„æ•°éƒ½äº’è´¨</td></tr><tr><td>6</td><td>[1,2,3,4,5,6]</td><td>[1,5]</td><td>2</td><td>6 å’Œ 1ã€5 äº’è´¨ï¼ˆå’Œ 2ã€3ã€4ã€6 ä¸äº’è´¨ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-22">äºŒã€æ¬§æ‹‰å‡½æ•°çš„æ ¸å¿ƒæ€§è´¨ï¼ˆRSA åªç”¨åˆ°è¿™ 2 æ¡ï¼‰</h3>
<p>ä¸ç”¨è®°æ‰€æœ‰æ€§è´¨ï¼ŒRSA é‡Œåªéœ€è¦æŒæ¡ä»¥ä¸‹ 2 æ¡ï¼Œå°¤å…¶æ˜¯ç¬¬ 2 æ¡ï¼š</p>
<h4 data-id="heading-23">æ€§è´¨ 1ï¼šè‹¥ n æ˜¯<strong>è´¨æ•°</strong>ï¼Œåˆ™ Ï†(n) = n-1</h4>
<p>è§£é‡Šï¼šè´¨æ•°çš„å®šä¹‰æ˜¯ â€œåªèƒ½è¢« 1 å’Œè‡ªèº«æ•´é™¤â€ï¼Œæ‰€ä»¥æ‰€æœ‰å°äºå®ƒçš„æ•°éƒ½å’Œå®ƒäº’è´¨ï¼Œä¸ªæ•°å°±æ˜¯ n-1ã€‚ä¾‹å­ï¼š</p>
<ul>
<li>n=5ï¼ˆè´¨æ•°ï¼‰â†’ Ï†(5)=5-1=4ï¼ˆå’Œä¸Šé¢è¡¨æ ¼ä¸€è‡´ï¼‰ï¼›</li>
<li>n=61ï¼ˆRSA ä¾‹å­é‡Œçš„è´¨æ•°ï¼‰â†’ Ï†(61)=60ã€‚</li>
</ul>
<h4 data-id="heading-24">æ€§è´¨ 2ï¼šè‹¥ n = pÃ—qï¼ˆpã€q æ˜¯<strong>ä¸ç›¸ç­‰çš„è´¨æ•°</strong>ï¼‰ï¼Œåˆ™ Ï†(n) = (p-1)Ã—(q-1)</h4>
<p>è¿™æ˜¯ RSA ä¸­æœ€æ ¸å¿ƒçš„æ€§è´¨ï¼è§£é‡Šï¼š</p>
<ol>
<li>pã€q æ˜¯è´¨æ•°ï¼Œæ‰€ä»¥ Ï†(p)=p-1ï¼ŒÏ†(q)=q-1ï¼›</li>
<li>å½“ p å’Œ q ä¸ç›¸ç­‰æ—¶ï¼ŒÏ†(pÃ—q) = Ï†(p)Ã—Ï†(q)ï¼ˆæ•°è®ºé‡Œçš„ â€œç§¯æ€§å‡½æ•°â€ æ€§è´¨ï¼‰ï¼›</li>
<li>å› æ­¤ Ï†(n) = (p-1)Ã—(q-1)ã€‚</li>
</ol>
<h5 data-id="heading-25">å®æˆ˜è®¡ç®—ï¼ˆå¯¹åº”ä¹‹å‰ RSA çš„ä¾‹å­ï¼‰</h5>
<p>RSA ä¸­æˆ‘ä»¬é€‰äº† p=61ï¼Œq=53ï¼ˆéƒ½æ˜¯è´¨æ•°ä¸”ä¸ç›¸ç­‰ï¼‰ï¼š</p>
<ul>
<li>Ï†(61) = 61-1 = 60ï¼›</li>
<li>Ï†(53) = 53-1 = 52ï¼›</li>
<li>Ï†(n) = Ï†(61Ã—53) = 60Ã—52 = 3120ï¼ˆå’Œä¹‹å‰ RSA æ­¥éª¤é‡Œçš„ç»“æœå®Œå…¨ä¸€è‡´ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-26">ä¸ºä»€ä¹ˆè¿™ä¸ªæ€§è´¨å¯¹ RSA è‡³å…³é‡è¦ï¼Ÿ</h4>
<p>å› ä¸ºï¼š</p>
<ol>
<li>RSA çš„ç§é’¥å‚æ•° d å¿…é¡»é€šè¿‡ Ï†(n) è®¡ç®—ï¼ˆd æ˜¯ e çš„æ¨¡ Ï†(n) é€†å…ƒï¼‰ï¼›</li>
<li>å¤–äººåªçŸ¥é“ nï¼ˆå…¬å¼€ï¼‰ï¼Œä½†è¦ç®— Ï†(n) å¿…é¡»å…ˆåˆ†è§£ n å¾—åˆ° p å’Œ qï¼›</li>
<li>å½“ n æ˜¯å‡ ç™¾ä½çš„å¤§æ•°æ—¶ï¼Œåˆ†è§£ n æˆ pÃ—q æ˜¯ä¸–ç•Œçº§æ•°å­¦éš¾é¢˜ â€”â€” è¿™å°±æ˜¯ RSA å®‰å…¨çš„æ ¸å¿ƒã€‚</li>
</ol>
<h3 data-id="heading-27">ä¸‰ã€å†ä¸¾ 2 ä¸ªä¾‹å­å·©å›ºæ€§è´¨ 2</h3>
<h4 data-id="heading-28">ä¾‹å­ 1ï¼šn=15=3Ã—5ï¼ˆ3ã€5 éƒ½æ˜¯è´¨æ•°ï¼‰</h4>
<ul>
<li>Ï†(15) = (3-1)Ã—(5-1) = 2Ã—4 = 8ï¼›</li>
<li>éªŒè¯ï¼šå°äº 15 ä¸”å’Œ 15 äº’è´¨çš„æ•°æ˜¯ [1,2,4,7,8,11,13,14] â†’ å…± 8 ä¸ªï¼Œå’Œè®¡ç®—ç»“æœä¸€è‡´ã€‚</li>
</ul>
<h4 data-id="heading-29">ä¾‹å­ 2ï¼šn=21=3Ã—7ï¼ˆ3ã€7 éƒ½æ˜¯è´¨æ•°ï¼‰</h4>
<ul>
<li>Ï†(21) = (3-1)Ã—(7-1) = 2Ã—6 = 12ï¼›</li>
<li>éªŒè¯ï¼šå°äº 21 ä¸”å’Œ 21 äº’è´¨çš„æ•°æ˜¯ [1,2,4,5,8,10,11,13,16,17,19,20] â†’ å…± 12 ä¸ªï¼Œæ­£ç¡®ã€‚</li>
</ul>
<h3 data-id="heading-30">å››ã€æ¬§æ‹‰å‡½æ•°åœ¨ RSA ä¸­çš„å®é™…ä½œç”¨ï¼ˆç»ˆäºç»•å›æ ¸å¿ƒï¼‰</h3>
<p>æˆ‘ä»¬å†ä¸²ä¸€é RSA æµç¨‹ï¼Œçœ‹æ¬§æ‹‰å‡½æ•°åˆ°åº•åœ¨å“ªå‘æŒ¥ä½œç”¨ï¼š</p>
<ol>
<li>é€‰ p=61ã€q=53 â†’ n=3233ï¼›</li>
<li>ç®— Ï†(n)=3120ï¼ˆè¿™ä¸€æ­¥æ˜¯ç§é’¥çš„ â€œå¯†ç â€ï¼‰ï¼›</li>
<li>é€‰ e=17ï¼ˆå’Œ Ï†(n) äº’è´¨ï¼‰ï¼›</li>
<li>ç®— dï¼Œæ»¡è¶³ (eÃ—d) mod Ï†(n)=1 â†’ (17Ã—2753) mod 3120=1ï¼›</li>
<li>åŠ å¯†ï¼šc = m^e mod nï¼›è§£å¯†ï¼šm = c^d mod nã€‚</li>
</ol>
<p><strong>æ ¸å¿ƒé€»è¾‘</strong>ï¼š</p>
<ul>
<li>è§£å¯†å…¬å¼èƒ½æˆç«‹ï¼Œæœ¬è´¨æ˜¯åŸºäº â€œæ¬§æ‹‰å®šç†â€ï¼šè‹¥ m å’Œ n äº’è´¨ï¼Œåˆ™ m^Ï†(n) â‰¡ 1 mod nï¼›</li>
<li>æ¨å¯¼ä¸‹æ¥å°±æ˜¯ m^(eÃ—d) â‰¡ m^(kÃ—Ï†(n)+1) â‰¡ (m^Ï†(n))^k Ã— m â‰¡ 1^k Ã— m â‰¡ m mod nï¼›</li>
<li>è€Œ Ï†(n) åªæœ‰ç§é’¥æŒæœ‰è€…çŸ¥é“ï¼ˆå› ä¸ºåªæœ‰ä»–çŸ¥é“ p å’Œ qï¼‰ï¼Œå¤–äººå°±ç®—æ‹¿åˆ° e å’Œ nï¼Œä¹Ÿç®—ä¸å‡º dã€‚</li>
</ul>
<h3 data-id="heading-31">äº”ã€æ€»ç»“ï¼šæ¬§æ‹‰å‡½æ•°çš„æ ¸å¿ƒ Takeaway</h3>
<ol>
<li>æ¬§æ‹‰å‡½æ•° Ï†(n) = å°äºç­‰äº n ä¸”å’Œ n äº’è´¨çš„æ­£æ•´æ•°ä¸ªæ•°ï¼›</li>
<li>è´¨æ•° p çš„ Ï†(p)=p-1ï¼›</li>
<li>è‹¥ n=pÃ—qï¼ˆpã€q æ˜¯ä¸åŒè´¨æ•°ï¼‰ï¼Œåˆ™ Ï†(n)=(p-1)Ã—(q-1)ï¼ˆRSA å”¯ä¸€éœ€è¦è®°çš„ï¼‰ï¼›</li>
<li>æ¬§æ‹‰å‡½æ•°æ˜¯ RSA ç§é’¥è®¡ç®—çš„ â€œé’¥åŒ™â€ï¼Œä¹Ÿæ˜¯ RSA å®‰å…¨æ€§çš„æ ¸å¿ƒ â€”â€” å› ä¸ºå¤–äººæ— æ³•ä» n åæ¨ Ï†(n)ã€‚</li>
</ol>
<p>ç°åœ¨å›å¤´çœ‹ RSA çš„å¯†é’¥ç”Ÿæˆï¼Œæ˜¯ä¸æ˜¯å°±æ‡‚äº†ï¼š<strong>æ¬§æ‹‰å‡½æ•°æ˜¯è¿æ¥ â€œå…¬å¼€çš„ nâ€ å’Œ â€œç§å¯†çš„ dâ€ çš„å”¯ä¸€æ¡¥æ¢ï¼Œè€Œè¿™ä¸ªæ¡¥æ¢çš„å…¥å£ï¼ˆpã€qï¼‰è¢«ç‰¢ç‰¢é”æ­»</strong>ã€‚</p>
<p>Ï†è¿™ä¸ªç¬¦å·å•¥æ„æ€ï¼Œ ä¸æ‡‚å•Š</p>
<p>è¿™ä¸ªç¬¦å·Â <code>Ï†</code>Â å°±æ˜¯<strong>æ¬§æ‹‰å‡½æ•°çš„ä¸“å± â€œåå­—â€</strong> ï¼Œæ²¡å•¥å¤æ‚å«ä¹‰ï¼Œå°±æ˜¯ä¸€ä¸ªæ•°å­¦è®°å·ã€‚</p>
<h3 data-id="heading-32">ä¸€ã€<code>Ï†</code>Â æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ol>
<li>
<p><strong>è¯»éŸ³</strong>ï¼šè¯»ä½œÂ <strong>fÃ i</strong>ï¼ˆå’Œ â€œæ´¾ Ï€â€ ç±»ä¼¼ï¼Œéƒ½æ˜¯å¸Œè…Šå­—æ¯ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ä½œç”¨</strong>ï¼šä¸“é—¨ç”¨æ¥è¡¨ç¤º â€œæ¬§æ‹‰å‡½æ•°â€ è¿™ä¸ªè®¡ç®—è§„åˆ™ï¼Œå°±åƒç”¨Â <code>f(x)</code>Â è¡¨ç¤ºå‡½æ•°ä¸€æ ·ã€‚</p>
<ul>
<li>æ¯”å¦‚Â <code>Ï†(n)</code>ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯Â  <strong>â€œå¯¹æ­£æ•´æ•° n è®¡ç®—æ¬§æ‹‰å‡½æ•°çš„å€¼â€</strong> ã€‚</li>
<li>ä½ å¯ä»¥æŠŠå®ƒç†è§£æˆä¸€ä¸ª â€œè®¡ç®—æŒ‡ä»¤â€ï¼šè¾“å…¥ä¸€ä¸ªæ•°Â <code>n</code>ï¼Œè¾“å‡º â€œå°äºç­‰äºÂ <code>n</code>Â ä¸”å’ŒÂ <code>n</code>Â äº’è´¨çš„æ­£æ•´æ•°ä¸ªæ•°â€ã€‚</li>
</ul>
</li>
</ol>
<h3 data-id="heading-33">äºŒã€ä¸¾ä¸ªä¾‹å­ï¼Œç§’æ‡‚ç”¨æ³•</h3>






























<table><thead><tr><th>æ•°å­¦å†™æ³•</th><th>ä¸­æ–‡ç¿»è¯‘</th><th>è®¡ç®—ç»“æœ</th></tr></thead><tbody><tr><td><code>Ï†(5)</code></td><td>è®¡ç®— 5 çš„æ¬§æ‹‰å‡½æ•°å€¼</td><td>4ï¼ˆ1ã€2ã€3ã€4 éƒ½å’Œ 5 äº’è´¨ï¼‰</td></tr><tr><td><code>Ï†(6)</code></td><td>è®¡ç®— 6 çš„æ¬§æ‹‰å‡½æ•°å€¼</td><td>2ï¼ˆ1ã€5 å’Œ 6 äº’è´¨ï¼‰</td></tr><tr><td><code>Ï†(15)</code></td><td>è®¡ç®— 15 çš„æ¬§æ‹‰å‡½æ•°å€¼</td><td>8ï¼ˆ1ã€2ã€4ã€7ã€8ã€11ã€13ã€14 å’Œ 15 äº’è´¨ï¼‰</td></tr><tr><td><code>Ï†(p)</code>ï¼ˆp æ˜¯è´¨æ•°ï¼‰</td><td>è®¡ç®—è´¨æ•° p çš„æ¬§æ‹‰å‡½æ•°å€¼</td><td>p-1ï¼ˆæ‰€æœ‰å°äº p çš„æ•°éƒ½å’Œ p äº’è´¨ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-34">ä¸‰ã€å’Œ RSA çš„å…³è”ï¼šä¸ºå•¥è¦è®°è¿™ä¸ªç¬¦å·ï¼Ÿ</h3>
<p>åœ¨ RSA é‡Œï¼Œä½ åªéœ€è¦è®°ä½Â <strong><code>Ï†(n) = (p-1)Ã—(q-1)</code></strong> Â è¿™ä¸ªå…¬å¼å°±è¡Œï¼Œè¿™é‡Œçš„Â <code>Ï†(n)</code>Â å°±æ˜¯ â€œå¯¹Â <code>n</code>Â è®¡ç®—æ¬§æ‹‰å‡½æ•°â€ çš„ç®€å†™ã€‚</p>
<ul>
<li>æ¯”å¦‚ RSA ä¾‹å­é‡ŒÂ <code>n=61Ã—53=3233</code>ï¼Œæˆ‘ä»¬ç›´æ¥å†™Â <code>Ï†(3233) = (61-1)Ã—(53-1)=3120</code>ï¼Œä¸ç”¨æ¯æ¬¡éƒ½å†™ â€œè®¡ç®—å°äº 3233 ä¸”å’Œ 3233 äº’è´¨çš„æ•°çš„ä¸ªæ•°â€ã€‚</li>
</ul>
<p>ç®€å•è¯´ï¼š<code>Ï†</code>Â å°±æ˜¯ä¸ª<strong>ç®€å†™ç¬¦å·</strong>ï¼Œç”¨æ¥è®©æ•°å­¦è¡¨è¾¾æ›´ç®€æ´ï¼Œä¸ç”¨åå¤å†™ä¸€é•¿ä¸²æ–‡å­—å®šä¹‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JavaScriptæ€§èƒ½ä¸ä¼˜åŒ–ï¼šæ‰‹å†™å®ç°å…³é”®ä¼˜åŒ–æŠ€æœ¯]]></title>    <link>https://juejin.cn/post/7582904081864507433</link>    <guid>https://juejin.cn/post/7582904081864507433</guid>    <pubDate>2025-12-14T08:24:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582904081864507433" data-draft-id="7583215836690006057" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JavaScriptæ€§èƒ½ä¸ä¼˜åŒ–ï¼šæ‰‹å†™å®ç°å…³é”®ä¼˜åŒ–æŠ€æœ¯"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-14T08:24:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024è‚¥å®…"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JavaScriptæ€§èƒ½ä¸ä¼˜åŒ–ï¼šæ‰‹å†™å®ç°å…³é”®ä¼˜åŒ–æŠ€æœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024è‚¥å®…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:24:56.000Z" title="Sun Dec 14 2025 08:24:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»19åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæ€§èƒ½ä¼˜åŒ–ä¸ä»…ä»…æ˜¯ä½¿ç”¨ç°æˆçš„åº“å’Œå·¥å…·ï¼Œç†è§£å…¶åº•å±‚åŸç†å¹¶èƒ½å¤Ÿæ‰‹å†™å®ç°æ˜¯å…³é”®ã€‚é€šè¿‡æ‰‹å†™è¿™äº›ä¼˜åŒ–æŠ€æœ¯ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ul>
<li>æ›´æ·±å…¥åœ°ç†è§£æ€§èƒ½ç“¶é¢ˆ</li>
<li>æ ¹æ®å…·ä½“åœºæ™¯å®šåˆ¶ä¼˜åŒ–æ–¹æ¡ˆ</li>
<li>é¿å…å¼•å…¥ä¸å¿…è¦çš„ä¾èµ–</li>
<li>æå‡è§£å†³é—®é¢˜çš„èƒ½åŠ›</li>
</ul>
<p>æœ¬æ–‡å°†æ·±å…¥æ¢è®¨JavaScriptæ€§èƒ½ä¼˜åŒ–çš„æ ¸å¿ƒæ‰‹å†™å®ç°ï¼Œæ¯ä¸ªæŠ€æœ¯ç‚¹éƒ½å°†åŒ…å«å®Œæ•´çš„å®ç°ä»£ç å’Œåº”ç”¨åœºæ™¯ã€‚</p>
<h4 data-id="heading-1">ä¸€ã€è™šæ‹Ÿåˆ—è¡¨å®ç°ï¼ˆVirtual Listï¼‰</h4>
<p>è™šæ‹Ÿåˆ—è¡¨æ˜¯å¤„ç†å¤§æ•°æ®åˆ—è¡¨æ¸²æŸ“çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œé€šè¿‡åªæ¸²æŸ“å¯è§†åŒºåŸŸå†…çš„å…ƒç´ æ¥å¤§å¹…æå‡æ€§èƒ½ã€‚</p>
<h5 data-id="heading-2">1.1 æ ¸å¿ƒåŸç†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">VirtualList</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = options.<span class="hljs-property">container</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span> = options.<span class="hljs-property">itemHeight</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span> = options.<span class="hljs-property">totalItems</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bufferSize</span> = options.<span class="hljs-property">bufferSize</span> || <span class="hljs-number">5</span>; <span class="hljs-comment">// ä¸Šä¸‹ç¼“å†²åŒºåŸŸ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderItem</span> = options.<span class="hljs-property">renderItem</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span> = <span class="hljs-number">0</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// åˆ›å»ºå®¹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'relative'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.totalItems * <span class="hljs-variable language_">this</span>.itemHeight}</span>px`</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">style</span>.<span class="hljs-property">overflow</span> = <span class="hljs-string">'hidden'</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'absolute'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">'0'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">left</span> = <span class="hljs-string">'0'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'100%'</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>);
    
    <span class="hljs-comment">// ç»‘å®šæ»šåŠ¨äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScroll</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    
    <span class="hljs-comment">// åˆå§‹æ¸²æŸ“</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateVisibleRange</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderVisibleItems</span>();
  }

  <span class="hljs-title function_">calculateVisibleRange</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> scrollTop = <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">scrollTop</span>;
    <span class="hljs-keyword">const</span> visibleHeight = <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">clientHeight</span>;
    
    <span class="hljs-comment">// è®¡ç®—å¯è§†åŒºåŸŸèµ·å§‹å’Œç»“æŸç´¢å¼•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(
      <span class="hljs-number">0</span>,
      <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(scrollTop / <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span>) - <span class="hljs-variable language_">this</span>.<span class="hljs-property">bufferSize</span>
    );
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span> - <span class="hljs-number">1</span>,
      <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">ceil</span>((scrollTop + visibleHeight) / <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeight</span>) + <span class="hljs-variable language_">this</span>.<span class="hljs-property">bufferSize</span>
    );
  }

  <span class="hljs-title function_">renderVisibleItems</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ç§»é™¤ä¸åœ¨å¯è§†åŒºåŸŸçš„å…ƒç´ </span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (item.<span class="hljs-property">index</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> || item.<span class="hljs-property">index</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span>) {
        item.<span class="hljs-property">element</span>.<span class="hljs-title function_">remove</span>();
      }
    });
    
    <span class="hljs-comment">// æ›´æ–°å¯è§é¡¹æ•°ç»„</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span>.<span class="hljs-title function_">filter</span>(
      <span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">index</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> &amp;&amp; item.<span class="hljs-property">index</span> &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span>
    );
    
    <span class="hljs-comment">// åˆ›å»ºæ–°çš„å¯è§é¡¹</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span>; i &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span>; i++) {
      <span class="hljs-keyword">const</span> existingItem = <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">index</span> === i);
      
      <span class="hljs-keyword">if</span> (!existingItem) {
        <span class="hljs-keyword">const</span> itemElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        itemElement.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'absolute'</span>;
        itemElement.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${i * <span class="hljs-variable language_">this</span>.itemHeight}</span>px`</span>;
        itemElement.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.itemHeight}</span>px`</span>;
        itemElement.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'100%'</span>;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderItem</span>(itemElement, i);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-title function_">appendChild</span>(itemElement);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span>.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">index</span>: i, <span class="hljs-attr">element</span>: itemElement });
      }
    }
    
    <span class="hljs-comment">// æ›´æ–°å†…å®¹åŒºåŸŸä½ç½®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">transform</span> = <span class="hljs-string">`translateY(<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.startIndex * <span class="hljs-variable language_">this</span>.itemHeight}</span>px)`</span>;
  }

  <span class="hljs-title function_">handleScroll</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateVisibleRange</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderVisibleItems</span>();
    });
  }

  <span class="hljs-title function_">updateItem</span>(<span class="hljs-params">index, data</span>) {
    <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">index</span> === index);
    <span class="hljs-keyword">if</span> (item) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderItem</span>(item.<span class="hljs-property">element</span>, index, data);
    }
  }

  <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScroll</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">removeChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>);
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> listContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'list-container'</span>);

<span class="hljs-keyword">const</span> virtualList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VirtualList</span>({
  <span class="hljs-attr">container</span>: listContainer,
  <span class="hljs-attr">itemHeight</span>: <span class="hljs-number">50</span>,
  <span class="hljs-attr">totalItems</span>: <span class="hljs-number">10000</span>,
  <span class="hljs-attr">bufferSize</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">renderItem</span>: <span class="hljs-function">(<span class="hljs-params">element, index</span>) =&gt;</span> {
    element.<span class="hljs-property">textContent</span> = <span class="hljs-string">`Item <span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>`</span>;
    element.<span class="hljs-property">style</span>.<span class="hljs-property">borderBottom</span> = <span class="hljs-string">'1px solid #eee'</span>;
    element.<span class="hljs-property">style</span>.<span class="hljs-property">padding</span> = <span class="hljs-string">'10px'</span>;
  }
});

<span class="hljs-comment">// åŠ¨æ€æ›´æ–°</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  virtualList.<span class="hljs-title function_">updateItem</span>(<span class="hljs-number">5</span>, <span class="hljs-string">'Updated Item 6'</span>);
}, <span class="hljs-number">2000</span>);
</code></pre>
<h5 data-id="heading-3">1.2 å¸¦åŠ¨æ€é«˜åº¦çš„è™šæ‹Ÿåˆ—è¡¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicVirtualList</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = options.<span class="hljs-property">container</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span> = options.<span class="hljs-property">totalItems</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderItem</span> = options.<span class="hljs-property">renderItem</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">estimateHeight</span> = options.<span class="hljs-property">estimateHeight</span> || <span class="hljs-number">50</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bufferSize</span> = options.<span class="hljs-property">bufferSize</span> || <span class="hljs-number">5</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeights</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemPositions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span>).<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cachedItems</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'relative'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">'500px'</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">style</span>.<span class="hljs-property">overflow</span> = <span class="hljs-string">'auto'</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'relative'</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>);
    
    <span class="hljs-comment">// è®¡ç®—é¢„ä¼°çš„æ€»é«˜åº¦</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculatePositions</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateContentHeight</span>();
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScroll</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    
    <span class="hljs-comment">// åˆå§‹æ¸²æŸ“</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateVisibleRange</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderVisibleItems</span>();
  }

  <span class="hljs-title function_">calculatePositions</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> totalHeight = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span>; i++) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemPositions</span>[i] = totalHeight;
      totalHeight += <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeights</span>[i] || <span class="hljs-variable language_">this</span>.<span class="hljs-property">estimateHeight</span>;
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalHeight</span> = totalHeight;
  }

  <span class="hljs-title function_">updateContentHeight</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-property">style</span>.<span class="hljs-property">height</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.totalHeight}</span>px`</span>;
  }

  <span class="hljs-title function_">calculateVisibleRange</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> scrollTop = <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">scrollTop</span>;
    <span class="hljs-keyword">const</span> viewportHeight = <span class="hljs-variable language_">this</span>.<span class="hljs-property">viewport</span>.<span class="hljs-property">clientHeight</span>;
    
    <span class="hljs-comment">// äºŒåˆ†æŸ¥æ‰¾èµ·å§‹ç´¢å¼•</span>
    <span class="hljs-keyword">let</span> start = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> end = <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span> - <span class="hljs-number">1</span>;
    
    <span class="hljs-keyword">while</span> (start &lt;= end) {
      <span class="hljs-keyword">const</span> mid = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>((start + end) / <span class="hljs-number">2</span>);
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemPositions</span>[mid] &lt;= scrollTop) {
        start = mid + <span class="hljs-number">1</span>;
      } <span class="hljs-keyword">else</span> {
        end = mid - <span class="hljs-number">1</span>;
      }
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(<span class="hljs-number">0</span>, end - <span class="hljs-variable language_">this</span>.<span class="hljs-property">bufferSize</span>);
    
    <span class="hljs-comment">// æŸ¥æ‰¾ç»“æŸç´¢å¼•</span>
    <span class="hljs-keyword">let</span> currentHeight = scrollTop;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span>;
    
    <span class="hljs-keyword">while</span> (
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span> &amp;&amp;
      currentHeight &lt; scrollTop + viewportHeight
    ) {
      currentHeight += <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeights</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span>] || <span class="hljs-variable language_">this</span>.<span class="hljs-property">estimateHeight</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span>++;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">totalItems</span> - <span class="hljs-number">1</span>,
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">bufferSize</span>
    );
  }

  <span class="hljs-title function_">renderVisibleItems</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ›´æ–°å¯è§é¡¹</span>
    <span class="hljs-keyword">const</span> newVisibleItems = [];
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span>; i &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span>; i++) {
      <span class="hljs-keyword">let</span> itemElement = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cachedItems</span>.<span class="hljs-title function_">get</span>(i);
      
      <span class="hljs-keyword">if</span> (!itemElement) {
        itemElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        itemElement.<span class="hljs-property">style</span>.<span class="hljs-property">position</span> = <span class="hljs-string">'absolute'</span>;
        itemElement.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.itemPositions[i]}</span>px`</span>;
        itemElement.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'100%'</span>;
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderItem</span>(itemElement, i);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cachedItems</span>.<span class="hljs-title function_">set</span>(i, itemElement);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">content</span>.<span class="hljs-title function_">appendChild</span>(itemElement);
        
        <span class="hljs-comment">// æµ‹é‡å®é™…é«˜åº¦</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeights</span>[i] === <span class="hljs-literal">null</span>) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeights</span>[i] = itemElement.<span class="hljs-property">offsetHeight</span>;
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculatePositions</span>();
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateContentHeight</span>();
          
          <span class="hljs-comment">// é‡æ–°è®¡ç®—ä½ç½®</span>
          itemElement.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.itemPositions[i]}</span>px`</span>;
        }
      }
      
      newVisibleItems.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">index</span>: i, <span class="hljs-attr">element</span>: itemElement });
    }
    
    <span class="hljs-comment">// éšè—ä¸åœ¨å¯è§†åŒºåŸŸçš„å…ƒç´ </span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ index, element }</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">startIndex</span> || index &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">endIndex</span>) {
        element.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
      }
    });
    
    <span class="hljs-comment">// æ˜¾ç¤ºå¯è§å…ƒç´ </span>
    newVisibleItems.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ index, element }</span>) =&gt;</span> {
      element.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">''</span>;
      element.<span class="hljs-property">style</span>.<span class="hljs-property">top</span> = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.itemPositions[index]}</span>px`</span>;
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibleItems</span> = newVisibleItems;
  }

  <span class="hljs-title function_">handleScroll</span>(<span class="hljs-params"/>) {
    <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateVisibleRange</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderVisibleItems</span>();
    });
  }

  <span class="hljs-title function_">updateItem</span>(<span class="hljs-params">index, data</span>) {
    <span class="hljs-keyword">const</span> itemElement = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cachedItems</span>.<span class="hljs-title function_">get</span>(index);
    <span class="hljs-keyword">if</span> (itemElement) {
      <span class="hljs-keyword">const</span> oldHeight = <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeights</span>[index] || <span class="hljs-variable language_">this</span>.<span class="hljs-property">estimateHeight</span>;
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderItem</span>(itemElement, index, data);
      
      <span class="hljs-keyword">const</span> newHeight = itemElement.<span class="hljs-property">offsetHeight</span>;
      <span class="hljs-keyword">if</span> (oldHeight !== newHeight) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeights</span>[index] = newHeight;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculatePositions</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateContentHeight</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderVisibleItems</span>();
      }
    }
  }
}
</code></pre>
<h4 data-id="heading-4">äºŒã€å›¾ç‰‡æ‡’åŠ è½½ï¼ˆLazy Loadingï¼‰</h4>
<h5 data-id="heading-5">2.1 åŸºäºIntersectionObserverçš„å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LazyImageLoader</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">root</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">'0px'</span>,
      <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.1</span>,
      <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'</span>,
      <span class="hljs-attr">errorImage</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">loadingClass</span>: <span class="hljs-string">'lazy-loading'</span>,
      <span class="hljs-attr">loadedClass</span>: <span class="hljs-string">'lazy-loaded'</span>,
      <span class="hljs-attr">errorClass</span>: <span class="hljs-string">'lazy-error'</span>,
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fallbackTimeout</span> = <span class="hljs-number">3000</span>; <span class="hljs-comment">// é™çº§è¶…æ—¶æ—¶é—´</span>
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'IntersectionObserver'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleIntersection</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>),
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>
      );
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">useFallback</span>();
    }
    
    <span class="hljs-comment">// é¢„è¿æ¥DNSå’Œé¢„åŠ è½½</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addPreconnect</span>();
  }

  <span class="hljs-title function_">addPreconnect</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> domains = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    
    <span class="hljs-comment">// æ”¶é›†æ‰€æœ‰å›¾ç‰‡çš„åŸŸå</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'img[data-src]'</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> src = img.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-src'</span>);
      <span class="hljs-keyword">if</span> (src) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(src, <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">origin</span>);
          domains.<span class="hljs-title function_">add</span>(url.<span class="hljs-property">origin</span>);
        } <span class="hljs-keyword">catch</span> (e) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Invalid URL:'</span>, src);
        }
      }
    });
    
    <span class="hljs-comment">// æ·»åŠ preconnecté“¾æ¥</span>
    domains.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">domain</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> link = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'link'</span>);
      link.<span class="hljs-property">rel</span> = <span class="hljs-string">'preconnect'</span>;
      link.<span class="hljs-property">href</span> = domain;
      link.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">'anonymous'</span>;
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(link);
    });
  }

  <span class="hljs-title function_">registerImage</span>(<span class="hljs-params">imgElement</span>) {
    <span class="hljs-keyword">if</span> (!(imgElement <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">HTMLImageElement</span>)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Element must be an image'</span>);
    }

    <span class="hljs-keyword">const</span> src = imgElement.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-src'</span>);
    <span class="hljs-keyword">if</span> (!src) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// ä¿å­˜åŸå§‹å±æ€§</span>
    imgElement.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-lazy-src'</span>, src);
    
    <span class="hljs-comment">// è®¾ç½®å ä½ç¬¦</span>
    <span class="hljs-keyword">if</span> (imgElement.<span class="hljs-property">src</span> !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">placeholder</span>) {
      imgElement.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-original-src'</span>, imgElement.<span class="hljs-property">src</span>);
      imgElement.<span class="hljs-property">src</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">placeholder</span>;
    }
    
    imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">loadingClass</span>);
    
    <span class="hljs-comment">// æ·»åŠ åˆ°è§‚å¯Ÿåˆ—è¡¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">set</span>(imgElement, {
      src,
      <span class="hljs-attr">loaded</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">loadAttempted</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">observerAttached</span>: <span class="hljs-literal">false</span>
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachObserver</span>(imgElement);
  }

  <span class="hljs-title function_">attachObserver</span>(<span class="hljs-params">imgElement</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">get</span>(imgElement)?.<span class="hljs-property">observerAttached</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">observe</span>(imgElement);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">get</span>(imgElement).<span class="hljs-property">observerAttached</span> = <span class="hljs-literal">true</span>;
    }
  }

  <span class="hljs-title function_">handleIntersection</span>(<span class="hljs-params">entries</span>) {
    entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">isIntersecting</span>) {
        <span class="hljs-keyword">const</span> img = entry.<span class="hljs-property">target</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadImage</span>(img);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>?.<span class="hljs-title function_">unobserve</span>(img);
      }
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadImage</span>(<span class="hljs-params">imgElement</span>) {
    <span class="hljs-keyword">const</span> imageData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">get</span>(imgElement);
    <span class="hljs-keyword">if</span> (!imageData || imageData.<span class="hljs-property">loadAttempted</span>) <span class="hljs-keyword">return</span>;

    imageData.<span class="hljs-property">loadAttempted</span> = <span class="hljs-literal">true</span>;
    
    <span class="hljs-comment">// ç§»é™¤åŠ è½½ç±»ï¼Œæ·»åŠ åŠ è½½ä¸­ç±»</span>
    imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">loadingClass</span>);
    imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">loadingClass</span>);
    
    <span class="hljs-comment">// åˆ›å»ºåŠ è½½è¶…æ—¶</span>
    <span class="hljs-keyword">const</span> loadTimeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (!imageData.<span class="hljs-property">loaded</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleImageError</span>(imgElement, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Image load timeout'</span>));
      }
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">fallbackTimeout</span>);
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// é¢„åŠ è½½å›¾ç‰‡</span>
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">preloadImage</span>(imageData.<span class="hljs-property">src</span>);
      
      <span class="hljs-comment">// åº”ç”¨å›¾ç‰‡</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyImage</span>(imgElement, imageData.<span class="hljs-property">src</span>);
      
      <span class="hljs-built_in">clearTimeout</span>(loadTimeout);
      
      <span class="hljs-comment">// æ›´æ–°çŠ¶æ€</span>
      imageData.<span class="hljs-property">loaded</span> = <span class="hljs-literal">true</span>;
      imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">loadingClass</span>);
      imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">loadedClass</span>);
      
      <span class="hljs-comment">// è§¦å‘äº‹ä»¶</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">dispatchEvent</span>(imgElement, <span class="hljs-string">'lazyload'</span>, { <span class="hljs-attr">src</span>: imageData.<span class="hljs-property">src</span> });
      
      <span class="hljs-comment">// é¢„åŠ è½½ç›¸é‚»å›¾ç‰‡</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">preloadAdjacentImages</span>(imgElement);
      
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleImageError</span>(imgElement, error);
    }
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">preloadImage</span>(<span class="hljs-params">src</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
      
      img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> {
        img.<span class="hljs-property">onload</span> = img.<span class="hljs-property">onerror</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-title function_">resolve</span>(img);
      };
      
      img.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
        img.<span class="hljs-property">onload</span> = img.<span class="hljs-property">onerror</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Failed to load image: <span class="hljs-subst">${src}</span>`</span>));
      };
      
      <span class="hljs-comment">// è®¾ç½®crossOriginå±æ€§</span>
      <span class="hljs-keyword">if</span> (src.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'http'</span>)) {
        img.<span class="hljs-property">crossOrigin</span> = <span class="hljs-string">'anonymous'</span>;
      }
      
      img.<span class="hljs-property">src</span> = src;
    });
  }

  <span class="hljs-title function_">applyImage</span>(<span class="hljs-params">imgElement, src</span>) {
    <span class="hljs-comment">// ä½¿ç”¨requestAnimationFrameç¡®ä¿æµç•…</span>
    <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
      imgElement.<span class="hljs-property">src</span> = src;
      
      <span class="hljs-comment">// å¦‚æœæœ‰srcsetä¹Ÿæ›´æ–°</span>
      <span class="hljs-keyword">const</span> srcset = imgElement.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-srcset'</span>);
      <span class="hljs-keyword">if</span> (srcset) {
        imgElement.<span class="hljs-property">srcset</span> = srcset;
        imgElement.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">'data-srcset'</span>);
      }
      
      <span class="hljs-comment">// ç§»é™¤data-srcå±æ€§</span>
      imgElement.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">'data-src'</span>);
      imgElement.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">'data-lazy-src'</span>);
    });
  }

  <span class="hljs-title function_">preloadAdjacentImages</span>(<span class="hljs-params">currentImg</span>) {
    <span class="hljs-keyword">const</span> allImages = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">keys</span>());
    <span class="hljs-keyword">const</span> currentIndex = allImages.<span class="hljs-title function_">indexOf</span>(currentImg);
    
    <span class="hljs-keyword">if</span> (currentIndex !== -<span class="hljs-number">1</span>) {
      <span class="hljs-comment">// é¢„åŠ è½½å‰åå„2å¼ å›¾ç‰‡</span>
      <span class="hljs-keyword">const</span> indices = [
        currentIndex - <span class="hljs-number">2</span>, currentIndex - <span class="hljs-number">1</span>,
        currentIndex + <span class="hljs-number">1</span>, currentIndex + <span class="hljs-number">2</span>
      ];
      
      indices.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">index</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span> &amp;&amp; index &lt; allImages.<span class="hljs-property">length</span>) {
          <span class="hljs-keyword">const</span> img = allImages[index];
          <span class="hljs-keyword">const</span> imgData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">get</span>(img);
          
          <span class="hljs-keyword">if</span> (!imgData.<span class="hljs-property">loaded</span> &amp;&amp; !imgData.<span class="hljs-property">loadAttempted</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachObserver</span>(img);
          }
        }
      });
    }
  }

  <span class="hljs-title function_">handleImageError</span>(<span class="hljs-params">imgElement, error</span>) {
    <span class="hljs-keyword">const</span> imageData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">get</span>(imgElement);
    
    imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">loadingClass</span>);
    imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">errorClass</span>);
    
    <span class="hljs-comment">// è®¾ç½®é”™è¯¯å›¾ç‰‡</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">errorImage</span>) {
      imgElement.<span class="hljs-property">src</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">errorImage</span>;
    }
    
    <span class="hljs-comment">// æ¢å¤åŸå§‹å›¾ç‰‡ï¼ˆå¦‚æœæœ‰ï¼‰</span>
    <span class="hljs-keyword">const</span> originalSrc = imgElement.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-original-src'</span>);
    <span class="hljs-keyword">if</span> (originalSrc &amp;&amp; originalSrc !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">placeholder</span>) {
      imgElement.<span class="hljs-property">src</span> = originalSrc;
    }
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Lazy image load error:'</span>, error);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">dispatchEvent</span>(imgElement, <span class="hljs-string">'lazyloaderror'</span>, { 
      <span class="hljs-attr">src</span>: imageData?.<span class="hljs-property">src</span>, 
      error 
    });
  }

  <span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-params">element, eventName, detail</span>) {
    <span class="hljs-keyword">const</span> event = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(eventName, { 
      <span class="hljs-attr">bubbles</span>: <span class="hljs-literal">true</span>,
      detail 
    });
    element.<span class="hljs-title function_">dispatchEvent</span>(event);
  }

  <span class="hljs-title function_">useFallback</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šæ»šåŠ¨ç›‘å¬</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScrollFallback</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScrollFallback</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'orientationchange'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScrollFallback</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    
    <span class="hljs-comment">// åˆå§‹æ£€æŸ¥</span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleScrollFallback</span>(), <span class="hljs-number">100</span>);
  }

  <span class="hljs-title function_">handleScrollFallback</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> viewportHeight = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
    <span class="hljs-keyword">const</span> scrollTop = <span class="hljs-variable language_">window</span>.<span class="hljs-property">scrollY</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">imageData, imgElement</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!imageData.<span class="hljs-property">loaded</span> &amp;&amp; !imageData.<span class="hljs-property">loadAttempted</span>) {
        <span class="hljs-keyword">const</span> rect = imgElement.<span class="hljs-title function_">getBoundingClientRect</span>();
        <span class="hljs-keyword">const</span> elementTop = rect.<span class="hljs-property">top</span> + scrollTop;
        <span class="hljs-keyword">const</span> elementBottom = rect.<span class="hljs-property">bottom</span> + scrollTop;
        
        <span class="hljs-comment">// åˆ¤æ–­æ˜¯å¦åœ¨å¯è§†åŒºåŸŸå†…ï¼ˆå¸¦ç¼“å†²åŒºï¼‰</span>
        <span class="hljs-keyword">if</span> (
          elementBottom &gt;= scrollTop - <span class="hljs-number">500</span> &amp;&amp; 
          elementTop &lt;= scrollTop + viewportHeight + <span class="hljs-number">500</span>
        ) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadImage</span>(imgElement);
        }
      }
    });
  }

  <span class="hljs-comment">// æ‰¹é‡æ³¨å†Œ</span>
  <span class="hljs-title function_">registerAll</span>(<span class="hljs-params">selector = <span class="hljs-string">'img[data-src]'</span></span>) {
    <span class="hljs-keyword">const</span> images = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector);
    images.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerImage</span>(img));
    
    <span class="hljs-comment">// ç›‘å¬åŠ¨æ€æ·»åŠ çš„å›¾ç‰‡</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'MutationObserver'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutationObserver</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> {
        mutations.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">mutation</span> =&gt;</span> {
          mutation.<span class="hljs-property">addedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> {
            <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-number">1</span>) { <span class="hljs-comment">// å…ƒç´ èŠ‚ç‚¹</span>
              <span class="hljs-keyword">if</span> (node.<span class="hljs-property">matches</span> &amp;&amp; node.<span class="hljs-title function_">matches</span>(selector)) {
                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerImage</span>(node);
              }
              <span class="hljs-keyword">if</span> (node.<span class="hljs-property">querySelectorAll</span>) {
                node.<span class="hljs-title function_">querySelectorAll</span>(selector).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> {
                  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerImage</span>(img);
                });
              }
            }
          });
        });
      });
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutationObserver</span>.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>, {
        <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
      });
    }
  }

  <span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘åŠ è½½</span>
  <span class="hljs-title function_">loadImageNow</span>(<span class="hljs-params">imgElement</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">has</span>(imgElement)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadImage</span>(imgElement);
    }
  }

  <span class="hljs-comment">// é”€æ¯</span>
  <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">disconnect</span>();
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutationObserver</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutationObserver</span>.<span class="hljs-title function_">disconnect</span>();
    }
    
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScrollFallback</span>);
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScrollFallback</span>);
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'orientationchange'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScrollFallback</span>);
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">clear</span>();
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> lazyLoader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LazyImageLoader</span>({
  <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.01</span>,
  <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'/path/to/placeholder.jpg'</span>,
  <span class="hljs-attr">errorImage</span>: <span class="hljs-string">'/path/to/error.jpg'</span>
});

<span class="hljs-comment">// æ³¨å†Œæ‰€æœ‰æ‡’åŠ è½½å›¾ç‰‡</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function">() =&gt;</span> {
  lazyLoader.<span class="hljs-title function_">registerAll</span>();
});

<span class="hljs-comment">// åŠ¨æ€æ·»åŠ å›¾ç‰‡</span>
<span class="hljs-keyword">const</span> newImage = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'img'</span>);
newImage.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-src'</span>, <span class="hljs-string">'/path/to/image.jpg'</span>);
<span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(newImage);
lazyLoader.<span class="hljs-title function_">registerImage</span>(newImage);
</code></pre>
<h5 data-id="heading-6">2.2 èƒŒæ™¯å›¾ç‰‡æ‡’åŠ è½½</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LazyBackgroundLoader</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">LazyImageLoader</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">super</span>(options);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">attributeName</span> = options.<span class="hljs-property">attributeName</span> || <span class="hljs-string">'data-bg'</span>;
  }

  <span class="hljs-title function_">registerElement</span>(<span class="hljs-params">element</span>) {
    <span class="hljs-keyword">const</span> bgSrc = element.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">attributeName</span>);
    <span class="hljs-keyword">if</span> (!bgSrc) <span class="hljs-keyword">return</span>;

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">set</span>(element, {
      <span class="hljs-attr">src</span>: bgSrc,
      <span class="hljs-attr">loaded</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">loadAttempted</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">observerAttached</span>: <span class="hljs-literal">false</span>
    });

    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachObserver</span>(element);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadImage</span>(<span class="hljs-params">element</span>) {
    <span class="hljs-keyword">const</span> elementData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">get</span>(element);
    <span class="hljs-keyword">if</span> (!elementData || elementData.<span class="hljs-property">loadAttempted</span>) <span class="hljs-keyword">return</span>;

    elementData.<span class="hljs-property">loadAttempted</span> = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">preloadImage</span>(elementData.<span class="hljs-property">src</span>);
      
      <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> {
        element.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundImage</span> = <span class="hljs-string">`url("<span class="hljs-subst">${elementData.src}</span>")`</span>;
        element.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">attributeName</span>);
        
        elementData.<span class="hljs-property">loaded</span> = <span class="hljs-literal">true</span>;
        element.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">loadedClass</span>);
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">dispatchEvent</span>(element, <span class="hljs-string">'lazyload'</span>, { <span class="hljs-attr">src</span>: elementData.<span class="hljs-property">src</span> });
      });
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleImageError</span>(element, error);
    }
  }

  <span class="hljs-title function_">registerAll</span>(<span class="hljs-params">selector = <span class="hljs-string">`[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.attributeName}</span>]`</span></span>) {
    <span class="hljs-keyword">const</span> elements = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector);
    elements.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerElement</span>(el));
  }
}
</code></pre>
<h4 data-id="heading-7">ä¸‰ã€å‡½æ•°è®°å¿†åŒ–ï¼ˆMemoizationï¼‰</h4>
<h5 data-id="heading-8">3.1 åŸºç¡€è®°å¿†åŒ–å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">memoize</span>(<span class="hljs-params">fn, options = {}</span>) {
  <span class="hljs-keyword">const</span> {
    maxSize = <span class="hljs-title class_">Infinity</span>,
    keyResolver = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(args),
    ttl = <span class="hljs-literal">null</span>, <span class="hljs-comment">// ç”Ÿå­˜æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
    cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()
  } = options;
  
  <span class="hljs-keyword">const</span> stats = {
    <span class="hljs-attr">hits</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">misses</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">size</span>: <span class="hljs-number">0</span>
  };
  
  <span class="hljs-comment">// åˆ›å»ºLRUç¼“å­˜ï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰</span>
  <span class="hljs-keyword">const</span> lruKeys = [];
  
  <span class="hljs-keyword">const</span> memoized = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-title function_">keyResolver</span>(...args);
    
    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (cache.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-keyword">const</span> entry = cache.<span class="hljs-title function_">get</span>(key);
      
      <span class="hljs-comment">// æ£€æŸ¥TTL</span>
      <span class="hljs-keyword">if</span> (ttl &amp;&amp; <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - entry.<span class="hljs-property">timestamp</span> &gt; ttl) {
        cache.<span class="hljs-title function_">delete</span>(key);
        stats.<span class="hljs-property">size</span>--;
        stats.<span class="hljs-property">misses</span>++;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æ›´æ–°LRUé¡ºåº</span>
        <span class="hljs-keyword">if</span> (maxSize &lt; <span class="hljs-title class_">Infinity</span>) {
          <span class="hljs-keyword">const</span> index = lruKeys.<span class="hljs-title function_">indexOf</span>(key);
          <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
            lruKeys.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            lruKeys.<span class="hljs-title function_">unshift</span>(key);
          }
        }
        
        stats.<span class="hljs-property">hits</span>++;
        <span class="hljs-keyword">return</span> entry.<span class="hljs-property">value</span>;
      }
    }
    
    <span class="hljs-comment">// è®¡ç®—æ–°å€¼</span>
    stats.<span class="hljs-property">misses</span>++;
    <span class="hljs-keyword">const</span> result = fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
    
    <span class="hljs-comment">// ç¼“å­˜ç»“æœ</span>
    <span class="hljs-keyword">const</span> entry = {
      <span class="hljs-attr">value</span>: result,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    };
    
    cache.<span class="hljs-title function_">set</span>(key, entry);
    stats.<span class="hljs-property">size</span>++;
    
    <span class="hljs-comment">// å¤„ç†LRUç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (maxSize &lt; <span class="hljs-title class_">Infinity</span>) {
      lruKeys.<span class="hljs-title function_">unshift</span>(key);
      
      <span class="hljs-keyword">if</span> (cache.<span class="hljs-property">size</span> &gt; maxSize) {
        <span class="hljs-keyword">const</span> lruKey = lruKeys.<span class="hljs-title function_">pop</span>();
        cache.<span class="hljs-title function_">delete</span>(lruKey);
        stats.<span class="hljs-property">size</span>--;
      }
    }
    
    <span class="hljs-keyword">return</span> result;
  };
  
  <span class="hljs-comment">// æ·»åŠ å·¥å…·æ–¹æ³•</span>
  memoized.<span class="hljs-property">clear</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    cache.<span class="hljs-title function_">clear</span>();
    lruKeys.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
    stats.<span class="hljs-property">hits</span> = stats.<span class="hljs-property">misses</span> = stats.<span class="hljs-property">size</span> = <span class="hljs-number">0</span>;
  };
  
  memoized.<span class="hljs-property">delete</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-title function_">keyResolver</span>(...args);
    <span class="hljs-keyword">const</span> deleted = cache.<span class="hljs-title function_">delete</span>(key);
    <span class="hljs-keyword">if</span> (deleted) {
      <span class="hljs-keyword">const</span> index = lruKeys.<span class="hljs-title function_">indexOf</span>(key);
      <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) lruKeys.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
      stats.<span class="hljs-property">size</span>--;
    }
    <span class="hljs-keyword">return</span> deleted;
  };
  
  memoized.<span class="hljs-property">has</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-title function_">keyResolver</span>(...args);
    <span class="hljs-keyword">return</span> cache.<span class="hljs-title function_">has</span>(key);
  };
  
  memoized.<span class="hljs-property">getStats</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> { ...stats };
  };
  
  memoized.<span class="hljs-property">getCache</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(cache);
  };
  
  <span class="hljs-keyword">return</span> memoized;
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">expensiveCalculation</span>(<span class="hljs-params">n</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Calculating...'</span>, n);
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; n * <span class="hljs-number">1000000</span>; i++) {
    result += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(i);
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-keyword">const</span> memoizedCalculation = <span class="hljs-title function_">memoize</span>(expensiveCalculation, {
  <span class="hljs-attr">maxSize</span>: <span class="hljs-number">100</span>,
  <span class="hljs-attr">ttl</span>: <span class="hljs-number">60000</span> <span class="hljs-comment">// 1åˆ†é’Ÿç¼“å­˜</span>
});

<span class="hljs-comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨ä¼šè®¡ç®—</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">memoizedCalculation</span>(<span class="hljs-number">10</span>));
<span class="hljs-comment">// ç¬¬äºŒæ¬¡è°ƒç”¨ç›´æ¥ä»ç¼“å­˜è¯»å–</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">memoizedCalculation</span>(<span class="hljs-number">10</span>));

<span class="hljs-comment">// æŸ¥çœ‹ç»Ÿè®¡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(memoizedCalculation.<span class="hljs-title function_">getStats</span>());
</code></pre>
<h5 data-id="heading-9">3.2 å¼‚æ­¥å‡½æ•°è®°å¿†åŒ–</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">memoizeAsync</span>(<span class="hljs-params">fn, options = {}</span>) {
  <span class="hljs-keyword">const</span> {
    maxSize = <span class="hljs-title class_">Infinity</span>,
    keyResolver = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(args),
    ttl = <span class="hljs-literal">null</span>
  } = options;
  
  <span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  <span class="hljs-keyword">const</span> pendingPromises = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  <span class="hljs-keyword">const</span> lruKeys = [];
  
  <span class="hljs-keyword">const</span> memoized = <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-title function_">keyResolver</span>(...args);
    
    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (cache.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-keyword">const</span> entry = cache.<span class="hljs-title function_">get</span>(key);
      
      <span class="hljs-keyword">if</span> (ttl &amp;&amp; <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - entry.<span class="hljs-property">timestamp</span> &gt; ttl) {
        cache.<span class="hljs-title function_">delete</span>(key);
        <span class="hljs-keyword">const</span> index = lruKeys.<span class="hljs-title function_">indexOf</span>(key);
        <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) lruKeys.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (maxSize &lt; <span class="hljs-title class_">Infinity</span>) {
          <span class="hljs-keyword">const</span> index = lruKeys.<span class="hljs-title function_">indexOf</span>(key);
          <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
            lruKeys.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
            lruKeys.<span class="hljs-title function_">unshift</span>(key);
          }
        }
        <span class="hljs-keyword">return</span> entry.<span class="hljs-property">value</span>;
      }
    }
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å·²ç»åœ¨æ‰§è¡Œä¸­</span>
    <span class="hljs-keyword">if</span> (pendingPromises.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-keyword">return</span> pendingPromises.<span class="hljs-title function_">get</span>(key);
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–°çš„Promise</span>
    <span class="hljs-keyword">const</span> promise = (<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
        
        <span class="hljs-comment">// ç¼“å­˜ç»“æœ</span>
        cache.<span class="hljs-title function_">set</span>(key, {
          <span class="hljs-attr">value</span>: result,
          <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
        });
        
        <span class="hljs-keyword">if</span> (maxSize &lt; <span class="hljs-title class_">Infinity</span>) {
          lruKeys.<span class="hljs-title function_">unshift</span>(key);
          
          <span class="hljs-keyword">if</span> (cache.<span class="hljs-property">size</span> &gt; maxSize) {
            <span class="hljs-keyword">const</span> lruKey = lruKeys.<span class="hljs-title function_">pop</span>();
            cache.<span class="hljs-title function_">delete</span>(lruKey);
          }
        }
        
        <span class="hljs-keyword">return</span> result;
      } <span class="hljs-keyword">finally</span> {
        pendingPromises.<span class="hljs-title function_">delete</span>(key);
      }
    })();
    
    pendingPromises.<span class="hljs-title function_">set</span>(key, promise);
    <span class="hljs-keyword">return</span> promise;
  };
  
  memoized.<span class="hljs-property">clear</span> = <span class="hljs-function">() =&gt;</span> {
    cache.<span class="hljs-title function_">clear</span>();
    pendingPromises.<span class="hljs-title function_">clear</span>();
    lruKeys.<span class="hljs-property">length</span> = <span class="hljs-number">0</span>;
  };
  
  memoized.<span class="hljs-property">delete</span> = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> key = <span class="hljs-title function_">keyResolver</span>(...args);
    <span class="hljs-keyword">const</span> deleted = cache.<span class="hljs-title function_">delete</span>(key);
    <span class="hljs-keyword">if</span> (deleted) {
      <span class="hljs-keyword">const</span> index = lruKeys.<span class="hljs-title function_">indexOf</span>(key);
      <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) lruKeys.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
    }
    pendingPromises.<span class="hljs-title function_">delete</span>(key);
    <span class="hljs-keyword">return</span> deleted;
  };
  
  memoized.<span class="hljs-property">has</span> = <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> key = <span class="hljs-title function_">keyResolver</span>(...args);
    <span class="hljs-keyword">return</span> cache.<span class="hljs-title function_">has</span>(key);
  };
  
  <span class="hljs-keyword">return</span> memoized;
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUserData</span>(<span class="hljs-params">userId</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Fetching user data for:'</span>, userId);
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
  <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();
}

<span class="hljs-keyword">const</span> memoizedFetchUserData = <span class="hljs-title function_">memoizeAsync</span>(fetchUserData, {
  <span class="hljs-attr">ttl</span>: <span class="hljs-number">30000</span> <span class="hljs-comment">// 30ç§’ç¼“å­˜</span>
});

<span class="hljs-comment">// å¤šä¸ªç»„ä»¶åŒæ—¶è¯·æ±‚åŒä¸€ä¸ªç”¨æˆ·æ•°æ®</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
  <span class="hljs-title function_">memoizedFetchUserData</span>(<span class="hljs-number">1</span>),
  <span class="hljs-title function_">memoizedFetchUserData</span>(<span class="hljs-number">1</span>),
  <span class="hljs-title function_">memoizedFetchUserData</span>(<span class="hljs-number">1</span>)
]).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'All results:'</span>, results);
  <span class="hljs-comment">// åªä¼šæœ‰ä¸€æ¬¡å®é™…çš„ç½‘ç»œè¯·æ±‚</span>
});
</code></pre>
<h5 data-id="heading-10">3.3 React Hookè®°å¿†åŒ–</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useRef, useCallback } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">useMemoizedCallback</span>(<span class="hljs-params">fn, dependencies = []</span>) {
  <span class="hljs-keyword">const</span> cacheRef = <span class="hljs-title function_">useRef</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>());
  <span class="hljs-keyword">const</span> fnRef = <span class="hljs-title function_">useRef</span>(fn);
  
  <span class="hljs-comment">// æ›´æ–°å‡½æ•°å¼•ç”¨</span>
  fnRef.<span class="hljs-property">current</span> = fn;
  
  <span class="hljs-keyword">const</span> memoizedFn = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> cache = cacheRef.<span class="hljs-property">current</span>;
    <span class="hljs-keyword">const</span> key = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(args);
    
    <span class="hljs-keyword">if</span> (cache.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-keyword">return</span> cache.<span class="hljs-title function_">get</span>(key);
    }
    
    <span class="hljs-keyword">const</span> result = fnRef.<span class="hljs-title function_">current</span>(...args);
    cache.<span class="hljs-title function_">set</span>(key, result);
    <span class="hljs-keyword">return</span> result;
  }, dependencies);
  
  <span class="hljs-comment">// æ¸…ç†å‡½æ•°</span>
  <span class="hljs-keyword">const</span> clearCache = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
    cacheRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">clear</span>();
  }, []);
  
  <span class="hljs-keyword">return</span> [memoizedFn, clearCache];
}

<span class="hljs-comment">// Reactç»„ä»¶ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ExpensiveComponent</span>(<span class="hljs-params">{ data }</span>) {
  <span class="hljs-keyword">const</span> [processData, clearCache] = <span class="hljs-title function_">useMemoizedCallback</span>(
    <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-comment">// æ˜‚è´µçš„è®¡ç®—</span>
      <span class="hljs-keyword">return</span> item.<span class="hljs-property">value</span> * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(item.<span class="hljs-property">weight</span>);
    },
    [data]
  );
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {data.map(item =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
          {processData(item)}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearCache}</span>&gt;</span>Clear Cache<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-11">å››ã€è¯·æ±‚é˜²é‡å’Œç¼“å­˜ï¼ˆDeduplication &amp; Cachingï¼‰</h4>
<h5 data-id="heading-12">4.1 è¯·æ±‚é˜²é‡ç³»ç»Ÿ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestDeduplicator</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">defaultTtl</span>: <span class="hljs-number">60000</span>, <span class="hljs-comment">// é»˜è®¤ç¼“å­˜æ—¶é—´1åˆ†é’Ÿ</span>
      <span class="hljs-attr">maxCacheSize</span>: <span class="hljs-number">100</span>,
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">duplicatesPrevented</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">cacheHits</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">cacheMisses</span>: <span class="hljs-number">0</span>
    };
  }

  <span class="hljs-title function_">generateKey</span>(<span class="hljs-params">config</span>) {
    <span class="hljs-comment">// ç”Ÿæˆè¯·æ±‚çš„å”¯ä¸€æ ‡è¯†ç¬¦</span>
    <span class="hljs-keyword">const</span> { url, method = <span class="hljs-string">'GET'</span>, params = {}, data = {} } = config;
    
    <span class="hljs-keyword">const</span> keyParts = [
      method.<span class="hljs-title function_">toUpperCase</span>(),
      url,
      <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params),
      <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)
    ];
    
    <span class="hljs-keyword">return</span> keyParts.<span class="hljs-title function_">join</span>(<span class="hljs-string">'|'</span>);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">config</span>) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateKey</span>(config);
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    
    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-keyword">const</span> { data, timestamp } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">get</span>(key);
      <span class="hljs-keyword">const</span> ttl = config.<span class="hljs-property">ttl</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">defaultTtl</span>;
      
      <span class="hljs-keyword">if</span> (now - timestamp &lt; ttl) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">cacheHits</span>++;
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(data);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ç¼“å­˜è¿‡æœŸ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span>.<span class="hljs-title function_">delete</span>(key);
      }
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">cacheMisses</span>++;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦æœ‰ç›¸åŒçš„è¯·æ±‚æ­£åœ¨è¿›è¡Œä¸­</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">duplicatesPrevented</span>++;
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">get</span>(key);
    }
    
    <span class="hljs-comment">// åˆ›å»ºæ–°çš„è¯·æ±‚</span>
    <span class="hljs-keyword">const</span> requestPromise = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeRequest</span>(config);
    
    <span class="hljs-comment">// å­˜å‚¨è¿›è¡Œä¸­çš„è¯·æ±‚</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">set</span>(key, requestPromise);
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> requestPromise;
      
      <span class="hljs-comment">// ç¼“å­˜æˆåŠŸçš„ç»“æœ</span>
      <span class="hljs-keyword">if</span> (config.<span class="hljs-property">cache</span> !== <span class="hljs-literal">false</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">set</span>(key, {
          <span class="hljs-attr">data</span>: result,
          <span class="hljs-attr">timestamp</span>: now
        });
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span>.<span class="hljs-title function_">set</span>(key, now);
        
        <span class="hljs-comment">// æ¸…ç†è¿‡æœŸçš„ç¼“å­˜</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupCache</span>();
      }
      
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-comment">// ç§»é™¤è¿›è¡Œä¸­çš„è¯·æ±‚</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">delete</span>(key);
    }
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">executeRequest</span>(<span class="hljs-params">config</span>) {
    <span class="hljs-keyword">const</span> { url, method = <span class="hljs-string">'GET'</span>, params = {}, data = {}, headers = {} } = config;
    
    <span class="hljs-comment">// æ„å»ºè¯·æ±‚URL</span>
    <span class="hljs-keyword">let</span> requestUrl = url;
    <span class="hljs-keyword">if</span> (params &amp;&amp; <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(params).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> queryString = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>(params).<span class="hljs-title function_">toString</span>();
      requestUrl += <span class="hljs-string">`?<span class="hljs-subst">${queryString}</span>`</span>;
    }
    
    <span class="hljs-comment">// å‘é€è¯·æ±‚</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(requestUrl, {
      method,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>,
        ...headers
      },
      <span class="hljs-attr">body</span>: method !== <span class="hljs-string">'GET'</span> &amp;&amp; method !== <span class="hljs-string">'HEAD'</span> ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data) : <span class="hljs-literal">undefined</span>
    });
    
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Request failed: <span class="hljs-subst">${response.status}</span>`</span>);
    }
    
    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();
  }

  <span class="hljs-title function_">cleanupCache</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> maxAge = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">defaultTtl</span>;
    
    <span class="hljs-comment">// æ¸…ç†è¿‡æœŸç¼“å­˜</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, timestamp] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span>.<span class="hljs-title function_">entries</span>()) {
      <span class="hljs-keyword">if</span> (now - timestamp &gt; maxAge) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span>.<span class="hljs-title function_">delete</span>(key);
      }
    }
    
    <span class="hljs-comment">// æ¸…ç†è¶…å‡ºå¤§å°çš„ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">size</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxCacheSize</span>) {
      <span class="hljs-keyword">const</span> sortedEntries = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span>.<span class="hljs-title function_">entries</span>())
        .<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">[, a], [, b]</span>) =&gt;</span> a - b);
      
      <span class="hljs-keyword">const</span> entriesToRemove = sortedEntries.<span class="hljs-title function_">slice</span>(
        <span class="hljs-number">0</span>,
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">size</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxCacheSize</span>
      );
      
      entriesToRemove.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key]</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span>.<span class="hljs-title function_">delete</span>(key);
      });
    }
  }

  <span class="hljs-comment">// æ‰‹åŠ¨æ¸…ç†ç¼“å­˜</span>
  <span class="hljs-title function_">clearCache</span>(<span class="hljs-params">urlPattern</span>) {
    <span class="hljs-keyword">if</span> (urlPattern) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">keys</span>()) {
        <span class="hljs-keyword">if</span> (key.<span class="hljs-title function_">includes</span>(urlPattern)) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span>.<span class="hljs-title function_">delete</span>(key);
        }
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">clear</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheTimestamps</span>.<span class="hljs-title function_">clear</span>();
    }
  }

  <span class="hljs-comment">// é¢„åŠ è½½æ•°æ®</span>
  <span class="hljs-title function_">prefetch</span>(<span class="hljs-params">config</span>) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateKey</span>(config);
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">has</span>(key) &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-title function_">has</span>(key)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(config).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-comment">// é™é»˜å¤±è´¥ï¼Œé¢„åŠ è½½ä¸å½±å“ä¸»æµç¨‹</span>
      });
    }
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>,
      <span class="hljs-attr">pendingRequests</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pendingRequests</span>.<span class="hljs-property">size</span>,
      <span class="hljs-attr">cachedResponses</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">size</span>
    };
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> deduplicator = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestDeduplicator</span>({
  <span class="hljs-attr">defaultTtl</span>: <span class="hljs-number">30000</span>, <span class="hljs-comment">// 30ç§’</span>
  <span class="hljs-attr">maxCacheSize</span>: <span class="hljs-number">50</span>
});

<span class="hljs-comment">// å¤šä¸ªç»„ä»¶åŒæ—¶è¯·æ±‚ç›¸åŒçš„æ•°æ®</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUserProfile</span>(<span class="hljs-params">userId</span>) {
  <span class="hljs-keyword">const</span> config = {
    <span class="hljs-attr">url</span>: <span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>,
    <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
    <span class="hljs-attr">ttl</span>: <span class="hljs-number">60000</span> <span class="hljs-comment">// æ­¤è¯·æ±‚ç‰¹å®šç¼“å­˜æ—¶é—´</span>
  };
  
  <span class="hljs-keyword">return</span> deduplicator.<span class="hljs-title function_">request</span>(config);
}

<span class="hljs-comment">// åœ¨å¤šä¸ªåœ°æ–¹åŒæ—¶è°ƒç”¨</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
  <span class="hljs-title function_">fetchUserProfile</span>(<span class="hljs-number">1</span>),
  <span class="hljs-title function_">fetchUserProfile</span>(<span class="hljs-number">1</span>),
  <span class="hljs-title function_">fetchUserProfile</span>(<span class="hljs-number">1</span>)
]).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Results:'</span>, results);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Stats:'</span>, deduplicator.<span class="hljs-title function_">getStats</span>());
});

<span class="hljs-comment">// é¢„åŠ è½½</span>
deduplicator.<span class="hljs-title function_">prefetch</span>({
  <span class="hljs-attr">url</span>: <span class="hljs-string">'/api/products'</span>,
  <span class="hljs-attr">params</span>: { <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">limit</span>: <span class="hljs-number">20</span> }
});
</code></pre>
<h5 data-id="heading-13">4.2 åˆ†å±‚ç¼“å­˜ç³»ç»Ÿ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LayeredCache</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">layers</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">defaultTtl</span>: <span class="hljs-number">300000</span>, <span class="hljs-comment">// 5åˆ†é’Ÿ</span>
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">layerHits</span>: {},
      <span class="hljs-attr">totalHits</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">totalMisses</span>: <span class="hljs-number">0</span>
    };
  }

  <span class="hljs-title function_">addLayer</span>(<span class="hljs-params">layer</span>) {
    <span class="hljs-keyword">if</span> (!layer.<span class="hljs-property">get</span> || !layer.<span class="hljs-property">set</span> || !layer.<span class="hljs-property">delete</span> || !layer.<span class="hljs-property">clear</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Cache layer must implement get, set, delete, and clear methods'</span>);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">layers</span>.<span class="hljs-title function_">push</span>(layer);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">layerHits</span>[layer.<span class="hljs-property">name</span> || <span class="hljs-string">`layer_<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.layers.length}</span>`</span>] = <span class="hljs-number">0</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalHits</span>++;
    
    <span class="hljs-comment">// ä»ä¸Šå±‚å¼€å§‹æŸ¥æ‰¾</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">layers</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">const</span> layer = <span class="hljs-variable language_">this</span>.<span class="hljs-property">layers</span>[i];
      <span class="hljs-keyword">const</span> layerName = layer.<span class="hljs-property">name</span> || <span class="hljs-string">`layer_<span class="hljs-subst">${i + <span class="hljs-number">1</span>}</span>`</span>;
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> value = <span class="hljs-keyword">await</span> layer.<span class="hljs-title function_">get</span>(key);
        
        <span class="hljs-keyword">if</span> (value !== <span class="hljs-literal">undefined</span> &amp;&amp; value !== <span class="hljs-literal">null</span>) {
          <span class="hljs-comment">// å‘½ä¸­ï¼Œæ›´æ–°ç»Ÿè®¡</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">layerHits</span>[layerName] = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">layerHits</span>[layerName] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;
          
          <span class="hljs-comment">// å°†æ•°æ®å¤åˆ¶åˆ°ä¸Šå±‚ç¼“å­˜ï¼ˆæå‡ï¼‰</span>
          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; i; j++) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">layers</span>[j].<span class="hljs-title function_">set</span>(key, value, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">defaultTtl</span>).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {});
          }
          
          <span class="hljs-keyword">return</span> value;
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">`Cache layer <span class="hljs-subst">${layerName}</span> error:`</span>, error);
        <span class="hljs-comment">// ç»§ç»­å°è¯•ä¸‹ä¸€å±‚</span>
      }
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalMisses</span>++;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">set</span>(<span class="hljs-params">key, value, ttl = <span class="hljs-variable language_">this</span>.options.defaultTtl</span>) {
    <span class="hljs-comment">// è®¾ç½®æ‰€æœ‰å±‚çº§çš„ç¼“å­˜</span>
    <span class="hljs-keyword">const</span> promises = <span class="hljs-variable language_">this</span>.<span class="hljs-property">layers</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">layer</span> =&gt;</span> 
      layer.<span class="hljs-title function_">set</span>(key, value, ttl).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {})
    );
    
    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises);
    <span class="hljs-keyword">return</span> value;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-comment">// åˆ é™¤æ‰€æœ‰å±‚çº§çš„ç¼“å­˜</span>
    <span class="hljs-keyword">const</span> promises = <span class="hljs-variable language_">this</span>.<span class="hljs-property">layers</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">layer</span> =&gt;</span> 
      layer.<span class="hljs-title function_">delete</span>(key).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {})
    );
    
    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> promises = <span class="hljs-variable language_">this</span>.<span class="hljs-property">layers</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">layer</span> =&gt;</span> 
      layer.<span class="hljs-title function_">clear</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {})
    );
    
    <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises);
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>,
      <span class="hljs-attr">hitRate</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalHits</span> &gt; <span class="hljs-number">0</span> 
        ? (<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalHits</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalMisses</span>) / <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalHits</span> 
        : <span class="hljs-number">0</span>
    };
  }
}

<span class="hljs-comment">// å†…å­˜ç¼“å­˜å±‚å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryCacheLayer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name = <span class="hljs-string">'memory'</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">get</span>(key);
    
    <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">undefined</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    
    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">get</span>(key);
    <span class="hljs-keyword">if</span> (timestamp &amp;&amp; <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &gt; timestamp) {
      <span class="hljs-comment">// å·²è¿‡æœŸ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">delete</span>(key);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">return</span> value;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">set</span>(<span class="hljs-params">key, value, ttl</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">set</span>(key, value);
    
    <span class="hljs-keyword">if</span> (ttl) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">set</span>(key, <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + ttl);
    }
    
    <span class="hljs-keyword">return</span> value;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">delete</span>(key);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">clear</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timestamps</span>.<span class="hljs-title function_">clear</span>();
  }
}

<span class="hljs-comment">// IndexedDBç¼“å­˜å±‚å®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">IndexedDBCacheLayer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name = <span class="hljs-string">'indexeddb'</span>, dbName = <span class="hljs-string">'cache_db'</span>, storeName = <span class="hljs-string">'cache_store'</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span> = dbName;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span> = storeName;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span> = <span class="hljs-literal">null</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initDB</span>();
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initDB</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> request = indexedDB.<span class="hljs-title function_">open</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span>, <span class="hljs-number">1</span>);
      
      request.<span class="hljs-property">onupgradeneeded</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> db = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
        <span class="hljs-keyword">if</span> (!db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>)) {
          db.<span class="hljs-title function_">createObjectStore</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>);
        }
      };
      
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span> = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
        <span class="hljs-title function_">resolve</span>();
      };
      
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-title function_">reject</span>(event.<span class="hljs-property">target</span>.<span class="hljs-property">error</span>);
      };
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initDB</span>();
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> transaction = <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>], <span class="hljs-string">'readonly'</span>);
      <span class="hljs-keyword">const</span> store = transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>);
      <span class="hljs-keyword">const</span> request = store.<span class="hljs-title function_">get</span>(key);
      
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">const</span> result = request.<span class="hljs-property">result</span>;
        <span class="hljs-keyword">if</span> (result &amp;&amp; result.<span class="hljs-property">expires</span> &amp;&amp; <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() &gt; result.<span class="hljs-property">expires</span>) {
          <span class="hljs-comment">// å·²è¿‡æœŸï¼Œåˆ é™¤</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">delete</span>(key);
          <span class="hljs-title function_">resolve</span>(<span class="hljs-literal">null</span>);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>(result ? result.<span class="hljs-property">value</span> : <span class="hljs-literal">null</span>);
        }
      };
      
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(request.<span class="hljs-property">error</span>);
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">set</span>(<span class="hljs-params">key, value, ttl</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initDB</span>();
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> transaction = <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>], <span class="hljs-string">'readwrite'</span>);
      <span class="hljs-keyword">const</span> store = transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>);
      
      <span class="hljs-keyword">const</span> item = {
        value,
        <span class="hljs-attr">expires</span>: ttl ? <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() + ttl : <span class="hljs-literal">null</span>,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
      };
      
      <span class="hljs-keyword">const</span> request = store.<span class="hljs-title function_">put</span>(item, key);
      
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(value);
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(request.<span class="hljs-property">error</span>);
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">delete</span>(<span class="hljs-params">key</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initDB</span>();
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> transaction = <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>], <span class="hljs-string">'readwrite'</span>);
      <span class="hljs-keyword">const</span> store = transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>);
      <span class="hljs-keyword">const</span> request = store.<span class="hljs-title function_">delete</span>(key);
      
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>();
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(request.<span class="hljs-property">error</span>);
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initDB</span>();
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> transaction = <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>], <span class="hljs-string">'readwrite'</span>);
      <span class="hljs-keyword">const</span> store = transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>);
      <span class="hljs-keyword">const</span> request = store.<span class="hljs-title function_">clear</span>();
      
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>();
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">reject</span>(request.<span class="hljs-property">error</span>);
    });
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LayeredCache</span>({
  <span class="hljs-attr">defaultTtl</span>: <span class="hljs-number">300000</span> <span class="hljs-comment">// 5åˆ†é’Ÿ</span>
});

<span class="hljs-comment">// æ·»åŠ å†…å­˜ç¼“å­˜å±‚ï¼ˆå¿«é€Ÿï¼‰</span>
cache.<span class="hljs-title function_">addLayer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MemoryCacheLayer</span>(<span class="hljs-string">'memory'</span>));

<span class="hljs-comment">// æ·»åŠ IndexedDBç¼“å­˜å±‚ï¼ˆæŒä¹…åŒ–ï¼‰</span>
cache.<span class="hljs-title function_">addLayer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexedDBCacheLayer</span>(<span class="hljs-string">'indexeddb'</span>));

<span class="hljs-comment">// ä½¿ç”¨ç¼“å­˜</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getCachedData</span>(<span class="hljs-params">key</span>) {
  <span class="hljs-keyword">let</span> data = <span class="hljs-keyword">await</span> cache.<span class="hljs-title function_">get</span>(key);
  
  <span class="hljs-keyword">if</span> (!data) {
    <span class="hljs-comment">// ä»ç½‘ç»œè·å–æ•°æ®</span>
    data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchDataFromNetwork</span>();
    <span class="hljs-keyword">await</span> cache.<span class="hljs-title function_">set</span>(key, data);
  }
  
  <span class="hljs-keyword">return</span> data;
}
</code></pre>
<h4 data-id="heading-14">äº”ã€æ—¶é—´åˆ‡ç‰‡ï¼ˆTime Slicingï¼‰</h4>
<h5 data-id="heading-15">5.1 åŸºäºrequestIdleCallbackçš„å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TimeSlicer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">timeout</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// è¶…æ—¶æ—¶é—´</span>
      <span class="hljs-attr">taskChunkSize</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// æ¯ä¸ªæ—¶é—´ç‰‡å¤„ç†çš„ä»»åŠ¡æ•°</span>
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deferred</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">tasksProcessed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">timeSlicesUsed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">totalTime</span>: <span class="hljs-number">0</span>
    };
  }

  <span class="hljs-title function_">addTask</span>(<span class="hljs-params">task</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> task !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Task must be a function'</span>);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-title function_">push</span>(task);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">addTasks</span>(<span class="hljs-params">tasks</span>) {
    tasks.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">task</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">addTask</span>(task));
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">process</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Already processing'</span>));
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">tasksProcessed</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">timeSlicesUsed</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalTime</span> = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">deferred</span> = { resolve, reject };
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processNextChunk</span>();
    });
  }

  <span class="hljs-title function_">processNextChunk</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> startTime = performance.<span class="hljs-title function_">now</span>();
    
    <span class="hljs-comment">// å¤„ç†ä¸€ä¸ªæ—¶é—´ç‰‡çš„ä»»åŠ¡</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">taskChunkSize</span>; i++) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">finishProcessing</span>();
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> task = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span>];
        <span class="hljs-title function_">task</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span>++;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">tasksProcessed</span>++;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleError</span>(error);
        <span class="hljs-keyword">return</span>;
      }
    }
    
    <span class="hljs-keyword">const</span> endTime = performance.<span class="hljs-title function_">now</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalTime</span> += endTime - startTime;
    
    <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¿˜æœ‰ä»»åŠ¡</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span>.<span class="hljs-property">length</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">timeSlicesUsed</span>++;
      
      <span class="hljs-comment">// ä½¿ç”¨requestIdleCallbackå®‰æ’ä¸‹ä¸€ä¸ªæ—¶é—´ç‰‡</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-string">'requestIdleCallback'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
        <span class="hljs-title function_">requestIdleCallback</span>(
          <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processNextChunk</span>(),
          { <span class="hljs-attr">timeout</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">timeout</span> }
        );
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨setTimeout</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processNextChunk</span>(), <span class="hljs-number">0</span>);
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">finishProcessing</span>();
    }
  }

  <span class="hljs-title function_">finishProcessing</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deferred</span>.<span class="hljs-title function_">resolve</span>({
      <span class="hljs-attr">tasksProcessed</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">tasksProcessed</span>,
      <span class="hljs-attr">timeSlicesUsed</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">timeSlicesUsed</span>,
      <span class="hljs-attr">totalTime</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalTime</span>
    });
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deferred</span> = <span class="hljs-literal">null</span>;
  }

  <span class="hljs-title function_">handleError</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deferred</span>.<span class="hljs-title function_">reject</span>(error);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">deferred</span> = <span class="hljs-literal">null</span>;
  }

  <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">tasks</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentIndex</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> };
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createExpensiveTask</span>(<span class="hljs-params">id</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Processing task <span class="hljs-subst">${id}</span>`</span>);
    <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ</span>
    <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
      sum += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(i);
    }
    <span class="hljs-keyword">return</span> sum;
  };
}

<span class="hljs-comment">// åˆ›å»ºæ—¶é—´åˆ‡ç‰‡å¤„ç†å™¨</span>
<span class="hljs-keyword">const</span> slicer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeSlicer</span>({
  <span class="hljs-attr">taskChunkSize</span>: <span class="hljs-number">50</span>, <span class="hljs-comment">// æ¯ä¸ªæ—¶é—´ç‰‡å¤„ç†50ä¸ªä»»åŠ¡</span>
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">2000</span> <span class="hljs-comment">// 2ç§’è¶…æ—¶</span>
});

<span class="hljs-comment">// æ·»åŠ å¤§é‡ä»»åŠ¡</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
  slicer.<span class="hljs-title function_">addTask</span>(<span class="hljs-title function_">createExpensiveTask</span>(i));
}

<span class="hljs-comment">// å¼€å§‹å¤„ç†</span>
slicer.<span class="hljs-title function_">process</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">stats</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Processing completed:'</span>, stats);
}).<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Processing failed:'</span>, error);
});

<span class="hljs-comment">// å¯ä»¥åœ¨å¤„ç†è¿‡ç¨‹ä¸­æ·»åŠ æ–°ä»»åŠ¡</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  slicer.<span class="hljs-title function_">addTask</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'New task added during processing'</span>));
}, <span class="hljs-number">1000</span>);
</code></pre>
<h5 data-id="heading-16">5.2 åŸºäºGeneratorçš„æ—¶é—´åˆ‡ç‰‡</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>* <span class="hljs-title function_">taskGenerator</span>(<span class="hljs-params">tasks</span>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; tasks.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">yield</span> tasks[i];
  }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">GeneratorTimeSlicer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">timePerSlice</span>: <span class="hljs-number">16</span>, <span class="hljs-comment">// æ¯ä¸ªæ—¶é—´ç‰‡16msï¼ˆå¤§çº¦ä¸€å¸§çš„æ—¶é—´ï¼‰</span>
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskGenerator</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">tasksProcessed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">slicesUsed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">totalTime</span>: <span class="hljs-number">0</span>
    };
  }

  <span class="hljs-title function_">processTasks</span>(<span class="hljs-params">tasks</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Already processing'</span>));
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskGenerator</span> = <span class="hljs-title function_">taskGenerator</span>(tasks);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = { <span class="hljs-attr">tasksProcessed</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">slicesUsed</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">totalTime</span>: <span class="hljs-number">0</span> };
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processNextSlice</span>(resolve, reject);
    });
  }

  <span class="hljs-title function_">processNextSlice</span>(<span class="hljs-params">resolve, reject</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> sliceStart = performance.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">let</span> taskResult;
    
    <span class="hljs-comment">// å¤„ç†ä¸€ä¸ªæ—¶é—´ç‰‡</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
      <span class="hljs-keyword">const</span> { <span class="hljs-attr">value</span>: task, done } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskGenerator</span>.<span class="hljs-title function_">next</span>();
      
      <span class="hljs-keyword">if</span> (done) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-title function_">resolve</span>({
          ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span>
        });
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-keyword">try</span> {
        taskResult = <span class="hljs-title function_">task</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">tasksProcessed</span>++;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
        <span class="hljs-title function_">reject</span>(error);
        <span class="hljs-keyword">return</span>;
      }
      
      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¶…è¿‡æ—¶é—´ç‰‡é™åˆ¶</span>
      <span class="hljs-keyword">if</span> (performance.<span class="hljs-title function_">now</span>() - sliceStart &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">timePerSlice</span>) {
        <span class="hljs-keyword">break</span>;
      }
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">slicesUsed</span>++;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalTime</span> += performance.<span class="hljs-title function_">now</span>() - sliceStart;
    
    <span class="hljs-comment">// å®‰æ’ä¸‹ä¸€ä¸ªæ—¶é—´ç‰‡</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'requestAnimationFrame'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
      <span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processNextSlice</span>(resolve, reject));
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processNextSlice</span>(resolve, reject), <span class="hljs-number">0</span>);
    }
  }

  <span class="hljs-title function_">stop</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ï¼šå¤„ç†å¤§å‹æ•°ç»„</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">processLargeArray</span>(<span class="hljs-params">array, processItem, chunkSize = <span class="hljs-number">100</span></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> results = [];
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">processChunk</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">const</span> chunkStart = performance.<span class="hljs-title function_">now</span>();
      
      <span class="hljs-keyword">while</span> (index &lt; array.<span class="hljs-property">length</span>) {
        results.<span class="hljs-title function_">push</span>(<span class="hljs-title function_">processItem</span>(array[index]));
        index++;
        
        <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦å¤„ç†äº†è¶³å¤Ÿå¤šçš„é¡¹ç›®æˆ–æ—¶é—´åˆ°äº†</span>
        <span class="hljs-keyword">if</span> (index % chunkSize === <span class="hljs-number">0</span> || 
            performance.<span class="hljs-title function_">now</span>() - chunkStart &gt; <span class="hljs-number">16</span>) {
          <span class="hljs-keyword">break</span>;
        }
      }
      
      <span class="hljs-keyword">if</span> (index &lt; array.<span class="hljs-property">length</span>) {
        <span class="hljs-comment">// è¿˜æœ‰æ›´å¤šé¡¹ç›®ï¼Œå®‰æ’ä¸‹ä¸€ä¸ªæ—¶é—´ç‰‡</span>
        <span class="hljs-title function_">requestAnimationFrame</span>(processChunk);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// å®Œæˆ</span>
        <span class="hljs-title function_">resolve</span>(results);
      }
    }
    
    <span class="hljs-comment">// å¼€å§‹å¤„ç†</span>
    <span class="hljs-title function_">requestAnimationFrame</span>(processChunk);
  });
}

<span class="hljs-comment">// å¤„ç†10ä¸‡ä¸ªé¡¹ç›®</span>
<span class="hljs-keyword">const</span> largeArray = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">100000</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> i);

<span class="hljs-title function_">processLargeArray</span>(largeArray, <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
  <span class="hljs-comment">// å¯¹æ¯ä¸ªé¡¹ç›®è¿›è¡Œä¸€äº›å¤„ç†</span>
  <span class="hljs-keyword">return</span> item * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(item);
}, <span class="hljs-number">1000</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Processed <span class="hljs-subst">${results.length}</span> items`</span>);
});
</code></pre>
<h4 data-id="heading-17">å…­ã€å‡½æ•°èŠ‚æµä¸é˜²æŠ–ï¼ˆThrottle &amp; Debounceï¼‰</h4>
<h5 data-id="heading-18">6.1 é«˜çº§èŠ‚æµä¸é˜²æŠ–å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AdvancedThrottleDebounce</span> {
  <span class="hljs-comment">// èŠ‚æµï¼šç¡®ä¿å‡½æ•°åœ¨ä¸€å®šæ—¶é—´å†…åªæ‰§è¡Œä¸€æ¬¡</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">throttle</span>(<span class="hljs-params">func, wait, options = {}</span>) {
    <span class="hljs-keyword">let</span> timeout = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> previous = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> result;
    <span class="hljs-keyword">let</span> context;
    <span class="hljs-keyword">let</span> args;
    
    <span class="hljs-keyword">const</span> { leading = <span class="hljs-literal">true</span>, trailing = <span class="hljs-literal">true</span> } = options;
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">later</span> = (<span class="hljs-params"/>) =&gt; {
      previous = !leading ? <span class="hljs-number">0</span> : <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      timeout = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">if</span> (trailing &amp;&amp; args) {
        result = func.<span class="hljs-title function_">apply</span>(context, args);
        context = args = <span class="hljs-literal">null</span>;
      }
    };
    
    <span class="hljs-keyword">const</span> throttled = <span class="hljs-keyword">function</span>(<span class="hljs-params">...params</span>) {
      <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      
      <span class="hljs-keyword">if</span> (!previous &amp;&amp; !leading) {
        previous = now;
      }
      
      <span class="hljs-keyword">const</span> remaining = wait - (now - previous);
      context = <span class="hljs-variable language_">this</span>;
      args = params;
      
      <span class="hljs-keyword">if</span> (remaining &lt;= <span class="hljs-number">0</span> || remaining &gt; wait) {
        <span class="hljs-keyword">if</span> (timeout) {
          <span class="hljs-built_in">clearTimeout</span>(timeout);
          timeout = <span class="hljs-literal">null</span>;
        }
        previous = now;
        result = func.<span class="hljs-title function_">apply</span>(context, args);
        context = args = <span class="hljs-literal">null</span>;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!timeout &amp;&amp; trailing) {
        timeout = <span class="hljs-built_in">setTimeout</span>(later, remaining);
      }
      
      <span class="hljs-keyword">return</span> result;
    };
    
    throttled.<span class="hljs-property">cancel</span> = <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-built_in">clearTimeout</span>(timeout);
      previous = <span class="hljs-number">0</span>;
      timeout = context = args = <span class="hljs-literal">null</span>;
    };
    
    <span class="hljs-keyword">return</span> throttled;
  }

  <span class="hljs-comment">// é˜²æŠ–ï¼šç¡®ä¿å‡½æ•°åœ¨æœ€åä¸€æ¬¡è°ƒç”¨åä¸€å®šæ—¶é—´æ‰æ‰§è¡Œ</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">debounce</span>(<span class="hljs-params">func, wait, options = {}</span>) {
    <span class="hljs-keyword">let</span> timeout = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">let</span> result;
    <span class="hljs-keyword">let</span> context;
    <span class="hljs-keyword">let</span> args;
    <span class="hljs-keyword">let</span> lastCallTime;
    <span class="hljs-keyword">let</span> lastInvokeTime = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">const</span> { 
      leading = <span class="hljs-literal">false</span>, 
      trailing = <span class="hljs-literal">true</span>,
      maxWait 
    } = options;
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">invokeFunc</span> = (<span class="hljs-params">time</span>) =&gt; {
      lastInvokeTime = time;
      result = func.<span class="hljs-title function_">apply</span>(context, args);
      context = args = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">return</span> result;
    };
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">leadingEdge</span> = (<span class="hljs-params">time</span>) =&gt; {
      lastInvokeTime = time;
      
      <span class="hljs-keyword">if</span> (trailing) {
        timeout = <span class="hljs-built_in">setTimeout</span>(timerExpired, wait);
      }
      
      <span class="hljs-keyword">return</span> leading ? <span class="hljs-title function_">invokeFunc</span>(time) : result;
    };
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">remainingWait</span> = (<span class="hljs-params">time</span>) =&gt; {
      <span class="hljs-keyword">const</span> timeSinceLastCall = time - lastCallTime;
      <span class="hljs-keyword">const</span> timeSinceLastInvoke = time - lastInvokeTime;
      <span class="hljs-keyword">const</span> timeWaiting = wait - timeSinceLastCall;
      
      <span class="hljs-keyword">return</span> maxWait === <span class="hljs-literal">undefined</span>
        ? timeWaiting
        : <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(timeWaiting, maxWait - timeSinceLastInvoke);
    };
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">shouldInvoke</span> = (<span class="hljs-params">time</span>) =&gt; {
      <span class="hljs-keyword">const</span> timeSinceLastCall = time - lastCallTime;
      <span class="hljs-keyword">const</span> timeSinceLastInvoke = time - lastInvokeTime;
      
      <span class="hljs-keyword">return</span> (
        lastCallTime === <span class="hljs-literal">undefined</span> || 
        timeSinceLastCall &gt;= wait ||
        timeSinceLastCall &lt; <span class="hljs-number">0</span> ||
        (maxWait !== <span class="hljs-literal">undefined</span> &amp;&amp; timeSinceLastInvoke &gt;= maxWait)
      );
    };
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">timerExpired</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">const</span> time = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">shouldInvoke</span>(time)) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">trailingEdge</span>(time);
      }
      timeout = <span class="hljs-built_in">setTimeout</span>(timerExpired, <span class="hljs-title function_">remainingWait</span>(time));
    };
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">trailingEdge</span> = (<span class="hljs-params">time</span>) =&gt; {
      timeout = <span class="hljs-literal">null</span>;
      
      <span class="hljs-keyword">if</span> (trailing &amp;&amp; args) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">invokeFunc</span>(time);
      }
      
      context = args = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">return</span> result;
    };
    
    <span class="hljs-keyword">const</span> debounced = <span class="hljs-keyword">function</span>(<span class="hljs-params">...params</span>) {
      <span class="hljs-keyword">const</span> time = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      <span class="hljs-keyword">const</span> isInvoking = <span class="hljs-title function_">shouldInvoke</span>(time);
      
      context = <span class="hljs-variable language_">this</span>;
      args = params;
      lastCallTime = time;
      
      <span class="hljs-keyword">if</span> (isInvoking) {
        <span class="hljs-keyword">if</span> (!timeout &amp;&amp; leading) {
          <span class="hljs-keyword">return</span> <span class="hljs-title function_">leadingEdge</span>(lastCallTime);
        }
        
        <span class="hljs-keyword">if</span> (maxWait !== <span class="hljs-literal">undefined</span>) {
          timeout = <span class="hljs-built_in">setTimeout</span>(timerExpired, wait);
          <span class="hljs-keyword">return</span> <span class="hljs-title function_">invokeFunc</span>(lastCallTime);
        }
      }
      
      <span class="hljs-keyword">if</span> (!timeout) {
        timeout = <span class="hljs-built_in">setTimeout</span>(timerExpired, wait);
      }
      
      <span class="hljs-keyword">return</span> result;
    };
    
    debounced.<span class="hljs-property">cancel</span> = <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (timeout !== <span class="hljs-literal">null</span>) {
        <span class="hljs-built_in">clearTimeout</span>(timeout);
      }
      lastInvokeTime = <span class="hljs-number">0</span>;
      lastCallTime = <span class="hljs-number">0</span>;
      timeout = context = args = <span class="hljs-literal">null</span>;
    };
    
    debounced.<span class="hljs-property">flush</span> = <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">return</span> timeout ? <span class="hljs-title function_">trailingEdge</span>(<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()) : result;
    };
    
    <span class="hljs-keyword">return</span> debounced;
  }

  <span class="hljs-comment">// ç«‹å³æ‰§è¡Œçš„é˜²æŠ–ï¼ˆç¬¬ä¸€æ¬¡ç«‹å³æ‰§è¡Œï¼Œç„¶åé˜²æŠ–ï¼‰</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">immediateDebounce</span>(<span class="hljs-params">func, wait</span>) {
    <span class="hljs-keyword">let</span> timeout;
    <span class="hljs-keyword">let</span> immediate = <span class="hljs-literal">true</span>;
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
      <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>;
      
      <span class="hljs-keyword">if</span> (immediate) {
        func.<span class="hljs-title function_">apply</span>(context, args);
        immediate = <span class="hljs-literal">false</span>;
      }
      
      <span class="hljs-built_in">clearTimeout</span>(timeout);
      timeout = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        immediate = <span class="hljs-literal">true</span>;
      }, wait);
    };
  }

  <span class="hljs-comment">// èŠ‚æµ+é˜²æŠ–ç»„åˆ</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">throttleDebounce</span>(<span class="hljs-params">func, wait, options = {}</span>) {
    <span class="hljs-keyword">const</span> {
      throttleWait = wait,
      debounceWait = wait,
      leading = <span class="hljs-literal">true</span>,
      trailing = <span class="hljs-literal">true</span>
    } = options;
    
    <span class="hljs-keyword">const</span> throttled = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">throttle</span>(func, throttleWait, { leading, trailing });
    <span class="hljs-keyword">const</span> debounced = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">debounce</span>(func, debounceWait, { leading, trailing });
    
    <span class="hljs-keyword">let</span> lastCall = <span class="hljs-number">0</span>;
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
      <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      <span class="hljs-keyword">const</span> timeSinceLastCall = now - lastCall;
      lastCall = now;
      
      <span class="hljs-comment">// å¦‚æœè·ç¦»ä¸Šæ¬¡è°ƒç”¨æ—¶é—´å¾ˆçŸ­ï¼Œä½¿ç”¨é˜²æŠ–</span>
      <span class="hljs-keyword">if</span> (timeSinceLastCall &lt; throttleWait) {
        <span class="hljs-keyword">return</span> debounced.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      }
      
      <span class="hljs-comment">// å¦åˆ™ä½¿ç”¨èŠ‚æµ</span>
      <span class="hljs-keyword">return</span> throttled.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
    };
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-comment">// èŠ‚æµç¤ºä¾‹ï¼šæ»šåŠ¨äº‹ä»¶</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-title class_">AdvancedThrottleDebounce</span>.<span class="hljs-title function_">throttle</span>(
  <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Scroll position:'</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">scrollY</span>);
  },
  <span class="hljs-number">100</span>,
  { <span class="hljs-attr">leading</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">trailing</span>: <span class="hljs-literal">true</span> }
));

<span class="hljs-comment">// é˜²æŠ–ç¤ºä¾‹ï¼šæœç´¢è¾“å…¥</span>
<span class="hljs-keyword">const</span> searchInput = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'search'</span>);
searchInput.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'input'</span>, <span class="hljs-title class_">AdvancedThrottleDebounce</span>.<span class="hljs-title function_">debounce</span>(
  <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Searching for:'</span>, event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>);
    <span class="hljs-comment">// å®é™…æœç´¢é€»è¾‘</span>
  },
  <span class="hljs-number">300</span>,
  { <span class="hljs-attr">leading</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">trailing</span>: <span class="hljs-literal">true</span> }
));

<span class="hljs-comment">// ç«‹å³æ‰§è¡Œçš„é˜²æŠ–ç¤ºä¾‹ï¼šæŒ‰é’®ç‚¹å‡»</span>
<span class="hljs-keyword">const</span> submitButton = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'submit'</span>);
submitButton.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-title class_">AdvancedThrottleDebounce</span>.<span class="hljs-title function_">immediateDebounce</span>(
  <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Submit clicked'</span>);
    <span class="hljs-comment">// æäº¤é€»è¾‘</span>
  },
  <span class="hljs-number">1000</span>
));

<span class="hljs-comment">// ç»„åˆç¤ºä¾‹ï¼šè°ƒæ•´çª—å£å¤§å°</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-title class_">AdvancedThrottleDebounce</span>.<span class="hljs-title function_">throttleDebounce</span>(
  <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Window resized'</span>);
    <span class="hljs-comment">// è°ƒæ•´å¸ƒå±€é€»è¾‘</span>
  },
  <span class="hljs-number">200</span>,
  { <span class="hljs-attr">throttleWait</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">debounceWait</span>: <span class="hljs-number">300</span> }
));
</code></pre>
<h5 data-id="heading-19">6.2 React Hookç‰ˆæœ¬çš„èŠ‚æµé˜²æŠ–</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useRef, useCallback, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// ä½¿ç”¨Hookå®ç°èŠ‚æµ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useThrottle</span>(<span class="hljs-params">callback, delay, options = {}</span>) {
  <span class="hljs-keyword">const</span> { leading = <span class="hljs-literal">true</span>, trailing = <span class="hljs-literal">true</span> } = options;
  <span class="hljs-keyword">const</span> lastCallTime = <span class="hljs-title function_">useRef</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> timeout = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> lastArgs = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> lastThis = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  
  <span class="hljs-keyword">const</span> throttled = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    lastArgs.<span class="hljs-property">current</span> = args;
    lastThis.<span class="hljs-property">current</span> = <span class="hljs-variable language_">this</span>;
    
    <span class="hljs-keyword">if</span> (!leading &amp;&amp; !lastCallTime.<span class="hljs-property">current</span>) {
      lastCallTime.<span class="hljs-property">current</span> = now;
    }
    
    <span class="hljs-keyword">const</span> remaining = delay - (now - lastCallTime.<span class="hljs-property">current</span>);
    
    <span class="hljs-keyword">if</span> (remaining &lt;= <span class="hljs-number">0</span> || remaining &gt; delay) {
      <span class="hljs-keyword">if</span> (timeout.<span class="hljs-property">current</span>) {
        <span class="hljs-built_in">clearTimeout</span>(timeout.<span class="hljs-property">current</span>);
        timeout.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
      }
      
      lastCallTime.<span class="hljs-property">current</span> = now;
      callback.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      lastArgs.<span class="hljs-property">current</span> = lastThis.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!timeout.<span class="hljs-property">current</span> &amp;&amp; trailing) {
      timeout.<span class="hljs-property">current</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        lastCallTime.<span class="hljs-property">current</span> = leading ? <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() : <span class="hljs-number">0</span>;
        timeout.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
        
        <span class="hljs-keyword">if</span> (trailing &amp;&amp; lastArgs.<span class="hljs-property">current</span>) {
          callback.<span class="hljs-title function_">apply</span>(lastThis.<span class="hljs-property">current</span>, lastArgs.<span class="hljs-property">current</span>);
          lastArgs.<span class="hljs-property">current</span> = lastThis.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
        }
      }, remaining);
    }
  }, [callback, delay, leading, trailing]);
  
  <span class="hljs-comment">// æ¸…ç†å‡½æ•°</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (timeout.<span class="hljs-property">current</span>) {
        <span class="hljs-built_in">clearTimeout</span>(timeout.<span class="hljs-property">current</span>);
      }
    };
  }, []);
  
  <span class="hljs-keyword">return</span> throttled;
}

<span class="hljs-comment">// ä½¿ç”¨Hookå®ç°é˜²æŠ–</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useDebounce</span>(<span class="hljs-params">callback, delay, options = {}</span>) {
  <span class="hljs-keyword">const</span> { leading = <span class="hljs-literal">false</span>, maxWait } = options;
  <span class="hljs-keyword">const</span> lastCallTime = <span class="hljs-title function_">useRef</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> lastInvokeTime = <span class="hljs-title function_">useRef</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> timeout = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> lastArgs = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> lastThis = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  
  <span class="hljs-keyword">const</span> debounced = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    
    lastArgs.<span class="hljs-property">current</span> = args;
    lastThis.<span class="hljs-property">current</span> = <span class="hljs-variable language_">this</span>;
    lastCallTime.<span class="hljs-property">current</span> = now;
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">invokeFunc</span> = (<span class="hljs-params"/>) =&gt; {
      lastInvokeTime.<span class="hljs-property">current</span> = now;
      callback.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      lastArgs.<span class="hljs-property">current</span> = lastThis.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
    };
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">shouldInvoke</span> = (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">const</span> timeSinceLastCall = now - lastCallTime.<span class="hljs-property">current</span>;
      <span class="hljs-keyword">const</span> timeSinceLastInvoke = now - lastInvokeTime.<span class="hljs-property">current</span>;
      
      <span class="hljs-keyword">return</span> (
        lastCallTime.<span class="hljs-property">current</span> === <span class="hljs-number">0</span> ||
        timeSinceLastCall &gt;= delay ||
        timeSinceLastCall &lt; <span class="hljs-number">0</span> ||
        (maxWait !== <span class="hljs-literal">undefined</span> &amp;&amp; timeSinceLastInvoke &gt;= maxWait)
      );
    };
    
    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">shouldInvoke</span>()) {
      <span class="hljs-keyword">if</span> (!timeout.<span class="hljs-property">current</span> &amp;&amp; leading) {
        <span class="hljs-title function_">invokeFunc</span>();
      }
      
      <span class="hljs-keyword">if</span> (maxWait !== <span class="hljs-literal">undefined</span>) {
        timeout.<span class="hljs-property">current</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-keyword">if</span> (timeout.<span class="hljs-property">current</span>) {
            <span class="hljs-built_in">clearTimeout</span>(timeout.<span class="hljs-property">current</span>);
            timeout.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
          }
          <span class="hljs-title function_">invokeFunc</span>();
        }, delay);
        <span class="hljs-keyword">return</span>;
      }
    }
    
    <span class="hljs-keyword">if</span> (!timeout.<span class="hljs-property">current</span>) {
      timeout.<span class="hljs-property">current</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        timeout.<span class="hljs-property">current</span> = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">if</span> (lastArgs.<span class="hljs-property">current</span>) {
          <span class="hljs-title function_">invokeFunc</span>();
        }
      }, delay);
    }
  }, [callback, delay, leading, maxWait]);
  
  <span class="hljs-comment">// æ¸…ç†å‡½æ•°</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (timeout.<span class="hljs-property">current</span>) {
        <span class="hljs-built_in">clearTimeout</span>(timeout.<span class="hljs-property">current</span>);
      }
    };
  }, []);
  
  <span class="hljs-keyword">return</span> debounced;
}

<span class="hljs-comment">// Reactç»„ä»¶ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">SearchComponent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [query, setQuery] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> [results, setResults] = <span class="hljs-title function_">useState</span>([]);
  
  <span class="hljs-comment">// é˜²æŠ–æœç´¢å‡½æ•°</span>
  <span class="hljs-keyword">const</span> debouncedSearch = <span class="hljs-title function_">useDebounce</span>(<span class="hljs-keyword">async</span> (searchQuery) =&gt; {
    <span class="hljs-keyword">if</span> (!searchQuery.<span class="hljs-title function_">trim</span>()) {
      <span class="hljs-title function_">setResults</span>([]);
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/search?q=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(searchQuery)}</span>`</span>);
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    <span class="hljs-title function_">setResults</span>(data);
  }, <span class="hljs-number">300</span>);
  
  <span class="hljs-keyword">const</span> handleInputChange = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> value = event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>;
    <span class="hljs-title function_">setQuery</span>(value);
    <span class="hljs-title function_">debouncedSearch</span>(value);
  }, [debouncedSearch]);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> 
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
        <span class="hljs-attr">value</span>=<span class="hljs-string">{query}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Search..."</span>
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {results.map(result =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{result.id}</span>&gt;</span>{result.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-20">ä¸ƒã€å¹¶å‘æ§åˆ¶ä¸è¯·æ±‚æ± ï¼ˆConcurrency Control &amp; Request Poolï¼‰</h4>
<h5 data-id="heading-21">7.1 æ™ºèƒ½è¯·æ±‚æ± å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestPool</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">maxConcurrent</span>: <span class="hljs-number">6</span>, <span class="hljs-comment">// æœ€å¤§å¹¶å‘æ•°ï¼ˆæµè§ˆå™¨é™åˆ¶é€šå¸¸æ˜¯6ï¼‰</span>
      <span class="hljs-attr">retryCount</span>: <span class="hljs-number">2</span>, <span class="hljs-comment">// é‡è¯•æ¬¡æ•°</span>
      <span class="hljs-attr">retryDelay</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// é‡è¯•å»¶è¿Ÿ</span>
      <span class="hljs-attr">timeout</span>: <span class="hljs-number">30000</span>, <span class="hljs-comment">// è¶…æ—¶æ—¶é—´</span>
      <span class="hljs-attr">priority</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// æ˜¯å¦å¯ç”¨ä¼˜å…ˆçº§</span>
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">requestCount</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">success</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">failed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">retried</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">queued</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">active</span>: <span class="hljs-number">0</span>
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">paused</span> = <span class="hljs-literal">false</span>;
  }

  <span class="hljs-title function_">addRequest</span>(<span class="hljs-params">request, priority = <span class="hljs-number">0</span></span>) {
    <span class="hljs-keyword">const</span> requestId = <span class="hljs-string">`req_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${++<span class="hljs-variable language_">this</span>.requestCount}</span>`</span>;
    <span class="hljs-keyword">const</span> requestConfig = {
      <span class="hljs-attr">id</span>: requestId,
      request,
      priority,
      <span class="hljs-attr">retries</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">addedAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    };
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">priority</span>) {
      <span class="hljs-comment">// æŒ‰ä¼˜å…ˆçº§æ’å…¥é˜Ÿåˆ—</span>
      <span class="hljs-keyword">let</span> insertIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span>; i++) {
        <span class="hljs-keyword">if</span> (priority &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>[i].<span class="hljs-property">priority</span>) {
          insertIndex = i;
          <span class="hljs-keyword">break</span>;
        }
      }
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">splice</span>(insertIndex, <span class="hljs-number">0</span>, requestConfig);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">push</span>(requestConfig);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">queued</span>++;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">total</span>++;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
    <span class="hljs-keyword">return</span> requestId;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processQueue</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">paused</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-comment">// æ£€æŸ¥å¯ç”¨å¹¶å‘æ•°</span>
    <span class="hljs-keyword">const</span> availableSlots = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxConcurrent</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span>.<span class="hljs-property">size</span>;
    <span class="hljs-keyword">if</span> (availableSlots &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-comment">// è·å–è¦å¤„ç†çš„ä»»åŠ¡</span>
    <span class="hljs-keyword">const</span> tasksToProcess = <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, availableSlots);
    
    tasksToProcess.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">task</span> =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeRequest</span>(task);
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">executeRequest</span>(<span class="hljs-params">task</span>) {
    <span class="hljs-keyword">const</span> { id, request, priority, retries } = task;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span>.<span class="hljs-title function_">set</span>(id, task);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">queued</span>--;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">active</span>++;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>();
      <span class="hljs-keyword">const</span> timeoutId = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        controller.<span class="hljs-title function_">abort</span>();
      }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">timeout</span>);
      
      <span class="hljs-comment">// æ‰§è¡Œè¯·æ±‚</span>
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(controller.<span class="hljs-property">signal</span>);
      
      <span class="hljs-built_in">clearTimeout</span>(timeoutId);
      
      <span class="hljs-comment">// è¯·æ±‚æˆåŠŸ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span>.<span class="hljs-title function_">delete</span>(id);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">active</span>--;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">success</span>++;
      
      <span class="hljs-comment">// è§¦å‘æˆåŠŸäº‹ä»¶</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'success'</span>, { id, result, retries });
      
      <span class="hljs-comment">// ç»§ç»­å¤„ç†é˜Ÿåˆ—</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
      
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">clearTimeout</span>(timeoutId);
      
      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦éœ€è¦é‡è¯•</span>
      <span class="hljs-keyword">const</span> shouldRetry = retries &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">retryCount</span> &amp;&amp; 
                         !<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isAbortError</span>(error);
      
      <span class="hljs-keyword">if</span> (shouldRetry) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">retried</span>++;
        
        <span class="hljs-comment">// å»¶è¿Ÿåé‡è¯•</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          task.<span class="hljs-property">retries</span>++;
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">unshift</span>(task);
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">queued</span>++;
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
        }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">retryDelay</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æœ€ç»ˆå¤±è´¥</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span>.<span class="hljs-title function_">delete</span>(id);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">active</span>--;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">failed</span>++;
        
        <span class="hljs-comment">// è§¦å‘å¤±è´¥äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, { id, error, retries });
        
        <span class="hljs-comment">// ç»§ç»­å¤„ç†é˜Ÿåˆ—</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
      }
    }
  }

  <span class="hljs-title function_">isAbortError</span>(<span class="hljs-params">error</span>) {
    <span class="hljs-keyword">return</span> error.<span class="hljs-property">name</span> === <span class="hljs-string">'AbortError'</span> || error.<span class="hljs-property">message</span> === <span class="hljs-string">'The user aborted a request.'</span>;
  }

  <span class="hljs-comment">// äº‹ä»¶ç³»ç»Ÿ</span>
  eventHandlers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  
  <span class="hljs-title function_">on</span>(<span class="hljs-params">event, handler</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">has</span>(event)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">set</span>(event, []);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">get</span>(event).<span class="hljs-title function_">push</span>(handler);
  }
  
  <span class="hljs-title function_">off</span>(<span class="hljs-params">event, handler</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">has</span>(event)) {
      <span class="hljs-keyword">const</span> handlers = <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">get</span>(event);
      <span class="hljs-keyword">const</span> index = handlers.<span class="hljs-title function_">indexOf</span>(handler);
      <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
        handlers.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
      }
    }
  }
  
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">event, data</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">has</span>(event)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">get</span>(event).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">handler</span> =&gt;</span> {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-title function_">handler</span>(data);
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in event handler for <span class="hljs-subst">${event}</span>:`</span>, error);
        }
      });
    }
  }

  <span class="hljs-comment">// æ§åˆ¶æ–¹æ³•</span>
  <span class="hljs-title function_">pause</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">paused</span> = <span class="hljs-literal">true</span>;
  }

  <span class="hljs-title function_">resume</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">paused</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
  }

  <span class="hljs-title function_">cancelRequest</span>(<span class="hljs-params">requestId</span>) {
    <span class="hljs-comment">// ä»é˜Ÿåˆ—ä¸­ç§»é™¤</span>
    <span class="hljs-keyword">const</span> queueIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">req</span> =&gt;</span> req.<span class="hljs-property">id</span> === requestId);
    <span class="hljs-keyword">if</span> (queueIndex &gt; -<span class="hljs-number">1</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-title function_">splice</span>(queueIndex, <span class="hljs-number">1</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">queued</span>--;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-comment">// ä»æ´»åŠ¨è¯·æ±‚ä¸­ç§»é™¤ï¼ˆæ— æ³•çœŸæ­£å–æ¶ˆfetchï¼Œä½†å¯ä»¥æ ‡è®°ä¸ºå–æ¶ˆï¼‰</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span>.<span class="hljs-title function_">has</span>(requestId)) {
      <span class="hljs-comment">// åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œåº”è¯¥å–æ¶ˆfetchè¯·æ±‚</span>
      <span class="hljs-comment">// éœ€è¦ä¿å­˜AbortControllerå¹¶åœ¨å–æ¶ˆæ—¶è°ƒç”¨abort()</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span>.<span class="hljs-title function_">delete</span>(requestId);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">active</span>--;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-title function_">clearQueue</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">queued</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>,
      <span class="hljs-attr">queueLength</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">activeRequests</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span>.<span class="hljs-property">size</span>
    };
  }

  <span class="hljs-title function_">waitForAll</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> checkInterval = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">queue</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">activeRequests</span>.<span class="hljs-property">size</span> === <span class="hljs-number">0</span>) {
          <span class="hljs-built_in">clearInterval</span>(checkInterval);
          <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>);
        }
      }, <span class="hljs-number">100</span>);
    });
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> requestPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestPool</span>({
  <span class="hljs-attr">maxConcurrent</span>: <span class="hljs-number">4</span>,
  <span class="hljs-attr">retryCount</span>: <span class="hljs-number">2</span>,
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
  <span class="hljs-attr">priority</span>: <span class="hljs-literal">true</span>
});

<span class="hljs-comment">// æ·»åŠ è¯·æ±‚äº‹ä»¶ç›‘å¬</span>
requestPool.<span class="hljs-title function_">on</span>(<span class="hljs-string">'success'</span>, <span class="hljs-function">(<span class="hljs-params">{ id, result }</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Request <span class="hljs-subst">${id}</span> succeeded`</span>);
});

requestPool.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">{ id, error }</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Request <span class="hljs-subst">${id}</span> failed:`</span>, error);
});

<span class="hljs-comment">// åˆ›å»ºè¯·æ±‚å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createRequest</span>(<span class="hljs-params">url, data = <span class="hljs-literal">null</span></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> (signal) =&gt; {
    <span class="hljs-keyword">const</span> options = {
      <span class="hljs-attr">method</span>: data ? <span class="hljs-string">'POST'</span> : <span class="hljs-string">'GET'</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
      },
      signal
    };
    
    <span class="hljs-keyword">if</span> (data) {
      options.<span class="hljs-property">body</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);
    }
    
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(url, options);
    
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>`</span>);
    }
    
    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();
  };
}

<span class="hljs-comment">// æ·»åŠ å¤šä¸ªè¯·æ±‚</span>
<span class="hljs-keyword">const</span> urls = [
  <span class="hljs-string">'/api/users/1'</span>,
  <span class="hljs-string">'/api/users/2'</span>,
  <span class="hljs-string">'/api/users/3'</span>,
  <span class="hljs-string">'/api/products/1'</span>,
  <span class="hljs-string">'/api/products/2'</span>,
  <span class="hljs-string">'/api/orders/1'</span>
];

urls.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">url, index</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> priority = index &lt; <span class="hljs-number">3</span> ? <span class="hljs-number">10</span> : <span class="hljs-number">1</span>; <span class="hljs-comment">// å‰3ä¸ªè¯·æ±‚é«˜ä¼˜å…ˆçº§</span>
  requestPool.<span class="hljs-title function_">addRequest</span>(<span class="hljs-title function_">createRequest</span>(url), priority);
});

<span class="hljs-comment">// ç­‰å¾…æ‰€æœ‰è¯·æ±‚å®Œæˆ</span>
requestPool.<span class="hljs-title function_">waitForAll</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">stats</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'All requests completed:'</span>, stats);
});

<span class="hljs-comment">// åŠ¨æ€è°ƒæ•´å¹¶å‘æ•°</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  requestPool.<span class="hljs-property">options</span>.<span class="hljs-property">maxConcurrent</span> = <span class="hljs-number">2</span>;
}, <span class="hljs-number">5000</span>);
</code></pre>
<h5 data-id="heading-22">7.2 å¸¦ç¼“å­˜çš„è¯·æ±‚æ± </h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CachedRequestPool</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">RequestPool</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">super</span>(options);
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheOptions</span> = {
      <span class="hljs-attr">ttl</span>: options.<span class="hljs-property">cacheTtl</span> || <span class="hljs-number">300000</span>, <span class="hljs-comment">// 5åˆ†é’Ÿ</span>
      <span class="hljs-attr">maxSize</span>: options.<span class="hljs-property">cacheMaxSize</span> || <span class="hljs-number">100</span>,
      ...options.<span class="hljs-property">cacheOptions</span>
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheHits</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheMisses</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-title function_">addRequest</span>(<span class="hljs-params">request, priority = <span class="hljs-number">0</span>, cacheKey = <span class="hljs-literal">null</span></span>) {
    <span class="hljs-comment">// ç”Ÿæˆç¼“å­˜é”®</span>
    <span class="hljs-keyword">const</span> actualCacheKey = cacheKey || <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateCacheKey</span>(request);
    
    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">has</span>(actualCacheKey)) {
      <span class="hljs-keyword">const</span> cached = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">get</span>(actualCacheKey);
      
      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - cached.<span class="hljs-property">timestamp</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheOptions</span>.<span class="hljs-property">ttl</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheHits</span>++;
        
        <span class="hljs-comment">// ç«‹å³è¿”å›ç¼“å­˜ç»“æœ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(cached.<span class="hljs-property">data</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// ç¼“å­˜è¿‡æœŸ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(actualCacheKey);
      }
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheMisses</span>++;
    
    <span class="hljs-comment">// åˆ›å»ºåŒ…è£…çš„è¯·æ±‚å‡½æ•°</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">wrappedRequest</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">signal</span>) =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">request</span>(signal);
        
        <span class="hljs-comment">// ç¼“å­˜ç»“æœ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">set</span>(actualCacheKey, {
          <span class="hljs-attr">data</span>: result,
          <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
        });
        
        <span class="hljs-comment">// æ¸…ç†è¿‡æœŸç¼“å­˜</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupCache</span>();
        
        <span class="hljs-keyword">return</span> result;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">throw</span> error;
      }
    };
    
    <span class="hljs-comment">// æ·»åŠ åˆ°çˆ¶ç±»é˜Ÿåˆ—</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> requestId = <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">addRequest</span>(wrappedRequest, priority);
      
      <span class="hljs-comment">// ç›‘å¬å®Œæˆäº‹ä»¶</span>
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">successHandler</span> = (<span class="hljs-params">{ id, result }</span>) =&gt; {
        <span class="hljs-keyword">if</span> (id === requestId) {
          <span class="hljs-title function_">resolve</span>(result);
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'success'</span>, successHandler);
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, errorHandler);
        }
      };
      
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">errorHandler</span> = (<span class="hljs-params">{ id, error }</span>) =&gt; {
        <span class="hljs-keyword">if</span> (id === requestId) {
          <span class="hljs-title function_">reject</span>(error);
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'success'</span>, successHandler);
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, errorHandler);
        }
      };
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'success'</span>, successHandler);
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, errorHandler);
    });
  }

  <span class="hljs-title function_">generateCacheKey</span>(<span class="hljs-params">request</span>) {
    <span class="hljs-comment">// æ ¹æ®è¯·æ±‚å‡½æ•°ç”Ÿæˆç¼“å­˜é”®</span>
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªç®€å•å®ç°ï¼Œå®é™…åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é€»è¾‘</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">`cache_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>)}</span>`</span>;
  }

  <span class="hljs-title function_">cleanupCache</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> maxAge = <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheOptions</span>.<span class="hljs-property">ttl</span>;
    
    <span class="hljs-comment">// æ¸…ç†è¿‡æœŸç¼“å­˜</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">entries</span>()) {
      <span class="hljs-keyword">if</span> (now - value.<span class="hljs-property">timestamp</span> &gt; maxAge) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key);
      }
    }
    
    <span class="hljs-comment">// æ¸…ç†è¶…å‡ºå¤§å°çš„ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">size</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheOptions</span>.<span class="hljs-property">maxSize</span>) {
      <span class="hljs-keyword">const</span> entries = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">entries</span>());
      entries.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">[, a], [, b]</span>) =&gt;</span> a.<span class="hljs-property">timestamp</span> - b.<span class="hljs-property">timestamp</span>);
      
      <span class="hljs-keyword">const</span> toRemove = entries.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">size</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheOptions</span>.<span class="hljs-property">maxSize</span>);
      toRemove.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key]</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">delete</span>(key));
    }
  }

  <span class="hljs-title function_">clearCache</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-title function_">clear</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheHits</span> = <span class="hljs-number">0</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheMisses</span> = <span class="hljs-number">0</span>;
  }

  <span class="hljs-title function_">getCacheStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">hits</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheHits</span>,
      <span class="hljs-attr">misses</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheMisses</span>,
      <span class="hljs-attr">hitRate</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheHits</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheMisses</span> &gt; <span class="hljs-number">0</span> 
        ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheHits</span> / (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheHits</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">cacheMisses</span>)
        : <span class="hljs-number">0</span>,
      <span class="hljs-attr">size</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">cache</span>.<span class="hljs-property">size</span>
    };
  }
}
</code></pre>
<h4 data-id="heading-23">å…«ã€æ•°æ®åˆ†æ‰¹å¤„ç†ï¼ˆBatch Processingï¼‰</h4>
<h5 data-id="heading-24">8.1 æ™ºèƒ½æ•°æ®æ‰¹å¤„ç†å™¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BatchProcessor</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">batchSize</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">delay</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// å»¶è¿Ÿæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰</span>
      <span class="hljs-attr">maxBatches</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// æœ€å¤§æ‰¹æ¬¡æ•°</span>
      <span class="hljs-attr">autoProcess</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦è‡ªåŠ¨å¤„ç†</span>
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">totalItems</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">processedItems</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">batchesProcessed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">processingTime</span>: <span class="hljs-number">0</span>
    };
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">autoProcess</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startAutoProcess</span>();
    }
  }

  <span class="hljs-title function_">add</span>(<span class="hljs-params">item</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span>.<span class="hljs-title function_">push</span>(item);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">totalItems</span>++;
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">batchSize</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">enqueueBatch</span>();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">autoProcess</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startTimer</span>();
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">addMany</span>(<span class="hljs-params">items</span>) {
    items.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">add</span>(item));
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">enqueueBatch</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> batchToEnqueue = [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span>];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span> = [];
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span>.<span class="hljs-title function_">push</span>(batchToEnqueue);
    
    <span class="hljs-comment">// æ£€æŸ¥é˜Ÿåˆ—é•¿åº¦</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxBatches</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Batch queue is full, consider increasing maxBatches or batchSize'</span>);
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">autoProcess</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
    }
  }

  <span class="hljs-title function_">startTimer</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">enqueueBatch</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span> = <span class="hljs-literal">null</span>;
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">delay</span>);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processQueue</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">true</span>;
    
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> batch = <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span>.<span class="hljs-title function_">shift</span>();
      
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processBatch</span>(batch);
        <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">processedItems</span> += batch.<span class="hljs-property">length</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">batchesProcessed</span>++;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">processingTime</span> += endTime - startTime;
        
        <span class="hljs-comment">// è§¦å‘æ‰¹æ¬¡å®Œæˆäº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'batchComplete'</span>, {
          batch,
          <span class="hljs-attr">size</span>: batch.<span class="hljs-property">length</span>,
          <span class="hljs-attr">processingTime</span>: endTime - startTime
        });
        
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Batch processing error:'</span>, error);
        
        <span class="hljs-comment">// è§¦å‘é”™è¯¯äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'error'</span>, {
          error,
          batch,
          <span class="hljs-attr">size</span>: batch.<span class="hljs-property">length</span>
        });
      }
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
    
    <span class="hljs-comment">// è§¦å‘é˜Ÿåˆ—å®Œæˆäº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'queueEmpty'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>);
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processBatch</span>(<span class="hljs-params">batch</span>) {
    <span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œéœ€è¦åœ¨å­ç±»ä¸­å®ç°</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'processBatch method must be implemented'</span>);
  }

  <span class="hljs-title function_">flush</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å¼ºåˆ¶å¤„ç†å½“å‰æ‰¹æ¬¡</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">enqueueBatch</span>();
    }
    
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
  }

  <span class="hljs-title function_">waitForCompletion</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">checkComplete</span> = (<span class="hljs-params"/>) =&gt; {
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span> &amp;&amp; 
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span> &amp;&amp; 
            !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>) {
          <span class="hljs-title function_">resolve</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-built_in">setTimeout</span>(checkComplete, <span class="hljs-number">50</span>);
        }
      };
      
      <span class="hljs-title function_">checkComplete</span>();
    });
  }

  <span class="hljs-comment">// äº‹ä»¶ç³»ç»Ÿ</span>
  eventHandlers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
  
  <span class="hljs-title function_">on</span>(<span class="hljs-params">event, handler</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">has</span>(event)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">set</span>(event, []);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">get</span>(event).<span class="hljs-title function_">push</span>(handler);
  }
  
  <span class="hljs-title function_">off</span>(<span class="hljs-params">event, handler</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">has</span>(event)) {
      <span class="hljs-keyword">const</span> handlers = <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">get</span>(event);
      <span class="hljs-keyword">const</span> index = handlers.<span class="hljs-title function_">indexOf</span>(handler);
      <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
        handlers.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
      }
    }
  }
  
  <span class="hljs-title function_">emit</span>(<span class="hljs-params">event, data</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">has</span>(event)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventHandlers</span>.<span class="hljs-title function_">get</span>(event).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">handler</span> =&gt;</span> {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-title function_">handler</span>(data);
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Error in event handler for <span class="hljs-subst">${event}</span>:`</span>, error);
        }
      });
    }
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>,
      <span class="hljs-attr">itemsInBatch</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">batchesInQueue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">isProcessing</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span>
    };
  }

  <span class="hljs-title function_">reset</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">batch</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchQueue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isProcessing</span> = <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span>);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">timer</span> = <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">totalItems</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">processedItems</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">batchesProcessed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">processingTime</span>: <span class="hljs-number">0</span>
    };
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ï¼šAPIæ‰¹é‡è¯·æ±‚å¤„ç†å™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ApiBatchProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">BatchProcessor</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">apiEndpoint, options = {}</span>) {
    <span class="hljs-variable language_">super</span>({
      <span class="hljs-attr">batchSize</span>: <span class="hljs-number">50</span>,
      <span class="hljs-attr">delay</span>: <span class="hljs-number">500</span>,
      ...options
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">apiEndpoint</span> = apiEndpoint;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processBatch</span>(<span class="hljs-params">batch</span>) {
    <span class="hljs-comment">// æ‰¹é‡å‘é€è¯·æ±‚</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">apiEndpoint</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
      },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">items</span>: batch })
    });
    
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`API request failed: <span class="hljs-subst">${response.status}</span>`</span>);
    }
    
    <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">json</span>();
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> processor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiBatchProcessor</span>(<span class="hljs-string">'/api/batch-save'</span>, {
  <span class="hljs-attr">batchSize</span>: <span class="hljs-number">100</span>,
  <span class="hljs-attr">delay</span>: <span class="hljs-number">1000</span>
});

<span class="hljs-comment">// ç›‘å¬äº‹ä»¶</span>
processor.<span class="hljs-title function_">on</span>(<span class="hljs-string">'batchComplete'</span>, <span class="hljs-function">(<span class="hljs-params">{ batch, size, processingTime }</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Processed batch of <span class="hljs-subst">${size}</span> items in <span class="hljs-subst">${processingTime}</span>ms`</span>);
});

processor.<span class="hljs-title function_">on</span>(<span class="hljs-string">'queueEmpty'</span>, <span class="hljs-function">(<span class="hljs-params">stats</span>) =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'All batches processed:'</span>, stats);
});

<span class="hljs-comment">// æ·»åŠ å¤§é‡æ•°æ®</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
  processor.<span class="hljs-title function_">add</span>({ <span class="hljs-attr">id</span>: i, <span class="hljs-attr">data</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span> });
}

<span class="hljs-comment">// ç­‰å¾…å¤„ç†å®Œæˆ</span>
processor.<span class="hljs-title function_">waitForCompletion</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">stats</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Processing completed:'</span>, stats);
});
</code></pre>
<h5 data-id="heading-25">8.2 æ•°æ®åº“æ‰¹é‡æ“ä½œ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DatabaseBatchProcessor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">BatchProcessor</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">dbName, storeName, options = {}</span>) {
    <span class="hljs-variable language_">super</span>({
      <span class="hljs-attr">batchSize</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">delay</span>: <span class="hljs-number">100</span>,
      ...options
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span> = dbName;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span> = storeName;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span> = <span class="hljs-literal">null</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initDatabase</span>();
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initDatabase</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> request = indexedDB.<span class="hljs-title function_">open</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dbName</span>, <span class="hljs-number">1</span>);
      
      request.<span class="hljs-property">onupgradeneeded</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> db = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
        <span class="hljs-keyword">if</span> (!db.<span class="hljs-property">objectStoreNames</span>.<span class="hljs-title function_">contains</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>)) {
          db.<span class="hljs-title function_">createObjectStore</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>, { <span class="hljs-attr">keyPath</span>: <span class="hljs-string">'id'</span> });
        }
      };
      
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span> = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
        <span class="hljs-title function_">resolve</span>();
      };
      
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-title function_">reject</span>(event.<span class="hljs-property">target</span>.<span class="hljs-property">error</span>);
      };
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">processBatch</span>(<span class="hljs-params">batch</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initDatabase</span>();
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> transaction = <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>], <span class="hljs-string">'readwrite'</span>);
      <span class="hljs-keyword">const</span> store = transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>);
      
      <span class="hljs-keyword">let</span> completed = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">let</span> errors = [];
      
      batch.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> request = store.<span class="hljs-title function_">put</span>(item);
        
        request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">() =&gt;</span> {
          completed++;
          <span class="hljs-keyword">if</span> (completed === batch.<span class="hljs-property">length</span>) {
            <span class="hljs-keyword">if</span> (errors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
              <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Failed to save <span class="hljs-subst">${errors.length}</span> items`</span>));
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-title function_">resolve</span>({ <span class="hljs-attr">saved</span>: batch.<span class="hljs-property">length</span> });
            }
          }
        };
        
        request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          errors.<span class="hljs-title function_">push</span>({ item, <span class="hljs-attr">error</span>: event.<span class="hljs-property">target</span>.<span class="hljs-property">error</span> });
          completed++;
          
          <span class="hljs-keyword">if</span> (completed === batch.<span class="hljs-property">length</span>) {
            <span class="hljs-keyword">if</span> (errors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
              <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Failed to save <span class="hljs-subst">${errors.length}</span> items`</span>));
            } <span class="hljs-keyword">else</span> {
              <span class="hljs-title function_">resolve</span>({ <span class="hljs-attr">saved</span>: batch.<span class="hljs-property">length</span> - errors.<span class="hljs-property">length</span> });
            }
          }
        };
      });
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">queryBatch</span>(<span class="hljs-params">queryFn, batchSize = <span class="hljs-number">100</span></span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>) <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initDatabase</span>();
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> transaction = <span class="hljs-variable language_">this</span>.<span class="hljs-property">db</span>.<span class="hljs-title function_">transaction</span>([<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>], <span class="hljs-string">'readonly'</span>);
      <span class="hljs-keyword">const</span> store = transaction.<span class="hljs-title function_">objectStore</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">storeName</span>);
      <span class="hljs-keyword">const</span> request = store.<span class="hljs-title function_">openCursor</span>();
      
      <span class="hljs-keyword">const</span> results = [];
      <span class="hljs-keyword">let</span> processed = <span class="hljs-number">0</span>;
      
      request.<span class="hljs-property">onsuccess</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> cursor = event.<span class="hljs-property">target</span>.<span class="hljs-property">result</span>;
        
        <span class="hljs-keyword">if</span> (cursor) {
          <span class="hljs-comment">// åº”ç”¨æŸ¥è¯¢å‡½æ•°</span>
          <span class="hljs-keyword">if</span> (<span class="hljs-title function_">queryFn</span>(cursor.<span class="hljs-property">value</span>)) {
            results.<span class="hljs-title function_">push</span>(cursor.<span class="hljs-property">value</span>);
          }
          
          processed++;
          cursor.<span class="hljs-title function_">continue</span>();
          
          <span class="hljs-comment">// æ‰¹é‡å¤„ç†</span>
          <span class="hljs-keyword">if</span> (processed % batchSize === <span class="hljs-number">0</span>) {
            <span class="hljs-comment">// çŸ­æš‚æš‚åœä»¥é¿å…é˜»å¡ä¸»çº¿ç¨‹</span>
            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {}, <span class="hljs-number">0</span>);
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-title function_">resolve</span>(results);
        }
      };
      
      request.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-title function_">reject</span>(event.<span class="hljs-property">target</span>.<span class="hljs-property">error</span>);
      };
    });
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> dbProcessor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DatabaseBatchProcessor</span>(<span class="hljs-string">'myDatabase'</span>, <span class="hljs-string">'items'</span>);

<span class="hljs-comment">// æ‰¹é‡æ·»åŠ æ•°æ®</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
  dbProcessor.<span class="hljs-title function_">add</span>({
    <span class="hljs-attr">id</span>: i,
    <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>(),
    <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
  });
}

<span class="hljs-comment">// æ‰¹é‡æŸ¥è¯¢</span>
dbProcessor.<span class="hljs-title function_">queryBatch</span>(
  <span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">value</span> &gt; <span class="hljs-number">0.5</span>,
  <span class="hljs-number">500</span>
).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">results</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Found <span class="hljs-subst">${results.length}</span> items with value &gt; 0.5`</span>);
});
</code></pre>
<h4 data-id="heading-26">ä¹ã€å¯¹è±¡æ± æ¨¡å¼ï¼ˆObject Pool Patternï¼‰</h4>
<h5 data-id="heading-27">9.1 é€šç”¨å¯¹è±¡æ± å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObjectPool</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">createFn, options = {}</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> createFn !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'createFn must be a function'</span>);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">createFn</span> = createFn;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">maxSize</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">minSize</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">validate</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// éªŒè¯å‡½æ•°</span>
      <span class="hljs-attr">reset</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// é‡ç½®å‡½æ•°</span>
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">created</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">reused</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">destroyed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">peakSize</span>: <span class="hljs-number">0</span>
    };
    
    <span class="hljs-comment">// é¢„åˆ›å»ºå¯¹è±¡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">prepopulate</span>();
  }

  <span class="hljs-title function_">prepopulate</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> count = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">minSize</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxSize</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
      <span class="hljs-keyword">const</span> obj = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createNew</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-title function_">push</span>(obj);
    }
  }

  <span class="hljs-title function_">createNew</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> obj = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createFn</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">created</span>++;
    <span class="hljs-keyword">return</span> obj;
  }

  <span class="hljs-title function_">acquire</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">let</span> obj;
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-comment">// ä»æ± ä¸­è·å–</span>
      obj = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-title function_">pop</span>();
      
      <span class="hljs-comment">// éªŒè¯å¯¹è±¡</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">validate</span> &amp;&amp; !<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-title function_">validate</span>(obj)) {
        <span class="hljs-comment">// å¯¹è±¡æ— æ•ˆï¼Œé”€æ¯å¹¶åˆ›å»ºæ–°çš„</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroyObject</span>(obj);
        obj = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createNew</span>();
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">reused</span>++;
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æ± ä¸ºç©ºï¼Œåˆ›å»ºæ–°å¯¹è±¡</span>
      obj = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createNew</span>();
    }
    
    <span class="hljs-comment">// é‡ç½®å¯¹è±¡çŠ¶æ€</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">reset</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-title function_">reset</span>(obj);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">add</span>(obj);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updatePeakSize</span>();
    
    <span class="hljs-keyword">return</span> obj;
  }

  <span class="hljs-title function_">release</span>(<span class="hljs-params">obj</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">has</span>(obj)) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Object not active in pool'</span>);
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">delete</span>(obj);
    
    <span class="hljs-comment">// æ£€æŸ¥æ± æ˜¯å¦å·²æ»¡</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxSize</span>) {
      <span class="hljs-comment">// é‡ç½®å¯¹è±¡</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">reset</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-title function_">reset</span>(obj);
      }
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-title function_">push</span>(obj);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æ± å·²æ»¡ï¼Œé”€æ¯å¯¹è±¡</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroyObject</span>(obj);
    }
  }

  <span class="hljs-title function_">destroyObject</span>(<span class="hljs-params">obj</span>) {
    <span class="hljs-comment">// è°ƒç”¨æ¸…ç†å‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰</span>
    <span class="hljs-keyword">if</span> (obj.<span class="hljs-property">destroy</span> &amp;&amp; <span class="hljs-keyword">typeof</span> obj.<span class="hljs-property">destroy</span> === <span class="hljs-string">'function'</span>) {
      obj.<span class="hljs-title function_">destroy</span>();
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">destroyed</span>++;
  }

  <span class="hljs-title function_">updatePeakSize</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> totalSize = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-property">size</span>;
    <span class="hljs-keyword">if</span> (totalSize &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">peakSize</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">peakSize</span> = totalSize;
    }
  }

  <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// é”€æ¯æ‰€æœ‰å¯¹è±¡</span>
    [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>, ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">obj</span> =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroyObject</span>(obj);
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">clear</span>();
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>,
      <span class="hljs-attr">poolSize</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">activeSize</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-property">size</span>,
      <span class="hljs-attr">totalSize</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-property">size</span>
    };
  }

  <span class="hljs-comment">// æ‰§è¡Œå‡½æ•°å¹¶è‡ªåŠ¨ç®¡ç†å¯¹è±¡</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">callback</span>) {
    <span class="hljs-keyword">const</span> obj = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">acquire</span>();
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">callback</span>(obj);
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">release</span>(obj);
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ï¼šDOMå…ƒç´ æ± </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">DOMElementPool</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ObjectPool</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">elementType, options = {}</span>) {
    <span class="hljs-variable language_">super</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">const</span> element = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(elementType);
      element.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>; <span class="hljs-comment">// åˆå§‹éšè—</span>
      <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(element);
      <span class="hljs-keyword">return</span> element;
    }, options);
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elementType</span> = elementType;
  }

  <span class="hljs-title function_">acquire</span>(<span class="hljs-params">styles = {}</span>) {
    <span class="hljs-keyword">const</span> element = <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">acquire</span>();
    
    <span class="hljs-comment">// åº”ç”¨æ ·å¼</span>
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(element.<span class="hljs-property">style</span>, {
      <span class="hljs-attr">display</span>: <span class="hljs-string">''</span>,
      ...styles
    });
    
    <span class="hljs-keyword">return</span> element;
  }

  <span class="hljs-title function_">release</span>(<span class="hljs-params">element</span>) {
    <span class="hljs-comment">// éšè—å…ƒç´ </span>
    element.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">'none'</span>;
    
    <span class="hljs-comment">// æ¸…é™¤å†…å®¹</span>
    element.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;
    
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">release</span>(element);
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> divPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMElementPool</span>(<span class="hljs-string">'div'</span>, {
  <span class="hljs-attr">maxSize</span>: <span class="hljs-number">50</span>,
  <span class="hljs-attr">minSize</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">reset</span>: <span class="hljs-function">(<span class="hljs-params">div</span>) =&gt;</span> {
    div.<span class="hljs-property">className</span> = <span class="hljs-string">''</span>;
    div.<span class="hljs-property">style</span>.<span class="hljs-property">cssText</span> = <span class="hljs-string">''</span>;
    div.<span class="hljs-property">textContent</span> = <span class="hljs-string">''</span>;
  }
});

<span class="hljs-comment">// ä½¿ç”¨å¯¹è±¡æ± åˆ›å»ºä¸´æ—¶å…ƒç´ </span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
  <span class="hljs-keyword">const</span> div = divPool.<span class="hljs-title function_">acquire</span>({
    <span class="hljs-attr">position</span>: <span class="hljs-string">'absolute'</span>,
    <span class="hljs-attr">left</span>: <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>}</span>%`</span>,
    <span class="hljs-attr">top</span>: <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>}</span>%`</span>,
    <span class="hljs-attr">width</span>: <span class="hljs-string">'50px'</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-string">'50px'</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">`hsl(<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">360</span>}</span>, 100%, 50%)`</span>
  });
  
  div.<span class="hljs-property">textContent</span> = i;
  
  <span class="hljs-comment">// æ¨¡æ‹Ÿä½¿ç”¨</span>
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
    divPool.<span class="hljs-title function_">release</span>(div);
  }, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">3000</span>);
}

<span class="hljs-comment">// æŸ¥çœ‹ç»Ÿè®¡</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Pool stats:'</span>, divPool.<span class="hljs-title function_">getStats</span>());
}, <span class="hljs-number">5000</span>);
</code></pre>
<h5 data-id="heading-28">9.2 è¿æ¥æ± å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConnectionPool</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">createConnection, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">createConnection</span> = createConnection;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">maxConnections</span>: <span class="hljs-number">10</span>,
      <span class="hljs-attr">minConnections</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">idleTimeout</span>: <span class="hljs-number">30000</span>, <span class="hljs-comment">// ç©ºé—²è¶…æ—¶æ—¶é—´</span>
      <span class="hljs-attr">acquireTimeout</span>: <span class="hljs-number">5000</span>, <span class="hljs-comment">// è·å–è¿æ¥è¶…æ—¶æ—¶é—´</span>
      <span class="hljs-attr">testOnBorrow</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// è·å–æ—¶æµ‹è¯•è¿æ¥</span>
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timers</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">created</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">destroyed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">acquired</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">released</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">timeoutErrors</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">connectionErrors</span>: <span class="hljs-number">0</span>
    };
    
    <span class="hljs-comment">// åˆå§‹åŒ–è¿æ¥æ± </span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">minConnections</span>; i++) {
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createAndAddConnection</span>();
    }
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">createAndAddConnection</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> connection = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createConnection</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-title function_">push</span>({
        connection,
        <span class="hljs-attr">lastUsed</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
        <span class="hljs-attr">valid</span>: <span class="hljs-literal">true</span>
      });
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">created</span>++;
      <span class="hljs-keyword">return</span> connection;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">connectionErrors</span>++;
      <span class="hljs-keyword">throw</span> error;
    }
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">acquire</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">acquired</span>++;
    
    <span class="hljs-comment">// 1. æ£€æŸ¥ç©ºé—²è¿æ¥</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>[i];
      
      <span class="hljs-keyword">if</span> (item.<span class="hljs-property">valid</span>) {
        <span class="hljs-comment">// æ£€æŸ¥è¿æ¥æ˜¯å¦æœ‰æ•ˆ</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">testOnBorrow</span>) {
          <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testConnection</span>(item.<span class="hljs-property">connection</span>);
          } <span class="hljs-keyword">catch</span> (error) {
            item.<span class="hljs-property">valid</span> = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">continue</span>;
          }
        }
        
        <span class="hljs-comment">// ä»æ± ä¸­ç§»é™¤</span>
        <span class="hljs-keyword">const</span> [acquiredItem] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">add</span>(acquiredItem.<span class="hljs-property">connection</span>);
        
        <span class="hljs-comment">// è®¾ç½®æœ€åä½¿ç”¨æ—¶é—´</span>
        acquiredItem.<span class="hljs-property">lastUsed</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
        
        <span class="hljs-keyword">return</span> acquiredItem.<span class="hljs-property">connection</span>;
      }
    }
    
    <span class="hljs-comment">// 2. æ£€æŸ¥æ˜¯å¦å¯ä»¥åˆ›å»ºæ–°è¿æ¥</span>
    <span class="hljs-keyword">const</span> totalConnections = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-property">size</span>;
    <span class="hljs-keyword">if</span> (totalConnections &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxConnections</span>) {
      <span class="hljs-keyword">const</span> connection = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createAndAddConnection</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">add</span>(connection);
      <span class="hljs-keyword">return</span> connection;
    }
    
    <span class="hljs-comment">// 3. ç­‰å¾…å¯ç”¨è¿æ¥</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> waitStart = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      
      <span class="hljs-keyword">const</span> waitingRequest = {
        resolve,
        reject,
        <span class="hljs-attr">timer</span>: <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          <span class="hljs-comment">// è¶…æ—¶å¤„ç†</span>
          <span class="hljs-keyword">const</span> index = <span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span>.<span class="hljs-title function_">indexOf</span>(waitingRequest);
          <span class="hljs-keyword">if</span> (index &gt; -<span class="hljs-number">1</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);
          }
          
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">timeoutErrors</span>++;
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Connection acquisition timeout'</span>));
        }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">acquireTimeout</span>)
      };
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span>.<span class="hljs-title function_">push</span>(waitingRequest);
      
      <span class="hljs-comment">// ç«‹å³å°è¯•å¤„ç†ç­‰å¾…é˜Ÿåˆ—</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processWaitingQueue</span>();
    });
  }

  <span class="hljs-title function_">release</span>(<span class="hljs-params">connection</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">has</span>(connection)) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'Connection not active in pool'</span>);
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">delete</span>(connection);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">released</span>++;
    
    <span class="hljs-comment">// æ£€æŸ¥è¿æ¥æ˜¯å¦ä»ç„¶æœ‰æ•ˆ</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isConnectionValid</span>(connection)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-title function_">push</span>({
        connection,
        <span class="hljs-attr">lastUsed</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
        <span class="hljs-attr">valid</span>: <span class="hljs-literal">true</span>
      });
      
      <span class="hljs-comment">// æ¸…ç†ç©ºé—²è¶…æ—¶çš„è¿æ¥</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupIdleConnections</span>();
      
      <span class="hljs-comment">// å¤„ç†ç­‰å¾…é˜Ÿåˆ—</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processWaitingQueue</span>();
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// è¿æ¥æ— æ•ˆï¼Œé”€æ¯</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroyConnection</span>(connection);
    }
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testConnection</span>(<span class="hljs-params">connection</span>) {
    <span class="hljs-comment">// é»˜è®¤å®ç°ï¼Œå­ç±»åº”è¯¥è¦†ç›–è¿™ä¸ªæ–¹æ³•</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();
  }

  <span class="hljs-title function_">isConnectionValid</span>(<span class="hljs-params">connection</span>) {
    <span class="hljs-comment">// é»˜è®¤å®ç°ï¼Œå­ç±»åº”è¯¥è¦†ç›–è¿™ä¸ªæ–¹æ³•</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-title function_">destroyConnection</span>(<span class="hljs-params">connection</span>) {
    <span class="hljs-comment">// æ¸…ç†è¿æ¥èµ„æº</span>
    <span class="hljs-keyword">if</span> (connection.<span class="hljs-property">destroy</span> &amp;&amp; <span class="hljs-keyword">typeof</span> connection.<span class="hljs-property">destroy</span> === <span class="hljs-string">'function'</span>) {
      connection.<span class="hljs-title function_">destroy</span>();
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (connection.<span class="hljs-property">close</span> &amp;&amp; <span class="hljs-keyword">typeof</span> connection.<span class="hljs-property">close</span> === <span class="hljs-string">'function'</span>) {
      connection.<span class="hljs-title function_">close</span>();
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">destroyed</span>++;
  }

  <span class="hljs-title function_">cleanupIdleConnections</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> idleTimeout = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">idleTimeout</span>;
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
      <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>[i];
      
      <span class="hljs-comment">// æ£€æŸ¥ç©ºé—²æ—¶é—´</span>
      <span class="hljs-keyword">if</span> (now - item.<span class="hljs-property">lastUsed</span> &gt; idleTimeout) {
        <span class="hljs-comment">// ä¿ç•™æœ€å°è¿æ¥æ•°</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">minConnections</span>) {
          <span class="hljs-keyword">const</span> [idleItem] = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-title function_">splice</span>(i, <span class="hljs-number">1</span>);
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroyConnection</span>(idleItem.<span class="hljs-property">connection</span>);
        }
      }
    }
  }

  <span class="hljs-title function_">processWaitingQueue</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> waitingRequest = <span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span>.<span class="hljs-title function_">shift</span>();
      <span class="hljs-built_in">clearTimeout</span>(waitingRequest.<span class="hljs-property">timer</span>);
      
      <span class="hljs-comment">// è·å–è¿æ¥</span>
      <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-title function_">pop</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">add</span>(item.<span class="hljs-property">connection</span>);
      item.<span class="hljs-property">lastUsed</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      
      waitingRequest.<span class="hljs-title function_">resolve</span>(item.<span class="hljs-property">connection</span>);
    }
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">callback</span>) {
    <span class="hljs-keyword">const</span> connection = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">acquire</span>();
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">callback</span>(connection);
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">release</span>(connection);
    }
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>,
      <span class="hljs-attr">poolSize</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">activeSize</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-property">size</span>,
      <span class="hljs-attr">waitingSize</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">totalSize</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>.<span class="hljs-property">length</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-property">size</span>
    };
  }

  <span class="hljs-title function_">clear</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰è¿æ¥</span>
    [...<span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span>, ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroyConnection</span>(item.<span class="hljs-property">connection</span> || item);
    });
    
    <span class="hljs-comment">// æ¸…ç†ç­‰å¾…é˜Ÿåˆ—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">request</span> =&gt;</span> {
      <span class="hljs-built_in">clearTimeout</span>(request.<span class="hljs-property">timer</span>);
      request.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Pool cleared'</span>));
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pool</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">active</span>.<span class="hljs-title function_">clear</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">waiting</span> = [];
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹ï¼šWebSocketè¿æ¥æ± </span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">WebSocketPool</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ConnectionPool</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">url, options = {}</span>) {
    <span class="hljs-variable language_">super</span>(<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(url);
        
        ws.<span class="hljs-property">onopen</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(ws);
        ws.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-title function_">reject</span>(error);
      });
    }, options);
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">url</span> = url;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">testConnection</span>(<span class="hljs-params">ws</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>) {
        <span class="hljs-title function_">resolve</span>();
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">CONNECTING</span>) {
        <span class="hljs-comment">// ç­‰å¾…è¿æ¥</span>
        <span class="hljs-keyword">const</span> <span class="hljs-title function_">onOpen</span> = (<span class="hljs-params"/>) =&gt; {
          ws.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'open'</span>, onOpen);
          <span class="hljs-title function_">resolve</span>();
        };
        
        <span class="hljs-keyword">const</span> <span class="hljs-title function_">onError</span> = (<span class="hljs-params"/>) =&gt; {
          ws.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'error'</span>, onError);
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'WebSocket connection failed'</span>));
        };
        
        ws.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'open'</span>, onOpen);
        ws.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'error'</span>, onError);
        
        <span class="hljs-comment">// è¶…æ—¶</span>
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
          ws.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'open'</span>, onOpen);
          ws.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'error'</span>, onError);
          <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'WebSocket connection timeout'</span>));
        }, <span class="hljs-number">5000</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'WebSocket is not open'</span>));
      }
    });
  }

  <span class="hljs-title function_">isConnectionValid</span>(<span class="hljs-params">ws</span>) {
    <span class="hljs-keyword">return</span> ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span>;
  }

  <span class="hljs-title function_">destroyConnection</span>(<span class="hljs-params">ws</span>) {
    <span class="hljs-keyword">if</span> (ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">OPEN</span> || ws.<span class="hljs-property">readyState</span> === <span class="hljs-title class_">WebSocket</span>.<span class="hljs-property">CONNECTING</span>) {
      ws.<span class="hljs-title function_">close</span>();
    }
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">destroyConnection</span>(ws);
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> wsPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketPool</span>(<span class="hljs-string">'wss://echo.websocket.org'</span>, {
  <span class="hljs-attr">maxConnections</span>: <span class="hljs-number">5</span>,
  <span class="hljs-attr">minConnections</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">idleTimeout</span>: <span class="hljs-number">60000</span>
});

<span class="hljs-comment">// ä½¿ç”¨è¿æ¥æ± å‘é€æ¶ˆæ¯</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendMessage</span>(<span class="hljs-params">message</span>) {
  <span class="hljs-keyword">return</span> wsPool.<span class="hljs-title function_">execute</span>(<span class="hljs-keyword">async</span> (ws) =&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> messageId = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
      
      <span class="hljs-keyword">const</span> <span class="hljs-title function_">handler</span> = (<span class="hljs-params">event</span>) =&gt; {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(event.<span class="hljs-property">data</span>);
          <span class="hljs-keyword">if</span> (data.<span class="hljs-property">id</span> === messageId) {
            ws.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'message'</span>, handler);
            <span class="hljs-title function_">resolve</span>(data);
          }
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-comment">// å¿½ç•¥è§£æé”™è¯¯</span>
        }
      };
      
      ws.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'message'</span>, handler);
      
      <span class="hljs-comment">// è®¾ç½®è¶…æ—¶</span>
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        ws.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'message'</span>, handler);
        <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Message timeout'</span>));
      }, <span class="hljs-number">5000</span>);
      
      <span class="hljs-comment">// å‘é€æ¶ˆæ¯</span>
      ws.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({
        <span class="hljs-attr">id</span>: messageId,
        message
      }));
    });
  });
}

<span class="hljs-comment">// å¹¶å‘å‘é€æ¶ˆæ¯</span>
<span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
  <span class="hljs-title function_">sendMessage</span>(<span class="hljs-string">'Hello 1'</span>),
  <span class="hljs-title function_">sendMessage</span>(<span class="hljs-string">'Hello 2'</span>),
  <span class="hljs-title function_">sendMessage</span>(<span class="hljs-string">'Hello 3'</span>),
  <span class="hljs-title function_">sendMessage</span>(<span class="hljs-string">'Hello 4'</span>),
  <span class="hljs-title function_">sendMessage</span>(<span class="hljs-string">'Hello 5'</span>)
]).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">responses</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'All messages sent:'</span>, responses);
});
</code></pre>
<h4 data-id="heading-29">åã€Web Workerä¼˜åŒ–è®¡ç®—å¯†é›†å‹ä»»åŠ¡</h4>
<h5 data-id="heading-30">10.1 æ™ºèƒ½Workeræ± </h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WorkerPool</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">workerScript, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerScript</span> = workerScript;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">maxWorkers</span>: navigator.<span class="hljs-property">hardwareConcurrency</span> || <span class="hljs-number">4</span>,
      <span class="hljs-attr">idleTimeout</span>: <span class="hljs-number">30000</span>, <span class="hljs-comment">// ç©ºé—²è¶…æ—¶æ—¶é—´</span>
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerStates</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span> = {
      <span class="hljs-attr">tasksCompleted</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">tasksFailed</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">workersCreated</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">workersDestroyed</span>: <span class="hljs-number">0</span>
    };
    
    <span class="hljs-comment">// åˆå§‹åŒ–Worker</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initWorkers</span>();
  }

  <span class="hljs-title function_">initWorkers</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> initialCount = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">2</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxWorkers</span>);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; initialCount; i++) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createWorker</span>();
    }
  }

  <span class="hljs-title function_">createWorker</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxWorkers</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    
    <span class="hljs-keyword">let</span> worker;
    
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerScript</span> === <span class="hljs-string">'string'</span>) {
      worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">workerScript</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerScript</span> === <span class="hljs-string">'function'</span>) {
      <span class="hljs-comment">// ä»å‡½æ•°åˆ›å»ºWorker</span>
      <span class="hljs-keyword">const</span> workerBlob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([
        <span class="hljs-string">`(<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.workerScript.toString()}</span>)()`</span>
      ], { <span class="hljs-attr">type</span>: <span class="hljs-string">'application/javascript'</span> });
      
      worker = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(workerBlob));
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'workerScript must be a URL string or a function'</span>);
    }
    
    <span class="hljs-keyword">const</span> workerId = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-property">length</span>;
    worker.<span class="hljs-property">id</span> = workerId;
    
    <span class="hljs-comment">// è®¾ç½®æ¶ˆæ¯å¤„ç†</span>
    worker.<span class="hljs-property">onmessage</span> = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleWorkerMessage</span>(workerId, event);
    };
    
    worker.<span class="hljs-property">onerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleWorkerError</span>(workerId, error);
    };
    
    worker.<span class="hljs-property">onmessageerror</span> = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleWorkerError</span>(workerId, error);
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">push</span>(worker);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-title function_">push</span>(workerId);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerStates</span>.<span class="hljs-title function_">set</span>(workerId, {
      <span class="hljs-attr">idle</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">currentTask</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">lastUsed</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">workersCreated</span>++;
    
    <span class="hljs-keyword">return</span> workerId;
  }

  <span class="hljs-title function_">handleWorkerMessage</span>(<span class="hljs-params">workerId, event</span>) {
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerStates</span>.<span class="hljs-title function_">get</span>(workerId);
    <span class="hljs-keyword">if</span> (!state || !state.<span class="hljs-property">currentTask</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> taskId = state.<span class="hljs-property">currentTask</span>;
    <span class="hljs-keyword">const</span> callback = <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span>.<span class="hljs-title function_">get</span>(taskId);
    
    <span class="hljs-keyword">if</span> (callback) {
      <span class="hljs-keyword">if</span> (event.<span class="hljs-property">data</span>.<span class="hljs-property">error</span>) {
        callback.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(event.<span class="hljs-property">data</span>.<span class="hljs-property">error</span>));
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">tasksFailed</span>++;
      } <span class="hljs-keyword">else</span> {
        callback.<span class="hljs-title function_">resolve</span>(event.<span class="hljs-property">data</span>.<span class="hljs-property">result</span>);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">tasksCompleted</span>++;
      }
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span>.<span class="hljs-title function_">delete</span>(taskId);
    }
    
    <span class="hljs-comment">// æ ‡è®°Workerä¸ºç©ºé—²</span>
    state.<span class="hljs-property">idle</span> = <span class="hljs-literal">true</span>;
    state.<span class="hljs-property">currentTask</span> = <span class="hljs-literal">null</span>;
    state.<span class="hljs-property">lastUsed</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-title function_">push</span>(workerId);
    
    <span class="hljs-comment">// å¤„ç†ä¸‹ä¸€ä¸ªä»»åŠ¡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
    
    <span class="hljs-comment">// æ¸…ç†ç©ºé—²è¶…æ—¶çš„Worker</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cleanupIdleWorkers</span>();
  }

  <span class="hljs-title function_">handleWorkerError</span>(<span class="hljs-params">workerId, error</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Worker <span class="hljs-subst">${workerId}</span> error:`</span>, error);
    
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerStates</span>.<span class="hljs-title function_">get</span>(workerId);
    <span class="hljs-keyword">if</span> (state &amp;&amp; state.<span class="hljs-property">currentTask</span>) {
      <span class="hljs-keyword">const</span> taskId = state.<span class="hljs-property">currentTask</span>;
      <span class="hljs-keyword">const</span> callback = <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span>.<span class="hljs-title function_">get</span>(taskId);
      
      <span class="hljs-keyword">if</span> (callback) {
        callback.<span class="hljs-title function_">reject</span>(error);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">tasksFailed</span>++;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span>.<span class="hljs-title function_">delete</span>(taskId);
      }
    }
    
    <span class="hljs-comment">// é”€æ¯Worker</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroyWorker</span>(workerId);
    
    <span class="hljs-comment">// åˆ›å»ºæ–°çš„Workeræ›¿æ¢</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createWorker</span>();
    
    <span class="hljs-comment">// å¤„ç†é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
  }

  <span class="hljs-title function_">destroyWorker</span>(<span class="hljs-params">workerId</span>) {
    <span class="hljs-keyword">const</span> workerIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> w.<span class="hljs-property">id</span> === workerId);
    <span class="hljs-keyword">if</span> (workerIndex === -<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> worker = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>[workerIndex];
    
    <span class="hljs-comment">// ç»ˆæ­¢Worker</span>
    worker.<span class="hljs-title function_">terminate</span>();
    
    <span class="hljs-comment">// ä»æ•°ç»„ä¸­ç§»é™¤</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">splice</span>(workerIndex, <span class="hljs-number">1</span>);
    
    <span class="hljs-comment">// æ›´æ–°å…¶ä»–Workerçš„ID</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">w, index</span>) =&gt;</span> {
      w.<span class="hljs-property">id</span> = index;
    });
    
    <span class="hljs-comment">// æ¸…ç†çŠ¶æ€</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerStates</span>.<span class="hljs-title function_">delete</span>(workerId);
    
    <span class="hljs-comment">// ä»ç©ºé—²åˆ—è¡¨ä¸­ç§»é™¤</span>
    <span class="hljs-keyword">const</span> idleIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-title function_">indexOf</span>(workerId);
    <span class="hljs-keyword">if</span> (idleIndex &gt; -<span class="hljs-number">1</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-title function_">splice</span>(idleIndex, <span class="hljs-number">1</span>);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>.<span class="hljs-property">workersDestroyed</span>++;
  }

  <span class="hljs-title function_">cleanupIdleWorkers</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> idleTimeout = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">idleTimeout</span>;
    
    <span class="hljs-comment">// ä¿ç•™è‡³å°‘ä¸€ä¸ªWorker</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">const</span> workerId = <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerStates</span>.<span class="hljs-title function_">get</span>(workerId);
      
      <span class="hljs-keyword">if</span> (state &amp;&amp; now - state.<span class="hljs-property">lastUsed</span> &gt; idleTimeout) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">destroyWorker</span>(workerId);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">break</span>;
      }
    }
  }

  <span class="hljs-title function_">processQueue</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> task = <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">shift</span>();
      <span class="hljs-keyword">const</span> workerId = <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-title function_">shift</span>();
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeTask</span>(workerId, task);
    }
    
    <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ç©ºé—²Workerä½†æœ‰ä»»åŠ¡ï¼Œè€ƒè™‘åˆ›å»ºæ–°Worker</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-property">length</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">maxWorkers</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createWorker</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
    }
  }

  <span class="hljs-title function_">executeTask</span>(<span class="hljs-params">workerId, task</span>) {
    <span class="hljs-keyword">const</span> worker = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">w</span> =&gt;</span> w.<span class="hljs-property">id</span> === workerId);
    <span class="hljs-keyword">if</span> (!worker) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerStates</span>.<span class="hljs-title function_">get</span>(workerId);
    <span class="hljs-keyword">if</span> (!state) <span class="hljs-keyword">return</span>;
    
    state.<span class="hljs-property">idle</span> = <span class="hljs-literal">false</span>;
    state.<span class="hljs-property">currentTask</span> = task.<span class="hljs-property">id</span>;
    state.<span class="hljs-property">lastUsed</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    
    worker.<span class="hljs-title function_">postMessage</span>({
      <span class="hljs-attr">taskId</span>: task.<span class="hljs-property">id</span>,
      <span class="hljs-attr">data</span>: task.<span class="hljs-property">data</span>,
      <span class="hljs-attr">type</span>: task.<span class="hljs-property">type</span>
    });
  }

  <span class="hljs-title function_">runTask</span>(<span class="hljs-params">data, type = <span class="hljs-string">'default'</span></span>) {
    <span class="hljs-keyword">const</span> taskId = <span class="hljs-string">`task_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>)}</span>`</span>;
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> task = {
        <span class="hljs-attr">id</span>: taskId,
        data,
        type
      };
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span>.<span class="hljs-title function_">set</span>(taskId, { resolve, reject });
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">push</span>(task);
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processQueue</span>();
    });
  }

  <span class="hljs-comment">// æ‰¹é‡æ‰§è¡Œä»»åŠ¡</span>
  <span class="hljs-title function_">runTasks</span>(<span class="hljs-params">tasks, type = <span class="hljs-string">'default'</span></span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(
      tasks.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">taskData</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">runTask</span>(taskData, type))
    );
  }

  <span class="hljs-comment">// æ‰§è¡Œå‡½æ•°å¹¶è‡ªåŠ¨æ¸…ç†</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">data, processor</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> processor !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Processor must be a function'</span>);
    }
    
    <span class="hljs-comment">// å°†å¤„ç†å™¨å‡½æ•°å‘é€åˆ°Worker</span>
    <span class="hljs-keyword">const</span> taskId = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">runTask</span>({
      data,
      <span class="hljs-attr">processor</span>: processor.<span class="hljs-title function_">toString</span>()
    }, <span class="hljs-string">'function'</span>);
    
    <span class="hljs-keyword">return</span> taskId;
  }

  <span class="hljs-title function_">getStats</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> {
      ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">stats</span>,
      <span class="hljs-attr">workers</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">idleWorkers</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">activeWorkers</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-property">length</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">queuedTasks</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-property">length</span>,
      <span class="hljs-attr">activeTasks</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span>.<span class="hljs-property">size</span>
    };
  }

  <span class="hljs-title function_">terminate</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ‰€æœ‰Worker</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">worker</span> =&gt;</span> {
      worker.<span class="hljs-title function_">terminate</span>();
    });
    
    <span class="hljs-comment">// æ¸…ç†æ‰€æœ‰ä»»åŠ¡</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">{ reject }</span>) =&gt;</span> {
      <span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Worker pool terminated'</span>));
    });
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workers</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">idleWorkers</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskCallbacks</span>.<span class="hljs-title function_">clear</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">workerStates</span>.<span class="hljs-title function_">clear</span>();
  }
}

<span class="hljs-comment">// Workerè„šæœ¬ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> workerScript = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// Workerå†…éƒ¨ä»£ç </span>
  self.<span class="hljs-property">onmessage</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-keyword">const</span> { taskId, data, type } = event.<span class="hljs-property">data</span>;
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">let</span> result;
      
      <span class="hljs-keyword">switch</span> (type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">'function'</span>:
          <span class="hljs-comment">// æ‰§è¡Œä¼ å…¥çš„å‡½æ•°</span>
          <span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: taskData, processor } = data;
          <span class="hljs-keyword">const</span> func = <span class="hljs-built_in">eval</span>(<span class="hljs-string">`(<span class="hljs-subst">${processor}</span>)`</span>);
          result = <span class="hljs-title function_">func</span>(taskData);
          <span class="hljs-keyword">break</span>;
          
        <span class="hljs-keyword">case</span> <span class="hljs-string">'calculate'</span>:
          <span class="hljs-comment">// è®¡ç®—å¯†é›†å‹ä»»åŠ¡</span>
          result = <span class="hljs-title function_">expensiveCalculation</span>(data);
          <span class="hljs-keyword">break</span>;
          
        <span class="hljs-keyword">case</span> <span class="hljs-string">'process'</span>:
          <span class="hljs-comment">// æ•°æ®å¤„ç†ä»»åŠ¡</span>
          result = <span class="hljs-title function_">processData</span>(data);
          <span class="hljs-keyword">break</span>;
          
        <span class="hljs-attr">default</span>:
          result = data;
      }
      
      self.<span class="hljs-title function_">postMessage</span>({ taskId, result });
    } <span class="hljs-keyword">catch</span> (error) {
      self.<span class="hljs-title function_">postMessage</span>({ 
        taskId, 
        <span class="hljs-attr">error</span>: error.<span class="hljs-property">message</span> || <span class="hljs-string">'Unknown error'</span> 
      });
    }
  };
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">expensiveCalculation</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">iterations</span> || <span class="hljs-number">1000000</span>; i++) {
      result += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(i) * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sin</span>(i);
    }
    <span class="hljs-keyword">return</span> result;
  }
  
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">processData</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-comment">// æ•°æ®å¤„ç†é€»è¾‘</span>
    <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({
      ...item,
      <span class="hljs-attr">processed</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    }));
  }
};

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> workerPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WorkerPool</span>(workerScript, {
  <span class="hljs-attr">maxWorkers</span>: <span class="hljs-number">4</span>,
  <span class="hljs-attr">idleTimeout</span>: <span class="hljs-number">60000</span>
});

<span class="hljs-comment">// æ‰§è¡Œè®¡ç®—å¯†é›†å‹ä»»åŠ¡</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">runCalculations</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> tasks = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">10</span> }, <span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> ({
    <span class="hljs-attr">iterations</span>: <span class="hljs-number">1000000</span> * (i + <span class="hljs-number">1</span>)
  }));
  
  <span class="hljs-keyword">const</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  
  <span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> workerPool.<span class="hljs-title function_">runTasks</span>(tasks, <span class="hljs-string">'calculate'</span>);
  
  <span class="hljs-keyword">const</span> endTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Calculations completed in <span class="hljs-subst">${endTime - startTime}</span>ms`</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Results:'</span>, results);
  
  <span class="hljs-keyword">return</span> results;
}

<span class="hljs-comment">// æ‰§è¡Œå‡½æ•°</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">runCustomFunction</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">processor</span> = (<span class="hljs-params">data</span>) =&gt; {
    <span class="hljs-comment">// è¿™æ˜¯åœ¨Workerä¸­æ‰§è¡Œçš„å‡½æ•°</span>
    <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.<span class="hljs-property">length</span>; i++) {
      sum += data[i] * <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(data[i]);
    }
    <span class="hljs-keyword">return</span> sum;
  };
  
  <span class="hljs-keyword">const</span> data = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000000</span> }, <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>());
  
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> workerPool.<span class="hljs-title function_">execute</span>(data, processor);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Custom function result:'</span>, result);
}

<span class="hljs-comment">// ç›‘æ§ç»Ÿè®¡</span>
<span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Worker pool stats:'</span>, workerPool.<span class="hljs-title function_">getStats</span>());
}, <span class="hljs-number">5000</span>);
</code></pre>
<h5 data-id="heading-31">10.2 ä¸“ç”¨Workerä¼˜åŒ–</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ImageProcessingWorker</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createWorker</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nextTaskId</span> = <span class="hljs-number">1</span>;
  }

  <span class="hljs-title function_">createWorker</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> workerCode = <span class="hljs-string">`
      self.onmessage = function(event) {
        const { taskId, operation, imageData, params } = event.data;
        
        try {
          let result;
          
          switch (operation) {
            case 'resize':
              result = resizeImage(imageData, params);
              break;
              
            case 'filter':
              result = applyFilter(imageData, params);
              break;
              
            case 'compress':
              result = compressImage(imageData, params);
              break;
              
            default:
              throw new Error('Unknown operation: ' + operation);
          }
          
          self.postMessage({ taskId, result }, [result]);
        } catch (error) {
          self.postMessage({ taskId, error: error.message });
        }
      };
      
      function resizeImage(imageData, { width, height, quality = 0.9 }) {
        // åˆ›å»ºç¦»å±Canvas
        const canvas = new OffscreenCanvas(width, height);
        const ctx = canvas.getContext('2d');
        
        // ç»˜åˆ¶å¹¶ç¼©æ”¾å›¾åƒ
        ctx.drawImage(imageData, 0, 0, width, height);
        
        // è½¬æ¢ä¸ºBlob
        return canvas.convertToBlob({ quality });
      }
      
      function applyFilter(imageData, { filter, intensity = 1 }) {
        const canvas = new OffscreenCanvas(
          imageData.width, 
          imageData.height
        );
        const ctx = canvas.getContext('2d');
        
        ctx.drawImage(imageData, 0, 0);
        
        const imageDataObj = ctx.getImageData(
          0, 0, 
          canvas.width, 
          canvas.height
        );
        
        // åº”ç”¨æ»¤é•œ
        const data = imageDataObj.data;
        for (let i = 0; i &lt; data.length; i += 4) {
          // ç®€å•ç°åº¦æ»¤é•œç¤ºä¾‹
          if (filter === 'grayscale') {
            const avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
            data[i] = data[i + 1] = data[i + 2] = avg;
          }
          // æ›´å¤šæ»¤é•œ...
        }
        
        ctx.putImageData(imageDataObj, 0, 0);
        
        return canvas.convertToBlob();
      }
      
      function compressImage(imageData, { quality = 0.7 }) {
        const canvas = new OffscreenCanvas(
          imageData.width, 
          imageData.height
        );
        const ctx = canvas.getContext('2d');
        
        ctx.drawImage(imageData, 0, 0);
        
        return canvas.convertToBlob({ quality });
      }
    `</span>;
    
    <span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Blob</span>([workerCode], { <span class="hljs-attr">type</span>: <span class="hljs-string">'application/javascript'</span> });
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Worker</span>(<span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(blob));
  }

  <span class="hljs-title function_">processImage</span>(<span class="hljs-params">imageElement, operation, params = {}</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> taskId = <span class="hljs-variable language_">this</span>.<span class="hljs-property">nextTaskId</span>++;
      
      <span class="hljs-comment">// åˆ›å»ºCanvasæ¥è·å–ImageData</span>
      <span class="hljs-keyword">const</span> canvas = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'canvas'</span>);
      canvas.<span class="hljs-property">width</span> = imageElement.<span class="hljs-property">width</span>;
      canvas.<span class="hljs-property">height</span> = imageElement.<span class="hljs-property">height</span>;
      
      <span class="hljs-keyword">const</span> ctx = canvas.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>);
      ctx.<span class="hljs-title function_">drawImage</span>(imageElement, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
      
      <span class="hljs-comment">// è·å–ImageData</span>
      <span class="hljs-keyword">const</span> imageData = ctx.<span class="hljs-title function_">getImageData</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.<span class="hljs-property">width</span>, canvas.<span class="hljs-property">height</span>);
      
      <span class="hljs-comment">// åˆ›å»ºImageBitmapï¼ˆæ›´é«˜æ•ˆï¼‰</span>
      <span class="hljs-title function_">createImageBitmap</span>(imageElement).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">imageBitmap</span> =&gt;</span> {
        <span class="hljs-comment">// å­˜å‚¨å›è°ƒ</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">set</span>(taskId, { resolve, reject });
        
        <span class="hljs-comment">// å‘é€ä»»åŠ¡åˆ°Worker</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span>.<span class="hljs-title function_">postMessage</span>({
          taskId,
          operation,
          <span class="hljs-attr">imageData</span>: imageBitmap,
          params
        }, [imageBitmap]);
      });
    });
  }

  <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">worker</span>.<span class="hljs-title function_">terminate</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">taskQueue</span>.<span class="hljs-title function_">clear</span>();
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> imageProcessor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageProcessingWorker</span>();

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">processUserImage</span>(<span class="hljs-params">imageFile</span>) {
  <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
  img.<span class="hljs-property">src</span> = <span class="hljs-variable constant_">URL</span>.<span class="hljs-title function_">createObjectURL</span>(imageFile);
  
  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {
    img.<span class="hljs-property">onload</span> = resolve;
  });
  
  <span class="hljs-comment">// è°ƒæ•´å¤§å°</span>
  <span class="hljs-keyword">const</span> resized = <span class="hljs-keyword">await</span> imageProcessor.<span class="hljs-title function_">processImage</span>(img, <span class="hljs-string">'resize'</span>, {
    <span class="hljs-attr">width</span>: <span class="hljs-number">800</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">600</span>,
    <span class="hljs-attr">quality</span>: <span class="hljs-number">0.8</span>
  });
  
  <span class="hljs-comment">// åº”ç”¨æ»¤é•œ</span>
  <span class="hljs-keyword">const</span> filtered = <span class="hljs-keyword">await</span> imageProcessor.<span class="hljs-title function_">processImage</span>(img, <span class="hljs-string">'filter'</span>, {
    <span class="hljs-attr">filter</span>: <span class="hljs-string">'grayscale'</span>,
    <span class="hljs-attr">intensity</span>: <span class="hljs-number">1</span>
  });
  
  <span class="hljs-comment">// å‹ç¼©</span>
  <span class="hljs-keyword">const</span> compressed = <span class="hljs-keyword">await</span> imageProcessor.<span class="hljs-title function_">processImage</span>(img, <span class="hljs-string">'compress'</span>, {
    <span class="hljs-attr">quality</span>: <span class="hljs-number">0.6</span>
  });
  
  <span class="hljs-keyword">return</span> {
    resized,
    filtered,
    compressed
  };
}
</code></pre>
<h4 data-id="heading-32">åä¸€ã€æœ€ä½³å®è·µä¸æ€§èƒ½åŸåˆ™</h4>
<h5 data-id="heading-33">11.1 æ€§èƒ½ä¼˜åŒ–é»„é‡‘æ³•åˆ™</h5>
<ol>
<li>æµ‹é‡ç¬¬ä¸€ï¼Œä¼˜åŒ–ç¬¬äºŒ</li>
</ol>
<ul>
<li>ä½¿ç”¨Performance APIæµ‹é‡å…³é”®æŒ‡æ ‡</li>
<li>ä¼˜å…ˆä¼˜åŒ–ç“¶é¢ˆï¼Œè€Œéå¾®è§‚ä¼˜åŒ–</li>
<li>å»ºç«‹æ€§èƒ½åŸºå‡†çº¿</li>
</ul>
<ol start="2">
<li>å»¶è¿ŸåŠ è½½ä¸€åˆ‡å¯èƒ½çš„å†…å®¹</li>
</ol>
<ul>
<li>å›¾ç‰‡ã€è§†é¢‘ã€ç¬¬ä¸‰æ–¹è„šæœ¬</li>
<li>éå…³é”®CSSå’ŒJavaScript</li>
<li>è·¯ç”±çº§ä»£ç åˆ†å‰²</li>
</ul>
<ol start="3">
<li>ç¼“å­˜ä¸€åˆ‡å¯èƒ½çš„å†…å®¹</li>
</ol>
<ul>
<li>HTTPç¼“å­˜ç­–ç•¥</li>
<li>å†…å­˜ç¼“å­˜é¢‘ç¹ä½¿ç”¨çš„æ•°æ®</li>
<li>æŒä¹…åŒ–ç¼“å­˜é‡è¦æ•°æ®</li>
</ul>
<ol start="4">
<li>æ‰¹é‡å¤„ç†æ“ä½œ</li>
</ol>
<ul>
<li>DOMæ“ä½œæ‰¹é‡æ›´æ–°</li>
<li>ç½‘ç»œè¯·æ±‚åˆå¹¶</li>
<li>çŠ¶æ€æ›´æ–°åˆå¹¶</li>
</ul>
<ol start="5">
<li>é¿å…é˜»å¡ä¸»çº¿ç¨‹</li>
</ol>
<ul>
<li>é•¿æ—¶é—´ä»»åŠ¡ä½¿ç”¨Web Worker</li>
<li>å¤æ‚è®¡ç®—ä½¿ç”¨æ—¶é—´åˆ‡ç‰‡</li>
<li>é¿å…åŒæ­¥çš„é˜»å¡æ“ä½œ</li>
</ul>
<h5 data-id="heading-34">11.2 æ‰‹å†™å®ç°çš„ä¼˜åŠ¿</h5>
<ol>
<li><strong>ç²¾ç»†æ§åˆ¶</strong></li>
</ol>
<ul>
<li>å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚å®šåˆ¶ä¼˜åŒ–ç­–ç•¥</li>
<li>é¿å…é€šç”¨åº“çš„å†—ä½™ä»£ç </li>
</ul>
<ol start="2">
<li><strong>æ›´å¥½çš„ç†è§£</strong></li>
</ol>
<ul>
<li>æ·±å…¥ç†è§£æ€§èƒ½é—®é¢˜çš„æœ¬è´¨</li>
<li>æŒæ¡åº•å±‚ä¼˜åŒ–åŸç†</li>
</ul>
<ol start="3">
<li><strong>æ›´å°çš„åŒ…ä½“ç§¯</strong></li>
</ol>
<ul>
<li>åªåŒ…å«éœ€è¦çš„åŠŸèƒ½</li>
<li>é¿å…ä¾èµ–å¤§å‹åº“</li>
</ul>
<ol start="4">
<li><strong>æ›´å¥½çš„å¯è°ƒè¯•æ€§</strong></li>
</ol>
<ul>
<li>å®Œå…¨æ§åˆ¶ä»£ç æµç¨‹</li>
<li>æ›´å®¹æ˜“æ·»åŠ æ—¥å¿—å’Œç›‘æ§</li>
</ul>
<h5 data-id="heading-35">11.3 æŒç»­ä¼˜åŒ–æµç¨‹</h5>
<ol>
<li><strong>å»ºç«‹æ€§èƒ½æ–‡åŒ–</strong></li>
</ol>
<ul>
<li>æ€§èƒ½ä½œä¸ºæ ¸å¿ƒéœ€æ±‚</li>
<li>å®šæœŸæ€§èƒ½è¯„å®¡</li>
<li>æ€§èƒ½å›å½’æµ‹è¯•</li>
</ul>
<ol start="2">
<li><strong>è‡ªåŠ¨åŒ–æ€§èƒ½æµ‹è¯•</strong></li>
</ol>
<ul>
<li>é›†æˆåˆ°CI/CDæµç¨‹</li>
<li>è‡ªåŠ¨ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š</li>
<li>è®¾ç½®æ€§èƒ½é¢„ç®—</li>
</ul>
<ol start="3">
<li><strong>æ¸è¿›å¼ä¼˜åŒ–</strong></li>
</ol>
<ul>
<li>ä»æœ€å…³é”®çš„é—®é¢˜å¼€å§‹</li>
<li>å°æ­¥å¿«è·‘ï¼ŒæŒç»­æ”¹è¿›</li>
<li>ç›‘æ§ä¼˜åŒ–æ•ˆæœ</li>
</ul>
<ol start="4">
<li><strong>çŸ¥è¯†åˆ†äº«ä¸ä¼ æ‰¿</strong></li>
</ol>
<ul>
<li>å»ºç«‹æ€§èƒ½çŸ¥è¯†åº“</li>
<li>å®šæœŸåˆ†äº«ä¼š</li>
<li>ç¼–å†™ä¼˜åŒ–æŒ‡å—</li>
</ul>
<h4 data-id="heading-36">æ€»ç»“</h4>
<p>JavaScriptæ€§èƒ½ä¼˜åŒ–æ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œéœ€è¦ç»“åˆç†è®ºçŸ¥è¯†ã€å®è·µç»éªŒå’Œå·¥å…·æ”¯æŒã€‚é€šè¿‡æ‰‹å†™å®ç°è¿™äº›ä¼˜åŒ–æŠ€æœ¯ï¼Œæˆ‘ä»¬ä¸ä»…èƒ½å¤Ÿè§£å†³å…·ä½“çš„æ€§èƒ½é—®é¢˜ï¼Œæ›´èƒ½æ·±å…¥ç†è§£æ€§èƒ½ä¼˜åŒ–çš„æœ¬è´¨ã€‚</p>
<p>è®°ä½ï¼Œæœ€å¥½çš„ä¼˜åŒ–å¾€å¾€æ˜¯é‚£äº›èƒ½å¤Ÿä»æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜çš„ä¼˜åŒ–ï¼Œè€Œä¸æ˜¯ä¸´æ—¶çš„ä¿®è¡¥ã€‚å§‹ç»ˆä»¥ç”¨æˆ·ä½“éªŒä¸ºä¸­å¿ƒï¼Œä»¥æ•°æ®ä¸ºä¾æ®ï¼Œä»¥æŒç»­æ”¹è¿›ä¸ºæ–¹æ³•ï¼Œæ‰èƒ½æ„å»ºå‡ºçœŸæ­£é«˜æ€§èƒ½çš„Webåº”ç”¨ã€‚</p>
<p>æ€§èƒ½ä¼˜åŒ–æ²¡æœ‰é“¶å¼¹ï¼Œä½†æœ‰äº†è¿™äº›æ‰‹å†™å®ç°çš„æŠ€æœ¯å‚¨å¤‡ï¼Œä½ å°†èƒ½å¤Ÿæ›´è‡ªä¿¡åœ°é¢å¯¹å„ç§æ€§èƒ½æŒ‘æˆ˜ï¼Œæ„å»ºå‡ºæ›´å¿«ã€æ›´æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JVM ä¹‹ å†…å­˜æº¢å‡ºå®æˆ˜ã€OOM? SOF? å“ªäº›åŒºåŸŸä¼šæº¢å‡ºï¼Ÿå †ã€è™šæ‹Ÿæœºæ ˆã€å…ƒç©ºé—´ã€ç›´æ¥å†…å­˜æº¢å‡ºæ—¶å„è‡ªçš„ç‰¹ç‚¹ï¼Ÿä»¥åŠä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´ä»–ä»¬æº¢å‡ºï¼Ÿå¹¶æ¨¡æ‹Ÿæº¢å‡ºã€‘]]></title>    <link>https://juejin.cn/post/7583234966634020898</link>    <guid>https://juejin.cn/post/7583234966634020898</guid>    <pubDate>2025-12-14T08:15:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583234966634020898" data-draft-id="7583225356904562728" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JVM ä¹‹ å†…å­˜æº¢å‡ºå®æˆ˜ã€OOM? SOF? å“ªäº›åŒºåŸŸä¼šæº¢å‡ºï¼Ÿå †ã€è™šæ‹Ÿæœºæ ˆã€å…ƒç©ºé—´ã€ç›´æ¥å†…å­˜æº¢å‡ºæ—¶å„è‡ªçš„ç‰¹ç‚¹ï¼Ÿä»¥åŠä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´ä»–ä»¬æº¢å‡ºï¼Ÿå¹¶æ¨¡æ‹Ÿæº¢å‡ºã€‘"/> <meta itemprop="keywords" content="JVM"/> <meta itemprop="datePublished" content="2025-12-14T08:15:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‡_ç®€"/> <meta itemprop="url" content="https://juejin.cn/user/784379873344682"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JVM ä¹‹ å†…å­˜æº¢å‡ºå®æˆ˜ã€OOM? SOF? å“ªäº›åŒºåŸŸä¼šæº¢å‡ºï¼Ÿå †ã€è™šæ‹Ÿæœºæ ˆã€å…ƒç©ºé—´ã€ç›´æ¥å†…å­˜æº¢å‡ºæ—¶å„è‡ªçš„ç‰¹ç‚¹ï¼Ÿä»¥åŠä»€ä¹ˆæƒ…å†µä¼šå¯¼è‡´ä»–ä»¬æº¢å‡ºï¼Ÿå¹¶æ¨¡æ‹Ÿæº¢å‡ºã€‘
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/784379873344682/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‡_ç®€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:15:26.000Z" title="Sun Dec 14 2025 08:15:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å®æˆ˜ï¼šOutOfMemoryErrorå¼‚å¸¸</h2>
<p>é™¤äº†ç¨‹åºè®¡æ•°å™¨å¤–ï¼Œå †ã€è™šæ‹Ÿæœºæ ˆã€å…ƒç©ºé—´ã€ç›´æ¥å†…å­˜éƒ½æœ‰å‘ç”ŸOOMçš„å¯èƒ½
ä¸‹é¢æˆ‘ä»¬æ¼”ç¤ºä¸‹å¼•èµ·å„åŒºåŸŸOOMçš„æƒ…å†µï¼ŒåŠè§‚å¯Ÿä¸‹å…¶å¼‚å¸¸è¡¨ç°ï¼Œè¿›è€Œåˆæ­¥æ€»ç»“å„å¼‚å¸¸æ—¶çš„è°ƒä¼˜ç­–ç•¥</p>
<p><strong>JVMè°ƒä¼˜å®ä¾‹</strong>ï¼š</p>
<ul>
<li>å †ï¼š-ã€‹OOM: Java heap space -&gt;è·å–å †è½¬å‚¨å¿«ç…§-ã€‹åˆ†ææ˜¯æº¢å‡ºï¼ˆè°ƒå¤§å †ï¼‰è¿˜æ˜¯æ³„æ¼ï¼ˆä¼˜åŒ–ä»£ç ï¼‰ï¼Œå¹¶è§£å†³</li>
<li>è™šæ‹Ÿæœºæ ˆï¼š
<ul>
<li>-ã€‹SOF -ã€‹æ ¹æ®å †æ ˆä¿¡æ¯å»è§£å†³ï¼›</li>
<li>-ã€‹OOM -&gt; çº¿ç¨‹è¿‡å¤š -ã€‹è°ƒå°å †ç»™è™šæ‹Ÿæœºæ ˆç•™å‡ºå†…å­˜</li>
</ul>
</li>
<li>å…ƒç©ºé—´ -ã€‹OOM:Metaspace -&gt;è°ƒæ•´ä»£ç +è°ƒå¤§å…ƒç©ºé—´ä¸Šé™</li>
<li>ç›´æ¥å†…å­˜ -ã€‹OOM,ä½†å †è½¬å‚¨æ–‡ä»¶å¾ˆå°ä¸”æ²¡å¼‚å¸¸-ã€‹è°ƒå¤§ç›´æ¥å†…å­˜</li>
</ul>
<h3 data-id="heading-1">Javaå †æº¢å‡º</h3>
<p>javaå †å¼‚å¸¸ä¸€èˆ¬æ˜¯ç”±äºåˆ›å»ºäº†å¤ªå¤šçš„æ— æ³•å›æ”¶çš„å¯¹è±¡ï¼Œå¯¼è‡´è¶…è¿‡äº†å †çš„æœ€å¤§å®¹é‡çš„ã€‚</p>
<h4 data-id="heading-2">å¼‚å¸¸å¤„ç†æ€è·¯</h4>
<p>æ‰€ä»¥å¼‚å¸¸å¤„ç†æ—¶çš„æ€è·¯æ˜¯ï¼š</p>
<ul>
<li>1ã€å…ˆæ‹¿åˆ°å¼‚å¸¸çš„å †è½¬å‚¨å¿«ç…§ã€‚</li>
<li>2ã€ç„¶åæ ¹æ®å¿«ç…§ï¼Œåˆ¤æ–­æº¢å‡ºå¯¹è±¡æ˜¯å¦å¿…è¦ã€‚
<ul>
<li>å¦‚å¿…è¦ï¼Œåˆ™æ˜¯å†…å­˜æº¢å‡ºï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è°ƒå¤§å†…å­˜ï¼Œæˆ–è€…è°ƒå°ä¸€äº›ä¸å¿…è¦çš„å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸè…¾å‡ºä¸€éƒ¨åˆ†ç©ºé—´ã€‚</li>
<li>å¦‚ä¸å¿…è¦ï¼Œåˆ™æ˜¯å†…å­˜æ³„æ¼ï¼Œé€šè¿‡GC ROOTæŸ¥çœ‹å¯¹è±¡çš„å¼•ç”¨é“¾ï¼Œçœ‹çœ‹ä¸ºå•¥æ²¡æœ‰å›æ”¶ï¼Œå¹¶åŠ ä»¥è§£å†³ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-3">æ¨¡æ‹Ÿå¼‚å¸¸</h4>
<p>Javaå †OOMæ˜¯å¸¸è§æƒ…å†µï¼Œå¼‚å¸¸ä¿¡æ¯ä¸­ä¼šè¿›ä¸€æ­¥æç¤º<code>Java heap space</code>ã€‚
<strong>æ¨¡æ‹Ÿä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * VM Argsï¼š-Xms20m -Xmx20m -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=D:\IdeaSpeace\jvm
 * é™åˆ¶Javaå †çš„å¤§å°ä¸º20MBï¼Œä¸å¯æ‰©å±•ï¼ˆå°†å †çš„æœ€å¤§æœ€å°å€¼-Xmx-Xmså‚æ•°è®¾ç½®ä¸€æ ·ï¼‰,å‡ºç°å†…å­˜æº¢å‡ºå¼‚å¸¸çš„æ—¶å€™Dumpå‡ºå½“å‰çš„å†…å­˜å †è½¬å‚¨å¿«ç…§ï¼Œåˆ¶å®šå­˜å‚¨è·¯å¾„
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HeapOOM</span> {
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OOMObject</span> {
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;OOMObject&gt; list = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;OOMObject&gt;();
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            list.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">OOMObject</span>());
        }
    }
}
</code></pre>
<p><strong>è¿è¡Œç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-text" lang="text">java.lang.OutOfMemoryError: Java heap space
Dumping heap to D:\IdeaSpeace\jvm\java_pid8584.hprof ...
Heap dump file created [27646160 bytes in 0.090 secs]
</code></pre>
<h4 data-id="heading-4">è¯¦ç»†æ“ä½œæ­¥éª¤</h4>
<ul>
<li>1ã€é€šè¿‡-XX:+HeapDumpOnOutOfMemoryErroræ‹¿åˆ°å †è½¬å‚¨å¿«ç…§ã€‚</li>
<li>2ã€é€šè¿‡jprofilerå·¥å…·åˆ†æå †è½¬å‚¨å¿«ç…§ï¼Œåˆ¤æ–­å†…å­˜ä¸­å¯¼è‡´OOMçš„å¯¹è±¡æ˜¯å¦å¿…è¦ï¼Ÿ
<ul>
<li>2.1ã€<strong>ä¸å¿…è¦ -&gt; å†…å­˜æ³„æ¼</strong> -&gt; æŸ¥çœ‹å¯¹è±¡GC ROOTå¼•ç”¨é“¾ï¼Œè¿›è€Œå®šä½ä¸ºä½•æ— æ³•å›æ”¶ï¼Œæœ€ç»ˆæ‰¾åˆ°æ³„æ¼ä½ç½®åŠ ä»¥è§£å†³</li>
<li>2.2ã€<strong>å¿…è¦ -&gt; å†…å­˜æº¢å‡º</strong> -&gt; è°ƒæ•´å †å¤§å°ã€ä¿®æ”¹ä¸åˆç†ä»£ç ã€‚
<ul>
<li>2.2.1ã€è°ƒæ•´å †å¤§å°ï¼šåœ¨æœºå™¨å†…å­˜å…è®¸çš„èŒƒå›´å†…ï¼Œé€‚å½“è°ƒæ•´javaè™šæ‹Ÿæœº(-Xmxä¸-Xms)å †å‚æ•°</li>
<li>2.2.2ã€ä¿®æ”¹ä¸åˆç†ä»£ç ï¼šæ£€æŸ¥ä»£ç ä¸­æ˜¯å¦å­˜åœ¨é•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œä¸åˆç†çš„å­˜å‚¨ç»“æ„è®¾è®¡ï¼ˆæ¯”å¦‚å¯ä»¥ç”¨longä½†æ˜¯ç”¨mapå­˜ï¼‰</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc6b7f8f628f42d3b9a20b05d715c3a0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YePX-eugA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766305077&amp;x-signature=dmEfUF%2BI20fGU96tl40U4c6Z%2B8M%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-5">è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆæº¢å‡º</h3>
<ul>
<li>1ã€æ ˆæ·±åº¦è¿‡æ·±ï¼ˆæ ˆæ·±åº¦ &gt; è™šæ‹Ÿæœºçš„æœ€å¤§æ·±åº¦ï¼‰ -ã€‹StackOverflowErrorå¼‚å¸¸ã€‚</li>
</ul>
<blockquote>
<p>æ³¨æ„ï¼šHotSpotè™šæ‹Ÿæœºä¸­ä¸åŒºåˆ†è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œæ‰€ä»¥æ ˆå®¹é‡åªç”±-Xssè®¾å®šï¼ˆ-Xosså‚æ•°è®¾ç½®æœ¬åœ°æ–¹æ³•æ ˆå¤§å°ä¸å‘æŒ¥ä½œç”¨ï¼‰</p>
</blockquote>
<ul>
<li>2ã€åˆ›å»ºçº¿ç¨‹æ•°è¿‡å¤š -ã€‹OOMå¼‚å¸¸ã€‚</li>
</ul>
<blockquote>
<p>(åˆ›å»ºçº¿ç¨‹æ•° * çº¿ç¨‹æ ˆå†…å­˜) &gt; (è¿›ç¨‹å†…å­˜ï¼ˆæ“ä½œç³»ç»Ÿé™åˆ¶ï¼‰- æœ€å¤§å †å®¹é‡ - æœ€å¤§æ–¹æ³•åŒºå®¹é‡)</p>
</blockquote>
<h4 data-id="heading-6">å¼‚å¸¸å¤„ç†æ€è·¯</h4>
<ul>
<li>1ã€StackOverflowErrorå¼‚å¸¸ï¼šæ ¹æ®æ‰“å°å‡ºçš„å †æ ˆä¿¡æ¯å»å®šä½å³å¯ã€‚</li>
</ul>
<blockquote>
<p>åœ¨ä½¿ç”¨é»˜è®¤-Xsså‚æ•°çš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬è€Œè¨€åˆ°è¾¾1000~2000çš„æ ˆæ·±åº¦æ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜çš„ã€‚ï¼ˆå…·ä½“æ·±åº¦ç”±å‹å…¥çš„æ ˆå¸§å¤§å°å†³å®šï¼‰</p>
</blockquote>
<ul>
<li>2ã€OOMå¼‚å¸¸ï¼šæ­¤æ—¶ä¼šæç¤º<code>unable to create native thread</code>è¡¨ç¤ºçº¿ç¨‹æ•°è¿‡å¤šï¼Œ
<ul>
<li>2.1ã€çº¿ç¨‹æ•°å¼‚å¸¸åˆ›å»º -ã€‹ ä¼˜åŒ–ä»£ç ï¼Œå‡å°‘ä¸å¿…è¦çš„çº¿ç¨‹åˆ›å»º</li>
<li>2.2ã€åˆ›å»ºçš„çº¿ç¨‹å‡å¿…é¡» -ã€‹ å‡å°‘æœ€å¤§å †ã€å‡å°‘æ ˆå®¹é‡ï¼Œæ¥æå‡åˆ›å»ºçº¿ç¨‹æ•°ã€‚</li>
</ul>
</li>
</ul>
<blockquote>
<p>çº¿ç¨‹æ•°è¿‡å¤šå¼•å‘OOMæ—¶ï¼Œéœ€åå‘è°ƒæ•´å †å¤§å°ï¼Œæ¥ç»™åˆ›å»ºçº¿ç¨‹åˆ†é…è™šæ‹Ÿæœºæ ˆæä¾›æ›´å¤šå¯ç”¨å†…å­˜ã€‚</p>
</blockquote>
<h4 data-id="heading-7">å¼‚å¸¸ä»£ç æ¼”ç¤º</h4>
<ul>
<li>1ã€æ ˆæ·±åº¦è¿‡æ·±ï¼Œå¼•å‘SOFå¼‚å¸¸
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * VM Argsï¼š-Xss128k (ä½¿ç”¨-Xsså‚æ•°å‡å°‘æ ˆå†…å­˜å®¹é‡)
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaVMStackSOF</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">stackLength</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stackLeak</span><span class="hljs-params">()</span> {
        stackLength++;
        stackLeak();
    }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">JavaVMStackSOF</span> <span class="hljs-variable">oom</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JavaVMStackSOF</span>();
        <span class="hljs-keyword">try</span> {
            oom.stackLeak();
        } <span class="hljs-keyword">catch</span> (Throwable e) {
            System.out.println(<span class="hljs-string">"stack length:"</span> + oom.stackLength);
            <span class="hljs-keyword">throw</span> e;
        }
    }
}
</code></pre>
<strong>è¿è¡Œç»“æœ</strong>ï¼š
<pre><code class="hljs language-text" lang="text">stack length:2298
Exception in thread "main" java.lang.StackOverflowError
    at com.dream.my.faceTest.jvm.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:11)
    at com.dream.my.faceTest.jvm.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:12)
    at com.dream.my.faceTest.jvm.JavaVMStackSOF.stackLeak(JavaVMStackSOF.java:12)
â€¦â€¦åç»­å¼‚å¸¸å †æ ˆä¿¡æ¯çœç•¥
</code></pre>
</li>
<li>2ã€åˆ›å»ºçº¿ç¨‹æ•°è¿‡å¤šï¼Œè€—å°½å†…å­˜ï¼Œå¼•å‘ OOMå¼‚å¸¸ï¼š
<blockquote>
<p>é‡ç‚¹æç¤º: å¦‚æœè¿è¡Œä¸Šé¢è¿™æ®µä»£ç ï¼Œè®°å¾—è¦å…ˆä¿å­˜å½“å‰çš„å·¥ä½œã€‚ å› ä¸ºåœ¨Windowså¹³å°çš„Javaçš„çº¿ç¨‹æ˜¯æ˜ å°„åˆ°æ“ä½œç³»ç»Ÿçš„å†…æ ¸çº¿ç¨‹ä¸Šï¼Œåˆ›å»ºè¿‡å¤šçº¿ç¨‹å¯èƒ½å¯¼è‡´æ“ä½œç³»ç»Ÿå‡æ­»ã€‚</p>
</blockquote>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * VM Argsï¼š-Xss2M ï¼ˆè¿™æ—¶å€™ä¸å¦¨è®¾å¤§äº›ï¼Œè¯·åœ¨32ä½ç³»ç»Ÿä¸‹è¿è¡Œï¼‰
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaVMStackOOM</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dontStop</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stackLeakByThread</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-type">Thread</span> <span class="hljs-variable">thread</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Runnable</span>() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">run</span><span class="hljs-params">()</span> {
                    dontStop();
                }
            });
            thread.start();
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">JavaVMStackOOM</span> <span class="hljs-variable">oom</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JavaVMStackOOM</span>();
        oom.stackLeakByThread();
    }
}
</code></pre>
<strong>å¼‚å¸¸å…³é”®ä¿¡æ¯</strong>ï¼š<code>unable to create new native thread</code>
<pre><code class="hljs language-text" lang="text">Exception in thread "main" java.lang.OutOfMemoryError: unable to create new native thread
    at java.lang.Thread.start0(Native Method)
    at java.lang.Thread.start(Thread.java:717)
    at com.dream.my.faceTest.jvm.JavaVMStackOOM.stackLeakByThread(JavaVMStackOOM.java:22)
    at com.dream.my.faceTest.jvm.JavaVMStackOOM.main(JavaVMStackOOM.java:28)
</code></pre>
</li>
</ul>
<h3 data-id="heading-8">å…ƒç©ºé—´æº¢å‡º</h3>
<ul>
<li>èƒŒæ™¯ï¼šä»jdk7èµ·ï¼Œæ–¹æ³•åŒºå°±è¢«æ”¾åœ¨å †ä¸­</li>
<li>å¸¸è§é—®é¢˜ï¼šä½¿ç”¨aopåŠ¨æ€ç”Ÿæˆå¤§é‡å­—èŠ‚ç ï¼ˆcglibï¼‰å¯¼è‡´OOM</li>
</ul>
<h4 data-id="heading-9">å¼‚å¸¸æ’æŸ¥æ€è·¯</h4>
<ul>
<li>1ã€å®šä½åˆ°<code>java.lang.OutOfMemoryError: Metaspace</code>å³æ˜¯æ–¹æ³•åŒºæº¢å‡ºã€‚</li>
<li>2ã€ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†ä¸å¿…è¦çš„aop</li>
<li>3ã€å¦‚æœç±»éƒ½æ˜¯å¿…è¦çš„ï¼Œè°ƒå¤§å…ƒç©ºé—´çš„å€¼<code>-XX:MaxMetaspaceSize</code></li>
</ul>
<pre><code class="hljs language-text" lang="text"># å…ƒç©ºé—´è°ƒä¼˜å‚æ•°
-XX:MaxMetaspaceSize //è®¾ç½®å…ƒç©ºé—´æœ€å¤§å€¼ï¼Œæ¨è256M~512Mï¼Œè¶…è¿‡åæŠ¥OOMï¼ˆ-1 ä¸ºä¸é™åˆ¶å¤§å°ï¼‰
-XX:MetaspaceSize //è¾¾åˆ°è¯¥å€¼åï¼Œå…ƒç©ºé—´è¿›è¡Œç¬¬ä¸€æ¬¡GCï¼ˆGCåå¦‚ä»è¶…è¿‡ï¼Œåˆ™æ‰©å®¹æœªåŸæ¥çš„1.2å€ï¼‰
-XX:MinMetaspaceFreeRatio //GCåï¼Œå…ƒç©ºé—´æœ€å°ç©ºé—²ç©ºé—´æ¯”ç‡ï¼Œä¸å¤Ÿåˆ™æ‰©å®¹
-XX:MaxMetaspaceFreeRatio //GCåï¼Œå…ƒç©ºé—´æœ€å¤§ç©ºé—²ç©ºé—´æ¯”ç‡ï¼Œå¤šäº†åˆ™ç¼©å®¹
</code></pre>
<h4 data-id="heading-10">å¼‚å¸¸æ¼”ç¤ºä»£ç (JDK8)</h4>
<p>æ–¹æ³•åŒºçš„ä¸»è¦èŒè´£æ˜¯ç”¨äºå­˜æ”¾ç±»å‹çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç±»åã€è®¿é—®ä¿®é¥°ç¬¦ã€å¸¸é‡æ± ã€å­—æ®µæè¿°ã€æ–¹æ³•æè¿°ç­‰ã€‚
å¯¹äºè¿™éƒ¨åˆ†åŒºåŸŸçš„æµ‹è¯•ï¼ŒåŸºæœ¬çš„æ€è·¯æ˜¯è¿è¡Œæ—¶äº§ç”Ÿå¤§é‡çš„ç±»å»å¡«æ»¡æ–¹æ³•åŒºï¼Œç›´åˆ°æº¢å‡ºä¸ºæ­¢ã€‚</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * VM Argsï¼š-XXï¼šMetaspaceSize=10M -XXï¼šMaxMetaspaceSize=10M
 * å€ŸåŠ©CGLibä½¿å¾—æ–¹æ³•åŒºå‡ºç°å†…å­˜æº¢å‡ºå¼‚å¸¸
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaMethodAreaOOM</span> {

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-type">Enhancer</span> <span class="hljs-variable">enhancer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Enhancer</span>();
            enhancer.setSuperclass(OOMObject.class);
            enhancer.setUseCache(<span class="hljs-literal">false</span>);
            enhancer.setCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">MethodInterceptor</span>() {
                <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Object obj, Method method, Object[] args, MethodProxy proxy)</span> <span class="hljs-keyword">throws</span> Throwable {
                    <span class="hljs-keyword">return</span> proxy.invokeSuper(obj, args);
                }
            });
            enhancer.create();
        }
    }

    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OOMObject</span> {
    }
}
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-text" lang="text">Caused by: java.lang.OutOfMemoryError: Metaspace
	at java.lang.ClassLoader.defineClass1(Native Method)
	at java.lang.ClassLoader.defineClass(ClassLoader.java:756)
	at sun.reflect.GeneratedMethodAccessor1.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.cglib.core.ReflectUtils.defineClass(ReflectUtils.java:554)
	... 7 more
</code></pre>
<h3 data-id="heading-11">æœ¬æœºç›´æ¥å†…å­˜æº¢å‡º</h3>
<p>ç›´æ¥å†…å­˜ä¸åœ¨jvmå†…å­˜æ¨¡å‹å†…ï¼Œä½†ä¹Ÿæ˜¯æœ‰å¯èƒ½å¯¼è‡´OOM.ï¼ˆå…¸å‹çš„é—´æ¥ä½¿ç”¨å°±æ˜¯NIOï¼‰</p>
<h4 data-id="heading-12">å¼‚å¸¸å®šä½æ’æŸ¥æ€è·¯</h4>
<ul>
<li>1ã€å‡ºç°äº†OOMå¼‚å¸¸ï¼Œä½†æ˜¯Heap Dumpæ–‡ä»¶å¾ˆå°ï¼Œä¸”æœŸä¸­æ²¡ä»€ä¹ˆå¼‚å¸¸ä¿¡æ¯ï¼Œæ­¤æ—¶å°±è¯¥è€ƒè™‘æ˜¯ä¸æ˜¯ç›´æ¥å†…å­˜æº¢å‡ºäº†ã€‚</li>
<li>2ã€è°ƒæ•´ç›´æ¥å†…å­˜å¤§å°<code>-XXï¼šMaxDirectMemorySize æŒ‡å®šç›´æ¥å†…å­˜å¤§å°ï¼ˆé»˜è®¤ä¸Javaå †æœ€å¤§å€¼ä¸€è‡´ï¼‰</code></li>
</ul>
<h4 data-id="heading-13">å¼‚å¸¸æ¼”ç¤ºä»£ç </h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * VM Argsï¼š-Xmx20M -XX:MaxDirectMemorySize=10M
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DirectMemoryOOM</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">_1MB</span> <span class="hljs-operator">=</span> <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-type">Field</span> <span class="hljs-variable">unsafeField</span> <span class="hljs-operator">=</span> Unsafe.class.getDeclaredFields()[<span class="hljs-number">0</span>];
        unsafeField.setAccessible(<span class="hljs-literal">true</span>);
        <span class="hljs-comment">//åˆ†é…æœ¬æœºå†…å­˜</span>
        <span class="hljs-type">Unsafe</span> <span class="hljs-variable">unsafe</span> <span class="hljs-operator">=</span> (Unsafe) unsafeField.get(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-comment">//çœŸæ­£ç”³è¯·åˆ†é…å†…å­˜</span>
            unsafe.allocateMemory(_1MB);
        }
    }
}
</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<pre><code class="hljs language-text" lang="text">Exception in thread "main" java.lang.OutOfMemoryError
	at sun.misc.Unsafe.allocateMemory(Native Method)
	at com.dream.my.faceTest.jvm.DirectMemoryOOM.main(DirectMemoryOOM.java:23)
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[.NETè¿›é˜¶â€”â€”æ·±å…¥ç†è§£Lambdaè¡¨è¾¾å¼ï¼ˆ2ï¼‰æ‰‹æ“LINQè¯­å¥]]></title>    <link>https://juejin.cn/post/7583344281738625070</link>    <guid>https://juejin.cn/post/7583344281738625070</guid>    <pubDate>2025-12-14T08:32:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583344281738625070" data-draft-id="7583244688121069577" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=".NETè¿›é˜¶â€”â€”æ·±å…¥ç†è§£Lambdaè¡¨è¾¾å¼ï¼ˆ2ï¼‰æ‰‹æ“LINQè¯­å¥"/> <meta itemprop="keywords" content=".NET,C#"/> <meta itemprop="datePublished" content="2025-12-14T08:32:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘è¦æ‹¿å¾®è½¯MVP"/> <meta itemprop="url" content="https://juejin.cn/user/1945461219656633"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            .NETè¿›é˜¶â€”â€”æ·±å…¥ç†è§£Lambdaè¡¨è¾¾å¼ï¼ˆ2ï¼‰æ‰‹æ“LINQè¯­å¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1945461219656633/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘è¦æ‹¿å¾®è½¯MVP
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:32:48.000Z" title="Sun Dec 14 2025 08:32:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">ä¸€ã€å…ˆææ‡‚ï¼šä»€ä¹ˆæ˜¯ LINQï¼Ÿï¼ˆé€šä¿— + æŠ€æœ¯å®šä¹‰ï¼‰</h3>
<h4 data-id="heading-1">é€šä¿—æ¯”å–»</h4>
<p>LINQ å°±åƒ â€œé€šç”¨é¥æ§å™¨â€ï¼š</p>
<ul>
<li>ä¸åŒçš„ â€œå®¶ç”µâ€= ä¸åŒçš„æ•°æ®æºï¼ˆå†…å­˜é›†åˆã€æ•°æ®åº“ã€XMLã€Excel ç­‰ï¼‰ï¼›</li>
<li>ä¸åŒå®¶ç”µåŸæœ¬æœ‰å„è‡ªçš„ â€œæ“ä½œæ–¹å¼â€ï¼ˆéå†é›†åˆå†™å¾ªç¯ã€æŸ¥æ•°æ®åº“å†™ SQLã€è§£æ XML å†™ä¸“ç”¨ä»£ç ï¼‰ï¼›</li>
<li>LINQ è¿™ä¸ª â€œé€šç”¨é¥æ§å™¨â€= ç»Ÿä¸€çš„è¯­æ³•ï¼Œä¸ç®¡æ“ä½œå“ªç§æ•°æ®æºï¼Œéƒ½ç”¨ç›¸ä¼¼çš„å†™æ³•ï¼ˆæ¯”å¦‚ç­›é€‰æ•°æ®éƒ½ç”¨ Whereï¼Œè½¬æ¢æ•°æ®éƒ½ç”¨ Selectï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-2">æŠ€æœ¯å®šä¹‰</h4>
<p>LINQï¼ˆLanguage Integrated Queryï¼Œè¯­è¨€é›†æˆæŸ¥è¯¢ï¼‰æ˜¯ C# å†…ç½®çš„æŸ¥è¯¢æ¡†æ¶ï¼Œæ ¸å¿ƒä»·å€¼æ˜¯ï¼š</p>
<ol>
<li><strong>ç»Ÿä¸€è¯­æ³•</strong>ï¼šç”¨ä¸€å¥—è¯­æ³•æ“ä½œæ‰€æœ‰æ•°æ®æºï¼ˆé›†åˆã€æ•°æ®åº“ã€XML ç­‰ï¼‰ï¼›</li>
<li><strong>ç±»å‹å®‰å…¨</strong>ï¼šç¼–è¯‘æœŸæ£€æŸ¥æŸ¥è¯¢è¯­æ³•é”™è¯¯ï¼ˆä¸åƒ SQL å†™é”™è¦è¿è¡Œæ—¶æ‰å‘ç°ï¼‰ï¼›</li>
<li><strong>ç®€æ´é«˜æ•ˆ</strong>ï¼šç”¨å‡ è¡Œä»£ç æ›¿ä»£å†—ä½™çš„å¾ªç¯ / åˆ¤æ–­ï¼Œåº•å±‚å°±æ˜¯<strong>æ‰©å±•æ–¹æ³• + Lambda</strong>çš„ç»„åˆï¼ˆæŸ¥è¯¢è¯­æ³•åªæ˜¯è¯­æ³•ç³–ï¼‰ã€‚</li>
</ol>
<h4 data-id="heading-3">LINQ çš„ä¸¤ç§å¸¸ç”¨å†™æ³•ï¼ˆæ–°æ‰‹å…ˆæŒæ¡æ–¹æ³•è¯­æ³•ï¼‰</h4>
<p>LINQ æœ‰ä¸¤ç§å†™æ³•ï¼Œæœ€ç»ˆéƒ½ä¼šç¼–è¯‘æˆ â€œæ‰©å±•æ–¹æ³• + Lambdaâ€ï¼Œæˆ‘ä»¬ä»¥è®¢å•ç­›é€‰ä¸ºä¾‹å¯¹æ¯”ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;
<span class="hljs-keyword">using</span> System.Linq; <span class="hljs-comment">// LINQæ ¸å¿ƒå‘½åç©ºé—´</span>

<span class="hljs-comment">// åŸºç¡€è®¢å•å®ä½“</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> OrderId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Amount { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®æºï¼šè®¢å•åˆ—è¡¨</span>
        List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> List&lt;Order&gt;
        {
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">1</span>, Amount = <span class="hljs-number">800</span>, Customer = <span class="hljs-string">"å¼ ä¸‰"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">2</span>, Amount = <span class="hljs-number">1200</span>, Customer = <span class="hljs-string">"æå››"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">3</span>, Amount = <span class="hljs-number">1500</span>, Customer = <span class="hljs-string">"ç‹äº”"</span> }
        };

        <span class="hljs-comment">// å†™æ³•1ï¼šæŸ¥è¯¢è¯­æ³•ï¼ˆSQLé£æ ¼ï¼Œè¯­æ³•ç³–ï¼‰</span>
        <span class="hljs-keyword">var</span> querySyntax = <span class="hljs-keyword">from</span> o <span class="hljs-keyword">in</span> orders
                          <span class="hljs-keyword">where</span> o.Amount &gt; <span class="hljs-number">1000</span>
                          <span class="hljs-keyword">select</span> <span class="hljs-keyword">new</span> { o.OrderId, o.Customer, é‡‘é¢ = o.Amount };

        <span class="hljs-comment">// å†™æ³•2ï¼šæ–¹æ³•è¯­æ³•ï¼ˆæ‰©å±•æ–¹æ³•+Lambdaï¼ŒLINQåº•å±‚å®ç°ï¼‰</span>
        <span class="hljs-keyword">var</span> methodSyntax = orders
            .Where(o =&gt; o.Amount &gt; <span class="hljs-number">1000</span>) <span class="hljs-comment">// æ‰©å±•æ–¹æ³•+Lambdaç­›é€‰</span>
            .Select(o =&gt; <span class="hljs-keyword">new</span> { o.OrderId, o.Customer, é‡‘é¢ = o.Amount }); <span class="hljs-comment">// æ‰©å±•æ–¹æ³•+Lambdaè½¬æ¢</span>

        <span class="hljs-comment">// ä¸¤ç§å†™æ³•ç»“æœå®Œå…¨ä¸€è‡´</span>
        Console.WriteLine(<span class="hljs-string">"æŸ¥è¯¢è¯­æ³•ç»“æœï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> querySyntax) Console.WriteLine(<span class="hljs-string">$"è®¢å•IDï¼š<span class="hljs-subst">{item.OrderId}</span>ï¼Œå®¢æˆ·ï¼š<span class="hljs-subst">{item.Customer}</span>"</span>);
        
        Console.WriteLine(<span class="hljs-string">"\næ–¹æ³•è¯­æ³•ç»“æœï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> methodSyntax) Console.WriteLine(<span class="hljs-string">$"è®¢å•IDï¼š<span class="hljs-subst">{item.OrderId}</span>ï¼Œå®¢æˆ·ï¼š<span class="hljs-subst">{item.Customer}</span>"</span>);
    }
}
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs">æŸ¥è¯¢è¯­æ³•ç»“æœï¼š
è®¢å•IDï¼š2ï¼Œå®¢æˆ·ï¼šæå››
è®¢å•IDï¼š3ï¼Œå®¢æˆ·ï¼šç‹äº”

æ–¹æ³•è¯­æ³•ç»“æœï¼š
è®¢å•IDï¼š2ï¼Œå®¢æˆ·ï¼šæå››
è®¢å•IDï¼š3ï¼Œå®¢æˆ·ï¼šç‹äº”
</code></pre>
<p><strong>æ ¸å¿ƒè§£æï¼ˆç»™æ–°æ‰‹çš„è¯ï¼‰</strong> ï¼š</p>
<ul>
<li>æŸ¥è¯¢è¯­æ³•ï¼ˆ<code>from...where...select</code>ï¼‰æ˜¯ SQL é£æ ¼çš„ â€œè¯­æ³•ç³–â€ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è½¬æ¢æˆæ–¹æ³•è¯­æ³•ï¼ˆæ‰©å±•æ–¹æ³• + Lambdaï¼‰ï¼›</li>
<li>æ–¹æ³•è¯­æ³•æ˜¯ LINQ çš„<strong>åº•å±‚å®ç°å½¢å¼</strong>ï¼Œä¹Ÿæ˜¯æ–°æ‰‹éœ€è¦é‡ç‚¹æŒæ¡çš„ï¼ˆæ›´çµæ´»ã€æ›´è´´è¿‘åº•å±‚ï¼‰ï¼›</li>
<li>LINQ çš„æ ¸å¿ƒå°±æ˜¯ï¼š<strong>ç»™é›†åˆï¼ˆæˆ–å…¶ä»–æ•°æ®æºï¼‰æ‰©å±•ä¸€ç³»åˆ—é€šç”¨æ–¹æ³•ï¼ˆWhere/Select ç­‰ï¼‰ï¼Œæ¯ä¸ªæ–¹æ³•æ¥æ”¶ Lambda ä½œä¸º â€œæŸ¥è¯¢è§„åˆ™â€ï¼Œå®ç°æ•°æ®çš„ç­›é€‰ / è½¬æ¢ / æŸ¥æ‰¾</strong>ã€‚</li>
</ul>
<h3 data-id="heading-4">äºŒã€æ‰‹æ“æ ¸å¿ƒ LINQ æ–¹æ³•ï¼ˆæ‰©å±•æ–¹æ³• + Lambdaï¼‰</h3>
<h4 data-id="heading-5">èƒŒæ™¯äº‹ä»¶ï¼šæ–°æ‰‹çš„ç—›ç‚¹ â€”â€” é‡å¤å†™å¾ªç¯å¤ªå†—ä½™</h4>
<p>ä½ å¤„ç†è®¢å•æ•°æ®æ—¶ï¼Œéœ€è¦é¢‘ç¹åš 3 ä»¶äº‹ï¼š</p>
<ol>
<li>ç­›é€‰ç¬¦åˆæ¡ä»¶çš„è®¢å•ï¼ˆæ¯”å¦‚é‡‘é¢ &gt; 1000ï¼‰ï¼›</li>
<li>è½¬æ¢è®¢å•æ•°æ®æ ¼å¼ï¼ˆæ¯”å¦‚åªä¿ç•™ ID å’Œå®¢æˆ·åï¼‰ï¼›</li>
<li>æŸ¥æ‰¾ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„è®¢å•ï¼ˆæ¯”å¦‚æ‰¾æå››çš„è®¢å•ï¼‰ï¼›</li>
</ol>
<p>æ¯æ¬¡éƒ½å†™<code>foreach</code>å¾ªç¯ä¼šéå¸¸å†—ä½™ï¼Œæˆ‘ä»¬ç”¨<strong>æ‰©å±•æ–¹æ³• + Lambda</strong>æ‰‹åŠ¨å®ç°è¿™ 3 ä¸ªæ ¸å¿ƒ LINQ æ–¹æ³•ï¼Œç†è§£ LINQ çš„åº•å±‚é€»è¾‘ã€‚</p>
<h4 data-id="heading-6">æ­¥éª¤ 1ï¼šå®šä¹‰åŸºç¡€å®ä½“å’Œæ•°æ®æº</h4>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;

<span class="hljs-comment">// è®¢å•å®ä½“ï¼ˆæ–°æ‰‹èƒ½ç†è§£çš„ç®€å•ç±»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> OrderId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Amount { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// å­˜æ”¾è‡ªå®šä¹‰LINQæ‰©å±•æ–¹æ³•çš„é™æ€ç±»ï¼ˆå¿…é¡»é™æ€ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-comment">// åç»­æ‰‹åŠ¨å®ç°Where/Select/FirstOrDefaultæ–¹æ³•</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•æ•°æ®æº</span>
        List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> List&lt;Order&gt;
        {
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">1</span>, Amount = <span class="hljs-number">800</span>, Customer = <span class="hljs-string">"å¼ ä¸‰"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">2</span>, Amount = <span class="hljs-number">1200</span>, Customer = <span class="hljs-string">"æå››"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">3</span>, Amount = <span class="hljs-number">1500</span>, Customer = <span class="hljs-string">"ç‹äº”"</span> }
        };

        <span class="hljs-comment">// åç»­è°ƒç”¨è‡ªå®šä¹‰LINQæ–¹æ³•</span>
    }
}
</code></pre>
<h4 data-id="heading-7">æ­¥éª¤ 2ï¼šæ‰‹åŠ¨å®ç° Where æ–¹æ³•ï¼ˆç­›é€‰æ•°æ®ï¼‰</h4>
<p>è¿™é‡Œæˆ‘å°†å¸¦ç€å¤§å®¶ä»1.0ç‰ˆæœ¬æ‰‹æ“<code>Where</code>æ–¹æ³•ç›´åˆ°æœ€ç»ˆç‰ˆæœ¬ï¼Œä½†æ˜¯åé¢çš„<code>Select</code>å’Œ<code>FirstOrDefault</code>å°±ä¸å¸¦ç€å¤§å®¶ä»é›¶æ‰‹æ“äº†ï¼Œå¸Œæœ›å¤§å®¶æ…¢æ…¢é˜…è¯»ã€‚</p>
<h5 data-id="heading-8">1.0 ç‰ˆæœ¬(ä¸èƒ½çµæ´»é€‰æ‹©ç­›é€‰é€»è¾‘ï¼Œä¸èƒ½é€‰æ‹©ä¼ å…¥çš„å‚æ•°ç±»å‹)</h5>
<p><strong>æ ¸å¿ƒMyWhereæ–¹æ³•</strong>ï¼šä¼ å…¥ä¸€ä¸ª<code>List&lt;Order&gt;</code>é›†åˆï¼Œè·å¾—ä¸€ä¸ª<code>List&lt;Order&gt;</code>é›†åˆï¼Œæ–¹æ³•åœ¨å‡½æ•°å†…éƒ¨å®ç°</p>
<pre><code class="hljs language-cs" lang="cs">    <span class="hljs-comment">// 1.0ç‰ˆæœ¬</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Order&gt; <span class="hljs-title">MyWhere</span>(<span class="hljs-params">List&lt;Order&gt; list</span>)</span>
    {
        List&lt;Order&gt; newList = <span class="hljs-keyword">new</span> List&lt;Order&gt;();
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (order.Amount &gt; <span class="hljs-number">1000</span>)
            {
                newList.Add(order);
            }
        }
        <span class="hljs-keyword">return</span> newList;
    }
</code></pre>
<p><strong>å®Œæ•´ä»£ç ä¸ç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;

<span class="hljs-comment">// è®¢å•å®ä½“ï¼ˆæ–°æ‰‹èƒ½ç†è§£çš„ç®€å•ç±»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> OrderId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Amount { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// å­˜æ”¾è‡ªå®šä¹‰LINQæ‰©å±•æ–¹æ³•çš„é™æ€ç±»ï¼ˆå¿…é¡»é™æ€ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-comment">// 1.0ç‰ˆæœ¬</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Order&gt; <span class="hljs-title">MyWhere</span>(<span class="hljs-params">List&lt;Order&gt; list</span>)</span>
    {
        List&lt;Order&gt; newList = <span class="hljs-keyword">new</span> List&lt;Order&gt;();
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (order.Amount&gt;<span class="hljs-number">1000</span>)
            {
                newList.Add(order);
            }
        }
        <span class="hljs-keyword">return</span> newList;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•æ•°æ®æº</span>
        List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> List&lt;Order&gt;
        {
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">1</span>, Amount = <span class="hljs-number">800</span>, Customer = <span class="hljs-string">"å¼ ä¸‰"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">2</span>, Amount = <span class="hljs-number">1200</span>, Customer = <span class="hljs-string">"æå››"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">3</span>, Amount = <span class="hljs-number">1500</span>, Customer = <span class="hljs-string">"ç‹äº”"</span> }
        };

        <span class="hljs-keyword">var</span> myNewList = MyLinqExtensions.MyWhere(orders);
        Console.WriteLine(<span class="hljs-string">"ç­›é€‰å¤§äº1000çš„ç”¨æˆ·ï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> myNewList)
        {
            Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{order.Customer}</span>çš„èµ„äº§æ˜¯ï¼š<span class="hljs-subst">{order.Amount}</span>"</span>);
        }
    }
}
</code></pre>
<p><strong>è¿è¡Œç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-cs" lang="cs">ç­›é€‰å¤§äº<span class="hljs-number">1000</span>çš„ç”¨æˆ·ï¼š
æå››çš„èµ„äº§æ˜¯ï¼š<span class="hljs-number">1200</span>
ç‹äº”çš„èµ„äº§æ˜¯ï¼š<span class="hljs-number">1500</span>
</code></pre>
<p><strong>æ§½ç‚¹</strong>ï¼šè™½ç„¶æˆ‘ä»¬å®ç°äº†ç­›é€‰å‡ºèµ„äº§å¤§äº1000ç”¨æˆ·çš„åŠŸèƒ½äº†ï¼Œä½†æ˜¯è¿™ä¸ªç­›é€‰é€»è¾‘æ˜¯å†™åœ¨æ–¹æ³•<code>MyWhere</code>å†…éƒ¨çš„ï¼Œå¦‚æœé€‰æ‹©ä¸æƒ³ç­›é€‰å­˜æ¬¾å¤§äº1000çš„<code>List&lt;Order&gt;</code>ï¼Œè€Œæ˜¯æƒ³ç­›é€‰å‡ºç”¨æˆ·Idå¤§äº2çš„é›†åˆ<code>List&lt;Order&gt;</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è¿›å…¥<code>MyWhere</code>å‡½æ•°å†…éƒ¨ä¿®æ”¹ä»£ç ï¼Œéå¸¸çš„éº»çƒ¦ï¼Œå¤ç”¨ç‡å¾ˆä½ã€‚</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// å°†ç­›é€‰é€»è¾‘æ˜¯å­˜æ¬¾å¤§äº1000ï¼Œæ”¹æˆidå¤§äº2ï¼š</span>
<span class="hljs-comment">// if (order.Amount &gt; 1000) </span>
<span class="hljs-keyword">if</span> (order.OrderId &gt; <span class="hljs-number">2</span>)
{
    newList.Add(order);
}
</code></pre>
<p>ä½ çœ‹ï¼Œæ¯æ¬¡æˆ‘ä»¬æƒ³è¦ä¿®æ”¹ç­›é€‰é€»è¾‘ï¼Œéƒ½è¦è¿›å»ä»£ç å†…éƒ¨åšå‡ºç›¸åº”çš„ä¿®æ”¹ï¼Œéå¸¸éº»çƒ¦ã€‚é‚£æˆ‘ä»¬å†èšç„¦åˆ°è¿™ä¸ªç­›é€‰é€»è¾‘ä¸Šã€‚è¿™ä¸ªç­›é€‰é€»è¾‘å…¶å®å°±æ˜¯å®ç°äº†è¿™æ ·çš„åŠŸèƒ½ï¼š<strong>å¦‚æœorderå¯¹è±¡çš„æŸäº›å±æ€§ï¼Œç¬¦åˆæŸäº›ç‰¹å¾ï¼Œå°±æ‰§è¡Œä¸‹é¢çš„æ·»åŠ æ“ä½œ</strong>ï¼Œæ¯”å¦‚</p>
<ul>
<li><strong>æŸä¸ªorderçš„å­˜æ¬¾å¤§äº1000ä¸ºçœŸï¼Œå°±å°†è¿™ä¸ªorderæ·»åŠ åˆ°æ–°çš„listé›†åˆä¸­</strong></li>
<li><strong>æŸä¸ªorderçš„idå¤§äº2ä¸ºçœŸï¼Œå°±å°†è¿™ä¸ªorderæ·»åŠ åˆ°æ–°çš„listé›†åˆä¸­</strong></li>
</ul>
<p>é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½æŠŠ<strong>æŸä¸ªorderçš„æŸä¸ªå±æ€§ä¸ºçœŸ</strong>è¿™ä¸ªé€»è¾‘å°è£…æˆä¸€ä¸ªæ–¹æ³•å‘¢ï¼Œæ¯”å¦‚æˆ‘ä¼ é€’è¿›å»ä¸€ä¸ª<code>order</code>ï¼Œå®ƒè‡ªåŠ¨å¸®æˆ‘åˆ¤æ–­å­˜æ¬¾æ˜¯ä¸æ˜¯å¤§äº1000ï¼Œç„¶åè¿”å›ä¸€ä¸ª<code>bool</code>å€¼ï¼Œä¸ºçœŸçš„è¯ï¼Œæˆ‘å°±å°†è¿™ä¸ªorderæ·»åŠ åˆ°æ–°çš„é›†åˆä¸­ã€‚</p>
<p>æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¤–éƒ¨å®šä¹‰è¿™æ ·çš„ä¸€ä¸ªå‡½æ•°ï¼š</p>
<pre><code class="hljs language-cs" lang="cs">    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsOver1000</span>(<span class="hljs-params">Order order</span>)</span>
    {
        <span class="hljs-keyword">return</span> order.Amount &gt; <span class="hljs-number">1000</span>;
    }
</code></pre>
<p>é‚£ä¹ˆï¼Œå¦‚ä½•æ¥æ”¶è¿™ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æˆ‘ä»¬çš„<code>MyWhere</code>å‡½æ•°ä¸­è°ƒç”¨å‘¢ï¼Ÿæ²¡é”™ï¼Œä½¿ç”¨å§”æ‰˜ï¼</p>
<h5 data-id="heading-9">2.0 ç‰ˆæœ¬(å¯ä»¥çµæ´»ä¼ é€’ç­›é€‰é€»è¾‘ï¼Œä¸èƒ½é€‰æ‹©ä¼ å…¥çš„å‚æ•°ç±»å‹)</h5>
<p>æˆ‘ä»¬æ¯æ¬¡è¦ä¿®æ”¹ç­›é€‰é€»è¾‘éƒ½è¦è¿›å»ä»£ç å†…éƒ¨ï¼Œé‚£èƒ½ä¸èƒ½å°†ç­›é€‰é€»è¾‘æ”¾åœ¨å¤–é¢ï¼Œé€šè¿‡å‚æ•°ä¼ è¿›æ¥å‘¢ï¼Ÿå·§äº†ï¼Œå§”æ‰˜ä¸å°±æ˜¯å¯ä»¥å°†å‡½æ•°å˜æˆå‚æ•°ä¼ é€’çš„ä¸€ç§æ–¹æ³•å—ï¼Ÿäºæ˜¯ï¼Œæˆ‘ä»¬å°†ç­›é€‰é€»è¾‘å˜æˆä¸€ä¸ªå‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ç±»å‹æ˜¯<code>Func&lt;Order,bool&gt;</code>çš„å§”æ‰˜ï¼Œè¿™ä¸ªå§”æ‰˜æ¥æ”¶çš„æ˜¯æ–¹æ³•ï¼Œä¸€ä¸ªå‚æ•°ä¸º<code>Order</code>ï¼Œè¿”å›<code>bool</code>çš„æ–¹æ³•ï¼Œè¿™ä¸å°±æ˜¯æˆ‘ä»¬ä¸Šé¢å®šä¹‰çš„<code>IsOver1000</code>æ–¹æ³•å—ï¼Ÿ</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// 2.0ç‰ˆæœ¬</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Order&gt; <span class="hljs-title">MyWhere</span>(<span class="hljs-params">List&lt;Order&gt; list,Func&lt;Order,<span class="hljs-built_in">bool</span>&gt; func</span>)</span>
    {
        List&lt;Order&gt; newList = <span class="hljs-keyword">new</span> List&lt;Order&gt;();
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (func(order))
            {
                newList.Add(order);
            }
        }
        <span class="hljs-keyword">return</span> newList;
    }
}
</code></pre>
<p><strong>å®Œæ•´ä»£ç ä¸è°ƒç”¨ç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;

<span class="hljs-comment">// è®¢å•å®ä½“ï¼ˆæ–°æ‰‹èƒ½ç†è§£çš„ç®€å•ç±»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> OrderId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Amount { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// å­˜æ”¾è‡ªå®šä¹‰LINQæ‰©å±•æ–¹æ³•çš„é™æ€ç±»ï¼ˆå¿…é¡»é™æ€ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-comment">// 2.0ç‰ˆæœ¬</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;Order&gt; <span class="hljs-title">MyWhere</span>(<span class="hljs-params">List&lt;Order&gt; list,Func&lt;Order,<span class="hljs-built_in">bool</span>&gt; func</span>)</span>
    {
        List&lt;Order&gt; newList = <span class="hljs-keyword">new</span> List&lt;Order&gt;();
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (func(order))
            {
                newList.Add(order);
            }
        }
        <span class="hljs-keyword">return</span> newList;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•æ•°æ®æº</span>
        List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> List&lt;Order&gt;
        {
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">1</span>, Amount = <span class="hljs-number">800</span>, Customer = <span class="hljs-string">"å¼ ä¸‰"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">2</span>, Amount = <span class="hljs-number">1200</span>, Customer = <span class="hljs-string">"æå››"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">3</span>, Amount = <span class="hljs-number">1500</span>, Customer = <span class="hljs-string">"ç‹äº”"</span> }
        };

        <span class="hljs-comment">// è·å–ç­›é€‰åçš„è®¢å•åˆ—è¡¨</span>
        <span class="hljs-keyword">var</span> myNewList = MyLinqExtensions.MyWhere(orders,IsOver1000);
        Console.WriteLine(<span class="hljs-string">"ç­›é€‰å¤§äº1000çš„ç”¨æˆ·ï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> myNewList)
        {
            Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{order.Customer}</span>çš„èµ„äº§æ˜¯ï¼š<span class="hljs-subst">{order.Amount}</span>"</span>);
        }
    }
    
    <span class="hljs-comment">// ç­›é€‰æ¡ä»¶å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªè®¢å•ï¼Œè‹¥è®¢å•èµ„äº§å¤§äº1000ï¼Œåˆ™è¿”å›trueï¼Œå†…éƒ¨æ–¹æ³•å°±ä¼šå°†è¿™ä¸ªè®¢å•åŠ å…¥åˆ°æ–°åˆ—è¡¨</span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsOver1000</span>(<span class="hljs-params">Order order</span>)</span>
    {
        <span class="hljs-keyword">return</span> order.Amount &gt; <span class="hljs-number">1000</span>;
    }
}
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs">ç­›é€‰å¤§äº1000çš„ç”¨æˆ·ï¼š
æå››çš„èµ„äº§æ˜¯ï¼š1200
ç‹äº”çš„èµ„äº§æ˜¯ï¼š1500
</code></pre>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæˆ‘ä»¬å°†ç­›é€‰é€»è¾‘æ”¾åˆ°å¤–é¢äº†ï¼Œå¦‚æœæƒ³è¦æ¢ä¸€ä¸ªç­›é€‰æ¡ä»¶ï¼Œæ¯”å¦‚è¦å°†idå¤§äº2çš„ç­›é€‰å‡ºæ¥ï¼Œé‚£å°±åªéœ€è¦ä¼ é€’ä¸åŒçš„æ–¹æ³•ç»™<code>MyWhere</code>æ–¹æ³•å°±è¡Œäº†ï¼Œé™ä½äº†è€¦åˆåº¦ã€‚æ³¨æ„ï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯ç”¨<strong>å§”æ‰˜æ¥æ”¶æ–¹æ³•</strong>ï¼Œå¤–éƒ¨å®šä¹‰çš„æ˜¯æ–¹æ³•ï¼Œä½†æ˜¯å‚æ•°æ˜¯ä¸€ä¸ªå§”æ‰˜ç±»å‹ï¼Œä¹Ÿå°±æ˜¯å°†å¤–éƒ¨çš„æ–¹æ³•æ”¾è¿›è¿™ä¸ªå§”æ‰˜å‚æ•°é‡Œã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šå¦‚æœæˆ‘ä»¬ç­›é€‰çš„ä¸æ˜¯<code>Orderé›†åˆ</code>ï¼Œè€Œæ˜¯ä¸€ä¸ª<code>Studenté›†åˆ</code>ï¼Œé‚£è¿™ä¸ªæ–¹æ³•å°±å¤±æ•ˆäº†ï¼Œæˆ‘ä»¬éœ€è¦å†åˆ›å»ºä¸€ä¸ª<code>Studenté›†åˆ</code>çš„<code>MyWhereæ–¹æ³•</code>ï¼Œæ˜¯ä¸æ˜¯éå¸¸éº»çƒ¦ï¼Œèƒ½ä¸èƒ½ä¼˜åŒ–ï¼Œè¿™æ ·è®©ä¸€ä¸ª<code>MyWhereæ–¹æ³•</code>æ¥æ”¶ä¸åŒç±»å‹çš„åŠŸèƒ½ï¼Œæ˜¯ä¸æ˜¯æƒ³åˆ°äº†æ³›å‹ï¼</p>
<h5 data-id="heading-10">3.0 ç‰ˆæœ¬(å¯ä»¥çµæ´»ä¼ é€’ç­›é€‰é€»è¾‘ï¼Œå¯ä»¥é€‰æ‹©ä¼ å…¥çš„å‚æ•°ç±»å‹)</h5>
<p>3.0ç‰ˆæœ¬æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªæ–°çš„<code>Student</code>ç±»ï¼Œå¹¶ä¸”ç”¨æ³›å‹ä¼˜åŒ–äº†<code>MyWhere</code>æ–¹æ³•</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> StudentName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentAge { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}
</code></pre>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// 3.0ç‰ˆæœ¬</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">MyWhere</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">List&lt;T&gt; list,Func&lt;T,<span class="hljs-built_in">bool</span>&gt; func</span>)</span>
    {
        List&lt;T&gt; newList = <span class="hljs-keyword">new</span> List&lt;T&gt;();
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (func(order))
            {
                newList.Add(order);
            }
        }
        <span class="hljs-keyword">return</span> newList;
    }
}
</code></pre>
<p>åŠ äº†æ³›å‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥éšæ„çš„å†å„ç§ç±»å‹çš„é›†åˆä¸Šä½¿ç”¨<code>MyWhereæ–¹æ³•</code>äº†:
<strong>å®Œæ•´ä»£ç ä¸è¿è¡Œç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;

<span class="hljs-comment">// è®¢å•å®ä½“ï¼ˆæ–°æ‰‹èƒ½ç†è§£çš„ç®€å•ç±»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> OrderId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Amount { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// å­¦ç”Ÿç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> StudentName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentAge { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// å­˜æ”¾è‡ªå®šä¹‰LINQæ‰©å±•æ–¹æ³•çš„é™æ€ç±»ï¼ˆå¿…é¡»é™æ€ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-comment">// 3.0ç‰ˆæœ¬ï¼ŒåŠ äº†æ³›å‹</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">MyWhere</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">List&lt;T&gt; list,Func&lt;T,<span class="hljs-built_in">bool</span>&gt; func</span>)</span>
    {
        List&lt;T&gt; newList = <span class="hljs-keyword">new</span> List&lt;T&gt;();
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (func(order))
            {
                newList.Add(order);
            }
        }
        <span class="hljs-keyword">return</span> newList;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•æ•°æ®æº</span>
        List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> List&lt;Order&gt;
        {
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">1</span>, Amount = <span class="hljs-number">800</span>, Customer = <span class="hljs-string">"å¼ ä¸‰"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">2</span>, Amount = <span class="hljs-number">1200</span>, Customer = <span class="hljs-string">"æå››"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">3</span>, Amount = <span class="hljs-number">1500</span>, Customer = <span class="hljs-string">"ç‹äº”"</span> }
        };
        List&lt;Student&gt; students = <span class="hljs-keyword">new</span> List&lt;Student&gt;()
        {
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">1</span>, StudentAge = <span class="hljs-number">10</span>, StudentName = <span class="hljs-string">"å°æ˜"</span> },
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">2</span>, StudentAge = <span class="hljs-number">11</span>, StudentName = <span class="hljs-string">"å°çº¢"</span> },
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">3</span>, StudentAge = <span class="hljs-number">12</span>, StudentName = <span class="hljs-string">"å°æ–‡"</span> }
        };
        
        <span class="hljs-comment">// è·å–ç­›é€‰åçš„è®¢å•åˆ—è¡¨</span>
        <span class="hljs-keyword">var</span> myNewList = MyLinqExtensions.MyWhere(orders,IsOver1000);
        Console.WriteLine(<span class="hljs-string">"ç­›é€‰å¤§äº1000çš„è®¢å•çš„ç”¨æˆ·ï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> myNewList)
        {
            Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{order.Customer}</span>çš„èµ„äº§æ˜¯ï¼š<span class="hljs-subst">{order.Amount}</span>"</span>);
        }
        
        <span class="hljs-comment">// è·å–ç­›é€‰åçš„å­¦ç”Ÿåˆ—è¡¨</span>
        <span class="hljs-keyword">var</span> myNewStudentList = MyLinqExtensions.MyWhere&lt;Student&gt;(students,IsOver10);
        Console.WriteLine(<span class="hljs-string">"ç­›é€‰å¹´é¾„å¤§äº10å²çš„å­¦ç”Ÿï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> student <span class="hljs-keyword">in</span> myNewStudentList)
        {
            Console.WriteLine(<span class="hljs-string">$"å­¦ç”Ÿåï¼š<span class="hljs-subst">{student.StudentName}</span>,å­¦ç”Ÿå¹´é¾„ï¼š<span class="hljs-subst">{student.StudentAge}</span>"</span>);
        }

    }

    <span class="hljs-comment">// ç­›é€‰æ¡ä»¶å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªè®¢å•ï¼Œè‹¥è®¢å•èµ„äº§å¤§äº1000ï¼Œåˆ™è¿”å›trueï¼Œå†…éƒ¨æ–¹æ³•å°±ä¼šå°†è¿™ä¸ªè®¢å•åŠ å…¥åˆ°æ–°åˆ—è¡¨</span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsOver1000</span>(<span class="hljs-params">Order order</span>)</span>
    {
        <span class="hljs-keyword">return</span> order.Amount &gt; <span class="hljs-number">1000</span>;
    }
    
    <span class="hljs-comment">// ç­›é€‰æ¡ä»¶å‡½æ•°ï¼Œä¼ å…¥ä¸€ä¸ªå­¦ç”Ÿï¼Œè‹¥å­¦ç”Ÿå¹´é¾„å¤§äº10ï¼Œåˆ™è¿”å›trueï¼Œå†…éƒ¨æ–¹æ³•å°±ä¼šå°†è¿™ä¸ªå­¦ç”ŸåŠ å…¥åˆ°æ–°åˆ—è¡¨</span>
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">IsOver10</span>(<span class="hljs-params">Student student</span>)</span>
    {
        <span class="hljs-keyword">return</span> student.StudentAge &gt; <span class="hljs-number">10</span>;
    }
}
</code></pre>
<p><strong>è¿è¡Œç»“æœ</strong>ï¼š</p>
<pre><code class="hljs language-cs" lang="cs">ç­›é€‰å¤§äº<span class="hljs-number">1000</span>çš„è®¢å•çš„ç”¨æˆ·ï¼š
æå››çš„èµ„äº§æ˜¯ï¼š<span class="hljs-number">1200</span>
ç‹äº”çš„èµ„äº§æ˜¯ï¼š<span class="hljs-number">1500</span>
ç­›é€‰å¹´é¾„å¤§äº<span class="hljs-number">10</span>å²çš„å­¦ç”Ÿï¼š
å­¦ç”Ÿåï¼šå°çº¢,å­¦ç”Ÿå¹´é¾„ï¼š<span class="hljs-number">11</span>
å­¦ç”Ÿåï¼šå°æ–‡,å­¦ç”Ÿå¹´é¾„ï¼š<span class="hljs-number">12</span>
</code></pre>
<p>ç»†å¿ƒçš„åŒå­¦å‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ˜æ˜æˆ‘ä»¬å®šä¹‰çš„<code>MyWhere</code>æ˜¯æ³›å‹æ–¹æ³•ï¼ŒæŒ‰é“ç†æ¥è¯´ç”¨<code>MyLinqExtensions.MyWhere&lt;Student&gt;(students,IsOver10);</code>è¿™æ ·çš„å¸¦å°–æ‹¬å·çš„è°ƒç”¨æ‰æ˜¯æ­£ç¡®çš„ï¼Œä¸ºä»€ä¹ˆ<code>MyLinqExtensions.MyWhere(orders,IsOver1000);</code>è¿™æ ·ä¸ç”¨å°–æ‹¬å·è°ƒç”¨ä¹Ÿè¡Œå‘¢ï¼Ÿ</p>
<p>åŸå› çš„<code>MyWhere</code>æ–¹æ³•ä¼ é€’çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>List&lt;T&gt;</code>ç±»å‹çš„é›†åˆï¼Œåªè¦ä¼ é€’äº†ä¸€ä¸ªç±»å‹é›†åˆçš„å‚æ•°ï¼Œ<code>MyWhere</code>æ–¹æ³•å°±çŸ¥é“äº†å‚æ•°ç±»å‹æ˜¯ä»€ä¹ˆï¼Œä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä¼ é€’äº†ä¸€ä¸ªè®¢å•åˆ—è¡¨<code>List&lt;Order&gt;</code>ç±»å‹çš„<code>orders</code>ï¼Œé‚£ä¹ˆ<code>MyWhere</code>æ–¹æ³•å°±çŸ¥é“äº†å®ƒçš„å‚æ•°ç±»å‹æ˜¯<code>Order</code>ï¼Œå³<code>MyWhere&lt;Order&gt;</code>ï¼Œè¿™ä¸ªåé¢çš„å°–æ‹¬å·å¯ä»¥çœç•¥ï¼Œå› ä¸ºå‚æ•°éƒ¨åˆ†å·²ç»æ˜ç¡®ç»™å‡ºäº†å‚æ•°<code>T</code>çš„ç±»å‹ã€‚æ‰€ä»¥<code>MyLinqExtensions.MyWhere(orders,IsOver1000);</code>å¯ä»¥æ­£å¸¸è°ƒç”¨ã€‚</p>
<p><strong>å¯æ”¹è¿›ç‚¹</strong>ï¼š</p>
<ul>
<li>åˆ©ç”¨æ‹“å±•æ–¹æ³•å°†<code>MyLinqExtensions.MyWhere(orders,IsOver1000);</code>è¿™ä¸ªå¼å­ç®€åŒ–</li>
<li>åˆ©ç”¨<code>Lambda</code>è¡¨è¾¾å¼ï¼Œå°†è¦ä¼ é€’çš„ç­›é€‰æ–¹æ³•<code>IsOver1000</code>ç­‰ç®€åŒ–</li>
</ul>
<p>ä¸çŸ¥é“è¿™ä¸¤ä¸ªçŸ¥è¯†ç‚¹çš„åŒå­¦å¯ä»¥çœ‹æˆ‘ä¸Šä¸€ç¯‡æ–‡ç« ï¼š<a href="https://juejin.cn/post/7583293030172639278" target="_blank" title="https://juejin.cn/post/7583293030172639278">.NETè¿›é˜¶â€”â€”æ·±å…¥ç†è§£Lambdaè¡¨è¾¾å¼ï¼ˆ1ï¼‰Lambdaå…¥é—¨ä¸€ã€Lambda è¡¨è¾¾å¼çš„æ¼”å˜å²ï¼šä» â€œç¹â€ åˆ° â€œç®€â€ - æ˜é‡‘</a></p>
<h5 data-id="heading-11">4.0 ç‰ˆæœ¬(åˆ©ç”¨æ‹“å±•æ–¹æ³•å’ŒLambdaè¡¨è¾¾å¼ç®€åŒ–ä»£ç )</h5>
<p>è¿˜è®°å¾—æ‹“å±•æ–¹æ³•çš„è¦ç‚¹å—ï¼Ÿ<strong>é™æ€ç±»+é™æ€æ–¹æ³•+thiså…³é”®å­—</strong>ï¼Œæˆ‘ä»¬æ¥æ”¹é€ ä»¥ä¸‹<code>MyWhere</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-comment">// 4.0ç‰ˆæœ¬ï¼šå› ä¸ºæœ¬æ¥å°±æ˜¯é™æ€ç±»é™æ€æ–¹æ³•ï¼Œæ‰€ä»¥è¿™é‡Œåªéœ€è¦åŠ ä¸€ä¸ªthiså…³é”®å­—</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">MyWhere</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> List&lt;T&gt; list,Func&lt;T,<span class="hljs-built_in">bool</span>&gt; func</span>)</span>
    {
        List&lt;T&gt; newList = <span class="hljs-keyword">new</span> List&lt;T&gt;();
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (func(order))
            {
                newList.Add(order);
            }
        }
        <span class="hljs-keyword">return</span> newList;
    }
}
</code></pre>
<p>æ”¹é€ å®Œæˆåï¼Œå°±å¯ä»¥è¿™æ ·è°ƒç”¨äº†ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">var</span> myNewList = orders.MyWhere(IsOver1000);
<span class="hljs-keyword">var</span> myNewStudentList = students.MyWhere(IsOver10);
</code></pre>
<p>ç„¶åæˆ‘ä»¬è¿›ä¸€æ­¥æ”¹é€ ï¼Œè¿˜è®°å¾—<code>Lambda</code>è¡¨è¾¾å¼å—ï¼Ÿæœ¬è´¨å°±æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°å¯¹ä¸å¯¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†<code>IsOver1000</code>å’Œ<code>IsOver10</code>æ”¹é€ ä¸€ä¸‹ï¼Œè®©ä»–ä¸è¦ä¼ é€’å‡½æ•°åï¼Œç›´æ¥å°†åŒ¿åå‡½æ•°ä¼ é€’è¿›å»ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">var</span> myNewList = orders.MyWhere(p=&gt;p.Amount&gt;<span class="hljs-number">1000</span>);
<span class="hljs-keyword">var</span> myNewStudentList = students.MyWhere(q=&gt;q.StudentAge&gt;<span class="hljs-number">10</span>);
</code></pre>
<p>ä¸ºä»€ä¹ˆè¿™é‡Œå¯ä»¥ç”¨<code>p``q</code>å‘¢ï¼Ÿ<code>p``q</code>æ˜¯å•¥ï¼Ÿ</p>
<p>ç”±äºæˆ‘ä»¬çš„<code>MyWhere</code>æ–¹æ³•æ¥æ”¶çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå§”æ‰˜ï¼Œä»–æ¥å—ä¸€ä¸ªæ³›å‹æ–¹æ³•ï¼Œç”±äºæˆ‘ä»¬å‰é¢å·²ç»é€šè¿‡ç¬¬ä¸€ä¸ªå‚æ•°çŸ¥é“äº†ç±»å‹<code>T</code>æ˜¯ä»€ä¹ˆï¼Œå‡å¦‚è¿™é‡Œç±»å‹<code>T</code>æ˜¯Studentï¼Œé‚£ä¹ˆè¿™é‡Œè¦æ¥æ”¶çš„æ–¹æ³•å°±æ˜¯ï¼š<strong>æ¥æ”¶ä¸€ä¸ª<code>Student</code>ç±»å‹çš„å®ä¾‹pï¼Œå¦‚æœpçš„å¹´é¾„å¤§äº10å²ï¼Œå°±è¿”å›çœŸ</strong>ã€‚
<strong>å®Œæ•´ä»£ç å’Œè¾“å‡ºç»“æœï¼š</strong></p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;

<span class="hljs-comment">// è®¢å•å®ä½“ï¼ˆæ–°æ‰‹èƒ½ç†è§£çš„ç®€å•ç±»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> OrderId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Amount { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> StudentName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentAge { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// å­˜æ”¾è‡ªå®šä¹‰LINQæ‰©å±•æ–¹æ³•çš„é™æ€ç±»ï¼ˆå¿…é¡»é™æ€ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-comment">// 4.0ç‰ˆæœ¬:åŠ å…¥æ‹“å±•æ–¹æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">List</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">MyWhere</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> List&lt;T&gt; list,Func&lt;T,<span class="hljs-built_in">bool</span>&gt; func</span>)</span>
    {
        List&lt;T&gt; newList = <span class="hljs-keyword">new</span> List&lt;T&gt;();
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (func(order))
            {
                newList.Add(order);
            }
        }
        <span class="hljs-keyword">return</span> newList;
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•æ•°æ®æº</span>
        List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> List&lt;Order&gt;
        {
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">1</span>, Amount = <span class="hljs-number">800</span>, Customer = <span class="hljs-string">"å¼ ä¸‰"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">2</span>, Amount = <span class="hljs-number">1200</span>, Customer = <span class="hljs-string">"æå››"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">3</span>, Amount = <span class="hljs-number">1500</span>, Customer = <span class="hljs-string">"ç‹äº”"</span> }
        };
        List&lt;Student&gt; students = <span class="hljs-keyword">new</span> List&lt;Student&gt;()
        {
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">1</span>, StudentAge = <span class="hljs-number">10</span>, StudentName = <span class="hljs-string">"å°æ˜"</span> },
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">2</span>, StudentAge = <span class="hljs-number">11</span>, StudentName = <span class="hljs-string">"å°çº¢"</span> },
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">3</span>, StudentAge = <span class="hljs-number">12</span>, StudentName = <span class="hljs-string">"å°æ–‡"</span> }
        };

        <span class="hljs-keyword">var</span> myNewList = orders.MyWhere(p=&gt;p.Amount&gt;<span class="hljs-number">1000</span>);
        <span class="hljs-keyword">var</span> myNewStudentList = students.MyWhere(q=&gt;q.StudentAge&gt;<span class="hljs-number">10</span>);
        
       Console.WriteLine(<span class="hljs-string">"ç­›é€‰å¤§äº1000çš„è®¢å•çš„ç”¨æˆ·ï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> myNewList)
        {
            Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{order.Customer}</span>çš„èµ„äº§æ˜¯ï¼š<span class="hljs-subst">{order.Amount}</span>"</span>);
        }
        
        Console.WriteLine(<span class="hljs-string">"ç­›é€‰å¹´é¾„å¤§äº10å²çš„å­¦ç”Ÿï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> student <span class="hljs-keyword">in</span> myNewStudentList)
        {
            Console.WriteLine(<span class="hljs-string">$"å­¦ç”Ÿåï¼š<span class="hljs-subst">{student.StudentName}</span>,å­¦ç”Ÿå¹´é¾„ï¼š<span class="hljs-subst">{student.StudentAge}</span>"</span>);
        }

    }
}
</code></pre>
<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>
<pre><code class="hljs language-cs" lang="cs">ç­›é€‰å¤§äº<span class="hljs-number">1000</span>çš„è®¢å•çš„ç”¨æˆ·ï¼š
æå››çš„èµ„äº§æ˜¯ï¼š<span class="hljs-number">1200</span>
ç‹äº”çš„èµ„äº§æ˜¯ï¼š<span class="hljs-number">1500</span>
ç­›é€‰å¹´é¾„å¤§äº<span class="hljs-number">10</span>å²çš„å­¦ç”Ÿï¼š
å­¦ç”Ÿåï¼šå°çº¢,å­¦ç”Ÿå¹´é¾„ï¼š<span class="hljs-number">11</span>
å­¦ç”Ÿåï¼šå°æ–‡,å­¦ç”Ÿå¹´é¾„ï¼š<span class="hljs-number">12</span>
</code></pre>
<h5 data-id="heading-12">5.0 ç‰ˆæœ¬(æœ€ç»ˆç‰ˆ)</h5>
<p>æ²¡æƒ³åˆ°å§ï¼Œè¿˜å¯ä»¥ä¼˜åŒ–ï¼Œç°åœ¨è¿˜æ˜¯æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>ç°åœ¨åªèƒ½ç”¨åœ¨<code>List</code>é›†åˆä¸Šï¼Œå› ä¸ºå®šä¹‰çš„æ˜¯<code>List&lt;T&gt;</code>ï¼Œå¦‚æœè¦ç”¨åœ¨æ•°ç»„<code>Array</code>æˆ–è€…å“ˆå¸Œé›†åˆ<code>HashSet&lt;T&gt;</code>ä¸Šå°±æ²¡åŠæ³•äº†ã€‚</li>
<li>å‡½æ•°å†…éƒ¨çš„<code>foreach</code>å¾ªç¯ç»“æŸå†è¿”å›ï¼Œå¦‚æœé›†åˆæ•°é‡å¾ˆå¤§ï¼Œä¼šåœ¨<code>MyWhere</code>æ–¹æ³•å†…éƒ¨å¾ªç¯å¾ˆä¹…ï¼Œä½“éªŒéå¸¸ä¸å¥½ã€‚</li>
</ul>
<p>æ”¹é€ åï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-comment">// æ‰©å±•IEnumerable&lt;T&gt;ï¼Œè€ŒéList&lt;T&gt;</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">MyWhere</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> IEnumerable&lt;T&gt; source, Func&lt;T, <span class="hljs-built_in">bool</span>&gt; func</span>)</span>
    {
        <span class="hljs-comment">// ä¸å†æå‰new List&lt;T&gt;ï¼Œè€Œæ˜¯ç”¨yield returnå®ç°â€œå»¶è¿Ÿæ‰§è¡Œâ€</span>
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> source)
        {
            <span class="hljs-keyword">if</span> (func(item))
            {
                <span class="hljs-comment">// æ¯æ¬¡éå†æ‰è¿”å›ä¸€ä¸ªå…ƒç´ ï¼Œè€Œéä¸€æ¬¡æ€§åˆ›å»ºæ•´ä¸ªé›†åˆ</span>
                <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> item;
            }
        }
    }
</code></pre>
<h6 data-id="heading-13">å¥½å¤„ 1ï¼šé€šç”¨æ€§æ‹‰æ»¡ â€”â€” é€‚é…æ‰€æœ‰å¯éå†é›†åˆï¼ˆæœ€ç›´è§‚çš„å¥½å¤„ï¼‰</h6>
<p>ä½ çš„<code>List&lt;T&gt;</code>ç‰ˆæœ¬çš„<code>MyWhere</code>æœ‰ä¸ªè‡´å‘½é™åˆ¶ï¼š<strong>åªèƒ½ç»™ List ç”¨</strong>ï¼Œå¦‚æœæƒ³ç­›é€‰æ•°ç»„ã€HashSetï¼Œå°±ä¼šç¼–è¯‘æŠ¥é”™ï¼›è€Œ<code>IEnumerable&lt;T&gt;</code>ç‰ˆæœ¬èƒ½é€‚é…æ‰€æœ‰å®ç°è¯¥æ¥å£çš„é›†åˆã€‚</p>
<h6 data-id="heading-14">å¥½å¤„ 2ï¼šæ”¯æŒå»¶è¿Ÿæ‰§è¡Œï¼ˆæ‡’åŠ è½½ï¼‰â€”â€” å¤§å¹…æå‡æ€§èƒ½ / èŠ‚çœå†…å­˜</h6>
<p>è¿™æ˜¯<code>IEnumerable&lt;T&gt;</code>æœ€æ ¸å¿ƒçš„ä¼˜åŠ¿ï¼Œä¹Ÿæ˜¯ LINQ çš„ â€œçµé­‚ç‰¹æ€§â€ï¼š</p>
<ul>
<li>ä½ çš„<code>List&lt;T&gt;</code>ç‰ˆæœ¬ï¼šè°ƒç”¨<code>MyWhere</code>æ—¶ï¼Œä¼šç«‹å³éå†åŸé›†åˆï¼Œåˆ›å»ºæ–°çš„<code>List&lt;T&gt;</code>å¹¶å¡«å……æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼ˆ<strong>ç«‹å³æ‰§è¡Œ</strong>ï¼‰ï¼›</li>
<li><code>IEnumerable&lt;T&gt;</code>ç‰ˆæœ¬ï¼šè°ƒç”¨<code>MyWhere</code>æ—¶ï¼Œ<strong>ä¸ä¼šæ‰§è¡Œä»»ä½•éå† / ç­›é€‰é€»è¾‘</strong>ï¼Œç›´åˆ°ä½ ç”¨<code>foreach</code>éå†ç»“æœã€è°ƒç”¨<code>ToList()</code>/<code>ToArray()</code>æ—¶ï¼Œæ‰ä¼šé€ä¸ªéå†å…ƒç´ å¹¶ç­›é€‰ï¼ˆ<strong>å»¶è¿Ÿæ‰§è¡Œ</strong>ï¼‰</li>
</ul>
<h4 data-id="heading-15">å¥½å¤„ 3ï¼šç¬¦åˆ â€œé¢å‘æŠ½è±¡ç¼–ç¨‹â€â€”â€” ä»£ç æ›´çµæ´»ã€æ˜“æ‰©å±•</h4>
<p>è½¯ä»¶å¼€å‘çš„æ ¸å¿ƒåŸåˆ™ä¹‹ä¸€æ˜¯ â€œ<strong>ä¾èµ–æŠ½è±¡ï¼Œè€Œéå…·ä½“å®ç°</strong>â€ï¼š</p>
<ul>
<li><code>List&lt;T&gt;</code>æ˜¯ â€œå…·ä½“å®ç°â€ï¼ˆæ¯”å¦‚å®ƒæœ‰ Addã€Removeã€Sort ç­‰ç‰¹æœ‰æ–¹æ³•ï¼‰ï¼›</li>
<li><code>IEnumerable&lt;T&gt;</code>æ˜¯ â€œæŠ½è±¡æ¥å£â€ï¼ˆåªå®šä¹‰äº† â€œèƒ½éå†â€ è¿™ä¸€ä¸ªæ ¸å¿ƒèƒ½åŠ›ï¼‰ã€‚</li>
</ul>
<h4 data-id="heading-16">å¥½å¤„ 4ï¼šæ”¯æŒé“¾å¼è°ƒç”¨çš„æµå¼å¤„ç†</h4>
<p><code>IEnumerable&lt;T&gt;</code>çš„å»¶è¿Ÿæ‰§è¡Œç‰¹æ€§ï¼Œè®© LINQ çš„é“¾å¼è°ƒç”¨ï¼ˆ<code>.Where().Select().OrderBy()</code>ï¼‰å˜æˆ â€œæµå¼å¤„ç†â€ï¼š</p>
<ul>
<li>æ¯ä¸ªæ­¥éª¤éƒ½ä¸åˆ›å»ºä¸­é—´é›†åˆï¼Œè€Œæ˜¯åœ¨éå†æœ€ç»ˆç»“æœæ—¶ï¼Œä¸€æ¬¡æ€§å®Œæˆæ‰€æœ‰æ­¥éª¤ï¼ˆæ¯”å¦‚å…ˆç­›é€‰ã€å†è½¬æ¢ã€å†æ’åºï¼Œåªéå†ä¸€æ¬¡é›†åˆï¼‰ï¼›</li>
<li>è€Œä½ çš„<code>List&lt;T&gt;</code>ç‰ˆæœ¬ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡<code>MyWhere</code>å°±åˆ›å»ºä¸€ä¸ªæ–° Listï¼Œé“¾å¼è°ƒç”¨ä¼šäº§ç”Ÿå¤šä¸ªä¸­é—´é›†åˆï¼ˆæ¯”å¦‚<code>.MyWhere().MySelect()</code>ä¼šåˆ›å»º 2 ä¸ª Listï¼‰ï¼Œå†…å­˜å¼€é”€å¤§ã€‚</li>
</ul>
<p><strong>æ ¸å¿ƒè§£æ</strong>ï¼š</p>
<ul>
<li><code>MyWhere</code>æ˜¯æ‰©å±•æ–¹æ³•ï¼Œ<code>this List&lt;T&gt; source</code>è¡¨ç¤ºç»™æ‰€æœ‰<code>List&lt;T&gt;</code>æ‰©å±•è¿™ä¸ªæ–¹æ³•ï¼ˆæ³›å‹é€‚é…ä»»æ„é›†åˆï¼‰ï¼›</li>
<li><code>Func&lt;T, bool&gt; predicate</code>æ˜¯ Lambda çš„ â€œå®¹å™¨â€ï¼Œ<code>o =&gt; o.Amount &gt; 1000</code>å°±æ˜¯ä¼ å…¥çš„ç­›é€‰è§„åˆ™ï¼›</li>
<li>åº•å±‚é€»è¾‘å°±æ˜¯ foreach å¾ªç¯ï¼Œè°ƒç”¨ Lambda åˆ¤æ–­æ¯ä¸ªå…ƒç´ æ˜¯å¦ç¬¦åˆè§„åˆ™ï¼Œç¬¦åˆå°±åŠ å…¥ç»“æœåˆ—è¡¨ â€”â€” è¿™å°±æ˜¯åŸç”Ÿ LINQ Where çš„æ ¸å¿ƒé€»è¾‘ã€‚</li>
</ul>
<p><strong>5.0ç‰ˆæœ¬ï¼šæœ€ç»ˆç‰ˆæœ¬ä»£ç ä¸ç»“æœï¼š</strong></p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;

<span class="hljs-comment">// è®¢å•å®ä½“ï¼ˆæ–°æ‰‹èƒ½ç†è§£çš„ç®€å•ç±»ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> OrderId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Amount { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> StudentName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentAge { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// å­˜æ”¾è‡ªå®šä¹‰LINQæ‰©å±•æ–¹æ³•çš„é™æ€ç±»ï¼ˆå¿…é¡»é™æ€ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-comment">// 5.0ç‰ˆæœ¬</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">MyWhere</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> IEnumerable&lt;T&gt; list,Func&lt;T,<span class="hljs-built_in">bool</span>&gt; func</span>)</span>
    {
        <span class="hljs-keyword">if</span> (source == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(source));
        <span class="hljs-keyword">if</span> (selector == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(selector));
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> list)
        {
            <span class="hljs-keyword">if</span> (func(order))
            {
                <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> order;
            }
        }
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿè®¢å•æ•°æ®æº</span>
        List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> List&lt;Order&gt;
        {
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">1</span>, Amount = <span class="hljs-number">800</span>, Customer = <span class="hljs-string">"å¼ ä¸‰"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">2</span>, Amount = <span class="hljs-number">1200</span>, Customer = <span class="hljs-string">"æå››"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">3</span>, Amount = <span class="hljs-number">1500</span>, Customer = <span class="hljs-string">"ç‹äº”"</span> }
        };
        List&lt;Student&gt; students = <span class="hljs-keyword">new</span> List&lt;Student&gt;()
        {
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">1</span>, StudentAge = <span class="hljs-number">10</span>, StudentName = <span class="hljs-string">"å°æ˜"</span> },
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">2</span>, StudentAge = <span class="hljs-number">11</span>, StudentName = <span class="hljs-string">"å°çº¢"</span> },
            <span class="hljs-keyword">new</span> Student() { StudentId = <span class="hljs-number">3</span>, StudentAge = <span class="hljs-number">12</span>, StudentName = <span class="hljs-string">"å°æ–‡"</span> }
        };

        <span class="hljs-keyword">var</span> myNewList = orders.MyWhere(p=&gt;p.Amount&gt;<span class="hljs-number">1000</span>);
        Console.WriteLine(<span class="hljs-string">"ç­›é€‰å¤§äº1000çš„è®¢å•çš„ç”¨æˆ·ï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> order <span class="hljs-keyword">in</span> myNewList)
        {
            Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{order.Customer}</span>çš„èµ„äº§æ˜¯ï¼š<span class="hljs-subst">{order.Amount}</span>"</span>);
        }

        <span class="hljs-keyword">var</span> myNewStudentList = students.MyWhere(q=&gt;q.StudentAge&gt;<span class="hljs-number">10</span>);
        Console.WriteLine(<span class="hljs-string">"ç­›é€‰å¹´é¾„å¤§äº10å²çš„å­¦ç”Ÿï¼š"</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> student <span class="hljs-keyword">in</span> myNewStudentList)
        {
            Console.WriteLine(<span class="hljs-string">$"å­¦ç”Ÿåï¼š<span class="hljs-subst">{student.StudentName}</span>,å­¦ç”Ÿå¹´é¾„ï¼š<span class="hljs-subst">{student.StudentAge}</span>"</span>);
        }

    }
}
</code></pre>
<h4 data-id="heading-17">æ­¥éª¤ 3ï¼šæ‰‹åŠ¨å®ç° Select æ–¹æ³•ï¼ˆè½¬æ¢ / æŠ•å½±æ•°æ®ï¼‰</h4>
<p>ä¸Šé¢æˆ‘ä»¬éå¸¸è¯¦ç»†çš„ä»‹ç»äº†<code>Where</code>æ–¹æ³•æ˜¯å¦‚ä½•å®ç°çš„ï¼Œè¿™é‡Œçš„<code>Select</code>æ–¹æ³•æˆ‘ä»¬å°±ä¸å†ä»å¤´æè¿°ï¼Œç›´æ¥ç»™å‡ºæœ€ç»ˆä»£ç ã€‚</p>
<p><strong>èƒŒæ™¯</strong>ï¼šéœ€è¦å°†æ•°æ®è½¬æ¢æˆå¦ä¸€ç§æ ¼å¼ï¼ˆæ¯”å¦‚è®¢å•â†’åªä¿ç•™ ID å’Œå®¢æˆ·åï¼‰ï¼ŒSelect æ–¹æ³•çš„æ ¸å¿ƒæ˜¯ â€œæ¥æ”¶è½¬æ¢è§„åˆ™ï¼ˆLambdaï¼‰ï¼Œè¿”å›è½¬æ¢åçš„å…ƒç´ åˆ—è¡¨â€ã€‚</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TResult</span>&gt; <span class="hljs-title">MySelect</span>&lt;<span class="hljs-title">T</span>, <span class="hljs-title">TResult</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> IEnumerable&lt;T&gt; source, Func&lt;T, TResult&gt; selector</span>)</span>
    {
        <span class="hljs-comment">// å¥å£®æ€§æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (source == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(source), <span class="hljs-string">"æ•°æ®æºä¸èƒ½ä¸ºnull"</span>);
        <span class="hljs-keyword">if</span> (selector == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(selector), <span class="hljs-string">"è½¬æ¢è§„åˆ™ä¸èƒ½ä¸ºnull"</span>);

        <span class="hljs-comment">// å»¶è¿Ÿæ‰§è¡Œï¼šéå†åˆ°å…ƒç´ æ—¶æ‰è½¬æ¢ï¼Œè½¬æ¢åé€ä¸ªè¿”å›</span>
        <span class="hljs-keyword">foreach</span> (T item <span class="hljs-keyword">in</span> source)
        {
            TResult convertedItem = selector(item);
            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> convertedItem; <span class="hljs-comment">// æ ¸å¿ƒï¼šå»¶è¿Ÿè¿”å›è½¬æ¢åçš„å…ƒç´ </span>
        }
    }
</code></pre>
<p><strong>è°ƒç”¨è‡ªå®šä¹‰ Select æ–¹æ³•</strong>ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// åœ¨Mainæ–¹æ³•ä¸­</span>
<span class="hljs-comment">// å…ˆç­›é€‰ï¼Œå†è½¬æ¢ï¼šé‡‘é¢&gt;1000çš„è®¢å• â†’ åªä¿ç•™IDå’Œå®¢æˆ·åï¼ˆåŒ¿åç±»ï¼‰</span>
<span class="hljs-keyword">var</span> simplifiedOrders = orders
    .MyWhere(o =&gt; o.Amount &gt; <span class="hljs-number">1000</span>) <span class="hljs-comment">// è‡ªå®šä¹‰Whereç­›é€‰</span>
    .MySelect(o =&gt; <span class="hljs-keyword">new</span> { è®¢å•ID = o.OrderId, å®¢æˆ· = o.Customer }); <span class="hljs-comment">// è‡ªå®šä¹‰Selectè½¬æ¢</span>

Console.WriteLine(<span class="hljs-string">"\nè‡ªå®šä¹‰Selectè½¬æ¢ç»“æœï¼š"</span>);
<span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> item <span class="hljs-keyword">in</span> simplifiedOrders)
{
    Console.WriteLine(<span class="hljs-string">$"è®¢å•IDï¼š<span class="hljs-subst">{item.è®¢å•ID}</span>ï¼Œå®¢æˆ·ï¼š<span class="hljs-subst">{item.å®¢æˆ·}</span>"</span>);
}
</code></pre>
<p>è¿™é‡Œçš„<code>Select</code>å…¶å®å’Œ<code>Where</code>æ²¡ä»€ä¹ˆå¤ªå¤§çš„åŒºåˆ«ï¼Œåªä¸è¿‡å°±æ˜¯å°†å§”æ‰˜å‚æ•°å˜æˆäº†ï¼š<code>Func&lt;T, TResult&gt; selector</code>ï¼Œæ¥æ”¶çš„æ–¹æ³•ä¼ å…¥çš„æ˜¯ä¸€ä¸ª<code>T</code>ç±»å‹ï¼Œè¾“å‡ºçš„æ˜¯ä¸€ä¸ªæ–°çš„ç±»å‹ï¼Œä»è°ƒç”¨ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œè¿™é‡Œè¿˜ä½¿ç”¨åˆ°äº†åŒ¿åå‡½æ•°ï¼Œ<code>o =&gt; new { è®¢å•ID = o.OrderId, å®¢æˆ· = o.Customer }</code>è¿™ä¸ªLambdaè¡¨è¾¾å¼çš„æ„æ€å°±æ˜¯ï¼Œå‚æ•°æ¥æ”¶ä¸€ä¸ª<code>Order</code>ç±»å‹çš„o,è¿”å›ä¸€ä¸ªåŒ¿åå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§ä¸€ä¸ªæ˜¯<code>è®¢å•ID</code>ï¼Œä¸€ä¸ªæ˜¯<code>å®¢æˆ·</code>ã€‚</p>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql">è‡ªå®šä¹‰<span class="hljs-keyword">Select</span>è½¬æ¢ç»“æœï¼š
è®¢å•IDï¼š<span class="hljs-number">2</span>ï¼Œå®¢æˆ·ï¼šæå››
è®¢å•IDï¼š<span class="hljs-number">3</span>ï¼Œå®¢æˆ·ï¼šç‹äº”
</code></pre>
<p><strong>æ ¸å¿ƒè§£æ</strong>ï¼š</p>
<ul>
<li><code>MySelect</code>æ˜¯æ³›å‹æ‰©å±•æ–¹æ³•ï¼Œ<code>Func&lt;T, TResult&gt; selector</code>æ¥æ”¶è½¬æ¢è§„åˆ™ï¼ˆæ¯”å¦‚æŠŠ Order è½¬æ¢æˆåŒ¿åç±»ï¼‰ï¼›</li>
<li>åº•å±‚è¿˜æ˜¯ foreach å¾ªç¯ï¼Œè°ƒç”¨ Lambda æŠŠæ¯ä¸ªå…ƒç´ è½¬æ¢æˆç›®æ ‡æ ¼å¼ â€”â€” åŸç”Ÿ LINQ Select çš„æ ¸å¿ƒå°±æ˜¯è¿™ä¸ªé€»è¾‘ã€‚</li>
</ul>
<h4 data-id="heading-18">æ­¥éª¤ 4ï¼šæ‰‹åŠ¨å®ç° FirstOrDefault æ–¹æ³•ï¼ˆæŸ¥æ‰¾ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰</h4>
<p><strong>èƒŒæ™¯</strong>ï¼šéœ€è¦å¿«é€Ÿæ‰¾ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œæ²¡æœ‰åˆ™è¿”å›é»˜è®¤å€¼ï¼ˆæ¯”å¦‚ nullï¼‰ï¼Œä¸ç”¨å†™ foreach éå†æ‰¾ç¬¬ä¸€ä¸ªã€‚</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> T <span class="hljs-title">MyFirstOrDefault</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> IEnumerable&lt;T&gt; source, Func&lt;T, <span class="hljs-built_in">bool</span>&gt; predicate</span>)</span>
    {
        <span class="hljs-comment">// å¥å£®æ€§æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (source == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(source), <span class="hljs-string">"æ•°æ®æºä¸èƒ½ä¸ºnull"</span>);
        <span class="hljs-keyword">if</span> (predicate == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(predicate), <span class="hljs-string">"ç­›é€‰è§„åˆ™ä¸èƒ½ä¸ºnull"</span>);

        <span class="hljs-comment">// éå†IEnumerable&lt;T&gt;ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ ç«‹å³è¿”å›ï¼ˆæ— éœ€éå†å…¨éƒ¨ï¼‰</span>
        <span class="hljs-keyword">foreach</span> (T item <span class="hljs-keyword">in</span> source)
        {
            <span class="hljs-keyword">if</span> (predicate(item))
            {
                <span class="hljs-keyword">return</span> item;
            }
        }

        <span class="hljs-comment">// æ— ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œè¿”å›Tçš„é»˜è®¤å€¼ï¼ˆå¼•ç”¨ç±»å‹nullï¼Œå€¼ç±»å‹0ç­‰ï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">default</span>(T);
    }
</code></pre>
<p><strong>è°ƒç”¨è‡ªå®šä¹‰ FirstOrDefault æ–¹æ³•</strong>ï¼š</p>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-comment">// åœ¨Mainæ–¹æ³•ä¸­</span>
<span class="hljs-comment">// æ‰¾ç¬¬ä¸€ä¸ªå®¢æˆ·æ˜¯â€œæå››â€çš„è®¢å•</span>
Order liSiOrder = orders.MyFirstOrDefault(o =&gt; o.Customer == <span class="hljs-string">"æå››"</span>);
<span class="hljs-comment">// æ‰¾ç¬¬ä¸€ä¸ªå®¢æˆ·æ˜¯â€œèµµå…­â€çš„è®¢å•ï¼ˆä¸å­˜åœ¨ï¼Œè¿”å›nullï¼‰</span>
Order zhaoLiuOrder = orders.MyFirstOrDefault(o =&gt; o.Customer == <span class="hljs-string">"èµµå…­"</span>);

Console.WriteLine(<span class="hljs-string">"\nè‡ªå®šä¹‰FirstOrDefaultæŸ¥æ‰¾ç»“æœï¼š"</span>);
Console.WriteLine(<span class="hljs-string">$"æå››çš„è®¢å•IDï¼š<span class="hljs-subst">{liSiOrder?.OrderId}</span>"</span>); <span class="hljs-comment">// è¾“å‡º2</span>
Console.WriteLine(<span class="hljs-string">$"èµµå…­çš„è®¢å•ï¼š<span class="hljs-subst">{(zhaoLiuOrder == <span class="hljs-literal">null</span> ? <span class="hljs-string">"ä¸å­˜åœ¨"</span> : zhaoLiuOrder.OrderId)}</span>"</span>); <span class="hljs-comment">// è¾“å‡ºä¸å­˜åœ¨</span>
</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="hljs">è‡ªå®šä¹‰FirstOrDefaultæŸ¥æ‰¾ç»“æœï¼š
æå››çš„è®¢å•IDï¼š2
èµµå…­çš„è®¢å•ï¼šä¸å­˜åœ¨
</code></pre>
<p><strong>æ ¸å¿ƒè§£æ</strong>ï¼š</p>
<ul>
<li>åº•å±‚æ˜¯ foreach å¾ªç¯ï¼Œä½†æ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ å°±ç«‹å³è¿”å›ï¼ˆæ€§èƒ½æ¯”éå†å…¨éƒ¨é«˜ï¼‰ï¼›</li>
<li><code>default(T)</code>æ˜¯æ³›å‹é»˜è®¤å€¼ï¼šå¼•ç”¨ç±»å‹ï¼ˆå¦‚ Orderï¼‰è¿”å› nullï¼Œå€¼ç±»å‹ï¼ˆå¦‚ intï¼‰è¿”å› 0ï¼Œbool è¿”å› falseã€‚</li>
</ul>
<h3 data-id="heading-19">ä¸‰ã€å®Œæ•´ç¤ºä¾‹ï¼šç”¨è‡ªå®šä¹‰ LINQ æ–¹æ³•å¤„ç†è®¢å•æ•°æ®</h3>
<pre><code class="hljs language-cs" lang="cs"><span class="hljs-keyword">using</span> System;
<span class="hljs-keyword">using</span> System.Collections.Generic;

<span class="hljs-comment">// è®¢å•/å­¦ç”Ÿå®ä½“ä¿æŒä¸å˜</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Order</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> OrderId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">decimal</span> Amount { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> Customer { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Student</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentId { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">string</span> StudentName { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> StudentAge { <span class="hljs-keyword">get</span>; <span class="hljs-keyword">set</span>; }
}

<span class="hljs-comment">// ç¬¦åˆå®˜æ–¹é£æ ¼çš„è‡ªå®šä¹‰LINQæ‰©å±•ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyLinqExtensions</span>
{
    <span class="hljs-meta">#<span class="hljs-keyword">region</span> 1. MyWhereï¼ˆåŸºäºIEnumerable&lt;T&gt; + å»¶è¿Ÿæ‰§è¡Œï¼‰</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> è‡ªå®šä¹‰Whereï¼šç­›é€‰ç¬¦åˆè§„åˆ™çš„å…ƒç´ ï¼ˆå®˜æ–¹é£æ ¼ï¼Œå»¶è¿Ÿæ‰§è¡Œï¼‰</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">MyWhere</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> IEnumerable&lt;T&gt; source, Func&lt;T, <span class="hljs-built_in">bool</span>&gt; predicate</span>)</span>
    {
        <span class="hljs-comment">// å¥å£®æ€§æ ¡éªŒï¼ˆå®˜æ–¹LINQå¿…åŠ ï¼‰</span>
        <span class="hljs-keyword">if</span> (source == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(source), <span class="hljs-string">"æ•°æ®æºä¸èƒ½ä¸ºnull"</span>);
        <span class="hljs-keyword">if</span> (predicate == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(predicate), <span class="hljs-string">"ç­›é€‰è§„åˆ™ä¸èƒ½ä¸ºnull"</span>);

        <span class="hljs-comment">// å»¶è¿Ÿæ‰§è¡Œï¼šéå†åˆ°å…ƒç´ æ—¶æ‰åˆ¤æ–­ï¼Œç¬¦åˆæ¡ä»¶åˆ™è¿”å›</span>
        <span class="hljs-keyword">foreach</span> (T item <span class="hljs-keyword">in</span> source)
        {
            <span class="hljs-keyword">if</span> (predicate(item))
            {
                <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> item; <span class="hljs-comment">// é€ä¸ªè¿”å›ï¼Œä¸æå‰åˆ›å»ºé›†åˆ</span>
            }
        }
    }
    <span class="hljs-meta">#<span class="hljs-keyword">endregion</span></span>

    <span class="hljs-meta">#<span class="hljs-keyword">region</span> 2. MySelectï¼ˆåŸºäºIEnumerable&lt;T&gt; + å»¶è¿Ÿæ‰§è¡Œï¼‰</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> è‡ªå®šä¹‰Selectï¼šè½¬æ¢æ•°æ®æ ¼å¼ï¼ˆå®˜æ–¹é£æ ¼ï¼Œå»¶è¿Ÿæ‰§è¡Œï¼‰</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title">IEnumerable</span>&lt;<span class="hljs-title">TResult</span>&gt; <span class="hljs-title">MySelect</span>&lt;<span class="hljs-title">T</span>, <span class="hljs-title">TResult</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> IEnumerable&lt;T&gt; source, Func&lt;T, TResult&gt; selector</span>)</span>
    {
        <span class="hljs-comment">// å¥å£®æ€§æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (source == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(source), <span class="hljs-string">"æ•°æ®æºä¸èƒ½ä¸ºnull"</span>);
        <span class="hljs-keyword">if</span> (selector == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(selector), <span class="hljs-string">"è½¬æ¢è§„åˆ™ä¸èƒ½ä¸ºnull"</span>);

        <span class="hljs-comment">// å»¶è¿Ÿæ‰§è¡Œï¼šéå†åˆ°å…ƒç´ æ—¶æ‰è½¬æ¢ï¼Œè½¬æ¢åé€ä¸ªè¿”å›</span>
        <span class="hljs-keyword">foreach</span> (T item <span class="hljs-keyword">in</span> source)
        {
            TResult convertedItem = selector(item);
            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">return</span> convertedItem; <span class="hljs-comment">// æ ¸å¿ƒï¼šå»¶è¿Ÿè¿”å›è½¬æ¢åçš„å…ƒç´ </span>
        }
    }
    <span class="hljs-meta">#<span class="hljs-keyword">endregion</span></span>

    <span class="hljs-meta">#<span class="hljs-keyword">region</span> 3. MyFirstOrDefaultï¼ˆåŸºäºIEnumerable&lt;T&gt; + ç«‹å³æ‰§è¡Œï¼‰</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> è‡ªå®šä¹‰FirstOrDefaultï¼šæ‰¾ç¬¬ä¸€ä¸ªç¬¦åˆè§„åˆ™çš„å…ƒç´ ï¼ˆå®˜æ–¹é£æ ¼ï¼Œé€‚é…IEnumerable<span class="hljs-doctag">&lt;T&gt;</span>ï¼‰</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> æ³¨ï¼šFirstOrDefaultè¯­ä¹‰ä¸Šæ˜¯â€œç«‹å³æ‰§è¡Œâ€ï¼Œå› ä¸ºè¦è¿”å›å…·ä½“å…ƒç´ ï¼Œæ— æ³•å»¶è¿Ÿ</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> T <span class="hljs-title">MyFirstOrDefault</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> IEnumerable&lt;T&gt; source, Func&lt;T, <span class="hljs-built_in">bool</span>&gt; predicate</span>)</span>
    {
        <span class="hljs-comment">// å¥å£®æ€§æ ¡éªŒ</span>
        <span class="hljs-keyword">if</span> (source == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(source), <span class="hljs-string">"æ•°æ®æºä¸èƒ½ä¸ºnull"</span>);
        <span class="hljs-keyword">if</span> (predicate == <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ArgumentNullException(<span class="hljs-keyword">nameof</span>(predicate), <span class="hljs-string">"ç­›é€‰è§„åˆ™ä¸èƒ½ä¸ºnull"</span>);

        <span class="hljs-comment">// éå†IEnumerable&lt;T&gt;ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ ç«‹å³è¿”å›ï¼ˆæ— éœ€éå†å…¨éƒ¨ï¼‰</span>
        <span class="hljs-keyword">foreach</span> (T item <span class="hljs-keyword">in</span> source)
        {
            <span class="hljs-keyword">if</span> (predicate(item))
            {
                <span class="hljs-keyword">return</span> item;
            }
        }

        <span class="hljs-comment">// æ— ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œè¿”å›Tçš„é»˜è®¤å€¼ï¼ˆå¼•ç”¨ç±»å‹nullï¼Œå€¼ç±»å‹0ç­‰ï¼‰</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">default</span>(T);
    }
    <span class="hljs-meta">#<span class="hljs-keyword">endregion</span></span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
{
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>()</span>
    {
        <span class="hljs-comment">// æ¨¡æ‹Ÿæ•°æ®æº</span>
        List&lt;Order&gt; orders = <span class="hljs-keyword">new</span> List&lt;Order&gt;
        {
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">1</span>, Amount = <span class="hljs-number">800</span>, Customer = <span class="hljs-string">"å¼ ä¸‰"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">2</span>, Amount = <span class="hljs-number">1200</span>, Customer = <span class="hljs-string">"æå››"</span> },
            <span class="hljs-keyword">new</span> Order { OrderId = <span class="hljs-number">3</span>, Amount = <span class="hljs-number">1500</span>, Customer = <span class="hljs-string">"ç‹äº”"</span> }
        };

        <span class="hljs-comment">// ========== æ¼”ç¤ºé“¾å¼è°ƒç”¨ + å»¶è¿Ÿæ‰§è¡Œ ==========</span>
        Console.WriteLine(<span class="hljs-string">"1. å®šä¹‰æŸ¥è¯¢è§„åˆ™ï¼ˆæ­¤æ—¶ä¸æ‰§è¡Œä»»ä½•éå†ï¼‰ï¼š"</span>);
        <span class="hljs-comment">// ä»…å®šä¹‰è§„åˆ™ï¼Œæœªæ‰§è¡Œéå†ï¼ˆå»¶è¿Ÿæ‰§è¡Œï¼‰</span>
        <span class="hljs-keyword">var</span> query = orders
            .MyWhere(o =&gt; o.Amount &gt; <span class="hljs-number">1000</span>)    <span class="hljs-comment">// ç­›é€‰é«˜é‡‘é¢è®¢å•</span>
            .MySelect(o =&gt; <span class="hljs-keyword">new</span>               <span class="hljs-comment">// è½¬æ¢ä¸ºç®€åŒ–æ ¼å¼</span>
            {
                è®¢å•ID = o.OrderId,
                å®¢æˆ· = o.Customer,
                æŠ˜æ‰£é‡‘é¢ = o.Amount * <span class="hljs-number">0.8</span>m
            })
            .MyFirstOrDefault(item =&gt; item.æŠ˜æ‰£é‡‘é¢ &gt; <span class="hljs-number">1000</span>); <span class="hljs-comment">// æ‰¾ç¬¬ä¸€ä¸ªæŠ˜æ‰£&gt;1000çš„</span>

        Console.WriteLine(<span class="hljs-string">"2. æ‰§è¡ŒæŸ¥è¯¢ï¼ˆFirstOrDefaultè§¦å‘éå†ï¼‰ï¼š"</span>);
        Console.WriteLine(<span class="hljs-string">$"ç¬¬ä¸€ä¸ªæŠ˜æ‰£é‡‘é¢&gt;1000çš„è®¢å•ï¼š"</span>);
        Console.WriteLine(<span class="hljs-string">$"è®¢å•IDï¼š<span class="hljs-subst">{query.è®¢å•ID}</span>ï¼Œå®¢æˆ·ï¼š<span class="hljs-subst">{query.å®¢æˆ·}</span>ï¼ŒæŠ˜æ‰£é‡‘é¢ï¼š<span class="hljs-subst">{query.æŠ˜æ‰£é‡‘é¢}</span>"</span>);

        <span class="hljs-comment">// ========== éªŒè¯MySelectå¯¹ä¸åŒé›†åˆçš„é€‚é…æ€§ï¼ˆæ•°ç»„ï¼‰ ==========</span>
        Console.WriteLine(<span class="hljs-string">"\n3. MySelecté€‚é…æ•°ç»„ï¼ˆIEnumerable&lt;T&gt;çš„é€šç”¨æ€§ï¼‰ï¼š"</span>);
        <span class="hljs-built_in">int</span>[] nums = <span class="hljs-keyword">new</span> <span class="hljs-built_in">int</span>[] { <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span> };
        <span class="hljs-comment">// æ•°ç»„è½¬æ¢ä¸ºâ€œæ•°å­—+10â€çš„æ–°åºåˆ—</span>
        <span class="hljs-keyword">var</span> numResult = nums.MySelect(n =&gt; n + <span class="hljs-number">10</span>);
        <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> n <span class="hljs-keyword">in</span> numResult)
        {
            Console.WriteLine(<span class="hljs-string">$"è½¬æ¢åæ•°å­—ï¼š<span class="hljs-subst">{n}</span>"</span>); <span class="hljs-comment">// è¾“å‡º11ã€12ã€13ã€14</span>
        }
    }
}
</code></pre>
<h3 data-id="heading-20">å››ã€åŸç”Ÿ LINQ vs è‡ªå®šä¹‰ LINQï¼šæ ¸å¿ƒä¸€è‡´</h3>
<p>åŸç”Ÿ LINQ çš„ Where/Select/FirstOrDefault å’Œæˆ‘ä»¬æ‰‹æ“çš„æ–¹æ³•æ ¸å¿ƒé€»è¾‘å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯åŸç”Ÿ LINQï¼š</p>
<ol>
<li>æœ‰æ›´å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ€§èƒ½ä¼˜åŒ–ï¼›</li>
<li>æ”¯æŒæ›´å¤šæ–¹æ³•ï¼ˆOrderByã€GroupByã€Join ç­‰ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-21">æ€»ç»“</h3>
<ol>
<li>
<p><strong>LINQ çš„æœ¬è´¨</strong>ï¼šæ˜¯ä¸€å¥—åŸºäº â€œæ‰©å±•æ–¹æ³• + Lambdaâ€ çš„é€šç”¨æŸ¥è¯¢æ¡†æ¶ï¼Œåº•å±‚å°±æ˜¯ foreach å¾ªç¯ + Lambda æ‰§è¡Œè§„åˆ™ï¼ŒæŸ¥è¯¢è¯­æ³•åªæ˜¯è¯­æ³•ç³–ï¼›</p>
</li>
<li>
<p><strong>æ ¸å¿ƒæ–¹æ³•é€»è¾‘</strong>ï¼š</p>
<ul>
<li>Whereï¼šæ¥æ”¶<code>Func&lt;T, bool&gt;</code>ç­›é€‰è§„åˆ™ï¼Œè¿”å›ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼›</li>
<li>Selectï¼šæ¥æ”¶<code>Func&lt;T, TResult&gt;</code>è½¬æ¢è§„åˆ™ï¼Œè¿”å›è½¬æ¢åçš„å…ƒç´ ï¼›</li>
<li>FirstOrDefaultï¼šæ¥æ”¶ç­›é€‰è§„åˆ™ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼ˆæ— åˆ™è¿”å›é»˜è®¤å€¼ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p><strong>å­¦ä¹ å…³é”®</strong>ï¼šå…ˆç†è§£ â€œæ‰©å±•æ–¹æ³• + Lambdaâ€ çš„åº•å±‚é€»è¾‘ï¼Œå†ä½¿ç”¨åŸç”Ÿ LINQï¼Œå°±ä¸ä¼šåªåœç•™åœ¨ â€œä¼šç”¨â€ çš„å±‚é¢ï¼Œèƒ½çµæ´»è§£å†³å¤æ‚æŸ¥è¯¢åœºæ™¯ã€‚</p>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 äº‹ä»¶ä¿®é¥°ç¬¦æ·±åº¦è§£æï¼šä»åŸºç¡€åˆ°é«˜çº§åº”ç”¨çš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7583325044233371674</link>    <guid>https://juejin.cn/post/7583325044233371674</guid>    <pubDate>2025-12-14T08:19:53.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583325044233371674" data-draft-id="7583528177558732850" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 äº‹ä»¶ä¿®é¥°ç¬¦æ·±åº¦è§£æï¼šä»åŸºç¡€åˆ°é«˜çº§åº”ç”¨çš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-14T08:19:53.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 äº‹ä»¶ä¿®é¥°ç¬¦æ·±åº¦è§£æï¼šä»åŸºç¡€åˆ°é«˜çº§åº”ç”¨çš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:19:53.000Z" title="Sun Dec 14 2025 08:19:53 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>æ‘˜è¦</strong></h2>
<p>äº‹ä»¶ä¿®é¥°ç¬¦æ˜¯ Vue.js ä¸­ä¸€ä¸ªå¼ºå¤§è€Œä¼˜é›…çš„ç‰¹æ€§ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä»¥å£°æ˜å¼çš„æ–¹å¼å¤„ç† DOM äº‹ä»¶ç»†èŠ‚ã€‚Vue3 åœ¨ä¿ç•™æ‰€æœ‰ Vue2 äº‹ä»¶ä¿®é¥°ç¬¦çš„åŸºç¡€ä¸Šï¼Œè¿˜å¼•å…¥äº†ä¸€äº›æ–°çš„ä¿®é¥°ç¬¦ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨æ‰€æœ‰äº‹ä»¶ä¿®é¥°ç¬¦çš„å·¥ä½œåŸç†ã€ä½¿ç”¨åœºæ™¯å’Œæœ€ä½³å®è·µï¼Œé€šè¿‡è¯¦ç»†çš„ä»£ç ç¤ºä¾‹ã€æ‰§è¡Œæµç¨‹åˆ†æå’Œå®é™…åº”ç”¨æ¡ˆä¾‹ï¼Œå¸®åŠ©ä½ å½»åº•æŒæ¡ Vue3 äº‹ä»¶ä¿®é¥°ç¬¦çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ã€‚</p>
<hr/>
<h2 data-id="heading-1"><strong>ä¸€ã€ ä»€ä¹ˆæ˜¯äº‹ä»¶ä¿®é¥°ç¬¦ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong></h2>
<h3 data-id="heading-2"><strong>1.1 ä¼ ç»Ÿäº‹ä»¶å¤„ç†çš„é—®é¢˜</strong></h3>
<p>åœ¨åŸç”Ÿ JavaScript ä¸­å¤„ç†äº‹ä»¶æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ç¼–å†™é‡å¤çš„æ ·æ¿ä»£ç ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŸç”Ÿ JavaScript äº‹ä»¶å¤„ç†</span>
element.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) {
  <span class="hljs-comment">// é˜»æ­¢é»˜è®¤è¡Œä¸º</span>
  event.<span class="hljs-title function_">preventDefault</span>()
  
  <span class="hljs-comment">// åœæ­¢äº‹ä»¶ä¼ æ’­</span>
  event.<span class="hljs-title function_">stopPropagation</span>()
  
  <span class="hljs-comment">// æ‰§è¡Œä¸šåŠ¡é€»è¾‘</span>
  <span class="hljs-title function_">handleClick</span>()
})
</code></pre>
<p><strong>ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜ï¼š</strong></p>
<ul>
<li><strong>ä»£ç å†—ä½™</strong>ï¼šæ¯ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°éƒ½éœ€è¦é‡å¤è°ƒç”¨ <code>preventDefault()</code> å’Œ <code>stopPropagation()</code></li>
<li><strong>å…³æ³¨ç‚¹æ··åˆ</strong>ï¼šäº‹ä»¶å¤„ç†é€»è¾‘ä¸ DOM æ“ä½œç»†èŠ‚æ··åˆåœ¨ä¸€èµ·</li>
<li><strong>å¯è¯»æ€§å·®</strong>ï¼šä»£ç æ„å›¾ä¸å¤Ÿæ¸…æ™°æ˜ç¡®</li>
<li><strong>ç»´æŠ¤å›°éš¾</strong>ï¼šä¿®æ”¹äº‹ä»¶è¡Œä¸ºéœ€è¦æ·±å…¥å‡½æ•°å†…éƒ¨</li>
</ul>
<h3 data-id="heading-3"><strong>1.2 Vue äº‹ä»¶ä¿®é¥°ç¬¦çš„è§£å†³æ–¹æ¡ˆ</strong></h3>
<p>Vue çš„äº‹ä»¶ä¿®é¥°ç¬¦æä¾›äº†ä¸€ç§å£°æ˜å¼çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;!-- ä½¿ç”¨äº‹ä»¶ä¿®é¥°ç¬¦ --&gt;
  &lt;a @click.prevent.stop="handleClick" href="/about"&gt;å…³äºæˆ‘ä»¬&lt;/a&gt;
&lt;/template&gt;
</code></pre>
<p><strong>äº‹ä»¶ä¿®é¥°ç¬¦çš„ä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>ä»£ç ç®€æ´</strong>ï¼šä»¥å£°æ˜å¼çš„æ–¹å¼è¡¨è¾¾äº‹ä»¶è¡Œä¸º</li>
<li><strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong>ï¼šä¸šåŠ¡é€»è¾‘ä¸ DOM ç»†èŠ‚åˆ†ç¦»</li>
<li><strong>å¯è¯»æ€§å¼º</strong>ï¼šä»£ç æ„å›¾ä¸€ç›®äº†ç„¶</li>
<li><strong>ç»´æŠ¤æ–¹ä¾¿</strong>ï¼šä¿®æ”¹äº‹ä»¶è¡Œä¸ºåªéœ€æ”¹åŠ¨æ¨¡æ¿</li>
</ul>
<hr/>
<h2 data-id="heading-4"><strong>äºŒã€ Vue3 äº‹ä»¶ä¿®é¥°ç¬¦å®Œæ•´åˆ—è¡¨</strong></h2>
<h3 data-id="heading-5"><strong>2.1 äº‹ä»¶ä¿®é¥°ç¬¦åˆ†ç±»æ€»è§ˆ</strong></h3>




















































































































































































<table><thead><tr><th>ç±»åˆ«</th><th>ä¿®é¥°ç¬¦</th><th>è¯´æ˜</th><th>Vue2</th><th>Vue3</th></tr></thead><tbody><tr><td><strong>äº‹ä»¶ä¼ æ’­</strong></td><td><code>.stop</code></td><td>é˜»æ­¢äº‹ä»¶å†’æ³¡</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.capture</code></td><td>ä½¿ç”¨æ•è·æ¨¡å¼</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.self</code></td><td>ä»…å½“äº‹ä»¶æºæ˜¯è‡ªèº«æ—¶è§¦å‘</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.once</code></td><td>åªè§¦å‘ä¸€æ¬¡</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.passive</code></td><td>ä¸é˜»æ­¢é»˜è®¤è¡Œä¸º</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>é»˜è®¤è¡Œä¸º</strong></td><td><code>.prevent</code></td><td>é˜»æ­¢é»˜è®¤è¡Œä¸º</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>æŒ‰é”®ä¿®é¥°</strong></td><td><code>.enter</code></td><td>Enter é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.tab</code></td><td>Tab é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.delete</code></td><td>åˆ é™¤é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.esc</code></td><td>Esc é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.space</code></td><td>ç©ºæ ¼é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.up</code></td><td>ä¸Šç®­å¤´</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.down</code></td><td>ä¸‹ç®­å¤´</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.left</code></td><td>å·¦ç®­å¤´</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.right</code></td><td>å³ç®­å¤´</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>ç³»ç»Ÿä¿®é¥°</strong></td><td><code>.ctrl</code></td><td>Ctrl é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.alt</code></td><td>Alt é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.shift</code></td><td>Shift é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.meta</code></td><td>Meta é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.exact</code></td><td>ç²¾ç¡®åŒ¹é…ç³»ç»Ÿä¿®é¥°ç¬¦</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>é¼ æ ‡ä¿®é¥°</strong></td><td><code>.left</code></td><td>é¼ æ ‡å·¦é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.right</code></td><td>é¼ æ ‡å³é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td/><td><code>.middle</code></td><td>é¼ æ ‡ä¸­é”®</td><td>âœ…</td><td>âœ…</td></tr><tr><td><strong>Vue3 æ–°å¢</strong></td><td><code>.vue</code></td><td>è‡ªå®šä¹‰äº‹ä»¶ä¸“ç”¨</td><td>âŒ</td><td>âœ…</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-6"><strong>ä¸‰ã€ äº‹ä»¶ä¼ æ’­ä¿®é¥°ç¬¦è¯¦è§£</strong></h2>
<h3 data-id="heading-7"><strong>3.1 äº‹ä»¶ä¼ æ’­çš„åŸºæœ¬æ¦‚å¿µ</strong></h3>
<p><strong>æµç¨‹å›¾ï¼šDOM äº‹ä»¶ä¼ æ’­æœºåˆ¶</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[äº‹ä»¶å‘ç”Ÿ] --&gt; B[æ•è·é˜¶æ®µ Capture Phase]
    B --&gt; C[ä»windowå‘ä¸‹ä¼ é€’åˆ°ç›®æ ‡]
    C --&gt; D[ç›®æ ‡é˜¶æ®µ Target Phase]
    D --&gt; E[åˆ°è¾¾äº‹ä»¶ç›®æ ‡å…ƒç´ ]
    E --&gt; F[å†’æ³¡é˜¶æ®µ Bubble Phase]
    F --&gt; G[ä»ç›®æ ‡å‘ä¸Šä¼ é€’åˆ°window]
    
    B --&gt; H[.capture åœ¨æ­¤é˜¶æ®µè§¦å‘]
    D --&gt; I[.self æ£€æŸ¥äº‹ä»¶æº]
    F --&gt; J[.stop é˜»æ­¢ç»§ç»­å†’æ³¡]
</code></pre>
<h3 data-id="heading-8"><strong>3.2 .stop - é˜»æ­¢äº‹ä»¶å†’æ³¡</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="stop-modifier-demo"&gt;
    &lt;h2&gt;.stop ä¿®é¥°ç¬¦ - é˜»æ­¢äº‹ä»¶å†’æ³¡&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;!-- å¤–å±‚å®¹å™¨ --&gt;
      &lt;div class="outer-box" @click="handleOuterClick"&gt;
        &lt;p&gt;å¤–å±‚å®¹å™¨ (ç‚¹å‡»æˆ‘ä¼šè§¦å‘)&lt;/p&gt;
        
        &lt;!-- å†…å±‚å®¹å™¨ - ä¸ä½¿ç”¨ .stop --&gt;
        &lt;div class="inner-box" @click="handleInnerClick"&gt;
          &lt;p&gt;å†…å±‚å®¹å™¨ - æ—  .stop (ç‚¹å‡»æˆ‘ä¼šè§¦å‘å†…å¤–ä¸¤å±‚)&lt;/p&gt;
        &lt;/div&gt;
        
        &lt;!-- å†…å±‚å®¹å™¨ - ä½¿ç”¨ .stop --&gt;
        &lt;div class="inner-box stop-demo" @click.stop="handleInnerClickStop"&gt;
          &lt;p&gt;å†…å±‚å®¹å™¨ - æœ‰ .stop (ç‚¹å‡»æˆ‘åªè§¦å‘å†…å±‚)&lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="event-logs"&gt;
      &lt;h3&gt;äº‹ä»¶è§¦å‘æ—¥å¿—:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
  if (logs.value.length &gt; 10) {
    logs.value.pop()
  }
}

const handleOuterClick = (event) =&gt; {
  addLog('ğŸŸ¢ å¤–å±‚å®¹å™¨è¢«ç‚¹å‡»')
  console.log('å¤–å±‚ç‚¹å‡»äº‹ä»¶:', event)
}

const handleInnerClick = (event) =&gt; {
  addLog('ğŸ”µ å†…å±‚å®¹å™¨è¢«ç‚¹å‡» (æ— .stop - ä¼šå†’æ³¡)')
  console.log('å†…å±‚ç‚¹å‡»äº‹ä»¶ (æ— .stop):', event)
}

const handleInnerClickStop = (event) =&gt; {
  addLog('ğŸ”´ å†…å±‚å®¹å™¨è¢«ç‚¹å‡» (æœ‰.stop - é˜»æ­¢å†’æ³¡)')
  console.log('å†…å±‚ç‚¹å‡»äº‹ä»¶ (æœ‰.stop):', event)
}
&lt;/script&gt;

&lt;style scoped&gt;
.stop-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.demo-area {
  margin: 20px 0;
}

.outer-box {
  padding: 30px;
  background: #e3f2fd;
  border: 2px solid #2196f3;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.3s;
}

.outer-box:hover {
  background: #bbdefb;
}

.outer-box p {
  margin: 0 0 15px 0;
  font-weight: bold;
  color: #1976d2;
}

.inner-box {
  padding: 20px;
  margin: 15px 0;
  background: #f3e5f5;
  border: 2px solid #9c27b0;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.3s;
}

.inner-box:hover {
  background: #e1bee7;
}

.inner-box p {
  margin: 0;
  color: #7b1fa2;
}

.stop-demo {
  background: #fff3e0;
  border-color: #ff9800;
}

.stop-demo p {
  color: #ef6c00;
}

.event-logs {
  margin-top: 30px;
  padding: 20px;
  background: #f5f5f5;
  border-radius: 8px;
}

.event-logs h3 {
  margin: 0 0 15px 0;
  color: #333;
}

.log-item {
  padding: 8px 12px;
  margin: 5px 0;
  background: white;
  border-radius: 4px;
  border-left: 4px solid #4caf50;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-9"><strong>3.3 .capture - ä½¿ç”¨äº‹ä»¶æ•è·æ¨¡å¼</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="capture-modifier-demo"&gt;
    &lt;h2&gt;.capture ä¿®é¥°ç¬¦ - äº‹ä»¶æ•è·æ¨¡å¼&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;!-- æ•è·é˜¶æ®µè§¦å‘ --&gt;
      &lt;div class="capture-box" @click.capture="handleCaptureClick"&gt;
        &lt;p&gt;æ•è·é˜¶æ®µå®¹å™¨ (ä½¿ç”¨ .capture)&lt;/p&gt;
        
        &lt;div class="target-box" @click="handleTargetClick"&gt;
          &lt;p&gt;ç›®æ ‡å…ƒç´  (æ­£å¸¸å†’æ³¡é˜¶æ®µ)&lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="explanation"&gt;
      &lt;h3&gt;æ‰§è¡Œé¡ºåºè¯´æ˜:&lt;/h3&gt;
      &lt;ol&gt;
        &lt;li&gt;ç‚¹å‡»ç›®æ ‡å…ƒç´ æ—¶ï¼Œé¦–å…ˆè§¦å‘ &lt;strong&gt;.capture&lt;/strong&gt; é˜¶æ®µçš„äº‹ä»¶&lt;/li&gt;
        &lt;li&gt;ç„¶åè§¦å‘ç›®æ ‡å…ƒç´ è‡ªèº«çš„äº‹ä»¶&lt;/li&gt;
        &lt;li&gt;æœ€åæ˜¯å†’æ³¡é˜¶æ®µçš„äº‹ä»¶ (æœ¬ä¾‹ä¸­æ²¡æœ‰)&lt;/li&gt;
      &lt;/ol&gt;
    &lt;/div&gt;

    &lt;div class="event-logs"&gt;
      &lt;h3&gt;äº‹ä»¶è§¦å‘é¡ºåº:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
}

const handleCaptureClick = () =&gt; {
  addLog('1ï¸âƒ£ æ•è·é˜¶æ®µ: å¤–å±‚å®¹å™¨ (.capture)')
}

const handleTargetClick = () =&gt; {
  addLog('2ï¸âƒ£ ç›®æ ‡é˜¶æ®µ: å†…å±‚å…ƒç´  (æ­£å¸¸)')
}
&lt;/script&gt;

&lt;style scoped&gt;
.capture-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.capture-box {
  padding: 30px;
  background: #fff3e0;
  border: 2px dashed #ff9800;
  border-radius: 8px;
}

.capture-box p {
  margin: 0 0 15px 0;
  color: #ef6c00;
  font-weight: bold;
}

.target-box {
  padding: 20px;
  background: #e8f5e8;
  border: 2px solid #4caf50;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.3s;
}

.target-box:hover {
  background: #c8e6c9;
}

.target-box p {
  margin: 0;
  color: #2e7d32;
}

.explanation {
  margin: 20px 0;
  padding: 20px;
  background: #e3f2fd;
  border-radius: 8px;
}

.explanation h3 {
  margin: 0 0 10px 0;
  color: #1976d2;
}

.explanation ol {
  margin: 0;
  color: #333;
}

.log-item {
  padding: 8px 12px;
  margin: 5px 0;
  background: white;
  border-radius: 4px;
  border-left: 4px solid #ff9800;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-10"><strong>3.4 .self - ä»…å½“äº‹ä»¶æºæ˜¯è‡ªèº«æ—¶è§¦å‘</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="self-modifier-demo"&gt;
    &lt;h2&gt;.self ä¿®é¥°ç¬¦ - ä»…è‡ªèº«è§¦å‘&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;!-- ä¸ä½¿ç”¨ .self --&gt;
      &lt;div class="container" @click="handleContainerClick"&gt;
        &lt;p&gt;æ™®é€šå®¹å™¨ (ç‚¹å‡»å­å…ƒç´ ä¹Ÿä¼šè§¦å‘)&lt;/p&gt;
        &lt;button class="child-btn"&gt;å­å…ƒç´ æŒ‰é’®&lt;/button&gt;
      &lt;/div&gt;
      
      &lt;!-- ä½¿ç”¨ .self --&gt;
      &lt;div class="container self-demo" @click.self="handleContainerSelfClick"&gt;
        &lt;p&gt;.self å®¹å™¨ (åªæœ‰ç‚¹å‡»å®¹å™¨æœ¬èº«æ‰è§¦å‘)&lt;/p&gt;
        &lt;button class="child-btn"&gt;å­å…ƒç´ æŒ‰é’®&lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="event-logs"&gt;
      &lt;h3&gt;äº‹ä»¶è§¦å‘æ—¥å¿—:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
  if (logs.value.length &gt; 8) {
    logs.value.pop()
  }
}

const handleContainerClick = (event) =&gt; {
  addLog(`ğŸ”µ å®¹å™¨è¢«ç‚¹å‡» (target: ${event.target.tagName})`)
}

const handleContainerSelfClick = (event) =&gt; {
  addLog(`ğŸ”´ .self å®¹å™¨è¢«ç‚¹å‡» (åªæœ‰ç‚¹å‡»å®¹å™¨æœ¬èº«æ‰è§¦å‘)`)
}
&lt;/script&gt;

&lt;style scoped&gt;
.self-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.demo-area {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin: 20px 0;
}

.container {
  padding: 25px;
  border: 2px solid #666;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.3s;
  min-height: 120px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.container:hover {
  background: #f5f5f5;
}

.container p {
  margin: 0 0 15px 0;
  font-weight: bold;
  text-align: center;
}

.self-demo {
  border-color: #e91e63;
  background: #fce4ec;
}

.self-demo:hover {
  background: #f8bbd9;
}

.child-btn {
  padding: 8px 16px;
  background: #2196f3;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.child-btn:hover {
  background: #1976d2;
}

.event-logs {
  margin-top: 30px;
  padding: 20px;
  background: #f5f5f5;
  border-radius: 8px;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-11"><strong>3.5 .once - åªè§¦å‘ä¸€æ¬¡</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="once-modifier-demo"&gt;
    &lt;h2&gt;.once ä¿®é¥°ç¬¦ - åªè§¦å‘ä¸€æ¬¡&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;div class="button-group"&gt;
        &lt;button @click="handleNormalClick" class="btn"&gt;
          æ™®é€šæŒ‰é’® (å¯é‡å¤ç‚¹å‡»)
        &lt;/button&gt;
        &lt;button @click.once="handleOnceClick" class="btn once-btn"&gt;
          .once æŒ‰é’® (åªè§¦å‘ä¸€æ¬¡)
        &lt;/button&gt;
      &lt;/div&gt;
      
      &lt;div class="counter-display"&gt;
        &lt;div class="counter"&gt;
          &lt;span&gt;æ™®é€šç‚¹å‡»: &lt;/span&gt;
          &lt;strong&gt;{{ normalCount }}&lt;/strong&gt;
        &lt;/div&gt;
        &lt;div class="counter"&gt;
          &lt;span&gt;Once ç‚¹å‡»: &lt;/span&gt;
          &lt;strong&gt;{{ onceCount }}&lt;/strong&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="event-logs"&gt;
      &lt;h3&gt;äº‹ä»¶è§¦å‘æ—¥å¿—:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const normalCount = ref(0)
const onceCount = ref(0)
const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
  if (logs.value.length &gt; 6) {
    logs.value.pop()
  }
}

const handleNormalClick = () =&gt; {
  normalCount.value++
  addLog(`ğŸ”µ æ™®é€šæŒ‰é’®ç‚¹å‡»: ${normalCount.value}`)
}

const handleOnceClick = () =&gt; {
  onceCount.value++
  addLog(`ğŸ”´ ONCE æŒ‰é’®ç‚¹å‡»: ${onceCount.value} (åªä¼šæ˜¾ç¤ºä¸€æ¬¡!)`)
}
&lt;/script&gt;

&lt;style scoped&gt;
.once-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.button-group {
  display: flex;
  gap: 20px;
  justify-content: center;
  margin: 30px 0;
}

.btn {
  padding: 12px 24px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
  transition: all 0.3s;
}

.btn:first-child {
  background: #2196f3;
  color: white;
}

.btn:first-child:hover {
  background: #1976d2;
  transform: translateY(-2px);
}

.once-btn {
  background: #ff9800;
  color: white;
}

.once-btn:hover {
  background: #f57c00;
  transform: translateY(-2px);
}

.counter-display {
  display: flex;
  justify-content: center;
  gap: 40px;
  margin: 20px 0;
}

.counter {
  padding: 15px 25px;
  background: white;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  text-align: center;
  min-width: 150px;
}

.counter span {
  display: block;
  color: #666;
  margin-bottom: 5px;
}

.counter strong {
  font-size: 24px;
  color: #333;
}

.log-item {
  padding: 10px 15px;
  margin: 5px 0;
  background: white;
  border-radius: 4px;
  border-left: 4px solid #2196f3;
  font-family: 'Courier New', monospace;
}

.log-item:contains('ONCE') {
  border-left-color: #ff9800;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-12"><strong>3.6 .passive - ä¸é˜»æ­¢é»˜è®¤è¡Œä¸º</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="passive-modifier-demo"&gt;
    &lt;h2&gt;.passive ä¿®é¥°ç¬¦ - ä¸é˜»æ­¢é»˜è®¤è¡Œä¸º&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;div class="scroll-container"&gt;
        &lt;div class="scroll-content"&gt;
          &lt;div v-for="n in 50" :key="n" class="scroll-item"&gt;
            é¡¹ç›® {{ n }}
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;div class="control-info"&gt;
        &lt;p&gt;å°è¯•æ»šåŠ¨ä¸Šé¢çš„åŒºåŸŸï¼Œè§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºï¼š&lt;/p&gt;
        &lt;ul&gt;
          &lt;li&gt;ä½¿ç”¨ &lt;code&gt;.passive&lt;/code&gt; çš„äº‹ä»¶å¤„ç†å‡½æ•°ä¸ä¼šè°ƒç”¨ &lt;code&gt;preventDefault()&lt;/code&gt;&lt;/li&gt;
          &lt;li&gt;è¿™å¯ä»¥æå‡æ»šåŠ¨æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="performance-metrics"&gt;
      &lt;h3&gt;æ€§èƒ½æŒ‡æ ‡:&lt;/h3&gt;
      &lt;div class="metrics"&gt;
        &lt;div class="metric"&gt;
          &lt;span&gt;æ»šåŠ¨äº‹ä»¶è§¦å‘æ¬¡æ•°:&lt;/span&gt;
          &lt;strong&gt;{{ scrollCount }}&lt;/strong&gt;
        &lt;/div&gt;
        &lt;div class="metric"&gt;
          &lt;span&gt;é˜»å¡æ—¶é—´:&lt;/span&gt;
          &lt;strong&gt;{{ blockTime }}ms&lt;/strong&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onMounted } from 'vue'

const scrollCount = ref(0)
const blockTime = ref(0)

onMounted(() =&gt; {
  const scrollContainer = document.querySelector('.scroll-container')
  
  // æ¨¡æ‹Ÿé˜»å¡æ“ä½œ
  const heavyOperation = () =&gt; {
    const start = performance.now()
    let result = 0
    for (let i = 0; i &lt; 1000000; i++) {
      result += Math.random()
    }
    const end = performance.now()
    blockTime.value = (end - start).toFixed(2)
    return result
  }
  
  // æ·»åŠ  passive äº‹ä»¶ç›‘å¬å™¨
  scrollContainer.addEventListener('scroll', (event) =&gt; {
    scrollCount.value++
    heavyOperation()
    console.log('passive æ»šåŠ¨äº‹ä»¶ - ä¸ä¼šé˜»æ­¢é»˜è®¤è¡Œä¸º')
  }, { passive: true })
})
&lt;/script&gt;

&lt;style scoped&gt;
.passive-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.scroll-container {
  height: 200px;
  border: 2px solid #ddd;
  border-radius: 8px;
  overflow-y: scroll;
  margin: 20px 0;
}

.scroll-content {
  padding: 10px;
}

.scroll-item {
  padding: 15px;
  margin: 5px 0;
  background: #f5f5f5;
  border-radius: 4px;
  border-left: 4px solid #4caf50;
}

.control-info {
  padding: 20px;
  background: #e3f2fd;
  border-radius: 8px;
  margin: 20px 0;
}

.control-info p {
  margin: 0 0 10px 0;
  font-weight: bold;
}

.control-info ul {
  margin: 0;
  color: #333;
}

.control-info code {
  background: #fff;
  padding: 2px 6px;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
}

.performance-metrics {
  padding: 20px;
  background: #fff3e0;
  border-radius: 8px;
}

.performance-metrics h3 {
  margin: 0 0 15px 0;
  color: #e65100;
}

.metrics {
  display: flex;
  gap: 30px;
}

.metric {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.metric span {
  color: #666;
  margin-bottom: 5px;
}

.metric strong {
  font-size: 24px;
  color: #e65100;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-13"><strong>å››ã€ é»˜è®¤è¡Œä¸ºä¿®é¥°ç¬¦</strong></h2>
<h3 data-id="heading-14"><strong>4.1 .prevent - é˜»æ­¢é»˜è®¤è¡Œä¸º</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="prevent-modifier-demo"&gt;
    &lt;h2&gt;.prevent ä¿®é¥°ç¬¦ - é˜»æ­¢é»˜è®¤è¡Œä¸º&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;div class="form-group"&gt;
        &lt;h3&gt;è¡¨å•æäº¤ç¤ºä¾‹&lt;/h3&gt;
        &lt;form @submit="handleFormSubmit" class="prevent-form"&gt;
          &lt;input v-model="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" class="form-input" /&gt;
          &lt;button type="submit" class="btn"&gt;æ™®é€šæäº¤&lt;/button&gt;
          &lt;button type="submit" @click.prevent="handlePreventSubmit" class="btn prevent-btn"&gt;
            ä½¿ç”¨ .prevent
          &lt;/button&gt;
        &lt;/form&gt;
      &lt;/div&gt;
      
      &lt;div class="link-group"&gt;
        &lt;h3&gt;é“¾æ¥ç‚¹å‡»ç¤ºä¾‹&lt;/h3&gt;
        &lt;a href="https://vuejs.org" @click="handleLinkClick" class="link"&gt;
          æ™®é€šé“¾æ¥ (ä¼šè·³è½¬)
        &lt;/a&gt;
        &lt;a href="https://vuejs.org" @click.prevent="handlePreventLinkClick" class="link prevent-link"&gt;
          ä½¿ç”¨ .prevent (ä¸ä¼šè·³è½¬)
        &lt;/a&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="event-logs"&gt;
      &lt;h3&gt;äº‹ä»¶è§¦å‘æ—¥å¿—:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const username = ref('')
const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
  if (logs.value.length &gt; 8) {
    logs.value.pop()
  }
}

const handleFormSubmit = (event) =&gt; {
  addLog('ğŸ“ è¡¨å•æäº¤ (é¡µé¢ä¼šåˆ·æ–°)')
  // è¿™é‡Œå¯ä»¥æ·»åŠ è¡¨å•éªŒè¯ç­‰é€»è¾‘
}

const handlePreventSubmit = () =&gt; {
  addLog('ğŸ›‘ è¡¨å•æäº¤ (ä½¿ç”¨ .preventï¼Œé¡µé¢ä¸ä¼šåˆ·æ–°)')
  // åœ¨è¿™é‡Œå¤„ç† AJAX æäº¤ç­‰é€»è¾‘
  if (username.value) {
    addLog(`âœ… æäº¤ç”¨æˆ·å: ${username.value}`)
  }
}

const handleLinkClick = () =&gt; {
  addLog('ğŸ”— é“¾æ¥ç‚¹å‡» (ä¼šè·³è½¬åˆ° Vue.js å®˜ç½‘)')
}

const handlePreventLinkClick = () =&gt; {
  addLog('ğŸš« é“¾æ¥ç‚¹å‡» (ä½¿ç”¨ .preventï¼Œä¸ä¼šè·³è½¬)')
  // å¯ä»¥åœ¨è¿™é‡Œå¤„ç†è·¯ç”±è·³è½¬ç­‰é€»è¾‘
}
&lt;/script&gt;

&lt;style scoped&gt;
.prevent-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.form-group, .link-group {
  margin: 30px 0;
  padding: 25px;
  background: #f8f9fa;
  border-radius: 8px;
}

.form-group h3, .link-group h3 {
  margin: 0 0 15px 0;
  color: #333;
}

.prevent-form {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
}

.form-input {
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 4px;
  flex: 1;
  min-width: 200px;
}

.btn {
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.btn:first-of-type {
  background: #2196f3;
  color: white;
}

.prevent-btn {
  background: #ff5722;
  color: white;
}

.btn:hover {
  opacity: 0.9;
}

.link-group {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.link {
  padding: 12px 20px;
  background: #e3f2fd;
  border: 1px solid #2196f3;
  border-radius: 4px;
  text-decoration: none;
  color: #1976d2;
  text-align: center;
  transition: background 0.3s;
}

.prevent-link {
  background: #ffebee;
  border-color: #f44336;
  color: #d32f2f;
}

.link:hover {
  background: #bbdefb;
}

.prevent-link:hover {
  background: #ffcdd2;
}

.log-item {
  padding: 10px 15px;
  margin: 5px 0;
  background: white;
  border-radius: 4px;
  border-left: 4px solid #2196f3;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-15"><strong>äº”ã€ æŒ‰é”®ä¿®é¥°ç¬¦è¯¦è§£</strong></h2>
<h3 data-id="heading-16"><strong>5.1 å¸¸ç”¨æŒ‰é”®ä¿®é¥°ç¬¦</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="key-modifier-demo"&gt;
    &lt;h2&gt;æŒ‰é”®ä¿®é¥°ç¬¦ - é”®ç›˜äº‹ä»¶å¤„ç†&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;div class="input-group"&gt;
        &lt;h3&gt;è¾“å…¥æ¡†æŒ‰é”®äº‹ä»¶&lt;/h3&gt;
        &lt;input 
          v-model="inputText"
          @keyup.enter="handleEnter"
          @keyup.tab="handleTab"
          @keyup.delete="handleDelete"
          @keyup.esc="handleEsc"
          @keyup.space="handleSpace"
          placeholder="å°è¯•æŒ‰ Enterã€Tabã€Deleteã€Escã€Space é”®"
          class="key-input"
        /&gt;
      &lt;/div&gt;
      
      &lt;div class="arrow-group"&gt;
        &lt;h3&gt;æ–¹å‘é”®æ§åˆ¶&lt;/h3&gt;
        &lt;div class="arrow-controls"&gt;
          &lt;div class="arrow-row"&gt;
            &lt;button @keyup.up="handleUp" class="arrow-btn up"&gt;â†‘&lt;/button&gt;
          &lt;/div&gt;
          &lt;div class="arrow-row"&gt;
            &lt;button @keyup.left="handleLeft" class="arrow-btn left"&gt;â†&lt;/button&gt;
            &lt;button @keyup.down="handleDown" class="arrow-btn down"&gt;â†“&lt;/button&gt;
            &lt;button @keyup.right="handleRight" class="arrow-btn right"&gt;â†’&lt;/button&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;p&gt;ç‚¹å‡»æŒ‰é’®åæŒ‰æ–¹å‘é”®æµ‹è¯•&lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="key-logs"&gt;
      &lt;h3&gt;æŒ‰é”®äº‹ä»¶æ—¥å¿—:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const inputText = ref('')
const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
  if (logs.value.length &gt; 10) {
    logs.value.pop()
  }
}

const handleEnter = (event) =&gt; {
  addLog('â†µ Enter é”®è¢«æŒ‰ä¸‹')
  if (inputText.value.trim()) {
    addLog(`ğŸ’¾ ä¿å­˜å†…å®¹: "${inputText.value}"`)
    inputText.value = ''
  }
}

const handleTab = () =&gt; {
  addLog('â†¹ Tab é”®è¢«æŒ‰ä¸‹')
}

const handleDelete = () =&gt; {
  addLog('âŒ« Delete é”®è¢«æŒ‰ä¸‹')
}

const handleEsc = () =&gt; {
  addLog('â‹ Esc é”®è¢«æŒ‰ä¸‹ - å–æ¶ˆæ“ä½œ')
  inputText.value = ''
}

const handleSpace = () =&gt; {
  addLog('â£ Space é”®è¢«æŒ‰ä¸‹')
}

const handleUp = () =&gt; {
  addLog('â†‘ ä¸Šæ–¹å‘é”® - å‘ä¸Šç§»åŠ¨')
}

const handleDown = () =&gt; {
  addLog('â†“ ä¸‹æ–¹å‘é”® - å‘ä¸‹ç§»åŠ¨')
}

const handleLeft = () =&gt; {
  addLog('â† å·¦æ–¹å‘é”® - å‘å·¦ç§»åŠ¨')
}

const handleRight = () =&gt; {
  addLog('â†’ å³æ–¹å‘é”® - å‘å³ç§»åŠ¨')
}
&lt;/script&gt;

&lt;style scoped&gt;
.key-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.input-group, .arrow-group {
  margin: 30px 0;
  padding: 25px;
  background: #f8f9fa;
  border-radius: 8px;
}

.input-group h3, .arrow-group h3 {
  margin: 0 0 15px 0;
  color: #333;
}

.key-input {
  width: 100%;
  padding: 12px;
  border: 2px solid #ddd;
  border-radius: 6px;
  font-size: 16px;
  transition: border-color 0.3s;
}

.key-input:focus {
  outline: none;
  border-color: #2196f3;
}

.arrow-controls {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.arrow-row {
  display: flex;
  gap: 10px;
  justify-content: center;
}

.arrow-btn {
  width: 60px;
  height: 60px;
  border: 2px solid #666;
  border-radius: 8px;
  background: white;
  font-size: 20px;
  cursor: pointer;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.arrow-btn:focus {
  outline: none;
  background: #e3f2fd;
  border-color: #2196f3;
}

.arrow-btn:hover {
  transform: scale(1.1);
}

.up { border-color: #4caf50; color: #4caf50; }
.down { border-color: #2196f3; color: #2196f3; }
.left { border-color: #ff9800; color: #ff9800; }
.right { border-color: #9c27b0; color: #9c27b0; }

.arrow-group p {
  text-align: center;
  margin: 15px 0 0 0;
  color: #666;
  font-style: italic;
}

.key-logs {
  margin-top: 30px;
  padding: 20px;
  background: #2c3e50;
  border-radius: 8px;
  color: white;
}

.key-logs h3 {
  margin: 0 0 15px 0;
  color: #42b883;
}

.log-item {
  padding: 10px 15px;
  margin: 5px 0;
  background: #34495e;
  border-radius: 4px;
  border-left: 4px solid #42b883;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-17"><strong>5.2 ç³»ç»Ÿä¿®é¥°ç¬¦</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="system-modifier-demo"&gt;
    &lt;h2&gt;ç³»ç»Ÿä¿®é¥°ç¬¦ - ç»„åˆé”®å¤„ç†&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;div class="modifier-group"&gt;
        &lt;h3&gt;ç³»ç»Ÿä¿®é¥°ç¬¦æµ‹è¯•&lt;/h3&gt;
        &lt;div class="key-combinations"&gt;
          &lt;div class="key-item" @click.ctrl="handleCtrlClick"&gt;
            Ctrl + ç‚¹å‡»
          &lt;/div&gt;
          &lt;div class="key-item" @click.alt="handleAltClick"&gt;
            Alt + ç‚¹å‡»
          &lt;/div&gt;
          &lt;div class="key-item" @click.shift="handleShiftClick"&gt;
            Shift + ç‚¹å‡»
          &lt;/div&gt;
          &lt;div class="key-item" @click.meta="handleMetaClick"&gt;
            Meta (Cmd) + ç‚¹å‡»
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;div class="exact-modifier"&gt;
        &lt;h3&gt;.exact ä¿®é¥°ç¬¦ - ç²¾ç¡®åŒ¹é…&lt;/h3&gt;
        &lt;div class="exact-combinations"&gt;
          &lt;button @click="handleAnyClick" class="exact-btn"&gt;
            ä»»æ„ç‚¹å‡»
          &lt;/button&gt;
          &lt;button @click.ctrl="handleCtrlOnlyClick" class="exact-btn"&gt;
            Ctrl + ç‚¹å‡»
          &lt;/button&gt;
          &lt;button @click.ctrl.exact="handleExactCtrlClick" class="exact-btn exact"&gt;
            .exact Ctrl (ä»… Ctrl)
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="system-logs"&gt;
      &lt;h3&gt;ç³»ç»Ÿä¿®é¥°ç¬¦äº‹ä»¶æ—¥å¿—:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
  if (logs.value.length &gt; 8) {
    logs.value.pop()
  }
}

const handleCtrlClick = () =&gt; {
  addLog('ğŸ›ï¸ Ctrl + ç‚¹å‡»')
}

const handleAltClick = () =&gt; {
  addLog('â‡ Alt + ç‚¹å‡»')
}

const handleShiftClick = () =&gt; {
  addLog('â‡§ Shift + ç‚¹å‡»')
}

const handleMetaClick = () =&gt; {
  addLog('âŒ˜ Meta (Cmd) + ç‚¹å‡»')
}

const handleAnyClick = () =&gt; {
  addLog('ğŸ”„ ä»»æ„ç‚¹å‡» (æ— ä¿®é¥°ç¬¦)')
}

const handleCtrlOnlyClick = () =&gt; {
  addLog('ğŸ›ï¸ Ctrl + ç‚¹å‡» (å¯èƒ½åŒ…å«å…¶ä»–ä¿®é¥°ç¬¦)')
}

const handleExactCtrlClick = () =&gt; {
  addLog('ğŸ›ï¸ .exact Ctrl + ç‚¹å‡» (ä»… Ctrlï¼Œæ— å…¶ä»–ä¿®é¥°ç¬¦)')
}
&lt;/script&gt;

&lt;style scoped&gt;
.system-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.modifier-group, .exact-modifier {
  margin: 30px 0;
  padding: 25px;
  background: #f8f9fa;
  border-radius: 8px;
}

.modifier-group h3, .exact-modifier h3 {
  margin: 0 0 15px 0;
  color: #333;
}

.key-combinations {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 15px;
}

.key-item {
  padding: 20px;
  background: white;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s;
  font-weight: bold;
}

.key-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.key-item:nth-child(1) { border-color: #2196f3; color: #2196f3; }
.key-item:nth-child(2) { border-color: #ff9800; color: #ff9800; }
.key-item:nth-child(3) { border-color: #4caf50; color: #4caf50; }
.key-item:nth-child(4) { border-color: #9c27b0; color: #9c27b0; }

.exact-combinations {
  display: flex;
  gap: 15px;
  flex-wrap: wrap;
}

.exact-btn {
  padding: 12px 20px;
  border: 2px solid #666;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.3s;
}

.exact-btn:hover {
  background: #f5f5f5;
}

.exact-btn.exact {
  border-color: #e91e63;
  color: #e91e63;
  font-weight: bold;
}

.system-logs {
  margin-top: 30px;
  padding: 20px;
  background: #2c3e50;
  border-radius: 8px;
  color: white;
}

.system-logs h3 {
  margin: 0 0 15px 0;
  color: #42b883;
}

.log-item {
  padding: 10px 15px;
  margin: 5px 0;
  background: #34495e;
  border-radius: 4px;
  border-left: 4px solid #42b883;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-18"><strong>å…­ã€ é¼ æ ‡æŒ‰é”®ä¿®é¥°ç¬¦</strong></h2>
<h3 data-id="heading-19"><strong>6.1 é¼ æ ‡æŒ‰é”®ä¿®é¥°ç¬¦ä½¿ç”¨</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="mouse-modifier-demo"&gt;
    &lt;h2&gt;é¼ æ ‡æŒ‰é”®ä¿®é¥°ç¬¦&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;div class="mouse-test-area"&gt;
        &lt;div 
          class="click-zone"
          @click.left="handleLeftClick"
          @click.middle="handleMiddleClick"
          @click.right="handleRightClick"
        &gt;
          &lt;p&gt;åœ¨æ­¤åŒºåŸŸæµ‹è¯•é¼ æ ‡æŒ‰é”®ï¼š&lt;/p&gt;
          &lt;ul&gt;
            &lt;li&gt;å·¦é”®ç‚¹å‡» - æ­£å¸¸ç‚¹å‡»&lt;/li&gt;
            &lt;li&gt;ä¸­é”®ç‚¹å‡» - é¼ æ ‡æ»šè½®ç‚¹å‡»&lt;/li&gt;
            &lt;li&gt;å³é”®ç‚¹å‡» - å¼¹å‡ºä¸Šä¸‹æ–‡èœå•&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;div class="context-menu-info"&gt;
        &lt;p&gt;&lt;strong&gt;æ³¨æ„ï¼š&lt;/strong&gt;å³é”®ç‚¹å‡»æ—¶ï¼Œä½¿ç”¨ &lt;code&gt;.prevent&lt;/code&gt; å¯ä»¥é˜»æ­¢æµè§ˆå™¨é»˜è®¤çš„ä¸Šä¸‹æ–‡èœå•ï¼š&lt;/p&gt;
        &lt;div 
          class="prevent-context-zone"
          @click.right.prevent="handlePreventRightClick"
        &gt;
          å³é”®ç‚¹å‡»è¿™é‡Œä¸ä¼šæ˜¾ç¤ºæµè§ˆå™¨èœå•
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="mouse-logs"&gt;
      &lt;h3&gt;é¼ æ ‡äº‹ä»¶æ—¥å¿—:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
  if (logs.value.length &gt; 6) {
    logs.value.pop()
  }
}

const handleLeftClick = () =&gt; {
  addLog('ğŸ–±ï¸ é¼ æ ‡å·¦é”®ç‚¹å‡»')
}

const handleMiddleClick = () =&gt; {
  addLog('ğŸ¯ é¼ æ ‡ä¸­é”®ç‚¹å‡»')
}

const handleRightClick = (event) =&gt; {
  addLog('ğŸ“‹ é¼ æ ‡å³é”®ç‚¹å‡» (ä¼šæ˜¾ç¤ºæµè§ˆå™¨ä¸Šä¸‹æ–‡èœå•)')
}

const handlePreventRightClick = () =&gt; {
  addLog('ğŸš« é¼ æ ‡å³é”®ç‚¹å‡» (ä½¿ç”¨ .preventï¼Œä¸æ˜¾ç¤ºæµè§ˆå™¨èœå•)')
  // å¯ä»¥åœ¨è¿™é‡Œæ˜¾ç¤ºè‡ªå®šä¹‰ä¸Šä¸‹æ–‡èœå•
}
&lt;/script&gt;

&lt;style scoped&gt;
.mouse-modifier-demo {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.mouse-test-area {
  margin: 30px 0;
  padding: 25px;
  background: #f8f9fa;
  border-radius: 8px;
}

.click-zone {
  padding: 40px;
  background: white;
  border: 3px dashed #2196f3;
  border-radius: 8px;
  text-align: center;
  cursor: pointer;
  transition: background 0.3s;
}

.click-zone:hover {
  background: #e3f2fd;
}

.click-zone p {
  margin: 0 0 15px 0;
  font-weight: bold;
  color: #1976d2;
}

.click-zone ul {
  text-align: left;
  display: inline-block;
  margin: 0;
  color: #333;
}

.click-zone li {
  margin: 8px 0;
}

.context-menu-info {
  margin: 30px 0;
  padding: 25px;
  background: #fff3e0;
  border-radius: 8px;
}

.context-menu-info p {
  margin: 0 0 15px 0;
  color: #e65100;
}

.prevent-context-zone {
  padding: 20px;
  background: #ffebee;
  border: 2px solid #f44336;
  border-radius: 6px;
  text-align: center;
  cursor: pointer;
  font-weight: bold;
  color: #d32f2f;
}

.mouse-logs {
  margin-top: 30px;
  padding: 20px;
  background: #2c3e50;
  border-radius: 8px;
  color: white;
}

.mouse-logs h3 {
  margin: 0 0 15px 0;
  color: #42b883;
}

.log-item {
  padding: 10px 15px;
  margin: 5px 0;
  background: #34495e;
  border-radius: 4px;
  border-left: 4px solid #42b883;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-20"><strong>ä¸ƒã€ äº‹ä»¶ä¿®é¥°ç¬¦çš„ç»„åˆä½¿ç”¨</strong></h2>
<h3 data-id="heading-21"><strong>7.1 ä¿®é¥°ç¬¦é“¾å¼è°ƒç”¨</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="combined-modifier-demo"&gt;
    &lt;h2&gt;äº‹ä»¶ä¿®é¥°ç¬¦ç»„åˆä½¿ç”¨&lt;/h2&gt;
    
    &lt;div class="demo-area"&gt;
      &lt;div class="combination-examples"&gt;
        &lt;div class="example"&gt;
          &lt;h3&gt;1. é˜»æ­¢å†’æ³¡ + é˜»æ­¢é»˜è®¤è¡Œä¸º&lt;/h3&gt;
          &lt;a 
            href="#"
            @click.prevent.stop="handlePreventStop"
            class="combined-link"
          &gt;
            @click.prevent.stop
          &lt;/a&gt;
          &lt;p&gt;æ—¢é˜»æ­¢é“¾æ¥è·³è½¬ï¼Œåˆé˜»æ­¢äº‹ä»¶å†’æ³¡&lt;/p&gt;
        &lt;/div&gt;
        
        &lt;div class="example"&gt;
          &lt;h3&gt;2. æ•è·é˜¶æ®µ + åªè§¦å‘ä¸€æ¬¡&lt;/h3&gt;
          &lt;div 
            @click.capture.once="handleCaptureOnce"
            class="capture-once-box"
          &gt;
            @click.capture.once
            &lt;button&gt;å†…éƒ¨æŒ‰é’®&lt;/button&gt;
          &lt;/div&gt;
          &lt;p&gt;åœ¨æ•è·é˜¶æ®µè§¦å‘ï¼Œä¸”åªè§¦å‘ä¸€æ¬¡&lt;/p&gt;
        &lt;/div&gt;
        
        &lt;div class="example"&gt;
          &lt;h3&gt;3. ç²¾ç¡®ç»„åˆé”® + é˜»æ­¢é»˜è®¤&lt;/h3&gt;
          &lt;button 
            @keydown.ctrl.exact.prevent="handleExactCtrlPrevent"
            class="exact-ctrl-btn"
          &gt;
            èšç„¦åæŒ‰ Ctrl (ç²¾ç¡®)
          &lt;/button&gt;
          &lt;p&gt;ç²¾ç¡®åŒ¹é… Ctrl é”®ï¼Œé˜»æ­¢é»˜è®¤è¡Œä¸º&lt;/p&gt;
        &lt;/div&gt;
        
        &lt;div class="example"&gt;
          &lt;h3&gt;4. è‡ªèº«æ£€æŸ¥ + é˜»æ­¢å†’æ³¡&lt;/h3&gt;
          &lt;div 
            @click.self.stop="handleSelfStop"
            class="self-stop-box"
          &gt;
            @click.self.stop
            &lt;button&gt;ç‚¹å‡»æŒ‰é’®ä¸ä¼šè§¦å‘&lt;/button&gt;
          &lt;/div&gt;
          &lt;p&gt;åªæœ‰ç‚¹å‡»å®¹å™¨æœ¬èº«æ‰è§¦å‘ï¼Œå¹¶é˜»æ­¢å†’æ³¡&lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="combination-logs"&gt;
      &lt;h3&gt;ç»„åˆä¿®é¥°ç¬¦äº‹ä»¶æ—¥å¿—:&lt;/h3&gt;
      &lt;div v-for="(log, index) in logs" :key="index" class="log-item"&gt;
        {{ log }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const logs = ref([])

const addLog = (message) =&gt; {
  const timestamp = new Date().toLocaleTimeString()
  logs.value.unshift(`[${timestamp}] ${message}`)
  if (logs.value.length &gt; 8) {
    logs.value.pop()
  }
}

const handlePreventStop = () =&gt; {
  addLog('ğŸ”— prevent.stop: é˜»æ­¢è·³è½¬å’Œå†’æ³¡')
}

const handleCaptureOnce = () =&gt; {
  addLog('ğŸ¯ capture.once: æ•è·é˜¶æ®µè§¦å‘ï¼Œåªè§¦å‘ä¸€æ¬¡')
}

const handleExactCtrlPrevent = (event) =&gt; {
  addLog('âŒ¨ï¸ ctrl.exact.prevent: ç²¾ç¡® Ctrlï¼Œé˜»æ­¢é»˜è®¤è¡Œä¸º')
  event.preventDefault()
}

const handleSelfStop = () =&gt; {
  addLog('ğŸ¯ self.stop: ä»…è‡ªèº«è§¦å‘ï¼Œé˜»æ­¢å†’æ³¡')
}
&lt;/script&gt;

&lt;style scoped&gt;
.combined-modifier-demo {
  padding: 20px;
  max-width: 1000px;
  margin: 0 auto;
}

.combination-examples {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin: 30px 0;
}

.example {
  padding: 20px;
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #e9ecef;
}

.example h3 {
  margin: 0 0 15px 0;
  color: #333;
  font-size: 16px;
}

.example p {
  margin: 10px 0 0 0;
  color: #666;
  font-size: 14px;
  font-style: italic;
}

.combined-link {
  display: block;
  padding: 12px;
  background: #e3f2fd;
  border: 2px solid #2196f3;
  border-radius: 6px;
  text-decoration: none;
  color: #1976d2;
  text-align: center;
  font-weight: bold;
  transition: background 0.3s;
}

.combined-link:hover {
  background: #bbdefb;
}

.capture-once-box {
  padding: 20px;
  background: #fff3e0;
  border: 2px solid #ff9800;
  border-radius: 6px;
  text-align: center;
  cursor: pointer;
  font-weight: bold;
  color: #e65100;
}

.capture-once-box button {
  margin-top: 10px;
  padding: 8px 16px;
  background: #ff9800;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.exact-ctrl-btn {
  width: 100%;
  padding: 12px;
  background: #fce4ec;
  border: 2px solid #e91e63;
  border-radius: 6px;
  color: #c2185b;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s;
}

.exact-ctrl-btn:focus {
  outline: none;
  background: #f8bbd9;
}

.self-stop-box {
  padding: 20px;
  background: #e8f5e8;
  border: 2px solid #4caf50;
  border-radius: 6px;
  text-align: center;
  cursor: pointer;
  font-weight: bold;
  color: #2e7d32;
}

.self-stop-box button {
  margin-top: 10px;
  padding: 8px 16px;
  background: #4caf50;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.combination-logs {
  margin-top: 30px;
  padding: 20px;
  background: #2c3e50;
  border-radius: 8px;
  color: white;
}

.combination-logs h3 {
  margin: 0 0 15px 0;
  color: #42b883;
}

.log-item {
  padding: 10px 15px;
  margin: 5px 0;
  background: #34495e;
  border-radius: 4px;
  border-left: 4px solid #42b883;
  font-family: 'Courier New', monospace;
  font-size: 14px;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-22"><strong>å…«ã€ æœ€ä½³å®è·µå’Œæ³¨æ„äº‹é¡¹</strong></h2>
<h3 data-id="heading-23"><strong>8.1 äº‹ä»¶ä¿®é¥°ç¬¦æœ€ä½³å®è·µ</strong></h3>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="best-practices-demo"&gt;
    &lt;h2&gt;äº‹ä»¶ä¿®é¥°ç¬¦æœ€ä½³å®è·µ&lt;/h2&gt;
    
    &lt;div class="practices"&gt;
      &lt;div class="practice-item good"&gt;
        &lt;h3&gt;âœ… æ¨èåšæ³•&lt;/h3&gt;
        &lt;div class="code-example"&gt;
          &lt;pre&gt;&lt;code&gt;&amp;lt;!-- æ¸…æ™°çš„ä¿®é¥°ç¬¦é¡ºåº --&amp;gt;
&amp;lt;form @submit.prevent.stop="handleSubmit"&amp;gt;
&amp;lt;!-- é€‚å½“çš„ä¿®é¥°ç¬¦ç»„åˆ --&amp;gt;
&amp;lt;a @click.prevent="handleLinkClick"&amp;gt;
&amp;lt;!-- ä½¿ç”¨ .exact ç²¾ç¡®æ§åˆ¶ --&amp;gt;
&amp;lt;button @keyup.ctrl.exact="handleExactCtrl"&amp;gt;&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      
      &lt;div class="practice-item bad"&gt;
        &lt;h3&gt;âŒ é¿å…åšæ³•&lt;/h3&gt;
        &lt;div class="code-example"&gt;
          &lt;pre&gt;&lt;code&gt;&amp;lt;!-- è¿‡åº¦ä½¿ç”¨ä¿®é¥°ç¬¦ --&amp;gt;
&amp;lt;button @click.prevent.stop.self="handleClick"&amp;gt;
&amp;lt;!-- æ··æ·†çš„ä¿®é¥°ç¬¦é¡ºåº --&amp;gt;
&amp;lt;form @submit.stop.prevent="handleSubmit"&amp;gt;
&amp;lt;!-- ä¸å¿…è¦çš„ä¿®é¥°ç¬¦ --&amp;gt;
&amp;lt;div @click.self.prevent="handleClick"&amp;gt;&lt;/code&gt;&lt;/pre&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="performance-tips"&gt;
      &lt;h3&gt;æ€§èƒ½æç¤º&lt;/h3&gt;
      &lt;ul&gt;
        &lt;li&gt;ä½¿ç”¨ &lt;code&gt;.passive&lt;/code&gt; æ”¹å–„æ»šåŠ¨æ€§èƒ½ï¼Œç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯&lt;/li&gt;
        &lt;li&gt;é¿å…åœ¨é¢‘ç¹è§¦å‘çš„äº‹ä»¶ä¸Šä½¿ç”¨å¤æ‚çš„ä¿®é¥°ç¬¦ç»„åˆ&lt;/li&gt;
        &lt;li&gt;ä½¿ç”¨ &lt;code&gt;.once&lt;/code&gt; æ¸…ç†ä¸éœ€è¦æŒç»­ç›‘å¬çš„äº‹ä»¶&lt;/li&gt;
        &lt;li&gt;åˆç†ä½¿ç”¨ &lt;code&gt;.prevent&lt;/code&gt; é¿å…ä¸å¿…è¦çš„é»˜è®¤è¡Œä¸ºé˜»æ­¢&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;

    &lt;div class="accessibility-considerations"&gt;
      &lt;h3&gt;å¯è®¿é—®æ€§è€ƒè™‘&lt;/h3&gt;
      &lt;ul&gt;
        &lt;li&gt;ç¡®ä¿é”®ç›˜å¯¼èˆªæ”¯æŒæ‰€æœ‰äº¤äº’åŠŸèƒ½&lt;/li&gt;
        &lt;li&gt;ä½¿ç”¨é€‚å½“çš„ ARIA æ ‡ç­¾æè¿°äº¤äº’è¡Œä¸º&lt;/li&gt;
        &lt;li&gt;æµ‹è¯•å±å¹•é˜…è¯»å™¨å…¼å®¹æ€§&lt;/li&gt;
        &lt;li&gt;æä¾›é”®ç›˜å¿«æ·é”®çš„è§†è§‰æç¤º&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
// æœ€ä½³å®è·µç¤ºä¾‹ä»£ç 
const handleSubmit = () =&gt; {
  console.log('è¡¨å•æäº¤å¤„ç†')
}

const handleLinkClick = () =&gt; {
  console.log('é“¾æ¥ç‚¹å‡»å¤„ç†')
}

const handleExactCtrl = () =&gt; {
  console.log('ç²¾ç¡® Ctrl é”®å¤„ç†')
}
&lt;/script&gt;

&lt;style scoped&gt;
.best-practices-demo {
  padding: 20px;
  max-width: 900px;
  margin: 0 auto;
}

.practices {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  margin: 30px 0;
}

.practice-item {
  padding: 25px;
  border-radius: 8px;
}

.practice-item.good {
  background: #e8f5e8;
  border: 2px solid #4caf50;
}

.practice-item.bad {
  background: #ffebee;
  border: 2px solid #f44336;
}

.practice-item h3 {
  margin: 0 0 15px 0;
  color: inherit;
}

.code-example {
  background: white;
  border-radius: 6px;
  padding: 15px;
  overflow-x: auto;
}

.code-example pre {
  margin: 0;
  font-family: 'Courier New', monospace;
  font-size: 14px;
  line-height: 1.4;
}

.performance-tips, .accessibility-considerations {
  margin: 30px 0;
  padding: 25px;
  background: #e3f2fd;
  border-radius: 8px;
}

.performance-tips h3, .accessibility-considerations h3 {
  margin: 0 0 15px 0;
  color: #1976d2;
}

.performance-tips ul, .accessibility-considerations ul {
  margin: 0;
  color: #333;
}

.performance-tips li, .accessibility-considerations li {
  margin: 8px 0;
}

.performance-tips code, .accessibility-considerations code {
  background: #fff;
  padding: 2px 6px;
  border-radius: 3px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
}
&lt;/style&gt;
</code></pre>
<hr/>
<h2 data-id="heading-24"><strong>ä¹ã€ æ€»ç»“</strong></h2>
<h3 data-id="heading-25"><strong>9.1 äº‹ä»¶ä¿®é¥°ç¬¦æ ¸å¿ƒä»·å€¼</strong></h3>
<ol>
<li><strong>å£°æ˜å¼ç¼–ç¨‹</strong>ï¼šä»¥å£°æ˜çš„æ–¹å¼è¡¨è¾¾äº‹ä»¶è¡Œä¸ºæ„å›¾</li>
<li><strong>ä»£ç ç®€æ´</strong>ï¼šå‡å°‘æ ·æ¿ä»£ç ï¼Œæé«˜å¼€å‘æ•ˆç‡</li>
<li><strong>å¯è¯»æ€§å¼º</strong>ï¼šä»£ç æ„å›¾ä¸€ç›®äº†ç„¶</li>
<li><strong>ç»´æŠ¤æ–¹ä¾¿</strong>ï¼šä¿®æ”¹äº‹ä»¶è¡Œä¸ºåªéœ€æ”¹åŠ¨æ¨¡æ¿</li>
</ol>
<h3 data-id="heading-26"><strong>9.2 äº‹ä»¶ä¿®é¥°ç¬¦åˆ†ç±»æ€»ç»“</strong></h3>













































<table><thead><tr><th>ç±»åˆ«</th><th>ä¸»è¦ä¿®é¥°ç¬¦</th><th>ä½¿ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td><strong>äº‹ä»¶ä¼ æ’­</strong></td><td><code>.stop</code> <code>.capture</code> <code>.self</code></td><td>æ§åˆ¶äº‹ä»¶ä¼ æ’­æµç¨‹</td></tr><tr><td><strong>é»˜è®¤è¡Œä¸º</strong></td><td><code>.prevent</code> <code>.passive</code></td><td>ç®¡ç†æµè§ˆå™¨é»˜è®¤è¡Œä¸º</td></tr><tr><td><strong>æŒ‰é”®å¤„ç†</strong></td><td><code>.enter</code> <code>.tab</code> <code>.esc</code> ç­‰</td><td>é”®ç›˜äº¤äº’å¤„ç†</td></tr><tr><td><strong>ç³»ç»Ÿä¿®é¥°</strong></td><td><code>.ctrl</code> <code>.alt</code> <code>.shift</code> <code>.meta</code></td><td>ç»„åˆé”®æ“ä½œ</td></tr><tr><td><strong>ç²¾ç¡®æ§åˆ¶</strong></td><td><code>.exact</code></td><td>ç²¾ç¡®åŒ¹é…ä¿®é¥°ç¬¦</td></tr><tr><td><strong>é¼ æ ‡æŒ‰é”®</strong></td><td><code>.left</code> <code>.right</code> <code>.middle</code></td><td>åŒºåˆ†é¼ æ ‡æŒ‰é”®</td></tr><tr><td><strong>æ¬¡æ•°æ§åˆ¶</strong></td><td><code>.once</code></td><td>ä¸€æ¬¡æ€§äº‹ä»¶å¤„ç†</td></tr></tbody></table>
<h3 data-id="heading-27"><strong>9.3 æœ€ä½³å®è·µè¦ç‚¹</strong></h3>
<ol>
<li><strong>åˆç†æ’åº</strong>ï¼šæŒ‰ç…§ <code>.capture</code> â†’ <code>.once</code> â†’ <code>.passive</code> â†’ <code>.prevent</code> â†’ <code>.stop</code> â†’ <code>.self</code> çš„é¡ºåº</li>
<li><strong>é€‚åº¦ä½¿ç”¨</strong>ï¼šé¿å…è¿‡åº¦å¤æ‚çš„ä¿®é¥°ç¬¦ç»„åˆ</li>
<li><strong>æ€§èƒ½è€ƒè™‘</strong>ï¼šåœ¨é¢‘ç¹äº‹ä»¶ä¸Šä½¿ç”¨ <code>.passive</code></li>
<li><strong>å¯è®¿é—®æ€§</strong>ï¼šç¡®ä¿é”®ç›˜å¯¼èˆªæ”¯æŒæ‰€æœ‰åŠŸèƒ½</li>
</ol>
<p>Vue3 çš„äº‹ä»¶ä¿®é¥°ç¬¦æä¾›äº†ä¸€ç§ä¼˜é›…è€Œå¼ºå¤§çš„æ–¹å¼æ¥å¤„ç† DOM äº‹ä»¶ç»†èŠ‚ï¼Œé€šè¿‡åˆç†ä½¿ç”¨è¿™äº›ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ç¼–å†™å‡ºæ›´åŠ ç®€æ´ã€å¯è¯»å’Œå¯ç»´æŠ¤çš„ Vue ä»£ç ã€‚</p>
<hr/>
<p><strong>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—å’Œè¯„è®ºï¼æœ‰ä»»ä½•é—®é¢˜éƒ½å¯ä»¥åœ¨è¯„è®ºåŒºè®¨è®ºã€‚</strong><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef718a75b62649738f88308c0f318cfa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YyX6L6wYWxr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766305192&amp;x-signature=4PXK8r0ZM2VD4ygksahOwBJydNU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vue3 æœåŠ¡ç«¯æ¸²æŸ“ (SSR) æ·±åº¦è§£æï¼šä»åŸç†åˆ°å®è·µçš„å®Œæ•´æŒ‡å—]]></title>    <link>https://juejin.cn/post/7583325044233568282</link>    <guid>https://juejin.cn/post/7583325044233568282</guid>    <pubDate>2025-12-14T08:44:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583325044233568282" data-draft-id="7583325044233551898" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vue3 æœåŠ¡ç«¯æ¸²æŸ“ (SSR) æ·±åº¦è§£æï¼šä»åŸç†åˆ°å®è·µçš„å®Œæ•´æŒ‡å—"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2025-12-14T08:44:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŒ—è¾°alk"/> <meta itemprop="url" content="https://juejin.cn/user/1772855673241352"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vue3 æœåŠ¡ç«¯æ¸²æŸ“ (SSR) æ·±åº¦è§£æï¼šä»åŸç†åˆ°å®è·µçš„å®Œæ•´æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1772855673241352/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŒ—è¾°alk
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:44:21.000Z" title="Sun Dec 14 2025 08:44:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"><strong>æ‘˜è¦</strong></h2>
<p>æœåŠ¡ç«¯æ¸²æŸ“ (SSR) æ˜¯ç°ä»£ Web åº”ç”¨æå‡æ€§èƒ½ã€SEO å’Œç”¨æˆ·ä½“éªŒçš„å…³é”®æŠ€æœ¯ã€‚Vue3 æä¾›äº†å…¨æ–°çš„æœåŠ¡ç«¯æ¸²æŸ“æ¶æ„ï¼Œå…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€æ›´ç®€æ´çš„ API å’Œæ›´å®Œå–„çš„ TypeScript æ”¯æŒã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ Vue3 SSR çš„å·¥ä½œåŸç†ã€æ ¸å¿ƒæ¦‚å¿µã€å®ç°æ–¹æ¡ˆï¼Œé€šè¿‡è¯¦ç»†çš„ä»£ç ç¤ºä¾‹ã€æ¶æ„å›¾å’Œæµç¨‹å›¾ï¼Œå¸®åŠ©ä½ å…¨é¢æŒæ¡ Vue3 æœåŠ¡ç«¯æ¸²æŸ“çš„å®Œæ•´çŸ¥è¯†ä½“ç³»ã€‚</p>
<hr/>
<h2 data-id="heading-1"><strong>ä¸€ã€ ä»€ä¹ˆæ˜¯æœåŠ¡ç«¯æ¸²æŸ“ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿ</strong></h2>
<h3 data-id="heading-2"><strong>1.1 å®¢æˆ·ç«¯æ¸²æŸ“ (CSR) çš„é—®é¢˜</strong></h3>
<p>åœ¨ä¼ ç»Ÿçš„ Vue å•é¡µé¢åº”ç”¨ (SPA) ä¸­ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Vue App<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- åˆå§‹ HTML æ˜¯ç©ºçš„ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p><strong>CSR çš„å·¥ä½œæµç¨‹ï¼š</strong></p>
<ol>
<li>æµè§ˆå™¨è¯·æ±‚ HTML</li>
<li>æœåŠ¡å™¨è¿”å›ç©ºçš„ HTML æ¨¡æ¿</li>
<li>æµè§ˆå™¨ä¸‹è½½ JavaScript æ–‡ä»¶</li>
<li>Vue åº”ç”¨åˆå§‹åŒ–ï¼Œæ¸²æŸ“é¡µé¢</li>
<li>ç”¨æˆ·çœ‹åˆ°å†…å®¹</li>
</ol>
<p><strong>å­˜åœ¨çš„é—®é¢˜ï¼š</strong></p>
<ul>
<li><strong>SEO ä¸å‹å¥½</strong>ï¼šæœç´¢å¼•æ“çˆ¬è™«éš¾ä»¥æŠ“å–åŠ¨æ€å†…å®¹</li>
<li><strong>é¦–å±åŠ è½½æ…¢</strong>ï¼šç”¨æˆ·éœ€è¦ç­‰å¾…æ‰€æœ‰ JS åŠ è½½æ‰§è¡Œå®Œæ‰èƒ½çœ‹åˆ°å†…å®¹</li>
<li><strong>ç™½å±æ—¶é—´é•¿</strong>ï¼šç‰¹åˆ«æ˜¯ç½‘ç»œæ¡ä»¶å·®çš„æƒ…å†µä¸‹</li>
</ul>
<h3 data-id="heading-3"><strong>1.2 æœåŠ¡ç«¯æ¸²æŸ“ (SSR) çš„ä¼˜åŠ¿</strong></h3>
<p><strong>SSR çš„å·¥ä½œæµç¨‹ï¼š</strong></p>
<ol>
<li>æµè§ˆå™¨è¯·æ±‚ HTML</li>
<li>æœåŠ¡å™¨æ‰§è¡Œ Vue åº”ç”¨ï¼Œç”Ÿæˆå®Œæ•´çš„ HTML</li>
<li>æµè§ˆå™¨ç«‹å³æ˜¾ç¤ºæ¸²æŸ“å¥½çš„å†…å®¹</li>
<li>Vue åº”ç”¨åœ¨å®¢æˆ·ç«¯"æ¿€æ´»"(Hydrate)ï¼Œå˜æˆå¯äº¤äº’çš„ SPA</li>
</ol>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p>
<ul>
<li><strong>æ›´å¥½çš„ SEO</strong>ï¼šæœç´¢å¼•æ“å¯ä»¥ç›´æ¥æŠ“å–å®Œæ•´çš„ HTML å†…å®¹</li>
<li><strong>æ›´å¿«çš„é¦–å±åŠ è½½</strong>ï¼šç”¨æˆ·ç«‹å³çœ‹åˆ°å†…å®¹ï¼Œæ— éœ€ç­‰å¾… JS ä¸‹è½½æ‰§è¡Œ</li>
<li><strong>æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ</strong>ï¼šå‡å°‘ç™½å±æ—¶é—´ï¼Œç‰¹åˆ«æ˜¯å¯¹äºæ…¢ç½‘ç»œç”¨æˆ·</li>
<li><strong>ç¤¾äº¤åˆ†äº«å‹å¥½</strong>ï¼šç¤¾äº¤åª’ä½“çˆ¬è™«å¯ä»¥æ­£ç¡®è·å–é¡µé¢å…ƒä¿¡æ¯</li>
</ul>
<hr/>
<h2 data-id="heading-4"><strong>äºŒã€ Vue3 SSR æ ¸å¿ƒæ¶æ„ä¸å·¥ä½œåŸç†</strong></h2>
<h3 data-id="heading-5"><strong>2.1 Vue3 SSR æ•´ä½“æ¶æ„</strong></h3>
<p><strong>æµç¨‹å›¾ï¼šVue3 SSR å®Œæ•´å·¥ä½œæµç¨‹</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[ç”¨æˆ·è®¿é—®URL] --&gt; B[æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚]
    B --&gt; C[åˆ›å»ºVueåº”ç”¨å®ä¾‹]
    C --&gt; D[è·¯ç”±åŒ¹é…]
    D --&gt; E[æ•°æ®é¢„å–&lt;br&gt;asyncData/pinia]
    E --&gt; F[æ¸²æŸ“HTMLå­—ç¬¦ä¸²]
    F --&gt; G[æ³¨å…¥çŠ¶æ€åˆ°HTML]
    G --&gt; H[è¿”å›å®Œæ•´HTMLç»™æµè§ˆå™¨]
    
    H --&gt; I[æµè§ˆå™¨æ˜¾ç¤ºé™æ€å†…å®¹]
    I --&gt; J[åŠ è½½å®¢æˆ·ç«¯JS]
    J --&gt; K[Hydrationæ¿€æ´»]
    K --&gt; L[å˜æˆå¯äº¤äº’SPA]
    L --&gt; M[åç»­è·¯ç”±åˆ‡æ¢ä¸ºCSR]
</code></pre>
<h3 data-id="heading-6"><strong>2.2 åŒæ„åº”ç”¨ (Isomorphic Application)</strong></h3>
<p>Vue3 SSR çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯"åŒæ„" - åŒä¸€å¥—ä»£ç åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ½èƒ½è¿è¡Œã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŒæ„ç»„ä»¶ - åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯éƒ½èƒ½è¿è¡Œ</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// è¿™ä¸ªç»„ä»¶åœ¨ä¸¤ä¸ªç¯å¢ƒéƒ½èƒ½æ‰§è¡Œ</span>
    <span class="hljs-keyword">const</span> data = <span class="hljs-title function_">ref</span>(<span class="hljs-string">'Hello SSR'</span>)
    <span class="hljs-keyword">return</span> { data }
  }
}
</code></pre>
<p><strong>å…³é”®æŒ‘æˆ˜ï¼š</strong></p>
<ol>
<li><strong>ç¯å¢ƒå·®å¼‚</strong>ï¼šNode.js vs æµè§ˆå™¨ç¯å¢ƒ</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸ</strong>ï¼šæœåŠ¡å™¨æ²¡æœ‰ DOMï¼Œåªæœ‰éƒ¨åˆ†ç”Ÿå‘½å‘¨æœŸ</li>
<li><strong>æ•°æ®çŠ¶æ€</strong>ï¼šæœåŠ¡å™¨é¢„å–çš„æ•°æ®éœ€è¦ä¼ é€’åˆ°å®¢æˆ·ç«¯</li>
<li><strong>è·¯ç”±åŒ¹é…</strong>ï¼šæœåŠ¡å™¨éœ€è¦æ ¹æ® URL åŒ¹é…å¯¹åº”ç»„ä»¶</li>
</ol>
<hr/>
<h2 data-id="heading-7"><strong>ä¸‰ã€ Vue3 SSR æ ¸å¿ƒ API è§£æ</strong></h2>
<h3 data-id="heading-8"><strong>3.1 <code>renderToString</code> - æ ¸å¿ƒæ¸²æŸ“å‡½æ•°</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { renderToString } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue/server-renderer'</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.js'</span>

<span class="hljs-comment">// æœåŠ¡å™¨æ¸²æŸ“å…¥å£</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">renderApp</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-comment">// 1. åˆ›å»º Vue åº”ç”¨å®ä¾‹</span>
  <span class="hljs-keyword">const</span> { app, router } = <span class="hljs-title function_">createApp</span>()
  
  <span class="hljs-comment">// 2. è®¾ç½®æœåŠ¡å™¨ç«¯è·¯ç”±</span>
  router.<span class="hljs-title function_">push</span>(url)
  <span class="hljs-keyword">await</span> router.<span class="hljs-title function_">isReady</span>()
  
  <span class="hljs-comment">// 3. æ¸²æŸ“ä¸º HTML å­—ç¬¦ä¸²</span>
  <span class="hljs-keyword">const</span> html = <span class="hljs-keyword">await</span> <span class="hljs-title function_">renderToString</span>(app)
  
  <span class="hljs-comment">// 4. è¿”å›å®Œæ•´çš„ HTML</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">`
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
      &lt;head&gt;
        &lt;title&gt;Vue3 SSR App&lt;/title&gt;
      &lt;/head&gt;
      &lt;body&gt;
        &lt;div id="app"&gt;<span class="hljs-subst">${html}</span>&lt;/div&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  `</span>
}
</code></pre>
<h3 data-id="heading-9"><strong>3.2 <code>createSSRApp</code> - åˆ›å»º SSR åº”ç”¨</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// app.js - åŒæ„åº”ç”¨åˆ›å»º</span>
<span class="hljs-keyword">import</span> { createSSRApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { createRouter, createMemoryHistory, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>
<span class="hljs-keyword">import</span> routes <span class="hljs-keyword">from</span> <span class="hljs-string">'./routes'</span>

<span class="hljs-comment">// å¯¼å‡ºä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºæ–°çš„åº”ç”¨å®ä¾‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createApp</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createSSRApp</span>(<span class="hljs-title class_">App</span>)
  
  <span class="hljs-comment">// æ ¹æ®ç¯å¢ƒä½¿ç”¨ä¸åŒçš„ history</span>
  <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>({
    <span class="hljs-attr">history</span>: <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">SSR</span> 
      ? <span class="hljs-title function_">createMemoryHistory</span>()  <span class="hljs-comment">// æœåŠ¡å™¨ç”¨ memory history</span>
      : <span class="hljs-title function_">createWebHistory</span>(),    <span class="hljs-comment">// å®¢æˆ·ç«¯ç”¨ web history</span>
    routes
  })
  
  app.<span class="hljs-title function_">use</span>(router)
  <span class="hljs-keyword">return</span> { app, router }
}
</code></pre>
<h3 data-id="heading-10"><strong>3.3 <code>useSSRContext</code> - æœåŠ¡å™¨ä¸Šä¸‹æ–‡</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useSSRContext } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>

<span class="hljs-comment">// åœ¨ç»„ä»¶ä¸­è®¿é—® SSR ä¸Šä¸‹æ–‡</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">SSR</span>) {
      <span class="hljs-comment">// åªåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ</span>
      <span class="hljs-keyword">const</span> ctx = <span class="hljs-title function_">useSSRContext</span>()
      ctx.<span class="hljs-property">title</span> = <span class="hljs-string">'åŠ¨æ€æ ‡é¢˜'</span>
    }
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-11"><strong>å››ã€ å®Œæ•´ Vue3 SSR é¡¹ç›®å®æˆ˜</strong></h2>
<p>è®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªå®Œæ•´çš„ Vue3 SSR é¡¹ç›®æ¥æ¼”ç¤ºæ‰€æœ‰æ¦‚å¿µã€‚</p>
<h3 data-id="heading-12"><strong>4.1 é¡¹ç›®ç»“æ„</strong></h3>
<pre><code class="hljs language-bash" lang="bash">vue3-ssr-project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ client/          <span class="hljs-comment"># å®¢æˆ·ç«¯å…¥å£</span>
â”‚   â”‚   â””â”€â”€ entry-client.js
â”‚   â”œâ”€â”€ server/          <span class="hljs-comment"># æœåŠ¡å™¨å…¥å£</span>
â”‚   â”‚   â””â”€â”€ entry-server.js
â”‚   â”œâ”€â”€ components/      <span class="hljs-comment"># å…±äº«ç»„ä»¶</span>
â”‚   â”‚   â”œâ”€â”€ Layout.vue
â”‚   â”‚   â””â”€â”€ PostList.vue
â”‚   â”œâ”€â”€ router/          <span class="hljs-comment"># è·¯ç”±é…ç½®</span>
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ stores/          <span class="hljs-comment"># çŠ¶æ€ç®¡ç†</span>
â”‚   â”‚   â””â”€â”€ postStore.js
â”‚   â””â”€â”€ App.vue
â”œâ”€â”€ index.html           <span class="hljs-comment"># HTML æ¨¡æ¿</span>
â”œâ”€â”€ server.js           <span class="hljs-comment"># Express æœåŠ¡å™¨</span>
â””â”€â”€ vite.config.js      <span class="hljs-comment"># Vite é…ç½®</span>
</code></pre>
<h3 data-id="heading-13"><strong>4.2 å…±äº«åº”ç”¨åˆ›å»º (app.js)</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/app.js</span>
<span class="hljs-keyword">import</span> { createSSRApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> { createRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'./router'</span>
<span class="hljs-keyword">import</span> { createPinia } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.vue'</span>

<span class="hljs-comment">// å¯¼å‡ºä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œä¸ºæ¯ä¸ªè¯·æ±‚åˆ›å»ºæ–°çš„åº”ç”¨å®ä¾‹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createApp</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createSSRApp</span>(<span class="hljs-title class_">App</span>)
  <span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>()
  <span class="hljs-keyword">const</span> pinia = <span class="hljs-title function_">createPinia</span>()
  
  app.<span class="hljs-title function_">use</span>(router)
  app.<span class="hljs-title function_">use</span>(pinia)
  
  <span class="hljs-keyword">return</span> { app, router, pinia }
}
</code></pre>
<h3 data-id="heading-14"><strong>4.3 è·¯ç”±é…ç½®</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/router/index.js</span>
<span class="hljs-keyword">import</span> { createRouter <span class="hljs-keyword">as</span> _createRouter, createMemoryHistory, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>

<span class="hljs-comment">// è·¯ç”±é…ç½®</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../components/Home.vue'</span>),
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">ssr</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// æ ‡è®°éœ€è¦ SSR</span>
    }
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/posts'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Posts'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../components/PostList.vue'</span>),
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">ssr</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">preload</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// éœ€è¦æ•°æ®é¢„å–</span>
    }
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/posts/:id'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'PostDetail'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../components/PostDetail.vue'</span>),
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">ssr</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">preload</span>: <span class="hljs-literal">true</span>
    }
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/about'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'About'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../components/About.vue'</span>),
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">ssr</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// ä¸éœ€è¦ SSR</span>
    }
  }
]

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createRouter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">_createRouter</span>({
    <span class="hljs-attr">history</span>: <span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">SSR</span> 
      ? <span class="hljs-title function_">createMemoryHistory</span>() 
      : <span class="hljs-title function_">createWebHistory</span>(),
    routes
  })
}
</code></pre>
<h3 data-id="heading-15"><strong>4.4 Pinia çŠ¶æ€ç®¡ç†</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/stores/postStore.js</span>
<span class="hljs-keyword">import</span> { defineStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'pinia'</span>

<span class="hljs-comment">// æ¨¡æ‹Ÿ API è°ƒç”¨</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchPosts</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>))
  <span class="hljs-keyword">return</span> [
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'Vue3 SSR å…¥é—¨æŒ‡å—'</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">'å­¦ä¹  Vue3 æœåŠ¡ç«¯æ¸²æŸ“...'</span>, <span class="hljs-attr">views</span>: <span class="hljs-number">152</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'Pinia çŠ¶æ€ç®¡ç†'</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">'Vue3 æ¨èçš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ...'</span>, <span class="hljs-attr">views</span>: <span class="hljs-number">98</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'Vite æ„å»ºå·¥å…·'</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">'ä¸‹ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·...'</span>, <span class="hljs-attr">views</span>: <span class="hljs-number">76</span> }
  ]
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchPostDetail</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id</span>) =&gt; {
  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">50</span>))
  <span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchPosts</span>()
  <span class="hljs-keyword">return</span> posts.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">post</span> =&gt;</span> post.<span class="hljs-property">id</span> === <span class="hljs-built_in">parseInt</span>(id))
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> usePostStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'post'</span>, {
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">posts</span>: [],
    <span class="hljs-attr">currentPost</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>
  }),
  
  <span class="hljs-attr">actions</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadPosts</span>(<span class="hljs-params"/>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">posts</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchPosts</span>()
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>
      }
    },
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadPostDetail</span>(<span class="hljs-params">id</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>
      <span class="hljs-keyword">try</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentPost</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchPostDetail</span>(id)
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>
      }
    },
    
    <span class="hljs-comment">// æœåŠ¡å™¨ç«¯æ•°æ®é¢„å–</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">serverInit</span>(<span class="hljs-params">route</span>) {
      <span class="hljs-keyword">if</span> (route.<span class="hljs-property">name</span> === <span class="hljs-string">'Posts'</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadPosts</span>()
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (route.<span class="hljs-property">name</span> === <span class="hljs-string">'PostDetail'</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadPostDetail</span>(route.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>)
      }
    }
  }
})
</code></pre>
<h3 data-id="heading-16"><strong>4.5 æœåŠ¡å™¨å…¥å£</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/server/entry-server.js</span>
<span class="hljs-keyword">import</span> { renderToString } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue/server-renderer'</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'../app.js'</span>
<span class="hljs-keyword">import</span> { usePostStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'../stores/postStore'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">render</span>(<span class="hljs-params">url</span>) {
  <span class="hljs-keyword">const</span> { app, router, pinia } = <span class="hljs-title function_">createApp</span>()
  
  <span class="hljs-comment">// è®¾ç½®æœåŠ¡å™¨ç«¯è·¯ç”±ä½ç½®</span>
  router.<span class="hljs-title function_">push</span>(url)
  
  <span class="hljs-comment">// ç­‰å¾…è·¯ç”±å‡†å¤‡å®Œæˆ</span>
  <span class="hljs-keyword">await</span> router.<span class="hljs-title function_">isReady</span>()
  
  <span class="hljs-comment">// è·å–åŒ¹é…çš„è·¯ç”±</span>
  <span class="hljs-keyword">const</span> matchedComponents = router.<span class="hljs-property">currentRoute</span>.<span class="hljs-property">value</span>.<span class="hljs-property">matched</span>
  <span class="hljs-keyword">const</span> route = router.<span class="hljs-property">currentRoute</span>.<span class="hljs-property">value</span>
  
  <span class="hljs-comment">// æ•°æ®é¢„å– - æ‰§è¡Œç»„ä»¶çš„ asyncData æˆ– store çš„ serverInit</span>
  <span class="hljs-keyword">const</span> postStore = <span class="hljs-title function_">usePostStore</span>(pinia)
  <span class="hljs-keyword">await</span> postStore.<span class="hljs-title function_">serverInit</span>(route)
  
  <span class="hljs-comment">// è·å–éœ€è¦é¢„å–æ•°æ®çš„ç»„ä»¶</span>
  <span class="hljs-keyword">const</span> componentsWithPreload = matchedComponents.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">component</span> =&gt;</span> 
    component.<span class="hljs-property">components</span>?.<span class="hljs-property">default</span> || component
  ).<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">component</span> =&gt;</span> component.<span class="hljs-property">asyncData</span>)
  
  <span class="hljs-comment">// æ‰§è¡Œç»„ä»¶çš„ asyncData æ–¹æ³•</span>
  <span class="hljs-keyword">const</span> preloadPromises = componentsWithPreload.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">component</span> =&gt;</span> 
    component.<span class="hljs-title function_">asyncData</span>({
      <span class="hljs-attr">store</span>: pinia,
      <span class="hljs-attr">route</span>: router.<span class="hljs-property">currentRoute</span>.<span class="hljs-property">value</span>
    })
  )
  
  <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(preloadPromises)
  
  <span class="hljs-comment">// æ¸²æŸ“åº”ç”¨ä¸º HTML å­—ç¬¦ä¸²</span>
  <span class="hljs-keyword">const</span> ctx = {}
  <span class="hljs-keyword">const</span> html = <span class="hljs-keyword">await</span> <span class="hljs-title function_">renderToString</span>(app, ctx)
  
  <span class="hljs-comment">// è·å– Pinia çŠ¶æ€ï¼Œç”¨äºå®¢æˆ·ç«¯æ³¨æ°´</span>
  <span class="hljs-keyword">const</span> state = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(pinia.<span class="hljs-property">state</span>.<span class="hljs-property">value</span>)
  
  <span class="hljs-keyword">return</span> { html, state }
}
</code></pre>
<h3 data-id="heading-17"><strong>4.6 å®¢æˆ·ç«¯å…¥å£</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/client/entry-client.js</span>
<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">'../app.js'</span>
<span class="hljs-keyword">import</span> { usePostStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'../stores/postStore'</span>

<span class="hljs-keyword">const</span> { app, router, pinia } = <span class="hljs-title function_">createApp</span>()

<span class="hljs-comment">// æ¢å¤æœåŠ¡å™¨çŠ¶æ€</span>
<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">__PINIA_STATE__</span>) {
  pinia.<span class="hljs-property">state</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">__PINIA_STATE__</span>
}

<span class="hljs-comment">// ç­‰å¾…è·¯ç”±å‡†å¤‡å®Œæˆ</span>
router.<span class="hljs-title function_">isReady</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// æŒ‚è½½åº”ç”¨</span>
  app.<span class="hljs-title function_">mount</span>(<span class="hljs-string">'#app'</span>)
  
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å®¢æˆ·ç«¯æ¿€æ´»å®Œæˆ'</span>)
})

<span class="hljs-comment">// å®¢æˆ·ç«¯ç‰¹å®šé€»è¾‘</span>
<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">SSR</span>) {
  <span class="hljs-comment">// æ·»åŠ å®¢æˆ·ç«¯ç‰¹å®šçš„äº‹ä»¶ç›‘å¬ç­‰</span>
  <span class="hljs-keyword">const</span> postStore = <span class="hljs-title function_">usePostStore</span>()
  
  <span class="hljs-comment">// ç›‘å¬è·¯ç”±å˜åŒ–ï¼Œåœ¨å®¢æˆ·ç«¯è·å–æ•°æ®</span>
  router.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (to.<span class="hljs-property">meta</span>.<span class="hljs-property">preload</span> &amp;&amp; !postStore.<span class="hljs-property">posts</span>.<span class="hljs-property">length</span>) {
      postStore.<span class="hljs-title function_">serverInit</span>(to).<span class="hljs-title function_">then</span>(next)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title function_">next</span>()
    }
  })
}
</code></pre>
<h3 data-id="heading-18"><strong>4.7 Vue ç»„ä»¶ç¤ºä¾‹</strong></h3>
<p><strong>App.vue - æ ¹ç»„ä»¶</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div id="app"&gt;
    &lt;Layout&gt;
      &lt;RouterView /&gt;
    &lt;/Layout&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import Layout from './components/Layout.vue'
&lt;/script&gt;
</code></pre>
<p><strong>Layout.vue - å¸ƒå±€ç»„ä»¶</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="layout"&gt;
    &lt;header class="header"&gt;
      &lt;nav class="nav"&gt;
        &lt;RouterLink to="/" class="nav-link"&gt;é¦–é¡µ&lt;/RouterLink&gt;
        &lt;RouterLink to="/posts" class="nav-link"&gt;æ–‡ç« åˆ—è¡¨&lt;/RouterLink&gt;
        &lt;RouterLink to="/about" class="nav-link"&gt;å…³äº&lt;/RouterLink&gt;
      &lt;/nav&gt;
    &lt;/header&gt;
    
    &lt;main class="main"&gt;
      &lt;slot /&gt;
    &lt;/main&gt;
    
    &lt;footer class="footer"&gt;
      &lt;p&gt;&amp;copy; 2024 Vue3 SSR æ¼”ç¤º&lt;/p&gt;
    &lt;/footer&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { RouterLink } from 'vue-router'
&lt;/script&gt;

&lt;style scoped&gt;
.layout {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.header {
  background: #2c3e50;
  padding: 1rem 0;
}

.nav {
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 2rem;
  display: flex;
  gap: 2rem;
}

.nav-link {
  color: white;
  text-decoration: none;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  transition: background 0.3s;
}

.nav-link:hover,
.nav-link.router-link-active {
  background: #34495e;
}

.main {
  flex: 1;
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
  width: 100%;
}

.footer {
  background: #ecf0f1;
  padding: 1rem;
  text-align: center;
  color: #7f8c8d;
}
&lt;/style&gt;
</code></pre>
<p><strong>PostList.vue - æ–‡ç« åˆ—è¡¨ç»„ä»¶</strong></p>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div class="post-list"&gt;
    &lt;h1&gt;æ–‡ç« åˆ—è¡¨&lt;/h1&gt;
    
    &lt;div v-if="postStore.loading" class="loading"&gt;
      åŠ è½½ä¸­...
    &lt;/div&gt;
    
    &lt;div v-else class="posts"&gt;
      &lt;article 
        v-for="post in postStore.posts" 
        :key="post.id"
        class="post-card"
      &gt;
        &lt;h2&gt;
          &lt;RouterLink :to="`/posts/${post.id}`" class="post-link"&gt;
            {{ post.title }}
          &lt;/RouterLink&gt;
        &lt;/h2&gt;
        &lt;p class="post-content"&gt;{{ post.content }}&lt;/p&gt;
        &lt;div class="post-meta"&gt;
          &lt;span&gt;æµè§ˆé‡: {{ post.views }}&lt;/span&gt;
        &lt;/div&gt;
      &lt;/article&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { usePostStore } from '../stores/postStore'
import { onServerPrefetch, onMounted } from 'vue'

const postStore = usePostStore()

// æœåŠ¡å™¨ç«¯æ•°æ®é¢„å–
onServerPrefetch(async () =&gt; {
  await postStore.loadPosts()
})

// å®¢æˆ·ç«¯æ•°æ®è·å–ï¼ˆå¦‚æœæœåŠ¡å™¨æ²¡æœ‰é¢„å–ï¼‰
onMounted(async () =&gt; {
  if (postStore.posts.length === 0) {
    await postStore.loadPosts()
  }
})

// ä¼ ç»Ÿ asyncData æ–¹å¼ï¼ˆå¯é€‰ï¼‰
export const asyncData = async ({ store, route }) =&gt; {
  const postStore = usePostStore(store)
  await postStore.loadPosts()
}
&lt;/script&gt;

&lt;style scoped&gt;
.post-list {
  max-width: 800px;
  margin: 0 auto;
}

.loading {
  text-align: center;
  padding: 2rem;
  color: #7f8c8d;
}

.posts {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.post-card {
  border: 1px solid #e1e8ed;
  border-radius: 8px;
  padding: 1.5rem;
  background: white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: transform 0.2s, box-shadow 0.2s;
}

.post-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

.post-link {
  color: #2c3e50;
  text-decoration: none;
}

.post-link:hover {
  color: #42b883;
  text-decoration: underline;
}

.post-content {
  color: #5a6c7d;
  line-height: 1.6;
  margin: 1rem 0;
}

.post-meta {
  border-top: 1px solid #e1e8ed;
  padding-top: 1rem;
  color: #7f8c8d;
  font-size: 0.9rem;
}
&lt;/style&gt;
</code></pre>
<h3 data-id="heading-19"><strong>4.8 Express æœåŠ¡å™¨</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// server.js</span>
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>
<span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'url'</span>
<span class="hljs-keyword">import</span> { dirname, resolve } <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">'./dist/server/entry-server.js'</span>

<span class="hljs-keyword">const</span> __dirname = <span class="hljs-title function_">dirname</span>(<span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>))
<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()

<span class="hljs-comment">// é™æ€æ–‡ä»¶æœåŠ¡</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-string">'/assets'</span>, express.<span class="hljs-title function_">static</span>(<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'./dist/client/assets'</span>)))

<span class="hljs-comment">// SSR è·¯ç”±å¤„ç†</span>
app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'*'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> { html, state } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">render</span>(req.<span class="hljs-property">url</span>)
    
    <span class="hljs-keyword">const</span> template = <span class="hljs-string">`
&lt;!DOCTYPE html&gt;
&lt;html lang="zh-CN"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Vue3 SSR æ¼”ç¤º&lt;/title&gt;
    &lt;link rel="stylesheet" href="/assets/style.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="app"&gt;<span class="hljs-subst">${html}</span>&lt;/div&gt;
    &lt;script&gt;
      // å°†æœåŠ¡å™¨çŠ¶æ€ä¼ é€’åˆ°å®¢æˆ·ç«¯
      window.__PINIA_STATE__ = <span class="hljs-subst">${state}</span>
    &lt;/script&gt;
    &lt;script type="module" src="/assets/entry-client.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;`</span>
    
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">set</span>({ <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'text/html'</span> }).<span class="hljs-title function_">end</span>(template)
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'SSR æ¸²æŸ“é”™è¯¯:'</span>, error)
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">end</span>(<span class="hljs-string">'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'</span>)
  }
})

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">PORT</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">PORT</span> || <span class="hljs-number">3000</span>
app.<span class="hljs-title function_">listen</span>(<span class="hljs-variable constant_">PORT</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ğŸš€ æœåŠ¡å™¨è¿è¡Œåœ¨ http://localhost:<span class="hljs-subst">${PORT}</span>`</span>)
})
</code></pre>
<h3 data-id="heading-20"><strong>4.9 Vite æ„å»ºé…ç½®</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// vite.config.js</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>
<span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-vue'</span>
<span class="hljs-keyword">import</span> { resolve } <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">plugins</span>: [<span class="hljs-title function_">vue</span>()],
  
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">'@'</span>: <span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'src'</span>)
    }
  },
  
  <span class="hljs-attr">build</span>: {
    <span class="hljs-attr">rollupOptions</span>: {
      <span class="hljs-attr">input</span>: {
        <span class="hljs-attr">client</span>: <span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'src/client/entry-client.js'</span>),
        <span class="hljs-attr">server</span>: <span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'src/server/entry-server.js'</span>)
      },
      <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">format</span>: <span class="hljs-string">'esm'</span>,
        <span class="hljs-attr">entryFileNames</span>: <span class="hljs-function">(<span class="hljs-params">chunk</span>) =&gt;</span> {
          <span class="hljs-keyword">return</span> chunk.<span class="hljs-property">name</span> === <span class="hljs-string">'server'</span> ? <span class="hljs-string">'server/[name].js'</span> : <span class="hljs-string">'client/assets/[name]-[hash].js'</span>
        }
      }
    }
  },
  
  <span class="hljs-attr">ssr</span>: {
    <span class="hljs-attr">noExternal</span>: [<span class="hljs-string">'pinia'</span>]
  }
})
</code></pre>
<hr/>
<h2 data-id="heading-21"><strong>äº”ã€ æ•°æ®é¢„å–ä¸çŠ¶æ€åŒæ­¥</strong></h2>
<h3 data-id="heading-22"><strong>5.1 æ•°æ®é¢„å–ç­–ç•¥</strong></h3>
<p><strong>æµç¨‹å›¾ï¼šæ•°æ®é¢„å–ä¸çŠ¶æ€åŒæ­¥æµç¨‹</strong></p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[ç”¨æˆ·è¯·æ±‚] --&gt; B[æœåŠ¡å™¨è·¯ç”±åŒ¹é…]
    B --&gt; C[è¯†åˆ«éœ€è¦é¢„å–çš„ç»„ä»¶]
    C --&gt; D[æ‰§è¡ŒasyncData/storeé¢„å–]
    D --&gt; E[æ‰€æœ‰æ•°æ®é¢„å–å®Œæˆ]
    E --&gt; F[æ¸²æŸ“HTML]
    F --&gt; G[åºåˆ—åŒ–çŠ¶æ€åˆ°window]
    G --&gt; H[è¿”å›HTML+çŠ¶æ€]
    
    H --&gt; I[æµè§ˆå™¨æ¸²æŸ“]
    I --&gt; J[å®¢æˆ·ç«¯æ¿€æ´»]
    J --&gt; K[ååºåˆ—åŒ–çŠ¶æ€]
    K --&gt; L[Hydrationå®Œæˆ]
</code></pre>
<h3 data-id="heading-23"><strong>5.2 å¤šç§æ•°æ®é¢„å–æ–¹å¼</strong></h3>
<h4 data-id="heading-24"><strong>æ–¹å¼ä¸€ï¼šä½¿ç”¨ <code>onServerPrefetch</code></strong></h4>
<pre><code class="hljs language-vue" lang="vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;ç”¨æˆ·èµ„æ–™&lt;/h1&gt;
    &lt;div v-if="user"&gt;{{ user.name }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref, onServerPrefetch } from 'vue'

const user = ref(null)

const fetchUserData = async () =&gt; {
  // æ¨¡æ‹Ÿ API è°ƒç”¨
  await new Promise(resolve =&gt; setTimeout(resolve, 100))
  user.value = { name: 'å¼ ä¸‰', id: 1, email: 'zhangsan@example.com' }
}

// æœåŠ¡å™¨ç«¯é¢„å–
onServerPrefetch(async () =&gt; {
  await fetchUserData()
})

// å®¢æˆ·ç«¯è·å–ï¼ˆå¦‚æœæœåŠ¡å™¨æ²¡æœ‰é¢„å–ï¼‰
import { onMounted } from 'vue'
onMounted(async () =&gt; {
  if (!user.value) {
    await fetchUserData()
  }
})
&lt;/script&gt;
</code></pre>
<h4 data-id="heading-25"><strong>æ–¹å¼äºŒï¼šä½¿ç”¨ Store ç»Ÿä¸€ç®¡ç†</strong></h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// stores/userStore.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">'user'</span>, {
  <span class="hljs-attr">state</span>: <span class="hljs-function">() =&gt;</span> ({
    <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>
  }),
  
  <span class="hljs-attr">actions</span>: {
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchUser</span>(<span class="hljs-params">id</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­è¿™é‡Œè°ƒç”¨ API</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>))
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">user</span> = { id, <span class="hljs-attr">name</span>: <span class="hljs-string">'ç”¨æˆ·'</span> + id, <span class="hljs-attr">email</span>: <span class="hljs-string">`user<span class="hljs-subst">${id}</span>@example.com`</span> }
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>
      }
    },
    
    <span class="hljs-comment">// æœåŠ¡å™¨ç«¯åˆå§‹åŒ–</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">serverInit</span>(<span class="hljs-params">route</span>) {
      <span class="hljs-keyword">if</span> (route.<span class="hljs-property">name</span> === <span class="hljs-string">'UserProfile'</span> &amp;&amp; route.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>) {
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fetchUser</span>(route.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>)
      }
    }
  }
})
</code></pre>
<hr/>
<h2 data-id="heading-26"><strong>å…­ã€ æ€§èƒ½ä¼˜åŒ–ä¸æœ€ä½³å®è·µ</strong></h2>
<h3 data-id="heading-27"><strong>6.1 ç¼“å­˜ç­–ç•¥</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// server.js - æ·»åŠ ç¼“å­˜</span>
<span class="hljs-keyword">import</span> lru-cache <span class="hljs-keyword">from</span> <span class="hljs-string">'lru-cache'</span>

<span class="hljs-keyword">const</span> ssrCache = <span class="hljs-keyword">new</span> lru-<span class="hljs-title function_">cache</span>({
  <span class="hljs-attr">max</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// ç¼“å­˜100ä¸ªé¡µé¢</span>
  <span class="hljs-attr">ttl</span>: <span class="hljs-number">1000</span> * <span class="hljs-number">60</span> * <span class="hljs-number">15</span> <span class="hljs-comment">// 15åˆ†é’Ÿ</span>
})

app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'*'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
  <span class="hljs-keyword">const</span> cacheKey = req.<span class="hljs-property">url</span>
  <span class="hljs-keyword">if</span> (ssrCache.<span class="hljs-title function_">has</span>(cacheKey)) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä½¿ç”¨ç¼“å­˜:'</span>, cacheKey)
    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">send</span>(ssrCache.<span class="hljs-title function_">get</span>(cacheKey))
  }
  
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> { html, state } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">render</span>(req.<span class="hljs-property">url</span>)
    <span class="hljs-keyword">const</span> template = <span class="hljs-title function_">generateTemplate</span>(html, state)
    
    <span class="hljs-comment">// ç¼“å­˜ç»“æœï¼ˆæ’é™¤éœ€è¦åŠ¨æ€å†…å®¹çš„é¡µé¢ï¼‰</span>
    <span class="hljs-keyword">if</span> (!req.<span class="hljs-property">url</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'/admin'</span>) &amp;&amp; !req.<span class="hljs-property">url</span>.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'/user'</span>)) {
      ssrCache.<span class="hljs-title function_">set</span>(cacheKey, template)
    }
    
    res.<span class="hljs-title function_">send</span>(template)
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// é”™è¯¯å¤„ç†</span>
  }
})
</code></pre>
<h3 data-id="heading-28"><strong>6.2 æµå¼æ¸²æŸ“</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æµå¼æ¸²æŸ“ç¤ºä¾‹</span>
<span class="hljs-keyword">import</span> { renderToNodeStream } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue/server-renderer'</span>

app.<span class="hljs-title function_">get</span>(<span class="hljs-string">'*'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">const</span> { app, router } = <span class="hljs-title function_">createApp</span>()
  
  router.<span class="hljs-title function_">push</span>(req.<span class="hljs-property">url</span>)
  <span class="hljs-keyword">await</span> router.<span class="hljs-title function_">isReady</span>()
  
  res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`
    &lt;!DOCTYPE html&gt;
    &lt;html&gt;
      &lt;head&gt;&lt;title&gt;Vue3 SSR&lt;/title&gt;&lt;/head&gt;
      &lt;body&gt;&lt;div id="app"&gt;
  `</span>)
  
  <span class="hljs-keyword">const</span> stream = <span class="hljs-title function_">renderToNodeStream</span>(app)
  stream.<span class="hljs-title function_">pipe</span>(res, { <span class="hljs-attr">end</span>: <span class="hljs-literal">false</span> })
  
  stream.<span class="hljs-title function_">on</span>(<span class="hljs-string">'end'</span>, <span class="hljs-function">() =&gt;</span> {
    res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`&lt;/div&gt;&lt;script src="/client.js"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;`</span>)
    res.<span class="hljs-title function_">end</span>()
  })
})
</code></pre>
<h3 data-id="heading-29"><strong>6.3 é”™è¯¯å¤„ç†</strong></h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é”™è¯¯è¾¹ç•Œç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ErrorBoundary</span> = {
  <span class="hljs-title function_">setup</span>(<span class="hljs-params">props, { slots }</span>) {
    <span class="hljs-keyword">const</span> error = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)
    
    <span class="hljs-title function_">onErrorCaptured</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
      error.<span class="hljs-property">value</span> = err
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> <span class="hljs-comment">// é˜»æ­¢é”™è¯¯ç»§ç»­ä¼ æ’­</span>
    })
    
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> error.<span class="hljs-property">value</span> 
      ? <span class="hljs-title function_">h</span>(<span class="hljs-string">'div'</span>, { <span class="hljs-attr">class</span>: <span class="hljs-string">'error'</span> }, <span class="hljs-string">'ç»„ä»¶æ¸²æŸ“é”™è¯¯'</span>)
      : slots.<span class="hljs-property">default</span>?.()
  }
}
</code></pre>
<hr/>
<h2 data-id="heading-30"><strong>ä¸ƒã€ Nuxt.js 3 - æ›´ç®€å•çš„ SSR æ–¹æ¡ˆ</strong></h2>
<p>å¯¹äºå¤§å¤šæ•°é¡¹ç›®ï¼Œæ¨èä½¿ç”¨ Nuxt.js 3ï¼Œå®ƒåŸºäº Vue3 æä¾›äº†å¼€ç®±å³ç”¨çš„ SSR æ”¯æŒã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// nuxt.config.ts</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineNuxtConfig</span>({
  <span class="hljs-attr">ssr</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">modules</span>: [<span class="hljs-string">'@pinia/nuxt'</span>],
  <span class="hljs-attr">runtimeConfig</span>: {
    <span class="hljs-attr">public</span>: {
      <span class="hljs-attr">apiBase</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">API_BASE</span> || <span class="hljs-string">'/api'</span>
    }
  }
})
</code></pre>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- pages/index.vue --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;Nuxt 3 SSR&lt;/h1&gt;
    &lt;div&gt;{{ data }}&lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
// è‡ªåŠ¨å¤„ç† SSR æ•°æ®è·å–
const { data } = await useFetch('/api/posts')
&lt;/script&gt;
</code></pre>
<hr/>
<h2 data-id="heading-31"><strong>å…«ã€ æ€»ç»“</strong></h2>
<h3 data-id="heading-32"><strong>8.1 Vue3 SSR æ ¸å¿ƒä¼˜åŠ¿</strong></h3>
<ol>
<li><strong>æ›´å¥½çš„æ€§èƒ½</strong>ï¼šé¦–å±åŠ è½½é€Ÿåº¦å¿«ï¼Œå‡å°‘ç™½å±æ—¶é—´</li>
<li><strong>SEO å‹å¥½</strong>ï¼šæœç´¢å¼•æ“å¯ä»¥ç›´æ¥ç´¢å¼•å†…å®¹</li>
<li><strong>åŒæ„å¼€å‘</strong>ï¼šä¸€å¥—ä»£ç ï¼Œä¸¤ç«¯è¿è¡Œ</li>
<li><strong>ç°ä»£åŒ– API</strong>ï¼šæ›´å¥½çš„ TypeScript æ”¯æŒå’Œç»„åˆå¼ API é›†æˆ</li>
</ol>
<h3 data-id="heading-33"><strong>8.2 é€‚ç”¨åœºæ™¯</strong></h3>
<ul>
<li><strong>å†…å®¹å‹ç½‘ç«™</strong>ï¼šåšå®¢ã€æ–°é—»ã€ç”µå•†ç­‰éœ€è¦ SEO çš„åœºæ™¯</li>
<li><strong>ä¼ä¸šå®˜ç½‘</strong>ï¼šéœ€è¦å¿«é€Ÿé¦–å±åŠ è½½å’Œè‰¯å¥½ SEO</li>
<li><strong>ç¤¾äº¤åº”ç”¨</strong>ï¼šéœ€è¦ç¤¾äº¤åª’ä½“åˆ†äº«é¢„è§ˆ</li>
<li><strong>éœ€è¦æ€§èƒ½ä¼˜åŒ–çš„ SPA</strong></li>
</ul>
<h3 data-id="heading-34"><strong>8.3 æ³¨æ„äº‹é¡¹</strong></h3>
<ol>
<li><strong>æœåŠ¡å™¨è´Ÿè½½</strong>ï¼šSSR ä¼šå¢åŠ æœåŠ¡å™¨ CPU å’Œå†…å­˜æ¶ˆè€—</li>
<li><strong>å¼€å‘å¤æ‚åº¦</strong>ï¼šéœ€è¦å¤„ç†ç¯å¢ƒå·®å¼‚å’ŒçŠ¶æ€åŒæ­¥</li>
<li><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šéœ€è¦åˆç†è®¾è®¡ç¼“å­˜æœºåˆ¶</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šéœ€è¦å®Œå–„çš„é”™è¯¯è¾¹ç•Œå’Œé™çº§æ–¹æ¡ˆ</li>
</ol>
<p>Vue3 çš„æœåŠ¡ç«¯æ¸²æŸ“ä¸ºç°ä»£ Web åº”ç”¨æä¾›äº†å¼ºå¤§çš„èƒ½åŠ›ï¼Œåˆç†ä½¿ç”¨å¯ä»¥æ˜¾è‘—æå‡ç”¨æˆ·ä½“éªŒå’Œåº”ç”¨æ€§èƒ½ã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©ä½ å…¨é¢æŒæ¡ Vue3 SSR çš„æ ¸å¿ƒæ¦‚å¿µå’Œå®è·µæŠ€å·§ï¼</p>
<hr/>
<p><strong>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—å’Œè¯„è®ºï¼æœ‰ä»»ä½•é—®é¢˜éƒ½å¯ä»¥åœ¨è¯„è®ºåŒºè®¨è®ºã€‚</strong><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ceae4d4f819b4c0bb5c270dc445f9203~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YyX6L6wYWxr:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766306661&amp;x-signature=BMMz0XAX%2BZPEI9hWFH9qfwsWifk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LLMåŸºç¡€çŸ¥è¯†ï¼ŒlangchainV1.0è®²è§£ï¼ˆä¸€ï¼‰]]></title>    <link>https://juejin.cn/post/7583324039302905907</link>    <guid>https://juejin.cn/post/7583324039302905907</guid>    <pubDate>2025-12-14T08:26:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583324039302905907" data-draft-id="7582809606067650586" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LLMåŸºç¡€çŸ¥è¯†ï¼ŒlangchainV1.0è®²è§£ï¼ˆä¸€ï¼‰"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,LangChain"/> <meta itemprop="datePublished" content="2025-12-14T08:26:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŠ è½½ä¸­361"/> <meta itemprop="url" content="https://juejin.cn/user/1273682599894282"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LLMåŸºç¡€çŸ¥è¯†ï¼ŒlangchainV1.0è®²è§£ï¼ˆä¸€ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1273682599894282/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŠ è½½ä¸­361
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:26:11.000Z" title="Sun Dec 14 2025 08:26:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">NLPæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p>NLPï¼šè‡ªç„¶è¯­è¨€å¤„ç†</p>
<p>å®ƒçš„ä½œç”¨å°±æ˜¯è®©è®¡ç®—æœºâ€œç†è§£ã€å¤„ç†å’Œç”Ÿæˆäººç±»è¯­è¨€â€ã€‚</p>
<h2 data-id="heading-1">NLPå‘å±•å²</h2>
<h2 data-id="heading-2">1. åŸºäºè§„åˆ™</h2>
<pre><code class="hljs">è¿™ä¸ªé˜¶æ®µçš„NLPä¸»è¦ç”¨äºæŠŠè‡ªç„¶è¯­è¨€ä¸­çš„ä¿¡æ¯ï¼Œæå–æˆç¨‹åºèƒ½ç›´æ¥ç”¨çš„å­—æ®µã€‚
</code></pre>
<h3 data-id="heading-3">æ¯”å¦‚</h3>
<ul>
<li>æŠ½å–æ—¶é—´ã€æ—¥æœŸ</li>
<li>æŠ½å–é‡‘é¢ã€æ•°é‡</li>
<li>æŠ½å–ç¼–å·ã€æ‰‹æœºå·ã€èº«ä»½è¯å·</li>
</ul>
<p>ç”¨æˆ·è¾“å…¥äº†ä¸€æ®µæ–‡æœ¬ï¼šâ€œè®¢å•å°†äº2025å¹´5æœˆ1æ—¥å‘è´§ï¼Œé‡‘é¢199å…ƒâ€ï¼Œå‘ç°åŒ…å«æ—¶é—´å’Œé‡‘é¢å°±</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"date"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2025-05-01"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"price"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">199</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>ç³»ç»Ÿé€šè¿‡è§„åˆ™å‘ç°æ–‡æœ¬ä¸­åŒ…å«<strong>æ—¶é—´å’Œé‡‘é¢</strong>ï¼Œäºæ˜¯è§£ææˆç»“æ„åŒ–æ•°æ®ã€‚
åç»­ä¸šåŠ¡ç¨‹åºåªéœ€è¦å¤„ç†è¿™æ®µ JSONï¼Œè€Œ<strong>ä¸å†å…³å¿ƒåŸå§‹æ–‡æœ¬çš„è‡ªç„¶è¯­è¨€å½¢å¼</strong>ã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨è¿™ä¸ªé˜¶æ®µçš„ NLP ä¸­ï¼š</p>
<ul>
<li>ç³»ç»Ÿ<strong>ä¸ä¼šç†è§£ç”¨æˆ·çš„çœŸå®æ„å›¾</strong></li>
<li>ä¸ä¼šç»“åˆä¸Šä¸‹æ–‡è¿›è¡Œæ¨æ–­</li>
<li>ä¸ä¼šè¡¥å…¨éšå«ä¿¡æ¯</li>
<li>ä¹Ÿä¸ä¼šâ€œçŒœæµ‹â€ç”¨æˆ·æƒ³è¡¨è¾¾ä»€ä¹ˆ</li>
</ul>
<p>å®ƒåªåšä¸€ä»¶äº‹ï¼š</p>
<blockquote>
<p><strong>åˆ¤æ–­æ–‡æœ¬æ˜¯å¦å‘½ä¸­æ—¢å®šè§„åˆ™ï¼Œå¹¶åœ¨å‘½ä¸­æ—¶è¾“å‡ºç¡®å®šçš„ç»“æ„åŒ–ç»“æœ</strong></p>
</blockquote>
<hr/>
<p>å› æ­¤ï¼Œ<strong>åŸºäºè§„åˆ™çš„ NLP å¹¶ä¸å…·å¤‡ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›</strong>ï¼Œ<br/>
å®ƒæ›´åƒæ˜¯ä¸€ä¸ª <strong>â€œè¯­è¨€æ ¼å¼è§£æå™¨â€</strong> ï¼Œè€Œä¸æ˜¯â€œè¯­è¨€ç†è§£ç³»ç»Ÿâ€ã€‚</p>
<h2 data-id="heading-4">2. åŸºäºç»Ÿè®¡</h2>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong></p>
<blockquote>
<p><strong>ä¸å†å®Œå…¨ä¾èµ–äººå·¥è§„åˆ™ï¼Œè€Œæ˜¯é€šè¿‡ç»Ÿè®¡å¤§é‡æ–‡æœ¬ä¸­è¯è¯­çš„å‡ºç°é¢‘ç‡å’Œç»„åˆè§„å¾‹ï¼Œæ¥æ¨æ–­è¯­è¨€æ¨¡å¼ã€‚</strong>
åŸºäºç»Ÿè®¡çš„</p>
</blockquote>
<p>æ¯”å¦‚æœ€ç®€å•çš„N_Gramæ¨¡å‹</p>
<h4 data-id="heading-5">ä»€ä¹ˆæ˜¯ N-Gramï¼Ÿ</h4>
<blockquote>
<p><strong>N-Gram å‡è®¾ï¼š<br/>
å½“å‰è¯çš„å‡ºç°ï¼Œåªä¸å‰é¢ N-1 ä¸ªè¯æœ‰å…³ã€‚</strong></p>
</blockquote>
<p>ä¾‹å¦‚ï¼š</p>
<ul>
<li>1-Gramï¼šåªçœ‹å½“å‰è¯æœ¬èº«</li>
<li>2-Gramï¼ˆBigramï¼‰ï¼šçœ‹å‰ 1 ä¸ªè¯</li>
<li>3-Gramï¼ˆTrigramï¼‰ï¼šçœ‹å‰ 2 ä¸ªè¯</li>
</ul>
<p>æˆ‘ä»¬ä»¥2-Gramä¸ºåˆ—ï¼šä¼šçœ‹å‰é¢çš„ä¸€ä¸ªè¯ã€‚</p>
<p>æˆ‘ä»¬å°†ä»¥ä¸‹å†…å®¹è®­ç»ƒç»™æ¨¡å‹ï¼š</p>
<pre><code class="hljs">â€œæˆ‘ çˆ± åƒ è‹¹æœâ€
â€œæˆ‘ çˆ± åƒ é¦™è•‰â€
â€œæˆ‘ å–œæ¬¢ åƒ è‹¹æœâ€
</code></pre>
<p>Bigram æ¨¡å‹ä¼š<strong>æ ¹æ®ä¸€ä¸ªè¯ç»Ÿè®¡ä¸‹ä¸€ä¸ªè¯å‡ºç°çš„æ¦‚ç‡</strong>ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥æ•°ä¸€æ•°æ‰€æœ‰è¯å¯¹ï¼š</p>








































<table><thead><tr><th>å‰ä¸€ä¸ªè¯</th><th>ä¸‹ä¸€ä¸ªè¯</th><th>æ¬¡æ•°</th></tr></thead><tbody><tr><td>æˆ‘</td><td>çˆ±</td><td>2 æ¬¡</td></tr><tr><td>æˆ‘</td><td>å–œæ¬¢</td><td>1 æ¬¡</td></tr><tr><td>çˆ±</td><td>åƒ</td><td>2 æ¬¡</td></tr><tr><td>å–œæ¬¢</td><td>åƒ</td><td>1 æ¬¡</td></tr><tr><td>åƒ</td><td>è‹¹æœ</td><td>2 æ¬¡</td></tr><tr><td>åƒ</td><td>é¦™è•‰</td><td>1 æ¬¡</td></tr></tbody></table>
<p>æ ¹æ®è¿™ä¸ªè¯çš„ç»„åˆï¼Œå°±å¯ä»¥å»é¢„æµ‹ä¸€ä¸ªè¯çš„ä¸‹ä¸€ä¸ªè¯ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li><strong>æˆ‘</strong>åé¢å‡ºç°â€œçˆ±â€çš„æ¦‚ç‡æ˜¯ 2/3ï¼Œå‡ºç°â€œå–œæ¬¢â€çš„æ¦‚ç‡æ˜¯ 1/3ã€‚</li>
<li><strong>åƒ</strong>åé¢å‡ºç°â€œè‹¹æœâ€çš„æ¦‚ç‡æ˜¯ 2/3ï¼Œå‡ºç°â€œé¦™è•‰â€çš„æ¦‚ç‡æ˜¯ 1/3ã€‚</li>
</ul>
<p>æ‰€ä»¥ï¼š</p>
<p>å¦‚æœä½ çœ‹åˆ°â€œ<strong>æˆ‘ çˆ± åƒ</strong>â€ï¼Œé‚£ä¸‹ä¸€ä¸ªè¯å¤§æ¦‚ç‡æ˜¯â€œè‹¹æœâ€ï¼</p>
<p>è¿™é‡Œæœ‰äººè¦é—®äº†ï¼šä¸ºä»€ä¹ˆæœ‰çš„è¯å¯¹æ˜¯ä¸€ä¸ªå­—ï¼Œæœ‰çš„è¯å¯¹æ˜¯ä¸¤ä¸ªå­—ï¼Œè¿™å°±æ¶‰åŠåˆ°tokençš„æ¦‚å¿µäº†ã€‚</p>
<h3 data-id="heading-6">å¸¸è¯´çš„tokenæ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<p><strong>Token æ˜¯æ¨¡å‹å¤„ç†æ–‡æœ¬çš„æœ€å°â€œè®¡ç®—å•ä½â€</strong></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Ftokenizer%25EF%25BC%258C%25E6%2588%2591%25E5%258F%25AF%25E4%25BB%25A5%25E9%2580%259A%25E8%25BF%2587%25E8%25BF%2599%25E4%25B8%25AAopenai%25E7%259A%2584%25E5%25AE%2598%25E7%25BD%2591%25E5%2588%2586%25E8%25AF%258D%25E5%2599%25A8%25E5%258E%25BB%25E7%259C%258B%25EF%25BC%258C%25E4%25B8%2580%25E5%258F%25A5%25E8%25AF%259D%25E4%25BC%259A%25E8%25A2%25AB%25E6%2580%258E%25E6%25A0%25B7%25E5%2588%2586%25E5%2589%25B2%25E3%2580%2582" target="_blank" title="https://platform.openai.com/tokenizer%EF%BC%8C%E6%88%91%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E8%BF%99%E4%B8%AAopenai%E7%9A%84%E5%AE%98%E7%BD%91%E5%88%86%E8%AF%8D%E5%99%A8%E5%8E%BB%E7%9C%8B%EF%BC%8C%E4%B8%80%E5%8F%A5%E8%AF%9D%E4%BC%9A%E8%A2%AB%E6%80%8E%E6%A0%B7%E5%88%86%E5%89%B2%E3%80%82" ref="nofollow noopener noreferrer">platform.openai.com/tokenizerï¼Œæˆ‘â€¦</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a401e1d440fe4c318afad3a018ebf7a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Yqg6L295LitMzYx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766305571&amp;x-signature=gwYL6YnI4JmBk5YN7z48QyjTG%2FI%3D" alt="Clipboard_Screenshot_1765681910.png" loading="lazy"/></p>
<p>æ¯ä¸ªé¢œè‰²éƒ½ä»£è¡¨ä¸€ä¸ªtokenã€‚å¯ä»¥çœ‹åˆ°â€œæˆ‘çˆ±åƒè‹¹æœâ€è¿™å¥è¯ï¼Œè½¬æ¢æˆLLå¤„ç†çš„æœ€å°å•ä½å°±æ˜¯</p>
<p>â€œæˆ‘â€ â€œçˆ±â€ â€œåƒâ€ â€œè‹¹æœâ€</p>
<p>é‚£è‡ªç„¶ï¼Œåœ¨ç»Ÿè®¡æ¦‚ç‡çš„æ—¶å€™ï¼Œä¹Ÿè¦æŒ‰ç…§è¿™ä¸ªè¯å¯¹è¿›è¡Œç»Ÿè®¡ï¼Œå› ä¸ºæ¨¡å‹å¤„ç†çš„æ°¸è¿œéƒ½æ˜¯tokenï¼Œè¾“å‡ºçš„æ—¶å€™ä¹Ÿæ˜¯æŒ‰ç…§tokenè¿›è¡Œçš„è¾“å‡ºã€‚</p>
<h2 data-id="heading-7">3. æ·±åº¦å­¦ä¹ å’Œå¤§æ•°æ®é©±åŠ¨</h2>
<p>éšç€äº’è”ç½‘çš„å‘å±•ï¼Œæ–‡æœ¬æ•°æ®è§„æ¨¡å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼ŒåŒæ—¶è®¡ç®—èƒ½åŠ›ï¼ˆå°¤å…¶æ˜¯ GPUï¼‰çš„æå‡ï¼Œä½¿å¾— <strong>æ·±åº¦å­¦ä¹ æ–¹æ³•å¼€å§‹è¢«å¼•å…¥ NLP é¢†åŸŸ</strong>ã€‚</p>
<p>è¿™ä¸€é˜¶æ®µçš„æ ¸å¿ƒå˜åŒ–æ˜¯ï¼š</p>
<blockquote>
<p><strong>ä¸å†äººä¸ºè®¾è®¡è§„åˆ™æˆ–ç»Ÿè®¡ç‰¹å¾ï¼Œè€Œæ˜¯è®©æ¨¡å‹è‡ªåŠ¨å­¦ä¹ è¯­è¨€çš„è¡¨ç¤ºå’Œè§„å¾‹ã€‚</strong></p>
</blockquote>
<hr/>
<h3 data-id="heading-8">æ ¸å¿ƒæ€æƒ³</h3>
<p>åœ¨æ·±åº¦å­¦ä¹ é©±åŠ¨çš„ NLP ä¸­ï¼Œç³»ç»Ÿä¸å†åªå…³å¿ƒï¼š</p>
<ul>
<li>â€œè¿™ä¸ªè¯å‡ºç°è¿‡å¤šå°‘æ¬¡â€</li>
<li>â€œä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡æ˜¯å¤šå°‘â€</li>
</ul>
<p>è€Œæ˜¯å¼€å§‹å­¦ä¹ ï¼š</p>
<blockquote>
<p><strong>è¯ä¸è¯ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ï¼Œä»¥åŠå®ƒä»¬åœ¨ä¸Šä¸‹æ–‡ä¸­çš„å«ä¹‰ã€‚</strong>ï¼ˆè¿™ä¸ªå°±æ˜¯å‘é‡ç›¸ä¼¼ï¼‰</p>
</blockquote>
<hr/>
<h3 data-id="heading-9">å…³é”®æŠ€æœ¯æ¼”è¿›</h3>
<h4 data-id="heading-10">1ï¸âƒ£ è¯å‘é‡ï¼ˆWord Embeddingï¼‰</h4>
<p>é€šè¿‡ç¥ç»ç½‘ç»œï¼Œå°†è¯æ˜ å°„åˆ°è¿ç»­å‘é‡ç©ºé—´ä¸­ï¼š</p>
<pre><code class="hljs">â€œæ‰‹æœºâ€ â‰ˆ â€œç”µè„‘â€
â€œåŒ—äº¬â€ â‰ˆ â€œä¸Šæµ·â€
</code></pre>
<p>ç›¸ä¼¼è¯­ä¹‰çš„è¯ï¼Œåœ¨å‘é‡ç©ºé—´ä¸­è·ç¦»æ›´è¿‘ã€‚</p>
<p>è¿™ä½¿å¾—æ¨¡å‹ç¬¬ä¸€æ¬¡å…·å¤‡äº† <strong>â€œè¯­ä¹‰ç›¸ä¼¼æ€§â€çš„æ¦‚å¿µ</strong>ã€‚</p>
<hr/>
<h4 data-id="heading-11">2ï¸âƒ£ Transformer æ¨¡å‹</h4>
<p>Transformer çš„æå‡ºï¼Œå½»åº•æ”¹å˜äº† NLP çš„å‘å±•æ–¹å‘ã€‚</p>
<p>å®ƒé€šè¿‡ <strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰</strong> ï¼š</p>
<ul>
<li>åŒæ—¶å…³æ³¨å¥å­ä¸­çš„æ‰€æœ‰è¯</li>
<li>æ•æ‰é•¿è·ç¦»ä¾èµ–</li>
<li>å¤§å¹…æå‡å¹¶è¡Œè®¡ç®—èƒ½åŠ›</li>
</ul>
<p>è¿™ä¸ºå¤§è§„æ¨¡é¢„è®­ç»ƒæ¨¡å‹å¥ å®šäº†åŸºç¡€ã€‚</p>
<hr/>
<h3 data-id="heading-12">é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ä¸å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰</h3>
<p>åœ¨ Transformer æ¶æ„åŸºç¡€ä¸Šï¼Œäººä»¬æå‡ºäº†ï¼š</p>
<ul>
<li>é¢„è®­ç»ƒ + å¾®è°ƒï¼ˆPretrain + Finetuneï¼‰</li>
<li>è¶…å¤§è§„æ¨¡è¯­æ–™è®­ç»ƒ</li>
</ul>
<p>æ¨¡å‹é€šè¿‡ä¸€ä¸ªæ ¸å¿ƒä»»åŠ¡è¿›è¡Œå­¦ä¹ ï¼š</p>
<blockquote>
<p><strong>æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ªè¯ï¼ˆTokenï¼‰</strong></p>
</blockquote>
<p>ä½†ç”±äºæ¨¡å‹è§„æ¨¡ã€æ•°æ®è§„æ¨¡å’Œè®­ç»ƒæ–¹å¼çš„è·ƒè¿ï¼Œ<br/>
è¿™ç§â€œé¢„æµ‹â€é€æ¸è¡¨ç°å‡ºï¼š</p>
<ul>
<li>è¯­ä¹‰ç†è§£</li>
<li>æ¨ç†èƒ½åŠ›</li>
<li>ç”Ÿæˆèƒ½åŠ›</li>
</ul>
<p>æœ€ç»ˆå½¢æˆäº†ä»Šå¤©çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€‚</p>
<hr/>
<p>åœ¨è¿™ä¸€é˜¶æ®µï¼š</p>
<ul>
<li>æ¨¡å‹ä¸å†ä¾èµ–äººå·¥è§„åˆ™</li>
<li>ä¸å†ä¾èµ–äººå·¥ç‰¹å¾</li>
<li>å¯ä»¥åœ¨ä¸Šä¸‹æ–‡ä¸­ç»¼åˆç†è§£è¯­è¨€</li>
</ul>
<hr/>
<h3 data-id="heading-13">æ€»ç»“</h3>
<p>å¯ä»¥çœ‹å‡ºï¼Œç›®å‰çš„å¤§è¯­è¨€æ¨¡å‹åœ¨æ•°å­¦æœ¬è´¨ä¸Šä»ç„¶æ˜¯æ¦‚ç‡æ¨¡å‹ï¼Œå…¶æ¨ç†ä¸ç”Ÿæˆèƒ½åŠ›æ¥æºäºç»Ÿè®¡å­¦ä¹ ä¸è§„æ¨¡æ•ˆåº”ï¼Œè€Œéäººç±»æ„ä¹‰ä¸Šçš„ä¸»è§‚æ€è€ƒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Javaè®°å½•ç±»ï¼ˆRecordsï¼‰ä¸æ•°æ®å»ºæ¨¡é©å‘½ï¼šä»POJOåˆ°ä¸å¯å˜æ•°æ®çš„èŒƒå¼è½¬å˜]]></title>    <link>https://juejin.cn/post/7582997593090342931</link>    <guid>https://juejin.cn/post/7582997593090342931</guid>    <pubDate>2025-12-14T08:43:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582997593090342931" data-draft-id="7583215836690104361" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Javaè®°å½•ç±»ï¼ˆRecordsï¼‰ä¸æ•°æ®å»ºæ¨¡é©å‘½ï¼šä»POJOåˆ°ä¸å¯å˜æ•°æ®çš„èŒƒå¼è½¬å˜"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2025-12-14T08:43:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„"/> <meta itemprop="url" content="https://juejin.cn/user/3097787706900985"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Javaè®°å½•ç±»ï¼ˆRecordsï¼‰ä¸æ•°æ®å»ºæ¨¡é©å‘½ï¼šä»POJOåˆ°ä¸å¯å˜æ•°æ®çš„èŒƒå¼è½¬å˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3097787706900985/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åƒè¥¿çº¢æŸ¿é•¿å¤§çš„ç•ªèŒ„
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:43:18.000Z" title="Sun Dec 14 2025 08:43:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252b3a}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px;color:#5e7ce0}.markdown-body h1{font-size:24px;margin-bottom:5px;margin-top:80px;position:relative;text-align:center}.markdown-body h2{font-size:20px;padding-bottom:12px;border-bottom:1px solid #dfe1e6}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px;margin-top:30px}.markdown-body h5{font-size:14px;margin-top:20px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #dfe1e6;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#ffeeed;color:#c73636;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#252b3a;background:#f8f8f8}.markdown-body a{position:relative;text-decoration:none;color:#5e7ce0;padding-right:18px;padding-bottom:4px}.markdown-body a[href^=http]:after{position:absolute;display:inline-block;width:16px;height:16px;margin-left:2px;margin-top:6px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAACCgAwAEAAAAAQAAACAAAAAAX7wP8AAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDYuMC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KGV7hBwAABWVJREFUWAnlVktsVFUY/s85997pC9BOTKxRWnEKsXWlxjWJj0RWJjrFAAXjAlewYWOkgauACVu7a2IiNUEyExM3yoZE3Wmi7qgPJthJBDE6JUNpO3Mf5/j95/bOTOcBlBgXejJ37rn/Of/7O/9/iP7vQ/zTAcjnC4ry+a5ii1OkiYTpuvjvEc0Gp51uivP+ZW+QBuSW4QjW5rptAa1Ey0uOGKOxwPetVyafN6p/52/PkNBbjdAhGaGEpMRjLZTryB8+9MUSYSGNRIcBvm8kBAY9tHYlHz78nTs392xIkwv9FA3Oe33bdoX1ZZKOS0bH0CXI6RugYLW6BwIu5gskkQ4sEG0wYF25PjBzbZfSYY6kDLUmWMt7FR7Lw3xYUkaTdjxHfTPnPwav0iEGYADVa9XIRIEyxrAA0jIQxgFL22gYwF7A8/DAzNVdksJvJaTEUZ2kYnZWziN5s1ADPHneEIXByotYuMSrf9JEbbsuv7VcvbaKML8plXtQR0EdIYDqWEmtOgAomZFH8EjWSnek2ulmtljljttHbmaIHCCCHzd9MjwfsmscBeZH9Jyd10nMvz92UQrtCBKvMF06mQy0SiEdRMEGg8mN0YjAlgoDDkPrMI5qJKSkKKydpbB2CZjJkhIBvOBw2CGQgii85bpx//dMqFRKam5uvH7w+K97oe+Cl0HO68uIBH0qyEzpOMwIbZIcFq0I+9cwoElizCjk2KFI1y7Nnx614W1db58fOXIlMzs7Xn/jeDmvBV2Q0mXjGf554O/m4LZHp2N8r61WPMvLZWLdiC4GMAk5BjeeB5lhv39l6+BIbu3m760hXMDKBD08XBKzR8fr04nygnIypOOAJUx/fHrsi0Mnys+vVK+V4VUohaiyPCo2Q9DFALvF/ikw8WS4QvVZALS5ksw47/7R8ejgTPk1UFqU6/3zp8bOM7B/kdu/fkguPGU5JibW+F0sTjWOUw8DklRrg4BiLGeBqbaRLxjlT4no0InFV402RcftJz41cH/f/JnHP3kZaaF6VX/liwist9vYG5+NU9Cg3MNkt/+lU5wS8fTxq3mc7ILjDlAE4CJpe89BOWPiIjBhi9O6PI4G1jsc6RGB3lZwmS76k8H0zOKTkFboG8jS2krFKCX2fvTeaPHIBwAkMHHgncURnL3nuCSnxSopdIzN5th0BIonJ0Lf9yUA9iMkzdRWl3BixOusfDcwQVcS4UKIFwYfGPnM8wY/DyP9NFMXaTE5BU39tGkDgGZz+fJJG0oYcSaOafLcqdECY4LzfSObSzyUOgxqtyisr8SSNOOAkubWoh3TTaeA2YtFEXPnm5x81/j+6MI6JqyS25WSNU6hbCMKHG84marJbdR+vwakRhQLRuQpbzHRLjmpmijI+OmWCtq+LzWtnX5v30gHSsqmWne74DtiACi2+Wz0iXbuLt9D2cDyoPEkWOiyp5XUIwLMi/wJY1FbH5B9ONtdC1KrsD/Q0MCQAS0wccILORDW25amAeOtooAj/KQxfzF17uwTSQ1v3dJ7jnLINwdZYRDa4tPU0sHVXFo/vxFF5BqFqxRfOmgPCk4ft2NgKTCy2Y47JIEg+MIhjYsLy5I25qUYTQlCjMRHsr/UwdYwIK33UO1J5fFNB9XNO6akcywJofVmXQDP2wfrSPcI2xG5BSs3I+IosHr4EtvO1TDAu16xHQq5+ykMblfRXLbhEoFIdDTBdhldvzl+3CMg60ZktI2vNzLW6IIp0waLklot9L63yzuUp8dJd7bglPFe3hIXstBEP58/s6Ocyr4rH2+866ZNbriTzA0RSOWCwakMl1QJgculxPt8Z7O5GLdtW6bvU8R/nO1vb+hMExVAVtEAAAAASUVORK5CYII=");background-size:100%}.markdown-body a:active,.markdown-body a:hover{border-bottom:2px solid #5e7ce0}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #5e7ce0;border-spacing:0}.markdown-body thead{color:#fff;text-align:left}.markdown-body thead tr{background:#5e7ce0}.markdown-body thead th{border-bottom:1px solid #dfe1e6}.markdown-body tr{background-color:#fff}.markdown-body tr:nth-child(2n){background-color:#f2f5fc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#252b3a;padding:1px 23px;margin:22px 0;border-left:4px solid #5e7ce0;background-color:#f2f5fc}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{padding-left:10px;margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5e7ce0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ul li::marker{content:"â€¢";color:#5e7ce0}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}.markdown-body input[type=checkbox]:before{display:inline-block;width:16px;height:16px;content:"";background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAAAhRJREFUeAHtnLEuBFEUhs9cu7JCskEhIrZAgYZGoREPwBuIygOoPITKA6jEG/AAolFoaFCgICIKZBNiY8Pyz5rNOWe9wNz5T7N3Z2eT/b/7zZlpziat3xKWBDJoEyh5EDd3DTk5r8vV7Yc8vzbl6zvfwvSERIYHyzI90SeLc1WZrFV85PR9oi+N/YMnOT6t/3tiLAeXFqqytjrSFacDYmfvQS6u37tOiPHA7FS/bK6PmWhpj4AJRYGA9MiKzLpK6An+cqiNVmRleUhArrec6PNzt/5sttLgh0cvcvfY6Px+ZNY9I6Ax6gKErY1xmZ8ZyD0E5MJGIgsyIZsunT3g7qALJuTdAp0nWyMTsunS2QNukbpwOcRaPpvOHvxzQow2ZBvrs+nsfLL8o0QQBJFdMO1XGkEjaIQlQCMsD/YIGkEjLAEaYXmwR9AIGmEJ0AjLgz2CRtAIS4BGWB7sETSCRlgCNMLyYI+gETTCEqARlgd7BI2gEZYAjbA82CNoBI2wBGiE5cEeQSNohCVAIywP9ggaQSMsARphebBH0AgaYQnQCMsjYC5SF2agYi2fTWcPGA7VFfO0n8+mswdMyOrCNJwnpz/P6xqZkE2Xzh4w8qcLI4Hbu/dydvkWBRAAQBZk0uOOyKyzp5PARRiF1puNtR+NTh+oMCvtJ+D8F2N6j6x+PrwzG46gRTDDm5BtsAGBg0X924Qfj7i23p7HNgQAAAAASUVORK5CYII=");background-size:100%;position:relative;right:2px;top:-5px}.markdown-body input[type=checkbox]:checked:before{background:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAYAAADjVADoAAAK2GlDQ1BJQ0MgUHJvZmlsZQAASImVlwdUU9kWhs+96Y0WiHRC70gngJTQQxGkg6iEJJBQYkgIKmJnUMGxoCKCZcSKKFhGQMaCWLANAopdJ8igoD4HC6Ki5t3AI8zMW++99fZaJ+dbO/vss/e55671XwAoYWyRKBdWAyBPWCCODQ2gJ6ek0nHPAQRgQAI2wIHNkYiYMTGRALHJ+a/28S4Sjdhte0Wuf///v5oGlyfhAAClIZzBlXDyEG5DxkuOSFwAAOoI4jddUCBScBfCmmKkQIR/V3DWBH9ScMY4o8njMfGxgQjTAcCT2WxxFgBkO8RPL+RkIXnIih4chVyBEOFihH05fDYX4TMI2+XlzVfwIMJWSLwIAApyOoCR8aecWX/Jn6HMz2ZnKXmir3HDBwkkolz2ov/zaP635eVKJ/ewQAaZLw6LVeyHnN/9nPkRShZmzIyeZAF3oiYF86VhCZPMkQSmTjKXHRShXJs7M3KSMwUhLGWeAlb8JPMkwXGTLJ4fq9wrUxzInGS2eHxfIsIyaU6C0s/nsZT5i/jxSZNcKEicOcmSnLiIqZhApV8sjVXWzxOGBkztG6LsPU/yp34FLOXaAn58mLJ39lT9PCFzKqckWVkblxcUPBWToIwXFQQo9xLlxijjebmhSr+kME65tgC5nFNrY5RnmM0Oj5lkIABRgA04dNVJAqCAt7BA0UjgfNEisSCLX0BnIm8bj84Schzs6M6Ozs4AKN7dievwnjb+TkK061O+NYjHr10ul5+e8oUi9/i4KfJYbk35LCsAUNUD4Op+jlRcOOFDK34wyNNTBZpABxgCU2AF7IEzcAfewB8Eg3AQDeJBCpiL1MoHeUAMFoBisAKUgnKwEWwF1WA32AsOgaPgBGgGZ8AFcAXcAF2gFzwCMjAAXoFh8BGMQRCEgygQFdKBjCBzyBZyhhiQLxQMRUKxUAqUDmVBQkgKFUOroHKoAqqG9kB10HHoNHQBugZ1Qw+gPmgIegd9gVEwGdaEDWALeDrMgJlwBBwPz4Gz4Hy4CC6B18NVcC18BG6CL8A34F5YBr+CR1AARULRUMYoexQDFYiKRqWiMlFi1FJUGaoSVYtqQLWiOlC3UTLUa9RnNBZNRdPR9mhvdBg6Ac1B56OXotehq9GH0E3oS+jb6D70MPo7hoLRx9hivDAsTDImC7MAU4qpxBzAnMJcxvRiBjAfsVgsDWuJ9cCGYVOw2djF2HXYndhGbBu2G9uPHcHhcDo4W5wPLhrHxhXgSnHbcUdw53E9uAHcJzwJb4R3xofgU/FC/Ep8Jf4w/hy+B/8CP0ZQI5gTvAjRBC5hEWEDYR+hlXCLMEAYI6oTLYk+xHhiNnEFsYrYQLxMfEx8TyKRTEiepFkkAWk5qYp0jHSV1Ef6TNYg25ADyWlkKXk9+SC5jfyA/J5CoVhQ/CmplALKekod5SLlKeWTClXFQYWlwlVZplKj0qTSo/JGlaBqrspUnatapFqpelL1luprNYKahVqgGlttqVqN2mm1e2oj6lR1J/Vo9Tz1deqH1a+pD2rgNCw0gjW4GiUaezUuavRTUVRTaiCVQ11F3Ue9TB3QxGpaarI0szXLNY9qdmoOa2louWolai3UqtE6qyWjoWgWNBYtl7aBdoJ2l/ZlmsE05jTetLXTGqb1TBvV1tP21+Zpl2k3avdqf9Gh6wTr5Ohs0mnWeaKL1rXRnaW7QHeX7mXd13qaet56HL0yvRN6D/VhfRv9WP3F+nv1b+qPGBgahBqIDLYbXDR4bUgz9DfMNtxieM5wyIhq5GskMNpidN7oJV2LzqTn0qvol+jDxvrGYcZS4z3GncZjJpYmCSYrTRpNnpgSTRmmmaZbTNtNh82MzKLMis3qzR6aE8wZ5nzzbeYd5qMWlhZJFqstmi0GLbUtWZZFlvWWj60oVn5W+Va1VnessdYM6xzrndZdNrCNmw3fpsbmli1s624rsN1p222HsfO0E9rV2t2zJ9sz7Qvt6+37HGgOkQ4rHZod3kw3m546fdP0junfHd0ccx33OT5y0nAKd1rp1Or0ztnGmeNc43zHheIS4rLMpcXlrautK891l+t9N6pblNtqt3a3b+4e7mL3BvchDzOPdI8dHvcYmowYxjrGVU+MZ4DnMs8znp+93L0KvE54/eFt753jfdh7cIblDN6MfTP6fUx82D57fGS+dN903598ZX7Gfmy/Wr9n/qb+XP8D/i+Y1sxs5hHmmwDHAHHAqYDRQK/AJYFtQaig0KCyoM5gjeCE4OrgpyEmIVkh9SHDoW6hi0PbwjBhEWGbwu6xDFgcVh1rONwjfEn4pQhyRFxEdcSzSJtIcWRrFBwVHrU56vFM85nCmc3RIJoVvTn6SYxlTH7ML7Ows2Jm1cx6HusUWxzbEUeNmxd3OO5jfED8hvhHCVYJ0oT2RNXEtMS6xNGkoKSKJFny9OQlyTdSdFMEKS2puNTE1AOpI7ODZ2+dPZDmllaadneO5ZyFc67N1Z2bO/fsPNV57Hkn0zHpSemH07+yo9m17JEMVsaOjGFOIGcb5xXXn7uFO8Tz4VXwXmT6ZFZkDmb5ZG3OGuL78Sv5rwWBgmrB2+yw7N3ZoznROQdz5LlJuY15+Lz0vNNCDWGO8NJ8w/kL53eLbEWlIlm+V/7W/GFxhPiABJLMkbQUaCIi6abUSvqDtK/Qt7Cm8NOCxAUnF6ovFC68uchm0dpFL4pCivYvRi/mLG4vNi5eUdy3hLlkz1JoacbS9mWmy0qWDSwPXX5oBXFFzopfVzqurFj5YVXSqtYSg5LlJf0/hP5QX6pSKi69t9p79e416DWCNZ1rXdZuX/u9jFt2vdyxvLL86zrOuus/Ov1Y9aN8feb6zg3uG3ZtxG4Ubry7yW/ToQr1iqKK/s1Rm5u20LeUbfmwdd7Wa5Wulbu3EbdJt8mqIqtatptt37j9azW/urcmoKZxh/6OtTtGd3J39uzy39Ww22B3+e4vPwl+ur8ndE9TrUVt5V7s3sK9z/cl7uvYz9hfd0D3QPmBbweFB2WHYg9dqvOoqzusf3hDPVwvrR86knak62jQ0ZYG+4Y9jbTG8mPgmPTYy+Ppx++eiDjRfpJxsuFn8593nKKeKmuCmhY1DTfzm2UtKS3dp8NPt7d6t576xeGXg2eMz9Sc1Tq74RzxXMk5+fmi8yNtorbXF7Iu9LfPa390MfninUuzLnVejrh89UrIlYsdzI7zV32unrnmde30dcb15hvuN5puut089avbr6c63Tubbnncauny7GrtntF9rsev58LtoNtX7rDu3Oid2dt9N+Hu/Xtp92T3ufcHH+Q+ePuw8OHYo+WPMY/Lnqg9qXyq/7T2N+vfGmXusrN9QX03n8U9e9TP6X/1u+T3rwMlzynPK18YvagbdB48MxQy1PVy9suBV6JXY69L/6H+jx1vrN78/If/HzeHk4cH3orfyt+te6/z/uAH1w/tIzEjTz/mfRwbLfuk8+nQZ8bnji9JX16MLfiK+1r1zfpb6/eI74/leXK5iC1mj0sBFDLgzEwA3h1EtHEKAFRElxNnT2jrcYMmvgfGCfwnntDf4+YOQAMyKWQR0x+Akwo5i8wqyKyQRPH+AHZxUY5/mSTTxXkiFxlRlphPcvl7AwBwrQB8E8vlYzvl8m/7kGIfANCWP6HpFYZFtHyD3vJRg6LbPe3g7zah9//U499noKjAFfx9/ieoZhkWVvYkwwAAAGxlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAACQAAAAAQAAAJAAAAABAAKgAgAEAAAAAQAAAEKgAwAEAAAAAQAAAEIAAAAAgodoEQAAAAlwSFlzAAAWJQAAFiUBSVIk8AAABMtJREFUeAHtXM2KFDEQzrQKruIu4mEXRFlUVLz4A4K7B99AcO8io0/gwQfxDVzFuwu+gQf34EG8iOAPKAh6EFlBFMSf/qa2uqszlVR6ZtYxM5PDJNVVSer78nU6KrHzpyxuVlwx44AY2O0T8eb9D7f5fMu9fPvdff7y0/36nbdgdhUdd+jgHnf62JxbObvgjh/d60Pu2R35ajx49Mk9frqlBk7Kw8sXF9y1K4t9cCoi7tz/4F68/tYXMIkPzpzY725dP9yA1tsjoIRpIQHogRWYZSmwJ4Reh06nI2Nd7rYEA8zAzqXAxhgq/pc1d9vHKbEX+Dr4JbzypJDc/YxXYi/wifRLeOXpU5q7n/FK7EXsnBBeeRoqd7/EHj1ZhleeiMjdz8pArRKR+0pb+UsCuK0SkftKW/kzeFmrRHCAxWzufsaJOkqExWzufpOI8EpP1jnCJCK80pN1jjCJ4ICwMigidz/jRD3bI7bZUInIfaWt/KUSuK0SEd4jqFvufgYva5UIDrCYzd3POFFHifhfV/7k8lwPw7D5mUSEV3r854ju2pK7ffOIWzk/X+Go803Lr+ooGqoiwkyP9xzRXVt0q9sE3CgJYTLqfNPyE/irpkoEe2um6ck4bSiBSeD8JBl41jY/Hgd1lIiaaeoyLlsjgUGAjEH3DB4DtUpEW2Z3Mj5GAgA8efbVvXpX/200nln5IMYvKhHDrvylcwdc9+pSNdeg46WQsP7wo2s7fpWYaPT926fw9ZiVk4BpywYJkGuvlJs4EuWS0p/HTyHh3kbzH2najM85cR0lgpPiYMtukFB26m1u5Ua+vkFkWP3Zn0KCJDg1Px6f42Wtvhrhdyz8ncanrFKCmGH1wrwDMCrh/uxPIUFTAvdHbeVPsc1fVRE+c7Ud/k6fWt7XHFlYqcqQ5wTRvWpiY4wrIZwfDUL+akDRUBXB/jCzFCH9SHCzTDRUmsro7z+cEvrHwxOZn2ZTL/pVFcEBtRLoiWXfxQ5ehvoHHx4vpIwUEuJKSMvPz5/zQq0qwmIy5m+rjBQSwnsCQYnlgwjfT72av6oifOba2qnKcOXeGVIP0rT3BALTNr8mBWSpRHAgmJSTtLGhDHwj+A9GPCbX2DNiBSRoShg0H8zl5y/njxIhJ0WntralDJmIbO+UEvz85Zwt9wj7HIDB5Ttp7RkyGbRDSqC49vOjX50P9aexmr+qInzmajvtO13H02SpyrCVMNj8dT7/4BwByDXzRIC0LWXEldA/njVfip9GpV9VERxQM0lPhrVDyrCVMJr5/fwZJ+qWewR1lSuNJ21sXxnjVgIhck5VhM/cqG1WBpIAMX4Z9Xz+eP58sFUiOBArLQcZpQ0CNCXt1HzA5OfPOFGrrwYHyKTwbNJsxolaJUJbKeo0mu/4uMeXBHBbJSK88qP5jo97fAYva5UIDgivHEXk7mecqKNEhFeOhsjdbxKR+0pb+UsCuK0qIveVtvJn8LJWieAAi9nc/YwTdZQIi9nc/SYR4ZWenSO2yZvgcwTuRYZKWBnUI3e/xF7gcmio5L4HWPlL7AVuyPol95W28me8EnuBa8J+sZjM3c94JfYCd6VxTXjaCjDLe+K9cwTuSuOa8LQUYPXvh1d3w0HC7JK8kMK0/rcJfwHkVMYgi4xhOgAAAABJRU5ErkJggg==");background-size:100%}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-light">.hljs-comment,.hljs-quote{color:#696969}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#d91e18}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#aa5d00}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:green}.hljs-section,.hljs-title{color:#007faa}.hljs-keyword,.hljs-selector-tag{color:#7928a1}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fefefe;color:#545454}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å¼•è¨€ï¼šJavaæ•°æ®ç±»çš„æ¼”è¿›å›°å¢ƒ</h2>
<p>åœ¨Javaæ¼«é•¿çš„å‘å±•å†ç¨‹ä¸­ï¼Œå»ºæ¨¡ç®€å•æ•°æ®è½½ä½“ä¸€ç›´æ˜¯ç¹çä¸”å®¹æ˜“å‡ºé”™çš„ã€‚ä¼ ç»Ÿçš„POJOï¼ˆPlain Old Java Objectï¼‰éœ€è¦å¤§é‡æ ·æ¿ä»£ç ï¼šæ„é€ å‡½æ•°ã€è®¿é—®å™¨ã€equals()ã€hashCode()å’ŒtoString()æ–¹æ³•ã€‚Java 14å¼•å…¥çš„è®°å½•ç±»ï¼ˆRecordsï¼‰ç‰¹æ€§ï¼Œæ ‡å¿—ç€Javaåœ¨æ•°æ®å»ºæ¨¡é¢†åŸŸçš„é‡å¤§çªç ´ï¼Œæä¾›äº†ä¸€ç§ç®€æ´ã€å®‰å…¨ä¸”è¡¨è¾¾åŠ›å¼ºçš„ä¸å¯å˜æ•°æ®è½½ä½“å®ç°æ–¹å¼ã€‚</p>
<h2 data-id="heading-1">ä¸€ã€è®°å½•ç±»ï¼šè¯­æ³•é©å‘½ä¸æœ¬è´¨ç‰¹å¾</h2>
<h3 data-id="heading-2">1.1 ä»ä¼ ç»ŸPOJOåˆ°è®°å½•ç±»çš„æ¼”è¿›</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ ç»ŸPOJOå®ç° - ç¹çä¸”é‡å¤</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TraditionalPerson</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> age;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String email;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TraditionalPerson</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age, String email)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
        <span class="hljs-built_in">this</span>.email = email;
    }
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> name; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> age; }
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getEmail</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> email; }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object o)</span> {
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span> == o) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (o == <span class="hljs-literal">null</span> || getClass() != o.getClass()) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-type">TraditionalPerson</span> <span class="hljs-variable">that</span> <span class="hljs-operator">=</span> (TraditionalPerson) o;
        <span class="hljs-keyword">return</span> age == that.age &amp;&amp; 
               Objects.equals(name, that.name) &amp;&amp; 
               Objects.equals(email, that.email);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Objects.hash(name, age, email);
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"TraditionalPerson{name='"</span> + name + <span class="hljs-string">"', age="</span> + age + 
               <span class="hljs-string">", email='"</span> + email + <span class="hljs-string">"'}"</span>;
    }
}

<span class="hljs-comment">// è®°å½•ç±»å®ç° - ç®€æ´æ˜äº†</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age, String email)</span> {
    <span class="hljs-comment">// ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆï¼š</span>
    <span class="hljs-comment">// 1. ç§æœ‰finalå­—æ®µ</span>
    <span class="hljs-comment">// 2. è§„èŒƒæ„é€ å‡½æ•°</span>
    <span class="hljs-comment">// 3. è®¿é—®å™¨æ–¹æ³• (name(), age(), email())</span>
    <span class="hljs-comment">// 4. equals(), hashCode(), toString()</span>
}
</code></pre>
<h3 data-id="heading-3">1.2 è®°å½•ç±»çš„æ·±å±‚è¯­ä¹‰ç‰¹æ€§</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•ç±»çš„æœ¬è´¨æ˜¯ä¸å¯å˜æ•°æ®è½½ä½“</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">ImmutablePoint</span><span class="hljs-params">(<span class="hljs-type">double</span> x, <span class="hljs-type">double</span> y)</span> {
    <span class="hljs-comment">// è®°å½•ç±»éšå¼å®šä¹‰ä¸ºfinalï¼Œä¸èƒ½ç»§æ‰¿</span>
    <span class="hljs-comment">// å­—æ®µéšå¼ä¸ºprivate final</span>
}

<span class="hljs-comment">// è®°å½•ç±»å¯ä»¥å£°æ˜é™æ€å­—æ®µå’Œæ–¹æ³•</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Employee</span><span class="hljs-params">(String id, String name, Department dept)</span> {
    <span class="hljs-comment">// é™æ€å­—æ®µ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DEFAULT_ID</span> <span class="hljs-operator">=</span> <span class="hljs-string">"EMP_001"</span>;
    
    <span class="hljs-comment">// é™æ€å·¥å‚æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Employee <span class="hljs-title function_">createDefault</span><span class="hljs-params">(String name, Department dept)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>(DEFAULT_ID, name, dept);
    }
    
    <span class="hljs-comment">// é™æ€å·¥å…·æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isValidId</span><span class="hljs-params">(String id)</span> {
        <span class="hljs-keyword">return</span> id != <span class="hljs-literal">null</span> &amp;&amp; id.startsWith(<span class="hljs-string">"EMP_"</span>);
    }
}

<span class="hljs-comment">// è®°å½•ç±»å¯ä»¥å®ç°æ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Identifiable</span> {
    String <span class="hljs-title function_">getId</span><span class="hljs-params">()</span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Product</span><span class="hljs-params">(String id, String name, BigDecimal price)</span> 
    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Identifiable</span> {
    <span class="hljs-comment">// getId() è‡ªåŠ¨é€šè¿‡ id() è®¿é—®å™¨å®ç°</span>
}
</code></pre>
<h2 data-id="heading-4">äºŒã€è®°å½•ç±»çš„è¿›é˜¶ç‰¹æ€§ä¸æ¨¡å¼</h2>
<h3 data-id="heading-5">2.1 ç´§å‡‘æ„é€ å‡½æ•°ä¸éªŒè¯é€»è¾‘</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨ç´§å‡‘æ„é€ å‡½æ•°è¿›è¡ŒéªŒè¯å’Œè§„èŒƒåŒ–</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">EmailAddress</span><span class="hljs-params">(String localPart, String domain)</span> {
    <span class="hljs-comment">// ç´§å‡‘æ„é€ å‡½æ•° - æ²¡æœ‰å‚æ•°åˆ—è¡¨ï¼Œç›´æ¥è®¿é—®ç»„ä»¶</span>
    <span class="hljs-keyword">public</span> EmailAddress {
        <span class="hljs-comment">// å‚æ•°éªŒè¯</span>
        <span class="hljs-keyword">if</span> (localPart == <span class="hljs-literal">null</span> || localPart.isBlank()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æœ¬åœ°éƒ¨åˆ†ä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">if</span> (domain == <span class="hljs-literal">null</span> || domain.isBlank()) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"åŸŸåä¸èƒ½ä¸ºç©º"</span>);
        }
        <span class="hljs-keyword">if</span> (!domain.contains(<span class="hljs-string">"."</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æ— æ•ˆçš„åŸŸåæ ¼å¼"</span>);
        }
        
        <span class="hljs-comment">// è§„èŒƒåŒ–ï¼ˆå°å†™è½¬æ¢ï¼‰</span>
        localPart = localPart.toLowerCase();
        domain = domain.toLowerCase();
    }
    
    <span class="hljs-comment">// æ·»åŠ ä¾¿æ·æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">fullAddress</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> localPart + <span class="hljs-string">"@"</span> + domain;
    }
    
    <span class="hljs-comment">// å·¥å‚æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> EmailAddress <span class="hljs-title function_">parse</span><span class="hljs-params">(String email)</span> {
        String[] parts = email.split(<span class="hljs-string">"@"</span>);
        <span class="hljs-keyword">if</span> (parts.length != <span class="hljs-number">2</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"æ— æ•ˆçš„é‚®ç®±æ ¼å¼"</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmailAddress</span>(parts[<span class="hljs-number">0</span>], parts[<span class="hljs-number">1</span>]);
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-type">EmailAddress</span> <span class="hljs-variable">email</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EmailAddress</span>(<span class="hljs-string">"John.Doe"</span>, <span class="hljs-string">"example.com"</span>);
        System.out.println(email.fullAddress()); <span class="hljs-comment">// john.doe@example.com</span>
        
        <span class="hljs-type">EmailAddress</span> <span class="hljs-variable">parsed</span> <span class="hljs-operator">=</span> EmailAddress.parse(<span class="hljs-string">"jane@example.org"</span>);
        System.out.println(parsed); <span class="hljs-comment">// EmailAddress[localPart=jane, domain=example.org]</span>
    }
}
</code></pre>
<h3 data-id="heading-6">2.2 è®°å½•ç±»ä¸æ¨¡å¼åŒ¹é…çš„ååŒ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•ç±»ä¸instanceofæ¨¡å¼åŒ¹é…å®Œç¾ç»“åˆ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PatternMatchingDemo</span> {
    
    <span class="hljs-comment">// å®šä¹‰è®°å½•ç±»å±‚æ¬¡ç»“æ„</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">sealed</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Shape</span> <span class="hljs-keyword">permits</span> Circle, Rectangle, Triangle {
        <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> radius)</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Shape</span> {
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> Math.PI * radius * radius; }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Rectangle</span><span class="hljs-params">(<span class="hljs-type">double</span> width, <span class="hljs-type">double</span> height)</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Shape</span> {
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> width * height; }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Triangle</span><span class="hljs-params">(<span class="hljs-type">double</span> base, <span class="hljs-type">double</span> height)</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Shape</span> {
        <span class="hljs-meta">@Override</span> <span class="hljs-keyword">public</span> <span class="hljs-type">double</span> <span class="hljs-title function_">area</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span> * base * height; }
    }
    
    <span class="hljs-comment">// ä½¿ç”¨æ¨¡å¼åŒ¹é…å¤„ç†è®°å½•ç±»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">describeShape</span><span class="hljs-params">(Shape shape)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">switch</span> (shape) {
            <span class="hljs-keyword">case</span> Circle c -&gt; 
                String.format(<span class="hljs-string">"åœ†å½¢: åŠå¾„=%.2f, é¢ç§¯=%.2f"</span>, c.radius(), c.area());
            <span class="hljs-keyword">case</span> Rectangle r -&gt; 
                String.format(<span class="hljs-string">"çŸ©å½¢: å®½=%.2f, é«˜=%.2f, é¢ç§¯=%.2f"</span>, 
                    r.width(), r.height(), r.area());
            <span class="hljs-keyword">case</span> Triangle t -&gt; 
                String.format(<span class="hljs-string">"ä¸‰è§’å½¢: åº•=%.2f, é«˜=%.2f, é¢ç§¯=%.2f"</span>, 
                    t.base(), t.height(), t.area());
        };
    }
    
    <span class="hljs-comment">// åµŒå¥—æ¨¡å¼åŒ¹é…</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processGeometricData</span><span class="hljs-params">(Object data)</span> {
        <span class="hljs-keyword">if</span> (data <span class="hljs-keyword">instanceof</span> Shape[] shapes) {
            <span class="hljs-keyword">for</span> (Shape shape : shapes) {
                <span class="hljs-keyword">if</span> (shape <span class="hljs-keyword">instanceof</span> <span class="hljs-title function_">Circle</span><span class="hljs-params">(<span class="hljs-type">double</span> radius)</span> &amp;&amp; radius &gt; <span class="hljs-number">10</span>) {
                    System.out.println(<span class="hljs-string">"å¤§åœ†: "</span> + radius);
                }
            }
        }
    }
}
</code></pre>
<h2 data-id="heading-7">ä¸‰ã€è®°å½•ç±»åœ¨é¢†åŸŸå»ºæ¨¡ä¸­çš„å®è·µ</h2>
<h3 data-id="heading-8">3.1 DTOå’Œå€¼å¯¹è±¡çš„ç†æƒ³é€‰æ‹©</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// APIæ•°æ®ä¼ è¾“å¯¹è±¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">ApiResponse</span>&lt;T&gt;(
    <span class="hljs-type">boolean</span> success,
    String message,
    T data,
    Instant timestamp,
    String requestId
) {
    <span class="hljs-comment">// ä¾¿æ·å·¥å‚æ–¹æ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; ApiResponse&lt;T&gt; <span class="hljs-title function_">success</span><span class="hljs-params">(T data, String requestId)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiResponse</span>&lt;&gt;(<span class="hljs-literal">true</span>, <span class="hljs-string">"æˆåŠŸ"</span>, data, Instant.now(), requestId);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; ApiResponse&lt;T&gt; <span class="hljs-title function_">error</span><span class="hljs-params">(String message, String requestId)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiResponse</span>&lt;&gt;(<span class="hljs-literal">false</span>, message, <span class="hljs-literal">null</span>, Instant.now(), requestId);
    }
}

<span class="hljs-comment">// é¢†åŸŸå€¼å¯¹è±¡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Money</span><span class="hljs-params">(BigDecimal amount, Currency currency)</span> 
    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;Money&gt; {
    
    <span class="hljs-keyword">public</span> Money {
        Objects.requireNonNull(amount, <span class="hljs-string">"é‡‘é¢ä¸èƒ½ä¸ºç©º"</span>);
        Objects.requireNonNull(currency, <span class="hljs-string">"è´§å¸ä¸èƒ½ä¸ºç©º"</span>);
        <span class="hljs-keyword">if</span> (amount.compareTo(BigDecimal.ZERO) &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"é‡‘é¢ä¸èƒ½ä¸ºè´Ÿæ•°"</span>);
        }
    }
    
    <span class="hljs-comment">// é¢†åŸŸè¡Œä¸º</span>
    <span class="hljs-keyword">public</span> Money <span class="hljs-title function_">add</span><span class="hljs-params">(Money other)</span> {
        requireSameCurrency(other);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(amount.add(other.amount), currency);
    }
    
    <span class="hljs-keyword">public</span> Money <span class="hljs-title function_">subtract</span><span class="hljs-params">(Money other)</span> {
        requireSameCurrency(other);
        <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> amount.subtract(other.amount);
        <span class="hljs-keyword">if</span> (result.compareTo(BigDecimal.ZERO) &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"ä½™é¢ä¸è¶³"</span>);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(result, currency);
    }
    
    <span class="hljs-keyword">public</span> Money <span class="hljs-title function_">multiply</span><span class="hljs-params">(BigDecimal multiplier)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Money</span>(amount.multiply(multiplier), currency);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">requireSameCurrency</span><span class="hljs-params">(Money other)</span> {
        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.currency.equals(other.currency)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"è´§å¸ä¸åŒ¹é…: "</span> + 
                <span class="hljs-built_in">this</span>.currency + <span class="hljs-string">" vs "</span> + other.currency);
        }
    }
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(Money other)</span> {
        requireSameCurrency(other);
        <span class="hljs-keyword">return</span> amount.compareTo(other.amount);
    }
}
</code></pre>
<h3 data-id="heading-9">3.2 å¤æ‚æ•°æ®ç»“æ„çš„ç®€æ´è¡¨ç¤º</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ ‘å½¢ç»“æ„</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">TreeNode</span>&lt;T&gt;(
    T value,
    List&lt;TreeNode&lt;T&gt;&gt; children
) {
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TreeNode</span><span class="hljs-params">(T value)</span> {
        <span class="hljs-built_in">this</span>(value, List.of());
    }
    
    <span class="hljs-comment">// æ·»åŠ å­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">public</span> TreeNode&lt;T&gt; <span class="hljs-title function_">addChild</span><span class="hljs-params">(TreeNode&lt;T&gt; child)</span> {
        List&lt;TreeNode&lt;T&gt;&gt; newChildren = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(children);
        newChildren.add(child);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>&lt;&gt;(value, newChildren);
    }
    
    <span class="hljs-comment">// æ·±åº¦ä¼˜å…ˆéå†</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dfs</span><span class="hljs-params">(Consumer&lt;T&gt; visitor)</span> {
        visitor.accept(value);
        <span class="hljs-keyword">for</span> (TreeNode&lt;T&gt; child : children) {
            child.dfs(visitor);
        }
    }
}

<span class="hljs-comment">// å›¾ç»“æ„</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Graph</span>&lt;T&gt;(
    Set&lt;T&gt; vertices,
    Map&lt;T, Set&lt;T&gt;&gt; adjacencyList
) {
    <span class="hljs-keyword">public</span> Graph {
        adjacencyList = Map.copyOf(adjacencyList);
        vertices = Set.copyOf(vertices);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> &lt;T&gt; Graph&lt;T&gt; <span class="hljs-title function_">fromEdges</span><span class="hljs-params">(List&lt;Edge&lt;T&gt;&gt; edges)</span> {
        Map&lt;T, Set&lt;T&gt;&gt; adjList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();
        Set&lt;T&gt; verts = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;();
        
        <span class="hljs-keyword">for</span> (Edge&lt;T&gt; edge : edges) {
            verts.add(edge.from());
            verts.add(edge.to());
            adjList.computeIfAbsent(edge.from(), k -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashSet</span>&lt;&gt;())
                  .add(edge.to());
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Graph</span>&lt;&gt;(verts, adjList);
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Edge</span>&lt;T&gt;(T from, T to) {}
</code></pre>
<h2 data-id="heading-10">å››ã€è®°å½•ç±»ä¸é›†åˆæ¡†æ¶çš„é›†æˆ</h2>
<h3 data-id="heading-11">4.1 ä¸å¯å˜é›†åˆä¸è®°å½•ç±»çš„å®Œç¾ç»“åˆ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä½¿ç”¨è®°å½•ç±»è¡¨ç¤ºä¸å¯å˜æ•°æ®é›†åˆ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Dataset</span><span class="hljs-params">(
    String name,
    List&lt;DataPoint&gt; points,
    Map&lt;String, StatisticalSummary&gt; statistics
)</span> {
    <span class="hljs-keyword">public</span> Dataset {
        <span class="hljs-comment">// é˜²å¾¡æ€§å¤åˆ¶ï¼Œç¡®ä¿ä¸å¯å˜æ€§</span>
        points = List.copyOf(points);
        statistics = Map.copyOf(statistics);
    }
    
    <span class="hljs-comment">// è½¬æ¢æ“ä½œï¼Œè¿”å›æ–°å®ä¾‹</span>
    <span class="hljs-keyword">public</span> Dataset <span class="hljs-title function_">filter</span><span class="hljs-params">(Predicate&lt;DataPoint&gt; predicate)</span> {
        List&lt;DataPoint&gt; filtered = points.stream()
            .filter(predicate)
            .toList();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dataset</span>(name, filtered, calculateStatistics(filtered));
    }
    
    <span class="hljs-keyword">public</span> Dataset <span class="hljs-title function_">map</span><span class="hljs-params">(Function&lt;DataPoint, DataPoint&gt; mapper)</span> {
        List&lt;DataPoint&gt; mapped = points.stream()
            .map(mapper)
            .toList();
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dataset</span>(name, mapped, calculateStatistics(mapped));
    }
    
    <span class="hljs-keyword">private</span> Map&lt;String, StatisticalSummary&gt; <span class="hljs-title function_">calculateStatistics</span><span class="hljs-params">(
            List&lt;DataPoint&gt; dataPoints)</span> {
        <span class="hljs-comment">// è®¡ç®—ç»Ÿè®¡ä¿¡æ¯</span>
        <span class="hljs-keyword">return</span> Map.of();
    }
}

<span class="hljs-comment">// è®°å½•ç±»ä½œä¸ºé›†åˆå…ƒç´ </span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">DataPoint</span><span class="hljs-params">(
    Instant timestamp,
    BigDecimal value,
    String source,
    Map&lt;String, String&gt; metadata
)</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;DataPoint&gt; {
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(DataPoint other)</span> {
        <span class="hljs-keyword">return</span> timestamp.compareTo(other.timestamp);
    }
}

<span class="hljs-comment">// åœ¨Stream APIä¸­ä½¿ç”¨è®°å½•ç±»</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamWithRecords</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;Person&gt; people = List.of(
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>, <span class="hljs-string">"alice@example.com"</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Bob"</span>, <span class="hljs-number">25</span>, <span class="hljs-string">"bob@example.com"</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Charlie"</span>, <span class="hljs-number">35</span>, <span class="hljs-string">"charlie@example.com"</span>)
        );
        
        <span class="hljs-comment">// ä½¿ç”¨è®°å½•ç±»çš„é€æ˜æ€§</span>
        Map&lt;String, Integer&gt; nameToAge = people.stream()
            .collect(Collectors.toMap(
                Person::name,  <span class="hljs-comment">// ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„è®¿é—®å™¨</span>
                Person::age
            ));
        
        <span class="hljs-comment">// æ¨¡å¼åŒ¹é…ä¸è¿‡æ»¤</span>
        List&lt;String&gt; adultNames = people.stream()
            .filter(p -&gt; p.age() &gt;= <span class="hljs-number">30</span>)
            .map(Person::name)
            .toList();
    }
}
</code></pre>
<h2 data-id="heading-12">äº”ã€è®°å½•ç±»çš„åºåˆ—åŒ–ä¸æŒä¹…åŒ–</h2>
<h3 data-id="heading-13">5.1 JSONåºåˆ—åŒ–é›†æˆ</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•ç±»ä¸Jacksonçš„é›†æˆ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonSerializationDemo</span> {
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">UserProfile</span><span class="hljs-params">(
        @JsonProperty("user_id")</span> String userId,
        <span class="hljs-meta">@JsonProperty("display_name")</span> String displayName,
        <span class="hljs-meta">@JsonProperty("email_address")</span> String email,
        <span class="hljs-meta">@JsonProperty("preferences")</span> Map&lt;String, Object&gt; preferences,
        <span class="hljs-meta">@JsonProperty("created_at")</span> Instant createdAt
    ) {}
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> JsonProcessingException {
        <span class="hljs-type">ObjectMapper</span> <span class="hljs-variable">mapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectMapper</span>()
            .registerModule(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JavaTimeModule</span>())
            .setSerializationInclusion(JsonInclude.Include.NON_NULL);
        
        <span class="hljs-type">UserProfile</span> <span class="hljs-variable">profile</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserProfile</span>(
            <span class="hljs-string">"user123"</span>,
            <span class="hljs-string">"John Doe"</span>,
            <span class="hljs-string">"john@example.com"</span>,
            Map.of(<span class="hljs-string">"theme"</span>, <span class="hljs-string">"dark"</span>, <span class="hljs-string">"notifications"</span>, <span class="hljs-literal">true</span>),
            Instant.now()
        );
        
        <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> mapper.writeValueAsString(profile);
        System.out.println(json);
        
        <span class="hljs-type">UserProfile</span> <span class="hljs-variable">deserialized</span> <span class="hljs-operator">=</span> mapper.readValue(json, UserProfile.class);
        System.out.println(deserialized.equals(profile)); <span class="hljs-comment">// true</span>
    }
}

<span class="hljs-comment">// ä¸JSON-Bçš„é›†æˆ</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Product</span><span class="hljs-params">(
    @JsonbProperty("product-code")</span> String sku,
    <span class="hljs-meta">@JsonbProperty("product-name")</span> String name,
    <span class="hljs-meta">@JsonbProperty("unit-price")</span> BigDecimal price,
    <span class="hljs-meta">@JsonbProperty("in-stock")</span> <span class="hljs-type">boolean</span> inStock
) {}
</code></pre>
<h3 data-id="heading-14">5.2 æ•°æ®åº“æ˜ å°„</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// JPAå®ä½“ä¸è®°å½•ç±»çš„ç»“åˆä½¿ç”¨</span>
<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "orders")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderEntity</span> {
    <span class="hljs-meta">@Id</span>
    <span class="hljs-keyword">private</span> Long id;
    
    <span class="hljs-keyword">private</span> String orderNumber;
    <span class="hljs-keyword">private</span> BigDecimal totalAmount;
    <span class="hljs-keyword">private</span> Instant orderDate;
    
    <span class="hljs-comment">// ä½¿ç”¨è®°å½•ç±»ä½œä¸ºDTO</span>
    <span class="hljs-keyword">public</span> OrderRecord <span class="hljs-title function_">toRecord</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderRecord</span>(id, orderNumber, totalAmount, orderDate);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> OrderEntity <span class="hljs-title function_">fromRecord</span><span class="hljs-params">(OrderRecord record)</span> {
        <span class="hljs-type">OrderEntity</span> <span class="hljs-variable">entity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderEntity</span>();
        entity.id = record.id();
        entity.orderNumber = record.orderNumber();
        entity.totalAmount = record.totalAmount();
        entity.orderDate = record.orderDate();
        <span class="hljs-keyword">return</span> entity;
    }
}

<span class="hljs-comment">// è®°å½•ç±»ä½œä¸ºä¸å¯å˜DTO</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">OrderRecord</span><span class="hljs-params">(
    Long id,
    String orderNumber,
    BigDecimal totalAmount,
    Instant orderDate
)</span> {
    <span class="hljs-comment">// éªŒè¯é€»è¾‘</span>
    <span class="hljs-keyword">public</span> OrderRecord {
        <span class="hljs-keyword">if</span> (totalAmount.compareTo(BigDecimal.ZERO) &lt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"è®¢å•é‡‘é¢å¿…é¡»å¤§äº0"</span>);
        }
        <span class="hljs-keyword">if</span> (orderDate.isAfter(Instant.now())) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"è®¢å•æ—¥æœŸä¸èƒ½åœ¨æœªæ¥"</span>);
        }
    }
}

<span class="hljs-comment">// Spring Data JDBCè®°å½•ç±»æ˜ å°„</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Customer</span><span class="hljs-params">(
    @Id Long id,
    String name,
    Email email,
    Address address,
    CustomerStatus status
)</span> {}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">CustomerStatus</span> { ACTIVE, INACTIVE, SUSPENDED }

<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Email</span><span class="hljs-params">(String value)</span> {
    <span class="hljs-keyword">public</span> Email {
        <span class="hljs-comment">// é‚®ç®±éªŒè¯é€»è¾‘</span>
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Address</span><span class="hljs-params">(
    String street,
    String city,
    String postalCode,
    String country
)</span> {}
</code></pre>
<h2 data-id="heading-15">å…­ã€è®°å½•ç±»çš„æ€§èƒ½ä¸å†…å­˜ç‰¹æ€§</h2>
<h3 data-id="heading-16">6.1 å†…å­˜å¸ƒå±€ä¼˜åŒ–</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®°å½•ç±»çš„å†…å­˜æ•ˆç‡</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MemoryEfficiencyDemo</span> {
    
    <span class="hljs-comment">// ä¼ ç»ŸPOJO - æ¯ä¸ªå®ä¾‹åŒ…å«å¯¹è±¡å¤´ã€å­—æ®µã€å¯¹é½å¡«å……</span>
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TraditionalPoint</span> {
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> x;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> y;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String label;
        
        <span class="hljs-keyword">public</span> <span class="hljs-title function_">TraditionalPoint</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, String label)</span> {
            <span class="hljs-built_in">this</span>.x = x;
            <span class="hljs-built_in">this</span>.y = y;
            <span class="hljs-built_in">this</span>.label = label;
        }
        
        <span class="hljs-comment">// çœç•¥getters, equals, hashCode, toString</span>
    }
    
    <span class="hljs-comment">// è®°å½•ç±» - æ›´ç´§å‡‘çš„å†…å­˜å¸ƒå±€</span>
    <span class="hljs-keyword">record</span> <span class="hljs-title class_">PointRecord</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, String label)</span> {}
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è®°å½•ç±»çš„ä¼˜åŠ¿ï¼š</span>
        <span class="hljs-comment">// 1. ä¸å¯å˜æ€§å…è®¸æ›´æ¿€è¿›çš„ä¼˜åŒ–</span>
        <span class="hljs-comment">// 2. æ›´å°‘çš„å¯¹è±¡å¤´å¼€é”€ï¼ˆåœ¨æŸäº›JVMå®ç°ä¸­ï¼‰</span>
        <span class="hljs-comment">// 3. å­—æ®µç›´æ¥å†…è”çš„å¯èƒ½æ€§</span>
        
        List&lt;TraditionalPoint&gt; traditionalPoints = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        List&lt;PointRecord&gt; recordPoints = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
        
        <span class="hljs-comment">// å†…å­˜ä½¿ç”¨å¯¹æ¯”</span>
        <span class="hljs-type">Runtime</span> <span class="hljs-variable">runtime</span> <span class="hljs-operator">=</span> Runtime.getRuntime();
        
        <span class="hljs-type">long</span> <span class="hljs-variable">memoryBefore</span> <span class="hljs-operator">=</span> runtime.totalMemory() - runtime.freeMemory();
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1_000_000</span>; i++) {
            recordPoints.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PointRecord</span>(i, i * <span class="hljs-number">2</span>, <span class="hljs-string">"point-"</span> + i));
        }
        <span class="hljs-type">long</span> <span class="hljs-variable">memoryAfter</span> <span class="hljs-operator">=</span> runtime.totalMemory() - runtime.freeMemory();
        
        System.out.printf(<span class="hljs-string">"è®°å½•ç±»å†…å­˜ä½¿ç”¨: %d MB%n"</span>, 
            (memoryAfter - memoryBefore) / (<span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>));
    }
}
</code></pre>
<h3 data-id="heading-17">6.2 æ€§èƒ½åŸºå‡†æµ‹è¯•</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// JMHåŸºå‡†æµ‹è¯•ï¼šè®°å½•ç±»vsä¼ ç»ŸPOJO</span>
<span class="hljs-meta">@State(Scope.Benchmark)</span>
<span class="hljs-meta">@BenchmarkMode(Mode.Throughput)</span>
<span class="hljs-meta">@OutputTimeUnit(TimeUnit.MILLISECONDS)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecordBenchmark</span> {
    
    <span class="hljs-meta">@Param({"1000", "10000", "100000"})</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;
    
    <span class="hljs-keyword">private</span> List&lt;TraditionalPerson&gt; traditionalList;
    <span class="hljs-keyword">private</span> List&lt;PersonRecord&gt; recordList;
    
    <span class="hljs-meta">@Setup</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setup</span><span class="hljs-params">()</span> {
        traditionalList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(size);
        recordList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(size);
        
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; size; i++) {
            <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">"Person"</span> + i;
            <span class="hljs-type">int</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span> + (i % <span class="hljs-number">50</span>);
            <span class="hljs-type">String</span> <span class="hljs-variable">email</span> <span class="hljs-operator">=</span> name.toLowerCase() + <span class="hljs-string">"@example.com"</span>;
            
            traditionalList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TraditionalPerson</span>(name, age, email));
            recordList.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PersonRecord</span>(name, age, email));
        }
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">traditionalPersonHashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (TraditionalPerson person : traditionalList) {
            sum += person.hashCode();
        }
        <span class="hljs-keyword">return</span> sum;
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">recordHashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-type">long</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
        <span class="hljs-keyword">for</span> (PersonRecord person : recordList) {
            sum += person.hashCode();
        }
        <span class="hljs-keyword">return</span> sum;
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">traditionalPersonNames</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> traditionalList.stream()
            .map(TraditionalPerson::getName)
            .collect(Collectors.toList());
    }
    
    <span class="hljs-meta">@Benchmark</span>
    <span class="hljs-keyword">public</span> List&lt;String&gt; <span class="hljs-title function_">recordNames</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> recordList.stream()
            .map(PersonRecord::name)
            .collect(Collectors.toList());
    }
}

<span class="hljs-comment">// è®°å½•ç±»å®šä¹‰</span>
<span class="hljs-keyword">record</span> <span class="hljs-title class_">PersonRecord</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age, String email)</span> {}

<span class="hljs-comment">// ä¼ ç»ŸPOJOå®šä¹‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">TraditionalPerson</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> age;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String email;
    
    <span class="hljs-keyword">public</span> <span class="hljs-title function_">TraditionalPerson</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age, String email)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
        <span class="hljs-built_in">this</span>.email = email;
    }
    
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> name; }
    <span class="hljs-comment">// ... å…¶ä»–getterså’Œæ ‡å‡†æ–¹æ³•</span>
}
</code></pre>
<h2 data-id="heading-18">ä¸ƒã€è®°å½•ç±»çš„æœ€ä½³å®è·µä¸é™åˆ¶</h2>
<h3 data-id="heading-19">7.1 é€‚ç”¨åœºæ™¯æŒ‡å—</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é€‚åˆä½¿ç”¨è®°å½•ç±»çš„åœºæ™¯</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RecordUseCases</span> {
    <span class="hljs-comment">// 1. æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆDTOï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">ApiRequest</span>&lt;T&gt;(
        String requestId,
        Instant timestamp,
        T payload,
        Map&lt;String, String&gt; headers
    ) {}
    
    <span class="hljs-comment">// 2. å€¼å¯¹è±¡ï¼ˆValue Objectsï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">Color</span><span class="hljs-params">(<span class="hljs-type">int</span> red, <span class="hljs-type">int</span> green, <span class="hljs-type">int</span> blue)</span> {
        <span class="hljs-keyword">public</span> Color {
            validateComponent(red);
            validateComponent(green);
            validateComponent(blue);
        }
        
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">validateComponent</span><span class="hljs-params">(<span class="hljs-type">int</span> value)</span> {
            <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span> || value &gt; <span class="hljs-number">255</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"é¢œè‰²åˆ†é‡å¿…é¡»åœ¨0-255ä¹‹é—´"</span>);
            }
        }
        
        <span class="hljs-keyword">public</span> Color <span class="hljs-title function_">blend</span><span class="hljs-params">(Color other, <span class="hljs-type">double</span> ratio)</span> {
            <span class="hljs-type">int</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>)(red * (<span class="hljs-number">1</span> - ratio) + other.red * ratio);
            <span class="hljs-type">int</span> <span class="hljs-variable">g</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>)(green * (<span class="hljs-number">1</span> - ratio) + other.green * ratio);
            <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>)(blue * (<span class="hljs-number">1</span> - ratio) + other.blue * ratio);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Color</span>(r, g, b);
        }
    }
    
    <span class="hljs-comment">// 3. å¤åˆé”®</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">CompositeKey</span><span class="hljs-params">(
        String partitionKey,
        String sortKey,
        Instant timestamp
    )</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Comparable</span>&lt;CompositeKey&gt; {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareTo</span><span class="hljs-params">(CompositeKey other)</span> {
            <span class="hljs-type">int</span> <span class="hljs-variable">cmp</span> <span class="hljs-operator">=</span> partitionKey.compareTo(other.partitionKey);
            <span class="hljs-keyword">if</span> (cmp != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> cmp;
            
            cmp = sortKey.compareTo(other.sortKey);
            <span class="hljs-keyword">if</span> (cmp != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> cmp;
            
            <span class="hljs-keyword">return</span> timestamp.compareTo(other.timestamp);
        }
    }
    
    <span class="hljs-comment">// 4. é…ç½®å¯¹è±¡</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">DatabaseConfig</span><span class="hljs-params">(
        String url,
        String username,
        String password,
        <span class="hljs-type">int</span> poolSize,
        Duration connectionTimeout
    )</span> {
        <span class="hljs-keyword">public</span> DatabaseConfig {
            Objects.requireNonNull(url, <span class="hljs-string">"æ•°æ®åº“URLä¸èƒ½ä¸ºç©º"</span>);
            Objects.requireNonNull(username, <span class="hljs-string">"ç”¨æˆ·åä¸èƒ½ä¸ºç©º"</span>);
            <span class="hljs-keyword">if</span> (poolSize &lt;= <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">"è¿æ¥æ± å¤§å°å¿…é¡»å¤§äº0"</span>);
            }
        }
    }
}

<span class="hljs-comment">// ä¸é€‚åˆä½¿ç”¨è®°å½•ç±»çš„åœºæ™¯</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">NotSuitableForRecords</span> {
    <span class="hljs-comment">// 1. éœ€è¦å¯å˜çŠ¶æ€çš„æƒ…å†µ</span>
    <span class="hljs-comment">// è®°å½•ç±»å¤©ç”Ÿä¸å¯å˜ï¼Œä¸é€‚åˆéœ€è¦ä¿®æ”¹å†…éƒ¨çŠ¶æ€çš„åœºæ™¯</span>
    
    <span class="hljs-comment">// 2. éœ€è¦ç»§æ‰¿å±‚æ¬¡ç»“æ„</span>
    <span class="hljs-comment">// è®°å½•ç±»æ˜¯finalçš„ï¼Œä¸èƒ½ç»§æ‰¿ä¹Ÿä¸èƒ½è¢«ç»§æ‰¿</span>
    
    <span class="hljs-comment">// 3. éœ€è¦éšè—å®ç°ç»†èŠ‚</span>
    <span class="hljs-comment">// è®°å½•ç±»çš„ç»„ä»¶æ˜¯å…¬å¼€çš„API</span>
    
    <span class="hljs-comment">// 4. éœ€è¦å¤æ‚çš„å¯¹è±¡æ„é€ </span>
    <span class="hljs-comment">// è®°å½•ç±»é€‚åˆç®€å•ã€é€æ˜çš„æ•°æ®è½½ä½“</span>
}
</code></pre>
<h3 data-id="heading-20">7.2 ä¸ç°æœ‰ä»£ç çš„é›†æˆç­–ç•¥</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ¸è¿›å¼è¿ç§»ç­–ç•¥</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MigrationStrategy</span> {
    
    <span class="hljs-comment">// ç¬¬1é˜¶æ®µï¼šå°†ç°æœ‰DTOè½¬æ¢ä¸ºè®°å½•ç±»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">CustomerDto</span><span class="hljs-params">(
        Long id,
        String name,
        String email,
        CustomerStatus status
    )</span> {
        <span class="hljs-comment">// æ·»åŠ fromEntity/toEntityè½¬æ¢æ–¹æ³•</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> CustomerDto <span class="hljs-title function_">fromEntity</span><span class="hljs-params">(CustomerEntity entity)</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomerDto</span>(
                entity.getId(),
                entity.getName(),
                entity.getEmail(),
                entity.getStatus()
            );
        }
        
        <span class="hljs-keyword">public</span> CustomerEntity <span class="hljs-title function_">toEntity</span><span class="hljs-params">()</span> {
            <span class="hljs-type">CustomerEntity</span> <span class="hljs-variable">entity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomerEntity</span>();
            entity.setId(id);
            entity.setName(name);
            entity.setEmail(email);
            entity.setStatus(status);
            <span class="hljs-keyword">return</span> entity;
        }
    }
    
    <span class="hljs-comment">// ç¬¬2é˜¶æ®µï¼šåœ¨å†…éƒ¨APIä¸­ä½¿ç”¨è®°å½•ç±»</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CustomerService</span> {
        CustomerDto <span class="hljs-title function_">getCustomer</span><span class="hljs-params">(Long id)</span>;
        CustomerDto <span class="hljs-title function_">createCustomer</span><span class="hljs-params">(CreateCustomerRequest request)</span>;
        List&lt;CustomerDto&gt; <span class="hljs-title function_">searchCustomers</span><span class="hljs-params">(CustomerSearchCriteria criteria)</span>;
    }
    
    <span class="hljs-comment">// ç¬¬3é˜¶æ®µï¼šåœ¨å¤–éƒ¨APIè¾¹ç•Œä½¿ç”¨è®°å½•ç±»</span>
    <span class="hljs-meta">@RestController</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomerController</span> {
        <span class="hljs-meta">@GetMapping("/customers/{id}")</span>
        <span class="hljs-keyword">public</span> CustomerDto <span class="hljs-title function_">getCustomer</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> Long id)</span> {
            <span class="hljs-keyword">return</span> customerService.getCustomer(id);
        }
    }
    
    <span class="hljs-comment">// ç¬¬4é˜¶æ®µï¼šå…¨é¢é‡‡ç”¨è®°å½•ç±»ä½œä¸ºä¸»è¦æ•°æ®è½½ä½“</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">CreateCustomerRequest</span><span class="hljs-params">(
        @NotBlank String name,
        @Email String email,
        CustomerStatus status
    )</span> {}
    
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">record</span> <span class="hljs-title class_">CustomerSearchCriteria</span><span class="hljs-params">(
        String nameFilter,
        CustomerStatus status,
        Instant createdAfter,
        Pageable pageable
    )</span> {}
}
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Androidæ’ä»¶åŒ–åŸç†ä¸æ–¹æ¡ˆè¯¦è§£]]></title>    <link>https://juejin.cn/post/7582958136258117668</link>    <guid>https://juejin.cn/post/7582958136258117668</guid>    <pubDate>2025-12-14T08:59:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582958136258117668" data-draft-id="7583215836690120745" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Androidæ’ä»¶åŒ–åŸç†ä¸æ–¹æ¡ˆè¯¦è§£"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2025-12-14T08:59:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™†ä¸šèª"/> <meta itemprop="url" content="https://juejin.cn/user/13629904404157"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Androidæ’ä»¶åŒ–åŸç†ä¸æ–¹æ¡ˆè¯¦è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/13629904404157/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™†ä¸šèª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T08:59:09.000Z" title="Sun Dec 14 2025 08:59:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Androidæ’ä»¶åŒ–æ˜¯ä¸€ç§å¼€å‘æ¨¡å¼ï¼Œå®ƒå…è®¸æˆ‘ä»¬åŠ¨æ€åœ°åŠ è½½å’Œå¸è½½APKï¼Œä»è€Œå®ç°æ¨¡å—åŒ–å¼€å‘ï¼Œçƒ­æ›´æ–°ç­‰åŠŸèƒ½ã€‚æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»Androidæ’ä»¶åŒ–çš„åŸç†ï¼Œä»¥åŠå‡ ç§ä¸»æµçš„Androidæ’ä»¶åŒ–æ–¹æ¡ˆã€‚</p>
<h2 data-id="heading-0">ä¸€ã€Androidæ’ä»¶åŒ–åŸç†</h2>
<h3 data-id="heading-1">1.1 ç±»åŠ è½½ä¸åŒäº²å§”æ‰˜æœºåˆ¶</h3>
<p>Androidæ’ä»¶åŒ–çš„æ ¸å¿ƒåŸç†æ˜¯åŸºäºJavaçš„ç±»åŠ è½½æœºåˆ¶ã€‚åœ¨Javaä¸­ï¼ŒClassLoaderè´Ÿè´£åŠ è½½ç±»ã€‚æ¯ä¸ªClassLoaderéƒ½æœ‰ä¸€ä¸ªçˆ¶ClassLoaderï¼Œå½“æˆ‘ä»¬å°è¯•åŠ è½½ä¸€ä¸ªç±»æ—¶ï¼ŒClassLoaderä¼šé¦–å…ˆå°è¯•è®©å®ƒçš„çˆ¶ClassLoaderåŠ è½½è¿™ä¸ªç±»ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„åŒäº²å§”æ‰˜æœºåˆ¶ã€‚è¿™ç§æœºåˆ¶å¯ä»¥ç¡®ä¿åŒä¸€ä¸ªç±»åªä¼šè¢«åŠ è½½ä¸€æ¬¡ã€‚</p>
<p>åœ¨Androidæ’ä»¶åŒ–ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ClassLoaderæ¥åŠ è½½æ’ä»¶ä¸­çš„ç±»ã€‚è¿™ä¸ªClassLoaderçš„çˆ¶ClassLoaderæ˜¯å®¿ä¸»åº”ç”¨çš„ClassLoaderï¼Œå› æ­¤ï¼Œæ’ä»¶ä¸­çš„ç±»å¯ä»¥è®¿é—®å®¿ä¸»åº”ç”¨ä¸­çš„ç±»ï¼Œä½†æ˜¯å®¿ä¸»åº”ç”¨ä¸­çš„ç±»ä¸èƒ½è®¿é—®æ’ä»¶ä¸­çš„ç±»ã€‚
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e64d0fc8afd942439fcc4b6f07f933f1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmG5Lia6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766307783&amp;x-signature=Dzm7XdbfBsPd%2BOXh7u49YJuja2U%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-2">1.2 èµ„æºåŠ è½½</h3>
<p>åœ¨Androidä¸­ï¼Œèµ„æºæ–‡ä»¶æ˜¯é€šè¿‡Resourceså¯¹è±¡æ¥åŠ è½½çš„ã€‚æ¯ä¸ªAPKéƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„Resourceså¯¹è±¡ï¼Œç”¨äºåŠ è½½å®ƒè‡ªå·±çš„èµ„æºæ–‡ä»¶ã€‚</p>
<p>åœ¨Androidæ’ä»¶åŒ–ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„Resourceså¯¹è±¡æ¥åŠ è½½æ’ä»¶ä¸­çš„èµ„æºæ–‡ä»¶ã€‚è¿™ä¸ªResourceså¯¹è±¡çš„AssetManageræ˜¯é€šè¿‡åå°„åˆ›å»ºçš„ï¼Œå¯ä»¥åŠ è½½ä»»æ„è·¯å¾„çš„APKæ–‡ä»¶ã€‚</p>
<h3 data-id="heading-3">1.3 å››å¤§ç»„ä»¶æ”¯æŒ</h3>
<p>åœ¨Androidæ’ä»¶åŒ–ä¸­ï¼Œå››å¤§ç»„ä»¶ï¼ˆActivityï¼ŒServiceï¼ŒBroadcastReceiverï¼ŒContentProviderï¼‰çš„æ”¯æŒæ˜¯ä¸€ä¸ªé‡è¦çš„é—®é¢˜ã€‚å› ä¸ºåœ¨Androidç³»ç»Ÿä¸­ï¼Œè¿™äº›ç»„ä»¶éƒ½éœ€è¦åœ¨AndroidManifest.xmlä¸­è¿›è¡Œå£°æ˜ï¼Œè€Œæ’ä»¶APKçš„AndroidManifest.xmlæ˜¯ä¸ä¼šè¢«è§£æçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡‡å–ä¸€äº›ç‰¹æ®Šçš„æ‰‹æ®µæ¥æ”¯æŒè¿™äº›ç»„ä»¶ã€‚</p>
<p>Activityï¼šActivityæ˜¯æœ€å¸¸ç”¨çš„ç»„ä»¶ï¼Œä¹Ÿæ˜¯æœ€éœ€è¦æ”¯æŒçš„ç»„ä»¶ã€‚åœ¨æ’ä»¶åŒ–ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Proxy Activityä»£ç†æˆ–è€…Hookæ–¹å¼æ¥æ”¯æŒActivityã€‚</p>
<p>Serviceï¼šServiceçš„æ”¯æŒä¹Ÿæ˜¯é€šè¿‡ä»£ç†æˆ–è€…Hookæ–¹å¼æ¥å®ç°çš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å®¿ä¸»ä¸­é¢„å…ˆå£°æ˜ä¸€äº›ä»£ç†Serviceï¼Œç„¶ååœ¨è¿è¡Œæ—¶å°†è¿™äº›ä»£ç†Serviceæ›¿æ¢ä¸ºæ’ä»¶ä¸­çš„Serviceã€‚</p>
<p>BroadcastReceiverï¼šBroadcastReceiverçš„æ”¯æŒç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€æ³¨å†ŒBroadcastReceiverï¼Œæˆ–è€…é€šè¿‡Hookæ–¹å¼æ¥æ”¯æŒé™æ€æ³¨å†Œçš„BroadcastReceiverã€‚</p>
<p>ContentProviderï¼šContentProviderçš„æ”¯æŒæ˜¯æœ€å¤æ‚çš„ï¼Œå› ä¸ºContentProvideråœ¨åº”ç”¨å¯åŠ¨æ—¶å°±ä¼šè¢«åˆ›å»ºï¼Œè€Œä¸”æ¯ä¸ªContentProvideréƒ½éœ€è¦ä¸€ä¸ªå”¯ä¸€çš„authorityã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡Hookæ–¹å¼æ¥æ”¯æŒContentProviderï¼Œæˆ–è€…ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„æŠ€å·§ï¼Œä¾‹å¦‚ä½¿ç”¨åŒä¸€ä¸ªauthorityæ¥æ”¯æŒå¤šä¸ªContentProviderã€‚</p>
<h3 data-id="heading-4">1.4 ä¸¤ç§æ”¯æŒActivityçš„æ–¹å¼</h3>
<p><strong>æ‰€æœ‰çš„æ’ä»¶æ¡†æ¶åœ¨è§£å†³çš„é—®é¢˜éƒ½ä¸æ˜¯å¦‚ä½•åŠ¨æ€åŠ è½½ç±»ï¼Œè€Œæ˜¯åŠ¨æ€åŠ è½½çš„Activityæ²¡æœ‰åœ¨AndroidManifestä¸­æ³¨å†Œï¼Œè¯¥å¦‚ä½•èƒ½æ­£å¸¸è¿è¡Œã€‚å¦‚æœAndroidç³»ç»Ÿæ²¡æœ‰AndroidManifestçš„é™åˆ¶ï¼Œé‚£ä¹ˆæ‰€æœ‰æ’ä»¶æ¡†æ¶éƒ½æ²¡æœ‰å­˜åœ¨çš„å¿…è¦äº†ã€‚å› ä¸ºJavaè¯­è¨€æœ¬èº«å°±æ”¯æŒåŠ¨æ€æ›´æ–°å®ç°çš„èƒ½åŠ›ã€‚</strong></p>
<ol>
<li>
<p>Proxy Activityä»£ç†ï¼šè¿™ç§æ–¹å¼æ˜¯é€šè¿‡åœ¨å®¿ä¸»åº”ç”¨ä¸­é¢„å…ˆå£°æ˜ä¸€äº›ä»£ç†Activityï¼Œç„¶ååœ¨è¿è¡Œæ—¶å°†è¿™äº›ä»£ç†Activityæ›¿æ¢ä¸ºæ’ä»¶ä¸­çš„Activityã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å®ç°ç®€å•ï¼Œä½†æ˜¯æœ‰ä¸€äº›é™åˆ¶ï¼Œä¾‹å¦‚æ— æ³•æ”¯æŒæ’ä»¶ä¸­çš„Activityåœ¨AndroidManifest.xmlä¸­å£°æ˜çš„ä¸€äº›å±æ€§ã€‚</p>
</li>
<li>
<p>Hookæ–¹å¼ï¼šè¿™ç§æ–¹å¼æ˜¯é€šè¿‡Hook AMSï¼ˆActivity Manager Serviceï¼‰ï¼Œæ›¿æ¢AMSä¸­çš„ä¸€äº›æ–¹æ³•ï¼Œä»è€Œç»•è¿‡AMSçš„æ£€æŸ¥ã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å¯ä»¥å®Œå…¨æ”¯æŒæ’ä»¶ä¸­çš„Activityï¼Œä½†æ˜¯å®ç°å¤æ‚ï¼Œéœ€è¦å¯¹Androidç³»ç»Ÿæœ‰æ·±å…¥çš„äº†è§£ã€‚</p>
</li>
</ol>
<h2 data-id="heading-5">äºŒã€Androidæ’ä»¶åŒ–æ–¹æ¡ˆ</h2>
<p>ç›®å‰ï¼Œå¸‚é¢ä¸Šæœ‰å‡ ç§ä¸»æµçš„Androidæ’ä»¶åŒ–æ–¹æ¡ˆï¼ŒåŒ…æ‹¬Shadowï¼ŒRePluginï¼ŒAABï¼ˆAndroid App Bundleï¼‰ï¼ŒQigsawï¼Œä»¥åŠAtlasã€‚</p>
<h3 data-id="heading-6">2.1 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FTencent%2FShadow" target="_blank" title="https://github.com/Tencent/Shadow" ref="nofollow noopener noreferrer">Shadow</a></h3>
<h4 data-id="heading-7">2.1.1 Shadowç®€ä»‹</h4>
<p>Shadowæ˜¯è…¾è®¯å¼€å‘çš„ä¸€æ¬¾æ’ä»¶åŒ–æ¡†æ¶ï¼Œå…¶è®¾è®¡ç›®æ ‡æ˜¯ä¸ä¿®æ”¹APKæ–‡ä»¶çš„æƒ…å†µä¸‹å®ç°æ’ä»¶åŒ–ã€‚Shadowé€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°çš„ClassLoaderæ¥åŠ è½½æ’ä»¶ï¼Œä»è€Œå®ç°æ’ä»¶çš„åŠ¨æ€åŠ è½½å’Œå¸è½½ã€‚</p>
<ul>
<li>Shadowæ‰€æŒ‡çš„æ’ä»¶æ˜¯æ’ä»¶çš„ä»£ç å®Œå…¨æ˜¯ä¸€ä¸ªæ­£å¸¸å¯å®‰è£…çš„Appä»£ç ï¼Œæ— éœ€å¼•ç”¨ä»»ä½•Shadowçš„åº“ã€‚è¿™æ ·çš„Appä»£ç åº”ç”¨äº†Shadowä¹‹åå¯ä»¥å…å®‰è£…è¿è¡Œåœ¨å¦ä¸€ä¸ªAppä¸­ã€‚</li>
<li>Shadowæ˜¯ä¸€ä¸ªå®Œå…¨æ— Hackï¼Œç”šè‡³é›¶åå°„å®ç°çš„Androidæ’ä»¶æ¡†æ¶ã€‚</li>
<li>Shadowæ˜¯ä¸€ä¸ªå…¨åŠ¨æ€å®ç°çš„æ’ä»¶æ¡†æ¶ï¼Œå°±æ˜¯è¯´æ’ä»¶æ¡†æ¶çš„ä»£ç è·Ÿæ’ä»¶çš„ä»£ç ä¸€æ ·éƒ½æ˜¯åŠ¨æ€å‘å¸ƒçš„ã€‚</li>
</ul>
<h4 data-id="heading-8">2.1.2 å…¨åŠ¨æ€æ’ä»¶æ¡†æ¶æ¶æ„å’ŒéåŠ¨æ€æ’ä»¶æ¡†æ¶æ¶æ„</h4>
<p>é‚£ä¹ˆä»€ä¹ˆæ˜¯å…¨åŠ¨æ€æ’ä»¶æ¡†æ¶æ¶æ„ï¼Ÿæˆ‘ä»¬å’ŒéåŠ¨æ€æ’ä»¶æ¡†æ¶æ¶æ„è¿›è¡Œå¯¹æ¯”çœ‹çœ‹ã€‚</p>
<ol>
<li>éåŠ¨æ€æ’ä»¶æ¡†æ¶æ¶æ„</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8caf7a1d888240768faf4ebdf72396ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmG5Lia6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766307783&amp;x-signature=iLBxzO5RnhwQ3HzAvGIRRM054Og%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<ol start="2">
<li>å…¨åŠ¨æ€æ’ä»¶æ¡†æ¶æ¶æ„å›¾</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/261fe4ff0e2046398ceb3464151fa565~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZmG5Lia6IGq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766307783&amp;x-signature=RcxVW6cfdIMjWi4YVz%2B92syGFb4%3D" alt="å…¨åŠ¨æ€æ’ä»¶æ¡†æ¶æ¶æ„å›¾" loading="lazy"/></p>
<h4 data-id="heading-9">2.1.3 Shadowä¸»è¦æ¨¡å—åˆ’åˆ†</h4>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[å®¿ä¸»åº”ç”¨] --&gt;|åŒ…å«| B[åŸºç¡€æ¥å£]
    A --&gt;|æ³¨å†Œ| C[å£³å­ä»£ç†ç»„ä»¶]
    A --&gt;|é›†æˆ| D[æ’ä»¶ç®¡ç†å™¨]
    D --&gt;|ç®¡ç†| E[æ’ä»¶åŒ…]
    E --&gt;|åŒ…å«| F[åŠ è½½å™¨]
    E --&gt;|åŒ…å«| G[è¿è¡Œæ—¶]
    E --&gt;|åŒ…å«| H[ä¸šåŠ¡App]
    D --&gt;|é€šè¿‡Binderæ§åˆ¶| F
    F --&gt;|åŠ è½½| H
    G --&gt;|æ”¯æŒ| H
</code></pre>
<p><strong>å®¿ä¸»åº”ç”¨</strong></p>
<p>å®¿ä¸»åº”ç”¨æ˜¯Shadowæ¡†æ¶çš„åŸºç¡€è½½ä½“ï¼Œä»…åŒ…å«æœ€å°åŒ–çš„æ ¸å¿ƒç»„ä»¶ï¼š</p>
<ul>
<li>åŸºç¡€æ¥å£å®šä¹‰</li>
<li>å£³å­ä»£ç†ç»„ä»¶ï¼ˆåœ¨Manifestä¸­æ³¨å†Œï¼‰</li>
<li>æ’ä»¶ç®¡ç†å™¨çš„åŠ¨æ€å‡çº§é€»è¾‘
ä»£ç é‡æ§åˆ¶åœ¨çº¦15KBï¼Œä¿æŒè½»é‡åŒ–è®¾è®¡ã€‚</li>
</ul>
<p><strong>æ’ä»¶ç®¡ç†å™¨ï¼ˆManagerï¼‰</strong></p>
<p>æ’ä»¶ç®¡ç†å™¨è´Ÿè´£æ’ä»¶çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š</p>
<ul>
<li>æ’ä»¶çš„ä¸‹è½½ä¸å®‰è£…</li>
<li>Loadingæ€çš„åŠ¨æ€è§†å›¾å±•ç¤º</li>
<li>é€šè¿‡Binderé€šä¿¡æœºåˆ¶æ§åˆ¶åŠ è½½å™¨</li>
<li>ç®¡ç†å¤šç‰ˆæœ¬loaderå®ä¾‹çš„è¿è¡Œ</li>
</ul>
<p><strong>æ ¸å¿ƒè¿è¡Œæ—¶æ¨¡å—</strong></p>
<p>æ ¸å¿ƒè¿è¡Œæ—¶æ¨¡å—ä½œä¸ºæ’ä»¶çš„ä¸€éƒ¨åˆ†å¯åŠ¨æ€å‡çº§ï¼ŒåŒ…å«ä¸¤ä¸ªå­æ¨¡å—ï¼š</p>
<p><strong>1. åŠ è½½å™¨ï¼ˆLoaderï¼‰</strong></p>
<ul>
<li>å®ç°ä¸šåŠ¡Appçš„åŠ¨æ€åŠ è½½</li>
<li>é€šè¿‡Binderæ¥å£æ¥æ”¶ç®¡ç†å™¨æŒ‡ä»¤</li>
<li>æ”¯æŒå¤šå®ä¾‹è¿è¡Œï¼Œé¿å…nativeåº“å†²çª</li>
<li>å¯åŒ…å«é’ˆå¯¹ä¸šåŠ¡çš„ç‰¹æ®Šå¤„ç†é€»è¾‘</li>
</ul>
<p><strong>2. è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰</strong></p>
<ul>
<li>æä¾›æ’ä»¶è¿è¡Œçš„åŸºç¡€ç¯å¢ƒ</li>
<li>ä¸ä¸šåŠ¡AppåŒç‰ˆæœ¬ç¼–è¯‘</li>
<li>ç¡®ä¿æ’ä»¶ä¸å®¿ä¸»çš„è§£è€¦è¿è¡Œ</li>
</ul>
<h4 data-id="heading-10">2.1.4 å°ç»“</h4>
<ul>
<li>ä¼˜ç‚¹ï¼šä¸ä¿®æ”¹APKï¼Œæ’ä»¶ä¹‹é—´å®Œå…¨éš”ç¦»ï¼ŒåŠ¨æ€åŠ è½½å’Œå¸è½½æ’ä»¶ï¼Œå¯¹Android APIçš„æ”¯æŒéå¸¸å…¨é¢ã€‚</li>
<li>ç¼ºç‚¹ï¼šå®ç°å¤æ‚ï¼Œæ–‡æ¡£ç›¸å¯¹è¾ƒå°‘ï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸€äº›ç‰¹æ®Šçš„é—®é¢˜ï¼Œéœ€è¦è¿›è¡Œæ›´å¤šçš„æµ‹è¯•æ¥ç¡®ä¿ç¨³å®šæ€§ã€‚</li>
<li>é€‰æ‹©å»ºè®®ï¼šå¦‚æœéœ€è¦ä¸€ä¸ªå¼ºå¤§ä¸”çµæ´»çš„æ’ä»¶åŒ–æ¡†æ¶ï¼Œå¹¶ä¸”ä¸ä»‹æ„è€—è´¹æ›´å¤šçš„æ—¶é—´æ¥ç†è§£å’Œä½¿ç”¨ï¼Œé‚£ä¹ˆShadowå¯èƒ½æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</li>
</ul>
<h3 data-id="heading-11">2.2 <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FQihoo360%2FRePlugin" target="_blank" title="https://github.com/Qihoo360/RePlugin" ref="nofollow noopener noreferrer">RePlugin</a></h3>
<p>RePluginæ˜¯360å…¬å¸å¼€å‘çš„ä¸€æ¬¾æ’ä»¶åŒ–æ¡†æ¶ï¼Œå®ƒé€šè¿‡ä¿®æ”¹ClassLoaderï¼Œå®ç°äº†æ’ä»¶çš„åŠ¨æ€åŠ è½½å’Œå¸è½½ã€‚</p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ’ä»¶åŒ–å’Œç»„ä»¶åŒ–å¹¶è¡Œï¼Œæ— éœ€ä¿®æ”¹å·²æœ‰ä»£ç ï¼Œæ’ä»¶é—´é€šä¿¡æœºåˆ¶å®Œå–„ã€‚</li>
<li>ç¼ºç‚¹ï¼šéœ€è¦å¯¹æ’ä»¶è¿›è¡Œç‰¹æ®Šçš„æ‰“åŒ…å¤„ç†ï¼Œå¯¹äºä¸€äº›å¤æ‚çš„åœºæ™¯ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œè¾ƒå¤§çš„æ”¹åŠ¨ï¼Œå¯¹æ–°çš„Androidç‰ˆæœ¬çš„æ”¯æŒå¯èƒ½ä¼šæœ‰å»¶è¿Ÿã€‚</li>
<li>é€‰æ‹©å»ºè®®ï¼šå¦‚æœéœ€è¦ä¸€ä¸ªç¨³å®šä¸”æˆç†Ÿçš„æ’ä»¶åŒ–æ¡†æ¶ï¼Œå¹¶ä¸”å¸Œæœ›èƒ½å¤Ÿå¿«é€Ÿåœ°è¿›è¡Œæ’ä»¶åŒ–å¼€å‘ï¼Œé‚£ä¹ˆå»ºè®®é€‰æ‹©RePluginã€‚</li>
</ul>
<h3 data-id="heading-12">2.3 AAB (Android App Bundle)</h3>
<p>AABæ˜¯Googleå®˜æ–¹æä¾›çš„ä¸€ç§æ–°çš„åº”ç”¨å‘å¸ƒæ ¼å¼ï¼Œå®ƒå…è®¸å°†åº”ç”¨çš„åŠŸèƒ½æ¨¡å—åŒ–ï¼Œå¹¶åœ¨éœ€è¦æ—¶åŠ¨æ€åœ°ä¸‹è½½å’Œå®‰è£…è¿™äº›æ¨¡å—ã€‚</p>
<ul>
<li>ä¼˜ç‚¹ï¼šGoogleå®˜æ–¹æ”¯æŒï¼Œä¸Androidç³»ç»Ÿå’ŒGoogle Playå•†åº—çš„é›†æˆåº¦é«˜ï¼Œå¯ä»¥å®ç°æŒ‰éœ€ä¸‹è½½å’Œå®‰è£…æ¨¡å—ã€‚</li>
<li>ç¼ºç‚¹ï¼šåªæ”¯æŒAndroid 5.0åŠä»¥ä¸Šç‰ˆæœ¬çš„è®¾å¤‡ï¼Œéœ€è¦é€šè¿‡Google Playå•†åº—è¿›è¡Œæ¨¡å—çš„ä¸‹è½½å’Œå®‰è£…ã€‚</li>
<li>é€‰æ‹©å»ºè®®ï¼šå¦‚æœåº”ç”¨ä¸»è¦é’ˆå¯¹çš„æ˜¯æœ‰Google PlayæœåŠ¡çš„è®¾å¤‡æˆ–åœ°åŒºï¼Œå¹¶ä¸”å¸Œæœ›èƒ½å¤Ÿå‡å°åº”ç”¨çš„åˆå§‹ä¸‹è½½å¤§å°ï¼Œé‚£ä¹ˆå»ºè®®é€‰æ‹©AABã€‚</li>
</ul>
<h3 data-id="heading-13">2.4 Qigsaw</h3>
<p>Qigsawæ˜¯çˆ±å¥‡è‰ºå¼€å‘çš„ä¸€æ¬¾æ’ä»¶åŒ–æ¡†æ¶ï¼Œå®ƒé€šè¿‡ä¿®æ”¹ClassLoaderï¼Œå®ç°äº†æ’ä»¶çš„åŠ¨æ€åŠ è½½å’Œå¸è½½ã€‚</p>
<ul>
<li>ä¼˜ç‚¹ï¼šæ”¯æŒåŠ¨æ€åŠ è½½å’Œå¸è½½æ’ä»¶ï¼Œæ”¯æŒçƒ­æ›´æ–°ï¼Œæ”¯æŒåˆ†åŒ…ã€‚</li>
<li>ç¼ºç‚¹ï¼šå®ç°ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦å¯¹æ’ä»¶è¿›è¡Œç‰¹æ®Šçš„æ‰“åŒ…å¤„ç†ï¼Œå¯¹æ–°çš„Androidç‰ˆæœ¬çš„æ”¯æŒå¯èƒ½ä¼šæœ‰å»¶è¿Ÿã€‚</li>
<li>é€‰æ‹©å»ºè®®ï¼šå¦‚æœéœ€è¦ä¸€ä¸ªæ”¯æŒçƒ­æ›´æ–°å’Œåˆ†åŒ…çš„æ’ä»¶åŒ–æ¡†æ¶ï¼Œå¹¶ä¸”æ„¿æ„è€—è´¹æ›´å¤šçš„æ—¶é—´æ¥ç†è§£å’Œä½¿ç”¨ï¼Œé‚£ä¹ˆå»ºè®®é€‰æ‹©Qigsawã€‚</li>
</ul>
<h3 data-id="heading-14">2.5 Atlas</h3>
<p>Atlasæ˜¯é˜¿é‡Œå·´å·´å¼€å‘çš„ä¸€æ¬¾æ’ä»¶åŒ–æ¡†æ¶ï¼Œå®ƒé€šè¿‡ä¿®æ”¹ClassLoaderï¼Œå®ç°äº†æ’ä»¶çš„åŠ¨æ€åŠ è½½å’Œå¸è½½ã€‚å®˜æ–¹çš„ä»‹ç»æ–‡ç« å¯ä»¥é˜…è¯»<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzAxNDEwNjk5OQ%3D%3D%26mid%3D2650400348%26idx%3D1%26sn%3D99bc1bce932c5b9000d5b54afa2de70e" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzAxNDEwNjk5OQ==&amp;mid=2650400348&amp;idx=1&amp;sn=99bc1bce932c5b9000d5b54afa2de70e" ref="nofollow noopener noreferrer">Atlas-æ‰‹æ·˜ç»„ä»¶åŒ–æ¡†æ¶çš„å‰ä¸–ä»Šç”Ÿå’Œæœªæ¥çš„è·¯</a>ã€‚</p>
<ul>
<li>ä¼˜ç‚¹ï¼šåŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒçƒ­æ›´æ–°ï¼Œå¯ä»¥åŠ¨æ€åŠ è½½å’Œå¸è½½æ’ä»¶ï¼Œæ”¯æŒæ’ä»¶ä¹‹é—´çš„ç›¸äº’è°ƒç”¨ï¼Œæœ‰ä¸°å¯Œçš„æ–‡æ¡£å’Œç¤¾åŒºæ”¯æŒã€‚</li>
<li>ç¼ºç‚¹ï¼šå®ç°å¤æ‚ï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹å¤§é‡çš„ä»£ç æ‰èƒ½å®ç°æ’ä»¶åŒ–ã€‚</li>
<li>é€‰æ‹©å»ºè®®ï¼šç›®å‰Atlaså¼€æºé¡¹ç›®å¤„äºæ²¡æœ‰ç»´æŠ¤çš„çŠ¶æ€ï¼Œåªèƒ½ä½œä¸ºæŠ€æœ¯æ–¹æ¡ˆå‚è€ƒã€‚</li>
</ul>
<h2 data-id="heading-15">ä¸‰ã€æ’ä»¶å¢é‡æ›´æ–°</h2>
<p>æ’ä»¶ç»´æŠ¤é˜¶æ®µï¼Œå¤§çš„éœ€æ±‚å˜æ›´è¾ƒå°‘ï¼Œå¾ˆå¤šæ—¶å€™æ›´æ–°æ’ä»¶ç‰ˆæœ¬åªæ˜¯ä¸ºäº†è§£å†³ä¸€äº›ç”¨æˆ·åé¦ˆçš„å°é—®é¢˜ã€‚ä½†å³ä½¿æ˜¯å¾ˆå°çš„æ›´æ–°ï¼Œéƒ½éœ€è¦æ’ä»¶å‘å¸ƒæ–°ç‰ˆæœ¬ï¼Œç”¨æˆ·æ›´æ–°-ä¸‹è½½-å®‰è£…è¿™äº›æ­¥éª¤ä¸­ï¼Œéƒ½ä¼šé€ æˆç”¨æˆ·çš„æµå¤±ã€‚é‚£æœ‰æ²¡æœ‰å¯èƒ½å¯¹æ’ä»¶è¿›è¡Œçƒ­æ›´æ–°å‘¢ï¼Ÿåªéœ€è¦ä¸‹å‘å°çš„è¡¥ä¸æ–‡ä»¶å³å¯ä»¥è¾¾åˆ°ä¿®å¤çš„èƒ½åŠ›ç¡®å®æ›´é€‚åˆæˆ‘ä»¬ä¸šåŠ¡åœºæ™¯ã€‚ç›®å‰æ¯”è¾ƒæµè¡Œçš„çƒ­æ›´æ–°æ–¹æ¡ˆæœ‰ä¸‹é¢è¿™äº›ã€‚</p>
<h3 data-id="heading-16">3.1 Sophix</h3>
<p>Sophixæ˜¯é˜¿é‡Œå·´å·´æ¨å‡ºçš„ä¸€æ¬¾çƒ­ä¿®å¤æ–¹æ¡ˆã€‚Sophixçš„åŸºæœ¬åŸç†æ˜¯é€šè¿‡AndFixå®ç°çš„ï¼ŒAndFixæ˜¯ä¸€ç§åœ¨Android Dalvik/ARTç¯å¢ƒä¸‹çš„çƒ­è¡¥ä¸æ¡†æ¶ï¼Œå®ƒå¯ä»¥åœ¨ä¸éœ€è¦é‡å¯APPçš„æƒ…å†µä¸‹åŠ¨æ€ä¿®å¤Classã€‚</p>
<ul>
<li>ä¼˜ç‚¹
<ul>
<li>æ”¯æŒå…¨é‡æ›´æ–°ï¼Œå¢é‡æ›´æ–°ï¼Œçƒ­æ›´æ–°ï¼Œæ”¯æŒSoåº“ä¿®å¤ã€‚</li>
<li>æä¾›äº†è¯¦ç»†çš„æ¥å…¥æ–‡æ¡£å’Œç¨³å®šçš„æœåŠ¡æ”¯æŒã€‚</li>
<li>æœ‰è¾ƒå¥½çš„å…¼å®¹æ€§å’Œç¨³å®šæ€§ã€‚</li>
</ul>
</li>
<li>ç¼ºç‚¹
<ul>
<li>åªæ”¯æŒé˜¿é‡Œç³»çš„åº”ç”¨ï¼Œå¯¹å¤–éƒ¨åº”ç”¨æ”¯æŒä¸è¶³ã€‚</li>
<li>éœ€è¦æ¥å…¥é˜¿é‡Œçš„mPaaSç§»åŠ¨å¼€å‘å¹³å°ï¼Œå¯¹äºä¸€äº›ä¸å¸Œæœ›æ¥å…¥é˜¿é‡Œäº‘çš„é¡¹ç›®å¯èƒ½ä¼šæœ‰å½±å“ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-17">3.2 Bugly hotfix</h3>
<p>Bugly hotfixæ˜¯è…¾è®¯æ¨å‡ºçš„ä¸€æ¬¾çƒ­ä¿®å¤æ–¹æ¡ˆã€‚Bugly hotfixçš„åŸºæœ¬åŸç†æ˜¯é€šè¿‡dexæ–‡ä»¶æ›¿æ¢å®ç°çš„ï¼Œå®ƒä¼šåœ¨è¿è¡Œæ—¶æ›¿æ¢æ‰æœ‰é—®é¢˜çš„dexæ–‡ä»¶ï¼Œä»è€Œå®ç°çƒ­ä¿®å¤ã€‚</p>
<ul>
<li>ä¼˜ç‚¹
<ul>
<li>æä¾›äº†å…¨é¢çš„çƒ­æ›´æ–°è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬çƒ­ä¿®å¤å’Œçƒ­æ›´æ–°ã€‚</li>
<li>æä¾›äº†è¯¦ç»†çš„æ¥å…¥æ–‡æ¡£å’Œç¨³å®šçš„æœåŠ¡æ”¯æŒã€‚</li>
<li>æœ‰è¾ƒå¥½çš„å…¼å®¹æ€§å’Œç¨³å®šæ€§ã€‚</li>
</ul>
</li>
<li>ç¼ºç‚¹
<ul>
<li>éœ€è¦æ¥å…¥è…¾è®¯çš„Buglyå¹³å°ï¼Œå¯¹äºä¸€äº›ä¸å¸Œæœ›æ¥å…¥è…¾è®¯äº‘çš„é¡¹ç›®å¯èƒ½ä¼šæœ‰å½±å“ã€‚</li>
<li>å¯¹äºä¸€äº›å¤æ‚çš„ä¿®å¤åœºæ™¯ï¼Œå¯èƒ½éœ€è¦æ›´æ·±å…¥çš„å®šåˆ¶ï¼Œè¿™å¯èƒ½ä¼šå¢åŠ æ¥å…¥çš„å¤æ‚æ€§ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-18">3.3 æ’æ¡©çƒ­æ›´æ–°</h3>
<p>æ’æ¡©çƒ­æ›´æ–°æ˜¯ä¸€ç§åŸºäºå­—èŠ‚ç æ’æ¡©æŠ€æœ¯çš„çƒ­æ›´æ–°æ–¹æ¡ˆã€‚æ’æ¡©çƒ­æ›´æ–°çš„åŸºæœ¬åŸç†æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µä¿®æ”¹å­—èŠ‚ç ï¼Œä¸ºæ–¹æ³•è°ƒç”¨æ’å…¥é¢å¤–çš„é€»è¾‘ï¼Œä»è€Œå®ç°åœ¨è¿è¡Œæ—¶æ›¿æ¢æ–¹æ³•çš„åŠŸèƒ½ã€‚</p>
<ul>
<li>ä¼˜ç‚¹
<ul>
<li>åŸç†ç®€å•ï¼Œå®ç°ç›¸å¯¹å®¹æ˜“ã€‚</li>
<li>ä¸ä¾èµ–äºä»»ä½•ç¬¬ä¸‰æ–¹å¹³å°ï¼Œå¯ä»¥è‡ªç”±å®šåˆ¶ã€‚</li>
</ul>
</li>
<li>ç¼ºç‚¹
<ul>
<li>éœ€è¦å¯¹å­—èŠ‚ç æ’æ¡©æŠ€æœ¯æœ‰ä¸€å®šçš„äº†è§£ï¼Œå¯¹äºä¸€äº›å¼€å‘è€…æ¥è¯´å¯èƒ½ä¼šæœ‰ä¸€å®šçš„å­¦ä¹ æˆæœ¬ã€‚</li>
<li>å¯¹äºä¸€äº›å¤æ‚çš„ä¿®å¤åœºæ™¯ï¼Œå¯èƒ½éœ€è¦æ›´æ·±å…¥çš„å®šåˆ¶ï¼Œè¿™å¯èƒ½ä¼šå¢åŠ æ¥å…¥çš„å¤æ‚æ€§ã€‚</li>
<li>å…¼å®¹æ€§å’Œç¨³å®šæ€§å¯èƒ½ä¸å¦‚Sophixå’ŒBugly hotfixã€‚</li>
</ul>
</li>
</ul>
<h2 data-id="heading-19">å››ã€æ€»ç»“</h2>
<p>åœ¨åŸç†éƒ¨åˆ†ï¼Œæœ¬æ–‡è§£é‡Šäº†ç±»åŠ è½½å™¨çš„ä½œç”¨å’Œæ’ä»¶åŒ–çš„åŸºæœ¬åŸç†ï¼Œè¿™ä¸ºç†è§£åç»­çš„æ’ä»¶åŒ–æ–¹æ¡ˆæ‰“ä¸‹äº†åŸºç¡€ã€‚</p>
<p>åœ¨æ’ä»¶åŒ–æ–¹æ¡ˆéƒ¨åˆ†ï¼Œæœ¬æ–‡ä»‹ç»äº†Shadowã€RePluginã€AABã€Qigsawå’ŒAtlasè¿™äº”ç§ä¸»æµçš„æ’ä»¶åŒ–æ–¹æ¡ˆã€‚æ¯ç§æ–¹æ¡ˆéƒ½æœ‰å…¶ç‹¬ç‰¹çš„ä¼˜ç‚¹å’Œé€‚ç”¨åœºæ™¯ï¼Œä¾‹å¦‚Shadowçš„å…¨åŠ¨æ€å®ç°ã€RePluginçš„ç¨³å®šæ€§å’Œæˆç†Ÿåº¦ã€AABçš„å®˜æ–¹æ”¯æŒå’Œä¸Google Playçš„é›†æˆåº¦ã€Qigsawçš„çƒ­æ›´æ–°å’Œåˆ†åŒ…æ”¯æŒï¼Œä»¥åŠAtlasçš„åŠŸèƒ½å¼ºå¤§å’Œä¸°å¯Œçš„æ–‡æ¡£æ”¯æŒã€‚</p>
<p>åœ¨æ’ä»¶å¢é‡æ›´æ–°éƒ¨åˆ†ï¼Œæœ¬æ–‡ä»‹ç»äº†Sophixã€Bugly hotfixå’Œæ’æ¡©çƒ­æ›´æ–°è¿™ä¸‰ç§çƒ­æ›´æ–°æ–¹æ¡ˆã€‚è¿™äº›æ–¹æ¡ˆå¯ä»¥åœ¨ä¸éœ€è¦ç”¨æˆ·é‡æ–°ä¸‹è½½å’Œå®‰è£…åº”ç”¨çš„æƒ…å†µä¸‹ä¿®å¤é—®é¢˜ï¼Œå¤§å¤§æé«˜äº†ç”¨æˆ·ä½“éªŒã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è‡ªå·±çš„å…·ä½“éœ€æ±‚å’Œé¡¹ç›®æƒ…å†µï¼Œç»¼åˆè€ƒè™‘å„ç§å› ç´ ï¼Œé€‰æ‹©æœ€é€‚åˆçš„æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»ä¸€ä¸ªâ€œä¸èƒ½è¾“è´Ÿå·â€çš„æ•°å­—è¾“å…¥æ¡†è¯´èµ·ï¼šWeb Component æ•°å­—è¾“å…¥ç»„ä»¶é‡æ„å®å½•]]></title>    <link>https://juejin.cn/post/7582861402278395938</link>    <guid>https://juejin.cn/post/7582861402278395938</guid>    <pubDate>2025-12-13T09:56:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582861402278395938" data-draft-id="7582533464246009890" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»ä¸€ä¸ªâ€œä¸èƒ½è¾“è´Ÿå·â€çš„æ•°å­—è¾“å…¥æ¡†è¯´èµ·ï¼šWeb Component æ•°å­—è¾“å…¥ç»„ä»¶é‡æ„å®å½•"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2025-12-13T09:56:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è«çŸ³"/> <meta itemprop="url" content="https://juejin.cn/user/281920608933006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»ä¸€ä¸ªâ€œä¸èƒ½è¾“è´Ÿå·â€çš„æ•°å­—è¾“å…¥æ¡†è¯´èµ·ï¼šWeb Component æ•°å­—è¾“å…¥ç»„ä»¶é‡æ„å®å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/281920608933006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è«çŸ³
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T09:56:13.000Z" title="Sat Dec 13 2025 09:56:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>æ‹¿åˆ°éœ€æ±‚æ—¶ï¼Œå› ä¸ºå·¥æœŸè¿˜æ¯”è¾ƒå®½æ¾ï¼Œå®˜ç½‘å¼€å‘ï¼Œæˆ‘åˆåªåšå…¶ä¸­ä¸€ä¸ªç»„ä»¶ï¼Œæ¡†æ¶åˆæ²¡æœ‰å®šã€‚</p>
<p>æˆ‘å†³å®šä½¿ç”¨åŸç”Ÿå¼€å‘ï¼Œå¹¶å°è£…ä¸ºWeb Componentä»¥é€‚é…ä»»ä½•æ¡†æ¶ï¼ˆå¦‚æœä¸èƒ½é€‚é…ï¼Œè¯´æ˜æ¡†æ¶æœ‰é—®é¢˜ï¼‰ã€‚å…¶ä¸­å°±æœ‰ä¸€ä¸ªæ•°å­—è¾“å…¥æ¡†å¸¦æ‹‰æ†çš„ï¼Œæ•°å­—è¾“å…¥æ¡†å’Œæ‹‰æ†è¿™ä¸¤ä¸ªä¸œè¥¿ï¼ŒåŸç”Ÿç»„ä»¶éƒ½æœ‰ã€‚</p>
<p>äºæ˜¯åœ¨æˆ‘çš„è¦æ±‚ä¸‹ï¼Œaiå¾ˆå¿«ç»™æˆ‘å°è£…äº†ä¸€ä¸ªè¿˜å¯ä»¥çš„ä¸œè¥¿ï¼Œä¸è¿‡åé¢uiåˆå»æ‰æ‹‰æ†äº†ã€‚</p>
<p>ä¸´è¿‘å‘å¸ƒï¼Œè¦åˆä»£ç äº†ï¼ŒåŒäº‹æ‰å‘ç°è¿™ä¸ªè¾“å…¥æ¡†æœ‰ç‚¹å„¿é—®é¢˜ï¼</p>
<hr/>
<p><span href="https://code.juejin.cn/pen/7582891968616169524" class="code-editor-container"><iframe class="code-editor-frame" data-code="code-editor-element" data-code-id="7582891968616169524" data-src="https://code.juejin.cn/pen/7582891968616169524" style="display:none;" loading="lazy"/><span class="loading-placeholder" style="display:none"><img class="placeholder-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAJElEQVRoge3BMQEAAADCoPVP7WkJoAAAAAAAAAAAAAAAAAAAbjh8AAFte11jAAAAAElFTkSuQmCC" loading="lazy"/><span class="loading-logo"/></span></span></p>
<h2 data-id="heading-1">èµ·ç‚¹ï¼šä¸€æ®µâ€œå·®ä¸å¤šèƒ½ç”¨â€çš„ä»£ç </h2>
<p>è¿™é‡Œå°±ä¸èµ˜è¿°Web Componentçš„å¼€å‘äº†ï¼Œå› ä¸ºç¡®å®å¾ˆç®€å•ï¼Œçœ‹ä»£ç å°±è¡Œäº†ã€‚</p>
<p>è¿™æ˜¯æˆ‘æœ€åˆå†™çš„ <code>NumInput</code> ç»„ä»¶ï¼ˆä¸ºç®€æ´çœç•¥éƒ¨åˆ† CSSï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NumInput</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">super</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachShadow</span>({ <span class="hljs-attr">mode</span>: <span class="hljs-string">'open'</span> });
    <span class="hljs-comment">// ... æ¨¡æ¿é‡Œç”¨äº† &lt;input type="number" steop="0.1"&gt;</span>
  }
  <span class="hljs-title function_">_onNumberInput</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-keyword">const</span> newValue = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clamp</span>(event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">min</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">max</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'value'</span>, newValue);
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_dispatchEvent</span>();
  }
}
</code></pre>
<p>åŠŸèƒ½ä¸Šï¼š</p>
<ul>
<li>æ”¯æŒ <code>label</code>ã€<code>unit</code>ã€<code>min</code>ã€<code>max</code>ã€<code>step</code></li>
<li>èšç„¦æœ‰é«˜äº®æ•ˆæœ</li>
<li>å€¼å˜åŒ–ä¼šæ´¾å‘ <code>value-changed</code> äº‹ä»¶</li>
<li>è¿˜æœ‰åç¼€å•ä½</li>
</ul>
<p>çœ‹èµ·æ¥æ²¡é—®é¢˜ï¼Ÿç›´åˆ°å¥³åŒäº‹é—®æˆ‘ï¼šâ€œ<strong>ä¸ºä»€ä¹ˆæˆ‘è¾“ <code>-</code> æ²¡ååº”ï¼Ÿ</strong>â€
æˆ‘å‹æ ¹å„¿æ²¡æƒ³è¿‡æ‰‹è¾“ï¼Œå› ä¸ºè¿™ä¸ªç»„ä»¶æœ€å¼€å§‹çš„æ—¶å€™ï¼Œè¿˜æ˜¯å¸¦æ‹‰æ†çš„ï¼Œçº¯é¼ æ ‡æ“ä½œä¸€ç‚¹å„¿é—®é¢˜æ²¡æœ‰ã€‚</p>
<p>å½“ç„¶ï¼Œç°åœ¨UIå˜äº†ã€‚</p>
<hr/>
<h2 data-id="heading-2">é—®é¢˜ä¸€ï¼š<code>type="number"</code> ä¸è®©ä½ è¾“ â€œ-â€ å’Œ â€œ.â€</h2>
<p>é¦–å…ˆï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªbug,å—¯ã€‚
æˆ‘ä»”ç»†ç ”ç©¶äº†ä¸€ä¸‹åŸç”Ÿçš„æ•°å­—æ¡†çš„æœºåˆ¶ã€‚</p>
<p>1 å®æ—¶æ ¡éªŒï¼Œä½ æ¯è¾“å…¥ä¸€ä¸ªå­—ç¬¦éƒ½ä¼šæ ¡éªŒã€‚
2 åªèƒ½è¾“å…¥æ•°å­—ç›¸å…³çš„,0-9 . -</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆå¥¹æ— æ³•è¾“å…¥â€œ-â€ å’Œ â€œ.â€å‘¢ï¼Ÿ</p>
<p>å®é™…ä¸Šï¼Œå¹¶ä¸æ˜¯æ— æ³•è¾“å…¥ï¼Œåªæ˜¯æ—¶æœºå’Œä½ç½®ä¸å¯¹ã€‚
å¦‚æœè¾“å…¥æ¡†ä¸­å·²ç»æœ‰ä¸€ä¸ªæ•°å­—1äº†ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½ å°±å¯ä»¥åœ¨è¿™ä¸ªæ•°å­—å‰é¢è¾“å…¥ä¸€ä¸ª â€œ-â€ï¼Œåœ¨å®ƒåé¢è¾“å…¥ä¸€ä¸ªâ€œ.â€ï¼Œè¿™ä¸¤ç§æƒ…å†µï¼ˆ-1å’Œ1.ï¼‰éƒ½æ˜¯åˆæ³•çš„ã€‚</p>
<p>å…¶ä½™æƒ…å†µéƒ½æ˜¯ä¸åˆæ³•çš„ï¼Œæ‰€ä»¥æ— æ³•è¾“å…¥ã€‚</p>
<p><strong>ç»“è®ºï¼š<code>type="number"</code>æ ¡éªŒè¿‡äºä¸¥è‹›ï¼Œé¼ æ ‡æ“ä½œè¶³çŸ£ï¼Œä¸é€‚åˆæ‰‹åŠ¨è¾“å…¥ã€‚</strong></p>
<hr/>
<h2 data-id="heading-3">é‡æ„ç¬¬ä¸€æ­¥ï¼šæ”¾å¼ƒ <code>type="number"</code>ï¼Œæ‹¥æŠ± <code>type="text"</code></h2>
<p>ä½¿ç”¨textè¾“å…¥æ¡†ï¼Œæ„å‘³ç€ä¹‹å‰æ•°å­—æ¡†æœ‰çš„åŠŸèƒ½ï¼Œæˆ‘ç°åœ¨ä¹Ÿéƒ½è¦ä¹Ÿæœ‰ï¼Œè¿™æ˜¯è¿™ä¸ªæ‰‹åŠ¨è¾“å…¥çš„æ ¡éªŒè§„åˆ™è¦è‡ªå®šä¹‰ã€‚</p>
<p>æˆ‘æ”¹æˆäº†ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">inputmode</span>=<span class="hljs-string">"decimal"</span> /&gt;</span>
</code></pre>
<blockquote>
<p><code>inputmode="decimal"</code> èƒ½è®©ç§»åŠ¨ç«¯å¼¹å‡ºå¸¦å°æ•°ç‚¹çš„æ•°å­—é”®ç›˜ï¼Œä½“éªŒä¸é™åå‡ã€‚</p>
</blockquote>
<p>ä½†å…‰æ”¹ç±»å‹ä¸å¤Ÿï¼Œå¾—è‡ªå·±æ§åˆ¶è¾“å…¥å†…å®¹ã€‚</p>
<h3 data-id="heading-4">å®½æ¾è¿‡æ»¤ï¼Œåªæ‹¦éæ³•å­—ç¬¦</h3>
<p>åœ¨ <code>input</code> äº‹ä»¶ä¸­ï¼Œæˆ‘åªåšä¸€ä»¶äº‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">_onTextInput</span>(<span class="hljs-params">e</span>) {
  <span class="hljs-keyword">let</span> val = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>;
  val = val.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[^0-9.\-+]/g</span>, <span class="hljs-string">''</span>); <span class="hljs-comment">// åªç•™æ•°å­—ã€ç‚¹ã€æ­£è´Ÿå·</span>
  <span class="hljs-comment">// å†å¤„ç†ç¬¦å·ä½ç½®ã€å°æ•°ç‚¹æ•°é‡...</span>
  e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span> = val;
}
</code></pre>
<p><strong>å…³é”®åŸåˆ™</strong>ï¼š</p>
<blockquote>
<p>è¾“å…¥è¿‡ç¨‹ä¸­ï¼Œ<strong>åªè¿‡æ»¤ï¼Œä¸æ ¡éªŒ</strong>ã€‚<br/>
å…è®¸ç”¨æˆ·è¾“ <code>-</code>ã€<code>.5</code>ã€<code>-12.</code>ï¼Œè¿™äº›â€œä¸­é—´çŠ¶æ€â€å¿…é¡»ä¿ç•™ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">é‡æ„ç¬¬äºŒæ­¥ï¼šä»€ä¹ˆæ—¶å€™æ‰è¯¥â€œè®¤çœŸâ€æ ¡éªŒï¼Ÿ</h2>
<p>è¦ä¿ç•™ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ï¼Œåˆè¦åœ¨ç»“æŸåæ ¡éªŒï¼Œä¸€èˆ¬å¯èƒ½ä¼šæƒ³åˆ°èŠ‚æµï¼Œæˆ‘è§‰å¾—å¤ªéº»çƒ¦äº†ï¼Œä¸æ˜¯æŒ‡å®ç°èŠ‚æµéº»çƒ¦ï¼Œè€Œæ˜¯èŠ‚æµè¿™ä¸ªé€»è¾‘æœ¬èº«ï¼Œä¼šä¸€ç›´åå»¶ï¼Œè®©jså¾ˆéº»çƒ¦ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ€ä¹ˆåˆ¤æ–­ï¼š<strong>è¾“å…¥ç»“æŸäº†</strong>ï¼Ÿ</p>
<p>æˆ‘å®šä¹‰äº†ä¸¤ä¸ªâ€œç»“æŸä¿¡å·â€ï¼š</p>
<ol>
<li>å¤±ç„¦ï¼ˆ<code>blur</code>ï¼‰</li>
<li>æŒ‰ä¸‹å›è½¦ï¼ˆ<code>Enter</code>ï¼‰ åˆšå¼€å§‹æ²¡æƒ³åˆ°è¿™ä¸ªï¼Œç›´åˆ°æˆ‘è¾“äº†æ•°å­—æ²¡æœ‰ååº”ï¼Œä¹ æƒ¯æ€§åœ°å›è½¦äº†ä¸€ä¸‹ã€‚</li>
</ol>
<p>åœ¨è¿™ä¸¤ä¸ªæ—¶æœºï¼Œè°ƒç”¨åŒä¸€ä¸ªå‡½æ•° <code>_finalizeInput()</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">_finalizeInput</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> raw = <span class="hljs-variable language_">this</span>.<span class="hljs-property">numberEl</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">trim</span>();
  <span class="hljs-comment">// å¦‚æœæ˜¯ä¸­é—´çŠ¶æ€ï¼ˆå¦‚ '-'ï¼‰ï¼Œä¸å¤„ç†</span>
  <span class="hljs-keyword">if</span> (raw === <span class="hljs-string">''</span> || raw === <span class="hljs-string">'-'</span> || raw === <span class="hljs-string">'.'</span>) <span class="hljs-keyword">return</span>;

  <span class="hljs-keyword">let</span> num = <span class="hljs-built_in">parseFloat</span>(raw);
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(num)) {
    <span class="hljs-comment">// æ— æ•ˆï¼Ÿå›é€€åˆ°ä¸Šæ¬¡åˆæ³•å€¼</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">numberEl</span>.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'value'</span>) || <span class="hljs-string">''</span>;
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// clamp åˆ° [min, max]</span>
  num = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(num, <span class="hljs-variable language_">this</span>.<span class="hljs-property">min</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-property">max</span>);

  <span class="hljs-comment">// ä¿®æ­£æµ®ç‚¹ç²¾åº¦ï¼ˆå…³é”®ï¼ï¼‰</span>
  num = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_roundToStepPrecision</span>(num, <span class="hljs-variable language_">this</span>.<span class="hljs-property">step</span>);

  <span class="hljs-variable language_">this</span>.<span class="hljs-property">numberEl</span>.<span class="hljs-property">value</span> = <span class="hljs-title class_">String</span>(num);
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'value'</span>, num);
  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_dispatchEvent</span>(); <span class="hljs-comment">// æ´¾å‘çš„æ˜¯æ•°å­—ï¼Œä¸æ˜¯å­—ç¬¦ä¸²ï¼</span>
}
</code></pre>
<hr/>
<h2 data-id="heading-6">é—®é¢˜äºŒï¼š0.1 + 0.2 â‰  0.3ï¼Ÿ</h2>
<ul>
<li><code>0.1 + 0.2</code> â†’ æ˜¾ç¤º <code>0.30000000000000004</code>
JavaScript çš„æµ®ç‚¹ç²¾åº¦é—®é¢˜æ˜¯è€æœ‹å‹äº†ã€‚<br/>
ä½†ç”¨æˆ·ä¸å…³å¿ƒè¿™äº›ï¼Œä»–ä»¬åªçœ‹åˆ°â€œ<strong>æˆ‘ step=0.1ï¼Œæ€ä¹ˆå˜å‡ºä¸€ä¸²å°æ•°ï¼Ÿ</strong>â€</li>
</ul>
<h3 data-id="heading-7">è§£æ³•ï¼šæŒ‰ <code>step</code> çš„å°æ•°ä½æ•°å››èˆäº”å…¥</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-title function_">_roundToStepPrecision</span>(<span class="hljs-params">value, step</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Number</span>.<span class="hljs-title function_">isInteger</span>(step)) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(value);
  <span class="hljs-keyword">const</span> decimalPlaces = step.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">split</span>(<span class="hljs-string">'.'</span>)[<span class="hljs-number">1</span>]?.<span class="hljs-property">length</span> || <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> factor = <span class="hljs-number">10</span> ** decimalPlaces;
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">round</span>(value * factor) / factor;
}
</code></pre>
<ul>
<li><code>step=0.1</code> â†’ ä¿ç•™ 1 ä½ â†’ <code>0.30000000000000004</code> â†’ <code>0.3</code></li>
<li><code>step=0.01</code> â†’ ä¿ç•™ 2 ä½ â†’ <code>0.13</code></li>
<li><code>step=1</code> â†’ æ•´æ•° â†’ <code>4</code></li>
</ul>
<p><strong>æ‰€æœ‰èµ‹å€¼è·¯å¾„</strong>ï¼ˆæ‰‹åŠ¨è¾“å…¥ã€ä¸Šä¸‹é”®ã€å¤–éƒ¨è®¾ç½®ï¼‰éƒ½èµ°è¿™ä¸ªä¿®æ­£ï¼Œå½»åº•å‘Šåˆ«è„æ•°å­—ã€‚</p>
<hr/>
<p>ç›‘å¬ä¸€ä¸‹å›è½¦ä½œä¸ºâ€œç¡®è®¤â€ã€‚</p>
<p>è¿™é‡Œç›´æ¥ä¸ä»…èµ°äº†å¤±ç„¦çš„é€»è¾‘ï¼Œè¿˜ä¸»åŠ¨å¤±ç„¦ï¼Œé¿å…äºŒæ¬¡â€œå¤±ç„¦â€ã€‚</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">this</span>.<span class="hljs-property">numberEl</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keydown'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">'Enter'</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">_finalizeInput</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">numberEl</span>.<span class="hljs-title function_">blur</span>(); <span class="hljs-comment">// è‡ªåŠ¨å¤±ç„¦ï¼Œç»Ÿä¸€äº¤äº’</span>
  }
});
</code></pre>
<hr/>
<h2 data-id="heading-8">å…¶ä»–ç»†èŠ‚æ‰“ç£¨</h2>
<ul>
<li><strong>ä¿®å¤ typo</strong>ï¼š<code>steop="0.1"</code> â†’ <code>step="0.1"</code>ï¼ˆåˆ«ç¬‘ï¼ŒçœŸæœ‰äººå†™é”™ï¼‰</li>
<li><strong>ç§»é™¤æ— ç”¨ä»£ç </strong>ï¼šåŸå§‹ä»£ç é‡Œå£°æ˜äº† <code>rangeEl</code> ä½†æ²¡ç”¨ï¼Œåˆ æ‰</li>
<li><strong>äº‹ä»¶ä¼ æ•°å­—</strong>ï¼š<code>value-changed</code> çš„ <code>detail.value</code> æ˜¯ <code>number</code> ç±»å‹ï¼Œä¸æ˜¯å­—ç¬¦ä¸²</li>
<li><strong>å¤–éƒ¨è®¾ç½®å€¼ä¹Ÿä¿®æ­£</strong>ï¼š<code>setAttribute('value', '0.30000000000000004')</code> ä¼šè‡ªåŠ¨è½¬æˆ <code>0.3</code></li>
</ul>
<hr/>
<h2 data-id="heading-9">æœ€ç»ˆæ•ˆæœ</h2>
<p>âœ… è‡ªç”±è¾“å…¥ <code>-</code>ã€<code>.</code>ã€<code>-12.</code><br/>
âœ… æŒ‰ â†‘/â†“ æŒ‰ <code>step</code> ç²¾ç¡®å¢å‡<br/>
âœ… æŒ‰ Enter æˆ–å¤±ç„¦è‡ªåŠ¨æ ¡éªŒ+ä¿®æ­£<br/>
âœ… æ”¯æŒ <code>min</code>/<code>max</code> é™åˆ¶<br/>
âœ… ç§»åŠ¨ç«¯å¼¹å‡ºæ•°å­—é”®ç›˜<br/>
âœ… äº‹ä»¶ä¼ å‡ºå¹²å‡€çš„æ•°å­—<br/>
âœ… å®Œå…¨ Web Componentï¼Œé›¶ä¾èµ–</p>
<hr/>
<h2 data-id="heading-10">ç»“è¯­</h2>
<p>è¿™ä¸ªç»„ä»¶æœ€ç»ˆä»£ç æ¯”æœ€åˆé•¿äº†è¿‘ä¸€å€ï¼Œä½†<strong>ç”¨æˆ·ä½“éªŒæå‡æ˜¯è´¨çš„é£è·ƒ</strong>ã€‚</p>
<p>æœ‰æ—¶å€™ï¼Œçœ‹ä¼¼ç®€å•çš„åŠŸèƒ½ï¼Œæ·±æŒ–ä¸‹å»å…¨æ˜¯å‘ã€‚<br/>
ä½†æ­£æ˜¯è¿™äº›â€œå°ç»†èŠ‚â€ï¼Œå†³å®šäº†äº§å“æ˜¯â€œèƒ½ç”¨â€è¿˜æ˜¯â€œå¥½ç”¨â€ã€‚</p>
<blockquote>
<p>æœ€å,å¥³åŒäº‹çœ‹äº†ä¸€çœ¼è¯´ï¼šâ€œè¿™ä¸ªè¾“å…¥æ¡†ç»ˆäºä¸æŠ½é£äº†ã€‚â€<br/>
æˆ‘ç¬‘äº†ç¬‘ï¼Œæ²¡å‘Šè¯‰å¥¹ï¼Œæˆ‘è®©AIæ”¹äº†å››ç‰ˆã€‚</p>
</blockquote>
<p>ï¼ˆå®Œï¼‰</p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç»ˆäºæœ‰äººæŠŠå¤§æ¨¡å‹è®²æ˜ç™½äº†ï¼šLLM ä»å…¥é—¨åˆ°ç²¾é€šå…¨è§£æ]]></title>    <link>https://juejin.cn/post/7583244688121348105</link>    <guid>https://juejin.cn/post/7583244688121348105</guid>    <pubDate>2025-12-14T07:27:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583244688121348105" data-draft-id="7583324039302316083" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç»ˆäºæœ‰äººæŠŠå¤§æ¨¡å‹è®²æ˜ç™½äº†ï¼šLLM ä»å…¥é—¨åˆ°ç²¾é€šå…¨è§£æ"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-14T07:27:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å±…ç„¶JuRan"/> <meta itemprop="url" content="https://juejin.cn/user/2524134427858205"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç»ˆäºæœ‰äººæŠŠå¤§æ¨¡å‹è®²æ˜ç™½äº†ï¼šLLM ä»å…¥é—¨åˆ°ç²¾é€šå…¨è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2524134427858205/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å±…ç„¶JuRan
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T07:27:39.000Z" title="Sun Dec 14 2025 07:27:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»16åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å½“è®¡ç®—æœºå¼€å§‹"å­¦ä¹ ":ä¸€åœºä»æŒ‡ä»¤åˆ°æ™ºèƒ½çš„èŒƒå¼é©å‘½</h2>
<p>è¿‡å»ä¸€å¹´,äººå·¥æ™ºèƒ½å½»åº•æ”¹å˜äº†ä¸–ç•Œçš„è¿è¡Œæ–¹å¼ã€‚ChatGPTçš„å‡ºç°è®©å‡ ä¹æ¯ä¸ªè¡Œä¸šéƒ½æ„Ÿå—åˆ°äº†éœ‡åŠ¨,ä»å†™ä½œåˆ°ç¼–ç¨‹,ä»å®¢æœåˆ°æ³•å¾‹å’¨è¯¢,æˆ‘ä»¬ä¸æŠ€æœ¯äº’åŠ¨çš„æ–¹å¼æ­£åœ¨ç»å†å‰æ‰€æœªæœ‰çš„è½¬å˜ã€‚è€Œè¿™ä¸€åˆ‡çš„æ ¸å¿ƒå¼•æ“,å°±æ˜¯å¤§å‹è¯­è¨€æ¨¡å‹(Large Language Models, LLMs)ã€‚</p>
<p>å¦‚æœä½ å¯¹AIä¸€æ— æ‰€çŸ¥,æˆ–è€…åªæ˜¯å¬è¯´è¿‡ChatGPTå´ä¸æ˜ç™½å®ƒèƒŒåçš„åŸç†,è¿™ç¯‡æ–‡ç« å°†å¸¦ä½ ä»é›¶å¼€å§‹,å»ºç«‹å¯¹LLMçš„å®Œæ•´è®¤çŸ¥ã€‚ä»æœ€åŸºç¡€çš„æ¦‚å¿µåˆ°å¤æ‚çš„æŠ€æœ¯åŸç†,ä»è¾‰ç…Œçš„å‘å±•å†ç¨‹åˆ°ä»¤äººæ·±æ€çš„ä¼¦ç†æŒ‘æˆ˜,æˆ‘ä»¬å°†ä¸€ä¸€æ­å¼€è¿™é¡¹é©å‘½æ€§æŠ€æœ¯çš„ç¥ç§˜é¢çº±ã€‚</p>
<h2 data-id="heading-1">LLMæ˜¯ä»€ä¹ˆ?ä¸€æ¬¡ç¼–ç¨‹èŒƒå¼çš„æ ¹æœ¬æ€§è½¬å˜</h2>
<p>è¦ç†è§£LLM,æˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½å®ƒä¸ä¼ ç»Ÿç¼–ç¨‹çš„æœ¬è´¨åŒºåˆ«ã€‚</p>
<p>ä¼ ç»Ÿç¼–ç¨‹æ˜¯<strong>åŸºäºæŒ‡ä»¤</strong>çš„â€”â€”ç¨‹åºå‘˜æ˜ç¡®å‘Šè¯‰è®¡ç®—æœº"å¦‚æœX,é‚£ä¹ˆY"ã€‚ä½ éœ€è¦ä¸ºæ¯ä¸€ç§å¯èƒ½çš„æƒ…å†µç¼–å†™è§„åˆ™,å°±åƒç»™ä¸€ä¸ªä¸¥æ ¼éµå®ˆå‘½ä»¤çš„æœºå™¨äººä¸‹è¾¾ç²¾ç¡®çš„æ“ä½œæ‰‹å†Œã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹æ‰‹å†™å­—æ¯è¯†åˆ«:ä¼ ç»Ÿæ–¹æ³•éœ€è¦ä½ ä¸ºå­—æ¯Aã€Bã€Cã€Dçš„æ¯ä¸€ç§å¯èƒ½å†™æ³•éƒ½ç¼–å†™è¯†åˆ«è§„åˆ™ã€‚ä½†æ¯ä¸ªäººçš„æ‰‹å†™é£æ ¼éƒ½ä¸åŒ,åœ†æ¶¦çš„ã€å°–é”çš„ã€æ½¦è‰çš„ã€å·¥æ•´çš„â€”â€”å¦‚ä½•ç”¨æœ‰é™çš„è§„åˆ™è¦†ç›–æ— é™çš„å¯èƒ½?</p>
<p>è¿™å°±æ˜¯LLMå¸¦æ¥çš„é©å‘½æ€§è½¬å˜:<strong>æˆ‘ä»¬ä¸å†å‘Šè¯‰è®¡ç®—æœºå¦‚ä½•åšäº‹æƒ…,è€Œæ˜¯æ•™å®ƒå¦‚ä½•å­¦ä¹ åšäº‹æƒ…</strong>ã€‚</p>
<p>LLMæ˜¯ä¸€ç§ç‰¹æ®Šçš„ç¥ç»ç½‘ç»œ,é€šè¿‡é˜…è¯»æµ·é‡çš„æ–‡æœ¬æ•°æ®â€”â€”ç½‘é¡µã€ä¹¦ç±ã€æ–‡ç« ã€å¯¹è¯è®°å½•â€”â€”æ¥å­¦ä¹ è¯­è¨€çš„æ¨¡å¼å’Œè§„å¾‹ã€‚å®ƒæ¨¡æ‹Ÿäººç±»å¤§è„‘çš„å·¥ä½œæ–¹å¼,ä¸æ˜¯é€šè¿‡æ­»è®°ç¡¬èƒŒè§„åˆ™,è€Œæ˜¯é€šè¿‡è¯†åˆ«æ•°æ®ä¸­çš„æ¨¡å¼æ¥ç†è§£å’Œç”Ÿæˆè‡ªç„¶è¯­è¨€ã€‚</p>
<p>è¿™ç§æ–¹æ³•æœ‰ä¸‰ä¸ªé©å‘½æ€§ä¼˜åŠ¿:</p>
<ol>
<li>
<p><strong>æè‡´çš„çµæ´»æ€§</strong>:åŒä¸€ä¸ªæ¨¡å‹å¯ä»¥å®Œæˆæ€»ç»“ã€ç¿»è¯‘ã€é—®ç­”ã€åˆ›æ„å†™ä½œç­‰å¤šç§ä»»åŠ¡</p>
</li>
<li>
<p><strong>æŒç»­çš„é€‚åº”æ€§</strong>:èƒ½ä»é”™è¯¯ä¸­å­¦ä¹ å¹¶è‡ªæˆ‘è°ƒæ•´,ä¸éœ€è¦é‡æ–°ç¼–ç¨‹</p>
</li>
<li>
<p><strong>æ— é™çš„æ‰©å±•æ€§</strong>:éšç€æ•°æ®å¢åŠ å’ŒæŠ€æœ¯è¿›æ­¥,èƒ½åŠ›ä¼šè‡ªç„¶æå‡</p>
</li>
</ol>
<p>è€Œä¸”è¦è®°ä½ä¸€ä¸ªä»¤äººæŒ¯å¥‹çš„äº‹å®:<strong>ä»Šå¤©çš„LLMæ˜¯å²ä¸Šæœ€å¼±çš„LLM</strong>ã€‚éšç€æ›´å¤šæ•°æ®çš„äº§ç”Ÿ(åŒ…æ‹¬å…¶ä»–AIç”Ÿæˆçš„åˆæˆæ•°æ®),è¿™äº›æ¨¡å‹åªä¼šè¶Šæ¥è¶Šå¼ºå¤§ã€‚</p>
<h2 data-id="heading-2">ä»ELIZAåˆ°GPT-4:ä¸€æ®µè·¨è¶ŠåŠä¸ªå¤šä¸–çºªçš„è¿›åŒ–å²</h2>
<p>LLMçš„æ•…äº‹è¦ä»1966å¹´è¯´èµ·ã€‚</p>
<h3 data-id="heading-3">å²å‰æ—¶ä»£:ELIZAä¸å¾ªç¯ç¥ç»ç½‘ç»œ(1966-2017)</h3>
<p>ç¬¬ä¸€ä¸ªè¯­è¨€æ¨¡å‹ELIZAè¯ç”Ÿäº1966å¹´,å®ƒé€šè¿‡é¢„è®¾å…³é”®è¯æ¥æä¾›å›ç­”,å°±åƒä¸€ä¸ªåªä¼šæŒ‰å‰§æœ¬æ¼”æˆçš„æ¼”å‘˜ã€‚å¯¹è¯å‡ ä¸ªå›åˆå,å®ƒçš„å±€é™æ€§å°±ä¼šæš´éœ²æ— é—â€”â€”æ¯•ç«Ÿ,å®ƒåªæ˜¯åœ¨æ‰§è¡Œç®€å•çš„æ¨¡å¼åŒ¹é…ã€‚</p>
<p>å°½ç®¡1972å¹´å¾ªç¯ç¥ç»ç½‘ç»œ(RNN)è·å¾—äº†"å­¦ä¹ èƒ½åŠ›",èƒ½å¤Ÿæ ¹æ®ä¸Šä¸‹æ–‡é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯,ä½†åœ¨æ¥ä¸‹æ¥çš„å‡ åå¹´é‡Œ,è¯­è¨€æ¨¡å‹çš„è¿›å±•å¼‚å¸¸ç¼“æ…¢ã€‚å³ä¾¿æ·±åº¦å­¦ä¹ åœ¨2000å¹´ä»£åˆå´­éœ²å¤´è§’,è¯­è¨€æ¨¡å‹ä»ç„¶è¿œè¿œè½åäºä»Šå¤©çš„æ°´å¹³ã€‚</p>
<h3 data-id="heading-4">è½¬æŠ˜ç‚¹:Transformeræ¶æ„æ¨ªç©ºå‡ºä¸–(2017)</h3>
<p>ä¸€åˆ‡åœ¨2017å¹´æ”¹å˜äº†ã€‚</p>
<p>Google DeepMindå›¢é˜Ÿå‘å¸ƒäº†ä¸€ç¯‡åä¸ºã€ŠAttention is All You Needã€‹(æ³¨æ„åŠ›å³ä¸€åˆ‡)çš„è®ºæ–‡,ä»‹ç»äº†ä¸€ç§å…¨æ–°çš„æ¶æ„â€”â€”<strong>Transformer</strong>ã€‚æœ‰è¶£çš„æ˜¯,Googleå½“æ—¶å¯èƒ½éƒ½æ²¡æœ‰æ„è¯†åˆ°è‡ªå·±å‘å¸ƒäº†ä»€ä¹ˆâ€”â€”è¿™ç¯‡è®ºæ–‡æœ€ç»ˆå¯å‘OpenAIå¼€å‘å‡ºäº†ChatGPT,ä¸€ä¸ªå¯èƒ½æˆä¸ºGoogleæœç´¢æœ€å¼ºç«äº‰å¯¹æ‰‹çš„äº§å“ã€‚</p>
<p>Transformerå¸¦æ¥äº†ä»€ä¹ˆ?</p>
<ul>
<li>
<p><strong>å¤§å¹…ç¼©çŸ­çš„è®­ç»ƒæ—¶é—´</strong></p>
</li>
<li>
<p><strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>(Self-Attention),è®©æ¨¡å‹èƒ½ç†è§£å¥å­ä¸­è¯è¯­ä¹‹é—´çš„å¤æ‚å…³ç³»</p>
</li>
<li>
<p><strong>å¯å¹¶è¡ŒåŒ–çš„æ¶æ„</strong>,ä½¿å¤§è§„æ¨¡è®­ç»ƒæˆä¸ºå¯èƒ½</p>
</li>
</ul>
<h3 data-id="heading-5">å‚æ•°çˆ†ç‚¸æ—¶ä»£:ä»ç™¾ä¸‡åˆ°ä¸‡äº¿(2018-2023)</h3>
<p>Transformeræ‰“å¼€äº†æ½˜å¤šæ‹‰é­”ç›’ã€‚</p>
<ul>
<li>
<p><strong>2018å¹´,GPT-1</strong>:1.17äº¿å‚æ•°,å®Œå…¨é©å‘½æ€§,ä½†å¾ˆå¿«å°±è¢«è¶…è¶Š</p>
</li>
<li>
<p><strong>2018å¹´,BERT</strong>:3.4äº¿å‚æ•°,å¼•å…¥åŒå‘å¤„ç†(èƒ½åŒæ—¶ç†è§£å‰åæ–‡)</p>
</li>
<li>
<p><strong>2019å¹´,GPT-2</strong>:25äº¿å‚æ•°,è§„æ¨¡æå‡ä½†æŠ€æœ¯æœªæœ‰é‡å¤§çªç ´</p>
</li>
<li>
<p><strong>2020å¹´,GPT-3</strong>:1750äº¿å‚æ•°,å…¬ä¼—å¼€å§‹çœŸæ­£æ³¨æ„åˆ°LLMçš„æ½œåŠ›</p>
</li>
<li>
<p><strong>2022å¹´12æœˆ,ChatGPT 3.5</strong>:å¼•çˆ†å½“å‰AIæµªæ½®çš„äº§å“</p>
</li>
<li>
<p><strong>2023å¹´3æœˆ,GPT-4</strong>:æ®æŠ¥é“æœ‰1.76ä¸‡äº¿å‚æ•°,é‡‡ç”¨"æ··åˆä¸“å®¶"(Mixture of Experts)æ¶æ„â€”â€”å¤šä¸ªé’ˆå¯¹ç‰¹å®šä»»åŠ¡å¾®è°ƒçš„æ¨¡å‹ç»„åˆ,æ ¹æ®é—®é¢˜ç±»å‹æ™ºèƒ½é€‰æ‹©åˆé€‚çš„"ä¸“å®¶"æ¨¡å‹</p>
</li>
</ul>
<p>ä»ç™¾ä¸‡åˆ°ä¸‡äº¿,å‚æ•°é‡å¢é•¿äº†<strong>å…­ä¸ªæ•°é‡çº§</strong>ã€‚è¿™ä¸ä»…ä»…æ˜¯è§„æ¨¡æ‰©å¤§,æ›´æ˜¯è´¨çš„é£è·ƒâ€”â€”GPT-4çš„å‡†ç¡®æ€§ã€å¤šæ¨¡æ€èƒ½åŠ›(æ–‡å­—ã€å›¾åƒã€è¯­éŸ³)ã€æ¨ç†èƒ½åŠ›éƒ½è¾¾åˆ°äº†å‰æ‰€æœªæœ‰çš„é«˜åº¦ã€‚</p>
<h2 data-id="heading-6">æ­å¼€é»‘ç®±:LLMç©¶ç«Ÿå¦‚ä½•å·¥ä½œ?</h2>
<p>LLMçš„å·¥ä½œæµç¨‹å¯ä»¥åˆ†è§£ä¸ºä¸‰ä¸ªæ ¸å¿ƒæ­¥éª¤:<strong>åˆ†è¯â†’åµŒå…¥â†’Transformer</strong>ã€‚å¬èµ·æ¥å¾ˆæŠ€æœ¯?è®©æˆ‘ä»¬ä¸€æ­¥æ­¥æ‹†è§£ã€‚</p>
<h3 data-id="heading-7">ç¬¬ä¸€æ­¥:åˆ†è¯(Tokenization)â€”â€”æŠŠæ–‡å­—åˆ‡æˆå¯æ¶ˆåŒ–çš„å°å—</h3>
<p>LLMä¸æ˜¯ç›´æ¥å¤„ç†å®Œæ•´çš„å¥å­,è€Œæ˜¯å…ˆæŠŠå®ƒä»¬æ‹†åˆ†æˆ<strong>è¯å…ƒ(tokens)</strong>ã€‚ä¸€ä¸ªtokenå¤§çº¦ç­‰äº3/4ä¸ªè‹±æ–‡å•è¯ã€‚</p>
<p>ä¾‹å¦‚,"What is the tallest building?"ä¼šè¢«æ‹†åˆ†æˆ:</p>
<ul>
<li>"What" "is" "the" "tall" "est" "building" "?"</li>
</ul>
<p>æ³¨æ„"tallest"è¢«åˆ†æˆäº†"tall"å’Œ"est",è€Œ"building"ä¿æŒå®Œæ•´â€”â€”æ¨¡å‹ä¼šæ ¹æ®ä¸Šä¸‹æ–‡æ™ºèƒ½å†³å®šå¦‚ä½•åˆ‡åˆ†ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹å°±åƒäººç±»é˜…è¯»:æˆ‘ä»¬ä¹Ÿæ˜¯é€å­—ç†è§£,ç„¶åç»„åˆæˆå®Œæ•´æ„ä¹‰ã€‚</p>
<h3 data-id="heading-8">ç¬¬äºŒæ­¥:åµŒå…¥(Embeddings)â€”â€”ç»™æ¯ä¸ªè¯åˆ†é…GPSåæ ‡</h3>
<p>æ¥ä¸‹æ¥å‘ç”Ÿäº†ä¸€ä»¶ç¥å¥‡çš„äº‹:<strong>æ¯ä¸ªè¯å…ƒè¢«è½¬æ¢æˆä¸€ä¸²æ•°å­—å‘é‡</strong>ã€‚</p>
<p>ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåš?å› ä¸ºè®¡ç®—æœºåªæ‡‚æ•°å­—,ä¸æ‡‚æ–‡å­—çš„"æ„ä¹‰"ã€‚ä½†é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ•°å­¦è½¬æ¢,æˆ‘ä»¬å¯ä»¥è®©ç›¸ä¼¼çš„è¯æ‹¥æœ‰ç›¸ä¼¼çš„æ•°å­—è¡¨ç¤ºã€‚</p>
<p>è¿™äº›æ•°å­—å‘é‡è¢«å­˜å‚¨åœ¨<strong>å‘é‡æ•°æ®åº“</strong>ä¸­ã€‚ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªå·¨å¤§çš„GPSç³»ç»Ÿ,æ¯ä¸ªè¯éƒ½æœ‰è‡ªå·±çš„"åæ ‡"ã€‚</p>
<p>æ¥çœ‹ä¸€ä¸ªç»å…¸ä¾‹å­:<strong>"book"(ä¹¦)å’Œ"worm"(è™«å­)</strong></p>
<p>å•ç‹¬çœ‹,è¿™ä¸¤ä¸ªè¯æ¯«æ— å…³ç³»ã€‚ä½†å®ƒä»¬ç»å¸¸ä¸€èµ·å‡ºç°åœ¨"bookworm"(ä¹¦è™«,æŒ‡çˆ±è¯»ä¹¦çš„äºº)è¿™ä¸ªè¯ä¸­ã€‚å› æ­¤,åœ¨å‘é‡ç©ºé—´é‡Œ,å®ƒä»¬çš„"åæ ‡"ä¼šæ¯”è¾ƒæ¥è¿‘ã€‚</p>
<p>å°±åƒåœ°å›¾ä¸Šä¸¤ä¸ªç›¸è¿‘çš„åœ°æ ‡ä¼šæœ‰ç›¸ä¼¼çš„ç»çº¬åº¦ä¸€æ ·,<strong>å‘é‡æ•°æ®åº“å°±åƒç»™æ¯ä¸ªè¯åˆ†é…äº†è¯­ä¹‰GPSåæ ‡</strong>ã€‚è¿™è®©æ¨¡å‹èƒ½ç†è§£:</p>
<ul>
<li>
<p>"å›½ç‹" - "ç”·æ€§" + "å¥³æ€§" â‰ˆ "å¥³ç‹"</p>
</li>
<li>
<p>"å·´é»" - "æ³•å›½" + "æ—¥æœ¬" â‰ˆ "ä¸œäº¬"</p>
</li>
</ul>
<h3 data-id="heading-9">ç¬¬ä¸‰æ­¥:Transformerâ€”â€”é¢„æµ‹ä¸‹ä¸€ä¸ªè¯çš„é­”æ³•</h3>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†æ•°å­—å‘é‡,Transformerç™»åœºäº†ã€‚</p>
<p>Transformeré€šè¿‡<strong>å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶</strong>(Multi-Head Attention)å°†è¾“å…¥å‘é‡çŸ©é˜µè½¬æ¢ä¸ºè¾“å‡ºå‘é‡çŸ©é˜µã€‚ç®€å•æ¥è¯´,å®ƒä¼šè®¡ç®—å¥å­ä¸­æ¯ä¸ªè¯å¯¹æ•´ä½“æ„ä¹‰çš„"è´¡çŒ®åº¦"ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­:"The cat sat on the mat because it was soft."</p>
<p>å½“é¢„æµ‹ä¸‹ä¸€ä¸ªè¯æ—¶,æ¨¡å‹éœ€è¦åˆ¤æ–­"it"æŒ‡çš„æ˜¯çŒ«è¿˜æ˜¯å«å­ã€‚å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ä¼šè®¡ç®—:</p>
<ul>
<li>
<p>"it"ä¸"mat"çš„å…³ç³»å¼ºåº¦(é«˜)</p>
</li>
<li>
<p>"it"ä¸"cat"çš„å…³ç³»å¼ºåº¦(ä½)</p>
</li>
<li>
<p>"soft"è¿™ä¸ªè¯çš„ä¸Šä¸‹æ–‡æš—ç¤º(å«å­æ›´å¯èƒ½æ˜¯è½¯çš„)</p>
</li>
</ul>
<p>æœ€ç»ˆ,æ¨¡å‹é€šè¿‡è¿™äº›è®¡ç®—ç»™å‡ºæ¦‚ç‡æœ€é«˜çš„ä¸‹ä¸€ä¸ªè¯ã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹çš„æ ¸å¿ƒæ˜¯<strong>æƒé‡</strong>(weights)â€”â€”æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å­¦åˆ°çš„æ•°åäº¿ç”šè‡³æ•°ä¸‡äº¿ä¸ªå‚æ•°,å®ƒä»¬å†³å®šäº†å¦‚ä½•è¿›è¡Œè¿™äº›æ•°å­¦è½¬æ¢ã€‚è€Œè®­ç»ƒ,å°±æ˜¯ä¸æ–­è°ƒæ•´è¿™äº›æƒé‡,ç›´åˆ°æ¨¡å‹èƒ½å‡†ç¡®é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ã€‚</p>
<h2 data-id="heading-10">è®­ç»ƒLLM:ä¸€åœºçƒ§é’±çš„é©¬æ‹‰æ¾</h2>
<p>è®­ç»ƒä¸€ä¸ªå¤§å‹è¯­è¨€æ¨¡å‹éœ€è¦ä»€ä¹ˆ?<strong>æµ·é‡æ•°æ®ã€ææ€–ç®—åŠ›ã€å¤©ä»·æˆæœ¬</strong>ã€‚</p>
<h3 data-id="heading-11">æ•°æ®è§„æ¨¡:è¶…å‡ºæƒ³è±¡çš„åºå¤§</h3>
<p>è®©æˆ‘ä»¬ç”¨è§†è§‰åŒ–æ¥ç†è§£è®­ç»ƒæ•°æ®çš„è§„æ¨¡:</p>
<ul>
<li>
<p>ä¸€å°æ®µæ–‡å­— = 276ä¸ªtokens</p>
</li>
<li>
<p>ç¼©å°åˆ°ä¸€ä¸ªåƒç´  = 276ä¸ªtokens</p>
</li>
<li>
<p>æŸäº›LLMçš„è®­ç»ƒæ•°æ® = <strong>1.3ä¸‡äº¿tokens</strong></p>
</li>
<li>
<p>285ç™¾ä¸‡tokensåªå æ€»è®­ç»ƒæ•°æ®çš„<strong>0.02%</strong></p>
</li>
</ul>
<p>è¿™äº›æ•°æ®æ¥è‡ªå“ªé‡Œ?ç½‘é¡µã€ä¹¦ç±ã€Redditå¸–å­ã€X(Twitter)æ¨æ–‡ã€YouTubeå­—å¹•â€¦â€¦å‡ ä¹æ‰€æœ‰å…¬å¼€å¯è·å–çš„æ–‡æœ¬ã€‚</p>
<p>è¿™å¼•å‡ºä¸€ä¸ªå…³é”®åŸåˆ™:<strong>åƒåœ¾è¿›,åƒåœ¾å‡º</strong>(Garbage In, Garbage Out)ã€‚</p>
<p>å¦‚æœè®­ç»ƒæ•°æ®å……æ»¡åè§ã€é”™è¯¯æˆ–æœ‰å®³å†…å®¹,æ¨¡å‹ä¹Ÿä¼šå­¦åˆ°è¿™äº›ã€‚æ•°æ®è´¨é‡ç›´æ¥å†³å®šäº†æ¨¡å‹è´¨é‡,è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæ•°æ®é¢„å¤„ç†â€”â€”æ¸…æ´—ã€æ ‡æ³¨ã€è½¬æ¢ã€å»é‡â€”â€”æˆä¸ºäº†ä¸€é—¨å¤æ‚çš„ç§‘å­¦ã€‚</p>
<h3 data-id="heading-12">ç®—åŠ›éœ€æ±‚:è‹±ä¼Ÿè¾¾çš„é»„é‡‘æ—¶ä»£</h3>
<p>è®­ç»ƒå¤§æ¨¡å‹éœ€è¦ä»€ä¹ˆç¡¬ä»¶?<strong>ä¸“é—¨ä¸ºLLMæ•°å­¦è¿ç®—è®¾è®¡çš„GPUèŠ¯ç‰‡</strong>ã€‚</p>
<p>è‹±ä¼Ÿè¾¾(NVIDIA)æ­£æ˜¯æŠ“ä½äº†è¿™ä¸ªæœºä¼š,å¼€å‘å‡ºé’ˆå¯¹æ·±åº¦å­¦ä¹ ä¼˜åŒ–çš„ç¡¬ä»¶,å…¶è‚¡ä»·å’Œè¥æ”¶åœ¨è¿‡å»å‡ å¹´å‡ºç°äº†<strong>çˆ†ç‚¸å¼å¢é•¿</strong>ã€‚è¿™ä¸æ˜¯å¶ç„¶â€”â€”å½“å…¨ä¸–ç•Œéƒ½åœ¨äº‰ç›¸è®­ç»ƒæ›´å¤§çš„æ¨¡å‹æ—¶,è°æŒæ¡äº†ç®—åŠ›,è°å°±æŒæ¡äº†AIæ—¶ä»£çš„çŸ³æ²¹ã€‚</p>
<p>è®­ç»ƒè¿‡ç¨‹æ˜¯è¿™æ ·çš„:</p>
<ol>
<li>
<p>å°†é¢„å¤„ç†åçš„æ–‡æœ¬æ•°æ®å–‚ç»™æ¨¡å‹</p>
</li>
<li>
<p>æ¨¡å‹å°è¯•é¢„æµ‹ä¸‹ä¸€ä¸ªè¯</p>
</li>
<li>
<p>å¯¹æ¯”é¢„æµ‹å’Œå®é™…,è°ƒæ•´æƒé‡</p>
</li>
<li>
<p>é‡å¤<strong>æ•°ç™¾ä¸‡æ¬¡</strong>,ç›´åˆ°è¾¾åˆ°æœ€ä¼˜è´¨é‡</p>
</li>
</ol>
<p>æœ€åä¸€æ­¥æ˜¯<strong>è¯„ä¼°</strong>:ç”¨é¢„ç•™çš„æµ‹è¯•æ•°æ®æ£€éªŒæ¨¡å‹è¡¨ç°,ä½¿ç”¨"å›°æƒ‘åº¦"(Perplexity)ç­‰æŒ‡æ ‡è¡¡é‡æ•ˆæœ,å†ç»“åˆäººç±»åé¦ˆ(RLHF, Reinforcement Learning from Human Feedback)è¿›è¡Œæœ€ç»ˆè°ƒä¼˜ã€‚</p>
<h3 data-id="heading-13">æˆæœ¬:ä¸ºä»€ä¹ˆåªæœ‰å·¨å¤´ç©å¾—èµ·</h3>
<p>è®­ç»ƒä¸€ä¸ªé¡¶çº§LLMéœ€è¦:</p>
<ul>
<li>
<p>æ•°åƒå—é«˜ç«¯GPU</p>
</li>
<li>
<p>è¿ç»­æ•°å‘¨ç”šè‡³æ•°æœˆçš„è¿è¡Œæ—¶é—´</p>
</li>
<li>
<p>å·¨é¢ç”µè´¹</p>
</li>
<li>
<p>ä¸“ä¸šå›¢é˜Ÿçš„å·¥ç¨‹æŠ•å…¥</p>
</li>
</ul>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåªæœ‰OpenAIã€Googleã€Metaã€Anthropicè¿™æ ·çš„å·¨å¤´æ‰èƒ½è®­ç»ƒæœ€å‰æ²¿çš„æ¨¡å‹ã€‚ä½†å¥½æ¶ˆæ¯æ˜¯â€¦â€¦</p>
<h2 data-id="heading-14">å¾®è°ƒ:è®©æ™®é€šäººä¹Ÿèƒ½"å®šåˆ¶"AI</h2>
<p>å¦‚æœä»é›¶è®­ç»ƒä¸€ä¸ªLLMæ˜¯"å»ºé€ ä¸€åº§æ‘©å¤©å¤§æ¥¼",é‚£ä¹ˆ<strong>å¾®è°ƒ</strong>(Fine-tuning)å°±æ˜¯"è£…ä¿®ä½ çš„å…¬å¯“"ã€‚</p>
<p>å¾®è°ƒçš„é€»è¾‘å¾ˆç®€å•:æ‹¿ä¸€ä¸ªå·²ç»è®­ç»ƒå¥½çš„"åŸºç¡€æ¨¡å‹"(å¦‚GPT-3),ç”¨ä½ ç‰¹å®šé¢†åŸŸçš„æ•°æ®å¯¹å®ƒè¿›è¡Œé¢å¤–è®­ç»ƒ,è®©å®ƒåœ¨ä½ çš„ä»»åŠ¡ä¸Šè¡¨ç°æ›´å¥½ã€‚</p>
<h3 data-id="heading-15">ç»å…¸æ¡ˆä¾‹:æŠ«è¨åº—å®¢æœAI</h3>
<p>å‡è®¾ä½ æƒ³è®­ç»ƒä¸€ä¸ªAIæ¥æ¥ç”µè¯è®¢å•:</p>
<ol>
<li>
<p>æ”¶é›†çœŸå®çš„æŠ«è¨åº—å®¢æœå¯¹è¯è®°å½•</p>
</li>
<li>
<p>æ ‡æ³¨å…³é”®ä¿¡æ¯(æŠ«è¨ç§ç±»ã€å°ºå¯¸ã€é…æ–™ã€åœ°å€)</p>
</li>
<li>
<p>ç”¨è¿™äº›æ•°æ®å¾®è°ƒä¸€ä¸ªåŸºç¡€æ¨¡å‹</p>
</li>
<li>
<p>å‡ å°æ—¶æˆ–å‡ å¤©å,ä½ å°±æœ‰äº†ä¸€ä¸ªä¸“ä¸šçš„"æŠ«è¨å®¢æœAI"</p>
</li>
</ol>
<p>å¾®è°ƒçš„ä¼˜åŠ¿:</p>
<ul>
<li>
<p><strong>å¿«å¾—å¤š</strong>:ç›¸æ¯”å®Œæ•´è®­ç»ƒèŠ‚çœ90%ä»¥ä¸Šæ—¶é—´</p>
</li>
<li>
<p><strong>ä¾¿å®œå¾—å¤š</strong>:æ™®é€šå…¬å¸ä¹Ÿè´Ÿæ‹…å¾—èµ·</p>
</li>
<li>
<p><strong>æ•ˆæœæ›´å¥½</strong>:é’ˆå¯¹ç‰¹å®šä»»åŠ¡çš„å‡†ç¡®æ€§è¿œè¶…é€šç”¨æ¨¡å‹</p>
</li>
<li>
<p><strong>å¯å¤ç”¨</strong>:ä¸€ä¸ªåŸºç¡€æ¨¡å‹å¯ä»¥å¾®è°ƒå‡ºæ— æ•°ä¸ªä¸“ä¸šç‰ˆæœ¬</p>
</li>
</ul>
<p>å…³é”®ä»ç„¶æ˜¯æ•°æ®è´¨é‡ã€‚ä¸€ä¸ªå¥½çš„å¾®è°ƒæ•°æ®é›†èƒ½è®©æ¨¡å‹ç†è§£ç‰¹å®šé¢†åŸŸçš„æœ¯è¯­ã€å¯¹è¯é£æ ¼ã€å¸¸è§é—®é¢˜â€”â€”è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ•°æ®æ­£åœ¨æˆä¸ºAIæ—¶ä»£æœ€å®è´µçš„èµ„äº§ã€‚</p>
<h2 data-id="heading-16">å†·é™ä¸€ä¸‹:LLMçš„å±€é™æ€§ä¸æŒ‘æˆ˜</h2>
<p>åœ¨ä¸ºLLMçš„èƒ½åŠ›æƒŠå¹ä¹‹ä½™,æˆ‘ä»¬å¿…é¡»æ­£è§†å®ƒä»¬çš„ç¼ºé™·â€”â€”è€Œè¿™äº›ç¼ºé™·,æœ‰äº›ç”šè‡³æ˜¯æ ¹æœ¬æ€§çš„ã€‚</p>
<h3 data-id="heading-17">1. å¹»è§‰:è‡ªä¿¡çš„é”™è¯¯æ¯”ä¸ç¡®å®šçš„æ­£ç¡®æ›´å±é™©</h3>
<p>LLMæœ‰æ—¶ä¼š"å¹»è§‰"â€”â€”è‡ªä¿¡æ»¡æ»¡åœ°ç¼–é€ æ ¹æœ¬ä¸å­˜åœ¨çš„äº‹å®ã€‚</p>
<p>çœ‹è¿™ä¸ªä¾‹å­:</p>
<blockquote>
<p>é—®:"å­—ç¬¦ä¸²'abcdefghijklmno'æœ‰å¤šå°‘ä¸ªå­—æ¯?"</p>
<p>ç­”:"è¿™ä¸ªå­—ç¬¦ä¸²æœ‰16ä¸ªå­—æ¯ã€‚"</p>
</blockquote>
<p>å®é™…ä¸Šåªæœ‰15ä¸ªã€‚ä½†æ¨¡å‹ä¸ä¼šè¯´"æˆ‘ä¸ç¡®å®š",è€Œæ˜¯ä»¥å®Œå…¨çš„ç¡®å®šæ€§ç»™å‡ºé”™è¯¯ç­”æ¡ˆã€‚è¿™åœ¨åŒ»ç–—ã€æ³•å¾‹ã€é‡‘èç­‰é«˜é£é™©é¢†åŸŸå¯èƒ½é€ æˆç¾éš¾æ€§åæœã€‚</p>
<h3 data-id="heading-18">2. åè§:äººç±»çš„åŸç½ª</h3>
<p>LLMæ˜¯ä»äººç±»åˆ›é€ çš„æ•°æ®ä¸­å­¦ä¹ çš„,è€Œäººç±»æœ¬èº«å……æ»¡åè§â€”â€”æ€§åˆ«æ­§è§†ã€ç§æ—æ­§è§†ã€é˜¶çº§åè§â€¦â€¦è¿™äº›éƒ½ä¼šæ¸—é€è¿›æ¨¡å‹ã€‚</p>
<p>æŸäº›å…¬å¸è¯•å›¾é€šè¿‡"å®¡æŸ¥"æ¥è§£å†³è¿™ä¸ªé—®é¢˜,ä½†è¿™åˆå¼•å‘äº†å¦ä¸€ä¸ªäº‰è®®:è°æ¥å†³å®šä»€ä¹ˆæ˜¯"æœ‰å®³"å†…å®¹?å®¡æŸ¥çš„è¾¹ç•Œåœ¨å“ªé‡Œ?</p>
<h3 data-id="heading-19">3. çŸ¥è¯†æˆªæ­¢:æ´»åœ¨è¿‡å»çš„AI</h3>
<p>ä¼ ç»ŸLLMåªçŸ¥é“è®­ç»ƒæ—¶çš„ä¿¡æ¯ã€‚å¦‚æœå®ƒåœ¨2023å¹´1æœˆå®Œæˆè®­ç»ƒ,å®ƒå°±å¯¹ä¹‹åå‘ç”Ÿçš„ä¸€åˆ‡ä¸€æ— æ‰€çŸ¥ã€‚</p>
<p>è™½ç„¶ChatGPTç°åœ¨å¯ä»¥è”ç½‘æœç´¢,Grokå¯ä»¥è®¿é—®å®æ—¶æ¨æ–‡,ä½†è¿™äº›è§£å†³æ–¹æ¡ˆè¿˜ä¸å¤Ÿå®Œå–„,å¸¸å¸¸æ£€ç´¢åˆ°ä¸ç›¸å…³æˆ–è¿‡æ—¶çš„ä¿¡æ¯ã€‚</p>
<h3 data-id="heading-20">4. æ•°å­¦å’Œé€»è¾‘:AIçš„é˜¿å–€ç‰æ–¯ä¹‹è¸µ</h3>
<p>è®½åˆºçš„æ˜¯,å°½ç®¡LLMåœ¨åˆ›æ„å†™ä½œå’Œè¯­è¨€ç†è§£ä¸Šæ¥è¿‘äººç±»,ä½†åœ¨é€»è¾‘æ¨ç†å’Œæ•°å­¦è®¡ç®—ä¸Šä»ç„¶æŒ£æ‰â€”â€”è€Œè¿™äº›æ°æ°æ˜¯ä¼ ç»Ÿç¼–ç¨‹çš„å¼ºé¡¹ã€‚</p>
<h3 data-id="heading-21">5. æˆæœ¬å’Œèƒ½è€—:ä¸å¯æŒç»­çš„å¢é•¿?</h3>
<p>è®­ç»ƒå’Œè¿è¡Œå¤§æ¨¡å‹éœ€è¦æµ·é‡ç”µåŠ›ã€‚éšç€æ¨¡å‹è§„æ¨¡ä¸æ–­æ‰©å¤§,è¿™å¸¦æ¥äº†ä¸¥é‡çš„ç¯å¢ƒé—®é¢˜ã€‚æˆ‘ä»¬èƒ½å¦æ‰¾åˆ°æ›´é«˜æ•ˆçš„æ¶æ„?è¿™æ˜¯æ•´ä¸ªè¡Œä¸šé¢ä¸´çš„æŒ‘æˆ˜ã€‚</p>
<h3 data-id="heading-22">6. ä¼¦ç†å’Œæ³•å¾‹:æ½˜å¤šæ‹‰é­”ç›’å·²ç»æ‰“å¼€</h3>
<ul>
<li>
<p><strong>ç‰ˆæƒä¾µæƒ</strong>:è®¸å¤šæ¨¡å‹æ‰¿è®¤è®­ç»ƒæ•°æ®åŒ…å«å—ç‰ˆæƒä¿æŠ¤çš„ææ–™,æ³•å¾‹è¯‰è®¼æ­£åœ¨è¿›è¡Œä¸­</p>
</li>
<li>
<p><strong>è¢«æ¶æ„ä½¿ç”¨</strong>:LLMå¯ä»¥è¢«ç”¨äºè¯ˆéª—ã€åˆ¶é€ è™šå‡ä¿¡æ¯ã€ç”Ÿæˆæ·±åº¦ä¼ªé€ å†…å®¹</p>
</li>
<li>
<p><strong>å·¥ä½œæ›¿ä»£</strong>:å½“AIèƒ½åšäººç±»åœ¨ç”µè„‘å‰åšçš„ä¸€åˆ‡,ä»€ä¹ˆå·¥ä½œæ˜¯å®‰å…¨çš„?</p>
</li>
</ul>
<p>è¿™æœ€åä¸€ç‚¹å°¤å…¶å°–é”:<strong>å¾‹å¸ˆã€ä½œå®¶ã€ç¨‹åºå‘˜ã€å®¢æœã€åˆ†æå¸ˆâ€¦â€¦å‡ ä¹æ‰€æœ‰ç™½é¢†èŒä¸šéƒ½é¢ä¸´è¢«AIæ›¿ä»£çš„é£é™©</strong>ã€‚è¿™ä¸æ˜¯ç§‘å¹»,è¿™æ˜¯æ­£åœ¨å‘ç”Ÿçš„ç°å®ã€‚</p>
<h2 data-id="heading-23">åº”ç”¨æ— é™:LLMæ­£åœ¨é‡å¡‘çš„ä¸–ç•Œ</h2>
<p>å°½ç®¡æœ‰è¯¸å¤šå±€é™,LLMå·²ç»åœ¨ä¼—å¤šé¢†åŸŸå±•ç°äº†é©å‘½æ€§æ½œåŠ›:</p>
<ul>
<li>
<p><strong>è¯­è¨€ç¿»è¯‘</strong>:æ¥è¿‘äººç±»ç¿»è¯‘çš„å‡†ç¡®æ€§å’Œæµç•…åº¦</p>
</li>
<li>
<p><strong>ä»£ç ç”Ÿæˆ</strong>:ä»è‡ªç„¶è¯­è¨€æè¿°ç›´æ¥ç”Ÿæˆå¯è¿è¡Œçš„ç¨‹åº</p>
</li>
<li>
<p><strong>å†…å®¹åˆ›ä½œ</strong>:æ–‡ç« ã€è„šæœ¬ã€è¥é”€æ–‡æ¡ˆã€ç”šè‡³è¯—æ­Œ</p>
</li>
<li>
<p><strong>æ•™è‚²è¾…åŠ©</strong>:ä¸ªæ€§åŒ–å­¦ä¹ ã€å³æ—¶ç­”ç–‘</p>
</li>
<li>
<p><strong>å®¢æˆ·æœåŠ¡</strong>:24/7æ™ºèƒ½å®¢æœ,èƒ½ç†è§£å¤æ‚é—®é¢˜</p>
</li>
<li>
<p><strong>æ•°æ®åˆ†æ</strong>:è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Šå’Œæ´å¯Ÿ</p>
</li>
<li>
<p><strong>æ³•å¾‹å’ŒåŒ»ç–—è¾…åŠ©</strong>:åˆ†ææ–‡æ¡£ã€æä¾›åˆæ­¥å»ºè®®(éœ€è¦ä¸“ä¸šäººå£«å¤æ ¸)</p>
</li>
</ul>
<p>è€Œä¸”è¿™åªæ˜¯å¼€å§‹ã€‚éšç€æŠ€æœ¯è¿›æ­¥,<strong>åŸºæœ¬ä¸Šä»»ä½•"æ€è€ƒå‹å·¥ä½œ"éƒ½å¯èƒ½è¢«AIè¾…åŠ©ç”šè‡³æ›¿ä»£</strong>ã€‚</p>
<h2 data-id="heading-24">å‰æ²¿æ¢ç´¢:LLMçš„ä¸‹ä¸€ç«™åœ¨å“ªé‡Œ?</h2>
<p>AIç ”ç©¶è€…ä»¬æ­£åœ¨å¤šä¸ªæ–¹å‘æ¨åŠ¨LLMçš„è¾¹ç•Œ:</p>
<h3 data-id="heading-25">1. çŸ¥è¯†è’¸é¦:æŠŠ"æ•™æˆ"è£…è¿›æ‰‹æœº</h3>
<p><strong>çŸ¥è¯†è’¸é¦</strong>å°±åƒæ•™æˆæŠŠå‡ åå¹´ç»éªŒæµ“ç¼©æˆæ•™ç§‘ä¹¦â€”â€”å°†å¤§æ¨¡å‹çš„çŸ¥è¯†"è½¬ç§»"åˆ°æ›´å°ã€æ›´é«˜æ•ˆçš„æ¨¡å‹ä¸­ã€‚</p>
<p>è¿™æ„å‘³ç€ä»€ä¹ˆ?æœªæ¥ä½ çš„æ‰‹æœºå¯èƒ½è¿è¡Œä¸€ä¸ªæœ¬åœ°LLM,æ— éœ€è”ç½‘å°±èƒ½æä¾›æ™ºèƒ½åŠ©æ‰‹æœåŠ¡,åŒæ—¶ä¿æŠ¤éšç§ã€‚</p>
<h3 data-id="heading-26">2. RAG:ç»™AIè£…ä¸Š"å›¾ä¹¦é¦†"</h3>
<p><strong>æ£€ç´¢å¢å¼ºç”Ÿæˆ</strong>(Retrieval-Augmented Generation, RAG)è®©LLMèƒ½æŸ¥è¯¢å¤–éƒ¨çŸ¥è¯†åº“ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸ªä¼ä¸šAIåŠ©æ‰‹,å®ƒä¸ä»…æœ‰é€šç”¨çŸ¥è¯†,è¿˜èƒ½å®æ—¶æ£€ç´¢å…¬å¸å†…éƒ¨æ–‡æ¡£ã€äº§å“æ‰‹å†Œã€å†å²è®°å½•â€”â€”è¿™å°†å½»åº•æ”¹å˜ä¼ä¸šçŸ¥è¯†ç®¡ç†ã€‚</p>
<h3 data-id="heading-27">3. æ··åˆä¸“å®¶:æœ¯ä¸šæœ‰ä¸“æ”»</h3>
<p>GPT-4å·²ç»åœ¨ç”¨çš„<strong>æ··åˆä¸“å®¶æ¶æ„</strong>:ç»´æŠ¤å¤šä¸ª"ä¸“å®¶"æ¨¡å‹,æ¯ä¸ªæ“…é•¿ç‰¹å®šé¢†åŸŸ(ä»£ç ã€åˆ›æ„å†™ä½œã€ç§‘å­¦æ¨ç†ç­‰),æ ¹æ®é—®é¢˜æ™ºèƒ½è·¯ç”±ã€‚</p>
<p>è¿™æ—¢æé«˜äº†å‡†ç¡®æ€§,åˆä¿æŒäº†è¿è¡Œæ•ˆç‡â€”â€”ä¸éœ€è¦æ¯æ¬¡éƒ½å¯åŠ¨æ•´ä¸ªå·¨å‹æ¨¡å‹ã€‚</p>
<h3 data-id="heading-28">4. å¤šæ¨¡æ€:æ‰“é€šæ„Ÿå®˜çš„AI</h3>
<p>æœªæ¥çš„LLMä¸åªç†è§£æ–‡å­—,è¿˜èƒ½å¤„ç†è¯­éŸ³ã€å›¾åƒã€è§†é¢‘ç­‰å¤šç§è¾“å…¥,å¹¶ç”Ÿæˆå¤šç§å½¢å¼çš„è¾“å‡ºã€‚æƒ³è±¡ä¸€ä¸ªAIçœ‹è§†é¢‘ã€å¬éŸ³ä¹ã€è¯»æ–‡å­—,ç„¶åç»¼åˆæ‰€æœ‰ä¿¡æ¯ç»™ä½ å»ºè®®â€”â€”è¿™å°±æ˜¯å¤šæ¨¡æ€çš„æ„¿æ™¯ã€‚</p>
<h3 data-id="heading-29">5. "æ…¢æ€è€ƒ":è®©AIå­¦ä¼šæ·±åº¦æ€è€ƒ</h3>
<p>åƒOrca 2è¿™æ ·çš„ç ”ç©¶å¼ºåˆ¶LLM"é€æ­¥æ€è€ƒ"é—®é¢˜,è€Œä¸æ˜¯ç«‹å³è·³åˆ°ç»“è®ºã€‚è¿™æ˜¾è‘—æå‡äº†æ¨ç†èƒ½åŠ›,å°¤å…¶æ˜¯åœ¨å¤æ‚é€»è¾‘é—®é¢˜ä¸Šã€‚</p>
<p>äººç±»è§£å†³éš¾é¢˜æ—¶ä¹Ÿæ˜¯å¦‚æ­¤â€”â€”å¿«é€Ÿç›´è§‰å¾€å¾€å‡ºé”™,ç¼“æ…¢åˆ†ææ‰èƒ½æ‰¾åˆ°æ­£ç¡®ç­”æ¡ˆã€‚</p>
<h3 data-id="heading-30">6. æ— é™è®°å¿†:æ‰“ç ´ä¸Šä¸‹æ–‡é™åˆ¶</h3>
<p>å½“å‰LLMçš„"è®°å¿†åŠ›"æœ‰é™(é€šå¸¸å‡ ä¸‡åˆ°å‡ åä¸‡tokens)ã€‚ä½†åƒMemGPTè¿™æ ·çš„é¡¹ç›®æ­£åœ¨ç»™LLMæ·»åŠ <strong>å¤–éƒ¨è®°å¿†ç³»ç»Ÿ</strong>,è®©å®ƒä»¬èƒ½è®°ä½é•¿æœŸå¯¹è¯å†å²ã€ç”¨æˆ·åå¥½ã€è¿‡å¾€ä»»åŠ¡â€”â€”å°±åƒäººç±»çš„é•¿æœŸè®°å¿†ã€‚</p>
<h2 data-id="heading-31">ç»“è¯­:æ°¸è¿œæ˜¯æœ€å·®çš„ä¸€å¤©</h2>
<p>è¿™æ˜¯å…³äºLLMä½ å¿…é¡»è®°ä½çš„ä¸€ä¸ªæ‚–è®º:<strong>ä»Šå¤©çš„å¤§å‹è¯­è¨€æ¨¡å‹,æ˜¯å²ä¸Šæœ€å¼ºå¤§çš„LLM,ä¹Ÿæ˜¯æœªæ¥æœ€å¼±çš„LLM</strong>ã€‚</p>
<p>ä»1966å¹´çš„ELIZAåˆ°2023å¹´çš„GPT-4,æˆ‘ä»¬è§è¯äº†ä»ç®€å•æ¨¡å¼åŒ¹é…åˆ°å‡ ä¹é€šç”¨æ™ºèƒ½çš„è·¨è¶Šã€‚ä½†è¿™ä¸æ˜¯ç»ˆç‚¹,ç”šè‡³ä¸æ˜¯ä¸­ç‚¹â€”â€”é¢„è®­ç»ƒè§„æ¨¡å®šå¾‹å‘Šè¯‰æˆ‘ä»¬,æ›´å¤šæ•°æ®ã€æ›´å¤§æ¨¡å‹ã€æ›´ä¼˜æ¶æ„,ä»å°†å¸¦æ¥æŒç»­çªç ´ã€‚</p>
<p>æˆ‘ä»¬æ­£ç«™åœ¨ä¸€ä¸ªå†å²æ€§çš„è½¬æŠ˜ç‚¹ã€‚LLMä¸ä»…ä»…æ˜¯ä¸€é¡¹æŠ€æœ¯è¿›æ­¥,å®ƒä»£è¡¨äº†<strong>ä»æŒ‡ä»¤ç¼–ç¨‹åˆ°å­¦ä¹ å‹æ™ºèƒ½çš„èŒƒå¼é©å‘½</strong>â€”â€”è®¡ç®—æœºç¬¬ä¸€æ¬¡ä¸å†æ˜¯æ‰§è¡Œå‘½ä»¤çš„å·¥å…·,è€Œæ˜¯èƒ½å¤Ÿç†è§£ã€å­¦ä¹ ã€åˆ›é€ çš„"æ™ºèƒ½ä½“"ã€‚</p>
<p>è¿™åœºé©å‘½å……æ»¡å¸Œæœ›,ä¹Ÿå……æ»¡æŒ‘æˆ˜ã€‚å®ƒå¯èƒ½æå¤§æå‡äººç±»ç”Ÿäº§åŠ›,è§£å†³å¤æ‚é—®é¢˜;ä¹Ÿå¯èƒ½åŠ å‰§ä¸å¹³ç­‰,å¨èƒå°±ä¸š,å¼•å‘ä¼¦ç†å±æœºã€‚</p>
<p>ä½†æœ‰ä¸€ç‚¹æ˜¯ç¡®å®šçš„:<strong>AIä¸ä¼šåœæ­¢è¿›åŒ–,è€Œæˆ‘ä»¬å¿…é¡»è·Ÿä¸Šå®ƒçš„æ­¥ä¼</strong>ã€‚</p>
<p>ç†è§£LLMçš„å·¥ä½œåŸç†,ä¸ä»…æ˜¯ä¸ºäº†ä½¿ç”¨è¿™äº›å·¥å…·,æ›´æ˜¯ä¸ºäº†åœ¨AIæ—¶ä»£ä¿æŒæ¸…é†’çš„åˆ¤æ–­â€”â€”çŸ¥é“å®ƒä»¬èƒ½åšä»€ä¹ˆã€ä¸èƒ½åšä»€ä¹ˆ,çŸ¥é“æœºä¼šåœ¨å“ªé‡Œã€é£é™©åœ¨å“ªé‡Œã€‚</p>
<p>å› ä¸ºæ— è®ºä½ æ¥å—ä¸å¦,è¿™ä¸ªç”±å¤§å‹è¯­è¨€æ¨¡å‹é©±åŠ¨çš„æ–°ä¸–ç•Œ,å·²ç»åˆ°æ¥ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ADBKeyBoardï¼šé€šè¿‡ADBå®ç°Androidè™šæ‹Ÿé”®ç›˜è¾“å…¥]]></title>    <link>https://juejin.cn/post/7583324039302348851</link>    <guid>https://juejin.cn/post/7583324039302348851</guid>    <pubDate>2025-12-14T07:28:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583324039302348851" data-draft-id="7583242257371250715" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ADBKeyBoardï¼šé€šè¿‡ADBå®ç°Androidè™šæ‹Ÿé”®ç›˜è¾“å…¥"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,AIGC"/> <meta itemprop="datePublished" content="2025-12-14T07:28:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="qife122"/> <meta itemprop="url" content="https://juejin.cn/user/1743174852185579"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ADBKeyBoardï¼šé€šè¿‡ADBå®ç°Androidè™šæ‹Ÿé”®ç›˜è¾“å…¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1743174852185579/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    qife122
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T07:28:07.000Z" title="Sun Dec 14 2025 07:28:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ADBKeyBoardï¼šé€šè¿‡ADBå®ç°Androidè™šæ‹Ÿé”®ç›˜è¾“å…¥</h2>
<h3 data-id="heading-1">é¡¹ç›®æè¿°</h3>
<p>ADBKeyBoard æ˜¯ä¸€ä¸ªåˆ›æ–°çš„Androidè™šæ‹Ÿé”®ç›˜è¾“å…¥æ³•ã€‚å®ƒé€šè¿‡æ¥æ”¶ç³»ç»Ÿå¹¿æ’­æ„å›¾ï¼ˆBroadcast Intentsï¼‰æ¥æ‰§è¡Œè¾“å…¥å‘½ä»¤ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨ADBï¼ˆAndroid Debug Bridgeï¼‰ç›´æ¥å‘Androidè®¾å¤‡å‘é€æ–‡æœ¬è¾“å…¥ã€‚è¯¥é¡¹ç›®ä¸»è¦è§£å†³äº†æ ‡å‡†ADB <code>input</code> å‘½ä»¤æ— æ³•è¾“å…¥Unicodeå­—ç¬¦ï¼ˆå¦‚ä¸­æ–‡ã€è¡¨æƒ…ç¬¦å·ç­‰ï¼‰çš„é—®é¢˜ï¼Œæ˜¯è‡ªåŠ¨åŒ–æµ‹è¯•ã€è®¾å¤‡æ‰¹é‡æ“ä½œå’Œç‰¹æ®Šå­—ç¬¦è¾“å…¥åœºæ™¯çš„ç†æƒ³å·¥å…·ã€‚</p>
<h3 data-id="heading-2">åŠŸèƒ½ç‰¹æ€§</h3>
<ul>
<li><strong>ADBé©±åŠ¨çš„æ–‡æœ¬è¾“å…¥</strong>ï¼šé€šè¿‡ADBå‘½ä»¤ç›´æ¥å‘é€ä»»æ„æ–‡æœ¬åˆ°å½“å‰æ¿€æ´»çš„è¾“å…¥æ¡†ã€‚</li>
<li><strong>å®Œæ•´çš„Unicodeå­—ç¬¦æ”¯æŒ</strong>ï¼šçªç ´äº†åŸç”Ÿ<code>adb shell input text</code>å‘½ä»¤çš„é™åˆ¶ï¼Œå¯ä»¥è¾“å…¥åŒ…æ‹¬ä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡åŠEmojiåœ¨å†…çš„æ‰€æœ‰Unicodeå­—ç¬¦ã€‚</li>
<li><strong>å¤šç§è¾“å…¥æ¨¡å¼</strong>ï¼š
<ul>
<li>ç›´æ¥æ–‡æœ¬è¾“å…¥ (<code>ADB_INPUT_TEXT</code>)ã€‚</li>
<li>Base64ç¼–ç æ–‡æœ¬è¾“å…¥ (<code>ADB_INPUT_B64</code>)ï¼Œç”¨äºè§£å†³é«˜ç‰ˆæœ¬Androidç³»ç»Ÿçš„å…¼å®¹æ€§é—®é¢˜ã€‚</li>
<li>å‘é€é”®ä½äº‹ä»¶ç  (<code>ADB_INPUT_CODE</code>)ï¼Œæ¨¡æ‹Ÿç‰©ç†æŒ‰é”®ï¼ˆå¦‚åˆ é™¤ã€å›è½¦ï¼‰ã€‚</li>
<li>å‘é€ç¼–è¾‘å™¨åŠ¨ä½œ (<code>ADB_EDITOR_CODE</code>)ï¼Œå¦‚æ‰§è¡Œæœç´¢ã€å‰å¾€ç­‰åŠ¨ä½œã€‚</li>
<li>å‘é€Unicodeå­—ç¬¦ç ç‚¹ (<code>ADB_INPUT_CHARS</code>)ã€‚</li>
<li>å‘é€ç»„åˆé”®ï¼ˆMetaé”®ï¼‰ (<code>ADB_INPUT_MCODE</code>)ï¼Œå¦‚Ctrl+Aã€‚</li>
<li>æ¸…ç©ºæ–‡æœ¬ (<code>ADB_CLEAR_TEXT</code>)ã€‚</li>
</ul>
</li>
<li><strong>ä¾¿æ·çš„ADBæ§åˆ¶</strong>ï¼šæä¾›å®Œæ•´çš„ADBå‘½ä»¤æ¥å¯ç”¨ã€åˆ‡æ¢å’Œé‡ç½®è¾“å…¥æ³•ã€‚</li>
<li><strong>è½»é‡çº§ä¸æ˜“é›†æˆ</strong>ï¼šAPKä½“ç§¯å°ï¼Œé€šè¿‡å¹¿æ’­æœºåˆ¶ä¸ç³»ç»Ÿäº¤äº’ï¼Œæ— éœ€å¤æ‚çš„æƒé™æˆ–åå°æœåŠ¡ã€‚</li>
</ul>
<h3 data-id="heading-3">å®‰è£…æŒ‡å—</h3>
<h4 data-id="heading-4">æ–¹æ³•ä¸€ï¼šç›´æ¥å®‰è£…APKï¼ˆæ¨èï¼‰</h4>
<ol>
<li>ä»é¡¹ç›®çš„Releaseé¡µé¢ä¸‹è½½æœ€æ–°çš„ <code>ADBKeyboard.apk</code> æ–‡ä»¶ã€‚</li>
<li>è¿æ¥Androidè®¾å¤‡å¹¶å¼€å¯USBè°ƒè¯•æ¨¡å¼ã€‚</li>
<li>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š
<pre><code class="hljs language-bash" lang="bash">adb install ADBKeyboard.apk
</code></pre>
</li>
</ol>
<h4 data-id="heading-5">æ–¹æ³•äºŒï¼šä»æºç æ„å»º</h4>
<ol>
<li><strong>å…‹éš†ä»“åº“</strong>:
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> https://github.com/senzhk/ADBKeyBoard.git
<span class="hljs-built_in">cd</span> ADBKeyBoard
</code></pre>
</li>
<li><strong>é…ç½®ç¯å¢ƒ</strong>:
<ul>
<li>è®¾ç½® <code>ANDROID_HOME</code> ç¯å¢ƒå˜é‡æŒ‡å‘ä½ çš„Android SDKè·¯å¾„ï¼Œä¾‹å¦‚ï¼š
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">export</span> ANDROID_HOME=<span class="hljs-variable">$HOME</span>/Android/Sdk
</code></pre>
</li>
<li>æˆ–è€…ç›´æ¥ç¼–è¾‘é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>local.properties</code> æ–‡ä»¶ï¼Œæ·»åŠ  <code>sdk.dir=/path/to/your/Android/Sdk</code>ã€‚</li>
</ul>
</li>
<li><strong>æ„å»ºå¹¶å®‰è£…</strong>:
<pre><code class="hljs language-bash" lang="bash">./gradlew installDebug
</code></pre>
</li>
</ol>
<h4 data-id="heading-6">å¯ç”¨é”®ç›˜</h4>
<p>å®‰è£…åï¼Œéœ€è¦é€šè¿‡ADBæˆ–ç³»ç»Ÿè®¾ç½®å¯ç”¨å¹¶åˆ‡æ¢åˆ°æ­¤è¾“å…¥æ³•ã€‚</p>
<p><strong>é€šè¿‡ADBå¯ç”¨å’Œåˆ‡æ¢</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯ç”¨ADBKeyBoardè¾“å…¥æ³•</span>
adb shell ime <span class="hljs-built_in">enable</span> com.android.adbkeyboard/.AdbIME
<span class="hljs-comment"># å°†ADBKeyBoardè®¾ç½®ä¸ºå½“å‰é»˜è®¤è¾“å…¥æ³•</span>
adb shell ime <span class="hljs-built_in">set</span> com.android.adbkeyboard/.AdbIME
</code></pre>
<p><strong>é€šè¿‡ç³»ç»Ÿè®¾ç½®å¯ç”¨</strong>ï¼š
è¿›å…¥è®¾å¤‡çš„ <code>è®¾ç½®</code> -&gt; <code>ç³»ç»Ÿ</code> -&gt; <code>è¯­è¨€å’Œè¾“å…¥æ³•</code> -&gt; <code>è™šæ‹Ÿé”®ç›˜</code>ï¼Œæ‰¾åˆ°å¹¶å¯ç”¨â€œADBKeyBoardâ€ã€‚</p>
<h3 data-id="heading-7">ä½¿ç”¨è¯´æ˜</h3>
<p>å¯ç”¨ADBKeyBoardåï¼Œå³å¯é€šè¿‡å‘é€å¹¿æ’­æ„å›¾ï¼ˆBroadcast Intentsï¼‰æ¥æ§åˆ¶è¾“å…¥ã€‚</p>
<h4 data-id="heading-8">åŸºç¡€ä½¿ç”¨ç¤ºä¾‹</h4>
<ol>
<li>
<p><strong>å‘é€æ™®é€šæ–‡æœ¬</strong> (å¯èƒ½åœ¨é«˜ç‰ˆæœ¬Androidä¸Šå¤±æ•ˆ):</p>
<pre><code class="hljs language-bash" lang="bash">adb shell am broadcast -a ADB_INPUT_TEXT --es msg <span class="hljs-string">'ä½ å¥½å—? Hello?'</span>
</code></pre>
</li>
<li>
<p><strong>å‘é€Base64ç¼–ç çš„æ–‡æœ¬</strong> (æ¨èï¼Œå…¼å®¹æ€§æ›´å¥½):</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Mac/Linux</span>
adb shell am broadcast -a ADB_INPUT_B64 --es msg `<span class="hljs-built_in">echo</span> -n <span class="hljs-string">'ä½ å¥½å—? Hello?'</span> | <span class="hljs-built_in">base64</span>`
<span class="hljs-comment"># Windows (éœ€å€ŸåŠ©PowerShellæˆ–Pythonè„šæœ¬å¤„ç†Base64)</span>
</code></pre>
</li>
<li>
<p><strong>å‘é€æŒ‰é”®äº‹ä»¶</strong> (å¦‚åˆ é™¤é”®ï¼Œç å€¼67):</p>
<pre><code class="hljs language-bash" lang="bash">adb shell am broadcast -a ADB_INPUT_CODE --ei code 67
</code></pre>
</li>
<li>
<p><strong>å‘é€ç¼–è¾‘å™¨åŠ¨ä½œ</strong> (å¦‚â€œå‰å¾€â€åŠ¨ä½œï¼Œç å€¼2):</p>
<pre><code class="hljs language-bash" lang="bash">adb shell am broadcast -a ADB_EDITOR_CODE --ei code 2
</code></pre>
</li>
<li>
<p><strong>å‘é€Unicodeå­—ç¬¦ç ç‚¹</strong> (å‘é€â€œğŸ˜¸ Catâ€):</p>
<pre><code class="hljs language-bash" lang="bash">adb shell am broadcast -a ADB_INPUT_CHARS --eia chars <span class="hljs-string">'128568,32,67,97,116'</span>
</code></pre>
</li>
<li>
<p><strong>å‘é€ç»„åˆé”®</strong> (å¦‚Ctrl + A):</p>
<pre><code class="hljs language-bash" lang="bash">adb shell am broadcast -a ADB_INPUT_MCODE --es mcode <span class="hljs-string">'4096,29'</span>
</code></pre>
</li>
<li>
<p><strong>æ¸…ç©ºå½“å‰è¾“å…¥æ¡†çš„æ‰€æœ‰æ–‡æœ¬</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">adb shell am broadcast -a ADB_CLEAR_TEXT
</code></pre>
</li>
</ol>
<h4 data-id="heading-9">ADBè¾“å…¥æ³•ç®¡ç†å‘½ä»¤</h4>
<ul>
<li><strong>åˆ—å‡ºæ‰€æœ‰å¯ç”¨è¾“å…¥æ³•</strong>:
<pre><code class="hljs language-bash" lang="bash">adb shell ime list -a
</code></pre>
</li>
<li><strong>åˆ‡æ¢å›å…¶ä»–è¾“å…¥æ³•</strong> (ä¾‹å¦‚Swype):
<pre><code class="hljs language-bash" lang="bash">adb shell ime <span class="hljs-built_in">set</span> com.nuance.swype.dtc/com.nuance.swype.input.IME
</code></pre>
</li>
<li><strong>é‡ç½®ä¸ºç³»ç»Ÿé»˜è®¤è¾“å…¥æ³•</strong>:
<pre><code class="hljs language-bash" lang="bash">adb shell ime reset
</code></pre>
</li>
</ul>
<h3 data-id="heading-10">æ ¸å¿ƒä»£ç </h3>
<p>ä»¥ä¸‹æ˜¯é¡¹ç›®æ ¸å¿ƒç±» <code>AdbIME.java</code> çš„å…³é”®ä»£ç ç‰‡æ®µï¼Œå±•ç¤ºäº†å¹¿æ’­æ¥æ”¶å™¨çš„æ³¨å†Œå’Œæ¶ˆæ¯å¤„ç†é€»è¾‘ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.android.adbkeyboard;

<span class="hljs-keyword">import</span> android.content.BroadcastReceiver;
<span class="hljs-keyword">import</span> android.content.Context;
<span class="hljs-keyword">import</span> android.content.Intent;
<span class="hljs-keyword">import</span> android.content.IntentFilter;
<span class="hljs-keyword">import</span> android.inputmethodservice.InputMethodService;
<span class="hljs-keyword">import</span> android.util.Base64;
<span class="hljs-keyword">import</span> android.util.Log;
<span class="hljs-keyword">import</span> android.view.InputDevice;
<span class="hljs-keyword">import</span> android.view.KeyEvent;
<span class="hljs-keyword">import</span> android.view.View;
<span class="hljs-keyword">import</span> android.view.inputmethod.ExtractedTextRequest;
<span class="hljs-keyword">import</span> android.view.inputmethod.InputConnection;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdbIME</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">InputMethodService</span> {
    <span class="hljs-comment">// å®šä¹‰å¹¿æ’­Actionå¸¸é‡ï¼Œç”¨äºè¯†åˆ«ä¸åŒç±»å‹çš„è¾“å…¥æŒ‡ä»¤</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">IME_MESSAGE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ADB_INPUT_TEXT"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">IME_CHARS</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ADB_INPUT_CHARS"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">IME_KEYCODE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ADB_INPUT_CODE"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">IME_META_KEYCODE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ADB_INPUT_MCODE"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">IME_EDITORCODE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ADB_EDITOR_CODE"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">IME_MESSAGE_B64</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ADB_INPUT_B64"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">IME_CLEAR_TEXT</span> <span class="hljs-operator">=</span> <span class="hljs-string">"ADB_CLEAR_TEXT"</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-type">BroadcastReceiver</span> <span class="hljs-variable">mReceiver</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> View <span class="hljs-title function_">onCreateInputView</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// åŠ è½½ä¸€ä¸ªç®€å•çš„ç©ºè§†å›¾ä½œä¸ºè¾“å…¥æ³•ç•Œé¢</span>
        <span class="hljs-type">View</span> <span class="hljs-variable">mInputView</span> <span class="hljs-operator">=</span> getLayoutInflater().inflate(R.layout.view, <span class="hljs-literal">null</span>);

        <span class="hljs-comment">// æ³¨å†Œå¹¿æ’­æ¥æ”¶å™¨ï¼Œç”¨äºç›‘å¬æ¥è‡ªADBçš„å‘½ä»¤</span>
        <span class="hljs-keyword">if</span> (mReceiver == <span class="hljs-literal">null</span>) {
            <span class="hljs-type">IntentFilter</span> <span class="hljs-variable">filter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntentFilter</span>(IME_MESSAGE);
            filter.addAction(IME_CHARS);
            filter.addAction(IME_KEYCODE);

            filter.addAction(IME_EDITORCODE);
            filter.addAction(IME_MESSAGE_B64);
            filter.addAction(IME_CLEAR_TEXT);
            mReceiver = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AdbReceiver</span>();
            registerReceiver(mReceiver, filter);
        }
        <span class="hljs-keyword">return</span> mInputView;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDestroy</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// æœåŠ¡é”€æ¯æ—¶ï¼Œæ³¨é”€å¹¿æ’­æ¥æ”¶å™¨ä»¥é˜²æ­¢å†…å­˜æ³„æ¼</span>
        <span class="hljs-keyword">if</span> (mReceiver != <span class="hljs-literal">null</span>)
            unregisterReceiver(mReceiver);
        <span class="hljs-built_in">super</span>.onDestroy();
    }

    <span class="hljs-comment">// å†…éƒ¨å¹¿æ’­æ¥æ”¶å™¨ç±»ï¼Œè´Ÿè´£å¤„ç†æ¥æ”¶åˆ°çš„å„ç§è¾“å…¥å‘½ä»¤</span>
    <span class="hljs-keyword">class</span> <span class="hljs-title class_">AdbReceiver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BroadcastReceiver</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onReceive</span><span class="hljs-params">(Context context, Intent intent)</span> {
            <span class="hljs-comment">// å¤„ç†æ™®é€šæ–‡æœ¬è¾“å…¥å‘½ä»¤</span>
            <span class="hljs-keyword">if</span> (intent.getAction().equals(IME_MESSAGE)) {
                <span class="hljs-type">String</span> <span class="hljs-variable">msg</span> <span class="hljs-operator">=</span> intent.getStringExtra(<span class="hljs-string">"msg"</span>);
                <span class="hljs-keyword">if</span> (msg != <span class="hljs-literal">null</span>) {
                    <span class="hljs-type">InputConnection</span> <span class="hljs-variable">ic</span> <span class="hljs-operator">=</span> getCurrentInputConnection();
                    <span class="hljs-keyword">if</span> (ic != <span class="hljs-literal">null</span>)
                        ic.commitText(msg, <span class="hljs-number">1</span>); <span class="hljs-comment">// å°†æ–‡æœ¬æäº¤åˆ°å½“å‰è¾“å…¥è¿æ¥</span>
                }
                <span class="hljs-comment">// æ­¤å¤„ä»£ç çœç•¥äº†å¤„ç†å…ƒé”®ï¼ˆMeta Keyï¼‰çš„éƒ¨åˆ†é€»è¾‘</span>
            }
            <span class="hljs-comment">// å…¶ä»–Actionï¼ˆå¦‚IME_CHARS, IME_KEYCODEç­‰ï¼‰çš„å¤„ç†é€»è¾‘åœ¨æ­¤ç±»ä¸­ç»§ç»­å®ç°...</span>
        }
    }
}
</code></pre>
<p><strong>ä»£ç å…³é”®ç‚¹è§£æ</strong>:</p>
<ol>
<li>
<p><strong>ç»§æ‰¿ <code>InputMethodService</code></strong>ï¼š<code>AdbIME</code> ç±»æ˜¯Androidè¾“å…¥æ³•æœåŠ¡çš„åŸºç¡€ï¼Œä½¿å…¶æˆä¸ºä¸€ä¸ªåˆæ³•çš„ç³»ç»Ÿè¾“å…¥æ³•ã€‚</p>
</li>
<li>
<p><strong><code>onCreateInputView</code> æ–¹æ³•</strong>ï¼šåœ¨åˆ›å»ºè¾“å…¥æ³•è§†å›¾æ—¶ï¼Œåˆå§‹åŒ–å¹¶æ³¨å†Œä¸€ä¸ª <code>BroadcastReceiver</code> (<code>AdbReceiver</code>)ã€‚å®ƒç›‘å¬æ‰€æœ‰é¢„å®šä¹‰çš„å¹¿æ’­åŠ¨ä½œã€‚</p>
</li>
<li>
<p><strong><code>AdbReceiver</code> å†…éƒ¨ç±»</strong>ï¼šæ ¸å¿ƒé€»è¾‘æ‰€åœ¨ã€‚å…¶ <code>onReceive</code> æ–¹æ³•æ ¹æ® <code>Intent</code> çš„ Action ç±»å‹ï¼Œæå–é™„åŠ æ•°æ®ï¼ˆå¦‚æ–‡æœ¬ã€é”®å€¼ç ï¼‰ï¼Œå¹¶é€šè¿‡ <code>getCurrentInputConnection()</code> è·å–å½“å‰ç„¦ç‚¹è¾“å…¥æ¡†çš„è¿æ¥ï¼Œæœ€ç»ˆå°†è¾“å…¥å†…å®¹æäº¤ (<code>commitText</code>) æˆ–æ‰§è¡Œç›¸åº”åŠ¨ä½œã€‚</p>
</li>
<li>
<p><strong>ç”Ÿå‘½å‘¨æœŸç®¡ç†</strong>ï¼šåœ¨ <code>onDestroy</code> ä¸­æ³¨é”€å¹¿æ’­æ¥æ”¶å™¨ï¼Œè¿™æ˜¯Androidå¼€å‘ä¸­é˜²æ­¢ä¸Šä¸‹æ–‡æ³„æ¼çš„è‰¯å¥½å®è·µã€‚</p>
</li>
</ol>
<p>è¿™æ®µä»£ç æ¸…æ™°åœ°å±•ç¤ºäº†ADBKeyBoardçš„å·¥ä½œåŸç†ï¼šä½œä¸ºä¸€ä¸ªâ€œæ— ç•Œé¢â€çš„è¾“å…¥æ³•ï¼Œå®ƒä¸»è¦ä¾é åå°æ¥æ”¶å¹¿æ’­æŒ‡ä»¤æ¥å·¥ä½œï¼Œä»è€Œå®ç°é«˜åº¦çš„è‡ªåŠ¨åŒ–æ§åˆ¶èƒ½åŠ›ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼šæé€Ÿæ­å»ºå¾®æœåŠ¡åº”ç”¨]]></title>    <link>https://juejin.cn/post/7583324039302119475</link>    <guid>https://juejin.cn/post/7583324039302119475</guid>    <pubDate>2025-12-14T06:25:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583324039302119475" data-draft-id="7583242257371103259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼šæé€Ÿæ­å»ºå¾®æœåŠ¡åº”ç”¨"/> <meta itemprop="keywords" content="åç«¯,å¾®æœåŠ¡,Go"/> <meta itemprop="datePublished" content="2025-12-14T06:25:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å–µä¸ªå’ª"/> <meta itemprop="url" content="https://juejin.cn/user/1350630784901262"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼šæé€Ÿæ­å»ºå¾®æœåŠ¡åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1350630784901262/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å–µä¸ªå’ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:25:52.000Z" title="Sun Dec 14 2025 06:25:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å¼€ç®±å³ç”¨çš„ GoWind Adminï½œé£è¡Œï¼Œä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼šæé€Ÿæ­å»ºå¾®æœåŠ¡åº”ç”¨</h2>
<p>åœ¨ä¼ä¸šçº§ä¸­åå°ç³»ç»Ÿå¼€å‘ä¸­ï¼Œå¼€å‘è€…å¸¸å¸¸é¢ä¸´ä¸¤å¤§ç—›ç‚¹ï¼šä¸€æ˜¯å¾®æœåŠ¡æ¶æ„æ­å»ºç¹çï¼Œä»é¡¹ç›®åˆå§‹åŒ–åˆ°å¤šæœåŠ¡ååŒéœ€è¦å¤§é‡æ‰‹åŠ¨é…ç½®ï¼›äºŒæ˜¯å‰åç«¯ååŒæˆæœ¬é«˜ï¼Œæ¥å£å®šä¹‰ã€æ•°æ®æ¨¡å‹åŒæ­¥å¾€å¾€è€—æ—¶è´¹åŠ›ã€‚è€Œ <strong>GoWind Admin</strong>ï¼ˆç®€ç§°ã€Œé£è¡Œã€ï¼‰çš„å‡ºç°ï¼Œæ­£æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ â€”â€” å®ƒåŸºäº <code>gow</code> CLI å·¥å…·ï¼Œæä¾›äº†ä¸€å¥—å¼€ç®±å³ç”¨çš„ä¼ä¸šçº§å‰åç«¯ä¸€ä½“ä¸­åå°æ¡†æ¶ï¼Œè®©å¼€å‘è€…èƒ½ä»¥æä½æˆæœ¬å¿«é€Ÿæ­å»ºå¾®æœåŠ¡ä½“ç³»ã€‚</p>
<h3 data-id="heading-1">ä»€ä¹ˆæ˜¯ GoWind Adminï¼Ÿ</h3>
<p>GoWind Admin æ˜¯ä¸€å¥—èšç„¦ä¼ä¸šçº§ä¸­åå°åœºæ™¯çš„å¾®æœåŠ¡å¼€å‘æ¡†æ¶ï¼ŒåŸºäº Go è¯­è¨€ç”Ÿæ€ï¼ˆä¾æ‰˜ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgo-kratos.dev%2F" target="_blank" title="https://go-kratos.dev/" ref="nofollow noopener noreferrer">go-kratos</a> å¾®æœåŠ¡æ¡†æ¶ï¼‰æ‰“é€ ï¼Œæ•´åˆäº†å‰åç«¯å¼€å‘æ‰€éœ€çš„æ ¸å¿ƒå·¥å…·é“¾ã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºã€Œ<strong>ä¸€é”®ç”Ÿæˆ</strong>ã€ä¸ã€Œ<strong>é«˜åº¦å¯é…ç½®</strong>ã€ï¼šé€šè¿‡ <code>gow</code> å‘½ä»¤è¡Œå·¥å…·ï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿåˆå§‹åŒ–é¡¹ç›®ã€åˆ›å»ºå¾®æœåŠ¡ã€ç”Ÿæˆæ¥å£ä¸æ•°æ®å±‚ä»£ç ï¼Œæ— éœ€ä»é›¶æ­å»ºæ¶æ„ï¼Œæå¤§ç¼©çŸ­å¼€å‘å‘¨æœŸã€‚</p>
<h3 data-id="heading-2">æ ¸å¿ƒç‰¹æ€§ï¼šä¸ºä»€ä¹ˆé€‰æ‹© GoWind Adminï¼Ÿ</h3>
<h4 data-id="heading-3">1. å¼€ç®±å³ç”¨ï¼Œé›¶é…ç½®å¯åŠ¨</h4>
<p>GoWind Admin æä¾›äº†å®Œæ•´çš„é¡¹ç›®è„šæ‰‹æ¶ï¼ŒåŒ…å«é¢„è®¾çš„ç›®å½•ç»“æ„ã€é…ç½®æ–‡ä»¶ã€ä¾èµ–ç®¡ç†ç­‰ã€‚é€šè¿‡ gow å·¥å…·ï¼Œä¸€è¡Œå‘½ä»¤å³å¯ç”Ÿæˆå¯è¿è¡Œçš„é¡¹ç›®éª¨æ¶ï¼Œçœå»ç¹ççš„åˆå§‹åŒ–å·¥ä½œï¼š</p>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">å®‰è£… CLI å·¥å…·</span>
go install github.com/tx7do/kratos-cli/gowind/cmd/gow@latest
<span class="hljs-meta prompt_">
# </span><span class="bash">åˆå§‹åŒ–é¡¹ç›®ï¼ˆæ”¯æŒè‡ªå®šä¹‰æ¨¡å—åï¼‰</span>
gow new myproject -m github.com/yourusername/myproject
cd myproject
go mod tidy  # è‡ªåŠ¨å¤„ç†ä¾èµ–
</code></pre>
<p>ç”Ÿæˆçš„é¡¹ç›®åŒ…å«é»˜è®¤é…ç½®ï¼ˆæ•°æ®åº“ã€æ—¥å¿—ã€æœåŠ¡ç«¯å£ç­‰ï¼‰ï¼Œå¼€å‘è€…å¯ç›´æ¥åŸºäºæ­¤å¼€å‘ï¼Œæ— éœ€å…³æ³¨åº•å±‚æ¶æ„ç»†èŠ‚ã€‚</p>
<h4 data-id="heading-4">2. å¤šæœåŠ¡ç±»å‹æ”¯æŒï¼Œé€‚é…å¤æ‚ä¸šåŠ¡åœºæ™¯</h4>
<p>ä¼ä¸šçº§åº”ç”¨å¾€å¾€éœ€è¦å¤šç§æœåŠ¡ç±»å‹ååŒï¼ˆå¦‚ API æœåŠ¡ã€RPC æœåŠ¡ã€æ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡ç­‰ï¼‰ã€‚GoWind Admin æ”¯æŒé€šè¿‡å‘½ä»¤è¡Œå¿«é€Ÿåˆ›å»ºä¸åŒç±»å‹çš„å¾®æœåŠ¡ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå¯¹åº”ä»£ç ï¼š</p>
<ul>
<li><strong>å¤šåè®®æ”¯æŒ</strong>ï¼šå¯åˆ›å»º gRPCã€REST æœåŠ¡ï¼Œæˆ–åŒæ—¶é›†æˆä¸¤ç§åè®®ï¼ˆå¦‚ <code>gow add service admin -s rest -s grpc</code>ï¼‰ï¼›</li>
<li><strong>å¤šæ•°æ®å±‚é€‚é…</strong>ï¼šæ”¯æŒ gormã€entã€redis ç­‰ä¸»æµ ORM / æ•°æ®å®¢æˆ·ç«¯ï¼Œç”Ÿæˆå¯¹åº”çš„æ•°æ®è®¿é—®å±‚ä»£ç ï¼ˆå¦‚ <code>gow add service payment -d gorm -d redis</code>ï¼‰ï¼›</li>
<li><strong>æœåŠ¡æ³¨å†Œä¸å‘ç°</strong>ï¼šå†…ç½®å¾®æœåŠ¡ååŒæ‰€éœ€çš„é…ç½®ï¼Œæ”¯æŒæœåŠ¡é—´è°ƒç”¨çš„æ ‡å‡†åŒ–å¤„ç†ã€‚</li>
</ul>
<h4 data-id="heading-5">3. è‡ªåŠ¨åŒ–ä»£ç ç”Ÿæˆï¼Œå‡å°‘é‡å¤åŠ³åŠ¨</h4>
<p>GoWind Admin çš„æ ¸å¿ƒèƒ½åŠ›ä¹‹ä¸€æ˜¯ã€Œä»£ç ç”Ÿæˆã€ï¼Œé€šè¿‡ <code>gow</code> å·¥å…·å¯è‡ªåŠ¨ç”Ÿæˆé¡¹ç›®å„å±‚ä»£ç ï¼Œè¦†ç›–ä»æ¥å£å®šä¹‰åˆ°æ•°æ®è®¿é—®çš„å…¨æµç¨‹ï¼š</p>
<ul>
<li><strong>æœåŠ¡å±‚ä»£ç </strong>ï¼šç”Ÿæˆ gRPC/REST æœåŠ¡çš„è·¯ç”±ã€æ§åˆ¶å™¨ä»£ç ï¼›</li>
<li><strong>æ•°æ®å±‚ä»£ç </strong>ï¼šæ ¹æ®é€‰æ‹©çš„ ORM ç±»å‹ï¼ˆå¦‚ gormï¼‰ç”Ÿæˆæ•°æ®åº“è¿æ¥ã€æ¨¡å‹å®šä¹‰ä»£ç ï¼›</li>
<li><strong>é…ç½®æ–‡ä»¶</strong>ï¼šè‡ªåŠ¨ç”Ÿæˆ server.yamlã€data.yaml ç­‰é…ç½®æ¨¡æ¿ï¼ŒåŒ…å«æ•°æ®åº“ã€æ—¥å¿—ã€å®¢æˆ·ç«¯ç­‰é»˜è®¤é…ç½®ï¼›</li>
<li><strong>æ„å»ºè„šæœ¬</strong>ï¼šç”Ÿæˆ Makefileï¼Œæ”¯æŒä¸€é”®ç¼–è¯‘ã€è¿è¡Œã€éƒ¨ç½²ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œæ·»åŠ ä¸€ä¸ªæ”¯æŒ gRPC å’Œ gorm çš„ã€Œè®¢å•æœåŠ¡ã€ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">gow add service order -s grpc -d gorm
go mod tidy  # è‡ªåŠ¨æ›´æ–°ä¾èµ–
</code></pre>
<p>å‘½ä»¤æ‰§è¡Œåï¼Œæ¡†æ¶ä¼šåœ¨ <code>app/order/service</code> ç›®å½•ä¸‹ç”Ÿæˆå®Œæ•´çš„æœåŠ¡ä»£ç ï¼ŒåŒ…æ‹¬ gRPC æ¥å£å®šä¹‰ã€æ•°æ®è®¿é—®å±‚ã€é…ç½®æ–‡ä»¶ç­‰ï¼Œå¼€å‘è€…å¯ç›´æ¥ç¼–å†™ä¸šåŠ¡é€»è¾‘ã€‚</p>
<h4 data-id="heading-6">4. æ— ç¼é›†æˆ kratos ç”Ÿæ€ï¼Œä¼ä¸šçº§èƒ½åŠ›å†…ç½®</h4>
<p>GoWind Admin åŸºäº kratos ç”Ÿæ€æ„å»ºï¼Œå¤©ç„¶ç»§æ‰¿å…¶ä¼ä¸šçº§ç‰¹æ€§ï¼š</p>
<ul>
<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šå†…ç½®æ—¥å¿—ã€ç›‘æ§ã€è¿½è¸ªèƒ½åŠ›ï¼Œæ”¯æŒä¸ Prometheusã€Grafana ç­‰å·¥å…·é›†æˆï¼›</li>
<li><strong>é«˜å¯ç”¨</strong>ï¼šæ”¯æŒæœåŠ¡ç†”æ–­ã€é™æµã€é‡è¯•ç­‰å®¹é”™æœºåˆ¶ï¼›</li>
<li><strong>æ‰©å±•æ€§</strong>ï¼šå¯ç»“åˆ kratos-cli å…¶ä»–å·¥å…·ï¼ˆå¦‚ <code>cfgexp</code> é…ç½®å¯¼å‡ºã€<code>sql2orm</code> æ•°æ®åº“æ¨¡å‹ç”Ÿæˆï¼‰ï¼Œå½¢æˆå®Œæ•´å¼€å‘é—­ç¯ã€‚</li>
</ul>
<h3 data-id="heading-7">å¿«é€Ÿä¸Šæ‰‹ï¼š3 æ­¥æ­å»ºä¸€ä¸ªå¾®æœåŠ¡åº”ç”¨</h3>
<h4 data-id="heading-8">æ­¥éª¤ 1ï¼šå®‰è£… CLI å·¥å…·</h4>
<pre><code class="hljs language-shell" lang="shell">go install github.com/tx7do/kratos-cli/gowind/cmd/gow@latest
</code></pre>
<h4 data-id="heading-9">æ­¥éª¤ 2ï¼šåˆ›å»ºé¡¹ç›®å¹¶æ·»åŠ æœåŠ¡</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">åˆ›å»ºé¡¹ç›®</span>
gow new wind-demo -m github.com/your-org/wind-demo
cd wind-demo
<span class="hljs-meta prompt_">
# </span><span class="bash">æ·»åŠ ç”¨æˆ·æœåŠ¡ï¼ˆæ”¯æŒ REST åè®®å’Œ gorm æ•°æ®åº“ï¼‰</span>
gow add service user -s rest -d gorm
go mod tidy

cd app/user/service
<span class="hljs-meta prompt_"># </span><span class="bash">ç”Ÿæˆwireä»£ç </span>
make wire
</code></pre>
<h4 data-id="heading-10">æ­¥éª¤ 3ï¼šè¿è¡ŒæœåŠ¡</h4>
<pre><code class="hljs language-shell" lang="shell"><span class="hljs-meta prompt_"># </span><span class="bash">è¿›å…¥ç”¨æˆ·æœåŠ¡ç›®å½•è¿è¡Œ</span>
cd app/user/service
gow run
<span class="hljs-meta prompt_">
# </span><span class="bash">æˆ–ç›´æ¥æŒ‡å®šæœåŠ¡åè¿è¡Œ</span>
gow run user
</code></pre>
<p>æœåŠ¡å¯åŠ¨åï¼Œå³å¯é€šè¿‡é»˜è®¤ç«¯å£ï¼ˆå¦‚ REST æœåŠ¡é»˜è®¤ 8080ï¼‰è®¿é—®æ¥å£ï¼Œæ¡†æ¶å·²è‡ªåŠ¨å¤„ç†å¥½è·¯ç”±ã€é…ç½®åŠ è½½ç­‰å·¥ä½œã€‚</p>
<h3 data-id="heading-11">é€‚ç”¨åœºæ™¯</h3>
<p>GoWind Admin å°¤å…¶é€‚åˆä»¥ä¸‹åœºæ™¯ï¼š</p>
<ul>
<li>ä¼ä¸šçº§ä¸­åå°ç³»ç»Ÿå¼€å‘ï¼ˆå¦‚ ERPã€CRMã€æ•°æ®å¹³å°ï¼‰ï¼›</li>
<li>å¾®æœåŠ¡æ¶æ„çš„å¿«é€Ÿè½åœ°ï¼ˆéœ€å¤šæœåŠ¡ååŒã€å¤šåè®®æ”¯æŒï¼‰ï¼›</li>
<li>å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼ˆè‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£ï¼Œé™ä½ååŒæˆæœ¬ï¼‰ï¼›</li>
<li>è¿½æ±‚å¼€å‘æ•ˆç‡çš„å›¢é˜Ÿï¼ˆå‡å°‘æ¶æ„æ­å»ºæ—¶é—´ï¼Œèšç„¦ä¸šåŠ¡é€»è¾‘ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-12">æ€»ç»“</h3>
<p>GoWind Admin ä»¥ã€Œ<strong>ç®€åŒ–å¾®æœåŠ¡å¼€å‘æµç¨‹</strong>ã€ä¸ºæ ¸å¿ƒï¼Œé€šè¿‡ <code>gow</code> CLI å·¥å…·å°†é¡¹ç›®åˆå§‹åŒ–ã€æœåŠ¡åˆ›å»ºã€ä»£ç ç”Ÿæˆç­‰æµç¨‹è‡ªåŠ¨åŒ–ï¼Œè®©å¼€å‘è€…æ— éœ€é‡å¤æ­å»ºæ¶æ„ï¼Œå¼€ç®±å³å¯ä¸“æ³¨ä¸šåŠ¡é€»è¾‘ã€‚æ— è®ºæ˜¯å°å‹å›¢é˜Ÿå¿«é€ŸéªŒè¯éœ€æ±‚ï¼Œè¿˜æ˜¯å¤§å‹ä¼ä¸šæ„å»ºå¤æ‚ä¸­åå°ç³»ç»Ÿï¼ŒGoWind Admin éƒ½èƒ½æ˜¾è‘—é™ä½å¼€å‘æˆæœ¬ï¼ŒåŠ é€Ÿé¡¹ç›®è½åœ°ã€‚</p>
<p>ç«‹å³å°è¯• <code>gow</code> å·¥å…·ï¼Œä½“éªŒã€Œé£è¡Œã€èˆ¬çš„å¼€å‘æ•ˆç‡å§ï¼</p>
<h3 data-id="heading-13">é¡¹ç›®ä»£ç </h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Ftx7do%2Fgo-wind-admin" target="_blank" title="https://gitee.com/tx7do/go-wind-admin" ref="nofollow noopener noreferrer">go-wind-admin Gitee</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftx7do%2Fgo-wind-admin" target="_blank" title="https://github.com/tx7do/go-wind-admin" ref="nofollow noopener noreferrer">go-wind-admin Github</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°†ç›¸å’Œï¼šä¸€åœºæˆ˜å›½æ—¶æœŸçš„èŒåœºç”Ÿå­˜æ™ºæ…§]]></title>    <link>https://juejin.cn/post/7583215836689694761</link>    <guid>https://juejin.cn/post/7583215836689694761</guid>    <pubDate>2025-12-14T06:26:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583215836689694761" data-draft-id="7582958136257773604" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°†ç›¸å’Œï¼šä¸€åœºæˆ˜å›½æ—¶æœŸçš„èŒåœºç”Ÿå­˜æ™ºæ…§"/> <meta itemprop="keywords" content="ç¬”è®°"/> <meta itemprop="datePublished" content="2025-12-14T06:26:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™†ä¸šèª"/> <meta itemprop="url" content="https://juejin.cn/user/13629904404157"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°†ç›¸å’Œï¼šä¸€åœºæˆ˜å›½æ—¶æœŸçš„èŒåœºç”Ÿå­˜æ™ºæ…§
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/13629904404157/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™†ä¸šèª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:26:04.000Z" title="Sun Dec 14 2025 06:26:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å°†ç›¸å’Œçš„èƒŒåï¼Œæ˜¯èµµå›½é«˜å±‚çš„æƒåŠ›åšå¼ˆ</p>
</blockquote>
<p>åœ¨æˆ˜å›½ä¸ƒé›„ä¸­ï¼Œèµµå›½å‡­å€Ÿèµµæ­¦çµç‹â€œèƒ¡æœéª‘å°„â€æ”¹é©å¥ å®šçš„å†›äº‹åŸºç¡€ï¼Œæˆä¸ºä»…æ¬¡äºç§¦å›½çš„ç¬¬äºŒå¼ºå›½ã€‚è¿™ä¸€æ—¶æœŸï¼Œèµµå›½æ¶Œç°å‡ºä¸¤ä½æ°å‡ºäººç‰©â€”â€”<strong>å»‰é¢‡ä¸è”ºç›¸å¦‚</strong>ï¼Œä»–ä»¬ä¹‹é—´çš„â€œå°†ç›¸å’Œâ€æ•…äº‹è¢«è½½å…¥å²å†Œï¼Œæµä¼ åƒå¤ã€‚</p>
<p>å°å­¦å’Œä¸­å­¦è¯¾æœ¬å‘æˆ‘ä»¬è®²è¿°äº†ä¸€ä¸ªå…³äºå®½å®¹ä¸çˆ±å›½çš„æ•…äº‹ï¼Œä½†å½“æˆ‘ä»¬æ·±å…¥æŒ–æ˜è¿™æ®µå†å²ï¼Œä¼šå‘ç°å…¶ä¸­è•´å«ç€æ›´ä¸ºå¤æ‚çš„èŒåœºå…³ç³»ã€æƒåŠ›åšå¼ˆå’Œæˆ˜ç•¥è€ƒé‡ã€‚å»‰é¢‡ä»åº•å±‚ä¸€æ­¥æ­¥æ™‹å‡ä¸ºå°†å†›ï¼Œè”ºç›¸å¦‚åˆ™å‡­å€Ÿå‡ºè‰²çš„å¤–äº¤èƒ½åŠ›è¿…é€Ÿè·å¾—é«˜ä½ï¼Œè¿™ç§å·®å¼‚æ³¨å®šä¼šåœ¨èµµå›½æœå ‚æ¿€èµ·æ³¢æ¾œã€‚</p>
<h2 data-id="heading-0">å°†ç›¸å’Œçš„å†å²èƒŒæ™¯</h2>
<p>å…¬å…ƒå‰279å¹´ï¼Œç§¦æ˜­è¥„ç‹æ„å›¾æŸ“æŒ‡èµµå›½çš„å›½å®â€œå’Œæ°ç’§â€ï¼Œå‡æ„æå‡ºä»¥åäº”åº§åŸæ± äº¤æ¢ã€‚èµµæƒ æ–‡ç‹é¢ä¸´ä¸¤éš¾æŠ‰æ‹©ï¼šä¸ç»™ç’§ï¼Œæç§¦æ”»èµµï¼›ç»™ç’§ï¼Œåˆæç§¦è¿çº¦ã€‚åœ¨è¿™ä¸€èƒŒæ™¯ä¸‹ï¼Œè”ºç›¸å¦‚ä¸´å±å—å‘½ï¼Œæºç’§å…¥ç§¦ã€‚</p>
<p>åœ¨ç§¦å»·ä¸Šï¼Œè”ºç›¸å¦‚æœºæ™ºåº”å¯¹ï¼Œ<strong>è¯†ç ´ç§¦å›½éª—å±€</strong>ï¼Œæœ€ç»ˆâ€œå®Œç’§å½’èµµâ€ã€‚æ­¤åï¼Œåœ¨æ¸‘æ± ä¹‹ä¼šä¸Šï¼Œé¢å¯¹ç§¦ç‹çš„ç¾è¾±ï¼Œè”ºç›¸å¦‚å†æ¬¡æŒºèº«è€Œå‡ºï¼Œ<strong>ç»´æŠ¤äº†èµµå›½å°Šä¸¥</strong>ã€‚èµµæƒ æ–‡ç‹å› æ­¤é‡èµè”ºç›¸å¦‚ï¼Œå°ä»–ä¸ºä¸Šå¿ï¼Œä½åœ¨å»‰é¢‡ä¹‹ä¸Šã€‚</p>
<p>è¿™ä¸€ä»»å‘½å¼•å‘å»‰é¢‡å¼ºçƒˆä¸æ»¡ã€‚ä»–å…¬å¼€æ‰¬è¨€ï¼šâ€œæˆ‘ä¸ºèµµå°†ï¼Œæœ‰æ”»åŸé‡æˆ˜ä¹‹åŠŸã€‚è”ºç›¸å¦‚ç´ è´±äººï¼Œå¾’ä»¥å£èˆŒè€Œä½å±…æˆ‘ä¸Šã€‚å¾ç¾ï¼Œä¸å¿ä¸ºä¹‹ä¸‹ï¼â€å¹¶å®£ç§°è§åˆ°è”ºç›¸å¦‚å®šè¦ç¾è¾±ä»–ã€‚</p>
<h2 data-id="heading-1">å°†ç›¸ä¸å’ŒèƒŒåçš„æ·±å±‚åŸå› </h2>
<p><strong>å»‰é¢‡çš„æ„¤æ€’å¹¶éç®€å•çš„ä¸ªäººæƒ…ç»ª</strong>ï¼Œè€Œæ˜¯åæ˜ äº†æˆ˜å›½æ—¶æœŸä¸¤ç§ä¸åŒä»·å€¼ä½“ç³»çš„å†²çªã€‚</p>
<p>å»‰é¢‡æ˜¯ä»æˆ˜åœºä¸Šä¸€åˆ€ä¸€æªæ‹¼æ€å‡ºæ¥çš„å°†é¢†ï¼Œä»–çš„æ™‹å‡ä¾é çš„æ˜¯å®å®åœ¨åœ¨çš„å†›åŠŸã€‚è€Œåœ¨èµµæ­¦çµç‹æ”¹é©åï¼Œèµµå›½ç¡®å®å»ºç«‹äº†ä¸€å¥—ä»¥å†›åŠŸä¸ºæ ¸å¿ƒçš„æ™‹å‡ä½“ç³»ã€‚å»‰é¢‡å†ç»å¤šå¹´å¥‹æˆ˜æ‰è¾¾åˆ°é«˜ä½ï¼Œè‡ªç„¶éš¾ä»¥æ¥å—è”ºç›¸å¦‚å‡­å€Ÿâ€œå£èˆŒä¹‹åŠ³â€è¿…é€Ÿè¶…è¶Šè‡ªå·±ã€‚</p>
<p>è”ºç›¸å¦‚çš„å‡ºèº«ä¹ŸåŠ å‰§äº†è¿™ç§çŸ›ç›¾ã€‚ä»–åŸæœ¬æ˜¯å®¦å®˜ç¼ªè´¤çš„é—¨å®¢ï¼Œç›¸å½“äºâ€œé¢†å¯¼ç§˜ä¹¦çš„åŠ©ç†â€ï¼Œåœ¨é‡è§†å‡ºèº«èƒŒæ™¯çš„æˆ˜å›½æ—¶æœŸï¼Œè¿™ç§èº«ä»½å¸¸è¢«ä¸–è¢­è´µæ—çœ‹ä¸èµ·ã€‚å»‰é¢‡ä½œä¸ºå†›ä¸­è€å°†ï¼Œéš¾å…å¯¹è¿™ä½â€œé å…³ç³»ä¸Šä½â€çš„æ–°è´µå¿ƒå­˜è½»è”‘ã€‚</p>
<p>æ›´æ·±å±‚æ¬¡çœ‹ï¼Œå°†ç›¸ä¸å’Œåæ˜ äº†èµµå›½æœå ‚ä¸¤å¤§è·¯çº¿çš„åˆ†æ­§ã€‚å»‰é¢‡æ˜¯<strong>è°¨æ…çš„â€œè”ç§¦æ´¾â€</strong>ï¼Œåœ¨é•¿å¹³ä¹‹æˆ˜åˆæœŸé‡‡å–å®ˆåŠ¿ï¼Œé¿å…ä¸ç§¦å›½å½»åº•æ’•ç ´è„¸ï¼›è€Œè”ºç›¸å¦‚åˆ™æ˜¯<strong>åšå®šçš„â€œæŠ—ç§¦æ´¾â€</strong>ï¼Œè¿™ä»ä»–â€œå®Œç’§å½’èµµâ€ä¸­æ•¢äºç›´æ¥å¯¹æŠ—ç§¦ç‹çš„æ€åº¦å¯è§ä¸€æ–‘ã€‚</p>
<h2 data-id="heading-2">èµµç‹çš„å¹³è¡¡ä¹‹æœ¯</h2>
<p>é¢å¯¹å°†ç›¸çŸ›ç›¾ï¼Œèµµæƒ æ–‡ç‹çš„æ€åº¦é¢‡ä¸ºå¾®å¦™ã€‚ä»–å¹¶æ²¡æœ‰å¼ºè¡Œè°ƒè§£ï¼Œè€Œæ˜¯å…è®¸è¿™ç§ tension å­˜åœ¨ã€‚ä»ç°ä»£ç®¡ç†å­¦çš„è§’åº¦çœ‹ï¼Œè¿™å¾ˆå¯èƒ½æ˜¯ä¸€ç§<strong>ç²¾å¿ƒè®¾è®¡çš„æƒåŠ›å¹³è¡¡æœ¯</strong>ã€‚</p>
<p>ä½œä¸ºæœ€é«˜é¢†å¯¼è€…ï¼Œèµµç‹éœ€è¦å¹³è¡¡æœå»·å†…çš„ä¸åŒåŠ¿åŠ›ã€‚è”ç§¦æ´¾å¤ªå¼ºï¼Œä¼šå¾—ç½ªå…¶ä»–å…­å›½ï¼›æŠ—ç§¦æ´¾å¤ªå¼ºï¼Œåˆå¯èƒ½è¿‡æ—©å¼•å‘ä¸ç§¦å›½çš„å…¨é¢å†²çªã€‚æ˜æ™ºçš„å›ä¸»ä¸ä¼šè®©ä»»ä½•ä¸€æ–¹ç‹¬å¤§ï¼Œè€Œæ˜¯è®©ä»–ä»¬ç›¸äº’åˆ¶çº¦ï¼Œæ ¹æ®å›½å®¶éœ€è¦é€‚æ—¶å¯ç”¨ä¸åŒæ´¾åˆ«ã€‚</p>
<p>è¿™ç§å¹³è¡¡ç­–ç•¥åœ¨å…·ä½“äº‹åŠ¡ä¸­å¾—åˆ°ä½“ç°ï¼šéœ€è¦å‘é½å›½å€Ÿå…µæ—¶ï¼Œèµµç‹æ´¾è”ºç›¸å¦‚å‡ºé©¬ï¼Œå› ä¸ºäº”å¹´å‰è”ºç›¸å¦‚æ›¾ä¸»åŠ¨ä¸é½å’Œè§£ï¼›è€Œé•¿å¹³ä¹‹æˆ˜åˆæœŸï¼Œåˆ™æ´¾å»‰é¢‡æŒ‚å¸…ï¼Œç”±è”ç§¦æ´¾æŒ‡æŒ¥è¿™åœºâ€œä¸æƒ³çœŸæ‰“â€çš„æˆ˜äº‰ã€‚</p>
<p>èµµç‹çš„åšæ³•ä¹Ÿåæ˜ äº†æˆ˜å›½æ—¶æœŸçš„äººæ‰é€‰æ‹”å›°å¢ƒã€‚å½“æ—¶èµµå›½å¹¶æ²¡æœ‰åƒç§¦å›½å•†é…å˜æ³•é‚£æ ·å»ºç«‹ä¸¥æ ¼çš„å†›åŠŸåˆ¶åº¦ï¼Œå¯¼è‡´å¯¹â€œåŠŸç»©â€çš„è¯„ä»·æ ‡å‡†ä¸ä¸€ã€‚è”ºç›¸å¦‚å‡­å€Ÿå¤–äº¤æˆå°±è·å¾—ç ´æ ¼ææ‹”ï¼Œè™½ç„¶åˆç†ï¼Œå´<strong>æ‰“ç ´äº†åŸæœ‰çš„æ™‹å‡æƒ¯ä¾‹</strong>ï¼Œå¼•å‘å†›æ–¹ä¸æ»¡ã€‚</p>
<h2 data-id="heading-3">è”ºç›¸å¦‚çš„èŒåœºæ™ºæ…§</h2>
<p>é¢å¯¹å»‰é¢‡çš„å…¬å¼€æŒ‘è¡…ï¼Œè”ºç›¸å¦‚é€‰æ‹©äº†å‡ºäººæ„æ–™çš„åº”å¯¹ç­–ç•¥â€”â€”<strong>é¿è®©</strong>ã€‚ä»–ç§°ç—…ä¸æœï¼Œé¿å…ä¸å»‰é¢‡äº‰ä½æ¬¡ï¼›å¤–å‡ºæ—¶ï¼Œè¿œè¿œçœ‹è§å»‰é¢‡çš„è½¦é˜Ÿä¾¿ç»•é“è€Œè¡Œã€‚</p>
<p>è¿™ä¸€åšæ³•è¿è”ºç›¸å¦‚çš„é—¨å®¢éƒ½æ„Ÿåˆ°è€»è¾±ï¼Œä»–ä»¬è´¨ç–‘é“ï¼šâ€œè‡£æ‰€ä»¥å»äº²æˆšè€Œäº‹å›è€…ï¼Œå¾’æ…•å›ä¹‹é«˜ä¹‰ä¹Ÿã€‚ä»Šå›ä¸å»‰é¢‡åŒåˆ—ï¼Œå»‰å›å®£æ¶è¨€ï¼Œè€Œå›ç•åŒ¿ä¹‹ï¼Œææƒ§æ®Šç”šã€‚ä¸”åº¸äººå°šç¾ä¹‹ï¼Œå†µäºå°†ç›¸ä¹ï¼â€</p>
<p>è”ºç›¸å¦‚çš„å›ç­”æ­ç¤ºäº†ä»–çš„æ·±è°‹è¿œè™‘ï¼šâ€œå¤«ä»¥ç§¦ç‹ä¹‹å¨ï¼Œè€Œç›¸å¦‚å»·å±ä¹‹ï¼Œè¾±å…¶ç¾¤è‡£ã€‚ç›¸å¦‚è™½é©½ï¼Œç‹¬ç•å»‰å°†å†›å“‰ï¼Ÿé¡¾å¾å¿µä¹‹ï¼Œå¼ºç§¦ä¹‹æ‰€ä»¥ä¸æ•¢åŠ å…µäºèµµè€…ï¼Œå¾’ä»¥å¾ä¸¤äººåœ¨ä¹Ÿã€‚ä»Šä¸¤è™å…±æ–—ï¼Œå…¶åŠ¿ä¸ä¿±ç”Ÿã€‚å¾æ‰€ä»¥ä¸ºæ­¤è€…ï¼Œ<strong>å…ˆå›½å®¶ä¹‹æ€¥è€Œåç§ä»‡</strong>ä¹Ÿã€‚â€</p>
<p>è¿™ç•ªè¯ä½“ç°äº†è”ºç›¸å¦‚çš„é«˜è¶…èŒåœºæ™ºæ…§ï¼šä»–çœ‹æ¸…äº†è‡ªå·±ä¸å»‰é¢‡å…¶å®æ˜¯â€œ<strong>åˆ©ç›Šå…±åŒä½“</strong>â€â€”â€”éƒ½æ˜¯èƒ½åŠ›å‡ºä¼—ä½†è¢«æ’é™¤åœ¨èµµå›½æ ¸å¿ƒæƒåŠ›åœˆå¤–çš„å®åŠ›æ´¾ã€‚ä¸å…¶å†…æ–—è®©ä¸–è¢­è´µæ—å¾—åˆ©ï¼Œä¸å¦‚è”æ‰‹åˆä½œã€‚</p>
<h2 data-id="heading-4">è´Ÿè†è¯·ç½ªï¼šå»‰é¢‡çš„è§‰æ‚Ÿä¸æ‹…å½“</h2>
<p>å½“å»‰é¢‡å¾—çŸ¥è”ºç›¸å¦‚çš„è‰¯è‹¦ç”¨å¿ƒåï¼Œä»–åšå‡ºäº†ä¸€ä¸ªä»¤äººæƒŠå¹çš„ä¸¾åŠ¨â€”â€”<strong>è´Ÿè†è¯·ç½ª</strong>ã€‚ä»–è„±å»ä¸Šè¡£ï¼ŒèƒŒè´Ÿè†æ¡ï¼Œäº²è‡ªåˆ°è”ºç›¸å¦‚åºœä¸Šè°¢ç½ªï¼Œå¹¶è¡¨ç¤ºï¼šâ€œé„™è´±ä¹‹äººï¼Œä¸çŸ¥å°†å†›å®½ä¹‹è‡³æ­¤ä¹Ÿã€‚â€</p>
<p>è¿™ä¸€è¡Œä¸ºéœ€è¦æå¤§çš„å‹‡æ°”å’Œ humilityã€‚ä½œä¸ºæˆ˜å›½å››å¤§åå°†ä¹‹ä¸€ï¼Œå»‰é¢‡åœ¨å†›ä¸­çš„åœ°ä½è‡³é«˜æ— ä¸Šï¼Œå´èƒ½å…¬å¼€è®¤é”™ï¼Œä½“ç°äº†ä»–ä»¥å›½å®¶åˆ©ç›Šä¸ºé‡çš„æ‹…å½“ç²¾ç¥ã€‚ä¹Ÿä»ä¾§é¢åæ˜ äº†ä»–å¯¹å±€åŠ¿çš„æ¸…é†’è®¤è¯†â€”â€”ä¸¤äººåˆä½œç¬¦åˆå½¼æ­¤çš„é•¿è¿œåˆ©ç›Šã€‚</p>
<p>å°†ç›¸å’Œå¥½åçš„èµµå›½ï¼Œå®åŠ›å¤§å¢ã€‚å¸é©¬è¿åœ¨ã€Šå²è®°ã€‹ä¸­è®°è½½ï¼šâ€œå»‰é¢‡ã€è”ºç›¸å¦‚ç›¸ä¸æ¬¢æ‚¦ï¼Œä¸ºåˆé¢ˆä¹‹äº¤ã€‚â€è¿™ç§<strong>æ–‡æ­¦å’Œè°çš„å±€é¢</strong>ï¼Œä½¿ç§¦å›½åœ¨ä¸€æ®µæ—¶é—´å†…ä¸æ•¢è½»æ˜“ä¾µçŠ¯èµµå›½ã€‚</p>
<h2 data-id="heading-5">å°†ç›¸å’Œæ•…äº‹çš„èŒåœºå¯ç¤º</h2>
<p>å°†ç›¸å’Œçš„æ•…äº‹è™½å‘ç”Ÿåœ¨ä¸¤åƒå¤šå¹´å‰ï¼Œä½†å¯¹ç°ä»£èŒåœºä»æœ‰æ·±åˆ»å¯ç¤ºï¼š</p>
<p><strong>1. å¤§å±€è§‚æ˜¯èŒåœºæˆåŠŸçš„å…³é”®</strong></p>
<p>è”ºç›¸å¦‚èƒ½å¤Ÿè¶…è¶Šä¸ªäººè£è¾±ï¼Œä»¥å›½å®¶åˆ©ç›Šä¸ºé‡ï¼Œè¿™ç§å¤§å±€è§‚ä½¿ä»–èµ¢å¾—äº†åŒ…æ‹¬å¯¹æ‰‹åœ¨å†…çš„å¹¿æ³›å°Šé‡ã€‚åœ¨èŒåœºä¸­ï¼Œè¿‡äºè®¡è¾ƒä¸ªäººå¾—å¤±å¾€å¾€ä¼šå¯¼è‡´è§†é‡ç‹­çª„ï¼Œå½±å“åˆ¤æ–­åŠ›å’Œé•¿è¿œå‘å±•ã€‚</p>
<p><strong>2. ä¸åŒä¸“ä¸šèƒŒæ™¯çš„äººæ‰éœ€è¦ç›¸äº’å°Šé‡</strong></p>
<p>å»‰é¢‡æœ€åˆè½»è§†è”ºç›¸å¦‚çš„â€œå£èˆŒä¹‹åŠ³â€ï¼Œåæ˜ äº†èŒåœºä¸­å¸¸è§çš„ç°è±¡â€”â€”ä¸åŒä¸“ä¸šèƒŒæ™¯çš„äººéš¾ä»¥ç†è§£å½¼æ­¤çš„ä»·å€¼ã€‚å®é™…ä¸Šï¼Œ<strong>å†›äº‹ç¡¬å®åŠ›ä¸å¤–äº¤è½¯å®åŠ›</strong>éƒ½æ˜¯å›½å®¶ç»¼åˆç«äº‰åŠ›çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå¦‚åŒç°ä»£ä¼ä¸šä¸­çš„æŠ€æœ¯ç ”å‘ä¸å¸‚åœºæ‹“å±•ä¸€æ ·ï¼Œç¼ºä¸€ä¸å¯ã€‚</p>
<p><strong>3. é¢†å¯¼è€…çš„å¹³è¡¡è‰ºæœ¯</strong></p>
<p>èµµç‹å¯¹å°†ç›¸çŸ›ç›¾çš„å¤„ç†ï¼Œå±•ç°äº†é«˜è¶…çš„é¢†å¯¼è‰ºæœ¯ã€‚ä¼˜ç§€çš„ç®¡ç†è€…ä¸æ˜¯æ¶ˆé™¤æ‰€æœ‰çŸ›ç›¾ï¼Œè€Œæ˜¯<strong>å¹³è¡¡ä¸åŒåŠ›é‡å’Œè§‚ç‚¹</strong>ï¼Œä½¿å®ƒä»¬å½¢æˆè‰¯æ€§ç«äº‰è€Œéæ¶æ€§å†…è€—ã€‚</p>
<p><strong>4. åˆä½œå…±èµ¢æ˜¯èŒåœºå‘å±•çš„æœ€ä½³è·¯å¾„</strong></p>
<p>å»‰é¢‡å’Œè”ºç›¸å¦‚æœ€ç»ˆæ„è¯†åˆ°ï¼Œåˆä½œæ¯”å¯¹æŠ—å¯¹å½¼æ­¤æ›´æœ‰åˆ©ã€‚åœ¨èŒåœºä¸­ï¼Œå»ºè®¾æ€§åˆä½œå¾€å¾€èƒ½åˆ›é€ â€œ1+1&gt;2â€çš„æ•ˆåº”ã€‚æ­£å¦‚ç°ä»£ä¼ä¸šä¸­çš„è·¨éƒ¨é—¨åˆä½œï¼Œèƒ½å¤Ÿæ•´åˆèµ„æºï¼Œå®ç°å„æ–¹å…±èµ¢ã€‚</p>
<h2 data-id="heading-6">ç»“å±€ä¸åæ€</h2>
<p>é—æ†¾çš„æ˜¯ï¼Œå°†ç›¸å’Œçš„è‰¯å¥½å±€é¢æœªèƒ½æŒç»­ã€‚è”ºç›¸å¦‚ç—…é€åï¼Œå¹³è¡¡è¢«æ‰“ç ´ã€‚åœ¨é•¿å¹³ä¹‹æˆ˜ä¸­ï¼Œèµµç‹ä¸´é˜µæ¢å°†ï¼Œç”¨çº¸ä¸Šè°ˆå…µçš„èµµæ‹¬æ›¿ä»£å»‰é¢‡ï¼Œå¯¼è‡´èµµå›½æƒ¨è´¥ï¼Œå››åä¸‡å°†å£«è¢«å‘æ€ã€‚</p>
<p>è¿™ä¸€ç»“å±€ä»åé¢è¯æ˜äº†ä¸€ä¸ªé“ç†ï¼š<strong>å†å¼ºå¤§çš„ç»„ç»‡ï¼Œå¦‚æœå†…éƒ¨ä¸èƒ½å½¢æˆæœ‰æ•ˆçš„åˆ¶è¡¡ä¸åˆä½œï¼Œéƒ½éš¾é€ƒè¡°è´¥çš„å‘½è¿</strong>ã€‚å°†ç›¸å’Œçš„æ•…äº‹ä¸ä»…æ˜¯ä¸€æ®µå†å²ä½³è¯ï¼Œæ›´æ˜¯ä¸€é¢é•œå­ï¼Œè®©æˆ‘ä»¬çœ‹åˆ°åˆä½œä¸å®½å®¹çš„åŠ›é‡ï¼Œä»¥åŠå›¢é˜Ÿåä½œçš„ä»·å€¼ã€‚</p>
<p>åœ¨ç°ä»£èŒåœºä¸­ï¼Œæˆ‘ä»¬æ¯ä¸ªäººéƒ½ä¼šé‡åˆ°ç±»ä¼¼å»‰é¢‡ä¸è”ºç›¸å¦‚çš„å¤„å¢ƒã€‚æ— è®ºæ˜¯ä½œä¸ºå›¢é˜Ÿæˆå‘˜è¿˜æ˜¯ç®¡ç†è€…ï¼Œä»è¿™ä¸€å†å²æ•…äº‹ä¸­æ±²å–æ™ºæ…§ï¼Œéƒ½èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£å†³ç­–ã€å¤„ç†å…³ç³»ï¼Œæœ€ç»ˆåœ¨èŒåœºä¸­å®ç°ä¸ªäººä¸é›†ä½“çš„å…±åŒå‘å±•ã€‚</p>
<p>æ­£å¦‚å¸é©¬è¿æ‰€è¨€ï¼šâ€œ<strong>å…ˆå›½å®¶ä¹‹æ€¥è€Œåç§ä»‡</strong>â€ï¼Œè¿™ç§è¶…è¶Šä¸ªäººåˆ©ç›Šçš„é«˜è¿œæ ¼å±€ï¼Œä¸ä»…æ˜¯å°†ç›¸å’Œæ•…äº‹çš„ç²¾é«“ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åœ¨å¤æ‚èŒåœºç¯å¢ƒä¸­ç«‹èº«å¤„ä¸–çš„æ ¹æœ¬å‡†åˆ™ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[3ã€Solr CCS ï¼ˆCross Collection Searchï¼‰ä¸åè°ƒèŠ‚ç‚¹ï¼ˆCoordinator Nodeï¼‰çš„ååŒå·¥ä½œé€»è¾‘åŠè‡ªå®šä¹‰å¼€å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7583168260796612648</link>    <guid>https://juejin.cn/post/7583168260796612648</guid>    <pubDate>2025-12-14T06:20:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583168260796612648" data-draft-id="7582844980400013352" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="3ã€Solr CCS ï¼ˆCross Collection Searchï¼‰ä¸åè°ƒèŠ‚ç‚¹ï¼ˆCoordinator Nodeï¼‰çš„ååŒå·¥ä½œé€»è¾‘åŠè‡ªå®šä¹‰å¼€å‘æŒ‡å—"/> <meta itemprop="keywords" content="Solr"/> <meta itemprop="datePublished" content="2025-12-14T06:20:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="liyanchao2018"/> <meta itemprop="url" content="https://juejin.cn/user/289926802318599"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            3ã€Solr CCS ï¼ˆCross Collection Searchï¼‰ä¸åè°ƒèŠ‚ç‚¹ï¼ˆCoordinator Nodeï¼‰çš„ååŒå·¥ä½œé€»è¾‘åŠè‡ªå®šä¹‰å¼€å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/289926802318599/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    liyanchao2018
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:20:15.000Z" title="Sun Dec 14 2025 06:20:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><ul>
<li>Solr CCS ï¼ˆCross Collection Searchï¼‰ä¸åè°ƒèŠ‚ç‚¹ï¼ˆCoordinator Nodeï¼‰çš„ååŒå·¥ä½œé€»è¾‘åŠè‡ªå®šä¹‰å¼€å‘æŒ‡å—</li>
</ul>
<blockquote>
<p>Solr è·¨é›†åˆæŸ¥è¯¢ï¼ˆCCSï¼‰çš„æ ¸å¿ƒæ˜¯<strong>ä»¥åè°ƒèŠ‚ç‚¹ï¼ˆCoordinator Nodeï¼‰ä¸ºæ ¸å¿ƒå¼•æ“</strong>ï¼Œå°†è·¨é›†åˆ / åˆ†ç‰‡çš„æŸ¥è¯¢æ‹†è§£ã€å¹¶è¡Œæ‰§è¡Œã€æ±‡æ€»ç»“æœï¼ŒCCS æ˜¯æŸ¥è¯¢èƒ½åŠ›çš„æŠ½è±¡ï¼Œåè°ƒèŠ‚ç‚¹æ˜¯è¯¥èƒ½åŠ›çš„ç‰©ç†æ‰§è¡Œè½½ä½“ã€‚ä»¥ä¸‹ä»ã€ŒååŒè¿è¡Œé€»è¾‘ã€ã€Œåè°ƒèŠ‚ç‚¹æ±‡æ€»ç»Ÿè®¡çš„åº•å±‚æœºåˆ¶ã€ã€Œè‡ªå®šä¹‰ç»Ÿè®¡ / æ’åºé€»è¾‘å¼€å‘ã€ä¸‰ä¸ªç»´åº¦å®Œæ•´è§£ç­”ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€CCS ä¸åè°ƒèŠ‚ç‚¹çš„æ ¸å¿ƒå…³ç³»</h2>
<ul>
<li><strong>CCS</strong>ï¼šæ˜¯ Solr å®šä¹‰çš„ã€Œè·¨å¤šä¸ªé›†åˆ / æ ¸å¿ƒæŸ¥è¯¢å¹¶è¿”å›ç»Ÿä¸€ç»“æœã€çš„èƒ½åŠ›è§„èŒƒï¼Œå®šä¹‰äº†æŸ¥è¯¢è¯­æ³•ã€å‚æ•°è§„åˆ™ã€ç»“æœåˆå¹¶çš„è¯­ä¹‰ã€‚</li>
<li><strong>åè°ƒèŠ‚ç‚¹</strong>ï¼šæ˜¯ SolrCloud é›†ç¾¤ä¸­æ‰¿æ¥å®¢æˆ·ç«¯æŸ¥è¯¢è¯·æ±‚çš„èŠ‚ç‚¹ï¼ˆä»»æ„èŠ‚ç‚¹å‡å¯ä½œä¸ºåè°ƒèŠ‚ç‚¹ï¼Œé»˜è®¤ç”±é›†ç¾¤è·¯ç”±è§„åˆ™åˆ†é…ï¼‰ï¼Œæ˜¯ CCS é€»è¾‘çš„<strong>å”¯ä¸€æ‰§è¡Œä¸»ä½“</strong>â€”â€” æ‰€æœ‰ CCS çš„æ‹†åˆ†ã€å¹¶è¡ŒæŸ¥è¯¢ã€ç»“æœæ±‡æ€»ã€æ’åºéƒ½åœ¨åè°ƒèŠ‚ç‚¹ä¸Šå®Œæˆï¼Œå…¶ä»–èŠ‚ç‚¹ä»…ä½œä¸ºã€Œåˆ†ç‰‡èŠ‚ç‚¹ã€æ‰§è¡Œå­æŸ¥è¯¢ã€‚</li>
</ul>
<p>ç®€å•æ¥è¯´ï¼š<strong>CCS æ˜¯ â€œåšä»€ä¹ˆâ€ï¼ˆè·¨é›†åˆæŸ¥è¯¢ï¼‰ï¼Œåè°ƒèŠ‚ç‚¹æ˜¯ â€œè°æ¥åšâ€ï¼ˆæ‰§è¡ŒæŸ¥è¯¢ + æ±‡æ€»ï¼‰</strong> ã€‚</p>
<h2 data-id="heading-1">äºŒã€CCS ä¸åè°ƒèŠ‚ç‚¹çš„ååŒè¿è¡Œé€»è¾‘</h2>
<p>ä»¥ä½ åœºæ™¯ï¼ˆæŸ¥è¯¢Â <code>family,big</code>Â é›†åˆï¼Œç»Ÿè®¡å­—æ®µï¼‰ä¸ºä¾‹ï¼Œå®Œæ•´è¿è¡Œæµç¨‹å¦‚ä¸‹ï¼ˆSolrCloud æ¨¡å¼ï¼‰ï¼š</p>
<h3 data-id="heading-2">æ­¥éª¤ 1ï¼šè¯·æ±‚æ¥æ”¶ä¸åè°ƒèŠ‚ç‚¹ç»‘å®š</h3>
<ol>
<li>å®¢æˆ·ç«¯ï¼ˆæ§åˆ¶å° / APIï¼‰å‘é€ CCS è¯·æ±‚ï¼š<code>http://&lt;solr-host&gt;:8983/solr/family,big/select?q=*:*&amp;stats=true&amp;stats.field=age</code>ï¼›</li>
<li>Solr é›†ç¾¤çš„è´Ÿè½½å‡è¡¡ / è·¯ç”±å±‚ï¼ˆæˆ– ZooKeeper è·¯ç”±è§„åˆ™ï¼‰å°†è¯·æ±‚åˆ†é…ç»™<strong>ä»»æ„èŠ‚ç‚¹</strong>ï¼ˆæ¯”å¦‚ Node1ï¼‰ï¼Œè¯¥èŠ‚ç‚¹å³ä¸ºã€Œåè°ƒèŠ‚ç‚¹ã€ï¼›</li>
<li>åè°ƒèŠ‚ç‚¹åˆå§‹åŒ–Â <code>ResponseBuilder</code>ï¼ˆæ ¸å¿ƒä¸Šä¸‹æ–‡å¯¹è±¡ï¼‰ï¼Œå­˜å‚¨æŸ¥è¯¢å‚æ•°ã€ç›®æ ‡é›†åˆã€ç»“æœå®¹å™¨ç­‰ä¿¡æ¯ã€‚</li>
</ol>
<h3 data-id="heading-3">æ­¥éª¤ 2ï¼šCCS é›†åˆè§£æä¸åˆ†ç‰‡æ‹“æ‰‘æ‹‰å–</h3>
<p>åè°ƒèŠ‚ç‚¹è§£æ CCS æ ¸å¿ƒå‚æ•°ï¼ˆ<code>collection=family,big</code>ï¼‰ï¼Œå®Œæˆã€Œé›†åˆâ†’åˆ†ç‰‡ã€çš„æ˜ å°„ï¼ˆä¾èµ– ZooKeeperï¼‰ï¼š</p>
<ol>
<li>è§£æÂ <code>family</code>Â é›†åˆï¼šä» ZooKeeper è·å–å…¶åˆ†ç‰‡æ‹“æ‰‘ï¼ˆå¦‚Â <code>family_shard1_replica1</code>ï¼ˆNode2ï¼‰ã€<code>family_shard2_replica1</code>ï¼ˆNode3ï¼‰ï¼‰ï¼›</li>
<li>è§£æÂ <code>big</code>Â é›†åˆï¼šä» ZooKeeper è·å–å…¶åˆ†ç‰‡æ‹“æ‰‘ï¼ˆå¦‚Â <code>big_shard1_replica1</code>ï¼ˆNode4ï¼‰ï¼‰ï¼›</li>
<li>ç”Ÿæˆã€Œå…¨éƒ¨åˆ†ç‰‡åˆ—è¡¨ã€ï¼š<code>[family_shard1, family_shard2, big_shard1]</code>ï¼Œå¹¶æ ‡è®°æ¯ä¸ªåˆ†ç‰‡çš„åœ°å€ã€å‰¯æœ¬ä¼˜å…ˆçº§ï¼ˆä¼˜å…ˆæŸ¥ä¸»å‰¯æœ¬ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-4">æ­¥éª¤ 3ï¼šåˆ†å¸ƒå¼æŸ¥è¯¢ä»»åŠ¡æ‹†åˆ†ï¼ˆCCS â†’ åˆ†ç‰‡çº§ä»»åŠ¡ï¼‰</h3>
<p>åè°ƒèŠ‚ç‚¹åŸºäºÂ <code>SearchHandler</code>Â ä¸­çš„Â <code>DistributedSearchComponent</code>ï¼ˆåˆ†å¸ƒå¼æŸ¥è¯¢æ ¸å¿ƒç»„ä»¶ï¼‰ï¼Œå°† CCS è¯·æ±‚æ‹†åˆ†ä¸ºã€Œåˆ†ç‰‡çº§å­æŸ¥è¯¢ä»»åŠ¡ã€ï¼š</p>
<ol>
<li>
<p>ä¸ºæ¯ä¸ªç›®æ ‡åˆ†ç‰‡ç”ŸæˆÂ <code>ShardRequest</code>ï¼ˆåˆ†ç‰‡è¯·æ±‚å¯¹è±¡ï¼‰ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>å­æŸ¥è¯¢å‚æ•°ï¼ˆå¤ç”¨åŸè¯·æ±‚çš„Â <code>q</code>ã€<code>stats</code>ã€<code>stats.field</code>Â ç­‰ï¼‰ï¼›</li>
<li>åˆ†ç‰‡åœ°å€ï¼ˆå¦‚Â <code>http://Node2:8983/solr/family_shard1</code>ï¼‰ï¼›</li>
<li>ä»»åŠ¡ç±»å‹ï¼ˆå¦‚Â <code>STATS</code>Â ç»Ÿè®¡ã€<code>QUERY</code>Â åŸºç¡€æŸ¥è¯¢ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p>æ‰€æœ‰Â <code>ShardRequest</code>Â è¢«åŠ å…¥åè°ƒèŠ‚ç‚¹çš„ã€Œå¹¶è¡Œä»»åŠ¡é˜Ÿåˆ—ã€ï¼Œç”±çº¿ç¨‹æ± ï¼ˆé»˜è®¤Â <code>solr.parallel.max.threads=16</code>ï¼‰è°ƒåº¦æ‰§è¡Œã€‚</p>
</li>
</ol>
<h3 data-id="heading-5">æ­¥éª¤ 4ï¼šå¹¶è¡Œå­æŸ¥è¯¢æ‰§è¡Œï¼ˆåè°ƒèŠ‚ç‚¹â†’åˆ†ç‰‡èŠ‚ç‚¹ï¼‰</h3>
<ol>
<li>
<p>åè°ƒèŠ‚ç‚¹é€šè¿‡ HTTP å®¢æˆ·ç«¯ï¼ˆå†…éƒ¨å°è£…ï¼‰å¹¶è¡Œå‘æ‰€æœ‰åˆ†ç‰‡èŠ‚ç‚¹å‘é€å­æŸ¥è¯¢ï¼›</p>
</li>
<li>
<p>åˆ†ç‰‡èŠ‚ç‚¹ï¼ˆNode2/Node3/Node4ï¼‰æ¥æ”¶å­æŸ¥è¯¢åï¼Œç‹¬ç«‹æ‰§è¡Œï¼š</p>
<ul>
<li><code>family_shard1/2</code>ï¼šæŸ¥è¯¢æœ¬åœ°ç´¢å¼•ï¼Œè®¡ç®—åˆ†ç‰‡å†…çš„Â <code>age</code>Â ç»Ÿè®¡å€¼ï¼ˆsum/count/avg ç­‰ï¼‰ï¼Œè¿”å›Â <code>ShardResponse</code>ï¼›</li>
<li><code>big_shard1</code>ï¼šæ— æ•°æ®ï¼Œè¿”å›ç©ºç»Ÿè®¡ç»“æœï¼ˆsum=0ã€count=0ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p>åˆ†ç‰‡èŠ‚ç‚¹çš„å“åº”ä¼šæºå¸¦ã€Œåˆ†ç‰‡çº§å…ƒæ•°æ®ã€ï¼ˆå¦‚Â <code>numFound</code>ã€ç»Ÿè®¡ç»“æœã€æ’åºå­—æ®µå€¼ï¼‰ï¼Œå¼‚æ­¥è¿”å›ç»™åè°ƒèŠ‚ç‚¹ã€‚</p>
</li>
</ol>
<h3 data-id="heading-6">æ­¥éª¤ 5ï¼šåè°ƒèŠ‚ç‚¹æ±‡æ€»åˆ†ç‰‡ç»Ÿè®¡ / æ’åºç»“æœï¼ˆæ ¸å¿ƒç¯èŠ‚ï¼‰</h3>
<p>è¿™æ˜¯åè°ƒèŠ‚ç‚¹çš„æ ¸å¿ƒå·¥ä½œï¼Œæ‰€æœ‰ CCS çš„æ±‡æ€»é€»è¾‘éƒ½åœ¨æ­¤å®Œæˆï¼Œæ ¸å¿ƒä¾èµ–Â <code>ResponseBuilder</code>Â æ”¶é›†æ‰€æœ‰Â <code>ShardResponse</code>Â å¹¶èšåˆï¼š</p>
<h4 data-id="heading-7">5.1 ç»Ÿè®¡ç»“æœæ±‡æ€»ï¼ˆä»¥ StatsComponent ä¸ºä¾‹ï¼‰</h4>
<p>Solr å†…ç½®çš„ç»Ÿè®¡ç»„ä»¶ï¼ˆ<code>StatsComponent</code>ï¼‰åœ¨åè°ƒèŠ‚ç‚¹ä¸Šæ‰§è¡Œã€Œåˆ†ç‰‡ç»Ÿè®¡å€¼â†’å…¨å±€ç»Ÿè®¡å€¼ã€çš„èšåˆï¼Œæ ¸å¿ƒé€»è¾‘ï¼š</p>
<ol>
<li>
<p>éå†æ‰€æœ‰åˆ†ç‰‡çš„Â <code>ShardResponse</code>ï¼Œæå–ç»Ÿè®¡å­—æ®µçš„åŸå§‹å€¼ï¼ˆå¦‚æ¯ä¸ªåˆ†ç‰‡çš„Â <code>sum_age</code>ã€<code>count_age</code>ã€<code>min_age</code>ã€<code>max_age</code>ï¼‰ï¼›</p>
</li>
<li>
<p>æŒ‰ç»Ÿè®¡ç±»å‹æ‰§è¡Œèšåˆç®—æ³•ï¼š</p>
<ul>
<li>ç´¯åŠ ç±»ï¼ˆsum/countï¼‰ï¼š<code>å…¨å±€sum = shard1.sum + shard2.sum + ...</code>ï¼›</li>
<li>è®¡ç®—ç±»ï¼ˆavgï¼‰ï¼š<code>å…¨å±€avg = å…¨å±€sum / å…¨å±€count</code>ï¼›</li>
<li>æå€¼ç±»ï¼ˆmin/maxï¼‰ï¼š<code>å…¨å±€min = min(shard1.min, shard2.min, ...)</code>ï¼›</li>
</ul>
</li>
<li>
<p>å°†èšåˆåçš„å…¨å±€ç»Ÿè®¡å€¼å†™å…¥Â <code>ResponseBuilder</code>Â çš„Â <code>statsInfo</code>Â å®¹å™¨ã€‚</p>
</li>
</ol>
<h4 data-id="heading-8">5.2 æ’åºç»“æœæ±‡æ€»ï¼ˆè‹¥éœ€å…¨å±€æ’åºï¼‰</h4>
<p>è‹¥è¯·æ±‚åŒ…å«Â <code>sort</code>Â å‚æ•°ï¼ˆå¦‚Â <code>sort=age desc</code>ï¼‰ï¼Œåè°ƒèŠ‚ç‚¹çš„æ’åºæ±‡æ€»é€»è¾‘ï¼š</p>
<ol>
<li>è‹¥åˆ†ç‰‡å·²æŒ‰åŒå­—æ®µæ’åºï¼ˆé»˜è®¤åˆ†ç‰‡ä¼šæŒ‰Â <code>sort</code>Â æ‰§è¡Œæœ¬åœ°æ’åºï¼‰ï¼šåè°ƒèŠ‚ç‚¹é‡‡ç”¨ã€Œå½’å¹¶æ’åºã€ï¼ˆMerge Sortï¼‰ï¼Œå°†å¤šä¸ªæœ‰åºåˆ†ç‰‡ç»“æœåˆå¹¶ä¸ºå…¨å±€æœ‰åºç»“æœï¼ˆæ—¶é—´å¤æ‚åº¦ O (N log K)ï¼ŒK ä¸ºåˆ†ç‰‡æ•°ï¼‰ï¼›</li>
<li>è‹¥åˆ†ç‰‡æœªæ’åºï¼šåè°ƒèŠ‚ç‚¹æ”¶é›†æ‰€æœ‰åˆ†ç‰‡ç»“æœåï¼Œåœ¨å†…å­˜ä¸­æ‰§è¡Œå…¨é‡æ’åºï¼›</li>
<li>æŒ‰Â <code>start/rows</code>Â æˆªå–æœ€ç»ˆåˆ†é¡µç»“æœï¼Œå†™å…¥Â <code>ResponseBuilder</code>Â çš„Â <code>docs</code>Â å®¹å™¨ã€‚</li>
</ol>
<h3 data-id="heading-9">æ­¥éª¤ 6ï¼šå“åº”ç»„è£…ä¸è¿”å›</h3>
<ol>
<li>åè°ƒèŠ‚ç‚¹å°†Â <code>ResponseBuilder</code>Â ä¸­çš„å…¨å±€ç»Ÿè®¡ç»“æœã€æ’åºåçš„æ–‡æ¡£åˆ—è¡¨ã€å…ƒæ•°æ®ï¼ˆ<code>numFound</code>/<code>QTime</code>ï¼‰å°è£…ä¸ºæ ‡å‡† Solr å“åº”æ ¼å¼ï¼›</li>
<li>å°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ•´ä¸ª CCS æµç¨‹ç»“æŸï¼ˆæ‰€æœ‰æ±‡æ€»ç»“æœä»…å­˜åœ¨äºåè°ƒèŠ‚ç‚¹å†…å­˜ï¼Œä¸ä¼šå†™å…¥ä»»ä½•é›†åˆï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-10">ä¸‰ã€åè°ƒèŠ‚ç‚¹æ±‡æ€» Shard ç»Ÿè®¡ç»“æœçš„åº•å±‚æœºåˆ¶</h2>
<h3 data-id="heading-11">1. æ ¸å¿ƒä¾èµ–çš„ç»„ä»¶ / ç±»</h3>





























<table><thead><tr><th>æ ¸å¿ƒç±» / ç»„ä»¶</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>DistributedSearchComponent</code></td><td>åˆ†å¸ƒå¼æŸ¥è¯¢çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£æ‹†åˆ†åˆ†ç‰‡ä»»åŠ¡ã€æ”¶é›†åˆ†ç‰‡å“åº”ã€è§¦å‘æ±‡æ€»é€»è¾‘</td></tr><tr><td><code>StatsComponent</code></td><td>ç»Ÿè®¡åŠŸèƒ½çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®šä¹‰ç»Ÿè®¡å­—æ®µçš„èšåˆè§„åˆ™ï¼ˆå¯æ‰©å±•ï¼‰</td></tr><tr><td><code>ResponseBuilder</code></td><td>å…¨å±€ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå­˜å‚¨æ‰€æœ‰åˆ†ç‰‡å“åº”ã€æœ€ç»ˆç»“æœã€æŸ¥è¯¢å‚æ•°</td></tr><tr><td><code>ShardRequest/ShardResponse</code></td><td>åˆ†ç‰‡è¯·æ±‚ / å“åº”å¯¹è±¡ï¼Œå°è£…åˆ†ç‰‡åœ°å€ã€å‚æ•°ã€è¿”å›ç»“æœ</td></tr><tr><td><code>SimpleFacets/StatsValues</code></td><td>åˆ†é¢ / ç»Ÿè®¡å€¼çš„å­˜å‚¨ç»“æ„ï¼Œæ”¯æŒåˆ†ç‰‡çº§å€¼çš„ç´¯åŠ  / èšåˆ</td></tr></tbody></table>
<h3 data-id="heading-12">2. æ±‡æ€»çš„æ ¸å¿ƒæµç¨‹ï¼ˆæºç çº§ç®€åŒ–é€»è¾‘ï¼‰</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// åè°ƒèŠ‚ç‚¹æ±‡æ€»ç»Ÿè®¡çš„æ ¸å¿ƒé€»è¾‘ï¼ˆä¼ªä»£ç ï¼‰</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">aggregateStats</span><span class="hljs-params">(ResponseBuilder rb)</span> {
    <span class="hljs-comment">// 1. åˆå§‹åŒ–å…¨å±€ç»Ÿè®¡å®¹å™¨</span>
    <span class="hljs-type">StatsValues</span> <span class="hljs-variable">globalStats</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StatsValues</span>();
    <span class="hljs-comment">// 2. éå†æ‰€æœ‰åˆ†ç‰‡å“åº”</span>
    <span class="hljs-keyword">for</span> (ShardResponse shardResp : rb.getShardResponses()) {
        <span class="hljs-comment">// 2.1 æå–åˆ†ç‰‡çº§ç»Ÿè®¡ç»“æœ</span>
        <span class="hljs-type">StatsValues</span> <span class="hljs-variable">shardStats</span> <span class="hljs-operator">=</span> shardResp.getStatsValues(<span class="hljs-string">"age"</span>);
        <span class="hljs-comment">// 2.2 èšåˆåˆ°å…¨å±€ï¼ˆç´¯åŠ sum/countï¼Œè®¡ç®—min/maxï¼‰</span>
        globalStats.addSum(shardStats.getSum());
        globalStats.addCount(shardStats.getCount());
        globalStats.updateMin(shardStats.getMin());
        globalStats.updateMax(shardStats.getMax());
    }
    <span class="hljs-comment">// 3. è®¡ç®—æ´¾ç”ŸæŒ‡æ ‡ï¼ˆå¦‚avgï¼‰</span>
    globalStats.calculateAvg();
    <span class="hljs-comment">// 4. å†™å…¥æœ€ç»ˆå“åº”</span>
    rb.getResponse().add(<span class="hljs-string">"stats"</span>, globalStats);
}
</code></pre>
<h3 data-id="heading-13">3. ä¸åŒç»Ÿè®¡ç±»å‹çš„æ±‡æ€»è§„åˆ™</h3>






























<table><thead><tr><th>ç»Ÿè®¡ç±»å‹</th><th>æ±‡æ€»ç®—æ³•</th><th>ç¤ºä¾‹ï¼ˆfamily_shard1: sum=100, count=5ï¼›family_shard2: sum=200, count=10ï¼›big_shard1: sum=0, count=0ï¼‰</th></tr></thead><tbody><tr><td>Count/Sum</td><td>åˆ†ç‰‡å€¼ç´¯åŠ </td><td>å…¨å±€ count=15ï¼Œå…¨å±€ sum=300</td></tr><tr><td>Avg</td><td>å…¨å±€ sum / å…¨å±€ count</td><td>å…¨å±€ avg=20ï¼ˆ300/15ï¼‰</td></tr><tr><td>Min/Max</td><td>æ‰€æœ‰åˆ†ç‰‡çš„ Min/Max æå€¼</td><td>è‹¥ shard1.min=10ï¼Œshard2.min=15 â†’ å…¨å±€ min=10</td></tr><tr><td>Facetï¼ˆåˆ†é¢ï¼‰</td><td>åˆ†é¢é¡¹è®¡æ•°ç´¯åŠ ï¼ˆå¦‚ age:20 çš„ count=shard1+shard2ï¼‰</td><td>age:20 çš„å…¨å±€ count=shard1.count (20) + shard2.count (20)</td></tr></tbody></table>
<h2 data-id="heading-14">å››ã€è‡ªå®šä¹‰å¼€å‘åè°ƒèŠ‚ç‚¹çš„ç»Ÿè®¡ / æ’åºé€»è¾‘</h2>
<p>Solr æ”¯æŒé€šè¿‡ã€Œæ‰©å±• Component ç»„ä»¶ã€è‡ªå®šä¹‰åè°ƒèŠ‚ç‚¹çš„æ±‡æ€»é€»è¾‘ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼š<strong>ç»§æ‰¿ / é‡å†™ Solr å†…ç½®çš„ Componentï¼ˆå¦‚ StatsComponentã€SearchComponentï¼‰ï¼Œåœ¨åè°ƒèŠ‚ç‚¹çš„æ±‡æ€»é˜¶æ®µæ’å…¥è‡ªå®šä¹‰é€»è¾‘</strong>ã€‚</p>
<h3 data-id="heading-15">å‰æå‡†å¤‡</h3>
<ol>
<li>ç¯å¢ƒï¼šSolr æºç  / è‡ªå®šä¹‰æ’ä»¶å¼€å‘ç¯å¢ƒï¼ˆJDK 11+ï¼Œä¸ Solr ç‰ˆæœ¬ä¸€è‡´ï¼Œå¦‚ Solr 9.xï¼‰ï¼›</li>
<li>æ ¸å¿ƒåŸåˆ™ï¼šè‡ªå®šä¹‰é€»è¾‘ä»…éœ€åœ¨åè°ƒèŠ‚ç‚¹æ‰§è¡Œï¼ˆåˆ†ç‰‡èŠ‚ç‚¹ä»ç”¨é»˜è®¤é€»è¾‘ï¼‰ï¼Œéœ€é€šè¿‡Â <code>rb.isDistributed()</code>Â åˆ¤æ–­æ˜¯å¦ä¸ºåˆ†å¸ƒå¼æŸ¥è¯¢ï¼ˆCCS å±äºåˆ†å¸ƒå¼æŸ¥è¯¢ï¼‰ã€‚</li>
</ol>
<h3 data-id="heading-16">åœºæ™¯ 1ï¼šè‡ªå®šä¹‰ç»Ÿè®¡æ±‡æ€»é€»è¾‘ï¼ˆç¤ºä¾‹ï¼šåŠ æƒ Sum ç»Ÿè®¡ï¼‰</h3>
<p>éœ€æ±‚ï¼šæ±‡æ€»æ—¶ä¸ºä¸åŒé›†åˆçš„åˆ†ç‰‡ç»Ÿè®¡å€¼åŠ æƒé‡ï¼ˆå¦‚ family åˆ†ç‰‡æƒé‡ 1ï¼Œbig åˆ†ç‰‡æƒé‡ 0.5ï¼‰ã€‚</p>
<h4 data-id="heading-17">æ­¥éª¤ 1ï¼šå¼€å‘è‡ªå®šä¹‰ StatsComponent</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.solr.handler.component.StatsComponent;
<span class="hljs-keyword">import</span> org.apache.solr.handler.component.ResponseBuilder;
<span class="hljs-keyword">import</span> org.apache.solr.common.util.NamedList;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomWeightedStatsComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">StatsComponent</span> {

    <span class="hljs-comment">// é‡å†™åè°ƒèŠ‚ç‚¹çš„ç»Ÿè®¡æ±‡æ€»é€»è¾‘</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">finishStage</span><span class="hljs-params">(ResponseBuilder rb)</span> {
        <span class="hljs-comment">// ä»…åœ¨åè°ƒèŠ‚ç‚¹æ‰§è¡Œæ±‡æ€»ï¼ˆåˆ†å¸ƒå¼æŸ¥è¯¢é˜¶æ®µï¼‰</span>
        <span class="hljs-keyword">if</span> (rb.isDistributed() &amp;&amp; rb.stage == ResponseBuilder.STAGE_GET_FIELDS) {
            <span class="hljs-comment">// 1. è·å–æ‰€æœ‰åˆ†ç‰‡å“åº”</span>
            List&lt;ShardResponse&gt; shardResponses = rb.getShardResponses();
            <span class="hljs-comment">// 2. åˆå§‹åŒ–åŠ æƒå…¨å±€ç»Ÿè®¡å®¹å™¨</span>
            NamedList&lt;Object&gt; globalStats = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NamedList</span>&lt;&gt;();
            <span class="hljs-type">double</span> <span class="hljs-variable">weightedSum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.0</span>;
            <span class="hljs-type">long</span> <span class="hljs-variable">totalCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

            <span class="hljs-comment">// 3. éå†åˆ†ç‰‡å“åº”ï¼ŒæŒ‰é›†åˆåŠ æƒæ±‡æ€»</span>
            <span class="hljs-keyword">for</span> (ShardResponse resp : shardResponses) {
                <span class="hljs-comment">// è·å–åˆ†ç‰‡æ‰€å±é›†åˆï¼ˆä»åˆ†ç‰‡åœ°å€/å…ƒæ•°æ®è§£æï¼‰</span>
                <span class="hljs-type">String</span> <span class="hljs-variable">collection</span> <span class="hljs-operator">=</span> getCollectionFromShard(resp.getShardInfo().getShardName());
                <span class="hljs-comment">// æå–åˆ†ç‰‡ç»Ÿè®¡å€¼</span>
                <span class="hljs-type">double</span> <span class="hljs-variable">shardSum</span> <span class="hljs-operator">=</span> (Double) resp.getSolrResponse().getResponse().get(<span class="hljs-string">"stats"</span>).get(<span class="hljs-string">"sum_age"</span>);
                <span class="hljs-type">long</span> <span class="hljs-variable">shardCount</span> <span class="hljs-operator">=</span> (Long) resp.getSolrResponse().getResponse().get(<span class="hljs-string">"stats"</span>).get(<span class="hljs-string">"count_age"</span>);

                <span class="hljs-comment">// 4. è‡ªå®šä¹‰åŠ æƒè§„åˆ™</span>
                <span class="hljs-type">double</span> <span class="hljs-variable">weight</span> <span class="hljs-operator">=</span> <span class="hljs-string">"family"</span>.equals(collection) ? <span class="hljs-number">1.0</span> : <span class="hljs-number">0.5</span>; <span class="hljs-comment">// big åˆ†ç‰‡æƒé‡ 0.5</span>
                weightedSum += shardSum * weight;
                totalCount += shardCount;
            }

            <span class="hljs-comment">// 5. å†™å…¥è‡ªå®šä¹‰ç»Ÿè®¡ç»“æœ</span>
            globalStats.add(<span class="hljs-string">"weighted_sum_age"</span>, weightedSum);
            globalStats.add(<span class="hljs-string">"weighted_avg_age"</span>, weightedSum / totalCount);
            <span class="hljs-comment">// åˆå¹¶åˆ°åŸå§‹ç»Ÿè®¡ç»“æœä¸­</span>
            rb.rsp.add(<span class="hljs-string">"custom_stats"</span>, globalStats);
        }

        <span class="hljs-comment">// æ‰§è¡Œçˆ¶ç±»é»˜è®¤é€»è¾‘ï¼ˆä¿ç•™åŸæœ‰ç»Ÿè®¡ï¼‰</span>
        <span class="hljs-built_in">super</span>.finishStage(rb);
    }

    <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•ï¼šä»åˆ†ç‰‡åè§£ææ‰€å±é›†åˆï¼ˆå¦‚ family_shard1 â†’ familyï¼‰</span>
    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getCollectionFromShard</span><span class="hljs-params">(String shardName)</span> {
        <span class="hljs-keyword">if</span> (shardName.startsWith(<span class="hljs-string">"family"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"family"</span>;
        <span class="hljs-keyword">if</span> (shardName.startsWith(<span class="hljs-string">"big"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-string">"big"</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    }
}
</code></pre>
<h4 data-id="heading-18">æ­¥éª¤ 2ï¼šæ³¨å†Œè‡ªå®šä¹‰ Component</h4>
<ol>
<li>åœ¨Â <code>solrconfig.xml</code>Â ä¸­æ³¨å†Œè‡ªå®šä¹‰ç»„ä»¶ï¼ˆæ‰€æœ‰åè°ƒèŠ‚ç‚¹éœ€é…ç½®ï¼‰ï¼š</li>
</ol>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">searchComponent</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"customStats"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.yourpackage.CustomWeightedStatsComponent"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">str</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"stats.field"</span>&gt;</span>age<span class="hljs-tag">&lt;/<span class="hljs-name">str</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">searchComponent</span>&gt;</span>

<span class="hljs-comment">&lt;!-- å°†è‡ªå®šä¹‰ç»„ä»¶åŠ å…¥æŸ¥è¯¢å¤„ç†å™¨ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">requestHandler</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"/select"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"solr.SearchHandler"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">arr</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"components"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">str</span>&gt;</span>query<span class="hljs-tag">&lt;/<span class="hljs-name">str</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">str</span>&gt;</span>customStats<span class="hljs-tag">&lt;/<span class="hljs-name">str</span>&gt;</span> <span class="hljs-comment">&lt;!-- è‡ªå®šä¹‰ç»Ÿè®¡ç»„ä»¶ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">str</span>&gt;</span>stats<span class="hljs-tag">&lt;/<span class="hljs-name">str</span>&gt;</span> <span class="hljs-comment">&lt;!-- ä¿ç•™åŸç”Ÿç»Ÿè®¡ç»„ä»¶ï¼ˆå¯é€‰ï¼‰ --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">str</span>&gt;</span>facet<span class="hljs-tag">&lt;/<span class="hljs-name">str</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">str</span>&gt;</span>sort<span class="hljs-tag">&lt;/<span class="hljs-name">str</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">arr</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">requestHandler</span>&gt;</span>
</code></pre>
<h4 data-id="heading-19">æ­¥éª¤ 3ï¼šæ‰“åŒ…éƒ¨ç½²</h4>
<ol>
<li>å°†è‡ªå®šä¹‰ç±»æ‰“åŒ…ä¸º JARï¼ˆä¾èµ– Solr æ ¸å¿ƒåŒ…ï¼Œå¦‚Â <code>solr-core-9.4.0.jar</code>ï¼‰ï¼›</li>
<li>å°† JAR æ”¾å…¥ Solr èŠ‚ç‚¹çš„Â <code>server/solr/lib</code>Â ç›®å½•ï¼ˆæ‰€æœ‰åè°ƒèŠ‚ç‚¹éœ€éƒ¨ç½²ï¼‰ï¼›</li>
<li>é‡å¯ Solr é›†ç¾¤ï¼Œç”Ÿæ•ˆé…ç½®ã€‚</li>
</ol>
<h3 data-id="heading-20">åœºæ™¯ 2ï¼šè‡ªå®šä¹‰å…¨å±€æ’åºé€»è¾‘</h3>
<p>éœ€æ±‚ï¼šè·¨åˆ†ç‰‡æ’åºæ—¶ï¼Œä¸ä»…æŒ‰Â <code>age</code>Â æ’åºï¼Œè¿˜æŒ‰ã€Œé›†åˆä¼˜å…ˆçº§ã€æ’åºï¼ˆfamily æ–‡æ¡£ä¼˜å…ˆäº big æ–‡æ¡£ï¼‰ã€‚</p>
<h4 data-id="heading-21">æ­¥éª¤ 1ï¼šå¼€å‘è‡ªå®šä¹‰ SortComponent</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.apache.solr.handler.component.SearchComponent;
<span class="hljs-keyword">import</span> org.apache.solr.handler.component.ResponseBuilder;
<span class="hljs-keyword">import</span> org.apache.solr.common.SolrDocument;
<span class="hljs-keyword">import</span> java.util.Comparator;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomCollectionSortComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SearchComponent</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">finishStage</span><span class="hljs-params">(ResponseBuilder rb)</span> {
        <span class="hljs-comment">// ä»…åœ¨åè°ƒèŠ‚ç‚¹æ‰§è¡Œå…¨å±€æ’åº</span>
        <span class="hljs-keyword">if</span> (rb.isDistributed() &amp;&amp; rb.stage == ResponseBuilder.STAGE_SORT) {
            <span class="hljs-comment">// 1. è·å–æ‰€æœ‰åˆ†ç‰‡è¿”å›çš„æ–‡æ¡£åˆ—è¡¨</span>
            List&lt;SolrDocument&gt; docs = rb.getResults().docs;
            <span class="hljs-comment">// 2. è‡ªå®šä¹‰æ’åºå™¨ï¼šå…ˆæŒ‰é›†åˆä¼˜å…ˆçº§ï¼Œå†æŒ‰ageé™åº</span>
            docs.sort(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>&lt;SolrDocument&gt;() {
                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(SolrDocument d1, SolrDocument d2)</span> {
                    <span class="hljs-comment">// 2.1 è§£ææ–‡æ¡£æ‰€å±é›†åˆï¼ˆéœ€åˆ†ç‰‡è¿”å›æ—¶æºå¸¦é›†åˆå…ƒæ•°æ®ï¼‰</span>
                    <span class="hljs-type">String</span> <span class="hljs-variable">coll1</span> <span class="hljs-operator">=</span> (String) d1.get(<span class="hljs-string">"_collection"</span>); <span class="hljs-comment">// éœ€åœ¨åˆ†ç‰‡æŸ¥è¯¢æ—¶æ·»åŠ è¯¥å­—æ®µ</span>
                    <span class="hljs-type">String</span> <span class="hljs-variable">coll2</span> <span class="hljs-operator">=</span> (String) d2.get(<span class="hljs-string">"_collection"</span>);
                    <span class="hljs-comment">// 2.2 é›†åˆä¼˜å…ˆçº§ï¼šfamily &gt; big</span>
                    <span class="hljs-type">int</span> <span class="hljs-variable">collCompare</span> <span class="hljs-operator">=</span> getCollectionPriority(coll2) - getCollectionPriority(coll1);
                    <span class="hljs-keyword">if</span> (collCompare != <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> collCompare;
                    <span class="hljs-comment">// 2.3 æŒ‰ageé™åº</span>
                    <span class="hljs-type">Integer</span> <span class="hljs-variable">age1</span> <span class="hljs-operator">=</span> (Integer) d1.get(<span class="hljs-string">"age"</span>);
                    <span class="hljs-type">Integer</span> <span class="hljs-variable">age2</span> <span class="hljs-operator">=</span> (Integer) d2.get(<span class="hljs-string">"age"</span>);
                    <span class="hljs-keyword">return</span> age2.compareTo(age1);
                }
            });
            <span class="hljs-comment">// 3. æ›¿æ¢åŸå§‹æ’åºç»“æœ</span>
            rb.getResults().docs = docs;
        }
    }

    <span class="hljs-comment">// å®šä¹‰é›†åˆä¼˜å…ˆçº§ï¼ˆæ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCollectionPriority</span><span class="hljs-params">(String collection)</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"family"</span>.equals(collection) ? <span class="hljs-number">2</span> : <span class="hljs-number">1</span>; <span class="hljs-comment">// big ä¼˜å…ˆçº§ 1</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDescription</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Custom collection-aware sort component"</span>;
    }
}
</code></pre>
<h4 data-id="heading-22">æ­¥éª¤ 2ï¼šé…ç½®ä¸éƒ¨ç½²</h4>
<ol>
<li>åœ¨Â <code>solrconfig.xml</code>Â ä¸­æ³¨å†Œè‡ªå®šä¹‰æ’åºç»„ä»¶ï¼ˆæ›¿æ¢ / è¿½åŠ åˆ°Â <code>select</code>Â å¤„ç†å™¨ï¼‰ï¼›</li>
<li>ç¡®ä¿åˆ†ç‰‡æŸ¥è¯¢æ—¶è¿”å›Â <code>_collection</code>Â å­—æ®µï¼ˆåœ¨Â <code>fl</code>Â å‚æ•°ä¸­æ·»åŠ Â <code>_collection</code>ï¼Œå¦‚Â <code>fl=*,_collection</code>ï¼‰ï¼›</li>
<li>æ‰“åŒ… JAR å¹¶éƒ¨ç½²åˆ°åè°ƒèŠ‚ç‚¹ï¼Œé‡å¯ç”Ÿæ•ˆã€‚</li>
</ol>
<h3 data-id="heading-23">è‡ªå®šä¹‰å¼€å‘çš„å…³é”®æ³¨æ„äº‹é¡¹</h3>
<ol>
<li><strong>ä»…åœ¨åè°ƒèŠ‚ç‚¹æ‰§è¡Œ</strong>ï¼šé€šè¿‡Â <code>rb.isDistributed()</code>Â åˆ¤æ–­åˆ†å¸ƒå¼æŸ¥è¯¢ï¼Œé¿å…åˆ†ç‰‡èŠ‚ç‚¹æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ï¼›</li>
<li><strong>æ€§èƒ½æ§åˆ¶</strong>ï¼šåè°ƒèŠ‚ç‚¹æ±‡æ€» / æ’åºä¾èµ–å†…å­˜ï¼Œè‡ªå®šä¹‰é€»è¾‘éœ€é¿å…å…¨é‡æ•°æ®åŠ è½½ï¼ˆæ§åˆ¶Â <code>shards.rows</code>ï¼‰ï¼›</li>
<li><strong>å…ƒæ•°æ®ä¼ é€’</strong>ï¼šè‡ªå®šä¹‰é€»è¾‘éœ€åˆ†ç‰‡è¿”å›é¢å¤–å…ƒæ•°æ®ï¼ˆå¦‚Â <code>_collection</code>ï¼‰æ—¶ï¼Œéœ€åœ¨å­æŸ¥è¯¢ä¸­é€šè¿‡Â <code>fl</code>Â å‚æ•°æ˜¾å¼æŒ‡å®šï¼›</li>
<li><strong>ç‰ˆæœ¬å…¼å®¹</strong>ï¼šè‡ªå®šä¹‰ç»„ä»¶éœ€ä¸ Solr ç‰ˆæœ¬åŒ¹é…ï¼ˆå¦‚ Solr 8.x å’Œ 9.x çš„Â <code>ResponseBuilder</code>Â æ¥å£æœ‰å·®å¼‚ï¼‰ã€‚</li>
</ol>
<h2 data-id="heading-24">äº”ã€æ ¸å¿ƒæ€»ç»“</h2>
<ol>
<li><strong>CCS ä¸åè°ƒèŠ‚ç‚¹çš„ååŒ</strong>ï¼šCCS å®šä¹‰è·¨é›†åˆæŸ¥è¯¢çš„è§„åˆ™ï¼Œåè°ƒèŠ‚ç‚¹è´Ÿè´£å°† CCS è¯·æ±‚æ‹†åˆ†ä¸ºåˆ†ç‰‡ä»»åŠ¡ã€å¹¶è¡Œæ‰§è¡Œã€æ±‡æ€»ç»“æœï¼Œæ‰€æœ‰é€»è¾‘å‡åœ¨åè°ƒèŠ‚ç‚¹å†…å­˜å®Œæˆï¼›</li>
<li><strong>ç»Ÿè®¡æ±‡æ€»æœºåˆ¶</strong>ï¼šåè°ƒèŠ‚ç‚¹é€šè¿‡éå†åˆ†ç‰‡å“åº”ï¼ŒæŒ‰ç»Ÿè®¡ç±»å‹ï¼ˆsum/count/avgï¼‰æ‰§è¡Œç´¯åŠ  / æå€¼ / è®¡ç®—ç±»èšåˆï¼Œæ ¸å¿ƒä¾èµ–Â <code>StatsComponent</code>ï¼›</li>
<li><strong>è‡ªå®šä¹‰å¼€å‘</strong>ï¼šé€šè¿‡æ‰©å±• Solr çš„Â <code>SearchComponent</code>ï¼ˆå¦‚Â <code>StatsComponent</code>/ è‡ªå®šä¹‰ Sort ç»„ä»¶ï¼‰ï¼Œåœ¨åè°ƒèŠ‚ç‚¹çš„Â <code>finishStage</code>Â é˜¶æ®µæ’å…¥è‡ªå®šä¹‰æ±‡æ€» / æ’åºé€»è¾‘ï¼Œæ‰“åŒ…éƒ¨ç½²åˆ°åè°ƒèŠ‚ç‚¹å³å¯ç”Ÿæ•ˆã€‚</li>
</ol>
<p>è‹¥éœ€ç®€åŒ–å¼€å‘ï¼Œä¹Ÿå¯é€šè¿‡ Solr çš„ã€Œè‡ªå®šä¹‰å‡½æ•°ï¼ˆFunction Queryï¼‰ã€å®ç°è½»é‡çº§ç»Ÿè®¡ / æ’åºå®šåˆ¶ï¼ˆæ— éœ€å¼€å‘æ’ä»¶ï¼‰ï¼Œä»…éœ€åœ¨æŸ¥è¯¢å‚æ•°ä¸­ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°ï¼ˆå¦‚Â <code>sort=custom_weight(age, collection) desc</code>ï¼‰ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Paimonæºç è§£è¯» -- Compaction-6.CompactStrategy]]></title>    <link>https://juejin.cn/post/7583244688121135113</link>    <guid>https://juejin.cn/post/7583244688121135113</guid>    <pubDate>2025-12-14T06:26:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583244688121135113" data-draft-id="7582846276506632230" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Paimonæºç è§£è¯» -- Compaction-6.CompactStrategy"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,Flink"/> <meta itemprop="datePublished" content="2025-12-14T06:26:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="expect7g"/> <meta itemprop="url" content="https://juejin.cn/user/3514471387235735"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Paimonæºç è§£è¯» -- Compaction-6.CompactStrategy
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3514471387235735/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    expect7g
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:26:49.000Z" title="Sun Dec 14 2025 06:26:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ¬æ–‡é‡ç‚¹ä»‹ç»Paimon-Compactionçš„é‡è¦ç­–ç•¥ï¼ŒåŒ…æ‹¬å…¨é‡å‹ç¼©ã€æ¯”ç‡å‹ç¼©ç­‰</p>
<p><strong>å…³é”®æ¦‚å¿µ</strong>ï¼š</p>
<ul>
<li>
<p><strong>SortedRun</strong>ï¼šæœ‰åºçš„æ–‡ä»¶é›†åˆ</p>
<ul>
<li>Level 0: æ¯ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ª run (æ–‡ä»¶é—´å¯èƒ½æœ‰é”®é‡å )</li>
<li>Level 1+: æ¯å±‚æ‰€æœ‰æ–‡ä»¶æ˜¯ä¸€ä¸ª run (å±‚å†…æ–‡ä»¶é—´æ— é”®é‡å )</li>
</ul>
</li>
<li>
<p><strong>CompactUnit</strong>ï¼šè¢«é€‰ä¸­è¦å‹ç¼©çš„æ–‡ä»¶å•å…ƒï¼Œä»¥runä¸ºå•å…ƒ</p>
</li>
</ul>
<h2 data-id="heading-1">ä¸€.CompactStrategyæ¥å£</h2>
<p>è¿™æ˜¯ä¸ªæ¥å£ï¼Œå…¶å®ç°å­ç±»å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ea15f4490694bf4a6c108f66f824ebb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZXhwZWN0N2c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298409&amp;x-signature=1izyAC0tutceDeBj1FSjBGWbCzc%3D" alt="image.png" loading="lazy"/></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">CompactStrategy</span> {

    <span class="hljs-comment">/**
     * ä»æ‰€æœ‰ runs ä¸­æŒ‘é€‰éœ€è¦å‹ç¼©çš„ CompactUnitï¼Œç”±å­ç±»å®ç°
     *
     * æ ¸å¿ƒè§„åˆ™:
     * 1. å‹ç¼©æ˜¯åŸºäº runs çš„ï¼Œè€Œéå•ä¸ªæ–‡ä»¶
     * 2. Level 0 ç‰¹æ®Šï¼šä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ª runï¼›å…¶ä»–å±‚çº§ï¼šä¸€å±‚ä¸€ä¸ª run
     * 3. å‹ç¼©æ˜¯é¡ºåºçš„ï¼šä»å° level åˆ°å¤§ level
     */</span>
    Optional&lt;CompactUnit&gt; <span class="hljs-title function_">pick</span><span class="hljs-params">(<span class="hljs-type">int</span> numLevels, List&lt;LevelSortedRun&gt; runs)</span>;

    <span class="hljs-comment">/**
     * æŒ‘é€‰éœ€è¦å…¨é‡å‹ç¼©çš„å•å…ƒï¼Œè¯¥æ–¹æ³•åœ¨MergeTreeCompactManager.triggerCompaction()ä¸­é’ˆå¯¹å…¨é‡å‹ç¼©è°ƒç”¨
     * <span class="hljs-doctag">@param</span> numLevels
     * <span class="hljs-doctag">@param</span> runs
     * <span class="hljs-doctag">@return</span>
     */</span>
    <span class="hljs-keyword">static</span> Optional&lt;CompactUnit&gt; <span class="hljs-title function_">pickFullCompaction</span><span class="hljs-params">(<span class="hljs-type">int</span> numLevels, List&lt;LevelSortedRun&gt; runs)</span> {
        <span class="hljs-type">int</span> <span class="hljs-variable">maxLevel</span> <span class="hljs-operator">=</span> numLevels - <span class="hljs-number">1</span>;
        <span class="hljs-comment">// å¦‚æœæ²¡æœ‰ run æˆ–åªæœ‰ä¸€ä¸ª run åœ¨æœ€é«˜å±‚ï¼Œåˆ™æ— éœ€å‹ç¼©</span>
        <span class="hljs-keyword">if</span> (runs.isEmpty() || (runs.size() == <span class="hljs-number">1</span> &amp;&amp; runs.get(<span class="hljs-number">0</span>).level() == maxLevel)) {
            <span class="hljs-comment">// no sorted run or only 1 sorted run on the max level, no need to compact</span>
            <span class="hljs-keyword">return</span> Optional.empty();
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// å¦åˆ™ï¼Œé€‰æ‹©å…¨éƒ¨levelå±‚çš„å…¨éƒ¨runséœ€è¦å‹ç¼©</span>
            <span class="hljs-keyword">return</span> Optional.of(CompactUnit.fromLevelRuns(maxLevel, runs));
        }
    }
}
</code></pre>
<h2 data-id="heading-2">äºŒ.UniversalCompaction -- é€šç”¨å‹ç¼©ç­–ç•¥</h2>
<h3 data-id="heading-3">1.ä»£ç è§£æ</h3>
<h4 data-id="heading-4">(1) æ ¸å¿ƒå˜é‡å’Œæ„é€ å‡½æ•°</h4>



































<table><thead><tr><th>å‚æ•°</th><th>é»˜è®¤å€¼</th><th>ä½œç”¨</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>compaction.max-size-amplification-percent</strong></td><td>200</td><td>æœ€å¤§ç©ºé—´æ”¾å¤§ç™¾åˆ†æ¯”ï¼Œè¶…è¿‡åˆ™è§¦å‘å‹ç¼©</td><td>200% è¡¨ç¤ºå…è®¸æœ€å¤š 2 å€ç©ºé—´æµªè´¹</td></tr><tr><td><strong>compaction.size-ratio</strong></td><td>1</td><td>ç›¸é‚»å±‚çº§çš„å¤§å°æ¯”ç‡é˜ˆå€¼</td><td>æ¯”ç‡ &lt; 1 æ—¶è§¦å‘åˆå¹¶</td></tr><tr><td><strong>num-sorted-run.compaction-trigger</strong></td><td>5</td><td>è§¦å‘å‹ç¼©çš„æœ€å° run æ•°é‡</td><td>å½“ Level 0 æœ‰ 5 ä¸ªæ–‡ä»¶æ—¶è§¦å‘</td></tr><tr><td><strong>compaction.optimization-interval</strong></td><td>null</td><td>ä¼˜åŒ–å‹ç¼©é—´éš” (å¤šå°‘æ¬¡æ™®é€šå‹ç¼©åè§¦å‘ä¸€æ¬¡ä¼˜åŒ–å‹ç¼©)</td><td>è®¾ç½®ä¸º 5 è¡¨ç¤ºæ¯ 5 æ¬¡æ™®é€šå‹ç¼©æ‰§è¡Œ 1 æ¬¡ä¼˜åŒ–å‹ç¼©</td></tr></tbody></table>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> maxSizeAmp; <span class="hljs-comment">// ç”±å‚æ•°'compaction.max-size-amplification-percent'ç»‘å®š (é»˜è®¤ 200)</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> sizeRatio; <span class="hljs-comment">// ç”±å‚æ•°'compaction.size-ratio'ç»‘å®š (é»˜è®¤ 1)</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> numRunCompactionTrigger; <span class="hljs-comment">// ç”±å‚æ•°'num-sorted-run.compaction-trigger' (é»˜è®¤ 5)</span>

<span class="hljs-meta">@Nullable</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Long opCompactionInterval; <span class="hljs-comment">// ç”±å‚æ•°'compaction.optimization-interval'ç»‘å®š (å¯é€‰)</span>
<span class="hljs-meta">@Nullable</span> <span class="hljs-keyword">private</span> Long lastOptimizedCompaction; <span class="hljs-comment">// å·²æ‰§è¡Œçš„å‹ç¼©æ¬¡æ•°è®¡æ•°å™¨</span>

<span class="hljs-keyword">public</span> <span class="hljs-title function_">UniversalCompaction</span><span class="hljs-params">(<span class="hljs-type">int</span> maxSizeAmp, <span class="hljs-type">int</span> sizeRatio, <span class="hljs-type">int</span> numRunCompactionTrigger)</span> {
    <span class="hljs-built_in">this</span>(maxSizeAmp, sizeRatio, numRunCompactionTrigger, <span class="hljs-literal">null</span>);
}

<span class="hljs-keyword">public</span> <span class="hljs-title function_">UniversalCompaction</span><span class="hljs-params">(
        <span class="hljs-type">int</span> maxSizeAmp,
        <span class="hljs-type">int</span> sizeRatio,
        <span class="hljs-type">int</span> numRunCompactionTrigger,
        <span class="hljs-meta">@Nullable</span> Duration opCompactionInterval)</span> {
    <span class="hljs-built_in">this</span>.maxSizeAmp = maxSizeAmp;
    <span class="hljs-built_in">this</span>.sizeRatio = sizeRatio;
    <span class="hljs-built_in">this</span>.numRunCompactionTrigger = numRunCompactionTrigger;
    <span class="hljs-comment">// å°†compaction.optimization-intervalé…ç½®çš„å€¼è½¬ä¸ºæ¯«ç§’</span>
    <span class="hljs-built_in">this</span>.opCompactionInterval =
            opCompactionInterval == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : opCompactionInterval.toMillis();
}
</code></pre>
<h4 data-id="heading-5">(2) <code>pick()</code> -- ç­–ç•¥æ ¸å¿ƒ</h4>
<p>æµç¨‹æ€»ç»“å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[pick æ–¹æ³•å¼€å§‹] --&gt; B{æ­¥éª¤1: æ˜¯å¦è¾¾åˆ°&lt;br/&gt;å‹ç¼©æ—¶é—´é—´éš”opCompactionInterval?}
    B --&gt;|æ˜¯| C[è§¦å‘å…¨é‡å‹ç¼©&lt;br/&gt;å‹ç¼©æ‰€æœ‰æ–‡ä»¶åˆ°æœ€é«˜å±‚]
    B --&gt;|å¦| D{æ­¥éª¤2: æ˜¯å¦ç©ºé—´æ”¾å¤§&lt;br/&gt;è¶…è¿‡é˜ˆå€¼?&lt;br/&gt;pickForSizeAmp}
    
    D --&gt;|æ˜¯| E[è§¦å‘å…¨é‡å‹ç¼©&lt;br/&gt;å‹ç¼©æ‰€æœ‰æ–‡ä»¶åˆ°æœ€é«˜å±‚]
    D --&gt;|å¦| F{æ­¥éª¤3: æ˜¯å¦å¤§å°æ¯”ç‡&lt;br/&gt;ä¸åˆç†?&lt;br/&gt;pickForSizeRatio}
    
    F --&gt;|æ˜¯| G[è§¦å‘éƒ¨åˆ†å‹ç¼©&lt;br/&gt;å‹ç¼©éƒ¨åˆ†æ–‡ä»¶]
    F --&gt;|å¦| H{æ­¥éª¤4: æ–‡ä»¶æ•°é‡æ˜¯å¦&lt;br/&gt;&gt; numRunCompactionTrigger?}
    
    H --&gt;|æ˜¯| I[è§¦å‘éƒ¨åˆ†å‹ç¼©&lt;br/&gt;å‹ç¼©å¤šä½™æ–‡ä»¶]
    H --&gt;|å¦| J[è¿”å› empty&lt;br/&gt;æœ¬æ¬¡ä¸å‹ç¼©]
    
    style C fill:#fff9c4
    style E fill:#fff9c4
    style G fill:#c8e6c9
    style I fill:#c8e6c9
    style J fill:#ffcdd2
</code></pre>















































<table><thead><tr><th>æ­¥éª¤</th><th>åˆ¤æ–­æ¡ä»¶</th><th>å‹ç¼©ç±»å‹</th><th>ä¼˜å…ˆçº§</th><th>è§¦å‘é¢‘ç‡</th></tr></thead><tbody><tr><td><strong>æ­¥éª¤1</strong></td><td>æ—¶é—´é—´éš”è¾¾åˆ°</td><td>å…¨é‡å‹ç¼©</td><td>ğŸ”´ æœ€é«˜</td><td>å®šæœŸè§¦å‘ (å¦‚æ¯ 1 å°æ—¶)</td></tr><tr><td><strong>æ­¥éª¤2</strong></td><td>ç©ºé—´æ”¾å¤§è¶…æ ‡</td><td>å…¨é‡å‹ç¼©</td><td>ğŸŸ  é«˜</td><td>ç©ºé—´æµªè´¹ä¸¥é‡æ—¶</td></tr><tr><td><strong>æ­¥éª¤3</strong></td><td>å¤§å°æ¯”ç‡ä¸åˆç†</td><td>éƒ¨åˆ†å‹ç¼©</td><td>ğŸŸ¡ ä¸­</td><td>å±‚çº§å¤±è¡¡æ—¶</td></tr><tr><td><strong>æ­¥éª¤4</strong></td><td>æ–‡ä»¶æ•°é‡è¿‡å¤š</td><td>éƒ¨åˆ†å‹ç¼©</td><td>ğŸŸ¢ ä½</td><td>æ–‡ä»¶æ•°é‡è¶…æ ‡æ—¶</td></tr><tr><td>æºç åˆ†æ</td><td/><td/><td/><td/></tr></tbody></table>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> Optional&lt;CompactUnit&gt; <span class="hljs-title function_">pick</span><span class="hljs-params">(<span class="hljs-type">int</span> numLevels, List&lt;LevelSortedRun&gt; runs)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">maxLevel</span> <span class="hljs-operator">=</span> numLevels - <span class="hljs-number">1</span>;
    <span class="hljs-comment">// æ­¥1. è¾¾åˆ°å‹ç¼©æ—¶é—´é—´éš”è§¦å‘å…¨é‡å‹ç¼© -- é«˜ä¼˜</span>
    <span class="hljs-keyword">if</span> (opCompactionInterval != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (lastOptimizedCompaction == <span class="hljs-literal">null</span>
                || currentTimeMillis() - lastOptimizedCompaction &gt; opCompactionInterval) {
            LOG.debug(<span class="hljs-string">"Universal compaction due to optimized compaction interval"</span>);
            updateLastOptimizedCompaction();
            <span class="hljs-keyword">return</span> Optional.of(CompactUnit.fromLevelRuns(maxLevel, runs));
        }
    }

    <span class="hljs-comment">// æ­¥2. ç©ºé—´æ”¾å¤§æ£€æŸ¥ï¼Œè°ƒpickForSizeAmp()ï¼Œè‹¥è¾¾åˆ°ç©ºé—´æ”¾å¤§è¾¹ç•Œï¼Œåˆ™è§¦å‘å…¨é‡å‹ç¼©</span>
    <span class="hljs-type">CompactUnit</span> <span class="hljs-variable">unit</span> <span class="hljs-operator">=</span> pickForSizeAmp(maxLevel, runs);
    <span class="hljs-keyword">if</span> (unit != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (LOG.isDebugEnabled()) {
            LOG.debug(<span class="hljs-string">"Universal compaction due to size amplification"</span>);
        }
        <span class="hljs-keyword">return</span> Optional.of(unit);
    }

    <span class="hljs-comment">// æ­¥3. ç›¸é‚»Sorted Runæ–‡ä»¶å¤§å°æ¯”ç‡æ£€æŸ¥ï¼Œè°ƒpickForSizeRatio()ï¼Œæ–‡ä»¶å°äºä¸€å®šæ¯”ç‡ï¼ŒåŠ å…¥éƒ¨åˆ†å‹ç¼©å•å…ƒï¼Œæœ€ç»ˆè§¦å‘éƒ¨åˆ†å‹ç¼©</span>
    unit = pickForSizeRatio(maxLevel, runs);
    <span class="hljs-keyword">if</span> (unit != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (LOG.isDebugEnabled()) {
            LOG.debug(<span class="hljs-string">"Universal compaction due to size ratio"</span>);
        }
        <span class="hljs-keyword">return</span> Optional.of(unit); <span class="hljs-comment">// éƒ¨åˆ†å‹ç¼©</span>
    }

    <span class="hljs-comment">// æ­¥4. Sorted Runæ–‡ä»¶æ•°é‡æ£€æŸ¥ï¼Œè¶…è¿‡numRunCompactionTriggeræ•°é‡ï¼Œåˆ™è¿˜éœ€è¦ç»“åˆæ–‡ä»¶æ¯”ç‡å»è¿›è¡Œç­›é€‰éƒ¨åˆ†å‹ç¼©å•å…ƒï¼Œæœ€ç»ˆè§¦å‘éƒ¨åˆ†å‹ç¼©</span>
    <span class="hljs-keyword">if</span> (runs.size() &gt; numRunCompactionTrigger) {
        <span class="hljs-comment">// compacting for file num</span>
        <span class="hljs-comment">// è®¡ç®—è¦å‹ç¼©çš„æ–‡ä»¶æ•°=runs.size() - numRunCompactionTrigger + 1;</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">candidateCount</span> <span class="hljs-operator">=</span> runs.size() - numRunCompactionTrigger + <span class="hljs-number">1</span>;
        <span class="hljs-keyword">if</span> (LOG.isDebugEnabled()) {
            LOG.debug(<span class="hljs-string">"Universal compaction due to file num"</span>);
        }
        <span class="hljs-keyword">return</span> Optional.ofNullable(pickForSizeRatio(maxLevel, runs, candidateCount));
    }

    <span class="hljs-keyword">return</span> Optional.empty();
}
</code></pre>
<h4 data-id="heading-6">(3) <code>pickForSizeAmp()</code> -- ç©ºé—´æ”¾å¤§æ£€æŸ¥</h4>
<p>é»˜è®¤æƒ…å†µï¼Œé™¤äº†ä½ æœ€å¤§çš„runå¤–ï¼Œå…¶ä»–çš„runçš„å¤§å°å’Œå·²ç»è¶…è¿‡äº†æœ€å¤§runæ–‡ä»¶å¤§å°çš„<code>maxSizeAmp(é»˜è®¤æ˜¯200) / 100</code>å€äº†ï¼Œè¯´æ˜å·²ç»ç©ºé—´æ”¾å¤§äº†ï¼Œéœ€è¦å…¨é‡å‹ç¼©</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@VisibleForTesting</span>
CompactUnit <span class="hljs-title function_">pickForSizeAmp</span><span class="hljs-params">(<span class="hljs-type">int</span> maxLevel, List&lt;LevelSortedRun&gt; runs)</span> {
    <span class="hljs-comment">// å‰ç½®æ£€æŸ¥: run æ•°é‡å¿…é¡» &gt;= numRunCompactionTrigger</span>
    <span class="hljs-keyword">if</span> (runs.size() &lt; numRunCompactionTrigger) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-comment">// æ­¥éª¤ 1: è®¡ç®—é™¤æœ€åä¸€ä¸ª run å¤–çš„æ‰€æœ‰ run çš„æ€»å¤§å° -- candidateSize</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">candidateSize</span> <span class="hljs-operator">=</span>
            runs.subList(<span class="hljs-number">0</span>, runs.size() - <span class="hljs-number">1</span>).stream()
                    .map(LevelSortedRun::run)
                    .mapToLong(SortedRun::totalSize)
                    .sum();
    <span class="hljs-comment">// æ­¥éª¤ 2: è·å–æœ€åä¸€ä¸ª run çš„å¤§å° (é€šå¸¸æ˜¯æœ€å¤§ã€æœ€è€çš„æ–‡ä»¶) -- earliestRunSize</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">earliestRunSize</span> <span class="hljs-operator">=</span> runs.get(runs.size() - <span class="hljs-number">1</span>).run().totalSize();

    <span class="hljs-comment">// æ­¥éª¤ 3: è®¡ç®—ç©ºé—´æ”¾å¤§ç‡å¹¶åˆ¤æ–­æ˜¯å¦éœ€è¦è¿›è¡Œå…¨é‡å‹ç¼©</span>
    <span class="hljs-comment">// å…¬å¼: candidateSize * 100 &gt; maxSizeAmp * earliestRunSize</span>
    <span class="hljs-comment">// ç­‰ä»·äº: candidateSize / earliestRunSize &gt; maxSizeAmp(é»˜è®¤æ˜¯200) / 100</span>
    <span class="hljs-comment">// ä¹Ÿå°±æ˜¯è¯´é»˜è®¤æƒ…å†µï¼Œé™¤äº†ä½ æœ€å¤§çš„runï¼Œå…¶ä»–çš„runçš„å¤§å°å’Œå·²ç»è¶…è¿‡äº†æœ€å¤§runæ–‡ä»¶å¤§å°çš„2å€äº†ï¼Œè¯´æ˜å·²ç»ç©ºé—´æ”¾å¤§äº†ï¼Œéœ€è¦å…¨é‡å‹ç¼©</span>
    <span class="hljs-keyword">if</span> (candidateSize * <span class="hljs-number">100</span> &gt; maxSizeAmp * earliestRunSize) {
        updateLastOptimizedCompaction();
        <span class="hljs-keyword">return</span> CompactUnit.fromLevelRuns(maxLevel, runs);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h4 data-id="heading-7">(4) <code>pickForSizeRatio()</code> -- ç›¸é‚»æ–‡ä»¶æ¯”ç‡æ£€æŸ¥</h4>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä¸‹ä¸€ä¸ªSorted Runæ–‡ä»¶å¤§å° &lt;= ä¸‹ä¸€ä¸ªSorted Runå‰é¢æ‰€æœ‰æ–‡ä»¶çš„å¤§å°å’Œ * (<code>1 + sizeRatio(é»˜è®¤æ˜¯1)/100</code>)ï¼Œåˆ™å°†ä¸‹ä¸€ä¸ªRunæ–‡ä»¶åŠ å…¥åˆ°å€™é€‰é›†åˆä¸­</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@VisibleForTesting</span>
CompactUnit <span class="hljs-title function_">pickForSizeRatio</span><span class="hljs-params">(<span class="hljs-type">int</span> maxLevel, List&lt;LevelSortedRun&gt; runs)</span> {
    <span class="hljs-comment">// å‰ç½®æ£€æŸ¥: run æ•°é‡å¿…é¡» &gt;= numRunCompactionTrigger</span>
    <span class="hljs-keyword">if</span> (runs.size() &lt; numRunCompactionTrigger) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
    <span class="hljs-comment">// ä»ç¬¬ä¸€ä¸ªæ–‡ä»¶å¼€å§‹æ£€æŸ¥ï¼Œè°ƒpickForSizeRatioé‡è½½æ–¹æ³•</span>
    <span class="hljs-keyword">return</span> pickForSizeRatio(maxLevel, runs, <span class="hljs-number">1</span>);
}

<span class="hljs-keyword">private</span> CompactUnit <span class="hljs-title function_">pickForSizeRatio</span><span class="hljs-params">(
        <span class="hljs-type">int</span> maxLevel, List&lt;LevelSortedRun&gt; runs, <span class="hljs-type">int</span> candidateCount)</span> {
    <span class="hljs-comment">// æŒ‡å®šå€™é€‰æ–‡ä»¶æ•°é‡ï¼ŒforcePick = false</span>
    <span class="hljs-keyword">return</span> pickForSizeRatio(maxLevel, runs, candidateCount, <span class="hljs-literal">false</span>);
}

<span class="hljs-keyword">public</span> CompactUnit <span class="hljs-title function_">pickForSizeRatio</span><span class="hljs-params">(
        <span class="hljs-type">int</span> maxLevel, List&lt;LevelSortedRun&gt; runs, <span class="hljs-type">int</span> candidateCount, <span class="hljs-type">boolean</span> forcePick)</span> {
    <span class="hljs-comment">// æ­¥éª¤1: è®¡ç®—åˆå§‹å€™é€‰é›†åˆçš„æ€»å¤§å°</span>
    <span class="hljs-type">long</span> <span class="hljs-variable">candidateSize</span> <span class="hljs-operator">=</span> candidateSize(runs, candidateCount);
    
    <span class="hljs-comment">// æ­¥éª¤ 2: å°è¯•æ‰©å±•å€™é€‰é›†åˆ (å‘ååˆå¹¶æ›´å¤šæ–‡ä»¶), ä»éå€™é€‰æ–‡ä»¶å¼€å§‹æ£€æŸ¥æ˜¯å¦å¯ä»¥å°†åé¢æ›´å¤šçš„ Sort runs çº³å…¥å‹ç¼©èŒƒå›´</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> candidateCount; i &lt; runs.size(); i++) {
        <span class="hljs-type">LevelSortedRun</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> runs.get(i);
        <span class="hljs-comment">// æ­¥éª¤ 2.1: åˆ¤æ–­æ˜¯å¦åº”è¯¥åœæ­¢æ‰©å±•</span>
        <span class="hljs-comment">// æ¡ä»¶: å½“å‰å€™é€‰é›†åˆçš„æ–‡ä»¶æ€»å¤§å° * (1 + sizeRatio/100) &lt; ä¸‹ä¸€ä¸ª run å¤§å°ï¼Œåˆ™é€€å‡ºå¾ªç¯</span>
        <span class="hljs-comment">// ç›®çš„: é˜²æ­¢å°†è¿‡å¤§çš„æ–‡ä»¶çº³å…¥å‹ç¼©èŒƒå›´</span>
        <span class="hljs-keyword">if</span> (candidateSize * (<span class="hljs-number">100.0</span> + sizeRatio) / <span class="hljs-number">100.0</span> &lt; next.run().totalSize()) {
            <span class="hljs-keyword">break</span>;
        }
        <span class="hljs-comment">// æ­¥éª¤ 2.2: ç¬¦åˆæ¡ä»¶ï¼Œåˆ™å°†ä¸‹ä¸€ä¸ª run çº³å…¥å€™é€‰é›†åˆ</span>
        candidateSize += next.run().totalSize();
        candidateCount++;
    }

    <span class="hljs-comment">// æ­¥éª¤ 3: å¯¹å€™é€‰é›†åˆï¼Œè¿›è¡Œåˆ›å»ºå‹ç¼©å•å…ƒ</span>
    <span class="hljs-comment">// forcePick=true: å¼ºåˆ¶å‹ç¼© (å³ä½¿åªæœ‰ 1 ä¸ªæ–‡ä»¶) -- ç”±ForceUpLevel0Compactionç­–ç•¥ä¼ å…¥</span>
    <span class="hljs-comment">// forcePick=false: è‡³å°‘éœ€è¦ 2 ä¸ªæ–‡ä»¶æ‰å‹ç¼©</span>
    <span class="hljs-keyword">if</span> (forcePick || candidateCount &gt; <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">return</span> createUnit(runs, maxLevel, candidateCount);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h4 data-id="heading-8">(4) <code>candidateSize()</code></h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// è®¡ç®—è¦å‹ç¼©çš„å€™é€‰Sort Runçš„æ–‡ä»¶æ€»å¤§å°å’Œ</span>
<span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-title function_">candidateSize</span><span class="hljs-params">(List&lt;LevelSortedRun&gt; runs, <span class="hljs-type">int</span> candidateCount)</span> {
    <span class="hljs-type">long</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; candidateCount; i++) {
        size += runs.get(i).run().totalSize();
    }
    <span class="hljs-keyword">return</span> size;
}
</code></pre>
<h4 data-id="heading-9">(5) <code>createUnit()</code> -- åˆ›å»ºå‹ç¼©å•å…ƒ</h4>
<p>æµç¨‹å›¾å¦‚ä¸‹</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[createUnit å¼€å§‹] --&gt; B{runCount == runs.size?&lt;br/&gt;æ˜¯å¦å‹ç¼©æ‰€æœ‰æ–‡ä»¶?}
    B --&gt;|æ˜¯| C[outputLevel = maxLevel&lt;br/&gt;è¾“å‡ºåˆ°æœ€é«˜å±‚]
    B --&gt;|å¦| D[outputLevel = nextRun.level - 1&lt;br/&gt;è¾“å‡ºåˆ°ä¸‹ä¸€å±‚çš„å‰ä¸€å±‚]
    
    C --&gt; E{outputLevel == 0?}
    D --&gt; E
    
    E --&gt;|æ˜¯| F[å‘åæŸ¥æ‰¾ç¬¬ä¸€ä¸ªé Level 0 å±‚çº§&lt;br/&gt;å¹¶æ‰©å±•å‹ç¼©èŒƒå›´]
    E --&gt;|å¦| G{runCount == runs.size?&lt;br/&gt;æ‰©å±•åæ˜¯å¦åŒ…å«æ‰€æœ‰æ–‡ä»¶?}
    
    F --&gt; G
    G --&gt;|æ˜¯| H[outputLevel = maxLevel&lt;br/&gt;æ ‡è®°ä¸ºä¼˜åŒ–å‹ç¼©]
    G --&gt;|å¦| I[ä¿æŒå½“å‰ outputLevel]
    
    H --&gt; J[è¿”å› CompactUnitèŒƒå›´æ˜¯0åˆ°runCount]
    I --&gt; J
    
    style C fill:#fff9c4
    style H fill:#fff9c4

</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@VisibleForTesting</span>
CompactUnit <span class="hljs-title function_">createUnit</span><span class="hljs-params">(List&lt;LevelSortedRun&gt; runs, <span class="hljs-type">int</span> maxLevel, <span class="hljs-type">int</span> runCount)</span> {
    <span class="hljs-type">int</span> outputLevel;
    <span class="hljs-comment">// æ­¥1. åˆæ­¥ç¡®å®šå‹ç¼©åçš„è¾“å‡ºlevelå±‚çº§</span>
    <span class="hljs-keyword">if</span> (runCount == runs.size()) {
        <span class="hljs-comment">// æƒ…å†µ 1: å‹ç¼©æ‰€æœ‰æ–‡ä»¶ =&gt; è¾“å‡ºåˆ°æœ€é«˜å±‚</span>
        outputLevel = maxLevel;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æƒ…å†µ 2: éƒ¨åˆ†å‹ç¼© =&gt; è¾“å‡ºåˆ°ä¸‹ä¸€ä¸ª run çš„å‰ä¸€å±‚</span>
        <span class="hljs-comment">// å…¬å¼: outputLevel = max(0, nextRun.level - 1)</span>
        outputLevel = Math.max(<span class="hljs-number">0</span>, runs.get(runCount).level() - <span class="hljs-number">1</span>);
    }
    
    <span class="hljs-comment">// æ­¥2. å¤„ç†L0å±‚çš„æƒ…å†µ</span>
    <span class="hljs-keyword">if</span> (outputLevel == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// Level 0 ä¸åº”è¯¥æ˜¯è¾“å‡ºå±‚ (Level 0 æ˜¯ä¸´æ—¶å±‚)</span>
        <span class="hljs-comment">// éœ€è¦éå†æ‰€æœ‰çš„runs, å‘åæŸ¥æ‰¾ç¬¬ä¸€ä¸ªé Level 0 çš„å±‚çº§</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> runCount; i &lt; runs.size(); i++) {
            <span class="hljs-type">LevelSortedRun</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> runs.get(i);
            runCount++; <span class="hljs-comment">// æ‰©å±•å‹ç¼©èŒƒå›´</span>
            <span class="hljs-keyword">if</span> (next.level() != <span class="hljs-number">0</span>) { <span class="hljs-comment">// æ‰¾åˆ°ç¬¬ä¸€ä¸ªéL0å±‚çš„æ–‡ä»¶</span>
                outputLevel = next.level(); <span class="hljs-comment">// ä½¿ç”¨è¯¥å±‚çº§</span>
                <span class="hljs-keyword">break</span>;
            }
        }
    }
    <span class="hljs-comment">// æ­¥3. å¦‚æœæ‰©å±•åï¼Œéœ€è¦å‹ç¼©çš„æ˜¯æ‰€æœ‰æ–‡ä»¶ï¼Œæ ‡è®°ä¸ºä¼˜åŒ–å‹ç¼©ï¼Œæ›´æ”¹è¾“å‡ºå±‚çº§ä¸ºmaxLevel</span>
    <span class="hljs-keyword">if</span> (runCount == runs.size()) {
        updateLastOptimizedCompaction();
        outputLevel = maxLevel;
    }
    <span class="hljs-comment">// æ­¥4. åˆ›å»ºå¹¶è¿”å›å‹ç¼©å•å…ƒ(èŒƒå›´æ˜¯0åˆ°runCount)</span>
    <span class="hljs-keyword">return</span> CompactUnit.fromLevelRuns(outputLevel, runs.subList(<span class="hljs-number">0</span>, runCount));
}
</code></pre>
<h4 data-id="heading-10">(6) <code>updateLastOptimizedCompaction()</code>ç­‰è¾…åŠ©æ–¹æ³•</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">updateLastOptimizedCompaction</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// æ›´æ–°ä¸Šæ¬¡ä¼˜åŒ–å‹ç¼©çš„æ—¶é—´æˆ³ï¼Œç”¨äºè®¡ç®—ä¸‹æ¬¡ä¼˜åŒ–å‹ç¼©æ—¶é—´ã€‚</span>
    lastOptimizedCompaction = currentTimeMillis();
}

<span class="hljs-type">long</span> <span class="hljs-title function_">currentTimeMillis</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> System.currentTimeMillis();
}
</code></pre>
<h3 data-id="heading-11">2.æ€»ç»“</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant MCM as MergeTreeCompactManager
    participant UC as UniversalCompaction
    participant PFS as pickForSizeAmp
    participant PFR as pickForSizeRatio
    participant CU as createUnit
    
    MCM-&gt;&gt;UC: pick(numLevels, runs)
    
    UC-&gt;&gt;UC: 1. æ£€æŸ¥ä¼˜åŒ–å‹ç¼©æ—¶é—´é—´éš”
    alt è¾¾åˆ°æ—¶é—´é—´éš”
        UC--&gt;&gt;MCM: è¿”å›å…¨é‡å‹ç¼©å•å…ƒ
    else æœªè¾¾åˆ°
        UC-&gt;&gt;PFS: pickForSizeAmp()
        PFS-&gt;&gt;PFS: è®¡ç®—ç©ºé—´æ”¾å¤§ç‡
        alt è¶…è¿‡é˜ˆå€¼
            PFS--&gt;&gt;UC: è¿”å›å…¨é‡å‹ç¼©å•å…ƒ
            UC--&gt;&gt;MCM: è¿”å›å…¨é‡å‹ç¼©å•å…ƒ
        else æœªè¶…è¿‡
            UC-&gt;&gt;PFR: pickForSizeRatio()
            PFR-&gt;&gt;PFR: è®¡ç®—å¤§å°æ¯”ç‡å¹¶æ‰©å±•å€™é€‰
            alt æ‰¾åˆ°å€™é€‰
                PFR-&gt;&gt;CU: createUnit()
                CU-&gt;&gt;CU: ç¡®å®šè¾“å‡ºå±‚çº§
                CU--&gt;&gt;PFR: è¿”å›å‹ç¼©å•å…ƒ
                PFR--&gt;&gt;UC: è¿”å›éƒ¨åˆ†å‹ç¼©å•å…ƒ
                UC--&gt;&gt;MCM: è¿”å›éƒ¨åˆ†å‹ç¼©å•å…ƒ
            else æœªæ‰¾åˆ°
                UC-&gt;&gt;UC: æ£€æŸ¥æ–‡ä»¶æ•°é‡
                alt æ•°é‡è¶…æ ‡
                    UC-&gt;&gt;PFR: pickForSizeRatio(candidateCount)
                    PFR-&gt;&gt;CU: createUnit()
                    CU--&gt;&gt;PFR: è¿”å›å‹ç¼©å•å…ƒ
                    PFR--&gt;&gt;UC: è¿”å›éƒ¨åˆ†å‹ç¼©å•å…ƒ
                    UC--&gt;&gt;MCM: è¿”å›éƒ¨åˆ†å‹ç¼©å•å…ƒ
                else æ•°é‡æ­£å¸¸
                    UC--&gt;&gt;MCM: è¿”å› empty (ä¸å‹ç¼©)
                end
            end
        end
    end
</code></pre>








































<table><thead><tr><th>åˆ¤æ–­</th><th>æ–¹æ³•</th><th>è§¦å‘æ¡ä»¶</th><th>å‹ç¼©èŒƒå›´</th><th>ä¼˜å…ˆçº§</th></tr></thead><tbody><tr><td><strong>æ—¶é—´é—´éš”</strong></td><td>pick()</td><td>currentTime - lastOptimized &gt; interval</td><td>å…¨éƒ¨æ–‡ä»¶</td><td>P0 (æœ€é«˜)</td></tr><tr><td><strong>ç©ºé—´æ”¾å¤§</strong></td><td>pickForSizeAmp()</td><td>candidateSize / earliestSize &gt; maxSizeAmp%</td><td>å…¨éƒ¨æ–‡ä»¶</td><td>P1</td></tr><tr><td><strong>å¤§å°æ¯”ç‡</strong></td><td>pickForSizeRatio()</td><td>candidateSize * (1 + ratio%) &lt; nextSize</td><td>éƒ¨åˆ†æ–‡ä»¶</td><td>P2</td></tr><tr><td><strong>æ–‡ä»¶æ•°é‡</strong></td><td>pick()</td><td>runs.size &gt; trigger</td><td>å¤šä½™æ–‡ä»¶</td><td>P3 (æœ€ä½)</td></tr></tbody></table>
<h2 data-id="heading-12">ä¸‰.ForceUpLevel0Compaction -- å¼ºåˆ¶L0å±‚å‹ç¼©ç­–ç•¥</h2>
<p>è¯¥ç±»é’ˆå¯¹çš„æ˜¯éœ€è¦lookupä¼˜åŒ–çš„ç­–ç•¥ï¼Œè°ƒç”¨æƒ…å†µå¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f6c73c04480f4022a56bb1689ed5db46~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZXhwZWN0N2c=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298409&amp;x-signature=r13oAnQbwt0V4q7SO%2FXr37zKtJo%3D" alt="image.png" loading="lazy"/></p>
<p>è¯¦æƒ…è¯·çœ‹ï¼š<a href="https://juejin.cn/post/7582872365522501670" target="_blank" title="https://juejin.cn/post/7582872365522501670">Paimonæºç è§£è¯» -- Compaction-4.KeyValueFileStoreWriteå‰</a></p>
<p>ä¸ºä»€ä¹ˆè¦æœ‰è¿™ä¸ªç­–ç•¥å‘¢ï¼Ÿ</p>
<p>ç­”æ¡ˆï¼šåœ¨ NeedLookup åœºæ™¯ä¸‹ï¼ˆå¦‚ <code>merge-engine=first-row</code>ã€<code>deletion-vectors</code> æˆ– <code>changelog=lookup</code>ï¼‰ï¼Œå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">é—®é¢˜åˆ†æ:
  Level 0: File1, File2, File3, File4, File5 (5 ä¸ªå°æ–‡ä»¶)
  Level 1: File6 (1 ä¸ªå¤§æ–‡ä»¶ï¼Œ500 MB)
  
  Lookup æŸ¥è¯¢æµç¨‹:
    1. æŸ¥è¯¢ <span class="hljs-attr">key</span>=<span class="hljs-string">"user_001"</span>
    2. ä¾æ¬¡åœ¨ File1 â†’ File2 â†’ File3 â†’ File4 â†’ File5 ä¸­æŸ¥æ‰¾
    3. å¦‚æœéƒ½æ²¡æ‰¾åˆ°ï¼Œå†å» File6 ä¸­æŸ¥æ‰¾
    
  æ€§èƒ½ç“¶é¢ˆ:
    - Level 0 æ–‡ä»¶è¶Šå¤šï¼ŒæŸ¥æ‰¾æ¬¡æ•°è¶Šå¤š
    - æ¯æ¬¡æŸ¥æ‰¾éƒ½éœ€è¦è¯»å–æ–‡ä»¶ç´¢å¼•ï¼ˆBloomFilterã€RocksDB ç´¢å¼•ï¼‰
    - å³ä½¿æœ‰ç´¢å¼•ï¼Œå¤šä¸ªæ–‡ä»¶çš„ç´¢å¼•æŸ¥æ‰¾å¼€é”€ä»ç„¶å¾ˆå¤§

å› æ­¤ï¼Œå¿…é¡»è¦å¯¹L0å±‚æ–‡ä»¶è¿›è¡Œå¼ºåˆ¶å‹ç¼©ï¼Œä»è€Œè¾¾åˆ°è¯»æ€§èƒ½ä¼˜åŒ–
</code></pre>
<h3 data-id="heading-13">1.ä»£ç è§£æ</h3>
<h4 data-id="heading-14">(1) æ ¸å¿ƒå˜é‡å’Œæ„é€ å‡½æ•°</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æ ¸å¿ƒæˆå‘˜: åŒ…è£…çš„ UniversalCompaction å®ä¾‹</span>
<span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UniversalCompaction universal;
<span class="hljs-comment">// æ„é€ å‡½æ•°: æ¥æ”¶ä¸€ä¸ª UniversalCompaction å®ä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-title function_">ForceUpLevel0Compaction</span><span class="hljs-params">(UniversalCompaction universal)</span> {
    <span class="hljs-built_in">this</span>.universal = universal;
}
</code></pre>
<h4 data-id="heading-15">(2) <code>pick()</code> -- ç­–ç•¥æ ¸å¿ƒ</h4>
<p>å…¶è°ƒç”¨æµç¨‹å¦‚ä¸‹</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TD
    A[ForceUpLevel0Compaction.pick å¼€å§‹] --&gt; B[æ­¥éª¤1: è°ƒç”¨ universal.pick]
    
    B --&gt; C{universal æ˜¯å¦&lt;br/&gt;è¿”å›äº†å‹ç¼©å•å…ƒ?}
    
    C --&gt;|æ˜¯| D[ç›´æ¥è¿”å› universal çš„ç»“æœ&lt;br/&gt;ä½¿ç”¨æ ‡å‡†å‹ç¼©ç­–ç•¥]
    
    C --&gt;|å¦| E[æ­¥éª¤2: æ”¶é›†æ‰€æœ‰ Level 0 æ–‡ä»¶]
    
    E --&gt; F[éå† runs åˆ—è¡¨&lt;br/&gt;ç»Ÿè®¡ Level 0 æ–‡ä»¶æ•°é‡]
    
    F --&gt; G{Level 0 æ–‡ä»¶æ•°é‡ &gt; 0?}
    
    G --&gt;|å¦| H[è¿”å› empty&lt;br/&gt;ä¸æ‰§è¡Œå‹ç¼©]
    
    G --&gt;|æ˜¯| I[æ­¥éª¤3: è°ƒç”¨ universal.pickForSizeRatio&lt;br/&gt;forcePick=true]
    
    I --&gt; J[åˆ›å»ºå‹ç¼©å•å…ƒ&lt;br/&gt;å¼ºåˆ¶å‹ç¼©æ‰€æœ‰ Level 0 æ–‡ä»¶]
    
    J --&gt; K[è¿”å›å‹ç¼©å•å…ƒ]
    
    style D fill:#c8e6c9
    style H fill:#ffcdd2
    style K fill:#fff9c4
</code></pre>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> Optional&lt;CompactUnit&gt; <span class="hljs-title function_">pick</span><span class="hljs-params">(<span class="hljs-type">int</span> numLevels, List&lt;LevelSortedRun&gt; runs)</span> {
    <span class="hljs-comment">// æ­¥éª¤ 1: ä¼˜å…ˆä½¿ç”¨ UniversalCompaction çš„åˆ¤æ–­</span>
    Optional&lt;CompactUnit&gt; pick = universal.pick(numLevels, runs);
    <span class="hljs-comment">// å¦‚æœ UniversalCompaction å·²ç»é€‰ä¸­äº†éœ€è¦å‹ç¼©çš„æ–‡ä»¶ï¼Œç›´æ¥è¿”å›</span>
    <span class="hljs-comment">// è¯´æ˜: æ ‡å‡†ç­–ç•¥å·²ç»è§¦å‘ï¼Œæ— éœ€é¢å¤–å¤„ç†</span>
    <span class="hljs-keyword">if</span> (pick.isPresent()) {
        <span class="hljs-keyword">return</span> pick;
    }

    <span class="hljs-comment">// collect all level 0 files</span>
    <span class="hljs-comment">// æ­¥éª¤ 2: é’ˆå¯¹UniversalCompaction æœªè§¦å‘ï¼Œæ”¶é›†å…¨éƒ¨çš„ Level 0 æ–‡ä»¶</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">candidateCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> candidateCount; i &lt; runs.size(); i++) {
        <span class="hljs-keyword">if</span> (runs.get(i).level() &gt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">break</span>;
        }
        candidateCount++;
    }
    <span class="hljs-comment">// æ­¥éª¤ 3: å¦‚æœæ”¶é›†çš„æ–‡ä»¶ä¸­ï¼Œæœ‰ Level 0 æ–‡ä»¶ï¼Œå¼ºåˆ¶å‹ç¼©ï¼Œè°ƒçš„è¿˜æ˜¯UniversalCompaction.pickForSizeRatio()ï¼Œåªä¸è¿‡ä¼ å…¥forcePiceä¸ºtrue</span>
    <span class="hljs-keyword">return</span> candidateCount == <span class="hljs-number">0</span>
            ? Optional.empty()
            : Optional.of(
                    universal.pickForSizeRatio(numLevels - <span class="hljs-number">1</span>, runs, candidateCount, <span class="hljs-literal">true</span>));
}
</code></pre>
<h2 data-id="heading-16">ä¸‰.é€‚ç”¨åœºæ™¯</h2>
<p>é’ˆå¯¹UniversalCompactionç­–ç•¥çš„å‡ ç§å‡è¡¡æ–¹æ¡ˆ</p>






























<table><thead><tr><th>è´Ÿè½½ç±»å‹</th><th>è°ƒä¼˜ç›®æ ‡</th><th>å‚æ•°é…ç½®å»ºè®®</th></tr></thead><tbody><tr><td><strong>å†™å¯†é›†</strong></td><td>é™ä½å†™æ”¾å¤§</td><td>maxSizeAmp=300, numTrigger=10, ratio=1</td></tr><tr><td><strong>è¯»å¯†é›†</strong></td><td>é™ä½è¯»æ”¾å¤§</td><td>maxSizeAmp=150, numTrigger=3, ratio=0.5</td></tr><tr><td><strong>ç©ºé—´æ•æ„Ÿ</strong></td><td>èŠ‚çœå­˜å‚¨</td><td>maxSizeAmp=100, interval=30min</td></tr><tr><td><strong>æ··åˆè´Ÿè½½</strong></td><td>å¹³è¡¡æ€§èƒ½</td><td>ä½¿ç”¨é»˜è®¤å€¼ (200, 5, 1)</td></tr></tbody></table>
<p>é’ˆå¯¹ä¸åŒMerge Engieçš„æ¨èå‹ç¼©ç­–ç•¥æ–¹æ¡ˆ</p>



































<table><thead><tr><th>Merge Engine</th><th>æ˜¯å¦éœ€è¦ Lookup</th><th>æ¨èç­–ç•¥</th><th>åŸå› </th></tr></thead><tbody><tr><td><strong>deduplicate</strong></td><td>å¦</td><td>UniversalCompaction</td><td>è¯»å–æ•´ä¸ªæ–‡ä»¶ï¼ŒLevel 0 æ•°é‡å½±å“è¾ƒå°</td></tr><tr><td><strong>first-row</strong></td><td>æ˜¯</td><td>ForceUpLevel0Compaction</td><td>éœ€è¦å¿«é€ŸæŸ¥æ‰¾ç¬¬ä¸€æ¡è®°å½•</td></tr><tr><td><strong>partial-update</strong></td><td>æ˜¯</td><td>ForceUpLevel0Compaction</td><td>éœ€è¦æŸ¥æ‰¾æ‰€æœ‰ç‰ˆæœ¬åˆå¹¶</td></tr><tr><td><strong>aggregation</strong></td><td>å¦</td><td>UniversalCompaction</td><td>è¯»å–æ•´ä¸ªæ–‡ä»¶èšåˆï¼ŒLevel 0 æ•°é‡å½±å“è¾ƒå°</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Day01-API]]></title>    <link>https://juejin.cn/post/7583325044232634394</link>    <guid>https://juejin.cn/post/7583325044232634394</guid>    <pubDate>2025-12-14T06:26:14.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583325044232634394" data-draft-id="7582152511537102889" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Day01-API  "/> <meta itemprop="keywords" content="JavaScript"/> <meta itemprop="datePublished" content="2025-12-14T06:26:14.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç˜¦çš„å¯ä»¥ä¸‹é¥­äº†"/> <meta itemprop="url" content="https://juejin.cn/user/895474817042060"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Day01-API  
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/895474817042060/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç˜¦çš„å¯ä»¥ä¸‹é¥­äº†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:26:14.000Z" title="Sun Dec 14 2025 06:26:14 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.å˜é‡å£°æ˜</h2>
<blockquote>
<p>1.<strong>ä¼˜å…ˆé€‰æ‹©const</strong></p>
<ol start="2">
<li><strong>å»ºè®®æ•°ç»„å’Œå¯¹è±¡éƒ½ç”¨constæ¥å£°æ˜</strong></li>
</ol>
</blockquote>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00d5cff5f2084988b6914171fcc343c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=OXiHYVLmrgnFBLbZazlHFhjSovs%3D" alt="image.png" width="80%" loading="lazy"/>    
<h3 data-id="heading-1">1.1 å¼•ç”¨æ•°æ®ç±»å‹ä¿®æ”¹ä»å¯ç”¨const</h3>
<blockquote>
<p>åªè¦åœ°å€ä¸ä¿®æ”¹ï¼Œå®ƒä¹Ÿä¸ä¼šæŠ¥é”™</p>
</blockquote>
<pre><code class="hljs language-js" lang="js">&lt;script&gt;
        <span class="hljs-number">1.</span>æ•°ç»„å³ä½¿è¿½åŠ ä¹Ÿå¯ä»¥å®šä¹‰æˆ<span class="hljs-keyword">const</span>
        å› ä¸ºæ•°ç»„åœ°å€æ²¡å˜
        <span class="hljs-keyword">const</span> arr = [<span class="hljs-string">'èè'</span>,<span class="hljs-string">'vv'</span>]
        arr.<span class="hljs-title function_">push</span>(<span class="hljs-string">'é‘«é‘«'</span>)
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr);
        ä¸‹é¢è¿™æ ·ä¼šæŠ¥é”™,å› ä¸ºè¿™æ ·å­æ˜¯å¼€è¾Ÿäº†ä¸€ä¸ªæ–°åœ°å€ï¼Œå¹¶ä¸”èµ‹ç»™äº†arr
        arr = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(arr);       
    &lt;/script&gt;
</code></pre>
<h2 data-id="heading-2">2.APIä½œç”¨ä¸åˆ†ç±»</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8d18a32eb9dc4d1fb3aaccbad2504210~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=VSv8T5G6c5QFYdt1o4WNkIQsxcU%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-3">3.ä»€ä¹ˆæ˜¯DOM</h2>
<blockquote>
<p>Document Object Model----æ–‡æ¡£å¯¹è±¡æ¨¡å‹</p>
<p><strong>ä½œç”¨</strong>ï¼šé€šè¿‡jsæ“ä½œç½‘é¡µå†…å®¹ï¼Œå®ç°ç”¨æˆ·æ”¾çºµ</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5b66a7dc1107438db2589a347b7d506e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=W4Q9uld%2B6ix33n1FR47ETMnGLog%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-4">4.DOMæ ‘</h2>
<blockquote>
<p>documentæ˜¯DOMæä¾›çš„ä¸€ä¸ªå¯¹è±¡,ç½‘é¡µä¸­æ‰€æœ‰å†…å®¹éƒ½åœ¨documenté‡Œé¢
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b76e35ead9a24daabb04d9c2da0ebf56~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=cpLAxth60DtkU6aacDvixhC5TRk%3D" alt="image.png" loading="lazy"/></p>
</blockquote>
<h2 data-id="heading-5">5.DOMå¯¹è±¡ï¼ˆé‡è¦ï¼‰</h2>
<blockquote>
<p>htmlçš„æ ‡ç­¾   jsè·å–åå°±å˜æˆäº†å¯¹è±¡</p>
<p>æ ¸å¿ƒï¼šæŠŠå†…å®¹å½“å¯¹è±¡å¤„ç†</p>
</blockquote>
<h2 data-id="heading-6">6.è·å–DOMå¯¹è±¡</h2>
<blockquote>
<p>1.æ ¹æ®CSSé€‰æ‹©å™¨æ¥è·å–DOMå…ƒç´ ï¼ˆé‡ç‚¹ï¼‰</p>
<p>2.å…¶ä»–è·å–DOMå…ƒç´ çš„æ–¹æ³•ï¼ˆäº†è§£ï¼‰</p>
</blockquote>
<h3 data-id="heading-7">6.1 åˆ©ç”¨cssé€‰æ‹©å™¨æ¥è·å–</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/57a5e326502c4081af9ab9623a320ae3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=%2B0eKy75IaQKoxKnjNg5O8sDppAE%3D" alt="image.png" width="70%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/462624cd446340d8a9689aca42cb64e9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=bgYfGOsa7MTe%2BNglPwL2GBEHqYU%3D" alt="image.png" width="70%" loading="lazy"/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/437779819b804d96afcc0ccd4aa6730f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=fHpL4vbn%2FVndWep4T3a4qDNLvOY%3D" alt="image.png" width="70%" loading="lazy"/>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.box</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
        }
        <span class="hljs-selector-id">#nav</span> {
            <span class="hljs-attribute">background-color</span>: pink;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>123<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>456<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"nav"</span>&gt;</span>å¯¼èˆªæ <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å•¦å•¦å•¦1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å•¦å•¦å•¦2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å•¦å•¦å•¦3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// 1. è·å–åŒ¹é…çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span>
    <span class="hljs-keyword">const</span> box1 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'div'</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(box1)
    <span class="hljs-keyword">const</span> box2 = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'box'</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(box2)
    <span class="hljs-comment">// idé€‰æ‹©å™¨ä¸€å®šè¦åŠ #å·</span>
    <span class="hljs-keyword">const</span> nav = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#nav'</span>)
    nav.<span class="hljs-property">style</span>.<span class="hljs-property">background</span> = <span class="hljs-string">'green'</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(nav);
    <span class="hljs-comment">// è·å–ç¬¬ä¸€ä¸ªli</span>
    <span class="hljs-keyword">const</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'ul li:first-child'</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(li);

    <span class="hljs-comment">//2.é€‰æ‹©æ‰€æœ‰çš„å°li</span>
    <span class="hljs-keyword">const</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'ul li'</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(lis);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>  
</code></pre>
<ul>
<li>éå†å¾—åˆ°çš„ä¼ªæ•°ç»„</li>
</ul>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.box</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
        }
        <span class="hljs-selector-id">#nav</span> {
            <span class="hljs-attribute">background-color</span>: pink;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>123<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>456<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"nav"</span>&gt;</span>å¯¼èˆªæ <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"nav"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å•¦å•¦å•¦1<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å•¦å•¦å•¦2<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>å•¦å•¦å•¦3<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// éå†è¿™ä¸ªä¼ªæ•°ç»„</span>
        <span class="hljs-keyword">const</span> lis = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'.nav li'</span>)
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; lis.<span class="hljs-property">length</span>; i++){
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(lis[i])
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 data-id="heading-8">6.2 å…¶ä»–æ–¹æ³•</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8e15de20da4f4e8f83a5923bd78cf954~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=03x7ku2aFLb8REhSKhs56FTB2S4%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-9">7.æ“ä½œå…ƒç´ çš„å†…å®¹</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/459db5cae12745d3a047decde744ae1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=LdOgB2HyWFjP0Avle8tS39ke91Q%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-10">7.1 å¯¹è±¡.innerTextå±æ€§</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23ee7aacd1d54cac86d7227805a3d58f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=ljMrdCm0xNIeAdJWW%2FruOjZMtyU%3D" alt="image.png" width="70%" loading="lazy"/>
<pre><code class="hljs language-js" lang="js">    &lt;script&gt;
        <span class="hljs-comment">// 1.è·å–å…ƒç´ </span>
        <span class="hljs-keyword">const</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.box'</span>)
        <span class="hljs-comment">// 2.ä¿®æ”¹æ–‡å­—å†…å®¹</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(box.<span class="hljs-property">innerText</span>)
        box.<span class="hljs-property">innerText</span> = <span class="hljs-string">'æˆ‘æ˜¯èè'</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(box.<span class="hljs-property">innerText</span>);
    &lt;/script&gt;
</code></pre>
<h3 data-id="heading-11">7.2 å¯¹è±¡.innerHTMLå±æ€§</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92c0261587854689a9d9c988e87419af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=DeWOCxvpzcPgrAhqmQXJZupSUuE%3D" alt="image.png" width="70%" loading="lazy"/>
<h3 data-id="heading-12">7.3 å¹´ä¼šæŠ½å¥–æ¡ˆä¾‹</h3>
<pre><code class="hljs language-js" lang="js">&lt;script&gt;
    <span class="hljs-comment">// 1.å£°æ˜æ•°ç»„</span>
    <span class="hljs-keyword">const</span> arr = [<span class="hljs-string">'èè'</span>,<span class="hljs-string">'vv'</span>,<span class="hljs-string">'é‘«é‘«'</span>,<span class="hljs-string">'å¤§ä¼Ÿ'</span>,<span class="hljs-string">'å¤å“¥'</span>]
    <span class="hljs-comment">// 2.éšæœºç”Ÿæˆä¸€ä¸ªæ•°å­—</span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++){
        <span class="hljs-keyword">let</span> random = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()*arr.<span class="hljs-property">length</span>)
        <span class="hljs-comment">// è·å–è¿™ä¸ªå…ƒç´ å¹¶ä¿®æ”¹</span>
        <span class="hljs-keyword">if</span>(i === <span class="hljs-number">0</span>){
            <span class="hljs-keyword">const</span> span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.wrapper #one'</span>)
            span.<span class="hljs-property">innerText</span> = arr[random]
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(i=== <span class="hljs-number">1</span>){
            <span class="hljs-keyword">const</span> span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.wrapper #two'</span>)
            span.<span class="hljs-property">innerText</span> = arr[random]
        }<span class="hljs-keyword">else</span>{
            <span class="hljs-keyword">const</span> span = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.wrapper #three'</span>)
            span.<span class="hljs-property">innerText</span> = arr[random]
        }
        arr.<span class="hljs-title function_">splice</span>(random,<span class="hljs-number">1</span>)
        
    }
  &lt;/script&gt;
</code></pre>
<h2 data-id="heading-13">8.æ“ä½œå…ƒç´ å±æ€§</h2>
<h3 data-id="heading-14">8.1 æ“ä½œå…ƒç´ å¸¸ç”¨å±æ€§hrefã€srcã€title</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b291ed0a22814a229738557d6e81ee7a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=DdSdBvgTtscuTKPkjgNXYEwo1oM%3D" alt="image.png" width="70%" loading="lazy"/>
<h4 data-id="heading-15">8.1.1 éšæœºåˆ·æ–°å›¾ç‰‡æ¡ˆåˆ—</h4>
<pre><code class="hljs language-js" lang="js">&lt;body&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./images/1.webp"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getRandom</span>(<span class="hljs-params">min, max</span>) {
            <span class="hljs-comment">// å…ˆå¤„ç†è¾¹ç•Œï¼šå¦‚æœmin &gt; maxï¼Œäº¤æ¢ä¸¤è€…</span>
            <span class="hljs-keyword">if</span> (min &gt; max) [min, max] = [max, min];
            <span class="hljs-comment">// æ ¸å¿ƒå…¬å¼ï¼šMath.floor(Math.random() * (max - min + 1)) + min</span>
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (max - min + <span class="hljs-number">1</span>)) + min;
        }
        <span class="hljs-comment">// 1.è·å–å›¾ç‰‡å¯¹è±¡</span>
        <span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'img'</span>)  
        <span class="hljs-comment">// 2.ä¿®æ”¹å›¾ç‰‡çš„srcå±æ€§</span>
        <span class="hljs-keyword">const</span> random = <span class="hljs-title function_">getRandom</span>(<span class="hljs-number">1</span>,<span class="hljs-number">6</span>)

        img.<span class="hljs-property">src</span> = <span class="hljs-string">`./images/<span class="hljs-subst">${random}</span>.webp`</span>
        img.<span class="hljs-property">title</span> = <span class="hljs-string">'è¿™å°±æ˜¯ä½ å•Š'</span> 

    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-16">8.2 æ“ä½œå…ƒç´ æ ·å¼å±æ€§</h3>
<h4 data-id="heading-17">8.2.1 é€šè¿‡styleä¿®æ”¹</h4>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/652e3c1ea31344c5b712f5f57728229e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=eV8uM9bfO1fdlSPR5LgWgbepvt0%3D" alt="image.png" width="70%" loading="lazy"/>
<blockquote>
<ol>
<li>bodyçš„æ ·å¼å°±ä¸éœ€è¦è·å–äº†ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºbodyæ˜¯å”¯ä¸€çš„</li>
</ol>
<p>2.cssä¸­é‡åˆ°bckground-imageè¿™ç§ï¼Œç”¨å°é©¼å³°è§£å†³ï¼Œå†™æˆbackgroundImage</p>
</blockquote>
<pre><code class="hljs language-js" lang="js">&lt;body&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// 1.è·å–å…ƒç´ </span>
        <span class="hljs-keyword">const</span> box = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.box'</span>)
        <span class="hljs-comment">// 2.ä¿®æ”¹æ ·å¼å±æ€§,åˆ«å¿˜äº†åŠ å•ä½</span>
        box.<span class="hljs-property">style</span>.<span class="hljs-property">width</span> = <span class="hljs-string">'300px'</span>
        <span class="hljs-comment">// é‡åˆ°cssæ€»-çš„å‘½åæ–¹å¼ï¼Œç”¨å°é©¼å³°å‘½åæ³•è§£å†³</span>
        box.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = <span class="hljs-string">'blue'</span>
        <span class="hljs-comment">// åŠ è¾¹æ¡†</span>
        box.<span class="hljs-property">style</span>.<span class="hljs-property">border</span> = <span class="hljs-string">'2px solid red'</span>
        box.<span class="hljs-property">style</span>.<span class="hljs-property">borderTop</span> = <span class="hljs-string">'5px solid pink'</span>
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
&lt;/body&gt;
</code></pre>
<pre><code class="hljs language-js" lang="js">&lt;script&gt;
        <span class="hljs-comment">// å› ä¸ºbodyæ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦è·å–</span>
        <span class="hljs-keyword">function</span> <span class="hljs-title function_">getRandom</span>(<span class="hljs-params">min, max</span>) {
            <span class="hljs-comment">// å…ˆå¤„ç†è¾¹ç•Œï¼šå¦‚æœmin &gt; maxï¼Œäº¤æ¢ä¸¤è€…</span>
            <span class="hljs-keyword">if</span> (min &gt; max) [min, max] = [max, min];
            <span class="hljs-comment">// æ ¸å¿ƒå…¬å¼ï¼šMath.floor(Math.random() * (max - min + 1)) + min</span>
            <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * (max - min + <span class="hljs-number">1</span>)) + min;
        }
        <span class="hljs-keyword">const</span> random = <span class="hljs-title function_">getRandom</span>(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>)
        <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundImage</span> = <span class="hljs-string">`url(./images/desktop_<span class="hljs-subst">${random}</span>.jpg)`</span>
        
    &lt;/script&gt;
</code></pre>
<h4 data-id="heading-18">8.2.2 é€šè¿‡classNameæ¥ä¿®æ”¹</h4>
<blockquote>
<p>å¥½å¤„ï¼šç®€æ´
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/afe10fc2dead43708ad2f85c21d7f07c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=1EMvpkxtR3t1A%2BOviY6kLbl4XqM%3D" alt="image.png" loading="lazy"/></p>
</blockquote>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Document<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-tag">div</span> {
            <span class="hljs-attribute">height</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
            <span class="hljs-attribute">background-color</span>: pink;
        }
        <span class="hljs-selector-class">.nav</span> {
            <span class="hljs-attribute">color</span>: red;
        }

        <span class="hljs-selector-class">.box</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">300px</span>;
            <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
            <span class="hljs-attribute">background-color</span>: skyblue;
            <span class="hljs-attribute">margin</span>: <span class="hljs-number">20px</span> auto;
            <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#000</span>;
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"nav"</span>&gt;</span>å¯çˆ±èè<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
        <span class="hljs-comment">// 1.è·å–å…ƒç´ </span>
        <span class="hljs-keyword">const</span> div = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'div'</span>)
        <span class="hljs-comment">// 2.æ·»åŠ ç±»å,å¹¶ä¸”ä¼šè¦†ç›–å‰é¢çš„ç±»å‹</span>
        div.<span class="hljs-property">className</span> = <span class="hljs-string">'box'</span>
        <span class="hljs-comment">// 3.å¦‚æœæƒ³ä¿ç•™ä¹‹å‰çš„ç±»åï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•</span>
        div.<span class="hljs-property">className</span> = <span class="hljs-string">'nav box'</span>
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-19">8.2.3 é€šè¿‡classListæ“ä½œç±»æ§åˆ¶css</h4>
<blockquote>
<p>è¿™ä¸ªæ˜¯ç”¨çš„æœ€å¤šçš„
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/186cbaaff4724efb825f971217feb422~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=dj8ad3ScR1uTCUwNbw075dySRvg%3D" alt="image.png" loading="lazy"/></p>
</blockquote>
<h4 data-id="heading-20">8.2.4 éšæœºåˆ‡æ¢è½®æ’­å›¾</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>è½®æ’­å›¾ç‚¹å‡»åˆ‡æ¢<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    * {
      <span class="hljs-attribute">box-sizing</span>: border-box;
    }

    <span class="hljs-selector-class">.slider</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">560px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">400px</span>;
      <span class="hljs-attribute">overflow</span>: hidden;
    }

    <span class="hljs-selector-class">.slider-wrapper</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">320px</span>;
    }

    <span class="hljs-selector-class">.slider-wrapper</span> <span class="hljs-selector-tag">img</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
      <span class="hljs-attribute">display</span>: block;
    }

    <span class="hljs-selector-class">.slider-footer</span> {
      <span class="hljs-attribute">height</span>: <span class="hljs-number">80px</span>;
      <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">100</span>, <span class="hljs-number">67</span>, <span class="hljs-number">68</span>);
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">12px</span> <span class="hljs-number">12px</span> <span class="hljs-number">0</span> <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">position</span>: relative;
    }

    <span class="hljs-selector-class">.slider-footer</span> <span class="hljs-selector-class">.toggle</span> {
      <span class="hljs-attribute">position</span>: absolute;
      <span class="hljs-attribute">right</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">top</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">display</span>: flex;
    }

    <span class="hljs-selector-class">.slider-footer</span> <span class="hljs-selector-class">.toggle</span> <span class="hljs-selector-tag">button</span> {
      <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">width</span>: <span class="hljs-number">28px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">28px</span>;
      appearance: none;
      <span class="hljs-attribute">border</span>: none;
      <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.1</span>);
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
      <span class="hljs-attribute">cursor</span>: pointer;
    }

    <span class="hljs-selector-class">.slider-footer</span> <span class="hljs-selector-class">.toggle</span> <span class="hljs-selector-tag">button</span><span class="hljs-selector-pseudo">:hover</span> {
      <span class="hljs-attribute">background</span>: <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.2</span>);
    }

    <span class="hljs-selector-class">.slider-footer</span> <span class="hljs-selector-tag">p</span> {
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">18px</span>;
      <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">10px</span>;
    }

    <span class="hljs-selector-class">.slider-indicator</span> {
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
      <span class="hljs-attribute">list-style</span>: none;
      <span class="hljs-attribute">display</span>: flex;
      <span class="hljs-attribute">align-items</span>: center;
    }

    <span class="hljs-selector-class">.slider-indicator</span> <span class="hljs-selector-tag">li</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">8px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">8px</span>;
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">4px</span>;
      <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
      <span class="hljs-attribute">background</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.4</span>;
      <span class="hljs-attribute">cursor</span>: pointer;
    }

    <span class="hljs-selector-class">.slider-indicator</span> <span class="hljs-selector-tag">li</span><span class="hljs-selector-class">.active</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">height</span>: <span class="hljs-number">12px</span>;
      <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
    }
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"slider"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"slider-wrapper"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./images/slider01.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"slider-footer"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å¯¹äººç±»æ¥è¯´ä¼šä¸ä¼šå¤ªè¶…å‰äº†ï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"slider-indicator"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"toggle"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"prev"</span>&gt;</span><span class="hljs-symbol">&amp;lt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"next"</span>&gt;</span><span class="hljs-symbol">&amp;gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-comment">// 1. åˆå§‹æ•°æ®ï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°ç»„å¯¹è±¡</span>
    <span class="hljs-keyword">const</span> sliderData = [
      { <span class="hljs-attr">url</span>: <span class="hljs-string">'./images/slider01.jpg'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'å¯¹äººç±»æ¥è¯´ä¼šä¸ä¼šå¤ªè¶…å‰äº†ï¼Ÿ'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(100, 67, 68)'</span> },
      { <span class="hljs-attr">url</span>: <span class="hljs-string">'./images/slider02.jpg'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'å¼€å¯å‰‘ä¸é›ªçš„é»‘æš—ä¼ è¯´ï¼'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(43, 35, 26)'</span> },
      { <span class="hljs-attr">url</span>: <span class="hljs-string">'./images/slider03.jpg'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'çœŸæ­£çš„joå¨å‡ºç°äº†ï¼'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(36, 31, 33)'</span> },
      { <span class="hljs-attr">url</span>: <span class="hljs-string">'./images/slider04.jpg'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'æç‰åˆšï¼šè®©ä¸–ç•Œé€šè¿‡Bç«™çœ‹åˆ°ä¸œæ–¹å¤§å›½æ–‡åŒ–'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(139, 98, 66)'</span> },
      { <span class="hljs-attr">url</span>: <span class="hljs-string">'./images/slider05.jpg'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'å¿«æ¥åˆ†äº«ä½ çš„å¯’å‡æ—¥å¸¸å§~'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(67, 90, 92)'</span> },
      { <span class="hljs-attr">url</span>: <span class="hljs-string">'./images/slider06.jpg'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'å“”å“©å“”å“©å°å¹´YEAH'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(166, 131, 143)'</span> },
      { <span class="hljs-attr">url</span>: <span class="hljs-string">'./images/slider07.jpg'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'ä¸€ç«™å¼è§£å†³ä½ çš„ç”µè„‘é…ç½®é—®é¢˜ï¼ï¼ï¼'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(53, 29, 25)'</span> },
      { <span class="hljs-attr">url</span>: <span class="hljs-string">'./images/slider08.jpg'</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">'è°ä¸æƒ³å’Œå°çŒ«å’ªè´´è´´å‘¢ï¼'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(99, 72, 114)'</span> },
    ]
    <span class="hljs-comment">// 2.éœ€è¦ä¸€ä¸ªéšæœºæ•°</span>
    <span class="hljs-keyword">const</span> random = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * sliderData.<span class="hljs-property">length</span>)
    <span class="hljs-comment">// 3.è·å–å›¾ç‰‡</span>
    <span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.slider-wrapper img'</span>)
    <span class="hljs-comment">// 4.ä¿®æ”¹å›¾ç‰‡è·¯å¾„</span>
    img.<span class="hljs-property">src</span> = sliderData[random].<span class="hljs-property">url</span>
    <span class="hljs-comment">// 5.è·å–æ–‡å­—</span>
    <span class="hljs-keyword">const</span> text = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.slider-footer p'</span>)
    <span class="hljs-comment">// 6.ä¿®æ”¹æ–‡å­—å†…å®¹</span>
    text.<span class="hljs-property">innerHTML</span> = sliderData[random].<span class="hljs-property">title</span>
    <span class="hljs-comment">// 7.ä¿®æ”¹åº•éƒ¨é¢œè‰²,æ‹¬å·é‡Œé¢è¦å†™cssé€‰æ‹©å™¨</span>
    <span class="hljs-keyword">const</span> footer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.slider-footer'</span>)
    footer.<span class="hljs-property">style</span>.<span class="hljs-property">backgroundColor</span> = sliderData[random].<span class="hljs-property">color</span>

    <span class="hljs-comment">// 8.ä¿®æ”¹åº•éƒ¨å°åœ†ç‚¹é«˜äº®ç‰¹æ•ˆ</span>
    <span class="hljs-keyword">const</span> li = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`.slider-indicator li:nth-child(<span class="hljs-subst">${random+<span class="hljs-number">1</span>}</span>)`</span>)
    li.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'active'</span>)
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span> 
</code></pre>
<h3 data-id="heading-21">8.3 æ“ä½œè¡¨å•å…ƒç´ å±æ€§</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b226b26c46e548168c0e61c0b8196af2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55im55qE5Y-v5Lul5LiL6aWt5LqG:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298374&amp;x-signature=Rgk%2BUIdFk5uk%2FepQKyMtvGVs590%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Springäº‹ä»¶æœºåˆ¶ï¼šè§£è€¦åˆ©å™¨ä¸å®æˆ˜]]></title>    <link>https://juejin.cn/post/7583225356904382504</link>    <guid>https://juejin.cn/post/7583225356904382504</guid>    <pubDate>2025-12-14T06:31:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583225356904382504" data-draft-id="7582919147640897588" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" Springäº‹ä»¶æœºåˆ¶ï¼šè§£è€¦åˆ©å™¨ä¸å®æˆ˜"/> <meta itemprop="keywords" content="Spring"/> <meta itemprop="datePublished" content="2025-12-14T06:31:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             Springäº‹ä»¶æœºåˆ¶ï¼šè§£è€¦åˆ©å™¨ä¸å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:31:52.000Z" title="Sun Dec 14 2025 06:31:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Springäº‹ä»¶æœºåˆ¶ï¼šè§£è€¦åˆ©å™¨ä¸å®æˆ˜</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/84d170ff2e7143e39aa9739fd2124548~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298711&amp;x-signature=YtGmN1MaiRwDmOpCNGAQqGGxJTE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆéœ€è¦äº‹ä»¶æœºåˆ¶ï¼Ÿ</h3>
<p>åœ¨ä¼ ç»Ÿçš„ä¸šåŠ¡å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ä¼ ç»Ÿæ–¹å¼ï¼šå¼ºè€¦åˆ</span>
<span class="hljs-keyword">@Service</span>
public class OrderService {

    <span class="hljs-keyword">@Autowired</span>
    private EmailService emailService;

    <span class="hljs-keyword">@Autowired</span>
    private SmsService smsService;

    <span class="hljs-keyword">@Autowired</span>
    private InventoryService inventoryService;

    <span class="hljs-keyword">@Autowired</span>
    private PointsService pointsService;

    public void <span class="hljs-built_in">createOrder</span>(Order order) {
        <span class="hljs-comment">// 1. ä¿å­˜è®¢å•</span>
        orderRepository<span class="hljs-selector-class">.save</span>(order);

        <span class="hljs-comment">// 2. å‘é€é‚®ä»¶</span>
        emailService<span class="hljs-selector-class">.sendOrderConfirmation</span>(order);

        <span class="hljs-comment">// 3. å‘é€çŸ­ä¿¡</span>
        smsService<span class="hljs-selector-class">.sendNotification</span>(order);

        <span class="hljs-comment">// 4. æ‰£å‡åº“å­˜</span>
        inventoryService<span class="hljs-selector-class">.deductStock</span>(order);

        <span class="hljs-comment">// 5. å¢åŠ ç§¯åˆ†</span>
        pointsService<span class="hljs-selector-class">.addPoints</span>(order.getUserId(), <span class="hljs-attribute">order</span><span class="hljs-selector-class">.getAmount</span>());
    }
}
</code></pre>
<p><strong>è¿™ç§æ–¹å¼å­˜åœ¨ä¸¥é‡é—®é¢˜ï¼š</strong></p>
<ul>
<li>å¼ºè€¦åˆï¼šOrderServiceä¾èµ–å¤ªå¤šæœåŠ¡</li>
<li>éš¾ç»´æŠ¤ï¼šæ–°å¢ä¸šåŠ¡éœ€è¦ä¿®æ”¹OrderService</li>
<li>ä¸çµæ´»ï¼šæ— æ³•åŠ¨æ€æ·»åŠ /ç§»é™¤ä¸šåŠ¡é€»è¾‘</li>
<li>æ€§èƒ½å·®ï¼šæ‰€æœ‰æ“ä½œåŒæ­¥æ‰§è¡Œ</li>
</ul>
<p><strong>Springäº‹ä»¶æœºåˆ¶ä¼˜é›…åœ°è§£å†³äº†è¿™äº›é—®é¢˜ï¼</strong></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b82ae45215ee465585f07d6678c7d083~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298711&amp;x-signature=F2b%2Bc7hfJxe%2FWctNjFkkyX8UVg0%3D" alt="" loading="lazy"/></p>
<p>äºŒã€Springäº‹ä»¶æœºåˆ¶æ ¸å¿ƒæ¦‚å¿µ</p>
<p>Springäº‹ä»¶æœºåˆ¶åŸºäºè§‚å¯Ÿè€…æ¨¡å¼ï¼ŒåŒ…å«ä¸‰ä¸ªæ ¸å¿ƒè§’è‰²ï¼š</p>
<p><strong>1. äº‹ä»¶ï¼ˆEventï¼‰</strong></p>
<ul>
<li>ç»§æ‰¿<code>ApplicationEvent</code>çš„POJOç±»</li>
<li>æºå¸¦ä¸šåŠ¡æ•°æ®</li>
</ul>
<p><strong>2. äº‹ä»¶å‘å¸ƒè€…ï¼ˆPublisherï¼‰</strong></p>
<ul>
<li>é€šè¿‡<code>ApplicationEventPublisher</code>å‘å¸ƒäº‹ä»¶</li>
<li>é€šå¸¸æ˜¯ä¸šåŠ¡æœåŠ¡ç±»</li>
</ul>
<p><strong>3. äº‹ä»¶ç›‘å¬å™¨ï¼ˆListenerï¼‰</strong></p>
<ul>
<li>ä½¿ç”¨<code>@EventListener</code>æˆ–å®ç°<code>ApplicationListener</code></li>
<li>å¤„ç†ç‰¹å®šç±»å‹çš„äº‹ä»¶</li>
</ul>
<p><strong>å·¥ä½œæµç¨‹ï¼š</strong></p>
<pre><code class="hljs language-rust" lang="rust">å‘å¸ƒè€… --å‘å¸ƒäº‹ä»¶-<span class="hljs-punctuation">-&gt;</span> Springå®¹å™¨ --åˆ†å‘-<span class="hljs-punctuation">-&gt;</span> ç›‘å¬å™¨<span class="hljs-number">1</span>
                                  â””--åˆ†å‘-<span class="hljs-punctuation">-&gt;</span> ç›‘å¬å™¨<span class="hljs-number">2</span>
                                  â””--åˆ†å‘-<span class="hljs-punctuation">-&gt;</span> ç›‘å¬å™¨<span class="hljs-number">3</span>
</code></pre>
<h3 data-id="heading-2">ä¸‰ã€åŸºç¡€ä½¿ç”¨</h3>
<h3 data-id="heading-3">3.1 å®šä¹‰äº‹ä»¶</h3>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-comment">/**
 * è®¢å•åˆ›å»ºäº‹ä»¶
 */</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderCreatedEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>{

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Order</span> order;

    public <span class="hljs-type">OrderCreatedEvent</span>(<span class="hljs-type">Object</span> source, <span class="hljs-type">Order</span> order) {
        <span class="hljs-keyword">super</span>(source);
        <span class="hljs-keyword">this</span>.order = order;
    }

    public <span class="hljs-type">Order</span> getOrder() {
        <span class="hljs-keyword">return</span> order;
    }
}
</code></pre>
<h3 data-id="heading-4">3.2 å‘å¸ƒäº‹ä»¶</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">/**
 * è®¢å•æœåŠ¡ - äº‹ä»¶å‘å¸ƒè€…
 */</span>
<span class="hljs-keyword">@Service</span>
public class OrderService {

    private final ApplicationEventPublisher eventPublisher;
    private final OrderRepository orderRepository;

    public <span class="hljs-built_in">OrderService</span>(ApplicationEventPublisher eventPublisher,
                       OrderRepository orderRepository) {
        this<span class="hljs-selector-class">.eventPublisher</span> = eventPublisher;
        this<span class="hljs-selector-class">.orderRepository</span> = orderRepository;
    }

    public <span class="hljs-attribute">Order</span> <span class="hljs-built_in">createOrder</span>(OrderRequest request) {
        <span class="hljs-comment">// 1. æ ¸å¿ƒä¸šåŠ¡ï¼šä¿å­˜è®¢å•</span>
        <span class="hljs-attribute">Order</span> <span class="hljs-attribute">order</span> = new <span class="hljs-attribute">Order</span>();
        <span class="hljs-attribute">order</span><span class="hljs-selector-class">.setUserId</span>(request.getUserId());
        <span class="hljs-attribute">order</span><span class="hljs-selector-class">.setAmount</span>(request.getAmount());
        <span class="hljs-attribute">order</span> = orderRepository<span class="hljs-selector-class">.save</span>(order);

        <span class="hljs-comment">// 2. å‘å¸ƒäº‹ä»¶</span>
        eventPublisher<span class="hljs-selector-class">.publishEvent</span>(new OrderCreatedEvent(this, order));

        return <span class="hljs-attribute">order</span>;
    }
}
</code></pre>
<h3 data-id="heading-5">3.3 ç›‘å¬äº‹ä»¶</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">/**
 * é‚®ä»¶æœåŠ¡ - äº‹ä»¶ç›‘å¬å™¨
 */</span>
@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">EmailEventListener</span> {

    <span class="hljs-keyword">private</span> final EmailService emailService;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">EmailEventListener</span>(<span class="hljs-params">EmailService emailService</span>)</span> {
        <span class="hljs-keyword">this</span>.emailService = emailService;
    }

    @EventListener
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleOrderCreated</span>(<span class="hljs-params">OrderCreatedEvent <span class="hljs-keyword">event</span></span>)</span> {
        Order order = <span class="hljs-keyword">event</span>.getOrder();
        emailService.sendOrderConfirmation(order);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"é‚®ä»¶å·²å‘é€ï¼šè®¢å•å· "</span> + order.getId());
    }
}

<span class="hljs-comment">/**
 * çŸ­ä¿¡æœåŠ¡ - äº‹ä»¶ç›‘å¬å™¨
 */</span>
@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SmsEventListener</span> {

    <span class="hljs-keyword">private</span> final SmsService smsService;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">SmsEventListener</span>(<span class="hljs-params">SmsService smsService</span>)</span> {
        <span class="hljs-keyword">this</span>.smsService = smsService;
    }

    @EventListener
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleOrderCreated</span>(<span class="hljs-params">OrderCreatedEvent <span class="hljs-keyword">event</span></span>)</span> {
        Order order = <span class="hljs-keyword">event</span>.getOrder();
        smsService.sendNotification(order);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"çŸ­ä¿¡å·²å‘é€ï¼šè®¢å•å· "</span> + order.getId());
    }
}

<span class="hljs-comment">/**
 * åº“å­˜æœåŠ¡ - äº‹ä»¶ç›‘å¬å™¨
 */</span>
@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">InventoryEventListener</span> {

    <span class="hljs-keyword">private</span> final InventoryService inventoryService;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">InventoryEventListener</span>(<span class="hljs-params">InventoryService inventoryService</span>)</span> {
        <span class="hljs-keyword">this</span>.inventoryService = inventoryService;
    }

    @EventListener
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleOrderCreated</span>(<span class="hljs-params">OrderCreatedEvent <span class="hljs-keyword">event</span></span>)</span> {
        Order order = <span class="hljs-keyword">event</span>.getOrder();
        inventoryService.deductStock(order);
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"åº“å­˜å·²æ‰£å‡ï¼šè®¢å•å· "</span> + order.getId());
    }
}
</code></pre>
<p><strong>æ•ˆæœå¯¹æ¯”ï¼š</strong></p>
<ul>
<li>OrderServiceåªè´Ÿè´£æ ¸å¿ƒä¸šåŠ¡ï¼Œå®Œå…¨è§£è€¦</li>
<li>æ–°å¢ç›‘å¬å™¨æ— éœ€ä¿®æ”¹OrderService</li>
<li>ç›‘å¬å™¨å¯ä»¥åŠ¨æ€æ·»åŠ /ç§»é™¤</li>
</ul>
<h3 data-id="heading-6">å››ã€é«˜çº§ç‰¹æ€§</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/967aee0d0b974e9289fc9b09f57d1b5d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298711&amp;x-signature=DhSEWEWPXHKKCMeo3Awygi%2FF%2FiE%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">4.1 å¼‚æ­¥äº‹ä»¶</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œäº‹ä»¶æ˜¯åŒæ­¥å¤„ç†çš„ã€‚ä½¿ç”¨<code>@Async</code>å¯ä»¥å¼‚æ­¥å¤„ç†ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * å¼€å¯å¼‚æ­¥æ”¯æŒ
 */</span>
<span class="hljs-variable">@Configuration</span>
<span class="hljs-variable">@EnableAsync</span>
public class AsyncConfig {

    <span class="hljs-variable">@Bean</span>
    public Executor <span class="hljs-built_in">asyncExecutor</span>() {
        <span class="hljs-selector-tag">ThreadPoolTaskExecutor</span> <span class="hljs-selector-tag">executor</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">ThreadPoolTaskExecutor</span>();
        <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setCorePoolSize</span>(<span class="hljs-number">5</span>);
        <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setMaxPoolSize</span>(<span class="hljs-number">10</span>);
        <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setQueueCapacity</span>(<span class="hljs-number">100</span>);
        <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.setThreadNamePrefix</span>(<span class="hljs-string">"event-async-"</span>);
        <span class="hljs-selector-tag">executor</span><span class="hljs-selector-class">.initialize</span>();
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">executor</span>;
    }
}

<span class="hljs-comment">/**
 * å¼‚æ­¥ç›‘å¬å™¨
 */</span>
@<span class="hljs-selector-tag">Component</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">AsyncEventListener</span> {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Async</span>
    public void <span class="hljs-built_in">handleOrderCreatedAsync</span>(OrderCreatedEvent event) {
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å¼‚æ­¥å¤„ç†å¼€å§‹ï¼Œçº¿ç¨‹ï¼š"</span> + Thread.<span class="hljs-built_in">currentThread</span>().<span class="hljs-built_in">getName</span>());

        <span class="hljs-comment">// è€—æ—¶æ“ä½œ</span>
        <span class="hljs-selector-tag">try</span> {
            <span class="hljs-selector-tag">Thread</span><span class="hljs-selector-class">.sleep</span>(<span class="hljs-number">2000</span>);
        } <span class="hljs-selector-tag">catch</span> (InterruptedException e) {
            <span class="hljs-selector-tag">e</span><span class="hljs-selector-class">.printStackTrace</span>();
        }

        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å¼‚æ­¥å¤„ç†å®Œæˆ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-8">4.2 æ¡ä»¶ç›‘å¬</h3>
<p>ä½¿ç”¨SpELè¡¨è¾¾å¼å®ç°æ¡ä»¶ç›‘å¬ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">ConditionalEventListener</span> {

    <span class="hljs-comment">// åªå¤„ç†é‡‘é¢å¤§äº1000çš„è®¢å•</span>
    @EventListener(condition = <span class="hljs-string">"#event.order.amount &gt; 1000"</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleLargeOrder</span>(<span class="hljs-params">OrderCreatedEvent <span class="hljs-keyword">event</span></span>)</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å¤„ç†å¤§é¢è®¢å•ï¼š"</span> + <span class="hljs-keyword">event</span>.getOrder().getAmount());
    }

    <span class="hljs-comment">// åªå¤„ç†VIPç”¨æˆ·çš„è®¢å•</span>
    @EventListener(condition = <span class="hljs-string">"#event.order.userType == 'VIP'"</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">handleVipOrder</span>(<span class="hljs-params">OrderCreatedEvent <span class="hljs-keyword">event</span></span>)</span> {
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"å¤„ç†VIPè®¢å•"</span>);
    }
}
</code></pre>
<h3 data-id="heading-9">4.3 äº‹ä»¶ç›‘å¬é¡ºåº</h3>
<p>ä½¿ç”¨<code>@Order</code>æ§åˆ¶ç›‘å¬å™¨æ‰§è¡Œé¡ºåºï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderedEventListener</span> {

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-meta">@Order(1)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">firstListener</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"ç¬¬ä¸€ä¸ªæ‰§è¡Œ"</span>);
    }

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-meta">@Order(2)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">secondListener</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"ç¬¬äºŒä¸ªæ‰§è¡Œ"</span>);
    }

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-meta">@Order(3)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">thirdListener</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"ç¬¬ä¸‰ä¸ªæ‰§è¡Œ"</span>);
    }
}
</code></pre>
<h3 data-id="heading-10">4.4 æ³›å‹äº‹ä»¶</h3>
<p>Spring 4.2+æ”¯æŒæ³›å‹äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">/**
 * æ³›å‹äº‹ä»¶åŸºç±»
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntityEvent</span>&lt;T&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ApplicationEvent</span> {

    <span class="hljs-keyword">private</span> final T entity;
    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">EventType</span> <span class="hljs-keyword">type</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-title class_">EntityEvent</span>(<span class="hljs-title class_">Object</span> source, T entity, <span class="hljs-title class_">EventType</span> <span class="hljs-keyword">type</span>) {
        <span class="hljs-variable language_">super</span>(source);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">entity</span> = entity;
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> = <span class="hljs-keyword">type</span>;
    }

    <span class="hljs-keyword">public</span> T <span class="hljs-title function_">getEntity</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> entity;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title class_">EventType</span> <span class="hljs-title function_">getType</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">type</span>;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">EventType</span> {
        <span class="hljs-variable constant_">CREATED</span>, <span class="hljs-variable constant_">UPDATED</span>, <span class="hljs-variable constant_">DELETED</span>
    }
}

<span class="hljs-comment">/**
 * æ³›å‹ç›‘å¬å™¨
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenericEventListener</span> {

    <span class="hljs-comment">// åªç›‘å¬Userç±»å‹çš„åˆ›å»ºäº‹ä»¶</span>
    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handleUserCreated</span>(<span class="hljs-params">EntityEvent&lt;User&gt; event</span>) {
        <span class="hljs-keyword">if</span> (event.<span class="hljs-title function_">getType</span>() == <span class="hljs-title class_">EntityEvent</span>.<span class="hljs-property">EventType</span>.<span class="hljs-property">CREATED</span>) {
            <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"ç”¨æˆ·åˆ›å»ºï¼š"</span> + event.<span class="hljs-title function_">getEntity</span>().<span class="hljs-title function_">getName</span>());
        }
    }

    <span class="hljs-comment">// åªç›‘å¬Productç±»å‹çš„äº‹ä»¶</span>
    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handleProductEvent</span>(<span class="hljs-params">EntityEvent&lt;Product&gt; event</span>) {
        <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"äº§å“äº‹ä»¶ï¼š"</span> + event.<span class="hljs-title function_">getType</span>());
    }
}
</code></pre>
<h3 data-id="heading-11">4.5 äº‹åŠ¡äº‹ä»¶</h3>
<p>Springæä¾›äº†äº‹åŠ¡äº‹ä»¶ç›‘å¬ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TransactionalEventListener</span> {

    <span class="hljs-comment">// äº‹åŠ¡æäº¤åæ‰§è¡Œ</span>
    <span class="hljs-meta">@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleAfterCommit</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"äº‹åŠ¡å·²æäº¤ï¼Œå‘é€é€šçŸ¥"</span>);
    }

    <span class="hljs-comment">// äº‹åŠ¡å›æ»šåæ‰§è¡Œ</span>
    <span class="hljs-meta">@TransactionalEventListener(phase = TransactionPhase.AFTER_ROLLBACK)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleAfterRollback</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"äº‹åŠ¡å·²å›æ»šï¼Œè®°å½•æ—¥å¿—"</span>);
    }

    <span class="hljs-comment">// äº‹åŠ¡å®Œæˆåæ‰§è¡Œï¼ˆæ— è®ºæäº¤è¿˜æ˜¯å›æ»šï¼‰</span>
    <span class="hljs-meta">@TransactionalEventListener(phase = TransactionPhase.AFTER_COMPLETION)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleAfterCompletion</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"äº‹åŠ¡å·²å®Œæˆ"</span>);
    }

    <span class="hljs-comment">// äº‹åŠ¡æäº¤å‰æ‰§è¡Œ</span>
    <span class="hljs-meta">@TransactionalEventListener(phase = TransactionPhase.BEFORE_COMMIT)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleBeforeCommit</span><span class="hljs-params">(OrderCreatedEvent event)</span> {
        System.out.println(<span class="hljs-string">"äº‹åŠ¡å³å°†æäº¤"</span>);
    }
}
</code></pre>
<h3 data-id="heading-12">äº”ã€å®æˆ˜åº”ç”¨åœºæ™¯</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2bb70446de4458e91c3dc71ed3cdfc0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298711&amp;x-signature=A5xPRQ1BZQesKK%2B9XfkEEDsVmRk%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-13">5.1 ç”¨æˆ·æ³¨å†Œåœºæ™¯</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * ç”¨æˆ·æ³¨å†Œäº‹ä»¶
 */</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRegisteredEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ApplicationEvent</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> User user;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserRegisteredEvent</span><span class="hljs-params">(Object source, User user)</span> {
        <span class="hljs-built_in">super</span>(source);
        <span class="hljs-built_in">this</span>.user = user;
    }

    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> user;
    }
}

<span class="hljs-comment">/**
 * ç”¨æˆ·æœåŠ¡
 */</span>
<span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ApplicationEventPublisher eventPublisher;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserService</span><span class="hljs-params">(ApplicationEventPublisher eventPublisher,
                      UserRepository userRepository)</span> {
        <span class="hljs-built_in">this</span>.eventPublisher = eventPublisher;
        <span class="hljs-built_in">this</span>.userRepository = userRepository;
    }

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">registerUser</span><span class="hljs-params">(UserRegisterRequest request)</span> {
        <span class="hljs-comment">// 1. åˆ›å»ºç”¨æˆ·</span>
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();
        user.setUsername(request.getUsername());
        user.setEmail(request.getEmail());
        user.setPassword(encodePassword(request.getPassword()));
        user = userRepository.save(user);

        <span class="hljs-comment">// 2. å‘å¸ƒäº‹ä»¶</span>
        eventPublisher.publishEvent(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRegisteredEvent</span>(<span class="hljs-built_in">this</span>, user));

        <span class="hljs-keyword">return</span> user;
    }

    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">encodePassword</span><span class="hljs-params">(String password)</span> {
        <span class="hljs-comment">// å¯†ç åŠ å¯†é€»è¾‘</span>
        <span class="hljs-keyword">return</span> password;
    }
}

<span class="hljs-comment">/**
 * æ¬¢è¿é‚®ä»¶ç›‘å¬å™¨
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WelcomeEmailListener</span> {

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-meta">@Async</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendWelcomeEmail</span><span class="hljs-params">(UserRegisteredEvent event)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> event.getUser();
        <span class="hljs-comment">// å‘é€æ¬¢è¿é‚®ä»¶</span>
        System.out.println(<span class="hljs-string">"å‘é€æ¬¢è¿é‚®ä»¶ç»™ï¼š"</span> + user.getEmail());
    }
}

<span class="hljs-comment">/**
 * èµ é€æ–°äººç¤¼åŒ…ç›‘å¬å™¨
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NewUserGiftListener</span> {

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-meta">@Async</span>
    <span class="hljs-meta">@TransactionalEventListener(phase = TransactionPhase.AFTER_COMMIT)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">giveNewUserGift</span><span class="hljs-params">(UserRegisteredEvent event)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> event.getUser();
        <span class="hljs-comment">// èµ é€æ–°äººç¤¼åŒ…</span>
        System.out.println(<span class="hljs-string">"èµ é€æ–°äººç¤¼åŒ…ç»™ç”¨æˆ·ï¼š"</span> + user.getUsername());
    }
}

<span class="hljs-comment">/**
 * åˆå§‹åŒ–ç”¨æˆ·é…ç½®ç›‘å¬å™¨
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserConfigInitListener</span> {

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-meta">@Order(1)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initUserConfig</span><span class="hljs-params">(UserRegisteredEvent event)</span> {
        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> event.getUser();
        <span class="hljs-comment">// åˆå§‹åŒ–ç”¨æˆ·é…ç½®</span>
        System.out.println(<span class="hljs-string">"åˆå§‹åŒ–ç”¨æˆ·é…ç½®ï¼š"</span> + user.getId());
    }
}
</code></pre>
<h3 data-id="heading-14">5.2 æ–‡ç« å‘å¸ƒåœºæ™¯</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * æ–‡ç« å‘å¸ƒäº‹ä»¶
 */</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">ArticlePublishedEvent</span> <span class="hljs-selector-tag">extends</span> <span class="hljs-selector-tag">ApplicationEvent</span> {

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">Article</span> <span class="hljs-selector-tag">article</span>;

    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ArticlePublishedEvent</span>(Object source, Article article) {
        <span class="hljs-selector-tag">super</span>(source);
        <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.article</span> = <span class="hljs-selector-tag">article</span>;
    }

    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">Article</span> <span class="hljs-selector-tag">getArticle</span>() {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">article</span>;
    }
}

<span class="hljs-comment">/**
 * æ–‡ç« æœåŠ¡
 */</span>
@<span class="hljs-selector-tag">Service</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">ArticleService</span> {

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">ApplicationEventPublisher</span> <span class="hljs-selector-tag">eventPublisher</span>;

    @<span class="hljs-selector-tag">Transactional</span>
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">publishArticle</span>(Long articleId) {
        <span class="hljs-comment">// 1. æ›´æ–°æ–‡ç« çŠ¶æ€ä¸ºå·²å‘å¸ƒ</span>
        <span class="hljs-selector-tag">Article</span> <span class="hljs-selector-tag">article</span> = <span class="hljs-selector-tag">articleRepository</span><span class="hljs-selector-class">.findById</span>(articleId)<span class="hljs-selector-class">.orElseThrow</span>();
        <span class="hljs-selector-tag">article</span><span class="hljs-selector-class">.setStatus</span>(ArticleStatus.PUBLISHED);
        <span class="hljs-selector-tag">article</span><span class="hljs-selector-class">.setPublishTime</span>(LocalDateTime.<span class="hljs-built_in">now</span>());
        <span class="hljs-selector-tag">articleRepository</span><span class="hljs-selector-class">.save</span>(article);

        <span class="hljs-comment">// 2. å‘å¸ƒäº‹ä»¶</span>
        <span class="hljs-selector-tag">eventPublisher</span><span class="hljs-selector-class">.publishEvent</span>(new <span class="hljs-built_in">ArticlePublishedEvent</span>(this, article));
    }
}

<span class="hljs-comment">/**
 * æœç´¢ç´¢å¼•æ›´æ–°ç›‘å¬å™¨
 */</span>
@<span class="hljs-selector-tag">Component</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">SearchIndexListener</span> {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Async</span>
    <span class="hljs-variable">@TransactionalEventListener</span>(phase = TransactionPhase.AFTER_COMMIT)
    public void <span class="hljs-built_in">updateSearchIndex</span>(ArticlePublishedEvent event) {
        <span class="hljs-selector-tag">Article</span> <span class="hljs-selector-tag">article</span> = <span class="hljs-selector-tag">event</span><span class="hljs-selector-class">.getArticle</span>();
        <span class="hljs-comment">// æ›´æ–°ElasticSearchç´¢å¼•</span>
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æ›´æ–°æœç´¢ç´¢å¼•ï¼š"</span> + article.<span class="hljs-built_in">getTitle</span>());
    }
}

<span class="hljs-comment">/**
 * ç¼“å­˜é¢„çƒ­ç›‘å¬å™¨
 */</span>
@<span class="hljs-selector-tag">Component</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">CacheWarmUpListener</span> {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Async</span>
    public void <span class="hljs-built_in">warmUpCache</span>(ArticlePublishedEvent event) {
        <span class="hljs-selector-tag">Article</span> <span class="hljs-selector-tag">article</span> = <span class="hljs-selector-tag">event</span><span class="hljs-selector-class">.getArticle</span>();
        <span class="hljs-comment">// é¢„çƒ­Redisç¼“å­˜</span>
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"é¢„çƒ­ç¼“å­˜ï¼š"</span> + article.<span class="hljs-built_in">getId</span>());
    }
}

<span class="hljs-comment">/**
 * é€šçŸ¥è®¢é˜…è€…ç›‘å¬å™¨
 */</span>
@<span class="hljs-selector-tag">Component</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">SubscriberNotificationListener</span> {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Async</span>
    public void <span class="hljs-built_in">notifySubscribers</span>(ArticlePublishedEvent event) {
        <span class="hljs-selector-tag">Article</span> <span class="hljs-selector-tag">article</span> = <span class="hljs-selector-tag">event</span><span class="hljs-selector-class">.getArticle</span>();
        <span class="hljs-comment">// é€šçŸ¥è®¢é˜…è¯¥ä½œè€…çš„ç”¨æˆ·</span>
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"é€šçŸ¥è®¢é˜…è€…ï¼šæ–°æ–‡ç« ã€Š"</span> + article.<span class="hljs-built_in">getTitle</span>() + <span class="hljs-string">"ã€‹"</span>);
    }
}
</code></pre>
<h3 data-id="heading-15">5.3 æ”¯ä»˜æˆåŠŸåœºæ™¯</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">/**
 * æ”¯ä»˜æˆåŠŸäº‹ä»¶
 */</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">PaymentSuccessEvent</span> <span class="hljs-selector-tag">extends</span> <span class="hljs-selector-tag">ApplicationEvent</span> {

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">Payment</span> <span class="hljs-selector-tag">payment</span>;

    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">PaymentSuccessEvent</span>(Object source, Payment payment) {
        <span class="hljs-selector-tag">super</span>(source);
        <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.payment</span> = <span class="hljs-selector-tag">payment</span>;
    }

    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">Payment</span> <span class="hljs-selector-tag">getPayment</span>() {
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">payment</span>;
    }
}

<span class="hljs-comment">/**
 * æ”¯ä»˜æœåŠ¡
 */</span>
@<span class="hljs-selector-tag">Service</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">PaymentService</span> {

    <span class="hljs-selector-tag">private</span> <span class="hljs-selector-tag">final</span> <span class="hljs-selector-tag">ApplicationEventPublisher</span> <span class="hljs-selector-tag">eventPublisher</span>;

    @<span class="hljs-selector-tag">Transactional</span>
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">void</span> <span class="hljs-selector-tag">processPayment</span>(PaymentRequest request) {
        <span class="hljs-comment">// 1. å¤„ç†æ”¯ä»˜</span>
        <span class="hljs-selector-tag">Payment</span> <span class="hljs-selector-tag">payment</span> = <span class="hljs-selector-tag">new</span> <span class="hljs-selector-tag">Payment</span>();
        <span class="hljs-selector-tag">payment</span><span class="hljs-selector-class">.setOrderId</span>(request.<span class="hljs-built_in">getOrderId</span>());
        <span class="hljs-selector-tag">payment</span><span class="hljs-selector-class">.setAmount</span>(request.<span class="hljs-built_in">getAmount</span>());
        <span class="hljs-selector-tag">payment</span><span class="hljs-selector-class">.setStatus</span>(PaymentStatus.SUCCESS);
        <span class="hljs-selector-tag">paymentRepository</span><span class="hljs-selector-class">.save</span>(payment);

        <span class="hljs-comment">// 2. å‘å¸ƒäº‹ä»¶</span>
        <span class="hljs-selector-tag">eventPublisher</span><span class="hljs-selector-class">.publishEvent</span>(new <span class="hljs-built_in">PaymentSuccessEvent</span>(this, payment));
    }
}

<span class="hljs-comment">/**
 * è®¢å•çŠ¶æ€æ›´æ–°ç›‘å¬å™¨
 */</span>
@<span class="hljs-selector-tag">Component</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">OrderStatusUpdateListener</span> {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Order</span>(<span class="hljs-number">1</span>)
    <span class="hljs-variable">@TransactionalEventListener</span>(phase = TransactionPhase.AFTER_COMMIT)
    public void <span class="hljs-built_in">updateOrderStatus</span>(PaymentSuccessEvent event) {
        <span class="hljs-selector-tag">Payment</span> <span class="hljs-selector-tag">payment</span> = <span class="hljs-selector-tag">event</span><span class="hljs-selector-class">.getPayment</span>();
        <span class="hljs-comment">// æ›´æ–°è®¢å•çŠ¶æ€ä¸ºå·²æ”¯ä»˜</span>
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"æ›´æ–°è®¢å•çŠ¶æ€ï¼š"</span> + payment.<span class="hljs-built_in">getOrderId</span>());
    }
}

<span class="hljs-comment">/**
 * å‘è´§é€šçŸ¥ç›‘å¬å™¨
 */</span>
@<span class="hljs-selector-tag">Component</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">ShipmentListener</span> {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Order</span>(<span class="hljs-number">2</span>)
    <span class="hljs-variable">@Async</span>
    public void <span class="hljs-built_in">notifyWarehouse</span>(PaymentSuccessEvent event) {
        <span class="hljs-selector-tag">Payment</span> <span class="hljs-selector-tag">payment</span> = <span class="hljs-selector-tag">event</span><span class="hljs-selector-class">.getPayment</span>();
        <span class="hljs-comment">// é€šçŸ¥ä»“åº“å‘è´§</span>
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"é€šçŸ¥ä»“åº“å‘è´§ï¼šè®¢å•"</span> + payment.<span class="hljs-built_in">getOrderId</span>());
    }
}

<span class="hljs-comment">/**
 * ç§¯åˆ†å¥–åŠ±ç›‘å¬å™¨
 */</span>
@<span class="hljs-selector-tag">Component</span>
<span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">PointsRewardListener</span> {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Async</span>
    public void <span class="hljs-built_in">awardPoints</span>(PaymentSuccessEvent event) {
        <span class="hljs-selector-tag">Payment</span> <span class="hljs-selector-tag">payment</span> = <span class="hljs-selector-tag">event</span><span class="hljs-selector-class">.getPayment</span>();
        <span class="hljs-comment">// æ ¹æ®æ”¯ä»˜é‡‘é¢å¥–åŠ±ç§¯åˆ†</span>
        <span class="hljs-selector-tag">int</span> <span class="hljs-selector-tag">points</span> = <span class="hljs-selector-tag">payment</span><span class="hljs-selector-class">.getAmount</span>()<span class="hljs-selector-class">.intValue</span>() / <span class="hljs-number">10</span>;
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å¥–åŠ±ç§¯åˆ†ï¼š"</span> + points);
    }
}
</code></pre>
<h3 data-id="heading-16">å…­ã€ä¸æ¶ˆæ¯é˜Ÿåˆ—å¯¹æ¯”</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40d3bfa973d3488b93af97690cf22dbc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298711&amp;x-signature=jXvBmJCNVk5n9L38IAc%2BXNDiuk8%3D" alt="" loading="lazy"/></p>








































<table><thead><tr><th>ç‰¹æ€§</th><th>Springäº‹ä»¶æœºåˆ¶</th><th>æ¶ˆæ¯é˜Ÿåˆ—(RabbitMQ/Kafka)</th></tr></thead><tbody><tr><td>ä½œç”¨èŒƒå›´</td><td>å•åº”ç”¨å†…</td><td>è·¨åº”ç”¨ã€åˆ†å¸ƒå¼</td></tr><tr><td>æŒä¹…åŒ–</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>å¯é æ€§</td><td>ä¸€èˆ¬</td><td>é«˜</td></tr><tr><td>æ€§èƒ½</td><td>é«˜ï¼ˆå†…å­˜ï¼‰</td><td>ä¸­ç­‰ï¼ˆç½‘ç»œIOï¼‰</td></tr><tr><td>å­¦ä¹ æˆæœ¬</td><td>ä½</td><td>ä¸­ç­‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>åº”ç”¨å†…è§£è€¦</td><td>å¾®æœåŠ¡é—´é€šä¿¡</td></tr></tbody></table>
<p><strong>ä½¿ç”¨å»ºè®®ï¼š</strong></p>
<ul>
<li>å•ä½“åº”ç”¨å†…éƒ¨è§£è€¦ â†’ Springäº‹ä»¶æœºåˆ¶</li>
<li>å¾®æœåŠ¡é—´é€šä¿¡ â†’ æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>ä¸¤è€…å¯ä»¥ç»“åˆä½¿ç”¨</li>
</ul>
<h3 data-id="heading-17">ä¸ƒã€æœ€ä½³å®è·µ</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/453706174704420ea6cfbe7d06bfbbaf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298711&amp;x-signature=kghVh3fKyOYJEkq78tN8znNMPDQ%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-18">7.1 æ¨èåšæ³•</h3>
<p><strong>1. äº‹ä»¶å‘½åè§„èŒƒ</strong></p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-comment">// âœ… æ¨èï¼šä½¿ç”¨è¿‡å»å¼ï¼Œè¡¨ç¤ºå·²å‘ç”Ÿçš„äº‹ä»¶</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderCreatedEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>{ }
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PaymentSuccessEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>{ }
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegisteredEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>{ }

<span class="hljs-comment">// âŒ ä¸æ¨è</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateOrderEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>{ }
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PayEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>{ }
</code></pre>
<p><strong>2. äº‹ä»¶æ•°æ®å°è£…</strong></p>
<pre><code class="hljs language-scala" lang="scala"><span class="hljs-comment">// âœ… æ¨èï¼šå°è£…å¿…è¦çš„ä¸šåŠ¡æ•°æ®</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderCreatedEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Order</span> order;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Long</span> userId;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">LocalDateTime</span> createTime;

    <span class="hljs-comment">// æ„é€ å™¨ã€getter</span>
}

<span class="hljs-comment">// âŒ ä¸æ¨èï¼šåªä¼ é€’ID</span>
public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OrderCreatedEvent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ApplicationEvent</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Long</span> orderId;  <span class="hljs-comment">// ç›‘å¬å™¨éœ€è¦å†æŸ¥è¯¢æ•°æ®åº“</span>
}
</code></pre>
<p><strong>3. å¼‚æ­¥å¤„ç†éæ ¸å¿ƒä¸šåŠ¡</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// âœ… æ¨èï¼šéæ ¸å¿ƒä¸šåŠ¡å¼‚æ­¥å¤„ç†</span>
<span class="hljs-variable">@Component</span>
public class NotificationListener {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Async</span>
    public void <span class="hljs-built_in">sendNotification</span>(OrderCreatedEvent event) {
        <span class="hljs-comment">// å‘é€é€šçŸ¥æ˜¯éæ ¸å¿ƒä¸šåŠ¡ï¼Œå¼‚æ­¥å¤„ç†</span>
    }
}

<span class="hljs-comment">// âŒ ä¸æ¨èï¼šæ ¸å¿ƒä¸šåŠ¡å¼‚æ­¥å¤„ç†</span>
<span class="hljs-variable">@Component</span>
public class PaymentListener {

    <span class="hljs-variable">@EventListener</span>
    <span class="hljs-variable">@Async</span>  <span class="hljs-comment">// æ”¯ä»˜æ˜¯æ ¸å¿ƒä¸šåŠ¡ï¼Œä¸åº”å¼‚æ­¥</span>
    public void <span class="hljs-built_in">processPayment</span>(OrderCreatedEvent event) {
        <span class="hljs-comment">// å¤„ç†æ”¯ä»˜</span>
    }
}
</code></pre>
<p><strong>4. ä½¿ç”¨äº‹åŠ¡äº‹ä»¶ç›‘å¬</strong></p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// âœ… æ¨èï¼šéœ€è¦æ•°æ®åº“æŒä¹…åŒ–çš„æ“ä½œä½¿ç”¨äº‹åŠ¡äº‹ä»¶</span>
<span class="hljs-variable">@Component</span>
public class StockListener {

    <span class="hljs-variable">@TransactionalEventListener</span>(phase = TransactionPhase.AFTER_COMMIT)
    public void <span class="hljs-built_in">deductStock</span>(OrderCreatedEvent event) {
        <span class="hljs-comment">// ç¡®ä¿è®¢å•äº‹åŠ¡æäº¤åæ‰æ‰£å‡åº“å­˜</span>
    }
}

<span class="hljs-comment">// âŒ ä¸æ¨èï¼šå¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´</span>
<span class="hljs-variable">@Component</span>
public class StockListener {

    <span class="hljs-variable">@EventListener</span>
    public void <span class="hljs-built_in">deductStock</span>(OrderCreatedEvent event) {
        <span class="hljs-comment">// è®¢å•äº‹åŠ¡å¯èƒ½å›æ»šï¼Œä½†åº“å­˜å·²æ‰£å‡</span>
    }
}
</code></pre>
<h3 data-id="heading-19">7.2 é¿å…çš„é™·é˜±</h3>
<p><strong>1. é¿å…å¾ªç¯äº‹ä»¶</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ å±é™©ï¼šå¯èƒ½å¯¼è‡´æ— é™å¾ªç¯</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EventA</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">ApplicationEventPublisher</span> publisher;

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handleB</span>(<span class="hljs-params">EventB event</span>) {
        publisher.<span class="hljs-title function_">publishEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EventA</span>());  <span class="hljs-comment">// è§¦å‘EventA</span>
    }
}

<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EventB</span> {
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">ApplicationEventPublisher</span> publisher;

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handleA</span>(<span class="hljs-params">EventA event</span>) {
        publisher.<span class="hljs-title function_">publishEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">EventB</span>());  <span class="hljs-comment">// è§¦å‘EventBï¼Œå½¢æˆå¾ªç¯ï¼</span>
    }
}

<span class="hljs-comment">// âœ… è§£å†³æ–¹æ¡ˆï¼šæ·»åŠ é˜²é‡æ ‡è®°</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EventA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ApplicationEvent</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">boolean</span> processed = <span class="hljs-literal">false</span>;
}
</code></pre>
<p><strong>2. é¿å…ç›‘å¬å™¨ä¸­çš„é•¿æ—¶é—´é˜»å¡</strong></p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// âŒ ä¸æ¨èï¼šåŒæ­¥ç›‘å¬å™¨æ‰§è¡Œè€—æ—¶æ“ä½œ</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SlowListener</span> {

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">slowProcess</span>(<span class="hljs-params">OrderCreatedEvent event</span>) {
        <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">10000</span>);  <span class="hljs-comment">// é˜»å¡10ç§’</span>
        <span class="hljs-comment">// æ‰€æœ‰åç»­ç›‘å¬å™¨éƒ½è¦ç­‰å¾…</span>
    }
}

<span class="hljs-comment">// âœ… æ¨èï¼šè€—æ—¶æ“ä½œå¼‚æ­¥å¤„ç†</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastListener</span> {

    <span class="hljs-meta">@EventListener</span>
    <span class="hljs-meta">@Async</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">asyncProcess</span>(<span class="hljs-params">OrderCreatedEvent event</span>) {
        <span class="hljs-title class_">Thread</span>.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">10000</span>);  <span class="hljs-comment">// ä¸é˜»å¡å…¶ä»–ç›‘å¬å™¨</span>
    }
}
</code></pre>
<h3 data-id="heading-20">å…«ã€æ€§èƒ½ä¼˜åŒ–</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2065bb894b46499a9e71cbf2b19ed41b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298711&amp;x-signature=Yas8%2FGwBzwZA0WusZYDmsCEKMiw%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-21">8.1 ä½¿ç”¨å¼‚æ­¥å¤„ç†</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Configuration</span>
<span class="hljs-meta">@EnableAsync</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AsyncEventConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AsyncConfigurer</span> {

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">Executor</span> <span class="hljs-title function_">getAsyncExecutor</span>(<span class="hljs-params"/>) {
        <span class="hljs-title class_">ThreadPoolTaskExecutor</span> executor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolTaskExecutor</span>();
        executor.<span class="hljs-title function_">setCorePoolSize</span>(<span class="hljs-number">10</span>);
        executor.<span class="hljs-title function_">setMaxPoolSize</span>(<span class="hljs-number">20</span>);
        executor.<span class="hljs-title function_">setQueueCapacity</span>(<span class="hljs-number">200</span>);
        executor.<span class="hljs-title function_">setThreadNamePrefix</span>(<span class="hljs-string">"event-"</span>);
        executor.<span class="hljs-title function_">setRejectedExecutionHandler</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolExecutor</span>.<span class="hljs-title class_">CallerRunsPolicy</span>());
        executor.<span class="hljs-title function_">initialize</span>();
        <span class="hljs-keyword">return</span> executor;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-title class_">AsyncUncaughtExceptionHandler</span> <span class="hljs-title function_">getAsyncUncaughtExceptionHandler</span>(<span class="hljs-params"/>) {
        <span class="hljs-keyword">return</span> (ex, method, params) -&gt; {
            log.<span class="hljs-title function_">error</span>(<span class="hljs-string">"å¼‚æ­¥äº‹ä»¶å¤„ç†å¼‚å¸¸: method={}, params={}"</span>,
                     method.<span class="hljs-title function_">getName</span>(), <span class="hljs-title class_">Arrays</span>.<span class="hljs-title function_">toString</span>(params), ex);
        };
    }
}
</code></pre>
<h3 data-id="heading-22">8.2 æ‰¹é‡å¤„ç†äº‹ä»¶</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">/**
 * æ‰¹é‡å¤„ç†äº‹ä»¶
 */</span>
@Component
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">BatchEventProcessor</span> {

    <span class="hljs-keyword">private</span> final List&lt;OrderCreatedEvent&gt; eventQueue = <span class="hljs-keyword">new</span> CopyOnWriteArrayList&lt;&gt;();
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final <span class="hljs-built_in">int</span> BATCH_SIZE = <span class="hljs-number">100</span>;

    @EventListener
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">collectEvent</span>(<span class="hljs-params">OrderCreatedEvent <span class="hljs-keyword">event</span></span>)</span> {
        eventQueue.<span class="hljs-keyword">add</span>(<span class="hljs-keyword">event</span>);

        <span class="hljs-keyword">if</span> (eventQueue.size() &gt;= BATCH_SIZE) {
            processBatch();
        }
    }

    @Scheduled(fixedDelay = <span class="hljs-number">5000</span>)
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">processBatch</span>()</span> {
        <span class="hljs-keyword">if</span> (eventQueue.isEmpty()) {
            <span class="hljs-keyword">return</span>;
        }

        List&lt;OrderCreatedEvent&gt; batch = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;(eventQueue);
        eventQueue.clear();

        <span class="hljs-comment">// æ‰¹é‡å¤„ç†</span>
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"æ‰¹é‡å¤„ç† "</span> + batch.size() + <span class="hljs-string">" ä¸ªäº‹ä»¶"</span>);
    }
}
</code></pre>
<h3 data-id="heading-23">8.3 ç›‘æ§äº‹ä»¶å¤„ç†</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">/**
 * äº‹ä»¶å¤„ç†ç›‘æ§
 */</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EventListenerMonitor</span> {

    <span class="hljs-meta">@Around("@annotation(org.springframework.context.event.EventListener)")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">monitorEventListener</span><span class="hljs-params">(ProceedingJoinPoint pjp)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> pjp.getSignature().getName();
        <span class="hljs-type">long</span> <span class="hljs-variable">startTime</span> <span class="hljs-operator">=</span> System.currentTimeMillis();

        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> pjp.proceed();
            <span class="hljs-type">long</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - startTime;

            <span class="hljs-keyword">if</span> (duration &gt; <span class="hljs-number">1000</span>) {
                log.warn(<span class="hljs-string">"äº‹ä»¶ç›‘å¬å™¨æ‰§è¡Œç¼“æ…¢: method={}, duration={}ms"</span>,
                        methodName, duration);
            }

            <span class="hljs-keyword">return</span> result;
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"äº‹ä»¶ç›‘å¬å™¨æ‰§è¡Œå¤±è´¥: method={}"</span>, methodName, e);
            <span class="hljs-keyword">throw</span> e;
        }
    }
}
</code></pre>
<h3 data-id="heading-24">ä¹ã€æ€»ç»“</h3>
<p>Springäº‹ä»¶æœºåˆ¶æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è§£è€¦å·¥å…·ï¼Œåˆç†ä½¿ç”¨èƒ½å¤Ÿæ˜¾è‘—æå‡ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚</p>
<p><strong>æ ¸å¿ƒè¦ç‚¹ï¼š</strong></p>
<ol>
<li><strong>è§£è€¦ä¸šåŠ¡</strong>ï¼šå‘å¸ƒè€…å’Œç›‘å¬å™¨å®Œå…¨è§£è€¦</li>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šæ–°å¢ç›‘å¬å™¨æ— éœ€ä¿®æ”¹å‘å¸ƒè€…</li>
<li><strong>å¼‚æ­¥å¤„ç†</strong>ï¼šæ”¯æŒå¼‚æ­¥å¤„ç†æå‡æ€§èƒ½</li>
<li><strong>äº‹åŠ¡é›†æˆ</strong>ï¼šä¸Springäº‹åŠ¡æ— ç¼é›†æˆ</li>
</ol>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>âœ… å•ä½“åº”ç”¨å†…éƒ¨è§£è€¦</li>
<li>âœ… ä¸€å¯¹å¤šçš„ä¸šåŠ¡é€šçŸ¥</li>
<li>âœ… éæ ¸å¿ƒä¸šåŠ¡å¼‚æ­¥å¤„ç†</li>
<li>âœ… å®¡è®¡æ—¥å¿—ã€ç»Ÿè®¡åˆ†æ</li>
</ul>
<p><strong>ä¸é€‚ç”¨åœºæ™¯ï¼š</strong></p>
<ul>
<li>âŒ å¾®æœåŠ¡é—´é€šä¿¡ï¼ˆç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼‰</li>
<li>âŒ éœ€è¦æŒä¹…åŒ–çš„æ¶ˆæ¯ï¼ˆç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼‰</li>
<li>âŒ å¼ºä¸€è‡´æ€§è¦æ±‚ï¼ˆåŒæ­¥è°ƒç”¨ï¼‰</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘Šåˆ«YOLOv8ï¼å…¨é¢æ‹¥æŠ±YOLOv11ï¼šæœ€è´´å¿ƒçš„YOLOâ€œä¿å§†çº§â€æ•™ç¨‹]]></title>    <link>https://juejin.cn/post/7582904081864327209</link>    <guid>https://juejin.cn/post/7582904081864327209</guid>    <pubDate>2025-12-14T05:53:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582904081864327209" data-draft-id="7582958136257626148" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘Šåˆ«YOLOv8ï¼å…¨é¢æ‹¥æŠ±YOLOv11ï¼šæœ€è´´å¿ƒçš„YOLOâ€œä¿å§†çº§â€æ•™ç¨‹"/> <meta itemprop="keywords" content="è®¡ç®—æœºè§†è§‰"/> <meta itemprop="datePublished" content="2025-12-14T05:53:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Narrastory"/> <meta itemprop="url" content="https://juejin.cn/user/4355593566170010"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘Šåˆ«YOLOv8ï¼å…¨é¢æ‹¥æŠ±YOLOv11ï¼šæœ€è´´å¿ƒçš„YOLOâ€œä¿å§†çº§â€æ•™ç¨‹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4355593566170010/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Narrastory
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T05:53:15.000Z" title="Sun Dec 14 2025 05:53:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1å°æ—¶+
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‘Šåˆ«YOLOv8ï¼å…¨é¢æ‹¥æŠ±YOLOv11ï¼šæœ€è´´å¿ƒçš„YOLOâ€œä¿å§†çº§â€æ•™ç¨‹</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7fad48ad554d4bc6bd1b0d776fa427f7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=HE9T8Ce9XGzwh%2FOACjgo14ljF5I%3D" alt="GitHub" loading="lazy"/></p>
<blockquote>
<p><strong>Author</strong>ï¼šMing</p>
</blockquote>
<hr/>
<div align="center">
  <img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24f0b4909aff4ad4a5e599c019b1fe00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=2jc6%2F%2BXy7mfK7he6K62niSttkvo%3D" width="90%" loading="lazy"/>
</div>
<h3 data-id="heading-1">ä¸€. å‰è¨€</h3>
<p>ç›¸ä¿¡ç‚¹å¼€è¿™ç¯‡æ–‡ç« çš„ä½ ï¼Œå¤§æ¦‚ç‡æ­£é¢ä¸´ä¸€ä¸ªå®é™…çš„æœºå™¨è§†è§‰é¡¹ç›®ï¼Œéœ€è¦å¿«é€ŸæŒæ¡ä¸€ä¸ªé«˜æ•ˆå®ç”¨çš„ç›®æ ‡æ£€æµ‹å·¥å…·YOLOã€‚å› æ­¤ï¼Œæœ¬æ–‡ä¹Ÿä¸ä¼šè®²è§£è¯¦ç»†æ·±åº¦å­¦ä¹ åŸç†ï¼Œåªæ•™ä¼šä½ å¦‚ä½•ä½¿ç”¨å¥½è¿™ä¸ªYOLOï¼Œå¦‚ä½•å¿«é€Ÿä¸Šæ‰‹ã€è·‘é€šä»£ç ã€åšå‡ºä¸€äº›æˆæœï¼›å½“ç„¶ï¼Œè¿™å…¶ä¸­ä¸å¯é¿å…çš„ä¼šæ¶‰åŠåˆ°æ·±åº¦å­¦ä¹ æ–¹é¢çš„æœ¯è¯­ï¼Œä½†ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä¼šç”¨æœ€æ¸…æ™°æ˜“æ‡‚çš„æ–¹å¼ï¼Œä¸ºä½ è§£é‡Šé‚£äº›åŸºç¡€è€Œå…³é”®çš„æ¦‚å¿µã€‚</p>
<p>åœ¨å­¦ä¹ ä»»ä½•å·¥å…·ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—æ˜ç™½å®ƒç©¶ç«Ÿæ˜¯ä»€ä¹ˆã€‚ä¿—è¯è¯´ï¼šâ€œ<strong>å­¦å¿…å…ˆçŸ¥å…¶æœ¬</strong>â€ã€‚é‚£ä¹ˆï¼ŒYOLO åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå®ƒæ˜¯ä¸€ä¸ªè½¯ä»¶å—ï¼Ÿè¿˜æ˜¯ä¸€ä¸ªç®—æ³•ï¼Ÿ</p>
<p>ç®€å•æ¥è¯´ï¼ŒYOLOæ˜¯ä¸€ä¸ªå¼€æºçš„å·¥å…·åº“ï¼Œä½ å¯ä»¥å°†å…¶æƒ³è±¡æˆä¸€ä¸ªå·¥å…·ç®±ï¼Œé‡Œé¢æœ‰å¾ˆå¤šåˆ«äººå·²ç»åšå¥½çš„ç°æˆçš„å·¥å…·ï¼ˆç®—æ³•ï¼‰ï¼Œæƒ³è¦ä»€ä¹ˆè§†è§‰çš„å·¥å…·ï¼Œå°±æ‰“å¼€å·¥å…·ç®±ä»é‡Œé¢æ‹¿å‡ºæ¥ç”¨å°±è¡Œäº†ã€‚ç”¨ä»€ä¹ˆæ‹¿å‘¢ï¼Ÿå½“ç„¶æ˜¯ç”¨Pythonå•¦ã€‚åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬å°±ç”¨åŸºäº Python åº“å½¢å¼çš„ YOLOv11ï¼Œæ¥ç”¨Pythonæ•™å¤§å®¶å¦‚ä½•ä½¿ç”¨YOLOv11ã€‚æ³¨æ„ï¼Œè¿™éœ€è¦ä½ è‡³å°‘æœ‰ä¸€äº›pythonåŸºç¡€ï¼Œä½†ä¸å¿…æ‹…å¿ƒï¼Œè¿™é‡Œå¹¶ä¸ä¼šæ¶‰åŠè¿‡äºå¤æ‚çš„ç¼–ç¨‹æŠ€å·§ã€‚</p>
<p>YOLO è‡ªè¯ç”Ÿä»¥æ¥ï¼Œå·²ç»ç»å†äº†å¤šä¸ªç‰ˆæœ¬çš„è¿­ä»£ã€‚ç›®å‰ä¸»æµé¡¹ç›®ä¸­ä»å¸¸è§ YOLOv5 å’Œ YOLOv8 çš„èº«å½±ï¼Œå®ƒä»¬æˆç†Ÿç¨³å®šï¼Œç¤¾åŒºèµ„æºä¸°å¯Œã€‚ä½†éšç€æŠ€æœ¯çš„å¿«é€Ÿæ¼”è¿›ï¼Œæ›´å…ˆè¿›ä¼˜ç§€çš„ç®—æ³•å·²ç»å‡ºç°â€”â€”<strong>YOLOv11 æ­£æ˜¯å½“å‰å®˜æ–¹ä¸»æ¨çš„ç‰ˆæœ¬</strong>ï¼Œå®ƒåœ¨ç²¾åº¦ã€é€Ÿåº¦ä¸æ˜“ç”¨æ€§ä¹‹é—´å–å¾—äº†æ›´å¥½çš„å¹³è¡¡ã€‚</p>
<p>ä½ å¯èƒ½ä¼šé—®ï¼šç°åœ¨ä¸æ˜¯å·²ç»æœ‰æ¯” v11 æ›´åŠ å…ˆè¿›çš„ç‰ˆæœ¬äº†å—ï¼Ÿæ²¡é”™ï¼ŒYOLO çš„è¿­ä»£ç¡®å®éå¸¸è¿…é€Ÿï¼Œä½† <strong>YOLOv11 æ˜¯ç›®å‰è¢«å®˜æ–¹æ¨èã€æ–‡æ¡£æœ€å…¨ã€æœ€é€‚åˆæŠ•å…¥ç”Ÿäº§çš„ç¨³å®šç‰ˆæœ¬</strong>ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒYOLO å„ç‰ˆæœ¬ä¹‹é—´çš„æ¥å£è®¾è®¡éå¸¸æ¥è¿‘ï¼Œ<strong>åªè¦ä½ ç†Ÿç»ƒæŒæ¡å…¶ä¸­ä»»ä½•ä¸€ä¸ªï¼Œå…¶ä»–ç‰ˆæœ¬ä¹Ÿèƒ½è§¦ç±»æ—é€š</strong>ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå¦‚æœä½ å·²æœ‰æ·±åº¦å­¦ä¹ åŸºç¡€ï¼Œå¹¶ä¸”èƒ½ç†Ÿç»ƒä½¿ç”¨ PyTorchï¼Œé‚£ YOLO å¯¹ä½ è€Œè¨€æ›´åƒæ˜¯ä¸€ä¸ªå°è£…å¥½çš„è§†è§‰å·¥å…·ç®±â€”â€”ä½ å¯ä»¥ç›´æ¥æŸ¥é˜…<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.ultralytics.com%2Fzh%2F" target="_blank" title="https://docs.ultralytics.com/zh/" ref="nofollow noopener noreferrer">å®˜æ–¹æ–‡æ¡£</a>ï¼Œå¿«é€Ÿä¸Šæ‰‹ï¼Œæ— éœ€æ­¤ç¯‡æ•™ç¨‹ã€‚</p>
<hr/>
<p>é¦–å…ˆæ¥ç®€è¦ä»‹ç»ä¸€ä¸‹YOLOéƒ½èƒ½åšäº›ä»€ä¹ˆï¼Œç›¸ä¿¡åœ¨ä½ è¯»å®Œè¿™ç¯‡æ–‡ç« åï¼Œä½ ä¹Ÿèƒ½äº²æ‰‹è®­ç»ƒä¸€ä¸ªæ¨¡å‹æ¥è¾¾åˆ°ä¸‹é¢çš„æ•ˆæœï¼Œå¹¶ä¸”å°†å…¶åº”ç”¨åˆ°è‡ªå·±çš„å®é™…é¡¹ç›®ä¸­ã€‚</p>
<p>YOLOæœ€å‡ºåçš„å°±æ˜¯å®ƒçš„<strong>ç›®æ ‡æ£€æµ‹</strong>ï¼ˆObject Detectionï¼‰äº†ï¼Œä½ å¯ä»¥è®­ç»ƒä¸€ä¸ªæ¨¡å‹ï¼Œè®©å®ƒè¯†åˆ«å‡ºå›¾åƒä¸­ä½ æ„Ÿå…´è¶£çš„æ‰€æœ‰ç‰©ä½“ï¼Œå¹¶ä¸”å‘Šè¯‰ä½ æ¯ä¸ªç‰©ä½“çš„ä½ç½®åæ ‡å’Œå¤§å°ã€‚è¿™åœ¨å¾ˆå¤šä»»åŠ¡ä¸­éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚ç›‘æ§å®‰é˜²ã€è‡ªåŠ¨é©¾é©¶ï¼Œæ—¥å¸¸çš„å›¾åƒåˆ†æã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cbb7390d3e8b4e98986fdf8b93fdc776~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=Qt5QexgDrA07cIEp8cEaTrfCgJg%3D" alt="c1.jpg" loading="lazy"/></p>
<p>æ›´è¿›ä¸€æ­¥çš„æ˜¯<strong>å®ä¾‹åˆ†å‰²</strong>ï¼ˆInstance Segmentationï¼‰ï¼Œå®ƒä¸ä»…èƒ½æŠŠå›¾åƒä¸­ä¸åŒçš„å¯¹è±¡è¯†åˆ«å‡ºæ¥ï¼Œè¿˜èƒ½ç²¾ç¡®åœ°æŠŠå®ƒä»¬ä»èƒŒæ™¯ä¸­â€œæŠ â€å‡ºæ¥ã€‚å½“ä½ ä¸ä»…éœ€è¦çŸ¥é“ç‰©ä½“åœ¨å“ªï¼Œè¿˜æƒ³äº†è§£å®ƒä»¬çš„å…·ä½“å½¢çŠ¶å’Œè½®å»“æ—¶ï¼Œå®ä¾‹åˆ†å‰²å°±èƒ½æ´¾ä¸Šå¤§ç”¨åœºâ€”â€”æ¯”å¦‚åŒ»ç–—å½±åƒåˆ†æã€æœºå™¨äººè§†è§‰ç­‰åœºæ™¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eb303e2fc1594dc58f2488291fc0e97d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=EiSLr6k9mH2UptmRP09bIA9UpSk%3D" alt="c2.jpg" loading="lazy"/></p>
<p>è‡³äº<strong>å›¾åƒåˆ†ç±»</strong>ï¼ˆImage Classificationï¼‰ï¼Œå¯ä»¥è¯´æ˜¯æœ€åŸºç¡€ä¹Ÿæœ€ç»å…¸çš„ä»»åŠ¡äº†ã€‚ä½ è¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œæ¨¡å‹å°±ä¼šè¾“å‡ºä¸€ä¸ªç±»åˆ«æ ‡ç­¾å’Œå¯¹åº”çš„ç½®ä¿¡åº¦ï¼Œå‘Šè¯‰æˆ‘ä»¬â€œè¿™å¼ å›¾æ˜¯ä»€ä¹ˆâ€ã€‚è™½ç„¶å¬èµ·æ¥ç®€å•ï¼Œä½†å®ƒå´æ˜¯è®¸å¤šè§†è§‰ç³»ç»Ÿçš„åŸºçŸ³ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f72883a7ce8c484f98f394484ac198a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=CgiJstuQTMVmLZEbE0xHhD0XC8w%3D" alt="c3.jpg" loading="lazy"/></p>
<p>è€Œ<strong>å§¿æ€ä¼°è®¡</strong> ï¼ˆPose Estimationï¼‰åˆ™æœ‰ç‚¹ç‰¹åˆ«ã€‚å®ƒçš„ä»»åŠ¡æ˜¯è¯†åˆ«å‡ºå›¾åƒä¸­äººä½“æˆ–ç‰©ä½“çš„å…³é”®ç‚¹ä½ç½®ï¼Œæ¯”å¦‚å…³èŠ‚ã€äº”å®˜ç­‰ã€‚æ¨¡å‹ä¼šè¾“å‡ºä¸€ç»„å¸¦ç½®ä¿¡åº¦çš„åæ ‡ç‚¹ï¼Œå¸®åŠ©æˆ‘ä»¬ç†è§£å¯¹è±¡çš„å§¿æ€ç»“æ„ã€‚æ— è®ºæ˜¯ä½“è‚²åŠ¨ä½œåˆ†æã€äº’åŠ¨æ¸¸æˆï¼Œè¿˜æ˜¯äººæœºäº¤äº’ï¼Œå§¿æ€ä¼°è®¡éƒ½èƒ½æä¾›éå¸¸æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7f4a789884044627a5d51a2196a01f9b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=JLGyHuwcQpbKE3xikyUtvLHJbKc%3D" alt="c4.jpg" loading="lazy"/></p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•ç”¨ YOLO å®Œæˆ<strong>ç›®æ ‡æ£€æµ‹</strong>å’Œ<strong>å›¾åƒåˆ†ç±»</strong>ã€‚æŒæ¡è¿™ä¸¤é¡¹æ ¸å¿ƒä»»åŠ¡ä¹‹åï¼Œåƒå§¿æ€ä¼°è®¡ã€å®ä¾‹åˆ†å‰²ï¼Œç”šè‡³æ˜¯ OBBï¼ˆOriented Bounding Boxï¼‰ç­‰è¿›é˜¶åŠŸèƒ½ï¼Œå¯¹ä½ æ¥è¯´éƒ½å°†è§¦ç±»æ—é€šï¼Œåªéœ€è¦æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ç¨ä½œäº†è§£ï¼Œå°±èƒ½è½»æ¾ä¸Šæ‰‹ã€‚</p>
<p>ä¸ºäº†é¡ºåˆ©å®Œæˆæœ¬æ•™ç¨‹çš„å­¦ä¹ å’Œå®è·µï¼Œä½ éœ€è¦å‡†å¤‡ä¸€å°æ­è½½ç°ä»£è‹±ä¼Ÿè¾¾æ˜¾å¡çš„ Windows ç”µè„‘ï¼ˆè‹¹æœç”µè„‘ä¹Ÿå®Œå…¨å¯ä»¥ï¼Œä¸è¿‡æœ¬æ•™ç¨‹å°†ä»¥ Windows ç³»ç»Ÿä¸ºä¾‹è¿›è¡Œæ¼”ç¤ºï¼‰ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦ä½ å…·å¤‡ä¸€å®šçš„ Python åŸºç¡€ï¼Œä»¥åŠç†Ÿæ‚‰ä¸€äº›åŸºæœ¬çš„Windows æ“ä½œã€‚</p>
<hr/>
<h3 data-id="heading-2">äºŒ. ç¯å¢ƒæ­å»º</h3>
<h4 data-id="heading-3">2.1 Pythonç‰ˆæœ¬å·æŸ¥çœ‹</h4>
<p>ç›¸ä¿¡ä½ çš„ç”µè„‘é‡Œå·²ç»å®‰è£…å¥½äº† Python å§ï¼Ÿè¿™é‡Œå°±ä¸å†èµ˜è¿° Python çš„å®‰è£…è¿‡ç¨‹äº†ï¼Œä½†æœ‰ä¸€ç‚¹å¿…é¡»å¼ºè°ƒï¼šè¯·ç¡®ä¿ä½ çš„ <strong>Python ç‰ˆæœ¬ â‰¥ 3.8</strong>ï¼ˆè¿™æ˜¯å®˜æ–¹æ˜ç¡®è¦æ±‚çš„æœ€ä½ç‰ˆæœ¬ï¼‰ã€‚</p>
<p>å¦‚ä½•æŸ¥çœ‹Pythonç‰ˆæœ¬å·ï¼Ÿå¾ˆç®€å•ï¼ŒæŒ‰ä¸‹ <code>Win + R</code> ç»„åˆé”®æ‰“å¼€â€œè¿è¡Œâ€å¯¹è¯æ¡†ï¼Œè¾“å…¥ <code>cmd</code> å¹¶å›è½¦ï¼Œè¿›å…¥<strong>å‘½ä»¤è¡Œçª—å£</strong>ã€‚åœ¨é»‘è‰²çš„å‘½ä»¤è¡Œçª—å£ä¸­è¾“å…¥ <code>python</code> åå›è½¦ï¼Œå±å¹•ä¸Šå°±ä¼šæ˜¾ç¤ºä½ çš„ Python ç‰ˆæœ¬ä¿¡æ¯ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/807b3eb29d42442c8c37dfc6a51f9859~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=xsOhv0F%2BcGD1PqpGOO%2FtAqw8%2FQs%3D" alt="c5.jpg" loading="lazy"/></p>
<p>å¦‚æœä½ è¾“å…¥ <code>python</code> åæ²¡æœ‰çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè€Œæ˜¯æç¤ºâ€œæ‰¾ä¸åˆ°â€˜pythonâ€™å‘½ä»¤â€ï¼Œé‚£è¦ä¹ˆæ˜¯ä½ è¿˜æ²¡è£…Pythonï¼Œè¦ä¹ˆå°±æ˜¯ä½ åœ¨å®‰è£…Pythonçš„æ—¶å€™æ²¡æœ‰å‹¾é€‰â€œAdd Python to PATHâ€é€‰é¡¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/26dfde8b9fec40969fce088f12af8347~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=yJyMBLKvYBO4mlCAaUwUqVyB%2BPE%3D" alt="c6.jpg" loading="lazy"/></p>
<h4 data-id="heading-4">2.2 Pytorchçš„å®‰è£…</h4>
<blockquote>
<p>å¦‚æœä½ å·²ç»å®‰è£…å¥½äº† PyTorchï¼Œå¹¶ä¸”ç¡®è®¤èƒ½å¤Ÿæ­£å¸¸ä½¿ç”¨ï¼Œå¯ä»¥è·³è¿‡æœ¬èŠ‚å†…å®¹ã€‚</p>
</blockquote>
<p>ğŸ¤”<strong>ä»€ä¹ˆæ˜¯ PyTorchï¼Ÿä¸ºä»€ä¹ˆéœ€è¦å®‰è£…å®ƒï¼Ÿ</strong> ç®€å•æ¥è¯´ï¼Œåªè¦ä½ æ¶‰è¶³æ·±åº¦å­¦ä¹ ï¼Œ<strong>PyTorch</strong> å‡ ä¹æ˜¯ç»•ä¸å¼€çš„æ ¸å¿ƒç»„ä»¶ã€‚å®ƒæ˜¯ä¸€ä¸ªåŸºäº Python çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼Œä½ å¯ä»¥éå¸¸çµæ´»åœ°ä½¿ç”¨å®ƒæ¥æ„å»ºã€è®­ç»ƒå’Œéƒ¨ç½²å„ç±»æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚æ­£å› ä¸ºå…¶åº•å±‚è®¾è®¡å¼ºå¤§ä¸”é€šç”¨ï¼Œç»å¤§å¤šæ•°ç°ä»£ AI æ¨¡å‹ï¼ˆåŒ…æ‹¬ YOLO ç³»åˆ—ï¼‰éƒ½æ˜¯åŸºäº PyTorch å¼€å‘çš„ã€‚å› æ­¤ï¼Œæƒ³åœ¨æœ¬åœ°é¡ºåˆ©è¿è¡Œ YOLOv11ï¼Œå®‰è£… PyTorch æ˜¯å¿…ä¸å¯å°‘çš„ä¸€æ­¥ã€‚(Pytorchæ˜¯ä¸€ä¸ªPythonåº“ï¼Œåœ¨pythonä¸­å®ƒçš„åç§°ä¸ºtorch)</p>
<p>å¾ˆå¤šåˆšå…¥é—¨æœºå™¨å­¦ä¹ çš„åŒå­¦ä¼šé—®æˆ‘ï¼šâ€œæœ‰æ²¡æœ‰å¿…è¦ç³»ç»Ÿå­¦ä¹  PyTorchï¼Ÿâ€æˆ‘çš„å›ç­”é€šå¸¸æ˜¯ï¼šâ€œç°é˜¶æ®µæ²¡æœ‰å¿…è¦ï¼Œå…ˆæŠŠæœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„åŸºç¡€ç†è®ºæ‰“æ‰å®ã€‚PyTorch æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå½“ä½ ç†è§£äº†æ¨¡å‹å’Œç®—æ³•ä¹‹åï¼Œå†æ¥å­¦ä¹ ä½¿ç”¨ PyTorch å°±ä¼šæ°´åˆ°æ¸ æˆã€‚â€</p>
<p>ä¸¾ä¸ªä¾‹å­å§ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œä½ äº¤ç»™ä¸€ä½æ•°å­¦åšå£«ç”Ÿä¸€ä¸ªå¡è¥¿æ¬§è®¡ç®—å™¨ï¼Œè®©ä»–è®¡ç®—å¦‚ä¸‹ç§¯åˆ†ï¼š</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mo>âˆ«</mo><mn>0</mn><mn>2</mn></msubsup><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><msup><mi>x</mi><mn>3</mn></msup><mo stretchy="false">)</mo><mfrac><mrow><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mi>x</mi></mfrac><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\int_{0}^{2} ln(1+x^{3})\frac{sin(x)}{x}dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.476em;vertical-align:-0.9119em;"/><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011em;">âˆ«</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.564em;"><span style="top:-1.7881em;margin-left:-0.4445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">in</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span></span></div>
<p>ä»–åªéœ€è¦æŒ‰éƒ¨å°±ç­åœ°è¾“å…¥è¡¨è¾¾å¼ï¼Œè®¡ç®—å™¨è‡ªç„¶ä¼šè¿”å›ç­”æ¡ˆï¼›ä½†å¦‚æœä½ æŠŠè¿™ä¸ªåŒæ ·çš„è®¡ç®—å™¨äº¤ç»™ä¸€ä¸ªå°å­¦ç”Ÿï¼Œè®©ä»–ç®—å‡ºè¿™ä¸ªå¼å­çš„ç»“æœï¼Œä»–å¯èƒ½æ— ä»ä¸‹æ‰‹ï¼Œä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºä»–éƒ½çœ‹ä¸æ‡‚è¿™äº›ç¬¦å·ï¼Œç”šè‡³è§‰å¾—è¿™æ˜¯è‹±è¯­é¢˜ï¼Œæ›´åˆ«è¯´è¦å»æŒ‰å“ªä¸ªé”®äº†ï¼<strong>è¿™é‡Œçš„â€œè®¡ç®—å™¨â€ï¼Œå°±ç›¸å½“äº PyTorch</strong>ã€‚å®ƒåªæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œä¼šä¸ä¼šç”¨ï¼Œç”¨çš„å¥½ä¸å¥½ï¼Œå–å†³äºä½¿ç”¨è€…çš„ç†è®ºåŸºç¡€ã€‚</p>
<p>å½“ç„¶äº†ï¼Œæƒ³è¦ç”¨å¥½ YOLOï¼Œä½ å¹¶ä¸éœ€è¦ç²¾é€š PyTorchï¼Œä¸è¿‡å¦‚æœä½ ä¼šPytrochçš„è¯å°±æ›´å¥½äº†ã€‚</p>
<p>æœ¬æ–‡æä¾›å®‰è£…æ–¹å¼æ˜¯å…¨å±€å®‰è£…ï¼Œå°±æ˜¯æœ€æ™®é€šçš„å®‰è£…æ–¹å¼ï¼Œé»˜è®¤ä¼šå°† PyTorch å®‰è£…åˆ° C ç›˜ã€‚å¦‚æœä½ æœ‰èƒ½åŠ›ï¼Œå¯ä»¥åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…ï¼Œè¿™æ ·ä»¥åä¸ç”¨çš„æ—¶å€™ä¹Ÿæ–¹ä¾¿å¸è½½å’Œé¡¹ç›®ç®¡ç†ã€‚</p>
<p>å½“ç„¶äº†ï¼Œå¦‚æœä½ ä¸æƒ³æŠ˜è…¾ï¼Œå°¤å…¶æ˜¯ Python æ–°æ‰‹ï¼Œæˆ‘å¼ºçƒˆæ¨èå…¨å±€å®‰è£…çš„æ–¹å¼ï¼Œè¿™èƒ½å¸®ä½ é¿å¼€å¾ˆå¤šç¯å¢ƒé…ç½®çš„â€œå‘â€ï¼Œå…å»å¾ˆå¤šéº»çƒ¦ã€‚</p>
<p>âš ï¸ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPyTorch åŠå…¶ç›¸å…³ç»„ä»¶ä½“ç§¯è¾ƒå¤§ï¼Œæ€»å…±çº¦ 3GB å·¦å³ã€‚å¦‚æœä½ é€‰æ‹©å…¨å±€å®‰è£…ï¼Œè¯·åŠ¡å¿…ç¡®ä¿ C ç›˜æœ‰è¶³å¤Ÿçš„å‰©ä½™ç©ºé—´ã€‚æ”¾å¿ƒï¼Œå³ä¾¿æœªæ¥ä½ ä¸å†ä½¿ç”¨ YOLOï¼Œæœ¬æ–‡ä¹Ÿä¼šæ•™ä½ å¦‚ä½•å½»åº•ç§»é™¤è¿™äº›æ–‡ä»¶ã€‚</p>
<p>é¦–å…ˆï¼Œä½ éœ€è¦ç¡®å®šè‡ªå·±çš„ç”µè„‘æ˜¾å¡å‹å·ï¼Œå› ä¸ºè¿™å°†å†³å®šä½ è¦å®‰è£…å“ªä¸ªç‰ˆæœ¬çš„Pytorchã€‚</p>
<p>åœ¨<strong>å‘½ä»¤è¡Œçª—å£ï¼ˆcmdï¼‰</strong> è¾“å…¥<code>nvidia-smi</code>å¹¶ä¸”å›è½¦æ¥æŸ¥çœ‹æœ¬æœºæ˜¾å¡ä¿¡æ¯</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ad51112e417e4585ad6994027e68cc1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=UKCWfwRVDzYuprmHnWh0m0sTEgE%3D" alt="cn7.jpg" loading="lazy"/></p>
<p>å¦‚æœä½ è¾“å…¥å‘½ä»¤å‡ºç°äº†ä¸Šè¿°ç•Œé¢ï¼Œè¯·ç¡®ä¿ä½ çš„CUDAç‰ˆæœ¬è¦å¤§äºç­‰äº11.8ï¼Œå¦åˆ™å°±è¦å»æ›´æ–°æ˜¾å¡é©±åŠ¨ï¼›</p>
<p>å¦‚æœä½ çš„ç”µè„‘<strong>æ²¡æœ‰ç‹¬ç«‹è‹±ä¼Ÿè¾¾æ˜¾å¡ï¼Œæˆ–æ˜¾å¡å¤ªè€</strong>ï¼Œé‚£ä¹ˆä½ åªèƒ½ç”¨CPUæ¥è¿›è¡Œæ¨¡å‹çš„è®­ç»ƒå’Œæ¨ç†ï¼Œè¿™ä¼šæ¯”ä½¿ç”¨æ˜¾å¡ï¼ˆGPUï¼‰çš„æ…¢å¾ˆå¤šï¼Œä½†ç”¨æ¥å­¦ä¹ å’Œæµ‹è¯•æ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ã€‚è¿™ç§æƒ…å†µä½ å°±è¦åœ¨<strong>å‘½ä»¤è¡Œçª—å£ï¼ˆcmdï¼‰</strong> è¾“å…¥ä¸‹è¿°å‘½ä»¤å¹¶å›è½¦æ¥å®‰è£…CPUç‰ˆæœ¬çš„Pytorchï¼š</p>
<pre><code class="hljs language-shell" lang="shell">pip install torch torchvision torchaudio
</code></pre>
<p>å¦‚æœä½ çš„æ˜¾å¡æ˜¯RTX 30/40 ç³»åˆ—ç­‰ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤æ¥å®‰è£…Pytorch</p>
<pre><code class="hljs language-shell" lang="shell">pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
</code></pre>
<p>å¦‚æœä½ çš„æ˜¾å¡æ˜¯RTX50ç³»åˆ—çš„æ˜¾å¡ï¼Œä½ <strong>å¿…é¡»</strong>ä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤æ¥å®‰è£…Pytorch</p>
<pre><code class="hljs language-shell" lang="shell">pip install --pre torch torchvision torchaudio --index-url https://download.pytorch.org/whl/nightly/cu129
</code></pre>
<p>å¦‚æœä½ çš„æ˜¾å¡æ˜¯ç¨å¾®è€ä¸€ç‚¹çš„æ˜¾å¡ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æŒ‡ä»¤æ¥å®‰è£…Pytorch</p>
<pre><code class="hljs language-shell" lang="shell">pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
</code></pre>
<p>ğŸ’¡ <strong>å°æç¤º</strong>ï¼šPyTorch çš„å®‰è£…åŒ…ä½“ç§¯è¾ƒå¤§ï¼Œä¸‹è½½è¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚</p>
<p>å½“å®‰è£…é¡ºåˆ©å®Œæˆåï¼Œå‘½ä»¤è¡Œæœ€åé€šå¸¸ä¼šæ˜¾ç¤º <code>Successfully installed...</code> çš„æç¤ºã€‚</p>
<p>æœ€åï¼Œä¸ºç¡®ä¿ä¸€åˆ‡æ­£å¸¸ï¼Œè¯·ä½ è¿è¡Œä¸‹é¢è¿™æ®µç®€å•çš„ Python æµ‹è¯•ä»£ç ï¼Œæ¥æ£€æŸ¥ PyTorch æ˜¯å¦æˆåŠŸå®‰è£…å¹¶èƒ½å¤Ÿè¯†åˆ«ä½ çš„ç¡¬ä»¶è®¾å¤‡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"PyTorch ç‰ˆæœ¬: <span class="hljs-subst">{torch.__version__}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ˜¾å¡æ˜¯å¦å¯ç”¨: <span class="hljs-subst">{<span class="hljs-string">'æ˜¯'</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">'å¦'</span>}</span>"</span>)
<span class="hljs-keyword">if</span> torch.cuda.is_available():
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å½“å‰ GPU: <span class="hljs-subst">{torch.cuda.get_device_name(<span class="hljs-number">0</span>)}</span>"</span>)
</code></pre>
<p>å¦‚æœè¾“å‡ºä¸­æ˜¾ç¤ºâ€œæ˜¾å¡æ˜¯å¦å¯ç”¨: æ˜¯â€ï¼Œå¹¶æ­£ç¡®è¯†åˆ«å‡ºä½ çš„æ˜¾å¡å‹å·ï¼Œé‚£ä¹ˆæ­å–œä½ â€”â€”ç¯å¢ƒé…ç½®æˆåŠŸï¼</p>
<p>å¦‚æœä¸Šè¿°æ–¹æ³•éƒ½æ— æ³•é¡ºåˆ©å®‰è£…ï¼Œæˆ–è€…åœ¨æŸä¸ªæ­¥éª¤ï¼ˆå¾ˆå¤šæ—¶å€™æ˜¯ä¸‹è½½é€Ÿåº¦å¤ªæ…¢äº†ï¼‰å¡ä½äº†ï¼Œåˆ«æ‹…å¿ƒï¼Œæ¨èä½¿ç”¨DeepSeekæˆ–è€…è±†åŒ…è¿™ç§å¤§è¯­è¨€æ¨¡å‹æ¥è¿›è¡Œä¸€å¯¹ä¸€ç–‘éš¾è§£å†³ï¼Œè¯·è€å¿ƒã€è¯¦ç»†åœ°å‘å®ƒæè¿°ä½ é‡åˆ°çš„é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œå®Œæ•´å¤åˆ¶é”™è¯¯ä¿¡æ¯ï¼‰ï¼Œç›¸ä¿¡AIä¼šç»™ä½ ç­”æ¡ˆã€‚æ— è®ºä½ æœ€åæ˜¯é€šè¿‡ä½•ç§æ–¹å¼å®‰è£…å¥½çš„Pytorchï¼Œè¯·<strong>åŠ¡å¿…</strong>è¦è¿è¡Œä¸€æ¬¡ä¸Šé¢çš„Pythonæµ‹è¯•ä»£ç ï¼Œæ¥æ£€æŸ¥Pytorchæ˜¯å¦å®‰è£…æˆåŠŸã€‚</p>
<h4 data-id="heading-5">2.3 YOLOçš„å®‰è£…</h4>
<p>å½“ä½ å·²ç»é¡ºåˆ©å®‰è£…å¥½ PyTorch ä¹‹åï¼Œå®‰è£… YOLO å°±å˜å¾—éå¸¸ç®€å•äº†ï¼Œåªéœ€æ‰“å¼€ä½ çš„<strong>å‘½ä»¤è¡Œçª—å£ï¼ˆcmdï¼‰</strong>ï¼Œè¾“å…¥ä¸‹é¢è¿™è¡ŒæŒ‡ä»¤å¹¶æŒ‰ä¸‹å›è½¦ï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨å¸®ä½ å®Œæˆ YOLO æ¡†æ¶çš„å®‰è£…ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">pip install ultralytics
</code></pre>
<p>å®‰è£…å®Œæˆåï¼Œè¯·è¿è¡Œä¸€ä¸‹ä¸‹é¢çš„Pythonä»£ç ã€‚å¦‚æœè¿è¡Œåæ²¡æœ‰å‡ºç°ä»»ä½•æŠ¥é”™ï¼Œå¹¶ä¸”æ‰“å°å‡ºäº†â€œYOLO å®‰è£…æˆåŠŸï¼â€ï¼Œé‚£ä¹ˆå°±ä»£è¡¨ä½ å·²ç»å®‰è£…æˆåŠŸäº†ã€‚å¯ä»¥æ­£å¼è¿›å…¥YOLOçš„å­¦ä¹ äº†ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO
<span class="hljs-built_in">print</span>(<span class="hljs-string">"YOLO å®‰è£…æˆåŠŸï¼"</span>)
</code></pre>
<h4 data-id="heading-6">2.4 é¢„è®­ç»ƒæ¨¡å‹çš„ä¸‹è½½</h4>
<p>ä»€ä¹ˆæ˜¯é¢„è®­ç»ƒæ¨¡å‹ï¼Ÿç®€å•æ¥è¯´ï¼Œé¢„è®­ç»ƒæ¨¡å‹å°±åƒä¸€ä½â€œå·²ç»è¯»è¿‡ä¸‡å·ä¹¦â€çš„å­¦è€…â€”â€”å®ƒå·²ç»åœ¨æµ·é‡çš„å›¾åƒæ•°æ®é›†ï¼ˆä¾‹å¦‚ ImageNetã€COCO ç­‰ï¼‰ä¸Šè¿›è¡Œäº†å……åˆ†çš„è®­ç»ƒï¼Œèƒ½å¤Ÿè¯†åˆ«å‡ºæˆç™¾ä¸Šåƒç§å¸¸è§ç‰©ä½“ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå·²ç»å…·å¤‡äº†è¾ƒå¼ºçš„å›¾åƒè¯†åˆ«èƒ½åŠ›ï¼Œæ˜¯ä¸€ä¸ªâ€œåŠæˆå“â€æ¨¡å‹ã€‚</p>
<p>å½“æˆ‘ä»¬å¸Œæœ›å®ƒå­¦ä¹ æŸä¸ªç‰¹å®šä»»åŠ¡æ—¶ï¼ˆæ¯”å¦‚è¯†åˆ«æŸä¸€ç§ç‰¹æ®Šçš„ç‰©ä½“ï¼‰ï¼Œå¹¶ä¸éœ€è¦è®©å®ƒä»é›¶å¼€å§‹å­¦ä¹ ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºå®ƒå·²ç»æŒæ¡çš„é€šç”¨è§†è§‰çŸ¥è¯†ï¼Œç”¨æˆ‘ä»¬è‡ªå·±çš„å°æ•°æ®é›†å»â€œå¾®è°ƒâ€ï¼ˆFine-tuningï¼‰å®ƒã€‚è¿™æ ·åšçš„å¥½å¤„éå¸¸æ˜æ˜¾ï¼š</p>
<ul>
<li><strong>è®­ç»ƒæ•ˆç‡æ›´é«˜</strong>ï¼šæ¨¡å‹ä¸éœ€è¦é‡æ–°å­¦ä¹ æ‰€æœ‰åº•å±‚ç‰¹å¾ï¼›</li>
<li><strong>æ•°æ®éœ€æ±‚é‡æ›´å°‘</strong>ï¼šå³ä½¿æˆ‘ä»¬åªæœ‰å‡ ç™¾å¼ å›¾åƒï¼Œä¹Ÿèƒ½å–å¾—ä¸é”™çš„æ•ˆæœï¼›</li>
<li><strong>æ”¶æ•›é€Ÿåº¦æ›´å¿«</strong>ï¼šç›¸æ¯”ä»é›¶è®­ç»ƒï¼Œè®­ç»ƒæ—¶é—´å¤§å¹…ç¼©çŸ­ã€‚</li>
</ul>
<p>è¿™èƒŒåçš„åŸç†ï¼Œæ­£æ˜¯è¿ç§»å­¦ä¹ ï¼ˆTransfer Learningï¼‰çš„æ€æƒ³â€”â€”å°†åœ¨ä¸€ä¸ªä»»åŠ¡ä¸­å­¦åˆ°çš„çŸ¥è¯†ï¼Œè¿ç§»åˆ°å¦ä¸€ä¸ªç›¸å…³ä»»åŠ¡ä¸­ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­å§ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œä½ ç°åœ¨è¦æ•™ä¸€ä½<strong>å…¨èƒ½å‹å¨å¸ˆ</strong>åšä¸€é“ä»–è¿˜æ²¡è§è¿‡çš„èœï¼Œä½†ä»–å·²ç»ç²¾é€šè¥¿ã€æ—¥ã€éŸ©ç­‰å„ç±»èœç³»çš„åŸºæœ¬æŠ€æ³•ï¼ˆå°±åƒé¢„è®­ç»ƒæ¨¡å‹æŒæ¡äº†é€šç”¨ç‰¹å¾æå–èƒ½åŠ›ï¼‰ã€‚</p>
<p>è¿™æ—¶ï¼Œä½ æƒ³è®©ä»–ä¸“é—¨å­¦ä¼šåš <strong>ã€Œå››å·éº»å©†è±†è…ã€</strong> è¿™é“èœã€‚</p>
<p><strong>æœ‰ä¸¤ç§åŸ¹å…»è·¯å¾„ï¼š</strong></p>
<ul>
<li><strong>æ–¹æ³• Aï¼ˆä»é›¶å¼€å§‹è®­ç»ƒï¼‰</strong>ï¼š
ä½ è®©ä»–å¿˜æ‰æ‰€æœ‰å¨è‰ºåŸºç¡€ï¼Œåªç»™ä»–ä¸€å †è±†è…å’Œè¾£æ¤’ï¼Œè®©ä»–è‡ªå·±æ‘¸ç´¢æ€ä¹ˆåšéº»å©†è±†è…ã€‚ä»–å¯èƒ½éœ€è¦å¤±è´¥å‡ ç™¾æ¬¡ã€èŠ±ä¸Šå¥½å‡ ä¸ªæœˆï¼Œæ‰èƒ½å‹‰å¼ºåšå‡ºä¸€é“åƒæ ·çš„èœâ€”â€”è¿™å°±åƒæˆ‘ä»¬ä¸ç”¨é¢„è®­ç»ƒæ¨¡å‹ï¼Œåªç”¨è‡ªå·±çš„å°æ•°æ®é›†ä»å¤´è®­ç»ƒï¼Œæ•ˆç‡æä½ä¸”æ•ˆæœéš¾ä»¥ä¿è¯ã€‚</li>
<li><strong>æ–¹æ³• Bï¼ˆä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ + å¾®è°ƒï¼‰</strong>ï¼š
ä½ ç›´æ¥è¯·å‡ºé‚£ä½å…¨èƒ½å¨å¸ˆï¼Œé€’ç»™ä»–ä¸€ä»½ç®€æ´çš„ <strong>ã€Šéº»å©†è±†è…ä¸“å±é£Ÿè°±ã€‹</strong>ï¼ˆè¿™å°±æ˜¯ä½ çš„å°æ•°æ®é›†ï¼‰ï¼Œé‡Œé¢è®°å½•äº†è¿™é“èœçš„å…³é”®è¦é¢†ï¼šæ¯”å¦‚â€œè±†ç“£é…±è¦ç‚’å‡ºçº¢æ²¹â€ã€â€œèŠ±æ¤’è¦åœ¨èµ·é”…å‰æ’’å…¥â€ç­‰ç­‰ã€‚
è¿™ä½å¨å¸ˆå‡­å€Ÿä»–åŸæœ‰çš„çƒ¹é¥ªåŠŸåº•ï¼Œå¾ˆå¿«å°±èƒ½å¿ƒé¢†ç¥ä¼šï¼Œåšå‡ºä¸€é“æ­£å®—çš„éº»å©†è±†è…â€”â€”è¿™æ­£æ˜¯â€œé¢„è®­ç»ƒ + å¾®è°ƒâ€çš„å·§å¦™ä¹‹å¤„ã€‚</li>
</ul>
<p>ä½ å¯ä»¥åœ¨è¿™ä¸ª<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.123865.com%2Fs%2F0Z90jv-zcGeh%3Fpwd%3Dming" target="_blank" title="https://www.123865.com/s/0Z90jv-zcGeh?pwd=ming" ref="nofollow noopener noreferrer">ã€ä¸‹è½½é“¾æ¥ã€‘</a>ä¸­è·å–åˆ°YOLOå®˜æ–¹æä¾›çš„å°ä½“ç§¯é¢„è®­ç»ƒæ¨¡å‹ï¼Œå…¶ä¸­<code>yolo11s-cls.pt</code>æ˜¯å›¾åƒåˆ†ç±»ä»»åŠ¡çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œ<code>yolo11s.pt</code>æ˜¯ç›®æ ‡æ£€æµ‹ä»»åŠ¡çš„é¢„è®­ç»ƒæ¨¡å‹ï¼ˆå¹³è¡¡äº†ç²¾åº¦ä¸ä½“ç§¯ï¼‰ã€‚ä¸‹è½½åä½ å¯ä»¥å°†å…¶æ”¾åˆ°ç”µè„‘ä¸­ä»»ä½•ä¸€ä¸ªä½ å–œæ¬¢çš„ä½ç½®ã€‚åªè¦ä¸è¦å¿˜äº†æ”¾åœ¨å“ªå°±è¡Œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/204638eb77384b49b5f6de83bc3d8508~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=g4qXRMmr0FclGXQjcDiY5JIDO2g%3D" alt="c8.jpg" loading="lazy"/></p>
<p>ä½ å¯ä»¥çœ‹åˆ°ï¼ŒYOLOå®˜æ–¹ç½‘ç«™ä¸Šåœ¨åŒä¸€ä¸ªä»»åŠ¡ä¸‹æä¾›äº†ä¸åŒä½“ç§¯çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œä½“ç§¯è¶Šå¤§ï¼ˆæ¨¡å‹å‚æ•°è¶Šå¤šï¼Œå ç”¨ç©ºé—´è¶Šå¤§ï¼‰çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œè¯†åˆ«å›¾åƒçš„æ•ˆæœè‚¯å®šæ˜¯è¶Šå¥½ï¼Œä½†æ˜¯ä¹Ÿå¥½ä¸åˆ°å“ªé‡Œå»ï¼Œæœ‰æ—¶å€™ä½“ç§¯æå‡80%ï¼Œä½†è¯†åˆ«æ•ˆæœå°±æå‡3%ï¼Œæ€§ä»·æ¯”ä¸é«˜ï¼›è€Œä¸”å¤§ä½“ç§¯çš„æ¨¡å‹è¿˜ä¸å¥½è®­ç»ƒï¼Œå¯¹ç¡¬ä»¶è¦æ±‚è¾ƒé«˜ã€‚å…·ä½“æ ¹æ®ä½ çš„ä»»åŠ¡è¦æ±‚æ¥é€‰æ‹©æ¨¡å‹ã€‚è¿™å°±å¥½æ¯”ä¹°è½¦ï¼Œä¸æ˜¯å‘åŠ¨æœºæ’é‡è¶Šå¤§è¶Šå¥½ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘<strong>æ€§ä»·æ¯”</strong>å’Œ<strong>ä½¿ç”¨åœºæ™¯</strong>ã€‚</p>
<h4 data-id="heading-7">2.5 YOLOåŠå…¶ç»„ä»¶çš„å½»åº•å¸è½½</h4>
<blockquote>
<p>å¦‚æœä½ æœªæ¥ä¸æ‰“ç®—ä½¿ç”¨YOLOäº†ï¼Œå¯ä»¥å‚è€ƒä¸‹æ–¹æ•™ç¨‹å¸è½½YOLOåŠå…¶ç»„ä»¶</p>
</blockquote>
<p>ğŸŸ¢ <strong>æƒ…å†µä¸€ï¼šä½¿ç”¨è™šæ‹Ÿç¯å¢ƒå®‰è£…</strong></p>
<p>å¦‚æœä½ æ˜¯åœ¨ Conda æˆ– Venv ç­‰è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…çš„ YOLOï¼Œå¸è½½ä¼šéå¸¸ç®€å•ç›´æ¥â€”â€”<strong>ç›´æ¥åˆ é™¤æ•´ä¸ªè™šæ‹Ÿç¯å¢ƒæ–‡ä»¶å¤¹å³å¯</strong>ï¼Œç¯å¢ƒå†…æ‰€æœ‰å®‰è£…çš„åŒ…éƒ½ä¼šä¸€å¹¶æ¸…é™¤ï¼Œä¸ä¼šå¯¹ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†é€ æˆä»»ä½•å½±å“ã€‚</p>
<p>ğŸŸ¡ <strong>æƒ…å†µäºŒï¼šå…¨å±€å®‰è£…çš„æ™®é€šå¸è½½</strong></p>
<p>å¦‚æœä½ æ˜¯é»˜è®¤å…¨å±€å®‰è£…åˆ°äº†ç³»ç»Ÿä¸­ï¼ˆæ¯”å¦‚ C ç›˜ï¼‰ï¼Œä½ éœ€è¦åœ¨**å‘½ä»¤è¡Œçª—å£ï¼ˆcmdï¼‰**ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå¸è½½ PyTorchå’ŒYOLO åŠå…¶ç›¸å…³æ ¸å¿ƒç»„ä»¶ã€‚</p>
<pre><code class="hljs language-shell" lang="shell">pip uninstall torch torchvision torchaudio torchtriton pytorch-triton ultralytics
</code></pre>
<p>æ¥ç€ï¼Œæ¸…ç† pip çš„ç¼“å­˜æ–‡ä»¶ï¼Œé‡Šæ”¾ç£ç›˜ç©ºé—´ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">pip cache purge
</code></pre>
<p>å®Œæˆè¿™ä¸¤æ­¥åï¼ŒPyTorch å’Œ YOLOä¸»ä½“éƒ¨åˆ†å°±å·²ç»è¢«ç§»é™¤äº†ï¼Œç¼“å­˜ä¹Ÿæ¸…ç†å¹²å‡€ã€‚ä¸è¿‡ï¼Œç³»ç»Ÿä¸­å¯èƒ½è¿˜ä¼šæ®‹ç•™ä¸€äº›é™„å±ç»„ä»¶å’Œé…ç½®æ–‡ä»¶ï¼Œå®ƒä»¬é€šå¸¸æ•£è½åœ¨ä¸åŒä½ç½®ï¼Œæ‰‹åŠ¨æ¸…ç†æ¯”è¾ƒå›°éš¾ã€‚å…¶å®ï¼Œä¿ç•™è¿™äº›æ®‹ç•™ç»„ä»¶é€šå¸¸ä¸ä¼šå½±å“ç”µè„‘æ—¥å¸¸ä½¿ç”¨ï¼Œæœ€å¤šåªæ˜¯å ç”¨å°‘é‡ C ç›˜ç©ºé—´ã€‚å¦‚æœä½ ä¸æ‰“ç®—ç»§ç»­ä½¿ç”¨ YOLO æˆ– PyTorchï¼Œä½†åˆä¸æƒ³å¤§åŠ¨å¹²æˆˆï¼Œåˆ°è¿™é‡Œå…¶å®å·²ç»è¶³å¤Ÿäº†ã€‚</p>
<p>ğŸ”´ <strong>æƒ…å†µä¸‰ï¼šè¿½æ±‚å®Œç¾çš„â€œå½»åº•å¸è½½â€</strong></p>
<p>å¦‚æœä½ æ‰“ç®—æœªæ¥ä¸€æ®µæ—¶é—´å†…éƒ½ä¸å†ä½¿ç”¨ Python è¿›è¡Œ AI å¼€å‘ï¼Œæˆ–è€…ä½ æœ‰â€œæ´ç™–â€ï¼Œå¸Œæœ›ç³»ç»Ÿå›å½’æœ€å¹²å‡€çš„çŠ¶æ€ï¼Œå¯ä»¥åœ¨**å‘½ä»¤è¡Œçª—å£ï¼ˆcmdï¼‰**è¾“å…¥ä¸‹è¿°æŒ‡ä»¤å¹¶å›è½¦â†©ï¸ï¼Œè¿™æ¡æŒ‡ä»¤çš„æ„æ€æ˜¯å¸è½½å½“å‰ Python ç¯å¢ƒä¸­æ‰€æœ‰é€šè¿‡ pip å®‰è£…çš„åŒ…ã€‚</p>
<pre><code class="hljs language-shell" lang="shell">for /F "delims==" %i in ('pip freeze') do pip uninstall -y %i
</code></pre>
<p>æ‰§è¡Œå®Œæ¯•åï¼Œç³»ç»Ÿä¸­å°±åªå‰©ä¸‹ Python è§£é‡Šå™¨æœ¬èº«äº†ã€‚æ­¤æ—¶ï¼Œä½ å¯ä»¥å¸è½½ Pythonã€‚å®Œæˆä¹‹åï¼Œä½ çš„ç³»ç»Ÿå°±åŸºæœ¬å›åˆ°äº†å®‰è£…å‰çš„çŠ¶æ€ã€‚å¦‚æœä½ ä¹‹åè¿˜éœ€è¦ä½¿ç”¨ Pythonï¼Œé‡æ–°ä¸‹è½½å®‰è£…ä¸€ä¸ªå…¨æ–°ç‰ˆæœ¬å³å¯ï¼Œè¿™æ ·å°±æ˜¯ä¸€ä¸ªâ€œä»é›¶å¼€å§‹â€çš„çº¯å‡€ç¯å¢ƒã€‚</p>
<h3 data-id="heading-8">ä¸‰. åˆ†ç±»ä»»åŠ¡</h3>
<blockquote>
<p>æœ¬ç¯‡æ•™ç¨‹çš„åšé£åœ¨å®è·µä¸­å­¦ä¹ ï¼Œåœ¨é¡¹ç›®ä¸­æˆé•¿â€ï¼›åœ¨è¿™ä¸€ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€èµ·å®Œæˆä¸€ä¸ªå®Œæ•´çš„å›¾åƒåˆ†ç±»é¡¹ç›®â€”â€”ä»æ•°æ®å‡†å¤‡åˆ°æ¨¡å‹è®­ç»ƒï¼Œè®©ä½ çœŸæ­£æŒæ¡YOLOv11åœ¨åˆ†ç±»ä»»åŠ¡ä¸­çš„åº”ç”¨ã€‚</p>
</blockquote>
<p><strong>ä»€ä¹ˆæ˜¯åˆ†ç±»ä»»åŠ¡ï¼Ÿ</strong> æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ çœ‹åˆ°ä¸€å¼ èŠ±çš„ç…§ç‰‡æ—¶ï¼Œèƒ½å¤Ÿç«‹åˆ»è®¤å‡ºå®ƒæ˜¯ç«ç‘°è¿˜æ˜¯å‘æ—¥è‘µâ€”â€”è¿™å°±æ˜¯å›¾åƒåˆ†ç±»è¦è§£å†³çš„é—®é¢˜ã€‚åœ¨AIä¸–ç•Œä¸­ï¼Œåˆ†ç±»ä»»åŠ¡å°±æ˜¯è®©è®¡ç®—æœºå­¦ä¼šè¿™ç§â€œè¯†åˆ«â€èƒ½åŠ›ï¼šä½ é¢„å…ˆå®šä¹‰å¥½è‹¥å¹²ç±»åˆ«ï¼ˆæ¯”å¦‚ä¸åŒå“ç§çš„èŠ±ï¼‰ï¼Œç„¶åç»™æ¨¡å‹è¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œå®ƒå°±èƒ½å‘Šè¯‰ä½ è¿™å¼ å›¾ç‰‡æœ€å¯èƒ½å±äºå“ªä¸ªç±»åˆ«ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80e09b49cc8d493f85254e34a49ddaf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=D0JO%2BBCUlDBaDYrAScfhkORbc0w%3D" alt="cn9.jpg" loading="lazy"/></p>
<h4 data-id="heading-9">3.1 å‡†å¤‡æ•°æ®é›†</h4>
<p>ä¿—è¯è¯´â€œå·§å¦‡éš¾ä¸ºæ— ç±³ä¹‹ç‚Šâ€ï¼Œæ²¡æœ‰é«˜è´¨é‡çš„æ•°æ®é›†ï¼Œå†å…ˆè¿›çš„ç®—æ³•ä¹Ÿæ— ç”¨æ­¦ä¹‹åœ°ã€‚è¿™é‡Œä»¥â€œèŠ±å‰ç§ç±»è¯†åˆ«â€ä¸ºä¾‹ï¼Œè¯¦ç»†è®²è§£å¦‚ä½•å‡†å¤‡ä¸€ä¸ªè§„èŒƒçš„åˆ†ç±»æ•°æ®é›†ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬è¦è®­ç»ƒä¸€ä¸ªèƒ½å¤Ÿè¯†åˆ«4ç§èŠ±å‰çš„æ¨¡å‹ï¼šå‘æ—¥è‘µ(sunflower)ã€ç«ç‘°(rose)ã€éƒé‡‘é¦™(tulip)å’Œå…°èŠ±(orchid)ã€‚ä½ éœ€è¦æŒ‰ç…§ä»¥ä¸‹ç›®å½•ç»“æ„ç»„ç»‡ä½ çš„æ•°æ®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">flowersdataset/
â”‚
â”œâ”€â”€ train/                 <span class="hljs-comment"># è®­ç»ƒé›† - ç”¨äºæ¨¡å‹å­¦ä¹ </span>
â”‚   â”œâ”€â”€ sunflower/         <span class="hljs-comment"># å‘æ—¥è‘µç±»åˆ«ï¼Œå­˜æ”¾æ‰€æœ‰å‘æ—¥è‘µçš„è®­ç»ƒå›¾ç‰‡</span>
â”‚   â”‚   â”œâ”€â”€ img_001.jpg
â”‚   â”‚   â”œâ”€â”€ img_002.jpg
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ rose/             <span class="hljs-comment"># ç«ç‘°ç±»åˆ«ï¼Œå­˜æ”¾æ‰€æœ‰ç«ç‘°çš„è®­ç»ƒå›¾ç‰‡</span>
â”‚   â”œâ”€â”€ tulip/            <span class="hljs-comment"># éƒé‡‘é¦™ç±»åˆ«ï¼Œå­˜æ”¾æ‰€æœ‰éƒé‡‘é¦™çš„è®­ç»ƒå›¾ç‰‡</span>
â”‚   â””â”€â”€ orchid/           <span class="hljs-comment"># å…°èŠ±ç±»åˆ«ï¼Œå­˜æ”¾æ‰€æœ‰å…°èŠ±çš„è®­ç»ƒå›¾ç‰‡</span>
â”‚
â””â”€â”€ <span class="hljs-built_in">test</span>/                 <span class="hljs-comment"># æµ‹è¯•é›† - ç”¨äºè¯„ä¼°æ¨¡å‹</span>
    â”œâ”€â”€ sunflower/
    â”œâ”€â”€ rose/
    â”œâ”€â”€ tulip/
    â””â”€â”€ orchid/
</code></pre>
<p>ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸ºâ€œflowersdatasetâ€çš„ä¸»æ–‡ä»¶å¤¹ï¼ˆåç§°å¯ä»¥ä»»æ„å–ï¼Œæœ€å¥½æ˜¯è‹±æ–‡ï¼‰ï¼Œç„¶ååœ¨ä¸»æ–‡ä»¶å¤¹ä¸‹å†åˆ›å»º<code>train</code>å’Œ<code>test</code>ä¸¤ä¸ªæ–‡ä»¶å¤¹(è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹åç§°ä¸èƒ½æ”¹ï¼Œå¿…é¡»æ˜¯è¿™ä¸ªï¼)ï¼›æœ€åï¼Œåœ¨æ¯ä¸ªæ–‡ä»¶å¤¹å†…ï¼Œä¸ºæ¯ä¸ªç±»åˆ«åˆ›å»ºå¯¹åº”çš„å­æ–‡ä»¶å¤¹ï¼ˆå»ºè®®ä½¿ç”¨è‹±æ–‡ç±»åˆ«åï¼‰ï¼Œç„¶ååœ¨å„è‡ªç±»åˆ«ä¸‹çš„æ–‡ä»¶å¤¹ä¸­æ”¾ç½®å„è‡ªç±»åˆ«çš„å›¾ç‰‡ã€‚</p>
<p>è¿™é‡Œä½ å¯èƒ½ä¼šé—®ï¼Œä¸ºä»€ä¹ˆæœ‰â€œtrainâ€å’Œâ€œtestâ€ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Ÿå…¨éƒ¨æ”¾åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ä¸å°±å¥½äº†å—ï¼Ÿè¿™é‡Œçš„trainæ˜¯æŒ‡è®­ç»ƒé›†ï¼Œå°±æ˜¯AIå®é™…ä¸Šä¼šç”¨è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­çš„å›¾åƒæ¥è¿›è¡Œè®­ç»ƒã€‚å¦‚æœæ­¤æ—¶æ²¡æœ‰æµ‹è¯•é›†ï¼ˆtestï¼‰ï¼Œé‚£å°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“æˆ‘è®­ç»ƒçš„AIæ•ˆæœå¥½ä¸å¥½ï¼Œæ˜¯ä¸æ˜¯åœ¨è®­ç»ƒé›†ä¸Šè¿‡æ‹Ÿåˆï¼Ÿ</p>
<ul>
<li><strong>è®­ç»ƒé›†</strong> å°±åƒæ˜¯<strong>å­¦ç”Ÿçš„â€œæ•™ç§‘ä¹¦â€å’Œâ€œç»ƒä¹ å†Œâ€</strong>ã€‚AIé€šè¿‡åå¤å­¦ä¹ è¿™é‡Œçš„å›¾ç‰‡ï¼Œæ¥æŒæ¡â€œå‘æ—¥è‘µâ€ã€â€œç«ç‘°â€é•¿ä»€ä¹ˆæ ·ã€‚</li>
<li><strong>æµ‹è¯•é›†</strong> åˆ™æ˜¯<strong>ä»æœªè§è¿‡çš„â€œæœŸæœ«è€ƒè¯•è¯•å·â€</strong>ã€‚å®ƒä¸å‚ä¸å­¦ä¹ è¿‡ç¨‹ï¼Œä¸“é—¨ç”¨äºè¯„ä¼°AIæ˜¯å¦çœŸæ­£ç†è§£äº†çŸ¥è¯†ï¼Œè€Œä¸æ˜¯ä»…ä»…è®°ä½äº†ç»ƒä¹ å†Œä¸Šçš„ç­”æ¡ˆã€‚</li>
</ul>
<p>å¦‚æœæ²¡æœ‰æµ‹è¯•é›†ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè®­ç»ƒå‡ºä¸€ä¸ªåœ¨â€œç»ƒä¹ å†Œâ€ä¸Šå¾—æ»¡åˆ†ï¼Œä½†ä¸€é‡åˆ°æ–°é¢˜ç›®å°±æŠ“ççš„â€œä¹¦å‘†å­æ¨¡å‹â€ï¼Œè¿™ç§ç°è±¡å°±æ˜¯<strong>è¿‡æ‹Ÿåˆ</strong>ã€‚æµ‹è¯•é›†è®©æˆ‘ä»¬èƒ½åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­éšæ—¶â€œæŠ½è€ƒâ€æ¨¡å‹ï¼Œå®¢è§‚åœ°è¡¡é‡å®ƒçš„çœŸå®æ°´å¹³ã€‚</p>
<p>ä¸€ä¸ªç»å…¸ä¸”ç¨³å¦¥çš„åšæ³•æ˜¯æŒ‰ç…§ <strong>8:2</strong> æˆ– <strong>9:1</strong> çš„æ¯”ä¾‹æ¥åˆ’åˆ†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰1000å¼ å‘æ—¥è‘µçš„å›¾ç‰‡ï¼Œé‚£ä¹ˆæ”¾800å¼ åˆ° <code>train/sunflower</code> æ–‡ä»¶å¤¹ï¼Œå‰©ä¸‹çš„200å¼ æ”¾å…¥ <code>test/sunflower</code>ã€‚è¿™èƒ½ç¡®ä¿æ¨¡å‹æœ‰è¶³å¤Ÿçš„æ•°æ®å­¦ä¹ ï¼ŒåŒæ—¶ä¹Ÿæœ‰å……è¶³çš„æ•°æ®è¿›è¡Œæµ‹è¯•ã€‚</p>
<p>å…³äºå›¾ç‰‡çš„å¤§å°å’Œæ ¼å¼ï¼Œä¹Ÿæ˜¯æœ‰è¦æ±‚çš„ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>æ ¼å¼ç»Ÿä¸€</strong>ï¼šè™½ç„¶YOLOæ”¯æŒå¤šç§æ ¼å¼ï¼Œä½†<strong>å¼ºçƒˆå»ºè®®å°†æ‰€æœ‰å›¾ç‰‡ç»Ÿä¸€ä¸º <code>.jpg</code> æ ¼å¼</strong>ã€‚è¿™ä¸ä»…å‡å°‘äº†æ½œåœ¨çš„å…¼å®¹æ€§é—®é¢˜ï¼Œè€Œä¸”é€šå¸¸æ‹¥æœ‰æ›´å°çš„ä½“ç§¯å’Œæ›´å¿«çš„å¤„ç†é€Ÿåº¦ã€‚</li>
<li><strong>å°ºå¯¸ç»Ÿä¸€</strong>ï¼šYOLOæ¨¡å‹æœŸæœ›è¾“å…¥çš„æ˜¯<strong>æ­£æ–¹å½¢å›¾ç‰‡</strong>ã€‚æœ€å¸¸ç”¨çš„å°ºå¯¸æ˜¯ <strong>640x640</strong> åƒç´ ã€‚**é€šå¸¸ä½ ä¸éœ€è¦æ‰‹åŠ¨è£å‰ªæ¯ä¸€å¼ å›¾ï¼ŒYOLOä¼šè‡ªåŠ¨å¸®ä½ å®Œæˆç¼©æ”¾å’Œå¡«å……ã€‚**å½“ç„¶ï¼Œå¦‚æœä½ èƒ½æå‰ç”¨å·¥å…·æ‰¹é‡å¤„ç†å¥½ï¼Œè®­ç»ƒæ•ˆç‡ä¼šæ›´é«˜ã€‚</li>
<li><strong>å‘½åè‡ªç”±</strong>ï¼šå›¾ç‰‡çš„æ–‡ä»¶åå¯ä»¥ä»»æ„å–ï¼Œ<code>123.jpg</code> æˆ– <code>a_beautiful_flower.jpg</code> éƒ½å¯ä»¥ï¼ŒYOLOä¸å…³å¿ƒè¿™ä¸ªã€‚åªè¦ä¿è¯æ–‡ä»¶åä¸é‡å¤ï¼Œä½ è‡ªå·±èƒ½ç®¡ç†å³å¯ã€‚</li>
</ol>
<p>å›¾ç‰‡é¢„å¤„ç†ï¼ˆå¦‚æ‰¹é‡æ ¼å¼è½¬æ¢ã€é‡å‘½åã€æ™ºèƒ½è£å‰ªï¼‰æ˜¯ä¸€ä¸ªé‡è¦çš„æ­¥éª¤ï¼Œä½†ä¸ºäº†ä¸å†²æ·¡æœ¬æ•™ç¨‹çš„ä¸»é¢˜ï¼Œä¸åœ¨æ­¤å¤„ç»†è®²ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œæœç´¢å›¾ç‰‡é¢„å¤„ç†çš„å·¥å…·ï¼Œå¦å¤–æˆ‘å·²å°†ä¸€äº›<strong>é«˜æ•ˆçš„æ‰¹é‡å¤„ç†å·¥å…·å’Œè¯¦ç»†ä½¿ç”¨è¯´æ˜</strong>æ•´ç†æ‰“åŒ…ï¼Œæ”¾åœ¨äº†ä¸Šæ–‡æä¾›çš„ç½‘ç›˜é“¾æ¥ä¸­äº†ï¼Œåç§°ä¸º<code>å¸¸ç”¨Pythoné¢„å¤„ç†è„šæœ¬.zip</code>,å¤§å®¶å¯ä»¥è‡ªè¡Œä¸‹è½½ä½¿ç”¨ã€‚</p>
<hr/>
<p>æœ¬ç¯‡æ•™ç¨‹å°†ä¼šä»¥ä¸€ä¸ªæ’ç”»/ç°å®ï¼ˆreal/illustrationï¼‰äºŒåˆ†ç±»ä»»åŠ¡ä¸ºä¾‹ï¼Œå¸¦å¤§å®¶æ‰‹æŠŠæ‰‹èµ°ä¸€éç”¨YOLOv11è¿›è¡Œåˆ†ç±»ä»»åŠ¡çš„å…¨æµç¨‹ï¼Œæˆ‘ä»¬è¦<strong>è®­ç»ƒä¸€ä¸ªèƒ½è‡ªåŠ¨åŒºåˆ†â€œçœŸå®ç…§ç‰‡â€ä¸â€œåŠ¨æ¼«æ’ç”»â€çš„æ™ºèƒ½åˆ†ç±»æ¨¡å‹</strong>ã€‚ï¼ˆ<em>é¢˜å¤–è¯ï¼šå¦‚æœä½ æœ‰è¶…çº§å¤šäººç±»ç”»å¸ˆçš„ç”»å’ŒAIç»˜ç”»çš„ç”»ï¼Œä½ ä¹Ÿå¯ä»¥è®­ç»ƒä¸€ä¸ªäºŒåˆ†ç±»æ¨¡å‹æ¥åˆ†è¾¨ä¸€å¼ å›¾æ˜¯ä¸æ˜¯AIç”»çš„</em>ï¼‰</p>
<p>æ•°æ®é›†å¯ä»¥åœ¨ä¸Šæ–‡æä¾›çš„ç½‘ç›˜é“¾æ¥ä¸­ä¸‹è½½ï¼Œåä¸º<code>classify_dataset.zip</code>ï¼Œä¸‹è½½å¹¶è§£å‹åï¼Œä½ ä¼šå‘ç°å…¶æ–‡ä»¶å¤¹ç»“æ„ä¸ä¸Šè¿°è§„èŒƒå®Œå…¨ä¸€è‡´ã€‚è¿™å°±åƒä¸€ä¸ªæ ‡å‡†çš„â€œåˆ†ç±»é¡¹ç›®æ¨¡æ¿â€ï¼Œè¯·ä½ åœ¨æœªæ¥ç»„ç»‡è‡ªå·±çš„æ•°æ®æ—¶ï¼Œä¹ŸåŠ¡å¿…éµå¾ªåŒæ ·çš„è§„èŒƒâ€”â€”<strong>æ¸…æ™°çš„ç»“æ„æ˜¯é«˜æ•ˆè®­ç»ƒçš„å‰æ</strong>ï¼Œå®ƒèƒ½å¸®ä½ é¿å…å¤§é‡ä¸å¿…è¦çš„éº»çƒ¦ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/835a9f2e8ad944099569e447119145db~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=t2ZDpFsWFHqK1LRmv9K%2Ffycn%2F2M%3D" alt="c10.jpg" loading="lazy"/></p>
<h4 data-id="heading-10">3.2 æ¨¡å‹è®­ç»ƒ</h4>
<p>ç›¸æ¯”æ•°æ®é›†çš„æ”¶é›†å’Œé¢„å¤„ç†ï¼Œæ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹åˆ™æ˜¾å¾—éå¸¸ç®€å•ï¼Œå¾—ç›ŠäºYOLOæ¡†æ¶ä¼˜ç§€çš„å°è£…ï¼Œ<strong>è®©AIâ€œå­¦æœ‰æ‰€æˆâ€çš„æ ¸å¿ƒæ­¥éª¤ï¼Œä»…ä»…åªéœ€å‡ è¡Œä»£ç ï¼</strong></p>
<p>è¯·åœ¨ä½ çš„Pythonç¯å¢ƒä¸­æ–°å»ºä¸€ä¸ªpyæ–‡ä»¶ï¼Œå¹¶è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO  <span class="hljs-comment"># å¯¼å…¥YOLOåº“</span>

<span class="hljs-comment"># ç¡®ä¿åœ¨ä¸»ç¨‹åºä¸­è¿è¡Œ</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    <span class="hljs-comment"># 1. è½½å…¥é¢„è®­ç»ƒæ¨¡å‹ï¼Œè¯·åŠ¡å¿…æ›¿æ¢ä¸ºä½ è‡ªå·±çš„æ–‡ä»¶è·¯å¾„</span>
    model = YOLO(<span class="hljs-string">r"D:/WorkSpace/yolo11s-cls.pt"</span>)
    
    <span class="hljs-comment"># 2. å¯åŠ¨è®­ç»ƒï¼</span>
    results = model.train(
        data=<span class="hljs-string">r"D:/WorkSpace/classify_dataset"</span>,  <span class="hljs-comment"># æ•°æ®é›†çš„æ ¹ç›®å½•è·¯å¾„</span>
        batch=<span class="hljs-number">0.75</span>,                             <span class="hljs-comment"># æ‰¹æ¬¡å¤§å°ï¼Œè®¾ä¸ºæ˜¾å­˜çš„75%</span>
        project=<span class="hljs-string">"classification_training_results"</span>, <span class="hljs-comment"># ä¿å­˜è®­ç»ƒç»“æœçš„æ–‡ä»¶å¤¹å</span>
        deterministic=<span class="hljs-literal">False</span>,                    <span class="hljs-comment"># å…è®¸éç¡®å®šæ€§ä»¥åŠ é€Ÿè®­ç»ƒ</span>
        epochs=<span class="hljs-number">30</span>,                              <span class="hljs-comment"># è®­ç»ƒ30è½®</span>
        imgsz=<span class="hljs-number">640</span>,                              <span class="hljs-comment"># è¾“å…¥å›¾åƒç¼©æ”¾ä¸º640x640</span>
        degrees=<span class="hljs-number">60</span>,                             <span class="hljs-comment"># éšæœºæ—‹è½¬å¢å¼ºï¼šÂ±60åº¦</span>
        flipud=<span class="hljs-number">0.3</span>,                             <span class="hljs-comment"># 30%æ¦‚ç‡ä¸Šä¸‹ç¿»è½¬</span>
        fliplr=<span class="hljs-number">0.3</span>,                             <span class="hljs-comment"># 30%æ¦‚ç‡å·¦å³ç¿»è½¬</span>
    )
</code></pre>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€ä¸€æ‹†è§£è¿™äº›å‚æ•°ï¼Œè®©ä½ å½»åº•æ˜ç™½æ¯è¡Œä»£ç çš„æ„æ€ã€‚</p>
<p><strong>part1. æ¨¡å‹åˆå§‹åŒ–</strong></p>
<ol>
<li><code>model = YOLO(r"D:/WorkSpace/yolo11s-cls.pt")</code>å°±æ˜¯åŠ è½½é¢„è®­ç»ƒæ¨¡å‹ï¼Œå°†å…¶ä¸­çš„åœ°å€æ›´æ¢ä¸ºä½ è‡ªå·±çš„<code>yolo11s-cls.pt</code>æ–‡ä»¶å­˜æ”¾åœ°å€ã€‚</li>
<li><code>results = model.train()</code>å°±æ˜¯å¼€å§‹æ‰§è¡Œè®­ç»ƒï¼Œå…¶ä¸­å¯ä»¥åœ¨trainä¸­è¯¦ç»†é…ç½®æ­¤æ¬¡è®­ç»ƒçš„å„ç§å‚æ•°ã€‚</li>
</ol>
<p><strong>part2. trainä¸­å¯é…ç½®çš„é‡è¦å‚æ•°ï¼š</strong></p>
<blockquote>
<p>è¿™äº›å‚æ•°å†³å®šäº†æ¨¡å‹å¦‚ä½•å­¦ä¹ ï¼Œç›´æ¥å½±å“æœ€ç»ˆæ•ˆæœï¼š</p>
</blockquote>
<ol>
<li><code>data</code>ï¼šå‘Šè¯‰æ¨¡å‹ä½ çš„æ•°æ®é›†æ”¾åœ¨å“ªé‡Œã€‚</li>
<li><code>batch</code>ï¼šæ§åˆ¶â€œå­¦ä¹ å¼ºåº¦â€ä¸â€œç¡¬ä»¶å ç”¨â€ï¼ŒèŒƒå›´åœ¨<code>0~1</code>ï¼Œè®¾ç½®çš„è¶Šå¤§ï¼Œè®­ç»ƒé€Ÿåº¦è¶Šå¿«ã€‚ä½†ä¸èƒ½å¤ªå¤§ï¼Œå¦‚æœè®­ç»ƒæ—¶å‡ºç°æ˜¾å­˜ä¸è¶³ï¼ˆOOMï¼‰é”™è¯¯ï¼Œé€‚å½“è°ƒä½è¿™ä¸ªå€¼ï¼ˆå¦‚0.5ï¼‰ï¼›è¿™é‡Œè®¾ç½®ä¸º <code>0.75</code>ï¼Œæ„å‘³ç€ç¨‹åºä¼šåŠ¨æ€è®¡ç®—ï¼Œä½¿ç”¨ä½ GPUçº¦75%çš„æ˜¾å­˜æ¥è¿›è¡Œè®­ç»ƒã€‚</li>
<li><code>project</code>ï¼šå°±æ˜¯è®­ç»ƒå¥½çš„ç»“æœè¦å­˜æ”¾çš„æ–‡ä»¶å¤¹ï¼Œè¿™é‡Œè¾“å…¥çš„æ˜¯æ–‡ä»¶å¤¹åç§°ï¼Œå¯ä»¥ä»»æ„å‘½åã€‚</li>
<li><code>epochs</code>ï¼šå®šä¹‰æ¨¡å‹å°†å®Œæ•´æ•°æ®é›†å­¦ä¹ å¤šå°‘è½®ï¼Œä½ å¯ä»¥ç†è§£ä¸ºå¾ªç¯å‡ è½®ï¼Œè®¾ç½®çš„è¶Šå¤§ï¼Œè®­ç»ƒæ—¶é—´è¶Šä¹…ï¼Œæ•ˆæœè¶Šå¥½ã€‚è½®æ•°å¤ªå°‘ï¼Œæ¨¡å‹å­¦ä¸é€ï¼›è½®æ•°å¤ªå¤šï¼Œä¸ä»…è€—æ—¶ï¼Œè¿˜å¯èƒ½â€œå­¦å‚»â€ï¼ˆè¿‡æ‹Ÿåˆï¼‰ï¼Œä¸€èˆ¬æ¨è10~30å°±è¶³å¤Ÿå¯ä»¥æ”¶æ•›ï¼Œæ€»ä¹‹æ ¹æ®éªŒè¯é›†æ•ˆæœè°ƒæ•´ã€‚</li>
<li><code>imgsz</code>ï¼šç»Ÿä¸€è¾“å…¥å›¾åƒçš„å°ºå¯¸ã€‚è‹¥è®¾ç½®ä¸º <code>640</code>ï¼Œæ‰€æœ‰å›¾åƒåœ¨è®­ç»ƒå‰éƒ½ä¼šè¢«æ™ºèƒ½ç¼©æ”¾æˆ–å¡«å……ä¸º640x640çš„æ­£æ–¹å½¢ã€‚**è¿™ä¸ªå€¼å¿…é¡»ä¸ä½ é¢„å¤„ç†å›¾ç‰‡æ—¶çš„å°ºå¯¸ä¸€è‡´ã€‚**å¦‚æœä½ çš„è®­ç»ƒé›†å›¾ç‰‡æ˜¯480x480çš„æ­£æ–¹å½¢å›¾ç‰‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°å°±è¦è®¾ä¸º480ã€‚</li>
</ol>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šå‚æ•°å¯ä»¥é…ç½®ï¼Œæˆ‘ç½—åˆ—ä¸€äº›æ¯”è¾ƒé‡è¦çš„å‚æ•°ï¼Œä½ éœ€è¦çš„æ—¶å€™å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ï¼š</p>



























































































































































<table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">é»˜è®¤å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>time</code></td><td align="left"><code>float</code></td><td align="left"><code>None</code></td><td align="left">æœ€é•¿è®­ç»ƒæ—¶é—´ï¼ˆä»¥å°æ—¶ä¸ºå•ä½ï¼‰ã€‚å¦‚æœè®¾ç½®æ­¤å‚æ•°ï¼Œå®ƒå°†è¦†ç›– <code>epochs</code> å‚æ•°ï¼Œå…è®¸è®­ç»ƒåœ¨æŒ‡å®šæ—¶é•¿åè‡ªåŠ¨åœæ­¢ã€‚é€‚ç”¨äºæ—¶é—´å—é™çš„è®­ç»ƒåœºæ™¯ã€‚</td></tr><tr><td align="left"><code>patience</code></td><td align="left"><code>int</code></td><td align="left"><code>100</code></td><td align="left">åœ¨éªŒè¯æŒ‡æ ‡æ²¡æœ‰æ”¹å–„çš„æƒ…å†µä¸‹ï¼Œç­‰å¾…å¤šå°‘ä¸ªepochåæå‰åœæ­¢è®­ç»ƒã€‚é€šè¿‡åœ¨æ€§èƒ½åœæ»æ—¶åœæ­¢è®­ç»ƒï¼Œæœ‰åŠ©äºé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</td></tr><tr><td align="left"><code>save_period</code></td><td align="left"><code>int</code></td><td align="left"><code>-1</code></td><td align="left">ä¿å­˜æ¨¡å‹æ£€æŸ¥ç‚¹çš„é¢‘ç‡ï¼Œä»¥ epoch ä¸ºå•ä½æŒ‡å®šã€‚å€¼ä¸º -1 æ—¶ç¦ç”¨æ­¤åŠŸèƒ½ã€‚é€‚ç”¨äºåœ¨é•¿æ—¶é—´è®­ç»ƒæœŸé—´ä¿å­˜ä¸´æ—¶æ¨¡å‹ã€‚</td></tr><tr><td align="left"><code>cache</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">å¯ç”¨åœ¨å†…å­˜ä¸­ç¼“å­˜æ•°æ®é›†å›¾åƒï¼ˆ<code>True</code>/<code>ram</code>ï¼‰ï¼Œåœ¨ç£ç›˜ä¸Šç¼“å­˜ï¼ˆ<code>disk</code>ï¼‰ï¼Œæˆ–ç¦ç”¨ç¼“å­˜ï¼ˆ<code>False</code>ï¼‰ã€‚é€šè¿‡å‡å°‘ç£ç›˜ I/O æ¥æé«˜è®­ç»ƒé€Ÿåº¦ï¼Œä½†ä¼šå¢åŠ å†…å­˜ä½¿ç”¨é‡ã€‚</td></tr><tr><td align="left"><code>device</code></td><td align="left"><code>int</code> æˆ– <code>str</code> æˆ– <code>list</code></td><td align="left"><code>None</code></td><td align="left">æŒ‡å®šç”¨äºè®­ç»ƒçš„è®¡ç®—è®¾å¤‡ï¼šå•ä¸ª GPUï¼ˆ<code>device=0</code>ï¼‰ï¼Œå¤šä¸ª GPUï¼ˆ<code>device=[0,1]</code>ï¼‰ï¼ŒCPUï¼ˆ<code>device=cpu</code>ï¼‰ï¼Œé€‚ç”¨äº Apple èŠ¯ç‰‡çš„ MPSï¼ˆ<code>device=mps</code>ï¼‰ï¼Œæˆ–è‡ªåŠ¨é€‰æ‹©æœ€ç©ºé—²çš„ GPUï¼ˆ<code>device=-1</code>ï¼‰æˆ–å¤šä¸ªç©ºé—² GPU ï¼ˆ<code>device=[-1,-1]</code>)</td></tr><tr><td align="left"><code>workers</code></td><td align="left"><code>int</code></td><td align="left"><code>8</code></td><td align="left">ç”¨äºæ•°æ®åŠ è½½çš„å·¥ä½œçº¿ç¨‹æ•°ï¼ˆæ¯ä¸ª <code>RANK</code> ï¼Œå¦‚æœæ˜¯å¤š GPU è®­ç»ƒï¼‰ã€‚å½±å“æ•°æ®é¢„å¤„ç†å’Œè¾“å…¥æ¨¡å‹çš„é€Ÿåº¦ï¼Œåœ¨å¤š GPU è®¾ç½®ä¸­å°¤å…¶æœ‰ç”¨ã€‚</td></tr><tr><td align="left"><code>project</code></td><td align="left"><code>str</code></td><td align="left"><code>None</code></td><td align="left">é¡¹ç›®ç›®å½•çš„åç§°ï¼Œè®­ç»ƒè¾“å‡ºä¿å­˜åœ¨æ­¤ç›®å½•ä¸­ã€‚å…è®¸æœ‰ç»„ç»‡åœ°å­˜å‚¨ä¸åŒçš„å®éªŒã€‚</td></tr><tr><td align="left"><code>name</code></td><td align="left"><code>str</code></td><td align="left"><code>None</code></td><td align="left">è®­ç»ƒè¿è¡Œçš„åç§°ã€‚ç”¨äºåœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªå­ç›®å½•ï¼Œè®­ç»ƒæ—¥å¿—å’Œè¾“å‡ºå­˜å‚¨åœ¨è¯¥å­ç›®å½•ä¸­ã€‚</td></tr><tr><td align="left"><code>optimizer</code></td><td align="left"><code>str</code></td><td align="left"><code>'auto'</code></td><td align="left">è®­ç»ƒä¼˜åŒ–å™¨çš„é€‰æ‹©ã€‚é€‰é¡¹åŒ…æ‹¬ <code>SGD</code>, <code>Adam</code>, <code>AdamW</code>, <code>NAdam</code>, <code>RAdam</code>, <code>RMSProp</code> ç­‰ç­‰ï¼Œæˆ–è€… <code>auto</code> ç”¨äºåŸºäºæ¨¡å‹é…ç½®è‡ªåŠ¨é€‰æ‹©ã€‚å½±å“æ”¶æ•›é€Ÿåº¦å’Œç¨³å®šæ€§ã€‚</td></tr><tr><td align="left"><code>deterministic</code></td><td align="left"><code>bool</code></td><td align="left"><code>True</code></td><td align="left">å¼ºåˆ¶ä½¿ç”¨ç¡®å®šæ€§ç®—æ³•ï¼Œç¡®ä¿å¯é‡å¤æ€§ï¼Œä½†ç”±äºé™åˆ¶äº†éç¡®å®šæ€§ç®—æ³•ï¼Œå¯èƒ½ä¼šå½±å“æ€§èƒ½å’Œé€Ÿåº¦ã€‚</td></tr><tr><td align="left"><code>single_cls</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">åœ¨å¤šç±»åˆ«æ•°æ®é›†ä¸­ï¼Œå°†æ‰€æœ‰ç±»åˆ«è§†ä¸ºå•ä¸ªç±»åˆ«è¿›è¡Œè®­ç»ƒã€‚é€‚ç”¨äºäºŒå…ƒåˆ†ç±»ä»»åŠ¡æˆ–ä¾§é‡äºå¯¹è±¡æ˜¯å¦å­˜åœ¨è€Œéåˆ†ç±»æ—¶ã€‚</td></tr><tr><td align="left"><code>classes</code></td><td align="left"><code>list[int]</code></td><td align="left"><code>None</code></td><td align="left">æŒ‡å®šè¦è®­ç»ƒçš„ç±» ID åˆ—è¡¨ã€‚å¯ç”¨äºåœ¨è®­ç»ƒæœŸé—´è¿‡æ»¤æ‰å¹¶ä»…å…³æ³¨æŸäº›ç±»ã€‚</td></tr><tr><td align="left"><code>rect</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">å¯ç”¨æœ€å°å¡«å……ç­–ç•¥â€”â€”æ‰¹é‡ä¸­çš„å›¾åƒè¢«æœ€å°ç¨‹åº¦åœ°å¡«å……ä»¥è¾¾åˆ°ä¸€ä¸ªå…±åŒçš„å¤§å°ï¼Œæœ€é•¿è¾¹ç­‰äº <code>imgsz</code>ã€‚å¯ä»¥æé«˜æ•ˆç‡å’Œé€Ÿåº¦ï¼Œä½†å¯èƒ½ä¼šå½±å“æ¨¡å‹ç²¾åº¦ã€‚</td></tr><tr><td align="left"><code>multi_scale</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">é€šè¿‡å¢åŠ /å‡å°‘æ¥å¯ç”¨å¤šå°ºåº¦è®­ç»ƒ <code>imgsz</code> é«˜è¾¾ <code>0.5</code> åœ¨è®­ç»ƒæœŸé—´ã€‚è®­ç»ƒæ¨¡å‹ï¼Œä½¿å…¶åœ¨å¤šæ¬¡è¿­ä»£ä¸­æ›´åŠ å‡†ç¡® <code>imgsz</code> åœ¨æ¨ç†è¿‡ç¨‹ä¸­ã€‚</td></tr><tr><td align="left"><code>cos_lr</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">ä½¿ç”¨ä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦å™¨ï¼Œåœ¨ epochs ä¸ŠæŒ‰ç…§ä½™å¼¦æ›²çº¿è°ƒæ•´å­¦ä¹ ç‡ã€‚æœ‰åŠ©äºç®¡ç†å­¦ä¹ ç‡ï¼Œä»è€Œå®ç°æ›´å¥½çš„æ”¶æ•›ã€‚</td></tr><tr><td align="left"><code>close_mosaic</code></td><td align="left"><code>int</code></td><td align="left"><code>10</code></td><td align="left">åœ¨æœ€å N ä¸ª epochs ä¸­ç¦ç”¨ mosaicæ•°æ®å¢å¼ºï¼Œä»¥åœ¨å®Œæˆå‰ç¨³å®šè®­ç»ƒã€‚è®¾ç½®ä¸º 0 å¯ç¦ç”¨æ­¤åŠŸèƒ½ã€‚</td></tr><tr><td align="left"><code>resume</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">ä»ä¸Šæ¬¡ä¿å­˜çš„æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒã€‚è‡ªåŠ¨åŠ è½½æ¨¡å‹æƒé‡ã€ä¼˜åŒ–å™¨çŠ¶æ€å’Œ epoch è®¡æ•°ï¼Œæ— ç¼ç»§ç»­è®­ç»ƒã€‚</td></tr><tr><td align="left"><code>amp</code></td><td align="left"><code>bool</code></td><td align="left"><code>True</code></td><td align="left">å¯ç”¨è‡ªåŠ¨æ··åˆç²¾åº¦ï¼ˆAMPï¼‰è®­ç»ƒï¼Œå‡å°‘å†…å­˜ä½¿ç”¨ï¼Œå¹¶å¯èƒ½åœ¨å¯¹å‡†ç¡®æ€§å½±å“æœ€å°çš„æƒ…å†µä¸‹åŠ å¿«è®­ç»ƒé€Ÿåº¦ã€‚</td></tr><tr><td align="left"><code>fraction</code></td><td align="left"><code>float</code></td><td align="left"><code>1.0</code></td><td align="left">æŒ‡å®šç”¨äºè®­ç»ƒçš„æ•°æ®é›†æ¯”ä¾‹ã€‚å…è®¸åœ¨å®Œæ•´æ•°æ®é›†çš„å­é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œè¿™åœ¨å®éªŒæˆ–èµ„æºæœ‰é™æ—¶éå¸¸æœ‰ç”¨ã€‚</td></tr><tr><td align="left"><code>freeze</code></td><td align="left"><code>int</code> æˆ– <code>list</code></td><td align="left"><code>None</code></td><td align="left">å†»ç»“æ¨¡å‹çš„å‰ N å±‚æˆ–æŒ‰ç´¢å¼•æŒ‡å®šçš„å±‚ï¼Œä»è€Œå‡å°‘å¯è®­ç»ƒå‚æ•°çš„æ•°é‡ã€‚é€‚ç”¨äºå¾®è°ƒæˆ–è¿ç§»å­¦ä¹ ã€‚</td></tr><tr><td align="left"><code>lr0</code></td><td align="left"><code>float</code></td><td align="left"><code>0.01</code></td><td align="left">åˆå§‹å­¦ä¹ ç‡ï¼ˆå³ <code>SGD=1E-2</code>, <code>Adam=1E-3</code>)ã€‚è°ƒæ•´æ­¤å€¼å¯¹äºä¼˜åŒ–è¿‡ç¨‹è‡³å…³é‡è¦ï¼Œå®ƒä¼šå½±å“æ¨¡å‹æƒé‡æ›´æ–°çš„é€Ÿåº¦ã€‚</td></tr><tr><td align="left"><code>lrf</code></td><td align="left"><code>float</code></td><td align="left"><code>0.01</code></td><td align="left">æœ€ç»ˆå­¦ä¹ ç‡ä½œä¸ºåˆå§‹é€Ÿç‡çš„ä¸€éƒ¨åˆ† = (<code>lr0 * lrf</code>ï¼‰ï¼Œä¸è°ƒåº¦å™¨ç»“åˆä½¿ç”¨ä»¥éšæ—¶é—´è°ƒæ•´å­¦ä¹ ç‡ã€‚</td></tr><tr><td align="left"><code>weight_decay</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0005</code></td><td align="left">L2 æ­£åˆ™åŒ–é¡¹ï¼Œæƒ©ç½šå¤§æƒé‡ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚</td></tr><tr><td align="left"><code>dropout</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left">åˆ†ç±»ä»»åŠ¡ä¸­ç”¨äºæ­£åˆ™åŒ–çš„ Dropout ç‡ï¼Œé€šè¿‡åœ¨è®­ç»ƒæœŸé—´éšæœºçœç•¥å•å…ƒæ¥é˜²æ­¢è¿‡æ‹Ÿåˆã€‚</td></tr></tbody></table>
<p>æœ€åï¼Œå…³æ‰ç½‘ç»œï¼ˆ<strong>å»ºè®®æ‚¨æš‚æ—¶æ–­å¼€ç½‘ç»œè¿æ¥</strong>ã€‚è¿™å¯ä»¥é˜²æ­¢å› ç¯å¢ƒè‡ªåŠ¨å°è¯•ä¸‹è½½æ›´æ–°æˆ–é¢å¤–æ¨¡å‹è€Œå¯èƒ½å¼•å‘çš„æ„å¤–é”™è¯¯ï¼Œç¡®ä¿è®­ç»ƒè¿‡ç¨‹çº¯å‡€ã€å¯æ§ã€‚ï¼‰ï¼Œå°†ä½ é…ç½®å¥½çš„ä»£ç ç›´æ¥ç”¨Pythonè¿è¡Œï¼Œå®ƒå°±å¼€å§‹è¿›è¡Œè®­ç»ƒäº†ã€‚ï¼ˆæ³¨æ„ï¼šè¯·åŠ¡å¿…åœ¨ <strong><code>.py</code> æ–‡ä»¶</strong>ä¸­æ‰§è¡Œä¸Šè¿°è®­ç»ƒä»£ç ï¼Œè€Œé Jupyter Notebook ç­‰äº¤äº’å¼ç¯å¢ƒã€‚ï¼‰</p>
<p>åœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºçš„è¿™äº›å†…å®¹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a060f2337c5148f99ebb7b4ca7540787~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=sxtH1IKD8cyx%2BfYBAPpoYna5Opg%3D" alt="v1.jpg" loading="lazy"/></p>
<p>ä»¥ä¸Šå›¾ä¸ºä¾‹ï¼Œé€ä¸€è§£è¯»è¿™äº›å…³é”®æŒ‡æ ‡çš„æ„ä¹‰ï¼š</p>
<ul>
<li><strong><code>Epoch n/30</code></strong>
è¿™è¡¨ç¤ºè®­ç»ƒçš„æ€»è½®æ•°ï¼ˆepochsï¼‰è®¾ç½®ä¸º30ï¼Œå½“å‰æ­£å¤„äºç¬¬nè½®ã€‚ä½ å¯ä»¥ç›´è§‚åœ°çœ‹åˆ°è®­ç»ƒè¿›åº¦ï¼Œé¢„ä¼°å‰©ä½™æ—¶é—´ã€‚</li>
<li><strong><code>GPU_mem 7.96G</code></strong>
è¿™æ˜¾ç¤ºäº†å½“å‰è®­ç»ƒä»»åŠ¡å ç”¨çš„GPUæ˜¾å­˜ã€‚å®ƒæ˜¯ä½ è°ƒæ•´ <code>batch</code> å‚æ•°çš„é‡è¦å‚è€ƒâ€”â€”å¦‚æœæ­¤å¤„æ¥è¿‘ä½ çš„æ˜¾å­˜ä¸Šé™ï¼Œä¸‹æ¬¡è®­ç»ƒæ—¶å¯é€‚å½“è°ƒä½ <code>batch</code> å€¼ã€‚</li>
<li><strong><code>loss</code> (æŸå¤±å‡½æ•°å€¼)</strong>
è¿™æ˜¯æ¨¡å‹é¢„æµ‹ä¸çœŸå®æ ‡ç­¾ä¹‹é—´çš„è¯¯å·®ï¼Œæ˜¯<strong>è¯„ä¼°æ¨¡å‹å­¦ä¹ æ•ˆæœçš„æ ¸å¿ƒæŒ‡æ ‡</strong>ã€‚
<ul>
<li><strong>ç†æƒ³æƒ…å†µ</strong>ï¼šloss å€¼éšè®­ç»ƒè½®æ•°ç¨³å®šä¸‹é™ï¼Œè¯´æ˜æ¨¡å‹æ­£åœ¨æœ‰æ•ˆå­¦ä¹ ã€‚</li>
<li><strong>è­¦æƒ•è¿‡æ‹Ÿåˆ</strong>ï¼šå¦‚æœ loss é™è‡³æä½ï¼ˆå¦‚ 0.01 ä»¥ä¸‹ï¼‰ï¼Œä½†æµ‹è¯•é›†å‡†ç¡®ç‡ä¸é«˜ï¼Œåˆ™æ¨¡å‹å¯èƒ½â€œæ­»è®°ç¡¬èƒŒâ€äº†è®­ç»ƒé›†ï¼Œæ³›åŒ–èƒ½åŠ›å·®ã€‚</li>
<li><strong>è­¦æƒ•æ¬ æ‹Ÿåˆ</strong>ï¼šå¦‚æœ loss åœ¨è¾ƒé«˜æ•°å€¼ï¼ˆå¦‚ 1.0 å·¦å³ï¼‰å¾˜å¾Šä¸ä¸‹ï¼Œè¯´æ˜æ¨¡å‹æœªèƒ½ä»æ•°æ®ä¸­å­¦åˆ°æœ‰æ•ˆè§„å¾‹ï¼Œéœ€è¦æ£€æŸ¥æ•°æ®è´¨é‡ã€æ¨¡å‹ç»“æ„æˆ–å­¦ä¹ ç‡ã€‚</li>
</ul>
</li>
<li><strong><code>top1_acc 0.929</code></strong>
è¿™ä»£è¡¨äº†æ¨¡å‹åœ¨<strong>æµ‹è¯•é›†</strong>ä¸Šçš„<strong>Top-1å‡†ç¡®ç‡</strong>ï¼Œå³æ¨¡å‹è®¤ä¸ºæœ€å¯èƒ½çš„é‚£ä¸ªç­”æ¡ˆæ­£å¥½æ˜¯æ­£ç¡®ç­”æ¡ˆçš„æ¦‚ç‡ã€‚<strong>0.929 æ„å‘³ç€å½“å‰æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šè¾¾åˆ°äº† 92.9% çš„è¯†åˆ«å‡†ç¡®ç‡</strong>ï¼Œè¿™è¯´æ˜å®ƒå·²ç»æ˜¯ä¸€ä¸ªéå¸¸å¯é çš„â€œæ¬¡å…ƒé‰´å®šå¸ˆâ€äº†ã€‚</li>
</ul>
<p>å½“æ§åˆ¶å°å‡ºç°ç±»ä¼¼ä¸‹å›¾çš„æç¤ºï¼Œå¹¶æœ€ç»ˆåœæ­¢è¿è¡Œæ—¶ï¼Œå°±ä»£è¡¨å·²ç»è®­ç»ƒå®Œäº†ã€‚æ­¤æ—¶ï¼Œæ‰€æœ‰è®­ç»ƒæˆæœâ€”â€”åŒ…æ‹¬æœ€ç»ˆæ¨¡å‹æƒé‡ã€è®­ç»ƒè¿‡ç¨‹å›¾è¡¨ã€è¯¦ç»†é…ç½®ç­‰â€”â€”éƒ½å·²è‡ªåŠ¨ä¿å­˜åœ¨ä½ æŒ‡å®šçš„ <code>classification_training_results</code> æ–‡ä»¶å¤¹ä¸­ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/71a3a21c06a545b3b5b16bbb92e936e5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=k2u%2BvWsPa2uVUlouxzmC88%2BTWQ8%3D" alt="v2.jpg" loading="lazy"/></p>
<h4 data-id="heading-11">3.3 ç»“æœæ•°æ®è§£è¯»</h4>
<p>å¦‚æœä½ å¤šæ¬¡è¿è¡Œè®­ç»ƒä»£ç ï¼Œä¼šåœ¨ <code>classification_training_results</code> ç›®å½•ä¸‹çœ‹åˆ°å¤šä¸ª <code>train</code>ã€<code>train2</code>ã€<code>train3</code>â€¦â€¦è¿™æ ·çš„æ–‡ä»¶å¤¹ã€‚æ¯ä¸€ä¸ªéƒ½å¯¹åº”ç€ä½ æŸä¸€æ¬¡è®­ç»ƒè¿‡ç¨‹çš„å®Œæ•´è®°å½•ã€‚</p>
<p>æ‰¾åˆ°ä½ æˆåŠŸçš„é‚£æ¬¡è®­ç»ƒæ‰€å¯¹åº”çš„trainæ–‡ä»¶å¤¹ï¼Œç‚¹è¿›å»ï¼Œè¿™é‡Œé¢çš„å†…å®¹å°±æ˜¯ä½ æ­¤æ¬¡è®­ç»ƒçš„ç»“æœã€‚æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘æ¥è®²ä¸€è®²è¿™é‡Œé¢çš„å„ä¸ªæ–‡ä»¶éƒ½æ˜¯ä»€ä¹ˆæ„æ€ã€‚</p>
<h5 data-id="heading-12">3.3.1 ğŸ“ˆ<strong>æ ¸å¿ƒå›¾è¡¨ï¼š<code>results.png</code></strong></h5>
<blockquote>
<p>è¿™å¼ å›¾æ˜¯è¯„ä¼°è®­ç»ƒè¿‡ç¨‹æœ€ç›´è§‚çš„å·¥å…·ï¼Œå®ƒç”±å››ä¸ªå­å›¾è¡¨æ„æˆï¼Œæ¨ªè½´ï¼ˆXè½´ï¼‰å‡ä¸º0åˆ°30çš„è®­ç»ƒè½®æ¬¡ï¼ˆEpochï¼‰ï¼Œæ¸…æ™°åœ°å±•ç¤ºäº†æ¨¡å‹åœ¨æ•´ä¸ªå­¦ä¹ å‘¨æœŸä¸­çš„è¡¨ç°è½¨è¿¹ã€‚</p>
</blockquote>
<ul>
<li><strong><code>train/loss</code>ï¼ˆè®­ç»ƒé›†æŸå¤±ï¼‰</strong>
<strong>è¿™æ¡æ›²çº¿åæ˜ äº†æ¨¡å‹åœ¨â€œç»ƒä¹ é¢˜â€ï¼ˆè®­ç»ƒé›†ï¼‰ä¸ŠçŠ¯é”™çš„å‡å°‘è¿‡ç¨‹ã€‚</strong> ç†æƒ³æƒ…å†µä¸‹ï¼Œå®ƒåº”éšç€è®­ç»ƒè½®æ¬¡çš„å¢åŠ è€Œç¨³æ­¥ä¸‹é™ï¼Œå¹¶æœ€ç»ˆè¶‹äºå¹³ç¨³ã€‚è¿™è¯æ˜æ¨¡å‹æ­£åœ¨ä»ä½ æä¾›çš„æ•°æ®ä¸­æœ‰æ•ˆåœ°å­¦ä¹ çŸ¥è¯†ã€‚å¦‚æœæ›²çº¿å‰§çƒˆæ³¢åŠ¨æˆ–æ— æ³•ä¸‹é™ï¼Œåˆ™è¯´æ˜æ¨¡å‹â€œå­¦ä¸è¿›å»â€ï¼Œå¯èƒ½é‡åˆ°äº†æ•°æ®æˆ–ç»“æ„é—®é¢˜ã€‚</li>
<li><strong><code>val/loss</code>ï¼ˆéªŒè¯é›†æŸå¤±ï¼‰</strong>
<strong>è¿™æ˜¯æ¨¡å‹åœ¨â€œæ¨¡æ‹Ÿè€ƒå·â€ï¼ˆéªŒè¯é›†ï¼‰ä¸Šçš„çŠ¯é”™æƒ…å†µï¼Œæ˜¯æ£€æµ‹â€œè¿‡æ‹Ÿåˆâ€çš„å…³é”®æŒ‡æ ‡ã€‚</strong> æœ€å¥åº·çš„çŠ¶æ€æ˜¯ï¼šéªŒè¯é›†æŸå¤±éšç€è®­ç»ƒé›†æŸå¤±ä¸€åŒä¸‹é™ï¼Œä¸”äºŒè€…åœ¨è®­ç»ƒåæœŸæ•°å€¼è¾ƒä¸ºæ¥è¿‘ã€‚å¦‚æœè®­ç»ƒé›†æŸå¤±æŒç»­ä¸‹é™ï¼Œä½†éªŒè¯é›†æŸå¤±åœ¨ä¸­åæœŸ<strong>åè€Œå¼€å§‹å›å‡</strong>ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„è¿‡æ‹Ÿåˆä¿¡å·â€”â€”æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®â€œæ­»è®°ç¡¬èƒŒâ€ï¼Œä¸§å¤±äº†ä¸¾ä¸€åä¸‰çš„èƒ½åŠ›ã€‚</li>
<li><strong><code>metrics/accuracy_top1</code>ï¼ˆTop-1 å‡†ç¡®ç‡ï¼‰</strong>
<strong>è¿™æ˜¯æˆ‘ä»¬æœ€å…³å¿ƒçš„æŒ‡æ ‡ï¼šæ¨¡å‹åœ¨éªŒè¯é›†ä¸Šçš„â€œè€ƒè¯•åˆ†æ•°â€ã€‚</strong> å®ƒç›´æ¥å‘Šè¯‰ä½ ï¼Œæ¨¡å‹åšå‡ºçš„ç¬¬ä¸€ä¸ªé¢„æµ‹æ˜¯æ­£ç¡®çš„æ¦‚ç‡ã€‚è¿™ä¸ªå€¼è¶Šé«˜è¶Šå¥½ï¼Œæˆ‘ä»¬è®­ç»ƒçš„ç»ˆæç›®æ ‡å°±æ˜¯è®©è¿™æ¡æ›²çº¿ç¨³æ­¥æ”€å‡è‡³é«˜ä½ï¼ˆä¾‹å¦‚95%ä»¥ä¸Šï¼‰å¹¶ä¿æŒç¨³å®šã€‚å›¾ä¸­æ›²çº¿å¹³ç¨³ä¸Šå‡è‡³0.95ä»¥ä¸Šï¼Œè¡¨æ˜æˆ‘ä»¬çš„æ¨¡å‹å·²ç»æˆé•¿ä¸ºä¸€ä½ä¼˜ç§€çš„â€œæ¬¡å…ƒé‰´å®šå¸ˆâ€ã€‚</li>
<li><strong><code>metrics/accuracy_top5</code></strong>
æ­¤æŒ‡æ ‡åœ¨<strong>å¤šåˆ†ç±»ä»»åŠ¡</strong>ï¼ˆç±»åˆ«æ•°â‰¥5ï¼‰ä¸­æ›´æœ‰æ„ä¹‰ï¼Œå®ƒè¡¨ç¤ºæ­£ç¡®ç­”æ¡ˆå‡ºç°åœ¨æ¨¡å‹é¢„æµ‹çš„å‰äº”ä¸ªå¯èƒ½ä¸­çš„æ¦‚ç‡ã€‚ç”±äºæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯â€œç…§ç‰‡/æ’ç”»â€äºŒåˆ†ç±»ï¼ŒTop1å‡†ç¡®ç‡å·²ç»è¶³å¤Ÿè¯´æ˜é—®é¢˜ï¼Œå› æ­¤å¯ä»¥æš‚ä¸æ·±å…¥å…³æ³¨æ­¤æŒ‡æ ‡ã€‚</li>
</ul>
<p>results.csvè¡¨æ ¼ä¸­çš„æ•°æ®å°±æ˜¯ä¸Šè¿°å›¾è¡¨çš„å…·ä½“æ•°æ®ï¼Œé‚£ä¸ªå›¾è¡¨å°±æ˜¯ä»¥è¿™ä¸ªæ•°æ®æ¥ç»˜åˆ¶çš„ã€‚results.csvè¡¨æ ¼ä¸­æœ‰ä¸€ä¸ªtimeåˆ—ï¼Œè¡¨æ˜åˆ°è¾¾æ¯ä¸€ä¸ªepochæ‰€è€—è´¹çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e074061824034e2b86b430c00c5b6a34~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=UHjZBz4OM15oaTlyAcoxbBSbdmU%3D" alt="cn11.jpg" loading="lazy"/></p>
<h5 data-id="heading-13">3.3.2 ğŸ“Š <strong>æ•°æ®æœ¬æºï¼š<code>results.csv</code></strong></h5>
<p>ä¸Šé¢æ‰€è®²çš„ <code>results.png</code> å›¾è¡¨ï¼Œå°±æ˜¯ç”±æ­¤æ–‡ä»¶ä¸­çš„æ•°æ®ç›´æ¥ç»˜åˆ¶è€Œæˆã€‚å¦‚æœä½ éœ€è¦å¯¹æ¨¡å‹çš„è¡¨ç°è¿›è¡Œæ›´åŠ ç²¾ç¡®çš„åˆ†æï¼Œä½ å¯èƒ½ä¼šéœ€è¦è¿™äº›ç²¾ç¡®æ•°æ®ã€‚</p>
<p>å¦å¤–ï¼Œè¿™ä¸ªè¡¨ä¸­æœ‰ç‰¹åˆ«å®ç”¨çš„ä¸€ä¸ªå­—æ®µæ˜¯ <strong><code>time</code> åˆ—</strong>ï¼Œå®ƒè®°å½•äº†<strong>å®Œæˆæ¯ä¸€è½®è®­ç»ƒæ‰€è€—è´¹çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’</strong>ã€‚</p>
<h5 data-id="heading-14">3.3.3âš™ï¸ <strong>è®­ç»ƒè“å›¾ï¼š<code>args.yaml</code> æ–‡ä»¶</strong></h5>
<p>è¿™ä¸ªæ–‡ä»¶å®Œæ•´è®°å½•äº†ä½ æœ¬æ¬¡è®­ç»ƒåœ¨ <code>model.train()</code> ä¸­è®¾ç½®çš„æ‰€æœ‰è¶…å‚æ•°ã€‚ä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸ºè¿™æ¬¡è®­ç»ƒçš„ <strong>â€œé…æ–¹â€æˆ–â€œæŠ€æœ¯å›¾çº¸â€</strong>ã€‚ä¸€èˆ¬æƒ…å†µä¸‹å®ƒæ²¡ä»€ä¹ˆç”¨ï¼Œé™¤éä½ è¦ç²¾ç¡®å¤ç°ã€‚</p>
<h5 data-id="heading-15">3.3.4 ğŸ“‘ <strong>å½’ä¸€åŒ–æ··æ·†çŸ©é˜µ</strong></h5>
<p>åœ¨è¯„ä¼°æ¨¡å‹æ€§èƒ½æ—¶ï¼Œ<code>confusion_matrix_normalized.png</code>ï¼ˆå½’ä¸€åŒ–æ··æ·†çŸ©é˜µï¼‰æ˜¯ä¸€ä»½éå¸¸ç›´è§‚çš„â€œè¯Šæ–­æŠ¥å‘Šâ€ã€‚å®ƒæ¸…æ™°åœ°æ­ç¤ºäº†æ¨¡å‹åœ¨å“ªäº›åœ°æ–¹åšå¯¹äº†ï¼Œåœ¨å“ªäº›åœ°æ–¹å®¹æ˜“æ··æ·†ã€‚ã€å¯ä»¥ä¸ç”¨ç®¡<code>confusion_matrix.png</code>ï¼Œè¿™ä¸¤ä¸ªæœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‘</p>
<p>ä»¥æœ¬æ•™ç¨‹çš„äºŒåˆ†ç±»ä»»åŠ¡ä¸ºä¾‹ï¼Œä½ ä¼šçœ‹åˆ°ä¸€ä¸ª 2x2 çš„ç½‘æ ¼ï¼Œå…¶åŸºæœ¬ç»“æ„å¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75ccb8be26324f9d9bda5c9c7230fed6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=1DtQZKBAxkYe6AkH7CUNfv9BQ2k%3D" alt="v3.png" loading="lazy"/></p>
<ul>
<li><strong>åº•éƒ¨æ¨ªåæ ‡ (True Label)ï¼š</strong> è¡¨ç¤ºå›¾ç‰‡<strong>å®é™…</strong>çš„ç±»åˆ«ï¼ˆ<code>illustration</code> æ’ç”»ï¼Œ<code>real</code> çœŸå®ç…§ç‰‡ï¼‰ã€‚</li>
<li><strong>å·¦ä¾§çºµåæ ‡ (Predicted Label)ï¼š</strong> è¡¨ç¤ºæ¨¡å‹<strong>é¢„æµ‹</strong>çš„ç±»åˆ«ã€‚</li>
</ul>
<p><strong>å¯¹è§’çº¿ä¸Šçš„æ ¼å­ï¼ˆä»å·¦ä¸Šåˆ°å³ä¸‹ï¼‰ä»£è¡¨é¢„æµ‹æ­£ç¡®çš„éƒ¨åˆ†ï¼Œé¢œè‰²è¶Šæ·±ã€æ•°å€¼è¶Šé«˜ï¼Œè¯´æ˜æ¨¡å‹è¡¨ç°è¶Šå¥½ã€‚</strong></p>
<p>æ¥ä¾æ¬¡çœ‹çœ‹æ¯ä¸ªæ ¼å­ä»£è¡¨ä»€ä¹ˆæ„æ€ï¼š</p>
<ol>
<li>
<p>ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ— (0.98)ï¼ŒçœŸå®æ ‡ç­¾æ˜¯æ’ç”»ï¼ˆillustrationï¼‰ï¼Œé¢„æµ‹çš„æ ‡ç­¾ä¹Ÿæ˜¯æ’ç”»ï¼Œæ¯”ç‡æ˜¯0.98ï¼›è¿™å°±è¡¨æ˜åŸæœ¬æ˜¯æ’ç”»æ ‡ç­¾çš„å›¾ç‰‡æœ‰98%è¢«é¢„æµ‹æˆäº†æ’ç”»ã€‚</p>
</li>
<li>
<p>ç¬¬äºŒè¡Œç¬¬ä¸€åˆ— (0.02)ï¼ŒçœŸå®æ ‡ç­¾æ˜¯æ’ç”»ï¼ˆillustrationï¼‰ï¼Œé¢„æµ‹çš„æ ‡ç­¾æ˜¯çœŸå®å›¾åƒï¼ˆrealï¼‰ï¼Œæ¯”ç‡æ˜¯0.02ï¼›è¿™å°±è¡¨æ˜åŸæœ¬æ˜¯æ’ç”»æ ‡ç­¾çš„å›¾ç‰‡æœ‰2%è¢«é¢„æµ‹æˆäº†çœŸå®ç…§ç‰‡ã€‚</p>
</li>
<li>
<p>å…¶ä½™åŒç†</p>
</li>
</ol>
<h5 data-id="heading-16">3.3.5 ğŸ‚ æ¨¡å‹æƒé‡weight</h5>
<p>åœ¨ <code>weights</code> æ–‡ä»¶å¤¹ä¸­ï¼Œä¿å­˜ç€æœ¬æ¬¡è®­ç»ƒæœ€é‡è¦çš„æˆæœâ€”â€”æ¨¡å‹æœ¬èº«ï¼Œå…¶ä¸­<code>best.pt</code>æ˜¯æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­<strong>æ€§èƒ½æœ€ä¼˜çš„æ•ˆæœæœ€å¥½çš„æ¨¡å‹æƒé‡</strong>ï¼Œå®ƒåœ¨æµ‹è¯•é›†ä¸Šç»¼åˆè¡¨ç°æœ€ä½³ï¼Œæ˜¯åç»­ä½¿ç”¨çš„é¦–é€‰ã€‚</p>
<p><code>last.pt</code>æ˜¯è®­ç»ƒ<strong>æœ€åä¸€è½®ï¼ˆåœ¨æœ¬æ•™ç¨‹ä¸­å°±æ˜¯ç¬¬30è½®ï¼‰çš„æ¨¡å‹å¿«ç…§</strong>ï¼Œå®ƒä»£è¡¨äº†æ¨¡å‹æœ€ç»ˆè¾¾åˆ°çš„çŠ¶æ€ã€‚å¦‚æœè®­ç»ƒå› æ•…ä¸­æ–­ï¼Œæ‚¨ä¹Ÿå¯ä»¥åŠ è½½ <code>last.pt</code> ä»æ–­ç‚¹å¤„ç»§ç»­è®­ç»ƒï¼Œæ— éœ€ä»å¤´å¼€å§‹ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä»æ–­ç‚¹å¤„ç»§ç»­è®­ç»ƒ</span>
<span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    model = YOLO(<span class="hljs-string">"xxxx/last.pt"</span>)  <span class="hljs-comment"># åŠ è½½ä½ çš„last.ptæ¨¡å‹</span>
    results = model.train(resume=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># æ¢å¤è®­ç»ƒ</span>
</code></pre>
<h5 data-id="heading-17">3.3.6 ğŸ“·å…¶å®ƒå›¾ç‰‡</h5>
<p>è¿™é‡Œå‰©ä½™çš„å›¾ç‰‡å°±æ˜¯æ¨¡å‹è®­ç»ƒå¥½åè¿›è¡Œé¢„æµ‹çš„å¯è§†åŒ–å›¾ç‰‡ï¼Œå¯ä»¥å®å®åˆ‡åˆ‡çœ‹åˆ°æ¨¡å‹çš„æ•ˆæœï¼Œå¯ä»¥ç”¨æ¥PPTæ±‡æŠ¥æˆ–æ–‡ç« æ’å›¾å±•ç¤ºã€‚</p>
<h4 data-id="heading-18">3.4 æ¨¡å‹æ¨ç†</h4>
<p>ç°åœ¨æ¨¡å‹å·²ç»è®­ç»ƒå®Œæˆï¼Œæˆ‘ä»¬ä¹Ÿä»”ç»†åˆ†æäº†ç»“æœæ–‡ä»¶å¤¹ä¸­çš„å„ç±»å›¾è¡¨ï¼Œå¯¹æ¨¡å‹çš„æ€§èƒ½æœ‰äº†å…¨é¢çš„äº†è§£ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•å°†è®­ç»ƒå¥½çš„æ¨¡å‹å®é™…åº”ç”¨åˆ°æˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®ä¸­å‘¢ï¼Ÿ</p>
<p>å…¶å®ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•ï¼åªéœ€è¦å‡ è¡Œä»£ç ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO

<span class="hljs-comment"># åŠ è½½è®­ç»ƒå¥½çš„æœ€ä½³æ¨¡å‹</span>
model = YOLO(<span class="hljs-string">"xxx/your_training_output_path/best.pt"</span>)  <span class="hljs-comment"># è¯·å°†æ­¤è·¯å¾„æ›¿æ¢ä¸ºä½ å®é™…çš„æ¨¡å‹ä¿å­˜è·¯å¾„</span>

<span class="hljs-comment"># è®¾ç½®å¾…åˆ†ç±»çš„å›¾ç‰‡è·¯å¾„</span>
source = [<span class="hljs-string">"./predict_pic/p4.jpg"</span>]  <span class="hljs-comment"># å•å¼ å›¾ç‰‡é¢„æµ‹,è¿™å¼ å›¾ç‰‡æ˜¯ä¸€å¼ çœŸå®çš„å…¬è·¯ç…§ç‰‡</span>
<span class="hljs-comment"># source = ["./predict_pic/p4.jpg", "./predict_pic/p7.jpg"]  # å¤šå¼ å›¾ç‰‡æ‰¹é‡é¢„æµ‹</span>

<span class="hljs-comment"># è¿›è¡Œé¢„æµ‹ï¼Œè®¾ç½®å›¾ç‰‡å°ºå¯¸ä¸è®­ç»ƒæ—¶ä¿æŒä¸€è‡´</span>
result = model.predict(source, imgsz=<span class="hljs-number">640</span>)
</code></pre>
<p>ä½ è¾“å…¥çš„å¾…åˆ†ç±»å›¾ç‰‡ä¸éœ€è¦é¢„å…ˆè°ƒæ•´ä¸ºè®­ç»ƒæ—¶çš„å¤§å°ï¼ŒYOLOä¼šè‡ªåŠ¨å°†å…¶è§„èŒƒåŒ–ä¸º640Ã—640ï¼ˆå¦‚æœä½ è®­ç»ƒæ—¶ä½¿ç”¨çš„æ˜¯å…¶ä»–å°ºå¯¸ï¼Œè®°å¾—ç›¸åº”è°ƒæ•´imgszå‚æ•°ï¼‰ï¼›æ­¤å¤–ï¼ŒYOLOä¸ä»…æ”¯æŒå•å¼ å›¾ç‰‡é¢„æµ‹ï¼Œä¹Ÿæ”¯æŒå¤šå¼ å›¾ç‰‡æ‰¹é‡é¢„æµ‹ï¼Œåªéœ€åœ¨sourceåˆ—è¡¨ä¸­æ·»åŠ æ›´å¤šå›¾ç‰‡è·¯å¾„å³å¯</p>
<p>å¦‚ä½•è§£è¯»é¢„æµ‹ç»“æœã€‚resultå˜é‡æ¥æ”¶åˆ°çš„é¢„æµ‹ä¿¡æ¯æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ€§è¾“å…¥å¤šå¼ å›¾ç‰‡ã€‚æˆ‘ä»¬ä»¥ç¬¬ä¸€å¼ å›¾ç‰‡ï¼ˆç´¢å¼•ä¸º0ï¼‰ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># è¾“å‡ºæ¯ä¸ªç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡</span>
<span class="hljs-built_in">print</span>(result[<span class="hljs-number">0</span>].cpu().probs.data)
<span class="hljs-comment"># è¾“å‡ºæ¨¡å‹é¢„æµ‹çš„ç±»åˆ«åºå·</span>
<span class="hljs-built_in">print</span>(result[<span class="hljs-number">0</span>].probs.top1)
<span class="hljs-comment"># è¾“å‡ºç±»åˆ«åºå·ä¸ç±»åˆ«åç§°çš„å¯¹åº”å…³ç³»</span>
<span class="hljs-built_in">print</span>(result[<span class="hljs-number">0</span>].names)

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹==========================</span>
<span class="hljs-comment"># tensor([0.0265, 0.9735])</span>
<span class="hljs-comment"># 1</span>
<span class="hljs-comment"># {0: 'illustration', 1: 'real'}</span>
</code></pre>
<p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œæ¨¡å‹é¢„æµ‹<code>p4.jpg</code>æœ‰97.35%çš„æ¦‚ç‡æ˜¯çœŸå®ç…§ç‰‡ï¼ˆrealï¼‰ï¼Œåªæœ‰2.65%çš„æ¦‚ç‡æ˜¯æ’ç”»ï¼ˆillustrationï¼‰ã€‚æ¨¡å‹æœ€ç»ˆå°†å…¶åˆ†ç±»ä¸ºç±»åˆ«1ï¼Œä¹Ÿå°±æ˜¯â€˜realâ€™ç±»åˆ«ã€‚</p>
<p>å…¶å®ï¼Œä¸æ­¢è¿™ç§å½¢å¼ï¼ˆ<code>source = ["./predict_pic/p4.jpg"]</code>ï¼‰çš„sourceï¼ŒYOLOè¿˜æ”¯æŒéå¸¸å¤šçš„å›¾åƒæ¥æºï¼Œå¦‚ä¸‹è¡¨æ ¼ä¸­æ‰€å±•ç¤ºçš„å›¾åƒæ•°æ®ç±»å‹YOLOå‡å¯ä»¥æ‰¹å¤„ç†ï¼Œå¹¶å°†ç»“æœè¿”å›åˆ°resultä¸­</p>
<p><strong>æ”¯æŒçš„source</strong></p>































































































<table><thead><tr><th align="left">æ¥æº</th><th align="left">ç¤ºä¾‹</th><th align="left">ç±»å‹</th><th align="left">å¤‡æ³¨</th></tr></thead><tbody><tr><td align="left">å›¾åƒ</td><td align="left"><code>'image.jpg'</code></td><td align="left"><code>str</code> æˆ– <code>Path</code></td><td align="left">å•ä¸ªå›¾åƒæ–‡ä»¶ã€‚</td></tr><tr><td align="left">URL</td><td align="left"><code>'https://ultralytics.com/images/bus.jpg'</code></td><td align="left"><code>str</code></td><td align="left">å›¾åƒçš„URLã€‚</td></tr><tr><td align="left">æˆªå›¾</td><td align="left"><code>'screen'</code></td><td align="left"><code>str</code></td><td align="left">æˆªå–å±å¹•æˆªå›¾ã€‚</td></tr><tr><td align="left">PIL</td><td align="left"><code>Image.open('image.jpg')</code></td><td align="left"><code>PIL.Image</code></td><td align="left">å…·æœ‰RGBé€šé“çš„HWCæ ¼å¼ã€‚</td></tr><tr><td align="left">OpenCV</td><td align="left"><code>cv2.imread('image.jpg')</code></td><td align="left"><code>np.ndarray</code></td><td align="left">å…·æœ‰BGRé€šé“çš„HWCæ ¼å¼ <code>uint8 (0-255)</code>.</td></tr><tr><td align="left">numpy</td><td align="left"><code>np.zeros((640,1280,3))</code></td><td align="left"><code>np.ndarray</code></td><td align="left">å…·æœ‰BGRé€šé“çš„HWCæ ¼å¼ <code>uint8 (0-255)</code>.</td></tr><tr><td align="left">torch</td><td align="left"><code>torch.zeros(16,3,320,640)</code></td><td align="left"><code>torch.Tensor</code></td><td align="left">å…·æœ‰RGBé€šé“çš„BCHWæ ¼å¼ <code>float32 (0.0-1.0)</code>.</td></tr><tr><td align="left">CSV</td><td align="left"><code>'sources.csv'</code></td><td align="left"><code>str</code> æˆ– <code>Path</code></td><td align="left">åŒ…å«å›¾åƒã€è§†é¢‘æˆ–ç›®å½•è·¯å¾„çš„CSVæ–‡ä»¶ã€‚</td></tr><tr><td align="left">è§†é¢‘ âœ…</td><td align="left"><code>'video.mp4'</code></td><td align="left"><code>str</code> æˆ– <code>Path</code></td><td align="left">MP4ã€AVIç­‰æ ¼å¼çš„è§†é¢‘æ–‡ä»¶ã€‚</td></tr><tr><td align="left">ç›®å½• âœ…</td><td align="left"><code>'path/'</code></td><td align="left"><code>str</code> æˆ– <code>Path</code></td><td align="left">åŒ…å«å›¾åƒæˆ–è§†é¢‘çš„ç›®å½•çš„è·¯å¾„ã€‚</td></tr><tr><td align="left">glob âœ…</td><td align="left"><code>'path/*.jpg'</code></td><td align="left"><code>str</code></td><td align="left">ç”¨äºåŒ¹é…å¤šä¸ªæ–‡ä»¶çš„Globæ¨¡å¼ã€‚ä½¿ç”¨ <code>*</code> å­—ç¬¦ä½œä¸ºé€šé…ç¬¦ã€‚</td></tr><tr><td align="left">æµ âœ…</td><td align="left"><code>'rtsp://example.com/media.mp4'</code></td><td align="left"><code>str</code></td><td align="left">ç”¨äºæµåª’ä½“åè®®çš„URLï¼Œä¾‹å¦‚RTSPã€RTMPã€TCPæˆ–IPåœ°å€ã€‚</td></tr><tr><td align="left">å¤šæµ âœ…</td><td align="left"><code>'list.streams'</code></td><td align="left"><code>str</code> æˆ– <code>Path</code></td><td align="left"><code>*.streams</code> åŒ…å«æ¯è¡Œä¸€ä¸ªæµ URL çš„æ–‡æœ¬æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼Œ8 ä¸ªæµå°†ä»¥ batch-size 8 è¿è¡Œã€‚</td></tr><tr><td align="left">ç½‘ç»œæ‘„åƒå¤´ âœ…</td><td align="left"><code>0</code></td><td align="left"><code>int</code></td><td align="left">ç”¨äºè¿è¡Œæ¨ç†çš„å·²è¿æ¥æ‘„åƒå¤´è®¾å¤‡çš„ç´¢å¼•ã€‚</td></tr></tbody></table>
<p>å¦å¤–ï¼Œ<code>model.predict()</code>å‡½æ•°å¯ä»¥é…ç½®å¾ˆå¤šè¿›é˜¶å‚æ•°ï¼Œè¿™é‡ŒæŠŠå¸¸ç”¨çš„å‚æ•°åˆ—å‡ºæ¥ï¼Œä¾›å¤§å®¶å‚è€ƒ</p>
<p><strong>predictçš„å¯é€‰å‚æ•°</strong></p>





































































































<table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">é»˜è®¤å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>source</code></td><td align="left"><code>str</code></td><td align="left"><code>'ultralytics/assets'</code></td><td align="left">æŒ‡å®šæ¨ç†çš„æ•°æ®æºã€‚å¯ä»¥æ˜¯å›¾åƒè·¯å¾„ã€è§†é¢‘æ–‡ä»¶ã€ç›®å½•ã€URL æˆ–å®æ—¶é¦ˆé€çš„è®¾å¤‡ IDã€‚ æ”¯æŒå¤šç§æ ¼å¼å’Œæ¥æº</td></tr><tr><td align="left"><code>conf</code></td><td align="left"><code>float</code></td><td align="left"><code>0.25</code></td><td align="left">è®¾ç½®æ£€æµ‹çš„æœ€å°ç½®ä¿¡åº¦é˜ˆå€¼ã€‚ å°†å¿½ç•¥ç½®ä¿¡åº¦ä½äºæ­¤é˜ˆå€¼çš„æ£€æµ‹åˆ°çš„å¯¹è±¡ã€‚ è°ƒæ•´æ­¤å€¼æœ‰åŠ©äºå‡å°‘è¯¯æŠ¥ã€‚</td></tr><tr><td align="left"><code>iou</code></td><td align="left"><code>float</code></td><td align="left"><code>0.7</code></td><td align="left">ç”¨äºéæå¤§å€¼æŠ‘åˆ¶ NMSçš„IoUé˜ˆå€¼ã€‚è¾ƒä½çš„å€¼ä¼šé€šè¿‡æ¶ˆé™¤é‡å çš„æ¡†æ¥å‡å°‘æ£€æµ‹ç»“æœï¼Œè¿™å¯¹äºå‡å°‘é‡å¤é¡¹å¾ˆæœ‰ç”¨ã€‚</td></tr><tr><td align="left"><code>imgsz</code></td><td align="left"><code>int</code> æˆ– <code>tuple</code></td><td align="left"><code>640</code></td><td align="left">å®šä¹‰æ¨ç†çš„å›¾åƒå¤§å°ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•° <code>640</code> è¡¨ç¤ºæ­£æ–¹å½¢è°ƒæ•´å¤§å°ï¼Œä¹Ÿå¯ä»¥æ˜¯ (height, width) å…ƒç»„ã€‚é€‚å½“çš„å¤§å°è°ƒæ•´å¯ä»¥æé«˜æ£€æµ‹å‡†ç¡®æ€§å’Œå¤„ç†é€Ÿåº¦ã€‚</td></tr><tr><td align="left"><code>rect</code></td><td align="left"><code>bool</code></td><td align="left"><code>True</code></td><td align="left">å¦‚æœå¯ç”¨ï¼Œåˆ™å¯¹å›¾åƒè¾ƒçŸ­çš„ä¸€è¾¹è¿›è¡Œæœ€å°å¡«å……ï¼Œç›´åˆ°å¯ä»¥è¢«æ­¥é•¿æ•´é™¤ï¼Œä»¥æé«˜æ¨ç†é€Ÿåº¦ã€‚å¦‚æœç¦ç”¨ï¼Œåˆ™åœ¨æ¨ç†æœŸé—´å°†å›¾åƒå¡«å……ä¸ºæ­£æ–¹å½¢ã€‚</td></tr><tr><td align="left"><code>half</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">å¯ç”¨åŠç²¾åº¦ (FP16) æ¨ç†ï¼Œè¿™å¯ä»¥åŠ å¿«åœ¨æ”¯æŒçš„ GPU ä¸Šçš„æ¨¡å‹æ¨ç†é€Ÿåº¦ï¼ŒåŒæ—¶å¯¹å‡†ç¡®æ€§çš„å½±å“æå°ã€‚</td></tr><tr><td align="left"><code>device</code></td><td align="left"><code>str</code></td><td align="left"><code>None</code></td><td align="left">æŒ‡å®šç”¨äºæ¨ç†çš„è®¾å¤‡ï¼ˆä¾‹å¦‚ï¼Œ <code>cpu</code>, <code>cuda:0</code> æˆ– <code>0</code>ï¼‰ã€‚å…è®¸ç”¨æˆ·åœ¨ CPUã€ç‰¹å®š GPU æˆ–å…¶ä»–è®¡ç®—è®¾å¤‡ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œä»¥æ‰§è¡Œæ¨¡å‹ã€‚</td></tr><tr><td align="left"><code>batch</code></td><td align="left"><code>int</code></td><td align="left"><code>1</code></td><td align="left">æŒ‡å®šæ¨ç†çš„æ‰¹å¤„ç†å¤§å°ï¼ˆä»…åœ¨æºä¸ºä»¥ä¸‹æƒ…å†µæ—¶æœ‰æ•ˆï¼š ç›®å½•ã€è§†é¢‘æ–‡ä»¶æˆ– <code>.txt</code> æ–‡ä»¶)ã€‚æ›´å¤§çš„æ‰¹å¤„ç†å¤§å°å¯ä»¥æä¾›æ›´é«˜çš„ååé‡ï¼Œä»è€Œç¼©çŸ­æ¨ç†æ‰€éœ€çš„æ€»æ—¶é—´ã€‚</td></tr><tr><td align="left"><code>max_det</code></td><td align="left"><code>int</code></td><td align="left"><code>300</code></td><td align="left">æ¯å¼ å›¾åƒå…è®¸çš„æœ€å¤§æ£€æµ‹æ•°é‡ã€‚é™åˆ¶æ¨¡å‹åœ¨å•æ¬¡æ¨ç†ä¸­å¯ä»¥æ£€æµ‹åˆ°çš„å¯¹è±¡æ€»æ•°ï¼Œé˜²æ­¢åœ¨å¯†é›†åœºæ™¯ä¸­äº§ç”Ÿè¿‡å¤šçš„è¾“å‡ºã€‚</td></tr><tr><td align="left"><code>vid_stride</code></td><td align="left"><code>int</code></td><td align="left"><code>1</code></td><td align="left">è§†é¢‘è¾“å…¥çš„å¸§æ­¥é•¿ã€‚å…è®¸è·³è¿‡è§†é¢‘ä¸­çš„å¸§ï¼Œä»¥åŠ å¿«å¤„ç†é€Ÿåº¦ï¼Œä½†ä¼šé™ä½æ—¶é—´åˆ†è¾¨ç‡ã€‚å€¼ä¸º 1 æ—¶å¤„ç†æ¯ä¸€å¸§ï¼Œå€¼è¶Šé«˜è·³è¿‡çš„å¸§è¶Šå¤šã€‚</td></tr><tr><td align="left"><code>agnostic_nms</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">å¯ç”¨ä¸ç±»åˆ«æ— å…³çš„éæå¤§å€¼æŠ‘åˆ¶ (NMS)ï¼Œå®ƒä¼šåˆå¹¶ä¸åŒç±»åˆ«çš„é‡å æ¡†ã€‚åœ¨ç±»åˆ«é‡å å¾ˆå¸¸è§çš„å¤šç±»åˆ«æ£€æµ‹åœºæ™¯ä¸­éå¸¸æœ‰ç”¨ã€‚</td></tr><tr><td align="left"><code>retina_masks</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">è¿”å›é«˜åˆ†è¾¨ç‡åˆ†å‰²æ©ç ã€‚è¿”å›çš„æ©ç ï¼ˆ<code>masks.data</code>ï¼‰å¦‚æœå¯ç”¨ï¼Œå°†ä¸åŸå§‹å›¾åƒå¤§å°åŒ¹é…ã€‚å¦‚æœç¦ç”¨ï¼Œå®ƒä»¬å°†å…·æœ‰æ¨ç†æœŸé—´ä½¿ç”¨çš„å›¾åƒå¤§å°ã€‚</td></tr><tr><td align="left"><code>project</code></td><td align="left"><code>str</code></td><td align="left"><code>None</code></td><td align="left">å¦‚æœ <code>save</code> å·²å¯ç”¨ï¼Œåˆ™ä¸ºä¿å­˜é¢„æµ‹è¾“å‡ºçš„é¡¹ç›®ç›®å½•çš„åç§°ã€‚</td></tr><tr><td align="left"><code>name</code></td><td align="left"><code>str</code></td><td align="left"><code>None</code></td><td align="left">é¢„æµ‹è¿è¡Œçš„åç§°ã€‚ç”¨äºåœ¨é¡¹ç›®æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªå­ç›®å½•ï¼Œå¦‚æœ <code>save</code> å·²å¯ç”¨ï¼Œåˆ™ä¸ºä¿å­˜é¢„æµ‹è¾“å‡ºçš„é¡¹ç›®ç›®å½•çš„åç§°ã€‚</td></tr><tr><td align="left"><code>verbose</code></td><td align="left"><code>bool</code></td><td align="left"><code>True</code></td><td align="left">æ§åˆ¶æ˜¯å¦åœ¨ç»ˆç«¯ä¸­æ˜¾ç¤ºè¯¦ç»†çš„æ¨ç†æ—¥å¿—ï¼Œä»è€Œæä¾›æœ‰å…³é¢„æµ‹è¿‡ç¨‹çš„å®æ—¶åé¦ˆã€‚</td></tr></tbody></table>







































































<table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">é»˜è®¤å€¼</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>show</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">å¯è§†åŒ–å‚æ•°ï¼š <code>True</code>ï¼Œåˆ™åœ¨çª—å£ä¸­æ˜¾ç¤ºå¸¦æ³¨é‡Šçš„å›¾åƒæˆ–è§†é¢‘ã€‚è¿™å¯¹äºå¼€å‘æˆ–æµ‹è¯•æœŸé—´çš„å³æ—¶è§†è§‰åé¦ˆéå¸¸æœ‰ç”¨ã€‚</td></tr><tr><td align="left"><code>save</code></td><td align="left"><code>bool</code></td><td align="left"><code>False or True</code></td><td align="left">å¯ç”¨å°†å¸¦æ³¨é‡Šçš„å›¾åƒæˆ–è§†é¢‘ä¿å­˜åˆ°æ–‡ä»¶ã€‚è¿™å¯¹äºæ–‡æ¡£ç¼–åˆ¶ã€è¿›ä¸€æ­¥åˆ†ææˆ–å…±äº«ç»“æœéå¸¸æœ‰ç”¨ã€‚ä½¿ç”¨ CLI æ—¶é»˜è®¤ä¸º Trueï¼Œåœ¨ python ä¸­ä½¿ç”¨æ—¶é»˜è®¤ä¸º Falseã€‚</td></tr><tr><td align="left"><code>save_frames</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">å¤„ç†è§†é¢‘æ—¶ï¼Œå°†å„ä¸ªå¸§å¦å­˜ä¸ºå›¾åƒã€‚è¿™å¯¹äºæå–ç‰¹å®šå¸§æˆ–è¿›è¡Œè¯¦ç»†çš„é€å¸§åˆ†æéå¸¸æœ‰ç”¨ã€‚</td></tr><tr><td align="left"><code>save_txt</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">ä»¥æ–‡æœ¬æ–‡ä»¶æ ¼å¼ä¿å­˜æ£€æµ‹ç»“æœï¼Œæ ¼å¼å¦‚ä¸‹ï¼š <code>[class] [x_center] [y_center] [width] [height] [confidence]</code>ã€‚ æœ‰åŠ©äºä¸å…¶ä»–åˆ†æå·¥å…·é›†æˆã€‚</td></tr><tr><td align="left"><code>save_conf</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">åœ¨ä¿å­˜çš„æ–‡æœ¬æ–‡ä»¶ä¸­åŒ…å«ç½®ä¿¡åº¦åˆ†æ•°ã€‚ å¢å¼ºäº†å¯ç”¨äºåå¤„ç†å’Œåˆ†æçš„ç»†èŠ‚ã€‚</td></tr><tr><td align="left"><code>save_crop</code></td><td align="left"><code>bool</code></td><td align="left"><code>False</code></td><td align="left">ä¿å­˜æ£€æµ‹åˆ°çš„è£å‰ªå›¾åƒã€‚ æœ‰åŠ©äºæ•°æ®é›†å¢å¼ºã€åˆ†ææˆ–ä¸ºç‰¹å®šå¯¹è±¡åˆ›å»ºé‡ç‚¹æ•°æ®é›†ã€‚</td></tr><tr><td align="left"><code>show_labels</code></td><td align="left"><code>bool</code></td><td align="left"><code>True</code></td><td align="left">åœ¨å¯è§†åŒ–è¾“å‡ºä¸­æ˜¾ç¤ºæ¯ä¸ªæ£€æµ‹çš„æ ‡ç­¾ã€‚ èƒ½å¤Ÿç«‹å³ç†è§£æ£€æµ‹åˆ°çš„å¯¹è±¡ã€‚</td></tr><tr><td align="left"><code>show_conf</code></td><td align="left"><code>bool</code></td><td align="left"><code>True</code></td><td align="left">åœ¨æ ‡ç­¾æ—è¾¹æ˜¾ç¤ºæ¯ä¸ªæ£€æµ‹çš„ç½®ä¿¡åº¦åˆ†æ•°ã€‚ å¯ä»¥æ·±å…¥äº†è§£æ¨¡å‹å¯¹æ¯æ¬¡æ£€æµ‹çš„ç¡®å®šæ€§ã€‚</td></tr><tr><td align="left"><code>show_boxes</code></td><td align="left"><code>bool</code></td><td align="left"><code>True</code></td><td align="left">åœ¨æ£€æµ‹åˆ°çš„å¯¹è±¡å‘¨å›´ç»˜åˆ¶è¾¹ç•Œæ¡†ã€‚ è¿™å¯¹äºåœ¨å›¾åƒæˆ–è§†é¢‘å¸§ä¸­ä»¥å¯è§†æ–¹å¼è¯†åˆ«å’Œå®šä½å¯¹è±¡è‡³å…³é‡è¦ã€‚</td></tr><tr><td align="left"><code>line_width</code></td><td align="left"><code>None or int</code></td><td align="left"><code>None</code></td><td align="left">æŒ‡å®šè¾¹ç•Œæ¡†çš„çº¿æ¡å®½åº¦ã€‚ å¦‚æœ <code>None</code>ï¼Œåˆ™çº¿æ¡å®½åº¦ä¼šæ ¹æ®å›¾åƒå¤§å°è‡ªåŠ¨è°ƒæ•´ã€‚ æä¾›è§†è§‰è‡ªå®šä¹‰ä»¥æé«˜æ¸…æ™°åº¦ã€‚</td></tr></tbody></table>
<p>ä½ å¯ä»¥çœ‹åˆ°ï¼ŒYOLO æä¾›äº†éå¸¸ä¸°å¯Œçš„é…ç½®é€‰é¡¹ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é«˜åº¦è‡ªå®šä¹‰å¾ˆå¤šæµç¨‹ã€‚ä½†è¿™ä¹Ÿå¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼šè¿™ä¹ˆå¤šå‚æ•°ï¼Œå¦‚æœä¸€æ—¶ä¸ç†è§£æŸä¸ªé€‰é¡¹çš„å…·ä½“ä½œç”¨ï¼Œæˆ–è€…ä¸ç¡®å®šè°ƒæ•´åä¼šå¸¦æ¥ä»€ä¹ˆæ•ˆæœï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ</p>
<p>è¿™æ—¶å€™ï¼Œä½ å®Œå…¨å¯ä»¥å‘ä½ ç†Ÿæ‚‰çš„AIå¤§æ¨¡å‹æé—®ï¼Œåœ¨æŒæ¡äº† YOLO çš„åŸºæœ¬æ¡†æ¶ï¼Œæ€æƒ³å’Œä½¿ç”¨æ–¹æ³•ä¹‹åï¼Œè¿™äº›ç»†èŠ‚é—®é¢˜å®Œå…¨å¯ä»¥äº¤ç”± AI å¸®ä½ å¿«é€Ÿè§£å†³ã€‚</p>
<p>ä½†å¦‚æœä½ å®Œå…¨ä¸äº†è§£ YOLOï¼Œå°±æƒ³è®© AI ä»å¤´å¸®ä½ å®Œæˆä¸€ä¸ªYOLOè§†è§‰é¡¹ç›®ï¼Œé‚£å‡ ä¹æ˜¯å¾ˆå›°éš¾çš„ï¼Œå› ä¸ºè¿™æ—¶å€™ä½ èƒ½åšçš„ï¼Œå°±æ˜¯å®Œå…¨ä¾é AIï¼Œä½ å¯¹YOLOçš„å®è§‚å¾®è§‚ç†è§£ï¼Œéƒ½éœ€è¦AIç»™ä½ ä»å¤´æ­å»ºï¼Œä½ èƒ½åšåˆ°ï¼Œåªæ˜¯åœ¨AIæä¾›çš„ç­”æ¡ˆä¸­åšå‡ºé€‰æ‹©ï¼›æ²¡æœ‰æ‰å®çš„æŠ€æœ¯åŸºç¡€ï¼Œä»…å‡­ AI ç”Ÿæˆçš„é¡¹ç›®æ— å¼‚äºç©ºä¸­æ¥¼é˜ï¼Œéš¾ä»¥ç¨³å›ºã€æ›´éš¾ä»¥è¿­ä»£ã€‚ä½†å½“ä½ å¯¹ä¸€ä¸ªé¡¹ç›®çš„æ•´ä½“æµç¨‹æœ‰äº†æ¸…æ™°æ¦‚å¿µå’Œæƒ³æ³•ï¼ŒAI å°±èƒ½æˆä¸ºä½ å¾—åŠ›çš„åŠ©æ‰‹ï¼Œæ˜¯ä½ åœ¨ä¸»å¯¼AIï¼Œè€Œä¸æ˜¯AIåœ¨é¢†å¯¼ä½ ã€‚è¿™æ­£æ˜¯â€œæ‡‚æŠ€æœ¯â€å’Œâ€œä¸æ‡‚æŠ€æœ¯â€çš„äººåœ¨ä½¿ç”¨ AI æ—¶çš„å…³é”®å·®å¼‚ï¼Œä½ çš„æŠ€æœ¯åŸºç¡€ï¼Œå†³å®šç€ä½ çš„AIç”Ÿæˆèƒ½åŠ›çš„ä¸Šç•Œã€‚å·¥å…·è¶Šæ˜¯å¼ºå¤§ï¼Œäººçš„æ€ç»´å’Œè§†é‡å°±è¶Šæ˜¾çè´µã€‚</p>
<h4 data-id="heading-19">3.5 å›¾åƒå¢å¼º</h4>
<p>ä½ åº”è¯¥æ³¨æ„åˆ°äº†ï¼Œåœ¨<strong>æ¨¡å‹è®­ç»ƒ</strong>çš„é‚£ä¸ªç« èŠ‚ï¼Œæˆ‘æœ‰ä¸‰ä¸ªå‚æ•°æ²¡æœ‰è®²åˆ°ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python">degrees=<span class="hljs-number">60</span>,                             
flipud=<span class="hljs-number">0.3</span>,                             
fliplr=<span class="hljs-number">0.3</span>,     
</code></pre>
<p>è¦æƒ³ç†è§£è¿™ä¸‰ä¸ªå‚æ•°ï¼Œå°±éœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯<strong>å›¾åƒå¢å¼º</strong>ã€‚</p>
<p>å›åˆ°æˆ‘ä»¬ä¹‹å‰åšçš„â€œçœŸå®å›¾ç‰‡ vs æ’ç”»â€çš„äºŒåˆ†ç±»ä»»åŠ¡ã€‚å‡è®¾ä½ æ‰¾ä¸åˆ°é‚£ä¹ˆå¤šæ’ç”»æˆ–è€…çœŸå®ç³»åˆ—çš„å›¾ç‰‡æ€ä¹ˆåŠï¼Œå¦‚æœæ‹¿æ¥è®­ç»ƒçš„æ•°æ®é›†å¤ªå°‘ï¼ŒAIè®­ç»ƒçš„æ•ˆæœä¼šå¤§æ‰“æŠ˜æ‰£ã€‚åœ¨AIæ¨¡å‹è®­ç»ƒä¸­ï¼Œæœ‰ä¸€ä¸ªéå¸¸ç›´è§‚çš„è§„å¾‹ï¼š<strong>è®­ç»ƒæ•°æ®è¶Šä¸°å¯Œã€è¶Šå¤šæ ·ï¼Œæ¨¡å‹çš„è¯†åˆ«ç²¾åº¦å’Œæ³›åŒ–èƒ½åŠ›å°±è¶Šå¥½</strong>ã€‚</p>
<p>ä»¥ä¸‹é¢è¿™ä¸ªåŠ¨æ¼«å›¾ç‰‡ä¸ºä¾‹ï¼Œçœ‹ä¼¼æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥<strong>äººä¸ºå¢åŠ è®­ç»ƒæ•°æ®é›†</strong>ï¼Œå°†åŸå§‹çš„ä¸€å¼ è¾“å…¥å›¾ç‰‡è¿›è¡Œæ—‹è½¬ï¼Œæ‹‰ä¼¸ï¼Œé•œåƒï¼Œæ‰­æ›²ï¼Œå¯¹æ¯”åº¦å¢å¼ºç­‰æ“ä½œï¼Œå¹¶ä¿æŒè¾“å‡ºå½¢çŠ¶ä¸å˜ï¼Œè¿™æ ·å°±ç”±ä¸€ä¸ªå›¾ç‰‡ï¼ˆè®­ç»ƒé›†ï¼‰å˜æˆäº†å¤šä¸ªå›¾ç‰‡ï¼ˆè®­ç»ƒé›†ï¼‰ï¼›<strong>å›¾åƒå¢å¼ºçš„æœ¬è´¨ï¼Œæ˜¯é€šè¿‡å¯¹åŸå§‹è®­ç»ƒå›¾åƒè¿›è¡Œä¸€ç³»åˆ—éšæœºä½†åˆç†çš„å˜æ¢ï¼Œäººä¸ºåœ°â€œåˆ›é€ â€å‡ºæ›´å¤šæ ·çš„è®­ç»ƒæ ·æœ¬</strong>ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/13e3d7859b5845fba0673fd7103afc81~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=ypuoztLYi4LIyoN6fVBc3WWzsLM%3D" alt="c12.jpg" loading="lazy"/></p>
<p>ä¸Šé¢çš„è¿™å¼ å›¾ç‰‡å°±å¯ä»¥è½¬åŒ–ä¸ºå¦‚ä¸‹12å¼ "æ–°å›¾ç‰‡"ï¼Œå¦‚æœå¯¹ä½ æ•°æ®é›†ä¸­çš„æ¯ä¸€ä¸ªå›¾ç‰‡éƒ½è¿™ä¹ˆæ“ä½œï¼Œé‚£ä¹ˆä½ çš„æ•°æ®é›†ä¸€ä¸‹å­å°±æ‰©å……äº†12å€ï¼</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ecfffe2a9db482e99dca002024c2737~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=otnknN8y3fL42AlANNxTirePoxs%3D" alt="cn13.jpg" loading="lazy"/></p>
<p>å›¾ç‰‡å¢å¼ºçš„æ ¸å¿ƒæ€æƒ³åœ¨äºï¼Œæˆ‘ä»¬å¸Œæœ›æ¨¡å‹å­¦åˆ°çš„ä¸æ˜¯ç®€å•åœ°â€œè®°ä½â€è®­ç»ƒé›†ä¸­çš„å›¾ç‰‡ï¼Œè€Œæ˜¯æ•æ‰åˆ°ç‰©ä½“æœ€æœ¬è´¨ã€æœ€ç¨³å®šçš„ç‰¹å¾ã€‚æ— è®ºä¸€ä¸ªç“¶å­æ€ä¹ˆæ”¾ï¼Œå®ƒç“¶èº«çš„ç‰¹ç‚¹ã€æ ‡ç­¾çš„çº¹ç†è¿™äº›å…³é”®ä¿¡æ¯æ˜¯ä¸å˜çš„ã€‚å›¾åƒå¢å¼ºæ­£æ˜¯é€šè¿‡å¼•å…¥å„ç§â€œå¹²æ‰°é¡¹â€ï¼Œå¼ºè¿«æ¨¡å‹å»å…³æ³¨è¿™äº›æ·±å±‚ã€ä¸å˜çš„ç‰¹å¾ï¼Œä»è€Œæˆä¸ºä¸€ä¸ªâ€œè§è¿‡ä¸–é¢â€çš„æ™ºèƒ½æ¨¡å‹ã€‚</p>
<p>ä½ ä¸éœ€è¦æ‰‹åŠ¨å®ç°è¿™äº›å¤æ‚çš„å¢å¼ºæ“ä½œã€‚YOLOåœ¨è®­ç»ƒæ—¶å·²ç»å†…ç½®äº†ä¸°å¯Œçš„å›¾åƒå¢å¼ºåŠŸèƒ½ï¼Œåªéœ€è¦åœ¨<code>model.train()</code>ä¸­é…ç½®ç›¸åº”å‚æ•°å³å¯ã€‚å¦‚ä¸‹æ˜¯YOLOå®˜æ–¹ç»™å‡ºçš„å¯é…ç½®å‚æ•°ï¼š</p>





























































































































































<table><thead><tr><th align="left">å‚æ•°</th><th align="left">ç±»å‹</th><th align="left">é»˜è®¤å€¼</th><th align="left">æ”¯æŒçš„ä»»åŠ¡</th><th align="left">èŒƒå›´</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><code>hsv_h</code></td><td align="left"><code>float</code></td><td align="left"><code>0.015</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code>, <code>classify</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">é€šè¿‡è‰²è½®çš„ä¸€å°éƒ¨åˆ†è°ƒæ•´å›¾åƒçš„è‰²è°ƒï¼Œä»è€Œå¼•å…¥é¢œè‰²å˜åŒ–ã€‚å¸®åŠ©æ¨¡å‹åœ¨ä¸åŒçš„å…‰ç…§æ¡ä»¶ä¸‹è¿›è¡Œæ³›åŒ–ã€‚</td></tr><tr><td align="left"><code>hsv_s</code></td><td align="left"><code>float</code></td><td align="left"><code>0.7</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code>, <code>classify</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">é€šè¿‡ä¸€å°éƒ¨åˆ†æ”¹å˜å›¾åƒçš„é¥±å’Œåº¦ï¼Œä»è€Œå½±å“é¢œè‰²çš„å¼ºåº¦ã€‚å¯ç”¨äºæ¨¡æ‹Ÿä¸åŒçš„ç¯å¢ƒæ¡ä»¶ã€‚</td></tr><tr><td align="left"><code>hsv_v</code></td><td align="left"><code>float</code></td><td align="left"><code>0.4</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code>, <code>classify</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">é€šè¿‡ä¸€å°éƒ¨åˆ†ä¿®æ”¹å›¾åƒçš„æ˜åº¦ï¼ˆäº®åº¦ï¼‰ï¼Œå¸®åŠ©æ¨¡å‹åœ¨å„ç§å…‰ç…§æ¡ä»¶ä¸‹è¡¨ç°è‰¯å¥½ã€‚</td></tr><tr><td align="left"><code>degrees</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code></td><td align="left"><code>0.0 - 180</code></td><td align="left">åœ¨æŒ‡å®šçš„è§’åº¦èŒƒå›´å†…éšæœºæ—‹è½¬å›¾åƒï¼Œæé«˜æ¨¡å‹è¯†åˆ«å„ç§æ–¹å‘ç‰©ä½“çš„èƒ½åŠ›ã€‚</td></tr><tr><td align="left"><code>translate</code></td><td align="left"><code>float</code></td><td align="left"><code>0.1</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">é€šè¿‡å›¾åƒå°ºå¯¸çš„ä¸€å°éƒ¨åˆ†åœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šå¹³ç§»å›¾åƒï¼Œå¸®åŠ©å­¦ä¹ æ£€æµ‹éƒ¨åˆ†å¯è§çš„ç‰©ä½“ã€‚</td></tr><tr><td align="left"><code>scale</code></td><td align="left"><code>float</code></td><td align="left"><code>0.5</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code>, <code>classify</code></td><td align="left"><code>&gt;=0.0</code></td><td align="left">é€šè¿‡å¢ç›Šå› å­ç¼©æ”¾å›¾åƒï¼Œæ¨¡æ‹Ÿç‰©ä½“ä¸ç›¸æœºçš„ä¸åŒè·ç¦»ã€‚</td></tr><tr><td align="left"><code>shear</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code></td><td align="left"><code>-180 - +180</code></td><td align="left">æŒ‰æŒ‡å®šçš„è§’åº¦é”™åˆ‡å›¾åƒï¼Œæ¨¡ä»¿ä»ä¸åŒè§’åº¦è§‚å¯Ÿç‰©ä½“çš„æ•ˆæœã€‚</td></tr><tr><td align="left"><code>perspective</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code></td><td align="left"><code>0.0 - 0.001</code></td><td align="left">å¯¹å›¾åƒåº”ç”¨éšæœºé€è§†å˜æ¢ï¼Œå¢å¼ºæ¨¡å‹ç†è§£ 3D ç©ºé—´ä¸­ç‰©ä½“çš„èƒ½åŠ›ã€‚</td></tr><tr><td align="left"><code>flipud</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code>, <code>classify</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">ä»¥æŒ‡å®šçš„æ¦‚ç‡å°†å›¾åƒä¸Šä¸‹ç¿»è½¬ï¼Œå¢åŠ æ•°æ®å˜åŒ–ï¼Œè€Œä¸å½±å“ç‰©ä½“çš„ç‰¹å¾ã€‚</td></tr><tr><td align="left"><code>fliplr</code></td><td align="left"><code>float</code></td><td align="left"><code>0.5</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code>, <code>classify</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">ä»¥æŒ‡å®šçš„æ¦‚ç‡å°†å›¾åƒå·¦å³ç¿»è½¬ï¼Œæœ‰åŠ©äºå­¦ä¹ å¯¹ç§°ç‰©ä½“å¹¶å¢åŠ æ•°æ®é›†çš„å¤šæ ·æ€§ã€‚</td></tr><tr><td align="left"><code>bgr</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">ä»¥æŒ‡å®šçš„æ¦‚ç‡å°†å›¾åƒé€šé“ä» RGB ç¿»è½¬åˆ° BGRï¼Œæœ‰åŠ©äºæé«˜å¯¹ä¸æ­£ç¡®é€šé“æ’åºçš„é²æ£’æ€§ã€‚</td></tr><tr><td align="left"><code>mosaic</code></td><td align="left"><code>float</code></td><td align="left"><code>1.0</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">å°†å››ä¸ªè®­ç»ƒå›¾åƒç»„åˆæˆä¸€ä¸ªï¼Œæ¨¡æ‹Ÿä¸åŒçš„åœºæ™¯ç»„æˆå’Œç‰©ä½“äº¤äº’ã€‚å¯¹äºå¤æ‚çš„åœºæ™¯ç†è§£éå¸¸æœ‰æ•ˆã€‚</td></tr><tr><td align="left"><code>mixup</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">æ··åˆä¸¤ä¸ªå›¾åƒåŠå…¶æ ‡ç­¾ï¼Œåˆ›å»ºä¸€ä¸ªåˆæˆå›¾åƒã€‚é€šè¿‡å¼•å…¥æ ‡ç­¾å™ªå£°å’Œè§†è§‰å˜åŒ–ï¼Œå¢å¼ºæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚</td></tr><tr><td align="left"><code>cutmix</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left"><code>detect</code>, <code>segment</code>, <code>pose</code>, <code>obb</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">ç»„åˆä¸¤å¼ å›¾åƒçš„éƒ¨åˆ†åŒºåŸŸï¼Œåˆ›å»ºå±€éƒ¨æ··åˆï¼ŒåŒæ—¶ä¿æŒæ¸…æ™°çš„åŒºåŸŸã€‚é€šè¿‡åˆ›å»ºé®æŒ¡åœºæ™¯æ¥å¢å¼ºæ¨¡å‹çš„é²æ£’æ€§ã€‚</td></tr><tr><td align="left"><code>copy_paste</code></td><td align="left"><code>float</code></td><td align="left"><code>0.0</code></td><td align="left"><code>segment</code></td><td align="left"><code>0.0 - 1.0</code></td><td align="left">åœ¨å›¾åƒä¸­å¤åˆ¶å’Œç²˜è´´å¯¹è±¡ï¼Œä»¥å¢åŠ å¯¹è±¡å®ä¾‹ã€‚</td></tr><tr><td align="left"><code>copy_paste_mode</code></td><td align="left"><code>str</code></td><td align="left"><code>flip</code></td><td align="left"><code>segment</code></td><td align="left">-</td><td align="left">æŒ‡å®š <code>copy-paste</code> è¦ä½¿ç”¨çš„ç­–ç•¥ã€‚é€‰é¡¹åŒ…æ‹¬ <code>'flip'</code> å’Œ <code>'mixup'</code>.</td></tr><tr><td align="left"><code>auto_augment</code></td><td align="left"><code>str</code></td><td align="left"><code>randaugment</code></td><td align="left"><code>classify</code></td><td align="left">-</td><td align="left">åº”ç”¨é¢„å®šä¹‰çš„å¢å¼ºç­–ç•¥ (<code>'randaugment'</code>, <code>'autoaugment'</code>æˆ– <code>'augmix'</code>ï¼‰é€šè¿‡è§†è§‰å¤šæ ·æ€§æ¥å¢å¼ºæ¨¡å‹æ€§èƒ½ã€‚</td></tr><tr><td align="left"><code>erasing</code></td><td align="left"><code>float</code></td><td align="left"><code>0.4</code></td><td align="left"><code>classify</code></td><td align="left"><code>0.0 - 0.9</code></td><td align="left">åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­éšæœºæ“¦é™¤å›¾åƒåŒºåŸŸï¼Œä»¥é¼“åŠ±æ¨¡å‹ä¸“æ³¨äºä¸å¤ªæ˜æ˜¾çš„ç‰¹å¾ã€‚</td></tr></tbody></table>
<p>å…¶å®ä¸æ­¢åœ¨å›¾åƒè¯†åˆ«é¢†åŸŸå¯ä»¥è¿™ä¹ˆåšï¼Œåœ¨å…¶ä»–é¢†åŸŸä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚å¯¹äºå£°éŸ³ä½œä¸ºè¾“å…¥åŒç†ï¼Œå¾€åŸå§‹çš„å£°éŸ³ä¸­åŠ å…¥å™ªéŸ³ï¼Œä¸åŒèƒŒæ™¯çš„å™ªéŸ³ç”šè‡³æ˜¯æ°´ä¸‹æˆ–è€…ç”µè¯çš„å£°éŸ³ç‰¹æ•ˆä½œä¸ºæ–°è®­ç»ƒé›†ã€‚å¦‚æœä½ çš„è®­ç»ƒé›†æ˜¯æ–‡å­—è¯†åˆ«çš„è¯ï¼Œé‚£ä¹ˆä¸åŒçš„å­—ä½“æ˜¾ç¤ºåˆå¯ä»¥å¾—åˆ°éå¸¸å¤šçš„è®­ç»ƒé›†ã€‚</p>
<p><strong>è¡¥å……çŸ¥è¯†ç‚¹ï¼šYOLOæ˜¯å¦‚ä½•â€œæ™ºèƒ½è£å‰ªâ€ï¼Œå°†ä»»æ„å›¾ç‰‡å˜ä¸ºæ ‡å‡†æ­£æ–¹å½¢çš„ï¼Ÿ</strong></p>
<p>ä¸Šé¢æˆ‘ä»¬æåˆ°ï¼Œåªè¦ä½ å®šä¹‰äº† <code>imgsz</code> å‚æ•°ï¼Œæ— è®ºä½ è¾“å…¥çš„å›¾ç‰‡ï¼ˆä¸è®ºæ˜¯è®­ç»ƒç”¨çš„å›¾ç‰‡è¿˜æ˜¯æ¨ç†ç”¨çš„å›¾ç‰‡ï¼‰æ˜¯æ¨ªå±çš„é£æ™¯ç…§ã€ç«–å±çš„äººåƒï¼Œè¿˜æ˜¯å„ç§å¥‡å¥‡æ€ªæ€ªçš„å°ºå¯¸ï¼ŒYOLOéƒ½èƒ½åœ¨èƒŒåé»˜é»˜åœ°å°†å®ƒä»¬å¤„ç†æˆç»Ÿä¸€å¤§å°çš„æ­£æ–¹å½¢å¼ é‡ã€‚å…¶æ ¸å¿ƒæ–¹æ³•å°±æ˜¯ï¼š<strong>ç­‰æ¯”ä¾‹ç¼©æ”¾ + æ™ºèƒ½å¡«å……</strong>ã€‚</p>
<p>æ•´ä¸ªè¿‡ç¨‹å¯ä»¥æ¸…æ™°åœ°åˆ†è§£ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼Œæˆ‘ä»¬ç»“åˆä¸‹å›¾æ¥ç†è§£ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b681cc4905ab48a08b62e9f0fff4bc20~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=%2FpJXsjpbtcwm4n%2BJOuMk44qogK4%3D" alt="cn16.jpg" loading="lazy"/></p>
<ol>
<li><strong>ç­‰æ¯”ä¾‹ç¼©æ”¾é•¿è¾¹</strong>ï¼šYOLOä¼šé¦–å…ˆæ‰¾åˆ°å›¾ç‰‡åŸå§‹çš„é•¿å’Œå®½ï¼Œå¹¶è¯†åˆ«å‡º<strong>æœ€é•¿è¾¹</strong>ã€‚ç„¶åï¼Œå®ƒä¼šå°†è¿™æ¡æœ€é•¿è¾¹ç›´æ¥ç¼©æ”¾åˆ°ä½ è®¾å®šçš„ <code>imgsz</code> ç›®æ ‡å°ºå¯¸ï¼ˆå¦‚640åƒç´ ï¼‰ã€‚åŒæ—¶ï¼Œå¦ä¸€æ¡çŸ­è¾¹ä¹Ÿä¼šæŒ‰ç…§å®Œå…¨ç›¸åŒçš„æ¯”ä¾‹è¿›è¡Œç¼©æ”¾ï¼Œä»¥ç¡®ä¿å›¾ç‰‡å†…å®¹ä¸å˜å½¢ã€‚</li>
<li><strong>è®¡ç®—å¹¶å¡«å……ç°è¾¹</strong>ï¼šä¸Šä¸€æ­¥ç¼©æ”¾åï¼Œå›¾ç‰‡çš„çŸ­è¾¹æ˜¾ç„¶è¿˜è¾¾ä¸åˆ° <code>imgsz</code> çš„è¦æ±‚ã€‚äºæ˜¯ï¼ŒYOLOä¼šåœ¨çŸ­è¾¹çš„ä¸¤ä¾§ï¼ˆé€šå¸¸æ˜¯ä¸Šä¸‹æˆ–å·¦å³ï¼‰å¡«å……ç°è‰²çš„åƒç´ æ¡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <strong>â€œç°è¾¹â€</strong> ï¼Œä»è€Œå°†å›¾ç‰‡â€œæ’‘â€æˆä¸€ä¸ªæ ‡å‡†çš„ <code>imgsz x imgsz</code> æ­£æ–¹å½¢ã€‚è¿™ä¸ªå¡«å……è¿‡ç¨‹æ˜¯è‡ªåŠ¨ä¸”ç²¾å‡†çš„ï¼Œç¡®ä¿ç›®æ ‡å§‹ç»ˆä½äºç”»é¢çš„æ­£ä¸­å¤®ã€‚</li>
<li><strong>åæ ‡åŒæ­¥è°ƒæ•´</strong>ï¼šå¯¹äºè®­ç»ƒå›¾ç‰‡è€Œè¨€ï¼Œå¡«å……åå›¾ç‰‡çš„å‡ ä½•ä¸­å¿ƒæ²¡æœ‰æ”¹å˜ï¼Œæ‰€ä»¥æ ‡æ³¨æ¡†ï¼ˆBounding Boxï¼‰çš„ä½ç½®ä¹Ÿéœ€è¦è¿›è¡Œç›¸åº”çš„åŒæ­¥è°ƒæ•´ã€‚YOLOåœ¨é¢„å¤„ç†é˜¶æ®µä¼šè‡ªåŠ¨å®Œæˆè¿™ä¸ªåæ ‡æ˜ å°„ï¼Œç¡®ä¿æ ‡æ³¨ä¿¡æ¯ä¸å¤„ç†åçš„å›¾åƒä¸¥æ ¼å¯¹é½ï¼Œä¸ºæ¨¡å‹çš„ç²¾å‡†å­¦ä¹ ä¿é©¾æŠ¤èˆªã€‚</li>
</ol>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡ï¼Ÿ</strong></p>
<p>è¿™ç§æ–¹å¼æœ€å¤§é™åº¦åœ°ä¿ç•™åŸå§‹å›¾åƒçš„å®Œæ•´ä¿¡æ¯å’Œæ¯”ä¾‹ï¼Œé¿å…å› æš´åŠ›æ‹‰ä¼¸å¯¼è‡´çš„å›¾åƒå¤±çœŸå’Œç›®æ ‡å˜å½¢ã€‚æ— è®ºæ˜¯è®­ç»ƒè¿˜æ˜¯æ¨ç†ï¼Œæ¨¡å‹æ¥æ”¶åˆ°çš„éƒ½æ˜¯å°ºå¯¸ç»Ÿä¸€ã€æ¯”ä¾‹åè°ƒçš„æ•°æ®ï¼Œè¿™æå¤§åœ°ç®€åŒ–äº†ç½‘ç»œçš„è®¡ç®—è¿‡ç¨‹ï¼Œæå‡äº†æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œé¢„æµ‹çš„ç¨³å®šæ€§ã€‚</p>
<h3 data-id="heading-20">å››. ç›®æ ‡æ£€æµ‹ä»»åŠ¡</h3>
<h4 data-id="heading-21">4.1 æ•°æ®é›†</h4>
<p>å¦‚æœè¯´åˆ†ç±»ä»»åŠ¡æ•™ä¼šæ¨¡å‹â€œå›¾ç‰‡é‡Œæ˜¯ä»€ä¹ˆâ€ï¼Œé‚£ä¹ˆç›®æ ‡æ£€æµ‹ä»»åŠ¡å°±æ›´è¿›ä¸€æ­¥â€”â€”ä¸ä»…è¦è¯†åˆ«å‡ºç‰©ä½“ï¼Œè¿˜è¦ç²¾å‡†å®šä½å®ƒä»¬çš„ä½ç½®ï¼Œå³â€œåœ¨å“ªé‡Œâ€å’Œâ€œæ˜¯ä»€ä¹ˆâ€ã€‚è¿™ç§æ›´å¤æ‚çš„ä»»åŠ¡ï¼Œè‡ªç„¶éœ€è¦æ›´ä¸°å¯Œçš„æ•°æ®ç»„ç»‡å½¢å¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/21fe337387134a34bcd259834afabb85~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=vpucNpck16pMW9FnUip1NGhw%2BpI%3D" alt="c14.jpg" loading="lazy"/></p>
<p>ä¸åˆ†ç±»ä»»åŠ¡ç›´æ¥è¯»å–ä¸»æ–‡ä»¶å¤¹ä¸åŒï¼Œç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¾èµ–äºä¸€ä¸ªä»¥ <code>yaml</code> ç»“å°¾çš„<strong>æ•°æ®é›†é…ç½®æ–‡ä»¶</strong>ã€‚è¿™ä¸ªæ–‡ä»¶å°±åƒæ•´ä¸ªæ•°æ®é›†çš„â€œå¯¼èˆªåœ°å›¾â€ï¼Œè®­ç»ƒæ—¶ç¨‹åºä¼šè¯»å–å®ƒæ¥æ‰¾åˆ°æ‰€æœ‰éœ€è¦çš„æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥è‡ªç”±å‘½åè¿™ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å°†å…¶å‘½åä¸º <code>data.yaml</code>ã€‚</p>
<p><code>data.yaml</code> æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶æ ‡å‡†å†…å®¹ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">path: C:/Users/Ming/Desktop/dataset  # æ•°æ®é›†çš„æ ¹ç›®å½•è·¯å¾„
train: images/train  # è®­ç»ƒé›†å›¾ç‰‡è·¯å¾„ [ç›¸å¯¹äºæ ¹ç›®å½•]
val: images/val  # éªŒè¯é›†å›¾ç‰‡è·¯å¾„ [ç›¸å¯¹äºæ ¹ç›®å½•]
test: images/test # æµ‹è¯•é›†å›¾ç‰‡è·¯å¾„ [ç›¸å¯¹äºæ ¹ç›®å½•] (å¯é€‰)
<span class="hljs-meta prompt_">
# </span><span class="bash">ç±»åˆ«åç§°ä¸ç´¢å¼•çš„æ˜ å°„å…³ç³»</span>
names:
  0: person
  1: bicycle
  2: car
  3: motorcycle
  4: airplane
</code></pre>
<p>åˆ›å»ºå®ƒéå¸¸ç®€å•ï¼šæ–°å»ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ˆtxtï¼‰ï¼Œå°†ä¸Šè¿°å†…å®¹å¤åˆ¶è¿›å»ï¼Œæ ¹æ®ä½ çš„å®é™…æƒ…å†µä¿®æ”¹è·¯å¾„å’Œç±»åˆ«ï¼Œæœ€åå°†æ–‡ä»¶åç¼€åæ”¹ä¸º <code>.yaml</code> å³å¯ã€‚ç¼–è¾‘æ—¶ï¼Œç”¨ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨æˆ–ä»£ç ç¼–è¾‘å™¨æ‰“å¼€éƒ½è¡Œã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦æŒ‰ç…§ä»¥ä¸‹ç»“æ„æ¥ç»„ç»‡ä½ çš„æ•°æ®é›†æ–‡ä»¶å¤¹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">data.yaml
dataset/
â”‚
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ train/         <span class="hljs-comment"># å­˜æ”¾æ‰€æœ‰è®­ç»ƒå›¾ç‰‡</span>
â”‚   â”‚   â”œâ”€â”€ img_001.jpg
â”‚   â”‚   â”œâ”€â”€ img_002.jpg
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ val/           <span class="hljs-comment"># å­˜æ”¾æ‰€æœ‰éªŒè¯å›¾ç‰‡</span>
â”‚   â””â”€â”€ <span class="hljs-built_in">test</span>/          <span class="hljs-comment"># å­˜æ”¾æ‰€æœ‰æµ‹è¯•å›¾ç‰‡ (å¯é€‰)</span>
â”‚
â””â”€â”€ labels/
    â”œâ”€â”€ train/         <span class="hljs-comment"># å­˜æ”¾æ‰€æœ‰è®­ç»ƒå›¾ç‰‡å¯¹åº”çš„æ ‡ç­¾æ–‡ä»¶</span>
    â”‚   â”œâ”€â”€ img_001.txt
    â”‚   â”œâ”€â”€ img_002.txt
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ val/           <span class="hljs-comment"># å­˜æ”¾æ‰€æœ‰éªŒè¯å›¾ç‰‡å¯¹åº”çš„æ ‡ç­¾æ–‡ä»¶</span>
    â””â”€â”€ <span class="hljs-built_in">test</span>/          <span class="hljs-comment"># å­˜æ”¾æ‰€æœ‰æµ‹è¯•å›¾ç‰‡å¯¹åº”çš„æ ‡ç­¾æ–‡ä»¶ (å¯é€‰)</span>
</code></pre>
<p>çœ‹åˆ°è¿™é‡Œï¼Œä½ ä¼šå‘ç°ä¸¤ä¸ªä¸åˆ†ç±»ä»»åŠ¡æ˜¾è‘—ä¸åŒçš„æ–°å…ƒç´ ï¼šä¸€ä¸ªæ˜¯å¤šå‡ºæ¥çš„ <code>val</code> (éªŒè¯é›†)ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ç¥ç§˜çš„ <code>labels</code> æ–‡ä»¶å¤¹åŠå…¶ä¸­çš„ <code>.txt</code> æ–‡ä»¶ã€‚æ¥ä¸‹æ¥ä¸€ä¸€è¯´æ˜ã€‚</p>
<p><strong>éªŒè¯é›†å°±æ˜¯æ¨¡å‹çš„â€œæ¨¡æ‹Ÿè€ƒåœºâ€</strong>ï¼Œåœ¨åˆ†ç±»ç« èŠ‚ï¼Œæˆ‘ä»¬è®¤è¯†äº† <strong>è®­ç»ƒé›†ï¼ˆæ•™ç§‘ä¹¦ï¼‰</strong> å’Œ <strong>æµ‹è¯•é›†ï¼ˆæœŸæœ«è€ƒè¯•ï¼‰</strong>ã€‚éªŒè¯é›†åˆ™æ‰®æ¼”ç€ <strong>â€œæ¨¡æ‹Ÿè€ƒè¯•â€</strong> çš„è§’è‰²ã€‚å®ƒä¸ç›´æ¥ç”¨äºæ›´æ–°æ¨¡å‹çš„æƒé‡å‚æ•°ï¼Œä½†ä¼šå‚ä¸è®­ç»ƒè¿‡ç¨‹â€”â€”æ¨¡å‹åœ¨æ¯ä¸ªè®­ç»ƒé˜¶æ®µåï¼Œéƒ½ä¼šåœ¨éªŒè¯é›†ä¸Šâ€œè€ƒä¸€æ¬¡â€ï¼Œæˆ‘ä»¬æ ¹æ®å®ƒçš„è¡¨ç°æ¥è°ƒæ•´ä¸€äº›è®­ç»ƒç­–ç•¥ï¼ˆå¦‚å­¦ä¹ ç‡ï¼‰å’Œé€‰æ‹©æœ€ä½³æ¨¡å‹ï¼Œç®€å•æ¥è¯´å°±æ˜¯<strong>ä¸ºäº†åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæä¾›ä¸€ä¸ªä¸å‚ä¸â€œå­¦ä¹ â€çš„å®¢è§‚è¯„ä»·æ ‡å‡†ï¼Œå¸®åŠ©æˆ‘ä»¬ç›‘æ§æ¨¡å‹åœ¨æœªè§æ•°æ®ä¸Šçš„æ³›åŒ–èƒ½åŠ›ï¼Œé˜²æ­¢å®ƒå˜æˆåªä¼šæ­»è®°ç¡¬èƒŒâ€œè®­ç»ƒé›†ç­”æ¡ˆâ€çš„ä¹¦å‘†å­ï¼Œä»è€ŒæŒ‘é€‰å‡ºçœŸæ­£â€œå­¦æ‡‚äº†â€çš„æ¨¡å‹ã€‚</strong> é‚£ä¹ˆåº”è¯¥æ”¾å¤šå°‘å›¾ç‰‡åˆ°éªŒè¯é›†å‘¢ï¼Ÿä¸€ä¸ªå¸¸ç”¨çš„ç»éªŒæ³•åˆ™æ˜¯ï¼Œè®©éªŒè¯é›†çš„å¤§å°ä¸æµ‹è¯•é›†ç›¸è¿‘å³å¯ã€‚</p>
<p><strong>æ ‡ç­¾æ–‡ä»¶ï¼ˆtxtï¼‰å°±æ˜¯å‘Šè¯‰æ¨¡å‹â€œç›®æ ‡åœ¨å“ªâ€</strong>ï¼Œæ¯ä¸ªå›¾ç‰‡ï¼ˆå¦‚ <code>img_001.jpg</code>ï¼‰éƒ½ä¼šæœ‰ä¸€ä¸ªåŒåä¸”åŒç›®å½•ç»“æ„çš„ <code>.txt</code> æ ‡ç­¾æ–‡ä»¶ï¼ˆå¦‚ <code>labels/train/img_001.txt</code>ï¼‰ã€‚è¿™ä¸ªæ–‡ä»¶ç²¾ç¡®è®°å½•äº†å›¾ç‰‡ä¸­æ¯ä¸ªéœ€è¦æ£€æµ‹ç›®æ ‡çš„ä½ç½®å’Œç±»åˆ«ã€‚</p>
<p>ä»¥img_001.jpgå›¾ç‰‡ä¸ºä¾‹ï¼Œå¦‚ä¸‹</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f907e60139347b6b57f82a3d80a2d01~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=%2FIHMANovcPgKJv5L1nT8nzzh0ho%3D" alt="c15.jpg" loading="lazy"/></p>
<p>å…¶å¯¹åº”çš„ <code>img_001.txt</code> æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">0 0.48 0.63 0.69 0.71
0 0.74 0.52 0.31 0.93
</code></pre>
<p>æˆ‘ä»¬æ¥è§£è¯»ç¬¬ä¸€è¡Œ <code>0 0.48 0.63 0.69 0.71</code>ï¼š</p>
<ul>
<li><strong>ç¬¬ä¸€ä¸ªæ•°å­— <code>0</code></strong>ï¼šè¡¨ç¤ºç›®æ ‡çš„ç±»åˆ«ç´¢å¼•ï¼Œå¯¹åº” <code>data.yaml</code> ä¸­ <code>names</code> ä¸‹çš„ <code>0: person</code>ï¼Œå³â€œäººç±»â€ã€‚</li>
<li><strong>åç»­å››ä¸ªæ•°å­— <code>0.48 0.63 0.69 0.71</code></strong>ï¼šå®ƒä»¬å…±åŒæè¿°äº†ç›®æ ‡çš„ä½ç½®å’Œå¤§å°ï¼Œæ ¼å¼ä¸º <code>(x_center, y_center, width, height)</code>ã€‚
<ul>
<li>æ‰€æœ‰è¿™äº›åæ ‡éƒ½æ˜¯<strong>å½’ä¸€åŒ–</strong>çš„ï¼Œå³å®ƒä»¬æ˜¯ç›¸å¯¹äºå›¾ç‰‡æ€»å®½åº¦å’Œæ€»é«˜åº¦çš„æ¯”ä¾‹å€¼ï¼ŒèŒƒå›´åœ¨0åˆ°1ä¹‹é—´ã€‚</li>
<li><code>(x_center, y_center)</code> = <code>(0.48, 0.63)</code>ï¼šè¿™æ˜¯ç›®æ ‡è¾¹ç•Œæ¡†<strong>ä¸­å¿ƒç‚¹</strong>çš„åæ ‡ã€‚</li>
<li><code>(width, height)</code> = <code>(0.69, 0.71)</code>ï¼šè¿™æ˜¯ç›®æ ‡è¾¹ç•Œæ¡†çš„<strong>å®½åº¦</strong>å’Œ<strong>é«˜åº¦</strong>ã€‚</li>
<li>æ¨¡å‹ä¼šä»¥ <code>(0.48, 0.63)</code> ä¸ºä¸­å¿ƒï¼Œç”»ä¸€ä¸ªå®½ä¸ºå›¾ç‰‡å®½åº¦0.69å€ã€é«˜ä¸ºå›¾ç‰‡é«˜åº¦0.71å€çš„çŸ©å½¢æ¡†ï¼Œè¿™ä¸ªæ¡†ä½çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬è¦æ£€æµ‹çš„â€œäººâ€ã€‚</li>
</ul>
</li>
</ul>
<p>ç¬¬äºŒè¡Œæ•°æ®å«ä¹‰åŒç†ï¼Œå®ƒæ ‡æ³¨äº†å›¾ç‰‡ä¸­çš„å¦ä¸€ä¸ªäººã€‚</p>
<p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¸å¯èƒ½æ‰‹åŠ¨å»è®¡ç®—è¿™äº›å½’ä¸€åŒ–åæ ‡ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰è®¸å¤šå¼ºå¤§çš„å›¾å½¢åŒ–å·¥å…·å¯ä»¥å¸®æˆ‘ä»¬è½»æ¾å®Œæˆæ ‡æ³¨ï¼Œå®ƒä»¬èƒ½è‡ªåŠ¨ç”Ÿæˆç¬¦åˆYOLOæ ¼å¼çš„æ•°æ®é›†ç»“æ„ã€‚</p>
<hr/>
<p>æœ¬ç« èŠ‚å°†ä¼šå¸¦å¤§å®¶å®Œæˆä¸€ä¸ªæœ‰è¶£çš„ç›®æ ‡æ£€æµ‹å®æˆ˜é¡¹ç›®ï¼š<strong>è®­ç»ƒä¸€ä¸ªèƒ½å¤Ÿç²¾å‡†è¯†åˆ«çƒ­é—¨æ¸¸æˆã€Šåæç²¾è‹±2ã€‹ï¼ˆCS2ï¼‰ç”»é¢ä¸­çš„â€œè­¦å¯Ÿâ€ä¸â€œåŒªå¾’â€çš„æ™ºèƒ½æ¨¡å‹ã€‚</strong></p>
<p>ï¼ˆ<em>å°çŸ¥è¯†ï¼šCS2æ˜¯ä¸€æ¬¾æå…·å½±å“åŠ›çš„å›¢é˜Ÿç«æŠ€ç¬¬ä¸€äººç§°å°„å‡»æ¸¸æˆï¼Œç©å®¶ä¸»è¦åˆ†ä¸ºâ€œåæç²¾è‹±â€ï¼ˆCounter-Terrorists, å³è­¦å¯Ÿï¼‰ä¸â€œææ€–åˆ†å­â€ï¼ˆTerrorists, å³åŒªå¾’ï¼‰ä¸¤å¤§é˜µè¥ï¼Œæˆ‘ä»¬çš„AIå°±è¦å­¦ä¼šåœ¨å¤æ‚çš„æ¸¸æˆç”»é¢ä¸­å°†å®ƒä»¬åˆ†è¾¨å‡ºæ¥ã€‚</em>ï¼‰</p>
<p>æˆ‘å·²ç»æŠŠè®­ç»ƒç”¨çš„æ•°æ®é›†æ”¾åœ¨äº†ä¸Šé¢æä¾›çš„ç½‘ç›˜é“¾æ¥ä¸­ï¼Œåä¸º <code>cs2_dataset.zip</code> ã€‚ä¸‹è½½å¹¶è§£å‹åï¼Œä½ ä¼šå‘ç°å…¶æ–‡ä»¶å¤¹ç»“æ„ä¸ä¸Šè¿°è§„èŒƒå®Œå…¨ä¸€è‡´ã€‚è¿™å°±åƒä¸€ä¸ªæ ‡å‡†çš„â€œç›®æ ‡æ£€æµ‹é¡¹ç›®æ¨¡æ¿â€ï¼Œè¯·ä½ åœ¨æœªæ¥ç»„ç»‡è‡ªå·±çš„æ•°æ®æ—¶ï¼Œä¹ŸåŠ¡å¿…éµå¾ªåŒæ ·çš„è§„èŒƒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3ad5b22870ea4abb9c8a8c3cf06d4a3d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=LZisNu8W6cIsux5Nd8L4dOozaMw%3D" alt="cn17.jpg" loading="lazy"/></p>
<h4 data-id="heading-22">4.2 å¸¸ç”¨æ ‡æ³¨å·¥å…·</h4>
<p>è¿™é‡Œï¼Œæˆ‘å‘å¤§å®¶æ¨èä¸€ä¸ªç»å…¸ã€è½»é‡ä¸”å¹¿æ³›ä½¿ç”¨çš„æ ‡æ³¨å·¥å…·â€”â€”<strong>LabelImg</strong>ã€‚</p>
<p>å¯ä»¥åœ¨ä¸Šæ–¹æˆ‘åˆ†äº«çš„ç½‘ç›˜é“¾æ¥ä¸­ä¸‹è½½ï¼Œåä¸º <code>label_img.zip</code>ã€‚ä½ å¯ä»¥ç›´æ¥ä¸‹è½½å¹¶è§£å‹åˆ°ä»»æ„æ–¹ä¾¿çš„ç›®å½•ã€‚</p>
<p>è§£å‹åï¼Œä½ ä¼šçœ‹åˆ°æ–‡ä»¶å¤¹å†…éå¸¸ç®€å•ï¼Œä¸»è¦åŒ…å« <code>labelImg.exe</code> å¯æ‰§è¡Œæ–‡ä»¶å’Œä¸€ä¸ª <code>data</code> æ–‡ä»¶å¤¹ã€‚<strong>è¯·å…ˆä¸è¦æ€¥äºåŒå‡»å¯åŠ¨ç¨‹åº</strong>ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€æ­¥æ˜¯é¢„å…ˆå‘Šè¯‰å®ƒæˆ‘ä»¬è¦æ ‡æ³¨å“ªäº›ä¸œè¥¿ã€‚è¿›å…¥ <code>data</code> æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°åä¸º <code>predefined_classes.txt</code> çš„æ–‡æœ¬æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶å°±æ˜¯ç”¨æ¥è®°å½•ç±»åˆ«çš„ï¼Œæ¯”å¦‚ä½ çš„ä»»åŠ¡æ˜¯åˆ†ç±»çŒ«ï¼Œç‹—ï¼Œäººï¼Œé‚£ä¹ˆå°±æŠŠè¿™ä¸‰ä¸ªç±»åˆ«æå‰å†™å…¥è¿™ä¸ªtxtæ–‡ä»¶ä¸­ï¼Œä¸€è¡Œå†™ä¸€ä¸ªç±»åˆ«ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/05c0f053389c4a32a1308b69dfd2ea07~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=bsWClPlSwsGMPzsK2CqD2lmWBbw%3D" alt="c18.jpg" loading="lazy"/></p>
<pre><code class="hljs language-txt" lang="txt">dog
cat
human
</code></pre>
<p>ä¸ºäº†è®©æ ‡æ³¨è¿‡ç¨‹æ¸…æ™°é«˜æ•ˆï¼Œå»ºè®®ä½ åœ¨å¼€å§‹å‰åˆ›å»ºä¸¤ä¸ªä¸“é—¨çš„æ–‡ä»¶å¤¹ï¼š</p>
<ul>
<li><strong><code>images</code>æ–‡ä»¶å¤¹</strong>ï¼šç”¨äºå­˜æ”¾ä½ å‡†å¤‡å¥½çš„ç­‰å¾…æ ‡æ³¨çš„æ•°æ®é›†å›¾ç‰‡ã€‚</li>
<li><strong><code>labels</code>æ–‡ä»¶å¤¹</strong>ï¼šä½œä¸ºä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œå‡†å¤‡ç”¨æ¥æ‰¿æ¥LabelImgè‡ªåŠ¨ç”Ÿæˆçš„YOLOæ ¼å¼æ ‡æ³¨æ–‡ä»¶ï¼ˆæ¯ä¸ªå›¾ç‰‡ä¼šå¯¹åº”ä¸€ä¸ªåŒåçš„<code>.txt</code>æ–‡ä»¶ï¼‰ã€‚</li>
</ul>
<p>æ¥ç€ï¼Œä½ å°±å¯ä»¥æ‰“å¼€<code>labelImg.exe</code>ç¨‹åºäº†ã€‚ç„¶åæŒ‰ç…§å¦‚ä¸‹å›¾ç‰‡è¿›è¡Œåˆå§‹è®¾ç½®</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/36c9c56820bb451ba66e208c4d5292b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=fUFurb1BPOmsgukmxNz19yZi8Nw%3D" alt="c19.jpg" loading="lazy"/></p>
<p>è®¾ç½®å¥½åï¼ŒæŒ‰ç…§ä¸‹å›¾æ‰€ç¤ºæ“ä½œ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfc57bd4ebb9448ba7480b71427ca2fb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=aIoZSc1bXnBJJt4DBciK%2BiWsoA8%3D" alt="c20.jpg" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f746d4a3dd0049558676f99d7c36fb8a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=I0CkDkf%2F%2F9FbH6v18Rh2rgxR7JI%3D" alt="c21.jpg" loading="lazy"/></p>
<p>æ ‡æ³¨å¥½è¿™ä¸€å¼ å›¾ç‰‡åï¼Œä½ å¯ä»¥æŒ‰ä¸€ä¸‹wç»§ç»­æ ‡æ³¨å…¶å®ƒå†…å®¹ï¼Œæˆ–è€…æŒ‰ä¸‹Dé”®è·³è½¬åˆ°ä¸‹ä¸€å¼ å¹¶è‡ªåŠ¨ä¿å­˜ï¼Œç»§ç»­æ ‡æ³¨ä¸‹ä¸€å¼ å›¾ç‰‡ã€‚</p>
<p>å°æç¤ºï¼šå¦‚æœä¸å°å¿ƒè·³è¿‡äº†ï¼Œæˆ–è€…éœ€è¦å›çœ‹ä¿®æ”¹ï¼Œå¯ä»¥æŒ‰<code>A</code>é”®å¯ä»¥å›åˆ°ä¸Šä¸€å¼ </p>
<p>ç­‰ä½ æŒ‰éƒ¨å°±ç­çš„å®Œæˆäº†æ‰€æœ‰å›¾ç‰‡çš„æ ‡æ³¨ï¼Œä½ å°±å¾—åˆ°äº†ä¸€ä¸ªä¸ <code>images</code> æ–‡ä»¶å¤¹å¯¹åº”çš„ <code>labels</code> æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾ç€æ¯ä¸€å¼ å›¾ç‰‡çš„ç²¾ç¡®åæ ‡ä¸æ ‡ç­¾â€”â€”è¿™æ˜¯ä½ è¾›å‹¤åŠ³åŠ¨çš„å®è´µæˆæœã€‚ä¸è¿‡ç»†å¿ƒè§‚å¯Ÿä½ ä¼šå‘ç°ï¼Œç›®å‰çš„æ–‡ä»¶ç»“æ„ï¼ˆä¸€ä¸ªå›¾ç‰‡å¤¹å’Œä¸€ä¸ªæ ‡ç­¾å¤¹ï¼‰è¿˜ä¸æ˜¯YOLOæ‰€è¦æ±‚çš„æ ‡å‡†å½¢å¼ã€‚æˆ‘ä»¬è¿˜éœ€è¦å°†æ•°æ®é›†ç§‘å­¦åœ°<strong>åˆ’åˆ†ä¸ºè®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†</strong>ï¼Œæ‰èƒ½æŠ•å…¥è®­ç»ƒã€‚</p>
<p>ä½ å¯èƒ½ä¼šæƒ³ï¼šâ€œæ˜¯ä¸æ˜¯éœ€è¦æ‰‹åŠ¨å‰ªåˆ‡ç²˜è´´ï¼ŒæŠŠæ–‡ä»¶ä¸€ä¸ªä¸ªåˆ†åˆ°ä¸åŒæ–‡ä»¶å¤¹é‡Œï¼Ÿâ€â€”â€”è¿™ç¡®å®æ˜¯ä¸€ç§æ–¹æ³•ï¼Œä½†å½“é¢å¯¹æˆç™¾ä¸Šåƒå¼ å›¾ç‰‡æ—¶ï¼Œæ‰‹åŠ¨æ“ä½œä¸ä»…æ•ˆç‡ä½ä¸‹ï¼Œè¿˜ææ˜“å‡ºé”™ã€‚</p>
<p>è¿™é‡Œç»™å¤§å®¶å‡†å¤‡å¥½äº†ä¸€ä¸ªèƒ½å¤Ÿè‡ªåŠ¨å®Œæˆæ•°æ®é›†åˆ’åˆ†çš„Pythonè„šæœ¬ï¼Œå¹¶é™„ä¸Šäº†è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ã€‚ä½ å¯ä»¥åœ¨ä¸Šæ–‡æä¾›çš„ç½‘ç›˜é“¾æ¥ä¸­çš„ <strong>â€œå¸¸ç”¨Pythoné¢„å¤„ç†è„šæœ¬â€</strong> æ–‡ä»¶å¤¹é‡Œæ‰¾åˆ°å®ƒã€‚</p>
<h4 data-id="heading-23">4.3 æ¨¡å‹è®­ç»ƒ</h4>
<p>æ¨¡å‹è®­ç»ƒå°±éå¸¸ç®€å•äº†ï¼Œä¸‹é¢çš„ä»£ç ä¾¿æ˜¯å¯åŠ¨è®­ç»ƒçš„å…¨éƒ¨æ ¸å¿ƒï¼Œä½ ä¼šå‘ç°å®ƒä¸åˆ†ç±»ä»»åŠ¡çš„ä»£ç å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO

<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    model = YOLO(<span class="hljs-string">"./yolo11s.pt"</span>)	<span class="hljs-comment"># åŠ è½½é¢„è®­ç»ƒæ¨¡å‹</span>
    
    <span class="hljs-comment"># å¯åŠ¨è®­ç»ƒæµç¨‹</span>
    results = model.train(
        data=<span class="hljs-string">"./data.yaml"</span>,  <span class="hljs-comment"># ã€å…³é”®ã€‘è¿™é‡Œæ˜¯æ•°æ®é›†é…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼Œè€Œéæ–‡ä»¶å¤¹è·¯å¾„</span>
        epochs=<span class="hljs-number">30</span>,         
        imgsz=<span class="hljs-number">720</span>,          <span class="hljs-comment"># è¾“å…¥å›¾åƒçš„å°ºå¯¸ï¼Œæ­¤å¤„ç»Ÿä¸€ç¼©æ”¾ä¸º720x720åƒç´ </span>
        batch=<span class="hljs-number">0.6</span>,          
        project=<span class="hljs-string">"detection_results"</span>,  
        deterministic=<span class="hljs-literal">False</span>, 
    )
</code></pre>
<p>å”¯ä¸€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>data</code>å‚æ•°ä¸å†ç›´æ¥æŒ‡å‘ä½ çš„æ•°æ®é›†æ–‡ä»¶å¤¹ï¼Œè€Œæ˜¯<strong>ä¸€ä¸ªæè¿°äº†æ•°æ®é›†æ‰€æœ‰ä¿¡æ¯çš„<code>.yaml</code>é…ç½®æ–‡ä»¶</strong>ã€‚</p>
<p>å‰©ä½™çš„å†…å®¹ï¼ŒåŒ…æ‹¬å‚æ•°è®¾ç½®ä»€ä¹ˆçš„éƒ½å’Œåˆ†ç±»ä»»åŠ¡ä¸€æ ·ï¼Œä½ å¯ä»¥å‚è€ƒåˆ†ç±»ä»»åŠ¡çš„â€œæ¨¡å‹è®­ç»ƒâ€ç« èŠ‚æ¥è®¾ç½®ä½ çš„å‚æ•°ï¼Œäº†è§£å®ƒä»¬çš„ä½œç”¨ã€‚</p>
<p>åœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä½ å¯ä»¥åœ¨ç»ˆç«¯æˆ–å‘½ä»¤è¡Œä¸­çœ‹åˆ°ç±»ä¼¼ä¸‹å›¾çš„è¾“å‡ºï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/037a06c8eb1848a38e1a5a546cd04b8e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=pp4GfMjVx%2BKzN0XmwyCge2zO1iA%3D" alt="b1.jpg" loading="lazy"/></p>
<p>ä¸åˆ†ç±»ä»»åŠ¡ä¸»è¦å…³æ³¨å‡†ç¡®ç‡ä¸åŒï¼Œç›®æ ‡æ£€æµ‹çš„è¯„ä¼°æ›´ä¸ºç²¾ç»†ã€‚åœ¨æ¯ä¸ªè®­ç»ƒå‘¨æœŸï¼Œä½ éƒ½ä¼šçœ‹åˆ°ä¸€æ•´å¥—ä¸°å¯Œçš„è¯„ä¼°æŒ‡æ ‡ï¼Œå®ƒä»¬ä»ä¸åŒè§’åº¦åæ˜ äº†æ¨¡å‹çš„æ•ˆæœï¼šæœ‰box_loss,cls_loss,df1_loss,instances,P,R,mAP50,mAP50-95ç­‰å‚æ•°</p>
<p>è®­ç»ƒç»“æŸåï¼Œç¨‹åºè¿˜ä¼šè´´å¿ƒåœ°ç”Ÿæˆä¸€ä»½æ€»ç»“æ€§çš„è¯„ä¼°æŠ¥å‘Šè¡¨ï¼Œå…¶ä¸­æŠŠæ¯ä¸ªç±»åˆ«çš„æŒ‡æ ‡éƒ½åˆ—å‡ºæ¥äº†ï¼Œè¿™é‡Œæ˜¯policeå’Œrobberä¸¤ä¸ªç±»åˆ«</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cdd0bfcd8a2d4db2be2b21a00af7f79c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=wrLI0bftWe4lOM7Ub7xfTadIllk%3D" alt="b2.jpg" loading="lazy"/></p>
<p>è¿™äº›æ¨¡å‹çš„æŒ‡æ ‡å°†åœ¨ä¸‹ä¸€èŠ‚è¯¦ç»†ä»‹ç»ã€‚</p>
<h4 data-id="heading-24">4.4 ç»“æœæ•°æ®è§£è¯»</h4>
<p>ä¸‹é¢çš„è¿™äº›æ˜¯è¯„ä¼°ä¸€ä¸ªæ¨¡å‹å¥½åçš„å…³é”®æŒ‡æ ‡ï¼Œä¸€æ—¦ä½ æ‡‚äº†ä¸‹é¢è¿™å‡ ä¸ªæ ¸å¿ƒæŒ‡æ ‡ï¼Œä½ å°±èƒ½å¯¹æ¨¡å‹çš„æ€§èƒ½äº†å¦‚æŒ‡æŒï¼Œå¹¶ç²¾å‡†åœ°æŒ‡å‡ºå®ƒçš„å¼ºé¡¹å’ŒçŸ­æ¿ã€‚</p>
<ul>
<li>
<p><strong>box_loss:</strong> è¾¹ç•Œæ¡†å›å½’æŸå¤±ã€‚å®ƒè¡¡é‡æ¨¡å‹é¢„æµ‹çš„ç‰©ä½“è¾¹ç•Œæ¡†ï¼ˆBounding Boxï¼‰ä¸çœŸå®æ ‡æ³¨æ¡†ä¹‹é—´çš„å·®è·ï¼ŒåŒ…æ‹¬ä¸­å¿ƒç‚¹åæ ‡ã€å®½åº¦å’Œé«˜åº¦çš„è¯¯å·®ã€‚å®ƒçš„ä¸‹é™æ„å‘³ç€æ¨¡å‹æ­£åœ¨å­¦ä¹ å¦‚ä½•<strong>æ›´ç²¾å‡†åœ°å®šä½ç‰©ä½“</strong>ï¼Œæ¡†çš„ä½ç½®å’Œå¤§å°è¶Šæ¥è¶Šå‡†ã€‚</p>
</li>
<li>
<p><strong>cls_loss:</strong> åˆ†ç±»æŸå¤±ã€‚å®ƒè¡¡é‡æ¨¡å‹å¯¹æ¡†å†…ç‰©ä½“åˆ†ç±»çš„æ­£ç¡®æ€§ï¼ˆæ¯”å¦‚ï¼ŒæŠŠâ€œè­¦å¯Ÿâ€è¯¯åˆ¤ä¸ºâ€œåŒªå¾’â€å°±ä¼šäº§ç”Ÿå¾ˆé«˜çš„åˆ†ç±»æŸå¤±ï¼‰ã€‚å®ƒçš„ä¸‹é™æ„å‘³ç€æ¨¡å‹æ­£åœ¨å­¦ä¹ <strong>æ›´å‡†ç¡®åœ°è¯†åˆ«ç‰©ä½“çš„ç±»åˆ«</strong>ï¼Œä¸å†â€œæŒ‡é¹¿ä¸ºé©¬â€ã€‚</p>
</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬ä»¥å¦‚ä¸‹ä¾‹å­å¸¦å¤§å®¶äº†è§£å‰©ä½™çš„å‚æ•°æ„æ€ï¼š</p>
<p>èƒŒæ™¯è®¾å®š</p>
<ul>
<li><strong>ä»»åŠ¡</strong>ï¼šä½ è®­ç»ƒäº†ä¸€ä¸ªâ€œè­¦å¯Ÿâ€ï¼ˆYOLOæ¨¡å‹ï¼‰ï¼Œåœ¨å›¾åƒä¸ŠæŠ“â€œå°å·â€ï¼ˆç¼ºé™·ç›®æ ‡ï¼‰ã€‚</li>
<li><strong>éªŒè¯é›†</strong>ï¼šä¸€ä¸ªå·²çŸ¥æœ‰1561ä¸ªåœºæ™¯ï¼ˆ<strong>Images</strong>ï¼‰ï¼Œé‡Œé¢ç¡®å®è—ç€2420ä¸ªâ€œå°å·â€ï¼ˆ<strong>Instances</strong>ï¼‰çš„æµ‹è¯•åœºåœ°ã€‚</li>
</ul>
<h5 data-id="heading-25">4.4.1 IoUï¼ˆäº¤å¹¶æ¯”ï¼‰ - â€œæŠ“å¯¹çš„è¯æ®æ ‡å‡†â€</h5>
<p><strong>é€šä¿—ç†è§£</strong>ï¼šè­¦å¯Ÿç”»äº†ä¸€ä¸ªåœˆè¯´â€œå°å·åœ¨è¿™é‡Œâ€ï¼Œè¿™ä¸ªåœˆå’ŒçœŸå®å°å·æ‰€åœ¨çš„ä½ç½®çš„é‡åˆç¨‹åº¦ã€‚</p>
<ul>
<li><strong>è®¡ç®—</strong>ï¼š<code>äº¤é›†é¢ç§¯ / å¹¶é›†é¢ç§¯</code></li>
<li><strong>æ¯”å–»</strong>ï¼š
<ul>
<li><strong>IoU = 1.0</strong>ï¼šè­¦å¯Ÿç”»çš„åœˆå’Œå°å·çš„çœŸå®ä½ç½®å®Œç¾é‡åˆï¼Œ100%æŠ“å¯¹ã€‚</li>
<li><strong>IoU = 0.5</strong>ï¼šè­¦å¯Ÿç”»çš„åœˆå’Œå°å·çš„ä½ç½®å¤§æ¦‚æœ‰ä¸€åŠé‡åˆã€‚<code>ï¼ˆè¿™æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„â€œåŠæ ¼çº¿â€ï¼‰</code></li>
<li><strong>IoU = 0</strong>ï¼šè­¦å¯Ÿç”»çš„åœˆå’Œå°å·çš„çœŸå®ä½ç½®å®Œå…¨æ²¡æœ‰é‡åˆï¼ŒæŠ“é”™äººäº†ã€‚</li>
</ul>
</li>
</ul>
<p>IoUæ˜¯ä¸€ä¸ªè¡¡é‡â€œå®šä½æ˜¯å¦å‡†ç¡®â€çš„å°ºå­ã€‚</p>
<h5 data-id="heading-26">4.4.2  ç²¾ç¡®ç‡ (Precision)</h5>
<p><strong>é€šä¿—ç†è§£</strong>ï¼š<strong>è­¦å¯ŸæŠ“æ¥çš„äººé‡Œé¢ï¼Œæœ‰å¤šå°‘æ˜¯çœŸæ­£çš„å°å·ã€‚</strong> å®ƒå…³å¿ƒçš„æ˜¯â€œæŠ“äººçš„å‡†ç¡®æ€§â€ã€‚</p>
<ul>
<li><strong>å…¬å¼</strong>ï¼š<code>ç²¾ç¡®ç‡ = æŠ“å¯¹çš„å°å·æ•°é‡ / æ€»å…±æŠ“çš„äººæ•°</code></li>
<li><strong>æ¯”å–»</strong>ï¼š
<ul>
<li>è­¦å¯ŸAä¸€å¤©å†…æŠ“äº†10ä¸ªäººï¼Œç»è¿‡æ ¸å®ï¼Œå…¶ä¸­9ä¸ªæ˜¯çœŸæ­£çš„å°å·ã€‚
<ul>
<li>ç²¾ç¡®ç‡ = 9 / 10 = <strong>90%</strong> ï¼ˆå¾ˆé è°±ï¼Œä»–è¯´è°æ˜¯å°å·ï¼Œè°å¤§æ¦‚ç‡å°±æ˜¯ï¼‰</li>
</ul>
</li>
<li>è­¦å¯ŸBä¸€å¤©å†…æŠ“äº†100ä¸ªäººï¼Œå…¶ä¸­åªæœ‰10ä¸ªæ˜¯çœŸæ­£çš„å°å·ã€‚
<ul>
<li>ç²¾ç¡®ç‡ = 10 / 100 = <strong>10%</strong> ï¼ˆèƒ¡ä¹±æŠ“äººï¼Œå†¤å‡é”™æ¡ˆå¾ˆå¤šï¼‰</li>
</ul>
</li>
</ul>
</li>
</ul>

<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">Box</span>(P): <span class="hljs-number">0.907</span>
</code></pre>
<ul>
<li>è¿™æ„å‘³ç€ä½ çš„æ¨¡å‹æ¯æ ‡è®°å‡º100ä¸ªç›®æ ‡ï¼Œå…¶ä¸­å¤§çº¦æœ‰91ä¸ªæ˜¯çœŸå®å­˜åœ¨çš„ç›®æ ‡ï¼Œå¦å¤–9ä¸ªæ˜¯è¯¯æŠ¥</li>
<li><strong>é«˜ç²¾ç¡®ç‡çš„å¥½å¤„</strong>ï¼šå‡å°‘è™šæƒŠï¼ŒèŠ‚çœå¤æ£€äººåŠ›ã€‚</li>
</ul>
<h5 data-id="heading-27">4.4.3 å¬å›ç‡ (Recall) - â€œå¤©ç½‘æ¢æ¢ï¼Œç–è€Œä¸æ¼â€</h5>
<p><strong>é€šä¿—ç†è§£</strong>ï¼š<strong>æ‰€æœ‰çœŸå®çš„å°å·ä¸­ï¼Œè­¦å¯ŸæŠ“ä½äº†å¤šå°‘ã€‚</strong> å®ƒå…³å¿ƒçš„æ˜¯â€œæŠ“äººçš„å…¨é¢æ€§â€ã€‚</p>
<ul>
<li><strong>å…¬å¼</strong>ï¼š<code>å¬å›ç‡ = æŠ“å¯¹çš„å°å·æ•°é‡ / è¡—ä¸ŠçœŸå®å­˜åœ¨çš„å°å·æ€»æ•°</code></li>
<li><strong>æ¯”å–»</strong>ï¼š
<ul>
<li>è¡—ä¸Šæ€»å…±æœ‰100ä¸ªå°å·ã€‚è­¦å¯ŸAæŠ“ä½äº†å…¶ä¸­çš„85ä¸ªã€‚
<ul>
<li>å¬å›ç‡ = 85 / 100 = <strong>85%</strong> ï¼ˆæ³•ç½‘æ¢æ¢ï¼Œå¤§éƒ¨åˆ†å°å·è½ç½‘ï¼‰</li>
</ul>
</li>
<li>è­¦å¯ŸBåªæŠ“ä½äº†å…¶ä¸­çš„5ä¸ªã€‚
<ul>
<li>å¬å›ç‡ = 5 / 100 = <strong>5%</strong> ï¼ˆå¤§éƒ¨åˆ†å°å·é€é¥æ³•å¤–ï¼‰</li>
</ul>
</li>
</ul>
</li>
</ul>

<pre><code class="hljs language-scss" lang="scss"><span class="hljs-built_in">Box</span>(R): <span class="hljs-number">0.831</span>
</code></pre>
<ul>
<li>è¿™æ„å‘³ç€åœ¨æ‰€æœ‰2420ä¸ªçœŸå®ç›®æ ‡ä¸­ï¼Œä½ çš„æ¨¡å‹æˆåŠŸæ£€æµ‹å‡ºäº†å¤§çº¦83%ã€‚å‰©ä¸‹çš„17%æ˜¯æ¼æ£€ï¼ˆæ¨¡å‹æ²¡å‘ç°ï¼Œä½†å®é™…å­˜åœ¨çš„ç›®æ ‡å¯¹è±¡ï¼‰ã€‚</li>
<li><strong>é«˜å¬å›ç‡çš„å¥½å¤„</strong>ï¼šå‡å°‘æ¼ç½‘ä¹‹é±¼ï¼Œé™ä½é£é™©ã€‚</li>
</ul>
<h5 data-id="heading-28">4.4.4  mAP50- â€œç»¼åˆè€ƒè¯„ï¼ˆå®½æ¾ç‰ˆï¼‰â€</h5>
<p><strong>é€šä¿—ç†è§£</strong>ï¼šåœ¨â€œIoUé—¨æ§›è®¾ä¸º50%â€è¿™ä¸ª<strong>å®½æ¾æ ‡å‡†</strong>ä¸‹ï¼Œå¯¹æ¨¡å‹æ€§èƒ½çš„ä¸€ä¸ª<strong>ç»¼åˆæ‰“åˆ†</strong>ã€‚</p>
<ul>
<li><strong>meanï¼ˆå¹³å‡ï¼‰</strong>ï¼šå¯¹æ‰€æœ‰ç±»åˆ«çš„æ€§èƒ½å–å¹³å‡ã€‚</li>
<li><strong>Average Precisionï¼ˆå¹³å‡ç²¾åº¦ï¼‰</strong>ï¼šç»¼åˆäº†ä¸åŒç½®ä¿¡åº¦é˜ˆå€¼ä¸‹çš„ç²¾ç¡®ç‡å’Œå¬å›ç‡ï¼Œè®¡ç®—å‡ºçš„ä¸€ä¸ªå•ä¸€ã€ç¨³å¥çš„æŒ‡æ ‡ã€‚</li>
<li><strong>50</strong>ï¼šåªè¦è­¦å¯Ÿç”»çš„åœˆå’Œå°å·ä½ç½®æœ‰è¶…è¿‡50%çš„é‡åˆï¼ˆIoU &gt; 0.5ï¼‰ï¼Œå°±ç®—ä»–æŠ“å¯¹äº†ã€‚</li>
</ul>

<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">mAP50: 0.913</span>
</code></pre>
<ul>
<li>æ„æ€æ˜¯ï¼šåœ¨â€œå®šä½åªè¦å¤§è‡´å‡†ç¡®å°±è¡Œâ€çš„æ ‡å‡†ä¸‹ï¼Œä½ çš„æ¨¡å‹ç»¼åˆæ€§èƒ½å¾—åˆ†æ˜¯91.3åˆ†ï¼ˆç™¾åˆ†åˆ¶ï¼‰ã€‚è¯´æ˜å®ƒæ—¢èƒ½å‡†ç¡®åœ°æ‰¾åˆ°ç›®æ ‡ï¼Œåˆèƒ½å¾ˆå¥½åœ°è¯†åˆ«å‡ºç›®æ ‡çš„ç±»åˆ«ã€‚</li>
</ul>
<h5 data-id="heading-29">4.4.5 mAP50-95- â€œç»¼åˆè€ƒè¯„ï¼ˆä¸¥æ ¼ç‰ˆï¼‰â€</h5>
<p><strong>é€šä¿—ç†è§£</strong>ï¼šåœ¨â€œIoUé—¨æ§›ä»50%é€æ­¥æå‡åˆ°95%â€çš„<strong>ä¸€ç³»åˆ—ä¸¥æ ¼æ ‡å‡†</strong>ä¸‹ï¼Œå¯¹æ¨¡å‹æ€§èƒ½çš„<strong>ç»¼åˆæ‰“åˆ†</strong>ã€‚</p>
<ul>
<li>å®ƒä¸å†æ˜¯å•ä¸€æ ‡å‡†ï¼Œè€Œæ˜¯ä»â€œå¤§è‡´æ¡†å¯¹â€ï¼ˆIoU=0.5ï¼‰åˆ°â€œå‡ ä¹å®Œç¾æ¡†å¯¹â€ï¼ˆIoU=0.95ï¼‰å…±10ä¸ªä¸åŒé—¨æ§›ä¸‹ï¼Œåˆ†åˆ«è®¡ç®—mAPï¼Œç„¶åå–å¹³å‡å€¼ã€‚</li>
<li>è¿™ä¸ªæŒ‡æ ‡<strong>åŒæ—¶è€ƒéªŒ</strong>æ¨¡å‹çš„â€œåˆ†ç±»èƒ½åŠ›â€å’Œâ€œå®šä½ç²¾å‡†åº¦â€ã€‚</li>
</ul>

<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">mAP50-95: 0.619</span>
</code></pre>
<ul>
<li>è¿™ä¸ªåˆ†æ•°æ¯”mAP50ä½æ˜¯<strong>å®Œå…¨æ­£å¸¸ä¸”é¢„æœŸä¹‹å†…</strong>çš„ï¼Œå› ä¸ºæ ‡å‡†ä¸¥è‹›å¾—å¤šã€‚</li>
<li>61.9%çš„åˆ†æ•°è¡¨æ˜ï¼šå½“è¦æ±‚æ¨¡å‹å¿…é¡»ç”¨éå¸¸ç²¾ç¡®çš„æ¡†æ¥åŒ…å›´ç›®æ ‡æ—¶ï¼Œå®ƒçš„æ€§èƒ½ä¼šä¸‹é™ã€‚ä½†å®ƒä¾ç„¶æ˜¯ä¸€ä¸ªå¯ä»¥æ¥å—çš„æˆç»©ï¼Œè¯´æ˜æ¨¡å‹çš„å®šä½èƒ½åŠ›è¿˜ç®—ä¸é”™ã€‚</li>
</ul>
<h5 data-id="heading-30">4.4.6 å…³é”®å›¾è¡¨è§£è¯»</h5>
<p>æ‡‚äº†ä¸Šé¢çš„è¿™äº›å†…å®¹ï¼Œç›¸ä¿¡ä½ å†æ¥çœ‹ä¸‹é¢çš„è¿™äº›è®­ç»ƒç»“æœå›¾è¡¨å°±æ˜¯è½»è€Œæ˜“ä¸¾äº†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2356d5eb2c9446318a8a9ee8687cefd7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=pPxnWP6GaN1DSZH3cUwntdNk%2BoQ%3D" alt="b4.png" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥ä»‹ç»ä¸‹é¢çš„å›¾è¡¨ï¼Œè¿™å››ä¸ªå›¾è¡¨æ˜¯å¸®ä½ åœ¨æ¨¡å‹æ¨ç†æ—¶è°ƒå‚çš„é‡è¦å·¥å…·ï¼å®ƒä»¬èƒ½å¸®ä½ æ·±å…¥æ´å¯Ÿæ¨¡å‹åœ¨ä¸åŒâ€œè‡ªä¿¡åº¦â€ä¸‹çš„è¡¨ç°ï¼Œä»è€Œæ‰¾åˆ°é‚£ä¸ªæœ€ä½³çš„ç½®ä¿¡åº¦é˜ˆå€¼ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a3ebbc59e9542bf98d30033a8d9c085~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTmFycmFzdG9yeQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766296395&amp;x-signature=41C%2BKr2FHsi0OoWNUu%2FWumADUqo%3D" alt="b3.jpg" loading="lazy"/></p>
<p>è¦æƒ³çœ‹æ‡‚ä¸Šé¢çš„å›¾è¡¨ï¼Œå°±è¦çŸ¥é“ä»€ä¹ˆæ˜¯ç½®ä¿¡åº¦ï¼Ÿæƒ³è±¡ä¸€ä¸‹ï¼Œå½“æ¨¡å‹åœ¨å›¾ç‰‡ä¸­æ¡†å‡ºä¸€ä¸ªç›®æ ‡æ—¶ï¼Œæ¯ä¸ªè¾¹æ¡†ä¸Šæ–¹æ˜¾ç¤ºçš„æ•°å­—ï¼ˆä¾‹å¦‚â€œ0.86â€ï¼‰å°±æ˜¯å®ƒçš„<strong>ç½®ä¿¡åº¦</strong>ã€‚è¿™ä¸ªåˆ†æ•°ä»£è¡¨äº†æ¨¡å‹å¯¹è¿™ä¸ªé¢„æµ‹ç»“æœçš„â€œè‡ªä¿¡ç¨‹åº¦â€â€”â€”æ¯”å¦‚0.86å°±æ„å‘³ç€æ¨¡å‹æœ‰86%çš„æŠŠæ¡è®¤ä¸ºå®ƒæ¡†ä¸­çš„ç¡®å®æ˜¯ä½ æŒ‡å®šçš„ç›®æ ‡ï¼ˆå¦‚â€œè¡Œäººâ€æˆ–â€œæ±½è½¦â€ï¼‰ã€‚</p>
<p>åœ¨å®é™…æ¨ç†æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>conf</code> å‚æ•°æ¥çµæ´»è°ƒæ•´è¿™ä¸ªâ€œè‡ªä¿¡é—¨æ§›â€ã€‚ä¾‹å¦‚ï¼Œè®¾å®š <code>conf=0.5</code>ï¼Œå°±ç­‰äºå‘Šè¯‰æ¨¡å‹ï¼šâ€œåªæœ‰å½“ä½ è§‰å¾—è‡ªå·±æœ‰50%ä»¥ä¸Šçš„æŠŠæ¡æ—¶ï¼Œæ‰æŠŠç›®æ ‡æ¡†å‡ºæ¥ï¼›ä½äºè¿™ä¸ªä¿¡å¿ƒçš„ï¼Œå°±ç›´æ¥å¿½ç•¥æ‰ã€‚â€ è¿™ä¸ªé˜ˆå€¼æ˜¯ä½ å¹³è¡¡æ£€æµ‹â€œæ¼æŠ¥â€ä¸â€œè¯¯æŠ¥â€çš„é‡è¦æ æ†ã€‚</p>
<ol>
<li><strong>F1-Confidence Curve (F1-ç½®ä¿¡åº¦æ›²çº¿)</strong>
F1åˆ†æ•°æ˜¯ç²¾ç¡®ç‡å’Œå¬å›ç‡çš„<strong>è°ƒå’Œå¹³å‡æ•°</strong>ï¼Œæ˜¯è¡¡é‡æ¨¡å‹ç»¼åˆæ€§èƒ½çš„â€œå•ç§‘æ€»åˆ†â€ã€‚è¿™æ¡æ›²çº¿å±•ç¤ºäº†åœ¨ä¸åŒç½®ä¿¡åº¦é˜ˆå€¼ä¸‹ï¼ŒF1åˆ†æ•°çš„å˜åŒ–æƒ…å†µã€‚<strong>ä½ çš„ç›®æ ‡å°±æ˜¯æ‰¾åˆ°è¿™æ¡æ›²çº¿çš„æœ€é«˜ç‚¹</strong>ï¼Œè¿™ä¸ªç‚¹å¯¹åº”çš„ç½®ä¿¡åº¦é˜ˆå€¼ï¼Œé€šå¸¸å°±æ˜¯ç²¾ç¡®ç‡å’Œå¬å›ç‡è¾¾åˆ°æœ€ä½³å¹³è¡¡çš„â€œç”œèœœç‚¹â€ã€‚</li>
<li><strong>Precision-Confidence Curve (ç²¾ç¡®ç‡-ç½®ä¿¡åº¦æ›²çº¿)</strong>
ç²¾ç¡®ç‡è¡¡é‡çš„æ˜¯â€œæ¨¡å‹è¯´å¯¹äº†å—â€ã€‚å®ƒå›ç­”çš„æ˜¯ï¼šåœ¨æ‰€æœ‰è¢«æ¨¡å‹æ¡†å‡ºæ¥çš„ç›®æ ‡ä¸­ï¼Œåˆ°åº•æœ‰å¤šå°‘æ˜¯çœŸæ­£çš„ç›®æ ‡ï¼Ÿå½“ç½®ä¿¡åº¦é˜ˆå€¼æé«˜æ—¶ï¼Œæ¨¡å‹ä¼šå˜å¾—è¶Šæ¥è¶Šâ€œä¿å®ˆâ€ï¼Œåªè¾“å‡ºå®ƒæœ€ç¡®ä¿¡çš„ç»“æœï¼Œå› æ­¤<strong>ç²¾ç¡®ç‡é€šå¸¸ä¼šéšä¹‹å‡é«˜</strong>ï¼ˆå› ä¸ºè¯¯æŠ¥å‡å°‘äº†ï¼‰ã€‚å¦‚æœè¿™æ¡æ›²çº¿æ•´ä½“åä½ï¼Œè¯´æ˜æ¨¡å‹å­˜åœ¨è¾ƒå¤šçš„è¯¯æ£€ã€‚</li>
<li><strong>Recall-Confidence Curve (å¬å›ç‡-ç½®ä¿¡åº¦æ›²çº¿)</strong>
å¬å›ç‡è¡¡é‡çš„æ˜¯â€œæ¨¡å‹æ‰¾å…¨äº†å—â€ã€‚å®ƒå›ç­”çš„æ˜¯ï¼šæ‰€æœ‰çœŸå®å­˜åœ¨çš„ç›®æ ‡ä¸­ï¼Œæ¨¡å‹æˆåŠŸæ‰¾å‡ºäº†å¤šå°‘ï¼Ÿå½“ç½®ä¿¡åº¦é˜ˆå€¼æé«˜æ—¶ï¼Œæ¨¡å‹å¯èƒ½ä¼šå› ä¸ºâ€œè¿‡äºä¿å®ˆâ€è€Œæ¼æ‰ä¸€äº›ä¸å¤ªç¡®å®šä½†çœŸå®çš„ç›®æ ‡ï¼Œå› æ­¤<strong>å¬å›ç‡é€šå¸¸ä¼šéšä¹‹ä¸‹é™</strong>ã€‚å¦‚æœè¿™æ¡æ›²çº¿ä¸‹é™å¾—è¿‡å¿«ï¼Œè¯´æ˜æ¨¡å‹å¤ªå®¹æ˜“â€œæ”¾å¼ƒâ€çœŸå®ç›®æ ‡äº†ã€‚</li>
<li><strong>Precision-Recall Curve (ç²¾ç¡®ç‡-å¬å›ç‡æ›²çº¿)</strong>
è¿™ä¸ªå›¾è¡¨å±•ç¤ºäº†<strong>å‡†</strong>å’Œ<strong>å…¨</strong>çš„æƒè¡¡å…³ç³»ï¼Œæ›²çº¿è¶Šå¾€å³ä¸Šè§’é ï¼ˆè¡¨æ˜æ—¢å‡†åˆå…¨ï¼‰ï¼Œé‚£ä¹ˆè¡¨ç¤ºæ¨¡å‹æ•´ä½“æ€§èƒ½è¶Šå¥½ã€‚</li>
</ol>
<p><strong>ç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥è¿™æ ·ç»¼åˆè¿ç”¨å®ƒä»¬ï¼š</strong> é¦–å…ˆåœ¨ <strong>F1æ›²çº¿</strong> ä¸Šæ‰¾åˆ°æœ€é«˜ç‚¹ï¼Œç¡®å®šä¸€ä¸ªå¤‡é€‰çš„ç½®ä¿¡åº¦é˜ˆå€¼ã€‚ç„¶åï¼Œè§‚å¯Ÿåœ¨æ­¤é˜ˆå€¼ä¸‹ï¼Œ<strong>ç²¾ç¡®ç‡æ›²çº¿</strong>å’Œ<strong>å¬å›ç‡æ›²çº¿</strong>çš„æ•°å€¼æ˜¯å¦éƒ½å¤„äºä½ èƒ½æ¥å—çš„èŒƒå›´å†…ã€‚é€šè¿‡è¿™æ ·çš„åˆ†æï¼Œä½ å°±èƒ½ç§‘å­¦åœ°è®¾ç½® <code>conf</code> å‚æ•°ï¼Œè®©æ¨¡å‹åœ¨â€œä¸é”™æ€ªä¸€ä¸ªå¥½äººâ€å’Œâ€œä¸æ”¾è¿‡ä¸€ä¸ªåäººâ€ä¹‹é—´å–å¾—æœ€ä½³å¹³è¡¡ã€‚</p>
<h4 data-id="heading-31">4.5 æ¨¡å‹æ¨ç†</h4>
<p>å¦‚ä½•ä½¿ç”¨ä½ è®­ç»ƒå¥½çš„æ¨¡å‹å‘¢ï¼ŒYOLOv11çš„æ¨ç†è¿‡ç¨‹è®¾è®¡å¾—éå¸¸äººæ€§åŒ–ï¼Œä¸åˆ†ç±»ä»»åŠ¡çš„æµç¨‹åŸºæœ¬ä¸€è‡´ã€‚å¦‚æœä½ è¿˜è®°å¾—åˆ†ç±»ç« èŠ‚ä¸­çš„å‚æ•°é…ç½®è¡¨æ ¼ï¼Œå¾ˆå¤šå‚æ•°åœ¨è¿™é‡Œéƒ½èƒ½é€šç”¨ã€‚</p>
<p>ä¸‹é¢è¿™æ®µç®€æ´çš„ä»£ç å°±èƒ½è®©ä½ åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹å¹¶è¿›è¡Œé¢„æµ‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> ultralytics <span class="hljs-keyword">import</span> YOLO

model = YOLO(<span class="hljs-string">"../detection_results/train/weights/best.pt"</span>) <span class="hljs-comment">#åŠ è½½ä¸€ä¸ªæœ¬åœ°è®­ç»ƒå¥½çš„æ¨¡å‹</span>
source = <span class="hljs-string">"./324.jpg"</span>    <span class="hljs-comment"># æµ‹è¯•ä¸€å¼ å›¾ç‰‡</span>
results = model.predict(
    source,
    imgsz=<span class="hljs-number">720</span>,
    conf = <span class="hljs-number">0.5</span>,	<span class="hljs-comment"># ç½®ä¿¡åº¦è®¾ç½®ï¼Œåªæ˜¾ç¤ºæŠŠæ¡å¤§äº50%çš„æ£€æµ‹ç»“æœ</span>
)
</code></pre>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æå–å¹¶åˆ†æç¬¬ä¸€ä¸ªæ£€æµ‹ç»“æœï¼ˆå› ä¸ºå¯èƒ½æœ‰å¤šå¼ å›¾ç‰‡ï¼Œè¿™é‡Œå–ç¬¬ä¸€å¼ ï¼‰</span>
result = results[<span class="hljs-number">0</span>].cpu()

<span class="hljs-built_in">print</span>(<span class="hljs-string">"æ£€æµ‹åˆ°çš„ç›®æ ‡ç±»åˆ«:"</span>, result.boxes.cls)    <span class="hljs-comment"># ç±»åˆ«IDï¼Œæ•°ç»„é•¿åº¦å°±æ˜¯ç›®æ ‡ä¸ªæ•°</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"å„ç›®æ ‡çš„ç½®ä¿¡åº¦:"</span>, result.boxes.conf)     <span class="hljs-comment"># æ¨¡å‹å¯¹æ¯ä¸ªæ£€æµ‹ç»“æœçš„æŠŠæ¡ç¨‹åº¦</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"å½’ä¸€åŒ–ä½ç½®ä¿¡æ¯:"</span>, result.boxes.xywhn)   <span class="hljs-comment"># æ ¼å¼ï¼š[xä¸­å¿ƒ, yä¸­å¿ƒ, å®½åº¦, é«˜åº¦]ï¼ˆå½’ä¸€åŒ–åˆ°0-1ï¼‰</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"åŸå§‹ä½ç½®ä¿¡æ¯:"</span>, result.boxes.xywh)      <span class="hljs-comment"># æ ¼å¼ï¼š[xä¸­å¿ƒ, yä¸­å¿ƒ, å®½åº¦, é«˜åº¦]ï¼ˆåŸå§‹åƒç´ åæ ‡ï¼‰</span>

<span class="hljs-comment"># å®é™…è¾“å‡ºç¤ºä¾‹ï¼š</span>
<span class="hljs-comment"># æ£€æµ‹åˆ°çš„ç›®æ ‡ç±»åˆ«: tensor([1., 1.])          â†’ æ£€æµ‹åˆ°2ä¸ªç›®æ ‡ï¼Œéƒ½æ˜¯ç±»åˆ«1</span>
<span class="hljs-comment"># å„ç›®æ ‡çš„ç½®ä¿¡åº¦: tensor([0.8580, 0.8501])    â†’ ç¬¬ä¸€ä¸ªç›®æ ‡ç½®ä¿¡åº¦85.8%ï¼Œç¬¬äºŒä¸ª85.0%</span>
<span class="hljs-comment"># å½’ä¸€åŒ–ä½ç½®ä¿¡æ¯: tensor([[0.6452, 0.5798, 0.1171, 0.3129],  â†’ ç¬¬ä¸€ä¸ªç›®æ ‡åœ¨å›¾åƒä¸­çš„ç›¸å¯¹ä½ç½®</span>
<span class="hljs-comment">#                        [0.2688, 0.5362, 0.0881, 0.3594]]) â†’ ç¬¬äºŒä¸ªç›®æ ‡åœ¨å›¾åƒä¸­çš„ç›¸å¯¹ä½ç½®</span>
<span class="hljs-comment"># åŸå§‹ä½ç½®ä¿¡æ¯: tensor([[709.7494, 406.4641, 128.8472, 219.3187],  â†’ ç¬¬ä¸€ä¸ªç›®æ ‡çš„åƒç´ åæ ‡</span>
<span class="hljs-comment">#                      [295.6964, 375.8881,  96.9277, 251.9450]]) â†’ ç¬¬äºŒä¸ªç›®æ ‡çš„åƒç´ åæ ‡</span>
</code></pre>
<p>é™¤äº†ç›´æ¥æŸ¥çœ‹æ•°æ®ï¼ŒYOLOv11è¿˜æä¾›äº†ä¾¿æ·çš„å¯è§†åŒ–åŠŸèƒ½ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ–¹æ³•ä¸€ï¼šç›´æ¥æ˜¾ç¤ºå¸¦æ£€æµ‹æ¡†çš„å›¾ç‰‡</span>
results[<span class="hljs-number">0</span>].show()

<span class="hljs-comment"># æ–¹æ³•äºŒï¼šä¿å­˜å¯è§†åŒ–ç»“æœ</span>
results[<span class="hljs-number">0</span>].save(save_dir=<span class="hljs-string">"./detection_results/"</span>)

<span class="hljs-comment"># æ–¹æ³•ä¸‰ï¼šè·å–ç»˜åˆ¶å¥½çš„å›¾åƒæ•°ç»„ï¼Œç”¨äºåç»­å¤„ç†</span>
plotted_image = results[<span class="hljs-number">0</span>].plot()

...
</code></pre>
<h3 data-id="heading-32">äº”. ç»“è¯­</h3>
<p>è¯»åˆ°æ­¤å¤„ï¼Œç›¸ä¿¡ä½ å·²ç»è·Ÿéšæœ¬æ•™ç¨‹ä¸€æ­¥æ­¥å®Œæˆäº†ä»ç¯å¢ƒé…ç½®åˆ°æ¨¡å‹è®­ç»ƒã€ç»“æœè§£è¯»çš„å…¨è¿‡ç¨‹ã€‚åœ¨ç»“æŸè¿™ç¯‡YOLOâ€œä¿å§†çº§â€æ•™ç¨‹ä¹‹å‰ï¼Œæˆ‘æƒ³ä¸ä½ åˆ†äº«ä¸€äº›è¶…è¶Šä»£ç å·¥å…·æœ¬èº«çš„å­¦ä¹ æ„Ÿæ‚Ÿâ€”â€”è¿™äº›æˆ–è®¸æ¯”æŸä¸ªå…·ä½“å‚æ•°å¦‚ä½•è®¾ç½®æ›´ä¸ºé‡è¦ã€‚</p>
<p>å›é¡¾æˆ‘çš„å­¦ä¹ å†ç¨‹ï¼Œæ›¾å‡ ä½•æ—¶ï¼Œæˆ‘ä¹Ÿæ›¾çº ç»“äºæ˜¯å¦è¦â€œç²¾é€šâ€æŸé—¨è¯­è¨€ï¼Œæˆ–æ‹…å¿ƒé”™è¿‡æŸä¸ªçƒ­é—¨æ¡†æ¶ã€‚ä½†ä»£ç å†™å¾—è¶Šå¤šï¼Œè¶Šæ¸…æ™°åœ°æ„è¯†åˆ°ï¼šç¨‹åºå‘˜çš„çœŸæ­£æ ¸å¿ƒç«äº‰åŠ›ï¼Œ<strong>å¹¶éä½“ç°åœ¨å¯¹æŸé—¨è¯­è¨€æˆ–æ¡†æ¶çš„ç†Ÿæ‚‰ç¨‹åº¦ä¸Šï¼Œè€Œåœ¨äºè¿ç”¨æŠ€æœ¯è§£å†³å®é™…é—®é¢˜çš„èƒ½åŠ›</strong>ã€‚è®¡ç®—æœºä¸–ç•Œæ—¥æ–°æœˆå¼‚ï¼Œä»Šå¤©æµè¡Œçš„æ¡†æ¶å¯èƒ½æ˜å¹´å°±ä¼šè¿‡æ—¶ï¼Œæ–°çš„è¯­è¨€äº¦ä¼šå±‚å‡ºä¸ç©·ã€‚å”¯æœ‰ä¿æŒæŒç»­å­¦ä¹ çš„çŠ¶æ€ï¼Œæ‰èƒ½åœ¨æŠ€æœ¯çš„æµªæ½®ä¸­å§‹ç»ˆæ‹¥æœ‰ç«‹èº«ä¹‹æœ¬ã€‚å½“ä½ é‡åˆ°æ–°çš„åœºæ™¯ï¼Œéœ€è¦æ–°çš„å·¥å…·æ—¶ï¼Œè‡ªç„¶å°±èƒ½å­¦ä¼šæ–°çš„è¯­è¨€â€”â€”<strong>ä½ ç¼ºçš„ä»æ¥ä¸æ˜¯å­¦ä¹ èƒ½åŠ›ï¼Œè€Œæ˜¯é‚£ä¸ªé©±åŠ¨ä½ å­¦ä¹ çš„çœŸå®é—®é¢˜ã€‚</strong></p>
<p>å…¶æ¬¡ï¼Œåœ¨å­¦ä¹ è¿™äº›å¼ºå¤§çš„å·¥å…·åº“ï¼ˆå¦‚ SciPyã€scikit-learnã€Pytorchä¹ƒè‡³æˆ‘ä»¬æœ¬æ–‡çš„ YOLOï¼‰æ—¶ï¼Œä¸€ä¸ªé«˜æ•ˆçš„ç­–ç•¥æ˜¯ <strong>â€œæŒ‰éœ€æ‰€å­¦ï¼Œè€Œéç³»ç»Ÿé€šè¯»â€</strong> ã€‚è¯•å›¾ä¸€å¼€å§‹å°±ç³»ç»Ÿæ€§åœ°æŒæ¡ä¸€ä¸ªåºå¤§åº“çš„æ‰€æœ‰å†…å®¹ï¼Œå¾ˆå®¹æ˜“é™·å…¥å¤§é‡ä¸“ä¸šæœ¯è¯­çš„æ³¥æ½­ã€‚æ›´å¥½çš„æ–¹å¼æ˜¯ï¼Œåœ¨å…·ä½“é¡¹ç›®ä¸­é‡åˆ°ä»€ä¹ˆéœ€æ±‚ï¼Œå†å»æ·±å…¥å­¦ä¹ è¯¥åº“å¯¹åº”çš„æ¨¡å—ã€‚è¿™èƒ½è®©ä½ å§‹ç»ˆä¿æŒç›®æ ‡æ¸…æ™°ï¼Œç†è§£ä¹Ÿæ›´ä¸ºæ·±åˆ»ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™å¹¶éå¦å®šæ‰“å¥½åŸºç¡€çš„é‡è¦æ€§ã€‚åƒ Pythonã€NumPy è¿™ç±»æ„æˆç”Ÿæ€åŸºçŸ³çš„åº“ï¼Œå°±å¿…é¡»ç³»ç»Ÿåœ°å­¦ä¹ â€”â€”å®ƒä»¬æ˜¯ä½ èƒ½å¿«é€Ÿâ€œæŒ‰éœ€æ‰€å­¦â€å…¶ä»–å·¥å…·çš„å‰æã€‚</p>
<p>æœ€åï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€ç‚¹ï¼š<strong>åœ¨ç”¨ä¸­å­¦</strong>ã€‚ç¼–ç¨‹å¦‚åŒæ¸¸æ³³ï¼Œçœ‹å†å¤šçš„æ•™ç¨‹ä¹Ÿæ— æ³•æ›¿ä»£ä½ äº²è‡ªè·³å…¥æ°´ä¸­ã€‚åªçœ‹ä¸ç»ƒï¼Œå¦‚åŒçº¸ä¸Šè°ˆå…µï¼ŒçŸ¥è¯†æ°¸è¿œæ— æ³•å†…åŒ–ä¸ºä½ è§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚ä¸è¦æ‹…å¿ƒè‡ªå·±æ‡‚çš„ä¸å¤Ÿå¤šï¼ŒçœŸæ­£çš„æŒæ¡ï¼Œå§‹äºä½ åŠ¨æ‰‹è®©ç¬¬ä¸€è¡Œä»£ç è¿è¡Œèµ·æ¥ï¼Œå¹¶åœ¨è§£å†³ä¸€ä¸ªåˆä¸€ä¸ªbugå’Œéœ€æ±‚çš„è¿‡ç¨‹ä¸­ï¼Œå°†çŸ¥è¯†å½»åº•æ¶ˆåŒ–ã€‚</p>
<p><strong>è¯­è¨€åªæ˜¯å·¥å…·ï¼Œä¸æ˜¯ç›®çš„ï¼›ä»£ç åªæ˜¯æ‰‹æ®µï¼Œè€Œéç»ˆç‚¹ã€‚</strong> çœŸæ­£æœ‰ä»·å€¼çš„ï¼Œæ°¸è¿œæ˜¯ä½ è¿ç”¨å·¥å…·å»è§£å†³çœŸå®é—®é¢˜çš„æ€ç»´ã€è§†é‡ä¸åˆ›é€ åŠ›â€”â€”è€Œè¿™ï¼Œæ˜¯ä»»ä½•æŠ€æœ¯æ›´æ–°éƒ½æ— æ³•å–ä»£çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¼ä¸šçº§AI Agentæœ¬åœ°åŒ–éƒ¨ç½²å®æˆ˜ï¼šåŸºäºè®¯é£æ˜Ÿè¾°ä¸Astronçš„å®æˆ˜è¯¦è§£ï¼ˆé™„é¿å‘æ¸…å•ï¼‰]]></title>    <link>https://juejin.cn/post/7583324039302086707</link>    <guid>https://juejin.cn/post/7583324039302086707</guid>    <pubDate>2025-12-14T06:21:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583324039302086707" data-draft-id="7583293030172737582" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¼ä¸šçº§AI Agentæœ¬åœ°åŒ–éƒ¨ç½²å®æˆ˜ï¼šåŸºäºè®¯é£æ˜Ÿè¾°ä¸Astronçš„å®æˆ˜è¯¦è§£ï¼ˆé™„é¿å‘æ¸…å•ï¼‰"/> <meta itemprop="keywords" content="Agent,AIGC"/> <meta itemprop="datePublished" content="2025-12-14T06:21:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="niaonao"/> <meta itemprop="url" content="https://juejin.cn/user/3878732751729198"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¼ä¸šçº§AI Agentæœ¬åœ°åŒ–éƒ¨ç½²å®æˆ˜ï¼šåŸºäºè®¯é£æ˜Ÿè¾°ä¸Astronçš„å®æˆ˜è¯¦è§£ï¼ˆé™„é¿å‘æ¸…å•ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3878732751729198/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    niaonao
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:21:28.000Z" title="Sun Dec 14 2025 06:21:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1ã€è®¯é£æ˜Ÿè¾°Agentå¼€å‘å¹³å°ä¸Astronä»‹ç»</h2>
<p>å¦‚å·²äº†è§£Astronå’Œæ˜Ÿè¾°Agentï¼Œå¯è·³è¿‡å‰è¨€çœ‹Astronå®‰è£…éƒ¨ç½²å†…å®¹</p>
<h3 data-id="heading-1">1.1 è®¯é£æ˜Ÿè¾°Agentå¹³å°</h3>
<p>è®¯é£æ˜Ÿè¾°Agentå¹³å°æ˜¯ç§‘å¤§è®¯é£è‡ªç ”ï¼Œé¢å‘å›½å†…çš„ä¼ä¸šçº§Agentå¼€å‘å¹³å°ã€‚ä½“éªŒåœ°å€ä¸º<a href="https://link.juejin.cn?target=https%3A%2F%2Fagent.xfyun.cn%2F" target="_blank" title="https://agent.xfyun.cn/" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fagent.xfyun.cn%2F" target="_blank" title="https://agent.xfyun.cn/" ref="nofollow noopener noreferrer">agent.xfyun.cn/</a></p>
<p>è´¯é€šåŠŸèƒ½å¼€å‘-å·¥ç¨‹åŒ–è½åœ°-ä¼ä¸šåº”ç”¨-æ•°æ®é—­ç¯ï¼Œæ”¯æŒæ·±åº¦å®šåˆ¶å¼€å‘ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc89bbae397f4d7d9bbd6bb403f930f5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=pSlgVG8zVjQA0mY%2FmBS4CiBb%2BIM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-2">1.2 Astron</h3>
<p>Astron æ˜¯ç§‘å¤§è®¯é£æ¨å‡ºçš„ä¸€æ¬¾å¼€æºå…±å»ºæ™ºèƒ½ä½“å¹³å°ã€‚</p>
<p>èåˆäº† AI å·¥ä½œæµç¼–æ’ã€æ¨¡å‹ç®¡ç†ã€AI ä¸ MCP å·¥å…·é›†ã€RPA è‡ªåŠ¨åŒ–å’Œå›¢é˜Ÿç©ºé—´ç­‰ç‰¹æ€§ã€‚</p>
<p>ä¼ä¸šçº§Agentå¹³å°ã€å•†ç”¨å‹å¥½ã€æ”¯æŒé«˜å¯ç”¨éƒ¨ç½²ã€‚å¯å¸®åŠ©ä¼ä¸šå¿«é€Ÿæ„å»ºå¯è§„æ¨¡åŒ–è½åœ°çš„æ™ºèƒ½ä½“åº”ç”¨ï¼Œæ‰“é€ é¢å‘æœªæ¥çš„ AI åŸºåº§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a2f57191b844809a666a9ee45307c80~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=k0i0DBkpsBYFJf8ivae0nsH%2Fp0Y%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-3">1.3 Astronä¸æ˜Ÿè¾°Agentå¯¹æ¯”</h3>
<p>åšä¸»ä¸ªäººç†è§£ Astron å°±æ˜¯â€œå¼€æºç‰ˆæ˜Ÿè¾° Agentâ€ï¼Œéƒ½æ˜¯ä¸€ä¸ªå¸ˆå‚…æ•™çš„ï¼Œç ´ä¸äº†æ‹›å•Šã€‚Astroné¢å‘å¼€æºç¤¾åŒºï¼Œæ˜Ÿè¾°Agenté¢å‘å•†ä¸šäº¤ä»˜ã€‚</p>








































<table><thead><tr><th align="left"/><th align="left">Astronï¼ˆå¼€æºï¼‰</th><th align="left">è®¯é£æ˜Ÿè¾° Agentï¼ˆå•†ä¸šï¼‰</th></tr></thead><tbody><tr><td align="left">å®šä½</td><td align="left">ç¤¾åŒºç‰ˆæ™ºèƒ½ä½“å¼•æ“ï¼Œé™ä½é—¨æ§›ã€å¸å¼•ç”Ÿæ€</td><td align="left">ä¼ä¸šçº§å¹³å°ï¼Œè§„æ¨¡åŒ–è½åœ°ä¸å•†ä¸šäº¤ä»˜</td></tr><tr><td align="left">ä»£ç  &amp; åè®®</td><td align="left">Apache 2.0 å®Œå…¨å¼€æºï¼Œå¯å•†ç”¨ã€å¯äºŒæ¬¡å¼€å‘</td><td align="left">æ ¸å¿ƒåŒæºï¼Œä½†äº‘ç«¯å¢å€¼æœåŠ¡é—­æº</td></tr><tr><td align="left">åŠŸèƒ½å®Œæ•´æ€§</td><td align="left">å·¥ä½œæµã€RPAã€å¤šæ¨¡å‹ã€æµ‹è¯„å·¥å…·é“¾å…¨éƒ¨ç»™å‡ºï¼›ä¸é€ GPU/é›†ç¾¤è¿ç»´</td><td align="left">é¢å¤–æä¾›é«˜å¯ç”¨é›†ç¾¤ã€ç§æœ‰åŒ–çŸ¥è¯†åº“ã€æ‰˜ç®¡ GPUã€SLA ä¿éšœ</td></tr><tr><td align="left">ç”Ÿæ€ä¸å·¥å…·</td><td align="left">å†…ç½® 50+ å†…ç½®æ¨¡å‹ã€870+ AI èƒ½åŠ›ã€1.6 ä¸‡ MCP Serverï¼Œå¯æ’ç¤¾åŒºæ¨¡å‹</td><td align="left">åŒåº“åŒèƒ½åŠ›ï¼Œä¸”æŒç»­ä¼˜å…ˆæ¨é€æ–°æ¨¡å‹ã€è¡Œä¸šæ’ä»¶</td></tr><tr><td align="left">äº¤äº’ä½“éªŒ</td><td align="left">æ”¯æŒè™šæ‹Ÿäººã€å£°éŸ³å¤åˆ»ã€è§’è‰²æ‰®æ¼”ï¼Œå¯æœ¬åœ°è·‘</td><td align="left">äº‘ç«¯æä¾›æ¸²æŸ“èµ„æºï¼Œå¼€ç®±å³ç”¨ï¼Œæ€§èƒ½æ›´é«˜</td></tr><tr><td align="left">é€‚ç”¨åœºæ™¯</td><td align="left">å¼€å‘æµ‹è¯•ã€POCã€é¢„ç®—æœ‰é™çš„ä¸­å°ä¼ä¸šã€æ•™è‚²ç§‘ç ”</td><td align="left">ç”Ÿäº§çº§å¤§å¹¶å‘ã€æ•°æ®æ•æ„Ÿã€éœ€è¦å®˜æ–¹è¿ç»´ä¸åˆè§„è®¤è¯çš„å¤§å‹æ”¿ä¼</td></tr></tbody></table>
<h2 data-id="heading-4">2ã€ç¡¬ä»¶åŠç¯å¢ƒå»ºè®®</h2>
<p>åšä¸»æœ¬äººæ˜¯Windowsç³»ç»Ÿï¼Œä½¿ç”¨äº† Docker Desktop+WSL2 ç¯å¢ƒæ¥éƒ¨ç½²Astronã€‚</p>
<p>å¦‚æœç¯å¢ƒè¿˜æœªå‡†å¤‡å¥½ï¼Œå¯ä»¥å‚è€ƒåšä¸»çš„å¦ä¸€ç¯‡åšå®¢<a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fniaonao%2Farticle%2Fdetails%2F155704448" target="_blank" title="https://blog.csdn.net/niaonao/article/details/155704448" ref="nofollow noopener noreferrer">Docker Desktop + WSL2 ä»å®‰è£…é…ç½®åˆ°æ ¸å¿ƒåº”ç”¨å®æˆ˜</a>ï¼Œå¸Œæœ›å¯¹ä½ æœ‰ç‚¹å¸®åŠ©ã€‚</p>
<p>Docker Desktop åŒ…æ‹¬ Docker Composeã€Docker Engine å’Œ Docker CLIç»„ä»¶ï¼Œå¯¹å¼€å‘è€…ä½¿ç”¨Dockerç¯å¢ƒéå¸¸å‹å¥½ã€‚</p>
<h3 data-id="heading-5">2.1 ç¡¬ä»¶é…ç½®å»ºè®®</h3>
<ul>
<li>CPU &gt;= 4Core</li>
<li>RAM &gt;= 16GB</li>
<li>Disk &gt;= 50G</li>
</ul>
<h3 data-id="heading-6">2.2 ç¯å¢ƒå»ºè®®</h3>
<ul>
<li>Docker 26.1.4åŠä»¥ä¸Š</li>
<li>Docker Compose 2.27.1åŠä»¥ä¸Š</li>
</ul>
<h2 data-id="heading-7">3ã€Astronéƒ¨ç½²</h2>
<p>AstronAgent é¡¹ç›®åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªä¸»è¦ç»„ä»¶Casdoorã€RagFlowã€AstronAgent</p>
<ul>
<li>Casdoor
èº«ä»½è®¤è¯å’Œå•ç‚¹ç™»å½•æœåŠ¡(å¿…è¦éƒ¨ç½²ç»„ä»¶,æä¾›å•ç‚¹ç™»å½•åŠŸèƒ½)</li>
<li>RagFlow
çŸ¥è¯†åº“å’Œæ–‡æ¡£æ£€ç´¢æœåŠ¡(éå¿…è¦éƒ¨ç½²ç»„ä»¶,æ ¹æ®éœ€è¦éƒ¨ç½²)</li>
<li>AstronAgent
æ ¸å¿ƒä¸šåŠ¡æœåŠ¡é›†ç¾¤(å¿…è¦éƒ¨ç½²ç»„ä»¶)</li>
</ul>
<h3 data-id="heading-8">3.1 æ‹‰å–astron-agentåˆ°æœ¬åœ°</h3>
<p>é€šè¿‡gitæ‹‰å–é¡¹ç›®åˆ°æœ¬åœ°ï¼Œè¿œç¨‹ä»“åº“åœ°å€<code>git clone https://github.com/iflytek/astron-agent.git</code></p>
<p>æˆªæ­¢åˆ°2025/12/07çš„ç¨³å®šç‰ˆæœ¬æ˜¯v1.0.0-rc.8ï¼Œæ­¤å¤„å°†æœ¬åœ°ä»“åº“åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2448c7d1a3084f7a98964b8a76f30510~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=zbKoHJwDW3TkooBoks3WUqpImZk%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…‹éš†é¡¹ç›®</span>
git <span class="hljs-built_in">clone</span> https://github.com/iflytek/astron-agent.git
</code></pre>
<h3 data-id="heading-9">3.2 å¤åˆ¶ç¯å¢ƒå˜é‡æ–‡ä»¶</h3>
<p>è¿›å…¥æœ¬åœ°ä»“åº“çš„astron-agenté¡¹ç›®æ ¹ç›®å½•ï¼Œæ¯”å¦‚åšä¸»æœ¬åœ°æ‹‰å–åˆ°äº†E:\workspace\astron-agentè·¯å¾„ä¸‹ï¼Œåšä¸»è¿›å…¥è¯¥è·¯å¾„åï¼Œå†è¿›å…¥åˆ°docker/astronAgentè·¯å¾„ä¸‹ï¼Œå¤åˆ¶ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ï¼Œç¼–è¾‘æ‰“å¼€é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ç¯å¢ƒå˜é‡ã€‚</p>
<p>å¦‚ä¸‹æ˜¯Linuxå‘½ä»¤ã€‚åšä¸»è¿™é‡Œåœ¨Windowsä¸‹ç›´æ¥æ‰“å¼€å¤åˆ¶åçš„.envæ–‡ä»¶è¿›è¡Œä¿®æ”¹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è¿›å…¥ astronAgent ç›®å½•</span>
<span class="hljs-built_in">cd</span> astron-agent/docker/astronAgent

<span class="hljs-comment"># å¤åˆ¶ç¯å¢ƒå˜é‡é…ç½®</span>
<span class="hljs-built_in">cp</span> .env.example .<span class="hljs-built_in">env</span>

<span class="hljs-comment"># ç¯å¢ƒå˜é‡é…ç½®</span>
vim .<span class="hljs-built_in">env</span>
</code></pre>
<h3 data-id="heading-10">3.3 å¿…è¦çš„ç¯å¢ƒå˜é‡é…ç½®</h3>
<p>éƒ¨åˆ†ä¾èµ–è®¯é£å¼€æ”¾å¹³å°çš„é…ç½®ï¼Œåœ¨ä¸‹é¢"è®¯é£å¼€æ”¾å¹³å°ç§˜é’¥è·å–"ä¸­æœ‰è¯´æ˜ã€‚</p>
<pre><code class="hljs language-env" lang="env"># å»ºè®®æ¢æˆAstronç¨³å®šç‰ˆæœ¬çš„é•œåƒï¼Œæ­¤å¤„ä¿®æ”¹ä¸ºv1.0.0-rc.8ï¼Œä»¥githubä¸Šå®é™…ç‰ˆæœ¬ä¸ºå‡†
ASTRON_AGENT_VERSION=v1.0.0-rc.8

# éƒ¨ç½²æœºå™¨çš„IPåœ°å€ï¼Œåšä¸»è¿™é‡Œæœ¬æœºéƒ¨ç½²ï¼Œä½¿ç”¨localhostæˆ–127.0.0.1å³å¯
HOST_BASE_ADDRESS=http://localhost

# è®¯é£å¼€æ”¾å¹³å°åº”ç”¨IDã€APIKeyã€APISecret
PLATFORM_APP_ID=39xx5a
PLATFORM_API_KEY=dcxx68
PLATFORM_API_SECRET=Y2xxIx

# æ˜Ÿç«æ¨¡å‹çš„å¯†é’¥
SPARK_API_PASSWORD=IRxxxx
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d7cae01eac64c2985ab5c06aa0767d3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=o5Xhx%2BSdkJPmcpGNCTJhS6mrylo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d151ea8df7ae4901a8c11a6e1a0891ad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=AgjPcv0PzmVqsTPLKxiIZan8v%2BQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-11">3.4 è®¯é£å¼€æ”¾å¹³å°ç§˜é’¥è·å–</h3>
<p>ç™»å½•<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.xfyun.cn%2F" target="_blank" title="https://www.xfyun.cn/" ref="nofollow noopener noreferrer">è®¯é£å¼€æ”¾å¹³å°</a>ï¼Œè¿›å…¥æ§åˆ¶å°ï¼Œåœ¨æˆ‘çš„åº”ç”¨ä¸‹åˆ›å»ºæ–°åº”ç”¨ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b996471af7e4e50a7da0c09d67e0ad6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=sf5a82rktYlejyEGvko1qWltqNA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee643c95d61d464d83eeb38a13c63beb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=7R7O11KoUSoSLa%2BXo6AVbxv1d50%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
åº”ç”¨åç§°è‡ªå®šä¹‰å³å¯ï¼Œæ­¤å¤„åšä¸»å·²åˆ›å»ºäº†åä¸º"AI å‘˜å·¥"çš„åº”ç”¨ï¼Œç‚¹å‡»åº”ç”¨è¿›å…¥èƒ½åŠ›é…ç½®é¡µã€‚</p>
<p>æ‰“å¼€å·¦ä¾§æ˜Ÿç«è®¤çŸ¥å¤§æ¨¡å‹ï¼Œé€‰ä¸­Spark Ultra-32Kå¤§æ¨¡å‹ã€‚</p>
<p>å³ä¾§çš„httpæœåŠ¡æ¥å£è®¤è¯ä¿¡æ¯é¢æ¿ä¸‹åŒ…å«äº†ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ä¸­çš„å…³é”®ç¯å¢ƒå˜é‡ã€‚</p>
<p>httpæœåŠ¡æ¥å£è®¤è¯ä¿¡æ¯çš„é‰´æƒä¿¡æ¯APIPasswordå³ç¯å¢ƒå˜é‡ä¸­çš„<code>SPARK_API_PASSWORD</code></p>
<p>WebsocketæœåŠ¡æ¥å£è®¤è¯ä¿¡æ¯çš„é‰´æƒä¿¡æ¯APPIDã€APISecretã€APIKeyå³ç¯å¢ƒå˜é‡ä¸­<code>PLATFORM_APP_IDã€PLATFORM_API_KEYã€PLATFORM_API_SECRET</code></p>
<p>ä¿®æ”¹<code>./docker/astronAgent/.env</code>ç¯å¢ƒå˜é‡é…ç½®åä¿å­˜å³å¯ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šè®¯é£çš„APISecretå’ŒAPIKeyçš„é¡ºåºï¼Œä¸è¦é…é”™é¡ºåºå“ˆã€‚ä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆæ³¨æ„ï¼Œå‘œå‘œå‘œ</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cad872e125ed489683be5ca543a63fda~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=qGfQi7Vy1J03%2F%2Fo28H3nEoRfQ%2Fs%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
å¯ä»¥ç‚¹å‡»ç«‹å³é¢†å–ï¼Œæœ‰å…è´¹çš„tokenè¯•ç”¨é¢åº¦ã€‚ç¡®ä¿è‡ªå·±åœ¨è®¯é£å¼€æ”¾å¹³å°Spark Ultra-32Kå¤§æ¨¡å‹æœ‰ä¸€å®šçš„tokenä½™é‡ï¼Œé¿å…Astronéƒ¨ç½²å®Œæˆåï¼Œæ— æ³•åˆ›å»ºæ™ºèƒ½ä½“ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šå¯ä»¥é¢†å–ä¸‹Spark Ultra-32Kçš„tokené¢åº¦</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c7826288ccda4a649da080ac2cc4023e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=6xAZ31rlkJcQb%2FB1hm23Qyf0TpI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-12">3.5 å¯åŠ¨Astron Agent</h3>
<p>Win+Rå¿«æ·é”®å”¤èµ·è¿è¡Œçª—å£ï¼Œè¾“å…¥powershellå›è½¦æ‰“å¼€Powershellå‘½ä»¤è¡Œçª—å£ï¼Œåˆ‡æ¢åˆ°astron-agentæœ¬åœ°ä»“åº“ï¼Œè¿›å…¥docker/astronAgentï¼Œæ‰§è¡Œå¯åŠ¨å‘½ä»¤<code>docker compose -f docker-compose-with-auth.yaml up -d</code>ï¼Œå›è½¦å³å¯</p>
<p>é¦–æ¬¡å¯åŠ¨ä¼šæ ¹æ®é…ç½®æ‹‰å»é•œåƒåŠå…¶ä»–ä¾èµ–é•œåƒã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šå¦‚æœå¯åŠ¨å¤±è´¥æˆ–è€…æ‹‰å–é•œåƒå¤±è´¥å¯ä»¥è·³è¿‡ï¼Œç›´æ¥çœ‹ä¸‹é¢çš„"éƒ¨ç½²å¤±è´¥å¸¸è§é—®é¢˜è¯´æ˜"ï¼Œå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0417d0df9c344f5caf9723f5efd10813~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=My%2FURqJpz3LOIzEa3s4Bf1o5yVQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>é¡ºåˆ©çš„è¯ï¼Œå¯åŠ¨å®Œæˆã€‚</p>
<p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œastron-agenté•œåƒä¸‹çš„æ‰€æœ‰å®¹å™¨çŠ¶æ€éƒ½æ˜¯Healthyã€Startedã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7ebdbb450ea4c9690c0289dd7fe490d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=lbe%2FfXhIVzdqSdD2af3m%2F8CVivo%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
é€šè¿‡Docker Desktopä¹Ÿå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„å®¹å™¨éƒ½æˆåŠŸè¿è¡Œã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc0e5e23d21941dcb4c9d009882e91ab~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=hLYlIxOJ3MwZh1Y2%2FN13XXKOvtE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-13">3.6 è®¿é—®AstronæœåŠ¡</h3>
<p>(1) Casdoorè®¤è¯æœåŠ¡</p>
<p>è®¿é—® Casdoor ç®¡ç†æ§åˆ¶å°ï¼š <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A8000%25EF%25BC%258C%25E5%2588%259D%25E5%25A7%258B%25E5%258C%2596%25E8%25B4%25A6%25E5%258F%25B7%2F%25E5%25AF%2586%25E7%25A0%2581%25EF%25BC%259Aadmin%2F123" target="_blank" title="http://localhost:8000%EF%BC%8C%E5%88%9D%E5%A7%8B%E5%8C%96%E8%B4%A6%E5%8F%B7/%E5%AF%86%E7%A0%81%EF%BC%9Aadmin/123" ref="nofollow noopener noreferrer">http://localhost:8000ï¼Œåˆå§‹åŒ–è´¦å·/å¯†ç ï¼šadmin/123</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/116dafdfb15941208361fd320fd2f409~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=qV%2BiFZNO4BnRGK%2BeXlqjoMgjVLI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e26dd63a2b0e49b194a7340df45ed782~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=rPTwRnvthP2QS9mQb0vPdkViRqM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
(2) AstronAgent æ ¸å¿ƒæœåŠ¡</p>
<p>æ§åˆ¶å°å‰ç«¯(nginxä»£ç†)ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%2F%25EF%25BC%258C%25E6%25AD%25A4%25E5%25A4%2584%25E4%25BD%25BF%25E7%2594%25A8admin%25E7%2599%25BB%25E5%25BD%2595%25E5%258D%25B3%25E5%258F%25AF%25E3%2580%2582" target="_blank" title="http://localhost/%EF%BC%8C%E6%AD%A4%E5%A4%84%E4%BD%BF%E7%94%A8admin%E7%99%BB%E5%BD%95%E5%8D%B3%E5%8F%AF%E3%80%82" ref="nofollow noopener noreferrer">http://localhost/ï¼Œæ­¤å¤„ä½¿ç”¨adminç™»å½•å³å¯ã€‚</a></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6fd813f50b404e6eac396118380e6ce3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=HAOh8SMLXLjdx82ATnyMjFN1UUA%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7ac706d1db434735a15d6ff95cf541fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=rnG5JKerz6h0GatO67k6O6wuTZQ%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-14">3.7 åˆ›å»ºæ™ºèƒ½ä½“</h3>
<p>æ­¤å¤„ä»¥æç¤ºè¯é©±åŠ¨çš„æ™ºèƒ½ä½“ä¸ºä¾‹</p>
<p>ç‚¹å‡»åˆ›å»ºï¼Œé€‰æ‹©æç¤ºè¯åˆ›å»ºã€‚è¾“å…¥è®¾å®šï¼Œç‚¹å‡»ç«‹å³åˆ›å»º</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/43ba8516d60b42bf850a24902ddedf62~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=CX23RHBW9C%2F46WyfN9c%2B5qJASjg%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a9095951c3634392a38947c7f6c23892~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=Txuu3LusHKg6UPkmAvsfyEKMoQU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3000dec519874958a52d09105c0d382e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=dbQ4x7gX9XuFiv3K%2B35hyNKPLHw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>å¾ˆå¿«å•Šï¼Œæ™ºèƒ½ä½“å°±åˆ›å»ºå¥½äº†ï¼Œåœ¨è°ƒè¯•é¢„è§ˆé¢æ¿ï¼Œå¯ä»¥è¯•ç€è®©ä»–è®²ä¸€ä¸ªå†·ç¬‘è¯ã€‚</p>
<p>å›ç­”çš„é€Ÿåº¦åœ¨4-6sè¿˜æ˜¯å¯ä»¥çš„ï¼Œå†…å®¹åŸºæœ¬ç¬¦åˆé¢„æœŸã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/12b01a79381d4c1c8b9d877a8cfdcbf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=HLY%2BUkmDUEhOS1yTC4lzAauP0qc%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-15">4ã€éƒ¨ç½²å¤±è´¥å¸¸è§é—®é¢˜è¯´æ˜</h2>
<p>å½“ç„¶äº†ï¼Œéƒ¨ç½²å“ªæœ‰é‚£ä¹ˆé¡ºåˆ©çš„ï¼Œå‘œå‘œå‘œ</p>
<p>åšä¸»ç¬¬ä¸€æ¬¡å¯åŠ¨Astronï¼Œé•œåƒéƒ½æ²¡æ‹‰ä¸‹æ¥ã€‚</p>
<h3 data-id="heading-16">æ˜¯å¦æ”¯æŒdocker-compose</h3>
<p>å¯åŠ¨å‘½ä»¤åŸºäºdocker-composeï¼Œåšä¸»ä½¿ç”¨çš„Docker Desktopå·²åŒ…å«docker-composeï¼Œå¦‚æœæ˜¯å…¶ä»–æ–¹å¼éƒ¨ç½²ï¼Œéœ€è¦è‡ªå·±å‡†å¤‡docker-composeç¯å¢ƒã€‚</p>
<pre><code class="hljs language-bash" lang="bash">$:docker compose version
$:Docker Compose version v2.40.3-desktop.1
</code></pre>
<h3 data-id="heading-17">failed to copy: httpReadSeeker: failed open</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c466452ccc9f4edd83c842f469f6451d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=8h3%2B388lV3rx8Z2mPZJk8SGh2lI%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>EOFï¼ˆEnd of Fileï¼‰ è¡¨ç¤ºè¿æ¥åœ¨æ•°æ®ä¼ è¾“å®Œæˆå‰è¢«ä¸­æ–­ã€‚ é€šå¸¸æ˜¯ç”±äºç½‘ç»œä¸ç¨³å®šã€Docker Hub è¢«å¢™æˆ–é•œåƒæºä¸å¯ç”¨å¯¼è‡´çš„ã€‚</p>
<p>æ¨èä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿå™¨ï¼Œæ¥æ‹‰å–é•œåƒã€‚æ¯”å¦‚é˜¿é‡Œäº‘ã€åä¸ºäº‘ã€æ¸…åé•œåƒã€è½©è¾•é•œåƒç­‰ã€‚
æ­¤å¤„ä»¥é˜¿é‡Œäº‘ä¸ºä¾‹ï¼Œç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°ï¼Œæ‰¾åˆ°å®¹å™¨é•œåƒæœåŠ¡ï¼Œæ‰“å¼€é•œåƒå·¥å…·ä¸‹çš„é•œåƒåŠ é€Ÿå™¨æŸ¥çœ‹è‡ªå·±çš„åŠ é€Ÿå™¨åœ°å€ã€‚</p>
<p>æ‰“å¼€Docker Desktopè®¾ç½®çš„Docker Engineï¼Œå¢åŠ é…ç½®registry-mirrorsã€‚ç‚¹å‡»åº”ç”¨å¹¶é‡å¯Docker Desktopå³å¯ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"registry-mirrors"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"https://6xxxf.mirror.aliyuncs.com"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97c38f14d4fe4d7d9304aa6d9528c872~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=elY1m%2ByYWZpgm11xzLLXqbpjEzU%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a86258cd22834421bcb6464fb1ce8c7b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=17bD47gQdYtwYfMzTLIllpexSSw%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-18">casbin/casdooré•œåƒæ‹‰å–å¤±è´¥</h3>
<p>casbin/casdoorç¡®å®ä¸å¥½æ‹‰å–ï¼Œæˆ‘è¿™è¾¹å¼€äº†ä»£ç†ï¼Œç„¶ååœ¨Docker Desktopå°è¯•å•ç‹¬æ‹‰å–casbin/casdoorï¼Œè¯•äº†3-5æ¬¡æˆåŠŸæ‹‰å–ä¸‹æ¥ã€‚</p>
<p>æˆ–è€…æ‰¾ä¸‹å›½å†…é•œåƒ</p>
<h3 data-id="heading-19">æœåŠ¡å¯åŠ¨æˆåŠŸè®¿é—®åéƒ¨åˆ†åŠŸèƒ½æŠ¥é”™</h3>
<p>æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ˜¯å‡ ä¸ªæ ¸å¿ƒé…ç½®çš„å€¼ä¸æ­£ç¡®ã€‚</p>
<p>ASTRON_AGENT_VERSIONæ˜¯ä¸æ˜¯Astronçš„ç¨³å®šç‰ˆæœ¬ã€‚</p>
<p>APPç§˜é’¥æ˜¯å¦æ­£ç¡®ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">ASTRON_AGENT_VERSION=v1.0.0-rc.8

PLATFORM_APP_ID=your-app-id
PLATFORM_API_KEY=your-api-key
PLATFORM_API_SECRET=your-api-secret

SPARK_API_PASSWORD=your-api-password
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4304e346a2ce497194ed1d11256832c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmlhb25hbw==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766298088&amp;x-signature=OGNC0fqTWXxcVB7I%2Bw5qGWdBja8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h3 data-id="heading-20">ç«¯å£å ç”¨</h3>
<p>æ³¨æ„ç«¯å£å†²çªé—®é¢˜ï¼ŒAstronå¯ç”¨äº†å¾ˆå¤šç«¯å£ï¼Œå¯èƒ½ä¼šå’Œä½ çš„å…¶ä»–æœåŠ¡å†²çªã€‚</p>
<h3 data-id="heading-21">æç¤ºSpark API é”™è¯¯æˆ–è€…è°ƒç”¨é‡ä¸è¶³</h3>
<p>éœ€è¦æ£€æŸ¥ä¸‹ç¯å¢ƒå˜é‡çš„Spark-API-Passwordæ˜¯å¦æ­£ç¡®ã€‚</p>
<p>æ£€æŸ¥å¤§æ¨¡å‹tokenå‰©ä½™é‡æ˜¯å¦å……è¶³ã€‚</p>
<h3 data-id="heading-22">éƒ¨ç½²å®Œæˆåæ‰“ä¸å¼€é¡µé¢</h3>
<p>ä»¥ä¸‹å‘½ä»¤æ…é‡æ‰§è¡Œï¼Œæ“ä½œå‰åšå¥½å¤‡ä»½ã€‚</p>
<p>æ‰§è¡Œ<code>docker compose -f docker-compose-with-auth.yaml down -v</code>æ¸…ç†å®¹å™¨å’Œæ•°æ®å·ï¼Œè¯¥æ­¥éª¤ä¼šåˆ é™¤æ‰€æœ‰æ•°æ®ã€‚</p>
<p>è¿è¡Œ<code>git restore docker</code>æ¸…ç†dockerç›®å½•ä¸‹çš„æ”¹åŠ¨</p>
<p>å°†<code>ASTRON_AGENT_VERSION=v1.0.0-rc.8</code>è®¾å®šä¸ºç¨³å®šç‰ˆ</p>
<p>é‡æ–°é…ç½®ç¯å¢ƒå˜é‡ï¼Œç¡®ä¿å–å€¼æ­£ç¡®</p>
<p>æ‰§è¡Œ<code>docker compose -f docker-compose-with-auth.yaml up -d</code>é‡å¯æœåŠ¡</p>
<p>æ¸…ç†æµè§ˆå™¨æ¢æˆï¼Œä½¿ç”¨æ— ç—•æ¨¡å¼è®¿é—®ã€‚</p>
<blockquote>
<p>Powered By niaonao</p>
<p>astron-agent å®‰è£…éƒ¨ç½²æŒ‡å— <a href="https://link.juejin.cn?target=https%3A%2F%2Fscn5s6198j3j.feishu.cn%2Fwiki%2FVefnwvPbridJBikCUb1cYXO9nYb" target="_blank" title="https://scn5s6198j3j.feishu.cn/wiki/VefnwvPbridJBikCUb1cYXO9nYb" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fscn5s6198j3j.feishu.cn%2Fwiki%2FVefnwvPbridJBikCUb1cYXO9nYb" target="_blank" title="https://scn5s6198j3j.feishu.cn/wiki/VefnwvPbridJBikCUb1cYXO9nYb" ref="nofollow noopener noreferrer">scn5s6198j3j.feishu.cn/wiki/Vefnwvâ€¦</a></p>
<p>astron-agent github <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fiflytek%2Fastron-agent%2Fblob%2Fmain%2FREADME-zh.md" target="_blank" title="https://github.com/iflytek/astron-agent/blob/main/README-zh.md" ref="nofollow noopener noreferrer"/><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fiflytek%2Fastron-agent%2Fblob%2Fmain%2FREADME-zh.md" target="_blank" title="https://github.com/iflytek/astron-agent/blob/main/README-zh.md" ref="nofollow noopener noreferrer">github.com/iflytek/astâ€¦</a>&lt;/a</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å…³äºAndroid Composeæ¶æ„çš„æ€è€ƒ]]></title>    <link>https://juejin.cn/post/7582857981894148137</link>    <guid>https://juejin.cn/post/7582857981894148137</guid>    <pubDate>2025-12-13T07:11:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582857981894148137" data-draft-id="7582787460419420202" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å…³äºAndroid Composeæ¶æ„çš„æ€è€ƒ"/> <meta itemprop="keywords" content="Android,å‰ç«¯,MVVM"/> <meta itemprop="datePublished" content="2025-12-13T07:11:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°è™ç‰™007"/> <meta itemprop="url" content="https://juejin.cn/user/3940246036155640"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å…³äºAndroid Composeæ¶æ„çš„æ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3940246036155640/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°è™ç‰™007
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T07:11:36.000Z" title="Sat Dec 13 2025 07:11:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    57
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Compose æœ¬èº«æ˜¯<strong>å£°æ˜å¼ UI æ¡†æ¶</strong>ï¼Œå¤©ç„¶é€‚é…ã€Œå“åº”å¼æ¶æ„ã€ï¼Œä¼ ç»Ÿçš„ MVC/MVP å› ã€Œå‘½ä»¤å¼æ€ç»´ã€ï¼ˆæ‰‹åŠ¨æ›´æ–° UIï¼‰å·²ä¸å†é€‚é…ï¼Œä¸»æµæ¶æ„æ˜¯ <strong>MVVMï¼ˆæœ€è´´åˆï¼‰</strong>ï¼Œè¿›é˜¶åœºæ™¯ä¼šç»“åˆã€Œå•å‘æ•°æ®æµï¼ˆUDFï¼‰ã€ã€ŒClean Architectureï¼ˆæ•´æ´æ¶æ„ï¼‰ã€è®¾è®¡ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯è®©<strong>æ•°æ®çŠ¶æ€å•å‘æµè½¬</strong>ï¼Œé¿å… UI ä¸ä¸šåŠ¡é€»è¾‘è€¦åˆã€‚</p>
<h3 data-id="heading-0">ä¸€ã€å…ˆæ˜ç¡®ï¼šCompose ä¸ºä»€ä¹ˆâ€œæŠ›å¼ƒâ€MVC/MVPï¼Ÿ</h3>





















<table><thead><tr><th>æ¶æ„</th><th>æ ¸å¿ƒé—®é¢˜ï¼ˆé€‚é… Compose æ—¶ï¼‰</th></tr></thead><tbody><tr><td>MVC</td><td>Controller ç›´æ¥æ“ä½œ UIï¼ˆCompose ä¸­ UI ç”±çŠ¶æ€é©±åŠ¨ï¼Œæ— â€œ findViewById + æ›´æ–°â€çš„æ“ä½œå…¥å£ï¼‰ï¼Œæ˜“å¯¼è‡´çŠ¶æ€æ··ä¹±</td></tr><tr><td>MVP</td><td>Presenter æŒæœ‰ View æ¥å£ï¼Œé€šè¿‡æ¥å£å›è°ƒæ›´æ–° UIï¼ˆCompose ä¸­æ— â€œView æ¥å£â€ï¼Œå›è°ƒä¼šç ´åå£°æ˜å¼æ€æƒ³ï¼Œå¢åŠ æ¨¡æ¿ä»£ç ï¼‰</td></tr><tr><td>MVVM</td><td>ViewModel æŒæœ‰å¯è§‚å¯ŸçŠ¶æ€ï¼ŒUI ä»…è®¢é˜…çŠ¶æ€ï¼ˆå®Œå…¨è´´åˆ Compose â€œçŠ¶æ€é©±åŠ¨ UIâ€çš„æ ¸å¿ƒï¼Œæ— æ‰‹åŠ¨æ›´æ–°é€»è¾‘ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-1">äºŒã€Compose ä¸»æµæ¶æ„ï¼šMVVM + å•å‘æ•°æ®æµï¼ˆUDFï¼‰</h3>
<p>è¿™æ˜¯ Google å®˜æ–¹æ¨èçš„æ¶æ„ï¼Œæ ¸å¿ƒæ˜¯ã€ŒçŠ¶æ€ä¸Šç§»ã€å•å‘æµè½¬ã€ï¼Œåˆ†ä¸º 4 å±‚ï¼ŒèŒè´£æ¸…æ™°ä¸”é€‚é… Compose çš„é‡ç»„ç‰¹æ€§ï¼š</p>
<h4 data-id="heading-2">1. æ¶æ„åˆ†å±‚ï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰</h4>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-operator">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-operator">â”‚</span> <span class="hljs-type">UI</span> å±‚ï¼ˆ<span class="hljs-type">Composable</span> å‡½æ•°ï¼‰ <span class="hljs-operator">â”‚</span> ä»…è®¢é˜…çŠ¶æ€<span class="hljs-operator">ã€</span>è§¦å‘äº‹ä»¶ï¼Œæ— ä¸šåŠ¡é€»è¾‘
<span class="hljs-operator">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
              <span class="hljs-operator">â”‚</span> å‘é€äº‹ä»¶ï¼ˆå¦‚ç‚¹å‡»ï¼‰<span class="hljs-operator">/</span> æ¥æ”¶çŠ¶æ€æ›´æ–°
<span class="hljs-operator">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-operator">â”‚</span> <span class="hljs-type">ViewModel</span> å±‚ï¼ˆçŠ¶æ€æŒæœ‰ï¼‰ <span class="hljs-operator">â”‚</span> å¤„ç†<span class="hljs-type">UIäº‹ä»¶</span><span class="hljs-operator">ã€</span>ç®¡ç†çŠ¶æ€<span class="hljs-operator">ã€</span>è°ƒç”¨ä»“åº“å±‚ï¼Œä¸æŒæœ‰<span class="hljs-type">UIå¼•ç”¨</span>
<span class="hljs-operator">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
              <span class="hljs-operator">â”‚</span> è°ƒç”¨æ¥å£<span class="hljs-operator">/</span>æœ¬åœ°æ•°æ®
<span class="hljs-operator">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-operator">â”‚</span> <span class="hljs-type">Repository</span> å±‚ï¼ˆæ•°æ®ä»“åº“ï¼‰<span class="hljs-operator">â”‚</span> ç»Ÿä¸€ç®¡ç†æ•°æ®æ¥æºï¼ˆç½‘ç»œ<span class="hljs-operator">/</span>æœ¬åœ°<span class="hljs-type">DB</span><span class="hljs-operator">/</span><span class="hljs-type">SharedPrefï¼‰ï¼Œè§£è€¦æ•°æ®é€»è¾‘</span>
<span class="hljs-operator">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
              <span class="hljs-operator">â”‚</span> æ•°æ®è¯·æ±‚<span class="hljs-operator">/</span>å­˜å‚¨
<span class="hljs-operator">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-operator">â”‚</span> <span class="hljs-type">Data</span> å±‚ï¼ˆæ•°æ®æºï¼‰<span class="hljs-operator">â”‚</span> ç½‘ç»œæ¥å£ï¼ˆ<span class="hljs-type">Retrofitï¼‰</span><span class="hljs-operator">ã€</span>æœ¬åœ°<span class="hljs-type">DBï¼ˆRoomï¼‰</span><span class="hljs-operator">ã€</span><span class="hljs-type">SPç­‰</span>
<span class="hljs-operator">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<h4 data-id="heading-3">2. æ ¸å¿ƒåŸåˆ™ï¼šå•å‘æ•°æ®æµï¼ˆUDFï¼‰</h4>
<p>æ•°æ®åªèƒ½æ²¿ã€ŒData â†’ Repository â†’ ViewModel â†’ UIã€æ–¹å‘æµè½¬ï¼Œåå‘ä»…é€šè¿‡ã€Œäº‹ä»¶ã€è§¦å‘ï¼Œé¿å…çŠ¶æ€æ··ä¹±ï¼š</p>
<pre><code class="hljs">UI è§¦å‘äº‹ä»¶ï¼ˆå¦‚ç‚¹å‡»æŒ‰é’®ï¼‰â†’ ViewModel å¤„ç†äº‹ä»¶ â†’ è°ƒç”¨ Repository è·å–æ•°æ® â†’ ViewModel æ›´æ–°çŠ¶æ€ â†’ UI è‡ªåŠ¨é‡ç»„ 
</code></pre>
<h3 data-id="heading-4">ä¸‰ã€å®Œæ•´ç¤ºä¾‹ï¼šMVVM + å•å‘æ•°æ®æµ</h3>
<p>ä»¥â€œç™»å½•é¡µâ€ä¸ºä¾‹ï¼Œè¦†ç›–çŠ¶æ€ç®¡ç†ã€äº‹ä»¶å¤„ç†ã€æ•°æ®è¯·æ±‚å…¨æµç¨‹ï¼š</p>
<h4 data-id="heading-5">Step 1ï¼šData å±‚ï¼ˆç½‘ç»œè¯·æ±‚ï¼‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">// 1. æ•°æ®æ¨¡å‹</span>
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginRequest</span>(<span class="hljs-keyword">val</span> username: String, <span class="hljs-keyword">val</span> password: String)
<span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginResponse</span>(<span class="hljs-keyword">val</span> token: String, <span class="hljs-keyword">val</span> userId: String)

<span class="hljs-comment">// 2. ç½‘ç»œæ¥å£ï¼ˆRetrofitï¼‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">LoginApi</span> {
    <span class="hljs-meta">@POST(<span class="hljs-string">"login"</span>)</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">login</span><span class="hljs-params">(<span class="hljs-meta">@Body</span> request: <span class="hljs-type">LoginRequest</span>)</span></span>: LoginResponse
}

<span class="hljs-comment">// 3. æœ¬åœ°æ•°æ®æºï¼ˆç¤ºä¾‹ï¼šSharedPref ä¿å­˜ Tokenï¼‰</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginLocalDataSource</span>(context: Context) {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> sp = context.getSharedPreferences(<span class="hljs-string">"login"</span>, Context.MODE_PRIVATE)
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">saveToken</span><span class="hljs-params">(token: <span class="hljs-type">String</span>)</span></span> {
        sp.edit().putString(<span class="hljs-string">"token"</span>, token).apply()
    }
    
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getToken</span><span class="hljs-params">()</span></span>: String? = sp.getString(<span class="hljs-string">"token"</span>, <span class="hljs-literal">null</span>)
}
</code></pre>
<h4 data-id="heading-6">Step 2ï¼šRepository å±‚ï¼ˆæ•°æ®ä»“åº“ï¼‰</h4>
<p>ç»Ÿä¸€ç®¡ç†æ•°æ®æ¥æºï¼ŒViewModel æ— éœ€å…³å¿ƒæ•°æ®ä»ç½‘ç»œ/æœ¬åœ°æ¥ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginRepository</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> api: LoginApi,
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> localDataSource: LoginLocalDataSource
) {
    <span class="hljs-comment">// ç™»å½•è¯·æ±‚ï¼ˆæŒ‚èµ·å‡½æ•°ï¼Œé€‚é…åç¨‹ï¼‰</span>
    <span class="hljs-keyword">suspend</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">login</span><span class="hljs-params">(username: <span class="hljs-type">String</span>, password: <span class="hljs-type">String</span>)</span></span>: LoginResponse {
        <span class="hljs-keyword">val</span> response = api.login(LoginRequest(username, password))
        <span class="hljs-comment">// ç™»å½•æˆåŠŸåä¿å­˜ Token åˆ°æœ¬åœ°</span>
        localDataSource.saveToken(response.token)
        <span class="hljs-keyword">return</span> response
    }
}
</code></pre>
<h4 data-id="heading-7">Step 3ï¼šViewModel å±‚ï¼ˆçŠ¶æ€æŒæœ‰ + äº‹ä»¶å¤„ç†ï¼‰</h4>
<p>æ ¸å¿ƒæ˜¯ç”¨ <code>StateFlow</code>/<code>LiveData</code> æŒæœ‰å¯è§‚å¯ŸçŠ¶æ€ï¼ŒCompose è®¢é˜…åè‡ªåŠ¨é‡ç»„ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginViewModel</span>(
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> repository: LoginRepository
) : ViewModel() {
    <span class="hljs-comment">// 1. UI çŠ¶æ€ï¼ˆèšåˆæ‰€æœ‰éœ€è¦é©±åŠ¨ UI çš„æ•°æ®ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> _uiState = MutableStateFlow(LoginUiState())
    <span class="hljs-keyword">val</span> uiState: StateFlow&lt;LoginUiState&gt; = _uiState.asStateFlow() <span class="hljs-comment">// å¯¹å¤–æš´éœ²åªè¯»æµ</span>

    <span class="hljs-comment">// 2. å¤„ç†ç™»å½•äº‹ä»¶ï¼ˆUI ç‚¹å‡»åè°ƒç”¨ï¼‰</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">handleLogin</span><span class="hljs-params">(username: <span class="hljs-type">String</span>, password: <span class="hljs-type">String</span>)</span></span> {
        <span class="hljs-comment">// æ ‡è®°åŠ è½½ä¸­</span>
        _uiState.update { it.copy(isLoading = <span class="hljs-literal">true</span>, errorMsg = <span class="hljs-string">""</span>) }
        
        <span class="hljs-comment">// åç¨‹å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼ˆviewModelScope è‡ªåŠ¨ç»‘å®šç”Ÿå‘½å‘¨æœŸï¼‰</span>
        viewModelScope.launch {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">val</span> response = repository.login(username, password)
                <span class="hljs-comment">// ç™»å½•æˆåŠŸï¼šæ›´æ–°çŠ¶æ€</span>
                _uiState.update { 
                    it.copy(
                        isLoading = <span class="hljs-literal">false</span>,
                        isLoginSuccess = <span class="hljs-literal">true</span>,
                        token = response.token
                    )
                }
            } <span class="hljs-keyword">catch</span> (e: Exception) {
                <span class="hljs-comment">// ç™»å½•å¤±è´¥ï¼šæ›´æ–°é”™è¯¯çŠ¶æ€</span>
                _uiState.update { 
                    it.copy(
                        isLoading = <span class="hljs-literal">false</span>,
                        errorMsg = e.message ?: <span class="hljs-string">"ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•"</span>
                    )
                }
            }
        }
    }

    <span class="hljs-comment">// å®šä¹‰ UI çŠ¶æ€æ•°æ®ç±»ï¼ˆèšåˆæ‰€æœ‰ UI æ‰€éœ€çŠ¶æ€ï¼‰</span>
    <span class="hljs-keyword">data</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginUiState</span>(
        <span class="hljs-keyword">val</span> isLoading: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">false</span>,
        <span class="hljs-keyword">val</span> errorMsg: String = <span class="hljs-string">""</span>,
        <span class="hljs-keyword">val</span> isLoginSuccess: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">false</span>,
        <span class="hljs-keyword">val</span> token: String = <span class="hljs-string">""</span>
    )
}
</code></pre>
<h4 data-id="heading-8">Step 4ï¼šUI å±‚ï¼ˆComposable å‡½æ•°ï¼‰</h4>
<p>ä»…è®¢é˜… ViewModel çŠ¶æ€ã€è§¦å‘äº‹ä»¶ï¼Œæ— ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">@Composable
fun LoginScreen(
    viewModel: <span class="hljs-attr">LoginViewModel</span> = viewModel(), // è‡ªåŠ¨æ³¨å…¥ ViewModel
    onLoginSuccess: (String) -&gt; Unit // ç™»å½•æˆåŠŸåçš„è·³è½¬å›è°ƒ
) {
    // 1. æ”¶é›† ViewModel çŠ¶æ€ï¼ˆcollectAsState è‡ªåŠ¨è®¢é˜…ï¼ŒçŠ¶æ€å˜åŒ–è§¦å‘é‡ç»„ï¼‰
    val uiState by viewModel.uiState.collectAsStateWithLifecycle()
    
    // 2. è¾“å…¥æ¡†çŠ¶æ€ï¼ˆUI çº§ä¸´æ—¶çŠ¶æ€ï¼Œæ— éœ€æ”¾ ViewModelï¼‰
    var username by remember { mutableStateOf("") }
    var password by remember { mutableStateOf("") }

    Column(
        <span class="hljs-attr">modifier</span> = Modifier
            .fillMaxSize()
            .padding(16.dp),
        <span class="hljs-attr">horizontalAlignment</span> = Alignment.CenterHorizontally,
        <span class="hljs-attr">verticalArrangement</span> = Arrangement.Center
    ) {
        // ç”¨æˆ·åè¾“å…¥æ¡†
        OutlinedTextField(
            <span class="hljs-attr">value</span> = username,
            <span class="hljs-attr">onValueChange</span> = { username = it },
            <span class="hljs-attr">label</span> = { Text(<span class="hljs-string">"ç”¨æˆ·å"</span>) },
            <span class="hljs-attr">singleLine</span> = <span class="hljs-literal">true</span>,
            <span class="hljs-attr">modifier</span> = Modifier.fillMaxWidth()
        )
        
        Spacer(<span class="hljs-attr">modifier</span> = Modifier.height(<span class="hljs-number">16</span>.dp))
        
        // å¯†ç è¾“å…¥æ¡†
        OutlinedTextField(
            <span class="hljs-attr">value</span> = password,
            <span class="hljs-attr">onValueChange</span> = { password = it },
            <span class="hljs-attr">label</span> = { Text(<span class="hljs-string">"å¯†ç "</span>) },
            <span class="hljs-attr">singleLine</span> = <span class="hljs-literal">true</span>,
            <span class="hljs-attr">visualTransformation</span> = PasswordVisualTransformation(),
            <span class="hljs-attr">modifier</span> = Modifier.fillMaxWidth()
        )
        
        // é”™è¯¯æç¤º
        if (uiState.errorMsg.isNotBlank()) {
            Text(
                <span class="hljs-attr">text</span> = uiState.errorMsg,
                <span class="hljs-attr">color</span> = Color.Red,
                <span class="hljs-attr">modifier</span> = Modifier.padding(top = <span class="hljs-number">8</span>.dp)
            )
        }
        
        Spacer(<span class="hljs-attr">modifier</span> = Modifier.height(<span class="hljs-number">16</span>.dp))
        
        // ç™»å½•æŒ‰é’®ï¼ˆåŠ è½½ä¸­ç¦ç”¨ï¼‰
        Button(
            <span class="hljs-attr">onClick</span> = { viewModel.handleLogin(username, password) },
            <span class="hljs-attr">enabled</span> = !uiState.isLoading,
            <span class="hljs-attr">modifier</span> = Modifier.fillMaxWidth()
        ) {
            if (uiState.isLoading) {
                CircularProgressIndicator(
                    <span class="hljs-attr">modifier</span> = Modifier.size(<span class="hljs-number">20</span>.dp),
                    <span class="hljs-attr">strokeWidth</span> = <span class="hljs-number">2</span>.dp
                )
            } else {
                Text("ç™»å½•")
            }
        }
    }

    // ç™»å½•æˆåŠŸï¼šè§¦å‘è·³è½¬ï¼ˆå‰¯ä½œç”¨ï¼Œç”¨ LaunchedEffect é¿å…é‡ç»„é‡å¤æ‰§è¡Œï¼‰
    LaunchedEffect(uiState.isLoginSuccess) {
        if (uiState.isLoginSuccess) {
            onLoginSuccess(uiState.token)
        }
    }
}
</code></pre>
<h4 data-id="heading-9">Step 5ï¼šActivity å±‚ï¼ˆä»…æ‰¿è½½ UIï¼‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> : <span class="hljs-type">ComponentActivity</span>() {
    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        setContent {
            MyAppTheme {
                LoginScreen(onLoginSuccess = { token -&gt;
                    <span class="hljs-comment">// ç™»å½•æˆåŠŸè·³è½¬åˆ°é¦–é¡µ</span>
                    navController.navigate(<span class="hljs-string">"home"</span>)
                })
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-10">å››ã€çŠ¶æ€è®¾è®¡çš„æ ¸å¿ƒè§„åˆ™ï¼ˆé¿å‘å…³é”®ï¼‰</h3>
<h4 data-id="heading-11">1. çŠ¶æ€åˆ†ç±»ï¼šåŒºåˆ†â€œUI ä¸´æ—¶çŠ¶æ€â€å’Œâ€œä¸šåŠ¡çŠ¶æ€â€</h4>























<table><thead><tr><th>çŠ¶æ€ç±»å‹</th><th>ç¤ºä¾‹</th><th>å­˜æ”¾ä½ç½®</th><th>åŸå› </th></tr></thead><tbody><tr><td>UI ä¸´æ—¶çŠ¶æ€</td><td>è¾“å…¥æ¡†å†…å®¹ã€åˆ—è¡¨æ»šåŠ¨ä½ç½®ã€å¼¹çª—æ˜¾éš</td><td>Composable å†…ï¼ˆrememberï¼‰</td><td>ä»…å½±å“å•ä¸ª UI ç»„ä»¶ï¼Œæ— éœ€å…±äº«/æŒä¹…åŒ–</td></tr><tr><td>ä¸šåŠ¡çŠ¶æ€</td><td>ç™»å½•çŠ¶æ€ã€ç”¨æˆ·ä¿¡æ¯ã€æ¥å£è¿”å›æ•°æ®</td><td>ViewModelï¼ˆStateFlowï¼‰</td><td>éœ€è·¨ç»„ä»¶å…±äº«ã€æŒä¹…åŒ–ï¼Œæˆ–éšç”Ÿå‘½å‘¨æœŸä¿æ´»</td></tr></tbody></table>
<h4 data-id="heading-12">2. çŠ¶æ€ä¸Šç§»ï¼šé¿å…å±€éƒ¨çŠ¶æ€è€¦åˆ</h4>
<ul>
<li>è‹¥å¤šä¸ªå­ç»„ä»¶éœ€è¦å…±äº«çŠ¶æ€ï¼ˆå¦‚â€œç™»å½•æŒ‰é’®â€å’Œâ€œé”™è¯¯æç¤ºâ€å…±äº« <code>isLoading</code>ï¼‰ï¼Œå°†çŠ¶æ€ä¸Šç§»åˆ°çˆ¶ç»„ä»¶/ViewModelï¼›</li>
<li>ç¤ºä¾‹ï¼šè¾“å…¥æ¡†å†…å®¹æ˜¯â€œå±€éƒ¨çŠ¶æ€â€ï¼Œä½†â€œç™»å½•æ˜¯å¦æˆåŠŸâ€æ˜¯â€œå…¨å±€ä¸šåŠ¡çŠ¶æ€â€ï¼Œéœ€æ”¾åœ¨ ViewModelã€‚</li>
</ul>
<h4 data-id="heading-13">3. ä¸å¯å˜çŠ¶æ€ï¼šç”¨ data class + copy æ›´æ–°</h4>
<ul>
<li>æ‰€æœ‰çŠ¶æ€æ•°æ®ç±»ï¼ˆå¦‚ <code>LoginUiState</code>ï¼‰è®¾è®¡ä¸ºä¸å¯å˜ï¼ˆvalï¼‰ï¼Œæ›´æ–°æ—¶é€šè¿‡ <code>copy</code> ç”Ÿæˆæ–°å¯¹è±¡ï¼›</li>
<li>åŸå› ï¼šCompose ä¾èµ–â€œçŠ¶æ€å¯¹è±¡å¼•ç”¨å˜åŒ–â€è§¦å‘é‡ç»„ï¼Œå¯å˜å¯¹è±¡ä¼šå¯¼è‡´é‡ç»„å¤±æ•ˆã€‚</li>
</ul>
<h4 data-id="heading-14">4. ç”Ÿå‘½å‘¨æœŸç»‘å®šï¼šç”¨ collectAsStateWithLifecycle</h4>
<ul>
<li>æ”¶é›† StateFlow æ—¶ï¼Œä¼˜å…ˆç”¨ <code>collectAsStateWithLifecycle()</code>ï¼ˆè€Œé <code>collectAsState()</code>ï¼‰ï¼Œè‡ªåŠ¨åœ¨ Activity/Fragment è¿›å…¥åå°æ—¶æš‚åœæ”¶é›†ï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚</li>
</ul>
<h3 data-id="heading-15">äº”ã€è¿›é˜¶ï¼šMVVM + Clean Architectureï¼ˆæ•´æ´æ¶æ„ï¼‰</h3>
<p>ä¸­å¤§å‹é¡¹ç›®å¯åœ¨ MVVM åŸºç¡€ä¸Šå¼•å…¥ Clean Architectureï¼Œè¿›ä¸€æ­¥åˆ†å±‚è§£è€¦ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Presentation å±‚ â”‚ UI + ViewModelï¼ˆä¸ MVVM ä¸€è‡´ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Domain å±‚       â”‚ ç”¨ä¾‹ï¼ˆUseCaseï¼‰+ é¢†åŸŸæ¨¡å‹ï¼ˆEntityï¼‰ï¼Œå°è£…æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚                 â”‚ ç¤ºä¾‹ï¼šLoginUseCase å°è£…â€œæ ¡éªŒå‚æ•° + è°ƒç”¨ä»“åº“ + å¤„ç†ç»“æœâ€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Data å±‚         â”‚ Repository + æ•°æ®æºï¼ˆç½‘ç»œ/æœ¬åœ°ï¼‰ï¼ŒDomain å±‚ä¸å…³å¿ƒæ•°æ®æ¥æº
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<p>æ ¸å¿ƒä¼˜åŠ¿ï¼šDomain å±‚å®Œå…¨ç‹¬ç«‹äº UI å’Œæ•°æ®å±‚ï¼Œä¸šåŠ¡é€»è¾‘å¯å•ç‹¬æµ‹è¯•ï¼Œä¸”æ˜“é€‚é…å¤šç«¯ï¼ˆå¦‚ Compose Multiplatform å¤ç”¨ Domain å±‚ï¼‰ã€‚</p>
<h3 data-id="heading-16">å…­ã€æ€»ç»“</h3>
<p>1.<strong>ä¸»æµæ¶æ„</strong>ï¼šCompose é¦–é€‰ã€ŒMVVM + å•å‘æ•°æ®æµã€ï¼Œæ˜¯å®˜æ–¹æ¨èã€é€‚é…æ€§æœ€å¥½çš„æ–¹æ¡ˆï¼›</p>
<p>2.<strong>çŠ¶æ€æµè½¬</strong>ï¼šUI è§¦å‘äº‹ä»¶ â†’ ViewModel å¤„ç† â†’ Repository è·å–æ•°æ® â†’ ViewModel æ›´æ–°çŠ¶æ€ â†’ UI é‡ç»„ï¼›</p>
<p>3.<strong>æ ¸å¿ƒè§„åˆ™</strong>ï¼šçŠ¶æ€åˆ†ç±»å­˜æ”¾ã€ä¸å¯å˜è®¾è®¡ã€ç”Ÿå‘½å‘¨æœŸç»‘å®šã€çŠ¶æ€ä¸Šç§»ï¼›</p>
<p>4.<strong>è¿›é˜¶ä¼˜åŒ–</strong>ï¼šä¸­å¤§å‹é¡¹ç›®åŠ  Clean Architecture çš„ Domain å±‚ï¼Œè§£è€¦ä¸šåŠ¡é€»è¾‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é¡¹ç›®å¤§æ‰«é™¤ç¥å™¨ï¼šKnip â€”â€” å°†ä½ çš„ä»£ç åº“â€œç˜¦èº«â€åˆ°åº•]]></title>    <link>https://juejin.cn/post/7582861402277609506</link>    <guid>https://juejin.cn/post/7582861402277609506</guid>    <pubDate>2025-12-13T03:34:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582861402277609506" data-draft-id="7582861402277593122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é¡¹ç›®å¤§æ‰«é™¤ç¥å™¨ï¼šKnip â€”â€” å°†ä½ çš„ä»£ç åº“â€œç˜¦èº«â€åˆ°åº•"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„,ä»£ç è§„èŒƒ"/> <meta itemprop="datePublished" content="2025-12-13T03:34:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å°˜ä¸–ä¸­ä¸€ä½è¿·é€”å°ä¹¦ç«¥"/> <meta itemprop="url" content="https://juejin.cn/user/3315782802490568"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é¡¹ç›®å¤§æ‰«é™¤ç¥å™¨ï¼šKnip â€”â€” å°†ä½ çš„ä»£ç åº“â€œç˜¦èº«â€åˆ°åº•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3315782802490568/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å°˜ä¸–ä¸­ä¸€ä½è¿·é€”å°ä¹¦ç«¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T03:34:18.000Z" title="Sat Dec 13 2025 03:34:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    39
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4121cbabaaf8414abd3325e75f5ad6b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5bCY5LiW5Lit5LiA5L2N6L-36YCU5bCP5Lmm56ul:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766218879&amp;x-signature=p8sFZ6jIQIcBg0P6Q7o9Tl92THU%3D" alt="image.png" loading="lazy"/></p>
<p>åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œéšç€é¡¹ç›®è¿­ä»£å‘¨æœŸçš„æ‹‰é•¿ï¼Œä»£ç åº“ä¸­å¾€å¾€ä¼šå †ç§¯è¶Šæ¥è¶Šå¤šçš„â€œåƒµå°¸ä»£ç â€ï¼šä¸å†ä½¿ç”¨çš„ç»„ä»¶ã€åºŸå¼ƒçš„å·¥å…·å‡½æ•°ã€é—ç•™åœ¨ <code>package.json</code> ä¸­çš„ä¾èµ–é¡¹â€¦â€¦è¿™äº›å†—ä½™ä¸ä»…å¢åŠ äº†é¡¹ç›®çš„ç»´æŠ¤æˆæœ¬ï¼Œæ‹–æ…¢äº†æ„å»ºé€Ÿåº¦ï¼Œè¿˜å¯èƒ½å› ä¸ºæœªåŠæ—¶æ›´æ–°çš„åºŸå¼ƒä¾èµ–å¸¦æ¥å®‰å…¨éšæ‚£ã€‚</p>
<p>é€šå¸¸æˆ‘ä»¬å¯èƒ½ä¼šç”¨ ESLint æ¥æ£€æŸ¥æœªä½¿ç”¨çš„å˜é‡ï¼Œæˆ–è€…æ‰‹åŠ¨å®šæœŸæ¸…ç†ã€‚ä½†å¯¹äºè·¨æ–‡ä»¶çš„æœªä½¿ç”¨å¯¼å‡ºã€æˆ–è€…æ•´ä¸ªæœªè¢«å¼•ç”¨çš„æ–‡ä»¶ï¼Œæ™®é€šçš„ Linter å¾€å¾€æ— èƒ½ä¸ºåŠ›ã€‚</p>
<p>ä»Šå¤©æˆ‘è¦ä»‹ç»çš„è¿™æ¬¾ç¥å™¨ â€”â€” <strong>Knip</strong>ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œç”Ÿçš„ã€‚å®ƒåƒä¸€æŠŠé”‹åˆ©çš„ç‘å£«å†›åˆ€ï¼Œèƒ½ç²¾å‡†åœ°åˆ‡å‰²æ‰ä½ é¡¹ç›®ä¸­çš„é‚£äº›â€œç´¯èµ˜â€ã€‚</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ Knipï¼Ÿ</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fknip.dev%2F" target="_blank" title="https://knip.dev/" ref="nofollow noopener noreferrer">Knip</a> æ˜¯ä¸€ä¸ªåŸºäº TypeScript ç¼–å†™çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸“é—¨ç”¨äºæŸ¥æ‰¾ JavaScript å’Œ TypeScript é¡¹ç›®ä¸­çš„<strong>æœªä½¿ç”¨æ–‡ä»¶ã€ä¾èµ–é¡¹å’Œå¯¼å‡º</strong>ã€‚</p>
<p>ä¸ä¼ ç»Ÿçš„ Linter ä¸åŒï¼ŒKnip ä¸ä»…ä»…ç›¯ç€å•ä¸ªæ–‡ä»¶çœ‹ï¼Œå®ƒä¼šåˆ†ææ•´ä¸ªé¡¹ç›®çš„ä¾èµ–å…³ç³»å›¾ã€‚è¿™æ„å‘³ç€å®ƒèƒ½å‘ç°é‚£äº›â€œè™½ç„¶è¢«å®šä¹‰äº†ä¸”æ²¡æœ‰è¯­æ³•é”™è¯¯ï¼Œä½†å®é™…ä¸Šä»æœªè¢«å…¶ä»–æ–‡ä»¶å¼•ç”¨è¿‡â€çš„å­¤ç«‹ä»£ç ã€‚</p>
<h2 data-id="heading-1">Knip çš„æ ¸å¿ƒç»æŠ€</h2>
<p>Knip çš„åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œä¸»è¦æ¶µç›–ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<h3 data-id="heading-2">1.  æŸ¥æ‰¾æœªä½¿ç”¨çš„æ–‡ä»¶ (Unused Files)</h3>
<p>å®ƒèƒ½æ‰¾å‡ºé¡¹ç›®ä¸­é‚£äº›é™é™èººç€å´ä»æœªè¢«å¯¼å…¥è¿‡çš„æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-3">2.  æŸ¥æ‰¾æœªä½¿ç”¨çš„ä¾èµ– (Unused Dependencies)</h3>
<p>å®ƒä¼šæ‰«æä½ çš„ <code>package.json</code>ï¼Œå‘Šè¯‰ä½ å“ªäº› <code>dependencies</code> å’Œ <code>devDependencies</code> å®é™…ä¸Šåœ¨ä»£ç ä¸­ä¸€æ¬¡éƒ½æ²¡ç”¨åˆ°ã€‚è¿™å¯¹äºæ¸…ç†é™ˆæ—§ä¾èµ–éå¸¸æœ‰å¸®åŠ©ã€‚</p>
<h3 data-id="heading-4">3.  æŸ¥æ‰¾æœªä½¿ç”¨çš„å¯¼å‡º (Unused Exports)</h3>
<p>è¿™æ˜¯ Knip æœ€æ€æ‰‹çº§çš„åŠŸèƒ½ã€‚é€šè¿‡åˆ†æå¯¼å…¥å¯¼å‡ºå…³ç³»ï¼Œå®ƒèƒ½æ‰¾å‡ºé‚£äº›è¢« <code>export</code> å‡ºæ¥ï¼Œä½†ä¸ä»…å½“å‰æ–‡ä»¶æ²¡ç”¨ï¼Œæ•´ä¸ªé¡¹ç›®å…¶ä»–åœ°æ–¹ä¹Ÿæ²¡ç”¨çš„å˜é‡ã€å‡½æ•°æˆ–ç±»ã€‚</p>
<h3 data-id="heading-5">4.  æŸ¥æ‰¾æœªåˆ—å‡ºçš„ä¾èµ– (Unlisted Dependencies)</h3>
<p>åè¿‡æ¥ï¼Œå®ƒä¹Ÿèƒ½å¸®ä½ å‘ç°é‚£äº›ä½ åœ¨ä»£ç é‡Œ <code>import</code> äº†ï¼Œä½†å¿˜è®°å†™åœ¨ <code>package.json</code> é‡Œçš„ä¾èµ–ï¼Œé¿å…ä¸Šçº¿åå› ä¸ºç¼ºåŒ…è€Œ crashã€‚</p>
<h3 data-id="heading-6">5.  å¼ºå¤§çš„ç”Ÿæ€æ”¯æŒ</h3>
<p>Knip å†…ç½®äº†å¯¹å„ç§ä¸»æµæ¡†æ¶å’Œå·¥å…·çš„æ’ä»¶æ”¯æŒï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š</p>
<ul>
<li>Next.js</li>
<li>Vite, Webpack, Rollup</li>
<li>Jest, Vitest</li>
<li>Tailwind CSS</li>
<li>Storybook</li>
<li>GitHub Actions ç­‰ç­‰</li>
</ul>
<p>è¿™æ„å‘³ç€å®ƒèƒ½ç†è§£è¿™äº›å·¥å…·çš„é…ç½®æ–‡ä»¶å’Œç‰¹å®šç”¨æ³•ï¼Œä¸ä¼šè¯¯æŠ¥ï¼ˆæ¯”å¦‚æŠŠ Next.js çš„ <code>pages</code> ç›®å½•ä¸‹çš„æ–‡ä»¶å½“æˆæœªä½¿ç”¨æ–‡ä»¶ï¼‰ã€‚</p>
<h2 data-id="heading-7">å¿«é€Ÿä¸Šæ‰‹</h2>
<h3 data-id="heading-8">å®‰è£…</h3>
<p>ä½ å¯ä»¥å°† Knip ä½œä¸ºå¼€å‘ä¾èµ–å®‰è£…åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm install -D knip typescript @types/node
<span class="hljs-comment"># æˆ–è€…</span>
yarn add -D knip typescript @types/node
<span class="hljs-comment"># æˆ–è€…</span>
pnpm add -D knip typescript @types/node
</code></pre>
<p><em>æ³¨æ„ï¼šKnip ä¾èµ– TypeScript è¿›è¡Œåˆ†æï¼Œå³ä½¿ä½ æ˜¯ JS é¡¹ç›®ä¹Ÿå»ºè®®å®‰è£…ã€‚</em></p>
<h3 data-id="heading-9">é…ç½® script</h3>
<p>åœ¨ <code>package.json</code> ä¸­æ·»åŠ ä¸€ä¸ªè„šæœ¬ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"scripts"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"knip"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"knip"</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 data-id="heading-10">è¿è¡Œ</h3>
<p>åœ¨ç»ˆç«¯æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm run knip
</code></pre>
<p>Knip ä¼šå¼€å§‹æ‰«æä½ çš„é¡¹ç›®ï¼Œå¹¶è¾“å‡ºä¸€ä»½è¯¦ç»†çš„æŠ¥å‘Šï¼Œåˆ—å‡ºæ‰€æœ‰ç–‘ä¼¼æœªä½¿ç”¨çš„é¡¹ç›®ã€‚</p>
<h2 data-id="heading-11">è¿›é˜¶é…ç½®</h2>
<p>è™½ç„¶ Knip å¾ˆæœ‰â€œçœ¼åŠ›è§â€ï¼Œèƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å¾ˆå¤šé…ç½®ï¼Œä½†å¯¹äºå¤æ‚çš„é¡¹ç›®ï¼Œä½ å¯èƒ½éœ€è¦ä¸€ä¸ª <code>knip.json</code> (æˆ– <code>knip.ts</code>, <code>knip.js</code>) é…ç½®æ–‡ä»¶æ¥å¾®è°ƒå®ƒçš„è¡Œä¸ºã€‚</p>
<p>ä¾‹å¦‚ï¼ŒæŒ‡å®šå…¥å£æ–‡ä»¶ï¼ˆEntry filesï¼‰å’Œå¿½ç•¥ç‰¹å®šçš„æ–‡ä»¶æˆ–ä¾èµ–ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"$schema"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://unpkg.com/knip@5/schema.json"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"entry"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"src/index.ts"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"src/cli.ts"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"project"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"src/**/*.ts!"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"ignore"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"src/legacy/**"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"ignoreDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"eslint-config-prettier"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"ignoreExportsUsedInFile"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li><code>entry</code>: å‘Šè¯‰ Knip ä»å“ªé‡Œå¼€å§‹åˆ†æä¾èµ–å›¾ã€‚é€šå¸¸æ˜¯ä½ çš„ <code>main</code> æ–‡ä»¶æˆ–é¡µé¢å…¥å£ã€‚</li>
<li><code>ignore</code>: å¿½ç•¥æŸäº›æ–‡ä»¶ä¸è¿›è¡Œæ£€æŸ¥ã€‚</li>
<li><code>ignoreDependencies</code>: æœ‰äº›ä¾èµ–å¯èƒ½æ˜¯å…¨å±€ä½¿ç”¨çš„æˆ–è€…é€šè¿‡ Babel æ’ä»¶æ³¨å…¥çš„ï¼ŒKnip ä¹Ÿå°±æ˜¯é™æ€åˆ†ææ‰«ä¸åˆ°ï¼Œå¯ä»¥åœ¨è¿™é‡Œå¿½ç•¥ä»¥æ¶ˆé™¤è¯¯æŠ¥ã€‚</li>
</ul>
<h2 data-id="heading-12">æœ€ä½³å®è·µå·¥ä½œæµ</h2>
<ol>
<li><strong>åˆæ¬¡æ‰«æ</strong>ï¼šè¿è¡Œ <code>knip</code>ï¼Œä½ ä¼šå¤§æ¦‚ç‡è¢«å“ä¸€è·³ï¼ˆç”šè‡³æœ‰æˆç™¾ä¸Šåƒä¸ªæŠ¥é”™ï¼‰ã€‚ä¸è¦æ…Œï¼Œè¿™å¾ˆæ­£å¸¸ã€‚</li>
<li><strong>æ’é™¤è¯¯æŠ¥</strong>ï¼šä»”ç»†æ£€æŸ¥æŠ¥å‘Šã€‚å¦‚æœæ˜¯å·¥å…·é…ç½®ï¼ˆå¦‚ Jest é…ç½®ã€Webpack é…ç½®ï¼‰è¢«è¯¯æŠ¥ï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦å¯ç”¨å¯¹åº”çš„ Knip æ’ä»¶æˆ–åœ¨ <code>knip.json</code> ä¸­é…ç½®å…¥å£ã€‚</li>
<li><strong>é€æ­¥æ¸…ç†</strong>ï¼š
<ul>
<li><strong>å…ˆåˆ æ–‡ä»¶</strong>ï¼šæœªä½¿ç”¨çš„æ–‡ä»¶æ˜¯æœ€å®¹æ˜“ç¡®è®¤å’Œåˆ é™¤çš„ã€‚</li>
<li><strong>å†åˆ ä¾èµ–</strong>ï¼šç¡®è®¤ <code>package.json</code> ä¸­æœªä½¿ç”¨çš„ä¾èµ–ï¼Œå¸è½½å®ƒä»¬ã€‚</li>
<li><strong>æœ€åå¤„ç†å¯¼å‡º</strong>ï¼šå¯¹äºæœªä½¿ç”¨çš„ <code>export</code>ï¼Œä½ å¯ä»¥é€‰æ‹©åˆ é™¤å¯¼å‡ºå…³é”®å­—å˜æˆå±€éƒ¨å˜é‡ï¼Œæˆ–è€…ç›´æ¥åˆ é™¤è¯¥å‡½æ•°ã€‚</li>
</ul>
</li>
<li><strong>CI é›†æˆ</strong>ï¼šå°† <code>knip</code> åŠ å…¥åˆ°ä½ çš„ CI æµç¨‹ä¸­ï¼ˆå¦‚ GitHub Actionsï¼‰ã€‚è¿™æ ·æ¯æ¬¡æäº¤ MR æ—¶ï¼ŒKnip éƒ½ä¼šè‡ªåŠ¨æ£€æŸ¥ï¼Œé˜²æ­¢æ–°çš„â€œåƒåœ¾ä»£ç â€æ··å…¥ä¸»åˆ†æ”¯ã€‚</li>
</ol>
<h2 data-id="heading-13">æ€»ç»“</h2>
<p>ä»£ç åº“çš„ç»´æŠ¤å°±åƒæ‰“æ‰«æˆ¿é—´ï¼Œä¸ä»…è¦å‹¤æ‹‚æ‹­ï¼Œæ›´è¦å®šæœŸâ€œæ–­èˆç¦»â€ã€‚Knip ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¸Šå¸è§†è§’ï¼Œè®©æˆ‘ä»¬èƒ½æ¸…æ™°åœ°çœ‹åˆ°é¡¹ç›®ä¸­é‚£äº›è¢«é—å¿˜çš„è§’è½ã€‚</p>
<p>å»ºè®®å¤§å®¶éƒ½åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­è¯•è¿è¡Œä¸€ä¸‹ Knipï¼Œç›¸ä¿¡æˆ‘ï¼Œå®ƒä¸€å®šä¼šç»™ä½ å¸¦æ¥â€œæƒŠå–œâ€ï¼ˆæˆ–è€…æ˜¯æƒŠå“ï¼Œå“ˆå“ˆï¼‰ã€‚è®©æˆ‘ä»¬çš„é¡¹ç›®ä¿æŒè½»é‡ã€æ•´æ´ï¼Œä»ä½¿ç”¨ Knip å¼€å§‹ï¼</p>
<hr/>
<p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p>
<ul>
<li>Knip å®˜æ–¹æ–‡æ¡£: <a href="https://link.juejin.cn?target=https%3A%2F%2Fknip.dev%2F" target="_blank" title="https://knip.dev/" ref="nofollow noopener noreferrer">knip.dev/</a></li>
<li>Knip GitHub ä»“åº“: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fwebpro%2Fknip" target="_blank" title="https://github.com/webpro/knip" ref="nofollow noopener noreferrer">github.com/webpro/knip</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åˆ«å·æ¨¡å‹äº†ï¼ä¸Šä¸‹æ–‡å·¥ç¨‹æ‰æ˜¯å¤§æ¨¡å‹åº”ç”¨çš„ç‹é“ï¼]]></title>    <link>https://juejin.cn/post/7582857981894131753</link>    <guid>https://juejin.cn/post/7582857981894131753</guid>    <pubDate>2025-12-13T07:10:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582857981894131753" data-draft-id="7582787460419502122" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åˆ«å·æ¨¡å‹äº†ï¼ä¸Šä¸‹æ–‡å·¥ç¨‹æ‰æ˜¯å¤§æ¨¡å‹åº”ç”¨çš„ç‹é“ï¼"/> <meta itemprop="keywords" content="é¢è¯•,Java,åç«¯"/> <meta itemprop="datePublished" content="2025-12-13T07:10:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜é£é±¼"/> <meta itemprop="url" content="https://juejin.cn/user/1665088861772688"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åˆ«å·æ¨¡å‹äº†ï¼ä¸Šä¸‹æ–‡å·¥ç¨‹æ‰æ˜¯å¤§æ¨¡å‹åº”ç”¨çš„ç‹é“ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1665088861772688/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜é£é±¼
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T07:10:25.000Z" title="Sat Dec 13 2025 07:10:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{line-height:1.75;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;letter-spacing:2px;background-image:linear-gradient(90deg,rgba(50,0,0,.05) 3%,transparent 0),linear-gradient(1turn,rgba(50,0,0,.05) 3%,transparent 0);background-size:20px 20px;background-position:50%;word-break:break-word;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body h1{font-size:23px;margin-bottom:5px;font-weight:700;padding-left:10px;border-left:5px solid #773098}.markdown-body h2{font-size:19px;font-weight:700;padding-left:10px;border-left:5px solid #916dd5}.markdown-body h3{font-size:17px;font-weight:700;padding-left:10px;border-left:5px solid #d89cf6}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{font-size:14px;margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;max-width:100%;margin:1em 0;border-radius:6px;box-shadow:2px 4px 7px #999;user-select:none}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{padding:.2em .5em;font-weight:700;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-size:1em;color:#916dd5;word-break:break-word;overflow-x:auto;background-color:none;border-radius:2px}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;font-family:-apple-system-font,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei UI,Microsoft YaHei,Arial,sans-serif;font-weight:400;font-size:.9em;padding:16px 12px;margin:0;color:#333;word-break:normal;overflow-x:auto;background:#f8f8f8;scroll-behavior:smooth}.markdown-body a{text-decoration:none;color:#916dd5;font-weight:700;border-bottom:1px solid #916dd5}.markdown-body a:active,.markdown-body a:hover{color:#773098}.markdown-body table{display:inline-block!important;font-size:14px;width:auto;max-width:100%;overflow:auto;border:1px solid #916dd5;border-collapse:collapse}.markdown-body thead{background-color:#916dd5;color:#fff;text-align:left}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px;border:1px solid #916dd5}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #d89cf6;background-color:#f4eeff}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0;line-height:26px}.markdown-body ol,.markdown-body ul{padding-left:28px;list-style-type:circle}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{color:#916dd5;font-weight:700}.markdown-body b:before,.markdown-body strong:before{content:"ã€Œ"}.markdown-body b:after,.markdown-body strong:after{content:"ã€"}.markdown-body em,.markdown-body i{color:#916dd5}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="github-gist">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#fff;color:#333}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#d73a49}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-symbol{color:#0086b3}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#6f42c1}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.hljs-number{color:#005cc5}.hljs-string{color:#032f62}</style><p>ç°åœ¨å·²ç»æ˜¯AIæ—¶ä»£äº†ï¼Œæˆ‘ä¹‹å‰å­¦è¿‡ä¸€äº›AIçš„ä¸œè¥¿ï¼Œæ‰€ä»¥åç»­å¼€å§‹åˆ†äº«ä¸€äº›AIç›¸å…³çš„å†…å®¹äº†ã€‚</p>
<blockquote>
<p>å¦‚AIå·¥å…·ï¼ŒAIç§‘æ™®ï¼ŒAIæœ€æ–°æŠ€æœ¯ç­‰ç­‰ï¼Œå¤§å®¶ä¸€èµ·æ‹¥æŠ±AIï¼Œå­¦ä¹ AIï¼Œåˆ©ç”¨AIã€‚</p>
</blockquote>
<p><strong>æ–‡ç« å†…å®¹æ”¶å½•åˆ°ä¸ªäººç½‘ç«™ï¼Œæ–¹ä¾¿é˜…è¯»</strong>ï¼š<a href="https://link.juejin.cn?target=http%3A%2F%2Fhardyfish.top%2F" target="_blank" title="http://hardyfish.top/" ref="nofollow noopener noreferrer">hardyfish.top/</a></p>
<p>å¯¹äºå¤§å¤šæ•°äººæ¥è¯´ï¼Œå¤„ç†å¤§é‡çš„æç¤ºè¯éå¸¸ä»¤äººå¤´ç–¼ï¼Œå‡ ä¹æ²¡äººæ„¿æ„èŠ±è´¹å¤§é‡çš„æ—¶é—´å»ç²¾å¿ƒè®¾è®¡è¿™äº›è¯ã€‚</p>
<blockquote>
<p>ç”¨æˆ·æ›´å€¾å‘äºç”¨ä¸€å¥è¯ã€ä¸€ä¸ªç®€å•æŒ‡ä»¤ï¼Œæ¥è¡¨è¾¾éœ€æ±‚ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸Šä¸‹æ–‡å·¥ç¨‹åšçš„äº‹æƒ…å°±æ˜¯åŸºäºç”¨æˆ·çš„<strong>ä¸Šä¸‹æ–‡</strong>æ¥è¡¥å……ä¿¡æ¯ã€‚</p>
</blockquote>
<p>ä½†è¿™é‡Œçš„ä¸Šä¸‹æ–‡ä¸å¤§æ¨¡å‹çš„ä¸Šä¸‹æ–‡ç»´åº¦æœ‰æ‰€ä¸åŒï¼š</p>
<blockquote>
<p>å¤§æ¨¡å‹çš„ä¸Šä¸‹æ–‡é€šå¸¸æ˜¯åŸºäºå•æ¬¡è¾“å…¥çš„ä¸Šä¸‹æ–‡ï¼Œè€Œ<strong>è¿™é‡Œæ‰€æŒ‡çš„ä¸Šä¸‹æ–‡åˆ™æ˜¯ç”¨æˆ·çš„å…¨éƒ¨å†å²æ•°æ®</strong>ã€‚</p>
<ul>
<li>ç”šè‡³å¯èƒ½è¿½æº¯åˆ°ç”¨æˆ·æœ€åˆä½¿ç”¨å¹³å°æ—¶çš„æ•°æ®ã€‚</li>
</ul>
<p>åœ¨ä¸Šä¸‹æ–‡çš„å¤„ç†ä¸Šï¼Œé€šå¸¸é‡‡ç”¨çš„æ–¹å¼å¤§ä½“ç›¸ä¼¼ï¼ŒåŒ…æ‹¬æ£€ç´¢å¬å›ã€çŸ¥è¯†åº“ã€å‘é‡åº“ã€çŸ¥è¯†å›¾è°±ç­‰ã€‚</p>
<ul>
<li>ä½†å…³é”®é—®é¢˜åœ¨äºå¦‚ä½•é«˜æ•ˆåœ°åˆ©ç”¨å’Œæ•´åˆè¿™äº›æ•°æ®ã€‚</li>
</ul>
</blockquote>
<p><strong>é‚£ç°åœ¨åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„èŠå¤©åº”ç”¨ä¸­çš„ä¸Šä¸‹æ–‡æ˜¯æ€ä¹ˆå¤„ç†çš„?</strong></p>
<blockquote>
<p>å¤§æ¨¡å‹ä½œä¸ºçº¯ç²¹çš„æ¨ç†å¼•æ“ï¼Œä¸è®°ä½ä»»ä½•å†å²ä¿¡æ¯ã€‚</p>
<ul>
<li>åº”ç”¨å±‚è´Ÿè´£ç»´æŠ¤å®Œæ•´çš„å¯¹è¯å†å²ã€‚</li>
</ul>
<p>æ¯æ¬¡å‘æ¨¡å‹å‘èµ·è¯·æ±‚æ—¶ï¼Œéƒ½éœ€è¦æºå¸¦å®Œæ•´çš„ä¸Šä¸‹æ–‡ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1fcc53a841dd4152b877da0c820cb37b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6aOe6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766214624&amp;x-signature=uCoSG5W78WirR0DkH0QmpSETzhQ%3D" alt="" loading="lazy"/></p>
<p>ä½†å½“åº”ç”¨åœºæ™¯æ˜¯ Agentic AI æ—¶ï¼Œä¸Šä¸‹æ–‡ç®¡ç†çš„å¤æ‚åº¦ä¼šå¾ˆé«˜ã€‚</p>
<blockquote>
<p>Agentic AI å…·å¤‡ä»»åŠ¡åˆ†è§£ã€å¤šæ­¥éª¤æ‰§è¡Œã€è‡ªä¸»æ€è€ƒå’Œå·¥å…·è°ƒç”¨ç­‰é«˜çº§èƒ½åŠ›ã€‚</p>
<p>è¿™äº›èƒ½åŠ›çš„å®ç°éƒ½ä¾èµ–äºæ›´åŠ ä¸°å¯Œå’Œå¤æ‚çš„ä¸Šä¸‹æ–‡ç»“æ„ã€‚</p>
</blockquote>
<p><strong>æ¯”å¦‚å•Agentåœºæ™¯</strong></p>
<blockquote>
<p>å‡è®¾ä¸€ä¸ªä»»åŠ¡è¢« Agent åˆ†è§£æˆäº† 10 ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡éœ€è¦è°ƒç”¨ä¸¤æ¬¡å·¥å…·æ‰èƒ½å®Œæˆã€‚</p>
<p>é‚£ä¹ˆè¿™ä¸ªå¤§ä»»åŠ¡æ€»å…±ä¼šäº§ç”Ÿ 41 æ¡æ–°å¢çš„ä¸Šä¸‹æ–‡è®°å½•ï¼š</p>
<ul>
<li>1 æ¡åˆå§‹çš„ä»»åŠ¡åˆ†è§£æ€è€ƒï¼ŒåŠ ä¸Š 10 ä¸ªå­ä»»åŠ¡å„è‡ªäº§ç”Ÿçš„ 4 æ¡è®°å½•ï¼ˆ1 æ¬¡å·¥å…·è°ƒç”¨è¯·æ±‚ + 1 æ¬¡å·¥å…·è°ƒç”¨è¿”å›ï¼Œé‡å¤ä¸¤æ¬¡ï¼‰ã€‚</li>
</ul>
</blockquote>
<p>é‚£ç›®å‰ä¸šç•Œæ˜¯å¦‚ä½•åœ¨ Agent åº”ç”¨ä¸Šç®¡ç†ä¸Šä¸‹æ–‡çš„å‘¢ï¼Ÿ</p>
<blockquote>
<p>ä¸Šä¸‹æ–‡ä¼˜åŒ–å™¨ä¼šæ ¹æ®å½“å‰ç”¨æˆ·è¾“å…¥ã€ä»»åŠ¡ç›®æ ‡å’Œæ¨¡å‹çŠ¶æ€å†³å®šæ˜¯å¦è¿›è¡Œå‹ç¼©ã€‚</p>
<p>è¿˜æœ‰é‡‡ç”¨ä½•ç§å‹ç¼©ç­–ç•¥ã€ä¸¢å¼ƒå“ªäº›å†…å®¹ã€å­˜å‚¨ä¸ºè®°å¿†ï¼Œä»¥åŠä½•æ—¶è¿›è¡Œè®°å¿†å›å¡«ç­‰æ“ä½œã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b858d928c1384112b1b5ae6aa7329c00~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56iL5bqP5ZGY6aOe6bG8:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766214624&amp;x-signature=7bt4ZmYGww3iMP1%2BOLla8h3MFX4%3D" alt="" loading="lazy"/></p>
<p><strong>Context Engineeringçš„å…·ä½“å®ç°æ–¹æ³•ï¼ˆå‚è€ƒLangChainï¼‰</strong></p>
<p>ä¿å­˜Contextï¼š</p>
<blockquote>
<p>å°†Contextç­›é€‰æ€»ç»“åä¿å­˜åˆ°å†…å­˜ã€ç¡¬ç›˜ç­‰åœ°æ–¹ï¼Œåœ¨æ¨¡å‹éœ€è¦æ—¶å†å‘é€ç»™å®ƒã€‚</p>
<p>å¦‚ChatGPTçš„è®°å¿†åŠŸèƒ½ï¼Œå¯å°†ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯å­˜å…¥è®°å¿†åº“ã€‚</p>
</blockquote>
<p>é€‰æ‹©Contextï¼š</p>
<blockquote>
<p>é™æ€é€‰æ‹©ï¼šæŠŠæ°¸è¿œé‡è¦ã€å¿…é¡»éµå®ˆçš„ä¿¡æ¯åœ¨æ¯æ¬¡è¯·æ±‚æ—¶éƒ½æ”¾å…¥Contextã€‚</p>
<ul>
<li>å¦‚Cursorçš„Rulesæ–‡ä»¶ã€Claude Codeçš„Claude.mdæ–‡ä»¶ï¼Œç¡®ä¿AIè¡Œä¸ºç¬¦åˆé¢„æœŸã€‚</li>
</ul>
<p>åŠ¨æ€é€‰æ‹©ï¼šé€‰æ‹©ä¸ç”¨æˆ·é—®é¢˜æœ€ç›¸å…³çš„å†…å®¹æ”¾å…¥Contextã€‚</p>
<p>å¦‚ChatGPTä»è®°å¿†åº“ä¸­æŒ‘é€‰ç›¸å…³è®°å¿†ï¼Œä»ä¼—å¤šå·¥å…·ä¸­æŒ‘é€‰ç›¸å…³å·¥å…·ã€‚</p>
<ul>
<li>å…¶ä¸­æœ€æœ‰åçš„å®ç°æ–¹å¼æ˜¯Ragã€‚</li>
</ul>
</blockquote>
<p>å‹ç¼©Contextï¼š</p>
<blockquote>
<p>Agentè¿è¡Œæ—¶ï¼ŒContexté‡Œä¼šç§¯ç´¯å¤§é‡å†å²æ¶ˆæ¯ï¼Œæœ€å ç©ºé—´çš„æ˜¯æ¨¡å‹è¾“å‡ºã€æ–‡æœ¬å’Œå·¥å…·æ‰§è¡Œç»“æœã€‚</p>
<p>Claude Codeåœ¨ä½¿ç”¨é‡è¶…è¿‡95%æ—¶ï¼Œä¼šè¿è¡ŒAutocomPactç¨‹åºå¯¹Contextè¿›è¡Œå‹ç¼©ã€‚</p>
</blockquote>
<p>éš”ç¦»Contextï¼š</p>
<blockquote>
<p>ä¸åŒæ¨¡å—çš„Contextäº’ç›¸éš”ç¦»ã€‚</p>
<p>Lead Agentè´Ÿè´£ä»»åŠ¡ä¸‹å‘å’Œå½’çº³æ€»ç»“ï¼ŒSub Agentæœ‰ç‹¬ç«‹çš„å·¥å…·ã€è¿è¡Œå†å²å’Œè®°å¿†ä½“ç³»ï¼ŒContextäº’ä¸å½±å“ã€‚</p>
<p>Claude Codeä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„SubAgentæ¦‚å¿µã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å¸¸ç”¨æ¨¡å¼ï¼šæå‡ä»£ç è´¨é‡çš„å››å¤§æ ¸å¿ƒæ¨¡å¼]]></title>    <link>https://juejin.cn/post/7583139562735190059</link>    <guid>https://juejin.cn/post/7583139562735190059</guid>    <pubDate>2025-12-13T05:00:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583139562735190059" data-draft-id="7582787460419321898" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å¸¸ç”¨æ¨¡å¼ï¼šæå‡ä»£ç è´¨é‡çš„å››å¤§æ ¸å¿ƒæ¨¡å¼"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2025-12-13T05:00:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="1024è‚¥å®…"/> <meta itemprop="url" content="https://juejin.cn/user/588993964030574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å¸¸ç”¨æ¨¡å¼ï¼šæå‡ä»£ç è´¨é‡çš„å››å¤§æ ¸å¿ƒæ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/588993964030574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    1024è‚¥å®…
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T05:00:57.000Z" title="Sat Dec 13 2025 05:00:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">å¼•è¨€</h4>
<p>åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œéšç€åº”ç”¨å¤æ‚åº¦ä¸æ–­å¢åŠ ï¼Œä»£ç çš„ç»„ç»‡å’Œç®¡ç†å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å‰ç«¯å¼€å‘ä¸­å››ç§æå…¶æœ‰ç”¨çš„æ¨¡å¼ï¼šä¸­é—´ä»¶æ¨¡å¼ã€ç®¡é“æ¨¡å¼ã€é“¾å¼è°ƒç”¨å’Œæƒ°æ€§åŠ è½½ã€‚è¿™äº›æ¨¡å¼ä¸ä»…èƒ½æé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œè¿˜èƒ½æ˜¾è‘—ä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚</p>
<h4 data-id="heading-1">ä¸€ã€ä¸­é—´ä»¶æ¨¡å¼ï¼ˆMiddleware Patternï¼‰</h4>
<p>ä¸­é—´ä»¶æ¨¡å¼å…è®¸æˆ‘ä»¬åœ¨è¯·æ±‚å’Œå“åº”çš„å¤„ç†æµç¨‹ä¸­æ’å…¥å¤šä¸ªå¤„ç†é˜¶æ®µ, è¿™ç§æ¨¡å¼åœ¨Node.jsæ¡†æ¶(ä¾‹å¦‚Koaã€Express)ä¸­å¹¿æ³›åº”ç”¨, ä½†åœ¨å‰ç«¯åŒæ ·æœ‰å…¶ç”¨æ­¦ä¹‹åœ°ã€‚</p>
<h5 data-id="heading-2">1.1 æ ¸å¿ƒæ¦‚å¿µ</h5>
<p>ä¸­é—´ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°, å®ƒå¯ä»¥:</p>
<ul>
<li>è®¿é—®è¯·æ±‚(request)å’Œå“åº”(response)å¯¹è±¡</li>
<li>æ‰§è¡Œä»»ä½•ä»£ç </li>
<li>ä¿®æ”¹è¯·æ±‚å’Œå“åº”å¯¹è±¡</li>
<li>ç»“æŸè¯·æ±‚-å“åº”å‘¨æœŸ</li>
<li>è°ƒç”¨ä¸‹ä¸€ä¸ªä¸­é—´ä»¶</li>
</ul>
<h5 data-id="heading-3">1.2 åŸºç¡€å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç®€å•ä¸­é—´ä»¶ç³»ç»Ÿå®ç°</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">MiddlewareSystem</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = {};
  }

  <span class="hljs-comment">// æ·»åŠ ä¸­é—´ä»¶</span>
  <span class="hljs-title function_">use</span>(<span class="hljs-params">middleware</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> middleware !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Middleware must be a function'</span>);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span>.<span class="hljs-title function_">push</span>(middleware);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>; <span class="hljs-comment">// æ”¯æŒé“¾å¼è°ƒç”¨</span>
  }

  <span class="hljs-comment">// æ‰§è¡Œä¸­é—´ä»¶</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">input</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = { ...input };
    
    <span class="hljs-comment">// åˆ›å»ºnextå‡½æ•°</span>
    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">next</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> middleware = <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span>[index++];
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">middleware</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, next);
      }
    };
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Middleware execution error:'</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> system = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MiddlewareSystem</span>();

<span class="hljs-comment">// æ·»åŠ ä¸­é—´ä»¶</span>
system
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Middleware 1: Start'</span>);
    ctx.<span class="hljs-property">timestamp</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Middleware 1: End'</span>);
  })
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Middleware 2: Start'</span>);
    ctx.<span class="hljs-property">user</span> = { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span> };
    <span class="hljs-comment">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, <span class="hljs-number">100</span>));
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Middleware 2: End'</span>);
  })
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Middleware 3: Start'</span>);
    ctx.<span class="hljs-property">data</span> = { <span class="hljs-attr">message</span>: <span class="hljs-string">'Hello World'</span> };
    <span class="hljs-comment">// ä¸å†è°ƒç”¨next()ï¼Œç»“æŸæ‰§è¡Œ</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Middleware 3: End (no next call)'</span>);
  });

<span class="hljs-comment">// è¿è¡Œä¸­é—´ä»¶</span>
system.<span class="hljs-title function_">run</span>({ <span class="hljs-attr">requestId</span>: <span class="hljs-string">'123'</span> }).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Final context:'</span>, result);
});
</code></pre>
<h5 data-id="heading-4">1.3 é”™è¯¯å¤„ç†ä¸­é—´ä»¶</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorHandlingMiddleware</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMiddlewares</span> = [];
  }

  <span class="hljs-title function_">use</span>(<span class="hljs-params">middleware</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span>.<span class="hljs-title function_">push</span>(middleware);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">useError</span>(<span class="hljs-params">errorMiddleware</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMiddlewares</span>.<span class="hljs-title function_">push</span>(errorMiddleware);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">input</span>) {
    <span class="hljs-keyword">const</span> context = { ...input };
    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> errorIndex = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> error = <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">next</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">err</span>) =&gt; {
      <span class="hljs-keyword">if</span> (err) {
        error = err;
        errorIndex = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-title function_">nextError</span>();
      }

      <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> middleware = <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span>[index++];
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">await</span> <span class="hljs-title function_">middleware</span>(context, next);
        } <span class="hljs-keyword">catch</span> (err) {
          <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>(err);
        }
      }
    };

    <span class="hljs-keyword">const</span> <span class="hljs-title function_">nextError</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (errorIndex &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMiddlewares</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> errorMiddleware = <span class="hljs-variable language_">this</span>.<span class="hljs-property">errorMiddlewares</span>[errorIndex++];
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">await</span> <span class="hljs-title function_">errorMiddleware</span>(error, context, nextError);
        } <span class="hljs-keyword">catch</span> (err) {
          error = err;
          <span class="hljs-keyword">await</span> <span class="hljs-title function_">nextError</span>();
        }
      }
    };

    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
    <span class="hljs-keyword">return</span> { context, error };
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> errorSystem = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ErrorHandlingMiddleware</span>();

errorSystem
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Processing...'</span>);
    <span class="hljs-comment">// æ¨¡æ‹Ÿé”™è¯¯</span>
    <span class="hljs-keyword">if</span> (!ctx.<span class="hljs-property">user</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'User not found'</span>);
    }
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
  })
  .<span class="hljs-title function_">useError</span>(<span class="hljs-keyword">async</span> (err, ctx, next) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Error caught:'</span>, err.<span class="hljs-property">message</span>);
    ctx.<span class="hljs-property">error</span> = err.<span class="hljs-property">message</span>;
    ctx.<span class="hljs-property">status</span> = <span class="hljs-string">'error'</span>;
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
  });

errorSystem.<span class="hljs-title function_">run</span>({}).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Result with error handling:'</span>, result);
});
</code></pre>
<h5 data-id="heading-5">1.4 å‰ç«¯åº”ç”¨åœºæ™¯</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å‰ç«¯è¯·æ±‚æ‹¦æˆªä¸­é—´ä»¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RequestInterceptor</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultConfig</span> = {
      <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span>,
      <span class="hljs-attr">headers</span>: {}
    };
  }

  <span class="hljs-title function_">use</span>(<span class="hljs-params">interceptor</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-title function_">push</span>(interceptor);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">url, config = {}</span>) {
    <span class="hljs-keyword">const</span> context = {
      url,
      <span class="hljs-attr">config</span>: { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultConfig</span>, ...config },
      <span class="hljs-attr">response</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>
    };

    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">next</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (index &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span>.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> interceptor = <span class="hljs-variable language_">this</span>.<span class="hljs-property">interceptors</span>[index++];
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">interceptor</span>(context, next);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æ‰§è¡Œå®é™…è¯·æ±‚</span>
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeRequest</span>(context);
      }
    };

    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
    <span class="hljs-keyword">return</span> context;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">executeRequest</span>(<span class="hljs-params">context</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(context.<span class="hljs-property">url</span>, context.<span class="hljs-property">config</span>);
      context.<span class="hljs-property">response</span> = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    } <span class="hljs-keyword">catch</span> (error) {
      context.<span class="hljs-property">error</span> = error;
    }
  }
}

<span class="hljs-comment">// åˆ›å»ºè¯·æ±‚æ‹¦æˆªå™¨</span>
<span class="hljs-keyword">const</span> api = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestInterceptor</span>();

api
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Auth interceptor'</span>);
    ctx.<span class="hljs-property">config</span>.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-variable language_">localStorage</span>.getItem(<span class="hljs-string">'token'</span>)}</span>`</span>;
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
  })
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Logging interceptor'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Request to <span class="hljs-subst">${ctx.url}</span>`</span>, ctx.<span class="hljs-property">config</span>);
    <span class="hljs-keyword">const</span> start = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
    <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - start;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Request completed in <span class="hljs-subst">${duration}</span>ms`</span>);
  })
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Cache interceptor'</span>);
    <span class="hljs-keyword">const</span> cacheKey = <span class="hljs-string">`cache_<span class="hljs-subst">${ctx.url}</span>`</span>;
    <span class="hljs-keyword">const</span> cached = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(cacheKey);
    
    <span class="hljs-keyword">if</span> (cached &amp;&amp; !ctx.<span class="hljs-property">config</span>.<span class="hljs-property">noCache</span>) {
      ctx.<span class="hljs-property">response</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(cached);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Using cached response'</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
      <span class="hljs-keyword">if</span> (ctx.<span class="hljs-property">response</span> &amp;&amp; !ctx.<span class="hljs-property">error</span>) {
        <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">setItem</span>(cacheKey, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(ctx.<span class="hljs-property">response</span>));
      }
    }
  });

<span class="hljs-comment">// ä½¿ç”¨æ‹¦æˆªå™¨</span>
api.<span class="hljs-title function_">request</span>(<span class="hljs-string">'https://api.example.com/data'</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span> })
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Response:'</span>, result.<span class="hljs-property">response</span>));
</code></pre>
<h4 data-id="heading-6">äºŒã€ç®¡é“æ¨¡å¼ï¼ˆPipeline Patternï¼‰</h4>
<p>ç®¡é“æ¨¡å¼å°†å¤šä¸ªå¤„ç†å‡½æ•°è¿æ¥èµ·æ¥, æ•°æ®åƒæµæ°´ä¸€æ ·ç»è¿‡è¿™äº›å‡½æ•°è¿›è¡Œå¤„ç†å’Œè½¬æ¢ã€‚</p>
<h5 data-id="heading-7">2.1 åŸºæœ¬å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŒæ­¥ç®¡é“</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">pipeline</span> = (<span class="hljs-params">...fns</span>) =&gt; <span class="hljs-function">(<span class="hljs-params">initialValue</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> fns.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">value, fn</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fn !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Pipeline expects functions, got <span class="hljs-subst">${<span class="hljs-keyword">typeof</span> fn}</span>`</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fn</span>(value);
  }, initialValue);
};

<span class="hljs-comment">// å¼‚æ­¥ç®¡é“</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">asyncPipeline</span> = (<span class="hljs-params">...fns</span>) =&gt; <span class="hljs-keyword">async</span> (initialValue) =&gt; {
  <span class="hljs-keyword">let</span> result = initialValue;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> fn <span class="hljs-keyword">of</span> fns) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> fn !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Pipeline expects functions, got <span class="hljs-subst">${<span class="hljs-keyword">typeof</span> fn}</span>`</span>);
    }
    result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fn</span>(result);
  }
  <span class="hljs-keyword">return</span> result;
};

<span class="hljs-comment">// å¯ä¸­æ–­çš„ç®¡é“</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">breakablePipeline</span> = (<span class="hljs-params">...fns</span>) =&gt; <span class="hljs-function">(<span class="hljs-params">initialValue</span>) =&gt;</span> {
  <span class="hljs-keyword">let</span> shouldBreak = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">let</span> breakValue = <span class="hljs-literal">null</span>;
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">breakFn</span> = (<span class="hljs-params">value</span>) =&gt; {
    shouldBreak = <span class="hljs-literal">true</span>;
    breakValue = value;
  };
  
  <span class="hljs-keyword">const</span> result = fns.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">value, fn</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (shouldBreak) <span class="hljs-keyword">return</span> breakValue;
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fn</span>(value, breakFn);
  }, initialValue);
  
  <span class="hljs-keyword">return</span> shouldBreak ? breakValue : result;
};
</code></pre>
<h5 data-id="heading-8">2.2 æ•°æ®å¤„ç†ç®¡é“ç¤ºä¾‹</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ•°æ®æ¸…æ´—ç®¡é“</span>
<span class="hljs-keyword">const</span> dataCleaningPipeline = <span class="hljs-title function_">pipeline</span>(
  <span class="hljs-comment">// 1. ç§»é™¤ç©ºå€¼</span>
  <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> data.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item != <span class="hljs-literal">null</span>),
  
  <span class="hljs-comment">// 2. æ ‡å‡†åŒ–å­—æ®µ</span>
  <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> data.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> ({
    ...item,
    <span class="hljs-attr">name</span>: item.<span class="hljs-property">name</span>?.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">toLowerCase</span>() || <span class="hljs-string">'unknown'</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-title class_">Number</span>(item.<span class="hljs-property">value</span>) || <span class="hljs-number">0</span>
  })),
  
  <span class="hljs-comment">// 3. å»é‡</span>
  <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();
    <span class="hljs-keyword">return</span> data.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${item.name}</span>-<span class="hljs-subst">${item.value}</span>`</span>;
      <span class="hljs-keyword">if</span> (seen.<span class="hljs-title function_">has</span>(key)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      seen.<span class="hljs-title function_">add</span>(key);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    });
  },
  
  <span class="hljs-comment">// 4. æ’åº</span>
  <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> data.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.<span class="hljs-property">value</span> - a.<span class="hljs-property">value</span>),
  
  <span class="hljs-comment">// 5. é™åˆ¶æ•°é‡</span>
  <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> data.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">10</span>)
);

<span class="hljs-comment">// ä½¿ç”¨ç®¡é“</span>
<span class="hljs-keyword">const</span> rawData = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'  John  '</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'100'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Jane'</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">200</span> },
  <span class="hljs-literal">null</span>,
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'100'</span> }, <span class="hljs-comment">// é‡å¤</span>
  { <span class="hljs-attr">name</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'invalid'</span> }
];

<span class="hljs-keyword">const</span> cleanedData = <span class="hljs-title function_">dataCleaningPipeline</span>(rawData);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Cleaned data:'</span>, cleanedData);
</code></pre>
<h5 data-id="heading-9">2.3 è¡¨å•éªŒè¯ç®¡é“</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// éªŒè¯è§„åˆ™</span>
<span class="hljs-keyword">const</span> validators = {
  <span class="hljs-attr">required</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> ({
    <span class="hljs-attr">isValid</span>: value != <span class="hljs-literal">null</span> &amp;&amp; value.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">''</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">'This field is required'</span>
  }),
  
  <span class="hljs-attr">minLength</span>: <span class="hljs-function">(<span class="hljs-params">min</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> ({
    <span class="hljs-attr">isValid</span>: value?.<span class="hljs-title function_">toString</span>().<span class="hljs-property">length</span> &gt;= min,
    <span class="hljs-attr">message</span>: <span class="hljs-string">`Minimum length is <span class="hljs-subst">${min}</span> characters`</span>
  }),
  
  <span class="hljs-attr">maxLength</span>: <span class="hljs-function">(<span class="hljs-params">max</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> ({
    <span class="hljs-attr">isValid</span>: value?.<span class="hljs-title function_">toString</span>().<span class="hljs-property">length</span> &lt;= max,
    <span class="hljs-attr">message</span>: <span class="hljs-string">`Maximum length is <span class="hljs-subst">${max}</span> characters`</span>
  }),
  
  <span class="hljs-attr">email</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> ({
    <span class="hljs-attr">isValid</span>: <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.<span class="hljs-title function_">test</span>(value),
    <span class="hljs-attr">message</span>: <span class="hljs-string">'Invalid email format'</span>
  }),
  
  <span class="hljs-attr">numeric</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> ({
    <span class="hljs-attr">isValid</span>: !<span class="hljs-built_in">isNaN</span>(<span class="hljs-built_in">parseFloat</span>(value)) &amp;&amp; <span class="hljs-built_in">isFinite</span>(value),
    <span class="hljs-attr">message</span>: <span class="hljs-string">'Must be a number'</span>
  })
};

<span class="hljs-comment">// è¡¨å•éªŒè¯ç®¡é“</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">FormValidator</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">rules</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span> = rules;
  }

  <span class="hljs-title function_">validate</span>(<span class="hljs-params">data</span>) {
    <span class="hljs-keyword">const</span> errors = {};
    <span class="hljs-keyword">const</span> results = {};

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [field, fieldRules] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rules</span>)) {
      <span class="hljs-keyword">const</span> value = data[field];
      <span class="hljs-keyword">const</span> fieldErrors = [];

      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> rule <span class="hljs-keyword">of</span> fieldRules) {
        <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">rule</span>(value);
        <span class="hljs-keyword">if</span> (!result.<span class="hljs-property">isValid</span>) {
          fieldErrors.<span class="hljs-title function_">push</span>(result.<span class="hljs-property">message</span>);
        }
      }

      <span class="hljs-keyword">if</span> (fieldErrors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
        errors[field] = fieldErrors;
      } <span class="hljs-keyword">else</span> {
        results[field] = value;
      }
    }

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">isValid</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(errors).<span class="hljs-property">length</span> === <span class="hljs-number">0</span>,
      errors,
      results
    };
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> registrationRules = {
  <span class="hljs-attr">username</span>: [
    validators.<span class="hljs-property">required</span>,
    validators.<span class="hljs-title function_">minLength</span>(<span class="hljs-number">3</span>),
    validators.<span class="hljs-title function_">maxLength</span>(<span class="hljs-number">20</span>)
  ],
  <span class="hljs-attr">email</span>: [
    validators.<span class="hljs-property">required</span>,
    validators.<span class="hljs-property">email</span>
  ],
  <span class="hljs-attr">age</span>: [
    validators.<span class="hljs-property">required</span>,
    validators.<span class="hljs-property">numeric</span>,
    <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> ({
      <span class="hljs-attr">isValid</span>: value &gt;= <span class="hljs-number">18</span> &amp;&amp; value &lt;= <span class="hljs-number">100</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">'Age must be between 18 and 100'</span>
    })
  ]
};

<span class="hljs-keyword">const</span> validator = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormValidator</span>(registrationRules);
<span class="hljs-keyword">const</span> userData = {
  <span class="hljs-attr">username</span>: <span class="hljs-string">'johndoe'</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">'john@example.com'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>
};

<span class="hljs-keyword">const</span> validationResult = validator.<span class="hljs-title function_">validate</span>(userData);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Validation result:'</span>, validationResult);
</code></pre>
<h4 data-id="heading-10">ä¸‰ã€é“¾å¼è°ƒç”¨ï¼ˆChaining Patternï¼‰</h4>
<p>é“¾å¼è°ƒç”¨é€šè¿‡è¿”å›å¯¹è±¡å®ä¾‹æœ¬èº«(<code>this</code>), å…è®¸è¿ç»­è°ƒç”¨å¤šä¸ªæ–¹æ³•, ä½¿ä»£ç æ›´åŠ æµç•…æ˜“è¯»ã€‚</p>
<h5 data-id="heading-11">3.1 åŸºç¡€é“¾å¼è°ƒç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// jQueryé£æ ¼çš„é“¾å¼è°ƒç”¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">QueryBuilder</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span> = {
      <span class="hljs-attr">select</span>: [],
      <span class="hljs-attr">from</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">where</span>: [],
      <span class="hljs-attr">orderBy</span>: [],
      <span class="hljs-attr">limit</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">offset</span>: <span class="hljs-literal">null</span>
    };
  }

  <span class="hljs-title function_">select</span>(<span class="hljs-params">...fields</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">select</span>.<span class="hljs-title function_">push</span>(...fields);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">from</span>(<span class="hljs-params">table</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">from</span> = table;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">where</span>(<span class="hljs-params">condition</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">where</span>.<span class="hljs-title function_">push</span>(condition);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">orderBy</span>(<span class="hljs-params">field, direction = <span class="hljs-string">'ASC'</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">orderBy</span>.<span class="hljs-title function_">push</span>({ field, direction });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">limit</span>(<span class="hljs-params">count</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">limit</span> = count;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">offset</span>(<span class="hljs-params">count</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>.<span class="hljs-property">offset</span> = count;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { select, <span class="hljs-keyword">from</span>, where, orderBy, limit, offset } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span>;
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">from</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'FROM clause is required'</span>);
    }

    <span class="hljs-keyword">let</span> sql = <span class="hljs-string">`SELECT <span class="hljs-subst">${select.length &gt; <span class="hljs-number">0</span> ? select.join(<span class="hljs-string">', '</span>) : <span class="hljs-string">'*'</span>}</span> FROM <span class="hljs-subst">${<span class="hljs-keyword">from</span>}</span>`</span>;
    
    <span class="hljs-keyword">if</span> (where.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      sql += <span class="hljs-string">` WHERE <span class="hljs-subst">${where.join(<span class="hljs-string">' AND '</span>)}</span>`</span>;
    }
    
    <span class="hljs-keyword">if</span> (orderBy.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> orderClauses = orderBy.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">{ field, direction }</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${field}</span> <span class="hljs-subst">${direction}</span>`</span>);
      sql += <span class="hljs-string">` ORDER BY <span class="hljs-subst">${orderClauses.join(<span class="hljs-string">', '</span>)}</span>`</span>;
    }
    
    <span class="hljs-keyword">if</span> (limit !== <span class="hljs-literal">null</span>) {
      sql += <span class="hljs-string">` LIMIT <span class="hljs-subst">${limit}</span>`</span>;
    }
    
    <span class="hljs-keyword">if</span> (offset !== <span class="hljs-literal">null</span>) {
      sql += <span class="hljs-string">` OFFSET <span class="hljs-subst">${offset}</span>`</span>;
    }
    
    <span class="hljs-keyword">return</span> sql + <span class="hljs-string">';'</span>;
  }

  <span class="hljs-title function_">reset</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">query</span> = {
      <span class="hljs-attr">select</span>: [],
      <span class="hljs-attr">from</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">where</span>: [],
      <span class="hljs-attr">orderBy</span>: [],
      <span class="hljs-attr">limit</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">offset</span>: <span class="hljs-literal">null</span>
    };
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> sql = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryBuilder</span>()
  .<span class="hljs-title function_">select</span>(<span class="hljs-string">'id'</span>, <span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>)
  .<span class="hljs-title function_">from</span>(<span class="hljs-string">'users'</span>)
  .<span class="hljs-title function_">where</span>(<span class="hljs-string">'active = true'</span>)
  .<span class="hljs-title function_">where</span>(<span class="hljs-string">'age &gt;= 18'</span>)
  .<span class="hljs-title function_">orderBy</span>(<span class="hljs-string">'name'</span>, <span class="hljs-string">'ASC'</span>)
  .<span class="hljs-title function_">limit</span>(<span class="hljs-number">10</span>)
  .<span class="hljs-title function_">offset</span>(<span class="hljs-number">0</span>)
  .<span class="hljs-title function_">build</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Generated SQL:'</span>, sql);
</code></pre>
<h5 data-id="heading-12">3.2 DOMæ“ä½œé“¾å¼è°ƒç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DOMElement</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">selector</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> selector === <span class="hljs-string">'string'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span> = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector));
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (selector <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Element</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span> = [selector];
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(selector)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span> = selector;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span> = [];
    }
  }

  <span class="hljs-comment">// CSSç›¸å…³æ–¹æ³•</span>
  <span class="hljs-title function_">css</span>(<span class="hljs-params">property, value</span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> property === <span class="hljs-string">'object'</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(el.<span class="hljs-property">style</span>, property);
      });
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value !== <span class="hljs-literal">undefined</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
        el.<span class="hljs-property">style</span>[property] = value;
      });
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">addClass</span>(<span class="hljs-params">className</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
      el.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(className);
    });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">removeClass</span>(<span class="hljs-params">className</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
      el.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(className);
    });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">toggleClass</span>(<span class="hljs-params">className</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
      el.<span class="hljs-property">classList</span>.<span class="hljs-title function_">toggle</span>(className);
    });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// å†…å®¹æ“ä½œ</span>
  <span class="hljs-title function_">text</span>(<span class="hljs-params">content</span>) {
    <span class="hljs-keyword">if</span> (content !== <span class="hljs-literal">undefined</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
        el.<span class="hljs-property">textContent</span> = content;
      });
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>[<span class="hljs-number">0</span>]?.<span class="hljs-property">textContent</span> || <span class="hljs-string">''</span>;
  }

  <span class="hljs-title function_">html</span>(<span class="hljs-params">content</span>) {
    <span class="hljs-keyword">if</span> (content !== <span class="hljs-literal">undefined</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
        el.<span class="hljs-property">innerHTML</span> = content;
      });
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>[<span class="hljs-number">0</span>]?.<span class="hljs-property">innerHTML</span> || <span class="hljs-string">''</span>;
  }

  <span class="hljs-comment">// å±æ€§æ“ä½œ</span>
  <span class="hljs-title function_">attr</span>(<span class="hljs-params">name, value</span>) {
    <span class="hljs-keyword">if</span> (value !== <span class="hljs-literal">undefined</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
        el.<span class="hljs-title function_">setAttribute</span>(name, value);
      });
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>[<span class="hljs-number">0</span>]?.<span class="hljs-title function_">getAttribute</span>(name) || <span class="hljs-literal">null</span>;
  }

  <span class="hljs-comment">// äº‹ä»¶å¤„ç†</span>
  <span class="hljs-title function_">on</span>(<span class="hljs-params">event, handler, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
      el.<span class="hljs-title function_">addEventListener</span>(event, handler, options);
    });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">off</span>(<span class="hljs-params">event, handler, options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
      el.<span class="hljs-title function_">removeEventListener</span>(event, handler, options);
    });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// éå†</span>
  <span class="hljs-title function_">each</span>(<span class="hljs-params">callback</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">el, index</span>) =&gt;</span> {
      callback.<span class="hljs-title function_">call</span>(el, index, el);
    });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// æŸ¥æ‰¾å­å…ƒç´ </span>
  <span class="hljs-title function_">find</span>(<span class="hljs-params">selector</span>) {
    <span class="hljs-keyword">const</span> found = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
      found.<span class="hljs-title function_">push</span>(...<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(el.<span class="hljs-title function_">querySelectorAll</span>(selector)));
    });
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMElement</span>(found);
  }

  <span class="hljs-comment">// è·å–çˆ¶å…ƒç´ </span>
  <span class="hljs-title function_">parent</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> parents = <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> el.<span class="hljs-property">parentElement</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMElement</span>(parents.<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>));
  }

  <span class="hljs-comment">// æ˜¾ç¤º/éšè—</span>
  <span class="hljs-title function_">show</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">css</span>(<span class="hljs-string">'display'</span>, <span class="hljs-string">''</span>);
  }

  <span class="hljs-title function_">hide</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">css</span>(<span class="hljs-string">'display'</span>, <span class="hljs-string">'none'</span>);
  }

  <span class="hljs-comment">// åŠ¨ç”»</span>
  <span class="hljs-title function_">animate</span>(<span class="hljs-params">properties, duration = <span class="hljs-number">300</span>, easing = <span class="hljs-string">'ease'</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">elements</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> {
      el.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">`all <span class="hljs-subst">${duration}</span>ms <span class="hljs-subst">${easing}</span>`</span>;
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(el.<span class="hljs-property">style</span>, properties);
      
      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
        el.<span class="hljs-property">style</span>.<span class="hljs-property">transition</span> = <span class="hljs-string">''</span>;
      }, duration);
    });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-comment">// å‡è®¾HTMLä¸­æœ‰: &lt;div id="myDiv"&gt;Hello&lt;/div&gt;</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">$</span> = (<span class="hljs-params">selector</span>) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMElement</span>(selector);

$(<span class="hljs-string">'#myDiv'</span>)
  .<span class="hljs-title function_">css</span>({
    <span class="hljs-attr">color</span>: <span class="hljs-string">'white'</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'blue'</span>,
    <span class="hljs-attr">padding</span>: <span class="hljs-string">'10px'</span>
  })
  .<span class="hljs-title function_">addClass</span>(<span class="hljs-string">'highlight'</span>)
  .<span class="hljs-title function_">text</span>(<span class="hljs-string">'Hello, World!'</span>)
  .<span class="hljs-title function_">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
    $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">toggleClass</span>(<span class="hljs-string">'active'</span>);
  })
  .<span class="hljs-title function_">animate</span>({
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">0.8</span>,
    <span class="hljs-attr">transform</span>: <span class="hljs-string">'scale(1.1)'</span>
  }, <span class="hljs-number">300</span>);
</code></pre>
<h5 data-id="heading-13">3.3 æ„å»ºå™¨æ¨¡å¼ä¸é“¾å¼è°ƒç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// é…ç½®å¯¹è±¡æ„å»ºå™¨</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConfigurationBuilder</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">api</span>: {},
      <span class="hljs-attr">ui</span>: {},
      <span class="hljs-attr">features</span>: {},
      <span class="hljs-attr">performance</span>: {}
    };
  }

  <span class="hljs-comment">// APIé…ç½®</span>
  <span class="hljs-title function_">withApi</span>(<span class="hljs-params">baseUrl</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">api</span>.<span class="hljs-property">baseUrl</span> = baseUrl;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">withApiVersion</span>(<span class="hljs-params">version</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">api</span>.<span class="hljs-property">version</span> = version;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">withTimeout</span>(<span class="hljs-params">ms</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">api</span>.<span class="hljs-property">timeout</span> = ms;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// UIé…ç½®</span>
  <span class="hljs-title function_">withTheme</span>(<span class="hljs-params">theme</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">ui</span>.<span class="hljs-property">theme</span> = theme;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">withLanguage</span>(<span class="hljs-params">lang</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">ui</span>.<span class="hljs-property">language</span> = lang;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">withDarkMode</span>(<span class="hljs-params">enabled</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">ui</span>.<span class="hljs-property">darkMode</span> = enabled;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// åŠŸèƒ½é…ç½®</span>
  <span class="hljs-title function_">enableFeature</span>(<span class="hljs-params">feature</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">features</span>[feature] = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">disableFeature</span>(<span class="hljs-params">feature</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">features</span>[feature] = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// æ€§èƒ½é…ç½®</span>
  <span class="hljs-title function_">withCache</span>(<span class="hljs-params">enabled</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">cache</span> = enabled;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">withLazyLoad</span>(<span class="hljs-params">enabled</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">lazyLoad</span> = enabled;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-title function_">withCompression</span>(<span class="hljs-params">enabled</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">performance</span>.<span class="hljs-property">compression</span> = enabled;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// æ„å»ºæ–¹æ³•</span>
  <span class="hljs-title function_">build</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// éªŒè¯é…ç½®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validate</span>();
    <span class="hljs-comment">// è¿”å›ä¸å¯å˜é…ç½®</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">freeze</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>)));
  }

  <span class="hljs-title function_">validate</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> { api } = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>;
    <span class="hljs-keyword">if</span> (!api.<span class="hljs-property">baseUrl</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'API base URL is required'</span>);
    }
    <span class="hljs-keyword">if</span> (api.<span class="hljs-property">timeout</span> &amp;&amp; api.<span class="hljs-property">timeout</span> &lt; <span class="hljs-number">100</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Timeout must be at least 100ms'</span>);
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> config = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConfigurationBuilder</span>()
  .<span class="hljs-title function_">withApi</span>(<span class="hljs-string">'https://api.example.com'</span>)
  .<span class="hljs-title function_">withApiVersion</span>(<span class="hljs-string">'v1'</span>)
  .<span class="hljs-title function_">withTimeout</span>(<span class="hljs-number">5000</span>)
  .<span class="hljs-title function_">withTheme</span>(<span class="hljs-string">'dark'</span>)
  .<span class="hljs-title function_">withLanguage</span>(<span class="hljs-string">'en'</span>)
  .<span class="hljs-title function_">withDarkMode</span>(<span class="hljs-literal">true</span>)
  .<span class="hljs-title function_">enableFeature</span>(<span class="hljs-string">'analytics'</span>)
  .<span class="hljs-title function_">enableFeature</span>(<span class="hljs-string">'notifications'</span>)
  .<span class="hljs-title function_">disableFeature</span>(<span class="hljs-string">'debug'</span>)
  .<span class="hljs-title function_">withCache</span>(<span class="hljs-literal">true</span>)
  .<span class="hljs-title function_">withLazyLoad</span>(<span class="hljs-literal">true</span>)
  .<span class="hljs-title function_">build</span>();

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'App configuration:'</span>, config);
</code></pre>
<h4 data-id="heading-14">å››ã€æƒ°æ€§åŠ è½½/æ±‚å€¼ï¼ˆLazy Loading/Evaluationï¼‰</h4>
<p>æƒ°æ€§åŠ è½½å»¶è¿Ÿè®¡ç®—æˆ–åˆå§‹åŒ–, ç›´åˆ°çœŸæ­£éœ€è¦æ—¶æ‰æ‰§è¡Œ, å¯ä»¥æ˜¾è‘—æé«˜åº”ç”¨æ€§èƒ½ã€‚</p>
<h5 data-id="heading-15">4.1 æƒ°æ€§æ±‚å€¼å®ç°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æƒ°æ€§å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">lazy</span>(<span class="hljs-params">fn</span>) {
  <span class="hljs-keyword">let</span> result;
  <span class="hljs-keyword">let</span> evaluated = <span class="hljs-literal">false</span>;
  
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) {
    <span class="hljs-keyword">if</span> (!evaluated) {
      result = fn.<span class="hljs-title function_">apply</span>(<span class="hljs-variable language_">this</span>, args);
      evaluated = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">return</span> result;
  };
}

<span class="hljs-comment">// æƒ°æ€§å±æ€§</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">lazyProperty</span>(<span class="hljs-params">target, propertyName, getter</span>) {
  <span class="hljs-keyword">let</span> value;
  <span class="hljs-keyword">let</span> evaluated = <span class="hljs-literal">false</span>;
  
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(target, propertyName, {
    <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (!evaluated) {
        value = getter.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>);
        evaluated = <span class="hljs-literal">true</span>;
      }
      <span class="hljs-keyword">return</span> value;
    },
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>
  });
}

<span class="hljs-comment">// æƒ°æ€§ç±»å±æ€§</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">LazyClass</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_expensiveData</span> = <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">get</span> <span class="hljs-title function_">expensiveData</span>() {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">_expensiveData</span> === <span class="hljs-literal">null</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Computing expensive data...'</span>);
      <span class="hljs-comment">// æ¨¡æ‹Ÿè€—æ—¶è®¡ç®—</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">_expensiveData</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">computeExpensiveData</span>();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_expensiveData</span>;
  }

  <span class="hljs-title function_">computeExpensiveData</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// å¤æ‚çš„è®¡ç®—é€»è¾‘</span>
    <span class="hljs-keyword">const</span> start = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
      result += <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">sqrt</span>(i);
    }
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Computed in <span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now() - start}</span>ms`</span>);
    <span class="hljs-keyword">return</span> result;
  }

  <span class="hljs-comment">// é‡ç½®æƒ°æ€§å€¼</span>
  <span class="hljs-title function_">reset</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_expensiveData</span> = <span class="hljs-literal">null</span>;
  }
}
</code></pre>
<h5 data-id="heading-16">4.2 å›¾ç‰‡æ‡’åŠ è½½</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LazyImageLoader</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">root</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">'0px'</span>,
      <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.1</span>,
      <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'</span>,
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-literal">null</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initObserver</span>();
  }

  <span class="hljs-title function_">initObserver</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-string">'IntersectionObserver'</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">window</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleIntersection</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>),
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>
      );
    }
  }

  <span class="hljs-title function_">registerImage</span>(<span class="hljs-params">imgElement, src</span>) {
    <span class="hljs-keyword">if</span> (!imgElement || !src) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// ä¿å­˜åŸå§‹src</span>
    <span class="hljs-keyword">const</span> originalSrc = imgElement.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-src'</span>) || src;
    imgElement.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">'data-src'</span>, originalSrc);
    
    <span class="hljs-comment">// è®¾ç½®å ä½ç¬¦</span>
    imgElement.<span class="hljs-property">src</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">placeholder</span>;
    imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'lazy-load'</span>);
    
    <span class="hljs-comment">// æ·»åŠ åˆ°è§‚å¯Ÿåˆ—è¡¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">set</span>(imgElement, {
      <span class="hljs-attr">src</span>: originalSrc,
      <span class="hljs-attr">loaded</span>: <span class="hljs-literal">false</span>
    });
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>.<span class="hljs-title function_">observe</span>(imgElement);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// é™çº§æ–¹æ¡ˆï¼šç«‹å³åŠ è½½</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadImage</span>(imgElement);
    }
  }

  <span class="hljs-title function_">handleIntersection</span>(<span class="hljs-params">entries</span>) {
    entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">entry</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">isIntersecting</span>) {
        <span class="hljs-keyword">const</span> img = entry.<span class="hljs-property">target</span>;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadImage</span>(img);
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>?.<span class="hljs-title function_">unobserve</span>(img);
      }
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadImage</span>(<span class="hljs-params">imgElement</span>) {
    <span class="hljs-keyword">const</span> imageData = <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">get</span>(imgElement);
    <span class="hljs-keyword">if</span> (!imageData || imageData.<span class="hljs-property">loaded</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// é¢„åŠ è½½å›¾ç‰‡</span>
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">preloadImage</span>(imageData.<span class="hljs-property">src</span>);
      
      <span class="hljs-comment">// åº”ç”¨å®é™…å›¾ç‰‡</span>
      imgElement.<span class="hljs-property">src</span> = imageData.<span class="hljs-property">src</span>;
      imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'lazy-load'</span>);
      imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'lazy-loaded'</span>);
      
      imageData.<span class="hljs-property">loaded</span> = <span class="hljs-literal">true</span>;
      
      <span class="hljs-comment">// è§¦å‘åŠ è½½å®Œæˆäº‹ä»¶</span>
      imgElement.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">'lazyload'</span>, {
        <span class="hljs-attr">detail</span>: { <span class="hljs-attr">src</span>: imageData.<span class="hljs-property">src</span> }
      }));
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to load image:'</span>, imageData.<span class="hljs-property">src</span>, error);
      imgElement.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'lazy-error'</span>);
      
      imgElement.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">'lazyloaderror'</span>, {
        <span class="hljs-attr">detail</span>: { <span class="hljs-attr">src</span>: imageData.<span class="hljs-property">src</span>, error }
      }));
    }
  }

  <span class="hljs-title function_">preloadImage</span>(<span class="hljs-params">src</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Image</span>();
      img.<span class="hljs-property">onload</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">resolve</span>(img);
      img.<span class="hljs-property">onerror</span> = reject;
      img.<span class="hljs-property">src</span> = src;
    });
  }

  <span class="hljs-comment">// æ‰¹é‡æ³¨å†Œå›¾ç‰‡</span>
  <span class="hljs-title function_">registerAll</span>(<span class="hljs-params">selector = <span class="hljs-string">'img[data-src]'</span></span>) {
    <span class="hljs-keyword">const</span> images = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(selector);
    images.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> src = img.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'data-src'</span>);
      <span class="hljs-keyword">if</span> (src) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerImage</span>(img, src);
      }
    });
  }

  <span class="hljs-comment">// å¼ºåˆ¶åŠ è½½ç‰¹å®šå›¾ç‰‡</span>
  <span class="hljs-title function_">forceLoad</span>(<span class="hljs-params">imgElement</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadImage</span>(imgElement);
  }

  <span class="hljs-comment">// æ¸…ç†</span>
  <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">observer</span>?.<span class="hljs-title function_">disconnect</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">images</span>.<span class="hljs-title function_">clear</span>();
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> lazyLoader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LazyImageLoader</span>({
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.5</span>,
    <span class="hljs-attr">placeholder</span>: <span class="hljs-string">'/images/placeholder.png'</span>
  });
  
  <span class="hljs-comment">// æ³¨å†Œç°æœ‰å›¾ç‰‡</span>
  lazyLoader.<span class="hljs-title function_">registerAll</span>();
  
  <span class="hljs-comment">// åŠ¨æ€æ·»åŠ çš„å›¾ç‰‡</span>
  <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'newImagesAdded'</span>, <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> newImages = event.<span class="hljs-property">detail</span>.<span class="hljs-property">images</span>;
    newImages.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> {
      lazyLoader.<span class="hljs-title function_">registerImage</span>(img, img.<span class="hljs-property">dataset</span>.<span class="hljs-property">src</span>);
    });
  });
  
  <span class="hljs-comment">// é¡µé¢ç¦»å¼€æ—¶æ¸…ç†</span>
  <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'beforeunload'</span>, <span class="hljs-function">() =&gt;</span> {
    lazyLoader.<span class="hljs-title function_">destroy</span>();
  });
});
</code></pre>
<h5 data-id="heading-17">4.3 ç»„ä»¶æ‡’åŠ è½½(Vue/Reactç¤ºä¾‹)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Reactç»„ä»¶æ‡’åŠ è½½</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { <span class="hljs-title class_">Suspense</span>, lazy } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-comment">// æ‡’åŠ è½½ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyComponent</span> = <span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./ExpensiveComponent'</span>));

<span class="hljs-comment">// ä½¿ç”¨SuspenseåŒ…è£¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>My App<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Vueç»„ä»¶æ‡’åŠ è½½</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">LazyComponent</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-string">'./ExpensiveComponent.vue'</span>);

<span class="hljs-comment">// è·¯ç”±é…ç½®ä¸­ä½¿ç”¨æ‡’åŠ è½½</span>
<span class="hljs-keyword">const</span> routes = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/dashboard'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./views/Dashboard.vue'</span>)
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/settings'</span>,
    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./views/Settings.vue'</span>)
  }
];

<span class="hljs-comment">// è‡ªå®šä¹‰æ‡’åŠ è½½å°è£…</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">createLazyLoader</span>(<span class="hljs-params">importFn, loadingComponent, errorComponent</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-title function_">data</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">component</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span>
      };
    },
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">created</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> importFn();
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">component</span> = <span class="hljs-variable language_">module</span>.<span class="hljs-property">default</span> || <span class="hljs-variable language_">module</span>;
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">error</span> = err;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to load component:'</span>, err);
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
      }
    },
    
    <span class="hljs-title function_">render</span>(<span class="hljs-params">h</span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> &amp;&amp; loadingComponent) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">h</span>(loadingComponent);
      }
      
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">error</span> &amp;&amp; errorComponent) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">h</span>(errorComponent, { <span class="hljs-attr">error</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">error</span> });
      }
      
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">component</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title function_">h</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">component</span>);
      }
      
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  };
}
</code></pre>
<h5 data-id="heading-18">4.4 æ•°æ®æ‡’åŠ è½½(æ— é™æ»šåŠ¨)</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">InfiniteScroll</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = {
      <span class="hljs-attr">container</span>: <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>,
      <span class="hljs-attr">distance</span>: <span class="hljs-number">100</span>,
      <span class="hljs-attr">throttle</span>: <span class="hljs-number">200</span>,
      <span class="hljs-attr">onLoadMore</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(),
      ...options
    };
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hasMore</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">throttleTimer</span> = <span class="hljs-literal">null</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = <span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">container</span> === <span class="hljs-string">'string'</span> 
      ? <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">container</span>)
      : <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">container</span>;
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Container not found'</span>);
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">bindEvents</span>();
  }

  <span class="hljs-title function_">bindEvents</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScroll</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScroll</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
  }

  <span class="hljs-title function_">handleScroll</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">throttleTimer</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">throttleTimer</span>);
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">throttleTimer</span> = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkPosition</span>();
    }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">throttle</span>);
  }

  <span class="hljs-title function_">checkPosition</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">hasMore</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> scrollTop = <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">scrollTop</span>;
    <span class="hljs-keyword">const</span> scrollHeight = <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">scrollHeight</span>;
    <span class="hljs-keyword">const</span> clientHeight = <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">clientHeight</span>;
    
    <span class="hljs-keyword">const</span> distanceToBottom = scrollHeight - (scrollTop + clientHeight);
    
    <span class="hljs-keyword">if</span> (distanceToBottom &lt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-property">distance</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadMore</span>();
    }
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadMore</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> || !<span class="hljs-variable language_">this</span>.<span class="hljs-property">hasMore</span>) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">'loadstart'</span>));
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>.<span class="hljs-title function_">onLoadMore</span>();
      
      <span class="hljs-keyword">if</span> (result &amp;&amp; <span class="hljs-keyword">typeof</span> result.<span class="hljs-property">hasMore</span> === <span class="hljs-string">'boolean'</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">hasMore</span> = result.<span class="hljs-property">hasMore</span>;
      }
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">'load'</span>, { 
        <span class="hljs-attr">detail</span>: result 
      }));
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">'error'</span>, { 
        <span class="hljs-attr">detail</span>: error 
      }));
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to load more data:'</span>, error);
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomEvent</span>(<span class="hljs-string">'loadend'</span>));
      
      <span class="hljs-comment">// æ£€æŸ¥æ˜¯å¦è¿˜éœ€è¦ç»§ç»­åŠ è½½ï¼ˆæ•°æ®å¯èƒ½æ²¡æœ‰å¡«æ»¡å±å¹•ï¼‰</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">hasMore</span>) {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkPosition</span>(), <span class="hljs-number">100</span>);
      }
    }
  }

  <span class="hljs-comment">// æ‰‹åŠ¨è§¦å‘åŠ è½½</span>
  <span class="hljs-title function_">triggerLoad</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadMore</span>();
  }

  <span class="hljs-comment">// é‡ç½®çŠ¶æ€</span>
  <span class="hljs-title function_">reset</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">hasMore</span> = <span class="hljs-literal">true</span>;
  }

  <span class="hljs-comment">// é”€æ¯</span>
  <span class="hljs-title function_">destroy</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'scroll'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScroll</span>);
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">removeEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleScroll</span>);
    
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">throttleTimer</span>) {
      <span class="hljs-built_in">clearTimeout</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">throttleTimer</span>);
    }
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> infiniteScroll = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InfiniteScroll</span>({
  <span class="hljs-attr">container</span>: <span class="hljs-string">'#scrollContainer'</span>,
  <span class="hljs-attr">distance</span>: <span class="hljs-number">200</span>,
  <span class="hljs-attr">throttle</span>: <span class="hljs-number">300</span>,
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onLoadMore</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ¨¡æ‹ŸAPIè°ƒç”¨</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">`/api/items?page=<span class="hljs-subst">${currentPage}</span>`</span>);
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>();
    
    <span class="hljs-comment">// æ¸²æŸ“æ–°æ•°æ®</span>
    <span class="hljs-title function_">renderItems</span>(data.<span class="hljs-property">items</span>);
    
    <span class="hljs-comment">// è¿”å›æ˜¯å¦æœ‰æ›´å¤šæ•°æ®</span>
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasMore</span>: data.<span class="hljs-property">hasMore</span> };
  }
});

<span class="hljs-comment">// åŠ¨æ€æ›´æ–°é€‰é¡¹</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateInfiniteScroll</span>(<span class="hljs-params">options</span>) {
  infiniteScroll.<span class="hljs-property">options</span> = { ...infiniteScroll.<span class="hljs-property">options</span>, ...options };
}
</code></pre>
<h4 data-id="heading-19">äº”ã€æ¨¡å¼å¯¹æ¯”ä¸åº”ç”¨åœºæ™¯</h4>



































<table><thead><tr><th align="left">æ¨¡å¼</th><th align="left">ä¼˜ç‚¹</th><th align="left">ç¼ºç‚¹</th><th align="left">é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td align="left">ä¸­é—´ä»¶æ¨¡å¼</td><td align="left">è§£è€¦ã€å¯ç»„åˆã€æ˜“äºæµ‹è¯•</td><td align="left">å¯èƒ½å¢åŠ å¤æ‚æ€§ã€è°ƒè¯•å›°éš¾</td><td align="left">è¯·æ±‚å¤„ç†ã€æ•°æ®å¤„ç†ç®¡é“ã€æ’ä»¶ç³»ç»Ÿ</td></tr><tr><td align="left">ç®¡é“æ¨¡å¼</td><td align="left">æ¸…æ™°çš„æ•°æ®æµå‘ã€æ˜“äºæµ‹è¯•å’Œå¤ç”¨</td><td align="left">å¯èƒ½åˆ›å»ºå¤ªå¤šå°å‡½æ•°ã€é”™è¯¯å¤„ç†å¤æ‚</td><td align="left">æ•°æ®è½¬æ¢ã€éªŒè¯ã€æ¸…æ´—æµç¨‹</td></tr><tr><td align="left">é“¾å¼è°ƒç”¨</td><td align="left">ä»£ç æµç•…ã€æ˜“è¯»ã€å‡å°‘ä¸´æ—¶å˜é‡</td><td align="left">å¯èƒ½æ©ç›–é”™è¯¯æ¥æºã€è°ƒè¯•å›°éš¾</td><td align="left">æ„å»ºå™¨æ¨¡å¼ã€DOMæ“ä½œã€é…ç½®è®¾ç½®</td></tr><tr><td align="left">æƒ°æ€§åŠ è½½</td><td align="left">æé«˜æ€§èƒ½ã€‘å‡å°‘å†…å­˜ä½¿ç”¨</td><td align="left">åˆå§‹åŒ–å»¶è¿Ÿã€å¤æ‚æ€§å¢åŠ </td><td align="left">å›¾ç‰‡åŠ è½½ã€ç»„ä»¶åŠ è½½ã€æ•°æ®è®¡ç®—</td></tr></tbody></table>
<h5 data-id="heading-20">5.1 å¦‚ä½•é€‰æ‹©æ¨¡å¼?</h5>
<ol>
<li><strong>éœ€è¦å¤„ç†è¯·æ±‚/å“åº”æµç¨‹</strong> â†’ ä¸­é—´ä»¶æ¨¡å¼</li>
<li><strong>éœ€è¦æ•°æ®è½¬æ¢æµæ°´çº¿</strong> â†’ ç®¡é“æ¨¡å¼</li>
<li><strong>éœ€è¦æµç•…çš„APIæ¥å£</strong> â†’ é“¾å¼è°ƒç”¨</li>
<li><strong>éœ€è¦ä¼˜åŒ–æ€§èƒ½ï¼Œå»¶è¿Ÿåˆå§‹åŒ–</strong> â†’ æƒ°æ€§åŠ è½½</li>
</ol>
<h4 data-id="heading-21">å…­ã€ç»¼åˆåº”ç”¨å®ä¾‹</h4>
<h5 data-id="heading-22">6.1 å®Œæ•´çš„APIå®¢æˆ·ç«¯</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ApiClient</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">baseURL</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">baseURL</span> = baseURL;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultHeaders</span> = {
      <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
    };
  }

  <span class="hljs-comment">// æ·»åŠ ä¸­é—´ä»¶</span>
  <span class="hljs-title function_">use</span>(<span class="hljs-params">middleware</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span>.<span class="hljs-title function_">push</span>(middleware);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// åˆ›å»ºè¯·æ±‚ç®¡é“</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">request</span>(<span class="hljs-params">endpoint, options = {}</span>) {
    <span class="hljs-keyword">const</span> context = {
      <span class="hljs-attr">url</span>: <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.baseURL}</span><span class="hljs-subst">${endpoint}</span>`</span>,
      <span class="hljs-attr">options</span>: {
        <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span>,
        <span class="hljs-attr">headers</span>: { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultHeaders</span>, ...options.<span class="hljs-property">headers</span> },
        ...options
      },
      <span class="hljs-attr">response</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>
    };

    <span class="hljs-comment">// æ‰§è¡Œä¸­é—´ä»¶ç®¡é“</span>
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeMiddleware</span>(context);
    
    <span class="hljs-keyword">if</span> (context.<span class="hljs-property">error</span>) {
      <span class="hljs-keyword">throw</span> context.<span class="hljs-property">error</span>;
    }

    <span class="hljs-keyword">return</span> context.<span class="hljs-property">response</span>;
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">executeMiddleware</span>(<span class="hljs-params">context</span>) {
    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> middlewares = <span class="hljs-variable language_">this</span>.<span class="hljs-property">middlewares</span>;
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">next</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
      <span class="hljs-keyword">if</span> (index &lt; middlewares.<span class="hljs-property">length</span>) {
        <span class="hljs-keyword">const</span> middleware = middlewares[index++];
        <span class="hljs-keyword">await</span> <span class="hljs-title function_">middleware</span>(context, next);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// æ‰§è¡Œå®é™…è¯·æ±‚</span>
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeRequest</span>(context);
      }
    };
    
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
  }

  <span class="hljs-keyword">async</span> <span class="hljs-title function_">executeRequest</span>(<span class="hljs-params">context</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(context.<span class="hljs-property">url</span>, context.<span class="hljs-property">options</span>);
      context.<span class="hljs-property">response</span> = {
        <span class="hljs-attr">status</span>: response.<span class="hljs-property">status</span>,
        <span class="hljs-attr">headers</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(response.<span class="hljs-property">headers</span>.<span class="hljs-title function_">entries</span>()),
        <span class="hljs-attr">data</span>: <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>()
      };
    } <span class="hljs-keyword">catch</span> (error) {
      context.<span class="hljs-property">error</span> = error;
    }
  }

  <span class="hljs-comment">// å¿«æ·æ–¹æ³•ï¼ˆé“¾å¼è°ƒç”¨ï¼‰</span>
  <span class="hljs-title function_">get</span>(<span class="hljs-params">endpoint, options = {}</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(endpoint, { ...options, <span class="hljs-attr">method</span>: <span class="hljs-string">'GET'</span> });
  }

  <span class="hljs-title function_">post</span>(<span class="hljs-params">endpoint, data, options = {}</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(endpoint, {
      ...options,
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)
    });
  }

  <span class="hljs-title function_">put</span>(<span class="hljs-params">endpoint, data, options = {}</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(endpoint, {
      ...options,
      <span class="hljs-attr">method</span>: <span class="hljs-string">'PUT'</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)
    });
  }

  <span class="hljs-title function_">delete</span>(<span class="hljs-params">endpoint, options = {}</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">request</span>(endpoint, { ...options, <span class="hljs-attr">method</span>: <span class="hljs-string">'DELETE'</span> });
  }
}

<span class="hljs-comment">// åˆ›å»ºAPIå®¢æˆ·ç«¯å¹¶é…ç½®ä¸­é—´ä»¶</span>
<span class="hljs-keyword">const</span> api = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiClient</span>(<span class="hljs-string">'https://api.example.com'</span>)
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-comment">// è®¤è¯ä¸­é—´ä»¶</span>
    <span class="hljs-keyword">const</span> token = <span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'auth_token'</span>);
    <span class="hljs-keyword">if</span> (token) {
      ctx.<span class="hljs-property">options</span>.<span class="hljs-property">headers</span>.<span class="hljs-property">Authorization</span> = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>;
    }
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
  })
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-comment">// æ—¥å¿—ä¸­é—´ä»¶</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[API] <span class="hljs-subst">${ctx.options.method}</span> <span class="hljs-subst">${ctx.url}</span>`</span>);
    <span class="hljs-keyword">const</span> start = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
    <span class="hljs-keyword">const</span> duration = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - start;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[API] Completed in <span class="hljs-subst">${duration}</span>ms`</span>);
  })
  .<span class="hljs-title function_">use</span>(<span class="hljs-keyword">async</span> (ctx, next) =&gt; {
    <span class="hljs-comment">// é”™è¯¯å¤„ç†ä¸­é—´ä»¶</span>
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-title function_">next</span>();
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'[API] Request failed:'</span>, error);
      <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œå®ç°é‡è¯•é€»è¾‘</span>
      <span class="hljs-keyword">throw</span> error;
    }
  });

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchUserData</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> api.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/users/1'</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'User data:'</span>, response.<span class="hljs-property">data</span>);
    <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to fetch user:'</span>, error);
  }
}
</code></pre>
<h5 data-id="heading-23">6.2 è¡¨å•å¤„ç†ç³»ç»Ÿ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FormProcessor</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">formElement</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">form</span> = formElement;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fields</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">validators</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transformers</span> = [];
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">submitHandlers</span> = [];
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
  }

  <span class="hljs-title function_">init</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ”¶é›†è¡¨å•å­—æ®µ</span>
    <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">form</span>.<span class="hljs-property">elements</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (element.<span class="hljs-property">name</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">fields</span>.<span class="hljs-title function_">set</span>(element.<span class="hljs-property">name</span>, element);
      }
    });
    
    <span class="hljs-comment">// ç»‘å®šæäº¤äº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">form</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'submit'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">handleSubmit</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>));
  }

  <span class="hljs-comment">// æ·»åŠ éªŒè¯å™¨</span>
  <span class="hljs-title function_">addValidator</span>(<span class="hljs-params">fieldName, validator</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">validators</span>.<span class="hljs-title function_">has</span>(fieldName)) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">validators</span>.<span class="hljs-title function_">set</span>(fieldName, []);
    }
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">validators</span>.<span class="hljs-title function_">get</span>(fieldName).<span class="hljs-title function_">push</span>(validator);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// æ·»åŠ æ•°æ®è½¬æ¢å™¨</span>
  <span class="hljs-title function_">addTransformer</span>(<span class="hljs-params">transformer</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">transformers</span>.<span class="hljs-title function_">push</span>(transformer);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// æ·»åŠ æäº¤å¤„ç†å™¨</span>
  <span class="hljs-title function_">onSubmit</span>(<span class="hljs-params">handler</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">submitHandlers</span>.<span class="hljs-title function_">push</span>(handler);
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }

  <span class="hljs-comment">// è·å–è¡¨å•æ•°æ®</span>
  <span class="hljs-title function_">getData</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> data = {};
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fields</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">element, name</span>) =&gt;</span> {
      data[name] = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getValue</span>(element);
    });
    <span class="hljs-keyword">return</span> data;
  }

  <span class="hljs-title function_">getValue</span>(<span class="hljs-params">element</span>) {
    <span class="hljs-keyword">if</span> (element.<span class="hljs-property">type</span> === <span class="hljs-string">'checkbox'</span>) {
      <span class="hljs-keyword">return</span> element.<span class="hljs-property">checked</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (element.<span class="hljs-property">type</span> === <span class="hljs-string">'radio'</span>) {
      <span class="hljs-keyword">return</span> element.<span class="hljs-property">checked</span> ? element.<span class="hljs-property">value</span> : <span class="hljs-literal">null</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (element.<span class="hljs-property">type</span> === <span class="hljs-string">'select-multiple'</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(element.<span class="hljs-property">selectedOptions</span>).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">opt</span> =&gt;</span> opt.<span class="hljs-property">value</span>);
    }
    <span class="hljs-keyword">return</span> element.<span class="hljs-property">value</span>;
  }

  <span class="hljs-comment">// éªŒè¯è¡¨å•</span>
  <span class="hljs-title function_">validate</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">const</span> errors = {};
    <span class="hljs-keyword">const</span> data = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getData</span>();
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">validators</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">validators, fieldName</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> value = data[fieldName];
      <span class="hljs-keyword">const</span> fieldErrors = [];
      
      validators.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">validator</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> result = <span class="hljs-title function_">validator</span>(value, data);
        <span class="hljs-keyword">if</span> (result !== <span class="hljs-literal">true</span>) {
          fieldErrors.<span class="hljs-title function_">push</span>(result || <span class="hljs-string">`Validation failed for <span class="hljs-subst">${fieldName}</span>`</span>);
        }
      });
      
      <span class="hljs-keyword">if</span> (fieldErrors.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
        errors[fieldName] = fieldErrors;
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">showFieldError</span>(fieldName, fieldErrors[<span class="hljs-number">0</span>]);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clearFieldError</span>(fieldName);
      }
    });
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">isValid</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(errors).<span class="hljs-property">length</span> === <span class="hljs-number">0</span>,
      errors,
      data
    };
  }

  <span class="hljs-title function_">showFieldError</span>(<span class="hljs-params">fieldName, message</span>) {
    <span class="hljs-keyword">const</span> field = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fields</span>.<span class="hljs-title function_">get</span>(fieldName);
    <span class="hljs-keyword">if</span> (field) {
      field.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-string">'error'</span>);
      
      <span class="hljs-keyword">let</span> errorElement = field.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.error-message'</span>);
      <span class="hljs-keyword">if</span> (!errorElement) {
        errorElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'div'</span>);
        errorElement.<span class="hljs-property">className</span> = <span class="hljs-string">'error-message'</span>;
        field.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">appendChild</span>(errorElement);
      }
      errorElement.<span class="hljs-property">textContent</span> = message;
    }
  }

  <span class="hljs-title function_">clearFieldError</span>(<span class="hljs-params">fieldName</span>) {
    <span class="hljs-keyword">const</span> field = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fields</span>.<span class="hljs-title function_">get</span>(fieldName);
    <span class="hljs-keyword">if</span> (field) {
      field.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'error'</span>);
      <span class="hljs-keyword">const</span> errorElement = field.<span class="hljs-property">parentElement</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'.error-message'</span>);
      <span class="hljs-keyword">if</span> (errorElement) {
        errorElement.<span class="hljs-title function_">remove</span>();
      }
    }
  }

  <span class="hljs-comment">// å¤„ç†æäº¤</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">handleSubmit</span>(<span class="hljs-params">event</span>) {
    event.<span class="hljs-title function_">preventDefault</span>();
    
    <span class="hljs-comment">// éªŒè¯</span>
    <span class="hljs-keyword">const</span> validation = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validate</span>();
    <span class="hljs-keyword">if</span> (!validation.<span class="hljs-property">isValid</span>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Form validation failed:'</span>, validation.<span class="hljs-property">errors</span>);
      <span class="hljs-keyword">return</span>;
    }
    
    <span class="hljs-comment">// æ•°æ®è½¬æ¢ç®¡é“</span>
    <span class="hljs-keyword">let</span> processedData = validation.<span class="hljs-property">data</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> transformer <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">transformers</span>) {
      processedData = <span class="hljs-title function_">transformer</span>(processedData);
    }
    
    <span class="hljs-comment">// æ‰§è¡Œæäº¤å¤„ç†å™¨</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> handler <span class="hljs-keyword">of</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">submitHandlers</span>) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-title function_">handler</span>(processedData);
        <span class="hljs-keyword">if</span> (result === <span class="hljs-literal">false</span> || result?.<span class="hljs-property">stopPropagation</span>) {
          <span class="hljs-keyword">break</span>;
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Submit handler error:'</span>, error);
        <span class="hljs-keyword">break</span>;
      }
    }
  }

  <span class="hljs-comment">// é‡ç½®è¡¨å•</span>
  <span class="hljs-title function_">reset</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">form</span>.<span class="hljs-title function_">reset</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fields</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">field, name</span>) =&gt;</span> {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">clearFieldError</span>(name);
    });
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;
  }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-keyword">const</span> formProcessor = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormProcessor</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'myForm'</span>))
  .<span class="hljs-title function_">addValidator</span>(<span class="hljs-string">'email'</span>, <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">return</span> <span class="hljs-string">'Email is required'</span>;
    <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.<span class="hljs-title function_">test</span>(value)) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'Invalid email format'</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  })
  .<span class="hljs-title function_">addValidator</span>(<span class="hljs-string">'password'</span>, <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">return</span> <span class="hljs-string">'Password is required'</span>;
    <span class="hljs-keyword">if</span> (value.<span class="hljs-property">length</span> &lt; <span class="hljs-number">8</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'Password must be at least 8 characters'</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  })
  .<span class="hljs-title function_">addTransformer</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-comment">// è½¬æ¢æ•°æ®</span>
    <span class="hljs-keyword">return</span> {
      ...data,
      <span class="hljs-attr">email</span>: data.<span class="hljs-property">email</span>.<span class="hljs-title function_">toLowerCase</span>().<span class="hljs-title function_">trim</span>(),
      <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
    };
  })
  .<span class="hljs-title function_">onSubmit</span>(<span class="hljs-keyword">async</span> (data) =&gt; {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Submitting data:'</span>, data);
    
    <span class="hljs-comment">// æ¨¡æ‹ŸAPIè°ƒç”¨</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/register'</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
      <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
      <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)
    });
    
    <span class="hljs-keyword">if</span> (!response.<span class="hljs-property">ok</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Registration failed'</span>);
    }
    
    <span class="hljs-title function_">alert</span>(<span class="hljs-string">'Registration successful!'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  })
  .<span class="hljs-title function_">onSubmit</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-comment">// ç¬¬äºŒä¸ªå¤„ç†å™¨ï¼šå‘é€åˆ†æäº‹ä»¶</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Analytics event sent for registration'</span>);
  });
</code></pre>
<h4 data-id="heading-24">ä¸ƒã€æœ€ä½³å®è·µä¸æ³¨æ„äº‹é¡¹</h4>
<h5 data-id="heading-25">7.1 ä¸­é—´ä»¶æ¨¡å¼æœ€ä½³å®è·µ</h5>
<ol>
<li><strong>ä¿æŒä¸­é—´ä»¶ç®€æ´å•ä¸€:</strong> æ¯ä¸ªä¸­é—´ä»¶åªåšä¸€ä»¶äº‹</li>
<li><strong>é”™è¯¯å¤„ç†:</strong> ç¡®ä¿ä¸­é—´ä»¶æœ‰é€‚å½“çš„é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li><strong>æ€§èƒ½è€ƒè™‘:</strong> é¿å…åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ˜‚è´µçš„åŒæ­¥æ“ä½œ</li>
<li><strong>é¡ºåºå¾ˆé‡è¦:</strong> æ³¨æ„ä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåºå¯¹ä¸šåŠ¡é€»è¾‘çš„å½±å“</li>
</ol>
<h5 data-id="heading-26">7.2 ç®¡é“æ¨¡å¼æœ€ä½³å®è·µ</h5>
<ol>
<li><strong>çº¯å‡½æ•°ä¼˜å…ˆ:</strong> ç¡®ä¿ç®¡é“ä¸­çš„å‡½æ•°æ˜¯çº¯å‡½æ•°ï¼Œé¿å…å‰¯ä½œç”¨</li>
<li><strong>ç±»å‹æ£€æŸ¥:</strong> è€ƒè™‘æ·»åŠ è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥</li>
<li><strong>é”™è¯¯å¤„ç†:</strong> ç°ç®¡é“çº§åˆ«çš„é”™è¯¯å¤„ç†æœºåˆ¶</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–:</strong> è€ƒè™‘ä½¿ç”¨æµå¼å¤„ç†å¤§æ•°æ®é›†</li>
</ol>
<h5 data-id="heading-27">7.3 é“¾å¼è°ƒç”¨æœ€ä½³å®è·µ</h5>
<ol>
<li><strong>è¿”å›this:</strong> ç¡®ä¿æ¯ä¸ªé“¾å¼æ–¹æ³•éƒ½è¿”å›å®ä¾‹æœ¬èº«</li>
<li><strong>ä¸å¯å˜æ“ä½œ:</strong> è€ƒè™‘å®ç°ä¸å¯å˜ç‰ˆæœ¬çš„é“¾å¼è°ƒç”¨</li>
<li><strong>æ¸…æ™°çš„æ–¹æ³•å:</strong> æ–¹æ³•ååº”è¯¥æ¸…æ™°è¡¨è¾¾å…¶åŠŸèƒ½</li>
<li><strong>æ–‡æ¡£å®Œå–„:</strong> é“¾å¼è°ƒç”¨å¯èƒ½éšè—å¤æ‚åº¦ï¼Œéœ€è¦è‰¯å¥½æ–‡æ¡£</li>
</ol>
<h5 data-id="heading-28">7.4 æƒ°æ€§åŠ è½½æœ€ä½³å®è·µ</h5>
<ol>
<li><strong>é€‚åº¦ä½¿ç”¨:</strong> ä¸è¦è¿‡åº¦ä½¿ç”¨æƒ°æ€§åŠ è½½ï¼Œä¼šå¢åŠ å¤æ‚åº¦</li>
<li><strong>é¢„åŠ è½½ç­–ç•¥:</strong> å¯¹äºå¯èƒ½å¾ˆå¿«éœ€è¦çš„å†…å®¹ï¼Œè€ƒè™‘é¢„åŠ è½½</li>
<li><strong>é”™è¯¯å¤„ç†:</strong> ç¡®ä¿æƒ°æ€§åŠ è½½å¤±è´¥æ—¶æœ‰é™çº§æ–¹æ¡ˆ</li>
<li><strong>ç”¨æˆ·åé¦ˆ:</strong> åŠ è½½è¿‡ç¨‹ä¸­ç»™ç”¨æˆ·é€‚å½“çš„åé¦ˆ</li>
</ol>
<h4 data-id="heading-29">æ€»ç»“</h4>
<p>è¿™å››ç§å‰ç«¯æ¨¡å¼-ä¸­é—´ä»¶æ¨¡å¼ã€ç®¡é“æ¨¡å¼ã€é“¾å¼è°ƒç”¨å’Œæƒ°æ€§åŠ è½½---éƒ½æ˜¯ç°ä»£å‰ç«¯å¼€å‘ä¸­æå…¶æœ‰ç”¨çš„å·¥å…·ã€‚å®ƒä»¬å„è‡ªè§£å†³äº†ä¸åŒçš„é—®é¢˜:</p>
<ul>
<li><strong>ä¸­é—´ä»¶æ¨¡å¼</strong>æä¾›äº†å¤„ç†å¤æ‚æµç¨‹çš„æ¨¡å—åŒ–æ–¹å¼</li>
<li><strong>ç®¡é“æ¨¡å¼</strong>è®©æ•°æ®è½¬æ¢å˜å¾—æ¸…æ™°å’Œå¯ç»„åˆ</li>
<li><strong>é“¾å¼è°ƒç”¨</strong>åˆ›é€ äº†æµç•…ã€æ˜“è¯»çš„API</li>
<li><strong>æƒ°æ€§åŠ è½½</strong>ä¼˜åŒ–äº†æ€§èƒ½å’Œèµ„æºä½¿ç”¨</li>
</ul>
<p>æŒæ¡è¿™äº›æ¨¡å¼å¹¶çŸ¥é“ä½•æ—¶ä½¿ç”¨å®ƒä»¬ï¼Œå°†å¸®åŠ©ä½ ç¼–å†™æ›´å¯ç»´æŠ¤ã€æ›´é«˜æ•ˆçš„å‰ç«¯ä»£ç ã€‚è®°ä½ï¼Œè®¾è®¡æ¨¡å¼æ˜¯å·¥å…·ï¼Œè€Œä¸æ˜¯é“¶å¼¹ã€‚æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©æœ€åˆé€‚çš„æ¨¡å¼ï¼Œå¹¶å§‹ç»ˆä»¥ä»£ç æ¸…æ™°æ€§å’Œå¯ç»´æŠ¤æ€§ä¸ºé¦–è¦è€ƒè™‘ã€‚</p>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œè¿™äº›æ¨¡å¼ç»å¸¸ç»„åˆä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªAPIå®¢æˆ·ç«¯å¯èƒ½åŒæ—¶ä½¿ç”¨ä¸­é—´ä»¶æ¨¡å¼å¤„ç†è¯·æ±‚ã€ç®¡é“æ¨¡å¼å¤„ç†æ•°æ®è½¬æ¢ã€é“¾å¼è°ƒç”¨æä¾›æµç•…APIï¼Œå¹¶åœ¨é€‚å½“çš„åœ°æ–¹ä½¿ç”¨æƒ°æ€§åŠ è½½ä¼˜åŒ–æ€§èƒ½ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ åœ¨å‰ç«¯å¼€å‘ä¸­æ›´å¥½åœ°åº”ç”¨è¿™äº›å¼ºå¤§çš„æ¨¡å¼ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Django 6.0æ¥è¢­ï¼è¿™äº›æ–°ç‰¹æ€§ï¼ŒçœŸçš„ä»¤äººæŒ¯å¥‹ï¼]]></title>    <link>https://juejin.cn/post/7582786655474171947</link>    <guid>https://juejin.cn/post/7582786655474171947</guid>    <pubDate>2025-12-13T03:04:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582786655474171947" data-draft-id="7582785032852701247" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Django 6.0æ¥è¢­ï¼è¿™äº›æ–°ç‰¹æ€§ï¼ŒçœŸçš„ä»¤äººæŒ¯å¥‹ï¼"/> <meta itemprop="keywords" content="Python,Django,äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2025-12-13T03:04:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å€”å¼ºé’é“œä¸‰"/> <meta itemprop="url" content="https://juejin.cn/user/2942757076730455"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Django 6.0æ¥è¢­ï¼è¿™äº›æ–°ç‰¹æ€§ï¼ŒçœŸçš„ä»¤äººæŒ¯å¥‹ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2942757076730455/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å€”å¼ºé’é“œä¸‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T03:04:24.000Z" title="Sat Dec 13 2025 03:04:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fadamj.eu%2Ftech%2F2025%2F12%2F03%2Fdjango-whats-new-6.0%2F" target="_blank" title="https://adamj.eu/tech/2025/12/03/django-whats-new-6.0/" ref="nofollow noopener noreferrer">adamj.eu/tech/2025/1â€¦</a><br/>
ä½œè€…ï¼šAdam Johnson<br/>
è¯‘è€…ï¼šå€”å¼ºé’é“œä¸‰</p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯<strong>å€”å¼ºé’é“œä¸‰</strong>ã€‚æ¬¢è¿å…³æ³¨æˆ‘ï¼Œ<strong>å¾®ä¿¡å…¬ä¼—å·ï¼šå€”å¼ºé’é“œä¸‰</strong>ã€‚æ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼ï¼</p>
<p>Django 6.0 å·²äº 2025 å¹´ 12 æœˆ 3 æ—¥å‘å¸ƒï¼Œä¸ºè¿™ä¸ªå·²ç» 20 å²çš„ Python Web æ¡†æ¶å¼€å¯äº†æ–°çš„å‘å¸ƒå‘¨æœŸã€‚è¯¥ç‰ˆæœ¬å¸¦æ¥äº†ä¼—å¤šæ–°ç‰¹æ€§ï¼Œä»¥ä¸‹æ˜¯å…¶ä¸­çš„ä¸€äº›äº®ç‚¹ã€‚</p>
<h2 data-id="heading-1">ä½¿ç”¨ django-upgrade å‡çº§é¡¹ç›®</h2>
<p>å¦‚æœä½ æ­£åœ¨ä» Django 5.2 æˆ–æ›´æ—©ç‰ˆæœ¬å‡çº§é¡¹ç›®ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨æˆ‘çš„å·¥å…· <a href="https://link.juejin.cn?target=https%3A%2F%2Fdjango-upgrade.readthedocs.io%2Fen%2Flatest%2F" target="_blank" title="https://django-upgrade.readthedocs.io/en/latest/" ref="nofollow noopener noreferrer">django-upgrade</a>ã€‚å®ƒä¼šè‡ªåŠ¨æ›´æ–°æ—§çš„ Django ä»£ç ä»¥ä½¿ç”¨æ–°ç‰¹æ€§ï¼Œä¿®å¤ä¸€äº›å¼ƒç”¨è­¦å‘Šï¼ŒåŒ…æ‹¬é’ˆå¯¹ Django 6.0 çš„äº”ä¸ªä¿®å¤ç¨‹åºã€‚</p>
<h2 data-id="heading-2">æ¨¡æ¿å±€éƒ¨å®šä¹‰ï¼ˆTemplate Partialsï¼‰</h2>
<p>Django æ¨¡æ¿è¯­è¨€ç°åœ¨æ”¯æŒæ¨¡æ¿å±€éƒ¨å®šä¹‰ï¼ˆtemplate partialsï¼‰ï¼Œè¿™ä½¿å¾—åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­å°è£…å’Œé‡ç”¨å°å‹å‘½åç‰‡æ®µå˜å¾—æ›´åŠ å®¹æ˜“ã€‚å±€éƒ¨å®šä¹‰ç”±æ–°çš„ <code>{% partialdef %}</code> å’Œ <code>{% endpartialdef %}</code> æ ‡ç­¾æ ‡è®°ï¼Œå¯ä»¥åœ¨åŒä¸€æ¨¡æ¿ä¸­é‡å¤ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å•ç‹¬æ¸²æŸ“ã€‚</p>
<h3 data-id="heading-3">åœ¨åŒä¸€æ¨¡æ¿ä¸­é‡å¤ä½¿ç”¨å±€éƒ¨å®šä¹‰</h3>
<p>ä»¥ä¸‹æ¨¡æ¿åœ¨åŒä¸€ä¸ªæ¨¡æ¿ä¸­é‡å¤ä½¿ç”¨äº†ä¸€ä¸ªåä¸º <code>filter_controls</code> çš„å±€éƒ¨å®šä¹‰ã€‚å®ƒåœ¨æ¨¡æ¿é¡¶éƒ¨å®šä¹‰ä¸€æ¬¡ï¼Œç„¶ååœ¨åé¢ä¸¤æ¬¡ä½¿ç”¨ã€‚ä½¿ç”¨å±€éƒ¨å®šä¹‰å¯ä»¥è®©æ¨¡æ¿é¿å…é‡å¤ï¼Œè€Œæ— éœ€å°†å†…å®¹æ¨é€åˆ°å•ç‹¬çš„åŒ…å«æ–‡ä»¶ä¸­ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"videos"</span>&gt;</span>
  {% partialdef filter_controls %}
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span>
      {{ filter_form }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
  {% endpartialdef %}

  {% partial filter_controls %}

  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    {% for video in videos %}
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{{ video.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        ...
      <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    {% endfor %}
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>

  {% partial filter_controls %}
<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
</code></pre>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ <code>partialdef</code> æ ‡ç­¾ä¸Šä½¿ç”¨ <code>inline</code> é€‰é¡¹ï¼Œè¿›ä¸€æ­¥ç®€åŒ–è¿™ç§æ¨¡å¼ï¼Œè¿™ä¼šå¯¼è‡´å®šä¹‰åœ¨åŸåœ°æ¸²æŸ“ã€‚</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"videos"</span>&gt;</span>
  {% partialdef filter_controls inline %}
    <span class="hljs-tag">&lt;<span class="hljs-name">form</span>&gt;</span>
      {{ filter_form }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
  {% endpartialdef %}

  <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
    {% for video in videos %}
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{{ video.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        ...
      <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    {% endfor %}
  <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>

  {% partial filter_controls %}
<span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
</code></pre>
<p>å½“ä½ å‘ç°è‡ªå·±åœ¨åŒä¸€ä¸ªæ¨¡æ¿ä¸­é‡å¤æ¨¡æ¿ä»£ç æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚å› ä¸ºå±€éƒ¨å®šä¹‰å¯ä»¥ä½¿ç”¨å˜é‡ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥æ¶ˆé™¤é‡å¤ï¼Œå½“æ¸²æŸ“å…·æœ‰ä¸åŒæ•°æ®çš„ç±»ä¼¼æ§ä»¶æ—¶ã€‚</p>
<h3 data-id="heading-4">å•ç‹¬æ¸²æŸ“å±€éƒ¨å®šä¹‰</h3>
<p>ä»¥ä¸‹æ¨¡æ¿å®šä¹‰äº†ä¸€ä¸ª <code>view_count</code> å±€éƒ¨å®šä¹‰ï¼Œå®ƒæ—¨åœ¨å•ç‹¬é‡æ–°æ¸²æŸ“ã€‚å®ƒä½¿ç”¨äº† <code>inline</code> é€‰é¡¹ï¼Œå› æ­¤å½“æ•´ä¸ªæ¨¡æ¿è¢«æ¸²æŸ“æ—¶ï¼Œå±€éƒ¨å®šä¹‰ä¼šè¢«åŒ…å«ã€‚</p>
<p>é¡µé¢ä½¿ç”¨äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fhtmx.org%2F" target="_blank" title="https://htmx.org/" ref="nofollow noopener noreferrer">htmx</a>ï¼Œé€šè¿‡æˆ‘çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdjango-htmx.readthedocs.io%2Fen%2Flatest%2F" target="_blank" title="https://django-htmx.readthedocs.io/en/latest/" ref="nofollow noopener noreferrer">django-htmx åŒ…</a>ï¼Œé€šè¿‡ <code>hx-*</code> å±æ€§å®šæœŸåˆ·æ–°æŸ¥çœ‹æ¬¡æ•°ã€‚æ¥è‡ª htmx çš„è¯·æ±‚ä¼šå‘é€åˆ°ä¸€ä¸ªä¸“ç”¨è§†å›¾ï¼Œè¯¥è§†å›¾é‡æ–°æ¸²æŸ“ <code>view_count</code> å±€éƒ¨å®šä¹‰ã€‚</p>
<pre><code class="hljs language-html" lang="html">{% load django_htmx %}
<span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{{ video.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">video</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"1280"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"720"</span> <span class="hljs-attr">controls</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"{{ video.file.url }}"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"video/mp4"</span>&gt;</span>
      Your browser does not support the video tag.
    <span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>

    {% partialdef view_count inline %}
    <span class="hljs-tag">&lt;<span class="hljs-name">section</span>
      <span class="hljs-attr">class</span>=<span class="hljs-string">"view-count"</span>
      <span class="hljs-attr">hx-trigger</span>=<span class="hljs-string">"every 1s"</span>
      <span class="hljs-attr">hx-swap</span>=<span class="hljs-string">"outerHTML"</span>
      <span class="hljs-attr">hx-get</span>=<span class="hljs-string">"{% url 'video-view-count' video.id %}"</span>
    &gt;</span>
      {{ video.view_count }} views
    <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
    {% endpartialdef %}

    {% htmx_script %}
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>ä¸¤ä¸ªè§†å›¾çš„ç›¸å…³ä»£ç å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> render

<span class="hljs-keyword">def</span> <span class="hljs-title function_">video</span>(<span class="hljs-params">request, video_id</span>):
    ...
    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">"video.html"</span>, {<span class="hljs-string">"video"</span>: video})

<span class="hljs-keyword">def</span> <span class="hljs-title function_">video_view_count</span>(<span class="hljs-params">request, video_id</span>):
    ...
    <span class="hljs-keyword">return</span> render(request, <span class="hljs-string">"video.html#view_count"</span>, {<span class="hljs-string">"video"</span>: video})
</code></pre>
<p>åˆå§‹çš„ <code>video</code> è§†å›¾æ¸²æŸ“äº†å®Œæ•´çš„æ¨¡æ¿ <code>video.html</code>ã€‚<code>video_view_count</code> è§†å›¾é€šè¿‡åœ¨æ¨¡æ¿åç§°åé™„åŠ  <code>#view_count</code> æ¥ä»…æ¸²æŸ“ <code>view_count</code> å±€éƒ¨å®šä¹‰ã€‚è¿™ç§è¯­æ³•ç±»ä¼¼äºåœ¨ URL ä¸­é€šè¿‡å…¶ ID å¼•ç”¨ HTML ç‰‡æ®µçš„æ–¹å¼ã€‚</p>
<h2 data-id="heading-5">ä»»åŠ¡æ¡†æ¶ï¼ˆTasks Frameworkï¼‰</h2>
<p>Django ç°åœ¨åŒ…å«äº†ä¸€ä¸ªå†…ç½®çš„ä»»åŠ¡æ¡†æ¶ï¼Œç”¨äºåœ¨ HTTP è¯·æ±‚ - å“åº”å‘¨æœŸä¹‹å¤–è¿è¡Œä»£ç ã€‚è¿™ä½¿å¾—å¯ä»¥å°†å·¥ä½œï¼ˆå¦‚å‘é€ç”µå­é‚®ä»¶æˆ–å¤„ç†æ•°æ®ï¼‰å¸è½½åˆ°åå°å·¥ä½œç¨‹åºä¸­ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå®šä¹‰å’Œæ’é˜Ÿåå°ä»»åŠ¡çš„æ–° APIâ€”â€”éå¸¸é…·ï¼</p>
<p>åå°ä»»åŠ¡æ˜¯ä¸€ç§åœ¨è¯·æ±‚ - å“åº”å‘¨æœŸä¹‹å¤–è¿è¡Œä»£ç çš„æ–¹å¼ã€‚å®ƒä»¬æ˜¯ Web åº”ç”¨ç¨‹åºä¸­çš„å¸¸è§éœ€æ±‚ï¼Œç”¨äºå‘é€ç”µå­é‚®ä»¶ã€å¤„ç†å›¾åƒã€ç”ŸæˆæŠ¥å‘Šç­‰ã€‚</p>
<p>å†å²ä¸Šï¼ŒDjango æ²¡æœ‰æä¾›ä»»ä½•åå°ä»»åŠ¡ç³»ç»Ÿï¼Œè€Œæ˜¯å®Œå…¨å¿½ç•¥äº†è¿™ä¸ªé—®é¢˜ã€‚å¼€å‘äººå‘˜ä¾èµ–äºç¬¬ä¸‰æ–¹åŒ…ï¼Œå¦‚ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.celeryq.dev%2Fen%2Fstable%2F" target="_blank" title="https://docs.celeryq.dev/en/stable/" ref="nofollow noopener noreferrer">Celery</a> æˆ– <a href="https://link.juejin.cn?target=https%3A%2F%2Fdjango-q2.readthedocs.io%2Fen%2Fmaster%2F" target="_blank" title="https://django-q2.readthedocs.io/en/master/" ref="nofollow noopener noreferrer">Django Q2</a>ã€‚å°½ç®¡è¿™äº›ç³»ç»Ÿå¾ˆå¥½ï¼Œä½†å®ƒä»¬è®¾ç½®å’Œç»´æŠ¤èµ·æ¥å¯èƒ½å¾ˆå¤æ‚ï¼Œè€Œä¸”é€šå¸¸ä¸ç¬¦åˆ Django çš„â€œè‡ªç„¶â€é£æ ¼ã€‚</p>
<p>æ–°çš„ä»»åŠ¡æ¡†æ¶é€šè¿‡æä¾›ä¸€ä¸ªå®šä¹‰åå°ä»»åŠ¡çš„æ¥å£æ¥å¡«è¡¥è¿™ä¸€ç©ºç™½ï¼Œä»»åŠ¡è¿è¡Œå™¨åŒ…å¯ä»¥ä¸ä¹‹é›†æˆã€‚è¿™ä¸ªå…±åŒçš„åŸºç¡€å…è®¸ç¬¬ä¸‰æ–¹ Django åŒ…ä»¥æ ‡å‡†æ–¹å¼å®šä¹‰ä»»åŠ¡ï¼Œå‡è®¾ä½ ä¼šä½¿ç”¨å…¼å®¹çš„ä»»åŠ¡è¿è¡Œå™¨æ¥æ‰§è¡Œå®ƒä»¬ã€‚</p>
<p>ä½¿ç”¨æ–°çš„ <code>@task</code> è£…é¥°å™¨å®šä¹‰ä»»åŠ¡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.tasks <span class="hljs-keyword">import</span> task

<span class="hljs-meta">@task</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">resize_video</span>(<span class="hljs-params">video_id</span>):
    ...
</code></pre>
<p>ç„¶åä½¿ç”¨ <code>Task.enqueue()</code> æ–¹æ³•å°†å®ƒä»¬æ’é˜Ÿè¿›è¡Œåå°æ‰§è¡Œï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> example.tasks <span class="hljs-keyword">import</span> resize_video

<span class="hljs-keyword">def</span> <span class="hljs-title function_">upload_video</span>(<span class="hljs-params">request</span>):
    ...
    resize_video.enqueue(video.<span class="hljs-built_in">id</span>)
    ...
</code></pre>
<h3 data-id="heading-6">æ‰§è¡Œä»»åŠ¡</h3>
<p>ç›®å‰ï¼ŒDjango å¹¶æ²¡æœ‰åŒ…å«ä¸€ä¸ªç”Ÿäº§å°±ç»ªçš„ä»»åŠ¡åç«¯ï¼Œåªæœ‰ä¸¤ä¸ªé€‚ç”¨äºå¼€å‘å’Œæµ‹è¯•çš„åç«¯ï¼š</p>
<ul>
<li><code>ImmediateBackend</code>ï¼šåŒæ­¥è¿è¡Œä»»åŠ¡ï¼Œç›´åˆ°å®ƒä»¬å®Œæˆæ‰ä¼šé˜»å¡ã€‚</li>
<li><code>DummyBackend</code>ï¼šå½“ä»»åŠ¡è¢«æ’é˜Ÿæ—¶ä»€ä¹ˆéƒ½ä¸åšï¼Œä½†å…è®¸ä¹‹åæ£€æŸ¥ä»»åŠ¡ã€‚åœ¨æµ‹è¯•ä¸­å¾ˆæœ‰ç”¨ï¼Œä½ å¯ä»¥æ–­è¨€ä»»åŠ¡è¢«æ’é˜Ÿäº†ï¼Œè€Œæ— éœ€å®é™…è¿è¡Œå®ƒä»¬ã€‚</li>
</ul>
<p>å¯¹äºç”Ÿäº§ä½¿ç”¨ï¼Œä½ éœ€è¦ä½¿ç”¨ä¸€ä¸ªç¬¬ä¸‰æ–¹åŒ…ï¼Œå…¶ä¸­ <a href="https://link.juejin.cn?target=https%3A%2F%2Fpypi.org%2Fproject%2Fdjango-tasks%2F" target="_blank" title="https://pypi.org/project/django-tasks/" ref="nofollow noopener noreferrer">django-tasks</a> æ˜¯ä¸»è¦çš„é€‰æ‹©ã€‚å®ƒæä¾›äº† <code>DatabaseBackend</code>ï¼Œç”¨äºå°†ä»»åŠ¡å­˜å‚¨åœ¨ä½ çš„ SQL æ•°æ®åº“ä¸­ï¼Œå¯¹äºè®¸å¤šé¡¹ç›®æ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œé¿å…äº†é¢å¤–çš„åŸºç¡€è®¾æ–½ï¼Œå¹¶å…è®¸åœ¨æ•°æ®åº“äº‹åŠ¡ä¸­åŸå­æ€§åœ°æ’é˜Ÿä»»åŠ¡ã€‚æˆ‘ä»¬å¯èƒ½ä¼šåœ¨é€‚å½“çš„æ—¶å€™çœ‹åˆ°è¿™ä¸ªåç«¯åˆå¹¶åˆ° Django ä¸­ï¼Œæˆ–è€…è‡³å°‘æˆä¸ºä¸€ä¸ªå®˜æ–¹åŒ…ï¼Œä»¥å¸®åŠ©ä½¿ Django åœ¨åå°ä»»åŠ¡æ–¹é¢â€œå¼€ç®±å³ç”¨â€ã€‚</p>
<p>è¦ä½¿ç”¨ django-tasks çš„ <code>DatabaseBackend</code>ï¼Œé¦–å…ˆå®‰è£…è¯¥åŒ…ï¼š</p>
<p>å…¶æ¬¡ï¼Œå°†è¿™ä¸¤ä¸ªåº”ç”¨æ·»åŠ åˆ°ä½ çš„ <code>INSTALLED_APPS</code> è®¾ç½®ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python">INSTALLED_APPS = [
    <span class="hljs-comment"># ...</span>
    <span class="hljs-string">"django_tasks"</span>,
    <span class="hljs-string">"django_tasks.backends.database"</span>,
    <span class="hljs-comment"># ...</span>
]
</code></pre>
<p>ç¬¬ä¸‰ï¼Œå°† <code>DatabaseBackend</code> é…ç½®ä¸ºä½ çš„ä»»åŠ¡åç«¯ï¼Œä½¿ç”¨æ–°çš„ <code>TASKS</code> è®¾ç½®ï¼š</p>
<pre><code class="hljs language-python" lang="python">TASKS = {
    <span class="hljs-string">"default"</span>: {
        <span class="hljs-string">"BACKEND"</span>: <span class="hljs-string">"django_tasks.backends.database.DatabaseBackend"</span>,
    },
}
</code></pre>
<p>ç¬¬å››ï¼Œè¿è¡Œè¿ç§»ä»¥åˆ›å»ºå¿…è¦çš„æ•°æ®åº“è¡¨ã€‚</p>
<p>æœ€åï¼Œè¦è¿è¡Œä»»åŠ¡å·¥ä½œè¿›ç¨‹ï¼Œä½¿ç”¨åŒ…çš„ <code>db_worker</code> ç®¡ç†å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ ./manage.py db_worker
Starting worker worker_id=jWLMLrms3C2NcUODYeatsqCFvd5rK6DM queues=default
</code></pre>
<p>è¯¥è¿›ç¨‹ä¼šæ— é™æœŸè¿è¡Œï¼Œè½®è¯¢ä»»åŠ¡å¹¶æ‰§è¡Œå®ƒä»¬ï¼ŒåŒæ—¶è®°å½•äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Task <span class="hljs-built_in">id</span>=10b794ed-9b64-4eed-950c-fcc92cd6784b path=example.tasks.echo state=RUNNING
Hello from <span class="hljs-built_in">test</span> task!
Task <span class="hljs-built_in">id</span>=10b794ed-9b64-4eed-950c-fcc92cd6784b path=example.tasks.echo state=SUCCEEDED
</code></pre>
<p>ä½ å¸Œæœ›åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œ <code>db_worker</code>ï¼Œå¹¶ä¸”å¦‚æœä½ å¸Œæœ›åœ¨å¼€å‘ä¸­æµ‹è¯•åå°ä»»åŠ¡æ‰§è¡Œï¼Œä¹Ÿåº”è¯¥è¿è¡Œå®ƒã€‚</p>
<h2 data-id="heading-7">å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰æ”¯æŒ</h2>
<p>Django ç°åœ¨æä¾›äº†å¯¹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.djangoproject.com%2Fen%2Fstable%2Ftopics%2Fsecurity%2F%23security-csp" target="_blank" title="https://docs.djangoproject.com/en/stable/topics/security/#security-csp" ref="nofollow noopener noreferrer">å†…å®¹å®‰å…¨ç­–ç•¥ï¼ˆCSPï¼‰</a> æ ‡å‡†çš„å†…ç½®æ”¯æŒï¼Œè¿™ä½¿å¾—ä¿æŠ¤ Web åº”ç”¨ç¨‹åºå…å—å†…å®¹æ³¨å…¥æ”»å‡»ï¼ˆå¦‚è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼‰å˜å¾—æ›´åŠ å®¹æ˜“ã€‚CSP å…è®¸é€šè¿‡ä¸ºæµè§ˆå™¨æä¾›ä¸¥æ ¼çš„è§„åˆ™æ¥å£°æ˜å“ªäº›è„šæœ¬ã€æ ·å¼ã€å›¾åƒæˆ–å…¶ä»–èµ„æºå¯ä»¥è¢«åŠ è½½ï¼Œä»è€Œå£°æ˜å¯ä¿¡çš„å†…å®¹æ¥æºã€‚</p>
<p>æˆ‘å¯¹æ­¤æ„Ÿåˆ°éå¸¸å…´å¥‹ï¼Œå› ä¸ºæˆ‘æ˜¯ä¸€ä¸ªå®‰å…¨çˆ±å¥½è€…ï¼Œå¤šå¹´æ¥ä¸€ç›´åœ¨ä¸ºå®¢æˆ·é¡¹ç›®éƒ¨ç½² CSPã€‚</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FGuides%2FCSP" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/HTTP/Guides/CSP" ref="nofollow noopener noreferrer">CSP</a> æ˜¯ä¸€ç§å®‰å…¨æ ‡å‡†ï¼Œå¯ä»¥ä¿æŠ¤ä½ çš„ç½‘ç«™å…å—è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰å’Œå…¶ä»–ä»£ç æ³¨å…¥æ”»å‡»ã€‚ä½ è®¾ç½®ä¸€ä¸ª <code>content-security-policy</code> æ ‡å¤´æ¥å£°æ˜å“ªäº›å†…å®¹æ¥æºå¯¹ä½ çš„ç½‘ç«™æ˜¯å¯ä¿¡çš„ï¼Œç„¶åæµè§ˆå™¨ä¼šé˜»æ­¢æ¥è‡ªå…¶ä»–æ¥æºçš„å†…å®¹ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šå£°æ˜åªæœ‰ä½ åŸŸåä¸‹çš„è„šæœ¬æ‰æ˜¯å…è®¸çš„ï¼Œå› æ­¤å¦‚æœæ”»å‡»è€…è®¾æ³•æ³¨å…¥ä¸€ä¸ªæŒ‡å‘ evil.com çš„ <code>&lt;script&gt;</code> æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šé˜»æ­¢åŠ è½½å®ƒï¼Œå› ä¸ºè¯¥æ¥æºæœªè¢«ä¿¡ä»»ã€‚</p>
<p>ä»¥å‰ï¼ŒDjango æ²¡æœ‰å†…ç½®çš„ CSP æ”¯æŒï¼Œå¼€å‘äººå‘˜ä¸å¾—ä¸ä¾èµ–äºè‡ªå·±æ„å»ºï¼Œæˆ–è€…ä½¿ç”¨åƒéå¸¸æµè¡Œçš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdjango-csp.readthedocs.io%2Fen%2Flatest%2F" target="_blank" title="https://django-csp.readthedocs.io/en/latest/" ref="nofollow noopener noreferrer">django-csp</a> è¿™æ ·çš„ç¬¬ä¸‰æ–¹åŒ…ã€‚ä½†è¿™æœ‰ç‚¹ä¸æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒæ„å‘³ç€å…¶ä»–ç¬¬ä¸‰æ–¹åŒ…æ— æ³•å¯é åœ°ä¸ CSP é›†æˆï¼Œå› ä¸ºæ²¡æœ‰é€šç”¨çš„ API å¯ä»¥ä½¿ç”¨ã€‚</p>
<p>æ–°çš„ CSP æ”¯æŒæä¾›äº† django-csp æ‰€æœ‰çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå¹¶ä¸”å…·æœ‰ç¨å¾®æ•´æ´ä¸€äº›ä¸”æ›´ç¬¦åˆ Django é£æ ¼çš„ APIã€‚è¦å¼€å§‹ä½¿ç”¨ï¼Œ<strong>é¦–å…ˆ</strong> å°† <code>ContentSecurityPolicyMiddleware</code> æ·»åŠ åˆ°ä½ çš„ <code>MIDDLEWARE</code> è®¾ç½®ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python">MIDDLEWARE = [
    <span class="hljs-comment"># ...</span>
    <span class="hljs-string">"django.middleware.csp.ContentSecurityPolicyMiddleware"</span>,
    <span class="hljs-comment"># ...</span>
]
</code></pre>
<p>å°†å…¶æ”¾ç½®åœ¨ <code>SecurityMiddleware</code> é™„è¿‘ï¼Œå› ä¸ºå®ƒç±»ä¼¼äºä¸ºæ‰€æœ‰å“åº”æ·»åŠ å®‰å…¨ç›¸å…³æ ‡å¤´ã€‚ï¼ˆä½ ç¡®å®å¯ç”¨äº† <code>SecurityMiddleware</code>ï¼Œå¯¹å§ï¼Ÿï¼‰</p>
<p><strong>å…¶æ¬¡</strong>ï¼Œä½¿ç”¨æ–°çš„è®¾ç½®é…ç½®ä½ çš„ CSP ç­–ç•¥ï¼š</p>
<ul>
<li><code>SECURE_CSP</code>ï¼šé…ç½® <code>content-security-policy</code> æ ‡å¤´ï¼Œè¿™æ˜¯ä½ å®é™…æ‰§è¡Œçš„ç­–ç•¥ã€‚</li>
<li><code>SECURE_CSP_REPORT_ONLY</code>ï¼šé…ç½® <code>content-security-policy-report-only</code> æ ‡å¤´ï¼Œè¿™è®¾ç½®äº†ä¸€ä¸ªéå¼ºåˆ¶ç­–ç•¥ï¼Œæµè§ˆå™¨ä¼šå‘æŒ‡å®šçš„ç«¯ç‚¹æŠ¥å‘Šè¿åç­–ç•¥çš„æƒ…å†µã€‚è¿™ä¸ªé€‰é¡¹å¯¹äºåœ¨å¼ºåˆ¶æ‰§è¡Œç­–ç•¥ä¹‹å‰æµ‹è¯•å’Œç›‘æ§ç­–ç•¥éå¸¸æœ‰ç”¨ã€‚</li>
</ul>
<p>ä¾‹å¦‚ï¼Œè¦é‡‡ç”¨ web.dev æ¨èçš„åŸºäº nonce çš„ä¸¥æ ¼ CSPï¼Œä½ å¯ä»¥ä»ä»¥ä¸‹è®¾ç½®å¼€å§‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.utils.csp <span class="hljs-keyword">import</span> CSP

SECURE_CSP_REPORT_ONLY = {
    <span class="hljs-string">"script-src"</span>: [CSP.NONCE, CSP.STRICT_DYNAMIC],
    <span class="hljs-string">"object-src"</span>: [CSP.NONE],
    <span class="hljs-string">"base-uri"</span>: [CSP.NONE],
}
</code></pre>
<p>ä¸Šé¢ä½¿ç”¨çš„ <code>CSP</code> æšä¸¾æä¾›äº† CSP æŒ‡ä»¤çš„å¸¸é‡ï¼Œä»¥å¸®åŠ©é¿å…æ‹¼å†™é”™è¯¯ã€‚</p>
<p>è¿™ä¸ªç­–ç•¥éå¸¸ä¸¥æ ¼ï¼Œå¦‚æœç›´æ¥éƒ¨ç½²ï¼Œä¼šç ´åå¤§å¤šæ•°ç°æœ‰ç½‘ç«™ï¼Œå› ä¸ºå®ƒéœ€è¦ä½¿ç”¨ nonceï¼Œæ¥ä¸‹æ¥ä¼šä»‹ç»ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆç¤ºä¾‹ä¸­æ˜¾ç¤ºä»æŠ¥å‘Šæ¨¡å¼æ ‡å¤´å¼€å§‹ï¼Œä»¥å¸®åŠ©åœ¨å¼ºåˆ¶æ‰§è¡Œç­–ç•¥ä¹‹å‰è·Ÿè¸ªéœ€è¦ä¿®å¤çš„åœ°æ–¹ã€‚ä½ ä¹‹åä¼šå°† <code>SECURE_CSP</code> è®¾ç½®æ”¹ä¸ºå¼ºåˆ¶æ‰§è¡Œç­–ç•¥ã€‚</p>
<p>æ€»ä¹‹ï¼Œè¿™äº›å°±æ˜¯è®¾ç½®æ–°çš„ CSP æ”¯æŒçš„ä¸¤ä¸ªåŸºæœ¬æ­¥éª¤ï¼</p>
<h3 data-id="heading-8">éšæœºæ•°ç”Ÿæˆï¼ˆNonce Generationï¼‰</h3>
<p>æ–°ç‰¹æ€§çš„å…³é”®éƒ¨åˆ†ä¹‹ä¸€æ˜¯ï¼Œå½“ä½¿ç”¨ CSP ä¸­é—´ä»¶æ—¶ï¼ŒDjango ç°åœ¨å†…ç½®äº† <strong>éšæœºæ•°ç”Ÿæˆ</strong> åŠŸèƒ½ã€‚éšæœºæ•°æ˜¯ CSP ä¸­çš„ä¸€ç§å®‰å…¨ç‰¹æ€§ï¼Œå…è®¸ä½ é€šè¿‡åœ¨ <code>&lt;script&gt;</code> å’Œ <code>&lt;style&gt;</code> æ ‡ç­¾ä¸Šä½¿ç”¨ <code>nonce</code> å±æ€§æ¥æ ‡è®°ç‰¹å®šçš„æ ‡ç­¾ä¸ºå¯ä¿¡çš„ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/static/app.js"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">nonce</span>=<span class="hljs-string">"55vsH4w7ATHB85C3MbPr_g"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>éšæœºæ•°å€¼æ˜¯æŒ‰è¯·æ±‚éšæœºç”Ÿæˆçš„ï¼Œå¹¶åŒ…å«åœ¨ CSP æ ‡å¤´ä¸­ã€‚æ‰§è¡Œå†…å®¹æ³¨å…¥çš„æ”»å‡»è€…æ— æ³•çŒœæµ‹éšæœºæ•°ï¼Œå› æ­¤æµè§ˆå™¨å¯ä»¥åªä¿¡ä»»é‚£äº›åŒ…å«æ­£ç¡®éšæœºæ•°çš„æ ‡ç­¾ã€‚å› ä¸ºéšæœºæ•°ç”Ÿæˆç°åœ¨æ˜¯ Django çš„ä¸€éƒ¨åˆ†ï¼Œç¬¬ä¸‰æ–¹åŒ…å¯ä»¥ä¾èµ–å®ƒä¸ºå®ƒä»¬çš„ <code>&lt;script&gt;</code> å’Œ <code>&lt;style&gt;</code> æ ‡ç­¾æä¾›éšæœºæ•°ï¼Œå¦‚æœä½ é‡‡ç”¨å¸¦æœ‰éšæœºæ•°çš„ CSPï¼Œå®ƒä»¬å°†ç»§ç»­å·¥ä½œã€‚</p>
<p>éšæœºæ•°æ˜¯å½“ä»Šä½¿ç”¨ CSP çš„æ¨èæ–¹å¼ï¼Œé¿å…äº†ä»¥å‰åŸºäºå…è®¸åˆ—è¡¨çš„æ–¹æ³•æ‰€å¸¦æ¥çš„é—®é¢˜ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸Šé¢æ¨èçš„ç­–ç•¥å¯ç”¨äº†éšæœºæ•°ã€‚è¦é‡‡ç”¨åŸºäºéšæœºæ•°çš„ç­–ç•¥ï¼Œä½ éœ€è¦é€šè¿‡ä»¥ä¸‹æ­¥éª¤ä¸º <code>&lt;script&gt;</code> å’Œ <code>&lt;style&gt;</code> æ ‡ç­¾æ·»åŠ éšæœºæ•°å€¼ã€‚</p>
<p><strong>é¦–å…ˆ</strong>ï¼Œå°†æ–°çš„ <code>csp</code> æ¨¡æ¿ä¸Šä¸‹æ–‡å¤„ç†å™¨æ·»åŠ åˆ°ä½ çš„ <code>TEMPLATES</code> è®¾ç½®ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python">TEMPLATES = [
    {
        <span class="hljs-string">"BACKEND"</span>: <span class="hljs-string">"django.template.backends.django.DjangoTemplates"</span>,
        <span class="hljs-string">"OPTIONS"</span>: {
            <span class="hljs-string">"context_processors"</span>: [
                <span class="hljs-comment"># ...</span>
                <span class="hljs-string">"django.template.context_processors.csp"</span>,
            ],
        },
    },
]
</code></pre>
<p><strong>å…¶æ¬¡</strong>ï¼Œä½¿ç”¨ <code>nonce="{{ csp_nonce }}"</code> ä¸º <code>&lt;script&gt;</code> å’Œ <code>&lt;style&gt;</code> æ ‡ç­¾æ·»åŠ æ³¨é‡Šï¼š</p>
<pre><code class="hljs language-html" lang="html">-   <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"{% static 'app.js' %}"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
+   <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"{% static 'app.js' %}"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">nonce</span>=<span class="hljs-string">"{{ csp_nonce }}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>è¿™å¯èƒ½ä¼šå¾ˆç¹çä¸”å®¹æ˜“å‡ºé”™ï¼Œå› æ­¤é¦–å…ˆä½¿ç”¨æŠ¥å‘Šæ¨¡å¼æ¥ç›‘æ§è¿è§„æƒ…å†µå¯èƒ½ä¼šå¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹é¡¹ç›®ä¸­ã€‚</p>
<p>æ€»ä¹‹ï¼Œæ­£ç¡®éƒ¨ç½² CSP å¯èƒ½ä¼šæˆä¸ºå¦ä¸€ç¯‡åšæ–‡çš„ä¸»é¢˜ï¼Œç”šè‡³æ˜¯ä¸€æœ¬ä¹¦çš„ç« èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å…ˆè¯´åˆ°è¿™é‡Œã€‚æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fweb.dev%2Farticles%2Fstrict-csp" target="_blank" title="https://web.dev/articles/strict-csp" ref="nofollow noopener noreferrer">web.dev æ–‡ç« </a>å’Œ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FHTTP%2FCSP" target="_blank" title="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP" ref="nofollow noopener noreferrer">MDN CSP æŒ‡å—</a>ã€‚</p>
<h2 data-id="heading-9">é‚®ä»¶ API æ›´æ–°</h2>
<p>Django ä¸­çš„é‚®ä»¶å¤„ç†ç°åœ¨ä½¿ç”¨äº† Python çš„ç°ä»£é‚®ä»¶ APIï¼Œè¯¥ API åœ¨ Python 3.6 ä¸­å¼•å…¥ã€‚è¿™ä¸ªä»¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.python.org%2F3%2Flibrary%2Femail.message.html%23email.message.EmailMessage" target="_blank" title="https://docs.python.org/3/library/email.message.html#email.message.EmailMessage" ref="nofollow noopener noreferrer"><code>email.message.EmailMessage</code></a> ç±»ä¸ºä¸­å¿ƒçš„ APIï¼Œä¸ºæ’°å†™å’Œå‘é€é‚®ä»¶æä¾›äº†ä¸€ä¸ªæ›´ç®€æ´ä¸”æ”¯æŒ Unicode çš„æ¥å£ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªé‡å¤§å˜åŒ–ï¼Œä½†å¦‚æœä½ çš„é¡¹ç›®åªä½¿ç”¨åŸºæœ¬çš„é‚®ä»¶åŠŸèƒ½ï¼Œå¯èƒ½ä¸ä¼šå—åˆ°å½±å“ã€‚ä½ ä»ç„¶å¯ä»¥åƒä»¥å‰ä¸€æ ·ä½¿ç”¨ Django çš„ <code>send_mail()</code> å‡½æ•°å’Œ <code>EmailMessage</code> ç±»ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.core.mail <span class="hljs-keyword">import</span> EmailMessage

email = EmailMessage(
    subject=<span class="hljs-string">"ğŸ¼ éœ€è¦æ›´å¤šç«¹å­"</span>,
    body=<span class="hljs-string">"æˆ‘ä»¬çš„ç«¹å­å¿«æ²¡äº†ï¼Œè¯·åœ¨ç†ŠçŒ«å‘ç°ä¹‹å‰è¡¥è´§ï¼"</span>,
    from_email=<span class="hljs-string">"zookeeper@example.com"</span>,
    to=[<span class="hljs-string">"supplies@example.com"</span>],
)
email.attach_file(<span class="hljs-string">"/media/bamboo_cupboard.jpg"</span>)
email.send()
</code></pre>
<p>å…³é”®çš„å˜åŒ–æ˜¯ï¼Œåœ¨ä½ è°ƒç”¨ Django <code>EmailMessage</code> å¯¹è±¡çš„ <code>send()</code> æ–¹æ³•æ—¶ï¼Œå®ƒç°åœ¨ä¼šåœ¨å‘é€ä¹‹å‰å°†è‡ªå·±è½¬æ¢ä¸º Python çš„æ–° <code>email.message.EmailMessage</code> ç±»å‹ã€‚</p>
<p>ç°ä»£åŒ–å¸¦æ¥äº†ä»¥ä¸‹å¥½å¤„ï¼š</p>
<ol>
<li><strong>æ›´å°‘çš„é”™è¯¯</strong>ï¼šPython æ—§é‚®ä»¶ API ä¸­çš„è®¸å¤šè¾¹ç¼˜æƒ…å†µé”™è¯¯å·²åœ¨æ–° API ä¸­ä¿®å¤ã€‚</li>
<li><strong>Django æ›´ç®€æ´</strong>ï¼šDjango é‚®ä»¶ä»£ç ä¸­çš„ä¸€ç³»åˆ—å˜é€šæ–¹æ³•å’Œå®‰å…¨ä¿®å¤å·²è¢«ç§»é™¤ã€‚</li>
<li><strong>æ›´æ–¹ä¾¿çš„ API</strong>ï¼šæ–° API æ”¯æŒä¸€äº›ä¾¿åˆ©åŠŸèƒ½ï¼Œä¾‹å¦‚ä¸‹é¢çš„å†…è”é™„ä»¶ç¤ºä¾‹ã€‚</li>
</ol>
<h3 data-id="heading-10">ä½¿ç”¨ <code>MIMEPart</code> æ›´å®¹æ˜“åœ°æ·»åŠ å†…è”é™„ä»¶</h3>
<p>Django çš„ <code>EmailMessage.attach()</code> æ–¹æ³•å…è®¸ä½ å°†æ–‡ä»¶ä½œä¸ºé™„ä»¶æ·»åŠ ã€‚ç”µå­é‚®ä»¶æ”¯æŒå›¾åƒä½œä¸º <strong>å†…è”é™„ä»¶</strong>ï¼Œè¿™äº›å›¾åƒå¯ä»¥æ˜¾ç¤ºåœ¨ HTML é‚®ä»¶æ­£æ–‡ä¸­ã€‚</p>
<p>è™½ç„¶ä½ ä»¥å‰å¯ä»¥ä½¿ç”¨ <code>EmailMessage.attach()</code> æ·»åŠ å†…è”é™„ä»¶ï¼Œä½†æ“ä½œèµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªé—ç•™ç±»ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥é€šè¿‡è°ƒç”¨è¯¥æ–¹æ³•å¹¶ä¼ å…¥ä¸€ä¸ª Python çš„ <code>email.message.MIMEPart</code> å¯¹è±¡ï¼Œåœ¨å‡ ä¸ªæ­¥éª¤ä¸­æ·»åŠ å†…è”é™„ä»¶ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> email.utils
<span class="hljs-keyword">from</span> email.message <span class="hljs-keyword">import</span> MIMEPart
<span class="hljs-keyword">from</span> django.core.mail <span class="hljs-keyword">import</span> EmailMultiAlternatives

message = EmailMultiAlternatives(
    subject=<span class="hljs-string">"å¯çˆ±ç†ŠçŒ«è­¦æŠ¥"</span>,
    body=<span class="hljs-string">"è¿™é‡Œæœ‰ä¸€å¼ å¯çˆ±çš„ç†ŠçŒ«ç…§ç‰‡é€ç»™ä½ ï¼"</span>,
    from_email=<span class="hljs-string">"cute@example.com"</span>,
    to=[<span class="hljs-string">"fans@example.com"</span>],
)
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">"panda.jpg"</span>, <span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> f:
    panda_jpeg = f.read()

cid = email.utils.make_msgid()
inline_image = MIMEPart()
inline_image.set_content(
    panda_jpeg,
    maintype=<span class="hljs-string">"image"</span>,
    subtype=<span class="hljs-string">"jpeg"</span>,
    disposition=<span class="hljs-string">"inline"</span>,
    cid=cid,
)
message.attach(inline_image)
message.attach_alternative(
    <span class="hljs-string">f'&lt;h1&gt;å¯çˆ±ç†ŠçŒ«å®å®è­¦æŠ¥ï¼&lt;/h1&gt;&lt;img src="cid:<span class="hljs-subst">{cid[<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]}</span>"&gt;'</span>,
    <span class="hljs-string">"text/html"</span>,
)
</code></pre>
<p>è¿™ä¸ª API å¹¶ä¸ç®€å•ï¼Œä½†å®ƒç¡®å®æä¾›äº†åº•å±‚é‚®ä»¶ç³»ç»Ÿçš„å…¨éƒ¨åŠŸèƒ½ï¼Œå¹¶ä¸”æ¯”è¿‡å»çš„æƒ…å†µæ›´å¥½ã€‚</p>
<h2 data-id="heading-11">ä½ç½®å‚æ•°åœ¨ <code>django.core.mail</code> API ä¸­çš„å¼ƒç”¨</h2>
<p>æˆ‘ä»¬ç°åœ¨å·²ç»å®Œæˆäº†ä¸»è¦åŠŸèƒ½ï¼Œæ¥ä¸‹æ¥æ˜¯ä¸ä¸Šè¿°é‚®ä»¶æ›´æ”¹ç›¸å…³çš„â€œæ¬¡è¦â€æ›´æ”¹ï¼Œè¿™æ˜¯ä¸€ä¸ªå¼ƒç”¨è­¦å‘Šï¼š</p>
<blockquote>
<p><code>django.core.mail</code> API ç°åœ¨è¦æ±‚å¯¹äºä¸å¤ªå¸¸ç”¨çš„å‚æ•°ä½¿ç”¨å…³é”®å­—å‚æ•°ã€‚ä½¿ç”¨è¿™äº›å‚æ•°çš„ä½ç½®å‚æ•°ç°åœ¨ä¼šå‘å‡ºä¸€ä¸ªå¼ƒç”¨è­¦å‘Šï¼Œå¹¶ä¸”åœ¨å¼ƒç”¨æœŸç»“æŸåå°†å¼•å‘ä¸€ä¸ª <code>TypeError</code>ï¼š</p>
<ul>
<li>æ‰€æœ‰å¯é€‰å‚æ•°ï¼ˆ<code>fail_silently</code> åŠä¹‹åçš„å‚æ•°ï¼‰å¿…é¡»ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ é€’ç»™ <code>get_connection()</code>ã€<code>mail_admins()</code>ã€<code>mail_managers()</code>ã€<code>send_mail()</code> å’Œ <code>send_mass_mail()</code>ã€‚</li>
<li>åœ¨åˆ›å»º <code>EmailMessage</code> æˆ– <code>EmailMultiAlternatives</code> å®ä¾‹æ—¶ï¼Œé™¤äº†å‰å››ä¸ªå‚æ•°ï¼ˆ<code>subject</code>ã€<code>body</code>ã€<code>from_email</code> å’Œ <code>to</code>ï¼‰å¯ä»¥ä½œä¸ºä½ç½®å‚æ•°æˆ–å…³é”®å­—å‚æ•°ä¼ é€’å¤–ï¼Œæ‰€æœ‰å…¶ä»–å‚æ•°éƒ½å¿…é¡»ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ é€’ã€‚</li>
</ul>
</blockquote>
<p>ä»¥å‰ï¼ŒDjango å…è®¸ä½ å°†æ‰€æœ‰å‚æ•°ä½œä¸ºä½ç½®å‚æ•°ä¼ é€’ï¼Œè¿™åœ¨å‚æ•°åˆ—è¡¨è¾ƒé•¿æ—¶ä¼šæ˜¾å¾—æœ‰äº›æ„šè ¢ä¸”éš¾ä»¥é˜…è¯»ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.core.mail <span class="hljs-keyword">import</span> send_mail

send_mail(
    <span class="hljs-string">"ğŸ¼ æœ¬å‘¨çš„ç†ŠçŒ«"</span>,
    <span class="hljs-string">"æœ¬å‘¨çš„ç†ŠçŒ«æ˜¯ Po Pingï¼Œsha-sha booeyï¼"</span>,
    <span class="hljs-string">"updates@example.com"</span>,
    [<span class="hljs-string">"adam@example.com"</span>],
    <span class="hljs-literal">True</span>,
)
</code></pre>
<p>æœ€åä¸€ä¸ª <code>True</code> æ²¡æœ‰æä¾›ä»»ä½•çº¿ç´¢ï¼Œé™¤éä½ æŸ¥æ‰¾å‡½æ•°ç­¾åã€‚ç°åœ¨ï¼Œä½¿ç”¨è¿™äº›ä¸å¤ªå¸¸ç”¨çš„å‚æ•°çš„ä½ç½®å‚æ•°ä¼šå‘å‡ºä¸€ä¸ªå¼ƒç”¨è­¦å‘Šï¼Œæç¤ºä½ å†™æˆå¦‚ä¸‹å½¢å¼ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.core.mail <span class="hljs-keyword">import</span> send_mail

send_mail(
    subject=<span class="hljs-string">"ğŸ¼ æœ¬å‘¨çš„ç†ŠçŒ«"</span>,
    body=<span class="hljs-string">"æœ¬å‘¨çš„ç†ŠçŒ«æ˜¯ Po Pingï¼Œsha-sha booeyï¼"</span>,
    from_email=<span class="hljs-string">"updates@example.com"</span>,
    recipient_list=[<span class="hljs-string">"adam@example.com"</span>],
    fail_silently=<span class="hljs-literal">True</span>,
)
</code></pre>
<p>è¿™ç§å˜åŒ–æœ‰åŠ©äºæé«˜ API çš„æ¸…æ™°åº¦ï¼ŒDjango æ­£åœ¨é€æ­¥æ›´å¤šåœ°ä½¿ç”¨ä»…å…³é”®å­—å‚æ•°ã€‚django-upgrade å¯ä»¥é€šè¿‡å…¶ <code>mail_api_kwargs</code> ä¿®å¤ç¨‹åºè‡ªåŠ¨ä¸ºä½ ä¿®å¤è¿™ä¸€é—®é¢˜ã€‚</p>
<p>å†æ¬¡æ„Ÿè°¢ Mike Edmunds åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F36163" target="_blank" title="https://code.djangoproject.com/ticket/36163" ref="nofollow noopener noreferrer">Ticket #36163</a> ä¸­æ¨åŠ¨äº†è¿™ä¸€æ”¹è¿›ã€‚</p>
<h2 data-id="heading-12">æ‰©å±•è‡ªåŠ¨ <code>shell</code> å¯¼å…¥</h2>
<p>æ¥ä¸‹æ¥ï¼š</p>
<blockquote>
<p>ç°åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>django.conf.settings</code> ç­‰å¸¸ç”¨å·¥å…·ä¼šè‡ªåŠ¨å¯¼å…¥åˆ° shell ä¸­ã€‚</p>
</blockquote>
<p>Django 5.2 çš„ä¸€ä¸ªä¸»è¦åŠŸèƒ½æ˜¯ <a href="https://link.juejin.cn?target=https%3A%2F%2Fadamj.eu%2Ftech%2F2025%2F04%2F07%2Fdjango-whats-new-5.2%2F%23automatic-model-imports-in-the-shell" target="_blank" title="https://adamj.eu/tech/2025/04/07/django-whats-new-5.2/#automatic-model-imports-in-the-shell" ref="nofollow noopener noreferrer">shell ä¸­çš„è‡ªåŠ¨æ¨¡å‹å¯¼å…¥</a>ï¼Œä½¿å¾— <code>./manage.py shell</code> è‡ªåŠ¨å¯¼å…¥æ‰€æœ‰æ¨¡å‹ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼ŒDjango 6.0 ç°åœ¨è¿˜å¯¼å…¥äº†å…¶ä»–å¸¸ç”¨å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œ <code>./manage.py shell</code> å¹¶æ·»åŠ  <code>-v 2</code> å‚æ•°æ¥æŸ¥çœ‹å®Œæ•´çš„å¯¼å…¥åˆ—è¡¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">$ ./manage.py shell -v 2
6 objects imported automatically:

  from django.conf import settings
  from django.db import connection, models, reset_queries
  from django.db.models import <span class="hljs-built_in">functions</span>
  from django.utils import timezone

...
</code></pre>
<p>ï¼ˆè¿™æ˜¯ä»ä¸€ä¸ªæ²¡æœ‰æ¨¡å‹çš„é¡¹ç›®ä¸­å¾—åˆ°çš„è¾“å‡ºï¼Œå› æ­¤åªåˆ—å‡ºäº†å·¥å…·ã€‚ï¼‰</p>
<p>æ‰€ä»¥ï¼Œè¿™äº›åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>settings</code>ï¼šç”¨äºæ£€æŸ¥è¿è¡Œæ—¶é…ç½®ï¼Œéå¸¸æœ‰ç”¨ï¼š</li>
</ul>
<pre><code class="hljs language-python" lang="python">In [<span class="hljs-number">1</span>]: settings.DEBUG
Out[<span class="hljs-number">1</span>]: <span class="hljs-literal">False</span>
</code></pre>
<ul>
<li><code>connection</code> å’Œ <code>reset_queries()</code>ï¼šéå¸¸é€‚åˆ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.djangoproject.com%2Fen%2Fstable%2Ffaq%2Fmodels%2F%23how-can-i-see-the-raw-sql-queries-django-is-running" target="_blank" title="https://docs.djangoproject.com/en/stable/faq/models/#how-can-i-see-the-raw-sql-queries-django-is-running" ref="nofollow noopener noreferrer">æ£€æŸ¥æ‰§è¡Œçš„æŸ¥è¯¢</a>ï¼š</li>
</ul>
<pre><code class="hljs language-python" lang="python">In [<span class="hljs-number">1</span>]: Book.objects.select_related(<span class="hljs-string">'author'</span>)
Out[<span class="hljs-number">1</span>]: &lt;QuerySet []&gt;

In [<span class="hljs-number">2</span>]: connection.queries
Out[<span class="hljs-number">2</span>]:
[{<span class="hljs-string">'sql'</span>: <span class="hljs-string">'SELECT "example_book"."id", "example_book"."title", "example_book"."author_id", "example_author"."id", "example_author"."name" FROM "example_book" INNER JOIN "example_author" ON ("example_book"."author_id" = "example_author"."id") LIMIT 21'</span>,
    <span class="hljs-string">'time'</span>: <span class="hljs-string">'0.000'</span>}]
</code></pre>
<ul>
<li><code>models</code> å’Œ <code>functions</code>ï¼šå¯¹äºé«˜çº§ ORM å·¥ä½œéå¸¸æœ‰ç”¨ï¼š</li>
</ul>
<pre><code class="hljs language-python" lang="python">In [<span class="hljs-number">1</span>]: Book.objects.annotate(
     ...:   title_lower=functions.Lower(<span class="hljs-string">"title"</span>)
     ...: ).<span class="hljs-built_in">filter</span>(
     ...:   title_lower__startswith=<span class="hljs-string">"a"</span>
     ...: ).count()
Out[<span class="hljs-number">1</span>]: <span class="hljs-number">71</span>
</code></pre>
<ul>
<li><code>timezone</code>ï¼šç”¨äºä½¿ç”¨ Django çš„æ—¶åŒºæ„ŸçŸ¥æ—¥æœŸå’Œæ—¶é—´å·¥å…·ï¼š</li>
</ul>
<pre><code class="hljs language-python" lang="python">In [<span class="hljs-number">1</span>]: timezone.now()
Out[<span class="hljs-number">1</span>]: datetime.datetime(<span class="hljs-number">2025</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">23</span>, <span class="hljs-number">42</span>, <span class="hljs-number">22</span>, <span class="hljs-number">558418</span>, tzinfo=datetime.timezone.utc)
</code></pre>
<p>ä»ç„¶å¯ä»¥æŒ‰ç…§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.djangoproject.com%2Fen%2Fstable%2Fhowto%2Fcustom-shell%2F" target="_blank" title="https://docs.djangoproject.com/en/stable/howto/custom-shell/" ref="nofollow noopener noreferrer">å¦‚ä½•è‡ªå®šä¹‰ <code>shell</code> å‘½ä»¤</a> æ–‡æ¡£é¡µé¢ä¸­æ‰€è¿°ï¼Œæ‰©å±•è‡ªåŠ¨å¯¼å…¥å†…å®¹ã€‚</p>
<p>Salvo Polizzi åœ¨ Django 5.2 ä¸­è´¡çŒ®äº†åŸå§‹çš„è‡ªåŠ¨ shell å¯¼å…¥åŠŸèƒ½ã€‚ç„¶åï¼Œä»–åœ¨ Django 6.0 ä¸­åˆå›æ¥æä¾›äº†è¿™äº›é¢å¤–çš„å¯¼å…¥ï¼Œåœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F35680" target="_blank" title="https://code.djangoproject.com/ticket/35680" ref="nofollow noopener noreferrer">Ticket #35680</a> ä¸­ã€‚æ„Ÿè°¢å‚ä¸è®ºå›è®¨è®ºå¹¶è¾¾æˆä¸€è‡´æ„è§çš„æ¯ä¸ªäººï¼Œä»¥åŠ Natalia Bidart å’Œ Sarah Boyce çš„å®¡æŸ¥ï¼</p>
<h2 data-id="heading-13">ä¿å­˜æ—¶åŠ¨æ€å­—æ®µåˆ·æ–°</h2>
<p>ç°åœ¨è®©æˆ‘ä»¬è®¨è®ºä¸€ç³»åˆ— ORM æ”¹è¿›ï¼Œä»è¿™ä¸ªé‡å¤§æ”¹è¿›å¼€å§‹ï¼š</p>
<blockquote>
<p>åœ¨æ”¯æŒ <code>RETURNING</code> å­å¥çš„åç«¯ï¼ˆSQLiteã€PostgreSQL å’Œ Oracleï¼‰ä¸Šï¼Œ<code>GeneratedField</code> å’Œè¢«èµ‹å€¼ä¸ºè¡¨è¾¾å¼çš„å­—æ®µåœ¨è°ƒç”¨ <code>save()</code> ä¹‹åä¼šä»æ•°æ®åº“ä¸­åˆ·æ–°ã€‚åœ¨ä¸æ”¯æŒå®ƒçš„åç«¯ï¼ˆMySQL å’Œ MariaDBï¼‰ä¸Šï¼Œå­—æ®µä¼šè¢«æ ‡è®°ä¸ºå»¶è¿ŸåŠ è½½ï¼Œä»¥åœ¨åç»­è®¿é—®æ—¶è§¦å‘åˆ·æ–°ã€‚</p>
</blockquote>
<p>Django æ¨¡å‹æ”¯æŒåœ¨ä¸‰ç§æƒ…å†µä¸‹è®©æ•°æ®åº“ä¸ºä½ ç”Ÿæˆå­—æ®µå€¼ï¼š</p>
<ol>
<li><code>db_default</code> å­—æ®µé€‰é¡¹ï¼Œå®ƒå…è®¸æ•°æ®åº“åœ¨åˆ›å»ºå®ä¾‹æ—¶ç”Ÿæˆé»˜è®¤å€¼ï¼š</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models
<span class="hljs-keyword">from</span> django.db.models.functions <span class="hljs-keyword">import</span> Now

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Video</span>(models.Model):
    ...
    created = models.DateTimeField(db_default=Now())
</code></pre>
<ol start="2">
<li><code>GeneratedField</code> å­—æ®µç±»å‹ï¼Œå®ƒå§‹ç»ˆåŸºäºåŒä¸€å®ä¾‹ä¸­çš„å…¶ä»–å­—æ®µç”±æ•°æ®åº“è®¡ç®—å¾—å‡ºï¼š</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models
<span class="hljs-keyword">from</span> django.db.models.functions <span class="hljs-keyword">import</span> Concat

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Video</span>(models.Model):
    ...
    full_title = models.GeneratedField(
        models.TextField(),
        expression=Concat(
            <span class="hljs-string">"title"</span>,
            models.Value(<span class="hljs-string">" - "</span>),
            <span class="hljs-string">"subtitle"</span>,
        ),
    )
</code></pre>
<ol start="3">
<li>åœ¨ä¿å­˜ä¹‹å‰ä¸ºå­—æ®µåˆ†é…è¡¨è¾¾å¼å€¼ï¼š</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models
<span class="hljs-keyword">from</span> django.db.models.functions <span class="hljs-keyword">import</span> Now

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Video</span>(models.Model):
    ...
    last_updated = models.DateTimeField()

video = Video.objects.get(<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>)
...
video.last_updated = Now()
video.save()
</code></pre>
<p>ä»¥å‰ï¼Œåªæœ‰ç¬¬ä¸€ç§æ–¹æ³•ï¼ˆä½¿ç”¨ <code>db_default</code>ï¼‰ä¼šåœ¨ä¿å­˜åä»æ•°æ®åº“ä¸­åˆ·æ–°å­—æ®µå€¼ã€‚å…¶ä»–ä¸¤ç§æ–¹æ³•ä¼šç•™ä¸‹æ—§å€¼æˆ–è¡¨è¾¾å¼å¯¹è±¡ï¼Œè¿™æ„å‘³ç€å¦‚æœä½ éœ€è¦è·å–æ›´æ–°åçš„å€¼ï¼Œå°±éœ€è¦è°ƒç”¨ <code>Model.refresh_from_db()</code>ã€‚è¿™å¾ˆéš¾è®°ä½ï¼Œå¹¶ä¸”ä¼šé¢å¤–äº§ç”Ÿä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢ã€‚</p>
<p>ç°åœ¨ï¼ŒDjango åˆ©ç”¨ <code>RETURNING</code> SQL å­å¥åœ¨æ”¯æŒå®ƒçš„åç«¯ï¼ˆSQLiteã€PostgreSQL å’Œ Oracleï¼‰ä¸Šä¿å­˜æ¨¡å‹å®ä¾‹ï¼Œå¹¶åœ¨å•ä¸ªæŸ¥è¯¢ä¸­è·å–æ›´æ–°åçš„åŠ¨æ€å­—æ®µå€¼ã€‚<code>save()</code> è°ƒç”¨ç°åœ¨å¯èƒ½ä¼šå‘å‡ºå¦‚ä¸‹æŸ¥è¯¢ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">UPDATE</span> "example_video"
<span class="hljs-keyword">SET</span> "last_updated" <span class="hljs-operator">=</span> NOW()
<span class="hljs-keyword">WHERE</span> "example_video"."id" <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
RETURNING "example_video"."last_updated"
</code></pre>
<p>Django å°†è¿”å›å€¼æ”¾å…¥æ¨¡å‹å­—æ®µä¸­ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨ä¿å­˜åç«‹å³è¯»å–å®ƒï¼š</p>
<pre><code class="hljs language-python" lang="python">video = Video.objects.get(<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>)
...
video.last_updated = Now()
video.save()
<span class="hljs-built_in">print</span>(video.last_updated)  <span class="hljs-comment"># æ•°æ®åº“ä¸­çš„æ›´æ–°å€¼</span>
</code></pre>
<p>åœ¨ä¸æ”¯æŒ <code>RETURNING</code>ï¼ˆMySQL å’Œ MariaDBï¼‰çš„åç«¯ä¸Šï¼ŒDjango ç°åœ¨ä¼šåœ¨ä¿å­˜åå°†åŠ¨æ€å­—æ®µæ ‡è®°ä¸ºå»¶è¿ŸåŠ è½½ã€‚è¿™æ ·ï¼Œåç»­è®¿é—®ï¼ˆå¦‚ä¸Šé¢çš„ç¤ºä¾‹ï¼‰å°†è‡ªåŠ¨è°ƒç”¨ <code>Model.refresh_from_db()</code>ã€‚è¿™ç¡®ä¿äº†ä½ æ€»æ˜¯è¯»å–æ›´æ–°åçš„å€¼ï¼Œå³ä½¿è¿™ä¼šé¢å¤–äº§ç”Ÿä¸€ä¸ªæŸ¥è¯¢ã€‚</p>
<h3 data-id="heading-14">å†å²</h3>
<p>è¿™ä¸ªåŠŸèƒ½åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F27222" target="_blank" title="https://code.djangoproject.com/ticket/27222" ref="nofollow noopener noreferrer">Ticket #27222</a> ä¸­äº 2016 å¹´è¢«æå‡ºï¼Œç”± Anssi KÃ¤Ã¤riÃ¤inen æå‡ºã€‚åœ¨è¿‡å»çš„ä¹å¹´ä¸­ï¼Œè¿™ä¸ªæè®®å¤§éƒ¨åˆ†æ—¶é—´éƒ½å¤„äºä¼‘çœ çŠ¶æ€ï¼Œä½† ORM è´Ÿè´£äºº Simon Charette ä»Šå¹´æ—©äº›æ—¶å€™æ¥æ‰‹äº†è¿™ä¸ªåŠŸèƒ½ï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå®ç°æ–¹æ¡ˆï¼Œå¹¶å°†å…¶æ¨åŠ¨å®Œæˆã€‚æ„Ÿè°¢ Simon ç»§ç»­æ¨åŠ¨ ORM çš„å‘å±•ï¼Œä»¥åŠæ‰€æœ‰å‚ä¸å®¡æŸ¥çš„äººå‘˜ï¼šDavid Sandersã€Jacob Wallsã€Mariusz Felisiakã€nessitaã€Paolo Melchiorreã€Simon Charette å’Œ Tim Grahamã€‚</p>
<h2 data-id="heading-15">é€šç”¨ <code>StringAgg</code> èšåˆå‡½æ•°</h2>
<p>æ¥ä¸‹æ¥æ˜¯ ORM çš„å¦ä¸€ä¸ªå˜åŒ–ï¼š</p>
<blockquote>
<p>æ–°çš„ <code>StringAgg</code> èšåˆå‡½æ•°å°†è¾“å…¥å€¼è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»¥ <code>delimiter</code> å­—ç¬¦ä¸²åˆ†éš”ã€‚è¿™ä¸ªèšåˆå‡½æ•°ä»¥å‰ä»…æ”¯æŒ PostgreSQLã€‚</p>
</blockquote>
<p>è¿™ä¸ªèšåˆå‡½æ•°é€šå¸¸ç”¨äºç”Ÿæˆç›¸å…³é¡¹ç›®çš„é€—å·åˆ†éš”åˆ—è¡¨ç­‰ã€‚ä»¥å‰ï¼Œå®ƒä»…ä½œä¸º <code>django.contrib.postgres</code> çš„ä¸€éƒ¨åˆ†æ”¯æŒ PostgreSQLï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.contrib.postgres.aggregates <span class="hljs-keyword">import</span> StringAgg
<span class="hljs-keyword">from</span> example.models <span class="hljs-keyword">import</span> Video

videos = Video.objects.annotate(
    chapter_ids=StringAgg(<span class="hljs-string">"chapter"</span>, delimiter=<span class="hljs-string">","</span>),
)

<span class="hljs-keyword">for</span> video <span class="hljs-keyword">in</span> videos:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Video <span class="hljs-subst">{video.<span class="hljs-built_in">id</span>}</span> has chapters: <span class="hljs-subst">{video.chapter_ids}</span>"</span>)
</code></pre>
<p>è¿™å¯èƒ½ä¼šè¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">Video</span> <span class="hljs-number">104</span> <span class="hljs-selector-tag">has</span> <span class="hljs-selector-tag">chapters</span>: <span class="hljs-number">71</span>,<span class="hljs-number">72</span>,<span class="hljs-number">74</span>
<span class="hljs-selector-tag">Video</span> <span class="hljs-number">107</span> <span class="hljs-selector-tag">has</span> <span class="hljs-selector-tag">chapters</span>: <span class="hljs-number">88</span>,<span class="hljs-number">89</span>,<span class="hljs-number">138</span>,<span class="hljs-number">90</span>,<span class="hljs-number">91</span>,<span class="hljs-number">93</span>
</code></pre>
<p>ç°åœ¨ï¼Œè¿™ä¸ªèšåˆå‡½æ•°å·²ç»å¯ä»¥åœ¨ Django æ”¯æŒçš„æ‰€æœ‰æ•°æ®åº“åç«¯ä¸­ä½¿ç”¨ï¼Œä» <code>django.db.models</code> ä¸­å¯¼å…¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.db.models <span class="hljs-keyword">import</span> StringAgg, Value
<span class="hljs-keyword">from</span> example.models <span class="hljs-keyword">import</span> Video

videos = Video.objects.annotate(
    chapter_ids=StringAgg(<span class="hljs-string">"chapter"</span>, delimiter=Value(<span class="hljs-string">","</span>)),
)

<span class="hljs-keyword">for</span> video <span class="hljs-keyword">in</span> videos:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Video <span class="hljs-subst">{video.<span class="hljs-built_in">id</span>}</span> has chapters: <span class="hljs-subst">{video.chapter_ids}</span>"</span>)
</code></pre>
<p>æ³¨æ„ï¼Œ<code>delimiter</code> å‚æ•°ç°åœ¨éœ€è¦ä¸€ä¸ª <code>Value()</code> è¡¨è¾¾å¼åŒ…è£…å™¨æ¥å¤„ç†å­—é¢å­—ç¬¦ä¸²ï¼Œå¦‚ä¸Šæ‰€ç¤ºã€‚è¿™ç§å˜åŒ–å…è®¸ä½ ä½¿ç”¨æ•°æ®åº“å‡½æ•°æˆ–å­—æ®µä½œä¸ºåˆ†éš”ç¬¦ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚</p>
<p>è™½ç„¶å¤§å¤šæ•° Django é¡¹ç›®éƒ½ä½¿ç”¨ PostgreSQLï¼Œä½†åœ¨æ‰€æœ‰åç«¯ä¸Šæä¾›è¿™ä¸ªèšåˆå‡½æ•°æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ”¹è¿›ï¼Œå®ƒæé«˜äº†è·¨æ•°æ®åº“çš„å…¼å®¹æ€§ï¼Œå¹¶ä¸”æ„å‘³ç€ç¬¬ä¸‰æ–¹åŒ…å¯ä»¥ä½¿ç”¨å®ƒè€Œä¸ä¼šå½±å“å…¶æ•°æ®åº“æ”¯æŒã€‚</p>
<h3 data-id="heading-16">å†å²</h3>
<p>PostgreSQL ç‰¹æœ‰çš„ <code>StringAgg</code> æœ€æ—©åœ¨ Django 1.9ï¼ˆ2015 å¹´ï¼‰ç”± Andriy Sokolovskiy æ·»åŠ ï¼Œè§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F24301" target="_blank" title="https://code.djangoproject.com/ticket/24301" ref="nofollow noopener noreferrer">Ticket #24301</a>ã€‚åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F35444" target="_blank" title="https://code.djangoproject.com/ticket/35444" ref="nofollow noopener noreferrer">Ticket #35444</a> ä¸­ï¼ŒChris Muthig æå‡ºäº†æ·»åŠ  <code>Aggregate.order_by</code> é€‰é¡¹ï¼Œè¿™æ˜¯ <code>StringAgg</code> ç”¨æ¥æŒ‡å®šè¿æ¥å…ƒç´ é¡ºåºçš„é€‰é¡¹ï¼Œè€Œä½œä¸ºå‰¯ä½œç”¨ï¼Œè¿™ä¹Ÿä½¿å¾—å°† <code>StringAgg</code> æ¨å¹¿åˆ°æ‰€æœ‰åç«¯æˆä¸ºå¯èƒ½ã€‚</p>
<p>æ„Ÿè°¢ Chris æå‡ºå¹¶å®ç°äº†è¿™ä¸€å˜åŒ–ï¼Œä»¥åŠæ‰€æœ‰å‚ä¸å®¡æŸ¥çš„äººå‘˜ï¼šPaolo Melchiorreã€Sarah Boyce å’Œ Simon Charetteã€‚</p>
<h2 data-id="heading-17"><code>BigAutoField</code> ä½œä¸ºé»˜è®¤ä¸»é”®ç±»å‹</h2>
<p>æ¥ä¸‹æ¥ï¼š</p>
<blockquote>
<p><code>DEFAULT_AUTO_FIELD</code> è®¾ç½®çš„é»˜è®¤å€¼ç°åœ¨æ”¹ä¸º <code>BigAutoField</code>ã€‚</p>
</blockquote>
<p>è¿™ä¸€é‡è¦å˜åŒ–æœ‰åŠ©äºé”å®šæ›´å¤§è§„æ¨¡çš„å¯æ‰©å±•ä¸»é”®ã€‚</p>
<p>Django 3.2ï¼ˆ2021 å¹´ï¼‰å¼•å…¥äº† <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.djangoproject.com%2Fen%2Fstable%2Fref%2Fsettings%2F%23default-auto-field" target="_blank" title="https://docs.djangoproject.com/en/stable/ref/settings/#default-auto-field" ref="nofollow noopener noreferrer">DEFAULT_AUTO_FIELD è®¾ç½®</a>ï¼Œç”¨äºæ›´æ”¹æ¨¡å‹ä¸­ä½¿ç”¨çš„é»˜è®¤ä¸»é”®ç±»å‹ã€‚Django ä½¿ç”¨è¿™ä¸ªè®¾ç½®ä¸ºæœªæ˜¾å¼å®šä¹‰ä¸»é”®å­—æ®µçš„æ¨¡å‹æ·»åŠ ä¸€ä¸ªåä¸º <code>id</code> çš„ä¸»é”®å­—æ®µã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å®šä¹‰äº†ä¸€ä¸ªæ¨¡å‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.db <span class="hljs-keyword">import</span> models

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Video</span>(models.Model):
    title = models.TextField()
</code></pre>
<p>é‚£ä¹ˆå®ƒå°†æœ‰ä¸¤ä¸ªå­—æ®µï¼š<code>id</code> å’Œ <code>title</code>ï¼Œå…¶ä¸­ <code>id</code> ä½¿ç”¨ <code>DEFAULT_AUTO_FIELD</code> å®šä¹‰çš„ç±»å‹ã€‚</p>
<p>è¿™ä¸ªè®¾ç½®ä¹Ÿå¯ä»¥é€šè¿‡åœ¨åº”ç”¨çš„ <code>apps.py</code> æ–‡ä»¶ä¸­å®šä¹‰ <code>AppConfig.default_auto_field</code> æ¥åœ¨æ¯ä¸ªåº”ç”¨çš„åŸºç¡€ä¸Šè¦†ç›–ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.apps <span class="hljs-keyword">import</span> AppConfig

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChannelConfig</span>(<span class="hljs-title class_ inherited__">AppConfig</span>):
    name = <span class="hljs-string">"channel"</span>
    default_auto_field = <span class="hljs-string">"django.db.models.BigAutoField"</span>
</code></pre>
<p>æ·»åŠ è¿™ä¸ªè®¾ç½®çš„ä¸€ä¸ªä¸»è¦åŠ¨æœºæ˜¯å…è®¸é¡¹ç›®ä» <code>AutoField</code>ï¼ˆ32 ä½æ•´æ•°ï¼‰åˆ‡æ¢åˆ° <code>BigAutoField</code>ï¼ˆ64 ä½æ•´æ•°ï¼‰ä½œä¸ºä¸»é”®ï¼Œè€Œæ— éœ€æ›´æ”¹æ¯ä¸ªæ¨¡å‹ã€‚<code>AutoField</code> å¯ä»¥å­˜å‚¨çš„å€¼æœ€å¤šçº¦ä¸º 21 äº¿ï¼Œè™½ç„¶å¬èµ·æ¥å¾ˆå¤§ï¼Œä½†åœ¨å¤§è§„æ¨¡åº”ç”¨ä¸­å¾ˆå®¹æ˜“è¾¾åˆ°ã€‚<code>BigAutoField</code> å¯ä»¥å­˜å‚¨çš„å€¼æœ€å¤šçº¦ä¸º 92 äº¬ï¼Œè¿™åœ¨å®é™…ç”¨é€”ä¸­æ˜¯â€œç»°ç»°æœ‰ä½™â€çš„ã€‚</p>
<p>å¦‚æœä½¿ç”¨ <code>AutoField</code> çš„æ¨¡å‹è¾¾åˆ°äº†å…¶æœ€å¤§å€¼ï¼Œå®ƒå°†æ— æ³•å†æ¥å—æ–°è¡Œï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º <strong>ä¸»é”®è€—å°½</strong>ã€‚è¯¥è¡¨å®é™…ä¸Šè¢«é˜»å¡äº†ï¼Œéœ€è¦é€šè¿‡é”å®šæ•°æ®åº“è¿ç§»åœ¨å¤§å‹è¡¨ä¸Šç´§æ€¥å°†æ¨¡å‹ä» <code>AutoField</code> åˆ‡æ¢åˆ° <code>BigAutoField</code>ã€‚å…³äº Kraken å¦‚ä½•ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è§‚çœ‹ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DkZ4q0k_FNhw" target="_blank" title="https://www.youtube.com/watch?v=kZ4q0k_FNhw" ref="nofollow noopener noreferrer">Tim Bell åœ¨ 2025 å¹´ DjangoCon Europe çš„æ¼”è®²</a>ï¼Œå…¶ä¸­è¯¦ç»†ä»‹ç»äº†ä¸»åŠ¨è¿ç§»å¤§å‹è¡¨ä»¥å‡å°‘åœæœºæ—¶é—´çš„ä¸€äº›å·§å¦™æŠ€æœ¯ã€‚</p>
<p>ä¸ºäº†é¿å…æ–°é¡¹ç›®å‡ºç°è¿™ä¸ªé—®é¢˜ï¼ŒDjango 3.2 ä½¿å¾—é€šè¿‡ <code>startproject</code> åˆ›å»ºçš„æ–°é¡¹ç›®å°† <code>DEFAULT_AUTO_FIELD</code> è®¾ç½®ä¸º <code>BigAutoField</code>ï¼Œå¹¶ä¸”é€šè¿‡ <code>startapp</code> åˆ›å»ºçš„æ–°åº”ç”¨å°†å®ƒä»¬çš„ <code>AppConfig.default_auto_field</code> è®¾ç½®ä¸º <code>BigAutoField</code>ã€‚å®ƒè¿˜æ·»åŠ äº†ä¸€ä¸ªç³»ç»Ÿæ£€æŸ¥ï¼Œä»¥ç¡®ä¿é¡¹ç›®æ˜¾å¼è®¾ç½® <code>DEFAULT_AUTO_FIELD</code>ï¼Œä»¥ç¡®ä¿ç”¨æˆ·äº†è§£è¯¥åŠŸèƒ½å¹¶èƒ½å¤Ÿåšå‡ºæ˜æ™ºçš„é€‰æ‹©ã€‚</p>
<p>ç°åœ¨ï¼ŒDjango 6.0 å°†è®¾ç½®å’Œåº”ç”¨é…ç½®å±æ€§çš„å®é™…é»˜è®¤å€¼æ”¹ä¸º <code>BigAutoField</code>ã€‚ä½¿ç”¨ <code>BigAutoField</code> çš„é¡¹ç›®å¯ä»¥ç§»é™¤è¯¥è®¾ç½®ï¼š</p>
<pre><code class="hljs language-python" lang="python">-DEFAULT_AUTO_FIELD = <span class="hljs-string">"django.db.models.BigAutoField"</span>
</code></pre>
<p>ä»¥åŠåº”ç”¨é…ç½®å±æ€§ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> django.apps <span class="hljs-keyword">import</span> AppConfig

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ChannelConfig</span>(<span class="hljs-title class_ inherited__">AppConfig</span>):
    name = <span class="hljs-string">"channel"</span>
-    default_auto_field = <span class="hljs-string">"django.db.models.BigAutoField"</span>
</code></pre>
<p>é»˜è®¤çš„ <code>startproject</code> å’Œ <code>startapp</code> æ¨¡æ¿ä¹Ÿä¸å†è®¾ç½®è¿™äº›å€¼ã€‚è¿™ä¸€å˜åŒ–å‡å°‘äº†æ–°é¡¹ç›®çš„æ ·æ¿ä»£ç ï¼Œä¸»é”®è€—å°½é—®é¢˜ä¹Ÿå°†é€æ¸æˆä¸ºå†å²ï¼Œæˆä¸ºå¤§å¤šæ•° Django ç”¨æˆ·ä¸å†éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚</p>
<h3 data-id="heading-18">å†å²</h3>
<p>åœ¨ Django 3.2 ä¸­æ·»åŠ  <code>DEFAULT_AUTO_FIELD</code> æ˜¯ç”± Caio Ariede æå‡ºå¹¶ç”± Tom Forbes å®ç°çš„ï¼Œè§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F31007" target="_blank" title="https://code.djangoproject.com/ticket/31007" ref="nofollow noopener noreferrer">Ticket #31007</a>ã€‚Django 6.0 ä¸­çš„è¿™ä¸€æ–°å˜åŒ–æ˜¯ç”±å‰ Fellow Tim Graham æå‡ºå¹¶å®ç°çš„ï¼Œè§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F36564" target="_blank" title="https://code.djangoproject.com/ticket/36564" ref="nofollow noopener noreferrer">Ticket #36564</a>ã€‚æ„Ÿè°¢ Tim å‘ç°ç°åœ¨å¯ä»¥è¿›è¡Œè¿™ä¸€æ¸…ç†å·¥ä½œï¼Œä»¥åŠ Jacob Walls å’Œ Clifford Gama çš„å®¡æŸ¥ï¼</p>
<h2 data-id="heading-19">æ¨¡æ¿å˜é‡ <code>forloop.length</code></h2>
<p>ç»§ç»­æ¥çœ‹æ¨¡æ¿æ–¹é¢çš„æ”¹è¿›ï¼Œé¦–å…ˆæ˜¯è¿™ä¸ªå°è€Œå®ç”¨çš„æ–°å¢åŠŸèƒ½ï¼š</p>
<blockquote>
<p>åœ¨ <code>for</code> å¾ªç¯ä¸­ç°åœ¨å¯ä»¥ä½¿ç”¨æ–°çš„å˜é‡ <code>forloop.length</code>ã€‚</p>
</blockquote>
<p>è¿™ä¸€å°æ‰©å±•ä½¿å¾—ä½ å¯ä»¥ç¼–å†™å¦‚ä¸‹æ¨¡æ¿å¾ªç¯ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
  {% for goose in geese %}
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>{{ forloop.counter }}/{{ forloop.length }}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>: {{ goose.name }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
  {% endfor %}
<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
</code></pre>
<p>ä»¥å‰ï¼Œä½ éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼å¼•ç”¨é•¿åº¦ï¼Œä¾‹å¦‚ <code>{{ geese|length }}</code>ï¼Œè¿™ç¨æ˜¾ä¸å¤Ÿçµæ´»ã€‚</p>
<p>æ„Ÿè°¢ Jonathan StrÃ¶bele åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F36186" target="_blank" title="https://code.djangoproject.com/ticket/36186" ref="nofollow noopener noreferrer">Ticket #36186</a> ä¸­è´¡çŒ®äº†è¿™ä¸ªæƒ³æ³•å’Œå®ç°ï¼Œä»¥åŠ David Smithã€Paolo Melchiorre å’Œ Sarah Boyce çš„å®¡æŸ¥ã€‚</p>
<h2 data-id="heading-20"><code>querystring</code> æ¨¡æ¿æ ‡ç­¾å¢å¼º</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.djangoproject.com%2Fen%2Fstable%2Fref%2Ftemplates%2Fbuiltins%2F%23django-template" target="_blank" title="https://docs.djangoproject.com/en/stable/ref/templates/builtins/#django-template" ref="nofollow noopener noreferrer">Django 5.1 ä¸­å¼•å…¥çš„ <code>querystring</code> æ¨¡æ¿æ ‡ç­¾</a> ç”¨äºå¸®åŠ©æ„å»ºä¿®æ”¹å½“å‰è¯·æ±‚æŸ¥è¯¢å‚æ•°çš„é“¾æ¥ï¼Œç°åœ¨æœ‰äº†ä¸¤ä¸ªæ‰©å±•ã€‚</p>
<ol>
<li>å‘è¡Œè¯´æ˜ï¼š</li>
</ol>
<blockquote>
<p><code>querystring</code> æ¨¡æ¿æ ‡ç­¾ç°åœ¨å§‹ç»ˆåœ¨è¿”å›çš„æŸ¥è¯¢å­—ç¬¦ä¸²å‰åŠ ä¸Š <code>?</code>ï¼Œç¡®ä¿é“¾æ¥ç”Ÿæˆè¡Œä¸ºçš„å¯é æ€§ã€‚</p>
</blockquote>
<p>è¿™ä¸€å°å˜åŒ–æ”¹è¿›äº†åœ¨æä¾›ç©ºæŸ¥è¯¢å‚æ•°æ˜ å°„æ—¶æ ‡ç­¾çš„è¡Œä¸ºã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªæ¨¡æ¿å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-django" lang="django">&lt;a href="{% querystring params %}"&gt;Reset search&lt;/a&gt;
</code></pre>
<p>å…¶ä¸­ <code>params</code> æ˜¯ä¸€ä¸ªå¯èƒ½æœ‰æ—¶ä¸ºç©ºçš„å­—å…¸ã€‚ä»¥å‰ï¼Œå¦‚æœ <code>params</code> ä¸ºç©ºï¼Œè¾“å‡ºå°†æ˜¯ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">""</span>&gt;</span>Reset search<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<p>æµè§ˆå™¨ä¼šå°†æ­¤è§†ä¸ºæŒ‡å‘ç›¸åŒ URLï¼ˆåŒ…æ‹¬æŸ¥è¯¢å‚æ•°ï¼‰çš„é“¾æ¥ï¼Œå› æ­¤ä¸ä¼šæ¸…é™¤æŸ¥è¯¢å‚æ•°ï¼Œè¿™ä¸é¢„æœŸä¸ç¬¦ã€‚ç°åœ¨ï¼Œæœ‰äº†è¿™ä¸€å˜åŒ–ï¼Œè¾“å‡ºå°†æ˜¯ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"?"</span>&gt;</span>Reset search<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</code></pre>
<p>æµè§ˆå™¨ä¼šå°† <code>?</code> è§†ä¸ºæŒ‡å‘ç›¸åŒ URLï¼ˆä¸å¸¦ä»»ä½•æŸ¥è¯¢å‚æ•°ï¼‰çš„é“¾æ¥ï¼Œä»è€Œæ¸…é™¤æŸ¥è¯¢å‚æ•°ï¼Œç¬¦åˆç”¨æˆ·çš„æœŸæœ›ã€‚</p>
<p>æ„Ÿè°¢ Django Fellow Sarah Boyce å‘ç°è¿™ä¸€æ”¹è¿›å¹¶å®ç°äº†ä¿®å¤ï¼Œè§ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F36268" target="_blank" title="https://code.djangoproject.com/ticket/36268" ref="nofollow noopener noreferrer">Ticket #36268</a>ï¼Œä»¥åŠ Django Fellow Natalia Bidart çš„å®¡æŸ¥ï¼</p>
<ol start="2">
<li>å‘è¡Œè¯´æ˜ï¼š</li>
</ol>
<blockquote>
<p><code>querystring</code> æ¨¡æ¿æ ‡ç­¾ç°åœ¨å¯ä»¥æ¥å—å¤šä¸ªä½ç½®å‚æ•°ï¼Œè¿™äº›å‚æ•°å¿…é¡»æ˜¯æ˜ å°„ï¼Œä¾‹å¦‚ <code>QueryDict</code> æˆ– <code>dict</code>ã€‚</p>
</blockquote>
<p>è¿™ä¸€å¢å¼ºåŠŸèƒ½å…è®¸æ ‡ç­¾åœ¨æ„å»ºè¾“å‡ºæ—¶åˆå¹¶å¤šä¸ªæŸ¥è¯¢å‚æ•°æ¥æºã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªæ¨¡æ¿å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-django" lang="django">&lt;a href="{% querystring request.GET super_search_params %}"&gt;Super search&lt;/a&gt;
</code></pre>
<p>å…¶ä¸­ <code>super_search_params</code> æ˜¯ä¸€ä¸ªåŒ…å«é¢å¤–å‚æ•°çš„å­—å…¸ï¼Œç”¨äºå°†å½“å‰æœç´¢å‡çº§ä¸ºâ€œè¶…çº§æœç´¢â€ã€‚è¯¥æ ‡ç­¾ä¼šåˆå¹¶è¿™ä¸¤ä¸ªæ˜ å°„ï¼Œå¯¹äºé‡å¤çš„é”®ï¼Œåé¢çš„æ˜ å°„å°†ä¼˜å…ˆã€‚</p>
<p>å†æ¬¡æ„Ÿè°¢ Sarah Boyce åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcode.djangoproject.com%2Fticket%2F35529" target="_blank" title="https://code.djangoproject.com/ticket/35529" ref="nofollow noopener noreferrer">Ticket #35529</a> ä¸­æå‡ºè¿™ä¸€æ”¹è¿›ï¼ŒGiannis Terzopoulos å®ç°äº†å®ƒï¼Œä»¥åŠ Natalia Bidartã€Sarah Boyce å’Œ Tom Carrick çš„å®¡æŸ¥ï¼</p>
<h2 data-id="heading-21">ç»“è¯­</h2>
<p>ä»¥ä¸Šå°±æ˜¯æœ¬æ¬¡ Django 6.0 çš„äº®ç‚¹æ€»ç»“ï¼æ„Ÿè°¢ä½ çš„é˜…è¯»ã€‚æ›´å¤šå˜åŒ–å¯ä»¥åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.djangoproject.com%2Fen%2Fstable%2Freleases%2F6.0%2F" target="_blank" title="https://docs.djangoproject.com/en/stable/releases/6.0/" ref="nofollow noopener noreferrer">å‘è¡Œè¯´æ˜</a> ä¸­æŸ¥çœ‹ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿˜æœ‰è®¸å¤šæœªè¿›å…¥å‘è¡Œè¯´æ˜çš„å¹•åæ”¹è¿›å’Œé”™è¯¯ä¿®å¤ã€‚ä¼˜åŒ–å’Œå¾®å°æ”¹è¿›ä¸€ç›´åœ¨è¢«åˆå¹¶ï¼Œæ‰€ä»¥ä¸è¦å»¶è¿Ÿï¼Œç°åœ¨å°±å‡çº§å§ï¼</p>
<p>æ„Ÿè°¢ä¸º Django 6.0 è´¡çŒ®çš„ <strong>174 äºº</strong>ï¼Œè¿™ä¸€æ•°å­—ç”± Mariusz Felisiak åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgist.github.com%2Ffelixxm%2F99501cdbf6ed5a69295b4cb3f8c21d80" target="_blank" title="https://gist.github.com/felixxm/99501cdbf6ed5a69295b4cb3f8c21d80" ref="nofollow noopener noreferrer">æ­¤åˆ—è¡¨</a> ä¸­ç»Ÿè®¡ã€‚</p>
<p>æ„¿ä½ çš„å‡çº§è¿‡ç¨‹è¿…é€Ÿã€é¡ºåˆ©ã€å®‰å…¨ä¸”å¯é ï¼</p>
<blockquote>
<p>æœ€åæ„Ÿè°¢é˜…è¯»ï¼æ¬¢è¿å…³æ³¨æˆ‘ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼š <strong>å€”å¼ºé’é“œä¸‰</strong>ã€‚<br/>
<strong>ç‚¹èµã€æ”¶è—ã€å…³æ³¨</strong>ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼<br/>
æ¬¢è¿ ç‚¹å‡» <strong>ã€ğŸ‘å–œæ¬¢ä½œè€…ã€‘</strong> æŒ‰é’®è¿›è¡Œ <strong>æ‰“èµğŸ’°ğŸ’°</strong>ï¼Œè¯·æˆ‘å–ä¸€æ¯å’–å•¡â˜•ï¸ï¼</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Perfettoä»å…¥é—¨åˆ°ç²¾é€šã€‘3. Linuxï¼ˆAndroidï¼‰åº•å±‚å†…å­˜ç®¡ç†æœºåˆ¶æ¦‚è¿°]]></title>    <link>https://juejin.cn/post/7582846276505681958</link>    <guid>https://juejin.cn/post/7582846276505681958</guid>    <pubDate>2025-12-12T16:01:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582846276505681958" data-draft-id="7582791876367122470" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Perfettoä»å…¥é—¨åˆ°ç²¾é€šã€‘3. Linuxï¼ˆAndroidï¼‰åº•å±‚å†…å­˜ç®¡ç†æœºåˆ¶æ¦‚è¿°"/> <meta itemprop="keywords" content="æ¶æ„,æ€§èƒ½ä¼˜åŒ–,ç›‘æ§"/> <meta itemprop="datePublished" content="2025-12-12T16:01:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lei_official"/> <meta itemprop="url" content="https://juejin.cn/user/2351234021066314"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Perfettoä»å…¥é—¨åˆ°ç²¾é€šã€‘3. Linuxï¼ˆAndroidï¼‰åº•å±‚å†…å­˜ç®¡ç†æœºåˆ¶æ¦‚è¿°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2351234021066314/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lei_official
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-12T16:01:15.000Z" title="Fri Dec 12 2025 16:01:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-12
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>Android å¸Œæœ›æä¾›ä¸–ç•Œä¸Šç¬¬ä¸€ä¸ªå®Œæ•´çš„å¼€æ”¾æ‰‹æœºå¹³å°è§£å†³æ–¹æ¡ˆã€‚å®ƒå°†ä»¥ Linux ä¸ºåŸºç¡€ï¼Œè¿™ä¸€ç‚¹å’Œå¾·å·ä»ªå™¨ä¸€æ ·ï¼Œä½†å®ƒåŒæ—¶ä¹Ÿå°†æä¾›å…¶ä»–æ‰€æœ‰å¿…è¦çš„ç»„ä»¶ï¼›æ‰‹æœºå‚å•†åªéœ€è¦ç”¨è¿™ä¸€ä¸ªç³»ç»Ÿå°±å¯ä»¥æ¨å‡ºè‡ªå·±çš„è®¾å¤‡ã€‚Android è¿˜å°†ä¸ºåº”ç”¨å¼€å‘è€…æä¾›ç»Ÿä¸€çš„ç¼–ç¨‹æ¨¡å‹ï¼Œè¿™æ ·ä»–ä»¬çš„åº”ç”¨ç¨‹åºå°±å¯ä»¥åœ¨æ‰€æœ‰çš„è®¾å¤‡ä¸Šè¿è¡Œã€‚é€šè¿‡é‡‡ç”¨ç»Ÿä¸€çš„å¹³å°æ¥æ”¯æŒæ‰€æœ‰è®¾å¤‡ï¼ŒAndroid èƒ½ç®€åŒ–æ‰‹æœºå‚å•†å’Œå¼€å‘è€…çš„å·¥ä½œã€‚â€”â€”ã€ŠAndroid ä¼ å¥‡ã€‹</p>
</blockquote>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/54f92a26869f4e63b3b1b2e35ba3dffd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766160113&amp;x-signature=1J62LQ9SRapv1%2FA7dOeToFI%2BUnA%3D" alt="lowhighmem.png" width="80%" loading="lazy"/>
<h2 data-id="heading-0">å‰è¨€ï¼šLinux å†…å­˜ç®¡ç†çš„é‡è¦æ€§</h2>
<p><strong>å†…å­˜</strong> ä½œä¸ºåº”ç”¨æ€§èƒ½æŒ‡æ ‡ä¸­éå¸¸é‡è¦çš„ä¸€é¡¹ï¼Œä¼šå¯¹åº”ç”¨è½¯ä»¶çš„ç¨³å®šæ€§ã€æµç•…æ€§äº§ç”Ÿç›´æ¥å½±å“ã€‚å¦‚æœåº”ç”¨å†…å­˜ä½¿ç”¨ä¸å½“ï¼Œä¼šå¯¼è‡´é¢‘ç¹å‘ç”Ÿ GCï¼Œè€Œ JVM çš„ GC å…·æœ‰ <code>Stop The World</code> çš„ç‰¹æ€§ï¼Œè¿™å°†å¼•èµ·åŒ…æ‹¬ UI åœ¨å†…çš„å…¨éƒ¨çº¿ç¨‹å¡é¡¿ã€‚æ›´æœ‰ç”šè€…ï¼Œæ— æ³•å›æ”¶çš„å†…å­˜ä¼šè€—å°½ç³»ç»Ÿåˆ†é…ç»™åº”ç”¨çš„å¯ç”¨ç©ºé—´ï¼Œæœ€ç»ˆå‘ç”Ÿ OOMã€‚å…¸å‹çš„é—®é¢˜åœºæ™¯æœ‰å†…å­˜æ³„æ¼ã€å†…å­˜æŠ–åŠ¨ç­‰ã€‚</p>
<p>å¯ä»¥è¯´ï¼Œåº”ç”¨çš„å¤§éƒ¨åˆ†æ€§èƒ½é—®é¢˜éƒ½å¯ä»¥å½’ç»“åœ¨ <strong>å†…å­˜</strong> ä¸Šï¼Œè¦æƒ³ä¿è¯åº”ç”¨å…·æœ‰è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œé¦–å½“å…¶å†²è¦è§£å†³çš„å°±æ˜¯å†…å­˜é—®é¢˜ã€‚å³ä½¿åº”ç”¨å½“å‰ä¸å­˜åœ¨è¿™æ–¹é¢çš„é—®é¢˜ï¼Œä½†æ˜¯éšç€åŠŸèƒ½çš„ä¸æ–­è¿­ä»£ï¼Œæ¶æ„ä¹Ÿå¿…ç„¶é€æ¸è…åŒ–ï¼Œå¦‚æœæ²¡æœ‰å…¨é¢å®Œå–„çš„å†…å­˜ç›‘æ§å’Œé¢„è­¦æœºåˆ¶ï¼Œå°±éš¾ä»¥åšåˆ°åœ¨å†…å­˜é—®é¢˜å‘ç”Ÿä¹‹å‰ï¼Œé˜²æ‚£äºæœªç„¶ã€‚</p>
<p>å¯¹äºå†…å­˜é—®é¢˜ï¼Œæˆ‘ä»¬ä¸ä»…è¦çŸ¥å…¶ç„¶ï¼Œè¿˜è¦çŸ¥å…¶æ‰€ä»¥ç„¶ï¼ŒAndroid åº•å±‚æ˜¯åŸºäº Linux å®ç°çš„ï¼Œå…¶å†…å­˜æœºåˆ¶ä¹Ÿæ˜¯è„±èƒäºç»å…¸çš„ Linux å†…å­˜ç®¡ç†ã€‚</p>
<p>æ­¤å¤–ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œè¿˜å°†ä»‹ç»å‡ ä¸ªå¾ˆæœ‰ç”¨çš„ shell å‘½ä»¤ï¼ŒåŒ…å« <code>dumpsys meminfo</code>ã€<code>cat /proc/[pid]/status</code> ç­‰ç­‰ï¼Œç”¨å¥½è¿™äº›å‘½ä»¤ï¼Œä¼šæ˜¯å†…å­˜åˆ†æè¿‡ç¨‹ä¸­çš„ä¸€å¤§åŠ©åŠ›ã€‚</p>
<blockquote>
<p>å¤‡æ³¨ï¼šæœ¬æ–‡æ‰€æœ‰çš„å‘½ä»¤éƒ½çœç•¥äº†å¼€å¤´çš„ <code>adb shell</code>ã€‚</p>
</blockquote>
<h2 data-id="heading-1">dumpsys meminfoï¼šæŸ¥çœ‹è¿›ç¨‹å½“å‰çš„å†…å­˜ä½¿ç”¨æƒ…å†µ</h2>
<p>åœ¨ç”µè„‘æ§åˆ¶å°æ‰§è¡Œ <code>adb shell dumpsys meminfo [packageName]</code>ï¼Œå¯ä»¥æŸ¥çœ‹è¯¥è¿›ç¨‹å½“å‰å†…å­˜ä½¿ç”¨æƒ…å†µã€‚</p>
<pre><code class="hljs language-bash" lang="bash">Î» adb shell dumpsys meminfo com.google.samples.apps.nowinandroid.demo.debug
Applications Memory Usage (<span class="hljs-keyword">in</span> Kilobytes):
Uptime: 655869283 Realtime: 912305084

** MEMINFO <span class="hljs-keyword">in</span> pid 22144 [com.google.samples.apps.nowinandroid.demo.debug] **
                   Pss  Private  Private  SwapPss      Rss     Heap     Heap     Heap
                 Total    Dirty    Clean    Dirty    Total     Size    Alloc     Free
                ------   ------   ------   ------   ------   ------   ------   ------
  Native Heap    11347    11336        0     9038    12196    31844    20762     7264
  Dalvik Heap     9079     9060        0     1768     9740   108170     9866    98304
[ä¸‹ç•¥]
</code></pre>
<p>åœ¨ <code>Private Dirty</code> åˆ—ä¸­ï¼Œè®°å½•äº† Native å’Œ Dalvikï¼ˆJavaï¼‰å†…å­˜ä½¿ç”¨é‡ï¼Œè€Œ <code>dirty</code> çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä»¥åŠ <code>clean</code>, <code>Rss</code>, <code>Pss</code>, <code>Swat</code> åˆ†åˆ«åˆä»£è¡¨äº†ä»€ä¹ˆï¼Ÿ</p>
<h3 data-id="heading-2">è™šæ‹Ÿå†…å­˜ï¼ˆVMAï¼‰ä¸ç‰©ç†å†…å­˜ï¼ˆPhysical Memoryï¼‰</h3>
<p>è¿™äº›éƒ½æ˜¯ Linux ç¯å¢ƒä¸‹å†…å­˜ç®¡ç†çš„æ¦‚å¿µï¼Œç«™åœ¨å†…æ ¸çš„è§†è§’ä¸‹ï¼Œå†…å­˜åˆ†é…çš„æœ€å°ç²’åº¦æ˜¯ <code>pages</code>ï¼ˆåˆ†é¡µï¼‰ï¼Œä¸€ä¸ª page å¤§å°æ˜¯ 4KBï¼Œè¿™æ˜¯ Linux å†…æ ¸çš„åŸºç¡€é¡µå¤§å°ï¼Œæ˜¯å†…å­˜ç®¡ç†çš„æœ€å°å•ä½ï¼Œ<code>mmap()</code>/<code>malloc()</code>/<code>åŒ¿åé¡µ</code> æœ€ç»ˆéƒ½æ˜¯æŒ‰ç…§ 4KB è¿›è¡Œå¯¹é½ã€‚pages åœ¨ <strong>â€œè™šæ‹Ÿå†…å­˜åŒºï¼ˆVirtual Memory Areaï¼ŒVMAï¼‰â€</strong> ä¸­è¿›è¡Œç®¡ç†å’Œç»„ç»‡ï¼Œå®ƒè·ŸçœŸå®å†…å­˜åŒºæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œé€šè¿‡ VMAï¼Œå¯ä»¥å°†ç¢ç‰‡åŒ–çš„çœŸå®å†…å­˜æ˜ å°„ä¸ºè¿ç»­çš„è™šæ‹Ÿå†…å­˜ã€‚</p>
<p>åº”ç”¨è¿›ç¨‹å¹¶ä¸é€šè¿‡ <a href="https://link.juejin.cn?target=https%3A%2F%2Fman7.org%2Flinux%2Fman-pages%2Fman2%2Fmmap.2.html" target="_blank" title="https://man7.org/linux/man-pages/man2/mmap.2.html" ref="nofollow noopener noreferrer">mmap()</a> å‡½æ•°ç›´æ¥å£°æ˜å†…å­˜å ç”¨ï¼Œè€Œæ˜¯è°ƒç”¨ <code>malloc()</code> â€”â€”native ä»£ç ï¼Œå’Œ <code>new()</code> â€”â€”Java ä»£ç æ¥è¿›è¡Œç”³è¯·ã€‚</p>
<p>æœ‰ä¸¤ç§ç±»å‹çš„â€œè™šæ‹Ÿå†…å­˜åŒºâ€ï¼š</p>
<ul>
<li><strong>åŸºäºæ–‡ä»¶çš„ VMA</strong> ï¼šåº•å±‚ä½¿ç”¨æ–‡ä»¶å®ç°ï¼Œé€šè¿‡å°†æ–‡ä»¶æè¿°ç¬¦ï¼ˆfdï¼‰æä¾›ç»™ <code>mmap()</code> å‡½æ•°ï¼Œå°†åœ¨ VMA ä¸Šçš„è¯»å†™æ“ä½œæ˜ å°„ä¸ºæ–‡ä»¶è¯»å†™ã€‚åœ¨ Linux ç³»ç»Ÿä¸­ï¼ŒåŠ¨æ€é“¾æ¥å™¨ï¼ˆldï¼‰åœ¨è¿è¡Œæ–°è¿›ç¨‹ã€åŠ¨æ€åŠ è½½åº“æ—¶ï¼Œä¼šä½¿ç”¨åŸºäºæ–‡ä»¶çš„ VMAã€‚Android ç³»ç»Ÿåˆ™åœ¨åŠ è½½ dex æ–‡ä»¶å’Œèµ„æºæ—¶ä½¿ç”¨è¿™ä¸€æ–¹å¼ã€‚</li>
<li><strong>åŒ¿å VMA</strong> ï¼šéæ–‡ä»¶ç³»ç»Ÿï¼Œåªé€šè¿‡å†…å­˜å®ç°ã€‚è°ƒç”¨ <code>mmap(... MAP_ANONYMOUS ...)</code> ä¼šä½¿ç”¨è¿™ç§æ–¹å¼ã€‚åŠ¨æ€ç”³è¯·çš„å†…å­˜ç»Ÿç»Ÿå½’äºæ­¤ç±»ï¼Œä¾‹å¦‚ C çš„ <code>malloc()</code>ã€C++ çš„ <code>new()</code> å’Œ Java çš„ <code>new X()</code> â€”â€” è¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¦å…³æ³¨çš„é‡ç‚¹ã€‚</li>
</ul>
<p>åº”ç”¨ä»è™šæ‹Ÿå†…å­˜ä¸­ç”³è¯·å†…å­˜ï¼Œæœ€ç»ˆä¼šæ˜ å°„åˆ°ç‰©ç†å†…å­˜ä¸Šï¼Œå‰è€…å¾€å¾€å¤§äºåè€…ã€‚æˆ‘ä»¬ç»Ÿè®¡å†…å­˜å ç”¨æ—¶ï¼Œé€šå¸¸åªå…³æ³¨ç‰©ç†å†…å­˜çš„å¤§å°ï¼Œå¿½ç•¥è™šæ‹Ÿå†…å­˜ã€‚ä¾‹å¦‚ï¼Œç³»ç»Ÿåˆ†é…ç»™åº”ç”¨<code>32MB</code> çš„è™šæ‹Ÿå†…å­˜ï¼Œåº”ç”¨éšåå‘å…¶ä¸­å†™å…¥ <code>4KB</code> æ•°æ®ï¼Œå®é™…ä¸Šåªå ç”¨äº† <code>4KB</code> çš„ç‰©ç†å†…å­˜ã€‚åœ¨64ä½çš„ç³»ç»Ÿä¸Šï¼Œè™šæ‹Ÿå†…å­˜åœ°å€å¾ˆéš¾è€—å°½ï¼Œç»å¤§å¤šæ•°åœºæ™¯ä¸‹æ— éœ€å…³æ³¨ã€‚</p>
<h3 data-id="heading-3">RSS ä¸ PSS</h3>
<p>åº”ç”¨å ç”¨çš„ç‰©ç†å†…å­˜å¤§å°ï¼Œç§°ä¸º <strong>â€œé©»ç•™å†…å­˜å¤§å°ï¼ˆResident Set Sizeï¼ŒRSSï¼‰â€</strong>ã€‚</p>
<p>æœ‰äº†ä»¥ä¸ŠåŸºç¡€çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å¯¹è™šæ‹Ÿå†…å­˜ VMA ä¸­çš„åˆ†é¡µè¿›è¡Œå½’ç±»äº†ï¼Œè¿™ä¹Ÿå°±å¯¹åº”ç€å‰é¢ <code>dumpsys meminfo</code> æŒ‡ä»¤çš„è¾“å‡ºç»“æœã€‚</p>
<ul>
<li><strong>é©»ç•™çŠ¶æ€ï¼ˆResidentï¼‰</strong>ï¼šè¯¥åˆ†é¡µå·²ç»è¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œå¯ç»†åˆ†ä¸ºä¸¤ç±»ã€‚
<ul>
<li><strong>å¹²å‡€ï¼ˆCleanï¼‰</strong>ï¼šåˆ†é¡µå†…å®¹ä¸åº•å±‚æ–‡ä»¶ä¸­çš„å†…å®¹ç›¸åŒï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†…æ ¸å¯ä»¥è‡ªç”±æ¸…é™¤åˆ†é¡µå†…å®¹ï¼Œè€Œä¸å¿…æ‹…å¿ƒæ•°æ®ä¸¢å¤±ã€‚</li>
<li><strong>è„ï¼ˆDirtyï¼‰</strong>ï¼šåˆ†é¡µå†…å®¹ä¸åº•å±‚æ–‡ä»¶å†…å®¹ä¸ç›¸åŒï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ç”šè‡³ä¸å­˜åœ¨åº•å±‚æ˜ å°„æ–‡ä»¶ã€‚æ­¤æ—¶ï¼Œä¸å…è®¸å†…æ ¸æ¸…é™¤åˆ†é¡µå†…å®¹ã€‚</li>
</ul>
</li>
<li><strong>äº¤æ¢çŠ¶æ€ï¼ˆSwappedï¼‰</strong>ï¼šè„åˆ†é¡µè¢«å†™å…¥åˆ°äº¤æ¢æ–‡ä»¶ï¼ˆåœ¨ Android ä¸­æ˜¯ ZRAMï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸´æ—¶çŠ¶æ€ï¼Œå½“ä¸‹æ¬¡ç¼ºé¡µå¼‚å¸¸ï¼ˆpage faultï¼‰å‘ç”Ÿæ—¶ï¼Œä¼šå°†è¿™éƒ¨åˆ†å†…å®¹é‡æ–°è½¬ç§»åˆ°å†…å­˜ã€‚</li>
<li><strong>æœªå ç”¨çŠ¶æ€ï¼ˆNot presentï¼‰</strong>ï¼šè¯¥åˆ†é¡µä»æœªä½¿ç”¨è¿‡ã€‚</li>
</ul>
<p>åœ¨ Android ç³»ç»Ÿä¸­ï¼Œåº”å½“é‡ç‚¹å…³æ³¨è„åˆ†é¡µ <code>Private Dirty</code>ï¼Œå› ä¸ºè„åˆ†é¡µæ— æ³•è¢«è½¬ç§»åˆ°æ–‡ä»¶ç³»ç»Ÿï¼Œå› æ­¤ä¸èƒ½è¢«å†…æ ¸å›æ”¶å†åˆ©ç”¨ã€‚</p>
<p>ä½œä¸ºæ“ä½œç³»ç»Ÿï¼ŒAndroid å¯¹äºå¤šä¸ªåº”ç”¨éƒ½è¦ä½¿ç”¨åˆ°çš„åº“ï¼ˆä¾‹å¦‚ <code>libc.so</code>ã€<code>framework.dex</code>ï¼‰è¿›è¡Œäº†ä¼˜åŒ–ï¼Œç³»ç»Ÿå°†å®ƒä»¬ä½œä¸ºå…±äº«èµ„æºè¿›è¡ŒåŠ è½½ã€‚è¿™äº›æ•°æ®æœ€åˆå±äº <code>zygote</code> è¿›ç¨‹ï¼Œå½“ç³»ç»Ÿ <code>fork()</code> æ–°çš„åº”ç”¨è¿›ç¨‹æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ç›¸åŒçš„é¡µé¢åœ°å€ã€‚åŒä¸€æ—¶åˆ»å³ä½¿ç³»ç»Ÿé‡Œè¿è¡Œäº† 100 ä¸ªåº”ç”¨ï¼Œåœ¨è¿™éƒ¨åˆ†ä¸Šå…¬æœ‰åº“å ç”¨çš„å†…å­˜ä»ç„¶åªæœ‰ä¸€ä»½ã€‚</p>
<p>å› æ­¤å¼•å…¥äº† <strong>â€œæŒ‰æ¯”ä¾‹å†…å­˜å ç”¨ï¼ˆProportional Set Sizeï¼ŒPSSï¼‰â€</strong> çš„æ¦‚å¿µï¼Œå¯¹äºå…±äº«å†…å­˜æŒ‰æ¯”ä¾‹åˆ’åˆ†ã€‚ä¾‹å¦‚æˆ‘ä»¬å°† <code>4KB</code> çš„åˆ†é¡µå…±äº«ç»™4æ¡è¿›ç¨‹ï¼Œæ¯ä¸€æ¡è¿›ç¨‹å ç”¨çš„å†…å­˜åˆ™æ˜¯ <code>1KB</code>ã€‚</p>
<h2 data-id="heading-4">cat /proc/[pid]/statusï¼šæŸ¥çœ‹åº”ç”¨å¯åŠ¨ä»¥æ¥ RSS çš„æœ€å¤§å€¼</h2>
<p>å‰æ–‡ä»‹ç»è¿‡ï¼Œ<code>dumpsys meminfo</code> å¯ä»¥è¿”å›åº”ç”¨å½“å‰çš„è¯¦ç»†å†…å­˜ä½¿ç”¨çŠ¶æ€ï¼Œå¦‚æœè¯´æˆ‘ä»¬æƒ³è¦è·Ÿè¸ªè‡ªåº”ç”¨è¿›ç¨‹å¯åŠ¨ä»¥æ¥ï¼Œæ‰€ç”³è¯·è¿‡çš„æœ€å¤§ RSSï¼Œåˆ™å¯ä»¥é€šè¿‡ <code>cat /proc/[pid]/status</code> æ¥æŸ¥çœ‹ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">Î» adb shell <span class="hljs-built_in">cat</span> /proc/19947/status
[ç•¥]
VmPeak: 37292428 kB
VmSize: 32416288 kB
VmLck:       192 kB
VmPin:         0 kB
VmHWM:   1187096 kB &lt;=== RSS High Watermark
VmRSS:    521832 kB
RssAnon:          122076 kB
RssFile:          362528 kB
RssShmem:          37228 kB
VmData:  1669512 kB
VmStk:      8192 kB
VmExe:         8 kB
VmLib:    224720 kB
VmPTE:      5572 kB
VmSwap:   258472 kB
[ç•¥]
</code></pre>
<p><code>VmHWM</code> è®°å½•äº†è¿›ç¨‹è‡ªå¯åŠ¨ä»¥æ¥ï¼Œæœ€å¤§çš„ç¬æ—¶ RSS å€¼ï¼Œå¯ä»¥çœ‹åˆ°é«˜è¾¾ <code>1187M</code>ã€‚</p>
<h3 data-id="heading-5">ä½¿ç”¨ Perfetto è®°å½•å†…å­˜ï¼ˆRSSï¼‰å¢é•¿æ›²çº¿</h3>
<p><strong>é…ç½®æ–‡ä»¶ config.pbtx</strong></p>
<pre><code class="hljs language-plaintext" lang="plaintext">buffers: {
    size_kb: 8960
    fill_policy: DISCARD
}
buffers: {
    size_kb: 1280
    fill_policy: DISCARD
}
data_sources: {
    config {
        name: "linux.process_stats"
        target_buffer: 1
        process_stats_config {
            scan_all_processes_on_start: true
        }
    }
}
data_sources: {
    config {
        name: "linux.ftrace"
        ftrace_config {
            ftrace_events: "mm_event/mm_event_record"
            ftrace_events: "kmem/rss_stat"
            ftrace_events: "kmem/ion_heap_grow"
            ftrace_events: "kmem/ion_heap_shrink"
        }
    }
}
duration_ms: 30000
</code></pre>
<p>ä½¿ç”¨å‘½ä»¤ <code>cat config.pbtx | adb shell perfetto -c - --txt -o /data/misc/perfetto-traces/trace.pftrace</code> å¼€å¯æŠ“å–ï¼Œæ“ä½œç•Œé¢ï¼Œ30s åç»“æŸæŠ“å–ã€‚</p>
<blockquote>
<p>è¿™é‡Œæˆ‘é‡‡ç”¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2Fdocs%2Fcase-studies%2Fmemory%23memory-tracepoints" target="_blank" title="https://perfetto.dev/docs/case-studies/memory#memory-tracepoints" ref="nofollow noopener noreferrer">å®˜æ–¹ç»™å‡ºçš„é…ç½®</a>å¹¶æœªèƒ½æ­£å¸¸æŠ“å– trace æ–‡ä»¶ï¼Œåªèƒ½è·å–åˆ°ä¸€ä¸ªå¤§çº¦ 830KB çš„ç©ºæ–‡ä»¶ã€‚å…ˆé‡‡ç”¨å®˜æ–¹çš„å›¾ç‰‡ä½œä¸ºè®²è§£ï¼Œå¦‚æœæœ‰è¯»è€…æ‰¾åˆ°é—®é¢˜åŸå› ï¼Œæ¬¢è¿ä¸åèµæ•™ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/777b90675ac84881a1c559016bbb28af~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766160113&amp;x-signature=0DFcm7jVvMnkEFXax5mATVfra0E%3D" alt="rss_camera.png" loading="lazy"/></p>
<p>ä»è¿™ä¸ªå›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨å¤§çº¦æ—¶é—´è¿›è¡Œåˆ°2/3æ—¶ï¼Œ<code>mem.rss.ion</code> å‘ç”Ÿå¢é•¿ï¼Œè¯´æ˜æ­¤æ—¶ç”¨æˆ·æ“ä½œå¼•èµ·äº†å†…å­˜åˆ†é…ã€‚</p>
<h2 data-id="heading-6">am dumpheap [packageName]ï¼šæŠ“å– JVM å†…å­˜å¿«ç…§</h2>
<pre><code class="hljs language-bash" lang="bash">Î» adb shell am dumpheap com.google.samples.apps.nowinandroid.demo.debug
File: /data/local/tmp/heapdump-20251212-093630.prof
Waiting <span class="hljs-keyword">for</span> dump to finish...
</code></pre>
<p>æŠ“å–å¯¹åº”åŒ…åçš„ prof æ–‡ä»¶åï¼Œå°†å…¶ pull åˆ°ç”µè„‘ä¸Šï¼Œæ”¹åä¸º <code>*.hprof</code>åï¼Œå°±å¯ä»¥åœ¨ AndroidStudio ä¸­æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„ JVM å†…å­˜å¿«ç…§ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/848aa106363a4809ab0fed142345c7ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766160113&amp;x-signature=8UErgVgT7wlTB1BRdYCKJjCyaKU%3D" alt="memory_hprof.png" loading="lazy"/></p>
<p>ä¹Ÿå¯ä»¥ç”¨ Perfetto åœ¨çº¿æ‰“å¼€è¯¥å¿«ç…§ï¼Œä¼šä»¥ç«ç„°å›¾çš„æ–¹å¼å±•ç¤ºå¯¹è±¡å ç”¨å †å¤§å°ï¼Œå¯¹äºç±»å‹ç›¸åŒçš„å¯¹è±¡èšåˆåå±•ç¤ºï¼Œä¼˜ç‚¹æ˜¯æ›´åŠ ç›´è§‚ï¼Œç¼ºç‚¹æ˜¯æ— æ³•æŸ¥çœ‹å¯¹è±¡å†…éƒ¨æ•°æ®ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ccc44ace74549f49cec04e9814267b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgTGVpX29mZmljaWFs:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766160113&amp;x-signature=P1adtgpXnpA0KkuhXoIkwAZ4V3A%3D" alt="hprof_flame.png" loading="lazy"/></p>
<h2 data-id="heading-7">showmap [pid]ï¼šå±•ç¤ºå†…å­˜-æ–‡ä»¶æ˜ å°„</h2>
<p>åº•å±‚é€šè¿‡è¯»å– <code>/proc/PID/smaps</code> æ–‡ä»¶æ¥å®ç°ã€‚</p>
<p>é¦–å…ˆè·å– NowInAndroid çš„ PID=19147ã€‚</p>
<pre><code class="hljs language-bash" lang="bash">Î» adb shell ps -A | grep nowinandroid
u0_a225   19147   996   28342616 303680 do_epoll_wait       0 S com.google.samples.apps.nowinandroid.demo.debug
</code></pre>
<p>éšåæŸ¥çœ‹å…¶å†…å­˜ä¸­çš„åŸºäºæ–‡ä»¶çš„ VMA æ˜ å°„ã€‚</p>
<p>è¾“å…¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Î» adb shell showmap 19147
</code></pre>
<p>è¾“å‡ºï¼š</p>
<p>åœ¨ä¸‹æ–‡ä¸­ï¼Œè¾“å‡ºå†…å®¹ä¸­å·²ç»çœç•¥å»äº†å¤§éƒ¨åˆ†ï¼ŒåŸæœ¬çš„æ˜ å°„æ–‡ä»¶æ•°é‡æœ‰869ä¸ªã€‚è¿™é‡Œé¢æœ‰ jar åŒ…ã€so åº“ã€ttf å­—ä½“æ–‡ä»¶ã€dex æ–‡ä»¶ç­‰ã€‚å¯ä»¥è¯´ï¼Œå æ®å¤§å¤šæ•°çš„æ˜¯åº”ç”¨ä½¿ç”¨åˆ°çš„èµ„æºæ–‡ä»¶ã€‚</p>
<p>è™½ç„¶æ•°é‡å¤šï¼Œä½†ç”±äºæ˜¯â€œå…±äº«â€çš„åŸå› ï¼ŒçœŸæ­£çš„ PSS å’Œ private dirty å¹¶ä¸å¤šã€‚</p>






























<table><thead><tr><th>åŒºåŸŸ</th><th>å¤§å°ï¼ˆbï¼‰</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>RSS</td><td>296680</td><td>RSS = shared clean + shared dirty + private clean + private dirty</td></tr><tr><td>PSS</td><td>131754</td><td/></tr><tr><td>shared dirty</td><td>34224</td><td/></tr><tr><td>private dirty</td><td>55536</td><td/></tr></tbody></table>
<pre><code class="hljs language-plaintext" lang="plaintext"> virtual                     shared   shared  private  private                   Anon      Shmem     File      Shared   Private
    size      RSS      PSS    clean    dirty    clean    dirty     swap  swapPSS HugePages PmdMapped PmdMapped Hugetlb  Hugetlb    Locked    # object
-------- -------- -------- -------- -------- -------- -------- -------- -------- --------- --------- --------- -------- -------- -------- ---- ------------------------------
     292       96       19       88        0        8        0        8        0         0         0         0        0        0        0    1 /apex/com.android.adbd/lib64/libadbconnection_client.so
     492      184        8      184        0        0        0        0        0         0         0         0        0        0        0    1 /apex/com.android.adservices/javalib/framework-adservices.jar
    1172      208       97      144        0       64        0        0        0         0         0         0        0        0        0    1 /apex/com.android.art/javalib/apache-xml.jar
      72       60       32        0       56        0        4       12        0         0         0         0        0        0        0    1 /memfd:gralloc_shared_memory (deleted)
   65536        0        0        0        0        0        0       12        0         0         0         0        0        0        0    1 /memfd:jit-zygote-cache (deleted)
       8        0        0        0        0        0        0        0        0         0         0         0        0        0        0    1 /product/overlay/GmsConfigOverlayCommon.apk
      24       20        0       20        0        0        0        4        0         0         0         0        0        0        0    1 /system/bin/app_process64
    2716      988      777      384        0      604        0        0        0         0         0         0        0        0        0    1 /system/fonts/NotoColorEmoji.ttf
    
[ä¸­é—´ç•¥å»å¤§éƒ¨åˆ†]

      36       36       36        0        0       36        0        0        0         0         0         0        0        0        0    1 /system/fonts/NotoSansSymbols-Regular-Subsetted2.ttf
      48       32        2       32        0        0        0        4        0         0         0         0        0        0        0    1 /system/framework/arm64/boot-mediatek-ims-base.oat
       4        4        0        4        0        0        0        0        0         0         0         0        0        0        0    1 /system/framework/boot-vivo-vgcclient.vdex
     700      264       19      260        0        4        0        4        0         0         0         0        0        0        0    1 /vendor/lib64/egl/libMEOW_gift.so

-------- -------- -------- -------- -------- -------- -------- -------- -------- --------- --------- --------- -------- -------- -------- ---- ------------------------------
 virtual                     shared   shared  private  private                   Anon      Shmem     File      Shared   Private
    size      RSS      PSS    clean    dirty    clean    dirty     swap  swapPSS HugePages PmdMapped PmdMapped Hugetlb  Hugetlb    Locked    # object
-------- -------- -------- -------- -------- -------- -------- -------- -------- --------- --------- --------- -------- -------- -------- ---- ------------------------------
28342616   296680   131754   143316    34224    63604    55536    30336    14411         0         0         0        0        0        0  869 TOTAL
</code></pre>
<h2 data-id="heading-8">getprop dalvik.vm.heapgrowthlimit å’Œ dalvik.vm.heapsizeï¼šè®¾å¤‡åˆ†é…ç»™åº”ç”¨çš„å†…å­˜ä¸Šé™</h2>
<p>åœ¨ä¸åŒç¡¬ä»¶çš„è®¾å¤‡ä¸Šï¼Œåº”ç”¨èƒ½å¤Ÿä½¿ç”¨çš„æœ€å¤§å†…å­˜å€¼ä¸ä¸€æ ·ï¼Œè¿™ä¸€èˆ¬æ˜¯ç”± ROM å‚å•†å†³å®šã€‚é€šå¸¸æ¥è¯´ï¼Œç¡¬ä»¶è¶Šå¥½ï¼Œåº”ç”¨å†…å­˜ä¸Šé™ä¹Ÿè¶Šé«˜ã€‚å¯ä»¥é€šè¿‡ adb å‘½ä»¤æŸ¥çœ‹è®¾å¤‡çš„åˆ†é…ç»™åº”ç”¨çš„å†…å­˜ä¸Šé™ã€‚è¿™ä¸¤ä¸ªå€¼æ˜¯å†™æ­»åœ¨ <code>/system/build.prop</code> æ–‡ä»¶å½“ä¸­çš„ã€‚</p>
<p>åœ¨æ§åˆ¶å°è·å–è¿™ä¸¤ä¸ªå€¼ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">Î» adb  shell getprop dalvik.vm.heapgrowthlimit
256m
Î» adb  shell getprop dalvik.vm.heapsize
512m
</code></pre>
<p>åœ¨åº”ç”¨ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨ <code>ActivityManager</code> æä¾›çš„é™æ€å‡½æ•°è·å–è¿™ä¸¤ä¸ªå€¼ï¼Œå…¶å®ç°æœ¬è´¨ä¸Šä¹Ÿæ˜¯è®¿é—®ä¸Šè¿°ç³»ç»Ÿå‚æ•°ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ActivityManager.java</span>
<span class="hljs-comment">// è·å– heapgrowthlimit</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">staticGetMemoryClass</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Really brain dead right now -- just take this from the configured</span>
        <span class="hljs-comment">// vm heap size, and assume it is in megabytes and thus ends with "m".</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">vmHeapSize</span> <span class="hljs-operator">=</span> SystemProperties.get(<span class="hljs-string">"dalvik.vm.heapgrowthlimit"</span>, <span class="hljs-string">""</span>);
        <span class="hljs-keyword">if</span> (vmHeapSize != <span class="hljs-literal">null</span> &amp;&amp; !<span class="hljs-string">""</span>.equals(vmHeapSize)) {
            <span class="hljs-keyword">return</span> Integer.parseInt(vmHeapSize.substring(<span class="hljs-number">0</span>, vmHeapSize.length()-<span class="hljs-number">1</span>));
        }
        <span class="hljs-keyword">return</span> staticGetLargeMemoryClass();
}

<span class="hljs-comment">// è·å– heapsize</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">staticGetLargeMemoryClass</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// Really brain dead right now -- just take this from the configured</span>
        <span class="hljs-comment">// vm heap size, and assume it is in megabytes and thus ends with "m".</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">vmHeapSize</span> <span class="hljs-operator">=</span> SystemProperties.get(<span class="hljs-string">"dalvik.vm.heapsize"</span>, <span class="hljs-string">"16m"</span>);
        <span class="hljs-keyword">return</span> Integer.parseInt(vmHeapSize.substring(<span class="hljs-number">0</span>, vmHeapSize.length() - <span class="hljs-number">1</span>));
}
</code></pre>
<p>å¦‚ä½•ç†è§£è¿™ä¸¤ä¸ªå€¼çš„å«ä¹‰ï¼Ÿ</p>
<ul>
<li><code>heapgrowthlimit</code>ï¼šåº”ç”¨é»˜è®¤å…è®¸ä½¿ç”¨çš„ dalvik/arm è™šæ‹Ÿæœºå†…å­˜ä¸Šé™ã€‚</li>
<li><code>heapsize</code>ï¼šåœ¨å£°æ˜ <code>largeHeap="true"</code> åï¼Œåº”ç”¨å¯ä»¥æ‰©å±•åˆ°çš„å†…å­˜ä¸Šé™ã€‚</li>
</ul>
<p>å·²å‰æ–‡æˆ‘ä½¿ç”¨çš„æ‰‹æœºä¸ºä¾‹ï¼Œå…¶ <code>heapgrowthlimit</code>/<code>heapsize</code> æ˜¯ <code>256m</code>/<code>512m</code>ï¼Œè¿™æ„å‘³ç€ï¼Œåº”ç”¨åœ¨è¿è¡Œæ—¶ï¼Œæœ€å¤šå¯ä»¥ç”³è¯· 256m çš„å†…å­˜ï¼Œå½“å®æ—¶å†…å­˜æ¥è¿‘ï¼ˆæœªè¶…è¿‡ï¼‰è¿™ä¸ªå€¼ï¼ŒJVM ä¼šé¢‘ç¹è§¦å‘ GC ä»¥å›æ”¶å†…å­˜ï¼Œä¼´éšç€å¤§é‡çš„ STWã€‚è€Œä¸€æ—¦å†…å­˜ä½¿ç”¨è¶…è¿‡è¿™ä¸ªå€¼ï¼Œåˆ™ä¼šå‘ç”Ÿ OOM å´©æºƒã€‚</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">application</span>
    <span class="hljs-attr">android:largeHeap</span>=<span class="hljs-string">"false"</span>/&gt;</span>
</code></pre>
<p>é‚£å¯èƒ½å°±ä¼šæœ‰èªæ˜çš„åŒå­¦æé—®ï¼Œæ˜¯å¦å¯ä»¥åœ¨ <code>AndroidManifext.xml</code> é‡Œå¼€å¯ <code>largeHeap</code> ç»­ä¸€æ³¢å‘½ï¼Ÿé€šå¸¸æ¥è¯´è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ï¼Œç«™åœ¨ç³»ç»Ÿçš„è§’åº¦ï¼Œ<code>largeHeap</code> æ˜¯ç”¨æ¥æä¾›ç»™æŸäº›éœ€è¦å¤§å†…å­˜çš„åº”ç”¨æ˜¾å¼å£°æ˜ï¼Œä¾‹å¦‚ç›¸å†Œã€ç›¸æœºã€ç¼–è¾‘å™¨ã€çŸ­è§†é¢‘ç­‰ã€‚å¦‚æœä½ çš„åº”ç”¨ä¸å±äºæ­¤ç±»ï¼Œè¿˜æ˜¯å»ºè®®ä»ä»£ç ä¸Šå¯»æ‰¾åŸå› ï¼Œåšå¥½å†…å­˜çš„ç®¡æ§ã€‚</p>
<h2 data-id="heading-9">å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2Fdocs%2Fgetting-started%2Fmemory-profiling" target="_blank" title="https://perfetto.dev/docs/getting-started/memory-profiling" ref="nofollow noopener noreferrer">perfetto.dev/docs/gettinâ€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2Fdocs%2Fcase-studies%2Fmemory" target="_blank" title="https://perfetto.dev/docs/case-studies/memory" ref="nofollow noopener noreferrer">perfetto.dev/docs/case-sâ€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2Fdocs%2Fdata-sources%2Fnative-heap-profiler" target="_blank" title="https://perfetto.dev/docs/data-sources/native-heap-profiler" ref="nofollow noopener noreferrer">perfetto.dev/docs/data-sâ€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fperfetto.dev%2Fdocs%2Fdata-sources%2Fjava-heap-profiler" target="_blank" title="https://perfetto.dev/docs/data-sources/java-heap-profiler" ref="nofollow noopener noreferrer">perfetto.dev/docs/data-sâ€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fhexingen%2Farticle%2Fdetails%2F131934734" target="_blank" title="https://blog.csdn.net/hexingen/article/details/131934734" ref="nofollow noopener noreferrer">blog.csdn.net/hexingen/arâ€¦</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fcs4118.github.io%2Fwww%2F2023-1%2Flect%2F21-linux-mm.html" target="_blank" title="https://cs4118.github.io/www/2023-1/lect/21-linux-mm.html" ref="nofollow noopener noreferrer">cs4118.github.io/www/2023-1/â€¦</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jacksonåºåˆ—åŒ–è®©éªŒç­¾å¤±è´¥ï¼Ÿç ´è§£JSONè½¬ä¹‰é™·é˜±]]></title>    <link>https://juejin.cn/post/7582815307439882291</link>    <guid>https://juejin.cn/post/7582815307439882291</guid>    <pubDate>2025-12-13T04:26:32.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582815307439882291" data-draft-id="7582809606067781658" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jacksonåºåˆ—åŒ–è®©éªŒç­¾å¤±è´¥ï¼Ÿç ´è§£JSONè½¬ä¹‰é™·é˜±"/> <meta itemprop="keywords" content="åç«¯,Java,é¢è¯•"/> <meta itemprop="datePublished" content="2025-12-13T04:26:32.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="9å·è¾¾äºº"/> <meta itemprop="url" content="https://juejin.cn/user/2450136052270077"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jacksonåºåˆ—åŒ–è®©éªŒç­¾å¤±è´¥ï¼Ÿç ´è§£JSONè½¬ä¹‰é™·é˜±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2450136052270077/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    9å·è¾¾äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T04:26:32.000Z" title="Sat Dec 13 2025 04:26:32 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘åœ¨å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸€ä¸ªçš„æŒºæœ‰æ„æ€çš„éªŒç­¾é—®é¢˜ã€‚æˆ‘ä»¬çš„é¡¹ç›®é‡‡ç”¨äº†å‰åç«¯ç­¾åéªŒè¯æœºåˆ¶æ¥ä¿è¯æ•°æ®å®‰å…¨ï¼š</p>
<ul>
<li><strong>å‰ç«¯</strong>ï¼šè¯·æ±‚æ—¶å¯¹ body è¿›è¡Œç­¾å</li>
<li><strong>åç«¯</strong>ï¼šæ¥æ”¶åå¯¹ body è¿›è¡ŒéªŒç­¾</li>
</ul>
<p>æ­£å¸¸æƒ…å†µä¸‹éƒ½æ²¡å•¥é—®é¢˜ï¼Œä½†è¿™æ¬¡æ¯”è¾ƒå¥‡æ€ªï¼š</p>
<ol>
<li>åç«¯æ¥å£ A è¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­æŸä¸ªå­—æ®µæ˜¯ <strong>JSON å­—ç¬¦ä¸²</strong>ï¼ˆString ç±»å‹ï¼‰</li>
<li>å‰ç«¯æ‹¿åˆ°è¿™ä¸ªå¯¹è±¡åï¼Œä¼šæŠŠè¿™ä¸ªjsonå­—ç¬¦ä¸²åŸæ¨¡åŸæ ·çš„ä½œä¸ºå‚æ•°ä¼ ç»™åç«¯æ¥å£ B</li>
<li>ç„¶åå°±ã€‚ã€‚ã€‚éªŒç­¾å¤±è´¥äº†</li>
</ol>
<p>æˆ‘ä»¬å°±é™·å…¥äº†äº’ç›¸ç”©é”…çš„å±€é¢ï¼š</p>
<ul>
<li><strong>åç«¯</strong>è®¤ä¸ºï¼šå‰ç«¯éªŒç­¾æ—¶åšäº†ç‰¹æ®Šå¤„ç†</li>
<li><strong>å‰ç«¯</strong>å¾ˆæ— è¾œï¼šç”¨çš„æ˜¯å…¬å…±åº“ï¼Œä»æ²¡æ”¹è¿‡</li>
<li><strong>æŠ˜ä¸­å…±è¯†</strong>ï¼šå¯èƒ½æ˜¯ HTTP ä¼ è¾“è¿‡ç¨‹ä¸­å¯¹ JSON åšäº†è½¬ä¹‰</li>
</ul>
<p>ç»è¿‡ä¸€ç•ªè°ƒè¯•å‘ç°ï¼š</p>
<ul>
<li>å‰ç«¯éªŒç­¾æ—¶ï¼ŒJSON å­—ç¬¦ä¸²å­—æ®µæœ‰<strong>ä¸€æ¬¡è½¬ä¹‰å­—ç¬¦</strong>ï¼ˆå¦‚ <code>"</code>)</li>
<li>åç«¯æ”¶åˆ°çš„ body ä¸­ï¼ŒJSON å­—ç¬¦ä¸²å­—æ®µæœ‰<strong>äºŒæ¬¡è½¬ä¹‰å­—ç¬¦</strong>ï¼ˆå¦‚ <code>\"</code>)</li>
</ul>
<p>åŒæ–¹éªŒç­¾çš„æ•°æ®ä¸ä¸€è‡´ï¼Œè‡ªç„¶éªŒè¯å¤±è´¥ã€‚</p>
<p>ä¸´æ—¶æ–¹æ¡ˆï¼šå¯¹è¿™ä¸ªå­—æ®µåš Base64 ç¼–ç ï¼Œç»•è¿‡è½¬ä¹‰é—®é¢˜ã€‚</p>
<p>ä½†äº‹å®çœŸçš„æ˜¯ HTTP ä¼ è¾“å¯¼è‡´çš„è½¬ä¹‰å—ï¼Ÿ<strong>å½“ç„¶ä¸æ˜¯</strong></p>
<p><strong>HTTP è¯·æ±‚æœ¬èº«ä¸ä¼šå¯¹æ•°æ®è¿›è¡Œè½¬ä¹‰</strong>ã€‚é‚£è½¬ä¹‰å­—ç¬¦æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Ÿ</p>
<h3 data-id="heading-0">é—®é¢˜æ ¹æº</h3>
<p>æ•´ä¸ªæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p>
<h4 data-id="heading-1">ç¬¬ä¸€æ­¥ï¼šåç«¯æ¥å£ A è¿”å›æ•°æ®ï¼ˆç¬¬ä¸€æ¬¡åºåˆ—åŒ–ï¼‰</h4>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â åç«¯è¿”å›çš„å¯¹è±¡</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">Response</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â StringÂ <span class="hljs-keyword">data</span>;Â Â <span class="hljs-comment">//Â è¿™é‡Œå­˜å‚¨çš„æ˜¯Â JSONÂ å­—ç¬¦ä¸²</span>
}

<span class="hljs-comment">//Â æ¥å£Â AÂ è¿”å›æ•°æ®</span>
<span class="hljs-keyword">return</span>Â newÂ Response(<span class="hljs-string">"{"</span>name<span class="hljs-string">":"</span>å¼ ä¸‰<span class="hljs-string">","</span>age<span class="hljs-string">":25}"</span>);
</code></pre>
<p>Spring Boot åœ¨å“åº”æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œ JSON åºåˆ—åŒ–ï¼Œç”±äº <code>data</code> å­—æ®µæœ¬èº«æ˜¯å­—ç¬¦ä¸²ï¼Œä¼šå¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
Â Â <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span>Â <span class="hljs-string">"{"</span>name<span class="hljs-string">":"</span>å¼ ä¸‰<span class="hljs-string">","</span>age<span class="hljs-string">":25}"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-2">ç¬¬äºŒæ­¥ï¼šå‰ç«¯éªŒç­¾ï¼ˆåŸºäºä¸€æ¬¡è½¬ä¹‰çš„æ•°æ®ï¼‰</h4>
<p>å‰ç«¯æ‹¿åˆ°å“åº”åï¼Œå¯¹æ•´ä¸ªå¯¹è±¡è¿›è¡ŒéªŒç­¾ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//Â å‰ç«¯æ”¶åˆ°çš„æ•°æ®</span>
<span class="hljs-keyword">const</span>Â responseÂ =Â {
Â Â <span class="hljs-attr">data</span>:Â <span class="hljs-string">"{"</span>name<span class="hljs-string">":"</span>å¼ ä¸‰<span class="hljs-string">","</span>age<span class="hljs-string">":25}"</span>Â Â <span class="hljs-comment">//Â å¸¦æœ‰ä¸€æ¬¡è½¬ä¹‰</span>
};

<span class="hljs-comment">//Â å¯¹è¿™ä¸ªå¯¹è±¡åšéªŒç­¾</span>
<span class="hljs-keyword">const</span>Â signatureÂ =Â <span class="hljs-title function_">sign</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(response));
</code></pre>
<p>æ­¤æ—¶éªŒç­¾çš„åŸå§‹æ•°æ®åŒ…å«<strong>ä¸€æ¬¡è½¬ä¹‰å­—ç¬¦</strong>ã€‚</p>
<h4 data-id="heading-3">ç¬¬ä¸‰æ­¥ï¼šå‰ç«¯è¯·æ±‚æ¥å£ Bï¼ˆç¬¬äºŒæ¬¡åºåˆ—åŒ–ï¼‰</h4>
<p>å‰ç«¯å°†è¿™ä¸ªå¯¹è±¡ä½œä¸º body è¯·æ±‚æ¥å£ Bï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">//Â å°†å¯¹è±¡å‘é€ç»™æ¥å£Â B</span>
axios.<span class="hljs-built_in">post</span>(<span class="hljs-string">'/api/b'</span>,Â response);
</code></pre>
<p>æµè§ˆå™¨æˆ– HTTP åº“ä¼šå†æ¬¡å¯¹ body è¿›è¡Œ JSON åºåˆ—åŒ–ï¼ŒJSON å­—ç¬¦ä¸²åˆä¼šè¢«è½¬ä¹‰ä¸€æ¬¡ï¼š</p>
<pre><code class="hljs language-swift" lang="swift">{
Â Â <span class="hljs-string">"data"</span>:Â <span class="hljs-string">"{<span class="hljs-subst">\"</span>name<span class="hljs-subst">\"</span>:<span class="hljs-subst">\"</span>å¼ ä¸‰<span class="hljs-subst">\"</span>,<span class="hljs-subst">\"</span>age<span class="hljs-subst">\"</span>:25}"</span>
}
</code></pre>
<p>æ³¨æ„ï¼š<code>"</code> å˜æˆäº† <code>\"</code>ï¼ˆäºŒæ¬¡è½¬ä¹‰ï¼‰</p>
<h4 data-id="heading-4">ç¬¬å››æ­¥ï¼šåç«¯æ¥å£ B éªŒç­¾ï¼ˆåŸºäºäºŒæ¬¡è½¬ä¹‰çš„æ•°æ®ï¼‰</h4>
<p>åç«¯æ”¶åˆ°è¯·æ±‚åï¼Œæ‹¿åˆ°çš„æ˜¯ç»è¿‡<strong>äºŒæ¬¡è½¬ä¹‰</strong>çš„æ•°æ®è¿›è¡ŒéªŒç­¾ï¼š</p>
<pre><code class="hljs language-swift" lang="swift"><span class="hljs-comment">//Â åç«¯æ”¶åˆ°çš„Â bodyï¼ˆäºŒæ¬¡è½¬ä¹‰ï¼‰</span>
<span class="hljs-type">String</span>Â bodyÂ <span class="hljs-operator">=</span>Â <span class="hljs-string">"{<span class="hljs-subst">\"</span>name<span class="hljs-subst">\"</span>:<span class="hljs-subst">\"</span>å¼ ä¸‰<span class="hljs-subst">\"</span>,<span class="hljs-subst">\"</span>age<span class="hljs-subst">\"</span>:25}"</span>;

<span class="hljs-comment">//Â éªŒç­¾å¤±è´¥ï¼å› ä¸ºè½¬ä¹‰å­—ç¬¦æ•°é‡ä¸ä¸€è‡´</span>
</code></pre>
<h3 data-id="heading-5">ä¸ºä»€ä¹ˆéªŒç­¾ä¼šå¤±è´¥ï¼Ÿ</h3>
<ul>
<li><strong>å‰ç«¯éªŒç­¾</strong>ï¼šåŸºäºä¸€æ¬¡è½¬ä¹‰çš„æ•°æ® <code>{"name":...}</code></li>
<li><strong>åç«¯éªŒç­¾</strong>ï¼šåŸºäºäºŒæ¬¡è½¬ä¹‰çš„æ•°æ® <code>{\"name\":...}</code></li>
</ul>
<p>ä¸¤è¾¹è®¡ç®—ç­¾åçš„åŸå§‹æ•°æ®ä¸ä¸€è‡´ï¼Œè‡ªç„¶å°±éªŒç­¾å¤±è´¥äº†</p>
<h2 data-id="heading-6">æœ€å¿«çš„æ–¹æ¡ˆ</h2>
<p><strong>ä¸è¦åœ¨å¯¹è±¡ä¸­åµŒå¥— JSON å­—ç¬¦ä¸²ï¼Œç›´æ¥è¿”å› JSON å¯¹è±¡</strong></p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-comment">//Â é”™è¯¯åšæ³•</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">Response</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â StringÂ <span class="hljs-keyword">data</span>;Â Â <span class="hljs-comment">//Â JSONÂ å­—ç¬¦ä¸²</span>
}

<span class="hljs-comment">//Â æ­£ç¡®åšæ³•</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">Response</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â UserInfoÂ <span class="hljs-keyword">data</span>;Â Â <span class="hljs-comment">//Â JSONÂ å¯¹è±¡</span>
}

<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">class</span>Â <span class="hljs-title class_">UserInfo</span>Â {
Â Â Â Â <span class="hljs-keyword">private</span>Â StringÂ name;
Â Â Â Â <span class="hljs-keyword">private</span>Â IntegerÂ age;
}
</code></pre>
<p>è¿™æ · Spring Boot åªä¼šè¿›è¡Œä¸€æ¬¡åºåˆ—åŒ–ï¼Œä¸ä¼šäº§ç”Ÿè½¬ä¹‰å­—ç¬¦ï¼Œå‰åç«¯å¤„ç†çš„æ•°æ®æ ¼å¼å®Œå…¨ä¸€è‡´ã€‚</p>
<h2 data-id="heading-7">çŸ¥å·±çŸ¥å½¼</h2>
<p>æ—¢ç„¶æ‰¾åˆ°äº†é—®é¢˜æ ¹æºï¼Œæ­£å¥½å°±æ·±å…¥æºç çœ‹çœ‹ Jackson æ˜¯å¦‚ä½•å¯¹å­—ç¬¦ä¸²è¿›è¡Œåºåˆ—åŒ–çš„ã€‚Spring Boot é»˜è®¤ä½¿ç”¨ Jackson ä½œä¸º JSON åºåˆ—åŒ–æ¡†æ¶ã€‚</p>
<h3 data-id="heading-8">åºåˆ—åŒ–è°ƒç”¨é“¾è·¯</h3>
<h4 data-id="heading-9">1. BeanSerializerBase - å¯¹è±¡åºåˆ—åŒ–å…¥å£</h4>
<p>åºåˆ—åŒ–ä¸€èˆ¬ä¼šè°ƒç”¨ <code>BeanSerializer</code>ï¼Œå…¶æ ¸å¿ƒå®ç°åœ¨ <code>BeanSerializerBase</code> ä¸­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">protectedÂ voidÂ serializeFields(ObjectÂ bean,Â JsonGeneratorÂ gen,Â SerializerProviderÂ provider)
Â Â Â Â Â Â Â Â throwsÂ IOExceptionÂ {
Â Â Â Â finalÂ BeanPropertyWriter<span class="hljs-section">[]</span>Â props<span class="hljs-comment">;Â Â //Â å¯¹è±¡çš„æ‰€æœ‰å­—æ®µå±æ€§</span>
Â Â Â Â ifÂ (_filteredPropsÂ !=Â nullÂ &amp;&amp;Â provider.getActiveView()Â !=Â null)Â {
Â Â Â Â Â Â Â Â <span class="hljs-attr">props</span>Â =Â _filteredProps<span class="hljs-comment">;</span>
Â Â Â Â }Â elseÂ {
Â Â Â Â Â Â Â Â <span class="hljs-attr">props</span>Â =Â _props<span class="hljs-comment">;</span>
Â Â Â Â }

Â Â Â Â intÂ <span class="hljs-attr">i</span>Â =Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
Â Â Â Â tryÂ {
Â Â Â Â Â Â Â Â //Â éå†æ‰€æœ‰å­—æ®µè¿›è¡Œåºåˆ—åŒ–
Â Â Â Â Â Â Â Â forÂ (finalÂ intÂ <span class="hljs-attr">len</span>Â =Â props.length<span class="hljs-comment">;Â iÂ &lt;Â len;Â ++i)Â {</span>
Â Â Â Â Â Â Â Â Â Â Â Â BeanPropertyWriterÂ <span class="hljs-attr">prop</span>Â =Â props[i]<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (propÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â prop.serializeAsField(bean,Â gen,Â provider)<span class="hljs-comment">;Â Â //Â å…³é”®è°ƒç”¨</span>
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â //Â ...Â çœç•¥å…¶ä»–ä»£ç 
Â Â Â Â }
}
</code></pre>
<h4 data-id="heading-10">2. BeanPropertyWriter - å­—æ®µåºåˆ—åŒ–å¤„ç†</h4>
<p>æ¯ä¸ªå­—æ®µä¼šè°ƒç”¨ <code>serializeAsField</code> æ–¹æ³•ï¼Œæ ¹æ®å­—æ®µç±»å‹é€‰æ‹©å¯¹åº”çš„åºåˆ—åŒ–å™¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">publicÂ voidÂ serializeAsField(ObjectÂ bean,Â JsonGeneratorÂ gen,Â SerializerProviderÂ prov)
Â Â Â Â Â Â Â Â throwsÂ ExceptionÂ {
Â Â Â Â //Â è·å–å­—æ®µå€¼
Â Â Â Â finalÂ ObjectÂ <span class="hljs-attr">value</span>Â =Â (_accessorMethodÂ ==Â null)
Â Â Â Â Â Â Â Â ?Â _field.get(bean)
Â Â Â Â Â Â Â Â :Â _accessorMethod.invoke(bean,Â (Object<span class="hljs-section">[]</span>)Â null)<span class="hljs-comment">;</span>

Â Â Â Â //Â å¤„ç†Â nullÂ å€¼
Â Â Â Â ifÂ (<span class="hljs-attr">value</span>Â ==Â null)Â {
Â Â Â Â Â Â Â Â ifÂ (_nullSerializerÂ !=Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â gen.writeFieldName(_name)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â Â Â Â Â _nullSerializer.serialize(null,Â gen,Â prov)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â return<span class="hljs-comment">;</span>
Â Â Â Â }

Â Â Â Â //Â è·å–åºåˆ—åŒ–å™¨ï¼ˆå…³é”®ï¼šæ ¹æ®å­—æ®µç±»å‹é€‰æ‹©ä¸åŒçš„åºåˆ—åŒ–å™¨ï¼‰
Â Â Â Â JsonSerializer&lt;Object&gt;Â <span class="hljs-attr">ser</span>Â =Â _serializer<span class="hljs-comment">;</span>
Â Â Â Â ifÂ (<span class="hljs-attr">ser</span>Â ==Â null)Â {
Â Â Â Â Â Â Â Â Class&lt;?&gt;Â <span class="hljs-attr">cls</span>Â =Â value.getClass()<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â PropertySerializerMapÂ <span class="hljs-attr">m</span>Â =Â _dynamicSerializers<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â <span class="hljs-attr">ser</span>Â =Â m.serializerFor(cls)<span class="hljs-comment">;Â Â //Â StringÂ ç±»å‹ä¼šè¿”å›Â StringSerializer</span>
Â Â Â Â Â Â Â Â ifÂ (<span class="hljs-attr">ser</span>Â ==Â null)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-attr">ser</span>Â =Â _findAndAddDynamic(m,Â cls,Â prov)<span class="hljs-comment">;</span>
Â Â Â Â Â Â Â Â }
Â Â Â Â }

Â Â Â Â //Â å†™å…¥å­—æ®µåå’Œå€¼
Â Â Â Â gen.writeFieldName(_name)<span class="hljs-comment">;</span>
Â Â Â Â ser.serialize(value,Â gen,Â prov)<span class="hljs-comment">;Â Â //Â è°ƒç”¨å…·ä½“çš„åºåˆ—åŒ–å™¨</span>
}
</code></pre>
<p><strong>æ ¸å¿ƒè¦ç‚¹</strong>ï¼š</p>
<ul>
<li>å¦‚æœå­—æ®µæ˜¯å¯¹è±¡ï¼Œä¼šé€’å½’è°ƒç”¨ <code>BeanSerializer</code></li>
<li>å¦‚æœå­—æ®µæ˜¯å­—ç¬¦ä¸²ï¼Œä¼šè°ƒç”¨ <code>StringSerializer</code></li>
</ul>
<h4 data-id="heading-11">3. StringSerializer</h4>
<p>å½“å­—æ®µç±»å‹æ˜¯ <code>String</code> æ—¶ï¼Œä½¿ç”¨ <code>StringSerializer</code> è¿›è¡Œåºåˆ—åŒ–ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span>Â <span class="hljs-keyword">void</span>Â <span class="hljs-title function_">serialize</span><span class="hljs-params">(ObjectÂ value,Â JsonGeneratorÂ gen,Â SerializerProviderÂ provider)</span>
Â Â Â Â Â Â Â Â <span class="hljs-keyword">throws</span>Â IOExceptionÂ {
Â Â Â Â gen.writeString((String)Â value);Â Â <span class="hljs-comment">//Â è°ƒç”¨Â JsonGeneratorÂ å†™å…¥å­—ç¬¦ä¸²</span>
}
</code></pre>
<h4 data-id="heading-12">4. UTF8JsonGenerator</h4>
<p>ç”±äºé»˜è®¤ä½¿ç”¨ UTF-8 ç¼–ç ï¼Œæœ€ç»ˆä¼šè°ƒç”¨ <code>UTF8JsonGenerator.writeString</code> æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">public</span>Â voidÂ writeString(StringÂ text)Â throwsÂ IOExceptionÂ {
Â Â Â Â <span class="hljs-keyword">this</span>._verifyValueWrite(<span class="hljs-string">"writeÂ aÂ string"</span>);
Â Â Â Â <span class="hljs-keyword">if</span>Â (textÂ ==Â <span class="hljs-literal">null</span>)Â {
Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>._writeNull();
Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â Â Â intÂ lenÂ =Â text.length();
Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (lenÂ &gt;Â <span class="hljs-keyword">this</span>._outputMaxContiguous)Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>._writeStringSegments(text,Â <span class="hljs-literal">true</span>);
Â Â Â Â Â Â Â Â }Â <span class="hljs-keyword">else</span>Â {
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">this</span>._outputTailÂ +Â lenÂ &gt;=Â <span class="hljs-keyword">this</span>._outputEnd)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>._flushBuffer();
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ å¼€å§‹å¼•å·</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>._outputBuffer[<span class="hljs-keyword">this</span>._outputTail++]Â =Â <span class="hljs-keyword">this</span>._quoteChar;

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â å†™å…¥å­—ç¬¦ä¸²å†…å®¹ï¼ˆè¿™é‡Œä¼šå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼ï¼‰</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>._writeStringSegment((String)text,Â <span class="hljs-number">0</span>,Â len);

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">if</span>Â (<span class="hljs-keyword">this</span>._outputTailÂ &gt;=Â <span class="hljs-keyword">this</span>._outputEnd)Â {
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>._flushBuffer();
Â Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-comment">//Â æ·»åŠ ç»“æŸå¼•å·</span>
Â Â Â Â Â Â Â Â Â Â Â Â <span class="hljs-keyword">this</span>._outputBuffer[<span class="hljs-keyword">this</span>._outputTail++]Â =Â <span class="hljs-keyword">this</span>._quoteChar;
Â Â Â Â Â Â Â Â }
Â Â Â Â }
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š<code>_writeStringSegment</code> æ–¹æ³•ä¼šå¯¹å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ <code>"</code>ã€``ã€æ¢è¡Œç¬¦ç­‰ï¼‰è¿›è¡Œè½¬ä¹‰å¤„ç†ã€‚</p>
<h3 data-id="heading-13">è½¬ä¹‰ç¤ºä¾‹å¯¹æ¯”</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b702a100de444dfaa7164c85df8612e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgOeWPt-i-vuS6ug==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766204792&amp;x-signature=UNxR7zkOHVHIvq4YSqd7j9C4Siw%3D" alt="" loading="lazy"/> åºåˆ—åŒ–ä¹‹åå°±å¤šäº†ä¸€å±‚è½¬ä¹‰ç¬¦å·</p>
<h3 data-id="heading-14">ä¸»è¦çš„è°ƒç”¨é“¾è·¯</h3>
<pre><code class="hljs language-scss" lang="scss">å¯¹è±¡åºåˆ—åŒ–
Â Â â†“
BeanSerializerBase<span class="hljs-selector-class">.serializeFields</span>()Â Â <span class="hljs-comment">//Â éå†å¯¹è±¡å­—æ®µ</span>
Â Â â†“
BeanPropertyWriter<span class="hljs-selector-class">.serializeAsField</span>()Â Â <span class="hljs-comment">//Â å¤„ç†å•ä¸ªå­—æ®µ</span>
Â Â â†“
StringSerializer<span class="hljs-selector-class">.serialize</span>()Â Â <span class="hljs-comment">//Â StringÂ ç±»å‹èµ°è¿™é‡Œ</span>
Â Â â†“
UTF8JsonGenerator<span class="hljs-selector-class">.writeString</span>()Â Â <span class="hljs-comment">//Â æ‰§è¡Œè½¬ä¹‰</span>
Â Â â†“
<span class="hljs-built_in">_writeStringSegment</span>()Â Â <span class="hljs-comment">//Â è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼ˆ"Â â†’Â "ï¼‰</span>
</code></pre>
<p>ç†è§£äº†è¿™ä¸ªè°ƒç”¨é“¾è·¯ï¼Œå°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆ JSON å­—ç¬¦ä¸²åœ¨åºåˆ—åŒ–æ—¶ä¼šäº§ç”Ÿè½¬ä¹‰å­—ç¬¦ï¼Œä»¥åŠä¸ºä»€ä¹ˆå¤šæ¬¡åºåˆ—åŒ–ä¼šå¯¼è‡´å¤šå±‚è½¬ä¹‰ã€‚</p>
<h2 data-id="heading-15">æ€»ç»“</h2>
<ol>
<li><strong>å°½é‡é¿å…åœ¨å¯¹è±¡ä¸­åµŒå¥— JSON å­—ç¬¦ä¸²</strong>ï¼Œåº”è¯¥ä½¿ç”¨å¼ºç±»å‹å¯¹è±¡ï¼Œé¿å…å¤šæ¬¡åºåˆ—åŒ–å¸¦æ¥çš„è½¬ä¹‰é—®é¢˜</li>
<li><strong>HTTP ä¼ è¾“ä¸ä¼šç¯¡æ”¹æ•°æ®</strong>ï¼Œé—®é¢˜å¾€å¾€å‡ºåœ¨åºåˆ—åŒ–/ååºåˆ—åŒ–ç¯èŠ‚</li>
<li><strong>ç†è§£åºåˆ—åŒ–çš„æœ¬è´¨</strong>ï¼šæ¯åºåˆ—åŒ–ä¸€æ¬¡ï¼ŒJSON å­—ç¬¦ä¸²å°±ä¼šå¤šä¸€å±‚è½¬ä¹‰</li>
<li><strong>é‡åˆ°éªŒç­¾é—®é¢˜</strong>ï¼Œä¼˜å…ˆæ£€æŸ¥åŒæ–¹å¤„ç†æ•°æ®æ—¶ç»å†äº†å‡ æ¬¡åºåˆ—åŒ–</li>
</ol>
<p>éªŒç­¾è™½ç„¶å¥½ï¼Œä½†æœ‰æ—¶å€™ä¹ŸæŒºéº»çƒ¦çš„ã€‚æ‰€ä»¥ç†è§£æ•°æ®åœ¨å‰åç«¯ä¹‹é—´çš„æµè½¬è¿‡ç¨‹å’Œåºåˆ—åŒ–æ—¶æœºï¼Œå¯ä»¥æ›´å¥½é¿å…è¿™æ ·çš„éªŒç­¾é—®é¢˜ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ç¯‡å›¾æ–‡å½»åº•ææ‡‚ä»€ä¹ˆæ˜¯AI Agent]]></title>    <link>https://juejin.cn/post/7582844980399767592</link>    <guid>https://juejin.cn/post/7582844980399767592</guid>    <pubDate>2025-12-13T09:39:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582844980399767592" data-draft-id="7582516300050219035" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ç¯‡å›¾æ–‡å½»åº•ææ‡‚ä»€ä¹ˆæ˜¯AI Agent"/> <meta itemprop="keywords" content="Agent,LLM,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2025-12-13T09:39:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="AIå¤§æ¨¡å‹"/> <meta itemprop="url" content="https://juejin.cn/user/3817967696221534"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ç¯‡å›¾æ–‡å½»åº•ææ‡‚ä»€ä¹ˆæ˜¯AI Agent
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3817967696221534/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    AIå¤§æ¨¡å‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-13T09:39:39.000Z" title="Sat Dec 13 2025 09:39:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-13
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px}.markdown-body ::selection{color:#fff;background-color:#a862ea}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin:24px 0 12px;color:#a862ea}.markdown-body h1{line-height:2;font-size:1.4em}.markdown-body h1~p:first-of-type:first-letter{color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder}.markdown-body h2{font-size:1.2em}.markdown-body h3{font-size:1.1em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;padding-left:.2em}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#a862ea}.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item{list-style:none}.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:10px}.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p{opacity:.85;vertical-align:baseline;transition:all .1s ease}.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover{opacity:1}.markdown-body a{display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative}.markdown-body a:after{content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out}.markdown-body a:hover:after{transform:scaleX(1);transform-origin:bottom left}.markdown-body a:active,.markdown-body a:link{color:#a862ea}.markdown-body img{max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff}.markdown-body img:hover{opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)}.markdown-body blockquote{padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff}.markdown-body blockquote&gt;p{margin:0}.markdown-body .math{font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff}.markdown-body .math&gt;p{margin:0}.markdown-body code{padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff}.markdown-body pre{margin:2em 0}.markdown-body pre&gt;code{display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff}.markdown-body pre&gt;code:hover{box-shadow:0 0 20px #e7daff}.markdown-body pre&gt;code::-webkit-scrollbar{height:6px;background-color:#f8f5ff}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px}.markdown-body hr{margin:2em 0;border-top:1px solid #a862ea}.markdown-body table{width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{color:#a862ea;background:#f8f5ff}.markdown-body td,.markdown-body th{padding:.5em;border:1px solid #e7daff}.markdown-body tr{background-color:#f8f5ff}@media (max-width:720px){.markdown-body{font-size:12px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote>
<p>AI Agentä¹Ÿå«Agentï¼Œæ˜¯å¼€å‘å¤æ‚å¤§æ¨¡å‹åº”ç”¨åœºæ™¯ä¸­éå¸¸é‡è¦çš„æ¦‚å¿µï¼Œä½†æ˜¯å¾ˆå¤šäººå¹¶ä¸æ¸…æ¥šAgentæ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯å¦‚ä½•è¿ä½œçš„ï¼Ÿæœ¬æ–‡ç”¨å›¾æ–‡çš„å½¢å¼å½»åº•ææ‡‚è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯Agentï¼Ÿ</h2>
<p>å¤§æ¨¡å‹æœ¬èº«æ“…é•¿å›ç­”é—®é¢˜ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨æ—¶æˆ‘ä»¬ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå®ƒä»¬æ— æ³•æ„ŸçŸ¥å’Œæ”¹å˜å¤–ç•Œçš„ç¯å¢ƒï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>å¼€å‘ä¸€ä¸ªåšå®¢ç³»ç»Ÿï¼Œå®ƒç¡®å®å¯ä»¥å†™å‡ºä»£ç ï¼Œä½†æ˜¯å†™å®Œä¹‹åï¼ŒæŠŠä»£ç å†™å…¥åˆ°æ–‡ä»¶è¿˜æ˜¯è¦è‡ªå·±åŠ¨æ‰‹æ‹·è´ã€å¯åŠ¨æœåŠ¡ã€è°ƒè¯•</li>
<li>å·²ç»æœ‰äº†åšå®¢ç³»ç»Ÿçš„ä»£ç ï¼Œæƒ³è®©å¤§æ¨¡å‹åŸºäºè¿™äº›ä»£ç æ¥æ”¹å†™ï¼Œå¢åŠ ä¸€äº›åŠŸèƒ½ï¼Œå°±å¿…é¡»æŠŠå·²æœ‰çš„æ‰€æœ‰ä»£ç å¤åˆ¶ç»™å¤§æ¨¡å‹æ‰è¡Œï¼Œæˆ‘ä»¬ä¸ä¸»åŠ¨å‘Šè¯‰å¤§æ¨¡å‹å®ƒæ˜¯ä¸çŸ¥é“è¿™äº›ä»£ç çš„</li>
</ul>
<p>è¿™å°±æ˜¯å¤§æ¨¡å‹æ— æ³•æ„ŸçŸ¥å’Œæ”¹å˜å¤–ç•Œç¯å¢ƒçš„ä½“ç°ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬åªéœ€è¦æ¥å…¥å¯¹åº”çš„å·¥å…·å³å¯ï¼Œæ¯”å¦‚è¯»å†™æ–‡ä»¶å†…å®¹çš„å·¥å…·ã€æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨çš„å·¥å…·ã€è¿è¡Œç»ˆç«¯å‘½ä»¤çš„å·¥å…·ã€‚å·¥å…·å°±åƒå¤§æ¨¡å‹çš„æ„Ÿå®˜å’Œå››è‚¢ï¼Œæœ‰äº†å®ƒä»¬å¤§æ¨¡å‹å°±å¯ä»¥è‡ªå·±è¯»ã€å†™ä»£ç ï¼Œè¿è¡Œè°ƒè¯•ä»£ç ï¼Œæ•´ä¸ªè¿‡ç¨‹å®Œå…¨è‡ªåŠ¨åŒ–ã€‚</p>
<p>æŠŠå¤§æ¨¡å‹å’Œå·¥å…·ç»„ç»‡èµ·æ¥ï¼Œå˜æˆä¸€ä¸ªèƒ½æ„ŸçŸ¥å’Œæ”¹å˜å¤–ç•Œç¯å¢ƒçš„è½¯ä»¶å®ä½“ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºAI Agentã€‚</p>
<hr/>
<h2 data-id="heading-1">Agentçš„è®¾è®¡æ¨¡å¼</h2>
<p>Agentçš„è®¾è®¡æ¨¡å¼å¾ˆå¤šï¼Œæœ¬æ–‡ä¸»è¦è®²è§£åº”ç”¨æœ€å¤šçš„ä¸¤ä¸ªæ¨¡å¼ï¼ŒReActæ¨¡å¼å’ŒPlan-And-Executeæ¨¡å¼ã€‚</p>
<p>1ã€ReActæ¨¡å¼</p>
<p>åœ¨ReActæ¨¡å¼ä¸‹ï¼Œç”¨æˆ·å…ˆæäº¤ä»»åŠ¡ï¼ŒAgentå…ˆåšæ€è€ƒï¼ˆThoughtï¼‰ï¼›æ€è€ƒåä¼šå†³å®šæ˜¯å¦è°ƒç”¨å·¥å…·ï¼Œå¦‚æœéœ€è¦å°±ä¼šè°ƒç”¨å¯¹åº”çš„å·¥å…·ï¼ŒReActç§°è¿™ä¸€æ­¥ä¸ºè¡ŒåŠ¨ï¼ˆActionï¼‰ï¼›åœ¨è¡ŒåŠ¨åAgentä¼šå»æŸ¥çœ‹å·¥å…·çš„æ‰§è¡Œç»“æœï¼Œæ¯”å¦‚è¯»å–æ–‡ä»¶å†…å®¹ã€å†™å…¥æ–‡ä»¶æ˜¯å¦æˆåŠŸç­‰ï¼ŒReActç§°è¿™ä¸€æ­¥ä¸ºè§‚å¯Ÿï¼ˆObservationï¼‰ï¼›åœ¨è§‚å¯Ÿä¹‹åï¼ŒReActä¼šç»§ç»­æ€è€ƒï¼Œå®ƒä¼šå†æ¬¡åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·ï¼Œå¦‚æœè¿˜æ˜¯éœ€è¦çš„è¯ï¼Œå®ƒä¼šç»§ç»­é‡å¤ä¹‹å‰æ‰€è¯´çš„è¡ŒåŠ¨ã€è§‚å¯Ÿã€æ€è€ƒçš„æµç¨‹ï¼Œç›´åˆ°æŸä¸€ä¸ªæ—¶åˆ»ï¼Œå¯ä»¥ç»™å‡ºç»“è®ºäº†ï¼Œæ­¤æ—¶å®ƒå°±è¾“å‡ºäº†æœ€ç»ˆç­”æ¡ˆï¼Œæ•´ä¸ªæµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1958e955a80d4280ab777f0f5c8dc545~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766223578&amp;x-signature=%2Boc2%2FBzxj86kxMDc%2B3DQ7LScKqo%3D" alt="" loading="lazy"/></p>
<p>ReActæ¨¡å¼çš„å®ç°åŸç†ï¼š</p>
<p>ä¸ºä»€ä¹ˆReActæ¨¡å¼æ‹¿åˆ°ç”¨æˆ·è¾“å…¥çš„å†…å®¹åéœ€è¦å…ˆæ€è€ƒã€å†è¡ŒåŠ¨ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥è¡ŒåŠ¨ï¼Ÿæ˜¯å› ä¸ºæ¨¡å‹å°±è¿™æ ·è®­ç»ƒçš„å—ï¼Ÿè¿™å’Œæ¨¡å‹çš„è®­ç»ƒæ²¡æœ‰å…³ç³»ï¼Œä¸»è¦çš„å¥¥ç§˜å…¶å®éƒ½é›†ä¸­åœ¨ç³»ç»Ÿæç¤ºè¯ä¸Šï¼Œå®ƒè§„å®šäº†æ¨¡å‹çš„è§’è‰²ã€è¿è¡Œçš„è§„åˆ™ã€ç¯å¢ƒä¿¡æ¯ç­‰ç­‰ï¼Œç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå·¥ä½œæ–¹å¼å¦‚ä¸‹ï¼š
<span class="hljs-bullet">1.</span> ä½ ä¼šåŸºäºç”¨æˆ·çš„é—®é¢˜å…ˆè¿›è¡Œâ€œæ€è€ƒï¼ˆThoughtï¼‰â€ï¼Œå†™å‡ºä½ çš„æ¨ç†è¿‡ç¨‹ã€‚
<span class="hljs-bullet">2.</span> ç„¶åæ ¹æ®æ¨ç†ç»“æœæ‰§è¡Œâ€œè¡ŒåŠ¨ï¼ˆActionï¼‰â€ï¼Œè°ƒç”¨å¯ç”¨çš„å·¥å…·ã€‚
<span class="hljs-bullet">3.</span> å½“ä½ è·å¾—è§‚å¯Ÿç»“æœï¼ˆObservationï¼‰åï¼Œå†ç»§ç»­æ€è€ƒæˆ–ç»™å‡ºæœ€ç»ˆç­”æ¡ˆã€‚
ä¸¥æ ¼éµå¾ªä»¥ä¸‹è¾“å‡ºæ ¼å¼ï¼š
Thought: ...
Action: ...
Observation: ...
Final Answer: ...
ä½ å¯ä»¥ä½¿ç”¨çš„å·¥å…·å¦‚ä¸‹ï¼š
<span class="hljs-bullet">1.</span> WebSearch(query: str) â€”â€” ç”¨äºæœç´¢ç½‘ç»œä¿¡æ¯
<span class="hljs-bullet">2.</span> Calculator(expression: str) â€”â€” ç”¨äºæ•°å­¦è®¡ç®—
<span class="hljs-bullet">3.</span> PythonRunner(code: str) â€”â€” è¿è¡Œ Python ä»£ç 
</code></pre>
<p>å¤‡æ³¨ï¼šé™¤äº†ä¸Šè¿°æç¤ºè¯å¤–ï¼Œè¿˜éœ€è¦å…·ä½“çš„å¤„ç†ç¨‹åºã€‚</p>
<p>2ã€Plan-And-Executeæ¨¡å¼</p>
<p>åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥çš„ä»»åŠ¡å…ˆåˆ¶å®šä¸€ä¸ªå¤šæ­¥éª¤çš„è®¡åˆ’ï¼Œç„¶åé€é¡¹æ‰§è¡Œè¯¥è®¡åˆ’ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯ä»¥æ ¹æ®æ–°è·å–çš„ä¿¡æ¯åŠ¨æ€è°ƒæ•´è®¡åˆ’ã€‚ Plan-And-Executeæ¨¡å¼å°†Agentçš„å·¥ä½œæµç¨‹æ˜ç¡®åˆ’åˆ†ä¸ºä¸¤ä¸ªä¸»è¦é˜¶æ®µï¼š</p>
<ul>
<li><strong>è§„åˆ’é˜¶æ®µ</strong>ï¼šAgenté¦–å…ˆå¯¹æ¥æ”¶åˆ°çš„å¤æ‚ä»»åŠ¡æˆ–ç›®æ ‡è¿›è¡Œæ•´ä½“åˆ†æå’Œç†è§£ã€‚ç„¶åï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªé«˜å±‚æ¬¡çš„è®¡åˆ’ï¼Œå°†åŸå§‹ä»»åŠ¡åˆ†è§£ä¸ºä¸€ç³»åˆ—æ›´å°ã€æ›´æ˜“äºç®¡ç†çš„å­ä»»åŠ¡æˆ–æ­¥éª¤ã€‚è¿™ç§åˆ†è§£æœ‰åŠ©äºåœ¨æ‰§è¡Œé˜¶æ®µå‡å°‘å¤„ç†æ¯ä¸ªå­ä»»åŠ¡æ‰€éœ€çš„ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œè¿™ä¸ªè®¡åˆ’é€šå¸¸æ˜¯ä¸€ä¸ªæœ‰åºçš„è¡ŒåŠ¨åºåˆ—ï¼ŒæŒ‡æ˜äº†è¦è¾¾æˆæœ€ç»ˆç›®æ ‡éœ€è¦å®Œæˆå“ªäº›å…³é”®ç¯èŠ‚ã€‚è¿™ä¸ªè“å›¾å¯ä»¥å…ˆå‘ˆç°ç»™ç”¨æˆ·ï¼Œå…è®¸ç”¨æˆ·åœ¨æ‰§è¡Œå¼€å§‹å‰å¯¹è®¡åˆ’æ­¥éª¤ç»™å‡ºä¿®æ”¹æ„è§ã€‚</li>
<li><strong>æ‰§è¡Œé˜¶æ®µ</strong>ï¼šè®¡åˆ’åˆ¶å®šå®Œæˆåï¼ˆå¯èƒ½å·²é‡‡çº³ç”¨æˆ·æ„è§ï¼‰ï¼ŒAgentè¿›å…¥æ‰§è¡Œé˜¶æ®µã€‚å®ƒä¼šæŒ‰ç…§è§„åˆ’å¥½çš„æ­¥éª¤é€ä¸€æ‰§è¡Œæ¯ä¸ªå­ä»»åŠ¡ã€‚åœ¨æ‰§è¡Œæ¯ä¸ªå­ä»»åŠ¡æ—¶ï¼ŒAgentå¯ä»¥é‡‡ç”¨æ ‡å‡†çš„ReActå¾ªç¯æ¥å¤„ç†è¯¥å­ä»»åŠ¡çš„å…·ä½“ç»†èŠ‚ï¼Œä¾‹å¦‚è°ƒç”¨ç‰¹å®šå·¥å…·ã€ä¸å¤–éƒ¨ç¯å¢ƒäº¤äº’ã€æˆ–è¿›è¡Œæ›´ç»†è‡´çš„æ¨ç†ã€‚æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒAgentä¼šç›‘æ§æ¯ä¸ªå­ä»»åŠ¡çš„å®Œæˆæƒ…å†µã€‚å¦‚æœæŸä¸ªå­ä»»åŠ¡æˆåŠŸï¼Œåˆ™ç»§ç»­ä¸‹ä¸€ä¸ªï¼›å¦‚æœé‡åˆ°å¤±è´¥æˆ–é¢„æœŸä¹‹å¤–çš„æƒ…å†µï¼ŒAgentå¯èƒ½éœ€è¦é‡æ–°è¯„ä¼°å½“å‰è®¡åˆ’ï¼Œå¯ä»¥åŠ¨æ€è°ƒæ•´è®¡åˆ’æˆ–è¿”å›åˆ°è§„åˆ’é˜¶æ®µè¿›è¡Œä¿®æ­£ï¼Œæ­¤é˜¶æ®µåŒæ ·å¯ä»¥å¼•å…¥ç”¨æˆ·å‚ä¸ï¼Œå…è®¸ç”¨æˆ·å¯¹å­ä»»åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹æˆ–ç»“æœè¿›è¡Œåé¦ˆï¼Œç”šè‡³æå‡ºè°ƒæ•´å»ºè®®ã€‚</li>
</ul>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/985b0a82dc3e405a999c49801b07e332~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766223578&amp;x-signature=CZ%2FjI5DjGRfPSW%2FeK%2BuMsctkAlU%3D" alt="" loading="lazy"/></p>
<p>ä¸æ ‡å‡†çš„ReActç›¸æ¯”ï¼ŒPlan-and-Executeæ¨¡å¼çš„ä¸»è¦ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li><strong>ç»“æ„åŒ–ä¸ä¸Šä¸‹æ–‡ä¼˜åŒ–</strong>ï¼šé€šè¿‡é¢„å…ˆè§„åˆ’å°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå°æ­¥éª¤ï¼Œä¸ä»…ä½¿Agentè¡Œä¸ºæ›´æœ‰æ¡ç†ï¼Œè¿˜æœ‰æ•ˆå‡å°‘äº†æ‰§è¡Œå„å­ä»»åŠ¡æ—¶çš„ä¸Šä¸‹æ–‡é•¿åº¦ï¼Œæå‡äº†å¤„ç†é•¿é“¾æ¡ä»»åŠ¡çš„æ•ˆç‡å’Œç¨³å®šæ€§ã€‚</li>
<li><strong>æå‡é²æ£’æ€§</strong>ï¼šå°†å¤§é—®é¢˜åˆ†è§£ä¸ºå°é—®é¢˜ï¼Œé™ä½äº†å•æ­¥å†³ç­–çš„å¤æ‚æ€§ã€‚å¦‚æœæŸä¸ªå­ä»»åŠ¡å¤±è´¥ï¼Œå½±å“èŒƒå›´ç›¸å¯¹å¯æ§ï¼Œä¹Ÿæ›´å®¹æ˜“è¿›è¡Œé’ˆå¯¹æ€§çš„è°ƒæ•´ã€‚</li>
<li><strong>å¢å¼ºå¯è§£é‡Šæ€§ä¸äººæœºååŒ</strong>ï¼šæ¸…æ™°çš„è®¡åˆ’å’Œåˆ†æ­¥æ‰§è¡Œè¿‡ç¨‹ä½¿å¾—Agentçš„è¡Œä¸ºæ›´å®¹æ˜“è¢«ç†è§£å’Œè°ƒè¯•ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä»»åŠ¡çš„åˆ†è§£ä¸ºç”¨æˆ·åœ¨è§„åˆ’å®¡æ‰¹å’Œæ‰§è¡Œç›‘æ§ç­‰ç¯èŠ‚çš„å‚ä¸æä¾›äº†ä¾¿åˆ©ï¼Œç”¨æˆ·å¯ä»¥å¯¹ä»»åŠ¡çš„æ‰§è¡Œæ­¥éª¤ç»™å‡ºä¿®æ”¹æ„è§ï¼Œä»è€Œå®ç°æ›´é«˜æ•ˆçš„äººæœºåä½œï¼Œç¡®ä¿ä»»åŠ¡ç»“æœæ›´ç¬¦åˆé¢„æœŸã€‚</li>
</ul>
<p>è¿™ç§"è§„åˆ’-æ‰§è¡Œ"çš„æ€è€ƒæ¡†æ¶å› å…¶åœ¨å¤æ‚ä»»åŠ¡å¤„ç†ä¸Šçš„å“è¶Šè¡¨ç°ï¼Œå·²æˆä¸ºAI Agenté¢†åŸŸå¹¿æ³›é‡‡ç”¨çš„æ ¸å¿ƒç­–ç•¥ä¹‹ä¸€ã€‚</p>
<h2 data-id="heading-2">æ€»ç»“</h2>
<p>æ— è®ºæ˜¯åˆšå…¥é—¨çš„å¤§æ¨¡å‹åº”ç”¨å¼€å‘è€…ï¼Œè¿˜æ˜¯å·¥ç¨‹åŒ–çš„å›¢é˜Ÿï¼Œåªè¦æŒæ¡äº†Agentåº•å±‚åŸç†å’Œæ–¹æ³•è®ºï¼Œç»“åˆåˆé€‚çš„å·¥å…·å’Œæ¡†æ¶ï¼Œéƒ½èƒ½è½»æ¾ã€é«˜æ•ˆå¼€å‘å‡ºåŸºäºå¤§æ¨¡å‹çš„åº”ç”¨ã€‚</p>
<p>ä»ä¸‹ä¸€æœŸå¼€å§‹ï¼Œæˆ‘ä¼šä»¥ä¸€ä¸ªâ€œä»£ç ç”Ÿæˆç³»ç»Ÿâ€ä¸ºå®ä¾‹ï¼Œè¯¦ç»†è®²è§£Agentå¦‚ä½•åœ¨å®é™…é¡¹ç›®ä¸­è¿›è¡Œè¿ç”¨ï¼Œæ•´ä¸ªâ€œä»£ç ç”Ÿæˆç³»ç»Ÿâ€çš„ä¸šåŠ¡æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/574817af56e9414bacc0d96658b93b69~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgQUnlpKfmqKHlnos=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1766223578&amp;x-signature=id8XBcFXCjIv1M%2FPFCxFypgSNnM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-3">å­¦ä¹ èµ„æºæ¨è</h3>
<p>å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°å­¦ä¹ å¤§æ¨¡å‹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›éå¸¸æœ‰ä»·å€¼çš„å­¦ä¹ èµ„æºï¼Œè¿™äº›èµ„æºå°†å¸®åŠ©ä½ ä»ä¸åŒè§’åº¦å­¦ä¹ å¤§æ¨¡å‹ï¼Œæå‡ä½ çš„å®è·µèƒ½åŠ›ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è¾ƒé•¿ï¼Œå»ºè®®ç‚¹èµæ”¶è—ã€‚æ›´å¤šAIå¤§æ¨¡å‹åº”ç”¨å¼€å‘å­¦ä¹ è§†é¢‘åŠèµ„æ–™ï¼Œåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitcode.com%2FEnjoyEDU%2FLLM" target="_blank" title="https://gitcode.com/EnjoyEDU/LLM" ref="nofollow noopener noreferrer">è¿™é‡Œ</a>ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueçš„Classç»‘å®šå¯¹è±¡è¯­æ³•å¦‚ä½•è®©åŠ¨æ€ç±»ååˆ‡æ¢å˜å¾—ç›´è§‚é«˜æ•ˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7582958136257839140</link>    <guid>https://juejin.cn/post/7582958136257839140</guid>    <pubDate>2025-12-14T06:50:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7582958136257839140" data-draft-id="7583168260796563496" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueçš„Classç»‘å®šå¯¹è±¡è¯­æ³•å¦‚ä½•è®©åŠ¨æ€ç±»ååˆ‡æ¢å˜å¾—ç›´è§‚é«˜æ•ˆï¼Ÿ    "/> <meta itemprop="keywords" content="å‰ç«¯,AIç¼–ç¨‹,Trae"/> <meta itemprop="datePublished" content="2025-12-14T06:50:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="kknone"/> <meta itemprop="url" content="https://juejin.cn/user/1366025597879930"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueçš„Classç»‘å®šå¯¹è±¡è¯­æ³•å¦‚ä½•è®©åŠ¨æ€ç±»ååˆ‡æ¢å˜å¾—ç›´è§‚é«˜æ•ˆï¼Ÿ    
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1366025597879930/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    kknone
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:50:20.000Z" title="Sun Dec 14 2025 06:50:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¤§å®¶åœ¨å¼€å‘Vueé¡¹ç›®æ—¶ï¼Œè‚¯å®šé‡åˆ°è¿‡è¿™æ ·çš„åœºæ™¯ï¼šæŒ‰é’®ç‚¹å‡»åè¦åˆ‡æ¢â€œæ¿€æ´»çŠ¶æ€â€çš„æ ·å¼ï¼Œè¡¨å•éªŒè¯å¤±è´¥è¦æ˜¾ç¤ºâ€œé”™è¯¯æç¤ºâ€çš„çº¢è‰²æ–‡æœ¬ï¼Œæˆ–è€…
tabs åˆ‡æ¢æ—¶é«˜äº®å½“å‰æ ‡ç­¾ã€‚è¿™äº›<strong>åŠ¨æ€åˆ‡æ¢ç±»å</strong>çš„éœ€æ±‚ï¼ŒVue çš„ <code>Class ç»‘å®šå¯¹è±¡è¯­æ³•</code>
èƒ½å®Œç¾è§£å†³â€”â€”å®ƒå°±åƒä¸€ä¸ªâ€œæ ·å¼å¼€å…³â€ï¼Œè®©ç±»åè·Ÿç€æ•°æ®çŠ¶æ€è‡ªåŠ¨å˜åŒ–ï¼Œå½»åº•å‘Šåˆ«æ‰‹åŠ¨æ‹¼æ¥å­—ç¬¦ä¸²çš„éº»çƒ¦ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€å¯¹è±¡è¯­æ³•åŸºç¡€ï¼šé”®æ˜¯ç±»åï¼Œå€¼æ˜¯â€œå¼€å…³â€</h3>
<p>Vue ä¸º <code>class</code> å±æ€§æä¾›äº†ç‰¹æ®Šçš„ <code>v-bind</code>ï¼ˆç®€å†™ä¸º <code>:</code>ï¼‰å¢å¼ºï¼šå½“ä½ ç»‘å®šä¸€ä¸ª<strong>å¯¹è±¡</strong>æ—¶ï¼Œ<strong>å¯¹è±¡çš„é”®æ˜¯è¦æ·»åŠ çš„ç±»å</strong>ï¼Œ**å€¼æ˜¯å¸ƒå°”å€¼
**ï¼ˆæˆ–è¿”å›å¸ƒå°”å€¼çš„è¡¨è¾¾å¼ï¼‰ï¼Œç”¨æ¥å†³å®šè¿™ä¸ªç±»æ˜¯å¦â€œç”Ÿæ•ˆâ€ã€‚</p>
<h4 data-id="heading-1">æœ€åŸºç¡€çš„ä¾‹å­ï¼šæŒ‰é’®æ¿€æ´»çŠ¶æ€</h4>
<pre><code class="hljs language-vue" lang="vue">
&lt;template&gt;
  &lt;!-- å½“ isActive ä¸º true æ—¶ï¼Œæ·»åŠ  active ç±» --&gt;
  &lt;button :class="{ active: isActive }" @click="toggleActive"&gt;
    {{ isActive ? 'æ¿€æ´»' : 'æœªæ¿€æ´»' }}
  &lt;/button&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import {ref} from 'vue'
  // å“åº”å¼å˜é‡ï¼šæ§åˆ¶æŒ‰é’®æ˜¯å¦æ¿€æ´»
  const isActive = ref(false)
  // ç‚¹å‡»äº‹ä»¶ï¼šåˆ‡æ¢ isActive çŠ¶æ€
  const toggleActive = () =&gt; isActive.value = !isActive.value
&lt;/script&gt;

&lt;style&gt;
  .active {
    background-color: #42b983;
    color: white;
    border: none;
  }

  button {
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
  }
&lt;/style&gt;
</code></pre>
<p>è¿™æ®µä»£ç çš„é€»è¾‘å¾ˆç›´è§‚ï¼š</p>
<ul>
<li><code>isActive</code> æ˜¯ç”¨ <code>ref</code> å®šä¹‰çš„<strong>å“åº”å¼å˜é‡</strong>ï¼ˆåˆå§‹ä¸º <code>false</code>ï¼‰ï¼›</li>
<li>ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œ<code>toggleActive</code> å‡½æ•°ç¿»è½¬ <code>isActive</code> çš„å€¼ï¼›</li>
<li><code>:class="{ active: isActive }"</code> ä¼šæ ¹æ® <code>isActive</code> çš„å€¼è‡ªåŠ¨æ·»åŠ /ç§»é™¤ <code>active</code> ç±»ã€‚</li>
</ul>
<h4 data-id="heading-2">å°ç»†èŠ‚ï¼šç±»åå¸¦è¿å­—ç¬¦æ€ä¹ˆåŠï¼Ÿ</h4>
<p>å¦‚æœç±»ååƒ <code>text-danger</code> è¿™æ ·åŒ…å«è¿å­—ç¬¦ï¼ˆä¸ç¬¦åˆ JavaScript æ ‡è¯†ç¬¦è§„åˆ™ï¼‰ï¼Œ<strong>å¿…é¡»ç”¨å¼•å·æŠŠé”®åŒ…èµ·æ¥</strong>ï¼Œå¦åˆ™ä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">&lt;!-- æ­£ç¡®å†™æ³•ï¼š'text-danger' ä½œä¸ºå­—ç¬¦ä¸²é”® --&gt;
&lt;div :class="{ 'text-danger': hasError }"&gt;&lt;/div&gt;
</code></pre>
<h3 data-id="heading-3">äºŒã€é™æ€ç±»ä¸åŠ¨æ€ç±»çš„â€œå’Œå¹³å…±å¤„â€</h3>
<p>å®é™…å¼€å‘ä¸­ï¼Œå…ƒç´ å¾€å¾€æ—¢æœ‰<strong>å›ºå®šä¸å˜çš„é™æ€ç±»</strong>ï¼ˆæ¯”å¦‚å¸ƒå±€ç±» <code>container</code>ï¼‰ï¼Œåˆæœ‰<strong>åŠ¨æ€åˆ‡æ¢çš„ç±»</strong>ï¼ˆæ¯”å¦‚ <code>active</code>ï¼‰ã€‚Vue å…è®¸ä½ åŒæ—¶ä½¿ç”¨
<code>class</code> å±æ€§å’Œ <code>:class</code> ç»‘å®šï¼Œä¸¤è€…ä¼šè‡ªåŠ¨åˆå¹¶ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;template&gt;
  &lt;!-- é™æ€ç±» container + åŠ¨æ€ç±» active/text-danger --&gt;
  &lt;div class="container" :class="{ active: isActive, 'text-danger': hasError }"&gt;
    å†…å®¹åŒºåŸŸ
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import {ref} from 'vue'

  const isActive = ref(true)   // æ¿€æ´»çŠ¶æ€
  const hasError = ref(false) // é”™è¯¯çŠ¶æ€
&lt;/script&gt;

&lt;style&gt;
  .container {
    padding: 20px;
    border: 1px solid #eee;
  }

  .active {
    border-color: #42b983;
  }

  .text-danger {
    color: #e53935;
  }
&lt;/style&gt;
</code></pre>
<p>æ­¤æ—¶æ¸²æŸ“çš„ç»“æœæ˜¯ï¼š<code>&lt;div class="container active"&gt;å†…å®¹åŒºåŸŸ&lt;/div&gt;</code>ã€‚å¦‚æœ <code>hasError</code> å˜ä¸º <code>true</code>ï¼Œç»“æœä¼šå˜æˆ
<code>container active text-danger</code>â€”â€”å®Œå…¨ä¸ç”¨æ‰‹åŠ¨æ‹¼æ¥å­—ç¬¦ä¸²ï¼</p>
<h3 data-id="heading-4">ä¸‰ã€ä»â€œInline å¯¹è±¡â€åˆ°â€œå“åº”å¼å¯¹è±¡â€ï¼šè®©ä»£ç æ›´æ•´æ´</h3>
<p>å¦‚æœåŠ¨æ€ç±»å¾ˆå¤šï¼Œinline å¯¹è±¡ä¼šè®©æ¨¡æ¿å˜å¾—æ‹¥æŒ¤ã€‚è¿™æ—¶å¯ä»¥æŠŠç±»å¯¹è±¡æŠ½åˆ°<strong>å“åº”å¼å˜é‡</strong>æˆ–<strong>è®¡ç®—å±æ€§</strong>é‡Œï¼Œè®©ä»£ç æ›´å¯è¯»ã€‚</p>
<h4 data-id="heading-5">1. ç”¨ <code>reactive</code> å®šä¹‰ç±»å¯¹è±¡ï¼ˆComposition APIï¼‰</h4>
<p>å¦‚æœç±»çš„çŠ¶æ€æ¯”è¾ƒå›ºå®šï¼Œå¯ä»¥ç”¨ <code>reactive</code> å®šä¹‰ä¸€ä¸ªå“åº”å¼çš„ç±»å¯¹è±¡ï¼Œç›´æ¥ç»‘å®šåˆ° <code>:class</code>ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;template&gt;
  &lt;div :class="classObject"&gt;å“åº”å¼ç±»å¯¹è±¡ç¤ºä¾‹&lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import {reactive} from 'vue'
  // ç”¨ reactive å®šä¹‰å“åº”å¼çš„ç±»å¯¹è±¡
  const classObject = reactive({
    active: true,
    'text-danger': false,
    'font-large': true
  })
&lt;/script&gt;

&lt;style&gt;
  .font-large {
    font-size: 18px;
  }
&lt;/style&gt;
</code></pre>
<p>è¿™é‡Œ <code>classObject</code> æ˜¯å“åº”å¼çš„ï¼Œä¿®æ”¹å®ƒçš„å±æ€§ä¼šç›´æ¥æ›´æ–°ç±»åï¼šæ¯”å¦‚ <code>classObject['text-danger'] = true</code>ï¼Œä¼šç«‹å³æ·»åŠ 
<code>text-danger</code> ç±»ã€‚</p>
<h4 data-id="heading-6">2. è®¡ç®—å±æ€§ï¼šå¤„ç†å¤æ‚é€»è¾‘çš„â€œç¥å™¨â€</h4>
<p>å½“ç±»åçš„åˆ‡æ¢ä¾èµ–<strong>å¤šä¸ªçŠ¶æ€</strong>æ—¶ï¼Œè®¡ç®—å±æ€§ï¼ˆ<code>computed</code>ï¼‰æ˜¯æœ€ä½³é€‰æ‹©ã€‚æ¯”å¦‚ä¸€ä¸ªæäº¤æŒ‰é’®ï¼Œè¦æ ¹æ®â€œæ˜¯å¦åŠ è½½ä¸­â€å’Œâ€œæ˜¯å¦æœ‰é”™è¯¯â€æ¥åˆ‡æ¢æ ·å¼ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;template&gt;
  &lt;button :class="buttonClass" @click="handleSubmit" :disabled="isLoading"&gt;
    {{ buttonText }}
  &lt;/button&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import {ref, computed} from 'vue'

  // çŠ¶æ€å˜é‡
  const isLoading = ref(false)  // åŠ è½½ä¸­çŠ¶æ€
  const hasError = ref(false)   // é”™è¯¯çŠ¶æ€

  // è®¡ç®—æŒ‰é’®ç±»ï¼šæ ¹æ®çŠ¶æ€åŠ¨æ€ç”Ÿæˆ
  const buttonClass = computed(() =&gt; ({
    // åŠ è½½ä¸­æ—¶æ·»åŠ  loading ç±»
    loading: isLoading.value,
    // æœ‰é”™è¯¯æ—¶æ·»åŠ  error ç±»
    error: hasError.value,
    // æ­£å¸¸çŠ¶æ€æ·»åŠ  active ç±»
    active: !isLoading.value &amp;&amp; !hasError.value
  }))

  // è®¡ç®—æŒ‰é’®æ–‡å­—
  const buttonText = computed(() =&gt; {
    if (isLoading.value) return 'åŠ è½½ä¸­...'
    if (hasError.value) return 'æäº¤å¤±è´¥'
    return 'æäº¤è¡¨å•'
  })

  // æ¨¡æ‹Ÿæäº¤è¯·æ±‚
  const handleSubmit = async () =&gt; {
    isLoading.value = true
    hasError.value = false

    // æ¨¡æ‹Ÿå¼‚æ­¥è¯·æ±‚ï¼ˆæ¯”å¦‚è°ƒç”¨æ¥å£ï¼‰
    await new Promise(resolve =&gt; setTimeout(resolve, 1500))

    // æ¨¡æ‹Ÿéšæœºç»“æœï¼ˆ50% æˆåŠŸï¼Œ50% å¤±è´¥ï¼‰
    hasError.value = Math.random() &gt; 0.5
    isLoading.value = false
  }
&lt;/script&gt;

&lt;style&gt;
  button {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  .loading {
    background-color: #bbdefb;
    color: #2196f3;
  }

  .error {
    background-color: #ffcdd2;
    color: #e53935;
  }

  .active {
    background-color: #42b983;
    color: white;
  }
&lt;/style&gt;
</code></pre>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼š</p>
<ul>
<li><code>buttonClass</code> æ˜¯ä¸€ä¸ªè®¡ç®—å±æ€§ï¼Œ<strong>ä¾èµ– <code>isLoading</code> å’Œ <code>hasError</code></strong>ï¼›</li>
<li>å½“ <code>isLoading</code> å˜ä¸º <code>true</code>ï¼Œ<code>loading</code> ç±»è‡ªåŠ¨æ·»åŠ ï¼›</li>
<li>å½“ <code>hasError</code> å˜ä¸º <code>true</code>ï¼Œ<code>error</code> ç±»è‡ªåŠ¨æ·»åŠ ï¼›</li>
<li>æ‰€æœ‰çŠ¶æ€å˜åŒ–éƒ½ç”±è®¡ç®—å±æ€§â€œè‡ªåŠ¨å¤„ç†â€ï¼Œæ¨¡æ¿æ— éœ€å…³å¿ƒé€»è¾‘â€”â€”è¿™å°±æ˜¯è®¡ç®—å±æ€§çš„é­…åŠ›ï¼</li>
</ul>
<details>
<summary>å¾€æœŸæ–‡ç« å½’æ¡£</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc85e1fe16a7ae45e965b4e2df4d9d2f4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c85e1fe16a7ae45e965b4e2df4d9d2f4/" ref="nofollow noopener noreferrer">Vueæµ…å“åº”å¼å¦‚ä½•è§£å†³æ·±å±‚å“åº”å¼çš„æ€§èƒ½é—®é¢˜ï¼Ÿé€‚ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbe04b02d2723994632de0d4ca22a3391%2F" target="_blank" title="https://blog.cmdragon.cn/posts/be04b02d2723994632de0d4ca22a3391/" ref="nofollow noopener noreferrer">Vue 3ç»„åˆå¼APIä¸­refä¸reactiveçš„æ ¸å¿ƒå“åº”å¼å·®å¼‚åŠä½¿ç”¨æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa0af08dd60a37b9a890a9957f2cbfc9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a0af08dd60a37b9a890a9957f2cbfc9f/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿä¸­ï¼Œå¯¹è±¡æ–°å¢å±æ€§ã€æ•°ç»„æ”¹ç´¢å¼•ã€åŸå§‹å€¼ä»£ç†çš„é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbc287e1e36287afd90750fd907eca85e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bc287e1e36287afd90750fd907eca85e/" ref="nofollow noopener noreferrer">Vue 3ä¸­watchä¾¦å¬å™¨çš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿ä½ æŒæ¡äº†å—ï¼Ÿæ·±åº¦ç›‘å¬ã€ä¸watchEffectçš„å·®å¼‚åŠå¸¸è§æŠ¥é”™è§£æ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F654b9447ef1ba7ec1126a1bc26a4726d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/654b9447ef1ba7ec1126a1bc26a4726d/" ref="nofollow noopener noreferrer">Vueå“åº”å¼å£°æ˜çš„APIå·®å¼‚ã€åº•å±‚åŸç†ä¸å¸¸è§é™·é˜±ä½ éƒ½ææ‡‚äº†å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc405a8d9950af5b7c63b56c348ac36b6%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c405a8d9950af5b7c63b56c348ac36b6/" ref="nofollow noopener noreferrer">ä¸ºä»€ä¹ˆVue 3éœ€è¦refå‡½æ•°ï¼Ÿå®ƒçš„å“åº”å¼åŸç†ä¸æ­£ç¡®ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa7e9abb9691a81e4404d9facabe0f7c3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a7e9abb9691a81e4404d9facabe0f7c3/" ref="nofollow noopener noreferrer">Vue 3ä¸­reactiveå‡½æ•°å¦‚ä½•é€šè¿‡Proxyå®ç°å“åº”å¼ï¼Ÿä½¿ç”¨æ—¶è¦é¿å¼€å“ªäº›è¯¯åŒºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbd995ea45161727597fb85b62566c43d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bd995ea45161727597fb85b62566c43d/" ref="nofollow noopener noreferrer">Vue3å“åº”å¼ç³»ç»Ÿçš„åº•å±‚åŸç†ä¸å®è·µè¦ç‚¹ä½ çœŸçš„æ‡‚å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F53e3f270a80675df662c6857a3332c0f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/53e3f270a80675df662c6857a3332c0f/" ref="nofollow noopener noreferrer">Vue 3æ¨¡æ¿å¦‚ä½•é€šè¿‡ç¼–è¯‘ä¸‰é˜¶æ®µå®ç°ä»å£°æ˜å¼è¯­æ³•åˆ°é«˜æ•ˆæ¸²æŸ“çš„è·¨è¶Š - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fddbce4f2a23aa72c96b1c0473900321e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ddbce4f2a23aa72c96b1c0473900321e/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿å¼•ç”¨ï¼šä»æ”¶DOMâ€œå¿«é€’â€åˆ°è°ƒå­ç»„ä»¶æ–¹æ³•ï¼Œä½ ç©æ˜ç™½äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F23a2d5a334e15575277814c16e45df50%2F" target="_blank" title="https://blog.cmdragon.cn/posts/23a2d5a334e15575277814c16e45df50/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueæ¨¡æ¿é‡Œçš„JSè¡¨è¾¾å¼æœ‰å•¥ä¸èƒ½ç¢°ï¼Ÿè®¡ç®—å±æ€§ä¸ºå•¥æ¯”æ–¹æ³•æ›´èƒ½æ‰“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6be38de6382e31d282659b689c5b17f0%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6be38de6382e31d282659b689c5b17f0/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vueçš„v-modelè¡¨å•ç»‘å®šï¼šè¯­æ³•ç³–ã€åŠ¨æ€å€¼ã€ä¿®é¥°ç¬¦çš„å°æŠ€å·§ä½ éƒ½æŒæ¡äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F60ce517684f4a418f453d66aa805606c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/60ce517684f4a418f453d66aa805606c/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3äº‹ä»¶å¤„ç†çš„æŒ‘æˆ˜é¢˜ï¼šv-onã€ä¿®é¥°ç¬¦ã€è‡ªå®šä¹‰äº‹ä»¶ä½ èƒ½é€šå…³å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe4ae7d5e4a9205bb11b2baccb230c637%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e4ae7d5e4a9205bb11b2baccb230c637/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3çš„v-æŒ‡ä»¤ï¼šæ•°æ®å’ŒDOMçš„â€œç¿»è¯‘å®˜â€åˆ°åº•æœ‰å¤šå°‘æœ¬äº‹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F999ce4fb32259ff4fbf4bf7bcb851654%2F" target="_blank" title="https://blog.cmdragon.cn/posts/999ce4fb32259ff4fbf4bf7bcb851654/" ref="nofollow noopener noreferrer">å¿«é€Ÿå…¥é—¨Vue3ï¼Œæ’å€¼ã€åŠ¨æ€ç»‘å®šå’Œé¿å‘æŠ€å·§ä½ éƒ½ææ‡‚äº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fa6997d81b49cd232b87e1cf603888ad1%2F" target="_blank" title="https://blog.cmdragon.cn/posts/a6997d81b49cd232b87e1cf603888ad1/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLå¿«åˆ°é£èµ·ï¼Ÿå…ˆæ‰¾å¥åº·å¯†ç è¿˜æ˜¯å…ˆæ¢å¼•æ“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F1fee7afbb9abd4540b8aa9c141d6845d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/1fee7afbb9abd4540b8aa9c141d6845d/" ref="nofollow noopener noreferrer">æƒ³è®©PostgreSQLæŸ¥è¯¢å¿«åˆ°é£èµ·ï¼Ÿåˆ†åŒºè¡¨ã€ç‰©åŒ–è§†å›¾ã€å¹¶è¡ŒæŸ¥è¯¢è¿™ä¸‰æ‹›çµä¸çµï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F79c590fbd87ece535b11a71c9667884f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/79c590fbd87ece535b11a71c9667884f/" ref="nofollow noopener noreferrer">å­æŸ¥è¯¢æ€»æ‹–æ…¢æŸ¥è¯¢ï¼ŸæŠŠå®ƒå˜æˆè¿æ¥å°±èƒ½è§£å†³ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F748cdac2536008199abf8a8a2cd0ec85%2F" target="_blank" title="https://blog.cmdragon.cn/posts/748cdac2536008199abf8a8a2cd0ec85/" ref="nofollow noopener noreferrer">PostgreSQLå…¨è¡¨æ‰«ææ…¢åˆ°å´©æºƒï¼Ÿå»ºç´¢å¼•+æ”¹æŸ¥è¯¢+æ›´ç»Ÿè®¡ä¿¡æ¯ä¸‰æ‹›èƒ½ç ´ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F32ca943703226d317d4276a8fb53b0dd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/32ca943703226d317d4276a8fb53b0dd/" ref="nofollow noopener noreferrer">å¤æ‚æŸ¥è¯¢æ€»æ‹–åè…¿ï¼ŸPostgreSQLå¤šåˆ—ç´¢å¼•+è¦†ç›–ç´¢å¼•çš„ç¥ä»™æŠ€å·§ä½ getæ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fca93f1d53aa910e7ba5ffd8df611c12b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ca93f1d53aa910e7ba5ffd8df611c12b/" ref="nofollow noopener noreferrer">åªç»™è¡¨å­é›†å»ºç´¢å¼•ï¼Ÿç”¨å‡½æ•°ç»“æœå»ºç´¢å¼•ï¼ŸPostgreSQLè¿™ä¿©æ“ä½œå‡­å•¥èƒ½çœç©ºé—´åˆåŠ é€Ÿï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ff507856ebfddd592448813c510a53669%2F" target="_blank" title="https://blog.cmdragon.cn/posts/f507856ebfddd592448813c510a53669/" ref="nofollow noopener noreferrer">B-treeç´¢å¼•åƒå­—å…¸æŸ¥è¯ä¸€æ ·å·¥ä½œï¼Ÿé‚£å“ªäº›æ•°æ®åº“æŸ¥è¯¢å®ƒèƒ½åŠ é€Ÿï¼Œå“ªäº›ä¸èƒ½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb2213bfcb5b88a862f2138404c03d596%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b2213bfcb5b88a862f2138404c03d596/" ref="nofollow noopener noreferrer">æƒ³æŠ“PostgreSQLé‡Œçš„æ…¢SQLï¼Ÿpg_stat_statementsåŸºç¡€é»‘åŒ£å­å’Œpg_stat_monitoræ—¶é—´çª—ï¼Œè°èƒ½å¸®ä½ æ›´å‡†æªå‡ºæ€§èƒ½å°å·ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F26614eb7da6c476dde41d367ad888d2f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/26614eb7da6c476dde41d367ad888d2f/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œæ—¶å…‰æœºâ€MVCCå’Œé”æœºåˆ¶æ˜¯æ€ä¹ˆæå®šé«˜å¹¶å‘çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F69f99bc6972a860d559c74aad7280da4%2F" target="_blank" title="https://blog.cmdragon.cn/posts/69f99bc6972a860d559c74aad7280da4/" ref="nofollow noopener noreferrer">PostgreSQLæ€§èƒ½æš´æ¶¨çš„å…³é”®ï¼Ÿå†…å­˜IOå¹¶å‘å‚æ•°å±…ç„¶è¦è¿™ä¹ˆè®¾ç½®ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F7b7053f392147a8b3b1a16bebeb08d0a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/7b7053f392147a8b3b1a16bebeb08d0a/" ref="nofollow noopener noreferrer">å¤§è¡¨æŸ¥è¯¢æ…¢åˆ°ç¿»éæ•´ä¸ªä¹¦æ¶ï¼ŸPostgreSQLåˆ†åŒºè¡¨æ•™ä½ æ€ä¹ˆâ€œåˆ†ç±»â€æ‰é«˜æ•ˆ</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc856e3cb073822349f3bf2d29995dcfc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c856e3cb073822349f3bf2d29995dcfc/" ref="nofollow noopener noreferrer">PostgreSQL æŸ¥è¯¢æ…¢ï¼Ÿæ˜¯ä¸æ˜¯å¿˜äº†ä¼˜åŒ– GROUP BYã€ORDER BY å’Œçª—å£å‡½æ•°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fc096347d18e67b7431faacd2c4757093%2F" target="_blank" title="https://blog.cmdragon.cn/posts/c096347d18e67b7431faacd2c4757093/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„å­æŸ¥è¯¢å’ŒCTEå±…ç„¶åœ¨æ€§èƒ½ä¸Šâ€œææ¶â€ï¼Ÿåˆ°åº•è¯¥ç«™å“ªè¾¹ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F2eca89463454fd4250d7b66243b9fe5a%2F" target="_blank" title="https://blog.cmdragon.cn/posts/2eca89463454fd4250d7b66243b9fe5a/" ref="nofollow noopener noreferrer">PostgreSQLé€‰Joinç­–ç•¥æœ‰å•¥å°ä¹ä¹ï¼ŸNested Loop/Merge/Hashè°æ˜¯å®ƒçš„èœï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F068ecb772a87d7df20a8c9fb4b233f8e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/068ecb772a87d7df20a8c9fb4b233f8e/" ref="nofollow noopener noreferrer">PostgreSQLæ–°æ‰‹SQLæ€»ç¿»è½¦ï¼Ÿè¿™7ä¸ªæ€§èƒ½é™·é˜±ä½ è¸©è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd498f63cd0a2d5a77e445c688a8b88db%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d498f63cd0a2d5a77e445c688a8b88db/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•é€‰B-Treeè¿˜æ˜¯GiSTï¼Ÿâ€œç‘å£«å†›åˆ€â€å’Œâ€œå¤šé¢æ‰‹â€çš„å·®åˆ«ä½ å±…ç„¶è¿˜ä¸çŸ¥é“ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F9101b75bdec6faea9b35d54f14e37f36%2F" target="_blank" title="https://blog.cmdragon.cn/posts/9101b75bdec6faea9b35d54f14e37f36/" ref="nofollow noopener noreferrer">æƒ³çŸ¥é“æ•°æ®åº“æ€ä¹ˆç»™æŸ¥è¯¢â€œç®—æˆæœ¬é€‰è·¯çº¿â€ï¼ŸEXPLAINèƒ½å¸®ä½ çœ‹æ˜ç™½ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd527f8ebb6e3dae2c7dfe4c8d8979444%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d527f8ebb6e3dae2c7dfe4c8d8979444/" ref="nofollow noopener noreferrer">PostgreSQLå¤„ç†SQLå±…ç„¶åƒåšè›‹ç³•ï¼Ÿè§£æåˆ°æ‰§è¡Œçš„4æ­¥é‡Œè—ç€å¤šå°‘æŸ¥è¯¢ä¼˜åŒ–çš„å°å¿ƒæœºï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6bfdae84f313cf7ad0bb7045c4392347%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6bfdae84f313cf7ad0bb7045c4392347/" ref="nofollow noopener noreferrer">PostgreSQLå¤‡ä»½ä¸æ˜¯å¤åˆ¶æ–‡ä»¶ï¼Ÿç‰©ç†vsé€»è¾‘å’‹é€‰ï¼Ÿè¯¯åˆ è¿˜èƒ½ç²¾å‡†æ¢å¤åˆ°1åˆ†é’Ÿå‰ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fde3672803de34dbad244d0a8d48b0eb5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/de3672803de34dbad244d0a8d48b0eb5/" ref="nofollow noopener noreferrer">è½¬è´¦ä¸ç¿»è½¦ã€å¹¶å‘ä¸å¹²æ‰°ï¼ŒPostgreSQLçš„ACIDç‰¹æ€§åˆ°åº•æœ‰å•¥é­”æ³•ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fe463e8a2668abdf00a228c9b79324ded%2F" target="_blank" title="https://blog.cmdragon.cn/posts/e463e8a2668abdf00a228c9b79324ded/" ref="nofollow noopener noreferrer">é“¶è¡Œè½¬è´¦ä¸ç™½æ‰£é’±ã€ç”µå•†ä¸‹å•ä¸è¶…å–ï¼ŒPostgreSQLäº‹åŠ¡çš„è¯€çªæ˜¯å•¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F5c967e595058c4a1fc4474a68e64031d%2F" target="_blank" title="https://blog.cmdragon.cn/posts/5c967e595058c4a1fc4474a68e64031d/" ref="nofollow noopener noreferrer">PostgreSQLé‡Œçš„PL/pgSQLåˆ°åº•æ˜¯å•¥ï¼Ÿèƒ½è®©SQLä»â€œè¯´ç›®æ ‡â€å˜â€œè®²æ­¥éª¤â€ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F325047855e3e23b5ef82f7d2db134fbd%2F" target="_blank" title="https://blog.cmdragon.cn/posts/325047855e3e23b5ef82f7d2db134fbd/" ref="nofollow noopener noreferrer">PostgreSQLè§†å›¾ä¸å­˜æ•°æ®ï¼Ÿé‚£å®ƒæ€ä¹ˆç®€åŒ–æŸ¥è¯¢è¿˜èƒ½é€’å½’ç”Ÿæˆåºåˆ—å’Œæ§åˆ¶æƒé™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fd2dba50bb6e4df7b27e735245a06a2a2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/d2dba50bb6e4df7b27e735245a06a2a2/" ref="nofollow noopener noreferrer">PostgreSQLç´¢å¼•è¿™ä¹ˆç©ï¼Œæ‰èƒ½è®©ä½ çš„æŸ¥è¯¢çœŸçš„â€œé£â€èµ·æ¥ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F849ae5bab0f8c66e94c2f6ad1bb798e3%2F" target="_blank" title="https://blog.cmdragon.cn/posts/849ae5bab0f8c66e94c2f6ad1bb798e3/" ref="nofollow noopener noreferrer">PostgreSQLçš„è¡¨å…³ç³»å’Œçº¦æŸï¼Œå’‹å¸®ä½ æå®šç”¨æˆ·è®¢å•ä¸æ··ä¹±ã€å­¦ç”Ÿé€‰è¯¾ä¸é‡å¤ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fef4800975ffa84f1ca51976a70a1585b%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ef4800975ffa84f1ca51976a70a1585b/" ref="nofollow noopener noreferrer">PostgreSQLæŸ¥è¯¢çš„ç­›å­ã€æ’åºã€èšåˆã€åˆ†ç»„ï¼Ÿä½ ä¼šç”¨å®ƒä»¬æå®šæ•°æ®å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fbf54711525c507c5eacfa7b0151c39d2%2F" target="_blank" title="https://blog.cmdragon.cn/posts/bf54711525c507c5eacfa7b0151c39d2/" ref="nofollow noopener noreferrer">PostgreSQLæ•°æ®ç±»å‹æ€ä¹ˆé€‰æ‰é«˜æ•ˆä¸è¸©å‘ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F887809b3e0375f5956873cd442f516d8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/887809b3e0375f5956873cd442f516d8/" ref="nofollow noopener noreferrer">æƒ³è§£é”PostgreSQLæŸ¥è¯¢ä»åŸºç¡€åˆ°è¿›é˜¶çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Ÿä½ éƒ½getäº†å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F934be1203725e8be9d6f6e9104e5abcc%2F" target="_blank" title="https://blog.cmdragon.cn/posts/934be1203725e8be9d6f6e9104e5abcc/" ref="nofollow noopener noreferrer">PostgreSQL DELETEå±…ç„¶æœ‰è¿™äº›æ“ä½œï¼Ÿè¿”å›æ•°æ®ã€è¿è¡¨åˆ ä½ è¯•è¿‡æ²¡ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0f0622e9b7402b599e618150d0596ffe%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0f0622e9b7402b599e618150d0596ffe/" ref="nofollow noopener noreferrer">PostgreSQL UPDATEè¯­å¥æ€ä¹ˆç©ï¼Ÿä»æ”¹é‚®ç®±åˆ°æ‰¹é‡æ›´æ–°çš„é¿å‘æŠ€å·§ä½ éƒ½ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F0e3bf7efc030b024ea67ee855a00f2de%2F" target="_blank" title="https://blog.cmdragon.cn/posts/0e3bf7efc030b024ea67ee855a00f2de/" ref="nofollow noopener noreferrer">PostgreSQLæ’å…¥æ•°æ®è¿˜åœ¨é€æ¡æ•²ï¼Ÿæ‰¹é‡ã€å†²çªå¤„ç†ã€è¿”å›è‡ªå¢IDçš„æŠ€å·§ä½ ä¼šå—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb6cd3c86da6aac26ed829e472d34078e%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b6cd3c86da6aac26ed829e472d34078e/" ref="nofollow noopener noreferrer">PostgreSQLçš„â€œä»“åº“-æˆ¿é—´-è´§æ¶â€æ¸¸æˆï¼Œä½ èƒ½å»ºå‡ºç”µå•†æ•°æ®åº“å’Œè¡¨å—ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fba1f545a3410144552fbdbfcf31b5265%2F" target="_blank" title="https://blog.cmdragon.cn/posts/ba1f545a3410144552fbdbfcf31b5265/" ref="nofollow noopener noreferrer">PostgreSQL 17å®‰è£…æ€»ç¿»è½¦ï¼ŸWindows/macOS/Linuxé¿å‘æŒ‡å—å¸®ä½ æå®šï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fb5474d1480509c5072085abc80b3dd9f%2F" target="_blank" title="https://blog.cmdragon.cn/posts/b5474d1480509c5072085abc80b3dd9f/" ref="nofollow noopener noreferrer">èƒ½å½“å…³ç³»å‹æ•°æ®åº“è¿˜èƒ½ç©å¯¹è±¡ç‰¹æ€§ï¼Œèƒ½æ‹†å¤æ‚æŸ¥è¯¢è¿˜èƒ½è‡ªåŠ¨ç®¡åº“å­˜ï¼ŒPostgreSQLå‡­ä»€ä¹ˆè¿™ä¹ˆé¦™ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Fcc098d8836e787baa8a4d92e4d56d5c5%2F" target="_blank" title="https://blog.cmdragon.cn/posts/cc098d8836e787baa8a4d92e4d56d5c5/" ref="nofollow noopener noreferrer">ç»™æ¥å£åŠ æ–°å­—æ®µåˆä¸æå´©è€å®¢æˆ·ç«¯ï¼ŸFastAPIçš„å¤šç‰ˆæœ¬APIé å“ªä¸‰æ‹›å®ç°ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F46d05151c5bd31cf37a7bcf0b8f5b0b8%2F" target="_blank" title="https://blog.cmdragon.cn/posts/46d05151c5bd31cf37a7bcf0b8f5b0b8/" ref="nofollow noopener noreferrer">æµé‡çªå¢è¦æå´©FastAPIï¼Ÿç†”æ–­æµ‹è¯•æ˜¯æ€ä¹ˆé˜²ç³»ç»Ÿé›ªå´©çš„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F65ce343cc5df9faf3a8e2eeaab42ae45%2F" target="_blank" title="https://blog.cmdragon.cn/posts/65ce343cc5df9faf3a8e2eeaab42ae45/" ref="nofollow noopener noreferrer">FastAPIç§’æ€åº“å­˜æ€»å˜è´Ÿæ•°ï¼ŸRedisåˆ†å¸ƒå¼é”èƒ½å¸®ä½ å®ˆä½åº•çº¿å— - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Feed6cd8985d9be0a4b092a7da38b3e0c%2F" target="_blank" title="https://blog.cmdragon.cn/posts/eed6cd8985d9be0a4b092a7da38b3e0c/" ref="nofollow noopener noreferrer">FastAPIçš„CIæµæ°´çº¿æ€ä¹ˆè‡ªåŠ¨æµ‹ç«¯ç‚¹ï¼Œè¿˜èƒ½è®©AllureæŠ¥å‘Šç¾åˆ°çŠ¯è§„ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2F6157d87338ce894d18c013c3c4777abb%2F" target="_blank" title="https://blog.cmdragon.cn/posts/6157d87338ce894d18c013c3c4777abb/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨GitHub Actionsä¸ºFastAPIé¡¹ç›®æ‰“é€ è‡ªåŠ¨åŒ–æµ‹è¯•æµæ°´çº¿ï¼Ÿ - cmdragon's Blog</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.cmdragon.cn%2Fposts%2Ffc4ef84559e04693a620d0714cb30787%2F" target="_blank" title="https://blog.cmdragon.cn/posts/fc4ef84559e04693a620d0714cb30787/" ref="nofollow noopener noreferrer">å¦‚ä½•ç”¨Git Hookå’ŒCIæµæ°´çº¿ä¸ºFastAPIé¡¹ç›®ä¿é©¾æŠ¤èˆªï¼Ÿ - cmdragon's Blog</a></li>
</ul>
</details>
<details>
<summary>å…è´¹å¥½ç”¨çš„çƒ­é—¨åœ¨çº¿å·¥å…·</summary>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fraid-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/raid-calculator" ref="nofollow noopener noreferrer">RAID è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fphotoshop-online" target="_blank" title="https://tools.cmdragon.cn/zh/apps/photoshop-online" ref="nofollow noopener noreferrer">åœ¨çº¿PS - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmermaid-live-editor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/mermaid-live-editor" ref="nofollow noopener noreferrer">Mermaid åœ¨çº¿ç¼–è¾‘å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmath-solver-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/math-solver-calculator" ref="nofollow noopener noreferrer">æ•°å­¦æ±‚è§£è®¡ç®—å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsmart-teleprompter" target="_blank" title="https://tools.cmdragon.cn/zh/apps/smart-teleprompter" ref="nofollow noopener noreferrer">æ™ºèƒ½æè¯å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fmagic-resume" target="_blank" title="https://tools.cmdragon.cn/zh/apps/magic-resume" ref="nofollow noopener noreferrer">é­”æ³•ç®€å† - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-puzzle-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-puzzle-tool" ref="nofollow noopener noreferrer">Image Puzzle Tool - å›¾ç‰‡æ‹¼å›¾å·¥å…· | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsubtitle-downloader" target="_blank" title="https://tools.cmdragon.cn/zh/apps/subtitle-downloader" ref="nofollow noopener noreferrer">å­—å¹•ä¸‹è½½å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flyrics-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lyrics-generator" ref="nofollow noopener noreferrer">æ­Œè¯ç”Ÿæˆå·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcloud-drive-search" target="_blank" title="https://tools.cmdragon.cn/zh/apps/cloud-drive-search" ref="nofollow noopener noreferrer">ç½‘ç›˜èµ„æºèšåˆæœç´¢ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fascii-art-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ascii-art-generator" ref="nofollow noopener noreferrer">ASCIIå­—ç¬¦ç”»ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fjwt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/jwt-tool" ref="nofollow noopener noreferrer">JSON Web Tokens å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbcrypt-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/bcrypt-tool" ref="nofollow noopener noreferrer">Bcrypt å¯†ç å·¥å…· - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-composer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-composer" ref="nofollow noopener noreferrer">GIF åˆæˆå™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fgif-decomposer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/gif-decomposer" ref="nofollow noopener noreferrer">GIF åˆ†è§£å™¨ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-steganography" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-steganography" ref="nofollow noopener noreferrer">æ–‡æœ¬éšå†™æœ¯ - åº”ç”¨å•†åº— | By cmdragon</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh" target="_blank" title="https://tools.cmdragon.cn/zh" ref="nofollow noopener noreferrer">CMDragon åœ¨çº¿å·¥å…· - é«˜çº§AIå·¥å…·ç®±ä¸å¼€å‘è€…å¥—ä»¶ | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%3Fcategory%3Dtrending" target="_blank" title="https://tools.cmdragon.cn/zh/apps?category=trending" ref="nofollow noopener noreferrer">åº”ç”¨å•†åº— - å‘ç°1000+æå‡æ•ˆç‡ä¸å¼€å‘çš„AIå·¥å…·å’Œå®ç”¨ç¨‹åº | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fchangelog" target="_blank" title="https://tools.cmdragon.cn/zh/changelog" ref="nofollow noopener noreferrer">CMDragon æ›´æ–°æ—¥å¿— - æœ€æ–°æ›´æ–°ã€åŠŸèƒ½ä¸æ”¹è¿› | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fsponsor" target="_blank" title="https://tools.cmdragon.cn/zh/sponsor" ref="nofollow noopener noreferrer">æ”¯æŒæˆ‘ä»¬ - æˆä¸ºèµåŠ©è€… | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-image-ai" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-image-ai" ref="nofollow noopener noreferrer">AIæ–‡æœ¬ç”Ÿæˆå›¾åƒ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftemp-email" target="_blank" title="https://tools.cmdragon.cn/zh/apps/temp-email" ref="nofollow noopener noreferrer">ä¸´æ—¶é‚®ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fqrcode-parser" target="_blank" title="https://tools.cmdragon.cn/zh/apps/qrcode-parser" ref="nofollow noopener noreferrer">äºŒç»´ç è§£æå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-to-mindmap" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-to-mindmap" ref="nofollow noopener noreferrer">æ–‡æœ¬è½¬æ€ç»´å¯¼å›¾ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fregex-visualizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/regex-visualizer" ref="nofollow noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼å¯è§†åŒ–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsteganography-tool" target="_blank" title="https://tools.cmdragon.cn/zh/apps/steganography-tool" ref="nofollow noopener noreferrer">æ–‡ä»¶éšå†™å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fiptv-explorer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/iptv-explorer" ref="nofollow noopener noreferrer">IPTV é¢‘é“æ¢ç´¢å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsnapdrop" target="_blank" title="https://tools.cmdragon.cn/zh/apps/snapdrop" ref="nofollow noopener noreferrer">å¿«ä¼  - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Flucky-draw" target="_blank" title="https://tools.cmdragon.cn/zh/apps/lucky-draw" ref="nofollow noopener noreferrer">éšæœºæŠ½å¥–å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fanime-scene-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/anime-scene-finder" ref="nofollow noopener noreferrer">åŠ¨æ¼«åœºæ™¯æŸ¥æ‰¾å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftime-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/time-toolkit" ref="nofollow noopener noreferrer">æ—¶é—´å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fspeed-test" target="_blank" title="https://tools.cmdragon.cn/zh/apps/speed-test" ref="nofollow noopener noreferrer">ç½‘é€Ÿæµ‹è¯• - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-remover" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-remover" ref="nofollow noopener noreferrer">AI æ™ºèƒ½æŠ å›¾å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fbackground-replacer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/background-replacer" ref="nofollow noopener noreferrer">èƒŒæ™¯æ›¿æ¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fartistic-qrcode" target="_blank" title="https://tools.cmdragon.cn/zh/apps/artistic-qrcode" ref="nofollow noopener noreferrer">è‰ºæœ¯äºŒç»´ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fopen-graph-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/open-graph-generator" ref="nofollow noopener noreferrer">Open Graph å…ƒæ ‡ç­¾ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-comparison" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-comparison" ref="nofollow noopener noreferrer">å›¾åƒå¯¹æ¯”å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-compressor" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-compressor" ref="nofollow noopener noreferrer">å›¾ç‰‡å‹ç¼©ä¸“ä¸šç‰ˆ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fpassword-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/password-generator" ref="nofollow noopener noreferrer">å¯†ç ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fsvg-optimizer" target="_blank" title="https://tools.cmdragon.cn/zh/apps/svg-optimizer" ref="nofollow noopener noreferrer">SVGä¼˜åŒ–å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcolor-palette" target="_blank" title="https://tools.cmdragon.cn/zh/apps/color-palette" ref="nofollow noopener noreferrer">è°ƒè‰²æ¿ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fonline-metronome" target="_blank" title="https://tools.cmdragon.cn/zh/apps/online-metronome" ref="nofollow noopener noreferrer">åœ¨çº¿èŠ‚æ‹å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcss-grid-layout" target="_blank" title="https://tools.cmdragon.cn/zh/apps/css-grid-layout" ref="nofollow noopener noreferrer">CSSç½‘æ ¼å¸ƒå±€ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Femail-validator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/email-validator" ref="nofollow noopener noreferrer">é‚®ç®±éªŒè¯å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fcalligraphy-practice" target="_blank" title="https://tools.cmdragon.cn/zh/apps/calligraphy-practice" ref="nofollow noopener noreferrer">ä¹¦æ³•ç»ƒä¹ å­—å¸– - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffinance-calculator-suite" target="_blank" title="https://tools.cmdragon.cn/zh/apps/finance-calculator-suite" ref="nofollow noopener noreferrer">é‡‘èè®¡ç®—å™¨å¥—ä»¶ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fchinese-kinship-calculator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/chinese-kinship-calculator" ref="nofollow noopener noreferrer">ä¸­å›½äº²æˆšå…³ç³»è®¡ç®—å™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fprotobuf-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/protobuf-toolkit" ref="nofollow noopener noreferrer">Protocol Buffer å·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-geolocation" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-geolocation" ref="nofollow noopener noreferrer">IPå½’å±åœ°æŸ¥è¯¢ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fimage-upscaler" target="_blank" title="https://tools.cmdragon.cn/zh/apps/image-upscaler" ref="nofollow noopener noreferrer">å›¾ç‰‡æ— æŸæ”¾å¤§ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ftext-compare" target="_blank" title="https://tools.cmdragon.cn/zh/apps/text-compare" ref="nofollow noopener noreferrer">æ–‡æœ¬æ¯”è¾ƒå·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fip-batch-lookup" target="_blank" title="https://tools.cmdragon.cn/zh/apps/ip-batch-lookup" ref="nofollow noopener noreferrer">IPæ‰¹é‡æŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdomain-finder" target="_blank" title="https://tools.cmdragon.cn/zh/apps/domain-finder" ref="nofollow noopener noreferrer">åŸŸåæŸ¥è¯¢å·¥å…· - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Fdns-toolkit" target="_blank" title="https://tools.cmdragon.cn/zh/apps/dns-toolkit" ref="nofollow noopener noreferrer">DNSå·¥å…·ç®± - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fzh%2Fapps%2Ffavicon-generator" target="_blank" title="https://tools.cmdragon.cn/zh/apps/favicon-generator" ref="nofollow noopener noreferrer">ç½‘ç«™å›¾æ ‡ç”Ÿæˆå™¨ - åº”ç”¨å•†åº— | å…è´¹å¥½ç”¨çš„åœ¨çº¿å·¥å…·</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.cmdragon.cn%2Fsitemap_index.xml" target="_blank" title="https://tools.cmdragon.cn/sitemap_index.xml" ref="nofollow noopener noreferrer">XML Sitemap</a></li>
</ul>
</details>
<h3 data-id="heading-7">å››ã€å“åº”å¼çš„â€œé­”æ³•â€ï¼šæ•°æ®å˜ï¼Œç±»åè‡ªåŠ¨å˜</h3>
<p>ä¸ºä»€ä¹ˆæ•°æ®å˜åŒ–æ—¶ç±»åä¼šè‡ªåŠ¨æ›´æ–°ï¼Ÿå› ä¸º Vue çš„<strong>å“åº”å¼ç³»ç»Ÿ</strong>åœ¨èƒŒåå·¥ä½œï¼š</p>
<ol>
<li><strong>è·Ÿè¸ªä¾èµ–</strong>ï¼šå½“ä½ ç”¨ <code>ref</code> æˆ– <code>reactive</code> å®šä¹‰å˜é‡æ—¶ï¼ŒVue ä¼šè·Ÿè¸ªå®ƒçš„ä¾èµ–ï¼ˆæ¯”å¦‚ <code>isActive</code> è¢« <code>:class</code> ç”¨åˆ°ï¼‰ï¼›</li>
<li><strong>è§¦å‘æ›´æ–°</strong>ï¼šå½“å˜é‡å˜åŒ–æ—¶ï¼ŒVue ä¼šé‡æ–°è®¡ç®—ä¾èµ–å®ƒçš„è¡¨è¾¾å¼ï¼ˆæ¯”å¦‚ <code>{ active: isActive }</code>ï¼‰ï¼›</li>
<li><strong>æ›´æ–° DOM</strong>ï¼šæœ€åè‡ªåŠ¨æ›´æ–° DOM ä¸Šçš„ç±»åâ€”â€”å…¨ç¨‹ä¸éœ€è¦ä½ æ‰‹åŠ¨æ“ä½œï¼</li>
</ol>
<p>æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œè¾“å…¥æ¡†å†…å®¹é•¿åº¦è¶…è¿‡5æ—¶ï¼Œæ·»åŠ  <code>valid</code> ç±»ï¼Œå¦åˆ™æ·»åŠ  <code>invalid</code> ç±»ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;template&gt;
  &lt;input
      type="text"
      v-model="inputValue"
      :class="{ valid: inputValue.length &gt; 5, invalid: inputValue.length &lt;= 5 }"
      placeholder="è¾“å…¥è‡³å°‘6ä¸ªå­—ç¬¦"
  &gt;
&lt;/template&gt;

&lt;script setup&gt;
  import {ref} from 'vue'

  const inputValue = ref('') // è¾“å…¥æ¡†å†…å®¹ï¼ˆå“åº”å¼ï¼‰
&lt;/script&gt;

&lt;style&gt;
  input {
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  .valid {
    border-color: #42b983;
  }

  .invalid {
    border-color: #e53935;
  }
&lt;/style&gt;
</code></pre>
<p>å½“è¾“å…¥å†…å®¹é•¿åº¦è¶…è¿‡5æ—¶ï¼Œ<code>valid</code> ç±»è‡ªåŠ¨æ·»åŠ ï¼›å¦åˆ™æ·»åŠ  <code>invalid</code> ç±»â€”â€”å®Œå…¨ç”± <code>inputValue</code> çš„å˜åŒ–é©±åŠ¨ï¼</p>
<h3 data-id="heading-8">äº”ã€å®é™…æ¡ˆä¾‹ï¼šTabs ç»„ä»¶çš„é«˜äº®åˆ‡æ¢</h3>
<p>æˆ‘ä»¬ç”¨å¯¹è±¡è¯­æ³•å®ç°ä¸€ä¸ªå¸¸è§çš„ Tabs ç»„ä»¶ï¼Œç‚¹å‡» tab æ—¶é«˜äº®å½“å‰æ ‡ç­¾ï¼š</p>
<pre><code class="hljs language-vue" lang="vue">
&lt;template&gt;
  &lt;div class="tabs"&gt;
    &lt;button
        v-for="(tab, index) in tabs"
        :key="index"
        :class="{ active: currentTab === index }"
        @click="currentTab = index"
    &gt;
      {{ tab.title }}
    &lt;/button&gt;
    &lt;div class="tab-content"&gt;
      {{ tabs[currentTab].content }}
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
  import {ref} from 'vue'

  // Tabs æ•°æ®
  const tabs = ref([
    {title: 'é¦–é¡µ', content: 'é¦–é¡µå†…å®¹...'},
    {title: 'æ–‡ç« ', content: 'æ–‡ç« å†…å®¹...'},
    {title: 'å…³äº', content: 'å…³äºæˆ‘ä»¬...'}
  ])
  // å½“å‰æ¿€æ´»çš„ tab ç´¢å¼•
  const currentTab = ref(0)
&lt;/script&gt;

&lt;style&gt;
  .tabs {
    border-bottom: 1px solid #eee;
    margin-bottom: 16px;
  }

  .tabs button {
    padding: 8px 16px;
    border: none;
    background: none;
    cursor: pointer;
  }

  .tabs button.active {
    border-bottom: 2px solid #42b983;
    color: #42b983;
  }

  .tab-content {
    padding: 16px;
  }
&lt;/style&gt;
</code></pre>
<p>è¿™æ®µä»£ç çš„æ ¸å¿ƒé€»è¾‘ï¼š</p>
<ul>
<li><code>v-for</code> å¾ªç¯æ¸²æŸ“ tabs æŒ‰é’®ï¼›</li>
<li><code>:class="{ active: currentTab === index }"</code>ï¼šå½“å½“å‰ tab ç´¢å¼•ç­‰äºæŒ‰é’®ç´¢å¼•æ—¶ï¼Œæ·»åŠ  <code>active</code> ç±»ï¼›</li>
<li>ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæ›´æ–° <code>currentTab</code> çš„å€¼â€”â€”é«˜äº®æ•ˆæœè‡ªåŠ¨åˆ‡æ¢ï¼</li>
</ul>
<h3 data-id="heading-9">å…­ã€å¸¸è§æŠ¥é”™ä¸è§£å†³</h3>
<h4 data-id="heading-10">æŠ¥é”™1ï¼šç±»åä¸ç”Ÿæ•ˆï¼Œæ§åˆ¶å°æ— é”™è¯¯</h4>
<p><strong>åŸå› </strong>ï¼šå“åº”å¼å˜é‡æ²¡æœ‰æ­£ç¡®å®šä¹‰ï¼ˆæ¯”å¦‚ç”¨ <code>let</code> è€Œä¸æ˜¯ <code>ref</code>/<code>reactive</code>ï¼‰ï¼Œå¯¼è‡´æ•°æ®å˜åŒ–æ—¶æ— æ³•è§¦å‘é‡æ–°æ¸²æŸ“ã€‚<br/>
<strong>è§£å†³</strong>ï¼šç”¨ <code>ref</code> æˆ– <code>reactive</code> å®šä¹‰çŠ¶æ€å˜é‡ï¼Œæ¯”å¦‚ <code>const isActive = ref(false)</code> è€Œä¸æ˜¯ <code>let isActive = false</code>ã€‚</p>
<h4 data-id="heading-11">æŠ¥é”™2ï¼šâ€œUncaught SyntaxError: Unexpected token '-'â€</h4>
<p><strong>åŸå› </strong>ï¼šå¸¦è¿å­—ç¬¦çš„ç±»åæ²¡æœ‰ç”¨å¼•å·åŒ…è£¹ï¼Œæ¯”å¦‚ <code>{ text-danger: hasError }</code>ï¼ŒJavaScript ä¼šè§£ææˆ <code>text - danger</code>ï¼ˆå˜é‡ <code>text</code>
å‡å˜é‡ <code>danger</code>ï¼‰ã€‚<br/>
<strong>è§£å†³</strong>ï¼šæŠŠç±»åç”¨å¼•å·åŒ…è£¹ï¼š<code>{ 'text-danger': hasError }</code>ã€‚</p>
<h4 data-id="heading-12">æŠ¥é”™3ï¼šè®¡ç®—å±æ€§è¿”å›çš„ç±»å¯¹è±¡ä¸æ›´æ–°</h4>
<p><strong>åŸå› </strong>ï¼šè®¡ç®—å±æ€§æ²¡æœ‰æ­£ç¡®ä¾èµ–å“åº”å¼å˜é‡ï¼Œæ¯”å¦‚åœ¨è®¡ç®—å±æ€§ä¸­ä½¿ç”¨äº†éå“åº”å¼çš„æ•°æ®ã€‚<br/>
<strong>è§£å†³</strong>ï¼šç¡®ä¿è®¡ç®—å±æ€§å†…éƒ¨ç”¨åˆ°çš„æ‰€æœ‰å˜é‡éƒ½æ˜¯å“åº”å¼çš„ï¼ˆç”¨ <code>ref</code>/<code>reactive</code> å®šä¹‰ï¼‰ï¼Œæ¯”å¦‚
<code>computed(() =&gt; ({ active: isActive.value }))</code> ä¸­çš„ <code>isActive</code> æ˜¯ <code>ref</code>ã€‚</p>
<h3 data-id="heading-13">å‚è€ƒé“¾æ¥</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fvuejs.org%2Fguide%2Fessentials%2Fclass-and-style.html%23object-syntax" target="_blank" title="https://vuejs.org/guide/essentials/class-and-style.html#object-syntax" ref="nofollow noopener noreferrer">vuejs.org/guide/essenâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Jenkinså®ç°iOSè‡ªåŠ¨åŒ–æ‰“åŒ…]]></title>    <link>https://juejin.cn/post/7583324039302185011</link>    <guid>https://juejin.cn/post/7583324039302185011</guid>    <pubDate>2025-12-14T06:40:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7583324039302185011" data-draft-id="7583293030172786734" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Jenkinså®ç°iOSè‡ªåŠ¨åŒ–æ‰“åŒ…"/> <meta itemprop="keywords" content="iOS"/> <meta itemprop="datePublished" content="2025-12-14T06:40:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å“å°”å±±ä¸Šåˆ·åŠ›æ‰£"/> <meta itemprop="url" content="https://juejin.cn/user/263471893337357"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Jenkinså®ç°iOSè‡ªåŠ¨åŒ–æ‰“åŒ…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/263471893337357/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å“å°”å±±ä¸Šåˆ·åŠ›æ‰£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2025-12-14T06:40:37.000Z" title="Sun Dec 14 2025 06:40:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2025-12-14
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€å‰è¨€ï¼šä¸ºä»€ä¹ˆéœ€è¦è‡ªåŠ¨åŒ–æ‰“åŒ…ï¼Ÿ</h2>
<p>åœ¨iOSé¡¹ç›®å¼€å‘ä¸­ï¼Œéšç€é¡¹ç›®è§„æ¨¡å¢å¤§ã€ç‰ˆæœ¬è¿­ä»£é¢‘ç¹ï¼Œæ‰‹åŠ¨æ‰“åŒ…ä¼šé¢ä¸´ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li><strong>æ•ˆç‡ä½ä¸‹</strong>ï¼šæ¯æ¬¡æ‰“åŒ…éœ€è¦ç­‰å¾…15-30åˆ†é’Ÿï¼Œå ç”¨å¼€å‘æ—¶é—´</li>
<li><strong>ç¯å¢ƒä¸ä¸€è‡´</strong>ï¼šä¸åŒå¼€å‘è€…æ‰“åŒ…ç¯å¢ƒé…ç½®å·®å¼‚å¯¼è‡´åŒ…ä½“ä¸ä¸€è‡´</li>
<li><strong>æµç¨‹å¤æ‚</strong>ï¼šè¯ä¹¦ç®¡ç†ã€æè¿°æ–‡ä»¶æ›´æ–°ã€å¤šç¯å¢ƒé…ç½®ç­‰æ“ä½œç¹ç</li>
<li><strong>èµ„æºæµªè´¹</strong>ï¼šå¼€å‘è€…æœºå™¨æŒç»­é«˜è´Ÿè½½è¿è¡Œå½±å“å…¶ä»–å·¥ä½œ</li>
</ol>
<h2 data-id="heading-1">äºŒã€ç¯å¢ƒå‡†å¤‡ä¸Jenkinså®‰è£…</h2>
<h3 data-id="heading-2">2.1 ç³»ç»Ÿç¯å¢ƒè¦æ±‚</h3>






























<table><thead><tr><th>ç»„ä»¶</th><th>ç‰ˆæœ¬è¦æ±‚</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>macOS</td><td>10.15+</td><td>å»ºè®®ä½¿ç”¨è¾ƒæ–°ç‰ˆæœ¬</td></tr><tr><td>Java</td><td>JDK 8+</td><td>Jenkinsè¿è¡Œä¾èµ–</td></tr><tr><td>Xcode</td><td>æœ€æ–°ç¨³å®šç‰ˆ</td><td>éœ€åŒ…å«å‘½ä»¤è¡Œå·¥å…·</td></tr><tr><td>Homebrew</td><td>æœ€æ–°ç‰ˆ</td><td>å¯é€‰ï¼Œç”¨äºå®‰è£…ç®¡ç†</td></tr></tbody></table>
<h3 data-id="heading-3">2.2 Jenkinså®‰è£…ï¼ˆä¸¤ç§æ–¹å¼ï¼‰</h3>
<p><strong>æ–¹å¼ä¸€ï¼šä½¿ç”¨Homebrewå®‰è£…ï¼ˆæ¨èï¼‰</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…Homebrewï¼ˆå¦‚æœªå®‰è£…ï¼‰</span>
/bin/bash -c <span class="hljs-string">"<span class="hljs-subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>"</span>

<span class="hljs-comment"># å®‰è£…Jenkins LTSç‰ˆæœ¬</span>
brew install jenkins-lts

<span class="hljs-comment"># å¯åŠ¨JenkinsæœåŠ¡</span>
brew services start jenkins-lts

<span class="hljs-comment"># æŸ¥çœ‹æœåŠ¡çŠ¶æ€</span>
brew services list | grep jenkins
</code></pre>
<p><strong>æ–¹å¼äºŒï¼šä½¿ç”¨å®‰è£…åŒ…å®‰è£…</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½å®˜æ–¹å®‰è£…åŒ…</span>
<span class="hljs-comment"># è®¿é—®ï¼šhttps://jenkins.io/download/</span>

<span class="hljs-comment"># æˆ–ä½¿ç”¨å‘½ä»¤è¡Œä¸‹è½½</span>
curl -L -o jenkins.pkg https://get.jenkins.io/osx/latest

<span class="hljs-comment"># å®‰è£…</span>
sudo installer -pkg jenkins.pkg -target /
</code></pre>
<h3 data-id="heading-4">2.3 åˆå§‹é…ç½®</h3>
<ol>
<li><strong>è®¿é—®Jenkins</strong>ï¼šæµè§ˆå™¨æ‰“å¼€ <code>http://localhost:8080</code></li>
<li><strong>è·å–åˆå§‹å¯†ç </strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯†ç å­˜å‚¨ä½ç½®</span>
sudo <span class="hljs-built_in">cat</span> /Users/Shared/Jenkins/Home/secrets/initialAdminPassword
<span class="hljs-comment"># æˆ–</span>
sudo <span class="hljs-built_in">cat</span> /var/lib/jenkins/secrets/initialAdminPassword
</code></pre>
<ol start="3">
<li><strong>å®‰è£…æ¨èæ’ä»¶</strong>ï¼šé€‰æ‹©"Install suggested plugins"</li>
<li><strong>åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·</strong>ï¼šè®¾ç½®ç”¨æˆ·åã€å¯†ç ã€é‚®ç®±ç­‰ä¿¡æ¯</li>
</ol>
<h2 data-id="heading-5">ä¸‰ã€iOSä¸“ç”¨æ’ä»¶é…ç½®</h2>
<h3 data-id="heading-6">3.1 å¿…è¦æ’ä»¶å®‰è£…</h3>
<p>åœ¨Jenkinsçš„"ç³»ç»Ÿç®¡ç†" â†’ "æ’ä»¶ç®¡ç†"ä¸­å®‰è£…ä»¥ä¸‹æ’ä»¶ï¼š</p>






























<table><thead><tr><th>æ’ä»¶åç§°</th><th>ä½œç”¨</th><th>å¿…éœ€æ€§</th></tr></thead><tbody><tr><td>Keychains and Provisioning Profiles Management</td><td>ç®¡ç†iOSè¯ä¹¦å’Œæè¿°æ–‡ä»¶</td><td>å¿…éœ€</td></tr><tr><td>Xcode integration</td><td>Xcodeé¡¹ç›®é›†æˆ</td><td>å¿…éœ€</td></tr><tr><td>Git plugin</td><td>Gitæºä»£ç ç®¡ç†</td><td>å¿…éœ€</td></tr><tr><td>Pipeline</td><td>æµæ°´çº¿ä»»åŠ¡æ”¯æŒ</td><td>æ¨è</td></tr></tbody></table>
<h3 data-id="heading-7">3.2 è¯ä¹¦ä¸æè¿°æ–‡ä»¶é…ç½®</h3>
<p><strong>æ­¥éª¤ä¸€ï¼šå‡†å¤‡Keychainæ–‡ä»¶</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‰¾åˆ°ç³»ç»Ÿé’¥åŒ™ä¸²æ–‡ä»¶</span>
<span class="hljs-built_in">cp</span> ~/Library/Keychains/login.keychain-db ~/Desktop/login.keychain

<span class="hljs-comment"># æ³¨æ„ï¼šéœ€è¦å¤åˆ¶å¹¶å»é™¤-dbåç¼€æ‰èƒ½ä¸Šä¼ åˆ°Jenkins</span>
</code></pre>
<p><strong>æ­¥éª¤äºŒï¼šå‡†å¤‡æè¿°æ–‡ä»¶</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æè¿°æ–‡ä»¶é»˜è®¤è·¯å¾„</span>
~/Library/MobileDevice/Provisioning\ Profiles/

<span class="hljs-comment"># å¯ä»¥æŸ¥çœ‹æ‰€æœ‰æè¿°æ–‡ä»¶</span>
<span class="hljs-built_in">ls</span> -la ~/Library/MobileDevice/Provisioning\ Profiles/
</code></pre>
<p><strong>æ­¥éª¤ä¸‰ï¼šJenkinsæ’ä»¶é…ç½®</strong></p>
<ol>
<li>è¿›å…¥ <strong>Manage Jenkins</strong> â†’ <strong>Keychains and Provisioning Profiles Management</strong></li>
<li>ä¸Šä¼ Keychainæ–‡ä»¶ï¼š
<ul>
<li>ç‚¹å‡»"Upload Keychain"</li>
<li>é€‰æ‹©å‡†å¤‡å¥½çš„<code>login.keychain</code>æ–‡ä»¶</li>
<li>åœ¨"Code Signing Identity"ä¸­æ·»åŠ è¯ä¹¦åç§°ï¼ˆå¯åœ¨é’¥åŒ™ä¸²è®¿é—®ä¸­æŸ¥çœ‹ï¼‰</li>
</ul>
</li>
<li>ä¸Šä¼ æè¿°æ–‡ä»¶ï¼š
<ul>
<li>ç‚¹å‡»"Upload Provisioning Profile"</li>
<li>é€‰æ‹©æè¿°æ–‡ä»¶</li>
<li>è®¾ç½®ç›®æ ‡è·¯å¾„ï¼š<code>/Users/å…±äº«ç”¨æˆ·å/Library/MobileDevice/Provisioning Profiles</code></li>
</ul>
</li>
</ol>
<h2 data-id="heading-8">å››ã€å®Œæ•´è‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬</h2>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬ï¼Œæ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># iOSè‡ªåŠ¨åŒ–æ‰“åŒ…è„šæœ¬</span>
<span class="hljs-comment"># æ–‡ä»¶åï¼šios_auto_build.sh</span>
<span class="hljs-comment"># ä½¿ç”¨æ–¹æ³•ï¼š./ios_auto_build.sh [ç¯å¢ƒ] [ç‰ˆæœ¬å·]</span>

<span class="hljs-comment"># è®¾ç½®è¯­è¨€ç¯å¢ƒï¼Œé¿å…ç¼–ç é—®é¢˜</span>
<span class="hljs-built_in">export</span> LANG=en_US.UTF-8
<span class="hljs-built_in">export</span> LC_ALL=en_US.UTF-8

<span class="hljs-comment"># ============== å‚æ•°é…ç½® ==============</span>
<span class="hljs-comment"># é»˜è®¤é…ç½®</span>
CONFIGURATION=<span class="hljs-string">"Release"</span>
EXPORT_METHOD=<span class="hljs-string">"development"</span>  <span class="hljs-comment"># development, ad-hoc, app-store, enterprise</span>
BUILD_SCHEME=<span class="hljs-string">"YourApp"</span>
PROJECT_NAME=<span class="hljs-string">"YourApp"</span>
UPLOAD_TO_PGYER=<span class="hljs-literal">false</span>
VERSION_OVERRIDE=<span class="hljs-string">""</span>

<span class="hljs-comment"># è§£æå‘½ä»¤è¡Œå‚æ•°</span>
<span class="hljs-keyword">while</span> [[ <span class="hljs-variable">$#</span> -gt 0 ]]; <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">case</span> <span class="hljs-variable">$1</span> <span class="hljs-keyword">in</span>
        -e|--environment)
            <span class="hljs-keyword">case</span> <span class="hljs-variable">$2</span> <span class="hljs-keyword">in</span>
                dev) EXPORT_METHOD=<span class="hljs-string">"development"</span> ;;
                adhoc) EXPORT_METHOD=<span class="hljs-string">"ad-hoc"</span> ;;
                appstore) EXPORT_METHOD=<span class="hljs-string">"app-store"</span> ;;
                enterprise) EXPORT_METHOD=<span class="hljs-string">"enterprise"</span> ;;
                *) <span class="hljs-built_in">echo</span> <span class="hljs-string">"æœªçŸ¥ç¯å¢ƒ: <span class="hljs-variable">$2</span>"</span>; <span class="hljs-built_in">exit</span> 1 ;;
            <span class="hljs-keyword">esac</span>
            <span class="hljs-built_in">shift</span> 2
            ;;
        -s|--scheme)
            BUILD_SCHEME=<span class="hljs-string">"<span class="hljs-variable">$2</span>"</span>
            <span class="hljs-built_in">shift</span> 2
            ;;
        -v|--version)
            VERSION_OVERRIDE=<span class="hljs-string">"<span class="hljs-variable">$2</span>"</span>
            <span class="hljs-built_in">shift</span> 2
            ;;
        -u|--upload)
            UPLOAD_TO_PGYER=<span class="hljs-literal">true</span>
            <span class="hljs-built_in">shift</span>
            ;;
        *)
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"æœªçŸ¥å‚æ•°: <span class="hljs-variable">$1</span>"</span>
            <span class="hljs-built_in">echo</span> <span class="hljs-string">"ç”¨æ³•: <span class="hljs-variable">$0</span> [-e dev|adhoc|appstore|enterprise] [-s scheme] [-v version] [-u]"</span>
            <span class="hljs-built_in">exit</span> 1
            ;;
    <span class="hljs-keyword">esac</span>
<span class="hljs-keyword">done</span>

<span class="hljs-comment"># ============== è·¯å¾„é…ç½® ==============</span>
<span class="hljs-comment"># Jenkinså·¥ä½œç©ºé—´è·¯å¾„ï¼ˆJenkinsç¯å¢ƒå˜é‡ï¼‰</span>
<span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$WORKSPACE</span>"</span> ]; <span class="hljs-keyword">then</span>
    WORKSPACE=$(<span class="hljs-built_in">pwd</span>)
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># é¡¹ç›®ç›¸å…³è·¯å¾„</span>
PROJECT_PATH=<span class="hljs-string">"<span class="hljs-variable">$WORKSPACE</span>"</span>
XCODEPROJ_PATH=<span class="hljs-string">"<span class="hljs-variable">$PROJECT_PATH</span>/<span class="hljs-variable">$PROJECT_NAME</span>.xcodeproj"</span>
WORKSPACE_PATH=<span class="hljs-string">"<span class="hljs-variable">$PROJECT_PATH</span>/<span class="hljs-variable">$PROJECT_NAME</span>.xcworkspace"</span>
INFOPLIST_PATH=<span class="hljs-string">"<span class="hljs-variable">$PROJECT_PATH</span>/<span class="hljs-variable">$PROJECT_NAME</span>/Info.plist"</span>

<span class="hljs-comment"># è¾“å‡ºè·¯å¾„</span>
BUILD_DATE=$(<span class="hljs-built_in">date</span> +%Y%m%d_%H%M%S)
ARCHIVE_NAME=<span class="hljs-string">"<span class="hljs-variable">${BUILD_SCHEME}</span>_<span class="hljs-variable">${EXPORT_METHOD}</span>_<span class="hljs-variable">${BUILD_DATE}</span>.xcarchive"</span>
IPA_NAME=<span class="hljs-string">"<span class="hljs-variable">${BUILD_SCHEME}</span>_<span class="hljs-variable">${EXPORT_METHOD}</span>_<span class="hljs-variable">${BUILD_DATE}</span>.ipa"</span>

ARCHIVE_DIR=<span class="hljs-string">"<span class="hljs-variable">$WORKSPACE</span>/build/archive"</span>
IPA_DIR=<span class="hljs-string">"<span class="hljs-variable">$WORKSPACE</span>/build/ipa"</span>
LOG_DIR=<span class="hljs-string">"<span class="hljs-variable">$WORKSPACE</span>/build/logs"</span>

<span class="hljs-comment"># åˆ›å»ºç›®å½•</span>
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">"<span class="hljs-variable">$ARCHIVE_DIR</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$IPA_DIR</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>"</span>

<span class="hljs-comment"># ExportOptions.plistè·¯å¾„</span>
EXPORT_OPTIONS_DIR=<span class="hljs-string">"<span class="hljs-variable">$PROJECT_PATH</span>/ExportOptions"</span>
EXPORT_OPTIONS_PLIST=<span class="hljs-string">"<span class="hljs-variable">$EXPORT_OPTIONS_DIR</span>/<span class="hljs-variable">${EXPORT_METHOD}</span>.plist"</span>

<span class="hljs-comment"># ============== æ—¥å¿—å‡½æ•° ==============</span>
<span class="hljs-function"><span class="hljs-title">log_info</span></span>() {
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"[INFO] <span class="hljs-subst">$(date '+%Y-%m-%d %H:%M:%S')</span> - <span class="hljs-variable">$1</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>/build.log"</span>
}

<span class="hljs-function"><span class="hljs-title">log_error</span></span>() {
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"[ERROR] <span class="hljs-subst">$(date '+%Y-%m-%d %H:%M:%S')</span> - <span class="hljs-variable">$1</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>/error.log"</span>
}

<span class="hljs-function"><span class="hljs-title">log_success</span></span>() {
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"[SUCCESS] <span class="hljs-subst">$(date '+%Y-%m-%d %H:%M:%S')</span> - <span class="hljs-variable">$1</span>"</span> | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>/build.log"</span>
}

<span class="hljs-comment"># ============== ç‰ˆæœ¬å·ç®¡ç† ==============</span>
<span class="hljs-function"><span class="hljs-title">update_version_if_needed</span></span>() {
    <span class="hljs-keyword">if</span> [ ! -z <span class="hljs-string">"<span class="hljs-variable">$VERSION_OVERRIDE</span>"</span> ]; <span class="hljs-keyword">then</span>
        log_info <span class="hljs-string">"æ›´æ–°ç‰ˆæœ¬å·ä¸º: <span class="hljs-variable">$VERSION_OVERRIDE</span>"</span>
        
        <span class="hljs-comment"># æ›´æ–°CFBundleShortVersionString (å¸‚åœºç‰ˆæœ¬å·)</span>
        /usr/libexec/PlistBuddy -c <span class="hljs-string">"Set :CFBundleShortVersionString <span class="hljs-variable">$VERSION_OVERRIDE</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$INFOPLIST_PATH</span>"</span>
        
        <span class="hljs-comment"># æ›´æ–°CFBundleVersion (æ„å»ºç‰ˆæœ¬å·)</span>
        BUILD_NUMBER=$(<span class="hljs-built_in">date</span> +%Y%m%d%H%M)
        /usr/libexec/PlistBuddy -c <span class="hljs-string">"Set :CFBundleVersion <span class="hljs-variable">$BUILD_NUMBER</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$INFOPLIST_PATH</span>"</span>
        
        log_success <span class="hljs-string">"ç‰ˆæœ¬å·æ›´æ–°å®Œæˆ: <span class="hljs-variable">$VERSION_OVERRIDE</span> (Build: <span class="hljs-variable">$BUILD_NUMBER</span>)"</span>
    <span class="hljs-keyword">fi</span>
}

<span class="hljs-comment"># ============== ä¾èµ–å®‰è£… ==============</span>
<span class="hljs-function"><span class="hljs-title">install_dependencies</span></span>() {
    log_info <span class="hljs-string">"å¼€å§‹å®‰è£…ä¾èµ–..."</span>
    
    <span class="hljs-comment"># æ£€æŸ¥æ˜¯å¦ä½¿ç”¨CocoaPods</span>
    <span class="hljs-keyword">if</span> [ -f <span class="hljs-string">"<span class="hljs-variable">$PROJECT_PATH</span>/Podfile"</span> ]; <span class="hljs-keyword">then</span>
        log_info <span class="hljs-string">"æ£€æµ‹åˆ°Podfileï¼Œæ‰§è¡Œpod install..."</span>
        
        <span class="hljs-comment"># æ›´æ–°CocoaPodsä»“åº“ï¼ˆå¯é€‰ï¼Œé¦–æ¬¡æˆ–éœ€è¦æ›´æ–°æ—¶ï¼‰</span>
        <span class="hljs-comment"># pod repo update</span>
        
        <span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
        <span class="hljs-built_in">cd</span> <span class="hljs-string">"<span class="hljs-variable">$PROJECT_PATH</span>"</span>
        pod install --repo-update
        
        <span class="hljs-keyword">if</span> [ $? -eq 0 ]; <span class="hljs-keyword">then</span>
            log_success <span class="hljs-string">"ä¾èµ–å®‰è£…æˆåŠŸ"</span>
        <span class="hljs-keyword">else</span>
            log_error <span class="hljs-string">"ä¾èµ–å®‰è£…å¤±è´¥"</span>
            <span class="hljs-built_in">exit</span> 1
        <span class="hljs-keyword">fi</span>
    <span class="hljs-keyword">else</span>
        log_info <span class="hljs-string">"æœªæ£€æµ‹åˆ°Podfileï¼Œè·³è¿‡ä¾èµ–å®‰è£…"</span>
    <span class="hljs-keyword">fi</span>
}

<span class="hljs-comment"># ============== æ¸…ç†é¡¹ç›® ==============</span>
<span class="hljs-function"><span class="hljs-title">clean_project</span></span>() {
    log_info <span class="hljs-string">"å¼€å§‹æ¸…ç†é¡¹ç›®..."</span>
    
    <span class="hljs-comment"># æ¸…ç†DerivedData</span>
    DERIVED_DATA_PATH=<span class="hljs-string">"<span class="hljs-variable">$HOME</span>/Library/Developer/Xcode/DerivedData"</span>
    <span class="hljs-keyword">if</span> [ -d <span class="hljs-string">"<span class="hljs-variable">$DERIVED_DATA_PATH</span>"</span> ]; <span class="hljs-keyword">then</span>
        find <span class="hljs-string">"<span class="hljs-variable">$DERIVED_DATA_PATH</span>"</span> -name <span class="hljs-string">"<span class="hljs-variable">${PROJECT_NAME}</span>*"</span> -<span class="hljs-built_in">type</span> d -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">rm</span> -rf {} + 2&gt;/dev/null || <span class="hljs-literal">true</span>
        log_info <span class="hljs-string">"å·²æ¸…ç†DerivedData"</span>
    <span class="hljs-keyword">fi</span>
    
    <span class="hljs-comment"># Xcodeæ¸…ç†</span>
    xcodebuild clean \
        -workspace <span class="hljs-string">"<span class="hljs-variable">$WORKSPACE_PATH</span>"</span> \
        -scheme <span class="hljs-string">"<span class="hljs-variable">$BUILD_SCHEME</span>"</span> \
        -configuration <span class="hljs-string">"<span class="hljs-variable">$CONFIGURATION</span>"</span> \
        -quiet \
        2&gt;&amp;1 | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>/clean.log"</span>
    
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">${PIPESTATUS[0]}</span> -eq 0 ]; <span class="hljs-keyword">then</span>
        log_success <span class="hljs-string">"é¡¹ç›®æ¸…ç†å®Œæˆ"</span>
    <span class="hljs-keyword">else</span>
        log_error <span class="hljs-string">"é¡¹ç›®æ¸…ç†å¤±è´¥"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>
}

<span class="hljs-comment"># ============== æ„å»ºå½’æ¡£ ==============</span>
<span class="hljs-function"><span class="hljs-title">build_archive</span></span>() {
    log_info <span class="hljs-string">"å¼€å§‹æ„å»ºå½’æ¡£..."</span>
    
    <span class="hljs-comment"># æ„å»ºå½’æ¡£</span>
    xcodebuild archive \
        -workspace <span class="hljs-string">"<span class="hljs-variable">$WORKSPACE_PATH</span>"</span> \
        -scheme <span class="hljs-string">"<span class="hljs-variable">$BUILD_SCHEME</span>"</span> \
        -configuration <span class="hljs-string">"<span class="hljs-variable">$CONFIGURATION</span>"</span> \
        -archivePath <span class="hljs-string">"<span class="hljs-variable">$ARCHIVE_DIR</span>/<span class="hljs-variable">$ARCHIVE_NAME</span>"</span> \
        -destination <span class="hljs-string">"generic/platform=iOS"</span> \
        -allowProvisioningUpdates \
        -quiet \
        2&gt;&amp;1 | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>/archive.log"</span>
    
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">${PIPESTATUS[0]}</span> -eq 0 ]; <span class="hljs-keyword">then</span>
        log_success <span class="hljs-string">"å½’æ¡£æ„å»ºå®Œæˆ: <span class="hljs-variable">$ARCHIVE_NAME</span>"</span>
    <span class="hljs-keyword">else</span>
        log_error <span class="hljs-string">"å½’æ¡£æ„å»ºå¤±è´¥"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>
}

<span class="hljs-comment"># ============== å¯¼å‡ºIPA ==============</span>
<span class="hljs-function"><span class="hljs-title">export_ipa</span></span>() {
    log_info <span class="hljs-string">"å¼€å§‹å¯¼å‡ºIPA..."</span>
    
    <span class="hljs-comment"># æ£€æŸ¥ExportOptions.plistæ˜¯å¦å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">"<span class="hljs-variable">$EXPORT_OPTIONS_PLIST</span>"</span> ]; <span class="hljs-keyword">then</span>
        log_error <span class="hljs-string">"ExportOptions.plistæ–‡ä»¶ä¸å­˜åœ¨: <span class="hljs-variable">$EXPORT_OPTIONS_PLIST</span>"</span>
        log_info <span class="hljs-string">"è¯·å…ˆé€šè¿‡Xcodeæ‰‹åŠ¨å¯¼å‡ºä¸€æ¬¡è·å–æ­£ç¡®çš„plistæ–‡ä»¶"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>
    
    <span class="hljs-comment"># å¯¼å‡ºIPA</span>
    xcodebuild -exportArchive \
        -archivePath <span class="hljs-string">"<span class="hljs-variable">$ARCHIVE_DIR</span>/<span class="hljs-variable">$ARCHIVE_NAME</span>"</span> \
        -exportPath <span class="hljs-string">"<span class="hljs-variable">$IPA_DIR</span>"</span> \
        -exportOptionsPlist <span class="hljs-string">"<span class="hljs-variable">$EXPORT_OPTIONS_PLIST</span>"</span> \
        -allowProvisioningUpdates \
        2&gt;&amp;1 | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>/export.log"</span>
    
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">${PIPESTATUS[0]}</span> -eq 0 ]; <span class="hljs-keyword">then</span>
        <span class="hljs-comment"># é‡å‘½åIPAæ–‡ä»¶</span>
        <span class="hljs-built_in">mv</span> <span class="hljs-string">"<span class="hljs-variable">$IPA_DIR</span>/<span class="hljs-variable">$BUILD_SCHEME</span>.ipa"</span> <span class="hljs-string">"<span class="hljs-variable">$IPA_DIR</span>/<span class="hljs-variable">$IPA_NAME</span>"</span>
        log_success <span class="hljs-string">"IPAå¯¼å‡ºå®Œæˆ: <span class="hljs-variable">$IPA_NAME</span>"</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">"IPAè·¯å¾„: <span class="hljs-variable">$IPA_DIR</span>/<span class="hljs-variable">$IPA_NAME</span>"</span>
    <span class="hljs-keyword">else</span>
        log_error <span class="hljs-string">"IPAå¯¼å‡ºå¤±è´¥"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>
}

<span class="hljs-comment"># ============== ä¸Šä¼ åˆ°åˆ†å‘å¹³å° ==============</span>
<span class="hljs-function"><span class="hljs-title">upload_to_pgyer</span></span>() {
    <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$UPLOAD_TO_PGYER</span>"</span> = <span class="hljs-literal">false</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">return</span> 0
    <span class="hljs-keyword">fi</span>
    
    log_info <span class="hljs-string">"å¼€å§‹ä¸Šä¼ åˆ°è’²å…¬è‹±..."</span>
    
    <span class="hljs-comment"># è’²å…¬è‹±APIé…ç½®ï¼ˆè¯·æ›¿æ¢ä¸ºè‡ªå·±çš„è´¦å·ä¿¡æ¯ï¼‰</span>
    PGYER_U_KEY=<span class="hljs-string">"your_u_key_here"</span>
    PGYER_API_KEY=<span class="hljs-string">"your_api_key_here"</span>
    IPA_PATH=<span class="hljs-string">"<span class="hljs-variable">$IPA_DIR</span>/<span class="hljs-variable">$IPA_NAME</span>"</span>
    
    <span class="hljs-comment"># æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> [ ! -f <span class="hljs-string">"<span class="hljs-variable">$IPA_PATH</span>"</span> ]; <span class="hljs-keyword">then</span>
        log_error <span class="hljs-string">"IPAæ–‡ä»¶ä¸å­˜åœ¨: <span class="hljs-variable">$IPA_PATH</span>"</span>
        <span class="hljs-built_in">return</span> 1
    <span class="hljs-keyword">fi</span>
    
    <span class="hljs-comment"># ä¸Šä¼ åˆ°è’²å…¬è‹±</span>
    curl -F <span class="hljs-string">"file=@<span class="hljs-variable">$IPA_PATH</span>"</span> \
         -F <span class="hljs-string">"uKey=<span class="hljs-variable">$PGYER_U_KEY</span>"</span> \
         -F <span class="hljs-string">"_api_key=<span class="hljs-variable">$PGYER_API_KEY</span>"</span> \
         -F <span class="hljs-string">"installType=2"</span> \
         -F <span class="hljs-string">"password=123456"</span> \
         https://upload.pgyer.com/apiv1/app/upload \
         2&gt;&amp;1 | <span class="hljs-built_in">tee</span> -a <span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>/upload.log"</span>
    
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">${PIPESTATUS[0]}</span> -eq 0 ]; <span class="hljs-keyword">then</span>
        log_success <span class="hljs-string">"ä¸Šä¼ åˆ°è’²å…¬è‹±æˆåŠŸ"</span>
    <span class="hljs-keyword">else</span>
        log_error <span class="hljs-string">"ä¸Šä¼ åˆ°è’²å…¬è‹±å¤±è´¥"</span>
    <span class="hljs-keyword">fi</span>
}

<span class="hljs-comment"># ============== ç”Ÿæˆæ„å»ºæŠ¥å‘Š ==============</span>
<span class="hljs-function"><span class="hljs-title">generate_build_report</span></span>() {
    log_info <span class="hljs-string">"ç”Ÿæˆæ„å»ºæŠ¥å‘Š..."</span>
    
    REPORT_FILE=<span class="hljs-string">"<span class="hljs-variable">$LOG_DIR</span>/build_report_<span class="hljs-variable">${BUILD_DATE}</span>.md"</span>
    
    <span class="hljs-built_in">cat</span> &gt; <span class="hljs-string">"<span class="hljs-variable">$REPORT_FILE</span>"</span> &lt;&lt; <span class="hljs-string">EOF
# iOSæ„å»ºæŠ¥å‘Š

## åŸºæœ¬ä¿¡æ¯
- é¡¹ç›®åç§°: $PROJECT_NAME
- æ„å»ºæ–¹æ¡ˆ: $BUILD_SCHEME
- æ„å»ºç¯å¢ƒ: $EXPORT_METHOD
- æ„å»ºé…ç½®: $CONFIGURATION
- æ„å»ºæ—¶é—´: $(date '+%Y-%m-%d %H:%M:%S')

## ç‰ˆæœ¬ä¿¡æ¯
$(/usr/libexec/PlistBuddy -c "Print :CFBundleShortVersionString" "$INFOPLIST_PATH" 2&gt;/dev/null | awk '{print "å¸‚åœºç‰ˆæœ¬: "$0}')
$(/usr/libexec/PlistBuddy -c "Print :CFBundleVersion" "$INFOPLIST_PATH" 2&gt;/dev/null | awk '{print "æ„å»ºç‰ˆæœ¬: "$0}')

## äº§ç‰©ä¿¡æ¯
- å½’æ¡£æ–‡ä»¶: $ARCHIVE_NAME
- IPAæ–‡ä»¶: $IPA_NAME
- IPAå¤§å°: $(du -h "$IPA_DIR/$IPA_NAME" | cut -f1)

## æ„å»ºçŠ¶æ€
- ä¾èµ–å®‰è£…: âœ… æˆåŠŸ
- é¡¹ç›®æ¸…ç†: âœ… æˆåŠŸ  
- å½’æ¡£æ„å»º: âœ… æˆåŠŸ
- IPAå¯¼å‡º: âœ… æˆåŠŸ
$(if [ "$UPLOAD_TO_PGYER" = true ]; then echo "- è’²å…¬è‹±ä¸Šä¼ : âœ… æˆåŠŸ"; fi)

## æ–‡ä»¶è·¯å¾„
- å·¥ä½œç©ºé—´: $WORKSPACE
- IPAç›®å½•: $IPA_DIR
- æ—¥å¿—ç›®å½•: $LOG_DIR

## æ„å»ºæ—¥å¿—
\`\`\`
$(tail -20 "$LOG_DIR/build.log")
\`\`\`

---
*æ­¤æŠ¥å‘Šç”±è‡ªåŠ¨åŒ–æ„å»ºç³»ç»Ÿç”Ÿæˆ*
EOF</span>
    
    log_success <span class="hljs-string">"æ„å»ºæŠ¥å‘Šå·²ç”Ÿæˆ: <span class="hljs-variable">$REPORT_FILE</span>"</span>
}

<span class="hljs-comment"># ============== ä¸»æ‰§è¡Œæµç¨‹ ==============</span>
<span class="hljs-function"><span class="hljs-title">main</span></span>() {
    log_info <span class="hljs-string">"========== å¼€å§‹iOSè‡ªåŠ¨åŒ–æ‰“åŒ… =========="</span>
    log_info <span class="hljs-string">"é¡¹ç›®: <span class="hljs-variable">$PROJECT_NAME</span>"</span>
    log_info <span class="hljs-string">"æ–¹æ¡ˆ: <span class="hljs-variable">$BUILD_SCHEME</span>"</span>
    log_info <span class="hljs-string">"ç¯å¢ƒ: <span class="hljs-variable">$EXPORT_METHOD</span>"</span>
    log_info <span class="hljs-string">"é…ç½®: <span class="hljs-variable">$CONFIGURATION</span>"</span>
    
    <span class="hljs-comment"># æ‰§è¡Œæ„å»ºæ­¥éª¤</span>
    update_version_if_needed
    install_dependencies
    clean_project
    build_archive
    export_ipa
    upload_to_pgyer
    generate_build_report
    
    log_success <span class="hljs-string">"========== iOSè‡ªåŠ¨åŒ–æ‰“åŒ…å®Œæˆ =========="</span>
    log_success <span class="hljs-string">"æ€»è€—æ—¶: <span class="hljs-variable">$SECONDS</span> ç§’"</span>
    log_success <span class="hljs-string">"IPAæ–‡ä»¶: <span class="hljs-variable">$IPA_DIR</span>/<span class="hljs-variable">$IPA_NAME</span>"</span>
    
    <span class="hljs-comment"># æ‰“å¼€è¾“å‡ºç›®å½•ï¼ˆä»…æœ¬åœ°è¿è¡Œï¼‰</span>
    <span class="hljs-keyword">if</span> [ -z <span class="hljs-string">"<span class="hljs-variable">$JENKINS_HOME</span>"</span> ]; <span class="hljs-keyword">then</span>
        open <span class="hljs-string">"<span class="hljs-variable">$IPA_DIR</span>"</span>
    <span class="hljs-keyword">fi</span>
    
    <span class="hljs-built_in">return</span> 0
}

<span class="hljs-comment"># å¼‚å¸¸å¤„ç†</span>
<span class="hljs-built_in">trap</span> <span class="hljs-string">'log_error "æ„å»ºè¿‡ç¨‹è¢«ä¸­æ–­"; exit 1'</span> INT TERM

<span class="hljs-comment"># æ‰§è¡Œä¸»å‡½æ•°</span>
main <span class="hljs-string">"<span class="hljs-variable">$@</span>"</span>
</code></pre>
<h3 data-id="heading-9">4.1 ExportOptions.plistæ–‡ä»¶æ¨¡æ¿</h3>
<p>åˆ›å»º<code>ExportOptions</code>ç›®å½•ï¼Œæ ¹æ®ä¸åŒçš„å¯¼å‡ºæ–¹å¼åˆ›å»ºå¯¹åº”çš„plistæ–‡ä»¶ï¼š</p>
<p><strong>DevelopmentExportOptions.plist</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">plist</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="hljs-string">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">plist</span> <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>compileBitcode<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">false</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>destination<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>export<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>method<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>development<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>provisioningProfiles<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>com.yourcompany.yourapp<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>Your App Development Profile<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>signingCertificate<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>iPhone Developer<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>signingStyle<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>manual<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>stripSwiftSymbols<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">true</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>teamID<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>YOUR_TEAM_ID<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>thinning<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span><span class="hljs-symbol">&amp;lt;</span>none<span class="hljs-symbol">&amp;gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">plist</span>&gt;</span>
</code></pre>
<p><strong>AdHocExportOptions.plist</strong></p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"UTF-8"</span>?&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">plist</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="hljs-string">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">plist</span> <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>compileBitcode<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">false</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>destination<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>export<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>method<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>ad-hoc<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>provisioningProfiles<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dict</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>com.yourcompany.yourapp<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>Your App AdHoc Profile<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>signingCertificate<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>iPhone Distribution<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>signingStyle<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>manual<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>stripSwiftSymbols<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">true</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>teamID<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>YOUR_TEAM_ID<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">key</span>&gt;</span>thinning<span class="hljs-tag">&lt;/<span class="hljs-name">key</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span><span class="hljs-symbol">&amp;lt;</span>none<span class="hljs-symbol">&amp;gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dict</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">plist</span>&gt;</span>
</code></pre>
<h2 data-id="heading-10">äº”ã€Jenkinsä»»åŠ¡é…ç½®</h2>
<h3 data-id="heading-11">5.1 åˆ›å»ºè‡ªç”±é£æ ¼ä»»åŠ¡</h3>
<ol>
<li>
<p><strong>æ–°å»ºä»»åŠ¡</strong>ï¼šé€‰æ‹©"æ–°å»ºItem" â†’ è¾“å…¥ä»»åŠ¡åç§° â†’ é€‰æ‹©"Freestyle project"</p>
</li>
<li>
<p><strong>æºç ç®¡ç†</strong>ï¼šé…ç½®Gitä»“åº“ä¿¡æ¯</p>
<ul>
<li>Repository URL: <code>git@github.com:yourname/yourapp.git</code></li>
<li>Credentials: æ·»åŠ SSHå¯†é’¥</li>
<li>Branches to build: <code>*/main</code> (æ ¹æ®å®é™…æƒ…å†µ)</li>
</ul>
</li>
<li>
<p><strong>æ„å»ºè§¦å‘å™¨</strong>ï¼ˆå¯é€‰ï¼‰ï¼š</p>
<ul>
<li>å®šæ—¶æ„å»ºï¼š<code>H */2 * * *</code> (æ¯2å°æ—¶æ„å»ºä¸€æ¬¡)</li>
<li>GitHub hookè§¦å‘</li>
</ul>
</li>
</ol>
<h3 data-id="heading-12">5.2 æ„å»ºç¯å¢ƒé…ç½®</h3>
<p>åœ¨"æ„å»ºç¯å¢ƒ"ä¸­å‹¾é€‰ï¼š</p>
<ul>
<li>âœ… <code>Keychains and Code Signing Identities</code></li>
<li>âœ… <code>Mobile Provisioning Profiles</code></li>
</ul>
<p>é€‰æ‹©å¯¹åº”çš„è¯ä¹¦å’Œæè¿°æ–‡ä»¶ã€‚</p>
<h3 data-id="heading-13">5.3 æ„å»ºæ­¥éª¤é…ç½®</h3>
<p>æ·»åŠ æ„å»ºæ­¥éª¤ï¼š</p>
<ol>
<li><strong>Execute shell</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è®¾ç½®æ‰§è¡Œæƒé™</span>
<span class="hljs-built_in">chmod</span> +x ./scripts/ios_auto_build.sh

<span class="hljs-comment"># æ‰§è¡Œæ‰“åŒ…è„šæœ¬ï¼ˆå¼€å‘ç¯å¢ƒï¼‰</span>
./scripts/ios_auto_build.sh -e dev -s YourApp -u

<span class="hljs-comment"># æˆ–è€…ä½¿ç”¨å‚æ•°åŒ–æ„å»º</span>
./scripts/ios_auto_build.sh -e <span class="hljs-variable">${BUILD_ENV}</span> -s <span class="hljs-variable">${SCHEME}</span> <span class="hljs-variable">${UPLOAD}</span>
</code></pre>
<ol start="2">
<li><strong>æ„å»ºåæ“ä½œ</strong>ï¼š
<ul>
<li>Archive the artifacts: <code>build/ipa/*.ipa</code></li>
<li>é‚®ä»¶é€šçŸ¥ï¼ˆé…ç½®SMTPæœåŠ¡å™¨ï¼‰</li>
</ul>
</li>
</ol>
<h2 data-id="heading-14">å…­ã€æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ</h2>
<h3 data-id="heading-15">6.1 æ„å»ºé€Ÿåº¦ä¼˜åŒ–ç­–ç•¥</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># æ–‡ä»¶åï¼šoptimized_build.sh</span>
<span class="hljs-comment"># æ„å»ºä¼˜åŒ–è„šæœ¬</span>

<span class="hljs-comment"># 1. ä½¿ç”¨DerivedDataç¼“å­˜</span>
DERIVED_DATA_PATH=<span class="hljs-string">"<span class="hljs-variable">$HOME</span>/Library/Developer/Xcode/DerivedData/Cache"</span>
<span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">"<span class="hljs-variable">$DERIVED_DATA_PATH</span>"</span>

<span class="hljs-comment"># 2. ä»…æ¸…ç†å¿…è¦éƒ¨åˆ†ï¼Œé¿å…å®Œå…¨æ¸…ç†</span>
<span class="hljs-function"><span class="hljs-title">clean_partial</span></span>() {
    <span class="hljs-comment"># åªæ¸…ç†å½“å‰é¡¹ç›®çš„DerivedData</span>
    find <span class="hljs-string">"<span class="hljs-variable">$DERIVED_DATA_PATH</span>"</span> -name <span class="hljs-string">"<span class="hljs-variable">${PROJECT_NAME}</span>*"</span> -mtime +7 -<span class="hljs-built_in">type</span> d -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">rm</span> -rf {} \;
}

<span class="hljs-comment"># 3. å¹¶è¡Œæ„å»ºï¼ˆå¦‚æœé¡¹ç›®æ”¯æŒï¼‰</span>
xcodebuild archive \
    -workspace <span class="hljs-string">"<span class="hljs-variable">$WORKSPACE_PATH</span>"</span> \
    -scheme <span class="hljs-string">"<span class="hljs-variable">$BUILD_SCHEME</span>"</span> \
    -configuration <span class="hljs-string">"<span class="hljs-variable">$CONFIGURATION</span>"</span> \
    -archivePath <span class="hljs-string">"<span class="hljs-variable">$ARCHIVE_PATH</span>"</span> \
    -parallelizeTargets \
    -<span class="hljs-built_in">jobs</span> 4 \  <span class="hljs-comment"># æ ¹æ®CPUæ ¸å¿ƒæ•°è°ƒæ•´</span>
    -quiet

<span class="hljs-comment"># 4. ä½¿ç”¨ccacheåŠ é€Ÿç¼–è¯‘</span>
<span class="hljs-built_in">export</span> CCACHE_DIR=<span class="hljs-string">"<span class="hljs-variable">$HOME</span>/.ccache"</span>
<span class="hljs-built_in">export</span> CCACHE_MAXSIZE=5G
<span class="hljs-built_in">export</span> CCACHE_CPP2=<span class="hljs-literal">true</span>

<span class="hljs-comment"># æ£€æŸ¥ccacheæ˜¯å¦å®‰è£…</span>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">command</span> -v ccache &amp;&gt; /dev/null; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">export</span> CC=<span class="hljs-string">"ccache clang"</span>
    <span class="hljs-built_in">export</span> CXX=<span class="hljs-string">"ccache clang++"</span>
<span class="hljs-keyword">fi</span>
</code></pre>
<h3 data-id="heading-16">6.2 JenkinsèŠ‚ç‚¹é…ç½®ä¼˜åŒ–</h3>
<ol>
<li><strong>å¢åŠ æ„å»ºèŠ‚ç‚¹</strong>ï¼šå°†æ„å»ºä»»åŠ¡åˆ†å‘åˆ°ä¸“ç”¨æ„å»ºæœº</li>
<li><strong>é…ç½®SSDå­˜å‚¨</strong>ï¼šç¡®ä¿DerivedDataåœ¨SSDä¸Š</li>
<li><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šä¸ºJenkinsåˆ†é…è¶³å¤Ÿå†…å­˜ï¼ˆ4GB+ï¼‰</li>
</ol>
<h2 data-id="heading-17">ä¸ƒã€å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-18">7.1 è¯ä¹¦ä¸ç­¾åé—®é¢˜</h3>
<p><strong>é—®é¢˜1ï¼š<code>Code Signing Identity</code>æ‰¾ä¸åˆ°</strong></p>
<pre><code class="hljs">è§£å†³ï¼šç¡®ä¿Keychainæ–‡ä»¶æ­£ç¡®ä¸Šä¼ ï¼Œä¸”åœ¨Jenkinsæ„å»ºç¯å¢ƒä¸­æ­£ç¡®é€‰æ‹©
</code></pre>
<p><strong>é—®é¢˜2ï¼šæè¿°æ–‡ä»¶è¿‡æœŸ</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># è‡ªåŠ¨æ£€æŸ¥æè¿°æ–‡ä»¶è¿‡æœŸè„šæœ¬</span>
<span class="hljs-comment">#!/bin/bash</span>
EXPIRY_DATE=$(security cms -D -i <span class="hljs-string">"profile.mobileprovision"</span> | plutil -extract ExpirationDate xml1 -o - - | xmllint --xpath <span class="hljs-string">'/plist/date/text()'</span> -)
TODAY=$(<span class="hljs-built_in">date</span> -u +<span class="hljs-string">"%Y-%m-%dT%H:%M:%SZ"</span>)

<span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$EXPIRY_DATE</span>"</span> &lt; <span class="hljs-string">"<span class="hljs-variable">$TODAY</span>"</span> ]]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æè¿°æ–‡ä»¶å·²è¿‡æœŸï¼Œè¯·æ›´æ–°ï¼"</span>
    <span class="hljs-comment"># å‘é€é€šçŸ¥é‚®ä»¶</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æè¿°æ–‡ä»¶è¿‡æœŸ"</span> | mail -s <span class="hljs-string">"è¯ä¹¦è­¦æŠ¥"</span> admin@example.com
<span class="hljs-keyword">fi</span>
</code></pre>
<h3 data-id="heading-19">7.2 æ„å»ºå¤±è´¥é—®é¢˜</h3>
<p><strong>é—®é¢˜3ï¼š<code>xcodebuild: error: Scheme is not currently configured for the build action.</code></strong></p>
<pre><code class="hljs language-markdown" lang="markdown">è§£å†³ï¼š
<span class="hljs-bullet">1.</span> åœ¨Xcodeä¸­æ‰“å¼€é¡¹ç›®
<span class="hljs-bullet">2.</span> Product â†’ Scheme â†’ Manage Schemes
<span class="hljs-bullet">3.</span> å‹¾é€‰å¯¹åº”Schemeçš„"Shared"å¤é€‰æ¡†
<span class="hljs-bullet">4.</span> æäº¤.xcschemeæ–‡ä»¶åˆ°Gitä»“åº“
</code></pre>
<p><strong>é—®é¢˜4ï¼š<code>Pod install</code>å¤±è´¥</strong></p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åœ¨æ„å»ºå‰æ·»åŠ ç¯å¢ƒå˜é‡</span>
<span class="hljs-built_in">export</span> COCOAPODS_DISABLE_STATS=<span class="hljs-literal">true</span>  <span class="hljs-comment"># ç¦ç”¨æ•°æ®ç»Ÿè®¡ï¼ŒåŠ é€Ÿ</span>
<span class="hljs-built_in">export</span> GIT_SSL_NO_VERIFY=<span class="hljs-literal">true</span>  <span class="hljs-comment"># å¦‚æœé‡åˆ°SSLé—®é¢˜</span>
</code></pre>
<h3 data-id="heading-20">7.3 æ€§èƒ½é—®é¢˜</h3>
<p><strong>é—®é¢˜5ï¼šæ„å»ºæ—¶é—´è¿‡é•¿ï¼ˆ&gt;10åˆ†é’Ÿï¼‰</strong></p>
<pre><code class="hljs language-markdown" lang="markdown">è§£å†³æ–¹æ¡ˆï¼š
<span class="hljs-bullet">1.</span> å¯ç”¨å¢é‡ç¼–è¯‘ï¼šé¿å…æ¯æ¬¡clean
<span class="hljs-bullet">2.</span> ä½¿ç”¨ccacheï¼šç¼“å­˜ç¼–è¯‘ç»“æœ
<span class="hljs-bullet">3.</span> åˆ†ç¦»èµ„æºï¼šå°†å›¾ç‰‡ç­‰èµ„æºæ”¾åœ¨æœåŠ¡å™¨åŠ¨æ€åŠ è½½
<span class="hljs-bullet">4.</span> æ¨¡å—åŒ–ï¼šå°†å¤§é¡¹ç›®æ‹†åˆ†æˆå¤šä¸ªæ¨¡å—
</code></pre>
<h2 data-id="heading-21">å…«ã€ç›‘æ§ä¸ç»´æŠ¤</h2>
<h3 data-id="heading-22">8.1 æ„å»ºç›‘æ§è„šæœ¬</h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># æ„å»ºç›‘æ§è„šæœ¬</span>
<span class="hljs-comment"># monitor_builds.sh</span>

JENKINS_URL=<span class="hljs-string">"http://localhost:8080"</span>
API_TOKEN=<span class="hljs-string">"your_api_token"</span>
JOB_NAME=<span class="hljs-string">"iOS-Build"</span>

<span class="hljs-comment"># è·å–æœ€è¿‘æ„å»ºçŠ¶æ€</span>
<span class="hljs-function"><span class="hljs-title">check_build_status</span></span>() {
    <span class="hljs-built_in">local</span> response=$(curl -s -u <span class="hljs-string">"admin:<span class="hljs-variable">$API_TOKEN</span>"</span> \
        <span class="hljs-string">"<span class="hljs-variable">$JENKINS_URL</span>/job/<span class="hljs-variable">$JOB_NAME</span>/lastBuild/api/json"</span>)
    
    <span class="hljs-built_in">local</span> result=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$response</span>"</span> | grep -o <span class="hljs-string">'"result":"[^"]*"'</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">'"'</span> -f4)
    <span class="hljs-built_in">local</span> number=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$response</span>"</span> | grep -o <span class="hljs-string">'"number":[0-9]*'</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">':'</span> -f2)
    <span class="hljs-built_in">local</span> duration=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$response</span>"</span> | grep -o <span class="hljs-string">'"duration":[0-9]*'</span> | <span class="hljs-built_in">cut</span> -d<span class="hljs-string">':'</span> -f2)
    
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"æ„å»º #<span class="hljs-variable">$number</span>: çŠ¶æ€=<span class="hljs-variable">$result</span>, è€—æ—¶=<span class="hljs-subst">$((duration/1000)</span>)ç§’"</span>
    
    <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$result</span>"</span> = <span class="hljs-string">"FAILURE"</span> ]; <span class="hljs-keyword">then</span>
        send_alert <span class="hljs-string">"æ„å»ºå¤±è´¥"</span> <span class="hljs-string">"æ„å»º #<span class="hljs-variable">$number</span> å¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼"</span>
    <span class="hljs-keyword">fi</span>
}

<span class="hljs-comment"># æ£€æŸ¥ç£ç›˜ç©ºé—´</span>
<span class="hljs-function"><span class="hljs-title">check_disk_space</span></span>() {
    <span class="hljs-built_in">local</span> usage=$(<span class="hljs-built_in">df</span> -h / | awk <span class="hljs-string">'NR==2 {print $5}'</span> | sed <span class="hljs-string">'s/%//'</span>)
    <span class="hljs-keyword">if</span> [ <span class="hljs-string">"<span class="hljs-variable">$usage</span>"</span> -gt 90 ]; <span class="hljs-keyword">then</span>
        send_alert <span class="hljs-string">"ç£ç›˜ç©ºé—´ä¸è¶³"</span> <span class="hljs-string">"ç£ç›˜ä½¿ç”¨ç‡: <span class="hljs-variable">${usage}</span>%"</span>
    <span class="hljs-keyword">fi</span>
}

<span class="hljs-comment"># å‘é€è­¦æŠ¥</span>
<span class="hljs-function"><span class="hljs-title">send_alert</span></span>() {
    <span class="hljs-built_in">local</span> subject=<span class="hljs-variable">$1</span>
    <span class="hljs-built_in">local</span> message=<span class="hljs-variable">$2</span>
    
    <span class="hljs-comment"># å‘é€é‚®ä»¶</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$message</span>"</span> | mail -s <span class="hljs-string">"<span class="hljs-variable">$subject</span>"</span> admin@example.com
    
    <span class="hljs-comment"># å‘é€Slacké€šçŸ¥ï¼ˆå¯é€‰ï¼‰</span>
    curl -X POST -H <span class="hljs-string">'Content-type: application/json'</span> \
        --data <span class="hljs-string">"{\"text\":\"<span class="hljs-variable">$subject</span>: <span class="hljs-variable">$message</span>\"}"</span> \
        https://hooks.slack.com/services/your/webhook/url
}

<span class="hljs-comment"># ä¸»ç›‘æ§å¾ªç¯</span>
<span class="hljs-keyword">while</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">do</span>
    check_build_status
    check_disk_space
    <span class="hljs-built_in">sleep</span> 300  <span class="hljs-comment"># æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</span>
<span class="hljs-keyword">done</span>
</code></pre>
<h3 data-id="heading-23">8.2 å®šæœŸç»´æŠ¤ä»»åŠ¡</h3>
<ol>
<li><strong>æ¯å‘¨æ¸…ç†</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¸…ç†æ—§çš„æ„å»ºäº§ç‰©</span>
find ~/.jenkins/workspace -name <span class="hljs-string">"*.ipa"</span> -mtime +30 -delete
find ~/.jenkins/workspace -name <span class="hljs-string">"*.xcarchive"</span> -mtime +7 -delete

<span class="hljs-comment"># æ¸…ç†DerivedData</span>
find ~/Library/Developer/Xcode/DerivedData -name <span class="hljs-string">"*"</span> -<span class="hljs-built_in">type</span> d -mtime +30 -<span class="hljs-built_in">exec</span> <span class="hljs-built_in">rm</span> -rf {} +
</code></pre>
<ol start="2">
<li><strong>è¯ä¹¦æ›´æ–°æé†’</strong>ï¼šè®¾ç½®æ—¥å†æé†’ï¼Œåœ¨è¯ä¹¦åˆ°æœŸå‰30å¤©æ›´æ–°</li>
</ol>
<h2 data-id="heading-24">ä¹ã€é«˜çº§åŠŸèƒ½æ‰©å±•</h2>
<h3 data-id="heading-25">9.1 Jenkins Pipelineé…ç½®</h3>
<p>åˆ›å»º<code>Jenkinsfile</code>å®ç°å£°æ˜å¼æµæ°´çº¿ï¼š</p>
<pre><code class="hljs language-groovy" lang="groovy">// Jenkinsfile
pipeline {
    agent any
    
    parameters {
        choice(
            name: 'BUILD_ENV',
            choices: ['dev', 'adhoc', 'appstore'],
            description: 'é€‰æ‹©æ„å»ºç¯å¢ƒ'
        )
        string(
            name: 'VERSION',
            defaultValue: '',
            description: 'ç‰ˆæœ¬å·ï¼ˆç•™ç©ºä½¿ç”¨å½“å‰ï¼‰'
        )
    }
    
    environment {
        PROJECT_NAME = 'YourApp'
        SCHEME = 'YourApp'
    }
    
    stages {
        stage('ä»£ç æ‹‰å–') {
            steps {
                checkout scm
            }
        }
        
        stage('ä¾èµ–å®‰è£…') {
            steps {
                sh 'pod install --repo-update'
            }
        }
        
        stage('æ„å»ºIPA') {
            steps {
                script {
                    sh """
                    chmod +x ./scripts/ios_auto_build.sh
                    ./scripts/ios_auto_build.sh \
                        -e ${params.BUILD_ENV} \
                        -s ${SCHEME} \
                        ${params.VERSION ? "-v ${params.VERSION}" : ""} \
                        -u
                    """
                }
            }
        }
        
        stage('è´¨é‡æ£€æŸ¥') {
            steps {
                // è¿è¡Œå•å…ƒæµ‹è¯•
                sh 'xcodebuild test -workspace ${PROJECT_NAME}.xcworkspace -scheme ${SCHEME} -destination "platform=iOS Simulator,name=iPhone 14"'
                
                // ä»£ç é™æ€åˆ†æ
                sh 'xcodebuild analyze -workspace ${PROJECT_NAME}.xcworkspace -scheme ${SCHEME}'
            }
        }
        
        stage('éƒ¨ç½²') {
            when {
                expression { params.BUILD_ENV == 'adhoc' || params.BUILD_ENV == 'appstore' }
            }
            steps {
                // ä¸Šä¼ åˆ°TestFlightæˆ–App Store
                script {
                    if (params.BUILD_ENV == 'appstore') {
                        sh 'xcrun altool --upload-app -f build/ipa/*.ipa -u apple@example.com -p @keychain:App_Password'
                    }
                }
            }
        }
    }
    
    post {
        success {
            emailext (
                subject: "æ„å»ºæˆåŠŸ: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
                body: "æ„å»ºæˆåŠŸï¼\n\nè¯¦æƒ…: ${env.BUILD_URL}",
                to: 'team@example.com'
            )
        }
        failure {
            emailext (
                subject: "æ„å»ºå¤±è´¥: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
                body: "æ„å»ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥ï¼\n\næ—¥å¿—: ${env.BUILD_URL}console",
                to: 'devops@example.com'
            )
        }
    }
}
</code></pre>
<h3 data-id="heading-26">9.2 å¤šç¯å¢ƒé…ç½®ç®¡ç†</h3>
<p>åˆ›å»ºé…ç½®æ–‡ä»¶ç®¡ç†ä¸åŒç¯å¢ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># configs/environments/dev.config</span>
<span class="hljs-built_in">export</span> APP_NAME=<span class="hljs-string">"MyApp Dev"</span>
<span class="hljs-built_in">export</span> BUNDLE_ID=<span class="hljs-string">"com.company.app.dev"</span>
<span class="hljs-built_in">export</span> API_BASE=<span class="hljs-string">"https://dev.api.example.com"</span>
<span class="hljs-built_in">export</span> UPLOAD_TO_PGYER=<span class="hljs-literal">true</span>

<span class="hljs-comment"># configs/environments/prod.config  </span>
<span class="hljs-built_in">export</span> APP_NAME=<span class="hljs-string">"MyApp"</span>
<span class="hljs-built_in">export</span> BUNDLE_ID=<span class="hljs-string">"com.company.app"</span>
<span class="hljs-built_in">export</span> API_BASE=<span class="hljs-string">"https://api.example.com"</span>
<span class="hljs-built_in">export</span> UPLOAD_TO_PGYER=<span class="hljs-literal">false</span>
</code></pre>
<p>åœ¨æ„å»ºè„šæœ¬ä¸­åŠ è½½é…ç½®ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åŠ è½½ç¯å¢ƒé…ç½®</span>
<span class="hljs-function"><span class="hljs-title">load_environment_config</span></span>() {
    <span class="hljs-built_in">local</span> <span class="hljs-built_in">env</span>=<span class="hljs-variable">$1</span>
    <span class="hljs-built_in">local</span> config_file=<span class="hljs-string">"<span class="hljs-variable">$PROJECT_PATH</span>/configs/environments/<span class="hljs-variable">${env}</span>.config"</span>
    
    <span class="hljs-keyword">if</span> [ -f <span class="hljs-string">"<span class="hljs-variable">$config_file</span>"</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">source</span> <span class="hljs-string">"<span class="hljs-variable">$config_file</span>"</span>
        log_info <span class="hljs-string">"å·²åŠ è½½ç¯å¢ƒé…ç½®: <span class="hljs-variable">$env</span>"</span>
    <span class="hljs-keyword">else</span>
        log_error <span class="hljs-string">"ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸å­˜åœ¨: <span class="hljs-variable">$config_file</span>"</span>
        <span class="hljs-built_in">exit</span> 1
    <span class="hljs-keyword">fi</span>
}
</code></pre>
<h2 data-id="heading-27">åã€æ€»ç»“</h2>
<p>é€šè¿‡æœ¬æ–‡çš„å®Œæ•´æŒ‡å—ï¼Œä½ å¯ä»¥å»ºç«‹ä¸€å¥—ä¸“ä¸šçš„iOSè‡ªåŠ¨åŒ–æ‰“åŒ…ç³»ç»Ÿï¼Œå®ç°ä»¥ä¸‹ç›®æ ‡ï¼š</p>
<ol>
<li><strong>ä¸€é”®æ‰“åŒ…</strong>ï¼šæ”¯æŒå¤šç¯å¢ƒã€å¤šé…ç½®çš„è‡ªåŠ¨åŒ–æ„å»º</li>
<li><strong>æŒç»­é›†æˆ</strong>ï¼šä»£ç æäº¤åè‡ªåŠ¨æ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²</li>
<li><strong>è´¨é‡ä¿éšœ</strong>ï¼šé›†æˆä»£ç æ£€æŸ¥ã€æµ‹è¯•è¦†ç›–ç‡åˆ†æ</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šé€šè¿‡ç¼“å­˜ã€å¹¶è¡Œæ„å»ºç­‰æ‰‹æ®µæå‡æ•ˆç‡</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šå®æ—¶ç›‘æ§æ„å»ºçŠ¶æ€ï¼ŒåŠæ—¶å‘ç°é—®é¢˜</li>
</ol>
<p>è¿™å¥—æ–¹æ¡ˆä¸ä»…é€‚ç”¨äºåˆåˆ›å›¢é˜Ÿå¿«é€Ÿæ­å»ºCI/CDæµç¨‹ï¼Œä¹Ÿé€‚åˆä¸­å¤§å‹å›¢é˜Ÿä¼˜åŒ–ç°æœ‰æ„å»ºç³»ç»Ÿã€‚æ ¹æ®å›¢é˜Ÿå®é™…æƒ…å†µï¼Œå¯ä»¥çµæ´»è°ƒæ•´é…ç½®ï¼Œé€æ­¥å®Œå–„è‡ªåŠ¨åŒ–æµç¨‹ã€‚</p>
<h3 data-id="heading-28">åç»­ä¼˜åŒ–å»ºè®®ï¼š</h3>
<ol>
<li><strong>å®¹å™¨åŒ–æ„å»º</strong>ï¼šä½¿ç”¨Dockerç¡®ä¿æ„å»ºç¯å¢ƒä¸€è‡´æ€§</li>
<li><strong>äºŒè¿›åˆ¶ç¼“å­˜</strong>ï¼šå°†ç¼–è¯‘äº§ç‰©ç¼“å­˜åˆ°äº‘ç«¯ï¼ŒåŠ é€ŸCI/CD</li>
<li><strong>è‡ªåŠ¨åŒ–æµ‹è¯•</strong>ï¼šé›†æˆUIè‡ªåŠ¨åŒ–æµ‹è¯•å’Œæ€§èƒ½æµ‹è¯•</li>
<li><strong>å®‰å…¨æ‰«æ</strong>ï¼šé›†æˆä»£ç å®‰å…¨æ‰«æå·¥å…·</li>
<li><strong>æ•°æ®åˆ†æ</strong>ï¼šæ”¶é›†æ„å»ºæ•°æ®ï¼Œåˆ†æä¼˜åŒ–æ–¹å‘</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>