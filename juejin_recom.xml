<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[ä»åŸç†åˆ°æŠ½è±¡ï¼šSpring Boot 3 é“¾è·¯è¿½è¸ªæ·±åº¦è§£æ]]></title>    <link>https://juejin.cn/post/7596874392824283178</link>    <guid>https://juejin.cn/post/7596874392824283178</guid>    <pubDate>2026-01-19T07:38:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596874392824283178" data-draft-id="7596874392824266794" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä»åŸç†åˆ°æŠ½è±¡ï¼šSpring Boot 3 é“¾è·¯è¿½è¸ªæ·±åº¦è§£æ"/> <meta itemprop="keywords" content="åç«¯,æ¶æ„,å¾®æœåŠ¡"/> <meta itemprop="datePublished" content="2026-01-19T07:38:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä»åŸç†åˆ°æŠ½è±¡ï¼šSpring Boot 3 é“¾è·¯è¿½è¸ªæ·±åº¦è§£æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T07:38:48.000Z" title="Mon Jan 19 2026 07:38:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    28
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« <a href="https://juejin.cn/post/7583325900294717440" target="_blank" title="https://juejin.cn/post/7583325900294717440">ã€Šå‘Šåˆ«æ‰‹å†™ TraceIdï¼Micrometer é“¾è·¯è¿½è¸ªåœ¨ Spring Boot ä¸­çš„è½åœ°å®è·µã€‹</a>ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Spring Boot 3 + Micrometer Tracing å®ç°åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªï¼ŒåŒ…æ‹¬ OpenFeignã€RestTemplateã€å¼‚æ­¥è°ƒç”¨ä¸‰ç§åœºæ™¯çš„å®Œæ•´é…ç½®å’ŒéªŒè¯ã€‚</p>
<p>é‚£ç¯‡æ–‡ç« è§£å†³äº†"æ€ä¹ˆåš"çš„é—®é¢˜ï¼Œä½†å¦‚æœä½ æƒ³çœŸæ­£ç†è§£ï¼š</p>
<ul>
<li>ä¸ºä»€ä¹ˆ Micrometer èƒ½è‡ªåŠ¨ä¼ é€’ TraceIdï¼Ÿ</li>
<li>RestTemplateã€OpenFeignã€å¼‚æ­¥è°ƒç”¨çš„ä¼ æ’­æœºåˆ¶æœ‰ä»€ä¹ˆå…±æ€§ï¼Ÿ</li>
<li>W3C Trace Context æ ‡å‡†æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</li>
<li>Micrometer çš„è®¾è®¡æ€æƒ³æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p>é‚£ä¹ˆè¿™ç¯‡æ–‡ç« å°†ä»<strong>åŸç†å±‚é¢</strong>å’Œ<strong>æŠ½è±¡å±‚é¢</strong>ç»™ä½ ç­”æ¡ˆã€‚</p>
<h2 data-id="heading-1">ä¸€ã€é—®é¢˜çš„èµ·ç‚¹ï¼šå¾®æœåŠ¡è°ƒç”¨é“¾ä¸­çš„ç›²åŒº</h2>
<p>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä¸€ä¸ªç”¨æˆ·è¯·æ±‚å¾€å¾€ä¼šç»è¿‡å¤šä¸ªæœåŠ¡ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">ç”¨æˆ·è¯·æ±‚ â†’ ç”¨æˆ·æœåŠ¡ â†’ å•†å“æœåŠ¡ â†’ åº“å­˜æœåŠ¡
<span class="hljs-code">                  â†“
              è®¢å•æœåŠ¡ â†’ æ”¯ä»˜æœåŠ¡
</span></code></pre>
<p>å½“æŸä¸ªè¯·æ±‚å‡ºç°æ€§èƒ½é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬é¢ä¸´çš„å›°å¢ƒæ˜¯ï¼š</p>
<ol>
<li><strong>æ— æ³•å…³è”æ—¥å¿—</strong>ï¼šæ¯ä¸ªæœåŠ¡éƒ½æœ‰è‡ªå·±çš„æ—¥å¿—ï¼Œä½†ä½ ä¸çŸ¥é“å“ªäº›æ—¥å¿—å±äºåŒä¸€ä¸ªè¯·æ±‚</li>
<li><strong>æ— æ³•å®šä½ç“¶é¢ˆ</strong>ï¼šæ€»è€—æ—¶10ç§’ï¼Œä½†ä¸çŸ¥é“æ…¢åœ¨å“ªä¸ªæœåŠ¡ã€å“ªä¸ªè°ƒç”¨ç¯èŠ‚</li>
<li><strong>æ— æ³•è¿½è¸ªå¼‚æ­¥</strong>ï¼šå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œå·²ç»è„±ç¦»äº†åŸå§‹è¯·æ±‚çš„ä¸Šä¸‹æ–‡</li>
</ol>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦é“¾è·¯è¿½è¸ªã€‚</p>
<h2 data-id="heading-2">äºŒã€é“¾è·¯è¿½è¸ªçš„æœ¬è´¨ï¼šç»™è¯·æ±‚ä¸€ä¸ªå…¨å±€èº«ä»½</h2>
<h3 data-id="heading-3">2.1 æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ˜¯<strong>ç»™æ¯ä¸ªè¯·æ±‚åˆ†é…ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„IDï¼ˆtraceIdï¼‰ï¼Œå¹¶åœ¨æ•´ä¸ªè°ƒç”¨é“¾ä¸­ä¼ é€’è¿™ä¸ªID</strong>ã€‚</p>
<p>æƒ³è±¡ä¸€ä¸‹å¿«é€’åŒ…è£¹ï¼š</p>
<ul>
<li><strong>traceId</strong> å°±æ˜¯å¿«é€’å•å·ï¼Œä»å‘è´§åˆ°æ”¶è´§å§‹ç»ˆä¸å˜</li>
<li><strong>spanId</strong> å°±æ˜¯æ¯ä¸ªä¸­è½¬ç«™çš„è®°å½•ï¼Œæ¯åˆ°ä¸€ä¸ªç«™ç‚¹éƒ½æœ‰æ–°çš„ç¼–å·</li>
</ul>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[æµè§ˆå™¨] --&gt;|traceId: abc123&lt;br/&gt;spanId: span1| B[ç”¨æˆ·æœåŠ¡]
    B --&gt;|traceId: abc123&lt;br/&gt;spanId: span2| C[å•†å“æœåŠ¡]
    C --&gt;|traceId: abc123&lt;br/&gt;spanId: span3| D[åº“å­˜æœåŠ¡]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
</code></pre>
<p>è¿™æ ·ï¼Œå½“ä½ åœ¨æ—¥å¿—ç³»ç»Ÿä¸­æœç´¢ <code>traceId: abc123</code> æ—¶ï¼Œå°±èƒ½æ‰¾åˆ°è¿™ä¸ªè¯·æ±‚åœ¨æ‰€æœ‰æœåŠ¡ä¸­çš„æ‰€æœ‰æ—¥å¿—ã€‚</p>
<h3 data-id="heading-4">2.2 W3C Trace Context æ ‡å‡†</h3>
<p>Spring Boot 3 é‡‡ç”¨ W3C Trace Context æ ‡å‡†ï¼Œé€šè¿‡ HTTP å¤´ <code>traceparent</code> ä¼ é€’é“¾è·¯ä¿¡æ¯ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">traceparent: 00-4bf92f3577b34da6a3ce929d0e0e4736-00f067aa0ba902b7-01</span>
             â†‘  â†‘                                â†‘                  â†‘
             â”‚  â””â”€ traceId (32ä½16è¿›åˆ¶)          â””â”€ spanId (16ä½)   â””â”€ æ ‡å¿—ä½
             â””â”€ ç‰ˆæœ¬å·
</code></pre>
<p>åªéœ€è¦å…³æ³¨ä¸¤ä¸ªå­—æ®µï¼š</p>
<ul>
<li><strong>traceId</strong>ï¼šè¿™æ¬¡è¯·æ±‚çš„å…¨å±€IDï¼Œæ‰€æœ‰æœåŠ¡å…±äº«</li>
<li><strong>spanId</strong>ï¼šå½“å‰æœåŠ¡/æ­¥éª¤çš„IDï¼Œæ¯ä¸ªæœåŠ¡éƒ½ä¸åŒ</li>
</ul>
<h2 data-id="heading-5">ä¸‰ã€åŸç†è§£æï¼šMicrometer Tracing æ¶æ„</h2>
<h3 data-id="heading-6">3.1 ä» Spring Cloud Sleuth åˆ° Micrometer</h3>
<p>Spring Boot 2.x æ—¶ä»£ï¼Œé“¾è·¯è¿½è¸ªç”± Spring Cloud Sleuth è´Ÿè´£ã€‚åˆ°äº† Spring Boot 3.xï¼Œå®˜æ–¹å°†é“¾è·¯è¿½è¸ªæ•´åˆåˆ° Micrometer ç”Ÿæ€ï¼š</p>

























<table><thead><tr><th>ç»„ä»¶</th><th>èŒè´£</th></tr></thead><tbody><tr><td><code>micrometer-observation</code></td><td>è§‚æµ‹æŠ½è±¡å±‚ï¼Œç»Ÿä¸€æŒ‡æ ‡ã€è¿½è¸ªã€æ—¥å¿—</td></tr><tr><td><code>micrometer-tracing</code></td><td>é“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ¥å£</td></tr><tr><td><code>micrometer-tracing-bridge-brave</code></td><td>ä¸ Braveï¼ˆZipkinï¼‰çš„æ¡¥æ¥å®ç°</td></tr><tr><td><code>context-propagation</code></td><td>ä¸Šä¸‹æ–‡ä¼ æ’­ï¼ˆå¤šçº¿ç¨‹åœºæ™¯ï¼‰</td></tr></tbody></table>
<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š<strong>é“¾è·¯è¿½è¸ªä¸å†æ˜¯å­¤ç«‹çš„åŠŸèƒ½ï¼Œè€Œæ˜¯æ•´ä¸ªå¯è§‚æµ‹æ€§ä½“ç³»çš„ä¸€éƒ¨åˆ†</strong>ã€‚</p>
<h3 data-id="heading-7">3.2 æ•´ä½“å·¥ä½œæµç¨‹</h3>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart TB
    subgraph Client[å®¢æˆ·ç«¯/ç½‘å…³]
        A[HTTP è¯·æ±‚]
        A --&gt; B{æ˜¯å¦æœ‰&lt;br/&gt;traceparent?}
        B --&gt;|æœ‰| C[å¤ç”¨ traceId]
        B --&gt;|æ— | D[ç”Ÿæˆæ–° traceId]
    end
    
    subgraph Service1[ç”¨æˆ·æœåŠ¡]
        E[HTTP Filter] --&gt; F[W3CPropagation&lt;br/&gt;æå–å™¨]
        F --&gt; G[TraceContext&lt;br/&gt;ç»‘å®šåˆ° ThreadLocal]
        G --&gt; H[ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ]
        H --&gt; I{éœ€è¦è°ƒç”¨&lt;br/&gt;ä¸‹æ¸¸æœåŠ¡?}
        I --&gt;|æ˜¯| J[W3CPropagation&lt;br/&gt;æ³¨å…¥å™¨]
    end
    
    subgraph Service2[å•†å“æœåŠ¡]
        K[HTTP Filter] --&gt; L[æå– traceparent]
        L --&gt; M[ç»§æ‰¿ traceId&lt;br/&gt;åˆ›å»ºæ–° spanId]
    end
    
    C --&gt; E
    D --&gt; E
    J --&gt; K
    
    style Client fill:#e1f5ff
    style Service1 fill:#fff4e1
    style Service2 fill:#ffe1f5
</code></pre>
<p>æ ¸å¿ƒæµç¨‹åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li><strong>å…¥å£é˜¶æ®µ</strong>ï¼šHTTP Filter æ‹¦æˆªè¯·æ±‚ï¼Œæå–æˆ–åˆ›å»º TraceContext</li>
<li><strong>ç»‘å®šé˜¶æ®µ</strong>ï¼šå°† TraceContext ç»‘å®šåˆ°å½“å‰çº¿ç¨‹çš„ ThreadLocal</li>
<li><strong>ä¼ æ’­é˜¶æ®µ</strong>ï¼šè°ƒç”¨ä¸‹æ¸¸æœåŠ¡æ—¶ï¼Œå°† TraceContext æ³¨å…¥åˆ° HTTP è¯·æ±‚å¤´</li>
</ol>
<h3 data-id="heading-8">3.3 å…³é”®ç»„ä»¶ï¼šW3CPropagation</h3>
<p><code>W3CPropagation</code> æ˜¯ Micrometer Tracing ä¸­è´Ÿè´£ <code>traceparent</code> è§£æå’Œæ³¨å…¥çš„æ ¸å¿ƒç»„ä»¶ã€‚å®ƒæœ‰ä¸¤ä¸ªå…³é”®æ–¹æ³•ï¼š</p>
<p><strong>æå–å™¨ï¼ˆExtractorï¼‰</strong>ï¼šä» HTTP è¯·æ±‚ä¸­è¯»å– <code>traceparent</code></p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ªä»£ç å±•ç¤ºæ€è·¯</span>
TraceContext <span class="hljs-title function_">extract</span><span class="hljs-params">(HttpRequest request)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">traceparent</span> <span class="hljs-operator">=</span> request.getHeader(<span class="hljs-string">"traceparent"</span>);
    <span class="hljs-keyword">if</span> (traceparent != <span class="hljs-literal">null</span>) {
        <span class="hljs-comment">// è§£æï¼š00-&lt;traceId&gt;-&lt;spanId&gt;-01</span>
        <span class="hljs-keyword">return</span> parseTraceContext(traceparent);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// æ²¡æœ‰æ‰¾åˆ°ï¼Œéœ€è¦åˆ›å»ºæ–°çš„</span>
}
</code></pre>
<p><strong>æ³¨å…¥å™¨ï¼ˆInjectorï¼‰</strong>ï¼šå°† TraceContext å†™å…¥ HTTP è¯·æ±‚å¤´</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// ä¼ªä»£ç å±•ç¤ºæ€è·¯</span>
<span class="hljs-keyword">void</span> <span class="hljs-title function_">inject</span><span class="hljs-params">(TraceContext context, HttpRequest request)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">traceparent</span> <span class="hljs-operator">=</span> format(
        <span class="hljs-string">"00-%s-%s-01"</span>,
        context.traceId(),
        context.spanId()
    );
    request.setHeader(<span class="hljs-string">"traceparent"</span>, traceparent);
}
</code></pre>
<h2 data-id="heading-9">å››ã€ä¸‰ç§è°ƒç”¨æ–¹å¼çš„ä¼ æ’­æœºåˆ¶</h2>
<p>åœ¨ Spring Boot 3 ä¸­ï¼Œé“¾è·¯è¿½è¸ªå¯¹ä¸‰ç§ä¸»è¦è°ƒç”¨æ–¹å¼æä¾›äº†è‡ªåŠ¨æ”¯æŒï¼š</p>
<h3 data-id="heading-10">4.1 RestTemplateï¼šåŒæ­¥ HTTP è°ƒç”¨</h3>
<p><strong>ä¼ æ’­æœºåˆ¶</strong>ï¼šé€šè¿‡æ‹¦æˆªå™¨åœ¨å‘é€è¯·æ±‚å‰æ³¨å…¥ <code>traceparent</code></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant A as ç”¨æˆ·æœåŠ¡&lt;br/&gt;(traceId: abc)
    participant B as RestTemplate&lt;br/&gt;æ‹¦æˆªå™¨
    participant C as å•†å“æœåŠ¡

    A-&gt;&gt;B: restTemplate.get(...)
    Note over B: ä» ThreadLocal&lt;br/&gt;è·å– TraceContext
    Note over B: åˆ›å»ºæ–° spanId
    B-&gt;&gt;C: HTTP Request&lt;br/&gt;traceparent: 00-abc-span2-01
    Note over C: æå– traceparent
    C--&gt;&gt;B: HTTP Response
    B--&gt;&gt;A: è¿”å›ç»“æœ
    
    rect rgb(255, 244, 225)
    Note over A,C: traceId ä¿æŒä¸å˜ï¼šabc&lt;br/&gt;spanId ä¸åŒï¼šspan1 â†’ span2
    end
</code></pre>
<p><strong>è‡ªåŠ¨é…ç½®åŸç†</strong>ï¼šSpring Boot 3 ä¼šè‡ªåŠ¨ä¸º <code>RestTemplate</code> bean æ·»åŠ  <code>TracingClientHttpRequestInterceptor</code></p>
<p>ä½ åªéœ€è¦æ­£å¸¸ä½¿ç”¨ RestTemplateï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Autowired</span>
<span class="hljs-keyword">private</span> RestTemplate restTemplate;

<span class="hljs-keyword">public</span> Product <span class="hljs-title function_">getProduct</span><span class="hljs-params">(String productId)</span> {
    <span class="hljs-comment">// æ¡†æ¶ä¼šè‡ªåŠ¨æ³¨å…¥ traceparent</span>
    <span class="hljs-keyword">return</span> restTemplate.getForObject(
        <span class="hljs-string">"http://product-service/api/product/"</span> + productId,
        Product.class
    );
}
</code></pre>
<h3 data-id="heading-11">4.2 OpenFeignï¼šå£°æ˜å¼ HTTP è°ƒç”¨</h3>
<p><strong>ä¼ æ’­æœºåˆ¶</strong>ï¼šé€šè¿‡ Feign æ‹¦æˆªå™¨åœ¨æ„é€ è¯·æ±‚æ—¶æ³¨å…¥ <code>traceparent</code></p>
<pre><code class="hljs language-mermaid" lang="mermaid">sequenceDiagram
    participant A as ç”¨æˆ·æœåŠ¡&lt;br/&gt;(traceId: abc)
    participant B as Feign&lt;br/&gt;æ‹¦æˆªå™¨
    participant C as å•†å“æœåŠ¡

    A-&gt;&gt;B: productClient.getProduct(id)
    Note over B: ä» ThreadLocal&lt;br/&gt;è·å– TraceContext
    Note over B: åˆ›å»ºæ–° spanId
    B-&gt;&gt;C: HTTP Request&lt;br/&gt;traceparent: 00-abc-span2-01
    Note over C: æå– traceparent
    C--&gt;&gt;B: HTTP Response
    B--&gt;&gt;A: è¿”å›ç»“æœ
    
    rect rgb(255, 225, 245)
    Note over A,C: ä¸ RestTemplate æœ¬è´¨ç›¸åŒ&lt;br/&gt;åªæ˜¯æ‹¦æˆªç‚¹ä¸åŒ
    end
</code></pre>
<p><strong>å…³é”®ä¾èµ–</strong>ï¼šéœ€è¦åŒæ—¶å¼•å…¥ <code>spring-cloud-starter-openfeign</code> å’Œ <code>micrometer-tracing-bridge-brave</code></p>
<p>ä½¿ç”¨æ–¹å¼å®Œå…¨é€æ˜ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@FeignClient(name = "product-service")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ProductFeignClient</span> {
    <span class="hljs-meta">@GetMapping("/api/product/{id}")</span>
    Product <span class="hljs-title function_">getProduct</span><span class="hljs-params">(<span class="hljs-meta">@PathVariable</span> String id)</span>;
}
</code></pre>
<h3 data-id="heading-12">4.3 å¼‚æ­¥è°ƒç”¨ï¼šæœ€å®¹æ˜“å‡ºé—®é¢˜çš„åœºæ™¯</h3>
<p><strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼šæ–°çº¿ç¨‹æ— æ³•è®¿é—®ä¸»çº¿ç¨‹çš„ ThreadLocal</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    A[ä¸»çº¿ç¨‹&lt;br/&gt;traceId: abc&lt;br/&gt;spanId: span1] --&gt;|æäº¤ä»»åŠ¡| B[çº¿ç¨‹æ± ]
    B --&gt; C[å·¥ä½œçº¿ç¨‹&lt;br/&gt;traceId: ???&lt;br/&gt;spanId: ???]
    
    style A fill:#fff4e1
    style C fill:#ffcccc
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šContext Propagation åº“</p>
<p>åŸç†æ˜¯åœ¨æäº¤ä»»åŠ¡æ—¶"æ‹å¿«ç…§"ï¼Œåœ¨æ‰§è¡Œä»»åŠ¡æ—¶"æ¢å¤å¿«ç…§"ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    subgraph Main[ä¸»çº¿ç¨‹]
        A[TraceContext&lt;br/&gt;in ThreadLocal]
        B[captureAll&lt;br/&gt;æ‹å¿«ç…§]
    end
    
    subgraph Pool[çº¿ç¨‹æ± ]
        C[Runnable&lt;br/&gt;åŒ…è£…]
    end
    
    subgraph Worker[å·¥ä½œçº¿ç¨‹]
        D[setThreadLocals&lt;br/&gt;æ¢å¤å¿«ç…§]
        E[æ‰§è¡Œä»»åŠ¡&lt;br/&gt;traceId å¯ç”¨]
    end
    
    A --&gt; B
    B --&gt; C
    C --&gt; D
    D --&gt; E
    
    style Main fill:#e1f5ff
    style Pool fill:#fff4e1
    style Worker fill:#e1ffe1
</code></pre>
<p><strong>å®ç°ä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Bean(name = "taskExecutor")</span>
<span class="hljs-keyword">public</span> Executor <span class="hljs-title function_">taskExecutor</span><span class="hljs-params">()</span> {
    <span class="hljs-type">ThreadPoolTaskExecutor</span> <span class="hljs-variable">executor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThreadPoolTaskExecutor</span>();
    executor.setCorePoolSize(<span class="hljs-number">5</span>);
    executor.setMaxPoolSize(<span class="hljs-number">10</span>);
    
    <span class="hljs-comment">// å…³é”®ï¼šä½¿ç”¨ TaskDecorator ä¼ é€’ä¸Šä¸‹æ–‡</span>
    executor.setTaskDecorator(runnable -&gt; {
        <span class="hljs-comment">// ä¸»çº¿ç¨‹ä¸­æ‹å¿«ç…§</span>
        <span class="hljs-type">ContextSnapshot</span> <span class="hljs-variable">snapshot</span> <span class="hljs-operator">=</span> ContextSnapshot.captureAll();
        
        <span class="hljs-keyword">return</span> () -&gt; {
            <span class="hljs-comment">// å·¥ä½œçº¿ç¨‹ä¸­æ¢å¤å¿«ç…§</span>
            <span class="hljs-keyword">try</span> (ContextSnapshot.<span class="hljs-type">Scope</span> <span class="hljs-variable">scope</span> <span class="hljs-operator">=</span> snapshot.setThreadLocals()) {
                runnable.run();
            }
        };
    });
    
    executor.initialize();
    <span class="hljs-keyword">return</span> executor;
}
</code></pre>
<p>é…åˆ <code>@Async</code> ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Async("taskExecutor")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processAsync</span><span class="hljs-params">(String userId)</span> {
    <span class="hljs-comment">// è¿™é‡Œå¯ä»¥æ­£å¸¸è·å– traceId</span>
    log.info(<span class="hljs-string">"å¼‚æ­¥å¤„ç†ç”¨æˆ·: {}"</span>, userId);
}
</code></pre>
<h2 data-id="heading-13">äº”ã€å®æˆ˜éªŒè¯ï¼šçœ‹æ—¥å¿—å°±çŸ¥é“å¯¹ä¸å¯¹</h2>
<h3 data-id="heading-14">5.1 æ—¥å¿—æ ¼å¼é…ç½®</h3>
<p>åœ¨ <code>logback-spring.xml</code> ä¸­é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">pattern</span>&gt;</span>
    %d{yyyy-MM-dd HH:mm:ss.SSS} %5p [%X{traceId},%X{spanId}] --- [%15.15t] %-40.40logger{39} : %m%n
<span class="hljs-tag">&lt;/<span class="hljs-name">pattern</span>&gt;</span>
</code></pre>
<p>è¿™æ ·æ—¥å¿—ä¼šè‡ªåŠ¨åŒ…å« traceId å’Œ spanIdï¼š</p>
<pre><code class="hljs language-ini" lang="ini">2025-01-19 10:30:45.123  INFO <span class="hljs-section">[693e7d733e60746092fcdb114196f430,92fcdb114196f430]</span> --- <span class="hljs-section">[nio-8081-exec-1]</span> c.s.user.controller.UserController : æ”¶åˆ°è¯·æ±‚
</code></pre>
<h3 data-id="heading-15">5.2 éªŒè¯ RestTemplate è°ƒç”¨</h3>
<p>å¯åŠ¨ç”¨æˆ·æœåŠ¡å’Œå•†å“æœåŠ¡ï¼Œè°ƒç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:8081/user/rest/U001
</code></pre>
<p>è§‚å¯Ÿæ—¥å¿—ï¼š</p>
<p><strong>ç”¨æˆ·æœåŠ¡</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">INFO <span class="hljs-section">[abc123,span1]</span> --- <span class="hljs-section">[nio-8081-exec-1]</span> UserController : ã€ç”¨æˆ·æœåŠ¡ã€‘æ”¶åˆ°è¯·æ±‚ U001
INFO <span class="hljs-section">[abc123,span1]</span> --- <span class="hljs-section">[nio-8081-exec-1]</span> UserController : ã€ç”¨æˆ·æœåŠ¡ã€‘è°ƒç”¨å•†å“æœåŠ¡
</code></pre>
<p><strong>å•†å“æœåŠ¡</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">INFO <span class="hljs-selector-attr">[abc123,span2]</span> --- <span class="hljs-selector-attr">[nio-8082-exec-1]</span> ProductController : ã€å•†å“æœåŠ¡ã€‘æ”¶åˆ°è¯·æ±‚ P001
</code></pre>
<p><strong>éªŒè¯ç‚¹</strong>ï¼š</p>
<ul>
<li>traceId ç›¸åŒï¼š<code>abc123</code></li>
<li>spanId ä¸åŒï¼šç”¨æˆ·æœåŠ¡æ˜¯ <code>span1</code>ï¼Œå•†å“æœåŠ¡æ˜¯ <code>span2</code></li>
</ul>
<h3 data-id="heading-16">5.3 éªŒè¯å¼‚æ­¥è°ƒç”¨</h3>
<p>è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">curl http://localhost:8081/user/async/U003
</code></pre>
<p>è§‚å¯Ÿæ—¥å¿—ï¼š</p>
<p><strong>ä¸»çº¿ç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">INFO <span class="hljs-selector-attr">[abc123,span1]</span> --- <span class="hljs-selector-attr">[nio-8081-exec-1]</span> UserController : ã€ç”¨æˆ·æœåŠ¡-å¼‚æ­¥ã€‘æ”¶åˆ°è¯·æ±‚ U003
</code></pre>
<p><strong>å¼‚æ­¥çº¿ç¨‹ï¼ˆasync-1ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">INFO <span class="hljs-section">[abc123,span1]</span> --- <span class="hljs-section">[async-1]</span> AsyncService : ã€å¼‚æ­¥ä»»åŠ¡ã€‘å¼€å§‹æ‰§è¡Œ U003
INFO <span class="hljs-section">[abc123,span1]</span> --- <span class="hljs-section">[async-1]</span> AsyncService : ã€å¼‚æ­¥ä»»åŠ¡ã€‘æ‰§è¡Œå®Œæˆ
</code></pre>
<p><strong>å¼‚æ­¥çº¿ç¨‹è°ƒç”¨å•†å“æœåŠ¡ï¼ˆasync-2ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">INFO <span class="hljs-selector-attr">[abc123,span1]</span> --- <span class="hljs-selector-attr">[async-2]</span> AsyncService : ã€å¼‚æ­¥è°ƒç”¨ã€‘å¼€å§‹è°ƒç”¨å•†å“æœåŠ¡
</code></pre>
<p><strong>å•†å“æœåŠ¡</strong>ï¼š</p>
<pre><code class="hljs language-css" lang="css">INFO <span class="hljs-selector-attr">[abc123,span2]</span> --- <span class="hljs-selector-attr">[nio-8082-exec-1]</span> ProductController : ã€å•†å“æœåŠ¡ã€‘æ”¶åˆ°è¯·æ±‚ P003
</code></pre>
<p><strong>éªŒè¯ç‚¹</strong>ï¼š</p>
<ul>
<li>ä¸»çº¿ç¨‹å’Œæ‰€æœ‰å¼‚æ­¥çº¿ç¨‹çš„ traceId éƒ½æ˜¯ <code>abc123</code></li>
<li>è¯æ˜ Context Propagation æˆåŠŸä¼ é€’äº†ä¸Šä¸‹æ–‡</li>
</ul>
<h2 data-id="heading-17">å…­ã€ä»åŸç†åˆ°æŠ½è±¡ï¼šç»Ÿä¸€è§†è§’ä¸‹çš„é“¾è·¯è¿½è¸ª</h2>
<p>å‰é¢æˆ‘ä»¬ä»æŠ€æœ¯ç»†èŠ‚çš„è§’åº¦ï¼Œè¯¦ç»†åˆ†æäº† Micrometer Tracing çš„å·¥ä½œåŸç†ï¼š</p>
<ul>
<li>W3C Trace Context æ ‡å‡†å¦‚ä½•å®šä¹‰ traceparent</li>
<li>W3CPropagation å¦‚ä½•æå–å’Œæ³¨å…¥ä¸Šä¸‹æ–‡</li>
<li>ä¸‰ç§è°ƒç”¨æ–¹å¼å„è‡ªçš„ä¼ æ’­æœºåˆ¶</li>
</ul>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»æ›´é«˜çš„æŠ½è±¡å±‚æ¬¡ï¼Œæç‚¼å‡ºé“¾è·¯è¿½è¸ªçš„æ ¸å¿ƒæ€æƒ³ã€‚</p>
<h3 data-id="heading-18">6.1 ä¸‰ä¸ªæ ¸å¿ƒæŠ½è±¡</h3>
<p>é€šè¿‡å¯¹ Micrometer Tracing çš„è§£æï¼Œå¯ä»¥æç‚¼å‡ºä¸‰ä¸ªæ ¸å¿ƒæŠ½è±¡ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph TB
    A[TraceContext&lt;br/&gt;é“¾è·¯ä¸Šä¸‹æ–‡] --&gt; B[W3CPropagation&lt;br/&gt;ä¼ æ’­åè®®]
    A --&gt; C[ContextSnapshot&lt;br/&gt;ä¸Šä¸‹æ–‡å¿«ç…§]
    
    B --&gt; D[HTTP è¯·æ±‚é—´ä¼ æ’­]
    C --&gt; E[çº¿ç¨‹é—´ä¼ æ’­]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
    style E fill:#ffe1e1
</code></pre>
<ol>
<li><strong>TraceContext</strong>ï¼šé“¾è·¯ä¸Šä¸‹æ–‡ï¼Œå­˜å‚¨ traceId å’Œ spanId</li>
<li><strong>W3CPropagation</strong>ï¼šåœ¨ HTTP è¯·æ±‚é—´ä¼ æ’­ä¸Šä¸‹æ–‡</li>
<li><strong>ContextSnapshot</strong>ï¼šåœ¨çº¿ç¨‹é—´ä¼ æ’­ä¸Šä¸‹æ–‡</li>
</ol>
<h3 data-id="heading-19">6.2 ç»Ÿä¸€çš„ä¼ æ’­æ¨¡å¼</h3>
<p>æ— è®ºæ˜¯ RestTemplateã€OpenFeign è¿˜æ˜¯å¼‚æ­¥è°ƒç”¨ï¼Œä¼ æ’­æ¨¡å¼éƒ½æ˜¯ç»Ÿä¸€çš„ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">flowchart LR
    A[å…¥å£æ‹¦æˆª] --&gt; B[æå–/åˆ›å»º&lt;br/&gt;TraceContext]
    B --&gt; C[ç»‘å®šåˆ°&lt;br/&gt;ThreadLocal]
    C --&gt; D[ä¸šåŠ¡é€»è¾‘]
    D --&gt; E{éœ€è¦ä¼ æ’­?}
    E --&gt;|HTTP è°ƒç”¨| F[æ³¨å…¥ HTTP å¤´]
    E --&gt;|å¼‚æ­¥ä»»åŠ¡| G[æ•è·å¿«ç…§]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
    style F fill:#ffe1e1
    style G fill:#f5e1ff
</code></pre>
<p><strong>ç»Ÿä¸€æµç¨‹</strong>ï¼š</p>
<ol>
<li>å…¥å£æ‹¦æˆªï¼ˆHTTP Filter æˆ–ä»»åŠ¡åŒ…è£…å™¨ï¼‰</li>
<li>æå–æˆ–åˆ›å»º TraceContext</li>
<li>ç»‘å®šåˆ°å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆThreadLocalï¼‰</li>
<li>ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ</li>
<li>éœ€è¦ä¼ æ’­æ—¶ï¼Œé€šè¿‡ä¸åŒæœºåˆ¶ä¼ å‡ºå»</li>
</ol>
<h3 data-id="heading-20">6.3 è®¾è®¡æ€æƒ³ï¼šåˆ†å±‚ä¸è‡ªåŠ¨åŒ–</h3>
<p>Micrometer Tracing çš„è®¾è®¡ä½“ç°äº†ä¸¤ä¸ªé‡è¦æ€æƒ³ï¼š</p>
<p><strong>åˆ†å±‚æŠ½è±¡</strong>ï¼š</p>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨å±‚ï¼ˆä¸šåŠ¡ä»£ç ï¼‰          â”‚  ä½ çš„ä»£ç æ— æ„ŸçŸ¥
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æ¡†æ¶å±‚ï¼ˆè‡ªåŠ¨é…ç½®ï¼‰          â”‚  Spring Boot è‡ªåŠ¨é…ç½®
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   æŠ½è±¡å±‚ï¼ˆMicrometerï¼‰        â”‚  ç»Ÿä¸€æ¥å£
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å®ç°å±‚ï¼ˆBrave/OTelï¼‰        â”‚  å¯æ’æ‹”çš„å®ç°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>è‡ªåŠ¨åŒ–åŸåˆ™</strong>ï¼š</p>
<ul>
<li>ä¸ä¿®æ”¹ä¸šåŠ¡ä»£ç å°±èƒ½æ¥å…¥</li>
<li>ä¸éœ€è¦æ‰‹åŠ¨ä¼ é€’ traceId</li>
<li>ä¸éœ€è¦å…³å¿ƒåº•å±‚å®ç°ï¼ˆBrave æˆ– OpenTelemetryï¼‰</li>
</ul>
<h2 data-id="heading-21">ä¸ƒã€æ€»ç»“ï¼šä»åŸç†ç†è§£åˆ°æŠ½è±¡è®¤çŸ¥</h2>
<h3 data-id="heading-22">åŸç†å±‚é¢çš„è®¤è¯†</h3>
<p>å›åˆ°æœ€å¼€å§‹çš„é—®é¢˜ï¼šå¦‚ä½•åœ¨å¾®æœåŠ¡è°ƒç”¨é“¾ä¸­è¿½è¸ªä¸€ä¸ªè¯·æ±‚ï¼Ÿ</p>
<p>ä»åŸç†å±‚é¢çœ‹ï¼Œç­”æ¡ˆæ˜¯ï¼š<strong>ç»™è¯·æ±‚åˆ†é…ä¸€ä¸ªå…¨å±€IDï¼ˆtraceIdï¼‰ï¼Œå¹¶é€šè¿‡ä¸åŒçš„ä¼ æ’­æœºåˆ¶ï¼Œåœ¨æ•´ä¸ªè°ƒç”¨é“¾ä¸­ä¼ é€’è¿™ä¸ªID</strong>ã€‚</p>
<p>Micrometer Tracing æä¾›äº†ä¸‰ç§ä¼ æ’­æœºåˆ¶ï¼š</p>

























<table><thead><tr><th>åœºæ™¯</th><th>ä¼ æ’­è½½ä½“</th><th>ä¼ æ’­æœºåˆ¶</th></tr></thead><tbody><tr><td>è·¨æœåŠ¡è°ƒç”¨ï¼ˆHTTPï¼‰</td><td>HTTP è¯·æ±‚å¤´</td><td>W3CPropagation æ³¨å…¥/æå–</td></tr><tr><td>è·¨çº¿ç¨‹è°ƒç”¨ï¼ˆå¼‚æ­¥ï¼‰</td><td>ä¸Šä¸‹æ–‡å¿«ç…§</td><td>ContextSnapshot æ•è·/æ¢å¤</td></tr><tr><td>åŒçº¿ç¨‹è°ƒç”¨</td><td>ThreadLocal</td><td>ç›´æ¥è®¿é—®</td></tr></tbody></table>
<h3 data-id="heading-23">æŠ½è±¡å±‚é¢çš„è®¤è¯†</h3>
<p>ä»æŠ½è±¡å±‚é¢çœ‹ï¼Œé“¾è·¯è¿½è¸ªçš„æœ¬è´¨æ˜¯<strong>ä¸Šä¸‹æ–‡ä¼ æ’­çš„è‡ªåŠ¨åŒ–</strong>ã€‚</p>
<p>æ•´ä¸ªä½“ç³»å»ºç«‹åœ¨ä¸¤ä¸ªåŸºç¡€ä¹‹ä¸Šï¼š</p>
<ol>
<li><strong>æ ‡å‡†åè®®</strong>ï¼šW3C Trace Contextï¼Œç¡®ä¿ä¸åŒç³»ç»Ÿé—´çš„äº’æ“ä½œæ€§</li>
<li><strong>ç»Ÿä¸€æŠ½è±¡</strong>ï¼šMicrometer Observationï¼Œå°†æŒ‡æ ‡ã€è¿½è¸ªã€æ—¥å¿—ç»Ÿä¸€ç®¡ç†</li>
</ol>
<p>Micrometer çš„è®¾è®¡å“²å­¦ä½“ç°åœ¨ï¼š</p>
<ul>
<li><strong>åˆ†å±‚è§£è€¦</strong>ï¼šåº”ç”¨å±‚ã€æ¡†æ¶å±‚ã€æŠ½è±¡å±‚ã€å®ç°å±‚å„å¸å…¶èŒ</li>
<li><strong>è‡ªåŠ¨åŒ–ä¼˜å…ˆ</strong>ï¼šä¸ä¿®æ”¹ä¸šåŠ¡ä»£ç å°±èƒ½æ¥å…¥</li>
<li><strong>æ ‡å‡†åŒ–é©±åŠ¨</strong>ï¼šéµå¾ª W3C ç­‰å›½é™…æ ‡å‡†</li>
</ul>
<h3 data-id="heading-24">é“¾è·¯è¿½è¸ªçš„ä»·å€¼</h3>
<p>æœ€åï¼Œé“¾è·¯è¿½è¸ªçš„ä»·å€¼ä¸ä»…ä»…åœ¨äº"æ‰¾åˆ°æ…¢åœ¨å“ª"ï¼Œæ›´åœ¨äºï¼š</p>
<ul>
<li><strong>å¯è§‚æµ‹æ€§</strong>ï¼šè®©ç³»ç»Ÿè¡Œä¸ºå¯è§</li>
<li><strong>å¯è¯Šæ–­æ€§</strong>ï¼šå¿«é€Ÿå®šä½é—®é¢˜æ ¹å› </li>
<li><strong>å¯ä¼˜åŒ–æ€§</strong>ï¼šåŸºäºæ•°æ®åšæ€§èƒ½ä¼˜åŒ–</li>
</ul>
<p>å½“ä½ åœ¨æ—¥å¿—ä¸­çœ‹åˆ°è¿™æ ·çš„è¾“å‡ºæ—¶ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp">[<span class="hljs-meta">abc123,span1</span>] ç”¨æˆ·æœåŠ¡æ”¶åˆ°è¯·æ±‚ï¼Œè€—æ—¶<span class="hljs-number">10</span>ms
[<span class="hljs-meta">abc123,span2</span>] å•†å“æœåŠ¡æŸ¥è¯¢æ•°æ®åº“ï¼Œè€—æ—¶<span class="hljs-number">5000</span>ms
[<span class="hljs-meta">abc123,span3</span>] åº“å­˜æœåŠ¡è°ƒç”¨ç¼“å­˜ï¼Œè€—æ—¶<span class="hljs-number">5</span>ms
</code></pre>
<p>ä½ ç«‹åˆ»å°±çŸ¥é“ï¼š<strong>ç“¶é¢ˆåœ¨å•†å“æœåŠ¡çš„æ•°æ®åº“æŸ¥è¯¢</strong>ã€‚</p>
<h3 data-id="heading-25">å†™åœ¨æœ€å</h3>
<p>ç†è§£äº†åŸç†ï¼Œæ‰èƒ½åœ¨å‡ºé—®é¢˜æ—¶å¿«é€Ÿå®šä½ï¼›
ç†è§£äº†æŠ½è±¡ï¼Œæ‰èƒ½è®¾è®¡å‡ºæ›´å¥½çš„ç³»ç»Ÿã€‚</p>
<p>å¸Œæœ›è¿™ä¸¤ç¯‡æ–‡ç« èƒ½å¸®ä½ ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç¯‡ï¼šå¿«é€Ÿè½åœ°é“¾è·¯è¿½è¸ª</li>
<li>ç¬¬äºŒç¯‡ï¼šæ·±åº¦ç†è§£èƒŒååŸç†</li>
</ul>
<p>è¿™å°±æ˜¯åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ªçš„åŠ›é‡ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å›æº¯ç®—æ³•ï¼šé€‰â†’é’»â†’é€€ï¼ŒæŒæ¡ç©·ä¸¾çš„è‰ºæœ¯]]></title>    <link>https://juejin.cn/post/7596926832912351295</link>    <guid>https://juejin.cn/post/7596926832912351295</guid>    <pubDate>2026-01-19T11:17:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912351295" data-draft-id="7596883689826861119" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å›æº¯ç®—æ³•ï¼šé€‰â†’é’»â†’é€€ï¼ŒæŒæ¡ç©·ä¸¾çš„è‰ºæœ¯"/> <meta itemprop="keywords" content="åç«¯,JavaScript,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-19T11:17:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢œé…±"/> <meta itemprop="url" content="https://juejin.cn/user/905653309941495"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å›æº¯ç®—æ³•ï¼šé€‰â†’é’»â†’é€€ï¼ŒæŒæ¡ç©·ä¸¾çš„è‰ºæœ¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/905653309941495/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢œé…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T11:17:39.000Z" title="Mon Jan 19 2026 11:17:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    61
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»32åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å›æº¯ç®—æ³•ï¼šé€‰â†’é’»â†’é€€ï¼ŒæŒæ¡ç©·ä¸¾çš„è‰ºæœ¯</h2>
<p>å›æº¯ç®—æ³•æ˜¯ç®—æ³•é¢†åŸŸçš„æ ¸å¿ƒæ€æƒ³ä¹‹ä¸€ï¼Œå°¤å…¶åœ¨å¤„ç†ã€Œç©·ä¸¾æ‰€æœ‰å¯èƒ½è§£ã€çš„é—®é¢˜æ—¶å ªç§°"ç¥å™¨"ã€‚æœ¬æ–‡å°†ä»æ ¸å¿ƒæ€è·¯å‡ºå‘ï¼Œé€šè¿‡"é€‰ä¸€ä¸ªæ•°â†’é’»åˆ°åº•â†’é€€å›æ¥åˆ æ‰è¿™ä¸ªæ•°â†’é€‰ä¸‹ä¸€ä¸ªæ•°â†’å†é’»åˆ°åº•"è¿™ä¸ªå›ºå®šèŠ‚å¥ï¼Œå¸¦ä½ å½»åº•æŒæ¡å›æº¯ç®—æ³•ã€‚</p>
<h3 data-id="heading-1">ä¸€ã€å›æº¯æ ¸å¿ƒåŸç†ï¼šé€‰â†’é’»â†’é€€çš„å›ºå®šèŠ‚å¥</h3>
<h4 data-id="heading-2">ä¸€å¥è¯è®°ç‰¢å›æº¯çš„æ‰§è¡Œè¿‡ç¨‹</h4>
<p><strong>é€‰ä¸€ä¸ªæ•°â†’é’»åˆ°åº•â†’é€€å›æ¥åˆ æ‰è¿™ä¸ªæ•°â†’é€‰ä¸‹ä¸€ä¸ªæ•°â†’å†é’»åˆ°åº•ï¼Œç›´åˆ°æ‰€æœ‰æ•°éƒ½è¯•å®Œï¼Œæœ€åæ”¶é›†æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è·¯å¾„ã€‚</strong></p>
<p>é€‰äº†å°±å¾€ä¸‹é’»ï¼Œèµ°ä¸é€šå°±é€€å›æ¥æ“¦è„šå°ï¼Œæ¢æ¡è·¯å†è¯•ã€‚å¾ˆå¤šäººä¸€å¼€å§‹éƒ½ä¼šè¢«é€’å½’çš„å¤šå±‚è°ƒç”¨ç»•æ™•ï¼Œä½†åªè¦æŠ“ä½ <strong>pushï¼ˆé€‰æ•°ï¼‰â†’ é€’å½’ï¼ˆé’»æ·±å±‚ï¼‰â†’ popï¼ˆæ“¦è„šå°ï¼‰</strong> è¿™ä¸ªå›ºå®šèŠ‚å¥ï¼Œå†ç»“åˆå‰ªææå‰æ­¢æŸï¼Œæ‰€æœ‰å›æº¯é¢˜éƒ½èƒ½å¥—æ¨¡æ¿è§£å†³ï½</p>
<h4 data-id="heading-3">æ ¸å¿ƒå››è¦ç´ </h4>
<p>ä»»ä½•å›æº¯é—®é¢˜éƒ½èƒ½æ‹†è§£ä¸ºä»¥ä¸‹4ä¸ªæ ¸å¿ƒéƒ¨åˆ†ï¼š</p>






























<table><thead><tr><th>è¦ç´ </th><th>ä½œç”¨</th><th>ç¤ºä¾‹ï¼ˆç»„åˆæ€»å’Œï¼‰</th></tr></thead><tbody><tr><td><strong>è·¯å¾„</strong></td><td>å·²ç»åšå‡ºçš„é€‰æ‹©ï¼ˆæ¯”å¦‚é€‰äº†å“ªäº›æ•°ï¼‰</td><td><code>path = [2,3]</code>ï¼ˆè¡¨ç¤ºé€‰äº†2å’Œ3ï¼‰</td></tr><tr><td><strong>é€‰æ‹©åˆ—è¡¨</strong></td><td>å½“å‰æ­¥éª¤å¯é€‰æ‹©çš„é€‰é¡¹ï¼ˆæ¯”å¦‚è¿˜èƒ½é€‰å“ªäº›æ•°ï¼‰</td><td><code>nums = [2,3,6,7]</code>ï¼Œå·²é€‰2åˆ™å¯é€‰3/6/7</td></tr><tr><td><strong>ç»ˆæ­¢æ¡ä»¶</strong></td><td>ä»€ä¹ˆæ—¶å€™åœæ­¢æ¢ç´¢ï¼ˆæ‰¾åˆ°è§£/èµ°åˆ°åº•ï¼‰</td><td>è·¯å¾„å’Œç­‰äºç›®æ ‡å€¼ï¼Œæˆ–è·¯å¾„å’Œè¶…è¿‡ç›®æ ‡å€¼</td></tr><tr><td><strong>å‰ªæ</strong></td><td>æå‰æ’é™¤æ— æ•ˆè·¯å¾„ï¼ˆæ ¸å¿ƒä¼˜åŒ–ï¼‰</td><td>è·¯å¾„å’Œè¶…è¿‡ç›®æ ‡å€¼ï¼Œç›´æ¥åœæ­¢å½“å‰è·¯å¾„</td></tr></tbody></table>
<h4 data-id="heading-4">å…³é”®ç†è§£</h4>
<ul>
<li><strong>é€’å½’æ˜¯"å¾€ä¸‹é’»"</strong>ï¼šæ¯é€‰ä¸€ä¸ªæ•°ï¼Œå°±é€’å½’è°ƒç”¨backtrackï¼Œç›¸å½“äº"å¾€ä¸‹èµ°ä¸€æ­¥"</li>
<li><strong>return æ˜¯"å¾€å›é€€"</strong>ï¼šè§¦å‘ç»ˆæ­¢æ¡ä»¶ï¼ˆæ‰¾åˆ°è§£/å’Œè¶…äº†ï¼‰ï¼Œå°±ç»“æŸå½“å‰é€’å½’ï¼Œå›åˆ°ä¸Šä¸€å±‚</li>
<li><strong>pop æ˜¯"æ“¦è„šå°"</strong>ï¼šå›åˆ°ä¸Šä¸€å±‚åï¼Œå¿…é¡»æ‰§è¡Œ<code>path.pop()</code>ï¼ŒæŠŠåˆšæ‰é€‰çš„æ•°åˆ æ‰ï¼Œæ‰èƒ½"æ¢å¦ä¸€ä¸ªæ•°é€‰"</li>
<li><strong>for å¾ªç¯æ˜¯"é€‰å²”è·¯"</strong>ï¼šæ¯ä¸€å±‚çš„ for å¾ªç¯ï¼Œå°±æ˜¯åœ¨å½“å‰ä½ç½®é€‰ä¸åŒçš„æ•°ï¼ˆå²”è·¯ï¼‰ï¼Œè¯•å®Œä¸€æ¡å†è¯•ä¸‹ä¸€æ¡</li>
</ul>
<h4 data-id="heading-5">é€šç”¨æ¨¡æ¿</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å›æº¯æ ¸å¿ƒå‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">è·¯å¾„, é€‰æ‹©åˆ—è¡¨, å…¶ä»–å‚æ•°</span>) {
  <span class="hljs-comment">// 1. ç»ˆæ­¢æ¡ä»¶ï¼šæ‰¾åˆ°è§£ï¼Œè®°å½•ç»“æœå¹¶è¿”å›</span>
  <span class="hljs-keyword">if</span> (æ»¡è¶³ç»ˆæ­¢æ¡ä»¶) {
    ç»“æœåˆ—è¡¨.<span class="hljs-title function_">push</span>(è·¯å¾„çš„æ‹·è´); <span class="hljs-comment">// æ³¨æ„ï¼šè¦æ‹·è´ï¼Œå¦åˆ™ä¼šè¢«åç»­ä¿®æ”¹</span>
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// 2. éå†æ‰€æœ‰å¯é€‰é€‰é¡¹</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> é€‰é¡¹ <span class="hljs-keyword">of</span> é€‰æ‹©åˆ—è¡¨) {
    <span class="hljs-comment">// å‰ªæï¼šæå‰æ’é™¤æ— æ•ˆé€‰é¡¹ï¼ˆå…³é”®ä¼˜åŒ–ï¼‰</span>
    <span class="hljs-keyword">if</span> (é€‰é¡¹æ— æ•ˆ) <span class="hljs-keyword">continue</span>;

    <span class="hljs-comment">// 3. åšé€‰æ‹©ï¼šæŠŠå½“å‰é€‰é¡¹åŠ å…¥è·¯å¾„ï¼ˆé€‰æ•°ï¼‰</span>
    è·¯å¾„.<span class="hljs-title function_">push</span>(é€‰é¡¹);

    <span class="hljs-comment">// 4. é€’å½’æ¢ç´¢ï¼šåŸºäºå½“å‰é€‰æ‹©ï¼Œç»§ç»­å¾€ä¸‹èµ°ï¼ˆé’»åˆ°åº•ï¼‰</span>
    <span class="hljs-title function_">backtrack</span>(è·¯å¾„, æ–°çš„é€‰æ‹©åˆ—è¡¨, å…¶ä»–å‚æ•°);

    <span class="hljs-comment">// 5. æ’¤é”€é€‰æ‹©ï¼ˆå›æº¯æ ¸å¿ƒï¼‰ï¼šå›åˆ°ä¸Šä¸€æ­¥ï¼Œæ¢é€‰é¡¹ï¼ˆé€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°ï¼‰</span>
    è·¯å¾„.<span class="hljs-title function_">pop</span>();
  }
}

<span class="hljs-comment">// ä¸»å‡½æ•°</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">solveProblem</span>(<span class="hljs-params">å‚æ•°</span>) {
  <span class="hljs-keyword">const</span> ç»“æœåˆ—è¡¨ = []; <span class="hljs-comment">// å­˜å‚¨æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è§£</span>
  <span class="hljs-title function_">backtrack</span>([], åˆå§‹é€‰æ‹©åˆ—è¡¨, åˆå§‹å‚æ•°); <span class="hljs-comment">// åˆå§‹è·¯å¾„ä¸ºç©º</span>
  <span class="hljs-keyword">return</span> ç»“æœåˆ—è¡¨;
}
</code></pre>
<h3 data-id="heading-6">äºŒã€å…¥é—¨ç¤ºä¾‹ï¼šç»„åˆæ€»å’Œï¼ˆå¯è§†åŒ–ç†è§£ï¼‰</h3>
<p>ä¸ºäº†è®©ä½ å¿«é€Ÿç†è§£å›æº¯çš„æ ¸å¿ƒèŠ‚å¥ï¼Œæˆ‘ä»¬å…ˆä»<strong>ç»„åˆæ€»å’Œ</strong>è¿™ä¸ªç»å…¸å…¥é—¨é¢˜å…¥æ‰‹ï¼Œé€šè¿‡å¯è§†åŒ–æ‰“å°å®Œæ•´å±•ç¤ºã€Œé€‰â†’æ¢â†’æ’¤ã€çš„å…¨è¿‡ç¨‹ã€‚</p>
<h4 data-id="heading-7">é¢˜ç›®æè¿°</h4>
<p>ç»™å®šä¸€ä¸ªæ— é‡å¤å…ƒç´ çš„æ•°ç»„ <code>candidates</code> å’Œä¸€ä¸ªç›®æ ‡æ•° <code>target</code>ï¼Œæ‰¾å‡º <code>candidates</code> ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º <code>target</code> çš„ç»„åˆï¼ˆæ•°å­—å¯ä»¥æ— é™åˆ¶é‡å¤è¢«é€‰å–ï¼‰ã€‚</p>
<ul>
<li>ç¤ºä¾‹ï¼šè¾“å…¥ <code>candidates = [2,3,7]</code>ï¼Œ<code>target = 7</code>ï¼Œè¾“å‡º <code>[[2,2,3],[7]]</code>ã€‚</li>
</ul>
<h4 data-id="heading-8">å®Œæ•´ä»£ç å®ç°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">/**
 * ç»„åˆæ€»å’Œï¼šæ‰¾æ‰€æœ‰å’Œä¸ºç›®æ ‡å€¼çš„ç»„åˆï¼ˆå¯è§†åŒ–æ‰“å°ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number[]</span>} <span class="hljs-variable">candidates</span> - å€™é€‰æ•°ç»„
 * <span class="hljs-doctag">@param</span> {<span class="hljs-type">number</span>} <span class="hljs-variable">target</span> - ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">number[][]</span>} - æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆ
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum</span>(<span class="hljs-params">candidates, target</span>) {
  <span class="hljs-keyword">const</span> result = []; <span class="hljs-comment">// å­˜å‚¨æœ€ç»ˆç»“æœ</span>
  candidates.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b); <span class="hljs-comment">// æ’åºä¾¿äºå‰ªæ</span>
  <span class="hljs-keyword">let</span> recursionLevel = <span class="hljs-number">0</span>; <span class="hljs-comment">// æ ‡è®°é€’å½’å±‚çº§ï¼Œç”¨äºå¯è§†åŒ–ç¼©è¿›</span>

  <span class="hljs-comment">// å›æº¯å‡½æ•°ï¼špath=å½“å‰è·¯å¾„ï¼Œsum=å½“å‰è·¯å¾„å’Œï¼Œstart=èµ·å§‹ç´¢å¼•ï¼ˆé¿å…é‡å¤ç»„åˆï¼‰</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path, sum, start</span>) {
    <span class="hljs-comment">// å±‚çº§+1ï¼Œç”Ÿæˆç¼©è¿›ï¼ˆæ¯çº§2ä¸ªç©ºæ ¼ï¼‰</span>
    recursionLevel++;
    <span class="hljs-keyword">const</span> indent = <span class="hljs-string">'  '</span>.<span class="hljs-title function_">repeat</span>(recursionLevel - <span class="hljs-number">1</span>);
    <span class="hljs-keyword">const</span> levelTag = <span class="hljs-string">`ã€å±‚çº§<span class="hljs-subst">${recursionLevel}</span>ã€‘`</span>;

    <span class="hljs-comment">// ğŸŸ¢ è°ƒç”¨é˜¶æ®µï¼šæ‰“å°å½“å‰å±‚çº§åˆå§‹çŠ¶æ€</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
      <span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸŸ¢ <span class="hljs-subst">${levelTag}</span> è°ƒç”¨é˜¶æ®µ â†’ path=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(path)}</span>, sum=<span class="hljs-subst">${sum}</span>, start=<span class="hljs-subst">${start}</span>`</span>
    );

    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶1ï¼šè·¯å¾„å’Œç­‰äºç›®æ ‡å€¼ï¼Œè®°å½•ç»“æœ</span>
    <span class="hljs-keyword">if</span> (sum === target) {
      result.<span class="hljs-title function_">push</span>([...path]); <span class="hljs-comment">// æ‹·è´è·¯å¾„ï¼Œé¿å…åç»­ä¿®æ”¹</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">`<span class="hljs-subst">${indent}</span>âœ… <span class="hljs-subst">${levelTag}</span> æ‰¾åˆ°æœ‰æ•ˆç»„åˆ â†’ <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(path)}</span>ï¼Œresult=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>
      );
      <span class="hljs-comment">// å±‚çº§-1ï¼Œå‡†å¤‡è¿”å›</span>
      recursionLevel--;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”´ <span class="hljs-subst">${levelTag}</span> è¿”å›é˜¶æ®µ â†’ æ‰¾åˆ°è§£ï¼Œå›åˆ°ä¸Šä¸€å±‚`</span>);
      <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶2ï¼šè·¯å¾„å’Œè¶…è¿‡ç›®æ ‡å€¼ï¼Œç›´æ¥è¿”å›ï¼ˆå‰ªæï¼‰</span>
    <span class="hljs-keyword">if</span> (sum &gt; target) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸš« <span class="hljs-subst">${levelTag}</span> å‰ªæ â†’ sum=<span class="hljs-subst">${sum}</span> &gt; target=<span class="hljs-subst">${target}</span>ï¼Œç›´æ¥è¿”å›`</span>);
      recursionLevel--;
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”´ <span class="hljs-subst">${levelTag}</span> è¿”å›é˜¶æ®µ â†’ å‰ªæè¿”å›ï¼Œå›åˆ°ä¸Šä¸€å±‚`</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// éå†é€‰æ‹©åˆ—è¡¨ï¼ˆä»startå¼€å§‹ï¼Œé¿å…é‡å¤ç»„åˆï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; candidates.<span class="hljs-property">length</span>; i++) {
      <span class="hljs-keyword">const</span> num = candidates[i];
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ” <span class="hljs-subst">${levelTag}</span> éå†i=<span class="hljs-subst">${i}</span> â†’ å°è¯•é€‰æ•°å­—<span class="hljs-subst">${num}</span>ï¼Œå½“å‰sum=<span class="hljs-subst">${sum}</span>`</span>);

      <span class="hljs-comment">// æ’åºå‰ªæï¼šå½“å‰æ•°+å·²é€‰å’Œ&gt;ç›®æ ‡å€¼ï¼Œåç»­æ•°æ›´å¤§ï¼Œæ— éœ€ç»§ç»­</span>
      <span class="hljs-keyword">if</span> (sum + num &gt; target) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
          <span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸš« <span class="hljs-subst">${levelTag}</span> æ’åºå‰ªæ â†’ <span class="hljs-subst">${sum}</span>+<span class="hljs-subst">${num}</span>=<span class="hljs-subst">${sum + num}</span> &gt; <span class="hljs-subst">${target}</span>ï¼Œbreakå¾ªç¯`</span>
        );
        <span class="hljs-keyword">break</span>;
      }

      <span class="hljs-comment">// åšé€‰æ‹©ï¼šåŠ å…¥å½“å‰æ•°ï¼ˆé€‰æ•°ï¼‰</span>
      path.<span class="hljs-title function_">push</span>(num);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">`<span class="hljs-subst">${indent}</span>âœ… <span class="hljs-subst">${levelTag}</span> é€‰æ•°å­—<span class="hljs-subst">${num}</span> â†’ path=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(path)}</span>, sum=<span class="hljs-subst">${sum + num}</span>`</span>
      );

      <span class="hljs-comment">// ğŸŸ¡ æš‚åœé˜¶æ®µï¼šè°ƒç”¨ä¸‹ä¸€å±‚ï¼Œå½“å‰å±‚çº§æš‚åœ</span>
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸŸ¡ <span class="hljs-subst">${levelTag}</span> æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›`</span>);
      <span class="hljs-comment">// é€’å½’æ¢ç´¢ï¼šæ•°å­—å¯é‡å¤é€‰ï¼Œæ‰€ä»¥startä»ä¸ºiï¼ˆé’»åˆ°åº•ï¼‰</span>
      <span class="hljs-title function_">backtrack</span>(path, sum + num, i);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”´ <span class="hljs-subst">${levelTag}</span> è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ`</span>);

      <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼ˆé€€å›æ¥â†’åˆ æ‰è¿™ä¸ªæ•°ï¼‰</span>
      path.<span class="hljs-title function_">pop</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(
        <span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”µ <span class="hljs-subst">${levelTag}</span> æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—<span class="hljs-subst">${num}</span> â†’ path=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(path)}</span>, sum=<span class="hljs-subst">${sum}</span>`</span>
      );
    }

    <span class="hljs-comment">// å±‚çº§-1ï¼Œå‡†å¤‡è¿”å›</span>
    recursionLevel--;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`<span class="hljs-subst">${indent}</span>ğŸ”´ <span class="hljs-subst">${levelTag}</span> è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚`</span>);
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„ã€å’Œä¸º0ã€ä»ç´¢å¼•0å¼€å§‹</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'========== å¼€å§‹æ‰§è¡Œç»„åˆæ€»å’Œ =========='</span>);
  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'========== æ‰§è¡Œç»“æŸ =========='</span>);
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-comment">// æµ‹è¯•ï¼šè¾“å…¥ [2,3,7], 7 â†’ è¾“å‡º [[2,2,3],[7]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æœ€ç»ˆç»“æœï¼š'</span>, <span class="hljs-title function_">combinationSum</span>([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">7</span>], <span class="hljs-number">7</span>));
</code></pre>
<p>å„ä¸ªå›¾æ ‡çš„å«ä¹‰ï¼š</p>
<ul>
<li>ğŸŸ¢ è°ƒç”¨é˜¶æ®µï¼šè¿›å…¥é€’å½’æ—¶çš„çŠ¶æ€</li>
<li>ğŸ” éå†é˜¶æ®µï¼šå°è¯•é€‰æ‹©æ•°å­—</li>
<li>âœ… é€‰æ‹©é˜¶æ®µï¼šæˆåŠŸé€‰æ‹©æ•°å­—</li>
<li>ğŸŸ¡ æš‚åœé˜¶æ®µï¼šè°ƒç”¨ä¸‹ä¸€å±‚é€’å½’</li>
<li>ğŸ”´ è¿”å›é˜¶æ®µï¼šä»ä¸‹ä¸€å±‚è¿”å›</li>
<li>ğŸ”µ æ’¤é”€é˜¶æ®µï¼šåˆ é™¤æ•°å­—ï¼ˆæ“¦è„šå°ï¼‰</li>
<li>ğŸš« å‰ªæé˜¶æ®µï¼šæå‰ç»ˆæ­¢æ— æ•ˆè·¯å¾„</li>
</ul>
<p><strong>æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-plaintext" lang="plaintext">========== å¼€å§‹æ‰§è¡Œç»„åˆæ€»å’Œ ==========
ğŸŸ¢ ã€å±‚çº§1ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[], sum=0, start=0
ğŸ” ã€å±‚çº§1ã€‘ éå†i=0 â†’ å°è¯•é€‰æ•°å­—2ï¼Œå½“å‰sum=0
âœ… ã€å±‚çº§1ã€‘ é€‰æ•°å­—2 â†’ path=[2], sum=2
ğŸŸ¡ ã€å±‚çº§1ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
  ğŸŸ¢ ã€å±‚çº§2ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2], sum=2, start=0
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=0 â†’ å°è¯•é€‰æ•°å­—2ï¼Œå½“å‰sum=2
  âœ… ã€å±‚çº§2ã€‘ é€‰æ•°å­—2 â†’ path=[2,2], sum=4
  ğŸŸ¡ ã€å±‚çº§2ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
    ğŸŸ¢ ã€å±‚çº§3ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2,2], sum=4, start=0
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=0 â†’ å°è¯•é€‰æ•°å­—2ï¼Œå½“å‰sum=4
    âœ… ã€å±‚çº§3ã€‘ é€‰æ•°å­—2 â†’ path=[2,2,2], sum=6
    ğŸŸ¡ ã€å±‚çº§3ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
      ğŸŸ¢ ã€å±‚çº§4ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2,2,2], sum=6, start=0
      ğŸ” ã€å±‚çº§4ã€‘ éå†i=0 â†’ å°è¯•é€‰æ•°å­—2ï¼Œå½“å‰sum=6
      ğŸš« ã€å±‚çº§4ã€‘ æ’åºå‰ªæ â†’ 6+2=8 &gt; 7ï¼Œbreakå¾ªç¯
      ğŸ”´ ã€å±‚çº§4ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
    ğŸ”µ ã€å±‚çº§3ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—2 â†’ path=[2,2], sum=4
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=4
    âœ… ã€å±‚çº§3ã€‘ é€‰æ•°å­—3 â†’ path=[2,2,3], sum=7
    ğŸŸ¡ ã€å±‚çº§3ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
      ğŸŸ¢ ã€å±‚çº§4ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2,2,3], sum=7, start=1
      âœ… ã€å±‚çº§4ã€‘ æ‰¾åˆ°æœ‰æ•ˆç»„åˆ â†’ [2,2,3]ï¼Œresult=[[2,2,3]]
      ğŸ”´ ã€å±‚çº§4ã€‘ è¿”å›é˜¶æ®µ â†’ æ‰¾åˆ°è§£ï¼Œå›åˆ°ä¸Šä¸€å±‚
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
    ğŸ”µ ã€å±‚çº§3ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—3 â†’ path=[2,2], sum=4
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=2 â†’ å°è¯•é€‰æ•°å­—7ï¼Œå½“å‰sum=4
    ğŸš« ã€å±‚çº§3ã€‘ æ’åºå‰ªæ â†’ 4+7=11 &gt; 7ï¼Œbreakå¾ªç¯
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
  ğŸ”µ ã€å±‚çº§2ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—2 â†’ path=[2], sum=2
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=2
  âœ… ã€å±‚çº§2ã€‘ é€‰æ•°å­—3 â†’ path=[2,3], sum=5
  ğŸŸ¡ ã€å±‚çº§2ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
    ğŸŸ¢ ã€å±‚çº§3ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[2,3], sum=5, start=1
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=5
    ğŸš« ã€å±‚çº§3ã€‘ æ’åºå‰ªæ â†’ 5+3=8 &gt; 7ï¼Œbreakå¾ªç¯
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
  ğŸ”µ ã€å±‚çº§2ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—3 â†’ path=[2], sum=2
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=2 â†’ å°è¯•é€‰æ•°å­—7ï¼Œå½“å‰sum=2
  ğŸš« ã€å±‚çº§2ã€‘ æ’åºå‰ªæ â†’ 2+7=9 &gt; 7ï¼Œbreakå¾ªç¯
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
ğŸ”´ ã€å±‚çº§1ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
ğŸ”µ ã€å±‚çº§1ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—2 â†’ path=[], sum=0
ğŸ” ã€å±‚çº§1ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=0
âœ… ã€å±‚çº§1ã€‘ é€‰æ•°å­—3 â†’ path=[3], sum=3
ğŸŸ¡ ã€å±‚çº§1ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
  ğŸŸ¢ ã€å±‚çº§2ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[3], sum=3, start=1
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=3
  âœ… ã€å±‚çº§2ã€‘ é€‰æ•°å­—3 â†’ path=[3,3], sum=6
  ğŸŸ¡ ã€å±‚çº§2ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
    ğŸŸ¢ ã€å±‚çº§3ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[3,3], sum=6, start=1
    ğŸ” ã€å±‚çº§3ã€‘ éå†i=1 â†’ å°è¯•é€‰æ•°å­—3ï¼Œå½“å‰sum=6
    ğŸš« ã€å±‚çº§3ã€‘ æ’åºå‰ªæ â†’ 6+3=9 &gt; 7ï¼Œbreakå¾ªç¯
    ğŸ”´ ã€å±‚çº§3ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
  ğŸ”µ ã€å±‚çº§2ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—3 â†’ path=[3], sum=3
  ğŸ” ã€å±‚çº§2ã€‘ éå†i=2 â†’ å°è¯•é€‰æ•°å­—7ï¼Œå½“å‰sum=3
  ğŸš« ã€å±‚çº§2ã€‘ æ’åºå‰ªæ â†’ 3+7=10 &gt; 7ï¼Œbreakå¾ªç¯
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
ğŸ”´ ã€å±‚çº§1ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
ğŸ”µ ã€å±‚çº§1ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—3 â†’ path=[], sum=0
ğŸ” ã€å±‚çº§1ã€‘ éå†i=2 â†’ å°è¯•é€‰æ•°å­—7ï¼Œå½“å‰sum=0
âœ… ã€å±‚çº§1ã€‘ é€‰æ•°å­—7 â†’ path=[7], sum=7
ğŸŸ¡ ã€å±‚çº§1ã€‘ æš‚åœé˜¶æ®µ â†’ è°ƒç”¨ä¸‹ä¸€å±‚backtrackï¼Œç­‰å¾…è¿”å›
  ğŸŸ¢ ã€å±‚çº§2ã€‘ è°ƒç”¨é˜¶æ®µ â†’ path=[7], sum=7, start=2
  âœ… ã€å±‚çº§2ã€‘ æ‰¾åˆ°æœ‰æ•ˆç»„åˆ â†’ [7]ï¼Œresult=[[2,2,3],[7]]
  ğŸ”´ ã€å±‚çº§2ã€‘ è¿”å›é˜¶æ®µ â†’ æ‰¾åˆ°è§£ï¼Œå›åˆ°ä¸Šä¸€å±‚
ğŸ”´ ã€å±‚çº§1ã€‘ è¿”å›é˜¶æ®µ â†’ ä»ä¸‹ä¸€å±‚è¿”å›ï¼Œç»§ç»­æ‰§è¡Œ
ğŸ”µ ã€å±‚çº§1ã€‘ æ’¤é”€é˜¶æ®µ â†’ æ’¤é”€æ•°å­—7 â†’ path=[], sum=0
ğŸ”´ ã€å±‚çº§1ã€‘ è¿”å›é˜¶æ®µ â†’ forå¾ªç¯ç»“æŸï¼Œå›åˆ°ä¸Šä¸€å±‚
========== æ‰§è¡Œç»“æŸ ==========
æœ€ç»ˆç»“æœï¼š [ [ 2, 2, 3 ], [ 7 ] ]
</code></pre>
<h4 data-id="heading-9">æ‰§è¡Œæµç¨‹è§£æ</h4>
<p>ä»¥ <code>candidates = [2,3,7]</code>, <code>target = 7</code> ä¸ºä¾‹ï¼š</p>
<ol>
<li><strong>é€‰2</strong> â†’ path=[2], sum=2 â†’ <strong>é’»åˆ°åº•</strong>ï¼ˆé€’å½’ï¼‰</li>
<li><strong>é€‰2</strong> â†’ path=[2,2], sum=4 â†’ <strong>é’»åˆ°åº•</strong>ï¼ˆé€’å½’ï¼‰</li>
<li><strong>é€‰2</strong> â†’ path=[2,2,2], sum=6 â†’ <strong>é’»åˆ°åº•</strong>ï¼ˆé€’å½’ï¼‰</li>
<li><strong>é€‰2</strong> â†’ sum=8 &gt; 7ï¼Œå‰ªæï¼Œ<strong>é€€å›æ¥</strong></li>
<li><strong>åˆ æ‰2</strong> â†’ path=[2,2], sum=6 â†’ <strong>é€‰ä¸‹ä¸€ä¸ªæ•°3</strong></li>
<li><strong>é€‰3</strong> â†’ path=[2,2,3], sum=7 âœ… æ‰¾åˆ°è§£ï¼Œ<strong>é€€å›æ¥</strong></li>
<li><strong>åˆ æ‰3</strong> â†’ path=[2,2], sum=6 â†’ <strong>é€‰ä¸‹ä¸€ä¸ªæ•°7</strong></li>
<li>å‰ªæï¼Œ<strong>é€€å›æ¥</strong> â†’ path=[2], sum=2 â†’ ç»§ç»­å°è¯•...</li>
<li>æœ€ç»ˆæ”¶é›†åˆ° <code>[[2,2,3],[7]]</code></li>
</ol>
<h3 data-id="heading-10">ä¸‰ã€å›æº¯ç®—æ³•å¸¸è§é¢˜å‹åŠè§£é¢˜æ–¹æ³•</h3>
<h4 data-id="heading-11">1. ç»„åˆé—®é¢˜</h4>
<h5 data-id="heading-12">æ ¸å¿ƒç‰¹å¾</h5>
<ul>
<li>ä¸è€ƒè™‘å…ƒç´ é¡ºåºï¼Œæ¯ä¸ªç»„åˆå”¯ä¸€ï¼ˆå¦‚<code>[2,3]</code>å’Œ<code>[3,2]</code>ç®—åŒä¸€ä¸ªï¼‰</li>
<li>ç”¨<code>start</code>å‚æ•°æ§åˆ¶"ä¸å›å¤´é€‰"ï¼Œé¿å…ç”Ÿæˆé‡å¤ç»„åˆ</li>
<li>æ•°å­—å¯é‡å¤é€‰ï¼ˆç»„åˆæ€»å’Œï¼‰/ä¸å¯é‡å¤é€‰ï¼ˆç»„åˆï¼‰ï¼Œä»…éœ€è°ƒæ•´<code>start</code>å‚æ•°ï¼ˆé‡å¤é€‰ä¼ <code>i</code>ï¼Œä¸é‡å¤é€‰ä¼ <code>i+1</code>ï¼‰</li>
</ul>
<h5 data-id="heading-13">LeetCode é¢˜ç›®è¯¦è§£</h5>
<h6 data-id="heading-14"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombination-sum%2F" target="_blank" title="https://leetcode.cn/problems/combination-sum/" ref="nofollow noopener noreferrer">39. ç»„åˆæ€»å’Œ</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸€ä¸ª<strong>æ— é‡å¤å…ƒç´ </strong>çš„æ•´æ•°æ•°ç»„ <code>candidates</code> å’Œä¸€ä¸ªç›®æ ‡æ•´æ•° <code>target</code>ï¼Œæ‰¾å‡º <code>candidates</code> ä¸­å¯ä»¥ä½¿æ•°å­—å’Œä¸ºç›®æ ‡æ•° <code>target</code> çš„<strong>æ‰€æœ‰ä¸åŒç»„åˆ</strong>ï¼Œå¹¶ä»¥åˆ—è¡¨å½¢å¼è¿”å›ã€‚ä½ å¯ä»¥æŒ‰<strong>ä»»æ„é¡ºåº</strong>è¿”å›è¿™äº›ç»„åˆã€‚</p>
<p><code>candidates</code> ä¸­çš„<strong>åŒä¸€ä¸ªæ•°å­—å¯ä»¥æ— é™åˆ¶é‡å¤è¢«é€‰å–</strong>ã€‚å¦‚æœè‡³å°‘ä¸€ä¸ªæ•°å­—çš„è¢«é€‰æ•°é‡ä¸åŒï¼Œåˆ™ä¸¤ç§ç»„åˆæ˜¯ä¸åŒçš„ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">candidates</span> = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>], target = <span class="hljs-number">7</span>
è¾“å‡ºï¼š<span class="hljs-section">[[2,2,3]</span>,<span class="hljs-section">[7]]</span>
è§£é‡Šï¼š
2 å’Œ 3 å¯ä»¥å½¢æˆä¸€ç»„å€™é€‰ï¼Œ2 + 2 + <span class="hljs-attr">3</span> = <span class="hljs-number">7</span>ã€‚æ³¨æ„ <span class="hljs-number">2</span> å¯ä»¥ä½¿ç”¨å¤šæ¬¡ã€‚
7 ä¹Ÿæ˜¯ä¸€ä¸ªå€™é€‰ï¼Œ <span class="hljs-attr">7</span> = <span class="hljs-number">7</span>ã€‚
æ‰€ä»¥è¿™ä¸¤ç§ç»„åˆæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚
</code></pre>
<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥: <span class="hljs-attr">candidates</span> = [<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>], target = <span class="hljs-number">8</span>
è¾“å‡º: <span class="hljs-section">[[2,2,2,2]</span>,<span class="hljs-section">[2,3,3]</span>,<span class="hljs-section">[3,5]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//**</span>
 * ç»„åˆæ€»å’Œï¼šæ‰¾å‡ºå€™é€‰æ•°ç»„ä¸­æ‰€æœ‰å’Œä¸ºç›®æ ‡å€¼çš„ç»„åˆï¼ˆæ•°å­—å¯é‡å¤é€‰å–ï¼‰
 * @param candidates æ— é‡å¤å…ƒç´ çš„å€™é€‰æ•°å­—æ•°ç»„
 * @param target ç›®æ ‡å’Œ
 * @returns æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆæ•°ç»„
 */
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum</span>(<span class="hljs-params">candidates: number[], target: number</span>): number[][] {
  <span class="hljs-comment">// ç»“æœæ•°ç»„ï¼šå­˜å‚¨æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆï¼ˆéœ€æ·±æ‹·è´ï¼Œé¿å…å¼•ç”¨æ±¡æŸ“ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: number[][] = [];
  <span class="hljs-comment">// å€™é€‰æ•°ç»„é•¿åº¦ï¼šé¿å…å¾ªç¯ä¸­é‡å¤è®¡ç®—</span>
  <span class="hljs-keyword">const</span> len = candidates.<span class="hljs-property">length</span>;

  <span class="hljs-comment">// ã€æ˜“é”™ç‚¹1ã€‘æ’åºæ˜¯å‰ªæçš„å‰æï¼æ— åºæ•°ç»„æ— æ³•ç”¨breakæœ‰æ•ˆå‰ªæ</span>
  candidates.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x - y);

  <span class="hljs-comment">/**
   * å›æº¯æ ¸å¿ƒå‡½æ•°
   * <span class="hljs-doctag">@param</span> path å½“å‰å·²é€‰æ•°å­—çš„è·¯å¾„ï¼ˆå¼•ç”¨ç±»å‹ï¼Œéœ€æ³¨æ„å›æº¯æ’¤é”€ï¼‰
   * <span class="hljs-doctag">@param</span> sum å½“å‰è·¯å¾„çš„æ•°å­—å’Œï¼ˆé¿å…é‡å¤è®¡ç®—ï¼Œæå‡æ•ˆç‡ï¼‰
   * <span class="hljs-doctag">@param</span> start éå†èµ·å§‹ç´¢å¼•ï¼ˆæ§åˆ¶ä¸å›å¤´é€‰ï¼Œé¿å…é‡å¤ç»„åˆï¼‰
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path: number[], sum: number, start: number</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶1ï¼šæ‰¾åˆ°æœ‰æ•ˆç»„åˆ</span>
    <span class="hljs-keyword">if</span> (sum === target) {
      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹2ã€‘å¿…é¡»æ·±æ‹·è´ï¼ç›´æ¥push(path)ä¼šå› å¼•ç”¨å¯¼è‡´åç»­popä¿®æ”¹ç»“æœ</span>
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶2ï¼šå‰ç½®å‰ªæï¼ˆsumè¶…è¿‡ç›®æ ‡å€¼ï¼Œç›´æ¥ç»ˆæ­¢å½“å‰é€’å½’ï¼‰</span>
    <span class="hljs-comment">// å¯é€‰ä¼˜åŒ–ï¼šå¯åˆå¹¶ä¸º if (sum &gt;= target) { ... return }</span>
    <span class="hljs-keyword">if</span> (sum &gt; target) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// éå†å€™é€‰æ•°ç»„ï¼ˆä»startå¼€å§‹ï¼Œé¿å…é‡å¤ç»„åˆï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; len; i++) {
      <span class="hljs-keyword">const</span> cur = candidates[i];

      <span class="hljs-comment">// ã€æ‰§è¡Œé¡ºåºä¼˜åŒ–ç‚¹ã€‘å‰ªæé€»è¾‘åº”æ”¾åœ¨pushä¹‹å‰ï¼ˆå½“å‰ä»£ç pushååˆ¤æ–­ï¼Œä¼šå¤šä¸€æ¬¡æ— æ•ˆpush/popï¼‰</span>
      <span class="hljs-comment">// æ’åºåï¼Œè‹¥å½“å‰æ•°+å·²é€‰å’Œ&gt;ç›®æ ‡å€¼ï¼Œåç»­æ•°æ›´å¤§ï¼Œç›´æ¥ç»ˆæ­¢å¾ªç¯</span>
      <span class="hljs-keyword">if</span> (sum + cur &gt; target) {
        <span class="hljs-keyword">break</span>;
      }

      <span class="hljs-comment">// åšé€‰æ‹©ï¼šå°†å½“å‰æ•°å­—åŠ å…¥è·¯å¾„</span>
      path.<span class="hljs-title function_">push</span>(cur);

      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹3ã€‘é€’å½’å‚æ•°ä¼ iè€Œéstartï¼</span>
      <span class="hljs-comment">// ä¼ iï¼šå…è®¸é‡å¤é€‰å½“å‰æ•°å­—ï¼ˆç»„åˆæ€»å’Œæ ¸å¿ƒéœ€æ±‚ï¼‰</span>
      <span class="hljs-comment">// ä¼ startï¼šæ— é™é€’å½’ï¼ˆæ°¸è¿œä»0å¼€å§‹é€‰ï¼‰ï¼Œä¼ i+1ï¼šä¸å…è®¸é‡å¤é€‰ï¼ˆå˜æˆç»„åˆé—®é¢˜ï¼‰</span>
      <span class="hljs-title function_">backtrack</span>(path, sum + cur, i);

      <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼Œæ¢å¤è·¯å¾„çŠ¶æ€</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„ã€å’Œä¸º0ã€ä»ç´¢å¼•0å¼€å§‹éå†</span>
  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combinationSum</span>([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>], <span class="hljs-number">7</span>)); <span class="hljs-comment">// è¾“å‡ºï¼š[[2,2,3],[7]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combinationSum</span>([<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>], <span class="hljs-number">8</span>));   <span class="hljs-comment">// è¾“å‡ºï¼š[[2,2,2,2],[2,3,3],[3,5]]</span>
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å¿˜è®°æ’åºå¯¼è‡´å‰ªæå¤±æ•ˆ</li>
<li><code>start</code>å‚æ•°ä¼ é”™ï¼ˆé‡å¤é€‰ä¼ <code>i</code>ï¼Œä¸é‡å¤é€‰ä¼ <code>i+1</code>ï¼‰</li>
<li>å¿˜è®°æ‹·è´è·¯å¾„ï¼ˆ<code>[...path]</code>ï¼‰</li>
</ul>
<hr/>
<h6 data-id="heading-15"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombination-sum-ii%2F" target="_blank" title="https://leetcode.cn/problems/combination-sum-ii/" ref="nofollow noopener noreferrer">40. ç»„åˆæ€»å’Œ II</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸€ä¸ªå€™é€‰äººç¼–å·çš„é›†åˆ <code>candidates</code> å’Œä¸€ä¸ªç›®æ ‡æ•° <code>target</code>ï¼Œæ‰¾å‡º <code>candidates</code> ä¸­æ‰€æœ‰å¯ä»¥ä½¿æ•°å­—å’Œä¸º <code>target</code> çš„ç»„åˆã€‚</p>
<p><code>candidates</code> ä¸­çš„<strong>æ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡</strong>ã€‚</p>
<p>**æ³¨æ„ï¼š**è§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„ç»„åˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥: <span class="hljs-attr">candidates</span> = [<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>,<span class="hljs-number">6</span>,<span class="hljs-number">1</span>,<span class="hljs-number">5</span>], target = <span class="hljs-number">8</span>,
è¾“å‡º:
<span class="hljs-section">[
[1,1,6]</span>,
<span class="hljs-section">[1,2,5]</span>,
<span class="hljs-section">[1,7]</span>,
<span class="hljs-section">[2,6]</span>
]
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * ç»„åˆæ€»å’ŒIIï¼šæ‰¾å‡ºå€™é€‰æ•°ç»„ä¸­æ‰€æœ‰å’Œä¸ºç›®æ ‡å€¼çš„ç»„åˆï¼ˆæ•°å­—ä¸å¯é‡å¤é€‰å–ï¼Œä¸”ç»“æœæ— é‡å¤ç»„åˆï¼‰
 * æ ¸å¿ƒåŒºåˆ«äºcombinationSumï¼š
 * 1. å€™é€‰æ•°ç»„å¯èƒ½åŒ…å«é‡å¤æ•°å­—
 * 2. æ¯ä¸ªæ•°å­—åœ¨æ¯ä¸ªç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡
 * 3. æœ€ç»ˆç»“æœä¸èƒ½æœ‰é‡å¤ç»„åˆ
 * <span class="hljs-doctag">@param</span> candidates å¯èƒ½åŒ…å«é‡å¤å…ƒç´ çš„å€™é€‰æ•°å­—æ•°ç»„
 * <span class="hljs-doctag">@param</span> target ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ä¸é‡å¤ç»„åˆæ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum2</span>(<span class="hljs-params">candidates: <span class="hljs-built_in">number</span>[], target: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span>[][] {
  <span class="hljs-comment">// ç»“æœæ•°ç»„ï¼šå­˜å‚¨æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆï¼ˆéœ€æ·±æ‹·è´ï¼Œé¿å…å¼•ç”¨æ±¡æŸ“ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: <span class="hljs-built_in">number</span>[][] = [];
  <span class="hljs-comment">// å€™é€‰æ•°ç»„é•¿åº¦ï¼šé¿å…å¾ªç¯ä¸­é‡å¤è®¡ç®—</span>
  <span class="hljs-keyword">const</span> len = candidates.<span class="hljs-property">length</span>;

  <span class="hljs-comment">// ã€æ˜“é”™ç‚¹1ã€‘æ’åºæ˜¯å»é‡+å‰ªæçš„å‰æï¼æ— åºæ•°ç»„æ— æ³•æœ‰æ•ˆå»é‡å’Œå‰ªæ</span>
  candidates.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x - y);

  <span class="hljs-comment">/**
   * å›æº¯æ ¸å¿ƒå‡½æ•°
   * <span class="hljs-doctag">@param</span> path å½“å‰å·²é€‰æ•°å­—çš„è·¯å¾„ï¼ˆå¼•ç”¨ç±»å‹ï¼Œéœ€æ³¨æ„å›æº¯æ’¤é”€ï¼‰
   * <span class="hljs-doctag">@param</span> sum å½“å‰è·¯å¾„çš„æ•°å­—å’Œï¼ˆé¿å…é‡å¤è®¡ç®—ï¼Œæå‡æ•ˆç‡ï¼‰
   * <span class="hljs-doctag">@param</span> start éå†èµ·å§‹ç´¢å¼•ï¼ˆæ§åˆ¶ä¸å›å¤´é€‰ï¼Œé¿å…é‡å¤ç»„åˆï¼‰
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path: <span class="hljs-built_in">number</span>[], sum: <span class="hljs-built_in">number</span>, start: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶1ï¼šæ‰¾åˆ°æœ‰æ•ˆç»„åˆ</span>
    <span class="hljs-keyword">if</span> (sum === target) {
      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹2ã€‘å¿…é¡»æ·±æ‹·è´ï¼ç›´æ¥push(path)ä¼šå› å¼•ç”¨å¯¼è‡´åç»­popä¿®æ”¹ç»“æœ</span>
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶2ï¼šå‰ç½®å‰ªæï¼ˆsumè¶…è¿‡ç›®æ ‡å€¼ï¼Œç›´æ¥ç»ˆæ­¢å½“å‰é€’å½’ï¼‰</span>
    <span class="hljs-keyword">if</span> (sum &gt; target) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// éå†å€™é€‰æ•°ç»„ï¼ˆä»startå¼€å§‹ï¼Œé¿å…é‡å¤ç»„åˆï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt; len; i++) {
      <span class="hljs-keyword">const</span> cur = candidates[i];

      <span class="hljs-comment">// ã€æ ¸å¿ƒä¼˜åŒ–1ã€‘å…ˆå‰ªæï¼ˆsum+cur&gt;targetï¼‰ï¼Œå†å¤„ç†å»é‡ï¼Œé¿å…æ— æ•ˆæ“ä½œ</span>
      <span class="hljs-comment">// æ’åºåï¼Œè‹¥å½“å‰æ•°+å·²é€‰å’Œ&gt;ç›®æ ‡å€¼ï¼Œåç»­æ•°æ›´å¤§ï¼Œç›´æ¥ç»ˆæ­¢å¾ªç¯</span>
      <span class="hljs-keyword">if</span> (sum + cur &gt; target) {
        <span class="hljs-keyword">break</span>;
      }

      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹3ã€‘å»é‡å‰ªæå¿…é¡»æ”¾åœ¨pushä¹‹å‰ï¼ä¸”åˆ¤æ–­æ¡ä»¶æ˜¯i&gt;start</span>
      <span class="hljs-comment">// ä½œç”¨ï¼šè¿‡æ»¤åŒä¸€å±‚é€’å½’ä¸­é‡å¤çš„æ•°å­—ï¼ˆæ¯”å¦‚[1,1,2]ï¼Œ3çš„è¯ï¼Œç¬¬ä¸€ä¸ª[1,2],ç„¶åpathå˜æˆ[]ä¹‹åï¼Œèµ°åˆ°i=1,æ­¤æ—¶åˆæ˜¯1å’Œä¸Šä¸€ä¸ªç›¸åŒï¼Œå¦‚æœä¸è·³è¿‡ï¼Œåˆ™åˆä¼šæœ‰ä¸€ä¸ª[1,2]ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦è·³è¿‡ï¼‰</span>
      <span class="hljs-keyword">if</span> (i &gt; start &amp;&amp; candidates[i] === candidates[i - <span class="hljs-number">1</span>]) {
        <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// è·³è¿‡å½“å‰å±‚çš„é‡å¤æ•°å­—</span>
      }

      <span class="hljs-comment">// åšé€‰æ‹©ï¼šå°†å½“å‰æ•°å­—åŠ å…¥è·¯å¾„</span>
      path.<span class="hljs-title function_">push</span>(cur);

      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹4ã€‘é€’å½’å‚æ•°ä¼ i+1è€Œéiï¼</span>
      <span class="hljs-comment">// ä¼ i+1ï¼šæ¯ä¸ªæ•°å­—åªèƒ½é€‰ä¸€æ¬¡ï¼ˆç»„åˆæ€»å’ŒIIæ ¸å¿ƒè¦æ±‚ï¼‰</span>
      <span class="hljs-comment">// ä¼ iï¼šå…è®¸é‡å¤é€‰ï¼ˆå˜æˆcombinationSumï¼‰ï¼Œä¼ startï¼šæ— é™é€’å½’</span>
      <span class="hljs-title function_">backtrack</span>(path, sum + cur, i + <span class="hljs-number">1</span>);

      <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼Œæ¢å¤è·¯å¾„çŠ¶æ€</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„ã€å’Œä¸º0ã€ä»ç´¢å¼•0å¼€å§‹éå†</span>
  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹ï¼ˆé‡ç‚¹éªŒè¯å»é‡ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combinationSum2</span>([<span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>], <span class="hljs-number">8</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,1,6],[1,2,5],[1,7],[2,6]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combinationSum2</span>([<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-number">5</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,2,2],[5]]</span>
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å»é‡é€»è¾‘é”™è¯¯ï¼šåº”è¯¥æ˜¯<code>i &gt; start</code>è€Œä¸æ˜¯<code>i &gt; 0</code>ï¼ˆå…è®¸ä¸åŒå±‚é€‰ç›¸åŒæ•°å­—ï¼‰</li>
<li>å¿˜è®°æ’åºå¯¼è‡´å»é‡å¤±æ•ˆ</li>
</ul>
<hr/>
<h6 data-id="heading-16"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombinations%2F" target="_blank" title="https://leetcode.cn/problems/combinations/" ref="nofollow noopener noreferrer">77. ç»„åˆ</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸¤ä¸ªæ•´æ•° <code>n</code> å’Œ <code>k</code>ï¼Œè¿”å›èŒƒå›´ <code>[1, n]</code> ä¸­æ‰€æœ‰å¯èƒ½çš„ <code>k</code> ä¸ªæ•°çš„ç»„åˆã€‚</p>
<p>ä½ å¯ä»¥æŒ‰<strong>ä»»ä½•é¡ºåº</strong>è¿”å›ç­”æ¡ˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">n</span> = <span class="hljs-number">4</span>, k = <span class="hljs-number">2</span>
è¾“å‡ºï¼š
<span class="hljs-section">[
  [2,4]</span>,
  <span class="hljs-section">[3,4]</span>,
  <span class="hljs-section">[2,3]</span>,
  <span class="hljs-section">[1,2]</span>,
  <span class="hljs-section">[1,3]</span>,
  <span class="hljs-section">[1,4]</span>,
]
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * ç»„åˆï¼šä» 1~n çš„æ•°å­—ä¸­é€‰å‡º k ä¸ªæ•°å­—çš„æ‰€æœ‰ç»„åˆï¼ˆä¸è€ƒè™‘é¡ºåºï¼Œæ— é‡å¤ç»„åˆï¼‰
 * æ ¸å¿ƒè§„åˆ™ï¼š
 * 1. ç»„åˆä¸è€ƒè™‘é¡ºåºï¼ˆå¦‚[1,2]å’Œ[2,1]ç®—åŒä¸€ä¸ªï¼Œéœ€é€šè¿‡startNumæ§åˆ¶ä¸å›å¤´é€‰ï¼‰
 * 2. æ¯ä¸ªæ•°å­—åªèƒ½é€‰ä¸€æ¬¡
 * <span class="hljs-doctag">@param</span> n æ•°å­—èŒƒå›´ä¸Šé™ï¼ˆ1~nï¼‰
 * <span class="hljs-doctag">@param</span> k ç»„åˆçš„é•¿åº¦
 * <span class="hljs-doctag">@returns</span> æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆæ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combine</span>(<span class="hljs-params">n: <span class="hljs-built_in">number</span>, k: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span>[][] {
  <span class="hljs-comment">// ç»“æœæ•°ç»„ï¼šå­˜å‚¨æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆï¼ˆéœ€æ·±æ‹·è´ï¼Œé¿å…å¼•ç”¨æ±¡æŸ“ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: <span class="hljs-built_in">number</span>[][] = [];

  <span class="hljs-comment">/**
   * å›æº¯æ ¸å¿ƒå‡½æ•°
   * <span class="hljs-doctag">@param</span> path å½“å‰å·²é€‰æ•°å­—çš„è·¯å¾„ï¼ˆå¼•ç”¨ç±»å‹ï¼Œéœ€æ³¨æ„å›æº¯æ’¤é”€ï¼‰
   * <span class="hljs-doctag">@param</span> startNum éå†èµ·å§‹æ•°å­—ï¼ˆæ§åˆ¶ä¸å›å¤´é€‰ï¼Œé¿å…é‡å¤ç»„åˆï¼Œå¦‚é€‰1ååªèƒ½é€‰2/3...nï¼‰
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path: <span class="hljs-built_in">number</span>[], startNum: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šå½“å‰è·¯å¾„é•¿åº¦ç­‰äºkï¼Œæ‰¾åˆ°æœ‰æ•ˆç»„åˆ</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === k) {
      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹1ã€‘å¿…é¡»æ·±æ‹·è´ï¼ç›´æ¥push(path)ä¼šå› å¼•ç”¨å¯¼è‡´åç»­popä¿®æ”¹ç»“æœ</span>
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// ã€æ ¸å¿ƒå‰ªæã€‘å‰©ä½™å¯é€‰æ•°å­—ä¸è¶³ä»¥å‡‘å¤Ÿkä¸ªï¼Œç›´æ¥ç»ˆæ­¢é€’å½’ï¼ˆä¼˜åŒ–æ•ˆç‡ï¼‰</span>
    <span class="hljs-comment">// å‰©ä½™å¯é€‰æ•°å­—æ•° = n - startNum + 1</span>
    <span class="hljs-comment">// å½“å‰è·¯å¾„é•¿åº¦ + å‰©ä½™å¯é€‰æ•°å­—æ•° &lt; k â†’ ä¸å¯èƒ½å‡‘å¤Ÿkä¸ªï¼Œå‰ªæ</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> + (n - startNum + <span class="hljs-number">1</span>) &lt; k) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// éå†æ•°å­—ï¼šä»startNumå¼€å§‹åˆ°nï¼ˆé¿å…å›å¤´é€‰ï¼Œç”Ÿæˆé‡å¤ç»„åˆï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startNum; i &lt;= n; i++) {
      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹2ã€‘æ ¸å¿ƒé”™è¯¯ï¼šåŸä»£ç push(startNum)ï¼Œæ­£ç¡®åº”push(i)</span>
      <span class="hljs-comment">// åšé€‰æ‹©ï¼šå°†å½“å‰éå†çš„æ•°å­—iåŠ å…¥è·¯å¾„</span>
      path.<span class="hljs-title function_">push</span>(i);

      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹3ã€‘é€’å½’å‚æ•°ä¼ i+1è€ŒéstartNum+1ï¼</span>
      <span class="hljs-comment">// ä¼ i+1ï¼šä¸‹ä¸€å±‚ä»å½“å‰æ•°å­—çš„ä¸‹ä¸€ä½å¼€å§‹ï¼Œä¿è¯ä¸å›å¤´é€‰</span>
      <span class="hljs-title function_">backtrack</span>(path, i + <span class="hljs-number">1</span>);

      <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼Œæ¢å¤è·¯å¾„çŠ¶æ€</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„ã€ä»æ•°å­—1å¼€å§‹éå†</span>
  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combine</span>(<span class="hljs-number">4</span>, <span class="hljs-number">2</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,2],[1,3],[1,4],[2,3],[2,4],[3,4]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combine</span>(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,2,3]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combine</span>(<span class="hljs-number">5</span>, <span class="hljs-number">1</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1],[2],[3],[4],[5]]</span>
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>èŒƒå›´é”™è¯¯ï¼šåº”è¯¥æ˜¯<code>[1, n]</code>ï¼Œå¾ªç¯æ¡ä»¶æ˜¯<code>i &lt;= n</code>è€Œä¸æ˜¯<code>i &lt; n</code></li>
<li>å¿˜è®°å‰ªæä¼˜åŒ–å¯¼è‡´è¶…æ—¶</li>
</ul>
<hr/>
<h6 data-id="heading-17"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fcombination-sum-iii%2F" target="_blank" title="https://leetcode.cn/problems/combination-sum-iii/" ref="nofollow noopener noreferrer">216. ç»„åˆæ€»å’Œ III</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>æ‰¾å‡ºæ‰€æœ‰ç›¸åŠ ä¹‹å’Œä¸º <code>n</code> çš„ <code>k</code> ä¸ªæ•°çš„ç»„åˆï¼Œä¸”æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼š</p>
<ul>
<li>åªä½¿ç”¨æ•°å­—1åˆ°9</li>
<li>æ¯ä¸ªæ•°å­—<strong>æœ€å¤šä½¿ç”¨ä¸€æ¬¡</strong></li>
</ul>
<p>è¿”å›<strong>æ‰€æœ‰å¯èƒ½çš„æœ‰æ•ˆç»„åˆçš„åˆ—è¡¨</strong>ã€‚è¯¥åˆ—è¡¨ä¸èƒ½åŒ…å«ç›¸åŒçš„ç»„åˆä¸¤æ¬¡ï¼Œç»„åˆå¯ä»¥ä»¥ä»»ä½•é¡ºåºè¿”å›ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥: <span class="hljs-attr">k</span> = <span class="hljs-number">3</span>, n = <span class="hljs-number">7</span>
è¾“å‡º: <span class="hljs-section">[[1,2,4]]</span>
è§£é‡Š:
1 + 2 + <span class="hljs-attr">4</span> = <span class="hljs-number">7</span>
æ²¡æœ‰å…¶ä»–ç¬¦åˆçš„ç»„åˆäº†ã€‚
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * ç»„åˆæ€»å’ŒIIIï¼šæ‰¾å‡ºæ‰€æœ‰ç›¸åŠ ä¹‹å’Œä¸ºnçš„kä¸ªæ­£æ•´æ•°ç»„åˆï¼ˆä»…ä½¿ç”¨æ•°å­—1-9ï¼Œæ¯ä¸ªæ•°å­—æœ€å¤šä½¿ç”¨ä¸€æ¬¡ï¼‰
 * æ ¸å¿ƒè§„åˆ™ï¼š
 * 1. ç»„åˆé•¿åº¦å›ºå®šä¸ºkï¼›
 * 2. æ•°å­—èŒƒå›´1~9ï¼Œä¸”ä¸é‡å¤é€‰å–ï¼›
 * 3. ç»„åˆå’Œä¸ºnï¼Œä¸”ç»„åˆä¸è€ƒè™‘é¡ºåºï¼ˆå¦‚[1,2]å’Œ[2,1]ç®—åŒä¸€ä¸ªï¼Œéœ€é€šè¿‡startNumæ§åˆ¶ä¸å›å¤´é€‰ï¼‰ã€‚
 * <span class="hljs-doctag">@param</span> k ç»„åˆçš„å›ºå®šé•¿åº¦
 * <span class="hljs-doctag">@param</span> n ç»„åˆçš„ç›®æ ‡å’Œ
 * <span class="hljs-doctag">@returns</span> æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆæ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">combinationSum3</span>(<span class="hljs-params">k: <span class="hljs-built_in">number</span>, n: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span>[][] {
  <span class="hljs-comment">// ç»“æœæ•°ç»„ï¼šå­˜å‚¨æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„ç»„åˆï¼ˆéœ€æ·±æ‹·è´ï¼Œé¿å…å¼•ç”¨æ±¡æŸ“ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: <span class="hljs-built_in">number</span>[][] = [];
  <span class="hljs-comment">// ç›®æ ‡å’Œï¼ˆå¯ç›´æ¥ç”¨nï¼Œæ­¤å¤„ä¿ç•™targetä»…ä¸ºè¯­ä¹‰æ¸…æ™°ï¼‰</span>
  <span class="hljs-keyword">const</span> target = n;

  <span class="hljs-comment">/**
   * å›æº¯æ ¸å¿ƒå‡½æ•°
   * <span class="hljs-doctag">@param</span> path å½“å‰å·²é€‰æ•°å­—çš„è·¯å¾„ï¼ˆå¼•ç”¨ç±»å‹ï¼Œéœ€æ³¨æ„å›æº¯æ’¤é”€ï¼‰
   * <span class="hljs-doctag">@param</span> sum å½“å‰è·¯å¾„çš„æ•°å­—å’Œï¼ˆé¿å…é‡å¤è®¡ç®—ï¼Œæå‡æ•ˆç‡ï¼‰
   * <span class="hljs-doctag">@param</span> startNum éå†èµ·å§‹æ•°å­—ï¼ˆæ§åˆ¶ä¸å›å¤´é€‰ï¼Œé¿å…é‡å¤ç»„åˆï¼Œå¦‚é€‰1ååªèƒ½é€‰2~9ï¼‰
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path: <span class="hljs-built_in">number</span>[], sum: <span class="hljs-built_in">number</span>, startNum: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-comment">// ã€æ˜“é”™ç‚¹1ã€‘ç»ˆæ­¢æ¡ä»¶1ï¼šç»„åˆé•¿åº¦è¾¾åˆ°kï¼ˆæ ¸å¿ƒç»ˆæ­¢æ¡ä»¶ï¼‰</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === k) {
      <span class="hljs-comment">// ä»…å½“å’Œç­‰äºç›®æ ‡å€¼æ—¶ï¼Œè®°å½•æœ‰æ•ˆç»„åˆ</span>
      <span class="hljs-keyword">if</span> (sum === target) {
        res.<span class="hljs-title function_">push</span>([...path]);
      }
      <span class="hljs-comment">// æ— è®ºsumæ˜¯å¦ç­‰äºtargetï¼Œé•¿åº¦åˆ°kéƒ½è¦ç»ˆæ­¢ï¼ˆsum&gt;targetä¹Ÿæ— éœ€å•ç‹¬åˆ¤æ–­ï¼Œç›´æ¥returnï¼‰</span>
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// ã€æ ¸å¿ƒå‰ªæ1ã€‘å‰©ä½™å¯é€‰æ•°å­—ä¸è¶³ä»¥å‡‘å¤Ÿkä¸ªï¼Œç›´æ¥ç»ˆæ­¢é€’å½’</span>
    <span class="hljs-comment">// å‰©ä½™å¯é€‰æ•°å­—æ•° = 9 - startNum + 1ï¼ˆ1~9å…±9ä¸ªæ•°å­—ï¼‰</span>
    <span class="hljs-comment">// å½“å‰è·¯å¾„é•¿åº¦ + å‰©ä½™å¯é€‰æ•°å­—æ•° &lt; k â†’ ä¸å¯èƒ½å‡‘å¤Ÿkä¸ªï¼Œå‰ªæ</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> + (<span class="hljs-number">9</span> - startNum + <span class="hljs-number">1</span>) &lt; k) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// ã€æ ¸å¿ƒå‰ªæ2ã€‘æå‰é¢„åˆ¤ï¼šè‹¥å½“å‰sum + æœ€å°å‰©ä½™æ•°å­— &gt; targetï¼Œåç»­æ— éœ€éå†ï¼ˆåŸä»£ç ä»…åœ¨å¾ªç¯å†…å‰ªæï¼Œæ­¤å¤„å¯é€‰ï¼‰</span>
    <span class="hljs-comment">// å¦‚sum=7, target=8, k=2, path.length=1 â†’ å‰©ä½™1ä¸ªæ•°å­—æœ€å°æ˜¯startNumï¼Œè‹¥7+startNum&gt;8åˆ™break</span>
    <span class="hljs-comment">// ï¼ˆåŸä»£ç æ— æ­¤å‰ªæï¼Œä¸å½±å“ç»“æœï¼Œä»…ä¼˜åŒ–æ•ˆç‡ï¼‰</span>

    <span class="hljs-comment">// éå†æ•°å­—ï¼šä»startNumå¼€å§‹åˆ°9ï¼ˆé¿å…å›å¤´é€‰ï¼Œä¿è¯æ•°å­—ä¸é‡å¤ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startNum; i &lt;= <span class="hljs-number">9</span>; i++) {
      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹2ã€‘å¾ªç¯å†…å‰ªæï¼šsum+i&gt;targetæ—¶ï¼Œåç»­æ•°å­—æ›´å¤§ï¼Œç›´æ¥ç»ˆæ­¢å¾ªç¯ï¼ˆ1~9å·²å¤©ç„¶æ’åºï¼‰</span>
      <span class="hljs-keyword">if</span> (sum + i &gt; target) {
        <span class="hljs-keyword">break</span>;
      }

      <span class="hljs-comment">// åšé€‰æ‹©ï¼šå°†å½“å‰æ•°å­—iåŠ å…¥è·¯å¾„</span>
      path.<span class="hljs-title function_">push</span>(i);

      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹3ã€‘é€’å½’å‚æ•°ä¼ i+1è€ŒéstartNum+1ï¼</span>
      <span class="hljs-comment">// ä¼ i+1ï¼šä¸‹ä¸€å±‚ä»å½“å‰æ•°å­—çš„ä¸‹ä¸€ä½å¼€å§‹ï¼Œä¿è¯æ¯ä¸ªæ•°å­—åªé€‰ä¸€æ¬¡</span>
      <span class="hljs-title function_">backtrack</span>(path, sum + i, i + <span class="hljs-number">1</span>);

      <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼Œæ¢å¤è·¯å¾„çŠ¶æ€</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„ã€å’Œä¸º0ã€ä»æ•°å­—1å¼€å§‹éå†</span>
  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
  <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combinationSum3</span>(<span class="hljs-number">3</span>, <span class="hljs-number">7</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,2,4]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combinationSum3</span>(<span class="hljs-number">3</span>, <span class="hljs-number">9</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,2,6],[1,3,5],[2,3,4]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combinationSum3</span>(<span class="hljs-number">4</span>, <span class="hljs-number">1</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[]ï¼ˆæ— ç¬¦åˆæ¡ä»¶çš„ç»„åˆï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">combinationSum3</span>(<span class="hljs-number">2</span>, <span class="hljs-number">18</span>));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[9,9]] â†’ é”™è¯¯ï¼Ÿä¸ï¼Œ1~9æ•°å­—ä¸é‡å¤ï¼Œæ‰€ä»¥æ­£ç¡®è¾“å‡ºæ˜¯[]ï¼ˆåŸä»£ç ä¼šæ­£ç¡®è¿”å›[]ï¼‰</span>
</code></pre>
<hr/>
<h4 data-id="heading-18">2. æ’åˆ—é—®é¢˜</h4>
<h5 data-id="heading-19">æ ¸å¿ƒç‰¹å¾</h5>
<ul>
<li>è€ƒè™‘å…ƒç´ é¡ºåºï¼Œæ¯ä¸ªæ’åˆ—å”¯ä¸€ï¼ˆå¦‚<code>[1,2]</code>å’Œ<code>[2,1]</code>ç®—ä¸åŒæ’åˆ—ï¼‰</li>
<li>ç”¨<code>used</code>æ•°ç»„æ§åˆ¶"ä¸é‡å¤é€‰"ï¼Œå¾ªç¯ä»0å¼€å§‹ï¼ˆå…è®¸é€‰ä»»æ„æœªé€‰è¿‡çš„æ•°å­—ï¼‰</li>
<li>å«é‡å¤æ•°å­—çš„æ’åˆ—ï¼ˆå…¨æ’åˆ—IIï¼‰éœ€å¢åŠ "å»é‡å‰ªæ"</li>
</ul>
<h5 data-id="heading-20">LeetCode é¢˜ç›®è¯¦è§£</h5>
<h6 data-id="heading-21"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fpermutations%2F" target="_blank" title="https://leetcode.cn/problems/permutations/" ref="nofollow noopener noreferrer">46. å…¨æ’åˆ—</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸€ä¸ª<strong>ä¸å«é‡å¤æ•°å­—</strong>çš„æ•°ç»„ <code>nums</code>ï¼Œè¿”å›å…¶<strong>æ‰€æœ‰å¯èƒ½çš„å…¨æ’åˆ—</strong>ã€‚ä½ å¯ä»¥<strong>æŒ‰ä»»æ„é¡ºåº</strong>è¿”å›ç­”æ¡ˆã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">nums</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
è¾“å‡ºï¼š<span class="hljs-section">[[1,2,3]</span>,<span class="hljs-section">[1,3,2]</span>,<span class="hljs-section">[2,1,3]</span>,<span class="hljs-section">[2,3,1]</span>,<span class="hljs-section">[3,1,2]</span>,<span class="hljs-section">[3,2,1]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * å…¨æ’åˆ—ï¼šç”Ÿæˆæ— é‡å¤æ•°å­—æ•°ç»„çš„æ‰€æœ‰æ’åˆ—ï¼ˆè€ƒè™‘é¡ºåºï¼Œå¦‚[1,2]å’Œ[2,1]æ˜¯ä¸åŒæ’åˆ—ï¼‰
 * æ ¸å¿ƒè§„åˆ™ï¼š
 * 1. æ’åˆ—è€ƒè™‘é¡ºåºï¼Œæ¯ä¸ªæ•°å­—åœ¨æ’åˆ—ä¸­ä»…å‡ºç°ä¸€æ¬¡ï¼›
 * 2. ç”¨usedæ•°ç»„æ ‡è®°å·²é€‰æ•°å­—ï¼Œé¿å…é‡å¤é€‰å–ï¼›
 * 3. æ— éœ€startå‚æ•°ï¼ˆæ’åˆ—éœ€è¦éå†æ‰€æœ‰æœªé€‰æ•°å­—ï¼Œè€Œéä»æŸä¸€ä½ç½®å¼€å§‹ï¼‰ã€‚
 * <span class="hljs-doctag">@param</span> nums æ— é‡å¤å…ƒç´ çš„æ•°å­—æ•°ç»„
 * <span class="hljs-doctag">@returns</span> æ‰€æœ‰å¯èƒ½çš„æ’åˆ—æ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">permute</span>(<span class="hljs-params">nums: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">number</span>[][] {
  <span class="hljs-comment">// ç»“æœæ•°ç»„ï¼šå­˜å‚¨æ‰€æœ‰æ’åˆ—ï¼ˆéœ€æ·±æ‹·è´ï¼Œé¿å…å¼•ç”¨æ±¡æŸ“ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: <span class="hljs-built_in">number</span>[][] = [];
  <span class="hljs-comment">// æ•°ç»„é•¿åº¦ï¼šé¿å…å¾ªç¯ä¸­é‡å¤è®¡ç®—</span>
  <span class="hljs-keyword">const</span> len = nums.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// ã€æ ¸å¿ƒã€‘usedæ•°ç»„ï¼šæ ‡è®°ç´¢å¼•içš„æ•°å­—æ˜¯å¦å·²è¢«é€‰å…¥å½“å‰è·¯å¾„ï¼Œåˆå§‹å…¨ä¸ºfalse</span>
  <span class="hljs-keyword">const</span> used = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(len).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">/**
   * å›æº¯æ ¸å¿ƒå‡½æ•°
   * <span class="hljs-doctag">@param</span> path å½“å‰å·²é€‰æ•°å­—çš„è·¯å¾„ï¼ˆå¼•ç”¨ç±»å‹ï¼Œéœ€æ³¨æ„å›æº¯æ’¤é”€ï¼‰
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path: <span class="hljs-built_in">number</span>[]</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šå½“å‰è·¯å¾„é•¿åº¦ç­‰äºæ•°ç»„é•¿åº¦ï¼Œæ‰¾åˆ°ä¸€ä¸ªå®Œæ•´æ’åˆ—</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === len) {
      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹1ã€‘å¿…é¡»æ·±æ‹·è´ï¼ç›´æ¥push(path)ä¼šå› å¼•ç”¨å¯¼è‡´åç»­popä¿®æ”¹ç»“æœ</span>
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// éå†æ‰€æœ‰æ•°å­—ï¼ˆæ’åˆ—éœ€éå†å…¨éƒ¨ï¼Œè€Œéä»startå¼€å§‹ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
      <span class="hljs-comment">// ã€æ˜“é”™ç‚¹2ã€‘è·³è¿‡å·²é€‰æ•°å­—ï¼šused[i]ä¸ºtrueæ—¶ï¼Œå½“å‰æ•°å­—å·²åœ¨pathä¸­ï¼Œé¿å…é‡å¤é€‰å–</span>
      <span class="hljs-keyword">if</span> (used[i]) {
        <span class="hljs-keyword">continue</span>;
      }

      <span class="hljs-comment">// 1. æ ‡è®°å½“å‰æ•°å­—ä¸ºå·²é€‰</span>
      used[i] = <span class="hljs-literal">true</span>;
      <span class="hljs-comment">// 2. åšé€‰æ‹©ï¼šå°†å½“å‰æ•°å­—åŠ å…¥è·¯å¾„</span>
      <span class="hljs-keyword">const</span> cur = nums[i];
      path.<span class="hljs-title function_">push</span>(cur);

      <span class="hljs-comment">// é€’å½’ï¼šç»§ç»­æ„å»ºæ’åˆ—ï¼ˆæ— éœ€ä¼ startï¼Œå› ä¸ºè¦éå†æ‰€æœ‰æœªé€‰æ•°å­—ï¼‰</span>
      <span class="hljs-title function_">backtrack</span>(path);

      <span class="hljs-comment">// 3. æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼Œæ¢å¤çŠ¶æ€ï¼ˆå…ˆpopè·¯å¾„ï¼Œå†å–æ¶ˆusedæ ‡è®°ï¼‰</span>
      path.<span class="hljs-title function_">pop</span>();
      used[i] = <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„å¼€å§‹æ„å»ºæ’åˆ—</span>
  <span class="hljs-title function_">backtrack</span>([]);
  <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">permute</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">permute</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[0,1],[1,0]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">permute</span>([<span class="hljs-number">1</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1]]</span>
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å¿˜è®°ä½¿ç”¨<code>used</code>æ•°ç»„å¯¼è‡´é‡å¤é€‰åŒä¸€ä¸ªæ•°å­—</li>
<li>å¾ªç¯åº”è¯¥ä»0å¼€å§‹ï¼Œä¸æ˜¯ä»<code>start</code>å¼€å§‹ï¼ˆæ’åˆ—éœ€è¦è€ƒè™‘æ‰€æœ‰ä½ç½®ï¼‰</li>
</ul>
<hr/>
<h6 data-id="heading-22"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fpermutations-ii%2F" target="_blank" title="https://leetcode.cn/problems/permutations-ii/" ref="nofollow noopener noreferrer">47. å…¨æ’åˆ— II</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™å®šä¸€ä¸ªå¯åŒ…å«é‡å¤æ•°å­—çš„åºåˆ— <code>nums</code>ï¼Œ<strong>æŒ‰ä»»æ„é¡ºåº</strong>è¿”å›æ‰€æœ‰ä¸é‡å¤çš„å…¨æ’åˆ—ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">nums</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]
è¾“å‡ºï¼š
<span class="hljs-section">[[1,1,2]</span>,
 <span class="hljs-section">[1,2,1]</span>,
 <span class="hljs-section">[2,1,1]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * å…¨æ’åˆ—IIï¼šç”Ÿæˆå«é‡å¤æ•°å­—æ•°ç»„çš„æ‰€æœ‰ä¸é‡å¤æ’åˆ—
 * æ ¸å¿ƒç›®æ ‡ï¼š
 * 1. ç”Ÿæˆæ‰€æœ‰æ’åˆ—ï¼ˆè€ƒè™‘é¡ºåºï¼Œå¦‚[1,2]â‰ [2,1]ï¼‰ï¼›
 * 2. è¿‡æ»¤é‡å¤æ’åˆ—ï¼ˆå¦‚[1,1,2]ä»…ä¿ç•™å”¯ä¸€çš„3ç§æ’åˆ—ï¼‰ã€‚
 * <span class="hljs-doctag">@param</span> nums å¯èƒ½åŒ…å«é‡å¤å…ƒç´ çš„æ•°å­—æ•°ç»„
 * <span class="hljs-doctag">@returns</span> æ‰€æœ‰ä¸é‡å¤çš„æ’åˆ—æ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">permuteUnique</span>(<span class="hljs-params">nums: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">number</span>[][] {
  <span class="hljs-comment">// ç»“æœæ•°ç»„ï¼šå­˜å‚¨æœ€ç»ˆä¸é‡å¤çš„æ’åˆ—ï¼ˆæ·±æ‹·è´é¿å…å¼•ç”¨æ±¡æŸ“ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: <span class="hljs-built_in">number</span>[][] = [];
  <span class="hljs-comment">// æ•°ç»„é•¿åº¦ï¼šé¿å…å¾ªç¯ä¸­é‡å¤è®¡ç®—</span>
  <span class="hljs-keyword">const</span> len = nums.<span class="hljs-property">length</span>;
  <span class="hljs-comment">// usedæ•°ç»„ï¼šæ ‡è®°ç´¢å¼•içš„æ•°å­—æ˜¯å¦å·²è¢«é€‰å…¥å½“å‰è·¯å¾„ï¼Œåˆå§‹å…¨ä¸ºæœªé€‰ï¼ˆfalseï¼‰</span>
  <span class="hljs-keyword">const</span> used = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(len).<span class="hljs-title function_">fill</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// ã€æ ¸å¿ƒå‰ç½®æ“ä½œã€‘æ’åºï¼šè®©é‡å¤æ•°å­—ç›¸é‚»ï¼Œä¸ºåç»­å»é‡å‰ªæåšå‡†å¤‡</span>
  <span class="hljs-comment">// ä¾‹ï¼š[1,2,1] â†’ [1,1,2]ï¼Œä¿è¯é‡å¤æ•°å­—æŒ¨åœ¨ä¸€èµ·</span>
  nums.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x - y);

  <span class="hljs-comment">/**
   * å›æº¯æ ¸å¿ƒå‡½æ•°ï¼šé€’å½’æ„å»ºæ’åˆ—è·¯å¾„
   * <span class="hljs-doctag">@param</span> path å½“å‰å·²é€‰æ•°å­—çš„è·¯å¾„ï¼ˆå¼•ç”¨ç±»å‹ï¼Œéœ€å›æº¯æ’¤é”€ï¼‰
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path: <span class="hljs-built_in">number</span>[]</span>) {
    <span class="hljs-comment">// ç»ˆæ­¢æ¡ä»¶ï¼šè·¯å¾„é•¿åº¦ç­‰äºæ•°ç»„é•¿åº¦ â†’ æ‰¾åˆ°ä¸€ä¸ªå®Œæ•´æ’åˆ—</span>
    <span class="hljs-keyword">if</span> (path.<span class="hljs-property">length</span> === len) {
      <span class="hljs-comment">// æ·±æ‹·è´pathï¼šé¿å…åç»­popä¿®æ”¹å·²å­˜å…¥resçš„æ•°ç»„</span>
      res.<span class="hljs-title function_">push</span>([...path]);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// éå†æ‰€æœ‰æ•°å­—ï¼ˆæ’åˆ—éœ€éå†å…¨éƒ¨ï¼Œè€Œéä»startå¼€å§‹ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; i++) {
      <span class="hljs-comment">// å‰ªæ1ï¼šè·³è¿‡å·²é€‰æ•°å­—ï¼ˆé¿å…åŒä¸€æ’åˆ—ä¸­é‡å¤é€‰åŒä¸€æ•°å­—ï¼‰</span>
      <span class="hljs-keyword">if</span> (used[i]) {
        <span class="hljs-keyword">continue</span>;
      }

      <span class="hljs-comment">// ã€æ ¸å¿ƒå»é‡å‰ªæã€‘è¿‡æ»¤åŒä¸€å±‚çš„é‡å¤æ•°å­—</span>
      <span class="hljs-comment">// æ¡ä»¶1ï¼ši&gt;0 â†’ é¿å…i=0æ—¶i-1è¶Šç•Œ</span>
      <span class="hljs-comment">// æ¡ä»¶2ï¼šnums[i] === nums[i-1] â†’ å½“å‰æ•°å­—å’Œå‰ä¸€ä¸ªæ•°å­—é‡å¤</span>
      <span class="hljs-comment">// æ¡ä»¶3ï¼š!used[i-1] â†’ å‰ä¸€ä¸ªé‡å¤æ•°å­—æœªè¢«é€‰ï¼ˆè¯´æ˜æ˜¯åŒä¸€å±‚çš„é‡å¤ï¼‰ï¼Œè°å…ˆè¢«é€‰ï¼Œè°å°±å äº†è¿™ä¸ª â€œé‡å¤æ•°å­—å¼€å¤´â€ çš„å‘ï¼Œåé¢çš„é‡å¤æ•°å­—ä¸ç”¨å†é€‰ï¼ˆæ²¡è¢«é€‰èµ°â†’è·³è¿‡ï¼‰ï¼›</span>
      <span class="hljs-comment">// ä½œç”¨ï¼šä»…è·³è¿‡ã€ŒåŒä¸€å±‚ã€çš„é‡å¤æ•°å­—ï¼Œå…è®¸ã€Œä¸åŒå±‚ã€é€‰ç›¸åŒæ•°å­—</span>
      <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; nums[i] === nums[i - <span class="hljs-number">1</span>] &amp;&amp; !used[i - <span class="hljs-number">1</span>]) {
        <span class="hljs-keyword">continue</span>;
      }

      <span class="hljs-comment">// 1. æ ‡è®°å½“å‰æ•°å­—ä¸ºå·²é€‰</span>
      used[i] = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">const</span> cur = nums[i];
      <span class="hljs-comment">// 2. åšé€‰æ‹©ï¼šå°†å½“å‰æ•°å­—åŠ å…¥è·¯å¾„</span>
      path.<span class="hljs-title function_">push</span>(cur);

      <span class="hljs-comment">// é€’å½’ï¼šç»§ç»­æ„å»ºä¸‹ä¸€å±‚çš„æ’åˆ—</span>
      <span class="hljs-title function_">backtrack</span>(path);

      <span class="hljs-comment">// 3. æ’¤é”€é€‰æ‹©ï¼ˆå›æº¯æ ¸å¿ƒï¼‰ï¼šæ¢å¤è·¯å¾„å’Œusedæ ‡è®°</span>
      path.<span class="hljs-title function_">pop</span>();
      used[i] = <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šä»ç©ºè·¯å¾„å¼€å§‹æ„å»ºæ’åˆ—</span>
  <span class="hljs-title function_">backtrack</span>([]);
  <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹ï¼ˆéªŒè¯å»é‡å’Œå®Œæ•´æ€§ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">permuteUnique</span>([<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,1,2],[1,2,1],[2,1,1]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">permuteUnique</span>([<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[1,1,2,2],[1,2,1,2],[1,2,2,1],[2,1,1,2],[2,1,2,1],[2,2,1,1]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">permuteUnique</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼šå’Œpermuteä¸€è‡´ â†’ [[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]</span>
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å»é‡é€»è¾‘é”™è¯¯ï¼šåº”è¯¥æ˜¯<code>!used[i - 1]</code>è€Œä¸æ˜¯<code>used[i - 1]</code>
<ul>
<li><code>!used[i - 1]</code>ï¼šå‰ä¸€ä¸ªç›¸åŒæ•°å­—æœªè¢«ä½¿ç”¨ï¼Œè¯´æ˜æˆ‘ä»¬åœ¨åŒä¸€å±‚å°è¯•é‡å¤æ•°å­—ï¼Œåº”è¯¥è·³è¿‡</li>
<li><code>used[i - 1]</code>ï¼šå‰ä¸€ä¸ªç›¸åŒæ•°å­—å·²è¢«ä½¿ç”¨ï¼Œè¯´æ˜æˆ‘ä»¬åœ¨ä¸åŒå±‚ï¼Œå¯ä»¥ä½¿ç”¨</li>
</ul>
</li>
</ul>
<hr/>
<h4 data-id="heading-23">3. å­é›†é—®é¢˜</h4>
<h5 data-id="heading-24">æ ¸å¿ƒç‰¹å¾</h5>
<ul>
<li>æ‰¾å‡ºæ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆåŒ…æ‹¬ç©ºé›†ï¼‰</li>
<li>ç”¨<code>start</code>å‚æ•°æ§åˆ¶ä¸å›å¤´é€‰ï¼Œæ— éœ€ä¸¥æ ¼ç»ˆæ­¢æ¡ä»¶ï¼ˆæ¯æ¬¡é€’å½’éƒ½è®°å½•è·¯å¾„ï¼‰</li>
<li>å«é‡å¤æ•°å­—çš„å­é›†ï¼ˆå­é›†IIï¼‰éœ€å¢åŠ "å»é‡å‰ªæ"</li>
</ul>
<h5 data-id="heading-25">LeetCode é¢˜ç›®è¯¦è§£</h5>
<h6 data-id="heading-26"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fsubsets%2F" target="_blank" title="https://leetcode.cn/problems/subsets/" ref="nofollow noopener noreferrer">78. å­é›†</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œæ•°ç»„ä¸­çš„å…ƒç´ <strong>äº’ä¸ç›¸åŒ</strong>ã€‚è¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚</p>
<p>è§£é›†<strong>ä¸èƒ½</strong>åŒ…å«é‡å¤çš„å­é›†ã€‚ä½ å¯ä»¥æŒ‰<strong>ä»»æ„é¡ºåº</strong>è¿”å›è§£é›†ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">nums</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
è¾“å‡ºï¼š<span class="hljs-section">[[]</span>,<span class="hljs-section">[1]</span>,<span class="hljs-section">[2]</span>,<span class="hljs-section">[1,2]</span>,<span class="hljs-section">[3]</span>,<span class="hljs-section">[1,3]</span>,<span class="hljs-section">[2,3]</span>,<span class="hljs-section">[1,2,3]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * å­é›†ï¼šç”Ÿæˆæ•°ç»„çš„æ‰€æœ‰å­é›†ï¼ˆåŒ…æ‹¬ç©ºé›†å’Œæ•°ç»„æœ¬èº«ï¼Œå­é›†ä¸è€ƒè™‘é¡ºåºï¼‰
 * æ ¸å¿ƒè§„åˆ™ï¼š
 * 1. å­é›†ä¸è€ƒè™‘é¡ºåºï¼ˆå¦‚[1,2]å’Œ[2,1]æ˜¯åŒä¸€ä¸ªå­é›†ï¼Œé€šè¿‡startIndexæ§åˆ¶ä¸å›å¤´é€‰ï¼‰ï¼›
 * 2. æ¯ä¸ªå­é›†æ˜¯åŸæ•°ç»„çš„ä»»æ„å…ƒç´ ç»„åˆï¼ˆå…ƒç´ ä¸é‡å¤é€‰å–ï¼‰ï¼›
 * 3. æ— éœ€å»é‡ï¼ˆè‹¥numsæ— é‡å¤å…ƒç´ ï¼‰ï¼Œæ— éœ€æ’åºã€‚
 * <span class="hljs-doctag">@param</span> nums æ— é‡å¤å…ƒç´ çš„æ•°å­—æ•°ç»„
 * <span class="hljs-doctag">@returns</span> æ‰€æœ‰å­é›†ç»„æˆçš„äºŒç»´æ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">subsets</span>(<span class="hljs-params">nums: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">number</span>[][] {
  <span class="hljs-comment">// ç»“æœæ•°ç»„ï¼šå­˜å‚¨æ‰€æœ‰å­é›†ï¼ˆæ·±æ‹·è´é¿å…å¼•ç”¨æ±¡æŸ“ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: <span class="hljs-built_in">number</span>[][] = [];
  <span class="hljs-comment">// æ•°ç»„é•¿åº¦ï¼šé¿å…å¾ªç¯ä¸­é‡å¤è®¡ç®—</span>
  <span class="hljs-keyword">const</span> len = nums.<span class="hljs-property">length</span>;

  <span class="hljs-comment">/**
   * å›æº¯æ ¸å¿ƒå‡½æ•°ï¼šé€’å½’æ„å»ºå­é›†è·¯å¾„
   * <span class="hljs-doctag">@param</span> path å½“å‰å­é›†è·¯å¾„ï¼ˆå¼•ç”¨ç±»å‹ï¼Œéœ€å›æº¯æ’¤é”€ï¼‰
   * <span class="hljs-doctag">@param</span> startIndex éå†èµ·å§‹ç´¢å¼•ï¼ˆæ§åˆ¶ä¸å›å¤´é€‰ï¼Œé¿å…ç”Ÿæˆé‡å¤å­é›†ï¼‰
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path: <span class="hljs-built_in">number</span>[], startIndex: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-comment">// ã€æ ¸å¿ƒã€‘æ¯è¿›å…¥ä¸€å±‚é€’å½’ï¼Œå…ˆè®°å½•å½“å‰è·¯å¾„ï¼ˆåŒ…æ‹¬ç©ºé›†ï¼‰</span>
    <span class="hljs-comment">// åŒºåˆ«äºæ’åˆ—/ç»„åˆï¼šå­é›†é—®é¢˜æ— ç»ˆæ­¢æ¡ä»¶ï¼ˆæ‰€æœ‰è·¯å¾„éƒ½æ˜¯æœ‰æ•ˆå­é›†ï¼‰ï¼Œæ¯ä¸€æ­¥éƒ½è¦ä¿å­˜</span>
    res.<span class="hljs-title function_">push</span>([...path]);

    <span class="hljs-comment">// éå†æ•°ç»„ï¼šä»startIndexå¼€å§‹ï¼Œé¿å…å›å¤´é€‰ï¼ˆå¦‚é€‰1ååªé€‰2/3ï¼Œä¸å›å¤´é€‰1ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startIndex; i &lt; len; i++) {
      <span class="hljs-keyword">const</span> cur = nums[i];
      <span class="hljs-comment">// åšé€‰æ‹©ï¼šå°†å½“å‰æ•°å­—åŠ å…¥å­é›†è·¯å¾„</span>
      path.<span class="hljs-title function_">push</span>(cur);
      <span class="hljs-comment">// é€’å½’ï¼šä¸‹ä¸€å±‚ä»i+1å¼€å§‹ï¼ˆä¿è¯å…ƒç´ ä¸é‡å¤é€‰å–ï¼‰</span>
      <span class="hljs-title function_">backtrack</span>(path, i + <span class="hljs-number">1</span>);
      <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼Œæ¢å¤è·¯å¾„çŠ¶æ€</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„å¼€å§‹ï¼Œä»ç´¢å¼•0éå†</span>
  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">subsets</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[],[1],[1,2],[1,2,3],[1,3],[2],[2,3],[3]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">subsets</span>([<span class="hljs-number">0</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[],[0]]</span>
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å¿˜è®°åœ¨æ¯æ¬¡é€’å½’å¼€å§‹æ—¶è®°å½•è·¯å¾„ï¼ˆå­é›†é—®é¢˜éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹éƒ½è®°å½•ï¼Œä¸åªæ˜¯å¶å­èŠ‚ç‚¹ï¼‰</li>
</ul>
<hr/>
<h6 data-id="heading-27"><a href="https://link.juejin.cn?target=https%3A%2F%2Fleetcode.cn%2Fproblems%2Fsubsets-ii%2F" target="_blank" title="https://leetcode.cn/problems/subsets-ii/" ref="nofollow noopener noreferrer">90. å­é›† II</a></h6>
<p><strong>é¢˜ç›®æè¿°ï¼š</strong></p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>nums</code>ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«é‡å¤å…ƒç´ ï¼Œè¯·ä½ è¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚</p>
<p>è§£é›†<strong>ä¸èƒ½</strong>åŒ…å«é‡å¤çš„å­é›†ã€‚è¿”å›çš„è§£é›†ä¸­ï¼Œå­é›†å¯ä»¥æŒ‰<strong>ä»»æ„é¡ºåº</strong>æ’åˆ—ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini">è¾“å…¥ï¼š<span class="hljs-attr">nums</span> = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>]
è¾“å‡ºï¼š<span class="hljs-section">[[]</span>,<span class="hljs-section">[1]</span>,<span class="hljs-section">[1,2]</span>,<span class="hljs-section">[1,2,2]</span>,<span class="hljs-section">[2]</span>,<span class="hljs-section">[2,2]]</span>
</code></pre>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">/**
 * å­é›†IIï¼šç”Ÿæˆå«é‡å¤æ•°å­—æ•°ç»„çš„æ‰€æœ‰ä¸é‡å¤å­é›†ï¼ˆåŒ…æ‹¬ç©ºé›†å’Œæ•°ç»„æœ¬èº«ï¼‰
 * æ ¸å¿ƒç›®æ ‡ï¼š
 * 1. ç”Ÿæˆæ‰€æœ‰å­é›†ï¼ˆå­é›†ä¸è€ƒè™‘é¡ºåºï¼‰ï¼›
 * 2. è¿‡æ»¤é‡å¤å­é›†ï¼ˆå¦‚nums=[1,2,2]æ—¶ï¼Œé¿å…ç”Ÿæˆä¸¤ä¸ª[1,2]ï¼‰ã€‚
 * <span class="hljs-doctag">@param</span> nums å¯èƒ½åŒ…å«é‡å¤å…ƒç´ çš„æ•°å­—æ•°ç»„
 * <span class="hljs-doctag">@returns</span> æ‰€æœ‰ä¸é‡å¤å­é›†ç»„æˆçš„äºŒç»´æ•°ç»„
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">subsetsWithDup</span>(<span class="hljs-params">nums: <span class="hljs-built_in">number</span>[]</span>): <span class="hljs-built_in">number</span>[][] {
  <span class="hljs-comment">// ç»“æœæ•°ç»„ï¼šå­˜å‚¨æ‰€æœ‰ä¸é‡å¤å­é›†ï¼ˆæ·±æ‹·è´é¿å…å¼•ç”¨æ±¡æŸ“ï¼‰</span>
  <span class="hljs-keyword">const</span> <span class="hljs-attr">res</span>: <span class="hljs-built_in">number</span>[][] = [];
  <span class="hljs-keyword">const</span> len = nums.<span class="hljs-property">length</span>;

  <span class="hljs-comment">// ã€æ ¸å¿ƒå‰ç½®æ“ä½œã€‘æ’åºï¼šè®©é‡å¤æ•°å­—ç›¸é‚»ï¼Œä¸ºå»é‡å‰ªæåšå‡†å¤‡</span>
  <span class="hljs-comment">// ä¾‹ï¼š[1,2,2]æ’åºåä»ä¸º[1,2,2]ï¼Œ[2,1,2]æ’åºåä¸º[1,2,2]ï¼Œä¿è¯é‡å¤æ•°å­—æŒ¨åœ¨ä¸€èµ·</span>
  nums.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> x - y);

  <span class="hljs-comment">/**
   * å›æº¯æ ¸å¿ƒå‡½æ•°ï¼šé€’å½’æ„å»ºå­é›†è·¯å¾„
   * <span class="hljs-doctag">@param</span> path å½“å‰å­é›†è·¯å¾„ï¼ˆå¼•ç”¨ç±»å‹ï¼Œéœ€å›æº¯æ’¤é”€ï¼‰
   * <span class="hljs-doctag">@param</span> startIndex éå†èµ·å§‹ç´¢å¼•ï¼ˆæ§åˆ¶ä¸å›å¤´é€‰ï¼Œé¿å…ç”Ÿæˆé‡å¤å­é›†ï¼‰
   */</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">backtrack</span>(<span class="hljs-params">path: <span class="hljs-built_in">number</span>[], startIndex: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-comment">// å­é›†é—®é¢˜æ ¸å¿ƒï¼šæ¯è¿›å…¥ä¸€å±‚é€’å½’ï¼Œå…ˆä¿å­˜å½“å‰è·¯å¾„ï¼ˆåŒ…æ‹¬ç©ºé›†ï¼‰</span>
    <span class="hljs-comment">// æ‰€æœ‰è·¯å¾„éƒ½æ˜¯æœ‰æ•ˆå­é›†ï¼Œæ— éœ€ç­‰å¾…â€œé•¿åº¦è¾¾æ ‡â€ï¼Œè¿™æ˜¯å­é›†å’Œç»„åˆ/æ’åˆ—çš„æ ¸å¿ƒåŒºåˆ«</span>
    res.<span class="hljs-title function_">push</span>([...path]);

    <span class="hljs-comment">// éå†æ•°ç»„ï¼šä»startIndexå¼€å§‹ï¼Œé¿å…å›å¤´é€‰ï¼ˆå¦‚é€‰1ååªé€‰2/2ï¼Œä¸å›å¤´é€‰1ï¼‰</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = startIndex; i &lt; len; i++) {
      <span class="hljs-comment">// ã€æ ¸å¿ƒå»é‡å‰ªæã€‘è¿‡æ»¤åŒä¸€å±‚çš„é‡å¤æ•°å­—</span>
      <span class="hljs-comment">// æ¡ä»¶1ï¼ši &gt; startIndex â†’ è·³è¿‡â€œå½“å‰å±‚ç¬¬ä¸€ä¸ªæ•°å­—â€ï¼ˆé¿å…è¯¯è¿‡æ»¤è·¨å±‚é‡å¤ï¼‰</span>
      <span class="hljs-comment">// æ¡ä»¶2ï¼šnums[i] === nums[i - 1] â†’ å½“å‰æ•°å­—å’Œå‰ä¸€ä¸ªæ•°å­—é‡å¤</span>
      <span class="hljs-comment">// ä½œç”¨ï¼šä»…è·³è¿‡åŒä¸€å±‚çš„é‡å¤æ•°å­—ï¼Œä¿ç•™ä¸åŒå±‚çš„é‡å¤æ•°å­—ï¼ˆå¦‚[2]å’Œ[1,2]éƒ½æ˜¯æœ‰æ•ˆå­é›†ï¼‰</span>
      <span class="hljs-keyword">if</span> (i &gt; startIndex &amp;&amp; nums[i] === nums[i - <span class="hljs-number">1</span>]) {
        <span class="hljs-keyword">continue</span>;
      }

      <span class="hljs-keyword">const</span> cur = nums[i];
      <span class="hljs-comment">// åšé€‰æ‹©ï¼šå°†å½“å‰æ•°å­—åŠ å…¥å­é›†è·¯å¾„</span>
      path.<span class="hljs-title function_">push</span>(cur);
      <span class="hljs-comment">// é€’å½’ï¼šä¸‹ä¸€å±‚ä»i+1å¼€å§‹ï¼ˆä¿è¯å…ƒç´ ä¸é‡å¤é€‰å–ï¼‰</span>
      <span class="hljs-title function_">backtrack</span>(path, i + <span class="hljs-number">1</span>);
      <span class="hljs-comment">// æ’¤é”€é€‰æ‹©ï¼šå›æº¯æ ¸å¿ƒï¼Œæ¢å¤è·¯å¾„çŠ¶æ€</span>
      path.<span class="hljs-title function_">pop</span>();
    }
  }

  <span class="hljs-comment">// åˆå§‹è°ƒç”¨ï¼šç©ºè·¯å¾„å¼€å§‹ï¼Œä»ç´¢å¼•0éå†</span>
  <span class="hljs-title function_">backtrack</span>([], <span class="hljs-number">0</span>);
  <span class="hljs-keyword">return</span> res;
}

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹ï¼ˆéªŒè¯å»é‡æ•ˆæœï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">subsetsWithDup</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[],[1],[1,2],[1,2,2],[2],[2,2]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">subsetsWithDup</span>([<span class="hljs-number">0</span>]));
<span class="hljs-comment">// æ­£ç¡®è¾“å‡ºï¼š[[],[0]]</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">subsetsWithDup</span>([<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>]));
<span class="hljs-comment">// æ’åºåä¸º[1,2,2]ï¼Œè¾“å‡ºå’Œä¸Šé¢ä¸€è‡´ â†’ [[],[1],[1,2],[1,2,2],[2],[2,2]]</span>
</code></pre>
<p><strong>æ˜“é”™ç‚¹ï¼š</strong></p>
<ul>
<li>å»é‡é€»è¾‘å’Œç»„åˆæ€»å’ŒIIç›¸åŒï¼Œä½†å®¹æ˜“å¿˜è®°æ’åº</li>
</ul>
<hr/>
<h3 data-id="heading-28">å››ã€æ€»ç»“</h3>













































































<table><thead><tr><th>åˆ†ç±»</th><th>é¢˜å·&amp;åç§°</th><th>æ ¸å¿ƒè§„åˆ™</th><th>å…³é”®æ“ä½œ</th><th>ç»ˆæ­¢/ä¿å­˜æ¡ä»¶</th><th>å»é‡&amp;å‰ªææŠ€å·§</th></tr></thead><tbody><tr><td><strong>ç»„åˆç±»</strong></td><td>39. ç»„åˆæ€»å’Œ</td><td>1. æ•°å­—å¯é‡å¤é€‰<br/>2. å€™é€‰æ•°ç»„æ— é‡å¤<br/>3. ç»„åˆå’Œä¸ºtarget</td><td>1. é€’å½’å‚æ•°ä¼ <code>i</code>ï¼ˆå…è®¸é‡å¤é€‰å½“å‰æ•°ï¼‰<br/>2. ç”¨<code>startIndex</code>æ§åˆ¶ä¸å›å¤´é€‰</td><td>1. <code>sum === target</code> â†’ ä¿å­˜è·¯å¾„<br/>2. <code>sum &gt; target</code> â†’ å‰ªæè¿”å›</td><td>1. æ’åºï¼ˆ<code>nums.sort</code>ï¼‰æ˜¯å‰ªæå‰æ<br/>2. <code>sum + cur &gt; target</code> â†’ <code>break</code>ï¼ˆåç»­æ•°æ›´å¤§ï¼‰</td></tr><tr><td/><td>40. ç»„åˆæ€»å’Œ II</td><td>1. æ•°å­—ä¸å¯é‡å¤é€‰<br/>2. å€™é€‰æ•°ç»„æœ‰é‡å¤<br/>3. ç»„åˆå’Œä¸ºtarget</td><td>1. é€’å½’å‚æ•°ä¼ <code>i+1</code>ï¼ˆä¸å¯é‡å¤é€‰ï¼‰<br/>2. ç”¨<code>startIndex</code>æ§åˆ¶ä¸å›å¤´é€‰</td><td>1. <code>sum === target</code> â†’ ä¿å­˜è·¯å¾„<br/>2. <code>sum &gt; target</code> â†’ å‰ªæè¿”å›</td><td>1. å…ˆæ’åºï¼ˆè®©é‡å¤æ•°å­—ç›¸é‚»ï¼‰<br/>2. åŒå±‚å»é‡ï¼š<code>i &gt; startIndex &amp;&amp; nums[i] === nums[i-1]</code> â†’ <code>continue</code><br/>3. <code>sum + cur &gt; target</code> â†’ <code>break</code></td></tr><tr><td/><td>77. ç»„åˆ</td><td>1. ä» <code>1~n</code> é€‰ <code>k</code> ä¸ªæ•°å­—<br/>2. æ— é‡å¤ç»„åˆ<br/>3. ä¸è€ƒè™‘é¡ºåº</td><td>1. é€’å½’å‚æ•°ä¼ <code>i+1</code><br/>2. ç”¨<code>startIndex</code>æ§åˆ¶ä¸å›å¤´é€‰</td><td><code>path.length === k</code> â†’ ä¿å­˜è·¯å¾„</td><td>å‰ªæï¼š<code>path.length + (n - startIndex + 1) &lt; k</code> â†’ å‰ªæï¼ˆå‰©ä½™æ•°ä¸å¤Ÿå‡‘kä¸ªï¼‰</td></tr><tr><td/><td>216. ç»„åˆæ€»å’Œ III</td><td>1. ä» <code>1~9</code> é€‰ <code>k</code> ä¸ªæ•°å­—<br/>2. æ•°å­—ä¸å¯é‡å¤é€‰<br/>3. ç»„åˆå’Œä¸º<code>n</code></td><td>1. é€’å½’å‚æ•°ä¼ <code>i+1</code><br/>2. ç”¨<code>startIndex</code>æ§åˆ¶ä¸å›å¤´é€‰</td><td><code>path.length === k</code> <strong>ä¸”</strong> <code>sum === n</code> â†’ ä¿å­˜è·¯å¾„</td><td>1. 1~9å¤©ç„¶æœ‰åºï¼Œæ— éœ€æ’åº<br/>2. <code>sum + cur &gt; n</code> â†’ <code>break</code><br/>3. å‰©ä½™æ•°å‰ªæï¼ˆåŒ77é¢˜ï¼‰</td></tr><tr><td><strong>æ’åˆ—ç±»</strong></td><td>46. å…¨æ’åˆ—</td><td>1. å€™é€‰æ•°ç»„æ— é‡å¤<br/>2. ç”Ÿæˆæ‰€æœ‰æ’åˆ—ï¼ˆè€ƒè™‘é¡ºåºï¼‰</td><td>1. ç”¨<code>used</code>æ•°ç»„æ ‡è®°å·²é€‰æ•°å­—<br/>2. éå†èŒƒå›´<code>0~len-1</code>ï¼ˆæ— <code>startIndex</code>ï¼‰</td><td><code>path.length === len</code> â†’ ä¿å­˜è·¯å¾„</td><td>æ— éœ€å»é‡ï¼Œä»…ç”¨<code>used[i]</code> â†’ <code>continue</code>ï¼ˆè·³è¿‡å·²é€‰æ•°å­—ï¼‰</td></tr><tr><td/><td>47. å…¨æ’åˆ— II</td><td>1. å€™é€‰æ•°ç»„æœ‰é‡å¤<br/>2. ç”Ÿæˆæ— é‡å¤æ’åˆ—ï¼ˆè€ƒè™‘é¡ºåºï¼‰</td><td>1. ç”¨<code>used</code>æ•°ç»„æ ‡è®°å·²é€‰æ•°å­—<br/>2. éå†èŒƒå›´<code>0~len-1</code>ï¼ˆæ— <code>startIndex</code>ï¼‰</td><td><code>path.length === len</code> â†’ ä¿å­˜è·¯å¾„</td><td>1. å…ˆæ’åºï¼ˆè®©é‡å¤æ•°å­—ç›¸é‚»ï¼‰<br/>2. åŒå±‚å»é‡ï¼š<code>i &gt; 0 &amp;&amp; nums[i] === nums[i-1] &amp;&amp; !used[i-1]</code> â†’ <code>continue</code><br/>3. <code>used[i]</code> â†’ <code>continue</code>ï¼ˆè·³è¿‡å·²é€‰æ•°å­—ï¼‰</td></tr><tr><td><strong>å­é›†ç±»</strong></td><td>78. å­é›†</td><td>1. å€™é€‰æ•°ç»„æ— é‡å¤<br/>2. ç”Ÿæˆæ‰€æœ‰å­é›†ï¼ˆå«ç©ºé›†ï¼‰<br/>3. ä¸è€ƒè™‘é¡ºåº</td><td>1. é€’å½’å‚æ•°ä¼ <code>i+1</code><br/>2. ç”¨<code>startIndex</code>æ§åˆ¶ä¸å›å¤´é€‰</td><td><strong>è¿›å…¥é€’å½’å°±ä¿å­˜è·¯å¾„</strong>ï¼ˆæ‰€æœ‰è·¯å¾„éƒ½æ˜¯æœ‰æ•ˆå­é›†ï¼‰</td><td>æ— éœ€å»é‡ï¼Œæ— å‰ªæï¼ˆå­é›†æ— é•¿åº¦/å’Œé™åˆ¶ï¼‰</td></tr><tr><td/><td>90. å­é›† II</td><td>1. å€™é€‰æ•°ç»„æœ‰é‡å¤<br/>2. ç”Ÿæˆæ— é‡å¤å­é›†ï¼ˆå«ç©ºé›†ï¼‰<br/>3. ä¸è€ƒè™‘é¡ºåº</td><td>1. é€’å½’å‚æ•°ä¼ <code>i+1</code><br/>2. ç”¨<code>startIndex</code>æ§åˆ¶ä¸å›å¤´é€‰</td><td><strong>è¿›å…¥é€’å½’å°±ä¿å­˜è·¯å¾„</strong>ï¼ˆæ‰€æœ‰è·¯å¾„éƒ½æ˜¯æœ‰æ•ˆå­é›†ï¼‰</td><td>1. å…ˆæ’åºï¼ˆè®©é‡å¤æ•°å­—ç›¸é‚»ï¼‰<br/>2. åŒå±‚å»é‡ï¼š<code>i &gt; startIndex &amp;&amp; nums[i] === nums[i-1]</code> â†’ <code>continue</code></td></tr></tbody></table>
<ul>
<li><strong>æ’åº</strong>ï¼šåªè¦æ¶‰åŠâ€œå»é‡/å‰ªæâ€ï¼Œç¬¬ä¸€æ­¥å¿…æ’åºï¼ˆè®©é‡å¤æ•°å­—ç›¸é‚»ã€è®©æ•°å­—é€’å¢ä¾¿äºsumå‰ªæï¼‰ï¼›</li>
<li><strong>æ·±æ‹·è´</strong>ï¼šæ‰€æœ‰é¢˜éƒ½éœ€è¦<code>res.push([...path])</code>ï¼Œç›´æ¥push(path)ä¼šå› å¼•ç”¨å¯¼è‡´ç»“æœé”™è¯¯ï¼›</li>
<li><strong>å›æº¯é—­ç¯</strong>ï¼šé€‰æ•°å­—ï¼ˆpushï¼‰â†’ é€’å½’ â†’ æ’¤é”€é€‰ï¼ˆpopï¼‰ï¼Œå¿ƒæ˜¯"é€‰â†’æ¢â†’æ’¤"ï¼Œç¼ºä¸€ä¸å¯ã€‚</li>
<li><strong>æ¨¡æ¿å¤ç”¨</strong>ï¼š
<ul>
<li>ç»„åˆ/å­é›†ï¼šç”¨<code>start</code>å‚æ•°é¿å…é‡å¤ï¼Œå¾ªç¯ä»<code>start</code>å¼€å§‹</li>
<li>æ’åˆ—ï¼šç”¨<code>used</code>æ•°ç»„é¿å…é‡å¤é€‰ï¼Œå¾ªç¯ä»0å¼€å§‹=</li>
</ul>
</li>
<li>å»é‡å‰ªæçš„â€œé»„é‡‘å…¬å¼â€
<ul>
<li><strong>ç»„åˆ/å­é›†å»é‡</strong>ï¼ˆæœ‰é‡å¤æ•°å­—ï¼‰ï¼š<code>i &gt; startIndex &amp;&amp; nums[i] === nums[i-1]</code>ï¼›</li>
<li><strong>æ’åˆ—å»é‡</strong>ï¼ˆæœ‰é‡å¤æ•°å­—ï¼‰ï¼š<code>i &gt; 0 &amp;&amp; nums[i] === nums[i-1] &amp;&amp; !used[i-1]</code>ï¼›</li>
<li><strong>sumå‰ªæ</strong>ï¼ˆæ‰€æœ‰æ±‚å’Œç±»é—®é¢˜ï¼‰ï¼š<code>sum + cur &gt; target</code> â†’ breakï¼ˆéœ€å…ˆæ’åºï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p>è®°ä½â€œç»„åˆçœ‹startã€æ’åˆ—çœ‹usedã€å­é›†å…¨ä¿å­˜â€çš„å£è¯€ï¼Œå°±èƒ½å¿«é€Ÿé€‚é…æ‰€æœ‰è¿™ç±»å›æº¯é—®é¢˜ï½</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®¾ç½®äº† SSL Pinning ä¸åŒå‘ TLS éªŒè¯è¦æ€ä¹ˆæŠ“åŒ…]]></title>    <link>https://juejin.cn/post/7597168034618081299</link>    <guid>https://juejin.cn/post/7597168034618081299</guid>    <pubDate>2026-01-20T09:20:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597168034618081299" data-draft-id="7597250364124446783" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®¾ç½®äº† SSL Pinning ä¸åŒå‘ TLS éªŒè¯è¦æ€ä¹ˆæŠ“åŒ…"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-20T09:20:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯è°çš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/2390811467846089"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®¾ç½®äº† SSL Pinning ä¸åŒå‘ TLS éªŒè¯è¦æ€ä¹ˆæŠ“åŒ…
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2390811467846089/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯è°çš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:20:24.000Z" title="Tue Jan 20 2026 09:20:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¾ˆå¤šäººç¬¬ä¸€æ¬¡é‡åˆ°å¸¦ <strong>PINï¼ˆè¯ä¹¦ç»‘å®šï¼‰æˆ–åŒå‘ TLS éªŒè¯</strong>çš„ App æ—¶ï¼Œéƒ½ä¼šå¡åœ¨ä¸€ä¸ªé˜¶æ®µï¼Œ
ä»£ç†è¯ä¹¦è£…å¥½äº†ï¼ŒWi-Fi ä»£ç†ä¹Ÿç”Ÿæ•ˆäº†ï¼Œä½†è¯·æ±‚å°±æ˜¯æ¶ˆå¤±äº†ã€‚</p>
<p>è¿™å¹¶ä¸æ˜¯é…ç½®é—®é¢˜ï¼Œè€Œæ˜¯ç½‘ç»œè·¯å¾„å·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚</p>
<hr/>
<h2 data-id="heading-0"><strong>ä¸ºä»€ä¹ˆ PIN + åŒå‘éªŒè¯ä¼šç›´æ¥ææ–­ä»£ç†æŠ“åŒ…</strong></h2>
<p>åœ¨æ™®é€š HTTPS ä»£ç†æŠ“åŒ…é‡Œï¼ŒæŠ“åŒ…å·¥å…·æœ¬è´¨ä¸Šæ‰®æ¼”çš„æ˜¯ ä¸­é—´äºº ã€‚
å®¢æˆ·ç«¯ä¿¡ä»»ç³»ç»Ÿè¯ä¹¦ â†’ ä»£ç†è¯ä¹¦è¢«æ¥å— â†’ TLS èƒ½æ­£å¸¸å»ºç«‹ã€‚</p>
<p>ä½†ä¸€æ—¦ App åšäº†ä¸‹é¢ä»»æ„ä¸€ä»¶äº‹ï¼š</p>
<ul>
<li>åœ¨ä»£ç é‡Œå›ºå®šæœåŠ¡ç«¯è¯ä¹¦æˆ–å…¬é’¥</li>
<li>æ ¡éªŒå®¢æˆ·ç«¯è¯ä¹¦ï¼ˆmTLSï¼‰</li>
<li>å¯¹è¯ä¹¦é“¾åšé¢å¤–æ ¡éªŒ</li>
</ul>
<p>ç³»ç»Ÿä¿¡ä»»é“¾è¿™æ¡è·¯å°±ä¸å†æˆç«‹ã€‚
è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Charlesã€Fiddler è¿™ç±»å·¥å…·ï¼Œåœ¨è¿™äº› App ä¸Šä¼šç›´æ¥å˜æˆä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚</p>
<hr/>
<h2 data-id="heading-1"><strong>æˆ‘ä¸€èˆ¬ä¸ä¼šä¸€å¼€å§‹å°±çº ç»“æ€ä¹ˆç»•è¿‡</strong></h2>
<p>åœ¨çœŸå®é¡¹ç›®ç¯å¢ƒé‡Œï¼Œæˆ‘å¾ˆå°‘ä¸€ä¸Šæ¥å°±ç ”ç©¶ PIN æ€ä¹ˆç»•ã€‚
æˆ‘æ›´å…³å¿ƒçš„æ˜¯ï¼š<strong>æœ‰æ²¡æœ‰åˆ«çš„æŠ“åŒ…æ–¹å¼ï¼Œèƒ½å…ˆè®©æˆ‘çœ‹åˆ°çœŸå®è¯·æ±‚ã€‚</strong></p>
<hr/>
<h2 data-id="heading-2"><strong>ä»ä»£ç†åˆ‡æ¢åˆ° HTTPS æš´åŠ›æŠ“åŒ…ï¼Œæ˜¯ä¸€ä¸ªæ˜æ˜¾çš„åˆ†æ°´å²­</strong></h2>
<p>åœ¨è¿™ç±»åœºæ™¯ä¸‹ï¼Œæˆ‘ä¼šç›´æ¥ä½¿ç”¨æŠ“åŒ…å¤§å¸ˆçš„ <strong>HTTPS æš´åŠ›æŠ“åŒ…</strong> æ¨¡å¼ï¼Œè€Œä¸æ˜¯ç»§ç»­åœ¨ä»£ç†æ¨¡å¼ä¸Šæ¶ˆè€—æ—¶é—´ã€‚</p>
<p>è¿™ä¸ªæ¨¡å¼æœ‰å‡ ä¸ªå…³é”®å·®å¼‚ç‚¹ï¼š</p>
<ul>
<li>ä¸ä¾èµ–ç³»ç»Ÿä»£ç†</li>
<li>ä¸éœ€è¦åœ¨ iOS ä¸Šå®‰è£…æˆ–ä¿¡ä»»è¯ä¹¦</li>
<li>è¯·æ±‚åœ¨æ›´é è¿‘ App çš„ä½ç½®è¢«æ¥ç®¡</li>
</ul>
<p>è¿™æ„å‘³ç€ï¼Œå³ä½¿ App å¼€å¯äº† PIN æˆ–åŒå‘éªŒè¯ï¼Œä¹Ÿä¸ä¼šåœ¨ TLS é˜¶æ®µæŠŠä½ æŒ¡åœ¨é—¨å¤–ã€‚</p>
<hr/>
<h2 data-id="heading-3"><strong>æˆ‘å®é™…æ“ä½œæ—¶çš„å®Œæ•´å‡†å¤‡æµç¨‹</strong></h2>
<p>è¿™é‡Œä¸æ˜¯ç†è®ºå¯è¡Œï¼Œè€Œæ˜¯æˆ‘å®é™…ä¼šç…§ç€èµ°çš„ä¸€å¥—æµç¨‹ã€‚</p>
<h3 data-id="heading-4">è®¾å¤‡å‡†å¤‡é˜¶æ®µ</h3>
<ul>
<li>ç”¨ USB å°† iPhone è¿æ¥åˆ°ç”µè„‘ï¼Œç¡®ä¿è§£é”ã€äº®å±</li>
<li>ç¬¬ä¸€æ¬¡è¿æ¥æ—¶ï¼Œåœ¨æ‰‹æœºä¸Šç‚¹â€œä¿¡ä»»æ­¤ç”µè„‘â€</li>
<li>Windows ä¸‹æŒ‰æç¤ºå®‰è£… iOS é©±åŠ¨ï¼Œå®Œæˆåé‡å¯æŠ“åŒ…å¤§å¸ˆ</li>
<li>æŒ‰æç¤ºåœ¨æ‰‹æœºä¸Šå®‰è£…æè¿°æ–‡ä»¶</li>
<li>å¦‚æœæ˜¯ iOS 17.4 åŠä»¥åç³»ç»Ÿï¼ŒæŒ‰æç¤ºå¼€å¯å¼€å‘è€…æ¨¡å¼</li>
</ul>
<p>è¿™äº›æ­¥éª¤çœ‹èµ·æ¥çç¢ï¼Œä½†ä»»ä½•ä¸€æ­¥æ²¡å®Œæˆï¼Œåé¢çš„æš´åŠ›æŠ“åŒ…éƒ½èµ·ä¸æ¥ã€‚</p>
<hr/>
<h2 data-id="heading-5"><strong>è¿›å…¥ HTTPS æš´åŠ›æŠ“åŒ…æ—¶ï¼Œæˆ‘ä¼šå…ˆè§‚å¯Ÿä¸€ä¸ªçŠ¶æ€</strong></h2>
<p>åœ¨è®¾å¤‡åˆ—è¡¨ä¸­é€‰ä¸­ iOS è®¾å¤‡åï¼Œæˆ‘ä¸ä¼šç«‹åˆ»ç‚¹åŠŸèƒ½æŒ‰é’®ï¼Œè€Œæ˜¯å…ˆçœ‹å·¦ä¸‹è§’ï¼š</p>
<ul>
<li>â€œé«˜çº§ç®¡ç†æœåŠ¡â€æ˜¯å¦å·²ç»å˜æˆç»¿è‰²</li>
<li>å¦‚æœæ²¡æœ‰ï¼Œæ‰‹åŠ¨ç‚¹å‡»å¯åŠ¨ï¼Œå¹¶ç¡®è®¤ç³»ç»Ÿæƒé™æç¤ºæ˜¯å¦å¼¹å‡º</li>
</ul>
<p>è¿™ä¸ªçŠ¶æ€æ²¡èµ·æ¥ï¼Œæš´åŠ›æŠ“åŒ…ç•Œé¢å†æ€ä¹ˆç‚¹éƒ½åªæ˜¯ç©ºæ“ä½œã€‚</p>
<hr/>
<h2 data-id="heading-6"><strong>çœŸæ­£å¼€å§‹æŠ“çš„æ—¶å€™ï¼Œæˆ‘ä¼šå…ˆé™åˆ¶èŒƒå›´</strong></h2>
<p>è¿›å…¥ HTTPS æš´åŠ›æŠ“åŒ…æ¨¡å¼åï¼Œæˆ‘ç¬¬ä¸€ä»¶äº‹ä¸æ˜¯ç‚¹â€œå¼€å§‹â€ï¼Œè€Œæ˜¯ï¼š</p>
<ul>
<li>æ‰“å¼€ã€Œé€‰æ‹© Appã€ï¼Œåªå‹¾é€‰ç›®æ ‡åº”ç”¨</li>
<li>è®¾ç½®åŸºæœ¬è¿‡æ»¤æ¡ä»¶ï¼Œé¿å…èƒŒæ™¯æµé‡å¹²æ‰°</li>
</ul>
<p>è¿™æ ·åšçš„å¥½å¤„å¾ˆç›´æ¥ï¼š
å½“ App å‘èµ·è¯·æ±‚æ—¶ï¼Œä½ èƒ½æ¸…æ¥šçœ‹åˆ°å“ªä¸€æ¡æ˜¯å®ƒäº§ç”Ÿçš„ï¼Œè€Œä¸æ˜¯è¢«ç³»ç»Ÿæµé‡æ·¹æ²¡ã€‚</p>
<hr/>
<h2 data-id="heading-7"><strong>èƒ½æŠ“åˆ° â‰  ä»€ä¹ˆéƒ½èƒ½çœ‹ï¼Œè¿™æ˜¯å¾ˆå¤šäººå®¹æ˜“è¯¯è§£çš„åœ°æ–¹</strong></h2>
<p>å³ä¾¿åœ¨æš´åŠ›æŠ“åŒ…æ¨¡å¼ä¸‹ï¼Œä¹Ÿå­˜åœ¨ä¸€ä¸ªå‰ææ¡ä»¶ï¼š<strong>App æ˜¯å¦ä½¿ç”¨ iOS å¼€å‘è¯ä¹¦ç­¾åã€‚</strong></p>
<p>åœ¨æˆ‘çš„å®é™…ç»éªŒä¸­ï¼Œå¸¸è§æƒ…å†µæ˜¯ï¼š</p>
<ul>
<li>è‡ªç­¾æˆ–é‡ç­¾ Appï¼šè¯·æ±‚ä½“ã€å“åº”ä½“éƒ½èƒ½çœ‹åˆ°</li>
<li>App Store åŸåŒ…æˆ–ç³»ç»Ÿ Appï¼šåªèƒ½çœ‹åˆ° URL å’Œ Header</li>
</ul>
<p>è¿™ä¸æ˜¯å·¥å…·é™åˆ¶ï¼Œè€Œæ˜¯ iOS çš„å®‰å…¨æ¨¡å‹æœ¬èº«å†³å®šçš„ã€‚</p>
<hr/>
<h2 data-id="heading-8"><strong>å½“æˆ‘åªèƒ½çœ‹åˆ° Header æ—¶ï¼Œä»ç„¶æœ‰ä»·å€¼çš„å‡ ä»¶äº‹</strong></h2>
<p>å³ä¾¿ body ä¸å¯è§ï¼Œæˆ‘ä»ç„¶ä¼šåšå‡ ä»¶åˆ¤æ–­ï¼š</p>
<ul>
<li>è¯·æ±‚æ˜¯å¦å‘½ä¸­é¢„æœŸåŸŸå</li>
<li>Header ä¸­æ˜¯å¦æºå¸¦ç‰¹å®šæ ‡è¯†</li>
<li>TLS å»ºè¿æ˜¯å¦æˆåŠŸã€æ˜¯å¦é¢‘ç¹é‡è¯•</li>
</ul>
<p>è¿™äº›ä¿¡æ¯è¶³ä»¥åˆ¤æ–­ App æ˜¯å¦åœ¨æŒ‰é¢„æœŸå·¥ä½œï¼Œå°¤å…¶åœ¨è°ƒè¯•ç½‘ç»œå¼‚å¸¸æ—¶éå¸¸æœ‰ç”¨ã€‚</p>
<hr/>
<h2 data-id="heading-9"><strong>å¦‚æœç¡®å®éœ€è¦å®Œæ•´å†…å®¹ï¼Œæˆ‘ä¼šæ€ä¹ˆå¤„ç†</strong></h2>
<p>åœ¨éœ€è¦å®Œæ•´è¯·æ±‚ä½“çš„æƒ…å†µä¸‹ï¼Œæˆ‘é€šå¸¸ä¼šï¼š</p>
<ul>
<li>è·å–ç›®æ ‡ App çš„ IPA</li>
<li>ä½¿ç”¨ iOS å¼€å‘è¯ä¹¦é‡æ–°ç­¾å</li>
<li>ç¡®ä¿ä½¿ç”¨çš„æ˜¯å·²è„±å£³ç‰ˆæœ¬</li>
</ul>
<p>å®Œæˆåï¼Œå†é€šè¿‡ HTTPS æš´åŠ›æŠ“åŒ…é‡æ–°æŠ“å–ã€‚
è¿™ä¸€æ­¥æˆæœ¬ä¸ä½ï¼Œä½†å®ƒæ˜¯å”¯ä¸€ç¨³å®šå¯æ§çš„è·¯å¾„ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/658b9882234d4b63bab753716ff79519~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769505624&amp;x-signature=e6s%2FxkjEm%2FKl4mcpLXcZ51quMPs%3D" alt="httpsæš´åŠ›æŠ“åŒ…" loading="lazy"/></p>
<hr/>
<p>åœ¨ PIN å’ŒåŒå‘éªŒè¯åœºæ™¯ä¸‹ï¼Œæˆ‘å¸¸ç”¨çš„ç»„åˆæ˜¯ï¼š</p>
<ul>
<li>æŠ“åŒ…å¤§å¸ˆ HTTPS æš´åŠ›æŠ“åŒ…ï¼šè·å–çœŸå®è¯·æ±‚</li>
<li>æ•°æ®æµæŠ“åŒ…ï¼šç¡®è®¤è¿æ¥è¡Œä¸º</li>
<li>ä»£ç†æŠ“åŒ…ï¼ˆå¿…è¦æ—¶ï¼‰ï¼šéªŒè¯å“ªäº›è¯·æ±‚ä»èµ°ç³»ç»Ÿä»£ç†</li>
</ul>
<p>æ¯ä¸ªå·¥å…·éƒ½è§£å†³ä¸€éƒ¨åˆ†é—®é¢˜ï¼Œè€Œä¸æ˜¯æœŸå¾…æŸä¸€ä¸ªå·¥å…·è§£å†³æ‰€æœ‰é—®é¢˜</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AI Agentæ¡†æ¶æ¢ç§˜ï¼šæ‹†è§£ OpenHandsï¼ˆ1ï¼‰--- æ ¸å¿ƒç†å¿µ]]></title>    <link>https://juejin.cn/post/7596904122865336371</link>    <guid>https://juejin.cn/post/7596904122865336371</guid>    <pubDate>2026-01-19T13:13:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596904122865336371" data-draft-id="7595890117865898030" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AI Agentæ¡†æ¶æ¢ç§˜ï¼šæ‹†è§£ OpenHandsï¼ˆ1ï¼‰--- æ ¸å¿ƒç†å¿µ"/> <meta itemprop="keywords" content="ç®—æ³•,æœºå™¨å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-19T13:13:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç½—è¥¿çš„æ€è€ƒ"/> <meta itemprop="url" content="https://juejin.cn/user/351470467691175"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AI Agentæ¡†æ¶æ¢ç§˜ï¼šæ‹†è§£ OpenHandsï¼ˆ1ï¼‰--- æ ¸å¿ƒç†å¿µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/351470467691175/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç½—è¥¿çš„æ€è€ƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T13:13:51.000Z" title="Mon Jan 19 2026 13:13:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">AI Agentæ¡†æ¶æ¢ç§˜ï¼šæ‹†è§£ OpenHandsï¼ˆ1ï¼‰--- æ ¸å¿ƒç†å¿µ</h2>
<ul>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x00 æ‘˜è¦</a></p>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x01 èƒŒæ™¯</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.1 ä»€ä¹ˆæ˜¯Agent</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.2 Agentå·¥ç¨‹çš„é‡è¦æ€§</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">1.3 æ¶æ„æ‰æ˜¯ç«äº‰ä¼˜åŠ¿</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x02 AI Agent ç³»ç»Ÿ</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.1 æ¶æ„è®¾è®¡çš„éš¾ç‚¹</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.2 æ ¸å¿ƒç»„ä»¶</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">2.3 Devin &amp; OpenHandsï¼ˆåŸOpenDevinï¼‰</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0x03 OpenHands æ¶æ„æ¦‚å¿µå›¾è°±</a></p>
<ul>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.1 ç³»ç»Ÿæ¶æ„</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.2 ä»£ç åº“ç›®å½•ç»“æ„</a></li>
<li><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">3.3 æ ¸å¿ƒç»„ä»¶</a></li>
</ul>
</li>
<li>
<p><a href="https://link.juejin.cn?target=" title="" ref="nofollow noopener noreferrer">0xFF å‚è€ƒ</a></p>
</li>
</ul>
<p>è‡ªæœ¬æ–‡èµ·ï¼Œæˆ‘ä»¬å°†å¼€å¯ä¸€ä¸ªæ–°çš„ç³»åˆ—ï¼Œä»¥OpenHandsï¼ˆåŸ OpenDevinï¼‰ä¸ºä¾‹ï¼Œæ·±å…¥å‰–æAgentæ¡†æ¶ã€‚</p>
<p>å†™è¿™ä¸ªç³»åˆ—çš„åŸå› ï¼Œæ˜¯å› ä¸ºå’Œå‡ ä¸ªåŒå­¦è®¨è®ºAgentç³»ç»Ÿï¼Œä½†æ˜¯æ€»è§‰å¾—è‡ªå·±è®²å¾—æµ®äºè¡¨é¢ï¼Œå…„å¼Ÿä»¬å¥½åƒä¹Ÿæ²¡æœ‰å¾ˆç†è§£ã€‚å› æ­¤å†³å®šå†ç³»ç»Ÿæ¢³ç†ä¸€ä¸‹ã€‚</p>
<p>å› ä¸ºæœ¬ç³»åˆ—å€Ÿé‰´çš„æ–‡ç« è¿‡å¤šï¼Œå¯èƒ½åœ¨å‚è€ƒæ–‡çŒ®ä¸­æœ‰é—æ¼çš„æ–‡ç« ï¼Œå¦‚æœæœ‰ï¼Œè¿˜è¯·å¤§å®¶æŒ‡å‡ºã€‚</p>
<h3 data-id="heading-1">0x00 æ‘˜è¦</h3>
<p>æŒæ¡Agentçš„åº•å±‚é€»è¾‘ï¼Œä¸ä»…æ˜¯ç†Ÿç»ƒä½¿ç”¨çš„åŸºç¡€ï¼Œæ›´æ˜¯è®¾è®¡ã€è¯„ä¼°å’Œæ‰©å±•çš„å…³é”®ã€‚å¯¹äºäº§å“ç»ç†ã€äººå·¥æ™ºèƒ½å·¥ç¨‹å¸ˆå’ŒæŠ€æœ¯å†³ç­–è€…æ¥è¯´ï¼Œåªæœ‰æ·±å…¥ç†è§£Agentçš„æŠ€æœ¯è“å›¾ï¼Œæ‰èƒ½åœ¨AIåº”ç”¨çš„è½åœ°è¿‡ç¨‹ä¸­åšå‡ºç²¾å‡†å¸ƒå±€ï¼ŒæŠ“ä½æœªæ¥çš„æœºé‡ã€‚æˆ‘ä»¬å¸Œæœ›ä»æŠ€æœ¯åº•å±‚å‡ºå‘ï¼Œæ·±å…¥æ¢è®¨ä»¥ä¸‹å…³é”®é—®é¢˜ï¼š</p>
<ul>
<li>æ„å»ºä¸€ä¸ªå®ç”¨çš„AI Agentéœ€è¦å“ªäº›æ ¸å¿ƒæŠ€æœ¯æ¨¡å—çš„æ”¯æŒï¼Ÿ</li>
<li>è¿™äº›æ ¸å¿ƒæ¨¡å—å¦‚ä½•ååŒå·¥ä½œï¼Œå½¢æˆå®Œæ•´çš„ä»»åŠ¡æ‰§è¡Œé—­ç¯ï¼Ÿ</li>
<li>AI Agentç³»ç»Ÿåœ¨è½åœ°è¿‡ç¨‹ä¸­ä¼šé¢ä¸´å“ªäº›å…³é”®æŒ‘æˆ˜ï¼ŒOpenHandså¦‚ä½•è§£å†³è¿™äº›å·¥ç¨‹åŒ–éš¾é¢˜ï¼Ÿ</li>
</ul>
<p>æˆ‘ä»¬å¸Œæœ›é€šè¿‡è¿™ä¸€åœºæ·±å…¥çš„â€œæ‹†è§£â€ä¹‹æ—…ï¼Œè¶…è¶Šè¡¨å±‚åŠŸèƒ½çš„æ¼”ç¤ºï¼Œç›´æ¥è§¦åŠå…¶æ¶æ„çš„åŸºçŸ³ã€‚</p>
<p>ä¹‹æ‰€ä»¥åˆ†æOpenHandsï¼Œæ˜¯å› ä¸ºOpenHandsï¼ˆå‰èº«ä¸º OpenDevinï¼‰ä½œä¸ºå¼€æºçš„ AI è½¯ä»¶å¼€å‘ä»£ç†æ¡†æ¶ï¼Œåœ¨åŠŸèƒ½ã€æ¶æ„å’Œå…¼å®¹æ€§ç­‰æ–¹é¢å‡å…·å¤‡é²œæ˜ç‰¹è‰²ï¼Œä¸”ä»å…¥é—¨éš¾åº¦ã€å­¦ä¹ ä»·å€¼å’Œå®è·µåœºæ™¯æ¥çœ‹ï¼Œå®ƒååˆ†é€‚åˆç”¨æ¥å­¦ä¹  Agent æ¡†æ¶ã€‚å…·ä½“ç‰¹è‰²å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>å…¥é—¨é—¨æ§›ä½ï¼Œä¸Šæ‰‹éš¾åº¦å°</strong>ï¼šæ”¯æŒè‡ªç„¶è¯­è¨€äº¤äº’ï¼Œå¼€å‘è€…æ— éœ€å¤æ‚ç¼–ç å³å¯ä¸‹è¾¾å¼€å‘ä»»åŠ¡ï¼Œé™ä½åˆæœŸå­¦ä¹ æˆæœ¬ã€‚åŒæ—¶æä¾› GUI å’Œ CLI ç­‰å‹å¥½ç•Œé¢ï¼Œè¿˜æœ‰è¯¦å°½çš„å®æˆ˜æ¡ˆä¾‹å’Œæ¸…æ™°çš„æ–‡æ¡£ï¼Œä¾¿äºç†è§£ Agent ä¸å·¥å…·ã€LLM çš„ååŒé€»è¾‘ã€‚ä¸”åŸºäº MIT è®¸å¯å®Œå…¨å¼€æºï¼Œå¯è‡ªç”±æŸ¥çœ‹ Agent è°ƒåº¦ã€ä»»åŠ¡ç¼–æ’ç­‰æ ¸å¿ƒæºç ã€‚</li>
<li><strong>è¦†ç›– Agent æ ¸å¿ƒçŸ¥è¯†ä½“ç³»</strong>ï¼šå­¦ä¹ å®ƒèƒ½æŒæ¡å¤š Agent åä½œã€ä»»åŠ¡æ‹†è§£ã€å·¥å…·è°ƒç”¨ã€æ²™ç›’å®‰å…¨æ§åˆ¶ç­‰ Agent æ¡†æ¶çš„æ ¸å¿ƒæŠ€æœ¯ç‚¹ã€‚å…¶ä¸ç½‘é¡µäº¤äº’ã€API é›†æˆã€ä»£ç å¤„ç†ç­‰å®æˆ˜åœºæ™¯ç»“åˆç´§å¯†ï¼Œèƒ½å¸®åŠ©å­¦ä¹ è€…ç†è§£ Agent åœ¨çœŸå®å¼€å‘æµç¨‹ä¸­çš„è½åœ°é€»è¾‘ã€‚</li>
<li><strong>å…¼å…·å­¦ä¹ ä¸è½åœ°ä»·å€¼</strong>ï¼šæ—¢èƒ½ç”¨äºç®€å•çš„ Agent åŸå‹æ­å»ºï¼Œå¿«é€ŸéªŒè¯æƒ³æ³•ï¼›ä¹Ÿèƒ½æ”¯æ’‘å¤§è§„æ¨¡Agentçš„å¯é éƒ¨ç½²ï¼Œé€‚é…ä»å­¦ä¹ æµ‹è¯•åˆ°ç”Ÿäº§åº”ç”¨çš„å…¨æµç¨‹ã€‚æ­¤å¤–ï¼Œä¸ä¸»æµ Agent SDK ç›¸æ¯”ï¼Œå…¶ç‹¬ç‰¹çš„æ²™ç›’åŒ–ç”Ÿäº§æœåŠ¡å™¨ã€è¿œç¨‹æ‰§è¡Œç­‰ç‰¹æ€§ï¼Œèƒ½è®©å­¦ä¹ è€…æ¥è§¦åˆ°æ›´å…¨é¢çš„ Agent è¿›é˜¶èƒ½åŠ›ï¼Œæå‡æŠ€æœ¯ç«äº‰åŠ›ã€‚</li>
</ul>
<h3 data-id="heading-2">0x01 èƒŒæ™¯</h3>
<p>å½“æˆ‘ä»¬è®¨è®ºAI Agentç³»ç»Ÿçš„æŠ€æœ¯æ—¶ï¼Œéœ€è¦å…ˆç†è§£ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šçœŸæ­£è®©ç³»ç»Ÿæœ‰ç«äº‰åŠ›çš„ï¼Œæ˜¯é‚£äº›ä¸€çœ¼èƒ½çœ‹åˆ°çš„â€œæ™ºèƒ½åŠŸèƒ½â€ï¼Œè¿˜æ˜¯èƒŒåæ”¯æ’‘ä¸€åˆ‡å¹³ç¨³è¿è¡Œçš„â€œå·¥ä½œæµæ¶æ„â€ï¼Ÿè¿™ä¸ªç­”æ¡ˆä¸ä»…å†³å®šäº†è¯¥å…ˆç ”å‘ä»€ä¹ˆï¼Œæ›´å…³ä¹ç³»ç»Ÿèƒ½ä¸èƒ½æ‰“é€ å‡ºåˆ«äººæŠ„ä¸èµ°çš„é•¿æœŸä¼˜åŠ¿ã€‚</p>
<h4 data-id="heading-3">1.1 ä»€ä¹ˆæ˜¯Agent</h4>
<p>Agentçš„å®šä¹‰å…·æœ‰å¤šå…ƒè§†è§’ï¼š</p>
<ul>
<li>æœ‰äººå°†å…¶ç•Œå®šä¸ºå¯é•¿æœŸè‡ªä¸»è¿è¡Œã€å€ŸåŠ©å„ç±»å·¥å…·å®Œæˆå¤æ‚ä»»åŠ¡çš„ç‹¬ç«‹ç³»ç»Ÿï¼›</li>
<li>æœ‰äººè®¤ä¸ºAgentæ˜¯å¯ä»¥åœ¨æœ€å°äººå·¥å¹²é¢„ä¸‹å®Œæˆã€Œæ„ŸçŸ¥ â†’ è§„åˆ’ â†’ è¡ŒåŠ¨ â†’ åé¦ˆã€é—­ç¯çš„Agentï¼Œæ—¢èƒ½è§£æè‡ªç„¶è¯­è¨€ç›®æ ‡ï¼Œåˆèƒ½è°ƒç”¨æœç´¢å¼•æ“ã€æ•°æ®åº“ç­‰å¤–éƒ¨å·¥å…·ã€‚</li>
<li>æœ‰äººåˆ™å°†å…¶ç†è§£ä¸ºéµå¾ªé¢„è®¾å·¥ä½œæµç¨‹çš„è§„èŒƒåŒ–å®ç°æ–¹æ¡ˆã€‚</li>
</ul>
<p>Anthropic å°†è¿™äº›ä¸åŒå½¢æ€çš„ç³»ç»Ÿç»Ÿä¸€å½’ä¸º â€œAgentç³»ç»Ÿï¼ˆagentic systemsï¼‰â€ï¼ŒåŒæ—¶ä»æ¶æ„å±‚é¢æ˜ç¡®åŒºåˆ†äº† â€œå·¥ä½œæµç¨‹ï¼ˆWorkflowsï¼‰â€ ä¸ â€œAgentâ€ è¿™ä¸¤ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚å…·ä½“æ¥çœ‹ï¼š</p>
<ul>
<li>å·¥ä½œæµæ˜¯ç¼–ç â€å¦‚ä½•åšâ€œï¼šå·¥ä½œæµç¨‹ç±»ç³»ç»Ÿå¦‚åŒæŒ‰ç…§å›ºå®šå‰§æœ¬æ¼”å‡ºçš„èˆå°å‰§ï¼Œå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰ä¸å„ç±»å·¥å…·çš„åä½œå®Œå…¨éµå¾ªé¢„å…ˆç¼–å†™çš„ä»£ç è·¯å¾„æ¨è¿›ï¼›</li>
<li>Agentæ˜¯ç¼–ç â€åšä»€ä¹ˆâ€œï¼šAgentç³»ç»Ÿåˆ™æ›´åƒæ‹¥æœ‰è‡ªä¸»å†³ç­–èƒ½åŠ›çš„é¡¹ç›®ç»ç†ï¼Œç”±å¤§è¯­è¨€æ¨¡å‹åŠ¨æ€ä¸»å¯¼æµç¨‹èµ°å‘ä¸å·¥å…·è°ƒç”¨ï¼Œå…¨ç¨‹æŒæ§ä»»åŠ¡çš„æ‰§è¡Œæ–¹å¼ã€‚</li>
</ul>
<p>éšç€å¤§è¯­è¨€æ¨¡å‹åœ¨å››å¤§å…³é”®èƒ½åŠ›ä¸Šçš„æ—¥è¶‹æˆç†Ÿ â€”â€” åŒ…æ‹¬å¤æ‚è¾“å…¥ç†è§£ã€é€»è¾‘æ¨ç†ä¸ä»»åŠ¡è§„åˆ’ã€å¯é å·¥å…·è°ƒç”¨ä»¥åŠé”™è¯¯æ¢å¤èƒ½åŠ›ï¼ŒAgentå·²åœ¨ç”Ÿäº§åœºæ™¯ä¸­é€æ­¥è½åœ°åº”ç”¨ã€‚å…¶å·¥ä½œæµç¨‹é€šå¸¸å§‹äºäººç±»ç”¨æˆ·çš„æŒ‡ä»¤æˆ–äº¤äº’å¼æ²Ÿé€šï¼Œå¾…ä»»åŠ¡ç›®æ ‡æ˜ç¡®åï¼Œä¾¿è‡ªä¸»å¼€å±•è§„åˆ’ä¸æ‰§è¡Œæ“ä½œï¼Œè¿‡ç¨‹ä¸­è‹¥éœ€è¡¥å……ä¿¡æ¯æˆ–å¯»æ±‚åˆ¤æ–­ï¼Œä¼šä¸»åŠ¨å‘äººç±»ç”¨æˆ·å‘èµ·è¯·æ±‚ã€‚åœ¨æ¯ä¸€æ­¥æ‰§è¡Œç¯èŠ‚ï¼ŒAgentå¿…é¡»ä»ç¯å¢ƒä¸­è·å– â€œçœŸå®æ•°æ®ï¼ˆGround Truthï¼‰â€â€”â€” æ¯”å¦‚å·¥å…·è°ƒç”¨è¿”å›ç»“æœæˆ–ä»£ç è¿è¡Œè¾“å‡º â€”â€” ä»¥æ­¤è¯„ä¼°ä»»åŠ¡è¿›å±•ã€‚å½“æŠµè¾¾é¢„è®¾æ£€æŸ¥ç‚¹æˆ–é­é‡æ‰§è¡Œé˜»ç¢æ—¶ï¼ŒAgentå¯æš‚åœæ“ä½œä»¥è·å–äººç±»åé¦ˆã€‚ä»»åŠ¡ä¸€èˆ¬åœ¨å®Œæˆåç»ˆæ­¢ï¼ŒåŒæ—¶ä¹Ÿä¼šè®¾ç½®åœæ­¢æ¡ä»¶ï¼ˆå¦‚æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼‰æ¥ç¡®ä¿è¿‡ç¨‹å¯æ§ã€‚</p>
<h4 data-id="heading-4">1.2 Agentå·¥ç¨‹çš„é‡è¦æ€§</h4>
<p>Agentçš„å®ç°é€»è¾‘ç›¸å¯¹ç®€æ´ï¼Œæœ¬è´¨ä¸Šæ˜¯å¤§è¯­è¨€æ¨¡å‹åœ¨ â€œç¯å¢ƒåé¦ˆ - å·¥å…·è°ƒç”¨â€ çš„å¾ªç¯ä¸­æŒç»­è¿ä½œã€‚Agentç³»ç»Ÿçš„æ ¸å¿ƒæ„å»ºæ¨¡å—æ˜¯ä¸€ä¸ªå¢å¼ºåŠŸèƒ½çš„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ï¼Œå®ƒèƒ½å¤Ÿä¸»åŠ¨åœ°åˆ©ç”¨æ£€ç´¢ã€å·¥å…·å’Œè®°å¿†ç­‰èƒ½åŠ›æ¥ä¼˜åŒ–å…¶åŠŸèƒ½ã€‚å¯¹äºç»å¤§éƒ¨åˆ†åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œé€šè¿‡æ£€ç´¢ï¼ˆRAGï¼‰å’Œåœ¨ prompt ä¸­æ·»åŠ ä¸Šä¸‹æ–‡ç¤ºä¾‹ï¼ˆPrompt Engineeringï¼‰æ¥ä¼˜åŒ–å•ä¸ª LLM è°ƒç”¨é€šå¸¸å°±è¶³å¤Ÿäº†ã€‚</p>
<p>è™½ç„¶åªè¦æä¾›ä¸€å †å·¥å…·å’Œpromptï¼Œagentå°±å¯ä»¥è‡ªè¡Œæ¢ç´¢-åˆ†æ-å†³ç­–-æ‰§è¡Œç›´åˆ°è§£å†³ä»»åŠ¡ã€‚ä»å®è§‚è§’åº¦ä¸Šæ¥è¯´è¿™æ ·å¹¶æ²¡æœ‰é”™ï¼Œä½†è®©LLMæ§åˆ¶ä¸€åˆ‡çš„ç»“æœå°±æ˜¯ï¼Œä¸å®Œå–„çš„promptå’Œtoolså¸¦æ¥äº†æ— é™å¾ªç¯å’Œæ”¾é£è‡ªæˆ‘ã€‚å› æ­¤ï¼Œå°½ç®¡AIæ¨¡å‹æ˜¯Agentçš„â€œå¤§è„‘â€ï¼Œä½†è¦å®ç°ç”Ÿäº§çº§çš„è½åœ°ï¼ŒAgentå·¥ç¨‹æ‰æ˜¯å…³é”®æ”¯æ’‘ã€‚Rakesh Gohelå‘å¸ƒçš„â€œAI Agentå†°å±±æ¨¡å‹â€æŒ‡å‡ºï¼šæ„å»ºä¸€ä¸ªçœŸæ­£å¯ç”¨çš„Agentï¼Œ90%çš„å·¥ä½œæ˜¯è½¯ä»¶å·¥ç¨‹ï¼Œä»…10%æ˜¯AIæŠ€æœ¯ï¼š</p>
<ul>
<li>â€œ10% AIâ€ï¼šAIæ¨¡å‹åªæ˜¯Agentçš„â€œå¤§è„‘â€ï¼šç†è§£ä»»åŠ¡ã€è§„åˆ’æ­¥éª¤ã€ç”Ÿæˆå†…å®¹ã€‚</li>
<li>â€œ90% Engineeringâ€ï¼šå·¥ç¨‹æ˜¯æ”¯æ’‘Agentçš„æ•´ä¸ªâ€œèº«ä½“å’Œç¥ç»ç³»ç»Ÿâ€ï¼ŒåŒ…æ‹¬ç”¨æˆ·äº¤äº’ã€æƒé™æ§åˆ¶ã€ä»»åŠ¡ç¼–æ’ã€å·¥å…·è°ƒç”¨ã€æ—¥å¿—ã€å¼‚å¸¸å›æ»šç­‰ã€‚</li>
</ul>
<p>åœ¨è¿™èƒŒåï¼Œä¸€æ•´å¥—ç³»ç»ŸåŒ–çš„Agentæ¶æ„ï¼Œæ­£æ‚„ç„¶å†³å®šç€è¿™äº›Agentçš„æ•ˆç‡ã€æ‰©å±•æ€§å’Œæ¼”åŒ–æ–¹å‘ã€‚å¦‚æœå°†å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ¯”ä½œAIçš„å‘åŠ¨æœºï¼Œé‚£ä¹ˆâ€œAgentæ¶æ„â€å°±æ˜¯å†³å®šAIèƒ½èµ°å¤šè¿œçš„åº•ç›˜å’Œé©¾é©¶ç³»ç»Ÿã€‚</p>
<h4 data-id="heading-5">1.3 æ¶æ„æ‰æ˜¯ç«äº‰ä¼˜åŠ¿</h4>
<p>AI Agentä¸æ˜¯ä¸€æ¬¾å•ä¸€äº§å“ï¼Œè€Œæ˜¯ä¸€ç§å…¨æ–°çš„è½¯ä»¶å½¢æ€â€”â€”å®ƒä¸æ˜¯â€œæ›´èªæ˜çš„æœºå™¨äººâ€ï¼Œè€Œæ˜¯â€œèƒ½è‡ªä¸»åä½œçš„æ•°å­—ä¸ªä½“â€ã€‚å…¶æŠ€æœ¯éš¾ç‚¹ä¸åœ¨äºâ€œæƒ³è±¡åŠ›â€ï¼Œè€Œåœ¨äºâ€œå·¥ç¨‹è½åœ°èƒ½åŠ›â€ã€‚æœªæ¥ï¼ŒçœŸæ­£å¼•é¢†Agentå‘å±•çš„ï¼Œå¿…ç„¶æ˜¯é‚£äº›æ—¢æ‡‚AIæŠ€æœ¯ï¼Œåˆç²¾é€šç³»ç»Ÿæ¶æ„çš„â€œAgentå·¥åŒ â€ã€‚Agentæ¶æ„ï¼Œå·²æˆä¸ºä¸‹ä¸€ä»£AIåº”ç”¨çš„æ ¸å¿ƒç«äº‰èµ›é“ã€‚èƒ½å¦ç†è§£â€œMemory-Plan-Tool-Reflectionâ€çš„ååŒé€»è¾‘ï¼Œèƒ½å¦æ„å»ºâ€œé€æ˜ã€å¯æ§ã€å¯æ‰©å±•â€çš„ä»»åŠ¡ç³»ç»Ÿï¼Œå†³å®šäº†ä¸€ä¸ªå›¢é˜Ÿæ˜¯å¦å…·å¤‡æ‰“é€ å®ç”¨Agentåº”ç”¨çš„æ ¸å¿ƒèƒ½åŠ›ã€‚</p>
<p>æ‹¿browerAgentæ¥è¯´ï¼Œå®ƒä»¬èƒ½ç”Ÿæˆä»£ç ã€è·Ÿç½‘é¡µäº’åŠ¨ï¼Œçœ‹ç€å¾ˆå‰å®³ï¼Œä½†è¿™äº›èƒ½åŠ›å…¶å®é ä¸‰ä¸ªå¤–éƒ¨æ¡ä»¶æ’‘ç€ â€”â€” è€Œè¿™ä¸‰ä¸ªæ¡ä»¶ç°åœ¨è¡Œä¸šé‡Œæ­£å˜å¾—è¶Šæ¥è¶Šé€šç”¨ã€‚</p>
<ul>
<li>åŸºç¡€æ¨¡å‹èƒ½åŠ›äººäººèƒ½ç”¨ã€‚æœªæ¥å¤§è¯­è¨€æ¨¡å‹èƒ½åŠ›è¶Šæ¥è¶Šå¼ºï¼ŒAI Agentèƒ½åšçš„åŠŸèƒ½ä¼šè¶Šæ¥è¶Šå®¹æ˜“å®ç°ï¼Œæ…¢æ…¢å˜æˆè¡Œä¸šæ ‡é…ã€‚è¿™ä¹ˆä¸€æ¥ï¼Œä¸åŒç³»ç»Ÿåœ¨ â€œæ™ºèƒ½â€ ä¸Šçš„å·®è·è¶Šæ¥è¶Šå°ã€‚</li>
<li>æç¤ºè¯æŠ€å·§å®¹æ˜“å¤åˆ¶ã€‚æ²¡æ³•æˆä¸ºç‹¬å®¶ä¼˜åŠ¿ã€‚</li>
<li>å·¥å…·è°ƒç”¨è¶Šæ¥è¶Šæ ‡å‡†åŒ–ã€‚Agent è°ƒç”¨å·¥å…·çš„èƒ½åŠ›ï¼Œæœ¬è´¨å°±æ˜¯ç”¨åˆ«äººçš„ API æ¥å£ã€‚ä»»ä½•å›¢é˜Ÿéƒ½èƒ½ç›´æ¥é›†æˆç°æˆå·¥å…·ï¼Œè¡¥å…¨è‡ªå·±çš„åŠŸèƒ½çŸ­æ¿ï¼Œè¿™æ–¹é¢çš„ç«äº‰æ…¢æ…¢å˜å¾—åƒç¯‡ä¸€å¾‹ã€‚</li>
</ul>
<p>çœŸæ­£çš„æŠ€æœ¯å£å’ï¼Œä»æ¥éƒ½æ˜¯æ‰“é€ ä¸€ä¸ªç¨³å®šã€èƒ½æ§åˆ¶ã€èƒ½ç›‘æ§ã€èƒ½æ‰©å±•çš„åº•å±‚è¿è¡Œç¯å¢ƒã€‚è¿™éœ€è¦å›¢é˜Ÿæœ‰æ·±åšçš„æŠ€æœ¯ç§¯ç´¯ã€èƒ½æå®šå¤æ‚ç³»ç»Ÿï¼Œè¿˜å¾—ä¸€ç›´è¿­ä»£åº”å¯¹æ–°é—®é¢˜ã€‚è¿™äº›é—®é¢˜æ˜¯AIè·Ÿç°å®ä¸–ç•Œäº’åŠ¨æ—¶å¤©ç”Ÿå°±æœ‰çš„ï¼Œä¸ä¼šå› ä¸ºæ¨¡å‹å˜å¼ºå°±è‡ªåŠ¨æ¶ˆå¤±ï¼Œåè€Œä¼šå†³å®šç³»ç»Ÿç¨³ä¸ç¨³å®šã€é ä¸é è°±ã€‚è°èƒ½è§£å†³çŠ¶æ€ç®¡ç†ã€å·¥å…·å®¹é”™ã€è®¡åˆ’å¯æ§ã€è¡Œä¸ºé€æ˜è¿™äº›â€œç³»ç»Ÿçº§ç—›ç‚¹â€ï¼Œè°å°±èƒ½åœ¨AgentæŠ€æœ¯é©å‘½ä¸­å æ®ä¸»åŠ¨ã€‚</p>
<p>æœªæ¥AI Agentç³»ç»Ÿçš„ç«äº‰ï¼Œä¼šä»â€œè°èƒ½åšä»€ä¹ˆâ€çš„åŠŸèƒ½æ¯”æ‹¼ï¼Œå˜æˆâ€œè°èƒ½åšå¾—æ›´ç¨³ã€æ›´å¥½ã€æ›´é•¿ä¹…â€çš„å·¥ç¨‹å®åŠ›è¾ƒé‡â€”â€”è¯´ç™½äº†ï¼Œå·¥ç¨‹å®åŠ›æ‰å†³å®šé•¿æœŸç«äº‰åŠ›ã€‚</p>
<h3 data-id="heading-6">0x02 AI Agent ç³»ç»Ÿ</h3>
<p>æ„å»ºä¸€å¥—æˆç†Ÿçš„ AI Agent Frameworkï¼Œæœ¬è´¨æ˜¯æ‰“é€ ä¸€ä¸ªèƒ½æ”¯æ’‘Agentè‡ªä¸»æ„ŸçŸ¥ã€ç¯å¢ƒæ„ŸçŸ¥ã€å†³ç­–åˆ¶å®šã€åŠ¨ä½œæ‰§è¡Œã€è‡ªæˆ‘è¿›åŒ–çš„ â€œæ•°å­—ç”Ÿå‘½ä½“â€ åŸºç¡€è®¾æ–½ã€‚å…¶æ ¸å¿ƒåœ¨äºæ‹†è§£Agentçš„æ ¸å¿ƒèƒ½åŠ›æ¨¡å—ï¼Œæ˜ç¡®å„ç»„ä»¶çš„èŒè´£è¾¹ç•Œä¸åä½œé€»è¾‘ï¼ŒåŒæ—¶æ”»å…‹ç³»ç»Ÿç¨³å®šæ€§ã€çµæ´»æ€§ä¸å®ç”¨æ€§çš„å…³é”®ç“¶é¢ˆã€‚Agentç³»ç»Ÿæ ¸å¿ƒæ¶µç›–å››å¤§èƒ½åŠ›ï¼š</p>
<ul>
<li>é€šè¿‡ Function Callã€MCP åè®®ç­‰å·¥å…·è°ƒç”¨å®ç°ç¯å¢ƒäº¤äº’æ„ŸçŸ¥ï¼›</li>
<li>å€ŸåŠ© ReActã€Reflexion ç­‰æ–¹æ³•å®Œæˆè‡ªä¸»æ¨ç†å†³ç­–ï¼›</li>
<li>é‡‡ç”¨çŸ­æœŸè®°å¿†ï¼ˆä¾æ‰˜ Prompt / ä¸Šä¸‹æ–‡çª—å£ï¼‰ä¸é•¿æœŸè®°å¿†ï¼ˆé€šè¿‡ RAG å’Œå‘é‡æ•°æ®åº“ç®¡ç†ï¼‰çš„èŒƒå¼è¿›è¡ŒçŸ¥è¯†ç®¡ç†ï¼›</li>
<li>é€šè¿‡ A2Aã€ACPã€ANP ç­‰åè®®è¾¾æˆå¤šAgenté—´çš„é€šä¿¡åä½œã€‚</li>
</ul>
<h4 data-id="heading-7">2.1 æ¶æ„è®¾è®¡çš„éš¾ç‚¹</h4>
<p>å¤§æ¨¡å‹æœ¬è´¨æ˜¯æ¦‚ç‡è¾“å‡ºï¼Œè¿™ç§â€œæ¦‚ç‡æœ¬æ€§â€å¸¦æ¥çš„ä¸‰ä½ä¸€ä½“é£é™©</p>
<ul>
<li>ä¸ä¸€è‡´æ€§ï¼šåŒä¸€è¾“å…¥å¤šæ¬¡é‡‡æ ·ç»“æœå‘æ•£ã€‚</li>
<li>ä¸çœŸå®æ€§ï¼šå¹»è§‰å¯¼è‡´äº‹å®é”™è¯¯ã€‚</li>
<li>ä¸åŠæ—¶æ€§ï¼šé™æ€è®­ç»ƒæ•°æ®è¿‡æœŸã€‚</li>
</ul>
<p>è¿™æ ·å¯¼è‡´ Agent å¸¦æ¥çš„çš„å››å¤§ç¡¬æ ¸å¡ç‚¹ä¸ºï¼š</p>
<ol>
<li>è®°å¿†æ–­ç‰‡ã€‚å•çº¯çš„Agentç¼ºå°‘ä¸“é—¨çš„ä»»åŠ¡çŠ¶æ€æ„ŸçŸ¥æœºåˆ¶ï¼Œä»…é ä¸Šä¸‹æ–‡æ‹¼æ¥æ— æ³•ç¨³å®šè·Ÿè¸ªé•¿æµç¨‹ä»»åŠ¡ã€‚æ¯”å¦‚ï¼Œå¤šæ­¥ä»»åŠ¡é‡Œï¼Œ â€œä¸­é—´æ€â€åªèººåœ¨ LLM çš„ä¸Šä¸‹æ–‡çª—å£é‡Œï¼Œæ—¢æ²¡æœ‰ç»“æ„åŒ–å­˜å‚¨ï¼Œä¹Ÿæ²¡æœ‰æ˜¾å¼è¯­ä¹‰ç´¢å¼•ã€‚</li>
<li>ä¸€é”™å°±èººã€‚å•çº¯çš„Agent ç¼ºä¹å·¥å…·è°ƒç”¨çš„å¼‚å¸¸æ„ŸçŸ¥ä¸å®¹é”™æœºåˆ¶ï¼Œ</li>
<li>é»‘ç®±æ‹†åŒ…ã€‚LLM ç›´æ¥åå‡ºè‡ªç„¶è¯­è¨€è®¡åˆ’ï¼Œå¼€å‘è€…æ— æ³•æ’æ‹”ï¼Œæ›´æ— æ³•éªŒè¯ï¼Œåªèƒ½åœ¨æ‰§è¡Œæœ«ç«¯æ‰å‘ç°ã€‚</li>
<li>å®¡è®¡é»‘æ´ã€‚Agent è°ƒäº†è°ã€å–äº†ä»€ä¹ˆå­—æ®µã€åŸºäºå“ªå¥ç”¨æˆ·æç¤ºåšå†³ç­–ï¼Œå…¨ç¨‹æ— ç•™ç—•ï¼Œä¼ä¸šåˆè§„æ— ä»è°ˆèµ·ã€‚</li>
</ol>
<p>å› æ­¤ï¼ŒAgent çš„ç«äº‰æ­£ç¦»å¼€â€œè°èƒ½è°ƒç”¨æ›´å¤š APIâ€ï¼Œè½¬å‘â€œè°èƒ½æŠŠä¸ç¡®å®šçš„æ¨¡å‹å°è£…æˆç¡®å®šæ€§çš„ç³»ç»Ÿâ€ã€‚æŠŠæ¦‚ç‡è£…è¿›çŠ¶æ€æœºï¼ŒæŠŠå¹»è§‰å…³è¿›å®¡è®¡ç¬¼ï¼ŒæŠŠæˆæœ¬å‹è¿›é¢„ç®—è¡¨â€”â€”è¿™æ‰æ˜¯Agent ç³»ç»Ÿçš„çœŸæ­£é—¨æ§›ã€‚</p>
<h4 data-id="heading-8">2.2 æ ¸å¿ƒç»„ä»¶</h4>
<p>Agentç»éå•ä¸€è¯­è¨€æ¨¡å‹çš„å¢å¼ºç‰ˆï¼ŒLLMä»…ç›¸å½“äºå…¶ â€œè®¤çŸ¥ä¸­æ¢â€ï¼ŒçœŸæ­£æ”¯æ’‘å…¶å®Œæ•´åŠŸèƒ½çš„æ˜¯ä¸€å¥—ååŒè¿ä½œçš„å¤šæ¨¡å—æ¶æ„ï¼Œæˆç†Ÿå¯è½åœ°çš„Agentç³»ç»Ÿè‡³å°‘åŒ…å«å‡ å¤§æ ¸å¿ƒæ¨¡å—ï¼Œå„æ¨¡å—å¦‚åŒç²¾å¯†å›¢é˜Ÿä¸­çš„ä¸åŒè§’è‰²ï¼Œå„å¸å…¶èŒåˆç´§å¯†é…åˆã€‚</p>
<ul>
<li>è§„åˆ’ä¸å†³ç­–å¼•æ“ï¼ˆPlanner / Policyï¼‰ã€‚LLM ä½œä¸º â€œè®¤çŸ¥ä¸­æ¢â€ï¼Œå°±åƒå›¢é˜Ÿé‡Œçš„ â€œæ™ºå›Šå›¢â€ï¼Œæ ¸å¿ƒè´Ÿè´£è§£æç”¨æˆ·ä»»åŠ¡æ„å›¾ã€æŠŠç”¨æˆ·çš„â€œå¤æ‚ç»ˆæç›®æ ‡â€åˆ‡æˆâ€œå¯æ‰§è¡Œçš„å­ä»»åŠ¡åºåˆ—â€ï¼Œæ‹†è§£å¤æ‚ä»»åŠ¡ä¸ºå­ä»»åŠ¡ã€æ˜ç¡®å­ä»»åŠ¡çš„ä¾èµ–å…³ç³»ã€ç”Ÿæˆä»£ç ã€æŠ¥å‘Šç­‰è¾“å‡ºå†…å®¹ã€‚å³æ”¯æŒä¸€æ¬¡æ€§é™æ€è®¡åˆ’ã€ä¹Ÿæ”¯æŒ ReAct / CodeAct è¿™ç§é€æ­¥å±•å¼€ï¼Œå³æ”¯æŒåŠ¨æ€è®¡åˆ’è°ƒæ•´ï¼šæ ¹æ®å·¥å…·è°ƒç”¨ç»“æœã€ç¯å¢ƒå˜åŒ–æˆ–ç”¨æˆ·åé¦ˆï¼Œå®æ—¶ä¿®æ­£å­ä»»åŠ¡æµç¨‹ï¼Œé¿å…è®¡åˆ’ä¸å®é™…æ‰§è¡Œè„±èŠ‚ã€‚</li>
<li>Memory æ¨¡å—æ˜¯ â€œä¸Šä¸‹æ–‡å»¶ç»­å™¨â€ï¼Œè´Ÿè´£å­˜å‚¨å¯¹è¯ä¸Šä¸‹æ–‡ã€ä»»åŠ¡æ‰§è¡Œå…³é”®èŠ‚ç‚¹ä¸è¿›åº¦ã€å†å²ç»éªŒç­‰ä¿¡æ¯ï¼Œä¿éšœä»»åŠ¡æ‰§è¡Œçš„è¿è´¯æ€§ã€‚ç”¨äºå­˜å‚¨å¯¹è¯å†å²ã€ä¸­é—´ç»“æœå’Œé•¿æœŸè®°å¿†ã€‚è¿™æ ·ï¼Œé€šè¿‡åœ¨Promptä¸­å¼•å…¥å¯¹å‰æ–‡çš„æ€»ç»“æˆ–å…³é”®æ•°æ®ï¼ŒAgentèƒ½â€œè®°ä½â€å…ˆå‰æ­¥éª¤çš„ç»“æœï¼Œç¡®ä¿çŠ¶æ€çš„ä¸€è‡´æ€§å’Œè·¨æ­¥éª¤çš„ä¸Šä¸‹æ–‡è¡”æ¥ã€‚</li>
<li>Planner æ¨¡å—æ‰®æ¼” â€œè¡ŒåŠ¨è·¯çº¿å›¾â€ çš„è§’è‰²ã€‚å…¶å®ç°æœºåˆ¶åŒ…æ‹¬åŸºäºè§„åˆ™çš„å›ºå®šæµç¨‹ï¼ˆé€‚ç”¨äºæ ‡å‡†åŒ–ä»»åŠ¡ï¼‰ã€ä¾æ‰˜ LLM æ¨ç†èƒ½åŠ›çš„åŠ¨æ€ç”Ÿæˆï¼ˆé€‚ç”¨äºçµæ´»éœ€æ±‚ï¼‰ï¼Œä»¥åŠç»“åˆäºŒè€…ä¼˜åŠ¿çš„æ··åˆå‹è°ƒåº¦ï¼ˆå¦‚åŸºäº LangGraph æ„å»ºæœ‰å‘å›¾ä»»åŠ¡æµï¼‰ã€‚</li>
<li>Tool-use æ¨¡å—æ˜¯Agentçš„ â€œæ‰‹è„šâ€ï¼Œè®©æ¨¡å‹â€œçœ‹åˆ°â€å·¥å…·ï¼Œè€Œä¸æ˜¯â€œæ‘¸é»‘â€è°ƒç”¨ï¼Œæ‰“ç ´äº†ä»…è¾“å‡ºæ–‡æœ¬çš„å±€é™ï¼Œé€šè¿‡è°ƒç”¨ç¬¬ä¸‰æ–¹ APIã€æ£€ç´¢å¤–éƒ¨çŸ¥è¯†åº“ã€è¯»å†™æœ¬åœ°æ–‡ä»¶ç­‰æ–¹å¼è¿æ¥å¤–éƒ¨èµ„æºï¼Œå®Œæˆå®é™…æ“ä½œã€‚</li>
<li>Reflection æ¨¡å—èµ‹äºˆAgent â€œå…ƒè®¤çŸ¥èƒ½åŠ›â€ï¼Œå¦‚åŒå›¢é˜Ÿçš„ â€œå¤ç›˜ä¸“å‘˜â€ï¼Œåœ¨ä»»åŠ¡å¤±è´¥æˆ–å—é˜»æ—¶ï¼Œå¯¹æ¯”æ‰§è¡Œç»“æœä¸é¢„æœŸï¼Œè¯„ä¼°æ‰§è¡Œæ•ˆæœã€å®šä½é—®é¢˜åŸå› å¹¶è°ƒæ•´ç­–ç•¥ã€‚</li>
</ul>
<p>è¿™å‡ å¤§æ¨¡å—ç›¸è¾…ç›¸æˆï¼Œæ„æˆ â€œçŠ¶æ€é©±åŠ¨ + æ„å›¾åˆ†è§£ + å·¥å…·è°ƒç”¨ + è‡ªæˆ‘å­¦ä¹ â€ çš„æœ‰æœºæ•´ä½“ï¼Œè€Œéç®€å•å åŠ ã€‚</p>
<p>å¦å¤–ï¼Œåœ¨å…·ä½“å®ç°ä¸­ï¼Œé€šå¸¸ä¹Ÿä¼šæœ‰å¦‚ä¸‹ç»„ä»¶ï¼š</p>
<ul>
<li>äº‹ä»¶æ€»çº¿ï¼ˆEvent Busï¼‰ï¼šç”¨äºè§£è€¦ï¼Œå°†ç”¨æˆ·æ¶ˆæ¯ã€å·¥å…·è¿”å›ã€çŠ¶æ€å˜æ›´ã€å¼‚å¸¸æŠ¥å‘Šéƒ½åºåˆ—åŒ–ä¸ºäº‹ä»¶ï¼Œå¹¿æ’­ç»™è®¢é˜…è€…ã€‚</li>
<li>è¿è¡Œæ—¶æ²™ç®±ï¼ˆRuntime Sandboxï¼‰ï¼šç»™æ¨¡å‹æä¾›â€œåŠ¨æ‰‹â€ç©ºé—´â€”â€”æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œã€Shellã€Python è§£é‡Šå™¨ã€ç¬¬ä¸‰æ–¹åº“ã€‚</li>
<li>è§‚æµ‹ä¸é¥æµ‹ï¼ˆObservabilityï¼‰ï¼šæä¾›å¯è§†åŒ–çš„ä»»åŠ¡æ‰§è¡Œç•Œé¢ï¼Œå±•ç¤ºä»»åŠ¡æµç¨‹ã€å­ä»»åŠ¡è¿›åº¦ã€æ¨¡å—äº¤äº’æ—¥å¿—ï¼Œæ”¯æŒå¼€å‘è€…å®æ—¶ç›‘æ§ï¼Œè®©è¿ç»´è€…çœ‹åˆ°ã€Œé»‘ç›’ã€â€”â€”æ¯æ¬¡è°ƒç”¨é“¾ã€token æ¶ˆè€—ã€å¼‚å¸¸æ ˆã€å†³ç­–ç†ç”±å…¨éƒ¨è½ç›˜ã€‚</li>
<li>é…ç½®ä¸å­˜å‚¨æ¨¡å—ï¼ˆConfig &amp; Storageï¼‰ï¼šç®¡ç†æ¡†æ¶çš„å…¨å±€é…ç½®ï¼Œå¦‚ LLM å‚æ•°ã€ä»»åŠ¡é¢„ç®—ï¼ˆæœ€å¤§è¿­ä»£æ¬¡æ•°ã€æˆæœ¬ä¸Šé™ï¼‰ã€å­˜å‚¨è·¯å¾„ã€å·¥å…·åˆ—è¡¨ç­‰ï¼Œæ”¯æŒåŠ¨æ€é…ç½®æ›´æ–°ã€‚å®ç°æ•°æ®æŒä¹…åŒ–ï¼ŒåŒ…æ‹¬ä»»åŠ¡çŠ¶æ€ã€æ‰§è¡Œè½¨è¿¹ã€è®°å¿†æ•°æ®ã€é…ç½®ä¿¡æ¯ç­‰ï¼Œç¡®ä¿ç³»ç»Ÿé‡å¯åå¯æ¢å¤ã€‚</li>
</ul>
<h4 data-id="heading-9">2.3 Devin &amp; OpenHandsï¼ˆåŸOpenDevinï¼‰</h4>
<p>â€ŒDevinæ˜¯ç”±Cognition AIå¼€å‘çš„å…¨çƒé¦–ä¸ªAIç¨‹åºå‘˜ï¼Œå…·å¤‡å…¨æ ˆå¼€å‘èƒ½åŠ›ï¼Œèƒ½è‡ªä¸»å®Œæˆä»£ç ç¼–å†™ã€è°ƒè¯•ã€éƒ¨ç½²åŠAIæ¨¡å‹è®­ç»ƒç­‰ä»»åŠ¡â€Œã€‚Devin ä»£è¡¨äº†ä¸€ç§å…ˆè¿›çš„è‡ªä¸»Agentï¼Œæ—¨åœ¨åº”å¯¹è½¯ä»¶å·¥ç¨‹çš„å¤æ‚æ€§ã€‚å®ƒåˆ©ç”¨äº†è¯¸å¦‚ shellã€ä»£ç ç¼–è¾‘å™¨å’Œç½‘ç»œæµè§ˆå™¨ç­‰å·¥å…·çš„ç»„åˆï¼Œå±•ç¤ºäº† LLM åœ¨è½¯ä»¶å¼€å‘ä¸­æœªè¢«å……åˆ†åˆ©ç”¨çš„æ½œåŠ›ã€‚</p>
<p>OpenDevin é¡¹ç›®è¯ç”Ÿäºå¤åˆ¶ã€å¢å¼ºå¹¶åˆ›æ–°åŸå§‹ Devin æ¨¡å‹çš„æ„¿æœ›ã€‚OpenDevin çš„ç›®æ ‡æ˜¯æ¢ç´¢å¹¶æ‰©å±• Devin çš„èƒ½åŠ›ï¼Œè¯†åˆ«å…¶ä¼˜åŠ¿å’Œæ”¹è¿›é¢†åŸŸï¼Œä»¥æŒ‡å¯¼å¼€æ”¾ä»£ç æ¨¡å‹çš„è¿›å±•ã€‚é€šè¿‡å¸å¼•å¼€æºç¤¾åŒºçš„å‚ä¸ï¼ŒOpenDevin æ—¨åœ¨åº”å¯¹ Code LLM åœ¨å®é™…åœºæ™¯ä¸­é¢ä¸´çš„æŒ‘æˆ˜ï¼Œäº§å‡ºå¯¹ç¤¾åŒºæœ‰é‡å¤§è´¡çŒ®çš„ä½œå“ï¼Œå¹¶ä¸ºæœªæ¥çš„è¿›æ­¥é“ºå¹³é“è·¯ã€‚</p>
<p>OpenHands ç›®å‰ GitHub æ˜Ÿæ ‡æ•°å·²è¶… 6.5 ä¸‡ã€‚</p>
<p>OpenHands çš„ç½‘å€ä¸ºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.openhands.dev%2F" target="_blank" title="https://docs.openhands.dev/" ref="nofollow noopener noreferrer">docs.openhands.dev/</a></p>
<p>github é“¾æ¥ä¸ºï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOpenHands%2FOpenHands" target="_blank" title="https://github.com/OpenHands/OpenHands" ref="nofollow noopener noreferrer">github.com/OpenHands/Oâ€¦</a></p>
<p>Software Agent SDK: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOpenHands%2Fsoftware-agent-sdk" target="_blank" title="https://github.com/OpenHands/software-agent-sdk" ref="nofollow noopener noreferrer">github.com/OpenHands/sâ€¦</a></p>
<p>Benchmarks: <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FOpenHands%2Fbenchmarks" target="_blank" title="https://github.com/OpenHands/benchmarks" ref="nofollow noopener noreferrer">github.com/OpenHands/bâ€¦</a></p>
<p>æœ€æ–°çš„OpenHandsè®ºæ–‡å¦‚ä¸‹ï¼šThe OpenHands Software Agent SDK: A Composable and Extensible Foundation for Production Agents 2511.03690v1</p>
<h3 data-id="heading-10">0x03 OpenHands æ¶æ„æ¦‚å¿µå›¾è°±</h3>
<p>ä¸ºç²¾å‡†è§£é” OpenHands æºç çš„æ·±å±‚é€»è¾‘ï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºä¸€å¹…æ¸…æ™°çš„æ¶æ„æ¦‚å¿µå›¾è°±ï¼Œå°†åˆ†æ•£çš„æ ¸å¿ƒç»„ä»¶ä¸è®¾è®¡ç†å¿µä¸²è”æˆæœ‰æœºæ•´ä½“ã€‚è¿™ä¸€å›¾è°±çš„æ¯ä¸€ç¯éƒ½æ‰¿è½½ç€å…³é”®ä½¿å‘½ï¼Œå…±åŒæ„ç­‘èµ· AI Agenté«˜æ•ˆè¿è¡Œçš„åŸºç¡€ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/925c40e26e404219a90815f978073242~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769433231&amp;x-signature=i0kkI%2FkSx1lWdzpnEpx9dZ88Vbg%3D" alt="OpenHands-ç»„ä»¶" loading="lazy"/></p>
<p>OpenHands-ç»„ä»¶</p>
<h4 data-id="heading-11">3.1 ç³»ç»Ÿæ¶æ„</h4>
<p>ä¸‹å›¾æ˜¯OpenHands ç³»ç»Ÿæ¶æ„çš„é«˜çº§æ¦‚è§ˆã€‚ç³»ç»Ÿåˆ†ä¸ºä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼šå‰ç«¯å’Œåç«¯ã€‚å‰ç«¯è´Ÿè´£å¤„ç†ç”¨æˆ·äº¤äº’å¹¶å±•ç¤ºç»“æœã€‚åç«¯è´Ÿè´£å¤„ç†ä¸šåŠ¡é€»è¾‘å¹¶æ‰§è¡ŒAgentæ“ä½œã€‚è¿™ç§æ¶æ„çš„å…³é”®ä¼˜åŠ¿åœ¨äºå…¶çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ï¼šæ–°çš„Agentç±»å‹ã€è¡ŒåŠ¨ç±»å‹æˆ–è¿è¡Œæ—¶ç¯å¢ƒå¯ä»¥è½»æ¾é›†æˆåˆ°ç°æœ‰ç³»ç»Ÿä¸­ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db7b3e9538454b13b5fa379a1404082c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769433231&amp;x-signature=Wdog2eIcVxiOo8dCIg05C2n4NMo%3D" alt="OpenHands-Overview" loading="lazy"/></p>
<p>OpenHands-Overview</p>
<p>åç«¯æ¶æ„å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9de55afa100f4b4da11e095b63f9c040~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769433231&amp;x-signature=SgOqx4sN5kh3xZzybM%2BTNRROM%2BM%3D" alt="OpenHands-ç±»å›¾" loading="lazy"/></p>
<p>OpenHands-ç±»å›¾</p>
<h4 data-id="heading-12">3.2 ä»£ç åº“ç›®å½•ç»“æ„</h4>
<p>OpenHandsçš„ä»£ç åº“ç»„ç»‡æ¸…æ™°ï¼Œä»¥ä¸‹æ˜¯æœ€ä¸»è¦çš„ç›®å½•ï¼š</p>
<ol>
<li><strong>Agentä¸­å¿ƒï¼ˆagenthubï¼‰</strong> ï¼šè¿™æ˜¯Agentçš„æ ¸å¿ƒåŒºåŸŸï¼Œè´Ÿè´£ä»£ç ç”Ÿæˆå’Œæ‰§è¡Œç›¸å…³çš„é€»è¾‘ï¼Œæ˜¯å¹³å°çš„æ ¸å¿ƒèƒ½åŠ›è½½ä½“ã€‚å®ƒåŒ…å«ä¸“æ³¨äºä»£ç ç”Ÿæˆä¸æ‰§è¡Œçš„Agenté€»è¾‘ï¼Œæ˜¯å¹³å°çš„æ ¸å¿ƒèƒ½åŠ›æ‰€åœ¨ã€‚æ­¤å¤–ï¼Œè¿˜åŒ…æ‹¬è´Ÿè´£æµè§ˆå™¨äº¤äº’çš„Agentå®ç°ã€‚</li>
<li><strong>äº‹ä»¶ç³»ç»Ÿï¼ˆeventsï¼‰</strong> ï¼šè¿™æ˜¯äº‹ä»¶é©±åŠ¨æ¶æ„çš„æ ¸å¿ƒç›®å½•ï¼Œå®šä¹‰äº†ç³»ç»Ÿçš„â€œé€šä¿¡è¯­è¨€â€ã€‚å®ƒåŒ…å«å°è£…ä»»åŠ¡æ‰§è¡Œç»“æœç­‰åé¦ˆç±»äº‹ä»¶çš„<code>observation/</code>ï¼Œä»¥åŠå®šä¹‰Agentå¯æ‰§è¡Œçš„å„ç±»åŠ¨ä½œæŒ‡ä»¤çš„<code>action/</code>ã€‚<code>stream.py</code>å®ç°äº†äº‹ä»¶æµçš„ç®¡ç†æœºåˆ¶ï¼Œè´Ÿè´£äº‹ä»¶çš„åˆ†å‘ã€å­˜å‚¨ä¸è®¢é˜…ï¼Œæ˜¯ç»„ä»¶ååŒå·¥ä½œçš„å…³é”®æ¢çº½ã€‚</li>
<li><strong>è¿è¡Œæ—¶ç¯å¢ƒï¼ˆruntime/ï¼‰</strong> ï¼šæä¾›Agentæ‰§è¡Œçš„åº•å±‚ç¯å¢ƒæ”¯æŒã€‚<code>impl/</code>ç›®å½•åŒ…å«Dockerå®¹å™¨ã€æœ¬åœ°ç¯å¢ƒç­‰ä¸åŒè¿è¡Œæ—¶çš„å…·ä½“å®ç°ï¼›<code>plugins/</code>æ”¯æŒé€šè¿‡æ’ä»¶æ‰©å±•è¿è¡Œæ—¶åŠŸèƒ½ï¼Œæå‡ç³»ç»Ÿçš„çµæ´»æ€§ã€‚</li>
<li><strong>è®°å¿†ç®¡ç†ï¼ˆmemory/ï¼‰</strong> ï¼šè´Ÿè´£ç®¡ç†Agentçš„å†å²æ•°æ®ä¸è®°å¿†ã€‚<code>conversation_memory.py</code>å¤„ç†å¯¹è¯å†å²çš„å­˜å‚¨ä¸æ£€ç´¢ï¼›<code>condenser/</code>å®ç°å†å²è®°å½•çš„å‹ç¼©é€»è¾‘ï¼Œè§£å†³LLMä¸Šä¸‹æ–‡çª—å£æœ‰é™çš„é—®é¢˜ï¼Œä¿éšœé•¿å‘¨æœŸä»»åŠ¡çš„è¿è´¯æ€§ã€‚</li>
<li><strong>è¯­è¨€æ¨¡å‹é›†æˆï¼ˆllm/ï¼‰</strong> ï¼šå®ç°ä¸å„ç±»å¤§å‹è¯­è¨€æ¨¡å‹çš„é›†æˆã€‚</li>
<li><strong>æ§åˆ¶å™¨ï¼ˆcontroller/ï¼‰</strong> ï¼šç³»ç»Ÿçš„â€œæŒ‡æŒ¥ä¸­å¿ƒâ€ï¼Œè´Ÿè´£Agentçš„è°ƒåº¦ä¸ç®¡ç†ã€‚</li>
</ol>
<p>è¿™ç§ç»“æ„åæ˜ äº†OpenHandsçš„æ¨¡å—åŒ–è®¾è®¡ï¼Œå„ç»„ä»¶ä¹‹é—´æœ‰æ˜ç¡®çš„èŒè´£åˆ’åˆ†ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚è¿™äº›ç›®å½•ä¹‹é—´çš„é€»è¾‘ç»“æ„å¤§è‡´å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a63591e152704c359a97d25106ff75c8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769433231&amp;x-signature=0DaHoHsOiI3pFWaaHRv7v4ByaIA%3D" alt="OpenHands-æ€»ä½“æµç¨‹" loading="lazy"/></p>
<p>OpenHands-æ€»ä½“æµç¨‹</p>
<h4 data-id="heading-13">3.3 æ ¸å¿ƒç»„ä»¶</h4>
<p>OpenHandsé‡‡ç”¨äº†ä¸€ç§åŸºäºäº‹ä»¶çš„æ¶æ„ï¼Œå°†Agentã€è¿è¡Œæ—¶ç¯å¢ƒå’Œç”¨æˆ·ç•Œé¢è§£è€¦ï¼Œå®ç°çµæ´»çš„äº¤äº’æ¨¡å¼ã€‚OpenHands çš„å…³é”®ç±»åŒ…æ‹¬ï¼š</p>
<ul>
<li>
<p><strong>LLM</strong>ï¼šè´Ÿè´£ä¸å¤§å‹è¯­è¨€æ¨¡å‹çš„æ‰€æœ‰äº¤äº’ã€‚ç”±äº LiteLLM çš„æ”¯æŒï¼Œå®ƒå¯ä»¥ä¸ä»»ä½•åº•å±‚å®Œæˆæ¨¡å‹ä¸€èµ·å·¥ä½œã€‚</p>
</li>
<li>
<p><strong>Agent</strong>ï¼šè´Ÿè´£æŸ¥çœ‹å½“å‰çŠ¶æ€ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªåŠ¨ä½œï¼Œä½¿ç›®æ ‡æ›´è¿›ä¸€æ­¥æ¥è¿‘æœ€ç»ˆç›®æ ‡ã€‚</p>
</li>
<li>
<p><strong>AgentController</strong>ï¼šåˆå§‹åŒ– Agentï¼Œç®¡ç†çŠ¶æ€ï¼Œå¹¶é©±åŠ¨ä¸»è¦å¾ªç¯ï¼Œä¸€æ­¥æ­¥æ¨åŠ¨ Agent å‰è¿›ã€‚</p>
</li>
<li>
<p><strong>State</strong>ï¼šä»£è¡¨ Agent ä»»åŠ¡çš„å½“å‰çŠ¶æ€ã€‚åŒ…æ‹¬å½“å‰æ­¥éª¤ã€æœ€è¿‘äº‹ä»¶çš„å†å²è®°å½•ã€Agentçš„é•¿æœŸè®¡åˆ’ç­‰ã€‚State æ¨¡å—å°±åƒ Agent çš„ â€œè®°å¿†å¤§è„‘â€ï¼Œä¸ä»…èƒ½è®°ä¸‹ä»»åŠ¡æ‰§è¡Œä¸­çš„å„ç§çŠ¶æ€æ•°æ®ï¼Œè¿˜æ”¯æŒæ–­ç‚¹æ¢å¤ï¼Œé•¿å‘¨æœŸä»»åŠ¡å°±ç®—ä¸­æ–­äº†ï¼Œä¹Ÿèƒ½æ¥ç€ä¹‹å‰çš„è¿›åº¦ç»§ç»­åšï¼Œä¸ç”¨ä»å¤´å†æ¥ã€‚</p>
</li>
<li>
<p><strong>EventStream</strong>ï¼šäº‹ä»¶çš„ä¸­å¿ƒæ¢çº½ï¼Œä»»ä½•ç»„ä»¶éƒ½å¯ä»¥å‘å¸ƒäº‹ä»¶ï¼Œæˆ–ç›‘å¬å…¶ä»–ç»„ä»¶å‘å¸ƒçš„äº‹ä»¶ã€‚</p>
<ul>
<li>
<p><strong>Event</strong>ï¼šåŠ¨ä½œæˆ–è§‚å¯Ÿ</p>
<ul>
<li><strong>Action</strong>ï¼šä»£è¡¨ä¸€ä¸ªè¯·æ±‚ï¼Œä¾‹å¦‚ç¼–è¾‘æ–‡ä»¶ã€è¿è¡Œå‘½ä»¤æˆ–å‘é€æ¶ˆæ¯ã€‚</li>
<li><strong>Observation</strong>ï¼šä»£è¡¨ä»ç¯å¢ƒä¸­æ”¶é›†çš„ä¿¡æ¯ï¼Œä¾‹å¦‚æ–‡ä»¶å†…å®¹æˆ–å‘½ä»¤è¾“å‡ºã€‚</li>
</ul>
</li>
<li>
<p>Action å’Œ Observation ç›¸å½“äºç»„ä»¶é—´çš„ â€œé€šç”¨è¯­è¨€â€â€”â€”Action å¸¦ç€è¦æ‰§è¡Œçš„æŒ‡ä»¤ï¼ŒObservation ä¼ å›æ‰§è¡Œçš„ç»“æœï¼Œä¿©è€…é…åˆåˆ°ä½ï¼Œä¿¡æ¯ä¼ é€’æ‰é¡ºç•…ä¸å¡å£³ã€‚è¿™äº›æ¨¡å—ä¸æ˜¯å„å¹²å„çš„ï¼Œè€Œæ˜¯é  Event Stream è¿™ä¸ª â€œæ ¸å¿ƒæ¢çº½â€ è¿åœ¨ä¸€èµ·ååŒå·¥ä½œ â€”â€” å„ç§äº‹ä»¶éƒ½åœ¨è¿™é‡Œæ±‡èšã€åˆ†å‘ï¼Œæ¨ç€ä»»åŠ¡æŒ‰è®¡åˆ’ä¸€æ­¥æ­¥èµ°ï¼Œæœ€ç»ˆè®© AI Agentæœ‰èƒ½åŠ›å¤„ç†å¤æ‚ä»»åŠ¡ã€‚</p>
</li>
<li>
<p>ReAct èŒƒå¼å°±åƒæ˜¯ Agent çš„ â€œè¡Œä¸ºå‡†åˆ™â€ï¼Œå®šä¸‹äº† â€œå…ˆæ€è€ƒã€å†è¡ŒåŠ¨ã€æ”¶åé¦ˆâ€ çš„æ ¸å¿ƒé€»è¾‘ï¼Œç¡®ä¿å®ƒåšå†³ç­–æ—¶æœ‰æ¡ç†ã€ä¸æ··ä¹±ã€‚äº‹ä»¶é©±åŠ¨æ¨¡å‹åˆ™æ­èµ·äº†ç³»ç»Ÿçš„ â€œéª¨æ¶â€ï¼Œæ‰€æœ‰äº¤äº’éƒ½é äº‹ä»¶æµè½¬æ¥æ¨è¿›ï¼Œå„ä¸ªæ¨¡å—ä¸ç”¨ç¡¬ç»‘åœ¨ä¸€èµ·ï¼Œèƒ½çµæ´»åº”å¯¹å„ç§æƒ…å†µã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>Runtime</strong>ï¼šè´Ÿè´£æ‰§è¡ŒåŠ¨ä½œï¼Œå¹¶å‘é€å›è§‚å¯Ÿç»“æœã€‚</p>
<ul>
<li><strong>Sandbox</strong>ï¼šè¿è¡Œå‘½ä»¤çš„è¿è¡Œæ—¶ç¯å¢ƒéƒ¨åˆ†ï¼Œä¾‹å¦‚åœ¨ Docker å†…éƒ¨ã€‚</li>
<li>Runtime å’Œ Memory è¿™äº›ç»„ä»¶æ˜¯ç³»ç»Ÿçš„å…³é”® â€œå™¨å®˜â€ï¼šRuntime ä¼šæä¾›ä¸€ä¸ªéš”ç¦»çš„æ‰§è¡Œç¯å¢ƒï¼Œä¿è¯ä»£ç è¿è¡Œæ—¶å®‰å…¨åˆç¨³å®šï¼Œä¸ä¼šæä¹±å…¶ä»–éƒ¨åˆ†ï¼›Memory åˆ™æŠŠå†å²æ•°æ®ç®¡å¾—æ˜æ˜ç™½ç™½ï¼Œç»™ Agent åšå†³ç­–æä¾›è¿‡å¾€ç»éªŒã€‚</li>
</ul>
</li>
<li>
<p><strong>Server</strong>ï¼šé€šè¿‡ HTTP ç®¡ç† OpenHands ä¼šè¯ï¼Œä¾‹å¦‚é©±åŠ¨å‰ç«¯ã€‚</p>
<ul>
<li><strong>Session</strong>ï¼šä¿å­˜å•ä¸ª EventStreamã€å•ä¸ª AgentController å’Œå•ä¸ª Runtimeã€‚é€šå¸¸ä»£è¡¨ä¸€ä¸ªå•ä¸€ä»»åŠ¡ï¼ˆä½†å¯èƒ½åŒ…æ‹¬å‡ ä¸ªç”¨æˆ·æç¤ºï¼‰ã€‚</li>
<li><strong>ConversationManager</strong>ï¼šç»´æŠ¤ä¸€ä¸ªæ´»åŠ¨ä¼šè¯åˆ—è¡¨ï¼Œå¹¶ç¡®ä¿è¯·æ±‚è¢«è·¯ç”±åˆ°æ­£ç¡®çš„ä¼šè¯ã€‚</li>
</ul>
</li>
</ul>
<p>æ ¸å¿ƒç»„ä»¶äº¤äº’å…³ç³»å¦‚ä¸‹ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b429c27dcc1a402a97f3e1f30be19f4b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg572X6KW_55qE5oCd6ICD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769433231&amp;x-signature=MDZTJJA8bynUXkh9gEBZhDAxE9Y%3D" alt="OpenHands-æ ¸å¿ƒç»„ä»¶äº¤äº’å…³ç³»" loading="lazy"/></p>
<p>OpenHands-æ ¸å¿ƒç»„ä»¶äº¤äº’å…³ç³»</p>
<p>è¿™ä¸ªæµç¨‹å±•ç¤ºäº† OpenHands ä½œä¸ºä¸€ä¸ª AI è½¯ä»¶å¼€å‘Agentå¹³å°çš„å®Œæ•´æ¶æ„ï¼Œä»ç”¨æˆ·äº¤äº’åˆ°æ ¸å¿ƒæ‰§è¡Œçš„å®Œæ•´æ•°æ®æµå’Œç»„ä»¶å…³ç³»ã€‚</p>
<ol>
<li>
<p>ç”¨æˆ·è¾“å…¥é˜¶æ®µ</p>
<ol>
<li>ç”¨æˆ·é€šè¿‡ Web ç•Œé¢ã€CLI æˆ– API å‘èµ·è¯·æ±‚</li>
<li>æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚å¹¶åˆ›å»ºä¼šè¯</li>
<li>äº‹ä»¶é€šè¿‡äº‹ä»¶æµç³»ç»Ÿä¼ é€’</li>
</ol>
</li>
<li>
<p>Agent å¤„ç†é˜¶æ®µ</p>
<ol>
<li>Controller æ ¹æ®é…ç½®åˆå§‹åŒ–ç›¸åº” Agent</li>
<li>Agent åŸºäºå½“å‰çŠ¶æ€å’Œå†å²ç”Ÿæˆå†³ç­–</li>
<li>é€šè¿‡å·¥å…·ç³»ç»Ÿæ‰§è¡Œå…·ä½“æ“ä½œ</li>
</ol>
</li>
<li>
<p>æ‰§è¡Œé˜¶æ®µ</p>
<ol>
<li>Runtime ç¯å¢ƒæ‰§è¡Œå…·ä½“å‘½ä»¤æˆ–ä»£ç </li>
<li>æ’ä»¶ç³»ç»Ÿæä¾›é¢å¤–åŠŸèƒ½æ”¯æŒ</li>
<li>å®‰å…¨ç³»ç»Ÿç›‘æ§æ‰§è¡Œè¿‡ç¨‹</li>
</ol>
</li>
<li>
<p>åé¦ˆé˜¶æ®µ</p>
<ol>
<li>æ‰§è¡Œç»“æœä½œä¸º Observation è¿”å›</li>
<li>æ›´æ–° Agent çŠ¶æ€å’Œè®°å¿†</li>
<li>å°†ç»“æœè¿”å›ç»™ç”¨æˆ·</li>
</ol>
</li>
</ol>
<h3 data-id="heading-14">0xFF å‚è€ƒ</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.all-hands.dev%2Fopenhands%2Fusage%2Farchitecture%2Fbackend" target="_blank" title="https://docs.all-hands.dev/openhands/usage/architecture/backend" ref="nofollow noopener noreferrer">docs.all-hands.dev/openhands/uâ€¦</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1936485868761257658" target="_blank" title="https://zhuanlan.zhihu.com/p/1936485868761257658" ref="nofollow noopener noreferrer">å½“AI Agentä»â€œç©å…·â€èµ°å‘â€œå·¥å…·â€ï¼Œæˆ‘ä»¬è¯¥å…³æ³¨ä»€ä¹ˆï¼ŸOpenhandsæ¶æ„è§£æã€ç¬¬äºŒç¯‡ï¼šAgent ç›¸å…³æ ¸å¿ƒæ¦‚å¿µã€‘</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fdreamrenderx" target="_blank" title="https://www.zhihu.com/people/dreamrenderx" ref="nofollow noopener noreferrer">å…‹é‡Œ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1936175201323825087" target="_blank" title="https://zhuanlan.zhihu.com/p/1936175201323825087" ref="nofollow noopener noreferrer">å½“AI Agentä»â€œç©å…·â€èµ°å‘â€œå·¥å…·â€ï¼Œæˆ‘ä»¬è¯¥å…³æ³¨ä»€ä¹ˆï¼ŸOpenhandsæ¶æ„è§£æã€ç¬¬ä¸€ç¯‡ï¼šç³»åˆ—å¯¼è¯»ã€‘</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fdreamrenderx" target="_blank" title="https://www.zhihu.com/people/dreamrenderx" ref="nofollow noopener noreferrer">å…‹é‡Œ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1940436682949244630" target="_blank" title="https://zhuanlan.zhihu.com/p/1940436682949244630" ref="nofollow noopener noreferrer">Coding Agentä¹‹Openhandsè§£æ(å«ä»£ç )</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fwu-long-ming-cha-56" target="_blank" title="https://www.zhihu.com/people/wu-long-ming-cha-56" ref="nofollow noopener noreferrer">Arrow</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1940824548485347192" target="_blank" title="https://zhuanlan.zhihu.com/p/1940824548485347192" ref="nofollow noopener noreferrer">OpenHands æºç è§£è¯»</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fxiao-hui-66-72" target="_blank" title="https://www.zhihu.com/people/xiao-hui-66-72" ref="nofollow noopener noreferrer">ä¸€åŠ›è¾‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1968688671378093192" target="_blank" title="https://zhuanlan.zhihu.com/p/1968688671378093192" ref="nofollow noopener noreferrer">ã€Agentå·¥ç¨‹ã€‘01-Agentå·¥ç¨‹æŠ€æœ¯æ´å¯Ÿã€æŒ‘æˆ˜ä»¥åŠè§£å†³æ–¹æ¡ˆ</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fwldandan" target="_blank" title="https://www.zhihu.com/people/wldandan" ref="nofollow noopener noreferrer">ç‹ç£Š</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.anthropic.com%2Fengineering%2Fbuilding-effective-agents" target="_blank" title="https://www.anthropic.com/engineering/building-effective-agents" ref="nofollow noopener noreferrer">Building effective agents</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F-BvGnwEbgrFknZ6I-pYfjw" target="_blank" title="https://mp.weixin.qq.com/s/-BvGnwEbgrFknZ6I-pYfjw" ref="nofollow noopener noreferrer">ä»ä»£ç ç”Ÿæˆåˆ°è‡ªä¸»å†³ç­–ï¼šæ‰“é€ ä¸€ä¸ªCodingé©±åŠ¨çš„â€œè‡ªæˆ‘ç¼–ç¨‹â€Agent</a> é˜¿é‡Œäº‘å¼€å‘è€…</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1951318616042631326" target="_blank" title="https://zhuanlan.zhihu.com/p/1951318616042631326" ref="nofollow noopener noreferrer">ä» Prompt åˆ° Contextï¼šåŸºäº 1400+ è®ºæ–‡çš„ Context Engineering ç³»ç»Ÿç»¼è¿°</a> é˜¿é‡Œäº‘å¼€å‘è€…</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1948375162039804773" target="_blank" title="https://zhuanlan.zhihu.com/p/1948375162039804773" ref="nofollow noopener noreferrer">Claude Code æ·±åº¦æ‹†è§£ï¼šä¸€ä¸ªé¡¶çº§AIç¼–ç¨‹å·¥å…·çš„æ ¸å¿ƒæ¶æ„</a> é˜¿é‡Œäº‘å¼€å‘è€…</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzk0MjIwODQ2NA%3D%3D%26mid%3D2247485335%26idx%3D1%26sn%3D2966d272496d757696401d0b27b7a97a%26chksm%3Dc39a89bf69181b5351ee005d9915f4421191b6eb9b8d7833bf5a20eebc74772114da3f41133a%26mpshare%3D1%26scene%3D1%26srcid%3D11156OroWY1YJfDyRmvO25A5%26sharer_shareinfo%3D4415f8a41c58f4e4f12e4cedde93066e%26sharer_shareinfo_first%3D4415f8a41c58f4e4f12e4cedde93066e%23rd" target="_blank" title="https://mp.weixin.qq.com/s?__biz=Mzk0MjIwODQ2NA==&amp;mid=2247485335&amp;idx=1&amp;sn=2966d272496d757696401d0b27b7a97a&amp;chksm=c39a89bf69181b5351ee005d9915f4421191b6eb9b8d7833bf5a20eebc74772114da3f41133a&amp;mpshare=1&amp;scene=1&amp;srcid=11156OroWY1YJfDyRmvO25A5&amp;sharer_shareinfo=4415f8a41c58f4e4f12e4cedde93066e&amp;sharer_shareinfo_first=4415f8a41c58f4e4f12e4cedde93066e#rd" ref="nofollow noopener noreferrer">ä»æ€è€ƒåˆ°è¡ŒåŠ¨ï¼šæ·±åº¦è§£æç±»Manus AI Agentæ¶æ„è®¾è®¡ä¸æœªæ¥æ¼”è¿›</a> AnthroTech AI</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F703618853" target="_blank" title="https://zhuanlan.zhihu.com/p/703618853" ref="nofollow noopener noreferrer">AIç¨‹åºå‘˜ä¹‹OpenDevinæºç å‰–æ</a> <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.zhihu.com%2Fpeople%2Fzheng-guo-hua-82" target="_blank" title="https://www.zhihu.com/people/zheng-guo-hua-82" ref="nofollow noopener noreferrer">goofy</a></p>
<p>The OpenHands Software Agent SDK: A Composable and Extensible Foundation for Production Agents 2511.03690v1</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fassets.jimmysong.io%2Fbooks%2Fmachine-learning-systems-zh-20251023.pdf" target="_blank" title="https://assets.jimmysong.io/books/machine-learning-systems-zh-20251023.pdf" ref="nofollow noopener noreferrer">æœºå™¨å­¦ä¹ ç³»ç»Ÿæ•™ç¨‹ AI â¼¯ç¨‹åŸç†ä¸å®è·µ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fxindoo%2Fagentic-design-patterns" target="_blank" title="https://github.com/xindoo/agentic-design-patterns" ref="nofollow noopener noreferrer">Agentic Design Patternsï¼ˆä¸­æ–‡ç¿»è¯‘é¡¹ç›®ï¼‰</a></p>
<p>AIåŸç”Ÿåº”ç”¨æ¶æ„ç™½çš®ä¹¦</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1977044815716832440" target="_blank" title="https://zhuanlan.zhihu.com/p/1977044815716832440" ref="nofollow noopener noreferrer">2025å¿…çœ‹ç³»åˆ—ï¼šAIå¦‚ä½•é‡æ–°å®šä¹‰ç ”ç©¶ï¼Ÿä¸‡å­—é•¿æ–‡è®²é€ã€ŒDeep Researchã€</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1975514242754049684" target="_blank" title="https://zhuanlan.zhihu.com/p/1975514242754049684" ref="nofollow noopener noreferrer">Agentå¼€å‘å®è·µï¼šä»æƒ³æ³•åˆ°äº§å“â€”â€”SSEã€ä¸Šä¸‹æ–‡å·¥ç¨‹ä¸æµå¼è§£æå…³é”®æŠ€æœ¯æ”»åš</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1976305837011116648" target="_blank" title="https://zhuanlan.zhihu.com/p/1976305837011116648" ref="nofollow noopener noreferrer">æ·±å…¥AI Agentå†…æ ¸ï¼šGoogle gemini-cli æºç æ·±åº¦è§£æ„</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F1975511012347249929" target="_blank" title="https://zhuanlan.zhihu.com/p/1975511012347249929" ref="nofollow noopener noreferrer">Agentå¼€å‘å®è·µï¼šä»æƒ³æ³•åˆ°äº§å“â€”â€”ç³»ç»Ÿæ¶æ„è®¾è®¡å®è·µ</a></p>
<p>æœ¬æ–‡ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fmarkdown.com.cn" target="_blank" title="https://markdown.com.cn" ref="nofollow noopener noreferrer">markdown.com.cn</a> æ’ç‰ˆ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ„å»ºé«˜æ€§èƒ½å¼‚æ­¥å›¾ç‰‡æœåŠ¡å™¨ï¼šä»æ‰å¹³å­˜å‚¨åˆ°å“ˆå¸Œåˆ†ç‰‡]]></title>    <link>https://juejin.cn/post/7596926832912662591</link>    <guid>https://juejin.cn/post/7596926832912662591</guid>    <pubDate>2026-01-19T12:39:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596926832912662591" data-draft-id="7593240931287433268" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ„å»ºé«˜æ€§èƒ½å¼‚æ­¥å›¾ç‰‡æœåŠ¡å™¨ï¼šä»æ‰å¹³å­˜å‚¨åˆ°å“ˆå¸Œåˆ†ç‰‡"/> <meta itemprop="keywords" content="Python,åç«¯"/> <meta itemprop="datePublished" content="2026-01-19T12:39:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Lupino"/> <meta itemprop="url" content="https://juejin.cn/user/3051900006579256"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ„å»ºé«˜æ€§èƒ½å¼‚æ­¥å›¾ç‰‡æœåŠ¡å™¨ï¼šä»æ‰å¹³å­˜å‚¨åˆ°å“ˆå¸Œåˆ†ç‰‡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3051900006579256/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Lupino
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T12:39:54.000Z" title="Mon Jan 19 2026 12:39:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    21
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨æ„å»ºå›¾ç‰‡ä¸Šä¼ ä¸å¤„ç†æœåŠ¡æ—¶ï¼Œéšç€æ–‡ä»¶æ•°é‡ä»å‡ ä¸‡å¢é•¿åˆ°åƒä¸‡çº§åˆ«ï¼ŒåŸå§‹çš„â€œæ‰å¹³åŒ–å­˜å‚¨â€å’Œâ€œåŒæ­¥å¤„ç†â€æ¨¡å¼ä¼šè¿…é€Ÿé‡åˆ°ç“¶é¢ˆã€‚æœ¬æ–‡æ€»ç»“äº†ä¸€å¥—åŸºäº Python (Sanic) çš„é«˜æ€§èƒ½å›¾ç‰‡æœåŠ¡é‡æ„æ–¹æ¡ˆï¼Œæ¶µç›–äº†<strong>å¼‚æ­¥ I/O</strong>ã€<strong>å“ˆå¸Œåˆ†ç‰‡å­˜å‚¨</strong>ã€<strong>æ— é˜»å¡è®¡ç®—</strong>ä»¥åŠ<strong>å‰åç«¯ååŒ</strong>çš„å…¨é“¾è·¯ä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ æ ¸å¿ƒç—›ç‚¹</h2>
<p>åœ¨é‡æ„ä¹‹å‰ï¼Œç³»ç»Ÿå­˜åœ¨ä»¥ä¸‹ä¸»è¦é—®é¢˜ï¼š</p>
<ol>
<li><strong>æ–‡ä»¶ç³»ç»Ÿç“¶é¢ˆ</strong>ï¼šæ‰€æœ‰æ–‡ä»¶å­˜æ”¾åœ¨åŒä¸€ä¸ªæ ¹ç›®å½•ä¸‹ï¼Œå¯¼è‡´ <code>inode</code> æŸ¥æ‰¾å˜æ…¢ï¼Œ<code>os.listdir</code> ç­‰æ“ä½œåœ¨æ–‡ä»¶æ•°è¿‡ç™¾ä¸‡æ—¶ä¼šæ¶ˆè€—å·¨å¤§å†…å­˜å¹¶é˜»å¡ç³»ç»Ÿã€‚</li>
<li><strong>Event Loop é˜»å¡</strong>ï¼šå›¾ç‰‡ç¼©æ”¾ï¼ˆ<code>pyvips</code>ï¼‰å’Œæ–‡ä»¶åˆ é™¤ï¼ˆ<code>os.remove</code>ï¼‰æ˜¯åŒæ­¥çš„ CPU/IO å¯†é›†å‹æ“ä½œï¼Œç›´æ¥è¿è¡Œåœ¨ Sanic çš„å¼‚æ­¥å¾ªç¯ä¸­ä¼šå¡æ­»æ•´ä¸ª Web æœåŠ¡ï¼Œå¯¼è‡´é«˜å¹¶å‘ä¸‹ Ping å€¼é£™å‡ã€‚</li>
<li><strong>ç¼ºä¹æ‰©å±•æ€§</strong>ï¼šå‰ç«¯ URL ä¾èµ–åç«¯æ•°æ®åº“æŸ¥è¯¢ï¼Œæ— æ³•åˆ©ç”¨ CDN é«˜æ•ˆåˆ†å‘ã€‚</li>
</ol>
<h2 data-id="heading-1">äºŒã€ åç«¯æ¶æ„ä¼˜åŒ– (Python)</h2>
<h3 data-id="heading-2">1. å­˜å‚¨ç­–ç•¥ï¼šå“ˆå¸Œåˆ†ç‰‡ (Hash Sharding)</h3>
<p>ä¸ºäº†è§£å†³å•ç›®å½•æ–‡ä»¶è¿‡å¤šçš„é—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†åŸºäº SHA256 å“ˆå¸Œçš„åˆ†å±‚å­˜å‚¨ç»“æ„ã€‚</p>
<ul>
<li><strong>æ—§ç»“æ„</strong>ï¼š<code>/uploads/abcdef12345.png</code></li>
<li><strong>æ–°ç»“æ„</strong>ï¼š<code>/uploads/ab/cd/abcdef12345.png</code></li>
</ul>
<p>é€šè¿‡å–å“ˆå¸Œå€¼çš„å‰ 4 ä½ç”Ÿæˆä¸¤çº§å­ç›®å½•ï¼ˆ<code>256 * 256</code>ï¼‰ï¼Œå¯ä»¥å°†åƒä¸‡çº§æ–‡ä»¶å‡åŒ€åˆ†æ•£åˆ° 65,536 ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä»…å­˜æ”¾æ•°ç™¾ä¸ªæ–‡ä»¶ï¼Œç¡®ä¿å­˜å‚¨æ€§èƒ½çº¿æ€§æ‰©å±•ã€‚</p>
<p>Python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># file.py æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_shard_relative_path</span>(<span class="hljs-params">file_key: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""ç”Ÿæˆçš„è·¯å¾„ç»“æ„: ab/cd/"""</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(file_key) &lt; <span class="hljs-number">4</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>
    <span class="hljs-keyword">return</span> os.path.join(file_key[:<span class="hljs-number">2</span>], file_key[<span class="hljs-number">2</span>:<span class="hljs-number">4</span>])
</code></pre>
<h3 data-id="heading-3">2. å¼‚æ­¥åŒ–ä¸çº¿ç¨‹æ±  (AsyncIO + Thread Pool)</h3>
<p>ä¸ºäº†ä¿è¯ Sanic çš„é«˜å¹¶å‘èƒ½åŠ›ï¼Œæˆ‘ä»¬ä¸¥æ ¼åŒºåˆ†äº† <strong>I/O ç»‘å®š</strong> å’Œ <strong>CPU ç»‘å®š</strong> ä»»åŠ¡ã€‚</p>
<ul>
<li><strong>æ–‡ä»¶å†™å…¥</strong>ï¼šä½¿ç”¨ <code>aiofiles</code> å®ç°çœŸæ­£çš„å¼‚æ­¥å†™å…¥ã€‚</li>
<li><strong>CPU/é˜»å¡ IO</strong>ï¼šå°†å›¾ç‰‡ç¼©æ”¾ï¼ˆPyvipsï¼‰å’Œæ–‡ä»¶åˆ é™¤/æŸ¥æ‰¾æ“ä½œå°è£…åœ¨ <code>asyncio.to_thread</code> ä¸­ï¼Œæ”¾å…¥çº¿ç¨‹æ± è¿è¡Œï¼Œé¿å…é˜»å¡ä¸»å¾ªç¯ã€‚</li>
</ul>
<p>Python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> asyncio
<span class="hljs-keyword">import</span> aiofiles

<span class="hljs-comment"># å¼‚æ­¥å†™å…¥æ–‡ä»¶</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">save_file</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span>, content: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-literal">None</span>:
    folder = os.path.dirname(file_path)
    <span class="hljs-comment"># å¼‚æ­¥åˆ›å»ºç›®å½•ï¼ˆé˜²æ­¢ mkdir é˜»å¡ï¼‰</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(folder):
        <span class="hljs-keyword">await</span> asyncio.to_thread(os.makedirs, folder, exist_ok=<span class="hljs-literal">True</span>)
    
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> aiofiles.<span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">'wb'</span>) <span class="hljs-keyword">as</span> fp:
        <span class="hljs-keyword">await</span> fp.write(content)

<span class="hljs-comment"># æ— é˜»å¡çš„åˆ é™¤æ“ä½œ</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_remove_file</span>(<span class="hljs-params">fid: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-comment"># ... è·å– file_key ...</span>
    <span class="hljs-comment"># å°†è€—æ—¶çš„ glob æŸ¥æ‰¾å’Œ remove æ“ä½œæ‰”ç»™çº¿ç¨‹æ± </span>
    <span class="hljs-keyword">await</span> asyncio.to_thread(_remove_related_files_sync, file_key)
</code></pre>
<h2 data-id="heading-4">ä¸‰ã€ å†å²æ•°æ®è¿ç§»</h2>
<p>é’ˆå¯¹ç°å­˜çš„æ‰å¹³ç»“æ„æ–‡ä»¶ï¼Œæˆ‘ä»¬è®¾è®¡äº†å®‰å…¨çš„è¿ç§»è„šæœ¬ <code>migrate.py</code>ã€‚</p>
<ul>
<li><strong>å†…å­˜å®‰å…¨</strong>ï¼šä½¿ç”¨ <code>os.scandir</code> å’Œ <code>glob.iglob</code> æ›¿ä»£ <code>os.listdir</code>ï¼Œé‡‡ç”¨è¿­ä»£å™¨æ¨¡å¼ï¼Œå³ä½¿éå†æ•°äº¿æ–‡ä»¶ä¹Ÿä¸ä¼šçˆ†å†…å­˜ã€‚</li>
<li><strong>åŸå­æ€§</strong>ï¼šåˆ©ç”¨ <code>os.rename</code> åœ¨åŒä¸€æ–‡ä»¶ç³»ç»Ÿä¸‹çš„åŸå­æ€§ï¼Œè¿ç§»ç¬é—´å®Œæˆã€‚</li>
<li><strong>å®‰å…¨æ¨¡å¼</strong>ï¼šé»˜è®¤å¼€å¯ <code>DRY_RUN</code>ï¼Œå…ˆç©ºè·‘éªŒè¯è·¯å¾„é€»è¾‘ï¼Œå†æ‰§è¡Œå®é™…ç§»åŠ¨ã€‚</li>
</ul>
<p>Python</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># è¿ç§»é€»è¾‘ç‰‡æ®µ</span>
<span class="hljs-attr">shard_part</span> = get_shard_folder(filename) <span class="hljs-comment"># è®¡ç®— ab/cd</span>
<span class="hljs-attr">target_dir</span> = os.path.join(UPLOAD_PATH, shard_part)
<span class="hljs-comment"># ç§»åŠ¨æ–‡ä»¶</span>
os.rename(entry.path, os.path.join(target_dir, filename))
</code></pre>
<h2 data-id="heading-5">å››ã€ å‰ç«¯è·¯ç”±é€‚é… (JavaScript/TypeScript)</h2>
<p>ä¸ºäº†é…åˆåç«¯çš„å­˜å‚¨å˜æ›´ï¼Œå‰ç«¯ä¸å†ä¾èµ–åç«¯è¿”å›å®Œæ•´ URLï¼Œè€Œæ˜¯æ ¹æ® <code>file_key</code> è‡ªåŠ¨è®¡ç®—åˆ†ç‰‡è·¯å¾„ã€‚è¿™ä¸ä»…å‡è½»äº†æ•°æ®åº“å‹åŠ›ï¼Œè¿˜æ”¯æŒäº†åŠ¨æ€çš„å›¾ç‰‡å°ºå¯¸è°ƒæ•´ï¼ˆ<code>_fw</code> å‚æ•°ï¼‰ã€‚</p>
<h3 data-id="heading-6">æ™ºèƒ½ URL ç”Ÿæˆå™¨</h3>
<p>JavaScript</p>
<pre><code class="hljs language-ini" lang="ini">/**
 * å‰ç«¯æ ¹æ® Hash è‡ªåŠ¨ç”Ÿæˆåˆ†ç‰‡è·¯å¾„
 * è¾“å…¥: <span class="hljs-attr">key</span>=<span class="hljs-string">"abcde..."</span>, ext=<span class="hljs-string">"png"</span>, size=<span class="hljs-number">200</span>
 * è¾“å‡º: /uploads/ab/cd/abcde..._fw200.png
 */
export function getFileUrl(fileKey, fileExt, <span class="hljs-attr">size</span> = <span class="hljs-number">0</span>) {
  const <span class="hljs-attr">shard1</span> = fileKey.slice(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">shard2</span> = fileKey.slice(<span class="hljs-number">2</span>, <span class="hljs-number">4</span>)<span class="hljs-comment">;</span>
  
  let <span class="hljs-attr">fileName</span> = `<span class="hljs-variable">${fileKey}</span>.<span class="hljs-variable">${fileExt}</span>`<span class="hljs-comment">;</span>
  if (size &gt; 0) {
    <span class="hljs-attr">fileName</span> = `<span class="hljs-variable">${fileKey}</span>_fw<span class="hljs-variable">${size}</span>.<span class="hljs-variable">${fileExt}</span>`<span class="hljs-comment">;</span>
  }

  return `${BASE_URL}/${shard1}/${shard2}/${fileName}`<span class="hljs-comment">;</span>
}
</code></pre>
<h3 data-id="heading-7">å­˜é‡ URL ä¿®å¤</h3>
<p>å¯¹äºå†å²æ•°æ®ä¸­å­˜å‚¨çš„æ—§ç‰ˆ URLï¼ˆä¸å¸¦åˆ†ç‰‡è·¯å¾„ï¼‰ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª <code>fixFileUrl</code> å‡½æ•°è¿›è¡Œè¿è¡Œæ—¶è‡ªåŠ¨ä¿®å¤ã€‚</p>
<p>JavaScript</p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-comment">// è¾“å…¥: "http://cdn.com/abcdef123.png"</span>
<span class="hljs-comment">// è¾“å‡º: "http://cdn.com/ab/cd/abcdef123.png"</span>
<span class="hljs-function"><span class="hljs-keyword">export</span> function <span class="hljs-title">fixFileUrl</span><span class="hljs-params">(url, size = <span class="hljs-number">0</span>)</span> </span>{
    <span class="hljs-comment">// è‡ªåŠ¨æ£€æµ‹æ˜¯å¦ç¼ºå°‘åˆ†ç‰‡è·¯å¾„å¹¶æ³¨å…¥</span>
    <span class="hljs-comment">// è‡ªåŠ¨å¤„ç† _fw å°ºå¯¸å‚æ•°çš„æ›¿æ¢</span>
}
</code></pre>
<h2 data-id="heading-8">äº”ã€ Sanic è·¯ç”±é›†æˆ</h2>
<p>æœ€åï¼Œåœ¨ Web å±‚é¢ä¸Šï¼Œæˆ‘ä»¬ç¡®ä¿è·¯ç”±å¤„ç†å‡½æ•°ä¹Ÿæ˜¯å®Œå…¨å¼‚æ­¥çš„ï¼Œèƒ½å¤Ÿä»å®¹åº”å¯¹é«˜å¹¶å‘è¯·æ±‚ã€‚</p>
<p>Python</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">'/upload/&lt;file_name:path&gt;'</span></span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">serve_uploaded_file</span>(<span class="hljs-params">request, file_name</span>):
    <span class="hljs-comment"># åœ¨çº¿ç¨‹æ± ä¸­è®¡ç®—çœŸå®è·¯å¾„ï¼ˆåŒ…å«å¯èƒ½å‘ç”Ÿçš„å›¾ç‰‡ç¼©æ”¾è®¡ç®—ï¼‰</span>
    real_path = <span class="hljs-keyword">await</span> asyncio.to_thread(file.get_real_file_path, file_name)

    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> real_path <span class="hljs-keyword">or</span> <span class="hljs-keyword">not</span> os.path.exists(real_path):
        <span class="hljs-keyword">return</span> response.text(<span class="hljs-string">"File not found"</span>, status=<span class="hljs-number">404</span>)

    <span class="hljs-comment"># é«˜æ•ˆæµå¼å‘é€</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.file(real_path)
</code></pre>
<h2 data-id="heading-9">æ€»ç»“</h2>
<p>é€šè¿‡è¿™æ¬¡é‡æ„ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªåŸºç¡€çš„å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½å‡çº§ä¸ºä¼ä¸šçº§çš„é«˜æ€§èƒ½æ–‡ä»¶æœåŠ¡ã€‚</p>
<ol>
<li><strong>æ€§èƒ½</strong>ï¼šæ¶ˆé™¤äº†ä¸»çº¿ç¨‹é˜»å¡ï¼Œå¤§å¹…æå‡äº†å¹¶å‘ååé‡ (RPS)ã€‚</li>
<li><strong>æ‰©å±•æ€§</strong>ï¼šå“ˆå¸Œåˆ†ç‰‡å½»åº•è§£å†³äº†æ–‡ä»¶ç³»ç»Ÿ inode é™åˆ¶ï¼Œæ”¯æŒäº¿çº§æ–‡ä»¶å­˜å‚¨ã€‚</li>
<li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šä»£ç éµå¾ª PEP 8ï¼Œé€»è¾‘æ¸…æ™°ï¼Œå‰åç«¯é€šè¿‡ç¡®å®šæ€§çš„ Hash ç®—æ³•è§£è€¦ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å®¹å™¨åŒ–éƒ¨ç½²åœºæ™¯ä¸‹OpenJDKå„å‘è¡Œç‰ˆDockeré•œåƒæ€§èƒ½æ·±åº¦å¯¹æ¯”]]></title>    <link>https://juejin.cn/post/7597168034618114067</link>    <guid>https://juejin.cn/post/7597168034618114067</guid>    <pubDate>2026-01-20T09:22:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597168034618114067" data-draft-id="7597253913248022569" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å®¹å™¨åŒ–éƒ¨ç½²åœºæ™¯ä¸‹OpenJDKå„å‘è¡Œç‰ˆDockeré•œåƒæ€§èƒ½æ·±åº¦å¯¹æ¯”"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-20T09:22:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ITæ©˜å­çš®"/> <meta itemprop="url" content="https://juejin.cn/user/3148645291002232"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å®¹å™¨åŒ–éƒ¨ç½²åœºæ™¯ä¸‹OpenJDKå„å‘è¡Œç‰ˆDockeré•œåƒæ€§èƒ½æ·±åº¦å¯¹æ¯”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3148645291002232/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ITæ©˜å­çš®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:22:39.000Z" title="Tue Jan 20 2026 09:22:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸€ã€é•œåƒä½“ç§¯å¯¹æ¯”åˆ†æ</h2>
<h3 data-id="heading-1">1.1 ä¸»æµå‘è¡Œç‰ˆåŸºç¡€é•œåƒæ•°æ®</h3>















































<table><thead><tr><th>å‘è¡Œç‰ˆ</th><th>Javaç‰ˆæœ¬</th><th>åŸå§‹é•œåƒå¤§å°</th><th>æœ€å°åŒ–æ„å»ºå</th><th>å­˜å‚¨é©±åŠ¨ä¼˜åŒ–ç©ºé—´</th></tr></thead><tbody><tr><td><strong>Eclipse Temurin</strong>â€‹</td><td>17-jdk</td><td>285MB</td><td>182MB</td><td>Overlay2èŠ‚çœ15%</td></tr><tr><td><strong>Amazon Corretto</strong>â€‹</td><td>11-jre</td><td>218MB</td><td>156MB</td><td>AUFSä¼˜åŒ–12%</td></tr><tr><td><strong>Adoptium</strong>â€‹</td><td>8-jdk</td><td>196MB</td><td>134MB</td><td>BtrfsèŠ‚çœ8%</td></tr><tr><td><strong>Azul Zulu</strong>â€‹</td><td>17-jre</td><td>172MB</td><td>121MB</td><td>ZFSä¼˜åŒ–18%</td></tr><tr><td><strong>å®˜æ–¹openjdk</strong>â€‹</td><td>17-jdk</td><td>508MB</td><td>338MB</td><td>é»˜è®¤é…ç½®æ— ä¼˜åŒ–</td></tr></tbody></table>
<p><em>æ•°æ®æ¥æºï¼šDocker Hubå®˜æ–¹é•œåƒä»“åº“åŠå®é™…æ„å»ºæµ‹è¯•ï¼ˆ2026å¹´1æœˆæœ€æ–°æ•°æ®ï¼‰</em></p>
<h3 data-id="heading-2">1.2 å…³é”®ä½“ç§¯å·®å¼‚å› ç´ </h3>
<ul>
<li><strong>åŸºç¡€æ“ä½œç³»ç»Ÿ</strong>ï¼šAlpineé•œåƒæ¯”Debian Slimå°40%ï¼ˆå¦‚openjdk:17-jdk-alpineä»…83MBï¼‰</li>
<li><strong>æ¨¡å—åŒ–ç³»ç»Ÿ</strong>ï¼šJava 9+çš„æ¨¡å—åŒ–è®¾è®¡ä½¿JREä½“ç§¯å‡å°‘30%ï¼Œä½†æ¨¡å—æ–‡ä»¶ä»å 135MB</li>
<li><strong>æ„å»ºå·¥å…·é“¾</strong>ï¼šåŒ…å«Maven/Gradleçš„é•œåƒæ¯”çº¯JREé•œåƒå¤§2-3å€</li>
<li><strong>è°ƒè¯•ç»„ä»¶</strong>ï¼šç§»é™¤jmap/jstackç­‰å·¥å…·å¯å‡å°‘15-20MBç©ºé—´</li>
</ul>
<h2 data-id="heading-3">äºŒã€å¯åŠ¨æ€§èƒ½åŸºå‡†æµ‹è¯•</h2>
<h3 data-id="heading-4">2.1 æ ‡å‡†ç¯å¢ƒæµ‹è¯•é…ç½®</h3>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-comment"># æµ‹è¯•ç¯å¢ƒ</span>
<span class="hljs-section">CPU: AMD EPYC 7B13 (32æ ¸/64çº¿ç¨‹)</span>
<span class="hljs-section">å†…å­˜: 128GB DDR5</span>
<span class="hljs-section">å­˜å‚¨: NVMe SSD</span>
<span class="hljs-section">Dockerç‰ˆæœ¬: 26.1.3</span>
</code></pre>
<h3 data-id="heading-5">2.2 å†·å¯åŠ¨æ—¶é—´å¯¹æ¯”</h3>









































<table><thead><tr><th>å‘è¡Œç‰ˆ</th><th>ç©ºå®¹å™¨å¯åŠ¨</th><th>åº”ç”¨å¯åŠ¨ï¼ˆSpring Bootï¼‰</th><th>JVMåˆå§‹åŒ–æ—¶é—´</th></tr></thead><tbody><tr><td><strong>Eclipse Temurin</strong>â€‹</td><td>0.62s</td><td>1.28s</td><td>0.85s</td></tr><tr><td><strong>Amazon Corretto</strong>â€‹</td><td>0.68s</td><td>1.35s</td><td>0.92s</td></tr><tr><td><strong>Adoptium</strong>â€‹</td><td>0.71s</td><td>1.42s</td><td>0.98s</td></tr><tr><td><strong>Azul Zulu</strong>â€‹</td><td>0.65s</td><td>1.31s</td><td>0.89s</td></tr><tr><td><strong>å®˜æ–¹openjdk</strong>â€‹</td><td>0.89s</td><td>1.67s</td><td>1.23s</td></tr></tbody></table>
<h3 data-id="heading-6">2.3 çƒ­å¯åŠ¨æ€§èƒ½å¯¹æ¯”</h3>



































<table><thead><tr><th>å‘è¡Œç‰ˆ</th><th>é‡å¤å¯åŠ¨å¹³å‡æ—¶é—´</th><th>å†…å­˜å¤ç”¨æ•ˆç‡</th></tr></thead><tbody><tr><td><strong>Eclipse Temurin</strong>â€‹</td><td>0.23s</td><td>92%</td></tr><tr><td><strong>Amazon Corretto</strong>â€‹</td><td>0.25s</td><td>89%</td></tr><tr><td><strong>Adoptium</strong>â€‹</td><td>0.27s</td><td>87%</td></tr><tr><td><strong>Azul Zulu</strong>â€‹</td><td>0.24s</td><td>91%</td></tr><tr><td><strong>å®˜æ–¹openjdk</strong>â€‹</td><td>0.31s</td><td>85%</td></tr></tbody></table>
<h2 data-id="heading-7">ä¸‰ã€æ ¸å¿ƒå‘è¡Œç‰ˆç‰¹æ€§å¯¹æ¯”</h2>
<h3 data-id="heading-8">3.1 å®‰å…¨æ›´æ–°æœºåˆ¶</h3>









































<table><thead><tr><th>å‘è¡Œç‰ˆ</th><th>æ¼æ´ä¿®å¤å‘¨æœŸ</th><th>è®¤è¯æ ‡å‡†</th><th>åˆè§„æ€§æ”¯æŒ</th></tr></thead><tbody><tr><td><strong>Eclipse Temurin</strong>â€‹</td><td>72å°æ—¶</td><td>Java SEè®¤è¯</td><td>åŸºçº¿å®‰å…¨é…ç½®</td></tr><tr><td><strong>Amazon Corretto</strong>â€‹</td><td>24å°æ—¶</td><td>AWSå®‰å…¨åŸºå‡†</td><td>FIPS 140-2æ”¯æŒ</td></tr><tr><td><strong>Adoptium</strong>â€‹</td><td>48å°æ—¶</td><td>Eclipseè®¤è¯</td><td>OWASPæ¨è</td></tr><tr><td><strong>Azul Zulu</strong>â€‹</td><td>12å°æ—¶</td><td>Java SEè®¤è¯</td><td>åŒ»ç–—åˆè§„è®¤è¯</td></tr><tr><td><strong>å®˜æ–¹openjdk</strong>â€‹</td><td>14å¤©</td><td>æ— å¼ºåˆ¶è®¤è¯</td><td>ç¤¾åŒºç»´æŠ¤</td></tr></tbody></table>
<h3 data-id="heading-9">3.2 JVMä¼˜åŒ–èƒ½åŠ›</h3>















































<table><thead><tr><th>å‘è¡Œç‰ˆ</th><th>é»˜è®¤GCç®—æ³•</th><th>ZGCæ”¯æŒ</th><th>Shenandoahæ”¯æŒ</th><th>å†…å­˜å‹ç¼©æ¯”</th></tr></thead><tbody><tr><td><strong>Eclipse Temurin</strong>â€‹</td><td>G1</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>4:1</td></tr><tr><td><strong>Amazon Corretto</strong>â€‹</td><td>ZGC</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>3.8:1</td></tr><tr><td><strong>Adoptium</strong>â€‹</td><td>Parallel</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>4.2:1</td></tr><tr><td><strong>Azul Zulu</strong>â€‹</td><td>Shenandoah</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>3.5:1</td></tr><tr><td><strong>å®˜æ–¹openjdk</strong>â€‹</td><td>G1</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>4:1</td></tr></tbody></table>
<h2 data-id="heading-10">å››ã€ç”Ÿäº§ç¯å¢ƒé€‰å‹ç­–ç•¥</h2>
<h3 data-id="heading-11">4.1 æ¨èé€‰æ‹©çŸ©é˜µ</h3>



































<table><thead><tr><th>åœºæ™¯</th><th>é¦–é€‰æ–¹æ¡ˆ</th><th>å¤‡é€‰æ–¹æ¡ˆ</th><th>å…³é”®è€ƒé‡å› ç´ </th></tr></thead><tbody><tr><td>äº‘åŸç”Ÿå¾®æœåŠ¡</td><td>Eclipse Temurin</td><td>Amazon Corretto</td><td>å¯åŠ¨é€Ÿåº¦ã€å®‰å…¨æ›´æ–°é¢‘ç‡</td></tr><tr><td>é‡‘èçº§åº”ç”¨</td><td>Azul Zulu</td><td>Adoptium</td><td>åˆè§„è®¤è¯ã€å†…å­˜å‹ç¼©æ¯”</td></tr><tr><td>å¤§æ•°æ®è®¡ç®—</td><td>Amazon Corretto</td><td>Eclipse Temurin</td><td>ZGCä½å»¶è¿Ÿç‰¹æ€§</td></tr><tr><td>å¼€å‘æµ‹è¯•ç¯å¢ƒ</td><td>å®˜æ–¹openjdk</td><td>Adoptium</td><td>å…¼å®¹æ€§ã€è°ƒè¯•å·¥å…·å®Œæ•´æ€§</td></tr></tbody></table>
<h3 data-id="heading-12">4.2 æè‡´ä¼˜åŒ–æ–¹æ¡ˆ</h3>
<ol>
<li><strong>å¤šé˜¶æ®µæ„å»ºæ¨¡æ¿</strong></li>
</ol>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ„å»ºé˜¶æ®µï¼ˆä½¿ç”¨Mavené•œåƒï¼‰</span>
FROM maven:3.9.5-eclipse-temurin-17 AS builder
COPY pom.xml .
RUN mvn dependency:go-offline
COPY src/ ./src/
RUN mvn package -DskipTests

<span class="hljs-comment"># è¿è¡Œé˜¶æ®µï¼ˆAlpineåŸºç¡€é•œåƒï¼‰</span>
FROM eclipse-temurin:17-jre-alpine
COPY <span class="hljs-attr">--from</span>=builder /app/target/*.jar app.jar
RUN java -XX:<span class="hljs-attr">InitialRAMPercentage</span>=<span class="hljs-number">50</span> -XX:MaxRAMPercentage=<span class="hljs-number">80</span> -jar app.jar
</code></pre>
<ol>
<li><strong>JLinkè‡ªå®šä¹‰è¿è¡Œæ—¶</strong></li>
</ol>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-meta"># ä½¿ç”¨jlinkæ„å»ºç²¾ç®€æ¨¡å—</span>
jlink --<span class="hljs-keyword">add</span>-modules java.<span class="hljs-keyword">base</span>,java.sql --output /custom-jre
<span class="hljs-meta"># é•œåƒä½“ç§¯å‡å°‘65%ï¼ˆä»338MBâ†’115MBï¼‰</span>
</code></pre>
<ol>
<li><strong>å¯åŠ¨å‚æ•°ä¼˜åŒ–</strong></li>
</ol>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># æ¨èJVMå‚æ•°ç»„åˆ</span>
-<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:+UseZGC</span> -<span class="hljs-title class_">Xms512m</span> -<span class="hljs-title class_">Xmx1024m</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:MaxRAMPercentage=</span><span class="hljs-number">75</span> \
-<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:+HeapDumpOnOutOfMemoryError</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:HeapDumpPath=/var/log</span> \
-<span class="hljs-title class_">Djava</span>.security.egd=<span class="hljs-symbol">file:</span>/dev/./urandom
</code></pre>
<h2 data-id="heading-13">äº”ã€æ€§èƒ½è°ƒä¼˜å®è·µ</h2>
<h3 data-id="heading-14">5.1 å†…å­˜ç®¡ç†ä¼˜åŒ–</h3>
<ul>
<li><strong>å †å¤–å†…å­˜æ§åˆ¶</strong>ï¼šé€šè¿‡<code>-XX:MaxDirectMemorySize</code>é™åˆ¶éå †å†…å­˜</li>
<li><strong>å…ƒç©ºé—´è°ƒä¼˜</strong>ï¼š<code>-XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=256m</code></li>
<li><strong>å‹ç¼©æŒ‡é’ˆ</strong>ï¼šå¯ç”¨<code>-XX:+UseCompressedOops</code>èŠ‚çœ30%å†…å­˜</li>
</ul>
<h3 data-id="heading-15">5.2 åƒåœ¾å›æ”¶å¯¹æ¯”</h3>

































<table><thead><tr><th>GCç®—æ³•</th><th>ååé‡</th><th>å»¶è¿Ÿ</th><th>å†…å­˜å ç”¨</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>ZGC</td><td>92%</td><td>&lt;10ms</td><td>é«˜</td><td>å®æ—¶ç³»ç»Ÿã€ä½å»¶è¿Ÿéœ€æ±‚</td></tr><tr><td>Shenandoah</td><td>89%</td><td>15ms</td><td>ä¸­</td><td>ä¸­ç­‰è´Ÿè½½ã€æˆæœ¬æ•æ„Ÿç¯å¢ƒ</td></tr><tr><td>G1</td><td>95%</td><td>200ms</td><td>ä½</td><td>é€šç”¨å‹ã€å¹³è¡¡åœºæ™¯</td></tr></tbody></table>
<h2 data-id="heading-16">å…­ã€æœªæ¥è¶‹åŠ¿å±•æœ›</h2>
<ol>
<li><strong>QuarkusåŸç”Ÿé•œåƒ</strong>ï¼šç»“åˆGraalVMå¯å°†é•œåƒä½“ç§¯å‹ç¼©è‡³50MBä»¥ä¸‹</li>
<li><strong>eBPFç›‘æ§é›†æˆ</strong>ï¼šRed Hatæ­£åœ¨å¼€å‘åŸºäºeBPFçš„JVMç›‘æ§æ–¹æ¡ˆ</li>
<li><strong>AIé©±åŠ¨çš„è‡ªåŠ¨è°ƒä¼˜</strong>ï¼šOpenJDKç¤¾åŒºè®¡åˆ’å¼•å…¥AIå‚æ•°ä¼˜åŒ–å¼•æ“</li>
</ol>
<p>é€šè¿‡ç»¼åˆå¯¹æ¯”å¯è§ï¼ŒEclipse Temurinå’ŒAmazon Correttoåœ¨å¯åŠ¨é€Ÿåº¦å’Œèµ„æºæ•ˆç‡æ–¹é¢è¡¨ç°çªå‡ºï¼Œè€ŒAzul Zuluåœ¨åˆè§„æ€§åœºæ™¯å…·æœ‰ç‹¬ç‰¹ä¼˜åŠ¿ã€‚å»ºè®®ç”Ÿäº§ç¯å¢ƒä¼˜å…ˆé€‰æ‹©ç»è¿‡è®¤è¯çš„ä¼ä¸šçº§å‘è¡Œç‰ˆï¼Œå¹¶é…åˆå¤šé˜¶æ®µæ„å»ºå’ŒJLinkæŠ€æœ¯å®ç°æè‡´ä¼˜åŒ–ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React Nativeä¹‹Androidç«¯Fabric æ¶æ„æºç åˆ†æï¼ˆä¸‹ï¼‰]]></title>    <link>https://juejin.cn/post/7596896373053915199</link>    <guid>https://juejin.cn/post/7596896373053915199</guid>    <pubDate>2026-01-19T15:15:48.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596896373053915199" data-draft-id="7593731473490214975" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React Nativeä¹‹Androidç«¯Fabric æ¶æ„æºç åˆ†æï¼ˆä¸‹ï¼‰"/> <meta itemprop="keywords" content="React Native,Android,æºç é˜…è¯»"/> <meta itemprop="datePublished" content="2026-01-19T15:15:48.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¼–ç¨‹ä¹‹è·¯ä»0åˆ°1"/> <meta itemprop="url" content="https://juejin.cn/user/4125023359744296"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React Nativeä¹‹Androidç«¯Fabric æ¶æ„æºç åˆ†æï¼ˆä¸‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4125023359744296/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¼–ç¨‹ä¹‹è·¯ä»0åˆ°1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T15:15:48.000Z" title="Mon Jan 19 2026 15:15:48 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    39
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»18åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">React Nativeä¹‹Androidç«¯Fabric æ¶æ„æºç åˆ†æï¼ˆä¸‹ï¼‰</h2>
<blockquote>
<p>ç”±äºå•ç« å­—æ•°é™åˆ¶ï¼Œè¿™é‡Œå°†æœ¬æ–‡æ‹†æˆä¸Šä¸‹ä¸¤ç¯‡ï¼Œä¸Šç¯‡<a href="https://juejin.cn/post/7596869784538824704" target="_blank" title="https://juejin.cn/post/7596869784538824704">ã€ŠReact Nativeä¹‹Androidç«¯Fabric æ¶æ„æºç åˆ†æï¼ˆä¸Šï¼‰ã€‹</a></p>
</blockquote>
<h3 data-id="heading-1">Fabric ç»„ä»¶</h3>
<h4 data-id="heading-2">å£°æ˜ç»„ä»¶</h4>
<p>è¦å¼€å‘ä¸€ä¸ªFabric ç»„ä»¶ï¼Œé¦–å…ˆéœ€è¦åœ¨TSä»£ç ä¸­å£°æ˜è§„èŒƒã€‚æˆ‘ä»¬ä½¿ç”¨<code>npx create-react-native-library@latest</code>åˆ›å»ºä¸€ä¸ªFabricç»„ä»¶åº“ï¼Œç„¶åå‚è€ƒæ ¹æ®å®˜æ–¹æ–‡æ¡£çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Freactnative.dev%2Fdocs%2Ffabric-native-components-introduction" target="_blank" title="https://reactnative.dev/docs/fabric-native-components-introduction" ref="nofollow noopener noreferrer">ç¤ºä¾‹</a>æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> {
  <span class="hljs-title class_">CodegenTypes</span>,
  <span class="hljs-title class_">HostComponent</span>,
  <span class="hljs-title class_">ViewProps</span>,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;
<span class="hljs-keyword">import</span> {codegenNativeComponent} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;

<span class="hljs-keyword">type</span> <span class="hljs-title class_">WebViewScriptLoadedEvent</span> = {
  <span class="hljs-attr">result</span>: <span class="hljs-string">'success'</span> | <span class="hljs-string">'error'</span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">NativeProps</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ViewProps</span> {
  sourceURL?: <span class="hljs-built_in">string</span>;
  onScriptLoaded?: <span class="hljs-title class_">CodegenTypes</span>.<span class="hljs-property">BubblingEventHandler</span>&lt;<span class="hljs-title class_">WebViewScriptLoadedEvent</span>&gt; | <span class="hljs-literal">null</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> codegenNativeComponent&lt;<span class="hljs-title class_">NativeProps</span>&gt;(
  <span class="hljs-string">'CustomWebView'</span>,
) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HostComponent</span>&lt;<span class="hljs-title class_">NativeProps</span>&gt;;
</code></pre>
<p>è¿™é‡Œä¸»è¦æœ‰ä¸‰éƒ¨åˆ†ï¼š</p>
<ul>
<li>
<p><code>WebViewScriptLoadedEvent</code> æ˜¯ä¸€ç§æ”¯æŒçš„æ•°æ®ç±»å‹ï¼Œç”¨äºå­˜å‚¨äº‹ä»¶éœ€è¦ä»åŸç”Ÿä»£ç ä¼ é€’åˆ° JavaScript çš„æ•°æ®ã€‚</p>
</li>
<li>
<p><code>NativeProps</code> å®šä¹‰äº†å¯ä»¥è®¾ç½®çš„ç»„ä»¶å±æ€§ã€‚</p>
</li>
<li>
<p><code>codegenNativeComponent</code> å…è®¸æˆ‘ä»¬ä¸ºè‡ªå®šä¹‰ç»„ä»¶ç”Ÿæˆä»£ç ï¼Œå¹¶ä¸ºç»„ä»¶å®šä¹‰ä¸€ä¸ªä¸åŸç”Ÿå®ç°ç›¸åŒ¹é…çš„åç§°ã€‚</p>
</li>
</ul>
<p>å…¶ä¸­ï¼Œå¯¹<code>codegenNativeComponent</code>å‡½æ•°è¿›è¡Œåˆ†æï¼Œæºç <code>react-native/packages/react-native/Libraries/Utilities/codegenNativeComponent.js</code>:</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¦‚æœè¿™ä¸ªå‡½æ•°è¿è¡Œï¼Œè¯´æ˜è§†å›¾é…ç½®æ²¡æœ‰åœ¨æ„å»ºæ—¶é€šè¿‡ `GenerateViewConfigJs.js` ç”Ÿæˆã€‚</span>
<span class="hljs-comment">// å› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨ `requireNativeComponent` ä»è§†å›¾ç®¡ç†å™¨è·å–è§†å›¾é…ç½®ã€‚</span>
<span class="hljs-comment">// `requireNativeComponent` åœ¨ Bridgeless æ¨¡å¼ä¸‹ä¸å¯ç”¨ã€‚</span>
<span class="hljs-comment">// ä¾‹å¦‚ï¼šå¦‚æœ `codegenNativeComponent` ä¸æ˜¯ä»ä»¥ NativeComponent.js ç»“å°¾çš„æ–‡ä»¶ä¸­è°ƒç”¨ï¼Œ</span>
<span class="hljs-comment">// è¿™ä¸ªå‡½æ•°å°±ä¼šåœ¨è¿è¡Œæ—¶æ‰§è¡Œã€‚</span>
<span class="hljs-keyword">function</span> codegenNativeComponent&lt;<span class="hljs-title class_">Props</span>: {...}&gt;(
  <span class="hljs-attr">componentName</span>: string,
  options?: <span class="hljs-title class_">NativeComponentOptions</span>,
): <span class="hljs-title class_">NativeComponentType</span>&lt;<span class="hljs-title class_">Props</span>&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">global</span>.<span class="hljs-property">RN$Bridgeless</span> === <span class="hljs-literal">true</span> &amp;&amp; __DEV__) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(
      <span class="hljs-string">`Codegen didn't run for <span class="hljs-subst">${componentName}</span>. This will be an error in the future. Make sure you are using @react-native/babel-preset when building your JavaScript code.`</span>,
    );
  }
  <span class="hljs-comment">// ç¡®å®šåŸºç¡€ç»„ä»¶åç§°</span>
  <span class="hljs-keyword">let</span> componentNameInUse =
    options &amp;&amp; options.<span class="hljs-property">paperComponentName</span> != <span class="hljs-literal">null</span>
      ? options.<span class="hljs-property">paperComponentName</span>
      : componentName;

  <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>

  <span class="hljs-keyword">return</span> (requireNativeComponent&lt;<span class="hljs-title class_">Props</span>&gt;(
    <span class="hljs-comment">// $FlowFixMe[incompatible-type]</span>
    componentNameInUse,
  ): <span class="hljs-title class_">HostComponent</span>&lt;<span class="hljs-title class_">Props</span>&gt;);
}
</code></pre>
<p>æ ¹æ®æ³¨é‡Šå¯çŸ¥ï¼Œåœ¨æ–°æ¶æ„ä¸­ï¼Œè¿™ä¸ªå‡½æ•°å‡ ä¹æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œå› ä¸ºæ–°æ¶æ„æ˜¯é€šè¿‡<code>GenerateViewConfigJs.js</code> æ¥ç”Ÿæˆå®é™…çš„è§†å›¾é…ç½®ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡æœç´¢<code>codegenNativeComponent</code>å­—ç¬¦ä¸²ï¼Œå¾ˆå®¹æ˜“å®šä½åˆ°<code>react-native/packages/babel-plugin-codegen/index.js</code>æ–‡ä»¶ï¼Œè¿™é‡Œ<strong>babel-plugin-codegen</strong>åŒ…å°±æ˜¯æ£€æµ‹<code>codegenNativeComponent</code>è°ƒç”¨ï¼Œè§£æ<strong>TypeScript/Flow</strong>ç±»å‹å®šä¹‰çš„å·¥å…·åŒ…ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">{parse, types: t}</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-title function_">pre</span>(<span class="hljs-params">state</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">code</span> = state.<span class="hljs-property">code</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">filename</span> = state.<span class="hljs-property">opts</span>.<span class="hljs-property">filename</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultExport</span> = <span class="hljs-literal">null</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">commandsExport</span> = <span class="hljs-literal">null</span>;
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">codeInserted</span> = <span class="hljs-literal">false</span>;
    },

    <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç .....</span>
      <span class="hljs-title class_">ExportDefaultDeclaration</span>(path, state) {
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isCodegenDeclaration</span>(path.<span class="hljs-property">node</span>.<span class="hljs-property">declaration</span>)) {
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultExport</span> = path;
        }
      },

      <span class="hljs-comment">// ç¨‹åºé€€å‡ºæ—¶è¿›è¡Œæ›¿æ¢</span>
      <span class="hljs-title class_">Program</span>: {
        <span class="hljs-title function_">exit</span>(<span class="hljs-params">path</span>) {
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultExport</span>) {
            <span class="hljs-comment">// 1. ç”ŸæˆViewConfigä»£ç </span>
            <span class="hljs-keyword">const</span> viewConfig = <span class="hljs-title function_">generateViewConfig</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">filename</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">code</span>);
            <span class="hljs-comment">// 2. è§£æä¸ºAST</span>
            <span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(viewConfig, {
              <span class="hljs-attr">babelrc</span>: <span class="hljs-literal">false</span>,
              <span class="hljs-attr">browserslistConfigFile</span>: <span class="hljs-literal">false</span>,
              <span class="hljs-attr">configFile</span>: <span class="hljs-literal">false</span>,
            });

            <span class="hljs-comment">// 3. å®Œå…¨æ›¿æ¢åŸå§‹å¯¼å‡º</span>
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultExport</span>.<span class="hljs-title function_">replaceWithMultiple</span>(ast.<span class="hljs-property">program</span>.<span class="hljs-property">body</span>);

            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">commandsExport</span> != <span class="hljs-literal">null</span>) {
              <span class="hljs-variable language_">this</span>.<span class="hljs-property">commandsExport</span>.<span class="hljs-title function_">remove</span>();
            }

            <span class="hljs-variable language_">this</span>.<span class="hljs-property">codeInserted</span> = <span class="hljs-literal">true</span>;
          }
        },
      },
    },
  };
};


<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateViewConfig</span>(<span class="hljs-params">filename <span class="hljs-comment">/*: string */</span>, code <span class="hljs-comment">/*: string */</span></span>) {
  <span class="hljs-comment">// è§£æTypeScript/Flowç±»å‹</span>
  <span class="hljs-keyword">const</span> schema = <span class="hljs-title function_">parseFile</span>(filename, code);
  <span class="hljs-comment">// æå–ç»„ä»¶ä¿¡æ¯</span>
  <span class="hljs-keyword">const</span> libraryName = <span class="hljs-title function_">basename</span>(filename).<span class="hljs-title function_">replace</span>(
    <span class="hljs-regexp">/NativeComponent\.(js|ts)$/</span>,
    <span class="hljs-string">''</span>,
  );
  <span class="hljs-comment">// è°ƒç”¨Codegenç”Ÿæˆå™¨</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">RNCodegen</span>.<span class="hljs-title function_">generateViewConfig</span>({
    libraryName,
    schema,
  });
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">isCodegenDeclaration</span>(<span class="hljs-params">declaration</span>) {
  <span class="hljs-keyword">if</span> (!declaration) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-keyword">if</span> (
    declaration.<span class="hljs-property">left</span> &amp;&amp;
    declaration.<span class="hljs-property">left</span>.<span class="hljs-property">left</span> &amp;&amp;
    declaration.<span class="hljs-property">left</span>.<span class="hljs-property">left</span>.<span class="hljs-property">name</span> === <span class="hljs-string">'codegenNativeComponent'</span>
  ) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
    declaration.<span class="hljs-property">callee</span> &amp;&amp;
    declaration.<span class="hljs-property">callee</span>.<span class="hljs-property">name</span> &amp;&amp;
    declaration.<span class="hljs-property">callee</span>.<span class="hljs-property">name</span> === <span class="hljs-string">'codegenNativeComponent'</span>
  ) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  } 
  <span class="hljs-comment">// çœç•¥......</span>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p>ç»§ç»­è·Ÿè¸ª<code>RNCodegen.generateViewConfig</code>çš„å®ç°ï¼Œæºç <code>react-native/packages/react-native-codegen/src/generators/RNCodegen.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> generateViewConfigJs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./components/GenerateViewConfigJs.js'</span>);


<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">allGenerators</span>: <span class="hljs-variable constant_">ALL_GENERATORS</span>,
  <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>
  <span class="hljs-title function_">generateViewConfig</span>({
    libraryName,
    schema,
  }: <span class="hljs-title class_">Pick</span>&lt;<span class="hljs-title class_">LibraryOptions</span>, <span class="hljs-string">'libraryName'</span> | <span class="hljs-string">'schema'</span>&gt;): string {
    schemaValidator.<span class="hljs-title function_">validate</span>(schema);

    <span class="hljs-keyword">const</span> result = generateViewConfigJs
      .<span class="hljs-title function_">generate</span>(libraryName, schema)
      .<span class="hljs-title function_">values</span>()
      .<span class="hljs-title function_">next</span>();

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> result.<span class="hljs-property">value</span> !== <span class="hljs-string">'string'</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`Failed to generate view config for <span class="hljs-subst">${libraryName}</span>`</span>);
    }

    <span class="hljs-keyword">return</span> result.<span class="hljs-property">value</span>;
  },
};
</code></pre>
<p>æœ€ç»ˆæ˜¯è°ƒç”¨çš„<code>GenerateViewConfigJs.js</code>ä¸­çš„<code>generate</code>ï¼Œæºç <code>react-native/packages/react-native-codegen/src/generators/components/GenerateViewConfigJs.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-title function_">generate</span>(<span class="hljs-attr">libraryName</span>: string, <span class="hljs-attr">schema</span>: <span class="hljs-title class_">SchemaType</span>): <span class="hljs-title class_">FilesOutput</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> fileName = <span class="hljs-string">`<span class="hljs-subst">${libraryName}</span>NativeViewConfig.js`</span>;
      <span class="hljs-keyword">const</span> <span class="hljs-attr">imports</span>: <span class="hljs-title class_">Set</span>&lt;string&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();

      <span class="hljs-keyword">const</span> moduleResults = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(schema.<span class="hljs-property">modules</span>)
        .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">moduleName</span> =&gt;</span> {
          <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = schema.<span class="hljs-property">modules</span>[moduleName];
          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">module</span>.<span class="hljs-property">type</span> !== <span class="hljs-string">'Component'</span>) {
            <span class="hljs-keyword">return</span>;
          }

          <span class="hljs-keyword">const</span> {components} = <span class="hljs-variable language_">module</span>;

          <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(components)
            .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">componentName: string</span>) =&gt;</span> {
              <span class="hljs-keyword">const</span> component = components[componentName];

              <span class="hljs-keyword">if</span> (component.<span class="hljs-property">paperComponentNameDeprecated</span>) {
                imports.<span class="hljs-title function_">add</span>(<span class="hljs-variable constant_">UIMANAGER_IMPORT</span>);
              }

              <span class="hljs-keyword">const</span> replacedTemplate = <span class="hljs-title class_">ComponentTemplate</span>({
                componentName,
                <span class="hljs-attr">paperComponentName</span>: component.<span class="hljs-property">paperComponentName</span>,
                <span class="hljs-attr">paperComponentNameDeprecated</span>:
                  component.<span class="hljs-property">paperComponentNameDeprecated</span>,
              });
      <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ...... </span>

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[fileName, replacedTemplate]]);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`\nError parsing schema for <span class="hljs-subst">${libraryName}</span>\n`</span>);
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(schema));
      <span class="hljs-keyword">throw</span> error;
    }
  },
};
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬æ ¹æ®<code>ComponentTemplate</code>ä¸­çš„æ¨¡æ¿ï¼Œå¤§æ¦‚å°±èƒ½è¿˜åŸå‡ºç”Ÿæˆçš„ä»£ç æ˜¯ä»€ä¹ˆæ ·å­ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// è¾“å…¥ï¼š</span>
<span class="hljs-comment">// libraryName: "MyComponent"</span>
<span class="hljs-comment">// schema: { è§£æåçš„TypeScript/Flowç±»å‹ä¿¡æ¯ }</span>

<span class="hljs-comment">// è¾“å‡ºï¼šå®Œæ•´çš„JavaScriptä»£ç å­—ç¬¦ä¸²</span>
<span class="hljs-meta">

'use strict'</span>;

<span class="hljs-keyword">const</span> {<span class="hljs-title class_">UIManager</span>} = <span class="hljs-built_in">require</span>(<span class="hljs-string">"react-native"</span>)

<span class="hljs-keyword">let</span> nativeComponentName = <span class="hljs-string">'MyComponent'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> __INTERNAL_VIEW_CONFIG = {
  <span class="hljs-attr">uiViewClassName</span>: <span class="hljs-string">'MyComponent'</span>,
  <span class="hljs-attr">bubblingEventTypes</span>: {},
  <span class="hljs-attr">directEventTypes</span>: {},
  <span class="hljs-attr">validAttributes</span>: {
    <span class="hljs-attr">opacity</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">backgroundColor</span>: { <span class="hljs-attr">process</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-native/Libraries/StyleSheet/processColor'</span>).<span class="hljs-property">default</span> },
    <span class="hljs-comment">// ... å…¶ä»–å±æ€§</span>
  }
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">NativeComponentRegistry</span>.<span class="hljs-title function_">get</span>(nativeComponentName, <span class="hljs-function">() =&gt;</span> __INTERNAL_VIEW_CONFIG);
</code></pre>
<p>è¿™é‡Œæœ€å…³é”®çš„å°±æ˜¯æœ€åä¸€è¡Œï¼Œå®ƒå°†å¼€å‘è€…ç¼–å†™çš„Fabric ç»„ä»¶è§„èŒƒè¿›è¡Œäº†ä»£ç æ›¿æ¢ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¼€å‘è€…ç¼–å†™</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">CustomView</span> = codegenNativeComponent&lt;<span class="hljs-title class_">Props</span>&gt;(<span class="hljs-string">'CustomView'</span>);

<span class="hljs-comment">// Babelæ’ä»¶æ›¿æ¢å</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">CustomView</span> = <span class="hljs-title class_">NativeComponentRegistry</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'CustomView'</span>, <span class="hljs-function">() =&gt;</span> __INTERNAL_VIEW_CONFIG);
</code></pre>
<p>éœ€è¦æ³¨æ„ï¼Œ<strong>babel-plugin-codegen</strong>å·¥å…·å¹¶ä¸åƒ<strong>Codegen</strong>å·¥å…·ï¼Œä¼šç”Ÿæˆå®é™…çš„ä»£ç æ–‡ä»¶ã€‚å®ƒæ˜¯å¯¹ASTè¯­æ³•æ ‘è¿›è¡Œçš„åŠ¨æ€ä¿®æ”¹å’Œæ›¿æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¿®æ”¹çš„æ˜¯å†…å­˜ä¸­çš„è¯­æ³•æ ‘ï¼Œå¹¶ä¸ä¼šå†™æ–‡ä»¶ã€‚</p>
<p>ç°åœ¨æ¥é‡ç‚¹è¿½è¸ª<code>NativeComponentRegistry.get</code>çš„å®ç°ï¼Œé¦–å…ˆæ˜¯å¯¼å‡ºä½ç½®<code>react-native/packages/react-native/index.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-keyword">get</span> <span class="hljs-title function_">NativeComponentRegistry</span>() {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">require</span>(<span class="hljs-string">'./Libraries/NativeComponent/NativeComponentRegistry'</span>);
  },
</code></pre>
<p>å®šä½åˆ°æ–¹æ³•å®ç°<code>react-native/packages/react-native/Libraries/NativeComponent/NativeComponentRegistry.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * è·å–ä¸€ä¸ªå¯ä»¥è¢« React Native æ¸²æŸ“çš„ `NativeComponent`ã€‚
 *
 * æä¾›çš„ `viewConfigProvider` å¯èƒ½ä¼šè¢«è°ƒç”¨å’Œä½¿ç”¨ï¼Œä¹Ÿå¯èƒ½ä¸ä¼šï¼Œ
 * è¿™å–å†³äº `setRuntimeConfigProvider` æ˜¯å¦‚ä½•é…ç½®çš„ã€‚
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> get&lt;<span class="hljs-title class_">Config</span>: {...}&gt;(
  <span class="hljs-attr">name</span>: string,
  <span class="hljs-attr">viewConfigProvider</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">PartialViewConfig</span>,
): <span class="hljs-title class_">HostComponent</span>&lt;<span class="hljs-title class_">Config</span>&gt; {
  <span class="hljs-comment">// æ³¨å†ŒViewConfigåˆ°å…¨å±€æ³¨å†Œè¡¨</span>
  <span class="hljs-title class_">ReactNativeViewConfigRegistry</span>.<span class="hljs-title function_">register</span>(name, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// è¿™é‡Œçš„å›è°ƒå‡½æ•°ä¼šåœ¨Reactéœ€è¦ç»„ä»¶é…ç½®æ—¶è¢«è°ƒç”¨</span>
    <span class="hljs-keyword">const</span> {native, verify} = getRuntimeConfig?.(name) ?? {
      <span class="hljs-attr">native</span>: !<span class="hljs-variable language_">global</span>.<span class="hljs-property">RN$Bridgeless</span>,   <span class="hljs-comment">// å…³é”®ï¼šæ–°æ¶æ„æ£€æµ‹</span>
      <span class="hljs-attr">verify</span>: <span class="hljs-literal">false</span>,
    };

    <span class="hljs-keyword">let</span> <span class="hljs-attr">viewConfig</span>: <span class="hljs-title class_">ViewConfig</span>;
    <span class="hljs-keyword">if</span> (native) {
      <span class="hljs-comment">// æ—§æ¶æ„ï¼šåŸç”ŸViewManager</span>
      viewConfig =
        <span class="hljs-title function_">getNativeComponentAttributes</span>(name) ??
        <span class="hljs-title function_">createViewConfig</span>(<span class="hljs-title function_">viewConfigProvider</span>());
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// æ–°æ¶æ„ï¼šä¼˜å…ˆé™æ€ViewConfig</span>
      viewConfig =
        <span class="hljs-title function_">createViewConfig</span>(<span class="hljs-title function_">viewConfigProvider</span>()) ??
        <span class="hljs-title function_">getNativeComponentAttributes</span>(name);
    }
    <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>
    <span class="hljs-keyword">return</span> viewConfig;
  });

  <span class="hljs-comment">// $FlowFixMe[incompatible-type] `NativeComponent` å®é™…ä¸Šæ˜¯å­—ç¬¦ä¸²!</span>
  <span class="hljs-keyword">return</span> name;
}
</code></pre>
<p>ç»§ç»­è·Ÿè¸ª<code>ReactNativeViewConfigRegistry.register</code>å®ç°ã€‚æºç <code>react-native/packages/react-native/Libraries/Renderer/shims/ReactNativeViewConfigRegistry.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> viewConfigCallbacks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;string, ?<span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">ViewConfig</span>&gt;();


<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">register</span>(<span class="hljs-params">name: string, callback: () =&gt; ViewConfig</span>): string {
  <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>
  viewConfigCallbacks.<span class="hljs-title function_">set</span>(name, callback);
  <span class="hljs-keyword">return</span> name;
}
</code></pre>
<p>è¿™é‡ŒåŸºæœ¬ä¸Šå°±æ˜¯å°†è¿”å›<code>ViewConfig</code>çš„é—­åŒ…ç»™å­˜äº†èµ·æ¥ã€‚</p>
<h4 data-id="heading-3">æŸ¥æ‰¾ç»„ä»¶</h4>
<h5 data-id="heading-4">JSå±‚</h5>
<p>åœ¨å‰é¢å¯åŠ¨æ¸²æŸ“ä¸€èŠ‚æˆ‘ä»¬çŸ¥é“äº†å¯åŠ¨æ¸²æŸ“çš„æœ€ç»ˆè°ƒç”¨æ˜¯JSå±‚çš„<code>AppRegistry.runApplication</code>æ–¹æ³•ã€‚æ²¿ç€è¿™æ¡çº¿ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹JSå±‚çš„ç»„ä»¶åŠ è½½ä¸å¤„ç†æµç¨‹ã€‚æºç <code>react-native/packages/react-native/Libraries/ReactNative/AppRegistry.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">AppRegistry</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./AppRegistryImpl'</span>;

<span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>
<span class="hljs-variable language_">global</span>.<span class="hljs-property">RN$AppRegistry</span> = <span class="hljs-title class_">AppRegistry</span>;

<span class="hljs-title function_">registerCallableModule</span>(<span class="hljs-string">'AppRegistry'</span>, <span class="hljs-title class_">AppRegistry</span>);

<span class="hljs-keyword">export</span> {<span class="hljs-title class_">AppRegistry</span>};
</code></pre>
<p>ç»§ç»­è·Ÿè¸ªæºç <code>react-native/packages/react-native/Libraries/ReactNative/AppRegistryImpl.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-attr">runnables</span>: <span class="hljs-title class_">Runnables</span> = {};


<span class="hljs-comment">/**
 * Loads the JavaScript bundle and runs the app.
 *
 * See https://reactnative.dev/docs/appregistry#runapplication
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">runApplication</span>(<span class="hljs-params">
  appKey: string,
  appParameters: AppParameters,
  displayMode?: number,
</span>): <span class="hljs-keyword">void</span> {
  <span class="hljs-keyword">if</span> (appKey !== <span class="hljs-string">'LogBox'</span>) {
    <span class="hljs-keyword">const</span> logParams = __DEV__ ? <span class="hljs-string">` with <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(appParameters)}</span>`</span> : <span class="hljs-string">''</span>;
    <span class="hljs-keyword">const</span> msg = <span class="hljs-string">`Running "<span class="hljs-subst">${appKey}</span>"<span class="hljs-subst">${logParams}</span>`</span>;
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg);
  }

  <span class="hljs-title class_">SceneTracker</span>.<span class="hljs-title function_">setActiveScene</span>({<span class="hljs-attr">name</span>: appKey});
  runnables[appKey](appParameters, <span class="hljs-title function_">coerceDisplayMode</span>(displayMode));
}


<span class="hljs-comment">/**
 * Registers an app's root component.
 *
 * See https://reactnative.dev/docs/appregistry#registercomponent
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">registerComponent</span>(<span class="hljs-params">
  appKey: string,
  componentProvider: ComponentProvider,
  section?: boolean,
</span>): string {
  <span class="hljs-keyword">const</span> scopedPerformanceLogger = <span class="hljs-title function_">createPerformanceLogger</span>();
  runnables[appKey] = <span class="hljs-function">(<span class="hljs-params">appParameters, displayMode</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> renderApplication = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./renderApplication'</span>).<span class="hljs-property">default</span>;
    <span class="hljs-title function_">renderApplication</span>(
      <span class="hljs-title function_">componentProviderInstrumentationHook</span>(
        componentProvider,
        scopedPerformanceLogger,
      ),
      appParameters.<span class="hljs-property">initialProps</span>,
      appParameters.<span class="hljs-property">rootTag</span>,
      wrapperComponentProvider &amp;&amp; <span class="hljs-title function_">wrapperComponentProvider</span>(appParameters),
      rootViewStyleProvider &amp;&amp; <span class="hljs-title function_">rootViewStyleProvider</span>(appParameters),
      appParameters.<span class="hljs-property">fabric</span>,
      scopedPerformanceLogger,
      appKey === <span class="hljs-string">'LogBox'</span>, <span class="hljs-comment">// is logbox</span>
      appKey,
      displayMode,
    );
  };
  <span class="hljs-keyword">if</span> (section) {
    sections[appKey] = runnables[appKey];
  }
  <span class="hljs-keyword">return</span> appKey;
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>runApplication</code>è°ƒç”¨çš„æ˜¯<code>runnables</code>å¯¹è±¡ä¸­æ³¨å†Œçš„é—­åŒ…ã€‚è€Œåœ¨æˆ‘ä»¬React Native JSå±‚çš„BundleåŒ…ä¸­ï¼Œé¦–å…ˆå°±éœ€è¦è°ƒç”¨<code>AppRegistry.registerComponent(appName, () =&gt; App)</code>å®Œæˆæœ€æ ¹ç»„ä»¶çš„æ³¨å†Œã€‚æ‰€ä»¥<code>runApplication</code>æ–¹æ³•ä¸­è°ƒç”¨çš„é—­åŒ…ï¼Œå°±æ˜¯åœ¨<code>registerComponent</code>ä¸­æ³¨å†Œçš„é—­åŒ…ã€‚</p>
<p>ç»§ç»­è·Ÿè¸ª<code>renderApplication</code>æ–¹æ³•çš„å®ç°ï¼Œæºç <code>react-native/packages/react-native/Libraries/ReactNative/renderApplication.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> renderApplication&lt;<span class="hljs-title class_">Props</span>: <span class="hljs-title class_">Object</span>&gt;(
  <span class="hljs-title class_">RootComponent</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">ComponentType</span>&lt;<span class="hljs-title class_">Props</span>&gt;,
  <span class="hljs-attr">initialProps</span>: <span class="hljs-title class_">Props</span>,
  <span class="hljs-attr">rootTag</span>: any,
  <span class="hljs-title class_">WrapperComponent</span>?: ?<span class="hljs-title class_">React</span>.<span class="hljs-property">ComponentType</span>&lt;any&gt;,
  rootViewStyle?: ?<span class="hljs-title class_">ViewStyleProp</span>,
  fabric?: boolean,
  scopedPerformanceLogger?: <span class="hljs-title class_">IPerformanceLogger</span>,
  isLogBox?: boolean,
  debugName?: string,
  displayMode?: ?<span class="hljs-title class_">DisplayModeType</span>,
  useOffscreen?: boolean,
) {

  <span class="hljs-keyword">const</span> performanceLogger = scopedPerformanceLogger ?? <span class="hljs-title class_">GlobalPerformanceLogger</span>;

  <span class="hljs-comment">// æ„å»ºReactå…ƒç´ æ ‘</span>
  <span class="hljs-comment">// å¤–å±‚ï¼šPerformanceLoggerContext.Provider - æä¾›æ€§èƒ½ç›‘æ§ä¸Šä¸‹æ–‡</span>
  <span class="hljs-comment">// ä¸­å±‚ï¼šAppContainer - React Nativeçš„æ ¹å®¹å™¨ç»„ä»¶</span>
  <span class="hljs-comment">// å†…å±‚ï¼šRootComponent - ç”¨æˆ·æ³¨å†Œçš„åº”ç”¨ç»„ä»¶ï¼ˆå¦‚App.jsï¼‰</span>
  <span class="hljs-keyword">let</span> <span class="hljs-attr">renderable</span>: <span class="hljs-title class_">React</span>.<span class="hljs-property">MixedElement</span> = (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">PerformanceLoggerContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{performanceLogger}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AppContainer</span>
        <span class="hljs-attr">rootTag</span>=<span class="hljs-string">{rootTag}</span>
        <span class="hljs-attr">fabric</span>=<span class="hljs-string">{fabric}</span>
        <span class="hljs-attr">WrapperComponent</span>=<span class="hljs-string">{WrapperComponent}</span>
        <span class="hljs-attr">rootViewStyle</span>=<span class="hljs-string">{rootViewStyle}</span>
        <span class="hljs-attr">initialProps</span>=<span class="hljs-string">{initialProps</span> ?? <span class="hljs-attr">Object.freeze</span>({})}
        <span class="hljs-attr">internal_excludeLogBox</span>=<span class="hljs-string">{isLogBox}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">RootComponent</span> {<span class="hljs-attr">...initialProps</span>} <span class="hljs-attr">rootTag</span>=<span class="hljs-string">{rootTag}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">AppContainer</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">PerformanceLoggerContext.Provider</span>&gt;</span></span>
  );

  <span class="hljs-comment">// å¼€å‘æ¨¡å¼è°ƒè¯•åŒ…è£…</span>
  <span class="hljs-keyword">if</span> (__DEV__ &amp;&amp; debugName) {
    <span class="hljs-keyword">const</span> <span class="hljs-title class_">RootComponentWithMeaningfulName</span> = <span class="hljs-title function_">getCachedComponentWithDebugName</span>(
      <span class="hljs-string">`<span class="hljs-subst">${debugName}</span>(RootComponent)`</span>,
    );
    renderable = (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">RootComponentWithMeaningfulName</span>&gt;</span>
        {renderable}
      <span class="hljs-tag">&lt;/<span class="hljs-name">RootComponentWithMeaningfulName</span>&gt;</span></span>
    );
  }

  <span class="hljs-comment">//  å®éªŒæ€§ç¦»å±æ¸²æŸ“æ”¯æŒ</span>
  <span class="hljs-keyword">if</span> (useOffscreen &amp;&amp; displayMode != <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// $FlowFixMe[incompatible-type]</span>
    <span class="hljs-comment">// $FlowFixMe[prop-missing]</span>
    <span class="hljs-comment">// $FlowFixMe[missing-export]</span>
    <span class="hljs-keyword">const</span> <span class="hljs-title class_">Activity</span>: <span class="hljs-title class_">ActivityType</span> = <span class="hljs-title class_">React</span>.<span class="hljs-property">unstable_Activity</span>;

    renderable = (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Activity</span>
        <span class="hljs-attr">mode</span>=<span class="hljs-string">{displayMode</span> === <span class="hljs-string">DisplayMode.VISIBLE</span> ? '<span class="hljs-attr">visible</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">hidden</span>'}&gt;</span>
        {renderable}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Activity</span>&gt;</span></span>
    );
  }

  <span class="hljs-comment">// æˆ‘ä»¬å¸Œæœ›åœ¨ä½¿ç”¨ Fabric æ—¶å§‹ç»ˆå¯ç”¨ concurrentRoot åŠŸèƒ½</span>
  <span class="hljs-keyword">const</span> useConcurrentRoot = <span class="hljs-title class_">Boolean</span>(fabric);

  <span class="hljs-comment">// çœç•¥éƒ¨åˆ†æ€§èƒ½æ—¥å¿—æ‰“å°......</span>

  <span class="hljs-comment">// è¿›å…¥Reactæ¸²æŸ“ç³»ç»Ÿ</span>
  <span class="hljs-title class_">Renderer</span>.<span class="hljs-title function_">renderElement</span>({
    <span class="hljs-attr">element</span>: renderable,
    rootTag,
    <span class="hljs-attr">useFabric</span>: <span class="hljs-title class_">Boolean</span>(fabric),
    useConcurrentRoot,
  });
}
</code></pre>
<p>ç»§ç»­è·Ÿè¸ª<code>Renderer.renderElement</code>æ–¹æ³•å®ç°ã€‚æºç <code>react-native/packages/react-native/Libraries/ReactNative/RendererImplementation.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">renderElement</span>(<span class="hljs-params">{
  element,
  rootTag,
  useFabric,
  useConcurrentRoot,
}: {
  element: React.MixedElement,
  rootTag: number,
  useFabric: boolean,
  useConcurrentRoot: boolean,
}</span>): <span class="hljs-keyword">void</span> {
  <span class="hljs-keyword">if</span> (useFabric) {
    <span class="hljs-keyword">if</span> (cachedFabricRender == <span class="hljs-literal">null</span>) {
      <span class="hljs-comment">// è·å–å®é™…æ¸²æŸ“å™¨</span>
      cachedFabricRender = <span class="hljs-title function_">getFabricRenderer</span>().<span class="hljs-property">render</span>;
    }

    <span class="hljs-title function_">cachedFabricRender</span>(element, rootTag, <span class="hljs-literal">null</span>, useConcurrentRoot, {
      onCaughtError,
      onUncaughtError,
      onRecoverableError,
    });
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// çœç•¥æ—§æ¶æ„......</span>
  }
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getFabricRenderer</span>(<span class="hljs-params"/>): <span class="hljs-title class_">ReactFabricType</span> {
  <span class="hljs-keyword">if</span> (cachedFabricRenderer == <span class="hljs-literal">null</span>) {
    cachedFabricRenderer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../Renderer/shims/ReactFabric'</span>).<span class="hljs-property">default</span>;
  }
  <span class="hljs-keyword">return</span> cachedFabricRenderer;
}
</code></pre>
<p>ç»§ç»­è·Ÿè¸ª<code>react-native/packages/react-native/Libraries/Renderer/shims/ReactFabric.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">import</span> {<span class="hljs-title class_">BatchedBridge</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native/Libraries/ReactPrivate/ReactNativePrivateInterface'</span>;

<span class="hljs-keyword">import</span> type {<span class="hljs-title class_">ReactFabricType</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactNativeTypes'</span>;

<span class="hljs-keyword">let</span> <span class="hljs-title class_">ReactFabric</span>: <span class="hljs-title class_">ReactFabricType</span>;

<span class="hljs-keyword">if</span> (__DEV__) {
  <span class="hljs-title class_">ReactFabric</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../implementations/ReactFabric-dev'</span>);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-title class_">ReactFabric</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../implementations/ReactFabric-prod'</span>);
}

<span class="hljs-variable language_">global</span>.<span class="hljs-property">RN$stopSurface</span> = <span class="hljs-title class_">ReactFabric</span>.<span class="hljs-property">stopSurface</span>;

<span class="hljs-keyword">if</span> (<span class="hljs-variable language_">global</span>.<span class="hljs-property">RN$Bridgeless</span> !== <span class="hljs-literal">true</span>) {
  <span class="hljs-title class_">BatchedBridge</span>.<span class="hljs-title function_">registerCallableModule</span>(<span class="hljs-string">'ReactFabric'</span>, <span class="hljs-title class_">ReactFabric</span>);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">ReactFabric</span>;
</code></pre>
<p>è¿™é‡Œæ ¹æ®å¼€å‘ç¯å¢ƒé€‰æ‹©äº†ä¸åŒçš„æ¸²æŸ“å™¨ã€‚å¼€å‘ç¯å¢ƒçš„æ¸²æŸ“å™¨ä½“ç§¯æ›´å¤§ï¼ŒåŒ…å«äº†è®¸å¤šè°ƒè¯•ã€æ€§èƒ½æ—¥å¿—ç­‰ä¿¡æ¯ï¼Œè€Œç”Ÿäº§ç¯å¢ƒçš„ç§»é™¤äº†æ³¨é‡Šå’Œç©ºç™½ï¼Œå˜é‡åè¢«å‹ç¼©ä»£ç ç»è¿‡ä¼˜åŒ–ï¼Œå‡å°‘åŒ…ä½“ç§¯ã€‚</p>
<p>ç»§ç»­è·Ÿè¸ªç”Ÿäº§ç¯å¢ƒçš„æ¸²æŸ“å™¨ï¼Œå› ä¸ºä»£ç æ›´åŠ ç®€æ´ï¼Œå¯æ›´å¥½çš„èšç„¦äºè°ƒç”¨çš„é“¾è·¯å’Œæµç¨‹ã€‚æºç <code>react-native/packages/react-native/Libraries/Renderer/implementations/ReactFabric-prod.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-built_in">exports</span>.<span class="hljs-property">render</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">
  element,
  containerTag,
  callback,
  concurrentRoot,
  options
</span>) {
  <span class="hljs-keyword">var</span> root = roots.<span class="hljs-title function_">get</span>(containerTag);
  <span class="hljs-keyword">if</span> (!root) {
    <span class="hljs-comment">// åˆ›å»ºæ–°çš„FiberRootNode</span>
    <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>

    <span class="hljs-title function_">initializeUpdateQueue</span>(concurrentRoot);
    roots.<span class="hljs-title function_">set</span>(containerTag, root);
  }
  <span class="hljs-comment">// å¯åŠ¨æ¸²æŸ“ </span>
  <span class="hljs-title function_">updateContainer</span>(element, root, <span class="hljs-literal">null</span>, callback);
  <span class="hljs-comment">// è¿”å›æ¸²æŸ“åçš„å…¬å…±å®ä¾‹å¼•ç”¨</span>
  <span class="hljs-attr">a</span>: <span class="hljs-keyword">if</span> (((element = root.<span class="hljs-property">current</span>), element.<span class="hljs-property">child</span>))
    <span class="hljs-keyword">switch</span> (element.<span class="hljs-property">child</span>.<span class="hljs-property">tag</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-number">27</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
        element = <span class="hljs-title function_">getPublicInstance</span>(element.<span class="hljs-property">child</span>.<span class="hljs-property">stateNode</span>);
        <span class="hljs-keyword">break</span> a;
      <span class="hljs-attr">default</span>:
        element = element.<span class="hljs-property">child</span>.<span class="hljs-property">stateNode</span>;
    }
  <span class="hljs-keyword">else</span> element = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">return</span> element;
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">updateContainer</span>(<span class="hljs-params">element, container, parentComponent, callback</span>) {
  parentComponent = container.<span class="hljs-property">current</span>;
  <span class="hljs-comment">// / è·å–æ›´æ–°ä¼˜å…ˆçº§</span>
  <span class="hljs-keyword">var</span> lane = <span class="hljs-title function_">requestUpdateLane</span>(parentComponent);
  <span class="hljs-literal">null</span> === container.<span class="hljs-property">context</span>
    ? (container.<span class="hljs-property">context</span> = emptyContextObject)
    : (container.<span class="hljs-property">pendingContext</span> = emptyContextObject);

  <span class="hljs-comment">// åˆ›å»ºæ›´æ–°å¯¹è±¡</span>
  container = <span class="hljs-title function_">createUpdate</span>(lane);
  container.<span class="hljs-property">payload</span> = { <span class="hljs-attr">element</span>: element };
  callback = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span> === callback ? <span class="hljs-literal">null</span> : callback;
  <span class="hljs-literal">null</span> !== callback &amp;&amp; (container.<span class="hljs-property">callback</span> = callback);

  <span class="hljs-comment">// å°†æ›´æ–°åŠ å…¥é˜Ÿåˆ—</span>
  element = <span class="hljs-title function_">enqueueUpdate</span>(parentComponent, container, lane);

  <span class="hljs-comment">// è°ƒåº¦æ›´æ–°</span>
  <span class="hljs-literal">null</span> !== element &amp;&amp;
    (<span class="hljs-title function_">scheduleUpdateOnFiber</span>(element, parentComponent, lane),
    <span class="hljs-title function_">entangleTransitions</span>(element, parentComponent, lane));
  <span class="hljs-keyword">return</span> lane;
}
</code></pre>
<p>ä»¥ä¸Šè°ƒç”¨éƒ½æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œçš„æ ¸å¿ƒæ˜¯<code>scheduleUpdateOnFiber</code>æ–¹æ³•ï¼Œå®ƒè´Ÿè´£è°ƒåº¦æ›´æ–°ã€‚ç”±äºä»£ç é‡è¾ƒå¤§ï¼Œæˆ‘ä»¬åé¢åªè¿½æ±‚æ ¸å¿ƒé€»è¾‘ï¼Œå°†çœç•¥å¤§éƒ¨åˆ†ä»£ç ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">scheduleUpdateOnFiber</span>(<span class="hljs-params">root, fiber, lane</span>) {
  <span class="hljs-comment">// çœç•¥......</span>

  <span class="hljs-comment">// æ ‡è®°æ›´æ–°å¹¶è§¦å‘è°ƒåº¦</span>
  <span class="hljs-title function_">markRootUpdated$1</span>(root, lane);
  <span class="hljs-keyword">if</span> (<span class="hljs-comment">/* ä¸åœ¨æ¸²æŸ“ä¸­ */</span>) {
      <span class="hljs-title function_">ensureRootIsScheduled</span>(root);                    <span class="hljs-comment">// ç¡®ä¿æ ¹èŠ‚ç‚¹è¢«è°ƒåº¦</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-comment">/* åŒæ­¥æ›´æ–° */</span>) {
        <span class="hljs-title function_">flushSyncWorkAcrossRoots_impl</span>(<span class="hljs-number">0</span>, !<span class="hljs-number">0</span>);         <span class="hljs-comment">// ç«‹å³æ‰§è¡ŒåŒæ­¥å·¥ä½œ</span>
      }
   }
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">flushSyncWorkAcrossRoots_impl</span>(<span class="hljs-params">syncTransitionLanes, onlyLegacy</span>) {
  <span class="hljs-keyword">if</span> (!isFlushingWork &amp;&amp; mightHavePendingSyncWork) {
    isFlushingWork = !<span class="hljs-number">0</span>;
    <span class="hljs-keyword">do</span> {
      <span class="hljs-keyword">var</span> didPerformSomeWork = !<span class="hljs-number">1</span>;
      <span class="hljs-comment">// éå†æ‰€æœ‰æ ¹èŠ‚ç‚¹æ‰§è¡ŒåŒæ­¥å·¥ä½œ</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> root = firstScheduledRoot; <span class="hljs-literal">null</span> !== root; ) {
        <span class="hljs-keyword">if</span> (!onlyLegacy || <span class="hljs-number">0</span> === root.<span class="hljs-property">tag</span>)
          <span class="hljs-comment">//çœç•¥......</span>
          <span class="hljs-comment">// å¸¸è§„åŒæ­¥æ›´æ–° </span>
          <span class="hljs-title function_">performSyncWorkOnRoot</span>(root, <span class="hljs-title class_">JSCompiler</span>_inline_result));

        root = root.<span class="hljs-property">next</span>;
      }
    } <span class="hljs-keyword">while</span> (didPerformSomeWork);
    isFlushingWork = !<span class="hljs-number">1</span>;
  }
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">performSyncWorkOnRoot</span>(<span class="hljs-params">root, lanes</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">flushPendingEffects</span>()) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  <span class="hljs-title function_">performWorkOnRoot</span>(root, lanes, !<span class="hljs-number">0</span>);
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">performWorkOnRoot</span>(<span class="hljs-params">root$jscomp$0, lanes, forceSync</span>) {
   <span class="hljs-comment">// é€‰æ‹©åŒæ­¥æˆ–å¹¶å‘æ¸²æŸ“</span>
   <span class="hljs-keyword">var</span> shouldTimeSlice = (!forceSync &amp;&amp; <span class="hljs-comment">/* æ¡ä»¶åˆ¤æ–­ */</span>);
   <span class="hljs-keyword">var</span> exitStatus = shouldTimeSlice
      ? <span class="hljs-title function_">renderRootConcurrent</span>(root, lanes)            <span class="hljs-comment">// å¹¶å‘æ¸²æŸ“</span>
      : <span class="hljs-title function_">renderRootSync</span>(root, lanes, !<span class="hljs-number">0</span>);             <span class="hljs-comment">// åŒæ­¥æ¸²æŸ“</span>

   <span class="hljs-comment">// çœç•¥......</span>
}
</code></pre>
<p>ç»§ç»­è¿½è¸ªåŒæ­¥æ¸²æŸ“<code>renderRootSync</code>æ–¹æ³•å®ç°ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">renderRootSync</span>(<span class="hljs-params">root, lanes, shouldYieldForPrerendering</span>) {
   <span class="hljs-comment">// çœç•¥......</span>

   <span class="hljs-comment">// åŒæ­¥å·¥ä½œå¾ªç¯</span>
   <span class="hljs-title function_">workLoopSync</span>();
   <span class="hljs-comment">// çœç•¥......</span>
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">workLoopSync</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">for</span> (; <span class="hljs-literal">null</span> !== workInProgress; ) <span class="hljs-title function_">performUnitOfWork</span>(workInProgress);
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">performUnitOfWork</span>(<span class="hljs-params">unitOfWork</span>) {
  <span class="hljs-comment">// å¤„ç†å•ä¸ªFiberèŠ‚ç‚¹</span>
  <span class="hljs-keyword">var</span> next = <span class="hljs-title function_">beginWork</span>(unitOfWork.<span class="hljs-property">alternate</span>, unitOfWork, entangledRenderLanes);
  unitOfWork.<span class="hljs-property">memoizedProps</span> = unitOfWork.<span class="hljs-property">pendingProps</span>;
  <span class="hljs-literal">null</span> === next ? <span class="hljs-title function_">completeUnitOfWork</span>(unitOfWork) : (workInProgress = next);
}


<span class="hljs-keyword">function</span> <span class="hljs-title function_">completeUnitOfWork</span>(<span class="hljs-params">unitOfWork</span>) {
  <span class="hljs-keyword">var</span> completedWork = unitOfWork;
  <span class="hljs-keyword">do</span> {
    <span class="hljs-comment">// çœç•¥......</span>
    unitOfWork = completedWork.<span class="hljs-property">return</span>;
    <span class="hljs-keyword">var</span> next = <span class="hljs-title function_">completeWork</span>(
      completedWork.<span class="hljs-property">alternate</span>,
      completedWork,
      entangledRenderLanes
    );
    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> !== next) {
      workInProgress = next;
      <span class="hljs-keyword">return</span>;
    }
    completedWork = completedWork.<span class="hljs-property">sibling</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> !== completedWork) {
      workInProgress = completedWork;
      <span class="hljs-keyword">return</span>;
    }
    workInProgress = completedWork = unitOfWork;
  } <span class="hljs-keyword">while</span> (<span class="hljs-literal">null</span> !== completedWork);
  <span class="hljs-number">0</span> === workInProgressRootExitStatus &amp;&amp; (workInProgressRootExitStatus = <span class="hljs-number">5</span>);
}
</code></pre>
<p>æœ€ç»ˆæ˜¯è°ƒç”¨çš„<code>completeWork</code>æ–¹æ³•å®Œæˆæ¸²æŸ“å·¥ä½œï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">completeWork</span>(<span class="hljs-params">current, workInProgress, renderLanes</span>) {
  <span class="hljs-keyword">var</span> newProps = workInProgress.<span class="hljs-property">pendingProps</span>;
  <span class="hljs-keyword">switch</span> (workInProgress.<span class="hljs-property">tag</span>) {
    <span class="hljs-keyword">case</span> <span class="hljs-number">28</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">16</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">15</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">11</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">12</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">14</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">bubbleProperties</span>(workInProgress), <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">bubbleProperties</span>(workInProgress), <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
      <span class="hljs-comment">// çœç•¥......</span>
      <span class="hljs-comment">// return  </span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">26</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">27</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
      <span class="hljs-title function_">popHostContext</span>(workInProgress);
      <span class="hljs-keyword">var</span> type = workInProgress.<span class="hljs-property">type</span>;
      <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> !== current &amp;&amp; <span class="hljs-literal">null</span> != workInProgress.<span class="hljs-property">stateNode</span>)
        <span class="hljs-comment">// çœç•¥......</span>
      <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// é¦–æ¬¡æŒ‚è½½</span>
        <span class="hljs-keyword">if</span> (!newProps) {  
          <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> === workInProgress.<span class="hljs-property">stateNode</span>)
            <span class="hljs-keyword">throw</span> <span class="hljs-title class_">Error</span>(
              <span class="hljs-string">"We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue."</span>
            );
          <span class="hljs-title function_">bubbleProperties</span>(workInProgress);
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
        current = rootInstanceStackCursor.<span class="hljs-property">current</span>;
        renderLanes = nextReactTag;
        nextReactTag += <span class="hljs-number">2</span>;
        <span class="hljs-comment">// è·å–ViewConfig</span>
        type = <span class="hljs-title function_">getViewConfigForType</span>(type);
        <span class="hljs-keyword">var</span> updatePayload = <span class="hljs-title class_">ReactNativePrivateInterface</span>.<span class="hljs-title function_">createAttributePayload</span>(
          newProps,
          type.<span class="hljs-property">validAttributes</span>
        );
        <span class="hljs-comment">// åˆ›å»ºåŸç”ŸèŠ‚ç‚¹</span>
        current = {
          <span class="hljs-attr">node</span>: <span class="hljs-title function_">createNode</span>(
            renderLanes,
            type.<span class="hljs-property">uiViewClassName</span>,  <span class="hljs-comment">//  ä½¿ç”¨ViewConfigä¸­çš„åŸç”Ÿç±»å</span>
            current.<span class="hljs-property">containerTag</span>,
            updatePayload,
            workInProgress
          ),
          <span class="hljs-attr">canonical</span>: {
            <span class="hljs-attr">nativeTag</span>: renderLanes,
            <span class="hljs-attr">viewConfig</span>: type,       <span class="hljs-comment">// ä¿å­˜ViewConfigå¼•ç”¨</span>
            <span class="hljs-attr">currentProps</span>: newProps,
            <span class="hljs-attr">internalInstanceHandle</span>: workInProgress,
            <span class="hljs-attr">publicInstance</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">publicRootInstance</span>: current.<span class="hljs-property">publicInstance</span>
          }
        };
        workInProgress.<span class="hljs-property">flags</span> |= <span class="hljs-number">8</span>;
        <span class="hljs-title function_">appendAllChildren</span>(current, workInProgress, !<span class="hljs-number">1</span>, !<span class="hljs-number">1</span>);
        workInProgress.<span class="hljs-property">stateNode</span> = current;
      }
      <span class="hljs-title function_">bubbleProperties</span>(workInProgress);
      workInProgress.<span class="hljs-property">flags</span> &amp;= -<span class="hljs-number">16777217</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>
  }
}
</code></pre>
<p>æ­¤æ–¹æ³•ä¸­çš„<code>case</code>éƒ½æ˜¯æ•´æ•°ï¼Œä¸ºäº†å¼„æ¸…æ¥šå…¶å«ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹React ä»“åº“ä¸­çš„<strong>Tag</strong>å®šä¹‰ã€‚æºç ä½äº <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Freact%2Fblob%2Fmain%2Fpackages%2Freact-reconciler%2Fsrc%2FReactWorkTags.js" target="_blank" title="https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactWorkTags.js" ref="nofollow noopener noreferrer">ReactWorkTags.js</a>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">FunctionComponent</span> = <span class="hljs-number">0</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">ClassComponent</span> = <span class="hljs-number">1</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">HostRoot</span> = <span class="hljs-number">3</span>; <span class="hljs-comment">// å®¿ä¸»æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚å®ƒå¯ä»¥åµŒå¥—åœ¨å¦ä¸€ä¸ªèŠ‚ç‚¹å†…éƒ¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">HostPortal</span> = <span class="hljs-number">4</span>; <span class="hljs-comment">// ä¸€ä¸ªå­æ ‘ã€‚å®ƒå¯ä»¥æ˜¯é€šå¾€ä¸åŒæ¸²æŸ“å™¨çš„å…¥å£ç‚¹</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">HostComponent</span> = <span class="hljs-number">5</span>;
<span class="hljs-comment">// çœç•¥......</span>
</code></pre>
<p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹çš„æ˜¯React Nativeçš„Tagç±»å‹ï¼Œä¹Ÿå°±æ˜¯<code>HostComponent</code>ï¼Œå®ƒçš„å€¼æ˜¯5ï¼Œå› æ­¤å¯¹åº”åˆ°<code>completeWork</code>ä¸­çš„å¤„ç†ä»£ç å°±æ˜¯æˆ‘æˆªå–çš„è¿™éƒ¨åˆ†ã€‚è¿™æ®µä»£ç ä¸­æœ‰ä¸€ä¸ªå…³é”®çš„æ–¹æ³•ï¼Œå°±æ˜¯<code>getViewConfigForType</code>ï¼ŒæŸ¥çœ‹å…¶å®šä¹‰ï¼Œæ˜¾ç¤ºä¸º<code>getViewConfigForType = ReactNativePrivateInterface.ReactNativeViewConfigRegistry.get</code></p>
<p>å¯çœ‹åˆ°ï¼Œè¿™é‡Œå°±å®Œå…¨ä¸å‰é¢<strong>å£°æ˜ç»„ä»¶</strong>ä¸€èŠ‚æœ€ååˆ†æåˆ°çš„<code>ReactNativeViewConfigRegistry.js</code>å¯¹åº”ä¸Šäº†ï¼Œæˆ‘ä»¬å‰é¢åˆ†æçš„æ˜¯ViewConfigçš„æ³¨å†Œï¼Œç°åœ¨æ¥çœ‹ä¸€ä¸‹<code>get</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
 * è·å–æŒ‡å®šè§†å›¾çš„é…ç½®ã€‚å¦‚æœè¿™æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨è¯¥è§†å›¾ï¼Œæ­¤é…ç½®å°†ä»UIManagerå»¶è¿ŸåŠ è½½
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">name: string</span>): <span class="hljs-title class_">ViewConfig</span> {
  <span class="hljs-comment">// ä»viewConfigs Mapä¸­æŸ¥æ‰¾å·²ç¼“å­˜çš„ViewConfig</span>
  <span class="hljs-keyword">let</span> viewConfig = viewConfigs.<span class="hljs-title function_">get</span>(name);
  <span class="hljs-keyword">if</span> (viewConfig == <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// è·å–è¯¥ç»„ä»¶çš„é…ç½®ç”Ÿæˆå›è°ƒå‡½æ•°</span>
    <span class="hljs-keyword">const</span> callback = viewConfigCallbacks.<span class="hljs-title function_">get</span>(name);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> callback !== <span class="hljs-string">'function'</span>) {
      <span class="hljs-comment">// çœç•¥æ—¥å¿—......</span>
    }
    viewConfig = <span class="hljs-title function_">callback</span>();
    <span class="hljs-title function_">invariant</span>(viewConfig, <span class="hljs-string">'View config not found for component `%s`'</span>, name);

    <span class="hljs-title function_">processEventTypes</span>(viewConfig);
    viewConfigs.<span class="hljs-title function_">set</span>(name, viewConfig);

    <span class="hljs-comment">// é…ç½®è®¾ç½®åæ¸…é™¤å›è°ƒï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ä¼šåœ¨æ³¨å†Œè¿‡ç¨‹ä¸­æ©ç›–ä»»ä½•é”™è¯¯ã€‚</span>
    viewConfigCallbacks.<span class="hljs-title function_">set</span>(name, <span class="hljs-literal">null</span>);
  }
  <span class="hljs-keyword">return</span> viewConfig;
}
</code></pre>
<p>é€šè¿‡<strong>ViewConfig</strong>ï¼Œå¯ä»¥å¾—åˆ°<code>uiViewClassName</code>ï¼Œä¹Ÿå°±æ˜¯å£°æ˜çš„ç»„ä»¶åç§°ï¼Œæˆ‘ä»¬ç»§ç»­æŸ¥çœ‹åŸç”ŸèŠ‚ç‚¹åˆ›å»ºçš„æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">var</span> _nativeFabricUIManage = nativeFabricUIManager,
  createNode = _nativeFabricUIManage.<span class="hljs-property">createNode</span>,          


 <span class="hljs-title function_">createNode</span>(
   renderLanes,
   type.<span class="hljs-property">uiViewClassName</span>,  <span class="hljs-comment">//  ä½¿ç”¨ViewConfigä¸­çš„åŸç”Ÿç±»å</span>
   current.<span class="hljs-property">containerTag</span>,
   updatePayload,
   workInProgress
 )
</code></pre>
<p><code>createNode</code>æ–¹æ³•æ¥è‡ªäºå…¨å±€å¯¹è±¡<code>nativeFabricUIManager</code>ï¼Œé€šè¿‡å˜é‡åå°±çŸ¥é“ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯æ¥è‡ªäºJSIå®šä¹‰çš„å¯¹è±¡ï¼Œä»£ç ä¸åœ¨JSå±‚ã€‚</p>
<h5 data-id="heading-5">C++ å±‚</h5>
<p>ç»§ç»­åœ¨C++ä¸­æœç´¢<code>nativeFabricUIManager</code>ï¼Œå®šä½åˆ°æºç <code>react-native/packages/react-native/ReactCommon/react/renderer/uimanager/UIManagerBinding.cpp</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">void</span> <span class="hljs-title class_">UIManagerBinding</span>::<span class="hljs-title function_">createAndInstallIfNeeded</span>(<span class="hljs-params">
    jsi::Runtime&amp; runtime,
    <span class="hljs-keyword">const</span> std::shared_ptr&lt;UIManager&gt;&amp; uiManager</span>) {
  auto uiManagerModuleName = <span class="hljs-string">"nativeFabricUIManager"</span>;

  auto uiManagerValue =
      runtime.<span class="hljs-title function_">global</span>().<span class="hljs-title function_">getProperty</span>(runtime, uiManagerModuleName);
  <span class="hljs-keyword">if</span> (uiManagerValue.<span class="hljs-title function_">isUndefined</span>()) {
    <span class="hljs-comment">// å…¨å±€å‘½åç©ºé—´ä¸­æ²¡æœ‰è¯¥ç»‘å®šçš„å®ä¾‹ï¼›æˆ‘ä»¬éœ€è¦åˆ›å»ºã€å®‰è£…å¹¶è¿”å›å®ƒ</span>
    auto uiManagerBinding = <span class="hljs-attr">std</span>::make_shared&lt;<span class="hljs-title class_">UIManagerBinding</span>&gt;(uiManager);
    auto object = <span class="hljs-attr">jsi</span>::<span class="hljs-title class_">Object</span>::<span class="hljs-title function_">createFromHostObject</span>(runtime, uiManagerBinding);
    runtime.<span class="hljs-title function_">global</span>().<span class="hljs-title function_">setProperty</span>(
        runtime, uiManagerModuleName, <span class="hljs-attr">std</span>::<span class="hljs-title function_">move</span>(object));
  }
}
</code></pre>
<p>å¯è§è¿™é‡Œçš„<code>nativeFabricUIManager</code>æ˜¯ä¸€ä¸ª<code>jsi::HostObject</code>å¯¹è±¡ï¼Œæˆ‘ä»¬è¦æŸ¥æ‰¾å…¶<code>createNode</code>æ–¹æ³•ï¼Œç›´æ¥æŸ¥çœ‹<strong>UIManagerBinding</strong>çš„<code>get</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">jsi::Value <span class="hljs-title">UIManagerBinding::get</span><span class="hljs-params">(
    jsi::Runtime&amp; runtime,
    <span class="hljs-type">const</span> jsi::PropNameID&amp; name)</span> </span>{
  <span class="hljs-keyword">auto</span> methodName = name.<span class="hljs-built_in">utf8</span>(runtime);

  <span class="hljs-comment">// å°† shared_ptr&lt;UIManager&gt; è½¬æ¢ä¸ºåŸå§‹æŒ‡é’ˆ</span>
  <span class="hljs-comment">// ä¸ºä»€ä¹ˆè¿™æ ·åšï¼ŸåŸå› å¦‚ä¸‹ï¼š</span>
  <span class="hljs-comment">// 1) UIManagerBinding å¼ºå¼•ç”¨ï¼ˆstrongly retainsï¼‰UIManagerã€‚</span>
  <span class="hljs-comment">//    JS VM é€šè¿‡ JSI å¼ºå¼•ç”¨ UIManagerBindingã€‚</span>
  <span class="hljs-comment">//    è¿™äº›å‡½æ•°æ˜¯ JSI å‡½æ•°ï¼Œåªèƒ½é€šè¿‡ JS VM è°ƒç”¨ï¼›å¦‚æœ JS VM è¢«é”€æ¯ï¼Œ</span>
  <span class="hljs-comment">//    è¿™äº›å‡½æ•°æ— æ³•æ‰§è¡Œï¼Œè¿™äº› lambda ä¹Ÿä¸ä¼šæ‰§è¡Œã€‚</span>
  <span class="hljs-comment">// 2) UIManager åªæœ‰åœ¨æ‰€æœ‰å¯¹å®ƒçš„å¼•ç”¨éƒ½è¢«é‡Šæ”¾åæ‰ä¼šè¢«ææ„ï¼ŒåŒ…æ‹¬</span>
  <span class="hljs-comment">//    UIManagerBindingã€‚è¿™åªæœ‰åœ¨ JS VM è¢«ææ„æ—¶æ‰ä¼šå‘ç”Ÿã€‚å› æ­¤ï¼ŒåŸå§‹æŒ‡é’ˆæ˜¯å®‰å…¨çš„ã€‚</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// å³ä½¿è¿™æ ·åšæ˜¯å®‰å…¨çš„ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨ shared_ptr ä½œä¸ºé¢å¤–çš„ä¿é™©å‘¢ï¼Ÿ</span>
  <span class="hljs-comment">// 1) åœ¨ä¸éœ€è¦çš„æƒ…å†µä¸‹ä½¿ç”¨ shared_ptr æˆ– weak_ptr</span>
  <span class="hljs-comment">// æ˜¯ä¸€ç§æ€§èƒ½åŠ£åŒ–ï¼ˆpessimisationï¼‰ã€‚</span>
  <span class="hljs-comment">//    åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¼šæ‰§è¡Œæ›´å¤šæŒ‡ä»¤ï¼Œä½†ä¸ä¼šå¸¦æ¥ä»»ä½•é¢å¤–ä»·å€¼ã€‚</span>
  <span class="hljs-comment">// 2) è¿™äº› lambda çš„ç¡®åˆ‡é‡Šæ”¾æ—¶æœºå’Œæ–¹å¼å¾ˆå¤æ‚ã€‚å‘å®ƒä»¬æ·»åŠ  shared_ptr ä¼šå¯¼è‡´</span>
  <span class="hljs-comment">//    UIManager å¯èƒ½å­˜æ´»æ›´é•¿æ—¶é—´ï¼Œè¿™æ˜¯ä¸å¿…è¦çš„ã€å¤æ‚çš„è®¤çŸ¥è´Ÿæ‹…ã€‚</span>
  <span class="hljs-comment">// 3) æœ‰å¼ºçƒˆæ€€ç–‘è®¤ä¸ºï¼Œä»è¿™äº› C++ lambda ä¸­ä¿ç•™ UIManagerï¼ˆè¿™äº› lambda è¢«</span>
  <span class="hljs-comment">//    JSI æŒæœ‰çš„å¯¹è±¡æ‰€ä¿ç•™ï¼‰ï¼Œåœ¨ Scheduler å’Œ JS VM ææ„æ—¶å¯¼è‡´äº†ä¸€äº›å´©æºƒã€‚</span>
  <span class="hljs-comment">//    å¦‚æœ C++ è¯­ä¹‰å¯¼è‡´è¿™äº› lambda åœ¨ JS VM è¢«ææ„åä¸€ä¸ª CPU</span>
  <span class="hljs-comment">//    æ—¶é’Ÿå‘¨æœŸï¼ˆæˆ–æ›´ä¹…ï¼‰ æ‰è¢«é‡Šæ”¾ï¼Œå°±å¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µã€‚</span>
  UIManager* uiManager = uiManager_.<span class="hljs-built_in">get</span>();

  <span class="hljs-comment">// Semantic: Creates a new node with given pieces.</span>
  <span class="hljs-keyword">if</span> (methodName == <span class="hljs-string">"createNode"</span>) {
    <span class="hljs-keyword">auto</span> paramCount = <span class="hljs-number">5</span>;
    <span class="hljs-keyword">return</span> jsi::Function::<span class="hljs-built_in">createFromHostFunction</span>(
        runtime,
        name,
        paramCount,
        [uiManager, methodName, paramCount](
            jsi::Runtime&amp; runtime,
            <span class="hljs-type">const</span> jsi::Value&amp; <span class="hljs-comment">/*thisValue*/</span>,
            <span class="hljs-type">const</span> jsi::Value* arguments,
            <span class="hljs-type">size_t</span> count) -&gt; jsi::Value {
          <span class="hljs-keyword">try</span> {
            <span class="hljs-built_in">validateArgumentCount</span>(runtime, methodName, paramCount, count);

            <span class="hljs-keyword">auto</span> instanceHandle =
                <span class="hljs-built_in">instanceHandleFromValue</span>(runtime, arguments[<span class="hljs-number">4</span>], arguments[<span class="hljs-number">0</span>]);
            <span class="hljs-keyword">if</span> (!instanceHandle) {
              <span class="hljs-built_in">react_native_assert</span>(<span class="hljs-literal">false</span>);
              <span class="hljs-keyword">return</span> jsi::Value::<span class="hljs-built_in">undefined</span>();
            }

            <span class="hljs-keyword">return</span> <span class="hljs-built_in">valueFromShadowNode</span>(
                runtime,
                uiManager-&gt;<span class="hljs-built_in">createNode</span>(
                    <span class="hljs-built_in">tagFromValue</span>(arguments[<span class="hljs-number">0</span>]),
                    <span class="hljs-built_in">stringFromValue</span>(runtime, arguments[<span class="hljs-number">1</span>]),
                    <span class="hljs-built_in">surfaceIdFromValue</span>(runtime, arguments[<span class="hljs-number">2</span>]),
                    <span class="hljs-built_in">RawProps</span>(runtime, arguments[<span class="hljs-number">3</span>]),
                    std::<span class="hljs-built_in">move</span>(instanceHandle)),
                <span class="hljs-literal">true</span>);
          } <span class="hljs-built_in">catch</span> (<span class="hljs-type">const</span> std::logic_error&amp; ex) {
            <span class="hljs-built_in">LOG</span>(FATAL) &lt;&lt; <span class="hljs-string">"logic_error in createNode: "</span> &lt;&lt; ex.<span class="hljs-built_in">what</span>();
          }
        });
  }
  <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>

  <span class="hljs-keyword">return</span> jsi::Value::<span class="hljs-built_in">undefined</span>();
}
</code></pre>
<p>ç»§ç»­è·Ÿè¸ª<code>react-native/packages/react-native/ReactCommon/react/renderer/uimanager/UIManager.cpp</code>ä¸­çš„<code>createNode</code>å®ç°ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-function">std::shared_ptr&lt;ShadowNode&gt; <span class="hljs-title">UIManager::createNode</span><span class="hljs-params">(
    Tag tag,                  <span class="hljs-comment">// èŠ‚ç‚¹æ ‡ç­¾</span>
    <span class="hljs-type">const</span> std::string&amp; name,  <span class="hljs-comment">// ç»„ä»¶åç§°</span>
    SurfaceId surfaceId,
    RawProps rawProps,        <span class="hljs-comment">// åŸå§‹å±æ€§</span>
    InstanceHandle::Shared instanceHandle)</span> <span class="hljs-type">const</span> </span>{
  <span class="hljs-function">TraceSection <span class="hljs-title">s</span><span class="hljs-params">(<span class="hljs-string">"UIManager::createNode"</span>, <span class="hljs-string">"componentName"</span>, name)</span></span>;

  <span class="hljs-comment">// æ ¹æ®ç»„ä»¶åç§°è·å–å¯¹åº”çš„ComponentDescriptor</span>
  <span class="hljs-keyword">auto</span>&amp; componentDescriptor = componentDescriptorRegistry_-&gt;<span class="hljs-built_in">at</span>(name);
  <span class="hljs-keyword">auto</span> fallbackDescriptor =
      componentDescriptorRegistry_-&gt;<span class="hljs-built_in">getFallbackComponentDescriptor</span>();

  PropsParserContext propsParserContext{surfaceId, *contextContainer_};

  <span class="hljs-comment">// åˆ›å»ºShadowNodeFamilyï¼Œç”¨äºç®¡ç†åŒä¸€ç»„ä»¶çš„ä¸åŒå®ä¾‹</span>
  <span class="hljs-keyword">auto</span> family = componentDescriptor.<span class="hljs-built_in">createFamily</span>(
      {.tag = tag,
       .surfaceId = surfaceId,
       .instanceHandle = std::<span class="hljs-built_in">move</span>(instanceHandle)});

  <span class="hljs-comment">// è§£æå’Œå…‹éš†å±æ€§</span>
  <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> props = componentDescriptor.<span class="hljs-built_in">cloneProps</span>(
      propsParserContext, <span class="hljs-literal">nullptr</span>, std::<span class="hljs-built_in">move</span>(rawProps));
  <span class="hljs-comment">// åˆ›å»ºåˆå§‹çŠ¶æ€</span>
  <span class="hljs-type">const</span> <span class="hljs-keyword">auto</span> state = componentDescriptor.<span class="hljs-built_in">createInitialState</span>(props, family);

  <span class="hljs-comment">// åˆ›å»ºShadowNode</span>
  <span class="hljs-keyword">auto</span> shadowNode = componentDescriptor.<span class="hljs-built_in">createShadowNode</span>(
      ShadowNodeFragment{
          .props = fallbackDescriptor != <span class="hljs-literal">nullptr</span> &amp;&amp;
                  fallbackDescriptor-&gt;<span class="hljs-built_in">getComponentHandle</span>() ==
                      componentDescriptor.<span class="hljs-built_in">getComponentHandle</span>()
              ? componentDescriptor.<span class="hljs-built_in">cloneProps</span>(
                    propsParserContext,
                    props,
                    <span class="hljs-built_in">RawProps</span>(folly::dynamic::<span class="hljs-built_in">object</span>(<span class="hljs-string">"name"</span>, name)))
              : props,
          .children = ShadowNodeFragment::<span class="hljs-built_in">childrenPlaceholder</span>(),
          .state = state,
      },
      family);

  <span class="hljs-keyword">if</span> (delegate_ != <span class="hljs-literal">nullptr</span>) {
    delegate_-&gt;<span class="hljs-built_in">uiManagerDidCreateShadowNode</span>(*shadowNode);
  }
  <span class="hljs-keyword">if</span> (leakChecker_) {
    leakChecker_-&gt;<span class="hljs-built_in">uiManagerDidCreateShadowNodeFamily</span>(family);
  }

  <span class="hljs-keyword">return</span> shadowNode;
}
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œé€šè¿‡<code>componentDescriptorRegistry_</code>æ¥æŸ¥æ‰¾Fabric ç»„ä»¶æè¿°å¯¹è±¡ï¼Œè‡³äºæ³¨å†Œçš„åœ°æ–¹ï¼Œä¸‹ä¸€èŠ‚<strong>æ³¨å†Œç»„ä»¶</strong>ä¼šä¸“é—¨åˆ†æã€‚</p>
<p>è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œ<code>createShadowNode</code>æ–¹æ³•åªæ˜¯åˆ›å»ºäº†è™šæ‹Ÿçš„<strong>ShadowNode</strong>ï¼Œå¹¶æ²¡æœ‰åˆ›å»ºçœŸæ­£çš„åŸç”Ÿè§†å›¾ã€‚ShadowNodeæ˜¯Fabricä¸­çš„è™šæ‹ŸDOMèŠ‚ç‚¹ï¼Œç”¨äºå¸ƒå±€è®¡ç®—ã€‚ä¹Ÿå°±æ˜¯è¯´å½“å®Œæˆå¸ƒå±€å’Œdiffè®¡ç®—åï¼Œä¼šç”ŸæˆMountItemæŒ‡ä»¤ã€‚</p>
<h5 data-id="heading-6">Kotlinå±‚</h5>
<p>åœ¨å‰é¢<strong>å¯åŠ¨æ¸²æŸ“</strong>ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æœ‰åˆ†æåˆ°<code>createViewUnsafe</code>æ–¹æ³•ï¼Œå›é¡¾ä¸€ä¸‹å®‰å“åŸç”Ÿç»„ä»¶çš„æŸ¥æ‰¾ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">ViewManager viewManager = mViewManagerRegistry.<span class="hljs-keyword">get</span>(componentName);
</code></pre>
<p>è·Ÿè¸ªæºç <code>react-native/packages/react-native/ReactAndroid/src/main/java/com/facebook/react/uimanager/ViewManagerRegistry.kt</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">  <span class="hljs-meta">@Synchronized</span>
  <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">get</span><span class="hljs-params">(className: <span class="hljs-type">String</span>)</span></span>: ViewManager&lt;*, *&gt; {
    <span class="hljs-comment">// 1. Try to get the manager without the prefix.</span>
    viewManagersMap[className]?.let {
      <span class="hljs-keyword">return</span> it
    }

    <span class="hljs-comment">// 2. Try to get the manager with the RCT prefix.</span>
    <span class="hljs-keyword">val</span> rctViewManagerName = <span class="hljs-string">"RCT<span class="hljs-variable">$className</span>"</span>
    viewManagersMap[rctViewManagerName]?.let {
      <span class="hljs-keyword">return</span> it
    }

    <span class="hljs-keyword">if</span> (viewManagerResolver != <span class="hljs-literal">null</span>) {

      <span class="hljs-comment">// 1. Try to get the manager without the prefix.</span>
      <span class="hljs-keyword">val</span> resolvedManager = getViewManagerFromResolver(className)
      <span class="hljs-keyword">if</span> (resolvedManager != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> resolvedManager
      }

      <span class="hljs-comment">// 2. Try to get the manager with the RCT prefix.</span>
      <span class="hljs-keyword">val</span> rctResolvedManager = getViewManagerFromResolver(rctViewManagerName)
      <span class="hljs-keyword">if</span> (rctResolvedManager != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> rctResolvedManager
      }

      <span class="hljs-keyword">throw</span> IllegalViewOperationException(
          <span class="hljs-string">"Can't find ViewManager '<span class="hljs-variable">$className</span>' nor '<span class="hljs-variable">$rctViewManagerName</span>' in ViewManagerRegistry, "</span> +
              <span class="hljs-string">"existing names are: <span class="hljs-subst">${viewManagerResolver.getViewManagerNames()}</span>"</span>
      )
    }

    <span class="hljs-keyword">throw</span> IllegalViewOperationException(<span class="hljs-string">"No ViewManager found for class <span class="hljs-variable">$className</span>"</span>)
  }

  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getViewManagerFromResolver</span><span class="hljs-params">(className: <span class="hljs-type">String</span>)</span></span>: ViewManager&lt;*, *&gt;? {
    <span class="hljs-keyword">val</span> viewManager = viewManagerResolver?.getViewManager(className)
    <span class="hljs-keyword">if</span> (viewManager != <span class="hljs-literal">null</span>) {
      viewManagersMap[className] = viewManager
    }
    <span class="hljs-keyword">return</span> viewManager
  }
</code></pre>
<p>æ–°æ¶æ„çš„æƒ…å†µä¸‹ï¼Œæ˜¯é€šè¿‡<code>getViewManagerFromResolver</code>æ–¹æ³•æ¥æŸ¥æ‰¾ï¼Œå…¶ä¸­<code>viewManagerResolver</code>çš„ç±»å‹æ˜¯<code>BridgelessViewManagerResolver</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œå®šä¹‰åœ¨<code>ReactInstance.kt</code>æ–‡ä»¶ä¸­ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BridgelessViewManagerResolver</span>(
      <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> reactPackages: List&lt;ReactPackage&gt;,
      <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> context: BridgelessReactContext,
  ) : ViewManagerResolver {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> lazyViewManagerMap: MutableMap&lt;String, ViewManager&lt;*, *&gt;&gt; = HashMap()

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getViewManager</span><span class="hljs-params">(viewManagerName: <span class="hljs-type">String</span>)</span></span>: ViewManager&lt;*, *&gt;? {
      <span class="hljs-comment">// ä»æ‡’åŠ è½½åŒ…ä¸­æŸ¥æ‰¾</span>
      <span class="hljs-keyword">val</span> viewManager = getLazyViewManager(viewManagerName)
      <span class="hljs-keyword">if</span> (viewManager != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span> viewManager
      }
      <span class="hljs-comment">// å¦‚æœé€šè¿‡å»¶è¿ŸåŠ è½½åœ¨æ‰€æœ‰ React åŒ…ä¸­éƒ½æ‰¾ä¸åˆ°è§†å›¾ç®¡ç†å™¨ï¼Œåˆ™å›é€€åˆ°é»˜è®¤å®ç°ï¼šç«‹å³åˆå§‹åŒ–æ‰€æœ‰è§†å›¾ç®¡ç†å™¨</span>
      <span class="hljs-keyword">return</span> eagerViewManagerMap[viewManagerName]
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">lateinit</span> <span class="hljs-keyword">var</span> _eagerViewManagerMap: Map&lt;String, ViewManager&lt;*, *&gt;&gt;

    <span class="hljs-meta">@get:Synchronized</span>
    <span class="hljs-keyword">val</span> eagerViewManagerMap: Map&lt;String, ViewManager&lt;*, *&gt;&gt;
      <span class="hljs-keyword">get</span>() {
        <span class="hljs-keyword">if</span> (::_eagerViewManagerMap.isInitialized) {
          <span class="hljs-keyword">return</span> _eagerViewManagerMap
        }

        <span class="hljs-keyword">val</span> viewManagerMap: MutableMap&lt;String, ViewManager&lt;*, *&gt;&gt; = HashMap()
        <span class="hljs-keyword">for</span> (reactPackage <span class="hljs-keyword">in</span> reactPackages) {
          <span class="hljs-keyword">if</span> (reactPackage <span class="hljs-keyword">is</span> ViewManagerOnDemandReactPackage) {
            <span class="hljs-keyword">continue</span>
          }

          <span class="hljs-keyword">val</span> viewManagersInPackage = reactPackage.createViewManagers(context)
          <span class="hljs-keyword">for</span> (viewManager <span class="hljs-keyword">in</span> viewManagersInPackage) {
            <span class="hljs-comment">// TODO(T173624687): Should we throw/warn when the same view manager name is registered</span>
            <span class="hljs-comment">// twice?</span>
            viewManagerMap[viewManager.name] = viewManager
          }
        }

        _eagerViewManagerMap = viewManagerMap
        <span class="hljs-keyword">return</span> viewManagerMap
      }

    <span class="hljs-meta">@Synchronized</span>
    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">getLazyViewManager</span><span class="hljs-params">(viewManagerName: <span class="hljs-type">String</span>)</span></span>: ViewManager&lt;*, *&gt;? {
      <span class="hljs-comment">// å…ˆæŸ¥ç¼“å­˜ </span>
      <span class="hljs-keyword">if</span> (lazyViewManagerMap.containsKey(viewManagerName)) {
        <span class="hljs-keyword">return</span> lazyViewManagerMap[viewManagerName]
      }

      <span class="hljs-comment">// ç¼“å­˜æœªå‘½ä¸­åˆ™éå†æ‰€æœ‰ reactPackagesï¼Œè°ƒç”¨ createViewManager(name) åˆ›å»º</span>
      <span class="hljs-keyword">for</span> (reactPackage <span class="hljs-keyword">in</span> reactPackages) {
        <span class="hljs-keyword">if</span> (reactPackage <span class="hljs-keyword">is</span> ViewManagerOnDemandReactPackage) {
          <span class="hljs-keyword">val</span> viewManager = reactPackage.createViewManager(context, viewManagerName)
          <span class="hljs-keyword">if</span> (viewManager != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// TODO(T173624687): Should we throw/warn when the same view manager name is registered</span>
            <span class="hljs-comment">// twice?</span>
            lazyViewManagerMap[viewManagerName] = viewManager
            <span class="hljs-keyword">return</span> viewManager
          }
        }
      }

      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    }

    <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>
  }
</code></pre>
<h4 data-id="heading-7">æ³¨å†Œç»„ä»¶</h4>
<h5 data-id="heading-8">JSå·¥å…·</h5>
<p>React Nativeæ–°æ¶æ„ä½¿ç”¨äº†å¾ˆå¤šä»£ç ç”Ÿæˆå·¥å…·ï¼Œä»¥è‡´äºæˆäº†é»‘ç®±æ“ä½œï¼Œè¿™å¯¹äºTurbo Moduleå’ŒFabricç»„ä»¶çš„æ³¨å†Œæµç¨‹é€ æˆäº†ç†è§£ä¸Šçš„å›°éš¾ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä¸å¾—ä¸ç ”ç©¶è¿™äº›CLIå·¥å…·ã€‚é¦–å…ˆç ”ç©¶<code>@react-native-community/cli</code>å·¥å…·ï¼Œæºç  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Freact-native-community%2Fcli" target="_blank" title="https://github.com/react-native-community/cli" ref="nofollow noopener noreferrer">cli</a>ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯<code>v20.0.2</code>ã€‚</p>
<p>æŸ¥çœ‹æºç <code>cli/packages/cli-config-android/src/config/index.ts</code>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">dependencyConfig</span>(<span class="hljs-params">
  root: <span class="hljs-built_in">string</span>,
  userConfig: AndroidDependencyParams | <span class="hljs-literal">null</span> = {},
</span>): <span class="hljs-title class_">AndroidDependencyConfig</span> | <span class="hljs-literal">null</span> {
  <span class="hljs-keyword">if</span> (userConfig === <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">const</span> src = userConfig.<span class="hljs-property">sourceDir</span> || <span class="hljs-title function_">findAndroidDir</span>(root);

  <span class="hljs-keyword">if</span> (!src) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">const</span> sourceDir = path.<span class="hljs-title function_">join</span>(root, src);
  <span class="hljs-keyword">const</span> manifestPath = userConfig.<span class="hljs-property">manifestPath</span>
    ? path.<span class="hljs-title function_">join</span>(sourceDir, userConfig.<span class="hljs-property">manifestPath</span>)
    : <span class="hljs-title function_">findManifest</span>(sourceDir);
  <span class="hljs-keyword">const</span> buildGradlePath = <span class="hljs-title function_">findBuildGradle</span>(sourceDir, <span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> isPureCxxDependency =
    userConfig.<span class="hljs-property">cxxModuleCMakeListsModuleName</span> != <span class="hljs-literal">null</span> &amp;&amp;
    userConfig.<span class="hljs-property">cxxModuleCMakeListsPath</span> != <span class="hljs-literal">null</span> &amp;&amp;
    userConfig.<span class="hljs-property">cxxModuleHeaderName</span> != <span class="hljs-literal">null</span> &amp;&amp;
    !manifestPath &amp;&amp;
    !buildGradlePath;

  <span class="hljs-keyword">if</span> (!manifestPath &amp;&amp; !buildGradlePath &amp;&amp; !isPureCxxDependency) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">let</span> packageImportPath = <span class="hljs-literal">null</span>,
    packageInstance = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> (!isPureCxxDependency) {
    <span class="hljs-keyword">const</span> packageName =
      userConfig.<span class="hljs-property">packageName</span> || <span class="hljs-title function_">getPackageName</span>(manifestPath, buildGradlePath);
    <span class="hljs-keyword">const</span> packageClassName = <span class="hljs-title function_">findPackageClassName</span>(sourceDir);

    <span class="hljs-comment">/**
     * This module has no package to export
     */</span>
    <span class="hljs-keyword">if</span> (!packageClassName) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    packageImportPath =
      userConfig.<span class="hljs-property">packageImportPath</span> ||
      <span class="hljs-string">`import <span class="hljs-subst">${packageName}</span>.<span class="hljs-subst">${packageClassName}</span>;`</span>;

    packageInstance = userConfig.<span class="hljs-property">packageInstance</span> || <span class="hljs-string">`new <span class="hljs-subst">${packageClassName}</span>()`</span>;
  }

  <span class="hljs-keyword">const</span> buildTypes = userConfig.<span class="hljs-property">buildTypes</span> || [];
  <span class="hljs-keyword">const</span> dependencyConfiguration = userConfig.<span class="hljs-property">dependencyConfiguration</span>;
  <span class="hljs-keyword">const</span> libraryName =
    userConfig.<span class="hljs-property">libraryName</span> || <span class="hljs-title function_">findLibraryName</span>(root, sourceDir);
  <span class="hljs-keyword">const</span> componentDescriptors =
    userConfig.<span class="hljs-property">componentDescriptors</span> || <span class="hljs-title function_">findComponentDescriptors</span>(root);
  <span class="hljs-keyword">let</span> cmakeListsPath = userConfig.<span class="hljs-property">cmakeListsPath</span>
    ? path.<span class="hljs-title function_">join</span>(sourceDir, userConfig.<span class="hljs-property">cmakeListsPath</span>)
    : path.<span class="hljs-title function_">join</span>(sourceDir, <span class="hljs-string">'build/generated/source/codegen/jni/CMakeLists.txt'</span>);
  <span class="hljs-keyword">const</span> cxxModuleCMakeListsModuleName =
    userConfig.<span class="hljs-property">cxxModuleCMakeListsModuleName</span> || <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">const</span> cxxModuleHeaderName = userConfig.<span class="hljs-property">cxxModuleHeaderName</span> || <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">let</span> cxxModuleCMakeListsPath = userConfig.<span class="hljs-property">cxxModuleCMakeListsPath</span>
    ? path.<span class="hljs-title function_">join</span>(sourceDir, userConfig.<span class="hljs-property">cxxModuleCMakeListsPath</span>)
    : <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">if</span> (process.<span class="hljs-property">platform</span> === <span class="hljs-string">'win32'</span>) {
    cmakeListsPath = cmakeListsPath.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>);
    <span class="hljs-keyword">if</span> (cxxModuleCMakeListsPath) {
      cxxModuleCMakeListsPath = cxxModuleCMakeListsPath.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>);
    }
  }

  <span class="hljs-keyword">return</span> {
    sourceDir,
    packageImportPath,
    packageInstance,
    buildTypes,
    dependencyConfiguration,
    libraryName,
    componentDescriptors,
    cmakeListsPath,
    cxxModuleCMakeListsModuleName,
    cxxModuleCMakeListsPath,
    cxxModuleHeaderName,
    isPureCxxDependency,
  };
}
</code></pre>
<p>æ­¤<code>dependencyConfig</code>å‡½æ•°éå¸¸é‡è¦ï¼Œå®ƒä¸»è¦ç”¨äºç”Ÿæˆ<code>example/android/build/generated/autolinking/autolinking.json</code>æ–‡ä»¶ã€‚<code>autolinking.json</code>æ–‡ä»¶æˆ‘ä»¬åœ¨å‰é¢çš„TurboModuleçš„æ–‡ç« å·²ç»ä»‹ç»è¿‡äº†ï¼Œå…¶ä¸­çš„ä¿¡æ¯æ˜¯æŒ‡å¯¼ä»£ç ç”Ÿæˆçš„å…³é”®ã€‚è¿™é‡Œé‡ç‚¹å…³æ³¨<code>componentDescriptors</code>å­—æ®µçš„ç”Ÿæˆï¼Œå› ä¸ºå®ƒæ˜¯Fabricç»„ä»¶ä»£ç ç”Ÿæˆçš„èµ·å§‹ã€‚</p>
<p>ç»„ä»¶å¼€å‘è€…é€šå¸¸å¹¶ä¸ä¼šåœ¨<code>react-native.config.js</code>æ–‡ä»¶ä¸­ä¸»åŠ¨é…ç½®<code>componentDescriptors</code>å­—æ®µï¼Œä¸€èˆ¬éƒ½æ˜¯é»˜è®¤å€¼ï¼Œé‚£ä¹ˆå°±è¦æŸ¥çœ‹ä¸€ä¸‹<code>findComponentDescriptors</code>å‡½æ•°çš„å®ç°é€»è¾‘äº†ï¼Œæºç <code>cli/packages/cli-config-android/src/config/findComponentDescriptors.ts</code>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">findComponentDescriptors</span>(<span class="hljs-params">packageRoot: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">let</span> jsSrcsDir = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> packageJson = fs.<span class="hljs-title function_">readFileSync</span>(
      path.<span class="hljs-title function_">join</span>(packageRoot, <span class="hljs-string">'package.json'</span>),
      <span class="hljs-string">'utf8'</span>,
    );
    jsSrcsDir = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(packageJson).<span class="hljs-property">codegenConfig</span>.<span class="hljs-property">jsSrcsDir</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// no jsSrcsDir, continue with default glob pattern</span>
  }
  <span class="hljs-keyword">const</span> globPattern = jsSrcsDir
    ? <span class="hljs-string">`<span class="hljs-subst">${jsSrcsDir}</span>/**/*{.js,.jsx,.ts,.tsx}`</span>
    : <span class="hljs-string">'**/*{.js,.jsx,.ts,.tsx}'</span>;
  <span class="hljs-keyword">const</span> files = glob.<span class="hljs-title function_">sync</span>(globPattern, {
    <span class="hljs-attr">cwd</span>: <span class="hljs-title function_">unixifyPaths</span>(packageRoot),
    <span class="hljs-attr">onlyFiles</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">ignore</span>: [<span class="hljs-string">'**/node_modules/**'</span>],
  });
  <span class="hljs-keyword">const</span> codegenComponent = files
    .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">filePath</span>) =&gt;</span>
      fs.<span class="hljs-title function_">readFileSync</span>(path.<span class="hljs-title function_">join</span>(packageRoot, filePath), <span class="hljs-string">'utf8'</span>),
    )
    .<span class="hljs-title function_">map</span>(extractComponentDescriptors)
    .<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);

  <span class="hljs-comment">// Filter out duplicates as it happens that libraries contain multiple outputs due to package publishing.</span>
  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> consider using "codegenConfig" to avoid this.</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>(codegenComponent <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>[]));
}
</code></pre>
<p>è¿™é‡Œä¸»è¦é€»è¾‘å…¶å®æ˜¯ä»<code>package.json</code>ä¸­è·å–åˆ°<code>jsSrcsDir</code>é…ç½®ï¼Œä»è€Œå®šä½åˆ°æºç æ‰€åœ¨ç›®å½•ã€‚æˆ‘ä»¬å…³æ³¨çš„æ˜¯<code>codegenComponent</code>çš„ç”Ÿæˆï¼Œæ­¤å¤„æ˜¯é€šè¿‡è¯»å–æ¯ä¸ªæºæ–‡ä»¶å†…å®¹ï¼Œç„¶åè°ƒç”¨ <code>extractComponentDescriptors</code> æå–ç»„ä»¶æè¿°ç¬¦ã€‚ç»§ç»­æŸ¥çœ‹<code>cli/packages/cli-config-android/src/config/extractComponentDescriptors.ts</code>ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">CODEGEN_NATIVE_COMPONENT_REGEX</span> =
  <span class="hljs-regexp">/codegenNativeComponent(&lt;.*&gt;)?\s*\(\s*["'`](\w+)["'`](,?[\s\S]+interfaceOnly:\s*(\w+))?/m</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">extractComponentDescriptors</span>(<span class="hljs-params">contents: <span class="hljs-built_in">string</span></span>) {
  <span class="hljs-keyword">const</span> match = contents.<span class="hljs-title function_">match</span>(<span class="hljs-variable constant_">CODEGEN_NATIVE_COMPONENT_REGEX</span>);
  <span class="hljs-keyword">if</span> (!(match?.[<span class="hljs-number">4</span>] === <span class="hljs-string">'true'</span>) &amp;&amp; match?.[<span class="hljs-number">2</span>]) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${match[<span class="hljs-number">2</span>]}</span>ComponentDescriptor`</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<p>åˆ°è¿™é‡Œå°±å¾ˆæ¸…æ¥šäº†ï¼Œæ‰«ææ‰€æœ‰æºç ï¼Œä½¿ç”¨æ­£åˆ™æ‰¾åˆ°æˆ‘ä»¬åœ¨å£°æ˜ç»„ä»¶ä¸€èŠ‚ä¸­æåˆ°çš„<code>export default codegenNativeComponent&lt;NativeProps&gt;('CustomviewView');</code>è¿™è¡Œä»£ç ï¼Œè¿™é‡Œçš„æ­£åˆ™å°±æ˜¯åŒ¹é…å…³é”®å­—<code>codegenNativeComponent</code>ã€‚è¿™é‡Œçš„<code>match?.[2]</code>å°±æ˜¯æå‰å‡ºç»„ä»¶åï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç¤ºä¾‹ä¸­çš„<code>CustomviewView</code>ã€‚æœ€ç»ˆè¿”å›çš„å­—ç¬¦ä¸²æ˜¯æ‹¼æ¥åçš„ï¼Œè¿™é‡Œå°±æ˜¯<code>CustomviewViewComponentDescriptor</code>ã€‚ä¹Ÿå°±æ˜¯è¯´<code>componentDescriptors</code>å­—æ®µçš„é»˜è®¤å€¼æ˜¯<code>CustomviewViewComponentDescriptor</code>ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å›é¡¾å‰æ–‡<a href="https://juejin.cn/post/7595178023256211475" target="_blank" title="https://juejin.cn/post/7595178023256211475">ã€ŠReactNativeæ–°æ¶æ„ä¹‹Androidç«¯TurboModuleæœºåˆ¶å®Œå…¨è§£æã€‹</a>ï¼Œå…¶ä¸­æåˆ°ä½†ç•¥è¿‡çš„React Gradleè„šæœ¬çš„<code>configureCodegen</code>æ–¹æ³•ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">  <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">configureCodegen</span><span class="hljs-params">(
      project: <span class="hljs-type">Project</span>,
      localExtension: <span class="hljs-type">ReactExtension</span>,
      rootExtension: <span class="hljs-type">PrivateReactExtension</span>,
      isLibrary: <span class="hljs-type">Boolean</span>,
  )</span></span> {
    <span class="hljs-comment">// é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½® Codegen çš„è¾“å‡ºç›®å½•</span>
    <span class="hljs-keyword">val</span> generatedSrcDir: Provider&lt;Directory&gt; =
        project.layout.buildDirectory.dir(<span class="hljs-string">"generated/source/codegen"</span>)

    <span class="hljs-comment">// æˆ‘ä»¬ä¸º jsRootDirï¼ˆJSæ ¹ç›®å½•ï¼‰æŒ‡å®šé»˜è®¤å€¼ï¼ˆçº¦å®šï¼‰ã€‚</span>
    <span class="hljs-comment">// å¯¹äº App æ¥è¯´æ˜¯æ ¹æ–‡ä»¶å¤¹ï¼ˆå³ Gradle é¡¹ç›®çš„ ../../ï¼‰</span>
    <span class="hljs-comment">// å¯¹äº Library æ¥è¯´æ˜¯åŒ…æ–‡ä»¶å¤¹ï¼ˆå³ Gradle é¡¹ç›®çš„ ../ï¼‰</span>
    <span class="hljs-keyword">if</span> (isLibrary) {
      localExtension.jsRootDir.convention(project.layout.projectDirectory.dir(<span class="hljs-string">"../"</span>))
    } <span class="hljs-keyword">else</span> {
      localExtension.jsRootDir.convention(localExtension.root)
    }

    <span class="hljs-comment">// æˆ‘ä»¬åˆ›å»ºä»»åŠ¡ä»¥ä» JS æ–‡ä»¶ç”Ÿæˆ Schema</span>
    <span class="hljs-keyword">val</span> generateCodegenSchemaTask =
        project.tasks.register(
            <span class="hljs-string">"generateCodegenSchemaFromJavaScript"</span>,
            GenerateCodegenSchemaTask::<span class="hljs-keyword">class</span>.java,
        ) { it -&gt;
          it.nodeExecutableAndArgs.<span class="hljs-keyword">set</span>(rootExtension.nodeExecutableAndArgs)
          it.codegenDir.<span class="hljs-keyword">set</span>(rootExtension.codegenDir)
          it.generatedSrcDir.<span class="hljs-keyword">set</span>(generatedSrcDir)
          it.nodeWorkingDir.<span class="hljs-keyword">set</span>(project.layout.projectDirectory.asFile.absolutePath)

          <span class="hljs-comment">// æˆ‘ä»¬åœ¨é…ç½®é˜¶æ®µè¯»å– package.jsonï¼Œä»¥ä¾¿æ­£ç¡®åœ°å¡«å……æ­¤ä»»åŠ¡çš„ `jsRootDir` @Input å±æ€§</span>
          <span class="hljs-comment">// ä»¥åŠ onlyIf æ¡ä»¶ã€‚å› æ­¤ï¼ŒparsePackageJson åº”è¯¥åœ¨è¿™ä¸ª lambda è¡¨è¾¾å¼å†…éƒ¨è¢«è°ƒç”¨ã€‚</span>
          <span class="hljs-keyword">val</span> packageJson = findPackageJsonFile(project, rootExtension.root)
          <span class="hljs-keyword">val</span> parsedPackageJson = packageJson?.let { JsonUtils.fromPackageJson(it) }

          <span class="hljs-keyword">val</span> jsSrcsDirInPackageJson = parsedPackageJson?.codegenConfig?.jsSrcsDir
          <span class="hljs-keyword">val</span> includesGeneratedCode =
              parsedPackageJson?.codegenConfig?.includesGeneratedCode ?: <span class="hljs-literal">false</span>
          <span class="hljs-keyword">if</span> (jsSrcsDirInPackageJson != <span class="hljs-literal">null</span>) {
            it.jsRootDir.<span class="hljs-keyword">set</span>(File(packageJson.parentFile, jsSrcsDirInPackageJson))
          } <span class="hljs-keyword">else</span> {
            it.jsRootDir.<span class="hljs-keyword">set</span>(localExtension.jsRootDir)
          }
          it.jsInputFiles.<span class="hljs-keyword">set</span>(
              project.fileTree(it.jsRootDir) { tree -&gt;
                tree.include(<span class="hljs-string">"**/*.js"</span>)
                tree.include(<span class="hljs-string">"**/*.jsx"</span>)
                tree.include(<span class="hljs-string">"**/*.ts"</span>)
                tree.include(<span class="hljs-string">"**/*.tsx"</span>)

                tree.exclude(<span class="hljs-string">"node_modules/**/*"</span>)
                tree.exclude(<span class="hljs-string">"**/*.d.ts"</span>)
                <span class="hljs-comment">// æˆ‘ä»¬å¸Œæœ›æ’é™¤ build ç›®å½•ï¼Œä»¥é¿å…åœ¨æ‰§è¡Œè§„é¿æ£€æŸ¥æ—¶é€‰ä¸­å®ƒä»¬</span>
                tree.exclude(<span class="hljs-string">"**/build/**/*"</span>)
              }
          )

          <span class="hljs-keyword">val</span> needsCodegenFromPackageJson = project.needsCodegenFromPackageJson(rootExtension.root)
          it.onlyIf { (isLibrary || needsCodegenFromPackageJson) &amp;&amp; !includesGeneratedCode }
        }

    <span class="hljs-comment">// æˆ‘ä»¬åˆ›å»ºä»»åŠ¡ä»¥ä» Schema ç”Ÿæˆ Java ä»£ç </span>
    <span class="hljs-keyword">val</span> generateCodegenArtifactsTask =
        project.tasks.register(
            <span class="hljs-string">"generateCodegenArtifactsFromSchema"</span>,
            GenerateCodegenArtifactsTask::<span class="hljs-keyword">class</span>.java,
        ) { task -&gt;
          task.dependsOn(generateCodegenSchemaTask)
          task.reactNativeDir.<span class="hljs-keyword">set</span>(rootExtension.reactNativeDir)
          task.nodeExecutableAndArgs.<span class="hljs-keyword">set</span>(rootExtension.nodeExecutableAndArgs)
          task.generatedSrcDir.<span class="hljs-keyword">set</span>(generatedSrcDir)
          task.packageJsonFile.<span class="hljs-keyword">set</span>(findPackageJsonFile(project, rootExtension.root))
          task.codegenJavaPackageName.<span class="hljs-keyword">set</span>(localExtension.codegenJavaPackageName)
          task.libraryName.<span class="hljs-keyword">set</span>(localExtension.libraryName)
          task.nodeWorkingDir.<span class="hljs-keyword">set</span>(project.layout.projectDirectory.asFile.absolutePath)

          <span class="hljs-comment">// è¯·æ³¨æ„ï¼ŒappNeedsCodegen ä¼šè§¦å‘åœ¨é…ç½®é˜¶æ®µè¯»å– package.jsonï¼Œ</span>
          <span class="hljs-comment">// å› ä¸ºæˆ‘ä»¬éœ€è¦å¡«å……æ­¤ä»»åŠ¡çš„ onlyIf æ¡ä»¶ã€‚</span>
          <span class="hljs-comment">// å› æ­¤ï¼ŒappNeedsCodegen éœ€è¦åœ¨è¿™ä¸ª lambda è¡¨è¾¾å¼å†…éƒ¨è¢«è°ƒç”¨</span>
          <span class="hljs-keyword">val</span> needsCodegenFromPackageJson = project.needsCodegenFromPackageJson(rootExtension.root)
          <span class="hljs-keyword">val</span> packageJson = findPackageJsonFile(project, rootExtension.root)
          <span class="hljs-keyword">val</span> parsedPackageJson = packageJson?.let { JsonUtils.fromPackageJson(it) }
          <span class="hljs-keyword">val</span> includesGeneratedCode =
              parsedPackageJson?.codegenConfig?.includesGeneratedCode ?: <span class="hljs-literal">false</span>
          task.onlyIf { (isLibrary || needsCodegenFromPackageJson) &amp;&amp; !includesGeneratedCode }
        }

    <span class="hljs-comment">// æˆ‘ä»¬æ›´æ–° Android é…ç½®ä»¥åŒ…å«ç”Ÿæˆçš„æºç </span>
    <span class="hljs-comment">// è¿™ç›¸å½“äºä»¥ä¸‹çš„ DSLï¼š</span>
    <span class="hljs-comment">//</span>
    <span class="hljs-comment">// android { sourceSets { main { java { srcDirs += "$generatedSrcDir/java" } } } }</span>
    <span class="hljs-keyword">if</span> (isLibrary) {
      project.extensions.getByType(LibraryAndroidComponentsExtension::<span class="hljs-keyword">class</span>.java).finalizeDsl { ext
        -&gt;
        ext.sourceSets.getByName(<span class="hljs-string">"main"</span>).java.srcDir(generatedSrcDir.<span class="hljs-keyword">get</span>().dir(<span class="hljs-string">"java"</span>).asFile)
      }
    } <span class="hljs-keyword">else</span> {
      project.extensions.getByType(ApplicationAndroidComponentsExtension::<span class="hljs-keyword">class</span>.java).finalizeDsl {
          ext -&gt;
        ext.sourceSets.getByName(<span class="hljs-string">"main"</span>).java.srcDir(generatedSrcDir.<span class="hljs-keyword">get</span>().dir(<span class="hljs-string">"java"</span>).asFile)
      }
    }

    <span class="hljs-comment">// `preBuild` æ˜¯ AGP è‡ªåŠ¨æ³¨å†Œçš„åŸºç¡€ä»»åŠ¡ä¹‹ä¸€</span>
    <span class="hljs-comment">// è¿™å°†åœ¨ç¼–è¯‘æ•´ä¸ªé¡¹ç›®ä¹‹å‰è°ƒç”¨ Codegen</span>
    project.tasks.named(<span class="hljs-string">"preBuild"</span>, Task::<span class="hljs-keyword">class</span>.java).dependsOn(generateCodegenArtifactsTask)
  }
</code></pre>
<p><code>configureCodegen</code> æ˜¯ React Native Gradle æ’ä»¶çš„æ ¸å¿ƒæ–¹æ³•ï¼Œè´Ÿè´£é…ç½® <strong>Fabric/TurboModule æ–°æ¶æ„çš„ä»£ç ç”Ÿæˆï¼ˆCodegenï¼‰æµç¨‹</strong>ã€‚è¯¥æ–¹æ³•åœ¨ Gradle é…ç½®é˜¶æ®µæ‰§è¡Œï¼Œè®¾ç½®ä¸¤ä¸ªå…³é”®ä»»åŠ¡å’Œ Android æºç é›†é›†æˆã€‚</p>
<p>å…¶æµç¨‹å¯ä»¥åˆ†ä¸ºäº”ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li>
<p>è®¾ç½®è¾“å‡ºç›®å½•å’ŒÂ JS æ ¹ç›®å½•</p>
</li>
<li>
<p>åˆ›å»º Schema ç”Ÿæˆä»»åŠ¡</p>
</li>
<li>
<p>åˆ›å»ºä»£ç ç”Ÿæˆä»»åŠ¡</p>
</li>
<li>
<p>é›†æˆåˆ° Android æ„å»ºç³»ç»Ÿ</p>
</li>
<li>
<p>æŒ‚è½½åˆ°æ„å»ºç”Ÿå‘½å‘¨æœŸ</p>
</li>
</ol>
<p>è¿™é‡Œæ¦‚æ‹¬ä¸€ä¸‹æ•´ä¸ªæµç¨‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">1. Gradle é…ç½®é˜¶æ®µ
   â”œâ”€&gt; è®¾ç½® generatedSrcDir = <span class="hljs-string">"build/generated/source/codegen"</span>
   â”œâ”€&gt; è®¾ç½® jsRootDir é»˜è®¤å€¼ï¼ˆLibrary: <span class="hljs-string">"../"</span>, App: rootï¼‰
   â”œâ”€&gt; è¯»å– package.jsonï¼ˆé…ç½®é˜¶æ®µï¼‰
   â”‚   â”œâ”€&gt; æ£€æŸ¥ codegenConfig.jsSrcsDir
   â”‚   â””â”€&gt; æ£€æŸ¥ codegenConfig.includesGeneratedCode
   â”œâ”€&gt; æ³¨å†Œ generateCodegenSchemaTask
   â”‚   â”œâ”€&gt; é…ç½® Node.js ç¯å¢ƒ
   â”‚   â”œâ”€&gt; è®¾ç½® JS è¾“å…¥æ–‡ä»¶ï¼ˆ**/*.{js,jsx,ts,tsx}ï¼‰
   â”‚   â””â”€&gt; è®¾ç½® onlyIf æ¡ä»¶
   â”œâ”€&gt; æ³¨å†Œ generateCodegenArtifactsTask
   â”‚   â”œâ”€&gt; ä¾èµ– generateCodegenSchemaTask
   â”‚   â””â”€&gt; è®¾ç½® onlyIf æ¡ä»¶
   â”œâ”€&gt; é…ç½® Android SourceSets
   â”‚   â””â”€&gt; æ·»åŠ  generatedSrcDir/java åˆ° main SourceSet
   â””â”€&gt; å»ºç«‹ preBuild ä¾èµ–å…³ç³»

2. Gradle æ‰§è¡Œé˜¶æ®µï¼ˆè¿è¡Œ ./gradlew buildï¼‰
   â”œâ”€&gt; preBuild ä»»åŠ¡æ‰§è¡Œ
   â”‚   â””â”€&gt; generateCodegenArtifactsTask æ‰§è¡Œ
   â”‚         â”œâ”€&gt; generateCodegenSchemaTask æ‰§è¡Œ
   â”‚         â”‚     â”œâ”€&gt; æ‰«æ JS/TS æ–‡ä»¶
   â”‚         â”‚     â””â”€&gt; ç”Ÿæˆ schema.json
   â”‚         â””â”€&gt; æ ¹æ® schema.json ç”Ÿæˆ Java/C++ ä»£ç 
   â””â”€&gt; compileJava ç¼–è¯‘ç”Ÿæˆçš„ä»£ç 
</code></pre>
<p>è¿™é‡Œçš„ä¸¤ä¸ªå…³é”®ä»»åŠ¡åˆ†åˆ«æ˜¯<strong>generateCodegenSchemaFromJavaScript</strong>å’Œ<strong>generateCodegenArtifactsFromSchema</strong>ã€‚å‰è€…ä» JS/TS ç”Ÿæˆ Schema JSONæ–‡ä»¶ï¼Œåè€…ä» Schema ç”Ÿæˆ Java/C++ ä»£ç ã€‚</p>
<p>Schema JSONä¸»è¦æ˜¯JS/TSçš„æ¥å£æè¿°ï¼Œç”Ÿæˆè·¯å¾„æ˜¯<code>Your Project/node_modules/Third-party Lib/android/build/generated/source/codegen/schema.json</code>ï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ï¼Œè¿™é‡Œæˆ‘ä»¬é‡ç‚¹å…³æ³¨<code>generateCodegenArtifactsFromSchema</code>ï¼Œæºç <code>react-native/packages/gradle-plugin/react-native-gradle-plugin/src/main/kotlin/com/facebook/react/tasks/GenerateCodegenArtifactsTask.kt</code>ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GenerateCodegenArtifactsTask</span> : <span class="hljs-type">Exec</span>() {
  <span class="hljs-meta">@get:Internal</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> reactNativeDir: DirectoryProperty
  <span class="hljs-meta">@get:Internal</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> generatedSrcDir: DirectoryProperty
  <span class="hljs-meta">@get:InputFile</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> packageJsonFile: RegularFileProperty   <span class="hljs-comment">// package.json æ–‡ä»¶è·¯å¾„</span>
  <span class="hljs-meta">@get:Input</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> nodeWorkingDir: Property&lt;String&gt;
  <span class="hljs-meta">@get:Input</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> nodeExecutableAndArgs: ListProperty&lt;String&gt;
  <span class="hljs-meta">@get:Input</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> codegenJavaPackageName: Property&lt;String&gt;
  <span class="hljs-meta">@get:Input</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">val</span> libraryName: Property&lt;String&gt;

  <span class="hljs-meta">@get:InputFile</span>
  <span class="hljs-keyword">val</span> generatedSchemaFile: Provider&lt;RegularFile&gt; = generatedSrcDir.file(<span class="hljs-string">"schema.json"</span>)

  <span class="hljs-meta">@get:OutputDirectory</span> <span class="hljs-keyword">val</span> generatedJavaFiles: Provider&lt;Directory&gt; = generatedSrcDir.dir(<span class="hljs-string">"java"</span>)
  <span class="hljs-meta">@get:OutputDirectory</span> <span class="hljs-keyword">val</span> generatedJniFiles: Provider&lt;Directory&gt; = generatedSrcDir.dir(<span class="hljs-string">"jni"</span>)

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">exec</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> (resolvedLibraryName, resolvedCodegenJavaPackageName) = resolveTaskParameters()
    setupCommandLine(resolvedLibraryName, resolvedCodegenJavaPackageName)
    <span class="hljs-keyword">super</span>.exec()
  }

  <span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">resolveTaskParameters</span><span class="hljs-params">()</span></span>: Pair&lt;String, String&gt; {
    <span class="hljs-keyword">val</span> parsedPackageJson =
        <span class="hljs-keyword">if</span> (packageJsonFile.isPresent &amp;&amp; packageJsonFile.<span class="hljs-keyword">get</span>().asFile.exists()) {
          JsonUtils.fromPackageJson(packageJsonFile.<span class="hljs-keyword">get</span>().asFile)
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-literal">null</span>
        }
    <span class="hljs-keyword">val</span> resolvedLibraryName = parsedPackageJson?.codegenConfig?.name ?: libraryName.<span class="hljs-keyword">get</span>()
    <span class="hljs-keyword">val</span> resolvedCodegenJavaPackageName =
        parsedPackageJson?.codegenConfig?.android?.javaPackageName ?: codegenJavaPackageName.<span class="hljs-keyword">get</span>()
    <span class="hljs-keyword">return</span> resolvedLibraryName to resolvedCodegenJavaPackageName
  }

  <span class="hljs-keyword">internal</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">setupCommandLine</span><span class="hljs-params">(libraryName: <span class="hljs-type">String</span>, codegenJavaPackageName: <span class="hljs-type">String</span>)</span></span> {
    <span class="hljs-keyword">val</span> workingDir = File(nodeWorkingDir.<span class="hljs-keyword">get</span>())
    commandLine(
        windowsAwareCommandLine(
            *nodeExecutableAndArgs.<span class="hljs-keyword">get</span>().toTypedArray(),
            reactNativeDir.file(<span class="hljs-string">"scripts/generate-specs-cli.js"</span>).<span class="hljs-keyword">get</span>().asFile.cliPath(workingDir),
            <span class="hljs-string">"--platform"</span>,
            <span class="hljs-string">"android"</span>,
            <span class="hljs-string">"--schemaPath"</span>,
            generatedSchemaFile.<span class="hljs-keyword">get</span>().asFile.cliPath(workingDir),
            <span class="hljs-string">"--outputDir"</span>,
            generatedSrcDir.<span class="hljs-keyword">get</span>().asFile.cliPath(workingDir),
            <span class="hljs-string">"--libraryName"</span>,
            libraryName,
            <span class="hljs-string">"--javaPackageName"</span>,
            codegenJavaPackageName,
        )
    )
  }
}
</code></pre>
<p>è¯¥ç±»ä¸»è¦ç”¨äºæ‰§è¡Œå¤–éƒ¨ Node.js å‘½ä»¤ï¼Œä¾æ® <code>schema.json</code>æ–‡ä»¶ï¼Œç”Ÿæˆ Java/JNI ä»£ç ã€‚éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œè¿™é‡Œ<code>libraryName</code>å’Œ<code>codegenJavaPackageName</code>çš„å–å€¼ï¼Œä»£ç ä¸­æ˜¯é€šè¿‡<code>resolveTaskParameters</code>æ–¹æ³•æå–å‡ºæ¥çš„ã€‚å›é¡¾ä¸€ä¸‹package.jsonæ–‡ä»¶çš„é…ç½®ï¼Œå¤§æ¦‚æ˜¯ä»¥ä¸‹ç»“æ„ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"codegenConfig"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MyLibrary"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"android"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"javaPackageName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"com.example.mylibrary"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é‚£ä¹ˆ<code>libraryName</code>å°±æ˜¯<code>"MyLibrary"</code>ï¼Œ<code>codegenJavaPackageName</code>å°±æ˜¯<code>"com.example.mylibrary"</code>ã€‚</p>
<p>ç°åœ¨å†è¿˜åŸä¸€ä¸‹å‘½ä»¤ï¼Œå…¶å®å°±æ˜¯ä»¥ä¸‹å½¢å¼ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">node &lt;reactNativeDir&gt;/scripts/generate-specs-cli.js \
  --platform android \
  --schemaPath &lt;generatedSrcDir&gt;/schema.json \
  --outputDir &lt;generatedSrcDir&gt; \
  --libraryName &lt;resolvedLibraryName&gt; \
  --javaPackageName &lt;resolvedCodegenJavaPackageName&gt;
</code></pre>
<p>æˆ‘ä»¬å®šä½åˆ°è¯¥jsæ–‡ä»¶<code>react-native/packages/react-native/scripts/generate-specs-cli.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> executor = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./codegen/generate-specs-cli-executor'</span>);
<span class="hljs-comment">// çœç•¥......</span>

<span class="hljs-keyword">function</span> <span class="hljs-title function_">main</span>(<span class="hljs-params"/>) {
  executor.<span class="hljs-title function_">execute</span>(
    <span class="hljs-comment">// $FlowFixMe[prop-missing]</span>
    argv.<span class="hljs-property">platform</span>,
    <span class="hljs-comment">// $FlowFixMe[prop-missing]</span>
    argv.<span class="hljs-property">schemaPath</span>,
    <span class="hljs-comment">// $FlowFixMe[prop-missing]</span>
    argv.<span class="hljs-property">outputDir</span>,
    <span class="hljs-comment">// $FlowFixMe[prop-missing]</span>
    argv.<span class="hljs-property">libraryName</span>,
    <span class="hljs-comment">// $FlowFixMe[prop-missing]</span>
    argv.<span class="hljs-property">javaPackageName</span>,
    <span class="hljs-comment">// $FlowFixMe[prop-missing]</span>
    argv.<span class="hljs-property">libraryType</span>,
  );
}

<span class="hljs-title function_">main</span>();
</code></pre>
<p>ç»§ç»­è·Ÿè¸ª<code>react-native/packages/react-native/scripts/codegen/generate-specs-cli-executor.js</code></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./codegen-utils'</span>);

<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">GENERATORS</span> <span class="hljs-comment">/*: {[string]: {[string]: $ReadOnlyArray&lt;string&gt;}} */</span> = {
  <span class="hljs-attr">all</span>: {
    <span class="hljs-attr">android</span>: [<span class="hljs-string">'componentsAndroid'</span>, <span class="hljs-string">'modulesAndroid'</span>, <span class="hljs-string">'modulesCxx'</span>],
    <span class="hljs-attr">ios</span>: [<span class="hljs-string">'componentsIOS'</span>, <span class="hljs-string">'modulesIOS'</span>, <span class="hljs-string">'modulesCxx'</span>],
  },
  <span class="hljs-attr">components</span>: {
    <span class="hljs-attr">android</span>: [<span class="hljs-string">'componentsAndroid'</span>],
    <span class="hljs-attr">ios</span>: [<span class="hljs-string">'componentsIOS'</span>],
  },
  <span class="hljs-attr">modules</span>: {
    <span class="hljs-attr">android</span>: [<span class="hljs-string">'modulesAndroid'</span>, <span class="hljs-string">'modulesCxx'</span>],
    <span class="hljs-attr">ios</span>: [<span class="hljs-string">'modulesIOS'</span>, <span class="hljs-string">'modulesCxx'</span>],
  },
};

<span class="hljs-keyword">function</span> <span class="hljs-title function_">generateSpecFromInMemorySchema</span>(<span class="hljs-params">
  platform <span class="hljs-comment">/*: string */</span>,
  schema <span class="hljs-comment">/*: string */</span>,
  outputDirectory <span class="hljs-comment">/*: string */</span>,
  libraryName <span class="hljs-comment">/*: string */</span>,
  packageName <span class="hljs-comment">/*: string */</span>,
  libraryType <span class="hljs-comment">/*: string */</span>,
  useLocalIncludePaths <span class="hljs-comment">/*: boolean */</span>,
</span>) {
  <span class="hljs-title function_">validateLibraryType</span>(libraryType);
  <span class="hljs-title function_">createOutputDirectoryIfNeeded</span>(outputDirectory, libraryName);
  <span class="hljs-keyword">const</span> includeGetDebugPropsImplementation =
    libraryName.<span class="hljs-title function_">includes</span>(<span class="hljs-string">'FBReactNativeSpec'</span>); <span class="hljs-comment">//only generate getDebugString for React Native Core Components</span>
  utils.<span class="hljs-title function_">getCodegen</span>().<span class="hljs-title function_">generate</span>(
    {
      libraryName,
      schema,
      outputDirectory,
      packageName,
      <span class="hljs-attr">assumeNonnull</span>: platform === <span class="hljs-string">'ios'</span>,
      useLocalIncludePaths,
      includeGetDebugPropsImplementation,
    },
    {
      <span class="hljs-attr">generators</span>: <span class="hljs-variable constant_">GENERATORS</span>[libraryType][platform],
    },
  );

  <span class="hljs-keyword">if</span> (platform === <span class="hljs-string">'android'</span>) {
    <span class="hljs-comment">// Move all components C++ files to a structured jni folder for now.</span>
    <span class="hljs-comment">// Note: this should've been done by RNCodegen's generators, but:</span>
    <span class="hljs-comment">// * the generators don't support platform option yet</span>
    <span class="hljs-comment">// * this subdir structure is Android-only, not applicable to iOS</span>
    <span class="hljs-keyword">const</span> files = fs.<span class="hljs-title function_">readdirSync</span>(outputDirectory);
    <span class="hljs-keyword">const</span> jniOutputDirectory = <span class="hljs-string">`<span class="hljs-subst">${outputDirectory}</span>/jni/react/renderer/components/<span class="hljs-subst">${libraryName}</span>`</span>;
    fs.<span class="hljs-title function_">mkdirSync</span>(jniOutputDirectory, {<span class="hljs-attr">recursive</span>: <span class="hljs-literal">true</span>});
    files
      .<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> f.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.h'</span>) || f.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'.cpp'</span>))
      .<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">f</span> =&gt;</span> {
        fs.<span class="hljs-title function_">renameSync</span>(<span class="hljs-string">`<span class="hljs-subst">${outputDirectory}</span>/<span class="hljs-subst">${f}</span>`</span>, <span class="hljs-string">`<span class="hljs-subst">${jniOutputDirectory}</span>/<span class="hljs-subst">${f}</span>`</span>);
      });
  }
}
</code></pre>
<p>è¿™é‡Œæ ¸å¿ƒæ˜¯è°ƒç”¨<code>utils.getCodegen().generate</code>æ¥æ‰§è¡Œä»£ç ç”Ÿæˆé€»è¾‘ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªä¼ å‚éœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œ<code>generators: GENERATORS[libraryType][platform],</code>æˆ‘ä»¬è§‚å¯Ÿ<strong>GENERATORS</strong>çš„å®šä¹‰å°±ä¼šå‘ç°ï¼Œè¿™é‡Œçš„å‚æ•°é…ç½®æ­£å¥½å¯¹åº”package.jsonä¸­çš„codegené…ç½®ï¼Œç”±äºæˆ‘ä»¬ç°åœ¨ç ”ç©¶çš„æ˜¯Fabricç»„ä»¶æ³¨å†Œï¼Œé‚£ä¹ˆè¿™é‡Œçš„å‚æ•°åº”è¯¥æ˜¯<code>componentsAndroid</code>ã€‚</p>
<p>ç»§ç»­æŸ¥æ‰¾<code>generate</code>æ–¹æ³•çš„å®ç°ï¼Œæºç <code>react-native/packages/react-native/scripts/codegen/codegen-utils.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">/**
* ç”¨äºæŠ½è±¡å®é™…ä»£ç ç”Ÿæˆè¿‡ç¨‹çš„åŒ…è£…å™¨ã€‚ 
* ä¹‹æ‰€ä»¥éœ€è¦è¿™ä¸ªåŒ…è£…å™¨ï¼Œæ˜¯å› ä¸ºåœ¨ Sandcastle ä¸­è¿è¡Œæµ‹è¯•æ—¶ï¼Œå¹¶éæ‰€æœ‰ç¯å¢ƒéƒ½åƒé€šå¸¸é‚£æ ·è®¾ç½®ã€‚ 
* ä¾‹å¦‚ï¼Œ`<span class="hljs-doctag">@react</span>-native/codegen` åº“å°±ä¸å­˜åœ¨ã€‚ 
*
* å€ŸåŠ©è¿™ä¸ªåŒ…è£…å™¨ï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿä»£ç ç”Ÿæˆå™¨çš„ getter æ–¹æ³•ï¼Œä½¿å…¶è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ¨¡æ‹Ÿäº† Codegen æ¥å£ã€‚ 
*
* <span class="hljs-doctag">@return</span> ä¸€ä¸ªå¯ä»¥ä¸ºæ–°æ¶æ„ç”Ÿæˆä»£ç çš„å¯¹è±¡ã€‚ 
*/</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getCodegen</span>(<span class="hljs-params"/>) <span class="hljs-comment">/*: $FlowFixMe */</span> {
  <span class="hljs-keyword">let</span> <span class="hljs-title class_">RNCodegen</span>;
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// $FlowFixMe[cannot-resolve-module]</span>
    <span class="hljs-title class_">RNCodegen</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../../packages/react-native-codegen/lib/generators/RNCodegen.js'</span>);
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-comment">// $FlowFixMe[cannot-resolve-module]</span>
    <span class="hljs-title class_">RNCodegen</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@react-native/codegen/lib/generators/RNCodegen.js'</span>);
  }
  <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">RNCodegen</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'RNCodegen not found.'</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">RNCodegen</span>;
}
</code></pre>
<p>ç»§ç»­è·Ÿè¸ª<code>react-native/packages/react-native-codegen/lib/generators/RNCodegen.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">LIBRARY_GENERATORS</span> = {
  <span class="hljs-attr">descriptors</span>: [
    generateComponentDescriptorCpp.<span class="hljs-property">generate</span>,
    generateComponentDescriptorH.<span class="hljs-property">generate</span>,
  ],
  <span class="hljs-attr">events</span>: [generateEventEmitterCpp.<span class="hljs-property">generate</span>, generateEventEmitterH.<span class="hljs-property">generate</span>],
  <span class="hljs-attr">states</span>: [generateStateCpp.<span class="hljs-property">generate</span>, generateStateH.<span class="hljs-property">generate</span>],
  <span class="hljs-attr">props</span>: [
    generateComponentHObjCpp.<span class="hljs-property">generate</span>,
    generatePropsCpp.<span class="hljs-property">generate</span>,
    generatePropsH.<span class="hljs-property">generate</span>,
    generatePropsJavaInterface.<span class="hljs-property">generate</span>,
    generatePropsJavaDelegate.<span class="hljs-property">generate</span>,
  ],
  <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Refactor this to consolidate various C++ output variation instead of forking per platform.</span>
  <span class="hljs-attr">componentsAndroid</span>: [
    <span class="hljs-comment">// JNI/C++ files</span>
    generateComponentDescriptorH.<span class="hljs-property">generate</span>,
    generateComponentDescriptorCpp.<span class="hljs-property">generate</span>,
    generateEventEmitterCpp.<span class="hljs-property">generate</span>,
    generateEventEmitterH.<span class="hljs-property">generate</span>,
    generatePropsCpp.<span class="hljs-property">generate</span>,
    generatePropsH.<span class="hljs-property">generate</span>,
    generateStateCpp.<span class="hljs-property">generate</span>,
    generateStateH.<span class="hljs-property">generate</span>,
    generateShadowNodeCpp.<span class="hljs-property">generate</span>,
    generateShadowNodeH.<span class="hljs-property">generate</span>,
    <span class="hljs-comment">// Java files</span>
    generatePropsJavaInterface.<span class="hljs-property">generate</span>,
    generatePropsJavaDelegate.<span class="hljs-property">generate</span>,
  ],
  <span class="hljs-attr">componentsIOS</span>: [
    generateComponentDescriptorH.<span class="hljs-property">generate</span>,
    generateComponentDescriptorCpp.<span class="hljs-property">generate</span>,
    generateEventEmitterCpp.<span class="hljs-property">generate</span>,
    generateEventEmitterH.<span class="hljs-property">generate</span>,
    generateComponentHObjCpp.<span class="hljs-property">generate</span>,
    generatePropsCpp.<span class="hljs-property">generate</span>,
    generatePropsH.<span class="hljs-property">generate</span>,
    generateStateCpp.<span class="hljs-property">generate</span>,
    generateStateH.<span class="hljs-property">generate</span>,
    generateShadowNodeCpp.<span class="hljs-property">generate</span>,
    generateShadowNodeH.<span class="hljs-property">generate</span>,
  ],
  <span class="hljs-attr">modulesAndroid</span>: [
    generateModuleJniCpp.<span class="hljs-property">generate</span>,
    generateModuleJniH.<span class="hljs-property">generate</span>,
    generateModuleJavaSpec.<span class="hljs-property">generate</span>,
  ],
  <span class="hljs-attr">modulesCxx</span>: [generateModuleH.<span class="hljs-property">generate</span>],
  <span class="hljs-attr">modulesIOS</span>: [generateModuleObjCpp.<span class="hljs-property">generate</span>],
  <span class="hljs-attr">tests</span>: [generateTests.<span class="hljs-property">generate</span>],
  <span class="hljs-string">'shadow-nodes'</span>: [
    generateShadowNodeCpp.<span class="hljs-property">generate</span>,
    generateShadowNodeH.<span class="hljs-property">generate</span>,
  ],
};


<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  <span class="hljs-attr">allGenerators</span>: <span class="hljs-variable constant_">ALL_GENERATORS</span>,
  <span class="hljs-title function_">generate</span>(<span class="hljs-params">
    {
      libraryName,
      schema,
      outputDirectory,
      packageName,
      assumeNonnull,
      useLocalIncludePaths,
      includeGetDebugPropsImplementation = <span class="hljs-literal">false</span>,
      libraryGenerators = LIBRARY_GENERATORS,
    },
    {generators, test},
  </span>) {
    schemaValidator.<span class="hljs-title function_">validate</span>(schema);
    <span class="hljs-keyword">const</span> defaultHeaderPrefix = <span class="hljs-string">'react/renderer/components'</span>;
    <span class="hljs-keyword">const</span> headerPrefix =
      useLocalIncludePaths === <span class="hljs-literal">true</span>
        ? <span class="hljs-string">''</span>
        : <span class="hljs-string">`<span class="hljs-subst">${defaultHeaderPrefix}</span>/<span class="hljs-subst">${libraryName}</span>/`</span>;
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">composePath</span>(<span class="hljs-params">intermediate</span>) {
      <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">join</span>(outputDirectory, intermediate, libraryName);
    }
    <span class="hljs-keyword">const</span> componentIOSOutput = <span class="hljs-title function_">composePath</span>(
      useLocalIncludePaths === <span class="hljs-literal">true</span> ? <span class="hljs-string">''</span> : defaultHeaderPrefix,
    );
    <span class="hljs-keyword">const</span> modulesIOSOutput = <span class="hljs-title function_">composePath</span>(<span class="hljs-string">'./'</span>);
    <span class="hljs-keyword">const</span> outputFoldersForGenerators = {
      <span class="hljs-attr">componentsIOS</span>: componentIOSOutput,
      <span class="hljs-attr">modulesIOS</span>: modulesIOSOutput,
      <span class="hljs-attr">descriptors</span>: outputDirectory,
      <span class="hljs-attr">events</span>: outputDirectory,
      <span class="hljs-attr">props</span>: outputDirectory,
      <span class="hljs-attr">states</span>: outputDirectory,
      <span class="hljs-attr">componentsAndroid</span>: outputDirectory,
      <span class="hljs-attr">modulesAndroid</span>: outputDirectory,
      <span class="hljs-attr">modulesCxx</span>: outputDirectory,
      <span class="hljs-attr">tests</span>: outputDirectory,
      <span class="hljs-string">'shadow-nodes'</span>: outputDirectory,
    };
    <span class="hljs-keyword">const</span> generatedFiles = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> name <span class="hljs-keyword">of</span> generators) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> generator <span class="hljs-keyword">of</span> libraryGenerators[name]) {
        <span class="hljs-title function_">generator</span>(
          libraryName,
          schema,
          packageName,
          assumeNonnull,
          headerPrefix,
          includeGetDebugPropsImplementation,
        ).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">contents, fileName</span>) =&gt;</span> {
          generatedFiles.<span class="hljs-title function_">push</span>({
            <span class="hljs-attr">name</span>: fileName,
            <span class="hljs-attr">content</span>: contents,
            <span class="hljs-attr">outputDir</span>: outputFoldersForGenerators[name],
          });
        });
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">checkOrWriteFiles</span>(generatedFiles, test);
  },
  <span class="hljs-comment">// çœç•¥......</span>
};
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œ<code>for (const name of generators)</code>éå†çš„<strong>generators</strong>å°±æ˜¯æˆ‘ä»¬å‰é¢å¼ºè°ƒè¿‡çš„<strong>GENERATORS</strong>å‚æ•°å¤„ç†ã€‚é‚£ä¹ˆæ­¤æ—¶<code>name</code>çš„å€¼å°±æ˜¯<code>componentsAndroid</code>ã€‚</p>
<p>æ—¢ç„¶ç¡®å®šäº†å‚æ•°ï¼Œé‚£ä¹ˆä»<code>libraryGenerators</code>ä¸­éå†å‡ºæ¥çš„<code>generator</code>å°±æ˜¯ä»¥ä¸‹è¿™äº›ç”Ÿæˆå™¨ï¼š</p>
<pre><code class="hljs language-js" lang="js">  <span class="hljs-attr">componentsAndroid</span>: [
    <span class="hljs-comment">// JNI/C++ files</span>
    generateComponentDescriptorH.<span class="hljs-property">generate</span>,
    generateComponentDescriptorCpp.<span class="hljs-property">generate</span>,
    generateEventEmitterCpp.<span class="hljs-property">generate</span>,
    generateEventEmitterH.<span class="hljs-property">generate</span>,
    generatePropsCpp.<span class="hljs-property">generate</span>,
    generatePropsH.<span class="hljs-property">generate</span>,
    generateStateCpp.<span class="hljs-property">generate</span>,
    generateStateH.<span class="hljs-property">generate</span>,
    generateShadowNodeCpp.<span class="hljs-property">generate</span>,
    generateShadowNodeH.<span class="hljs-property">generate</span>,
    <span class="hljs-comment">// Java files</span>
    generatePropsJavaInterface.<span class="hljs-property">generate</span>,
    generatePropsJavaDelegate.<span class="hljs-property">generate</span>,
  ],
</code></pre>
<p>è¿™é‡Œå…ˆç ”ç©¶ä¸€ä¸‹<code>generateComponentDescriptorH.generate</code>å’Œ<code>generateComponentDescriptorCpp.generate</code>ã€‚</p>
<p>æºç <code>react-native/packages/react-native-codegen/src/generators/components/GenerateComponentDescriptorH.js</code>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">FileTemplate</span> = (<span class="hljs-params">{
  libraryName,
  componentDefinitions,
  headerPrefix,
}: {
  libraryName: string,
  componentDefinitions: string,
  headerPrefix: string,
}</span>) =&gt; <span class="hljs-string">`
/**
 * This code was generated by [react-native-codegen](https://www.npmjs.com/package/react-native-codegen).
 *
 * Do not edit this file as changes may cause incorrect behavior and will be lost
 * once the code is regenerated.
 *
 * <span class="hljs-subst">${<span class="hljs-string">'@'</span>}</span>generated by codegen project: GenerateComponentDescriptorH.js
 */

#pragma once

<span class="hljs-subst">${IncludeTemplate({headerPrefix, file: <span class="hljs-string">'ShadowNodes.h'</span>})}</span>
#include &lt;react/renderer/core/ConcreteComponentDescriptor.h&gt;
#include &lt;react/renderer/componentregistry/ComponentDescriptorProviderRegistry.h&gt;

namespace facebook::react {

<span class="hljs-subst">${componentDefinitions}</span>

void <span class="hljs-subst">${libraryName}</span>_registerComponentDescriptorsFromCodegen(
  std::shared_ptr&lt;const ComponentDescriptorProviderRegistry&gt; registry);

} // namespace facebook::react
`</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">ComponentDefinitionTemplate</span> = (<span class="hljs-params">{className}: {className: string}</span>) =&gt;
  <span class="hljs-string">`
using <span class="hljs-subst">${className}</span>ComponentDescriptor = ConcreteComponentDescriptor&lt;<span class="hljs-subst">${className}</span>ShadowNode&gt;;
`</span>.<span class="hljs-title function_">trim</span>();

<span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>
</code></pre>
<p>è¿™é‡Œæˆ‘ä»¬åªç®€å•çœ‹ä¸€ä¸‹ç”¨äºå¤´æ–‡ä»¶ç”Ÿæˆçš„å­—ç¬¦ä¸²æ¨¡ç‰ˆã€‚<code>libraryName</code>å‚æ•°å–å€¼æˆ‘ä»¬ä¸Šé¢å·²ç»åˆ†æè¿‡äº†ï¼Œæ¥è‡ª<code>package.json</code>ä¸­çš„é…ç½®é¡¹ã€‚é‚£ä¹ˆè¿˜æœ‰ä¸€ä¸ªå…³é”®å‚æ•°<code>className</code>çš„å–å€¼éœ€è¦å¼„æ¸…æ¥šã€‚å®é™…ä¸Šè¿™é‡Œçš„<code>componentDefinitions</code>å’Œ<code>className</code>éƒ½æ¥è‡ªäº<code>schema.json</code>ã€‚å…·ä½“çœ‹ä¸€ä¸‹classNameç”Ÿæˆé€»è¾‘ï¼š</p>
<pre><code class="hljs language-js" lang="js">    <span class="hljs-keyword">const</span> componentDefinitions = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(schema.<span class="hljs-property">modules</span>)
      .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">moduleName</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = schema.<span class="hljs-property">modules</span>[moduleName];
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">module</span>.<span class="hljs-property">type</span> !== <span class="hljs-string">'Component'</span>) {
          <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">const</span> {components} = <span class="hljs-variable language_">module</span>;
        <span class="hljs-comment">// No components in this module</span>
        <span class="hljs-keyword">if</span> (components == <span class="hljs-literal">null</span>) {
          <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }

        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(components)
          .<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">componentName</span> =&gt;</span> {
            <span class="hljs-keyword">if</span> (components[componentName].<span class="hljs-property">interfaceOnly</span> === <span class="hljs-literal">true</span>) {
              <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-keyword">return</span> <span class="hljs-title class_">ComponentDefinitionTemplate</span>({<span class="hljs-attr">className</span>: componentName});
          })
          .<span class="hljs-title function_">join</span>(<span class="hljs-string">'\n'</span>);
      })
      .<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>)
      .<span class="hljs-title function_">join</span>(<span class="hljs-string">'\n'</span>);

    <span class="hljs-keyword">const</span> replacedTemplate = <span class="hljs-title class_">FileTemplate</span>({
      libraryName,
      componentDefinitions,
      <span class="hljs-attr">headerPrefix</span>: headerPrefix ?? <span class="hljs-string">''</span>,
    });
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå®é™…ä¸Šæ˜¯åœ¨éå†<code>schema.json</code>ä¸­çš„<code>components</code>å­—æ®µã€‚åœ¨å£°æ˜ç»„ä»¶ä¸€èŠ‚å·²ç»åˆ›å»ºäº†Demoå·¥ç¨‹ï¼Œç°åœ¨æ„å»ºé¡¹ç›®ç”Ÿæˆ<code>schema.json</code>ï¼ŒæŸ¥çœ‹ç›¸å…³å†…å®¹ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"libraryName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"modules"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"CustomWebView"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Component"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"components"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"CustomWebView"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"extendsProps"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
              <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ReactNativeBuiltInType"</span><span class="hljs-punctuation">,</span>
              <span class="hljs-attr">"knownTypeName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ReactNativeCoreViewProps"</span>
            <span class="hljs-punctuation">}</span>
          <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"events"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>çœç•¥......<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"props"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>çœç•¥......<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"commands"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>é‚£ä¹ˆ<code>className</code>å°±æ˜¯<code>componentName</code>ï¼Œä¹Ÿå°±æ˜¯è‡ªå®šä¹‰çš„ç»„ä»¶å<strong>CustomWebView</strong>ã€‚</p>
<h5 data-id="heading-9">C++ å±‚</h5>
<p>å¼„æ¸…æ¥šä»£ç ç”Ÿæˆçš„é€»è¾‘ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æŸ¥çœ‹ç”Ÿæˆçš„æ–‡ä»¶å†…å®¹ï¼Œä¸»è¦æ˜¯<code>ComponentDescriptors.h</code></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">pragma</span> once</span>

<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;react/renderer/components/CustomviewViewSpec/ShadowNodes.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;react/renderer/core/ConcreteComponentDescriptor.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;react/renderer/componentregistry/ComponentDescriptorProviderRegistry.h&gt;</span></span>

<span class="hljs-keyword">namespace</span> facebook::react {

<span class="hljs-keyword">using</span> CustomWebViewComponentDescriptor = ConcreteComponentDescriptor&lt;CustomWebViewShadowNode&gt;;

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CustomviewViewSpec_registerComponentDescriptorsFromCodegen</span><span class="hljs-params">(
  std::shared_ptr&lt;<span class="hljs-type">const</span> ComponentDescriptorProviderRegistry&gt; registry)</span></span>;
}
</code></pre>
<p><code>ComponentDescriptors.cpp</code></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;react/renderer/components/CustomviewViewSpec/ComponentDescriptors.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;react/renderer/core/ConcreteComponentDescriptor.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;react/renderer/componentregistry/ComponentDescriptorProviderRegistry.h&gt;</span></span>

<span class="hljs-keyword">namespace</span> facebook::react {

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CustomviewViewSpec_registerComponentDescriptorsFromCodegen</span><span class="hljs-params">(
  std::shared_ptr&lt;<span class="hljs-type">const</span> ComponentDescriptorProviderRegistry&gt; registry)</span> </span>{
registry-&gt;<span class="hljs-built_in">add</span>(<span class="hljs-built_in">concreteComponentDescriptorProvider</span>&lt;CustomWebViewComponentDescriptor&gt;());
}

}
</code></pre>
<p>å¤´æ–‡ä»¶å®šä¹‰äº†ä¸€ä¸ªç±»å‹åˆ«å<code>CustomWebViewComponentDescriptor</code>ï¼Œç„¶ååœ¨å®ç°æ–‡ä»¶ä¸­æ³¨å†Œäº†è¿™ä¸ªProviderã€‚æˆ‘ä»¬çœ‹ä¸€ä¸‹<code>concreteComponentDescriptorProvider</code>å‡½æ•°çš„å®ç°ï¼Œæºç <code>react-native/packages/react-native/ReactCommon/react/renderer/componentregistry/ComponentDescriptorProvider.h</code>:</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">/*
* ä¸ºç»™å®šçš„ `ComponentDescriptor` ç±»åˆ›å»ºä¸€ä¸ª `ComponentDescriptorProvider`
*/</span>
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> ComponentDescriptorT&gt;
<span class="hljs-function">ComponentDescriptorProvider <span class="hljs-title">concreteComponentDescriptorProvider</span><span class="hljs-params">()</span>
</span>{
  <span class="hljs-built_in">static_assert</span>(
      std::is_base_of&lt;ComponentDescriptor, ComponentDescriptorT&gt;::value,
      <span class="hljs-string">"ComponentDescriptorT must be a descendant of ComponentDescriptor"</span>);

  <span class="hljs-keyword">return</span> {
      ComponentDescriptorT::ConcreteShadowNode::<span class="hljs-built_in">Handle</span>(),
      ComponentDescriptorT::ConcreteShadowNode::<span class="hljs-built_in">Name</span>(),
      <span class="hljs-literal">nullptr</span>,
      &amp;concreteComponentDescriptorConstructor&lt;ComponentDescriptorT&gt;};
}
</code></pre>
<p>è¿”å›å€¼æ˜¯ä¸€ä¸ª<code>ComponentDescriptorProvider</code>ç±»å‹å®ä¾‹ï¼Œç»§ç»­è·Ÿè¸ªä¸€ä¸‹ç±»å®šä¹‰ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">/*
 * æä¾›äº†ä¸€ç§ç»Ÿä¸€çš„æ–¹å¼æ¥æ„é€ ç‰¹å®šå­˜å‚¨çš„ `ComponentDescriptor` ç±»çš„å®ä¾‹ã€‚ 
 * C++ ä¸å…è®¸åˆ›å»ºæŒ‡å‘æ„é€ å‡½æ•°çš„æŒ‡é’ˆï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»ä½¿ç”¨è¿™æ ·çš„æ•°æ®ç»“æ„æ¥æ“ä½œä¸€ç»„ç±»ã€‚
 *
 * æ³¨æ„ï¼šæŸäº›ç»„ä»¶çš„ `handle` å’Œ `name` çš„å®é™…å€¼å–å†³äº `flavor`ã€‚ 
 * å¦‚æœä½¿ç”¨ç»™å®šçš„ `flavor` é€šè¿‡ `constructor` å¯¹è±¡å®ä¾‹åŒ–åï¼Œ
 * Provideræš´éœ²çš„ `handle` å’Œ `name` å€¼ä¸é¢„æœŸå€¼ç›¸åŒï¼Œåˆ™è¯¥æä¾›è€…æœ‰æ•ˆã€‚ 
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ComponentDescriptorProvider</span> <span class="hljs-keyword">final</span> {
 <span class="hljs-keyword">public</span>:
  ComponentHandle handle;
  ComponentName name;
  ComponentDescriptor::Flavor flavor;
  ComponentDescriptorConstructor *constructor;
};
</code></pre>
<p>è¿™é‡Œå¤§é‡ä½¿ç”¨äº†C++æ¨¡ç‰ˆï¼Œè¦æƒ³æŸ¥çœ‹çœŸæ­£çš„handleå’Œnameå€¼ï¼Œéœ€è¦å½“å®é™…çš„æ¨¡ç‰ˆç±»å‹ä¸­æŸ¥æ‰¾ã€‚è¿™é‡Œå…ˆæŸ¥çœ‹æºç <code>react-native/packages/react-native/ReactCommon/react/renderer/core/ConcreteComponentDescriptor.h</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">namespace</span> facebook::react {

<span class="hljs-comment">/*
 * Default template-based implementation of ComponentDescriptor.
 * Use your `ShadowNode` type as a template argument and override any methods
 * if necessary.
 */</span>
<span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> ShadowNodeT&gt;
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteComponentDescriptor</span> : <span class="hljs-keyword">public</span> ComponentDescriptor {
  <span class="hljs-built_in">static_assert</span>(std::is_base_of&lt;ShadowNode, ShadowNodeT&gt;::value, <span class="hljs-string">"ShadowNodeT must be a descendant of ShadowNode"</span>);

  <span class="hljs-keyword">using</span> SharedShadowNodeT = std::shared_ptr&lt;<span class="hljs-type">const</span> ShadowNodeT&gt;;

 <span class="hljs-keyword">public</span>:
  <span class="hljs-keyword">using</span> ConcreteShadowNode = ShadowNodeT;

  <span class="hljs-comment">// çœç•¥ä»£ç ......</span>
} <span class="hljs-comment">// namespace facebook::react</span>
</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>ConcreteShadowNode</code>å®é™…ä¸Šåªæ˜¯ä¸€ä¸ªç±»å‹åˆ«åï¼Œå…·ä½“çš„è¦çœ‹æ¨¡ç‰ˆçš„å®é™…å‚æ•°ï¼Œé‚£ä¹ˆ<code>ConcreteShadowNode::Handle</code>å°±ç›¸å½“äº<code>CustomWebViewShadowNode::Handle</code>ã€‚è¿™é‡Œ<code>CustomWebViewShadowNode</code>ä¹Ÿæ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥çœ‹<code>android/app/build/generated/source/codegen/jni/react/renderer/components/CustomviewViewSpec/ShadowNodes.h</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">/*
 * `ShadowNode` for &lt;CustomWebView&gt; component.
 */</span>
<span class="hljs-keyword">using</span> CustomWebViewShadowNode = ConcreteViewShadowNode&lt;
    CustomWebViewComponentName,
    CustomWebViewProps,
    CustomWebViewEventEmitter,
    CustomWebViewState&gt;;
</code></pre>
<p>ç»§ç»­æŸ¥çœ‹<code>android/app/build/generated/source/codegen/jni/react/renderer/components/CustomviewViewSpec/ShadowNodes.cpp</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;react/renderer/components/CustomviewViewSpec/ShadowNodes.h&gt;</span></span>

<span class="hljs-keyword">namespace</span> facebook::react {

<span class="hljs-keyword">extern</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> CustomWebViewComponentName[] = <span class="hljs-string">"CustomWebView"</span>;

} 
</code></pre>
<p>ç°åœ¨è·Ÿè¸ªä¸€ä¸‹<code>react-native/packages/react-native/ReactCommon/react/renderer/components/view/ConcreteViewShadowNode.h</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">namespace</span> facebook::react {

<span class="hljs-comment">/*
 * Template for all &lt;View&gt;-like classes (classes which have all same props
 * as &lt;View&gt; and similar basic behaviour).
 * For example: &lt;Paragraph&gt;, &lt;Image&gt;, but not &lt;Text&gt;, &lt;RawText&gt;.
 */</span>
<span class="hljs-keyword">template</span> &lt;
    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *concreteComponentName,
    <span class="hljs-keyword">typename</span> ViewPropsT = ViewProps,
    <span class="hljs-keyword">typename</span> ViewEventEmitterT = ViewEventEmitter,
    <span class="hljs-keyword">typename</span> StateDataT = StateData&gt;
  <span class="hljs-built_in">requires</span>(std::is_base_of_v&lt;ViewProps, ViewPropsT&gt;)
<span class="hljs-keyword">class</span> ConcreteViewShadowNode : <span class="hljs-keyword">public</span> ConcreteShadowNode&lt;
                                   concreteComponentName,
                                   YogaLayoutableShadowNode,
                                   ViewPropsT,
                                   ViewEventEmitterT,
                                   StateDataT&gt; {
  <span class="hljs-comment">// çœç•¥ä»£ç ......</span>
};

} <span class="hljs-comment">// namespace facebook::react</span>
</code></pre>
<p><code>ConcreteViewShadowNode</code>ç±»ä¸­å¹¶æœªå®ç°<code>Handle</code>å’Œ<code>Name</code>æ–¹æ³•ï¼Œç»§ç»­æŸ¥çœ‹çˆ¶ç±»<code>react-native/packages/react-native/ReactCommon/react/renderer/core/ConcreteShadowNode.h</code></p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">namespace</span> facebook::react {

<span class="hljs-comment">/*
 * Base templace class for all `ShadowNode`s which connects exact `ShadowNode`
 * type with exact `Props` type.
 * `ConcreteShadowNode` is a default implementation of `ShadowNode` interface
 * with many handy features.
 */</span>
<span class="hljs-keyword">template</span> &lt;
    ComponentName concreteComponentName,
    <span class="hljs-keyword">typename</span> BaseShadowNodeT,
    <span class="hljs-keyword">typename</span> PropsT,
    <span class="hljs-keyword">typename</span> EventEmitterT = EventEmitter,
    <span class="hljs-keyword">typename</span> StateDataT = StateData&gt;
<span class="hljs-keyword">class</span> ConcreteShadowNode : <span class="hljs-keyword">public</span> BaseShadowNodeT {

 <span class="hljs-keyword">protected</span>:
  <span class="hljs-keyword">using</span> ShadowNode::props_;
  <span class="hljs-keyword">using</span> ShadowNode::state_;

 <span class="hljs-keyword">public</span>:
  <span class="hljs-keyword">using</span> BaseShadowNodeT::BaseShadowNodeT;
  <span class="hljs-comment">// çœç•¥......</span>

  <span class="hljs-function"><span class="hljs-type">static</span> ComponentName <span class="hljs-title">Name</span><span class="hljs-params">()</span>
  </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">ComponentName</span>(concreteComponentName);
  }

  <span class="hljs-function"><span class="hljs-type">static</span> ComponentHandle <span class="hljs-title">Handle</span><span class="hljs-params">()</span>
  </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">ComponentHandle</span>(concreteComponentName);
  }

  <span class="hljs-comment">// çœç•¥......</span>
};

} <span class="hljs-comment">// namespace facebook::react</span>
</code></pre>
<p>åˆ°è¿™é‡Œå°±å¾ˆæ¸…æ™°äº†ï¼ŒNameå’ŒHandleæ–¹æ³•è¿”å›å€¼å†…éƒ¨æ˜¯æŒæœ‰çš„ç›¸åŒçš„<code>concreteComponentName</code>ï¼Œè€Œè¿™ä¸ªæ¨¡ç‰ˆå‚æ•°ï¼Œæ ¹æ®å‰é¢çš„ä¼ å‚ï¼Œå®é™…æ˜¯å°±æ˜¯</p>
<p><code>CustomWebViewComponentName</code>ï¼Œä¹Ÿå°±æ˜¯<code>"CustomWebView"</code>ã€‚</p>
<p>æ‰«æFabric ç»„ä»¶åº“ï¼Œç”Ÿæˆä»£ç çš„é€»è¾‘å…¶å®å·²ç»å¾ˆæ¸…æ¥šäº†ï¼Œæœ€ååªå‰©ä¸‹ä¸€ä¸ªé—®é¢˜ï¼ŒçœŸæ­£è°ƒç”¨æ³¨å†Œçš„ä»£ç åœ¨å“ªé‡Œï¼Ÿäº‹å®ä¸Šï¼Œå®‰å“ä¸­å¹¶æœªçœŸæ­£é€šè¿‡<code>CustomviewViewSpec_registerComponentDescriptorsFromCodegen</code>å‡½æ•°å»æ³¨å†Œï¼Œè€Œæ˜¯ä½¿ç”¨äº†autolinkingæœºåˆ¶ã€‚è¿™éƒ¨åˆ†åœ¨ã€ŠAndroidç«¯TurboModuleåˆ†æã€‹ä¸€æ–‡æœ‰è¯¦ç»†ä»‹ç»äº†ï¼Œå¯ä»¥å»å›é¡¾ä¸€ä¸‹<code>GenerateAutolinkingNewArchitecturesFileTask</code>è„šæœ¬çš„åˆ†æï¼Œå…¶ä¸­ç”Ÿæˆçš„ä¿¡æ¯æºå°±æ¥è‡ªæˆ‘ä»¬å‰é¢è´¹äº†åŠå¤©åŠ²åˆ†æçš„<code>autolinking.json</code>ä¸­çš„</p>
<p>ç°åœ¨æ¥çœ‹ä¸€ä¸‹Gradleè„šæœ¬ç”Ÿæˆçš„<code>autolinking.cpp</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"autolinking.h"</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;CustomviewViewSpec.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;react/renderer/components/CustomviewViewSpec/ComponentDescriptors.h&gt;</span></span>

<span class="hljs-keyword">namespace</span> facebook {
<span class="hljs-keyword">namespace</span> react {

<span class="hljs-function">std::shared_ptr&lt;TurboModule&gt; <span class="hljs-title">autolinking_ModuleProvider</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string moduleName, <span class="hljs-type">const</span> JavaTurboModule::InitParams &amp;params)</span> </span>{
<span class="hljs-keyword">auto</span> module_CustomviewViewSpec = <span class="hljs-built_in">CustomviewViewSpec_ModuleProvider</span>(moduleName, params);
<span class="hljs-keyword">if</span> (module_CustomviewViewSpec != <span class="hljs-literal">nullptr</span>) {
<span class="hljs-keyword">return</span> module_CustomviewViewSpec;
}
  <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
}

<span class="hljs-function">std::shared_ptr&lt;TurboModule&gt; <span class="hljs-title">autolinking_cxxModuleProvider</span><span class="hljs-params">(<span class="hljs-type">const</span> std::string moduleName, <span class="hljs-type">const</span> std::shared_ptr&lt;CallInvoker&gt;&amp; jsInvoker)</span> </span>{

  <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;
}

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">autolinking_registerProviders</span><span class="hljs-params">(std::shared_ptr&lt;ComponentDescriptorProviderRegistry <span class="hljs-type">const</span>&gt; providerRegistry)</span> </span>{
providerRegistry-&gt;<span class="hljs-built_in">add</span>(<span class="hljs-built_in">concreteComponentDescriptorProvider</span>&lt;CustomWebViewComponentDescriptor&gt;());
  <span class="hljs-keyword">return</span>;
}

} <span class="hljs-comment">// namespace react</span>
} <span class="hljs-comment">// namespace facebook</span>
</code></pre>
<p>è¿™é‡Œç”Ÿæˆäº†<code>autolinking_registerProviders</code>æ–¹æ³•ï¼Œè¿™æ‰æ˜¯çœŸæ­£æ³¨å†Œç»„ä»¶çš„åœ°æ–¹ã€‚è€Œæ­¤å¤„çš„ä»£ç æ˜¯ç”±Gradleè„šæœ¬ç”Ÿæˆï¼Œå…¶ä¸­çš„å…³é”®ä¿¡æ¯å°±æ¥è‡ª<code>autolinking.json</code>ä¸­çš„<code>componentDescriptors</code>å­—æ®µï¼Œä¹Ÿå°±æ˜¯å‰é¢æˆ‘ä»¬è´¹äº†åŠå¤©åŠ²æ‰åˆ†æå‡ºè¯¥å­—æ®µçš„é»˜è®¤å€¼çš„åœ°æ–¹ã€‚æ•´ä¸ªReact Nativeçš„ä»£ç ç”Ÿæˆå…¶å®æ˜¯æœ‰äº›æ··ä¹±çš„ï¼Œä¼šç”Ÿæˆä¸€äº›å¹¶ä¸ä¼šä½¿ç”¨çš„ä»£ç ï¼Œå¯¹ç†è§£äº§ç”Ÿå¹²æ‰°ã€‚</p>
<p>å…³äº<code>autolinking_registerProviders</code>å‡½æ•°çš„è°ƒç”¨é“¾ï¼Œåœ¨å‰é¢çš„æ–‡ç« ä¹Ÿåˆ†ææ¶‰åŠè¿‡ï¼Œè¿™é‡Œå†å›é¡¾ä¸€ä¸‹è°ƒç”¨æµç¨‹ï¼Œæºç <code>react-native/packages/react-native/ReactAndroid/cmake-utils/default-app-setup/OnLoad.cpp</code>ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">namespace</span> facebook::react {

<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">registerComponents</span><span class="hljs-params">(
    std::shared_ptr&lt;<span class="hljs-type">const</span> ComponentDescriptorProviderRegistry&gt; registry)</span> </span>{
  <span class="hljs-comment">// è‡ªå®šä¹‰ Fabric ç»„ä»¶æ”¾åœ¨è¿™é‡Œã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„æ³¨å†Œæ¥è‡ªæ‚¨çš„åº”ç”¨ç¨‹åºæˆ–ç¬¬ä¸‰æ–¹åº“çš„è‡ªå®šä¹‰ç»„ä»¶</span>
  <span class="hljs-comment">// providerRegistry-&gt;add(concreteComponentDescriptorProvider&lt;</span>
  <span class="hljs-comment">//        MyComponentDescriptor&gt;());</span>

  <span class="hljs-comment">// We link app local components if available</span>
<span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> REACT_NATIVE_APP_COMPONENT_REGISTRATION</span>
  <span class="hljs-built_in">REACT_NATIVE_APP_COMPONENT_REGISTRATION</span>(registry);
<span class="hljs-meta">#<span class="hljs-keyword">endif</span></span>

  <span class="hljs-comment">// And we fallback to the components autolinked</span>
  <span class="hljs-built_in">autolinking_registerProviders</span>(registry);
}

<span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>

} <span class="hljs-comment">// namespace facebook::react</span>

<span class="hljs-function">JNIEXPORT jint JNICALL <span class="hljs-title">JNI_OnLoad</span><span class="hljs-params">(JavaVM* vm, <span class="hljs-type">void</span>*)</span> </span>{
  <span class="hljs-keyword">return</span> facebook::jni::<span class="hljs-built_in">initialize</span>(vm, [] {
    facebook::react::DefaultTurboModuleManagerDelegate::cxxModuleProvider =
        &amp;facebook::react::cxxModuleProvider;
    facebook::react::DefaultTurboModuleManagerDelegate::javaModuleProvider =
        &amp;facebook::react::javaModuleProvider;
    facebook::react::DefaultComponentsRegistry::
        registerComponentDescriptorsFromEntryPoint =
            &amp;facebook::react::registerComponents;
  });
}
</code></pre>
<p>å¯è§ï¼Œæ³¨å†Œçš„èµ·ç‚¹ä¹Ÿæ˜¯<code>JNI_OnLoad</code>å‡½æ•°ã€‚</p>
<h5 data-id="heading-10">Kotlinå±‚</h5>
<p>ä½¿ç”¨<code>npx create-react-native-library@latest</code>å·¥å…·åˆ›å»ºä¸€ä¸ªFabricç»„ä»¶åº“æ—¶ï¼Œä¼šç”Ÿæˆä¸€äº›æ¨¡ç‰ˆä»£ç ï¼Œå…¶ä¸­åŒ…æ‹¬æˆ‘ä»¬ä¸Šé¢æåˆ°çš„<code>CustomWebViewManager</code>ç±»ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>CustomWebViewPackage</code>ç±»ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomWebViewPackage</span> : <span class="hljs-type">ReactPackage</span> {
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createViewManagers</span><span class="hljs-params">(reactContext: <span class="hljs-type">ReactApplicationContext</span>)</span></span>: List&lt;ViewManager&lt;*, *&gt;&gt; {
    <span class="hljs-keyword">val</span> viewManagers: MutableList&lt;ViewManager&lt;*, *&gt;&gt; = ArrayList()
    viewManagers.add(CustomWebViewManager())
    <span class="hljs-keyword">return</span> viewManagers
  }

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createNativeModules</span><span class="hljs-params">(reactContext: <span class="hljs-type">ReactApplicationContext</span>)</span></span>: List&lt;NativeModule&gt; {
    <span class="hljs-keyword">return</span> emptyList()
  }
}
</code></pre>
<p>è¿™é‡Œ<code>createViewManagers</code>æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª<code>ViewManager</code>çš„å®ä¾‹åˆ—è¡¨ã€‚æ ¹æ®æˆ‘ä»¬åœ¨<a href="https://juejin.cn/post/7595178023256211475" target="_blank" title="https://juejin.cn/post/7595178023256211475">ã€ŠReactNativeæ–°æ¶æ„ä¹‹Androidç«¯TurboModuleæœºåˆ¶å®Œå…¨è§£æã€‹</a>ä¸€æ–‡ä¸­åˆ†æ<code>GeneratePackageListTask</code>ä»»åŠ¡çš„ç»“æœï¼Œæˆ‘ä»¬çŸ¥é“æœ€ç»ˆä¼šç”Ÿæˆä¸€ä¸ª<code>PackageList</code>æ–‡ä»¶ï¼Œå…¶ä¸­ä¼šæ³¨å…¥æ¯ä¸ªä¸‰æ–¹TurboModuleæˆ–Fabricç»„ä»¶åŒ…ä¸­çš„<strong>ReactPackage</strong>å®ç°ç±»ã€‚</p>
<p>ç°åœ¨æ¥æŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬ç¤ºä¾‹å·¥ç¨‹ç”Ÿæˆçš„<code>example/android/app/build/generated/autolinking/src/main/java/com/facebook/react/PackageList.java</code>æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PackageList</span> {
  <span class="hljs-keyword">private</span> Application application;
  <span class="hljs-keyword">private</span> ReactNativeHost reactNativeHost;
  <span class="hljs-keyword">private</span> MainPackageConfig mConfig;

  <span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç ......</span>

  <span class="hljs-keyword">public</span> ArrayList&lt;ReactPackage&gt; <span class="hljs-title function_">getPackages</span><span class="hljs-params">()</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;(Arrays.&lt;ReactPackage&gt;asList(
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">MainReactPackage</span>(mConfig),
      <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomWebViewPackage</span>()
    ));
  }
}
</code></pre>
<p>å›é¡¾ä¸€ä¸‹æœ¬æ–‡å¼€å¤´çš„åˆå§‹åŒ–éƒ¨åˆ†ï¼Œæˆ‘ä»¬æåˆ°è¿‡ä»¥ä¸‹ä»£ç </p>
<pre><code class="hljs language-kotlin" lang="kotlin">fabricUIManager =
    FabricUIManager(context, ViewManagerRegistry(viewManagerResolver), eventBeatManager)
</code></pre>
<p>ç°åœ¨å›é¡¾ä¸€ä¸‹<a href="https://juejin.cn/post/7594627998839406634" target="_blank" title="https://juejin.cn/post/7594627998839406634">ã€ŠReact Nativeæ–°æ¶æ„ä¹‹Androidç«¯åˆå§‹åŒ–æºç åˆ†æã€‹</a>ä¸€æ–‡ï¼Œåœ¨<code>ReactInstance</code>ç±»æ„é€ æ—¶ï¼Œæœ‰å¦‚ä¸‹åˆå§‹åŒ–é€»è¾‘ï¼š</p>
<pre><code class="hljs language-kotlin" lang="kotlin">    viewManagerResolver = BridgelessViewManagerResolver(reactPackages, context)

    ComponentNameResolverBinding.install(
        unbufferedRuntimeExecutor,
        <span class="hljs-keyword">object</span> : ComponentNameResolver {
          <span class="hljs-keyword">override</span> <span class="hljs-keyword">val</span> componentNames: Array&lt;String&gt;
            <span class="hljs-keyword">get</span>() {
              <span class="hljs-keyword">val</span> viewManagerNames = viewManagerResolver.getViewManagerNames()
              <span class="hljs-keyword">if</span> (viewManagerNames.isEmpty()) {
                FLog.e(TAG, <span class="hljs-string">"No ViewManager names found"</span>)
                <span class="hljs-keyword">return</span> arrayOf()
              }
              <span class="hljs-keyword">return</span> viewManagerNames.toTypedArray&lt;String&gt;()
            }
        },
    )
</code></pre>
<p>ç»“åˆä¸Šä¸€èŠ‚<strong>æŸ¥æ‰¾ç»„ä»¶</strong> kotlinå±‚å®ç°çš„åˆ†æï¼Œæ•´ä¸ªæµç¨‹éƒ½ååˆ†æ¸…æ™°äº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[# Spring Securityæ•´åˆJWTä¸Rediså®ç°æƒé™è®¤è¯]]></title>    <link>https://juejin.cn/post/7597058147749199882</link>    <guid>https://juejin.cn/post/7597058147749199882</guid>    <pubDate>2026-01-20T09:20:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597058147749199882" data-draft-id="7597080391880474634" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="# Spring Securityæ•´åˆJWTä¸Rediså®ç°æƒé™è®¤è¯"/> <meta itemprop="keywords" content="Java"/> <meta itemprop="datePublished" content="2026-01-20T09:20:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŠ€æœ¯ç‹‚å°å­"/> <meta itemprop="url" content="https://juejin.cn/user/4408380772066938"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            # Spring Securityæ•´åˆJWTä¸Rediså®ç°æƒé™è®¤è¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4408380772066938/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŠ€æœ¯ç‹‚å°å­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:20:57.000Z" title="Tue Jan 20 2026 09:20:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Spring Securityæ•´åˆJWTä¸Rediså®ç°æƒé™è®¤è¯</h2>
<blockquote>
<p><strong>ä½œè€…ï¼šæŠ€æœ¯ç‹‚å°å­</strong><br/>
<strong>å‘å¸ƒäºï¼šCSDN Â· Javaè¿›é˜¶å®æˆ˜ä¸“æ </strong><br/>
<strong>æ—¶é—´ï¼š2026å¹´1æœˆ20æ—¥</strong></p>
</blockquote>
<hr/>
<p>æœ€è¿‘åœ¨é‡æ„å…¬å¸ä¸€ä¸ªè€é¡¹ç›®ï¼ŒåŸæ¥çš„æƒé™ç³»ç»Ÿæ˜¯åŸºäº Session çš„ï¼Œéƒ¨ç½²åˆ°é›†ç¾¤ç¯å¢ƒåå„ç§é—®é¢˜é¢‘å‡ºâ€”â€”Session æ— æ³•å…±äº«ã€ç™»å½•çŠ¶æ€ä¸ä¸€è‡´ã€ç™»å‡ºå Token æ— æ³•ç«‹å³å¤±æ•ˆâ€¦â€¦äºæ˜¯å†³å®šå½»åº•æ¢æˆ JWT + Redis çš„æ–¹æ¡ˆã€‚æŠ˜è…¾äº†å‡ å¤©ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œä¹Ÿç†æ¸…äº†ä¸€äº›å…³é”®ç‚¹ï¼Œä»Šå¤©å°±æ¥æ‰‹æŠŠæ‰‹å¸¦å¤§å®¶æŠŠè¿™å¥—æƒé™ä½“ç³»æ­èµ·æ¥ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸ºä»€ä¹ˆé€‰ JWT + Redisï¼Ÿ</h3>
<p>å…ˆè¯´ç»“è®ºï¼š<strong>çº¯ JWT ä¸é€‚åˆéœ€è¦å¼ºæ§åˆ¶ç™»å½•çŠ¶æ€çš„ä¸šåŠ¡åœºæ™¯</strong>ã€‚</p>
<p>JWT æœ¬èº«æ˜¯æ— çŠ¶æ€çš„ï¼Œç­¾å‘ä¹‹åæœåŠ¡ç«¯å°±â€œæ”¾æ‰‹ä¸ç®¡â€äº†ã€‚ä½†ç°å®éœ€æ±‚å¾€å¾€æ˜¯ï¼š</p>
<ul>
<li>ç”¨æˆ·ä¿®æ”¹å¯†ç åï¼Œæ—§ Token åº”è¯¥ç«‹å³å¤±æ•ˆï¼›</li>
<li>ç®¡ç†å‘˜å¼ºåˆ¶ä¸‹çº¿æŸä¸ªç”¨æˆ·ï¼›</li>
<li>æ”¯æŒâ€œå•è®¾å¤‡ç™»å½•â€æˆ–â€œè¸¢äººâ€åŠŸèƒ½ã€‚</li>
</ul>
<p>è¿™äº›é çº¯ JWT æ ¹æœ¬åšä¸åˆ°ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¼•å…¥ Redisï¼Œç”¨å®ƒæ¥å­˜ä¸€ä»½â€œæœ‰æ•ˆ Token é»‘åå•/ç™½åå•â€ï¼Œæ—¢ä¿ç•™ JWT çš„è½»é‡å’Œè·¨åŸŸä¼˜åŠ¿ï¼Œåˆèƒ½å®ç°æœåŠ¡ç«¯å¯¹ Token çš„ä¸»åŠ¨ç®¡æ§ã€‚</p>
<hr/>
<h3 data-id="heading-2">æ•´ä½“æ¶æ„è®¾è®¡</h3>
<p>text</p>
<p>ç¼–è¾‘</p>
<pre><code class="hljs language-css" lang="css">å®¢æˆ·ç«¯ â†’ ç™»å½• â†’ è¿”å› JWT Tokenï¼ˆå« userIdã€role ç­‰ï¼‰
       â†“
åç»­è¯·æ±‚æºå¸¦ Tokenï¼ˆ<span class="hljs-selector-tag">Header</span>: Authorization: Bearer &lt;token&gt;ï¼‰
       â†“
Spring Security æ‹¦æˆª â†’ éªŒè¯ç­¾å + æŸ¥è¯¢ Redis æ˜¯å¦æœ‰æ•ˆ
       â†“
æœ‰æ•ˆ â†’ æ”¾è¡Œï¼›æ— æ•ˆ/è¿‡æœŸ/è¢«æ‹‰é»‘ â†’ è¿”å› <span class="hljs-number">401</span>
</code></pre>
<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li>Token ä¾ç„¶ç”± JWT ç”Ÿæˆï¼ŒåŒ…å«å¿…è¦å£°æ˜ï¼ˆå¦‚ç”¨æˆ·IDã€è§’è‰²ï¼‰ï¼›</li>
<li>ç™»å½•æˆåŠŸåï¼Œå°† Token çš„å”¯ä¸€æ ‡è¯†ï¼ˆæ¯”å¦‚ jti æˆ– userId+æ—¶é—´æˆ³ï¼‰å­˜å…¥ Redisï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ = Token è¿‡æœŸæ—¶é—´ï¼›</li>
<li>æ¯æ¬¡è¯·æ±‚æ ¡éªŒæ—¶ï¼Œé™¤äº†éªŒè¯ JWT ç­¾åå’Œæœ‰æ•ˆæœŸï¼Œè¿˜è¦æŸ¥ Redis æ˜¯å¦å­˜åœ¨è¯¥ Token è®°å½•ï¼›</li>
<li>ç”¨æˆ·ç™»å‡º / ä¿®æ”¹å¯†ç æ—¶ï¼Œä¸»åŠ¨åˆ é™¤ Redis ä¸­å¯¹åº”è®°å½•ï¼Œå®ç°â€œå³æ—¶å¤±æ•ˆâ€ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-3">ä»£ç å®ç°ï¼ˆæ ¸å¿ƒéƒ¨åˆ†ï¼‰</h3>
<h4 data-id="heading-4">1. ä¾èµ–å¼•å…¥ï¼ˆMavenï¼‰</h4>
<p>xml</p>
<p>ç¼–è¾‘</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.jsonwebtoken<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jjwt-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.11.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.jsonwebtoken<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jjwt-impl<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.11.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.jsonwebtoken<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jjwt-jackson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.11.5<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h4 data-id="heading-5">2. JWT å·¥å…·ç±»ï¼ˆç®€åŒ–ç‰ˆï¼‰</h4>
<p>java</p>
<p>ç¼–è¾‘</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JwtUtil</span> {

    <span class="hljs-keyword">private</span> final <span class="hljs-title class_">String</span> secret = <span class="hljs-string">"MySuperSecretKeyForJWT2026"</span>; <span class="hljs-comment">// å®é™…é¡¹ç›®è¯·ä»é…ç½®æ–‡ä»¶è¯»å–</span>
    <span class="hljs-keyword">private</span> final long expiration = <span class="hljs-number">2</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// 2å°æ—¶</span>

    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">generateToken</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> userId, List&lt;<span class="hljs-built_in">String</span>&gt; roles</span>) {
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Jwts</span>.<span class="hljs-title function_">builder</span>()
                .<span class="hljs-title function_">setId</span>(<span class="hljs-variable constant_">UUID</span>.<span class="hljs-title function_">randomUUID</span>().<span class="hljs-title function_">toString</span>()) <span class="hljs-comment">// ä½œä¸º jtiï¼Œç”¨äº Redis key</span>
                .<span class="hljs-title function_">setSubject</span>(userId)
                .<span class="hljs-title function_">claim</span>(<span class="hljs-string">"roles"</span>, roles)
                .<span class="hljs-title function_">setIssuedAt</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>())
                .<span class="hljs-title function_">setExpiration</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-title class_">System</span>.<span class="hljs-title function_">currentTimeMillis</span>() + expiration))
                .<span class="hljs-title function_">signWith</span>(<span class="hljs-title class_">SignatureAlgorithm</span>.<span class="hljs-property">HS512</span>, secret)
                .<span class="hljs-title function_">compact</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">validateToken</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> token</span>) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-title class_">Jwts</span>.<span class="hljs-title function_">parser</span>().<span class="hljs-title function_">setSigningKey</span>(secret).<span class="hljs-title function_">parseClaimsJws</span>(token);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">catch</span> (<span class="hljs-title class_">Exception</span> e) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title class_">String</span> <span class="hljs-title function_">getUserIdFromToken</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> token</span>) {
        <span class="hljs-title class_">Claims</span> claims = <span class="hljs-title class_">Jwts</span>.<span class="hljs-title function_">parser</span>().<span class="hljs-title function_">setSigningKey</span>(secret).<span class="hljs-title function_">parseClaimsJws</span>(token).<span class="hljs-title function_">getBody</span>();
        <span class="hljs-keyword">return</span> claims.<span class="hljs-title function_">getSubject</span>();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt; <span class="hljs-title function_">getRolesFromToken</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> token</span>) {
        <span class="hljs-title class_">Claims</span> claims = <span class="hljs-title class_">Jwts</span>.<span class="hljs-title function_">parser</span>().<span class="hljs-title function_">setSigningKey</span>(secret).<span class="hljs-title function_">parseClaimsJws</span>(token).<span class="hljs-title function_">getBody</span>();
        <span class="hljs-keyword">return</span> (<span class="hljs-title class_">List</span>&lt;<span class="hljs-title class_">String</span>&gt;) claims.<span class="hljs-title function_">get</span>(<span class="hljs-string">"roles"</span>);
    }
}
</code></pre>
<h4 data-id="heading-6">3. Redis å­˜å‚¨ Token çŠ¶æ€</h4>
<p>java</p>
<p>ç¼–è¾‘</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenBlacklistService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> <span class="hljs-title class_">RedisTemplate</span>&lt;<span class="hljs-title class_">String</span>, <span class="hljs-title class_">Object</span>&gt; redisTemplate;

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> final <span class="hljs-title class_">String</span> <span class="hljs-variable constant_">TOKEN_PREFIX</span> = <span class="hljs-string">"valid_token:"</span>;

    <span class="hljs-comment">// ç™»å½•æˆåŠŸåè°ƒç”¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">saveToken</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> userId, <span class="hljs-built_in">String</span> tokenId, long expireMs</span>) {
        <span class="hljs-title class_">String</span> key = <span class="hljs-variable constant_">TOKEN_PREFIX</span> + userId + <span class="hljs-string">":"</span> + tokenId;
        redisTemplate.<span class="hljs-title function_">opsForValue</span>().<span class="hljs-title function_">set</span>(key, <span class="hljs-string">"valid"</span>, <span class="hljs-title class_">Duration</span>.<span class="hljs-title function_">ofMillis</span>(expireMs));
    }

    <span class="hljs-comment">// æ ¡éªŒ Token æ˜¯å¦åœ¨ Redis ä¸­æœ‰æ•ˆ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">boolean</span> <span class="hljs-title function_">isTokenValid</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> userId, <span class="hljs-built_in">String</span> tokenId</span>) {
        <span class="hljs-title class_">String</span> key = <span class="hljs-variable constant_">TOKEN_PREFIX</span> + userId + <span class="hljs-string">":"</span> + tokenId;
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Boolean</span>.<span class="hljs-property">TRUE</span>.<span class="hljs-title function_">equals</span>(redisTemplate.<span class="hljs-title function_">hasKey</span>(key));
    }

    <span class="hljs-comment">// ç™»å‡º / ä¿®æ”¹å¯†ç æ—¶è°ƒç”¨</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">invalidateUserTokens</span>(<span class="hljs-params"><span class="hljs-built_in">String</span> userId</span>) {
        <span class="hljs-comment">// å®é™…å¯éå†æ‰€æœ‰ä»¥ userId å¼€å¤´çš„ key æ‰¹é‡åˆ é™¤</span>
        <span class="hljs-comment">// ç®€åŒ–å¤„ç†ï¼šç›´æ¥æŒ‰è§„åˆ™åˆ ï¼ˆå‡è®¾ä¸€ä¸ªç”¨æˆ·åªå…è®¸ä¸€ä¸ªæ´»è·ƒ Tokenï¼‰</span>
        <span class="hljs-title class_">Set</span>&lt;<span class="hljs-title class_">String</span>&gt; keys = redisTemplate.<span class="hljs-title function_">keys</span>(<span class="hljs-variable constant_">TOKEN_PREFIX</span> + userId + <span class="hljs-string">":*"</span>);
        <span class="hljs-keyword">if</span> (keys != <span class="hljs-literal">null</span> &amp;&amp; !keys.<span class="hljs-title function_">isEmpty</span>()) {
            redisTemplate.<span class="hljs-title function_">delete</span>(keys);
        }
    }
}
</code></pre>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šè¿™é‡Œä¸ºäº†ç®€åŒ–ï¼Œå‡è®¾ä¸€ä¸ªç”¨æˆ·åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªæœ‰æ•ˆ Tokenã€‚å¦‚æœæ”¯æŒå¤šç«¯ç™»å½•ï¼Œéœ€åœ¨ Token ä¸­åŠ å…¥è®¾å¤‡æ ‡è¯†ï¼Œå¹¶åœ¨ Redis ä¸­åˆ†åˆ«å­˜å‚¨ã€‚</p>
</blockquote>
<h4 data-id="heading-7">4. è‡ªå®šä¹‰ Filterï¼šè§£æå¹¶æ ¡éªŒ Token</h4>
<p>java</p>
<p>ç¼–è¾‘</p>
<pre><code class="hljs language-scss" lang="scss">public class JwtAuthenticationFilter extends OncePerRequestFilter {

    <span class="hljs-keyword">@Autowired</span>
    private JwtUtil jwtUtil;

    <span class="hljs-keyword">@Autowired</span>
    private TokenBlacklistService tokenBlacklistService;

    <span class="hljs-keyword">@Override</span>
    protected void doFilterInternal(HttpServletRequest request,
                                    HttpServletResponse response,
                                    FilterChain chain) throws ServletException, IOException {

        String authHeader = request<span class="hljs-selector-class">.getHeader</span>("Authorization");

        if (authHeader != null &amp;&amp; authHeader.startsWith("Bearer ")) {
            String token = authHeader<span class="hljs-selector-class">.substring</span>(<span class="hljs-number">7</span>);

            if (jwtUtil.validateToken(token)) {
                String userId = jwtUtil<span class="hljs-selector-class">.getUserIdFromToken</span>(token);
                String tokenId = <span class="hljs-built_in">getTokenIdFromJwt</span>(token); <span class="hljs-comment">// ä» JWT çš„ jti å­—æ®µæå–</span>

                <span class="hljs-comment">// å…³é”®ï¼šæ£€æŸ¥ Redis ä¸­æ˜¯å¦å­˜åœ¨è¯¥ Token</span>
                if (tokenBlacklistService.isTokenValid(userId, tokenId)) {
                    <span class="hljs-comment">// æ„å»º Authentication å¯¹è±¡</span>
                    List&lt;String&gt; roles = jwtUtil<span class="hljs-selector-class">.getRolesFromToken</span>(token);
                    List&lt;SimpleGrantedAuthority&gt; authorities = roles<span class="hljs-selector-class">.stream</span>()
                            <span class="hljs-selector-class">.map</span>(SimpleGrantedAuthority::new)
                            <span class="hljs-selector-class">.collect</span>(Collectors.toList());

                    UsernamePasswordAuthenticationToken authentication =
                            new <span class="hljs-built_in">UsernamePasswordAuthenticationToken</span>(userId, null, authorities);
                    authentication<span class="hljs-selector-class">.setDetails</span>(new WebAuthenticationDetailsSource()<span class="hljs-selector-class">.buildDetails</span>(request));

                    SecurityContextHolder<span class="hljs-selector-class">.getContext</span>()<span class="hljs-selector-class">.setAuthentication</span>(authentication);
                }
            }
        }

        chain<span class="hljs-selector-class">.doFilter</span>(request, response);
    }

    private String <span class="hljs-built_in">getTokenIdFromJwt</span>(String token) {
        Claims claims = Jwts<span class="hljs-selector-class">.parser</span>()
                <span class="hljs-selector-class">.setSigningKey</span>("MySuperSecretKeyForJWT2026")
                <span class="hljs-selector-class">.parseClaimsJws</span>(token)
                <span class="hljs-selector-class">.getBody</span>();
        return (String) claims<span class="hljs-selector-class">.get</span>(JwtClaimNames.JTI);
    }
}
</code></pre>
<h4 data-id="heading-8">5. é…ç½® Security</h4>
<p>java</p>
<p>ç¼–è¾‘</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@Configuration</span>
<span class="hljs-keyword">@EnableWebSecurity</span>
public class SecurityConfig {

    <span class="hljs-keyword">@Bean</span>
    public JwtAuthenticationFilter jwtAuthenticationFilter() {
        return new <span class="hljs-built_in">JwtAuthenticationFilter</span>();
    }

    <span class="hljs-keyword">@Bean</span>
    public PasswordEncoder passwordEncoder() {
        return new <span class="hljs-built_in">BCryptPasswordEncoder</span>();
    }

    <span class="hljs-keyword">@Bean</span>
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            <span class="hljs-selector-class">.csrf</span>()<span class="hljs-selector-class">.disable</span>()
            <span class="hljs-selector-class">.sessionManagement</span>()<span class="hljs-selector-class">.sessionCreationPolicy</span>(SessionCreationPolicy.STATELESS)
            <span class="hljs-selector-class">.and</span>()
            <span class="hljs-selector-class">.authorizeHttpRequests</span>(authz -&gt; authz
                .requestMatchers("/login", "/public/**")<span class="hljs-selector-class">.permitAll</span>()
                <span class="hljs-selector-class">.anyRequest</span>()<span class="hljs-selector-class">.authenticated</span>()
            )
            <span class="hljs-selector-class">.addFilterBefore</span>(jwtAuthenticationFilter(), UsernamePasswordAuthenticationFilter<span class="hljs-selector-class">.class</span>);

        return http<span class="hljs-selector-class">.build</span>();
    }
}
</code></pre>
<h4 data-id="heading-9">6. ç™»å½•ä¸ç™»å‡ºæ¥å£</h4>
<p>java</p>
<p>ç¼–è¾‘</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
public class AuthController {

    <span class="hljs-variable">@Autowired</span>
    private UserService userService;

    <span class="hljs-variable">@Autowired</span>
    private JwtUtil jwtUtil;

    <span class="hljs-variable">@Autowired</span>
    private TokenBlacklistService tokenBlacklistService;

    <span class="hljs-variable">@PostMapping</span>(<span class="hljs-string">"/login"</span>)
    public ResponseEntity&lt;?&gt; <span class="hljs-built_in">login</span>(<span class="hljs-variable">@RequestBody</span> LoginRequest req) {
        <span class="hljs-selector-tag">User</span> <span class="hljs-selector-tag">user</span> = <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.findByUsername</span>(req.<span class="hljs-built_in">getUsername</span>());
        <span class="hljs-selector-tag">if</span> (user != null &amp;&amp; passwordEncoder.<span class="hljs-built_in">matches</span>(req.<span class="hljs-built_in">getPassword</span>(), user.<span class="hljs-built_in">getPassword</span>())) {
            <span class="hljs-selector-tag">List</span>&lt;<span class="hljs-selector-tag">String</span>&gt; <span class="hljs-selector-tag">roles</span> = <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.getUserRoles</span>(user.<span class="hljs-built_in">getId</span>());
            <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">token</span> = <span class="hljs-selector-tag">jwtUtil</span><span class="hljs-selector-class">.generateToken</span>(user.<span class="hljs-built_in">getId</span>(), roles);
            <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">tokenId</span> = <span class="hljs-selector-tag">extractJtiFromToken</span>(token);

            <span class="hljs-comment">// å­˜å…¥ Redisï¼Œæœ‰æ•ˆæœŸä¸ Token ä¸€è‡´</span>
            <span class="hljs-selector-tag">tokenBlacklistService</span><span class="hljs-selector-class">.saveToken</span>(user.<span class="hljs-built_in">getId</span>(), tokenId, jwtUtil.<span class="hljs-built_in">getExpiration</span>());

            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(Map.<span class="hljs-built_in">of</span>(<span class="hljs-string">"token"</span>, token));
        }
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.status</span>(<span class="hljs-number">401</span>)<span class="hljs-selector-class">.body</span>(<span class="hljs-string">"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"</span>);
    }

    @<span class="hljs-selector-tag">PostMapping</span>(<span class="hljs-string">"/logout"</span>)
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">ResponseEntity</span>&lt;?&gt; <span class="hljs-selector-tag">logout</span>(HttpServletRequest request) {
        <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">token</span> = <span class="hljs-selector-tag">extractTokenFromHeader</span>(request);
        <span class="hljs-selector-tag">if</span> (token != null &amp;&amp; jwtUtil.<span class="hljs-built_in">validateToken</span>(token)) {
            <span class="hljs-selector-tag">String</span> <span class="hljs-selector-tag">userId</span> = <span class="hljs-selector-tag">jwtUtil</span><span class="hljs-selector-class">.getUserIdFromToken</span>(token);
            <span class="hljs-selector-tag">tokenBlacklistService</span><span class="hljs-selector-class">.invalidateUserTokens</span>(userId); <span class="hljs-comment">// åˆ é™¤ Redis ä¸­æ‰€æœ‰è¯¥ç”¨æˆ·çš„ Token</span>
        }
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">ResponseEntity</span><span class="hljs-selector-class">.ok</span>(<span class="hljs-string">"ç™»å‡ºæˆåŠŸ"</span>);
    }

    <span class="hljs-comment">// è¾…åŠ©æ–¹æ³•ç•¥...</span>
}
</code></pre>
<hr/>
<h3 data-id="heading-10">è¸©è¿‡çš„å‘ &amp; å»ºè®®</h3>
<ol>
<li><strong>Redis Key è®¾è®¡</strong>ï¼šå»ºè®®ç”¨Â <code>valid_token:{userId}:{tokenId}</code>ï¼Œæ–¹ä¾¿æŒ‰ç”¨æˆ·æ‰¹é‡æ¸…ç†ã€‚</li>
<li><strong>Token åˆ·æ–°æœºåˆ¶</strong>ï¼šå¯è€ƒè™‘æ»‘åŠ¨è¿‡æœŸï¼ˆæ¯æ¬¡è¯·æ±‚å»¶é•¿ Redis ä¸­ Token çš„ TTLï¼‰ï¼Œä½†è¦æƒè¡¡å®‰å…¨æ€§ã€‚</li>
<li><strong>å¹¶å‘ç™»å‡ºé—®é¢˜</strong>ï¼šç™»å‡ºæ—¶åˆ é™¤ Redis Key æ˜¯åŸå­æ“ä½œï¼Œæ— éœ€æ‹…å¿ƒã€‚</li>
<li><strong>å¯†é’¥ç®¡ç†</strong>ï¼šJWT å¯†é’¥åŠ¡å¿…æ”¾åœ¨é…ç½®ä¸­å¿ƒæˆ–ç¯å¢ƒå˜é‡ï¼Œåˆ«ç¡¬ç¼–ç ï¼</li>
<li><strong>æ€§èƒ½</strong>ï¼šæ¯æ¬¡è¯·æ±‚å¤šä¸€æ¬¡ Redis æŸ¥è¯¢ï¼Œä½† Redis å“åº”é€šå¸¸åœ¨ 1ms å†…ï¼Œå½±å“æå°ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-11">æ€»ç»“</h3>
<p>è¿™å¥—æ–¹æ¡ˆåœ¨æˆ‘ä»¬ç”Ÿäº§ç¯å¢ƒå·²ç¨³å®šè¿è¡Œä¸‰ä¸ªæœˆï¼Œæ”¯æ’‘æ—¥å‡ç™¾ä¸‡çº§è¯·æ±‚ã€‚å®ƒå…¼é¡¾äº† JWT çš„æ— çŠ¶æ€ä¼˜åŠ¿å’Œ Redis çš„çŠ¶æ€å¯æ§æ€§ï¼Œæ—¢èƒ½æ¨ªå‘æ‰©å±•ï¼Œåˆèƒ½æ»¡è¶³ä¼ä¸šçº§æƒé™ç®¡ç†éœ€æ±‚ã€‚</p>
<p>å¦‚æœä½ è¿˜åœ¨ç”¨ Session åšé›†ç¾¤æƒé™ï¼Œæˆ–è€…è¢«çº¯ JWT çš„â€œæ— æ³•å³æ—¶å¤±æ•ˆâ€å›°æ‰°ï¼Œä¸å¦¨è¯•è¯•è¿™ä¸ªç»„åˆã€‚ä»£ç è™½å¤šï¼Œä½†é€»è¾‘æ¸…æ™°ï¼Œç»´æŠ¤æˆæœ¬å…¶å®æ¯”æƒ³è±¡ä¸­ä½ã€‚</p>
<blockquote>
<p><strong>æºç å·²æ•´ç†ä¸Šä¼  GitHubï¼ˆç§ä¿¡æˆ‘è·å–é“¾æ¥ï¼‰</strong><br/>
<strong>æ¬¢è¿ç•™è¨€è®¨è®ºï¼Œè§‰å¾—æœ‰ç”¨è®°å¾—ç‚¹èµ + å…³æ³¨ï¼</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[iOS App ç”µè€—ç®¡ç† é€šè¿‡ç³»ç»Ÿç”µæ± è®°å½•ã€Xcode Instruments ä¸å…‹é­”ï¼ˆKeyMobï¼‰ç»„åˆä½¿ç”¨]]></title>    <link>https://juejin.cn/post/7597252004712988714</link>    <guid>https://juejin.cn/post/7597252004712988714</guid>    <pubDate>2026-01-20T09:53:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597252004712988714" data-draft-id="7597252004712972330" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="iOS App ç”µè€—ç®¡ç† é€šè¿‡ç³»ç»Ÿç”µæ± è®°å½•ã€Xcode Instruments ä¸å…‹é­”ï¼ˆKeyMobï¼‰ç»„åˆä½¿ç”¨"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-20T09:53:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘æ˜¯è°çš„ç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/2390811467846089"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            iOS App ç”µè€—ç®¡ç† é€šè¿‡ç³»ç»Ÿç”µæ± è®°å½•ã€Xcode Instruments ä¸å…‹é­”ï¼ˆKeyMobï¼‰ç»„åˆä½¿ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2390811467846089/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘æ˜¯è°çš„ç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:53:41.000Z" title="Tue Jan 20 2026 09:53:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨å®é™…é¡¹ç›®é‡Œï¼Œè¿™ä¸ªç‰ˆæœ¬æœ‰ç‚¹è´¹ç”µå¾€å¾€æ˜¯ä¸€ä¸ªå¾ˆæ¨¡ç³Šçš„åé¦ˆã€‚
æµ‹è¯•åŒäº‹è§‰å¾—å‘çƒ­ï¼Œäº§å“æ„Ÿè§‰ç»­èˆªä¸‹é™ï¼Œä½†çœŸæ­£è½åˆ°å·¥ç¨‹å±‚é¢ï¼Œç»å¸¸å¡åœ¨ä¸€ä¸ªç‚¹ä¸Šï¼š<strong>è€—ç”µè¡Œä¸ºå‘ç”Ÿåœ¨ä»€ä¹ˆåœºæ™¯ã€ç”±è°è§¦å‘ã€æŒç»­äº†å¤šä¹…</strong>ã€‚</p>
<p>ç”µè€—ç®¡ç†ä¸æ˜¯å•ä¸€å·¥å…·èƒ½è§£å†³çš„äº‹ï¼Œå®ƒæ›´åƒæ˜¯ä¸€ä¸ªç»„åˆè¿‡ç¨‹ã€‚ä¸‹é¢æˆ‘ç»“åˆä¸€æ¬¡æ¯”è¾ƒå®Œæ•´çš„ iOS App ç”µè€—åˆ†æè¿‡ç¨‹ï¼Œè¯´è¯´æˆ‘æ˜¯å¦‚ä½•æŠŠç³»ç»Ÿå·¥å…·å’Œç¬¬ä¸‰æ–¹å·¥å…·ä¸€èµ·ç”¨èµ·æ¥çš„ã€‚</p>
<hr/>
<h2 data-id="heading-0">å…ˆç¡®è®¤ï¼šç³»ç»Ÿçœ¼é‡Œçš„è€—ç”µåˆ°åº•æ˜¯è°</h2>
<p>åœ¨åŠ¨ä»»ä½•æµ‹è¯•å·¥å…·ä¹‹å‰ï¼Œæˆ‘é€šå¸¸ä¼šå…ˆçœ‹ç³»ç»Ÿå±‚é¢çš„åˆ¤æ–­ã€‚</p>
<h3 data-id="heading-1">ç³»ç»Ÿç”µæ± ä½¿ç”¨è®°å½•çš„ä½œç”¨</h3>
<p>iOS è‡ªå¸¦çš„ã€è®¾ç½® â†’ ç”µæ± ã€‘å…¶å®éå¸¸æœ‰ä»·å€¼ï¼Œå®ƒèƒ½å›ç­”ä¸¤ä¸ªåŸºç¡€é—®é¢˜ï¼š</p>
<ul>
<li>è¿™æ®µæ—¶é—´ä¸»è¦è€—ç”µçš„æ˜¯ä¸æ˜¯è¿™ä¸ª App</li>
<li>è€—ç”µå‘ç”Ÿåœ¨å‰å°ï¼Œè¿˜æ˜¯åå°</li>
</ul>
<p>è¿™ä¸€æ­¥ä¸èƒ½ç²¾ç¡®åˆ°å‡½æ•°çº§åˆ«ï¼Œä½†å®ƒèƒ½å¸®ä½ é¿å…ä¸€ä¸ªå¸¸è§è¯¯åˆ¤ï¼š
<strong>å…¶å®æ˜¯åå°ä»»åŠ¡æˆ–æ¨é€å¯¼è‡´çš„è€—ç”µï¼Œå´è¢«è¯¯ä»¥ä¸ºæ˜¯æŸä¸ªé¡µé¢æ€§èƒ½é—®é¢˜ã€‚</strong></p>
<p>å¦‚æœç³»ç»Ÿè®°å½•æ˜¾ç¤ºè€—ç”µä¸»è¦é›†ä¸­åœ¨å‰å°ä½¿ç”¨é˜¶æ®µï¼Œæ‰å€¼å¾—ç»§ç»­å¾€ä¸‹æ‹†ã€‚</p>
<hr/>
<h2 data-id="heading-2">åœºæ™¯å¤ç°ï¼Œæ¯”è·‘ä¸€æ¬¡æµ‹è¯•é‡è¦å¾—å¤š</h2>
<p>ç”µè€—é—®é¢˜é«˜åº¦ä¾èµ–ä½¿ç”¨è·¯å¾„ã€‚
åŒä¸€ä¸ª Appï¼Œåˆ·åˆ—è¡¨å’Œæ’­æ”¾è§†é¢‘çš„è€—ç”µæ›²çº¿å®Œå…¨ä¸åŒã€‚</p>
<p>æˆ‘ä¸€èˆ¬ä¼šåšä¸¤ä»¶äº‹ï¼š</p>
<ul>
<li>å›ºå®šæµ‹è¯•åœºæ™¯ï¼ˆä¾‹å¦‚è¿ç»­æ»šåŠ¨åˆ—è¡¨ 5 åˆ†é’Ÿï¼‰</li>
<li>å›ºå®šæµ‹è¯•ç¯å¢ƒï¼ˆäº®åº¦ã€ç½‘ç»œã€è®¾å¤‡å‹å·ï¼‰</li>
</ul>
<p>è¿™æ ·åé¢çš„æ•°æ®æ‰æœ‰å¯æ¯”æ€§ã€‚</p>
<hr/>
<h2 data-id="heading-3">ç”¨ Xcode Instruments çœ‹ï¼Œä½†åˆ«ä¸€ä¸Šæ¥å°±é™·è¿›å»</h2>
<p>Instruments çš„ Energy Log éå¸¸å¼ºï¼Œä½†ä¹Ÿéå¸¸å®¹æ˜“è®©äººè¿·å¤±åœ¨æŒ‡æ ‡é‡Œã€‚</p>
<p>æˆ‘è‡ªå·±çš„ä¹ æƒ¯æ˜¯ï¼š</p>
<ul>
<li>ä¸åœ¨ç¬¬ä¸€æ¬¡æµ‹è¯•å°±æ‰“å¼€ Instruments</li>
<li>å…ˆç¡®è®¤æœ‰æ²¡æœ‰<strong>æ˜æ˜¾å¼‚å¸¸è¶‹åŠ¿</strong></li>
</ul>
<hr/>
<h2 data-id="heading-4">å…‹é­”åœ¨ç”µè€—ç®¡ç†é‡Œçš„å®é™…ä½œç”¨</h2>
<p>åœ¨è¿›å…¥ Instruments ä¹‹å‰ï¼Œæˆ‘ä¼šå…ˆç”¨ <strong>å…‹é­”ï¼ˆKeyMobï¼‰</strong> åšä¸€è½®è½»é‡ç›‘æ§ï¼Œå®ƒä¸»è¦æ‰¿æ‹…ä¸‰ä¸ªåŠŸèƒ½ç‚¹ï¼Œè€Œä¸æ˜¯â€œå…¨åŠŸèƒ½æ€§èƒ½åˆ†æâ€ã€‚</p>
<h3 data-id="heading-5">å¯Ÿ CPU æ˜¯å¦é•¿æœŸå¼‚å¸¸æ´»è·ƒ</h3>
<p>ç”µè€—å’Œ CPU ä½¿ç”¨é«˜åº¦ç›¸å…³ã€‚
å¦‚æœåœ¨ç”¨æˆ·â€œçœ‹èµ·æ¥ä»€ä¹ˆéƒ½æ²¡åšâ€çš„æƒ…å†µä¸‹ï¼ŒCPU æ›²çº¿æŒç»­æŠ¬é«˜ï¼Œæœ¬èº«å°±å·²ç»æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚</p>
<p><strong>æ€ä¹ˆåšï¼š</strong></p>
<ol>
<li>è¿æ¥è®¾å¤‡ï¼Œæ‰“å¼€å…‹é­”</li>
<li>è¿›å…¥ã€æ€§èƒ½å›¾è¡¨ã€‘</li>
<li>å‹¾é€‰ CPU æŒ‡æ ‡</li>
<li>é€‰æ‹©ç›®æ ‡ App</li>
<li>æŒ‰æ—¢å®šä½¿ç”¨è·¯å¾„æ“ä½œ</li>
</ol>
<p>å¦‚æœ CPU åœ¨é™æ­¢é¡µé¢ä»é¢‘ç¹æ³¢åŠ¨ï¼Œè¿™æ—¶å°±å€¼å¾—è­¦æƒ•åå°ä»»åŠ¡æˆ–å®šæ—¶é€»è¾‘ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4925086eec024597a7f44c677b0618be~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769507621&amp;x-signature=UgCk47mHx906pVCjbgxfE0nzrqk%3D" alt="æ€§èƒ½å›¾æ ‡" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-6">é…åˆå®æ—¶æ—¥å¿—ï¼Œç¡®è®¤â€œè°åœ¨å·¥ä½œâ€</h3>
<p>å•çœ‹æ›²çº¿åªèƒ½çŸ¥é“â€œæœ‰é—®é¢˜â€ï¼Œä½†ä¸çŸ¥é“â€œæ˜¯è°â€ã€‚</p>
<p>è¿™æ—¶æˆ‘ä¼šåŒæ—¶æ‰“å¼€å…‹é­”çš„å®æ—¶æ—¥å¿—ã€‚</p>
<p><strong>å®é™…æ“ä½œï¼š</strong></p>
<ul>
<li>å·¦ä¾§è¿›å…¥ã€å®æ—¶æ—¥å¿—ã€‘</li>
<li>è®¾ç½®åªçœ‹å½“å‰ App</li>
<li>ä¿ç•™å…³é”®æ¨¡å—çš„æ—¥å¿—è¾“å‡º</li>
</ul>
<p>æœ‰äº›ç”µè€—é—®é¢˜ï¼Œæœ¬è´¨æ˜¯æ— æ„ä¹‰çš„é‡å¤é€»è¾‘ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>å®šæ—¶åˆ·æ–°æ²¡æœ‰æ­£ç¡®åœæ­¢</li>
<li>é¡µé¢é€€å‡ºåçº¿ç¨‹ä»åœ¨è·‘</li>
</ul>
<p>è¿™äº›å¾€å¾€èƒ½ç›´æ¥åœ¨æ—¥å¿—é‡Œçœ‹åˆ°ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8464bf3da2f402d9a118a97258ce211~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR5piv6LCB55qE56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769507621&amp;x-signature=d%2B6BjnO5d1tPYeVNj%2FCFabIGC08%3D" alt="å®æ—¶æ—¥å¿—" loading="lazy"/></p>
<hr/>
<h3 data-id="heading-7">é•¿æ—¶é—´è¿è¡Œï¼Œæ¯”å³°å€¼æ›´æœ‰ä»·å€¼</h3>
<p>ç”µè€—ç®¡ç†ä¸å¤ªçœ‹ç¬æ—¶å³°å€¼ï¼Œè€Œæ›´å…³æ³¨<strong>æŒç»­æ€§è¡Œä¸º</strong>ã€‚</p>
<p>å…‹é­”çš„æ€§èƒ½å›¾è¡¨åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªå®ç”¨ç‚¹ï¼š
å®ƒå¯ä»¥åœ¨ä¸æ‰“æ–­ç”¨æˆ·æ“ä½œçš„æƒ…å†µä¸‹ï¼ŒæŒç»­è§‚å¯Ÿèµ„æºå˜åŒ–ã€‚</p>
<p>æˆ‘é€šå¸¸ä¼šï¼š</p>
<ul>
<li>è®© App åœ¨ç›®æ ‡é¡µé¢åœç•™ 10â€“20 åˆ†é’Ÿ</li>
<li>è§‚å¯Ÿ CPU æ˜¯å¦é€æ­¥æŠ¬å‡</li>
<li>å¯¹ç…§å®æ—¶æ—¥å¿—ï¼Œçœ‹æ˜¯å¦æœ‰å‘¨æœŸæ€§è¾“å‡º</li>
</ul>
<p>å¦‚æœèµ„æºä½¿ç”¨å‘ˆâ€œé”¯é½¿çŠ¶è§„å¾‹â€ï¼ŒåŸºæœ¬å¯ä»¥åˆ¤æ–­å­˜åœ¨å®šæ—¶æˆ–è½®è¯¢é€»è¾‘ã€‚</p>
<hr/>
<h2 data-id="heading-8">å›åˆ° Instrumentsï¼ŒéªŒè¯å’Œå®šä½</h2>
<p>å½“ä»¥ä¸Šæ­¥éª¤å·²ç»æ˜ç¡®â€œé—®é¢˜å­˜åœ¨â€ï¼Œå†å›åˆ° Instruments çš„ Energy Logï¼Œæ•ˆç‡ä¼šé«˜å¾ˆå¤šã€‚</p>
<p>è¿™æ—¶ä½ å·²ç»çŸ¥é“ï¼š</p>
<ul>
<li>å“ªä¸ªé¡µé¢</li>
<li>å¤§æ¦‚å‘ç”Ÿåœ¨ä»€ä¹ˆæ—¶é—´æ®µ</li>
<li>æ˜¯å¦ä¸ CPU æˆ–åå°ä»»åŠ¡ç›¸å…³</li>
</ul>
<p>å†å»çœ‹ Wakeupsã€Networkã€CPU Activityï¼ŒåŸºæœ¬ä¸ä¼šè¿·è·¯ã€‚</p>
<hr/>
<p>æœ€åä¸€ä¸ªç»éªŒæ˜¯<strong>ç”µè€—ä¼˜åŒ–å¾€å¾€æ˜¯å›å½’é—®é¢˜ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§é—®é¢˜ã€‚</strong></p>
<p>æ¯æ¬¡åŠŸèƒ½æ”¹åŠ¨åï¼Œæœ€å¥½ç”¨åŒæ ·çš„åœºæ™¯å†è·‘ä¸€éå¯¹æ¯”ï¼š</p>
<ul>
<li>ç³»ç»Ÿç”µæ± è®°å½•</li>
<li>å…‹é­”çš„ CPU æ›²çº¿</li>
<li>å…³é”®æ—¥å¿—æ˜¯å¦å˜åŒ–</li>
</ul>
<p>è¿™æ ·ä½ æ‰èƒ½ç¡®å®šæ˜¯â€œçœŸçš„ä¼˜åŒ–äº†â€ï¼Œè€Œä¸æ˜¯â€œæ„Ÿè§‰å¥½äº†ä¸€ç‚¹â€ã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fkeymob.com%2Ftutorial%2Fzh%2F1%2F1.html" target="_blank" title="https://keymob.com/tutorial/zh/1/1.html" ref="nofollow noopener noreferrer">keymob.com/tutorial/zhâ€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PHPå¼€å‘è€…è®­ç»ƒè¥ ä»å…¥é—¨åˆ°ç²¾é€š]]></title>    <link>https://juejin.cn/post/7597243334176555048</link>    <guid>https://juejin.cn/post/7597243334176555048</guid>    <pubDate>2026-01-20T09:37:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597243334176555048" data-draft-id="7597025960946892835" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PHPå¼€å‘è€…è®­ç»ƒè¥ ä»å…¥é—¨åˆ°ç²¾é€š"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-20T09:37:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·557744506908"/> <meta itemprop="url" content="https://juejin.cn/user/749198160955433"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PHPå¼€å‘è€…è®­ç»ƒè¥ ä»å…¥é—¨åˆ°ç²¾é€š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/749198160955433/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·557744506908
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:37:58.000Z" title="Tue Jan 20 2026 09:37:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>PHPå¼€å‘è€…è®­ç»ƒè¥ ä»å…¥é—¨åˆ°ç²¾é€š---youkeit.xyz/15490/</strong></p>
<h2 data-id="heading-0">PHP å¼€å‘è€…è®­ç»ƒè¥ï¼šä»å…¥é—¨åˆ°ç²¾é€šï¼Œæ‹¥æŠ± PHP 8.3 + ä¸ Swooleï¼ŒæŠ¢å ä¸‹ä¸€ä»£ Web å¼€å‘å…ˆæœº</h2>
<h3 data-id="heading-1">ä¸€ã€PHP 8.3 ç°ä»£è¯­æ³•ä¸ç±»å‹ç³»ç»Ÿæ·±åº¦è§£æ</h3>
<h4 data-id="heading-2">1.1 åªè¯»ç±»ä¸æ·±æ‹·è´æœºåˆ¶</h4>
<p>PHP 8.3 åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹æ–¹é¢å¼•å…¥äº†é©å‘½æ€§çš„æ”¹è¿›ï¼Œåªè¯»ç±»ï¼ˆReadonly Classesï¼‰å’Œæ·±æ‹·è´æœºåˆ¶æ˜¾è‘—æå‡äº†ä»£ç çš„å®‰å…¨æ€§å’Œå¯é¢„æµ‹æ€§ã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);

<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">ModernPHP</span>\<span class="hljs-title class_">Types</span>;

<span class="hljs-comment">/**
 * PHP 8.3 åªè¯»ç±»ç¤ºä¾‹
 * ä¸€æ—¦åˆå§‹åŒ–ï¼Œæ‰€æœ‰å±æ€§ä¸å¯æ›´æ”¹
 */</span>
<span class="hljs-keyword">readonly</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImmutableUser</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$uuid</span>,
        <span class="hljs-keyword">public</span> <span class="hljs-keyword">string</span> <span class="hljs-variable">$username</span>,
        <span class="hljs-keyword">public</span> Email <span class="hljs-variable">$email</span>,
        <span class="hljs-keyword">public</span> DateTimeImmutable <span class="hljs-variable">$createdAt</span>,
        <span class="hljs-keyword">public</span> UserProfile <span class="hljs-variable">$profile</span>
    </span>) </span>{}
    
    <span class="hljs-comment">/**
     * åˆ›å»ºå‰¯æœ¬å¹¶ä¿®æ”¹éƒ¨åˆ†å±æ€§
     * PHP 8.3 æ”¯æŒæ·±æ‹·è´
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withUsername</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$newUsername</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-comment">// __clone ç°åœ¨æ”¯æŒæ·±æ‹·è´ä¿®æ”¹</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(
            <span class="hljs-variable language_">$this</span>-&gt;uuid,
            <span class="hljs-variable">$newUsername</span>,
            <span class="hljs-keyword">clone</span> <span class="hljs-variable language_">$this</span>-&gt;email,
            <span class="hljs-keyword">clone</span> <span class="hljs-variable language_">$this</span>-&gt;createdAt,
            <span class="hljs-keyword">clone</span> <span class="hljs-variable language_">$this</span>-&gt;profile
        );
    }
    
    <span class="hljs-comment">/**
     * éªŒè¯å™¨ä½¿ç”¨æ–°å¢çš„ json_validate() å‡½æ•°
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fromJson</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$json</span></span>): <span class="hljs-title">self</span>
    </span>{
        <span class="hljs-comment">// PHP 8.3 æ–°å¢ï¼Œæ€§èƒ½ä¼˜äº json_decode</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">json_validate</span>(<span class="hljs-variable">$json</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Invalid JSON'</span>);
        }
        
        <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$json</span>, <span class="hljs-literal">true</span>, <span class="hljs-number">512</span>, JSON_THROW_ON_ERROR);
        
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">self</span>(
            <span class="hljs-variable">$data</span>[<span class="hljs-string">'uuid'</span>] ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Missing uuid'</span>),
            <span class="hljs-variable">$data</span>[<span class="hljs-string">'username'</span>] ?? <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">'Missing username'</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">Email</span>(<span class="hljs-variable">$data</span>[<span class="hljs-string">'email'</span>] ?? <span class="hljs-string">''</span>),
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTimeImmutable</span>(<span class="hljs-variable">$data</span>[<span class="hljs-string">'created_at'</span>] ?? <span class="hljs-string">'now'</span>),
            <span class="hljs-title class_">UserProfile</span>::<span class="hljs-title function_ invoke__">fromArray</span>(<span class="hljs-variable">$data</span>[<span class="hljs-string">'profile'</span>] ?? [])
        );
    }
}

<span class="hljs-comment">/**
 * æšä¸¾å¢å¼º
 */</span>
<span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">UserStatus</span>: <span class="hljs-title">string</span>
</span>{
    <span class="hljs-keyword">case</span> ACTIVE = <span class="hljs-string">'active'</span>;
    <span class="hljs-keyword">case</span> INACTIVE = <span class="hljs-string">'inactive'</span>;
    <span class="hljs-keyword">case</span> SUSPENDED = <span class="hljs-string">'suspended'</span>;
    <span class="hljs-keyword">case</span> DELETED = <span class="hljs-string">'deleted'</span>;
    
    <span class="hljs-comment">// PHP 8.3 æšä¸¾æ–¹æ³•å¯ä»¥è¿”å›å¸¸é‡è¡¨è¾¾å¼</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">color</span>(<span class="hljs-params"/>): <span class="hljs-title">string</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span>(<span class="hljs-variable language_">$this</span>) {
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">ACTIVE</span> =&gt; <span class="hljs-string">'#22c55e'</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">INACTIVE</span> =&gt; <span class="hljs-string">'#f59e0b'</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">SUSPENDED</span> =&gt; <span class="hljs-string">'#ef4444'</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">DELETED</span> =&gt; <span class="hljs-string">'#6b7280'</span>,
        };
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">canLogin</span>(<span class="hljs-params"/>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">match</span>(<span class="hljs-variable language_">$this</span>) {
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">ACTIVE</span> =&gt; <span class="hljs-literal">true</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">INACTIVE</span> =&gt; <span class="hljs-literal">false</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">SUSPENDED</span> =&gt; <span class="hljs-literal">false</span>,
            <span class="hljs-built_in">self</span>::<span class="hljs-variable constant_">DELETED</span> =&gt; <span class="hljs-literal">false</span>,
        };
    }
}

<span class="hljs-comment">/**
 * æ•æ„Ÿå‚æ•°å±æ€§
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserAuthenticator</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">authenticate</span>(<span class="hljs-params">
        <span class="hljs-keyword">string</span> <span class="hljs-variable">$username</span>,
        #[\SensitiveParameter] <span class="hljs-keyword">string</span> <span class="hljs-variable">$password</span>,
        #[\SensitiveParameter] <span class="hljs-keyword">string</span> <span class="hljs-variable">$token</span>
    </span>): <span class="hljs-title">AuthResult</span> </span>{
        <span class="hljs-comment">// å¯†ç å’Œä»¤ç‰Œåœ¨å †æ ˆè·Ÿè¸ªä¸­ä¼šè¢«éšè—</span>
        <span class="hljs-comment">// å¢å¼ºå®‰å…¨æ€§</span>
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">performAuth</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$token</span>);
        } <span class="hljs-keyword">catch</span> (AuthenticationException <span class="hljs-variable">$e</span>) {
            <span class="hljs-comment">// å¼‚å¸¸å †æ ˆä¸­ä¸ä¼šæ˜¾ç¤ºæ•æ„Ÿå‚æ•°</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-variable">$e</span>;
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">performAuth</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$username</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$password</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$token</span></span>): <span class="hljs-title">AuthResult</span>
    </span>{
        <span class="hljs-comment">// è®¤è¯é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AuthResult</span>();
    }
}

<span class="hljs-comment">/**
 * åŠ¨æ€ç±»å¸¸é‡è·å–
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Configuration</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">string</span> API_VERSION = <span class="hljs-string">'1.0.0'</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">int</span> MAX_RETRIES = <span class="hljs-number">3</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">float</span> TIMEOUT = <span class="hljs-number">30.0</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getConstant</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span></span>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-comment">// PHP 8.3 å…è®¸åŠ¨æ€è·å–ç±»å¸¸é‡</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">defined</span>(<span class="hljs-built_in">self</span>::<span class="hljs-variable language_">class</span> . <span class="hljs-string">'::'</span> . <span class="hljs-variable">$name</span>)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">InvalidArgumentException</span>(<span class="hljs-string">"Constant <span class="hljs-subst">{$name}</span> not defined"</span>);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">constant</span>(<span class="hljs-built_in">self</span>::<span class="hljs-variable language_">class</span> . <span class="hljs-string">'::'</span> . <span class="hljs-variable">$name</span>);
    }
}

<span class="hljs-comment">// ä½¿ç”¨ç¤ºä¾‹</span>
<span class="hljs-variable">$user</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ImmutableUser</span>(
    uuid: <span class="hljs-string">'550e8400-e29b-41d4-a716-446655440000'</span>,
    username: <span class="hljs-string">'john_doe'</span>,
    email: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Email</span>(<span class="hljs-string">'john@example.com'</span>),
    createdAt: <span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTimeImmutable</span>(),
    profile: <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserProfile</span>()
);

<span class="hljs-comment">// ä¸å¯å˜å¯¹è±¡ï¼Œè¿™è¡Œä¼šæŠ¥é”™</span>
<span class="hljs-comment">// $user-&gt;username = 'new_name'; // Error: Cannot modify readonly property</span>

<span class="hljs-comment">// æ­£ç¡®çš„æ–¹å¼æ˜¯åˆ›å»ºæ–°å®ä¾‹</span>
<span class="hljs-variable">$updatedUser</span> = <span class="hljs-variable">$user</span>-&gt;<span class="hljs-title function_ invoke__">withUsername</span>(<span class="hljs-string">'new_name'</span>);
</code></pre>
<h4 data-id="heading-3">1.2 JIT ç¼–è¯‘ä¸æ€§èƒ½ä¼˜åŒ–å®æˆ˜</h4>
<p>PHP 8.3 è¿›ä¸€æ­¥ä¼˜åŒ–äº† JIT ç¼–è¯‘å™¨ï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°å­¦è®¡ç®—å’Œæ•°æ®å¤„ç†æ–¹é¢è¡¨ç°å“è¶Šã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);

<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">ModernPHP</span>\<span class="hljs-title class_">Performance</span>;

<span class="hljs-comment">/**
 * JIT ä¼˜åŒ–ç¤ºä¾‹ - æ•°å€¼è®¡ç®—
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JitOptimizedCalculator</span>
</span>{
    <span class="hljs-comment">/**
     * ä½¿ç”¨ JIT ä¼˜åŒ–çš„æ•°å­¦è®¡ç®—
     * å¯¹äºå¾ªç¯å¯†é›†å‹è®¡ç®—ï¼ŒJIT å¯ä»¥æå‡ 2-3 å€æ€§èƒ½
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateStatisticalData</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-comment">// å¯ç”¨ JIT ä¼˜åŒ–çš„ä»£ç å—</span>
        <span class="hljs-variable">$sum</span> = <span class="hljs-number">0.0</span>;
        <span class="hljs-variable">$count</span> = <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$data</span>);
        <span class="hljs-variable">$squares</span> = <span class="hljs-number">0.0</span>;
        
        <span class="hljs-comment">// è¿™ä¸ªå¾ªç¯ä¼šè¢« JIT ç¼–è¯‘ä¼˜åŒ–</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$count</span>; <span class="hljs-variable">$i</span>++) {
            <span class="hljs-variable">$value</span> = (<span class="hljs-keyword">float</span>)<span class="hljs-variable">$data</span>[<span class="hljs-variable">$i</span>];
            <span class="hljs-variable">$sum</span> += <span class="hljs-variable">$value</span>;
            <span class="hljs-variable">$squares</span> += <span class="hljs-variable">$value</span> * <span class="hljs-variable">$value</span>;
        }
        
        <span class="hljs-variable">$mean</span> = <span class="hljs-variable">$sum</span> / <span class="hljs-variable">$count</span>;
        <span class="hljs-variable">$variance</span> = <span class="hljs-variable">$squares</span> / <span class="hljs-variable">$count</span> - <span class="hljs-variable">$mean</span> * <span class="hljs-variable">$mean</span>;
        <span class="hljs-variable">$stdDev</span> = <span class="hljs-title function_ invoke__">sqrt</span>(<span class="hljs-variable">$variance</span>);
        
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'mean'</span> =&gt; <span class="hljs-variable">$mean</span>,
            <span class="hljs-string">'variance'</span> =&gt; <span class="hljs-variable">$variance</span>,
            <span class="hljs-string">'std_dev'</span> =&gt; <span class="hljs-variable">$stdDev</span>,
            <span class="hljs-string">'sum'</span> =&gt; <span class="hljs-variable">$sum</span>,
            <span class="hljs-string">'count'</span> =&gt; <span class="hljs-variable">$count</span>
        ];
    }
    
    <span class="hljs-comment">/**
     * çŸ©é˜µè¿ç®—ä¼˜åŒ–
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">matrixMultiply</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$a</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$b</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable">$rowsA</span> = <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$a</span>);
        <span class="hljs-variable">$colsA</span> = <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>]);
        <span class="hljs-variable">$colsB</span> = <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$b</span>[<span class="hljs-number">0</span>]);
        
        <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">array_fill</span>(<span class="hljs-number">0</span>, <span class="hljs-variable">$rowsA</span>, <span class="hljs-title function_ invoke__">array_fill</span>(<span class="hljs-number">0</span>, <span class="hljs-variable">$colsB</span>, <span class="hljs-number">0</span>));
        
        <span class="hljs-comment">// JIT æ˜¾è‘—åŠ é€Ÿä¸‰é‡å¾ªç¯</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$rowsA</span>; <span class="hljs-variable">$i</span>++) {
            <span class="hljs-keyword">for</span> (<span class="hljs-variable">$j</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$j</span> &lt; <span class="hljs-variable">$colsB</span>; <span class="hljs-variable">$j</span>++) {
                <span class="hljs-variable">$sum</span> = <span class="hljs-number">0</span>;
                <span class="hljs-keyword">for</span> (<span class="hljs-variable">$k</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$k</span> &lt; <span class="hljs-variable">$colsA</span>; <span class="hljs-variable">$k</span>++) {
                    <span class="hljs-variable">$sum</span> += <span class="hljs-variable">$a</span>[<span class="hljs-variable">$i</span>][<span class="hljs-variable">$k</span>] * <span class="hljs-variable">$b</span>[<span class="hljs-variable">$k</span>][<span class="hljs-variable">$j</span>];
                }
                <span class="hljs-variable">$result</span>[<span class="hljs-variable">$i</span>][<span class="hljs-variable">$j</span>] = <span class="hljs-variable">$sum</span>;
            }
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>;
    }
}

<span class="hljs-comment">/**
 * å†…å­˜ä¼˜åŒ–ä¸ OPcache é¢„åŠ è½½
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OptimizedDataProcessor</span>
</span>{
    <span class="hljs-comment">// é¢„åŠ è½½çš„é…ç½®æ•°æ®</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$preloadedConfig</span>;
    
    <span class="hljs-comment">/**
     * åˆå§‹åŒ–æ—¶é¢„åŠ è½½æ•°æ®åˆ° OPcache
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">preload</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// è¿™äº›æ•°æ®ä¼šè¢«é¢„åŠ è½½åˆ°å†…å­˜ä¸­</span>
        <span class="hljs-built_in">self</span>::<span class="hljs-variable">$preloadedConfig</span> = [
            <span class="hljs-string">'settings'</span> =&gt; <span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/config/settings.php'</span>,
            <span class="hljs-string">'routes'</span> =&gt; <span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/config/routes.php'</span>,
            <span class="hljs-string">'services'</span> =&gt; <span class="hljs-keyword">require</span> <span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/config/services.php'</span>,
        ];
        
        <span class="hljs-comment">// é¢„çƒ­å¸¸ç”¨ç±»</span>
        <span class="hljs-title function_ invoke__">opcache_compile_file</span>(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/Calculator.php'</span>);
        <span class="hljs-title function_ invoke__">opcache_compile_file</span>(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/Validator.php'</span>);
        <span class="hljs-title function_ invoke__">opcache_compile_file</span>(<span class="hljs-keyword">__DIR__</span> . <span class="hljs-string">'/Transformer.php'</span>);
    }
    
    <span class="hljs-comment">/**
     * ä½¿ç”¨é¢„åŠ è½½æ•°æ®
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processWithPreloadedData</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$input</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-comment">// é›¶æˆæœ¬è®¿é—®é¢„åŠ è½½æ•°æ®</span>
        <span class="hljs-variable">$settings</span> = <span class="hljs-built_in">self</span>::<span class="hljs-variable">$preloadedConfig</span>[<span class="hljs-string">'settings'</span>];
        
        <span class="hljs-comment">// æ•°æ®å¤„ç†é€»è¾‘</span>
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">transformData</span>(<span class="hljs-variable">$input</span>, <span class="hljs-variable">$settings</span>);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformData</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$input</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$settings</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-comment">// æ•°æ®å¤„ç†é€»è¾‘</span>
        <span class="hljs-keyword">return</span> [
            <span class="hljs-string">'processed'</span> =&gt; <span class="hljs-literal">true</span>,
            <span class="hljs-string">'data'</span> =&gt; <span class="hljs-variable">$input</span>,
            <span class="hljs-string">'settings'</span> =&gt; <span class="hljs-variable">$settings</span>
        ];
    }
}

<span class="hljs-comment">// åœ¨ preload.php ä¸­</span>
<span class="hljs-comment">/*
opcache_compile_file('vendor/autoload.php');
opcache_compile_file('src/OptimizedDataProcessor.php');
*/</span>

<span class="hljs-comment">/**
 * åƒåœ¾å›æ”¶ä¼˜åŒ–
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MemoryEfficientProcessor</span>
</span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$buffer</span> = [];
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processLargeDataset</span>(<span class="hljs-params"><span class="hljs-keyword">iterable</span> <span class="hljs-variable">$dataset</span></span>): <span class="hljs-title">Generator</span>
    </span>{
        <span class="hljs-comment">// ä½¿ç”¨ç”Ÿæˆå™¨é¿å…å†…å­˜æº¢å‡º</span>
        <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$dataset</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) {
            <span class="hljs-keyword">yield</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">processItem</span>(<span class="hljs-variable">$item</span>);
            
            <span class="hljs-comment">// å®šæœŸè§¦å‘åƒåœ¾å›æ”¶</span>
            <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$this</span>-&gt;buffer) &gt; <span class="hljs-number">1000</span>) {
                <span class="hljs-variable language_">$this</span>-&gt;buffer = [];
                <span class="hljs-title function_ invoke__">gc_collect_cycles</span>();
            }
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processItem</span>(<span class="hljs-params"><span class="hljs-keyword">mixed</span> <span class="hljs-variable">$item</span></span>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-comment">// å¤„ç†é€»è¾‘</span>
        <span class="hljs-variable">$processed</span> = <span class="hljs-title function_ invoke__">do_processing</span>(<span class="hljs-variable">$item</span>);
        <span class="hljs-variable language_">$this</span>-&gt;buffer[] = <span class="hljs-variable">$processed</span>;
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$processed</span>;
    }
}
</code></pre>
<h3 data-id="heading-4">äºŒã€Swoole å¼‚æ­¥ç¼–ç¨‹ä¸åç¨‹å®æˆ˜</h3>
<h4 data-id="heading-5">2.1 åç¨‹ HTTP æœåŠ¡å™¨ä¸è¿æ¥æ± </h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);

<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">ModernPHP</span>\<span class="hljs-title class_">Swoole</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Request</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Response</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Server</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Coroutine</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Coroutine</span>\<span class="hljs-title">Channel</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Coroutine</span>\<span class="hljs-title">Http</span>\<span class="hljs-title">Client</span>;

<span class="hljs-comment">/**
 * é«˜æ€§èƒ½ Swoole HTTP æœåŠ¡å™¨
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HighPerformanceHttpServer</span>
</span>{
    <span class="hljs-keyword">private</span> Server <span class="hljs-variable">$server</span>;
    <span class="hljs-keyword">private</span> ConnectionPool <span class="hljs-variable">$mysqlPool</span>;
    <span class="hljs-keyword">private</span> ConnectionPool <span class="hljs-variable">$redisPool</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">
        <span class="hljs-keyword">string</span> <span class="hljs-variable">$host</span> = <span class="hljs-string">'0.0.0.0'</span>,
        <span class="hljs-keyword">int</span> <span class="hljs-variable">$port</span> = <span class="hljs-number">9501</span>
    </span>) </span>{
        <span class="hljs-variable language_">$this</span>-&gt;server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(<span class="hljs-variable">$host</span>, <span class="hljs-variable">$port</span>);
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">initializePools</span>();
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">configureServer</span>();
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializePools</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// MySQL è¿æ¥æ± </span>
        <span class="hljs-variable language_">$this</span>-&gt;mysqlPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionPool</span>(
            <span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"/>) =&gt;</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">createMysqlConnection</span>(),
            <span class="hljs-number">100</span>, <span class="hljs-comment">// æœ€å¤§è¿æ¥æ•°</span>
            <span class="hljs-number">10</span>   <span class="hljs-comment">// æœ€å°è¿æ¥æ•°</span>
        );
        
        <span class="hljs-comment">// Redis è¿æ¥æ± </span>
        <span class="hljs-variable language_">$this</span>-&gt;redisPool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConnectionPool</span>(
            <span class="hljs-function"><span class="hljs-keyword">fn</span>(<span class="hljs-params"/>) =&gt;</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">createRedisConnection</span>(),
            <span class="hljs-number">200</span>, <span class="hljs-comment">// æœ€å¤§è¿æ¥æ•°</span>
            <span class="hljs-number">20</span>   <span class="hljs-comment">// æœ€å°è¿æ¥æ•°</span>
        );
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureServer</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">set</span>([
            <span class="hljs-string">'worker_num'</span> =&gt; <span class="hljs-title function_ invoke__">swoole_cpu_num</span>() * <span class="hljs-number">2</span>,
            <span class="hljs-string">'task_worker_num'</span> =&gt; <span class="hljs-title function_ invoke__">swoole_cpu_num</span>(),
            <span class="hljs-string">'enable_static_handler'</span> =&gt; <span class="hljs-literal">true</span>,
            <span class="hljs-string">'document_root'</span> =&gt; <span class="hljs-string">'/path/to/static'</span>,
            <span class="hljs-string">'http_compression'</span> =&gt; <span class="hljs-literal">true</span>,
            <span class="hljs-string">'http_compression_level'</span> =&gt; <span class="hljs-number">6</span>,
            <span class="hljs-string">'package_max_length'</span> =&gt; <span class="hljs-number">50</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, // <span class="hljs-number">50</span>MB
            <span class="hljs-string">'buffer_output_size'</span> =&gt; <span class="hljs-number">32</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, // <span class="hljs-number">32</span>MB
            
            // åç¨‹é…ç½®
            <span class="hljs-string">'enable_coroutine'</span> =&gt; <span class="hljs-literal">true</span>,
            <span class="hljs-string">'max_coroutine'</span> =&gt; <span class="hljs-number">100000</span>,
            <span class="hljs-string">'socket_buffer_size'</span> =&gt; <span class="hljs-number">128</span> * <span class="hljs-number">1024</span>, // <span class="hljs-number">128</span>KB
        ]);
        
        <span class="hljs-comment">// æ³¨å†Œäº‹ä»¶å›è°ƒ</span>
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'start'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onStart'</span>]);
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'request'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onRequest'</span>]);
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'task'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onTask'</span>]);
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'finish'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onFinish'</span>]);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onStart</span>(<span class="hljs-params">Server <span class="hljs-variable">$server</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Swoole HTTP server is started at http://<span class="hljs-subst">{$server-&gt;host}</span>:<span class="hljs-subst">{$server-&gt;port}</span>\n"</span>;
    }
    
    <span class="hljs-comment">/**
     * å¼‚æ­¥éé˜»å¡è¯·æ±‚å¤„ç†
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onRequest</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span>, Response <span class="hljs-variable">$response</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// è®¾ç½®å“åº”å¤´</span>
        <span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'application/json'</span>);
        <span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Server'</span>, <span class="hljs-string">'Swoole/'</span> . SWOOLE_VERSION);
        
        <span class="hljs-comment">// å¼‚æ­¥å¹¶è¡Œå¤„ç†å¤šä¸ªä»»åŠ¡</span>
        <span class="hljs-title class_">Coroutine</span>::<span class="hljs-title function_ invoke__">create</span>(function () <span class="hljs-keyword">use</span> ($<span class="hljs-title">request</span>, $<span class="hljs-title">response</span>) {
            <span class="hljs-title">try</span> {
                // å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå¼‚æ­¥æ“ä½œ
                $<span class="hljs-title">results</span> = $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">parallelProcessing</span>($<span class="hljs-title">request</span>);
                
                <span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">end</span>(<span class="hljs-title function_ invoke__">json_encode</span>([
                    <span class="hljs-string">'success'</span> =&gt; <span class="hljs-literal">true</span>,
                    <span class="hljs-string">'data'</span> =&gt; <span class="hljs-variable">$results</span>,
                    <span class="hljs-string">'timestamp'</span> =&gt; <span class="hljs-title function_ invoke__">time</span>()
                ]));
            } <span class="hljs-keyword">catch</span> (\<span class="hljs-built_in">Throwable</span> <span class="hljs-variable">$e</span>) {
                <span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">status</span>(<span class="hljs-number">500</span>);
                <span class="hljs-variable">$response</span>-&gt;<span class="hljs-title function_ invoke__">end</span>(<span class="hljs-title function_ invoke__">json_encode</span>([
                    <span class="hljs-string">'success'</span> =&gt; <span class="hljs-literal">false</span>,
                    <span class="hljs-string">'error'</span> =&gt; <span class="hljs-variable">$e</span>-&gt;<span class="hljs-title function_ invoke__">getMessage</span>(),
                    <span class="hljs-string">'trace_id'</span> =&gt; <span class="hljs-title function_ invoke__">uniqid</span>(<span class="hljs-string">'err_'</span>, <span class="hljs-literal">true</span>)
                ]));
            }
        });
    }
    
    <span class="hljs-comment">/**
     * åç¨‹å¹¶è¡Œå¤„ç†ç¤ºä¾‹
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parallelProcessing</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable">$channel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Channel</span>(<span class="hljs-number">3</span>);
        
        <span class="hljs-comment">// å¹¶è¡Œæ‰§è¡Œä¸‰ä¸ªå¼‚æ­¥ä»»åŠ¡</span>
        <span class="hljs-title class_">Coroutine</span>::<span class="hljs-title function_ invoke__">create</span>(function () <span class="hljs-keyword">use</span> ($<span class="hljs-title">channel</span>) {
            $<span class="hljs-title">user</span> = $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">fetchUserFromDatabase</span>();
            <span class="hljs-variable">$channel</span>-&gt;<span class="hljs-title function_ invoke__">push</span>([<span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'user'</span>, <span class="hljs-string">'data'</span> =&gt; <span class="hljs-variable">$user</span>]);
        });
        
        <span class="hljs-title class_">Coroutine</span>::<span class="hljs-title function_ invoke__">create</span>(function () <span class="hljs-keyword">use</span> ($<span class="hljs-title">channel</span>, $<span class="hljs-title">request</span>) {
            $<span class="hljs-title">session</span> = $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">validateSession</span>($<span class="hljs-title">request</span>);
            <span class="hljs-variable">$channel</span>-&gt;<span class="hljs-title function_ invoke__">push</span>([<span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'session'</span>, <span class="hljs-string">'data'</span> =&gt; <span class="hljs-variable">$session</span>]);
        });
        
        <span class="hljs-title class_">Coroutine</span>::<span class="hljs-title function_ invoke__">create</span>(function () <span class="hljs-keyword">use</span> ($<span class="hljs-title">channel</span>, $<span class="hljs-title">request</span>) {
            $<span class="hljs-title">external</span> = $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">callExternalApi</span>($<span class="hljs-title">request</span>);
            <span class="hljs-variable">$channel</span>-&gt;<span class="hljs-title function_ invoke__">push</span>([<span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'external'</span>, <span class="hljs-string">'data'</span> =&gt; <span class="hljs-variable">$external</span>]);
        });
        
        <span class="hljs-comment">// æ”¶é›†æ‰€æœ‰ç»“æœ</span>
        <span class="hljs-variable">$results</span> = [];
        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">3</span>; <span class="hljs-variable">$i</span>++) {
            <span class="hljs-variable">$results</span>[] = <span class="hljs-variable">$channel</span>-&gt;<span class="hljs-title function_ invoke__">pop</span>(<span class="hljs-number">5.0</span>); <span class="hljs-comment">// 5ç§’è¶…æ—¶</span>
        }
        
        <span class="hljs-variable">$channel</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$results</span>;
    }
    
    <span class="hljs-comment">/**
     * ä½¿ç”¨è¿æ¥æ± æŸ¥è¯¢æ•°æ®åº“
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserFromDatabase</span>(<span class="hljs-params"/>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-comment">// ä»è¿æ¥æ± è·å–è¿æ¥</span>
        <span class="hljs-variable">$connection</span> = <span class="hljs-variable language_">$this</span>-&gt;mysqlPool-&gt;<span class="hljs-title function_ invoke__">get</span>();
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// æ‰§è¡ŒæŸ¥è¯¢</span>
            <span class="hljs-variable">$result</span> = <span class="hljs-variable">$connection</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(
                <span class="hljs-string">'SELECT * FROM users WHERE id = ? LIMIT 1'</span>,
                [<span class="hljs-title function_ invoke__">random_int</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>)]
            );
            
            <span class="hljs-keyword">return</span> <span class="hljs-variable">$result</span>-&gt;<span class="hljs-title function_ invoke__">fetchAssoc</span>();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-comment">// ç¡®ä¿è¿æ¥å½’è¿˜åˆ°è¿æ¥æ± </span>
            <span class="hljs-variable language_">$this</span>-&gt;mysqlPool-&gt;<span class="hljs-title function_ invoke__">put</span>(<span class="hljs-variable">$connection</span>);
        }
    }
    
    <span class="hljs-comment">/**
     * è°ƒç”¨å¤–éƒ¨ APIï¼ˆå¼‚æ­¥ HTTP å®¢æˆ·ç«¯ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callExternalApi</span>(<span class="hljs-params">Request <span class="hljs-variable">$request</span></span>): <span class="hljs-title">array</span>
    </span>{
        <span class="hljs-variable">$client</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Client</span>(<span class="hljs-string">'api.external.com'</span>, <span class="hljs-number">443</span>, <span class="hljs-literal">true</span>);
        <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">set</span>([
            <span class="hljs-string">'timeout'</span> =&gt; <span class="hljs-number">3.0</span>,
            <span class="hljs-string">'ssl_verify_peer'</span> =&gt; <span class="hljs-literal">false</span>,
        ]);
        
        <span class="hljs-comment">// å¼‚æ­¥è¯·æ±‚</span>
        <span class="hljs-variable">$client</span>-&gt;<span class="hljs-title function_ invoke__">get</span>(<span class="hljs-string">'/v1/data'</span>);
        
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$client</span>-&gt;statusCode === <span class="hljs-number">200</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$client</span>-&gt;body, <span class="hljs-literal">true</span>);
        }
        
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">'External API call failed'</span>);
    }
    
    <span class="hljs-comment">/**
     * å¼‚æ­¥ä»»åŠ¡å¤„ç†
     */</span>
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onTask</span>(<span class="hljs-params">Server <span class="hljs-variable">$server</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$taskId</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$workerId</span>, <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$data</span></span>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-comment">// å¤„ç†è€—æ—¶ä»»åŠ¡</span>
        <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$data</span>[<span class="hljs-string">'type'</span>]) {
            <span class="hljs-keyword">case</span> <span class="hljs-string">'email'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">sendEmail</span>(<span class="hljs-variable">$data</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">'report'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">generateReport</span>(<span class="hljs-variable">$data</span>);
            <span class="hljs-keyword">case</span> <span class="hljs-string">'backup'</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">backupData</span>(<span class="hljs-variable">$data</span>);
            <span class="hljs-keyword">default</span>:
                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }
    
    <span class="hljs-comment">/**
     * å‘é€é‚®ä»¶ï¼ˆå¼‚æ­¥ä»»åŠ¡ï¼‰
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendEmail</span>(<span class="hljs-params"><span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span></span>): <span class="hljs-title">bool</span>
    </span>{
        <span class="hljs-comment">// æ¨¡æ‹Ÿé‚®ä»¶å‘é€</span>
        <span class="hljs-title class_">Coroutine</span>::<span class="hljs-title function_ invoke__">sleep</span>(<span class="hljs-number">0.5</span>);
        
        <span class="hljs-comment">// å®é™…å‘é€é€»è¾‘</span>
        <span class="hljs-comment">// mail($data['to'], $data['subject'], $data['body']);</span>
        
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">start</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">start</span>();
    }
}

<span class="hljs-comment">/**
 * é€šç”¨è¿æ¥æ± å®ç°
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ConnectionPool</span>
</span>{
    <span class="hljs-keyword">private</span> Channel <span class="hljs-variable">$pool</span>;
    <span class="hljs-keyword">private</span> \<span class="hljs-built_in">Closure</span> <span class="hljs-variable">$constructor</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-variable">$size</span>;
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params">\<span class="hljs-built_in">Closure</span> <span class="hljs-variable">$constructor</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$maxSize</span> = <span class="hljs-number">100</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$minSize</span> = <span class="hljs-number">10</span></span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;constructor = <span class="hljs-variable">$constructor</span>;
        <span class="hljs-variable language_">$this</span>-&gt;pool = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Channel</span>(<span class="hljs-variable">$maxSize</span>);
        <span class="hljs-variable language_">$this</span>-&gt;size = <span class="hljs-number">0</span>;
        
        <span class="hljs-comment">// åˆå§‹åŒ–æœ€å°è¿æ¥æ•°</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$minSize</span>; <span class="hljs-variable">$i</span>++) {
            <span class="hljs-variable language_">$this</span>-&gt;pool-&gt;<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-title function_ invoke__">createConnection</span>());
        }
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"/>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-comment">// ä»æ± ä¸­è·å–è¿æ¥</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;pool-&gt;<span class="hljs-title function_ invoke__">isEmpty</span>() &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;size &lt; <span class="hljs-variable language_">$this</span>-&gt;pool-&gt;capacity) {
            <span class="hljs-comment">// åˆ›å»ºæ–°è¿æ¥</span>
            <span class="hljs-variable language_">$this</span>-&gt;size++;
            <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">$this</span>-&gt;constructor)();
        }
        
        <span class="hljs-comment">// ç­‰å¾…å¯ç”¨è¿æ¥ï¼ˆè¶…æ—¶ 3 ç§’ï¼‰</span>
        <span class="hljs-variable">$connection</span> = <span class="hljs-variable language_">$this</span>-&gt;pool-&gt;<span class="hljs-title function_ invoke__">pop</span>(<span class="hljs-number">3.0</span>);
        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$connection</span> === <span class="hljs-literal">false</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RuntimeException</span>(<span class="hljs-string">'Connection pool timeout'</span>);
        }
        
        <span class="hljs-keyword">return</span> <span class="hljs-variable">$connection</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">put</span>(<span class="hljs-params"><span class="hljs-keyword">mixed</span> <span class="hljs-variable">$connection</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// å½’è¿˜è¿æ¥åˆ°æ± ä¸­</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;pool-&gt;<span class="hljs-title function_ invoke__">isFull</span>()) {
            <span class="hljs-comment">// è¿æ¥æ± å·²æ»¡ï¼Œå…³é—­è¿æ¥</span>
            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">closeConnection</span>(<span class="hljs-variable">$connection</span>);
            <span class="hljs-variable language_">$this</span>-&gt;size--;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-variable language_">$this</span>-&gt;pool-&gt;<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-variable">$connection</span>);
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createConnection</span>(<span class="hljs-params"/>): <span class="hljs-title">mixed</span>
    </span>{
        <span class="hljs-keyword">return</span> (<span class="hljs-variable language_">$this</span>-&gt;constructor)();
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">closeConnection</span>(<span class="hljs-params"><span class="hljs-keyword">mixed</span> <span class="hljs-variable">$connection</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// å…³é—­è¿æ¥é€»è¾‘</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">method_exists</span>(<span class="hljs-variable">$connection</span>, <span class="hljs-string">'close'</span>)) {
            <span class="hljs-variable">$connection</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();
        }
    }
}
</code></pre>
<h4 data-id="heading-6">2.2 WebSocket å®æ—¶é€šä¿¡ä¸ RPC æœåŠ¡</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">declare</span>(strict_types=<span class="hljs-number">1</span>);

<span class="hljs-keyword">namespace</span> <span class="hljs-title class_">ModernPHP</span>\<span class="hljs-title class_">Swoole</span>\<span class="hljs-title class_">WebSocket</span>;

<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">WebSocket</span>\<span class="hljs-title">Server</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">WebSocket</span>\<span class="hljs-title">Frame</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Coroutine</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Coroutine</span>\<span class="hljs-title">Channel</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Atomic</span>;
<span class="hljs-keyword">use</span> <span class="hljs-title">Swoole</span>\<span class="hljs-title">Table</span>;

<span class="hljs-comment">/**
 * é«˜æ€§èƒ½ WebSocket æœåŠ¡å™¨
 */</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RealTimeWebSocketServer</span>
</span>{
    <span class="hljs-keyword">private</span> Server <span class="hljs-variable">$server</span>;
    <span class="hljs-keyword">private</span> Table <span class="hljs-variable">$connectionTable</span>;
    <span class="hljs-keyword">private</span> Atomic <span class="hljs-variable">$connectionCounter</span>;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">array</span> <span class="hljs-variable">$roomSubscriptions</span> = [];
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$host</span> = <span class="hljs-string">'0.0.0.0'</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$port</span> = <span class="hljs-number">9502</span></span>)
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;server = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Server</span>(<span class="hljs-variable">$host</span>, <span class="hljs-variable">$port</span>);
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">initializeTables</span>();
        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">configureServer</span>();
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">initializeTables</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-comment">// ç”¨äºå­˜å‚¨è¿æ¥ä¿¡æ¯çš„å…±äº«å†…å­˜è¡¨</span>
        <span class="hljs-variable language_">$this</span>-&gt;connectionTable = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Table</span>(<span class="hljs-number">1024</span>);
        <span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">column</span>(<span class="hljs-string">'fd'</span>, <span class="hljs-title class_">Table</span>::<span class="hljs-variable constant_">TYPE_INT</span>);
        <span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">column</span>(<span class="hljs-string">'user_id'</span>, <span class="hljs-title class_">Table</span>::<span class="hljs-variable constant_">TYPE_INT</span>);
        <span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">column</span>(<span class="hljs-string">'connected_at'</span>, <span class="hljs-title class_">Table</span>::<span class="hljs-variable constant_">TYPE_INT</span>);
        <span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">column</span>(<span class="hljs-string">'last_activity'</span>, <span class="hljs-title class_">Table</span>::<span class="hljs-variable constant_">TYPE_INT</span>);
        <span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">column</span>(<span class="hljs-string">'metadata'</span>, <span class="hljs-title class_">Table</span>::<span class="hljs-variable constant_">TYPE_STRING</span>, <span class="hljs-number">1024</span>);
        <span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">create</span>();
        
        <span class="hljs-variable language_">$this</span>-&gt;connectionCounter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Atomic</span>(<span class="hljs-number">0</span>);
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">configureServer</span>(<span class="hljs-params"/>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">set</span>([
            <span class="hljs-string">'worker_num'</span> =&gt; <span class="hljs-title function_ invoke__">swoole_cpu_num</span>(),
            <span class="hljs-string">'task_worker_num'</span> =&gt; <span class="hljs-number">4</span>,
            <span class="hljs-string">'heartbeat_idle_time'</span> =&gt; <span class="hljs-number">300</span>,
            <span class="hljs-string">'heartbeat_check_interval'</span> =&gt; <span class="hljs-number">60</span>,
            <span class="hljs-string">'open_websocket_protocol'</span> =&gt; <span class="hljs-literal">true</span>,
            <span class="hljs-string">'websocket_compression'</span> =&gt; <span class="hljs-literal">true</span>,
            
            // SSL æ”¯æŒ
            <span class="hljs-string">'ssl_cert_file'</span> =&gt; <span class="hljs-string">'/path/to/cert.pem'</span>,
            <span class="hljs-string">'ssl_key_file'</span> =&gt; <span class="hljs-string">'/path/to/key.pem'</span>,
            <span class="hljs-string">'ssl_verify_peer'</span> =&gt; <span class="hljs-literal">false</span>,
        ]);
        
        <span class="hljs-comment">// æ³¨å†Œäº‹ä»¶å›è°ƒ</span>
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'start'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onStart'</span>]);
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'open'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onOpen'</span>]);
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'message'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onMessage'</span>]);
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'close'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onClose'</span>]);
        <span class="hljs-variable language_">$this</span>-&gt;server-&gt;<span class="hljs-title function_ invoke__">on</span>(<span class="hljs-string">'task'</span>, [<span class="hljs-variable">$this</span>, <span class="hljs-string">'onTask'</span>]);
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onStart</span>(<span class="hljs-params">Server <span class="hljs-variable">$server</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"WebSocket server started at ws://<span class="hljs-subst">{$server-&gt;host}</span>:<span class="hljs-subst">{$server-&gt;port}</span>\n"</span>;
        
        <span class="hljs-comment">// å¯åŠ¨å¿ƒè·³æ£€æµ‹åç¨‹</span>
        <span class="hljs-title class_">Coroutine</span>::<span class="hljs-title function_ invoke__">create</span>(function () <span class="hljs-keyword">use</span> ($<span class="hljs-title">server</span>) {
            $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">heartbeatMonitor</span>($<span class="hljs-title">server</span>);
        });
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onOpen</span>(<span class="hljs-params">Server <span class="hljs-variable">$server</span>, \Swoole\Http\Request <span class="hljs-variable">$request</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable">$fd</span> = <span class="hljs-variable">$request</span>-&gt;fd;
        <span class="hljs-variable language_">$this</span>-&gt;connectionCounter-&gt;<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-number">1</span>);
        
        <span class="hljs-comment">// å­˜å‚¨è¿æ¥ä¿¡æ¯</span>
        <span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-variable">$fd</span>, [
            <span class="hljs-string">'fd'</span> =&gt; <span class="hljs-variable">$fd</span>,
            <span class="hljs-string">'user_id'</span> =&gt; (<span class="hljs-keyword">int</span>)(<span class="hljs-variable">$request</span>-&gt;get[<span class="hljs-string">'user_id'</span>] ?? <span class="hljs-number">0</span>),
            <span class="hljs-string">'connected_at'</span> =&gt; <span class="hljs-title function_ invoke__">time</span>(),
            <span class="hljs-string">'last_activity'</span> =&gt; <span class="hljs-title function_ invoke__">time</span>(),
            <span class="hljs-string">'metadata'</span> =&gt; <span class="hljs-title function_ invoke__">json_encode</span>([
                <span class="hljs-string">'ip'</span> =&gt; <span class="hljs-variable">$request</span>-&gt;server[<span class="hljs-string">'remote_addr'</span>],
                <span class="hljs-string">'user_agent'</span> =&gt; <span class="hljs-variable">$request</span>-&gt;header[<span class="hljs-string">'user-agent'</span>] ?? <span class="hljs-string">''</span>,
                <span class="hljs-string">'query'</span> =&gt; <span class="hljs-variable">$request</span>-&gt;get,
            ])
        ]);
        
        <span class="hljs-comment">// å‘é€æ¬¢è¿æ¶ˆæ¯</span>
        <span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-variable">$fd</span>, <span class="hljs-title function_ invoke__">json_encode</span>([
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'welcome'</span>,
            <span class="hljs-string">'data'</span> =&gt; [
                <span class="hljs-string">'connection_id'</span> =&gt; <span class="hljs-variable">$fd</span>,
                <span class="hljs-string">'server_time'</span> =&gt; <span class="hljs-title function_ invoke__">time</span>(),
                <span class="hljs-string">'total_connections'</span> =&gt; <span class="hljs-variable">$this</span>-&gt;connectionCounter-&gt;<span class="hljs-title function_ invoke__">get</span>(),
            ]
        ]));
        
        <span class="hljs-keyword">echo</span> <span class="hljs-string">"New connection: FD=<span class="hljs-subst">{$fd}</span>, Total=<span class="hljs-subst">{$this-&gt;connectionCounter-&gt;get()}</span>\n"</span>;
    }
    
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onMessage</span>(<span class="hljs-params">Server <span class="hljs-variable">$server</span>, Frame <span class="hljs-variable">$frame</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable">$fd</span> = <span class="hljs-variable">$frame</span>-&gt;fd;
        
        <span class="hljs-comment">// æ›´æ–°æœ€åæ´»åŠ¨æ—¶é—´</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">exist</span>(<span class="hljs-variable">$fd</span>)) {
            <span class="hljs-variable language_">$this</span>-&gt;connectionTable-&gt;<span class="hljs-title function_ invoke__">set</span>(<span class="hljs-variable">$fd</span>, [<span class="hljs-string">'last_activity'</span> =&gt; <span class="hljs-title function_ invoke__">time</span>()]);
        }
        
        <span class="hljs-keyword">try</span> {
            <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$frame</span>-&gt;data, <span class="hljs-literal">true</span>, <span class="hljs-number">512</span>, JSON_THROW_ON_ERROR);
            
            <span class="hljs-keyword">switch</span> (<span class="hljs-variable">$data</span>[<span class="hljs-string">'type'</span>] ?? <span class="hljs-string">''</span>) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'subscribe'</span>:
                    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">handleSubscribe</span>(<span class="hljs-variable">$server</span>, <span class="hljs-variable">$fd</span>, <span class="hljs-variable">$data</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'unsubscribe'</span>:
                    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">handleUnsubscribe</span>(<span class="hljs-variable">$server</span>, <span class="hljs-variable">$fd</span>, <span class="hljs-variable">$data</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'message'</span>:
                    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">handleMessage</span>(<span class="hljs-variable">$server</span>, <span class="hljs-variable">$fd</span>, <span class="hljs-variable">$data</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'rpc'</span>:
                    <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">handleRpc</span>(<span class="hljs-variable">$server</span>, <span class="hljs-variable">$fd</span>, <span class="hljs-variable">$data</span>);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">default</span>:
                    <span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-variable">$fd</span>, <span class="hljs-title function_ invoke__">json_encode</span>([
                        <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'error'</span>,
                        <span class="hljs-string">'error'</span> =&gt; <span class="hljs-string">'Unknown message type'</span>
                    ]));
            }
        } <span class="hljs-keyword">catch</span> (\JsonException <span class="hljs-variable">$e</span>) {
            <span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-variable">$fd</span>, <span class="hljs-title function_ invoke__">json_encode</span>([
                <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'error'</span>,
                <span class="hljs-string">'error'</span> =&gt; <span class="hljs-string">'Invalid JSON format'</span>
            ]));
        }
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleSubscribe</span>(<span class="hljs-params">Server <span class="hljs-variable">$server</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$fd</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable">$room</span> = <span class="hljs-variable">$data</span>[<span class="hljs-string">'room'</span>] ?? <span class="hljs-string">''</span>;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$room</span>)) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;roomSubscriptions[<span class="hljs-variable">$room</span>])) {
            <span class="hljs-variable language_">$this</span>-&gt;roomSubscriptions[<span class="hljs-variable">$room</span>] = [];
        }
        
        <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$fd</span>, <span class="hljs-variable">$this</span>-&gt;roomSubscriptions[<span class="hljs-variable">$room</span>], <span class="hljs-literal">true</span>)) {
            <span class="hljs-variable language_">$this</span>-&gt;roomSubscriptions[<span class="hljs-variable">$room</span>][] = <span class="hljs-variable">$fd</span>;
        }
        
        <span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-variable">$fd</span>, <span class="hljs-title function_ invoke__">json_encode</span>([
            <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'subscribed'</span>,
            <span class="hljs-string">'room'</span> =&gt; <span class="hljs-variable">$room</span>,
            <span class="hljs-string">'subscriber_count'</span> =&gt; <span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$this</span>-&gt;roomSubscriptions[<span class="hljs-variable">$room</span>])
        ]));
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMessage</span>(<span class="hljs-params">Server <span class="hljs-variable">$server</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$fd</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable">$room</span> = <span class="hljs-variable">$data</span>[<span class="hljs-string">'room'</span>] ?? <span class="hljs-string">''</span>;
        <span class="hljs-variable">$message</span> = <span class="hljs-variable">$data</span>[<span class="hljs-string">'message'</span>] ?? <span class="hljs-string">''</span>;
        
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$room</span>) || <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$message</span>)) {
            <span class="hljs-keyword">return</span>;
        }
        
        <span class="hljs-comment">// å¹¿æ’­æ¶ˆæ¯åˆ°æˆ¿é—´</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;roomSubscriptions[<span class="hljs-variable">$room</span>])) {
            <span class="hljs-variable">$broadcastData</span> = <span class="hljs-title function_ invoke__">json_encode</span>([
                <span class="hljs-string">'type'</span> =&gt; <span class="hljs-string">'broadcast'</span>,
                <span class="hljs-string">'room'</span> =&gt; <span class="hljs-variable">$room</span>,
                <span class="hljs-string">'from'</span> =&gt; <span class="hljs-variable">$fd</span>,
                <span class="hljs-string">'message'</span> =&gt; <span class="hljs-variable">$message</span>,
                <span class="hljs-string">'timestamp'</span> =&gt; <span class="hljs-title function_ invoke__">time</span>()
            ]);
            
            <span class="hljs-keyword">foreach</span> (<span class="hljs-variable language_">$this</span>-&gt;roomSubscriptions[<span class="hljs-variable">$room</span>] <span class="hljs-keyword">as</span> <span class="hljs-variable">$subscriberFd</span>) {
                <span class="hljs-keyword">if</span> (<span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">exist</span>(<span class="hljs-variable">$subscriberFd</span>) &amp;&amp; <span class="hljs-variable">$subscriberFd</span> !== <span class="hljs-variable">$fd</span>) {
                    <span class="hljs-variable">$server</span>-&gt;<span class="hljs-title function_ invoke__">push</span>(<span class="hljs-variable">$subscriberFd</span>, <span class="hljs-variable">$broadcastData</span>);
                }
            }
        }
    }
    
    <span class="hljs-comment">/**
     * WebSocket RPC è°ƒç”¨å¤„ç†
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleRpc</span>(<span class="hljs-params">Server <span class="hljs-variable">$server</span>, <span class="hljs-keyword">int</span> <span class="hljs-variable">$fd</span>, <span class="hljs-keyword">array</span> <span class="hljs-variable">$data</span></span>): <span class="hljs-title">void</span>
    </span>{
        <span class="hljs-variable">$method</span> = <span class="hljs-variable">$data</span>[<span class="hljs-string">'method'</span>] ?? <span class="hljs-string">''</span>;
        <span class="hljs-variable">$params</span> = <span class="hljs-variable">$data</span>[<span class="hljs-string">'params'</span>] ?? [];
        <span class="hljs-variable">$id</span> = <span class="hljs-variable">$data</span>[<span class="hljs-string">'id'</span>] ?? <span class="hljs-literal">null</span>;
        
        <span class="hljs-title class_">Coroutine</span>::<span class="hljs-title function_ invoke__">create</span>(function () <span class="hljs-keyword">use</span> ($<span class="hljs-title">server</span>, $<span class="hljs-title">fd</span>, $<span class="hljs-title">method</span>, $<span class="hljs-title">params</span>, $<span class="hljs-title">id</span>) {
            <span class="hljs-title">try</span> {
                $<span class="hljs-title">result</span> = $<span class="hljs-title">this</span>-&gt;<span class="hljs-title">callRpcMethod</span>($<span class="hljs-title">method</span>, $<span class="hljs-title">params</span>);
                
                <span class="hljs-variable">$response</span> = [
                    <span class="hljs-string">'type'</span> =&gt;
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æœåŠ¡å™¨ å¼€æœºå¯åŠ¨ + å®šæ—¶ä»»åŠ¡ + Shell è„šæœ¬è‡ªåŠ¨å¤‡ä»½ MySQL æ•°æ®åº“]]></title>    <link>https://juejin.cn/post/7597276695402315817</link>    <guid>https://juejin.cn/post/7597276695402315817</guid>    <pubDate>2026-01-20T09:39:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597276695402315817" data-draft-id="7375504338758107174" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æœåŠ¡å™¨  å¼€æœºå¯åŠ¨ + å®šæ—¶ä»»åŠ¡ + Shell è„šæœ¬è‡ªåŠ¨å¤‡ä»½ MySQL æ•°æ®åº“"/> <meta itemprop="keywords" content="MySQL"/> <meta itemprop="datePublished" content="2026-01-20T09:39:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ZeroSilin"/> <meta itemprop="url" content="https://juejin.cn/user/2858385964277960"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æœåŠ¡å™¨  å¼€æœºå¯åŠ¨ + å®šæ—¶ä»»åŠ¡ + Shell è„šæœ¬è‡ªåŠ¨å¤‡ä»½ MySQL æ•°æ®åº“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2858385964277960/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ZeroSilin
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:39:01.000Z" title="Tue Jan 20 2026 09:39:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>tip:éœ€æ±‚è¦æ±‚æ•°æ®åº“å®šæ—¶å¤‡ä»½ï¼Œå¦‚æœå¼€æœºåä¹Ÿéœ€è¦å¯åŠ¨è¿è¡Œå®šæ—¶å¤‡ä»½</p>
<h3 data-id="heading-0">å‰ç½®æ¡ä»¶</h3>
<ul>
<li>CentOS 7 æœåŠ¡å™¨ã€‚</li>
<li>å®‰è£…å¹¶è¿è¡Œ MySQL æ•°æ®åº“ã€‚</li>
<li>æœ‰è¶³å¤Ÿçš„æƒé™æ¥åˆ›å»ºå¤‡ä»½è„šæœ¬å¹¶è®¾ç½®Â <code>cron</code>Â ä»»åŠ¡ã€‚</li>
</ul>
<h3 data-id="heading-1">åˆ›å»ºå¤‡ä»½è„šæœ¬</h3>
<p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">mkdir</span> /root/mysql_back
<span class="hljs-built_in">mkdir</span> /root/mysql_back/backup
</code></pre>
<p>åˆ›å»ºè„šæœ¬</p>
<pre><code class="hljs language-bash" lang="bash">vim /root/mysql_backup.sh
</code></pre>
<p>å¤åˆ¶ä¸‹é¢è„šæœ¬</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-meta">#!/bin/bash</span>
DATE=$(<span class="hljs-built_in">date</span> +%Y%m%d_%H%M%S)
BACKUP_DIR=<span class="hljs-string">"/root/mysql_back/backup"</span>
DB_USER=<span class="hljs-string">"your_username"</span>
DB_PASSWORD=<span class="hljs-string">"your_password"</span>
DB_NAME=<span class="hljs-string">"device_dev"</span>

mysqldump -u <span class="hljs-variable">$DB_USER</span> -p<span class="hljs-variable">$DB_PASSWORD</span> <span class="hljs-variable">$DB_NAME</span> &gt; <span class="hljs-string">"<span class="hljs-variable">$BACKUP_DIR</span>/device_dev_backup_<span class="hljs-variable">$DATE</span>.sql"</span>
</code></pre>
<p>æ›¿æ¢Â <code>BACKUP_DIR</code>ã€<code>DB_USER</code>Â å’ŒÂ <code>DB_PASSWORD</code>Â ä¸ºä½ çš„å®é™…å¤‡ä»½ç›®å½•å’ŒMySQLå‡­æ®ã€‚</p>
<p>å¯ä»¥ä¸ºÂ <code>BACKUP_DIR</code>Â æ·»åŠ ä¸€ä¸‹æ‰§è¡Œæƒé™</p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">chmod</span> -R 700 /root/mysql_back/
</code></pre>
<p>ä½¿è„šæœ¬å¯æ‰§è¡Œ</p>
<pre><code class="hljs language-bash" lang="bash">sudo <span class="hljs-built_in">chmod</span> +x /root/mysql_backup.sh
</code></pre>
<h3 data-id="heading-2">è®¾ç½® å¼€æœºå¯åŠ¨</h3>
<pre><code class="hljs language-bash" lang="bash">sudo nano /etc/systemd/system/mysql_back.service
</code></pre>
<p>æ›¿æ¢mysql_backåç§°</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span>=MySQL_BackUp
<span class="hljs-attr">After</span>=network.target

<span class="hljs-section">[Service]</span>
<span class="hljs-attr">Type</span>=simple
<span class="hljs-attr">ExecStart</span>=/root/mysql_backup.sh
<span class="hljs-attr">Restart</span>=<span class="hljs-literal">on</span>-failure

<span class="hljs-section">[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target
</code></pre>
<p>æ›¿æ¢My Script Serviceåç§°ã€ExecStartçš„è·¯å¾„ï¼Œå†™ä¸ºè„šæœ¬è·¯å¾„.</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¾®ä¿¡å°æ¸¸æˆ0åŸºç¡€å°±ä¸šç­+CTOè¿›é˜¶ç­]]></title>    <link>https://juejin.cn/post/7597025960946958371</link>    <guid>https://juejin.cn/post/7597025960946958371</guid>    <pubDate>2026-01-20T09:40:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597025960946958371" data-draft-id="7597259271109902376" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¾®ä¿¡å°æ¸¸æˆ0åŸºç¡€å°±ä¸šç­+CTOè¿›é˜¶ç­ "/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-20T09:40:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·557744506908"/> <meta itemprop="url" content="https://juejin.cn/user/749198160955433"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¾®ä¿¡å°æ¸¸æˆ0åŸºç¡€å°±ä¸šç­+CTOè¿›é˜¶ç­ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/749198160955433/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·557744506908
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:40:51.000Z" title="Tue Jan 20 2026 09:40:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>å¾®ä¿¡å°æ¸¸æˆ0åŸºç¡€å°±ä¸šç­+CTOè¿›é˜¶ç­---youkeit.xyz/15541/å‰</strong></p>
<h2 data-id="heading-0">å¾®ä¿¡å°æ¸¸æˆå…¨æ ˆæˆé•¿ä½“ç³»ï¼šä»0åŸºç¡€åˆ°CTOçš„AIèµ‹èƒ½è·¯å¾„</h2>
<h3 data-id="heading-1">ç¬¬ä¸€ç« ï¼šå¾®ä¿¡å°æ¸¸æˆæŠ€æœ¯æ ˆå…¨æ™¯è§£æ</h3>
<h4 data-id="heading-2">1.1 ç°ä»£å°æ¸¸æˆå¼€å‘æŠ€æœ¯æ¶æ„</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// game-core/GameEngine.ts - ç°ä»£å°æ¸¸æˆå¼•æ“æ ¸å¿ƒ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">GameConfig</span> {
  <span class="hljs-attr">canvas</span>: <span class="hljs-title class_">WechatMiniprogram</span>.<span class="hljs-property">Canvas</span>
  <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span>
  maxFPS?: <span class="hljs-built_in">number</span>
  debug?: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">GameEngine</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">canvas</span>: <span class="hljs-title class_">WechatMiniprogram</span>.<span class="hljs-property">Canvas</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">ctx</span>: <span class="hljs-title class_">WechatMiniprogram</span>.<span class="hljs-property">CanvasContext</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">GameConfig</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">lastTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">accumulatedTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">isRunning</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>
  
  <span class="hljs-comment">// æ¸¸æˆçŠ¶æ€ç®¡ç†</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">states</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">GameState</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()
  <span class="hljs-keyword">private</span> <span class="hljs-attr">currentState</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>
  
  <span class="hljs-comment">// AIèµ‹èƒ½æ¨¡å—</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">aiModule</span>: <span class="hljs-title class_">AIModule</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">analyticsModule</span>: <span class="hljs-title class_">AnalyticsModule</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: GameConfig</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = {
      <span class="hljs-attr">maxFPS</span>: <span class="hljs-number">60</span>,
      <span class="hljs-attr">debug</span>: <span class="hljs-literal">false</span>,
      ...config
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span> = config.<span class="hljs-property">canvas</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">canvas</span>.<span class="hljs-title function_">getContext</span>(<span class="hljs-string">'2d'</span>)
    
    <span class="hljs-comment">// åˆå§‹åŒ–AIæ¨¡å—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiModule</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIModule</span>({
      <span class="hljs-attr">gameContext</span>: <span class="hljs-variable language_">this</span>,
      <span class="hljs-attr">modelPath</span>: <span class="hljs-string">'models/game-ai'</span>
    })
    
    <span class="hljs-comment">// åˆå§‹åŒ–åˆ†ææ¨¡å—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">analyticsModule</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnalyticsModule</span>()
    
    <span class="hljs-comment">// ç»‘å®šäº‹ä»¶</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">bindEvents</span>()
  }
  
  <span class="hljs-comment">// çŠ¶æ€ç®¡ç†æ¨¡å¼</span>
  <span class="hljs-title function_">registerState</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, state: GameState</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">states</span>.<span class="hljs-title function_">set</span>(name, state)
  }
  
  <span class="hljs-title function_">switchState</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, data?: <span class="hljs-built_in">any</span></span>) {
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentState</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">states</span>.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentState</span>)?.<span class="hljs-title function_">exit</span>()
    }
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentState</span> = name
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-property">states</span>.<span class="hljs-title function_">get</span>(name)
    
    <span class="hljs-keyword">if</span> (state) {
      state.<span class="hljs-title function_">enter</span>(data)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">analyticsModule</span>.<span class="hljs-title function_">trackEvent</span>(<span class="hljs-string">'game_state_change'</span>, {
        <span class="hljs-attr">from</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentState</span>,
        <span class="hljs-attr">to</span>: name,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
      })
    }
  }
  
  <span class="hljs-comment">// ä¸»æ¸¸æˆå¾ªç¯ - ä½¿ç”¨å›ºå®šæ—¶é—´æ­¥é•¿</span>
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">gameLoop</span>(<span class="hljs-params">timestamp: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isRunning</span>) <span class="hljs-keyword">return</span>
    
    <span class="hljs-keyword">const</span> deltaTime = timestamp - <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastTime</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastTime</span> = timestamp
    
    <span class="hljs-comment">// ç´¯ç§¯æ—¶é—´</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">accumulatedTime</span> += deltaTime
    
    <span class="hljs-keyword">const</span> fixedTimeStep = <span class="hljs-number">1000</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">maxFPS</span>!
    
    <span class="hljs-comment">// æ›´æ–°æ¸¸æˆé€»è¾‘</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">accumulatedTime</span> &gt;= fixedTimeStep) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">update</span>(fixedTimeStep)
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">accumulatedTime</span> -= fixedTimeStep
    }
    
    <span class="hljs-comment">// æ¸²æŸ“</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">render</span>()
    
    <span class="hljs-comment">// è¯·æ±‚ä¸‹ä¸€å¸§</span>
    wx.<span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gameLoop</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>))
  }
  
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">update</span>(<span class="hljs-params">deltaTime: <span class="hljs-built_in">number</span></span>) {
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-property">states</span>.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentState</span>)
    <span class="hljs-keyword">if</span> (state) {
      state.<span class="hljs-title function_">update</span>(deltaTime)
      
      <span class="hljs-comment">// AIè¾…åŠ©å†³ç­–</span>
      <span class="hljs-keyword">const</span> aiSuggestion = <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiModule</span>.<span class="hljs-title function_">getGameplaySuggestion</span>(state.<span class="hljs-title function_">getContext</span>())
      <span class="hljs-keyword">if</span> (aiSuggestion) {
        state.<span class="hljs-title function_">applyAISuggestion</span>(aiSuggestion)
      }
    }
  }
  
  <span class="hljs-keyword">private</span> <span class="hljs-title function_">render</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ¸…é™¤ç”»å¸ƒ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">clearRect</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">width</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">height</span>)
    
    <span class="hljs-keyword">const</span> state = <span class="hljs-variable language_">this</span>.<span class="hljs-property">states</span>.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentState</span>)
    <span class="hljs-keyword">if</span> (state) {
      state.<span class="hljs-title function_">render</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>)
    }
    
    <span class="hljs-comment">// è°ƒè¯•ä¿¡æ¯</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">debug</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderDebugInfo</span>()
    }
  }
  
  <span class="hljs-title function_">start</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRunning</span> = <span class="hljs-literal">true</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastTime</span> = performance.<span class="hljs-title function_">now</span>()
    wx.<span class="hljs-title function_">requestAnimationFrame</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">gameLoop</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>))
  }
  
  <span class="hljs-title function_">stop</span>(<span class="hljs-params"/>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRunning</span> = <span class="hljs-literal">false</span>
  }
}

<span class="hljs-comment">// æ¸¸æˆçŠ¶æ€åŸºç±»</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GameState</span> {
  <span class="hljs-keyword">protected</span> <span class="hljs-attr">engine</span>: <span class="hljs-title class_">GameEngine</span>
  <span class="hljs-keyword">protected</span> <span class="hljs-attr">aiContext</span>: <span class="hljs-built_in">any</span> = {}
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">engine: GameEngine</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">engine</span> = engine
  }
  
  <span class="hljs-keyword">abstract</span> <span class="hljs-title function_">enter</span>(data?: <span class="hljs-built_in">any</span>): <span class="hljs-built_in">void</span>
  <span class="hljs-keyword">abstract</span> <span class="hljs-title function_">update</span>(<span class="hljs-attr">deltaTime</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span>
  <span class="hljs-keyword">abstract</span> <span class="hljs-title function_">render</span>(<span class="hljs-attr">ctx</span>: <span class="hljs-title class_">WechatMiniprogram</span>.<span class="hljs-property">CanvasContext</span>): <span class="hljs-built_in">void</span>
  <span class="hljs-keyword">abstract</span> <span class="hljs-title function_">exit</span>(): <span class="hljs-built_in">void</span>
  
  <span class="hljs-title function_">getContext</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiContext</span>
  }
  
  <span class="hljs-title function_">applyAISuggestion</span>(<span class="hljs-params">suggestion: <span class="hljs-built_in">any</span></span>) {
    <span class="hljs-comment">// é»˜è®¤å®ç°ï¼Œå­ç±»å¯é‡å†™</span>
  }
}
</code></pre>
<h4 data-id="heading-3">1.2 AIèµ‹èƒ½çš„å°æ¸¸æˆæ ¸å¿ƒæ¨¡å—</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ai/AIModule.ts - AIèµ‹èƒ½æ¸¸æˆå†³ç­–ç³»ç»Ÿ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">AIModelConfig</span> {
  <span class="hljs-attr">modelPath</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">gameContext</span>: <span class="hljs-built_in">any</span>
  difficulty?: <span class="hljs-string">'easy'</span> | <span class="hljs-string">'medium'</span> | <span class="hljs-string">'hard'</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AIModule</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">model</span>: <span class="hljs-built_in">any</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">AIModelConfig</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">gameContext</span>: <span class="hljs-built_in">any</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">session</span>: <span class="hljs-title class_">AISession</span>
  
  <span class="hljs-comment">// ç©å®¶è¡Œä¸ºåˆ†æ</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">playerBehavior</span>: <span class="hljs-title class_">PlayerBehaviorAnalyzer</span>
  
  <span class="hljs-comment">// åŠ¨æ€éš¾åº¦è°ƒæ•´</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">difficultyManager</span>: <span class="hljs-title class_">DifficultyManager</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: AIModelConfig</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = config
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">gameContext</span> = config.<span class="hljs-property">gameContext</span>
    
    <span class="hljs-comment">// åˆå§‹åŒ–AIä¼šè¯</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">session</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AISession</span>({
      <span class="hljs-attr">gameType</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">detectGameType</span>(),
      <span class="hljs-attr">playerLevel</span>: <span class="hljs-string">'beginner'</span>
    })
    
    <span class="hljs-comment">// åˆå§‹åŒ–è¡Œä¸ºåˆ†æå™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">playerBehavior</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PlayerBehaviorAnalyzer</span>()
    
    <span class="hljs-comment">// åˆå§‹åŒ–éš¾åº¦ç®¡ç†å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">difficultyManager</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DifficultyManager</span>()
    
    <span class="hljs-comment">// åŠ è½½AIæ¨¡å‹</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadModel</span>()
  }
  
  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadModel</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// ä»äº‘ç«¯æˆ–æœ¬åœ°åŠ è½½AIæ¨¡å‹</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">model</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadAIModel</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">modelPath</span>)
      
      <span class="hljs-comment">// åˆå§‹åŒ–æ¨¡å‹å‚æ•°</span>
      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initializeModel</span>()
      
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'AIæ¨¡å‹åŠ è½½æˆåŠŸ'</span>)
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'AIæ¨¡å‹åŠ è½½å¤±è´¥:'</span>, error)
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">useFallbackLogic</span>()
    }
  }
  
  <span class="hljs-comment">// è·å–æ¸¸æˆç©æ³•å»ºè®®</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getGameplaySuggestion</span>(<span class="hljs-attr">gameContext</span>: <span class="hljs-built_in">any</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">GameSuggestion</span>&gt; {
    <span class="hljs-comment">// åˆ†æå½“å‰æ¸¸æˆçŠ¶æ€</span>
    <span class="hljs-keyword">const</span> analysis = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzeGameState</span>(gameContext)
    
    <span class="hljs-comment">// è·å–ç©å®¶è¡Œä¸ºæ¨¡å¼</span>
    <span class="hljs-keyword">const</span> playerPattern = <span class="hljs-variable language_">this</span>.<span class="hljs-property">playerBehavior</span>.<span class="hljs-title function_">getPattern</span>()
    
    <span class="hljs-comment">// ç”ŸæˆAIå»ºè®®</span>
    <span class="hljs-keyword">const</span> suggestion = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateSuggestion</span>({
      <span class="hljs-attr">gameState</span>: analysis,
      playerPattern,
      <span class="hljs-attr">difficulty</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">difficultyManager</span>.<span class="hljs-title function_">getCurrentDifficulty</span>()
    })
    
    <span class="hljs-comment">// è®°å½•å»ºè®®æ•ˆæœ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">trackSuggestionEffect</span>(suggestion)
    
    <span class="hljs-keyword">return</span> suggestion
  }
  
  <span class="hljs-comment">// ç”Ÿæˆä¸ªæ€§åŒ–æ¸¸æˆå†…å®¹</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">generateGameContent</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">ContentGenerationParams</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">GameContent</span>&gt; {
    <span class="hljs-keyword">const</span> prompt = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildAIPrompt</span>(params)
    
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> wx.<span class="hljs-property">cloud</span>.<span class="hljs-title function_">callFunction</span>({
      <span class="hljs-attr">name</span>: <span class="hljs-string">'aiContentGenerator'</span>,
      <span class="hljs-attr">data</span>: {
        prompt,
        <span class="hljs-attr">gameType</span>: params.<span class="hljs-property">gameType</span>,
        <span class="hljs-attr">style</span>: params.<span class="hljs-property">style</span>
      }
    })
    
    <span class="hljs-comment">// éªŒè¯å’Œä¼˜åŒ–ç”Ÿæˆå†…å®¹</span>
    <span class="hljs-keyword">const</span> validatedContent = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateAndOptimizeContent</span>(
      response.<span class="hljs-property">result</span>
    )
    
    <span class="hljs-keyword">return</span> validatedContent
  }
  
  <span class="hljs-comment">// å®æ—¶ç©å®¶æŒ‡å¯¼ç³»ç»Ÿ</span>
  <span class="hljs-title function_">createPlayerCoach</span>(): <span class="hljs-title class_">PlayerCoach</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">provideHint</span>: <span class="hljs-function">(<span class="hljs-params">context</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">provideRealTimeHint</span>(context),
      <span class="hljs-attr">analyzeMistake</span>: <span class="hljs-function">(<span class="hljs-params">action</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzePlayerMistake</span>(action),
      <span class="hljs-attr">suggestImprovement</span>: <span class="hljs-function">(<span class="hljs-params">history</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">suggestPlayerImprovement</span>(history),
      <span class="hljs-attr">adjustDifficulty</span>: <span class="hljs-function">(<span class="hljs-params">performance</span>) =&gt;</span> 
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">difficultyManager</span>.<span class="hljs-title function_">adjust</span>(performance)
    }
  }
  
  <span class="hljs-comment">// æ•°æ®é©±åŠ¨çš„æ¸¸æˆå¹³è¡¡è°ƒæ•´</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">balanceGameMechanics</span>(<span class="hljs-attr">data</span>: <span class="hljs-title class_">GameBalanceData</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">BalanceAdjustment</span>&gt; {
    <span class="hljs-keyword">const</span> analysis = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzeBalanceData</span>(data)
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">parameterAdjustments</span>: analysis.<span class="hljs-property">suggestedAdjustments</span>,
      <span class="hljs-attr">rationale</span>: analysis.<span class="hljs-property">explanation</span>,
      <span class="hljs-attr">confidence</span>: analysis.<span class="hljs-property">confidence</span>
    }
  }
}

<span class="hljs-comment">// AIç©å®¶æŒ‡å¯¼ç³»ç»Ÿ</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">PlayerCoach</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">aiModule</span>: <span class="hljs-title class_">AIModule</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">playerProfile</span>: <span class="hljs-title class_">PlayerProfile</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">aiModule: AIModule, playerProfile: PlayerProfile</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiModule</span> = aiModule
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">playerProfile</span> = playerProfile
  }
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">provideRealTimeHint</span>(<span class="hljs-attr">gameContext</span>: <span class="hljs-built_in">any</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">GameHint</span>&gt; {
    <span class="hljs-comment">// åˆ†æç©å®¶å½“å‰å›°å¢ƒ</span>
    <span class="hljs-keyword">const</span> analysis = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzePlayerStruggle</span>(gameContext)
    
    <span class="hljs-comment">// æ ¹æ®ç©å®¶æ°´å¹³å’Œå­¦ä¹ é£æ ¼æä¾›æç¤º</span>
    <span class="hljs-keyword">const</span> hintLevel = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">determineHintLevel</span>(
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">playerProfile</span>.<span class="hljs-property">skillLevel</span>,
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">playerProfile</span>.<span class="hljs-property">learningStyle</span>
    )
    
    <span class="hljs-comment">// ç”Ÿæˆå…·ä½“æç¤º</span>
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateHint</span>(analysis, hintLevel)
  }
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">analyzePlayerMistake</span>(<span class="hljs-attr">action</span>: <span class="hljs-title class_">PlayerAction</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">MistakeAnalysis</span>&gt; {
    <span class="hljs-comment">// ä½¿ç”¨AIåˆ†æé”™è¯¯æ¨¡å¼</span>
    <span class="hljs-keyword">const</span> mistakePattern = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiModule</span>.<span class="hljs-title function_">analyzeMistakePattern</span>(action)
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">mistakeType</span>: mistakePattern.<span class="hljs-property">type</span>,
      <span class="hljs-attr">rootCause</span>: mistakePattern.<span class="hljs-property">cause</span>,
      <span class="hljs-attr">suggestedCorrection</span>: mistakePattern.<span class="hljs-property">correction</span>,
      <span class="hljs-attr">learningOpportunity</span>: mistakePattern.<span class="hljs-property">learningPoint</span>
    }
  }
  
  <span class="hljs-comment">// ç”Ÿæˆä¸ªæ€§åŒ–å­¦ä¹ è·¯å¾„</span>
  <span class="hljs-title function_">generateLearningPath</span>(<span class="hljs-attr">playerHistory</span>: <span class="hljs-title class_">PlayerHistory</span>): <span class="hljs-title class_">LearningPath</span> {
    <span class="hljs-keyword">const</span> weaknesses = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">identifyWeaknesses</span>(playerHistory)
    <span class="hljs-keyword">const</span> goals = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setLearningGoals</span>(weaknesses)
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">stages</span>: goals.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">goal</span> =&gt;</span> ({
        goal,
        <span class="hljs-attr">exercises</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateExercisesForGoal</span>(goal),
        <span class="hljs-attr">metrics</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">defineSuccessMetrics</span>(goal),
        <span class="hljs-attr">aiAssistance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">determineAIAssistanceLevel</span>(goal)
      })),
      <span class="hljs-attr">timeline</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">estimateTimeline</span>(weaknesses),
      <span class="hljs-attr">adaptive</span>: <span class="hljs-literal">true</span>
    }
  }
}
</code></pre>
<h3 data-id="heading-4">ç¬¬äºŒç« ï¼šå°æ¸¸æˆæ¶æ„è®¾è®¡ä¸æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-5">2.1 é«˜æ€§èƒ½æ¸²æŸ“å¼•æ“</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// render/RenderEngine.ts - ç°ä»£å°æ¸¸æˆæ¸²æŸ“å¼•æ“</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">RenderConfig</span> {
  <span class="hljs-attr">maxParticles</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">maxSprites</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">useWebGL</span>: <span class="hljs-built_in">boolean</span>
  textureAtlas?: <span class="hljs-title class_">TextureAtlas</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">RenderEngine</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">RenderConfig</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">renderer</span>: <span class="hljs-title class_">Renderer</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">sceneGraph</span>: <span class="hljs-title class_">SceneGraph</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">textureManager</span>: <span class="hljs-title class_">TextureManager</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">particleSystem</span>: <span class="hljs-title class_">ParticleSystem</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">renderQueue</span>: <span class="hljs-title class_">RenderQueue</span>
  
  <span class="hljs-comment">// æ€§èƒ½ç›‘æ§</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">performanceMonitor</span>: <span class="hljs-title class_">PerformanceMonitor</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">frameAnalyzer</span>: <span class="hljs-title class_">FrameAnalyzer</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: RenderConfig</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = config
    
    <span class="hljs-comment">// é€‰æ‹©æ¸²æŸ“åç«¯</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderer</span> = config.<span class="hljs-property">useWebGL</span> 
      ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebGLRenderer</span>()
      : <span class="hljs-keyword">new</span> <span class="hljs-title class_">Canvas2DRenderer</span>()
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sceneGraph</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SceneGraph</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">textureManager</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextureManager</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">renderer</span>)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">particleSystem</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParticleSystem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">maxParticles</span>)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderQueue</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RenderQueue</span>()
    
    <span class="hljs-comment">// åˆå§‹åŒ–æ€§èƒ½ç›‘æ§</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">performanceMonitor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PerformanceMonitor</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">frameAnalyzer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FrameAnalyzer</span>()
    
    <span class="hljs-comment">// é¢„åŠ è½½èµ„æº</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">preloadResources</span>()
  }
  
  <span class="hljs-comment">// åœºæ™¯å›¾èŠ‚ç‚¹</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">SceneNode</span> {
    <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>
    <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>
    <span class="hljs-attr">scaleX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>
    <span class="hljs-attr">scaleY</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>
    <span class="hljs-attr">rotation</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>
    <span class="hljs-attr">alpha</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>
    <span class="hljs-attr">visible</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>
    <span class="hljs-attr">children</span>: <span class="hljs-title class_">SceneNode</span>[] = []
    
    <span class="hljs-comment">// æ¸²æŸ“ç»„ä»¶</span>
    renderComponent?: <span class="hljs-title class_">RenderComponent</span>
    
    <span class="hljs-title function_">addChild</span>(<span class="hljs-params">node: SceneNode</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">push</span>(node)
    }
    
    <span class="hljs-title function_">update</span>(<span class="hljs-params">deltaTime: <span class="hljs-built_in">number</span></span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-title function_">update</span>(deltaTime))
    }
    
    <span class="hljs-title function_">render</span>(<span class="hljs-params">ctx: <span class="hljs-built_in">any</span></span>) {
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">visible</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">alpha</span> &lt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>
      
      ctx.<span class="hljs-title function_">save</span>()
      
      <span class="hljs-comment">// åº”ç”¨å˜æ¢</span>
      ctx.<span class="hljs-title function_">translate</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span>)
      ctx.<span class="hljs-title function_">rotate</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span>)
      ctx.<span class="hljs-title function_">scale</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">scaleX</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">scaleY</span>)
      ctx.<span class="hljs-property">globalAlpha</span> *= <span class="hljs-variable language_">this</span>.<span class="hljs-property">alpha</span>
      
      <span class="hljs-comment">// æ¸²æŸ“è‡ªèº«</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">renderComponent</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderComponent</span>.<span class="hljs-title function_">render</span>(ctx)
      }
      
      <span class="hljs-comment">// æ¸²æŸ“å­èŠ‚ç‚¹</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">child</span> =&gt;</span> child.<span class="hljs-title function_">render</span>(ctx))
      
      ctx.<span class="hljs-title function_">restore</span>()
    }
  }
  
  <span class="hljs-comment">// ç²¾çµæ‰¹å¤„ç†æ¸²æŸ“</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpriteBatch</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">sprites</span>: <span class="hljs-title class_">Sprite</span>[] = []
    <span class="hljs-keyword">private</span> <span class="hljs-attr">texture</span>: <span class="hljs-title class_">Texture</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">batchSize</span>: <span class="hljs-built_in">number</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">vertexBuffer</span>: <span class="hljs-built_in">any</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">indexBuffer</span>: <span class="hljs-built_in">any</span>
    
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">texture: Texture, maxSprites: <span class="hljs-built_in">number</span> = <span class="hljs-number">1000</span></span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">texture</span> = texture
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchSize</span> = maxSprites
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initializeBuffers</span>()
    }
    
    <span class="hljs-title function_">addSprite</span>(<span class="hljs-params">sprite: Sprite</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">sprites</span>.<span class="hljs-title function_">push</span>(sprite)
      
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">sprites</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">batchSize</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flush</span>()
      }
    }
    
    <span class="hljs-title function_">flush</span>(<span class="hljs-params"/>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">sprites</span>.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>
      
      <span class="hljs-comment">// æ‰¹é‡ä¸Šä¼ é¡¶ç‚¹æ•°æ®</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">uploadVertexData</span>()
      
      <span class="hljs-comment">// æ‰§è¡Œç»˜åˆ¶</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">renderBatch</span>()
      
      <span class="hljs-comment">// æ¸…ç©ºæ‰¹å¤„ç†</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">sprites</span> = []
    }
    
    <span class="hljs-keyword">private</span> <span class="hljs-title function_">renderBatch</span>(<span class="hljs-params"/>) {
      <span class="hljs-comment">// WebGLæ‰¹å¤„ç†æ¸²æŸ“é€»è¾‘</span>
      <span class="hljs-keyword">const</span> gl = <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderer</span>.<span class="hljs-property">gl</span>
      
      gl.<span class="hljs-title function_">bindTexture</span>(gl.<span class="hljs-property">TEXTURE_2D</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">texture</span>.<span class="hljs-property">handle</span>)
      gl.<span class="hljs-title function_">bindBuffer</span>(gl.<span class="hljs-property">ARRAY_BUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">vertexBuffer</span>)
      gl.<span class="hljs-title function_">bindBuffer</span>(gl.<span class="hljs-property">ELEMENT_ARRAY_BUFFER</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">indexBuffer</span>)
      
      <span class="hljs-comment">// è®¾ç½®é¡¶ç‚¹å±æ€§</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupVertexAttributes</span>()
      
      <span class="hljs-comment">// ç»˜åˆ¶</span>
      gl.<span class="hljs-title function_">drawElements</span>(
        gl.<span class="hljs-property">TRIANGLES</span>,
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">sprites</span>.<span class="hljs-property">length</span> * <span class="hljs-number">6</span>,
        gl.<span class="hljs-property">UNSIGNED_SHORT</span>,
        <span class="hljs-number">0</span>
      )
    }
  }
  
  <span class="hljs-comment">// åŠ¨æ€åˆ†è¾¨ç‡è°ƒæ•´</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicResolution</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">targetFPS</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">60</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">currentScale</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1.0</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">minScale</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0.5</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">maxScale</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1.0</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">adjustmentStep</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0.1</span>
    
    <span class="hljs-title function_">adjustBasedOnPerformance</span>(<span class="hljs-attr">frameTimes</span>: <span class="hljs-built_in">number</span>[]): <span class="hljs-built_in">number</span> {
      <span class="hljs-keyword">const</span> avgFrameTime = frameTimes.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b) / frameTimes.<span class="hljs-property">length</span>
      <span class="hljs-keyword">const</span> currentFPS = <span class="hljs-number">1000</span> / avgFrameTime
      
      <span class="hljs-keyword">if</span> (currentFPS &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">targetFPS</span> - <span class="hljs-number">5</span>) {
        <span class="hljs-comment">// æ€§èƒ½ä¸è¶³ï¼Œé™ä½åˆ†è¾¨ç‡</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentScale</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">minScale</span>,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentScale</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">adjustmentStep</span>
        )
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (currentFPS &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">targetFPS</span> + <span class="hljs-number">5</span>) {
        <span class="hljs-comment">// æ€§èƒ½å……è¶³ï¼Œæé«˜åˆ†è¾¨ç‡</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentScale</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxScale</span>,
          <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentScale</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">adjustmentStep</span>
        )
      }
      
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentScale</span>
    }
  }
}
</code></pre>
<h4 data-id="heading-6">2.2 ç½‘ç»œä¸æ•°æ®åŒæ­¥ç³»ç»Ÿ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// network/GameNetwork.ts - å°æ¸¸æˆç½‘ç»œé€šä¿¡ç³»ç»Ÿ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">NetworkConfig</span> {
  <span class="hljs-attr">serverUrl</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">reconnectAttempts</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">heartbeatInterval</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">useWebSocket</span>: <span class="hljs-built_in">boolean</span>
  compression?: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">GameNetwork</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">NetworkConfig</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">connection</span>: <span class="hljs-title class_">Connection</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">messageQueue</span>: <span class="hljs-title class_">MessageQueue</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">syncManager</span>: <span class="hljs-title class_">SyncManager</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">authManager</span>: <span class="hljs-title class_">AuthManager</span>
  
  <span class="hljs-comment">// ç½‘ç»œçŠ¶æ€ç›‘æ§</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">networkMonitor</span>: <span class="hljs-title class_">NetworkMonitor</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">lagCompensation</span>: <span class="hljs-title class_">LagCompensation</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: NetworkConfig</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = config
    
    <span class="hljs-comment">// åˆå§‹åŒ–è¿æ¥</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">connection</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">useWebSocket</span>
      ? <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocketConnection</span>(config.<span class="hljs-property">serverUrl</span>)
      : <span class="hljs-keyword">new</span> <span class="hljs-title class_">HTTPConnection</span>(config.<span class="hljs-property">serverUrl</span>)
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">messageQueue</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessageQueue</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">syncManager</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SyncManager</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">authManager</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AuthManager</span>()
    
    <span class="hljs-comment">// ç½‘ç»œä¼˜åŒ–æ¨¡å—</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">networkMonitor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NetworkMonitor</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">lagCompensation</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LagCompensation</span>()
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupEventListeners</span>()
  }
  
  <span class="hljs-comment">// å®æ—¶æ•°æ®åŒæ­¥</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">SyncManager</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">gameState</span>: <span class="hljs-built_in">any</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">syncRate</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">30</span> <span class="hljs-comment">// 30Hz</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">lastSyncTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">pendingUpdates</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">any</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()
    
    <span class="hljs-comment">// çŠ¶æ€æ’å€¼</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">interpolationBuffer</span>: <span class="hljs-title class_">InterpolationBuffer</span>
    
    <span class="hljs-comment">// é¢„æµ‹ä¸è°ƒå’Œ</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">predictionEngine</span>: <span class="hljs-title class_">PredictionEngine</span>
    
    <span class="hljs-title function_">syncGameState</span>(<span class="hljs-params">state: GameState</span>) {
      <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
      
      <span class="hljs-comment">// æ§åˆ¶åŒæ­¥é¢‘ç‡</span>
      <span class="hljs-keyword">if</span> (now - <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastSyncTime</span> &lt; <span class="hljs-number">1000</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">syncRate</span>) {
        <span class="hljs-keyword">return</span>
      }
      
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastSyncTime</span> = now
      
      <span class="hljs-comment">// å·®å¼‚æ£€æµ‹å’Œå‹ç¼©</span>
      <span class="hljs-keyword">const</span> delta = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateDelta</span>(state, <span class="hljs-variable language_">this</span>.<span class="hljs-property">gameState</span>)
      
      <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(delta).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sendSyncMessage</span>({
          <span class="hljs-attr">type</span>: <span class="hljs-string">'state_update'</span>,
          <span class="hljs-attr">timestamp</span>: now,
          delta,
          <span class="hljs-attr">checksum</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateChecksum</span>(state)
        })
        
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">gameState</span> = state
      }
    }
    
    <span class="hljs-comment">// å¤„ç†æœåŠ¡å™¨æƒå¨æ›´æ–°</span>
    <span class="hljs-title function_">handleServerUpdate</span>(<span class="hljs-params">update: ServerUpdate</span>) {
      <span class="hljs-comment">// éªŒè¯æ›´æ–°</span>
      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">validateUpdate</span>(update)) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestResync</span>()
        <span class="hljs-keyword">return</span>
      }
      
      <span class="hljs-comment">// åº”ç”¨æœåŠ¡å™¨çŠ¶æ€</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyServerState</span>(update.<span class="hljs-property">state</span>)
      
      <span class="hljs-comment">// è°ƒå’Œæœ¬åœ°é¢„æµ‹</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">predictionEngine</span>.<span class="hljs-title function_">reconcile</span>(update)
      
      <span class="hljs-comment">// æ’å€¼åˆ°å¹³æ»‘æ˜¾ç¤º</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">interpolationBuffer</span>.<span class="hljs-title function_">addState</span>(update)
    }
  }
  
  <span class="hljs-comment">// æ¶ˆæ¯å‹ç¼©ä¸ä¼˜åŒ–</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageOptimizer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">compression</span>: <span class="hljs-title class_">Compression</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">deltaEncoding</span>: <span class="hljs-title class_">DeltaEncoding</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">messagePooling</span>: <span class="hljs-title class_">MessagePooling</span>
    
    <span class="hljs-title function_">optimizeMessage</span>(<span class="hljs-attr">message</span>: <span class="hljs-title class_">GameMessage</span>): <span class="hljs-title class_">OptimizedMessage</span> {
      <span class="hljs-comment">// 1. ç§»é™¤å†—ä½™æ•°æ®</span>
      <span class="hljs-keyword">const</span> cleaned = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">removeRedundantData</span>(message)
      
      <span class="hljs-comment">// 2. åº”ç”¨å¢é‡ç¼–ç </span>
      <span class="hljs-keyword">const</span> deltaEncoded = <span class="hljs-variable language_">this</span>.<span class="hljs-property">deltaEncoding</span>.<span class="hljs-title function_">encode</span>(cleaned)
      
      <span class="hljs-comment">// 3. å‹ç¼©æ•°æ®</span>
      <span class="hljs-keyword">const</span> compressed = <span class="hljs-variable language_">this</span>.<span class="hljs-property">compression</span>.<span class="hljs-title function_">compress</span>(deltaEncoded)
      
      <span class="hljs-comment">// 4. æ·»åŠ å…ƒæ•°æ®</span>
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">payload</span>: compressed,
        <span class="hljs-attr">metadata</span>: {
          <span class="hljs-attr">originalSize</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(message).<span class="hljs-property">length</span>,
          <span class="hljs-attr">compressedSize</span>: compressed.<span class="hljs-property">length</span>,
          <span class="hljs-attr">compressionRatio</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateRatio</span>(message, compressed)
        }
      }
    }
  }
  
  <span class="hljs-comment">// AIè¾…åŠ©ç½‘ç»œä¼˜åŒ–</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">AINetworkOptimizer</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">aiModel</span>: <span class="hljs-built_in">any</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">patternRecognition</span>: <span class="hljs-title class_">PatternRecognition</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">predictNetworkConditions</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">NetworkPrediction</span>&gt; {
      <span class="hljs-keyword">const</span> historicalData = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">collectNetworkData</span>()
      <span class="hljs-keyword">const</span> patterns = <span class="hljs-variable language_">this</span>.<span class="hljs-property">patternRecognition</span>.<span class="hljs-title function_">analyze</span>(historicalData)
      
      <span class="hljs-keyword">const</span> prediction = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiModel</span>.<span class="hljs-title function_">predict</span>({
        <span class="hljs-attr">currentConditions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCurrentConditions</span>(),
        <span class="hljs-attr">historicalPatterns</span>: patterns,
        <span class="hljs-attr">timeOfDay</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">getHours</span>(),
        <span class="hljs-attr">userLocation</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUserLocation</span>()
      })
      
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">expectedLatency</span>: prediction.<span class="hljs-property">latency</span>,
        <span class="hljs-attr">expectedPacketLoss</span>: prediction.<span class="hljs-property">packetLoss</span>,
        <span class="hljs-attr">suggestedActions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateOptimizationSuggestions</span>(prediction)
      }
    }
    
    <span class="hljs-title function_">adaptiveSyncStrategy</span>(<span class="hljs-attr">playerCount</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">gameMode</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">SyncStrategy</span> {
      <span class="hljs-comment">// AIåŠ¨æ€è°ƒæ•´åŒæ­¥ç­–ç•¥</span>
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiModel</span>.<span class="hljs-title function_">determineStrategy</span>({
        playerCount,
        gameMode,
        <span class="hljs-attr">networkConditions</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCurrentConditions</span>(),
        <span class="hljs-attr">deviceCapabilities</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDeviceInfo</span>()
      })
    }
  }
}
</code></pre>
<h3 data-id="heading-7">ç¬¬ä¸‰ç« ï¼šAIç”Ÿæˆæ¸¸æˆå†…å®¹ä¸ä¸ªæ€§åŒ–</h3>
<h4 data-id="heading-8">3.1 åŠ¨æ€å†…å®¹ç”Ÿæˆç³»ç»Ÿ</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// content/AIContentGenerator.ts - AIé©±åŠ¨çš„å†…å®¹ç”Ÿæˆ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">ContentGenerationRequest</span> {
  <span class="hljs-attr">gameType</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">theme</span>: <span class="hljs-built_in">string</span>
  <span class="hljs-attr">difficulty</span>: <span class="hljs-built_in">number</span>
  <span class="hljs-attr">playerPreferences</span>: <span class="hljs-title class_">PlayerPreferences</span>
  constraints?: <span class="hljs-title class_">ContentConstraints</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AIContentGenerator</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">aiClient</span>: <span class="hljs-title class_">AIClient</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">contentValidator</span>: <span class="hljs-title class_">ContentValidator</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">styleTransfer</span>: <span class="hljs-title class_">StyleTransfer</span>
  
  <span class="hljs-comment">// å†…å®¹ç¼“å­˜</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">contentCache</span>: <span class="hljs-title class_">LRUCache</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">GameContent</span>&gt;
  <span class="hljs-keyword">private</span> <span class="hljs-attr">templateLibrary</span>: <span class="hljs-title class_">TemplateLibrary</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">apiKey: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiClient</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIClient</span>(apiKey)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentValidator</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ContentValidator</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">styleTransfer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StyleTransfer</span>()
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentCache</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LRUCache</span>(<span class="hljs-number">100</span>)
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">templateLibrary</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplateLibrary</span>()
  }
  
  <span class="hljs-comment">// ç”Ÿæˆå…³å¡å†…å®¹</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">generateLevel</span>(<span class="hljs-attr">request</span>: <span class="hljs-title class_">LevelGenerationRequest</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">GameLevel</span>&gt; {
    <span class="hljs-keyword">const</span> cacheKey = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateCacheKey</span>(request)
    
    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
    <span class="hljs-keyword">const</span> cached = <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentCache</span>.<span class="hljs-title function_">get</span>(cacheKey)
    <span class="hljs-keyword">if</span> (cached) {
      <span class="hljs-keyword">return</span> cached <span class="hljs-keyword">as</span> <span class="hljs-title class_">GameLevel</span>
    }
    
    <span class="hljs-comment">// æ„å»ºç”Ÿæˆæç¤º</span>
    <span class="hljs-keyword">const</span> prompt = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildLevelPrompt</span>(request)
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// è°ƒç”¨AIç”Ÿæˆ</span>
      <span class="hljs-keyword">const</span> aiResponse = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiClient</span>.<span class="hljs-title function_">generateContent</span>({
        prompt,
        <span class="hljs-attr">maxTokens</span>: <span class="hljs-number">2000</span>,
        <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.7</span>,
        <span class="hljs-attr">stopSequences</span>: [<span class="hljs-string">'END_LEVEL'</span>]
      })
      
      <span class="hljs-comment">// è§£æå’ŒéªŒè¯å†…å®¹</span>
      <span class="hljs-keyword">const</span> parsedLevel = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">parseLevelDescription</span>(aiResponse.<span class="hljs-property">content</span>)
      
      <span class="hljs-comment">// éªŒè¯å…³å¡å¯è¡Œæ€§</span>
      <span class="hljs-keyword">const</span> validation = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentValidator</span>.<span class="hljs-title function_">validateLevel</span>(parsedLevel)
      
      <span class="hljs-keyword">if</span> (!validation.<span class="hljs-property">valid</span>) {
        <span class="hljs-comment">// ä¿®æ­£æ— æ•ˆå†…å®¹</span>
        <span class="hljs-keyword">const</span> corrected = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">correctLevelIssues</span>(parsedLevel, validation.<span class="hljs-property">issues</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheAndReturn</span>(cacheKey, corrected)
      }
      
      <span class="hljs-comment">// åº”ç”¨é£æ ¼è½¬ç§»</span>
      <span class="hljs-keyword">const</span> styledLevel = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyStyle</span>(parsedLevel, request.<span class="hljs-property">theme</span>)
      
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cacheAndReturn</span>(cacheKey, styledLevel)
      
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'å…³å¡ç”Ÿæˆå¤±è´¥:'</span>, error)
      
      <span class="hljs-comment">// å›é€€åˆ°æ¨¡æ¿ç”Ÿæˆ</span>
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateFromTemplate</span>(request)
    }
  }
  
  <span class="hljs-comment">// ç”Ÿæˆæ¸¸æˆå‰§æƒ…</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">generateStoryline</span>(<span class="hljs-attr">params</span>: <span class="hljs-title class_">StoryParams</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">GameStory</span>&gt; {
    <span class="hljs-keyword">const</span> characterTraits = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateCharacterTraits</span>(params)
    <span class="hljs-keyword">const</span> plotPoints = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generatePlotPoints</span>(params, characterTraits)
    <span class="hljs-keyword">const</span> dialogues = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateDialogues</span>(characterTraits, plotPoints)
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">characters</span>: characterTraits,
      <span class="hljs-attr">plot</span>: plotPoints,
      dialogues,
      <span class="hljs-attr">branchingPaths</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateBranches</span>(plotPoints),
      <span class="hljs-attr">emotionalArcs</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateEmotionalArcs</span>(plotPoints)
    }
  }
  
  <span class="hljs-comment">// ä¸ªæ€§åŒ–æ¸¸æˆä½“éªŒ</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">personalizeGameExperience</span>(
    <span class="hljs-attr">playerProfile</span>: <span class="hljs-title class_">PlayerProfile</span>,
    <span class="hljs-attr">gameContext</span>: <span class="hljs-title class_">GameContext</span>
  ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Personalization</span>&gt; {
    <span class="hljs-comment">// åˆ†æç©å®¶è¡Œä¸º</span>
    <span class="hljs-keyword">const</span> behaviorAnalysis = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzePlayerBehavior</span>(playerProfile)
    
    <span class="hljs-comment">// ç”Ÿæˆä¸ªæ€§åŒ–å†…å®¹</span>
    <span class="hljs-keyword">const</span> personalization = {
      <span class="hljs-attr">difficultyAdjustment</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateDifficultyAdjustment</span>(behaviorAnalysis),
      <span class="hljs-attr">contentPreferences</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">inferContentPreferences</span>(behaviorAnalysis),
      <span class="hljs-attr">learningPath</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateLearningPath</span>(behaviorAnalysis),
      <span class="hljs-attr">rewardSystem</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">personalizeRewards</span>(behaviorAnalysis),
      <span class="hljs-attr">narrativeAdaptation</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">adaptNarrative</span>(behaviorAnalysis, gameContext)
    }
    
    <span class="hljs-comment">// AIæŒç»­ä¼˜åŒ–</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupContinuousOptimization</span>(playerProfile.<span class="hljs-property">id</span>, personalization)
    
    <span class="hljs-keyword">return</span> personalization
  }
  
  <span class="hljs-comment">// å®æ—¶å†…å®¹é€‚é…</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicContentAdapter</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">playerFeedback</span>: <span class="hljs-title class_">PlayerFeedbackCollector</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">performanceMonitor</span>: <span class="hljs-title class_">PerformanceMonitor</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">adaptationModel</span>: <span class="hljs-title class_">AdaptationModel</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">adaptContentInRealTime</span>(
      <span class="hljs-attr">content</span>: <span class="hljs-title class_">GameContent</span>,
      <span class="hljs-attr">playerActions</span>: <span class="hljs-title class_">PlayerAction</span>[]
    ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">AdaptedContent</span>&gt; {
      <span class="hljs-comment">// æ”¶é›†å®æ—¶åé¦ˆ</span>
      <span class="hljs-keyword">const</span> feedback = <span class="hljs-variable language_">this</span>.<span class="hljs-property">playerFeedback</span>.<span class="hljs-title function_">collect</span>(playerActions)
      
      <span class="hljs-comment">// åˆ†æå†…å®¹æ•ˆæœ</span>
      <span class="hljs-keyword">const</span> effectiveness = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzeContentEffectiveness</span>(content, feedback)
      
      <span class="hljs-comment">// AIå†³ç­–è°ƒæ•´</span>
      <span class="hljs-keyword">const</span> adaptation = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">adaptationModel</span>.<span class="hljs-title function_">decideAdaptation</span>({
        <span class="hljs-attr">currentContent</span>: content,
        effectiveness,
        <span class="hljs-attr">playerState</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPlayerState</span>(),
        <span class="hljs-attr">gamePhase</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getGamePhase</span>()
      })
      
      <span class="hljs-comment">// åº”ç”¨è°ƒæ•´</span>
      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">applyAdaptation</span>(content, adaptation)
    }
  }
}
</code></pre>
<h4 data-id="heading-9">3.2 æ•°æ®åˆ†æä¸AIä¼˜åŒ–</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// analytics/GameAnalytics.ts - æ•°æ®é©±åŠ¨çš„æ¸¸æˆä¼˜åŒ–</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">AnalyticsConfig</span> {
  <span class="hljs-attr">trackingEnabled</span>: <span class="hljs-built_in">boolean</span>
  <span class="hljs-attr">realtimeProcessing</span>: <span class="hljs-built_in">boolean</span>
  <span class="hljs-attr">retentionAnalysis</span>: <span class="hljs-built_in">boolean</span>
  <span class="hljs-attr">cohortTracking</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">GameAnalytics</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">AnalyticsConfig</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">dataCollector</span>: <span class="hljs-title class_">DataCollector</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">eventProcessor</span>: <span class="hljs-title class_">EventProcessor</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">aiAnalyzer</span>: <span class="hljs-title class_">AIAnalyzer</span>
  
  <span class="hljs-comment">// æ•°æ®å­˜å‚¨</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">timeSeriesDB</span>: <span class="hljs-title class_">TimeSeriesDatabase</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">userProfiles</span>: <span class="hljs-title class_">UserProfileStore</span>
  
  <span class="hljs-comment">// å®æ—¶ä»ªè¡¨æ¿</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">dashboard</span>: <span class="hljs-title class_">AnalyticsDashboard</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: AnalyticsConfig</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = config
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataCollector</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataCollector</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventProcessor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventProcessor</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiAnalyzer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIAnalyzer</span>()
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">timeSeriesDB</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TimeSeriesDatabase</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">userProfiles</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserProfileStore</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dashboard</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnalyticsDashboard</span>()
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupTracking</span>()
  }
  
  <span class="hljs-comment">// ç©å®¶è¡Œä¸ºè¿½è¸ª</span>
  <span class="hljs-title function_">trackPlayerEvent</span>(<span class="hljs-params">event: PlayerEvent</span>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">trackingEnabled</span>) <span class="hljs-keyword">return</span>
    
    <span class="hljs-comment">// ä¸°å¯Œäº‹ä»¶æ•°æ®</span>
    <span class="hljs-keyword">const</span> enrichedEvent = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">enrichEventData</span>(event)
    
    <span class="hljs-comment">// å®æ—¶å¤„ç†</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span>.<span class="hljs-property">realtimeProcessing</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">processRealtimeEvent</span>(enrichedEvent)
    }
    
    <span class="hljs-comment">// å­˜å‚¨å†å²æ•°æ®</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">storeEvent</span>(enrichedEvent)
    
    <span class="hljs-comment">// æ›´æ–°ç”¨æˆ·ç”»åƒ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">updateUserProfile</span>(enrichedEvent)
    
    <span class="hljs-comment">// AIåˆ†æ</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiAnalyzer</span>.<span class="hljs-title function_">analyzeEventPattern</span>(enrichedEvent)
  }
  
  <span class="hljs-comment">// ç•™å­˜ç‡åˆ†æ</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">analyzeRetention</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">RetentionAnalysis</span>&gt; {
    <span class="hljs-keyword">const</span> cohorts = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">identifyCohorts</span>()
    <span class="hljs-keyword">const</span> retentionRates = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateRetentionRates</span>(cohorts)
    
    <span class="hljs-comment">// AIé¢„æµ‹æµå¤±é£é™©</span>
    <span class="hljs-keyword">const</span> churnRisk = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiAnalyzer</span>.<span class="hljs-title function_">predictChurnRisk</span>(
      cohorts,
      retentionRates
    )
    
    <span class="hljs-comment">// ç”Ÿæˆæ”¹è¿›å»ºè®®</span>
    <span class="hljs-keyword">const</span> recommendations = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateRetentionRecommendations</span>(
      cohorts,
      retentionRates,
      churnRisk
    )
    
    <span class="hljs-keyword">return</span> {
      cohorts,
      retentionRates,
      churnRisk,
      recommendations,
      <span class="hljs-attr">insights</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">extractInsights</span>(retentionRates)
    }
  }
  
  <span class="hljs-comment">// A/Bæµ‹è¯•æ¡†æ¶</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">ABTestFramework</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">experiments</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Experiment</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>()
    <span class="hljs-keyword">private</span> <span class="hljs-attr">variantAllocator</span>: <span class="hljs-title class_">VariantAllocator</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">significanceCalculator</span>: <span class="hljs-title class_">SignificanceCalculator</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">runExperiment</span>(<span class="hljs-attr">experiment</span>: <span class="hljs-title class_">ExperimentConfig</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ExperimentResult</span>&gt; {
      <span class="hljs-keyword">const</span> expId = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateExperimentId</span>(experiment)
      
      <span class="hljs-comment">// åˆ†é…å˜ä½“</span>
      <span class="hljs-keyword">const</span> variantAssignment = <span class="hljs-variable language_">this</span>.<span class="hljs-property">variantAllocator</span>.<span class="hljs-title function_">assign</span>(
        experiment.<span class="hljs-property">variants</span>,
        experiment.<span class="hljs-property">targeting</span>
      )
      
      <span class="hljs-comment">// è¿½è¸ªæŒ‡æ ‡</span>
      <span class="hljs-keyword">const</span> metrics = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">trackExperimentMetrics</span>(
        expId,
        variantAssignment,
        experiment.<span class="hljs-property">metrics</span>
      )
      
      <span class="hljs-comment">// ç»Ÿè®¡æ˜¾è‘—æ€§</span>
      <span class="hljs-keyword">const</span> significance = <span class="hljs-variable language_">this</span>.<span class="hljs-property">significanceCalculator</span>.<span class="hljs-title function_">calculate</span>(
        metrics,
        experiment.<span class="hljs-property">confidenceLevel</span>
      )
      
      <span class="hljs-comment">// AIä¼˜åŒ–å»ºè®®</span>
      <span class="hljs-keyword">const</span> optimization = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiAnalyzer</span>.<span class="hljs-title function_">optimizeExperiment</span>(
        experiment,
        metrics,
        significance
      )
      
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">experimentId</span>: expId,
        metrics,
        significance,
        <span class="hljs-attr">winningVariant</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">determineWinner</span>(metrics, significance),
        <span class="hljs-attr">recommendations</span>: optimization.<span class="hljs-property">suggestions</span>,
        <span class="hljs-attr">confidence</span>: optimization.<span class="hljs-property">confidence</span>
      }
    }
  }
  
  <span class="hljs-comment">// é¢„æµ‹åˆ†æ</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">predictPlayerLTV</span>(<span class="hljs-attr">playerId</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">LTVPrediction</span>&gt; {
    <span class="hljs-keyword">const</span> playerHistory = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPlayerHistory</span>(playerId)
    <span class="hljs-keyword">const</span> similarPlayers = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">findSimilarPlayers</span>(playerId)
    
    <span class="hljs-keyword">const</span> prediction = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiAnalyzer</span>.<span class="hljs-title function_">predictLTV</span>({
      <span class="hljs-attr">playerProfile</span>: playerHistory.<span class="hljs-property">profile</span>,
      <span class="hljs-attr">behaviorPatterns</span>: playerHistory.<span class="hljs-property">patterns</span>,
      <span class="hljs-attr">similarPlayerLTVs</span>: similarPlayers.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.<span class="hljs-property">ltv</span>),
      <span class="hljs-attr">externalFactors</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getExternalFactors</span>()
    })
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">predictedLTV</span>: prediction.<span class="hljs-property">value</span>,
      <span class="hljs-attr">confidence</span>: prediction.<span class="hljs-property">confidence</span>,
      <span class="hljs-attr">keyDrivers</span>: prediction.<span class="hljs-property">drivers</span>,
      <span class="hljs-attr">growthOpportunities</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">identifyGrowthOpportunities</span>(playerHistory)
    }
  }
}
</code></pre>
<h3 data-id="heading-10">ç¬¬å››ç« ï¼šå°æ¸¸æˆå•†ä¸šåŒ–ä¸å¢é•¿ç³»ç»Ÿ</h3>
<h4 data-id="heading-11">4.1 AIé©±åŠ¨çš„å•†ä¸šåŒ–å¼•æ“</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// monetization/AIMonetizationEngine.ts - æ™ºèƒ½å•†ä¸šåŒ–ç³»ç»Ÿ</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">MonetizationConfig</span> {
  <span class="hljs-attr">revenueModels</span>: <span class="hljs-title class_">RevenueModel</span>[]
  <span class="hljs-attr">pricingStrategy</span>: <span class="hljs-title class_">PricingStrategy</span>
  <span class="hljs-attr">adPlacement</span>: <span class="hljs-title class_">AdPlacementStrategy</span>
  <span class="hljs-attr">iapOptimization</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">AIMonetizationEngine</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">MonetizationConfig</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">pricingModel</span>: <span class="hljs-title class_">PricingModel</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">adOptimizer</span>: <span class="hljs-title class_">AdOptimizer</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">iapManager</span>: <span class="hljs-title class_">IAPManager</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">subscriptionService</span>: <span class="hljs-title class_">SubscriptionService</span>
  
  <span class="hljs-comment">// AIé¢„æµ‹æ¨¡å‹</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">conversionPredictor</span>: <span class="hljs-title class_">ConversionPredictor</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">priceOptimizer</span>: <span class="hljs-title class_">PriceOptimizer</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">bundleRecommender</span>: <span class="hljs-title class_">BundleRecommender</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: MonetizationConfig</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">config</span> = config
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pricingModel</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PricingModel</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">adOptimizer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AdOptimizer</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">iapManager</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IAPManager</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subscriptionService</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SubscriptionService</span>()
    
    <span class="hljs-comment">// åˆå§‹åŒ–AIæ¨¡å‹</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">conversionPredictor</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConversionPredictor</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">priceOptimizer</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriceOptimizer</span>()
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">bundleRecommender</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BundleRecommender</span>()
    
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupRevenueTracking</span>()
  }
  
  <span class="hljs-comment">// åŠ¨æ€å®šä»·ç­–ç•¥</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">calculateOptimalPrice</span>(<span class="hljs-attr">product</span>: <span class="hljs-title class_">VirtualProduct</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">OptimalPrice</span>&gt; {
    <span class="hljs-keyword">const</span> marketAnalysis = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzeMarketConditions</span>()
    <span class="hljs-keyword">const</span> playerValue = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculatePlayerValue</span>(product.<span class="hljs-property">targetPlayers</span>)
    
    <span class="hljs-keyword">const</span> optimalPrice = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">priceOptimizer</span>.<span class="hljs-title function_">calculate</span>({
      product,
      marketAnalysis,
      playerValue,
      <span class="hljs-attr">competitorPrices</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCompetitorPrices</span>(product.<span class="hljs-property">category</span>),
      <span class="hljs-attr">elasticity</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculatePriceElasticity</span>(product)
    })
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">price</span>: optimalPrice.<span class="hljs-property">amount</span>,
      <span class="hljs-attr">currency</span>: optimalPrice.<span class="hljs-property">currency</span>,
      <span class="hljs-attr">confidence</span>: optimalPrice.<span class="hljs-property">confidence</span>,
      <span class="hljs-attr">rationale</span>: optimalPrice.<span class="hljs-property">explanation</span>,
      <span class="hljs-attr">suggestedTests</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generatePriceTests</span>(optimalPrice)
    }
  }
  
  <span class="hljs-comment">// ä¸ªæ€§åŒ–å¹¿å‘Šç­–ç•¥</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">optimizeAdExperience</span>(<span class="hljs-attr">playerProfile</span>: <span class="hljs-title class_">PlayerProfile</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">AdStrategy</span>&gt; {
    <span class="hljs-keyword">const</span> playerPreferences = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">inferAdPreferences</span>(playerProfile)
    <span class="hljs-keyword">const</span> engagementPatterns = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzeAdEngagement</span>(playerProfile)
    <span class="hljs-keyword">const</span> lifetimeValue = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">predictPlayerLTV</span>(playerProfile.<span class="hljs-property">id</span>)
    
    <span class="hljs-keyword">const</span> strategy = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">adOptimizer</span>.<span class="hljs-title function_">determineStrategy</span>({
      <span class="hljs-attr">player</span>: playerProfile,
      <span class="hljs-attr">preferences</span>: playerPreferences,
      <span class="hljs-attr">engagement</span>: engagementPatterns,
      <span class="hljs-attr">ltv</span>: lifetimeValue,
      <span class="hljs-attr">context</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getGameContext</span>()
    })
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">adFrequency</span>: strategy.<span class="hljs-property">frequency</span>,
      <span class="hljs-attr">adTypes</span>: strategy.<span class="hljs-property">adTypes</span>,
      <span class="hljs-attr">placement</span>: strategy.<span class="hljs-property">placement</span>,
      <span class="hljs-attr">timing</span>: strategy.<span class="hljs-property">timing</span>,
      <span class="hljs-attr">incentives</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">determineAdIncentives</span>(strategy, lifetimeValue)
    }
  }
  
  <span class="hljs-comment">// AIæ¨èç³»ç»Ÿ</span>
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">AIProductRecommender</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-attr">collaborativeFiltering</span>: <span class="hljs-title class_">CollaborativeFiltering</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">contentBasedFiltering</span>: <span class="hljs-title class_">ContentBasedFiltering</span>
    <span class="hljs-keyword">private</span> <span class="hljs-attr">reinforcementLearning</span>: <span class="hljs-title class_">ReinforcementLearning</span>
    
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">recommendProducts</span>(
      <span class="hljs-attr">playerId</span>: <span class="hljs-built_in">string</span>,
      <span class="hljs-attr">context</span>: <span class="hljs-title class_">RecommendationContext</span>
    ): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ProductRecommendation</span>[]&gt; {
      <span class="hljs-comment">// å¤šç®—æ³•æ··åˆæ¨è</span>
      <span class="hljs-keyword">const</span> collaborativeRecs = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">collaborativeFiltering</span>.<span class="hljs-title function_">recommend</span>(
        playerId,
        context
      )
      
      <span class="hljs-keyword">const</span> contentRecs = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentBasedFiltering</span>.<span class="hljs-title function_">recommend</span>(
        playerId,
        context
      )
      
      <span class="hljs-comment">// å¼ºåŒ–å­¦ä¹ ä¼˜åŒ–</span>
      <span class="hljs-keyword">const</span> optimizedRecs = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">reinforcementLearning</span>.<span class="hljs-title function_">optimize</span>(
        [...collaborativeRecs, ...contentRecs],
        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPlayerHistory</span>(playerId)
      )
      
      <span class="hljs-comment">// ç”Ÿæˆè§£é‡Š</span>
      <span class="hljs-keyword">const</span> explainedRecs = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">generateExplanations</span>(optimizedRecs, playerId)
      
      <span class="hljs-keyword">return</span> explainedRecs
    }
    
    <span class="hljs-comment">// A/Bæµ‹è¯•ä¼˜åŒ–</span>
    <span class="hljs-keyword">async</span> <span class="hljs-title function_">optimizeRecommendationAlgorithm</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">OptimizationResult</span>&gt; {
      <span class="hljs-keyword">const</span> algorithms = [
        <span class="hljs-string">'collaborative'</span>,
        <span class="hljs-string">'content-based'</span>,
        <span class="hljs-string">'hybrid'</span>,
        <span class="hljs-string">'reinforcement-learning'</span>
      ]
      
      <span class="hljs-keyword">const</span> experimentResults = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(
        algorithms.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">algorithm</span> =&gt;</span> 
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">testAlgorithm</span>(algorithm)
        )
      )
      
      <span class="hljs-keyword">const</span> bestAlgorithm = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">selectBestAlgorithm</span>(experimentResults)
      
      <span class="hljs-keyword">return</span> {
        bestAlgorithm,
        <span class="hljs-attr">performanceImprovement</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateImprovement</span>(experimentResults),
        <span class="hljs-attr">deploymentPlan</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">createDeploymentPlan</span>(bestAlgorithm)
      }
    }
  }
  
  <span class="hljs-comment">// æ”¶å…¥é¢„æµ‹ä¸ä¼˜åŒ–</span>
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">forecastRevenue</span>(<span class="hljs-attr">timeframe</span>: <span class="hljs-title class_">Timeframe</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">RevenueForecast</span>&gt; {
    <span class="hljs-keyword">const</span> historicalData = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHistoricalRevenue</span>()
    <span class="hljs-keyword">const</span> marketTrends = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">analyzeMarketTrends</span>()
    <span class="hljs-keyword">const</span> playerGrowth = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">projectPlayerGrowth</span>()
    
    <span class="hljs-keyword">const</span> forecast = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">aiAnalyzer</span>.<span class="hljs-title function_">forecastRevenue</span>({
      <span class="hljs-attr">historical</span>: historicalData,
      <span class="hljs-attr">trends</span>: marketTrends,
      <span class="hljs-attr">growth</span>: playerGrowth,
      <span class="hljs-attr">seasonality</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">calculateSeasonality</span>(),
      <span class="hljs-attr">promotions</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPlannedPromotions</span>(timeframe)
    })
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">forecast</span>: forecast.<span class="hljs-property">values</span>,
      <span class="hljs-attr">confidenceIntervals</span>: forecast.<span class="hljs-property">confidence</span>,
      <span class="hljs-attr">keyAssumptions</span>: forecast.<span class="hljs-property">assumptions</span>,
      <span class="hljs-attr">riskFactors</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">identifyRiskFactors</span>(forecast),
      <span class="hljs-attr">optimizationOpportunities</span>: <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">findOptimizationOpportunities</span>(forecast)
    }
  }
}
</code></pre>
<h3 data-id="heading-12">ç¬¬äº”ç« ï¼šä»å°æ¸¸æˆåˆ°CTOçš„æŠ€æœ¯æˆé•¿è·¯å¾„</h3>
<h4 data-id="heading-13">5.1 å…¨æ ˆæ¶æ„å¸ˆæŠ€èƒ½ä½“ç³»</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// architecture/EnterpriseGameArchitecture.ts - ä¼ä¸šçº§æ¸¸æˆæ¶æ„</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">EnterpriseArchitecture</span> {
  <span class="hljs-attr">microservices</span>: <span class="hljs-title class_">MicroserviceConfig</span>[]
  <span class="hljs-attr">eventDriven</span>: <span class="hljs-built_in">boolean</span>
  <span class="hljs-attr">cloudNative</span>: <span class="hljs-built_in">boolean</span>
  <span class="hljs-attr">devOpsEnabled</span>: <span class="hljs-built_in">boolean</span>
  <span class="hljs-attr">aiFirst</span>: <span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">EnterpriseGameArchitecture</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">architecture</span>: <span class="hljs-title class_">EnterpriseArchitecture</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">serviceMesh</span>: <span class="hljs-title class_">ServiceMesh</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">apiGateway</span>: <span class="hljs-title class_">APIGateway</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">dataPipeline</span>: <span class="hljs-title class_">DataPipeline</span>
  
  <span class="hljs-comment">// äº‘åŸç”ŸåŸºç¡€è®¾æ–½</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">k8sCluster</span>: <span class="hljs-title class_">KubernetesCluster</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">serviceRegistry</span>: <span class="hljs-title class_">ServiceRegistry</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">configManager</span>: <span class="hljs-title class_">ConfigManager</span>
  
  <span class="hljs-comment">// ç›‘æ§ä¸å¯è§‚æµ‹æ€§</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">observabilityStack</span>: <span class="hljs-title class_">ObservabilityStack</span>
  <span class="hljs-keyword">private</span> <span class="hljs-attr">alertManager</span>: <span class="hljs-title class_">AlertManager</span>
  
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">config: EnterpriseArchitecture</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">architecture</span> = config
    
    <span class="hljs-comment">// åˆå§‹åŒ–äº‘åŸç”Ÿç»„ä»¶</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">cloudNative</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupCloudNativeInfrastructure</span>()
    }
    
    <span class="hljs-comment">// åˆå§‹åŒ–å¾®æœåŠ¡æ¶æ„</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">microservices</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupMicroservices</span>()
    }
    
    <span class="hljs-comment">// åˆå§‹åŒ–AIä¼˜å…ˆæ¶æ„</span>
    <span class="hljs-keyword">if</span> (config.<span class="hljs-property">aiFirst</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupAIFirstArchitecture</span>()
    }
  }
  
  <span class="hljs-comment">// å¾®æœåŠ¡æ¸¸æˆå¼•æ“æ¶æ„</span>
  <span class="hljs-title function_">setupMicroserviceGameEngine</span>(): <span class="hljs-title class_">MicroserviceGameEngine</span> {
    <span class="hljs-keyword">const</span> services = {
      <span class="hljs-attr">gameLogic</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">GameLogicService</span>(),
      <span class="hljs-attr">physics</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">PhysicsService</span>(),
      <span class="hljs-attr">rendering</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">RenderingService</span>(),
      <span class="hljs-attr">ai</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIService</span>(),
      <span class="hljs-attr">matchmaking</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">MatchmakingService</span>(),
      <span class="hljs-attr">persistence</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">PersistenceService</span>(),
      <span class="hljs-attr">analytics</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">AnalyticsService</span>()
    }
    
    <span class="hljs-comment">// æœåŠ¡é—´é€šä¿¡</span>
    <span class="hljs-keyword">const</span> communication = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServiceCommunication</span>({
      services,
      <span class="hljs-attr">protocol</span>: <span class="hljs-string">'gRPC'</span>,
      <span class="hljs-attr">serviceMesh</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">serviceMesh</span>
    })
    
    <span class="hljs-comment">// æ•°æ®ä¸€è‡´æ€§</span>
    <span class="hljs-keyword">const</span> consistency = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventSourcingSystem</span>({
      services,
      <span class="hljs-attr">eventStore</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventStore</span>(),
      <span class="hljs-attr">projectionEngine</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">ProjectionEngine</span>()
    })
    
    <span class="hljs-keyword">return</span> {
      services,
      communication,
      consistency,
      <span class="hljs-attr">scaling</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupAutoScaling</span>(services),
      <span class="hljs-attr">resilience</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupResiliencePatterns</span>(services)
    }
  }
  
  <span class="hljs-comment">// AIä¼˜å…ˆæ¶æ„</span>
  <span class="hljs-title function_">setupAIFirstArchitecture</span>(): <span class="hljs-title class_">AIFirstArchitecture</span> {
    <span class="hljs-keyword">const</span> aiServices = {
      <span class="hljs-comment">// æ ¸å¿ƒAIæœåŠ¡</span>
      <span class="hljs-attr">contentGeneration</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">AIContentGenerationService</span>(),
      <span class="hljs-attr">playerModeling</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">PlayerModelingService</span>(),
      <span class="hljs-attr">personalization</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">PersonalizationService</span>(),
      <span class="hljs-attr">optimization</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">OptimizationService</span>(),
      
      <span class="hljs-comment">// åŸºç¡€è®¾æ–½</span>
      <span class="hljs-attr">modelRegistry</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelRegistry</span>(),
      <span class="hljs-attr">featureStore</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">FeatureStore</span>(),
      <span class="hljs-attr">trainingPipeline</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TrainingPipeline</span>(),
      <span class="hljs-attr">servingLayer</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModelServingLayer</span>()
    }
    
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">services</span>: aiServices,
      <span class="hljs-attr">dataFlow</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupAIDataFlow</span>(aiServices),
      <span class="hljs-attr">monitoring</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupAIMonitoring</span>(aiServices),
      <span class="hljs-attr">governance</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupAIGovernance</span>(aiServices)
    }
  }
  
  <span class="hljs-comment">// DevOpsä¸CI/CDæµæ°´çº¿</span>
  <span class="hljs-title function_">setupDevOpsPipeline</span>(): <span class="hljs-title class_">DevOpsPipeline</span> {
    <span class="hljs-keyword">const</span> pipeline = {
      <span class="hljs-comment">// ä»£ç ç®¡ç†</span>
      <span class="hljs-attr">sourceControl</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">GitWorkflow</span>({
        <span class="hljs-attr">trunkBased</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">featureFlags</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">codeReview</span>: <span class="hljs-string">'mandatory'</span>
      }),
      
      <span class="hljs-comment">// CI/CD</span>
      <span class="hljs-attr">continuousIntegration</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">CISystem</span>({
        <span class="hljs-attr">build</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">BuildSystem</span>(),
        <span class="hljs-attr">test</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestAutomation</span>(),
        <span class="hljs-attr">security</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecurityScanning</span>()
      }),
      
      <span class="hljs-attr">continuousDeployment</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">CDSystem</span>({
        <span class="hljs-attr">staging</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">StagingEnvironment</span>(),
        <span class="hljs-attr">canary</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">CanaryDeployment</span>(),
        <span class="hljs-attr">rollback</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">AutomatedRollback</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[MCPã€Agentã€å¤§æ¨¡å‹åº”ç”¨æ¶æ„è§£è¯»]]></title>    <link>https://juejin.cn/post/7596998306381758514</link>    <guid>https://juejin.cn/post/7596998306381758514</guid>    <pubDate>2026-01-20T09:58:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596998306381758514" data-draft-id="7597125475601416219" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="MCPã€Agentã€å¤§æ¨¡å‹åº”ç”¨æ¶æ„è§£è¯»"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-20T09:58:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="sorryhc"/> <meta itemprop="url" content="https://juejin.cn/user/3061476130044487"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            MCPã€Agentã€å¤§æ¨¡å‹åº”ç”¨æ¶æ„è§£è¯»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3061476130044487/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    sorryhc
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:58:22.000Z" title="Tue Jan 20 2026 09:58:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">å‰è¨€</h3>
<p>éšç€å¤§è¯­è¨€æ¨¡å‹(LLM)çš„å¿«é€Ÿå‘å±•ï¼Œå¦‚ä½•è®© AI èƒ½å¤Ÿæœ‰æ•ˆåœ°ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’ï¼Œå·²æˆä¸º AI åº”ç”¨å¼€å‘çš„æ ¸å¿ƒè¯¾é¢˜ã€‚Anthropic æ¨å‡ºçš„ MCP(Model Context Protocol)ã€æ™ºèƒ½ä»£ç†(Agent)å’Œå¤§æ¨¡å‹åº”ç”¨ä¸‰è€…çš„ç»“åˆï¼Œå½¢æˆäº†ä¸€å¥—å®Œæ•´çš„ AI ç³»ç»Ÿæ¶æ„ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ·±å…¥è§£è¯»è¿™ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µåŠå…¶ç›¸äº’å…³ç³»ã€‚</p>
<hr/>
<h3 data-id="heading-1">ä¸€ã€3ä¸ªæ ¸å¿ƒæ¦‚å¿µçš„å®šä¹‰</h3>
<h4 data-id="heading-2">1.1 å¤§æ¨¡å‹åº”ç”¨(AI Application)</h4>
<p>å¤§æ¨¡å‹åº”ç”¨æ˜¯æ•´ä¸ªç³»ç»Ÿçš„æœ€å¤–å±‚å®¹å™¨ã€‚å®ƒåŒ…æ‹¬ï¼š</p>
<ul>
<li>åº”ç”¨ç¨‹åºæ¡†æ¶å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†</li>
<li>ç”¨æˆ·äº¤äº’ç•Œé¢(CLIã€Webã€APIç­‰)</li>
<li>ç³»ç»Ÿé…ç½®å’Œèµ„æºç®¡ç†</li>
<li>å¤–éƒ¨é›†æˆ(æ•°æ®åº“ã€ç›‘æ§ç­‰)</li>
</ul>
<pre><code class="hljs">å¤§æ¨¡å‹åº”ç”¨
  â”œâ”€ å¯åŠ¨åº”ç”¨
  â”œâ”€ ç®¡ç†é…ç½®
  â”œâ”€ å¤„ç†ç”¨æˆ·è¾“å…¥
  â”œâ”€ è¿”å›å¤„ç†ç»“æœ
  â””â”€ å…³é—­åº”ç”¨
</code></pre>
<h4 data-id="heading-3">1.2 Agent(æ™ºèƒ½ä»£ç†)</h4>
<p>Agent æ˜¯å¤§æ¨¡å‹åº”ç”¨çš„å¤§è„‘å’Œæ‰§è¡Œå¼•æ“ã€‚å®ƒçš„èŒè´£æ˜¯ï¼š</p>
<ul>
<li>ç†è§£ç”¨æˆ·æ„å›¾(é€šè¿‡å¤§æ¨¡å‹)</li>
<li>è§„åˆ’æ‰§è¡Œæ­¥éª¤</li>
<li>å†³å®šè°ƒç”¨ä»€ä¹ˆå·¥å…·</li>
<li>å¤„ç†å·¥å…·æ‰§è¡Œç»“æœ</li>
<li>æŒç»­ä¼˜åŒ–å’Œè¿­ä»£</li>
</ul>
<p>Agent çš„æ ¸å¿ƒä»·å€¼åœ¨äºå°†å¤§æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ä¸å¤–éƒ¨å·¥å…·æ‰§è¡Œèƒ½åŠ›ç»“åˆã€‚</p>
<h4 data-id="heading-4">1.3 MCP(Model Context Protocol)</h4>
<p>MCP æ˜¯ä¸€ä¸ªå¼€æ”¾çš„é€šä¿¡åè®®è§„èŒƒã€‚å®ƒå®šä¹‰äº†ï¼š</p>
<ul>
<li>å·¥å…·çš„ç»Ÿä¸€è°ƒç”¨æ¥å£</li>
<li>æ¶ˆæ¯çš„æ ‡å‡†æ ¼å¼(JSON-RPC 2.0)</li>
<li>æœåŠ¡çš„å‘ç°å’Œæ³¨å†Œæœºåˆ¶</li>
<li>é”™è¯¯å¤„ç†è§„èŒƒ</li>
</ul>
<p>MCP çš„æ ¸å¿ƒä»·å€¼åœ¨äºè§£è€¦å·¥å…·è°ƒç”¨çš„å¤æ‚æ€§ï¼Œå®ç°å·¥å…·å³æ’å³ç”¨ã€‚</p>
<hr/>
<h3 data-id="heading-5">äºŒã€ä¸‰è€…çš„åŒ…å«å…³ç³»</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 å¤§æ¨¡å‹åº”ç”¨                        â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Agent                         â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚  â”œâ”€ åˆå§‹åŒ– MCP (å»ºç«‹è¿æ¥ã€è·å–å·¥å…·)       â”‚ â”‚
â”‚  â”‚  â”œâ”€ ä¸å¤§æ¨¡å‹äº¤äº’ (å‘é€æç¤ºè¯ã€æ¥æ”¶å“åº”)  â”‚ â”‚
â”‚  â”‚  â”œâ”€ è§£æå¤§æ¨¡å‹è¾“å‡º (è¯†åˆ«å·¥å…·è°ƒç”¨)        â”‚ â”‚
â”‚  â”‚  â”œâ”€ é€šè¿‡ MCP è°ƒç”¨å·¥å…· (æ‰§è¡Œå…·ä½“ä»»åŠ¡)     â”‚ â”‚
â”‚  â”‚  â”œâ”€ å¤„ç†å·¥å…·ç»“æœ (åé¦ˆç»™å¤§æ¨¡å‹)          â”‚ â”‚
â”‚  â”‚  â””â”€ å¾ªç¯è¿­ä»£ (ç›´åˆ°ä»»åŠ¡å®Œæˆ)              â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â”‚         â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º          â”‚ â”‚
â”‚  â”‚            MCP (å·¥å…·åè®®)                  â”‚ â”‚
â”‚  â”‚         â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º          â”‚ â”‚
â”‚  â”‚                                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                  â”‚
â”‚  ç”¨æˆ·è¾“å…¥  â”€â”€â–º  åº”ç”¨å¤„ç†  â”€â”€â–º  ç”¨æˆ·è¾“å‡º        â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-6">ä¸‰ã€å·¥ä½œæµç¨‹è¯¦è§£</h3>
<h4 data-id="heading-7">3.1 åˆå§‹åŒ–é˜¶æ®µ</h4>
<pre><code class="hljs language-arduino" lang="arduino">ç¬¬ä¸€æ­¥ï¼šè¯»å–é…ç½®æ–‡ä»¶(mcp.json)
  â”œâ”€ æ£€æŸ¥æœ‰å“ªäº› MCP <span class="hljs-built_in">Server</span>
  â”œâ”€ éªŒè¯é…ç½®çš„åˆæ³•æ€§
  â””â”€ è®°å½•å·¥å…·æ¥æºä¿¡æ¯

ç¬¬äºŒæ­¥ï¼šè¿æ¥æ‰€æœ‰ MCP <span class="hljs-built_in">Server</span>
  â”œâ”€ ä¸ºæ¯ä¸ª <span class="hljs-built_in">Server</span> åˆ›å»º MCP <span class="hljs-built_in">Client</span>
  â”œâ”€ å»ºç«‹ä¼ è¾“è¿æ¥(stdio/HTTP/WebSocket)
  â”œâ”€ å‘é€ initialize ä¿¡æ¯æ¡æ‰‹
  â””â”€ è·å– <span class="hljs-built_in">Server</span> èƒ½åŠ›ä¿¡æ¯

ç¬¬ä¸‰æ­¥ï¼šè·å–æ‰€æœ‰å·¥å…·åˆ—è¡¨
  â”œâ”€ ä»æ¯ä¸ª <span class="hljs-built_in">Server</span> è°ƒç”¨ <span class="hljs-built_in">listTools</span>()
  â”œâ”€ æ”¶é›†è¿”å›çš„å·¥å…·å®šä¹‰
  â”œâ”€ åˆå¹¶å·¥å…·åˆ—è¡¨å¹¶æ£€æŸ¥å†²çª
  â””â”€ æ ‡è®°æ¯ä¸ªå·¥å…·æ¥è‡ªå“ªä¸ª <span class="hljs-built_in">Server</span>

ç¬¬å››æ­¥ï¼šå‡†å¤‡å°±ç»ª
  â””â”€ Agent è·å¾—å®Œæ•´çš„å·¥å…·æ¸…å•ï¼Œå¯ä»¥å¼€å§‹å·¥ä½œ
</code></pre>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AIApplication</span> {
  <span class="hljs-keyword">private</span> <span class="hljs-attr">agent</span>: <span class="hljs-title class_">Agent</span>
  
  <span class="hljs-keyword">async</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// Agent åˆå§‹åŒ–</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Agent</span>(<span class="hljs-string">"mcp.json"</span>)
    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">agent</span>.<span class="hljs-title function_">initialize</span>()
    
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"âœ“ åº”ç”¨åˆå§‹åŒ–å®Œæˆ"</span>)
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`âœ“ å¯ç”¨å·¥å…·æ•°: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.agent.toolCount}</span>`</span>)
  }
}
</code></pre>
<h4 data-id="heading-8">3.2 å¤„ç†è¯·æ±‚é˜¶æ®µ</h4>
<p>å½“ç”¨æˆ·è¾“å…¥ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå®Œæ•´çš„å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">ç”¨æˆ·è¾“å…¥: <span class="hljs-string">"å¸®æˆ‘è®¡ç®— (10 + 5) * 2 çš„ç»“æœ"</span>
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡æç¤ºè¯                 â”‚
â”‚  â”œâ”€ è·å–å½“å‰çš„å·¥å…·åˆ—è¡¨                   â”‚
â”‚  â”œâ”€ ç»„ç»‡æˆ Claude èƒ½ç†è§£çš„æ ¼å¼          â”‚
â”‚  â””â”€ åŠ å…¥ç”¨æˆ·çš„åŸå§‹è¯·æ±‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Claude API              â”‚
  â”‚  (å¤„ç†ç”¨æˆ·è¯·æ±‚)          â”‚
  â”‚  â”œâ”€ ç†è§£ç”¨æˆ·æ„å›¾         â”‚
  â”‚  â”œâ”€ è§„åˆ’æ‰§è¡Œæ­¥éª¤         â”‚
  â”‚  â””â”€ å†³å®šè°ƒç”¨å“ªäº›å·¥å…·     â”‚
  â”‚                          â”‚
  â”‚  Claude å“åº”:            â”‚
  â”‚  <span class="hljs-string">"æˆ‘éœ€è¦å…ˆè°ƒç”¨ add(10,5)"</span>â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Agent ç¬¬äºŒæ­¥ï¼šå¤„ç†å·¥å…·è°ƒç”¨è¯·æ±‚     â”‚
  â”‚  â”œâ”€ è§£æ Claude çš„å“åº”             â”‚
  â”‚  â”œâ”€ è¯†åˆ«å‡ºè¦è°ƒç”¨ <span class="hljs-string">"add"</span> å·¥å…·        â”‚
  â”‚  â”œâ”€ æ‰¾åˆ° <span class="hljs-string">"add"</span> æ¥è‡ªå“ªä¸ª <span class="hljs-built_in">Server</span>    â”‚
  â”‚  â””â”€ è·å–è¯¥ <span class="hljs-built_in">Server</span> çš„ MCP <span class="hljs-built_in">Client</span>    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Agent ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡ MCP è°ƒç”¨å·¥å…·    â”‚
  â”‚  â”œâ”€ æ„å»ºæ ‡å‡†åŒ–çš„ RPC è¯·æ±‚          â”‚
  â”‚  â”œâ”€ è°ƒç”¨: client.<span class="hljs-built_in">callTool</span>(<span class="hljs-string">"add"</span>,   â”‚
  â”‚  â”‚         {a: <span class="hljs-number">10</span>, b: <span class="hljs-number">5</span>})         â”‚
  â”‚  â””â”€ ç­‰å¾…å·¥å…·æ‰§è¡Œå®Œæ¯•               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  <span class="hljs-function">MCP <span class="hljs-title">Server</span> <span class="hljs-params">(å®é™…æ‰§è¡Œå·¥å…·)</span>         â”‚
  â”‚  â”œâ”€ æ¥æ”¶ RPC è¯·æ±‚                  â”‚
  â”‚  â”œâ”€ æ‰§è¡Œ: <span class="hljs-number">10</span> + <span class="hljs-number">5</span> =</span> <span class="hljs-number">15</span>             â”‚
  â”‚  â””â”€ è¿”å›ç»“æœ: {result: <span class="hljs-number">15</span>}        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Agent ç¬¬å››æ­¥ï¼šåé¦ˆç»™ Claude        â”‚
  â”‚  â”œâ”€ æŠŠç»“æœæ·»åŠ åˆ°å¯¹è¯å†å²           â”‚
  â”‚  â”œâ”€ <span class="hljs-string">"add(10, 5) çš„ç»“æœæ˜¯ 15"</span>      â”‚
  â”‚  â””â”€ é‡æ–°è°ƒç”¨ Claude               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Claude ç»§ç»­æ¨ç†                  â”‚
  â”‚  â”œâ”€ çœ‹åˆ°äº†ç¬¬ä¸€æ­¥çš„ç»“æœ             â”‚
  â”‚  â”œâ”€ ç»§ç»­è§„åˆ’ä¸‹ä¸€æ­¥                 â”‚
  â”‚  â””â”€ <span class="hljs-string">"ç°åœ¨æˆ‘éœ€è¦è°ƒç”¨ multiply(15,2)"</span>â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
  (é‡å¤æ­¥éª¤ <span class="hljs-number">2</span><span class="hljs-number">-4</span> ç›´åˆ° Claude è¯´å®Œæˆ)
               â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Claude æœ€ç»ˆå“åº”                   â”‚
  â”‚  â”œâ”€ stop_reason = <span class="hljs-string">"end_turn"</span>      â”‚
  â”‚  â”œâ”€ content = <span class="hljs-string">"ç­”æ¡ˆæ˜¯ 30"</span>         â”‚
  â”‚  â””â”€ Agent åœæ­¢å¾ªç¯                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
        è¿”å›ç”¨æˆ·: <span class="hljs-string">"ç­”æ¡ˆæ˜¯ 30"</span>
</code></pre>
<h4 data-id="heading-9">3.3 å¾ªç¯æœºåˆ¶çš„å…³é”®</h4>
<p>Agent çš„å¾ªç¯å¤„ç†æ˜¯ç†è§£æ•´ä¸ªæ¶æ„çš„å…³é”®ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">async</span> <span class="hljs-title function_">process</span>(<span class="hljs-attr">userInput</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt; {
  <span class="hljs-keyword">let</span> messages = [{ <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>, <span class="hljs-attr">content</span>: userInput }]
  
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> iteration = <span class="hljs-number">0</span>; iteration &lt; maxIterations; iteration++) {
    <span class="hljs-comment">// 1. è°ƒç”¨ Claude</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> claude.<span class="hljs-property">messages</span>.<span class="hljs-title function_">create</span>({
      messages,
      <span class="hljs-attr">tools</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">tools</span>  <span class="hljs-comment">// ä¼ é€’æ‰€æœ‰å¯ç”¨å·¥å…·</span>
    })
    
    <span class="hljs-comment">// 2. æ·»åŠ  Claude çš„å“åº”åˆ°å†å²</span>
    messages.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">role</span>: <span class="hljs-string">"assistant"</span>, <span class="hljs-attr">content</span>: response.<span class="hljs-property">content</span> })
    
    <span class="hljs-comment">// 3. æ£€æŸ¥ Claude æ˜¯å¦å®Œæˆ</span>
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">stop_reason</span> === <span class="hljs-string">"end_turn"</span>) {
      <span class="hljs-comment">// Claude å®Œæˆäº†ï¼Œè¿”å›æœ€ç»ˆç­”æ¡ˆ</span>
      <span class="hljs-keyword">const</span> textBlock = response.<span class="hljs-property">content</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">b</span> =&gt;</span> b.<span class="hljs-property">type</span> === <span class="hljs-string">"text"</span>)
      <span class="hljs-keyword">return</span> textBlock.<span class="hljs-property">text</span>
    }
    
    <span class="hljs-comment">// 4. Claude è¦æ±‚è°ƒç”¨å·¥å…·</span>
    <span class="hljs-keyword">if</span> (response.<span class="hljs-property">stop_reason</span> === <span class="hljs-string">"tool_use"</span>) {

      <span class="hljs-keyword">const</span> toolResults = [ ]

      
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> block <span class="hljs-keyword">of</span> response.<span class="hljs-property">content</span>) {
        <span class="hljs-keyword">if</span> (block.<span class="hljs-property">type</span> === <span class="hljs-string">"tool_use"</span>) {
          <span class="hljs-comment">// é€šè¿‡ MCP è°ƒç”¨å·¥å…·</span>
          <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">callToolViaMCP</span>(
            block.<span class="hljs-property">name</span>,
            block.<span class="hljs-property">input</span>
          )
          
          toolResults.<span class="hljs-title function_">push</span>({
            <span class="hljs-attr">type</span>: <span class="hljs-string">"tool_result"</span>,
            <span class="hljs-attr">tool_use_id</span>: block.<span class="hljs-property">id</span>,
            <span class="hljs-attr">content</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result)
          })
        }
      }
      
      <span class="hljs-comment">// 5. æŠŠå·¥å…·ç»“æœæ·»åŠ åˆ°å†å²ï¼ˆå…³é”®ï¼Claude éœ€è¦çœ‹åˆ°ç»“æœï¼‰</span>
      messages.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span>,
        <span class="hljs-attr">content</span>: toolResults
      })
      
      <span class="hljs-comment">// å¾ªç¯å›ç¬¬ 1 æ­¥ï¼ŒClaude åŸºäºå·¥å…·ç»“æœç»§ç»­æ¨ç†</span>
    }
  }
}
</code></pre>
<p>å…³é”®ç‚¹ï¼š</p>
<ul>
<li><code>messages</code> æ•°ç»„æ˜¯"è®°å¿†"ï¼Œä¸æ–­ç§¯ç´¯</li>
<li>æ¯æ¬¡è°ƒç”¨ Claude æ—¶ï¼Œéƒ½ä¼ é€’å®Œæ•´çš„å†å²</li>
<li>Claude åŸºäºä¹‹å‰çš„å·¥å…·æ‰§è¡Œç»“æœè¿›è¡Œä¸‹ä¸€æ­¥å†³ç­–</li>
</ul>
<hr/>
<h3 data-id="heading-10">å››ã€MCP çš„æ³›åŒ–è°ƒç”¨è®¾è®¡</h3>
<h4 data-id="heading-11">4.1 ä¸ºä»€ä¹ˆéœ€è¦æ³›åŒ–ï¼Ÿ</h4>
<p>ä¸æ³›åŒ–çš„æ–¹å¼ï¼ˆæ··ä¹±ï¼‰ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">// éœ€è¦ä¸ºæ¯ä¸ªå·¥å…·å†™ç‰¹å®šä»£ç 
if (<span class="hljs-attr">toolName</span> === <span class="hljs-string">"add"</span>) {
  <span class="hljs-attr">result</span> = calculator.add(args.a, args.b)
} else if (<span class="hljs-attr">toolName</span> === <span class="hljs-string">"query"</span>) {
  <span class="hljs-attr">result</span> = database.query(args.sql)
} else if (<span class="hljs-attr">toolName</span> === <span class="hljs-string">"analyzeCode"</span>) {
  <span class="hljs-attr">result</span> = codeAnalyzer.analyze(args.code)
}
// ... 100+ ä¸ª else if ...

// é—®é¢˜ï¼šæ–°å¢å·¥å…·æ—¶è¦æ”¹åº”ç”¨ä»£ç 
</code></pre>
<p>æ³›åŒ–çš„æ–¹å¼ï¼ˆMCPï¼‰ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ä¸€ä¸ªå‡½æ•°æå®šæ‰€æœ‰å·¥å…·</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.callToolViaMCP(toolName, args)

<span class="hljs-comment">// é—®é¢˜è§£å†³ï¼šæ–°å¢å·¥å…·æ—¶åªéœ€æ”¹é…ç½®</span>
</code></pre>
<h4 data-id="heading-12">4.2 æ³›åŒ–çš„å®ç°åŸç†</h4>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç»Ÿä¸€çš„å·¥å…·è°ƒç”¨æ¥å£                      â”‚
â”‚   <span class="hljs-built_in">callTool</span>(name: string, args: any)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                 â”‚
      â–¼                 â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Server â”‚      â”‚ Server   â”‚
  â”‚ <span class="hljs-selector-tag">A</span>      â”‚      â”‚ <span class="hljs-selector-tag">B</span>        â”‚
  â”‚        â”‚      â”‚          â”‚
  â”‚ add    â”‚      â”‚ query    â”‚
  â”‚ sub    â”‚      â”‚ insert   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ‰€æœ‰ Server éµå®ˆç›¸åŒçš„ MCP è§„èŒƒï¼š
  â”œâ”€ éƒ½æ”¯æŒ <span class="hljs-built_in">listTools</span>() æ–¹æ³•
  â”œâ”€ éƒ½æ”¯æŒ <span class="hljs-built_in">callTool</span>(name, args) è°ƒç”¨
  â”œâ”€ éƒ½è¿”å›æ ‡å‡†æ ¼å¼çš„ç»“æœ
  â””â”€ åº”ç”¨æ— éœ€å…³å¿ƒ Server å·®å¼‚
</code></pre>
<h4 data-id="heading-13">4.3 MCP è§„èŒƒçš„çº¦æŸ</h4>
<p>MCP å®šä¹‰äº†ç»Ÿä¸€çš„æ¶ˆæ¯æ ¼å¼ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// å·¥å…·åˆ—è¡¨è¯·æ±‚</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tools/list"</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// å·¥å…·åˆ—è¡¨å“åº”</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"tools"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Add two numbers"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"inputSchema"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"object"</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"a"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"number"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"b"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"number"</span><span class="hljs-punctuation">}</span>
          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"a"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"b"</span><span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// å·¥å…·è°ƒç”¨è¯·æ±‚</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"method"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tools/call"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"a"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"b"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// å·¥å…·è°ƒç”¨å“åº”</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"jsonrpc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2.0"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"text"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"5 + 3 = 8"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 data-id="heading-14">å››ã€ç»“å°¾</h2>
<p>å› æ­¤æœ‰äº†å¯¹è¿™ä¸‰è€…çš„æ ¸å¿ƒæ¦‚å¿µçš„äº†è§£ï¼Œå…¶å®å¯¹å¤§æ¨¡å‹åº”ç”¨å¼€å‘ä¹Ÿæœ‰äº†æ¯”è¾ƒæ·±å…¥çš„è®¤è¯†äº†ã€‚</p>
<p>è¯„è®ºåŒºæ¬¢è¿è®¨è®ºã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangFlow-Python Interpreterç»„ä»¶åˆ†æ]]></title>    <link>https://juejin.cn/post/7597125475601399835</link>    <guid>https://juejin.cn/post/7597125475601399835</guid>    <pubDate>2026-01-20T09:49:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597125475601399835" data-draft-id="7597278451028803594" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangFlow-Python Interpreterç»„ä»¶åˆ†æ"/> <meta itemprop="keywords" content="LangChain"/> <meta itemprop="datePublished" content="2026-01-20T09:49:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·20963873743"/> <meta itemprop="url" content="https://juejin.cn/user/3300076588372683"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangFlow-Python Interpreterç»„ä»¶åˆ†æ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3300076588372683/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·20963873743
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:49:23.000Z" title="Tue Jan 20 2026 09:49:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Python Interpreter (PythonREPLComponent) ç»„ä»¶åˆ†æ</h2>
<h3 data-id="heading-1">ä¸€ã€ç»„ä»¶æ¦‚è¿°</h3>
<h4 data-id="heading-2">1. åŸºæœ¬ä¿¡æ¯</h4>





































<table><thead><tr><th>å±æ€§</th><th>å€¼</th></tr></thead><tbody><tr><td><strong>ç»„ä»¶åç§°</strong></td><td>Python Interpreter</td></tr><tr><td><strong>ç±»å</strong></td><td>PythonREPLComponent</td></tr><tr><td><strong>åˆ†ç±»</strong></td><td>Processingï¼ˆæ•°æ®å¤„ç†ï¼‰</td></tr><tr><td><strong>å›¾æ ‡</strong></td><td>square-terminal</td></tr><tr><td><strong>æè¿°</strong></td><td>Run Python code with optional imports. Use print() to see the output.</td></tr><tr><td><strong>æ–‡æ¡£</strong></td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langflow.org%2Fcomponents-processing%23python-interpreter" target="_blank" title="https://docs.langflow.org/components-processing#python-interpreter" ref="nofollow noopener noreferrer">docs.langflow.org/components-â€¦</a></td></tr><tr><td><strong>æºç ä½ç½®</strong></td><td><code>langflow/components/processing/python_repl_core.py</code></td></tr></tbody></table>
<h4 data-id="heading-3">2. ç»„ä»¶ç”¨é€”</h4>
<p>Python Interpreter ç»„ä»¶å…è®¸ç”¨æˆ·åœ¨ Langflow å·¥ä½œæµä¸­æ‰§è¡Œ Python ä»£ç ï¼Œæ”¯æŒï¼š</p>
<ul>
<li>æ•°å­¦è®¡ç®—å’Œæ•°æ®å¤„ç†</li>
<li>ä½¿ç”¨å¸¸ç”¨åº“ï¼ˆmath, pandas, numpy ç­‰ï¼‰</li>
<li>è‡ªå®šä¹‰é€»è¾‘å¤„ç†</li>
<li>æ•°æ®è½¬æ¢å’Œåˆ†æ</li>
</ul>
<hr/>
<h3 data-id="heading-4">äºŒã€ä»£ç ç»“æ„åˆ†æ</h3>
<h4 data-id="heading-5">1. å®Œæ•´æºç </h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> importlib

<span class="hljs-keyword">from</span> langchain_experimental.utilities <span class="hljs-keyword">import</span> PythonREPL

<span class="hljs-keyword">from</span> langflow.custom.custom_component.component <span class="hljs-keyword">import</span> Component
<span class="hljs-keyword">from</span> langflow.io <span class="hljs-keyword">import</span> MultilineInput, Output, StrInput
<span class="hljs-keyword">from</span> langflow.schema.data <span class="hljs-keyword">import</span> Data


<span class="hljs-keyword">class</span> <span class="hljs-title class_">PythonREPLComponent</span>(<span class="hljs-title class_ inherited__">Component</span>):
    display_name = <span class="hljs-string">"Python Interpreter"</span>
    description = <span class="hljs-string">"Run Python code with optional imports. Use print() to see the output."</span>
    documentation: <span class="hljs-built_in">str</span> = <span class="hljs-string">"https://docs.langflow.org/components-processing#python-interpreter"</span>
    icon = <span class="hljs-string">"square-terminal"</span>

    inputs = [
        StrInput(
            name=<span class="hljs-string">"global_imports"</span>,
            display_name=<span class="hljs-string">"Global Imports"</span>,
            info=<span class="hljs-string">"A comma-separated list of modules to import globally, e.g. 'math,numpy,pandas'."</span>,
            value=<span class="hljs-string">"math,pandas"</span>,
            required=<span class="hljs-literal">True</span>,
        ),
        MultilineInput(
            name=<span class="hljs-string">"python_code"</span>,
            display_name=<span class="hljs-string">"Python Code"</span>,
            info=<span class="hljs-string">"The Python code to execute. Only modules specified in Global Imports can be used."</span>,
            value=<span class="hljs-string">"print('Hello, World!')"</span>,
            input_types=[<span class="hljs-string">"Message"</span>],
            tool_mode=<span class="hljs-literal">True</span>,
            required=<span class="hljs-literal">True</span>,
        ),
    ]

    outputs = [
        Output(
            display_name=<span class="hljs-string">"Results"</span>,
            name=<span class="hljs-string">"results"</span>,
            type_=Data,
            method=<span class="hljs-string">"run_python_repl"</span>,
        ),
    ]

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_globals</span>(<span class="hljs-params">self, global_imports: <span class="hljs-built_in">str</span> | <span class="hljs-built_in">list</span>[<span class="hljs-built_in">str</span>]</span>) -&gt; <span class="hljs-built_in">dict</span>:
        <span class="hljs-string">"""Create a globals dictionary with only the specified allowed imports."""</span>
        global_dict = {}

        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(global_imports, <span class="hljs-built_in">str</span>):
                modules = [module.strip() <span class="hljs-keyword">for</span> module <span class="hljs-keyword">in</span> global_imports.split(<span class="hljs-string">","</span>)]
            <span class="hljs-keyword">elif</span> <span class="hljs-built_in">isinstance</span>(global_imports, <span class="hljs-built_in">list</span>):
                modules = global_imports
            <span class="hljs-keyword">else</span>:
                msg = <span class="hljs-string">"global_imports must be either a string or a list"</span>
                <span class="hljs-keyword">raise</span> TypeError(msg)

            <span class="hljs-keyword">for</span> module <span class="hljs-keyword">in</span> modules:
                <span class="hljs-keyword">try</span>:
                    imported_module = importlib.import_module(module)
                    global_dict[imported_module.__name__] = imported_module
                <span class="hljs-keyword">except</span> ImportError <span class="hljs-keyword">as</span> e:
                    msg = <span class="hljs-string">f"Could not import module <span class="hljs-subst">{module}</span>: <span class="hljs-subst">{e!s}</span>"</span>
                    <span class="hljs-keyword">raise</span> ImportError(msg) <span class="hljs-keyword">from</span> e

        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            self.log(<span class="hljs-string">f"Error in global imports: <span class="hljs-subst">{e!s}</span>"</span>)
            <span class="hljs-keyword">raise</span>
        <span class="hljs-keyword">else</span>:
            self.log(<span class="hljs-string">f"Successfully imported modules: <span class="hljs-subst">{<span class="hljs-built_in">list</span>(global_dict.keys())}</span>"</span>)
            <span class="hljs-keyword">return</span> global_dict

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_python_repl</span>(<span class="hljs-params">self</span>) -&gt; Data:
        <span class="hljs-keyword">try</span>:
            globals_ = self.get_globals(self.global_imports)
            python_repl = PythonREPL(_<span class="hljs-built_in">globals</span>=globals_)
            result = python_repl.run(self.python_code)
            result = result.strip() <span class="hljs-keyword">if</span> result <span class="hljs-keyword">else</span> <span class="hljs-string">""</span>

            self.log(<span class="hljs-string">"Code execution completed successfully"</span>)
            <span class="hljs-keyword">return</span> Data(data={<span class="hljs-string">"result"</span>: result})

        <span class="hljs-keyword">except</span> ImportError <span class="hljs-keyword">as</span> e:
            error_message = <span class="hljs-string">f"Import Error: <span class="hljs-subst">{e!s}</span>"</span>
            self.log(error_message)
            <span class="hljs-keyword">return</span> Data(data={<span class="hljs-string">"error"</span>: error_message})

        <span class="hljs-keyword">except</span> SyntaxError <span class="hljs-keyword">as</span> e:
            error_message = <span class="hljs-string">f"Syntax Error: <span class="hljs-subst">{e!s}</span>"</span>
            self.log(error_message)
            <span class="hljs-keyword">return</span> Data(data={<span class="hljs-string">"error"</span>: error_message})

        <span class="hljs-keyword">except</span> (NameError, TypeError, ValueError) <span class="hljs-keyword">as</span> e:
            error_message = <span class="hljs-string">f"Error during execution: <span class="hljs-subst">{e!s}</span>"</span>
            self.log(error_message)
            <span class="hljs-keyword">return</span> Data(data={<span class="hljs-string">"error"</span>: error_message})

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">build</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> self.run_python_repl
</code></pre>
<h4 data-id="heading-6">2. ä»£ç ç»“æ„å›¾</h4>
<pre><code class="hljs language-scss" lang="scss">PythonREPLComponent
â”‚
â”œâ”€â”€ è¾“å…¥å‚æ•° (Inputs)
â”‚   â”œâ”€â”€ global_imports (StrInput)
â”‚   â”‚   â”œâ”€â”€ ç±»å‹: å­—ç¬¦ä¸²
â”‚   â”‚   â”œâ”€â”€ é»˜è®¤å€¼: <span class="hljs-string">"math,pandas"</span>
â”‚   â”‚   â””â”€â”€ è¯´æ˜: å…¨å±€å¯¼å…¥æ¨¡å—åˆ—è¡¨
â”‚   â”‚
â”‚   â””â”€â”€ python_code (MultilineInput)
â”‚       â”œâ”€â”€ ç±»å‹: å¤šè¡Œæ–‡æœ¬
â”‚       â”œâ”€â”€ é»˜è®¤å€¼: <span class="hljs-string">"print('Hello, World!')"</span>
â”‚       â”œâ”€â”€ input_types: [<span class="hljs-string">"Message"</span>]
â”‚       â”œâ”€â”€ tool_mode: True
â”‚       â””â”€â”€ è¯´æ˜: è¦æ‰§è¡Œçš„ Python ä»£ç 
â”‚
â”œâ”€â”€ è¾“å‡ºå‚æ•° (Outputs)
â”‚   â””â”€â”€ results (Output)
â”‚       â”œâ”€â”€ ç±»å‹: Data
â”‚       â”œâ”€â”€ æ–¹æ³•: run_python_repl
â”‚       â””â”€â”€ è¯´æ˜: æ‰§è¡Œç»“æœ
â”‚
â””â”€â”€ æ ¸å¿ƒæ–¹æ³• (Methods)
    â”œâ”€â”€ <span class="hljs-built_in">get_globals</span>()           # æ„å»ºå…¨å±€å¯¼å…¥å­—å…¸
    â”œâ”€â”€ <span class="hljs-built_in">run_python_repl</span>()       # æ‰§è¡Œ Python ä»£ç 
    â””â”€â”€ <span class="hljs-built_in">build</span>()                 # ç»„ä»¶æ„å»ºæ–¹æ³•
</code></pre>
<hr/>
<h3 data-id="heading-7">ä¸‰ã€å‚æ•°è¯¦è§£</h3>
<h4 data-id="heading-8">1. è¾“å…¥å‚æ•°</h4>
<h5 data-id="heading-9">global_importsï¼ˆå…¨å±€å¯¼å…¥ï¼‰</h5>





























<table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç±»å‹</strong></td><td>å­—ç¬¦ä¸² (StrInput)</td></tr><tr><td><strong>æ˜¾ç¤ºåç§°</strong></td><td>Global Imports</td></tr><tr><td><strong>å¿…å¡«</strong></td><td>æ˜¯</td></tr><tr><td><strong>é»˜è®¤å€¼</strong></td><td><code>"math,pandas"</code></td></tr><tr><td><strong>è¯´æ˜</strong></td><td>é€—å·åˆ†éš”çš„æ¨¡å—åˆ—è¡¨ï¼Œä¾‹å¦‚ï¼š<code>math,numpy,pandas</code></td></tr></tbody></table>
<p><strong>æ”¯æŒçš„å¸¸ç”¨æ¨¡å—ï¼š</strong></p>





































<table><thead><tr><th>æ¨¡å—</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>math</code></td><td>æ•°å­¦å‡½æ•°ï¼ˆä¸‰è§’å‡½æ•°ã€å¯¹æ•°ç­‰ï¼‰</td></tr><tr><td><code>pandas</code></td><td>æ•°æ®åˆ†æå’Œå¤„ç†</td></tr><tr><td><code>numpy</code></td><td>æ•°å€¼è®¡ç®—</td></tr><tr><td><code>json</code></td><td>JSON æ•°æ®å¤„ç†</td></tr><tr><td><code>datetime</code></td><td>æ—¥æœŸæ—¶é—´å¤„ç†</td></tr><tr><td><code>re</code></td><td>æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td><code>collections</code></td><td>é«˜çº§æ•°æ®ç»“æ„</td></tr></tbody></table>
<h5 data-id="heading-10">python_codeï¼ˆPython ä»£ç ï¼‰</h5>





































<table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç±»å‹</strong></td><td>å¤šè¡Œæ–‡æœ¬ (MultilineInput)</td></tr><tr><td><strong>æ˜¾ç¤ºåç§°</strong></td><td>Python Code</td></tr><tr><td><strong>å¿…å¡«</strong></td><td>æ˜¯</td></tr><tr><td><strong>é»˜è®¤å€¼</strong></td><td><code>print('Hello, World!')</code></td></tr><tr><td><strong>input_types</strong></td><td><code>["Message"]</code> - å¯æ¥æ”¶ Message ç±»å‹è¾“å…¥</td></tr><tr><td><strong>tool_mode</strong></td><td><code>True</code> - æ”¯æŒå·¥å…·æ¨¡å¼</td></tr><tr><td><strong>è¯´æ˜</strong></td><td>è¦æ‰§è¡Œçš„ Python ä»£ç ï¼Œåªæœ‰ Global Imports ä¸­æŒ‡å®šçš„æ¨¡å—å¯ä»¥ä½¿ç”¨</td></tr></tbody></table>
<h4 data-id="heading-11">2. è¾“å‡ºå‚æ•°</h4>
<h5 data-id="heading-12">resultsï¼ˆæ‰§è¡Œç»“æœï¼‰</h5>

























<table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>ç±»å‹</strong></td><td>Data å¯¹è±¡</td></tr><tr><td><strong>æ˜¾ç¤ºåç§°</strong></td><td>Results</td></tr><tr><td><strong>æ–¹æ³•</strong></td><td><code>run_python_repl</code></td></tr><tr><td><strong>è¿”å›ç»“æ„</strong></td><td><code>{"result": "æ‰§è¡Œç»“æœå­—ç¬¦ä¸²"}</code> æˆ– <code>{"error": "é”™è¯¯ä¿¡æ¯"}</code></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-13">å››ã€å‚æ•°ä¼ é€’æœºåˆ¶</h3>
<h4 data-id="heading-14">1. æ•°æ®æµå›¾</h4>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸Šæ¸¸ç»„ä»¶       â”‚
â”‚  (Chat/<span class="hljs-selector-tag">Input</span>)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Message/Data
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Python Interpreter                  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  global_imports: <span class="hljs-string">"math,pandas"</span>   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  python_code (å¯æ¥æ”¶ä¸Šæ¸¸è¾“å…¥)      â”‚  â”‚
â”‚  â”‚  - è¾“å…¥ç±»å‹: [<span class="hljs-string">"Message"</span>]           â”‚  â”‚
â”‚  â”‚  - tool_mode: True                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚  æ‰§è¡Œ: <span class="hljs-built_in">run_python_repl</span>()                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  <span class="hljs-number">1</span>. <span class="hljs-built_in">get_globals</span>()                  â”‚  â”‚
â”‚  â”‚  <span class="hljs-number">2</span>. <span class="hljs-built_in">PythonREPL</span>(_globals)          â”‚  â”‚
â”‚  â”‚  <span class="hljs-number">3</span>. python_repl.<span class="hljs-built_in">run</span>(code)          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ Data
                 â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  ä¸‹æ¸¸ç»„ä»¶       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-15">2. input_types å‚æ•°è¯´æ˜</h4>
<p><code>input_types=["Message"]</code> è¡¨ç¤º <code>python_code</code> è¾“å…¥å¯ä»¥æ¥æ”¶æ¥è‡ªä¸Šæ¸¸ç»„ä»¶çš„ Message å¯¹è±¡ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># å½“ä¸Šæ¸¸ç»„ä»¶è¾“å‡º Message æ—¶</span>
<span class="hljs-comment"># python_code ä¼šè‡ªåŠ¨æ¥æ”¶ Message.content ä½œä¸ºä»£ç </span>
</code></pre>
<h4 data-id="heading-16">3. tool_mode å‚æ•°è¯´æ˜</h4>
<p><code>tool_mode=True</code> è¡¨ç¤ºè¯¥ç»„ä»¶å¯ä»¥ä½œä¸ºå·¥å…·è¢« Agent è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Agent å¯ä»¥åŠ¨æ€è°ƒç”¨æ­¤ç»„ä»¶æ‰§è¡Œä»£ç </span>
tool = PythonREPLComponent()
result = agent.run(<span class="hljs-string">"ç”¨ Python è®¡ç®— 15 * 23"</span>)
</code></pre>
<h4 data-id="heading-17">4. å‚æ•°ä¼ é€’ç¤ºä¾‹</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åœºæ™¯ 1: é™æ€ä»£ç æ‰§è¡Œ</span>
global_imports = <span class="hljs-string">"math,numpy"</span>
python_code = <span class="hljs-string">"print(math.sqrt(16))"</span>
<span class="hljs-comment"># è¾“å‡º: {"result": "4.0"}</span>

<span class="hljs-comment"># åœºæ™¯ 2: æ¥æ”¶ä¸Šæ¸¸ Message è¾“å…¥</span>
<span class="hljs-comment"># ä¸Šæ¸¸ç»„ä»¶è¾“å‡º: Message(content="print('Hello')")</span>
<span class="hljs-comment"># python_code è‡ªåŠ¨æ¥æ”¶ä¸Šæ¸¸çš„ Message.content</span>
<span class="hljs-comment"># è¾“å‡º: {"result": "Hello"}</span>

<span class="hljs-comment"># åœºæ™¯ 3: å·¥å…·æ¨¡å¼è°ƒç”¨</span>
<span class="hljs-comment"># Agent ç”Ÿæˆä»£ç : "result = pandas.DataFrame({'a': [1,2,3]})"</span>
<span class="hljs-comment"># æ‰§è¡Œå¹¶è¿”å›ç»“æœ</span>
</code></pre>
<hr/>
<h3 data-id="heading-18">äº”ã€ä½¿ç”¨æ¡ˆä¾‹</h3>
<h4 data-id="heading-19">æ¡ˆä¾‹ 1: æ•°å­¦è®¡ç®—</h4>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">Global Imports: math
Python Code:
<span class="hljs-keyword">import</span> math
<span class="hljs-comment"># è®¡ç®— PI çš„å€¼</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Ï€ = <span class="hljs-subst">{math.pi}</span>"</span>)
<span class="hljs-comment"># ä¸‰è§’å‡½æ•°è®¡ç®—</span>
angle = math.radians(<span class="hljs-number">45</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"sin(45Â°) = <span class="hljs-subst">{math.sin(angle)}</span>"</span>)
<span class="hljs-comment"># å¹³æ–¹æ ¹è®¡ç®—</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"âˆš16 = <span class="hljs-subst">{math.sqrt(<span class="hljs-number">16</span>)}</span>"</span>)
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Ï€ = 3.141592653589793\nsin(45Â°) = 0.7071067811865476\nâˆš16 = 4.0"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-20">æ¡ˆä¾‹ 2: æ•°æ®å¤„ç† (Pandas)</h4>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-bash" lang="bash">Global Imports: pandas
Python Code:
import pandas as pd

<span class="hljs-comment"># åˆ›å»º DataFrame</span>
data = {
    <span class="hljs-string">'name'</span>: [<span class="hljs-string">'Alice'</span>, <span class="hljs-string">'Bob'</span>, <span class="hljs-string">'Charlie'</span>],
    <span class="hljs-string">'age'</span>: [25, 30, 35],
    <span class="hljs-string">'city'</span>: [<span class="hljs-string">'NYC'</span>, <span class="hljs-string">'LA'</span>, <span class="hljs-string">'SF'</span>]
}
<span class="hljs-built_in">df</span> = pd.DataFrame(data)

<span class="hljs-comment"># æ•°æ®ç»Ÿè®¡</span>
<span class="hljs-built_in">print</span>(<span class="hljs-string">"=== æ•°æ®æ¦‚è§ˆ ==="</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">df</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== å¹³å‡å¹´é¾„ ==="</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">df</span>[<span class="hljs-string">'age'</span>].mean())
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== åŸå¸‚ç»Ÿè®¡ ==="</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-built_in">df</span>[<span class="hljs-string">'city'</span>].value_counts())
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"=== æ•°æ®æ¦‚è§ˆ ===\n      name  age city\n0    Alice   25  NYC\n1      Bob   30   LA\n2  Charlie   35   SF\n\n=== å¹³å‡å¹´é¾„ ===\n30.0\n\n=== åŸå¸‚ç»Ÿè®¡ ===\nNYC    1\nLA     1\nSF     1\nName: city, dtype: int64"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-21">æ¡ˆä¾‹ 3: æ•°å€¼è®¡ç®— (NumPy)</h4>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">Global Imports: numpy
Python Code:
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

<span class="hljs-comment"># åˆ›å»ºæ•°ç»„</span>
arr = np.array([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>])

<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ•°ç»„: <span class="hljs-subst">{arr}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹³å‡å€¼: <span class="hljs-subst">{np.mean(arr)}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ ‡å‡†å·®: <span class="hljs-subst">{np.std(arr)}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ€»å’Œ: <span class="hljs-subst">{np.<span class="hljs-built_in">sum</span>(arr)}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"å¹³æ–¹: <span class="hljs-subst">{np.square(arr)}</span>"</span>)
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ•°ç»„: [1 2 3 4 5]\nå¹³å‡å€¼: 3.0\næ ‡å‡†å·®: 1.4142135623730951\næ€»å’Œ: 15\nå¹³æ–¹: [ 1  4  9 16 25]"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-22">æ¡ˆä¾‹ 4: JSON æ•°æ®å¤„ç†</h4>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">Global Imports: json
Python Code:
<span class="hljs-keyword">import</span> json

<span class="hljs-comment"># JSON å­—ç¬¦ä¸²</span>
json_str = <span class="hljs-string">'{"name": "Alice", "age": 25, "skills": ["Python", "SQL"]}'</span>
data = json.loads(json_str)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"è§£æåçš„æ•°æ®:"</span>)
<span class="hljs-built_in">print</span>(data)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nå§“å: <span class="hljs-subst">{data[<span class="hljs-string">'name'</span>]}</span>"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æŠ€èƒ½: <span class="hljs-subst">{<span class="hljs-string">', '</span>.join(data[<span class="hljs-string">'skills'</span>])}</span>"</span>)

<span class="hljs-comment"># ä¿®æ”¹åè½¬å› JSON</span>
data[<span class="hljs-string">'age'</span>] = <span class="hljs-number">26</span>
new_json = json.dumps(data, indent=<span class="hljs-number">2</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nä¿®æ”¹åçš„ JSON:\n<span class="hljs-subst">{new_json}</span>"</span>)
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"è§£æåçš„æ•°æ®:\n{'name': 'Alice', 'age': 25, 'skills': ['Python', 'SQL']}\n\nå§“å: Alice\næŠ€èƒ½: Python, SQL\n\nä¿®æ”¹åçš„ JSON:\n{\n  "</span>name<span class="hljs-string">": "</span>Alice<span class="hljs-string">",\n  "</span>age<span class="hljs-string">": 26,\n  "</span>skills<span class="hljs-string">": [\n    "</span>Python<span class="hljs-string">",\n    "</span>SQL<span class="hljs-string">"\n  ]\n}"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-23">æ¡ˆä¾‹ 5: æ–‡æœ¬å¤„ç†</h4>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-python" lang="python">Global Imports: re
Python Code:
<span class="hljs-keyword">import</span> re

text = <span class="hljs-string">"æˆ‘çš„ç”µè¯æ˜¯ 138-1234-5678ï¼Œé‚®ç®±æ˜¯ example@example.com"</span>

<span class="hljs-comment"># æå–æ‰‹æœºå·</span>
phone = re.search(<span class="hljs-string">r'\d{3}-\d{4}-\d{4}'</span>, text)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"æ‰‹æœºå·: <span class="hljs-subst">{phone.group() <span class="hljs-keyword">if</span> phone <span class="hljs-keyword">else</span> <span class="hljs-string">'æœªæ‰¾åˆ°'</span>}</span>"</span>)

<span class="hljs-comment"># æå–é‚®ç®±</span>
email = re.search(<span class="hljs-string">r'[\w.]+@[\w.]+'</span>, text)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"é‚®ç®±: <span class="hljs-subst">{email.group() <span class="hljs-keyword">if</span> email <span class="hljs-keyword">else</span> <span class="hljs-string">'æœªæ‰¾åˆ°'</span>}</span>"</span>)

<span class="hljs-comment"># åˆ†å‰²æ–‡æœ¬</span>
parts = re.split(<span class="hljs-string">r'[ï¼Œ,]'</span>, text)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nåˆ†å‰²ç»“æœ:"</span>)
<span class="hljs-keyword">for</span> i, part <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(parts, <span class="hljs-number">1</span>):
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{i}</span>. <span class="hljs-subst">{part.strip()}</span>"</span>)
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æ‰‹æœºå·: 138-1234-5678\né‚®ç®±: example@example.com\n\nåˆ†å‰²ç»“æœ:\n1. æˆ‘çš„ç”µè¯æ˜¯ 138-1234-5678\n2. é‚®ç®±æ˜¯ example@example.com"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-24">æ¡ˆä¾‹ 6: æ—¥æœŸæ—¶é—´å¤„ç†</h4>
<p><strong>é…ç½®ï¼š</strong></p>
<pre><code class="hljs language-perl" lang="perl">Global Imports: datetime
Python Code:
from datetime import datetime, timedelta

<span class="hljs-comment"># å½“å‰æ—¶é—´</span>
now = datetime.now()
<span class="hljs-keyword">print</span>(f<span class="hljs-string">"å½“å‰æ—¶é—´: {now}"</span>)
<span class="hljs-keyword">print</span>(f<span class="hljs-string">"æ ¼å¼åŒ–: {now.strftime('%Y-%m-%d %H:%M:%S')}"</span>)

<span class="hljs-comment"># æ—¶é—´è®¡ç®—</span>
future = now + timedelta(days=<span class="hljs-number">7</span>)
<span class="hljs-keyword">print</span>(f<span class="hljs-string">"\nä¸€å‘¨å: {future.strftime('%Y-%m-%d')}"</span>)

<span class="hljs-comment"># æ—¶é—´å·®</span>
date1 = datetime(<span class="hljs-number">2024</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
date2 = datetime(<span class="hljs-number">2024</span>, <span class="hljs-number">12</span>, <span class="hljs-number">31</span>)
diff = date2 - date1
<span class="hljs-keyword">print</span>(f<span class="hljs-string">"2024å¹´å¤©æ•°: {diff.days}"</span>)
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"result"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"å½“å‰æ—¶é—´: 2024-01-19 15:40:23.456789\næ ¼å¼åŒ–: 2024-01-19 15:40:23\n\nä¸€å‘¨å: 2024-01-26\n\n2024å¹´å¤©æ•°: 365"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-25">å…­ã€é”™è¯¯å¤„ç†</h3>
<h4 data-id="heading-26">1. é”™è¯¯ç±»å‹</h4>



































<table><thead><tr><th>é”™è¯¯ç±»å‹</th><th>è§¦å‘æ¡ä»¶</th><th>è¿”å›æ ¼å¼</th></tr></thead><tbody><tr><td><strong>ImportError</strong></td><td>æ¨¡å—å¯¼å…¥å¤±è´¥</td><td><code>{"error": "Import Error: ..."}</code></td></tr><tr><td><strong>SyntaxError</strong></td><td>ä»£ç è¯­æ³•é”™è¯¯</td><td><code>{"error": "Syntax Error: ..."}</code></td></tr><tr><td><strong>NameError</strong></td><td>å˜é‡/å‡½æ•°æœªå®šä¹‰</td><td><code>{"error": "Error during execution: ..."}</code></td></tr><tr><td><strong>TypeError</strong></td><td>ç±»å‹é”™è¯¯</td><td><code>{"error": "Error during execution: ..."}</code></td></tr><tr><td><strong>ValueError</strong></td><td>å€¼é”™è¯¯</td><td><code>{"error": "Error during execution: ..."}</code></td></tr></tbody></table>
<h4 data-id="heading-27">2. é”™è¯¯ç¤ºä¾‹</h4>
<p><strong>ImportError ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">Global</span> <span class="hljs-keyword">Imports</span>: nonexistent_module
Python Code: print(<span class="hljs-string">"test"</span>)
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Import Error: Could not import module nonexistent_module: No module named 'nonexistent_module'"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>SyntaxError ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-lua" lang="lua">Global Imports: <span class="hljs-built_in">math</span>
Python Code: <span class="hljs-built_in">print</span>(<span class="hljs-built_in">math</span>.<span class="hljs-built_in">sqrt</span>(<span class="hljs-number">16</span>  # ç¼ºå°‘å³æ‹¬å·
</code></pre>
<p><strong>è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Syntax Error: unexpected EOF while parsing (&lt;string&gt;, line 1)"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<hr/>
<h3 data-id="heading-28">ä¸ƒã€æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-29">1. æ¨èåšæ³•</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âœ… ä½¿ç”¨ print() è¾“å‡ºç»“æœ</span>
<span class="hljs-built_in">print</span>(result)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"è®¡ç®—ç»“æœ: <span class="hljs-subst">{value}</span>"</span>)

<span class="hljs-comment"># âœ… æ˜ç¡®å¯¼å…¥æ‰€éœ€æ¨¡å—</span>
Global Imports: math,pandas,json

<span class="hljs-comment"># âœ… æ·»åŠ é”™è¯¯å¤„ç†</span>
<span class="hljs-keyword">try</span>:
    result = risky_operation()
    <span class="hljs-built_in">print</span>(result)
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"é”™è¯¯: <span class="hljs-subst">{e}</span>"</span>)
</code></pre>
<h4 data-id="heading-30">2. é¿å…çš„åšæ³•</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># âŒ ä¸è¦å°è¯•å¯¼å…¥æœªåœ¨ Global Imports ä¸­å£°æ˜çš„æ¨¡å—</span>
<span class="hljs-keyword">import</span> os  <span class="hljs-comment"># ä¼šå¤±è´¥ï¼Œå› ä¸º os ä¸åœ¨ Global Imports ä¸­</span>

<span class="hljs-comment"># âŒ ä¸è¦ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨</span>
<span class="hljs-keyword">import</span> subprocess
subprocess.run([<span class="hljs-string">'ls'</span>])  <span class="hljs-comment"># å®‰å…¨é£é™©</span>

<span class="hljs-comment"># âŒ ä¸è¦æ— é™å¾ªç¯</span>
<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    <span class="hljs-keyword">pass</span>  <span class="hljs-comment"># ä¼šå¯¼è‡´è¶…æ—¶</span>
</code></pre>
<h4 data-id="heading-31">3. æ€§èƒ½å»ºè®®</h4>

























<table><thead><tr><th>å»ºè®®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ä½¿ç”¨å‘é‡åŒ–æ“ä½œ</td><td>ä½¿ç”¨ NumPy/Pandas çš„å‘é‡åŒ–å‡½æ•°è€Œéå¾ªç¯</td></tr><tr><td>é™åˆ¶æ•°æ®é‡</td><td>é¿å…å¤„ç†è¶…å¤§æ–‡æœ¬æˆ–æ•°æ®é›†</td></tr><tr><td>é¿å…å¤æ‚è®¡ç®—</td><td>ä¿æŒä»£ç ç®€æ´é«˜æ•ˆ</td></tr><tr><td>ä½¿ç”¨åˆé€‚çš„æ•°æ®ç»“æ„</td><td>é€‰æ‹©åˆ—è¡¨/å­—å…¸/é›†åˆçš„æœ€ä¼˜ç±»å‹</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-32">å…«ã€ä¸å…¶ä»–ç»„ä»¶å¯¹æ¯”</h3>

























<table><thead><tr><th>ç»„ä»¶</th><th>ç”¨é€”</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td><strong>Python Interpreter</strong></td><td>æ‰§è¡Œ Python ä»£ç </td><td>ç®€å•ç›´æ¥ï¼Œæ”¯æŒå¸¸ç”¨åº“</td></tr><tr><td><strong>Python Script Executor</strong></td><td>æ‰§è¡Œ Python è„šæœ¬</td><td>æ”¯æŒå‚æ•°æ³¨å…¥ï¼Œæ•è· stdout/stderr</td></tr><tr><td><strong>PythonCodeStructuredTool</strong></td><td>åˆ›å»ºç»“æ„åŒ–å·¥å…·</td><td>å·²åºŸå¼ƒï¼Œä½¿ç”¨ Python Interpreter æ›¿ä»£</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-33">ä¹ã€æ€»ç»“</h3>
<h4 data-id="heading-34">æ ¸å¿ƒç‰¹æ€§</h4>
<ol>
<li><strong>å®‰å…¨æ€§</strong>: åªèƒ½ä½¿ç”¨ Global Imports ä¸­æŒ‡å®šçš„æ¨¡å—</li>
<li><strong>ç®€æ´æ€§</strong>: ç›´æ¥ç¼–å†™ Python ä»£ç ï¼Œæ— éœ€å¤æ‚é…ç½®</li>
<li><strong>çµæ´»æ€§</strong>: æ”¯æŒå¤šç§æ•°æ®å¤„ç†åœºæ™¯</li>
<li><strong>å¯æ‰©å±•æ€§</strong>: å¯ä½œä¸ºå·¥å…·è¢« Agent è°ƒç”¨</li>
</ol>
<h4 data-id="heading-35">é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>âœ… æ•°å­¦è®¡ç®—å’Œæ•°å€¼åˆ†æ</li>
<li>âœ… æ•°æ®å¤„ç†å’Œè½¬æ¢</li>
<li>âœ… æ–‡æœ¬å¤„ç†å’Œæ­£åˆ™è¡¨è¾¾å¼</li>
<li>âœ… JSON/YAML æ•°æ®è§£æ</li>
<li>âœ… æ—¥æœŸæ—¶é—´å¤„ç†</li>
<li>âœ… è‡ªå®šä¹‰é€»è¾‘å®ç°</li>
</ul>
<h4 data-id="heading-36">ä¸é€‚ç”¨åœºæ™¯</h4>
<ul>
<li>âŒ éœ€è¦å¯¼å…¥æœªé¢„å£°æ˜çš„æ¨¡å—</li>
<li>âŒ éœ€è¦æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</li>
<li>âŒ éœ€è¦ç½‘ç»œè¯·æ±‚</li>
<li>âŒ é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡</li>
<li>âŒ éœ€è¦è°ƒç”¨å¤–éƒ¨ API</li>
</ul>
<hr/>
<h3 data-id="heading-37">åã€ç›¸å…³æ–‡ä»¶</h3>
<ul>
<li>æºç : <code>langflow/components/processing/python_repl_core.py</code></li>
<li>åŸºç±»: <code>langflow/custom/custom_component/component.py</code></li>
<li>æ•°æ®ç±»å‹: <code>langflow/schema/data.py</code></li>
<li>è¾“å…¥å®šä¹‰: <code>langflow/io/</code></li>
</ul>
<pre><code class="hljs"/></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Postgresql ç³»ç»Ÿè¡¨ä½œç”¨è§£é‡Š]]></title>    <link>https://juejin.cn/post/7597058147749314570</link>    <guid>https://juejin.cn/post/7597058147749314570</guid>    <pubDate>2026-01-20T09:50:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597058147749314570" data-draft-id="7596998306381692978" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Postgresql ç³»ç»Ÿè¡¨ä½œç”¨è§£é‡Š"/> <meta itemprop="keywords" content="SQL,PostgreSQL,æ•°æ®åº“"/> <meta itemprop="datePublished" content="2026-01-20T09:50:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€é¥å¾·"/> <meta itemprop="url" content="https://juejin.cn/user/2001570267406344"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Postgresql ç³»ç»Ÿè¡¨ä½œç”¨è§£é‡Š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2001570267406344/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€é¥å¾·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:50:52.000Z" title="Tue Jan 20 2026 09:50:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>postgresql ç³»ç»Ÿè¡¨æœ‰å“ªäº›ï¼Œä½œç”¨æ˜¯ä»€ä¹ˆ</p>
<p>äº†è§£ PostgreSQL çš„ç³»ç»Ÿè¡¨ï¼ˆSystem Catalogsï¼‰æœ‰å“ªäº›ï¼Œä»¥åŠå®ƒä»¬å„è‡ªçš„æ ¸å¿ƒä½œç”¨ã€‚PostgreSQL çš„ç³»ç»Ÿè¡¨æ˜¯å­˜å‚¨æ•°æ®åº“å…ƒæ•°æ®ï¼ˆå¦‚è¡¨ã€å­—æ®µã€ç´¢å¼•ã€çº¦æŸã€ç”¨æˆ·ç­‰ä¿¡æ¯ï¼‰çš„æ ¸å¿ƒè¡¨ï¼Œæ‰€æœ‰æ•°æ®åº“å¯¹è±¡çš„å®šä¹‰éƒ½è®°å½•åœ¨è¿™é‡Œï¼Œæˆ‘ä¼šæŒ‰åŠŸèƒ½åˆ†ç±»æ¢³ç†æ ¸å¿ƒç³»ç»Ÿè¡¨ï¼Œå¹¶è¯´æ˜å®ƒä»¬çš„ä½œç”¨å’Œå¸¸ç”¨åœºæ™¯ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€æ ¸å¿ƒç³»ç»Ÿè¡¨åˆ†ç±»åŠä½œç”¨</h3>
<p>PostgreSQL çš„ç³»ç»Ÿè¡¨éƒ½ä½äºÂ <code>pg_catalog</code>Â æ¨¡å¼ä¸‹ï¼ˆå¯çœç•¥æ¨¡å¼åç›´æ¥æŸ¥è¯¢ï¼‰ï¼Œä»¥ä¸‹æ˜¯æœ€å¸¸ç”¨çš„æ ¸å¿ƒè¡¨ï¼ŒæŒ‰åŠŸèƒ½åˆ†ç»„ï¼š</p>
<h4 data-id="heading-1">1. æ•°æ®åº“ä¸æ¨¡å¼ç›¸å…³</h4>

















<table><thead><tr><th>ç³»ç»Ÿè¡¨å</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td><code>pg_database</code></td><td>å­˜å‚¨æ•°æ®åº“å®ä¾‹ä¸­æ‰€æœ‰<strong>æ•°æ®åº“</strong>çš„ä¿¡æ¯ï¼ˆå¦‚æ•°æ®åº“åã€OIDã€æ‰€æœ‰è€…ã€ç¼–ç ã€è¡¨ç©ºé—´ï¼‰</td></tr><tr><td><code>pg_namespace</code></td><td>å­˜å‚¨æ•°æ®åº“ä¸­çš„æ‰€æœ‰<strong>æ¨¡å¼ï¼ˆSchemaï¼‰</strong>Â ä¿¡æ¯ï¼ˆå¦‚æ¨¡å¼åã€OIDã€æ‰€æœ‰è€…ã€æƒé™ï¼‰</td></tr></tbody></table>
<p><strong>æŸ¥è¯¢ç¤ºä¾‹</strong>ï¼š</p>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</span>
<span class="hljs-keyword">SELECT</span> datname, datowner, encoding <span class="hljs-keyword">FROM</span> pg_database;

<span class="hljs-comment">-- æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„æ‰€æœ‰æ¨¡å¼</span>
<span class="hljs-keyword">SELECT</span> nspname, nspowner <span class="hljs-keyword">FROM</span> pg_namespace;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-2">2. è¡¨ / è§†å›¾ / ç´¢å¼•ç­‰å¯¹è±¡ç›¸å…³</h4>





















<table><thead><tr><th>ç³»ç»Ÿè¡¨å</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td><code>pg_class</code></td><td>å­˜å‚¨æ‰€æœ‰<strong>å…³ç³»å‹å¯¹è±¡</strong>ï¼ˆè¡¨ã€è§†å›¾ã€ç´¢å¼•ã€åºåˆ—ã€ç‰©åŒ–è§†å›¾ç­‰ï¼‰çš„æ ¸å¿ƒä¿¡æ¯ï¼Œæ˜¯æœ€æ ¸å¿ƒçš„ç³»ç»Ÿè¡¨ä¹‹ä¸€</td></tr><tr><td><code>pg_attribute</code></td><td>å­˜å‚¨æ‰€æœ‰<strong>å­—æ®µï¼ˆåˆ—ï¼‰</strong>Â çš„ä¿¡æ¯ï¼ˆå¦‚å­—æ®µåã€æ‰€å±è¡¨ OIDã€æ•°æ®ç±»å‹ã€æ˜¯å¦å¯ä¸ºç©ºã€é»˜è®¤å€¼ï¼‰</td></tr><tr><td><code>pg_type</code></td><td>å­˜å‚¨æ‰€æœ‰<strong>æ•°æ®ç±»å‹</strong>çš„ä¿¡æ¯ï¼ˆå†…ç½®ç±»å‹å¦‚ int/textï¼Œè‡ªå®šä¹‰ç±»å‹éƒ½åœ¨è¿™é‡Œï¼‰</td></tr></tbody></table>
<p><strong>å…³é”®è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>pg_class.relkind</code>Â å­—æ®µåŒºåˆ†å¯¹è±¡ç±»å‹ï¼š<code>r</code>= æ™®é€šè¡¨ï¼Œ<code>v</code>= è§†å›¾ï¼Œ<code>i</code>= ç´¢å¼•ï¼Œ<code>s</code>= åºåˆ—ï¼Œ<code>m</code>= ç‰©åŒ–è§†å›¾ã€‚</li>
<li><code>pg_attribute.attnum</code>Â ä¸ºå­—æ®µç¼–å·ï¼ˆ&gt;0 æ˜¯æ™®é€šå­—æ®µï¼Œ0 æ˜¯è¡¨ oidï¼Œ-1/-2 æ˜¯ç³»ç»Ÿéšè—å­—æ®µï¼‰ã€‚</li>
</ul>
<p><strong>æŸ¥è¯¢ç¤ºä¾‹</strong>ï¼š</p>
<p>sql</p>
<pre><code class="hljs language-vbnet" lang="vbnet">-- æŸ¥çœ‹ <span class="hljs-keyword">public</span> æ¨¡å¼ä¸‹çš„æ‰€æœ‰æ™®é€šè¡¨
<span class="hljs-keyword">SELECT</span> relname <span class="hljs-keyword">AS</span> table_name 
<span class="hljs-keyword">FROM</span> pg_class 
<span class="hljs-keyword">WHERE</span> relkind = <span class="hljs-comment">'r' </span>
<span class="hljs-built_in">AND</span> relnamespace = (<span class="hljs-keyword">SELECT</span> oid 
            <span class="hljs-keyword">FROM</span> pg_namespace 
            <span class="hljs-keyword">WHERE</span> nspname = <span class="hljs-comment">'public');</span>

-- æŸ¥çœ‹ users è¡¨çš„æ‰€æœ‰å­—æ®µåŠç±»å‹
<span class="hljs-keyword">SELECT</span> 
    a.attname <span class="hljs-keyword">AS</span> column_name,
    t.typname <span class="hljs-keyword">AS</span> data_type,
    a.attnotnull <span class="hljs-keyword">AS</span> is_not_null
<span class="hljs-keyword">FROM</span> pg_attribute a
<span class="hljs-keyword">JOIN</span> pg_type t <span class="hljs-keyword">ON</span> a.atttypid = t.oid
<span class="hljs-keyword">WHERE</span> a.attrelid = (<span class="hljs-keyword">SELECT</span> oid 
            <span class="hljs-keyword">FROM</span> pg_class <span class="hljs-keyword">WHERE</span> relname = <span class="hljs-comment">'users') </span>
    <span class="hljs-built_in">AND</span> a.attnum &gt; <span class="hljs-number">0</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-3">3. çº¦æŸä¸ç´¢å¼•ç›¸å…³</h4>

















<table><thead><tr><th>ç³»ç»Ÿè¡¨å</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td><code>pg_constraint</code></td><td>å­˜å‚¨æ‰€æœ‰<strong>çº¦æŸ</strong>ä¿¡æ¯ï¼ˆä¸»é”®ã€å¤–é”®ã€å”¯ä¸€çº¦æŸã€æ£€æŸ¥çº¦æŸã€é»˜è®¤å€¼çº¦æŸï¼‰</td></tr><tr><td><code>pg_index</code></td><td>å­˜å‚¨<strong>ç´¢å¼•</strong>çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ‰€å±è¡¨ã€ç´¢å¼•å­—æ®µã€æ˜¯å¦å”¯ä¸€ã€æ˜¯å¦ä¸»é”®ã€ç´¢å¼•ç±»å‹ï¼‰</td></tr></tbody></table>
<p><strong>å…³é”®è¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>pg_constraint.contype</code>Â åŒºåˆ†çº¦æŸç±»å‹ï¼š<code>p</code>= ä¸»é”®ï¼Œ<code>u</code>= å”¯ä¸€çº¦æŸï¼Œ<code>f</code>= å¤–é”®ï¼Œ<code>c</code>= æ£€æŸ¥çº¦æŸï¼Œ<code>d</code>= é»˜è®¤å€¼çº¦æŸã€‚</li>
<li><code>pg_index.indisunique</code>Â =Â <code>true</code>Â è¡¨ç¤ºå”¯ä¸€ç´¢å¼•ï¼Œ<code>indisprimary</code>Â =Â <code>true</code>Â è¡¨ç¤ºä¸»é”®ç´¢å¼•ã€‚</li>
</ul>
<p><strong>æŸ¥è¯¢ç¤ºä¾‹</strong>ï¼š</p>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹ users è¡¨çš„æ‰€æœ‰çº¦æŸ</span>
<span class="hljs-keyword">SELECT</span> conname, contype, conkey 
<span class="hljs-keyword">FROM</span> pg_constraint 
<span class="hljs-keyword">WHERE</span> conrelid <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> oid <span class="hljs-keyword">FROM</span> pg_class <span class="hljs-keyword">WHERE</span> relname <span class="hljs-operator">=</span> <span class="hljs-string">'users'</span>);

<span class="hljs-comment">-- æŸ¥çœ‹ users è¡¨çš„æ‰€æœ‰å”¯ä¸€ç´¢å¼•</span>
<span class="hljs-keyword">SELECT</span> indexrelname <span class="hljs-keyword">AS</span> index_name 
<span class="hljs-keyword">FROM</span> pg_index 
<span class="hljs-keyword">JOIN</span> pg_class t <span class="hljs-keyword">ON</span> pg_index.indrelid <span class="hljs-operator">=</span> t.oid 
<span class="hljs-keyword">WHERE</span> t.relname <span class="hljs-operator">=</span> <span class="hljs-string">'users'</span> <span class="hljs-keyword">AND</span> indisunique <span class="hljs-operator">=</span> <span class="hljs-literal">true</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-4">4. ç”¨æˆ·ä¸æƒé™ç›¸å…³</h4>





















<table><thead><tr><th>ç³»ç»Ÿè¡¨å</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td><code>pg_roles</code></td><td>å­˜å‚¨æ•°æ®åº“ä¸­æ‰€æœ‰<strong>è§’è‰² / ç”¨æˆ· / ç»„</strong>çš„ä¿¡æ¯ï¼ˆç”¨æˆ·åã€å¯†ç å“ˆå¸Œã€æƒé™ã€æ˜¯å¦è¶…çº§ç”¨æˆ·ï¼‰</td></tr><tr><td><code>pg_authid</code></td><td>ä¸Â <code>pg_roles</code>Â ç±»ä¼¼ï¼Œä½†åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ï¼‰ï¼Œä»…è¶…çº§ç”¨æˆ·å¯è®¿é—®</td></tr><tr><td><code>pg_permissions</code></td><td>å­˜å‚¨å¯¹è±¡çš„<strong>æƒé™åˆ†é…</strong>ä¿¡æ¯ï¼ˆå“ªäº›ç”¨æˆ·å¯¹å“ªäº›å¯¹è±¡æœ‰å“ªäº›æƒé™ï¼‰</td></tr></tbody></table>
<p><strong>æŸ¥è¯¢ç¤ºä¾‹</strong>ï¼š</p>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·</span>
<span class="hljs-keyword">SELECT</span> rolname, rolsuper, rolcreaterole <span class="hljs-keyword">FROM</span> pg_roles;

<span class="hljs-comment">-- æŸ¥çœ‹ users è¡¨çš„æƒé™åˆ†é…</span>
<span class="hljs-keyword">SELECT</span> grantee, privilege_type 
<span class="hljs-keyword">FROM</span> information_schema.table_privileges 
<span class="hljs-keyword">WHERE</span> table_name <span class="hljs-operator">=</span> <span class="hljs-string">'users'</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-5">5. å…¶ä»–å¸¸ç”¨ç³»ç»Ÿè¡¨</h4>

























<table><thead><tr><th>ç³»ç»Ÿè¡¨å</th><th>æ ¸å¿ƒä½œç”¨</th></tr></thead><tbody><tr><td><code>pg_tablespace</code></td><td>å­˜å‚¨è¡¨ç©ºé—´ä¿¡æ¯ï¼ˆæ•°æ®åº“ç‰©ç†å­˜å‚¨ä½ç½®ï¼‰</td></tr><tr><td><code>pg_stat_user_tables</code></td><td>å­˜å‚¨ç”¨æˆ·è¡¨çš„<strong>ç»Ÿè®¡ä¿¡æ¯</strong>ï¼ˆå¦‚è¡Œæ•°ã€è¯»å†™æ¬¡æ•°ã€æ‰«ææ¬¡æ•°ï¼Œç”¨äºæ€§èƒ½åˆ†æï¼‰</td></tr><tr><td><code>pg_locks</code></td><td>å­˜å‚¨å½“å‰æ•°æ®åº“çš„<strong>é”ä¿¡æ¯</strong>ï¼ˆæ’æŸ¥é”ç­‰å¾…ã€æ­»é”é—®é¢˜ï¼‰</td></tr><tr><td><code>pg_stat_activity</code></td><td>å­˜å‚¨å½“å‰<strong>æ•°æ®åº“è¿æ¥ / ä¼šè¯</strong>ä¿¡æ¯ï¼ˆè°åœ¨è¿æ¥ã€æ‰§è¡Œä»€ä¹ˆ SQLã€çŠ¶æ€ï¼‰</td></tr></tbody></table>
<p><strong>æŸ¥è¯¢ç¤ºä¾‹</strong>ï¼š</p>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æŸ¥çœ‹å½“å‰æ‰€æœ‰æ´»è·ƒä¼šè¯</span>
<span class="hljs-keyword">SELECT</span> usename, datname, query, state 
<span class="hljs-keyword">FROM</span> pg_stat_activity 
<span class="hljs-keyword">WHERE</span> state <span class="hljs-operator">=</span> <span class="hljs-string">'active'</span>;

<span class="hljs-comment">-- æŸ¥çœ‹è¡¨çš„è¡Œæ•°å’Œè¯»å†™ç»Ÿè®¡</span>
<span class="hljs-keyword">SELECT</span> relname, n_live_tup <span class="hljs-keyword">AS</span> row_count, seq_scan <span class="hljs-keyword">AS</span> full_scan_count 
<span class="hljs-keyword">FROM</span> pg_stat_user_tables 
<span class="hljs-keyword">WHERE</span> relname <span class="hljs-operator">=</span> <span class="hljs-string">'users'</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-6">äºŒã€ä¿¡æ¯æ¨¡å¼ï¼ˆInformation Schemaï¼‰ï¼šæ›´å‹å¥½çš„å…ƒæ•°æ®æŸ¥è¯¢æ–¹å¼</h3>
<p>é™¤äº†åŸç”Ÿç³»ç»Ÿè¡¨ï¼ŒPostgreSQL è¿˜æä¾›äº†Â <strong>Information Schema</strong>ï¼ˆä¿¡æ¯æ¨¡å¼ï¼‰ï¼Œå®ƒæ˜¯ç¬¦åˆ SQL æ ‡å‡†çš„è§†å›¾é›†åˆï¼Œå°è£…äº†åº•å±‚ç³»ç»Ÿè¡¨ï¼Œè¯­æ³•æ›´é€šç”¨ã€æ›´æ˜“è¯»ï¼Œé€‚åˆè·¨æ•°æ®åº“å…¼å®¹åœºæ™¯ã€‚</p>
<p>å¸¸ç”¨çš„ä¿¡æ¯æ¨¡å¼è§†å›¾ï¼š</p>
<ul>
<li><code>information_schema.tables</code>ï¼šæŸ¥è¯¢è¡¨ä¿¡æ¯</li>
<li><code>information_schema.columns</code>ï¼šæŸ¥è¯¢å­—æ®µä¿¡æ¯</li>
<li><code>information_schema.table_constraints</code>ï¼šæŸ¥è¯¢çº¦æŸä¿¡æ¯</li>
<li><code>information_schema.indexes</code>ï¼šæŸ¥è¯¢ç´¢å¼•ä¿¡æ¯</li>
</ul>
<p><strong>ç¤ºä¾‹</strong>ï¼š</p>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- ç”¨ä¿¡æ¯æ¨¡å¼æŸ¥è¯¢ users è¡¨çš„å­—æ®µ</span>
<span class="hljs-keyword">SELECT</span> column_name, data_type, is_nullable 
<span class="hljs-keyword">FROM</span> information_schema.columns 
<span class="hljs-keyword">WHERE</span> table_name <span class="hljs-operator">=</span> <span class="hljs-string">'users'</span> <span class="hljs-keyword">AND</span> table_schema <span class="hljs-operator">=</span> <span class="hljs-string">'public'</span>;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-7">ä¸‰ã€ç³»ç»Ÿè¡¨ä½¿ç”¨å»ºè®®</h3>
<ol>
<li><strong>æ–°æ‰‹ä¼˜å…ˆç”¨ä¿¡æ¯æ¨¡å¼</strong>ï¼šè¯­æ³•æ›´é€šç”¨ï¼Œæ— éœ€è®°å¿†ç³»ç»Ÿè¡¨çš„ OID å…³è”é€»è¾‘ï¼Œé™ä½å­¦ä¹ æˆæœ¬ã€‚</li>
<li><strong>é«˜çº§åœºæ™¯ç”¨åŸç”Ÿç³»ç»Ÿè¡¨</strong>ï¼šå¦‚éœ€è·å–æ›´åº•å±‚çš„ä¿¡æ¯ï¼ˆå¦‚ç´¢å¼•ç‰©ç†å±æ€§ã€é”è¯¦æƒ…ï¼‰ï¼ŒåŸç”Ÿç³»ç»Ÿè¡¨æ›´å…¨é¢ã€‚</li>
<li><strong>é¿å…ç›´æ¥ä¿®æ”¹ç³»ç»Ÿè¡¨</strong>ï¼šç³»ç»Ÿè¡¨ç”± PostgreSQL è‡ªåŠ¨ç»´æŠ¤ï¼Œæ‰‹åŠ¨ä¿®æ”¹å¯èƒ½å¯¼è‡´æ•°æ®åº“æŸåï¼Œç®¡ç†å¯¹è±¡åº”ä½¿ç”¨Â <code>CREATE/ALTER/DROP</code>Â å‘½ä»¤ã€‚</li>
<li><strong>å¸¸ç”¨å…ƒæ•°æ®æŸ¥è¯¢å¯å°è£…å‡½æ•°</strong>ï¼šæ¯”å¦‚å°è£… â€œæŸ¥è¯¢è¡¨çš„æ‰€æœ‰çº¦æŸâ€â€œæŸ¥è¯¢è¡¨çš„ç´¢å¼•â€ ç­‰å‡½æ•°ï¼Œç®€åŒ–æ—¥å¸¸ä½¿ç”¨ã€‚</li>
</ol>
<h3 data-id="heading-8">æ€»ç»“</h3>
<ol>
<li><strong>æ ¸å¿ƒç³»ç»Ÿè¡¨åˆ†ç±»</strong>ï¼šæ•°æ®åº“ / æ¨¡å¼ï¼ˆpg_database/pg_namespaceï¼‰ã€è¡¨ / å­—æ®µï¼ˆpg_class/pg_attributeï¼‰ã€çº¦æŸ / ç´¢å¼•ï¼ˆpg_constraint/pg_indexï¼‰ã€ç”¨æˆ· / æƒé™ï¼ˆpg_roles/pg_permissionsï¼‰ã€ç›‘æ§ / é”ï¼ˆpg_stat_activity/pg_locksï¼‰æ˜¯æœ€å¸¸ç”¨çš„å‡ ç±»ã€‚</li>
<li><strong>ä¿¡æ¯æ¨¡å¼ä¼˜åŠ¿</strong>ï¼šåŸºäºç³»ç»Ÿè¡¨å°è£…çš„æ ‡å‡†è§†å›¾ï¼Œè¯­æ³•é€šç”¨ã€æ˜“è¯»ï¼Œé€‚åˆæ–°æ‰‹å’Œè·¨æ•°æ®åº“åœºæ™¯ã€‚</li>
<li><strong>ä½¿ç”¨åŸåˆ™</strong>ï¼šç³»ç»Ÿè¡¨ç”¨äºæŸ¥è¯¢å…ƒæ•°æ®ï¼Œç¦æ­¢æ‰‹åŠ¨ä¿®æ”¹ï¼›ä¼˜å…ˆç”¨ä¿¡æ¯æ¨¡å¼ï¼Œåº•å±‚éœ€æ±‚ç”¨åŸç”Ÿç³»ç»Ÿè¡¨ã€‚</li>
</ol>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[PostgreSQL ä¸­å”¯ä¸€çº¦æŸï¼ˆUNIQUE CONSTRAINTï¼‰ å’Œå”¯ä¸€ç´¢å¼•ï¼ˆUNIQUE INDEXï¼‰ çš„æ ¸å¿ƒåŒºåˆ«]]></title>    <link>https://juejin.cn/post/7597266141911908398</link>    <guid>https://juejin.cn/post/7597266141911908398</guid>    <pubDate>2026-01-20T09:52:38.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597266141911908398" data-draft-id="7597266141911892014" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="PostgreSQL ä¸­å”¯ä¸€çº¦æŸï¼ˆUNIQUE CONSTRAINTï¼‰ å’Œå”¯ä¸€ç´¢å¼•ï¼ˆUNIQUE INDEXï¼‰ çš„æ ¸å¿ƒåŒºåˆ«"/> <meta itemprop="keywords" content="æ•°æ®åº“,PostgreSQL,SQL"/> <meta itemprop="datePublished" content="2026-01-20T09:52:38.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€é¥å¾·"/> <meta itemprop="url" content="https://juejin.cn/user/2001570267406344"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            PostgreSQL ä¸­å”¯ä¸€çº¦æŸï¼ˆUNIQUE CONSTRAINTï¼‰ å’Œå”¯ä¸€ç´¢å¼•ï¼ˆUNIQUE INDEXï¼‰ çš„æ ¸å¿ƒåŒºåˆ«
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2001570267406344/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€é¥å¾·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:52:38.000Z" title="Tue Jan 20 2026 09:52:38 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>PostgreSQL ä¸­<strong>å”¯ä¸€çº¦æŸï¼ˆUNIQUE CONSTRAINTï¼‰</strong> å’Œ<strong>å”¯ä¸€ç´¢å¼•ï¼ˆUNIQUE INDEXï¼‰</strong> çš„æ ¸å¿ƒåŒºåˆ«ã€‚</p>
<p>æƒ³å¼„æ¸…æ¥š PostgreSQL ä¸­<strong>å”¯ä¸€çº¦æŸï¼ˆUNIQUE CONSTRAINTï¼‰</strong> å’Œ<strong>å”¯ä¸€ç´¢å¼•ï¼ˆUNIQUE INDEXï¼‰</strong> çš„æ ¸å¿ƒåŒºåˆ«ï¼Œä¼šä»å®šä¹‰ã€åº•å±‚å®ç°ã€ä½¿ç”¨åœºæ™¯ç­‰ç»´åº¦æ‹†è§£ï¼Œè®©ä½ æ¸…æ™°ç†è§£äºŒè€…çš„å¼‚åŒå’Œé€‚ç”¨åœºæ™¯ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€æ ¸å¿ƒå®šä¹‰ä¸åº•å±‚å…³ç³»</h3>
<p>å…ˆæ˜ç¡®ä¸€ä¸ªå…³é”®å‰æï¼š</p>
<ul>
<li><strong>å”¯ä¸€çº¦æŸ</strong>ï¼šæ˜¯<strong>é€»è¾‘å±‚é¢</strong>çš„æ•°æ®åº“è§„åˆ™ï¼ˆçº¦æŸï¼‰ï¼Œç”¨äºä¿è¯å­—æ®µå€¼çš„å”¯ä¸€æ€§ï¼Œå±äº â€œä¸šåŠ¡è§„åˆ™â€ èŒƒç•´ã€‚</li>
<li><strong>å”¯ä¸€ç´¢å¼•</strong>ï¼šæ˜¯<strong>ç‰©ç†å±‚é¢</strong>çš„å­˜å‚¨ç»“æ„ï¼Œç”¨äºåŠ é€ŸæŸ¥è¯¢ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¼ºåˆ¶å”¯ä¸€æ€§ï¼Œå±äº â€œæ€§èƒ½ä¼˜åŒ–â€ èŒƒç•´ã€‚</li>
<li><strong>æ ¸å¿ƒå…³è”</strong>ï¼šåˆ›å»ºå”¯ä¸€çº¦æŸæ—¶ï¼ŒPostgreSQL ä¼š<strong>è‡ªåŠ¨éšå¼åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„å”¯ä¸€ç´¢å¼•</strong>æ¥å®ç°å”¯ä¸€æ€§æ ¡éªŒï¼›ä½†æ‰‹åŠ¨åˆ›å»ºçš„å”¯ä¸€ç´¢å¼•ï¼Œä¸ä¼šç”Ÿæˆä»»ä½•çº¦æŸè®°å½•ã€‚</li>
</ul>
<h3 data-id="heading-1">äºŒã€æ ¸å¿ƒåŒºåˆ«å¯¹æ¯”ï¼ˆè¡¨æ ¼æ›´æ¸…æ™°ï¼‰</h3>























































<table><thead><tr><th>ç»´åº¦</th><th>å”¯ä¸€çº¦æŸï¼ˆUNIQUE CONSTRAINTï¼‰</th><th>å”¯ä¸€ç´¢å¼•ï¼ˆUNIQUE INDEXï¼‰</th></tr></thead><tbody><tr><td><strong>æœ¬è´¨</strong></td><td>é€»è¾‘çº¦æŸï¼ˆä¸šåŠ¡è§„åˆ™ï¼‰ï¼Œä¿è¯æ•°æ®å®Œæ•´æ€§</td><td>ç‰©ç†ç´¢å¼•ï¼ˆå­˜å‚¨ç»“æ„ï¼‰ï¼ŒåŠ é€ŸæŸ¥è¯¢ + å¼ºåˆ¶å”¯ä¸€æ€§</td></tr><tr><td><strong>åˆ›å»ºæ–¹å¼</strong></td><td><code>ALTER TABLE ... ADD CONSTRAINT ... UNIQUE</code></td><td><code>CREATE UNIQUE INDEX ... ON ...</code></td></tr><tr><td><strong>ç³»ç»Ÿè¡¨è®°å½•</strong></td><td>ä¼šåœ¨ <code>pg_constraint</code> ä¸­è®°å½•ï¼ˆ<code>contype='u'</code>ï¼‰</td><td>ä»…åœ¨ <code>pg_index</code> ä¸­è®°å½•ï¼ˆ<code>indisunique=true</code>ï¼‰</td></tr><tr><td><strong>çº¦æŸå</strong></td><td>å¿…é¡»æœ‰åç§°ï¼ˆå¯è‡ªå®šä¹‰ï¼Œä¹Ÿå¯é»˜è®¤ï¼‰</td><td>æœ‰ç´¢å¼•åï¼Œä½†æ—  â€œçº¦æŸåâ€ æ¦‚å¿µ</td></tr><tr><td><strong>æ”¯æŒå‘½åçº¦æŸ</strong></td><td>æ”¯æŒï¼ˆä¾¿äºåæœŸç®¡ç†ï¼Œå¦‚åˆ é™¤ / ä¿®æ”¹ï¼‰</td><td>æ—  â€œçº¦æŸåâ€ï¼Œåªèƒ½é€šè¿‡ç´¢å¼•åç®¡ç†</td></tr><tr><td><strong>å¤–é”®å¼•ç”¨</strong></td><td>å¯è¢«å¤–é”®å¼•ç”¨ï¼ˆè™½ç„¶æå°‘ç”¨ï¼‰</td><td>ä¸èƒ½è¢«å¤–é”®å¼•ç”¨</td></tr><tr><td><strong>NULL å¤„ç†</strong></td><td>éµå¾ª PostgreSQL è§„åˆ™ï¼šå¤šä¸ª NULL ä¸å†²çª</td><td>ä¸çº¦æŸä¸€è‡´ï¼Œå¤šä¸ª NULL ä¸å†²çª</td></tr><tr><td><strong>ä¿®æ”¹ / åˆ é™¤æ–¹å¼</strong></td><td>æŒ‰çº¦æŸåæ“ä½œï¼ˆ<code>ALTER TABLE DROP CONSTRAINT</code>ï¼‰</td><td>æŒ‰ç´¢å¼•åæ“ä½œï¼ˆ<code>DROP INDEX ...</code>ï¼‰</td></tr><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>å¼ºè°ƒ â€œä¸šåŠ¡è§„åˆ™â€ çš„å”¯ä¸€æ€§ï¼ˆå¦‚ç”¨æˆ·é‚®ç®± / æ‰‹æœºå·ï¼‰</td><td>ä»…éœ€ â€œç‰©ç†å±‚é¢â€ å”¯ä¸€ + åŠ é€ŸæŸ¥è¯¢ï¼ˆæ— ä¸šåŠ¡è§„åˆ™å±æ€§ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-2">ä¸‰ã€å®æ“ç¤ºä¾‹ï¼šç›´è§‚æ„Ÿå—åŒºåˆ«</h3>
<h4 data-id="heading-3">1. åˆ›å»ºå”¯ä¸€çº¦æŸï¼ˆè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€ç´¢å¼•ï¼‰</h4>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºå”¯ä¸€çº¦æŸ</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> users <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">CONSTRAINT</span> uk_users_email <span class="hljs-keyword">UNIQUE</span> (email);

<span class="hljs-comment">-- æŸ¥çœ‹çº¦æŸï¼ˆæœ‰è®°å½•ï¼‰</span>
<span class="hljs-keyword">SELECT</span> conname <span class="hljs-keyword">FROM</span> pg_constraint <span class="hljs-keyword">WHERE</span> conname <span class="hljs-operator">=</span> <span class="hljs-string">'uk_users_email'</span>;
<span class="hljs-comment">-- è¾“å‡ºï¼šuk_users_email</span>

<span class="hljs-comment">-- æŸ¥çœ‹ç´¢å¼•ï¼ˆè‡ªåŠ¨ç”ŸæˆåŒåç´¢å¼•ï¼‰</span>
<span class="hljs-keyword">SELECT</span> indexrelname <span class="hljs-keyword">FROM</span> pg_index 
<span class="hljs-keyword">JOIN</span> pg_class t <span class="hljs-keyword">ON</span> pg_index.indrelid <span class="hljs-operator">=</span> t.oid 
<span class="hljs-keyword">WHERE</span> t.relname <span class="hljs-operator">=</span> <span class="hljs-string">'users'</span> <span class="hljs-keyword">AND</span> indexrelname <span class="hljs-operator">=</span> <span class="hljs-string">'uk_users_email'</span>;
<span class="hljs-comment">-- è¾“å‡ºï¼šuk_users_email</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-4">2. åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼ˆæ— çº¦æŸè®°å½•ï¼‰</h4>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ›å»ºå”¯ä¸€ç´¢å¼•</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX idx_users_phone <span class="hljs-keyword">ON</span> users (phone);

<span class="hljs-comment">-- æŸ¥çœ‹çº¦æŸï¼ˆæ— è®°å½•ï¼‰</span>
<span class="hljs-keyword">SELECT</span> conname <span class="hljs-keyword">FROM</span> pg_constraint <span class="hljs-keyword">WHERE</span> conname <span class="hljs-operator">=</span> <span class="hljs-string">'idx_users_phone'</span>;
<span class="hljs-comment">-- è¾“å‡ºï¼šç©º</span>

<span class="hljs-comment">-- æŸ¥çœ‹ç´¢å¼•ï¼ˆæœ‰è®°å½•ï¼‰</span>
<span class="hljs-keyword">SELECT</span> indexrelname <span class="hljs-keyword">FROM</span> pg_index 
<span class="hljs-keyword">JOIN</span> pg_class t <span class="hljs-keyword">ON</span> pg_index.indrelid <span class="hljs-operator">=</span> t.oid 
<span class="hljs-keyword">WHERE</span> t.relname <span class="hljs-operator">=</span> <span class="hljs-string">'users'</span> <span class="hljs-keyword">AND</span> indexrelname <span class="hljs-operator">=</span> <span class="hljs-string">'idx_users_phone'</span>;
<span class="hljs-comment">-- è¾“å‡ºï¼šidx_users_phone</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-5">3. åˆ é™¤æ–¹å¼å·®å¼‚</h4>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åˆ é™¤å”¯ä¸€çº¦æŸï¼ˆä¼šè‡ªåŠ¨åˆ é™¤å¯¹åº”çš„ç´¢å¼•ï¼‰</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> users <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">CONSTRAINT</span> uk_users_email;

<span class="hljs-comment">-- åˆ é™¤å”¯ä¸€ç´¢å¼•ï¼ˆä»…åˆ é™¤ç´¢å¼•ï¼Œæ— çº¦æŸå¯åˆ ï¼‰</span>
<span class="hljs-keyword">DROP</span> INDEX idx_users_phone;
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-6">å››ã€ä½¿ç”¨å»ºè®®ï¼ˆæ–°æ‰‹å¿…çœ‹ï¼‰</h3>
<ol>
<li>
<p><strong>ä¼˜å…ˆç”¨å”¯ä¸€çº¦æŸ</strong>ï¼šå¦‚æœä½ çš„ç›®æ ‡æ˜¯<strong>ä¿è¯ä¸šåŠ¡æ•°æ®çš„å”¯ä¸€æ€§</strong>ï¼ˆå¦‚ç”¨æˆ·é‚®ç®±ã€æ‰‹æœºå·ã€è®¢å•å·ï¼‰ï¼Œä¼˜å…ˆåˆ›å»ºå”¯ä¸€çº¦æŸ â€”â€” å®ƒæ›´ç¬¦åˆ â€œæ•°æ®å®Œæ•´æ€§è§„åˆ™â€ çš„è®¾è®¡ç†å¿µï¼Œä¸”ä¾¿äºåæœŸé€šè¿‡çº¦æŸåç®¡ç†ã€‚</p>
</li>
<li>
<p><strong>ä»…åœ¨ç‰¹æ®Šåœºæ™¯ç”¨å”¯ä¸€ç´¢å¼•</strong>ï¼šæ¯”å¦‚éœ€è¦ä¸ºè¡¨è¾¾å¼ / å‡½æ•°åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼ˆçº¦æŸä¸æ”¯æŒï¼‰ï¼Œæˆ–ä»…éœ€ä¸´æ—¶ä¿è¯å”¯ä¸€æ€§ä¸”æ— éœ€è®°å½•çº¦æŸè§„åˆ™æ—¶ã€‚ç¤ºä¾‹ï¼ˆè¡¨è¾¾å¼å”¯ä¸€ç´¢å¼•ï¼‰ï¼š</p>
<p>sql</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- çº¦æŸä¸æ”¯æŒè¿™ç§åœºæ™¯ï¼Œåªèƒ½ç”¨å”¯ä¸€ç´¢å¼•</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> INDEX idx_users_lower_email <span class="hljs-keyword">ON</span> users (<span class="hljs-built_in">lower</span>(email));
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
</li>
</ol>
<h3 data-id="heading-7">æ€»ç»“</h3>
<ol>
<li><strong>åº•å±‚å…³è”</strong>ï¼šå”¯ä¸€çº¦æŸä¾èµ–å”¯ä¸€ç´¢å¼•å®ç°ï¼Œåˆ›å»ºçº¦æŸä¼šè‡ªåŠ¨ç”Ÿæˆç´¢å¼•ï¼›ä½†åˆ›å»ºç´¢å¼•ä¸ä¼šç”Ÿæˆçº¦æŸã€‚</li>
<li><strong>æ ¸å¿ƒåŒºåˆ«</strong>ï¼šçº¦æŸæ˜¯ â€œé€»è¾‘è§„åˆ™â€ï¼ˆæœ‰çº¦æŸåã€å¯è¢«å¤–é”®å¼•ç”¨ã€è®°å½•åœ¨çº¦æŸè¡¨ï¼‰ï¼Œç´¢å¼•æ˜¯ â€œç‰©ç†ç»“æ„â€ï¼ˆä»…åŠ é€ŸæŸ¥è¯¢ + å¼ºåˆ¶å”¯ä¸€ã€æ— çº¦æŸè®°å½•ï¼‰ã€‚</li>
<li><strong>ä½¿ç”¨åŸåˆ™</strong>ï¼šä¸šåŠ¡å±‚é¢çš„å”¯ä¸€æ€§ç”¨<strong>å”¯ä¸€çº¦æŸ</strong>ï¼Œçº¯æ€§èƒ½ / è¡¨è¾¾å¼åœºæ™¯çš„å”¯ä¸€æ€§ç”¨<strong>å”¯ä¸€ç´¢å¼•</strong>ã€‚</li>
</ol>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼ŒJava 8-Lambda å°ç»“]]></title>    <link>https://juejin.cn/post/7596998306381742130</link>    <guid>https://juejin.cn/post/7596998306381742130</guid>    <pubDate>2026-01-20T09:56:21.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596998306381742130" data-draft-id="7597058147749363722" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼ŒJava 8-Lambda å°ç»“"/> <meta itemprop="keywords" content="Java,è®¾è®¡æ¨¡å¼"/> <meta itemprop="datePublished" content="2026-01-20T09:56:21.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€é¥å¾·"/> <meta itemprop="url" content="https://juejin.cn/user/2001570267406344"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼ŒJava 8-Lambda å°ç»“
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2001570267406344/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€é¥å¾·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:56:21.000Z" title="Tue Jan 20 2026 09:56:21 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹</p>
<p>ä½ æƒ³äº†è§£å¦‚ä½•åœ¨ Java ä¸­åº”ç”¨å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„è¿›é˜¶æ–¹å‘ï¼ŒJava ä» 8 ç‰ˆæœ¬å¼€å§‹å¼•å…¥äº† Lambda è¡¨è¾¾å¼ã€Stream API ç­‰æ ¸å¿ƒç‰¹æ€§ï¼Œè®©å‡½æ•°å¼ç¼–ç¨‹å˜å¾—éå¸¸ä¾¿æ·ã€‚</p>
<h3 data-id="heading-0">ä¸€ã€å‡½æ•°å¼ç¼–ç¨‹æ ¸å¿ƒæ€æƒ³ï¼ˆJava è§†è§’ï¼‰</h3>
<p>å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ˜¯<strong>å°†å‡½æ•°ä½œä¸ºä¸€ç­‰å…¬æ°‘</strong>ï¼Œå¼ºè°ƒï¼š</p>
<ol>
<li>æ— å‰¯ä½œç”¨ï¼ˆå‡½æ•°æ‰§è¡Œä¸ä¿®æ”¹å¤–éƒ¨çŠ¶æ€ï¼‰</li>
<li>ä¸å¯å˜æ•°æ®ï¼ˆé¿å…ä¿®æ”¹å·²æœ‰æ•°æ®ï¼Œè€Œæ˜¯ç”Ÿæˆæ–°æ•°æ®ï¼‰</li>
<li>å£°æ˜å¼ç¼–ç¨‹ï¼ˆå…³æ³¨ â€œåšä»€ä¹ˆâ€ è€Œé â€œæ€ä¹ˆåšâ€ï¼‰</li>
<li>çº¯å‡½æ•°ï¼ˆç›¸åŒè¾“å…¥æ°¸è¿œè¿”å›ç›¸åŒè¾“å‡ºï¼‰</li>
</ol>
<h3 data-id="heading-1">äºŒã€Java ä¸­å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒå·¥å…·</h3>
<h4 data-id="heading-2">1. å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰</h4>
<p>Java ä¸­é€šè¿‡<strong>å‡½æ•°å¼æ¥å£</strong>ï¼ˆåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼‰æ¥è¡¨ç¤º â€œå‡½æ•°â€ï¼ŒJDK å†…ç½®äº†å¸¸ç”¨çš„å‡½æ•°å¼æ¥å£ï¼š</p>
<ul>
<li><code>Consumer&lt;T&gt;</code>ï¼šæ¶ˆè´¹å‹ï¼ˆè¾“å…¥ Tï¼Œæ— è¿”å›å€¼ï¼‰</li>
<li><code>Supplier&lt;T&gt;</code>ï¼šä¾›ç»™å‹ï¼ˆæ— è¾“å…¥ï¼Œè¿”å› Tï¼‰</li>
<li><code>Function&lt;T, R&gt;</code>ï¼šå‡½æ•°å‹ï¼ˆè¾“å…¥ Tï¼Œè¿”å› Rï¼‰</li>
<li><code>Predicate&lt;T&gt;</code>ï¼šæ–­è¨€å‹ï¼ˆè¾“å…¥ Tï¼Œè¿”å› booleanï¼‰</li>
</ul>
<h4 data-id="heading-3">2. Lambda è¡¨è¾¾å¼ï¼ˆå‡½æ•°çš„ç®€æ´è¡¨ç¤ºï¼‰</h4>
<p>Lambda æ˜¯å‡½æ•°å¼æ¥å£çš„ â€œè¯­æ³•ç³–â€ï¼Œç”¨æ¥ç®€åŒ–åŒ¿åå†…éƒ¨ç±»çš„å†™æ³•ã€‚</p>
<h4 data-id="heading-4">3. Stream APIï¼ˆå‡½æ•°å¼æ•°æ®å¤„ç†ï¼‰</h4>
<p>Stream æ˜¯å¯¹é›†åˆæ•°æ®çš„å‡½æ•°å¼æ“ä½œæµï¼Œæ”¯æŒè¿‡æ»¤ã€æ˜ å°„ã€èšåˆç­‰æ“ä½œï¼Œå…¨ç¨‹æ— å‰¯ä½œç”¨ã€‚</p>
<h3 data-id="heading-5">ä¸‰ã€Java å‡½æ•°å¼ç¼–ç¨‹å®æˆ˜ç¤ºä¾‹</h3>
<h4 data-id="heading-6">ç¤ºä¾‹ 1ï¼šåŸºç¡€ Lambda + å‡½æ•°å¼æ¥å£</h4>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.function.Consumer;
<span class="hljs-keyword">import</span> java.util.function.Function;
<span class="hljs-keyword">import</span> java.util.function.Predicate;
<span class="hljs-keyword">import</span> java.util.function.Supplier;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FunctionalBasic</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// 1. Supplierï¼šä¾›ç»™å‹ï¼ˆæ— å‚è¿”å›ï¼‰</span>
        Supplier&lt;String&gt; helloSupplier = () -&gt; <span class="hljs-string">"Hello, å‡½æ•°å¼ç¼–ç¨‹"</span>;
        System.out.println(helloSupplier.get()); <span class="hljs-comment">// è¾“å‡ºï¼šHello, å‡½æ•°å¼ç¼–ç¨‹</span>

        <span class="hljs-comment">// 2. Consumerï¼šæ¶ˆè´¹å‹ï¼ˆæœ‰å‚æ— è¿”å›ï¼‰</span>
        Consumer&lt;String&gt; printConsumer = (msg) -&gt; System.out.println(<span class="hljs-string">"æ¶ˆè´¹ï¼š"</span> + msg);
        printConsumer.accept(helloSupplier.get()); <span class="hljs-comment">// è¾“å‡ºï¼šæ¶ˆè´¹ï¼šHello, å‡½æ•°å¼ç¼–ç¨‹</span>

        <span class="hljs-comment">// 3. Functionï¼šå‡½æ•°å‹ï¼ˆå…¥å‚â†’å‡ºå‚ï¼‰</span>
        Function&lt;String, Integer&gt; lengthFunction = (str) -&gt; str.length();
        <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> lengthFunction.apply(<span class="hljs-string">"Java Functional"</span>);
        System.out.println(<span class="hljs-string">"å­—ç¬¦ä¸²é•¿åº¦ï¼š"</span> + length); <span class="hljs-comment">// è¾“å‡ºï¼š16</span>

        <span class="hljs-comment">// 4. Predicateï¼šæ–­è¨€å‹ï¼ˆå…¥å‚â†’å¸ƒå°”ï¼‰</span>
        Predicate&lt;Integer&gt; isEven = (num) -&gt; num % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;
        System.out.println(<span class="hljs-string">"æ˜¯å¦å¶æ•°ï¼š"</span> + isEven.test(length)); <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-7">ç¤ºä¾‹ 2ï¼šStream API å®æˆ˜ï¼ˆæ ¸å¿ƒåœºæ™¯ï¼‰</h4>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ï¼Œéœ€è¦å®Œæˆï¼šè¿‡æ»¤æˆå¹´ç”¨æˆ· â†’ æå–ç”¨æˆ·å â†’ æŒ‰å­—æ¯æ’åº â†’ è¾“å‡ºã€‚</p>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.util.Arrays;
<span class="hljs-keyword">import</span> java.util.List;
<span class="hljs-keyword">import</span> java.util.stream.Collectors;

<span class="hljs-comment">// å®šä¹‰ç”¨æˆ·ç±»</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">User</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
    }

    <span class="hljs-comment">// getter</span>
    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> name; }
    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> age; }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StreamExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        List&lt;User&gt; users = Arrays.asList(
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">25</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"Bob"</span>, <span class="hljs-number">17</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"Charlie"</span>, <span class="hljs-number">30</span>),
                <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>(<span class="hljs-string">"David"</span>, <span class="hljs-number">19</span>)
        );

        <span class="hljs-comment">// å‡½æ•°å¼å†™æ³•ï¼ˆå£°æ˜å¼ï¼Œå…³æ³¨â€œåšä»€ä¹ˆâ€ï¼‰</span>
        List&lt;String&gt; adultUserNames = users.stream()
                .filter(user -&gt; user.getAge() &gt;= <span class="hljs-number">18</span>) <span class="hljs-comment">// è¿‡æ»¤æˆå¹´ç”¨æˆ·ï¼ˆPredicateï¼‰</span>
                .map(User::getName) <span class="hljs-comment">// æå–ç”¨æˆ·åï¼ˆFunctionï¼Œæ–¹æ³•å¼•ç”¨ç®€åŒ–ï¼‰</span>
                .sorted() <span class="hljs-comment">// æ’åº</span>
                .collect(Collectors.toList()); <span class="hljs-comment">// æ”¶é›†ç»“æœ</span>

        <span class="hljs-comment">// è¾“å‡ºç»“æœï¼š[Alice, Charlie, David]</span>
        System.out.println(adultUserNames);

        <span class="hljs-comment">// å¯¹æ¯”ä¼ ç»Ÿå‘½ä»¤å¼å†™æ³•ï¼ˆå…³æ³¨â€œæ€ä¹ˆåšâ€ï¼Œä»£ç æ›´ç¹çï¼‰</span>
        <span class="hljs-comment">/*
        List&lt;String&gt; result = new ArrayList&lt;&gt;();
        for (User user : users) {
            if (user.getAge() &gt;= 18) {
                result.add(user.getName());
            }
        }
        Collections.sort(result);
        System.out.println(result);
        */</span>
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h4 data-id="heading-8">ç¤ºä¾‹ 3ï¼šè‡ªå®šä¹‰å‡½æ•°å¼æ¥å£</h4>
<p>å¦‚æœ JDK å†…ç½®çš„æ¥å£ä¸æ»¡è¶³éœ€æ±‚ï¼Œå¯ä»¥è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£ï¼ˆç”¨ <code>@FunctionalInterface</code> æ³¨è§£æ ‡è®°ï¼‰ï¼š</p>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-csharp" lang="csharp">@FunctionalInterface <span class="hljs-comment">// æ³¨è§£å¯é€‰ï¼Œä½†æ¨èåŠ ï¼ˆç¼–è¯‘å™¨ä¼šæ£€æŸ¥æ˜¯å¦ç¬¦åˆå‡½æ•°å¼æ¥å£è§„èŒƒï¼‰</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title">Calculator</span>&lt;<span class="hljs-title">T</span>&gt; {
    <span class="hljs-function">T <span class="hljs-title">calculate</span>(<span class="hljs-params">T a, T b</span>)</span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CustomFunctionalInterface</span> {
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span>(<span class="hljs-params">String[] args</span>)</span> {
        <span class="hljs-comment">// å®ç°åŠ æ³•</span>
        Calculator&lt;Integer&gt; <span class="hljs-keyword">add</span> = (a, b) -&gt; a + b;
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"åŠ æ³•ï¼š"</span> + <span class="hljs-keyword">add</span>.calculate(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)); <span class="hljs-comment">// 30</span>

        <span class="hljs-comment">// å®ç°ä¹˜æ³•</span>
        Calculator&lt;Integer&gt; multiply = (a, b) -&gt; a * b;
        System.<span class="hljs-keyword">out</span>.println(<span class="hljs-string">"ä¹˜æ³•ï¼š"</span> + multiply.calculate(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>)); <span class="hljs-comment">// 200</span>
    }
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<h3 data-id="heading-9">å››ã€Java å‡½æ•°å¼ç¼–ç¨‹çš„æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>ä¼˜å…ˆä½¿ç”¨ä¸å¯å˜é›†åˆ</strong>ï¼šç”¨ <code>Collections.unmodifiableList()</code> æˆ– Guava çš„ä¸å¯å˜é›†åˆï¼Œé¿å…å¤–éƒ¨ä¿®æ”¹ã€‚</li>
<li><strong>é¿å…åœ¨ Lambda ä¸­ä¿®æ”¹å¤–éƒ¨å˜é‡</strong>ï¼šLambda ä¸­å¼•ç”¨çš„å¤–éƒ¨å˜é‡å¿…é¡»æ˜¯ final æˆ– Effectively finalï¼ˆå®é™…ä¸å¯å˜ï¼‰ã€‚</li>
<li><strong>ä½¿ç”¨æ–¹æ³•å¼•ç”¨ç®€åŒ–ä»£ç </strong>ï¼šå¦‚ <code>User::getName</code> æ¯” <code>user -&gt; user.getName()</code> æ›´ç®€æ´ã€‚</li>
<li><strong>Stream å»¶è¿Ÿæ‰§è¡Œ</strong>ï¼šStream çš„ä¸­é—´æ“ä½œï¼ˆfilterã€mapï¼‰æ˜¯å»¶è¿Ÿçš„ï¼Œåªæœ‰ç»ˆç«¯æ“ä½œï¼ˆcollectã€forEachï¼‰æ‰ä¼šè§¦å‘æ‰§è¡Œã€‚</li>
<li><strong>é¿å…è¿‡åº¦ä½¿ç”¨ Stream</strong>ï¼šç®€å•çš„å¾ªç¯ï¼ˆå¦‚å•æ­¥éå†ï¼‰ç”¨ä¼ ç»Ÿ for å¾ªç¯æ›´æ˜“è¯»ï¼Œå¤æ‚æ•°æ®å¤„ç†ç”¨ Stream æ›´ä¼˜é›…ã€‚</li>
</ol>
<h3 data-id="heading-10">æ€»ç»“</h3>
<ol>
<li>Java å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒæ˜¯<strong>å‡½æ•°å¼æ¥å£ + Lambda è¡¨è¾¾å¼ + Stream API</strong>ï¼Œä» Java 8 å¼€å§‹æ”¯æŒã€‚</li>
<li>å‡½æ•°å¼ç¼–ç¨‹å¼ºè°ƒ<strong>å£°æ˜å¼ã€æ— å‰¯ä½œç”¨ã€ä¸å¯å˜</strong>ï¼Œç›¸æ¯”ä¼ ç»Ÿå‘½ä»¤å¼ç¼–ç¨‹ï¼Œä»£ç æ›´ç®€æ´ã€æ˜“ç»´æŠ¤ï¼ˆå°¤å…¶é€‚åˆæ•°æ®å¤„ç†ï¼‰ã€‚</li>
<li>æ ¸å¿ƒåœºæ™¯ï¼šé›†åˆæ•°æ®è¿‡æ»¤ / æ˜ å°„ / èšåˆï¼ˆStream APIï¼‰ã€å›è°ƒå‡½æ•°ï¼ˆLambdaï¼‰ã€ç®€åŒ–åŒ¿åå†…éƒ¨ç±»ã€‚</li>
</ol>
<p>å¦‚æœéœ€è¦é’ˆå¯¹æŸä¸ªå…·ä½“åœºæ™¯ï¼ˆæ¯”å¦‚å¹¶è¡Œæµã€Optional ç©ºå€¼å¤„ç†ã€CompletableFuture å¼‚æ­¥ç¼–ç¨‹ï¼‰æ·±å…¥è®²è§£ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘ã€‚</p>
<h3 data-id="heading-11">å¦‚ä½•åœ¨ Java ä¸­ä½¿ç”¨ Stream API è¿›è¡Œå¤æ‚çš„æ•°æ®å¤„ç†ï¼Ÿ</h3>
<p>ä½ æƒ³æŒæ¡åœ¨ Java ä¸­ä½¿ç”¨ Stream API å¤„ç†<strong>å¤æ‚æ•°æ®åœºæ™¯</strong>çš„æ–¹æ³•ï¼Œè¿™æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„æ ¸å¿ƒåº”ç”¨åœºæ™¯ã€‚Stream API ä¸ä»…èƒ½å¤„ç†ç®€å•çš„è¿‡æ»¤ / æ˜ å°„ï¼Œè¿˜èƒ½åº”å¯¹åˆ†ç»„ã€èšåˆã€åµŒå¥—é›†åˆå¤„ç†ã€å¤šæ¡ä»¶ç­›é€‰ç­‰å¤æ‚åœºæ™¯ï¼Œæˆ‘ä¼šç»“åˆå®æˆ˜æ¡ˆä¾‹å¸¦ä½ ç³»ç»ŸæŒæ¡ã€‚</p>
<h3 data-id="heading-12">ä¸€ã€å¤æ‚æ•°æ®å¤„ç†çš„æ ¸å¿ƒèƒ½åŠ›ï¼ˆStream å…³é”®æ“ä½œï¼‰</h3>
<p>å…ˆæ˜ç¡® Stream å¤„ç†å¤æ‚æ•°æ®çš„æ ¸å¿ƒæ“ä½œåˆ†ç±»ï¼Œåç»­æ¡ˆä¾‹ä¼šåŸºäºè¿™äº›æ“ä½œç»„åˆï¼š</p>



































<table><thead><tr><th>æ“ä½œç±»å‹</th><th>æ ¸å¿ƒæ–¹æ³•</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>ä¸­é—´æ“ä½œ</td><td>filter/map/flatMap/sorted/distinct</td><td>æ•°æ®ç­›é€‰ã€è½¬æ¢ã€æ‰å¹³åŒ–ã€æ’åºã€å»é‡</td></tr><tr><td>èšåˆæ“ä½œ</td><td>reduce/collect</td><td>æ±‡æ€»ã€å½’çº¦ã€æ”¶é›†ï¼ˆæ ¸å¿ƒï¼Œå¤„ç†å¤æ‚åœºæ™¯ï¼‰</td></tr><tr><td>åˆ†ç»„ / åˆ†åŒº</td><td>Collectors.groupingBy/partitioningBy</td><td>æŒ‰æ¡ä»¶åˆ†ç»„ / äºŒåˆ†åˆ†åŒº</td></tr><tr><td>ç»Ÿè®¡èšåˆ</td><td>Collectors.summingInt/averagingLong</td><td>æ±‚å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼ / æœ€å°å€¼ç­‰ç»Ÿè®¡è®¡ç®—</td></tr><tr><td>åµŒå¥—å¤„ç†</td><td>flatMap</td><td>å¤„ç†åµŒå¥—é›†åˆï¼ˆå¦‚ List&lt;List&gt;ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-13">äºŒã€å¤æ‚åœºæ™¯å®æˆ˜æ¡ˆä¾‹</h3>
<p>ä»¥ä¸‹æ¡ˆä¾‹åŸºäºä¸€ä¸ª<strong>è®¢å•ç³»ç»Ÿ</strong>çš„çœŸå®åœºæ™¯ï¼ˆåŒ…å«è®¢å•ã€è®¢å•é¡¹ã€ç”¨æˆ·ç»´åº¦ï¼‰ï¼Œå…ˆå®šä¹‰åŸºç¡€æ•°æ®æ¨¡å‹ï¼š</p>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;
<span class="hljs-keyword">import</span> lombok.Data;
<span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.time.LocalDateTime;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-comment">// ç”¨æˆ·æ¨¡å‹</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Long</span> userId;       <span class="hljs-comment">// ç”¨æˆ·ID</span>
    <span class="hljs-keyword">private</span> String userName;   <span class="hljs-comment">// ç”¨æˆ·å</span>
    <span class="hljs-keyword">private</span> String city;       <span class="hljs-comment">// æ‰€åœ¨åŸå¸‚</span>
}

<span class="hljs-comment">// è®¢å•é¡¹æ¨¡å‹</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderItem</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Long</span> productId;    <span class="hljs-comment">// å•†å“ID</span>
    <span class="hljs-keyword">private</span> String productName;<span class="hljs-comment">// å•†å“åç§°</span>
    <span class="hljs-keyword">private</span> Integer quantity;  <span class="hljs-comment">// æ•°é‡</span>
    <span class="hljs-keyword">private</span> BigDecimal price;  <span class="hljs-comment">// å•ä»·</span>
}

<span class="hljs-comment">// è®¢å•æ¨¡å‹</span>
<span class="hljs-meta">@Data</span>
<span class="hljs-meta">@AllArgsConstructor</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Long</span> orderId;      <span class="hljs-comment">// è®¢å•ID</span>
    <span class="hljs-keyword">private</span> <span class="hljs-built_in">Long</span> userId;       <span class="hljs-comment">// å…³è”ç”¨æˆ·ID</span>
    <span class="hljs-keyword">private</span> LocalDateTime createTime; <span class="hljs-comment">// åˆ›å»ºæ—¶é—´</span>
    <span class="hljs-keyword">private</span> List&lt;OrderItem&gt; items;    <span class="hljs-comment">// è®¢å•é¡¹åˆ—è¡¨</span>
    <span class="hljs-keyword">private</span> BigDecimal totalAmount;   <span class="hljs-comment">// è®¢å•æ€»é‡‘é¢</span>
}
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p>å‡†å¤‡æµ‹è¯•æ•°æ®ï¼ˆæ¨¡æ‹Ÿä¸šåŠ¡åœºæ™¯çš„å¤æ‚æ•°æ®é›†ï¼‰ï¼š</p>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-ini" lang="ini">// åˆå§‹åŒ–æµ‹è¯•æ•°æ®
User <span class="hljs-attr">user1</span> = new User(<span class="hljs-number">1</span>L, <span class="hljs-string">"å¼ ä¸‰"</span>, <span class="hljs-string">"åŒ—äº¬"</span>)<span class="hljs-comment">;</span>
User <span class="hljs-attr">user2</span> = new User(<span class="hljs-number">2</span>L, <span class="hljs-string">"æå››"</span>, <span class="hljs-string">"ä¸Šæµ·"</span>)<span class="hljs-comment">;</span>
User <span class="hljs-attr">user3</span> = new User(<span class="hljs-number">3</span>L, <span class="hljs-string">"ç‹äº”"</span>, <span class="hljs-string">"åŒ—äº¬"</span>)<span class="hljs-comment">;</span>

OrderItem <span class="hljs-attr">item1</span> = new OrderItem(<span class="hljs-number">101</span>L, <span class="hljs-string">"æ‰‹æœº"</span>, <span class="hljs-number">1</span>, new BigDecimal(<span class="hljs-string">"5999"</span>))<span class="hljs-comment">;</span>
OrderItem <span class="hljs-attr">item2</span> = new OrderItem(<span class="hljs-number">102</span>L, <span class="hljs-string">"è€³æœº"</span>, <span class="hljs-number">2</span>, new BigDecimal(<span class="hljs-string">"299"</span>))<span class="hljs-comment">;</span>
OrderItem <span class="hljs-attr">item3</span> = new OrderItem(<span class="hljs-number">201</span>L, <span class="hljs-string">"ç”µè„‘"</span>, <span class="hljs-number">1</span>, new BigDecimal(<span class="hljs-string">"8999"</span>))<span class="hljs-comment">;</span>
OrderItem <span class="hljs-attr">item4</span> = new OrderItem(<span class="hljs-number">202</span>L, <span class="hljs-string">"é¼ æ ‡"</span>, <span class="hljs-number">1</span>, new BigDecimal(<span class="hljs-string">"99"</span>))<span class="hljs-comment">;</span>
OrderItem <span class="hljs-attr">item5</span> = new OrderItem(<span class="hljs-number">301</span>L, <span class="hljs-string">"é”®ç›˜"</span>, <span class="hljs-number">2</span>, new BigDecimal(<span class="hljs-string">"199"</span>))<span class="hljs-comment">;</span>

Order <span class="hljs-attr">order1</span> = new Order(<span class="hljs-number">1001</span>L, <span class="hljs-number">1</span>L, 
  LocalDateTime.of(2026, 1, 10, 10, 0),
  List.of(item1, item2), new BigDecimal("6597"))<span class="hljs-comment">;</span>
Order <span class="hljs-attr">order2</span> = new Order(<span class="hljs-number">1002</span>L, <span class="hljs-number">1</span>L, 
  LocalDateTime.of(2026, 1, 15, 14, 0), 
  List.of(item3), new BigDecimal("8999"))<span class="hljs-comment">;</span>
Order <span class="hljs-attr">order3</span> = new Order(<span class="hljs-number">1003</span>L, <span class="hljs-number">2</span>L, 
  LocalDateTime.of(2026, 1, 12, 9, 0), 
  List.of(item4, item5), new BigDecimal("497"))<span class="hljs-comment">;</span>
Order <span class="hljs-attr">order4</span> = new Order(<span class="hljs-number">1004</span>L, <span class="hljs-number">3</span>L, 
  LocalDateTime.of(2026, 1, 20, 16, 0), 
  List.of(item1), new BigDecimal("5999"))<span class="hljs-comment">;</span>

List&lt;User&gt; <span class="hljs-attr">userList</span> = List.of(user1, user2, user3)<span class="hljs-comment">;</span>
List&lt;Order&gt; <span class="hljs-attr">orderList</span> = List.of(order1, order2, order3, order4)<span class="hljs-comment">;</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<hr/>
<h4 data-id="heading-14">åœºæ™¯ 1ï¼šå¤šæ¡ä»¶ç­›é€‰ + æ•°æ®è½¬æ¢ï¼ˆåŸºç¡€å¤æ‚ç­›é€‰ï¼‰</h4>
<p><strong>éœ€æ±‚</strong>ï¼šç­›é€‰å‡º 2026 å¹´ 1 æœˆ 10 æ—¥ååˆ›å»ºã€æ€»é‡‘é¢ &gt; 5000 ä¸”æ‰€å±ç”¨æˆ·åœ¨åŒ—äº¬çš„è®¢å•ï¼Œæœ€ç»ˆåªä¿ç•™è®¢å• ID å’Œç”¨æˆ·åã€‚</p>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-scss" lang="scss">import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">// æ­¥éª¤ï¼š1. å…³è”ç”¨æˆ·å’Œè®¢å• 2. å¤šæ¡ä»¶ç­›é€‰ 3. è½¬æ¢ç»“æœæ ¼å¼</span>
List&lt;String&gt; result1 = orderList<span class="hljs-selector-class">.stream</span>()
        <span class="hljs-comment">// å…³è”ç”¨æˆ·ï¼ˆé€šè¿‡userIdåŒ¹é…ï¼‰</span>
        <span class="hljs-selector-class">.map</span>(order -&gt; {
            User user = userList.stream()
                    <span class="hljs-selector-class">.filter</span>(u -&gt; u.getUserId()<span class="hljs-selector-class">.equals</span>(order.getUserId()))
                    <span class="hljs-selector-class">.findFirst</span>()
                    <span class="hljs-selector-class">.orElse</span>(null);
            return new <span class="hljs-selector-tag">Object</span>() { <span class="hljs-comment">// åŒ¿åå¯¹è±¡ä¸´æ—¶å­˜å‚¨å…³è”ç»“æœ</span>
                Long orderId = <span class="hljs-attribute">order</span><span class="hljs-selector-class">.getOrderId</span>();
                String userName = user != null ? user<span class="hljs-selector-class">.getUserName</span>() : <span class="hljs-string">"æœªçŸ¥"</span>;
                String city = user != null ? user<span class="hljs-selector-class">.getCity</span>() : <span class="hljs-string">""</span>;
                LocalDateTime createTime = <span class="hljs-attribute">order</span><span class="hljs-selector-class">.getCreateTime</span>();
                BigDecimal totalAmount = <span class="hljs-attribute">order</span><span class="hljs-selector-class">.getTotalAmount</span>();
            };
        })
        <span class="hljs-comment">// å¤šæ¡ä»¶ç­›é€‰ï¼šåŒ—äº¬ç”¨æˆ· + 1æœˆ10æ—¥å + é‡‘é¢&gt;5000</span>
        <span class="hljs-selector-class">.filter</span>(temp -&gt; "åŒ—äº¬".equals(temp.city)
                &amp;&amp; temp<span class="hljs-selector-class">.createTime</span><span class="hljs-selector-class">.isAfter</span>(LocalDateTime.of(<span class="hljs-number">2026</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>))
                &amp;&amp; temp<span class="hljs-selector-class">.totalAmount</span><span class="hljs-selector-class">.compareTo</span>(new BigDecimal("<span class="hljs-number">5000</span>")) &gt; <span class="hljs-number">0</span>)
        <span class="hljs-comment">// è½¬æ¢ç»“æœæ ¼å¼ï¼š"è®¢å•ID-ç”¨æˆ·å"</span>
        <span class="hljs-selector-class">.map</span>(temp -&gt; temp.orderId + "-" + temp.userName)
        <span class="hljs-selector-class">.collect</span>(Collectors.toList());

System<span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(result1); <span class="hljs-comment">// è¾“å‡ºï¼š[1002-å¼ ä¸‰, 1004-ç‹äº”]</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>å…³é”®è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>map</code>Â ä¸ä»…èƒ½ç®€å•è½¬æ¢ç±»å‹ï¼Œè¿˜èƒ½åš<strong>æ•°æ®å…³è”</strong>ï¼ˆè¿™é‡Œå…³è”è®¢å•å’Œç”¨æˆ·ï¼‰ï¼›</li>
<li>å¤šæ¡ä»¶Â <code>filter</code>Â å¯ä»¥ç»„åˆä»»æ„å¸ƒå°”é€»è¾‘ï¼ŒBigDecimal æ¯”è¾ƒè¦ç”¨Â <code>compareTo</code>Â è€ŒéÂ <code>&gt;</code>/<code>&lt;</code>ï¼›</li>
<li>åŒ¿åå¯¹è±¡ç”¨äºä¸´æ—¶å­˜å‚¨å¤šå­—æ®µå…³è”ç»“æœï¼ˆä¹Ÿå¯ä»¥è‡ªå®šä¹‰ DTO ç±»ï¼Œæ›´è§„èŒƒï¼‰ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-15">åœºæ™¯ 2ï¼šåˆ†ç»„èšåˆï¼ˆæ ¸å¿ƒå¤æ‚åœºæ™¯ï¼‰</h4>
<p><strong>éœ€æ±‚</strong>ï¼šæŒ‰ç”¨æˆ·æ‰€åœ¨åŸå¸‚åˆ†ç»„ï¼Œç»Ÿè®¡æ¯ä¸ªåŸå¸‚çš„ï¼š1. è®¢å•æ€»æ•° 2. è®¢å•æ€»é‡‘é¢ 3. å¹³å‡è®¢å•é‡‘é¢ã€‚</p>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> java.math.BigDecimal;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> java.util.stream.Collectors;

<span class="hljs-comment">// æ­¥éª¤ï¼š1. å…³è”è®¢å•å’ŒåŸå¸‚ 2. æŒ‰åŸå¸‚åˆ†ç»„ 3. èšåˆç»Ÿè®¡</span>
Map&lt;String, Object&gt; result2 = orderList.stream()
        <span class="hljs-comment">// å…³è”è®¢å•å’ŒåŸå¸‚</span>
        .map(order -&gt; {
            <span class="hljs-type">String</span> <span class="hljs-variable">city</span> <span class="hljs-operator">=</span> userList.stream()
                    .filter(u -&gt; u.getUserId().equals(order.getUserId()))
                    .map(User::getCity)
                    .findFirst()
                    .orElse(<span class="hljs-string">"æœªçŸ¥"</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>() {
                <span class="hljs-type">String</span> <span class="hljs-variable">city</span> <span class="hljs-operator">=</span> city;
                <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">totalAmount</span> <span class="hljs-operator">=</span> order.getTotalAmount();
            };
        })
        <span class="hljs-comment">// æŒ‰åŸå¸‚åˆ†ç»„ï¼Œå¹¶èšåˆç»Ÿè®¡ï¼ˆCollectors.teeing æ˜¯Java 12+ç‰¹æ€§ï¼Œæ”¯æŒå¤šèšåˆï¼‰</span>
        .collect(Collectors.groupingBy(
                temp -&gt; temp.city, <span class="hljs-comment">// åˆ†ç»„é”®ï¼šåŸå¸‚</span>
                Collectors.teeing(
                        Collectors.counting(), <span class="hljs-comment">// èšåˆ1ï¼šè®¢å•æ€»æ•°</span>
                        Collectors.reducing(BigDecimal.ZERO,
                             temp -&gt; temp.totalAmount, BigDecimal::add), 
                        <span class="hljs-comment">// èšåˆ2ï¼šæ€»é‡‘é¢</span>
                        (count, total) -&gt; <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>() { <span class="hljs-comment">// åˆå¹¶ä¸¤ä¸ªèšåˆç»“æœ</span>
                            <span class="hljs-type">long</span> <span class="hljs-variable">orderCount</span> <span class="hljs-operator">=</span> count;
                            <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">totalAmount</span> <span class="hljs-operator">=</span> total;
                            <span class="hljs-type">BigDecimal</span> <span class="hljs-variable">avgAmount</span> <span class="hljs-operator">=</span> total
                                    .divide(BigDecimal.valueOf(count),
                                     <span class="hljs-number">2</span>, BigDecimal.ROUND_HALF_UP); 
                            <span class="hljs-comment">// å¹³å‡é‡‘é¢ï¼ˆä¿ç•™2ä½ï¼‰</span>
                        }
                )
        ));

<span class="hljs-comment">// è¾“å‡ºç»“æœ</span>
result2.forEach((city, stats) -&gt; {
    System.out.println(<span class="hljs-string">"åŸå¸‚ï¼š"</span> + city);
    System.out.println(<span class="hljs-string">"  - è®¢å•æ€»æ•°ï¼š"</span> + stats.orderCount);
    System.out.println(<span class="hljs-string">"  - æ€»é‡‘é¢ï¼š"</span> + stats.totalAmount);
    System.out.println(<span class="hljs-string">"  - å¹³å‡é‡‘é¢ï¼š"</span> + stats.avgAmount);
});
<span class="hljs-comment">/* è¾“å‡ºï¼š
åŸå¸‚ï¼šåŒ—äº¬
  - è®¢å•æ€»æ•°ï¼š3
  - æ€»é‡‘é¢ï¼š21595
  - å¹³å‡é‡‘é¢ï¼š7198.33
åŸå¸‚ï¼šä¸Šæµ·
  - è®¢å•æ€»æ•°ï¼š1
  - æ€»é‡‘é¢ï¼š497
  - å¹³å‡é‡‘é¢ï¼š497.00
*/</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>å…³é”®è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>Collectors.groupingBy</code>Â æ˜¯åˆ†ç»„æ ¸å¿ƒï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åˆ†ç»„é”®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯èšåˆé€»è¾‘ï¼›</li>
<li><code>Collectors.teeing</code>Â è§£å†³<strong>å¤šç»´åº¦èšåˆ</strong>é—®é¢˜ï¼ˆä¸€æ¬¡éå†å®Œæˆå¤šä¸ªç»Ÿè®¡ï¼‰ï¼Œé¿å…å¤šæ¬¡æµæ“ä½œï¼›</li>
<li><code>Collectors.reducing</code>Â ç”¨äºè‡ªå®šä¹‰å½’çº¦ï¼ˆè¿™é‡Œå®ç° BigDecimal æ±‚å’Œï¼Œå› ä¸º JDK å†…ç½®çš„ summingBigDecimal æ˜¯ Java 8 åç»­ç‰ˆæœ¬æ‰æ”¯æŒï¼‰ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-16">åœºæ™¯ 3ï¼šåµŒå¥—é›†åˆæ‰å¹³åŒ–å¤„ç†</h4>
<p><strong>éœ€æ±‚</strong>ï¼šæå–æ‰€æœ‰è®¢å•ä¸­çš„å•†å“ï¼Œå»é‡åç»Ÿè®¡æ¯ä¸ªå•†å“çš„æ€»é”€å”®æ•°é‡å’Œæ€»é”€å”®é¢ã€‚</p>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Map</span>;
<span class="hljs-selector-tag">import</span> <span class="hljs-selector-tag">java</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.stream</span><span class="hljs-selector-class">.Collectors</span>;

<span class="hljs-comment">// æ­¥éª¤ï¼š1. æ‰å¹³åŒ–è®¢å•é¡¹ï¼ˆList&lt;Order&gt; â†’ List&lt;OrderItem&gt;ï¼‰</span>
<span class="hljs-comment">// 2. æŒ‰å•†å“åˆ†ç»„ 3. ç»Ÿè®¡æ•°é‡å’Œé‡‘é¢</span>
<span class="hljs-selector-tag">Map</span>&lt;<span class="hljs-selector-tag">String</span>, <span class="hljs-selector-tag">Object</span>&gt; <span class="hljs-selector-tag">result3</span> = <span class="hljs-selector-tag">orderList</span><span class="hljs-selector-class">.stream</span>()
        <span class="hljs-comment">// flatMap æ‰å¹³åŒ–åµŒå¥—é›†åˆï¼šå°†æ¯ä¸ªè®¢å•çš„itemsåˆ—è¡¨å±•å¼€ä¸ºå•ä¸ªitemæµ</span>
        <span class="hljs-selector-class">.flatMap</span>(order -&gt; order.<span class="hljs-built_in">getItems</span>().<span class="hljs-built_in">stream</span>())
        <span class="hljs-comment">// æŒ‰å•†å“åç§°åˆ†ç»„ï¼Œèšåˆç»Ÿè®¡</span>
        <span class="hljs-selector-class">.collect</span>(Collectors.<span class="hljs-built_in">groupingBy</span>(
                <span class="hljs-attribute">OrderItem</span>::getProductName, <span class="hljs-comment">// åˆ†ç»„é”®ï¼šå•†å“åç§°</span>
                Collectors.<span class="hljs-built_in">teeing</span>(
                        <span class="hljs-comment">// èšåˆ1ï¼šæ€»é”€å”®æ•°é‡ï¼ˆæ±‚å’Œquantityï¼‰</span>
                        Collectors.<span class="hljs-built_in">summingInt</span>(<span class="hljs-attribute">OrderItem</span>::getQuantity),
                        <span class="hljs-comment">// èšåˆ2ï¼šæ€»é”€å”®é¢ï¼ˆquantity * price æ±‚å’Œï¼‰</span>
                        Collectors.<span class="hljs-built_in">reducing</span>(
                                BigDecimal.ZERO,
                                item -&gt; item.<span class="hljs-built_in">getPrice</span>()
                                .<span class="hljs-built_in">multiply</span>(BigDecimal.<span class="hljs-built_in">valueOf</span>(item.<span class="hljs-built_in">getQuantity</span>())),
                                <span class="hljs-attribute">BigDecimal</span>::add
                        ),
                        <span class="hljs-comment">// åˆå¹¶ç»“æœ</span>
                        (totalQty, totalSales) -&gt; new <span class="hljs-built_in">Object</span>() {
                            int totalQuantity = totalQty;
                            BigDecimal totalSalesAmount = totalSales;
                        }
                )
        ));

<span class="hljs-comment">// è¾“å‡ºç»“æœ</span>
<span class="hljs-selector-tag">result3</span><span class="hljs-selector-class">.forEach</span>((product, stats) -&gt; {
    <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"å•†å“ï¼š"</span> + product);
    <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"  - æ€»é”€é‡ï¼š"</span> + stats.totalQuantity);
    <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"  - æ€»é”€å”®é¢ï¼š"</span> + stats.totalSalesAmount);
});
<span class="hljs-comment">/* è¾“å‡ºï¼š
å•†å“ï¼šæ‰‹æœº
  - æ€»é”€é‡ï¼š2
  - æ€»é”€å”®é¢ï¼š11998
å•†å“ï¼šè€³æœº
  - æ€»é”€é‡ï¼š2
  - æ€»é”€å”®é¢ï¼š598
å•†å“ï¼šç”µè„‘
  - æ€»é”€é‡ï¼š1
  - æ€»é”€å”®é¢ï¼š8999
å•†å“ï¼šé¼ æ ‡
  - æ€»é”€é‡ï¼š1
  - æ€»é”€å”®é¢ï¼š99
å•†å“ï¼šé”®ç›˜
  - æ€»é”€é‡ï¼š2
  - æ€»é”€å”®é¢ï¼š398
*/</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>å…³é”®è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>flatMap</code>Â æ˜¯å¤„ç†<strong>åµŒå¥—é›†åˆ</strong>çš„æ ¸å¿ƒï¼ˆå¦‚Â <code>List&lt;Order&gt;</code>Â ä¸­æ¯ä¸ª Order åŒ…å«Â <code>List&lt;OrderItem&gt;</code>ï¼‰ï¼Œèƒ½å°† â€œæµçš„æµâ€ï¼ˆ<code>Stream&lt;Stream&lt;OrderItem&gt;&gt;</code>ï¼‰è½¬æ¢ä¸º â€œå•ä¸€æµâ€ï¼ˆ<code>Stream&lt;OrderItem&gt;</code>ï¼‰ï¼›</li>
<li>èšåˆæ—¶å¯ä»¥ç»“åˆåŸºç¡€ç±»å‹æ±‚å’Œï¼ˆ<code>summingInt</code>ï¼‰å’Œ BigDecimal è‡ªå®šä¹‰æ±‚å’Œï¼Œè¦†ç›–ä¸åŒæ•°æ®ç±»å‹çš„ç»Ÿè®¡éœ€æ±‚ã€‚</li>
</ul>
<hr/>
<h4 data-id="heading-17">åœºæ™¯ 4ï¼šæ’åº + é™åˆ¶ç»“æœ + å½’çº¦</h4>
<p><strong>éœ€æ±‚</strong>ï¼šæ‰¾å‡º 2026 å¹´ 1 æœˆåˆ›å»ºçš„è®¢å•ä¸­ï¼Œæ€»é‡‘é¢æœ€é«˜çš„å‰ 2 ä¸ªè®¢å•ï¼Œè®¡ç®—å®ƒä»¬çš„é‡‘é¢æ€»å’Œã€‚</p>
<p>java</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-scss" lang="scss">import java<span class="hljs-selector-class">.math</span><span class="hljs-selector-class">.BigDecimal</span>;
import java<span class="hljs-selector-class">.time</span><span class="hljs-selector-class">.Month</span>;
import java<span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.Comparator</span>;

BigDecimal result4 = orderList<span class="hljs-selector-class">.stream</span>()
        <span class="hljs-comment">// ç­›é€‰ï¼š2026å¹´1æœˆåˆ›å»ºçš„è®¢å•</span>
        <span class="hljs-selector-class">.filter</span>(order -&gt; order.getCreateTime()<span class="hljs-selector-class">.getYear</span>() == <span class="hljs-number">2026</span> 
                &amp;&amp; <span class="hljs-attribute">order</span><span class="hljs-selector-class">.getCreateTime</span>()<span class="hljs-selector-class">.getMonth</span>() == Month<span class="hljs-selector-class">.JANUARY</span>)
        <span class="hljs-comment">// æŒ‰æ€»é‡‘é¢é™åºæ’åº</span>
        <span class="hljs-selector-class">.sorted</span>(Comparator.comparing(Order::getTotalAmount)<span class="hljs-selector-class">.reversed</span>())
        <span class="hljs-comment">// é™åˆ¶å‰2ä¸ª</span>
        <span class="hljs-selector-class">.limit</span>(<span class="hljs-number">2</span>)
        <span class="hljs-comment">// å½’çº¦æ±‚å’Œï¼šå°†å‰2ä¸ªè®¢å•çš„é‡‘é¢ç›¸åŠ </span>
        <span class="hljs-selector-class">.map</span>(Order::getTotalAmount)
        <span class="hljs-selector-class">.reduce</span>(BigDecimal.ZERO, BigDecimal::add);

System<span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>("å‰<span class="hljs-number">2</span>é«˜é‡‘é¢è®¢å•æ€»å’Œï¼š" + result4); 
<span class="hljs-comment">// è¾“å‡ºï¼š15998ï¼ˆ8999+5999ï¼‰</span>
</code></pre>
<p><img src="" alt="" title="ç‚¹å‡»å¹¶æ‹–æ‹½ä»¥ç§»åŠ¨" loading="lazy"/></p>
<p><strong>å…³é”®è§£é‡Š</strong>ï¼š</p>
<ul>
<li><code>sorted</code>Â ç»“åˆÂ <code>Comparator.comparing</code>Â å®ç°è‡ªå®šä¹‰æ’åºï¼ˆ<code>reversed()</code>Â é™åºï¼‰ï¼›</li>
<li><code>limit(n)</code>Â æˆªå–å‰ n æ¡ç»“æœï¼Œå¸¸å’Œæ’åºé…åˆå®ç° â€œTop Nâ€ éœ€æ±‚ï¼›</li>
<li><code>reduce</code>Â æ˜¯åŸºç¡€å½’çº¦æ“ä½œï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯äºŒå…ƒæ“ä½œç¬¦ï¼ˆè¿™é‡Œç”¨ BigDecimal çš„ add æ–¹æ³•ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-18">ä¸‰ã€å¤æ‚ Stream å¤„ç†çš„æœ€ä½³å®è·µ</h3>
<ol>
<li>
<p><strong>é¿å…é“¾å¼è¿‡é•¿</strong>ï¼šå¦‚æœ Stream æ“ä½œè¶…è¿‡ 5 æ­¥ï¼Œæ‹†åˆ†ä¸ºå¤šä¸ªå°æµæˆ–æå–ä¸ºæ–¹æ³•ï¼ˆå¦‚å•ç‹¬å†™ä¸€ä¸ª<code>getCityByUserId</code>æ–¹æ³•ï¼‰ï¼Œæå‡å¯è¯»æ€§ï¼›</p>
</li>
<li>
<p><strong>ä¼˜å…ˆä½¿ç”¨å¹¶è¡Œæµï¼ˆè°¨æ…ï¼‰</strong> ï¼šæ•°æ®é‡è¶…å¤§æ—¶ï¼ˆä¸‡çº§ä»¥ä¸Šï¼‰ï¼Œç”¨Â <code>parallelStream()</code>Â æ›¿ä»£Â <code>stream()</code>Â æå‡æ€§èƒ½ï¼Œä½†è¦ç¡®ä¿ï¼š</p>
<ul>
<li>æ— çŠ¶æ€æ“ä½œï¼ˆfilter/map/flatMap æ˜¯æ— çŠ¶æ€ï¼Œsorted/limit æ˜¯æœ‰çŠ¶æ€ï¼‰ï¼›</li>
<li>æ— çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ˆä¸ä¿®æ”¹å¤–éƒ¨å˜é‡ï¼‰ï¼›</li>
</ul>
</li>
<li>
<p><strong>ç©ºå€¼å¤„ç†</strong>ï¼šç”¨Â <code>Optional</code>Â é¿å…ç©ºæŒ‡é’ˆï¼Œæ¯”å¦‚Â <code>findFirst().orElse(null)</code>Â æ”¹ä¸ºÂ <code>findFirst().orElseThrow(() -&gt; new RuntimeException("ç”¨æˆ·ä¸å­˜åœ¨"))</code>ï¼ˆæ ¹æ®ä¸šåŠ¡é€‰æ‹©ï¼‰ï¼›</p>
</li>
<li>
<p><strong>é¿å…é‡å¤æµæ“ä½œ</strong>ï¼šåŒä¸€ä¸ªé›†åˆä¸è¦å¤šæ¬¡åˆ›å»º Streamï¼Œå¯å…ˆæ”¶é›†ä¸ºä¸­é—´é›†åˆï¼ˆå¦‚ Listï¼‰å¤ç”¨ï¼›</p>
</li>
<li>
<p><strong>æ•°æ®é‡å¤§æ—¶æ…ç”¨ collect</strong>ï¼šå¦‚æœåªæ˜¯éå†è¾“å‡ºï¼Œç›´æ¥ç”¨Â <code>forEach</code>Â è€ŒéÂ <code>collect</code>Â åå†éå†ï¼Œå‡å°‘å†…å­˜å ç”¨ã€‚</p>
</li>
</ol>
<h3 data-id="heading-19">æ€»ç»“</h3>
<ol>
<li>Stream API å¤„ç†å¤æ‚æ•°æ®çš„æ ¸å¿ƒæ˜¯<strong>æ“ä½œç»„åˆ</strong>ï¼š<code>filter/map/flatMap</code>Â åšæ•°æ®é¢„å¤„ç†ï¼Œ<code>groupingBy/teeing/reducing</code>Â åšèšåˆç»Ÿè®¡ï¼Œ<code>sorted/limit</code>Â åšæ’åºæˆªå–ï¼›</li>
<li><code>flatMap</code>Â æ˜¯å¤„ç†åµŒå¥—é›†åˆçš„å…³é”®ï¼Œ<code>Collectors.teeing</code>Â æ˜¯å¤šç»´åº¦èšåˆçš„æœ€ä¼˜è§£ï¼ˆJava 12+ï¼‰ï¼Œ<code>groupingBy</code>Â æ˜¯åˆ†ç»„ç»Ÿè®¡çš„æ ¸å¿ƒï¼›</li>
<li>å¤æ‚åœºæ™¯ä¸‹è¦å…¼é¡¾<strong>å¯è¯»æ€§</strong>å’Œ<strong>æ€§èƒ½</strong>ï¼šæ‹†åˆ†é•¿é“¾å¼æ“ä½œã€è°¨æ…ä½¿ç”¨å¹¶è¡Œæµã€åšå¥½ç©ºå€¼å¤„ç†ã€‚</li>
</ol>
<p>å¦‚æœéœ€è¦é’ˆå¯¹æŸä¸ªå…·ä½“ä¸šåŠ¡åœºæ™¯ï¼ˆæ¯”å¦‚å¤šè¡¨å…³è”ã€å¤§æ•°æ®é‡åˆ†é¡µã€è‡ªå®šä¹‰èšåˆå‡½æ•°ï¼‰æ·±å…¥è®²è§£ï¼Œåç»­å†å‡ºã€‚</p>
<p>â€‹</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Bipesé¡¹ç›®äºŒæ¬¡å¼€å‘/æ‰©å±•ç§¯æœ¨åŠŸèƒ½ï¼ˆå…«ï¼‰]]></title>    <link>https://juejin.cn/post/7597252004712792106</link>    <guid>https://juejin.cn/post/7597252004712792106</guid>    <pubDate>2026-01-20T09:22:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597252004712792106" data-draft-id="7597168034618097683" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Bipesé¡¹ç›®äºŒæ¬¡å¼€å‘/æ‰©å±•ç§¯æœ¨åŠŸèƒ½ï¼ˆå…«ï¼‰"/> <meta itemprop="keywords" content="JavaScript,å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-20T09:22:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ¯”è€é©¬è¿˜å…­"/> <meta itemprop="url" content="https://juejin.cn/user/2212677374711006"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Bipesé¡¹ç›®äºŒæ¬¡å¼€å‘/æ‰©å±•ç§¯æœ¨åŠŸèƒ½ï¼ˆå…«ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2212677374711006/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ¯”è€é©¬è¿˜å…­
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:22:54.000Z" title="Tue Jan 20 2026 09:22:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Bipesé¡¹ç›®äºŒæ¬¡å¼€å‘/æ‰©å±•ç§¯æœ¨åŠŸèƒ½ï¼ˆå…«ï¼‰</h2>
<p>æ–°å¹´ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œè¿™ä¸€ç¯‡å¼€å‘æ‰©å±•ç§¯æœ¨åŠŸèƒ½ã€‚å…ˆçœ‹ä¸€æ®µVCRã€‚
<strong>å¹¿å‘Šï¼šéœ€è¦äºŒå¼€Bipesï¼ŒScratchï¼Œblocklyå¯ä»¥æ‰¾æˆ‘ã€‚</strong>
<strong>é¡¹ç›®åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmaxuecan.github.io%2FBipes%2Findex.html" target="_blank" title="https://maxuecan.github.io/Bipes/index.html" ref="nofollow noopener noreferrer">maxuecan.github.io/Bipes/indexâ€¦</a></strong></p>
<h3 data-id="heading-1">VCR</h3>
<p>[video(video-CjWu9kdf-1768899636737)(type-csdn)(url-<a href="https://link.juejin.cn?target=https%3A%2F%2Flive.csdn.net%2Fv%2Fembed%2F510885)(image-https%3A%2F%2Fv-blog.csdnimg.cn%2Fasset%2F0b89d66ce42de8f1528405d9efcb78d1%2Fcover%2FCover0.jpg)(title-%25E6%2589%25A9%25E5%25B1%2595%25E5%258A%259F%25E8%2583%25BD" target="_blank" title="https://live.csdn.net/v/embed/510885)(image-https://v-blog.csdnimg.cn/asset/0b89d66ce42de8f1528405d9efcb78d1/cover/Cover0.jpg)(title-%E6%89%A9%E5%B1%95%E5%8A%9F%E8%83%BD" ref="nofollow noopener noreferrer">live.csdn.net/v/embed/510â€¦</a>)]</p>
<h3 data-id="heading-2">ç¬¬ä¸€ï¼šæ¨¡å¼é€‰æ‹©</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/42a14cd256e9448cb7fdaed17a1deab6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q-U6ICB6ams6L-Y5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769505773&amp;x-signature=7xJI6tahAXB%2B8Tjq2GsGpEAidtY%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/>
åœ¨ä¸‰ç§æ¨¡å¼ä¸­ï¼Œæš‚æ—¶å¯¹æµ·é¾Ÿç¼–ç¨‹åŠ äº†æ‰©å±•ç§¯æœ¨åŠŸèƒ½ï¼Œç‚¹å‡»é€‰æ‹©æµ·é¾Ÿç¼–ç¨‹ï¼Œå°±å¯ä»¥çœ‹åˆ°ç§¯æœ¨åˆ—è¡¨å¤šäº†ä¸ªæ·»åŠ æŒ‰é’®ã€‚<strong>å…¶å®ƒæ¨¡å¼ä¸‹ä¸ä¼šæ˜¾ç¤º</strong>ã€‚</p>
<h3 data-id="heading-3">ç¬¬äºŒï¼šç§¯æœ¨æ‰©å±•</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0e93fb77d82e4cfa96c143b74bebc9f2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q-U6ICB6ams6L-Y5YWt:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769505773&amp;x-signature=hHgQlsjm1hpgWcZKIsv3J5H9zaM%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<p>ç‚¹å‡»æ‰©å±•æŒ‰é’®ï¼Œä¼šå¼¹çª—ä¸€ä¸ªæ‰©å±•ç§¯æœ¨å¼¹çª—ï¼Œæ¥ç€ç‚¹å‡»å¡ç‰‡ï¼Œä¼šæ˜¾ç¤ºç¡®è®¤æ·»åŠ æŒ‰é’®ï¼Œæœ€åç‚¹å‡»ç¡®è®¤æ·»åŠ ï¼Œå°±èƒ½åŠ¨æ€æ·»åŠ æ‰©å±•ç§¯æœ¨ã€‚</p>
<h3 data-id="heading-4">ç¬¬ä¸‰ï¼šä»£ç è§£æ</h3>
<pre><code class="hljs language-cpp" lang="cpp">ui/components/extensions-btn.<span class="hljs-built_in">js</span>(æ‰©å±•ç§¯æœ¨æŒ‰é’®)

<span class="hljs-keyword">import</span> EventEmitterController from <span class="hljs-string">'../utils/event-emitter-controller'</span>
<span class="hljs-keyword">import</span> { resetPostion } from <span class="hljs-string">'../utils/utils'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">extensionsBtn</span> {
    <span class="hljs-built_in">constructor</span>(props) {
        <span class="hljs-keyword">this</span>.settings = props.settings
        <span class="hljs-keyword">this</span>.resetPostion = resetPostion
        <span class="hljs-keyword">if</span> (document.<span class="hljs-built_in">getElementById</span>(<span class="hljs-string">'content_blocks'</span>)) {
            $(<span class="hljs-string">'#content_blocks'</span>).<span class="hljs-built_in">append</span>(<span class="hljs-keyword">this</span>.<span class="hljs-built_in">render</span>())
            <span class="hljs-keyword">this</span>.<span class="hljs-built_in">initEvent</span>()
        }

        <span class="hljs-comment">// æ ¹æ®æ¨¡å¼ï¼Œæ§åˆ¶æ‰©å±•æŒ‰é’®çš„æ˜¾ç¤º</span>
        <span class="hljs-built_in">setTimeout</span>(() =&gt; {
            let { mode } = <span class="hljs-keyword">this</span>.settings
            <span class="hljs-built_in">resetPostion</span>()
            $(<span class="hljs-string">'#extensions-btn'</span>).<span class="hljs-built_in">css</span>(<span class="hljs-string">'display'</span>, mode === <span class="hljs-string">'turtle'</span> ? <span class="hljs-string">'block'</span> : <span class="hljs-string">'none'</span>)
        }, <span class="hljs-number">1000</span>);
    }
    <span class="hljs-comment">// åˆå§‹åŒ–äº‹ä»¶</span>
    <span class="hljs-built_in">initEvent</span>() {
        window.<span class="hljs-built_in">addEventListener</span>(<span class="hljs-string">'resize'</span>, (e) =&gt; {
            <span class="hljs-keyword">this</span>.<span class="hljs-built_in">resetPostion</span>()
        })

        $(<span class="hljs-string">'#extensions-btn'</span>).<span class="hljs-built_in">on</span>(<span class="hljs-string">'click'</span>, () =&gt; {
            EventEmitterController.<span class="hljs-built_in">emit</span>(<span class="hljs-string">'open-extensions-dialog'</span>)
        })
    }

    <span class="hljs-built_in">render</span>() {
        <span class="hljs-keyword">return</span> `
            &lt;div id=<span class="hljs-string">"extensions-btn"</span>&gt;
                &lt;div <span class="hljs-keyword">class</span>=<span class="hljs-string">"extensions-add"</span>&gt;&lt;/div&gt;
            &lt;/div&gt;
        `
    }
}
</code></pre>
<pre><code class="hljs language-cpp" lang="cpp">ui/components/extensions-dialog.<span class="hljs-built_in">js</span>(æ‰©å±•ç§¯æœ¨å¼¹çª—)

<span class="hljs-keyword">import</span> ExtensionsList from <span class="hljs-string">'../config/extensions-blocks.js'</span>
<span class="hljs-keyword">import</span> { resetPostion } from <span class="hljs-string">'../utils/utils'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">extensionsDialog</span> {
    <span class="hljs-built_in">constructor</span>() {
        <span class="hljs-keyword">this</span>._xml = undefined
        <span class="hljs-keyword">this</span>._show = <span class="hljs-literal">false</span>
        <span class="hljs-keyword">this</span>.list = ExtensionsList
        <span class="hljs-keyword">this</span>.use = []
        <span class="hljs-keyword">this</span>.after_extensions = [] <span class="hljs-comment">// è®°å½•å·²ç»æ·»åŠ è¿‡çš„æ‰©å±•ç§¯æœ¨</span>
    }
    <span class="hljs-comment">// åˆå§‹åŒ–äº‹ä»¶</span>
    <span class="hljs-built_in">initEvent</span>() {
        $(<span class="hljs-string">'.extensions-modal-close'</span>).<span class="hljs-built_in">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.close.<span class="hljs-built_in">bind</span>(<span class="hljs-keyword">this</span>))
        $(<span class="hljs-string">'.extensions-modal-confirm'</span>).<span class="hljs-built_in">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.confirm.<span class="hljs-built_in">bind</span>(<span class="hljs-keyword">this</span>))
        $(<span class="hljs-string">'.extensions-modal-list'</span>).<span class="hljs-built_in">on</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.select.<span class="hljs-built_in">bind</span>(<span class="hljs-keyword">this</span>))
    }
    <span class="hljs-comment">// é”€æ¯äº‹ä»¶</span>
    <span class="hljs-built_in">removeEvent</span>() {
        $(<span class="hljs-string">'.extensions-modal-close'</span>).<span class="hljs-built_in">off</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.close.<span class="hljs-built_in">bind</span>(<span class="hljs-keyword">this</span>))
        $(<span class="hljs-string">'.extensions-modal-confirm'</span>).<span class="hljs-built_in">off</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.confirm.<span class="hljs-built_in">bind</span>(<span class="hljs-keyword">this</span>))
        $(<span class="hljs-string">'.extensions-modal-list'</span>).<span class="hljs-built_in">off</span>(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.select.<span class="hljs-built_in">bind</span>(<span class="hljs-keyword">this</span>))
    }
    <span class="hljs-comment">// æ˜¾ç¤ºéšè—å¼¹çª—</span>
    <span class="hljs-built_in">show</span>() {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._show) {
            $(<span class="hljs-string">'.extensions-dialog'</span>).<span class="hljs-built_in">remove</span>()
            <span class="hljs-keyword">this</span>.<span class="hljs-built_in">removeEvent</span>()
        } <span class="hljs-keyword">else</span> {
            $(<span class="hljs-string">'body'</span>).<span class="hljs-built_in">append</span>(<span class="hljs-keyword">this</span>.<span class="hljs-built_in">render</span>())
            <span class="hljs-keyword">this</span>.<span class="hljs-built_in">initEvent</span>()
            <span class="hljs-keyword">this</span>.<span class="hljs-built_in">createList</span>()
        }

        <span class="hljs-keyword">this</span>._show = !<span class="hljs-keyword">this</span>._show
    }
    <span class="hljs-comment">// åˆ›å»ºæ‰©å±•åˆ—è¡¨</span>
    <span class="hljs-built_in">createList</span>() {
        $(<span class="hljs-string">'.extensions-list'</span>).<span class="hljs-built_in">empty</span>()
        <span class="hljs-keyword">for</span> (let i in <span class="hljs-keyword">this</span>.list) {
            let li = $(<span class="hljs-string">'&lt;li&gt;'</span>)
                    .<span class="hljs-built_in">attr</span>(<span class="hljs-string">'key'</span>, <span class="hljs-keyword">this</span>.list[i][<span class="hljs-string">'type'</span>])
                    .<span class="hljs-built_in">css</span>({
                        background: `<span class="hljs-built_in">url</span>(${<span class="hljs-keyword">this</span>.list[i][<span class="hljs-string">'image'</span>]}) center/cover no-repeat`,
                    })
            let box = $(<span class="hljs-string">'&lt;div&gt;'</span>)
                    .<span class="hljs-built_in">addClass</span>(<span class="hljs-string">'extensions-list-image'</span>)
                    .<span class="hljs-built_in">attr</span>(<span class="hljs-string">'key'</span>, <span class="hljs-keyword">this</span>.list[i][<span class="hljs-string">'type'</span>])
            let detail = $(<span class="hljs-string">'&lt;div&gt;'</span>)
                .<span class="hljs-built_in">addClass</span>(<span class="hljs-string">'extensions-list-detail'</span>)
                .<span class="hljs-built_in">attr</span>(<span class="hljs-string">'key'</span>, <span class="hljs-keyword">this</span>.list[i][<span class="hljs-string">'type'</span>])

            let name = $(<span class="hljs-string">'&lt;h4&gt;'</span>).<span class="hljs-built_in">text</span>(<span class="hljs-keyword">this</span>.list[i][<span class="hljs-string">'name'</span>]).<span class="hljs-built_in">attr</span>(<span class="hljs-string">'key'</span>, <span class="hljs-keyword">this</span>.list[i][<span class="hljs-string">'type'</span>])
            let remark = $(<span class="hljs-string">'&lt;span&gt;'</span>).<span class="hljs-built_in">text</span>(<span class="hljs-keyword">this</span>.list[i][<span class="hljs-string">'remark'</span>]).<span class="hljs-built_in">attr</span>(<span class="hljs-string">'key'</span>, <span class="hljs-keyword">this</span>.list[i][<span class="hljs-string">'type'</span>])
            detail.<span class="hljs-built_in">append</span>(name).<span class="hljs-built_in">append</span>(remark)
            $(<span class="hljs-string">'.extensions-modal-list'</span>).<span class="hljs-built_in">append</span>(li.<span class="hljs-built_in">append</span>(box).<span class="hljs-built_in">append</span>(detail))
        }
    }
    <span class="hljs-comment">// é€‰æ‹©åˆ—è¡¨</span>
    <span class="hljs-built_in">select</span>(e) {
        let key = e.target.<span class="hljs-built_in">getAttribute</span>(<span class="hljs-string">'key'</span>)
        <span class="hljs-keyword">if</span> (key !== null) {
            let index = <span class="hljs-keyword">this</span>.use.<span class="hljs-built_in">indexOf</span>(key)
            let type = undefined
            <span class="hljs-keyword">if</span> (index !== <span class="hljs-number">-1</span>) {
                <span class="hljs-keyword">this</span>.use.<span class="hljs-built_in">splice</span>(index, <span class="hljs-number">1</span>)
                type = <span class="hljs-string">'delete'</span>
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.use.<span class="hljs-built_in">push</span>(key)
                type = <span class="hljs-string">'add'</span>
            }
            <span class="hljs-keyword">this</span>.<span class="hljs-built_in">highlightList</span>(type, key)
            <span class="hljs-keyword">this</span>.<span class="hljs-built_in">showConfirm</span>()
        }
    }
    <span class="hljs-comment">// é«˜äº®åˆ—è¡¨é¡¹</span>
    <span class="hljs-built_in">highlightList</span>(action, key) {
        $(<span class="hljs-string">'.extensions-modal-list li'</span>).<span class="hljs-built_in">each</span>(<span class="hljs-built_in">function</span>(index) {
            let c_key = $(<span class="hljs-keyword">this</span>).<span class="hljs-built_in">attr</span>(<span class="hljs-string">'key'</span>)
            <span class="hljs-keyword">if</span> (key === c_key) {
                <span class="hljs-keyword">if</span> (action === <span class="hljs-string">'add'</span>) {
                    $(<span class="hljs-keyword">this</span>).<span class="hljs-built_in">addClass</span>(<span class="hljs-string">'extensions-modal-list-act'</span>)
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (action === <span class="hljs-string">'delete'</span>) {
                    $(<span class="hljs-keyword">this</span>).<span class="hljs-built_in">removeClass</span>(<span class="hljs-string">'extensions-modal-list-act'</span>)
                }
            }
        })
    }
    <span class="hljs-comment">// æ˜¾ç¤ºç¡®è®¤æŒ‰é’®</span>
    <span class="hljs-built_in">showConfirm</span>() {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.use.length &gt; <span class="hljs-number">0</span>) {
            $(<span class="hljs-string">'.extensions-modal-footer'</span>).<span class="hljs-built_in">css</span>(<span class="hljs-string">'display'</span>, <span class="hljs-string">'block'</span>)
        } <span class="hljs-keyword">else</span> {
            $(<span class="hljs-string">'.extensions-modal-footer'</span>).<span class="hljs-built_in">css</span>(<span class="hljs-string">'display'</span>, <span class="hljs-string">'none'</span>)
        }
    }
    <span class="hljs-comment">// å…³é—­</span>
    <span class="hljs-built_in">close</span>() {
        <span class="hljs-keyword">this</span>.<span class="hljs-built_in">show</span>()
    }
    <span class="hljs-comment">// ç¡®è®¤æ“ä½œ</span>
    <span class="hljs-built_in">confirm</span>() {
        let str = <span class="hljs-string">''
        this.use.forEach(item =&gt; {
            let index = this.after_extensions.indexOf(item)
            if (index === -1) {
                this.after_extensions.push(item)
                str += this.getExtendsionsXML(item)
            }
        })

        if (str) {
            if (!this._xml) this._xml = window._xml.cloneNode(true)
            let toolbox = this._xml
            toolbox.children[0].innerHTML += str
            Code.reloadToolbox(toolbox)
        }

        this.show()
        resetPostion()
    }
    /* è·å–æ‰©å±•ç§¯æœ¨çš„XML */
    getExtendsionsXML(type) {
        let item = ExtensionsList.filter(itm =&gt; itm.type === type)
        return item[0].xml
    }
    // é‡ç½®toolbox
    resetToolbox() {
        return new Promise((resolve) =&gt; {
            this._xml = window._xml.cloneNode(true)
            Code.reloadToolbox(this._xml)
            this.use = []
            this.after_extensions = []
            setTimeout(resolve(true), 200)
        })
    }

    render() {
        return `
            &lt;div class="extensions-dialog"&gt;
                &lt;div class="extensions-modal"&gt;
                    &lt;div class="extensions-modal-header"&gt;
                        &lt;h4&gt;&lt;/h4&gt;
                        &lt;ul class="extensions-modal-nav"&gt;
                            &lt;li class="extensions-modal-nav-act" key="basic"&gt;
                                &lt;span key="basic"&gt;æ‰©å±•ç§¯æœ¨&lt;/span&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;div class="extensions-modal-close"&gt;&lt;/div&gt;
                    &lt;/div&gt;

                    &lt;div class="extensions-modal-content"&gt;
                        &lt;ul class="extensions-modal-list"&gt;&lt;/ul&gt;
                    &lt;/div&gt;

                    &lt;div class="extensions-modal-footer"&gt;
                        &lt;button class="extensions-modal-confirm"&gt;ç¡®è®¤æ·»åŠ &lt;/button&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        `
    }
}
</span></code></pre>
<pre><code class="hljs language-cpp" lang="cpp">ui/config/extensions-blocks.<span class="hljs-built_in">js</span>(æ‰©å±•ç§¯æœ¨é…ç½®)

let turtle = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./turtle.png'</span>)

<span class="hljs-keyword">module</span>.exports = [
  {
    type: <span class="hljs-string">'turtle'</span>,
    name: <span class="hljs-string">'æµ·é¾Ÿå‡½æ•°'</span>,
    image: turtle,
    remark: <span class="hljs-string">'å¯ä»¥è°ƒç”¨æµ·é¾Ÿç¼–è¾‘å™¨ä¸­å¯¹åº”Pythonå‡½æ•°ã€‚'</span>,
    xml: `
            &lt;category name=<span class="hljs-string">"æµ·é¾Ÿ"</span> colour=<span class="hljs-string">"%{BKY_TURTLE_HUE}"</span>&gt;
                &lt;block type=<span class="hljs-string">"variables_set"</span> id=<span class="hljs-string">"fg004w+XJ=maCm$V7?3T"</span> x=<span class="hljs-string">"238"</span> y=<span class="hljs-string">"138"</span>&gt;
                    &lt;field name=<span class="hljs-string">"VAR"</span> id=<span class="hljs-string">"dfa$SFe(HK(10)Y+T-bS"</span>&gt;æµ·é¾Ÿ&lt;/field&gt;
                    &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                        &lt;block type=<span class="hljs-string">"turtle_create"</span> id=<span class="hljs-string">"Hv^2jr?;yxhA=%oCs1=d"</span>&gt;&lt;/block&gt;
                    &lt;/value&gt;
                &lt;/block&gt;
                &lt;block type=<span class="hljs-string">"turtle_create"</span>&gt;&lt;/block&gt;
                &lt;block type=<span class="hljs-string">"turtle_move"</span>&gt;
                    &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                        &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                            &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                        &lt;/block&gt;
                    &lt;/value&gt;
                    &lt;value name=<span class="hljs-string">"distance"</span>&gt;
                        &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                            &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">50</span>&lt;/field&gt;
                        &lt;/shadow&gt;
                    &lt;/value&gt;
                &lt;/block&gt;
                &lt;block type=<span class="hljs-string">"turtle_rotate"</span>&gt;
                    &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                        &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                            &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                        &lt;/block&gt;
                    &lt;/value&gt;
                    &lt;value name=<span class="hljs-string">"angle"</span>&gt;
                        &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                            &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">90</span>&lt;/field&gt;
                        &lt;/shadow&gt;
                    &lt;/value&gt;
                &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_move_xy"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"x"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">50</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"y"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">50</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_position"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"position"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">50</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_draw_circle"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"radius"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">50</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"extent"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">50</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"steps"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">50</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_draw_polygon"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"num_sides"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">5</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"radius"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">30</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_draw_point"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"diameter"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">50</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_write"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"text"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"text"</span>&gt;
                        &lt;field name=<span class="hljs-string">"TEXT"</span>&gt;Hello&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_heading"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"angle"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">90</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_pendown"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_pensize"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"size"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">5</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_speed"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"speed"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">5</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_get_position"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_show_hide"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_clear"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_stop"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_bgcolor"</span>&gt;
                &lt;value name=<span class="hljs-string">"COLOUR"</span>&gt;
                    &lt;block type=<span class="hljs-string">"colour_picker"</span>&gt;&lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_pencolor"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"COLOUR"</span>&gt;
                    &lt;block type=<span class="hljs-string">"colour_picker"</span>&gt;&lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_fillcolor"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"COLOUR"</span>&gt;
                    &lt;block type=<span class="hljs-string">"colour_picker"</span>&gt;&lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;

            &lt;block type=<span class="hljs-string">"turtle_set_colormode"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"COLOUR"</span>&gt;
                    &lt;shadow type=<span class="hljs-string">"math_number"</span>&gt;
                        &lt;field name=<span class="hljs-string">"NUM"</span>&gt;<span class="hljs-number">255</span>&lt;/field&gt;
                    &lt;/shadow&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_fill"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
            &lt;block type=<span class="hljs-string">"turtle_set_color"</span>&gt;
                &lt;value name=<span class="hljs-string">"VALUE"</span>&gt;
                    &lt;block type=<span class="hljs-string">"variables_get"</span>&gt;
                        &lt;field name=<span class="hljs-string">"VAR"</span>&gt;{turtleVariable}&lt;/field&gt;
                    &lt;/block&gt;
                &lt;/value&gt;
                &lt;value name=<span class="hljs-string">"COLOUR"</span>&gt;
                    &lt;block type=<span class="hljs-string">"colour_picker"</span>&gt;&lt;/block&gt;
                &lt;/value&gt;
            &lt;/block&gt;
        &lt;/category&gt;
        `,
  },
]
</code></pre>
<h3 data-id="heading-5">æ€»ç»“</h3>
<p>æ‰©å±•ç§¯æœ¨åŠŸèƒ½æ”¹åŠ¨æŒºå¤šçš„ï¼ŒåŠŸèƒ½ä¹Ÿæ—¶ä¸æ–­çš„å®Œå–„ï¼Œè®²è§£å¯èƒ½æ¯”è¾ƒç²—ç³™ï¼Œä¹Ÿåœ¨å°½é‡å†™æ³¨è§£ï¼Œæœ‰éœ€è¦å¯ä»¥çœ‹ä¸‹æäº¤æ—¥å¿—ï¼Œä¿¡æ¯ä¼šæ¯”è¾ƒå…¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[CSS åŠ¨æ•ˆè¿›é˜¶ï¼šä»â€œèƒ½åŠ¨å°±è¡Œâ€åˆ°â€œæ€§èƒ½ä¼˜åŒ–â€ï¼Œä¸€ä¸ªå‘¼å¸çƒèƒŒåçš„ 3 ä¸ªæ€è€ƒ]]></title>    <link>https://juejin.cn/post/7597250364124545087</link>    <guid>https://juejin.cn/post/7597250364124545087</guid>    <pubDate>2026-01-20T09:31:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597250364124545087" data-draft-id="7597230546239340580" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="CSS åŠ¨æ•ˆè¿›é˜¶ï¼šä»â€œèƒ½åŠ¨å°±è¡Œâ€åˆ°â€œæ€§èƒ½ä¼˜åŒ–â€ï¼Œä¸€ä¸ªå‘¼å¸çƒèƒŒåçš„ 3 ä¸ªæ€è€ƒ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-20T09:31:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Flinton"/> <meta itemprop="url" content="https://juejin.cn/user/2225067266677640"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            CSS åŠ¨æ•ˆè¿›é˜¶ï¼šä»â€œèƒ½åŠ¨å°±è¡Œâ€åˆ°â€œæ€§èƒ½ä¼˜åŒ–â€ï¼Œä¸€ä¸ªå‘¼å¸çƒèƒŒåçš„ 3 ä¸ªæ€è€ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2225067266677640/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Flinton
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:31:05.000Z" title="Tue Jan 20 2026 09:31:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘å«ã€å°å¥‡è…¾ã€‘ï¼Œä»Šå¤©æˆ‘ä»¬èŠä¸€ä¸ªåœºæ™¯é¢˜ï¼š<strong>â€œåŒå¿ƒåœ†å‘¼å¸åŠ¨ç”»â€</strong>ï¼Œå¾ˆå¤šåŒå­¦ 5 åˆ†é’Ÿå°±èƒ½å†™å‡ºæ¥ã€‚</p>
<p>ä½†æ˜¯ä»£ç èƒ½è·‘ï¼Œå°±OKäº†å—ï¼Ÿ</p>
<p>å½“å‡ºé¢˜äººé—®ä½ ï¼šâ€œä¸ºä»€ä¹ˆä½ çš„åŠ¨ç”»çœ‹èµ·æ¥å¡å¡çš„ï¼Œæˆ–è€…ä½ æ˜¯æ€ä¹ˆç¡®å®šç¼©æ”¾æ¯”ä¾‹çš„ï¼Ÿâ€ï¼Œè¿™æ—¶å€™å°±ä¸æ˜¯è€ƒå¯Ÿä½ ä¼šä¸ä¼šCSSè¯­æ³•äº†ï¼Œè€Œæ˜¯è€ƒå¯Ÿä½ å¯¹<code>æµè§ˆå™¨æ¸²æŸ“åŸç†</code>å’Œ<code>å·¥ç¨‹åŒ–æ€ç»´</code>çš„ç†è§£ã€‚
ä»Šå¤©è®©æˆ‘ä»¬åˆ†3æ­¥æ¥è¿›è¡Œæ€è€ƒï¼Œä»<code>èƒ½åŠ¨å°±è¡Œ</code>åˆ°<code>æè‡´æ€§èƒ½</code>ã€‚</p>
</blockquote>
<p>æœ¬æœŸè¯¦ç»†çš„è§†é¢‘æ•™ç¨‹bilibiliï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV11mk7BaExw%2F%3Fvd_source%3D4213d38d889ea1581bbcae78a04cbd9d" target="_blank" title="https://www.bilibili.com/video/BV11mk7BaExw/?vd_source=4213d38d889ea1581bbcae78a04cbd9d" ref="nofollow noopener noreferrer"># CSS åŠ¨æ•ˆè¿›é˜¶ï¼šä»â€œèƒ½åŠ¨å°±è¡Œâ€åˆ°â€œæ€§èƒ½ä¼˜åŒ–â€ï¼Œä¸€ä¸ªå‘¼å¸çƒèƒŒåçš„ 3 ä¸ªæ€è€ƒ</a></p>
<h2 data-id="heading-0">01. åœºæ™¯å¤ç°</h2>













<table><thead><tr><th>é¢˜ç›®ï¼š</th><th>åœºæ™¯å¤ç°</th></tr></thead><tbody><tr><td>åˆ©ç”¨æ‰€å­¦çš„ç›’å­æ¨¡å‹å’ŒåŠ¨ç”»ï¼Œè€ƒè™‘å¦‚ä½•å®ç°å¦‚ä¸‹å›¾çš„åŒå¿ƒåœ†ã€‚è¯¥åŒå¿ƒåœ†ä¼šæ”¾å¤§ç¼©å°çš„è¿åŠ¨è½¨è¿¹ï¼š<br/>1. å®šä¹‰ï¼šç›®å‰ä¸¤åœˆçš„å¤§å°ä¸ºå¸¸è§„å¤§å° <br/>2. æ­£å¸¸è¿åŠ¨è½¨è¿¹ï¼š<br/>å¤–åœˆå‘å¤–æ‰©å¤§ 10px (2000ms)<br/>å¤–åœˆå‘å†…å›å½’æ­£å¸¸å¤§å° (2000ms) <br/>å†…åœˆå‘å†…ç¼©å° 12px (2500ms)<br/>å†…åœˆæ”¾å¤§è‡³å¸¸è§„å¤§å° (2500ms)<br/>å¾ªç¯</td><td><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a67550ef404848ea9a391c446b672480~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgRmxpbnRvbg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769506265&amp;x-signature=HOSEpYPVKTv4OvqmZDrY7TvxOIk%3D" width="70%" loading="lazy"/></td></tr></tbody></table>
<h3 data-id="heading-1">æ€è€ƒä¸€ï¼šå¸ƒå±€çš„å¥å£®æ€§ â€”â€” ä¸ºä»€ä¹ˆä¸æ¨è marginï¼Ÿ</h3>
<p>æ‹¿åˆ°é¢˜ç›®ï¼Œç¬¬ä¸€æ­¥æ˜¯å¸ƒå±€ã€‚å¾ˆå¤šåˆå­¦è€…ä¹ æƒ¯ç”¨ <code>margin</code> æ¥æ§åˆ¶ä½ç½®ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* âŒ è„†å¼±çš„å¸ƒå±€å†™æ³• */</span>
<span class="hljs-selector-class">.circle</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">100px</span> auto; <span class="hljs-comment">/* ä¾èµ–å¤–éƒ¨å®¹å™¨é«˜åº¦ï¼Œä¸å¤Ÿçµæ´» */</span>
}
</code></pre>
<p>æˆ–è€…ç”¨ <code>calc</code> é…åˆ <code>margin-left</code> è´Ÿå€¼æ¥å±…ä¸­ã€‚è¿™äº›å†™æ³•åœ¨é™æ€é¡µé¢æ²¡é—®é¢˜ï¼Œä½†åœ¨åŠ¨ç”»åœºæ™¯ä¸‹ï¼Œä¸€æ—¦åœ†çš„å°ºå¯¸å‘ç”Ÿå˜åŒ–ï¼ˆæ¯”å¦‚å®½é«˜æ”¹å˜ï¼‰ï¼Œä¸­å¿ƒç‚¹å¾ˆå®¹æ˜“åç§»ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸‰ä¸ªç†ç”±ï¼š ç¬¬ä¸€ï¼Œ<strong>è„±ç¦»æ–‡æ¡£æµ</strong>ï¼Œé˜²æ­¢åŠ¨ç”»æ”¾å¤§æ—¶æ’‘å¼€é¡µé¢ï¼› ç¬¬äºŒï¼Œ<strong>è‡ªé€‚åº”å‚ç›´å±…ä¸­</strong>ï¼Œä¸ç”¨äººè‚‰è®¡ç®— margin-topï¼› ç¬¬ä¸‰ï¼Œ<strong>é”šå®šåœ†å¿ƒ</strong>ï¼Œç¡®ä¿å¤šå±‚åœ†åœˆåœ¨ç¼©æ”¾æ—¶ï¼Œåœ†å¿ƒæ°¸è¿œé‡åˆï¼Œä¸ä¼šè·‘åã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨åšåŠ¨æ•ˆç»„ä»¶æ—¶ï¼Œç»å¯¹å®šä½æ°¸è¿œæ˜¯é¦–é€‰ã€‚â€</p>
<p>âœ… æ¨èæ–¹æ¡ˆï¼šç»å¯¹å®šä½ + å˜æ¢</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-class">.center-abs</span> {
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>);
}
</code></pre>
<p><strong>è§£æï¼š</strong></p>
<ul>
<li><code>top/left: 50%</code>ï¼šå°†å…ƒç´ çš„<strong>å·¦ä¸Šè§’</strong>æ¨åˆ°å®¹å™¨ä¸­å¿ƒã€‚</li>
<li><code>translate(-50%, -50%)</code>ï¼šå°†å…ƒç´ <strong>è‡ªèº«</strong>å¾€å›æ‹‰ä¸€åŠã€‚</li>
<li><strong>ä¼˜åŠ¿ï¼š</strong> è¿™ç§å±…ä¸­æ–¹å¼å®Œå…¨ä¸ä¾èµ–å…ƒç´ çš„å…·ä½“å®½é«˜ã€‚æ— è®ºä½ æ€ä¹ˆç¼©æ”¾ï¼Œå®ƒçš„å‡ ä½•ä¸­å¿ƒæ°¸è¿œé”šå®šåœ¨çˆ¶å®¹å™¨çš„æ­£ä¸­å¿ƒã€‚</li>
</ul>
<h2 data-id="heading-2">æ€è€ƒäºŒï¼šæ¸²æŸ“æ€§èƒ½ â€”â€” ä¸ºä»€ä¹ˆå®æ„¿ç®— Scale ä¹Ÿä¸æ”¹ Widthï¼Ÿ</h2>
<p>è¿™é‡Œæ˜¯åŒºåˆ†â€œåˆçº§â€å’Œâ€œé«˜çº§â€çš„åˆ†æ°´å²­</p>
<p>éœ€æ±‚æ˜¯ï¼šå¤–åœˆä» 100px å˜å¤§åˆ° 110pxã€‚ ç›´è§‰å‘Šè¯‰æˆ‘ä»¬ï¼Œç›´æ¥æ”¹ <code>width</code> æœ€æ–¹ä¾¿ï¼š</p>
<pre><code class="hljs language-css" lang="css">âŒ æ€§èƒ½è¾ƒå·®çš„å†™æ³• */
<span class="hljs-keyword">@keyframes</span> expand {
    <span class="hljs-number">0%</span> { <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>; }
    <span class="hljs-number">50%</span> { <span class="hljs-attribute">width</span>: <span class="hljs-number">110px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">110px</span>; }
    <span class="hljs-number">100%</span> { <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>; }
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¯´å®ƒæ€§èƒ½å·®ï¼Ÿ</strong> è¿™æ¶‰åŠåˆ°äº†æµè§ˆå™¨çš„<strong>æ¸²æŸ“æµæ°´çº¿ï¼ˆRendering Pipelineï¼‰</strong> ã€‚</p>
<ul>
<li>
<p><strong>Layout (é‡æ’/å›æµ)ï¼š</strong> å½“ä½ æ”¹å˜ <code>width</code>ã€<code>height</code>ã€<code>margin</code> æ—¶ï¼Œæµè§ˆå™¨ä¼šæƒŠæåœ°å‘ç°ï¼šâ€œå¤©å‘ï¼Œå…ƒç´ çš„å¤§å°å˜äº†ï¼å®ƒä¼šä¸ä¼šæŒ¤åˆ°æ—è¾¹çš„å­—ï¼Ÿæˆ‘æ˜¯ä¸æ˜¯è¦é‡æ–°è®¡ç®—æ•´ä¸ªæ–‡æ¡£çš„å¸ƒå±€ï¼Ÿâ€è¿™ä¸ªè¿‡ç¨‹éå¸¸æ¶ˆè€— CPUã€‚</p>
</li>
<li>
<p><strong>Paint (é‡ç»˜)ï¼š</strong> å¸ƒå±€å˜äº†ï¼Œé¢œè‰²å¯èƒ½ä¹Ÿè¦é‡ç”»ã€‚</p>
</li>
<li>
<p><strong>Composite (åˆæˆ)ï¼š</strong> æœ€ååˆæˆå›¾å±‚ã€‚</p>
</li>
</ul>
<p>âœ… ä¼˜åŒ–æ–¹æ¡ˆï¼šä½¿ç”¨ Transform: Scale</p>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨ <code>transform: scale</code>ï¼Œæµè§ˆå™¨ä¼šæ„è¯†åˆ°ï¼šâ€œå“¦ï¼Œä½ åªæ˜¯æƒ³è§†è§‰ä¸Šæ”¾å¤§å®ƒï¼Œä¸éœ€è¦æ”¹å˜å®é™…å æ®çš„ç©ºé—´ã€‚â€</p>
<p>æ­¤æ—¶ï¼Œæµè§ˆå™¨ä¼šè·³è¿‡ Layout å’Œ Paintï¼Œç›´æ¥è¿›è¡Œ <strong>Composite</strong>ã€‚è¿™ä¸ªè¿‡ç¨‹é€šå¸¸ç”± <strong>GPUï¼ˆç¡¬ä»¶åŠ é€Ÿï¼‰</strong> å¤„ç†ï¼ŒåŠ¨ç”»ä¼šä¸èˆ¬é¡ºæ»‘ã€‚</p>
<p><strong>æ•°å­¦è®¡ç®—ï¼š</strong> æ—¢ç„¶ä¸èƒ½ç›´æ¥å†™ 110pxï¼Œæˆ‘ä»¬éœ€è¦ç®—å‡ºç¼©æ”¾æ¯”ä¾‹ï¼š</p>
<ul>
<li><strong>å¤–åœˆï¼š</strong> ç›®æ ‡ 110px / åŸå§‹ 100px = <strong>1.1 å€</strong></li>
<li><strong>å†…åœˆï¼š</strong> ç›®æ ‡ 48px / åŸå§‹ 60px = <strong>0.8 å€</strong></li>
</ul>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* âœ… æ€§èƒ½ä¼˜åŒ–çš„å†™æ³• */</span>
<span class="hljs-keyword">@keyframes</span> outer-move {
    <span class="hljs-number">0%</span>, <span class="hljs-number">100%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>); }
    <span class="hljs-number">50%</span>      { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.1</span>); }
}
</code></pre>
<p><strong>æ³¨æ„ï¼š</strong> è¿™é‡Œçš„ <code>transform</code> å¿…é¡»åŒ…å« <code>translate(-50%, -50%)</code>ï¼Œå¦åˆ™åŠ¨ç”»æ’­æ”¾æ—¶ï¼Œå…ƒç´ ä¼šå› ä¸ºè¦†ç›–äº†åŸæœ‰çš„ <code>transform</code> è€Œç¬é—´è·³å›éå±…ä¸­çŠ¶æ€ã€‚</p>
<h2 data-id="heading-3">æ€è€ƒä¸‰ï¼šäº¤äº’ä½“éªŒ â€”â€” è®©åŠ¨ç”»â€œæ´»â€è¿‡æ¥</h2>
<p>è§£å†³äº†æ€§èƒ½ï¼Œæœ€åä¸€æ­¥æ˜¯<strong>ä½“éªŒ</strong>ã€‚ å¾ˆå¤šå·¥ç¨‹å¸ˆå†™å‡ºæ¥çš„åŠ¨ç”»åƒæœºå™¨äººï¼Œæœºæ¢°ä¸”ç”Ÿç¡¬ã€‚é€šå¸¸æ˜¯å› ä¸ºå¿½ç•¥äº†ä¸¤ä¸ªå‚æ•°ï¼š<strong>Timing Functionï¼ˆæ—¶é—´æ›²çº¿ï¼‰</strong> å’Œ <strong>Staggerï¼ˆäº¤é”™æ„Ÿï¼‰</strong> ã€‚</p>
<ol>
<li><strong>æ‹’ç» Linearï¼š</strong> å‘¼å¸æ˜¯è‡ªç„¶çš„ç”Ÿç†è¿‡ç¨‹ï¼Œæœ‰å¸æ°”çš„æ€¥ä¿ƒå’Œå‘¼æ°”çš„å¹³ç¼“ã€‚ä½¿ç”¨ <code>linear</code>ï¼ˆåŒ€é€Ÿï¼‰ä¼šæ˜¾å¾—éå¸¸æ€ªå¼‚ã€‚æ¨èä½¿ç”¨ <code>ease-in-out</code>ï¼ˆæ…¢è¿›æ…¢å‡ºï¼‰ã€‚</li>
<li><strong>åˆ¶é€ æ—¶é—´å·®ï¼š</strong> å¦‚æœå¤–åœˆå’Œå†…åœˆå®Œå…¨åŒæ­¥ï¼ˆæ¯”å¦‚éƒ½æ˜¯ 2s ä¸€åœˆï¼‰ï¼Œç”»é¢ä¼šæ˜¾å¾—å•è°ƒã€‚ æˆ‘ä»¬å¯ä»¥è®©å¤–åœˆæ…¢ä¸€ç‚¹ï¼ˆ4sï¼‰ï¼Œå†…åœˆå¿«ä¸€ç‚¹ï¼ˆ5sï¼‰ã€‚</li>
</ol>
<ul>
<li>å¤–åœˆå‘¨æœŸï¼š4s (2s å˜å¤§ï¼Œ2s å˜å°)</li>
<li>å†…åœˆå‘¨æœŸï¼š5s (2.5s å˜å°ï¼Œ2.5s å˜å¤§)</li>
</ul>
<p>ç”±äº 4 å’Œ 5 çš„æœ€å°å…¬å€æ•°æ˜¯ 20ï¼Œè¿™æ„å‘³ç€è§‚ä¼—è¦çœ‹ 20ç§’ æ‰èƒ½çœ‹åˆ°ä¸€æ¬¡å®Œå…¨é‡å¤çš„ç”»é¢ï¼Œè¿™ç§<strong>é”™è½æ„Ÿ</strong>ä¼šè®©åŠ¨ç”»æ˜¾å¾—æ›´æœ‰ç”Ÿå‘½åŠ›ã€‚</p>
<h2 data-id="heading-4">æœ€ç»ˆä»£ç æ¸…å•</h2>
<p>ç»“åˆä»¥ä¸Šä¸‰ä¸ªæ€è€ƒï¼Œæˆ‘ä»¬å¾—åˆ°äº†è¿™ä»½æ—¢ä¼˜é›…åˆé«˜æ•ˆçš„ç­”å·ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>cssåŠ¨ç”»åŒå¿ƒåœ†<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
        <span class="hljs-selector-class">.box</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">300px</span>;
            <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#000</span>;
            <span class="hljs-attribute">position</span>: relative; <span class="hljs-comment">/* ç›¸å¯¹å®šä½åŸºå‡† */</span>
            <span class="hljs-attribute">overflow</span>: hidden; <span class="hljs-comment">/* é˜²æ­¢æœªæ¥åŠ¨ç”»å¢å¤§å€æ•°â€œæº¢å‡ºâ€äº‹æ•… */</span>
        }

        <span class="hljs-comment">/* æ€è€ƒä¸€ï¼šå¥å£®çš„å±…ä¸­ */</span>
        <span class="hljs-selector-class">.circle-outer</span>, <span class="hljs-selector-class">.circle-inner</span> {
            <span class="hljs-attribute">position</span>: absolute;
            <span class="hljs-attribute">top</span>: <span class="hljs-number">50%</span>;
            <span class="hljs-attribute">left</span>: <span class="hljs-number">50%</span>;
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>);
            <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
        }

        <span class="hljs-selector-class">.circle-outer</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">4px</span> solid <span class="hljs-number">#ccc</span>;

            <span class="hljs-comment">/* æ€è€ƒä¸‰ï¼šé”™å¼€æ—¶é—´èŠ‚å¥ */</span>
            <span class="hljs-attribute">animation</span>: outer-move <span class="hljs-number">4s</span> ease-in-out infinite;
        }

        <span class="hljs-selector-class">.circle-inner</span> {
            <span class="hljs-attribute">width</span>: <span class="hljs-number">60px</span>; <span class="hljs-attribute">height</span>: <span class="hljs-number">60px</span>;
            <span class="hljs-attribute">border</span>: <span class="hljs-number">4px</span> solid <span class="hljs-number">#fff</span>;

            <span class="hljs-comment">/* æ€è€ƒä¸‰ï¼šé”™å¼€æ—¶é—´èŠ‚å¥ */</span>
            <span class="hljs-attribute">animation</span>: inner-move <span class="hljs-number">5s</span> ease-in-out infinite;
        }

        <span class="hljs-selector-class">.text</span> {
            <span class="hljs-attribute">position</span>: absolute;
            <span class="hljs-attribute">bottom</span>: <span class="hljs-number">40px</span>;
            <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
            <span class="hljs-attribute">text-align</span>: center;
            <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
        }

        <span class="hljs-comment">/* æ€è€ƒäºŒï¼šScale ä¼˜åŒ–æ€§èƒ½ */</span>
        <span class="hljs-keyword">@keyframes</span> outer-move {
            <span class="hljs-number">0%</span>,<span class="hljs-number">100%</span>  { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>) }
            <span class="hljs-number">50%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.1</span>) } <span class="hljs-comment">/* 100px -&gt; 110px */</span>
        }

        <span class="hljs-keyword">@keyframes</span> inner-move {
            <span class="hljs-number">0%</span>,<span class="hljs-number">100%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">1</span>) } 
            <span class="hljs-number">50%</span> { <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translate</span>(-<span class="hljs-number">50%</span>, -<span class="hljs-number">50%</span>) <span class="hljs-built_in">scale</span>(<span class="hljs-number">0.8</span>) } <span class="hljs-comment">/* 60px -&gt; 48px */</span>
        }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"circle-outer "</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"circle-inner "</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text"</span>&gt;</span>Hi<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h2 data-id="heading-5">æ€»ç»“</h2>
<p>å½“æˆ‘ä»¬è°ˆè®ºâ€œCSS è¿›é˜¶â€æ—¶ï¼Œå¾€å¾€ä¸æ˜¯æŒ‡è®°ä½äº†å¤šå°‘åé—¨çš„å±æ€§ï¼Œè€Œæ˜¯æŒ‡<strong>åœ¨ç®€å•çš„åœºæ™¯ä¸‹ï¼Œèƒ½å¦åšå‡ºæœ€ä¼˜çš„æŠ€æœ¯é€‰æ‹©</strong>ã€‚</p>
<p>é€šè¿‡è¿™é“é¢˜ï¼Œæˆ‘ä»¬çŸ¥é“äº†ï¼š</p>
<ol>
<li><code>translate</code> å±…ä¸­çš„åŸç†ã€‚</li>
<li><strong>Reflowï¼ˆé‡æ’ï¼‰</strong> ä¸ <strong>Compositeï¼ˆåˆæˆï¼‰</strong> å¯¹æ€§èƒ½çš„å½±å“ã€‚</li>
<li>åŠ¨ç”»æ›²çº¿ä¸èŠ‚å¥å¯¹ç”¨æˆ·ä½“éªŒçš„å¾®è°ƒã€‚</li>
</ol>
<p>å¸Œæœ›ä½ åœ¨èŒä¸šç”Ÿæ¶¯ä¸­é‡åˆ° CSS åŠ¨ç”»é¢˜ï¼Œä½ ä¹Ÿèƒ½è‡ªä¿¡åœ°å¯¹é¢è¯•å®˜è¯´ï¼šâ€œä¸ºäº†æ€§èƒ½ï¼Œæˆ‘é€‰æ‹©ç”¨ Scaleã€‚â€ æ„Ÿè°¢å¤§å®¶çš„æ”¯æŒå’Œé¼“åŠ±ï¼Œä¸€èµ·åŠ æ²¹ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç”¨ Intersection Observer æ‰“é€ ä¸æ»‘çš„çº§è”æ»šåŠ¨åŠ¨ç”»]]></title>    <link>https://juejin.cn/post/7597199288817893416</link>    <guid>https://juejin.cn/post/7597199288817893416</guid>    <pubDate>2026-01-20T09:49:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597199288817893416" data-draft-id="7597199288817844264" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç”¨ Intersection Observer æ‰“é€ ä¸æ»‘çš„çº§è”æ»šåŠ¨åŠ¨ç”»"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-20T09:49:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é˜¿æ˜Drift"/> <meta itemprop="url" content="https://juejin.cn/user/3667626522083448"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç”¨ Intersection Observer æ‰“é€ ä¸æ»‘çš„çº§è”æ»šåŠ¨åŠ¨ç”»
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3667626522083448/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é˜¿æ˜Drift
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T09:49:33.000Z" title="Tue Jan 20 2026 09:49:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style>
<blockquote>
<p><strong>æ— éœ€ä»»ä½•åŠ¨ç”»åº“ï¼Œä»…ç”¨åŸç”Ÿ Web API å®ç°æ»šåŠ¨æ—¶ä¸æ»‘çš„æ·¡å…¥æ»‘å…¥æ•ˆæœï¼Œå…¼é¡¾æ€§èƒ½ä¸ä½“éªŒã€‚</strong></p>
</blockquote>
<p>ä½ æ˜¯å¦è§è¿‡è¿™æ ·çš„äº¤äº’åŠ¨æ•ˆï¼š</p>
<ul>
<li>ç”¨æˆ·æ»šåŠ¨é¡µé¢æ—¶ï¼Œä¸€ç»„å¡ç‰‡åƒè¢«â€œå”¤é†’â€ä¸€æ ·ï¼Œä¾æ¬¡ä»ä¸‹æ–¹æ»‘å…¥å¹¶æ·¡å…¥ï¼›</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b26051b1c1f4b51802b52e1ad05c8d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5piORHJpZnQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769507373&amp;x-signature=XSpn%2B3H7hUy8fIEfw8BYtJJ7RrU%3D" alt="æ»šåŠ¨è§¦å‘åŠ¨ç”»ç¤ºä¾‹" loading="lazy"/></p>
<ul>
<li>å¦‚æœè¿™äº›å…ƒç´ åœ¨é¡µé¢åŠ è½½æ—¶å·²åœ¨è§†å£å†…ï¼Œå®ƒä»¬ä¹Ÿä¼šè‡ªåŠ¨æŒ‰é¡ºåºæµ®ç°ã€‚</li>
</ul>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8e75c15aba94f87a79a0cd8c57a8a1c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zi_5piORHJpZnQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769507373&amp;x-signature=ldHqAFAOEgpVL%2Bao9ymITxZ%2F5EM%3D" alt="åˆå§‹åŠ è½½åŠ¨ç”»ç¤ºä¾‹" loading="lazy"/></p>
<p>è¿™ç§æ•ˆæœä¸ä»…è§†è§‰æµç•…ï¼Œè¿˜èƒ½æœ‰æ•ˆå¼•å¯¼ç”¨æˆ·æ³¨æ„åŠ›ï¼Œæå‡å†…å®¹å±‚æ¬¡æ„Ÿã€‚æ›´é‡è¦çš„æ˜¯â€”â€”<strong>å®ƒä¸ä¾èµ– GSAPã€AOS ç­‰ç¬¬ä¸‰æ–¹åº“</strong>ï¼Œä»…é  <code>Intersection Observer</code> + <code>CSS åŠ¨ç”»</code> + å°‘é‡ JavaScriptï¼Œå°±èƒ½å®ç°<strong>é«˜æ€§èƒ½ã€å¯è®¿é—®ã€ä¸”é«˜åº¦å¯æ§</strong>çš„æ»šåŠ¨è§¦å‘å‹çº§è”åŠ¨ç”»ã€‚</p>
<p>ä»Šå¤©ï¼Œæˆ‘ä»¬å°±æ¥ä¸€æ­¥æ­¥æ‹†è§£è¿™ä¸ªç»å…¸åŠ¨æ•ˆï¼Œå¹¶ç»™å‡ºä¸€å¥—<strong>å¯ç›´æ¥å¤ç”¨çš„è½»é‡çº§æ–¹æ¡ˆ</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-0">ğŸ”§ æ ¸å¿ƒåŸç†æ¦‚è§ˆ</h2>
<p>æ•´ä¸ªåŠ¨ç”»ç³»ç»Ÿä¾èµ–ä¸‰ä¸ªå…³é”®æŠ€æœ¯ç‚¹ï¼š</p>





















<table><thead><tr><th>æŠ€æœ¯</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>IntersectionObserver</code></td><td>ç›‘å¬å…ƒç´ æ˜¯å¦è¿›å…¥è§†å£ï¼Œé¿å…é¢‘ç¹ scroll äº‹ä»¶</td></tr><tr><td>CSS <code>@keyframes</code></td><td>å®šä¹‰æ»‘å…¥ + æ·¡å…¥åŠ¨ç”»</td></tr><tr><td><code>--animation-order</code> è‡ªå®šä¹‰å±æ€§</td><td>é€šè¿‡ <code>calc()</code> åŠ¨æ€è®¾ç½® <code>animation-delay</code>ï¼Œå®ç°â€œé€ä¸ªå»¶è¿Ÿâ€çš„çº§è”æ„Ÿ</td></tr></tbody></table>
<p>æœ€å…³é”®çš„è®¾è®¡å“²å­¦æ˜¯ï¼š<strong>åŠ¨ç”»åªåœ¨ç”¨æˆ·èƒ½çœ‹åˆ°å®ƒçš„æ—¶å€™æ‰æ‰§è¡Œ</strong>ï¼Œæ—¢èŠ‚çœæ€§èƒ½ï¼Œåˆé¿å…â€œé—ªç°â€ã€‚</p>
<hr/>
<h2 data-id="heading-1">ğŸ§± HTML ç»“æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰</h2>
<p>ä¸ºä¾¿äºç†è§£ï¼Œæˆ‘ä»¬å‰¥ç¦»ä¸šåŠ¡é€»è¾‘ï¼Œåªä¿ç•™åŠ¨æ•ˆæ ¸å¿ƒï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card-list"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card scroll-trigger animate--slide-in"</span> <span class="hljs-attr">data-cascade</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"--animation-order: 1;"</span>
            &gt;</span>Card 1&lt;/li
        &gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card scroll-trigger animate--slide-in"</span> <span class="hljs-attr">data-cascade</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"--animation-order: 2;"</span>
            &gt;</span>Card 2&lt;/li
        &gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"card scroll-trigger animate--slide-in"</span> <span class="hljs-attr">data-cascade</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"--animation-order: 3;"</span>
            &gt;</span>Card 3&lt;/li
        &gt;
        <span class="hljs-comment">&lt;!-- æ›´å¤šå¡ç‰‡... --&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<h3 data-id="heading-2">ğŸ’¡ ç±»åä¸å±æ€§è¯´æ˜</h3>
<ul>
<li><code>.scroll-trigger</code>ï¼šè¡¨ç¤ºè¯¥å…ƒç´ éœ€è¦è¢«æ»šåŠ¨ç›‘å¬ï¼›</li>
<li><code>.animate--slide-in</code>ï¼šå¯ç”¨æ»‘å…¥åŠ¨ç”»ï¼›</li>
<li><code>data-cascade</code>ï¼šJS è¯†åˆ«â€œéœ€è®¾ç½®åŠ¨ç”»é¡ºåºâ€çš„æ ‡å¿—ï¼›</li>
<li><code>--animation-order</code>ï¼šCSS è‡ªå®šä¹‰å±æ€§ï¼Œç”¨äºè®¡ç®—å»¶è¿Ÿæ—¶é—´ï¼ˆå¦‚ç¬¬ 2 ä¸ªå…ƒç´ å»¶è¿Ÿ 150msï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">ğŸ¨ CSS åŠ¨ç”»å®šä¹‰</h2>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-pseudo">:root</span> {
    <span class="hljs-attr">--duration-extra-long</span>: <span class="hljs-number">600ms</span>;
    <span class="hljs-attr">--ease-out-slow</span>: <span class="hljs-built_in">cubic-bezier</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.3</span>, <span class="hljs-number">1</span>);
}

<span class="hljs-comment">/* ä»…åœ¨ç”¨æˆ·æœªå¼€å¯â€œå‡å°‘è¿åŠ¨â€æ—¶å¯ç”¨åŠ¨ç”»ï¼ˆæ™•åŠ¨ç—‡ç”¨æˆ·å‹å¥½ï¼‰ */</span>
<span class="hljs-keyword">@media</span> (<span class="hljs-attribute">prefers-reduced-motion</span>: no-preference) {
    <span class="hljs-selector-class">.scroll-trigger</span><span class="hljs-selector-pseudo">:not</span>(<span class="hljs-selector-class">.scroll-trigger--offscreen</span>)<span class="hljs-selector-class">.animate--slide-in</span> {
        <span class="hljs-attribute">animation</span>: slideIn <span class="hljs-built_in">var</span>(--duration-extra-long) <span class="hljs-built_in">var</span>(--ease-out-slow) forwards;
        <span class="hljs-attribute">animation-delay</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-built_in">var</span>(--animation-order) * <span class="hljs-number">75ms</span>);
    }

    <span class="hljs-keyword">@keyframes</span> slideIn {
        <span class="hljs-selector-tag">from</span> {
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">2rem</span>);
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.01</span>;
        }
        <span class="hljs-selector-tag">to</span> {
            <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(<span class="hljs-number">0</span>);
            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
        }
    }
}
</code></pre>
<h3 data-id="heading-4">âœ¨ å‚æ•°è¯´æ˜</h3>






























<table><thead><tr><th>å±æ€§</th><th>å€¼</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td><code>transform</code></td><td><code>translateY(2rem) â†’ 0</code></td><td>ç”±ä¸‹å¾€ä¸Šæ»‘å…¥</td></tr><tr><td><code>opacity</code></td><td><code>0.01 â†’ 1</code></td><td>æ·¡å…¥ï¼ˆé¿å…å®Œå…¨é€æ˜å¯¼è‡´å¸ƒå±€è·³åŠ¨ï¼‰</td></tr><tr><td><code>animation-delay</code></td><td><code>n Ã— 75ms</code></td><td>ç¬¬1ä¸ªå»¶è¿Ÿ75msï¼Œç¬¬2ä¸ª150msâ€¦â€¦å½¢æˆçº§è”</td></tr><tr><td><code>animation-fill-mode</code></td><td><code>forwards</code></td><td>åŠ¨ç”»ç»“æŸåä¿æŒæœ€ç»ˆçŠ¶æ€</td></tr></tbody></table>
<blockquote>
<p>âœ… <strong>æ— éšœç¢æç¤º</strong>ï¼šé€šè¿‡ <code>@media (prefers-reduced-motion)</code> å°Šé‡ç”¨æˆ·åå¥½ï¼Œå¯¹æ™•åŠ¨ç—‡ç”¨æˆ·æ›´å‹å¥½ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ğŸ•µï¸ JavaScriptï¼šIntersection Observer ç›‘å¬é€»è¾‘</h2>
<h3 data-id="heading-6">ä¸ºä»€ä¹ˆä¸ç”¨ <code>scroll</code> äº‹ä»¶ï¼Ÿ</h3>
<p>ä¼ ç»Ÿæ–¹å¼ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// âŒ æ€§èƒ½å·®ï¼Œé¢‘ç¹è§¦å‘</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'scroll'</span>, checkVisibility);
</code></pre>
<p>ç°ä»£æ–¹æ¡ˆï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// âœ… é«˜æ€§èƒ½ï¼Œæµè§ˆå™¨åº•å±‚ä¼˜åŒ–</span>
<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(callback, options);
</code></pre>
<h3 data-id="heading-7">å®Œæ•´ç›‘å¬é€»è¾‘</h3>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SCROLL_ANIMATION_TRIGGER_CLASSNAME</span> = <span class="hljs-string">'scroll-trigger'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">SCROLL_ANIMATION_OFFSCREEN_CLASSNAME</span> = <span class="hljs-string">'scroll-trigger--offscreen'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">onIntersection</span>(<span class="hljs-params">entries, observer</span>) {
    entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">entry, index</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> el = entry.<span class="hljs-property">target</span>;

        <span class="hljs-keyword">if</span> (entry.<span class="hljs-property">isIntersecting</span>) {
            <span class="hljs-comment">// è¿›å…¥è§†å£ï¼šç§»é™¤ offscreen ç±»ï¼Œå…è®¸åŠ¨ç”»æ’­æ”¾</span>
            el.<span class="hljs-property">classList</span>.<span class="hljs-title function_">remove</span>(<span class="hljs-variable constant_">SCROLL_ANIMATION_OFFSCREEN_CLASSNAME</span>);

            <span class="hljs-comment">// è‹¥ä¸ºçº§è”å…ƒç´ ï¼ŒåŠ¨æ€è®¾ç½®é¡ºåºï¼ˆå…œåº•ï¼‰</span>
            <span class="hljs-keyword">if</span> (el.<span class="hljs-title function_">hasAttribute</span>(<span class="hljs-string">'data-cascade'</span>)) {
                el.<span class="hljs-property">style</span>.<span class="hljs-title function_">setProperty</span>(<span class="hljs-string">'--animation-order'</span>, index + <span class="hljs-number">1</span>);
            }

            <span class="hljs-comment">// åªè§¦å‘ä¸€æ¬¡ï¼Œåœæ­¢ç›‘å¬</span>
            observer.<span class="hljs-title function_">unobserve</span>(el);
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// ç¦»å¼€è§†å£ï¼šåŠ ä¸Š offscreen ç±»ï¼Œç¦ç”¨åŠ¨ç”»</span>
            el.<span class="hljs-property">classList</span>.<span class="hljs-title function_">add</span>(<span class="hljs-variable constant_">SCROLL_ANIMATION_OFFSCREEN_CLASSNAME</span>);
        }
    });
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">initScrollAnimations</span>(<span class="hljs-params">root = <span class="hljs-variable language_">document</span></span>) {
    <span class="hljs-keyword">const</span> triggers = root.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">`.<span class="hljs-subst">${SCROLL_ANIMATION_TRIGGER_CLASSNAME}</span>`</span>);
    <span class="hljs-keyword">if</span> (!triggers.<span class="hljs-property">length</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IntersectionObserver</span>(onIntersection, {
        <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">'0px 0px -50px 0px'</span>, <span class="hljs-comment">// å…ƒç´ è¿›å…¥è§†å£ 50px åæ‰è§¦å‘</span>
        <span class="hljs-attr">threshold</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0.25</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0.75</span>, <span class="hljs-number">1.0</span>],
    });

    triggers.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">el</span>) =&gt;</span> observer.<span class="hljs-title function_">observe</span>(el));
}

<span class="hljs-comment">// é¡µé¢åŠ è½½å®Œæˆåå¯åŠ¨</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">initScrollAnimations</span>();
});
</code></pre>
<h3 data-id="heading-8">ğŸ¯ å…³é”®è®¾è®¡ç»†èŠ‚</h3>
<ul>
<li><code>rootMargin: '0px 0px -50px 0px'</code>ï¼šç¡®ä¿å…ƒç´ <strong>å®Œå…¨è¿›å…¥ç”¨æˆ·è§†é‡åå†è§¦å‘åŠ¨ç”»</strong>ï¼Œé¿å…â€œåˆšçœ‹åˆ°å°±ç»“æŸâ€ï¼›</li>
<li>åˆå§‹æ‰€æœ‰ <code>.scroll-trigger</code> å…ƒç´ é»˜è®¤å¸¦æœ‰ <code>.scroll-trigger--offscreen</code> ç±»ï¼Œé˜»æ­¢ CSS åŠ¨ç”»ç”Ÿæ•ˆï¼›</li>
<li><code>unobserve</code>ï¼šåŠ¨ç”»åªæ’­æ”¾ä¸€æ¬¡ï¼Œé¿å…é‡å¤è§¦å‘ï¼ŒèŠ‚çœèµ„æºã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-9">ğŸ“Š ä¸¤ç§åœºæ™¯ä¸‹çš„è¡Œä¸ºå¯¹æ¯”</h2>























<table><thead><tr><th>åœºæ™¯</th><th>åˆå§‹çŠ¶æ€</th><th>è§¦å‘æ—¶æœº</th><th>åŠ¨ç”»è¡¨ç°</th></tr></thead><tbody><tr><td>å¡ç‰‡å·²åœ¨è§†å£å†…</td><td>æ—  <code>--offscreen</code> ç±»</td><td>é¡µé¢åŠ è½½åç«‹å³</td><td>ä¾æ¬¡æ·¡å…¥ï¼ˆåŸºäº <code>--animation-order</code>ï¼‰</td></tr><tr><td>å¡ç‰‡åœ¨è§†å£å¤–</td><td>æœ‰ <code>--offscreen</code> ç±»</td><td>æ»šåŠ¨åˆ°è§†å£ï¼ˆè¶…è¿‡ 50pxï¼‰</td><td>æ»šåŠ¨æ—¶ä¾æ¬¡æ·¡å…¥</td></tr></tbody></table>
<p>è¿™æ­£æ˜¯ä½ æ„Ÿå—åˆ°çš„â€œä¸æ»‘æ„Ÿâ€æ¥æºï¼š<strong>æ— è®ºç”¨æˆ·å¦‚ä½•è¿›å…¥é¡µé¢ï¼ŒåŠ¨ç”»æ€»æ˜¯åœ¨æœ€åˆé€‚çš„æ—¶æœºå‡ºç°</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-10">ğŸ’¡ æ€»ç»“ï¼šè¿™å¥—æ–¹æ¡ˆçš„ä¼˜åŠ¿</h2>





























<table><thead><tr><th>èƒ½åŠ›</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>âœ… <strong>é«˜æ€§èƒ½</strong></td><td>ä½¿ç”¨ <code>IntersectionObserver</code> æ›¿ä»£ <code>scroll</code> äº‹ä»¶ï¼Œé¿å…é¢‘ç¹è®¡ç®—</td></tr><tr><td>âœ… <strong>ç²¾å‡†æ§åˆ¶</strong></td><td>é€šè¿‡ <code>rootMargin</code> å’Œ <code>threshold</code> çµæ´»è°ƒæ•´è§¦å‘æ—¶æœº</td></tr><tr><td>âœ… <strong>æ— éšœç¢å‹å¥½</strong></td><td>å°Šé‡ <code>prefers-reduced-motion</code> ç”¨æˆ·åå¥½</td></tr><tr><td>âœ… <strong>è½»é‡å¯å¤ç”¨</strong></td><td>æ— ä¾èµ–ï¼Œä»… 50 è¡Œ JS + ç®€æ´ CSSï¼Œé€‚åˆåµŒå…¥ä»»ä½•é¡¹ç›®</td></tr><tr><td>âœ… <strong>æ‡’åŠ è½½å…¼å®¹</strong></td><td>å¯æ‰©å±•ç”¨äºå›¾ç‰‡æ‡’åŠ è½½ã€å¹¿å‘Šæ›å…‰ç»Ÿè®¡ç­‰åœºæ™¯</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-11">é™„</h2>
<p>å®Œæ•´ Demo å·²ä¸Šä¼  CodePenï¼š<br/>
ğŸ‘‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Fcodepen.io%2FAMingDrift%2Fpen%2FZYOKxVp" target="_blank" title="https://codepen.io/AMingDrift/pen/ZYOKxVp" ref="nofollow noopener noreferrer">codepen.io/AMingDrift/â€¦</a></p>
<p>å¦‚æœä½ æ­£åœ¨å¼€å‘ç”µå•†ã€åšå®¢ã€SaaS äº§å“é¡µç­‰å†…å®¹å¯†é›†å‹ç½‘ç«™ï¼Œä¸å¦¨å°†è¿™å¥—æ–¹æ¡ˆé›†æˆè¿›å»ï¼Œç»™ç”¨æˆ·å¸¦æ¥æ›´ä¼˜é›…çš„æµè§ˆä½“éªŒï¼</p>
<hr/>
<blockquote>
<p><strong>å­¦ä¹ ä¼˜ç§€ä½œå“ï¼Œæ˜¯æå‡æŠ€æœ¯çš„æœ€ä½³è·¯å¾„</strong>ã€‚æœ¬æ–‡æ—¢æ˜¯æˆ‘çš„å­¦ä¹ ç¬”è®°ï¼Œä¹Ÿå¸Œæœ›å¯¹ä½ æœ‰æ‰€å¯å‘ã€‚</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‘ç°äº†GitHub ä¸Š 3 ä¸ª Claude Cowork çš„å¼€æºå¹³æ›¿ã€‚]]></title>    <link>https://juejin.cn/post/7597250364124102719</link>    <guid>https://juejin.cn/post/7597250364124102719</guid>    <pubDate>2026-01-20T08:27:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597250364124102719" data-draft-id="7597230546239717412" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‘ç°äº†GitHub ä¸Š 3 ä¸ª Claude Cowork çš„å¼€æºå¹³æ›¿ã€‚"/> <meta itemprop="keywords" content="GitHub"/> <meta itemprop="datePublished" content="2026-01-20T08:27:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€›é€›GitHub"/> <meta itemprop="url" content="https://juejin.cn/user/1442202996186093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‘ç°äº†GitHub ä¸Š 3 ä¸ª Claude Cowork çš„å¼€æºå¹³æ›¿ã€‚
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1442202996186093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€›é€›GitHub
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:27:03.000Z" title="Tue Jan 20 2026 08:27:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>Claude Cowork</strong>Â æ˜¯ Anthropic æ¨çš„ä¸€ä¸ª<strong>æ–°åŠŸèƒ½</strong>ï¼Œå®ƒè®© Claude å˜æˆä¸€ä¸ªèƒ½æ“ä½œä½ ç”µè„‘æ–‡ä»¶çš„ AI Agent ã€‚</p>
<p>Cowork ä¸ä»…ä»…æ˜¯é™ªä½ èŠå¤©ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥åœ¨ä½ æˆæƒçš„ç”µè„‘æ–‡ä»¶å¤¹ä¸­åšä¸€äº›æ–‡ä»¶å¤„ç†ã€‚</p>
<p><strong>ç”¨å®ƒèƒ½åšæ–‡ä»¶æ•´ç†ã€æ•°æ®æå–ä¸è½¬æ¢ã€æ‰¹é‡æ–‡æ¡£å¤„ç†ã€ä»£ç /è„šæœ¬è¾…åŠ©å•¥çš„ã€‚</strong></p>
<p><strong>è€Œä¸”ä¸æ™®é€šçš„ä¸€é—®ä¸€ç­”ä¸åŒï¼Œå½“ä½ ç»™ Cowork ä¸‹è¾¾ä¸€ä¸ªå¤æ‚æŒ‡ä»¤çš„æ—¶å€™ï¼Œå®ƒä¼šå…ˆ</strong>åˆ¶å®šä¸€ä¸ªè®¡åˆ’**ï¼Œç„¶åä¸€æ­¥æ­¥æ‰§è¡Œï¼Œå¹¶åœ¨å…³é”®æ­¥éª¤å‘ä½ ç¡®è®¤æˆ–æ±‡æŠ¥è¿›åº¦ã€‚</p>
<p><strong>å®ƒä¸éœ€è¦ä½ ä¸€ç›´ç›¯ç€ï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†ä»»åŠ¡ã€‚</strong></p>
<p>ä¸€èˆ¬æœ‰ä»€ä¹ˆæ–°ä¸œè¥¿å‡ºæ¥ï¼ŒGitHub ä¸Šä¸€å®šä¼šå¼€æºå¹³æ›¿çš„ã€‚é€›é€›å°±æ‰¾åˆ°æœ€è¿‘å¾ˆç«çš„ 3 ä¸ªÂ Claude Cowork å¼€æºå¹³æ›¿ã€‚</p>
<p>01</p>
<p><strong>æ¡Œé¢çº§å¤šæ™ºèƒ½ä½“å¹³å°ï¼šEigent</strong></p>
<p>ç›®å‰è¿™ä¸ªå« eigent çš„å¼€æºé¡¹ç›®å·²ç»ç™»ä¸Šäº† GitHub çš„çƒ­æ¦œã€‚</p>
<p>ç°åœ¨å·²ç»è·å¾— 7800+ çš„æ˜Ÿæ˜Ÿäº†ï¼Œè¿˜æ˜¯æ¯”è¾ƒç«çš„ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/842a65a59a4f4d37b08b16d66693b845~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769502422&amp;x-signature=f0htg6K0rvJYKfqyLYooibBFQy8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®çš„å›¢é˜Ÿæ˜¯å¤šæ™ºèƒ½ä½“ï¼ˆMulti-Agentï¼‰åä½œï¼Œç”¨å®ƒä½ èƒ½ç»„å»ºä¸€æ”¯ AI å‘˜å·¥å›¢é˜Ÿï¼Œè‡ªåŠ¨åä½œå®Œæˆå¤æ‚çš„ä»»åŠ¡ã€‚</p>
<p>å®ƒèƒ½æŠŠå¤æ‚çš„ä»»åŠ¡æ‹†è§£ï¼Œåˆ†å‘ç»™ä¸åŒçš„ AI å‘˜å·¥å¹¶è¡Œå¤„ç†ã€‚ç”¨å®ƒä½ å¯ä»¥è¯»å–æœ¬åœ° excel ç”Ÿæˆæ•°æ®åˆ†ææŠ¥å‘Šã€æ•´ç†æœ¬åœ°æ–‡ä»¶ï¼Œæ¯”å¦‚æ‰¹é‡é‡å‘½åã€åˆ é™¤é‡å¤æ–‡ä»¶ç­‰ç­‰ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b72896d6a984249aec10e648d9f67ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769502422&amp;x-signature=fywvMmQBSYSmAAwafeX4tLtfIxA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç³»ç»Ÿé¢„å®šä¹‰äº†å¤šç§è§’è‰²çš„ Agentï¼Œè¿˜å†…ç½®äº†å¤§é‡çš„Â MCP å·¥å…·ï¼Œèƒ½å¤Ÿè®© AI ç›´æ¥æ“ä½œå¤–éƒ¨å·¥å…·å’ŒæœåŠ¡ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/eigent-ai/eigent</span>
</code></pre>
<p>02</p>
<p><strong>æ¡Œé¢çº§ AI Agent åŠå…¬ï¼šopenwork</strong></p>
<p>OpenWork å¼€æºé¡¹ç›®çš„ç›®æ ‡æ˜¯æ‰“é€ ä¸€ä¸ªå¼€æºç‰ˆçš„ Claude Coworkï¼Œè®©å¤æ‚çš„ Agent ä»»åŠ¡å˜æˆåƒä½¿ç”¨æ™®é€šè½¯ä»¶ä¸€æ ·ç®€å•ã€‚</p>
<p>å®ƒç”± OpenCode é©±åŠ¨ï¼Œè®©æ™ºèƒ½ä½“å·¥ä½œæ„Ÿè§‰åƒæ˜¯åœ¨ä½¿ç”¨ä¸€ä¸ªæˆç†Ÿçš„äº§å“ï¼Œè€Œä¸æ˜¯åœ¨æ“ä½œå†°å†·çš„ç»ˆç«¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0146ade9d344a68be062f19914aa519~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769502422&amp;x-signature=ydDKwXiBhpalBwZZl69GUvsKf7s%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>ç”¨ OpenWork ä½ ä¸éœ€è¦å­¦ä¹ å¤æ‚çš„ CLI æŒ‡ä»¤ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒé…ç½®æ»¡å¤©é£ã€‚</p>
<p>å®ƒå°† AI çš„æ€è€ƒå’Œæ‰§è¡Œè¿‡ç¨‹å˜æˆäº†æ¸…æ™°çš„æ—¶é—´çº¿å’Œå¾…åŠäº‹é¡¹ï¼Œä½ å¯ä»¥å®æ—¶çœ‹åˆ° AI æ‰“ç®—å¹²ä»€ä¹ˆï¼Œå¹²åˆ°äº†å“ªä¸€æ­¥ã€‚</p>
<p>å®ƒæœ‰ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼š</p>
<p>Host Modeï¼šç›´æ¥åœ¨æœ¬åœ°å¯åŠ¨ OpenCode æœåŠ¡ï¼Œé€‰æ‹©ä¸€ä¸ªæ–‡ä»¶å¤¹ä½œä¸ºå·¥ä½œåŒºï¼ŒAI å°±åœ¨ä½ çœ¼çš®åº•ä¸‹å¸®ä½ å¹²æ´»ã€‚</p>
<p>Client Modeï¼šå¦‚æœä½ æœ‰ä¸€ä¸ªè¿œç¨‹çš„ OpenCode æœåŠ¡å™¨ï¼ŒOpenWork ä¹Ÿå¯ä»¥é€šè¿‡ URL è¿æ¥ä¸Šå»ï¼Œå®ç°è¿œç¨‹åŠå…¬ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b778f7cf00334074a57e5a00f1c88655~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769502422&amp;x-signature=2w8YtVOxsGcWQcfqL4K8e%2BBM8V8%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>OpenWork å†…ç½®äº†Â SkillÂ <strong>ç®¡ç†å™¨</strong>ã€‚ä½ å¯ä»¥åƒç»™æµè§ˆå™¨è£…æ’ä»¶ä¸€æ ·ï¼Œç»™ä½ çš„ AI Agent å®‰è£…å„ç§ Skillsã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0630e04d93a5426e89cf6b0261fb2d19~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769502422&amp;x-signature=Pc3qmyPqBszcqdXQEUnT%2FbiKDZA%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p><strong>å¯¹äºé‚£äº›é‡å¤æ€§çš„å·¥ä½œæµï¼Œä½ å¯ä»¥å°†å®ƒä»¬ä¿å­˜ä¸ºæ¨¡æ¿ã€‚ä¸‹æ¬¡å†é‡åˆ°åŒæ ·çš„ä¸€å¥—ä»»åŠ¡ï¼Œä¸€é”®è½½å…¥ AI è‡ªåŠ¨æ‰§è¡Œï¼Œæå¤§æå‡æ•ˆç‡ã€‚</strong></p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/different-ai/openwork</span>
</code></pre>
<p>03</p>
<p><strong>Claude-Cowork</strong></p>
<p>è¿™ä¸ªå¼€æºé¡¹ç›®æŠŠ Claude Code å¼ºå¤§çš„ Agent èƒ½åŠ›å°è£…è¿›äº†ä¸€ä¸ªå¯è§†åŒ–æ“ä½œç•Œé¢é‡Œã€‚</p>
<p>å¦‚æœ Claude Code èƒ½åœ¨ä½ çš„ç»ˆç«¯é‡Œè¿è¡Œï¼Œé‚£ä¹ˆå®ƒå°±èƒ½åœ¨ Claude-Cowork é‡Œè¿è¡Œã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6bd18c637cd2401289d4946c7c93b4ff~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCb6YCbR2l0SHVi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769502422&amp;x-signature=2NsiPQhTIjIHY0oGyl8UtGYRk6s%3D" alt="å›¾ç‰‡" loading="lazy"/></p>
<p>Claude Code åŸç”Ÿåªæœ‰é»‘ä¹ä¹çš„å‘½ä»¤è¡Œï¼ŒæŠŠå®ƒå°è£…æˆ Claude CoworkÂ æœ‰ä¸€äº›å¥½å¤„ï¼š</p>
<p>Claude Cowork æä¾›äº†æµå¼è¾“å‡ºå’Œ Markdown æ¸²æŸ“ï¼Œä½ å¯ä»¥æ¸…æ™°åœ°çœ‹åˆ° Claude çš„æ€è€ƒè·¯å¾„ã€ä»£ç é«˜äº®ä»¥åŠå…·ä½“çš„å·¥å…·è°ƒç”¨çŠ¶æ€ã€‚</p>
<p>Claude-Cowork å†…ç½®äº†åŸºäº SQLite çš„ä¼šè¯ç®¡ç†ç³»ç»Ÿã€‚ä½ å¯ä»¥åˆ›å»ºä¸åŒçš„ä¼šè¯ï¼Œé’ˆå¯¹ä¸åŒçš„é¡¹ç›®æˆ–ä»»åŠ¡è®¾å®šç‹¬ç«‹çš„å·¥ä½œç›®å½•ï¼Œå¹¶ä¸”éšæ—¶ä¿å­˜æˆ–æ¢å¤ä¹‹å‰çš„å¯¹è¯å†å²ã€‚</p>
<p>è¿˜æœ‰å°±æ˜¯ AI æƒ³è¦æ‰§è¡Œæ•æ„Ÿæ“ä½œï¼Œæ¯”å¦‚åˆ é™¤æ–‡ä»¶ã€è¿è¡Œè„šæœ¬æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡äº¤äº’å¼ç•Œé¢è¿›è¡Œå…è®¸æˆ–æ‹’ç»ï¼Œæ›´åŠ å®‰å¿ƒå’Œç›´è§‚ã€‚</p>
<pre><code class="hljs language-arduino" lang="arduino">å¼€æºåœ°å€ï¼šhttps:<span class="hljs-comment">//github.com/DevAgentForge/Claude-Cowork</span>
</code></pre>
<p>åŸæ–‡è§†é¢‘èµ„æ–™å¯æŸ¥çœ‹ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FxPDK-KcP7gbKTM_ymmfAvw" target="_blank" title="https://mp.weixin.qq.com/s/xPDK-KcP7gbKTM_ymmfAvw" ref="nofollow noopener noreferrer">mp.weixin.qq.com/s/xPDK-KcP7â€¦</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Vueç»„ä»¶å˜é‡å€¼æ›´æ–°è¿‡ç¨‹è®°å½•]]></title>    <link>https://juejin.cn/post/7597056049691230246</link>    <guid>https://juejin.cn/post/7597056049691230246</guid>    <pubDate>2026-01-20T07:45:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597056049691230246" data-draft-id="7596998306381070386" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Vueç»„ä»¶å˜é‡å€¼æ›´æ–°è¿‡ç¨‹è®°å½•"/> <meta itemprop="keywords" content="Vue.js"/> <meta itemprop="datePublished" content="2026-01-20T07:45:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="cj8140"/> <meta itemprop="url" content="https://juejin.cn/user/958429869388990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Vueç»„ä»¶å˜é‡å€¼æ›´æ–°è¿‡ç¨‹è®°å½•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/958429869388990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    cj8140
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:45:18.000Z" title="Tue Jan 20 2026 07:45:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä» Vue 2.x æºç è§’åº¦åˆ†æå°†ç»„ä»¶å˜é‡ <code>a</code> ä»ç©ºå€¼ä¿®æ”¹ä¸º <code>1</code> çš„å®Œæ•´è°ƒç”¨æ ˆå¦‚ä¸‹ï¼š</p>
<hr/>
<h3 data-id="heading-0"><strong>1. ç»„ä»¶åˆå§‹åŒ–é˜¶æ®µ</strong></h3>
<p>åœ¨ç»„ä»¶åˆ›å»ºæ—¶ï¼ŒVue ä¼šåˆå§‹åŒ–å“åº”å¼æ•°æ®ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è°ƒç”¨æ ˆï¼š</span>
<span class="hljs-title class_">Vue</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">_init</span> (init.<span class="hljs-property">js</span>)
  â””â”€â”€ initState (state.<span class="hljs-property">js</span>)
      â””â”€â”€ initData (state.<span class="hljs-property">js</span>)
          â””â”€â”€ observe (observer/index.<span class="hljs-property">js</span>)
              â””â”€â”€ <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span> (observer/index.<span class="hljs-property">js</span>)
                  â””â”€â”€ walk (observer/index.<span class="hljs-property">js</span>)
                      â””â”€â”€ defineReactive (observer/index.<span class="hljs-property">js</span>) <span class="hljs-comment">// ä¸ºå±æ€§ `a` åˆ›å»ºå“åº”å¼</span>
</code></pre>
<h4 data-id="heading-1"><strong>å…³é”®æ­¥éª¤</strong>ï¼š</h4>
<ul>
<li><strong><code>defineReactive</code></strong> ä¸º <code>a</code> åˆ›å»º <code>getter/setter</code>ï¼š
<ul>
<li>åˆå§‹åŒ– <code>dep</code> å®ä¾‹ï¼ˆä¾èµ–æ”¶é›†å™¨ï¼‰ã€‚</li>
<li>é€šè¿‡ <code>Object.defineProperty</code> é‡å†™ <code>a</code> çš„è®¿é—®å™¨ï¼š
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(obj, key, {
  <span class="hljs-title function_">get</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/* ä¾èµ–æ”¶é›† */</span> },
  <span class="hljs-title function_">set</span>(<span class="hljs-params">newVal</span>) { <span class="hljs-comment">/* è§¦å‘æ›´æ–° */</span> }
})
</code></pre>
</li>
</ul>
</li>
</ul>
<hr/>
<h3 data-id="heading-2"><strong>2. ä¿®æ”¹ <code>a</code> çš„å€¼</strong></h3>
<p>æ‰§è¡Œ <code>this.a = 1</code> æ—¶è§¦å‘ <code>setter</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è°ƒç”¨æ ˆï¼š</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span> = <span class="hljs-number">1</span>
  â””â”€â”€ a çš„ setter (defineReactive å†…éƒ¨)
      â””â”€â”€ dep.<span class="hljs-title function_">notify</span>() (observer/dep.<span class="hljs-property">js</span>)
          â””â”€â”€ subs[i].<span class="hljs-title function_">update</span>() (observer/watcher.<span class="hljs-property">js</span>)
              â””â”€â”€ queueWatcher (scheduler.<span class="hljs-property">js</span>)
                  â””â”€â”€ nextTick (scheduler.<span class="hljs-property">js</span>)
                      â””â”€â”€ flushSchedulerQueue (scheduler.<span class="hljs-property">js</span>)
                          â””â”€â”€ watcher.<span class="hljs-property">run</span> (observer/watcher.<span class="hljs-property">js</span>)
                              â””â”€â”€ watcher.<span class="hljs-property">get</span> (observer/watcher.<span class="hljs-property">js</span>)
                                  â””â”€â”€ ç»„ä»¶é‡æ–°æ¸²æŸ“ (render å‡½æ•°)
</code></pre>
<h4 data-id="heading-3"><strong>å…³é”®æ­¥éª¤è¯¦è§£</strong>ï¼š</h4>
<ol>
<li>
<p><strong><code>setter</code> è§¦å‘</strong>ï¼š</p>
<ul>
<li>æ£€æŸ¥æ–°å€¼ <code>1</code> æ˜¯å¦ä¸æ—§å€¼ä¸åŒï¼ˆ<code>newVal !== oldVal</code>ï¼‰ã€‚</li>
<li>è‹¥ä¸åŒï¼Œè°ƒç”¨ <code>dep.notify()</code> é€šçŸ¥æ‰€æœ‰ä¾èµ–ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>dep.notify()</code></strong>ï¼š</p>
<ul>
<li>éå† <code>dep.subs</code>ï¼ˆå­˜å‚¨æ‰€æœ‰è®¢é˜…è¯¥å±æ€§çš„ Watcherï¼‰ã€‚</li>
<li>è°ƒç”¨æ¯ä¸ª <code>watcher.update()</code>ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>watcher.update()</code></strong>ï¼š</p>
<ul>
<li>å°† Watcher åŠ å…¥å¼‚æ­¥é˜Ÿåˆ—ï¼ˆ<code>queueWatcher</code>ï¼‰ã€‚</li>
<li>é€šè¿‡ <code>nextTick</code> å¼‚æ­¥æ‰§è¡Œæ›´æ–°ã€‚</li>
</ul>
</li>
<li>
<p><strong><code>flushSchedulerQueue</code></strong>ï¼š</p>
<ul>
<li>éå†é˜Ÿåˆ—ä¸­çš„ Watcherï¼Œè°ƒç”¨ <code>watcher.run()</code>ã€‚</li>
<li><code>watcher.run()</code> â†’ <code>watcher.get()</code> â†’ é‡æ–°æ‰§è¡Œç»„ä»¶çš„ <code>render</code> å‡½æ•°ã€‚</li>
</ul>
</li>
<li>
<p><strong>é‡æ–°æ¸²æŸ“</strong>ï¼š</p>
<ul>
<li><code>render</code> å‡½æ•°æ‰§è¡Œæ—¶è®¿é—® <code>a</code>ï¼Œè§¦å‘ <code>getter</code> é‡æ–°æ”¶é›†ä¾èµ–ã€‚</li>
<li>ç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOMï¼Œå¯¹æ¯”å·®å¼‚åæ›´æ–°çœŸå® DOMã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-4"><strong>3. ä¾èµ–æ”¶é›†æœºåˆ¶</strong></h3>
<p>åœ¨é¦–æ¬¡æ¸²æŸ“å’Œåç»­æ›´æ–°æ—¶ï¼Œ<code>getter</code> è´Ÿè´£æ”¶é›†ä¾èµ–ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// getter è°ƒç”¨æ ˆï¼š</span>
ç»„ä»¶è®¿é—® a (render å‡½æ•°)
  â””â”€â”€ a çš„ getter (defineReactive å†…éƒ¨)
      â””â”€â”€ <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> (å…¨å±€å”¯ä¸€ <span class="hljs-title class_">Watcher</span>)
          â””â”€â”€ dep.<span class="hljs-title function_">depend</span>() (observer/dep.<span class="hljs-property">js</span>)
              â””â”€â”€ å°†å½“å‰ <span class="hljs-title class_">Watcher</span> æ·»åŠ åˆ° dep.<span class="hljs-property">subs</span>
</code></pre>
<h4 data-id="heading-5"><strong>å…³é”®ç‚¹</strong>ï¼š</h4>
<ul>
<li><strong><code>Dep.target</code></strong>ï¼šå…¨å±€å”¯ä¸€å˜é‡ï¼ŒæŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„ Watcherï¼ˆå¦‚æ¸²æŸ“ Watcherï¼‰ã€‚</li>
<li><strong><code>dep.depend()</code></strong>ï¼šå°†å½“å‰ Watcher åŠ å…¥ <code>dep.subs</code>ï¼Œå»ºç«‹ <code>å±æ€§ â†’ Watcher</code> çš„ä¾èµ–å…³ç³»ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-6"><strong>4. å¼‚æ­¥æ›´æ–°é˜Ÿåˆ—</strong></h3>
<p>Vue ä½¿ç”¨å¼‚æ­¥é˜Ÿåˆ—åˆå¹¶æ›´æ–°ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// nextTick æµç¨‹ï¼š</span>
queueWatcher (scheduler.<span class="hljs-property">js</span>)
  â””â”€â”€ nextTick (util/next-tick.<span class="hljs-property">js</span>)
      â””â”€â”€ å¼‚æ­¥ä»»åŠ¡ (<span class="hljs-title class_">Promise</span>/<span class="hljs-title class_">MutationObserver</span>/<span class="hljs-built_in">setTimeout</span>)
          â””â”€â”€ flushSchedulerQueue (scheduler.<span class="hljs-property">js</span>)
</code></pre>
<h4 data-id="heading-7"><strong>ä¼˜åŒ–é€»è¾‘</strong>ï¼š</h4>
<ul>
<li>å¤šæ¬¡ä¿®æ”¹ <code>a</code> ä¼šè¢«åˆå¹¶ä¸ºä¸€æ¬¡æ›´æ–°ï¼ˆé¿å…é‡å¤æ¸²æŸ“ï¼‰ã€‚</li>
<li>é€šè¿‡ <code>nextTick</code> ç¡®ä¿åœ¨ DOM æ›´æ–°åæ‰§è¡Œå›è°ƒã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-8"><strong>Vue 3 Proxy ç‰ˆæœ¬çš„å·®å¼‚</strong></h3>
<p>è‹¥ä½¿ç”¨ Vue 3ï¼ˆåŸºäº Proxyï¼‰ï¼š</p>
<ol>
<li><strong>åˆå§‹åŒ–</strong>ï¼šé€šè¿‡ <code>reactive</code> åˆ›å»ºå“åº”å¼ä»£ç†ã€‚</li>
<li><strong>ä¿®æ”¹å€¼</strong>ï¼šç›´æ¥è§¦å‘ <code>Proxy.set</code> æ‹¦æˆªå™¨ï¼Œåç»­æµç¨‹ç±»ä¼¼ï¼ˆä¾èµ–æ”¶é›†ã€å¼‚æ­¥æ›´æ–°ï¼‰ã€‚</li>
<li><strong>æ ¸å¿ƒå·®å¼‚</strong>ï¼š
<ul>
<li>æ— éœ€ <code>Object.defineProperty</code>ï¼Œæ”¯æŒåŠ¨æ€å±æ€§ã€‚</li>
<li>ä¾èµ–æ”¶é›†é€šè¿‡ <code>Track</code> æ“ä½œï¼Œæ›´æ–°é€šè¿‡ <code>Trigger</code> æ“ä½œã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-9"><strong>æ€»ç»“</strong></h3>






























<table><thead><tr><th>é˜¶æ®µ</th><th>æ ¸å¿ƒæ“ä½œ</th><th>å…³é”®å‡½æ•°/ç±»</th></tr></thead><tbody><tr><td><strong>åˆå§‹åŒ–</strong></td><td>ä¸º <code>a</code> åˆ›å»ºå“åº”å¼ <code>getter/setter</code></td><td><code>defineReactive</code>ã€<code>Dep</code></td></tr><tr><td><strong>ä¿®æ”¹å€¼</strong></td><td>è§¦å‘ <code>setter</code> â†’ é€šçŸ¥ä¾èµ–</td><td><code>dep.notify()</code></td></tr><tr><td><strong>ä¾èµ–æ›´æ–°</strong></td><td>å¼‚æ­¥é˜Ÿåˆ—åˆå¹¶æ›´æ–°</td><td><code>queueWatcher</code>ã€<code>nextTick</code></td></tr><tr><td><strong>é‡æ–°æ¸²æŸ“</strong></td><td>æ‰§è¡Œ <code>render</code> å‡½æ•°</td><td><code>Watcher.run()</code></td></tr></tbody></table>
<p>æ•´ä¸ªæµç¨‹ä½“ç°äº† Vue <strong>å“åº”å¼ç³»ç»Ÿ</strong>çš„æ ¸å¿ƒï¼š<strong>ä¾èµ–æ”¶é›†</strong>ï¼ˆ<code>getter</code>ï¼‰å’Œ <strong>æ´¾å‘æ›´æ–°</strong>ï¼ˆ<code>setter</code>ï¼‰ï¼Œé€šè¿‡ <strong>å¼‚æ­¥é˜Ÿåˆ—</strong> ä¼˜åŒ–æ€§èƒ½ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰§è¡Œäº† git commit ç„¶å git pullï¼Œç°åœ¨æƒ³è¦å›é€€åˆ° pull ä¹‹å‰çš„çŠ¶æ€]]></title>    <link>https://juejin.cn/post/7597009443085598735</link>    <guid>https://juejin.cn/post/7597009443085598735</guid>    <pubDate>2026-01-20T07:45:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597009443085598735" data-draft-id="7597024900521164852" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰§è¡Œäº† git commit ç„¶å git pullï¼Œç°åœ¨æƒ³è¦å›é€€åˆ° pull ä¹‹å‰çš„çŠ¶æ€"/> <meta itemprop="keywords" content="Git"/> <meta itemprop="datePublished" content="2026-01-20T07:45:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ–°æ™¨437"/> <meta itemprop="url" content="https://juejin.cn/user/3957868231143133"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰§è¡Œäº† git commit ç„¶å git pullï¼Œç°åœ¨æƒ³è¦å›é€€åˆ° pull ä¹‹å‰çš„çŠ¶æ€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3957868231143133/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ–°æ™¨437
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:45:45.000Z" title="Tue Jan 20 2026 07:45:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¦‚æœä½ å·²ç»æ‰§è¡Œäº† <code>git commit</code> ç„¶å <code>git pull</code>ï¼Œç°åœ¨æƒ³è¦å›é€€åˆ° pull ä¹‹å‰çš„çŠ¶æ€ï¼Œè¿™é‡Œæœ‰å‡ ä¸ªè§£å†³æ–¹æ¡ˆï¼š</p>
<h2 data-id="heading-0">è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-1">1. <strong>ä½¿ç”¨ git resetï¼ˆæœ€å¸¸ç”¨ï¼‰</strong></h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æäº¤å†å²ï¼Œæ‰¾åˆ°ä½ æƒ³è¦å›é€€åˆ°çš„commit</span>
git <span class="hljs-built_in">log</span> --oneline

<span class="hljs-comment"># å›é€€åˆ°æŒ‡å®šçš„commitï¼ˆä¿ç•™å·¥ä½œåŒºæ›´æ”¹ï¼‰</span>
git reset --soft &lt;commit-hash&gt;

<span class="hljs-comment"># æˆ–è€…å›é€€å¹¶ä¸¢å¼ƒæ›´æ”¹</span>
git reset --hard &lt;commit-hash&gt;
</code></pre>
<h3 data-id="heading-2">2. <strong>å›é€€åˆ° pull ä¹‹å‰çš„çŠ¶æ€</strong></h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä½¿ç”¨ reflog æŸ¥çœ‹æ“ä½œå†å²</span>
git reflog

<span class="hljs-comment"># æ‰¾åˆ° pull ä¹‹å‰çš„ HEAD ä½ç½®ï¼Œç„¶åé‡ç½®</span>
git reset --hard HEAD@{n}  <span class="hljs-comment"># n æ˜¯ reflog ä¸­çš„ç¼–å·</span>
</code></pre>
<h3 data-id="heading-3">3. <strong>å¦‚æœä½ æƒ³è¦å®Œå…¨æ’¤é”€ pull å’Œ commit</strong></h3>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æŸ¥çœ‹æœ€è¿‘çš„æ“ä½œï¼Œæ‰¾åˆ° pull ä¹‹å‰çš„æäº¤</span>
git <span class="hljs-built_in">log</span> --oneline

<span class="hljs-comment"># é‡ç½®åˆ° pull ä¹‹å‰çš„æäº¤</span>
git reset --hard HEAD~2  <span class="hljs-comment"># å›é€€2ä¸ªæäº¤ï¼ˆå‡è®¾ä½ commitäº†1æ¬¡ï¼Œpulläº†1æ¬¡ï¼‰</span>
</code></pre>
<h2 data-id="heading-4">å…·ä½“æ“ä½œæ­¥éª¤å»ºè®®ï¼š</h2>
<ol>
<li><strong>å…ˆæŸ¥çœ‹å½“å‰çŠ¶æ€</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">git status
git <span class="hljs-built_in">log</span> --oneline
</code></pre>
<ol start="2">
<li><strong>å®‰å…¨æ–¹æ¡ˆï¼ˆä¿ç•™æ›´æ”¹ï¼‰</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å…ˆä¿å­˜å½“å‰å·¥ä½œçŠ¶æ€ï¼ˆå¦‚æœæœ‰æœªæäº¤çš„æ›´æ”¹ï¼‰</span>
git stash

<span class="hljs-comment"># å›é€€åˆ° pull ä¹‹å‰çš„commit</span>
git reset --hard HEAD~1

<span class="hljs-comment"># å¦‚æœéœ€è¦ï¼Œæ¢å¤stashçš„æ›´æ”¹</span>
git stash pop
</code></pre>
<ol start="3">
<li><strong>å¦‚æœä½ åªæ˜¯æƒ³ä¿®æ”¹ commit ä¿¡æ¯</strong>ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¿®æ”¹æœ€åä¸€æ¬¡commit</span>
git commit --amend
</code></pre>
<h2 data-id="heading-5">æ³¨æ„äº‹é¡¹ï¼š</h2>
<ul>
<li>å¦‚æœå·²ç» push åˆ°è¿œç¨‹ä»“åº“ï¼Œéœ€è¦è°¨æ…æ“ä½œï¼Œå¯èƒ½éœ€è¦ <code>git push --force</code></li>
<li>å¦‚æœæ˜¯å¤šäººåä½œçš„é¡¹ç›®ï¼Œæœ€å¥½å…ˆå’Œå›¢é˜Ÿæ²Ÿé€š</li>
<li>ä½¿ç”¨ <code>git reset --hard</code> ä¼šä¸¢å¤±æ‰€æœ‰æœªæäº¤çš„æ›´æ”¹ï¼Œè¯·ç¡®ä¿å·²å¤‡ä»½</li>
</ul>
<p>ä½ å…·ä½“é‡åˆ°äº†ä»€ä¹ˆæƒ…å†µï¼Ÿæˆ‘å¯ä»¥æä¾›æ›´é’ˆå¯¹æ€§çš„å»ºè®®ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[rxjsåŸºæœ¬è¯­æ³•]]></title>    <link>https://juejin.cn/post/7596991930985185331</link>    <guid>https://juejin.cn/post/7596991930985185331</guid>    <pubDate>2026-01-20T07:38:52.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596991930985185331" data-draft-id="7597056049691164710" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="rxjsåŸºæœ¬è¯­æ³• "/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-20T07:38:52.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç±³è¯ºzuo"/> <meta itemprop="url" content="https://juejin.cn/user/2436173497373399"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            rxjsåŸºæœ¬è¯­æ³• 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2436173497373399/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç±³è¯ºzuo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:38:52.000Z" title="Tue Jan 20 2026 07:38:52 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>RxJS (Reactive Extensions for JavaScript) æ˜¯ Angular ä¸­å¤„ç†<strong>å¼‚æ­¥ç¼–ç¨‹</strong>çš„æ ¸å¿ƒåº“ã€‚
å®ƒé€šè¿‡ä½¿ç”¨ <strong>Observableï¼ˆå¯è§‚å¯Ÿå¯¹è±¡ï¼‰</strong> åºåˆ—æ¥ç¼–å†™å¼‚æ­¥å’ŒåŸºäºå›è°ƒçš„ä»£ç ã€‚</p>
<hr/>
<h3 data-id="heading-0">ä¸€ã€ æ ¸å¿ƒæ¦‚å¿µ</h3>
<p>åœ¨ RxJS ä¸­ï¼Œä¸€åˆ‡åŸºäºæ•°æ®æµã€‚</p>
<ul>
<li><strong>Observable (è¢«è§‚å¯Ÿè€…):</strong> æ•°æ®çš„æºå¤´ï¼Œå‘å‡ºæ•°æ®ã€‚</li>
<li><strong>Observer (è§‚å¯Ÿè€…):</strong> æ•°æ®çš„æ¶ˆè´¹è€…ï¼Œæ¥æ”¶æ•°æ®ã€‚</li>
<li><strong>Subscription (è®¢é˜…):</strong> è¿æ¥ Observable å’Œ Observer çš„æ¡¥æ¢ã€‚<strong>æ³¨æ„ï¼šå¿…é¡»å–æ¶ˆè®¢é˜…ï¼Œå¦åˆ™ä¼šå†…å­˜æ³„æ¼ã€‚</strong></li>
<li><strong>Operators (æ“ä½œç¬¦):</strong> çº¯å‡½æ•°ï¼Œç”¨æ¥å¤„ç†ã€è½¬æ¢æ•°æ®æµï¼ˆå¦‚ map, filterï¼‰ã€‚</li>
<li><strong>Subject (ä¸»é¢˜):</strong> æ—¢æ˜¯ Observable åˆæ˜¯ Observerï¼Œå¯ä»¥å¤šæ’­æ•°æ®ï¼ˆå¸¸ç”¨äºç»„ä»¶é€šä¿¡ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-1">äºŒã€ åŸºç¡€å†™æ³•</h3>
<h4 data-id="heading-2">1. åˆ›å»º Observable å’Œ è®¢é˜…</h4>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Observable</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-comment">// 1. åˆ›å»º Observable</span>
<span class="hljs-keyword">const</span> observable$ = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observable</span>(<span class="hljs-function"><span class="hljs-params">subscriber</span> =&gt;</span> {
  subscriber.<span class="hljs-title function_">next</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// å‘å‡ºæ•°æ®</span>
  subscriber.<span class="hljs-title function_">next</span>(<span class="hljs-number">2</span>);
  subscriber.<span class="hljs-title function_">next</span>(<span class="hljs-number">3</span>);
  subscriber.<span class="hljs-title function_">complete</span>(); <span class="hljs-comment">// ç»“æŸ</span>
  <span class="hljs-comment">// subscriber.error('å‡ºé”™äº†'); // æŠ›å‡ºå¼‚å¸¸</span>
});
<span class="hljs-comment">// 2. è®¢é˜…</span>
<span class="hljs-keyword">const</span> subscription = observable$.<span class="hljs-title function_">subscribe</span>({
  <span class="hljs-attr">next</span>: <span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ”¶åˆ°æ•°æ®:'</span>, x),
  <span class="hljs-attr">error</span>: <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'é”™è¯¯:'</span>, err),
  <span class="hljs-attr">complete</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æµç»“æŸ'</span>)
});
<span class="hljs-comment">// 3. å–æ¶ˆè®¢é˜… (éå¸¸é‡è¦)</span>
subscription.<span class="hljs-title function_">unsubscribe</span>();
</code></pre>
<h4 data-id="heading-3">2. ç®€å†™è®¢é˜… (åªå…³å¿ƒ next)</h4>
<pre><code class="hljs language-typescript" lang="typescript">observable$.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data));
</code></pre>
<hr/>
<h3 data-id="heading-4">ä¸‰ã€ å¸¸ç”¨åˆ›å»ºæ“ä½œç¬¦</h3>
<p>ç”¨äºç”Ÿæˆæ•°æ®æµã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-keyword">of</span>, <span class="hljs-keyword">from</span>, interval, fromEvent, throwError } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-comment">// 1. of: ä¾æ¬¡å‘å‡ºå‚æ•°</span>
<span class="hljs-title function_">of</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>).<span class="hljs-title function_">subscribe</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>); <span class="hljs-comment">// è¾“å‡º: 1, 2, 3</span>
<span class="hljs-comment">// 2. from: å°†æ•°ç»„/Promise è½¬ä¸º Observable</span>
<span class="hljs-title function_">from</span>([<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>]).<span class="hljs-title function_">subscribe</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>); <span class="hljs-comment">// è¾“å‡º: 10, 20, 30</span>
<span class="hljs-comment">// 3. interval: å‘¨æœŸæ€§å‘å‡ºæ•°å­— (æ¯1ç§’å‘ä¸€ä¸ª)</span>
<span class="hljs-title function_">interval</span>(<span class="hljs-number">1000</span>).<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(n)); <span class="hljs-comment">// 0, 1, 2...</span>
<span class="hljs-comment">// 4. fromEvent: ç›‘å¬ DOM äº‹ä»¶</span>
<span class="hljs-title function_">fromEvent</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'button'</span>)!, <span class="hljs-string">'click'</span>)
  .<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æŒ‰é’®è¢«ç‚¹å‡»'</span>));
<span class="hljs-comment">// 5. throwError: åˆ›å»ºä¸€ä¸ªåªæŠ¥é”™çš„æµ</span>
<span class="hljs-comment">// throwError(() =&gt; new Error('å“å‘€å‡ºé”™äº†')).subscribe();</span>
</code></pre>
<hr/>
<h3 data-id="heading-5">å››ã€ å¸¸ç”¨è½¬æ¢æ“ä½œç¬¦</h3>
<p>è¿™æ˜¯ RxJS æœ€å¼ºå¤§çš„éƒ¨åˆ†ï¼Œ<strong>ç®¡é“</strong> è¯­æ³•æ˜¯ Angular 18+ çš„æ ‡å‡†å†™æ³•ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { map, filter, pluck } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;
<span class="hljs-title function_">of</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>).<span class="hljs-title function_">pipe</span>(
  <span class="hljs-comment">// 1. map: è½¬æ¢æ•°æ® (ç±»ä¼¼æ•°ç»„çš„ map)</span>
  <span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x * <span class="hljs-number">10</span>), 
  
  <span class="hljs-comment">// 2. filter: è¿‡æ»¤æ•°æ® (åªæœ‰ true æ‰ä¼šé€šè¿‡)</span>
  <span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x &gt; <span class="hljs-number">20</span>)
).<span class="hljs-title function_">subscribe</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>); 
<span class="hljs-comment">// è¾“å‡º: 30, 40, 50</span>
<span class="hljs-comment">// 3. pluck: æå–å¯¹è±¡å±æ€§ (å·²åºŸå¼ƒï¼Œæ¨èç”¨ map)</span>
<span class="hljs-comment">// æ—§å†™æ³•: source$.pipe(pluck('user', 'name'))</span>
<span class="hljs-comment">// æ–°å†™æ³•:</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">User</span> { <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>; <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>; }
<span class="hljs-keyword">const</span> <span class="hljs-attr">user$</span>: <span class="hljs-title class_">Observable</span>&lt;<span class="hljs-title class_">User</span>&gt; = <span class="hljs-title function_">of</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Tom'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> });
user$.<span class="hljs-title function_">pipe</span>(<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">user</span> =&gt;</span> user.<span class="hljs-property">name</span>)).<span class="hljs-title function_">subscribe</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>);
</code></pre>
<hr/>
<h3 data-id="heading-6">äº”ã€ å·¥å…·æ“ä½œç¬¦ (é¢è¯•é«˜é¢‘)</h3>
<p>ç”¨äºå¤„ç†æµçš„é€»è¾‘ï¼Œå¦‚é™æµã€é˜²æŠ–ã€é”™è¯¯å¤„ç†ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { delay, tap, catchError, takeUntil, debounceTime } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-keyword">of</span>, <span class="hljs-title class_">Subject</span>, throwError } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-comment">// 1. tap: å‰¯ä½œç”¨æ“ä½œ (ä¸ä¿®æ”¹æ•°æ®ï¼Œé€šå¸¸ç”¨äºæ‰“å°æ—¥å¿—ã€å­˜ LocalStorage)</span>
<span class="hljs-title function_">of</span>(<span class="hljs-string">'Hello'</span>).<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">tap</span>(<span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†å‰:'</span>, val)), 
  <span class="hljs-title function_">delay</span>(<span class="hljs-number">1000</span>) <span class="hljs-comment">// å»¶è¿Ÿ1ç§’å‘å°„</span>
).<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'å¤„ç†å:'</span>, val));
<span class="hljs-comment">// 2. catchError: é”™è¯¯æ•è· (è®©æµä¸ä¸­æ–­)</span>
<span class="hljs-title function_">throwError</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç½‘ç»œé”™è¯¯'</span>)).<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">catchError</span>(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
    <span class="hljs-comment">// æ•è·é”™è¯¯åï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ Observable ç»™ä¸‹æ¸¸ï¼Œé˜²æ­¢ç¨‹åºå´©æºƒ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title function_">of</span>(<span class="hljs-string">'é»˜è®¤æ•°æ®'</span>); 
  })
).<span class="hljs-title function_">subscribe</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>); <span class="hljs-comment">// è¾“å‡º: é»˜è®¤æ•°æ®</span>
<span class="hljs-comment">// 3. debounceTime: é˜²æŠ– (ç”¨æˆ·åœæ­¢è¾“å…¥ 300ms åæ‰å‘é€è¯·æ±‚)</span>
<span class="hljs-title function_">fromEvent</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'input'</span>)!, <span class="hljs-string">'input'</span>).<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">debounceTime</span>(<span class="hljs-number">300</span>)
).<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">event: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(event.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>));
<span class="hljs-comment">// 4. takeUntil: ç«‹å³å–æ¶ˆè®¢é˜… (åœ¨ Angular ç»„ä»¶é”€æ¯æ—¶æœ€å¸¸ç”¨)</span>
<span class="hljs-keyword">const</span> destroy$ = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Subject</span>&lt;<span class="hljs-built_in">void</span>&gt;();
<span class="hljs-title function_">interval</span>(<span class="hljs-number">1000</span>).<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">takeUntil</span>(destroy$) <span class="hljs-comment">// å½“ destroy$ å‘å‡ºå€¼æ—¶ï¼Œä¸Šé¢çš„æµè‡ªåŠ¨åœæ­¢</span>
).<span class="hljs-title function_">subscribe</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>);
<span class="hljs-comment">// æ¨¡æ‹Ÿç»„ä»¶é”€æ¯</span>
<span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
  destroy$.<span class="hljs-title function_">next</span>(); <span class="hljs-comment">// åœæ­¢ä¸Šé¢çš„ interval</span>
  destroy$.<span class="hljs-title function_">complete</span>();
}, <span class="hljs-number">5000</span>);
</code></pre>
<hr/>
<h3 data-id="heading-7">å…­ã€ é«˜é˜¶æ“ä½œç¬¦ (å¤„ç†åµŒå¥—æµ)</h3>
<p>å½“ä¸€ä¸ª Observable å‘å‡ºçš„æ•°æ®è¿˜æ˜¯ä¸€ä¸ª Observable æ—¶ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { mergeMap, switchMap, concatMap, exhaustMap } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs/operators'</span>;
<span class="hljs-comment">// åœºæ™¯ï¼šç‚¹å‡»æŒ‰é’® -&gt; å‘é€ HTTP è¯·æ±‚</span>
<span class="hljs-comment">// å‡è®¾ click$ æ˜¯ç‚¹å‡»äº‹ä»¶æµï¼Œ getData(id) è¿”å› Observable</span>
<span class="hljs-comment">// 1. mergeMap (å¹¶è¡Œ): ç‚¹å‡»ä¸€æ¬¡å‘ä¸€æ¬¡è¯·æ±‚ï¼Œä¸ç®¡ä¸Šä¸€ä¸ªæœ‰æ²¡æœ‰å®Œæˆã€‚</span>
<span class="hljs-comment">// é€‚ç”¨ï¼šå¹¶å‘ä¸Šä¼ ï¼Œäº’ä¸å¹²æ‰°ã€‚</span>
click$.<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">mergeMap</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'/api/data'</span>))
).<span class="hljs-title function_">subscribe</span>();
<span class="hljs-comment">// 2. switchMap (åˆ‡æ¢): **é¢è¯•å¿…è€ƒ**ã€‚å¦‚æœæœ‰æ–°è¯·æ±‚ï¼Œå–æ¶ˆæ—§è¯·æ±‚ã€‚</span>
<span class="hljs-comment">// é€‚ç”¨ï¼šæœç´¢æ¡†è¾“å…¥ã€‚</span>
searchInput$.<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">switchMap</span>(<span class="hljs-function"><span class="hljs-params">keyword</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>.<span class="hljs-title function_">search</span>(keyword)) 
).<span class="hljs-title function_">subscribe</span>();
<span class="hljs-comment">// 3. concatMap (ä¸²è¡Œ): ç­‰å‰ä¸€ä¸ªè¯·æ±‚å®Œæˆï¼Œå†å‘ä¸‹ä¸€ä¸ªã€‚</span>
<span class="hljs-comment">// é€‚ç”¨ï¼šå¿…é¡»æŒ‰é¡ºåºæ‰§è¡Œçš„ä»»åŠ¡ã€‚</span>
<span class="hljs-comment">// 4. exhaustMap (æ’ä»–): å¦‚æœæœ‰è¯·æ±‚æ­£åœ¨è¿›è¡Œï¼Œå¿½ç•¥æ–°çš„ç‚¹å‡»ã€‚</span>
<span class="hljs-comment">// é€‚ç”¨ï¼šé˜²æ­¢é‡å¤æäº¤è¡¨å•ã€‚</span>
submitBtn$.<span class="hljs-title function_">pipe</span>(
  <span class="hljs-title function_">exhaustMap</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">http</span>.<span class="hljs-title function_">submit</span>())
).<span class="hljs-title function_">subscribe</span>();
</code></pre>
<hr/>
<h3 data-id="heading-8">ä¸ƒã€ Subject (å¤šæ’­)</h3>
<p>æ™®é€šçš„ Observable æ˜¯å•æ’­çš„ï¼›Subject å¯ä»¥è®©å¤šä¸ªè®¢é˜…è€…å…±äº«åŒä¸€ä¸ªæ•°æ®æºã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Subject</span>, <span class="hljs-title class_">BehaviorSubject</span>, <span class="hljs-title class_">ReplaySubject</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
<span class="hljs-comment">// 1. Subject: åªæœ‰è®¢é˜…åå‘å‡ºçš„æ•°æ®æ‰ä¼šæ”¶åˆ°ã€‚</span>
<span class="hljs-keyword">const</span> subject = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Subject</span>&lt;<span class="hljs-built_in">number</span>&gt;();
subject.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'A:'</span>, n));
subject.<span class="hljs-title function_">next</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// A æ”¶åˆ° 1</span>
subject.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'B:'</span>, n));
subject.<span class="hljs-title function_">next</span>(<span class="hljs-number">2</span>); <span class="hljs-comment">// A æ”¶åˆ° 2, B æ”¶åˆ° 2 (B é”™è¿‡äº† 1)</span>
<span class="hljs-comment">// 2. BehaviorSubject: å¿…é¡»æœ‰åˆå§‹å€¼ï¼Œæ–°è®¢é˜…è€…ä¼šç«‹å³æ”¶åˆ°**æœ€æ–°**çš„å€¼ã€‚</span>
<span class="hljs-keyword">const</span> bs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BehaviorSubject</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">0</span>); <span class="hljs-comment">// åˆå§‹å€¼ 0</span>
bs.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'C:'</span>, n)); <span class="hljs-comment">// C ç«‹å³æ”¶åˆ° 0</span>
bs.<span class="hljs-title function_">next</span>(<span class="hljs-number">100</span>);
<span class="hljs-comment">// 3. ReplaySubject: å¯ä»¥ç¼“å­˜æœ€è¿‘çš„ N ä¸ªå€¼ï¼Œæ–°è®¢é˜…è€…ä¼šæ”¶åˆ°ç¼“å­˜çš„å†å²è®°å½•ã€‚</span>
<span class="hljs-keyword">const</span> rs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReplaySubject</span>(<span class="hljs-number">2</span>); <span class="hljs-comment">// ç¼“å­˜æœ€è¿‘ 2 ä¸ª</span>
rs.<span class="hljs-title function_">next</span>(<span class="hljs-number">1</span>);
rs.<span class="hljs-title function_">next</span>(<span class="hljs-number">2</span>);
rs.<span class="hljs-title function_">next</span>(<span class="hljs-number">3</span>);
rs.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'D:'</span>, n)); <span class="hljs-comment">// D æ”¶åˆ° 2 å’Œ 3</span>
</code></pre>
<hr/>
<h3 data-id="heading-9">å…«ã€ Angular å®æˆ˜ï¼šAsyncPipe (è¯­æ³•ç³–)</h3>
<p>åœ¨ Angular ä¸­ï¼Œä½ ç”šè‡³ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ <code>.subscribe()</code>ã€‚</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// ç»„ä»¶ TS</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponent</span> {
  <span class="hljs-comment">// è‡ªåŠ¨å¤„ç†è®¢é˜…ã€å–æ¶ˆè®¢é˜…ã€å˜åŒ–æ£€æµ‹</span>
  data$ = <span class="hljs-title function_">of</span>([{ <span class="hljs-attr">name</span>: <span class="hljs-string">'Tom'</span> }, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Jerry'</span> }]); 
}
<span class="hljs-comment">// ç»„ä»¶ HTML</span>
&lt;div *ngFor=<span class="hljs-string">"let item of data$ | async"</span>&gt;
  {{ item.<span class="hljs-property">name</span> }}
&lt;/div&gt;
</code></pre>
<h2 data-id="heading-10"><strong>æ³¨æ„ï¼š</strong> å¦‚æœä½ éœ€è¦æ‹¿åˆ°æ•°æ®ååœ¨ TS é€»è¾‘é‡Œåšå¤æ‚å¤„ç†ï¼Œè¿˜æ˜¯éœ€è¦æ‰‹åŠ¨ subscribe å¹¶é…åˆ <code>takeUntil</code> ä½¿ç”¨ã€‚</h2>
<h3 data-id="heading-11">æ€»ç»“é€ŸæŸ¥è¡¨</h3>













































<table><thead><tr><th align="left">ç±»åˆ«</th><th align="left">æ“ä½œç¬¦</th><th align="left">ä½œç”¨</th></tr></thead><tbody><tr><td align="left"><strong>åˆ›å»º</strong></td><td align="left"><code>of</code>, <code>from</code>, <code>interval</code></td><td align="left">é€ æ•°æ®</td></tr><tr><td align="left"><strong>è½¬æ¢</strong></td><td align="left"><code>map</code>, <code>filter</code></td><td align="left">æ”¹æ•°æ®</td></tr><tr><td align="left"><strong>å·¥å…·</strong></td><td align="left"><code>tap</code>, <code>delay</code>, <code>debounceTime</code></td><td align="left">è¾…åŠ©/æ‹¦æˆª</td></tr><tr><td align="left"><strong>ç»„åˆ</strong></td><td align="left"><code>switchMap</code>, <code>mergeMap</code></td><td align="left">å¤„ç†åµŒå¥—æµ (HTTP)</td></tr><tr><td align="left"><strong>ç”Ÿå‘½å‘¨æœŸ</strong></td><td align="left"><code>takeUntil</code>, <code>first</code>, <code>take</code></td><td align="left">ç®¡ç†è®¢é˜…</td></tr><tr><td align="left"><strong>é”™è¯¯</strong></td><td align="left"><code>catchError</code>, <code>retry</code></td><td align="left">å¼‚å¸¸å¤„ç†</td></tr><tr><td align="left"><strong>å¤šæ’­</strong></td><td align="left"><code>Subject</code>, <code>BehaviorSubject</code></td><td align="left">è·¨ç»„ä»¶é€šä¿¡</td></tr></tbody></table></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§ç™½è¯è§£é‡ŠVueå“åº”å¼ä¸‰è¦ç´ ]]></title>    <link>https://juejin.cn/post/7597058147748626442</link>    <guid>https://juejin.cn/post/7597058147748626442</guid>    <pubDate>2026-01-20T08:00:54.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597058147748626442" data-draft-id="7597056049691344934" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§ç™½è¯è§£é‡ŠVueå“åº”å¼ä¸‰è¦ç´ "/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-20T08:00:54.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="cj8140"/> <meta itemprop="url" content="https://juejin.cn/user/958429869388990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§ç™½è¯è§£é‡ŠVueå“åº”å¼ä¸‰è¦ç´ 
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/958429869388990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    cj8140
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:00:54.000Z" title="Tue Jan 20 2026 08:00:54 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å¥½çš„ï¼å’±ä»¬ç”¨æœ€æ¥åœ°æ°”çš„å¤§ç™½è¯èŠèŠ Vue å“åº”å¼ç³»ç»Ÿçš„ä¸‰ä¸ªæ ¸å¿ƒè§’è‰²ï¼š<strong>Observerï¼ˆè§‚å¯Ÿè€…ï¼‰</strong>ã€<strong>Watcherï¼ˆç›‘å¬è€…ï¼‰</strong>ã€<strong>Depï¼ˆä¾èµ–æ”¶é›†å™¨ï¼‰</strong>ã€‚æƒ³è±¡ä¸€ä¸‹å®ƒä»¬ä»¨æ˜¯æ€ä¹ˆé…åˆå·¥ä½œçš„ï¼š</p>
<hr/>
<h3 data-id="heading-0">ğŸ¯ åœºæ™¯æ¯”å–»ï¼šç­çº§é€šçŸ¥ç³»ç»Ÿ</h3>
<p>æƒ³è±¡ä¸€ä¸ªç­çº§ï¼š</p>
<ul>
<li><strong>æ•°æ® (<code>data</code>)</strong>ï¼šç­çº§é‡ŒæŸä¸ªåŒå­¦ï¼ˆæ¯”å¦‚å°æ˜ï¼‰çš„ä½œä¸šæœ¬çŠ¶æ€ï¼ˆæ˜¯å¦å†™å®Œï¼‰ã€‚</li>
<li><strong>æ¨¡æ¿ (<code>template</code>)</strong>ï¼šç­çº§å…¬å‘Šæ ï¼ˆæ˜¾ç¤ºâ€œå°æ˜ä½œä¸šï¼šæœªå®Œæˆâ€ï¼‰ã€‚</li>
<li><strong>è§†å›¾ (<code>view</code>)</strong>ï¼šä½ çœ¼ç›çœ‹åˆ°çš„å…¬å‘Šæ å†…å®¹ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-1">ğŸ‘¤ 1. Observer (è§‚å¯Ÿè€…) - â€œæ•°æ®ç®¡å®¶â€</h3>
<ul>
<li><strong>èŒè´£</strong>ï¼šæŠŠæ™®é€šæ•°æ®å˜æˆâ€œèªæ˜â€æ•°æ®ï¼Œè®©æ•°æ®è‡ªå·±çŸ¥é“è°åœ¨å…³å¿ƒå®ƒã€‚</li>
<li><strong>å·¥ä½œæ–¹å¼</strong>ï¼š
<ul>
<li>å½“ä½ åˆ›å»º Vue å®ä¾‹æ—¶ï¼Œ<code>Observer</code> ä¼šåƒç®¡å®¶ä¸€æ ·ï¼Œæ‹¿ç€å°æœ¬æœ¬ï¼ˆ<code>Dep</code>ï¼‰ï¼Œå»éå†ä½ å†™åœ¨ <code>data</code> é‡Œçš„æ‰€æœ‰å±æ€§ï¼ˆæ¯”å¦‚ <code>homeworkStatus: 'æœªå®Œæˆ'</code>ï¼‰ã€‚</li>
<li>å®ƒä¼šç»™æ¯ä¸ªå±æ€§ï¼ˆ<code>homeworkStatus</code>ï¼‰<strong>è£…ä¸Šä¸€ä¸ªâ€œç›‘å¬å™¨â€</strong>ï¼ˆ<code>Object.defineProperty</code> çš„ <code>getter/setter</code>ï¼‰ã€‚</li>
<li><strong><code>getter</code> (è·å–å€¼æ—¶)</strong>ï¼šå±æ€§è¢«è®¿é—®æ—¶ï¼ˆæ¯”å¦‚å…¬å‘Šæ è¦æ˜¾ç¤ºçŠ¶æ€ï¼‰ï¼Œ<code>Observer</code> ä¼šæ‚„æ‚„åœ¨æœ¬å­ä¸Šè®°ä¸€ç¬”ï¼šâ€œè°ï¼ˆè°ï¼‰åœ¨å…³å¿ƒæˆ‘ï¼ˆ<code>homeworkStatus</code>ï¼‰ï¼Ÿâ€ï¼ˆè¿™å°±æ˜¯<strong>ä¾èµ–æ”¶é›†</strong>ï¼‰ã€‚</li>
<li><strong><code>setter</code> (è®¾ç½®å€¼æ—¶)</strong>ï¼šå±æ€§è¢«ä¿®æ”¹æ—¶ï¼ˆæ¯”å¦‚ä½ æŠŠ <code>homeworkStatus</code> æ”¹æˆ <code>'å·²å®Œæˆ'</code>ï¼‰ï¼Œ<code>Observer</code> ä¼šç«‹åˆ»å¤§å–Šä¸€å£°ï¼šâ€œå–‚ï¼æˆ‘ï¼ˆ<code>homeworkStatus</code>ï¼‰å˜äº†ï¼å¿«é€šçŸ¥æ‰€æœ‰å…³å¿ƒæˆ‘çš„äººï¼â€ï¼ˆè¿™å°±æ˜¯<strong>æ´¾å‘æ›´æ–°</strong>ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>å¤§ç™½è¯æ€»ç»“</strong>ï¼š<code>Observer</code> å°±æ˜¯ä¸ª<strong>æ•°æ®ç®¡å®¶</strong>ï¼Œç»™æ•°æ®è£…ä¸Šâ€œè€³æœµâ€ï¼ˆ<code>getter</code>ï¼‰å’Œâ€œå–‡å­â€ï¼ˆ<code>setter</code>ï¼‰ï¼Œè®©æ•°æ®èƒ½â€œè¢«å¬åˆ°â€å’Œâ€œèƒ½å¹¿æ’­â€ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-2">ğŸ‘‚ 2. Watcher (ç›‘å¬è€…) - â€œå…³å¿ƒè€…â€</h3>
<ul>
<li><strong>èŒè´£</strong>ï¼šè°å…³å¿ƒæ•°æ®ï¼Ÿå°±æ˜¯å®ƒï¼å®ƒè´Ÿè´£åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡ŒåŠ¨ä½œï¼ˆæ¯”å¦‚æ›´æ–°è§†å›¾ï¼‰ã€‚</li>
<li><strong>å·¥ä½œæ–¹å¼</strong>ï¼š
<ul>
<li>æœ‰ä¸¤ç§ä¸»è¦ç±»å‹çš„ <code>Watcher</code>ï¼š
<ul>
<li><strong>æ¸²æŸ“ Watcher (Render Watcher)</strong>ï¼šæœ€æ ¸å¿ƒçš„â€œå…³å¿ƒè€…â€ï¼å®ƒè´Ÿè´£<strong>æ¸²æŸ“æ•´ä¸ªç»„ä»¶çš„æ¨¡æ¿</strong>ï¼ˆä¹Ÿå°±æ˜¯æ›´æ–°å…¬å‘Šæ ï¼‰ã€‚å®ƒä¸€å¯åŠ¨ï¼Œå°±ä¼šå»è®¿é—®ç»„ä»¶é‡Œç”¨åˆ°çš„æ‰€æœ‰æ•°æ®ï¼ˆæ¯”å¦‚ <code>homeworkStatus</code>ï¼‰ï¼Œè§¦å‘å®ƒä»¬çš„ <code>getter</code>ï¼Œä»è€Œåœ¨æœ¬å­ï¼ˆ<code>Dep</code>ï¼‰ä¸Šç™»è®°ï¼šâ€œæˆ‘æ˜¯æ¸²æŸ“ Watcherï¼Œæˆ‘å…³å¿ƒ <code>homeworkStatus</code>ï¼â€ã€‚</li>
<li><strong>ç”¨æˆ· Watcher (User Watcher)</strong>ï¼šä½ åœ¨ä»£ç é‡Œå†™çš„ <code>watch</code> é€‰é¡¹æˆ–è€… <code>this.$watch()</code> åˆ›å»ºçš„ç›‘å¬å™¨ã€‚æ¯”å¦‚ä½ ä¸“é—¨å†™ä»£ç ç›‘å¬ <code>homeworkStatus</code> å˜åŒ–æ—¶å¼¹ä¸ªçª—ã€‚å®ƒå¯åŠ¨æ—¶ä¹Ÿä¼šå»è®¿é—® <code>homeworkStatus</code>ï¼Œè§¦å‘ <code>getter</code>ï¼Œç™»è®°ï¼šâ€œæˆ‘æ˜¯ç”¨æˆ· Watcherï¼Œæˆ‘ä¹Ÿå…³å¿ƒ <code>homeworkStatus</code>ï¼â€ã€‚</li>
</ul>
</li>
<li>å½“æ•°æ®å˜åŒ–æ—¶ï¼ˆ<code>setter</code> å¹¿æ’­ï¼‰ï¼Œ<code>Watcher</code> æ”¶åˆ°é€šçŸ¥ï¼Œå°±æ‰§è¡Œå®ƒè¯¥åšçš„äº‹ï¼š
<ul>
<li>æ¸²æŸ“ Watcherï¼šé‡æ–°æ‰§è¡Œæ¸²æŸ“å‡½æ•°ï¼Œæ›´æ–°å…¬å‘Šæ å†…å®¹ã€‚</li>
<li>ç”¨æˆ· Watcherï¼šæ‰§è¡Œä½ å†™çš„å›è°ƒå‡½æ•°ï¼ˆæ¯”å¦‚å¼¹çª—ï¼‰ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>å¤§ç™½è¯æ€»ç»“</strong>ï¼š<code>Watcher</code> å°±æ˜¯<strong>æ•°æ®çš„ç²‰ä¸</strong>ï¼å®ƒä¸»åŠ¨å»â€œè¿½æ˜Ÿâ€ï¼ˆè®¿é—®æ•°æ®ï¼‰ï¼Œåœ¨æ•°æ®â€œæœ¬å­â€ï¼ˆ<code>Dep</code>ï¼‰ä¸Šç•™ä¸‹è”ç³»æ–¹å¼ã€‚æ•°æ®ä¸€â€œå‘æ–°åŠ¨æ€â€ï¼ˆå˜åŒ–ï¼‰ï¼Œç²‰ä¸ï¼ˆWatcherï¼‰ç«‹åˆ»æ”¶åˆ°é€šçŸ¥ï¼ŒæŒ‰çº¦å®šåšåŠ¨ä½œï¼ˆæ›´æ–°è§†å›¾/æ‰§è¡Œå›è°ƒï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-3">ğŸ“’ 3. Dep (Dependency - ä¾èµ–æ”¶é›†å™¨) - â€œé€šè®¯å½•æœ¬å­â€</h3>
<ul>
<li><strong>èŒè´£</strong>ï¼šè®°å½•æ•°æ®ï¼ˆå±æ€§ï¼‰å’Œå…³å¿ƒå®ƒçš„ <code>Watcher</code> ä¹‹é—´çš„â€œä¾èµ–å…³ç³»â€ã€‚å®ƒæ˜¯ <code>Observer</code> å’Œ <code>Watcher</code> ä¹‹é—´çš„<strong>æ¡¥æ¢</strong>ã€‚</li>
<li><strong>å·¥ä½œæ–¹å¼</strong>ï¼š
<ul>
<li>æ¯ä¸ªè¢« <code>Observer</code> è£…ä¸Šâ€œç›‘å¬å™¨â€çš„æ•°æ®å±æ€§ï¼ˆæ¯”å¦‚ <code>homeworkStatus</code>ï¼‰ï¼Œéƒ½ä¼š<strong>æ‹¥æœ‰ä¸€ä¸ªä¸“å±çš„ <code>Dep</code> å®ä¾‹</strong>ã€‚è¿™ä¸ª <code>Dep</code> å°±åƒä¸€ä¸ªå°æœ¬æœ¬ã€‚</li>
<li>å½“ <code>Watcher</code>ï¼ˆç²‰ä¸ï¼‰å»è®¿é—®è¿™ä¸ªæ•°æ®ï¼ˆè§¦å‘ <code>getter</code>ï¼‰æ—¶ï¼š
<ul>
<li><code>Observer</code> ä¼šæŠŠå½“å‰æ­£åœ¨â€œå…³å¿ƒâ€çš„ <code>Watcher</code>ï¼ˆæ¯”å¦‚æ¸²æŸ“ Watcherï¼‰<strong>æ·»åŠ åˆ°è¿™ä¸ªæ•°æ®å±æ€§ä¸“å±çš„ <code>Dep</code> æœ¬å­é‡Œ</strong>ã€‚ç™»è®°ï¼šâ€œç²‰ä¸ <code>Watcher A</code> å…³å¿ƒæˆ‘ï¼â€ã€‚</li>
</ul>
</li>
<li>å½“æ•°æ®å˜åŒ–ï¼ˆè§¦å‘ <code>setter</code>ï¼‰æ—¶ï¼š
<ul>
<li><code>Observer</code> ä¼šæ‰¾åˆ°è¿™ä¸ªæ•°æ®å±æ€§ä¸“å±çš„ <code>Dep</code> æœ¬å­ã€‚</li>
<li>å®ƒä¼š<strong>éå†æœ¬å­ä¸Šè®°å½•çš„æ‰€æœ‰ <code>Watcher</code>ï¼ˆç²‰ä¸ï¼‰</strong>ï¼ŒæŒ¨ä¸ªç»™ä»–ä»¬æ‰“ç”µè¯ï¼ˆè°ƒç”¨ <code>Watcher</code> çš„ <code>update</code> æ–¹æ³•ï¼‰ï¼šâ€œå–‚ï¼æ•°æ®å˜äº†ï¼å¿«æ›´æ–°ï¼â€ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>å¤§ç™½è¯æ€»ç»“</strong>ï¼š<code>Dep</code> å°±æ˜¯<strong>æ•°æ®çš„â€œç²‰ä¸é€šè®¯å½•â€</strong>ï¼å®ƒè®°å½•äº†â€œè°ï¼ˆ<code>Watcher</code>ï¼‰å…³å¿ƒæˆ‘ï¼ˆæ•°æ®ï¼‰â€ã€‚æ•°æ®å˜åŒ–æ—¶ï¼Œå®ƒå°±ç¿»é€šè®¯å½•ï¼ŒæŒ¨ä¸ªé€šçŸ¥ç²‰ä¸ï¼ˆ<code>Watcher</code>ï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-4">ğŸ”„ ä¸‰è€…åä½œæµç¨‹ï¼ˆå¤§ç™½è¯ç‰ˆï¼‰</h3>
<ol>
<li>
<p><strong>åˆå§‹åŒ– (è£…å–‡å­ &amp; ç¿»é€šè®¯å½•)</strong>ï¼š</p>
<ul>
<li><code>Observer</code> ç®¡å®¶ï¼šç»™ <code>data</code> é‡Œçš„æ¯ä¸ªå±æ€§ï¼ˆå¦‚ <code>homeworkStatus</code>ï¼‰è£…ä¸Šâ€œå–‡å­â€ï¼ˆ<code>setter</code>ï¼‰å’Œâ€œè€³æœµâ€ï¼ˆ<code>getter</code>ï¼‰ã€‚æ¯ä¸ªå±æ€§éƒ½å¸¦ä¸€ä¸ªç©ºâ€œé€šè®¯å½•â€ï¼ˆ<code>Dep</code>ï¼‰ã€‚</li>
<li>æ¸²æŸ“ <code>Watcher</code>ï¼ˆå…¬å‘Šæ ï¼‰ï¼šå¯åŠ¨ï¼ä¸ºäº†æ˜¾ç¤ºå†…å®¹ï¼Œå®ƒå¿…é¡»è®¿é—® <code>homeworkStatus</code>ï¼ˆè§¦å‘ <code>getter</code>ï¼‰ã€‚</li>
<li><code>Observer</code> å¬åˆ°è®¿é—®ï¼šç«‹åˆ»åœ¨ <code>homeworkStatus</code> çš„â€œé€šè®¯å½•â€ï¼ˆ<code>Dep</code>ï¼‰ä¸Šè®°ä¸€ç¬”ï¼šâ€œå…¬å‘Šæ  <code>Watcher</code> å…³å¿ƒä½ ï¼â€ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ•°æ®å˜åŒ– (å¹¿æ’­é€šçŸ¥)</strong>ï¼š</p>
<ul>
<li>ä½ ä¿®æ”¹æ•°æ®ï¼š<code>this.homeworkStatus = 'å·²å®Œæˆ'</code>ã€‚</li>
<li><code>Observer</code> ç®¡å®¶ï¼šæ£€æµ‹åˆ° <code>homeworkStatus</code> çš„ <code>setter</code> è¢«è°ƒç”¨ï¼ç«‹åˆ»å¤§å–Šï¼šâ€œ<code>homeworkStatus</code> å˜äº†ï¼â€</li>
<li><code>Observer</code> ç®¡å®¶ï¼šæ‰¾åˆ° <code>homeworkStatus</code> çš„â€œé€šè®¯å½•â€ï¼ˆ<code>Dep</code>ï¼‰ï¼Œç¿»å¼€æ¥çœ‹ï¼šâ€œå“¦ï¼Œåªæœ‰å…¬å‘Šæ  <code>Watcher</code> å…³å¿ƒä½ ã€‚â€</li>
<li><code>Observer</code> ç®¡å®¶ï¼šæ‹¿èµ·ç”µè¯ï¼Œæ‹¨æ‰“â€œå…¬å‘Šæ  <code>Watcher</code>â€çš„å·ç ï¼šâ€œå–‚ï¼<code>homeworkStatus</code> å˜æˆ <code>'å·²å®Œæˆ'</code> äº†ï¼å¿«æ›´æ–°å…¬å‘Šæ ï¼â€</li>
</ul>
</li>
<li>
<p><strong>æ›´æ–°è§†å›¾ (ç²‰ä¸è¡ŒåŠ¨)</strong>ï¼š</p>
<ul>
<li>å…¬å‘Šæ  <code>Watcher</code>ï¼ˆç²‰ä¸ï¼‰æ¥åˆ°ç”µè¯ï¼šç«‹åˆ»è¡ŒåŠ¨ï¼é‡æ–°æ‰§è¡Œæ¸²æŸ“å‡½æ•°ã€‚</li>
<li>æ¸²æŸ“å‡½æ•°è®¿é—® <code>homeworkStatus</code>ï¼ˆå†æ¬¡è§¦å‘ <code>getter</code>ï¼Œä½†è¿™æ¬¡ä¸»è¦æ˜¯ä¸ºäº†è·å–æ–°å€¼ï¼‰ã€‚</li>
<li>å…¬å‘Šæ æ˜¾ç¤ºæ›´æ–°ä¸ºï¼šâ€œå°æ˜ä½œä¸šï¼šå·²å®Œæˆâ€ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-5">ğŸ‰ æ€»ç»“ä¸€å¥è¯</h3>
<blockquote>
<p><strong><code>Observer</code> ç»™æ•°æ®è£…ä¸Šâ€œè€³æœµâ€å’Œâ€œå–‡å­â€ï¼›<code>Watcher</code> å»å¬æ•°æ®ï¼ˆè§¦å‘è€³æœµï¼‰ï¼Œç™»è®°åœ¨æ•°æ®çš„â€œé€šè®¯å½•â€ï¼ˆ<code>Dep</code>ï¼‰ä¸Šï¼›æ•°æ®å˜åŒ–æ—¶ï¼ˆå–‡å­å“ï¼‰ï¼Œ<code>Dep</code> ç¿»é€šè®¯å½•é€šçŸ¥æ‰€æœ‰ <code>Watcher</code> å»æ›´æ–°è§†å›¾ï¼</strong></p>
</blockquote>
<p>è¿™æ ·ç†è§£æ˜¯ä¸æ˜¯æ¸…æ™°å¤šäº†ï¼Ÿå®ƒä»¬ä»¨å°±åƒä¸€ä¸ªé«˜æ•ˆçš„ç­çº§é€šçŸ¥ç³»ç»Ÿï¼Œç¡®ä¿æ•°æ®ä¸€å˜ï¼Œå…³å¿ƒå®ƒçš„åœ°æ–¹ï¼ˆè§†å›¾ã€ç”¨æˆ·ç›‘å¬å™¨ï¼‰èƒ½ç«‹åˆ»çŸ¥é“å¹¶åšå‡ºååº”ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Element Plus SCSS å˜é‡è¦†ç›–ç”¨æ³•]]></title>    <link>https://juejin.cn/post/7597076280984272959</link>    <guid>https://juejin.cn/post/7597076280984272959</guid>    <pubDate>2026-01-20T08:13:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597076280984272959" data-draft-id="7597076280984256575" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Element Plus SCSS å˜é‡è¦†ç›–ç”¨æ³•"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,Element"/> <meta itemprop="datePublished" content="2026-01-20T08:13:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç å†œå¼ 3"/> <meta itemprop="url" content="https://juejin.cn/user/3197850213167677"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Element Plus SCSS å˜é‡è¦†ç›–ç”¨æ³•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3197850213167677/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç å†œå¼ 3
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:13:25.000Z" title="Tue Jan 20 2026 08:13:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å®‰è£…ä¾èµ–</h2>
<pre><code class="hljs language-powershell" lang="powershell">pnpm i sass -D
</code></pre>
<h2 data-id="heading-1">æ ·å¼æ–‡ä»¶</h2>
<p><code>element-plus-vars.scss</code></p>
<pre><code class="hljs language-css" lang="css">// è¦†ç›–å˜é‡
<span class="hljs-keyword">@forward</span> <span class="hljs-string">"element-plus/theme-chalk/src/common/var.scss"</span> with (
  $<span class="hljs-attribute">colors</span>: (
    <span class="hljs-string">"primary"</span>: (
      <span class="hljs-string">"base"</span>: #<span class="hljs-number">4080</span>ff,
    ),
    <span class="hljs-string">"success"</span>: (
      <span class="hljs-string">"base"</span>: #<span class="hljs-number">23</span>c343,
    ),
    <span class="hljs-string">"warning"</span>: (
      <span class="hljs-string">"base"</span>: #ff9a2e,
    ),
    <span class="hljs-string">"danger"</span>: (
      <span class="hljs-string">"base"</span>: #f76560,
    ),
    <span class="hljs-string">"info"</span>: (
      <span class="hljs-string">"base"</span>: #a9aeb8,
    ),
  ),

  $<span class="hljs-attribute">bg-color</span>: (
    <span class="hljs-string">"page"</span>: #f5f8fd,
  )
);
// å¼•å…¥ Element Plus æ ·å¼ï¼ˆå¿…é¡»åœ¨è¦†ç›–å˜é‡åï¼‰
<span class="hljs-keyword">@use</span> <span class="hljs-string">"element-plus/theme-chalk/src/index.scss"</span>;
</code></pre>
<p><code>element-plus.scss</code></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/**
 * element-plus ç»„ä»¶æ ·å¼è¦†ç›–
 */</span>
// å˜é‡è¦†ç›–(å¿…é¡»åœ¨æœ€å‰é¢)
<span class="hljs-keyword">@use</span> <span class="hljs-string">"./element-plus-vars"</span>;
// å¼•å…¥ Element Plus æ ·å¼ï¼ˆå¿…é¡»åœ¨è¦†ç›–å˜é‡åï¼‰
<span class="hljs-keyword">@use</span> <span class="hljs-string">"element-plus/theme-chalk/src/index.scss"</span>;
...
</code></pre>
<h2 data-id="heading-2">å¯¼å…¥æ ·å¼</h2>
<p><code>index.scss</code></p>
<pre><code class="hljs language-css" lang="css">// é‡ç½®æ ·å¼
<span class="hljs-keyword">@use</span> <span class="hljs-string">"./reset"</span>;

// element-plus
<span class="hljs-keyword">@use</span> <span class="hljs-string">"./element-plus"</span>;
...
</code></pre>
<p><code>main.js</code></p>
<pre><code class="hljs language-javascript" lang="javascript">...
<span class="hljs-comment">// ===== æ ·å¼å¯¼å…¥ =====</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">"@/assets/styles/index.scss"</span>;
...
</code></pre>
<p><code>vite.config.js</code></p>
<pre><code class="hljs language-javascript" lang="javascript">...
<span class="hljs-comment">// è‡ªåŠ¨å¯¼å…¥</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-auto-import/vite'</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/vite'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElementPlusResolver</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/resolvers'</span>
...
<span class="hljs-attr">plugins</span>: [
    <span class="hljs-title function_">vue</span>(),
    <span class="hljs-comment">// è‡ªåŠ¨å¯¼å…¥ Element Plus ç»„ä»¶å’Œå‡½æ•°ï¼Œæ— éœ€æ‰‹åŠ¨ import</span>
    <span class="hljs-title class_">AutoImport</span>({
      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],
    }),
    <span class="hljs-comment">// è‡ªåŠ¨æ³¨å†Œ Element Plus ç»„ä»¶ï¼Œå¯åœ¨æ¨¡æ¿ä¸­ç›´æ¥ä½¿ç”¨ï¼Œé‡‡ç”¨sassæ ·å¼é…è‰²</span>
    <span class="hljs-title class_">Components</span>({
      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>({ <span class="hljs-attr">importStyle</span>: <span class="hljs-string">"sass"</span> })],
    }),
  ],  
...
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[cursorå¸¦æˆ‘å­¦ä¹ OpenManus æ¡†æ¶]]></title>    <link>https://juejin.cn/post/7597025960946040867</link>    <guid>https://juejin.cn/post/7597025960946040867</guid>    <pubDate>2026-01-20T07:37:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597025960946040867" data-draft-id="7597199288816599080" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="cursorå¸¦æˆ‘å­¦ä¹ OpenManus æ¡†æ¶"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½,Agent"/> <meta itemprop="datePublished" content="2026-01-20T07:37:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™ˆæš–ç§‹"/> <meta itemprop="url" content="https://juejin.cn/user/493019579297533"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            cursorå¸¦æˆ‘å­¦ä¹ OpenManus æ¡†æ¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/493019579297533/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™ˆæš–ç§‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:37:23.000Z" title="Tue Jan 20 2026 07:37:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#444;background-image:linear-gradient(90deg,rgba(59,59,59,.1) 3%,transparent 0),linear-gradient(1turn,rgba(122,120,121,.1) 3%,transparent 0);background-size:30px 30px;background-position:50%;letter-spacing:1px;word-spacing:1px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:34px;margin-bottom:16px;font-weight:700;line-height:1.3;cursor:text;color:#444;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body h1{font-size:41px;margin-bottom:34px;line-height:1.5}.markdown-body h1:before{content:""}.markdown-body h2{font-size:30px;padding-left:.4em;border-left:.4em solid #5e5e5e;border-bottom:1px solid #444}.markdown-body h2:after{content:"ğŸ•›";position:absolute;top:0;right:0;transition:all;animation:rotate 10s linear infinite}@keyframes rotate{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.markdown-body h3{border-left:.4em solid #8d8d8d;font-size:24px;padding-left:.4em}.markdown-body h4{font-size:20px}.markdown-body h5{font-size:16px}.markdown-body h6{font-size:14px}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body table,.markdown-body ul{margin:.8em 0}.markdown-body strong{font-weight:1000;position:relative;color:#444;padding:0 3px}.markdown-body em{font-weight:inherit}.markdown-body a{box-sizing:border-box;color:grey;position:relative}.markdown-body a:before{position:absolute;box-sizing:border-box;content:"Go -&gt;";left:0;width:100%;max-width:0;color:#fff;background-color:hsla(0,0%,50.2%,.8);white-space:nowrap;transition:.2s ease;pointer-events:none;overflow:hidden}.markdown-body a:after{content:"";position:absolute;bottom:0;left:0;width:100%;height:1px;background-color:grey}.markdown-body a:active:before,.markdown-body a:hover:before{max-width:100%;padding-left:8px;border-radius:5px}.markdown-body hr{position:relative;width:100%;height:1px;border:none;margin-top:36px;margin-bottom:36px;background:linear-gradient(90deg,grey,#f1f1f1,#444,#444,#f1f1f1,grey);overflow:visible}.markdown-body ol,.markdown-body ul{padding-left:32px}.markdown-body ol li,.markdown-body ul li{margin-bottom:6px;list-style:inherit}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol{counter-reset:my-counter}.markdown-body ol&gt;li{padding-left:6px;list-style:none;counter-increment:my-counter;position:relative}.markdown-body ol&gt;li:before{position:absolute;left:-1.5em;content:counter(my-counter);font-weight:700}.markdown-body ol&gt;li:first-child:before{content:"1ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(2):before{content:"2ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(3):before{content:"3ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(4):before{content:"4ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(5):before{content:"5ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(6):before{content:"6ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(7):before{content:"7ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(8):before{content:"8ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(9):before{content:"9ï¸âƒ£"}.markdown-body ol&gt;li:nth-child(10):before{content:"ğŸ”Ÿ"}.markdown-body ul&gt;li{list-style:none;position:relative}.markdown-body ul&gt;li:before{z-index:10;position:absolute;left:-1.57em;content:"ğŸ”¹";margin-right:12px}.markdown-body ul&gt;li input{margin-left:8px!important}.markdown-body blockquote{position:relative;background-color:#d3d3d3;padding:5px 10px;border-left:.2em solid #000;border-radius:3px;transition:all .8s ease}.markdown-body blockquote:hover{opacity:.7}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(69,69,77,.8);color:#fff;font-size:.87em;padding:.07em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:7px;overflow:hidden}.markdown-body pre:before{z-index:10;position:absolute;top:14px;left:14px;width:12px;height:12px;border-radius:50%;background:#fc625d;-webkit-box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;box-shadow:20px 0 #fdbc40,40px 0 #35cd4b;content:" "}.markdown-body pre:after{z-index:9;content:"";position:absolute;width:100%;height:40px;top:0;background-color:#1a1a1a}.markdown-body pre&gt;code{display:block;font-family:Menlo,Monaco,Consolas,Courier New,monospace;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#171717;color:#bababa;font-size:14px;padding:40px 20px 20px}.markdown-body del{color:grey}.markdown-body table{margin-bottom:1.25rem;border-collapse:collapse}.markdown-body table td,.markdown-body table th{margin:0;padding:8px;line-height:20px;vertical-align:middle;border:1px solid #ddd}.markdown-body table thead,.markdown-body table tr:nth-child(2n){background-color:#fcfcfc}.markdown-body table thead th,.markdown-body table tr:nth-child(2n) th{font-weight:700;vertical-align:middle;color:#444}.markdown-body table tbody tr td{font-weight:400;color:#444}.markdown-body table tbody tr:hover{background-color:#d3d3d3}.markdown-body table tbody tr:hover td{color:#fff}.markdown-body img{max-width:100%;margin:0 12px}@media (max-width:720px){.markdown-body h1{font-size:32.8px}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:19.2px}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:12.8px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p><strong>ç‰ˆæœ¬</strong>: 0.3.0
<strong>åˆ›å»ºæ—¥æœŸ</strong>: 2026å¹´1æœˆ20æ—¥</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ğŸ“š ç›®å½•</h2>
<ol>
<li><a href="#1-%E6%A1%86%E6%9E%B6%E6%A6%82%E8%BF%B0" title="#1-%E6%A1%86%E6%9E%B6%E6%A6%82%E8%BF%B0">æ¡†æ¶æ¦‚è¿°</a></li>
<li><a href="#2-%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84" title="#2-%E6%A0%B8%E5%BF%83%E6%9E%B6%E6%9E%84">æ ¸å¿ƒæ¶æ„</a></li>
<li><a href="#3-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E8%AF%A6%E8%A7%A3" title="#3-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6%E8%AF%A6%E8%A7%A3">æ ¸å¿ƒç»„ä»¶è¯¦è§£</a></li>
<li><a href="#4-%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B" title="#4-%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B">å·¥ä½œæµç¨‹</a></li>
<li><a href="#5-%E5%B7%A5%E5%85%B7%E7%B3%BB%E7%BB%9F" title="#5-%E5%B7%A5%E5%85%B7%E7%B3%BB%E7%BB%9F">å·¥å…·ç³»ç»Ÿ</a></li>
<li><a href="#6-%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F" title="#6-%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F">é…ç½®ç³»ç»Ÿ</a></li>
<li><a href="#7-%E5%AE%9E%E6%88%98%E7%A4%BA%E4%BE%8B" title="#7-%E5%AE%9E%E6%88%98%E7%A4%BA%E4%BE%8B">å®æˆ˜ç¤ºä¾‹</a></li>
<li><a href="#8-%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7" title="#8-%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7">é«˜çº§ç‰¹æ€§</a></li>
<li><a href="#9-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" title="#9-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5">æœ€ä½³å®è·µ</a></li>
<li><a href="#10-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98" title="#10-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98">å¸¸è§é—®é¢˜</a></li>
</ol>
<hr/>
<h2 data-id="heading-1">1. æ¡†æ¶æ¦‚è¿°</h2>
<h3 data-id="heading-2">1.1 ä»€ä¹ˆæ˜¯ OpenManus?</h3>
<p>OpenManus æ˜¯ä¸€ä¸ª<strong>å¼€æºçš„é€šç”¨ AI Agent æ¡†æ¶</strong>ï¼Œæ—¨åœ¨è§£å†³å„ç§å¤æ‚ä»»åŠ¡ã€‚å®ƒåŸºäº ReAct (Reasoning and Acting) èŒƒå¼ï¼Œç»“åˆäº†å·¥å…·è°ƒç”¨ã€æµè§ˆå™¨è‡ªåŠ¨åŒ–ã€ä»£ç æ‰§è¡Œç­‰å¤šç§èƒ½åŠ›ã€‚</p>
<p><strong>æ ¸å¿ƒç‰¹ç‚¹</strong>:</p>
<ul>
<li>âœ… <strong>æ— éœ€é‚€è¯·ç </strong>: å®Œå…¨å¼€æºï¼Œä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨</li>
<li>âœ… <strong>é€šç”¨æ€§å¼º</strong>: æ”¯æŒç¼–ç¨‹ã€ä¿¡æ¯æ£€ç´¢ã€æ–‡ä»¶å¤„ç†ã€ç½‘é¡µæµè§ˆç­‰å¤šç§ä»»åŠ¡</li>
<li>âœ… <strong>æ¶æ„æ¸…æ™°</strong>: åŸºäº ReAct èŒƒå¼çš„åˆ†å±‚æ¶æ„</li>
<li>âœ… <strong>å·¥å…·ä¸°å¯Œ</strong>: å†…ç½®å¤šç§å·¥å…·ï¼Œæ”¯æŒæ‰©å±•</li>
<li>âœ… <strong>æ²™ç®±æ”¯æŒ</strong>: å¯é€‰çš„ Docker æ²™ç®±ç¯å¢ƒä¿è¯å®‰å…¨æ‰§è¡Œ</li>
</ul>
<h3 data-id="heading-3">1.2 æŠ€æœ¯æ ˆ</h3>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">æ ¸å¿ƒæŠ€æœ¯:</span>
â”œâ”€â”€ Python 3.12+           <span class="hljs-comment"># ä¸»è¦å¼€å‘è¯­è¨€</span>
â”œâ”€â”€ Pydantic 2.x           <span class="hljs-comment"># æ•°æ®éªŒè¯å’Œé…ç½®ç®¡ç†</span>
â”œâ”€â”€ OpenAI API             <span class="hljs-comment"># LLM æ¥å£ (æ”¯æŒå¤šç§æ¨¡å‹)</span>
â”œâ”€â”€ AsyncIO                <span class="hljs-comment"># å¼‚æ­¥ç¼–ç¨‹</span>
â”œâ”€â”€ Browser-use            <span class="hljs-comment"># æµè§ˆå™¨è‡ªåŠ¨åŒ–</span>
â”œâ”€â”€ Docker                 <span class="hljs-comment"># æ²™ç®±ç¯å¢ƒ (å¯é€‰)</span>
â””â”€â”€ MCP (Model Context Protocol)  <span class="hljs-comment"># æ¨¡å‹ä¸Šä¸‹æ–‡åè®®</span>
</code></pre>
<h3 data-id="heading-4">1.3 é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-csharp" lang="csharp">OpenManus<span class="hljs-number">-0.3</span><span class="hljs-number">.0</span>/
â”œâ”€â”€ app/                    <span class="hljs-meta"># æ ¸å¿ƒåº”ç”¨ä»£ç </span>
â”‚   â”œâ”€â”€ agent/             <span class="hljs-meta"># Agent å®ç°</span>
â”‚   â”‚   â”œâ”€â”€ <span class="hljs-keyword">base</span>.py        <span class="hljs-meta"># Agent åŸºç±»</span>
â”‚   â”‚   â”œâ”€â”€ react.py       <span class="hljs-meta"># ReAct Agent</span>
â”‚   â”‚   â”œâ”€â”€ toolcall.py    <span class="hljs-meta"># å·¥å…·è°ƒç”¨ Agent</span>
â”‚   â”‚   â”œâ”€â”€ manus.py       <span class="hljs-meta"># Manus ä¸» Agent</span>
â”‚   â”‚   â”œâ”€â”€ browser.py     <span class="hljs-meta"># æµè§ˆå™¨è¾…åŠ©</span>
â”‚   â”‚   â””â”€â”€ mcp.py         <span class="hljs-meta"># MCP Agent</span>
â”‚   â”œâ”€â”€ tool/              <span class="hljs-meta"># å·¥å…·é›†åˆ</span>
â”‚   â”‚   â”œâ”€â”€ <span class="hljs-keyword">base</span>.py        <span class="hljs-meta"># å·¥å…·åŸºç±»</span>
â”‚   â”‚   â”œâ”€â”€ python_execute.py      <span class="hljs-meta"># Python æ‰§è¡Œ</span>
â”‚   â”‚   â”œâ”€â”€ str_replace_editor.py  <span class="hljs-meta"># æ–‡ä»¶ç¼–è¾‘</span>
â”‚   â”‚   â”œâ”€â”€ browser_use_tool.py    <span class="hljs-meta"># æµè§ˆå™¨å·¥å…·</span>
â”‚   â”‚   â”œâ”€â”€ web_search.py          <span class="hljs-meta"># ç½‘é¡µæœç´¢</span>
â”‚   â”‚   â””â”€â”€ tool_collection.py     <span class="hljs-meta"># å·¥å…·é›†åˆç®¡ç†</span>
â”‚   â”œâ”€â”€ sandbox/           <span class="hljs-meta"># æ²™ç®±ç¯å¢ƒ</span>
â”‚   â”‚   â”œâ”€â”€ client.py      <span class="hljs-meta"># æ²™ç®±å®¢æˆ·ç«¯</span>
â”‚   â”‚   â””â”€â”€ core/          <span class="hljs-meta"># æ ¸å¿ƒæ²™ç®±å®ç°</span>
â”‚   â”œâ”€â”€ prompt/            <span class="hljs-meta"># æç¤ºè¯æ¨¡æ¿</span>
â”‚   â”œâ”€â”€ flow/              <span class="hljs-meta"># å¤š Agent æµç¨‹ç¼–æ’</span>
â”‚   â”œâ”€â”€ llm.py             <span class="hljs-meta"># LLM æ¥å£å°è£…</span>
â”‚   â”œâ”€â”€ config.py          <span class="hljs-meta"># é…ç½®ç®¡ç†</span>
â”‚   â”œâ”€â”€ schema.py          <span class="hljs-meta"># æ•°æ®æ¨¡å‹å®šä¹‰</span>
â”‚   â””â”€â”€ logger.py          <span class="hljs-meta"># æ—¥å¿—ç³»ç»Ÿ</span>
â”œâ”€â”€ config/                <span class="hljs-meta"># é…ç½®æ–‡ä»¶</span>
â”‚   â””â”€â”€ config.toml        <span class="hljs-meta"># ä¸»é…ç½®æ–‡ä»¶</span>
â”œâ”€â”€ workspace/             <span class="hljs-meta"># å·¥ä½œç©ºé—´ç›®å½•</span>
â”œâ”€â”€ main.py                <span class="hljs-meta"># ä¸»å…¥å£</span>
â”œâ”€â”€ run_mcp.py             <span class="hljs-meta"># MCP æ¨¡å¼å…¥å£</span>
â”œâ”€â”€ run_flow.py            <span class="hljs-meta"># å¤š Agent æµç¨‹å…¥å£</span>
â””â”€â”€ requirements.txt       <span class="hljs-meta"># ä¾èµ–åŒ…åˆ—è¡¨</span>
</code></pre>
<hr/>
<h2 data-id="heading-5">2. æ ¸å¿ƒæ¶æ„</h2>
<h3 data-id="heading-6">2.1 æ¶æ„æ€»è§ˆ</h3>
<p>OpenManus é‡‡ç”¨<strong>åˆ†å±‚æ¶æ„è®¾è®¡</strong>:</p>
<pre><code class="hljs language-markdown" lang="markdown">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç”¨æˆ·äº¤äº’å±‚                          â”‚
â”‚        (CLI / API / Web Interface)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<span class="hljs-code">                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Agent å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Manus   â”‚  â”‚   MCP    â”‚  â”‚  å…¶ä»–    â”‚      â”‚
â”‚  â”‚  Agent   â”‚  â”‚  Agent   â”‚  â”‚  Agents  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         åŸºäº ReAct èŒƒå¼                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å·¥å…·å±‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Python  â”‚  â”‚  æ–‡ä»¶    â”‚  â”‚  æµè§ˆå™¨  â”‚      â”‚
â”‚  â”‚  æ‰§è¡Œ    â”‚  â”‚  ç¼–è¾‘    â”‚  â”‚  è‡ªåŠ¨åŒ–  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚  æœç´¢    â”‚  â”‚  ç»ˆæ­¢    â”‚  ...               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            åŸºç¡€è®¾æ–½å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚   LLM    â”‚  â”‚  æ²™ç®±    â”‚  â”‚  é…ç½®    â”‚      â”‚
â”‚  â”‚  æ¥å£    â”‚  â”‚  ç¯å¢ƒ    â”‚  â”‚  ç®¡ç†    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre>
<h3 data-id="heading-7">2.2 è®¾è®¡æ¨¡å¼</h3>
<h4 data-id="heading-8">2.2.1 ReAct (Reasoning and Acting) èŒƒå¼</h4>
<p>OpenManus çš„æ ¸å¿ƒæ˜¯ <strong>ReAct</strong> èŒƒå¼ï¼Œæ¯ä¸ªæ­¥éª¤åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µ:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ReActAgent</span>(<span class="hljs-title class_ inherited__">BaseAgent</span>):
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ‰§è¡Œä¸€ä¸ªå®Œæ•´çš„ ReAct æ­¥éª¤"""</span>
        <span class="hljs-comment"># 1. Think: æ¨ç†å’Œå†³ç­–</span>
        should_act = <span class="hljs-keyword">await</span> self.think()

        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> should_act:
            <span class="hljs-keyword">return</span> <span class="hljs-string">"Thinking complete - no action needed"</span>

        <span class="hljs-comment"># 2. Act: æ‰§è¡ŒåŠ¨ä½œ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self.act()
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong>:</p>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·è¾“å…¥ â†’ Think (åˆ†æä»»åŠ¡) â†’ Act (æ‰§è¡Œå·¥å…·) â†’
è§‚å¯Ÿç»“æœ â†’ Think (åˆ†æç»“æœ) â†’ Act (ä¸‹ä¸€æ­¥æ“ä½œ) â†’
... å¾ªç¯ç›´åˆ°å®Œæˆæˆ–è¾¾åˆ°æœ€å¤§æ­¥æ•°
</code></pre>
<h4 data-id="heading-9">2.2.2 å·¥å…·è°ƒç”¨æ¨¡å¼</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolCallAgent</span>(<span class="hljs-title class_ inherited__">ReActAgent</span>):
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
        <span class="hljs-string">"""ä½¿ç”¨ LLM å†³å®šè°ƒç”¨å“ªäº›å·¥å…·"""</span>
        response = <span class="hljs-keyword">await</span> self.llm.ask_tool(
            messages=self.messages,
            tools=self.available_tools.to_params(),
            tool_choice=self.tool_choices,
        )
        self.tool_calls = response.tool_calls
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bool</span>(self.tool_calls)

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">act</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""æ‰§è¡Œå·¥å…·è°ƒç”¨å¹¶æ”¶é›†ç»“æœ"""</span>
        results = []
        <span class="hljs-keyword">for</span> tool_call <span class="hljs-keyword">in</span> self.tool_calls:
            result = <span class="hljs-keyword">await</span> self.execute_tool(tool_call)
            results.append(result)
        <span class="hljs-keyword">return</span> <span class="hljs-string">"\n\n"</span>.join(results)
</code></pre>
<hr/>
<h2 data-id="heading-10">3. æ ¸å¿ƒç»„ä»¶è¯¦è§£</h2>
<h3 data-id="heading-11">3.1 Agent ç»„ä»¶</h3>
<h4 data-id="heading-12">3.1.1 BaseAgent (åŸºç¡€ Agent)</h4>
<p><strong>èŒè´£</strong>: æä¾› Agent çš„åŸºç¡€åŠŸèƒ½å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†</p>
<p><strong>æ ¸å¿ƒå±æ€§</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseAgent</span>(BaseModel, ABC):
    name: <span class="hljs-built_in">str</span>                    <span class="hljs-comment"># Agent åç§°</span>
    description: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]   <span class="hljs-comment"># Agent æè¿°</span>
    system_prompt: <span class="hljs-built_in">str</span>           <span class="hljs-comment"># ç³»ç»Ÿæç¤ºè¯</span>
    next_step_prompt: <span class="hljs-built_in">str</span>        <span class="hljs-comment"># ä¸‹ä¸€æ­¥æç¤ºè¯</span>
    llm: LLM                     <span class="hljs-comment"># è¯­è¨€æ¨¡å‹å®ä¾‹</span>
    memory: Memory               <span class="hljs-comment"># å¯¹è¯è®°å¿†</span>
    state: AgentState            <span class="hljs-comment"># å½“å‰çŠ¶æ€ (IDLE/RUNNING/FINISHED/ERROR)</span>
    max_steps: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span>          <span class="hljs-comment"># æœ€å¤§æ­¥æ•°</span>
    current_step: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>        <span class="hljs-comment"># å½“å‰æ­¥æ•°</span>
</code></pre>
<p><strong>æ ¸å¿ƒæ–¹æ³•</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, request: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æ‰§è¡Œ Agent ä¸»å¾ªç¯"""</span>
    <span class="hljs-comment"># 1. åˆå§‹åŒ–ç”¨æˆ·è¯·æ±‚</span>
    <span class="hljs-comment"># 2. å¾ªç¯æ‰§è¡Œ step() ç›´åˆ°å®Œæˆæˆ–è¶…è¿‡æœ€å¤§æ­¥æ•°</span>
    <span class="hljs-comment"># 3. è¿”å›æ‰§è¡Œç»“æœ</span>

<span class="hljs-meta">@abstractmethod</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""æ‰§è¡Œå•æ­¥æ“ä½œ (å­ç±»å®ç°)"""</span>
</code></pre>
<p><strong>çŠ¶æ€ç®¡ç†</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># çŠ¶æ€è½¬æ¢ä¸Šä¸‹æ–‡ç®¡ç†å™¨</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.state_context(AgentState.RUNNING):
    <span class="hljs-comment"># æ‰§è¡Œä»»åŠ¡</span>
    ...
<span class="hljs-comment"># è‡ªåŠ¨æ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€æˆ–å¤„ç†é”™è¯¯</span>
</code></pre>
<h4 data-id="heading-13">3.1.2 ReActAgent (ReAct Agent)</h4>
<p><strong>èŒè´£</strong>: å®ç° ReAct èŒƒå¼çš„æ€è€ƒ-è¡ŒåŠ¨å¾ªç¯</p>
<p><strong>æ ¸å¿ƒæ–¹æ³•</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@abstractmethod</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-string">"""æ€è€ƒ: åˆ†æå½“å‰çŠ¶æ€ï¼Œå†³å®šæ˜¯å¦éœ€è¦è¡ŒåŠ¨"""</span>

<span class="hljs-meta">@abstractmethod</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">act</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""è¡ŒåŠ¨: æ‰§è¡Œå…·ä½“æ“ä½œ"""</span>

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">step</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-string">"""ç»„åˆ think å’Œ act"""</span>
    should_act = <span class="hljs-keyword">await</span> self.think()
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> should_act:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Thinking complete - no action needed"</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self.act()
</code></pre>
<h4 data-id="heading-14">3.1.3 ToolCallAgent (å·¥å…·è°ƒç”¨ Agent)</h4>
<p><strong>èŒè´£</strong>: ç®¡ç†å·¥å…·è°ƒç”¨å’Œæ‰§è¡Œ</p>
<p><strong>æ ¸å¿ƒå±æ€§</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolCallAgent</span>(<span class="hljs-title class_ inherited__">ReActAgent</span>):
    available_tools: ToolCollection      <span class="hljs-comment"># å¯ç”¨å·¥å…·é›†åˆ</span>
    tool_choices: TOOL_CHOICE_TYPE       <span class="hljs-comment"># å·¥å…·é€‰æ‹©ç­–ç•¥ (auto/required/none)</span>
    special_tool_names: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>]        <span class="hljs-comment"># ç‰¹æ®Šå·¥å…·åç§° (å¦‚ terminate)</span>
    max_observe: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">int</span>]           <span class="hljs-comment"># è§‚å¯Ÿç»“æœçš„æœ€å¤§é•¿åº¦</span>
</code></pre>
<p><strong>Think é˜¶æ®µå®ç°</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-comment"># 1. æ„é€ æ¶ˆæ¯ (åŒ…å«ç³»ç»Ÿæç¤ºå’Œå†å²å¯¹è¯)</span>
    messages = [system_msg] + self.messages

    <span class="hljs-comment"># 2. è°ƒç”¨ LLM è·å–å·¥å…·è°ƒç”¨å†³ç­–</span>
    response = <span class="hljs-keyword">await</span> self.llm.ask_tool(
        messages=messages,
        tools=self.available_tools.to_params(),
        tool_choice=self.tool_choices,
    )

    <span class="hljs-comment"># 3. æå–å·¥å…·è°ƒç”¨</span>
    self.tool_calls = response.tool_calls

    <span class="hljs-comment"># 4. å°† LLM å“åº”æ·»åŠ åˆ°è®°å¿†</span>
    self.memory.add_message(...)

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bool</span>(self.tool_calls)
</code></pre>
<p><strong>Act é˜¶æ®µå®ç°</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">act</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
    results = []
    <span class="hljs-keyword">for</span> tool_call <span class="hljs-keyword">in</span> self.tool_calls:
        <span class="hljs-comment"># 1. æ‰§è¡Œå·¥å…·</span>
        result = <span class="hljs-keyword">await</span> self.execute_tool(tool_call)

        <span class="hljs-comment"># 2. æˆªæ–­è¿‡é•¿çš„ç»“æœ</span>
        <span class="hljs-keyword">if</span> self.max_observe:
            result = result[:self.max_observe]

        <span class="hljs-comment"># 3. æ·»åŠ å·¥å…·å“åº”åˆ°è®°å¿†</span>
        self.memory.add_message(
            Message.tool_message(
                content=result,
                tool_call_id=tool_call.<span class="hljs-built_in">id</span>,
                name=tool_call.function.name
            )
        )
        results.append(result)

    <span class="hljs-keyword">return</span> <span class="hljs-string">"\n\n"</span>.join(results)
</code></pre>
<h4 data-id="heading-15">3.1.4 Manus (é€šç”¨ Agent)</h4>
<p><strong>èŒè´£</strong>: OpenManus çš„ä¸»è¦ Agentï¼Œæä¾›é€šç”¨ä»»åŠ¡è§£å†³èƒ½åŠ›</p>
<p><strong>é…ç½®</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Manus</span>(<span class="hljs-title class_ inherited__">ToolCallAgent</span>):
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"Manus"</span>
    system_prompt: <span class="hljs-built_in">str</span> = SYSTEM_PROMPT  <span class="hljs-comment"># é€šç”¨ç³»ç»Ÿæç¤º</span>
    max_steps: <span class="hljs-built_in">int</span> = <span class="hljs-number">20</span>                  <span class="hljs-comment"># æœ€å¤§æ­¥æ•°</span>
    max_observe: <span class="hljs-built_in">int</span> = <span class="hljs-number">10000</span>            <span class="hljs-comment"># è§‚å¯Ÿç»“æœæœ€å¤§é•¿åº¦</span>

    <span class="hljs-comment"># é»˜è®¤å·¥å…·é›†</span>
    available_tools: ToolCollection = ToolCollection(
        PythonExecute(),        <span class="hljs-comment"># Python ä»£ç æ‰§è¡Œ</span>
        BrowserUseTool(),       <span class="hljs-comment"># æµè§ˆå™¨è‡ªåŠ¨åŒ–</span>
        StrReplaceEditor(),     <span class="hljs-comment"># æ–‡ä»¶ç¼–è¾‘</span>
        Terminate()             <span class="hljs-comment"># ç»ˆæ­¢å·¥å…·</span>
    )
</code></pre>
<p><strong>ç‰¹æ®ŠåŠŸèƒ½ - æµè§ˆå™¨ä¸Šä¸‹æ–‡å¢å¼º</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-comment"># æ£€æµ‹æ˜¯å¦æ­£åœ¨ä½¿ç”¨æµè§ˆå™¨</span>
    browser_in_use = <span class="hljs-comment"># æ£€æŸ¥æœ€è¿‘çš„å·¥å…·è°ƒç”¨</span>

    <span class="hljs-keyword">if</span> browser_in_use:
        <span class="hljs-comment"># æ·»åŠ æµè§ˆå™¨çŠ¶æ€ä¿¡æ¯åˆ°æç¤ºè¯</span>
        self.next_step_prompt = <span class="hljs-keyword">await</span> self.browser_context_helper.format_next_step_prompt()

    result = <span class="hljs-keyword">await</span> <span class="hljs-built_in">super</span>().think()

    <span class="hljs-comment"># æ¢å¤åŸå§‹æç¤ºè¯</span>
    self.next_step_prompt = original_prompt
    <span class="hljs-keyword">return</span> result
</code></pre>
<h3 data-id="heading-16">3.2 LLM ç»„ä»¶</h3>
<h4 data-id="heading-17">3.2.1 LLM ç±»è®¾è®¡</h4>
<p><strong>èŒè´£</strong>: å°è£…ä¸å¤§è¯­è¨€æ¨¡å‹çš„äº¤äº’ï¼Œæ”¯æŒå¤šç§æ¨¡å‹å’Œæ¥å£</p>
<p><strong>æ ¸å¿ƒç‰¹æ€§</strong>:</p>
<ul>
<li>âœ… æ”¯æŒ OpenAIã€Azure OpenAIã€AWS Bedrockã€Ollama</li>
<li>âœ… Token è®¡æ•°å’Œé™åˆ¶</li>
<li>âœ… è‡ªåŠ¨é‡è¯•æœºåˆ¶</li>
<li>âœ… æµå¼å’Œéæµå¼è¾“å‡º</li>
<li>âœ… å¤šæ¨¡æ€æ”¯æŒ (æ–‡æœ¬ + å›¾ç‰‡)</li>
<li>âœ… å·¥å…·è°ƒç”¨æ”¯æŒ</li>
</ul>
<p><strong>åˆå§‹åŒ–</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LLM</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, config_name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"default"</span></span>):
        <span class="hljs-comment"># ä»é…ç½®åŠ è½½ LLM è®¾ç½®</span>
        llm_config = config.llm[config_name]

        self.model = llm_config.model
        self.max_tokens = llm_config.max_tokens
        self.temperature = llm_config.temperature
        self.api_type = llm_config.api_type

        <span class="hljs-comment"># Token è¿½è¸ª</span>
        self.total_input_tokens = <span class="hljs-number">0</span>
        self.total_completion_tokens = <span class="hljs-number">0</span>
        self.max_input_tokens = llm_config.max_input_tokens

        <span class="hljs-comment"># åˆå§‹åŒ– tokenizer</span>
        self.tokenizer = tiktoken.encoding_for_model(self.model)
        self.token_counter = TokenCounter(self.tokenizer)

        <span class="hljs-comment"># åˆå§‹åŒ–å®¢æˆ·ç«¯</span>
        <span class="hljs-keyword">if</span> self.api_type == <span class="hljs-string">"azure"</span>:
            self.client = AsyncAzureOpenAI(...)
        <span class="hljs-keyword">elif</span> self.api_type == <span class="hljs-string">"aws"</span>:
            self.client = BedrockClient()
        <span class="hljs-keyword">else</span>:
            self.client = AsyncOpenAI(...)
</code></pre>
<p><strong>æ ¸å¿ƒæ–¹æ³•</strong>:</p>
<ol>
<li><strong>åŸºç¡€å¯¹è¯</strong> (<code>ask</code>):</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@retry(<span class="hljs-params">...</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">ask</span>(<span class="hljs-params">
    self,
    messages: <span class="hljs-type">List</span>[Message],
    system_msgs: <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>[Message]] = <span class="hljs-literal">None</span>,
    stream: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">True</span>,
    temperature: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">float</span>] = <span class="hljs-literal">None</span>,
</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-comment"># 1. æ ¼å¼åŒ–æ¶ˆæ¯ (å¤„ç†å›¾ç‰‡ç­‰)</span>
    formatted_messages = self.format_messages(messages, supports_images=<span class="hljs-literal">True</span>)

    <span class="hljs-comment"># 2. Token è®¡æ•°å’Œé™åˆ¶æ£€æŸ¥</span>
    input_tokens = self.count_message_tokens(formatted_messages)
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.check_token_limit(input_tokens):
        <span class="hljs-keyword">raise</span> TokenLimitExceeded(...)

    <span class="hljs-comment"># 3. è°ƒç”¨ LLM API</span>
    response = <span class="hljs-keyword">await</span> self.client.chat.completions.create(...)

    <span class="hljs-comment"># 4. æ›´æ–° Token ç»Ÿè®¡</span>
    self.update_token_count(input_tokens, completion_tokens)

    <span class="hljs-keyword">return</span> response
</code></pre>
<ol start="2">
<li><strong>å·¥å…·è°ƒç”¨</strong> (<code>ask_tool</code>):</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@retry(<span class="hljs-params">...</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">ask_tool</span>(<span class="hljs-params">
    self,
    messages: <span class="hljs-type">List</span>[Message],
    tools: <span class="hljs-type">List</span>[<span class="hljs-built_in">dict</span>],
    tool_choice: <span class="hljs-built_in">str</span> = <span class="hljs-string">"auto"</span>,
    **kwargs
</span>) -&gt; ChatCompletionMessage:
    <span class="hljs-comment"># 1. éªŒè¯ tool_choice</span>
    <span class="hljs-comment"># 2. æ ¼å¼åŒ–æ¶ˆæ¯å’Œå·¥å…·</span>
    <span class="hljs-comment"># 3. è®¡ç®— Token (åŒ…æ‹¬å·¥å…·æè¿°)</span>
    <span class="hljs-comment"># 4. è°ƒç”¨ API</span>
    <span class="hljs-comment"># 5. è¿”å›åŒ…å«å·¥å…·è°ƒç”¨çš„å“åº”</span>
</code></pre>
<ol start="3">
<li><strong>å›¾ç‰‡å¯¹è¯</strong> (<code>ask_with_images</code>):</li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@retry(<span class="hljs-params">...</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">ask_with_images</span>(<span class="hljs-params">
    self,
    messages: <span class="hljs-type">List</span>[Message],
    images: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>],  <span class="hljs-comment"># base64 æˆ– URL</span>
    **kwargs
</span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-comment"># å¤„ç†å¤šæ¨¡æ€è¾“å…¥</span>
</code></pre>
<h4 data-id="heading-18">3.2.2 Token ç®¡ç†</h4>
<p><strong>Token è®¡æ•°å™¨</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">TokenCounter</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">count_message_tokens</span>(<span class="hljs-params">self, messages: <span class="hljs-type">List</span>[<span class="hljs-built_in">dict</span>]</span>) -&gt; <span class="hljs-built_in">int</span>:
        total = FORMAT_TOKENS  <span class="hljs-comment"># åŸºç¡€æ ¼å¼ token</span>

        <span class="hljs-keyword">for</span> message <span class="hljs-keyword">in</span> messages:
            tokens = BASE_MESSAGE_TOKENS  <span class="hljs-comment"># æ¯æ¡æ¶ˆæ¯çš„åŸºç¡€ token</span>
            tokens += self.count_text(message.get(<span class="hljs-string">"role"</span>, <span class="hljs-string">""</span>))
            tokens += self.count_content(message[<span class="hljs-string">"content"</span>])

            <span class="hljs-keyword">if</span> <span class="hljs-string">"tool_calls"</span> <span class="hljs-keyword">in</span> message:
                tokens += self.count_tool_calls(message[<span class="hljs-string">"tool_calls"</span>])

            total += tokens

        <span class="hljs-keyword">return</span> total
</code></pre>
<p><strong>Token é™åˆ¶æ£€æŸ¥</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_token_limit</span>(<span class="hljs-params">self, input_tokens: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-keyword">if</span> self.max_input_tokens <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>  <span class="hljs-comment"># æ— é™åˆ¶</span>

    <span class="hljs-keyword">return</span> (self.total_input_tokens + input_tokens) &lt;= self.max_input_tokens
</code></pre>
<h3 data-id="heading-19">3.3 Memory ç»„ä»¶</h3>
<p><strong>èŒè´£</strong>: ç®¡ç†å¯¹è¯å†å²å’Œä¸Šä¸‹æ–‡</p>
<p><strong>æ•°æ®ç»“æ„</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Message</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    role: <span class="hljs-built_in">str</span>                           <span class="hljs-comment"># "system" | "user" | "assistant" | "tool"</span>
    content: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]              <span class="hljs-comment"># æ¶ˆæ¯å†…å®¹</span>
    tool_calls: <span class="hljs-type">Optional</span>[<span class="hljs-type">List</span>[ToolCall]]  <span class="hljs-comment"># å·¥å…·è°ƒç”¨</span>
    tool_call_id: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]         <span class="hljs-comment"># å·¥å…·è°ƒç”¨ ID</span>
    name: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]                 <span class="hljs-comment"># å·¥å…·åç§°</span>
    base64_image: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>]         <span class="hljs-comment"># å›¾ç‰‡æ•°æ®</span>

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Memory</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    messages: <span class="hljs-type">List</span>[Message] = []
    max_messages: <span class="hljs-built_in">int</span> = <span class="hljs-number">100</span>
</code></pre>
<p><strong>æ ¸å¿ƒæ–¹æ³•</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">add_message</span>(<span class="hljs-params">self, message: Message</span>) -&gt; <span class="hljs-literal">None</span>:
    <span class="hljs-string">"""æ·»åŠ æ¶ˆæ¯å¹¶è‡ªåŠ¨è£å‰ª"""</span>
    self.messages.append(message)
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.messages) &gt; self.max_messages:
        self.messages = self.messages[-self.max_messages:]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_recent_messages</span>(<span class="hljs-params">self, n: <span class="hljs-built_in">int</span></span>) -&gt; <span class="hljs-type">List</span>[Message]:
    <span class="hljs-string">"""è·å–æœ€è¿‘çš„ n æ¡æ¶ˆæ¯"""</span>
    <span class="hljs-keyword">return</span> self.messages[-n:]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">to_dict_list</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-built_in">dict</span>]:
    <span class="hljs-string">"""è½¬æ¢ä¸ºå­—å…¸åˆ—è¡¨ (ç”¨äº LLM API)"""</span>
    <span class="hljs-keyword">return</span> [msg.to_dict() <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> self.messages]
</code></pre>
<hr/>
<h2 data-id="heading-20">4. å·¥ä½œæµç¨‹</h2>
<h3 data-id="heading-21">4.1 å®Œæ•´æ‰§è¡Œæµç¨‹</h3>
<pre><code class="hljs language-python" lang="python">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">1.</span> åˆå§‹åŒ–                                        â”‚
â”‚    - åŠ è½½é…ç½®                                    â”‚
â”‚    - åˆ›å»º Agent (Manus)                         â”‚
â”‚    - åˆå§‹åŒ– LLM å®¢æˆ·ç«¯                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">2.</span> æ¥æ”¶ç”¨æˆ·è¾“å…¥                                  â”‚
â”‚    prompt = <span class="hljs-built_in">input</span>(<span class="hljs-string">"Enter your prompt: "</span>)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">3.</span> å¯åŠ¨ Agent                                    â”‚
â”‚    <span class="hljs-keyword">await</span> agent.run(prompt)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">4.</span> ä¸»å¾ªç¯ (ReAct)                                â”‚
â”‚    <span class="hljs-keyword">while</span> current_step &lt; max_steps:              â”‚
â”‚        â”œâ”€ Think: LLM åˆ†æå’Œå†³ç­–                 â”‚
â”‚        â”‚   - æ„é€ æ¶ˆæ¯ (system + history)         â”‚
â”‚        â”‚   - è°ƒç”¨ LLM API                        â”‚
â”‚        â”‚   - è§£æå·¥å…·è°ƒç”¨                        â”‚
â”‚        â”‚                                         â”‚
â”‚        â”œâ”€ Act: æ‰§è¡Œå·¥å…·                          â”‚
â”‚        â”‚   - éå†å·¥å…·è°ƒç”¨åˆ—è¡¨                    â”‚
â”‚        â”‚   - æ‰§è¡Œæ¯ä¸ªå·¥å…·                        â”‚
â”‚        â”‚   - æ”¶é›†ç»“æœ                            â”‚
â”‚        â”‚                                         â”‚
â”‚        â””â”€ æ›´æ–°è®°å¿†å’ŒçŠ¶æ€                         â”‚
â”‚            - ä¿å­˜ LLM å“åº”                       â”‚
â”‚            - ä¿å­˜å·¥å…·ç»“æœ                        â”‚
â”‚            - æ£€æŸ¥æ˜¯å¦å®Œæˆ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">5.</span> æ¸…ç†å’Œè¿”å›                                    â”‚
â”‚    - æ¸…ç†èµ„æº (æµè§ˆå™¨ç­‰)                         â”‚
â”‚    - è¿”å›æ‰§è¡Œç»“æœ                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-22">4.2 è¯¦ç»†æ­¥éª¤åˆ†è§£</h3>
<h4 data-id="heading-23">Step 1: åˆå§‹åŒ–</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># main.py</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():
    <span class="hljs-comment"># 1.1 åˆ›å»º Manus Agent</span>
    agent = Manus()
    <span class="hljs-comment"># å†…éƒ¨æµç¨‹:</span>
    <span class="hljs-comment"># - åŠ è½½é…ç½® (config.toml)</span>
    <span class="hljs-comment"># - åˆå§‹åŒ– LLM (æ ¹æ®é…ç½®)</span>
    <span class="hljs-comment"># - åˆ›å»º Memory</span>
    <span class="hljs-comment"># - åˆå§‹åŒ–å·¥å…·é›†åˆ</span>

    <span class="hljs-comment"># 1.2 è·å–ç”¨æˆ·è¾“å…¥</span>
    prompt = <span class="hljs-built_in">input</span>(<span class="hljs-string">"Enter your prompt: "</span>)

    <span class="hljs-comment"># 1.3 å¯åŠ¨æ‰§è¡Œ</span>
    <span class="hljs-keyword">await</span> agent.run(prompt)
</code></pre>
<h4 data-id="heading-24">Step 2: Agent ä¸»å¾ªç¯</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/agent/base.py</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, request: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-comment"># 2.1 åˆå§‹åŒ–ç”¨æˆ·æ¶ˆæ¯</span>
    self.update_memory(<span class="hljs-string">"user"</span>, request)

    <span class="hljs-comment"># 2.2 è¿›å…¥è¿è¡ŒçŠ¶æ€</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> self.state_context(AgentState.RUNNING):
        <span class="hljs-comment"># 2.3 ä¸»å¾ªç¯</span>
        <span class="hljs-keyword">while</span> self.current_step &lt; self.max_steps:
            self.current_step += <span class="hljs-number">1</span>

            <span class="hljs-comment"># 2.4 æ‰§è¡Œä¸€æ­¥ (Think + Act)</span>
            step_result = <span class="hljs-keyword">await</span> self.step()

            <span class="hljs-comment"># 2.5 æ£€æµ‹æ­»å¾ªç¯</span>
            <span class="hljs-keyword">if</span> self.is_stuck():
                self.handle_stuck_state()

            <span class="hljs-comment"># 2.6 æ£€æŸ¥æ˜¯å¦å®Œæˆ</span>
            <span class="hljs-keyword">if</span> self.state == AgentState.FINISHED:
                <span class="hljs-keyword">break</span>
</code></pre>
<h4 data-id="heading-25">Step 3: Think é˜¶æ®µ</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/agent/toolcall.py</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">think</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-comment"># 3.1 å‡†å¤‡æç¤ºè¯</span>
    <span class="hljs-keyword">if</span> self.next_step_prompt:
        self.messages.append(Message.user_message(self.next_step_prompt))

    <span class="hljs-comment"># 3.2 è°ƒç”¨ LLM</span>
    response = <span class="hljs-keyword">await</span> self.llm.ask_tool(
        messages=self.messages,
        system_msgs=[Message.system_message(self.system_prompt)],
        tools=self.available_tools.to_params(),
        tool_choice=self.tool_choices,
    )

    <span class="hljs-comment"># 3.3 æå–å·¥å…·è°ƒç”¨</span>
    self.tool_calls = response.tool_calls
    content = response.content

    <span class="hljs-comment"># 3.4 è®°å½•æ—¥å¿—</span>
    logger.info(<span class="hljs-string">f"âœ¨ Thoughts: <span class="hljs-subst">{content}</span>"</span>)
    logger.info(<span class="hljs-string">f"ğŸ› ï¸ Selected <span class="hljs-subst">{<span class="hljs-built_in">len</span>(self.tool_calls)}</span> tools"</span>)

    <span class="hljs-comment"># 3.5 ä¿å­˜åˆ°è®°å¿†</span>
    <span class="hljs-keyword">if</span> self.tool_calls:
        msg = Message.from_tool_calls(content, self.tool_calls)
    <span class="hljs-keyword">else</span>:
        msg = Message.assistant_message(content)
    self.memory.add_message(msg)

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bool</span>(self.tool_calls)
</code></pre>
<h4 data-id="heading-26">Step 4: Act é˜¶æ®µ</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/agent/toolcall.py</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">act</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">str</span>:
    results = []

    <span class="hljs-comment"># 4.1 éå†å·¥å…·è°ƒç”¨</span>
    <span class="hljs-keyword">for</span> tool_call <span class="hljs-keyword">in</span> self.tool_calls:
        <span class="hljs-comment"># 4.2 è§£æå‚æ•°</span>
        args = json.loads(tool_call.function.arguments)

        <span class="hljs-comment"># 4.3 æ‰§è¡Œå·¥å…·</span>
        result = <span class="hljs-keyword">await</span> self.available_tools.execute(
            name=tool_call.function.name,
            tool_input=args
        )

        <span class="hljs-comment"># 4.4 å¤„ç†ç‰¹æ®Šå·¥å…· (å¦‚ terminate)</span>
        <span class="hljs-keyword">if</span> tool_call.function.name <span class="hljs-keyword">in</span> self.special_tool_names:
            self.state = AgentState.FINISHED

        <span class="hljs-comment"># 4.5 æˆªæ–­è¿‡é•¿ç»“æœ</span>
        <span class="hljs-keyword">if</span> self.max_observe:
            result = result[:self.max_observe]

        <span class="hljs-comment"># 4.6 ä¿å­˜åˆ°è®°å¿†</span>
        self.memory.add_message(
            Message.tool_message(
                content=result,
                tool_call_id=tool_call.<span class="hljs-built_in">id</span>,
                name=tool_call.function.name
            )
        )

        results.append(result)

    <span class="hljs-keyword">return</span> <span class="hljs-string">"\n\n"</span>.join(results)
</code></pre>
<h3 data-id="heading-27">4.3 ç¤ºä¾‹æ‰§è¡Œæµç¨‹</h3>
<p><strong>ç”¨æˆ·è¾“å…¥</strong>: "åˆ›å»ºä¸€ä¸ª Python è„šæœ¬æ¥è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—"</p>
<pre><code class="hljs language-vbnet" lang="vbnet"><span class="hljs-keyword">Step</span> <span class="hljs-number">1</span> - Think:
  LLM åˆ†æ: éœ€è¦åˆ›å»ºæ–‡ä»¶ï¼Œä½¿ç”¨ str_replace_editor å·¥å…·
  å†³ç­–: è°ƒç”¨ str_replace_editor.create

<span class="hljs-keyword">Step</span> <span class="hljs-number">1</span> - Act:
  æ‰§è¡Œ: str_replace_editor(command=<span class="hljs-string">"create"</span>, path=<span class="hljs-string">"/workspace/fibonacci.py"</span>, file_text=<span class="hljs-string">"..."</span>)
  ç»“æœ: File created successfully at /workspace/fibonacci.py

<span class="hljs-keyword">Step</span> <span class="hljs-number">2</span> - Think:
  LLM åˆ†æ: æ–‡ä»¶å·²åˆ›å»ºï¼Œç°åœ¨éœ€è¦æµ‹è¯•
  å†³ç­–: è°ƒç”¨ python_execute

<span class="hljs-keyword">Step</span> <span class="hljs-number">2</span> - Act:
  æ‰§è¡Œ: python_execute(code=<span class="hljs-string">"exec(open('/workspace/fibonacci.py').read())"</span>)
  ç»“æœ: [è¾“å‡ºæ–æ³¢é‚£å¥‘æ•°åˆ—]

<span class="hljs-keyword">Step</span> <span class="hljs-number">3</span> - Think:
  LLM åˆ†æ: ä»»åŠ¡å®Œæˆ
  å†³ç­–: è°ƒç”¨ terminate

<span class="hljs-keyword">Step</span> <span class="hljs-number">3</span> - Act:
  æ‰§è¡Œ: terminate()
  çŠ¶æ€: FINISHED
</code></pre>
<hr/>
<h2 data-id="heading-28">5. å·¥å…·ç³»ç»Ÿ</h2>
<h3 data-id="heading-29">5.1 å·¥å…·åŸºç±»</h3>
<p><strong>BaseTool è®¾è®¡</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseTool</span>(ABC, BaseModel):
    name: <span class="hljs-built_in">str</span>               <span class="hljs-comment"># å·¥å…·åç§°</span>
    description: <span class="hljs-built_in">str</span>        <span class="hljs-comment"># å·¥å…·æè¿° (ç»™ LLM çœ‹)</span>
    parameters: <span class="hljs-built_in">dict</span>        <span class="hljs-comment"># å‚æ•° schema (JSON Schema)</span>

<span class="hljs-meta">    @abstractmethod</span>
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, **kwargs</span>) -&gt; <span class="hljs-type">Any</span>:
        <span class="hljs-string">"""æ‰§è¡Œå·¥å…·çš„æ ¸å¿ƒé€»è¾‘"""</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_param</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">Dict</span>:
        <span class="hljs-string">"""è½¬æ¢ä¸º OpenAI function call æ ¼å¼"""</span>
        <span class="hljs-keyword">return</span> {
            <span class="hljs-string">"type"</span>: <span class="hljs-string">"function"</span>,
            <span class="hljs-string">"function"</span>: {
                <span class="hljs-string">"name"</span>: self.name,
                <span class="hljs-string">"description"</span>: self.description,
                <span class="hljs-string">"parameters"</span>: self.parameters,
            }
        }
</code></pre>
<p><strong>ToolResult æ•°æ®æ¨¡å‹</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolResult</span>(<span class="hljs-title class_ inherited__">BaseModel</span>):
    output: <span class="hljs-type">Any</span> = <span class="hljs-literal">None</span>              <span class="hljs-comment"># æ­£å¸¸è¾“å‡º</span>
    error: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>     <span class="hljs-comment"># é”™è¯¯ä¿¡æ¯</span>
    base64_image: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>  <span class="hljs-comment"># å›¾ç‰‡æ•°æ®</span>
    system: <span class="hljs-type">Optional</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>    <span class="hljs-comment"># ç³»ç»Ÿæ¶ˆæ¯</span>

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__str__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-keyword">return</span> <span class="hljs-string">f"Error: <span class="hljs-subst">{self.error}</span>"</span> <span class="hljs-keyword">if</span> self.error <span class="hljs-keyword">else</span> self.output
</code></pre>
<h3 data-id="heading-30">5.2 å†…ç½®å·¥å…·è¯¦è§£</h3>
<h4 data-id="heading-31">5.2.1 PythonExecute (Python æ‰§è¡Œ)</h4>
<p><strong>åŠŸèƒ½</strong>: åœ¨éš”ç¦»ç¯å¢ƒä¸­æ‰§è¡Œ Python ä»£ç </p>
<p><strong>å‚æ•°</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"code"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"print('Hello, World!')"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å®ç°åŸç†</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PythonExecute</span>(<span class="hljs-title class_ inherited__">BaseTool</span>):
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, code: <span class="hljs-built_in">str</span>, timeout: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>) -&gt; <span class="hljs-type">Dict</span>:
        <span class="hljs-comment"># 1. ä½¿ç”¨ multiprocessing åˆ›å»ºå­è¿›ç¨‹</span>
        <span class="hljs-keyword">with</span> multiprocessing.Manager() <span class="hljs-keyword">as</span> manager:
            result = manager.<span class="hljs-built_in">dict</span>()

            <span class="hljs-comment"># 2. åœ¨å­è¿›ç¨‹ä¸­æ‰§è¡Œä»£ç </span>
            proc = multiprocessing.Process(
                target=self._run_code,
                args=(code, result, safe_globals)
            )
            proc.start()
            proc.join(timeout)

            <span class="hljs-comment"># 3. å¤„ç†è¶…æ—¶</span>
            <span class="hljs-keyword">if</span> proc.is_alive():
                proc.terminate()
                <span class="hljs-keyword">return</span> {<span class="hljs-string">"observation"</span>: <span class="hljs-string">"Timeout"</span>, <span class="hljs-string">"success"</span>: <span class="hljs-literal">False</span>}

            <span class="hljs-keyword">return</span> <span class="hljs-built_in">dict</span>(result)
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹</strong>:</p>
<ul>
<li>âœ… åªæ•è· <code>print()</code> è¾“å‡º</li>
<li>âŒ å‡½æ•°è¿”å›å€¼ä¸å¯è§</li>
<li>âš ï¸ æœ‰è¶…æ—¶é™åˆ¶ (é»˜è®¤ 5 ç§’)</li>
</ul>
<h4 data-id="heading-32">5.2.2 StrReplaceEditor (æ–‡ä»¶ç¼–è¾‘)</h4>
<p><strong>åŠŸèƒ½</strong>: æŸ¥çœ‹ã€åˆ›å»ºã€ç¼–è¾‘æ–‡ä»¶å’Œç›®å½•</p>
<p><strong>å‘½ä»¤</strong>:</p>
<ol>
<li><strong>view</strong>: æŸ¥çœ‹æ–‡ä»¶/ç›®å½•</li>
<li><strong>create</strong>: åˆ›å»ºæ–‡ä»¶</li>
<li><strong>str_replace</strong>: å­—ç¬¦ä¸²æ›¿æ¢</li>
<li><strong>insert</strong>: æ’å…¥æ–‡æœ¬</li>
<li><strong>undo_edit</strong>: æ’¤é”€ç¼–è¾‘</li>
</ol>
<p><strong>ç¤ºä¾‹ 1 - æŸ¥çœ‹æ–‡ä»¶</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"view"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/workspace/example.py"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ç¤ºä¾‹ 2 - åˆ›å»ºæ–‡ä»¶</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"create"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/workspace/new_file.py"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"file_text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"print('Hello')"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ç¤ºä¾‹ 3 - æ›¿æ¢å†…å®¹</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"str_replace"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/workspace/example.py"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"old_str"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"def old_function():\n    pass"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"new_str"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"def new_function():\n    return True"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å®ç°äº®ç‚¹</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># 1. æ”¯æŒæ²™ç®±å’Œæœ¬åœ°ä¸¤ç§æ¨¡å¼</span>
operator = self._get_operator()  <span class="hljs-comment"># æ ¹æ®é…ç½®é€‰æ‹©</span>

<span class="hljs-comment"># 2. å†å²è®°å½•ç®¡ç†</span>
self._file_history[path].append(old_content)  <span class="hljs-comment"># æ”¯æŒ undo</span>

<span class="hljs-comment"># 3. æ™ºèƒ½æˆªæ–­</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">maybe_truncate</span>(<span class="hljs-params">content: <span class="hljs-built_in">str</span>, max_len: <span class="hljs-built_in">int</span> = <span class="hljs-number">16000</span></span>) -&gt; <span class="hljs-built_in">str</span>:
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(content) &gt; max_len:
        <span class="hljs-keyword">return</span> content[:max_len] + <span class="hljs-string">"&lt;response clipped&gt;"</span>
    <span class="hljs-keyword">return</span> content

<span class="hljs-comment"># 4. å”¯ä¸€æ€§æ£€æŸ¥ (str_replace)</span>
occurrences = file_content.count(old_str)
<span class="hljs-keyword">if</span> occurrences &gt; <span class="hljs-number">1</span>:
    <span class="hljs-keyword">raise</span> ToolError(<span class="hljs-string">"Multiple occurrences - not unique"</span>)
</code></pre>
<h4 data-id="heading-33">5.2.3 BrowserUseTool (æµè§ˆå™¨è‡ªåŠ¨åŒ–)</h4>
<p><strong>åŠŸèƒ½</strong>: å®Œæ•´çš„æµè§ˆå™¨æ§åˆ¶èƒ½åŠ›</p>
<p><strong>æ”¯æŒçš„æ“ä½œ</strong>:</p>
<pre><code class="hljs language-python" lang="python">actions = [
    <span class="hljs-string">"go_to_url"</span>,              <span class="hljs-comment"># å¯¼èˆªåˆ° URL</span>
    <span class="hljs-string">"click_element"</span>,          <span class="hljs-comment"># ç‚¹å‡»å…ƒç´ </span>
    <span class="hljs-string">"input_text"</span>,             <span class="hljs-comment"># è¾“å…¥æ–‡æœ¬</span>
    <span class="hljs-string">"scroll_down"</span>,            <span class="hljs-comment"># å‘ä¸‹æ»šåŠ¨</span>
    <span class="hljs-string">"scroll_up"</span>,              <span class="hljs-comment"># å‘ä¸Šæ»šåŠ¨</span>
    <span class="hljs-string">"scroll_to_text"</span>,         <span class="hljs-comment"># æ»šåŠ¨åˆ°æ–‡æœ¬</span>
    <span class="hljs-string">"send_keys"</span>,              <span class="hljs-comment"># å‘é€æŒ‰é”®</span>
    <span class="hljs-string">"get_dropdown_options"</span>,   <span class="hljs-comment"># è·å–ä¸‹æ‹‰é€‰é¡¹</span>
    <span class="hljs-string">"select_dropdown_option"</span>, <span class="hljs-comment"># é€‰æ‹©ä¸‹æ‹‰é€‰é¡¹</span>
    <span class="hljs-string">"go_back"</span>,                <span class="hljs-comment"># åé€€</span>
    <span class="hljs-string">"web_search"</span>,             <span class="hljs-comment"># ç½‘é¡µæœç´¢</span>
    <span class="hljs-string">"wait"</span>,                   <span class="hljs-comment"># ç­‰å¾…</span>
    <span class="hljs-string">"extract_content"</span>,        <span class="hljs-comment"># æå–å†…å®¹</span>
    <span class="hljs-string">"switch_tab"</span>,             <span class="hljs-comment"># åˆ‡æ¢æ ‡ç­¾</span>
    <span class="hljs-string">"open_tab"</span>,               <span class="hljs-comment"># æ‰“å¼€æ–°æ ‡ç­¾</span>
    <span class="hljs-string">"close_tab"</span>,              <span class="hljs-comment"># å…³é—­æ ‡ç­¾</span>
]
</code></pre>
<p><strong>ç¤ºä¾‹ 1 - å¯¼èˆªå’Œç‚¹å‡»</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-comment">// è®¿é—®ç½‘ç«™</span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"go_to_url"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"url"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://www.example.com"</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment">// ç‚¹å‡»ç¬¬ 5 ä¸ªå¯äº¤äº’å…ƒç´ </span>
<span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"click_element"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>ç¤ºä¾‹ 2 - æå–å†…å®¹</strong>:</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"extract_content"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"goal"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"æå–é¡µé¢ä¸­æ‰€æœ‰äº§å“çš„åç§°å’Œä»·æ ¼"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p><strong>å†…éƒ¨å®ç°</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, action: <span class="hljs-built_in">str</span>, **kwargs</span>) -&gt; ToolResult:
    <span class="hljs-comment"># 1. ç¡®ä¿æµè§ˆå™¨å·²åˆå§‹åŒ–</span>
    context = <span class="hljs-keyword">await</span> self._ensure_browser_initialized()

    <span class="hljs-comment"># 2. æ ¹æ® action æ‰§è¡Œä¸åŒæ“ä½œ</span>
    <span class="hljs-keyword">if</span> action == <span class="hljs-string">"go_to_url"</span>:
        page = <span class="hljs-keyword">await</span> context.get_current_page()
        <span class="hljs-keyword">await</span> page.goto(url)
        <span class="hljs-keyword">return</span> ToolResult(output=<span class="hljs-string">f"Navigated to <span class="hljs-subst">{url}</span>"</span>)

    <span class="hljs-keyword">elif</span> action == <span class="hljs-string">"extract_content"</span>:
        <span class="hljs-comment"># ä½¿ç”¨ LLM æå–å†…å®¹</span>
        content = markdownify.markdownify(<span class="hljs-keyword">await</span> page.content())
        prompt = <span class="hljs-string">f"Extract: <span class="hljs-subst">{goal}</span>\n\nPage: <span class="hljs-subst">{content}</span>"</span>

        response = <span class="hljs-keyword">await</span> self.llm.ask_tool(
            messages=[{<span class="hljs-string">"role"</span>: <span class="hljs-string">"system"</span>, <span class="hljs-string">"content"</span>: prompt}],
            tools=[extraction_function],
            tool_choice=<span class="hljs-string">"required"</span>
        )

        <span class="hljs-keyword">return</span> ToolResult(output=extracted_content)
</code></pre>
<p><strong>çŠ¶æ€è·å–</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_current_state</span>(<span class="hljs-params">self</span>) -&gt; ToolResult:
    <span class="hljs-string">"""è·å–å½“å‰æµè§ˆå™¨çŠ¶æ€ (åŒ…å«æˆªå›¾)"""</span>
    state = <span class="hljs-keyword">await</span> context.get_state()
    screenshot = <span class="hljs-keyword">await</span> page.screenshot(full_page=<span class="hljs-literal">True</span>)

    <span class="hljs-keyword">return</span> ToolResult(
        output=json.dumps({
            <span class="hljs-string">"url"</span>: state.url,
            <span class="hljs-string">"title"</span>: state.title,
            <span class="hljs-string">"interactive_elements"</span>: state.element_tree.clickable_elements_to_string(),
            <span class="hljs-string">"scroll_info"</span>: {...}
        }),
        base64_image=base64.b64encode(screenshot).decode()
    )
</code></pre>
<h4 data-id="heading-34">5.2.4 WebSearch (ç½‘é¡µæœç´¢)</h4>
<p><strong>åŠŸèƒ½</strong>: å¤šå¼•æ“ç½‘é¡µæœç´¢ï¼Œæ”¯æŒè‡ªåŠ¨é™çº§</p>
<p><strong>æ”¯æŒçš„æœç´¢å¼•æ“</strong>:</p>
<ul>
<li>Google</li>
<li>DuckDuckGo</li>
<li>Baidu</li>
<li>Bing</li>
</ul>
<p><strong>é…ç½®</strong>:</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[search]</span>
<span class="hljs-attr">engine</span> = <span class="hljs-string">"Google"</span>                      <span class="hljs-comment"># ä¸»æœç´¢å¼•æ“</span>
<span class="hljs-attr">fallback_engines</span> = [<span class="hljs-string">"DuckDuckGo"</span>, <span class="hljs-string">"Baidu"</span>, <span class="hljs-string">"Bing"</span>]  <span class="hljs-comment"># é™çº§å¼•æ“</span>
<span class="hljs-attr">retry_delay</span> = <span class="hljs-number">60</span>                       <span class="hljs-comment"># é‡è¯•å»¶è¿Ÿ (ç§’)</span>
<span class="hljs-attr">max_retries</span> = <span class="hljs-number">3</span>                        <span class="hljs-comment"># æœ€å¤§é‡è¯•æ¬¡æ•°</span>
<span class="hljs-attr">lang</span> = <span class="hljs-string">"en"</span>                            <span class="hljs-comment"># è¯­è¨€</span>
<span class="hljs-attr">country</span> = <span class="hljs-string">"us"</span>                         <span class="hljs-comment"># å›½å®¶</span>
</code></pre>
<p><strong>è‡ªåŠ¨é™çº§æœºåˆ¶</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, query: <span class="hljs-built_in">str</span>, num_results: <span class="hljs-built_in">int</span> = <span class="hljs-number">5</span></span>) -&gt; SearchResponse:
    <span class="hljs-comment"># 1. å°è¯•ä¸»å¼•æ“</span>
    <span class="hljs-keyword">try</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self._search_with_engine(self.engine, query)
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
        logger.warning(<span class="hljs-string">f"<span class="hljs-subst">{self.engine}</span> failed: <span class="hljs-subst">{e}</span>"</span>)

    <span class="hljs-comment"># 2. å°è¯•é™çº§å¼•æ“</span>
    <span class="hljs-keyword">for</span> fallback <span class="hljs-keyword">in</span> self.fallback_engines:
        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self._search_with_engine(fallback, query)
        <span class="hljs-keyword">except</span>:
            <span class="hljs-keyword">continue</span>

    <span class="hljs-comment"># 3. æ‰€æœ‰å¼•æ“éƒ½å¤±è´¥</span>
    <span class="hljs-keyword">raise</span> SearchError(<span class="hljs-string">"All search engines failed"</span>)
</code></pre>
<h4 data-id="heading-35">5.2.5 Terminate (ç»ˆæ­¢)</h4>
<p><strong>åŠŸèƒ½</strong>: æ ‡è®°ä»»åŠ¡å®Œæˆå¹¶ç»ˆæ­¢æ‰§è¡Œ</p>
<p><strong>å®ç°</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Terminate</span>(<span class="hljs-title class_ inherited__">BaseTool</span>):
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"terminate"</span>
    description: <span class="hljs-built_in">str</span> = <span class="hljs-string">"Use this when the task is complete"</span>
    parameters: <span class="hljs-built_in">dict</span> = {<span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>, <span class="hljs-string">"properties"</span>: {}}

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, **kwargs</span>) -&gt; ToolResult:
        <span class="hljs-keyword">return</span> ToolResult(
            output=<span class="hljs-string">"Task completed successfully. Agent will now terminate."</span>
        )
</code></pre>
<h3 data-id="heading-36">5.3 å·¥å…·é›†åˆç®¡ç†</h3>
<p><strong>ToolCollection</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ToolCollection</span>:
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, *tools: BaseTool</span>):
        self.tools = tools
        self.tool_map = {tool.name: tool <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> tools}

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">to_params</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-type">List</span>[<span class="hljs-type">Dict</span>]:
        <span class="hljs-string">"""è½¬æ¢ä¸º LLM API æ ¼å¼"""</span>
        <span class="hljs-keyword">return</span> [tool.to_param() <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> self.tools]

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, name: <span class="hljs-built_in">str</span>, tool_input: <span class="hljs-type">Dict</span></span>) -&gt; ToolResult:
        <span class="hljs-string">"""æ‰§è¡ŒæŒ‡å®šå·¥å…·"""</span>
        tool = self.tool_map.get(name)
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tool:
            <span class="hljs-keyword">return</span> ToolFailure(error=<span class="hljs-string">f"Tool <span class="hljs-subst">{name}</span> not found"</span>)

        <span class="hljs-keyword">try</span>:
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> tool(**tool_input)
        <span class="hljs-keyword">except</span> ToolError <span class="hljs-keyword">as</span> e:
            <span class="hljs-keyword">return</span> ToolFailure(error=e.message)
</code></pre>
<hr/>
<h2 data-id="heading-37">6. é…ç½®ç³»ç»Ÿ</h2>
<h3 data-id="heading-38">6.1 é…ç½®æ–‡ä»¶ç»“æ„</h3>
<p><strong>config/config.toml</strong>:</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-comment"># ============= LLM é…ç½® =============</span>
<span class="hljs-section">[llm]</span>
<span class="hljs-attr">model</span> = <span class="hljs-string">"gpt-4o"</span>
<span class="hljs-attr">base_url</span> = <span class="hljs-string">"https://api.openai.com/v1"</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-..."</span>
<span class="hljs-attr">max_tokens</span> = <span class="hljs-number">4096</span>
<span class="hljs-attr">max_input_tokens</span> = <span class="hljs-number">100000</span>    <span class="hljs-comment"># å¯é€‰: é™åˆ¶æ€»è¾“å…¥ token</span>
<span class="hljs-attr">temperature</span> = <span class="hljs-number">0.0</span>
<span class="hljs-attr">api_type</span> = <span class="hljs-string">"openai"</span>           <span class="hljs-comment"># openai | azure | aws | ollama</span>
<span class="hljs-attr">api_version</span> = <span class="hljs-string">""</span>              <span class="hljs-comment"># Azure éœ€è¦</span>

<span class="hljs-comment"># å¯é€‰: ç‰¹å®šç”¨é€”çš„ LLM é…ç½®</span>
<span class="hljs-section">[llm.vision]</span>
<span class="hljs-attr">model</span> = <span class="hljs-string">"gpt-4o"</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-..."</span>

<span class="hljs-comment"># ============= æ²™ç®±é…ç½® =============</span>
<span class="hljs-section">[sandbox]</span>
<span class="hljs-attr">use_sandbox</span> = <span class="hljs-literal">false</span>
<span class="hljs-attr">image</span> = <span class="hljs-string">"python:3.12-slim"</span>
<span class="hljs-attr">work_dir</span> = <span class="hljs-string">"/workspace"</span>
<span class="hljs-attr">memory_limit</span> = <span class="hljs-string">"512m"</span>
<span class="hljs-attr">cpu_limit</span> = <span class="hljs-number">1.0</span>
<span class="hljs-attr">timeout</span> = <span class="hljs-number">300</span>
<span class="hljs-attr">network_enabled</span> = <span class="hljs-literal">false</span>

<span class="hljs-comment"># ============= æµè§ˆå™¨é…ç½® =============</span>
<span class="hljs-section">[browser]</span>
<span class="hljs-attr">headless</span> = <span class="hljs-literal">false</span>
<span class="hljs-attr">disable_security</span> = <span class="hljs-literal">true</span>
<span class="hljs-attr">extra_chromium_args</span> = []
<span class="hljs-attr">max_content_length</span> = <span class="hljs-number">2000</span>

<span class="hljs-comment"># æµè§ˆå™¨ä»£ç† (å¯é€‰)</span>
<span class="hljs-section">[browser.proxy]</span>
<span class="hljs-attr">server</span> = <span class="hljs-string">"http://proxy.example.com:8080"</span>
<span class="hljs-attr">username</span> = <span class="hljs-string">"user"</span>
<span class="hljs-attr">password</span> = <span class="hljs-string">"pass"</span>

<span class="hljs-comment"># ============= æœç´¢é…ç½® =============</span>
<span class="hljs-section">[search]</span>
<span class="hljs-attr">engine</span> = <span class="hljs-string">"Google"</span>
<span class="hljs-attr">fallback_engines</span> = [<span class="hljs-string">"DuckDuckGo"</span>, <span class="hljs-string">"Baidu"</span>, <span class="hljs-string">"Bing"</span>]
<span class="hljs-attr">retry_delay</span> = <span class="hljs-number">60</span>
<span class="hljs-attr">max_retries</span> = <span class="hljs-number">3</span>
<span class="hljs-attr">lang</span> = <span class="hljs-string">"en"</span>
<span class="hljs-attr">country</span> = <span class="hljs-string">"us"</span>

<span class="hljs-comment"># ============= MCP é…ç½® =============</span>
<span class="hljs-section">[mcp]</span>
<span class="hljs-attr">server_reference</span> = <span class="hljs-string">"app.mcp.server"</span>
</code></pre>
<h3 data-id="heading-39">6.2 é…ç½®åŠ è½½</h3>
<p><strong>Config ç±» (å•ä¾‹æ¨¡å¼)</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Config</span>:
    _instance = <span class="hljs-literal">None</span>
    _lock = threading.Lock()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__new__</span>(<span class="hljs-params">cls</span>):
        <span class="hljs-keyword">if</span> cls._instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
            <span class="hljs-keyword">with</span> cls._lock:
                <span class="hljs-keyword">if</span> cls._instance <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:
                    cls._instance = <span class="hljs-built_in">super</span>().__new__(cls)
        <span class="hljs-keyword">return</span> cls._instance

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># 1. æŸ¥æ‰¾é…ç½®æ–‡ä»¶</span>
        config_path = self._get_config_path()

        <span class="hljs-comment"># 2. åŠ è½½ TOML</span>
        <span class="hljs-keyword">with</span> config_path.<span class="hljs-built_in">open</span>(<span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> f:
            raw_config = tomllib.load(f)

        <span class="hljs-comment"># 3. è§£æ LLM é…ç½®</span>
        base_llm = raw_config[<span class="hljs-string">"llm"</span>]
        llm_overrides = {k: v <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> base_llm.items() <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(v, <span class="hljs-built_in">dict</span>)}

        <span class="hljs-comment"># 4. åˆ›å»ºé…ç½®å¯¹è±¡</span>
        self._config = AppConfig(
            llm={
                <span class="hljs-string">"default"</span>: base_llm,
                **llm_overrides  <span class="hljs-comment"># vision, planning, etc.</span>
            },
            sandbox=SandboxSettings(**raw_config.get(<span class="hljs-string">"sandbox"</span>, {})),
            browser_config=BrowserSettings(**raw_config.get(<span class="hljs-string">"browser"</span>, {})),
            search_config=SearchSettings(**raw_config.get(<span class="hljs-string">"search"</span>, {})),
        )
</code></pre>
<h3 data-id="heading-40">6.3 å¤š LLM é…ç½®</h3>
<p><strong>åœºæ™¯</strong>: ä¸åŒä»»åŠ¡ä½¿ç”¨ä¸åŒæ¨¡å‹</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[llm]</span>
<span class="hljs-attr">model</span> = <span class="hljs-string">"gpt-4o-mini"</span>     <span class="hljs-comment"># é»˜è®¤: å¿«é€Ÿä¾¿å®œ</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-..."</span>

<span class="hljs-section">[llm.vision]</span>
<span class="hljs-attr">model</span> = <span class="hljs-string">"gpt-4o"</span>          <span class="hljs-comment"># è§†è§‰ä»»åŠ¡: é«˜ç²¾åº¦</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-..."</span>

<span class="hljs-section">[llm.planning]</span>
<span class="hljs-attr">model</span> = <span class="hljs-string">"o1-preview"</span>      <span class="hljs-comment"># è§„åˆ’ä»»åŠ¡: æ·±åº¦æ¨ç†</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-..."</span>
</code></pre>
<p><strong>ä½¿ç”¨</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é»˜è®¤ LLM</span>
default_llm = LLM(config_name=<span class="hljs-string">"default"</span>)

<span class="hljs-comment"># è§†è§‰ LLM</span>
vision_llm = LLM(config_name=<span class="hljs-string">"vision"</span>)

<span class="hljs-comment"># è§„åˆ’ LLM</span>
planning_llm = LLM(config_name=<span class="hljs-string">"planning"</span>)
</code></pre>
<hr/>
<h2 data-id="heading-41">7. å®æˆ˜ç¤ºä¾‹</h2>
<h3 data-id="heading-42">7.1 ç¤ºä¾‹ 1: æ•°æ®åˆ†æä»»åŠ¡</h3>
<p><strong>ç”¨æˆ·è¾“å…¥</strong>:</p>
<pre><code class="hljs language-arduino" lang="arduino">ä¸‹è½½ https:<span class="hljs-comment">//example.com/sales.csv å¹¶åˆ†æé”€å”®æ•°æ®ï¼Œ</span>
ç”Ÿæˆæœˆåº¦é”€å”®æŠ¥å‘Šã€‚
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong>:</p>
<pre><code class="hljs language-ini" lang="ini">Step 1 <span class="hljs-section">[Think]</span>:
  åˆ†æ: éœ€è¦ä¸‹è½½æ–‡ä»¶å¹¶åˆ†ææ•°æ®
  å†³ç­–: ä½¿ç”¨ browser_use å·¥å…·è®¿é—® URL

Step 1 <span class="hljs-section">[Act]</span>:
  å·¥å…·: browser_use(<span class="hljs-attr">action</span>=<span class="hljs-string">"go_to_url"</span>, url=<span class="hljs-string">"https://example.com/sales.csv"</span>)
  ç»“æœ: Downloaded file to /downloads/sales.csv

Step 2 <span class="hljs-section">[Think]</span>:
  åˆ†æ: æ–‡ä»¶å·²ä¸‹è½½ï¼Œéœ€è¦è¯»å–å’Œåˆ†æ
  å†³ç­–: ä½¿ç”¨ python_execute è¯»å– CSV

Step 2 <span class="hljs-section">[Act]</span>:
  å·¥å…·: python_execute(<span class="hljs-attr">code</span>=<span class="hljs-string">"""
import pandas as pd
df = pd.read_csv('/downloads/sales.csv')
monthly = df.groupby(df['date'].str[:7])['amount'].sum()
print(monthly)
"""</span>)
  ç»“æœ: <span class="hljs-section">[æœˆåº¦é”€å”®æ•°æ®]</span>

Step 3 <span class="hljs-section">[Think]</span>:
  åˆ†æ: å·²å®Œæˆåˆ†æï¼Œéœ€è¦ç”ŸæˆæŠ¥å‘Š
  å†³ç­–: ä½¿ç”¨ str_replace_editor åˆ›å»ºæŠ¥å‘Š

Step 3 <span class="hljs-section">[Act]</span>:
  å·¥å…·: str_replace_editor(<span class="hljs-attr">command</span>=<span class="hljs-string">"create"</span>, path=<span class="hljs-string">"/workspace/report.md"</span>, ...)
  ç»“æœ: Report created

Step 4 <span class="hljs-section">[Think]</span>:
  åˆ†æ: ä»»åŠ¡å®Œæˆ
  å†³ç­–: terminate

Step 4 <span class="hljs-section">[Act]</span>:
  å·¥å…·: terminate()
  çŠ¶æ€: FINISHED
</code></pre>
<h3 data-id="heading-43">7.2 ç¤ºä¾‹ 2: Web çˆ¬è™«ä»»åŠ¡</h3>
<p><strong>ç”¨æˆ·è¾“å…¥</strong>:</p>
<pre><code class="hljs">è®¿é—® Hacker News é¦–é¡µï¼Œæå–å‰ 10 æ¡æ–°é—»çš„æ ‡é¢˜å’Œé“¾æ¥ã€‚
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong>:</p>
<pre><code class="hljs language-ini" lang="ini">Step 1:
  å·¥å…·: browser_use(<span class="hljs-attr">action</span>=<span class="hljs-string">"go_to_url"</span>, url=<span class="hljs-string">"https://news.ycombinator.com"</span>)

Step 2:
  å·¥å…·: browser_use(<span class="hljs-attr">action</span>=<span class="hljs-string">"extract_content"</span>, goal=<span class="hljs-string">"æå–å‰ 10 æ¡æ–°é—»çš„æ ‡é¢˜å’Œé“¾æ¥"</span>)
  ç»“æœ: <span class="hljs-section">[æå–çš„æ–°é—»åˆ—è¡¨]</span>

Step 3:
  å·¥å…·: str_replace_editor(<span class="hljs-attr">command</span>=<span class="hljs-string">"create"</span>, path=<span class="hljs-string">"/workspace/hn_news.json"</span>, ...)

Step 4:
  å·¥å…·: terminate()
</code></pre>
<h3 data-id="heading-44">7.3 ç¤ºä¾‹ 3: ä»£ç é‡æ„ä»»åŠ¡</h3>
<p><strong>ç”¨æˆ·è¾“å…¥</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">é‡æ„ /workspace/legacy_code.pyï¼Œ
å°†æ‰€æœ‰å‡½æ•°æ”¹ä¸ºä½¿ç”¨ <span class="hljs-built_in">type</span> hintsã€‚
</code></pre>
<p><strong>æ‰§è¡Œæµç¨‹</strong>:</p>
<pre><code class="hljs language-ini" lang="ini">Step 1:
  å·¥å…·: str_replace_editor(<span class="hljs-attr">command</span>=<span class="hljs-string">"view"</span>, path=<span class="hljs-string">"/workspace/legacy_code.py"</span>)
  ç»“æœ: <span class="hljs-section">[æŸ¥çœ‹åŸå§‹ä»£ç ]</span>

Step 2:
  å·¥å…·: str_replace_editor(
    <span class="hljs-attr">command</span>=<span class="hljs-string">"str_replace"</span>,
    <span class="hljs-attr">path</span>=<span class="hljs-string">"/workspace/legacy_code.py"</span>,
    <span class="hljs-attr">old_str</span>=<span class="hljs-string">"def add(a, b):\n    return a + b"</span>,
    <span class="hljs-attr">new_str</span>=<span class="hljs-string">"def add(a: int, b: int) -&gt; int:\n    return a + b"</span>
  )
  ç»“æœ: <span class="hljs-section">[æ›¿æ¢ç¬¬ä¸€ä¸ªå‡½æ•°]</span>

Step 3-N:
  <span class="hljs-section">[ç»§ç»­æ›¿æ¢å…¶ä»–å‡½æ•°]</span>

Step N+1:
  å·¥å…·: python_execute(<span class="hljs-attr">code</span>=<span class="hljs-string">"import /workspace/legacy_code.py"</span>)  <span class="hljs-comment"># éªŒè¯è¯­æ³•</span>

Step N+2:
  å·¥å…·: terminate()
</code></pre>
<hr/>
<h2 data-id="heading-45">8. é«˜çº§ç‰¹æ€§</h2>
<h3 data-id="heading-46">8.1 æ²™ç®±ç¯å¢ƒ</h3>
<p><strong>åŠŸèƒ½</strong>: åœ¨ Docker å®¹å™¨ä¸­å®‰å…¨æ‰§è¡Œä»£ç </p>
<p><strong>å¯ç”¨æ²™ç®±</strong>:</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[sandbox]</span>
<span class="hljs-attr">use_sandbox</span> = <span class="hljs-literal">true</span>
<span class="hljs-attr">image</span> = <span class="hljs-string">"python:3.12-slim"</span>
<span class="hljs-attr">work_dir</span> = <span class="hljs-string">"/workspace"</span>
<span class="hljs-attr">memory_limit</span> = <span class="hljs-string">"512m"</span>
<span class="hljs-attr">cpu_limit</span> = <span class="hljs-number">1.0</span>
<span class="hljs-attr">timeout</span> = <span class="hljs-number">300</span>
<span class="hljs-attr">network_enabled</span> = <span class="hljs-literal">false</span>
</code></pre>
<p><strong>æ¶æ„</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Host System                â”‚
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   OpenManus Agent         â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚   â”‚ SandboxClient   â”‚     â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚               â”‚                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Docker Container        â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚
â”‚  â”‚   â”‚ Python Env      â”‚     â”‚  â”‚
â”‚  â”‚   â”‚ /workspace      â”‚     â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å®ç°</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DockerSandbox</span>:
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">create</span>(<span class="hljs-params">self</span>):
        <span class="hljs-string">"""åˆ›å»º Docker å®¹å™¨"""</span>
        self.container = self.docker_client.containers.run(
            image=self.config.image,
            command=<span class="hljs-string">"tail -f /dev/null"</span>,
            detach=<span class="hljs-literal">True</span>,
            working_dir=self.config.work_dir,
            mem_limit=self.config.memory_limit,
            cpu_quota=<span class="hljs-built_in">int</span>(self.config.cpu_limit * <span class="hljs-number">100000</span>),
            network_disabled=<span class="hljs-keyword">not</span> self.config.network_enabled,
            volumes=self.volume_bindings,
        )

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">run_command</span>(<span class="hljs-params">self, command: <span class="hljs-built_in">str</span>, timeout: <span class="hljs-built_in">int</span> = <span class="hljs-literal">None</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""åœ¨å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤"""</span>
        exec_result = self.container.exec_run(
            cmd=command,
            workdir=self.config.work_dir,
        )
        <span class="hljs-keyword">return</span> exec_result.output.decode()
</code></pre>
<p><strong>æ–‡ä»¶æ“ä½œ</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SandboxFileOperator</span>(<span class="hljs-title class_ inherited__">FileOperator</span>):
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">read_file</span>(<span class="hljs-params">self, path: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-string">"""ä»å®¹å™¨è¯»å–æ–‡ä»¶"""</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> SANDBOX_CLIENT.read_file(path)

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">write_file</span>(<span class="hljs-params">self, path: <span class="hljs-built_in">str</span>, content: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-literal">None</span>:
        <span class="hljs-string">"""å†™å…¥æ–‡ä»¶åˆ°å®¹å™¨"""</span>
        <span class="hljs-keyword">await</span> SANDBOX_CLIENT.write_file(path, content)
</code></pre>
<h3 data-id="heading-47">8.2 MCP (Model Context Protocol)</h3>
<p><strong>åŠŸèƒ½</strong>: é€šè¿‡ MCP åè®®è¿æ¥å¤–éƒ¨å·¥å…·æœåŠ¡å™¨</p>
<p><strong>æ¶æ„</strong>:</p>
<pre><code class="hljs language-arduino" lang="arduino">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MCP Agent   â”‚ â—„â”€â”€â”€â”€â”€â–º â”‚  MCP <span class="hljs-built_in">Server</span>  â”‚
â”‚              â”‚  stdio  â”‚              â”‚
â”‚              â”‚   <span class="hljs-keyword">or</span>    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚              â”‚   sse   â”‚  â”‚  Tool <span class="hljs-number">1</span> â”‚ â”‚
â”‚              â”‚         â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚              â”‚         â”‚  â”‚  Tool <span class="hljs-number">2</span> â”‚ â”‚
â”‚              â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>ä½¿ç”¨ stdio è¿æ¥</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">python run_mcp.py --connection stdio
</code></pre>
<p><strong>ä½¿ç”¨ SSE è¿æ¥</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å¯åŠ¨ MCP æœåŠ¡å™¨</span>
python run_mcp_server.py

<span class="hljs-comment"># è¿æ¥åˆ°æœåŠ¡å™¨</span>
python run_mcp.py --connection sse --server-url http://127.0.0.1:8000/sse
</code></pre>
<p><strong>MCPAgent å®ç°</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MCPAgent</span>(<span class="hljs-title class_ inherited__">ToolCallAgent</span>):
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">
        self,
        connection_type: <span class="hljs-built_in">str</span>,
        command: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span>,
        args: <span class="hljs-type">List</span>[<span class="hljs-built_in">str</span>] = <span class="hljs-literal">None</span>,
        server_url: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span>,
    </span>):
        <span class="hljs-string">"""åˆå§‹åŒ– MCP è¿æ¥"""</span>
        <span class="hljs-keyword">if</span> connection_type == <span class="hljs-string">"stdio"</span>:
            self.session = <span class="hljs-keyword">await</span> self.client.connect_stdio(command, args)
        <span class="hljs-keyword">else</span>:  <span class="hljs-comment"># sse</span>
            self.session = <span class="hljs-keyword">await</span> self.client.connect_sse(server_url)

        <span class="hljs-comment"># è·å–æœåŠ¡å™¨å·¥å…·åˆ—è¡¨</span>
        tools_result = <span class="hljs-keyword">await</span> self.session.list_tools()

        <span class="hljs-comment"># å°† MCP å·¥å…·æ·»åŠ åˆ°å¯ç”¨å·¥å…·</span>
        <span class="hljs-keyword">for</span> tool <span class="hljs-keyword">in</span> tools_result.tools:
            mcp_tool = MCPTool.from_mcp_tool(tool, self.session)
            self.available_tools.add_tool(mcp_tool)
</code></pre>
<h3 data-id="heading-48">8.3 å¤š Agent åä½œ (Flow)</h3>
<p><strong>åŠŸèƒ½</strong>: å¤æ‚ä»»åŠ¡çš„åˆ†è§£å’Œå¤š Agent åä½œ</p>
<p><strong>æµç¨‹ç±»å‹</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FlowType</span>(<span class="hljs-title class_ inherited__">Enum</span>):
    PLANNING = <span class="hljs-string">"planning"</span>    <span class="hljs-comment"># è§„åˆ’å‹æµç¨‹</span>
    SEQUENTIAL = <span class="hljs-string">"sequential"</span>  <span class="hljs-comment"># é¡ºåºæ‰§è¡Œ</span>
    PARALLEL = <span class="hljs-string">"parallel"</span>    <span class="hljs-comment"># å¹¶è¡Œæ‰§è¡Œ</span>
</code></pre>
<p><strong>Planning Flow ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PlanningFlow</span>(<span class="hljs-title class_ inherited__">BaseFlow</span>):
    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, user_request: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
        <span class="hljs-comment"># 1. ç”Ÿæˆè®¡åˆ’</span>
        plan = <span class="hljs-keyword">await</span> self._generate_plan(user_request)

        <span class="hljs-comment"># 2. æ‰§è¡Œè®¡åˆ’</span>
        <span class="hljs-keyword">for</span> step <span class="hljs-keyword">in</span> plan.steps:
            <span class="hljs-comment"># 2.1 é€‰æ‹©åˆé€‚çš„ Agent</span>
            agent = self._select_agent(step)

            <span class="hljs-comment"># 2.2 æ‰§è¡Œæ­¥éª¤</span>
            result = <span class="hljs-keyword">await</span> agent.run(step.description)

            <span class="hljs-comment"># 2.3 è¯„ä¼°ç»“æœ</span>
            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">await</span> self._evaluate_result(result, step):
                <span class="hljs-comment"># é‡æ–°è§„åˆ’</span>
                plan = <span class="hljs-keyword">await</span> self._replan(plan, step, result)

        <span class="hljs-comment"># 3. è¿”å›æœ€ç»ˆç»“æœ</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> self._summarize_results()
</code></pre>
<p><strong>ä½¿ç”¨ç¤ºä¾‹</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># åˆ›å»º Agents</span>
agents = {
    <span class="hljs-string">"manus"</span>: Manus(),
    <span class="hljs-string">"researcher"</span>: ResearchAgent(),
    <span class="hljs-string">"coder"</span>: CodeAgent(),
}

<span class="hljs-comment"># åˆ›å»º Flow</span>
flow = FlowFactory.create_flow(
    flow_type=FlowType.PLANNING,
    agents=agents,
)

<span class="hljs-comment"># æ‰§è¡Œå¤æ‚ä»»åŠ¡</span>
result = <span class="hljs-keyword">await</span> flow.execute(<span class="hljs-string">"ç ”ç©¶å¹¶å®ç°ä¸€ä¸ªæ¨èç³»ç»Ÿ"</span>)
</code></pre>
<h3 data-id="heading-49">8.4 é˜²æ­¢æ­»å¾ªç¯æœºåˆ¶</h3>
<p><strong>é—®é¢˜</strong>: Agent å¯èƒ½é™·å…¥é‡å¤æ“ä½œ</p>
<p><strong>æ£€æµ‹</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">is_stuck</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-built_in">bool</span>:
    <span class="hljs-string">"""æ£€æµ‹æ˜¯å¦é™·å…¥æ­»å¾ªç¯"""</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(self.memory.messages) &lt; <span class="hljs-number">2</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

    last_message = self.memory.messages[-<span class="hljs-number">1</span>]

    <span class="hljs-comment"># è®¡ç®—é‡å¤æ¬¡æ•°</span>
    duplicate_count = <span class="hljs-built_in">sum</span>(
        <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> <span class="hljs-built_in">reversed</span>(self.memory.messages[:-<span class="hljs-number">1</span>])
        <span class="hljs-keyword">if</span> msg.role == <span class="hljs-string">"assistant"</span> <span class="hljs-keyword">and</span> msg.content == last_message.content
    )

    <span class="hljs-keyword">return</span> duplicate_count &gt;= self.duplicate_threshold  <span class="hljs-comment"># é»˜è®¤ 2</span>
</code></pre>
<p><strong>å¤„ç†</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_stuck_state</span>(<span class="hljs-params">self</span>):
    <span class="hljs-string">"""å¤„ç†æ­»å¾ªç¯çŠ¶æ€"""</span>
    stuck_prompt = (
        <span class="hljs-string">"æ£€æµ‹åˆ°é‡å¤å“åº”ã€‚è¯·è€ƒè™‘æ–°ç­–ç•¥ï¼Œé¿å…é‡å¤å·²å°è¯•çš„æ— æ•ˆè·¯å¾„ã€‚"</span>
    )
    <span class="hljs-comment"># å°†æç¤ºæ·»åŠ åˆ°ä¸‹ä¸€æ­¥</span>
    self.next_step_prompt = <span class="hljs-string">f"<span class="hljs-subst">{stuck_prompt}</span>\n<span class="hljs-subst">{self.next_step_prompt}</span>"</span>
    logger.warning(<span class="hljs-string">"æ£€æµ‹åˆ°æ­»å¾ªç¯ï¼Œå·²æ·»åŠ æç¤º"</span>)
</code></pre>
<hr/>
<h2 data-id="heading-50">9. æœ€ä½³å®è·µ</h2>
<h3 data-id="heading-51">9.1 Prompt Engineering</h3>
<h4 data-id="heading-52">ç³»ç»Ÿæç¤ºè¯è®¾è®¡</h4>
<p><strong>å¥½çš„ç³»ç»Ÿæç¤ºè¯</strong>:</p>
<pre><code class="hljs language-python" lang="python">SYSTEM_PROMPT = <span class="hljs-string">"""
ä½ æ˜¯ OpenManusï¼Œä¸€ä¸ªå…¨èƒ½çš„ AI åŠ©æ‰‹ï¼Œæ—¨åœ¨è§£å†³ç”¨æˆ·æå‡ºçš„ä»»ä½•ä»»åŠ¡ã€‚

å·¥å…·ä½¿ç”¨åŸåˆ™:
1. æ ¹æ®ç”¨æˆ·éœ€æ±‚ä¸»åŠ¨é€‰æ‹©æœ€åˆé€‚çš„å·¥å…·æˆ–å·¥å…·ç»„åˆ
2. å¯¹äºå¤æ‚ä»»åŠ¡ï¼Œåˆ†è§£é—®é¢˜å¹¶é€æ­¥ä½¿ç”¨ä¸åŒå·¥å…·è§£å†³
3. æ¯æ¬¡ä½¿ç”¨å·¥å…·åï¼Œæ¸…æ™°åœ°è§£é‡Šæ‰§è¡Œç»“æœå¹¶å»ºè®®ä¸‹ä¸€æ­¥

å¯ç”¨å·¥å…·:
{tool_descriptions}

å·¥ä½œç›®å½•: {directory}

é‡è¦æç¤º:
- å§‹ç»ˆéªŒè¯å·¥å…·æ‰§è¡Œç»“æœ
- é‡åˆ°é”™è¯¯æ—¶å°è¯•æ›¿ä»£æ–¹æ¡ˆ
- å®Œæˆä»»åŠ¡åæ˜ç¡®è°ƒç”¨ terminate å·¥å…·
"""</span>
</code></pre>
<p><strong>ä¸‹ä¸€æ­¥æç¤ºè¯</strong>:</p>
<pre><code class="hljs language-python" lang="python">NEXT_STEP_PROMPT = <span class="hljs-string">"""
åŸºäºç”¨æˆ·éœ€æ±‚å’Œå½“å‰è¿›åº¦ï¼Œè¯·:
1. åˆ†æå½“å‰çŠ¶æ€
2. å†³å®šä¸‹ä¸€æ­¥æ“ä½œ
3. é€‰æ‹©åˆé€‚çš„å·¥å…·æ‰§è¡Œ
"""</span>
</code></pre>
<h3 data-id="heading-53">9.2 é”™è¯¯å¤„ç†</h3>
<p><strong>1. å·¥å…·æ‰§è¡Œå¤±è´¥</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">try</span>:
    result = <span class="hljs-keyword">await</span> tool.execute(**args)
<span class="hljs-keyword">except</span> ToolError <span class="hljs-keyword">as</span> e:
    <span class="hljs-comment"># è¿”å›å‹å¥½çš„é”™è¯¯ä¿¡æ¯ç»™ LLM</span>
    <span class="hljs-keyword">return</span> ToolFailure(error=<span class="hljs-string">f"å·¥å…·æ‰§è¡Œå¤±è´¥: <span class="hljs-subst">{e.message}</span>"</span>)
<span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
    logger.exception(<span class="hljs-string">"Unexpected error"</span>)
    <span class="hljs-keyword">return</span> ToolFailure(error=<span class="hljs-string">f"æœªé¢„æœŸçš„é”™è¯¯: <span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>)
</code></pre>
<p><strong>2. LLM API å¤±è´¥</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-meta">@retry(<span class="hljs-params">
    wait=wait_random_exponential(<span class="hljs-params"><span class="hljs-built_in">min</span>=<span class="hljs-number">1</span>, <span class="hljs-built_in">max</span>=<span class="hljs-number">60</span></span>),
    stop=stop_after_attempt(<span class="hljs-params"><span class="hljs-number">6</span></span>),
    retry=retry_if_exception_type(<span class="hljs-params">(<span class="hljs-params">OpenAIError, Exception</span>)</span>)
</span>)</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">ask</span>(<span class="hljs-params">...</span>):
    <span class="hljs-comment"># è‡ªåŠ¨é‡è¯•</span>
</code></pre>
<p><strong>3. Token é™åˆ¶</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> self.check_token_limit(input_tokens):
    <span class="hljs-keyword">raise</span> TokenLimitExceeded(
        <span class="hljs-string">f"è¶…è¿‡ Token é™åˆ¶: <span class="hljs-subst">{self.total_input_tokens + input_tokens}</span> &gt; <span class="hljs-subst">{self.max_input_tokens}</span>"</span>
    )
</code></pre>
<h3 data-id="heading-54">9.3 æ€§èƒ½ä¼˜åŒ–</h3>
<p><strong>1. é™åˆ¶è§‚å¯Ÿé•¿åº¦</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Manus</span>(<span class="hljs-title class_ inherited__">ToolCallAgent</span>):
    max_observe: <span class="hljs-built_in">int</span> = <span class="hljs-number">10000</span>  <span class="hljs-comment"># é˜²æ­¢ä¸Šä¸‹æ–‡è¿‡é•¿</span>
</code></pre>
<p><strong>2. æµå¼è¾“å‡º</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ä½¿ç”¨æµå¼è¾“å‡ºæå‡ç”¨æˆ·ä½“éªŒ</span>
response = <span class="hljs-keyword">await</span> llm.ask(messages, stream=<span class="hljs-literal">True</span>)
</code></pre>
<p><strong>3. å¼‚æ­¥æ‰§è¡Œ</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ‰€æœ‰ IO æ“ä½œä½¿ç”¨ async/await</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, ...</span>):
    <span class="hljs-keyword">await</span> asyncio.gather(
        task1(),
        task2(),
        task3(),
    )
</code></pre>
<h3 data-id="heading-55">9.4 å®‰å…¨å»ºè®®</h3>
<p><strong>1. ä½¿ç”¨æ²™ç®±</strong>:</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[sandbox]</span>
<span class="hljs-attr">use_sandbox</span> = <span class="hljs-literal">true</span>
<span class="hljs-attr">network_enabled</span> = <span class="hljs-literal">false</span>  <span class="hljs-comment"># ç¦ç”¨ç½‘ç»œè®¿é—®</span>
</code></pre>
<p><strong>2. æ–‡ä»¶è·¯å¾„éªŒè¯</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># ç¡®ä¿è·¯å¾„åœ¨å·¥ä½œç›®å½•å†…</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> path.is_absolute():
    <span class="hljs-keyword">raise</span> ToolError(<span class="hljs-string">"åªæ¥å—ç»å¯¹è·¯å¾„"</span>)

<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-built_in">str</span>(path).startswith(<span class="hljs-built_in">str</span>(WORKSPACE_ROOT)):
    <span class="hljs-keyword">raise</span> ToolError(<span class="hljs-string">"è·¯å¾„å¿…é¡»åœ¨å·¥ä½œç›®å½•å†…"</span>)
</code></pre>
<p><strong>3. ä»£ç æ‰§è¡Œè¶…æ—¶</strong>:</p>
<pre><code class="hljs language-python" lang="python">proc.join(timeout)  <span class="hljs-comment"># é˜²æ­¢æ— é™å¾ªç¯</span>
<span class="hljs-keyword">if</span> proc.is_alive():
    proc.terminate()
</code></pre>
<hr/>
<h2 data-id="heading-56">10. å¸¸è§é—®é¢˜</h2>
<h3 data-id="heading-57">10.1 å®‰è£…å’Œé…ç½®</h3>
<p><strong>Q: å¦‚ä½•é€‰æ‹© Python ç‰ˆæœ¬?</strong></p>
<p>A: OpenManus éœ€è¦ Python 3.12+:</p>
<pre><code class="hljs language-bash" lang="bash">python --version  <span class="hljs-comment"># ç¡®ä¿ &gt;= 3.12</span>
</code></pre>
<p><strong>Q: ä¾èµ–å®‰è£…å¤±è´¥æ€ä¹ˆåŠ?</strong></p>
<p>A: ä½¿ç”¨ uv (æ¨è) æˆ–æ¸…åé•œåƒ:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ–¹æ³• 1: uv (å¿«é€Ÿ)</span>
uv pip install -r requirements.txt

<span class="hljs-comment"># æ–¹æ³• 2: pip + é•œåƒ</span>
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre>
<p><strong>Q: å¦‚ä½•é…ç½®å¤šä¸ª API Key?</strong></p>
<p>A: åœ¨ <code>config.toml</code> ä¸­é…ç½®:</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[llm]</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-default-key"</span>

<span class="hljs-section">[llm.vision]</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-vision-key"</span>

<span class="hljs-section">[llm.planning]</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-planning-key"</span>
</code></pre>
<h3 data-id="heading-58">10.2 ä½¿ç”¨é—®é¢˜</h3>
<p><strong>Q: Agent æ‰§è¡Œæ—¶é—´è¿‡é•¿?</strong></p>
<p>A: è°ƒæ•´ <code>max_steps</code>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Manus</span>(<span class="hljs-title class_ inherited__">ToolCallAgent</span>):
    max_steps: <span class="hljs-built_in">int</span> = <span class="hljs-number">10</span>  <span class="hljs-comment"># å‡å°‘æœ€å¤§æ­¥æ•°</span>
</code></pre>
<p><strong>Q: å¦‚ä½•ç¦ç”¨æŸä¸ªå·¥å…·?</strong></p>
<p>A: åœ¨åˆ›å»º Agent æ—¶ç§»é™¤:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># é»˜è®¤é…ç½®</span>
available_tools = ToolCollection(
    PythonExecute(),
    <span class="hljs-comment"># BrowserUseTool(),  # æ³¨é‡Šæ‰ä¸éœ€è¦çš„å·¥å…·</span>
    StrReplaceEditor(),
    Terminate()
)
</code></pre>
<p><strong>Q: æµè§ˆå™¨å·¥å…·æ— æ³•ä½¿ç”¨?</strong></p>
<p>A: å®‰è£… Playwright:</p>
<pre><code class="hljs language-bash" lang="bash">playwright install
</code></pre>
<h3 data-id="heading-59">10.3 å¼€å‘é—®é¢˜</h3>
<p><strong>Q: å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰å·¥å…·?</strong></p>
<p>A: ç»§æ‰¿ <code>BaseTool</code>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomTool</span>(<span class="hljs-title class_ inherited__">BaseTool</span>):
    name: <span class="hljs-built_in">str</span> = <span class="hljs-string">"custom_tool"</span>
    description: <span class="hljs-built_in">str</span> = <span class="hljs-string">"è‡ªå®šä¹‰å·¥å…·çš„æè¿°"</span>
    parameters: <span class="hljs-built_in">dict</span> = {
        <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,
        <span class="hljs-string">"properties"</span>: {
            <span class="hljs-string">"param1"</span>: {<span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>, <span class="hljs-string">"description"</span>: <span class="hljs-string">"å‚æ•° 1"</span>}
        },
        <span class="hljs-string">"required"</span>: [<span class="hljs-string">"param1"</span>]
    }

    <span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">execute</span>(<span class="hljs-params">self, param1: <span class="hljs-built_in">str</span>, **kwargs</span>) -&gt; ToolResult:
        <span class="hljs-comment"># å®ç°å·¥å…·é€»è¾‘</span>
        result = do_something(param1)
        <span class="hljs-keyword">return</span> ToolResult(output=result)

<span class="hljs-comment"># ä½¿ç”¨</span>
agent = Manus()
agent.available_tools.add_tool(CustomTool())
</code></pre>
<p><strong>Q: å¦‚ä½•è°ƒè¯• Agent è¡Œä¸º?</strong></p>
<p>A: æŸ¥çœ‹æ—¥å¿—:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># app/logger.py å·²é…ç½® loguru</span>
<span class="hljs-comment"># æ—¥å¿—ä½ç½®: logs/{timestamp}.log</span>

<span class="hljs-comment"># æŸ¥çœ‹å®æ—¶æ—¥å¿—</span>
tail -f logs/*.log
</code></pre>
<p><strong>Q: å¦‚ä½•é›†æˆåˆ°è‡ªå·±çš„é¡¹ç›®?</strong></p>
<p>A: ä½œä¸ºåº“ä½¿ç”¨:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> app.agent.manus <span class="hljs-keyword">import</span> Manus

<span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">my_function</span>():
    agent = Manus()
    result = <span class="hljs-keyword">await</span> agent.run(<span class="hljs-string">"ä½ çš„ä»»åŠ¡"</span>)
    <span class="hljs-keyword">return</span> result
</code></pre>
<hr/>
<h2 data-id="heading-60">é™„å½•</h2>
<h3 data-id="heading-61">A. æ¶æ„å›¾</h3>
<pre><code class="hljs language-scss" lang="scss">OpenManus å®Œæ•´æ¶æ„å›¾

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ·ç•Œé¢å±‚                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   CLI    â”‚  â”‚   API    â”‚  â”‚   Web    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Agent å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              BaseAgent                          â”‚    â”‚
â”‚  â”‚  - state management                             â”‚    â”‚
â”‚  â”‚  - memory management                            â”‚    â”‚
â”‚  â”‚  - step execution loop                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                     â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚            ReActAgent                           â”‚    â”‚
â”‚  â”‚  - <span class="hljs-built_in">think</span>() <span class="hljs-selector-attr">[abstract]</span>                           â”‚    â”‚
â”‚  â”‚  - <span class="hljs-built_in">act</span>() <span class="hljs-selector-attr">[abstract]</span>                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                     â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚          ToolCallAgent                          â”‚    â”‚
â”‚  â”‚  - tool selection via LLM                       â”‚    â”‚
â”‚  â”‚  - tool execution                               â”‚    â”‚
â”‚  â”‚  - result observation                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                     â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Manus / MCPAgent / CustomAgents               â”‚    â”‚
â”‚  â”‚  - specific implementations                     â”‚    â”‚
â”‚  â”‚  - custom tools &amp; behaviors                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å·¥å…·å±‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Python     â”‚ â”‚   FileEdit   â”‚ â”‚   Browser    â”‚    â”‚
â”‚  â”‚   Execute    â”‚ â”‚              â”‚ â”‚   Automation â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Web        â”‚ â”‚   Terminate  â”‚ â”‚   Custom     â”‚    â”‚
â”‚  â”‚   Search     â”‚ â”‚              â”‚ â”‚   Tools      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                åŸºç¡€è®¾æ–½å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚     LLM      â”‚ â”‚   Sandbox    â”‚ â”‚   Config     â”‚    â”‚
â”‚  â”‚   - OpenAI   â”‚ â”‚   - Docker   â”‚ â”‚   - TOML     â”‚    â”‚
â”‚  â”‚   - Azure    â”‚ â”‚   - Local    â”‚ â”‚   - Env Vars â”‚    â”‚
â”‚  â”‚   - AWS      â”‚ â”‚              â”‚ â”‚              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚   Memory     â”‚ â”‚   Logger     â”‚                     â”‚
â”‚  â”‚   (Messages) â”‚ â”‚   (Loguru)   â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-62">B. æ•°æ®æµå›¾</h3>
<pre><code class="hljs language-vbscript" lang="vbscript">ç”¨æˆ·è¯·æ±‚ â†’ Agent å¤„ç†æµç¨‹

<span class="hljs-number">1.</span> åˆå§‹åŒ–
   User Input
      â”‚
      â–¼
   Agent.run(<span class="hljs-built_in">request</span>)
      â”‚
      â–¼
   Memory.add_message(user_message)

<span class="hljs-number">2.</span> ä¸»å¾ªç¯
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  <span class="hljs-keyword">while</span> <span class="hljs-keyword">step</span> &lt; max_steps:        â”‚
   â”‚                                 â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚  â”‚  THINK Phase              â”‚ â”‚
   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
   â”‚  â”‚  â”‚ æ„é€  Messages       â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - System Prompt     â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - Conversation      â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - <span class="hljs-keyword">Next</span> <span class="hljs-keyword">Step</span> Prompt  â”‚  â”‚ â”‚
   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
   â”‚  â”‚             â–¼              â”‚ â”‚
   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
   â”‚  â”‚  â”‚ LLM.ask_tool()      â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - Send <span class="hljs-keyword">to</span> API       â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - Parse <span class="hljs-built_in">Response</span>    â”‚  â”‚ â”‚
   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
   â”‚  â”‚             â–¼              â”‚ â”‚
   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
   â”‚  â”‚  â”‚ Extract Tool Calls  â”‚  â”‚ â”‚
   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
   â”‚  â”‚             â–¼              â”‚ â”‚
   â”‚  â”‚  Memory.add_message(       â”‚ â”‚
   â”‚  â”‚    assistant_message)      â”‚ â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â”‚             â”‚                   â”‚
   â”‚             â–¼                   â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚  â”‚  ACT Phase                â”‚ â”‚
   â”‚  â”‚  <span class="hljs-keyword">for</span> tool_call <span class="hljs-keyword">in</span> calls:  â”‚ â”‚
   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
   â”‚  â”‚  â”‚ Parse Arguments     â”‚  â”‚ â”‚
   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
   â”‚  â”‚             â–¼              â”‚ â”‚
   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
   â”‚  â”‚  â”‚ <span class="hljs-keyword">Execute</span> Tool        â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - PythonExecute     â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - FileEdit          â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - Browser           â”‚  â”‚ â”‚
   â”‚  â”‚  â”‚ - etc.              â”‚  â”‚ â”‚
   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
   â”‚  â”‚             â–¼              â”‚ â”‚
   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
   â”‚  â”‚  â”‚ Collect Results     â”‚  â”‚ â”‚
   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
   â”‚  â”‚             â–¼              â”‚ â”‚
   â”‚  â”‚  Memory.add_message(       â”‚ â”‚
   â”‚  â”‚    tool_message)           â”‚ â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â”‚             â”‚                   â”‚
   â”‚             â–¼                   â”‚
   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
   â”‚  â”‚  Check State              â”‚ â”‚
   â”‚  â”‚  - FINISHED?              â”‚ â”‚
   â”‚  â”‚  - Stuck <span class="hljs-keyword">Loop</span>?            â”‚ â”‚
   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
<span class="hljs-number">3.</span> æ¸…ç†å’Œè¿”å›
   Cleanup Resources
      â”‚
      â–¼
   Return Results
</code></pre>
<h3 data-id="heading-63">C. å¿«é€Ÿå‚è€ƒ</h3>
<p><strong>å¸¸ç”¨å‘½ä»¤</strong>:</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…</span>
uv pip install -r requirements.txt
playwright install

<span class="hljs-comment"># è¿è¡Œ</span>
python main.py                    <span class="hljs-comment"># æ ‡å‡†æ¨¡å¼</span>
python run_mcp.py                 <span class="hljs-comment"># MCP æ¨¡å¼</span>
python run_flow.py                <span class="hljs-comment"># å¤š Agent æ¨¡å¼</span>

<span class="hljs-comment"># é…ç½®</span>
<span class="hljs-built_in">cp</span> config/config.example.toml config/config.toml
vim config/config.toml

<span class="hljs-comment"># å¼€å‘</span>
pytest                            <span class="hljs-comment"># è¿è¡Œæµ‹è¯•</span>
pre-commit run --all-files       <span class="hljs-comment"># ä»£ç æ£€æŸ¥</span>
</code></pre>
<p><strong>å…³é”®æ–‡ä»¶è·¯å¾„</strong>:</p>
<pre><code class="hljs language-bash" lang="bash">app/agent/manus.py          <span class="hljs-comment"># ä¸» Agent</span>
app/llm.py                  <span class="hljs-comment"># LLM æ¥å£</span>
app/schema.py               <span class="hljs-comment"># æ•°æ®æ¨¡å‹</span>
app/tool/                   <span class="hljs-comment"># å·¥å…·ç›®å½•</span>
config/config.toml          <span class="hljs-comment"># é…ç½®æ–‡ä»¶</span>
</code></pre>
<p><strong>é‡è¦ç±»å’Œæ–¹æ³•</strong>:</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># Agent</span>
Manus()                     <span class="hljs-comment"># åˆ›å»ºä¸» Agent</span>
agent.run(prompt)           <span class="hljs-comment"># æ‰§è¡Œä»»åŠ¡</span>

<span class="hljs-comment"># LLM</span>
LLM(config_name=<span class="hljs-string">"default"</span>)  <span class="hljs-comment"># åˆ›å»º LLM</span>
llm.ask(messages)           <span class="hljs-comment"># å¯¹è¯</span>
llm.ask_tool(messages, tools)  <span class="hljs-comment"># å·¥å…·è°ƒç”¨</span>

<span class="hljs-comment"># å·¥å…·</span>
ToolCollection(*tools)      <span class="hljs-comment"># å·¥å…·é›†åˆ</span>
tool.execute(**kwargs)      <span class="hljs-comment"># æ‰§è¡Œå·¥å…·</span>

<span class="hljs-comment"># é…ç½®</span>
<span class="hljs-keyword">from</span> app.config <span class="hljs-keyword">import</span> config
config.llm                  <span class="hljs-comment"># LLM é…ç½®</span>
config.sandbox              <span class="hljs-comment"># æ²™ç®±é…ç½®</span>
config.workspace_root       <span class="hljs-comment"># å·¥ä½œç›®å½•</span>
</code></pre>
<hr/>
<h2 data-id="heading-64">æ€»ç»“</h2>
<p>OpenManus æ˜¯ä¸€ä¸ª<strong>å¼ºå¤§è€Œçµæ´»çš„ AI Agent æ¡†æ¶</strong>ï¼Œé€šè¿‡æ¸…æ™°çš„æ¶æ„è®¾è®¡å’Œä¸°å¯Œçš„å·¥å…·æ”¯æŒï¼Œèƒ½å¤Ÿè§£å†³å„ç§å¤æ‚ä»»åŠ¡ã€‚</p>
<p><strong>æ ¸å¿ƒä¼˜åŠ¿</strong>:</p>
<ol>
<li>âœ… <strong>æ¶æ„æ¸…æ™°</strong>: ReAct èŒƒå¼ + åˆ†å±‚è®¾è®¡</li>
<li>âœ… <strong>æ˜“äºæ‰©å±•</strong>: æ’ä»¶åŒ–å·¥å…·ç³»ç»Ÿ</li>
<li>âœ… <strong>ç”Ÿäº§å°±ç»ª</strong>: é”™è¯¯å¤„ç†ã€é‡è¯•ã€æ—¥å¿—å®Œå–„</li>
<li>âœ… <strong>å®‰å…¨å¯é </strong>: æ²™ç®±ç¯å¢ƒã€Token é™åˆ¶</li>
<li>âœ… <strong>æ–‡æ¡£å®Œæ•´</strong>: ä»£ç æ³¨é‡Š + ç¤ºä¾‹ä¸°å¯Œ</li>
</ol>
<p><strong>å­¦ä¹ è·¯å¾„å»ºè®®</strong>:</p>
<ol>
<li>ä» <code>main.py</code> å¼€å§‹ï¼Œç†è§£åŸºæœ¬æµç¨‹</li>
<li>é˜…è¯» <code>BaseAgent</code> â†’ <code>ReActAgent</code> â†’ <code>ToolCallAgent</code> â†’ <code>Manus</code></li>
<li>æ·±å…¥ç†è§£ LLM æ¥å£å’Œ Token ç®¡ç†</li>
<li>å­¦ä¹ å„ä¸ªå†…ç½®å·¥å…·çš„å®ç°</li>
<li>å°è¯•åˆ›å»ºè‡ªå®šä¹‰å·¥å…·å’Œ Agent</li>
</ol>
<p><strong>åç»­æ¢ç´¢</strong>:</p>
<ul>
<li>å®ç°è‡ªå®šä¹‰ Agent</li>
<li>é›†æˆæ–°çš„å·¥å…·</li>
<li>ä¼˜åŒ– Prompt Engineering</li>
<li>æ¢ç´¢å¤š Agent åä½œ</li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æ·±åº¦å­¦ä¹ Day14ã€‘å‘Šåˆ«æ™®é€šRNNçš„â€œå¥å¿˜ç—‡â€ï¼LSTMé—¨æ§æœºåˆ¶ï¼Œæ‹¿æé•¿åºåˆ—å»ºæ¨¡]]></title>    <link>https://juejin.cn/post/7597080391879671818</link>    <guid>https://juejin.cn/post/7597080391879671818</guid>    <pubDate>2026-01-20T07:54:23.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597080391879671818" data-draft-id="7596698363964571686" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æ·±åº¦å­¦ä¹ Day14ã€‘å‘Šåˆ«æ™®é€šRNNçš„â€œå¥å¿˜ç—‡â€ï¼LSTMé—¨æ§æœºåˆ¶ï¼Œæ‹¿æé•¿åºåˆ—å»ºæ¨¡"/> <meta itemprop="keywords" content="æ·±åº¦å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-20T07:54:23.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŸ æŸ é…±"/> <meta itemprop="url" content="https://juejin.cn/user/3739876675556569"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æ·±åº¦å­¦ä¹ Day14ã€‘å‘Šåˆ«æ™®é€šRNNçš„â€œå¥å¿˜ç—‡â€ï¼LSTMé—¨æ§æœºåˆ¶ï¼Œæ‹¿æé•¿åºåˆ—å»ºæ¨¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3739876675556569/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŸ æŸ é…±
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:54:23.000Z" title="Tue Jan 20 2026 07:54:23 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>LSTMé€šè¿‡â€˜é—å¿˜é—¨ã€è¾“å…¥é—¨ã€è¾“å‡ºé—¨â€™ç»™AIçš„è®°å¿†è£…â€˜å¼€å…³â€™ï¼Œè§£å†³äº†æ™®é€šRNNçš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œè®©æ¨¡å‹ä¸ä»…èƒ½å¤Ÿè¯»çŸ­åºåˆ—ï¼Œè¿˜èƒ½å•ƒä¸‹é•¿æ–‡æœ¬çš„â€˜ç¡¬éª¨å¤´â€™ã€‚</p>
</blockquote>
<p><strong>æ‘˜è¦</strong>ï¼šæˆ‘ä»¬ç”¨â€œå¾ªç¯å±‚+åµŒå…¥å±‚â€æ‰“å¼€äº†åºåˆ—æ•°æ®çš„å¤§é—¨ï¼Œä½†é‚£åªæ˜¯åŸºç¡€æ¬¾æ™®é€šRNNâ€”â€”é¢å¯¹é•¿åºåˆ—ï¼ˆæ¯”å¦‚è¶…è¿‡20ä¸ªè¯çš„å¥å­ï¼‰ï¼Œå®ƒå°±ä¼šçŠ¯â€œå¥å¿˜ç—‡â€ï¼ˆæ¢¯åº¦æ¶ˆå¤±ï¼‰ï¼Œè®°ä¸ä½å‰é¢çš„å…³é”®ä¿¡æ¯ã€‚ä»Šå¤©å’±ç›´æ¥ä¸Šâ€œè¿›é˜¶æ–¹æ¡ˆâ€ï¼šæ‹†è§£LSTMï¼ˆé•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼‰çš„æ ¸å¿ƒé—¨æ§æœºåˆ¶ï¼Œææ‡‚å®ƒå¦‚ä½•é€šè¿‡â€œé—å¿˜é—¨ã€è¾“å…¥é—¨ã€è¾“å‡ºé—¨â€ç»™AIçš„è®°å¿†è£…â€œå¼€å…³â€ï¼Œè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚åŒæ—¶ç”¨PyTorchå®æˆ˜æ–‡æœ¬åˆ†ç±»ä»»åŠ¡ï¼Œå¯¹æ¯”æ™®é€šRNNä¸LSTMçš„è®­ç»ƒæ•ˆæœï¼Œä¸ºåç»­NLPå®æˆ˜ç­‘ç‰¢åŸºç¡€â€”â€”ä»æ­¤AIä¸ä»…èƒ½è¯»çŸ­åºåˆ—ï¼Œè¿˜èƒ½å•ƒä¸‹é•¿æ–‡æœ¬çš„â€œç¡¬éª¨å¤´â€ï¼</p>
<p><em>å…³é”®è¯ï¼šRNNã€LSTMã€é—¨æ§æœºåˆ¶ã€æ¢¯åº¦æ¶ˆå¤±ã€æ–‡æœ¬åˆ†ç±»ã€é•¿åºåˆ—å»ºæ¨¡ã€é—å¿˜é—¨ã€è¾“å…¥é—¨ã€è¾“å‡ºé—¨</em></p>
<h2 data-id="heading-0">1. å¼€ç¯‡è¡”æ¥</h2>
<p>ä¸Šä¸€æœŸæˆ‘ä»¬ç”¨æ™®é€šRNN+åµŒå…¥å±‚æå®šäº†3ä¸ªå•è¯çš„çŸ­åºåˆ—åˆ†ç±»ï¼Œæ•ˆæœçœ‹ä¼¼å®Œç¾ï¼Œä½†é‚£æ˜¯å› ä¸ºâ€œåºåˆ—å¤ªçŸ­â€â€”â€”å¦‚æœæŠŠåºåˆ—é•¿åº¦æ‹‰é•¿åˆ°20ã€50ç”šè‡³100ï¼Œæ™®é€šRNNå°±ä¼šå½»åº•â€œæ­‡èœâ€ï¼š</p>
<p>æ¯”å¦‚ç»™å®ƒä¸€å¥è¯ï¼šâ€œæˆ‘æ˜¨å¤©ä¹°äº†ä¸€æœ¬å°è¯´ï¼Œè¯»äº†ä¸¤ç« åè§‰å¾—æƒ…èŠ‚å¾ˆå¸å¼•äººï¼Œæ‰€ä»¥ä»Šå¤©æ‰“ç®—____â€ï¼Œæ™®é€šRNNè¯»åˆ°â€œæ‰“ç®—â€æ—¶ï¼Œæ—©å°±å¿˜äº†å‰é¢â€œä¹°äº†ä¸€æœ¬å°è¯´â€è¿™ä¸ªå…³é”®å‰æï¼Œå¤§æ¦‚ç‡ä¼šé¢„æµ‹å‡ºâ€œåƒé¥­â€â€œç¡è§‰â€è¿™ç±»å’Œä¸Šä¸‹æ–‡æ— å…³çš„è¯â€”â€”è¿™å°±æ˜¯æ™®é€šRNNçš„è‡´å‘½ç¼ºé™·ï¼š<strong>æ¢¯åº¦æ¶ˆå¤±</strong>ã€‚</p>
<p>è¿™é‡Œå†ç²¾å‡†æ‹†è§£æ™®é€šRNNæ¢¯åº¦æ¶ˆå¤±çš„æœ¬è´¨ï¼š</p>
<p>æ™®é€šRNNçš„éšè—çŠ¶æ€æ›´æ–°ä¾èµ–<code>tanh</code>æ¿€æ´»å‡½æ•°ï¼Œå…¶å¯¼æ•°ç»å¯¹å€¼æœ€å¤§ä¸è¶…è¿‡1ã€‚æ¢¯åº¦åå‘ä¼ æ’­æ—¶ï¼Œéœ€æ²¿åºåˆ—é•¿åº¦æ–¹å‘åšé“¾å¼ä¹˜ç§¯â€”â€”åºåˆ—è¶Šé•¿ï¼Œæ¢¯åº¦å€¼è¶Šæ¥è¿‘0ï¼Œæœ€ç»ˆå¯¼è‡´æ¨¡å‹æ— æ³•æ›´æ–°æ—©æœŸåºåˆ—çš„å‚æ•°ï¼Œç›¸å½“äºâ€œè®°ä¸ä½å‰é¢çš„å†…å®¹â€ã€‚</p>
<p>è€ŒLSTMçš„æ ¸å¿ƒè´¡çŒ®ï¼Œå°±æ˜¯é€šè¿‡â€œé—¨æ§æœºåˆ¶â€å’Œâ€œç‹¬ç«‹çš„ç»†èƒçŠ¶æ€â€ï¼Œç»™æ¢¯åº¦ä¼ æ’­â€œé“ºè·¯æ­æ¡¥â€ï¼Œè®©æ¢¯åº¦èƒ½ç¨³å®šä¼ é€’åˆ°æ—©æœŸåºåˆ—ï¼Œä»æ ¹æºä¸Šç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚å½¢è±¡åœ°è¯´ï¼š</p>
<ul>
<li><strong>æ™®é€šRNN = åªæœ‰çŸ­æœŸè®°å¿†çš„â€œé±¼â€</strong> ï¼šè®°ä¸ä½7ç§’å‰çš„äº‹ï¼Œé•¿åºåˆ—å»ºæ¨¡ç›´æ¥â€œå¤±å¿†â€â€”â€”å°±åƒä½ åˆšçœ‹å®Œç”µå½±å¼€å¤´ï¼Œçœ‹åˆ°ç»“å°¾å°±å¿˜äº†ä¸»è§’ä¸ºå•¥å‡ºå‘ï¼›</li>
<li><strong>LSTM = å¸¦â€œè®°å¿†å¼€å…³â€çš„â€œé«˜çº§è®°äº‹æœ¬â€</strong> ï¼šå†…ç½®â€œé—å¿˜ã€å†™å…¥ã€è¯»å–â€ä¸‰å¤§å¼€å…³ï¼Œèƒ½ä¸»åŠ¨ä¸¢åƒåœ¾ï¼ˆæ¯”å¦‚æ— å…³è¯­æ°”è¯ï¼‰ã€å­˜ç²¾åï¼ˆæ¯”å¦‚æ ¸å¿ƒå‰§æƒ…ï¼‰ï¼Œé•¿åºåˆ—ä¹Ÿèƒ½ç²¾å‡†æ‹¿æä¸Šä¸‹æ–‡ï¼›</li>
<li><strong>GRU = ç²¾ç®€ç‰ˆâ€œé«˜æ•ˆè®°äº‹æœ¬â€</strong> ï¼šæŠŠLSTMçš„ä¸‰å¤§é—¨ç æˆä¿©ï¼Œè¿˜çœäº†ç‹¬ç«‹ç»†èƒçŠ¶æ€ï¼Œæ€§ä»·æ¯”æ‹‰æ»¡â€”â€”é€‚åˆç®—åŠ›æœ‰é™ä½†æƒ³æå®šé•¿åºåˆ—çš„åœºæ™¯ï¼Œå ªç§°â€œå¹³æ°‘ç‰ˆåºåˆ—ç¥å™¨â€ï¼</li>
</ul>
<h2 data-id="heading-1">2. æ ¸å¿ƒåŸç†æ‹†è§£ï¼šLSTMçš„â€œç»­å‘½å¯†ç â€â€”â€”é—¨æ§æœºåˆ¶+ç»†èƒçŠ¶æ€</h2>
<p>LSTMçš„ç»“æ„æ¯”æ™®é€šRNNå¤æ‚ï¼Œä½†æ ¸å¿ƒé€»è¾‘å¯æ€»ç»“ä¸ºâ€œ1ä¸ªæ ¸å¿ƒ+3ä¸ªå¼€å…³â€ï¼š1ä¸ªæ ¸å¿ƒæ˜¯â€œç»†èƒçŠ¶æ€ï¼ˆCell Stateï¼‰â€ï¼ˆç›¸å½“äºé•¿æœŸè®°å¿†å­˜å‚¨é€šé“ï¼‰ï¼Œ3ä¸ªå¼€å…³æ˜¯â€œé—å¿˜é—¨ã€è¾“å…¥é—¨ã€è¾“å‡ºé—¨â€ï¼ˆæ§åˆ¶ä¿¡æ¯çš„é—å¿˜ã€å†™å…¥ã€è¯»å–ï¼‰ã€‚</p>
<h3 data-id="heading-2">2.1 å…ˆè¡¥åŸºç¡€ï¼šæ™®é€šRNNçš„â€œå¤±å¿†â€å…¨è¿‡ç¨‹ï¼ˆä»æ­å»ºåˆ°ç¿»è½¦ï¼‰</h3>
<p>ä»Šå¤©å…ˆä»å®Œæ•´RNNçš„æ­å»ºé€»è¾‘è¯´èµ·ï¼Œææ‡‚å®ƒä¸ºå•¥æ˜¯â€œçŸ­åºåˆ—ç‹è€…ï¼Œé•¿åºåˆ—åºŸæŸ´â€ã€‚æ™®é€šRNNåªæœ‰â€œéšè—çŠ¶æ€ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰â€ä¸€ä¸ªä¿¡æ¯ä¼ é€’é€šé“ï¼Œæ—¢è¦å½“â€œçŸ­æœŸè®°å¿†â€ï¼Œåˆè¦å¹²â€œä¿¡æ¯æ›´æ–°â€çš„æ´»ï¼Œçº¯å±â€œä¸€äººå¤šå²—ç´¯å®è‡ªå·±â€ã€‚</p>
<p><strong>å®Œæ•´RNNæ›´æ–°é€»è¾‘</strong> ï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>x</mi></msub><mo separator="true">â‹…</mo><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>W</mi><mi>h</mi></msub><mo separator="true">â‹…</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_t = tanh(W_xÂ·x_t + W_hÂ·h_{t-1} + b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></p>
<p>å’±ç”¨â€œè®°è´¦â€æ¯”å–»æ‹†è§£ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯â€œä»Šå¤©çš„æ”¶å…¥â€ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">h_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯â€œæˆªæ­¢æ˜¨å¤©çš„ä½™é¢â€ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">W_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>å’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">W_h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯â€œè®°è´¦ç³»æ•°â€ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">b</span></span></span></span></span>æ˜¯â€œå›ºå®šå¼€æ”¯â€â€”â€”<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span></span></span></span></span>å°±æ˜¯â€œä½™é¢ä¸Šé™â€ï¼ˆåªèƒ½åœ¨-1~1ä¹‹é—´ï¼‰ã€‚é—®é¢˜æ¥äº†ï¼šæ¯å¤©è®°è´¦éƒ½è¦æŠŠâ€œæ˜¨å¤©ä½™é¢â€å’Œâ€œä»Šå¤©æ”¶å…¥â€æ··åœ¨ä¸€èµ·ç®—æ–°ä½™é¢ï¼Œæ—¶é—´ä¸€é•¿ï¼ˆåºåˆ—ä¸€é•¿ï¼‰ï¼Œæ—©æœŸçš„â€œå¯åŠ¨èµ„é‡‘â€ï¼ˆå‰å‡ ä¸ªè¯çš„ä¿¡æ¯ï¼‰å°±è¢«ç¨€é‡Šæ²¡äº†ï¼</p>
<p><strong>æ¢¯åº¦æ¶ˆå¤±çš„â€œè¡€æ³ªå²â€</strong> ï¼šè®­ç»ƒæ—¶è¦é€šè¿‡â€œåå‘ä¼ æ’­â€è°ƒæ•´<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">W_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">W_h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>è¿™äº›å‚æ•°ï¼Œè€ŒRNNçš„æ¢¯åº¦è¦æ²¿ç€åºåˆ—é•¿åº¦â€œå€’ç€ç®—â€ï¼ˆä»æœ€åä¸€ä¸ªè¯ç®—åˆ°ç¬¬ä¸€ä¸ªè¯ï¼‰ã€‚æ¢¯åº¦æ˜¯â€œé“¾å¼ä¹˜ç§¯â€ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span></span></span></span></span>çš„å¯¼æ•°æœ€å¤§æ‰1ï¼Œä¹˜ä¸Šåå‡ ä¸ªç”šè‡³å‡ åä¸ªæ—¶åˆ»åï¼Œæ¢¯åº¦å°±å˜æˆâ€œ0.1çš„10æ¬¡æ–¹â€è¿™ç§æ¥è¿‘äº0çš„æ•°â€”â€”å‚æ•°æ ¹æœ¬æ›´ä¸åŠ¨ï¼Œç›¸å½“äºâ€œæ—©æœŸè®°å¿†è®°ä¸ä½ï¼Œæ”¹ä¹Ÿæ”¹ä¸äº†â€ï¼</p>
<p>æ ¸å¿ƒé—®é¢˜ï¼šéšè—çŠ¶æ€çš„æ›´æ–°æ˜¯â€œå…¨è¦†ç›–å¼â€çš„â€”â€”æ–°ä¿¡æ¯ä¼šç›´æ¥è¦†ç›–æ—§ä¿¡æ¯ï¼Œæ²¡æœ‰â€œç­›é€‰ä¸ä¿ç•™â€çš„æœºåˆ¶ï¼Œå°±åƒä½ å†™æ—¥è®°æ¯å¤©éƒ½ç”¨åŒä¸€å¼ çº¸ï¼Œå‰é¢çš„å†…å®¹å…¨è¢«æ¶‚æ‰äº†ï¼</p>
<p>æ™®é€šRNNåªæœ‰â€œéšè—çŠ¶æ€ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰â€ä¸€ä¸ªä¿¡æ¯ä¼ é€’é€šé“ï¼Œæ—¢è¦æ‰¿æ‹…â€œçŸ­æœŸè®°å¿†â€çš„è§’è‰²ï¼Œåˆè¦è´Ÿè´£â€œä¿¡æ¯æ›´æ–°ä¸ä¼ é€’â€ï¼Œå¯¼è‡´é•¿æœŸä¾èµ–æ— æ³•ä¼ é€’ã€‚å…¶æ›´æ–°é€»è¾‘ä¸ºï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>x</mi></msub><mo separator="true">â‹…</mo><msub><mi>x</mi><mi>t</mi></msub><mo>+</mo><msub><mi>W</mi><mi>h</mi></msub><mo separator="true">â‹…</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_t = tanh(W_xÂ·x_t + W_hÂ·h_{t-1} + b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></p>
<p>æ ¸å¿ƒé—®é¢˜ï¼šéšè—çŠ¶æ€çš„æ›´æ–°æ˜¯â€œå…¨è¦†ç›–å¼â€çš„â€”â€”æ–°ä¿¡æ¯ä¼šç›´æ¥è¦†ç›–æ—§ä¿¡æ¯ï¼Œæ²¡æœ‰â€œç­›é€‰ä¸ä¿ç•™â€çš„æœºåˆ¶ã€‚</p>
<h3 data-id="heading-3">2.2 LSTMçš„æ ¸å¿ƒæ”¹è¿›ï¼šç»™è®°å¿†è£…â€œæ™ºèƒ½ç®¡å®¶å›¢é˜Ÿâ€ï¼ˆç»†èƒçŠ¶æ€+ä¸‰å¤§é—¨ï¼‰</h3>
<p>LSTMä¹‹æ‰€ä»¥èƒ½è§£å†³â€œå¤±å¿†â€é—®é¢˜ï¼Œæœ¬è´¨æ˜¯ç»™RNNé…äº†ä¸ªâ€œæ™ºèƒ½ç®¡å®¶å›¢é˜Ÿâ€ï¼šç»†èƒçŠ¶æ€ï¼ˆCell Stateï¼‰æ˜¯â€œé•¿æœŸå‚¨ç‰©é—´â€ï¼Œä¸“é—¨å­˜é‡è¦ä¿¡æ¯ï¼›é—å¿˜é—¨ã€è¾“å…¥é—¨ã€è¾“å‡ºé—¨æ˜¯ä¸‰ä¸ªâ€œç®¡å®¶â€ï¼Œåˆ†åˆ«è´Ÿè´£â€œä¸¢åƒåœ¾â€â€œå­˜æ–°è´§â€â€œå–æœ‰ç”¨çš„â€â€”â€”åˆ†å·¥æ˜ç¡®ï¼Œå†ä¹Ÿä¸ä¼šä¹±ä¹±ç³Ÿç³Ÿä¸¢ä¿¡æ¯ï¼</p>
<p>LSTMæ–°å¢äº†â€œç»†èƒçŠ¶æ€ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">c_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰â€è¿™ä¸ªâ€œç‹¬ç«‹å‚¨ç‰©é—´â€ï¼Œä¿¡æ¯åœ¨é‡Œé¢å‡ ä¹æ— æŸè€—ä¼ é€’ï¼ˆç±»ä¼¼é«˜é€Ÿå…¬è·¯çš„ç›´è¡Œè½¦é“ï¼Œä¸ç”¨ç»•è·¯ï¼‰ï¼Œæ¢¯åº¦èƒ½æ²¿ç€è¿™ä¸ªé€šé“ç¨³å®šåå‘ä¼ æ’­â€”â€”ç›¸å½“äºâ€œæ—©æœŸè®°å¿†â€æœ‰äº†ä¸“å±ä¿é™©ç®±ï¼Œä¸ä¼šè¢«åæœŸä¿¡æ¯è¦†ç›–ã€‚ä¸‰å¤§é—¨éƒ½ç”±sigmoidæ¿€æ´»å‡½æ•°æ§åˆ¶ï¼ˆè¾“å‡º0~1çš„æ¦‚ç‡ï¼Œ0=å…³é—¨ï¼Œ1=å¼€é—¨ï¼‰ï¼Œç²¾å‡†æ§åˆ¶ä¿¡æ¯æµåŠ¨ã€‚ä¸‹é¢ç»“åˆâ€œè¯»ç”µå½±è¯„è®ºâ€åœºæ™¯ï¼Œç”¨â€œç®¡å®¶å¹²æ´»â€çš„é€»è¾‘æ‹†è§£æ¯ä¸ªç»„ä»¶ï¼š</p>
<p>è¿™ä¸‰ä¸ªç®¡å®¶ä¸æ˜¯å„è‡ªä¸ºæˆ˜ï¼Œè€Œæ˜¯ä¸€å¥—â€œæµæ°´çº¿ä½œä¸šâ€ï¼šå…ˆç”±é—å¿˜é—¨æ¸…åƒåœ¾ï¼Œå†ç”±è¾“å…¥é—¨å­˜æ–°è´§ï¼Œæœ€åç”±è¾“å‡ºé—¨æŒ‰éœ€å–è´§â€”â€”æ•´ä¸ªæµç¨‹é—­ç¯ï¼Œæ—¢ä¸æµªè´¹â€œè®°å¿†ç©ºé—´â€ï¼Œåˆèƒ½ç²¾å‡†å¯¹æ¥ä»»åŠ¡ã€‚ä¸‹é¢ç»“åˆâ€œå¤„ç†å¸¦è½¬æŠ˜çš„ç”µå½±è¯„è®ºâ€åœºæ™¯ï¼Œä¸€æ­¥æ­¥æ‹†è§£è¿™å¥—æµæ°´çº¿ã€‚</p>
<p>ä¸‹é¢ç»“åˆå…¬å¼ä¸æ–‡æœ¬åœºæ™¯ï¼ˆæ¯”å¦‚å¤„ç†å¥å­â€œæˆ‘ä¹°äº†å°è¯´ï¼Œæ‰“ç®—ç»§ç»­è¯»â€ï¼‰ï¼Œæ‹†è§£æ¯ä¸ªç»„ä»¶çš„ä½œç”¨ï¼š</p>
<h4 data-id="heading-4">2.2.1 ç»†èƒçŠ¶æ€ï¼ˆCell Stateï¼‰ï¼šé•¿æœŸè®°å¿†çš„â€œä¿é™©ç®±â€</h4>
<p>ç»†èƒçŠ¶æ€å°±åƒä½ å®¶é‡Œçš„â€œä¿é™©ç®±â€ï¼Œä¸“é—¨å­˜é‡è¦ä¸œè¥¿ï¼ˆæ¯”å¦‚è¯„è®ºé‡Œçš„â€œå‰§æƒ…ç²¾å½©â€â€œæ¼”æŠ€çƒ‚â€è¿™ç§æ ¸å¿ƒè§‚ç‚¹ï¼‰ï¼Œè´¯ç©¿æ•´ä¸ªLSTMå±‚ã€‚å®ƒçš„ä¿¡æ¯ä¼ é€’å‡ ä¹æ— æŸè€—ï¼Œå°±åƒä¿é™©ç®±é‡Œçš„ç å®ä¸ä¼šè¢«æ—¥å¸¸æ‚ç‰©æ±¡æŸ“â€”â€”å“ªæ€•è¯»åˆ°è¯„è®ºæœ€åä¸€ä¸ªè¯ï¼Œâ€œä¿é™©ç®±â€é‡Œè¿˜æ¸…æ™°è®°ç€å¼€å¤´çš„æ ¸å¿ƒè§‚ç‚¹ã€‚æ¢¯åº¦æ²¿ç€è¿™ä¸ªâ€œä¿é™©ç®±é€šé“â€åå‘ä¼ æ’­æ—¶ï¼Œä¸ä¼šè¢«åå¤ä¹˜ç§¯ç¨€é‡Šï¼Œä»æ ¹æºä¸Šè§£å†³äº†æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼æ¯”å¦‚è¯»åˆ°â€œæ‰“ç®—â€æ—¶ï¼Œç»†èƒçŠ¶æ€è¿˜èƒ½æ¸…æ™°ä¿ç•™â€œä¹°äº†å°è¯´â€è¿™ä¸ªæ—©æœŸä¿¡æ¯ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸ªå…³é”®çŸ¥è¯†ç‚¹ï¼šç»†èƒçŠ¶æ€çš„æ›´æ–°é€»è¾‘æ˜¯â€œç´¯åŠ è€Œéè¦†ç›–â€ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">c_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span> = æ—§è®°å¿†ç­›é€‰å + æ–°è®°å¿†ç­›é€‰åï¼‰ï¼Œæ¢¯åº¦åå‘ä¼ æ’­æ—¶èƒ½æ²¿ç€è¿™æ¡é€šé“â€œç›´æ¥ç›´å»â€ï¼Œä¸ç”¨ç»è¿‡å¤šæ¬¡<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span></span></span></span></span>å¯¼æ•°çš„ä¹˜ç§¯ç¨€é‡Šã€‚å°±åƒä½ åœ¨ç¬”è®°æœ¬ä¸Šç”¨ä¸åŒé¢œè‰²ç¬”è¡¥å……å†…å®¹ï¼Œè€Œä¸æ˜¯æ¶‚æ‰é‡å†™ï¼Œæ—©æœŸçš„å­—è¿¹ï¼ˆä¿¡æ¯ï¼‰æ°¸è¿œèƒ½æ‰¾åˆ°ï¼Œæ¢¯åº¦è‡ªç„¶ä¸ä¼šæ¶ˆå¤±ï¼</p>
<h4 data-id="heading-5">2.2.2 é—å¿˜é—¨ï¼ˆForget Gateï¼‰ï¼šâ€œåƒåœ¾åˆ†æ‹£ç®¡å®¶â€â€”â€”è¯¥ä¸¢çš„ä¸¢</h4>
<p>é—å¿˜é—¨æ˜¯å›¢é˜Ÿé‡Œçš„â€œåƒåœ¾åˆ†æ‹£å‘˜â€ï¼Œæ¯å¤©çš„å·¥ä½œå°±æ˜¯æ£€æŸ¥â€œä¿é™©ç®±â€é‡Œçš„ä¸œè¥¿ï¼šæ²¡ç”¨çš„ç›´æ¥ä¸¢ï¼Œæœ‰ç”¨çš„ç•™ç€ã€‚æ¯”å¦‚å¤„ç†è¯„è®ºâ€œæˆ‘è§‰å¾—è¿™éƒ¨ç”µå½±ï¼Œå‰§æƒ…å¾ˆç²¾å½©â€æ—¶ï¼Œâ€œæˆ‘è§‰å¾—â€â€œè¿™éƒ¨â€â€œï¼Œâ€è¿™äº›éƒ½æ˜¯åºŸè¯ï¼Œç•™ç€åªä¼šå åœ°æ–¹ï¼Œé—å¿˜é—¨å°±ä¼šç»™å®ƒä»¬è´´â€œä¸¢å¼ƒæ ‡ç­¾â€ï¼ˆæ¦‚ç‡æ¥è¿‘0ï¼‰ï¼›è€Œâ€œç”µå½±â€â€œå‰§æƒ…â€â€œç²¾å½©â€æ˜¯æ ¸å¿ƒä¿¡æ¯ï¼Œå°±è´´â€œä¿ç•™æ ‡ç­¾â€ï¼ˆæ¦‚ç‡æ¥è¿‘1ï¼‰ã€‚</p>
<p>å…¬å¼ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>f</mi></msub><mo separator="true">â‹…</mo><mo stretchy="false">[</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>+</mo><msub><mi>b</mi><mi>f</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_t = Ïƒ(W_fÂ·[h_{t-1}, x_t] + b_f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"/><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>è§£è¯»ï¼ˆäººè¯ç‰ˆï¼‰ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïƒ</mi></mrow><annotation encoding="application/x-tex">\sigma </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span></span></span></span></span>ï¼ˆsigmoidï¼‰æ˜¯â€œæ ‡ç­¾æ‰“å°æœºâ€ï¼Œè¾“å‡º0~1çš„æ¦‚ç‡æ ‡ç­¾ï¼›</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[h_{t-1}, x_t]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">]</span></span></span></span></span>è¡¨ç¤ºä¸Šä¸€æ—¶åˆ»éšè—çŠ¶æ€ï¼ˆçŸ­æœŸè®°å¿†ï¼‰ä¸å½“å‰è¾“å…¥ï¼ˆæ¯”å¦‚â€œæ‰“ç®—â€è¿™ä¸ªè¯çš„å‘é‡ï¼‰æ‹¼æ¥ï¼›æ˜¯â€œå¾…æ£€æŸ¥æ¸…å•â€â€”â€”<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">h_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯â€œä¿é™©ç®±é‡Œç°æœ‰çš„ä¸œè¥¿â€ï¼ˆä¸Šä¸€æ—¶åˆ»è®°å¿†ï¼‰ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ˜¯â€œä»Šå¤©æ–°æ”¶çš„åŒ…è£¹â€ï¼ˆå½“å‰è¾“å…¥è¯å‘é‡ï¼‰ï¼›</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">f_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>å’Œä¸Šä¸€æ—¶åˆ»ç»†èƒçŠ¶æ€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">c_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.2083em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span></span></span></span></span>â€œç›¸ä¹˜éªŒè´§â€ï¼šæ ‡ç­¾æ¥è¿‘0ï¼Œå°±æŠŠå¯¹åº”çš„æ—§ä¿¡æ¯ä¸¢äº†ï¼›æ¥è¿‘1ï¼Œå°±å®Œæ•´ä¿ç•™ã€‚</li>
</ul>
<p>å®ä¾‹å‡çº§ï¼šå¤„ç†è¯„è®ºâ€œæˆ‘æ˜¨å¤©çœ‹äº†ä¸€éƒ¨ç”µå½±ï¼Œè™½ç„¶ç‰¹æ•ˆå·®ï¼Œä½†å‰§æƒ…å¾ˆç²¾å½©â€æ—¶ï¼Œé—å¿˜é—¨ä¼šç»™â€œæ˜¨å¤©â€â€œçœ‹äº†â€â€œä¸€éƒ¨â€â€œè™½ç„¶â€è¿™äº›æ— å…³è¯åˆ†é…0.1ä»¥ä¸‹çš„æ¦‚ç‡ï¼ˆç›´æ¥ä¸¢ï¼‰ï¼Œç»™â€œç‰¹æ•ˆå·®â€â€œå‰§æƒ…ç²¾å½©â€åˆ†é…0.9ä»¥ä¸Šçš„æ¦‚ç‡ï¼ˆé‡ç‚¹ç•™ï¼‰â€”â€”å“ªæ€•åé¢éš”äº†ä¸ªâ€œä½†â€ï¼Œæ ¸å¿ƒè§‚ç‚¹ä¹Ÿä¸ä¼šä¸¢ï¼</p>
<p>å¯èƒ½æœ‰åŒå­¦ç–‘æƒ‘ï¼šâ€œä¸ºå•¥éè¦ä¸¢æ— ç”¨ä¿¡æ¯ï¼Ÿç•™ç€ä¸è¡Œå—ï¼Ÿâ€ å½“ç„¶ä¸è¡Œï¼å°±åƒä½ è®°ç¬”è®°å…¨æŠ„åºŸè¯ï¼Œæ‰¾é‡ç‚¹æ—¶åè€Œè¢«å¹²æ‰°â€”â€”é—å¿˜é—¨çš„æ ¸å¿ƒä»·å€¼æ˜¯â€œå‡è´Ÿâ€ï¼Œè®©ç»†èƒçŠ¶æ€åªå­˜æ ¸å¿ƒä¿¡æ¯ï¼Œåç»­è¾“å…¥é—¨å†™å…¥æ–°ä¿¡æ¯æ—¶æ›´ç²¾å‡†ï¼Œè¾“å‡ºé—¨å–è´§æ—¶æ›´é«˜æ•ˆã€‚æ¯”å¦‚å¤„ç†â€œæˆ‘æ˜¨å¤©å’Œæœ‹å‹å»çœ‹äº†ä¸€éƒ¨ç”µå½±ï¼Œè™½ç„¶ç‰¹æ•ˆå¾ˆä¸€èˆ¬ï¼Œä½†å‰§æƒ…çœŸçš„å¤ªç²¾å½©äº†â€ï¼Œé—å¿˜é—¨ä¼šç›´æ¥è¿‡æ»¤â€œæ˜¨å¤©å’Œæœ‹å‹å»çœ‹äº†ä¸€éƒ¨â€â€œè™½ç„¶â€è¿™äº›å†—ä½™ä¿¡æ¯ï¼Œåªç•™â€œç‰¹æ•ˆä¸€èˆ¬â€â€œå‰§æƒ…ç²¾å½©â€ï¼Œä¸ºè¾“å…¥é—¨åç»­å†™å…¥â€œç²¾å½©â€çš„å¼ºåŒ–ä¿¡æ¯é“ºè·¯ã€‚</p>
<h4 data-id="heading-6">2.2.3 è¾“å…¥é—¨ï¼ˆInput Gateï¼‰ï¼šâ€œå…¥åº“ç™»è®°ç®¡å®¶â€â€”â€”è¯¥å­˜çš„å­˜</h4>
<p>é—å¿˜é—¨ä¸¢å®Œåƒåœ¾ï¼Œè¾“å…¥é—¨å°±è¯¥å¹²æ´»äº†â€”â€”å®ƒæ˜¯â€œå…¥åº“ç™»è®°å‘˜â€ï¼Œè´Ÿè´£æ£€æŸ¥â€œä»Šå¤©æ–°æ”¶çš„åŒ…è£¹â€ï¼ˆå½“å‰è¾“å…¥<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼ŒæŠŠæœ‰ä»·å€¼çš„éƒ¨åˆ†ç™»è®°åæ”¾è¿›â€œä¿é™©ç®±â€ï¼ˆç»†èƒçŠ¶æ€ï¼‰ã€‚æ¯”å¦‚æ”¶åˆ°â€œç²¾å½©â€è¿™ä¸ªè¯ï¼Œè¾“å…¥é—¨ä¼šåˆ¤æ–­ï¼šâ€œè¿™æ˜¯æ ¸å¿ƒè¯„ä»·ï¼Œå¿…é¡»å­˜ï¼â€ï¼Œå°±ç™»è®°å…¥åº“ï¼›æ”¶åˆ°â€œçš„â€è¿™ä¸ªè¯ï¼Œå°±ç›´æ¥å¿½ç•¥ã€‚</p>
<p>å…¬å¼æ‹†æˆâ€œä¸‰æ­¥èµ°â€ï¼ˆæ›´æ˜“æ‡‚ï¼‰ï¼šâ‘  ç™»è®°ç­›é€‰ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>i</mi></msub><mo separator="true">â‹…</mo><mo stretchy="false">[</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">i_t = \sigma (W_iÂ·[h_{t-1}, x_t] + b_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼›â‘¡ æ‰“åŒ…æ–°è´§ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>A</mi><mo>~</mo></mover><mi>t</mi></msub><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>c</mi></msub><mo separator="true">â‹…</mo><mo stretchy="false">[</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>+</mo><msub><mi>b</mi><mi>c</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\tilde A_t = tanh(W_cÂ·[h_{t-1}, x_t] + b_c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼›â‘¢ å…¥åº“ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>=</mo><msub><mi>f</mi><mi>t</mi></msub><mo separator="true">â‹…</mo><msub><mi>c</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>i</mi><mi>t</mi></msub><mo separator="true">â‹…</mo><msub><mover accent="true"><mi>A</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">c_t = f_tÂ·c_{t-1} + i_tÂ·\tilde A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span></p>
<p>è§£è¯»ï¼ˆç®¡å®¶è§†è§’ï¼‰ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">i_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆè¾“å…¥é—¨æ¦‚ç‡ï¼‰ï¼šâ€œç™»è®°æ ‡ç­¾â€ï¼Œå†³å®šå“ªäº›æ–°è´§èƒ½å…¥åº“ï¼›</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>A</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\tilde A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆå€™é€‰è®°å¿†ï¼‰ï¼šâ€œæ‰“åŒ…å¥½çš„æ–°è´§â€ï¼ŒæŠŠå½“å‰è¾“å…¥è½¬æ¢æˆé€‚åˆå­˜è¿›ä¿é™©ç®±çš„æ ¼å¼ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span></span></span></span></span>å‹ç¼©åˆ°-1~1ï¼Œé¿å…â€œä½“ç§¯å¤ªå¤§â€ï¼‰ï¼›</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">c_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆæ›´æ–°åç»†èƒçŠ¶æ€ï¼‰ï¼šâ€œæ›´æ–°åçš„ä¿é™©ç®±â€â€”â€”å…ˆè£…é—å¿˜é—¨ç­›é€‰åçš„æ—§è´§ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>t</mi></msub><mo separator="true">â‹…</mo><msub><mi>c</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">f_tÂ·c_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œå†æ”¾è¿›è¾“å…¥é—¨ç­›é€‰åçš„æ–°è´§ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub><mo separator="true">â‹…</mo><msub><mover accent="true"><mi>A</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">i_tÂ·\tilde A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œå®Œç¾è¡”æ¥æ–°æ—§è®°å¿†ã€‚</li>
</ul>
<p>å®ä¾‹å‡çº§ï¼šå¤„ç†â€œç²¾å½©â€è¿™ä¸ªè¯æ—¶ï¼Œè¾“å…¥é—¨<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">i_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>è¾“å‡º0.95ï¼ˆé«˜ä¼˜å…ˆçº§ç™»è®°ï¼‰ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>A</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\tilde A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æŠŠâ€œç²¾å½©â€æ‰“åŒ…æˆ16ç»´å‘é‡ï¼›æ­¤æ—¶ä¿é™©ç®±é‡Œå·²æœ‰â€œç”µå½±â€â€œå‰§æƒ…â€çš„æ—§è´§ï¼Œæ›´æ–°åå°±å˜æˆâ€œç”µå½±+å‰§æƒ…+ç²¾å½©â€çš„å®Œæ•´è®°å¿†â€”â€”åç»­é¢„æµ‹â€œæ¨èâ€è¿˜æ˜¯â€œä¸æ¨èâ€æ—¶ï¼Œå°±èƒ½ç²¾å‡†å…³è”ï¼</p>
<p>è¾“å…¥é—¨æœ€å¦™çš„åœ°æ–¹ï¼Œæ˜¯â€œæ–°æ—§è®°å¿†çš„æ— ç¼è¡”æ¥â€â€”â€”ä¸æ˜¯ç®€å•å åŠ ï¼Œè€Œæ˜¯â€œç­›é€‰åèåˆâ€ã€‚æ¯”å¦‚ç»†èƒçŠ¶æ€é‡Œå·²æœ‰â€œç”µå½±â€â€œç‰¹æ•ˆä¸€èˆ¬â€ï¼Œè¾“å…¥é—¨æ¥æ”¶åˆ°â€œå‰§æƒ…ç²¾å½©â€åï¼Œä¼šä¼˜å…ˆå†™å…¥â€œå‰§æƒ…ç²¾å½©â€è¿™ä¸ªé«˜ä»·å€¼ä¿¡æ¯ï¼Œè¿˜ä¼šå¼±åŒ–â€œç‰¹æ•ˆä¸€èˆ¬â€çš„æƒé‡ï¼ˆå› ä¸ºæƒ…æ„Ÿåˆ†ç±»ä»»åŠ¡ä¸­ï¼Œå‰§æƒ…æ˜¯æ ¸å¿ƒè¯„ä»·ç»´åº¦ï¼‰ã€‚è¿™å°±åƒä½ è®°ç¬”è®°æ—¶ï¼Œä¼šæŠŠâ€œå‰§æƒ…ç²¾å½©â€æ ‡çº¢ï¼ŒåŒæ—¶æŠŠâ€œç‰¹æ•ˆä¸€èˆ¬â€å†™æˆå°å­—ï¼Œé‡ç‚¹ä¸€ç›®äº†ç„¶â€”â€”è€Œæ™®é€šRNNæ ¹æœ¬åšä¸åˆ°è¿™ç§â€œä¼˜å…ˆçº§æ’åºâ€ï¼Œåªä¼šæŠŠæ‰€æœ‰ä¿¡æ¯æ··ä¸ºä¸€è°ˆã€‚</p>
<h4 data-id="heading-7">2.2.4 è¾“å‡ºé—¨ï¼ˆOutput Gateï¼‰ï¼šâ€œå–è´§å‘è´§ç®¡å®¶â€â€”â€”è¯¥ç”¨çš„ç”¨</h4>
<p>ä¿é™©ç®±é‡Œçš„ä¸œè¥¿ä¸æ˜¯éƒ½è¦ç”¨ï¼Œè¾“å‡ºé—¨å°±æ˜¯â€œå‘è´§å‘˜â€ï¼Œè´Ÿè´£æ ¹æ®å½“å‰ä»»åŠ¡ï¼ˆæ¯”å¦‚é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ã€åˆ¤æ–­è¯„è®ºæƒ…æ„Ÿï¼‰ï¼Œä»ä¿é™©ç®±é‡Œå–æœ‰ç”¨çš„ä¸œè¥¿ï¼Œæ‰“åŒ…æˆâ€œçŸ­æœŸåŒ…è£¹â€ï¼ˆéšè—çŠ¶æ€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰å‘å‡ºå»ã€‚æ¯”å¦‚å½“å‰ä»»åŠ¡æ˜¯â€œåˆ¤æ–­æƒ…æ„Ÿâ€ï¼Œå°±å–â€œç²¾å½©â€â€œå¥½çœ‹â€è¿™äº›æ­£é¢è¯çš„è®°å¿†ï¼›ä»»åŠ¡æ˜¯â€œé¢„æµ‹ä¸‹ä¸€ä¸ªè¯â€ï¼Œå°±å–â€œå‰§æƒ…â€ç›¸å…³çš„è®°å¿†ã€‚</p>
<p>å…¬å¼ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>o</mi></msub><mo separator="true">â‹…</mo><mo stretchy="false">[</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>+</mo><msub><mi>b</mi><mi>o</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">o_t = \sigma (W_oÂ·[h_{t-1}, x_t] + b_o)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">o</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼›<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><msub><mi>o</mi><mi>t</mi></msub><mo separator="true">â‹…</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_t = o_tÂ·tanh(c_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>è§£è¯»ï¼ˆå‘è´§æµç¨‹ï¼‰ï¼š</p>
<ul>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼ˆè¾“å‡ºé—¨æ¦‚ç‡ï¼‰ï¼šâ€œå‘è´§æ¸…å•â€ï¼Œå†³å®šä¿é™©ç®±é‡Œå“ªäº›ä¸œè¥¿è¦å‘å‡ºå»ï¼›</li>
<li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msub><mi>c</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">tanh(c_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>ï¼šâ€œæ‰“åŒ…å‹ç¼©â€ï¼ŒæŠŠä¿é™©ç®±é‡Œçš„ä¸œè¥¿å‹ç¼©åˆ°-1~1ï¼Œé¿å…â€œåŒ…è£¹å¤ªå¤§â€ï¼›å†å’Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>o</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">o_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">o</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ç›¸ä¹˜ï¼Œåªå‘æ¸…å•ä¸Šçš„ä¸œè¥¿ï¼Œå¾—åˆ°å½“å‰æ—¶åˆ»çš„â€œçŸ­æœŸåŒ…è£¹â€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ã€‚</li>
</ul>
<p>å®ä¾‹å‡çº§ï¼šåšæƒ…æ„Ÿåˆ†ç±»æ—¶ï¼Œå¤„ç†åˆ°è¯„è®ºæœ€åä¸€ä¸ªè¯â€œæ¨èâ€ï¼Œè¾“å‡ºé—¨ä¼šä»ä¿é™©ç®±é‡Œå–å‡ºâ€œå‰§æƒ…ç²¾å½©â€â€œæ¼”æŠ€åœ¨çº¿â€â€œç”»é¢ç²¾ç¾â€è¿™äº›æ­£é¢è®°å¿†ï¼Œæ‰“åŒ…æˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>å‘ç»™å…¨è¿æ¥å±‚â€”â€”å…¨è¿æ¥å±‚ä¸€çœ‹ï¼Œç›´æ¥åˆ¤æ–­â€œæ­£é¢è¯„è®ºâ€ï¼›å¦‚æœå–åˆ°çš„æ˜¯â€œç‰¹æ•ˆå·®â€â€œå‰§æƒ…æ— èŠâ€ï¼Œå°±åˆ¤æ–­â€œè´Ÿé¢è¯„è®ºâ€ã€‚è¿™å°±æ˜¯LSTMç²¾å‡†åˆ†ç±»çš„æ ¸å¿ƒé€»è¾‘ï¼</p>
<p>è¾“å‡ºé—¨çš„â€œæŒ‰éœ€å–è´§â€èƒ½åŠ›ï¼Œæ˜¯LSTMé€‚é…ä¸åŒä»»åŠ¡çš„å…³é”®ã€‚æ¯”å¦‚åŒæ ·æ˜¯â€œç”µå½±å‰§æƒ…ç²¾å½©ï¼Œæ¼”å‘˜æ¼”æŠ€åœ¨çº¿â€è¿™å¥è¯ï¼šåšæƒ…æ„Ÿåˆ†ç±»æ—¶ï¼Œè¾“å‡ºé—¨ä¼šå–â€œç²¾å½©â€â€œåœ¨çº¿â€è¿™äº›æƒ…æ„Ÿè¯è®°å¿†ï¼›åšå‘½åå®ä½“è¯†åˆ«æ—¶ï¼Œä¼šå–â€œç”µå½±â€â€œæ¼”å‘˜â€è¿™äº›åè¯è®°å¿†ï¼›åšå¥å­è¡¥å…¨æ—¶ï¼Œä¼šå–â€œå‰§æƒ…â€â€œæ¼”æŠ€â€è¿™äº›æ ¸å¿ƒåè¯çš„å…³è”è®°å¿†ã€‚è€Œæ™®é€šRNNçš„è¾“å‡ºæ˜¯â€œä¸€åˆ€åˆ‡â€ï¼Œä¸ç®¡ä»€ä¹ˆä»»åŠ¡éƒ½æŠŠæ‰€æœ‰è®°å¿†ä¸€è‚¡è„‘è¾“å‡ºï¼Œæœ‰ç”¨ä¿¡æ¯è¢«å†—ä½™ä¿¡æ¯æ·¹æ²¡ï¼Œæ•ˆæœè‡ªç„¶æ‹‰èƒ¯ã€‚</p>
<h3 data-id="heading-8">2.3 GRUï¼šLSTMçš„â€œç²¾ç®€ç‰ˆå¹³æ›¿â€â€”â€”å°‘å¹²æ´»è¿˜é«˜æ•ˆ</h3>
<p>æœ‰äº†LSTMè¿™ä¸ªâ€œå…¨èƒ½ç®¡å®¶å›¢é˜Ÿâ€ï¼Œä¸ºå•¥è¿˜è¦GRUï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼šçœé’±ï¼ˆçœç®—åŠ›ï¼‰ï¼GRUæ˜¯LSTMçš„â€œç²¾ç®€ä¼˜åŒ–ç‰ˆâ€ï¼ŒæŠŠä¸‰å¤§é—¨ç æˆä¿©ï¼Œè¿˜æ‹†äº†â€œä¿é™©ç®±â€ï¼ˆç‹¬ç«‹ç»†èƒçŠ¶æ€ï¼‰ï¼Œè®©â€œçŸ­æœŸåŒ…è£¹â€ï¼ˆéšè—çŠ¶æ€ï¼‰èº«å…¼æ•°èŒâ€”â€”æ—¢èƒ½å­˜é•¿æœŸè®°å¿†ï¼Œåˆèƒ½å½“çŸ­æœŸè¾“å‡ºï¼Œæ€§ä»·æ¯”æ‹‰æ»¡ï¼å°±åƒæŠŠâ€œåˆ†æ‹£ã€ç™»è®°ã€å‘è´§â€ä¸‰ä¸ªç®¡å®¶åˆå¹¶æˆâ€œé‡‡è´­+ä»“ç®¡â€ä¸¤ä¸ªï¼Œæ•ˆç‡æ²¡é™å¤šå°‘ï¼Œæˆæœ¬å´çœäº†ä¸€åŠã€‚</p>
<p><strong>GRUæ ¸å¿ƒæ”¹è¿›ï¼š2ä¸ªé—¨+1ä¸ªéšè—çŠ¶æ€</strong>ï¼š</p>
<ol>
<li>
<p>é‡ç½®é—¨ï¼ˆReset Gateï¼‰ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>r</mi></msub><mo separator="true">â‹…</mo><mo stretchy="false">[</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>+</mo><msub><mi>b</mi><mi>r</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r_t = Ïƒ(W_rÂ·[h_{t-1}, x_t] + b_r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>â€”â€”ç›¸å½“äºâ€œç­›é€‰æ—§è®°å¿†çš„å°åŠ©æ‰‹â€ï¼Œå†³å®šè¦ä¸è¦ç”¨ä¹‹å‰çš„è®°å¿†ã€‚<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ¥è¿‘0ï¼Œå°±â€œå±è”½æ—§è®°å¿†â€ï¼Œä¸“æ³¨å½“å‰è¾“å…¥ï¼›æ¥è¿‘1ï¼Œå°±â€œå¯ç”¨æ—§è®°å¿†â€ï¼Œèåˆæ–°æ—§ä¿¡æ¯ã€‚</p>
</li>
<li>
<p>æ›´æ–°é—¨ï¼ˆUpdate Gateï¼‰ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msub><mi>W</mi><mi>z</mi></msub><mo separator="true">â‹…</mo><mo stretchy="false">[</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>+</mo><msub><mi>b</mi><mi>z</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">z_t = Ïƒ(W_zÂ·[h_{t-1}, x_t] + b_z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>â€”â€”è¿™æ˜¯GRUçš„â€œæ ¸å¿ƒå¤§ç®¡å®¶â€ï¼ŒåŒæ—¶å¹²LSTMé—å¿˜é—¨+è¾“å…¥é—¨çš„æ´»ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ¥è¿‘0ï¼Œå°±â€œä¿ç•™æ—§è®°å¿†â€ï¼ˆå¯¹åº”é—å¿˜é—¨å¼€ï¼‰ï¼›æ¥è¿‘1ï¼Œå°±â€œæ›´æ–°æ–°è®°å¿†â€ï¼ˆå¯¹åº”è¾“å…¥é—¨å¼€ï¼‰ã€‚</p>
</li>
<li>
<p>éšè—çŠ¶æ€æ›´æ–°ï¼ˆèº«å…¼æ•°èŒï¼‰ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>A</mi><mo>~</mo></mover><mi>t</mi></msub><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><mi>W</mi><mo separator="true">â‹…</mo><mo stretchy="false">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo separator="true">â‹…</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">]</mo><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\tilde A_t = tanh(WÂ·[r_tÂ·h_{t-1}, x_t] + b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">t</span><span class="mord mathnormal">anh</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span>ï¼›<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>z</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo separator="true">â‹…</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>z</mi><mi>t</mi></msub><mo separator="true">â‹…</mo><msub><mover accent="true"><mi>A</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t = (1 - z_t)Â·h_{t-1} + z_tÂ·\tilde A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span></p>
</li>
</ol>
<p>è§£è¯»ï¼ˆäººè¯ç‰ˆï¼‰ï¼š</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼šé‡ç½®é—¨<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>å…ˆâ€œç­›æ—§è®°å¿†â€â€”â€”æ¯”å¦‚å¤„ç†â€œä½†â€è¿™ä¸ªè½¬æŠ˜è¯æ—¶ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ä¼šè¾“å‡ºä½æ¦‚ç‡ï¼Œå±è”½å‰é¢â€œç‰¹æ•ˆå·®â€çš„è®°å¿†ï¼Œä¸“æ³¨åé¢â€œå‰§æƒ…ç²¾å½©â€ï¼›</li>
<li>ç¬¬äºŒæ­¥ï¼šæ›´æ–°é—¨<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>â€œå®šç­–ç•¥â€â€”â€”å¦‚æœæ˜¯æ–°æ ¸å¿ƒä¿¡æ¯ï¼ˆæ¯”å¦‚â€œç²¾å½©â€ï¼‰ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>è¾“å‡ºé«˜æ¦‚ç‡ï¼Œç”¨æ–°è®°å¿†<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>A</mi><mo>~</mo></mover><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\tilde A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0702em;vertical-align:-0.15em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal">A</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1111em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>è¦†ç›–æ—§è®°å¿†ï¼›å¦‚æœæ˜¯æ— å…³ä¿¡æ¯ï¼ˆæ¯”å¦‚â€œçš„â€ï¼‰ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>è¾“å‡ºä½æ¦‚ç‡ï¼Œä¿ç•™æ—§è®°å¿†ï¼›</li>
<li>ç¬¬ä¸‰æ­¥ï¼šç›´æ¥æ›´æ–°éšè—çŠ¶æ€<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>â€”â€”æ²¡æœ‰ç‹¬ç«‹ç»†èƒçŠ¶æ€ï¼Œç›´æ¥æŠŠâ€œç­›é€‰åçš„æ—§è®°å¿†+æ–°è®°å¿†â€åˆå¹¶ï¼Œæ—¢æ˜¯é•¿æœŸè®°å¿†ï¼Œåˆæ˜¯çŸ­æœŸè¾“å‡ºï¼Œä¸€æ­¥åˆ°ä½ã€‚</li>
</ul>
<p><strong>LSTM vs GRU æ ¸å¿ƒåŒºåˆ«</strong> ï¼š</p>






























<table><thead><tr><th>å¯¹æ¯”ç»´åº¦</th><th>LSTM</th><th>GRU</th></tr></thead><tbody><tr><td>é—¨æ§æ•°é‡</td><td>3ä¸ªï¼ˆé—å¿˜+è¾“å…¥+è¾“å‡ºï¼‰â€”â€”â€œè±ªåä¸‰äººç»„â€</td><td>2ä¸ªï¼ˆé‡ç½®+æ›´æ–°ï¼‰â€”â€”â€œç²¾ç®€åŒäººç»„â€</td></tr><tr><td>è®°å¿†å­˜å‚¨</td><td>ç‹¬ç«‹ç»†èƒçŠ¶æ€+éšè—çŠ¶æ€â€”â€”â€œä¿é™©ç®±+å¿«é€’ç›’â€</td><td>ä»…éšè—çŠ¶æ€â€”â€”â€œå¿«é€’ç›’èº«å…¼ä¿é™©ç®±â€</td></tr><tr><td>å‚æ•°è§„æ¨¡</td><td>å¤§â€”â€”è´¹ç®—åŠ›ä½†ç¨³ï¼ˆâ€œæ——èˆ°æœºâ€ï¼‰</td><td>å°â€”â€”çœç®—åŠ›æ•ˆç‡é«˜ï¼ˆâ€œæ€§ä»·æ¯”æœºå‹â€ï¼‰</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>è¶…é•¿é•¿åºåˆ—ï¼ˆ&gt;100ä¸ªè¯ï¼‰ã€å¤æ‚è¯­ä¹‰ï¼ˆæ¯”å¦‚å°è¯´ï¼‰</td><td>ä¸­ç­‰é•¿åº¦åºåˆ—ã€ç®—åŠ›æœ‰é™ã€å¿«é€Ÿè¿­ä»£ï¼ˆæ¯”å¦‚è¯„è®ºåˆ†ç±»ï¼‰</td></tr></tbody></table>
<p>æœ€åç”¨ä¸€å¥è¯æ€»ç»“LSTMä¸GRUçš„æ ¸å¿ƒé€»è¾‘ï¼šLSTMæ˜¯â€œç²¾ç»†åŒ–ç®¡ç†â€ï¼Œç”¨ç‹¬ç«‹é€šé“å’Œå¤šé—¨æ§ç¡®ä¿è®°å¿†ç²¾å‡†ï¼›GRUæ˜¯â€œé«˜æ•ˆåŒ–è¿è¥â€ï¼Œç”¨åˆå¹¶é—¨æ§å’Œå•é€šé“èŠ‚çœç®—åŠ›ã€‚ä¸¤è€…éƒ½èƒ½ç¼“è§£æ¢¯åº¦æ¶ˆå¤±ï¼Œä½†GRUçš„æ¢¯åº¦ä¼ æ’­æ›´ç®€æ´ï¼ˆå°‘ä¸€å±‚ç»†èƒçŠ¶æ€çš„è®¡ç®—ï¼‰ï¼Œè®­ç»ƒé€Ÿåº¦æ¯”LSTMå¿«20%~30%ï¼Œåœ¨ä¸­ç­‰é•¿åº¦åºåˆ—ä»»åŠ¡ä¸­ï¼Œæ•ˆæœå‡ ä¹å’ŒLSTMæŒå¹³â€”â€”è¿™ä¹Ÿæ˜¯ä¸ºå•¥å¾ˆå¤šå·¥ä¸šåœºæ™¯ï¼ˆæ¯”å¦‚çŸ­è§†é¢‘è¯„è®ºåˆ†ç±»ï¼‰æ›´çˆ±ç”¨GRUï¼Œæ€§ä»·æ¯”å®åœ¨å¤ªé«˜ï¼</p>
<h2 data-id="heading-9">3. ä»£ç å®æˆ˜ï¼šæ™®é€šRNN vs LSTMï¼Œé•¿åºåˆ—åˆ†ç±»å¯¹å†³</h2>
<p>ç”¨â€œé•¿æ–‡æœ¬æƒ…æ„Ÿåˆ†ç±»ä»»åŠ¡â€ï¼ˆåºåˆ—é•¿åº¦ä»3æ‹‰é•¿åˆ°20ï¼‰ï¼Œæä¸€åœºâ€œRNNä¸‰å›½æ€â€â€”â€”æ™®é€šRNNã€LSTMã€GRUåŒå°ç«æŠ€ï¼Œçœ‹è°èƒ½æå®šé•¿åºåˆ—ï¼æ•°æ®ç”¨æ¨¡æ‹Ÿçš„ç”µå½±é•¿è¯„è®ºï¼ˆæ­£é¢/è´Ÿé¢ï¼‰ï¼Œä»£ç å®Œå…¨è¡”æ¥ä¸ŠæœŸçš„åµŒå…¥å±‚ç»“æ„ï¼Œè¿˜æ–°å¢GRUæ¨¡å‹ä»£ç ï¼Œæ¯ä¸€æ­¥éƒ½å¸¦â€œè¸©å‘æé†’â€ï¼Œæ–°æ‰‹ä¹Ÿèƒ½è·Ÿç€è·‘ï¼</p>
<p>è¡¥å……è¯´æ˜ï¼šä¸ºå•¥é€‰â€œç”µå½±è¯„è®ºåˆ†ç±»â€ï¼Ÿå› ä¸ºè¯„è®ºé‡Œå…¨æ˜¯â€œè½¬æŠ˜ã€é€’è¿›â€ï¼ˆæ¯”å¦‚â€œè™½ç„¶ç‰¹æ•ˆå·®ï¼Œä½†å‰§æƒ…å¥½â€ï¼‰ï¼Œç‰¹åˆ«è€ƒéªŒæ¨¡å‹çš„â€œè®°å¿†å…³è”èƒ½åŠ›â€â€”â€”æ™®é€šRNNå¤§æ¦‚ç‡ä¼šè¢«â€œè½¬æŠ˜â€ç»•æ™•ï¼ŒæŠŠè´Ÿé¢è¯„è®ºåˆ¤æˆæ­£é¢ï¼›è€ŒLSTMå’ŒGRUèƒ½ç²¾å‡†æ•æ‰è¿™ç§ä¾èµ–ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬è¦éªŒè¯çš„æ ¸å¿ƒï¼</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> torch
<span class="hljs-keyword">import</span> torch.nn <span class="hljs-keyword">as</span> nn
<span class="hljs-keyword">import</span> torch.optim <span class="hljs-keyword">as</span> optim
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">from</span> torch.utils.data <span class="hljs-keyword">import</span> DataLoader, TensorDataset
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt


<span class="hljs-comment"># ========== 1. å›ºå®šç§å­ ==========</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">set_seed</span>(<span class="hljs-params">seed=<span class="hljs-number">42</span></span>):
    random.seed(seed)
    np.random.seed(seed)
    torch.manual_seed(seed)
    torch.cuda.manual_seed(seed)

set_seed(<span class="hljs-number">42</span>)

device = torch.device(<span class="hljs-string">"cuda:0"</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">"cpu"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">f"Using Device: <span class="hljs-subst">{device}</span>"</span>)

<span class="hljs-comment"># æ ¸å¿ƒé…ç½®ï¼šæç®€æ¨¡å‹+è¶³å¤Ÿæ ·æœ¬</span>
vocab = {
    <span class="hljs-string">"æˆ‘"</span>: <span class="hljs-number">0</span>, <span class="hljs-string">"è§‰å¾—"</span>: <span class="hljs-number">1</span>, <span class="hljs-string">"è¿™éƒ¨"</span>: <span class="hljs-number">2</span>, <span class="hljs-string">"ç”µå½±"</span>: <span class="hljs-number">3</span>, <span class="hljs-string">"å‰§æƒ…"</span>: <span class="hljs-number">4</span>, <span class="hljs-string">"å¾ˆ"</span>: <span class="hljs-number">5</span>, <span class="hljs-string">"ç²¾å½©"</span>: <span class="hljs-number">6</span>, <span class="hljs-string">"æ¼”å‘˜"</span>: <span class="hljs-number">7</span>, <span class="hljs-string">"æ¼”æŠ€"</span>: <span class="hljs-number">8</span>, <span class="hljs-string">"åœ¨çº¿"</span>: <span class="hljs-number">9</span>,
    <span class="hljs-string">"æ¨è"</span>: <span class="hljs-number">10</span>, <span class="hljs-string">"å¤§å®¶"</span>: <span class="hljs-number">11</span>, <span class="hljs-string">"å»"</span>: <span class="hljs-number">12</span>, <span class="hljs-string">"çœ‹"</span>: <span class="hljs-number">13</span>, <span class="hljs-string">"éå¸¸"</span>: <span class="hljs-number">14</span>, <span class="hljs-string">"å¥½çœ‹"</span>: <span class="hljs-number">15</span>, <span class="hljs-string">"ä½†æ˜¯"</span>: <span class="hljs-number">16</span>, <span class="hljs-string">"ç‰¹æ•ˆ"</span>: <span class="hljs-number">17</span>, <span class="hljs-string">"å·®"</span>: <span class="hljs-number">18</span>,
    <span class="hljs-string">"æ— èŠ"</span>: <span class="hljs-number">19</span>, <span class="hljs-string">"ä¸"</span>: <span class="hljs-number">20</span>, <span class="hljs-string">"å€¼å¾—"</span>: <span class="hljs-number">21</span>, <span class="hljs-string">"æµªè´¹"</span>: <span class="hljs-number">22</span>, <span class="hljs-string">"æ—¶é—´"</span>: <span class="hljs-number">23</span>, <span class="hljs-string">"éŸ³ä¹"</span>: <span class="hljs-number">24</span>, <span class="hljs-string">"å¥½å¬"</span>: <span class="hljs-number">25</span>, <span class="hljs-string">"ç”»é¢"</span>: <span class="hljs-number">26</span>, <span class="hljs-string">"ç²¾ç¾"</span>: <span class="hljs-number">27</span>,
    <span class="hljs-string">"æ‹–æ²“"</span>: <span class="hljs-number">28</span>, <span class="hljs-string">"èŠ‚å¥"</span>: <span class="hljs-number">29</span>, <span class="hljs-string">"æ…¢"</span>: <span class="hljs-number">30</span>, <span class="hljs-string">"å¤±æœ›"</span>: <span class="hljs-number">31</span>, <span class="hljs-string">"æ»¡æ„"</span>: <span class="hljs-number">32</span>, <span class="hljs-string">"å¼€å¿ƒ"</span>: <span class="hljs-number">33</span>, <span class="hljs-string">"åæ‚”"</span>: <span class="hljs-number">34</span>
}
PAD_IDX = <span class="hljs-number">35</span>
vocab_size = <span class="hljs-number">36</span>
embedding_dim = <span class="hljs-number">32</span>  <span class="hljs-comment"># é™ä½ç»´åº¦ï¼Œé€‚é…å°æ ·æœ¬</span>
hidden_dim = <span class="hljs-number">32</span>  <span class="hljs-comment"># æç®€æ¨¡å‹ï¼Œé¿å…è¿‡æ‹Ÿåˆ</span>
seq_len = <span class="hljs-number">12</span>
num_classes = <span class="hljs-number">2</span>
batch_size = <span class="hljs-number">4</span>
epochs = <span class="hljs-number">50</span>  <span class="hljs-comment"># è¶³å¤Ÿè½®æ¬¡ï¼Œè®©æ¨¡å‹å­¦é€</span>
lr = <span class="hljs-number">1e-3</span>  <span class="hljs-comment"># å¤§å­¦ä¹ ç‡ï¼Œå¿«é€Ÿæ”¶æ•›</span>

<span class="hljs-comment"># ========== 2. æ‰©å……æ ·æœ¬+ç®€å•åˆ†è¯ï¼ˆæ ¸å¿ƒï¼šæ ·æœ¬å¤Ÿå¤šï¼Œæ¨¡å‹æ‰æœ‰çš„å­¦ï¼‰ ==========</span>
<span class="hljs-comment"># æ­£è´Ÿå„20ï¼Œå‡å°‘éšæœºæ€§</span>
positive_texts = [
    <span class="hljs-string">"æˆ‘è§‰å¾—è¿™éƒ¨ç”µå½±å‰§æƒ…å¾ˆç²¾å½©"</span>, <span class="hljs-string">"æ¼”å‘˜æ¼”æŠ€åœ¨çº¿éå¸¸æ¨èå¤§å®¶"</span>, <span class="hljs-string">"ç”µå½±ç”»é¢ç²¾ç¾éŸ³ä¹å¥½å¬"</span>,
    <span class="hljs-string">"å‰§æƒ…ç´§å‡‘æˆ‘å¾ˆæ»¡æ„å¼€å¿ƒ"</span>, <span class="hljs-string">"æ¼”å‘˜æ¼”æŠ€å¥½å‰§æƒ…ä¸æ‹–æ²“"</span>, <span class="hljs-string">"èŠ‚å¥å¿«ç‰¹æ•ˆä¹Ÿä¸é”™"</span>, <span class="hljs-string">"å€¼å¾—å»ç”µå½±é™¢çœ‹"</span>,
    <span class="hljs-string">"è¿™éƒ¨ç”µå½±å¤ªå¥½çœ‹äº†"</span>, <span class="hljs-string">"æ¯ä¸€ä¸ªé•œå¤´éƒ½å¾ˆç”¨å¿ƒ"</span>, <span class="hljs-string">"æ¨èå¤§å®¶çœ‹è¿™éƒ¨ç”µå½±"</span>, <span class="hljs-string">"ç”»é¢ç²¾ç¾éå¸¸æ»¡æ„"</span>,
    <span class="hljs-string">"è™½ç„¶ç‰¹æ•ˆä¸€èˆ¬ä½†æ˜¯å‰§æƒ…ç²¾å½©"</span>, <span class="hljs-string">"æ¼”å‘˜æ¼”æŠ€å¥½å€¼å¾—åå¤è§‚çœ‹"</span>, <span class="hljs-string">"ç”µå½±å‰§æƒ…ç²¾å½©èŠ‚å¥å¥½"</span>, <span class="hljs-string">"éå¸¸æ¨èå¤§å®¶"</span>,
    <span class="hljs-string">"å‰§æƒ…ä¸æ‹–æ²“æ¼”å‘˜æ¼”æŠ€å¥½"</span>, <span class="hljs-string">"æˆ‘å¾ˆå–œæ¬¢è¿™éƒ¨ç”µå½±"</span>, <span class="hljs-string">"ç”»é¢ç²¾ç¾éŸ³ä¹å¥½å¬"</span>, <span class="hljs-string">"ç‰¹æ•ˆæ™®é€šä½†å‰§æƒ…ç²¾å½©"</span>, <span class="hljs-string">"æ¼”æŠ€å¥½éå¸¸æ¨è"</span>
]
negative_texts = [
    <span class="hljs-string">"æˆ‘è§‰å¾—è¿™éƒ¨ç”µå½±å¾ˆæ— èŠ"</span>, <span class="hljs-string">"å‰§æƒ…æ‹–æ²“èŠ‚å¥æ…¢ä¸å€¼å¾—çœ‹"</span>, <span class="hljs-string">"ç”µå½±ç‰¹æ•ˆå·®å‰§æƒ…æ— èŠ"</span>,
    <span class="hljs-string">"æ¼”å‘˜æ¼”æŠ€çƒ‚æˆ‘å¾ˆå¤±æœ›"</span>, <span class="hljs-string">"è¿™éƒ¨ç”µå½±å¤ªéš¾çœ‹äº†"</span>, <span class="hljs-string">"èŠ‚å¥æ…¢æ¼”å‘˜æ¼”æŠ€å·®"</span>, <span class="hljs-string">"ä¸æ¨èè¿™éƒ¨ç”µå½±"</span>,
    <span class="hljs-string">"è™½ç„¶ç”»é¢ç²¾ç¾ä½†æ˜¯å‰§æƒ…æ— èŠ"</span>, <span class="hljs-string">"ç‰¹æ•ˆå·®æµªè´¹æ—¶é—´"</span>, <span class="hljs-string">"ç”µå½±å‰§æƒ…æ‹–æ²“èŠ‚å¥æ…¢"</span>, <span class="hljs-string">"ç”»é¢ä¹Ÿä¸å¥½çœ‹å¾ˆå¤±æœ›"</span>,
    <span class="hljs-string">"è¿™éƒ¨ç”µå½±å¾ˆæ— èŠå‰§æƒ…çƒ‚"</span>, <span class="hljs-string">"æ¼”å‘˜æ¼”æŠ€å·®ä¸å€¼å¾—èŠ±æ—¶é—´"</span>, <span class="hljs-string">"æˆ‘è§‰å¾—è¿™éƒ¨ç”µå½±å¾ˆå·®"</span>, <span class="hljs-string">"ç‰¹æ•ˆå·®æ¼”å‘˜æ¼”æŠ€ä¹Ÿä¸å¥½"</span>,
    <span class="hljs-string">"å‰§æƒ…æ‹–æ²“èŠ‚å¥æ…¢æ¼”å‘˜æ¼”æŠ€å·®"</span>, <span class="hljs-string">"å‰§æƒ…æ— èŠæ¼”å‘˜æ¼”æŠ€å·®"</span>, <span class="hljs-string">"åæ‚”å»ç”µå½±é™¢çœ‹"</span>, <span class="hljs-string">"ä¸æ¨èæµªè´¹æ—¶é—´"</span>, <span class="hljs-string">"å‰§æƒ…æ— èŠç‰¹æ•ˆå·®"</span>
]


<span class="hljs-comment"># ç®€å•åˆ†è¯ï¼šæŒ‰è¯è¡¨åŒ¹é…ï¼Œä¸æå¤æ‚é€»è¾‘</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize</span>(<span class="hljs-params">text, vocab</span>):
    tokens = []
    i = <span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(text):
        <span class="hljs-keyword">if</span> i + <span class="hljs-number">2</span> &lt;= <span class="hljs-built_in">len</span>(text) <span class="hljs-keyword">and</span> text[i:i + <span class="hljs-number">2</span>] <span class="hljs-keyword">in</span> vocab:
            tokens.append(text[i:i + <span class="hljs-number">2</span>])
            i += <span class="hljs-number">2</span>
        <span class="hljs-keyword">else</span>:
            tokens.append(text[i])
            i += <span class="hljs-number">1</span>
    <span class="hljs-keyword">return</span> [vocab.get(t, <span class="hljs-number">0</span>) <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> tokens]


<span class="hljs-comment"># ç”Ÿæˆåºåˆ—ï¼šå¡«å……/æˆªæ–­</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_seq</span>(<span class="hljs-params">texts, vocab, seq_len, pad_idx</span>):
    seqs = []
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> texts:
        idx = tokenize(t, vocab)
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(idx) &lt; seq_len:
            idx += [pad_idx] * (seq_len - <span class="hljs-built_in">len</span>(idx))
        <span class="hljs-keyword">else</span>:
            idx = idx[:seq_len]
        seqs.append(idx)
    <span class="hljs-keyword">return</span> seqs


<span class="hljs-comment"># ç”Ÿæˆæ•°æ®ï¼š40æ ·æœ¬ï¼Œ30è®­ç»ƒ+10æµ‹è¯•</span>
all_seq = gen_seq(positive_texts + negative_texts, vocab, seq_len, PAD_IDX)
all_label = [<span class="hljs-number">1</span>] * <span class="hljs-number">20</span> + [<span class="hljs-number">0</span>] * <span class="hljs-number">20</span>
all_seq = torch.tensor(all_seq, dtype=torch.long).to(device)
all_label = torch.tensor(all_label, dtype=torch.long).to(device)

<span class="hljs-comment"># éšæœºæ‹†åˆ†ï¼š30è®­ç»ƒ+10æµ‹è¯•ï¼ˆå›ºå®šç§å­ï¼Œç»“æœå¯å¤ç°ï¼‰</span>
idx = torch.randperm(<span class="hljs-number">40</span>)
train_seq, train_label = all_seq[idx[:<span class="hljs-number">30</span>]], all_label[idx[:<span class="hljs-number">30</span>]]
test_seq, test_label = all_seq[idx[<span class="hljs-number">30</span>:]], all_label[idx[<span class="hljs-number">30</span>:]]

train_loader = DataLoader(TensorDataset(train_seq, train_label), batch_size=batch_size, shuffle=<span class="hljs-literal">True</span>)
test_loader = DataLoader(TensorDataset(test_seq, test_label), batch_size=batch_size, shuffle=<span class="hljs-literal">False</span>)


<span class="hljs-comment"># ========== 3. æç®€æ¨¡å‹ï¼ˆå•å±‚ï¼Œæ— æ­£åˆ™åŒ–ï¼Œå°æ ·æœ¬å‹å¥½ï¼‰ ==========</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleRNN</span>(nn.Module):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">super</span>().__init__()
        self.emb = nn.Embedding(vocab_size, embedding_dim, padding_idx=PAD_IDX)
        self.rnn = nn.RNN(embedding_dim, hidden_dim, <span class="hljs-number">1</span>, batch_first=<span class="hljs-literal">True</span>)
        self.fc = nn.Linear(hidden_dim, num_classes)
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        x = self.emb(x)
        _, h = self.rnn(x)
        <span class="hljs-keyword">return</span> self.fc(h.squeeze(<span class="hljs-number">0</span>))

<span class="hljs-keyword">class</span> <span class="hljs-title class_">LSTMModel</span>(nn.Module):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">super</span>().__init__()
        self.emb = nn.Embedding(vocab_size, embedding_dim, padding_idx=PAD_IDX)
        self.lstm = nn.LSTM(embedding_dim, hidden_dim, <span class="hljs-number">1</span>, batch_first=<span class="hljs-literal">True</span>)
        self.fc = nn.Linear(hidden_dim, num_classes)
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        x = self.emb(x)
        _, (h, _) = self.lstm(x)
        <span class="hljs-keyword">return</span> self.fc(h.squeeze(<span class="hljs-number">0</span>))

<span class="hljs-keyword">class</span> <span class="hljs-title class_">GRUModel</span>(nn.Module):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):
        <span class="hljs-built_in">super</span>().__init__()
        self.emb = nn.Embedding(vocab_size, embedding_dim, padding_idx=PAD_IDX)
        self.gru = nn.GRU(embedding_dim, hidden_dim, <span class="hljs-number">1</span>, batch_first=<span class="hljs-literal">True</span>)
        self.fc = nn.Linear(hidden_dim, num_classes)
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):
        x = self.emb(x)
        _, h = self.gru(x)
        <span class="hljs-keyword">return</span> self.fc(h.squeeze(<span class="hljs-number">0</span>))


<span class="hljs-comment"># ========== 4. æç®€è®­ç»ƒï¼ˆæ— æ—©åœï¼Œæ— è°ƒåº¦ï¼Œçœ‹çœŸå®æ•ˆæœï¼‰ ==========</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">train</span>(<span class="hljs-params">model, name</span>):
    criterion = nn.CrossEntropyLoss()
    optimizer = optim.Adam(model.parameters(), lr=lr)
    train_accs, test_accs = [], []

    <span class="hljs-keyword">for</span> epoch <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(epochs):
        model.train()
        correct = <span class="hljs-number">0</span>
        <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> train_loader:
            out = model(x)
            loss = criterion(out, y)
            optimizer.zero_grad()
            loss.backward()
            optimizer.step()
            correct += (out.argmax(<span class="hljs-number">1</span>) == y).<span class="hljs-built_in">sum</span>().item()
        train_acc = <span class="hljs-number">100</span> * correct / <span class="hljs-built_in">len</span>(train_seq)

        <span class="hljs-comment"># æµ‹è¯•</span>
        model.<span class="hljs-built_in">eval</span>()
        correct = <span class="hljs-number">0</span>
        <span class="hljs-keyword">with</span> torch.no_grad():
            <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> test_loader:
                out = model(x)
                correct += (out.argmax(<span class="hljs-number">1</span>) == y).<span class="hljs-built_in">sum</span>().item()
        test_acc = <span class="hljs-number">100</span> * correct / <span class="hljs-built_in">len</span>(test_seq)

        train_accs.append(train_acc)
        test_accs.append(test_acc)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\n<span class="hljs-subst">{name}</span> æœ€ç»ˆæµ‹è¯•å‡†ç¡®ç‡: <span class="hljs-subst">{test_accs[-<span class="hljs-number">1</span>]:<span class="hljs-number">.2</span>f}</span>%"</span>)
    <span class="hljs-keyword">return</span> train_accs, test_accs


<span class="hljs-comment"># ========== 5. è®­ç»ƒä¸‰ä¸ªæ¨¡å‹ ==========</span>
rnn = SimpleRNN().to(device)
lstm = LSTMModel().to(device)
gru = GRUModel().to(device)

<span class="hljs-built_in">print</span>(<span class="hljs-string">"===== Training Simple RNN ====="</span>)
rnn_train, rnn_test = train(rnn, <span class="hljs-string">"Simple RNN"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n===== Training LSTM ====="</span>)
lstm_train, lstm_test = train(lstm, <span class="hljs-string">"LSTM"</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"\n===== Training GRU ====="</span>)
gru_train, gru_test = train(gru, <span class="hljs-string">"GRU"</span>)
</code></pre>
<h2 data-id="heading-10">4. å…³é”®è§£è¯»ï¼šå¯è§†åŒ–åˆ†æ+å®æˆ˜é¿å‘æŒ‡å—</h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fddb268d0d084b77adba1b36d10f3eb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5p-g5p-g6YWx:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769500463&amp;x-signature=pjiVJNF9Kqk2kaepXSUjUkiNw4o%3D" alt="RNN_LSTM_GRU_result.png" loading="lazy"/></p>
<p>å¯è§ï¼Œæ™®é€šRNNæ˜¯é‡‘é±¼è®°å¿†â€”â€”è®­ç»ƒé›†éƒ½å­¦ä¸é€ï¼ˆ82%-88%ï¼‰ï¼Œæµ‹è¯•é›†ç›´æ¥æ‘†çƒ‚ï¼ˆ68%-72%ï¼‰ï¼›LSTMæ˜¯ç»†å¿ƒç®¡å®¶ï¼Œé—¨æ§æœºåˆ¶æŠŠé•¿å¥å­çš„å‰å› åæœè®°å¾—æ˜æ˜ç™½ç™½ï¼Œæµ‹è¯•é›†ç¨³å¾—ä¸€æ‰¹ï¼ˆ85%-88%ï¼‰ï¼›GRUå°±æ˜¯æ€§ä»·æ¯”ä¹‹ç‹ï¼Œç²¾ç®€ç»“æ„è¿˜èƒ½æ‰“ï¼Œæ³›åŒ–èƒ½åŠ›æ¥è¿‘LSTMï¼ˆ83%-86%ï¼‰ï¼Œå ªç§°â€œç”¨æœ€å°‘çš„å‚æ•°åŠæœ€å¤šçš„äº‹â€çš„æ‰“å·¥äººæ¥·æ¨¡ï¼ä¸€å¥è¯æ€»ç»“ï¼šé—¨æ§æœºåˆ¶æ‰æ˜¯é•¿åºåˆ—å»ºæ¨¡çš„ç¥ï¼</p>
<h3 data-id="heading-11">å®æˆ˜é¿å‘æŒ‡å—ï¼ˆè§„é¿å¸¸è§é—®é¢˜ï¼‰</h3>
<p>åŸºäºä»£ç å®æˆ˜ï¼Œæ‹†è§£5ä¸ªé«˜é¢‘å‘ï¼Œé¿å…ä½ åç»­å¤ç°æˆ–ä¼˜åŒ–æ—¶è¸©é›·ï¼š</p>
<ul>
<li><strong>å‘1ï¼šå¡«å……ç¬¦æœªæŒ‡å®š</strong>ï¼šè‹¥çœç•¥ä»£ç ä¸­<code>padding_idx=35</code>ï¼Œæ¨¡å‹ä¼šå­¦ä¹ å¡«å……ç¬¦è¯­ä¹‰ï¼Œå›¾è¡¨ä¼šå‘ˆç°â€œä¸‰æ¨¡å‹è®­ç»ƒå‡†ç¡®ç‡é«˜ã€æµ‹è¯•å‡†ç¡®ç‡éª¤é™â€çš„è¿‡æ‹Ÿåˆç‰¹å¾ã€‚é¿å‘æ–¹æ¡ˆï¼šè¡¥å…¨å¡«å……ç¬¦åï¼Œå¿…åœ¨Embeddingå±‚æŒ‡å®šå¯¹åº”ç´¢å¼•ï¼Œå±è”½å¡«å……ç¬¦çš„è¯­ä¹‰å­¦ä¹ ã€‚</li>
<li><strong>å‘2ï¼šè¯¯é€‰LSTM/GRUè¾“å‡º</strong>ï¼šè‹¥è¯¯å–LSTMçš„ç»†èƒçŠ¶æ€ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">c_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰æˆ–GRUçš„æ‰€æœ‰æ—¶åˆ»è¾“å‡ºåšåˆ†ç±»ï¼Œå›¾è¡¨ä¼šå‘ˆç°â€œè®­ç»ƒå‡†ç¡®ç‡é«˜ã€æµ‹è¯•å‡†ç¡®ç‡ä½â€çš„å¼‚å¸¸ã€‚é¿å‘æ–¹æ¡ˆï¼šå¦‚ä»£ç æ‰€ç¤ºï¼Œç»Ÿä¸€å–æœ€åæ—¶åˆ»éšè—çŠ¶æ€ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">h_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼Œè¿™æ˜¯ç»é—¨æ§ç­›é€‰åçš„æœ‰æ•ˆä¿¡æ¯ã€‚</li>
<li><strong>å‘3ï¼šæ··æ·†æ¨¡å‹é€‚ç”¨åœºæ™¯</strong>ï¼šè‹¥ä¸­ç­‰åºåˆ—ä»»åŠ¡å¼ºè¡Œç”¨LSTMï¼Œå›¾è¡¨è™½å‡†ç¡®ç‡ç•¥é«˜ï¼Œä½†è®­ç»ƒè€—æ—¶æ˜¾è‘—å¢åŠ ï¼›è¶…é•¿é•¿åºåˆ—ç”¨GRUï¼Œå›¾è¡¨ä¼šå‘ˆç°å‡†ç¡®ç‡åä½ã€‚é¿å‘æ–¹æ¡ˆï¼šä¸­ç­‰åºåˆ—é€‰GRUï¼ˆçœç®—åŠ›ï¼‰ï¼Œè¶…é•¿é•¿åºåˆ—é€‰LSTMï¼ˆæ›´ç¨³ï¼‰ã€‚</li>
</ul>
<h2 data-id="heading-12">5. é¢è¯•é¿å‘æŒ‡å—ï¼šLSTM/GRUé«˜é¢‘é—®é¢˜</h2>
<h3 data-id="heading-13">Q1ï¼šLSTMå¦‚ä½•ç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Ÿæ ¸å¿ƒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå¿…è€ƒé¢˜ï¼‰</h3>
<p>ç­”ï¼šæ ¸å¿ƒæ˜¯â€œç‹¬ç«‹ç»†èƒçŠ¶æ€+é—¨æ§æœºåˆ¶â€çš„åŒé‡ä¿éšœã€‚â‘  ç‹¬ç«‹ç»†èƒçŠ¶æ€ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">c_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ä½œä¸ºé•¿æœŸè®°å¿†é€šé“ï¼Œä¿¡æ¯é‡‡ç”¨â€œç´¯åŠ å¼æ›´æ–°â€è€Œéâ€œè¦†ç›–å¼æ›´æ–°â€ï¼Œæ¢¯åº¦èƒ½æ²¿é€šé“å¹³ç¨³åå‘ä¼ æ’­ï¼Œé¿å…è¢«å¤šæ¬¡ä¹˜ç§¯ç¨€é‡Šï¼›â‘¡ ä¸‰å¤§é—¨æ§é€šè¿‡sigmoidï¼ˆ0~1æ¦‚ç‡ï¼‰ç­›é€‰ä¿¡æ¯ï¼Œä¸¢å¼ƒæ— ç”¨ä¿¡æ¯å‡å°‘æ¢¯åº¦æŸè€—ï¼Œè®©æœ‰æ•ˆæ¢¯åº¦èƒ½ä¼ é€’åˆ°æ—©æœŸåºåˆ—ã€‚æ™®é€šRNNå› æ— è¿™ä¸¤ä¸ªè®¾è®¡ï¼Œæ¢¯åº¦æ˜“æ¶ˆå¤±ï¼Œé•¿åºåˆ—å»ºæ¨¡å¤±æ•ˆã€‚</p>
<h3 data-id="heading-14">Q2ï¼šLSTMçš„ä¸‰å¤§é—¨åˆ†åˆ«èµ·ä»€ä¹ˆä½œç”¨ï¼Ÿç”¨åœºæ™¯åŒ–è¯­è¨€æè¿°ã€‚</h3>
<p>ç­”ï¼šâ‘  é—å¿˜é—¨ï¼šâ€œåƒåœ¾åˆ†æ‹£å‘˜â€ï¼Œç­›é€‰ç»†èƒçŠ¶æ€ä¸­çš„æ— ç”¨ä¿¡æ¯ï¼ˆå¦‚è¯„è®ºä¸­çš„è¯­æ°”è¯ã€æ ‡ç‚¹ï¼‰å¹¶ä¸¢å¼ƒï¼Œå‡è½»è®°å¿†è´Ÿæ‹…ï¼›â‘¡ è¾“å…¥é—¨ï¼šâ€œå…¥åº“ç™»è®°å‘˜â€ï¼Œç­›é€‰å½“å‰è¾“å…¥çš„æœ‰ç”¨ä¿¡æ¯ï¼ˆå¦‚è¯„è®ºä¸­çš„æ ¸å¿ƒè¯„ä»·è¯ï¼‰ï¼Œæ‰“åŒ…åå†™å…¥ç»†èƒçŠ¶æ€ï¼Œå®ç°æ–°æ—§è®°å¿†èåˆï¼›â‘¢ è¾“å‡ºé—¨ï¼šâ€œæŒ‰éœ€å‘è´§å‘˜â€ï¼Œæ ¹æ®ä»»åŠ¡éœ€æ±‚ï¼ˆå¦‚æƒ…æ„Ÿåˆ†ç±»ã€å¥å­è¡¥å…¨ï¼‰ï¼Œä»ç»†èƒçŠ¶æ€ä¸­æå–å…³è”ä¿¡æ¯ï¼Œè¾“å‡ºä¸ºéšè—çŠ¶æ€ã€‚ä¸‰è€…ååŒå®ç°â€œè¯¥è®°å°±è®°ã€è¯¥å¿˜å°±å¿˜â€ã€‚</p>
<h3 data-id="heading-15">Q3ï¼šLSTMå’ŒGRUçš„åŒºåˆ«åŠé€‚ç”¨åœºæ™¯ï¼Ÿï¼ˆé«˜é¢‘é€‰å‹é¢˜ï¼‰</h3>
<p>ç­”ï¼šGRUæ˜¯LSTMçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œæ ¸å¿ƒåŒºåˆ«æ˜¯â€œé—¨æ§æ•°é‡å’Œè®°å¿†å­˜å‚¨æ–¹å¼â€ï¼šâ‘  ç»“æ„å·®å¼‚ï¼šLSTMæœ‰3ä¸ªé—¨+ç‹¬ç«‹ç»†èƒçŠ¶æ€ï¼ŒGRUæœ‰2ä¸ªé—¨ï¼ˆé‡ç½®é—¨+æ›´æ–°é—¨ï¼‰+å•éšè—çŠ¶æ€ï¼ˆèº«å…¼é•¿çŸ­æœŸè®°å¿†ï¼‰ï¼›â‘¡ å‚æ•°å·®å¼‚ï¼šLSTMå‚æ•°æ›´å¤šï¼ˆç®—åŠ›æ¶ˆè€—å¤§ï¼‰ï¼ŒGRUå‚æ•°å°‘20%~30%ï¼ˆè®­ç»ƒæ›´å¿«ï¼‰ï¼›â‘¢ æ•ˆæœå·®å¼‚ï¼šè¶…é•¿é•¿åºåˆ—ï¼ˆ&gt;100è¯ï¼‰LSTMæ›´ç¨³ï¼Œä¸­ç­‰åºåˆ—ä¸¤è€…æ•ˆæœæ¥è¿‘ã€‚é€‚ç”¨åœºæ™¯ï¼šç®—åŠ›æœ‰é™ã€ä¸­ç­‰åºåˆ—ï¼ˆå¦‚è¯„è®ºåˆ†ç±»ï¼‰é€‰GRUï¼›è¶…é•¿é•¿åºåˆ—ï¼ˆå¦‚å°è¯´åˆ†æï¼‰ã€å»ºæ¨¡ç²¾åº¦è¦æ±‚é«˜é€‰LSTMã€‚</p>
<h3 data-id="heading-16">Q4ï¼šGRUçš„é‡ç½®é—¨å’Œæ›´æ–°é—¨åˆ†åˆ«å¯¹åº”LSTMçš„å“ªäº›åŠŸèƒ½ï¼Ÿ</h3>
<p>ç­”ï¼šâ‘  é‡ç½®é—¨ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼šç±»ä¼¼LSTMçš„â€œå±€éƒ¨ç­›é€‰å™¨â€ï¼Œæ§åˆ¶æ˜¯å¦å¯ç”¨æ—§è®°å¿†ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">r_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ¥è¿‘0æ—¶å±è”½æ—§è®°å¿†ã€ä¸“æ³¨å½“å‰è¾“å…¥ï¼ˆå¦‚å¤„ç†è½¬æŠ˜è¯â€œä½†â€æ—¶ï¼‰ï¼Œå¯¹åº”LSTMé—å¿˜é—¨çš„éƒ¨åˆ†ç­›é€‰åŠŸèƒ½ï¼›â‘¡ æ›´æ–°é—¨ï¼ˆ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>ï¼‰ï¼šåˆå¹¶LSTMé—å¿˜é—¨+è¾“å…¥é—¨çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œ<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">z_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span></span></span></span></span>æ¥è¿‘0æ—¶ä¿ç•™æ—§è®°å¿†ï¼ˆå¯¹åº”é—å¿˜é—¨å¼€ï¼‰ï¼Œæ¥è¿‘1æ—¶æ›´æ–°æ–°è®°å¿†ï¼ˆå¯¹åº”è¾“å…¥é—¨å¼€ï¼‰ã€‚GRUé€šè¿‡è¿™ä¸¤ä¸ªé—¨ç®€åŒ–ç»“æ„ï¼ŒåŒæ—¶ä¿ç•™é—¨æ§æœºåˆ¶çš„æ ¸å¿ƒä»·å€¼ã€‚</p>
<h3 data-id="heading-17">Q5ï¼šEmbeddingå±‚çš„<code>padding_idx</code>å‚æ•°ä½œç”¨ï¼Ÿä¸è®¾ç½®ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3>
<p>ç­”ï¼šä½œç”¨æ˜¯æŒ‡å®šå¡«å……ç¬¦çš„ç´¢å¼•ï¼Œè®©Embeddingå±‚è®­ç»ƒæ—¶å¿½ç•¥å¡«å……ç¬¦çš„æ¢¯åº¦æ›´æ–°ï¼Œå³ä¸ä¼˜åŒ–å¡«å……ç¬¦çš„è¯å‘é‡ã€‚ä¸è®¾ç½®çš„é—®é¢˜ï¼šæ¨¡å‹ä¼šå°†å¡«å……ç¬¦å½“ä½œæ™®é€šè¯å­¦ä¹ è¯­ä¹‰ï¼Œå¯¼è‡´å¡«å……ç¬¦è¯å‘é‡å¹²æ‰°æ­£å¸¸è¯å»ºæ¨¡ï¼Œå¢åŠ æ— æ•ˆç®—åŠ›æ¶ˆè€—ï¼Œæœ€ç»ˆé™ä½æ¨¡å‹æ³›åŒ–èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-18">ğŸ“Œ ä¸‹æœŸé¢„å‘Š</h2>
<p>å’±ä»Šå¤©ç”¨LSTMæå®šäº†é•¿åºåˆ—æƒ…æ„Ÿåˆ†ç±»ï¼Œå½»åº•æ‘†è„±äº†æ™®é€šRNNçš„â€œå¥å¿˜ç—‡â€â€”â€”è¿™åªæ˜¯åºåˆ—å»ºæ¨¡çš„â€œä¸­çº§é˜¶æ®µâ€ï¼ä¸‹ä¸€ç¯‡å°†ç›´æ¥å†²å‡»åºåˆ—å»ºæ¨¡çš„â€œé¡¶æµæŠ€æœ¯â€â€”â€”Transformerçš„æ ¸å¿ƒåŸç†ä¸åŸºç¡€å®ç°ï¼æ‹†è§£Transformerçš„ä¸¤å¤§åŸºçŸ³â€”â€”â€œè‡ªæ³¨æ„åŠ›æœºåˆ¶â€ï¼ˆè®©æ¨¡å‹èƒ½ç²¾å‡†æ•æ‰åºåˆ—ä¸­ä»»æ„ä¸¤ä¸ªè¯çš„å…³è”ï¼Œæ¯”å¦‚é•¿å¥ä¸­â€œå®ƒâ€æŒ‡ä»£å“ªä¸ªåè¯ï¼‰å’Œâ€œä½ç½®ç¼–ç â€ï¼ˆè§£å†³Transformeræ— å¾ªç¯ç»“æ„ã€æ— æ³•æ„ŸçŸ¥åºåˆ—é¡ºåºçš„é—®é¢˜ï¼‰ã€‚æˆ‘ä»¬ä¼šç”¨PyTorchå®ç°ä¸€ä¸ªåŸºç¡€ç‰ˆTransformerï¼Œä¸ºåç»­â€œTransformerä¸“é¢˜ä¸“æ â€ï¼ˆå¤§æ¨¡å‹çš„æ ¸å¿ƒï¼‰é“ºè·¯ï¼æ¬¢è¿å¤§å®¶å…³æ³¨å­¦ä¹ ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€å‘¨æ—¶é—´starç ´åƒçš„å¼€æºé¡¹ç›®æ˜¯æ€æ ·çš„ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7597199288817106984</link>    <guid>https://juejin.cn/post/7597199288817106984</guid>    <pubDate>2026-01-20T08:33:37.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597199288817106984" data-draft-id="7597024900521459764" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€å‘¨æ—¶é—´starç ´åƒçš„å¼€æºé¡¹ç›®æ˜¯æ€æ ·çš„ï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯,åç«¯,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-20T08:33:37.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯å°‘å¹´æ±ª"/> <meta itemprop="url" content="https://juejin.cn/user/3570847174897447"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€å‘¨æ—¶é—´starç ´åƒçš„å¼€æºé¡¹ç›®æ˜¯æ€æ ·çš„ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3570847174897447/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯å°‘å¹´æ±ª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:33:37.000Z" title="Tue Jan 20 2026 08:33:37 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»13åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0"/>
<p>åœ¨å¼€æºçš„ä¸–ç•Œé‡Œï¼Œä¸€ä¸ªé¡¹ç›®èƒ½å¿«é€Ÿæ”¶è·å¼€å‘è€…çš„è®¤å¯ï¼Œä»æ¥éƒ½ä¸æ˜¯å¶ç„¶ã€‚è¿‘æœŸï¼ŒGitHubä¸Šåä¸ºnginxpulseï¼ˆä»“åº“åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flikaia%2Fnginxpulse%25EF%25BC%2589%25E7%259A%2584%25E5%25BC%2580%25E6%25BA%2590%25E9%25A1%25B9%25E7%259B%25AE%25EF%25BC%258C%25E4%25BB%2585%25E7%2594%25A8%25E4%25B8%2580%25E5%2591%25A8%25E6%2597%25B6%25E9%2597%25B4star%25E6%2595%25B0%25E4%25BE%25BF%25E7%25AA%2581%25E7%25A0%25B4%25E5%258D%2583%25E7%25BA%25A7%25EF%25BC%258C%25E6%2588%2590%25E4%25B8%25BA%25E6%259C%258D%25E5%258A%25A1%25E5%2599%25A8%25E8%25BF%2590%25E7%25BB%25B4%25E9%25A2%2586%25E5%259F%259F%25E7%259A%2584%25E4%25B8%2580%25E5%258C%25B9%25E2%2580%259C%25E9%25BB%2591%25E9%25A9%25AC%25E2%2580%259D%25E3%2580%2582%25E4%25B8%258D%25E5%2590%258C%25E4%25BA%258E%25E9%2582%25A3%25E4%25BA%259B%25E9%259D%25A0%25E5%2599%25B1%25E5%25A4%25B4%25E5%258D%259A%25E5%2585%25B3%25E6%25B3%25A8%25E7%259A%2584%25E9%25A1%25B9%25E7%259B%25AE%25EF%25BC%258Cnginxpulse%25E7%259A%2584%25E8%25B5%25B0%25E7%25BA%25A2%25EF%25BC%258C%25E6%25BA%2590%25E4%25BA%258E%25E5%25AE%2583%25E7%25B2%25BE%25E5%2587%2586%25E8%25A7%25A3%25E5%2586%25B3%25E4%25BA%2586Nginx%25E8%25BF%2590%25E7%25BB%25B4%25E9%25A2%2586%25E5%259F%259F%25E7%259A%2584%25E6%25A0%25B8%25E5%25BF%2583%25E7%2597%259B%25E7%2582%25B9%25EF%25BC%258C%25E6%259B%25B4%25E5%2587%25AD%25E5%2580%259F%25E2%2580%259C%25E8%25BD%25BB%25E9%2587%258F%25E3%2580%2581%25E6%2598%2593%25E7%2594%25A8%25E3%2580%2581%25E5%258F%25AF%25E6%2589%25A9%25E5%25B1%2595%25E2%2580%259D%25E7%259A%2584%25E6%258A%2580%25E6%259C%25AF%25E7%2589%25B9%25E6%2580%25A7%25EF%25BC%258C%25E8%25AE%25A9%25E4%25B8%25AD%25E5%25B0%258F%25E5%259B%25A2%25E9%2598%259F%25E3%2580%2581%25E4%25B8%25AA%25E4%25BA%25BA%25E5%25BC%2580%25E5%258F%2591%25E8%2580%2585%25E9%2583%25BD%25E8%2583%25BD%25E4%25BD%258E%25E6%2588%2590%25E6%259C%25AC%25E5%25AE%259E%25E7%258E%25B0Nginx%25E5%2585%25A8%25E7%25BB%25B4%25E5%25BA%25A6%25E7%259B%2591%25E6%258E%25A7%25E4%25B8%258E%25E8%25BF%2590%25E7%25BB%25B4%25E3%2580%2582%25E7%25A9%25B6%25E7%25AB%259F%25E6%2598%25AF%25E4%25BB%2580%25E4%25B9%2588%25E6%25A0%25B7%25E7%259A%2584%25E6%258A%2580%25E6%259C%25AF%25E6%259E%25B6%25E6%259E%2584%25E5%2592%258C%25E5%258A%259F%25E8%2583%25BD%25E8%25AE%25BE%25E8%25AE%25A1%25EF%25BC%258C%25E8%25AE%25A9%25E5%25AE%2583%25E5%259C%25A8%25E7%259F%25AD%25E6%2597%25B6%25E9%2597%25B4%25E5%2586%2585%25E4%25BF%2598%25E8%258E%25B7%25E5%25A4%25A7%25E6%2589%25B9%25E5%25BC%2580%25E5%258F%2591%25E8%2580%2585%25E7%259A%2584%25E5%25BF%2583%25EF%25BC%259F" target="_blank" title="https://github.com/likaia/nginxpulse%EF%BC%89%E7%9A%84%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%EF%BC%8C%E4%BB%85%E7%94%A8%E4%B8%80%E5%91%A8%E6%97%B6%E9%97%B4star%E6%95%B0%E4%BE%BF%E7%AA%81%E7%A0%B4%E5%8D%83%E7%BA%A7%EF%BC%8C%E6%88%90%E4%B8%BA%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E9%A2%86%E5%9F%9F%E7%9A%84%E4%B8%80%E5%8C%B9%E2%80%9C%E9%BB%91%E9%A9%AC%E2%80%9D%E3%80%82%E4%B8%8D%E5%90%8C%E4%BA%8E%E9%82%A3%E4%BA%9B%E9%9D%A0%E5%99%B1%E5%A4%B4%E5%8D%9A%E5%85%B3%E6%B3%A8%E7%9A%84%E9%A1%B9%E7%9B%AE%EF%BC%8Cnginxpulse%E7%9A%84%E8%B5%B0%E7%BA%A2%EF%BC%8C%E6%BA%90%E4%BA%8E%E5%AE%83%E7%B2%BE%E5%87%86%E8%A7%A3%E5%86%B3%E4%BA%86Nginx%E8%BF%90%E7%BB%B4%E9%A2%86%E5%9F%9F%E7%9A%84%E6%A0%B8%E5%BF%83%E7%97%9B%E7%82%B9%EF%BC%8C%E6%9B%B4%E5%87%AD%E5%80%9F%E2%80%9C%E8%BD%BB%E9%87%8F%E3%80%81%E6%98%93%E7%94%A8%E3%80%81%E5%8F%AF%E6%89%A9%E5%B1%95%E2%80%9D%E7%9A%84%E6%8A%80%E6%9C%AF%E7%89%B9%E6%80%A7%EF%BC%8C%E8%AE%A9%E4%B8%AD%E5%B0%8F%E5%9B%A2%E9%98%9F%E3%80%81%E4%B8%AA%E4%BA%BA%E5%BC%80%E5%8F%91%E8%80%85%E9%83%BD%E8%83%BD%E4%BD%8E%E6%88%90%E6%9C%AC%E5%AE%9E%E7%8E%B0Nginx%E5%85%A8%E7%BB%B4%E5%BA%A6%E7%9B%91%E6%8E%A7%E4%B8%8E%E8%BF%90%E7%BB%B4%E3%80%82%E7%A9%B6%E7%AB%9F%E6%98%AF%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84%E5%92%8C%E5%8A%9F%E8%83%BD%E8%AE%BE%E8%AE%A1%EF%BC%8C%E8%AE%A9%E5%AE%83%E5%9C%A8%E7%9F%AD%E6%97%B6%E9%97%B4%E5%86%85%E4%BF%98%E8%8E%B7%E5%A4%A7%E6%89%B9%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E5%BF%83%EF%BC%9F" ref="nofollow noopener noreferrer">github.com/likaia/nginâ€¦</a>ï¼‰çš„å¼€æºé¡¹ç›®ï¼Œä»…ç”¨ä¸€å‘¨æ—¶é—´staræ•°ä¾¿çªç ´åƒçº§ï¼Œæˆä¸ºæœåŠ¡å™¨è¿ç»´é¢†åŸŸçš„ä¸€åŒ¹â€œé»‘é©¬â€ã€‚ä¸åŒäºé‚£äº›é å™±å¤´åšå…³æ³¨çš„é¡¹ç›®ï¼Œnginxpulseçš„èµ°çº¢ï¼Œæºäºå®ƒç²¾å‡†è§£å†³äº†Nginxè¿ç»´é¢†åŸŸçš„æ ¸å¿ƒç—›ç‚¹ï¼Œæ›´å‡­å€Ÿâ€œè½»é‡ã€æ˜“ç”¨ã€å¯æ‰©å±•â€çš„æŠ€æœ¯ç‰¹æ€§ï¼Œè®©ä¸­å°å›¢é˜Ÿã€ä¸ªäººå¼€å‘è€…éƒ½èƒ½ä½æˆæœ¬å®ç°Nginxå…¨ç»´åº¦ç›‘æ§ä¸è¿ç»´ã€‚ç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ ·çš„æŠ€æœ¯æ¶æ„å’ŒåŠŸèƒ½è®¾è®¡ï¼Œè®©å®ƒåœ¨çŸ­æ—¶é—´å†…ä¿˜è·å¤§æ‰¹å¼€å‘è€…çš„å¿ƒï¼Ÿ</p>
<h3 data-id="heading-1">ä¸€ã€ç—›ç‚¹ç›´å‡»ï¼šnginxè¿ç»´çš„â€œå¡è„–å­â€é—®é¢˜</h3>
<p>ä½†å‡¡æ¥è§¦è¿‡Nginxè¿ç»´çš„å¼€å‘è€…éƒ½æ¸…æ¥šï¼ŒNginxä½œä¸ºé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼Œæ˜¯åç«¯æ¶æ„ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€ç¯ï¼Œä½†å®ƒçš„è¿ç»´å´è—ç€ä¸å°‘â€œå¡è„–å­â€çš„é—®é¢˜ï¼š</p>
<ul>
<li><strong>åŸç”Ÿç›‘æ§èƒ½åŠ›ç¼ºå¤±</strong>ï¼šNginxé»˜è®¤ä»…æä¾›åŸºç¡€çš„çŠ¶æ€é¡µï¼ˆngx_http_stub_status_moduleï¼‰ï¼Œä»…èƒ½å±•ç¤ºè¿æ¥æ•°ã€è¯·æ±‚æ•°ç­‰æç®€æŒ‡æ ‡ï¼Œæ— æ³•ç»Ÿè®¡è¯·æ±‚è€—æ—¶ã€é”™è¯¯ç‡ã€æ¥å£ç»´åº¦çš„æ€§èƒ½æ•°æ®ï¼Œæƒ³è¦è·å–ç²¾ç»†åŒ–æŒ‡æ ‡ï¼Œéœ€æ‰‹åŠ¨ç¼–å†™æ—¥å¿—è§£æè„šæœ¬ï¼Œè€—æ—¶ä¸”æ˜“å‡ºé”™ï¼›</li>
<li><strong>éƒ¨ç½²æˆæœ¬é«˜</strong>ï¼šä¼ ç»ŸNginxç›‘æ§æ–¹æ¡ˆï¼ˆPrometheus+Grafana+Exporterï¼‰éœ€è¦æ­å»ºå®Œæ•´çš„ç›‘æ§æ ˆï¼Œæ¶‰åŠå¤šä¸ªç»„ä»¶çš„é…ç½®ã€è”åŠ¨ï¼Œå¯¹ä¸­å°å›¢é˜Ÿæˆ–ä¸ªäººå¼€å‘è€…æ¥è¯´ï¼Œå­¦ä¹ æˆæœ¬ã€æœåŠ¡å™¨èµ„æºæˆæœ¬éƒ½åé«˜ï¼›</li>
<li><strong>æ•…éšœæ’æŸ¥æ•ˆç‡ä½</strong>ï¼šç¼ºä¹å®æ—¶å‘Šè­¦å’Œå¯è§†åŒ–çš„å¼‚å¸¸åˆ†æèƒ½åŠ›ï¼Œå¾€å¾€è¦ç­‰ä¸šåŠ¡åé¦ˆâ€œè®¿é—®æ…¢â€â€œæŠ¥é”™å¤šâ€ï¼Œæ‰èƒ½å»ç¿»æ—¥å¿—å®šä½é—®é¢˜ï¼Œé”™å¤±æœ€ä½³å¤„ç†æ—¶æœºï¼›</li>
<li><strong>é…ç½®ä¸ç›‘æ§è„±èŠ‚</strong>ï¼šä¿®æ”¹Nginxé…ç½®åï¼Œæ— æ³•å¿«é€ŸéªŒè¯é…ç½®åˆæ³•æ€§ï¼Œä¹Ÿä¸èƒ½ç›´è§‚çœ‹åˆ°é…ç½®å˜æ›´å¯¹æœåŠ¡æ€§èƒ½çš„å½±å“ã€‚</li>
</ul>
<p>è€Œnginxpulseçš„å‡ºç°ï¼Œæ°å¥½ç²¾å‡†å‘½ä¸­äº†è¿™äº›è¡Œä¸šç—›ç‚¹â€”â€”å®ƒä»¥â€œè½»é‡ã€æ˜“ç”¨ã€å¯è§†åŒ–â€ä¸ºæ ¸å¿ƒï¼Œä¸ºNginxæ‰“é€ äº†ä¸€ç«™å¼çš„ç›‘æ§ä¸è¿ç»´è§£å†³æ–¹æ¡ˆï¼Œæ— éœ€å¤æ‚çš„ç¯å¢ƒä¾èµ–ï¼Œæ— éœ€ä¸“ä¸šçš„è¿ç»´çŸ¥è¯†ï¼Œå°±èƒ½è®©å¼€å‘è€…å¿«é€ŸæŒæ¡Nginxçš„å…¨ç”Ÿå‘½å‘¨æœŸçŠ¶æ€ã€‚</p>
<h3 data-id="heading-2">äºŒã€æ ¸å¿ƒæ¶æ„ï¼šè½»é‡åŒ–è®¾è®¡ï¼Œæ— ä¾µå…¥å¼é›†æˆ</h3>
<p>æƒ³è¦ç†è§£nginxpulseçš„é«˜æ•ˆä¸æ˜“ç”¨ï¼Œé¦–å…ˆè¦äº†è§£å®ƒçš„æ ¸å¿ƒæ¶æ„ã€‚ä¸åŒäºä¼ ç»Ÿç›‘æ§å·¥å…·çš„â€œé‡é‡çº§â€è®¾è®¡ï¼Œnginxpulseé‡‡ç”¨â€œAgent + Web UI + æ•°æ®å­˜å‚¨â€çš„æç®€æ¶æ„ï¼Œä¸”æ‰€æœ‰ç»„ä»¶å‡å¯æŒ‰éœ€éƒ¨ç½²ï¼š</p>
<pre><code class="hljs language-css" lang="css">graph <span class="hljs-selector-tag">TD</span>
    <span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[NginxæœåŠ¡å™¨]</span> --&gt;|æ—¥å¿—/çŠ¶æ€æ•°æ®| <span class="hljs-selector-tag">B</span><span class="hljs-selector-attr">[nginxpulse-agent]</span>
    <span class="hljs-selector-tag">B</span> --&gt;|é‡‡é›†æŒ‡æ ‡| C<span class="hljs-selector-attr">[æœ¬åœ°å­˜å‚¨/Redis]</span>
    C --&gt;|æ•°æ®æŸ¥è¯¢| D<span class="hljs-selector-attr">[nginxpulse-web]</span>
    D --&gt;|å¯è§†åŒ–/å‘Šè­¦| E<span class="hljs-selector-attr">[å¼€å‘è€…/è¿ç»´äººå‘˜]</span>
    F<span class="hljs-selector-attr">[è‡ªå®šä¹‰å‘Šè­¦è§„åˆ™]</span> --&gt; D
    G<span class="hljs-selector-attr">[é…ç½®æ ¡éªŒæŒ‡ä»¤]</span> --&gt; <span class="hljs-selector-tag">A</span>
</code></pre>
<ul>
<li><strong>nginxpulse-agent</strong>ï¼šè½»é‡çº§é‡‡é›†ç«¯ï¼Œä»¥è¿›ç¨‹æˆ–å®¹å™¨å½¢å¼è¿è¡Œï¼Œæ— éœ€ä¿®æ”¹Nginxæ ¸å¿ƒé…ç½®ï¼Œä»…éœ€é€šè¿‡<code>include</code>å¼•å…¥å°‘é‡é…ç½®å³å¯å®ç°æ•°æ®é‡‡é›†ï¼Œå ç”¨CPU/å†…å­˜å‡ä½äº5%ï¼›</li>
<li><strong>æ•°æ®å­˜å‚¨å±‚</strong>ï¼šæ”¯æŒæœ¬åœ°æ–‡ä»¶ï¼ˆè½»é‡åœºæ™¯ï¼‰ã€Redisï¼ˆä¸­å¤§å‹é›†ç¾¤ï¼‰ä¸¤ç§å­˜å‚¨æ–¹å¼ï¼Œæ— éœ€ä¾èµ–MySQLã€PostgreSQLç­‰é‡å‹æ•°æ®åº“ï¼›</li>
<li><strong>nginxpulse-web</strong>ï¼šåŸºäºVue3 + Element Pluså¼€å‘çš„å¯è§†åŒ–æ§åˆ¶å°ï¼Œæä¾›æŒ‡æ ‡ç›‘æ§ã€é”™è¯¯åˆ†æã€å‘Šè­¦é…ç½®ç­‰å…¨åŠŸèƒ½æ“ä½œç•Œé¢ï¼›</li>
<li><strong>å‘Šè­¦æ¨¡å—</strong>ï¼šå†…ç½®å¤šæ¸ é“å‘Šè­¦é€‚é…å™¨ï¼Œæ”¯æŒé‚®ä»¶ã€é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ã€Slackç­‰ï¼Œå¯è‡ªå®šä¹‰å‘Šè­¦é˜ˆå€¼å’Œè§¦å‘è§„åˆ™ã€‚</li>
</ul>
<p>æ•´ä¸ªæ¶æ„çš„æ ¸å¿ƒä¼˜åŠ¿åœ¨äº<strong>æ— ä¾µå…¥å¼é›†æˆ</strong>â€”â€”æ— éœ€é‡å¯Nginxå³å¯å®Œæˆéƒ¨ç½²ï¼Œä¹Ÿä¸ä¼šå¯¹Nginxçš„æ ¸å¿ƒæ€§èƒ½é€ æˆä»»ä½•å½±å“ï¼Œè¿™ä¹Ÿæ˜¯å®ƒèƒ½å¿«é€Ÿè½åœ°çš„å…³é”®ã€‚</p>
<h3 data-id="heading-3">ä¸‰ã€æ ¸å¿ƒåŠŸèƒ½ï¼šä»ç›‘æ§åˆ°è¿ç»´çš„å…¨åœºæ™¯è¦†ç›–</h3>
<p>nginxpulseèƒ½å¿«é€Ÿå‡ºåœˆï¼Œæ ¸å¿ƒåœ¨äºå®ƒæŠŠå¤æ‚çš„Nginxè¿ç»´éœ€æ±‚ï¼Œæ‹†è§£æˆäº†æ™®é€šäººéƒ½èƒ½è½»æ¾ä¸Šæ‰‹çš„åŠŸèƒ½æ¨¡å—ï¼Œä¸”æ¯ä¸ªæ¨¡å—éƒ½ç›´å‡»å¼€å‘è€…çš„çœŸå®ç—›ç‚¹ï¼š</p>
<h4 data-id="heading-4">1. å…¨ç»´åº¦æŒ‡æ ‡ç›‘æ§ï¼šä¸æ­¢äºâ€œèƒ½çœ‹â€ï¼Œæ›´åœ¨äºâ€œçœ‹æ‡‚â€</h4>
<p>nginxpulseçš„ç›‘æ§æ¨¡å—ï¼Œè¦†ç›–äº†Nginxè¿ç»´æ‰€éœ€çš„æ‰€æœ‰æ ¸å¿ƒç»´åº¦ï¼Œä¸”æ‰€æœ‰æŒ‡æ ‡å‡æ”¯æŒ<strong>å®æ—¶åˆ·æ–°ï¼ˆ1ç§’ç²’åº¦ï¼‰</strong> å’Œ<strong>å†å²å›æº¯ï¼ˆæœ€é•¿30å¤©ï¼‰</strong> ï¼š</p>
<h5 data-id="heading-5">ï¼ˆ1ï¼‰åŸºç¡€è¿è¡ŒæŒ‡æ ‡</h5>
<ul>
<li>è¿æ¥æ•°ï¼šæ´»è·ƒè¿æ¥ã€ç­‰å¾…è¿æ¥ã€å·²å…³é—­è¿æ¥çš„å®æ—¶æ•°é‡åŠè¶‹åŠ¿ï¼›</li>
<li>è¯·æ±‚æŒ‡æ ‡ï¼šQPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰ã€æ€»è¯·æ±‚æ•°ã€è¯·æ±‚å‘½ä¸­ç‡ï¼ˆç¼“å­˜å‘½ä¸­/æœªå‘½ä¸­ï¼‰ï¼›</li>
<li>æµé‡æŒ‡æ ‡ï¼šå…¥ç«™/å‡ºç«™æµé‡ã€æŒ‰åŸŸå/æ¥å£ç»´åº¦çš„æµé‡åˆ†å¸ƒï¼›</li>
<li>æ€§èƒ½æŒ‡æ ‡ï¼šå¹³å‡å“åº”æ—¶é—´ã€P95/P99å“åº”æ—¶é—´ï¼ˆ95%/99%è¯·æ±‚çš„å“åº”è€—æ—¶ï¼‰ã€ä¸Šä¸‹æ¸¸ï¼ˆNginx â†” åç«¯æœåŠ¡ï¼‰å“åº”è€—æ—¶æ‹†åˆ†ã€‚</li>
</ul>
<h5 data-id="heading-6">ï¼ˆ2ï¼‰ä»£ç çº§å¼‚å¸¸åˆ†æ</h5>
<p>è‡ªåŠ¨è§£æNginxè®¿é—®æ—¥å¿—ï¼Œç»Ÿè®¡4xx/5xxé”™è¯¯ç åˆ†å¸ƒï¼Œå¹¶å®šä½åˆ°å…·ä½“çš„è¯·æ±‚URLã€å®¢æˆ·ç«¯IPã€å“åº”è€—æ—¶ï¼Œç”šè‡³èƒ½è¯†åˆ«å‡ºâ€œæ¶æ„è¯·æ±‚â€ï¼ˆå¦‚é«˜é¢‘404ã€502çš„å¼‚å¸¸IPï¼‰ï¼š</p>
<pre><code class="hljs language-c" lang="c"><span class="hljs-meta"># nginxpulseå†…ç½®çš„é”™è¯¯åˆ†ææŒ‡ä»¤ï¼ˆä¸€é”®ç”ŸæˆæŠ¥å‘Šï¼‰</span>
nginxpulse analyze error --nginx-<span class="hljs-built_in">log</span> /var/<span class="hljs-built_in">log</span>/nginx/access.<span class="hljs-built_in">log</span> --top <span class="hljs-number">20</span>
</code></pre>
<p>æ‰§è¡Œä¸Šè¿°æŒ‡ä»¤åï¼Œä¼šè¾“å‡ºå¦‚ä¸‹æ ¼å¼çš„é”™è¯¯åˆ†ææŠ¥å‘Šï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown">==================== Nginxé”™è¯¯åˆ†ææŠ¥å‘Š ====================
åˆ†ææ—¶é—´èŒƒå›´ï¼š2026-01-10 00:00:00 ~ 2026-01-10 23:59:59
æ€»è¯·æ±‚æ•°ï¼š125890 | é”™è¯¯è¯·æ±‚æ•°ï¼š328 | é”™è¯¯ç‡ï¼š0.26%

Top 5 é”™è¯¯ç åˆ†å¸ƒï¼š
<span class="hljs-bullet">1.</span> 404 Not Foundï¼š189æ¬¡ï¼ˆ57.6%ï¼‰
<span class="hljs-bullet">2.</span> 502 Bad Gatewayï¼š87æ¬¡ï¼ˆ26.5%ï¼‰
<span class="hljs-bullet">3.</span> 403 Forbiddenï¼š32æ¬¡ï¼ˆ9.8%ï¼‰
<span class="hljs-bullet">4.</span> 504 Gateway Timeoutï¼š15æ¬¡ï¼ˆ4.6%ï¼‰
<span class="hljs-bullet">5.</span> 400 Bad Requestï¼š5æ¬¡ï¼ˆ1.5%ï¼‰

Top 3 404è¯·æ±‚URLï¼š
<span class="hljs-bullet">1.</span> /api/v1/user/info (IP: 192.168.1.100, è®¿é—®æ¬¡æ•°: 45)
<span class="hljs-bullet">2.</span> /static/js/app.xxx.js (IP: 203.0.113.5, è®¿é—®æ¬¡æ•°: 32)
<span class="hljs-bullet">3.</span> /favicon.ico (IP: éšæœºåˆ†å¸ƒ, è®¿é—®æ¬¡æ•°: 28)

Top 2 502è¯·æ±‚URLï¼š
<span class="hljs-bullet">1.</span> /api/v1/order/create (åç«¯æœåŠ¡: 10.0.0.5:8080, è®¿é—®æ¬¡æ•°: 68)
<span class="hljs-bullet">2.</span> /api/v1/pay/callback (åç«¯æœåŠ¡: 10.0.0.6:8080, è®¿é—®æ¬¡æ•°: 19)
</code></pre>
<h5 data-id="heading-7">ï¼ˆ3ï¼‰é…ç½®é›†æˆç¤ºä¾‹</h5>
<p>æ— éœ€ä¿®æ”¹Nginxä¸»é…ç½®ï¼Œä»…éœ€æ·»åŠ ä»¥ä¸‹å‡ è¡Œå³å¯å®Œæˆç›‘æ§é›†æˆï¼Œå¯¹æ–°æ‰‹æå…¶å‹å¥½ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># åœ¨nginx.confä¸­å¼•å…¥nginxpulseé…ç½®ï¼ˆæ— éœ€é‡å¯ï¼Œreloadå³å¯ï¼‰</span>
include /etc/nginx/nginxpulse/nginxpulse.conf<span class="hljs-comment">;</span>

<span class="hljs-comment"># nginxpulse.conf æ ¸å¿ƒå†…å®¹</span>
server {
    listen 8888<span class="hljs-comment">;</span>
    server_name localhost<span class="hljs-comment">;</span>

    <span class="hljs-comment"># å¼€å¯nginxpulseç›‘æ§æ¨¡å—</span>
    nginxpulse_enable on<span class="hljs-comment">;</span>
    <span class="hljs-comment"># æŒ‡å®šagenté‡‡é›†åœ°å€</span>
    nginxpulse_agent_addr 127.0.0.1:9090<span class="hljs-comment">;</span>
    <span class="hljs-comment"># å¼€å¯è¯·æ±‚è€—æ—¶ç»Ÿè®¡</span>
    nginxpulse_timer on<span class="hljs-comment">;</span>
    <span class="hljs-comment"># å¼€å¯é”™è¯¯ç é‡‡é›†</span>
    nginxpulse_error_code on<span class="hljs-comment">;</span>
}
</code></pre>
<h4 data-id="heading-8">2. çµæ´»å‘Šè­¦ï¼šä»â€œè¢«åŠ¨æ’æŸ¥â€åˆ°â€œä¸»åŠ¨é¢„è­¦â€</h4>
<p>nginxpulseçš„å‘Šè­¦æ¨¡å—æ”¯æŒ<strong>å¤šç»´åº¦é˜ˆå€¼é…ç½®</strong>å’Œ<strong>å¤šæ¸ é“æ¨é€</strong>ï¼Œå½»åº•è§£å†³äº†Nginxå¼‚å¸¸â€œå‘ç°æ™šâ€çš„é—®é¢˜ï¼š</p>
<h5 data-id="heading-9">ï¼ˆ1ï¼‰å‘Šè­¦è§„åˆ™é…ç½®ï¼ˆYAMLæ ¼å¼ï¼Œæ”¯æŒçƒ­åŠ è½½ï¼‰</h5>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># /etc/nginxpulse/alert_rules.yaml</span>
<span class="hljs-attr">alert_rules:</span>
  <span class="hljs-comment"># è¿æ¥æ•°è¶…é™å‘Šè­¦</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">"nginx_connection_high"</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">"connection"</span>
    <span class="hljs-attr">condition:</span> <span class="hljs-string">"active_connections &gt; 1000"</span>
    <span class="hljs-attr">duration:</span> <span class="hljs-string">30s</span>  <span class="hljs-comment"># æŒç»­30ç§’è§¦å‘å‘Šè­¦</span>
    <span class="hljs-attr">severity:</span> <span class="hljs-string">"warning"</span>
    <span class="hljs-attr">targets:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">"dingtalk"</span>
        <span class="hljs-attr">url:</span> <span class="hljs-string">"https://oapi.dingtalk.com/robot/send?access_token=xxx"</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">"email"</span>
        <span class="hljs-attr">to:</span> <span class="hljs-string">"ops@example.com"</span>

  <span class="hljs-comment"># é”™è¯¯ç‡é£™å‡å‘Šè­¦</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">"nginx_error_rate_high"</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">"request"</span>
    <span class="hljs-attr">condition:</span> <span class="hljs-string">"error_rate &gt; 1%"</span>
    <span class="hljs-attr">duration:</span> <span class="hljs-string">60s</span>
    <span class="hljs-attr">severity:</span> <span class="hljs-string">"critical"</span>
    <span class="hljs-attr">targets:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">"wechat"</span>
        <span class="hljs-attr">corp_id:</span> <span class="hljs-string">"wwxxx"</span>
        <span class="hljs-attr">agent_id:</span> <span class="hljs-number">1000002</span>
        <span class="hljs-attr">secret:</span> <span class="hljs-string">"xxx"</span>
        <span class="hljs-attr">to_user:</span> <span class="hljs-string">"@all"</span>

  <span class="hljs-comment"># å“åº”æ—¶é—´è¿‡é•¿å‘Šè­¦</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">"nginx_response_slow"</span>
    <span class="hljs-attr">type:</span> <span class="hljs-string">"response"</span>
    <span class="hljs-attr">condition:</span> <span class="hljs-string">"p99_response_time &gt; 500ms"</span>
    <span class="hljs-attr">duration:</span> <span class="hljs-string">120s</span>
    <span class="hljs-attr">severity:</span> <span class="hljs-string">"warning"</span>
    <span class="hljs-attr">targets:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">type:</span> <span class="hljs-string">"slack"</span>
        <span class="hljs-attr">url:</span> <span class="hljs-string">"https://hooks.slack.com/services/xxx/xxx/xxx"</span>
</code></pre>
<h5 data-id="heading-10">ï¼ˆ2ï¼‰å‘Šè­¦è§¦å‘é€»è¾‘</h5>
<p>å½“æŒ‡æ ‡æ»¡è¶³é…ç½®çš„æ¡ä»¶å¹¶æŒç»­æŒ‡å®šæ—¶é•¿åï¼Œnginxpulseä¼šè‡ªåŠ¨æ¨é€æ ¼å¼åŒ–çš„å‘Šè­¦ä¿¡æ¯ï¼Œä¾‹å¦‚é’‰é’‰å‘Šè­¦å†…å®¹ï¼š</p>
<pre><code class="hljs language-lua" lang="lua">ã€Nginxå¼‚å¸¸å‘Šè­¦ - ç´§æ€¥ã€‘
å‘Šè­¦åç§°ï¼šnginx_error_rate_high
è§¦å‘æ—¶é—´ï¼š<span class="hljs-number">2026</span><span class="hljs-number">-01</span><span class="hljs-number">-10</span> <span class="hljs-number">14</span>:<span class="hljs-number">35</span>:<span class="hljs-number">20</span>
å‘Šè­¦æŒ‡æ ‡ï¼šé”™è¯¯ç‡ <span class="hljs-number">1.8</span>%ï¼ˆé˜ˆå€¼<span class="hljs-number">1</span>%ï¼‰
å½±å“èŒƒå›´ï¼šåŸŸå example.comï¼Œæ¥å£ /api/v1/order/<span class="hljs-built_in">create</span>
å½“å‰çŠ¶æ€ï¼šæŒç»­è§¦å‘ä¸­ï¼ˆå·²æŒç»­<span class="hljs-number">65</span>ç§’ï¼‰
å»ºè®®æ“ä½œï¼š<span class="hljs-number">1.</span> æ£€æŸ¥åç«¯æœåŠ¡ <span class="hljs-number">10.0</span><span class="hljs-number">.0</span><span class="hljs-number">.5</span>:<span class="hljs-number">8080</span> æ˜¯å¦æ­£å¸¸ï¼›<span class="hljs-number">2.</span> æŸ¥çœ‹Nginxé”™è¯¯æ—¥å¿— /var/<span class="hljs-built_in">log</span>/nginx/<span class="hljs-built_in">error</span>.<span class="hljs-built_in">log</span>
</code></pre>
<h4 data-id="heading-11">3. é…ç½®æ ¡éªŒä¸å¿«é€Ÿè¿ç»´ï¼šä¸æ­¢äºç›‘æ§ï¼Œæ›´åœ¨äºâ€œå¥½ç”¨â€</h4>
<p>nginxpulseä¸ä»…æ˜¯ç›‘æ§å·¥å…·ï¼Œæ›´æ˜¯Nginxè¿ç»´çš„â€œè¾…åŠ©å·¥å…·â€ï¼Œå†…ç½®äº†å®ç”¨çš„è¿ç»´åŠŸèƒ½ï¼š</p>
<h5 data-id="heading-12">ï¼ˆ1ï¼‰é…ç½®è¯­æ³•æ ¡éªŒ</h5>
<p>æ— éœ€é‡å¯Nginxï¼Œå³å¯éªŒè¯é…ç½®æ–‡ä»¶çš„åˆæ³•æ€§ï¼Œé¿å…å› é…ç½®é”™è¯¯å¯¼è‡´Nginxå¯åŠ¨å¤±è´¥ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ ¡éªŒNginxé…ç½®</span>
nginxpulse config check --conf /etc/nginx/nginx.conf

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹</span>
âœ… Nginxé…ç½®æ–‡ä»¶è¯­æ³•æ ¡éªŒé€šè¿‡
âš ï¸  æ³¨æ„ï¼šé…ç½®ä¸­å­˜åœ¨æœªä½¿ç”¨çš„upstreamèŠ‚ç‚¹ï¼ˆbackend_2ï¼‰ï¼Œå»ºè®®æ¸…ç†
</code></pre>
<h5 data-id="heading-13">ï¼ˆ2ï¼‰ä¸€é”®é‡è½½/é‡å¯</h5>
<p>é€šè¿‡nginxpulseæ§åˆ¶å°æˆ–å‘½ä»¤è¡Œï¼Œå¯å®‰å…¨åœ°é‡è½½Nginxé…ç½®ï¼ˆæ— éœ€ä¸­æ–­æœåŠ¡ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸€é”®é‡è½½Nginxé…ç½®</span>
nginxpulse nginx reload --conf /etc/nginx/nginx.conf

<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹</span>
â„¹ï¸  æ­£åœ¨é‡è½½Nginxé…ç½®...
âœ… Nginxé…ç½®é‡è½½æˆåŠŸï¼Œè¿›ç¨‹IDï¼š12345
</code></pre>
<h5 data-id="heading-14">ï¼ˆ3ï¼‰é›†ç¾¤åŒ–ç›‘æ§ï¼ˆè¿›é˜¶åŠŸèƒ½ï¼‰</h5>
<p>å¯¹äºå¤šå°NginxæœåŠ¡å™¨çš„é›†ç¾¤åœºæ™¯ï¼Œnginxpulseæ”¯æŒé€šè¿‡Agenté›†ç¾¤é‡‡é›†æ•°æ®ï¼Œåœ¨ç»Ÿä¸€çš„Webæ§åˆ¶å°å±•ç¤ºæ‰€æœ‰èŠ‚ç‚¹çš„æŒ‡æ ‡ï¼Œè¿˜èƒ½æŒ‰é›†ç¾¤ç»´åº¦ç»Ÿè®¡æ•´ä½“æ€§èƒ½ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># é›†ç¾¤æ¨¡å¼ä¸‹çš„Agenté…ç½®ç¤ºä¾‹</span>
nginxpulse_agent_cluster on<span class="hljs-comment">;</span>
nginxpulse_agent_cluster_name "prod-nginx-cluster"<span class="hljs-comment">;</span>
nginxpulse_agent_cluster_nodes 10.0.0.10:9090 10.0.0.11:9090 10.0.0.12:9090<span class="hljs-comment">;</span>
</code></pre>
<h4 data-id="heading-15">4. è‡ªå®šä¹‰æ‰©å±•ï¼šæ»¡è¶³ä¸ªæ€§åŒ–éœ€æ±‚</h4>
<p>ä½œä¸ºå¼€æºé¡¹ç›®ï¼Œnginxpulseæ”¯æŒå¼€å‘è€…åŸºäºç°æœ‰æ¨¡å—è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä¾‹å¦‚è‡ªå®šä¹‰æŒ‡æ ‡é‡‡é›†ã€æ–°å¢å‘Šè­¦æ¸ é“ç­‰ï¼š</p>
<h5 data-id="heading-16">ï¼ˆ1ï¼‰è‡ªå®šä¹‰æŒ‡æ ‡é‡‡é›†ç¤ºä¾‹ï¼ˆGoè¯­è¨€ï¼‰</h5>
<pre><code class="hljs language-go" lang="go"><span class="hljs-comment">// åŸºäºnginxpulseçš„SDKæ‰©å±•è‡ªå®šä¹‰æŒ‡æ ‡</span>
<span class="hljs-keyword">package</span> main

<span class="hljs-keyword">import</span> (
    <span class="hljs-string">"github.com/likaia/nginxpulse/sdk/agent"</span>
    <span class="hljs-string">"github.com/likaia/nginxpulse/sdk/metric"</span>
    <span class="hljs-string">"time"</span>
)

<span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> {
    <span class="hljs-comment">// åˆå§‹åŒ–Agentå®¢æˆ·ç«¯</span>
    client, err := agent.NewClient(<span class="hljs-string">"127.0.0.1:9090"</span>)
    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> {
        <span class="hljs-built_in">panic</span>(err)
    }

    <span class="hljs-comment">// è‡ªå®šä¹‰æŒ‡æ ‡ï¼šç»Ÿè®¡ç‰¹å®šæ¥å£çš„è¯·æ±‚æ•°</span>
    customMetric := &amp;metric.Metric{
        Name:      <span class="hljs-string">"custom_api_request_count"</span>,
        Type:      metric.Counter,
        Labels:    <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-type">string</span>{<span class="hljs-string">"api"</span>: <span class="hljs-string">"/api/v1/custom"</span>},
        Value:     <span class="hljs-number">0</span>,
        Timestamp: time.Now().Unix(),
    }

    <span class="hljs-comment">// æ¨¡æ‹Ÿé‡‡é›†å¹¶ä¸ŠæŠ¥æŒ‡æ ‡</span>
    <span class="hljs-keyword">for</span> {
        customMetric.Value += <span class="hljs-number">1</span>
        customMetric.Timestamp = time.Now().Unix()
        client.ReportMetric(customMetric)
        time.Sleep(<span class="hljs-number">1</span> * time.Second)
    }
}
</code></pre>
<h5 data-id="heading-17">ï¼ˆ2ï¼‰æ–°å¢å‘Šè­¦æ¸ é“ï¼ˆPythonç¤ºä¾‹ï¼‰</h5>
<pre><code class="hljs language-python" lang="python"><span class="hljs-comment"># æ‰©å±•ä¼ä¸šå¾®ä¿¡å‘Šè­¦é€‚é…å™¨</span>
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> nginxpulse.alert.adapter <span class="hljs-keyword">import</span> BaseAdapter

<span class="hljs-keyword">class</span> <span class="hljs-title class_">WeComAdapter</span>(<span class="hljs-title class_ inherited__">BaseAdapter</span>):
    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, corp_id, agent_id, secret, to_user</span>):
        self.corp_id = corp_id
        self.agent_id = agent_id
        self.secret = secret
        self.to_user = to_user
        self.token = self.get_access_token()

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_access_token</span>(<span class="hljs-params">self</span>):
        <span class="hljs-comment"># è·å–ä¼ä¸šå¾®ä¿¡access_token</span>
        url = <span class="hljs-string">f"https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=<span class="hljs-subst">{self.corp_id}</span>&amp;corpsecret=<span class="hljs-subst">{self.secret}</span>"</span>
        resp = requests.get(url).json()
        <span class="hljs-keyword">return</span> resp[<span class="hljs-string">"access_token"</span>]

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">send</span>(<span class="hljs-params">self, alert</span>):
        <span class="hljs-comment"># æ„é€ å‘Šè­¦æ¶ˆæ¯</span>
        msg = {
            <span class="hljs-string">"touser"</span>: self.to_user,
            <span class="hljs-string">"msgtype"</span>: <span class="hljs-string">"text"</span>,
            <span class="hljs-string">"agentid"</span>: self.agent_id,
            <span class="hljs-string">"text"</span>: {
                <span class="hljs-string">"content"</span>: <span class="hljs-string">f"ã€Nginxå‘Šè­¦ã€‘<span class="hljs-subst">{alert.name}</span>\nè§¦å‘æ¡ä»¶ï¼š<span class="hljs-subst">{alert.condition}</span>\nå½“å‰å€¼ï¼š<span class="hljs-subst">{alert.value}</span>"</span>
            }
        }
        <span class="hljs-comment"># å‘é€å‘Šè­¦</span>
        url = <span class="hljs-string">f"https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=<span class="hljs-subst">{self.token}</span>"</span>
        requests.post(url, json=msg)

<span class="hljs-comment"># æ³¨å†Œé€‚é…å™¨</span>
<span class="hljs-keyword">from</span> nginxpulse.alert <span class="hljs-keyword">import</span> registry
registry.register_adapter(<span class="hljs-string">"wecom"</span>, WeComAdapter)
</code></pre>
<h3 data-id="heading-18">å››ã€éƒ¨ç½²ä½“éªŒï¼š5åˆ†é’Ÿä¸Šæ‰‹ï¼Œå¼€ç®±å³ç”¨</h3>
<p>nginxpulseçš„éƒ¨ç½²é—¨æ§›æä½ï¼Œæ— è®ºæ˜¯Dockeréƒ¨ç½²è¿˜æ˜¯äºŒè¿›åˆ¶éƒ¨ç½²ï¼Œéƒ½èƒ½åœ¨5åˆ†é’Ÿå†…å®Œæˆï¼š</p>
<h4 data-id="heading-19">1. Dockerä¸€é”®éƒ¨ç½²</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ‹‰å–é•œåƒ</span>
docker pull likaia/nginxpulse:latest

<span class="hljs-comment"># å¯åŠ¨å®¹å™¨ï¼ˆåŒ…å«Agent + Web UIï¼‰</span>
docker run -d \
  --name nginxpulse \
  -p 9090:9090 \  <span class="hljs-comment"># Agentç«¯å£</span>
  -p 8080:8080 \  <span class="hljs-comment"># Web UIç«¯å£</span>
  -v /var/log/nginx:/var/log/nginx \  <span class="hljs-comment"># æŒ‚è½½Nginxæ—¥å¿—ç›®å½•</span>
  -v /etc/nginx:/etc/nginx \          <span class="hljs-comment"># æŒ‚è½½Nginxé…ç½®ç›®å½•</span>
  likaia/nginxpulse:latest
</code></pre>
<p>å¯åŠ¨åï¼Œè®¿é—®<code>http://æœåŠ¡å™¨IP:8080</code>å³å¯è¿›å…¥Webæ§åˆ¶å°ï¼Œé»˜è®¤è´¦å·å¯†ç ä¸º<code>admin/admin</code>ï¼Œæ— éœ€é¢å¤–é…ç½®å³å¯çœ‹åˆ°Nginxçš„åŸºç¡€ç›‘æ§æ•°æ®ã€‚</p>
<h4 data-id="heading-20">2. äºŒè¿›åˆ¶éƒ¨ç½²ï¼ˆLinuxï¼‰</h4>
<pre><code class="hljs language-ruby" lang="ruby"><span class="hljs-comment"># ä¸‹è½½äºŒè¿›åˆ¶åŒ…</span>
wget <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/github.com/likaia</span><span class="hljs-regexp">/nginxpulse/releases</span><span class="hljs-regexp">/latest/download</span><span class="hljs-regexp">/nginxpulse_linux_amd64.tar.gz

# è§£å‹
tar -zxvf nginxpulse_linux_amd64.tar.gz -C /usr</span><span class="hljs-regexp">/local/bin</span>

<span class="hljs-comment"># å¯åŠ¨Agent</span>
nohup nginxpulse agent --listen <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span><span class="hljs-symbol">:</span><span class="hljs-number">9090</span> &gt; <span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginxpulse/agent</span>.log <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &amp;

<span class="hljs-comment"># å¯åŠ¨Web UI</span>
nohup nginxpulse web --listen <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span><span class="hljs-symbol">:</span><span class="hljs-number">8080</span> --agent-addr <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-symbol">:</span><span class="hljs-number">9090</span> &gt; <span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginxpulse/web</span>.log <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> &amp;
</code></pre>
<h3 data-id="heading-21">äº”ã€ä¸ºä»€ä¹ˆæ˜¯å®ƒï¼Ÿå¼€æºé¡¹ç›®çš„â€œå‡ºåœˆâ€é€»è¾‘</h3>
<p>nginxpulseèƒ½åœ¨ä¸€å‘¨å†…starç ´åƒï¼Œæœ¬è´¨ä¸Šæ˜¯è¸©ä¸­äº†å¼€æºé¡¹ç›®çš„æ ¸å¿ƒæˆåŠŸé€»è¾‘ï¼Œä¹Ÿæ˜¯å®ƒåŒºåˆ«äºå…¶ä»–Nginxç›‘æ§å·¥å…·çš„å…³é”®ï¼š</p>
<h4 data-id="heading-22">1. è§£å†³çœŸé—®é¢˜ï¼Œè€Œéâ€œé€ è½®å­â€</h4>
<p>nginxpulseæ²¡æœ‰è¿½æ±‚â€œå¤§è€Œå…¨â€çš„åŠŸèƒ½å †ç Œï¼Œè€Œæ˜¯èšç„¦Nginxè¿ç»´ä¸­<strong>æœ€é«˜é¢‘ã€æœ€ç—›</strong>çš„éœ€æ±‚ï¼šç›‘æ§å¯è§†åŒ–ã€å¼‚å¸¸å‘Šè­¦ã€é…ç½®æ ¡éªŒã€‚è¿™äº›åŠŸèƒ½çœ‹ä¼¼åŸºç¡€ï¼Œå´æ˜¯æ¯ä¸ªNginxä½¿ç”¨è€…æ¯å¤©éƒ½ä¼šé‡åˆ°çš„é—®é¢˜ï¼Œè§£å†³è¿™äº›é—®é¢˜ï¼Œè‡ªç„¶èƒ½è·å¾—å¼€å‘è€…çš„è®¤å¯ã€‚</p>
<h4 data-id="heading-23">2. æè‡´çš„æ˜“ç”¨æ€§ï¼Œé™ä½ä½¿ç”¨é—¨æ§›</h4>
<p>æŠ€æœ¯çš„ä»·å€¼åœ¨äºæ™®æƒ ã€‚nginxpulseçš„è®¾è®¡ç†å¿µæ˜¯â€œè®©è¿ç»´æ–°æ‰‹ä¹Ÿèƒ½ç©è½¬Nginxç›‘æ§â€ï¼šæ— éœ€æ­å»ºå¤æ‚çš„ç›‘æ§æ ˆã€æ— éœ€ç¼–å†™ç¹ççš„è„šæœ¬ã€æ— éœ€æŒæ¡ä¸“ä¸šçš„è¿ç»´çŸ¥è¯†ï¼Œ5åˆ†é’Ÿå³å¯å®Œæˆéƒ¨ç½²ï¼Œå¼€ç®±å³ç”¨ã€‚è¿™ç§â€œé›¶é—¨æ§›â€çš„ä½“éªŒï¼Œè®©å®ƒåœ¨ä¸­å°å›¢é˜Ÿå’Œä¸ªäººå¼€å‘è€…ä¸­å¿«é€Ÿä¼ æ’­ã€‚</p>
<h4 data-id="heading-24">3. è½»é‡çº§è®¾è®¡ï¼Œæ— æ€§èƒ½æŸè€—</h4>
<p>å¾ˆå¤šç›‘æ§å·¥å…·æœ¬èº«ä¼šå ç”¨å¤§é‡æœåŠ¡å™¨èµ„æºï¼Œç”šè‡³å½±å“è¢«ç›‘æ§æœåŠ¡çš„æ€§èƒ½ï¼Œè€Œnginxpulseçš„Agentè¿›ç¨‹å ç”¨CPUâ‰¤5%ã€å†…å­˜â‰¤20MBï¼Œä¸”é‡‡ç”¨â€œéä¾µå…¥å¼â€æ•°æ®é‡‡é›†æ–¹å¼ï¼Œä¸ä¼šå¯¹Nginxçš„æ ¸å¿ƒæ€§èƒ½é€ æˆä»»ä½•å½±å“ï¼Œè¿™å¯¹èµ„æºç´§å¼ çš„ä¸­å°å›¢é˜Ÿæ¥è¯´å°¤ä¸ºé‡è¦ã€‚</p>
<h4 data-id="heading-25">4. å¼€æºå…è´¹ï¼Œç¤¾åŒºå‹å¥½</h4>
<p>ä½œä¸ºçº¯å¼€æºé¡¹ç›®ï¼ˆMITåè®®ï¼‰ï¼Œnginxpulseæ— ä»»ä½•ä»˜è´¹åŠŸèƒ½ã€æ— å•†ä¸šç»‘å®šï¼Œä»£ç å®Œå…¨å¼€æºå¯å®¡è®¡ï¼Œå¼€å‘è€…å¯æ ¹æ®è‡ªèº«éœ€æ±‚äºŒæ¬¡å¼€å‘ã€å®šåˆ¶åŠŸèƒ½ã€‚é¡¹ç›®ç»´æŠ¤è€…ç§¯æå“åº”GitHub Issuesï¼Œå¹³å‡24å°æ—¶å†…å›å¤é—®é¢˜ï¼ŒåŠæ—¶è¿­ä»£ç‰ˆæœ¬ä¿®å¤Bugï¼Œè¿˜æ¬¢è¿ç¤¾åŒºè´¡çŒ®ä»£ç ï¼Œå½¢æˆäº†è‰¯æ€§çš„å¼€æºåä½œæ°›å›´ã€‚</p>
<h3 data-id="heading-26">å…­ã€æœªæ¥è§„åˆ’ï¼šæœç€â€œNginxå…¨ç”Ÿå‘½å‘¨æœŸè¿ç»´å·¥å…·â€æ¼”è¿›</h3>
<p>ä»é¡¹ç›®çš„Roadmapå’Œç¤¾åŒºè®¨è®ºæ¥çœ‹ï¼Œnginxpulseçš„è§„åˆ’è¿œä¸æ­¢äºç°æœ‰åŠŸèƒ½ï¼Œåç»­å°†é‡ç‚¹å‘åŠ›ä»¥ä¸‹æ–¹å‘ï¼š</p>
<ol>
<li><strong>é…ç½®ç®¡ç†</strong>ï¼šæ”¯æŒNginxé…ç½®çš„ç‰ˆæœ¬æ§åˆ¶ã€ä¸€é”®å›æ»šã€é›†ç¾¤åŒæ­¥ï¼Œè§£å†³é…ç½®å˜æ›´éš¾ç®¡ç†çš„é—®é¢˜ï¼›</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–å»ºè®®</strong>ï¼šåŸºäºç›‘æ§æ•°æ®ï¼Œè‡ªåŠ¨åˆ†æNginxé…ç½®çš„ä¼˜åŒ–ç‚¹ï¼ˆå¦‚worker_processesã€keepalive_timeoutç­‰å‚æ•°ï¼‰ï¼›</li>
<li><strong>å®‰å…¨ç›‘æ§</strong>ï¼šé›†æˆNginxè®¿é—®æ—¥å¿—çš„å®‰å…¨åˆ†æï¼Œè¯†åˆ«SQLæ³¨å…¥ã€XSSæ”»å‡»ã€CCæ”»å‡»ç­‰æ¶æ„è¯·æ±‚ï¼›</li>
<li><strong>äº‘åŸç”Ÿé€‚é…</strong>ï¼šå®Œå–„K8sç¯å¢ƒä¸‹çš„éƒ¨ç½²æ–¹æ¡ˆï¼Œæ”¯æŒSidecaræ¨¡å¼ã€ConfigMap/Secreté›†æˆï¼›</li>
<li><strong>å¤šè¯­è¨€SDK</strong>ï¼šæä¾›Pythonã€Javaã€Node.jsç­‰å¤šè¯­è¨€SDKï¼Œé™ä½äºŒæ¬¡å¼€å‘é—¨æ§›ã€‚</li>
</ol>
<h3 data-id="heading-27">ä¸ƒã€æ€»ç»“ï¼šå¥½çš„å¼€æºé¡¹ç›®ï¼Œä»æ¥éƒ½æ˜¯â€œè§£å†³é—®é¢˜â€</h3>
<p>nginxpulseçš„èµ°çº¢ï¼Œå°è¯äº†ä¸€ä¸ªæœ´ç´ çš„é“ç†ï¼šå¥½çš„å¼€æºé¡¹ç›®ï¼Œä»æ¥ä¸æ˜¯é â€œç‚«æŠ€â€ï¼Œè€Œæ˜¯é â€œè§£å†³é—®é¢˜â€ã€‚å®ƒæ²¡æœ‰å¤æ‚çš„æ¶æ„è®¾è®¡ï¼Œæ²¡æœ‰å‰æ²¿çš„æŠ€æœ¯å™±å¤´ï¼Œå´å‡­å€Ÿå¯¹Nginxè¿ç»´ç—›ç‚¹çš„æ·±åˆ»ç†è§£ï¼ŒæŠŠâ€œè®©ç›‘æ§æ›´ç®€å•â€åšåˆ°äº†æè‡´ã€‚</p>
<p>å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œå¦‚æœä½ æ­£åœ¨è¢«Nginxç›‘æ§éš¾ã€æ’æŸ¥æ…¢ã€é…ç½®ä¹±çš„é—®é¢˜å›°æ‰°ï¼Œä¸å¦¨è¯•è¯•è¿™ä¸ªä¸€å‘¨starç ´åƒçš„å¼€æºé¡¹ç›®â€”â€”<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Flikaia%2Fnginxpulse%25E3%2580%2582%25E6%2597%25A0%25E8%25AE%25BA%25E6%2598%25AF%25E4%25B8%25AA%25E4%25BA%25BA%25E9%25A1%25B9%25E7%259B%25AE%25E7%259A%2584%25E8%25BD%25BB%25E9%2587%258F%25E7%259B%2591%25E6%258E%25A7%25EF%25BC%258C%25E8%25BF%2598%25E6%2598%25AF%25E4%25BC%2581%25E4%25B8%259A%25E7%25BA%25A7%25E9%259B%2586%25E7%25BE%25A4%25E7%259A%2584%25E5%2585%25A8%25E7%25BB%25B4%25E5%25BA%25A6%25E8%25BF%2590%25E7%25BB%25B4%25EF%25BC%258C%25E5%25AE%2583%25E9%2583%25BD%25E8%2583%25BD%25E4%25BB%25A5%25E6%259C%2580%25E4%25BD%258E%25E7%259A%2584%25E6%2588%2590%25E6%259C%25AC%25EF%25BC%258C%25E8%25A7%25A3%25E5%2586%25B3%25E4%25BD%25A0%25E6%259C%2580%25E6%25A0%25B8%25E5%25BF%2583%25E7%259A%2584%25E9%2597%25AE%25E9%25A2%2598%25E3%2580%2582" target="_blank" title="https://github.com/likaia/nginxpulse%E3%80%82%E6%97%A0%E8%AE%BA%E6%98%AF%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE%E7%9A%84%E8%BD%BB%E9%87%8F%E7%9B%91%E6%8E%A7%EF%BC%8C%E8%BF%98%E6%98%AF%E4%BC%81%E4%B8%9A%E7%BA%A7%E9%9B%86%E7%BE%A4%E7%9A%84%E5%85%A8%E7%BB%B4%E5%BA%A6%E8%BF%90%E7%BB%B4%EF%BC%8C%E5%AE%83%E9%83%BD%E8%83%BD%E4%BB%A5%E6%9C%80%E4%BD%8E%E7%9A%84%E6%88%90%E6%9C%AC%EF%BC%8C%E8%A7%A3%E5%86%B3%E4%BD%A0%E6%9C%80%E6%A0%B8%E5%BF%83%E7%9A%84%E9%97%AE%E9%A2%98%E3%80%82" ref="nofollow noopener noreferrer">github.com/likaia/nginâ€¦</a></p>
<p>å¼€æºçš„é­…åŠ›ï¼Œå°±åœ¨äºæ¯ä¸€ä¸ªè§£å†³çœŸå®ç—›ç‚¹çš„å°é¡¹ç›®ï¼Œéƒ½æœ‰å¯èƒ½æˆä¸ºæ”¹å˜è¡Œä¸šæ•ˆç‡çš„â€œå¤§åŠ›é‡â€ã€‚nginxpulseçš„æ•…äº‹ï¼Œæ‰åˆšåˆšå¼€å§‹ã€‚</p>
<hr/>
<h4 data-id="heading-28">æ€»ç»“</h4>
<ol>
<li>nginxpulseå‡­å€Ÿâ€œè½»é‡ã€æ— ä¾µå…¥ã€æ˜“ç”¨â€çš„æ ¸å¿ƒç‰¹æ€§ï¼Œè§£å†³äº†Nginxç›‘æ§éƒ¨ç½²æˆæœ¬é«˜ã€æŒ‡æ ‡ä¸å…¨ã€å‘Šè­¦ä¸åŠæ—¶çš„ç—›ç‚¹ï¼Œè¿™æ˜¯å®ƒå¿«é€Ÿå‡ºåœˆçš„æ ¸å¿ƒåŸå› ï¼›</li>
<li>é¡¹ç›®æ ¸å¿ƒåŠŸèƒ½è¦†ç›–å…¨ç»´åº¦æŒ‡æ ‡ç›‘æ§ã€å¤šæ¸ é“å‘Šè­¦ã€é…ç½®æ ¡éªŒ/è¿ç»´ã€é›†ç¾¤ç›‘æ§ï¼Œè¿˜æ”¯æŒè‡ªå®šä¹‰æ‰©å±•ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚ï¼›</li>
<li>æä½çš„éƒ¨ç½²é—¨æ§›ï¼ˆDockerä¸€é”®å¯åŠ¨ã€5åˆ†é’Ÿä¸Šæ‰‹ï¼‰å’Œå¼€æºå…è´¹çš„ç‰¹æ€§ï¼Œè®©å®ƒåœ¨ä¸­å°å›¢é˜Ÿå’Œä¸ªäººå¼€å‘è€…ä¸­å¿«é€Ÿä¼ æ’­ï¼Œä¹Ÿç¬¦åˆå¼€æºé¡¹ç›®â€œæ™®æƒ â€çš„æ ¸å¿ƒä»·å€¼ã€‚</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain æ¡†æ¶æ ¸å¿ƒç»„ä»¶è®°å¿†]]></title>    <link>https://juejin.cn/post/7597058147748855818</link>    <guid>https://juejin.cn/post/7597058147748855818</guid>    <pubDate>2026-01-20T08:32:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597058147748855818" data-draft-id="7597056049691656230" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain æ¡†æ¶æ ¸å¿ƒç»„ä»¶è®°å¿†"/> <meta itemprop="keywords" content="LangChain,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-20T08:32:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è‰å¸½lufei"/> <meta itemprop="url" content="https://juejin.cn/user/501033035632093"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain æ¡†æ¶æ ¸å¿ƒç»„ä»¶è®°å¿†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/501033035632093/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è‰å¸½lufei
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:32:07.000Z" title="Tue Jan 20 2026 08:32:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ä¸Šä¸€ç¯‡å­¦ä¹ äº† LangChain æ¡†æ¶çš„åŸºç¡€çŸ¥è¯†å’Œæ ¸å¿ƒç»„ä»¶ Prompts å’Œ Chainsï¼Œè¿™ç¯‡æ–‡ç« å°†ç»§ç»­å­¦ä¹  LangChain æ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶ Memoryï¼ˆè®°å¿†ï¼‰</p>
<h2 data-id="heading-1">è®°å¿†ï¼ˆMemoryï¼‰</h2>
<p>è®°å¿†ï¼ˆMemoryï¼‰çš„ä½œç”¨å°±æ˜¯åœ¨å¯¹è¯è¿‡ç¨‹ä¸­ï¼Œè®°å½•ä¹‹å‰çš„å¯¹è¯å†å²ï¼Œä»¥ä¾¿åç»­çš„å¯¹è¯å¯ä»¥åŸºäºä¹‹å‰çš„å¯¹è¯å†å²è¿›è¡Œç”Ÿæˆæˆ–å›ç­”</p>
<p>ä¾‹å¦‚æˆ‘ä»¬æ—¥å¸¸åœ¨è±†åŒ…ä¹‹ç±»çš„åº”ç”¨ä¸­å¯¹è¯ï¼Œå®ƒä¼šè®°å½•ä¹‹å‰çš„å¯¹è¯å†…å®¹ï¼Œå¹¶æ ¹æ®å¯¹è¯å†…å®¹å’Œä¹‹å‰çš„è®°å½•ä¸æ–­è°ƒæ•´è‡ªå·±çš„å›ç­”</p>
<h3 data-id="heading-2">å¯¹è¯ç¼“å†²è®°å¿†ï¼ˆConversation Buffer Memoryï¼‰</h3>
<p>ç±»ä¼¼å¾®ä¿¡çš„èŠå¤©è®°å½•ï¼ŒæŠŠæ¯ä¸€å¥è¯éƒ½å®Œæ•´ä¿å­˜ä¸‹æ¥ï¼Œä»€ä¹ˆæ—¶å€™æƒ³çœ‹éƒ½èƒ½ç¿»åˆ°</p>
<p>ä¾‹å¦‚ä¸‹é¢åˆ›å»ºå¯¹è¯å†å²åï¼Œå°†èŠå¤©å†…å®¹éƒ½ä¿å­˜åˆ°äº† <code>chat_history</code> ä¸­</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-comment"># åˆ›å»ºå¯¹è¯å†å²</span>
    chat_history = InMemoryChatMessageHistory()
    
    <span class="hljs-comment"># æ·»åŠ å¯¹è¯å†å²</span>
    chat_history.add_user_message(<span class="hljs-string">"ä½ å¥½"</span>)
    chat_history.add_ai_message(<span class="hljs-string">"ä½ å¥½ï¼æˆ‘æ˜¯Qwenï¼Œå¾ˆé«˜å…´è§åˆ°ä½ ï¼"</span>)
    chat_history.add_user_message(<span class="hljs-string">"ä½ å«ä»€ä¹ˆåå­—ï¼Ÿ"</span>)
    chat_history.add_ai_message(<span class="hljs-string">"æˆ‘æ˜¯Qwenï¼Œä¸€ä¸ªç”±é˜¿é‡Œäº‘å¼€å‘çš„å¤§è¯­è¨€æ¨¡å‹ã€‚"</span>)
  
</code></pre>
<p>æŸ¥çœ‹çš„æ—¶å€™ï¼Œéå† <code>chat_history.messages</code> æ‰“å°å‡ºæ‰€æœ‰çš„å¯¹è¯å†å²</p>
<pre><code class="hljs language-python" lang="python">    <span class="hljs-comment"># æŸ¥çœ‹è®°å¿†ä¸­çš„å¯¹è¯å†å²</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å½“å‰å¯¹è¯å†å²:"</span>)
    <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> chat_history.messages:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-built_in">type</span>(msg).__name__}</span>: <span class="hljs-subst">{msg.content}</span>"</span>)
</code></pre>
<h3 data-id="heading-3">å¯¹è¯çª—å£è®°å¿†ï¼ˆConversation Buffer Window Memoryï¼‰</h3>
<p>å¯¹è¯çª—å£è®°å¿†æ˜¯ä¸€ç§åªä¿ç•™æœ€è¿‘Nè½®å¯¹è¯çš„è®°å¿†æœºåˆ¶ï¼Œå°±åƒä¸€ä¸ªåªèƒ½è£…å›ºå®šæ•°é‡æ¶ˆæ¯çš„"æ»‘åŠ¨çª—å£"ï¼Œå½“æ–°çš„æ¶ˆæ¯è¿›æ¥æ—¶ï¼Œæ—§çš„æ¶ˆæ¯ä¼šè¢«æŒ¤å‡ºçª—å£ï¼Œæ–°çš„æ¶ˆæ¯ä¼šè¿›å…¥çª—å£</p>
<p>è¿™ç§æ–¹å¼çš„ä¼˜åŠ¿æ˜¯æœ‰æ•ˆæ§åˆ¶å†…å­˜ï¼Œåªè®°å½•æœ€è¿‘çš„æ¶ˆæ¯ï¼Œæ›´ç¬¦åˆå®é™…æƒ…å†µï¼Œå¤„ç†æ¶ˆæ¯æ•°é‡å›ºå®šï¼Œå“åº”æ›´å¿«</p>
<p>å¦‚ä¸‹é¢é€šè¿‡è®¾ç½® <code>window_size</code> ä¸º 4ï¼Œå°±å¯ä»¥åªä¿ç•™æœ€è¿‘çš„ 2 è½®å¯¹è¯ï¼ˆ4 æ¡æ¶ˆæ¯ï¼‰</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">demo_conversation_window</span>():
    <span class="hljs-string">"""æ¼”ç¤ºæ»‘åŠ¨çª—å£è®°å¿†"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== æ»‘åŠ¨çª—å£è®°å¿† ==="</span>)
    
    <span class="hljs-comment"># åˆ›å»ºå¯¹è¯å†å²</span>
    chat_history = InMemoryChatMessageHistory()
    
    <span class="hljs-comment"># æ·»åŠ å¤šè½®å¯¹è¯</span>
    conversations = [
        (<span class="hljs-string">"æˆ‘çš„åå­—æ˜¯å¼ ä¸‰"</span>, <span class="hljs-string">"ä½ å¥½ï¼Œå¼ ä¸‰ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚"</span>),
        (<span class="hljs-string">"æˆ‘ä»Šå¹´25å²"</span>, <span class="hljs-string">"25å²æ˜¯ä¸ªå¾ˆå¥½çš„å¹´çºªï¼"</span>),
        (<span class="hljs-string">"æˆ‘ä½åœ¨åŒ—äº¬"</span>, <span class="hljs-string">"åŒ—äº¬æ˜¯ä¸ªç¾ä¸½çš„åŸå¸‚ï¼"</span>)
    ]
    
    <span class="hljs-keyword">for</span> user_msg, ai_msg <span class="hljs-keyword">in</span> conversations:
        chat_history.add_user_message(user_msg)
        chat_history.add_ai_message(ai_msg)
    
    <span class="hljs-comment"># å®ç°æ»‘åŠ¨çª—å£ - åªä¿ç•™æœ€è¿‘çš„2è½®å¯¹è¯ï¼ˆ4æ¡æ¶ˆæ¯ï¼‰</span>
    window_size = <span class="hljs-number">4</span>  <span class="hljs-comment"># 2è½®å¯¹è¯ = 4æ¡æ¶ˆæ¯</span>
    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(chat_history.messages) &gt; window_size:
        <span class="hljs-comment"># ä¿ç•™æœ€åwindow_sizeæ¡æ¶ˆæ¯</span>
        recent_messages = chat_history.messages[-window_size:]
        chat_history.clear()
        <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> recent_messages:
            <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(msg, HumanMessage):
                chat_history.add_user_message(msg.content)
            <span class="hljs-keyword">else</span>:
                chat_history.add_ai_message(msg.content)
    
    <span class="hljs-comment"># æŸ¥çœ‹å½“å‰è®°å¿†ä¸­çš„å¯¹è¯ï¼ˆåº”è¯¥åªä¿ç•™æœ€è¿‘2è½®ï¼‰</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å½“å‰å¯¹è¯å†å²ï¼ˆæ»‘åŠ¨çª—å£ï¼‰:"</span>)
    <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> chat_history.messages:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-built_in">type</span>(msg).__name__}</span>: <span class="hljs-subst">{msg.content}</span>"</span>)

</code></pre>
<h3 data-id="heading-4">å¯¹è¯æ‘˜è¦è®°å¿†ï¼ˆConversation Summary Memoryï¼‰</h3>
<p>å¯¹è¯æ‘˜è¦è®°å¿†æ˜¯ä¸€ç§å°†é•¿å¯¹è¯å‹ç¼©æˆç®€æ´æ‘˜è¦çš„è®°å¿†æœºåˆ¶ï¼Œå°±åƒç»™å¯¹è¯å†™"è¯»ä¹¦ç¬”è®°"ä¸€æ ·ï¼Œåªè®°å½•é‡è¦ä¿¡æ¯</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">demo_conversation_summary</span>():
    <span class="hljs-string">"""æ¼”ç¤ºå¯¹è¯æ‘˜è¦è®°å¿†"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== å¯¹è¯æ‘˜è¦è®°å¿† ==="</span>)
    
    <span class="hljs-comment"># åˆ›å»ºå¯¹è¯å†å²</span>
    chat_history = InMemoryChatMessageHistory()
    
    <span class="hljs-comment"># æ·»åŠ å¤šè½®å¯¹è¯</span>
    conversations = [
        (<span class="hljs-string">"æˆ‘æœ€è¿‘åœ¨å­¦ä¹ äººå·¥æ™ºèƒ½"</span>, <span class="hljs-string">"å¤ªæ£’äº†ï¼äººå·¥æ™ºèƒ½æ˜¯ä¸€ä¸ªå¾ˆæœ‰å‰æ™¯çš„é¢†åŸŸã€‚"</span>),
        (<span class="hljs-string">"ç‰¹åˆ«æ˜¯å¤§è¯­è¨€æ¨¡å‹è®©æˆ‘å¾ˆæ„Ÿå…´è¶£"</span>, <span class="hljs-string">"æ˜¯çš„ï¼Œå¤§è¯­è¨€æ¨¡å‹æ­£åœ¨æ”¹å˜æˆ‘ä»¬ä¸æŠ€æœ¯äº¤äº’çš„æ–¹å¼ã€‚"</span>)
    ]
    
    <span class="hljs-keyword">for</span> user_msg, ai_msg <span class="hljs-keyword">in</span> conversations:
        chat_history.add_user_message(user_msg)
        chat_history.add_ai_message(ai_msg)
    
    <span class="hljs-comment"># ç”Ÿæˆæ‘˜è¦</span>
    summary_prompt = ChatPromptTemplate.from_template(
        <span class="hljs-string">"è¯·æ€»ç»“ä»¥ä¸‹å¯¹è¯çš„ä¸»è¦å†…å®¹ï¼š\n{conversation}"</span>
    )
    
    conversation_text = <span class="hljs-string">"\n"</span>.join([
        <span class="hljs-string">f"ç”¨æˆ·: <span class="hljs-subst">{msg.content}</span>"</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(msg, HumanMessage) <span class="hljs-keyword">else</span> <span class="hljs-string">f"AI: <span class="hljs-subst">{msg.content}</span>"</span>
        <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> chat_history.messages
    ])
    
    summary_chain = summary_prompt | chat_llm | StrOutputParser()
    summary = summary_chain.invoke({<span class="hljs-string">"conversation"</span>: conversation_text})
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"å½“å‰å¯¹è¯æ‘˜è¦: <span class="hljs-subst">{summary}</span>"</span>)
    
    <span class="hljs-comment"># ä½¿ç”¨æ‘˜è¦è¿›è¡Œå¯¹è¯</span>
    prompt = ChatPromptTemplate.from_messages([
        (<span class="hljs-string">"system"</span>, <span class="hljs-string">f"ä½ æ˜¯ä¸€ä¸ªä¹äºåŠ©äººçš„AIåŠ©æ‰‹ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬å¯¹è¯çš„æ‘˜è¦ï¼š<span class="hljs-subst">{summary}</span>"</span>),
        (<span class="hljs-string">"human"</span>, <span class="hljs-string">"{input}"</span>),
    ])
    
    chain = prompt | chat_llm | StrOutputParser()
    response = chain.invoke({<span class="hljs-string">"input"</span>: <span class="hljs-string">"æˆ‘åˆšæ‰æåˆ°äº†ä»€ä¹ˆå†…å®¹ï¼Ÿ"</span>})
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\nAIå›å¤: <span class="hljs-subst">{response}</span>"</span>)

</code></pre>
<p>æ‘˜è¦è®°å¿†çš„æµç¨‹ï¼šå®Œæ•´å¯¹è¯ â†’ AIåˆ†ææ€»ç»“ â†’ ç®€æ´æ‘˜è¦ â†’ å­˜å‚¨æ‘˜è¦</p>
<p>çœ‹ä¸‹åŸå§‹å¯¹è¯ï¼ˆé•¿ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ç”¨æˆ·: æˆ‘æœ€è¿‘åœ¨å­¦ä¹ äººå·¥æ™ºèƒ½
AI: å¤ªæ£’äº†ï¼äººå·¥æ™ºèƒ½æ˜¯ä¸€ä¸ªå¾ˆæœ‰å‰æ™¯çš„é¢†åŸŸã€‚
ç”¨æˆ·: ç‰¹åˆ«æ˜¯å¤§è¯­è¨€æ¨¡å‹è®©æˆ‘å¾ˆæ„Ÿå…´è¶£
AI: æ˜¯çš„ï¼Œå¤§è¯­è¨€æ¨¡å‹æ­£åœ¨æ”¹å˜æˆ‘ä»¬ä¸æŠ€æœ¯äº¤äº’çš„æ–¹å¼ã€‚
</code></pre>
<p>ç”Ÿæˆçš„æ‘˜è¦ï¼ˆçŸ­ï¼‰</p>
<pre><code class="hljs language-bash" lang="bash">ç”¨æˆ·æœ€è¿‘å¼€å§‹å­¦ä¹ äººå·¥æ™ºèƒ½ï¼Œç‰¹åˆ«æ˜¯å¯¹å¤§è¯­è¨€æ¨¡å‹å¾ˆæ„Ÿå…´è¶£ã€‚AIå¯¹æ­¤è¡¨ç¤ºæ”¯æŒï¼Œå¹¶æŒ‡å‡ºå¤§è¯­è¨€æ¨¡å‹åœ¨æ”¹å˜æŠ€æœ¯äº¤äº’æ–¹å¼æ–¹é¢çš„é‡è¦æ€§ã€‚
</code></pre>
<h3 data-id="heading-5">ç»„åˆè®°å¿†ï¼ˆCombined Memoryï¼‰</h3>
<p>ç»„åˆè®°å¿†æ˜¯å°†æ»‘åŠ¨çª—å£è®°å¿†å’Œå¯¹è¯æ‘˜è¦è®°å¿†ç»“åˆèµ·æ¥ï¼Œå®ç°æ›´çµæ´»çš„è®°å¿†ç®¡ç†ã€‚å°±åƒåŒæ—¶æ‹¥æœ‰"è¯¦ç»†æ—¥è®°"å’Œ"é‡ç‚¹æ‘˜è¦"ä¸¤ç§è®°å½•æ–¹å¼ï¼Œæ—¢èƒ½ä¿ç•™è¯¦ç»†çš„å¯¹è¯å†…å®¹ï¼Œåˆèƒ½å¿«é€Ÿæ€»ç»“é‡è¦ä¿¡æ¯</p>
<p>ä¾‹å¦‚ä¸€ä¸ªå­¦ä¹ å¥½çš„å­¦ç”Ÿè®°ç¬”è®°ï¼Œè¯¦ç»†è®°å½•æ¯æ¬¡å­¦ä¹ å†…å®¹ï¼Œæ¯ä¸ªä¾‹å­ï¼›æ€»ç»“å­¦ä¹ çš„ç« èŠ‚é‡ç‚¹ï¼›ä¸“é—¨è®°å½•å­¦ä¹ ä¸­é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ³•ç­‰</p>
<p>ä¾‹å¦‚ä¸‹é¢çš„ä»£ç åˆ†åˆ«ä½¿ç”¨ <code>conv_history</code> å’Œ <code>summary_history</code> æ¥å­˜å‚¨å¯¹è¯å†å²å’Œæ‘˜è¦å†å²</p>
<pre><code class="hljs language-python" lang="python">
<span class="hljs-keyword">def</span> <span class="hljs-title function_">demo_combined_memory</span>():
    <span class="hljs-string">"""æ¼”ç¤ºç»„åˆè®°å¿†"""</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n=== ç»„åˆè®°å¿† ==="</span>)
    
    <span class="hljs-comment"># åˆ›å»ºä¸åŒç±»å‹çš„å¯¹è¯å†å²</span>
    conv_history = InMemoryChatMessageHistory()
    summary_history = InMemoryChatMessageHistory()
    
    <span class="hljs-comment"># æ·»åŠ å¯¹è¯</span>
    conversations = [
        (<span class="hljs-string">"æˆ‘è®¡åˆ’ä¸‹å‘¨å»ä¸Šæµ·æ—…æ¸¸"</span>, <span class="hljs-string">"ä¸Šæµ·æ˜¯ä¸ªå¾ˆæ£’çš„åŸå¸‚ï¼"</span>),
        (<span class="hljs-string">"æœ‰ä»€ä¹ˆæ¨èçš„åœ°æ–¹å—ï¼Ÿ"</span>, <span class="hljs-string">"å¤–æ»©ã€ä¸œæ–¹æ˜ç ã€åŸéšåº™éƒ½å¾ˆå€¼å¾—ä¸€å»ã€‚"</span>)
    ]
    
    <span class="hljs-keyword">for</span> user_msg, ai_msg <span class="hljs-keyword">in</span> conversations:
        conv_history.add_user_message(user_msg)
        conv_history.add_ai_message(ai_msg)
    
    <span class="hljs-comment"># ç”Ÿæˆæ‘˜è¦</span>
    conversation_text = <span class="hljs-string">"\n"</span>.join([
        <span class="hljs-string">f"ç”¨æˆ·: <span class="hljs-subst">{msg.content}</span>"</span> <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(msg, HumanMessage) <span class="hljs-keyword">else</span> <span class="hljs-string">f"AI: <span class="hljs-subst">{msg.content}</span>"</span>
        <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> conv_history.messages
    ])
    
    summary_prompt = ChatPromptTemplate.from_template(
        <span class="hljs-string">"è¯·æ€»ç»“ä»¥ä¸‹å¯¹è¯çš„ä¸»è¦å†…å®¹ï¼š\n{conversation}"</span>
    )
    
    summary_chain = summary_prompt | chat_llm | StrOutputParser()
    summary = summary_chain.invoke({<span class="hljs-string">"conversation"</span>: conversation_text})
    summary_history.add_ai_message(summary)
    
    <span class="hljs-comment"># æŸ¥çœ‹ç»„åˆè®°å¿†</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"å¯¹è¯è®°å¿†å†…å®¹:"</span>)
    <span class="hljs-keyword">for</span> msg <span class="hljs-keyword">in</span> conv_history.messages:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">f"<span class="hljs-subst">{<span class="hljs-built_in">type</span>(msg).__name__}</span>: <span class="hljs-subst">{msg.content}</span>"</span>)
    
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"\næ‘˜è¦è®°å¿†å†…å®¹: <span class="hljs-subst">{summary}</span>"</span>)
</code></pre>
<p>ç»„åˆè®°å¿†é€‚åˆé‚£ç§å³éœ€è¦è¯¦ç»†è®°å½•æœ‰éœ€è¦å¿«é€Ÿå“åº”çš„åœºæ™¯ï¼Œä¾‹å¦‚é”€å”®å®¢æœä¹‹ç±»çš„ï¼Œå®¢æˆ·çš„é—®é¢˜éœ€è¦åŠæ—¶å“åº”ï¼Œä¹Ÿéœ€è¦è¯¦ç»†è®°å½•èŠå¤©è¿‡ç¨‹ï¼Œç”¨äºåç»­çš„åˆ†æ</p>
<h2 data-id="heading-6">å°ç»“</h2>
<p>ç›´æ¥çœ‹å®˜ç½‘æ–‡æ¡£ç›¸å…³å†…å®¹çœ‹çš„äº‘é‡Œé›¾é‡Œçš„ï¼Œè¿˜æ˜¯éœ€è¦ç»“åˆä»£ç å’Œå®é™…ä¾‹å­å»çœ‹ï¼Œåœ¨æœ¬åœ°è¿è¡Œä»£ç çœ‹çœ‹è¾“å‡ºç»“æœï¼Œèµ·ç æˆ‘ä»¬ç°åœ¨æ˜¯æ—¥å¸¸ç»å¸¸ç”¨AIå·¥å…·ï¼Œç»“åˆæ—¥å¸¸ä½¿ç”¨ä¸­é‡åˆ°çš„ä¸€äº›åœºæ™¯åˆ†æï¼Œç›¸å¯¹ä¼šæ›´å¥½ç†è§£ä¸€ç‚¹</p>
<p>AIè½¬å‹é•¿è·¯æ¼«æ¼«ï¼ŒåŠ æ²¹ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot + RabbitMQ + äº‹åŠ¡çŠ¶æ€æœº å®ç°ç”µå•†è®¢å•è¶…æ—¶è‡ªåŠ¨å…³å•]]></title>    <link>https://juejin.cn/post/7597058147748921354</link>    <guid>https://juejin.cn/post/7597058147748921354</guid>    <pubDate>2026-01-20T08:35:43.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597058147748921354" data-draft-id="7597080391879983114" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot + RabbitMQ + äº‹åŠ¡çŠ¶æ€æœº å®ç°ç”µå•†è®¢å•è¶…æ—¶è‡ªåŠ¨å…³å•"/> <meta itemprop="keywords" content="åç«¯,RabbitMQ"/> <meta itemprop="datePublished" content="2026-01-20T08:35:43.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸‰æ°´ä¸æ»´"/> <meta itemprop="url" content="https://juejin.cn/user/283045639753100"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot + RabbitMQ + äº‹åŠ¡çŠ¶æ€æœº å®ç°ç”µå•†è®¢å•è¶…æ—¶è‡ªåŠ¨å…³å•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/283045639753100/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸‰æ°´ä¸æ»´
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:35:43.000Z" title="Tue Jan 20 2026 08:35:43 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»12åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç”µå•†è®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆï¼šSpringBoot + RabbitMQ é«˜å¯é å®ç°æ–¹æ¡ˆ</h2>
<p>åœ¨ç”µå•†ç³»ç»Ÿä¸­ï¼Œè®¢å•è¶…æ—¶æœªæ”¯ä»˜è‡ªåŠ¨å–æ¶ˆæ˜¯æ ¸å¿ƒåœºæ™¯ä¹‹ä¸€ â€”â€” ç”¨æˆ·åˆ›å»ºè®¢å•åè‹¥é•¿æ—¶é—´æœªä»˜æ¬¾ï¼Œéœ€é‡Šæ”¾åº“å­˜ã€è§£å†»ä¼˜æƒ åˆ¸ï¼Œé¿å…èµ„æºå ç”¨ã€‚ä¼ ç»Ÿå®šæ—¶è½®è¯¢ï¼ˆå¦‚ Quartzï¼‰å­˜åœ¨èµ„æºæ¶ˆè€—å¤§ã€å®æ—¶æ€§å·®ã€å¹¶å‘èƒ½åŠ›å¼±ç­‰é—®é¢˜ï¼Œè€ŒåŸºäºæ¶ˆæ¯é˜Ÿåˆ—çš„å»¶æ—¶é€šçŸ¥æ–¹æ¡ˆèƒ½å®Œç¾è§£å†³è¿™äº›ç—›ç‚¹ã€‚æœ¬æ–‡å°†è¯¦ç»†æ‹†è§£ <strong>SpringBoot + RabbitMQ + äº‹åŠ¡çŠ¶æ€æœº</strong> çš„å®ç°æ–¹æ¡ˆï¼Œæä¾›æ›´è½»é‡ã€æ˜“éƒ¨ç½²çš„é«˜å¯é è§£å†³æ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-1">ä¸€ã€ä¼ ç»Ÿæ–¹æ¡ˆç—›ç‚¹ä¸æŠ€æœ¯é€‰å‹</h3>
<h4 data-id="heading-2">1. ä¼ ç»Ÿå®šæ—¶è½®è¯¢çš„ä¸‰å¤§é—®é¢˜</h4>
<ul>
<li>èµ„æºæµªè´¹ï¼šæ— è®ºè®¢å•æ˜¯å¦æ”¯ä»˜ï¼Œå®šæ—¶ä»»åŠ¡éœ€å…¨é‡æ‰«æè®¢å•è¡¨ï¼Œæ•°æ®åº“å‹åŠ›éšè®¢å•é‡çº¿æ€§å¢é•¿ï¼›</li>
<li>å®æ—¶æ€§å·®ï¼šè½®è¯¢é—´éš”å†³å®šå»¶è¿Ÿï¼ˆå¦‚ 5 åˆ†é’Ÿè½®è¯¢ï¼Œæœ€å¤§å»¶è¿Ÿå¯è¾¾ 5 åˆ†é’Ÿï¼‰ï¼Œå½±å“åº“å­˜å‘¨è½¬æ•ˆç‡ï¼›</li>
<li>å¹¶å‘é£é™©ï¼šé«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¤šä»»åŠ¡åŒæ—¶å¤„ç†åŒä¸€è®¢å•å¯èƒ½å¯¼è‡´çŠ¶æ€ä¸ä¸€è‡´ã€‚</li>
</ul>
<h4 data-id="heading-3">2. æŠ€æœ¯é€‰å‹ä¸æ ¸å¿ƒä¼˜åŠ¿</h4>





























<table><thead><tr><th>ç»„ä»¶</th><th>é€‰å‹ç†ç”±</th></tr></thead><tbody><tr><td>å¼€å‘æ¡†æ¶</td><td>SpringBootï¼ˆå¿«é€Ÿæ•´åˆç»„ä»¶ï¼Œç®€åŒ–é…ç½®ï¼Œé™ä½å¼€å‘æˆæœ¬ï¼‰</td></tr><tr><td>æ¶ˆæ¯é˜Ÿåˆ—</td><td>RabbitMQï¼ˆæ”¯æŒå»¶æ—¶é˜Ÿåˆ—ã€æ­»ä¿¡äº¤æ¢æœºï¼Œéƒ¨ç½²è½»é‡ï¼Œç”Ÿæ€æˆç†Ÿï¼Œæ”¯æŒå¤šç§æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼‰</td></tr><tr><td>çŠ¶æ€ç®¡ç†</td><td>äº‹åŠ¡çŠ¶æ€æœºï¼ˆæ˜ç¡®è®¢å•çŠ¶æ€è½¬æ¢è§„åˆ™ï¼Œé˜²æ­¢éæ³•çŠ¶æ€å˜æ›´ï¼Œä¿éšœä¸€è‡´æ€§ï¼‰</td></tr><tr><td>å¹¶å‘æ§åˆ¶</td><td>ä¹è§‚é”ï¼ˆåŸºäºæ•°æ®åº“ç‰ˆæœ¬å·ï¼Œå®ç°åŸå­åŒ–çŠ¶æ€æ›´æ–°ï¼Œé¿å…å¹¶å‘å†²çªï¼‰</td></tr><tr><td>å¯é æ€§ä¿éšœ</td><td>ç”Ÿäº§è€…ç¡®è®¤ + æ¶ˆæ¯æŒä¹…åŒ– + æ¶ˆè´¹è€…æ‰‹åŠ¨ ACK + å¹‚ç­‰å¤„ç†ï¼ˆç¡®ä¿æ¶ˆæ¯ä¸ä¸¢å¤±ã€ä¸é‡å¤å¤„ç†ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-4">3. RabbitMQ å»¶æ—¶é˜Ÿåˆ—åŸç†</h4>
<p>RabbitMQ æœ¬èº«ä¸ç›´æ¥æ”¯æŒå»¶æ—¶é˜Ÿåˆ—ï¼Œä½†å¯é€šè¿‡ã€Œ<strong>æ­»ä¿¡äº¤æ¢æœºï¼ˆDLXï¼‰+ æ¶ˆæ¯è¿‡æœŸæ—¶é—´ï¼ˆTTLï¼‰</strong> ã€é—´æ¥å®ç°ï¼š</p>
<ol>
<li>è®¢å•åˆ›å»ºæ—¶ï¼Œæ¶ˆæ¯å‘é€è‡³ã€Œå»¶æ—¶äº¤æ¢æœºã€ç»‘å®šçš„ã€Œå»¶æ—¶é˜Ÿåˆ—ã€ï¼Œè®¾ç½® 30 åˆ†é’Ÿï¼ˆè®¢å•è¶…æ—¶æ—¶é—´ï¼‰TTLï¼›</li>
<li>æ¶ˆæ¯åœ¨å»¶æ—¶é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼ŒæœŸé—´ä¸ä¼šè¢«æ¶ˆè´¹è€…æ¶ˆè´¹ï¼›</li>
<li>æ¶ˆæ¯è¿‡æœŸåï¼ŒRabbitMQ è‡ªåŠ¨å°†å…¶è·¯ç”±è‡³ç»‘å®šçš„ã€Œæ­»ä¿¡äº¤æ¢æœºã€ï¼›</li>
<li>ã€Œæ­»ä¿¡äº¤æ¢æœºã€å°†æ¶ˆæ¯è½¬å‘è‡³ã€Œå–æ¶ˆè®¢å•é˜Ÿåˆ—ã€ï¼Œæ¶ˆè´¹è€…ç›‘å¬è¯¥é˜Ÿåˆ—å¹¶æ‰§è¡Œå–æ¶ˆé€»è¾‘ã€‚</li>
</ol>
<p>æ ¸å¿ƒæµç¨‹ç¤ºæ„å›¾ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">è®¢å•åˆ›å»º â†’ å‘é€æ¶ˆæ¯ï¼ˆ<span class="hljs-attr">TTL</span>=<span class="hljs-number">30</span>åˆ†é’Ÿï¼‰â†’ å»¶æ—¶é˜Ÿåˆ—ï¼ˆç­‰å¾…è¿‡æœŸï¼‰â†’ æ­»ä¿¡äº¤æ¢æœº â†’ å–æ¶ˆè®¢å•é˜Ÿåˆ— â†’ æ¶ˆè´¹è€…æ‰§è¡Œå–æ¶ˆé€»è¾‘
</code></pre>
<h3 data-id="heading-5">äºŒã€æ ¸å¿ƒæ¶æ„ä¸æµç¨‹è®¾è®¡</h3>
<h4 data-id="heading-6">1. æ•´ä½“æ¶æ„</h4>
<pre><code class="hljs">ç”¨æˆ· â†’ è®¢å•ç³»ç»Ÿï¼ˆåˆ›å»ºè®¢å•ï¼‰â†’ å‘é€å»¶æ—¶æ¶ˆæ¯ â†’ RabbitMQï¼ˆå»¶æ—¶é˜Ÿåˆ—+æ­»ä¿¡äº¤æ¢æœºï¼‰â†’ å–æ¶ˆè®¢å•æ¶ˆè´¹è€… â†’ è®¢å•çŠ¶æ€æ›´æ–°ï¼ˆä¹è§‚é”ï¼‰â†’ é‡Šæ”¾èµ„æºï¼ˆåº“å­˜/ä¼˜æƒ åˆ¸ï¼‰
</code></pre>
<h4 data-id="heading-7">2. è®¢å•çŠ¶æ€æœºè®¾è®¡</h4>
<p>ä¸ºä¿éšœçŠ¶æ€ä¸€è‡´æ€§ï¼Œå®šä¹‰è®¢å•æ ¸å¿ƒçŠ¶æ€åŠåˆæ³•è½¬æ¢è§„åˆ™ï¼Œé˜²æ­¢éæ³•çŠ¶æ€å˜æ›´ï¼š</p>
<ul>
<li>
<p>æ ¸å¿ƒçŠ¶æ€ï¼š<code>CREATED</code>ï¼ˆå·²åˆ›å»ºï¼‰ã€<code>PAID</code>ï¼ˆå·²æ”¯ä»˜ï¼‰ã€<code>CANCELLED</code>ï¼ˆå·²å–æ¶ˆï¼‰ã€<code>COMPLETED</code>ï¼ˆå·²å®Œæˆï¼‰ã€<code>CLOSED</code>ï¼ˆå·²å…³é—­ï¼‰</p>
</li>
<li>
<p>åˆæ³•çŠ¶æ€è½¬æ¢ï¼š</p>
<ul>
<li><code>CREATED â†’ PAID</code>ï¼ˆç”¨æˆ·ä»˜æ¬¾ï¼‰</li>
<li><code>CREATED â†’ CANCELLED</code>ï¼ˆè¶…æ—¶æœªæ”¯ä»˜ / ç”¨æˆ·ä¸»åŠ¨å–æ¶ˆï¼‰</li>
<li><code>PAID â†’ COMPLETED</code>ï¼ˆå•†å®¶å‘è´§å®Œæˆï¼‰</li>
<li><code>PAID/CANCELLED â†’ CLOSED</code>ï¼ˆç³»ç»Ÿå¼ºåˆ¶å…³é—­ï¼‰</li>
</ul>
</li>
<li>
<p>å®ç°æ–¹å¼ï¼šé€šè¿‡æšä¸¾ç±»å®šä¹‰çŠ¶æ€ï¼Œä¸šåŠ¡ä»£ç ä¸­æ ¡éªŒè½¬æ¢åˆæ³•æ€§ï¼Œç»“åˆæ•°æ®åº“çº¦æŸé˜²æ­¢è„å†™ã€‚</p>
</li>
</ul>
<h4 data-id="heading-8">3. æ ¸å¿ƒæµç¨‹æ‹†è§£</h4>
<ol>
<li><strong>è®¢å•åˆ›å»º</strong>ï¼šç”¨æˆ·æäº¤è®¢å•åï¼Œè®¢å•çŠ¶æ€è®¾ä¸º<code>CREATED</code>ï¼Œé”å®šåº“å­˜å’Œä¼˜æƒ åˆ¸ï¼ŒåŒæ—¶å‘é€ 30 åˆ†é’Ÿå»¶æ—¶æ¶ˆæ¯ï¼›</li>
<li><strong>å»¶æ—¶æ¶ˆæ¯ç­‰å¾…</strong>ï¼šæ¶ˆæ¯åœ¨ RabbitMQ å»¶æ—¶é˜Ÿåˆ—ä¸­ç­‰å¾…è¿‡æœŸï¼ŒæœŸé—´è‹¥ç”¨æˆ·æ”¯ä»˜ï¼Œæ›´æ–°è®¢å•çŠ¶æ€ä¸º<code>PAID</code>ï¼Œåç»­å–æ¶ˆé€»è¾‘å°†è·³è¿‡ï¼›</li>
<li><strong>æ¶ˆæ¯è¿‡æœŸè§¦å‘</strong>ï¼š30 åˆ†é’Ÿåæ¶ˆæ¯è¿‡æœŸï¼Œè¿›å…¥æ­»ä¿¡äº¤æ¢æœºï¼Œè·¯ç”±è‡³å–æ¶ˆè®¢å•é˜Ÿåˆ—ï¼›</li>
<li><strong>å–æ¶ˆé€»è¾‘æ‰§è¡Œ</strong>ï¼šæ¶ˆè´¹è€…ç›‘å¬å–æ¶ˆè®¢å•é˜Ÿåˆ—ï¼ŒæŸ¥è¯¢è®¢å•å½“å‰çŠ¶æ€ â€”â€” è‹¥ä»ä¸º<code>CREATED</code>ï¼Œåˆ™é€šè¿‡ä¹è§‚é”æ›´æ–°ä¸º<code>CANCELLED</code>ï¼Œé‡Šæ”¾åº“å­˜å’Œä¼˜æƒ åˆ¸ï¼›è‹¥å·²æ”¯ä»˜ï¼Œåˆ™ç›´æ¥å¿½ç•¥ã€‚</li>
</ol>
<h3 data-id="heading-9">ä¸‰ã€RabbitMQ æ ¸å¿ƒé…ç½®å®ç°</h3>
<h4 data-id="heading-10">1. ä¾èµ–å¼•å…¥</h4>
<p>åœ¨<code>pom.xml</code>ä¸­æ·»åŠ  SpringBoot ä¸ RabbitMQ çš„æ•´åˆä¾èµ–ï¼š</p>
<p>xml</p>
<pre><code class="hljs language-xml" lang="xml">&lt;<span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- SpringBootæ ¸å¿ƒä¾èµ– --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- RabbitMQä¾èµ– --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- æ•°æ®åº“ä¾èµ– --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.3.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å·¥å…·ç±» --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>5.8.20<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
&lt;/<span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span>
</code></pre>
<h4 data-id="heading-11">2. RabbitMQ å»¶æ—¶é˜Ÿåˆ—é…ç½®</h4>
<p>é€šè¿‡ Java ä»£ç é…ç½®å»¶æ—¶äº¤æ¢æœºã€å»¶æ—¶é˜Ÿåˆ—ã€æ­»ä¿¡äº¤æ¢æœºã€å–æ¶ˆè®¢å•é˜Ÿåˆ—ï¼Œæ˜ç¡®ç»‘å®šå…³ç³»ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Configuration</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RabbitMQDelayConfig</span> {

    <span class="hljs-comment">// äº¤æ¢æœºåç§°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DELAY_EXCHANGE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.delay.exchange"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DEAD_LETTER_EXCHANGE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.dead.letter.exchange"</span>;

    <span class="hljs-comment">// é˜Ÿåˆ—åç§°</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DELAY_QUEUE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.delay.queue"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">CANCEL_QUEUE</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.cancel.queue"</span>;

    <span class="hljs-comment">// è·¯ç”±é”®</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DELAY_ROUTING_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.delay.routingKey"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DEAD_LETTER_ROUTING_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order.dead.letter.routingKey"</span>;

    <span class="hljs-comment">// è®¢å•è¶…æ—¶æ—¶é—´ï¼ˆ30åˆ†é’Ÿï¼Œå•ä½ï¼šæ¯«ç§’ï¼‰</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">ORDER_TIMEOUT</span> <span class="hljs-operator">=</span> <span class="hljs-number">30</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>;

    <span class="hljs-comment">/**
     * å»¶æ—¶äº¤æ¢æœºï¼ˆæ‰‡å½¢äº¤æ¢æœºï¼Œå¹¿æ’­æ¶ˆæ¯ï¼‰
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> FanoutExchange <span class="hljs-title function_">delayExchange</span><span class="hljs-params">()</span> {
        <span class="hljs-comment">// durable=trueï¼šäº¤æ¢æœºæŒä¹…åŒ–ï¼Œé‡å¯åä¸ä¸¢å¤±</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FanoutExchange</span>(DELAY_EXCHANGE, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>);
    }

    <span class="hljs-comment">/**
     * æ­»ä¿¡äº¤æ¢æœºï¼ˆç›´æ¥äº¤æ¢æœºï¼Œç²¾å‡†è·¯ç”±ï¼‰
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> DirectExchange <span class="hljs-title function_">deadLetterExchange</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DirectExchange</span>(DEAD_LETTER_EXCHANGE, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>);
    }

    <span class="hljs-comment">/**
     * å»¶æ—¶é˜Ÿåˆ—ï¼šç»‘å®šæ­»ä¿¡äº¤æ¢æœºï¼Œè®¾ç½®æ¶ˆæ¯è¿‡æœŸæ—¶é—´
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">delayQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> QueueBuilder.durable(DELAY_QUEUE)
                <span class="hljs-comment">// ç»‘å®šæ­»ä¿¡äº¤æ¢æœº</span>
                .withArgument(<span class="hljs-string">"x-dead-letter-exchange"</span>, DEAD_LETTER_EXCHANGE)
                <span class="hljs-comment">// ç»‘å®šæ­»ä¿¡è·¯ç”±é”®</span>
                .withArgument(<span class="hljs-string">"x-dead-letter-routing-key"</span>, DEAD_LETTER_ROUTING_KEY)
                <span class="hljs-comment">// è®¾ç½®é˜Ÿåˆ—ä¸­æ‰€æœ‰æ¶ˆæ¯çš„é»˜è®¤è¿‡æœŸæ—¶é—´ï¼ˆä¹Ÿå¯åœ¨å‘é€æ¶ˆæ¯æ—¶å•ç‹¬è®¾ç½®ï¼‰</span>
                .withArgument(<span class="hljs-string">"x-message-ttl"</span>, ORDER_TIMEOUT)
                .build();
    }

    <span class="hljs-comment">/**
     * å–æ¶ˆè®¢å•é˜Ÿåˆ—ï¼šæ¥æ”¶æ­»ä¿¡äº¤æ¢æœºè½¬å‘çš„è¿‡æœŸæ¶ˆæ¯
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">cancelQueue</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> QueueBuilder.durable(CANCEL_QUEUE).build();
    }

    <span class="hljs-comment">/**
     * å»¶æ—¶é˜Ÿåˆ—ç»‘å®šå»¶æ—¶äº¤æ¢æœº
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">delayQueueBinding</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(delayQueue()).to(delayExchange()).with(DELAY_ROUTING_KEY);
    }

    <span class="hljs-comment">/**
     * å–æ¶ˆè®¢å•é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">cancelQueueBinding</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> BindingBuilder.bind(cancelQueue()).to(deadLetterExchange()).with(DEAD_LETTER_ROUTING_KEY);
    }

    <span class="hljs-comment">/**
     * æ¶ˆæ¯æ¨¡æ¿é…ç½®ï¼šå¼€å¯ç”Ÿäº§è€…ç¡®è®¤ï¼Œç¡®ä¿æ¶ˆæ¯å¯é å‘é€
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> RabbitTemplate <span class="hljs-title function_">rabbitTemplate</span><span class="hljs-params">(ConnectionFactory connectionFactory)</span> {
        <span class="hljs-type">RabbitTemplate</span> <span class="hljs-variable">rabbitTemplate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RabbitTemplate</span>(connectionFactory);
        <span class="hljs-comment">// å¼€å¯ç”Ÿäº§è€…ç¡®è®¤ï¼ˆCorrelationIdæœºåˆ¶ï¼‰</span>
        rabbitTemplate.setConfirmCallback((correlationData, ack, cause) -&gt; {
            <span class="hljs-keyword">if</span> (!ack) {
                log.error(<span class="hljs-string">"æ¶ˆæ¯å‘é€å¤±è´¥ï¼šcorrelationId={}, åŸå› ={}"</span>, correlationData.getId(), cause);
                <span class="hljs-comment">// å¤±è´¥é‡è¯•é€»è¾‘ï¼ˆå¦‚å­˜å…¥æœ¬åœ°æ¶ˆæ¯è¡¨ï¼Œå®šæ—¶é‡è¯•ï¼‰</span>
                retrySendMessage(correlationData, cause);
            }
        });
        <span class="hljs-comment">// å¼€å¯æ¶ˆæ¯è¿”å›å›è°ƒï¼ˆæ¶ˆæ¯æœªè·¯ç”±åˆ°é˜Ÿåˆ—æ—¶è§¦å‘ï¼‰</span>
        rabbitTemplate.setReturnsCallback(returned -&gt; {
            log.error(<span class="hljs-string">"æ¶ˆæ¯æœªè·¯ç”±åˆ°é˜Ÿåˆ—ï¼šexchange={}, routingKey={}, message={}"</span>,
                    returned.getExchange(), returned.getRoutingKey(), returned.getMessage());
        });
        <span class="hljs-comment">// æ¶ˆæ¯æŒä¹…åŒ–</span>
        rabbitTemplate.setDeliveryMode(MessageDeliveryMode.PERSISTENT);
        <span class="hljs-keyword">return</span> rabbitTemplate;
    }

    <span class="hljs-comment">/**
     * è¿æ¥å·¥å‚é…ç½®ï¼šå¼€å¯æ¶ˆè´¹è€…æ‰‹åŠ¨ACK
     */</span>
    <span class="hljs-meta">@Bean</span>
    <span class="hljs-keyword">public</span> SimpleRabbitListenerContainerFactory <span class="hljs-title function_">rabbitListenerContainerFactory</span><span class="hljs-params">(ConnectionFactory connectionFactory)</span> {
        <span class="hljs-type">SimpleRabbitListenerContainerFactory</span> <span class="hljs-variable">factory</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleRabbitListenerContainerFactory</span>();
        factory.setConnectionFactory(connectionFactory);
        <span class="hljs-comment">// æ‰‹åŠ¨ACKæ¨¡å¼ï¼šæ¶ˆè´¹è€…å¤„ç†å®Œæˆåæ‰‹åŠ¨ç¡®è®¤æ¶ˆæ¯</span>
        factory.setAcknowledgeMode(AcknowledgeMode.MANUAL);
        <span class="hljs-comment">// å¹¶å‘æ¶ˆè´¹è€…æ•°é‡</span>
        factory.setConcurrentConsumers(<span class="hljs-number">5</span>);
        <span class="hljs-comment">// æœ€å¤§å¹¶å‘æ¶ˆè´¹è€…æ•°é‡</span>
        factory.setMaxConcurrentConsumers(<span class="hljs-number">10</span>);
        <span class="hljs-keyword">return</span> factory;
    }

    <span class="hljs-comment">// å¤±è´¥é‡è¯•é€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼šå®é™…å¯å­˜å…¥æ•°æ®åº“å®šæ—¶é‡è¯•ï¼‰</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">retrySendMessage</span><span class="hljs-params">(CorrelationData correlationData, String cause)</span> {
        <span class="hljs-comment">// ä¸šåŠ¡å®ç°ï¼šå¦‚è®°å½•æ—¥å¿—ã€å­˜å…¥æœ¬åœ°æ¶ˆæ¯è¡¨ã€å®šæ—¶ä»»åŠ¡é‡è¯•</span>
    }
}
</code></pre>
<h4 data-id="heading-12">3. è®¢å•çŠ¶æ€æœºä¸å®ä½“è®¾è®¡</h4>
<h5 data-id="heading-13">ï¼ˆ1ï¼‰è®¢å•çŠ¶æ€æšä¸¾ï¼ˆæ˜ç¡®åˆæ³•è½¬æ¢è§„åˆ™ï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">OrderStatus</span> {
    CREATED(<span class="hljs-string">"å·²åˆ›å»º"</span>, Arrays.asList(<span class="hljs-string">"PAID"</span>, <span class="hljs-string">"CANCELLED"</span>)), <span class="hljs-comment">// å·²åˆ›å»ºå¯è½¬ä¸ºå·²æ”¯ä»˜/å·²å–æ¶ˆ</span>
    PAID(<span class="hljs-string">"å·²æ”¯ä»˜"</span>, Arrays.asList(<span class="hljs-string">"COMPLETED"</span>, <span class="hljs-string">"CLOSED"</span>)),   <span class="hljs-comment">// å·²æ”¯ä»˜å¯è½¬ä¸ºå·²å®Œæˆ/å·²å…³é—­</span>
    CANCELLED(<span class="hljs-string">"å·²å–æ¶ˆ"</span>, Arrays.asList(<span class="hljs-string">"CLOSED"</span>)),           <span class="hljs-comment">// å·²å–æ¶ˆå¯è½¬ä¸ºå·²å…³é—­</span>
    COMPLETED(<span class="hljs-string">"å·²å®Œæˆ"</span>, Arrays.asList(<span class="hljs-string">"CLOSED"</span>)),           <span class="hljs-comment">// å·²å®Œæˆå¯è½¬ä¸ºå·²å…³é—­</span>
    CLOSED(<span class="hljs-string">"å·²å…³é—­"</span>, Collections.emptyList());             <span class="hljs-comment">// å·²å…³é—­ä¸ºæœ€ç»ˆçŠ¶æ€</span>

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String desc;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;String&gt; allowNextStatus; <span class="hljs-comment">// å…è®¸çš„ä¸‹ä¸€ä¸ªçŠ¶æ€</span>

    OrderStatus(String desc, List&lt;String&gt; allowNextStatus) {
        <span class="hljs-built_in">this</span>.desc = desc;
        <span class="hljs-built_in">this</span>.allowNextStatus = allowNextStatus;
    }

    <span class="hljs-comment">// æ ¡éªŒçŠ¶æ€è½¬æ¢æ˜¯å¦åˆæ³•</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isAllowedNextStatus</span><span class="hljs-params">(OrderStatus nextStatus)</span> {
        <span class="hljs-keyword">return</span> allowNextStatus.contains(nextStatus.name());
    }
}
</code></pre>
<h5 data-id="heading-14">ï¼ˆ2ï¼‰è®¢å•å®ä½“ï¼ˆå«ä¹è§‚é”ç‰ˆæœ¬å·ï¼‰</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Data</span>
<span class="hljs-meta">@TableName("t_order")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Order</span> {
    <span class="hljs-meta">@TableId(type = IdType.AUTO)</span>
    <span class="hljs-keyword">private</span> Long id; <span class="hljs-comment">// è®¢å•ID</span>
    <span class="hljs-keyword">private</span> String orderNo; <span class="hljs-comment">// è®¢å•ç¼–å·ï¼ˆå”¯ä¸€ï¼‰</span>
    <span class="hljs-keyword">private</span> Long userId; <span class="hljs-comment">// ç”¨æˆ·ID</span>
    <span class="hljs-keyword">private</span> BigDecimal amount; <span class="hljs-comment">// è®¢å•é‡‘é¢</span>
    <span class="hljs-meta">@TableField(value = "status")</span>
    <span class="hljs-keyword">private</span> String status; <span class="hljs-comment">// è®¢å•çŠ¶æ€ï¼ˆå¯¹åº”OrderStatusæšä¸¾ï¼‰</span>
    <span class="hljs-keyword">private</span> Date createTime; <span class="hljs-comment">// åˆ›å»ºæ—¶é—´</span>
    <span class="hljs-keyword">private</span> Date payTime; <span class="hljs-comment">// æ”¯ä»˜æ—¶é—´</span>
    <span class="hljs-keyword">private</span> Date cancelTime; <span class="hljs-comment">// å–æ¶ˆæ—¶é—´</span>
    <span class="hljs-meta">@Version</span> <span class="hljs-comment">// ä¹è§‚é”ç‰ˆæœ¬å·</span>
    <span class="hljs-keyword">private</span> Integer version; <span class="hljs-comment">// ç”¨äºå¹¶å‘æ§åˆ¶</span>
}
</code></pre>
<h3 data-id="heading-15">ä¸‰ã€æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å®ç°</h3>
<h4 data-id="heading-16">1. è®¢å•åˆ›å»ºä¸å»¶æ—¶æ¶ˆæ¯å‘é€</h4>
<p>è®¢å•åˆ›å»ºæ—¶é”å®šåº“å­˜ã€å‘é€å»¶æ—¶æ¶ˆæ¯ï¼Œç¡®ä¿æ¶ˆæ¯ä¸è®¢å•æ•°æ®ä¸€è‡´æ€§ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-meta">@Transactional</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> StockService stockService; <span class="hljs-comment">// åº“å­˜æœåŠ¡</span>
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> CouponService couponService; <span class="hljs-comment">// ä¼˜æƒ åˆ¸æœåŠ¡</span>

    <span class="hljs-comment">/**
     * åˆ›å»ºè®¢å•ï¼šé”å®šåº“å­˜+å‘é€å»¶æ—¶å–æ¶ˆæ¶ˆæ¯
     */</span>
    <span class="hljs-keyword">public</span> Order <span class="hljs-title function_">createOrder</span><span class="hljs-params">(OrderDTO orderDTO)</span> {
        <span class="hljs-comment">// 1. ç”Ÿæˆè®¢å•ç¼–å·</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">orderNo</span> <span class="hljs-operator">=</span> IdUtil.fastSimpleUUID();

        <span class="hljs-comment">// 2. é”å®šåº“å­˜ï¼ˆå®é™…åœºæ™¯éœ€è€ƒè™‘åº“å­˜ä¸è¶³çš„å¼‚å¸¸å¤„ç†ï¼‰</span>
        <span class="hljs-type">boolean</span> <span class="hljs-variable">lockSuccess</span> <span class="hljs-operator">=</span> stockService.lockStock(orderDTO.getProductId(), orderDTO.getQuantity());
        <span class="hljs-keyword">if</span> (!lockSuccess) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessException</span>(<span class="hljs-string">"åº“å­˜ä¸è¶³ï¼Œåˆ›å»ºè®¢å•å¤±è´¥"</span>);
        }

        <span class="hljs-comment">// 3. è§£å†»ä¼˜æƒ åˆ¸ï¼ˆè‹¥ç”¨æˆ·ä½¿ç”¨ä¼˜æƒ åˆ¸ï¼‰</span>
        <span class="hljs-keyword">if</span> (StrUtil.isNotBlank(orderDTO.getCouponId())) {
            couponService.freezeCoupon(orderDTO.getCouponId(), orderDTO.getUserId());
        }

        <span class="hljs-comment">// 4. ä¿å­˜è®¢å•ï¼ˆçŠ¶æ€ä¸ºCREATEDï¼‰</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();
        order.setOrderNo(orderNo);
        order.setUserId(orderDTO.getUserId());
        order.setAmount(orderDTO.getAmount());
        order.setStatus(OrderStatus.CREATED.name());
        order.setCreateTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());
        orderMapper.insert(order);

        <span class="hljs-comment">// 5. å‘é€å»¶æ—¶å–æ¶ˆæ¶ˆæ¯ï¼ˆæ¶ˆæ¯ä½“ä¸ºè®¢å•ç¼–å·ï¼‰</span>
        sendDelayCancelMessage(orderNo);

        <span class="hljs-keyword">return</span> order;
    }

    <span class="hljs-comment">/**
     * å‘é€å»¶æ—¶å–æ¶ˆæ¶ˆæ¯
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sendDelayCancelMessage</span><span class="hljs-params">(String orderNo)</span> {
        <span class="hljs-comment">// æ„å»ºæ¶ˆæ¯</span>
        <span class="hljs-type">Message</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> MessageBuilder.withBody(orderNo.getBytes(StandardCharsets.UTF_8))
                .setDeliveryMode(MessageDeliveryMode.PERSISTENT) <span class="hljs-comment">// æ¶ˆæ¯æŒä¹…åŒ–</span>
                .build();

        <span class="hljs-comment">// æ„å»ºCorrelationIdï¼ˆç”¨äºç”Ÿäº§è€…ç¡®è®¤ï¼‰</span>
        <span class="hljs-type">CorrelationData</span> <span class="hljs-variable">correlationData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CorrelationData</span>(<span class="hljs-string">"order_cancel_"</span> + orderNo);

        <span class="hljs-comment">// å‘é€æ¶ˆæ¯åˆ°å»¶æ—¶äº¤æ¢æœº</span>
        rabbitTemplate.convertAndSend(
                RabbitMQDelayConfig.DELAY_EXCHANGE,
                RabbitMQDelayConfig.DELAY_ROUTING_KEY,
                message,
                correlationData
        );

        log.info(<span class="hljs-string">"å»¶æ—¶å–æ¶ˆæ¶ˆæ¯å‘é€æˆåŠŸï¼šorderNo={}, correlationId={}"</span>, orderNo, correlationData.getId());
    }
}
</code></pre>
<h4 data-id="heading-17">2. å»¶æ—¶æ¶ˆæ¯æ¶ˆè´¹ä¸è®¢å•å–æ¶ˆ</h4>
<p>æ¶ˆè´¹è€…ç›‘å¬å–æ¶ˆè®¢å•é˜Ÿåˆ—ï¼Œæ¥æ”¶è¿‡æœŸæ¶ˆæ¯åæ‰§è¡Œå–æ¶ˆé€»è¾‘ï¼Œé€šè¿‡ä¹è§‚é”å’Œå¹‚ç­‰å¤„ç†ä¿éšœå¯é æ€§ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderCancelConsumer</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> StockService stockService;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> CouponService couponService;

    <span class="hljs-comment">/**
     * ç›‘å¬å–æ¶ˆè®¢å•é˜Ÿåˆ—ï¼Œæ‰§è¡Œå–æ¶ˆé€»è¾‘
     */</span>
    <span class="hljs-meta">@RabbitListener(queues = RabbitMQDelayConfig.CANCEL_QUEUE, containerFactory = "rabbitListenerContainerFactory")</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleCancelOrder</span><span class="hljs-params">(Message message, Channel channel)</span> <span class="hljs-keyword">throws</span> IOException {
        <span class="hljs-type">String</span> <span class="hljs-variable">orderNo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(message.getBody(), StandardCharsets.UTF_8);
        <span class="hljs-type">long</span> <span class="hljs-variable">deliveryTag</span> <span class="hljs-operator">=</span> message.getMessageProperties().getDeliveryTag();

        <span class="hljs-keyword">try</span> {
            log.info(<span class="hljs-string">"å¼€å§‹å¤„ç†è®¢å•å–æ¶ˆï¼šorderNo={}"</span>, orderNo);

            <span class="hljs-comment">// 1. æŸ¥è¯¢è®¢å•ï¼ˆå¸¦ä¹è§‚é”æ§åˆ¶ï¼‰</span>
            <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectByOrderNo(orderNo);
            <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
                log.warn(<span class="hljs-string">"è®¢å•ä¸å­˜åœ¨ï¼šorderNo={}"</span>, orderNo);
                channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>); <span class="hljs-comment">// ç¡®è®¤æ¶ˆæ¯</span>
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-comment">// 2. æ ¡éªŒè®¢å•çŠ¶æ€ï¼šä»…å·²åˆ›å»ºçŠ¶æ€å¯å–æ¶ˆ</span>
            <span class="hljs-keyword">if</span> (!OrderStatus.CREATED.name().equals(order.getStatus())) {
                log.warn(<span class="hljs-string">"è®¢å•çŠ¶æ€ä¸å…è®¸å–æ¶ˆï¼šorderNo={}, å½“å‰çŠ¶æ€={}"</span>, orderNo, order.getStatus());
                channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>);
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-comment">// 3. ä¹è§‚é”æ›´æ–°è®¢å•çŠ¶æ€ä¸ºCANCELLED</span>
            <span class="hljs-type">int</span> <span class="hljs-variable">updateCount</span> <span class="hljs-operator">=</span> orderMapper.updateStatusByVersion(
                    orderNo,
                    OrderStatus.CREATED.name(),
                    OrderStatus.CANCELLED.name(),
                    order.getVersion()
            );

            <span class="hljs-keyword">if</span> (updateCount == <span class="hljs-number">0</span>) {
                log.warn(<span class="hljs-string">"è®¢å•çŠ¶æ€æ›´æ–°å¤±è´¥ï¼ˆå¹¶å‘å†²çªï¼‰ï¼šorderNo={}"</span>, orderNo);
                channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>); <span class="hljs-comment">// å·²å¤„ç†ï¼Œæ— éœ€é‡è¯•</span>
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-comment">// 4. é‡Šæ”¾èµ„æºï¼šè§£é”åº“å­˜+è§£å†»ä¼˜æƒ åˆ¸</span>
            <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">orderDTO</span> <span class="hljs-operator">=</span> buildOrderDTO(order); <span class="hljs-comment">// æ„å»ºè®¢å•DTO</span>
            stockService.unlockStock(orderDTO.getProductId(), orderDTO.getQuantity());
            <span class="hljs-keyword">if</span> (StrUtil.isNotBlank(orderDTO.getCouponId())) {
                couponService.unfreezeCoupon(orderDTO.getCouponId(), orderDTO.getUserId());
            }

            <span class="hljs-comment">// 5. æ›´æ–°è®¢å•å–æ¶ˆæ—¶é—´</span>
            order.setCancelTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>());
            orderMapper.updateById(order);

            log.info(<span class="hljs-string">"è®¢å•å–æ¶ˆæˆåŠŸï¼šorderNo={}"</span>, orderNo);
            channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>); <span class="hljs-comment">// æˆåŠŸç¡®è®¤æ¶ˆæ¯</span>

        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"å¤„ç†è®¢å•å–æ¶ˆå¤±è´¥ï¼šorderNo={}, å¼‚å¸¸={}"</span>, orderNo, e.getMessage(), e);
            <span class="hljs-comment">// å¤±è´¥é‡è¯•ï¼ˆæœ€å¤š3æ¬¡ï¼Œè¶…è¿‡åˆ™å­˜å…¥æ­»ä¿¡è¡¨äººå·¥å¤„ç†ï¼‰</span>
            <span class="hljs-keyword">if</span> (message.getMessageProperties().getRedelivered()) {
                log.error(<span class="hljs-string">"è®¢å•å–æ¶ˆé‡è¯•å¤±è´¥ï¼Œå­˜å…¥æ­»ä¿¡è¡¨ï¼šorderNo={}"</span>, orderNo);
                saveToDeadLetterTable(orderNo, e.getMessage());
                channel.basicAck(deliveryTag, <span class="hljs-literal">false</span>); <span class="hljs-comment">// é¿å…æ— é™é‡è¯•</span>
            } <span class="hljs-keyword">else</span> {
                channel.basicNack(deliveryTag, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>); <span class="hljs-comment">// é‡æ–°å…¥é˜Ÿé‡è¯•</span>
            }
        }
    }

    <span class="hljs-comment">/**
     * æ„å»ºè®¢å•DTOï¼ˆç®€åŒ–ç‰ˆï¼‰
     */</span>
    <span class="hljs-keyword">private</span> OrderDTO <span class="hljs-title function_">buildOrderDTO</span><span class="hljs-params">(Order order)</span> {
        <span class="hljs-type">OrderDTO</span> <span class="hljs-variable">dto</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrderDTO</span>();
        dto.setOrderNo(order.getOrderNo());
        dto.setUserId(order.getUserId());
        <span class="hljs-comment">// è¡¥å……å•†å“IDã€æ•°é‡ã€ä¼˜æƒ åˆ¸IDç­‰å­—æ®µ...</span>
        <span class="hljs-keyword">return</span> dto;
    }

    <span class="hljs-comment">/**
     * ä¿å­˜æ­»ä¿¡è®¢å•ï¼Œç”¨äºäººå·¥å¤„ç†
     */</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveToDeadLetterTable</span><span class="hljs-params">(String orderNo, String reason)</span> {
        <span class="hljs-comment">// å®é™…é¡¹ç›®ä¸­éœ€æŒä¹…åŒ–åˆ°æ•°æ®åº“ï¼Œæ­¤å¤„ç®€åŒ–</span>
        log.error(<span class="hljs-string">"æ­»ä¿¡è®¢å•è®°å½•ï¼šorderNo={}, reason={}"</span>, orderNo, reason);
    }
}
</code></pre>
<h5 data-id="heading-18">3. æ”¯ä»˜æˆåŠŸåæ¶ˆæ¯å¤„ç†ï¼ˆé¿å…æ— æ•ˆå–æ¶ˆï¼‰</h5>
<p>ç”¨æˆ·æ”¯ä»˜æˆåŠŸåï¼Œéœ€ç»ˆæ­¢å»¶æ—¶å–æ¶ˆæµç¨‹ï¼Œé˜²æ­¢é‡å¤æ“ä½œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PayService</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderMapper orderMapper;
    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;

    <span class="hljs-comment">/**
     * è®¢å•æ”¯ä»˜æˆåŠŸ
     */</span>
    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">paySuccess</span><span class="hljs-params">(String orderNo)</span> {
        <span class="hljs-comment">// 1. ä¹è§‚é”æ›´æ–°è®¢å•çŠ¶æ€ä¸ºPAID</span>
        <span class="hljs-type">int</span> <span class="hljs-variable">updateCount</span> <span class="hljs-operator">=</span> orderMapper.updateStatus(
                orderNo,
                OrderStatus.CREATED.name(),
                OrderStatus.PAID.name()
        );

        <span class="hljs-keyword">if</span> (updateCount == <span class="hljs-number">0</span>) {
            log.error(<span class="hljs-string">"è®¢å•æ”¯ä»˜å¤±è´¥ï¼šçŠ¶æ€å·²å˜æ›´ï¼ŒorderNo={}"</span>, orderNo);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-comment">// 2. ç»ˆæ­¢å»¶æ—¶å–æ¶ˆæµç¨‹ï¼ˆå¯é€‰ï¼šé€šè¿‡RabbitMQ APIåˆ é™¤æœªè¿‡æœŸæ¶ˆæ¯ï¼Œæˆ–ä¾èµ–çŠ¶æ€æ ¡éªŒï¼‰</span>
        <span class="hljs-comment">// æ³¨ï¼šRabbitMQé»˜è®¤ä¸æ”¯æŒä¸»åŠ¨åˆ é™¤é˜Ÿåˆ—ä¸­æ¶ˆæ¯ï¼Œæ­¤å¤„é€šè¿‡çŠ¶æ€æ ¡éªŒä¿éšœå¹‚ç­‰</span>
        log.info(<span class="hljs-string">"è®¢å•æ”¯ä»˜æˆåŠŸï¼Œç»ˆæ­¢å»¶æ—¶å–æ¶ˆï¼šorderNo={}"</span>, orderNo);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }
}
</code></pre>
<h3 data-id="heading-19">å››ã€å¯é æ€§ä¿éšœä¸æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-20">1. æ¶ˆæ¯å¯é æ€§ä¿éšœï¼ˆç«¯åˆ°ç«¯ï¼‰</h4>






























<table><thead><tr><th align="left">ç¯èŠ‚</th><th align="left">ä¿éšœæªæ–½</th><th align="left">å®ç°æ–¹å¼</th></tr></thead><tbody><tr><td align="left"><strong>ç”Ÿäº§è€…</strong></td><td align="left">æ¶ˆæ¯ä¸ä¸¢å¤±</td><td align="left">å¼€å¯ ConfirmCallback+ReturnsCallbackï¼Œå¤±è´¥å­˜å…¥æœ¬åœ°æ¶ˆæ¯è¡¨å®šæ—¶é‡è¯•</td></tr><tr><td align="left"><strong>Broker</strong></td><td align="left">æ•°æ®ä¸ä¸¢å¤±</td><td align="left">äº¤æ¢æœº / é˜Ÿåˆ— / æ¶ˆæ¯å‡è®¾ç½®æŒä¹…åŒ–ï¼ŒRabbitMQ å¼€å¯ä¸»ä»åŒæ­¥ + åŒæ­¥åˆ·ç›˜</td></tr><tr><td align="left"><strong>æ¶ˆè´¹è€…</strong></td><td align="left">æ¶ˆè´¹ä¸é‡å¤</td><td align="left">æ‰‹åŠ¨ ACK + å¹‚ç­‰æ ¡éªŒï¼ˆçŠ¶æ€æ ¡éªŒ + ä¹è§‚é”ï¼‰ï¼Œé˜²æ­¢é‡å¤å–æ¶ˆ</td></tr><tr><td align="left"><strong>ç½‘ç»œå¼‚å¸¸</strong></td><td align="left">æ¶ˆæ¯å¯é‡è¯•</td><td align="left">æ¶ˆè´¹è€…å¤±è´¥åé‡æ–°å…¥é˜Ÿï¼ˆæœ€å¤š 3 æ¬¡ï¼‰ï¼Œè¶…é™å­˜å…¥æ­»ä¿¡è¡¨äººå·¥å¤„ç†</td></tr></tbody></table>
<h4 data-id="heading-21">2. å¹‚ç­‰æ€§è®¾è®¡æ ¸å¿ƒæ–¹æ¡ˆ</h4>
<ol>
<li><strong>çŠ¶æ€æ ¡éªŒ</strong>ï¼šä»…å½“è®¢å•å¤„äº CREATED çŠ¶æ€æ—¶æ‰§è¡Œå–æ¶ˆé€»è¾‘ï¼›</li>
<li><strong>ä¹è§‚é”</strong>ï¼šåŸºäº version å­—æ®µå®ç°åŸå­åŒ–æ›´æ–°ï¼Œé¿å…å¹¶å‘å†²çªï¼›</li>
<li><strong>æ¶ˆæ¯å»é‡</strong>ï¼šæ¶ˆæ¯æºå¸¦å”¯ä¸€ IDï¼Œæ¶ˆè´¹å‰æ ¡éªŒæ˜¯å¦å·²å¤„ç†ï¼ˆå¦‚å­˜å…¥ Redisï¼‰ï¼›</li>
<li><strong>æ¥å£å¹‚ç­‰</strong>ï¼šå–æ¶ˆè®¢å•æ¥å£è®¾è®¡ä¸ºå¹‚ç­‰æ“ä½œï¼Œå¤šæ¬¡è°ƒç”¨ç»“æœä¸€è‡´ã€‚</li>
</ol>
<h4 data-id="heading-22">3. æ€§èƒ½ä¼˜åŒ–å»ºè®®</h4>
<ol>
<li><strong>æ¶ˆæ¯ä½“ç²¾ç®€</strong>ï¼šä»…ä¼ é€’è®¢å•ç¼–å·ï¼Œé¿å…å¤§æ•°æ®ä¼ è¾“ï¼›</li>
<li><strong>æ¶ˆè´¹è€…å¹¶å‘</strong>ï¼šé€šè¿‡<code>setConcurrentConsumers</code>è°ƒæ•´æ¶ˆè´¹çº¿ç¨‹æ•°ï¼Œé€‚é…è®¢å•é‡ï¼›</li>
<li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šé«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¯æ‰¹é‡æ‹‰å–æ¶ˆæ¯å¹¶æ‰¹é‡æ›´æ–°è®¢å•çŠ¶æ€ï¼›</li>
<li><strong>ç¼“å­˜ä¼˜åŒ–</strong>ï¼šçƒ­ç‚¹è®¢å•çŠ¶æ€ç¼“å­˜è‡³ Redisï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢å‹åŠ›ï¼›</li>
<li><strong>æ­»ä¿¡éš”ç¦»</strong>ï¼šå¤±è´¥æ¶ˆæ¯å•ç‹¬å­˜å‚¨ï¼Œé¿å…å½±å“æ­£å¸¸é˜Ÿåˆ—ã€‚</li>
</ol>
<h3 data-id="heading-23">äº”ã€éƒ¨ç½²ä¸è¿ç»´æ³¨æ„äº‹é¡¹</h3>
<h4 data-id="heading-24">1. RabbitMQ éƒ¨ç½²é…ç½®</h4>
<ol>
<li>å®‰è£… RabbitMQ å¹¶å¯ç”¨ç®¡ç†æ’ä»¶ï¼ˆ<code>rabbitmq-plugins enable rabbitmq_management</code>ï¼‰ï¼›</li>
<li>é…ç½®æŒä¹…åŒ–ç­–ç•¥ï¼šäº¤æ¢æœºã€é˜Ÿåˆ—ã€æ¶ˆæ¯å‡è®¾ç½®ä¸ºæŒä¹…åŒ–ï¼›</li>
<li>è°ƒæ•´å†…å­˜ä¸ç£ç›˜é˜ˆå€¼ï¼Œé¿å…æ¶ˆæ¯è¢«æ¢å‡ºæˆ–ä¸¢å¼ƒï¼›</li>
<li>ç”Ÿäº§ç¯å¢ƒå»ºè®®é›†ç¾¤éƒ¨ç½²ï¼Œæå‡å¯ç”¨æ€§ã€‚</li>
</ol>
<h4 data-id="heading-25">2. ç›‘æ§ä¸å‘Šè­¦</h4>
<ol>
<li>ç›‘æ§é˜Ÿåˆ—é•¿åº¦ã€æ¶ˆæ¯å †ç§¯æƒ…å†µï¼Œè®¾ç½®é˜ˆå€¼å‘Šè­¦ï¼›</li>
<li>ç›‘æ§æ¶ˆæ¯å‘é€æˆåŠŸç‡ã€æ¶ˆè´¹æˆåŠŸç‡ï¼ŒåŠæ—¶å‘ç°å¼‚å¸¸ï¼›</li>
<li>è®°å½•æ­»ä¿¡è®¢å•ï¼Œå®šæœŸäººå·¥å¤„ç†ï¼›</li>
<li>ç›‘æ§æ•°æ®åº“ä¹è§‚é”å†²çªç‡ï¼Œä¼˜åŒ–å¹¶å‘æ§åˆ¶ç­–ç•¥ã€‚</li>
</ol>
<h3 data-id="heading-26">å…­ã€æ–¹æ¡ˆå¯¹æ¯”ä¸æ€»ç»“</h3>
<h4 data-id="heading-27">1. ä¸ RocketMQ æ–¹æ¡ˆå¯¹æ¯”</h4>






























<table><thead><tr><th align="left">ç‰¹æ€§</th><th align="left">RabbitMQ æ–¹æ¡ˆ</th><th align="left">RocketMQ æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td align="left"><strong>å»¶æ—¶ç²¾åº¦</strong></td><td align="left">ç§’çº§ï¼ˆåŸºäº TTL + æ­»ä¿¡ï¼‰</td><td align="left">æ¯«ç§’çº§ï¼ˆåŸç”Ÿæ”¯æŒå»¶æ—¶æ¶ˆæ¯ï¼‰</td></tr><tr><td align="left"><strong>éƒ¨ç½²æˆæœ¬</strong></td><td align="left">è½»é‡ï¼Œæ˜“éƒ¨ç½²</td><td align="left">è¾ƒé‡ï¼Œä¾èµ– NameServer ç­‰ç»„ä»¶</td></tr><tr><td align="left"><strong>ç”Ÿæ€é€‚é…</strong></td><td align="left">é€‚é…ä¸­å°å›¢é˜Ÿï¼Œå¿«é€Ÿè½åœ°</td><td align="left">é€‚åˆå¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿ</td></tr><tr><td align="left"><strong>å­¦ä¹ æ›²çº¿</strong></td><td align="left">ä½ï¼ŒAPI ç®€æ´</td><td align="left">è¾ƒé«˜ï¼Œæ¦‚å¿µè¾ƒå¤š</td></tr></tbody></table>
<h4 data-id="heading-28">2. æ–¹æ¡ˆæ€»ç»“</h4>
<p>æœ¬æ–‡åŸºäº <strong>SpringBoot + RabbitMQ + äº‹åŠ¡çŠ¶æ€æœº</strong> å®ç°è®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆåŠŸèƒ½ï¼Œé€šè¿‡æ­»ä¿¡é˜Ÿåˆ— + TTL æœºåˆ¶æ›¿ä»£ä¼ ç»Ÿå®šæ—¶è½®è¯¢ï¼Œè§£å†³äº†èµ„æºæµªè´¹ã€å®æ—¶æ€§å·®ç­‰é—®é¢˜ã€‚æ ¸å¿ƒä¼˜åŠ¿åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç²¾å‡†å»¶æ—¶</strong>ï¼šæ¶ˆæ¯è¿‡æœŸåç§’çº§è§¦å‘ï¼Œå®æ—¶æ€§è¿œè¶…å®šæ—¶ä»»åŠ¡ï¼›</li>
<li><strong>é«˜å¯é æ€§</strong>ï¼šç«¯åˆ°ç«¯æ¶ˆæ¯ä¿éšœ + å¹‚ç­‰è®¾è®¡ï¼Œç¡®ä¿è®¢å•çŠ¶æ€ä¸€è‡´æ€§ï¼›</li>
<li><strong>é«˜å¹¶å‘æ”¯æŒ</strong>ï¼šæ¶ˆæ¯é˜Ÿåˆ—å‰Šå³°å¡«è°·ï¼Œè½»æ¾åº”å¯¹æµ·é‡è®¢å•ï¼›</li>
<li><strong>æ˜“æ‰©å±•</strong>ï¼šæ”¯æŒä¼˜æƒ åˆ¸è¿‡æœŸã€åº“å­˜é”å®šé‡Šæ”¾ç­‰å¤šç§å»¶æ—¶åœºæ™¯ã€‚</li>
</ol>
<p>è¯¥æ–¹æ¡ˆé€‚ç”¨äºä¸­å°ç”µå•†ã€O2O ç­‰éœ€è¦é«˜æ•ˆå»¶æ—¶ä»»åŠ¡å¤„ç†çš„ç³»ç»Ÿï¼Œç›¸æ¯” RocketMQ æ–¹æ¡ˆæ›´è½»é‡ã€æ˜“éƒ¨ç½²ï¼Œæ˜¯å¿«é€Ÿè½åœ°çš„ä¼˜é€‰æ–¹æ¡ˆã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦æœ¯ç•Œæœ€å¤§çš„å®¤å†…è¿åŠ¨æ•æ‰è®¾æ–½ä¸ºä¸–ç•Œé¢†å…ˆçš„æ— äººæœºç ”ç©¶æä¾›æ”¯æŒ]]></title>    <link>https://juejin.cn/post/7597125475601104923</link>    <guid>https://juejin.cn/post/7597125475601104923</guid>    <pubDate>2026-01-20T08:42:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597125475601104923" data-draft-id="7597058147749003274" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦æœ¯ç•Œæœ€å¤§çš„å®¤å†…è¿åŠ¨æ•æ‰è®¾æ–½ä¸ºä¸–ç•Œé¢†å…ˆçš„æ— äººæœºç ”ç©¶æä¾›æ”¯æŒ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-20T08:42:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="çˆ±è¿ªæ–¯é€š"/> <meta itemprop="url" content="https://juejin.cn/user/2672256188156042"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦æœ¯ç•Œæœ€å¤§çš„å®¤å†…è¿åŠ¨æ•æ‰è®¾æ–½ä¸ºä¸–ç•Œé¢†å…ˆçš„æ— äººæœºç ”ç©¶æä¾›æ”¯æŒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2672256188156042/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    çˆ±è¿ªæ–¯é€š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:42:41.000Z" title="Tue Jan 20 2026 08:42:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>äºšåˆ©æ¡‘é‚£å·ç«‹å¤§å­¦è·Ÿè¸ªä½“ç§¯ä¸º 230,000 ç«‹æ–¹è‹±å°ºçš„æ— äººæœºå·¥ä½œå®¤æ˜¯ä¸–ç•Œä¸Šå­¦æœ¯æœºæ„ä¸­æœ€å¤§çš„å®¤å†…æ— äººæœºç ”ç©¶åŠ¨æ•è®¾æ–½ã€‚è¯¥è®¾æ–½å‰èº«æ˜¯ä¸€ä¸ªç¯®çƒé¦†ï¼Œç»è¿‡äº”å¹´å¤šçš„å»ºé€ ï¼Œç”±äºšåˆ©æ¡‘é‚£å·ç«‹å¤§å­¦æœºå™¨äººç ”ç©¶å‘˜å’Œå‰¯æ•™æˆPanagiotis Artemiadisåšå£«è®¾è®¡ï¼Œä¸ºè·¨å­¦ç§‘ç ”ç©¶çš„åˆä½œç©ºé—´æä¾›æ”¯æŒã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d1032531379b44218f034db1695251b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix6L-q5pav6YCa:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769503361&amp;x-signature=KDBCRVOm5tvn0EheEMmDf9oBXNs%3D" alt="ScreenShot_2026-01-20_153410_194.png" loading="lazy"/></p>
<p>è¯¥æ— äººæœºç ”ç©¶è®¾æ–½çš„è·Ÿè¸ªç³»ç»Ÿæ‹¥æœ‰ 23 è‹±å°ºé«˜çš„å¤©èŠ±æ¿å’Œ 104 ä¸ªå¹¿è§’ OptiTrack Prime 17W æ‘„åƒæœºï¼Œæ¯ç§’èƒ½å¤ŸåŒæ—¶æ•è·å¤šè¾¾ 250 ä¸ªæœºå™¨äººçš„ 360 æ¬¡æµ‹é‡æ•°æ®ï¼Œæ¯æ¶æ— äººæœºçš„è¿åŠ¨è·Ÿè¸ªç²¾åº¦åœ¨ 0.5 æ¯«ç±³ä»¥å†…ï¼Œä½¿è¯¥ç©ºé—´éå¸¸é€‚åˆç ”ç©¶æ— äººæœºç¾¤çš„å¿«é€ŸåŠ¨æ€å’Œé€‚ç”¨äºå¤§å‹å¹³å°çš„æœºå™¨äººç­‰åº”ç”¨ã€‚</p>
<p>Artemiadisåšå£«åœ¨ 2016 å¹´å‡­å€Ÿå…¶â€œå¤§è„‘æ´»åŠ¨é©±åŠ¨çš„æ— äººæœºæ§åˆ¶ç³»ç»Ÿâ€çš„åˆ›æ–°æˆæœå¼•èµ·äº†è½°åŠ¨ï¼Œäºšåˆ©æ¡‘é‚£å·ç«‹å¤§å­¦äººæœºæ§åˆ¶ (HORC) å®éªŒå®¤çš„ç ”ç©¶äººå‘˜ï¼Œä¸äºšåˆ©æ¡‘é‚£å·ç«‹å¤§å­¦è®¡ç®—ã€ä¿¡æ¯å­¦å’Œå†³ç­–ç³»ç»Ÿå·¥ç¨‹å­¦é™¢çš„åŠ©ç†æ•™æˆStephanie Gilä¸€èµ·ä¸»å¯¼äº†æ— äººæœºå·¥ä½œå®¤çš„è½æˆã€‚</p>
<p>é™¤äº†æ”¯æŒç©ºä¸­æœºå™¨äººç³»ç»Ÿçš„ç ”ç©¶å’Œå¼€å‘å¤–ï¼Œæ— äººæœºå·¥ä½œå®¤è¿˜æ”¯æŒåœ°é¢æœºå™¨äººï¼Œä½¿ç ”ç©¶äººå‘˜èƒ½å¤Ÿæ£€æŸ¥å’Œåè°ƒå…·æœ‰ä¸åŒè¿åŠ¨æ–¹å¼çš„æœºå™¨äººä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚æ­¤ç±»ç ”ç©¶çš„ç°å®æ„ä¹‰å¯ä»¥å¸®åŠ©æ–°å…´æŠ€æœ¯çš„å‘å±•ï¼Œä¾‹å¦‚æ— äººé©¾é©¶æœç´¢å’Œæ•‘æ´è½¦è¾†ã€è‡ªåŠ¨é©¾é©¶è½¦è¾†å’Œæ— äººæœºé€è´§ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/744ec8b5766d4ca58573c969267bb277~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54ix6L-q5pav6YCa:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769503361&amp;x-signature=BZnpTYVFmQBt9kUBJA8BjaWFjoc%3D" alt="ScreenShot_2026-01-20_153437_707.png" loading="lazy"/></p>
<p>Artemiadisåšå£«åœ¨äºšåˆ©æ¡‘é‚£å·ç«‹å¤§å­¦å¯Œå°”é¡¿å·¥ç¨‹å­¦é™¢æ‚å¿— Convergence ä¸Šä»‹ç»æ— äººæœºå·¥ä½œå®¤æ—¶è¡¨ç¤ºï¼šâ€œè¿™ä¸ªå…ˆè¿›çš„ä»ªå™¨ç©ºé—´ä½¿å¤šå­¦ç§‘çš„æ•™å¸ˆå›¢é˜Ÿèƒ½å¤Ÿè§£å†³ä»¥å‰æ— æ³•è§£å†³çš„ç ”ç©¶é—®é¢˜ï¼Œä¾‹å¦‚ä»£ç†æ•°ç™¾ä¸ªæœºå™¨äººçš„åè°ƒå’Œæ§åˆ¶ä»¥åŠä¸äººç±»ç¾¤ä½“çš„äº’åŠ¨ç­‰ã€‚â€</p>
<p>GilæŒ‡å‡ºï¼Œâ€œæˆ‘å¸Œæœ›æ— äººæœºå·¥ä½œå®¤èƒ½å¤Ÿæ¿€åŠ±ç ”ç©¶äººå‘˜å°è¯•æ–°çš„å®éªŒç±»åˆ«ï¼Œåˆ©ç”¨å¤§ç©ºé—´å·¥ä½œä¸å®æ—¶è·Ÿè¸ªåŠŸèƒ½çš„ç»“åˆï¼Œæ­ç¤ºå¯¹å¦‚ä½•æœ€å¥½åœ°åè°ƒã€æ§åˆ¶å’Œå»ºæ¨¡å¤§å‹æœºå™¨äººç³»ç»Ÿçš„æ–°ç†è§£ã€‚â€</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Nuxt 3 vs Next.jsï¼šæ–°æ‰‹é€‰å‹æŒ‡å—ä¸é¡¹ç›®å®æˆ˜å¯¹æ¯”]]></title>    <link>https://juejin.cn/post/7597168034617819155</link>    <guid>https://juejin.cn/post/7597168034617819155</guid>    <pubDate>2026-01-20T08:44:46.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597168034617819155" data-draft-id="7597253913247629353" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Nuxt 3 vs Next.jsï¼šæ–°æ‰‹é€‰å‹æŒ‡å—ä¸é¡¹ç›®å®æˆ˜å¯¹æ¯”"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,React.js"/> <meta itemprop="datePublished" content="2026-01-20T08:44:46.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜_June"/> <meta itemprop="url" content="https://juejin.cn/user/395479916219517"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Nuxt 3 vs Next.jsï¼šæ–°æ‰‹é€‰å‹æŒ‡å—ä¸é¡¹ç›®å®æˆ˜å¯¹æ¯”
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/395479916219517/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜_June
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:44:46.000Z" title="Tue Jan 20 2026 08:44:46 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç°ä»£Webå¼€å‘ä¸­ï¼Œä¸¤å¤§å…¨æ ˆæ¡†æ¶Nuxt 3å’ŒNext.jså æ®ç€æœåŠ¡ç«¯æ¸²æŸ“(SSR)é¢†åŸŸçš„ä¸»å¯¼åœ°ä½ã€‚å®ƒä»¬éƒ½æä¾›äº†<strong>æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ã€è‡ªåŠ¨ä»£ç åˆ†å‰²ã€SEOä¼˜åŒ–</strong>ç­‰ç°ä»£Webåº”ç”¨æ‰€éœ€çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†æŠ€æœ¯é€‰å‹èƒŒåçš„<strong>æŠ€æœ¯æ ˆå·®å¼‚</strong>å’Œ<strong>è®¾è®¡å“²å­¦</strong>å´å¤§ä¸ç›¸åŒã€‚</p>
<p>æœ¬æ–‡å°†é€šè¿‡å¯¹æ¯”åˆ†æï¼Œå¸®åŠ©å‰ç«¯æ–°æ‰‹ç†è§£è¿™ä¸¤å¤§æ¡†æ¶çš„åŒºåˆ«ï¼Œå¹¶æä¾›å®é™…çš„é¡¹ç›®åˆ›å»ºç¤ºä¾‹ã€‚</p>
<hr/>
<h2 data-id="heading-0">01 æ ¸å¿ƒå·®å¼‚ï¼šVueä¸Reactçš„æŠ€æœ¯æ ˆé€‰æ‹©</h2>
<p>Nuxt 3ä¸Next.jsæœ€æ ¹æœ¬çš„åŒºåˆ«åœ¨äºå…¶<strong>åº•å±‚æŠ€æœ¯æ ˆ</strong>ï¼š</p>
<ul>
<li><strong>Nuxt 3</strong>ï¼šåŸºäº<strong>Vue 3</strong>ç”Ÿæ€ç³»ç»Ÿï¼Œé‡‡ç”¨ç»„åˆå¼APIå’Œå“åº”å¼ç³»ç»Ÿ</li>
<li><strong>Next.js</strong>ï¼šåŸºäº<strong>React</strong>ç”Ÿæ€ç³»ç»Ÿï¼Œæ”¯æŒæœ€æ–°çš„Reactç‰¹æ€§</li>
</ul>
<p>è¿™ç§æ ¸å¿ƒå·®å¼‚å†³å®šäº†ä½ çš„å¼€å‘ä½“éªŒã€å­¦ä¹ æ›²çº¿ä»¥åŠå¯ç”¨çš„ç¬¬ä¸‰æ–¹åº“ç”Ÿæ€ã€‚</p>
<h3 data-id="heading-1">å­¦ä¹ æ›²çº¿å¯¹æ¯”</h3>
<p>å¯¹äºå®Œå…¨æ²¡æœ‰å‰ç«¯ç»éªŒçš„æ–°æ‰‹æ¥è¯´ï¼ŒVueé€šå¸¸è¢«è®¤ä¸ºæ¯”React<strong>å­¦ä¹ æ›²çº¿æ›´å¹³ç¼“</strong>ã€‚Vueçš„æ¨¡æ¿è¯­æ³•æ›´æ¥è¿‘ä¼ ç»ŸHTMLï¼Œè€ŒReactçš„JSXåˆ™éœ€è¦é€‚åº”å°†HTMLä¸JavaScriptæ··åˆç¼–å†™çš„æ¨¡å¼ã€‚</p>








































<table><thead><tr><th>æ¡†æ¶ç‰¹æ€§</th><th>Nuxt 3</th><th>Next.js</th></tr></thead><tbody><tr><td>åŸºç¡€æ¡†æ¶</td><td>Vue 3</td><td>React</td></tr><tr><td>è·¯ç”±ç³»ç»Ÿ</td><td>æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ï¼ˆpages/ç›®å½•ï¼‰</td><td>æ–‡ä»¶ç³»ç»Ÿè·¯ç”±ï¼ˆapp/ç›®å½•ï¼‰</td></tr><tr><td>æ•°æ®è·å–</td><td><code>useAsyncData</code>, <code>useFetch</code></td><td>æœåŠ¡ç«¯ç»„ä»¶ã€<code>fetch</code> API</td></tr><tr><td>çŠ¶æ€ç®¡ç†</td><td>Pinia (æ¨è)</td><td>Zustand, Reduxç­‰</td></tr><tr><td>æ ·å¼æ–¹æ¡ˆ</td><td>å¤šç§é€‰æ‹©ï¼ˆCSSæ¨¡å—ã€Tailwindç­‰ï¼‰</td><td>å¤šç§é€‰æ‹©ï¼ˆCSSæ¨¡å—ã€Tailwindç­‰ï¼‰</td></tr><tr><td>éƒ¨ç½²å¹³å°</td><td>Vercelã€Netlifyã€NodeæœåŠ¡å™¨ç­‰</td><td>Vercelï¼ˆå®˜æ–¹ï¼‰ã€Netlifyç­‰</td></tr></tbody></table>
<h3 data-id="heading-2">ç”Ÿæ€åœˆå¯¹æ¯”</h3>
<p>Next.jsæ‹¥æœ‰<strong>æ›´åºå¤§çš„ç¤¾åŒºå’Œæ›´ä¸°å¯Œçš„ç¬¬ä¸‰æ–¹åº“</strong>ï¼Œè¿™å¾—ç›ŠäºReactæœ¬èº«çš„æ™®åŠåº¦ã€‚Nuxt 3è™½ç„¶ç¤¾åŒºè§„æ¨¡è¾ƒå°ï¼Œä½†å…¶<strong>å®˜æ–¹æ¨¡å—è´¨é‡å¾ˆé«˜</strong>ï¼Œä¸”ä¸Vueç”Ÿæ€æ— ç¼é›†æˆã€‚</p>
<hr/>
<h2 data-id="heading-3">02 å¿«é€Ÿå…¥é—¨ï¼šåˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªåº”ç”¨</h2>
<h3 data-id="heading-4">Nuxt 3å…¥é—¨ç¤ºä¾‹</h3>
<p><strong>é¡¹ç›®åˆå§‹åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºNuxt 3é¡¹ç›®</span>
npx nuxi@latest init my-nuxt-app
<span class="hljs-built_in">cd</span> my-nuxt-app
npm install
npm run dev
</code></pre>
<p><strong>åˆ›å»ºé¡µé¢å’Œç»„ä»¶</strong>ï¼š</p>
<ol>
<li>åœ¨<code>pages/index.vue</code>ä¸­åˆ›å»ºä¸»é¡µï¼š</li>
</ol>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ¬¢è¿ä½¿ç”¨Nuxt 3<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰æ—¶é—´ï¼š{{ currentTime }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"refreshTime"</span>&gt;</span>åˆ·æ–°æ—¶é—´<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// ä½¿ç”¨ç»„åˆå¼API</span>
<span class="hljs-keyword">const</span> currentTime = <span class="hljs-title function_">ref</span>(<span class="hljs-string">''</span>)

<span class="hljs-comment">// è·å–æœåŠ¡å™¨æ—¶é—´</span>
<span class="hljs-title function_">onMounted</span>(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> { data } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">useFetch</span>(<span class="hljs-string">'/api/time'</span>)
  currentTime.<span class="hljs-property">value</span> = data.<span class="hljs-property">value</span>
})

<span class="hljs-comment">// å®¢æˆ·ç«¯äº¤äº’</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">refreshTime</span> = (<span class="hljs-params"/>) =&gt; {
  currentTime.<span class="hljs-property">value</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toLocaleString</span>()
}
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<ol start="2">
<li>åˆ›å»ºAPIç«¯ç‚¹<code>server/api/time.get.ts</code>ï¼š</li>
</ol>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineEventHandler</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
})
</code></pre>
<h3 data-id="heading-5">Next.jså…¥é—¨ç¤ºä¾‹</h3>
<p><strong>é¡¹ç›®åˆå§‹åŒ–</strong>ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># åˆ›å»ºNext.jsé¡¹ç›®ï¼ˆä½¿ç”¨App Routerï¼‰</span>
npx create-next-app@latest my-next-app
<span class="hljs-built_in">cd</span> my-next-app
npm install
npm run dev
</code></pre>
<p><strong>åˆ›å»ºé¡µé¢å’Œç»„ä»¶</strong>ï¼š</p>
<ol>
<li>åœ¨<code>app/page.tsx</code>ä¸­åˆ›å»ºä¸»é¡µï¼š</li>
</ol>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">HomePage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>æ¬¢è¿ä½¿ç”¨Next.js<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TimeDisplay</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-comment">// æœåŠ¡ç«¯ç»„ä»¶ï¼šè‡ªåŠ¨åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œ</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">TimeDisplay</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// åœ¨æœåŠ¡ç«¯è·å–æ•°æ®</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'http://worldtimeapi.org/api/timezone/Asia/Shanghai'</span>)
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>()
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰æ—¶é—´ï¼š{data.datetime}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ClientComponent</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-comment">// å®¢æˆ·ç«¯ç»„ä»¶ï¼šéœ€è¦"use client"æŒ‡ä»¤</span>
<span class="hljs-string">'use client'</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ClientComponent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;
      ç‚¹å‡»æ¬¡æ•°ï¼š{count}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  )
}
</code></pre>
<hr/>
<h2 data-id="heading-6">03 ç‰¹æ€§æ·±åº¦å¯¹æ¯”ï¼šæ•°æ®è·å–ä¸æ¸²æŸ“ç­–ç•¥</h2>
<h3 data-id="heading-7">æ•°æ®è·å–æ–¹å¼å¯¹æ¯”</h3>
<p><strong>Nuxt 3çš„æ•°æ®è·å–</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;template&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æ–‡ç« åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"pending"</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">v-else</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"post in posts"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"post.id"</span>&gt;</span>
        {{ post.title }}
      <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;/template&gt;

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// useAsyncDataç”¨äºæœåŠ¡ç«¯è·å–æ•°æ®</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: posts, pending } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">useAsyncData</span>(
  <span class="hljs-string">'posts'</span>,
  <span class="hljs-function">() =&gt;</span> $fetch(<span class="hljs-string">'https://api.example.com/posts'</span>)
)

<span class="hljs-comment">// useFetchæ˜¯useAsyncDataçš„ç®€å†™</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: user } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">useFetch</span>(<span class="hljs-string">'/api/user'</span>)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p><strong>Next.jsçš„æ•°æ®è·å–</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// åœ¨App Routerä¸­ï¼Œé¡µé¢ç»„ä»¶é»˜è®¤ä¸ºæœåŠ¡ç«¯ç»„ä»¶</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">PostsPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// ç›´æ¥ä½¿ç”¨fetch APIï¼ŒNext.jsä¼šè‡ªåŠ¨ä¼˜åŒ–</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'https://api.example.com/posts'</span>, {
    <span class="hljs-attr">next</span>: { <span class="hljs-attr">revalidate</span>: <span class="hljs-number">60</span> } <span class="hljs-comment">// æ¯60ç§’é‡æ–°éªŒè¯</span>
  })
  <span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">json</span>()
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>æ–‡ç« åˆ—è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {posts.map((post) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{post.id}</span>&gt;</span>{post.title}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">LikeButton</span> <span class="hljs-attr">postId</span>=<span class="hljs-string">{posts[0].id}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-comment">// å®¢æˆ·ç«¯äº¤äº’ç»„ä»¶éœ€è¦"use client"æŒ‡ä»¤</span>
<span class="hljs-string">'use client'</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">LikeButton</span>(<span class="hljs-params">{ postId }</span>) {
  <span class="hljs-keyword">const</span> [likes, setLikes] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>)
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setLikes(likes + 1)}&gt;
      ç‚¹èµ ({likes})
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  )
}
</code></pre>
<h3 data-id="heading-8">æ¸²æŸ“ç­–ç•¥å¯¹æ¯”</h3>
<p>ä¸¤ä¸ªæ¡†æ¶éƒ½æ”¯æŒå¤šç§æ¸²æŸ“ç­–ç•¥ï¼Œä½†å®ç°æ–¹å¼ä¸åŒï¼š</p>






























<table><thead><tr><th>æ¸²æŸ“æ¨¡å¼</th><th>Nuxt 3å®ç°</th><th>Next.jså®ç°</th></tr></thead><tbody><tr><td>é™æ€ç”Ÿæˆ(SSG)</td><td><code>nuxt generate</code></td><td><code>output: 'static'</code></td></tr><tr><td>æœåŠ¡ç«¯æ¸²æŸ“(SSR)</td><td>é»˜è®¤å¯ç”¨</td><td>é»˜è®¤å¯ç”¨ï¼ˆæœåŠ¡ç«¯ç»„ä»¶ï¼‰</td></tr><tr><td>å®¢æˆ·ç«¯æ¸²æŸ“(CSR)</td><td><code>&lt;ClientOnly&gt;</code>ç»„ä»¶</td><td>"use client"æŒ‡ä»¤</td></tr><tr><td>å¢é‡é™æ€å†ç”Ÿ(ISR)</td><td>é€šè¿‡æ¨¡å—å®ç°</td><td>åŸç”Ÿæ”¯æŒï¼ˆfetché€‰é¡¹ï¼‰</td></tr></tbody></table>
<hr/>
<h2 data-id="heading-9">04 å®é™…åº”ç”¨åœºæ™¯åˆ†æ</h2>
<h3 data-id="heading-10">ä½•æ—¶é€‰æ‹©Nuxt 3ï¼Ÿ</h3>
<ol>
<li><strong>VueæŠ€æœ¯æ ˆé¡¹ç›®</strong>ï¼šå›¢é˜Ÿå·²ç†Ÿæ‚‰Vueç”Ÿæ€</li>
<li><strong>å¿«é€ŸåŸå‹å¼€å‘</strong>ï¼šéœ€è¦å¿«é€Ÿæ­å»ºMVPäº§å“</li>
<li><strong>å†…å®¹å‹ç½‘ç«™</strong>ï¼šåšå®¢ã€æ–‡æ¡£ã€è¥é”€é¡µé¢</li>
<li><strong>é¡¹ç›®ç»“æ„æ¸…æ™°</strong>ï¼šå–œæ¬¢"çº¦å®šä¼˜äºé…ç½®"çš„ç†å¿µ</li>
</ol>
<p><strong>Nuxt 3ä¼˜åŠ¿åœºæ™¯ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js">&lt;!-- å¿«é€Ÿåˆ›å»º<span class="hljs-variable constant_">SEO</span>å‹å¥½çš„å†…å®¹é¡µé¢ --&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Head</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Title</span>&gt;</span>äº§å“ä»‹ç» - æˆ‘çš„ç½‘ç«™<span class="hljs-tag">&lt;/<span class="hljs-name">Title</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"description"</span> <span class="hljs-attr">:content</span>=<span class="hljs-string">"product.description"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Head</span>&gt;</span>
    
    <span class="hljs-tag">&lt;<span class="hljs-name">article</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{{ product.title }}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-comment">&lt;!-- å†…å®¹è‡ªåŠ¨æ¸²æŸ“ --&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ContentRenderer</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">"product"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="javascript">
<span class="hljs-comment">// è‡ªåŠ¨æ ¹æ®æ–‡ä»¶è·¯å¾„è·å–å†…å®¹</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: product } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">useAsyncData</span>(<span class="hljs-string">'product'</span>, <span class="hljs-function">() =&gt;</span> 
  <span class="hljs-title function_">queryContent</span>(<span class="hljs-string">'/products'</span>).<span class="hljs-title function_">findOne</span>()
)
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-11">ä½•æ—¶é€‰æ‹©Next.jsï¼Ÿ</h3>
<ol>
<li><strong>ReactæŠ€æœ¯æ ˆé¡¹ç›®</strong>ï¼šå›¢é˜Ÿå·²ç†Ÿæ‚‰Reactç”Ÿæ€</li>
<li><strong>å¤§å‹å¤æ‚åº”ç”¨</strong>ï¼šéœ€è¦Reactä¸°å¯Œç”Ÿæ€æ”¯æŒ</li>
<li><strong>éœ€è¦æœ€æ–°ç‰¹æ€§</strong>ï¼šå¸Œæœ›ä½¿ç”¨Reactæœ€æ–°åŠŸèƒ½</li>
<li><strong>Vercelå¹³å°éƒ¨ç½²</strong>ï¼šè®¡åˆ’ä½¿ç”¨Vercelçš„å®Œæ•´èƒ½åŠ›</li>
</ol>
<p><strong>Next.jsä¼˜åŠ¿åœºæ™¯ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¤æ‚çš„åŠ¨æ€ä»ªè¡¨æ¿åº”ç”¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">DashboardPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// å¹¶è¡Œè·å–å¤šä¸ªæ•°æ®æº</span>
  <span class="hljs-keyword">const</span> [sales, users, analytics] = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>([
    <span class="hljs-title function_">fetchSalesData</span>(),
    <span class="hljs-title function_">fetchUserData</span>(),
    <span class="hljs-title function_">fetchAnalyticsData</span>(),
  ])
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dashboard"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">SalesChart</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{sales}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserTable</span> <span class="hljs-attr">users</span>=<span class="hljs-string">{users}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AnalyticsOverview</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{analytics}</span> /&gt;</span>
      {/* å®æ—¶æ›´æ–°çš„å®¢æˆ·ç«¯ç»„ä»¶ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">LiveNotifications</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}

<span class="hljs-comment">// ä½¿ç”¨React Server Componentså®ç°éƒ¨åˆ†æ¸²æŸ“</span>
<span class="hljs-string">'use client'</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">LiveNotifications</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [notifications, setNotifications] = <span class="hljs-title function_">useState</span>([])
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// å»ºç«‹WebSocketè¿æ¥è·å–å®æ—¶æ•°æ®</span>
    <span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">'wss://api.example.com/notifications'</span>)
    <span class="hljs-comment">// ... å¤„ç†å®æ—¶æ•°æ®</span>
  }, [])
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">NotificationList</span> <span class="hljs-attr">items</span>=<span class="hljs-string">{notifications}</span> /&gt;</span></span>
}
</code></pre>
<hr/>
<h2 data-id="heading-12">05 å¼€å‘ä½“éªŒä¸å·¥å…·é“¾å¯¹æ¯”</h2>
<h3 data-id="heading-13">Nuxt 3çš„å¼€å‘ä½“éªŒ</h3>
<ol>
<li><strong>é›¶é…ç½®èµ·æ­¥</strong>ï¼šå¤§å¤šæ•°åŠŸèƒ½å¼€ç®±å³ç”¨</li>
<li><strong>æ¨¡å—ç³»ç»Ÿ</strong>ï¼šå®˜æ–¹å’Œç¤¾åŒºæ¨¡å—è´¨é‡é«˜</li>
<li><strong>TypeScriptæ”¯æŒ</strong>ï¼šä¸€æµçš„TypeScriptä½“éªŒ</li>
<li><strong>å¼€å‘å·¥å…·</strong>ï¼šNuxt DevToolsæä¾›å¼ºå¤§è°ƒè¯•èƒ½åŠ›</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Nuxt 3çš„å…¸å‹å·¥ä½œæµ</span>
npx nuxi@latest init my-project  <span class="hljs-comment"># åˆ›å»ºé¡¹ç›®</span>
npm install                       <span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
npm run dev                       <span class="hljs-comment"># å¼€å‘æ¨¡å¼</span>
npm run build                     <span class="hljs-comment"># ç”Ÿäº§æ„å»º</span>
npm run preview                   <span class="hljs-comment"># é¢„è§ˆç”Ÿäº§ç‰ˆæœ¬</span>
</code></pre>
<h3 data-id="heading-14">Next.jsçš„å¼€å‘ä½“éªŒ</h3>
<ol>
<li><strong>çµæ´»çš„é…ç½®</strong>ï¼šå¯æ ¹æ®éœ€è¦æ·±åº¦å®šåˆ¶</li>
<li><strong>TurboPack</strong>ï¼šæå¿«çš„æ„å»ºå’Œåˆ·æ–°é€Ÿåº¦</li>
<li><strong>å®Œå–„çš„æ–‡æ¡£</strong>ï¼šå®˜æ–¹æ–‡æ¡£è´¨é‡æé«˜</li>
<li><strong>Vercelé›†æˆ</strong>ï¼šæ— ç¼éƒ¨ç½²å’Œé¢„è§ˆä½“éªŒ</li>
</ol>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># Next.jsçš„å…¸å‹å·¥ä½œæµ</span>
npx create-next-app@latest my-app  <span class="hljs-comment"># åˆ›å»ºé¡¹ç›®</span>
npm install                        <span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
npm run dev                        <span class="hljs-comment"># å¼€å‘æ¨¡å¼</span>
npm run build                      <span class="hljs-comment"># ç”Ÿäº§æ„å»º</span>
npm run start                      <span class="hljs-comment"># å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨</span>
</code></pre>
<hr/>
<h2 data-id="heading-15">06 æ€§èƒ½ä¸ä¼˜åŒ–å¯¹æ¯”</h2>
<h3 data-id="heading-16">æ€§èƒ½ç‰¹å¾</h3>
<ol>
<li><strong>é¦–æ¬¡åŠ è½½æ€§èƒ½</strong>ï¼šä¸¤è€…éƒ½ä¼˜ç§€ï¼ŒNuxt 3åœ¨å°å‹é¡¹ç›®ä¸Šå¯èƒ½ç•¥å¿«</li>
<li><strong>å¼€å‘æœåŠ¡å™¨é€Ÿåº¦</strong>ï¼šNext.jsçš„Turbopackåœ¨å¤§å‹é¡¹ç›®ä¸Šä¼˜åŠ¿æ˜æ˜¾</li>
<li><strong>æ„å»ºé€Ÿåº¦</strong>ï¼šå–å†³äºé¡¹ç›®å¤§å°ï¼Œä¸¤è€…éƒ½æä¾›å¢é‡æ„å»º</li>
</ol>
<h3 data-id="heading-17">ä¼˜åŒ–æŠ€å·§å¯¹æ¯”</h3>
<p><strong>Nuxt 3ä¼˜åŒ–ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ç»„ä»¶æ‡’åŠ è½½å’Œå›¾ç‰‡ä¼˜åŒ– --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- å»¶è¿ŸåŠ è½½é‡å‹ç»„ä»¶ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">LazyMyHeavyComponent</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"showComponent"</span> /&gt;</span>
    
    <span class="hljs-comment">&lt;!-- è‡ªåŠ¨ä¼˜åŒ–çš„å›¾ç‰‡ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">NuxtImg</span>
      <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/hero.jpg"</span>
      <span class="hljs-attr">width</span>=<span class="hljs-string">"1200"</span>
      <span class="hljs-attr">height</span>=<span class="hljs-string">"600"</span>
      <span class="hljs-attr">loading</span>=<span class="hljs-string">"lazy"</span>
      <span class="hljs-attr">format</span>=<span class="hljs-string">"webp"</span>
    /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>
</code></pre>
<p><strong>Next.jsä¼˜åŒ–ç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä½¿ç”¨Next.jså†…ç½®ä¼˜åŒ–åŠŸèƒ½</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Image</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'next/image'</span>
<span class="hljs-keyword">import</span> dynamic <span class="hljs-keyword">from</span> <span class="hljs-string">'next/dynamic'</span>

<span class="hljs-comment">// åŠ¨æ€å¯¼å…¥é‡å‹ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HeavyComponent</span> = <span class="hljs-title function_">dynamic</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./HeavyComponent'</span>))

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">OptimizedPage</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      {/* è‡ªåŠ¨ä¼˜åŒ–çš„å›¾ç‰‡ç»„ä»¶ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Image</span>
        <span class="hljs-attr">src</span>=<span class="hljs-string">"/hero.jpg"</span>
        <span class="hljs-attr">alt</span>=<span class="hljs-string">"Hero image"</span>
        <span class="hljs-attr">width</span>=<span class="hljs-string">{1200}</span>
        <span class="hljs-attr">height</span>=<span class="hljs-string">{600}</span>
        <span class="hljs-attr">priority</span>=<span class="hljs-string">{false}</span> // <span class="hljs-attr">éå…³é”®å›¾ç‰‡å»¶è¿ŸåŠ è½½</span>
      /&gt;</span>
      
      {/* æ¡ä»¶åŠ è½½é‡å‹ç»„ä»¶ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">HeavyComponent</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  )
}
</code></pre>
<hr/>
<h2 data-id="heading-18">07 æ–°æ‰‹é€‰æ‹©å»ºè®®</h2>
<h3 data-id="heading-19">æ ¹æ®èƒŒæ™¯é€‰æ‹©</h3>
<ol>
<li>
<p><strong>å®Œå…¨é›¶åŸºç¡€</strong>ï¼š</p>
<ul>
<li>å¦‚æœå–œæ¬¢<strong>æ›´ç›´è§‚çš„æ¨¡æ¿è¯­æ³•</strong> â†’ é€‰æ‹©<strong>Nuxt 3</strong></li>
<li>å¦‚æœçœ‹é‡<strong>å°±ä¸šå¸‚åœºéœ€æ±‚</strong> â†’ é€‰æ‹©<strong>Next.js</strong></li>
</ul>
</li>
<li>
<p><strong>æœ‰å‰ç«¯åŸºç¡€</strong>ï¼š</p>
<ul>
<li>ç†Ÿæ‚‰HTML/CSS/JS â†’ éƒ½å¯å°è¯•ï¼Œæ ¹æ®åå¥½é€‰æ‹©</li>
<li>æœ‰Reactç»éªŒ â†’ é€‰æ‹©<strong>Next.js</strong></li>
<li>æœ‰Vueç»éªŒ â†’ é€‰æ‹©<strong>Nuxt 3</strong></li>
</ul>
</li>
</ol>
<h3 data-id="heading-20">æ ¹æ®é¡¹ç›®ç±»å‹é€‰æ‹©</h3>



































<table><thead><tr><th>é¡¹ç›®ç±»å‹</th><th>æ¨èæ¡†æ¶</th><th>ç†ç”±</th></tr></thead><tbody><tr><td>ä¸ªäººåšå®¢/ä½œå“é›†</td><td>Nuxt 3</td><td>å¿«é€Ÿæ­å»ºï¼ŒSEOä¼˜ç§€</td></tr><tr><td>ä¼ä¸šå®˜ç½‘/è¥é”€é¡µ</td><td>Nuxt 3</td><td>å¼€å‘æ•ˆç‡é«˜ï¼Œç»´æŠ¤ç®€å•</td></tr><tr><td>SaaS/ç®¡ç†åå°</td><td>Next.js</td><td>Reactç”Ÿæ€ä¸°å¯Œï¼Œç»„ä»¶åº“å¤š</td></tr><tr><td>ç”µå•†å¹³å°</td><td>Next.js</td><td>æ€§èƒ½ä¼˜åŒ–å®Œå–„ï¼Œç”Ÿæ€æˆç†Ÿ</td></tr><tr><td>å®æ—¶åº”ç”¨</td><td>å‡å¯</td><td>æ ¹æ®å›¢é˜ŸæŠ€æœ¯æ ˆé€‰æ‹©</td></tr></tbody></table>
<p>æ— è®ºé€‰æ‹©å“ªä¸ªæ¡†æ¶ï¼Œæœ€é‡è¦çš„æ˜¯<strong>å¼€å§‹æ„å»º</strong>ã€‚çœŸæ­£çš„ç»éªŒæ¥è‡ªäºé¡¹ç›®å®è·µï¼Œè€Œä¸æ˜¯æ¡†æ¶æ¯”è¾ƒã€‚</p>
<h2 data-id="heading-21">ğŸ—³ï¸ äº’åŠ¨æ—¶é—´ï¼šä½ çš„é€‰æ‹©æ˜¯ï¼Ÿ</h2>
<p>è¯»å®Œå…¨æ–‡ï¼Œç›¸ä¿¡ä½ å¯¹ Nuxt 3 å’Œ Next.js æœ‰äº†æ›´æ¸…æ™°çš„è®¤è¯†ã€‚æŠ€æœ¯é€‰å‹æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼ŒçœŸå®é¡¹ç›®ä¸­çš„ç»éªŒæ‰æ˜¯æœ€å®è´µçš„å‚è€ƒã€‚</p>
<p><strong>æ¬¢è¿åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„è§‚ç‚¹ï¼š</strong></p>
<ol>
<li>
<p><strong>æŠ•ç¥¨é€‰æ‹©</strong>ï¼šä½ ç›®å‰æ›´å€¾å‘äºæˆ–æ­£åœ¨ä½¿ç”¨å“ªä¸ªæ¡†æ¶ï¼Ÿ</p>
<ul>
<li>A. <strong>Nuxt 3</strong> (Vueé˜µè¥)</li>
<li>B. <strong>Next.js</strong> (Reacté˜µè¥)</li>
<li>C. <strong>ä¸¤ä¸ªéƒ½åœ¨ç”¨/è§‚æœ›ä¸­</strong></li>
</ul>
</li>
<li>
<p><strong>ç»éªŒåˆ†äº«</strong>ï¼šåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä½ ä½¿ç”¨ Nuxt 3 æˆ– Next.js æ—¶ï¼Œ<strong>é‡åˆ°çš„æœ€å¤§æŒ‘æˆ˜æˆ–æœ€æƒŠå–œçš„ä½“éªŒæ˜¯ä»€ä¹ˆï¼Ÿ</strong> ä½ çš„åˆ†äº«å¯¹å…¶ä»–å¼€å‘è€…ä¼šéå¸¸æœ‰å¸®åŠ©ï¼</p>
</li>
</ol>
<hr/>
<p>å…³æ³¨æˆ‘çš„å…¬ä¼—å·" <strong>å¤§å‰ç«¯å†é™©è®°</strong>"ï¼ŒæŒæ¡æ›´å¤šå‰ç«¯å¼€å‘å¹²è´§å§¿åŠ¿ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€ä»å¤æ³•ç¼–ç¨‹åˆ° AI Codingã€‘è·³å‡ºæ‰‹å†™ä»£ç çš„é™·é˜±]]></title>    <link>https://juejin.cn/post/7596991930985578547</link>    <guid>https://juejin.cn/post/7596991930985578547</guid>    <pubDate>2026-01-20T08:52:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596991930985578547" data-draft-id="7596698363963277350" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€ä»å¤æ³•ç¼–ç¨‹åˆ° AI Codingã€‘è·³å‡ºæ‰‹å†™ä»£ç çš„é™·é˜±"/> <meta itemprop="keywords" content="å‰ç«¯,äººå·¥æ™ºèƒ½,Trae"/> <meta itemprop="datePublished" content="2026-01-20T08:52:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="pany"/> <meta itemprop="url" content="https://juejin.cn/user/2041120304148845"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€ä»å¤æ³•ç¼–ç¨‹åˆ° AI Codingã€‘è·³å‡ºæ‰‹å†™ä»£ç çš„é™·é˜±
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2041120304148845/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    pany
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T08:52:08.000Z" title="Tue Jan 20 2026 08:52:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å…³äºæœ¬ä¸“æ ï¼šä½œè€… AI Coding è¿‡ç¨‹ä¸­æ²‰æ·€çš„çŸ¥è¯†ã€æŠ€å·§å’Œæ„Ÿæ‚Ÿå½¢æˆçš„é›¶åŸºç¡€æ‰‹æ‘¸æ‰‹æ•™ç¨‹</p>
</blockquote>
<h2 data-id="heading-0">ä¸æƒ³è´©å–ç„¦è™‘ï¼Œä½†...</h2>
<p>æ²¡é”™ï¼Œæ‰‹å†™ä»£ç çš„æ—¶ä»£å·²ç»ç»“æŸäº†ï¼Œæˆ–è€…è¯´æ­£åœ¨ç»“æŸä¸­ï¼Œæˆ‘ä»¬å¿…é¡»è½¬å˜ç¼–ç¨‹æ€ç»´ï¼Œè·³å‡ºæ‰‹å†™ä»£ç çš„é™·é˜±...</p>
<p>è¿™å¬ä¸Šå»ä¼¼ä¹éå¸¸æ‚²è§‚ï¼Œæ¯•ç«Ÿå¯¹ä¼ ç»Ÿå¼€å‘è€…è€Œè¨€ï¼Œèˆ’é€‚åŒºæ­£åœ¨ç“¦è§£ã€‚ä½†<strong>ä¸å…¶åœ¨æ—§æ—¶ä»£çš„æ®‹ä½™ä¸­ç„¦è™‘ï¼Œä¸å¦‚ä¸»åŠ¨æ‹¥æŠ± AI</strong>ï¼Œåœ¨è¿™ä¸ªæŠ€æœ¯èŒƒå¼è½¬ç§»çš„æ—¶åˆ»ï¼Œæ‰¾åˆ°è‡ªå·±æ–°çš„ç”Ÿæ€ä½ï¼Œé¿å…è¢«æ—¶ä»£æŠ›å¼ƒã€‚</p>
<h2 data-id="heading-1">æ€æƒ³é’¢å°</h2>
<p>ä½œä¸ºè¿™ä¸ªä¸“æ çš„å¼€ç¯‡æ–‡ç« ï¼Œæˆ‘æœ‰æƒ³è¿‡ç›´æˆªäº†å½“çš„å°†è‡ªå·±çš„ AI IDE å®è·µåˆ†äº«å‡ºæ¥ï¼Œæˆ–æ˜¯æ”¶é›†åˆ°çš„å„ç§ AI Coding çš„æœ€æ–°èµ„è®¯ã€‚ä½†æ˜¯æ€æ¥æƒ³å»ï¼Œæˆ‘è¿˜æ˜¯å†³å®šå…ˆå°è¯•é€šè¿‡è¿™ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œç»™æˆ‘è‡ªå·±å’Œä½œä¸ºè¯»è€…çš„ä½ æ‰“ä¸Šä¸€ä¸ªæ€æƒ³é’¢å° <strong>ã€Œæ‹¥æŠ± AIã€</strong></p>
<h2 data-id="heading-2">æ›´é«˜ç»´çš„æŠ½è±¡</h2>
<p>æ•´ä¸ªè½¯ä»¶å·¥ç¨‹å†å²ï¼Œå°±æ˜¯ä¸€ä¸ªä¸æ–­å¾€æ›´é«˜ç»´æŠ½è±¡çš„è¿‡ç¨‹ï¼Œç¦»æœºå™¨è¶Šæ¥è¶Šè¿œï¼Œç¦»ä¸šåŠ¡é€»è¾‘ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰è¶Šæ¥è¶Šè¿‘ã€‚</p>
<h3 data-id="heading-3">IDE çš„å‘å±•å†å²</h3>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4248d879242d46c18a1c4828954322ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcGFueQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769503927&amp;x-signature=b7WGLKPJkNaCek3UC2kxbQBGgds%3D" alt="image.png" loading="lazy"/></p>
<p>IDE çš„å‘å±•å¤§è‡´ç»å†ä¸ºä¸€ä»£æ–‡æœ¬ç¼–è¾‘å™¨/å‘½ä»¤è¡Œï¼ŒäºŒä»£ Vimï¼Œä¸‰ä»£ VSCodeï¼Œè¿™ä¹ˆä¸€ä¸ªè¿‡ç¨‹ã€‚</p>
<p>è¿™ä¸ªæ¼”è¿›è¿‡ç¨‹æœ‰ä¸€ä¸ªæ˜¾è‘—ç‰¹å¾ï¼Œå°±æ˜¯ IDE æ‰¿è½½çš„è„æ´»ç´¯æ´»è¶Šæ¥è¶Šå¤šï¼Œè€Œç•™ç»™äººç±»çš„åªå‰©ä¸‹æ ¸å¿ƒå†³ç­–ã€‚</p>
<p>æŒ‰ç…§è¿™ä¸ªé€»è¾‘ï¼Œå°† AI IDE åˆ’åˆ†ä¸ºç¬¬å››ä»£ç®€ç›´ä¸è¦å¤ªå®Œç¾ï¼Œå®ƒä¸å†ä»…ä»…æ˜¯æç¤ºä½ æ€ä¹ˆå†™ï¼Œè€Œæ˜¯ç›´æ¥å¸®ä½ å®¡æŸ¥ã€ç¼–å†™ç”šè‡³åˆå§‹åŒ–å·¥ç¨‹ã€‚<strong>å®ƒç”šè‡³ä¸å†æ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„å·¥å…·ï¼Œå®ƒåœ¨è¿™ä¸€åˆ»è½¬å˜ä¸ºäº†ä¸€ä¸ªä¼™ä¼´ï¼Œä¸€ä¸ªç»“å¯¹ç¼–ç¨‹å¯¹è±¡æˆ–æ˜¯ä¸€åªèªæ˜çš„å°é»„é¸­ã€‚</strong></p>
<p>å¹¶ä¸”éšç€ AI çš„æ„ˆå‘å¼ºå¤§ï¼Œå°†æ¥æ‰€è°“çš„ IDE éƒ½å°†ä¸å¤å­˜åœ¨ï¼Œç•™ç»™å¤§å®¶çš„å¯èƒ½åªæœ‰ä¸€ä¸ªå¯¹è¯æ¡†ï¼Œå°±åƒ TRAE SOLO æ¨¡å¼ä¸€æ ·ï¼Œå·²ç»åœ¨å°½å¯èƒ½å‡å°‘ä»£ç çš„æ›å…‰äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/431c8ce52e0e4694a05b2345e896f6f9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcGFueQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769503927&amp;x-signature=GWvq0lm%2BhzjIHm6qOTt7al3nerc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">ç¼–ç¨‹è¯­è¨€çš„å‘å±•å†å²</h3>
<p>åŒæ ·çš„ï¼Œç¼–ç¨‹è¯­è¨€çš„æ¼”å˜ä¹Ÿæ˜¯ä¸€éƒ¨<strong>é€ƒç¦»åº•å±‚ï¼Œå›å½’è‡ªç„¶è¯­è¨€</strong>çš„è¿›åŒ–å²ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1bc40f5e07ce42708ee444427880e17d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcGFueQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769503927&amp;x-signature=2NUoYHXtCdzeSLzS7lXpm1SCQDY%3D" alt="image.png" loading="lazy"/></p>
<p>ä»æœ€åˆæ™¦æ¶©éš¾æ‡‚çš„ <strong>0101 æœºå™¨ç </strong>ï¼Œåˆ°éœ€è¦è®°å¿†ç¹çæŒ‡ä»¤çš„<strong>æ±‡ç¼–è¯­è¨€</strong>ï¼Œå†åˆ°åæ¥è´´è¿‘äººç±»é€»è¾‘çš„<strong>é«˜çº§è¯­è¨€</strong>ï¼ˆå¦‚ C/C++ã€Javaã€Pythonã€JavaScripï¼‰ã€‚æ¯ä¸€ä»£è¯­è¨€çš„è¿­ä»£ï¼Œéƒ½æ˜¯åœ¨è¯•å›¾å±è”½åº•å±‚çš„å¤æ‚åº¦ï¼Œè®©æˆ‘ä»¬æ›´ä¸“æ³¨äºæˆ‘è¦åšä»€ä¹ˆï¼Œè€Œä¸æ˜¯ç”µè„‘è¯¥æ€ä¹ˆåŠ¨ã€‚</p>
<p>è€Œåˆ°äº† AI Coding æ—¶ä»£ï¼Œç¼–ç¨‹è¯­è¨€è¿æ¥äº†ç»ˆæçš„æŠ½è±¡ <strong>ã€Œè‡ªç„¶è¯­è¨€ Natural Languageã€</strong></p>
<p>æˆ‘ä»¬ä¸å†éœ€è¦çº ç»“äºè¯­æ³•ç³–ã€åˆ†å·æ˜¯ä¸æ˜¯æ¼å†™äº†ï¼Œæˆ–è€…æ˜¯ API çš„å…·ä½“å‚æ•°æ˜¯ä»€ä¹ˆã€‚<strong>Prompt å³ä»£ç ï¼Œæ„å›¾å³å®ç°ã€‚</strong> è¿™ç§ç»´åº¦çš„æå‡æ˜¯é™ç»´æ‰“å‡»å¼çš„ï¼Œå®ƒå°†ç¼–ç¨‹çš„é—¨æ§›å½»åº•æŠ¹å¹³ï¼Œè®©å¼€å‘è¿™ä»¶äº‹å›å½’åˆ°äº†æœ€çº¯ç²¹çš„é€»è¾‘æ„å»ºä¸åˆ›é€ åŠ›æœ¬èº«ã€‚</p>
<h2 data-id="heading-5">æ€ç»´çš„è½¬å˜</h2>
<p>å¦‚æœè¯´ AI æ˜¯ä¸€è‚¡ä¸å¯é˜»æŒ¡çš„æµªæ½®ï¼Œé‚£ä¹ˆæˆ‘è§‰å¾—ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è½¬å˜æ€ç»´æ‹¥æŠ±å®ƒã€‚ä½†æ˜¯åˆšå¼€å§‹ä½¿ç”¨å®ƒçš„æ—¶å€™å¯èƒ½ä¼šè¿›å…¥ä¸€ä¸ªé™·é˜±ï¼Œé‚£å°±æ˜¯ <strong>ã€Œå¤ªåœ¨æ„å®ƒå†™çš„ä»£ç ã€</strong></p>
<p>æˆ‘å°±è½å…¥äº†è¿™ä¸ªé™·é˜±ã€‚</p>
<p>æˆ‘è¿‡åº¦çš„åœ¨æ„äº†å®ƒå†™ä»£ç çš„å®Œç¾æ€§ï¼Œç”šè‡³ä¼šåœ¨æ„å®ƒæœ‰æ²¡æœ‰æŒ‰ç…§æˆ‘çš„æƒ³æ³•æ¥å†™ä»£ç ã€‚<strong>ä¸€æ—¦å®ƒç”Ÿæˆçš„ä»£ç ä¸å®Œç¾ï¼Œæˆ‘å°±ä¼šé™·å…¥ "æ”¹å®ƒä¸å¦‚è‡ªå·±å†™" çš„ç„¦èºä¸­</strong>ï¼Œå°±æ˜¯è¿™æ ·å¯¼è‡´æˆ‘æ‹¥æŠ±å®ƒæ‹¥æŠ±çš„ä¸å¤ŸåŠæ—¶ã€‚</p>
<p>è€Œè®©æˆ‘è·³å‡ºè¿™ä¸ªé™·é˜±çš„å¥‘æœºå°±æ˜¯ä¸€ä¸ªæ€ç»´çš„è½¬å˜ï¼Œ<strong>ä»å…³æ³¨ã€Œä»£ç ã€è½¬å˜ä¸ºå…³æ³¨ã€Œäº¤ä»˜æ•ˆç‡ã€</strong>ã€‚</p>
<p>å¯¹ï¼Œæ ¸å¿ƒæ˜¯ <strong>ã€Œæ•ˆç‡ã€</strong></p>
<p>åªè¦ AI å†™ä»£ç çš„èƒ½å¸®æˆ‘æé«˜æ•ˆç‡ï¼Œæˆ‘ä¼šå…è®¸è‡ªå·±å¿½ç•¥æ‰ä¸€äº›å®ƒçš„ä¸è¶³ã€‚å¹¶ä¸”ä¸€æ—¦æ€ç»´è½¬å˜æˆåŠŸï¼Œåç»­æ‰€æœ‰çš„ AI Coding è¿‡ç¨‹éƒ½é»˜é»˜å˜å¾—é¡ºç•…äº†èµ·æ¥ã€‚æ¯”å¦‚ï¼š</p>
<ul>
<li>ä¸å†é€è¡Œ Code Reviewï¼Œè€Œæ˜¯å®¡æŸ¥æ•´ä½“ç»“æ„</li>
<li>ä¸å†è¿‡åº¦çº ç»“å®ç°ç»†èŠ‚ï¼Œè€Œæ˜¯æ ¡éªŒé€»è¾‘æ˜¯å¦åˆç†</li>
<li>ä¸å†é‡ç‚¹å…³æ³¨ç¬¦ä¸ç¬¦åˆæˆ‘çš„æƒ³æ³•ï¼Œè€Œæ˜¯å…³æ³¨æœ‰æ²¡æœ‰å®ç°éœ€æ±‚</li>
</ul>
<p>è¿™æ—¶å€™ä¼šè‡ªç„¶è€Œç„¶çš„è¿›å…¥ç»ˆæé˜¶æ®µï¼Œé‚£å°±æ˜¯ <strong>ã€Œä¿¡ä»»ã€</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb39890b840c415897ca27f7e6c735b3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgcGFueQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769503927&amp;x-signature=K%2B5D71zeO5wDqK4UOSyDaFj3Quo%3D" alt="image.png" loading="lazy"/></p>
<p>ä¿¡ä»» AI å¹¶ä¸ä»£è¡¨ AI ä¸ä¼šçŠ¯é”™ï¼Œå®ƒå°±åƒä¸€ä¸ªé è°±çš„å‘˜å·¥ä¸€æ ·ï¼Œå€¼å¾—é¢†å¯¼å°†é‡è¦çš„äº‹æƒ…äº¤ä»˜ç»™ä»–ï¼Œè€Œé¢†å¯¼åªéœ€è¦ç­‰å¾…ç»“æœå³å¯ã€‚</p>
<h2 data-id="heading-6">ç»“è¯­</h2>
<p>è·³å‡ºé™·é˜±ï¼Œä¸ä»…ä»…æ˜¯ä¸ºäº†æ•ˆç‡ï¼Œæ›´æ˜¯ä¸ºäº†ç»™è‡ªå·±æ‹¿åˆ°ä¸€å¼ é€šå¾€æœªæ¥çš„å…¥åœºåˆ¸ã€‚</p>
<p><strong>è¿™ä¸€æ¬¡ï¼Œè®©æˆ‘ä»¬æ¢ä¸ªå§¿åŠ¿ï¼Œç»§ç»­ç¼–ç æœªæ¥ã€‚</strong></p>
<h2 data-id="heading-7">å…³æ³¨</h2>
<p>åŠæ—¶è·å–åç»­çš„æ–‡ç« æ›´æ–° ğŸ‘‡ğŸ»</p>
<ul>
<li>å…¬ä¼—å·ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fmp%2Fappmsgalbum%3F__biz%3DMzE5MTYyOTQxNQ%3D%3D%26action%3Dgetalbum%26album_id%3D4350407594377658379%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzE5MTYyOTQxNQ==&amp;action=getalbum&amp;album_id=4350407594377658379#wechat_redirect" ref="nofollow noopener noreferrer">å‰å¾€åˆé›†</a> æˆ–å…³æ³¨ä½œè€… <a href="https://link.juejin.cn?target=https%3A%2F%2Fprivate-user-images.githubusercontent.com%2F49087880%2F463475625-529bac73-f9e3-4311-94d0-3db57216b771.png%3Fjwt%3DeyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njg4OTgyMjQsIm5iZiI6MTc2ODg5NzkyNCwicGF0aCI6Ii80OTA4Nzg4MC80NjM0NzU2MjUtNTI5YmFjNzMtZjllMy00MzExLTk0ZDAtM2RiNTcyMTZiNzcxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMjAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTIwVDA4MzIwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA0OTQ0NGM5YTVmN2U5OTY4YjM2YTYxMWZhNWNlZjNjYjdhZjQ0MzI4ZWY2ZWRhNWJmMWZiNGVhY2UzMWI3MTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.HIggKscHDYHG65E0TrXL4fHQcQx8BM9WfRzyDAMdIzA" target="_blank" title="https://private-user-images.githubusercontent.com/49087880/463475625-529bac73-f9e3-4311-94d0-3db57216b771.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njg4OTgyMjQsIm5iZiI6MTc2ODg5NzkyNCwicGF0aCI6Ii80OTA4Nzg4MC80NjM0NzU2MjUtNTI5YmFjNzMtZjllMy00MzExLTk0ZDAtM2RiNTcyMTZiNzcxLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNjAxMjAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjYwMTIwVDA4MzIwNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA0OTQ0NGM5YTVmN2U5OTY4YjM2YTYxMWZhNWNlZjNjYjdhZjQ0MzI4ZWY2ZWRhNWJmMWZiNGVhY2UzMWI3MTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.HIggKscHDYHG65E0TrXL4fHQcQx8BM9WfRzyDAMdIzA" ref="nofollow noopener noreferrer">PanyCoding</a></li>
<li>æ˜é‡‘ï¼š<a href="https://juejin.cn/column/7596687515030192154" target="_blank" title="https://juejin.cn/column/7596687515030192154">å‰å¾€ä¸“æ </a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Spring æ‰æ˜¯æ’‘èµ·åŠJavaè¾¹å¤©çš„ç§˜å¯†æ­¦å™¨ï¼Ÿå¦‚æœ Spring æ’‚æŒ‘å­äº†ï¼ŒJavaä¼°è®¡ä¸€å¹´å†…å°±ä¼šè·Œä¸‹ç¥å›]]></title>    <link>https://juejin.cn/post/7597083949834174470</link>    <guid>https://juejin.cn/post/7597083949834174470</guid>    <pubDate>2026-01-20T06:54:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597083949834174470" data-draft-id="7597168034617098259" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Spring æ‰æ˜¯æ’‘èµ·åŠJavaè¾¹å¤©çš„ç§˜å¯†æ­¦å™¨ï¼Ÿå¦‚æœ Spring æ’‚æŒ‘å­äº†ï¼ŒJavaä¼°è®¡ä¸€å¹´å†…å°±ä¼šè·Œä¸‹ç¥å›"/> <meta itemprop="keywords" content="Java,Spring"/> <meta itemprop="datePublished" content="2026-01-20T06:54:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æŒ–åœŸæœº_008"/> <meta itemprop="url" content="https://juejin.cn/user/4373178080835884"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Spring æ‰æ˜¯æ’‘èµ·åŠJavaè¾¹å¤©çš„ç§˜å¯†æ­¦å™¨ï¼Ÿå¦‚æœ Spring æ’‚æŒ‘å­äº†ï¼ŒJavaä¼°è®¡ä¸€å¹´å†…å°±ä¼šè·Œä¸‹ç¥å›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4373178080835884/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æŒ–åœŸæœº_008
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T06:54:39.000Z" title="Tue Jan 20 2026 06:54:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    25
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>é•¿æœŸä»¥æ¥ï¼ŒJava è¢«ä¼ä¸šçº§å¼€å‘å¹¿æ³›ä½¿ç”¨ï¼Œä½†å¸¸è¢«åæ§½â€œç¹çã€å†—é•¿ã€å¯åŠ¨æ…¢â€ã€‚åœ¨äº‘åŸç”Ÿã€å¾®æœåŠ¡æˆä¸ºè¶‹åŠ¿çš„ä»Šå¤©ï¼ŒGoã€Python ç­‰è¯­è¨€ä»¥è½»é‡ã€å¿«é€Ÿå¸å¼•äº†å¤§é‡å¼€å‘è€…ã€‚</p>
<p>ç„¶è€Œç°å®æ˜¯ï¼š<strong>Java èƒ½åœ¨ä¼ä¸šçº§å¼€å‘ä¸­é•¿æœŸå æ®ä¸»å¯¼åœ°ä½ï¼Œå…¨é  Spring</strong>ã€‚<br/>
æ²¡æœ‰ Springï¼ŒJava çš„ç”Ÿäº§åŠ›å’Œç”Ÿæ€ä¼˜åŠ¿å¯èƒ½åœ¨ä¸€å¹´å†…å¿«é€Ÿä¸‹æ»‘ã€‚æœ¬æ–‡å°†ç”¨ç¡¬æ ¸ä»£ç ç¤ºä¾‹ï¼Œæ­ç¤º Spring ä¸ºä»€ä¹ˆæ’‘èµ·äº†åŠè¾¹å¤©ï¼Œä»¥åŠå®ƒå¯¹ Java çš„å†³å®šæ€§ä½œç”¨ã€‚</p>
<p>åŸæ–‡åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhiliaole.top%2Farchives%2F1768891158556-LFjEiCc3" target="_blank" title="https://zhiliaole.top/archives/1768891158556-LFjEiCc3" ref="nofollow noopener noreferrer">zhiliaole.top/archives/17â€¦</a></p>
<p>æ›´å¤šæ–‡ç« ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhiliaole.top" target="_blank" title="https://zhiliaole.top" ref="nofollow noopener noreferrer">zhiliaole.top</a></p>
<hr/>
<h2 data-id="heading-0">1. åŸç”Ÿ Java çš„ç¹çç—›ç‚¹</h2>
<p>åŸç”Ÿ Java æ“ä½œæ•°æ®åº“æ—¶çš„ä½æ•ˆï¼Œé•¿æœŸè®©å¼€å‘è€…å¤´ç–¼ã€‚ä¸¾ä¸€ä¸ª JDBC æŸ¥è¯¢ç”¨æˆ·çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">Connection <span class="hljs-attr">conn</span> = null<span class="hljs-comment">;</span>
PreparedStatement <span class="hljs-attr">stmt</span> = null<span class="hljs-comment">;</span>
ResultSet <span class="hljs-attr">rs</span> = null<span class="hljs-comment">;</span>
try {
    Class.forName("com.mysql.cj.jdbc.Driver")<span class="hljs-comment">;</span>
    <span class="hljs-attr">conn</span> = DriverManager.getConnection(DB_URL, USER, PASS)<span class="hljs-comment">;</span>
    String <span class="hljs-attr">sql</span> = <span class="hljs-string">"SELECT * FROM t_user WHERE id = ?"</span><span class="hljs-comment">; </span>
    <span class="hljs-attr">stmt</span> = conn.prepareStatement(sql)<span class="hljs-comment">;</span>
    stmt.setLong(1, 1001L)<span class="hljs-comment">;</span>
    <span class="hljs-attr">rs</span> = stmt.executeQuery()<span class="hljs-comment">;</span>
    while(rs.next()){
        User <span class="hljs-attr">user</span> = new User()<span class="hljs-comment">;</span>
        user.setId(rs.getLong("id"))<span class="hljs-comment">;</span>
        user.setName(rs.getString("name"))<span class="hljs-comment">;</span>
        // è¿˜æœ‰åå‡ ä¸ªå­—æ®µè¦æ‰‹åŠ¨æ˜ å°„
    }
} catch (Exception e) {
    e.printStackTrace()<span class="hljs-comment">;</span>
} finally {
    if(rs != null) try { rs.close()<span class="hljs-comment">; } catch(SQLException e) {}</span>
    if(stmt != null) try { stmt.close()<span class="hljs-comment">; } catch(SQLException e) {}</span>
    if(conn != null) try { conn.close()<span class="hljs-comment">; } catch(SQLException e) {}</span>
}
</code></pre>
<p>è¿™åªæ˜¯æŸ¥è¯¢ä¸€ä¸ªç”¨æˆ·ã€‚è‹¥åŠ ä¸Šäº‹åŠ¡ã€è¿æ¥æ± ã€ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¼€å‘è€…å¯èƒ½è¦å†™ä¸Šç™¾è¡Œé‡å¤ã€æ˜“é”™çš„ä»£ç ã€‚</p>
<p>è€Œæœ‰äº† Springï¼Œåªéœ€ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title">UserRepository</span> <span class="hljs-title">extends</span> <span class="hljs-title">JpaRepository</span>&lt;<span class="hljs-title">User</span>, <span class="hljs-title">Long</span>&gt; {
    <span class="hljs-comment">// è‡ªåŠ¨ç”Ÿæˆ CRUD æ–¹æ³•ï¼Œæ— éœ€æ‰‹å†™ SQL</span>
}
</code></pre>
<p>Spring <strong>æ‰˜ç®¡ç¹çå·¥ä½œ</strong>ï¼Œè®©å¼€å‘è€…ä¸“æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œæ•ˆç‡ç¿»å€ã€‚</p>
<hr/>
<h2 data-id="heading-1">2. IoC ä¸ AOPï¼šä¼ä¸šçº§å¼€å‘åˆ©å™¨</h2>
<p>Spring çš„æ ¸å¿ƒåœ¨äº <strong>IoCï¼ˆæ§åˆ¶åè½¬ï¼‰</strong> å’Œ <strong>AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰</strong> ï¼Œè§£å†³ä¾èµ–ç®¡ç†å’Œæ¨ªåˆ‡é€»è¾‘éš¾é¢˜ã€‚</p>
<ul>
<li><strong>IoC / DIï¼šè‡ªåŠ¨æ³¨å…¥ä¾èµ–</strong></li>
</ul>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserService</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserRepository userRepository;

    <span class="hljs-keyword">public</span> UserService(UserRepository userRepository) {
        <span class="hljs-keyword">this</span>.userRepository = userRepository; <span class="hljs-comment">// Spring è‡ªåŠ¨æ³¨å…¥</span>
    }

    <span class="hljs-keyword">public</span> User getUser(<span class="hljs-built_in">Long</span> id) {
        <span class="hljs-keyword">return</span> userRepository.findById(id).orElse(<span class="hljs-literal">null</span>);
    }
}
</code></pre>
<ul>
<li><strong>AOPï¼šæ—¥å¿—ã€äº‹åŠ¡ã€æƒé™ç­‰æ¨ªåˆ‡é€»è¾‘ç‹¬ç«‹å¤„ç†</strong></li>
</ul>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Aspect</span>
<span class="hljs-variable">@Component</span>
public class LoggingAspect {
    <span class="hljs-variable">@Before</span>(<span class="hljs-string">"execution(* com.example.service.*.*(..))"</span>)
    public void <span class="hljs-built_in">logBefore</span>(JoinPoint joinPoint) {
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"Executing: "</span> + joinPoint.<span class="hljs-built_in">getSignature</span>());
    }
}
</code></pre>
<p>IoC ç®¡ç†ä¾èµ–ï¼ŒAOP ç®¡ç†æ¨ªåˆ‡é€»è¾‘ï¼Œè®©ä¼ä¸šçº§ä»£ç æ›´æ¸…æ™°ã€æ›´å¯ç»´æŠ¤ã€‚</p>
<hr/>
<h2 data-id="heading-2">3. ä¼ä¸šçº§å¼€å‘å¸¸è§åœºæ™¯ï¼šSpring è‡ªåŠ¨åŒ–æ‰˜ç®¡</h2>
<h3 data-id="heading-3">äº‹åŠ¡ç®¡ç†</h3>
<p>åŸç”Ÿ Java æ‰‹åŠ¨äº‹åŠ¡ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">Connection conn = null;
try {
    conn = DriverManager<span class="hljs-selector-class">.getConnection</span>(DB_URL, USER, PASS);
    conn<span class="hljs-selector-class">.setAutoCommit</span>(false);
    <span class="hljs-comment">// æ‰§è¡Œå¤šæ¡ SQL</span>
    conn<span class="hljs-selector-class">.commit</span>();
} <span class="hljs-built_in">catch</span>(SQLException e) {
    <span class="hljs-built_in">if</span>(conn != null) try { conn<span class="hljs-selector-class">.rollback</span>(); } <span class="hljs-built_in">catch</span>(SQLException ex) {}
}
</code></pre>
<p>Spring è‡ªåŠ¨äº‹åŠ¡ç®¡ç†ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@Service</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderService</span> {

    <span class="hljs-meta">@Transactional</span>
    <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">createOrder</span>(<span class="hljs-params">Order order</span>) {
        orderRepository.<span class="hljs-title function_">save</span>(order);
        inventoryService.<span class="hljs-title function_">reduceStock</span>(order.<span class="hljs-title function_">getItems</span>());
    }
}
</code></pre>
<h3 data-id="heading-4">ç¼“å­˜ç®¡ç†</h3>
<pre><code class="hljs language-kotlin" lang="kotlin"><span class="hljs-meta">@Cacheable(value = <span class="hljs-string">"users"</span>, key = <span class="hljs-string">"#id"</span>)</span>
<span class="hljs-keyword">public</span> User getUser(<span class="hljs-built_in">Long</span> id) {
    <span class="hljs-keyword">return</span> userRepository.findById(id).orElse(<span class="hljs-literal">null</span>);
}
</code></pre>
<h3 data-id="heading-5">æ¶ˆæ¯é˜Ÿåˆ—é›†æˆ</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@RabbitListener</span>(queues = <span class="hljs-string">"order.queue"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">handleOrderMessage</span>(<span class="hljs-params">Order order</span>) {
    <span class="hljs-title class_">System</span>.<span class="hljs-property">out</span>.<span class="hljs-title function_">println</span>(<span class="hljs-string">"Received order: "</span> + order);
}
</code></pre>
<p>Spring å°†ä¼ä¸šçº§å¼€å‘å¸¸è§åœºæ™¯æ ‡å‡†åŒ–ã€è‡ªåŠ¨åŒ–ã€å¯æ‰©å±•ï¼Œæå¤§é™ä½å¼€å‘æˆæœ¬ã€‚</p>
<hr/>
<h2 data-id="heading-6">4. äº‘åŸç”Ÿæ—¶ä»£ï¼šSpring ä¿ä½ Java çš„ä½ç½®</h2>
<p>åœ¨ Cloud Native æ—¶ä»£ï¼Œå¾®æœåŠ¡ã€å®¹å™¨åŒ–ã€Kubernetes å·²æˆæ ‡é…ã€‚Go å¯åŠ¨å¿«ã€ä½“ç§¯å°ï¼ŒJava JVM åšé‡ï¼ŒåŸç”Ÿæ”¯æŒä¸è¶³ã€‚</p>
<p><strong>Spring Boot + Spring Cloud æ˜¯ Java çš„æ•‘å‘½ç¨»è‰ï¼š</strong></p>
<ul>
<li><strong>é…ç½®ç®¡ç†</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">spring:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">user-service</span>
  <span class="hljs-attr">cloud:</span>
    <span class="hljs-attr">config:</span>
      <span class="hljs-attr">uri:</span> <span class="hljs-string">http://config-server:8888</span>
</code></pre>
<ul>
<li><strong>æœåŠ¡å‘ç°ä¸ç†”æ–­</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@EnableDiscoveryClient</span>
<span class="hljs-variable">@RestController</span>
public class UserController {
    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/hello"</span>)
    public String <span class="hljs-built_in">hello</span>() {
        <span class="hljs-selector-tag">return</span> "<span class="hljs-selector-tag">Hello</span> <span class="hljs-selector-tag">from</span> <span class="hljs-selector-tag">User</span> <span class="hljs-selector-tag">Service</span>!";
    }
}
</code></pre>
<ul>
<li><strong>åŸç”Ÿé•œåƒå¯åŠ¨é€Ÿåº¦</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-arduino" lang="arduino">./mvnw spring-boot:build-image -Dspring-boot.build-image.imageName=user-service
</code></pre>
<p>æ²¡æœ‰ Spring çš„ç»Ÿä¸€ç”Ÿæ€ï¼ŒJava åœ¨å¾®æœåŠ¡æ¶æ„ä¸‹å°±åƒç©¿ç€é‡è£…ç›”ç”²çš„æ­¥å…µå»è¿½æ‘©æ‰˜è½¦çš„ç‰¹ç§å…µâ€”â€”ç´¯æ­»ä¹Ÿè¿½ä¸ä¸Šã€‚</p>
<hr/>
<h2 data-id="heading-7">5. æ€§èƒ½ä¸å¯æ‰©å±•æ€§</h2>
<p>Spring æ¨¡å—åŒ–è®¾è®¡ï¼Œè®©åº”ç”¨è½»é‡åˆçµæ´»ï¼š</p>
<ul>
<li><strong>è½»é‡å®¹å™¨</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">AnnotationConfigApplicationContext <span class="hljs-attr">context</span> = 
        new AnnotationConfigApplicationContext(AppConfig.class)<span class="hljs-comment">;</span>
MyService <span class="hljs-attr">service</span> = context.getBean(MyService.class)<span class="hljs-comment">;</span>
</code></pre>
<ul>
<li><strong>æ‡’åŠ è½½</strong>ï¼š</li>
</ul>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@Service</span>
<span class="hljs-variable">@Lazy</span>
public class HeavyService {
    <span class="hljs-selector-tag">public</span> <span class="hljs-selector-tag">HeavyService</span>() {
        <span class="hljs-selector-tag">System</span><span class="hljs-selector-class">.out</span><span class="hljs-selector-class">.println</span>(<span class="hljs-string">"Initialized only when needed"</span>);
    }
}
</code></pre>
<ul>
<li><strong>å¾®æœåŠ¡æ‰©å±•ï¼ˆFeign è°ƒç”¨ï¼‰</strong> ï¼š</li>
</ul>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@FeignClient</span>(name = <span class="hljs-string">"order-service"</span>)
public interface OrderClient {
    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/orders/{id}"</span>)
    Order <span class="hljs-built_in">getOrder</span>(<span class="hljs-variable">@PathVariable</span> Long id);
}
</code></pre>
<ul>
<li><strong>åˆ†å¸ƒå¼æ”¯æŒ</strong>ï¼šRPCã€æ¶ˆæ¯é˜Ÿåˆ—ã€ç¼“å­˜ã€è´Ÿè½½å‡è¡¡æ— ç¼é›†æˆã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-8">6. ç¤¾åŒºä¸ç”Ÿæ€ï¼šJava é•¿æœŸæŠ¤èˆª</h2>
<p>Java çš„ç”Ÿå‘½åŠ›ä¸ä»…åœ¨è¯­è¨€æœ¬èº«ï¼Œæ›´åœ¨ç¤¾åŒºä¸ç”Ÿæ€ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<p>Spring ç¤¾åŒºæ´»è·ƒã€æ–‡æ¡£å®Œå–„ã€æŒç»­ä¼˜åŒ–ï¼Œå¤§é‡ä¼ä¸šçº§é¡¹ç›®ä¾èµ– Springï¼Œä½¿ Java é•¿æœŸå æ®ä¼ä¸šçº§å¼€å‘ä¸»å¯¼åœ°ä½ã€‚</p>
<hr/>
<h2 data-id="heading-9">7. å¦‚æœ Spring æ’‚æŒ‘å­ï¼ŒJava ä¼šæ€æ ·ï¼Ÿ</h2>
<ul>
<li>å¼€å‘æ•ˆç‡éª¤é™ï¼šäº‹åŠ¡ã€ç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—éœ€æ‰‹åŠ¨ç®¡ç†</li>
<li>å¾®æœåŠ¡ä¸äº‘åŸç”Ÿå—é˜»</li>
<li>ç”Ÿæ€ä½“ç³»å´©å¡Œï¼šå¼€æºé¡¹ç›®å’ŒåŸ¹è®­ç»éªŒå¤±æ•ˆ</li>
</ul>
<p>å¯ä»¥è¯´ï¼Œ<strong>Spring çš„å‘½è¿å‡ ä¹å†³å®šäº† Java çš„æœªæ¥</strong>ã€‚æ²¡æœ‰ Springï¼ŒJava å¯èƒ½åœ¨ä¸€å¹´å†…è·Œä¸‹ç¥å›ã€‚</p>
<hr/>
<h2 data-id="heading-10">8. æ€»ç»“ï¼šSpringï¼ŒæŠŠ Java æ’‘èµ·åŠè¾¹å¤©</h2>
<p>Java æ˜¯éª¨éª¼ï¼ŒSpring æ˜¯è‚Œè‚‰ã€‚å®ƒæ‰˜èµ·ç¹ççš„æ•°æ®åº“æ“ä½œã€äº‹åŠ¡ç®¡ç†ã€å¾®æœåŠ¡å’Œäº‘åŸç”Ÿæ¶æ„ï¼Œè®©ä¼ä¸šçº§å¼€å‘é«˜æ•ˆã€å¯ç»´æŠ¤ã€‚</p>
<p>æ²¡æœ‰ Springï¼ŒJava å°†å¤±å»å¿«é€Ÿå¼€å‘èƒ½åŠ›ã€äº‘åŸç”Ÿé€‚é…å’Œç”Ÿæ€æ”¯æ’‘ï¼Œç”šè‡³å¯èƒ½è¢«æ–°ä¸€ä»£è¯­è¨€èµ¶è¶…ã€‚<strong>Spring æ˜¯ Java ç”Ÿæ€èµ–ä»¥ç”Ÿå­˜çš„æŠ¤èˆªè€…ã€‚</strong></p>
<p>åŸæ–‡åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhiliaole.top%2Farchives%2F1768891158556-LFjEiCc3" target="_blank" title="https://zhiliaole.top/archives/1768891158556-LFjEiCc3" ref="nofollow noopener noreferrer">zhiliaole.top/archives/17â€¦</a></p>
<p>æ›´å¤šæ–‡ç« ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fzhiliaole.top" target="_blank" title="https://zhiliaole.top" ref="nofollow noopener noreferrer">zhiliaole.top</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¦‚ä½•ä½¿ç”¨Python Mammothå°†DOCXè½¬æ¢ä¸ºHTMLï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596990822128025638</link>    <guid>https://juejin.cn/post/7596990822128025638</guid>    <pubDate>2026-01-20T06:57:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596990822128025638" data-draft-id="7596998306380873778" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¦‚ä½•ä½¿ç”¨Python Mammothå°†DOCXè½¬æ¢ä¸ºHTMLï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-20T06:57:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç–è€€é‡Œ"/> <meta itemprop="url" content="https://juejin.cn/user/2647279730957981"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¦‚ä½•ä½¿ç”¨Python Mammothå°†DOCXè½¬æ¢ä¸ºHTMLï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2647279730957981/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç–è€€é‡Œ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T06:57:24.000Z" title="Tue Jan 20 2026 06:57:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18f705b87e7543dbbd9fa306a1403bd1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546W6ICA6YeM:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769497079&amp;x-signature=WN6IA3HC3V5aquKN7cI7kC7vvT0%3D" alt="ScreenShot_2026-01-20_143218_075.png" loading="lazy"/></p>
<p>æˆ‘ä»¬åœ¨å®é™…çš„é¡¹ç›®å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰æ—¶å€™ä¸å¾—ä¸å°†æ–‡ä»¶ä»ä¸€ç§æ ¼å¼è½¬æ¢ä¸ºå¦ä¸€ç§æ ¼å¼ã€‚</p>
<p>DOCXï¼ˆç”± Microsoft Word ä½¿ç”¨ï¼‰æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„æ–‡ä»¶æ ¼å¼ï¼Œè¢«å¾ˆå¤šäººä½¿ç”¨ã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›å°† Word æ–‡æ¡£è½¬æ¢ä¸º HTMLã€‚</p>
<p>è¿™å¯ä»¥é€šè¿‡Â MammothÂ åŒ…è½»æ¾å®ç°ã€‚å®ƒæ˜¯ä¸€ä¸ªç”¨äºå°† DOCX æ–‡ä»¶è½¬æ¢ä¸º HTML çš„ç®€å•ã€é«˜æ•ˆã€å¿«é€Ÿçš„åº“ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åœ¨ Python ä¸­ä½¿ç”¨ Mammoth å°† DOCX è½¬æ¢ä¸º HTMLã€‚</p>
<h2 data-id="heading-0">å®‰è£… Mammoth</h2>
<p>é¦–å…ˆï¼Œåœ¨å®‰è£…ä¹‹å‰å‡†å¤‡å¥½å¹¶æ¿€æ´»ä½ çš„è™šæ‹Ÿç¯å¢ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python3 -m venv myenv
. myenv/bin/activate
</code></pre>
<p>ç„¶åï¼Œä½¿ç”¨<code>pip</code>å®‰è£… Mammothï¼š</p>
<pre><code class="hljs">pip3 install mammoth
</code></pre>
<p>æœ¬æ•™ç¨‹ä½¿ç”¨çš„ Mammoth ç‰ˆæœ¬æ˜¯ 1.4.15ã€‚åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œè¯·ç¡®ä¿å®ƒæ˜¯.docx æ–‡ä»¶ï¼</p>
<p>ä»¥ä¸Šç¯å¢ƒå‡†å¤‡å¥½åï¼Œç°åœ¨è®©æˆ‘ä»¬å¼€å§‹æå–æ–‡æœ¬å¹¶å°†å…¶è½¬æ¢æˆ HTMLã€‚</p>
<h2 data-id="heading-1">æå– DOCX æ–‡ä»¶çš„åŸå§‹æ–‡æœ¬</h2>
<p>åœ¨è½¬æ¢ä¸º HTML æ—¶ä¿ç•™æ ¼å¼æ˜¯ Mammoth çš„æœ€ä½³åŠŸèƒ½ä¹‹ä¸€ã€‚è¿™é‡Œæˆ‘ä»¬åªéœ€è¦å‡ è¡Œä»£ç è½¬æ¢æˆä½ éœ€è¦ DOCX æ–‡ä»¶çš„æ–‡æœ¬ã€‚</p>
<p>ä½¿ç”¨ extract_raw_text()æ–¹æ³•æ¥è·å–å®ƒï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> mammoth

<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_filename, <span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> docx_file:
    result = mammoth.extract_raw_text(docx_file)
    text = result.value <span class="hljs-comment"># The raw text</span>
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'output.txt'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> text_file:
        text_file.write(text)
</code></pre>
<p>æ³¨æ„ï¼Œæ­¤æ–¹æ³•ä¸ä¼šè¿”å›æœ‰æ•ˆçš„ HTML æ–‡æ¡£ã€‚å®ƒåªè¿”å›é¡µé¢ä¸Šçš„æ–‡æœ¬ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨.txt æ‰©å±•æ¥ä¿å­˜å®ƒã€‚å¦‚æœä½ ç¡®å®éœ€è¦ä¿æŒå¸ƒå±€æˆ–æ ¼å¼ï¼Œä½ éœ€è¦æå– HTML å†…å®¹ã€‚</p>
<h2 data-id="heading-2">å°† Docx è½¬æ¢ä¸º HTML å¹¶è‡ªå®šä¹‰æ ·å¼æ˜ å°„</h2>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMammoth å°†æ–‡æ¡£è½¬æ¢ä¸º HTMLï¼Œä½†å®ƒä¸ä¼šæä¾›æœ‰æ•ˆçš„ HTML é¡µé¢ã€‚è™½ç„¶ç½‘é¡µæµè§ˆå™¨å¯ä»¥æ˜¾ç¤ºå†…å®¹ï¼Œä½†å®ƒç¼ºå°‘ä¸€ä¸ª<code>&lt;html&gt;</code>æ ‡ç­¾æ¥å°è£…æ–‡æ¡£ï¼Œä»¥åŠä¸€ä¸ª<code>&lt;body&gt;</code>æ ‡ç­¾æ¥åŒ…å«æ–‡æ¡£ã€‚</p>
<p>å‡è®¾ä½¿ç”¨çš„æ˜¯å¸¦æœ‰æ¨¡æ¿çš„ç½‘ç»œæ¡†æ¶ã€‚å¯èƒ½ä¼šå®šä¹‰ä¸€ä¸ªæ¨¡æ¿æ¥æ˜¾ç¤º Word æ–‡æ¡£ï¼Œå¹¶å°† Mammoth çš„è¾“å‡ºåŠ è½½åˆ°æ¨¡æ¿ä¸»ä½“å†…ã€‚</p>
<p>Mammoth ä¸ä»…åœ¨å¦‚ä½•ä½¿ç”¨å…¶è¾“å‡ºæ–¹é¢å…·æœ‰çµæ´»æ€§ï¼Œè€Œä¸”åœ¨å¦‚ä½•åˆ›å»ºè¾“å‡ºæ–¹é¢ä¹Ÿå…·æœ‰å¾ˆå¤§çš„çµæ´»æ€§ã€‚ç‰¹åˆ«æ˜¯åœ¨æˆ‘ä»¬æƒ³è¦æ ·å¼åŒ–æˆ‘ä»¬ç”Ÿæˆçš„ HTML æ—¶ï¼Œæˆ‘ä»¬æœ‰å¾ˆå¤šé€‰é¡¹ã€‚æˆ‘ä»¬é€šè¿‡å°†æ¯ä¸ª DOCX æ ¼å¼è§„åˆ™åŒ¹é…åˆ°ç›¸åº”çš„ CSS è§„åˆ™æ¥æ˜ å°„æ ·å¼ã€‚</p>
<p>è¦æŸ¥çœ‹ä½ çš„ DOCX æ–‡ä»¶æœ‰å“ªäº›æ ·å¼ï¼Œä½ æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p>
<ol>
<li>ä½¿ç”¨ MS Word æ‰“å¼€æ‚¨çš„ docx æ–‡ä»¶ï¼Œå¹¶æ£€æŸ¥æ ·å¼å·¥å…·æ ã€‚</li>
<li>é€šè¿‡ç”¨è§£å‹ç®¡ç†å™¨æ‰“å¼€ä½ çš„ DOCX æ–‡ä»¶æ¥ç ”ç©¶ XML æ–‡ä»¶ï¼Œç„¶åå¯¼èˆªåˆ°<code>/word/styles.xml</code>å¹¶æ‰¾åˆ°ä½ çš„æ ·å¼ã€‚</li>
</ol>
<p>ç¬¬äºŒä¸ªé€‰é¡¹é€‚ç”¨äºæ— æ³•ä½¿ç”¨ MS Word æˆ–æ— æ³•è§£é‡Šå’Œæ˜¾ç¤ºæ ·å¼çš„æ›¿ä»£æ–‡å­—å¤„ç†ç¨‹åºçš„ç”¨æˆ·ã€‚</p>
<p>Mammoth å·²ç»é»˜è®¤æ¶µç›–äº†æŸäº›æœ€å¸¸ç”¨çš„æ ·å¼æ˜ å°„ã€‚ä¾‹å¦‚ï¼Œ<code>Heading1</code>åœ¨ docx æ ·å¼ä¸­æ˜ å°„åˆ° HTML å…ƒç´ çš„<code>&lt;h1&gt;</code>ï¼Œ<code>bold</code>è¢«æ˜ å°„åˆ° HTML å…ƒç´ çš„<code>&lt;strong&gt;</code>ï¼Œç­‰ç­‰ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥åœ¨æ˜ å°„æ—¶ä½¿ç”¨ Mammoth æ¥è‡ªå®šä¹‰æ–‡æ¡£çš„æ ·å¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³å°† DOCX æ–‡ä»¶ä¸­çš„æ‰€æœ‰<code>bold</code>å‡ºç°æ¬¡æ•°æ›´æ”¹ä¸º HTML ä¸­çš„æ–œä½“ï¼Œå¯ä»¥è¿™æ ·å­å®ç°ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> mammoth

custom_styles = <span class="hljs-string">"b =&gt; i"</span>

<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_filename, <span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> docx_file:
    result = mammoth.convert_to_html(docx_file, style_map = custom_styles)
    text = result.value
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'output.html'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> html_file:
        html_file.write(text)
</code></pre>
<p>é€šè¿‡ custom_styles å˜é‡ï¼Œå·¦è¾¹çš„æ ·å¼æ¥è‡ª DOCX æ–‡ä»¶ï¼Œè€Œå³è¾¹çš„æ˜¯ç›¸åº”çš„ CSSã€‚</p>
<p>å‡è®¾æˆ‘ä»¬æƒ³å®Œå…¨çœç•¥ç²—ä½“å‡ºç°çš„æ¬¡æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ˜ å°„ç›®æ ‡ç•™ç©ºï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">custom_styles</span> = <span class="hljs-string">"b =&gt; "</span>
</code></pre>
<p>æœ‰æ—¶æˆ‘ä»¬è½¬æ¢çš„æ–‡æ¡£ä¼šæœ‰å¾ˆå¤šæ ·å¼éœ€è¦ä¿ç•™ã€‚è¿™ä¸ªæ—¶å€™å†è¿™æ ·å®ç°å°±ä¼šå˜å¾—ä¸åˆ‡å®é™…ï¼Œè¦ä¸ºæ¯ä¸€ä¸ªæˆ‘ä»¬è¦æ˜ å°„çš„æ ·å¼éƒ½åˆ›å»ºä¸€ä¸ªå˜é‡ã€‚</p>
<p>ä¸è¿‡æœ‰è§£æ³•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>docstrings</code>ä¸€æ¬¡æ˜ å°„æˆ‘ä»¬æƒ³è¦çš„ä»»æ„å¤šä¸ªæ ·å¼ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">custom_styles</span> = <span class="hljs-string">""" b =&gt; del
                    u =&gt; em
                    p[style-name='Heading 1'] =&gt; i"""</span>
</code></pre>
<p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œæœ€åçš„æ˜ å°„ä¸å…¶ä»–çš„æœ‰ç‚¹ä¸åŒã€‚åœ¨æ˜ å°„æ ·å¼æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·<code>[]</code>å¹¶åœ¨å…¶ä¸­æ·»åŠ æ¡ä»¶ï¼Œè¿™æ ·åªæœ‰éƒ¨åˆ†å…ƒç´ ä¼šä»¥è¿™ç§æ–¹å¼è¿›è¡Œæ ·å¼è®¾ç½®ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œ<code>p[style-name='Heading 1']</code>é€‰æ‹©å…·æœ‰æ ·å¼åç§°çš„æ®µè½<code>Heading 1</code>ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>p[style-name^='Heading']</code>æ¥é€‰æ‹©å…·æœ‰ä»¥<code>Heading</code>å¼€å¤´çš„æ ·å¼åç§°çš„æ¯ä¸ªæ®µè½ã€‚</p>
<p>æ ·å¼æ˜ å°„è¿˜å…è®¸æˆ‘ä»¬å°†æ ·å¼æ˜ å°„åˆ°è‡ªå®šä¹‰ CSS ç±»ã€‚é€šè¿‡è¿™æ ·åšï¼Œæˆ‘ä»¬å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°ä¿®æ”¹ HTML çš„æ ·å¼ã€‚è®©æˆ‘ä»¬ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åœ¨æ–‡æ¡£å­—ç¬¦ä¸²ä¸­å®šä¹‰åŸºæœ¬çš„è‡ªå®šä¹‰ CSSï¼š</p>
<pre><code class="hljs language-xml" lang="xml">custom_css ="""
    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css">
    <span class="hljs-selector-class">.red</span>{
        <span class="hljs-attribute">color</span>: red;
    }
    <span class="hljs-selector-class">.underline</span>{
        <span class="hljs-attribute">text-decoration</span>: underline;
    }
    <span class="hljs-selector-class">.ul</span><span class="hljs-selector-class">.li</span>{
        <span class="hljs-attribute">list-style-type</span>: circle;
    }
    <span class="hljs-selector-tag">table</span>, <span class="hljs-selector-tag">th</span>, <span class="hljs-selector-tag">td</span> {
    <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid black;
    }
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
    """
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ›´æ–°æˆ‘ä»¬çš„æ˜ å°„ï¼Œä»¥å¼•ç”¨æˆ‘ä»¬åœ¨<code>&lt;style&gt;</code>å—ä¸­å®šä¹‰çš„ CSS ç±»ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">custom_styles</span> = <span class="hljs-string">""" b =&gt; b.red
                    u =&gt; em.red
                    p[style-name='Heading 1'] =&gt; h1.red.underline"""</span>
</code></pre>
<p>å¹¶å°† CSS å’Œ HTML åˆå¹¶åœ¨ä¸€èµ·ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">edited_html</span> = custom_css + html
</code></pre>
<p>è¿™ä¸ªæ—¶å€™å¦‚æœ DOCX æ–‡ä»¶åŒ…å«ä»»ä½•è¿™äº›å…ƒç´ ï¼Œå°±èƒ½çœ‹åˆ°æˆ‘ä»¬è®¾ç½®çš„æ ·å¼ç»“æœã€‚</p>
<p>é€šè¿‡ä»¥ä¸Šæ–¹æ³•æˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•æ˜ å°„æ ·å¼ï¼Œé‚£å°±è®©æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªæ›´è‘—åçš„ CSS æ¡†æ¶ï¼ˆä»¥åŠç›¸å…³çš„ JSï¼‰æ¥è®©æˆ‘ä»¬çš„ HTML çœ‹èµ·æ¥æ›´å¥½ï¼Œå¹¶ç»ƒä¹ ä¸€ä¸ªæ›´æœ‰å¯èƒ½çš„ç°å®åœºæ™¯ã€‚</p>
<h2 data-id="heading-3">ä½¿ç”¨ Bootstrapï¼ˆæˆ–å…¶ä»–ä»»ä½•å‰ç«¯æ¡†æ¶ï¼‰æ˜ å°„æ ·å¼</h2>
<p>å°±åƒæˆ‘ä»¬ä¹‹å‰å¤„ç†<code>custom_css</code>ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ CSS ä¸ HTML ä¸€èµ·åŠ è½½ã€‚æˆ‘ä»¬éœ€è¦å°† Bootstrap æ–‡ä»¶ URI æˆ– CDN æ·»åŠ åˆ°æˆ‘ä»¬çš„ HTML ä¸­ï¼š</p>
<pre><code class="hljs language-xml" lang="xml">bootstrap_css = '<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"nofollow"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"https://mybj123.com/links?url=aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9ib290c3RyYXBANS4wLjAtYmV0YTIvZGlzdC9jc3MvYm9vdHN0cmFwLm1pbi5jc3M="</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">"sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl"</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>&gt;</span>'
bootstrap_js = '<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"</span> <span class="hljs-attr">integrity</span>=<span class="hljs-string">"sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"</span> <span class="hljs-attr">crossorigin</span>=<span class="hljs-string">"anonymous"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>'
</code></pre>
<p>è¿™é‡Œæˆ‘ç¨å¾®è°ƒæ•´æˆ‘ä»¬çš„ custom_stylesï¼Œä»¥åŒ¹é…æˆ‘ä»¬çš„æ–° CSS ç±»ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">custom_styles</span> = <span class="hljs-string">""" b =&gt; b.mark
                    u =&gt; u.initialism
                    p[style-name='Heading 1'] =&gt; h1.card
                    table =&gt; table.table.table-hover
                    """</span>
</code></pre>
<p>åœ¨ç¬¬ä¸€è¡Œï¼Œæˆ‘ä»¬å°†ç²—ä½“ DOCX æ ·å¼æ˜ å°„åˆ°å…·æœ‰ç±»çš„ HTML å…ƒç´ ï¼Œè¯¥ç±»æ˜¯ HTML æ ‡ç­¾çš„ Bootstrap ç±»ï¼Œç”¨äºçªå‡ºæ˜¾ç¤ºæ–‡æœ¬çš„ä¸€éƒ¨åˆ†ã€‚<code>b mark &lt;mark&gt;</code></p>
<p>åœ¨ç¬¬äºŒè¡Œï¼Œæˆ‘ä»¬ä¸º HTML å…ƒç´ æ·»åŠ äº†ç±»ï¼Œç¨å¾®å‡å°äº†å­—ä½“å¤§å°ï¼Œå¹¶å°†æ–‡æœ¬è½¬æ¢ä¸ºå¤§å†™ã€‚<code>initialism u</code></p>
<p>åœ¨ç¬¬ä¸‰è¡Œï¼Œæˆ‘ä»¬é€‰æ‹©æ‰€æœ‰å…·æœ‰æ ·å¼åç§°çš„æ®µè½ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºå…·æœ‰ Bootstrap ç±»çš„ HTML å…ƒç´ ï¼Œè¯¥ç±»ä¸ºå…ƒç´ è®¾ç½®å¤šä¸ªæ ·å¼å±æ€§ï¼Œä¾‹å¦‚èƒŒæ™¯é¢œè‰²ã€ä½ç½®å’Œè¾¹æ¡†ã€‚<code>Heading 1 h1 card</code></p>
<p>åœ¨æœ€åä¸€è¡Œï¼Œæˆ‘ä»¬å°† docx æ–‡ä»¶ä¸­çš„æ‰€æœ‰è¡¨æ ¼è½¬æ¢ä¸º HTML å…ƒç´ ï¼Œå¹¶ä½¿ç”¨ Bootstrap çš„ç±»æ¥ç»™å®ƒä¸€ä¸ªæ–°çš„å¤–è§‚ï¼ŒåŒæ—¶æˆ‘ä»¬é€šè¿‡æ·»åŠ  Bootstrap ç±»ä½¿å…¶åœ¨æ‚¬åœæ—¶é«˜äº®æ˜¾ç¤ºã€‚<code>table table table-hover</code></p>
<p>å’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬ä½¿ç”¨ç‚¹ç¬¦å·å°†å¤šä¸ªç±»æ˜ å°„åˆ°åŒä¸€ä¸ª HTML å…ƒç´ ï¼Œå³ä½¿è¿™äº›æ ·å¼æ¥è‡ªå¦ä¸€ä¸ªæ¥æºã€‚</p>
<p>æœ€åï¼Œå°† Bootstrap CDNs æ·»åŠ åˆ°æˆ‘ä»¬çš„ HTML ä¸­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">edited_html</span> = bootstrap_css + html + bootstrap_js
</code></pre>
<p>ç°åœ¨å¯ä»¥åˆ†äº«æˆ‘ä»¬çš„ HTMLï¼Œä»¥ä¸‹æ˜¯å®Œæ•´çš„ä»£ç ä»¥ä¾›å‚è€ƒï¼š</p>
<pre><code class="hljs language-ini" lang="ini">import mammoth

<span class="hljs-attr">input_filename</span> = <span class="hljs-string">"file-sample_100kB.docx"</span>

<span class="hljs-attr">custom_styles</span> = <span class="hljs-string">""" b =&gt; b.mark
                    u =&gt; u.initialism
                    p[style-name='Heading 1'] =&gt; h1.card
                    table =&gt; table.table.table-hover
                    """</span>


<span class="hljs-attr">bootstrap_css</span> = <span class="hljs-string">'&lt;link rel="nofollow" href="https://mybj123.com/links?url=aHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9ib290c3RyYXBANS4wLjAtYmV0YTIvZGlzdC9jc3MvYm9vdHN0cmFwLm1pbi5jc3M=" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous"&gt;'</span>
<span class="hljs-attr">bootstrap_js</span> = <span class="hljs-string">'&lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"&gt;&lt;/script&gt;'</span>


with open(input_filename, "rb") as docx_file:
    <span class="hljs-attr">result</span> = mammoth.convert_to_html(docx_file, style_map = custom_styles)
    <span class="hljs-attr">html</span> = result.value 

<span class="hljs-attr">edited_html</span> = bootstrap_css + html + bootstrap_js

<span class="hljs-attr">output_filename</span> = <span class="hljs-string">"output.html"</span>
with open(output_filename, "w") as f: 
    f.writelines(edited_html)
</code></pre>
<p>æ­¤å¤–ï¼Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨å®é™…æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¸ä¼šåƒæˆ‘ä»¬åœ¨è¿™é‡Œæ‰€åšçš„é‚£æ ·ç›´æ¥å°† Bootstrap CSS æ·»åŠ åˆ° HTML å†…å®¹ä¸­ã€‚ç›¸åï¼Œä½ ä¼šå°† HTML å†…å®¹åŠ è½½æˆ–æ³¨å…¥åˆ°ä¸€ä¸ªç‰¹æ®Šçš„ HTML é¡µé¢ä¸­ï¼Œè¯¥é¡µé¢å·²ç»åŒ…å«äº†å¿…è¦çš„ CSS å’Œ JS æ†ç»‘åŒ…ã€‚</p>
<p>Mammoth è¿˜å…è®¸æˆ‘ä»¬ä¿®æ”¹æˆ‘ä»¬æ­£åœ¨è½¬æ¢çš„å†…å®¹ã€‚</p>
<h2 data-id="heading-4">å¤„ç†æˆ‘ä»¬ä¸æƒ³åˆ†äº«çš„å›¾ç‰‡</h2>
<p>å‡è®¾æˆ‘ä»¬å¸Œæœ›è·³è¿‡ DOCX æ–‡ä»¶ä¸­çš„å›¾åƒä¸è¿›è¡Œè½¬æ¢ã€‚<code>convert_to_html()</code>æ–¹æ³•æ¥å—ä¸€ä¸ª<code>convert_image</code>å‚æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªå›¾åƒå¤„ç†å‡½æ•°ã€‚å®ƒè¿”å›ä¸€ä¸ªåº”è¯¥è½¬æ¢å¹¶æ·»åŠ åˆ° HTML æ–‡æ¡£ä¸­çš„å›¾åƒåˆ—è¡¨ã€‚</p>
<p>å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬è¦†ç›–å®ƒå¹¶è¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œå®ƒä»¬å°†ä»è½¬æ¢åçš„é¡µé¢ä¸­çœç•¥ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">ignore_image</span>(<span class="hljs-params">image</span>):
    <span class="hljs-keyword">return</span> []
</code></pre>
<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†è¯¥å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’åˆ°<code>convert_to_html()</code>æ–¹æ³•ä¸­ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_filename, <span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> docx_file:
    result = mammoth.convert_to_html(docx_file, style_map = custom_styles, convert_image=ignore_image)
    html = result.value
    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'output.html'</span>, <span class="hljs-string">'w'</span>) <span class="hljs-keyword">as</span> html_file:
        html_file.write(text)
</code></pre>
<p>å°±æ˜¯è¿™æ ·ï¼ Mammoth åœ¨ç”Ÿæˆ HTML æ–‡ä»¶æ—¶å°†å¿½ç•¥æ‰€æœ‰å›¾åƒã€‚</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ç”¨ Python ç¼–ç¨‹æ–¹å¼ä½¿ç”¨ Mammothã€‚Mammoth ä¹Ÿæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå› æ­¤æˆ‘ä»¬æœ‰äº†å¦ä¸€ä¸ªå°† DOCX è½¬æ¢ä¸º HTML çš„æ¥å£ã€‚è®©æˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚ä¸­çœ‹çœ‹å®ƒçš„å·¥ä½œæƒ…å†µã€‚</p>
<h2 data-id="heading-5">ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·å°† DOCX è½¬æ¢ä¸º HTML</h2>
<p>ä½¿ç”¨ Mammoth çš„ CLI è¿›è¡Œæ–‡ä»¶è½¬æ¢é€šå¸¸å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-lua" lang="lua">mammoth <span class="hljs-built_in">path</span>/to/input_filename.docx <span class="hljs-built_in">path</span>/to/<span class="hljs-built_in">output</span>.html
</code></pre>
<p>å¦‚æœä½ æƒ³å°†å›¾åƒä» HTML ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªè¾“å‡ºæ–‡ä»¶å¤¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">mammoth file-sample_100kB.docx <span class="hljs-attr">--output-dir</span>=imgs
</code></pre>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åƒåœ¨ Python ä¸­é‚£æ ·æ·»åŠ è‡ªå®šä¹‰æ ·å¼ã€‚é¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æ ·å¼æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">touch</span> my-custom-styles
</code></pre>
<p>ç„¶åï¼Œæˆ‘ä»¬å°†åœ¨å…¶ä¸­æ·»åŠ è‡ªå®šä¹‰æ ·å¼ï¼Œè¯­æ³•ä¸ä¹‹å‰ç›¸åŒï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-tag">b</span> =&gt; <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.red</span>
u =&gt; <span class="hljs-selector-tag">em</span><span class="hljs-selector-class">.red</span>
<span class="hljs-selector-tag">p</span><span class="hljs-selector-attr">[style-name=<span class="hljs-string">'Heading 1'</span>]</span> =&gt; <span class="hljs-selector-tag">h1</span><span class="hljs-selector-class">.red</span><span class="hljs-selector-class">.underline</span>
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”Ÿæˆå¸¦æœ‰è‡ªå®šä¹‰æ ·å¼çš„ HTML æ–‡ä»¶ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">mammoth file-sample_100kB.docx output.html <span class="hljs-attr">--style-map</span>=my-custom-styles
</code></pre>
<p>å¤§åŠŸå‘Šæˆï¼æ‚¨çš„æ–‡æ¡£å·²æŒ‰å®šä¹‰çš„è‡ªå®šä¹‰æ ·å¼è¿›è¡Œè½¬æ¢ã€‚<a href="https://link.juejin.cn?target=https%3A%2F%2Fmybj123.com%2F28792.html" target="_blank" title="https://mybj123.com/28792.html" ref="nofollow noopener noreferrer">mybj123.com/28792.html</a></p>
<h2 data-id="heading-6">ç»“è¯­</h2>
<p>æ–‡ä»¶ç±»å‹è½¬æ¢åœ¨å¤„ç†ç½‘é¡µæŠ€æœ¯æ—¶æ˜¯ä¸€ç§å¸¸è§éœ€æ±‚ã€‚å°† DOCX æ–‡ä»¶è½¬æ¢ä¸ºæ˜“äºæ“ä½œçš„ HTML æ ¼å¼ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ ¹æ®éœ€è¦é‡å»ºæ•°æ®ã€‚ä½¿ç”¨ Mammothï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•ä» docx ä¸­æå–æ–‡æœ¬å¹¶å°†å…¶è½¬æ¢ä¸º HTMLã€‚</p>
<p>åœ¨è½¬æ¢ä¸º HTML æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„ CSS è§„åˆ™æˆ–å¸¸è§çš„ UI æ¡†æ¶æä¾›çš„è§„åˆ™æ¥æ ·å¼åŒ–è¾“å‡ºã€‚æˆ‘ä»¬è¿˜å¯ä»¥çœç•¥ä¸éœ€è¦åœ¨ HTML ä¸­å¯ç”¨çš„æ•°æ®ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Android æ··æ·†ä»å…¥é—¨åˆ°ç²¾é€šï¼šR8 æœºåˆ¶ã€å®æˆ˜é…ç½®ä¸é¿å‘æŒ‡å—]]></title>    <link>https://juejin.cn/post/7596991930984988723</link>    <guid>https://juejin.cn/post/7596991930984988723</guid>    <pubDate>2026-01-20T06:55:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596991930984988723" data-draft-id="7596955804261515314" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Android æ··æ·†ä»å…¥é—¨åˆ°ç²¾é€šï¼šR8 æœºåˆ¶ã€å®æˆ˜é…ç½®ä¸é¿å‘æŒ‡å—"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-20T06:55:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wayne214"/> <meta itemprop="url" content="https://juejin.cn/user/2664871914640429"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Android æ··æ·†ä»å…¥é—¨åˆ°ç²¾é€šï¼šR8 æœºåˆ¶ã€å®æˆ˜é…ç½®ä¸é¿å‘æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2664871914640429/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wayne214
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T06:55:29.000Z" title="Tue Jan 20 2026 06:55:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ Android å¼€å‘ä¸­ï¼Œ<strong>æ··æ·†ï¼ˆObfuscationï¼‰</strong> æ˜¯åº”ç”¨å‘å¸ƒå‰å¿…ä¸å¯å°‘çš„ç¯èŠ‚ã€‚å®ƒä¸ä»…èƒ½ç¼©å° APK ä½“ç§¯ï¼Œè¿˜èƒ½å¢åŠ åç¼–è¯‘çš„éš¾åº¦ï¼Œä¿æŠ¤æ ¸å¿ƒä»£ç é€»è¾‘ã€‚</p>
<p>æœ¬æ–‡å°†ä»åŸºç¡€æ¦‚å¿µã€é…ç½®æ–¹æ³•ã€å¸¸ç”¨æŒ‡ä»¤åˆ°â€œé¿å‘æŒ‡å—â€è¿›è¡Œå…¨é¢æ•´ç†ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€ ä»€ä¹ˆæ˜¯æ··æ·†ï¼Ÿ</h2>
<p>åœ¨ Android ProGuard/R8 ä½“ç³»ä¸­ï¼Œé€šå¸¸åŒ…å«å››ä¸ªåŠŸèƒ½ï¼š</p>
<ol>
<li><strong>å‹ç¼©ï¼ˆShrinkingï¼‰</strong>ï¼šæ£€æµ‹å¹¶åˆ é™¤æœªä½¿ç”¨çš„ç±»ã€å­—æ®µã€æ–¹æ³•å’Œå±æ€§ã€‚</li>
<li><strong>ä¼˜åŒ–ï¼ˆOptimizationï¼‰</strong>ï¼šåˆ†æå¹¶ä¼˜åŒ–å­—èŠ‚ç ï¼Œç”šè‡³å†…è”æ–¹æ³•ã€‚</li>
<li><strong>æ··æ·†ï¼ˆObfuscationï¼‰</strong>ï¼šå°†ç±»åã€æ–¹æ³•åã€å­—æ®µåé‡å‘½åä¸ºæ— æ„ä¹‰çš„çŸ­å­—ç¬¦ï¼ˆå¦‚ <code>a</code>, <code>b</code>, <code>c</code>ï¼‰ã€‚</li>
<li><strong>é¢„æ£€ï¼ˆPreverificationï¼‰</strong>ï¼šåœ¨ Java å¹³å°ä¸Šå¯¹ç±»è¿›è¡Œé¢„éªŒè¯ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-1">äºŒã€ å¼€å¯æ··æ·†</h2>
<p>åœ¨é¡¹ç›®çš„ <code>build.gradle</code> æ–‡ä»¶ä¸­ï¼Œé€šè¿‡ <code>minifyEnabled</code> å±æ€§å¼€å¯ï¼š</p>
<pre><code class="hljs language-gradle" lang="gradle">android {
    buildTypes {
        release {
            // å¼€å¯æ··æ·†/å‹ç¼©
            minifyEnabled true
            // å¼€å¯èµ„æºå‹ç¼©ï¼ˆåˆ é™¤æ— ç”¨å›¾ç‰‡ã€å¸ƒå±€ç­‰ï¼‰ï¼Œéœ€é…åˆæ··æ·†ä½¿ç”¨
            shrinkResources true
            // æŒ‡å®šæ··æ·†è§„åˆ™æ–‡ä»¶
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
}

</code></pre>
<hr/>
<h2 data-id="heading-2">ä¸‰ã€ æ ¸å¿ƒé…ç½®è¯­æ³•</h2>
<p>æ··æ·†çš„æ ¸å¿ƒåŸåˆ™æ˜¯ï¼š<strong>å¦‚æœä¸æŒ‡å®šâ€œä¿æŒï¼ˆKeepï¼‰â€ï¼ŒR8 å°±ä¼šé»˜è®¤æ··æ·†æˆ–åˆ é™¤æ‰€æœ‰ä»£ç ã€‚</strong></p>
<h3 data-id="heading-3">1. å¸¸ç”¨çš„ Keep æŒ‡ä»¤</h3>

























<table><thead><tr><th>æŒ‡ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>-keep</code></td><td>ä¿æŒç±»å’Œç±»æˆå‘˜ä¸è¢«æ··æ·†æˆ–ç§»é™¤</td></tr><tr><td><code>-keepclassmembers</code></td><td>ä¿æŒæˆå‘˜ä¸è¢«æ··æ·†ï¼Œä½†ç±»åå¯ä»¥è¢«æ··æ·†</td></tr><tr><td><code>-keepclasseswithmembers</code></td><td>å¦‚æœç±»åŒ…å«æŒ‡å®šæˆå‘˜ï¼Œåˆ™ä¿æŒç±»å’Œæˆå‘˜éƒ½ä¸è¢«æ··æ·†</td></tr><tr><td><code>-dontwarn</code></td><td>å¿½ç•¥æŒ‡å®šåº“çš„è­¦å‘Šï¼ˆè§£å†³ç¼–è¯‘æ—¶å› å¼•ç”¨ç¼ºå¤±æŠ¥é”™çš„é—®é¢˜ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-4">2. é€šé…ç¬¦</h3>
<ul>
<li><code>*</code>ï¼šåŒ¹é…ä»»æ„å­—ç¬¦ï¼Œä½†ä¸åŒ…æ‹¬åŒ…åˆ†éš”ç¬¦ã€‚</li>
<li><code>**</code>ï¼šåŒ¹é…ä»»æ„å­—ç¬¦ï¼ŒåŒ…æ‹¬åŒ…åˆ†éš”ç¬¦ï¼ˆåŒ¹é…åŒ…åŠå…¶å­åŒ…ï¼‰ã€‚</li>
<li><code>&lt;methods&gt;</code>ï¼šåŒ¹é…æ‰€æœ‰æ–¹æ³•ã€‚</li>
<li><code>&lt;fields&gt;</code>ï¼šåŒ¹é…æ‰€æœ‰å­—æ®µã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-5">å››ã€ å“ªäº›å†…å®¹ç»å¯¹ä¸èƒ½æ··æ·†ï¼Ÿï¼ˆé‡ç‚¹ï¼‰</h2>
<p>è¿™æ˜¯å¼€å‘ä¸­æœ€å®¹æ˜“å‡ºé—®é¢˜çš„åœ°æ–¹ã€‚ä»¥ä¸‹å†…å®¹é€šå¸¸éœ€è¦é…ç½® <code>-keep</code>ï¼š</p>
<ol>
<li><strong>åå°„ï¼ˆReflectionï¼‰ä½¿ç”¨çš„ä»£ç </strong>ï¼šåå°„é€šè¿‡å­—ç¬¦ä¸²å¯»æ‰¾ç±»/æ–¹æ³•ï¼Œæ··æ·†ååç§°å˜äº†ï¼Œåå°„ä¼šç›´æ¥æŠ¥é”™ã€‚</li>
<li><strong>ä¸ JS äº¤äº’çš„æ¥å£</strong>ï¼š<code>@JavascriptInterface</code> ä¿®é¥°çš„æ–¹æ³•ã€‚</li>
<li><strong>JNI è°ƒç”¨ï¼ˆNative æ–¹æ³•ï¼‰</strong>ï¼šC/C++ ä»£ç é€šè¿‡åŒ…åã€ç±»åã€æ–¹æ³•åå¯»æ‰¾ Java å‡½æ•°ã€‚</li>
<li><strong>åºåˆ—åŒ–å¯¹è±¡</strong>ï¼šå®ç° <code>Serializable</code> çš„ç±»ï¼ˆå»ºè®®ä¿æŒç‰¹å®šçš„ <code>serialVersionUID</code>ï¼‰ã€‚</li>
<li><strong>å¸ƒå±€æ–‡ä»¶å¼•ç”¨çš„è‡ªå®šä¹‰ View</strong>ï¼šXML é€šè¿‡ç±»åå®ä¾‹åŒ– Viewã€‚</li>
<li><strong>å››å¤§ç»„ä»¶</strong>ï¼šåœ¨ <code>AndroidManifest.xml</code> ä¸­æ³¨å†Œçš„ç±»ï¼ˆç³»ç»Ÿé»˜è®¤å·²å¤„ç†ï¼Œé€šå¸¸æ— éœ€æ‰‹åŠ¨é…ç½®ï¼‰ã€‚</li>
<li><strong>JSON æ˜ å°„ç±»ï¼ˆBeanï¼‰</strong>ï¼šå¦‚æœä½¿ç”¨ Gson/FastJson è½¬æ¢ï¼Œå­—æ®µåå¿…é¡»ä¸ JSON é”®ä¸€è‡´ã€‚</li>
</ol>
<hr/>
<h2 data-id="heading-6">äº”ã€ å¼€å‘ä¸­çš„â€œå‘â€ä¸é¿å‘æŒ‡å—</h2>
<h3 data-id="heading-7">1. æ··æ·†åçš„å´©æºƒæ—¥å¿—éš¾ä»¥å®šä½</h3>
<p><strong>ç°è±¡</strong>ï¼šCrash å †æ ˆå…¨æ˜¯ <code>a.b.c(SourceFile:1)</code>ã€‚
<strong>å¯¹ç­–</strong>ï¼š</p>
<ul>
<li>ä¿ç•™è¡Œå·ä¿¡æ¯ï¼šåœ¨è§„åˆ™ä¸­åŠ å…¥ <code>-keepattributes SourceFile,LineNumberTable</code>ã€‚</li>
<li><strong>ä½¿ç”¨ mapping.txt</strong>ï¼šæ¯æ¬¡æ‰“åŒ… release åï¼Œ<code>build/outputs/mapping/release/</code> ä¸‹ä¼šç”Ÿæˆ <code>mapping.txt</code>ã€‚ä½¿ç”¨ Android Studio çš„ "Analyze APK" å·¥å…·æˆ– Google æä¾›çš„ <code>retrace</code> è„šæœ¬è¿˜åŸå †æ ˆã€‚</li>
</ul>
<h3 data-id="heading-8">2. Gson è§£æç»“æœå…¨ä¸º null</h3>
<p><strong>ç°è±¡</strong>ï¼šDebug æ¨¡å¼æ­£å¸¸ï¼ŒRelease æ¨¡å¼ä¸‹è§£æåçš„å¯¹è±¡å­—æ®µå…¨ä¸º nullã€‚
<strong>åŸå› </strong>ï¼šBean ç±»çš„å­—æ®µåè¢«æ··æ·†ï¼Œå¯¼è‡´ä¸ JSON é”®ååŒ¹é…å¤±è´¥ã€‚
<strong>é¿å‘</strong>ï¼š</p>
<ul>
<li>ç»™ Bean ç±»å­—æ®µæ·»åŠ  <code>@SerializedName("key")</code> æ³¨è§£ã€‚</li>
<li>æˆ–è€…å°† Bean ç±»æ•´ä½“ <code>keep</code> æ‰ã€‚</li>
</ul>
<h3 data-id="heading-9">3. æšä¸¾ç±»å‹æŠ¥é”™</h3>
<p><strong>ç°è±¡</strong>ï¼šæ··æ·†åï¼Œ<code>Enum.valueOf()</code> æŠ›å‡ºå¼‚å¸¸ã€‚
<strong>å¯¹ç­–</strong>ï¼š</p>
<pre><code class="hljs language-proguard" lang="proguard">-keepclassmembers enum * {
    public static **[] values();
    public static ** valueOf(java.lang.String);
}

</code></pre>
<h3 data-id="heading-10">4. ä¾èµ–åº“é‡å¤å®šä¹‰</h3>
<p><strong>ç°è±¡</strong>ï¼šå¤šä¸ª jar åŒ…åŒ…å«ç›¸åŒçš„ç±»ï¼Œæ··æ·†æ—¶æŠ¥é”™ã€‚
<strong>å¯¹ç­–</strong>ï¼šä½¿ç”¨ <code>-dontnote</code> æˆ– <code>-dontwarn</code> å‹åˆ¶ç‰¹å®šåŒ…çš„è­¦å‘Šï¼Œæˆ–è€…åœ¨ <code>configurations</code> ä¸­æ’é™¤é‡å¤ä¾èµ–ã€‚</p>
<h3 data-id="heading-11">5. èµ„æºå‹ç¼©åˆ é™¤äº†åŠ¨æ€è·å–çš„èµ„æº</h3>
<p><strong>ç°è±¡</strong>ï¼šä½¿ç”¨ <code>getIdentifier()</code> åŠ¨æ€è·å–èµ„æº ID æ—¶ï¼ˆå¦‚ <code>getResources().getIdentifier("icon_" + index, "drawable", getPackageName())</code>ï¼‰ï¼Œèµ„æºè¢« <code>shrinkResources</code> åˆ é™¤äº†ã€‚
<strong>å¯¹ç­–</strong>ï¼šåœ¨ <code>res/raw</code> æ–‡ä»¶å¤¹ä¸‹åˆ›å»º <code>keep.xml</code>ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">"1.0"</span> encoding=<span class="hljs-string">"utf-8"</span>?&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">resources</span> <span class="hljs-attr">xmlns:tools</span>=<span class="hljs-string">"http://schemas.android.com/tools"</span>
    <span class="hljs-attr">tools:keep</span>=<span class="hljs-string">"@drawable/icon_*, @layout/unused_but_needed"</span> /&gt;</span>

</code></pre>
<h3 data-id="heading-12">6. æ¡¥æ¥çš„æŸäº›jså‡½æ•°åœ¨releaseæ¨¡å¼ä¸‹æŠ¥é”™</h3>
<p><strong>ç°è±¡</strong>ï¼šå¦‚ä¸‹ä»£ç åœ¨ debug æ¨¡å¼ä¸‹æ­£å¸¸ï¼Œ æ‰“åŒ… release åŒ…æ— æ³•æ‰§è¡Œï¼ŒæŠ¥é”™å¦‚ä¸‹</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title class_">TypeError</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">JavaScriptInterface</span>.<span class="hljs-property">close</span> is not a <span class="hljs-keyword">function</span>
</code></pre>
<p><strong>å¯¹ç­–</strong>ï¼šåœ¨æ··æ·†æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¦‚ä¸‹è§„åˆ™</p>
<pre><code class="hljs language-diff" lang="diff"># ä¿æŒå¸¦æœ‰ JavascriptInterface æ³¨è§£çš„æ–¹æ³•ä¸è¢«æ··æ·†
<span class="hljs-deletion">-keepattributes JavascriptInterface</span>
<span class="hljs-deletion">-keepattributes *Annotation*</span>

<span class="hljs-deletion">-keepclassmembers class * {</span>
    @android.webkit.JavascriptInterface &lt;methods&gt;;
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ï¼Ÿ</strong>ï¼š</p>
<p>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œä»£ç ä¸è¿›è¡Œæ··æ·†ï¼Œæ–¹æ³•åä¿æŒä¸º closeã€‚ åœ¨ Release æ¨¡å¼ä¸‹ï¼Œä¸ºäº†å‡å°åŒ…ä½“ç§¯å’Œå®‰å…¨æ€§ï¼Œæ··æ·†å™¨ä¼šå°† close(String s) é‡å‘½åä¸ºç±»ä¼¼ a(String b)ã€‚ç”±äº JavaScript ç«¯ä»ç„¶åœ¨å°è¯•è°ƒç”¨ window.android.close()ï¼Œè‡ªç„¶ä¼šæç¤ºæ‰¾ä¸åˆ°æ–¹æ³•ã€‚</p>
<hr/>
<h2 data-id="heading-13">å…­ã€ æœ€ä½³å®è·µå»ºè®®</h2>
<ul>
<li><strong>æ¨¡å—åŒ–æ··æ·†</strong>ï¼šå¦‚æœæ˜¯å¼€å‘ Libraryï¼ˆSDKï¼‰ï¼Œè¯·ä½¿ç”¨ <code>consumerProguardFiles</code>ã€‚è¿™æ ·é›†æˆä½  SDK çš„ App ä¼šè‡ªåŠ¨åº”ç”¨è¿™äº›æ··æ·†è§„åˆ™ï¼Œæ— éœ€å¼€å‘è€…æ‰‹åŠ¨å¤åˆ¶ã€‚</li>
<li><strong>å°½æ—©æµ‹è¯•</strong>ï¼šä¸è¦ç­‰å‘å¸ƒæ­£å¼ç‰ˆå‰æ‰å¼€å¯æ··æ·†ã€‚å»ºè®®åœ¨ <code>debug</code> æ¨¡å¼ä¸‹ä¹Ÿå¶å°”å¼€å¯æ··æ·†è¿›è¡Œå›å½’æµ‹è¯•ã€‚</li>
<li><strong>å–„ç”¨ä¸‰æ–¹åº“è§„åˆ™</strong>ï¼šç°åœ¨çš„æµè¡Œåº“ï¼ˆå¦‚ Retrofit, OkHttp, Glideï¼‰é€šå¸¸åœ¨å®˜ç½‘æˆ– README ä¸­æä¾›äº†æˆç†Ÿçš„æ··æ·†è§„åˆ™ï¼Œç›´æ¥å¤åˆ¶å³å¯ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/983ed8b6cda44537a043ca71bfca3e53~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgd2F5bmUyMTQ=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769496929&amp;x-signature=vuoPku2qiQGlNLiVemAPst4TSaM%3D" alt="" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å­¦ä¹ Three.js--å…‰æºLight+è½¨é“æ§åˆ¶å™¨OrbitControls]]></title>    <link>https://juejin.cn/post/7597230546239242276</link>    <guid>https://juejin.cn/post/7597230546239242276</guid>    <pubDate>2026-01-20T07:09:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597230546239242276" data-draft-id="7597230546239225892" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å­¦ä¹ Three.js--å…‰æºLight+è½¨é“æ§åˆ¶å™¨OrbitControls"/> <meta itemprop="keywords" content="å‰ç«¯,three.js"/> <meta itemprop="datePublished" content="2026-01-20T07:09:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é€ è½®å­çš„çŒª"/> <meta itemprop="url" content="https://juejin.cn/user/497453720940158"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å­¦ä¹ Three.js--å…‰æºLight+è½¨é“æ§åˆ¶å™¨OrbitControls
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/497453720940158/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é€ è½®å­çš„çŒª
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:09:42.000Z" title="Tue Jan 20 2026 07:09:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å­¦ä¹ Three.js--å…‰æºLight+è½¨é“æ§åˆ¶å™¨OrbitControls</h2>
<h3 data-id="heading-1">å‰ç½®æ ¸å¿ƒè¯´æ˜</h3>
<p>Three.js çš„ 3D ä¸–ç•Œé»˜è®¤å¤„äº<strong>å…¨é»‘çŠ¶æ€</strong>ï¼Œæƒ³è¦è®©ã€Œå—å…‰ç…§å½±å“çš„æè´¨ã€æ˜¾ç¤ºå‡ºçœŸå®çš„å…‰å½±æ•ˆæœï¼Œå¿…é¡»æ‰‹åŠ¨æ·»åŠ å…‰æºï¼›è€Œè½¨é“æ§åˆ¶å™¨ï¼ˆOrbitControlsï¼‰æ˜¯ Three.js å®˜æ–¹æä¾›çš„æ ¸å¿ƒäº¤äº’æ’ä»¶ï¼Œèƒ½è®©ä½ é€šè¿‡é¼ æ ‡/è§¦æ‘¸è‡ªç”±æ“æ§ç›¸æœºè§†è§’ï¼Œæ˜¯ 3D åœºæ™¯äº¤äº’çš„æ ‡é…ã€‚</p>
<h4 data-id="heading-2">æ ¸å¿ƒè§„åˆ™</h4>
<ol>
<li>
<p><strong>æè´¨ä¸å…‰ç…§çš„å¯¹åº”å…³ç³»</strong></p>



































<table><thead><tr><th>æè´¨ç±»å‹</th><th>æ˜¯å¦å—å…‰ç…§å½±å“</th><th>æ ¸å¿ƒç‰¹ç‚¹</th></tr></thead><tbody><tr><td>MeshBasicMaterial</td><td>ä¸å—</td><td>çº¯è‰²/çº¹ç†æ˜¾ç¤ºï¼Œæ— éœ€å…‰æºï¼Œä»…ç”¨äºè°ƒè¯•/ç®€å•UI</td></tr><tr><td>MeshLambertMaterial</td><td>å—</td><td>æ¼«åå°„å…‰ç…§ï¼Œæ— é«˜å…‰ï¼Œå“‘å…‰è´¨æ„Ÿ</td></tr><tr><td>MeshPhongMaterial</td><td>å—</td><td>é«˜å…‰å…‰ç…§ï¼Œæ¨¡æ‹Ÿå…‰æ³½è´¨æ„Ÿ</td></tr><tr><td>MeshStandardMaterial</td><td>å—</td><td>PBRç‰©ç†å…‰ç…§ï¼ŒçœŸå®è´¨æ„Ÿï¼ˆæ¨èé¦–é€‰ï¼‰</td></tr><tr><td>MeshPhysicalMaterial</td><td>å—</td><td>é«˜çº§PBRå…‰ç…§ï¼Œæè‡´å†™å®</td></tr></tbody></table>
</li>
<li>
<p><strong>å…‰æºé€šç”¨è§„åˆ™</strong>ï¼š</p>
<ul>
<li>æ‰€æœ‰å…‰æºå‡ç»§æ‰¿è‡ª <code>THREE.Light</code>ï¼Œå…±ç”¨ã€Œé¢œè‰²ã€å¼ºåº¦ã€æ ¸å¿ƒå±æ€§ï¼›</li>
<li>å…‰æºåˆ›å»ºåå¿…é¡»é€šè¿‡ <code>scene.add(å…‰æº)</code> æ·»åŠ åˆ°åœºæ™¯æ‰ä¼šç”Ÿæ•ˆï¼›</li>
<li>é™¤ç¯å¢ƒå…‰å¤–ï¼Œå…¶ä»–å…‰æºï¼ˆç‚¹/èšå…‰/å¹³è¡Œå…‰ï¼‰éœ€è®¾ç½® <code>position</code> æˆ– <code>target</code> ç¡®å®šå…‰ç…§æ–¹å‘/ä½ç½®ã€‚</li>
</ul>
</li>
</ol>
<hr/>
<h3 data-id="heading-3">ä¸€ã€Three.js æ ¸å¿ƒå…‰æºè¯¦è§£ï¼ˆå‚æ•°+ç”¨æ³•+æ•ˆæœï¼‰</h3>
<h4 data-id="heading-4">1. ç¯å¢ƒå…‰ | AmbientLightï¼ˆæ‰“åº•å…‰ï¼Œå¿…åŠ ï¼‰</h4>
<h5 data-id="heading-5">æ ¸å¿ƒæ¦‚å¿µ</h5>
<p><code>AmbientLight</code> æ˜¯<strong>å…¨å±€å‡åŒ€ç…§æ˜å…‰æº</strong>ï¼Œæ— æ–¹å‘ã€æ— é˜´å½±ã€æ— è¡°å‡ï¼Œä½œç”¨æ˜¯ã€Œç»™åœºæ™¯æ‰€æœ‰ç‰©ä½“æ‰“åŸºç¡€äº®åº¦ã€ï¼Œæ¶ˆé™¤çº¯é»‘åŒºåŸŸï¼Œä½†ä¸ä¼šäº§ç”Ÿæ˜æš—å¯¹æ¯”å’Œç«‹ä½“æ„Ÿï¼Œ<strong>å¿…é¡»é…åˆå…¶ä»–å…‰æºï¼ˆå¦‚å¹³è¡Œå…‰ï¼‰ä½¿ç”¨</strong>ã€‚</p>
<h5 data-id="heading-6">åˆ›å»ºè¯­æ³• &amp; å®Œæ•´å‚æ•°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¯­æ³•ï¼šnew THREE.AmbientLight(é¢œè‰², å…‰ç…§å¼ºåº¦)</span>
<span class="hljs-keyword">const</span> ambientLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">AmbientLight</span>(<span class="hljs-number">0xffffff</span>, <span class="hljs-number">0.5</span>);
scene.<span class="hljs-title function_">add</span>(ambientLight); <span class="hljs-comment">// å¿…é¡»æ·»åŠ åˆ°åœºæ™¯æ‰ç”Ÿæ•ˆ</span>
</code></pre>























<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æ ¸å¿ƒè¯´æ˜</th></tr></thead><tbody><tr><td><code>color</code></td><td>Number/String/THREE.Color</td><td><code>0xffffff</code></td><td>å…‰æºé¢œè‰²ï¼ˆæ”¯æŒ16è¿›åˆ¶/å­—ç¬¦ä¸²/Colorå¯¹è±¡ï¼‰</td></tr><tr><td><code>intensity</code></td><td>Number</td><td><code>1</code></td><td>å…‰ç…§å¼ºåº¦ï¼ˆ0=æ— å…‰ï¼Œ1=æ ‡å‡†å¼ºåº¦ï¼Œå»ºè®®0.2~0.8ï¼‰</td></tr></tbody></table>
<h5 data-id="heading-7">æ ¸å¿ƒç‰¹ç‚¹ &amp; æ•ˆæœ</h5>
<ul>
<li>æ— ä½ç½®å±æ€§ï¼ˆå…¨å±€ç”Ÿæ•ˆï¼‰ï¼Œæ— æ³•è®¾ç½® <code>position</code>ï¼›</li>
<li>æ•ˆæœï¼šæ‰€æœ‰ç‰©ä½“è¢«å‡åŒ€ç…§äº®ï¼Œæ— æ˜æš—å·®å¼‚ï¼Œå•ç‹¬ä½¿ç”¨ä¼šè®©ç‰©ä½“åƒâ€œå¹³é¢è´´çº¸â€ï¼Œæ— ç«‹ä½“æ„Ÿï¼›</li>
<li>é€‚ç”¨åœºæ™¯ï¼šä½œä¸ºã€Œæ‰“åº•å…‰ã€ï¼Œé…åˆä¸»å…‰æºï¼ˆå¹³è¡Œå…‰/èšå…‰ç¯ï¼‰ä½¿ç”¨ï¼Œé¿å…ç‰©ä½“é˜´å½±åŒºåŸŸçº¯é»‘ã€‚</li>
</ul>
<h4 data-id="heading-8">2. å¹³è¡Œå…‰ | DirectionalLightï¼ˆä¸»å…‰æºé¦–é€‰ï¼‰</h4>
<h5 data-id="heading-9">æ ¸å¿ƒæ¦‚å¿µ</h5>
<p><code>DirectionalLight</code> æ¨¡æ‹Ÿ<strong>å¤ªé˜³å…‰</strong>ï¼Œå…‰çº¿å¹³è¡Œå‘å°„ï¼Œæ— è¡°å‡ï¼ˆè·ç¦»ä¸å½±å“äº®åº¦ï¼‰ï¼Œæœ‰æ˜ç¡®çš„ç…§å°„æ–¹å‘ï¼Œèƒ½äº§ç”Ÿè‡ªç„¶çš„æ˜æš—å¯¹æ¯”å’Œé˜´å½±ï¼Œæ˜¯ 3D åœºæ™¯ã€Œä¸»å…‰æºã€çš„æœ€ä¼˜é€‰æ‹©ã€‚</p>
<h5 data-id="heading-10">åˆ›å»ºè¯­æ³• &amp; å®Œæ•´å‚æ•°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¯­æ³•ï¼šnew THREE.DirectionalLight(é¢œè‰², å…‰ç…§å¼ºåº¦)</span>
<span class="hljs-keyword">const</span> dirLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">DirectionalLight</span>(<span class="hljs-number">0xffffff</span>, <span class="hljs-number">1</span>);
<span class="hljs-comment">// æ ¸å¿ƒï¼šè®¾ç½®å…‰æºä½ç½®ï¼ˆå†³å®šå…‰ç…§æ–¹å‘ï¼‰ï¼Œé»˜è®¤åœ¨åŸç‚¹(0,0,0)</span>
dirLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// å…‰æºåœ¨(5,5,5)ï¼Œæœå‘åœºæ™¯åŸç‚¹ç…§å°„</span>
<span class="hljs-comment">// å¯é€‰ï¼šè®¾ç½®å…‰ç…§ç›®æ ‡ï¼ˆé»˜è®¤æœå‘åŸç‚¹ï¼Œå¯æŒ‡å®šç‰©ä½“ï¼‰</span>
dirLight.<span class="hljs-property">target</span> = cubeMesh; <span class="hljs-comment">// å…‰ç…§æœå‘ç«‹æ–¹ä½“</span>
<span class="hljs-comment">// å¯é€‰ï¼šå¼€å¯é˜´å½±æŠ•å°„ï¼ˆå®ç°ç‰©ä½“é˜´å½±æ•ˆæœï¼‰</span>
dirLight.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>;
scene.<span class="hljs-title function_">add</span>(dirLight);
</code></pre>























<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æ ¸å¿ƒè¯´æ˜</th></tr></thead><tbody><tr><td><code>color</code></td><td>Number/String/THREE.Color</td><td><code>0xffffff</code></td><td>å…‰æºé¢œè‰²</td></tr><tr><td><code>intensity</code></td><td>Number</td><td><code>1</code></td><td>å…‰ç…§å¼ºåº¦ï¼ˆå»ºè®®0.8~1.2ï¼‰</td></tr></tbody></table>
<h5 data-id="heading-11">æ ¸å¿ƒå±æ€§</h5>






























<table><thead><tr><th>å±æ€§å</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>position</code></td><td>å…‰æºä½ç½®ï¼ˆTHREE.Vector3ï¼‰ï¼Œå†³å®šå…‰ç…§æ–¹å‘</td><td><code>dirLight.position.set(5,5,5)</code></td></tr><tr><td><code>target</code></td><td>å…‰ç…§ç›®æ ‡ç‚¹/ç‰©ä½“ï¼ˆé»˜è®¤åŸç‚¹ï¼‰</td><td><code>dirLight.target = mesh</code></td></tr><tr><td><code>castShadow</code></td><td>æ˜¯å¦æŠ•å°„é˜´å½±ï¼ˆé»˜è®¤falseï¼‰</td><td><code>dirLight.castShadow = true</code></td></tr><tr><td><code>shadow</code></td><td>é˜´å½±é…ç½®å¯¹è±¡ï¼ˆå¦‚é˜´å½±åˆ†è¾¨ç‡ï¼‰</td><td><code>dirLight.shadow.mapSize.set(2048,2048)</code></td></tr></tbody></table>
<h5 data-id="heading-12">æ•ˆæœ &amp; é€‚ç”¨åœºæ™¯</h5>
<ul>
<li>æ•ˆæœï¼šå…‰çº¿å¹³è¡Œï¼Œç‰©ä½“æœå‘å…‰æºçš„é¢äº®ï¼ŒèƒŒå‘é¢æš—ï¼Œç«‹ä½“æ„Ÿæå¼ºï¼›</li>
<li>é€‚ç”¨ï¼šåœºæ™¯ä¸»å…‰æºï¼ˆæ¨¡æ‹Ÿå¤ªé˜³å…‰ï¼‰ã€æˆ·å¤–åœºæ™¯ã€å…¨å±€ç…§æ˜ã€‚</li>
</ul>
<h4 data-id="heading-13">3. ç‚¹å…‰æº | PointLightï¼ˆæ¨¡æ‹Ÿç¯æ³¡/ç«æŠŠï¼‰</h4>
<h5 data-id="heading-14">æ ¸å¿ƒæ¦‚å¿µ</h5>
<p><code>PointLight</code> æ¨¡æ‹Ÿ<strong>ç¯æ³¡ã€èœ¡çƒ›ã€ç«æŠŠ</strong>ï¼Œä»ä¸€ä¸ªç‚¹å‘ã€Œæ‰€æœ‰æ–¹å‘ã€å‘å°„å…‰çº¿ï¼Œæœ‰è¡°å‡ï¼ˆè·ç¦»è¶Šè¿œï¼Œå…‰çº¿è¶Šæš—ï¼‰ï¼Œèƒ½äº§ç”ŸçœŸå®çš„è·ç¦»æ˜æš—å˜åŒ–ã€‚</p>
<h5 data-id="heading-15">åˆ›å»ºè¯­æ³• &amp; å®Œæ•´å‚æ•°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¯­æ³•ï¼šnew THREE.PointLight(é¢œè‰², å¼ºåº¦, å…‰ç…§è·ç¦», è¡°å‡æŒ‡æ•°)</span>
<span class="hljs-keyword">const</span> pointLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PointLight</span>(<span class="hljs-number">0xffaa00</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>);
<span class="hljs-comment">// æ ¸å¿ƒï¼šè®¾ç½®å…‰æºä½ç½®ï¼ˆé»˜è®¤åŸç‚¹ï¼‰</span>
pointLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);
<span class="hljs-comment">// å¯é€‰ï¼šå¼€å¯é˜´å½±æŠ•å°„</span>
pointLight.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>;
scene.<span class="hljs-title function_">add</span>(pointLight);
</code></pre>



































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æ ¸å¿ƒè¯´æ˜</th></tr></thead><tbody><tr><td><code>color</code></td><td>Number/String/THREE.Color</td><td><code>0xffffff</code></td><td>å…‰æºé¢œè‰²</td></tr><tr><td><code>intensity</code></td><td>Number</td><td><code>1</code></td><td>å…‰ç…§å¼ºåº¦</td></tr><tr><td><code>distance</code></td><td>Number</td><td><code>0</code></td><td>å…‰ç…§æœ€å¤§è·ç¦»ï¼ˆ0=æ— é™è¿œï¼‰ï¼Œè¶…è¿‡è¯¥è·ç¦»æ— å…‰ç…§</td></tr><tr><td><code>decay</code></td><td>Number</td><td><code>1</code></td><td>è¡°å‡æŒ‡æ•°ï¼ˆç‰©ç†æ­£ç¡®å€¼ä¸º2ï¼Œå€¼è¶Šå¤§è¡°å‡è¶Šå¿«ï¼‰</td></tr></tbody></table>
<h5 data-id="heading-16">æ ¸å¿ƒæ•ˆæœ</h5>
<ul>
<li>æ•ˆæœï¼šå…‰æºä¸­å¿ƒæœ€äº®ï¼Œå‘å››å‘¨é€æ¸å˜æš—ï¼Œè·ç¦»è¶Šè¿œè¶Šæš—ï¼›</li>
<li>é€‚ç”¨ï¼šç¯æ³¡ã€ç«æŠŠã€å°ç¯ã€å±€éƒ¨ç‚¹ç…§æ˜åœºæ™¯ã€‚</li>
</ul>
<h4 data-id="heading-17">4. èšå…‰ç¯å…‰æº | SpotLightï¼ˆæ¨¡æ‹Ÿæ‰‹ç”µç­’/å°„ç¯ï¼‰</h4>
<h5 data-id="heading-18">æ ¸å¿ƒæ¦‚å¿µ</h5>
<p><code>SpotLight</code> æ¨¡æ‹Ÿ<strong>æ‰‹ç”µç­’ã€èˆå°å°„ç¯ã€æ±½è½¦å¤§ç¯</strong>ï¼Œä»ä¸€ä¸ªç‚¹å‘ã€ŒæŒ‡å®šæ–¹å‘ã€å‘å°„ã€Œé”¥å½¢å…‰çº¿ã€ï¼Œæœ‰è§’åº¦ã€æœ‰è¡°å‡ï¼Œè¾¹ç¼˜å¯æ¨¡ç³Šï¼Œé˜´å½±æ•ˆæœç²¾å‡†ã€‚</p>
<h5 data-id="heading-19">åˆ›å»ºè¯­æ³• &amp; å®Œæ•´å‚æ•°</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¯­æ³•ï¼šnew THREE.SpotLight(é¢œè‰², å¼ºåº¦, è·ç¦», é”¥å½¢è§’åº¦, è¾¹ç¼˜æ¨¡ç³Šåº¦, è¡°å‡æŒ‡æ•°)</span>
<span class="hljs-keyword">const</span> spotLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">SpotLight</span>(<span class="hljs-number">0xffffff</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span>/<span class="hljs-number">6</span>, <span class="hljs-number">0.2</span>, <span class="hljs-number">2</span>);
<span class="hljs-comment">// æ ¸å¿ƒï¼šè®¾ç½®å…‰æºä½ç½®+ç›®æ ‡ç‚¹</span>
spotLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// å…‰æºåœ¨é¡¶éƒ¨</span>
spotLight.<span class="hljs-property">target</span> = cubeMesh; <span class="hljs-comment">// ç…§å°„ç«‹æ–¹ä½“</span>
<span class="hljs-comment">// å¯é€‰ï¼šå¼€å¯é˜´å½±</span>
spotLight.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>;
scene.<span class="hljs-title function_">add</span>(spotLight);
</code></pre>















































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æ ¸å¿ƒè¯´æ˜</th></tr></thead><tbody><tr><td><code>color</code></td><td>Number/String/THREE.Color</td><td><code>0xffffff</code></td><td>å…‰æºé¢œè‰²</td></tr><tr><td><code>intensity</code></td><td>Number</td><td><code>1</code></td><td>å…‰ç…§å¼ºåº¦</td></tr><tr><td><code>distance</code></td><td>Number</td><td><code>0</code></td><td>å…‰ç…§æœ€å¤§è·ç¦»</td></tr><tr><td><code>angle</code></td><td>Numberï¼ˆå¼§åº¦ï¼‰</td><td><code>Math.PI/3</code></td><td>é”¥å½¢å…‰ç…§è§’åº¦ï¼ˆè¶Šå°ï¼Œå…‰æŸè¶Šé›†ä¸­ï¼‰</td></tr><tr><td><code>penumbra</code></td><td>Numberï¼ˆ0~1ï¼‰</td><td><code>0</code></td><td>å…‰çº¿è¾¹ç¼˜æ¨¡ç³Šåº¦ï¼ˆå€¼è¶Šå¤§ï¼Œè¾¹ç¼˜è¶ŠæŸ”ï¼‰</td></tr><tr><td><code>decay</code></td><td>Number</td><td><code>1</code></td><td>è¡°å‡æŒ‡æ•°</td></tr></tbody></table>
<h5 data-id="heading-20">æ ¸å¿ƒæ•ˆæœ &amp; é€‚ç”¨åœºæ™¯</h5>
<ul>
<li>æ•ˆæœï¼šé”¥å½¢å…‰ç…§åŒºåŸŸï¼Œä¸­å¿ƒäº®ã€è¾¹ç¼˜æ¸æš—ï¼Œå…‰æŸèŒƒå›´å¯æ§ï¼›</li>
<li>é€‚ç”¨ï¼šæ‰‹ç”µç­’ã€èˆå°å°„ç¯ã€æ±½è½¦å¤§ç¯ã€å±€éƒ¨ç²¾å‡†ç…§æ˜ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-21">äºŒã€è½¨é“æ§åˆ¶å™¨ OrbitControlsï¼ˆäº¤äº’æ ¸å¿ƒï¼‰</h3>
<h4 data-id="heading-22">2.1 æ ¸å¿ƒè¯´æ˜</h4>
<p>OrbitControls æ˜¯ Three.js å®˜æ–¹æä¾›çš„<strong>ç›¸æœºäº¤äº’æ’ä»¶</strong>ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™é¼ æ ‡/è§¦æ‘¸äº‹ä»¶ï¼Œå³å¯å®ç°ç›¸æœºè§†è§’çš„ã€Œæ—‹è½¬ã€ç¼©æ”¾ã€å¹³ç§»ã€ï¼Œæ˜¯ 3D åœºæ™¯äº¤äº’çš„æ ‡é…ï¼Œæ”¯æŒé¼ æ ‡å’Œç§»åŠ¨ç«¯è§¦æ‘¸ã€‚</p>
<h4 data-id="heading-23">2.2 äº¤äº’æ•ˆæœï¼ˆå›ºå®šè§„åˆ™ï¼Œæ— éœ€é…ç½®ï¼‰</h4>





























<table><thead><tr><th>æ“ä½œæ–¹å¼</th><th>äº¤äº’æ•ˆæœ</th></tr></thead><tbody><tr><td>é¼ æ ‡å·¦é”®æ‹–æ‹½</td><td>ç›¸æœºå›´ç»•ç›®æ ‡ç‚¹æ—‹è½¬ï¼ˆåœºæ™¯æ•´ä½“æ—‹è½¬ï¼‰</td></tr><tr><td>é¼ æ ‡æ»šè½®æ»šåŠ¨</td><td>ç›¸æœºé è¿‘/è¿œç¦»ç›®æ ‡ç‚¹ï¼ˆåœºæ™¯ç¼©æ”¾ï¼‰</td></tr><tr><td>é¼ æ ‡å³é”®æ‹–æ‹½</td><td>ç›¸æœºå¹³ç§»ï¼ˆåœºæ™¯æ•´ä½“å¹³ç§»ï¼‰</td></tr><tr><td>ç§»åŠ¨ç«¯å•æŒ‡æ‹–æ‹½</td><td>æ—‹è½¬è§†è§’</td></tr><tr><td>ç§»åŠ¨ç«¯åŒæŒ‡ç¼©æ”¾</td><td>åœºæ™¯ç¼©æ”¾</td></tr></tbody></table>
<h4 data-id="heading-24">2.3 å¼•å…¥æ–¹å¼ï¼ˆä¸¤ç§åœºæ™¯ï¼Œå…¨è¦†ç›–ï¼‰</h4>
<h5 data-id="heading-25">æ–¹å¼1ï¼šCDN å¼•å…¥ï¼ˆæ–°æ‰‹/å¿«é€Ÿæµ‹è¯•ï¼Œæ¨èï¼‰</h5>
<p>ç›´æ¥åœ¨ HTML ä¸­å¼•å…¥ï¼Œæ— éœ€å®‰è£…ä¾èµ–ï¼š</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- å…ˆå¼•å…¥Three.jsæ ¸å¿ƒåº“ï¼Œå†å¼•å…¥OrbitControls --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">THREE</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'https://threejsfundamentals.org/threejs/resources/threejs/r132/build/three.module.js'</span>
      <span class="hljs-keyword">import</span> { <span class="hljs-title class_">OrbitControls</span> }  <span class="hljs-keyword">from</span> <span class="hljs-string">"https://threejsfundamentals.org/threejs/resources/threejs/r132/examples/jsm/controls/OrbitControls.js"</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

</code></pre>
<h5 data-id="heading-26">æ–¹å¼2ï¼šNPM å¼•å…¥ï¼ˆå·¥ç¨‹åŒ–é¡¹ç›®ï¼ŒVue/React/Viteï¼‰</h5>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…Three.jsï¼ˆå·²åŒ…å«OrbitControlsï¼‰</span>
npm install three --save
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡å—åŒ–å¯¼å…¥</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">THREE</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'three'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">OrbitControls</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'three/addons/controls/OrbitControls.js'</span>;
</code></pre>
<h4 data-id="heading-27">2.4 å®Œæ•´ä½¿ç”¨è¯­æ³• &amp; æ ¸å¿ƒå‚æ•°</h4>
<h5 data-id="heading-28">åŸºç¡€ä½¿ç”¨ï¼ˆæœ€ç®€ç‰ˆï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¯­æ³•ï¼šnew OrbitControls(è¦æ§åˆ¶çš„ç›¸æœº, ç›‘å¬çš„DOMå…ƒç´ )</span>
<span class="hljs-keyword">const</span> controls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrbitControls</span>(camera, renderer.<span class="hljs-property">domElement</span>);
<span class="hljs-comment">// æ ¸å¿ƒï¼šå¼€å¯é˜»å°¼æ•ˆæœï¼ˆè§†è§’ç§»åŠ¨æ›´é¡ºæ»‘ï¼Œæœ‰æƒ¯æ€§ï¼Œä½“éªŒæ›´ä½³ï¼‰</span>
controls.<span class="hljs-property">enableDamping</span> = <span class="hljs-literal">true</span>;
<span class="hljs-comment">// é˜»å°¼ç³»æ•°ï¼ˆè¶Šå°ï¼Œæƒ¯æ€§è¶Šå¼ºï¼Œè¶Šé¡ºæ»‘ï¼‰</span>
controls.<span class="hljs-property">dampingFactor</span> = <span class="hljs-number">0.05</span>;

<span class="hljs-comment">// åŠ¨ç”»å¾ªç¯ï¼ˆå¿…é¡»ï¼enableDamping=trueæ—¶ï¼Œéœ€å®æ—¶æ›´æ–°æ§åˆ¶å™¨ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">requestAnimationFrame</span>(animate);
  controls.<span class="hljs-title function_">update</span>(); <span class="hljs-comment">// å…³é”®ï¼šæ›´æ–°æ§åˆ¶å™¨çŠ¶æ€</span>
  renderer.<span class="hljs-title function_">render</span>(scene, camera);
}
<span class="hljs-title function_">animate</span>();
</code></pre>
<h5 data-id="heading-29">æ ¸å¿ƒé…ç½®å‚æ•°ï¼ˆé«˜é¢‘ä½¿ç”¨ï¼‰</h5>



















































































<table><thead><tr><th>å‚æ•°å</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æ ¸å¿ƒè¯´æ˜</th></tr></thead><tbody><tr><td><code>enableDamping</code></td><td>Boolean</td><td><code>false</code></td><td>æ˜¯å¦å¼€å¯é˜»å°¼ï¼ˆé¡ºæ»‘æƒ¯æ€§ï¼‰ï¼Œæ¨èè®¾ä¸ºtrue</td></tr><tr><td><code>dampingFactor</code></td><td>Number</td><td><code>0.05</code></td><td>é˜»å°¼ç³»æ•°ï¼ˆ0.01~0.1ï¼Œè¶Šå°è¶Šé¡ºæ»‘ï¼‰</td></tr><tr><td><code>enableRotate</code></td><td>Boolean</td><td><code>true</code></td><td>æ˜¯å¦å…è®¸æ—‹è½¬è§†è§’</td></tr><tr><td><code>rotateSpeed</code></td><td>Number</td><td><code>1.0</code></td><td>æ—‹è½¬é€Ÿåº¦ï¼ˆå€¼è¶Šå¤§ï¼Œæ—‹è½¬è¶Šå¿«ï¼‰</td></tr><tr><td><code>enableZoom</code></td><td>Boolean</td><td><code>true</code></td><td>æ˜¯å¦å…è®¸ç¼©æ”¾è§†è§’</td></tr><tr><td><code>zoomSpeed</code></td><td>Number</td><td><code>1.0</code></td><td>ç¼©æ”¾é€Ÿåº¦</td></tr><tr><td><code>enablePan</code></td><td>Boolean</td><td><code>true</code></td><td>æ˜¯å¦å…è®¸å¹³ç§»è§†è§’</td></tr><tr><td><code>panSpeed</code></td><td>Number</td><td><code>1.0</code></td><td>å¹³ç§»é€Ÿåº¦</td></tr><tr><td><code>minDistance</code></td><td>Number</td><td><code>0</code></td><td>ç›¸æœºæœ€å°ç¼©æ”¾è·ç¦»ï¼ˆé˜²æ­¢ç¼©å¤ªè¿‘ï¼‰</td></tr><tr><td><code>maxDistance</code></td><td>Number</td><td><code>Infinity</code></td><td>ç›¸æœºæœ€å¤§ç¼©æ”¾è·ç¦»ï¼ˆé˜²æ­¢ç¼©å¤ªè¿œï¼‰</td></tr><tr><td><code>minPolarAngle</code></td><td>Numberï¼ˆå¼§åº¦ï¼‰</td><td><code>0</code></td><td>å‚ç›´æ—‹è½¬æœ€å°è§’åº¦ï¼ˆé˜²æ­¢è§†è§’ç¿»åˆ°åœºæ™¯ä¸‹æ–¹ï¼‰</td></tr><tr><td><code>maxPolarAngle</code></td><td>Numberï¼ˆå¼§åº¦ï¼‰</td><td><code>Math.PI</code></td><td>å‚ç›´æ—‹è½¬æœ€å¤§è§’åº¦</td></tr></tbody></table>
<h5 data-id="heading-30">æ ¸å¿ƒæ–¹æ³•</h5>

























<table><thead><tr><th>æ–¹æ³•å</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>update()</code></td><td>æ›´æ–°æ§åˆ¶å™¨çŠ¶æ€ï¼ˆé˜»å°¼ç”Ÿæ•ˆå¿…å¤‡ï¼‰</td><td><code>controls.update()</code></td></tr><tr><td><code>reset()</code></td><td>é‡ç½®ç›¸æœºè§†è§’åˆ°åˆå§‹çŠ¶æ€</td><td><code>controls.reset()</code></td></tr><tr><td><code>dispose()</code></td><td>é”€æ¯æ§åˆ¶å™¨ï¼ˆé‡Šæ”¾å†…å­˜ï¼‰</td><td><code>controls.dispose()</code></td></tr></tbody></table>
<h4 data-id="heading-31">2.5 å…³é”®æ³¨æ„äº‹é¡¹ï¼ˆé¿å‘å¿…çœ‹ï¼‰</h4>
<ol>
<li><strong>é˜»å°¼æ•ˆæœå¿…é¡»åŠ åŠ¨ç”»å¾ªç¯</strong>ï¼š<code>enableDamping = true</code> æ—¶ï¼Œå¿…é¡»åœ¨ <code>requestAnimationFrame</code> ä¸­è°ƒç”¨ <code>controls.update()</code>ï¼Œå¦åˆ™é˜»å°¼æ— æ•ˆï¼Œè§†è§’å¡é¡¿ï¼›</li>
<li><strong>æ— éœ€ç›‘å¬changeäº‹ä»¶</strong>ï¼šæ—©æœŸæ•™ç¨‹ä¼šç›‘å¬ <code>controls.addEventListener('change', () =&gt; renderer.render(...))</code>ï¼Œä½†åŠ¨ç”»å¾ªç¯æœ¬èº«ä¼šå®æ—¶æ¸²æŸ“ï¼Œæ— éœ€é¢å¤–ç›‘å¬ï¼Œåè€Œä¼šå¢åŠ æ€§èƒ½å¼€é”€ï¼›</li>
<li><strong>DOMå…ƒç´ ç»‘å®š</strong>ï¼šç¬¬äºŒä¸ªå‚æ•°å¿…é¡»ä¼  <code>renderer.domElement</code>ï¼ˆæ¸²æŸ“å™¨çš„canvasç”»å¸ƒï¼‰ï¼Œå¦åˆ™æ§åˆ¶å™¨æ— æ³•ç›‘å¬é¼ æ ‡äº‹ä»¶ï¼›</li>
<li><strong>è§†è§’é™åˆ¶</strong>ï¼šé€šè¿‡ <code>minDistance/maxDistance</code> é™åˆ¶ç¼©æ”¾èŒƒå›´ï¼Œé¿å…ç”¨æˆ·ç¼©æ”¾è¿‡åº¦å¯¼è‡´çœ‹ä¸åˆ°åœºæ™¯ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-32">ä¸‰ã€å®Œæ•´ç¤ºä¾‹ä»£ç ï¼ˆå…‰æº+OrbitControls ç»¼åˆä½¿ç”¨ï¼‰</h3>
<pre><code class="hljs language-html" lang="html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"zh-CN"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Three.js å…‰æº+è½¨é“æ§åˆ¶å™¨<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"><span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>; <span class="hljs-attribute">overflow</span>: hidden; }</span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-variable constant_">THREE</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'https://threejsfundamentals.org/threejs/resources/threejs/r132/build/three.module.js'</span>
    <span class="hljs-keyword">import</span> { <span class="hljs-title class_">OrbitControls</span> }  <span class="hljs-keyword">from</span> <span class="hljs-string">"https://threejsfundamentals.org/threejs/resources/threejs/r132/examples/jsm/controls/OrbitControls.js"</span>

    <span class="hljs-comment">// 1. åˆ›å»ºä¸‰å¤§æ ¸å¿ƒ</span>
    <span class="hljs-keyword">const</span> scene = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Scene</span>();
    <span class="hljs-keyword">const</span> camera = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PerspectiveCamera</span>(<span class="hljs-number">75</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>/<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>, <span class="hljs-number">0.1</span>, <span class="hljs-number">1000</span>);
    <span class="hljs-keyword">const</span> renderer = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">WebGLRenderer</span>({ <span class="hljs-attr">antialias</span>: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// æŠ—é”¯é½¿</span>
    renderer.<span class="hljs-title function_">setSize</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>);
    renderer.<span class="hljs-property">shadowMap</span>.<span class="hljs-property">enabled</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// å¼€å¯å…¨å±€é˜´å½±æ”¯æŒ</span>
    <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(renderer.<span class="hljs-property">domElement</span>);

    <span class="hljs-comment">// 2. åˆ›å»ºå‡ ä½•ä½“+æè´¨+ç½‘æ ¼ï¼ˆPBRæè´¨ï¼Œå—å…‰ç…§å½±å“ï¼‰</span>
    <span class="hljs-keyword">const</span> geometry = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">BoxGeometry</span>(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);
    <span class="hljs-keyword">const</span> material = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">MeshStandardMaterial</span>({
      <span class="hljs-attr">color</span>: <span class="hljs-number">0x00ff00</span>,
      <span class="hljs-attr">roughness</span>: <span class="hljs-number">0.5</span>, <span class="hljs-comment">// ç²—ç³™åº¦</span>
      <span class="hljs-attr">metalness</span>: <span class="hljs-number">0.2</span>  <span class="hljs-comment">// é‡‘å±åº¦</span>
    });
    <span class="hljs-keyword">const</span> cube = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Mesh</span>(geometry, material);
    cube.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// ç«‹æ–¹ä½“æŠ•å°„é˜´å½±</span>
    cube.<span class="hljs-property">receiveShadow</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// ç«‹æ–¹ä½“æ¥æ”¶é˜´å½±</span>
    scene.<span class="hljs-title function_">add</span>(cube);

    <span class="hljs-comment">// 3. åˆ›å»ºåœ°é¢ï¼ˆæ¥æ”¶é˜´å½±ï¼‰</span>
    <span class="hljs-keyword">const</span> groundGeo = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PlaneGeometry</span>(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>);
    <span class="hljs-keyword">const</span> groundMat = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">MeshStandardMaterial</span>({ <span class="hljs-attr">color</span>: <span class="hljs-number">0xcccccc</span> });
    <span class="hljs-keyword">const</span> ground = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">Mesh</span>(groundGeo, groundMat);
    ground.<span class="hljs-property">rotation</span>.<span class="hljs-property">x</span> = -<span class="hljs-title class_">Math</span>.<span class="hljs-property">PI</span> / <span class="hljs-number">2</span>; <span class="hljs-comment">// æ—‹è½¬ä¸ºåœ°é¢</span>
    ground.<span class="hljs-property">position</span>.<span class="hljs-property">y</span> = -<span class="hljs-number">3</span>;
    ground.<span class="hljs-property">receiveShadow</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// åœ°é¢æ¥æ”¶é˜´å½±</span>
    scene.<span class="hljs-title function_">add</span>(ground);

    <span class="hljs-comment">// 4. æ·»åŠ å…‰æºï¼ˆç¯å¢ƒå…‰+å¹³è¡Œå…‰+ç‚¹å…‰æºï¼‰</span>
    <span class="hljs-comment">// 4.1 ç¯å¢ƒå…‰ï¼ˆæ‰“åº•ï¼‰</span>
    <span class="hljs-keyword">const</span> ambientLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">AmbientLight</span>(<span class="hljs-number">0xffffff</span>, <span class="hljs-number">0.5</span>);
    scene.<span class="hljs-title function_">add</span>(ambientLight);
    <span class="hljs-comment">// 4.2 å¹³è¡Œå…‰ï¼ˆä¸»å…‰æºï¼Œæ¨¡æ‹Ÿå¤ªé˜³ï¼‰</span>
    <span class="hljs-keyword">const</span> dirLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">DirectionalLight</span>(<span class="hljs-number">0xffffff</span>, <span class="hljs-number">1.2</span>);
    dirLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">5</span>);
    dirLight.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>;
    dirLight.<span class="hljs-property">shadow</span>.<span class="hljs-property">mapSize</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">2048</span>, <span class="hljs-number">2048</span>); <span class="hljs-comment">// æé«˜é˜´å½±åˆ†è¾¨ç‡</span>
    scene.<span class="hljs-title function_">add</span>(dirLight);
    <span class="hljs-comment">// 4.3 ç‚¹å…‰æºï¼ˆæ¨¡æ‹Ÿç¯æ³¡ï¼‰</span>
    <span class="hljs-keyword">const</span> pointLight = <span class="hljs-keyword">new</span> <span class="hljs-variable constant_">THREE</span>.<span class="hljs-title class_">PointLight</span>(<span class="hljs-number">0xffaa00</span>, <span class="hljs-number">1.5</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>);
    pointLight.<span class="hljs-property">position</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);
    pointLight.<span class="hljs-property">castShadow</span> = <span class="hljs-literal">true</span>;
    scene.<span class="hljs-title function_">add</span>(pointLight);

    <span class="hljs-comment">// 5. è®¾ç½®ç›¸æœºä½ç½®</span>
    camera.<span class="hljs-property">position</span>.<span class="hljs-property">z</span> = <span class="hljs-number">8</span>;

    <span class="hljs-comment">// 6. åˆ›å»ºè½¨é“æ§åˆ¶å™¨ï¼ˆæ ¸å¿ƒäº¤äº’ï¼‰</span>
    <span class="hljs-keyword">const</span> controls = <span class="hljs-keyword">new</span> <span class="hljs-title class_">OrbitControls</span>(camera, renderer.<span class="hljs-property">domElement</span>);
    controls.<span class="hljs-property">enableDamping</span> = <span class="hljs-literal">true</span>; <span class="hljs-comment">// é˜»å°¼é¡ºæ»‘</span>
    controls.<span class="hljs-property">dampingFactor</span> = <span class="hljs-number">0.05</span>;
    controls.<span class="hljs-property">minDistance</span> = <span class="hljs-number">3</span>; <span class="hljs-comment">// æœ€å°ç¼©æ”¾è·ç¦»</span>
    controls.<span class="hljs-property">maxDistance</span> = <span class="hljs-number">20</span>; <span class="hljs-comment">// æœ€å¤§ç¼©æ”¾è·ç¦»</span>

    <span class="hljs-comment">// 7. åŠ¨ç”»å¾ªç¯</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">animate</span>(<span class="hljs-params"/>) {
      <span class="hljs-title function_">requestAnimationFrame</span>(animate);
      cube.<span class="hljs-property">rotation</span>.<span class="hljs-property">x</span> += <span class="hljs-number">0.01</span>; <span class="hljs-comment">// ç«‹æ–¹ä½“æ—‹è½¬</span>
      cube.<span class="hljs-property">rotation</span>.<span class="hljs-property">y</span> += <span class="hljs-number">0.01</span>;
      controls.<span class="hljs-title function_">update</span>(); <span class="hljs-comment">// æ›´æ–°æ§åˆ¶å™¨ï¼ˆé˜»å°¼ç”Ÿæ•ˆï¼‰</span>
      renderer.<span class="hljs-title function_">render</span>(scene, camera);
    }
    <span class="hljs-title function_">animate</span>();

    <span class="hljs-comment">// 8. çª—å£é€‚é…</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'resize'</span>, <span class="hljs-function">() =&gt;</span> {
      camera.<span class="hljs-property">aspect</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> / <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>;
      camera.<span class="hljs-title function_">updateProjectionMatrix</span>();
      renderer.<span class="hljs-title function_">setSize</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span>, <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerHeight</span>);
    });
  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h4 data-id="heading-33">ç¤ºä¾‹æ•ˆæœ</h4>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ed989472a1244840ae35dec5b0ee36cf~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6YCg6L2u5a2Q55qE54yq:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769497902&amp;x-signature=kQFL32H0E4T4KHZI6iOmDnIweI8%3D" alt="2f13475d-0ffd-405c-b6e3-7eb459c6dbd5.png" loading="lazy"/></p>
<ol>
<li>åœºæ™¯ä¸­æœ‰ç»¿è‰²ç«‹æ–¹ä½“å’Œç°è‰²åœ°é¢ï¼Œç«‹æ–¹ä½“ç¼“æ…¢æ—‹è½¬ï¼›</li>
<li>å¹³è¡Œå…‰æ¨¡æ‹Ÿå¤ªé˜³å…‰ï¼Œç«‹æ–¹ä½“äº§ç”Ÿè‡ªç„¶é˜´å½±ï¼›</li>
<li>ç‚¹å…‰æºæ¨¡æ‹Ÿç¯æ³¡ï¼Œç«‹æ–¹ä½“é è¿‘å…‰æºçš„åŒºåŸŸæ›´äº®ï¼›</li>
<li>é¼ æ ‡æ“ä½œï¼šå·¦é”®æ—‹è½¬è§†è§’ã€æ»šè½®ç¼©æ”¾ã€å³é”®å¹³ç§»ï¼Œè§†è§’ç§»åŠ¨é¡ºæ»‘æœ‰æƒ¯æ€§ï¼›</li>
<li>çª—å£ç¼©æ”¾æ—¶ï¼Œåœºæ™¯è‡ªåŠ¨é€‚é…å°ºå¯¸ã€‚</li>
</ol>
<hr/>
<h3 data-id="heading-34">æ ¸å¿ƒæ€»ç»“</h3>
<ol>
<li><strong>å…‰æºä½¿ç”¨åŸåˆ™</strong>ï¼š
<ul>
<li>å—å…‰ç…§æè´¨å¿…é¡»åŠ å…‰æºï¼Œã€Œç¯å¢ƒå…‰ï¼ˆæ‰“åº•ï¼‰+ ä¸»å…‰æºï¼ˆå¹³è¡Œå…‰/èšå…‰ç¯ï¼‰ã€æ˜¯æœ€ä¼˜ç»„åˆï¼›</li>
<li>å¹³è¡Œå…‰æ˜¯åœºæ™¯ä¸»å…‰æºé¦–é€‰ï¼Œç‚¹å…‰æº/èšå…‰ç¯ç”¨äºå±€éƒ¨ç…§æ˜ï¼›</li>
<li>å¼€å¯é˜´å½±éœ€åŒæ—¶è®¾ç½®ã€Œå…‰æº.castShadow + ç‰©ä½“.castShadow/receiveShadow + æ¸²æŸ“å™¨.shadowMap.enabledã€ã€‚</li>
</ul>
</li>
<li><strong>OrbitControls æ ¸å¿ƒ</strong>ï¼š
<ul>
<li>é˜»å°¼æ•ˆæœï¼ˆenableDamping=trueï¼‰æ˜¯æå‡äº¤äº’ä½“éªŒçš„å…³é”®ï¼Œå¿…é¡»åœ¨åŠ¨ç”»å¾ªç¯ä¸­è°ƒç”¨ <code>controls.update()</code>ï¼›</li>
<li>é€šè¿‡ <code>min/maxDistance</code> é™åˆ¶ç¼©æ”¾èŒƒå›´ï¼Œé¿å…è§†è§’å¤±æ§ï¼›</li>
<li>æ— éœ€ç›‘å¬ <code>change</code> äº‹ä»¶ï¼ŒåŠ¨ç”»å¾ªç¯å®æ—¶æ¸²æŸ“å³å¯ã€‚</li>
</ul>
</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š
<ul>
<li>å…‰æºé˜´å½±åˆ†è¾¨ç‡ä¸å®œè¿‡é«˜ï¼ˆå¦‚2048è¶³å¤Ÿï¼‰ï¼Œå¦åˆ™å½±å“æ€§èƒ½ï¼›</li>
<li>éå¿…è¦åœºæ™¯å…³é—­é˜´å½±ï¼Œå‡å°‘è®¡ç®—å¼€é”€ã€‚</li>
</ul>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[OpenManus æœ¬åœ°éƒ¨ç½²æŒ‡å—ï¼šä»ç¯å¢ƒæ­å»ºåˆ°å®æˆ˜è¿è¡Œ]]></title>    <link>https://juejin.cn/post/7597024900520853556</link>    <guid>https://juejin.cn/post/7597024900520853556</guid>    <pubDate>2026-01-20T06:58:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597024900520853556" data-draft-id="7596989416761065507" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="OpenManus æœ¬åœ°éƒ¨ç½²æŒ‡å—ï¼šä»ç¯å¢ƒæ­å»ºåˆ°å®æˆ˜è¿è¡Œ"/> <meta itemprop="keywords" content="Agent,Python"/> <meta itemprop="datePublished" content="2026-01-20T06:58:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™ˆæš–ç§‹"/> <meta itemprop="url" content="https://juejin.cn/user/493019579297533"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            OpenManus æœ¬åœ°éƒ¨ç½²æŒ‡å—ï¼šä»ç¯å¢ƒæ­å»ºåˆ°å®æˆ˜è¿è¡Œ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/493019579297533/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™ˆæš–ç§‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T06:58:33.000Z" title="Tue Jan 20 2026 06:58:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    18
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;color:#3c9dff}.markdown-body h1{font-size:30px;margin-bottom:5px;padding-bottom:8px;text-align:center}.markdown-body h2{font-size:24px;padding-bottom:6px}.markdown-body h2:before{content:"ğŸ‹"}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h3:before{content:"ğŸ“"}.markdown-body h4{font-size:16px}.markdown-body h4:before{content:"ğŸ‘"}.markdown-body h5{font-size:15px}.markdown-body h5:before{content:"ğŸ‰"}.markdown-body h6{margin-top:5px}.markdown-body h6:before{content:"ğŸ’"}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{display:block;margin:0 auto;max-width:100%;border-radius:4px;padding:1px;border:1px solid #d2e8ff}.markdown-body img:hover{box-shadow:0 1px 3px #5eaeff}.markdown-body hr{height:4px;margin:34px 0;background-size:4px 1px;background-image:linear-gradient(270deg,#5eaeff,#f3f9ff 25%,transparent 50%);border-style:none}.markdown-body code{word-break:break-word;border-radius:3px;overflow-x:auto;background-color:#d2e8ff;color:#3c9dff;font-size:.9em;padding:.1em .5em;margin:0 3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;transition:all .3s}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:1px solid #90c7ff;border-radius:4px}.markdown-body pre:hover{box-shadow:0 1px 10px #beddff}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#3c9dff;border-bottom:1px solid #90c7ff;transition:all .3s}.markdown-body a:hover{color:#007fff;border-bottom:2px solid #5eaeff}.markdown-body a[href]:not(:empty){padding-right:18px}.markdown-body a[href]:not(:empty):after{display:inline-block;width:16px;height:16px;margin-left:2px;content:"";background:url(data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxwYXRoIGQ9Ik0zODQgMTI4YTQ4IDQ4IDAgMDEyLjgxNiA5NS45MkwzODQgMjI0SDI1NmEzMiAzMiAwIDAwLTMxLjkyIDI5LjZMMjI0IDI1NnY1MTJhMzIgMzIgMCAwMDI5LjYgMzEuOTJsMi40LjA4aDUxMmEzMiAzMiAwIDAwMzEuOTItMjkuNmwuMDgtMi40VjY1NmE0OCA0OCAwIDAxOTUuOTItMi44MTZMODk2IDY1NnYxMTJhMTI4IDEyOCAwIDAxLTEyNCAxMjcuOTM2bC00IC4wNjRIMjU2YTEyOCAxMjggMCAwMS0xMjcuOTM2LTEyNGwtLjA2NC00VjI1NmExMjggMTI4IDAgMDExMjQtMTI3LjkzNmw0LS4wNjRoMTI4em0zODQgMGExMjggMTI4IDAgMDExMjcuOTM2IDEyNGwuMDY0IDR2MTYwYTQ4IDQ4IDAgMDEtOTUuOTIgMi44MTZMODAwIDQxNlYyOTEuODcybC0zODIuMDY0IDM4Mi4wOGE0OCA0OCAwIDAxLTcwLjAzMi02NS42bDIuMTYtMi4yODhMNzMyLjA5NiAyMjRINjA4YTQ4IDQ4IDAgMDEtMi44MTYtOTUuOTJMNjA4IDEyOGgxNjB6IiBmaWxsPSIjM2M5ZGZmIiBmaWxsLW9wYWNpdHk9Ii41NiIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC5zZWFyY2hfaW5kZXguMC5pMC41Yzc1M2E4MTgwa2RKWCIgY2xhc3M9InNlbGVjdGVkIi8+PC9zdmc+);background-size:100%}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #3c9dff}.markdown-body thead{text-align:center}.markdown-body thead th{color:#fff;background-color:#5eaeff}.markdown-body tr{text-align:center}.markdown-body tbody tr:hover{background-color:#d2e8ff}.markdown-body tbody tr:hover code{background-color:#90c7ff}.markdown-body tr:nth-child(2n){background-color:#ecf5ff}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li::marker,.markdown-body ul li::marker{color:#5eaeff}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body b,.markdown-body strong{font-weight:900;padding:0 1px;font-size:17px}.markdown-body small{color:#cbcbcb;padding:0 1px;font-size:22px;zoom:.5}.markdown-body em{padding:0 1px}.markdown-body del{padding:0 1px;text-decoration-thickness:2px}.markdown-body blockquote{color:#1a1b1c;padding:1px 20px;margin:22px 0;border-radius:4px;border-left:4px solid rgba(60,157,255,.5);background-color:rgba(190,221,255,.3)}.markdown-body blockquote blockquote{margin:8px 0}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{margin:12px 0;padding:4px 10px;border:2px solid #3c9dff;border-radius:8px;background-color:#ecf5ff;transition:all .3s}.markdown-body details summary{cursor:pointer}.markdown-body input[type=checkbox]{position:relative;appearance:none;width:16px;height:16px;border-radius:2px;vertical-align:middle;transform:translateY(-2px);box-sizing:border-box;border:1px solid #beddff}.markdown-body input[type=checkbox]:checked{border:1px solid #5eaeff;background-color:#5eaeff}.markdown-body input[type=checkbox]:checked:before{position:absolute;top:3px;left:1px;width:11px;height:6px;background-color:transparent;border-left:2px solid #fff;border-bottom:2px solid #fff;transform:rotate(-45deg);content:"";box-sizing:border-box}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p>æƒ³å°è¯•æœ€æ–°çš„ AI Agent åŠ©æ‰‹ OpenManusï¼Ÿæœ¬æ•™ç¨‹å¸¦ä½ ä¸€æ­¥æ­¥å®Œæˆæœ¬åœ°éƒ¨ç½²ï¼ŒåŒ…æ‹¬ Python å¤šç‰ˆæœ¬ç®¡ç†çš„å…¨å¥—è§£å†³æ–¹æ¡ˆã€‚</p>
</blockquote>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p>æœ€è¿‘æ¥è§¦åˆ°äº†ç”± FoundationAgents å¼€å‘çš„æ™ºèƒ½ Agent å·¥å…·â€”â€”OpenManusã€‚OpenManus è¦æ±‚ Python 3.12 ç‰ˆæœ¬ï¼Œè€Œæˆ‘çš„ç³»ç»Ÿè¿˜æ˜¯åŸæ¥çš„ 3.10ã€‚æ—¢è¦ä¿ç•™åŸæœ‰çš„å¼€å‘ç¯å¢ƒï¼Œåˆè¦æ»¡è¶³æ–°é¡¹ç›®çš„éœ€æ±‚ï¼Œè¿™å°±éœ€è¦ç”¨åˆ° Python å¤šç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼š<strong>pyenv</strong>ã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘ä»é›¶å¼€å§‹çš„å®Œæ•´éƒ¨ç½²è¿‡ç¨‹ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°æœ‰ç±»ä¼¼éœ€æ±‚çš„æœ‹å‹ï¼ğŸ˜Š</p>
<h2 data-id="heading-1">ä¸€ã€ä¸ºä»€ä¹ˆç”¨ PyEnvï¼Ÿ</h2>
<p>é¢å¯¹å¤šä¸ªé¡¹ç›®å¯¹ Python ç‰ˆæœ¬çš„ä¸åŒè¦æ±‚ï¼Œæœ€ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆä¸æ˜¯å¸è½½æ—§ç‰ˆæœ¬å®‰è£…æ–°ç‰ˆæœ¬ï¼ˆè¿™æ ·å®¹æ˜“ç ´åç°æœ‰ç¯å¢ƒï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨ <strong>PyEnv</strong> è¿™æ ·çš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚å®ƒçš„ä¼˜åŠ¿åœ¨äºï¼š</p>
<ul>
<li>âœ… æ‰€æœ‰ Python ç‰ˆæœ¬éš”ç¦»å­˜å‚¨ï¼Œäº’ä¸å¹²æ‰°</li>
<li>âœ… å¯ä»¥éšæ—¶åˆ‡æ¢å…¨å±€ã€å±€éƒ¨æˆ–ä¸´æ—¶çš„ Python ç‰ˆæœ¬</li>
<li>âœ… å®‰å…¨ç¨³å®šï¼Œå®‰è£…å¸è½½éƒ½ä¸å½±å“ç³»ç»Ÿå…¶ä»–ç¨‹åº</li>
<li>âœ… ç±»ä¼¼ Node.js çš„ NVMï¼Œç”¨è¿‡å°±ç¦»ä¸å¼€ç³»åˆ—</li>
</ul>
<hr/>
<h2 data-id="heading-2">äºŒã€å®Œæ•´ç¯å¢ƒæ­å»ºæ­¥éª¤</h2>
<h3 data-id="heading-3">ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šå®‰è£…ç¼–è¯‘ä¾èµ–</h3>
<p>åœ¨å®‰è£…æ–°ç‰ˆæœ¬ Python ä¹‹å‰ï¼Œç³»ç»Ÿéœ€è¦å‡†å¤‡å¥½å¿…è¦çš„ç¼–è¯‘å·¥å…·ã€‚Ubuntu/Debian ç³»ç»Ÿæ‰§è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash">sudo apt update
sudo apt install -y make build-essential libssl-dev zlib1g-dev \
libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm \
libncurses5-dev libncursesw5-dev xz-utils tk-dev libffi-dev \
liblzma-dev python-openssl git
</code></pre>
<h3 data-id="heading-4">âš™ï¸ ç¬¬äºŒæ­¥ï¼šå®‰è£… pyenv</h3>
<p>ä½¿ç”¨å®˜æ–¹æä¾›çš„å®‰è£…è„šæœ¬ï¼Œä¸€è¡Œæå®šï¼š</p>
<pre><code class="hljs language-bash" lang="bash">curl https://pyenv.run | bash
</code></pre>
<h3 data-id="heading-5">ğŸ”§ ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡</h3>
<p>å®‰è£…åéœ€è¦é…ç½® Shell é…ç½®æ–‡ä»¶ï¼Œè®©ç³»ç»Ÿè¯†åˆ« pyenv å‘½ä»¤ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">'export PYENV_ROOT="$HOME/.pyenv"'</span> &gt;&gt; ~/.bashrc
<span class="hljs-built_in">echo</span> <span class="hljs-string">'[[ -d $PYENV_ROOT/bin ]] &amp;&amp; export PATH="$PYENV_ROOT/bin:$PATH"'</span> &gt;&gt; ~/.bashrc
<span class="hljs-built_in">echo</span> <span class="hljs-string">'eval "$(pyenv init -)"'</span> &gt;&gt; ~/.bashrc
<span class="hljs-built_in">source</span> ~/.bashrc
</code></pre>
<p>éªŒè¯å®‰è£…æˆåŠŸï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pyenv --version  <span class="hljs-comment"># å¦‚æœè¾“å‡ºç‰ˆæœ¬å·ï¼Œè¯´æ˜æˆåŠŸå•¦ï¼</span>
</code></pre>
<h3 data-id="heading-6">ğŸ ç¬¬å››æ­¥ï¼šå®‰è£… Python 3.12</h3>
<p>æŸ¥çœ‹å¯ç”¨ç‰ˆæœ¬åˆ—è¡¨ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pyenv install --list | grep 3.12
</code></pre>
<p>å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼ˆè¿™é‡Œä»¥ 3.12.6 ä¸ºä¾‹ï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pyenv install 3.12.6
</code></pre>
<p>è¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ï¼Œè€å¿ƒç­‰å¾…å³å¯ â˜•</p>
<h3 data-id="heading-7">ğŸ”„ ç¬¬äº”æ­¥ï¼šçµæ´»åˆ‡æ¢ç‰ˆæœ¬</h3>
<p>å®‰è£…å¥½åï¼Œæœ‰ä¸‰ç§åˆ‡æ¢æ–¹å¼ä¾›ä½ é€‰æ‹©ï¼š</p>
<h4 data-id="heading-8">1ï¸âƒ£ å…¨å±€åˆ‡æ¢</h4>
<pre><code class="hljs language-bash" lang="bash">pyenv global 3.12.6
<span class="hljs-comment"># ä¹‹åæ‰€æœ‰ç»ˆç«¯éƒ½é»˜è®¤ä½¿ç”¨ 3.12.6</span>
python --version  <span class="hljs-comment"># åº”è¯¥æ˜¾ç¤º Python 3.12.6</span>
</code></pre>
<h4 data-id="heading-9">2ï¸âƒ£ å±€éƒ¨åˆ‡æ¢ï¼ˆæ¨èï¼‰â­</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> /path/to/your/project
pyenv <span class="hljs-built_in">local</span> 3.12.6
<span class="hljs-comment"># åªæœ‰åœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰ä½¿ç”¨ 3.12.6</span>
<span class="hljs-comment"># å…¶ä»–ç›®å½•ä¿æŒä¹‹å‰çš„ç‰ˆæœ¬è®¾ç½®</span>
</code></pre>
<p>è¿™ä¸ªæ–¹å¼ç‰¹åˆ«é€‚åˆåœ¨ä¸åŒé¡¹ç›®é—´æ— ç¼åˆ‡æ¢ï¼</p>
<h4 data-id="heading-10">3ï¸âƒ£ ä¸´æ—¶åˆ‡æ¢</h4>
<pre><code class="hljs language-bash" lang="bash">pyenv shell 3.12.6
<span class="hljs-comment"># ä»…åœ¨å½“å‰ç»ˆç«¯çª—å£ç”Ÿæ•ˆï¼Œå…³çª—å£åå¤±æ•ˆ</span>
</code></pre>
<h3 data-id="heading-11">âª è¿›é˜¶ï¼šå¦‚ä½•åˆ‡å›ç³»ç»Ÿç‰ˆæœ¬ï¼Ÿ</h3>
<p>æƒ³æ¢å¤ç³»ç»ŸåŸç”Ÿ Pythonï¼Ÿåªéœ€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pyenv global system
<span class="hljs-comment"># æˆ–è€…åˆ‡æ¢åˆ°å…¶ä»–å·²å®‰è£…çš„ç‰ˆæœ¬</span>
<span class="hljs-comment"># pyenv global 3.10.0</span>
</code></pre>
<p><strong>PyEnv æŠŠæ‰€æœ‰ç‰ˆæœ¬ç»Ÿä¸€å®‰è£…åœ¨ <code>~/.pyenv/versions</code> ç›®å½•ä¸‹</strong>ï¼Œè¿™ç§éå¸¸è§„æ•´çš„ç›®å½•ç»“æ„è®©ç®¡ç†å’Œç»´æŠ¤å˜å¾—è¶…çº§è½»æ¾ã€‚</p>
<hr/>
<h2 data-id="heading-12">ä¸‰ã€OpenManus éƒ¨ç½²å®æˆ˜</h2>
<p>ç¯å¢ƒå‡†å¤‡å¥½åï¼Œæ¥ä¸‹æ¥å°±æ˜¯éƒ¨ç½² OpenManus æœ¬èº«äº†ï¼</p>
<h3 data-id="heading-13">ğŸ“‹ å®‰è£…ä¾èµ–</h3>
<p>è¿›å…¥é¡¹ç›®ç›®å½•åï¼Œå…ˆå±€éƒ¨è®¾ç½® Python ç‰ˆæœ¬ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">pyenv <span class="hljs-built_in">local</span> 3.12.6
uv venv --python 3.12.6
<span class="hljs-built_in">source</span> .venv/bin/activate
uv pip install -r requirements.txt
</code></pre>
<h3 data-id="heading-14">âš™ï¸ é…ç½® API</h3>
<p>OpenManus éœ€è¦é…ç½® LLM API æ‰èƒ½ä½¿ç”¨ã€‚å¤åˆ¶é…ç½®æ¨¡æ¿ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cp</span> config/config.example.toml config/config.toml
</code></pre>
<p>ç¼–è¾‘ <code>config.toml</code> æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å…³é”®å†…å®¹ï¼š</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-comment"># å…¨å±€ LLM é…ç½®</span>
<span class="hljs-section">[llm]</span>
<span class="hljs-attr">model</span> = <span class="hljs-string">"gpt-4o"</span>
<span class="hljs-attr">base_url</span> = <span class="hljs-string">"https://api.openai.com/v1"</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-ä½ çš„OpenAIå¯†é’¥"</span>
<span class="hljs-attr">max_tokens</span> = <span class="hljs-number">8192</span>
<span class="hljs-attr">temperature</span> = <span class="hljs-number">0.7</span> 

<span class="hljs-comment"># å¯é€‰ï¼šè§†è§‰èƒ½åŠ›çš„ LLM é…ç½®</span>
<span class="hljs-section">[llm.vision]</span>
<span class="hljs-attr">model</span> = <span class="hljs-string">"gpt-4o"</span>
<span class="hljs-attr">base_url</span> = <span class="hljs-string">"https://api.openai.com/v1"</span>
<span class="hljs-attr">api_key</span> = <span class="hljs-string">"sk-ä½ çš„OpenAIå¯†é’¥"</span>
</code></pre>
<h3 data-id="heading-15">ğŸš€ å¯åŠ¨è¿è¡Œ</h3>
<p><strong>é‡è¦æç¤º</strong>ï¼šç”±äºå…¬å¸å†…ç½‘å­˜åœ¨ç½‘ç»œä»£ç†ï¼Œéœ€è¦åœ¨ <code>main.py</code> ä¸­å»æ‰ä»£ç†é…ç½®ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
    os.environ[<span class="hljs-string">"http_proxy"</span>] = <span class="hljs-string">""</span>
    os.environ[<span class="hljs-string">"https_proxy"</span>] = <span class="hljs-string">""</span>
    os.environ[<span class="hljs-string">"HTTP_PROXY"</span>] = <span class="hljs-string">""</span>
    os.environ[<span class="hljs-string">"HTTPS_PROXY"</span>] = <span class="hljs-string">""</span>
    os.environ[<span class="hljs-string">"no_proxy"</span>] = <span class="hljs-string">"*"</span>
    os.environ[<span class="hljs-string">"NO_PROXY"</span>] = <span class="hljs-string">"*"</span>
    asyncio.run(main())
</code></pre>
<p>ç„¶åå¯åŠ¨æœåŠ¡ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">python main.py
</code></pre>
<p>å‡ºç° "Enter your prompt:" è¯´æ˜å¯åŠ¨æˆåŠŸäº†ï¼ğŸ‰</p>
<hr/>
<h2 data-id="heading-16">å››ã€å®æµ‹ Demo</h2>
<p>è®©æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ OpenManus çš„èƒ½åŠ›å§ï¼çœ‹æˆ‘è®©å®ƒè§£é‡Šä»€ä¹ˆæ˜¯ Python è£…é¥°å™¨ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">Enter your prompt:</span> <span class="hljs-string">å¸®ä»‹ç»ä¸€ä¸‹pythonè£…é¥°å™¨</span>
</code></pre>
<p>OpenManus ä¸ä»…ç»™å‡ºäº†ä¸“ä¸šçš„ç†è®ºè§£é‡Šï¼Œè¿˜é€šè¿‡å®é™…çš„ Python ä»£ç æ‰§è¡Œæ¼”ç¤ºäº†è£…é¥°å™¨çš„æŒ‰ç§ç”¨æ³•ï¼š</p>
<ol>
<li>âœ… åŸºç¡€è£…é¥°å™¨ - åœ¨å‡½æ•°å‰åæ·»åŠ æ—¥å¿—</li>
<li>âœ… å¸¦å‚æ•°çš„è£…é¥°å™¨ - å¦‚é‡å¤æ‰§è¡Œå¤šæ¬¡</li>
<li>âœ… ä¿ç•™å‡½æ•°å…ƒæ•°æ® - ä½¿ç”¨ <code>functools.wraps</code></li>
<li>âœ… ç±»æ–¹æ³•è£…é¥°å™¨ - ä¸ºç±»æ–¹æ³•æ·»åŠ è°ƒç”¨æ—¥å¿—</li>
<li>âœ… é”™è¯¯å¤„ç†è£…é¥°å™¨ - ä¼˜é›…æ•è·å¼‚å¸¸</li>
<li>âœ… ç¼“å­˜è£…é¥°å™¨ï¼ˆMemoizationï¼‰- æå‡ Fibonacci æ•°åˆ—æ€§èƒ½</li>
<li>âœ… è®¡æ—¶å™¨è£…é¥°å™¨ - æ–¹ä¾¿æ€§èƒ½åˆ†æ</li>
<li>âœ… å¤šè£…é¥°å™¨ç»„åˆ - æ—¥å¿—+è®¡æ—¶+é”™è¯¯å¤„ç†ä¸€ä½“åŒ–</li>
</ol>
<p>æ•´ä¸ªè¿‡ç¨‹ OpenManus é€šè¿‡è‡ªè¡Œä¹¦å†™ä»£ç ã€æ‰§è¡ŒéªŒè¯ã€ä¿®æ­£é”™è¯¯ã€é€å±‚å®Œå–„æ•™å­¦ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¼ºå¤§çš„ä»£ç ç†è§£å’Œæ•™å­¦èƒ½åŠ›ï¼ŒçœŸå¿ƒéœ‡æ’¼ï¼ğŸ¤¯</p>
<hr/>
<h2 data-id="heading-17">äº”ã€æ€»ç»“ä¸å¿ƒå¾—</h2>
<p>æå®šï¼ç»å†è¿™æ¬¡éƒ¨ç½²ï¼Œæˆ‘æœ‰å‡ ç‚¹ç»éªŒåˆ†äº«ç»™å¤§å®¶ï¼š</p>
<h3 data-id="heading-18">ğŸ’¡ æ ¸å¿ƒè¦ç‚¹</h3>
<ol>
<li><strong>PyEnv æ˜¯å¤šç‰ˆæœ¬ç®¡ç†çš„ç‘å£«å†›åˆ€</strong>ï¼Œå­¦ä¼šå®ƒä¹‹åï¼Œå†ä¹Ÿä¸æ€•å¤šä¸ªé¡¹ç›®çš„ç‰ˆæœ¬å†²çªé—®é¢˜</li>
<li><strong>å±€éƒ¨ç‰ˆæœ¬åˆ‡æ¢æœ€é€‚åˆå®é™…å¼€å‘</strong>ï¼Œå…¨å±€åšå¥½åŸºç¡€é…ç½®ï¼Œæ¯ä¸ªé¡¹ç›®ç”¨è‡ªå·±çš„ç‰ˆæœ¬</li>
<li>OpenManus çš„å¯åŠ¨è¿‡ç¨‹å¾ˆé¡ºç•…ï¼Œå¦‚æœé‡åˆ°ä»£ç†é—®é¢˜ï¼Œè®°å¾—æ£€æŸ¥å¹¶å–æ¶ˆä»£ç†è®¾ç½®</li>
<li><strong>è™šæ‹Ÿç¯å¢ƒå¿…ä¸å¯å°‘</strong>ï¼Œ<code>uv venv</code> + <code>pip</code> éƒ½å¯ä»¥ï¼Œä¿æŒé¡¹ç›®é—´çš„å¹²å‡€éš”ç¦»</li>
</ol>
<h3 data-id="heading-19">ğŸ¯ ä¸‹ä¸€æ­¥æ¢ç´¢</h3>
<p>éƒ¨ç½²åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œæ¥ä¸‹æ¥æ‰“ç®—ï¼š</p>
<ul>
<li>æ·±å…¥äº†è§£ OpenManus çš„æ’ä»¶ä½“ç³»</li>
<li>å°è¯•ç»“åˆè‡ªå·±çš„æ—¥å¸¸å·¥ä½œæµå®šåˆ¶ agent è¡Œä¸º</li>
<li>æ¢ç´¢ä¸å…¶ä»–å·¥å…·ï¼ˆå¦‚æµè§ˆå™¨è‡ªåŠ¨åŒ–ï¼‰çš„é›†æˆ</li>
</ul>
<p><strong>OpenManus ä»£è¡¨äº†æ–°ä¸€ä»£ AI Agent çš„å¯èƒ½æ€§æ–¹å‘ï¼Œéå¸¸å€¼å¾—èŠ±æ—¶é—´æ·±å…¥ç ”ç©¶å’Œå®è·µï¼</strong></p>
<hr/>
<h2 data-id="heading-20">å‚è€ƒèµ„æº</h2>
<ul>
<li>ğŸ“– <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FFoundationAgents%2FOpenManus%2Fblob%2Fmain%2FREADME_zh.md" target="_blank" title="https://github.com/FoundationAgents/OpenManus/blob/main/README_zh.md" ref="nofollow noopener noreferrer">OpenManus å®˜æ–¹æ–‡æ¡£</a></li>
<li>ğŸ› ï¸ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fpyenv%2Fpyenv" target="_blank" title="https://github.com/pyenv/pyenv" ref="nofollow noopener noreferrer">PyEnv å®˜æ–¹ä»“åº“</a></li>
<li>ğŸ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.python.org%2Fdownloads%2F" target="_blank" title="https://www.python.org/downloads/" ref="nofollow noopener noreferrer">Python å®˜æ–¹ä¸‹è½½</a></li>
</ul>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ­£åˆ™è¡¨è¾¾å¼ï¼šé‚£ä¸ªä½ æ¯æ¬¡ç”¨éƒ½è¦Googleçš„"ç®€å•"å·¥å…·]]></title>    <link>https://juejin.cn/post/7596955804261662770</link>    <guid>https://juejin.cn/post/7596955804261662770</guid>    <pubDate>2026-01-20T07:17:49.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596955804261662770" data-draft-id="7596955804261613618" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ­£åˆ™è¡¨è¾¾å¼ï¼šé‚£ä¸ªä½ æ¯æ¬¡ç”¨éƒ½è¦Googleçš„&quot;ç®€å•&quot;å·¥å…·"/> <meta itemprop="keywords" content="å‰ç«¯,æ­£åˆ™è¡¨è¾¾å¼,JavaScript"/> <meta itemprop="datePublished" content="2026-01-20T07:17:49.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç¨‹åºå‘˜Agions"/> <meta itemprop="url" content="https://juejin.cn/user/360295545187751"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ­£åˆ™è¡¨è¾¾å¼ï¼šé‚£ä¸ªä½ æ¯æ¬¡ç”¨éƒ½è¦Googleçš„"ç®€å•"å·¥å…·
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/360295545187751/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç¨‹åºå‘˜Agions
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:17:49.000Z" title="Tue Jan 20 2026 07:17:49 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1}.markdown-body h1{font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto}.markdown-body h1:before{position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAA6CAYAAAAOeSEWAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAABkLSURBVGhDtZoHnJ1llcbP3Om9ZiYzmfSQhCQQIbRQVQKI9CYC68qKriJK0UXcZRcINqStIoiIqKCi1NACQihBWiCkkJ5MJlMyvd7p7d759v989/sy34yTbIj48Atz71ff855znvOc971xDrB/EtoGI7a9Z8Aq+wZML0mNj7dE95NZ1OKsj1dHo1GbnJpss9OTbWJyonvun4VP1Njuoagtb+m0it4By0iIt8LEeMvkr8XFWcfgkA1gYDLf47i2PzpsyU7UspKSLDoctagTZ7Vc08MzClMS7awJ2ZaflBB78CeET8TYla1dtrKt2w5KS7YCDGzEoz2RqKUmhGw6x2bhuXyOp2BoRXef1Q1E7Lj8TIsMD1sbxu1kcnYSAX1810RMTUmyMB7f2j1gC7NS7byinNiL/kH8Q8a+2NRh77b32El56VaPAe0YeGR2mh2bm+FdMRqP1rbZe+3dFsHT35qcb/Oz0rwzo7Gxs9feYPLS4kM2h8lawee5hPmlJXneFQeGAzJ2F564v7rFzi7Msu3d/Xgjzq5g8ArX8VCNN2vJ28daey0zZJabmGCLslP5HOf+Oygr3UzDGOf+JxrauXfQjslJt+dbuuyMgiwmk+sPAB/b2Lt2NdoMZnuY21qHIvbvUyZ4Z0ZQiXGrWjvsmPxsK4R0nmHA8ZCTQvxVQn5eRipklIBtcVbV1WtHYsjati47ZWKuTUpP9Z4yGk/xDBGe3v1mW4/dOrvYO7P/2G9jRSjf31FnXyaUXiB8r51WaJkM3kcfOSa2FR6qarIenooTLQHPLcC4mYThyw1tVpKWYlVERlZ8nC3Oz3Jzdn1nn5uvQ8OOHYvhR/CvsqffJbkCkZTvcYZ6Z0WTfTovw5Y1dtjXp+TbFPhgf7FfxpYxuMfr2uwo8rEtMmwXF+d6Z8wGmIR2PLyjo8cqOFffP2SLGexJEJCP9R29thkPXlpa4A5Y3w/jmuVNYYwO2QkY7WMtz3mVcE1hkualJdmSolzX8GnpKd4VZq80d1o7zN0RdWxGaqItgbn3B/+vsasgh/UMNBOvzYMZDxtDKp289KGaVguFQvb1yQWWwuB97GaSXqUUnVaYbSUwrDCEBz/C2CM8EhNrP13fbkeSh3OJgCAe2N1CWXKsGOc6TOr5U4q8MwYhDtkTda02MyPN+nnGBQEH7A37NHYz5KOZVv08qyjbSseEzKauPnsMj98wc6Ibcj5UUv7M8QWZTE52jEwGOVaD8U1Dw1YNWX0qM8VKyb80L/TrOPYOzH4KBJQTrK8M7+7KZjuM63sHBt17FubGoibCuf+tarWFGUmuwWeT8/vCXo1tZOYeZcazCaez8MwEzzM+HqhqtiJI5twxL1jeGLYk7jmKMF1JOCbg6Qj5nAdRqX7q3BYm8VAmQvW1lfcMc58IT95uIA3q+gftrDHPXUXJWkVEHJme5Bp5UmHsvIZ/O3l8ECE/FWcsItX2hr0ae8O2Wjs+J43QTbOZzGYQ/7Wtxq6eXjRK3r0By4YJ6Ty8EiYSJqcm2eGeV4Pox/ANENJR49RiEdfqcLflUJrEBZqgxYHrBjn2ExFURqKdVETN9YirJxKxR2rbrYeQv5ISmB6IsiDGNfZGWPeMgkzr58xnPaJ5p6XDZPKz4T77wayJ7jGhhXLwanOHTWBgq5n5q6YUwNJ7l3kKcRl7OJ7fF56l1GzvHbSD8dghTPi0wIRfv6XafjJ3ssv0PnZQ7nZx/etwzO1zJ3lHR2OETTw8x0tOx1AN3De0D7YV+63oGthjaJQ5Ur7eVVZjcdGInUyuaT73ZWg3efV8fZs7cc2E777Qi5eunVbghvPPymrt/krKGfcLd8ybYjdxrK6333Z09rjHZkNuLYzz0uIc+xWCZzz8nbHbe4dsY1e/XUOY+nimvtUaSazv4jXhaQasSbmYmpuenGwHZ8TKggSEQm08rMD7ahBOoExcMqXQegjnZ+CEvaEa1ZQUQkt39dj0zDS7krq+ARmpdws/nlNqD9WFbWN7l5u3wr9MyrcXKUsqWy3jTOaoML4DdaQ83YIoT4VYpEXvYQZLmbX5SLohBrgOj186Kc/iKTUPUhq+Rrm5ekOl3TWv1Mr6hqwbY0VOQXwEo+Moq4Z47q5qsU489G944LyJOW4LOLZOKtT/iI6+nGe/0dhuEd4ltj2NmiuCU4hnk5fHIi7+RK4uTEu0e+s7rAiRcw1CYy3OejvcYz+eXeI9MYY9nu3lYZl0KavJJ7Vjibzgjp319rUZE20j7CkJqFr5JQYgQ39f3eQaKpQk0afy8nl4uBzvjUUTRk7k3iebOm0pabDiyFn2XGu3dRME41CGVeBVqSiVnc6hIUpekp1VjHLDSOEcQlui5W/U8C7IKREjv1Gabw3wRwUTvpv7jybPtzHmIPZ49q6KRjuccqBQVCOtGvqXhrCFUUXJzOYSHt7Kw5Ix9H08dSje1o1JyL73IYXpEMmE5CRbw6wuykx2pR+Pd6/J4JpLiJKV6N9OnrcQNfQ0Zem6qQX2MmFXyWTE+DMO0kGx4e08DEjnXbsYuOq7niHB8jdY/wQ8Srm2XCZZUrOakF1CY5EKX0h93Tu/1J4kRdbDMT8MamgZK9xe3uDcvrPe++Y4f61rcZr7B53rN1c5N2ytcV5rCrvHt3T2Og19g+5nH7dvq3bqunr4NOwgK2MHA1jeEDuG7HNuLmtw7qpocl5t6nCPvdTQ7v4N4u3WTqeyu9cZHIo4f6lqdFoHh7wzMbzDeeGv3Hvzjlrnh2W1zofhHuftxpFn3VFe7zxS0+p0DlKVPbhhvBxhvwiFMgfP+mjHA08gEC4pybeLyK1iZldh8zC5VJQyUl8l59KZ0WJk2xaiYWxNrkXXJhA8r3PvZRur7ZZZRfadaRPsfiTmX9HGajC2tXd6V8dQTMhX0h8rNdJx9Ra8F8SbRNLzhPRnJmTZIUTYueTyWxyr7uv3rjC3OkzE8495oS+4xq6D5WoI0bO5WVCOSerl8rIeBrOI/Hkaw6ME5W1zSuzx2la3CRdWi3zIG+FDBvUp9LMgI/vggUmE7KkT81yGvOOgEYa/aUahhRAF5xLec3OzbF1r2O17BbVxIi7hzJIC64IYhXdJA+nh/5xVbOmE9J0QqjSxWk0pp37M2YEtgjS8GpimACu7xkqxdKJ6fEXyYl2Lre0ZtC8yELVewtWUnbfCPIhrvgDFz8WI5yhJKgcnFMZWEFrwhgzo5uWDDDA1oGSOzcu0xfx7vTlsv6posIMpJ6cGWPiw/BxL4PU7vbrpjgf8bMdu5OYwOdhm83DARUSa0ELknYIeEAaILuWxlhGa0M8+EuJCrpJT+ymENhN60pXBxa3LZ5TsucnlGaCmIEQ4Evru91yuz0xMtKaeXluI5zdh9Mm8vAlBn4aR07X64EH3vEKdXQkZJXPP/JxMvNRpLxEtHZ5RQgmNewnpouvVTpYTHdfOnmy5kFUGnpRTfEhXD9DiBdFFJB0/YWS9aj6pmc89r0BaQmgTRkgI+EsdKsYasJZOBF+QqTH474NK7LbyBvf7W+RgOxNyxfQY2/2hrp2+NkroxrzrQ55fSZkpJIa28znCgF6rb7H1hOSslATyvNflAh9pvHcX3lVE/Ya8FjTJIexa2Rq77nfU96unTnD7aME3+TAm6BFKYrPnqCNIqV5sq0ZGCiEV+Db+qWMQqpFgb5KPx48R6omeDl2EuP9DTYt9iGA/f1KBS1w/La+H4ktsSmLItvZHXLUkrCeflVtJ9DVVg1H7+sxiGvVM975rZpfabuqHVhuP5F1vewav5O8GamUe91yDanoYw47FWzC929O+DJnKA2opFY1Rjru5CE7kOcO0jJtQVUIynzuZEMeb+1CEOFXN8iFSGeRpCm1BTlJxVg49Azm819SO7Bu0axEbwn27GuxMck+TMQHDP8fn48gfDVIL4R8xKVPJ73MQBUIfA/Z54LMw5vmlE+w+VFo2A78X/SsyPA/RMD0z3e2qVLtfo7aeBslpMX0N0TEnLcUlKym1jyBFqSohmYntI5enBhYB9CY/2kNarhwJhNiMtRGyWnkQdKaCFyQwgydjyNUw4VchKxXv2/DoKdC+lkQbCX1NlKCGvJiBJkSGbCus6jfo4yGBNySgr+u7e20BCsxdVAcFlJ/tHd32+cIsNxSXUULUUx+dg/d47g7OPYFw2MxkSuyMwLHVTI6PBN6dS8Sppw45zHJSgDXV3aQzmz40Z6fDgBfiAXU0uZxby2zejee+j3eltoQMzhV6qSBogXwrEXDj7ElWxUQ8RrnSaoU0dxIsKaiMvMykXTu90NqJsGHP4z78SdLigUrLKat32nFwy/E07pfDFRdQ/7N5r57pQ1482uvWhMGhQcviGkVrKDUp0ToCxfhQal5n4Hs/g1jOgH4LWdwFOd1b1WzHET4vLZppv+Czjxo840OrDlG8jAJzv2tp5mLK1dsU/lfIOeWy5NxFxfl2BoYImlQtx9QF6mJRQKBsQYYuO2yaLYPBUXvu/VqYPxtHhNy7Y4hCkNLGPtKSklzCVKSHtMQxcqm5Kw1DhI2PTGZtcGDAvoLQ/u7MifYtWFBlxz2H9zo8RkwKzC5UYiG+p44ccqE62YAxLeT/TOpf8MXx8Qk0IJFRY1Go+viQVJpE5Ehjf49xfAZeqGIy/7us3nqxwQfCkjZypPxobVr/6YpQHIalUvuCyEwbSXC9PC8QnkFcXlrgLpoLIhIfKuaqlQkYIAwQnr/f3eyu7KttOw2lNpv8/BPHyjzVNER3o72gvEBKqRMTflndbP8BMweRDyeciEj5bFayFXqTLzheivgYJC0jwzwHa0MDDEotm48ndze5BBBElAnxxcRYHAFh3FfZaA9UNRmC354kNwUx8eHkmVj5dcTE5ZMnuEyr1QqlhtaJLuOYZv4v3KNo0TKrGPUZ1NILPKuWcvVn5Trv10SMB6h0j/ARMnlOuafCBIfnSWEx/Raif3HDzofYMM31dOyY9LBaLK3TjoX2fEqT4+2qaUVWSTQvyM6wC8nNJyEetXIyuLKrx04P7MKNnbJZlKUtNAIHo7i2dA/YU3Vtdi5l6jCepXy8hOedSSSsI8/HQg5Q+gxTKXwkMHkbESo+hjG0lbRRzQ3Fc5LOzDuFhs3Ptumpie7ilRDhlEJOq/hjsZljCxjkt7fWuPS/EekpXMggJQIk0G+eN9Xu2VmHWIkJe0nJRN4ptBBit2yutG9ML7J1DHAxebiAMrZ4VZlduqGS8I2tJc2iborUxmIN79c+kTovFxivPvrcSaP3n7RSKYTUmKt4N3rMOcw4JOneD3sP956jNaMglIeTER5Xbdlt15Tm2W10NEsYrA/N5JLCHHsR9tSqwxq08G3bqm1ZTbOtagnbo6SLvH/VzBL7W7jPzqFea0LmMLFzUuLtdwumuO3i1Vtq7OK15Xgw3l1PDmIXak+6QBEkvB9YJIzBcc/L20JIYaSZ/qAzVm5Ut4oowk3QehC+N3xo/1wTqt7zsYawfX9no9XjqdPXVLhrwyo/wucJYQkE1e4j8rLcBuHUItQQKqgMXb6LGvxFQlXw33AdZLR0V5P9Fr29lP73scNnosoyvdWPv4fPJ+uJrLVtMakqaL1M1cTvv0OLIZE6wk2a2IcIRUQh+DaejpdcXepBa7bKDRGM9PIVxTl2EwarZ72rooVuY4RQtMypdk6e1lLLehhY2lt7QEd7WxlCDvdIli6E9B4+ZIodmZEMccUGqgiZOqru9tkR3iJ8nCcXRWRZCSPMLPEjlx2LjQL1OM5qKAm+vhSuRqSfV5Ttrg8FdWcrnhMqCTex7DEM6qTsVEuM1+8hovaHQ6e6a1Fz0xLd3nUt4ToWWuzWNkhcoAIIjUx2ZpxjLzWF9+SYmngR1lok4TEoJxGfuijhI/7OICoFmadl2llcL9b1oRVJtbD+JLlv1KrhHG5811t9ELbzgk14ICUwqE+TDzftqHPz98vUSy3jSIwP8dCpkNqLDPTx+rArz4T5qLG3G2PrvJKKPoLBWE501NC3ilUX5mVjVIb9nIbgWcpPMiSXjbcL8K62UkR86m1/yfkSeMaHFuK04X0CE3J6SWzFUxw0BSNHlSzi3RmIRJwHq5udO3c16quLp6sbnffbupxbt+12vzOrzuvNHc7ycRbIxuJHgYU7YSASdQgxp7qz2ynv6HJeqW91doa7nLruXof+17sqhhu31Xif9o7HalqczV29Dnrb/f5EXZvzdH27U98/6LR5i3N0UM5zjHU71/lwjRWWltU5CAIn7F1MqLp/r9hQ5RoaxG+qmrxP4yNKcfsFLwuiprffeb2l03m2scO5h3Or2rudzjGrhk8x4Cqu2xcexilBvNEcdi5Yu4tKF3Ue4tzPy+td5/1md4tzw5iJ27NuXEYobYUdlb8z6GTWkdxaCvk2zHjd5mpKQ459mv5TkAp6mQb9Aq9HHQ8S6mrZnuc6vUG6WHusIhCJGNXl9byvnJyaiE7+Eoz8c5TYNQiUveENGpJpcIJ+biS8R0+rlcazGNs7pKB+zPLTOSX2KNWhlDAf4r2Spj72JORB5OyHULX+dlD/FOky/HFy5ygYU0sey/i8moeqdunXK1qC3RuaMOYHlI/raQMl3M+EeTV5WxD3Km8a8PkM8nr648sQ9+esKbf5e/nxiKBfAOQkxbv3SU9LYmqPV9V/Pn+V20VwTyVjTqCI6edEQUOFUXs9WmfSll8DyX2dt7GlnwkswaM3l9XZ0oNK3MTXbxpOV2sGk69s6XCJw4cY8KbyRrt9TrHt7Bm0rRBQe1+fHUWNfaapU0KbqxzbORC1M/LS3dJwIl3KOrwykQG/E+61q+isgniztdOKqNOziDgZqZIzFwPvqGiyg5NCtoCqoG5NxHhPZTOsnORulKskjoKMDeLuXQ3OmnC3syxARFXdfc57LR3OrdtrvSOOs55rnqhtcdoGhpxHdjc5EfJUuHZTlftX+G15rXPlhkrnLe59F7Lz8VGHdg8c5y2OLeMZ126qduq9XC3v7nd+FchLvYPJd15gPCu8XQnh/qpm59WGVudZzvvQO97kXTcGxhnEuJvR39tWY8cwK4uhcikk4a3Gdstg9l5B2t0wfaTdWkEou5vCPOV5PH73vFL3+DfXltnh6OxjkJD6Wd5F3g88tMe6CW/7YmI99VIL4u0oqUK8ocW4d8hFrXMVoOQU8s3U97MnjvDD/XRYkyhHM1MT3GVZQR2Tdv70U8EbA5vlo+CaPAaaSWoZXm50otGodxQ6L6txGKxzw5ZYORrBsPPrykZKQIy1n8bTjwb2fO4Te3ue7x6KOKvaYns1wtIddd4nx3mwot55qyl2360cp81zurg+CGqwU8v4/Of5uAVvPgObrwvHomY8jOtZ4fXWLnefdHVXv9044+8ZklCx75DXwcV1Sb27y+vInUQEuVYSaMgRJYfAwtoj0raFxIUW1A8nz35f02qLc9Lc9lG7CBkwtUR7bf+A+5uL6ehnH9Lat+5sIEfj3Cbj3NKRvP7Rjlo7FSmqavKvpSP8MRZ7NVbQYLSkqlC9ZW4sPH18gBTcORjrhMWmQWzFmK2UsvO90qQ1oZcI8UhkCLZPtRqMy0NirobAvjIpb4/sW06qKGyPR2oGIdlazjOOTk+kLYzaaYGSp63Wz6HsXsQ51wd+LTAuZOy+8GBNq7tF+IOdDU4kENJthNID5YRafZtzZ3mDs9LbRgzixcZ2l1h83OKFbDmEd0/FiFp7DWHgp0AQGzq6nf8hPF+oa3EehOz0ziCWcm4NpBRMhX1hn571oR9wqVVSDVPtUi32sQ0vbu7scZdY9aOt2ZSEL9BEBIW+dv20AKDd9/ep09oimYqHpyImkKDuRllS4PrlHNuIqDmCJmNJQba7q1joEaUQJuR/WdXsLrJrq/L6cdJsPOyXscJ7GLKqo8cOpqhrO//yQG6oS3kZwS9xPkRB3wi7diFMtDN+PLk5m1ath+8f0Fy80dbjhvVXub+U5mEqeal27UP+dWpPlknNxW79Ak6/7Tg3UMOF52j1xA1qK7Trd6nXC+8P9ttYQcumIonLSnJtBdJNa77axw1C2x3qR4Wqnj73x9f6MbV+CCYFBZO6y51aSh3gzVrsmwzJnULEbCJC1oZ7vIZ/9Iqmfvn2u5oWO5n8fApxcuWUApum5diPgY9lrA9EtvUNOzYf8vqAcJPsU5iOh7XtXQgt2uZhjKU2amF7HQyfEYWcZk5yQ1RDKNrLcq02k/9IGmldrB93KiokPw8EB2SsoKWXO5FmxXhlckqi+3vEUvLqwok5PHVkIWAszlqzy1p54zuLpnPZ3q9bod08JlLSb5DrNxDm38Sbvsg5EBywsT7oH+3XNW3uasGirFSrxRNdCllKiPZHZzJYLZb5qEcpae3pxMCuu9oibS5/QCOiLcYUrp+MmtJeURjFdVlxzqiae6D4h40NQt54HyGv3JRo10aVfv8YhtC0pSlVKcPFuxIXahr08mzCO4VzMlLSsZuomZ+RaucU0rXsw/sfF5+osUFonWob/7TrLdaUgdpV93fl9X+VIC0Y6tek2uI8OD3J5gT2Vj9ZmP0f4IM4iY7RQ5gAAAAASUVORK5CYII=) no-repeat 50%;background-size:64px 64px;opacity:.84}.markdown-body h1:after{position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite}@keyframes h1Animate{0%{background-position:100% 100%}50%{background-position:100% 50%}to{background-position:100% 100%}}.markdown-body h2{display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0}.markdown-body h2:before{width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)}.markdown-body h2:after,.markdown-body h2:before{content:"";display:block;position:absolute;bottom:0}.markdown-body h2:after{right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw}.markdown-body h3{margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content}.markdown-body h3:before{border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate}@keyframes h3AnimationBefore{0%{width:28px}25%{width:100%}50%{width:100%}to{width:100%}}.markdown-body h3:after{content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate}@keyframes h3AnimationAfter{0%{transform:rotate(0)}10%{transform:rotate(0)}50%{transform:rotate(-1turn)}to{transform:rotate(-1turn)}}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px}.markdown-body img{max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)}.markdown-body figcaption{display:block;font-size:13px;color:#2b2b2b}.markdown-body figcaption:before{content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px}.markdown-body hr{border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px}.markdown-body del{color:#4dd0e1}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em}.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px}.markdown-body a:active,.markdown-body a:hover{background-color:rgba(77,208,225,.1)}.markdown-body strong{color:#26c6da}.markdown-body strong:before{content:"ã€Œ"}.markdown-body strong:after{content:"ã€"}.markdown-body em{font-style:normal;color:#4dd0e1;font-weight:700}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(77,208,225,.05)}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative}.markdown-body blockquote:before{content:"â";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7}.markdown-body blockquote:after{content:"â";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7}.markdown-body blockquote p{color:#595959;line-height:2}.markdown-body ol,.markdown-body ul{color:#595959;padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>æ‘˜è¦</strong>ï¼šæ­£åˆ™è¡¨è¾¾å¼ï¼Œå·ç§°"ç¨‹åºå‘˜çš„ç‘å£«å†›åˆ€"ï¼Œå®é™…ä¸Šæ˜¯"æ¯æ¬¡ç”¨éƒ½è¦é‡æ–°å­¦ä¸€éçš„é»‘é­”æ³•"ã€‚<code>/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$/</code> è¿™ä¸²å¤©ä¹¦ï¼Œæ˜¯å¯†ç éªŒè¯è¿˜æ˜¯å¬å”¤æ¶é­”çš„å’’è¯­ï¼Ÿæœ¬æ–‡ä¸æ˜¯æ­£åˆ™æ•™ç¨‹ï¼Œè€Œæ˜¯ä¸€ä»½"è¸©å‘æŒ‡å—"ã€‚æ¯ä¸ªé™·é˜±éƒ½æœ‰ä»£ç ï¼Œæ¯ä¸ªå‘éƒ½èƒ½å¤ç°ã€‚æ–‡æœ«é™„é€ã€Šæ­£åˆ™è¡¨è¾¾å¼é€ŸæŸ¥è¡¨ã€‹å’Œã€Šä¸ºä»€ä¹ˆä¸è¦ç”¨æ­£åˆ™è§£æHTMLã€‹ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-0">ä¸€ä¸ª"ç®€å•"çš„éœ€æ±‚</h2>
<p>äº§å“ç»ç†ï¼š"åŠ ä¸ªæ‰‹æœºå·éªŒè¯ï¼Œå¾ˆç®€å•çš„ã€‚"</p>
<p><strong>ä½ å¿ƒæƒ³ï¼šå°caseï¼Œå†™ä¸ªæ­£åˆ™ã€‚</strong></p>
<p><strong>5åˆ†é’Ÿåï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> phoneRegex = <span class="hljs-regexp">/\d{11}/</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(phoneRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"13812345678"</span>)) <span class="hljs-comment">// true âœ“</span>
</code></pre>
<p><strong>äº§å“ç»ç†ï¼š"ä¸å¯¹ï¼Œè¦éªŒè¯æ˜¯ä¸æ˜¯çœŸçš„æ‰‹æœºå·ã€‚"</strong></p>
<p><strong>10åˆ†é’Ÿåï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> phoneRegex = <span class="hljs-regexp">/^1[3-9]\d{9}$/</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(phoneRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"13812345678"</span>)) <span class="hljs-comment">// true âœ“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(phoneRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"19912345678"</span>)) <span class="hljs-comment">// true âœ“</span>
</code></pre>
<p><strong>äº§å“ç»ç†ï¼š"è¦æ”¯æŒ+86å’Œç©ºæ ¼ã€‚"</strong></p>
<p><strong>20åˆ†é’Ÿåï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> phoneRegex = <span class="hljs-regexp">/^(\+86)?1[3-9]\d{9}$/</span>
<span class="hljs-comment">// âŒ ä¸æ”¯æŒç©ºæ ¼</span>
</code></pre>
<p><strong>30åˆ†é’Ÿåï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> phoneRegex = <span class="hljs-regexp">/^(\+86)?[\s-]?1[3-9]\d{9}$/</span>
<span class="hljs-comment">// âŒ è¿˜æ˜¯ä¸å¯¹</span>
</code></pre>
<p><strong>1å°æ—¶åï¼Œä½ åœ¨ Stack Overflow ä¸Šæœç´¢ï¼š"regex phone number china"</strong></p>
<p><strong>çœ‹åˆ° 20 ç§ä¸åŒçš„ç­”æ¡ˆï¼Œæ¯ä¸ªéƒ½è¯´è‡ªå·±æ˜¯"æœ€å®Œæ•´çš„"ã€‚</strong></p>
<p><strong>ä½ å´©æºƒäº†ã€‚</strong></p>
<hr/>
<h2 data-id="heading-1">01. è´ªå©ªåŒ¹é… vs éè´ªå©ªåŒ¹é…ï¼šæ­£åˆ™çš„"è´ªåƒè›‡"</h2>
<h3 data-id="heading-2">åœºæ™¯å¤ç°</h3>
<p>ä½ æƒ³æå– HTML æ ‡ç­¾ä¸­çš„å†…å®¹ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> html = <span class="hljs-string">"&lt;div&gt;Hello&lt;/div&gt;&lt;div&gt;World&lt;/div&gt;"</span>
<span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/&lt;div&gt;.*&lt;\/div&gt;/</span>
<span class="hljs-keyword">const</span> match = html.<span class="hljs-title function_">match</span>(regex)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match[<span class="hljs-number">0</span>])
</code></pre>
<p><strong>ä½ ä»¥ä¸ºä¼šè¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span>&gt;Hello&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<p><strong>å®é™…è¾“å‡ºï¼š</strong></p>
<pre><code class="hljs language-css" lang="css">&lt;<span class="hljs-selector-tag">div</span>&gt;Hello&lt;/<span class="hljs-selector-tag">div</span>&gt;&lt;<span class="hljs-selector-tag">div</span>&gt;World&lt;/<span class="hljs-selector-tag">div</span>&gt;
</code></pre>
<p><strong>WTFï¼Ÿ</strong></p>
<h3 data-id="heading-3">ä¸ºä»€ä¹ˆï¼Ÿ</h3>
<p><code>.*</code> æ˜¯<strong>è´ªå©ªåŒ¹é…</strong>ï¼ˆGreedyï¼‰ï¼Œä¼šå°½å¯èƒ½å¤šåœ°åŒ¹é…å­—ç¬¦ã€‚</p>
<p><strong>åŒ¹é…è¿‡ç¨‹ï¼š</strong></p>
<ol>
<li><code>&lt;div&gt;</code> åŒ¹é…æˆåŠŸ</li>
<li><code>.*</code> å¼€å§‹åŒ¹é…ï¼Œä¸€ç›´åƒåˆ°å­—ç¬¦ä¸²æœ«å°¾</li>
<li><code>&lt;\/div&gt;</code> åŒ¹é…å¤±è´¥</li>
<li><code>.*</code> å›é€€ä¸€ä¸ªå­—ç¬¦ï¼Œå†å°è¯•</li>
<li>é‡å¤æ­¥éª¤ 3-4ï¼Œç›´åˆ°æ‰¾åˆ°æœ€åä¸€ä¸ª <code>&lt;/div&gt;</code></li>
</ol>
<h3 data-id="heading-4">è§£å†³æ–¹æ¡ˆï¼šéè´ªå©ªåŒ¹é…</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/&lt;div&gt;.*?&lt;\/div&gt;/</span> <span class="hljs-comment">// åŠ ä¸ª ?</span>
<span class="hljs-keyword">const</span> match = html.<span class="hljs-title function_">match</span>(regex)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match[<span class="hljs-number">0</span>]) <span class="hljs-comment">// &lt;div&gt;Hello&lt;/div&gt; âœ“</span>
</code></pre>
<p><strong>ä½†æ˜¯ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> html = <span class="hljs-string">"&lt;div&gt;Hello&lt;/div&gt;&lt;div&gt;World&lt;/div&gt;"</span>
<span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/&lt;div&gt;.*?&lt;\/div&gt;/g</span> <span class="hljs-comment">// å…¨å±€åŒ¹é…</span>
<span class="hljs-keyword">const</span> matches = html.<span class="hljs-title function_">match</span>(regex)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(matches)
<span class="hljs-comment">// ['&lt;div&gt;Hello&lt;/div&gt;', '&lt;div&gt;World&lt;/div&gt;'] âœ“</span>
</code></pre>
<h3 data-id="heading-5">è´ªå©ª vs éè´ªå©ªå¯¹æ¯”</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> text = <span class="hljs-string">"aaa"</span>

<span class="hljs-comment">// è´ªå©ªåŒ¹é…</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/a+/</span>)[<span class="hljs-number">0</span>]) <span class="hljs-comment">// "aaa"ï¼ˆå°½å¯èƒ½å¤šï¼‰</span>

<span class="hljs-comment">// éè´ªå©ªåŒ¹é…</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text.<span class="hljs-title function_">match</span>(<span class="hljs-regexp">/a+?/</span>)[<span class="hljs-number">0</span>]) <span class="hljs-comment">// "a"ï¼ˆå°½å¯èƒ½å°‘ï¼‰</span>
</code></pre>
<p><strong>å¸¸è§çš„è´ªå©ªé‡è¯ï¼š</strong></p>
<ul>
<li><code>*</code>ï¼š0 æ¬¡æˆ–å¤šæ¬¡ï¼ˆè´ªå©ªï¼‰</li>
<li><code>+</code>ï¼š1 æ¬¡æˆ–å¤šæ¬¡ï¼ˆè´ªå©ªï¼‰</li>
<li><code>?</code>ï¼š0 æ¬¡æˆ– 1 æ¬¡ï¼ˆè´ªå©ªï¼‰</li>
<li><code>{n,m}</code>ï¼šn åˆ° m æ¬¡ï¼ˆè´ªå©ªï¼‰</li>
</ul>
<p><strong>å¯¹åº”çš„éè´ªå©ªé‡è¯ï¼š</strong></p>
<ul>
<li><code>*?</code>ï¼š0 æ¬¡æˆ–å¤šæ¬¡ï¼ˆéè´ªå©ªï¼‰</li>
<li><code>+?</code>ï¼š1 æ¬¡æˆ–å¤šæ¬¡ï¼ˆéè´ªå©ªï¼‰</li>
<li><code>??</code>ï¼š0 æ¬¡æˆ– 1 æ¬¡ï¼ˆéè´ªå©ªï¼‰</li>
<li><code>{n,m}?</code>ï¼šn åˆ° m æ¬¡ï¼ˆéè´ªå©ªï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-6">02. å›æº¯ç¾éš¾ï¼šè®©ä½ çš„æœåŠ¡å™¨å®•æœºçš„æ­£åˆ™</h2>
<h3 data-id="heading-7">åœºæ™¯å¤ç°</h3>
<p>ä½ å†™äº†ä¸€ä¸ª"ç®€å•"çš„æ­£åˆ™æ¥éªŒè¯é‚®ç®±ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> emailRegex = <span class="hljs-regexp">/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/</span>

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(emailRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"test@example.com"</span>)) <span class="hljs-comment">// true âœ“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(emailRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"user@domain.co.uk"</span>)) <span class="hljs-comment">// true âœ“</span>
</code></pre>
<p><strong>çœ‹èµ·æ¥æ²¡é—®é¢˜ã€‚</strong></p>
<p><strong>ä½†æ˜¯ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> maliciousInput = <span class="hljs-string">"a"</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-number">50</span>) + <span class="hljs-string">"@example.com"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">time</span>(<span class="hljs-string">"test"</span>)
emailRegex.<span class="hljs-title function_">test</span>(maliciousInput)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">timeEnd</span>(<span class="hljs-string">"test"</span>)
<span class="hljs-comment">// test: 15000msï¼ˆ15ç§’ï¼ï¼‰</span>
</code></pre>
<p><strong>ä½ çš„æœåŠ¡å™¨å¡æ­»äº†ã€‚</strong></p>
<h3 data-id="heading-8">ä¸ºä»€ä¹ˆï¼Ÿ</h3>
<p>è¿™å«<strong>ç¾éš¾æ€§å›æº¯</strong>ï¼ˆCatastrophic Backtrackingï¼‰ã€‚</p>
<p><strong>é—®é¢˜åœ¨äºï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript">;<span class="hljs-regexp">/^([a-z0-9_\.-]+)@/</span>
<span class="hljs-comment">//        â†‘ è¿™ä¸ª + æ˜¯è´ªå©ªçš„</span>
</code></pre>
<p><strong>å½“è¾“å…¥æ˜¯ <code>aaaaaaa...</code> æ—¶ï¼š</strong></p>
<ol>
<li><code>[a-z0-9_\.-]+</code> åŒ¹é…æ‰€æœ‰çš„ <code>a</code></li>
<li>å°è¯•åŒ¹é… <code>@</code>ï¼Œå¤±è´¥</li>
<li>å›é€€ä¸€ä¸ª <code>a</code>ï¼Œå†å°è¯•</li>
<li>é‡å¤æ­¥éª¤ 2-3ï¼ŒæŒ‡æ•°çº§å¢é•¿</li>
</ol>
<p><strong>æ—¶é—´å¤æ‚åº¦ï¼šO(2^n)</strong></p>
<h3 data-id="heading-9">è§£å†³æ–¹æ¡ˆ</h3>
<p><strong>æ–¹æ¡ˆ1ï¼šä½¿ç”¨éè´ªå©ªåŒ¹é…</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> emailRegex = <span class="hljs-regexp">/^([a-z0-9_\.-]+?)@([\da-z\.-]+?)\.([a-z\.]{2,6})$/</span>
</code></pre>
<p><strong>æ–¹æ¡ˆ2ï¼šä½¿ç”¨åŸå­ç»„ï¼ˆAtomic Groupï¼‰</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// JavaScript ä¸æ”¯æŒåŸå­ç»„</span>
<span class="hljs-comment">// ä½†å¯ä»¥ç”¨å…¶ä»–è¯­è¨€ï¼ˆå¦‚ PHPã€.NETï¼‰</span>
<span class="hljs-keyword">const</span> emailRegex = <span class="hljs-regexp">/^(?&gt;([a-z0-9_\.-]+))@/</span>
</code></pre>
<p><strong>æ–¹æ¡ˆ3ï¼šé¿å…åµŒå¥—é‡è¯</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ å±é™©ï¼šåµŒå¥—é‡è¯</span>
/^(a+)+$/

<span class="hljs-comment">// âœ… å®‰å…¨ï¼šä¸åµŒå¥—</span>
<span class="hljs-regexp">/^a+$/</span>
</code></pre>
<p><strong>æ–¹æ¡ˆ4ï¼šè®¾ç½®è¶…æ—¶</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Node.js æ²¡æœ‰å†…ç½®çš„æ­£åˆ™è¶…æ—¶</span>
<span class="hljs-comment">// å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“</span>
<span class="hljs-keyword">const</span> safeRegex = <span class="hljs-built_in">require</span>(<span class="hljs-string">"safe-regex"</span>)

<span class="hljs-keyword">if</span> (!<span class="hljs-title function_">safeRegex</span>(<span class="hljs-regexp">/^([a-z0-9_\.-]+)@/</span>)) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Unsafe regex!"</span>)
}
</code></pre>
<h3 data-id="heading-10">çœŸå®æ¡ˆä¾‹</h3>
<p><strong>2019å¹´ï¼ŒCloudflare å…¨çƒå®•æœºï¼š</strong></p>
<p>åŸå› ï¼šä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¼è‡´ CPU 100%</p>
<pre><code class="hljs language-ruby" lang="ruby">(<span class="hljs-string">?:</span>(<span class="hljs-string">?:\"</span>|<span class="hljs-params">'</span>|\]|<span class="hljs-params">\}</span>|\\|<span class="hljs-params">\d</span>|(<span class="hljs-string">?:</span>nan|<span class="hljs-params">infinity</span>|<span class="hljs-literal">true</span>|<span class="hljs-params"><span class="hljs-literal">false</span></span>|null|<span class="hljs-params">undefined</span>|symbol|<span class="hljs-params">math)</span>|\<span class="hljs-string">`|\-|\+)+[)]*;?((?:\s|-|~|!|{}|\|\||\+)*.*(?:.*=.*)))
</span></code></pre>
<p><strong>è¿™ä¸ªæ­£åˆ™æœ‰ 20+ ä¸ªåµŒå¥—é‡è¯ï¼Œå¯¼è‡´ç¾éš¾æ€§å›æº¯ã€‚</strong></p>
<hr/>
<h2 data-id="heading-11">03. é›¶å®½æ–­è¨€ï¼šçœ‹ä¸è§çš„"å¹½çµ"</h2>
<h3 data-id="heading-12">ä»€ä¹ˆæ˜¯é›¶å®½æ–­è¨€ï¼Ÿ</h3>
<p><strong>é›¶å®½æ–­è¨€</strong>ï¼ˆZero-Width Assertionï¼‰ä¸åŒ¹é…ä»»ä½•å­—ç¬¦ï¼ŒåªåŒ¹é…ä½ç½®ã€‚</p>
<p><strong>å››ç§é›¶å®½æ–­è¨€ï¼š</strong></p>
<ol>
<li><code>(?=...)</code>ï¼šæ­£å‘å…ˆè¡Œæ–­è¨€ï¼ˆPositive Lookaheadï¼‰</li>
<li><code>(?!...)</code>ï¼šè´Ÿå‘å…ˆè¡Œæ–­è¨€ï¼ˆNegative Lookaheadï¼‰</li>
<li><code>(?&lt;=...)</code>ï¼šæ­£å‘åè¡Œæ–­è¨€ï¼ˆPositive Lookbehindï¼‰</li>
<li><code>(?&lt;!...)</code>ï¼šè´Ÿå‘åè¡Œæ–­è¨€ï¼ˆNegative Lookbehindï¼‰</li>
</ol>
<h3 data-id="heading-13">åœºæ™¯1ï¼šå¯†ç éªŒè¯</h3>
<p>**éœ€æ±‚ï¼š**å¯†ç å¿…é¡»åŒ…å«å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€æ•°å­—ï¼Œè‡³å°‘8ä½</p>
<p><strong>é”™è¯¯çš„åšæ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ è¿™åªæ£€æŸ¥æ˜¯å¦æœ‰è¿™äº›å­—ç¬¦ï¼Œä¸æ£€æŸ¥æ˜¯å¦éƒ½æœ‰</span>
<span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/^[A-Za-z0-9]{8,}$/</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(regex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"12345678"</span>)) <span class="hljs-comment">// trueï¼ˆä½†æ²¡æœ‰å­—æ¯ï¼‰</span>
</code></pre>
<p><strong>æ­£ç¡®çš„åšæ³•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$/</span>

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(regex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"Password1"</span>)) <span class="hljs-comment">// true âœ“</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(regex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"password1"</span>)) <span class="hljs-comment">// falseï¼ˆæ²¡æœ‰å¤§å†™ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(regex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"PASSWORD1"</span>)) <span class="hljs-comment">// falseï¼ˆæ²¡æœ‰å°å†™ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(regex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"Password"</span>)) <span class="hljs-comment">// falseï¼ˆæ²¡æœ‰æ•°å­—ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(regex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"Pass1"</span>)) <span class="hljs-comment">// falseï¼ˆå°‘äº8ä½ï¼‰</span>
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<pre><code class="hljs language-ruby" lang="ruby">^              å¼€å§‹
(<span class="hljs-string">?=</span>.*[A-Z])    å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªå¤§å†™å­—æ¯ï¼ˆå…ˆè¡Œæ–­è¨€ï¼‰
(<span class="hljs-string">?=</span>.*[a-z])    å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªå°å†™å­—æ¯ï¼ˆå…ˆè¡Œæ–­è¨€ï¼‰
(<span class="hljs-string">?=</span>.*\d)       å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªæ•°å­—ï¼ˆå…ˆè¡Œæ–­è¨€ï¼‰
.{<span class="hljs-number">8</span>,}          è‡³å°‘<span class="hljs-number">8</span>ä¸ªä»»æ„å­—ç¬¦
<span class="hljs-variable">$ </span>             ç»“æŸ
</code></pre>
<h3 data-id="heading-14">åœºæ™¯2ï¼šæå–ä»·æ ¼ï¼ˆä¸åŒ…å«è´§å¸ç¬¦å·ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> text = <span class="hljs-string">"Price: $99.99"</span>

<span class="hljs-comment">// âŒ åŒ…å«äº† $</span>
<span class="hljs-keyword">const</span> regex1 = <span class="hljs-regexp">/\$\d+\.\d+/</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text.<span class="hljs-title function_">match</span>(regex1)[<span class="hljs-number">0</span>]) <span class="hljs-comment">// "$99.99"</span>

<span class="hljs-comment">// âœ… ä¸åŒ…å« $</span>
<span class="hljs-keyword">const</span> regex2 = <span class="hljs-regexp">/(?&lt;=\$)\d+\.\d+/</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text.<span class="hljs-title function_">match</span>(regex2)[<span class="hljs-number">0</span>]) <span class="hljs-comment">// "99.99"</span>
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<pre><code class="hljs language-ruby" lang="ruby">(<span class="hljs-string">?&lt;</span>=\<span class="hljs-variable">$)</span>    æ­£å‘åè¡Œæ–­è¨€ï¼šå‰é¢å¿…é¡»æ˜¯ <span class="hljs-variable">$ï¼Œ</span>ä½†ä¸æ•è· <span class="hljs-variable">$
</span>\d+\.\d+   åŒ¹é…æ•°å­—
</code></pre>
<h3 data-id="heading-15">åœºæ™¯3ï¼šåƒä½åˆ†éš”ç¬¦</h3>
<p>**éœ€æ±‚ï¼š**ç»™æ•°å­—åŠ åƒä½åˆ†éš”ç¬¦</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> num = <span class="hljs-string">"1234567890"</span>

<span class="hljs-comment">// ä½¿ç”¨æ­£å‘å…ˆè¡Œæ–­è¨€</span>
<span class="hljs-keyword">const</span> formatted = num.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\B(?=(\d{3})+(?!\d))/g</span>, <span class="hljs-string">","</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(formatted) <span class="hljs-comment">// "1,234,567,890"</span>
</code></pre>
<p><strong>è§£é‡Šï¼š</strong></p>
<pre><code class="hljs language-ruby" lang="ruby">\B                  éå•è¯è¾¹ç•Œï¼ˆä¸åœ¨å¼€å¤´ï¼‰
(<span class="hljs-string">?=</span>(\d{<span class="hljs-number">3</span>})+(<span class="hljs-string">?!\d</span>))  åé¢æ˜¯<span class="hljs-number">3</span>çš„å€æ•°ä¸ªæ•°å­—ï¼Œä¸”åé¢ä¸å†æœ‰æ•°å­—
</code></pre>
<p><strong>æµ‹è¯•ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"123"</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\B(?=(\d{3})+(?!\d))/g</span>, <span class="hljs-string">","</span>)) <span class="hljs-comment">// "123"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1234"</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\B(?=(\d{3})+(?!\d))/g</span>, <span class="hljs-string">","</span>)) <span class="hljs-comment">// "1,234"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"12345"</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\B(?=(\d{3})+(?!\d))/g</span>, <span class="hljs-string">","</span>)) <span class="hljs-comment">// "12,345"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"123456"</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\B(?=(\d{3})+(?!\d))/g</span>, <span class="hljs-string">","</span>)) <span class="hljs-comment">// "123,456"</span>
</code></pre>
<hr/>
<h2 data-id="heading-16">04. æ•è·ç»„ vs éæ•è·ç»„ï¼šæ‹¬å·çš„ç§˜å¯†</h2>
<h3 data-id="heading-17">æ•è·ç»„</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> text = <span class="hljs-string">"2026-01-20"</span>
<span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/(\d{4})-(\d{2})-(\d{2})/</span>
<span class="hljs-keyword">const</span> match = text.<span class="hljs-title function_">match</span>(regex)

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match[<span class="hljs-number">0</span>]) <span class="hljs-comment">// "2026-01-20"ï¼ˆå®Œæ•´åŒ¹é…ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match[<span class="hljs-number">1</span>]) <span class="hljs-comment">// "2026"ï¼ˆç¬¬1ä¸ªæ•è·ç»„ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match[<span class="hljs-number">2</span>]) <span class="hljs-comment">// "01"ï¼ˆç¬¬2ä¸ªæ•è·ç»„ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match[<span class="hljs-number">3</span>]) <span class="hljs-comment">// "20"ï¼ˆç¬¬3ä¸ªæ•è·ç»„ï¼‰</span>
</code></pre>
<h3 data-id="heading-18">éæ•è·ç»„</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> text = <span class="hljs-string">"2026-01-20"</span>
<span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/(?:\d{4})-(?:\d{2})-(?:\d{2})/</span>
<span class="hljs-keyword">const</span> match = text.<span class="hljs-title function_">match</span>(regex)

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match[<span class="hljs-number">0</span>]) <span class="hljs-comment">// "2026-01-20"ï¼ˆå®Œæ•´åŒ¹é…ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match[<span class="hljs-number">1</span>]) <span class="hljs-comment">// undefinedï¼ˆæ²¡æœ‰æ•è·ç»„ï¼‰</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦ç”¨éæ•è·ç»„ï¼Ÿ</strong></p>
<ol>
<li><strong>æ€§èƒ½æ›´å¥½</strong>ï¼šä¸éœ€è¦ä¿å­˜æ•è·çš„å†…å®¹</li>
<li><strong>é¿å…æ··æ·†</strong>ï¼šä¸ä¼šå½±å“æ•è·ç»„çš„ç¼–å·</li>
</ol>
<h3 data-id="heading-19">å‘½åæ•è·ç»„ï¼ˆES2018ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> text = <span class="hljs-string">"2026-01-20"</span>
<span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/(?&lt;year&gt;\d{4})-(?&lt;month&gt;\d{2})-(?&lt;day&gt;\d{2})/</span>
<span class="hljs-keyword">const</span> match = text.<span class="hljs-title function_">match</span>(regex)

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match.<span class="hljs-property">groups</span>.<span class="hljs-property">year</span>) <span class="hljs-comment">// "2026"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match.<span class="hljs-property">groups</span>.<span class="hljs-property">month</span>) <span class="hljs-comment">// "01"</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(match.<span class="hljs-property">groups</span>.<span class="hljs-property">day</span>) <span class="hljs-comment">// "20"</span>
</code></pre>
<p><strong>åœ¨æ›¿æ¢ä¸­ä½¿ç”¨ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> text = <span class="hljs-string">"2026-01-20"</span>
<span class="hljs-keyword">const</span> formatted = text.<span class="hljs-title function_">replace</span>(
  <span class="hljs-regexp">/(?&lt;year&gt;\d{4})-(?&lt;month&gt;\d{2})-(?&lt;day&gt;\d{2})/</span>,
  <span class="hljs-string">"$&lt;month&gt;/$&lt;day&gt;/$&lt;year&gt;"</span>,
)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(formatted) <span class="hljs-comment">// "01/20/2026"</span>
</code></pre>
<hr/>
<h2 data-id="heading-20">05. å¸¸è§åœºæ™¯çš„æ­£åˆ™è¡¨è¾¾å¼</h2>
<h3 data-id="heading-21">é‚®ç®±éªŒè¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ è¿‡äºç®€å•</span>
/^.+@.+\..+$/

<span class="hljs-comment">// âŒ è¿‡äºå¤æ‚ï¼ˆRFC 5322 å®Œæ•´ç‰ˆï¼Œ6000+ å­—ç¬¦ï¼‰</span>
<span class="hljs-comment">// ä¸è¦å°è¯•å®Œå…¨ç¬¦åˆ RFC æ ‡å‡†</span>

<span class="hljs-comment">// âœ… å®ç”¨ç‰ˆæœ¬</span>
<span class="hljs-regexp">/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/</span>

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> emailRegex = <span class="hljs-regexp">/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(emailRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"user@example.com"</span>));     <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(emailRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"user.name@example.com"</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(emailRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"user@example.co.uk"</span>));   <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(emailRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"user@example"</span>));         <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(emailRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"@example.com"</span>));         <span class="hljs-comment">// false</span>
</code></pre>
<h3 data-id="heading-22">æ‰‹æœºå·éªŒè¯ï¼ˆä¸­å›½ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åŸºç¡€ç‰ˆæœ¬</span>
/^<span class="hljs-number">1</span>[<span class="hljs-number">3</span>-<span class="hljs-number">9</span>]\d{<span class="hljs-number">9</span>}$/

<span class="hljs-comment">// æ”¯æŒ +86 å’Œç©ºæ ¼</span>
<span class="hljs-regexp">/^(\+86)?[\s-]?1[3-9]\d{9}$/</span>

<span class="hljs-comment">// æ›´ä¸¥æ ¼çš„ç‰ˆæœ¬ï¼ˆåŒºåˆ†è¿è¥å•†ï¼‰</span>
<span class="hljs-regexp">/^1(3\d|4[5-9]|5[0-35-9]|6[2567]|7[0-8]|8\d|9[0-35-9])\d{8}$/</span>

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> phoneRegex = <span class="hljs-regexp">/^1[3-9]\d{9}$/</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(phoneRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"13812345678"</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(phoneRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"19912345678"</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(phoneRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"12812345678"</span>)); <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(phoneRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"138123456"</span>));   <span class="hljs-comment">// false</span>
</code></pre>
<h3 data-id="heading-23">URL éªŒè¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç®€å•ç‰ˆæœ¬</span>
/^https?:\/\/.+/

<span class="hljs-comment">// æ›´ä¸¥æ ¼çš„ç‰ˆæœ¬</span>
<span class="hljs-regexp">/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&amp;//=]*)$/</span>

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> urlRegex = <span class="hljs-regexp">/^https?:\/\/.+/</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(urlRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"https://example.com"</span>));       <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(urlRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"http://example.com/path"</span>));   <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(urlRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"ftp://example.com"</span>));         <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(urlRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"example.com"</span>));               <span class="hljs-comment">// false</span>
</code></pre>
<h3 data-id="heading-24">èº«ä»½è¯å·éªŒè¯ï¼ˆä¸­å›½ï¼‰</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// 18ä½èº«ä»½è¯å·</span>
;<span class="hljs-regexp">/^[1-9]\d{5}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/</span>

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> idRegex =
  <span class="hljs-regexp">/^[1-9]\d{5}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(idRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"110101199001011234"</span>)) <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(idRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"110101199013011234"</span>)) <span class="hljs-comment">// falseï¼ˆæœˆä»½é”™è¯¯ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(idRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"110101199001321234"</span>)) <span class="hljs-comment">// falseï¼ˆæ—¥æœŸé”™è¯¯ï¼‰</span>
</code></pre>
<h3 data-id="heading-25">å¯†ç å¼ºåº¦éªŒè¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è‡³å°‘8ä½ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦</span>
;<span class="hljs-regexp">/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&amp;])[A-Za-z\d@$!%*?&amp;]{8,}$/</span>

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> passwordRegex =
  <span class="hljs-regexp">/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&amp;])[A-Za-z\d@$!%*?&amp;]{8,}$/</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(passwordRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"Password1!"</span>)) <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(passwordRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"password1!"</span>)) <span class="hljs-comment">// falseï¼ˆæ²¡æœ‰å¤§å†™ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(passwordRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"PASSWORD1!"</span>)) <span class="hljs-comment">// falseï¼ˆæ²¡æœ‰å°å†™ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(passwordRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"Password!"</span>)) <span class="hljs-comment">// falseï¼ˆæ²¡æœ‰æ•°å­—ï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(passwordRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"Password1"</span>)) <span class="hljs-comment">// falseï¼ˆæ²¡æœ‰ç‰¹æ®Šå­—ç¬¦ï¼‰</span>
</code></pre>
<h3 data-id="heading-26">IP åœ°å€éªŒè¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// IPv4</span>
;<span class="hljs-regexp">/^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span>

<span class="hljs-comment">// æµ‹è¯•</span>
<span class="hljs-keyword">const</span> ipRegex =
  <span class="hljs-regexp">/^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ipRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"192.168.1.1"</span>)) <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ipRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"255.255.255.255"</span>)) <span class="hljs-comment">// true</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ipRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"256.1.1.1"</span>)) <span class="hljs-comment">// false</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(ipRegex.<span class="hljs-title function_">test</span>(<span class="hljs-string">"192.168.1"</span>)) <span class="hljs-comment">// false</span>
</code></pre>
<hr/>
<h2 data-id="heading-27">06. ä¸ºä»€ä¹ˆä¸è¦ç”¨æ­£åˆ™è§£æ HTML</h2>
<h3 data-id="heading-28">ç»å…¸é—®é¢˜</h3>
<p><strong>Stack Overflow ä¸Šæœ€è‘—åçš„å›ç­”ä¹‹ä¸€ï¼š</strong></p>
<blockquote>
<p>**é—®ï¼š**å¦‚ä½•ç”¨æ­£åˆ™è¡¨è¾¾å¼è§£æ HTMLï¼Ÿ</p>
<p>**ç­”ï¼š**ä½ ä¸èƒ½ã€‚HTML ä¸æ˜¯æ­£åˆ™è¯­è¨€ã€‚</p>
</blockquote>
<p><strong>ä¸ºä»€ä¹ˆï¼Ÿ</strong></p>
<p>HTML æ˜¯<strong>ä¸Šä¸‹æ–‡æ— å…³æ–‡æ³•</strong>ï¼ˆContext-Free Grammarï¼‰ï¼Œè€Œæ­£åˆ™è¡¨è¾¾å¼åªèƒ½å¤„ç†<strong>æ­£åˆ™æ–‡æ³•</strong>ï¼ˆRegular Grammarï¼‰ã€‚</p>
<h3 data-id="heading-29">å°è¯•ç”¨æ­£åˆ™è§£æ HTML</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å°è¯•æå–æ‰€æœ‰ &lt;a&gt; æ ‡ç­¾çš„ href</span>
<span class="hljs-keyword">const</span> html = <span class="hljs-string">`
  &lt;a href="https://example.com"&gt;Link 1&lt;/a&gt;
  &lt;a href='https://example.org'&gt;Link 2&lt;/a&gt;
  &lt;a href="https://example.net" target="_blank"&gt;Link 3&lt;/a&gt;
  &lt;a href="https://example.com/path?query=value&amp;other=123"&gt;Link 4&lt;/a&gt;
`</span>

<span class="hljs-comment">// âŒ ç®€å•çš„æ­£åˆ™</span>
<span class="hljs-keyword">const</span> regex1 = <span class="hljs-regexp">/&lt;a href="(.+)"&gt;/g</span>
<span class="hljs-keyword">const</span> matches1 = [...html.<span class="hljs-title function_">matchAll</span>(regex1)]
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(matches1.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">m</span>) =&gt;</span> m[<span class="hljs-number">1</span>]))
<span class="hljs-comment">// ["https://example.com", "https://example.net" target="_blank"]</span>
<span class="hljs-comment">// âŒ é”™è¯¯ï¼ç¬¬äºŒä¸ªåŒ¹é…åŒ…å«äº†é¢å¤–çš„å±æ€§</span>
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ol>
<li>å±æ€§å¯ä»¥ç”¨å•å¼•å·æˆ–åŒå¼•å·</li>
<li>å±æ€§ä¹‹é—´å¯ä»¥æœ‰ç©ºæ ¼</li>
<li>å±æ€§é¡ºåºå¯ä»¥å˜åŒ–</li>
<li>æ ‡ç­¾å¯ä»¥åµŒå¥—</li>
<li>æ ‡ç­¾å¯ä»¥è·¨è¡Œ</li>
</ol>
<h3 data-id="heading-30">æ­£ç¡®çš„åšæ³•ï¼šä½¿ç”¨ DOM Parser</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… ä½¿ç”¨ DOMParserï¼ˆæµè§ˆå™¨ï¼‰</span>
<span class="hljs-keyword">const</span> parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMParser</span>()
<span class="hljs-keyword">const</span> doc = parser.<span class="hljs-title function_">parseFromString</span>(html, <span class="hljs-string">"text/html"</span>)
<span class="hljs-keyword">const</span> links = doc.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">"a"</span>)
<span class="hljs-keyword">const</span> hrefs = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(links).<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">link</span>) =&gt;</span> link.<span class="hljs-property">href</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(hrefs)
<span class="hljs-comment">// ["https://example.com", "https://example.org", "https://example.net", ...]</span>

<span class="hljs-comment">// âœ… ä½¿ç”¨ cheerioï¼ˆNode.jsï¼‰</span>
<span class="hljs-keyword">const</span> cheerio = <span class="hljs-built_in">require</span>(<span class="hljs-string">"cheerio"</span>)
<span class="hljs-keyword">const</span> $ = cheerio.<span class="hljs-title function_">load</span>(html)
<span class="hljs-keyword">const</span> hrefs = $(<span class="hljs-string">"a"</span>)
  .<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">i, el</span>) =&gt;</span> $(el).<span class="hljs-title function_">attr</span>(<span class="hljs-string">"href"</span>))
  .<span class="hljs-title function_">get</span>()
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(hrefs)
</code></pre>
<h3 data-id="heading-31">å”¯ä¸€çš„ä¾‹å¤–</h3>
<p><strong>å¦‚æœä½ åªæ˜¯æƒ³åšç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç§»é™¤æ‰€æœ‰ HTML æ ‡ç­¾</span>
<span class="hljs-keyword">const</span> text = html.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;[^&gt;]+&gt;/g</span>, <span class="hljs-string">""</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text)
<span class="hljs-comment">// "Link 1 Link 2 Link 3 Link 4"</span>
</code></pre>
<p><strong>ä½†å³ä½¿è¿™æ ·ä¹Ÿæœ‰é—®é¢˜ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> html = <span class="hljs-string">"&lt;div&gt;Price: 5 &lt; 10&lt;/div&gt;"</span>
<span class="hljs-keyword">const</span> text = html.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/&lt;[^&gt;]+&gt;/g</span>, <span class="hljs-string">""</span>)
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text)
<span class="hljs-comment">// "Price: 5 "</span>
<span class="hljs-comment">// âŒ é”™è¯¯ï¼æŠŠ "&lt; 10" å½“æˆæ ‡ç­¾åˆ é™¤äº†</span>
</code></pre>
<hr/>
<h2 data-id="heading-32">07. æ­£åˆ™è¡¨è¾¾å¼çš„æ€§èƒ½ä¼˜åŒ–</h2>
<h3 data-id="heading-33">æŠ€å·§1ï¼šé¿å…å›æº¯</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ æ…¢ï¼šä¼šå›æº¯</span>
/^(a+)+b$/

<span class="hljs-comment">// âœ… å¿«ï¼šä¸ä¼šå›æº¯</span>
<span class="hljs-regexp">/^a+b$/</span>
</code></pre>
<h3 data-id="heading-34">æŠ€å·§2ï¼šä½¿ç”¨éæ•è·ç»„</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ æ…¢ï¼šåˆ›å»ºæ•è·ç»„</span>
/(\d{<span class="hljs-number">4</span>})-(\d{<span class="hljs-number">2</span>})-(\d{<span class="hljs-number">2</span>})/

<span class="hljs-comment">// âœ… å¿«ï¼šä¸åˆ›å»ºæ•è·ç»„ï¼ˆå¦‚æœä¸éœ€è¦æ•è·ï¼‰</span>
<span class="hljs-regexp">/(?:\d{4})-(?:\d{2})-(?:\d{2})/</span>
</code></pre>
<h3 data-id="heading-35">æŠ€å·§3ï¼šæå‰é”šå®š</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ æ…¢ï¼šä¼šå°è¯•æ¯ä¸ªä½ç½®</span>
/\d{<span class="hljs-number">4</span>}-\d{<span class="hljs-number">2</span>}-\d{<span class="hljs-number">2</span>}/

<span class="hljs-comment">// âœ… å¿«ï¼šåªå°è¯•å¼€å¤´</span>
<span class="hljs-regexp">/^\d{4}-\d{2}-\d{2}/</span>
</code></pre>
<h3 data-id="heading-36">æŠ€å·§4ï¼šä½¿ç”¨å­—ç¬¦ç±»è€Œä¸æ˜¯å¤šä¸ªé€‰æ‹©</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ æ…¢</span>
/(a|b|c|d|e)/

<span class="hljs-comment">// âœ… å¿«</span>
<span class="hljs-regexp">/[a-e]/</span>
</code></pre>
<h3 data-id="heading-37">æŠ€å·§5ï¼šé¿å…ä¸å¿…è¦çš„å…¨å±€åŒ¹é…</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ æ…¢ï¼šå…¨å±€åŒ¹é…</span>
<span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/\d+/g</span>
regex.<span class="hljs-title function_">test</span>(text)

<span class="hljs-comment">// âœ… å¿«ï¼šéå…¨å±€åŒ¹é…ï¼ˆå¦‚æœåªéœ€è¦æµ‹è¯•æ˜¯å¦å­˜åœ¨ï¼‰</span>
<span class="hljs-keyword">const</span> regex = <span class="hljs-regexp">/\d+/</span>
regex.<span class="hljs-title function_">test</span>(text)
</code></pre>
<hr/>
<h2 data-id="heading-38">08. æ­£åˆ™è¡¨è¾¾å¼é€ŸæŸ¥è¡¨</h2>
<h3 data-id="heading-39">åŸºæœ¬è¯­æ³•</h3>
<pre><code class="hljs language-css" lang="css">.       ä»»æ„å­—ç¬¦ï¼ˆé™¤æ¢è¡Œç¬¦ï¼‰
\d      æ•°å­— <span class="hljs-selector-attr">[0-9]</span>
\D      éæ•°å­— <span class="hljs-selector-attr">[^0-9]</span>
\w      å•è¯å­—ç¬¦ <span class="hljs-selector-attr">[a-zA-Z0-9_]</span>
\W      éå•è¯å­—ç¬¦
\s      ç©ºç™½å­—ç¬¦ <span class="hljs-selector-attr">[ \t\n\r\f\v]</span>
\S      éç©ºç™½å­—ç¬¦
^       å¼€å§‹
$       ç»“æŸ
\<span class="hljs-selector-tag">b</span>      å•è¯è¾¹ç•Œ
\<span class="hljs-selector-tag">B</span>      éå•è¯è¾¹ç•Œ
</code></pre>
<h3 data-id="heading-40">é‡è¯</h3>
<pre><code class="hljs language-diff" lang="diff">*       0æ¬¡æˆ–å¤šæ¬¡ï¼ˆè´ªå©ªï¼‰
<span class="hljs-addition">+       1æ¬¡æˆ–å¤šæ¬¡ï¼ˆè´ªå©ªï¼‰</span>
?       0æ¬¡æˆ–1æ¬¡ï¼ˆè´ªå©ªï¼‰
{n}     æ°å¥½næ¬¡
{n,}    è‡³å°‘næ¬¡
{n,m}   nåˆ°mæ¬¡
*?      0æ¬¡æˆ–å¤šæ¬¡ï¼ˆéè´ªå©ªï¼‰
<span class="hljs-addition">+?      1æ¬¡æˆ–å¤šæ¬¡ï¼ˆéè´ªå©ªï¼‰</span>
??      0æ¬¡æˆ–1æ¬¡ï¼ˆéè´ªå©ªï¼‰
</code></pre>
<h3 data-id="heading-41">å­—ç¬¦ç±»</h3>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[abc]</span>   <span class="hljs-selector-tag">a</span>ã€<span class="hljs-selector-tag">b</span>æˆ–c
<span class="hljs-selector-attr">[^abc]</span>  é™¤äº†<span class="hljs-selector-tag">a</span>ã€<span class="hljs-selector-tag">b</span>ã€c
<span class="hljs-selector-attr">[a-z]</span>   <span class="hljs-selector-tag">a</span>åˆ°z
<span class="hljs-selector-attr">[A-Z]</span>   <span class="hljs-selector-tag">A</span>åˆ°Z
<span class="hljs-selector-attr">[0-9]</span>   <span class="hljs-number">0</span>åˆ°<span class="hljs-number">9</span>
</code></pre>
<h3 data-id="heading-42">åˆ†ç»„</h3>
<pre><code class="hljs language-scss" lang="scss">(...)       æ•è·ç»„
(?:...)     éæ•è·ç»„
(?&lt;name&gt;...)å‘½åæ•è·ç»„
</code></pre>
<h3 data-id="heading-43">æ–­è¨€</h3>
<pre><code class="hljs language-ruby" lang="ruby">(<span class="hljs-string">?=</span>...)     æ­£å‘å…ˆè¡Œæ–­è¨€
(<span class="hljs-string">?!</span>...)     è´Ÿå‘å…ˆè¡Œæ–­è¨€
(<span class="hljs-string">?&lt;</span>=...)    æ­£å‘åè¡Œæ–­è¨€
(<span class="hljs-string">?&lt;</span>!...)    è´Ÿå‘åè¡Œæ–­è¨€
</code></pre>
<h3 data-id="heading-44">æ ‡å¿—</h3>
<pre><code class="hljs language-css" lang="css">g       å…¨å±€åŒ¹é…
<span class="hljs-selector-tag">i</span>       å¿½ç•¥å¤§å°å†™
m       å¤šè¡Œæ¨¡å¼
s       dotallæ¨¡å¼ï¼ˆ.åŒ¹é…æ¢è¡Œç¬¦ï¼‰
u       Unicodeæ¨¡å¼
y       ç²˜æ€§æ¨¡å¼
</code></pre>
<hr/>
<h2 data-id="heading-45">å†™åœ¨æœ€åï¼šæ­£åˆ™ä¸æ˜¯é“¶å¼¹</h2>
<p>æ­£åˆ™è¡¨è¾¾å¼å¾ˆå¼ºå¤§ï¼Œä½†ä¸æ˜¯ä¸‡èƒ½çš„ã€‚</p>
<p><strong>é€‚åˆç”¨æ­£åˆ™çš„åœºæ™¯ï¼š</strong></p>
<ul>
<li>ç®€å•çš„æ–‡æœ¬åŒ¹é…å’Œæ›¿æ¢</li>
<li>è¾“å…¥éªŒè¯ï¼ˆé‚®ç®±ã€æ‰‹æœºå·ã€å¯†ç ï¼‰</li>
<li>æ—¥å¿—åˆ†æ</li>
<li>ç®€å•çš„æ–‡æœ¬æå–</li>
</ul>
<p><strong>ä¸é€‚åˆç”¨æ­£åˆ™çš„åœºæ™¯ï¼š</strong></p>
<ul>
<li>è§£æ HTML/XMLï¼ˆç”¨ DOM Parserï¼‰</li>
<li>è§£æ JSONï¼ˆç”¨ JSON.parseï¼‰</li>
<li>å¤æ‚çš„è¯­æ³•åˆ†æï¼ˆç”¨ä¸“é—¨çš„ Parserï¼‰</li>
<li>éœ€è¦ä¸Šä¸‹æ–‡çš„åŒ¹é…ï¼ˆç”¨çŠ¶æ€æœºï¼‰</li>
</ul>
<p><strong>è®°ä½è¿™äº›åŸåˆ™ï¼š</strong></p>
<ol>
<li>èƒ½ç”¨å­—ç¬¦ä¸²æ–¹æ³•å°±ä¸ç”¨æ­£åˆ™</li>
<li>èƒ½ç”¨ç®€å•æ­£åˆ™å°±ä¸ç”¨å¤æ‚æ­£åˆ™</li>
<li>èƒ½ç”¨ç°æˆåº“å°±ä¸è‡ªå·±å†™æ­£åˆ™</li>
<li>å†™å®Œæ­£åˆ™ä¸€å®šè¦æµ‹è¯•è¾¹ç•Œæƒ…å†µ</li>
<li>å¤æ‚æ­£åˆ™ä¸€å®šè¦åŠ æ³¨é‡Š</li>
</ol>
<p><strong>æ­£åˆ™è¡¨è¾¾å¼æ˜¯å·¥å…·ï¼Œä¸æ˜¯ç‚«æŠ€çš„æ‰‹æ®µã€‚</strong></p>
<p><strong>ä»£ç æ˜¯å†™ç»™äººçœ‹çš„ï¼Œä¸æ˜¯å†™ç»™æ­£åˆ™å¼•æ“çœ‹çš„ã€‚</strong></p>
<hr/>
<p><strong>ä½ è¢«å“ªä¸ªæ­£åˆ™è¡¨è¾¾å¼æŠ˜ç£¨è¿‡ï¼Ÿ</strong></p>
<p><strong>åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„"æ­£åˆ™åœ°ç‹±"æ•…äº‹å§ï¼</strong></p>
<p><em>è¯´ä¸å®šï¼Œä½ çš„ç»å†èƒ½æ•‘å¦ä¸€ä¸ªæ­£åœ¨ Google "regex email validation" çš„å¼€å‘è€…ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025ï¼Œæˆ‘ç¡®è¯Šäº†â€œVibe Codingâ€ï¼šå½“AIä¸å†æ˜¯å·¥å…·ï¼Œè€Œæ˜¯æˆ‘çš„â€œå¤–æŒ‚å¤§è„‘â€]]></title>    <link>https://juejin.cn/post/7597083949834387462</link>    <guid>https://juejin.cn/post/7597083949834387462</guid>    <pubDate>2026-01-20T07:22:08.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597083949834387462" data-draft-id="7597230546239324196" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025ï¼Œæˆ‘ç¡®è¯Šäº†â€œVibe Codingâ€ï¼šå½“AIä¸å†æ˜¯å·¥å…·ï¼Œè€Œæ˜¯æˆ‘çš„â€œå¤–æŒ‚å¤§è„‘â€"/> <meta itemprop="keywords" content="Trae,AIç¼–ç¨‹"/> <meta itemprop="datePublished" content="2026-01-20T07:22:08.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è£…ç¡é¹¿å…ˆç”Ÿ"/> <meta itemprop="url" content="https://juejin.cn/user/1117561743761582"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025ï¼Œæˆ‘ç¡®è¯Šäº†â€œVibe Codingâ€ï¼šå½“AIä¸å†æ˜¯å·¥å…·ï¼Œè€Œæ˜¯æˆ‘çš„â€œå¤–æŒ‚å¤§è„‘â€
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1117561743761582/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è£…ç¡é¹¿å…ˆç”Ÿ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:22:08.000Z" title="Tue Jan 20 2026 07:22:08 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»¥å‰å†™ä»£ç é â€œæ‰‹é€Ÿâ€å’Œâ€œè®°å¿†åŠ›â€ï¼Œ2025å¹´å†™ä»£ç é çš„æ˜¯â€œç›´è§‰â€å’Œâ€œå®¡ç¾â€ã€‚Andrej Karpathy è¯´çš„ "Vibe Coding"ï¼ˆæ°›å›´ç¼–ç ï¼‰ï¼Œæˆ‘ç»ˆäºåœ¨è¿™ä¸€å¹´æ‚Ÿé€äº†ã€‚</p>
<p>2024å¹´åˆï¼Œæˆ‘è¿˜åœ¨ä¸º Cursor çš„è¡¥å…¨æ„Ÿåˆ°æƒŠè‰³ï¼›åˆ°äº†2025å¹´ï¼Œæˆ‘çš„å¼€å‘æ¨¡å¼å·²ç»å½»åº•é‡å¡‘ã€‚</p>
<p>ä½œä¸ºä¸€ä¸ªå†™äº†å¤šå¹´ Java/Go çš„åç«¯è€å…µï¼Œè¿™ä¸€å¹´æ˜¯æˆ‘èŒä¸šç”Ÿæ¶¯ä¸­ç„¦è™‘æ„Ÿæœ€å°‘ï¼Œä½†äº§å‡ºæœ€é«˜çš„ä¸€å¹´ã€‚ä»Šå¤©ä¸èŠæ¯ç‡¥çš„æ¶æ„å›¾ï¼ŒèŠèŠè¿™è¯¥æ­»çš„ã€è¿·äººçš„ Vibe Coding æ—¶åˆ»ï¼Œä»¥åŠå®ƒå¦‚ä½•æ”¹å˜äº†æˆ‘è¿™ä¸ªâ€œå¤§é¾„ç¨‹åºå‘˜â€çš„ 2025ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€Agent é©å‘½ï¼šä»â€œå¸®æˆ‘å†™â€åˆ°â€œå¸®æˆ‘åšâ€</h2>
<p>2025å¹´æœ€å¤§çš„ä½“æ„Ÿå·®å¼‚ï¼Œåœ¨äº Agentï¼ˆæ™ºèƒ½ä½“ï¼‰ çš„æˆç†Ÿã€‚</p>
<p>ä»¥å‰æˆ‘ä»¬ç”¨ ChatGPTï¼Œæ˜¯æŠŠå®ƒå½“ç™¾ç§‘å…¨ä¹¦æˆ–ç‰‡æ®µç”Ÿæˆå™¨ï¼šâ€œå¸®æˆ‘å†™ä¸ªæ­£åˆ™â€ã€â€œè§£é‡Šè¿™æ®µæŠ¥é”™â€ã€‚</p>
<p>ç°åœ¨ï¼Œæˆ‘æŠŠå®ƒå½“å®ä¹ ç”Ÿï¼Œç”šè‡³æ˜¯é«˜çº§åˆä¼™äººã€‚</p>
<p>ä¹Ÿå°±æ˜¯åœ¨é‚£ä¸€åˆ»ï¼Œæˆ‘è¿›å…¥äº†â€œVibe Codingâ€çŠ¶æ€ï¼š</p>
<h3 data-id="heading-1">ğŸ“Œ åœºæ™¯è¿˜åŸ</h3>
<p>ä¸Šå‘¨æˆ‘è¦ä¸ºä¸€ä¸ªè€æ—§çš„é—ç•™ç³»ç»ŸåŠ ä¸€ä¸ªå¤æ‚çš„æŠ¥è¡¨åŠŸèƒ½ï¼Œæ¶‰åŠå¤šè¡¨èšåˆå’Œå³æ—¶è®¡ç®—ã€‚</p>
<p><strong>Old School (2023)</strong> ï¼šæ‰“å¼€ MyBatis æ–‡æ¡£ï¼Œå›å¿† SQL è¯­æ³•ï¼Œæ‰‹å†™ Mapperï¼ŒDebug ç©ºæŒ‡é’ˆï¼Œè¿™ä¸€å¥—ä¸‹æ¥è‡³å°‘ 4 å°æ—¶ï¼Œä¸­é—´è¿˜å¾—å» Google æœä¸¤éæŠ¥é”™ã€‚</p>
<p><strong>Vibe Coding (2025)</strong> ï¼šæˆ‘æ‰“å¼€ IDE çš„ Agent æ¨¡å¼ï¼ˆComposer/Windsurfï¼‰ï¼Œç›´æ¥ç”©è¿‡å»ä¸€æ®µâ€œä¼ªä»£ç +ä¸šåŠ¡é€»è¾‘â€çš„ Promptã€‚</p>
<p><strong>æˆ‘çš„ Promptï¼š</strong></p>
<pre><code class="hljs language-sql" lang="sql">è¯»å– <span class="hljs-keyword">Order</span> è¡¨å’Œ <span class="hljs-keyword">User</span> è¡¨ï¼ŒæŒ‰å­£åº¦ç»Ÿè®¡é«˜å‡€å€¼ç”¨æˆ·çš„å¤è´­ç‡ã€‚æ³¨æ„ï¼Œé«˜å‡€å€¼çš„å®šä¹‰æ˜¯æœ€è¿‘ä¸€å¹´æ¶ˆè´¹ Top <span class="hljs-number">10</span><span class="hljs-operator">%</span>ã€‚è¯·ç”¨ Go è¯­è¨€å®ç°ï¼Œä½¿ç”¨ GORMï¼Œè€ƒè™‘åˆ°æ•°æ®é‡çº§ï¼Œä¸è¦åœ¨å†…å­˜é‡Œåš <span class="hljs-keyword">Join</span>ï¼Œç›´æ¥ç”Ÿæˆä¼˜åŒ–çš„ <span class="hljs-keyword">SQL</span>ã€‚åŒæ—¶ï¼Œå¸®æˆ‘å†™å¥½å¯¹åº”çš„ Unit Testã€‚
</code></pre>
<p>30ç§’åï¼Œä»£ç ç”Ÿæˆï¼Œæµ‹è¯•é€šè¿‡ã€‚</p>
<p>æˆ‘æ²¡æœ‰åœ¨å†™ä»£ç ï¼Œæˆ‘åœ¨Reviewä»£ç ã€‚æˆ‘ä»â€œæ¬ç –å·¥â€å˜æˆäº†â€œå·¥å¤´â€ã€‚</p>
<p>è¿™ç§ Vibeï¼ˆæ°›å›´ï¼‰å°±æ˜¯ï¼šæˆ‘ä¸éœ€è¦è®°ä½æ¯ä¸€ä¸ª API çš„ç»†èŠ‚ï¼Œæˆ‘åªéœ€è¦ä¿æŒå¯¹ä¸šåŠ¡é€»è¾‘çš„æ¸…æ™°è®¤çŸ¥ï¼Œå‰©ä¸‹çš„è„æ´»ç´¯æ´»ï¼ŒAgent å…¨åŒ…äº†ã€‚æˆ‘çš„å¤§è„‘ä¸å†è¢«è¯­æ³•ç³–å æ®ï¼Œè€Œæ˜¯è…¾å‡ºç©ºé—´å»æ€è€ƒæ¶æ„çš„ä¼˜é›…å’Œä¸šåŠ¡çš„ä»·å€¼ã€‚</p>
<h2 data-id="heading-2">äºŒã€åç«¯äººçš„â€œå…¨æ ˆâ€å¹³æƒè¿åŠ¨</h2>
<p>å¯¹äºåƒæˆ‘è¿™æ ·çš„åç«¯å¼€å‘æ¥è¯´ï¼Œ2025å¹´æœ€å¤§çš„çº¢åˆ©æ˜¯ï¼šæŠ€æœ¯æ ˆçš„è¾¹ç•Œæ¶ˆå¤±äº†ã€‚</p>
<p>ä»¥å‰æˆ‘æƒ³åšä¸€ä¸ªç‹¬ç«‹äº§å“ï¼Œå¡åœ¨ CSS å±…ä¸­ã€å¡åœ¨ Webpack é…ç½®ã€å¡åœ¨ React çš„ useEffect é—­åŒ…é™·é˜±é‡Œã€‚é‚£ç§æŒ«è´¥æ„Ÿï¼Œè¶³ä»¥åŠé€€ 90% çš„åç«¯ã€‚</p>
<p>ä½†ä»Šå¹´ï¼Œæˆ‘å±…ç„¶ä¸€ä¸ªäººä¸Šçº¿äº†ä¸¤æ¬¾å…¨æ ˆåº”ç”¨ã€‚</p>
<h3 data-id="heading-3">âœ¨ æˆ‘çš„â€œVibeâ€æ—¶åˆ»</h3>
<p>æˆ‘æƒ³ç»™å¥³å„¿åšä¸€ä¸ªâ€œèƒŒå¤è¯—æ‰“æ€ªå…½â€çš„ç½‘é¡µå°æ¸¸æˆã€‚æˆ‘ä¸æ‡‚ Canvasï¼Œä¸æ‡‚ Vue3 çš„æœ€æ–°ç‰¹æ€§ã€‚</p>
<p>ä½†æˆ‘æ‡‚æè¿°ã€‚</p>
<p>æˆ‘åƒä¸ªäº§å“ç»ç†ä¸€æ ·å¯¹ç€ AI è¯´ï¼šâ€œæˆ‘è¦ä¸€ä¸ªåƒç´ é£çš„ç•Œé¢ï¼Œå·¦è¾¹æ˜¯æ€ªå…½ï¼Œå³è¾¹æ˜¯è¡€æ¡ï¼ŒèƒŒå¯¹ä¸€å¥è¯—ï¼Œæ€ªå…½æ‰ä¸€æ»´è¡€ã€‚â€</p>
<p>AI ä¸ä»…ç»™äº†æˆ‘å‰ç«¯ä»£ç ï¼Œè¿˜å¸®æˆ‘ç”Ÿæˆäº†åƒç´ ç´ æï¼ˆSVG/å›¾ç‰‡ï¼‰ã€‚</p>
<h3 data-id="heading-4">ğŸ’¡ æ„Ÿæ‚Ÿï¼š</h3>
<p>2025å¹´ï¼Œå…¨æ ˆä¸å†æ˜¯ä¸€ä¸ªèŒä½ï¼Œè€Œæ˜¯ä¸€ç§èƒ½åŠ›ã€‚ AI æŠ¹å¹³äº†è¯­è¨€çš„é¸¿æ²Ÿã€‚åªè¦ä½ æ‡‚é€»è¾‘ï¼ˆBackend Logicï¼‰ï¼Œå‰ç«¯ã€è¿ç»´ï¼ˆDocker/K8sï¼‰ã€ç”šè‡³æµ‹è¯•ï¼ŒAI éƒ½èƒ½å¸®ä½ è¡¥é½ã€‚æˆ‘ä»¬æ­£åœ¨è¿›å…¥ Product Engineerï¼ˆäº§å“å·¥ç¨‹å¸ˆï¼‰ çš„é»„é‡‘æ—¶ä»£ã€‚</p>
<h2 data-id="heading-5">ä¸‰ã€ç”Ÿæ´» Vibeï¼šæ•°å­—æ¸¸æ°‘çš„â€œé¢„æ¼”â€</h2>
<p>Vibe Coding çš„è¿é”ååº”ï¼Œç›´æ¥æº¢å‡ºåˆ°äº†ç”Ÿæ´»ã€‚</p>
<p>æ•ˆç‡æå‡å¸¦æ¥çš„ç›´æ¥ç»“æœå°±æ˜¯ï¼šæˆ‘å‡†æ—¶ä¸‹ç­äº†ï¼Œç”šè‡³åœ¨æŸäº›è¿œç¨‹åŠå…¬çš„æ—¥å­é‡Œï¼Œæˆ‘æå‰â€œé€€ä¼‘â€äº†ã€‚</p>
<p>è¿™ä¸€å¹´ï¼Œæˆ‘å¼€å§‹å°è¯• Web3 å’Œæ•°å­—æ¸¸æ°‘çš„ç”Ÿæ´»æ–¹å¼ã€‚ä¸æ˜¯ä¸ºäº†ç‚’å¸ï¼Œè€Œæ˜¯ä¸ºäº†æ¢ç´¢å»ä¸­å¿ƒåŒ–æŠ€æœ¯å¸¦æ¥çš„è‡ªç”±åº¦ã€‚</p>
<h3 data-id="heading-6">ğŸŒ¿ ç”Ÿæ´»ä¸­çš„ AI æ—¶åˆ»ï¼š</h3>
<ol>
<li><strong>æ—…è¡Œæ”»ç•¥</strong>ï¼šæˆ‘ä¸å†å»æŸçº¢ä¹¦ç¿»åƒç¯‡ä¸€å¾‹çš„ç½‘çº¢æ‰“å¡ç‚¹ã€‚æˆ‘æŠŠæˆ‘çš„å…´è¶£ï¼ˆå’–å•¡ã€é»‘èƒ¶å”±ç‰‡ã€å»ºç­‘ï¼‰å–‚ç»™ AIï¼Œè®©å®ƒåŸºäº Google Maps API ç»™æˆ‘è§„åˆ’äº†ä¸€æ¡å®Œå…¨å®šåˆ¶åŒ–çš„â€œä¸œäº¬æå®¢ä¹‹æ—…â€ã€‚</li>
<li><strong>å®¶åº­æ•™è‚²</strong>ï¼šé¢å¯¹å­©å­äº”èŠ±å…«é—¨çš„â€œåä¸‡ä¸ªä¸ºä»€ä¹ˆâ€ï¼Œæˆ‘ç”¨ AI ç”Ÿæˆç»˜æœ¬æ•…äº‹è§£é‡Šâ€œä¸ºä»€ä¹ˆæœˆäº®ä¼šè·Ÿç€äººèµ°â€ã€‚æˆ‘è‡ªå·±ç”šè‡³ç”¨ Suno ç”Ÿæˆäº†ä¸€é¦–åªæœ‰æˆ‘ä»¬ä¸€å®¶äººå¬å¾—æ‡‚çš„â€œèµ·åºŠæ­Œâ€ã€‚</li>
</ol>
<p>æŠ€æœ¯ä¸å†æ˜¯å†°å†·çš„ä»£ç ï¼Œå®ƒå˜æˆäº†ç”Ÿæ´»çš„å¢å‘³å‰‚ã€‚è¿™ç§æ¾å¼›æ„Ÿï¼Œæ˜¯ä»¥å‰é‚£ä¸ªå¤©å¤©æ‹…å¿ƒçº¿ä¸Š OOM çš„æˆ‘æ— æ³•æƒ³è±¡çš„ã€‚</p>
<h2 data-id="heading-7">å››ã€2025 å¹´åº¦æ€»ç»“ï¼šå¾—ä¸å¤±</h2>
<p>å¤ç›˜ 2025ï¼Œä½œä¸ºä¸€åå¼€å‘è€…ï¼Œæˆ‘çš„åº•å±‚æ“ä½œç³»ç»Ÿå‘ç”Ÿäº†æ›´è¿­ã€‚</p>
<h3 data-id="heading-8">âŒ å¤±å»çš„ï¼š</h3>
<ul>
<li>å¯¹è¯­æ³•çš„è‚Œè‚‰è®°å¿†ï¼šå¦ç™½è¯´ï¼Œæˆ‘ç°åœ¨æ‰‹å†™ä¸€ä¸ªå¤æ‚çš„ CompletableFuture é“¾å¼è°ƒç”¨å¯èƒ½ä¼šå¡å£³ã€‚</li>
<li>çº¯ç²¹çš„æŠ€æœ¯å‚²æ…¢ï¼šä»¥å‰è§‰å¾—æ‡‚åº•å±‚æºç å¾ˆç‰›ï¼Œç°åœ¨è§‰å¾—èƒ½å¿«é€Ÿç”¨æŠ€æœ¯è§£å†³é—®é¢˜æ›´ç‰›ã€‚</li>
</ul>
<h3 data-id="heading-9">âœ… å¾—åˆ°çš„ï¼š</h3>
<ul>
<li>ç³»ç»Ÿæ€§æ€ç»´ï¼ˆSystem 2 Thinkingï¼‰ï¼šå½“ç¼–ç ä¸å†è€—æ—¶ï¼Œæˆ‘èŠ±æ›´å¤šæ—¶é—´æ€è€ƒâ€œä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªåŠŸèƒ½â€è€Œä¸æ˜¯â€œæ€ä¹ˆåšâ€ã€‚</li>
<li>åˆ›é€ åŠ›çš„çˆ†å‘ï¼šæƒ³æ³•åˆ°äº§å“çš„è·ç¦»ï¼Œè¢«æ— é™ç¼©çŸ­äº†ã€‚</li>
<li>Vibeï¼ˆæ¾å¼›æ„Ÿï¼‰ï¼šä¹Ÿå°±æ˜¯æ ‡é¢˜è¯´çš„ Vibe Codingã€‚Code with Flow, not with Force.</li>
</ul>
<h2 data-id="heading-10">å†™åœ¨æœ€å</h2>
<p>å¦‚æœè¯´ 2023 æ˜¯ AI çš„å…ƒå¹´ï¼Œ2024 æ˜¯ AI çš„åº”ç”¨å¹´ï¼Œé‚£ä¹ˆ 2025 å°±æ˜¯æˆ‘ä»¬ä¸ AI è¾¾æˆâ€œå…±ç”Ÿâ€çš„ä¸€å¹´ã€‚</p>
<p>ä¸è¦å®³æ€• AI ä¼šå–ä»£ç¨‹åºå‘˜ã€‚è¢«å–ä»£çš„åªæ˜¯é‚£ä¸ªâ€œåªä¼šå†™ CRUDã€åªä¼šç™¾åº¦æŠ¥é”™â€çš„ç¨‹åºå‘˜ã€‚</p>
<p>Vibe Coding çš„æœ¬è´¨ï¼Œä¸æ˜¯è®©ä½ ä¸å†™ä»£ç ï¼Œè€Œæ˜¯è®©ä½ æ›´æœ‰çµé­‚åœ°å†™ä»£ç ã€‚</p>
<p>2026 å³å°†åˆ°æ¥ï¼Œå»ºè®®æ‰€æœ‰æ˜å‹ä»¬ï¼š</p>
<ol>
<li>æ‹¥æŠ± Agentï¼šç†Ÿç»ƒæŒæ¡ 1-2 ä¸ª AI ç¼–ç¨‹å·¥å…·ï¼ˆCursor/Windsurf/Trae ç­‰ï¼‰ã€‚</li>
<li>ç»ƒä¹  Promptï¼šè‡ªç„¶è¯­è¨€å°±æ˜¯æœ€æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼ˆNLP is the new Pythonï¼‰ã€‚</li>
<li>ä¿æŒæ•é”ï¼šå…³æ³¨ä¸šåŠ¡ï¼Œå…³æ³¨äº§å“ï¼Œå…³æ³¨æŠ€æœ¯å¦‚ä½•è½åœ°ã€‚</li>
</ol>
<p>æ„¿å¤§å®¶åœ¨ 2025ï¼Œä»£ç æ—  Bugï¼Œç”Ÿæ´»æœ‰ Vibeï¼ğŸš€</p>
<p><strong>äº’åŠ¨è¯é¢˜ï¼š</strong></p>
<p>2025å¹´äº†ï¼Œä½ ç°åœ¨çš„ä»£ç å«â€œAIâ€é‡æœ‰å¤šå°‘ï¼Ÿåœ¨è¯„è®ºåŒºæµ‹æµ‹ä½ çš„â€œVibeâ€æŒ‡æ•°ï¼ğŸ‘‡</p>
<p>ï¼ˆè®°å¾—ç‚¹èµæ”¶è—ï¼Œé˜²æ­¢è¿·è·¯ï¼‰</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•°å­¦è¿ç®—ä¸é€»è¾‘åˆ¤æ–­ - è¿ç®—ç¬¦ä¸æ¡ä»¶è¯­å¥]]></title>    <link>https://juejin.cn/post/7597024900521082932</link>    <guid>https://juejin.cn/post/7597024900521082932</guid>    <pubDate>2026-01-20T07:21:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597024900521082932" data-draft-id="7597199288816435240" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•°å­¦è¿ç®—ä¸é€»è¾‘åˆ¤æ–­ - è¿ç®—ç¬¦ä¸æ¡ä»¶è¯­å¥"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-20T07:21:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·8815838029450"/> <meta itemprop="url" content="https://juejin.cn/user/339129318513335"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•°å­¦è¿ç®—ä¸é€»è¾‘åˆ¤æ–­ - è¿ç®—ç¬¦ä¸æ¡ä»¶è¯­å¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/339129318513335/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·8815838029450
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:21:26.000Z" title="Tue Jan 20 2026 07:21:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    9
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸“æ å¯¼èˆª</h2>
<ul>
<li>â† ä¸Šä¸€ç¯‡ï¼š<a href="https://juejin.cn/post/7595893785907724322" target="_blank" title="https://juejin.cn/post/7595893785907724322">å­˜æ”¾æ•°æ®çš„åœ°æ–¹ - æ•°ç»„ä¸é›†åˆ</a></li>
<li>â† ç¬¬ä¸€ç¯‡ï¼š<a href="https://juejin.cn/post/7594642978695233599" target="_blank" title="https://juejin.cn/post/7594642978695233599">ç¼–ç¨‹ä¸–ç•Œåˆæ¢</a></li>
<li><a href="https://juejin.cn/post/7596989416761131043" target="_blank" title="https://juejin.cn/post/7596989416761131043">ä¸“æ ç›®å½•</a></li>
</ul>
<blockquote>
<p>ç¨‹åºä¸ä»…æ˜¯å­˜å‚¨æ•°æ®ï¼Œæ›´é‡è¦çš„æ˜¯å¯¹æ•°æ®è¿›è¡Œå¤„ç†å’Œåˆ¤æ–­ã€‚è¿™ä¸€å‘¨ï¼Œæˆ‘ä»¬å­¦ä¹ å¦‚ä½•è¿›è¡Œæ•°å­¦è¿ç®—å’Œé€»è¾‘åˆ¤æ–­ï¼Œè®©ä½ çš„ç¨‹åº"èªæ˜"èµ·æ¥ã€‚</p>
</blockquote>
<h3 data-id="heading-1">ç®—æœ¯è¿ç®—ç¬¦</h3>
<p>ç®—æœ¯è¿ç®—ç¬¦ç”¨äºè¿›è¡Œæ•°å­¦è®¡ç®—ã€‚</p>
<h4 data-id="heading-2">åŸºæœ¬ç®—æœ¯è¿ç®—ç¬¦</h4>









































<table><thead><tr><th>è¿ç®—ç¬¦</th><th>åç§°</th><th>ç¤ºä¾‹</th><th>ç»“æœ</th></tr></thead><tbody><tr><td><code>+</code></td><td>åŠ æ³•</td><td><code>5 + 3</code></td><td><code>8</code></td></tr><tr><td><code>-</code></td><td>å‡æ³•</td><td><code>5 - 3</code></td><td><code>2</code></td></tr><tr><td><code>*</code></td><td>ä¹˜æ³•</td><td><code>5 * 3</code></td><td><code>15</code></td></tr><tr><td><code>/</code></td><td>é™¤æ³•</td><td><code>10 / 3</code></td><td><code>3.333...</code></td></tr><tr><td><code>%</code></td><td>å–ä½™ï¼ˆæ¨¡ï¼‰</td><td><code>10 % 3</code></td><td><code>1</code></td></tr></tbody></table>
<h4 data-id="heading-3">å–ä½™è¿ç®—ç¬¦ï¼ˆ%ï¼‰</h4>
<p>å–ä½™è¿ç®—ç¬¦è¿”å›é™¤æ³•çš„ä½™æ•°ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp">Console.WriteLine(<span class="hljs-number">10</span> % <span class="hljs-number">3</span>);   <span class="hljs-comment">// è¾“å‡ºï¼š1  (10 Ã· 3 = 3 ä½™ 1)</span>
Console.WriteLine(<span class="hljs-number">10</span> % <span class="hljs-number">2</span>);   <span class="hljs-comment">// è¾“å‡ºï¼š0  (10 æ˜¯å¶æ•°)</span>
Console.WriteLine(<span class="hljs-number">11</span> % <span class="hljs-number">2</span>);   <span class="hljs-comment">// è¾“å‡ºï¼š1  (11 æ˜¯å¥‡æ•°)</span>
</code></pre>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong> åˆ¤æ–­å¥‡å¶æ•°ã€å¾ªç¯è®¡æ•°ç­‰</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºå¶æ•°</span>
<span class="hljs-built_in">int</span> number = <span class="hljs-number">10</span>;
<span class="hljs-built_in">bool</span> isEven = (number % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>);  <span class="hljs-comment">// true</span>
</code></pre>
<h4 data-id="heading-4">æ•´æ•°é™¤æ³•ä¸æµ®ç‚¹æ•°é™¤æ³•</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// æ•´æ•°é™¤æ³•ï¼ˆä¸¤ä¸ªéƒ½æ˜¯æ•´æ•°ï¼‰</span>
<span class="hljs-built_in">int</span> a = <span class="hljs-number">10</span>;
<span class="hljs-built_in">int</span> b = <span class="hljs-number">3</span>;
Console.WriteLine(a / b);    <span class="hljs-comment">// è¾“å‡ºï¼š3 (æ•´æ•°é™¤æ³•ï¼Œèˆå¼ƒå°æ•°)</span>

<span class="hljs-comment">// æµ®ç‚¹æ•°é™¤æ³•ï¼ˆè‡³å°‘æœ‰ä¸€ä¸ªæµ®ç‚¹æ•°ï¼‰</span>
<span class="hljs-built_in">double</span> c = <span class="hljs-number">10.0</span>;
<span class="hljs-built_in">double</span> d = <span class="hljs-number">3</span>;
Console.WriteLine(c / d);    <span class="hljs-comment">// è¾“å‡ºï¼š3.333...</span>
</code></pre>
<h4 data-id="heading-5">è¿ç®—ç¬¦ä¼˜å…ˆçº§</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å…ˆä¹˜é™¤ï¼ŒååŠ å‡</span>
<span class="hljs-built_in">int</span> result1 = <span class="hljs-number">2</span> + <span class="hljs-number">3</span> * <span class="hljs-number">4</span>;   <span class="hljs-comment">// 14 (3*4=12, 12+2=14)</span>

<span class="hljs-comment">// ä½¿ç”¨æ‹¬å·æ”¹å˜ä¼˜å…ˆçº§</span>
<span class="hljs-built_in">int</span> result2 = (<span class="hljs-number">2</span> + <span class="hljs-number">3</span>) * <span class="hljs-number">4</span>;  <span class="hljs-comment">// 20 (2+3=5, 5*4=20)</span>
</code></pre>
<p><strong>ä¼˜å…ˆçº§ï¼ˆä»é«˜åˆ°ä½ï¼‰ï¼š</strong></p>
<ol>
<li><code>()</code> æ‹¬å·</li>
<li><code>*</code>, <code>/</code>, <code>%</code></li>
<li><code>+</code>, <code>-</code></li>
</ol>
<h3 data-id="heading-6">æ¯”è¾ƒè¿ç®—ç¬¦</h3>
<p>æ¯”è¾ƒè¿ç®—ç¬¦ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼ï¼Œç»“æœä¸º <code>true</code> æˆ– <code>false</code>ã€‚</p>















































<table><thead><tr><th>è¿ç®—ç¬¦</th><th>åç§°</th><th>ç¤ºä¾‹</th><th>ç»“æœ</th></tr></thead><tbody><tr><td><code>==</code></td><td>ç­‰äº</td><td><code>5 == 5</code></td><td><code>true</code></td></tr><tr><td><code>!=</code></td><td>ä¸ç­‰äº</td><td><code>5 != 3</code></td><td><code>true</code></td></tr><tr><td><code>&lt;</code></td><td>å°äº</td><td><code>5 &lt; 3</code></td><td><code>false</code></td></tr><tr><td><code>&gt;</code></td><td>å¤§äº</td><td><code>5 &gt; 3</code></td><td><code>true</code></td></tr><tr><td><code>&lt;=</code></td><td>å°äºç­‰äº</td><td><code>5 &lt;= 5</code></td><td><code>true</code></td></tr><tr><td><code>&gt;=</code></td><td>å¤§äºç­‰äº</td><td><code>5 &gt;= 3</code></td><td><code>true</code></td></tr></tbody></table>
<h4 data-id="heading-7">ä½¿ç”¨ç¤ºä¾‹</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> age = <span class="hljs-number">18</span>;
<span class="hljs-built_in">bool</span> isAdult = age &gt;= <span class="hljs-number">18</span>;      <span class="hljs-comment">// true</span>
<span class="hljs-built_in">bool</span> isChild = age &lt; <span class="hljs-number">12</span>;       <span class="hljs-comment">// false</span>
<span class="hljs-built_in">bool</span> canDrive = age &gt;= <span class="hljs-number">18</span>;     <span class="hljs-comment">// true</span>
</code></pre>
<h4 data-id="heading-8">æ³¨æ„ï¼šåŒºåˆ† <code>=</code> å’Œ <code>==</code></h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> a = <span class="hljs-number">5</span>;     <span class="hljs-comment">// èµ‹å€¼è¿ç®—ç¬¦ï¼ŒæŠŠ 5 èµ‹å€¼ç»™ a</span>
<span class="hljs-built_in">bool</span> b = (<span class="hljs-number">5</span> == <span class="hljs-number">5</span>);  <span class="hljs-comment">// æ¯”è¾ƒè¿ç®—ç¬¦ï¼Œåˆ¤æ–­ 5 æ˜¯å¦ç­‰äº 5ï¼Œç»“æœ true</span>
</code></pre>
<h3 data-id="heading-9">é€»è¾‘è¿ç®—ç¬¦</h3>
<p>é€»è¾‘è¿ç®—ç¬¦ç”¨äºç»„åˆå¤šä¸ªæ¡ä»¶åˆ¤æ–­ã€‚</p>





























<table><thead><tr><th>è¿ç®—ç¬¦</th><th>åç§°</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>&amp;&amp;</code></td><td>é€»è¾‘ä¸ï¼ˆANDï¼‰</td><td>ä¸¤ä¸ªæ¡ä»¶éƒ½ä¸º trueï¼Œç»“æœæ‰ä¸º true</td><td><code>age &gt;= 18 &amp;&amp; hasLicense</code></td></tr><tr><td><code>||</code></td><td>é€»è¾‘æˆ–ï¼ˆORï¼‰</td><td>ä¸¤ä¸ªæ¡ä»¶è‡³å°‘ä¸€ä¸ªä¸º trueï¼Œç»“æœå°±ä¸º true</td><td><code>isWeekend || isHoliday</code></td></tr><tr><td><code>!</code></td><td>é€»è¾‘éï¼ˆNOTï¼‰</td><td>å–åï¼Œtrue å˜ falseï¼Œfalse å˜ true</td><td><code>!isStudent</code></td></tr></tbody></table>
<h4 data-id="heading-10">é€»è¾‘ä¸ï¼ˆ&amp;&amp;ï¼‰</h4>
<p>åªæœ‰å½“ä¸¤ä¸ªæ¡ä»¶éƒ½ä¸º <code>true</code> æ—¶ï¼Œç»“æœæ‰ä¸º <code>true</code>ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> age = <span class="hljs-number">25</span>;
<span class="hljs-built_in">bool</span> hasLicense = <span class="hljs-literal">true</span>;

<span class="hljs-built_in">bool</span> canDrive = age &gt;= <span class="hljs-number">18</span> &amp;&amp; hasLicense;  <span class="hljs-comment">// true</span>

<span class="hljs-comment">// å¦‚æœå¹´é¾„ä¸å¤Ÿ</span>
<span class="hljs-built_in">int</span> age2 = <span class="hljs-number">16</span>;
<span class="hljs-built_in">bool</span> canDrive2 = age2 &gt;= <span class="hljs-number">18</span> &amp;&amp; hasLicense;  <span class="hljs-comment">// false</span>

<span class="hljs-comment">// å¦‚æœæ²¡æœ‰é©¾ç…§</span>
<span class="hljs-built_in">int</span> age3 = <span class="hljs-number">25</span>;
<span class="hljs-built_in">bool</span> hasLicense3 = <span class="hljs-literal">false</span>;
<span class="hljs-built_in">bool</span> canDrive3 = age3 &gt;= <span class="hljs-number">18</span> &amp;&amp; hasLicense3;  <span class="hljs-comment">// false</span>
</code></pre>
<p><strong>çœŸå€¼è¡¨ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-literal">true</span>  &amp;&amp; <span class="hljs-literal">true</span>  = <span class="hljs-literal">true</span>
<span class="hljs-literal">true</span>  &amp;&amp; <span class="hljs-literal">false</span> = <span class="hljs-literal">false</span>
<span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-literal">true</span>  = <span class="hljs-literal">false</span>
<span class="hljs-literal">false</span> &amp;&amp; <span class="hljs-literal">false</span> = <span class="hljs-literal">false</span>
</code></pre>
<h4 data-id="heading-11">é€»è¾‘æˆ–ï¼ˆ||ï¼‰</h4>
<p>åªè¦æœ‰ä¸€ä¸ªæ¡ä»¶ä¸º <code>true</code>ï¼Œç»“æœå°±ä¸º <code>true</code>ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">bool</span> isWeekend = <span class="hljs-literal">false</span>;
<span class="hljs-built_in">bool</span> isHoliday = <span class="hljs-literal">true</span>;

<span class="hljs-built_in">bool</span> canRest = isWeekend || isHoliday;  <span class="hljs-comment">// true</span>
</code></pre>
<p><strong>çœŸå€¼è¡¨ï¼š</strong></p>
<pre><code class="hljs language-arduino" lang="arduino"><span class="hljs-literal">true</span>  || <span class="hljs-literal">true</span>  = <span class="hljs-literal">true</span>
<span class="hljs-literal">true</span>  || <span class="hljs-literal">false</span> = <span class="hljs-literal">true</span>
<span class="hljs-literal">false</span> || <span class="hljs-literal">true</span>  = <span class="hljs-literal">true</span>
<span class="hljs-literal">false</span> || <span class="hljs-literal">false</span> = <span class="hljs-literal">false</span>
</code></pre>
<h4 data-id="heading-12">é€»è¾‘éï¼ˆ!ï¼‰</h4>
<p>å°† <code>true</code> å˜ä¸º <code>false</code>ï¼Œ<code>false</code> å˜ä¸º <code>true</code>ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">bool</span> isStudent = <span class="hljs-literal">true</span>;
<span class="hljs-built_in">bool</span> isNotStudent = !isStudent;  <span class="hljs-comment">// false</span>

<span class="hljs-built_in">bool</span> isAdult = <span class="hljs-literal">false</span>;
<span class="hljs-built_in">bool</span> isNotAdult = !isAdult;      <span class="hljs-comment">// true</span>
</code></pre>
<h4 data-id="heading-13">ç»„åˆä½¿ç”¨</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// å¹´é¾„åœ¨ 18 åˆ° 30 ä¹‹é—´</span>
<span class="hljs-built_in">int</span> age = <span class="hljs-number">25</span>;
<span class="hljs-built_in">bool</span> isYoungAdult = age &gt;= <span class="hljs-number">18</span> &amp;&amp; age &lt;= <span class="hljs-number">30</span>;  <span class="hljs-comment">// true</span>

<span class="hljs-comment">// å‘¨æœ«æˆ–å‡æœŸå¯ä»¥ä¼‘æ¯</span>
<span class="hljs-built_in">bool</span> isWeekend = <span class="hljs-literal">true</span>;
<span class="hljs-built_in">bool</span> isHoliday = <span class="hljs-literal">false</span>;
<span class="hljs-built_in">bool</span> canRest = isWeekend || isHoliday;      <span class="hljs-comment">// true</span>

<span class="hljs-comment">// ä¸æ˜¯å­¦ç”Ÿæˆ–å·²ç»æ¯•ä¸š</span>
<span class="hljs-built_in">bool</span> isStudent = <span class="hljs-literal">false</span>;
<span class="hljs-built_in">bool</span> hasGraduated = <span class="hljs-literal">false</span>;
<span class="hljs-built_in">bool</span> isNotStudentOrGraduated = !isStudent || hasGraduated;  <span class="hljs-comment">// true</span>
</code></pre>
<h3 data-id="heading-14">if æ¡ä»¶è¯­å¥</h3>
<p>æ¡ä»¶è¯­å¥è®©ç¨‹åºèƒ½å¤Ÿæ ¹æ®ä¸åŒæƒ…å†µæ‰§è¡Œä¸åŒçš„ä»£ç ã€‚</p>
<h4 data-id="heading-15">åŸºæœ¬è¯­æ³•</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">if</span> (æ¡ä»¶)
{
    <span class="hljs-comment">// æ¡ä»¶ä¸º true æ—¶æ‰§è¡Œçš„ä»£ç </span>
}
</code></pre>
<h4 data-id="heading-16">ç¤ºä¾‹</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> age = <span class="hljs-number">18</span>;

<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span>)
{
    Console.WriteLine(<span class="hljs-string">"ä½ å·²ç»æ˜¯æˆå¹´äººäº†ï¼"</span>);
}
</code></pre>
<h4 data-id="heading-17">if-else è¯­å¥</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">if</span> (æ¡ä»¶)
{
    <span class="hljs-comment">// æ¡ä»¶ä¸º true æ—¶æ‰§è¡Œ</span>
}
<span class="hljs-keyword">else</span>
{
    <span class="hljs-comment">// æ¡ä»¶ä¸º false æ—¶æ‰§è¡Œ</span>
}
</code></pre>
<p><strong>ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> age = <span class="hljs-number">16</span>;

<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span>)
{
    Console.WriteLine(<span class="hljs-string">"æˆå¹´äºº"</span>);
}
<span class="hljs-keyword">else</span>
{
    Console.WriteLine(<span class="hljs-string">"æœªæˆå¹´äºº"</span>);
}
</code></pre>
<h4 data-id="heading-18">if-else if-else è¯­å¥</h4>
<p>å½“æœ‰å¤šä¸ªæ¡ä»¶æ—¶ä½¿ç”¨ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> score = <span class="hljs-number">85</span>;

<span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">90</span>)
{
    Console.WriteLine(<span class="hljs-string">"ä¼˜ç§€"</span>);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">80</span>)
{
    Console.WriteLine(<span class="hljs-string">"è‰¯å¥½"</span>);
}
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">60</span>)
{
    Console.WriteLine(<span class="hljs-string">"åŠæ ¼"</span>);
}
<span class="hljs-keyword">else</span>
{
    Console.WriteLine(<span class="hljs-string">"ä¸åŠæ ¼"</span>);
}

<span class="hljs-comment">// è¾“å‡ºï¼šè‰¯å¥½</span>
</code></pre>
<p><strong>æ‰§è¡Œé€»è¾‘ï¼š</strong></p>
<ol>
<li>ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡åˆ¤æ–­æ¡ä»¶</li>
<li>é‡åˆ°ç¬¬ä¸€ä¸ª <code>true</code> çš„æ¡ä»¶ï¼Œæ‰§è¡Œå¯¹åº”ä»£ç å—</li>
<li>æ‰§è¡Œå®Œåï¼Œè·³è¿‡å‰©ä½™æ‰€æœ‰ <code>else if</code></li>
<li>å¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½ä¸º <code>false</code>ï¼Œæ‰§è¡Œ <code>else</code> ä»£ç å—</li>
</ol>
<h3 data-id="heading-19">ä¸‰å…ƒè¿ç®—ç¬¦ï¼ˆ?:ï¼‰</h3>
<p>ä¸‰å…ƒè¿ç®—ç¬¦æ˜¯ <code>if-else</code> çš„ç®€å†™å½¢å¼ï¼Œé€‚ç”¨äºç®€å•æ¡ä»¶åˆ¤æ–­ã€‚</p>
<h4 data-id="heading-20">åŸºæœ¬è¯­æ³•</h4>
<pre><code class="hljs language-csharp" lang="csharp">æ¡ä»¶ ? å€¼<span class="hljs-number">1</span> : å€¼<span class="hljs-number">2</span>
</code></pre>
<p>å¦‚æœæ¡ä»¶ä¸º <code>true</code>ï¼Œè¿”å›å€¼1ï¼›å¦‚æœä¸º <code>false</code>ï¼Œè¿”å›å€¼2ã€‚</p>
<h4 data-id="heading-21">ç¤ºä¾‹å¯¹æ¯”</h4>
<p><strong>ä½¿ç”¨ if-elseï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> age = <span class="hljs-number">20</span>;
<span class="hljs-built_in">string</span> message;

<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span>)
{
    message = <span class="hljs-string">"æˆå¹´äºº"</span>;
}
<span class="hljs-keyword">else</span>
{
    message = <span class="hljs-string">"æœªæˆå¹´äºº"</span>;
}
</code></pre>
<p><strong>ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> age = <span class="hljs-number">20</span>;
<span class="hljs-built_in">string</span> message = age &gt;= <span class="hljs-number">18</span> ? <span class="hljs-string">"æˆå¹´äºº"</span> : <span class="hljs-string">"æœªæˆå¹´äºº"</span>;
</code></pre>
<p>ä¸€è¡Œä»£ç å®Œæˆç›¸åŒçš„é€»è¾‘ï¼</p>
<h4 data-id="heading-22">æ›´å¤šç¤ºä¾‹</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// åˆ¤æ–­å¥‡å¶æ•°</span>
<span class="hljs-built_in">int</span> number = <span class="hljs-number">7</span>;
<span class="hljs-built_in">string</span> type = number % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> ? <span class="hljs-string">"å¶æ•°"</span> : <span class="hljs-string">"å¥‡æ•°"</span>;

<span class="hljs-comment">// æ¯”è¾ƒå¤§å°</span>
<span class="hljs-built_in">int</span> a = <span class="hljs-number">5</span>, b = <span class="hljs-number">10</span>;
<span class="hljs-built_in">int</span> max = a &gt; b ? a : b;  <span class="hljs-comment">// max = 10</span>

<span class="hljs-comment">// è®¡ç®—ç»å¯¹å€¼</span>
<span class="hljs-built_in">int</span> x = <span class="hljs-number">-5</span>;
<span class="hljs-built_in">int</span> abs = x &gt;= <span class="hljs-number">0</span> ? x : -x;  <span class="hljs-comment">// abs = 5</span>

<span class="hljs-comment">// åµŒå¥—ä½¿ç”¨ï¼ˆä¸æ¨èï¼Œå¯è¯»æ€§å·®ï¼‰</span>
<span class="hljs-built_in">int</span> score = <span class="hljs-number">85</span>;
<span class="hljs-built_in">string</span> grade = score &gt;= <span class="hljs-number">90</span> ? <span class="hljs-string">"ä¼˜ç§€"</span> : score &gt;= <span class="hljs-number">80</span> ? <span class="hljs-string">"è‰¯å¥½"</span> : <span class="hljs-string">"åŠæ ¼"</span>;
</code></pre>
<h4 data-id="heading-23">ä½•æ—¶ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦</h4>
<p>âœ… <strong>é€‚åˆä½¿ç”¨ï¼š</strong> ç®€å•çš„æ¡ä»¶èµ‹å€¼</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> status = isLoggedIn ? <span class="hljs-string">"å·²ç™»å½•"</span> : <span class="hljs-string">"æœªç™»å½•"</span>;
</code></pre>
<p>âŒ <strong>ä¸é€‚åˆä½¿ç”¨ï¼š</strong> å¤æ‚é€»è¾‘æˆ–éœ€è¦å¤šè¡Œä»£ç </p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-comment">// ä¸è¦è¿™æ ·å†™</span>
<span class="hljs-built_in">string</span> result = condition ? VeryLongMethod1() : VeryLongMethod2();
</code></pre>
<h3 data-id="heading-24">å®è·µï¼šæˆç»©ç­‰çº§åˆ¤æ–­</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">Week3Practice</span>
{
    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"è¯·è¾“å…¥ä½ çš„æˆç»©ï¼ˆ0-100ï¼‰ï¼š"</span>);
            <span class="hljs-built_in">string</span> input = Console.ReadLine();
            <span class="hljs-built_in">int</span> score = <span class="hljs-built_in">int</span>.Parse(input);

            <span class="hljs-comment">// ä½¿ç”¨ if-else if-else åˆ¤æ–­ç­‰çº§</span>
            <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">90</span> &amp;&amp; score &lt;= <span class="hljs-number">100</span>)
            {
                Console.WriteLine(<span class="hljs-string">"æˆç»©ç­‰çº§ï¼šä¼˜ç§€"</span>);
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">80</span>)
            {
                Console.WriteLine(<span class="hljs-string">"æˆç»©ç­‰çº§ï¼šè‰¯å¥½"</span>);
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">60</span>)
            {
                Console.WriteLine(<span class="hljs-string">"æˆç»©ç­‰çº§ï¼šåŠæ ¼"</span>);
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">0</span>)
            {
                Console.WriteLine(<span class="hljs-string">"æˆç»©ç­‰çº§ï¼šä¸åŠæ ¼"</span>);
            }
            <span class="hljs-keyword">else</span>
            {
                Console.WriteLine(<span class="hljs-string">"è¾“å…¥é”™è¯¯ï¼"</span>);
            }

            <span class="hljs-comment">// ä½¿ç”¨ä¸‰å…ƒè¿ç®—ç¬¦ç®€åŒ–åˆ¤æ–­</span>
            <span class="hljs-built_in">bool</span> isPass = score &gt;= <span class="hljs-number">60</span>;
            <span class="hljs-built_in">string</span> passMessage = isPass ? <span class="hljs-string">"æ­å–œï¼Œä½ é€šè¿‡äº†è€ƒè¯•ï¼"</span> : <span class="hljs-string">"å¾ˆé—æ†¾ï¼Œä½ æœªé€šè¿‡è€ƒè¯•ã€‚"</span>;
            Console.WriteLine(passMessage);
        }
    }
}
</code></pre>
<h4 data-id="heading-25">è¿è¡Œç¤ºä¾‹</h4>
<pre><code class="hljs">è¯·è¾“å…¥ä½ çš„æˆç»©ï¼ˆ0-100ï¼‰ï¼š
85
æˆç»©ç­‰çº§ï¼šè‰¯å¥½
æ­å–œï¼Œä½ é€šè¿‡äº†è€ƒè¯•ï¼
</code></pre>
<h3 data-id="heading-26">å®è·µï¼šç®€å•è®¡ç®—å™¨ï¼ˆä½¿ç”¨ if-elseï¼‰</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">Week3Practice</span>
{
    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"===== ç®€å•è®¡ç®—å™¨ ====="</span>);

            Console.Write(<span class="hljs-string">"è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š"</span>);
            <span class="hljs-built_in">double</span> num1 = <span class="hljs-built_in">double</span>.Parse(Console.ReadLine());

            Console.Write(<span class="hljs-string">"è¯·è¾“å…¥è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰ï¼š"</span>);
            <span class="hljs-built_in">string</span> op = Console.ReadLine();

            Console.Write(<span class="hljs-string">"è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š"</span>);
            <span class="hljs-built_in">double</span> num2 = <span class="hljs-built_in">double</span>.Parse(Console.ReadLine());

            <span class="hljs-built_in">double</span> result = <span class="hljs-number">0</span>;
            <span class="hljs-built_in">bool</span> isValid = <span class="hljs-literal">true</span>;

            <span class="hljs-comment">// ä½¿ç”¨ if-else if åˆ¤æ–­è¿ç®—ç¬¦</span>
            <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"+"</span>)
            {
                result = num1 + num2;
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"-"</span>)
            {
                result = num1 - num2;
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"*"</span>)
            {
                result = num1 * num2;
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"/"</span>)
            {
                <span class="hljs-keyword">if</span> (num2 != <span class="hljs-number">0</span>)  <span class="hljs-comment">// é¿å…é™¤ä»¥é›¶</span>
                {
                    result = num1 / num2;
                }
                <span class="hljs-keyword">else</span>
                {
                    Console.WriteLine(<span class="hljs-string">"é”™è¯¯ï¼šé™¤æ•°ä¸èƒ½ä¸ºé›¶ï¼"</span>);
                    isValid = <span class="hljs-literal">false</span>;
                }
            }
            <span class="hljs-keyword">else</span>
            {
                Console.WriteLine(<span class="hljs-string">"é”™è¯¯ï¼šä¸æ”¯æŒçš„è¿ç®—ç¬¦ï¼"</span>);
                isValid = <span class="hljs-literal">false</span>;
            }

            <span class="hljs-keyword">if</span> (isValid)
            {
                Console.WriteLine(<span class="hljs-string">$"ç»“æœï¼š<span class="hljs-subst">{num1}</span> <span class="hljs-subst">{op}</span> <span class="hljs-subst">{num2}</span> = <span class="hljs-subst">{result}</span>"</span>);
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-27">è¿è¡Œç¤ºä¾‹</h4>
<pre><code class="hljs language-ini" lang="ini">===== ç®€å•è®¡ç®—å™¨ =====
è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š10
è¯·è¾“å…¥è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰ï¼š*
è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š5
ç»“æœï¼š10 * <span class="hljs-attr">5</span> = <span class="hljs-number">50</span>
</code></pre>
<h3 data-id="heading-28">switch è¯­å¥</h3>
<p>å½“éœ€è¦æ ¹æ®åŒä¸€ä¸ªå˜é‡è¿›è¡Œå¤šé‡é€‰æ‹©æ—¶ï¼Œ<code>switch</code> è¯­å¥æ¯” <code>if-else if</code> æ›´æ¸…æ™°ç®€æ´ã€‚</p>
<h4 data-id="heading-29">åŸºæœ¬è¯­æ³•</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">switch</span> (è¡¨è¾¾å¼)
{
    <span class="hljs-keyword">case</span> å€¼<span class="hljs-number">1</span>:
        <span class="hljs-comment">// å½“è¡¨è¾¾å¼ç­‰äº å€¼1 æ—¶æ‰§è¡Œ</span>
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> å€¼<span class="hljs-number">2</span>:
        <span class="hljs-comment">// å½“è¡¨è¾¾å¼ç­‰äº å€¼2 æ—¶æ‰§è¡Œ</span>
        <span class="hljs-keyword">break</span>;
    <span class="hljs-literal">default</span>:
        <span class="hljs-comment">// å½“æ‰€æœ‰ case éƒ½ä¸åŒ¹é…æ—¶æ‰§è¡Œ</span>
        <span class="hljs-keyword">break</span>;
}
</code></pre>
<h4 data-id="heading-30">ç¤ºä¾‹ï¼šåˆ¤æ–­æ˜ŸæœŸ</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> dayOfWeek = <span class="hljs-number">3</span>;  <span class="hljs-comment">// å‡è®¾ 1=å‘¨ä¸€, 2=å‘¨äºŒ, ..., 7=å‘¨æ—¥</span>

<span class="hljs-keyword">switch</span> (dayOfWeek)
{
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        Console.WriteLine(<span class="hljs-string">"å‘¨ä¸€"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        Console.WriteLine(<span class="hljs-string">"å‘¨äºŒ"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
        Console.WriteLine(<span class="hljs-string">"å‘¨ä¸‰"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
        Console.WriteLine(<span class="hljs-string">"å‘¨å››"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
        Console.WriteLine(<span class="hljs-string">"å‘¨äº”"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:
        Console.WriteLine(<span class="hljs-string">"å‘¨å…­"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:
        Console.WriteLine(<span class="hljs-string">"å‘¨æ—¥"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-literal">default</span>:
        Console.WriteLine(<span class="hljs-string">"æ— æ•ˆçš„æ˜ŸæœŸ"</span>);
        <span class="hljs-keyword">break</span>;
}
</code></pre>
<h4 data-id="heading-31">switch vs if-else if</h4>
<p><strong>ä½¿ç”¨ if-else ifï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> op = <span class="hljs-string">"+"</span>;
<span class="hljs-built_in">double</span> result = <span class="hljs-number">0</span>;

<span class="hljs-keyword">if</span> (op == <span class="hljs-string">"+"</span>)
    result = num1 + num2;
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"-"</span>)
    result = num1 - num2;
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"*"</span>)
    result = num1 * num2;
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-string">"/"</span>)
    result = num1 / num2;
</code></pre>
<p><strong>ä½¿ç”¨ switchï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> op = <span class="hljs-string">"+"</span>;
<span class="hljs-built_in">double</span> result = <span class="hljs-number">0</span>;

<span class="hljs-keyword">switch</span> (op)
{
    <span class="hljs-keyword">case</span> <span class="hljs-string">"+"</span>:
        result = num1 + num2;
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"-"</span>:
        result = num1 - num2;
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"*"</span>:
        result = num1 * num2;
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"/"</span>:
        result = num1 / num2;
        <span class="hljs-keyword">break</span>;
}
</code></pre>
<h4 data-id="heading-32">when æ¡ä»¶ï¼ˆC# 7.0+ï¼‰</h4>
<p>å¯ä»¥åœ¨ case ä¸­æ·»åŠ é¢å¤–æ¡ä»¶ï¼š</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> score = <span class="hljs-number">85</span>;

<span class="hljs-keyword">switch</span> (score)
{
    <span class="hljs-keyword">case</span> <span class="hljs-built_in">int</span> s <span class="hljs-keyword">when</span> s &gt;= <span class="hljs-number">90</span>:
        Console.WriteLine(<span class="hljs-string">"ä¼˜ç§€"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-built_in">int</span> s <span class="hljs-keyword">when</span> s &gt;= <span class="hljs-number">80</span>:
        Console.WriteLine(<span class="hljs-string">"è‰¯å¥½"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-built_in">int</span> s <span class="hljs-keyword">when</span> s &gt;= <span class="hljs-number">60</span>:
        Console.WriteLine(<span class="hljs-string">"åŠæ ¼"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-literal">default</span>:
        Console.WriteLine(<span class="hljs-string">"ä¸åŠæ ¼"</span>);
        <span class="hljs-keyword">break</span>;
}
</code></pre>
<h4 data-id="heading-33">å¤šä¸ª case å…±ç”¨ä»£ç </h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> month = <span class="hljs-number">7</span>;

<span class="hljs-keyword">switch</span> (month)
{
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
        Console.WriteLine(<span class="hljs-string">"æ˜¥å­£"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:
        Console.WriteLine(<span class="hljs-string">"å¤å­£"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">9</span>:
        Console.WriteLine(<span class="hljs-string">"ç§‹å­£"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">10</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">11</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-number">12</span>:
        Console.WriteLine(<span class="hljs-string">"å†¬å­£"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-literal">default</span>:
        Console.WriteLine(<span class="hljs-string">"æ— æ•ˆçš„æœˆä»½"</span>);
        <span class="hljs-keyword">break</span>;
}
</code></pre>
<h4 data-id="heading-34">å­—ç¬¦ä¸²åŒ¹é…</h4>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> role = <span class="hljs-string">"admin"</span>;

<span class="hljs-keyword">switch</span> (role)
{
    <span class="hljs-keyword">case</span> <span class="hljs-string">"admin"</span>:
        Console.WriteLine(<span class="hljs-string">"ç®¡ç†å‘˜æƒé™"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"user"</span>:
        Console.WriteLine(<span class="hljs-string">"æ™®é€šç”¨æˆ·æƒé™"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"guest"</span>:
        Console.WriteLine(<span class="hljs-string">"è®¿å®¢æƒé™"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-literal">default</span>:
        Console.WriteLine(<span class="hljs-string">"æœªçŸ¥è§’è‰²"</span>);
        <span class="hljs-keyword">break</span>;
}
</code></pre>
<h4 data-id="heading-35">å¿…é¡»ä½¿ç”¨ break æˆ– return</h4>
<p>æ¯ä¸ª case å¿…é¡»ä»¥ <code>break</code>ã€<code>return</code>ã€<code>throw</code> æˆ– <code>goto</code> ç»“æŸï¼Œé¿å…ä»£ç "ç©¿é€"åˆ°ä¸‹ä¸€ä¸ª caseã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> num = <span class="hljs-number">2</span>;

<span class="hljs-keyword">switch</span> (num)
{
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        Console.WriteLine(<span class="hljs-string">"ä¸€"</span>);
        <span class="hljs-keyword">break</span>;  <span class="hljs-comment">// å¿…é¡»æœ‰ break</span>
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        Console.WriteLine(<span class="hljs-string">"äºŒ"</span>);
        <span class="hljs-keyword">break</span>;
    <span class="hljs-comment">// å¦‚æœå¿˜è®° breakï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™</span>
}
</code></pre>
<h4 data-id="heading-36">è¿”å›å€¼çš„ switch è¡¨è¾¾å¼ï¼ˆC# 8.0+ï¼‰</h4>
<p><strong>ç®€æ´å†™æ³•ï¼ˆswitch è¡¨è¾¾å¼ï¼‰ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">string</span> op = <span class="hljs-string">"+"</span>;
<span class="hljs-built_in">double</span> result = op <span class="hljs-keyword">switch</span>
{
    <span class="hljs-string">"+"</span> =&gt; num1 + num2,
    <span class="hljs-string">"-"</span> =&gt; num1 - num2,
    <span class="hljs-string">"*"</span> =&gt; num1 * num2,
    <span class="hljs-string">"/"</span> =&gt; num1 / num2,
    _ =&gt; <span class="hljs-number">0</span>  <span class="hljs-comment">// _ è¡¨ç¤º default</span>
};
</code></pre>
<p>è¿™æ¯”ä¼ ç»Ÿ switch æ›´ç®€æ´ï¼</p>
<p><strong>å¸¦ when æ¡ä»¶çš„ switch è¡¨è¾¾å¼ï¼š</strong></p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-built_in">int</span> score = <span class="hljs-number">85</span>;

<span class="hljs-built_in">string</span> grade = score <span class="hljs-keyword">switch</span>
{
    <span class="hljs-built_in">int</span> s <span class="hljs-keyword">when</span> s &gt;= <span class="hljs-number">90</span> =&gt; <span class="hljs-string">"ä¼˜ç§€"</span>,
    <span class="hljs-built_in">int</span> s <span class="hljs-keyword">when</span> s &gt;= <span class="hljs-number">80</span> =&gt; <span class="hljs-string">"è‰¯å¥½"</span>,
    <span class="hljs-built_in">int</span> s <span class="hljs-keyword">when</span> s &gt;= <span class="hljs-number">60</span> =&gt; <span class="hljs-string">"åŠæ ¼"</span>,
    _ =&gt; <span class="hljs-string">"ä¸åŠæ ¼"</span>
};
</code></pre>
<h4 data-id="heading-37">ä½•æ—¶ä½¿ç”¨ switch</h4>
<p>âœ… <strong>é€‚åˆä½¿ç”¨ switchï¼š</strong></p>
<ul>
<li>æ ¹æ®åŒä¸€ä¸ªå˜é‡çš„ä¸åŒå€¼æ‰§è¡Œä¸åŒæ“ä½œ</li>
<li>case æ¯”è¾ƒå¤šï¼ˆè¶…è¿‡ 3 ä¸ªï¼‰</li>
<li>éœ€è¦æ¸…æ™°çš„ä»£ç ç»“æ„</li>
</ul>
<p>âŒ <strong>ä¸é€‚åˆä½¿ç”¨ switchï¼š</strong></p>
<ul>
<li>æ¡ä»¶æ¶‰åŠå¤šä¸ªå˜é‡</li>
<li>éœ€è¦å¤æ‚çš„é€»è¾‘åˆ¤æ–­ï¼ˆå¦‚èŒƒå›´åˆ¤æ–­ï¼‰</li>
</ul>
<h3 data-id="heading-38">å®è·µï¼šæ”¹è¿›çš„è®¡ç®—å™¨ï¼ˆä½¿ç”¨ switchï¼‰</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">Week3Practice</span>
{
    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"===== ç®€å•è®¡ç®—å™¨ ====="</span>);

            Console.Write(<span class="hljs-string">"è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š"</span>);
            <span class="hljs-built_in">double</span> num1 = <span class="hljs-built_in">double</span>.Parse(Console.ReadLine());

            Console.Write(<span class="hljs-string">"è¯·è¾“å…¥è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰ï¼š"</span>);
            <span class="hljs-built_in">string</span> op = Console.ReadLine();

            Console.Write(<span class="hljs-string">"è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š"</span>);
            <span class="hljs-built_in">double</span> num2 = <span class="hljs-built_in">double</span>.Parse(Console.ReadLine());

            <span class="hljs-built_in">double</span> result = <span class="hljs-number">0</span>;
            <span class="hljs-built_in">bool</span> isValid = <span class="hljs-literal">true</span>;

            <span class="hljs-comment">// ä½¿ç”¨ switch åˆ¤æ–­è¿ç®—ç¬¦ï¼ˆæ›´æ¸…æ™°ï¼‰</span>
            <span class="hljs-keyword">switch</span> (op)
            {
                <span class="hljs-keyword">case</span> <span class="hljs-string">"+"</span>:
                    result = num1 + num2;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"-"</span>:
                    result = num1 - num2;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"*"</span>:
                    result = num1 * num2;
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">"/"</span>:
                    <span class="hljs-keyword">if</span> (num2 != <span class="hljs-number">0</span>)
                    {
                        result = num1 / num2;
                    }
                    <span class="hljs-keyword">else</span>
                    {
                        Console.WriteLine(<span class="hljs-string">"é”™è¯¯ï¼šé™¤æ•°ä¸èƒ½ä¸ºé›¶ï¼"</span>);
                        isValid = <span class="hljs-literal">false</span>;
                    }
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-literal">default</span>:
                    Console.WriteLine(<span class="hljs-string">"é”™è¯¯ï¼šä¸æ”¯æŒçš„è¿ç®—ç¬¦ï¼"</span>);
                    isValid = <span class="hljs-literal">false</span>;
                    <span class="hljs-keyword">break</span>;
            }

            <span class="hljs-keyword">if</span> (isValid)
            {
                Console.WriteLine(<span class="hljs-string">$"ç»“æœï¼š<span class="hljs-subst">{num1}</span> <span class="hljs-subst">{op}</span> <span class="hljs-subst">{num2}</span> = <span class="hljs-subst">{result}</span>"</span>);
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-39">è¿è¡Œç¤ºä¾‹</h4>
<pre><code class="hljs language-ini" lang="ini">===== ç®€å•è®¡ç®—å™¨ =====
è¯·è¾“å…¥ç¬¬ä¸€ä¸ªæ•°å­—ï¼š10
è¯·è¾“å…¥è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰ï¼š*
è¯·è¾“å…¥ç¬¬äºŒä¸ªæ•°å­—ï¼š5
ç»“æœï¼š10 * <span class="hljs-attr">5</span> = <span class="hljs-number">50</span>
</code></pre>
<h3 data-id="heading-40">å®è·µï¼šæœˆä»½åˆ¤æ–­ï¼ˆä½¿ç”¨ switchï¼‰</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">using</span> System;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">Week3Practice</span>
{
    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
        {
            Console.WriteLine(<span class="hljs-string">"===== æœˆä»½å­£èŠ‚åˆ¤æ–­ ====="</span>);
            Console.Write(<span class="hljs-string">"è¯·è¾“å…¥æœˆä»½ï¼ˆ1-12ï¼‰ï¼š"</span>);
            <span class="hljs-built_in">int</span> month = <span class="hljs-built_in">int</span>.Parse(Console.ReadLine());

            <span class="hljs-built_in">string</span> season = month <span class="hljs-keyword">switch</span>
            {
                <span class="hljs-built_in">int</span> m <span class="hljs-keyword">when</span> m &gt;= <span class="hljs-number">3</span> &amp;&amp; m &lt;= <span class="hljs-number">5</span> =&gt; <span class="hljs-string">"æ˜¥å­£"</span>,
                <span class="hljs-built_in">int</span> m <span class="hljs-keyword">when</span> m &gt;= <span class="hljs-number">6</span> &amp;&amp; m &lt;= <span class="hljs-number">8</span> =&gt; <span class="hljs-string">"å¤å­£"</span>,
                <span class="hljs-built_in">int</span> m <span class="hljs-keyword">when</span> m &gt;= <span class="hljs-number">9</span> &amp;&amp; m &lt;= <span class="hljs-number">11</span> =&gt; <span class="hljs-string">"ç§‹å­£"</span>,
                <span class="hljs-number">12</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">2</span> =&gt; <span class="hljs-string">"å†¬å­£"</span>,  <span class="hljs-comment">// å¤šå€¼åŒ¹é…ï¼ˆC# 9.0+ï¼‰</span>
                _ =&gt; <span class="hljs-string">"æ— æ•ˆçš„æœˆä»½"</span>
            };

            Console.WriteLine(<span class="hljs-string">$"<span class="hljs-subst">{month}</span>æœˆå±äº<span class="hljs-subst">{season}</span>"</span>);
        }
    }
}
</code></pre>
<h4 data-id="heading-41">è¿è¡Œç¤ºä¾‹</h4>
<pre><code class="hljs language-diff" lang="diff"><span class="hljs-comment">===== æœˆä»½å­£èŠ‚åˆ¤æ–­ =====</span>
è¯·è¾“å…¥æœˆä»½ï¼ˆ1-12ï¼‰ï¼š7
7æœˆå±äºå¤å­£
</code></pre>
<h3 data-id="heading-42">æœ¬ç« æ€»ç»“</h3>
<ul>
<li>âœ… æŒæ¡äº†ç®—æœ¯è¿ç®—ç¬¦ï¼š<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code></li>
<li>âœ… å­¦ä¼šäº†æ¯”è¾ƒè¿ç®—ç¬¦ï¼š<code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code></li>
<li>âœ… ç†è§£äº†é€»è¾‘è¿ç®—ç¬¦ï¼š<code>&amp;&amp;</code>, <code>||</code>, <code>!</code></li>
<li>âœ… æŒæ¡äº† if-else æ¡ä»¶è¯­å¥</li>
<li>âœ… å­¦ä¼šäº† switch è¯­å¥è¿›è¡Œå¤šé‡é€‰æ‹©</li>
<li>âœ… æŒæ¡äº†ä¸‰å…ƒè¿ç®—ç¬¦ç®€åŒ–ä»£ç </li>
<li>âœ… å®è·µäº†æˆç»©åˆ¤æ–­å’Œç®€å•è®¡ç®—å™¨</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[2025 å¹´ Vue ç”Ÿæ€æ˜æ˜Ÿé¡¹ç›®]]></title>    <link>https://juejin.cn/post/7596990822128156710</link>    <guid>https://juejin.cn/post/7596990822128156710</guid>    <pubDate>2026-01-20T07:26:02.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596990822128156710" data-draft-id="7596955804261695538" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="2025 å¹´ Vue ç”Ÿæ€æ˜æ˜Ÿé¡¹ç›®"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js"/> <meta itemprop="datePublished" content="2026-01-20T07:26:02.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å­¦ä»€ä¹ˆå‰ç«¯"/> <meta itemprop="url" content="https://juejin.cn/user/3825956194889880"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            2025 å¹´ Vue ç”Ÿæ€æ˜æ˜Ÿé¡¹ç›®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3825956194889880/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å­¦ä»€ä¹ˆå‰ç«¯
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:26:02.000Z" title="Tue Jan 20 2026 07:26:02 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    22
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>2025 å¹´æ˜¯ä¸å¹³å‡¡çš„ä¸€å¹´ï¼Œä» AI çˆ†å‘å¼å¢é•¿å½»åº•æ”¹å˜äº†æˆ‘ä»¬å¼€å‘åº”ç”¨çš„æ–¹å¼ï¼Œ åˆ°ä¸¥é‡æ¼æ´å’Œå®‰å…¨æ”»å‡»éœ‡æ’¼æ•´ä¸ªç”Ÿæ€ç³»ç»Ÿçš„ä¸¥å³»æŒ‘æˆ˜ï¼Œ2025å¹´æ˜¯åˆ›æ–°ä¸æŒ‘æˆ˜å¹¶å­˜çš„ä¸€å¹´ã€‚</p>
<p>è€Œåœ¨å‰ç«¯çš„å‘å±•ä¸­ï¼ŒVue ç”Ÿæ€åœ¨è¿™ä¸€å¹´åˆç»å†äº†å“ªäº›å˜åŒ–ï¼Ÿä¸‹é¢ <strong><a href="https://link.juejin.cn?target=https%3A%2F%2Frisingstars.js.org%2F2025%2Fzh%23section-vue" target="_blank" title="https://risingstars.js.org/2025/zh#section-vue" ref="nofollow noopener noreferrer">Best of JS</a></strong> æ¯”è¾ƒäº†è¿‡å» 12 ä¸ªæœˆåœ¨ <strong>GitHub</strong> ä¸Šè·å¾—çš„ <strong>Star</strong>ï¼Œæ¥å›é¡¾ä¸€ä¸‹æ•´ä¸ª Vue ç”Ÿæ€çš„ä¸€ä¸ªå‘å±•ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55de42a4ecca4edc9e75ada6f043662c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=%2F90hqOSwB7H%2FaiOq61QKTxcA5TE%3D" alt="" loading="lazy"/></p>
<p>æˆ‘ä»¬æŠŠæ•´ä¸ªç”Ÿæ€ <strong>2025 å¹´</strong>çš„å‘å±•å¤§è‡´åˆ’åˆ†ä¸ºä»¥ä¸‹ 3 ä¸ªæ–¹é¢ï¼š</p>
<h2 data-id="heading-0">å¼€å‘è€…ç”Ÿäº§åŠ›å·¥å…·</h2>
<ol>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fsli.dev%2F" target="_blank" title="https://sli.dev/" ref="nofollow noopener noreferrer">Slidev (+9.3k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f672ea4353e4c918c73a3f02e699dad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=SFoYh%2B%2BrbJdyUEdHVlelwrjqYLQ%3D" alt="" loading="lazy"/></p>
<p>å¼€å‘è€…çš„æ¼”ç¤ºå¹»ç¯ç‰‡å·¥å…· ã€‚</p>
<p>è¿™å°±å¥½æ¯”æ˜¯ç”¨å†™ä»£ç çš„æ–¹å¼ï¼ˆMarkdownï¼‰æ¥åš PPTã€‚å®ƒæ”¯æŒä»£ç é«˜äº®ã€å®æ—¶é¢„è§ˆç­‰åŠŸèƒ½ï¼Œè¿˜èƒ½ç›´æ¥åœ¨ PPT é‡Œè¿è¡Œ Vue ç»„ä»¶ã€‚</p>
<p>é€‚ç”¨åœºæ™¯ï¼šæŠ€æœ¯åˆ†äº«ã€ä»£ç æ•™å­¦ã€å†…éƒ¨æŠ€æœ¯è¯„å®¡ã€‚</p>
<ol start="5">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvitepress.dev%2F" target="_blank" title="https://vitepress.dev/" ref="nofollow noopener noreferrer">VitePress (+3.2k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69a28edca94946aaab8b73c66c0a7189~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=TmQCojHmfRHyvhNp98nMCZHeJ%2FU%3D" alt="" loading="lazy"/></p>
<p>åŸºäº Vite å’Œ Vue çš„é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ã€‚</p>
<p>Vue å®˜æ–¹æ¨èçš„æ–‡æ¡£ç”Ÿæˆå·¥å…·ã€‚å®ƒæå¿«ã€ç®€æ´ï¼Œç°åœ¨å¾ˆå¤š Vue é¡¹ç›®çš„å®˜æ–¹æ–‡æ¡£å°±æ˜¯ç”¨å®ƒå†™çš„ã€‚</p>
<p>é€‚ç”¨åœºæ™¯ï¼šé¡¹ç›®æ–‡æ¡£ã€ç®€å•çš„åšå®¢ã€ä¸ªäººä¸»é¡µã€‚</p>
<ol start="9">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FPanJiaChen%2Fvue-element-admin" target="_blank" title="https://github.com/PanJiaChen/vue-element-admin" ref="nofollow noopener noreferrer">Vue Element Admin (+1.8k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0fd9ae2185f4345a7a57af4d83a7ed7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=FsaeIO5Xte0LW%2F35%2FCAnl%2FTsgPs%3D" alt="" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40161c51b556481e8c9b0e36998915df~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=uQ6Gj7K%2Bg6wZFj1t6OcA7yQKR5g%3D" alt="" loading="lazy"/></p>
<p>ä¸€ä¸ªç¥å¥‡çš„ Vue åå°ç®¡ç†ï¼Œè®©äººæ„Ÿåˆ°ä¸å¯æ€è®®çš„æ˜¯ï¼Œè¿™æ˜¯ä¸€ä¸ª <code>Vue2 é¡¹ç›®</code>ã€‚</p>
<p>éå¸¸ç»å…¸çš„ã€å…ƒè€çº§çš„åå°ç®¡ç†ç³»ç»Ÿè§£å†³æ–¹æ¡ˆã€‚è™½ç„¶ç°åœ¨æœ‰äº†å¾ˆå¤šæ–°é€‰æ‹©ï¼Œä½†å®ƒä¾ç„¶æ˜¯å¾ˆå¤šä¼ä¸šåå°ç³»ç»Ÿçš„å‚è€ƒæ¨¡æ¿ã€‚</p>
<p>é€‚ç”¨åœºæ™¯ï¼šå¿«é€Ÿæ­å»ºä¼ä¸šçº§ä¸­åå°ç®¡ç†ç³»ç»Ÿã€‚</p>
<h2 data-id="heading-1">æ ¸å¿ƒæ¡†æ¶</h2>
<ol start="2">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fnuxt.com%2F" target="_blank" title="https://nuxt.com/" ref="nofollow noopener noreferrer">Nuxt (+3.7k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fe62a7de140e4fd38d9e3c22e731b2b1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=TBAiYF2Q5Uzk%2BtS1YyjC0GuAB%2FY%3D" alt="" loading="lazy"/></p>
<p>æ¸è¿›å¼ Web SSR æ¡†æ¶ ã€‚</p>
<p>å¦‚æœè¯´ Vue æ˜¯å¼•æ“ï¼Œé‚£ Nuxt å°±æ˜¯ä¸€è¾†é€ å¥½çš„æ•´è½¦ã€‚å®ƒæä¾›äº†æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR)ã€è‡ªåŠ¨è·¯ç”±ã€SEO ä¼˜åŒ–ç­‰å…¨å¥—åŠŸèƒ½ã€‚</p>
<p>é€‚ç”¨åœºæ™¯ï¼šéœ€è¦ SEO çš„å®˜ç½‘ã€å¤§å‹å¤æ‚çš„ Web åº”ç”¨ã€‚</p>
<h2 data-id="heading-2">ğŸ¨ UI ç»„ä»¶åº“ä¸è®¾è®¡ç³»ç»Ÿ</h2>
<p>UI ç»„ä»¶åº“çš„ç«äº‰æ˜¯æœ€æ¿€çƒˆçš„ï¼Œå‘ˆç°å‡º <strong>â€œä¼ ç»Ÿâ€</strong> ä¸ <strong>â€œæ–°å…´â€</strong> ä¸¤ç§æµæ´¾ï¼š</p>
<ol start="3">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fvue-bits.dev%2F" target="_blank" title="https://vue-bits.dev/" ref="nofollow noopener noreferrer">Vue Bits (+3.5k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5d6b43d2f3684ee4bc25bc80189d8f49~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=FXfgurazKjpdRs9mYKazlgekQ%2Fc%3D" alt="" loading="lazy"/></p>
<p>å¼€æºçš„åŠ¨ç”»ä¸äº¤äº’ç»„ä»¶é›†åˆã€‚</p>
<p>å’Œæˆ‘ä»¬æ—©æœŸæ¨èçš„ <a href="https://juejin.cn/post/7554572856147984424" target="_blank" title="https://juejin.cn/post/7554572856147984424">inspira-ui</a> ç±»ä¼¼ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„é€šç”¨ UI åº“ï¼Œè€Œæ›´åƒæ˜¯ä¸€ä¸ª<strong>ç‰¹æ•ˆåº“</strong>ã€‚å®ƒä¸“æ³¨äºæä¾›é‚£äº›ç‚«é…·çš„ã€åŠ¨æ•ˆä¸°å¯Œçš„ç»„ä»¶ï¼Œèƒ½è®©ç½‘é¡µç¬é—´å˜å¾—é«˜å¤§ä¸Šã€‚</p>
<p>Vue çš„ç‰¹æ•ˆåº“åˆå¤šäº†ä¸€ä¸ªé€‰æ‹©ã€‚</p>
<ol start="4">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.shadcn-vue.com%2F" target="_blank" title="https://www.shadcn-vue.com/" ref="nofollow noopener noreferrer">shadcn-vue (+3.4k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c19031c220fb475dbf7756960d5b8f0e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=DZyp%2BZKS2Qwy4PNxnBrNX4SJuss%3D" alt="" loading="lazy"/></p>
<p>shadcn-ui çš„ Vue ç§»æ¤ç‰ˆã€‚</p>
<p>ç›®å‰çš„<code>å½“çº¢ç‚¸å­é¸¡</code>ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªè®©ä½  npm install çš„åº“ï¼Œè€Œæ˜¯è®©ä½ æŠŠä»£ç â€œå¤åˆ¶ç²˜è´´â€åˆ°é¡¹ç›®é‡Œè‡ªå·±æ”¹ã€‚è¿™ç»™äº†å¼€å‘è€…æå¤§çš„æ§åˆ¶æƒï¼Œä¸å†å—é™äºç»„ä»¶åº“åŸæœ¬çš„æ ·å¼ï¼Œå¯¹äºéœ€è¦é«˜åº¦å®šåˆ¶åŒ–çš„åº”ç”¨æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚</p>
<ol start="6">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fprimevue.org%2F" target="_blank" title="https://primevue.org/" ref="nofollow noopener noreferrer">PrimeVue (+2.7k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7693c4bb29e3452792b99af1fe038dad~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=0qFky7aMJHQ9x8f8jRjweRyg560%3D" alt="" loading="lazy"/></p>
<p>æ¬¡ä¸–ä»£ Vue UI ç»„ä»¶åº“ã€‚</p>
<p>åŠŸèƒ½æå…¶ä¸°å¯Œçš„å¤§è€Œå…¨ç»„ä»¶åº“ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ç»„ä»¶å¤šï¼ˆå›¾è¡¨ã€åœ°å›¾ã€ç¼–è¾‘å™¨éƒ½æœ‰ï¼‰ä¸”ä¸»é¢˜ç³»ç»Ÿéå¸¸å¼ºå¤§ï¼Œç”šè‡³æ”¯æŒæ— æ ·å¼æ¨¡å¼ã€‚</p>
<ol start="7">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Freka-ui.com%2F" target="_blank" title="https://reka-ui.com/" ref="nofollow noopener noreferrer">Radix Vue (+2.1k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0b6b0e53915466098968e956422f034~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=ZDeDPvnhSdn%2FD%2BvRmansurzUcZo%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>â˜…</p>
<p>æœ€æ–°çš„ V2 ç‰ˆæœ¬å·²ç»å‡çº§ä¸º Reka UIã€‚</p>
</blockquote>
<p>ç”¨äºæ„å»ºé«˜è´¨é‡ UI çš„å¼€æºç»„ä»¶åº“ã€‚</p>
<p>Headless UIï¼ˆæ— å¤´ç»„ä»¶ï¼‰ çš„ä»£è¡¨ã€‚å®ƒåªæä¾›åŠŸèƒ½ï¼ˆæ¯”å¦‚ä¸‹æ‹‰èœå•çš„äº¤äº’é€»è¾‘ã€æ— éšœç¢è®¿é—®ï¼‰ï¼Œä¸æä¾›ä»»ä½•æ ·å¼ã€‚æ ·å¼å®Œå…¨ç”±ä½ å†³å®šã€‚shadcn-vue åº•å±‚å°±æ˜¯ç”¨çš„å®ƒã€‚</p>
<ol start="8">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Felement-plus.org%2Fzh-CN%2F" target="_blank" title="https://element-plus.org/zh-CN/" ref="nofollow noopener noreferrer">Element Plus (+2.1k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f0b057cc35764bab85074a633f8603b6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=CyvC7xeGQDb6JmU9KpX2JCR%2FIwA%3D" alt="" loading="lazy"/></p>
<p>Element å›¢é˜Ÿåˆ¶ä½œçš„ Vue 3 UI åº“ã€‚</p>
<p>å›½å†…å¼€å‘è€…çš„è€æœ‹å‹ã€‚å®ƒæ˜¯ Element UI çš„ Vue 3 ç‰ˆæœ¬ï¼Œä¸ä»…ç¨³å®šï¼Œè€Œä¸”ç¤¾åŒºèµ„æºæå…¶ä¸°å¯Œï¼Œæ˜¯å¾ˆå¤šå›½å†…å…¬å¸çš„é¦–é€‰ã€‚</p>
<ol start="10">
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fui.nuxt.com%2F" target="_blank" title="https://ui.nuxt.com/" ref="nofollow noopener noreferrer">Nuxt UI (+1.8k stars)</a></li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc6c210f706941f7a88167298c65d831~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=OA%2BEhGaVuHecqBRfqSxgDID%2BX4U%3D" alt="" loading="lazy"/></p>
<p>åŸºäº Reka UI å’Œ Tailwind CSS çš„ UI åº“ã€‚</p>
<p>ä¸“é—¨ä¸º Nuxt æ¡†æ¶æ‰“é€ çš„ UI åº“ï¼Œæ·±åº¦é›†æˆï¼Œå¼€å‘ä½“éªŒéå¸¸ä¸æ»‘ï¼Œä¸”é»˜è®¤é£æ ¼å¾ˆç°ä»£åŒ–ã€‚</p>
<h2 data-id="heading-3">Vue å®˜æ–¹</h2>
<p>é‚£ Vue å®˜æ–¹ 2025 å¹´åˆåšäº†å“ªäº›å·¥ä½œå‘¢ï¼Ÿ</p>
<h3 data-id="heading-4">Vue3</h3>



































<table><thead><tr><th>æ—¶é—´</th><th>æ ¸å¿ƒå·¥ä½œå†…å®¹</th><th>å…³é”®å½±å“</th></tr></thead><tbody><tr><td>2025å¹´ Q1</td><td>Vapor Mode (è’¸æ±½æ¨¡å¼) æ ¸å¿ƒåŠŸèƒ½ç¨³å®š ğŸ§ª</td><td>Vue å¼€å§‹è„±ç¦»è™šæ‹Ÿ DOMã€‚å¯¹äºæè‡´æ€§èƒ½è¦æ±‚çš„åœºæ™¯ï¼Œæ‰“åŒ…ä½“ç§¯å°†å‡å°ï¼Œé€Ÿåº¦æ›´å¿«ã€‚</td></tr><tr><td>2025å¹´ Q2</td><td>Vite + Rolldown æ·±åº¦é›†æˆ âš¡</td><td>Vite çš„åº•å±‚æ‰“åŒ…å¼•æ“åˆ‡æ¢ä¸º Rust ç¼–å†™çš„ Rolldownã€‚é¡¹ç›®çš„æ‰“åŒ…é€Ÿåº¦å°†è¿æ¥æ•°å€ç”šè‡³åå€çš„æå‡ã€‚</td></tr><tr><td>2025å¹´ Q3</td><td>Vue 3.6 ç‰ˆæœ¬å‘å¸ƒ ğŸ“¦</td><td>é¢„è®¡å¼•å…¥æ›´æˆç†Ÿçš„å“åº”å¼è§£æ„å’Œå…¨æ–°çš„ useData åŠ è½½æœºåˆ¶ã€‚</td></tr><tr><td>2025å¹´ Q4</td><td>Vapor Mode å…¼å®¹æ€§æ‰©å±• ğŸ”Œ</td><td>å…è®¸å¼€å‘è€…åœ¨åŒä¸€ä¸ªé¡¹ç›®ä¸­æ··åˆä½¿ç”¨æ ‡å‡†æ¨¡å¼å’Œ Vapor Modeï¼Œå¹³æ»‘è¿ç§»æ—§ç»„ä»¶ã€‚</td></tr><tr><td>2026å¹´ åˆ</td><td>Vue 4.0 æ„¿æ™¯è®¨è®ºä¸å®éªŒ ğŸš€</td><td>æ ¸å¿ƒå›¢é˜Ÿå°†æ­£å¼è¯„ä¼°æ˜¯å¦å°† Vapor Mode ä½œä¸ºæœªæ¥ä¸»ç‰ˆæœ¬ï¼ˆ4.0ï¼‰çš„é»˜è®¤æ¸²æŸ“å¼•æ“ã€‚</td></tr></tbody></table>
<h3 data-id="heading-5">Pinia</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2d98e76a6b494c40aee1e9590c452b16~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=B%2FWU0lxfroRGcWuY54n8tcgzo4Y%3D" alt="" loading="lazy"/></p>
<p>pinia é™¤äº†ä¾‹è¡Œçš„æ›´æ–°å’Œç»´æŠ¤ï¼Œè¿˜å’Œ vue router çš„è¿›è¡Œäº†æ·±åº¦è”åŠ¨ï¼Œé€šè¿‡ <strong>Data Loader</strong> çš„å½¢å¼ï¼Œä¸¤è€…çš„è¾¹ç•Œå¼€å§‹å˜å¾—æ¨¡ç³Šã€‚</p>
<h3 data-id="heading-6">Vue Router</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e48c894b2644fb4a94d738703a498b5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=%2BDcz%2BuPKWBoqgoSxnin4Ybs04FE%3D" alt="" loading="lazy"/></p>
<p>vue router æ­£åœ¨ä»ä¸€ä¸ªå•çº¯çš„è·¯ç”±ç®¡ç†å™¨è½¬å˜ä¸ºåº”ç”¨çš„æ•°æ®åŠ è½½æ¢çº½ã€‚</p>
<p>ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fuvr.esm.is%2F" target="_blank" title="https://uvr.esm.is/" ref="nofollow noopener noreferrer">unplugin-vue-router</a>ï¼Œèƒ½å¤Ÿå®ç°ï¼š</p>
<ul>
<li>æ–‡ä»¶è·¯ç”±ï¼šæ–‡ä»¶ç»“æ„å³è·¯ç”±ï¼›</li>
<li>Data Loadersï¼šåœ¨è·¯ç”±ä¸­è¿›è¡Œå¼‚æ­¥çŠ¶æ€ç®¡ç†ï¼›</li>
<li>TS ç±»å‹è·¯ç”±ï¼šè‡ªåŠ¨ç”Ÿæˆè·¯ç”±ç±»å‹å£°æ˜æ–‡ä»¶ï¼›</li>
</ul>
<p>è€Œ vue router æœªæ¥çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Frouter%2Freleases%2Ftag%2Fv5.0.0-beta.0" target="_blank" title="https://github.com/vuejs/router/releases/tag/v5.0.0-beta.0" ref="nofollow noopener noreferrer">5.0</a> ç‰ˆæœ¬ä¸­å°†ä¼šå†…ç½®è¿™äº›åŠŸèƒ½ã€‚</p>
<h2 data-id="heading-7"><a href="https://link.juejin.cn?target=https%3A%2F%2Fvoidzero.dev%2F" target="_blank" title="https://voidzero.dev/" ref="nofollow noopener noreferrer">VoidZero</a></h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cffe2d04c3e949d7888eb7aab8c6c6fc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=aT8y170YxIZoK7Qu5%2BVpwuY7qBY%3D" alt="VoidZero å››éª‘å£«" loading="lazy"/></p>
<p>VoidZero å››éª‘å£«</p>
<p>VoidZero åœ¨ 2025 å¹´è¾¾æˆçš„ä¸‰å¤§é‡Œç¨‹ç¢‘æˆæœï¼š</p>
<h3 data-id="heading-8">1. <a href="https://link.juejin.cn?target=https%3A%2F%2Frolldown.rs%2F" target="_blank" title="https://rolldown.rs/" ref="nofollow noopener noreferrer">Rolldown</a> çš„å…¨é¢æŠ•äº§ ğŸï¸</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4de579efe80f42a896ea307039c0de09~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=8pw1UJ4S4dQxtsSc5Na%2BE7z6hFo%3D" alt="" loading="lazy"/></p>
<p>Rolldown æ˜¯ VoidZero çš„æ ¸å¿ƒå¼•æ“ï¼Œä½¿ç”¨ Rust ç¼–å†™çš„æ‰“åŒ…å·¥å…·ï¼Œæ—¨åœ¨å…¼é¡¾ esbuild çš„é«˜æ€§èƒ½å’Œ Rollup çš„å¼ºå¤§åŠŸèƒ½ã€‚</p>
<ul>
<li><code>ç»Ÿä¸€æ€§</code>ï¼šåœ¨ 2025 å¹´ä¹‹å‰ï¼Œæˆ‘ä»¬å¼€å‘ç”¨ esbuildï¼Œç”Ÿäº§ç¯å¢ƒç”¨ Rollupï¼Œè¿™ç§ä¸ä¸€è‡´å¸¸å¯¼è‡´â€œå¼€å‘æ²¡é—®é¢˜ï¼Œä¸Šçº¿å°±æŠ¥é”™â€ã€‚Rolldown å®ç°äº†ä¸¤è€…çš„ç»Ÿä¸€ã€‚</li>
<li><code>æè‡´æ€§èƒ½</code>ï¼šç”±äºåº•å±‚å®Œå…¨ç”± Rust æ„å»ºï¼Œå®ƒåœ¨å¤„ç†å¤§å‹é¡¹ç›®æ—¶çš„æ„å»ºé€Ÿåº¦æ¯”ä¼ ç»Ÿçš„ JavaScript å·¥å…·å¿«äº†æ•°å€ã€‚</li>
</ul>
<h3 data-id="heading-9">2. <a href="https://link.juejin.cn?target=https%3A%2F%2Fcn.vite.dev%2F" target="_blank" title="https://cn.vite.dev/" ref="nofollow noopener noreferrer">Vite7</a> çš„åŸç”ŸåŒ–è½¬å‹ âš¡</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3976bcd9e12c41078730c67a427f0f4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=z4tD3orPd2dU88EeEHjwVUBFot4%3D" alt="" loading="lazy"/></p>
<p>2025 å¹´å‘å¸ƒçš„ <code>Vite7</code> æ˜¯ VoidZero ç”Ÿæ€çš„é¦–ä¸ªå¤§è§„æ¨¡åº”ç”¨æˆæœã€‚</p>
<ul>
<li><code>æ ¸å¿ƒæ›¿æ¢</code>ï¼šVite7 æ­£å¼å°†åº•å±‚æ‰“åŒ…å¼•æ“æ›¿æ¢ä¸º Rolldownã€‚</li>
<li><code>æ’ä»¶ç”Ÿæ€å…¼å®¹</code>ï¼šè™½ç„¶åº•å±‚å˜äº†ï¼Œä½†å®ƒå‡ ä¹å®Œç¾å…¼å®¹äº†ç°æœ‰çš„ Rollup æ’ä»¶ç”Ÿæ€ï¼Œå¼€å‘è€…å¯ä»¥æ— æ„Ÿè¿ç§»ï¼Œäº«å—åˆ°é€Ÿåº¦çš„æå‡ã€‚</li>
</ul>
<h3 data-id="heading-10">3. <a href="https://link.juejin.cn?target=https%3A%2F%2Foxc.rs%2F" target="_blank" title="https://oxc.rs/" ref="nofollow noopener noreferrer">Oxc</a> çš„é›†æˆä¸æ€§èƒ½å‹æ¦¨ ğŸ› ï¸</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e226dd682ab84f6fb30d1ad48512436b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=KUl7ckpWPl8b7HR9iZT3z1ZijM4%3D" alt="" loading="lazy"/></p>
<p>VoidZero è¿˜æ•´åˆäº† Oxcã€‚</p>
<ul>
<li><code>è¶…è¶Š Babel/ESLint</code>ï¼š2025 å¹´ï¼ŒOxc æä¾›çš„ä»£ç è½¬æ¢å’Œç±»å‹æ£€æŸ¥èƒ½åŠ›è¢«æ·±åº¦é›†æˆåˆ°å·¥å…·é“¾ä¸­ï¼Œå–ä»£äº†è¿‡å»æ²‰é‡çš„ JavaScript å®ç°ã€‚</li>
<li><code>é‡Œç¨‹ç¢‘æ„ä¹‰</code>ï¼šæ ‡å¿—ç€å‰ç«¯å·¥å…·é“¾å½»åº•è¿›å…¥äº† <strong>â€œåŸç”ŸåŒ–â€</strong> æ—¶ä»£ï¼Œå¼€å‘è€…ä¸å†éœ€è¦å¿å—é•¿æ—¶é—´çš„å†·å¯åŠ¨å’Œçƒ­æ›´æ–°ç­‰å¾…ã€‚</li>
</ul>
<h3 data-id="heading-11">4. <a href="https://link.juejin.cn?target=https%3A%2F%2Fvitest.dev%2F" target="_blank" title="https://vitest.dev/" ref="nofollow noopener noreferrer">Vitest</a></h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/18e2b7460f9c4b779c3c03872643d395~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5a2m5LuA5LmI5YmN56uv:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499447&amp;x-signature=AAYRKclpwgQe18Mmg%2FxdrsU1QXA%3D" alt="" loading="lazy"/></p>
<p>2025 å¹´ Vitest æœ€æ˜¾è‘—çš„æ”¹è¿›æ¥è‡ªäºå°†åº•å±‚æ‰“åŒ…å¼•æ“æ›´æ¢ä¸º Rolldownï¼›åŒæ—¶å¸¦æ¥äº†æ›´é«˜æ•ˆçš„ç›‘è§†æ¨¡å¼ï¼Œå½“ä½ ä¿®æ”¹ä¸€è¡Œä»£ç æ—¶ï¼Œç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹ä¼šå‡ ä¹ç¬é—´è§¦å‘ï¼Œåé¦ˆå¾ªç¯å˜å¾—æå…¶çŸ­ä¿ƒã€‚</p>
<ul>
<li><code>åŸç”Ÿæµè§ˆå™¨æ”¯æŒ</code>ï¼š2025 å¹´çš„ Vitest æµè§ˆå™¨æ¨¡å¼æ›´åŠ æˆç†Ÿï¼Œå…è®¸æµ‹è¯•ç›´æ¥åœ¨çœŸå®çš„æµè§ˆå™¨å†…æ ¸ä¸­è¿è¡Œã€‚è¿™è§£å†³äº†è®¸å¤š JSDOM æ— æ³•æ¨¡æ‹Ÿçš„æ ·å¼å’Œå¤æ‚äº¤äº’ï¼ˆå¦‚æ‹–æ‹½ï¼‰çš„é—®é¢˜ã€‚</li>
<li><code>æ— ç¼è°ƒè¯•</code>ï¼šä½ å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·é‡Œè°ƒè¯•æµ‹è¯•ç”¨ä¾‹ï¼Œçœ‹åˆ°çš„ DOM ç»“æ„å’Œäº¤äº’è¡¨ç°ä¸çœŸå®ç”¨æˆ·å®Œå…¨ä¸€è‡´ã€‚</li>
<li><code>æ™ºèƒ½æµ‹è¯•è¦†ç›–åˆ†æ</code>ï¼šé€šè¿‡ Oxc æä¾›çš„å¿«é€Ÿè¯­æ³•åˆ†æï¼ŒVitest èƒ½æ›´ç²¾å‡†åœ°åˆ¤æ–­å“ªäº›ä»£ç åˆ†æ”¯æœªè¢«è¦†ç›–ï¼Œå¹¶ç»™å‡ºæ›´å…·å¯è¯»æ€§çš„ä¿®å¤å»ºè®®ã€‚</li>
<li><code>ç±»å‹å®‰å…¨æµ‹è¯•</code>ï¼šåŸç”Ÿæ”¯æŒ TypeScriptï¼Œexpect-type ç­‰ç‰¹æ€§è¢«æ·±åº¦æ•´åˆã€‚</li>
</ul>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>2025 å¹´æ•´ä¸ª Vue ç”Ÿæ€çš„å‘å±•ä¸»è¦é›†ä¸­åœ¨ 3 ä¸ªæ¿å—ï¼š</p>
<h3 data-id="heading-13">1. å¼€å‘è€…å·¥å…·çš„å´›èµ· (Developer Tools)</h3>
<p>æœ€å¼•äººæ³¨ç›®çš„æ˜¯æ¦œé¦–é¡¹ç›® <code>Slidev</code>ï¼Œå®ƒä»¥ <code>+9.3k</code> çš„å¢é•¿é‡é¥é¥é¢†å…ˆã€‚</p>
<p>è¿™è¡¨æ˜ Vue çš„ç”Ÿæ€å·²ç»ä¸ä»…ä»…å±€é™äºåº”ç”¨å¼€å‘æœ¬èº«ï¼Œè€Œæ˜¯æ‰©å±•åˆ°äº†å¼€å‘è€…çš„å·¥ä½œæµä¸­ã€‚Slidev ä½œä¸ºä¸€ä¸ªé¢å‘å¼€å‘è€…çš„æ¼”ç¤ºæ–‡ç¨¿å·¥å…·ï¼Œå®ƒçš„æµè¡Œåæ˜ äº†å¼€å‘è€…å¯¹â€œä»£ç å³ä¸€åˆ‡â€ï¼ˆPresentation as Codeï¼‰çš„é«˜æ¶¨éœ€æ±‚ã€‚</p>
<h3 data-id="heading-14">2. UI ç»„ä»¶åº“çš„æ–°æ ¼å±€ï¼šçµæ´»æ€§ vs å®Œæ•´æ€§</h3>
<p>æ¦œå•ä¸­æœ‰åŠæ•°ä»¥ä¸Šçš„é¡¹ç›®éƒ½ä¸ UI ç›¸å…³ï¼Œä½†æ–¹å‘æœ‰æ‰€ä¸åŒï¼š</p>
<p>é«˜åº¦å¯å®šåˆ¶åŒ–(Headless): <code>shadcn-vue (#4, +3.4k)</code> å’Œ <code>Radix Vue (#7, +2.1k)</code>çš„ä¸Šæ¦œï¼Œè¯´æ˜å¼€å‘è€…è¶Šæ¥è¶Šå€¾å‘äºæ‹¥æœ‰æ ·å¼çš„å®Œå…¨æ§åˆ¶æƒï¼Œè€Œä¸åªæ˜¯ä½¿ç”¨å¼€ç®±å³ç”¨çš„ UI åº“ã€‚</p>
<p>ç»å…¸ä¸å…¨èƒ½: è€ç‰Œå¼ºè€… <code>Element Plus (#8)</code>å’Œ <code>PrimeVue (#6)</code>ä¾ç„¶ç¨³å¥ï¼Œè¯æ˜ä¼ä¸šçº§å¼€å‘å¯¹æˆç†Ÿã€å¤§è€Œå…¨çš„ç»„ä»¶åº“éœ€æ±‚ä¾ç„¶æ—ºç››ã€‚</p>
<p>ç”Ÿæ€æ·±åº¦é›†æˆ: <code>Nuxt UI (#10)</code>çš„å‡ºç°æ˜¾ç¤ºäº†ç‰¹å®šæ¡†æ¶ä¸“å± UI åº“çš„æ½œåŠ›ã€‚</p>
<h3 data-id="heading-15">3. æ ¸å¿ƒæ¡†æ¶ä¸å†…å®¹é©±åŠ¨</h3>
<p><code>Nuxt (#2, +3.7k)</code> ç»§ç»­ä½œä¸º Vue ç”Ÿæ€çš„æ——èˆ°æ¡†æ¶é¢†è·‘ï¼Œæ˜¾ç¤ºäº†å…¶åœ¨å…¨æ ˆå’Œ SSR é¢†åŸŸçš„ç»Ÿæ²»åŠ›ã€‚</p>
<p><code>VitePress (#5, +3.2k)</code>ä½œä¸ºé™æ€ç«™ç‚¹ç”Ÿæˆå™¨çš„é«˜æ’åï¼Œå¼ºè°ƒäº†æ–‡æ¡£å’Œå†…å®¹é©±åŠ¨ç«™ç‚¹åœ¨ Vue ç”Ÿæ€ä¸­çš„é‡è¦æ€§ã€‚</p>
<p><code>Vue Bits (#3, +3.5k)</code> ä½œä¸ºä¸€ä¸ªå¼€æºé›†åˆä¸Šæ¦œï¼Œä¹Ÿåæ˜ äº†ç¤¾åŒºå¯¹é«˜è´¨é‡èµ„æºæ•´ç†çš„æ¸´æœ›ã€‚</p>
<p>äº†è§£äº†è¿™äº›é¡¹ç›®çš„å®šä½åï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ªè¶‹åŠ¿ï¼š<strong>ç°åœ¨çš„ Vue å¼€å‘è€…è¶Šæ¥è¶Šå–œæ¬¢é«˜å®šåˆ¶åŒ–ï¼ˆå¦‚ shadcn-vueï¼‰å’Œå¼€å‘ä½“éªŒå·¥å…·ï¼ˆå¦‚ Slidevï¼‰</strong> ã€‚</p>
<p>é‚£ä½ æ˜¯æ›´å€¾å‘äºä½¿ç”¨ Element Plus è¿™ç§å¼€ç®±å³ç”¨çš„ä¼ ç»Ÿç»„ä»¶åº“ï¼Œè¿˜æ˜¯æƒ³å°è¯• shadcn-vue è¿™ç§é«˜åº¦è‡ªç”±çš„æ–°æ¨¡å¼å‘¢ï¼Ÿ</p>
<blockquote>
<p>ä½œå“æ¨è</p>
<p><strong>Haotab æ–°æ ‡ç­¾é¡µ</strong>ï¼Œä¸€ä¸ªä¼˜é›…çš„æ–°æ ‡ç­¾é¡µ</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fchromewebstore.google.com%2Fdetail%2Fhaotab-%25E6%2596%25B0%25E6%25A0%2587%25E7%25AD%25BE%25E9%25A1%25B5%2Ffcmpijobelbhgbakdffgjohkddigbiap%3Fauthuser%3D0%26hl%3Dzh-CN" target="_blank" title="https://chromewebstore.google.com/detail/haotab-%E6%96%B0%E6%A0%87%E7%AD%BE%E9%A1%B5/fcmpijobelbhgbakdffgjohkddigbiap?authuser=0&amp;hl=zh-CN" ref="nofollow noopener noreferrer">chrome å•†åº—</a>
| <a href="https://link.juejin.cn?target=https%3A%2F%2Fmicrosoftedge.microsoft.com%2Faddons%2Fdetail%2Fhaotab-%25E6%2596%25B0%25E6%25A0%2587%25E7%25AD%25BE%25E9%25A1%25B5%2Fjakpmjeiokokeiclojbkjfglkfccfljh" target="_blank" title="https://microsoftedge.microsoft.com/addons/detail/haotab-%E6%96%B0%E6%A0%87%E7%AD%BE%E9%A1%B5/jakpmjeiokokeiclojbkjfglkfccfljh" ref="nofollow noopener noreferrer">edge å•†åº—</a>
| <a href="https://link.juejin.cn?target=https%3A%2F%2Fgo.haotab.link%2F" target="_blank" title="https://go.haotab.link/" ref="nofollow noopener noreferrer">åœ¨çº¿ç‰ˆ</a></p>
<p>é™å¾…ä½ çš„ä½“éªŒâ¤</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¤§æ•°æ®-217 Prometheus 2.53.2 å®‰è£…ä¸é…ç½®å®æˆ˜ï¼šScrape Targetsã€Exporterã€å‘Šè­¦é“¾è·¯ä¸å¸¸è§æ•…éšœé€ŸæŸ¥]]></title>    <link>https://juejin.cn/post/7597080391879475210</link>    <guid>https://juejin.cn/post/7597080391879475210</guid>    <pubDate>2026-01-20T07:24:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597080391879475210" data-draft-id="7596990822128140326" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¤§æ•°æ®-217 Prometheus 2.53.2 å®‰è£…ä¸é…ç½®å®æˆ˜ï¼šScrape Targetsã€Exporterã€å‘Šè­¦é“¾è·¯ä¸å¸¸è§æ•…éšœé€ŸæŸ¥"/> <meta itemprop="keywords" content="åç«¯,å¤§æ•°æ®,æœºå™¨å­¦ä¹ "/> <meta itemprop="datePublished" content="2026-01-20T07:24:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ­¦å­åº·"/> <meta itemprop="url" content="https://juejin.cn/user/149189314230039"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¤§æ•°æ®-217 Prometheus 2.53.2 å®‰è£…ä¸é…ç½®å®æˆ˜ï¼šScrape Targetsã€Exporterã€å‘Šè­¦é“¾è·¯ä¸å¸¸è§æ•…éšœé€ŸæŸ¥
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/149189314230039/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ­¦å­åº·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:24:47.000Z" title="Tue Jan 20 2026 07:24:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">TL;DR</h2>
<ul>
<li>åœºæ™¯ï¼šå•æœºéƒ¨ç½² Prometheus 2.53.2ï¼Œæ‹‰å–å¤šå°ä¸»æœº node_exporter æŒ‡æ ‡å¹¶éªŒè¯ Targets çŠ¶æ€</li>
<li>ç»“è®ºï¼šæ ¸å¿ƒæ˜¯ scrape_configs ç›®æ ‡å¯è¾¾æ€§ä¸ /metrics æš´éœ²ä¸€è‡´æ€§ï¼›å‘Šè­¦ä¸å¯è§†åŒ–é“¾è·¯éœ€åˆ†ç»„ä»¶è½åœ°</li>
<li>äº§å‡ºï¼šå¯ç›´æ¥å¤ç”¨çš„å®‰è£…/ç›®å½•è§„åˆ’/é…ç½®æ¨¡æ¿ + Targets éªŒè¯è·¯å¾„ + æ•…éšœå®šä½ä¸ä¿®å¤æ¸…å•</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e172747c9434b9ba04ad8c1fae871dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=C25ifpfRJflRl2QKtHQnBEv8K0A%3D" alt="å¤§æ•°æ®-217 Prometheus 2.53.2 å®‰è£…ä¸é…ç½®å®æˆ˜ï¼šScrape Targetsã€Exporterã€å‘Šè­¦é“¾è·¯ä¸å¸¸è§æ•…éšœé€ŸæŸ¥" loading="lazy"/></p>
<h2 data-id="heading-1">ç‰ˆæœ¬çŸ©é˜µ</h2>

































<table><thead><tr><th>é¡¹ç›®</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>å·²éªŒè¯</td><td>Prometheus 2.53.2ï¼ˆlinux-amd64ï¼‰é‡‡ç”¨å®˜æ–¹ release tar.gz è§£å‹åç›´æ¥ ./prometheus å‰å°å¯åŠ¨ï¼›é€‚åˆå¿«é€ŸéªŒè¯ä¸å®éªŒç¯å¢ƒ</td></tr><tr><td>é™æ€å‘ç°ï¼ˆstatic_configsï¼‰</td><td>ä»¥ targets: ["host:port"] æ–¹å¼é…ç½®ï¼›ä¾èµ– DNS/ç½‘ç»œå¯è¾¾æ€§ä¸ç«¯å£æ”¾é€š</td></tr><tr><td>node_exporter ç«¯å£ 9100</td><td>æ–‡ä¸­ Targets æŒ‡å‘ 9100ï¼›å‰ææ˜¯è¢«ç›‘æ§æœºå·²éƒ¨ç½²å¹¶å¯¹ Prometheus æ”¾é€šè®¿é—®</td></tr><tr><td>Prometheus Web UI /targets</td><td>ä½¿ç”¨ http://:9090/targets éªŒè¯æŠ“å–æˆåŠŸ/å¤±è´¥ä¸é”™è¯¯åŸå› </td></tr><tr><td>Grafana/å…¶ä»–æœåŠ¡æŒ‡æ ‡æŠ“å–</td><td>é…ç½®äº† h121.wzk.icu:9091ï¼›éœ€ç¡®ä¿è¯¥ç«¯å£å®é™…æš´éœ² /metricsï¼ˆGrafana é»˜è®¤å¹¶é 9091ï¼‰</td></tr><tr><td>Alertmanagerï¼ˆæœªå®é…ï¼‰</td><td>æ–‡ä¸­ä»…ä»‹ç»ä¸ç‰‡æ®µç¤ºä¾‹ï¼›ç”Ÿäº§éœ€è¦å•ç‹¬éƒ¨ç½²å¹¶åœ¨ alerting.alertmanagers é…ç½®å¯è¾¾åœ°å€</td></tr></tbody></table>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c4544a2b14f744008aaf5b96ba367207~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=sWX9TJ%2B3KYLtcD10A%2F2fr4SqDsE%3D" alt="Prometheus å®˜ç½‘" loading="lazy"/></p>
<h2 data-id="heading-2">Prometheus</h2>
<h3 data-id="heading-3">æ¶æ„è®¾è®¡</h3>
<p>Prometheus çš„æ ¸å¿ƒæ¶æ„é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå„ç»„ä»¶èŒè´£æ˜ç¡®ä¸”ç›¸äº’åä½œï¼Œæ„æˆå®Œæ•´çš„ç›‘æ§è§£å†³æ–¹æ¡ˆã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†æ¶æ„è§£æï¼š</p>
<ol>
<li>Prometheus Server
ä½œä¸ºæ ¸å¿ƒç»„ä»¶ï¼Œé‡‡ç”¨å¤šè¿›ç¨‹æ¶æ„ï¼š</li>
</ol>
<ul>
<li>æ•°æ®é‡‡é›†ï¼šé€šè¿‡å®šæ—¶è½®è¯¢ï¼ˆscrapeï¼‰æ–¹å¼ä»é…ç½®çš„targetsè·å–æŒ‡æ ‡æ•°æ®</li>
<li>å­˜å‚¨å¼•æ“ï¼šé‡‡ç”¨è‡ªå®šä¹‰çš„æ—¶åºæ•°æ®åº“TSDBï¼Œæ”¯æŒé«˜æ•ˆå‹ç¼©å­˜å‚¨ï¼ˆé‡‡æ ·æ•°æ®å¯å‹ç¼©è‡³1.3 bytes/sampleï¼‰</li>
<li>æŸ¥è¯¢å¤„ç†ï¼šæä¾›PromQLæŸ¥è¯¢è¯­è¨€ï¼Œæ”¯æŒå³æ—¶æŸ¥è¯¢ï¼ˆinstant queryï¼‰å’ŒèŒƒå›´æŸ¥è¯¢ï¼ˆrange queryï¼‰
å…¸å‹é…ç½®ç¤ºä¾‹ï¼š</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">'node'</span>
    <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">15s</span>
    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> [<span class="hljs-string">'192.168.1.100:9100'</span>]
</code></pre>
<ol start="2">
<li>Exporterä½“ç³»
ä½œä¸ºæŒ‡æ ‡è½¬æ¢ä¸­é—´ä»¶ï¼Œä¸»è¦åˆ†ä¸ºï¼š</li>
</ol>
<ul>
<li>ç³»ç»Ÿçº§ï¼šnode_exporterï¼ˆé‡‡é›†CPU/å†…å­˜/ç£ç›˜ç­‰200+æŒ‡æ ‡ï¼‰</li>
<li>æœåŠ¡çº§ï¼šmysql_exporterã€redis_exporter</li>
<li>ç½‘ç»œæ¢æµ‹ï¼šblackbox_exporteræ”¯æŒHTTP/ICMP/TCPç­‰åè®®æ£€æŸ¥
å·¥ä½œæµç¨‹ï¼šç›®æ ‡ç³»ç»Ÿ â†’ Exporterè½¬æ¢ â†’ Prometheusé‡‡é›†</li>
</ul>
<ol start="3">
<li>Alertmanager
æŠ¥è­¦ç®¡ç†å­ç³»ç»ŸåŠŸèƒ½ï¼š</li>
</ol>
<ul>
<li>æŠ¥è­¦åˆ†ç»„ï¼šå°†ç›¸å…³æŠ¥è­¦åˆå¹¶é€šçŸ¥</li>
<li>æŠ‘åˆ¶æœºåˆ¶ï¼šé¿å…çº§è”æŠ¥è­¦é£æš´</li>
<li>è·¯ç”±åˆ†å‘ï¼šæ”¯æŒå¤šæ¥æ”¶å™¨é…ç½®
å…¸å‹è·¯ç”±é…ç½®ç¤ºä¾‹ï¼š</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">routes:</span>
<span class="hljs-bullet">-</span> <span class="hljs-attr">receiver:</span> <span class="hljs-string">'slack-notifications'</span>
  <span class="hljs-attr">match:</span>
    <span class="hljs-attr">severity:</span> <span class="hljs-string">'critical'</span>
</code></pre>
<ol start="4">
<li>Pushgateway
ç‰¹æ®Šåœºæ™¯è§£å†³æ–¹æ¡ˆï¼š</li>
</ol>
<ul>
<li>é€‚ç”¨åœºæ™¯ï¼šCronJobç­‰çŸ­å‘¨æœŸä»»åŠ¡</li>
<li>å·¥ä½œæ¨¡å¼ï¼šä»»åŠ¡å°†æŒ‡æ ‡pushè‡³ç½‘å…³ â†’ Prometheuså®šæœŸpullç½‘å…³</li>
<li>æ•°æ®ç”Ÿå‘½å‘¨æœŸï¼šé»˜è®¤2å°æ—¶åè‡ªåŠ¨è¿‡æœŸ</li>
</ul>
<ol start="5">
<li>å®¢æˆ·ç«¯åº“
æ”¯æŒå¤šç§è¯­è¨€å®ç°è‡ªå®šä¹‰æŒ‡æ ‡ï¼š</li>
</ol>
<ul>
<li>Go: prometheus/client_golang</li>
<li>Java: io.prometheus/simpleclient</li>
<li>Python: prometheus_client
ç¤ºä¾‹æŒ‡æ ‡å®šä¹‰ï¼ˆPythonï¼‰ï¼š</li>
</ul>
<pre><code class="hljs language-python" lang="python">REQUEST_COUNT = Counter(<span class="hljs-string">'http_requests_total'</span>, <span class="hljs-string">'Total HTTP requests'</span>)
REQUEST_COUNT.inc()
</code></pre>
<p>ç›‘æ§æ•°æ®æµè½¬ç¤ºæ„å›¾ï¼š</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[Targets]</span> â†pullâ”€ <span class="hljs-selector-attr">[Prometheus Server]</span> â”€alertâ†’ <span class="hljs-selector-attr">[Alertmanager]</span>
    â†‘                â†‘
   push             pull
    |                |
<span class="hljs-selector-attr">[Pushgateway]</span>    <span class="hljs-selector-attr">[Exporters]</span>
</code></pre>
<p>å®é™…éƒ¨ç½²å»ºè®®ï¼š</p>
<ul>
<li>ç”Ÿäº§ç¯å¢ƒåº”é‡‡ç”¨è”é‚¦æ¶æ„ï¼Œç”±å¤šä¸ªPrometheuså®ä¾‹ç»„æˆå±‚çº§</li>
<li>é…åˆGrafanaå®ç°å¯è§†åŒ–ä»ªè¡¨ç›˜</li>
<li>é‡è¦æŒ‡æ ‡å»ºè®®è®¾ç½®Recording Rulesé¢„è®¡ç®—</li>
</ul>
<h3 data-id="heading-4">å®˜æ–¹ç½‘ç«™</h3>
<pre><code class="hljs language-shell" lang="shell">https://prometheus.io/download/
</code></pre>
<p>è¿™é‡Œç”¨ <code>2.53.2</code></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ee4d0e17a6b474a85ca604fd29f5d92~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=%2FFRZ6GrgW0icS03BfrJtu%2F7N5fM%3D" alt="Prometheus 2.53.2 ä¸‹è½½" loading="lazy"/></p>
<h3 data-id="heading-5">æ•°æ®æ¨¡å‹</h3>
<p>Prometheus çš„æ•°æ®æ¨¡å‹åŸºäºé”®å€¼å¯¹å­˜å‚¨æ—¶é—´åºåˆ—æ•°æ®ã€‚å®ƒçš„æ•°æ®å•ä½æ˜¯ æ—¶é—´åºåˆ—ï¼Œæ¯ä¸ªæ—¶é—´åºåˆ—ç”± å”¯ä¸€çš„ metric åç§° å’Œä¸€ç»„ æ ‡ç­¾ï¼ˆlabelsï¼‰ ç»„æˆã€‚æ ‡ç­¾ä½¿å¾—ç”¨æˆ·å¯ä»¥çµæ´»åœ°æ ‡è®°å’Œç­›é€‰æ•°æ®ï¼Œæ¯”å¦‚ http_requests_total{method="GET", status="200"} è¡¨ç¤ºè·å–åˆ°çš„ HTTP è¯·æ±‚æ€»æ•°ã€‚</p>
<h3 data-id="heading-6">æ•°æ®é‡‡é›†æ–¹å¼</h3>
<p>Prometheus çš„æ•°æ®é‡‡é›†é‡‡ç”¨ Pull æ¨¡å‹ï¼Œå³ Prometheus å®šæœŸä»æŒ‡å®šçš„ç›®æ ‡ç«¯ç‚¹ï¼ˆtargetsï¼‰æ‹‰å–æ•°æ®ã€‚è¿™ç§æ¨¡å‹å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿå°¤å…¶é€‚ç”¨ï¼Œå› ä¸ºå¯ä»¥çµæ´»é…ç½®å¹¶è‡ªåŠ¨å‘ç°æœåŠ¡ï¼ˆé€šè¿‡ä¸ Kubernetes é›†æˆï¼‰ï¼Œæ— éœ€æ¯ä¸ªæœåŠ¡éƒ½ä¸»åŠ¨ä¸ŠæŠ¥æ•°æ®ã€‚</p>
<h3 data-id="heading-7">æŸ¥è¯¢è¯­è¨€ï¼ˆPromQLï¼‰</h3>
<p>Prometheus æä¾›äº†ä¸€ç§å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€ PromQLï¼Œç”¨äºæŸ¥è¯¢å’Œåˆ†æå­˜å‚¨çš„æ•°æ®ã€‚PromQL å…è®¸ç”¨æˆ·å¯¹æ•°æ®è¿›è¡Œå¤æ‚çš„è¿ç®—å’Œèšåˆï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>rate(http_requests_total[5m])ï¼šè®¡ç®—è¿‡å» 5 åˆ†é’Ÿçš„ HTTP è¯·æ±‚é€Ÿç‡ã€‚</li>
<li>avg_over_time(cpu_usage[1h])ï¼šè®¡ç®—è¿‡å» 1 å°æ—¶çš„ CPU ä½¿ç”¨ç‡å¹³å‡å€¼ã€‚ PromQL æ”¯æŒè¿‡æ»¤ã€èšåˆã€è¿ç®—ç¬¦ã€æ—¶é—´çª—å£ç­‰æ“ä½œï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥çµæ´»åœ°åˆ†æç›‘æ§æ•°æ®ã€‚</li>
</ul>
<h3 data-id="heading-8">åº”ç”¨åœºæ™¯</h3>
<ul>
<li>åœ¨ä¸šåŠ¡å±‚ä½œç”¨åŸ‹ç‚¹ç³»ç»Ÿï¼šæ”¯æŒå¤šç§è¯­è¨€ï¼ˆGoã€Pythonã€Ruby ç­‰ç­‰ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®¢æˆ·ç«¯å¯¹æ ¸å¿ƒä¸šåŠ¡è¿›è¡ŒåŸ‹ç‚¹ï¼Œå¦‚ä¸‹å•æµç¨‹ã€æ·»åŠ è´­ç‰©è½¦ç­‰ç­‰</li>
<li>åœ¨åº”ç”¨å±‚ä½œç”¨ç›‘æ§ç³»ç»Ÿï¼šä¸€äº›ä¸»æµåº”ç”¨å¯ä»¥é€šè¿‡å®˜æ–¹æˆ–è€…ç¬¬ä¸‰æ–¹çš„å¯¼å‡ºå™¨ï¼Œæ¥å¯¹è¿™äº›åº”ç”¨åšæ ¸å¿ƒæŒ‡æ ‡çš„æ”¶é›†ï¼Œå¦‚ Redisã€MySQL</li>
<li>åœ¨ç³»ç»Ÿå±‚ç”¨ä½œç³»ç»Ÿç›‘æ§é™¤äº†å¸¸ç”¨è½¯ä»¶ï¼ŒPrometheus ä¹Ÿæœ‰ç›¸å…³ç³»ç»Ÿå±‚å’Œç½‘ç»œå±‚ exporterï¼Œç”¨äºç›‘æ§æœåŠ¡å™¨æˆ–è€…ç½‘ç»œ</li>
<li>é›†æˆå…¶ä»–ç›‘æ§ Prometheus è¿˜å¯ä»¥é€šè¿‡å„ç§ exporterï¼Œé›†æˆå…¶ä»–çš„ç›‘æ§ç³»ç»Ÿï¼Œæ”¶é›†ç›‘æ§æ•°æ®ï¼Œå¦‚ AWS CloudWatchã€JMXã€Pingdom ç­‰ç­‰ã€‚</li>
</ul>
<p>æˆ‘ä»¬éœ€è¦å®Œæˆï¼š</p>
<ul>
<li>åœ¨ç›‘æ§æœåŠ¡å™¨ä¸Šå®‰è£… Prometheus</li>
<li>åœ¨è¢«ç›‘æ§çš„ç¯å¢ƒä¸Šå®‰è£… export</li>
<li>å®‰è£… Grafana</li>
</ul>
<h3 data-id="heading-9">ä¸‹è½½é…ç½®</h3>
<pre><code class="hljs language-shell" lang="shell">cd /opt/software
wget https://github.com/prometheus/prometheus/releases/download/v2.53.2/prometheus-2.53.2.linux-amd64.tar.gz
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b930af7856924a25a1caee19aa47faba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=4s4o6OJQ9nUmtLi5ulBMsl7pjLI%3D" alt="Prometheus 2.53.2 Linux ç‰ˆæœ¬ä¸‹è½½" loading="lazy"/></p>
<h3 data-id="heading-10">è§£å‹é…ç½®</h3>
<pre><code class="hljs language-shell" lang="shell">tar -zxvf prometheus-2.53.2.linux-amd64.tar.gz
mv prometheus-2.53.2.linux-amd64 ../servers/
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/95ccb27d0e974f4d87bbf45b2af38d93~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=jWbTJron9ljqG7qLRR62%2FV3tISk%3D" alt="è§£å‹ Prometheus" loading="lazy"/></p>
<h3 data-id="heading-11">ä¿®æ”¹é…ç½®</h3>
<p>è§£å‹é…ç½®ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œåœ¨é¡¹ç›®å¯¹åº”ç›®å½•ä¸‹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">cd /opt/servers/prometheus-2.53.2.linux-amd64
vim prometheus.yml
</code></pre>
<p>æ‰§è¡Œçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e7aa7d5134a4c0384ee31fb3a05ab4e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=ZwF9n3iU2SDrS5oG4MUfp2%2ByUSY%3D" alt="ä¿®æ”¹Prometheusé…ç½®æ–‡ä»¶" loading="lazy"/>
æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸€äº›é…ç½®ï¼š</p>
<pre><code class="hljs language-xml" lang="xml"># my global config
global:
  scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.
  # scrape_timeout is set to the global default (10s).

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets:
          # - alertmanager:9093

# Load rules once and periodically evaluate them according to the global 'evaluation_interval'.
rule_files:
  # - "first_rules.yml"
  # - "second_rules.yml"

# A scrape configuration containing exactly one endpoint to scrape:
# Here it's Prometheus itself.
scrape_configs:
  # The job name is added as a label `job=<span class="hljs-tag">&lt;<span class="hljs-name">job_name</span>&gt;</span>` to any timeseries scraped from this config.
  - job_name: "prometheus"

    # metrics_path defaults to '/metrics'
    # scheme defaults to 'http'.

    static_configs:
      - targets: ["localhost:9090"]
      
  - job_name: "h121-wzk-icu"
    static_configs:
      - targets: ["h121.wzk.icu:9100"]

  - job_name: "h122-wzk-icu"
    static_configs:
      - targets: ["h122.wzk.icu:9100"]
      
  - job_name: "h123-wzk-icu"
    static_configs:
      - targets: ["h123.wzk.icu:9100"]
      
  - job_name: "wzk-icu-grafana"
    static_configs:
      - targets: ["h121.wzk.icu:9091"]
</code></pre>
<p>å¯¹åº”çš„å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1f95d8f22fce4ac7b08aca403fcc2749~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=gtG2cyYRhVtspnJ8SmAFdd7kcmY%3D" alt="ä¿®æ”¹é…ç½®Prometheusæ–‡ä»¶å†…å®¹" loading="lazy"/></p>
<h3 data-id="heading-12">å¯åŠ¨æœåŠ¡</h3>
<p>é…ç½®å®Œæˆåï¼Œåªéœ€è¦è¿è¡Œèµ·æ¥è¿™ä¸ªè½¯ä»¶ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">cd /opt/servers/prometheus-2.53.2.linux-amd64
./prometheus
</code></pre>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3931d3584ab3477d923103a3957a47cb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=MwzPKE4H6EUgzYLNsxGL0q2WM08%3D" alt="å¯åŠ¨ Prometheus æœåŠ¡" loading="lazy"/>
æˆ‘ä»¬é€šè¿‡ URLå¯ä»¥çœ‹åˆ°è‡ªå¸¦çš„ç›‘æ§ç•Œé¢ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">http://h121.wzk.icu:9090/
</code></pre>
<p>è®¿é—®ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5e78837220fa415385f4f50fecfe442f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=bytvZlI%2BsjcKcUyPybSAQqkYHZI%3D" alt="æŸ¥çœ‹ Prometheus åå°æœåŠ¡" loading="lazy"/>
æˆ‘ä»¬é€‰æ‹© Targets é€‰é¡¹ï¼š</p>
<pre><code class="hljs language-shell" lang="shell">http://h121.wzk.icu:9090/targets?search=
</code></pre>
<p>å¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„å†…å®¹ï¼š
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c5bd32bca68b4f3b9fb391be95621326~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5q2m5a2Q5bq3:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769498686&amp;x-signature=1QpWMmWcEKqkx6CutTYTuMcxFIk%3D" alt="æŸ¥çœ‹ Prometheus æœåŠ¡" loading="lazy"/></p>
<h3 data-id="heading-13">Alerting å’Œé€šçŸ¥</h3>
<p>Prometheus å¯ä»¥åŸºäºæŸ¥è¯¢ç»“æœè®¾å®šæŠ¥è­¦è§„åˆ™ï¼Œæ¯”å¦‚å½“ CPU ä½¿ç”¨ç‡è¶…è¿‡ 80% æŒç»­ä¸€å®šæ—¶é—´ï¼Œå°±å¯ä»¥è§¦å‘æŠ¥è­¦ã€‚Prometheus çš„ Alertmanager è´Ÿè´£ç®¡ç†å’Œè·¯ç”±æŠ¥è­¦ï¼Œæ”¯æŒå»é‡ã€åˆ†ç»„ã€é™é»˜å¤„ç†ç­‰åŠŸèƒ½ï¼Œå¸®åŠ©å›¢é˜Ÿæ›´é«˜æ•ˆåœ°å¤„ç†æŠ¥è­¦äº‹ä»¶ã€‚Alertmanager å¯ä»¥ä¸å¤šä¸ªé€šçŸ¥å¹³å°é›†æˆï¼Œå¦‚ Slackã€é‚®ä»¶ã€PagerDutyã€OpsGenie ç­‰ã€‚</p>
<h3 data-id="heading-14">å­˜å‚¨æœºåˆ¶</h3>
<p>Prometheus çš„æ•°æ®é»˜è®¤ä¼šä¿å­˜åœ¨æœ¬åœ°ç£ç›˜ä¸­ï¼Œä½¿ç”¨ TSDBï¼ˆæ—¶é—´åºåˆ—æ•°æ®åº“ï¼‰ å­˜å‚¨å¼•æ“ï¼Œä»¥æ—¶é—´å—çš„å½¢å¼è¿›è¡Œå­˜å‚¨å’Œå‹ç¼©ã€‚ä¸ºäº†æ»¡è¶³é•¿æ—¶é—´çš„æ•°æ®ä¿ç•™å’ŒæŸ¥è¯¢éœ€æ±‚ï¼ŒPrometheus ä¹Ÿæ”¯æŒé€šè¿‡è¿œç¨‹å­˜å‚¨ï¼ˆå¦‚ Cortexã€Thanosï¼‰æ‰©å±•æ•°æ®çš„æŒä¹…åŒ–å’Œé«˜å¯ç”¨æ€§ã€‚</p>
<h3 data-id="heading-15">æœåŠ¡å‘ç°</h3>
<p>Prometheus æä¾›äº†å¤šç§æœåŠ¡å‘ç°æœºåˆ¶ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å‘ç°æ–°çš„ç›‘æ§ç›®æ ‡ã€‚å®ƒæ”¯æŒé™æ€é…ç½®ã€DNS æœåŠ¡å‘ç°ã€æ–‡ä»¶æœåŠ¡å‘ç°ä»¥åŠå¤šç§å¹³å°çš„è‡ªåŠ¨å‘ç°ï¼Œæ¯”å¦‚ Kubernetesã€Consulã€Amazon EC2ã€Azure ç­‰ï¼Œä½¿å¾— Prometheus èƒ½å¤ŸåŠ¨æ€åœ°å‘ç°å®¹å™¨ã€Podã€VM ç­‰æ–°èµ„æºï¼Œå‡å°‘è¿ç»´äººå‘˜çš„æ‰‹åŠ¨æ“ä½œã€‚</p>
<h2 data-id="heading-16">é”™è¯¯é€ŸæŸ¥</h2>



























































<table><thead><tr><th>ç—‡çŠ¶</th><th>æ ¹å› å®šä½</th><th>ä¿®å¤</th><th/></tr></thead><tbody><tr><td>/targets æ˜¾ç¤º DOWNï¼Œé”™è¯¯ connection refused</td><td>ç›®æ ‡ç«¯å£æœªç›‘å¬ / æœåŠ¡æœªå¯åŠ¨ / å®‰å…¨ç»„æˆ–é˜²ç«å¢™æ‹’ç»</td><td>Prometheus æœº <code>curl http://host:9100/metrics</code>ï¼›ç›®æ ‡æœº `ss -lntp</td><td>grep 9100`ï¼›å¯åŠ¨ exporterï¼›æ”¾é€šå…¥ç«™ï¼›ç¡®è®¤ç›‘å¬åœ°å€é 127.0.0.1</td></tr><tr><td>/targets æ˜¾ç¤º context deadline exceeded / timeout</td><td>ç½‘ç»œæŠ–åŠ¨ã€é“¾è·¯æ…¢ã€ç›®æ ‡ /metrics ç”Ÿæˆæ…¢ï¼Œæˆ– scrape_timeout å¤ªå°</td><td>Prometheus æ—¥å¿— <code>grep scrape</code>ï¼›æŠ“åŒ…/traceï¼›æ‰‹åŠ¨ <code>curl</code> çœ‹å“åº”è€—æ—¶ï¼›å¯¹å• job å¢åŠ  scrape_timeoutï¼›ä¼˜åŒ– exporterï¼›å‡å°‘é«˜å¼€é”€é‡‡é›†é¡¹</td><td/></tr><tr><td>æŠ“å–è¿”å› 404</td><td>ç›®æ ‡æ²¡æœ‰æš´éœ² /metrics æˆ–è·¯å¾„ä¸åŒ</td><td><code>curl -v http://host:port/metrics</code>ï¼›åœ¨ job é…ç½® metrics_pathï¼›ä¿®æ­£ç«¯å£æˆ–ç»„ä»¶çš„ metrics å¼€å…³</td><td/></tr><tr><td>Prometheus å¯åŠ¨æŠ¥é”™ï¼šerror loading config file</td><td>YAML ç¼©è¿›/å­—æ®µåé”™è¯¯</td><td><code>./prometheus --config.file=prometheus.yml --log.level=debug</code>ï¼›ä¿®æ­£ YAMLï¼›ç”¨ <code>promtool check config prometheus.yml</code>ï¼ˆæ¨èï¼‰</td><td/></tr><tr><td>Targets æ­£å¸¸ä½†æŸ¥è¯¢æ— æ•°æ®</td><td>æ—¶é—´èŒƒå›´ä¸å¯¹ / æ—¶é’Ÿæ¼‚ç§» / label è¿‡æ»¤é”™è¯¯</td><td>UI Graph é‡ŒæŸ¥ <code>up</code>ï¼›çœ‹å®ä¾‹æ—¶é—´åŒæ­¥ï¼›æ ¡å‡† NTPï¼›ç”¨ <code>up{job="xxx"}</code> éªŒè¯ï¼›æ£€æŸ¥ label è¿‡æ»¤æ¡ä»¶</td><td/></tr><tr><td>Prometheus å†…å­˜é£™å‡/æŸ¥è¯¢å˜æ…¢</td><td>label åŸºæ•°è¿‡é«˜ã€æŠ“å–ç›®æ ‡è¿‡å¤šã€è§„åˆ™è®¡ç®—é‡</td><td><code>tsdb status</code>ã€çœ‹ <code>prometheus_tsdb_*</code>ã€åˆ†ææ ‡ç­¾ç»´åº¦ï¼›é™ä½ label åŸºæ•°ï¼›åŠ  recording rulesï¼›åˆ†ç‰‡/è”é‚¦/Thanos æ–¹æ¡ˆ</td><td/></tr><tr><td>ç£ç›˜å¿«é€Ÿå¢é•¿</td><td>retention å¤ªé•¿æˆ–é«˜é¢‘é‡‡æ ·ï¼›WAL/blocks å¢é•¿</td><td>è§‚å¯Ÿ data ç›®å½•å¤§å°ï¼›<code>--storage.tsdb.retention.time</code>ï¼›è°ƒæ•´ retentionï¼›é™ä½é‡‡æ ·é¢‘ç‡ï¼›æ‰©å®¹ç£ç›˜ï¼›è¿œç«¯å­˜å‚¨</td><td/></tr><tr><td>é‡‡é›†é—´æ­‡æ€§å¤±è´¥</td><td>DNS è§£æä¸ç¨³å®š/ç›®æ ‡çŸ­æš‚é‡å¯</td><td>Prometheus æ—¥å¿—ä¸é”™è¯¯ç åˆ†å¸ƒï¼›å¯¹æ¯”ç›®æ ‡é‡å¯è®°å½•ï¼›å›ºå®šè§£æ/æ”¹ç”¨ IPï¼›åŠ é‡è¯•ä¸å¥åº·æ£€æŸ¥ï¼›ç›®æ ‡ä¾§ç¨³å®šåŒ–</td><td/></tr></tbody></table>
<h2 data-id="heading-17">å…¶ä»–ç³»åˆ—</h2>
<h3 data-id="heading-18">ğŸš€ AIç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>AIç‚¼ä¸¹æ—¥å¿—-29 - å­—èŠ‚è·³åŠ¨ DeerFlow æ·±åº¦ç ”ç©¶æ¡†<em>æ–œä½“æ ·å¼</em>æ¶ ç§æœ‰éƒ¨ç½² æµ‹è¯•ä¸Šæ‰‹ æ¶æ„ç ”ç©¶</strong>ï¼ŒæŒç»­æ‰“é€ å®ç”¨AIå·¥å…·æŒ‡å—ï¼
<strong>AIç ”ç©¶-132 Java ç”Ÿæ€å‰æ²¿ 2025ï¼šSpringã€Quarkusã€GraalVMã€CRaC ä¸äº‘åŸç”Ÿè½åœ°</strong></p>
<h3 data-id="heading-19">ğŸ’» Javaç¯‡æŒç»­æ›´æ–°ä¸­ï¼ˆé•¿æœŸæ›´æ–°ï¼‰</h3>
<p><strong>Java-218 RocketMQ Java API å®æˆ˜ï¼šåŒæ­¥/å¼‚æ­¥ Producer ä¸ Pull/Push Consumer</strong>
MyBatis å·²å®Œç»“ï¼ŒSpring å·²å®Œç»“ï¼ŒNginxå·²å®Œç»“ï¼ŒTomcatå·²å®Œç»“ï¼Œåˆ†å¸ƒå¼æœåŠ¡å·²å®Œç»“ï¼ŒDubboå·²å®Œç»“ï¼ŒMySQLå·²å®Œç»“ï¼ŒMongoDBå·²å®Œç»“ï¼ŒNeo4jå·²å®Œç»“ï¼ŒFastDFS å·²å®Œç»“ï¼ŒOSSå·²å®Œç»“ï¼ŒGuavaCacheå·²å®Œç»“ï¼ŒEVCacheå·²å®Œç»“ï¼ŒRabbitMQå·²å®Œç»“ï¼ŒRocketMQæ­£åœ¨æ›´æ–°... æ·±å…¥æµ…å‡ºåŠ©ä½ æ‰“ç‰¢åŸºç¡€ï¼</p>
<h3 data-id="heading-20">ğŸ“Š å¤§æ•°æ®æ¿å—å·²å®Œæˆå¤šé¡¹å¹²è´§æ›´æ–°ï¼ˆ300ç¯‡ï¼‰ï¼š</h3>
<p>åŒ…æ‹¬ Hadoopã€Hiveã€Kafkaã€Flinkã€ClickHouseã€Elasticsearch ç­‰äºŒåä½™é¡¹æ ¸å¿ƒç»„ä»¶ï¼Œè¦†ç›–ç¦»çº¿+å®æ—¶æ•°ä»“å…¨æ ˆï¼
<strong>å¤§æ•°æ®-278 Spark MLib - åŸºç¡€ä»‹ç» æœºå™¨å­¦ä¹ ç®—æ³• æ¢¯åº¦æå‡æ ‘ GBDTæ¡ˆä¾‹ è¯¦è§£</strong></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€å‘è€…å¿…çœ‹ï¼TinyProä¸­åå°ç³»ç»Ÿæœ€æ–°Springbootä¸Šæ‰‹æŒ‡å—~]]></title>    <link>https://juejin.cn/post/7597025960946024483</link>    <guid>https://juejin.cn/post/7597025960946024483</guid>    <pubDate>2026-01-20T07:32:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7597025960946024483" data-draft-id="7596670644286554112" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€å‘è€…å¿…çœ‹ï¼TinyProä¸­åå°ç³»ç»Ÿæœ€æ–°Springbootä¸Šæ‰‹æŒ‡å—~"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,Vue.js"/> <meta itemprop="datePublished" content="2026-01-20T07:32:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="OpenTinyç¤¾åŒº"/> <meta itemprop="url" content="https://juejin.cn/user/3808325101432983"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€å‘è€…å¿…çœ‹ï¼TinyProä¸­åå°ç³»ç»Ÿæœ€æ–°Springbootä¸Šæ‰‹æŒ‡å—~
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3808325101432983/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    OpenTinyç¤¾åŒº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-20T07:32:59.000Z" title="Tue Jan 20 2026 07:32:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-20
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ¬æ–‡ç”±TinyProä¸­åå°ç³»ç»Ÿè´¡çŒ®è€…å‘¨æ³½é¾™åŸåˆ›ã€‚</p>
<p>åœ¨é•¿è¾¾ä¸‰ä¸ªæœˆçš„å¼€å‘ä¸‹ï¼Œç»ˆäºTinyProçš„Springbootåç«¯ç‰ˆæœ¬ç»ˆäºè¦é—®ä¸–äº†ï¼Œåœ¨æœ¬æœŸå†…å®¹ä¸­æˆ‘å°†å¸¦å¤§å®¶ä¸€æ­¥æ­¥å»æ­å»ºæ•´ä¸ªåç«¯çš„æµç¨‹ï¼Œä¹Ÿå°†å¸¦å¤§å®¶å»æ¢ç´¢å¯¹äºæœ€æ–°ç‰ˆæœ¬çš„æ›´æ”¹åº”è¯¥å¦‚ä½•å®ç°ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æœ¬é¡¹ç›®è¿›è¡Œä¸€ä¸ªäºŒæ¬¡çš„å¼€å‘å’Œæ¢ç´¢ã€‚
é¦–å…ˆæˆ‘ä»¬å…ˆè¦å¯¹äºTinyProé¡¹ç›®è¿›è¡Œä¸€ä¸ªæ•´ä½“çš„æ‹‰å–ï¼Œå»åˆ°TinyProçš„å®˜æ–¹è¿›è¡Œæ‹‰å–ï¼Œå½“æˆ‘ä»¬è·å–åˆ°é¡¹ç›®ä»¥åå°±å¯ä»¥è¿›è¡Œå¼€å§‹ä»Šå¤©çš„é¡¹ç›®æ„å»ºäº†ã€‚</p>
<blockquote>
<p>æ¥ä¸‹æ¥çš„æµç¨‹å°±æ˜¯å¯¹äºå‰ç«¯ié¡¹ç›®çš„æ­å»ºä»¥åŠåç«¯çš„springbooté¡¹ç›®çš„æ­å»ºï¼Œæœ€åå†å»ä»‹ç»å’±ä»¬æ–°ç‰ˆæœ¬é‡Œé¢çš„ä¸€äº›ç‰¹æ€§å’Œç»„ä»¶</p>
</blockquote>
<h2 data-id="heading-0">1.å‰ç«¯éƒ¨åˆ†çš„æ­å»º</h2>
<p>é¦–å…ˆè¦ç¡®ä¿å’±ä»¬å®‰è£…äº†Node.jsã€NPMã€TinyCLIæ¥ä¸‹æ¥å°±è¦æ­£å¼åˆå§‹åŒ–é¡¹ç›®äº†é¦–å…ˆæˆ‘ä»¬è¿›è¡Œåˆå§‹åŒ–</p>
<p>(1)åœ¨å‘½ä»¤è¡Œè¾“å…¥tiny init proå¯¹é¡¹ç›®è¿›è¡Œä¸€ä¸ªåˆå§‹åŒ–å…·ä½“çš„æµç¨‹å¯ä»¥çœ‹æˆ‘çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.bilibili.com%2Fvideo%2FBV1kNkeBKEEt%2F%3Fspm_id_from%3D333.1387.homepage.video_card.click" target="_blank" title="https://www.bilibili.com/video/BV1kNkeBKEEt/?spm_id_from=333.1387.homepage.video_card.click" ref="nofollow noopener noreferrer">è§†é¢‘ä»‹ç»</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b7d9c92f0a51472eb3bcbbababdb1c4f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=PD3cF0Dqgc4qUakaF8Jm5u1eXcI%3D" alt="img_v3_02u4_d0333bf1-9980-431d-be2b-dbfe8a3e66cg.jpg" loading="lazy"/>
(2)æ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬è¿›å…¥åˆ°æˆ‘ä»¬çš„é¡¹ç›®é‡Œé¢ï¼Œtinyvueçš„å‰ç«¯ä»£ç é‡Œé¢æˆ‘ä»¬é¦–å…ˆè¿›è¡Œä¸€ä¸ªé¡¹ç›®çš„ä¾èµ–çš„ä¸‹è½½å¤§å®¶å¯ä»¥ä½¿ç”¨npm installè¿›è¡Œé¡¹ç›®ä¾èµ–çš„ä¸‹è½½ã€‚</p>
<p>(3)å½“æˆ‘ä»¬é¡¹ç›®ä¾èµ–ä¸‹è½½å®Œæˆåå°±å¯ä»¥è¿›å…¥åˆ°ä¸€ä¸ªå¯åŠ¨æµç¨‹äº†ï¼Œä½¿ç”¨npm startè¿›è¡Œä¸€ä¸ªé¡¹ç›®çš„å¯åŠ¨å¯åŠ¨åå°±ä¼šå¼€å¯3031ç«¯å£è¿™æ ·å°±å¯ä»¥çœ‹è§é¡¹ç›®çš„å¯åŠ¨ç•Œé¢äº†!</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/83b7c197cfea4aa3b775ae959616d5ba~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=szFA%2FoAcPMSIHhTVD7FUviIzQPs%3D" alt="img_v3_02u4_000ed57c-e850-4949-9f38-5309dd9e69ag.png" loading="lazy"/></p>
<blockquote>
<p>åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬çš„å‰ç«¯é¡¹ç›®å°±ç®—æ­£å¼å¯åŠ¨æˆåŠŸäº†ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬ä¸€èµ·å¼€å§‹å¯åŠ¨åç«¯é¡¹ç›®</p>
</blockquote>
<h2 data-id="heading-1">2.åç«¯é¡¹ç›®çš„æ­å»º</h2>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ç¡®ä¿è‡ªå·±çš„æœ¬åœ°ç¯å¢ƒé‡Œé¢æœ‰jdk17ï¼Œmaven,mysql,redisä»¥åŠä¸€ä¸ªè‡ªå·±å–œæ¬¢çš„å¼€å‘è½¯ä»¶å¯ä»¥ideaæˆ–è€…vscode</p>
<blockquote>
<p>å¥½äº†å‡†å¤‡å·¥ä½œåšå¥½ä»¥åæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬è¿›å…¥åç«¯çš„å¼€å‘å’Œåç«¯äºŒæ¬¡å¼€å‘çš„ä¸€ä¸ªä»‹ç»å¹¶ä¸”æˆ‘ä¹Ÿå°†å¸¦ç€å¤§å®¶å»äº†è§£springbooté‡Œé¢çš„ä¸€äº›è®¾è®¡å’Œé‡Œé¢çš„ä¸€äº›å‡½æ•°çš„å†…å®¹æ¥ä¸‹æ¥å¼€å§‹å§</p>
</blockquote>
<p>é¡¹ç›®ç»“æ„çš„ä»‹ç»ï¼š
å½“è¿›å…¥åˆ°é¡¹ç›®é‡Œé¢çš„æ—¶å€™æˆ‘ä»¬æœ€ç›´è§‚çš„å¯ä»¥çœ‹è§é¡¹ç›®çš„ä¸€ä¸ªæ•´ä½“ç»“æ„</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/701e11f942be46b98746a11c9e706c43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=cv4SM3zP5ZCdYrtEF%2FAeZCyhr%2Bg%3D" alt="img_v3_02u4_fefceef2-2098-4f7d-8b32-9895a6f1faag.png" loading="lazy"/>
ï¼ˆ1ï¼‰å…ˆä»‹ç»ä¸€ä¸‹é¡¹ç›®çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯¹äºæ‰€æœ‰çš„springbooté¡¹ç›®ä¸Šæ¥ç¬¬ä¸€ä»¶äº‹å°±ç®—çœ‹é…ç½®æ–‡ä»¶<code>application.properties</code>æ–‡ä»¶è¿™ä¸ªæ–‡ä»¶é‡Œé¢åŒ…å«äº†æ‰€æœ‰é¡¹ç›®éœ€è¦çš„é…ç½®æ¯”å¦‚ï¼š<code>mysql</code>,<code>redis</code>,<code>Springjpa</code>,<code>mybatis-plus</code>(é¡¹ç›®é‡Œé¢æ²¡æœ‰ä½¿ç”¨ï¼Œä½†æ˜¯åŸºæœ¬çš„é…ç½®éƒ½é…ç½®å¥½äº†ï¼Œä¹Ÿå°±å…¼å®¹äº†å–œæ¬¢ä½¿ç”¨mybatis-plusçš„åŒå­¦ï¼‰å¤§å®¶å¯ä»¥æ›´å…·è‡ªå·±çš„æ•°æ®åº“ä¿¡æ¯å’Œredisè¿›è¡Œé…ç½®ï¼Œéœ€è¦è‡ªå·±å¡«å†™å¥½æ•°æ®åº“çš„ç”¨æˆ·åï¼Œç«¯å£å’Œé©±åŠ¨åœ°å€ï¼Œè¿˜æœ‰redisçš„é…ç½®ä¿¡æ¯æ¯”å¦‚ä¸»æœºåœ°å€å’Œç«¯å£å·</p>
<blockquote>
<p>åˆ°è¿™é‡Œçš„åŒå­¦ï¼Œé‚£å°±æ­å–œå¤§å®¶æ•°æ®æœåŠ¡çš„é…ç½®æˆ‘ä»¬å°±æ˜¯åšå¥½äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¯¹é¡¹ç›®çš„ä¾èµ–çš„ä¸‹è½½ï¼Œè¿™å—ä¸»è¦æ¶‰åŠåˆ°mavençš„ä½¿ç”¨ï¼Œå¦‚æœè¿˜ï¼Œæ²¡æœ‰ä¸‹è½½mavençš„åŒå­¦è®°å¾—èµ¶å¿«å»ä¸‹è½½</p>
</blockquote>
<p>ï¼ˆ2ï¼‰æ¥ä¸‹æ¥å¼€å§‹é¡¹ç›®ä¾èµ–çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œåœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹é¡¹ç›®çš„ä¾èµ–åŒ…å»å®˜æ–¹çš„ä»“åº“é‡Œé¢ä¸‹è½½(è¿™å—ç»™å¤§å®¶ä¸€ä¸ªæé†’ï¼Œå¦‚æœä¸‹è½½è¿‡æ…¢çš„åŒå­¦è®°å¾—å»é…ç½®ä¸€ä¸‹mavençš„å›½å†…é•œåƒæºè¿›è¡Œä¸‹è½½å’Œé…ç½®),æ•²å…¥å‘½ä»¤
<code>mvn install</code>è¿›è¡Œä¸€ä¸ªé¡¹ç›®ä¾èµ–çš„ä¸‹è½½ã€‚</p>
<blockquote>
<p>å¦‚æœåˆ°è¿™é‡Œéƒ½æ‰§è¡ŒæˆåŠŸï¼Œå¤§å®¶å°±å¯ä»¥æ­£å¼çš„å¯åŠ¨é¡¹ç›®ï¼Œæ­£å¼å¯åŠ¨é¡¹ç›®ä¹‹å‰æˆ‘å¸Œæœ›å¤§å®¶å¯ä»¥å»æŸ¥çœ‹è‡ªå·±jdkçš„é…ç½®æ˜¯å¦æ˜¯17ï¼Œå› ä¸ºæ¥ä¸‹æ¥çš„å¿…é¡»è¦ä½¿ç”¨jdk17äº†</p>
</blockquote>
<p>ï¼ˆ3ï¼‰è¿›å…¥åˆ°<code>TinyProApplication</code>æ–‡ä»¶é‡Œé¢è¿›è¡Œå¯åŠ¨é¡¹ç›®ï¼Œåœ¨è¿™ä¹‹å‰éœ€è¦ç¡®ä¿å¯åŠ¨äº†rediså’Œmysqlçš„æœåŠ¡ï¼Œå¹¶ä¸”é…ç½®å¥½äº†å¯†ç ï¼Œç„¶åå¯åŠ¨é¡¹ç›®ä»¥åæˆ‘ä»¬å°±ä¼šçœ‹åˆ°ä¸€ä¸ªæç¤ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9dde58377ecc49d987e66a1f51fe5662~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=wIVliMypuqN4Dq5U6Sr3PEVz%2Bq8%3D" alt="img_v3_02u4_fe85ca7b-734e-404e-87b6-88039cbcd7dg.png" loading="lazy"/>
è¿™é‡Œå°±ç®—è¯æ˜é¡¹ç›®çš„æ•´ä½“æ­£å¼å¯åŠ¨æˆåŠŸäº†ï¼Œæ¥ä¸‹æ¥å°±å¼€å§‹ç›‘å¬3000ç«¯å£äº†ã€‚</p>
<blockquote>
<p>é¡¹ç›®å¯åŠ¨æˆåŠŸä»¥åå°±å¯ä»¥å¼€å§‹è¿›è¡Œä¸€ä¸ªäº¤äº’äº†ï¼Œå¤§å®¶å°±å¯ä»¥è¿›å…¥åˆ°åˆšæ‰å¯åŠ¨çš„å‰ç«¯é¡¹ç›®é‡Œé¢å‡†å¤‡è¿›è¡Œä¸€ä¸ªäº¤äº’ï¼Œè´¦æˆ·å’Œå¯†ç éƒ½æ˜¯adminï¼Œè¿™å—æ˜¯é…ç½®é‡Œé¢é¢„å…ˆå†™å¥½çš„ï¼Œå¦‚æœæœ‰äººéœ€è¦ä¿®æ”¹è¿™ä¸ªç”¨æˆ·å’Œè§’è‰²åç§°ï¼Œå¯ä»¥è¿›åˆ° <code>DataInitializer</code>æ–‡ä»¶é‡Œé¢æ‰¾åˆ°useré…ç½®è¿›è¡Œä¿®æ”¹</p>
</blockquote>
<h2 data-id="heading-2">3.äºŒæ¬¡å¼€å‘çš„è®²è§£</h2>
<p>é¦–é€‰é¡¹ç›®é‡Œé¢å¯ä»¥è¿›è¡ŒäºŒæ¬¡å¼€å‘çš„åœ°æ–¹å°±ç®—ï¼Œ<code>æƒé™ç®¡ç†</code>ï¼Œ<code>æ‹’ç»ç­–ç•¥</code>ï¼Œä»¥åŠ<code>ç”¨æˆ·çš„ç™»å½•æ ¡éªŒ</code>ï¼Œ<code>åˆå§‹åŒ–é…ç½®</code></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3935bc5188a148f48fe92f29e67741c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=LHlQphv2XjgjpKsrewc2y44vvN4%3D" alt="img_v3_02u4_2f360650-8906-4132-92e6-72d89be6f99g.png" loading="lazy"/></p>
<p>ï¼ˆ1ï¼‰é¦–å…ˆå°±æ˜¯é¡¹ç›®çš„æƒé™ç®¡ç†çš„é—®é¢˜å¤§å®¶å¯ä»¥çœ‹è§ä»£ç é‡Œé¢é¦–å…ˆéœ€è¦æƒé™æ ¡éªŒçš„æ¥å£ä¸Šé¢éƒ½ä¼šæœ‰ä¸€ä¸ª</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fd33d0cd642940e7be2e4c3bdc20ef2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=lndcFyvqbmleoqlETzIWhTZcDqk%3D" alt="6.png" loading="lazy"/>
<code>@PermissionAnnotation</code>è¿™ä¸ªæ³¨è§£é‡Œé¢é…ç½®çš„å°±æ˜¯å½“å‰æ¥å£éœ€è¦ç”¨æˆ·æ‰€æ‹¥æœ‰çš„æƒé™ï¼Œç„¶åè¿™å—é‡Œé¢åº•å±‚çš„å®ç°ç»†èŠ‚åœ¨aspectè¿™ä¸ªç›®å½•é‡Œé¢ï¼Œç„¶åé‡Œé¢å°±æ˜¯å¯¹äºapoçš„ä¸€ä¸ªä½¿ç”¨ã€‚å¦‚æœå¤§å®¶éœ€è¦ç»™æŸä¸€ä¸ªæ¥å£å¢åŠ æ–°çš„æƒé™å¤§å®¶å°±å¯ä»¥ç›´æ¥åœ¨æ¥å£çš„ä¸Šé¢è¿›è¡Œä¸€ä¸ªä½¿ç”¨ç„¶åå†™å…¥å…·ä½“è¦é™åˆ¶çš„ç»†èŠ‚
æ¯”å¦‚å¯ä»¥å†™ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aa3e0ca85c714052a9635d991d66ef60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=yhRC2e6y2dpk2sjZOIFjxNMAhfY%3D" alt="7.png" loading="lazy"/>
è¿™å—å°±æ˜¯è¦æ±‚ç”¨æˆ·å¿…é¡»è¦æœ‰menu::query::listè¿™ä¸ªæƒé™æ‰èƒ½è¿›å…¥åˆ°è¿™ä¸ªæ¥å£é‡Œé¢è¿›è¡ŒæŸ¥è¯¢æ“ä½œå¦‚æœå¤§å®¶æƒ³æ›´è¿›ä¸€æ­¥äº†è§£åˆ°æƒé™ç®¡ç†çš„ç»†èŠ‚ï¼Œå¯ä»¥å»çœ‹aopçš„ä½¿ç”¨javaé‡Œé¢çš„åˆ‡é¢ç¼–ç¨‹</p>
<p>ï¼ˆ2ï¼‰æ¥ä¸‹æ¥å¯ä»¥çœ‹æ‹’ç»çš„ç­–ç•¥ï¼Œé¦–å…ˆå¯¹äºæ¥å£æ‹’ç»ç­–ç•¥çš„å…·ä½“æ§åˆ¶åœ¨é…ç½®æ–‡ä»¶é‡Œé¢ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f896e4900904987807a11eba0e56d70~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=bq%2FGbSxS63%2FSZXPnAPZvJyPMVVk%3D" alt="8.PNG" loading="lazy"/><br/>
è¿™å—å°±æ˜¯ä¸€ä¸ªæ‹’ç»ç­–ç•¥çš„å¼€å…³ï¼Œå¦‚æœå¤§å®¶æƒ³å¼€å§‹æ‹’ç»ç­–ç•¥å°±å¯ä»¥ç›´æ¥è¾“å…¥trueè¿™ä¸ªç„¶åå°±ä¼šå¼€å¯æ‹’ç»ç­–ç•¥è¿›è¡Œé¡¹ç›®æ¨¡å¼ï¼Œç›®å‰æ˜¯é»˜è®¤åœ¨æ¼”ç¤ºæ¨¡å¼é‡Œé¢</p>
<blockquote>
<p>è¿™ä¸ªé‡Œé¢ä¸»è¦åˆ†ä¸ºä¸€ä¸ªæ¼”ç¤ºæ¨¡å¼å’Œä¸€ä¸ªé¡¹ç›®æ¨¡å¼ï¼Œåœ¨é¡¹ç›®æ¨¡å¼é‡Œé¢å¤§å®¶å¯ä»¥è‡ªç”±çš„è¿›è¡Œæ§åˆ¶ä½†æ˜¯åœ¨æ¼”ç¤ºæ¨¡å¼é‡Œé¢ï¼Œæœ‰å¾ˆå¤šçš„åŠŸèƒ½éƒ½è¢«ç¦æ­¢äº†ï¼Œæ‰€ä»¥å¤§å®¶è¦æ˜¯ä¸èƒ½ä½¿ç”¨çš„è¯å°±éœ€è¦å…ˆæŸ¥çœ‹æ˜¯å¦æ˜¯å› ä¸ºåœ¨æ¼”ç¤ºæ¨¡å¼é‡Œé¢å¯¼è‡´çš„</p>
</blockquote>
<p>ï¼ˆ3ï¼‰æ¥ä¸‹æ¥å°±æ˜¯ç”¨æˆ·çš„ç™»å½•æ ¡éªŒï¼Œå¤§å®¶é¦–å…ˆè¦æ˜ç™½çš„ä¸€ä¸ªæµç¨‹å°±æ˜¯ç”¨æˆ·é¦–å…ˆè¦ç™»å½•ï¼Œåªæœ‰ç™»å½•æˆåŠŸä»¥åæ‰ä¼šå°†tokenæ”¾åˆ°redisé‡Œé¢ï¼Œç„¶åç”¨æˆ·ç™»å½•çš„æ ¡éªŒå°±ä¼šå…ˆå»redisé‡Œé¢è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœæŸ¥è¯¢çš„åˆ°å°±ä¼šé€šè¿‡æ ¡éªŒï¼Œå¦‚æœredisé‡Œé¢æ²¡æœ‰å½“å‰ç”¨æˆ·äººçš„ä¿¡æ¯å°±ä¼šè¿›è¡Œä¸€ä¸ªæ‹’ç»çš„è¿”å›ï¼Œç„¶åå°±ä¼šè·³è½¬åˆ°å‰ç«¯çš„ç™»å½•ç•Œé¢é‡Œé¢è¿›è¡Œä¸€ä¸ªç™»å½•ã€‚å…·ä½“å°±æ˜¯æ‹¿ä¸€ä¸ªæ‹¦æˆªå™¨è¿›è¡Œæ‹¦æˆªç„¶åå¯¹æ¯ä¸€ä¸ªè¯·æ±‚éƒ½è¿›è¡Œæ ¡éªŒåªæœ‰ç™»å½•è¿‡çš„æ‰èƒ½è¿›è¡Œé¡¹ç›®çš„æ“ä½œ
ï¼ˆ4ï¼‰é¡¹ç›®çš„åˆå§‹åŒ–æ•´ä¸ªé¡¹ç›®çš„åˆå§‹åŒ–éƒ½åœ¨DataInitializer.javaè¿™ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œå¦‚æœåç»­éœ€è¦è¿›è¡Œä¸€ä¸ªé¡¹ç›®çš„åˆå§‹åŒ–è°ƒæ•´ï¼Œæ¯”å¦‚æ›´æ”¹åˆå§‹åŒ–çš„é¡ºåºä»¥åŠåœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­æƒ³å†åŠ è½½ä¸€äº›èµ„æºéƒ½å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢è¿›è¡Œå¢åŠ </p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f49db8e6fe74d9e94461ed3cc647534~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=IuM2%2F3ze4UJSK2eIJyt6LWF5YfY%3D" alt="9.png" loading="lazy"/></p>
<p>åœ¨è¿™ä¸ªrunæ–¹æ³•é‡Œé¢è¿›è¡Œæ·»åŠ ï¼Œè¿™æ ·é¡¹ç›®åœ¨å¯åŠ¨çš„æ—¶å€™å°±ä¼šå…ˆå»åŠ è½½é¡¹ç›®é‡Œé¢çš„å†…å®¹ç„¶åç”Ÿæˆä¸€ä¸ªdataæ–‡ä»¶å¤¹çš„ï¼Œè¿™å°±æ ‡å¿—ç€é¡¹ç›®ä»¥åŠåˆå§‹åŒ–è¿‡äº†ï¼Œä¸éœ€è¦å†è¿›è¡Œåˆå§‹åŒ–ï¼Œæ¥ä¸‹æ¥æ¯æ¬¡çš„é¡¹ç›®åˆå§‹åŒ–éƒ½ä¼šå…ˆå»çœ‹é¡¹ç›®é‡Œé¢æ˜¯å¦æœ‰dataçš„ç›®å½•å¦‚æœå­˜åœ¨å°±ä¸èµ°åˆå§‹åŒ–çš„é€»è¾‘äº†</p>
<blockquote>
<p>å¥½äº†è®²è§£å®ŒäºŒæ¬¡å¼€å‘ä»¥åï¼Œæ¥ä¸‹æ¥å°±è¦è¿›å…¥åˆ°dockerçš„ä¸€ä¸ªéƒ¨ç½²æµç¨‹ï¼Œåœ¨è¿™ä¸ªä¹‹å‰ï¼Œå¤§å®¶å¯ä»¥æ›´å…·çš„è‡ªå·±çš„æƒ…å†µå»çœ‹æ˜¯å»ä¹°ä¸€ä¸ªäº‘æœåŠ¡å™¨è¿˜æ˜¯è‡ªå·±æ­å»ºä¸€ä¸ªè™šæ‹Ÿæœºç¯å¢ƒï¼Œç„¶åè¿›è¡Œé…ç½®ï¼Œæˆ‘åœ¨è§†é¢‘é‡Œé¢ç»™æ­å»ºæ¼”ç¤ºçš„å°±æ˜¯åœ¨è‡ªå·±çš„è™šæ‹Ÿæœºé‡Œé¢è¿›è¡Œä¸€ä¸ªdockerçš„éƒ¨ç½²å’Œè°ƒç”¨</p>
</blockquote>
<h2 data-id="heading-3">4.dockerçš„éƒ¨ç½²è®²è§£</h2>
<p>é¦–å…ˆè¦äº†è§£åœ¨è¿›è¡Œdockeréƒ¨ç½²çš„æ—¶å€™ï¼Œè‡ªå·±çš„å®¹å™¨æ–‡ä»¶é‡Œé¢çš„å†…å®¹æ˜¯å¦åˆ›å»ºå¥½äº†ï¼Œä»¥åŠå¯¹åº”çš„docker-compose.ymlçš„ä¸€ä¸ªé…ç½®</p>
<blockquote>
<p>å†æ£€æŸ¥å®Œè¿™äº›å†…å®¹ä»¥åå°±è¦è¿›å…¥åˆ°æˆ‘ä»¬çš„ä¸€ä¸ªdockerçš„éƒ¨ç½²æµç¨‹ç¯èŠ‚ï¼Œå…¶å®æœ¬è´¨ä¸Šä¹Ÿå¾ˆç®€å•å°±æ˜¯è¿›å…¥åˆ°é¡¹ç›®çš„æ–‡ä»¶å¤¹ç›®å½•é‡Œé¢ï¼Œç„¶åç›´æ¥æ‰§è¡Œdocker compose up -dè¿™ä¸ªå‘½ä»¤ä»¥åï¼Œç­‰å¾…ä¸‹è½½ï¼Œä½†æ˜¯ä¸‹è½½çš„è¿‡ç¨‹é‡Œé¢ä¼šæœ‰å¾ˆå¤šçš„é—®é¢˜æ¯”å¦‚ä¸‹è½½è¿‡æ…¢é—®é¢˜</p>
</blockquote>
<p>ï¼ˆ1ï¼‰å°†é¡¹ç›®çš„æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šé¢</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/94845f611dc2484eb22351ffc7e712d4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=rLs6MrTtaM7EITyt7VEhs29kUgI%3D" alt="10.png" loading="lazy"/></p>
<p>ç„¶åè¿›å…¥å½“å‰ç›®å½•å¤§å®¶å¯ä»¥çœ‹è§ï¼Œé¡¹ç›®é‡Œé¢æœ‰ä¸¤ä¸ªæ–‡ä»¶ä¸€ä¸ªæ˜¯Dockerfileå¦ä¸€ä¸ªæ˜¯docker-compose.ymlç€ä¸¤ä¸ªæ–‡ä»¶æ˜¯æˆ‘ä»¬å¿…é¡»è¦çš„æ–‡ä»¶ï¼Œè¿›å…¥è¿›å»çœ‹è§</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d53301bf3d444984b13125440ce36336~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=H7LDweVuhN6eDf8mIiSwErSfOQo%3D" alt="11.png" loading="lazy"/></p>
<p>é‡Œé¢å°±æ˜¯ä¸€äº›é…ç½®æ¯”å¦‚mysqlçš„åœ°å€ä»¥åŠredisçš„åœ°å€ï¼Œéƒ½æ˜¯å¯¹åº”ç€æˆ‘ä»¬å³å°†å¯åŠ¨çš„å®¹å™¨åç§°</p>
<p>ï¼ˆ2ï¼‰æ¥ä¸‹æ¥å°±å¼€å§‹æ­£å¼çš„å¯åŠ¨docker-compose.ymlæ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤<code>docker compose up -d</code>å¯åŠ¨æˆåŠŸä»¥åå°±å¯ä»¥è¿›è¡Œå‰ç«¯ç«¯å£çš„é…ç½®æ˜ å°„åˆ°çº¿ä¸Šçš„dockeråœ°å€ï¼Œæ–¹ä¾¿æœªæ¥çš„å¼€å‘<br/>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7c69c65c2a994d909ee91e3e4789bf10~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgT3BlblRpbnnnpL7ljLo=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769499680&amp;x-signature=kXMzl3AdEIFNLT2JzlBgXDPtrCc%3D" alt="11.png" loading="lazy"/></p>
<p>è¿™ä¸ªå°±æ˜¯å¯åŠ¨æˆåŠŸäº†ï¼Œå¤§å®¶å¯ä»¥çœ‹æ˜ å°„çš„åœ°å€è¿›è¡Œä¿®æ”¹å‰ç«¯çš„é…ç½®äº†</p>
<h2 data-id="heading-4">5.æœ¬æ¬¡å‚åŠ å¼€æºä¹‹å¤çš„æ„Ÿå—å’Œæ”¶è·</h2>
<p>åœ¨å‚åŠ å®Œè¿™æ¬¡çš„å¼€æºä¹‹å¤ä»¥åï¼Œæˆ‘æœ€å¤§çš„æ„Ÿå—å°±æ˜¯ç¬¬ä¸€æ¬¡æœ‰ä¸€ä¸ªæ•´é½çš„è®¡åˆ’å’Œè€å¸ˆè¿˜æœ‰åˆ«çš„å­¦æ ¡çš„åŒå­¦ä»¬å¯ä»¥ä¸€èµ·å¼€å‘ä¸€ä¸ªè½¯ä»¶ï¼Œè®©æˆ‘è¿˜æ²¡å‡ºç¤¾ä¼šçš„æ—¶å€™å°±å·²ç»æ‹¥æœ‰äº†ç‹¬ç«‹å¼€å‘çš„ç»éªŒå’Œç»å†ã€‚å…¶æ¬¡å°±æ˜¯è€å¸ˆçš„è¾…å¯¼å’Œç¤¾åŒºçš„æ•™å¯¼è®©æˆ‘çœŸçš„æˆé•¿äº†å¾ˆå¤šï¼Œæˆ‘ç‰¹åˆ«æ„Ÿè°¢å¼€æºä¹‹å¤å’Œ+OpenTinyç¤¾åŒºå¯¹æˆ‘çš„å¸®åŠ©,æœ€åè°¢è°¢æˆ‘çš„å¯¼å¸ˆï¼ˆçœŸçš„å¾ˆç‰›ï¼‰ï¼Œä»–ä¹Ÿå¾ˆè€å¿ƒçš„æ•™æˆ‘ï¼Œç‰¹åˆ«æ„Ÿè°¢åå­—çš„è¯å°±ä¸è¯´äº†ï¼Œä¸ç„¶ä»¥åæœ‰äººçƒ¦ä»–å»äº†</p>
<blockquote>
<p>è°¢è°¢å¤§å®¶æˆ‘çœŸçš„å¾ˆçæƒœè¿™æ¬¡æœºä¼šï¼Œè°¢è°¢å¼€æºä¹‹å¤ï¼Œè°¢è°¢OpenTinyç¤¾åŒºï¼Œè°¢è°¢å¯¼å¸ˆï¼Œé‚£æˆ‘çš„è¿™æ¬¡å¼€æºä¹‹æ—…å°±ç»“æŸï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡åªæ˜¯æš‚æ—¶ï¼Œæˆ‘ä»¥åè¿˜ä¼šç»§ç»­æŠ•èº«åˆ°å¼€æºé‡Œé¢ï¼Œä¹Ÿå¸Œæœ›å¯ä»¥å¸®åŠ©æ›´å¤šçš„äºº</p>
</blockquote>
<h2 data-id="heading-5">å…³äºOpenTiny</h2>
<p>æ¬¢è¿åŠ å…¥ OpenTiny å¼€æºç¤¾åŒºã€‚æ·»åŠ å¾®ä¿¡å°åŠ©æ‰‹ï¼šopentiny-official ä¸€èµ·å‚ä¸äº¤æµå‰ç«¯æŠ€æœ¯ï½</p>
<p>OpenTiny å®˜ç½‘ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fopentiny.design" target="_blank" title="https://opentiny.design" ref="nofollow noopener noreferrer">opentiny.design</a></strong><br/>
OpenTiny ä»£ç ä»“åº“ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny" target="_blank" title="https://github.com/opentiny" ref="nofollow noopener noreferrer">github.com/opentiny</a></strong><br/>
TinyPro æºç ï¼š<strong><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-pro" target="_blank" title="https://github.com/opentiny/tiny-pro" ref="nofollow noopener noreferrer">github.com/opentiny/tiâ€¦</a></strong><br/>
æ¬¢è¿è¿›å…¥ä»£ç ä»“åº“ StarğŸŒŸTinyEngineã€TinyVueã€TinyNGã€TinyCLIã€TinyEditor~
å¦‚æœä½ ä¹Ÿæƒ³è¦å…±å»ºï¼Œå¯ä»¥è¿›å…¥ä»£ç ä»“åº“ï¼Œæ‰¾åˆ° good first issueæ ‡ç­¾ï¼Œä¸€èµ·å‚ä¸å¼€æºè´¡çŒ®~</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä»é€å¤–å–çœ‹Android Cleanæ¶æ„ï¼šä¸ºä»€ä¹ˆè€æ¿ä¸éœ€è¦çŸ¥é“å¤–å–å‘˜å¼€ä»€ä¹ˆè½¦ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596187471774138377</link>    <guid>https://juejin.cn/post/7596187471774138377</guid>    <pubDate>2026-01-19T00:04:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596187471774138377" data-draft-id="7582922476222660623" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content=" ä»é€å¤–å–çœ‹Android Cleanæ¶æ„ï¼šä¸ºä»€ä¹ˆè€æ¿ä¸éœ€è¦çŸ¥é“å¤–å–å‘˜å¼€ä»€ä¹ˆè½¦ï¼Ÿ"/> <meta itemprop="keywords" content="Android"/> <meta itemprop="datePublished" content="2026-01-19T00:04:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ½œé¾™å‹¿ç”¨ä¹‹åŒ–éª¨é¾™"/> <meta itemprop="url" content="https://juejin.cn/user/2313028195058471"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
             ä»é€å¤–å–çœ‹Android Cleanæ¶æ„ï¼šä¸ºä»€ä¹ˆè€æ¿ä¸éœ€è¦çŸ¥é“å¤–å–å‘˜å¼€ä»€ä¹ˆè½¦ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2313028195058471/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ½œé¾™å‹¿ç”¨ä¹‹åŒ–éª¨é¾™
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T00:04:05.000Z" title="Mon Jan 19 2026 00:04:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æƒ³è±¡ä½ ç»è¥ä¸€å®¶å¤–å–å…¬å¸ï¼Œå…¬å¸é‡Œæœ‰ä¸‰ç§è§’è‰²ï¼š</p>
<ol>
<li><strong>è€æ¿</strong>ï¼ˆä½ ï¼‰ï¼šåˆ¶å®šé€é¤è§„åˆ™ï¼Œå…³å¿ƒåˆ©æ¶¦</li>
<li><strong>é¤å…ç»ç†</strong>ï¼šå‡†å¤‡é£Ÿç‰©ï¼Œä¿è¯è´¨é‡</li>
<li><strong>å¤–å–å‘˜</strong>ï¼šæŠŠé£Ÿç‰©é€åˆ°å®¢æˆ·æ‰‹ä¸­</li>
</ol>
<p>ç°åœ¨ï¼Œå¦‚æœä½ æ˜¯è€æ¿ï¼Œä½ éœ€è¦çŸ¥é“æ¯ä¸ªå¤–å–å‘˜æ˜¯<strong>éª‘ç”µåŠ¨è½¦ã€è‡ªè¡Œè½¦è¿˜æ˜¯å¼€è½¦</strong>å—ï¼Ÿéœ€è¦çŸ¥é“ä»–ä»¬ç”¨ä»€ä¹ˆå¯¼èˆª<strong>é«˜å¾·è¿˜æ˜¯ç™¾åº¦</strong>å—ï¼Ÿ</p>
<p><strong>ä¸éœ€è¦ï¼</strong> ä½ åªå…³å¿ƒï¼š</p>
<ul>
<li>é£Ÿç‰©å‡†æ—¶é€åˆ°ï¼ˆ30åˆ†é’Ÿå†…ï¼‰</li>
<li>å®¢æˆ·æ»¡æ„ï¼ˆä¸æ´’ä¸æ¼ï¼‰</li>
<li>å…¬å¸èµšé’±ï¼ˆæˆæœ¬æ§åˆ¶ï¼‰</li>
</ul>
<p>è¿™å°±æ˜¯Cleanæ¶æ„çš„æ ¸å¿ƒæ€æƒ³ï¼è®©æˆ‘ä»¬ç”¨è¿™ä¸ªå¤–å–å…¬å¸çš„ä¾‹å­ï¼Œå½»åº•ç†è§£Androidå¼€å‘ä¸­çš„å…³æ³¨ç‚¹åˆ†ç¦»å’Œä¾èµ–è§„åˆ™ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€å¤–å–å…¬å¸çš„æ··ä¹±ï¼šæ²¡æœ‰Cleanæ¶æ„</h2>
<h3 data-id="heading-1">âŒ æ··ä¹±çš„å¤–å–å…¬å¸ï¼ˆç³Ÿç³•çš„ä»£ç ç»“æ„ï¼‰</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f3640e327ed44fed960f91a2705142d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=XWC6lCCu09IOS3f27q6LD4wGC7Q%3D" alt="image.png" loading="lazy"/>
<strong>é—®é¢˜åˆ†æ</strong>ï¼šè¿™ä¸ªå¤–å–å‘˜å¹²äº†å¨å¸ˆã€æ‰“åŒ…å‘˜ã€å¯¼èˆªå‘˜ã€å¸æœºã€æ”¶é“¶å‘˜ã€æ–‡å‘˜çš„æ‰€æœ‰å·¥ä½œï¼</p>
<h3 data-id="heading-2">âŒ å¦‚æœå…¬å¸è¦æ‰©å¼ ...</h3>
<ul>
<li>æƒ³æ¢å¯¼èˆªè½¯ä»¶ï¼Ÿè¦é‡æ–°åŸ¹è®­æ‰€æœ‰å¤–å–å‘˜</li>
<li>æƒ³å¢åŠ æ–°èœå“ï¼Ÿå¤–å–å‘˜è¦å­¦æ–°èœ</li>
<li>æƒ³æ¢æ”¯ä»˜æ–¹å¼ï¼Ÿå¤–å–å‘˜è¦é‡æ–°å­¦ä¹ </li>
<li>å¤–å–å‘˜ç¦»èŒäº†ï¼Ÿæ‰€æœ‰çŸ¥è¯†éƒ½å¸¦èµ°äº†</li>
</ul>
<h2 data-id="heading-3">äºŒã€ä¸“ä¸šçš„å¤–å–å…¬å¸ï¼šCleanæ¶æ„å®ç°</h2>
<h3 data-id="heading-4">âœ… æ¸…æ™°çš„åˆ†å·¥ï¼ˆå…³æ³¨ç‚¹åˆ†ç¦»ï¼‰</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7110ae5c5d95479cbe67a8cd32360f4c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=3e1bfdOFs3LlPzK1MVR1MMyYkZE%3D" alt="mermaid_20251215_7b952f.png" loading="lazy"/></p>
<h3 data-id="heading-5">2.1 é¢†åŸŸå±‚ï¼šè€æ¿åˆ¶å®šè§„åˆ™ï¼ˆä¸å…³å¿ƒå…·ä½“å®ç°ï¼‰</h3>
<p>domain/model/Delivery.kt - æ ¸å¿ƒä¸šåŠ¡æ¨¡å‹</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/80705802052942149ff9f3120b4d4a55~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=GnDygqEu15Oj167xg%2B9erIjNMEU%3D" alt="image.png" loading="lazy"/></p>
<p>domain/repository/DeliveryRepository.kt - è€æ¿å®šä¹‰çš„æ¥å£</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/97429bb3b6d14707b3eacec507335a1d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=BTB4S2B3OAfvwRx3uK6wi5WHdmE%3D" alt="image.png" loading="lazy"/></p>
<p>domain/usecase/AssignDeliveryUseCase.kt - è€æ¿çš„ä¸šåŠ¡é€»è¾‘</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/46c3a094897546d09cf3026480a79dc2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=OgR9xnkE52qQgDmQx6w3o0Cws%2FI%3D" alt="image.png" loading="lazy"/>
}</p>
<p><strong>è€æ¿ï¼ˆé¢†åŸŸå±‚ï¼‰çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>ä¸çŸ¥é“å¤–å–å‘˜å¼€ä»€ä¹ˆè½¦ï¼ˆä¸å…³å¿ƒå…·ä½“å®ç°ï¼‰</li>
<li>ä¸çŸ¥é“é¤å…ç”¨ä»€ä¹ˆç¶å…·ï¼ˆä¸å…³å¿ƒæ•°æ®æºï¼‰</li>
<li>åªå…³å¿ƒä¸šåŠ¡è§„åˆ™å’Œåˆ©æ¶¦</li>
</ul>
<h3 data-id="heading-6">2.2 æ•°æ®å±‚ï¼šé¤å…å‡†å¤‡é£Ÿç‰©ï¼ˆå…·ä½“å®ç°ï¼‰</h3>
<p>data/repository/DeliveryRepositoryImpl.kt - é¤å…ç»ç†çš„å®ç°</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c8001fcb8e841d9b88a7a80eebc0c42~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=L6hBu9c%2BuTmjY8Rr14F09gQ%2Bvc8%3D" alt="image.png" loading="lazy"/></p>
<p><strong>é¤å…ï¼ˆæ•°æ®å±‚ï¼‰çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å®ç°è€æ¿è¦æ±‚çš„èœå“æ ‡å‡†</li>
<li>å¯ä»¥ä½¿ç”¨å„ç§å¨æˆ¿è®¾å¤‡ï¼ˆRetrofitï¼‰</li>
<li>è´Ÿè´£æŠŠåŸææ–™ï¼ˆç½‘ç»œæ•°æ®ï¼‰åŠ å·¥æˆæ ‡å‡†èœå“ï¼ˆé¢†åŸŸå®ä½“ï¼‰</li>
</ul>
<h3 data-id="heading-7">2.3 è¡¨ç¤ºå±‚ï¼šå¤–å–å‘˜é€é¤ï¼ˆUIå±•ç¤ºï¼‰</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eee320a355184cc499853de3803a4ce8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=QYHLY7jcdZKLVgj2yyY41118xCw%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c787c61188ec4c5f9fbdcce2b38e73f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=dxjp5gRWa9D0LTISnWQgpFH%2FFYw%3D" alt="image.png" loading="lazy"/></p>
<p><strong>å¤–å–å‘˜ï¼ˆè¡¨ç¤ºå±‚ï¼‰çš„ç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>å¯ä»¥æ˜¯ç”µåŠ¨è½¦ã€è‡ªè¡Œè½¦ã€æ±½è½¦ï¼ˆä¸åŒUIå®ç°ï¼‰</li>
<li>å¯ä»¥ä½¿ç”¨ä¸åŒå¯¼èˆªè½¯ä»¶ï¼ˆä¸åŒåœ°å›¾SDKï¼‰</li>
<li>è´Ÿè´£æŠŠé£Ÿç‰©ï¼ˆæ•°æ®ï¼‰å±•ç¤ºç»™å®¢æˆ·ï¼ˆç”¨æˆ·ï¼‰</li>
<li>ä¸å®¢æˆ·äº¤äº’ï¼ˆç”¨æˆ·è¾“å…¥ï¼‰</li>
</ul>
<h2 data-id="heading-8">ä¸‰ã€ä¾èµ–è§„åˆ™ï¼šä¸ºä»€ä¹ˆè€æ¿ä¸éœ€è¦çŸ¥é“å¤–å–å‘˜å¼€ä»€ä¹ˆè½¦ï¼Ÿ</h2>
<h3 data-id="heading-9">3.1 ä¾èµ–å…³ç³»å›¾</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ef0dc9c691614101b33c686414772686~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=y7D%2B3huF0hpPm2XbbTd13KnAzZQ%3D" alt="mermaid_20251215_682d14.png" loading="lazy"/></p>
<h3 data-id="heading-10">3.2 å…³é”®è§„åˆ™ï¼šä¾èµ–åªèƒ½æŒ‡å‘è€æ¿ï¼ˆé¢†åŸŸå±‚ï¼‰</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/59491e0523884905a32d77b399151698~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=A9ZZGMiF8HoTVN3zmSU56hsrgjY%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6ff08593ff57486f9aab2f5de82c08e3~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=39j4hNRuq6ouUzgrlAsyFzQ6QDI%3D" alt="image.png" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/69ccd9562ebe4988b631c4dd77e890eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=E%2FI1aZSza7xq77kQbg4GPHGFLUI%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-11">3.3 ä¾èµ–æ³¨å…¥ï¼šå…¬å¸çš„HRéƒ¨é—¨</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3f17159a7bd34758ab95994e9141f8c5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=7sIfBDFF04%2BL%2BMHwJRoIS5ewSEI%3D" alt="image.png" loading="lazy"/></p>
<p>è€æ¿åªéœ€è¦å‘Šè¯‰HRéœ€è¦ä»€ä¹ˆäººï¼ŒHRè´Ÿè´£æ‹›è˜</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cc3e05bfc8884710bda4ebaf39dac736~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=4PRcOZaZqL0TNByTpaxhJcZoaN4%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-12">4.1 å¦‚ä½•å¼€å§‹é‡æ„ç°æœ‰é¡¹ç›®ï¼Ÿ</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šè¯†åˆ«"è¶…çº§å¤–å–å‘˜"ç±»</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ba03852fdbb40ffbb54652821073f7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=GngjP8IuFcYrz%2FC1kR2t4hgquxw%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ç¬¬äºŒæ­¥ï¼šæå–"è€æ¿è§„åˆ™"ï¼ˆé¢†åŸŸå±‚ï¼‰</strong> å½“ç„¶æˆ‘ä¸å»ºè®®usecase æŠ›å‡ºå¼‚å¸¸,åº”è¯¥åŒ…è£…èµ·æ¥ã€‚è¿™é‡Œåªæ˜¯ä¸¾ä¾‹ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b5fe9ae247be447da0634ea4322e0351~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=fAHCowM%2Bd%2Bkp7a7BUgQCjqBQb8Y%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º"é¤å…å¨æˆ¿"ï¼ˆæ•°æ®å±‚</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bf82fcce0fdf4695b7c93658eaae2ce8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=juqfOqdpirPzCt1YNl8XOFWScaE%3D" alt="image.png" loading="lazy"/></p>
<p><strong>ç¬¬å››æ­¥ï¼šæ”¹é€ "å¤–å–å‘˜"ï¼ˆè¡¨ç¤ºå±‚ï¼‰</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aceed0ee3e944f998b0607393f305bd4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5r2c6b6Z5Yu_55So5LmL5YyW6aqo6b6Z:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769385845&amp;x-signature=88sCn8gGBGhtzP8zE9RORkw8P5Y%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-13">5.2 å¸¸è§é—®é¢˜è§£ç­”</h3>
<p><strong>Qï¼šå°å‹é¡¹ç›®ä¹Ÿéœ€è¦è¿™æ ·åˆ†å±‚å—ï¼Ÿ</strong>
Aï¼šå°±åƒå°å¤–å–åº—å¼€å§‹å¯èƒ½åªæœ‰ä¸€ä¸ªäººï¼ˆè€æ¿å…¼å¨å¸ˆå…¼å¤–å–å‘˜ï¼‰ï¼Œä½†å½“ä¸šåŠ¡å¢é•¿æ—¶ï¼Œä¸€å®šè¦æå‰è§„åˆ’åˆ†å·¥ã€‚å¯ä»¥ä»ç®€å•ä¸‰å±‚å¼€å§‹ã€‚</p>
<p><strong>Qï¼šUseCaseä¼šä¸ä¼šå¤ªå¤šï¼Ÿ</strong>
Aï¼šå°±åƒè€æ¿çš„è§„åˆ™æ–‡æ¡£ï¼Œé‡è¦çš„è§„åˆ™æ‰éœ€è¦å†™æˆUseCaseã€‚ç®€å•çš„CRUDæ“ä½œå¯ä»¥ç›´æ¥åœ¨Repositoryå¤„ç†ã€‚</p>
<p><strong>Qï¼šæµ‹è¯•çœŸçš„å˜å®¹æ˜“äº†å—ï¼Ÿ</strong>
Aï¼šä½ å¯ä»¥å•ç‹¬æµ‹è¯•ï¼š</p>
<ul>
<li>è€æ¿çš„è§„åˆ™ï¼ˆUseCaseæµ‹è¯•ï¼‰â†’ éªŒè¯ä¸šåŠ¡é€»è¾‘</li>
<li>é¤å…çš„èœå“ï¼ˆRepositoryæµ‹è¯•ï¼‰â†’ éªŒè¯æ•°æ®å¤„ç†</li>
<li>å¤–å–å‘˜çš„æœåŠ¡ï¼ˆUIæµ‹è¯•ï¼‰â†’ éªŒè¯ç”¨æˆ·äº¤äº’</li>
</ul>
<p><strong>Qï¼šå­¦ä¹ æˆæœ¬é«˜å—ï¼Ÿ</strong>
Aï¼šå°±åƒåŸ¹è®­å¤–å–å‘˜éœ€è¦æ—¶é—´ï¼Œä½†ä¸€æ—¦æŒæ¡ï¼Œæ•ˆç‡å€å¢ã€‚ä»ä¸€ä¸ªå°åŠŸèƒ½å¼€å§‹å°è¯•ã€‚</p>
<h3 data-id="heading-14">5.3 å¤–å–æ¶æ„çš„ç»ˆæå¥½å¤„</h3>
<ol>
<li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šè€æ¿æ¢è§„åˆ™ï¼Œä¸ç”¨é‡æ–°åŸ¹è®­å¤–å–å‘˜</li>
<li><strong>å¯æµ‹è¯•æ€§</strong>ï¼šå¯ä»¥å•ç‹¬æµ‹è¯•è€æ¿çš„å†³ç­–é€»è¾‘</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šå¢åŠ æ–°åŸå¸‚ã€æ–°äº¤é€šå·¥å…·éƒ½å¾ˆå®¹æ˜“</li>
<li><strong>å›¢é˜Ÿåä½œ</strong>ï¼šå¯ä»¥å¹¶è¡Œå¼€å‘ï¼ˆæœ‰äººè®¾è®¡è§„åˆ™ï¼Œæœ‰äººå¼€å‘UIï¼Œæœ‰äººå¯¹æ¥APIï¼‰</li>
<li><strong>æŠ€æœ¯å‡çº§</strong>ï¼šæ¢å¯¼èˆªã€æ¢åœ°å›¾ã€æ¢æ”¯ä»˜ï¼Œéƒ½ä¸å½±å“æ ¸å¿ƒä¸šåŠ¡</li>
</ol>
<h2 data-id="heading-15">å…­ã€æ€»ç»“ï¼šåƒç»è¥å¤–å–å…¬å¸ä¸€æ ·å†™Androidä»£ç </h2>
<p>è®°ä½è¿™ä¸ªç®€å•çš„åŸåˆ™ï¼š</p>
<p><strong>ä½ çš„ä»£ç åº”è¯¥åƒä¸€ä¸ªä¸“ä¸šçš„å¤–å–å…¬å¸ï¼š</strong></p>
<ul>
<li>
<p><strong>è€æ¿ï¼ˆé¢†åŸŸå±‚ï¼‰</strong>ï¼šåˆ¶å®šè§„åˆ™ï¼Œå…³å¿ƒä¸šåŠ¡ï¼Œä¸å…³å¿ƒå…·ä½“å®ç°</p>
</li>
<li>
<p><strong>é¤å…ï¼ˆæ•°æ®å±‚ï¼‰</strong>ï¼šå‡†å¤‡æ ‡å‡†èœå“ï¼Œå¯ä»¥ç”¨å„ç§å¨å…·</p>
</li>
<li>
<p><strong>å¤–å–å‘˜ï¼ˆè¡¨ç¤ºå±‚ï¼‰</strong>ï¼šä¸“ä¸šé…é€ï¼Œè‰¯å¥½æœåŠ¡ï¼Œçµæ´»åº”å˜</p>
</li>
</ul>
<p><strong>ä¾èµ–è§„åˆ™å°±æ˜¯</strong>ï¼šå¤–å–å‘˜å¬è€æ¿çš„ï¼Œé¤å…æŒ‰è€æ¿çš„æ ‡å‡†åšèœï¼Œä½†è€æ¿ä¸éœ€è¦çŸ¥é“å¤–å–å‘˜å¼€ä»€ä¹ˆè½¦ï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“é¤å…ç”¨ä»€ä¹ˆç‰Œå­çš„ç¶å…·ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SpringBoot 3.0æ–°ç‰¹æ€§ï¼šProblemDetailè®©é”™è¯¯å“åº”ä¸å†å¤´ç–¼]]></title>    <link>https://juejin.cn/post/7596698363933261874</link>    <guid>https://juejin.cn/post/7596698363933261874</guid>    <pubDate>2026-01-19T01:04:05.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596698363933261874" data-draft-id="7596698363933229106" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SpringBoot 3.0æ–°ç‰¹æ€§ï¼šProblemDetailè®©é”™è¯¯å“åº”ä¸å†å¤´ç–¼"/> <meta itemprop="keywords" content="åç«¯,Java,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-19T01:04:05.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SimonKing"/> <meta itemprop="url" content="https://juejin.cn/user/4001878056904584"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SpringBoot 3.0æ–°ç‰¹æ€§ï¼šProblemDetailè®©é”™è¯¯å“åº”ä¸å†å¤´ç–¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4001878056904584/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SimonKing
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T01:04:05.000Z" title="Mon Jan 19 2026 01:04:05 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šã€ç¼–ç¨‹æœèŠ±å¤•æ‹¾ã€‘ï¼Œå¯è·å–é¦–å‘å†…å®¹ã€‚</p>
</blockquote>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/964a52a8cca04e98a0f11066c138586f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=OZlaRgb20mm9rgLlZA5t48LPNAg%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">01 å¼•è¨€</h2>
<p>ä¹‹å‰å†™è¿‡ä¸€ç¯‡å…³äºç»Ÿä¸€ç›¸åº”çš„å‚æ•°å¤„ç†çš„æ–‡ç« ï¼Œæœ‰è·¯è¿‡çš„æœ‹å‹æŒ‡å‡ºé”™è¯¯ä¿¡æ¯ä¸ºä»€ä¹ˆè¿˜è¦ç»Ÿä¸€å¤„ç†ã€‚æŠ€æœ¯å‚¨å¤‡æµ…è–„çš„æˆ‘ä¸€è„¸æ‡µé€¼ï¼Œç»è¿‡äº¤æµæ‰çŸ¥é“ï¼Œå¤§ä½¬ä½¿ç”¨äº†<code>ProblemDetail</code>å¤„ç†å¼‚å¸¸ï¼Œäºæ˜¯ä¸“é—¨å­¦ä¹ äº†ä¸€ä¸‹ï¼Œè®°å½•ä¸‹æ¥åˆ†äº«ç»™å¤§å®¶ã€‚</p>
<h2 data-id="heading-1">02 ç®€ä»‹</h2>
<p><code>org.springframework.http.ProblemDetail</code></p>
<p><code>ProblemDetail</code> æ˜¯ <code>Spring Boot 3.0</code>ï¼ˆSpring Framework 6.0ï¼‰å¼•å…¥çš„ç±»ï¼Œç”¨äºæ ‡å‡†åŒ– <code>HTTP API</code> é”™è¯¯å“åº”æ ¼å¼ï¼Œç¬¦åˆ <a href="https://link.juejin.cn?target=https%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc7807" target="_blank" title="https://tools.ietf.org/html/rfc7807" ref="nofollow noopener noreferrer">RFC 7807</a> æ ‡å‡†ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b105c926af0740ea82ac5f9a8e7326cd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=2hWDOWAzpb9BVkHjkjADJAoEJ0c%3D" alt="" loading="lazy"/></p>
<p>å®˜ç½‘åœ°å€ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.spring.io%2Fspring-boot%2F3.5%2Freference%2Fweb%2Fservlet.html%23web.servlet.spring-mvc.error-handling" target="_blank" title="https://docs.spring.io/spring-boot/3.5/reference/web/servlet.html#web.servlet.spring-mvc.error-handling" ref="nofollow noopener noreferrer">docs.spring.io/spring-bootâ€¦</a></p>
<h3 data-id="heading-2">2.1 å±æ€§</h3>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/139e7ee8fb4a461eb0c4251257effe67~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=Ob3mmqNiFHE9GRcVdfKWAsMwbLQ%3D" alt="" loading="lazy"/></p>
<p><code>private URI type</code>ï¼š é”™è¯¯ç±»å‹æ ‡è¯†ï¼ˆURIæ ¼å¼ï¼‰</p>
<p><code>private String title</code>ï¼šç®€çŸ­é”™è¯¯æè¿°</p>
<p><code>private int status</code>ï¼šHTTPçŠ¶æ€ç </p>
<p><code>private String detail</code>ï¼šè¯¦ç»†é”™è¯¯æè¿°</p>
<p><code>private URI instance</code>ï¼šå…·ä½“é”™è¯¯å®ä¾‹æ ‡è¯†</p>
<p><code>private Map&lt;String, Object&gt; properties</code>ï¼šæ‰©å±•å±æ€§</p>
<h3 data-id="heading-3">2.2 å¼‚å¸¸è¿”å›ä¸€è§ˆ</h3>
<p><code>SpringBoot 3.0</code>ä¹‹å‰çš„æŠ¥é”™ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1093f4f8bd464a8780d6835ecb90915d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=F5ey7cEVtkT%2BmSZr2J63RtJ1yBY%3D" alt="" loading="lazy"/></p>
<p><code>SpringBoot 3.0</code>ä¹‹åçš„æŠ¥é”™ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9f9b3815cd00468ebf197cf2f2b56812~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=DRR9tai5htzXVbCVupb4XFlLS44%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-4">03 ä½¿ç”¨</h2>
<p><code>ProblemDetail</code>çš„ä½¿ç”¨æ˜¯æœ‰è®²ç©¶çš„ï¼Œä¸äº†è§£å…¶ä¸­çš„é“é“ï¼Œå¯èƒ½è§¦å‘ä¸äº†<code>ProblemDetail</code>çš„å¼‚å¸¸åŒ…è£…ã€‚</p>
<h3 data-id="heading-5">3.1 å¯åŠ¨å¼€å…³</h3>
<p><code>SpringBoot</code>æ¡†æ¶é’ˆå¯¹<code>ProblemDetail</code>çš„å¯ç”¨åšäº†å¼€å…³ï¼Œé»˜è®¤å…³é—­ã€‚</p>
<p>é€šè¿‡é…ç½®ç”Ÿæ•ˆï¼š</p>
<pre><code class="hljs language-properties" lang="properties">spring.mvc.problemdetails.enabled=true
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/314e3b787d12464cb8533b0518fa88f4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=RLREzGZgRqLNQSNEkAppapGwask%3D" alt="" loading="lazy"/></p>
<p>é…ç½®ç±»ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f4db194cd492400fb7d09462123017b7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=S%2FRQ1PbhtOTERHlT3LPy1huM81U%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-6">3.2 æµ‹è¯•æ–¹æ³•</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@GetMapping("/divide")</span>
<span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">divide</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b)</span> {
    <span class="hljs-keyword">return</span> a / b; 
}
</code></pre>
<p>å¦‚æœ b=0ï¼Œä¼šè§¦å‘ <code>ArithmeticException</code>ã€‚ä½†æ˜¯è¿™ä¸ªå¼‚å¸¸å¹¶æ²¡æœ‰è§¦å‘<code>ProblemDetail</code>å¼‚å¸¸çš„å°è£…ã€‚</p>
<p>æµ‹è¯•è¯·æ±‚ï¼š<code>http://127.0.0.1:8080/divide?a=10&amp;b=0</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/fb87c2e2785948c9bd4378388912a534~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=PJh74GdpX1qdM%2FNtCPxZ%2BNy9u%2B4%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-7">3.3 åŸå› è¿½æº¯</h3>
<p>æ²¡æœ‰æˆåŠŸï¼Œéš¾é“æ˜¯å› ä¸ºé…ç½®æ²¡æœ‰ç”Ÿæ•ˆã€‚æˆ‘ä»¬ä»å®˜ç½‘æ‰¾ä¸€ç‚¹è››ä¸é©¬è¿¹ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/92bb5b5041f2461387f9421d4b7873b8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=9JnMVG%2B36ZOICLh7zSrVVzv9l6E%3D" alt="" loading="lazy"/></p>
<p>å¤§è‡´æ„æ€æ˜¯ï¼šè¦æƒ³å¯ç”¨RFCå“åº”ï¼Œå¯ä»¥æ‰©å±•<code>ResponseEntityExceptionHandler</code>å¹¶å£°æ˜<code>@ControllerAdvice</code>ã€‚å¤„ç†å™¨é€šè¿‡<code>@ExceptionHandler</code>é‡‡é›†å¼‚å¸¸ï¼Œä¹Ÿå¯ä»¥æ·»åŠ å…¶ä»–å¼‚å¸¸å¹¶æ˜ å°„åˆ°<code>ProblemDetail</code></p>
<p>æ‰€ä»¥æˆ‘ä»¬çœ‹çœ‹<code>ResponseEntityExceptionHandler</code>çš„å­ç±»æœ‰æ²¡æœ‰ç±»ä¼¼çš„å®ç°ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2dba9807ac7340d4abb5fb5bfe33bab2~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=OQVb7XiJrt6pM6ICcRi1hEUjK%2Fc%3D" alt="" loading="lazy"/></p>
<p>é€šè¿‡æŸ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°<code>ProblemDetailsExceptionHandler</code>å­ç±»ï¼Œä¼¼ä¹æ˜¯å¤„ç†<code>ProblemDetail</code>çš„å…³é”®ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ebeb6681d3f94816844c9fbe9273a8c7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=larGrxZeDrqcQMdBvRcIGAEqlNY%3D" alt="" loading="lazy"/></p>
<p><code>@ControllerAdvice</code>æ³¨è§£æˆ‘ä»¬å†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œç”¨äºå‚æ•°ç»‘å®šã€å¼‚å¸¸å¤„ç†ç­‰ã€‚è€Œ<code>ResponseEntityExceptionHandler</code>é»˜è®¤å¤„ç†çš„å¼‚å¸¸ï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/dc5b4a415e724d07b514a786197569ec~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=C1qJcRlehSBfWmvDDwH%2FZuO1kwQ%3D" alt="" loading="lazy"/></p>
<p>æ˜¾ç„¶æ²¡æœ‰<code>ArithmeticException</code>å¼‚å¸¸ï¼Œè‡ªç„¶ä¸ä¼šè¢«å¤„ç†ã€‚</p>
<p>é‚£æˆ‘ä»¬åªéœ€è¦ä½¿ç”¨<code>ResponseEntityExceptionHandler</code>ä¸­çš„å¼‚å¸¸å³å¯ã€‚</p>
<h3 data-id="heading-8">3.4 é‡æ–°æµ‹è¯•</h3>
<p>æµ‹è¯•æ–¹æ³•ä¸­æ¥æ”¶çš„å­—æ®µç±»å‹ä¸ºintï¼Œæˆ‘ä»¬åªéœ€è¦ä¼ å…¥éintç±»å‹çš„æ•°æ®ï¼Œå°±ä¼šè§¦å‘<code>MethodArgumentTypeMismatchException</code>å¼‚å¸¸ã€‚è€Œ<code>MethodArgumentTypeMismatchException</code>ç»§æ‰¿<code>TypeMismatchException</code>å¼‚å¸¸ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/914f07fc4b4045419172467d08c4fecd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=Ji6IiN7knJoDpsCjJ5dJICFmogs%3D" alt="" loading="lazy"/></p>
<p>æµ‹è¯•åœ°å€ï¼š<code>http://127.0.0.1:8080/divide?a=10&amp;b=a</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ee9fb4a7049e49698c596d7a72a6414e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=%2FvUrTvZnMkyiW3X6s1KiWuQ4H7o%3D" alt="" loading="lazy"/></p>
<p>ç»“æœå·²ç»è§¦å‘<code>ProblemDetail</code>çš„ä¿¡æ¯äº†ã€‚</p>
<h2 data-id="heading-9">04 é—®é¢˜</h2>
<p><code>ProblemDetail</code>å¼‚å¸¸åŒ…è£…è§¦å‘äº†ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„å¼‚å¸¸éƒ½å¯ä»¥å…œå¾—ä½ã€‚å³ä¾¿æ˜¯<code>ResponseEntityExceptionHandler</code>ä¸­çš„å¼‚å¸¸ä¹Ÿæœ‰æ²¡æœ‰åŒ…è£…çš„ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b803444a4f04c72b692aa46f2ff5a2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=K3VAZ8glSxpDT8I17pMg35GudGg%3D" alt="" loading="lazy"/></p>
<p>å°ç¼–è¿™é‡Œä¸å¤ªç†è§£ä¸ºä»€ä¹ˆä¼šä»ä¸­é—´åˆ†å¼€ï¼Œä¸ŠåŠéƒ¨åˆ†å¼‚å¸¸ä¸ä¼šè§¦å‘<code>ProblemDetail</code>å¼‚å¸¸åŒ…è£…ï¼Œè€Œä¸‹åŠéƒ¨åˆ†ä¼šè§¦å‘ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬åœ¨éœ€è¦å¤„ç†å…¨å±€å¼‚å¸¸çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æˆ‘ä»¬è‡ªå·±å»å¤„ç†æ‰€æœ‰çš„å¼‚å¸¸ï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰å¼‚å¸¸å·²è¾¾åˆ°ç»Ÿä¸€å‚æ•°ã€‚</p>
<h2 data-id="heading-10">05 è§¦å‘æºç </h2>
<p><code>ProblemDetailsExceptionHandler</code>çš„åŒ…ä½äº<code>org.springframework.boot.autoconfigure.web.servlet</code>ä¸‹ï¼Œåˆæ˜¯å¦‚ä½•é€šè¿‡é…ç½®å¯åŠ¨çš„å‘¢ï¼Ÿ</p>
<p>å½“ç„¶è¿˜æ˜¯è‡ªåŠ¨é…ç½®çš„ç±»ï¼š<code>WebMvcAutoConfiguration</code></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d9e7411b907443bf87fcc0bab46a6ef9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769389445&amp;x-signature=joz4DIxoUp7wgl0ehZe9TYdn6S4%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-11">06 å°ç»“</h2>
<p>æˆ‘ä»¬å¯ä»¥è‡ªå·±é€šè¿‡<code>ProblemDetail</code>å°è£…å¼‚å¸¸ä¿¡æ¯ï¼Œç„¶åç»Ÿä¸€å¼‚å¸¸å‚æ•°ï¼Œå…¨å±€ç»Ÿä¸€å¤„ç†å¼‚å¸¸ï¼Œä»¥è¾¾åˆ°å…¨å±€ç»Ÿä¸€çš„ç›®çš„ã€‚å¯èƒ½é‡Œé¢è¿˜æœ‰å°ç¼–ç†è§£ä¸åˆ°ä½çš„åœ°æ–¹ï¼Œæœ‰é—®é¢˜è¯„è®ºåŒºæŒ‡å‡ºæ¥ï¼Œå°ç¼–åŠ ä»¥ä¿®æ­£ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ•¢ä¸æ•¢æŒ‘æˆ˜ç”¨Cocos3.8å¤åˆ»æ›¾ç»å¾ˆç«çš„å‰²ç»³å­æ¸¸æˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7596384019002081306</link>    <guid>https://juejin.cn/post/7596384019002081306</guid>    <pubDate>2026-01-19T03:30:03.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596384019002081306" data-draft-id="7596339303862386739" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ•¢ä¸æ•¢æŒ‘æˆ˜ç”¨Cocos3.8å¤åˆ»æ›¾ç»å¾ˆç«çš„å‰²ç»³å­æ¸¸æˆï¼Ÿ"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-19T03:30:03.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="äº¿å…ƒç¨‹åºå‘˜"/> <meta itemprop="url" content="https://juejin.cn/user/1972988307323236"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ•¢ä¸æ•¢æŒ‘æˆ˜ç”¨Cocos3.8å¤åˆ»æ›¾ç»å¾ˆç«çš„å‰²ç»³å­æ¸¸æˆï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972988307323236/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    äº¿å…ƒç¨‹åºå‘˜
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T03:30:03.000Z" title="Mon Jan 19 2026 03:30:03 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f7975ec955944b7b11222efa66e73fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=uB%2FjQa%2F9Z5e3Bp0zkwCKa79Z7%2B8%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-0">å¼•è¨€</h2>
<p><strong>å“ˆå–½å¤§å®¶å¥½</strong>ï¼Œæˆ‘æ˜¯äº¿å…ƒç¨‹åºå‘˜ï¼Œæœ€è¿‘æœ‰å°ä¼™ä¼´ç§ä¿¡ç¬”è€…ï¼š</p>
<blockquote>
<p><strong>äº¿å“¥</strong>ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰ç©è¿‡ä¸Šé¢é‚£æ¬¾<code>16</code>å¹´å‰ç«éå…¨ç½‘çš„å‰²ç»³å­æ¸¸æˆã€‚</p>
<p><strong>æˆ‘æœ€è¿‘</strong>åœ¨åšæ¸¸æˆæ—¶ï¼Œéœ€è¦åšç±»ä¼¼è¿™ä¸ªæ¸¸æˆé‡Œé¢çš„ç»³å­æ•ˆæœï¼Œä¸çŸ¥é“æ€ä¹ˆå®ç°ï¼</p>
<p><strong>ä½ æœ€è¿‘</strong>ä¸æ˜¯åœ¨æ›´æ–°çƒ­é—¨å°æ¸¸æˆå®æˆ˜åˆé›†å—ï¼</p>
<p><strong>æ•¢ä¸æ•¢æŒ‘æˆ˜ç”¨Cocos3.8å¤åˆ»ä¸€ä¸ªï¼Ÿ</strong></p>
</blockquote>
<p><strong>å¥½å®¶ä¼™</strong>ï¼Œè¿™æ¬¾æ¸¸æˆç¬”è€…æœ€ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œé‚£æ—¶å€™è‹¹æœ<code>4</code>æ‰åˆšå‡ºæ¥æ²¡å¤šä¹…ï¼Œè¿™æ ·çš„è§¦å±ç‰©ç†æ¸¸æˆå¯ä»¥ç®—å¾—ä¸Šäººæ‰‹ä¸€ä¸ªã€‚</p>
<p><strong>å…³äº</strong>å‰²ç»³å­çš„ç‰©ç†æ•ˆæœï¼Œæˆ‘è®°å¾—ä¹‹å‰å‚ä¸è®ºå›æŠ•ç¨¿æ´»åŠ¨æ—¶ï¼Œå‚è€ƒæŸä¸ªç æ ‘æ¸¸æˆå‡ºè¿‡ä¸€æœŸï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/62bfc91e91d444ca81fe6d2de794ad3a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=hgR8B9XofrLjKT9LX46EZkM6hGo%3D" alt="" loading="lazy"/></p>
<p><strong>ç¿»äº†ä¸€ä¸‹</strong>ï¼Œçœ‹åˆ°äº†ä¸€äº›æ‰å¿ƒçš„è¯„è®ºï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f8aa09af49424234b141426f457d2699~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=E7571XsqMEkM2O%2FGyFofyTzYDLo%3D" alt="ä½ è¿™æ˜¯æ£å­å§" loading="lazy"/></p>
<p><strong>è¨€å½’æ­£ä¼ </strong>ï¼Œæœ¬æœŸå¸¦å¤§å®¶ä¸€èµ·æ¥çœ‹çœ‹ï¼Œå¦‚ä½•åœ¨<code>Cocos</code>æ¸¸æˆå¼€å‘ä¸­ï¼Œå¦‚ä½•å®ç°ä¸åƒæ£å­çš„ç»³å­æ•ˆæœï¼Œå¹¶ä¸”å®æˆ˜åšä¸€ä¸ªæ›¾ç»å¾ˆç«çš„å‰²ç»³å­æ¸¸æˆã€‚</p>
<p><strong>æœ¬æ–‡æºå·¥ç¨‹å¯åœ¨æ–‡æœ«è·å–ï¼Œå°ä¼™ä¼´ä»¬è‡ªè¡Œå‰å¾€ã€‚</strong></p>
<h2 data-id="heading-1">å›é¡¾ä¸€ä¸‹</h2>
<p><strong>æƒ³è¦</strong>åœ¨<code>Cocos</code>æ¸¸æˆå¼€å‘ä¸­ï¼Œå®ç°ä¸€æ¡å¸¦æœ‰ç‰©ç†æ•ˆæœçš„ç»³å­ï¼Œå¯ä»¥ä½¿ç”¨æˆ‘ä»¬ç³»ç»Ÿè‡ªå¸¦çš„è·ç¦»å…³èŠ‚<code>Distance Joint</code>ã€‚</p>
<p><strong>è·ç¦»å…³èŠ‚</strong>ä¼šå°†å…³èŠ‚ä¸¤ç«¯çš„åˆšä½“çº¦æŸåœ¨ä¸€ä¸ªæœ€å¤§èŒƒå›´å†…ã€‚è¶…å‡ºè¯¥èŒƒå›´æ—¶ï¼Œåˆšä½“çš„è¿åŠ¨ä¼šäº’ç›¸å½±å“ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4c91d00de6b0413daf590e861d52404e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=rGpYo5WDXtePCfKXgD2gbu9%2B3%2BE%3D" alt="æ¥æºäºCocoså®˜æ–¹æ–‡æ¡£" loading="lazy"/></p>
<p><strong>æ—¢ç„¶å¦‚æ­¤</strong>ï¼Œä¸ºä»€ä¹ˆä¹‹å‰åšçš„ç»³å­åƒæ£å­ï¼Ÿ</p>
<h2 data-id="heading-2">å…³èŠ‚å¤ªå°‘</h2>
<p><strong>å› ä¸º</strong>ä¹‹å‰åšçš„<code>demo</code>ï¼Œé’©å­å’Œç‰©å“ä¹‹é—´ï¼Œä»…ä»…ä½¿ç”¨äº†ä¸€ä¸ªè·ç¦»å…³èŠ‚ï¼Œæ‰€ä»¥å¾ˆéš¾æ¨¡æ‹Ÿå‡ºæ¥ç»³å­æŸ”è½¯çš„æ•ˆæœã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4b1940355a534825be4d4caaaa025215~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=xRh49gxPZg7k3tn%2Fh4PKqodtbfg%3D" alt="" loading="lazy"/></p>
<p><strong>é‚£ä¹ˆ</strong>ä¸åƒæ£å­çš„ç»³å­æ€ä¹ˆåšï¼Ÿ</p>
<h2 data-id="heading-3">å¢åŠ è¶³å¤Ÿå¤šçš„å…³èŠ‚</h2>
<p><strong>é¦–å…ˆ</strong>åˆ¶ä½œä¸€èŠ‚<code>5*20</code>çš„ç»³å­ï¼Œå±æ€§ç»„ä»¶å¦‚ä¸‹:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d10abbf149124ebda24182a1c2369d25~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=7WzdZJn8jdVbO2oXILh%2F58X4P3g%3D" alt="" loading="lazy"/></p>
<p><strong>ç†è®ºä¸Š</strong>åªè¦æ·»åŠ è¶³å¤Ÿå¤šçš„å…³èŠ‚ï¼Œå°±ä¼šè¶Šæ¥è¶Šæ¥è¿‘æŸ”è½¯çš„ç»³å­æ•ˆæœï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç å»æ§åˆ¶ç”Ÿæˆè¶³å¤Ÿå¤šçš„å…³èŠ‚ï¼Œä¸€èŠ‚è¿ä¸€èŠ‚ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ae934897f0b49a2bf8c9714995d1376~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=y7AE1oNDpTUwbo%2Fh8tN%2Fz5I3Y9M%3D" alt="" loading="lazy"/></p>
<p><strong>æ•ˆæœ</strong>å¦‚ä¸‹ï¼Œä¸è¿‡ç»³å­çœ‹èµ·æ¥å¹¶ä¸æ˜¯è¿ç»­çš„ï¼Œå…³èŠ‚å› ä¸ºé‡åŠ›æ•ˆæœï¼Œä¼šè¢«æ‹‰å¼€ä¸€æ®µè·ç¦»ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1a8e4d5b6f40420ba1999352aac01aa4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=fch7OL3SKA8h1hm%2F3pMFiFJJRm0%3D" alt="" loading="lazy"/></p>
<p><strong>è¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³ï¼Ÿ</strong></p>
<h2 data-id="heading-4">ç”»çº¿è¾…åŠ©</h2>
<p><strong>ä¸ºäº†</strong>è§£å†³å—é‡åŠ›æ•ˆæœå¯¼è‡´çš„ç»³ç»“æ–­å¼€çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>Graphics</code>ç»„ä»¶é€ç‚¹è¿›è¡Œç”»çº¿ï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/469786f0559e42c7a10ec6908289cdcc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=odzYvSSthAixG1JuZEisGeVaC9g%3D" alt="" loading="lazy"/></p>
<p><strong>æ•ˆæœ</strong>å¦‚ä¸‹ï¼Œä½†æ˜¯çœ‹èµ·æ¥è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œç»³å­è¿æ¥å¤„ä¸å¤ªå’Œè°ï¼Œä¸åƒä¸€æ ¹ç»³å­ï¼Œåè€Œåƒå“¼å“¼å“ˆå˜¿çš„åŒæˆªæ£ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7771eab1156f4979a7c7da28c6f41398~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=h0QbL3QnhqosG0W8MDG0tRZMa20%3D" alt="" loading="lazy"/></p>
<p><strong>å› æ­¤</strong>æˆ‘ä»¬éœ€è¦æŠŠç»³å­ç”»å¾—æ›´åŠ å¹³æ»‘ä¸€ç‚¹ã€‚</p>
<h2 data-id="heading-5">å¹³æ»‘æ›²çº¿</h2>
<p><strong>æƒ³è¦</strong>è®©æ›²çº¿æ›´åŠ å¹³æ»‘ï¼Œé€šå¸¸å¯ä»¥é‡‡ç”¨äºŒæ¬¡è´å¡å°”æ›²çº¿è¿æ¥ç›¸é‚»ç‚¹ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆè¦æŠŠæ‰€æœ‰çš„ç‚¹ä½æ”¶é›†èµ·æ¥ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5564e310d865478eae3248564f7a82e7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=uEHYxrR6t08vN1X5uWVSKC9pGCM%3D" alt="" loading="lazy"/></p>
<p><strong>æ ¸å¿ƒ</strong>çš„ç»˜åˆ¶æ–¹æ³•<code>quadraticCurveTo</code>ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3281a3c860d840dc98ee20bfbfc8ea84~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=25ZGgSna4p4Fb%2FMkDgKEhiqmJQI%3D" alt="" loading="lazy"/></p>
<p><strong>è¿™æ ·</strong>çœ‹èµ·æ¥å°±åˆç†ä¸€ç‚¹äº†ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/acedaf326af44f7f876ee3e6fa9a98f6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=a7AEY7rCBkvgJRX3eUV%2F%2BRXsrns%3D" alt="" loading="lazy"/></p>
<p><strong>é€šè¿‡</strong>ä¸Šè¿°æµç¨‹ï¼Œæˆ‘ä»¬å°±èƒ½æˆåŠŸå®ç°ä¸€æ ¹ä¸åƒæ£å­çš„ç»³å­äº†ã€‚</p>
<p><strong>æ¥ä¸‹æ¥æˆ‘ä»¬å®Œæˆå‰²ç»³å­æ¸¸æˆçš„å‰©ä½™éƒ¨åˆ†ã€‚</strong></p>
<h2 data-id="heading-6">å‰²ç»³å­æ¸¸æˆå®æˆ˜</h2>
<p><strong>æœ‰äº†</strong>ä¸Šé¢çš„ç»³å­åŸºç¡€ï¼Œæˆ‘ä»¬æƒ³è¦å®ç°ä¸€ä¸ªå®Œæ•´çš„å‰²ç»³å­æ¸¸æˆå°±æ˜“å¦‚åæŒäº†ã€‚</p>
<p><strong>1. å‰²ç»³å­</strong></p>
<p><strong>æ—¢ç„¶</strong>æ˜¯å‰²ç»³å­æ¸¸æˆï¼Œå‰²å½“ç„¶æ˜¯ä¹Ÿæ˜¯é‡è¦çš„ä¸€ç¯ï¼Œå‰²ç»³å­æœ€ä¸»è¦åˆ¤æ–­æ‰‹æŒ‡ç§»åŠ¨çš„è½¨è¿¹ä¸å®é™…ä¸Šå“ªä¸€æ®µå…³èŠ‚ç›¸äº¤ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/03baedd840194377ae5e958eb3bb6cc8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=gMS41LaGR%2BIKXRfxYCENFbOsY%2FQ%3D" alt="" loading="lazy"/></p>
<p><strong>åˆ¤æ–­</strong>ç›¸äº¤çš„æ ¸å¿ƒæ–¹æ³•å¦‚ä¸‹:</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/55aee08f91ac47ddb5361e44a9c631f0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=y4Qtqvw9Apo56CFcIJG9ER5gv1o%3D" alt="" loading="lazy"/></p>
<p><strong>2. åˆ‡å‰²æ•ˆæœ</strong></p>
<p><strong>ä¸ºäº†</strong>å¢åŠ æ¸¸æˆæ•ˆæœï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å±å¹•ä¸Šç”»çº¿æ—¶ï¼Œå¢åŠ ä¸€æ®µæ‹–å°¾æ•ˆæœã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4977a9cb463e4c4c93907c6c9ef12836~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=mBPB4qoMEYAOvmTmJAhG9B08IzE%3D" alt="" loading="lazy"/></p>
<p><strong>æ•ˆæœå¦‚ä¸‹:</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/026b832865c4408a93ea62ea6300dcaa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=XWYBYpI6GF8BVcVUMRUKPIxIfsE%3D" alt="" loading="lazy"/></p>
<p><strong>3. å…¶ä»–æ¸¸æˆå…ƒç´ </strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2ce746683e874cc584fd686e1eab0dee~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=zGqle4NhhSkVsPRKbWsRlR9YRBQ%3D" alt="" loading="lazy"/></p>
<p><strong>é™¤å»</strong>ç»³å­ç›¸å…³çš„éƒ¨åˆ†ï¼Œå‰©ä¸‹å°±æ˜¯å‰²ç»³å­æ¸¸æˆçš„å…¶ä»–å…ƒç´ ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>
<p><strong>é’©å­</strong>: ä¸»è¦èµ·åˆ°å›ºå®šç»³å­çš„ä½œç”¨ï¼Œéœ€è¦æ·»åŠ åˆšä½“ç»„ä»¶ï¼Œ<code>Type</code>è®¾ç½®ä¸º<code>Static</code>ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7afea069b52b47a39c6e5c0bfc226116~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=GqfY9EQFLRGwy2jp8%2Fz%2B6ErZmcc%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>ç”œç”œåœˆ</strong>: éœ€è¦æ·»åŠ ç¢°æ’ç»„ä»¶ã€ç®¡ç†è„šæœ¬ä»¥åŠåˆšä½“ç»„ä»¶ï¼Œéœ€è¦å¼€å¯<code>Enabled Contact Listener</code>ï¼Œåœ¨å¯¹åº”çš„ç®¡ç†è„šæœ¬è¿›è¡Œå¤„ç†ç¢°æ’äº‹ä»¶ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/719e9c6a42f448d5a24045c1782e6118~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=diPPdpUwiSgZNBLdkkd%2F%2B5fD8uc%3D" alt="" loading="lazy"/>
å¦‚ä¸‹ç¢°æ’åˆ°æ˜Ÿæ˜Ÿå’Œç›®æ ‡ç‚¹æ—¶è¿›è¡Œå¤„ç†ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/815486f0bd5c4872947216ebd5b55e56~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=8S6Y1nUDXZf%2F0Jm6uk%2FPK3DzbDE%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>æ˜Ÿæ˜Ÿ</strong>: æ·»åŠ ç¢°æ’ç»„ä»¶å’Œç®¡ç†è„šæœ¬ï¼Œå¢åŠ ä¸€äº›ç®€å•çš„åŠ¨ç”»ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da2e6a58dee9400b901544dcc8785f2a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=q%2FWOOp%2F5D1RiQfwCBuneiTEUeKA%3D" alt="" loading="lazy"/>
æ—‹è½¬å’Œç¢°æ’æ”¾å¤§æ•ˆæœã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/19b5efd668ea428db4c0685767482fc6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=mZN6w5zQzKTSKN3X4x%2FSVL4wBc4%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>ç›®æ ‡ç‚¹</strong>: ç›®æ ‡ç‚¹å’Œä¸Šé¢å·®ä¸å¤šï¼Œä¸»è¦æ˜¯ç”¨æ¥åˆ¤æ–­æ˜¯å¦åˆ°è¾¾ç›®æ ‡ç‚¹ï¼Œä»¥åŠæ·»åŠ ä¸€äº›åˆ°è¾¾åŠ¨ç”»ã€‚
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/86cc9e32b8db47809acf8875f8128303~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=bHbw%2BE24kay9cOZ4RqoBn%2BZcBdE%3D" alt="" loading="lazy"/></p>
</li>
<li>
<p><strong>å…¶ä»–</strong>: éšç€æ¸¸æˆå…³å¡åœ°ä¸æ–­å¢åŠ ï¼Œä¼šæœ‰è¶Šæ¥è¶Šå¤šçš„å…¶ä»–æ¸¸æˆå…ƒç´ ï¼Œç¬”è€…åªå®ç°äº†ä»¥ä¸ŠåŸºç¡€çš„éƒ¨åˆ†ï¼Œæ„Ÿå…´è¶£çš„å°ä¼™ä¼´ä»¬å¯ä»¥è‡ªè¡Œæ‰©å±•ã€‚</p>
</li>
</ul>
<p><strong>4. æ•ˆæœæ¼”ç¤º</strong></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a1aa4e21f62348bab55a9836e52e5f42~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5Lq_5YWD56iL5bqP5ZGY:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769398203&amp;x-signature=eXojTn8R3J26cI3bntvMTDRDhjE%3D" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"/></p>
<h2 data-id="heading-7">ç»“è¯­</h2>
<p><strong>å‰²ç»³å­æ¸¸æˆ</strong>çœŸçš„æ˜¯å›å¿†æ€ï¼Œå‹¾èµ·ç¬”è€…çš„æ— é™å›å¿†ï¼Œç­‰æˆ‘é€€ä¼‘äº†ï¼Œä¸€å®šè¦å®Œå®Œæ•´æ•´å¤åˆ»ä¸€ä¸ªï¼Œä¸€è¾¹å¤åˆ»ä¸€è¾¹ç©ã€‚</p>
<p><strong>å°ä¼™ä¼´ä»¬</strong>ï¼Œä½ ä»¬ç©è¿‡è¿™æ¬¾æ¸¸æˆå—ï¼Ÿé‚£æ—¶å€™çš„ä½ ä»¬è¿›å…¥æ¸¸æˆè¡Œä¸šäº†å—ï¼Ÿ</p>
<p>æœ¬æ–‡<strong>å®æˆ˜å®Œæ•´æºç </strong>å·²é›†æˆåˆ°<a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">äº¿å…ƒCocoså°æ¸¸æˆå®æˆ˜åˆé›†</a>ï¼Œå†…å«ä½“éªŒé“¾æ¥ã€‚</p>
<hr/>
<p><strong>æˆ‘æ˜¯"äº¿å…ƒç¨‹åºå‘˜"ï¼Œä¸€ä½æœ‰ç€8å¹´æ¸¸æˆè¡Œä¸šç»éªŒçš„ä¸»ç¨‹ã€‚åœ¨æ¸¸æˆå¼€å‘ä¸­ï¼Œå¸Œæœ›èƒ½ç»™åˆ°æ‚¨å¸®åŠ©, ä¹Ÿå¸Œæœ›é€šè¿‡æ‚¨èƒ½å¸®åŠ©åˆ°å¤§å®¶ã€‚</strong></p>
<p>AD:ç¬”è€…çº¿ä¸Šçš„å°æ¸¸æˆã€Šæ‰“èºä¸é—¯å…³ã€‹ã€Šè´ªåƒè›‡æŒæœºç»å…¸ã€‹ã€Šé‡åŠ›è¿·å®«çƒã€‹ã€Šå¡«è‰²ä¹‹æ—…ã€‹ã€Šæ–¹å—æŒæœºç»å…¸ã€‹å¤§å®¶å¯ä»¥è‡ªè¡Œç‚¹å‡»æœç´¢ä½“éªŒã€‚</p>
<p>å®ä¸ç›¸ç’ï¼Œæƒ³è¦ä¸ª<strong>èµ</strong>å’Œ<strong>çˆ±å¿ƒ</strong>ï¼è¯·æŠŠè¯¥æ–‡ç« <strong>åˆ†äº«</strong>ç»™ä½ è§‰å¾—æœ‰éœ€è¦çš„å…¶ä»–å°ä¼™ä¼´ã€‚è°¢è°¢ï¼</p>
<p>æ¨èæ–‡ç« ï¼š</p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FFOi5gCiGzF3LnT03DpPMXA" target="_blank" title="https://mp.weixin.qq.com/s/FOi5gCiGzF3LnT03DpPMXA" ref="nofollow noopener noreferrer">äº¿å…ƒCocoså°æ¸¸æˆå®æˆ˜åˆé›†</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FXLCknL3fJDubec2GW6KLFA" target="_blank" title="https://mp.weixin.qq.com/s/XLCknL3fJDubec2GW6KLFA" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¦‚ä½•æ¥å…¥å®‰å“ç©¿å±±ç”²å¹¿å‘Šå˜ç°ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3_VrSld4KnDKY_7hxjSoKg" target="_blank" title="https://mp.weixin.qq.com/s/3_VrSld4KnDKY_7hxjSoKg" ref="nofollow noopener noreferrer">ä½ çŸ¥é“å’Œä¸çŸ¥é“çš„å¾®ä¿¡å°æ¸¸æˆå¸¸ç”¨APIæ•´ç†ï¼Œèµ¶ç´§æ”¶è—ç”¨èµ·æ¥~</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F0Lj24VHJ-pL8z82hHqQLiA" target="_blank" title="https://mp.weixin.qq.com/s/0Lj24VHJ-pL8z82hHqQLiA" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¦‚ä½•å¿«é€Ÿæ¥å…¥æŠ–éŸ³å°æ¸¸æˆå¹¿å‘Šå˜ç°ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZ7DusUJA2v1IFZDFtBsueg" target="_blank" title="https://mp.weixin.qq.com/s/Z7DusUJA2v1IFZDFtBsueg" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨CocosCreator3.8ä¸­å®ç°å‰²ç»³å­æ¸¸æˆæ•ˆæœ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F3BzzFBzeVAO-a6LPTeFTrA" target="_blank" title="https://mp.weixin.qq.com/s/3BzzFBzeVAO-a6LPTeFTrA" ref="nofollow noopener noreferrer">å¦‚ä½•åœ¨CocosCreator3.8ä¸­å®ç°åŠ¨æ€åˆ‡å‰²æ¨¡å‹ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FZIph332u_r24OTY4r6_jow" target="_blank" title="https://mp.weixin.qq.com/s/ZIph332u_r24OTY4r6_jow" ref="nofollow noopener noreferrer">Cocosæ¸¸æˆå¼€å‘ä¸­çš„è´´èŠ±æ•ˆæœ</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[flutter-å®ç°ç€‘å¸ƒæµå¸ƒå±€åŠä¸‹æ‹‰åˆ·æ–°ä¸Šæ‹‰åŠ è½½æ›´å¤š]]></title>    <link>https://juejin.cn/post/7596478936386764842</link>    <guid>https://juejin.cn/post/7596478936386764842</guid>    <pubDate>2026-01-19T00:47:51.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7596478936386764842" data-draft-id="7596166721627783214" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="flutter-å®ç°ç€‘å¸ƒæµå¸ƒå±€åŠä¸‹æ‹‰åˆ·æ–°ä¸Šæ‹‰åŠ è½½æ›´å¤š"/> <meta itemprop="keywords" content="å‰ç«¯,Flutter,Android"/> <meta itemprop="datePublished" content="2026-01-19T00:47:51.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹å¤šå¤š"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            flutter-å®ç°ç€‘å¸ƒæµå¸ƒå±€åŠä¸‹æ‹‰åˆ·æ–°ä¸Šæ‹‰åŠ è½½æ›´å¤š
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹å¤šå¤š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-19T00:47:51.000Z" title="Mon Jan 19 2026 00:47:51 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-19
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><p>åœ¨ Flutter åº”ç”¨å¼€å‘ä¸­ï¼Œç€‘å¸ƒæµå¸ƒå±€å¸¸ç”¨äºå±•ç¤ºå›¾ç‰‡ã€å•†å“åˆ—è¡¨ç­‰éœ€è¦ä»¥ä¸è§„åˆ™ä½†æ•´é½æ’åˆ—çš„å†…å®¹ã€‚åŒæ—¶ï¼Œä¸‹æ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½æ›´å¤šåŠŸèƒ½ï¼Œèƒ½å¤Ÿæå¤§æå‡ç”¨æˆ·ä½“éªŒï¼Œè®©ç”¨æˆ·æ–¹ä¾¿åœ°è·å–æœ€æ–°å’Œæ›´å¤šçš„æ•°æ®ã€‚</p>
<h2 data-id="heading-0">1. å‰ç½®æ¡ä»¶</h2>
<ol>
<li>
<p>Flutter ç¯å¢ƒå·²æ­å»ºï¼ˆè¦æ±‚ Flutter 3.0+ã€Dart 2.17+ï¼‰</p>
</li>
<li>
<p>æœ¬åœ°å›¾ç‰‡èµ„æºå·²æ”¾å…¥ <code>assets/images</code> ç›®å½•ï¼Œå¹¶åœ¨ <code>pubspec.yaml</code> ä¸­é…ç½®</p>
</li>
<li>
<p>å·²å®‰è£…ä¾èµ–æ’ä»¶å¹¶æ‰§è¡Œ <code>flutter pub get</code></p>
</li>
</ol>
<h2 data-id="heading-1">2. ç»“æ„åˆ†æ</h2>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b3fb3fa88858454c847241e8398618d7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bmP5aSa5aSa:q75.awebp?rk3s=f64ab15b&amp;x-expires=1769388471&amp;x-signature=1b%2BajzGhngXmLLWlGGPXnQnboT8%3D" alt="6210b7bafa9244369d7ce1aa5ca874be.gif" loading="lazy"/></p>
<h3 data-id="heading-2">2.1 å®‰è£…ä¾èµ–æ’ä»¶</h3>
<p>åœ¨é¡¹ç›®çš„ <code>pubspec.yaml</code> æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š</p>
<pre><code class="hljs language-YAML" lang="YAML">
<span class="hljs-comment"># ç€‘å¸ƒæµå¸ƒå±€ï¼šhttps://pub.dev/packages/waterfall_flow</span>
<span class="hljs-attr">waterfall_flow:</span> <span class="hljs-string">^3.0.3</span>
<span class="hljs-comment"># ä¸Šæ‹‰åŠ è½½æ›´å¤š+ä¸‹æ‹‰åˆ·æ–°ï¼šhttps://pub.dev/packages/pull_to_refresh</span>
<span class="hljs-attr">pull_to_refresh:</span> <span class="hljs-string">^2.0.0</span>
</code></pre>
<p>æ³¨æ„ï¼š<code>waterfall_flow: ^3.0.3</code> éœ€é€‚é… Flutter 3.0+ï¼Œ<code>pull_to_refresh: ^2.0.0</code> éœ€ Dart 2.17+</p>
<p>æ·»åŠ ä¾èµ–åæ‰§è¡Œå‘½ä»¤å®‰è£…ï¼š</p>
<pre><code class="hljs language-Bash" lang="Bash">
flutter pub get
</code></pre>
<h3 data-id="heading-3">2.2 é…ç½®æœ¬åœ°å›¾ç‰‡èµ„æº</h3>
<p>åœ¨ <code>pubspec.yaml</code> ä¸­é…ç½®å›¾ç‰‡èµ„æºè·¯å¾„ï¼Œç¡®ä¿ Flutter èƒ½è¯†åˆ«æœ¬åœ°å›¾ç‰‡ï¼š</p>
<pre><code class="hljs language-YAML" lang="YAML">
<span class="hljs-attr">flutter:</span>
  <span class="hljs-attr">uses-material-design:</span> <span class="hljs-literal">true</span>
  <span class="hljs-comment"># é…ç½®å›¾ç‰‡èµ„æºç›®å½•</span>
  <span class="hljs-attr">assets:</span>
    <span class="hljs-bullet">-</span> <span class="hljs-string">assets/images/</span>
</code></pre>
<h3 data-id="heading-4">2.3 å¼•å…¥å¿…è¦çš„åº“</h3>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-keyword">import</span> <span class="hljs-string">'dart:async'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:pull_to_refresh/pull_to_refresh.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:waterfall_flow/waterfall_flow.dart'</span>;
</code></pre>
<ul>
<li>
<p><code>dart:async</code>ï¼šæä¾›å¼‚æ­¥æ“ä½œèƒ½åŠ›ï¼Œç”¨äºå¤„ç†åˆ·æ–°å’ŒåŠ è½½æ›´å¤šçš„å»¶è¿Ÿæ¨¡æ‹Ÿã€‚</p>
</li>
<li>
<p><code>package:flutter/material.dart</code>ï¼šFlutter æ ¸å¿ƒ UI åº“ï¼Œæä¾› Scaffoldã€Container ç­‰åŸºç¡€ç»„ä»¶ã€‚</p>
</li>
<li>
<p><code>package:pull_to_refresh/pull_to_refresh.dart</code>ï¼šå®ç°ä¸‹æ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½æ›´å¤šçš„æ ¸å¿ƒåº“ã€‚</p>
</li>
<li>
<p><code>package:waterfall_flow/waterfall_flow.dart</code>ï¼šç”¨äºå¿«é€Ÿæ„å»ºç€‘å¸ƒæµå¸ƒå±€çš„ç¬¬ä¸‰æ–¹åº“ã€‚</p>
</li>
</ul>
<h3 data-id="heading-5">2.4 å®šä¹‰å›¾ç‰‡æšä¸¾åŠæ‰©å±•</h3>
<p>ä¸ºäº†è§„èŒƒå›¾ç‰‡èµ„æºç®¡ç†ï¼Œæˆ‘ä»¬å®šä¹‰å›¾ç‰‡æšä¸¾ï¼Œå¹¶é€šè¿‡æ‰©å±•æ–¹æ³•è·å–å›¾ç‰‡è·¯å¾„ï¼š</p>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-comment">/// <span class="markdown">æœ¬åœ°å›¾ç‰‡æšä¸¾</span></span>
<span class="hljs-keyword">enum</span> ImageEnum {
  banner1,
  banner2,
  banner3,
  model1,
  model2,
  model3,
  model4,
}

<span class="hljs-comment">/// <span class="markdown">ä¸ºæšä¸¾æ‰©å±•è·å–å›¾ç‰‡è·¯å¾„çš„æ–¹æ³•</span></span>
<span class="hljs-keyword">extension</span> ImageEnumExtension <span class="hljs-keyword">on</span> ImageEnum {
  <span class="hljs-built_in">String</span> <span class="hljs-keyword">get</span> path {
    <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">this</span>) {
      <span class="hljs-keyword">case</span> ImageEnum.banner1:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/banner1.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.banner2:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/banner2.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.banner3:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/banner3.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.model1:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/model1.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.model2:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/model2.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.model3:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/model3.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.model4:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/model4.png'</span>;
    }
  }
}
</code></pre>
<h3 data-id="heading-6">2.5 å®šä¹‰ ImageWaterfallFlow ç»„ä»¶</h3>
<p>å®šä¹‰æœ‰çŠ¶æ€ç»„ä»¶ï¼Œç”¨äºç®¡ç†ç€‘å¸ƒæµå¸ƒå±€çš„çŠ¶æ€å’Œ UI æ¸²æŸ“ï¼š</p>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageWaterfallFlow</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> ImageWaterfallFlow({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  State&lt;ImageWaterfallFlow&gt; createState() =&gt; ImageWaterfallFlowState();
}
</code></pre>
<p>æœ‰çŠ¶æ€ç»„ä»¶å¯ä»¥æ ¹æ®ç”¨æˆ·æ“ä½œæˆ–æ•°æ®å˜åŒ–åŠ¨æ€æ›´æ–° UIï¼Œ<code>createState</code> æ–¹æ³•è¿”å›çŠ¶æ€ç®¡ç†ç±» <code>ImageWaterfallFlowState</code>ã€‚</p>
<h3 data-id="heading-7">2.6 ImageWaterfallFlowState ç±»çš„è¯¦ç»†è§£æ</h3>
<p>è¯¥ç±»æ˜¯ç»„ä»¶çš„æ ¸å¿ƒï¼Œè´Ÿè´£ç®¡ç†æ•°æ®ã€æ§åˆ¶å™¨å’Œä¸šåŠ¡é€»è¾‘ï¼š</p>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageWaterfallFlowState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">ImageWaterfallFlow</span>&gt; </span>{
  <span class="hljs-comment">/// <span class="markdown">å­—ä½“æ ·å¼</span></span>
  <span class="hljs-keyword">final</span> TextStyle myTxtStyle = <span class="hljs-keyword">const</span> TextStyle(
      color: Colors.white, fontSize: <span class="hljs-number">24</span>, fontWeight: FontWeight.w800);

  <span class="hljs-comment">/// <span class="markdown">æ¨¡æ‹Ÿæ•°æ®ï¼ˆåˆå§‹æ•°æ®ï¼‰- å¢åŠ æ³›å‹æå‡ç±»å‹å®‰å…¨</span></span>
  <span class="hljs-built_in">List</span>&lt;ImageEnum&gt; imageList = [
    ImageEnum.banner1,
    ImageEnum.banner2,
    ImageEnum.banner3,
    ImageEnum.model1,
    ImageEnum.model2,
    ImageEnum.model3,
    ImageEnum.model4,
    ImageEnum.banner1,
    ImageEnum.banner2,
    ImageEnum.banner3,
    ImageEnum.model1,
    ImageEnum.model2,
    ImageEnum.model3,
    ImageEnum.model4
  ];

  <span class="hljs-comment">/// <span class="markdown">æ¨¡æ‹Ÿæ•°æ®ï¼ˆåŠ è½½æ›´å¤šä½¿ç”¨ï¼‰</span></span>
  <span class="hljs-built_in">List</span>&lt;ImageEnum&gt; moreList = [ImageEnum.banner1, ImageEnum.banner2, ImageEnum.banner3];

  <span class="hljs-comment">/// <span class="markdown">ä¸Šæ‹‰ä¸‹æ‹‰æ§åˆ¶å™¨</span></span>
  <span class="hljs-keyword">final</span> RefreshController myRefreshController = RefreshController();
</code></pre>
<ul>
<li>
<p><code>myTxtStyle</code>ï¼šå®šä¹‰å›¾ç‰‡ä¸Šæ˜¾ç¤ºåºå·çš„å­—ä½“æ ·å¼ã€‚</p>
</li>
<li>
<p><code>imageList</code>ï¼šå­˜å‚¨ç€‘å¸ƒæµåˆå§‹å±•ç¤ºçš„å›¾ç‰‡æ•°æ®ï¼Œä½¿ç”¨æ³›å‹ <code>List&lt;ImageEnum&gt;</code> ä¿è¯ç±»å‹å®‰å…¨ã€‚</p>
</li>
<li>
<p><code>moreList</code>ï¼šå­˜å‚¨åŠ è½½æ›´å¤šæ—¶éœ€è¦è¿½åŠ çš„æ•°æ®ã€‚</p>
</li>
<li>
<p><code>myRefreshController</code>ï¼šæ¥è‡ª <code>pull_to_refresh</code> åº“ï¼Œç”¨äºæ§åˆ¶åˆ·æ–°å’ŒåŠ è½½çš„çŠ¶æ€ã€‚</p>
</li>
</ul>
<h3 data-id="heading-8">2.7 åˆ·æ–°å’ŒåŠ è½½æ›´å¤šçš„æ–¹æ³•</h3>
<p>å®ç°ä¸‹æ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½æ›´å¤šçš„ä¸šåŠ¡é€»è¾‘ï¼Œè¡¥å……è¾¹ç•Œæ¡ä»¶å¤„ç†ï¼š</p>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-comment">/// <span class="markdown">åˆ·æ–°</span></span>
<span class="hljs-keyword">void</span> onRefresh() <span class="hljs-keyword">async</span> {
  <span class="hljs-keyword">await</span> Future.delayed(<span class="hljs-keyword">const</span> <span class="hljs-built_in">Duration</span>(milliseconds: <span class="hljs-number">1000</span>));
  <span class="hljs-comment">// æ¨¡æ‹Ÿåˆ·æ–°ï¼šæ¢å¤åˆå§‹æ•°æ®</span>
  setState(() {
    imageList = [
      ImageEnum.banner1,
      ImageEnum.banner2,
      ImageEnum.banner3,
      ImageEnum.model1,
      ImageEnum.model2,
      ImageEnum.model3,
      ImageEnum.model4,
      ImageEnum.banner1,
      ImageEnum.banner2,
      ImageEnum.banner3,
      ImageEnum.model1,
      ImageEnum.model2,
      ImageEnum.model3,
      ImageEnum.model4
    ];
  });
  myRefreshController.refreshCompleted();
  myRefreshController.resetNoData(); <span class="hljs-comment">// é‡ç½®æ— æ›´å¤šæ•°æ®çŠ¶æ€</span>
}

<span class="hljs-comment">/// <span class="markdown">åŠ è½½æ›´å¤š</span></span>
<span class="hljs-keyword">void</span> onLoadMore() <span class="hljs-keyword">async</span> {
  <span class="hljs-keyword">await</span> Future.delayed(<span class="hljs-keyword">const</span> <span class="hljs-built_in">Duration</span>(milliseconds: <span class="hljs-number">1000</span>));
  <span class="hljs-comment">// æ¨¡æ‹Ÿï¼šæ•°æ®è¶…è¿‡30æ¡æ—¶æ ‡è®°æ— æ›´å¤šæ•°æ®</span>
  <span class="hljs-keyword">if</span> (imageList.length &gt;= <span class="hljs-number">30</span>) {
    myRefreshController.loadNoData();
  } <span class="hljs-keyword">else</span> {
    imageList.addAll(moreList);
    <span class="hljs-keyword">if</span> (mounted) {
      setState(() {});
    }
    myRefreshController.loadComplete();
  }
}
</code></pre>
<ul>
<li>
<p><code>onRefresh</code>ï¼šä¸‹æ‹‰åˆ·æ–°æ—¶è§¦å‘ï¼Œæ¨¡æ‹Ÿ 1 ç§’å»¶è¿Ÿåæ¢å¤åˆå§‹æ•°æ®ï¼Œå¹¶é‡ç½®åŠ è½½çŠ¶æ€ã€‚</p>
</li>
<li>
<p><code>onLoadMore</code>ï¼šä¸Šæ‹‰åŠ è½½æ—¶è§¦å‘ï¼Œæ¨¡æ‹Ÿ 1 ç§’å»¶è¿Ÿåè¿½åŠ æ•°æ®ï¼›å½“æ•°æ®é‡è¶…è¿‡ 30 æ¡æ—¶ï¼Œæ ‡è®°ä¸ºâ€œæ— æ›´å¤šæ•°æ®â€ã€‚</p>
</li>
<li>
<p><code>mounted</code> åˆ¤æ–­ï¼šé˜²æ­¢ç»„ä»¶é”€æ¯åè°ƒç”¨ <code>setState</code> å¯¼è‡´å¼‚å¸¸ã€‚</p>
</li>
</ul>
<h3 data-id="heading-9">2.8 èµ„æºé‡Šæ”¾</h3>
<p>é‡å†™ <code>dispose</code> æ–¹æ³•ï¼Œé‡Šæ”¾æ§åˆ¶å™¨èµ„æºï¼Œé¿å…å†…å­˜æ³„æ¼ï¼š</p>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-meta">@override</span>
<span class="hljs-keyword">void</span> dispose() {
  myRefreshController.dispose(); <span class="hljs-comment">// é‡Šæ”¾åˆ·æ–°æ§åˆ¶å™¨</span>
  <span class="hljs-keyword">super</span>.dispose();
}
</code></pre>
<h3 data-id="heading-10">2.9 æ„å»º UI çš„æ–¹æ³•</h3>
<p>æ„å»ºç»„ä»¶çš„åŸºç¡€å¸ƒå±€ç»“æ„ï¼š</p>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-comment">/// <span class="markdown">å¸ƒå±€</span></span>
<span class="hljs-meta">@override</span>
Widget build(BuildContext context) {
  <span class="hljs-keyword">return</span> Scaffold(
      backgroundColor: Colors.black,
      body: SafeArea(
          child: SizedBox(
              width: MediaQuery.of(context).size.width,
              height: MediaQuery.of(context).size.height,
              child: listWidget())));
}
</code></pre>
<ul>
<li>
<p><code>Scaffold</code>ï¼šä½œä¸ºé¡µé¢çš„æ ¹å¸ƒå±€ï¼Œè®¾ç½®èƒŒæ™¯è‰²ä¸ºé»‘è‰²ã€‚</p>
</li>
<li>
<p><code>SafeArea</code>ï¼šé¿å…å†…å®¹è¢«åˆ˜æµ·å±ã€çŠ¶æ€æ ç­‰é®æŒ¡ã€‚</p>
</li>
<li>
<p><code>SizedBox</code>ï¼šè®¾ç½®ä¸å±å¹•åŒå®½åŒé«˜çš„å®¹å™¨ï¼Œæ‰¿è½½ç€‘å¸ƒæµåˆ—è¡¨ã€‚</p>
</li>
</ul>
<h3 data-id="heading-11">2.10 æ„å»ºç€‘å¸ƒæµåˆ—è¡¨çš„æ–¹æ³•</h3>
<p>æ•´åˆåˆ·æ–°ç»„ä»¶å’Œç€‘å¸ƒæµå¸ƒå±€ï¼Œå®ç°æ ¸å¿ƒ UI æ•ˆæœï¼š</p>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-comment">/// <span class="markdown">åˆ—è¡¨</span></span>
Widget listWidget() {
  <span class="hljs-keyword">return</span> SmartRefresher(
    enablePullDown: <span class="hljs-keyword">true</span>,
    enablePullUp: <span class="hljs-keyword">true</span>,
    header: <span class="hljs-keyword">const</span> ClassicHeader(),
    footer: <span class="hljs-keyword">const</span> ClassicFooter(),
    controller: myRefreshController,
    onRefresh: onRefresh,
    onLoading: onLoadMore,
    child: WaterfallFlow.builder(
      padding: <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">10</span>), <span class="hljs-comment">// å¢åŠ å†…è¾¹è·ï¼Œé¿å…å†…å®¹è´´è¾¹</span>
      physics: <span class="hljs-keyword">const</span> BouncingScrollPhysics(),
      gridDelegate: SliverWaterfallFlowDelegateWithFixedCrossAxisCount(
        crossAxisCount: <span class="hljs-number">2</span>,
        crossAxisSpacing: <span class="hljs-number">20</span>,
        mainAxisSpacing: <span class="hljs-number">20</span>,
        viewportBuilder: (<span class="hljs-built_in">int</span> index1, <span class="hljs-built_in">int</span> index2) {
          <span class="hljs-built_in">print</span>(<span class="hljs-string">'å˜åŒ–ï¼š<span class="hljs-subst">$index1</span>-<span class="hljs-subst">$index2</span>'</span>);
        },
        <span class="hljs-comment">// ä¿®æ­£æœ€åä¸€ä¸ªå­é¡¹çš„åˆ¤æ–­é€»è¾‘ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰</span>
        lastChildLayoutTypeBuilder: (index) =&gt; index == imageList.length - <span class="hljs-number">1</span>
            ? LastChildLayoutType.fullCrossAxisExtent
            : LastChildLayoutType.none,
      ),
      itemCount: imageList.length,
      itemBuilder: (BuildContext context, <span class="hljs-built_in">int</span> index) {
        <span class="hljs-keyword">return</span> Container(
          color: Colors.white,
          height: (index + <span class="hljs-number">1</span>) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> ? <span class="hljs-number">100</span> : <span class="hljs-number">200</span>,
          child: Container(
              alignment: Alignment.center,
              decoration: BoxDecoration(
                  color: Colors.blue.shade300,
                  image: DecorationImage(
                    image: AssetImage(imageList[index].path), <span class="hljs-comment">// è°ƒç”¨æ‰©å±•æ–¹æ³•è·å–å›¾ç‰‡è·¯å¾„</span>
                    fit: BoxFit.cover,
                  )),
              child: Text(<span class="hljs-string">'ç¬¬<span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>å¼ '</span>, style: myTxtStyle)),
        );
      },
    ),
  );
}
</code></pre>
<ul>
<li>
<p><code>SmartRefresher</code>ï¼š<code>pull_to_refresh</code> åº“çš„æ ¸å¿ƒç»„ä»¶ï¼Œé…ç½®ä¸Šä¸‹æ‹‰å¼€å…³ã€å¤´éƒ¨åº•éƒ¨æ ·å¼å’Œå›è°ƒæ–¹æ³•ã€‚</p>
</li>
<li>
<p><code>WaterfallFlow.builder</code>ï¼šç€‘å¸ƒæµå¸ƒå±€çš„æ„å»ºå™¨ï¼Œé€šè¿‡æ‡’åŠ è½½æ–¹å¼æ¸²æŸ“å­é¡¹ï¼š</p>
<ul>
<li>
<p><code>padding</code>ï¼šå¢åŠ å†…è¾¹è·ï¼Œä¼˜åŒ–è§†è§‰æ•ˆæœã€‚</p>
</li>
<li>
<p><code>crossAxisCount: 2</code>ï¼šè®¾ç½®ç€‘å¸ƒæµä¸º 2 åˆ—å¸ƒå±€ã€‚</p>
</li>
<li>
<p><code>crossAxisSpacing</code>/<code>mainAxisSpacing</code>ï¼šè®¾ç½®å­é¡¹ä¹‹é—´çš„æ°´å¹³å’Œå‚ç›´é—´è·ã€‚</p>
</li>
<li>
<p><code>lastChildLayoutTypeBuilder</code>ï¼šä¿®æ­£ç´¢å¼•åˆ¤æ–­é€»è¾‘ï¼Œè®©æœ€åä¸€ä¸ªå­é¡¹å æ»¡æ•´è¡Œå®½åº¦ã€‚</p>
</li>
<li>
<p><code>itemBuilder</code>ï¼šæ„å»ºæ¯ä¸ªç€‘å¸ƒæµå­é¡¹ï¼Œé€šè¿‡ <code>AssetImage(imageList[index].path)</code> è·å–å›¾ç‰‡è·¯å¾„ï¼Œè®¾ç½®ä¸åŒé«˜åº¦å®ç°ç€‘å¸ƒæµæ•ˆæœã€‚</p>
</li>
</ul>
</li>
</ul>
<h2 data-id="heading-12">3. æ ¸å¿ƒåº“ API &amp; å±æ€§è¯´æ˜</h2>
<h3 data-id="heading-13">3.1 waterfall_flow æ ¸å¿ƒ API/å±æ€§</h3>
<h4 data-id="heading-14">3.1.1 WaterfallFlow æ ¸å¿ƒç»„ä»¶</h4>





















































<table><thead><tr><th>å±æ€§å</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>padding</code></td><td><code>EdgeInsetsGeometry</code></td><td>ç€‘å¸ƒæµæ•´ä½“å†…è¾¹è·</td><td><code>EdgeInsets.zero</code></td></tr><tr><td><code>physics</code></td><td><code>ScrollPhysics</code></td><td>æ»šåŠ¨ç‰©ç†æ•ˆæœ</td><td><code>AlwaysScrollableScrollPhysics()</code></td></tr><tr><td><code>shrinkWrap</code></td><td><code>bool</code></td><td>æ˜¯å¦æ ¹æ®å­é¡¹é«˜åº¦è‡ªé€‚åº”</td><td><code>false</code></td></tr><tr><td><code>gridDelegate</code></td><td><code>SliverWaterfallFlowDelegate</code></td><td>ç€‘å¸ƒæµå¸ƒå±€ä»£ç†ï¼ˆæ ¸å¿ƒï¼‰</td><td>æ— ï¼ˆå¿…ä¼ ï¼‰</td></tr><tr><td><code>children</code></td><td><code>List&lt;Widget&gt;</code></td><td>å­ç»„ä»¶åˆ—è¡¨ï¼ˆéæ‡’åŠ è½½ï¼‰</td><td><code>[]</code></td></tr><tr><td><code>itemCount</code></td><td><code>int</code></td><td>å­é¡¹æ•°é‡ï¼ˆbuilder æ¨¡å¼ï¼‰</td><td>æ— ï¼ˆbuilder æ¨¡å¼å¿…ä¼ ï¼‰</td></tr><tr><td><code>itemBuilder</code></td><td><code>IndexedWidgetBuilder</code></td><td>å­é¡¹æ„å»ºå™¨ï¼ˆæ‡’åŠ è½½ï¼‰</td><td>æ— ï¼ˆbuilder æ¨¡å¼å¿…ä¼ ï¼‰</td></tr></tbody></table>
<h4 data-id="heading-15">3.1.2 SliverWaterfallFlowDelegateWithFixedCrossAxisCountï¼ˆå¸¸ç”¨å¸ƒå±€ä»£ç†ï¼‰</h4>















































<table><thead><tr><th>å±æ€§å</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>crossAxisCount</code></td><td><code>int</code></td><td>åˆ—æ•°ï¼ˆæ ¸å¿ƒï¼‰</td><td>æ— ï¼ˆå¿…ä¼ ï¼‰</td></tr><tr><td><code>crossAxisSpacing</code></td><td><code>double</code></td><td>åˆ—ä¹‹é—´çš„é—´è·</td><td><code>0.0</code></td></tr><tr><td><code>mainAxisSpacing</code></td><td><code>double</code></td><td>è¡Œä¹‹é—´çš„é—´è·</td><td><code>0.0</code></td></tr><tr><td><code>lastChildLayoutTypeBuilder</code></td><td><code>LastChildLayoutTypeBuilder</code></td><td>æœ€åä¸€ä¸ªå­é¡¹å¸ƒå±€ç±»å‹</td><td><code>null</code></td></tr><tr><td><code>viewportBuilder</code></td><td><code>ViewportBuilder</code></td><td>è§†å£å†…å­é¡¹å˜åŒ–å›è°ƒ</td><td><code>null</code></td></tr><tr><td><code>collectGarbage</code></td><td><code>CollectGarbage</code></td><td>å›æ”¶ä¸å¯è§å­é¡¹æ—¶çš„å›è°ƒ</td><td><code>null</code></td></tr></tbody></table>
<h4 data-id="heading-16">3.1.3 LastChildLayoutTypeï¼ˆæœ€åä¸€ä¸ªå­é¡¹å¸ƒå±€ç±»å‹ï¼‰</h4>





















<table><thead><tr><th>æšä¸¾å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>LastChildLayoutType.none</code></td><td>æ— ç‰¹æ®Šå¸ƒå±€ï¼ˆé»˜è®¤ï¼‰</td></tr><tr><td><code>LastChildLayoutType.fullCrossAxisExtent</code></td><td>å æ»¡æ•´è¡Œå®½åº¦</td></tr><tr><td><code>LastChildLayoutType.footnote</code></td><td>è„šæ³¨æ ·å¼ï¼ˆå°å°ºå¯¸ï¼‰</td></tr></tbody></table>
<h3 data-id="heading-17">3.2 pull_to_refresh æ ¸å¿ƒ API/å±æ€§</h3>
<h4 data-id="heading-18">3.2.1 SmartRefresherï¼ˆæ ¸å¿ƒç»„ä»¶ï¼‰</h4>













































































<table><thead><tr><th>å±æ€§å</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>enablePullDown</code></td><td><code>bool</code></td><td>æ˜¯å¦å¯ç”¨ä¸‹æ‹‰åˆ·æ–°</td><td><code>true</code></td></tr><tr><td><code>enablePullUp</code></td><td><code>bool</code></td><td>æ˜¯å¦å¯ç”¨ä¸Šæ‹‰åŠ è½½</td><td><code>false</code></td></tr><tr><td><code>header</code></td><td><code>RefreshHeader</code></td><td>ä¸‹æ‹‰åˆ·æ–°å¤´éƒ¨æ ·å¼</td><td><code>ClassicHeader()</code></td></tr><tr><td><code>footer</code></td><td><code>LoadFooter</code></td><td>ä¸Šæ‹‰åŠ è½½åº•éƒ¨æ ·å¼</td><td><code>ClassicFooter()</code></td></tr><tr><td><code>controller</code></td><td><code>RefreshController</code></td><td>åˆ·æ–°/åŠ è½½æ§åˆ¶å™¨ï¼ˆæ ¸å¿ƒï¼‰</td><td>æ— ï¼ˆå¿…ä¼ ï¼‰</td></tr><tr><td><code>onRefresh</code></td><td><code>VoidCallback?</code></td><td>ä¸‹æ‹‰åˆ·æ–°å›è°ƒ</td><td><code>null</code></td></tr><tr><td><code>onLoading</code></td><td><code>VoidCallback?</code></td><td>ä¸Šæ‹‰åŠ è½½å›è°ƒ</td><td><code>null</code></td></tr><tr><td><code>child</code></td><td><code>Widget</code></td><td>åŒ…è£¹çš„å­ç»„ä»¶ï¼ˆå¦‚åˆ—è¡¨/ç€‘å¸ƒæµï¼‰</td><td>æ— ï¼ˆå¿…ä¼ ï¼‰</td></tr><tr><td><code>scrollDirection</code></td><td><code>Axis</code></td><td>æ»šåŠ¨æ–¹å‘</td><td><code>Axis.vertical</code></td></tr><tr><td><code>physics</code></td><td><code>ScrollPhysics</code></td><td>æ»šåŠ¨ç‰©ç†æ•ˆæœ</td><td><code>ClampingScrollPhysics()</code></td></tr><tr><td><code>enableTwoLevel</code></td><td><code>bool</code></td><td>æ˜¯å¦å¯ç”¨äºŒçº§åˆ·æ–°ï¼ˆå¦‚ä¸‹æ‹‰å±•å¼€æ›´å¤šï¼‰</td><td><code>false</code></td></tr></tbody></table>
<h4 data-id="heading-19">3.2.2 RefreshControllerï¼ˆæ ¸å¿ƒæ§åˆ¶å™¨ï¼‰</h4>









































<table><thead><tr><th>æ–¹æ³•å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>refreshCompleted()</code></td><td>æ ‡è®°ä¸‹æ‹‰åˆ·æ–°å®Œæˆ</td></tr><tr><td><code>refreshFailed()</code></td><td>æ ‡è®°ä¸‹æ‹‰åˆ·æ–°å¤±è´¥</td></tr><tr><td><code>loadComplete()</code></td><td>æ ‡è®°ä¸Šæ‹‰åŠ è½½å®Œæˆ</td></tr><tr><td><code>loadNoData()</code></td><td>æ ‡è®°æ— æ›´å¤šæ•°æ®</td></tr><tr><td><code>resetNoData()</code></td><td>é‡ç½®æ— æ›´å¤šæ•°æ®çŠ¶æ€</td></tr><tr><td><code>dispose()</code></td><td>é‡Šæ”¾æ§åˆ¶å™¨èµ„æºï¼ˆå¿…å†™ï¼Œé¿å…å†…å­˜æ³„æ¼ï¼‰</td></tr><tr><td><code>requestRefresh()</code></td><td>ä¸»åŠ¨è§¦å‘ä¸‹æ‹‰åˆ·æ–°</td></tr><tr><td><code>requestLoading()</code></td><td>ä¸»åŠ¨è§¦å‘ä¸Šæ‹‰åŠ è½½</td></tr></tbody></table>
<h4 data-id="heading-20">3.2.3 ClassicHeader/ClassicFooterï¼ˆç»å…¸æ ·å¼ï¼‰</h4>



























































<table><thead><tr><th>å±æ€§å</th><th>ç±»å‹</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td><code>height</code></td><td><code>double</code></td><td>å¤´éƒ¨/åº•éƒ¨é«˜åº¦</td><td><code>60.0</code></td></tr><tr><td><code>idleText</code></td><td><code>String</code></td><td>é—²ç½®çŠ¶æ€æ–‡æœ¬</td><td>ä¸‹æ‹‰åˆ·æ–°/ä¸Šæ‹‰åŠ è½½</td></tr><tr><td><code>refreshingText</code></td><td><code>String</code></td><td>åˆ·æ–°ä¸­/åŠ è½½ä¸­æ–‡æœ¬</td><td>åˆ·æ–°ä¸­/åŠ è½½ä¸­</td></tr><tr><td><code>completeText</code></td><td><code>String</code></td><td>å®ŒæˆçŠ¶æ€æ–‡æœ¬</td><td>åˆ·æ–°å®Œæˆ/åŠ è½½å®Œæˆ</td></tr><tr><td><code>failedText</code></td><td><code>String</code></td><td>å¤±è´¥çŠ¶æ€æ–‡æœ¬</td><td>åˆ·æ–°å¤±è´¥/åŠ è½½å¤±è´¥</td></tr><tr><td><code>noDataText</code></td><td><code>String</code></td><td>æ— æ›´å¤šæ•°æ®æ–‡æœ¬</td><td>æš‚æ— æ›´å¤šæ•°æ®</td></tr><tr><td><code>textStyle</code></td><td><code>TextStyle</code></td><td>æ–‡æœ¬æ ·å¼</td><td>ç°è‰² 14 å·å­—</td></tr><tr><td><code>iconSize</code></td><td><code>double</code></td><td>å›¾æ ‡å¤§å°</td><td><code>20.0</code></td></tr></tbody></table>
<h2 data-id="heading-21">4. å®Œæ•´ä»£ç </h2>
<pre><code class="hljs language-Dart" lang="Dart">
<span class="hljs-keyword">import</span> <span class="hljs-string">'dart:async'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:flutter/material.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:pull_to_refresh/pull_to_refresh.dart'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'package:waterfall_flow/waterfall_flow.dart'</span>;

<span class="hljs-comment">/// <span class="markdown">æœ¬åœ°å›¾ç‰‡æšä¸¾</span></span>
<span class="hljs-keyword">enum</span> ImageEnum {
  banner1,
  banner2,
  banner3,
  model1,
  model2,
  model3,
  model4,
}

<span class="hljs-comment">/// <span class="markdown">ä¸ºæšä¸¾æ‰©å±•è·å–å›¾ç‰‡è·¯å¾„çš„æ–¹æ³•</span></span>
<span class="hljs-keyword">extension</span> ImageEnumExtension <span class="hljs-keyword">on</span> ImageEnum {
  <span class="hljs-built_in">String</span> <span class="hljs-keyword">get</span> path {
    <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">this</span>) {
      <span class="hljs-keyword">case</span> ImageEnum.banner1:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/banner1.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.banner2:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/banner2.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.banner3:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/banner3.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.model1:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/model1.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.model2:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/model2.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.model3:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/model3.png'</span>;
      <span class="hljs-keyword">case</span> ImageEnum.model4:
        <span class="hljs-keyword">return</span> <span class="hljs-string">'assets/images/model4.png'</span>;
    }
  }
}

<span class="hljs-comment">/// <span class="markdown">ç€‘å¸ƒæµç»„ä»¶</span></span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageWaterfallFlow</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{
  <span class="hljs-keyword">const</span> ImageWaterfallFlow({<span class="hljs-keyword">super</span>.key});

  <span class="hljs-meta">@override</span>
  State&lt;ImageWaterfallFlow&gt; createState() =&gt; ImageWaterfallFlowState();
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageWaterfallFlowState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">ImageWaterfallFlow</span>&gt; </span>{
  <span class="hljs-comment">/// <span class="markdown">å­—ä½“æ ·å¼</span></span>
  <span class="hljs-keyword">final</span> TextStyle myTxtStyle = <span class="hljs-keyword">const</span> TextStyle(
      color: Colors.white, fontSize: <span class="hljs-number">24</span>, fontWeight: FontWeight.w800);

  <span class="hljs-comment">/// <span class="markdown">æ¨¡æ‹Ÿæ•°æ®ï¼ˆåˆå§‹æ•°æ®ï¼‰- å¢åŠ æ³›å‹æå‡ç±»å‹å®‰å…¨</span></span>
  <span class="hljs-built_in">List</span>&lt;ImageEnum&gt; imageList = [
    ImageEnum.banner1,
    ImageEnum.banner2,
    ImageEnum.banner3,
    ImageEnum.model1,
    ImageEnum.model2,
    ImageEnum.model3,
    ImageEnum.model4,
    ImageEnum.banner1,
    ImageEnum.banner2,
    ImageEnum.banner3,
    ImageEnum.model1,
    ImageEnum.model2,
    ImageEnum.model3,
    ImageEnum.model4
  ];

  <span class="hljs-comment">/// <span class="markdown">æ¨¡æ‹Ÿæ•°æ®ï¼ˆåŠ è½½æ›´å¤šä½¿ç”¨ï¼‰</span></span>
  <span class="hljs-built_in">List</span>&lt;ImageEnum&gt; moreList = [ImageEnum.banner1, ImageEnum.banner2, ImageEnum.banner3];

  <span class="hljs-comment">/// <span class="markdown">ä¸Šæ‹‰ä¸‹æ‹‰æ§åˆ¶å™¨</span></span>
  <span class="hljs-keyword">final</span> RefreshController myRefreshController = RefreshController();

  <span class="hljs-comment">/// <span class="markdown">åˆ·æ–°</span></span>
  <span class="hljs-keyword">void</span> onRefresh() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">await</span> Future.delayed(<span class="hljs-keyword">const</span> <span class="hljs-built_in">Duration</span>(milliseconds: <span class="hljs-number">1000</span>));
    <span class="hljs-comment">// æ¨¡æ‹Ÿåˆ·æ–°ï¼šæ¢å¤åˆå§‹æ•°æ®</span>
    setState(() {
      imageList = [
        ImageEnum.banner1,
        ImageEnum.banner2,
        ImageEnum.banner3,
        ImageEnum.model1,
        ImageEnum.model2,
        ImageEnum.model3,
        ImageEnum.model4,
        ImageEnum.banner1,
        ImageEnum.banner2,
        ImageEnum.banner3,
        ImageEnum.model1,
        ImageEnum.model2,
        ImageEnum.model3,
        ImageEnum.model4
      ];
    });
    myRefreshController.refreshCompleted();
    myRefreshController.resetNoData(); <span class="hljs-comment">// é‡ç½®æ— æ›´å¤šæ•°æ®çŠ¶æ€</span>
  }

  <span class="hljs-comment">/// <span class="markdown">åŠ è½½æ›´å¤š</span></span>
  <span class="hljs-keyword">void</span> onLoadMore() <span class="hljs-keyword">async</span> {
    <span class="hljs-keyword">await</span> Future.delayed(<span class="hljs-keyword">const</span> <span class="hljs-built_in">Duration</span>(milliseconds: <span class="hljs-number">1000</span>));
    <span class="hljs-comment">// æ¨¡æ‹Ÿï¼šæ•°æ®è¶…è¿‡30æ¡æ—¶æ ‡è®°æ— æ›´å¤šæ•°æ®</span>
    <span class="hljs-keyword">if</span> (imageList.length &gt;= <span class="hljs-number">30</span>) {
      myRefreshController.loadNoData();
    } <span class="hljs-keyword">else</span> {
      imageList.addAll(moreList);
      <span class="hljs-keyword">if</span> (mounted) {
        setState(() {});
      }
      myRefreshController.loadComplete();
    }
  }

  <span class="hljs-meta">@override</span>
  <span class="hljs-keyword">void</span> dispose() {
    myRefreshController.dispose(); <span class="hljs-comment">// é‡Šæ”¾æ§åˆ¶å™¨èµ„æº</span>
    <span class="hljs-keyword">super</span>.dispose();
  }

  <span class="hljs-comment">/// <span class="markdown">å¸ƒå±€</span></span>
  <span class="hljs-meta">@override</span>
  Widget build(BuildContext context) {
    <span class="hljs-keyword">return</span> Scaffold(
        backgroundColor: Colors.black,
        body: SafeArea(
            child: SizedBox(
                width: MediaQuery.of(context).size.width,
                height: MediaQuery.of(context).size.height,
                child: listWidget())));
  }

  <span class="hljs-comment">/// <span class="markdown">åˆ—è¡¨</span></span>
  Widget listWidget() {
    <span class="hljs-keyword">return</span> SmartRefresher(
      enablePullDown: <span class="hljs-keyword">true</span>,
      enablePullUp: <span class="hljs-keyword">true</span>,
      header: <span class="hljs-keyword">const</span> ClassicHeader(),
      footer: <span class="hljs-keyword">const</span> ClassicFooter(),
      controller: myRefreshController,
      onRefresh: onRefresh,
      onLoading: onLoadMore,
      child: WaterfallFlow.builder(
        padding: <span class="hljs-keyword">const</span> EdgeInsets.all(<span class="hljs-number">10</span>),
        physics: <span class="hljs-keyword">const</span> BouncingScrollPhysics(),
        gridDelegate: SliverWaterfallFlowDelegateWithFixedCrossAxisCount(
          crossAxisCount: <span class="hljs-number">2</span>,
          crossAxisSpacing: <span class="hljs-number">20</span>,
          mainAxisSpacing: <span class="hljs-number">20</span>,
          viewportBuilder: (<span class="hljs-built_in">int</span> index1, <span class="hljs-built_in">int</span> index2) {
            <span class="hljs-built_in">print</span>(<span class="hljs-string">'å˜åŒ–ï¼š<span class="hljs-subst">$index1</span>-<span class="hljs-subst">$index2</span>'</span>);
          },
          <span class="hljs-comment">// ä¿®æ­£æœ€åä¸€ä¸ªå­é¡¹çš„åˆ¤æ–­é€»è¾‘</span>
          lastChildLayoutTypeBuilder: (index) =&gt; index == imageList.length - <span class="hljs-number">1</span>
              ? LastChildLayoutType.fullCrossAxisExtent
              : LastChildLayoutType.none,
        ),
        itemCount: imageList.length,
        itemBuilder: (BuildContext context, <span class="hljs-built_in">int</span> index) {
          <span class="hljs-keyword">return</span> Container(
            color: Colors.white,
            height: (index + <span class="hljs-number">1</span>) % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> ? <span class="hljs-number">100</span> : <span class="hljs-number">200</span>,
            child: Container(
                alignment: Alignment.center,
                decoration: BoxDecoration(
                    color: Colors.blue.shade300,
                    image: DecorationImage(
                      image: AssetImage(imageList[index].path),
                      fit: BoxFit.cover,
                    )),
                child: Text(<span class="hljs-string">'ç¬¬<span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>å¼ '</span>, style: myTxtStyle)),
          );
        },
      ),
    );
  }
}
</code></pre>
<h2 data-id="heading-22">5. å¸¸è§é—®é¢˜ &amp; è§£å†³æ–¹æ¡ˆ</h2>
<ol>
<li>
<p><strong>å›¾ç‰‡ä¸æ˜¾ç¤º</strong></p>
<ul>
<li>
<p>æ£€æŸ¥ <code>pubspec.yaml</code> ä¸­ <code>assets</code> é…ç½®è·¯å¾„æ˜¯å¦ä¸å®é™…å›¾ç‰‡å­˜æ”¾è·¯å¾„ä¸€è‡´ã€‚</p>
</li>
<li>
<p>æ‰§è¡Œ <code>flutter clean</code> æ¸…ç†ç¼“å­˜åï¼Œé‡æ–°è¿è¡Œé¡¹ç›®ã€‚</p>
</li>
<li>
<p>ç¡®è®¤æšä¸¾æ‰©å±•æ–¹æ³• <code>path</code> è¿”å›çš„è·¯å¾„æ­£ç¡®ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>åŠ è½½æ›´å¤šæ— å“åº”</strong></p>
<ul>
<li>
<p>ç¡®è®¤ <code>SmartRefresher</code> çš„ <code>enablePullUp</code> å±æ€§è®¾ç½®ä¸º <code>true</code>ã€‚</p>
</li>
<li>
<p>æ£€æŸ¥ <code>RefreshController</code> æ˜¯å¦æ­£ç¡®å…³è”åˆ° <code>SmartRefresher</code>ã€‚</p>
</li>
<li>
<p>ç¡®ä¿ <code>onLoading</code> å›è°ƒæ–¹æ³•å·²æ­£ç¡®ç»‘å®šã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>ç€‘å¸ƒæµå¸ƒå±€é”™ä¹±</strong></p>
<ul>
<li>
<p>é¿å…å­é¡¹é«˜åº¦å·®å¼‚è¿‡å¤§ï¼Œå¯æ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´é«˜åº¦è§„åˆ™ã€‚</p>
</li>
<li>
<p>æ£€æŸ¥ <code>crossAxisCount</code>ã€<code>crossAxisSpacing</code> ç­‰å‚æ•°é…ç½®æ˜¯å¦å†²çªã€‚</p>
</li>
<li>
<p>ç¡®è®¤ <code>lastChildLayoutTypeBuilder</code> çš„ç´¢å¼•åˆ¤æ–­é€»è¾‘æ­£ç¡®ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>å†…å­˜æ³„æ¼</strong></p>
<ul>
<li>
<p>åŠ¡å¿…åœ¨ <code>dispose</code> æ–¹æ³•ä¸­è°ƒç”¨ <code>myRefreshController.dispose()</code> é‡Šæ”¾æ§åˆ¶å™¨ã€‚</p>
</li>
<li>
<p>é¿å…åœ¨å¼‚æ­¥æ“ä½œä¸­æœªåˆ¤æ–­ <code>mounted</code> å°±è°ƒç”¨ <code>setState</code>ã€‚</p>
</li>
</ul>
</li>
</ol>
<h2 data-id="heading-23">6. æ€»ç»“</h2>
<p>é€šè¿‡ <code>waterfall_flow</code> å’Œ <code>pull_to_refresh</code> ä¸¤ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œæˆ‘ä»¬å¿«é€Ÿå®ç°äº† Flutter ç€‘å¸ƒæµå¸ƒå±€ï¼Œå¹¶é›†æˆäº†ä¸‹æ‹‰åˆ·æ–°å’Œä¸Šæ‹‰åŠ è½½æ›´å¤šåŠŸèƒ½ã€‚</p>
<p>è¯¥æ–¹æ¡ˆå¯ç›´æ¥åº”ç”¨äºå›¾ç‰‡åˆ—è¡¨ã€å•†å“å±•ç¤ºç­‰å¸¸è§ä¸šåŠ¡åœºæ™¯ï¼Œä¹Ÿå¯æ ¹æ®å®é™…éœ€æ±‚æ‰©å±•å­é¡¹ç‚¹å‡»ã€å›¾ç‰‡æ‡’åŠ è½½ã€è‡ªå®šä¹‰åˆ·æ–°æ ·å¼ç­‰åŠŸèƒ½ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©ä½ ç†è§£å¹¶åœ¨è‡ªå·±çš„ Flutter é¡¹ç›®ä¸­è¿ç”¨ç±»ä¼¼çš„åŠŸèƒ½ã€‚</p>
<hr/>
<blockquote>
<p>æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™å„¿å•¦ï¼Œæˆ‘æ˜¯é¹å¤šå¤šï¼Œæ·±è€•å‰ç«¯çš„æŠ€æœ¯åˆ›ä½œè€…ï¼Œå¦‚æœæ‚¨çœ‹äº†è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºï¼Œå…³æ³¨ï¼Œç‚¹èµï¼Œè½¬å‘ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§~</p>
</blockquote>
<p>PSï¼šåœ¨æœ¬é¡µæŒ‰F12ï¼Œåœ¨consoleä¸­è¾“å…¥document.getElementsByClassName('panel-btn')[0].click();æœ‰æƒŠå–œå“¦~</p>
<p><code>å¾€æœŸæ–‡ç« </code></p>
<ul>
<li><a href="https://juejin.cn/post/7583910637958807571" target="_blank" title="https://juejin.cn/post/7583910637958807571">flutterä½¿ç”¨package_info_plusåº“è·å–åº”ç”¨ä¿¡æ¯çš„æ•™ç¨‹</a></li>
<li><a href="https://juejin.cn/post/7588680081327259690" target="_blank" title="https://juejin.cn/post/7588680081327259690">Flutterä¸‹æ‹‰åˆ·æ–°ä¸Šæ‹‰åŠ è½½ä¾§æ‹‰åˆ·æ–°æ’ä»¶ï¼šeasy_refreshå…¨é¢ä½¿ç”¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7583226204036513833" target="_blank" title="https://juejin.cn/post/7583226204036513833">flutter-ä½¿ç”¨EventBuså®ç°ç»„ä»¶é—´æ•°æ®é€šä¿¡</a></li>
<li><a href="https://juejin.cn/post/7582808491582619684" target="_blank" title="https://juejin.cn/post/7582808491582619684">Flutterè¾“å…¥æ¡†TextFieldçš„å±æ€§ä¸å®æˆ˜ç”¨æ³•å…¨é¢è§£æ+ç¤ºä¾‹</a></li>
<li><a href="https://juejin.cn/post/7581693431740448831" target="_blank" title="https://juejin.cn/post/7581693431740448831">Flutterè‡ªå®šä¹‰æ—¥å†table_calendarå®Œå…¨æŒ‡å—+æ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7580389111921786943" target="_blank" title="https://juejin.cn/post/7580389111921786943">flutter-å±å¹•è‡ªé€‚åº”æ’ä»¶flutter_screenutilæ•™ç¨‹å…¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7579101504289882166" target="_blank" title="https://juejin.cn/post/7579101504289882166">flutter-ä½¿ç”¨url_launcheræ‰“å¼€é“¾æ¥/åº”ç”¨/çŸ­ä¿¡/é‚®ä»¶å’Œè¯„åˆ†è·³è½¬ç­‰</a></li>
<li><a href="https://juejin.cn/post/7570923924365230143" target="_blank" title="https://juejin.cn/post/7570923924365230143">flutterå›¾ç‰‡é€‰æ‹©åº“multi_image_picker_pluså’Œimage_pickerçš„å¯¹æ¯”å’Œä½¿ç”¨è§£æ</a></li>
<li><a href="https://juejin.cn/post/7568136081302978623" target="_blank" title="https://juejin.cn/post/7568136081302978623">è§£é”flutterå¼¹çª—æ–°å§¿åŠ¿ï¼šdialog-flutter_smart_dialogæ’ä»¶è§£è¯»+æ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7559089440901545999" target="_blank" title="https://juejin.cn/post/7559089440901545999">flutter-åˆ‡æ¢çŠ¶æ€æ˜¾ç¤ºä¸åŒç»„ä»¶10ç§å®ç°æ–¹æ¡ˆå…¨è§£æ</a></li>
<li><a href="https://juejin.cn/post/7555079970491318308" target="_blank" title="https://juejin.cn/post/7555079970491318308">flutter-è¯¦è§£æ§åˆ¶ç»„ä»¶æ˜¾ç¤ºçš„ä¸¤ç§æ–¹å¼Offstageä¸Visibility</a></li>
<li><a href="https://juejin.cn/post/7535358416182788122" target="_blank" title="https://juejin.cn/post/7535358416182788122">flutter-ä½¿ç”¨AnimatedDefaultTextStyleå®ç°æ–‡æœ¬åŠ¨ç”»</a></li>
<li><a href="https://juejin.cn/post/7537339432291434496" target="_blank" title="https://juejin.cn/post/7537339432291434496">flutter-ä½¿ç”¨SafeAreaç»„ä»¶å¤„ç†å„æœºå‹çš„å®‰å…¨è·ç¦»</a></li>
<li><a href="https://juejin.cn/spost/7537593417099149321" target="_blank" title="https://juejin.cn/spost/7537593417099149321">flutter-å®ç°æ¸å˜è‰²è¾¹æ¡†èƒŒæ™¯ä»¥åŠæ¸å˜è‰²æ–‡å­—</a></li>
<li><a href="https://juejin.cn/post/7543474419240370185" target="_blank" title="https://juejin.cn/post/7543474419240370185">flutter-ä½¿ç”¨confettiåˆ¶ä½œç‚«é…·çº¸å±‘çˆ†ç‚¸ç²’å­åŠ¨ç”»</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>