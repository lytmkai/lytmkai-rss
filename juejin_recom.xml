<?xml version="1.0" encoding="UTF-8"?><rss version="2.0">  <channel>      <title>æ˜é‡‘æ–‡ç« æ¨è</title>      <link>https://juejin.cn/recommended?sort=newest</link>      <description>ä¸€ä¸ªå¸®åŠ©å¼€å‘è€…æˆé•¿çš„ç¤¾åŒº</description>      <generator>python juejin_recom.py @Pi20</generator>      <item>    <title><![CDATA[åé‡åŠ›æ°›å›´ç¼–ç¨‹ä½¿å¾—å¼€å‘å¼‚å¸¸è½»æ¾]]></title>    <link>https://juejin.cn/post/7593254419078283304</link>    <guid>https://juejin.cn/post/7593254419078283304</guid>    <pubDate>2026-01-10T09:26:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593254419078283304" data-draft-id="7593258683750498338" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åé‡åŠ›æ°›å›´ç¼–ç¨‹ä½¿å¾—å¼€å‘å¼‚å¸¸è½»æ¾"/> <meta itemprop="keywords" content="VibeCoding"/> <meta itemprop="datePublished" content="2026-01-10T09:26:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bytebeats"/> <meta itemprop="url" content="https://juejin.cn/user/463698667655"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åé‡åŠ›æ°›å›´ç¼–ç¨‹ä½¿å¾—å¼€å‘å¼‚å¸¸è½»æ¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/463698667655/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bytebeats
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T09:26:19.000Z" title="Sat Jan 10 2026 09:26:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    3
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åé‡åŠ›æ°›å›´ç¼–ç¨‹: å¦‚ä½•è®©å¼€å‘å˜å¾—è½»è€Œæ˜“ä¸¾</h2>
<p>å½“æˆ‘æåˆ°â€œåé‡åŠ›â€æ—¶, å¹¶éæŒ‡è·³è¿‡å›°éš¾éƒ¨åˆ†. æˆ‘æŒ‡çš„æ˜¯é‚£ç§ç½•è§çš„ä½“éªŒâ€”â€”å·¥ä½œä¸å†æ²‰é‡. ä½ åä¸‹æ¥æ‰“å¼€ä»£ç åº“, ä¸å†ä¸ä»£ç åº“ææ–—, è€Œæ˜¯å¦‚è¡Œäº‘æµæ°´èˆ¬ç©¿æ¢­å…¶ä¸­.</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d289b528b11f485bb5463c8007ead251~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZWJlYXRz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768643671&amp;x-signature=%2BlHStahBhy3LDbj910%2FKKGZD2Ig%3D" alt="" loading="lazy"/></p>
<p>è®¸å¤šäººè¯¯å°†è¿™ç§çŠ¶æ€å½’å› äºå¤©èµ‹æˆ–â€œè¿›å…¥çŠ¶æ€â€. ä½†å®è·µä¸­, å®ƒå¾€å¾€æºäºå‡ ä¸ªæ¯ç‡¥å´å¯é‡å¤çš„é€‰æ‹©â€”â€”æ¶ˆé™¤é˜»åŠ›: æ¸…æ™°çš„è¾¹ç•Œ, å¾®å°çš„æ­¥è¿›, å¿«é€Ÿåé¦ˆ, å‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢, é™ä½æ„å¤–é£é™©.</p>
<p>æ‰€è°“æ°›å›´ç¼–ç¨‹, å¹¶éæ‡’æ•£æ„ä¹‰ä¸Šçš„â€œéšå¿ƒç¼–ç â€, è€Œæ˜¯æ„å»ºè®©å¤§è„‘ä¿æŒå¹³é™çš„ç¯å¢ƒ, ä»è€ŒæŒç»­äº§å‡ºä¼˜è´¨æˆæœ. å½“ç¯å¢ƒè°ƒæ ¡å¾—å½“, ä½ æ—¢èƒ½åŠ é€Ÿäº¤ä»˜, é«˜æ•ˆè°ƒè¯•, äº‹åä¹Ÿä¸è§‰èº«å¿ƒä¿±ç–².</p>
<p>å…³é”®åœ¨äº: åé‡åŠ›å¹¶éæƒ…ç»ªçŠ¶æ€, è€Œæ˜¯å¯è®¾è®¡çš„ç³»ç»Ÿ.</p>
<h3 data-id="heading-1">æ„å»ºæ¨åŠ¨ä½ å‰è¿›çš„ä»£ç åº“</h3>
<p>ä»£ç æ²‰é‡æ„Ÿé€šå¸¸æºäºä¸‰ç§å›°å¢ƒ: æ— æ³•é¢„åˆ¤æ•…éšœç‚¹, éš¾ä»¥å®šä½ä»£ç ä½ç½®, ä¿®æ”¹å•é¡¹éœ€ç‰µåŠ¨åé¡¹. è¿™ä¾¿æ˜¯é‡åŠ›â€”â€”å®ƒå°†ä½ æ‹–æ‹½å‘ä¸‹.</p>
<p>åé‡åŠ›å§‹äºå»ºç«‹ä¿¡ä»»çš„ç»“æ„. æ— éœ€å®Œç¾æ¶æ„, åªéœ€è¶³å¤Ÿä¸€è‡´æ€§, è®©æœªæ¥çš„ä½ æ¯æ¬¡æ‰“å¼€æ–‡ä»¶æ—¶ä¸ä¼šæ„Ÿåˆ°è¢«èƒŒå›.</p>
<p>ä»¥ä¸‹å®ç”¨æ¨¡å¼èƒ½åˆ›é€ è¿™ç§â€œå‘å‰æ‹‰åŠ›â€:</p>
<ul>
<li><strong>æ˜ç¡®å½’å±åœ°</strong>.  è‹¥ä¸‰ä¸ªæ–‡ä»¶å¤¹åç§°éƒ½å¯èƒ½åŒ…å«ç›¸åŒé€»è¾‘, ä½ å·²åˆ¶é€ äº†è®¤çŸ¥è´Ÿæ‹…. é€‰å®šè§„èŒƒå¹¶åšæŒåˆ°åº•.</li>
<li><strong>å¾®å°æ¨¡å—é…é†’ç›®æ ‡ç­¾</strong>.   åä¸º<code>handleUser</code>çš„å‡½æ•°å«ç³Šä¸æ¸…, è€Œ<code>refreshSessionTokenIfExpired</code>åˆ™æ— éœ€é˜…è¯»ä»£ç å°±èƒ½ç›´è§‚ä¼ è¾¾åŠŸèƒ½.</li>
<li><strong>å‡å°‘â€œèªæ˜â€æ·å¾„</strong>.   ç²¾å¦™çš„æŠ½è±¡è®¾è®¡ä»Šæ—¥ä»¤äººç§°é“, ä¸¤å‘¨åå´æˆè¯…å’’. åé‡åŠ›æ³•åˆ™æ¨å´‡æ¯ç‡¥çš„æ¸…æ™°.</li>
<li><strong>æœç»æ¥å£æ³„éœ²</strong>.  è‹¥æ¯ä¸ªç»„ä»¶éƒ½éœ€çŸ¥æ™“å…¶ä»–ç»„ä»¶çš„å†…éƒ¨ç»†èŠ‚, æ‘©æ“¦å¿…å°†äº§ç”Ÿ. ç”¨æ¸…æ™°çš„è¾¹ç•Œéšè—æ··ä¹±.</li>
<li><strong>æ¸…é™¤â€œç¥ç§˜è‚‰â€</strong>.  å…³é”®ä»£ç å³ä½¿å†—é•¿ä¹Ÿéœ€å¯è¯». å°†å·§å¦™ç•™ç»™å¯éš”ç¦»ä¸”ç»è¿‡æµ‹è¯•çš„åœºæ™¯.</li>
</ul>
<p>è¿™æ— å…³ç¾å­¦, å…³ä¹åŠ¿èƒ½. å½“ä»£ç å¯é¢„æµ‹æ—¶, è¡ŒåŠ¨ä¾¿å……æ»¡ä¿¡å¿ƒ. ä¿¡å¿ƒæ¯”æ€€ç–‘æ›´è½»ç›ˆ, è€Œæ€€ç–‘æ‰æ˜¯çœŸæ­£çš„é‡è´Ÿ.</p>
<h3 data-id="heading-2">æ°›å›´å¾ªç¯: å°èƒœåˆ©, å¿«åé¦ˆ, é›¶æˆå‰§</h3>
<p>æ€æ­»ç¼–ç¨‹æ°›å›´æœ€å¿«çš„æ–¹å¼, å°±æ˜¯é™·å…¥æ¼«é•¿è¿·é›¾èˆ¬çš„å¾ªç¯: ä¿®æ”¹å¤§é‡ä»£ç â†’è¿è¡Œå·¨å‹æ„å»ºâ†’æŸå¤„å‡ºé”™â†’å¼€å§‹æ‰é¬¼. è¿™å¦‚åŒå¾’æ‰‹æ¨è½¦ä¸Šå¡.</p>
<p>åé‡åŠ›ç¼–ç¨‹æ°æ°ç›¸å: å¾®å°æ“ä½œ, å³æ—¶åé¦ˆ, å³æ—¶å›æŠ¥. è¿™ç§å¾ªç¯ä»¤äººä¸Šç˜¾, å´å……æ»¡æ­£å‘èƒ½é‡.</p>
<p>å…·ä½“å®è·µå¦‚ä¸‹:</p>
<ul>
<li>æ¯æ¬¡å˜æ›´ä¿æŒ<strong>æå°è§„æ¨¡</strong>, ç¡®ä¿å›æ»šæ¯«æ— ç—›æ„Ÿ</li>
<li>æµ‹è¯•æˆ–é¢„è§ˆ<strong>æŒç»­è¿›è¡Œ</strong>, è€Œéâ€œç•™åˆ°æœ€åâ€</li>
<li>å°†é”™è¯¯è§†ä¸ºä¿¡å·è€Œéä¾®è¾±</li>
<li>æ¯æ¬¡ç»“æŸå·¥ä½œæ—¶ä¸ºåç»­æ“ä½œç•™ä¸‹é¢åŒ…å±‘</li>
</ul>
<p>è‹¥è¦å½’çº³æˆç®€å•æ³•åˆ™: <em>æ°¸è¿œåˆ«è®©å¤§è„‘åŒæ—¶å¤„ç†å¤ªå¤šæœªçŸ¥</em>. æœªçŸ¥æ˜¯æ²‰é‡çš„è´Ÿæ‹…, æ¯ä¸ªæœªçŸ¥éƒ½åƒå—ç ç .</p>
<p>æ‰€ä»¥ä¸å…¶è¯´â€œæˆ‘è¦é‡æ„æ•´ä¸ªæ¨¡å—â€, ä¸å¦‚è¿™æ ·åš:</p>
<ul>
<li>é‡å‘½åå‡½æ•°. è¿è¡Œ.</li>
<li>æå–ä¸€ä¸ªè¾…åŠ©å‡½æ•°. è¿è¡Œ.</li>
<li>æ·»åŠ ä¸€ä¸ªæµ‹è¯•. è¿è¡Œ.</li>
<li>ç§»é™¤ä¸€ä¸ªä¾èµ–é¡¹. è¿è¡Œ.</li>
</ul>
<p>ä¸¤ä¸ªä¸­ç­‰æ­¥éª¤, æ¥ç€ä¸€ä¸ªè¾ƒé•¿æ­¥éª¤, å†å›å½’ä¸­ç­‰èŠ‚å¥. è¿™ç§éŸµå¾‹è‡³å…³é‡è¦. å®ƒèƒ½é˜²æ­¢ä½ ç²¾ç–²åŠ›ç«­, ä¿æŒä¸“æ³¨åŠ›å®Œæ•´.</p>
<h3 data-id="heading-3">ä¿æŒé­”åŠ›ä¸å¤±çš„è°ƒè¯•ä¹‹é“</h3>
<p>è°ƒè¯•å¾€å¾€æ˜¯ç¼–ç¨‹çµæ„Ÿæ¶ˆäº¡ä¹‹åœ°. å¹¶éè°ƒè¯•æœ¬èº«å›°éš¾, è€Œæ˜¯å®ƒä¼šåˆ¶é€ æƒ…ç»ªå™ªéŸ³. ä½ å¼€å§‹ç›²ç›®ä¿®æ”¹ä»£ç , æ€ç»´å˜å¾—æ··ä¹±, é™·å…¥è¢«åŠ¨åº”å¯¹çš„çŠ¶æ€.</p>
<p>åé‡åŠ›è°ƒè¯•åˆ™æ›´ä¸ºæ²‰é™. å®ƒè¿‘ä¹æ¯ç‡¥, è€Œè¿™æ­£æ˜¯å…³é”®æ‰€åœ¨.</p>
<p>å†·é™çš„è°ƒè¯•æµç¨‹å¦‚ä¸‹:</p>
<ol>
<li><strong>ä½¿é”™è¯¯å¯å¤ç°</strong>.  è‹¥æ— æ³•å¤ç°é—®é¢˜, ä½ å°±æ˜¯åœ¨ç¢°è¿æ°”.</li>
<li><strong>ç¼©å°æ•…éšœèŒƒå›´</strong>.  é€æ­¥å‰¥ç¦»åœºæ™¯, ç›´è‡³åªå‰©ä¸‹æœ€å°çš„æ•…éšœå•å…ƒ.</li>
<li><strong>å¢å¼ºå¯è§†æ€§</strong>.  æ—¥å¿—, è·Ÿè¸ª, æ–­ç‚¹, æ‰‹æ®µä¸é™. ä½†åŠ¡å¿…æœ‰æ„è¯†åœ°å®æ–½.</li>
<li><strong>æ¯æ¬¡åªæ”¹å˜ä¸€ä¸ªå˜é‡</strong>.  åƒåšå®éªŒå®¤å®éªŒè€Œéæ‹³å‡»èµ›èˆ¬ä¸¥è°¨æ“ä½œ.</li>
<li><strong>è®°å½•å‡è®¾</strong>.   å“ªæ€•åªæœ‰ä¸€è¡Œ. è¿™èƒ½è®©ä½ ä¿æŒæ¸…é†’.</li>
</ol>
<p>æ€ç»´è½¬å˜è‡³å…³é‡è¦: ç³»ç»Ÿå´©æºƒå¹¶éâ€œå¤±è´¥â€, è€Œæ˜¯è¯æ®æ”¶é›†. è¿™ç§å¿ƒæ€èƒ½ä¿æŒå›¢é˜Ÿæ´»åŠ›.</p>
<p>ä¿®å¤å, æ‰§è¡Œæœ€ç»ˆçš„åé‡åŠ›æ“ä½œ: <strong>é”å®šèƒœåˆ©</strong>. æ·»åŠ æµ‹è¯•ç”¨ä¾‹, ä¿æŠ¤æœºåˆ¶æˆ–æ¸…æ™°çš„é”™è¯¯æç¤º. æœªæ¥çš„ä½ ä¼šç«‹åˆ»æ„Ÿå—åˆ°å·®å¼‚.</p>
<h3 data-id="heading-4">æ— é‡åŠ›èˆ¬åœ°äº¤ä»˜</h3>
<p>äº¤ä»˜æ˜¯åé‡åŠ›çš„ç»ˆæå½¢æ€. ç›®æ ‡å¹¶éæ— ä¼‘æ­¢æ‰“ç£¨, è€Œæ˜¯è®©ä½œå“è¿›å…¥ä¸–ç•Œæ—¶ä¸æ²¦ä¸ºå‹åŠ›äº‹ä»¶.</p>
<p>è¿™æ­£æ˜¯è®¸å¤šå¼€å‘è€…é™·å…¥å›°å¢ƒä¹‹å¤„, å°¤å…¶åœ¨åŠ å¯†é¢†åŸŸâ€”â€”ç¯å¢ƒå–§åš£, ä¸€åˆ‡éƒ½æ˜¾å¾—é«˜é£é™©. ä½†æ‰€è°“â€œé«˜é£é™©â€å¾€å¾€åªæ˜¯â€œé«˜ä¸ç¡®å®šæ€§â€çš„ä»£åè¯.</p>
<p>å› æ­¤å®ç°è½»é‡åŒ–äº¤ä»˜çš„å…³é”®åœ¨äºé™ä½ä¸ç¡®å®šæ€§:</p>
<ul>
<li><strong>åŠŸèƒ½å¼€å…³èƒœè¿‡å¤§è§„æ¨¡å‘å¸ƒ</strong>.  å…ˆä½è°ƒä¸Šçº¿, å†é€æ­¥å¯ç”¨.</li>
<li><strong>å¢é‡å‘å¸ƒ</strong>.   ä¸å¿…ç­‰å¾…â€œå®Œç¾ç‰ˆæœ¬â€.</li>
<li><strong>é»˜è®¤å¯ç”¨å¯è§‚æµ‹æ€§</strong>.   æŒ‡æ ‡, æ—¥å¿—, åŸºç¡€è­¦æŠ¥. ä½ ä¸éœ€è¦NASAçº§åˆ«çš„ç³»ç»Ÿ, ä½ éœ€è¦çš„æ˜¯çœ¼ç›.</li>
<li><strong>éƒ¨ç½²å‰åˆ¶å®šå›æ»šæ–¹æ¡ˆ</strong>.   çŸ¥é“é€€è·¯åœ¨å“ªé‡Œ, æ‰èƒ½æ›´ä»å®¹åœ°è¿ˆæ­¥å‘å‰.</li>
<li><strong>æ˜ç¡®æ²Ÿé€šèŒƒå›´</strong>.   å£°æ˜â€œè¿™æ˜¯V1ç‰ˆæœ¬, å®ç°XåŠŸèƒ½è€ŒéYåŠŸèƒ½â€, å¯é¿å…é™·å…¥æ··ä¹±.</li>
</ul>
<p>å°¤å…¶åœ¨åŠ å¯†äº§å“é¢†åŸŸ, åé‡åŠ›å‘å¸ƒæ˜¯ç”Ÿå­˜æŠ€èƒ½. å¸‚åœºç¬æ¯ä¸‡å˜, ç”¨æˆ·è€å¿ƒæœ‰é™, æ¼æ´ä¼šè¢«æ”¾å¤§. è‹¥æ¯æ¬¡å‘å¸ƒéƒ½åƒæ‚¬å´–è·³è·ƒ, ç»ˆå°†å¯¼è‡´å›¢é˜Ÿå›é¿å‘å¸ƒâ€”â€”è€Œæœ€ç»ˆä»ä¼šå¤±è´¥.</p>
<p>å¥‡æ€ªçš„çœŸç›¸æ˜¯: æœ€è½»é‡çº§çš„å›¢é˜Ÿå¹¶éäººæ‰æœ€å¯†é›†çš„å›¢é˜Ÿ, è€Œæ˜¯é‚£äº›å°†æƒ³æ³•ä¸ç°å®ä¹‹é—´æ‘©æ“¦é™åˆ°æœ€ä½çš„å›¢é˜Ÿ.</p>
<p>å¥½å§, ä»Šå¤©çš„å†…å®¹å°±åˆ†äº«åˆ°è¿™é‡Œå•¦!</p>
<p>ä¸€å®¶ä¹‹è¨€, æ¬¢è¿æ‹ç –!</p>
<p>Happy coding! Stay GOLDEN!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ‰“é€  AI é©±åŠ¨çš„ Git æäº¤è§„èŒƒåŠ©æ‰‹ï¼šåŸºäº React + Express + Ollama+langchain çš„å…¨æ ˆå®è·µ]]></title>    <link>https://juejin.cn/post/7593198957984514089</link>    <guid>https://juejin.cn/post/7593198957984514089</guid>    <pubDate>2026-01-10T08:50:18.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593198957984514089" data-draft-id="7593215107406331940" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ‰“é€  AI é©±åŠ¨çš„ Git æäº¤è§„èŒƒåŠ©æ‰‹ï¼šåŸºäº React + Express + Ollama+langchain çš„å…¨æ ˆå®è·µ"/> <meta itemprop="keywords" content="å…¨æ ˆ,Ollama,LangChain"/> <meta itemprop="datePublished" content="2026-01-10T08:50:18.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ohyeah"/> <meta itemprop="url" content="https://juejin.cn/user/740446536480618"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ‰“é€  AI é©±åŠ¨çš„ Git æäº¤è§„èŒƒåŠ©æ‰‹ï¼šåŸºäº React + Express + Ollama+langchain çš„å…¨æ ˆå®è·µ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/740446536480618/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ohyeah
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T08:50:18.000Z" title="Sat Jan 10 2026 08:50:18 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ï¼Œ<strong>é«˜è´¨é‡çš„ Git æäº¤ä¿¡æ¯</strong>ä¸ä»…æ˜¯å›¢é˜Ÿåä½œçš„åŸºç¡€ï¼Œæ›´æ˜¯é¡¹ç›®å¯ç»´æŠ¤æ€§ã€å¯è¿½æº¯æ€§å’Œå·¥ç¨‹æ–‡åŒ–çš„é‡è¦ä½“ç°ã€‚ç„¶è€Œï¼Œè®¸å¤šå¼€å‘è€…ï¼ˆå°¤å…¶æ˜¯åˆå­¦è€…ï¼‰å¸¸å¸¸å¿½ç•¥æäº¤ä¿¡æ¯çš„è§„èŒƒæ€§ï¼Œå¯¼è‡´æäº¤æ—¥å¿—æ··ä¹±ã€éš¾ä»¥ç†è§£ï¼Œç”šè‡³å½±å“ Code Review å’Œæ•…éšœæ’æŸ¥æ•ˆç‡ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸€ç—›ç‚¹ï¼Œæœ¬æ–‡å°†å¸¦ä½ ä»é›¶æ„å»ºä¸€ä¸ª <strong>AI é©±åŠ¨çš„ Git æäº¤è§„èŒƒåŠ©æ‰‹ â€”â€” git-differ</strong>ã€‚è¯¥é¡¹ç›®ç»“åˆäº†å‰ç«¯ï¼ˆReact + Tailwind CSS + Axiosï¼‰ã€åç«¯ï¼ˆNode.js + Expressï¼‰ä»¥åŠæœ¬åœ°å¤§æ¨¡å‹ï¼ˆOllama + DeepSeek-R1:8Bï¼‰ï¼Œé€šè¿‡åˆ†æ <code>git diff</code> å†…å®¹ï¼Œè‡ªåŠ¨ç”Ÿæˆç¬¦åˆ Conventional Commits è§„èŒƒçš„æäº¤ä¿¡æ¯ã€‚</p>
<p>æˆ‘ä»¬å°†æ·±å…¥å‰–æé¡¹ç›®çš„ä»£ç ç»“æ„ã€æŠ€æœ¯é€‰å‹ä¸å…³é”®çŸ¥è¯†ç‚¹ï¼Œå¹¶å›´ç»• <strong>è·¨åŸŸå¤„ç†ã€LangChain é›†æˆã€è‡ªå®šä¹‰ React Hook å°è£…ã€Express è·¯ç”±è®¾è®¡</strong> ç­‰æ ¸å¿ƒå†…å®¹å±•å¼€è¯¦ç»†è®²è§£ã€‚</p>
<hr/>
<h2 data-id="heading-0">ä¸€ã€é¡¹ç›®æ•´ä½“æ¶æ„ä¸æŠ€æœ¯æ ˆ</h2>
<p><code>git-differ</code> æ˜¯ä¸€ä¸ªå…¸å‹çš„å‰åç«¯åˆ†ç¦»å…¨æ ˆåº”ç”¨ï¼š</p>
<ul>
<li><strong>å‰ç«¯</strong>ï¼šè¿è¡Œäºæµè§ˆå™¨ï¼ˆå¦‚ <code>http://localhost:5173</code>ï¼‰ï¼Œä½¿ç”¨ React æ„å»º UIï¼ŒTailwind CSS å®ç°å“åº”å¼æ ·å¼ï¼ŒAxios å‘èµ· HTTP è¯·æ±‚ã€‚</li>
<li><strong>åç«¯</strong>ï¼šè¿è¡Œäº Node.js ç¯å¢ƒï¼ˆ<code>http://localhost:3000</code>ï¼‰ï¼ŒåŸºäº Express æ¡†æ¶æä¾› RESTful APIã€‚</li>
<li><strong>AI å¼•æ“</strong>ï¼šæœ¬åœ°éƒ¨ç½² Ollama æœåŠ¡ï¼ˆ<code>http://localhost:11434</code>ï¼‰ï¼ŒåŠ è½½å¼€æºå¤§æ¨¡å‹ <code>deepseek-r1:8b</code>ï¼Œé€šè¿‡ LangChain è¿›è¡Œæç¤ºå·¥ç¨‹ä¸è¾“å‡ºè§£æã€‚</li>
</ul>
<p>æ•´ä¸ªæ•°æ®æµå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">ç”¨æˆ·è¾“å…¥ git diff â†’ å‰ç«¯å‘é€ POST /chat â†’ åç«¯æ¥æ”¶å¹¶è°ƒç”¨ Ollama â†’ AI ç”Ÿæˆ commit message â†’ è¿”å›å‰ç«¯å±•ç¤º
</code></pre>
<p>è¿™ç§æ¶æ„ä¸ä»…è§£è€¦æ¸…æ™°ï¼Œè¿˜ä¾¿äºåç»­æ‰©å±•ï¼ˆå¦‚æ”¯æŒå¤šæ¨¡å‹ã€å†å²è®°å½•ã€é…ç½®ç®¡ç†ç­‰ï¼‰ã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€å‰ç«¯å®ç°ï¼šReact + è‡ªå®šä¹‰ Hook + Axios æ¨¡å—åŒ–</h2>
<h3 data-id="heading-2">1. ä¸»ç»„ä»¶ <code>App.jsx</code>ï¼šUI ä¸é€»è¾‘åˆ†ç¦»</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">import</span> { chat } <span class="hljs-keyword">from</span> <span class="hljs-string">'./api/axios'</span>
<span class="hljs-keyword">import</span> { useGitDiff } <span class="hljs-keyword">from</span> <span class="hljs-string">"./hooks/useGitDiff"</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>){
  <span class="hljs-keyword">const</span> { loading, content } = <span class="hljs-title function_">useGitDiff</span>(<span class="hljs-string">'hello'</span>)

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"flex"</span>&gt;</span>
      {loading ? 'loading...' : content}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<p>ä¸»ç»„ä»¶æå…¶ç®€æ´ï¼Œä»…è´Ÿè´£æ¸²æŸ“çŠ¶æ€ã€‚çœŸæ­£çš„ä¸šåŠ¡é€»è¾‘è¢«å°è£…åœ¨ <code>useGitDiff</code> è‡ªå®šä¹‰ Hook ä¸­ï¼Œä½“ç°äº† <strong>â€œç»„ä»¶åªè´Ÿè´£ UIâ€</strong> çš„æœ€ä½³å®è·µã€‚</p>
<blockquote>
<p>â€œuseå¼€å¤´ å°è£…å“åº”å¼ä¸šåŠ¡ å‰¯ä½œç”¨ç­‰ ä»ç»„ä»¶é‡Œé¢å‰¥ç¦» ç»„ä»¶åªè´Ÿè´£UIâ€</p>
</blockquote>
<p>è¿™ç§æ¨¡å¼æå¤§æå‡äº†ä»£ç çš„å¯è¯»æ€§ä¸å¤ç”¨æ€§ã€‚æœªæ¥è‹¥éœ€åœ¨å¤šä¸ªé¡µé¢ä½¿ç”¨ AI ç”Ÿæˆ commit message åŠŸèƒ½ï¼Œåªéœ€è°ƒç”¨ <code>useGitDiff</code> å³å¯ã€‚</p>
<hr/>
<h3 data-id="heading-3">2. API å±‚ï¼šAxios æ¨¡å—åŒ–å°è£…</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/api/axios.js</span>
<span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>

<span class="hljs-comment">// åˆ›å»ºaxioså®ä¾‹ ç»Ÿä¸€è¿›è¡Œé…ç½®</span>
<span class="hljs-keyword">const</span> service = axios.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">baseURL</span>: <span class="hljs-string">'http://localhost:3000'</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
  },
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">60000</span>
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">chat</span> = (<span class="hljs-params">message</span>) =&gt; {
  <span class="hljs-keyword">return</span> service.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/chat'</span>, {
    message
  })
}
</code></pre>
<p>è¿™é‡Œé€šè¿‡ <code>axios.create()</code> åˆ›å»ºäº†ä¸€ä¸ª <strong>ä¸“ç”¨çš„ HTTP å®¢æˆ·ç«¯å®ä¾‹</strong>ï¼Œç»Ÿä¸€é…ç½®ï¼š</p>
<ul>
<li><code>baseURL</code>ï¼šé¿å…åœ¨æ¯ä¸ªè¯·æ±‚ä¸­é‡å¤å†™åç«¯åœ°å€ï¼›</li>
<li><code>headers</code>ï¼šç¡®ä¿è¯·æ±‚ä½“ä¸º JSON æ ¼å¼ï¼›</li>
<li><code>timeout</code>ï¼šè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé˜²æ­¢è¯·æ±‚å¡æ­»ã€‚</li>
</ul>
<blockquote>
<p>â€œæ¨¡å—åŒ– åœ¨apiç›®å½•ä¸‹ç®¡ç†æ‰€æœ‰çš„è¯·æ±‚â€</p>
</blockquote>
<p>å°è£…äº†apiè¯·æ±‚ï¼Œåœ¨å…¶ä»–ç»„ä»¶(å¦‚ï¼šuseGitDiff.js)ä¸­åªéœ€è¦æ¨¡å—åŒ–å¯¼å…¥<code>chat</code> å³å¯ä»¥å‘èµ·è¯·æ±‚ï¼Œè¿™ç§ç»„ç»‡æ–¹å¼æ˜¯å¤§å‹ React é¡¹ç›®çš„æ ‡å‡†åšæ³•ï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•ã€‚</p>
<hr/>
<h3 data-id="heading-4">3. è‡ªå®šä¹‰ Hookï¼š<code>useGitDiff</code> â€”â€” å°è£…å‰¯ä½œç”¨ä¸çŠ¶æ€</h3>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// src/hooks/useGitDiff.js</span>
import { useState, useEffect } from "react"
import { chat } from "../api/axios"

export const useGitDiff = (diff) =&gt; {
  const <span class="hljs-selector-attr">[content, setContent]</span> = <span class="hljs-built_in">useState</span>('')
  const <span class="hljs-selector-attr">[loading, setLoading]</span> = <span class="hljs-built_in">useState</span>(false)

  <span class="hljs-built_in">useEffect</span>(() =&gt; {
    (async () =&gt; {
      <span class="hljs-built_in">if</span>(!diff) return 
      <span class="hljs-built_in">setLoading</span>(true)
      const { data } = await <span class="hljs-built_in">chat</span>(diff)
      <span class="hljs-built_in">setContent</span>(data.reply)
      <span class="hljs-built_in">setLoading</span>(false)
    })()
    <span class="hljs-comment">// ç«‹å³æ‰§è¡Œå¼‚æ­¥å‡½æ•°  é¿å…é¡¶å±‚async</span>
  }, <span class="hljs-selector-attr">[diff]</span>)

<span class="hljs-comment">// å°†å¤–éƒ¨éœ€è¦çš„loadingçŠ¶æ€å’Œcontentå†…å®¹ return</span>
  return {
    loading, <span class="hljs-comment">// åŠ è½½çŠ¶æ€ ç”¨æˆ·ä½“éªŒ</span>
    <span class="hljs-attribute">content</span> <span class="hljs-comment">// llmå¾—å‡ºçš„commit message</span>
  }
}
</code></pre>
<p>è¯¥ Hook æ¥æ”¶ <code>diff</code> å­—ç¬¦ä¸²ä½œä¸ºä¾èµ–ï¼Œå½“å…¶å˜åŒ–æ—¶è‡ªåŠ¨å‘èµ·è¯·æ±‚ã€‚å…³é”®ç‚¹åŒ…æ‹¬ï¼š</p>
<ul>
<li>ä½¿ç”¨ <strong>ç«‹å³æ‰§è¡Œå¼‚æ­¥å‡½æ•°ï¼ˆIIFEï¼‰</strong> åœ¨ <code>useEffect</code> ä¸­å¤„ç†å¼‚æ­¥é€»è¾‘ï¼›</li>
<li>é€šè¿‡ <code>setLoading</code> æä¾›åŠ è½½çŠ¶æ€åé¦ˆï¼›</li>
<li>ä¾èµ–æ•°ç»„ <code>[diff]</code> ç¡®ä¿åªåœ¨ <code>diff</code> å˜åŒ–æ—¶è§¦å‘è¯·æ±‚ï¼›</li>
<li>è¿”å›ç»“æ„åŒ–å¯¹è±¡ï¼Œä¾¿äºè§£æ„ä½¿ç”¨ã€‚</li>
</ul>
<blockquote>
<p>â€œé€šè¿‡ç«‹å³æ‰§è¡Œå‡½æ•° æ‰§è¡Œå¼‚æ­¥å‡½æ•°â€</p>
</blockquote>
<p>è¿™ç§å†™æ³•è§„é¿äº† <code>useEffect</code> çš„å›è°ƒå‡½æ•°ä¸èƒ½ç›´æ¥ä½¿ç”¨ <code>async/await</code> çš„é™åˆ¶ã€‚</p>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€åç«¯å®ç°ï¼šä»é›¶æ„å»ºä¸€ä¸ªå¥å£®çš„ Express AI æœåŠ¡</h2>
<p>åç«¯æ˜¯æ•´ä¸ª <code>git-differ</code> é¡¹ç›®çš„ä¸­æ¢ç¥ç»ã€‚å®ƒä¸ä»…è¦æ¥æ”¶å‰ç«¯è¯·æ±‚ã€è°ƒç”¨æœ¬åœ°å¤§æ¨¡å‹ï¼Œè¿˜éœ€ä¿è¯<strong>å®‰å…¨æ€§ã€ç¨³å®šæ€§ã€å¯ç»´æŠ¤æ€§ä¸åè®®è§„èŒƒæ€§</strong>ã€‚ä»¥ä¸‹æˆ‘ä»¬å°†ç»“åˆå®Œæ•´ä»£ç ï¼Œé€å±‚å‰–æå…¶æŠ€æœ¯å†…æ¶µã€‚</p>
<h3 data-id="heading-6">1. åŸºç¡€æœåŠ¡åˆå§‹åŒ–ï¼šExpress åº”ç”¨éª¨æ¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>
<span class="hljs-keyword">import</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">'cors'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>())
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>())

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'server is running on port 3000'</span>)
})
</code></pre>
<p>è¿™æ®µçœ‹ä¼¼ç®€å•çš„ä»£ç ï¼Œå®é™…ä¸Šå®Œæˆäº†ç°ä»£ Web API æœåŠ¡çš„ä¸‰å¤§åŸºç¡€é…ç½®ï¼š</p>
<h4 data-id="heading-7">âœ… <code>express()</code>ï¼šåˆ›å»ºåº”ç”¨å®ä¾‹</h4>
<ul>
<li>Express æ˜¯ Node.js ç”Ÿæ€ä¸­æœ€æµè¡Œçš„ Web æ¡†æ¶ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ <strong>â€œä¸­é—´ä»¶ç®¡é“â€</strong> ã€‚</li>
<li><code>app</code> æ˜¯ä¸€ä¸ªå¯é…ç½®ã€å¯æ‰©å±•çš„ HTTP æœåŠ¡å™¨å®¹å™¨ï¼Œåç»­æ‰€æœ‰è·¯ç”±ã€ä¸­é—´ä»¶éƒ½æŒ‚è½½äºæ­¤ã€‚</li>
</ul>
<h4 data-id="heading-8">âœ… <code>app.use(express.json())</code>ï¼šè¯·æ±‚ä½“è§£æä¸­é—´ä»¶</h4>
<ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼ŒExpress <strong>ä¸ä¼šè‡ªåŠ¨è§£æè¯·æ±‚ä½“</strong>ï¼ˆ<code>req.body</code> ä¸º <code>undefined</code>ï¼‰ã€‚</li>
<li><code>express.json()</code> æ˜¯ä¸€ä¸ªå†…ç½®ä¸­é—´ä»¶ï¼Œç”¨äºè§£æ <code>Content-Type: application/json</code> çš„è¯·æ±‚ä½“ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸º JavaScript å¯¹è±¡ã€‚</li>
<li>è‹¥çœç•¥æ­¤ä¸­é—´ä»¶ï¼Œ<code>req.body</code> å°†æ— æ³•è·å–å‰ç«¯å‘é€çš„ <code>{ message: "..." }</code> æ•°æ®ï¼Œå¯¼è‡´åç»­é€»è¾‘å¤±è´¥ã€‚</li>
</ul>
<blockquote>
<p>ğŸ’¡ <strong>æœ€ä½³å®è·µ</strong>ï¼šåº”åœ¨æ‰€æœ‰è·¯ç”±å®šä¹‰<strong>ä¹‹å‰</strong>æ³¨å†Œå…¨å±€ä¸­é—´ä»¶ï¼Œç¡®ä¿æ‰€æœ‰è¯·æ±‚éƒ½èƒ½è¢«æ­£ç¡®è§£æã€‚</p>
</blockquote>
<h4 data-id="heading-9">âœ… <code>app.use(cors())</code>ï¼šè·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰æ”¯æŒ</h4>
<ul>
<li>
<p>å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼ˆå¦‚ Viteï¼Œé»˜è®¤ç«¯å£ 5173ï¼‰ä¸åç«¯ï¼ˆ3000ï¼‰æ„æˆ<strong>è·¨åŸŸè¯·æ±‚</strong>ï¼ˆåè®®ã€åŸŸåæˆ–ç«¯å£ä¸åŒï¼‰ã€‚</p>
</li>
<li>
<p>æµè§ˆå™¨å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œä¼šæ‹¦æˆªè·¨åŸŸè¯·æ±‚çš„å“åº”ï¼Œé™¤éæœåŠ¡å™¨æ˜ç¡®å…è®¸ã€‚</p>
</li>
<li>
<p><code>cors()</code> ä¸­é—´ä»¶è‡ªåŠ¨å¤„ç† OPTIONS é¢„æ£€è¯·æ±‚ï¼Œå¹¶åœ¨å“åº”å¤´ä¸­æ·»åŠ ï¼š</p>
<pre><code class="hljs language-makefile" lang="makefile"><span class="hljs-section">Access-Control-Allow-Origin: *</span>
<span class="hljs-section">Access-Control-Allow-Methods: GET,HEAD,PUT,PATCH,POST,DELETE</span>
<span class="hljs-section">Access-Control-Allow-Headers: Content-Type</span>
</code></pre>
</li>
<li>
<p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåº”é™åˆ¶ <code>origin</code> ä¸ºå¯ä¿¡åŸŸåï¼ˆå¦‚ <code>origin: ['https://your-app.com']</code>ï¼‰ï¼Œé¿å…å¼€æ”¾å…¨ç«™è·¨åŸŸã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-10">2. è·¯ç”±è®¾è®¡ï¼šRESTful API ä¸ HTTP è¯­ä¹‰</h3>
<pre><code class="hljs language-dart" lang="dart">app.<span class="hljs-keyword">get</span>(<span class="hljs-string">'/hello'</span>, (req, res) =&gt; {
  res.send(<span class="hljs-string">'hello world'</span>)
})

app.post(<span class="hljs-string">'/chat'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-comment">// ... ä¸šåŠ¡é€»è¾‘</span>
})
</code></pre>
<h4 data-id="heading-11">ğŸ“Œ è·¯ç”±æ–¹æ³•ä¸èµ„æºæ“ä½œè¯­ä¹‰</h4>
<ul>
<li>
<p><code>GET /hello</code>ï¼šç”¨äºå¥åº·æ£€æŸ¥æˆ–ç®€å•æµ‹è¯•ï¼Œæ— å‰¯ä½œç”¨ï¼Œç¬¦åˆå¹‚ç­‰æ€§ã€‚</p>
</li>
<li>
<p><code>POST /chat</code>ï¼šç”¨äºæäº¤ <code>git diff</code> å†…å®¹å¹¶è·å– AI ç”Ÿæˆç»“æœã€‚ä½¿ç”¨ POST æ˜¯å› ä¸ºï¼š
è¯·æ±‚åŒ…å«<strong>å¤æ‚æ•°æ®ä½“</strong>ï¼ˆdiff æ–‡æœ¬å¯èƒ½å¾ˆé•¿ï¼‰ï¼›</p>
</li>
</ul>
<h4 data-id="heading-12">ğŸ“Œ è¯·æ±‚ä¸å“åº”å¯¹è±¡ï¼ˆ<code>req</code> / <code>res</code>ï¼‰</h4>
<ul>
<li><code>req.body</code>ï¼šç”± <code>express.json()</code> è§£æåçš„è¯·æ±‚ä½“æ•°æ®ï¼›</li>
<li><code>res.status(code).json(data)</code>ï¼šè®¾ç½® HTTP çŠ¶æ€ç å¹¶è¿”å› JSON å“åº”ï¼›</li>
<li><code>res.send()</code>ï¼šè¿”å›çº¯æ–‡æœ¬ï¼ˆä¸æ¨èç”¨äº APIï¼Œåº”ç»Ÿä¸€ä½¿ç”¨ JSONï¼‰ã€‚</li>
</ul>
<hr/>
<h3 data-id="heading-13">3. è¾“å…¥éªŒè¯ï¼šé˜²å¾¡æ€§ç¼–ç¨‹çš„ç¬¬ä¸€é“é˜²çº¿</h3>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-keyword">const</span> { message } = req.<span class="hljs-function">body
<span class="hljs-title">if</span> (<span class="hljs-params">!message || <span class="hljs-keyword">typeof</span> message !== <span class="hljs-string">'string'</span></span>)</span> {
  <span class="hljs-keyword">return</span> res.status(<span class="hljs-number">400</span>).json({
    error: <span class="hljs-string">'message å¿…å¡«ï¼Œå¿…é¡»æ˜¯å­—ç¬¦ä¸²'</span>
  })
}
</code></pre>
<ul>
<li>
<p><strong>æ°¸è¿œä¸è¦ä¿¡ä»»å®¢æˆ·ç«¯è¾“å…¥,åç«¯ç¨³å®šæ€§ æ˜¯ç¬¬ä¸€ä½</strong>ã€‚å³ä½¿å‰ç«¯åšäº†æ ¡éªŒï¼Œåç«¯ä¹Ÿå¿…é¡»äºŒæ¬¡éªŒè¯ã€‚</p>
</li>
<li>
<p>æ­¤å¤„æ£€æŸ¥ï¼š</p>
<ul>
<li><code>message</code> æ˜¯å¦å­˜åœ¨ï¼ˆé˜²æ­¢ <code>null</code>ã€<code>undefined</code>ï¼‰ï¼›</li>
<li>ç±»å‹æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ï¼ˆé˜²æ­¢ä¼ å…¥å¯¹è±¡ã€æ•°ç»„ç­‰éæ³•ç±»å‹ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p>è¿”å› <strong>400 Bad Request</strong> çŠ¶æ€ç ï¼Œæ˜ç¡®å‘ŠçŸ¥å®¢æˆ·ç«¯è¯·æ±‚æ ¼å¼é”™è¯¯ã€‚</p>
</li>
<li>
<p>é”™è¯¯ä¿¡æ¯æ¸…æ™°å…·ä½“ï¼Œä¾¿äºå‰ç«¯è°ƒè¯•ã€‚</p>
</li>
</ul>
<hr/>
<h3 data-id="heading-14">4. AI é›†æˆï¼šLangChain é“¾å¼è°ƒç”¨ä¸é”™è¯¯éš”ç¦»</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatOllama</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/ollama'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatPromptTemplate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/prompts'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StringOutputParser</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/core/output_parsers'</span>

<span class="hljs-keyword">const</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatOllama</span>({
  <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">'http://localhost:11434'</span>,
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-r1:8b'</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">0.1</span> <span class="hljs-comment">// </span>
})
</code></pre>
<h4 data-id="heading-15">ğŸ”— LangChain æ ¸å¿ƒæŠ½è±¡ï¼šé“¾ï¼ˆChainï¼‰</h4>
<p>LangChain çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°† LLM è°ƒç”¨è¿‡ç¨‹<strong>æ¨¡å—åŒ–ã€å¯ç»„åˆ</strong>ã€‚æœ¬é¡¹ç›®ä½¿ç”¨äº†å…¸å‹çš„ä¸‰æ®µå¼é“¾ï¼š</p>
<ol>
<li>
<p><strong>Prompt Template</strong>ï¼šç»“æ„åŒ–è¾“å…¥</p>
<pre><code class="hljs language-css" lang="css">const prompt = ChatPromptTemplate<span class="hljs-selector-class">.fromMessages</span>(<span class="hljs-selector-attr">[  [<span class="hljs-string">'system'</span>, `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ Git æäº¤ä¿¡æ¯ç”Ÿæˆå™¨ã€‚è¯·æ ¹æ®ä»¥ä¸‹ git diff å†…å®¹ï¼Œç”Ÿæˆä¸€æ¡ç®€æ´ã€ç¬¦åˆ Conventional Commits è§„èŒƒçš„ commit messageã€‚ä¸è¦è§£é‡Šï¼Œåªè¾“å‡º commit message`]</span>,
  <span class="hljs-selector-attr">[<span class="hljs-string">'human'</span>, <span class="hljs-string">'{input}'</span>]</span>
])
</code></pre>
<ul>
<li>å°†åŸå§‹ <code>message</code> æ³¨å…¥åˆ°é¢„è®¾å¯¹è¯æ¨¡æ¿ä¸­ï¼›</li>
<li>æ”¯æŒå¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡ï¼ˆæœªæ¥å¯æ‰©å±•ï¼‰ï¼›</li>
<li>ç¡®ä¿æç¤ºè¯æ ¼å¼ç¬¦åˆæ¨¡å‹é¢„æœŸã€‚</li>
</ul>
</li>
<li>
<p><strong>Model</strong>ï¼šå¤§æ¨¡å‹è°ƒç”¨</p>
<ul>
<li><code>ChatOllama</code> æ˜¯ LangChain å¯¹ Ollama API çš„å°è£…ï¼›</li>
<li><code>baseUrl</code> æŒ‡å‘æœ¬åœ° Ollama æœåŠ¡ï¼›</li>
<li><code>temperature: 0.1</code> é™ä½éšæœºæ€§ï¼Œä½¿è¾“å‡ºæ›´ç¡®å®šï¼ˆé€‚åˆç”Ÿæˆè§„èŒƒæ–‡æœ¬ï¼‰ã€‚</li>
</ul>
</li>
<li>
<p><strong>Output Parser</strong>ï¼šæ ‡å‡†åŒ–è¾“å‡º</p>
<pre><code class="hljs language-scss" lang="scss">new <span class="hljs-built_in">StringOutputParser</span>()
</code></pre>
<ul>
<li>å¼ºåˆ¶å°†æ¨¡å‹è¿”å›çš„å¤æ‚å¯¹è±¡ï¼ˆå¦‚ <code>{ content: "...", role: "assistant" }</code>ï¼‰è½¬æ¢ä¸ºçº¯å­—ç¬¦ä¸²ï¼›</li>
<li>é¿å…å‰ç«¯å¤„ç†ä¸å¿…è¦çš„å…ƒæ•°æ®ï¼›</li>
<li>ä¿è¯ API å“åº”ç»“æ„ç¨³å®šï¼š<code>{ reply: "string" }</code>ã€‚</li>
</ul>
</li>
</ol>
<h4 data-id="heading-16">âš ï¸ é”™è¯¯å¤„ç†ï¼šéš”ç¦» AI ä¸ç¨³å®šæ€§</h4>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">result</span> = await chain.<span class="hljs-title function_ invoke__">invoke</span>({ <span class="hljs-attr">input</span>: message })
  res.<span class="hljs-title function_ invoke__">json</span>({ <span class="hljs-attr">reply</span>: result })
} <span class="hljs-keyword">catch</span> (err) {
  res.<span class="hljs-title function_ invoke__">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_ invoke__">json</span>({ <span class="hljs-attr">error</span>: <span class="hljs-string">'è°ƒç”¨å¤§æ¨¡å‹å¤±è´¥'</span> })
}
</code></pre>
<ul>
<li>å¤§æ¨¡å‹è°ƒç”¨å¯èƒ½å› ç½‘ç»œã€å†…å­˜ã€æ¨¡å‹åŠ è½½å¤±è´¥ç­‰åŸå› æŠ›å‡ºå¼‚å¸¸ï¼›</li>
<li>ä½¿ç”¨ <code>try/catch</code> æ•è·æ‰€æœ‰åŒæ­¥/å¼‚æ­¥é”™è¯¯ï¼›</li>
<li>è¿”å› <strong>500 Internal Server Error</strong>ï¼Œé¿å…æœåŠ¡å´©æºƒï¼›</li>
</ul>
<hr/>
<h3 data-id="heading-17">5. å·¥ç¨‹åŒ–è€ƒé‡ï¼šå¯ç»´æŠ¤æ€§ä¸å¯è§‚æµ‹æ€§</h3>
<ul>
<li><strong>æ—¥å¿—è®°å½•</strong>ï¼š<code>console.log('æ­£åœ¨è°ƒç”¨å¤§æ¨¡å‹')</code> æä¾›åŸºæœ¬æ‰§è¡Œè¿½è¸ªï¼›</li>
<li><strong>è¶…æ—¶æ§åˆ¶</strong>ï¼šè™½æœªæ˜¾å¼è®¾ç½®ï¼Œä½† Ollama å®¢æˆ·ç«¯å’Œ Axios å‡æœ‰é»˜è®¤è¶…æ—¶ï¼›</li>
<li><strong>ä¾èµ–è§£è€¦</strong>ï¼šAI é€»è¾‘å°è£…åœ¨è·¯ç”±å†…ï¼Œæœªæ¥å¯æå–ä¸ºç‹¬ç«‹ service å±‚ï¼›</li>
</ul>
<hr/>
<h3 data-id="heading-18">æ€»ç»“ï¼šä¸€ä¸ªåˆæ ¼çš„åç«¯ API åº”å…·å¤‡ä»€ä¹ˆï¼Ÿ</h3>

































<table><thead><tr><th>ç»´åº¦</th><th>æœ¬é¡¹ç›®å®ç°</th></tr></thead><tbody><tr><td><strong>åè®®åˆè§„</strong></td><td>æ­£ç¡®ä½¿ç”¨ HTTP æ–¹æ³•ã€çŠ¶æ€ç ã€Content-Type</td></tr><tr><td><strong>è¾“å…¥å®‰å…¨</strong></td><td>ä¸¥æ ¼æ ¡éªŒè¯·æ±‚ä½“æ ¼å¼ä¸ç±»å‹</td></tr><tr><td><strong>é”™è¯¯å¤„ç†</strong></td><td>åŒºåˆ†å®¢æˆ·ç«¯é”™è¯¯ï¼ˆ4xxï¼‰ä¸æœåŠ¡ç«¯é”™è¯¯ï¼ˆ5xxï¼‰</td></tr><tr><td><strong>è·¨åŸŸæ”¯æŒ</strong></td><td>é€šè¿‡ CORS ä¸­é—´ä»¶è§£å†³å¼€å‘è·¨åŸŸé—®é¢˜</td></tr><tr><td><strong>AI é›†æˆ</strong></td><td>ä½¿ç”¨ LangChain å®ç°å¯ç»´æŠ¤çš„æç¤ºå·¥ç¨‹</td></tr><tr><td><strong>å¯æ‰©å±•æ€§</strong></td><td>æ¨¡å—åŒ–ç»“æ„ï¼Œä¾¿äºæœªæ¥å¢åŠ æ–°åŠŸèƒ½</td></tr></tbody></table>
<p>è¿™æ‰æ˜¯ä¸€ä¸ªé¢å‘ç”Ÿäº§ã€é¢å‘è¯»è€…çš„åç«¯å®ç°åº”æœ‰çš„æ·±åº¦ä¸å¹¿åº¦ã€‚</p>
<hr/>
<h2 data-id="heading-19">å››ã€AI éƒ¨åˆ†ï¼šOllama ä¸æœ¬åœ°å¤§æ¨¡å‹éƒ¨ç½²</h2>
<h3 data-id="heading-20">1. ä¸ºä»€ä¹ˆé€‰æ‹© Ollamaï¼Ÿ</h3>
<ul>
<li>å¼€æºã€è½»é‡ã€æ”¯æŒå¤šç§æ¨¡å‹ï¼ˆLlama,  DeepSeek ç­‰ï¼‰ï¼›</li>
<li>æä¾›ç±» OpenAI çš„ API æ¥å£ï¼ˆ<code>/api/chat</code>ï¼‰ï¼Œä¾¿äºé›†æˆï¼›</li>
<li>å¯åœ¨æ¶ˆè´¹çº§ GPU æˆ– CPU ä¸Šè¿è¡Œï¼ˆéœ€è¶³å¤Ÿå†…å­˜ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-21">2. æ¨¡å‹é€‰æ‹©ï¼š<code>deepseek-r1:8b</code></h3>
<ul>
<li>
<p><code>r1</code> è¡¨ç¤º Reasoning ç‰ˆæœ¬ï¼Œæ¨ç†èƒ½åŠ›æ›´å¼ºï¼›</p>
</li>
<li>
<p><code>8b</code> ä¸º 80 äº¿å‚æ•°ï¼Œå¹³è¡¡æ€§èƒ½ä¸èµ„æºæ¶ˆè€—ï¼›</p>
</li>
<li>
<p>éœ€é€šè¿‡å‘½ä»¤ä¸‹è½½ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">ollama pull deepseek-r1:<span class="hljs-number">8b</span>
ollama run deepseek-r1:<span class="hljs-number">8b</span>  # æµ‹è¯•
</code></pre>
</li>
</ul>
<blockquote>
<p>â€œollamaå¸®åŠ©æˆ‘ä»¬åƒopenaiä¸€æ ·çš„api æ¥å£ <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A11434%25E2%2580%259D%2F" target="_blank" title="http://localhost:11434%E2%80%9D/" ref="nofollow noopener noreferrer">http://localhost:11434â€</a></p>
</blockquote>
<h3 data-id="heading-22">3. æ€§èƒ½æç¤º</h3>
<ul>
<li>é¦–æ¬¡åŠ è½½æ¨¡å‹è¾ƒæ…¢ï¼ˆéœ€åŠ è½½åˆ°å†…å­˜ï¼‰ï¼›</li>
<li><code>temperature: 0.1</code> é™ä½éšæœºæ€§ï¼Œä½¿è¾“å‡ºæ›´ç¡®å®šã€è§„èŒƒï¼›</li>
<li>è‹¥å“åº”æ…¢ï¼Œå¯è€ƒè™‘é‡åŒ–ç‰ˆæœ¬ï¼ˆå¦‚ <code>q4_K_M</code>ï¼‰ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-23">äº”ã€æ€»ç»“</h2>
<p>é€šè¿‡ <code>git-differ</code> é¡¹ç›®ï¼Œæˆ‘ä»¬å®Œæ•´å®è·µäº†ä¸€ä¸ª <strong>AI å¢å¼ºå‹å¼€å‘è€…å·¥å…·</strong> çš„å…¨æ ˆå¼€å‘æµç¨‹ï¼š</p>
<ul>
<li>å‰ç«¯ï¼šReact è‡ªå®šä¹‰ Hook + Axios æ¨¡å—åŒ–ï¼›</li>
<li>åç«¯ï¼šExpress è·¯ç”± + CORS + é”™è¯¯å¤„ç†ï¼›</li>
<li>AIï¼šOllama + LangChain æç¤ºå·¥ç¨‹ + è¾“å‡ºè§£æã€‚</li>
</ul>
<p>è¿™ä¸ä»…è§£å†³äº†â€œå¦‚ä½•å†™å¥½ Git æäº¤ä¿¡æ¯â€çš„å®é™…é—®é¢˜ï¼Œæ›´å±•ç¤ºäº† <strong>æœ¬åœ°å¤§æ¨¡å‹åœ¨å¼€å‘è€…å·¥å…·é“¾ä¸­çš„è½åœ°åœºæ™¯</strong>ã€‚éšç€å¼€æºæ¨¡å‹èƒ½åŠ›ä¸æ–­æå‡ï¼Œç±»ä¼¼å·¥å…·å°†æå¤§æå‡ä¸ªäººä¸å›¢é˜Ÿçš„å¼€å‘æ•ˆç‡ä¸ä»£ç è´¨é‡ã€‚</p>
<blockquote>
<p>æœ€ç»ˆç›®æ ‡ï¼šè®©æ–°æ‰‹ä¹Ÿèƒ½åƒé«˜æ‰‹ä¸€æ ·ï¼Œå†™å‡ºæ¸…æ™°ã€è§„èŒƒã€æœ‰ä»·å€¼çš„ Git æäº¤è®°å½•ã€‚</p>
</blockquote>
<hr/>
<p>ç°åœ¨ï¼Œå¯åŠ¨ä½ çš„ AI Git åŠ©æ‰‹ï¼Œè®©æ¯ä¸€æ¬¡æäº¤éƒ½æˆä¸ºå·¥ç¨‹è‰ºæœ¯çš„ä¸€éƒ¨åˆ†ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯é¢è¯•å¿…é—® asyncawait åˆ°åº•è¦ä¸è¦åŠ  trycatch 90% äººè¸©å‘ æ±‚èŒåŠ åˆ†æŠ€å·§æ­ç§˜]]></title>    <link>https://juejin.cn/post/7593215107406610468</link>    <guid>https://juejin.cn/post/7593215107406610468</guid>    <pubDate>2026-01-10T08:56:11.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593215107406610468" data-draft-id="7593241698369945636" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯é¢è¯•å¿…é—® asyncawait åˆ°åº•è¦ä¸è¦åŠ  trycatch 90% äººè¸©å‘ æ±‚èŒåŠ åˆ†æŠ€å·§æ­ç§˜"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-10T08:56:11.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æµ·äº‘å‰ç«¯1"/> <meta itemprop="url" content="https://juejin.cn/user/963618991244365"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯é¢è¯•å¿…é—® asyncawait åˆ°åº•è¦ä¸è¦åŠ  trycatch 90% äººè¸©å‘ æ±‚èŒåŠ åˆ†æŠ€å·§æ­ç§˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/963618991244365/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æµ·äº‘å‰ç«¯1
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T08:56:11.000Z" title="Sat Jan 10 2026 08:56:11 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»7åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>ç°åœ¨å†™å‰ç«¯å¼‚æ­¥ä»£ç  åŸºæœ¬ç¦»ä¸å¼€ Promise å’Œ asyncawait</strong></p>
<p>ç›¸æ¯”ä¹‹ä¸‹ asyncawait å†™èµ·æ¥æ›´åƒåŒæ­¥ä»£ç  è¯»èµ·æ¥æ›´é¡ºç•… è¢«å¾ˆå¤šå¼€å‘è€…ç§°ä¸ºå¼‚æ­¥ç¼–ç¨‹çš„ç»ˆææ–¹æ¡ˆ</p>
<p><strong>ä½†æœ‰ä¸ªè®©æ–°æ‰‹çº ç»“ä¸å·²çš„é—®é¢˜ ç”¨ asyncawait æ—¶åˆ°åº•è¦ä¸è¦åŠ  trycatch æ•è·é”™è¯¯</strong></p>
<p>çœ‹äº†ä¸å°‘é¡¹ç›®ä»£ç  æœ‰äººå…¨ç¨‹åŠ æœ‰äººå®Œå…¨ä¸åŠ  è¿˜æœ‰äººç”¨ catch é“¾å¼è°ƒç”¨ å„ç§å†™æ³•è®©äººçœ¼èŠ±ç¼­ä¹± æ›´å…³é”®çš„æ˜¯ è¿™ä¹Ÿæ˜¯å‰ç«¯é¢è¯•é«˜é¢‘è€ƒç‚¹ å¾ˆå¤šæ±‚èŒè€…å› ä¸ºè¯´ä¸æ¸…æ¥šå…¶ä¸­é€»è¾‘ ç›´æ¥é”™å¤± offer</p>
<p>ä»Šå¤©è¿™ç¯‡æ–‡ç«  ä¸å…‰æŠŠä¸‰ç§å¸¸è§å†™æ³•æ‹†è§£å¾—æ˜æ˜ç™½ç™½ å‘Šè¯‰ä½ ä¸åŒåœºæ™¯è¯¥æ€ä¹ˆé€‰ è¿˜ä¼šæ­ç§˜é¢è¯•å®˜è€ƒå¯Ÿè¿™ä¸ªé—®é¢˜çš„æ ¸å¿ƒé€»è¾‘</p>
<h2 data-id="heading-0">ä¸€ ä¸‰ç§å¸¸è§å†™æ³• ä¼˜ç¼ºç‚¹ä¸€çœ¼çœ‹æ¸…</h2>
<p>å…ˆçœ‹æœ€å¸¸ç”¨çš„ä¸‰ç§å†™æ³• å„è‡ªçš„é€‚ç”¨åœºæ™¯å’Œå‘éƒ½ç»™ä½ åˆ—å¥½äº† é¢è¯•æ—¶ç›´æ¥ä¸¾ä¾‹å°±èƒ½åŠ åˆ†</p>
<h3 data-id="heading-1">1 ç¨³å¦¥å†™æ³• trycatch åŒ…è£¹</h3>
<p>è¿™æ˜¯æœ€è§„èŒƒçš„å†™æ³• æŠŠ await è°ƒç”¨çš„å¼‚æ­¥ä»£ç æ”¾åœ¨ try å—é‡Œ é”™è¯¯ç»Ÿä¸€åœ¨ catch é‡Œå¤„ç†</p>
<p>javascript</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span> () {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">reject</span>(è¯·æ±‚å‡ºé”™äº†å“¦)
        }, <span class="hljs-number">1000</span>)
    })
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">logined</span> () {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">let</span> userInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>()
        <span class="hljs-comment">// ä¸€æ—¦ä¸Šé¢å‡ºé”™ ä¸‹é¢ä»£ç ä¸ä¼šæ‰§è¡Œ</span>
        <span class="hljs-keyword">let</span> pageInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getPageInfo</span>(userInfo?.<span class="hljs-property">userId</span>)
    } <span class="hljs-keyword">catch</span>(e) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(æŠ“åˆ°ä¸€ä¸ªé”™è¯¯, e)
    }
}

<span class="hljs-title function_">logined</span>()
</code></pre>
<p>ä¼˜ç‚¹å¾ˆæ˜æ˜¾ é”™è¯¯èƒ½ç²¾å‡†æ•è· è€Œä¸”ä»£ç ä¼šåœ¨å‡ºé”™ä½ç½®ç›´æ¥åœæ­¢ ä¸ä¼šå¼•å‘åç»­è¿é”é—®é¢˜ ç¼ºç‚¹å°±æ˜¯çœ‹èµ·æ¥æœ‰ç‚¹å•°å—¦ æ¯ä¸ªå¼‚æ­¥é€»è¾‘éƒ½è¿™ä¹ˆå†™ ä¼šå¤šå‡ è¡Œä»£ç </p>
<h3 data-id="heading-2">2 ç®€æ´å†™æ³• ç›´æ¥æ¥ catch é“¾å¼è°ƒç”¨</h3>
<p>ä¸æƒ³å†™ trycatch çš„è¯ å¯ä»¥åœ¨ await åé¢ç›´æ¥åŠ  catch æ–¹æ³• æ•è·å½“å‰å¼‚æ­¥æ“ä½œçš„é”™è¯¯</p>
<p>javascript</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span> () {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">reject</span>(è¯·æ±‚å‡ºé”™äº†å“¦)
        }, <span class="hljs-number">1000</span>)
    })
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">logined</span> () {
    <span class="hljs-keyword">let</span> userInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(æŠ“åˆ°ä¸€ä¸ªé”™è¯¯, e))
    <span class="hljs-comment">// æ³¨æ„ å‡ºé”™åä»£ç è¿˜ä¼šç»§ç»­æ‰§è¡Œ</span>
    <span class="hljs-keyword">if</span> (!userInfo) <span class="hljs-keyword">return</span> <span class="hljs-comment">// å¿…é¡»æ‰‹åŠ¨åˆ¤æ–­æ˜¯å¦è·å–æˆåŠŸ</span>
    <span class="hljs-keyword">let</span> pageInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getPageInfo</span>(userInfo?.<span class="hljs-property">userId</span>)
}

<span class="hljs-title function_">logined</span>()
</code></pre>
<p>è¿™ç§å†™æ³•æ›´ç®€æ´ ä¸ç”¨é¢å¤–åŒ…è£¹ä»£ç  ä½†æœ‰ä¸ªå…³é”®å‘ å³ä½¿å‰é¢å¼‚æ­¥æ“ä½œå¤±è´¥ ç¨‹åºä¹Ÿä¸ä¼šè‡ªåŠ¨åœæ­¢ ä¼šç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç  æ‰€ä»¥å¿…é¡»æ‰‹åŠ¨æ£€æŸ¥è¿”å›å€¼æ˜¯å¦æœ‰æ•ˆ å¦åˆ™å¯èƒ½å‡ºç°ç©ºå€¼æŠ¥é”™</p>
<h3 data-id="heading-3">3 ä¸­æ–­å†™æ³• catch é‡ŒäºŒæ¬¡ reject</h3>
<p>æƒ³è®©ç¨‹åºå‡ºé”™ååœæ­¢ åˆä¸æƒ³ç”¨ trycatch å¯ä»¥åœ¨ catch é‡ŒæŠŠé”™è¯¯å†æ¬¡ reject å‡ºå»</p>
<p>javascript</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserInfo</span> () {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
            <span class="hljs-title function_">reject</span>(è¯·æ±‚å‡ºé”™äº†å“¦)
        }, <span class="hljs-number">1000</span>)
    })
}

<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">logined</span> () {
    <span class="hljs-keyword">let</span> userInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserInfo</span>().<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(æŠ“åˆ°ä¸€ä¸ªé”™è¯¯, e)
        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(e) <span class="hljs-comment">// å†æ¬¡æŠ›å‡ºé”™è¯¯</span>
    })
    <span class="hljs-comment">// ä»£ç ä¼šåœ¨è¿™é‡Œåœæ­¢ ä¸å†å¾€ä¸‹æ‰§è¡Œ</span>
    <span class="hljs-keyword">let</span> pageInfo = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getPageInfo</span>(userInfo?.<span class="hljs-property">userId</span>)
}

<span class="hljs-title function_">logined</span>()
</code></pre>
<p>è¿™ç§å†™æ³•èƒ½å®ç°é”™è¯¯ä¸­æ–­çš„æ•ˆæœ ä½†æœ‰ä¸ªå°é—®é¢˜ æ§åˆ¶å°ä¼šå‡ºç° uncaught in promise çš„é”™è¯¯æç¤º è™½ç„¶ä¸å½±å“åŠŸèƒ½ ä½†æ˜¾å¾—ä¸å¤Ÿè§„èŒƒ é¢è¯•æ—¶è¦èƒ½è¯´æ¸…è¿™ä¸ªç»†èŠ‚</p>
<h2 data-id="heading-4">äºŒ æ ¸å¿ƒåˆ¤æ–­é€»è¾‘ åˆ°åº•è¯¥æ€ä¹ˆé€‰</h2>
<p>å…¶å®çœŸå®é¡¹ç›®ä¸­ æˆ‘ä»¬å¾ˆå°‘ç›´æ¥ç”¨åŸç”Ÿ Promise å‘è¯·æ±‚ å¤§å¤šä¼šç”¨ axios æˆ– fetch è€Œä¸”é€šå¸¸ä¼šå¯¹è¿™äº›è¯·æ±‚åº“åšä¸€å±‚å°è£… ç»Ÿä¸€å¤„ç†é”™è¯¯çŠ¶æ€ç  è¶…æ—¶æç¤ºç­‰</p>
<p>è‡³äº await åé¢è¦ä¸è¦åŠ  trycatch æ ¸å¿ƒåˆ¤æ–­æ ‡å‡†å°±ä¸€ä¸ª ä½ æ˜¯å¦æƒ³è®©ç¨‹åºåœ¨å‡ºé”™æ—¶åœæ­¢æ‰§è¡Œ</p>
<h3 data-id="heading-5">åœºæ™¯ 1 ä¸æƒ³ä¸­æ–­ç¨‹åº å…è®¸åç»­é€»è¾‘ç»§ç»­æ‰§è¡Œ</h3>
<p>æ¯”å¦‚è·å–éæ ¸å¿ƒæ•°æ® å³ä½¿å¤±è´¥ä¹Ÿä¸å½±å“é¡µé¢ä¸»è¦åŠŸèƒ½ å¯ä»¥ç”¨ catch é“¾å¼è°ƒç”¨ å†æ‰‹åŠ¨åˆ¤æ–­è¿”å›å€¼</p>
<p>javascript</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-scss" lang="scss">let userInfo = await <span class="hljs-built_in">getUserInfo</span>()<span class="hljs-selector-class">.catch</span>(e =&gt; console.warn(e))
if (!userInfo) return <span class="hljs-comment">// ç»ˆæ­¢å½“å‰å‡½æ•° ä½†ä¸å½±å“å…¶ä»–ä»£ç </span>
<span class="hljs-comment">// åç»­éä¾èµ–é€»è¾‘å¯ä»¥ç»§ç»­æ‰§è¡Œ</span>
<span class="hljs-built_in">renderDefaultInfo</span>()
</code></pre>
<p>è¿™ç§å†™æ³•æ§åˆ¶å°ä¸ä¼šå‡ºç°çº¢å­—é”™è¯¯ ç”¨æˆ·ä½“éªŒæ›´å‹å¥½</p>
<h3 data-id="heading-6">åœºæ™¯ 2 æƒ³ä¸­æ–­ç¨‹åº é¿å…é”™è¯¯æ‰©æ•£</h3>
<p>æ¯”å¦‚ç™»å½•è¯·æ±‚ å¿…é¡»è·å–ç”¨æˆ·ä¿¡æ¯åæ‰èƒ½ç»§ç»­ ä¸€æ—¦å¤±è´¥å°±è¯¥åœæ­¢åç»­æ“ä½œ è¿™æ—¶ trycatch æ˜¯æœ€ä½³é€‰æ‹©</p>
<p>javascript</p>
<p>è¿è¡Œ</p>
<pre><code class="hljs language-scss" lang="scss">try {
    let userInfo = await <span class="hljs-built_in">getUserInfo</span>()
    let pageInfo = await <span class="hljs-built_in">getPageInfo</span>(userInfo?.userId)
    <span class="hljs-comment">// ä¾èµ–ç”¨æˆ·ä¿¡æ¯çš„æ ¸å¿ƒé€»è¾‘</span>
} <span class="hljs-built_in">catch</span>(e) {
    console<span class="hljs-selector-class">.warn</span>(e)
    <span class="hljs-comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é”™è¯¯æç¤º æ¯”å¦‚å¼¹çª—å‘ŠçŸ¥ç”¨æˆ·</span>
    <span class="hljs-built_in">showErrorToast</span>(è·å–ä¿¡æ¯å¤±è´¥ è¯·é‡è¯•)
}
</code></pre>
<p>é”™è¯¯å¤„ç†é›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ ä¾¿äºç®¡ç†å’Œç»´æŠ¤ ä»£ç é€»è¾‘ä¹Ÿæ›´æ¸…æ™°</p>
<h3 data-id="heading-7">åœºæ™¯ 3 æƒ³ä¸­æ–­ç¨‹åº ä¸ä»‹æ„æ§åˆ¶å°æŠ¥é”™</h3>
<p>å¦‚æœæ˜¯å†…éƒ¨å·¥å…·ç±»æˆ–éç”¨æˆ· - facing çš„åŠŸèƒ½ å¯ä»¥ç”¨ catch äºŒæ¬¡ reject çš„å†™æ³• è™½ç„¶æ§åˆ¶å°ä¼šæœ‰æŠ¥é”™æç¤º ä½†èƒ½å¿«é€Ÿå®šä½é—®é¢˜ ä¸è¿‡è¿™ç§å†™æ³•åœ¨é¢è¯•ä¸­ä¸æ¨èä½œä¸ºé¦–é€‰ é™¤éèƒ½è¯´æ¸…é€‚ç”¨åœºæ™¯å’Œä¼˜ç¼ºç‚¹</p>
<h2 data-id="heading-8">ä¸‰ é¢è¯•åŠ åˆ†å»ºè®® æ¨èè¿™æ ·å†™</h2>
<p>ç»“åˆé¡¹ç›®å®æ“å’Œé¢è¯•å¾—åˆ†ç‚¹ ä¸ªäººæœ€æ¨è trycatch çš„å†™æ³• åŸå› æœ‰å››ç‚¹1 ä»£ç é€»è¾‘æ›´æ¸…æ™° ç¬¦åˆåŒæ­¥ä»£ç çš„ç›´è§‰ å‡ºé”™å°±åœæ­¢ å®¹æ˜“ç†è§£å’Œç»´æŠ¤2 é”™è¯¯å¤„ç†é›†ä¸­ æ‰€æœ‰å¼‚å¸¸éƒ½åœ¨ catch å—é‡Œç»Ÿä¸€å¤„ç† ä¸ç”¨åˆ†æ•£åœ¨å„ä¸ªé“¾å¼è°ƒç”¨ä¸­3 æ§åˆ¶å°ä¸ä¼šå‡ºç°å¤šä½™çš„ uncaught é”™è¯¯æç¤º ä»£ç æ›´è§„èŒƒ æ˜¾å¾—ä¸“ä¸š4 é£æ ¼ç»Ÿä¸€ æ—¢ç„¶ç”¨ asyncawait è¿½æ±‚åŒæ­¥å†™æ³•çš„ç®€æ´ æ­é… trycatch èƒ½ä¿æŒä»£ç é£æ ¼ä¸€è‡´</p>
<p>è™½ç„¶å¤šäº†å‡ è¡Œä»£ç  ä½†æ¯”èµ·å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ è¿™ç‚¹ä»£ä»·å®Œå…¨å€¼å¾— é¢è¯•æ—¶è¯´æ¸…è¿™ä¸ªæƒè¡¡æ€è·¯ èƒ½ä½“ç°ä½ çš„å·¥ç¨‹åŒ–æ€ç»´</p>
<h2 data-id="heading-9">å›› é¢è¯•å®˜çœŸæ­£æƒ³è€ƒçš„ ä¸åªæ˜¯å†™æ³•</h2>
<p>è¿™é“é¢˜è¡¨é¢è€ƒé”™è¯¯å¤„ç†å†™æ³• å®é™…è€ƒå¯Ÿä¸‰ä¸ªæ ¸å¿ƒèƒ½åŠ› é¢è¯•æ—¶è¦é’ˆå¯¹æ€§å›åº”1 å¯¹å¼‚æ­¥ç¼–ç¨‹åŸç†çš„ç†è§£ æ˜¯å¦æ¸…æ¥š Promise å’Œ asyncawait çš„é”™è¯¯ä¼ é€’æœºåˆ¶2 åœºæ™¯åŒ–æ€ç»´ æ˜¯å¦èƒ½æ ¹æ®ä¸åŒä¸šåŠ¡åœºæ™¯é€‰æ‹©åˆé€‚çš„é”™è¯¯å¤„ç†æ–¹å¼3 ä»£ç è§„èŒƒå’Œå¯ç»´æŠ¤æ€§æ„è¯† æ˜¯å¦è€ƒè™‘åˆ°åç»­å¼€å‘å’Œæ’æŸ¥é—®é¢˜çš„ä¾¿æ·æ€§</p>
<p>é¢è¯•æ—¶å¯ä»¥æŒ‰è¿™ä¸ªé€»è¾‘ç»„ç»‡è¯­è¨€ å…ˆè¯´æ˜ä¸‰ç§å†™æ³•çš„åŒºåˆ« å†è®²æ ¸å¿ƒåˆ¤æ–­æ ‡å‡† æœ€åç»™å‡ºæ¨èæ–¹æ¡ˆå’Œç†ç”± æ¯”å¦‚asyncawait çš„é”™è¯¯å¤„ç†æœ‰ä¸‰ç§å¸¸è§æ–¹å¼ åˆ†åˆ«æ˜¯ trycatch åŒ…è£¹ catch é“¾å¼è°ƒç”¨ ä»¥åŠ catch ä¸­äºŒæ¬¡ reject é€‰æ‹©å“ªç§ä¸»è¦çœ‹æ˜¯å¦éœ€è¦ä¸­æ–­ç¨‹åº æ ¸å¿ƒä¸šåŠ¡æ¯”å¦‚ç™»å½• å¿…é¡»è·å–ç»“æœåæ‰èƒ½ç»§ç»­ æ¨èç”¨ trycatch èƒ½é›†ä¸­å¤„ç†é”™è¯¯å¹¶é¿å…æ‰©æ•£ éæ ¸å¿ƒä¸šåŠ¡æ¯”å¦‚è·å–æ¨èåˆ—è¡¨ å¯ä»¥ç”¨ catch é“¾å¼è°ƒç”¨ ä¸ä¸­æ–­åç»­é€»è¾‘ ä¸ªäººæ›´æ¨è trycatch å› ä¸ºä»£ç è§„èŒƒ é”™è¯¯å¤„ç†é›†ä¸­ æ›´åˆ©äºç»´æŠ¤</p>
<p>è¿™æ ·å›ç­” æ—¢å±•ç¤ºäº†æŠ€æœ¯åŠŸåº• åˆä½“ç°äº†åœºæ™¯åŒ–æ€ç»´ é¢è¯•å®˜ä¼šè§‰å¾—ä½ ä¸ä»…ä¼šå†™ä»£ç  è¿˜æ‡‚æ€ä¹ˆå†™å¥½ä»£ç </p>
<h2 data-id="heading-10">äº” æ±‚èŒç¦åˆ© è¿™é“é¢˜ç­”å¥½ offer ç¨³ä¸€åŠ</h2>
<p>å¾ˆå¤šå‰ç«¯æ±‚èŒè€…æŠ€æœ¯ä¸é”™ å´æ ½åœ¨è¿™ç§åŸºç¡€è€ƒç‚¹ä¸Š ä¸æ˜¯ä¸ä¼šå†™ è€Œæ˜¯ä¸ä¼šæç‚¼æ ¸å¿ƒé€»è¾‘ ä¸ä¼šç»“åˆé¢è¯•åœºæ™¯ç»„ç»‡è¯­è¨€ æ›´ä¸çŸ¥é“æ€ä¹ˆæŠŠé¡¹ç›®ç»éªŒè½¬åŒ–ä¸ºé¢è¯•åŠ åˆ†é¡¹</p>
<p>ä½œä¸ºä¸“æ³¨å‰ç«¯ç®€å†é¢è¯•è¾…å¯¼å’Œæ±‚èŒé™ªè·‘çš„å¯¼å¸ˆ æˆ‘è§è¿‡å¤ªå¤šç±»ä¼¼æ¡ˆä¾‹ æœ‰äººèƒ½ç†Ÿç»ƒä½¿ç”¨ trycatch å¤„ç†é”™è¯¯ å´è®²ä¸æ¸…é€‚ç”¨åœºæ™¯ æœ‰äººé¡¹ç›®é‡Œè¸©è¿‡å¼‚æ­¥é”™è¯¯çš„å‘ å´ä¸çŸ¥é“æ€ä¹ˆåœ¨é¢è¯•ä¸­è¡¨è¾¾ è¿˜æœ‰äººç®€å†é‡Œåªå†™ä¼šç”¨ asyncawait æ²¡è¯´æ¸…é”™è¯¯å¤„ç†çš„æœ€ä½³å®è·µ è‡ªç„¶å¸å¼•ä¸äº†é¢è¯•å®˜</p>
<p>å¦‚æœä½ ä¹Ÿé¢ä¸´è¿™äº›å›°æ‰°</p>
<ul>
<li>é¢è¯•æ—¶è®²ä¸æ¸…æŠ€æœ¯ç»†èŠ‚ ä¸ä¼šç»“åˆåœºæ™¯ä¸¾ä¾‹</li>
<li>ç®€å†é‡Œçš„æŠ€æœ¯äº®ç‚¹æ²¡çªå‡º æŠ•é€’åçŸ³æ²‰å¤§æµ·</li>
<li>é‡åˆ°æ·±åº¦è¿½é—®å°±æ…Œ ä¸çŸ¥é“æ€ä¹ˆå±•ç°å®åŠ›</li>
<li>æƒ³è¿›å¤§å‚ å´æ‘¸ä¸é€é¢è¯•è€ƒå¯Ÿé‡ç‚¹</li>
</ul>
<p>ç°åœ¨æœºä¼šæ¥äº† æˆ‘çš„å‰ç«¯ç®€å†é¢è¯•è¾…å¯¼åŠ æ±‚èŒé™ªè·‘è®¡åˆ’ ä¸“ä¸ºå‰ç«¯æ±‚èŒè€…é‡èº«æ‰“é€ </p>
<p>âœ… 1v1 ç®€å†ä¼˜åŒ– æŒ–æ˜ä½ é¡¹ç›®ä¸­çš„å¼‚æ­¥ç¼–ç¨‹ é”™è¯¯å¤„ç†ç­‰å®è·µ æŠŠæŠ€æœ¯äº®ç‚¹è½¬åŒ–ä¸ºé¢è¯•åŠ åˆ†é¡¹ è®© HR ä¸€çœ¼çœ‹ä¸­</p>
<p>âœ… æ¨¡æ‹Ÿé¢è¯•å®æˆ˜ è¿˜åŸå¤§å‚é¢è¯•åœºæ™¯ é’ˆå¯¹æ€§è®­ç»ƒ asyncawait æ€§èƒ½ä¼˜åŒ– è·¨åŸŸç­‰é«˜é¢‘é¢˜ æ•™ä½ è¯´å‡ºé¢è¯•å®˜æƒ³å¬çš„ç­”æ¡ˆ</p>
<p>âœ… æŠ€æœ¯ç­”ç–‘åŠ æ±‚èŒè§„åˆ’ ä»åŸºç¡€åˆ°è¿›é˜¶è§£å†³ä½ çš„æŠ€æœ¯ç—›ç‚¹ å¸®ä½ é¿å¼€æ±‚èŒé™·é˜± ç²¾å‡†åŒ¹é…ç›®æ ‡å…¬å¸</p>
<p>âœ… ç‹¬å®¶èµ„æ–™æ”¾é€ æ•´ç† 100 + å‰ç«¯é«˜é¢‘é¢è¯•é¢˜ åŒ…å«å¼‚æ­¥ç¼–ç¨‹ æ¡†æ¶ å®‰å…¨ç­‰æ ¸å¿ƒçŸ¥è¯†ç‚¹ é™„ç­”æ¡ˆè§£æå’Œå®æ“åœºæ™¯ è®©ä½ é¢è¯•ä¸æ…Œ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[JSåˆ¤æ–­ç©ºå€¼åªçŸ¥é“â€œ||â€ï¼Ÿä¸å¦‚æ¥è¯•è¯•è¿™ä¸ªæ“ä½œç¬¦]]></title>    <link>https://juejin.cn/post/7593198957984612393</link>    <guid>https://juejin.cn/post/7593198957984612393</guid>    <pubDate>2026-01-10T09:25:04.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593198957984612393" data-draft-id="7593145583349268522" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="JSåˆ¤æ–­ç©ºå€¼åªçŸ¥é“â€œ||â€ï¼Ÿä¸å¦‚æ¥è¯•è¯•è¿™ä¸ªæ“ä½œç¬¦"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-10T09:25:04.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·3905133219288"/> <meta itemprop="url" content="https://juejin.cn/user/3609051079121550"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            JSåˆ¤æ–­ç©ºå€¼åªçŸ¥é“â€œ||â€ï¼Ÿä¸å¦‚æ¥è¯•è¯•è¿™ä¸ªæ“ä½œç¬¦
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3609051079121550/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·3905133219288
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T09:25:04.000Z" title="Sat Jan 10 2026 09:25:04 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä»Šå¤©æˆ‘ä»¬æ¥èŠä¸€ä¸ªJavaScripté‡Œéå¸¸å®ç”¨çš„è¯­æ³•ï¼š<strong>ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦</strong>ã€‚å®ƒçš„å†™æ³•æ˜¯ä¸¤ä¸ªé—®å·ï¼š<code>??</code>ã€‚</p>
<p>è¿™ä¸ªä¸œè¥¿æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿç®€å•è¯´ï¼Œå®ƒå¸®ä½ å¤„ç†é‚£äº›â€œå¯èƒ½æœ‰å€¼ï¼Œä¹Ÿå¯èƒ½æ˜¯<code>null</code>æˆ–<code>undefined</code>â€çš„æƒ…å†µã€‚</p>
<h2 data-id="heading-0"><code>??</code>Â è¿ç®—ç¬¦æ€ä¹ˆç”¨</h2>
<p>ç©ºå€¼åˆå¹¶è¿ç®—ç¬¦çš„ç”¨æ³•å¾ˆç®€å•ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">letÂ <span class="hljs-attr">result</span> = å·¦ä¾§å€¼ ?? å³ä¾§å€¼<span class="hljs-comment">;</span>
</code></pre>
<p>å®ƒçš„è§„åˆ™æ˜¯ï¼š</p>
<p>â€¢ å¦‚æœ<strong>å·¦ä¾§å€¼</strong>ä¸æ˜¯<code>null</code>ä¹Ÿä¸æ˜¯<code>undefined</code>ï¼Œå°±è¿”å›å·¦ä¾§å€¼</p>
<p>â€¢ å¦‚æœ<strong>å·¦ä¾§å€¼</strong>æ˜¯<code>null</code>æˆ–<code>undefined</code>ï¼Œå°±è¿”å›å³ä¾§å€¼</p>
<p>ç”¨è¿™ä¸ªè¿ç®—ç¬¦é‡å†™ä¸Šé¢çš„ä¾‹å­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">letÂ <span class="hljs-attr">user</span> = {
Â  name:Â null
}<span class="hljs-comment">;</span>

letÂ <span class="hljs-attr">displayName</span> = user.nameÂ ??Â <span class="hljs-string">"æ¸¸å®¢"</span><span class="hljs-comment">;</span>

console.log(displayName)<span class="hljs-comment">;Â // è¾“å‡ºï¼šæ¸¸å®¢</span>
</code></pre>
<p>ä¸€è¡Œä»£ç å°±æå®šäº†ï¼æ˜¯ä¸æ˜¯å¾ˆç®€æ´ï¼Ÿ</p>
<h2 data-id="heading-1">å’ŒÂ <code>||</code>Â è¿ç®—ç¬¦çš„åŒºåˆ«</h2>
<p>ä½ å¯èƒ½ç”¨è¿‡<code>||</code>ï¼ˆé€»è¾‘æˆ–ï¼‰è¿ç®—ç¬¦æ¥è®¾ç½®é»˜è®¤å€¼ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">letÂ <span class="hljs-attr">value</span> = someValue ||Â <span class="hljs-string">"é»˜è®¤å€¼"</span><span class="hljs-comment">;</span>
</code></pre>
<p><code>||</code>å’Œ<code>??</code>å¾ˆåƒï¼Œä½†æœ‰ä¸€ä¸ªé‡è¦åŒºåˆ«ï¼š</p>
<p>â€¢Â <code>||</code>Â ä¼šåœ¨å·¦ä¾§å€¼ä¸ºÂ <strong>å‡å€¼</strong>Â æ—¶è¿”å›å³ä¾§å€¼
â€¢Â <code>??</code>Â åªåœ¨å·¦ä¾§å€¼ä¸ºÂ <strong>nullæˆ–undefined</strong>Â æ—¶è¿”å›å³ä¾§å€¼</p>
<p>JavaScriptä¸­çš„å‡å€¼åŒ…æ‹¬ï¼š</p>
<p>â€¢Â <code>false</code></p>
<p>â€¢Â <code>0</code></p>
<p>â€¢Â <code>""</code>ï¼ˆç©ºå­—ç¬¦ä¸²ï¼‰</p>
<p>â€¢Â <code>null</code></p>
<p>â€¢Â <code>undefined</code></p>
<p>â€¢Â <code>NaN</code></p>
<p>çœ‹ä¸€ä¸ªå¯¹æ¯”ä¾‹å­ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">letÂ <span class="hljs-attr">count</span> =Â <span class="hljs-number">0</span><span class="hljs-comment">;</span>
letÂ <span class="hljs-attr">price</span> =Â <span class="hljs-string">""</span><span class="hljs-comment">;</span>

// ä½¿ç”¨ ||
letÂ <span class="hljs-attr">result1</span> = count ||Â <span class="hljs-number">10</span><span class="hljs-comment">;Â  // è¾“å‡ºï¼š10ï¼ˆ0æ˜¯å‡å€¼ï¼‰</span>
letÂ <span class="hljs-attr">result2</span> = price ||Â <span class="hljs-string">"æœªçŸ¥"</span><span class="hljs-comment">;Â  // è¾“å‡ºï¼š"æœªçŸ¥"ï¼ˆç©ºå­—ç¬¦ä¸²æ˜¯å‡å€¼ï¼‰</span>

// ä½¿ç”¨ ??
letÂ <span class="hljs-attr">result3</span> = count ??Â <span class="hljs-number">10</span><span class="hljs-comment">;Â  // è¾“å‡ºï¼š0ï¼ˆ0ä¸æ˜¯nullæˆ–undefinedï¼‰</span>
letÂ <span class="hljs-attr">result4</span> = price ??Â <span class="hljs-string">"æœªçŸ¥"</span><span class="hljs-comment">;Â  // è¾“å‡ºï¼š""ï¼ˆç©ºå­—ç¬¦ä¸²ä¸æ˜¯nullæˆ–undefinedï¼‰</span>
</code></pre>
<p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœä½ å¸Œæœ›<code>0</code>ã€<code>false</code>ã€<code>""</code>è¿™äº›å€¼è¢«ä¿ç•™ï¼Œå°±ç”¨<code>??</code>ã€‚å¦‚æœä½ å¸Œæœ›æ‰€æœ‰å‡å€¼éƒ½ç”¨é»˜è®¤å€¼æ›¿æ¢ï¼Œå°±ç”¨<code>||</code>ã€‚</p>
<h4 data-id="heading-2">å®é™…åœºæ™¯</h4>
<h3 data-id="heading-3">åœºæ™¯1ï¼šå‡½æ•°å‚æ•°é»˜è®¤å€¼</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">function</span>Â <span class="hljs-title function_">greet</span>(<span class="hljs-params">name</span>) {
Â  <span class="hljs-comment">// å¦‚æœæ²¡ä¼ nameï¼Œæˆ–è€…ä¼ äº†null/undefinedï¼Œå°±ç”¨"æœ‹å‹"</span>
Â  <span class="hljs-keyword">let</span>Â finalName = name ??Â <span class="hljs-string">"æœ‹å‹"</span>;
Â  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`ä½ å¥½ï¼Œ<span class="hljs-subst">${finalName}</span>ï¼`</span>);
}

<span class="hljs-title function_">greet</span>(<span class="hljs-string">"å¼ ä¸‰"</span>);Â  <span class="hljs-comment">// è¾“å‡ºï¼šä½ å¥½ï¼Œå¼ ä¸‰ï¼</span>
<span class="hljs-title function_">greet</span>(<span class="hljs-literal">null</span>);Â  Â  <span class="hljs-comment">// è¾“å‡ºï¼šä½ å¥½ï¼Œæœ‹å‹ï¼</span>
<span class="hljs-title function_">greet</span>();Â  Â  Â  Â  <span class="hljs-comment">// è¾“å‡ºï¼šä½ å¥½ï¼Œæœ‹å‹ï¼</span>
</code></pre>
<h3 data-id="heading-4">åœºæ™¯2ï¼šé…ç½®å¯¹è±¡åˆå¹¶</h3>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ç”¨æˆ·è®¾ç½®</span>
<span class="hljs-keyword">let</span>Â userSettings = {
Â  <span class="hljs-attr">theme</span>:Â <span class="hljs-literal">null</span>,Â  <span class="hljs-comment">// ç”¨æˆ·æ²¡é€‰ä¸»é¢˜</span>
Â  <span class="hljs-attr">fontSize</span>:Â <span class="hljs-number">14</span>
};

<span class="hljs-comment">// é»˜è®¤è®¾ç½®</span>
<span class="hljs-keyword">let</span>Â defaultSettings = {
Â  <span class="hljs-attr">theme</span>:Â <span class="hljs-string">"light"</span>,
Â  <span class="hljs-attr">fontSize</span>:Â <span class="hljs-number">16</span>,
Â  <span class="hljs-attr">language</span>:Â <span class="hljs-string">"zh-CN"</span>
};

<span class="hljs-comment">// åˆå¹¶è®¾ç½®ï¼šä¼˜å…ˆç”¨ç”¨æˆ·çš„ï¼Œç”¨æˆ·æ²¡è®¾ç½®å°±ç”¨é»˜è®¤çš„</span>
<span class="hljs-keyword">let</span>Â finalSettings = {
Â  <span class="hljs-attr">theme</span>: userSettings.<span class="hljs-property">theme</span>Â ?? defaultSettings.<span class="hljs-property">theme</span>,
Â  <span class="hljs-attr">fontSize</span>: userSettings.<span class="hljs-property">fontSize</span>Â ?? defaultSettings.<span class="hljs-property">fontSize</span>,
Â  <span class="hljs-attr">language</span>: userSettings.<span class="hljs-property">language</span>Â ?? defaultSettings.<span class="hljs-property">language</span>
};

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(finalSettings);
<span class="hljs-comment">// è¾“å‡ºï¼š{ theme: "light", fontSize: 14, language: "zh-CN" }</span>
</code></pre>
<h3 data-id="heading-5">åœºæ™¯3ï¼šé“¾å¼è°ƒç”¨</h3>
<pre><code class="hljs language-ini" lang="ini">letÂ <span class="hljs-attr">user</span> = {
Â  profile: {
Â  Â  address: {
Â  Â  Â  city:Â "åŒ—äº¬"
Â  Â  }
Â  }
}<span class="hljs-comment">;</span>

// å®‰å…¨åœ°è·å–åµŒå¥—å±æ€§
letÂ <span class="hljs-attr">city</span> = user?.profile?.address?.cityÂ ??Â <span class="hljs-string">"æœªçŸ¥åŸå¸‚"</span><span class="hljs-comment">;</span>
console.log(city)<span class="hljs-comment">;Â // è¾“å‡ºï¼šåŒ—äº¬</span>

// å¦‚æœä¸­é—´æŸä¸ªå±æ€§ä¸å­˜åœ¨
letÂ <span class="hljs-attr">user2</span> = {
Â  profile:Â null
}<span class="hljs-comment">;</span>

letÂ <span class="hljs-attr">city2</span> = user2?.profile?.address?.cityÂ ??Â <span class="hljs-string">"æœªçŸ¥åŸå¸‚"</span><span class="hljs-comment">;</span>
console.log(city2)<span class="hljs-comment">;Â // è¾“å‡ºï¼šæœªçŸ¥åŸå¸‚</span>
</code></pre>
<p>è¿™é‡Œç”¨åˆ°äº†å¯é€‰é“¾æ“ä½œç¬¦<code>?.</code>ï¼Œå®ƒå’Œ<code>??</code>é…åˆä½¿ç”¨éå¸¸æ–¹ä¾¿ã€‚</p>
<h2 data-id="heading-6">æ³¨æ„äº‹é¡¹</h2>
<h3 data-id="heading-7">1. ä¸èƒ½ç›´æ¥å’Œ<code>&amp;&amp;</code>æˆ–<code>||</code>ä¸€èµ·ç”¨</h3>
<pre><code class="hljs language-ini" lang="ini">// è¿™æ ·å†™ä¼šæŠ¥é”™
letÂ <span class="hljs-attr">x</span> = a &amp;&amp; b ?? c<span class="hljs-comment">;Â  // SyntaxError</span>

// éœ€è¦åŠ æ‹¬å·
letÂ <span class="hljs-attr">x</span> = (a &amp;&amp; b) ?? c<span class="hljs-comment">;Â  // æ­£ç¡®</span>
letÂ <span class="hljs-attr">y</span> = a &amp;&amp; (b ?? c)<span class="hljs-comment">;Â  // æ­£ç¡®</span>
</code></pre>
<h3 data-id="heading-8">2. ä¼˜å…ˆçº§é—®é¢˜</h3>
<p><code>??</code>çš„ä¼˜å…ˆçº§æ¯”<code>=</code>é«˜ï¼Œä½†æ¯”å¤§å¤šæ•°è¿ç®—ç¬¦ä½ã€‚ä¸ºäº†ä»£ç æ¸…æ™°ï¼Œå»ºè®®åœ¨å¤æ‚è¡¨è¾¾å¼ä¸­ä½¿ç”¨æ‹¬å·ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">// è¿™æ ·å†™å¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„
letÂ <span class="hljs-attr">result</span> = a ?? b &amp;&amp; c<span class="hljs-comment">;</span>

// åŠ æ‹¬å·æ›´æ¸…æ™°
letÂ <span class="hljs-attr">result</span> = a ?? (b &amp;&amp; c)<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-9">3. åœ¨æ—§ç‰ˆæœ¬æµè§ˆå™¨ä¸­å¯èƒ½ä¸æ”¯æŒ</h3>
<p><code>??</code>æ˜¯ES2020å¼•å…¥çš„è¯­æ³•ã€‚å¦‚æœä½ éœ€è¦æ”¯æŒæ—§æµè§ˆå™¨ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨Babelç­‰å·¥å…·è¿›è¡Œè½¬æ¢ã€‚</p>
<h2 data-id="heading-10">ä»€ä¹ˆæ—¶å€™ç”¨<code>??</code></h2>
<p>è®°ä½è¿™ä¸ªç®€å•çš„åˆ¤æ–­æ ‡å‡†ï¼š</p>
<p>â€¢ å½“ä½ åªæƒ³åœ¨å˜é‡æ˜¯<code>null</code>æˆ–<code>undefined</code>æ—¶æ‰ç”¨é»˜è®¤å€¼ï¼Œç”¨<code>??</code></p>
<p>â€¢ å½“ä½ æƒ³åœ¨æ‰€æœ‰å‡å€¼ï¼ˆ<code>false</code>ã€<code>0</code>ã€<code>""</code>ç­‰ï¼‰æƒ…å†µä¸‹éƒ½ç”¨é»˜è®¤å€¼ï¼Œç”¨<code>||</code></p>
<p>åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œ<code>??</code>é€šå¸¸æ›´é€‚åˆå¤„ç†é…ç½®ã€ç”¨æˆ·è¾“å…¥ã€APIå“åº”ç­‰åœºæ™¯ï¼Œå› ä¸ºè¿™äº›åœºæ™¯ä¸­<code>0</code>ã€<code>false</code>ã€<code>""</code>å¾€å¾€æ˜¯æœ‰æ•ˆå€¼ï¼Œä¸åº”è¯¥è¢«é»˜è®¤å€¼æ›¿æ¢ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„ä¼˜åŒ–æ–¹æ³•ï¼]]></title>    <link>https://juejin.cn/post/7593242327933812746</link>    <guid>https://juejin.cn/post/7593242327933812746</guid>    <pubDate>2026-01-10T09:40:17.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593242327933812746" data-draft-id="7593242327933796362" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„ä¼˜åŒ–æ–¹æ³•ï¼"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-10T09:40:17.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aicoting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„ä¼˜åŒ–æ–¹æ³•ï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aicoting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T09:40:17.000Z" title="Sat Jan 10 2026 09:40:17 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ¨èç›´æ¥ç½‘ç«™åœ¨çº¿é˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Faicoting.cn%2F" target="_blank" title="https://link.zhihu.com/?target=https%3A//aicoting.cn/" ref="nofollow noopener noreferrer">aicoting AIç®—æ³•é¢è¯•å­¦ä¹ åœ¨çº¿ç½‘ç«™</a></p>
</blockquote>
<p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ¨¡å‹çš„è®­ç»ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªä¼˜åŒ–é—®é¢˜ï¼šæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä¸€ç»„å‚æ•°ï¼Œä½¿å¾—æ¨¡å‹åœ¨ç»™å®šæ•°æ®ä¸Šçš„æŸå¤±æœ€å°åŒ–ï¼ˆæˆ–ç›®æ ‡å‡½æ•°æœ€å¤§åŒ–ï¼‰ã€‚ä¼˜åŒ–æ–¹æ³•æä¾›äº†ä¸€å¥—ç³»ç»Ÿçš„æ•°å­¦å·¥å…·ï¼Œç”¨äºé«˜æ•ˆã€ç¨³å®šåœ°å¯»æ‰¾æœ€ä½³å‚æ•°ã€‚</p>
<p>ä¼˜åŒ–æ–¹æ³•éƒ¨åˆ†æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æœ€ç»å…¸çš„æ¢¯åº¦ä¸‹é™ï¼Œå¹¶ä¸”ä¸ºå¤§å®¶ç®€å•çš„ä»‹ç»ä¸€ä¸‹å‡¸ä¼˜åŒ–å’Œçº¦æŸä¼˜åŒ–ï¼Œå‰é¢è¯´è¿‡è¿™éƒ¨åˆ†å…¶å®æ˜¯ç ”ç©¶ç”Ÿè¯¾ç¨‹ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘å†™çš„æ˜¯ç®€å•å†…å®¹ï¼Œå¤§å®¶åº”è¯¥éƒ½èƒ½çœ‹æ‡‚ï¼</p>
<h2 data-id="heading-0">æ¢¯åº¦ä¸‹é™åŠå…¶å˜ä½“</h2>
<p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ¢¯åº¦ä¸‹é™ï¼ˆGradient Descent, GDï¼‰æ˜¯ä¼˜åŒ–æ¨¡å‹å‚æ•°æœ€æ ¸å¿ƒçš„æ–¹æ³•ã€‚é€šè¿‡æ²¿ç€æŸå¤±å‡½æ•°çš„æ¢¯åº¦åæ–¹å‘æ›´æ–°å‚æ•°ï¼Œæ¢¯åº¦ä¸‹é™å¯ä»¥æ‰¾åˆ°ä½¿æŸå¤±æœ€å°çš„å‚æ•°ç»„åˆã€‚</p>
<h3 data-id="heading-1">åŸºæœ¬æ¢¯åº¦ä¸‹é™ï¼ˆBatch Gradient Descent, BGDï¼‰</h3>
<p>åŸç†</p>
<p>BGD æ¯æ¬¡ä½¿ç”¨æ•´ä¸ªè®­ç»ƒé›†è®¡ç®—æ¢¯åº¦ï¼Œæ›´æ–°å‚æ•°ï¼š</p>
<p>Î¸t+1=Î¸tâˆ’Î·âˆ‡Î¸L(Î¸t)</p>
<ul>
<li>Î¸tï¼šå½“å‰å‚æ•°</li>
<li>Î·ï¼šå­¦ä¹ ç‡</li>
<li>âˆ‡Î¸L(Î¸t)ï¼šæŸå¤±å‡½æ•°å¯¹å‚æ•°çš„æ¢¯åº¦</li>
</ul>
<p>ä¼˜ç¼ºç‚¹</p>
<p>åŸºæœ¬æ¢¯åº¦ä¸‹é™æ–¹æ³•æ¢¯åº¦ç¨³å®šï¼Œæ›´æ–°æ–¹å‘å‡†ç¡®ï¼Œæ”¶æ•›ç¨³å®šï¼Œä¸å®¹æ˜“è·³å‡ºå±€éƒ¨æå°å€¼ï¼ˆå‡¸é—®é¢˜é™¤å¤–ï¼‰ã€‚</p>
<p>ä½†æ˜¯å¤§æ•°æ®é›†è®¡ç®—æˆæœ¬é«˜ï¼Œä¸é€‚åˆåœ¨çº¿å­¦ä¹ æˆ–å®æ—¶è®­ç»ƒã€‚</p>
<p>åº”ç”¨åœºæ™¯</p>
<ul>
<li>å°å‹æ•°æ®é›†æˆ–éœ€è¦ç²¾ç¡®ä¼˜åŒ–çš„çº¿æ€§æ¨¡å‹ï¼ˆå¦‚çº¿æ€§å›å½’ï¼‰</li>
</ul>
<h3 data-id="heading-2">éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆStochastic Gradient Descent, SGDï¼‰</h3>
<p>åŸç†</p>
<p>SGD æ¯æ¬¡åªä½¿ç”¨ä¸€ä¸ªæ ·æœ¬è®¡ç®—æ¢¯åº¦ï¼š</p>
<ul>
<li>ï¼šå½“å‰æ ·æœ¬</li>
<li>ï¼šå­¦ä¹ ç‡</li>
</ul>
<p>ä¼˜ç¼ºç‚¹</p>
<p>éšæœºæ¢¯åº¦ä¸‹é™è®¡ç®—æ•ˆç‡é«˜ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®ï¼Œæ¢¯åº¦å™ªå£°æœ‰åŠ©äºè·³å‡ºå±€éƒ¨æå°å€¼ã€‚</p>
<p>ä½†æ˜¯æ¢¯åº¦éœ‡è¡ï¼Œæ”¶æ•›ä¸ç¨³å®šï¼Œå¯èƒ½éœ€è¦æ›´å¤šè¿­ä»£æ¬¡æ•°ã€‚</p>
<p>åº”ç”¨åœºæ™¯</p>
<ul>
<li>åœ¨çº¿å­¦ä¹ ã€æ·±åº¦ç¥ç»ç½‘ç»œè®­ç»ƒ</li>
<li>æ¨èç³»ç»Ÿæˆ–å¤§è§„æ¨¡æ•°æ®æµå¤„ç†</li>
</ul>
<h3 data-id="heading-3">Mini-batch æ¢¯åº¦ä¸‹é™</h3>
<p>åŸç†</p>
<ul>
<li>æ¯æ¬¡ä½¿ç”¨å°æ‰¹é‡æ ·æœ¬ï¼ˆå¦‚ 32 æˆ– 128 ä¸ªï¼‰è®¡ç®—æ¢¯åº¦</li>
<li>å‚æ•°æ›´æ–°å…¬å¼ï¼š</li>
<li>mä¸ºæ‰¹é‡å¤§å°</li>
</ul>
<p>ä¼˜ç¼ºç‚¹</p>
<p>Mini-batch æ¢¯åº¦ä¸‹é™å…¼é¡¾äº† SGD çš„æ•ˆç‡å’Œ BGD çš„ç¨³å®šæ€§,å¯åˆ©ç”¨ GPU å¹¶è¡Œè®¡ç®—ã€‚</p>
<p>ä½†æ˜¯æ‰¹é‡å¤§å°éœ€è¦è°ƒä¼˜ï¼Œæ‰¹é‡è¿‡å°å¯èƒ½éœ‡è¡ï¼Œè¿‡å¤§é™ä½æ•ˆç‡ã€‚</p>
<p>åº”ç”¨åœºæ™¯</p>
<ul>
<li>æ·±åº¦å­¦ä¹ è®­ç»ƒä¸­çš„é»˜è®¤é€‰æ‹©</li>
<li>CNNã€RNN ç­‰å¤§è§„æ¨¡æ¨¡å‹è®­ç»ƒ</li>
</ul>
<h3 data-id="heading-4">åŠ¨é‡æ³•ï¼ˆMomentumï¼‰</h3>
<p>åŸç†</p>
<ul>
<li>å¼•å…¥â€œæƒ¯æ€§â€ï¼Œç´¯ç§¯å†å²æ¢¯åº¦ï¼Œå‡å°‘éœ‡è¡ï¼ŒåŠ å¿«æ”¶æ•›ï¼š</li>
<li>ä¸ºåŠ¨é‡ç³»æ•°ï¼ˆé€šå¸¸ 0.9ï¼‰</li>
</ul>
<p>ä¼˜ç¼ºç‚¹</p>
<p>åŠ¨é‡æ³•å¯ä»¥åŠ å¿«æ”¶æ•›é€Ÿåº¦ï¼Œå‡å°‘æ¢¯åº¦æ–¹å‘éœ‡è¡ã€‚</p>
<p>ä½†æ˜¯éœ€è¦è°ƒèŠ‚åŠ¨é‡ç³»æ•°ï¼Œå¯èƒ½å¯¹éå‡¸æŸå¤±å‡½æ•°è¿‡å†²ã€‚</p>
<p>åº”ç”¨åœºæ™¯</p>
<ul>
<li>æ·±åº¦ç¥ç»ç½‘ç»œ</li>
<li>CNNã€RNN ç­‰æ¢¯åº¦éœ‡è¡æ˜æ˜¾çš„ç½‘ç»œ</li>
</ul>
<h3 data-id="heading-5">è‡ªé€‚åº”å­¦ä¹ ç‡æ–¹æ³•</h3>
<p>1.AdaGrad åŸç†</p>
<ul>
<li>ä¸ºæ¯ä¸ªå‚æ•°ä½¿ç”¨ä¸åŒçš„è‡ªé€‚åº”å­¦ä¹ ç‡ï¼š</li>
<li>ä¸ºæ¢¯åº¦å¹³æ–¹ç´¯ç§¯</li>
<li>ä¼˜ç‚¹ï¼šé€‚åˆç¨€ç–ç‰¹å¾</li>
<li>ç¼ºç‚¹ï¼šå­¦ä¹ ç‡éšè¿­ä»£ä¸æ–­è¡°å‡ï¼Œå¯èƒ½è¿‡æ—©åœæ­¢</li>
</ul>
<p>2.RMSProp åŸç†</p>
<ul>
<li>æ”¹è¿› AdaGradï¼Œä½¿ç”¨æ¢¯åº¦å¹³æ–¹çš„æŒ‡æ•°è¡°å‡å¹³å‡ï¼š</li>
<li>ä¼˜ç‚¹ï¼šè§£å†³ AdaGrad å­¦ä¹ ç‡è¿‡å¿«è¡°å‡é—®é¢˜</li>
</ul>
<p>3.Adamï¼ˆAdaptive Moment Estimationï¼‰ åŸç†</p>
<ul>
<li>ç»“åˆåŠ¨é‡å’Œè‡ªé€‚åº”å­¦ä¹ ç‡</li>
<li>ä¼˜ç‚¹ï¼š</li>
<li>æ”¶æ•›å¿«ï¼Œé€‚åˆå¤§å¤šæ•°æ·±åº¦å­¦ä¹ ä»»åŠ¡</li>
<li>è‡ªåŠ¨è°ƒèŠ‚å­¦ä¹ ç‡</li>
<li>ç¼ºç‚¹ï¼š</li>
<li>å¯¹è¶…å‚æ•°æ•æ„Ÿ</li>
<li>å†…å­˜å ç”¨è¾ƒé«˜</li>
</ul>
<p>åº”ç”¨åœºæ™¯</p>
<ul>
<li>CNNã€RNNã€Transformer ç­‰æ·±åº¦ç½‘ç»œ</li>
<li>é«˜ç»´ç¨€ç–ç‰¹å¾ä¼˜åŒ–</li>
</ul>
<h3 data-id="heading-6">å­¦ä¹ ç‡ç­–ç•¥</h3>
<p>1.å›ºå®šå­¦ä¹ ç‡:ç®€å•ä½†ä¸çµæ´»</p>
<p>2.å­¦ä¹ ç‡è¡°å‡ï¼šéšè®­ç»ƒè½®æ•°é™ä½</p>
<p>3.å¾ªç¯å­¦ä¹ ç‡ï¼ˆCyclic LRï¼‰ï¼šå‘¨æœŸæ€§è°ƒæ•´å­¦ä¹ ç‡ï¼Œå¦‚ä»ä½åˆ°é«˜å†åˆ°ä½</p>
<p>4.è‡ªé€‚åº”ä¼˜åŒ–ç®—æ³•ï¼ˆAdamã€RMSPropï¼‰ï¼šè‡ªåŠ¨è°ƒèŠ‚å­¦ä¹ ç‡ï¼Œæ— éœ€æ‰‹åŠ¨è°ƒæ•´</p>
<h2 data-id="heading-7">å‡¸ä¼˜åŒ–ä¸çº¦æŸä¼˜åŒ–</h2>
<p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä¼˜åŒ–é—®é¢˜æ— å¤„ä¸åœ¨ã€‚æ— è®ºæ˜¯è®­ç»ƒçº¿æ€§å›å½’ã€æ”¯æŒå‘é‡æœºï¼Œè¿˜æ˜¯æ·±åº¦ç¥ç»ç½‘ç»œï¼Œæ ¸å¿ƒç›®æ ‡éƒ½æ˜¯é€šè¿‡ä¼˜åŒ–æ–¹æ³•æ‰¾åˆ°æœ€ä¼˜å‚æ•°ã€‚ä¸ºäº†æ›´é«˜æ•ˆåœ°æ±‚è§£è¿™äº›é—®é¢˜ï¼Œå‡¸ä¼˜åŒ–ï¼ˆConvex Optimizationï¼‰ä¸çº¦æŸä¼˜åŒ–ï¼ˆConstrained Optimizationï¼‰æä¾›äº†ç†è®ºåŸºç¡€å’Œæ–¹æ³•æ”¯æŒã€‚</p>
<h3 data-id="heading-8">å‡¸ä¼˜åŒ–ï¼ˆConvex Optimizationï¼‰</h3>
<p>å®šä¹‰</p>
<p>ä¸€ä¸ªä¼˜åŒ–é—®é¢˜ç§°ä¸ºå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå¦‚æœå…¶ç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œä¸”çº¦æŸæ¡ä»¶æ˜¯å‡¸é›†åˆã€‚å½¢å¼åŒ–è¡¨ç¤ºä¸ºï¼š</p>
<ul>
<li>f(Î¸)ä¸ºå‡¸å‡½æ•°ï¼Œå³æ»¡è¶³ï¼š</li>
<li>ä¸ºå‡¸é›†åˆ ç›´è§‚ç‚¹ç†è§£å°±æ˜¯å‡¸å‡½æ•°å½¢çŠ¶åƒç¢—ï¼Œä»»ä½•ä¸¤ç‚¹è¿çº¿éƒ½åœ¨å‡½æ•°æ›²é¢ä¹‹ä¸Šã€‚å‡¸ä¼˜åŒ–é—®é¢˜åªæœ‰ä¸€ä¸ªå…¨å±€æœ€ä¼˜ç‚¹ï¼Œæ²¡æœ‰å±€éƒ¨æå°å€¼å›°æ‰°ã€‚</li>
</ul>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/046fcb95e2484eae93d4753a72d7870e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYWljb3Rpbmc=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768642816&amp;x-signature=VhtkPol3IJBg7obGF2MjSCywVQk%3D" alt="" loading="lazy"/></p>
<p>æ·»åŠ å›¾ç‰‡æ³¨é‡Šï¼Œä¸è¶…è¿‡ 140 å­—ï¼ˆå¯é€‰ï¼‰</p>
<p>å¸¸è§å‡¸ä¼˜åŒ–é—®é¢˜</p>
<ol>
<li>çº¿æ€§å›å½’ï¼š</li>
<li>æ”¯æŒå‘é‡æœºï¼ˆSVMï¼‰å‡¸ä¼˜åŒ–ï¼š</li>
<li>Lasso å›å½’ï¼ˆå¸¦ L1 æ­£åˆ™ï¼‰ï¼š</li>
</ol>
<p>å‡¸ä¼˜åŒ–æ±‚è§£æ–¹æ³•åŒ…æ‹¬æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰ã€ç‰›é¡¿æ³•ï¼ˆNewtonâ€™s Methodï¼‰ã€æ‹Ÿç‰›é¡¿æ³•ï¼ˆBFGSï¼‰ã€å†…ç‚¹æ³•ï¼ˆInterior Point Methodï¼‰ï¼Œè¿™äº›æ–¹æ³•ç†è®ºä¿è¯æ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜è§£ï¼Œç®—æ³•ç¨³å®šé«˜æ•ˆã€‚</p>
<h3 data-id="heading-9">çº¦æŸä¼˜åŒ–ï¼ˆConstrained Optimizationï¼‰</h3>
<p>å®šä¹‰</p>
<p>çº¦æŸä¼˜åŒ–é—®é¢˜æ˜¯æŒ‡ä¼˜åŒ–ç›®æ ‡å—çº¦æŸæ¡ä»¶é™åˆ¶ï¼Œå½¢å¼åŒ–è¡¨ç¤ºä¸ºï¼š</p>
<ul>
<li>ï¼šä¸ç­‰å¼çº¦æŸ</li>
<li>ï¼šç­‰å¼çº¦æŸ ä¹Ÿå°±æ˜¯ä¼˜åŒ–çš„è§£å¿…é¡»åŒæ—¶æ»¡è¶³â€œè¾¹ç•Œæ¡ä»¶â€ï¼Œæ¯”å¦‚æƒé‡éè´Ÿã€æ¦‚ç‡å’Œä¸º 1ã€‚</li>
</ul>
<p>æ±‚è§£æ–¹æ³•</p>
<ol>
<li>æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼ˆLagrange Multiplierï¼‰</li>
</ol>
<ul>
<li>æ„é€ æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</li>
<li>æ±‚è§£ä¸€é˜¶æ¡ä»¶ï¼ˆKKT æ¡ä»¶ï¼‰å¾—åˆ°æœ€ä¼˜è§£</li>
</ul>
<ol start="2">
<li>æŠ•å½±æ¢¯åº¦æ³•ï¼ˆProjected Gradient Descentï¼‰</li>
</ol>
<ul>
<li>æ¯æ¬¡æ¢¯åº¦æ›´æ–°åï¼Œå°†å‚æ•°æŠ•å½±åˆ°å¯è¡Œé›†åˆå†…ï¼š</li>
</ul>
<ol start="3">
<li>ç½šå‡½æ•°æ³•ï¼ˆPenalty Methodï¼‰</li>
</ol>
<ul>
<li>å°†çº¦æŸè½¬åŒ–ä¸ºæŸå¤±å‡½æ•°çš„ä¸€éƒ¨åˆ†ï¼š</li>
</ul>
<p>çº¦æŸä¼˜åŒ–çš„åº”ç”¨åœºæ™¯åŒ…æ‹¬æ”¯æŒå‘é‡æœº(ä¿è¯åˆ†ç±»é—´éš”çº¦æŸ)ã€æ¦‚ç‡æ¨¡å‹(ä¿è¯æ¦‚ç‡å’Œä¸º 1)ã€èµ„æºåˆ†é…é—®é¢˜(æƒé‡æˆ–é¢„ç®—é™åˆ¶)ç­‰ç­‰ã€‚</p>
<p>ä½†æ˜¯åœ¨è®¸å¤šæœºå™¨å­¦ä¹ é—®é¢˜ä¸­ï¼Œå‡¸ä¼˜åŒ–å’Œçº¦æŸä¼˜åŒ–å¾€å¾€ç»“åˆä½¿ç”¨ï¼ŒSVM æ˜¯å…¸å‹ä¾‹å­ï¼šå‡¸ç›®æ ‡å‡½æ•° + ä¸ç­‰å¼çº¦æŸï¼ŒLasso å›å½’ä¹Ÿå¯çœ‹ä½œå¸¦çº¦æŸçš„å‡¸ä¼˜åŒ–é—®é¢˜ï¼ˆL1 èŒƒæ•°çº¦æŸï¼‰ã€‚</p>
<p>æœ€æ–°çš„æ–‡ç« éƒ½åœ¨å…¬ä¼—å·aicotingæ›´æ–°ï¼Œåˆ«å¿˜è®°å…³æ³¨å“¦ï¼ï¼ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€React 19 å°é²œã€‘ç¬¬ä¸€ç¯‡ï¼šuseå’ŒuseActionState]]></title>    <link>https://juejin.cn/post/7593241698370158628</link>    <guid>https://juejin.cn/post/7593241698370158628</guid>    <pubDate>2026-01-10T09:40:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593241698370158628" data-draft-id="7593241698370142244" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€React 19 å°é²œã€‘ç¬¬ä¸€ç¯‡ï¼šuseå’ŒuseActionState"/> <meta itemprop="keywords" content="å‰ç«¯,React.js"/> <meta itemprop="datePublished" content="2026-01-10T09:40:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç–¯ç‹‚è¸©å‘äºº"/> <meta itemprop="url" content="https://juejin.cn/user/1011206430698574"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€React 19 å°é²œã€‘ç¬¬ä¸€ç¯‡ï¼šuseå’ŒuseActionState
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1011206430698574/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç–¯ç‹‚è¸©å‘äºº
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T09:40:07.000Z" title="Sat Jan 10 2026 09:40:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æœ¬æ–‡å°†ä»‹ç»react 19çš„ä¸€äº›æ–°ç‰¹æ€§å’ŒAPIï¼Œä¸»æ‰“ä¸€ä¸ªç»“åˆä¾‹å­å’Œè¸©å‘è®°å½•çš„æ–¹å¼æ¥åˆ†äº«ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€use: æ¶ˆè´¹Contextå’ŒPromise</h2>
<h3 data-id="heading-1">1. Context</h3>
<p>å…³äº<code>Context</code> react19 å¸¦æ¥äº†ä¸¤ç‚¹å˜åŒ–ï¼š</p>
<ul>
<li>å¯ä»¥ä½¿ç”¨<code>use</code> åœ¨æ¡ä»¶ä¸­æ¶ˆè´¹ Context</li>
<li>å¯ä»¥ä¸å†ä½¿ç”¨ <code>&lt;Context.Provider&gt;</code>ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨<code>&lt;Context&gt;</code></li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { use } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ThemeContext</span> = <span class="hljs-title function_">createContext</span>(<span class="hljs-string">''</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
 <span class="hljs-comment">// âœ… ç›´æ¥ ThemeContext ä½œä¸ºç»„ä»¶</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"dark"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">showTheme</span>=<span class="hljs-string">{true}/</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext</span>&gt;</span></span>
  );  
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Button</span>(<span class="hljs-params">{ showTheme }</span>) {
  <span class="hljs-keyword">if</span> (showTheme) {
    <span class="hljs-comment">// âœ… å¯ä»¥åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ use</span>
    <span class="hljs-keyword">const</span> theme = <span class="hljs-title function_">use</span>(<span class="hljs-title class_">ThemeContext</span>);
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{theme}</span>&gt;</span>Styled Button<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Default Button<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}
</code></pre>
<h3 data-id="heading-2">2. æ¶ˆè´¹Promise</h3>
<p>æ¶ˆè´¹promiseï¼Œæœ€å¸¸è§çš„åœºæ™¯å°±æ˜¯å¤„ç† <strong>GETç±»è¯·æ±‚</strong>ã€‚</p>
<p>ä¸‹é¢ä»¥<strong>è¡¨æ ¼åˆ†é¡µæŸ¥è¯¢</strong>è¿™ä¸ªåœºæ™¯ä¸ºä¾‹å­ï¼Œè¿›è¡Œæ¢ç´¢ã€‚</p>
<ul>
<li>è¿›å…¥é¡µé¢ï¼Œéœ€è¦åŠ è½½é¡µé¢æ•°æ®</li>
<li>å½“ä¿®æ”¹åˆ†é¡µï¼ˆç‚¹å‡»ä¸‹ä¸€é¡µï¼‰ï¼Œåˆ™è¯·æ±‚æ–°çš„æ•°æ®</li>
</ul>
<h4 data-id="heading-3">1.åˆ‡æ¢è·¯ç”±-è¯·æ±‚æ•°æ®</h4>
<p>react 19ä¸æ”¯æŒåœ¨æ¸²æŸ“ä¸­ç›´æ¥åˆ›å»ºpromise ç„¶åç”¨use è¿›è¡Œæ¶ˆè´¹ï¼Œæ‰€ä»¥åˆ›å»ºpromiseçš„å·¥ä½œäº¤ç»™äº†react-routerï¼Œè®©å®ƒåœ¨åˆå§‹åŒ–é¡µé¢ç»„ä»¶æ—¶ä¼ å…¥ä¸€ä¸ªpromiseã€‚</p>
<p><code>Page.tsx</code></p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useLoaderData, <span class="hljs-keyword">type</span> <span class="hljs-title class_">ClientLoaderFunctionArgs</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">clientLoader</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> p = <span class="hljs-title function_">getVideos</span>()
  
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">videoListPromise</span>: p
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Page</span>(<span class="hljs-params"/>) {
	<span class="hljs-keyword">const</span> { videoListPromise } = useLoaderData&lt;<span class="hljs-keyword">typeof</span> clientLoader&gt;()
	
	<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
		<span class="hljs-tag">&lt;<span class="hljs-name">VideoList</span> {<span class="hljs-attr">videoListPromise</span>}/&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-title class_">VideoList</span>() {
	<span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: response } = <span class="hljs-title function_">use</span>(videoListPromise)
	<span class="hljs-keyword">const</span> videos = response?.<span class="hljs-property">data</span>?.<span class="hljs-property">items</span> || [];
	
	<span class="hljs-keyword">return</span> &lt;div&gt;
		{videos.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">video</span>) =&gt;</span> (
			<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">VideoCard</span> 
				<span class="hljs-attr">key</span>=<span class="hljs-string">{video.id}</span> 
				<span class="hljs-attr">video</span>=<span class="hljs-string">{video}</span> 
			/&gt;</span></span>
		))}
	&lt;div&gt;
}
</code></pre>
<blockquote>
<p>P.S. è¿™é‡Œä½¿ç”¨çš„æ˜¯react-router v7 çš„ framework modeï¼Œ<code>clientLoader</code>è¡¨ç¤ºé¡µé¢å¼‚æ­¥è¯·æ±‚ï¼Œreact-routerç­‰<code>clientLoader</code>è¿™ä¸ªpromiseå®Œæˆå æŒ‚è½½ç»„ä»¶ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡<code>useLoaderData</code>è·å–æ•°æ®ã€‚</p>
</blockquote>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>clientLoader</code>å¹¶æ²¡æœ‰çœŸçš„å‘èµ·å¼‚æ­¥è¯·æ±‚ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªpendingçš„promiseï¼Œè¿™ä¸ªæ˜¯å…³é”®ï¼Œå°±æ˜¯ä¸ºäº†è®©use(promise).</p>
<p>å½“æ¸²æŸ“ä¸­ï¼Œé‡åˆ°<code>use(videoListPromise)</code> , ä¼šthrow ä¸€ä¸ª promiseï¼Œ<code>&lt;Suspense&gt;</code>ç»„ä»¶èƒ½æ•è·åˆ°ä»è€Œæ¸²æŸ“<code>fallback</code>ã€‚å½“è¿™ä¸ªpromise æˆåŠŸï¼ˆresolvedï¼‰å°±ç»§ç»­æ‰§è¡Œä¸‹é¢çš„æ¸²æŸ“ä»£ç ã€‚</p>
<p><strong>æ³¨æ„ç‚¹ï¼š</strong></p>
<ol>
<li><code>use()</code>éœ€è¦åœ¨<code>&lt;Suspense&gt;</code>å†…ä½¿ç”¨ï¼Œå¦åˆ™å°±æ— æ³•æ•è·åˆ°promiseï¼Œå°±ä¸èƒ½åŠ è½½<code>fallback</code>.</li>
<li><code>use()</code>æ¶ˆè´¹çš„promiseå¦‚æœå¤±è´¥ï¼ˆrejectedï¼‰ï¼Œä¼šè§¦å‘<code>&lt;ErrorBoundary&gt;</code>ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œä¸ä¼šç»§ç»­æ¸²æŸ“ä¸‹é¢çš„ç»„ä»¶ã€‚åœ¨è¿™ç§èŒƒå¼ä¸‹ï¼Œ<code>trycatch</code>å°±æ²¡å¿…è¦äº†ï¼Œåªéœ€è¦å®šä¹‰å¥½<code>&lt;ErrorBoundary&gt;</code>ã€‚</li>
<li>ä¸å»ºè®®åœ¨æ¸²æŸ“ä¸­åˆ›å»ºpromiseç»™<code>use</code>ä½¿ç”¨ï¼Œå› ä¸ºè¿™æ ·æ¯æ¬¡é‡æ–°æ¸²æŸ“å°±ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°promiseï¼Œé‡å¤è¯·æ±‚ã€‚æœ€ä½³å®è·µæ˜¯è¿™ä¸ªpromiseè¦ä»ç»„ä»¶å¤–éƒ¨ä¼ å…¥ã€‚</li>
</ol>
<h4 data-id="heading-4">2.äº¤äº’-è¯·æ±‚æ•°æ®</h4>
<p>å‰é¢å±•ç¤ºäº†ä¸€ä¸ªâ€œçº¯ç²¹çš„â€åˆ‡æ¢åˆ°æŸä¸ªé¡µé¢ï¼Œé¡µé¢åŠ è½½åˆå§‹æ•°æ®ã€‚ä½†æœ‰æ—¶å€™éœ€è¦åœ¨äº¤äº’åï¼Œç»§ç»­è§¦å‘æ•°æ®è¯·æ±‚ï¼Œæ¯”å¦‚â€œåˆ†é¡µâ€ã€‚</p>
<p>æ­¤æ—¶æˆ‘ä»¬ä¼šå‘å‡ºä¸€ä¸ªç–‘é—® â€”â€” promiseåœ¨ç»„ä»¶å¤–é¢åˆ›å»ºçš„ï¼Œæˆ‘çš„å‚æ•°æ€ä¹ˆä¼ é€’å‘¢ï¼Ÿ
ç­”ï¼šå°†å‚æ•°â€œ<strong>URL åŒ–</strong>â€.</p>
<p>å…ˆçœ‹æ•ˆæœï¼š</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/db6d189a0470451d9b3df2db0dcdbe11~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768642806&amp;x-signature=AVnqVrABCRJufkab8Aq%2B%2FV59Qpg%3D" alt="image.png" loading="lazy"/></p>
<p>è¦åœ¨ React 19 ä¸­ç»“åˆ React Router ä½¿ç”¨ <code>use</code> + <code>Suspense</code> å¹¶åˆ©ç”¨ URL å®ç°åˆ†é¡µï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼š<strong>å°† URL ä¸­çš„æŸ¥è¯¢å‚æ•°ï¼ˆå¦‚ <code>?page=2</code>ï¼‰ä½œä¸ºè§¦å‘ <code>clientLoader</code> é‡æ–°è¿è¡Œçš„ä¾èµ–é¡¹ã€‚</strong></p>
<p>å½“ URL æ”¹å˜æ—¶ï¼ŒReact Router ä¼šé‡æ–°è°ƒç”¨ <code>clientLoader</code>ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„ Promiseï¼Œ<code>VideoList</code> ç»„ä»¶é€šè¿‡ <code>use(promise)</code> æŒ‚èµ·å¹¶è§¦å‘ <code>Suspense</code> çŠ¶æ€ã€‚</p>
<blockquote>
<p>P.Sè¿™æ˜¯ <code>clientLoader</code>ï¼ˆä»¥åŠæœåŠ¡ç«¯çš„ <code>loader</code>ï¼‰è®¾è®¡çš„æ ¸å¿ƒä¼˜åŠ¿ä¹‹ä¸€ï¼š<strong>æ•°æ®åŠ è½½ä¸è·¯ç”±å˜åŒ–å¤©ç„¶ç»‘å®š</strong>ï¼Œæ— éœ€æ‰‹åŠ¨ç›‘å¬ <code>useParams()</code> æˆ– <code>useLocation()</code>ã€‚
å¦‚æœä½ <strong>ä¸å¸Œæœ›</strong>å‚æ•°å˜åŒ–æ—¶é‡æ–°åŠ è½½ï¼ˆæå°‘è§ï¼‰ï¼Œå¯ä»¥é€šè¿‡ç¼“å­˜æˆ–è‡ªå®šä¹‰é€»è¾‘åœ¨ <code>clientLoader</code> å†…éƒ¨è·³è¿‡è¯·æ±‚ï¼Œä½†é€šå¸¸ä¸éœ€è¦ã€‚</p>
</blockquote>
<p>ä»¥ä¸‹æ˜¯å®Œæ•´çš„æ”¹è¿›æ–¹æ¡ˆï¼š</p>
<h5 data-id="heading-5">a. æ”¹è¿› <code>clientLoader</code></h5>
<p>æˆ‘ä»¬éœ€è¦ä» <code>request.url</code> ä¸­æå–åˆ†é¡µå‚æ•°ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™ API å‡½æ•°ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useLoaderData, <span class="hljs-keyword">type</span> <span class="hljs-title class_">ClientLoaderFunctionArgs</span>, useSearchParams } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router"</span>;
<span class="hljs-keyword">import</span> { use, <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-comment">// æ¨¡æ‹Ÿ API</span>
<span class="hljs-keyword">declare</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getVideos</span>(<span class="hljs-params">params: { page: <span class="hljs-built_in">number</span> }</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">clientLoader</span>(<span class="hljs-params">{ request }: ClientLoaderFunctionArgs</span>) {
  <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> <span class="hljs-title function_">URL</span>(request.<span class="hljs-property">url</span>);
  <span class="hljs-keyword">const</span> page = <span class="hljs-title class_">Number</span>(url.<span class="hljs-property">searchParams</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">"page"</span>)) || <span class="hljs-number">1</span>; <span class="hljs-comment">// é»˜è®¤ç¬¬ä¸€é¡µ</span>
  
  <span class="hljs-comment">// è¿”å›ä¸€ä¸ªæ–°çš„ Promise</span>
  <span class="hljs-keyword">const</span> p = <span class="hljs-title function_">getVideos</span>({ page });
  
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">videoListPromise</span>: p,
    <span class="hljs-attr">currentPage</span>: page
  };
}
</code></pre>
<h5 data-id="heading-6">b. æ”¹è¿› <code>Page</code> å’Œ <code>VideoList</code> ç»„ä»¶</h5>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Page</span>(<span class="hljs-params"/>) {
  <span class="hljs-comment">// 1. è·å– loader ä¼ é€’çš„ Promise å’Œå½“å‰é¡µç </span>
  <span class="hljs-keyword">const</span> { videoListPromise, currentPage } = useLoaderData&lt;<span class="hljs-keyword">typeof</span> clientLoader&gt;();
  <span class="hljs-keyword">const</span> [searchParams, setSearchParams] = <span class="hljs-title function_">useSearchParams</span>();

  <span class="hljs-comment">// å¤„ç†ç¿»é¡µé€»è¾‘ï¼šç›´æ¥æ›´æ–° URL æŸ¥è¯¢å‚æ•°</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handlePageChange</span> = (<span class="hljs-params">newPage: <span class="hljs-built_in">number</span></span>) =&gt; {
    <span class="hljs-title function_">setSearchParams</span>(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      prev.<span class="hljs-title function_">set</span>(<span class="hljs-string">"page"</span>, <span class="hljs-title class_">String</span>(newPage));
      <span class="hljs-keyword">return</span> prev;
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"container"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Video Library - Page {currentPage}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      
      {/* 2. Suspense åŒ…è£¹å¼‚æ­¥æ¸²æŸ“åŒºåŸŸ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"loading"</span>&gt;</span>Loading videos...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">VideoList</span> <span class="hljs-attr">videoListPromise</span>=<span class="hljs-string">{videoListPromise}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>

      {/* 3. åˆ†é¡µæ§åˆ¶å™¨ */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"pagination-controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
          <span class="hljs-attr">disabled</span>=<span class="hljs-string">{currentPage</span> &lt;= <span class="hljs-string">1}</span> 
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handlePageChange(currentPage - 1)}
        &gt;
          Previous
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span> Page {currentPage} <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> 
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handlePageChange(currentPage + 1)}
        &gt;
          Next
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 4. VideoList ä½¿ç”¨ React 19 çš„ use() é’©å­</span>
<span class="hljs-keyword">interface</span> <span class="hljs-title class_">VideoListProps</span> {
  <span class="hljs-attr">videoListPromise</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">any</span>&gt;;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">VideoList</span>(<span class="hljs-params">{ videoListPromise }: VideoListProps</span>) {
  <span class="hljs-comment">// use() ä¼šè‡ªåŠ¨è§£æ„ Promiseï¼Œå¹¶åœ¨ Pending æ—¶æŒ‚èµ· Suspense</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-title function_">use</span>(videoListPromise);
  <span class="hljs-keyword">const</span> videos = response?.<span class="hljs-property">data</span>?.<span class="hljs-property">items</span> || [];

  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {videos.map((video: any) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">VideoCard</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{video.id}</span> <span class="hljs-attr">video</span>=<span class="hljs-string">{video}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h5 data-id="heading-7">c. é‡æ–°åŠ è½½æ•°æ®çš„å‘</h5>
<p>ç¬¬ä¸€æ¬¡è¿›å…¥é¡µé¢ï¼Œè§¦å‘äº†<code>&lt;Suspense&gt;</code>çš„fallbackã€‚
åˆ‡æ¢åˆ†é¡µï¼Œé‡æ–°è¯·æ±‚æ•°æ®æ—¶ï¼ŒuseLoaderDataä¼šè¿”å›ä¸€ä¸ªæ–°çš„<code>Promise {&lt;pending&gt;}</code> ä½†æ˜¯å´æ²¡æœ‰è§¦å‘<code>&lt;Suspense&gt;</code>çš„fallbackã€‚ã€‚ã€‚ <strong>æœ‰ç‚¹åç›´è§‰</strong></p>
<p>è§£å†³åŠæ³•å°±æ˜¯ï¼Œç»™<code>&lt;Suspense&gt;</code>åŠ keyï¼ˆä¸åŠ çš„è¯ï¼Œreacté‡æ–°æ¸²æŸ“å¯èƒ½ç›´æ¥è·³è¿‡Suspenseçš„åè°ƒï¼Œè·³è¿‡æ¸²æŸ“ï¼‰
<code>&lt;Suspense key={currentPage} fallback={&lt;Loading /&gt;} &gt;</code></p>
<h4 data-id="heading-8">3.å°æ€»ç»“</h4>
<p>æœ‰äº›åœºæ™¯ä¸å¤ªé€‚åˆ  <code>clientLoader</code> + <code>use</code> + <code>&lt;Suspense&gt;</code> è¿™ç§å®è·µæ–¹å¼ï¼Œæ¯”å¦‚æ»¡è¶³ã€Œå‚æ•°æ§åˆ¶åˆ·æ–°ã€+ ã€Œå±€éƒ¨åˆ·æ–°ã€çš„åœºæ™¯ã€‚</p>
<ul>
<li>è¿™ç§åœºæ™¯ï¼Œå¾€å¾€æ˜¯æœ‰å¤šä¸ªè¯·æ±‚ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦ä¼ é€’å‚æ•°ï¼ˆURLåªæœ‰ä¸€ä¸ªå°±ä¸å¤ªå¥½è¡¨è¾¾ï¼‰ã€‚æ¯ä¸ªå±€éƒ¨åˆ·æ–°å¯¹åº”çš„UI éƒ½éœ€è¦ fallbackã€‚ï¼ˆfallbackä¼šæš‚æ—¶è¦†ç›–åŸæ¥çš„UIï¼Œä¸å¥½ï¼‰</li>
<li>ä¸¾ä¸ªä¾‹å­ï¼šã€Œåˆ—è¡¨åŠ è½½æ›´å¤šã€çš„åœºæ™¯ï¼Œå¾€ä¸Šæ»šåŠ¨æ—¶éœ€è¦åŠ è½½æ›´å¤šæ•°æ®ï¼Œæ€»ä¸èƒ½åŠ è½½æ—¶ç”¨fallbackæ¥è®¿è¦†ç›–UIå§ã€‚è¿˜æ˜¯å¾—é€€åŒ–åˆ°<code>useEffect</code>ï¼Œ<code>useEffect</code>å¤„ç†å‰¯ä½œç”¨ç»ˆå½’è¿˜æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</li>
</ul>
<p>è€Œ <code>use(promise)</code> æ›´é€‚åˆâ€œå£°æ˜å¼ã€ä¸€æ¬¡æ€§è§£æâ€ï¼ŒåŠ è½½<code>é¡µé¢çº§</code>æ•°æ®ã€‚</p>
<p>ğŸ†š <strong>å¯¹æ¯”æ€»ç»“</strong></p>








































<table><thead><tr><th>ç»´åº¦</th><th><code>use(promise)</code> + <code>Suspense</code></th><th><code>useEffect</code> / <code>React Query</code></th></tr></thead><tbody><tr><td><strong>é€‚ç”¨åœºæ™¯</strong></td><td>é¡µé¢çº§æ•°æ®ï¼ˆå¦‚æ–‡ç« è¯¦æƒ…ã€å•†å“é¡µï¼‰</td><td>åˆ—è¡¨ã€è¡¨æ ¼ã€ä»ªè¡¨ç›˜ç­‰äº¤äº’å¯†é›†å‹ UI</td></tr><tr><td><strong>Loading ä½“éªŒ</strong></td><td>å…¨å±€ fallbackï¼ˆçœ‹ä¸åˆ°æ•°æ®ï¼‰</td><td>å±€éƒ¨ loadingï¼ˆè¿˜å¯ä»¥çœ‹åˆ°å†å²æ•°æ®ï¼‰âœ…</td></tr><tr><td><strong>çŠ¶æ€æ§åˆ¶</strong></td><td>ä»… pending/success/error</td><td>æ”¯æŒ isFetching, isRefetching, error, cache ç­‰ âœ…</td></tr><tr><td><strong>ç”¨æˆ·äº¤äº’å“åº”</strong></td><td>å¼±ï¼ˆè¢«åŠ¨æŒ‚èµ·ï¼‰</td><td>å¼ºï¼ˆä¸»åŠ¨è§¦å‘ + ç²¾ç¡®åé¦ˆï¼‰âœ…</td></tr><tr><td><strong>å¼€å‘å¿ƒæ™ºæ¨¡å‹</strong></td><td>å£°æ˜å¼ï¼ˆæ•°æ®å³ä¾èµ–ï¼‰</td><td>å‘½ä»¤å¼ï¼ˆäº‹ä»¶ â†’ è¯·æ±‚ â†’ æ›´æ–°ï¼‰âœ…ï¼ˆå¯¹ç®¡ç†ç«¯æ›´ç›´è§‚ï¼‰</td></tr><tr><td><strong>ç”Ÿæ€æ”¯æŒ</strong></td><td>éœ€æ‰‹åŠ¨ç®¡ç†</td><td>React Query/SWR æä¾›å¼€ç®±å³ç”¨åˆ†é¡µæ”¯æŒ âœ…</td></tr></tbody></table>
<h2 data-id="heading-9">äºŒã€Actionsï¼šå¤„ç†è¡¨å•å’ŒPOSTç±»è¯·æ±‚</h2>
<h3 data-id="heading-10">1. ä»€ä¹ˆæ˜¯Actionsï¼Ÿ</h3>
<p>1.åœ¨ React 19 ä¸­ï¼ŒActions æœ¬è´¨ä¸Šæ˜¯æ”¯æŒå¼‚æ­¥å‡½æ•°çš„ Transitionã€‚</p>
<p>2.åœ¨ React 19 ä¹‹å‰ï¼Œå¤„ç†å¼‚æ­¥æ“ä½œé€šå¸¸éœ€è¦æ‰‹åŠ¨ç®¡ç† pendingï¼ˆåŠ è½½ä¸­ï¼‰ã€errorï¼ˆé”™è¯¯ï¼‰å’Œ dataï¼ˆæ•°æ®ï¼‰çŠ¶æ€ã€‚Actions çš„å‡ºç°è®©è¿™äº›æµç¨‹è‡ªåŠ¨åŒ–äº†ã€‚</p>
<p>3.å½“ä½ å°†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ä¼ é€’ç»™ <code>useTransition</code> æˆ– <code>useActionState</code> æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨å¤„ç†ï¼š</p>
<ul>
<li><code>Pending çŠ¶æ€</code>ï¼šè‡ªåŠ¨å¼€å§‹å¹¶ç»“æŸï¼Œæ— éœ€æ‰‹åŠ¨ setIsLoading(true/false)ã€‚</li>
<li><code>è‡ªåŠ¨æ’é˜Ÿ</code>ï¼šReact ä¿è¯å¤šä¸ªæäº¤æŒ‰é¡ºåºå¤„ç†ã€‚</li>
<li><code>UI å“åº”æ€§</code>ï¼šUI åœ¨æ•°æ®è¯·æ±‚æœŸé—´ä¿æŒå“åº”ï¼Œä¸ä¼šé˜»å¡ã€‚</li>
</ul>
<h3 data-id="heading-11">2. react 19 çš„è¡¨å•æäº¤</h3>
<h4 data-id="heading-12">1. åŸç”Ÿçš„è¡¨å•</h4>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">"/submit-data"</span> <span class="hljs-attr">method</span>=<span class="hljs-string">"POST"</span>&gt;</span>
</code></pre>
<p>é€šè¿‡<code>onsubmit</code>ç›‘å¬ <code>submit</code>äº‹ä»¶ï¼Œå‡½æ•°return trueï¼Œèµ°åŸç”Ÿè¡¨å•æäº¤é€»è¾‘ï¼ˆå³å‘é€åˆ°actionçš„urlï¼‰ã€‚return falseï¼Œåˆ™é˜»æ­¢æäº¤</p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onsubmit</span>=<span class="hljs-string">"return validateForm()"</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- è¡¨å•å­—æ®µ --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"æäº¤"</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">validateForm</span>(<span class="hljs-params"/>) {
        <span class="hljs-comment">// éªŒè¯é€»è¾‘...</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// æˆ– false</span>
    }
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<p>æ›´å¤šæƒ…å†µä¸‹ï¼Œåˆ©ç”¨ <code>onsubmit</code>æ¥æ‰‹åŠ¨å‘é€httpè¯·æ±‚ï¼Œæäº¤POSTè¯·æ±‚ã€‚ç„¶åè‡ªå·±<code>e.preventDefault();</code>ï¼ˆé˜»æ­¢é»˜è®¤çš„è¡¨å•æäº¤è¡Œä¸ºï¼‰</p>
<h4 data-id="heading-13">2. ä½¿ç”¨useActionStateå¤„ç†è¡¨å•</h4>
<p><strong>React 19 å¯¹è¡¨å•å¤„ç†å¼•å…¥äº†è¾ƒå¤§çš„æ”¹è¿›</strong>ï¼Œç›®æ ‡æ˜¯ç®€åŒ–æ•°æ®å˜æ›´ã€çŠ¶æ€ç®¡ç†å’Œæå‡ç”¨æˆ·ä½“éªŒã€‚</p>
<p>è¿™äº›å˜åŒ–çš„æ ¸å¿ƒæ˜¯å¼•å…¥äº†ã€Œè¡¨å•å¯¹actionçš„æ”¯æŒã€å’Œã€Œ3ä¸ªæ–°çš„ Hooksã€ï¼Œå®ƒä»¬æ—¨åœ¨è®©æ‚¨èƒ½å¤Ÿæ›´å¤šåœ°åˆ©ç”¨ Web æ ‡å‡†çš„ <code>&lt;form&gt;</code> å…ƒç´ ï¼Œå‡å°‘æ‰‹åŠ¨å¤„ç†çŠ¶æ€å’Œ <code>event.preventDefault()</code> çš„æ ·æ¿ä»£ç ã€‚</p>
<ul>
<li>formå…ƒç´ æ”¯æŒ<code>action</code>ä¼ å…¥ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼ˆ<code>asyncFunction</code>ï¼‰</li>
<li>æä¾›<code>useActionState</code> åˆ›å»º <code>asyncFunction</code> å’Œç®¡ç†å¼‚æ­¥çŠ¶æ€</li>
<li>æä¾›<code>useFormStatus</code> æ–¹ä¾¿è¡¨å•å­ç»„ä»¶ è·å–è¡¨å•çš„çŠ¶æ€</li>
<li>æä¾›<code>useOptimistic</code> ä¹è§‚æ›´æ–°</li>
</ul>
<p>ä¸‹é¢ä»¥ç™»å½•è¡¨å•ä¸ºåœºæ™¯æ¥ä»‹ç» react19 è¡¨å•æäº¤çš„å˜åŒ–ã€‚</p>
<p>å…ˆä»‹ç»ä¸‹react19ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæœ€ç›´æ¥çš„ç™»å½•è¡¨å•æ˜¯å¦‚ä½•åšçš„ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/ui/button"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Input</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/ui/input"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Label</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/ui/label"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Form</span>, useNavigate } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router"</span>
<span class="hljs-keyword">import</span> { loginApiAuthLoginPost } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/APIs"</span>
<span class="hljs-keyword">import</span> { useAuthStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/store/useAuthStore"</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Login</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> navigate = <span class="hljs-title function_">useNavigate</span>();
  <span class="hljs-keyword">const</span> setAuth = <span class="hljs-title function_">useAuthStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">setAuth</span>);
  
  <span class="hljs-keyword">const</span> [username, setUsername] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [password, setPassword] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState&lt;string | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogin</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">e: React.FormEvent</span>) =&gt; {
    e.<span class="hljs-title function_">preventDefault</span>();
    <span class="hljs-title function_">setError</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> { data, <span class="hljs-attr">error</span>: apiError } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loginApiAuthLoginPost</span>({
        <span class="hljs-attr">body</span>: { username, password }
      });

      <span class="hljs-keyword">if</span> (apiError) {
        <span class="hljs-title function_">setError</span>(<span class="hljs-string">"Login failed. Please check your credentials."</span>);
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-keyword">if</span> (data &amp;&amp; data.<span class="hljs-property">code</span> === <span class="hljs-number">200</span> &amp;&amp; data.<span class="hljs-property">data</span>) {
        <span class="hljs-title function_">setAuth</span>(data.<span class="hljs-property">data</span>.<span class="hljs-property">token</span>, data.<span class="hljs-property">data</span>.<span class="hljs-property">user</span>);
        <span class="hljs-title function_">navigate</span>(<span class="hljs-string">"/dashboard"</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-title function_">setError</span>(data?.<span class="hljs-property">err_msg</span> || <span class="hljs-string">"Unknown error occurred"</span>);
      }
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
      <span class="hljs-title function_">setError</span>(<span class="hljs-string">"An unexpected error occurred. Please try again."</span>);
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleLogin}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid gap-4"</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid gap-2"</span>&gt;</span>
		  <span class="hljs-tag">&lt;<span class="hljs-name">Label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"username"</span>&gt;</span>Username<span class="hljs-tag">&lt;/<span class="hljs-name">Label</span>&gt;</span>
		  <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> 
			<span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span> 
			<span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
			<span class="hljs-attr">placeholder</span>=<span class="hljs-string">"admin"</span> 
			<span class="hljs-attr">required</span> 
			<span class="hljs-attr">value</span>=<span class="hljs-string">{username}</span>
			<span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setUsername(e.target.value)}
		  /&gt;
		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid gap-2"</span>&gt;</span>
		  <span class="hljs-tag">&lt;<span class="hljs-name">Label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"password"</span>&gt;</span>Password<span class="hljs-tag">&lt;/<span class="hljs-name">Label</span>&gt;</span>
		  <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> 
			<span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span> 
			<span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> 
			<span class="hljs-attr">required</span> 
			<span class="hljs-attr">value</span>=<span class="hljs-string">{password}</span>
			<span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setPassword(e.target.value)}
		  /&gt;
		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
		{error &amp;&amp; (
		  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-sm text-red-500 font-medium"</span>&gt;</span>
			{error}
		  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
		)}
		<span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{loading}</span>&gt;</span>
		  {loading ? "Signing in..." : "Sign in"}
		<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
	  <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  )
}
</code></pre>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5a2b19d93f341c7add9161d76fc9503~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55av54uC6Lip5Z2R5Lq6:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768642806&amp;x-signature=7kblTBEBa%2FXDpWGBGDtqJRFED88%3D" alt="image.png" loading="lazy"/></p>
<h5 data-id="heading-14">a. formçš„actionå±æ€§</h5>
<p>1.<strong><code>&lt;form action&gt;</code> æ”¯æŒå‡½æ•°ï¼š</strong> ç°åœ¨ï¼Œæ‚¨å¯ä»¥ç›´æ¥å°†ä¸€ä¸ª <strong>å¼‚æ­¥å‡½æ•°ï¼ˆActionï¼‰</strong> ä¼ é€’ç»™ <code>&lt;form&gt;</code> å…ƒç´ çš„ <code>action</code> å±æ€§ã€‚</p>
<ul>
<li>å½“è¡¨å•æäº¤æ—¶ï¼ŒReact ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”åœ¨å‡½æ•°å†…ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨ <code>event.preventDefault()</code>ã€‚</li>
<li>Actions é»˜è®¤åœ¨ <strong>Transition</strong> ä¸­è¿è¡Œï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç† Pending (ç­‰å¾…ä¸­) çŠ¶æ€ã€é”™è¯¯å’Œä¹è§‚æ›´æ–°ã€‚</li>
<li>è‡ªåŠ¨é‡ç½®è¡¨å•ã€‚å½“ <code>&lt;form&gt;</code> Action æˆåŠŸæ‰§è¡Œåï¼ŒReact ä¼šè‡ªåŠ¨ä¸º <strong>éå—æ§ç»„ä»¶</strong> é‡ç½®è¡¨å•ã€‚</li>
</ul>
<p>2.webæ ‡å‡†çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FFormData" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/FormData" ref="nofollow noopener noreferrer"> <code>FormData</code>æ¥å£</a> , åŸç”Ÿè¡¨å•çš„æäº¤äº‹ä»¶ä¼šä¼ é€’ä¸€ä¸ª<code>FormData</code>å¯¹è±¡ç»™å‡½æ•°ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†è¡¨å•çš„é”®å€¼å¯¹ã€‚</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FFormData%2Fentries" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/FormData/entries" ref="nofollow noopener noreferrer"><code>FormData.entries()</code></a>è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰é”®å€¼å¯¹çš„<a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FJavaScript%2FReference%2FIteration_protocols" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Iteration_protocols" ref="nofollow noopener noreferrer"><code>iterator</code></a>å¯¹è±¡ã€‚</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FFormData%2Fget" target="_blank" title="https://developer.mozilla.org/zh-CN/docs/Web/API/FormData/get" ref="nofollow noopener noreferrer"><code>FormData.get()</code></a> <code>è¿”å›åœ¨ FormData</code> å¯¹è±¡ä¸­ä¸ç»™å®šé”®å…³è”çš„ç¬¬ä¸€ä¸ªå€¼ã€‚</li>
</ul>
<p>3.æ ¸å¿ƒé€»è¾‘å˜æˆäº† <code>(formData: FormData) =&gt; Promise&lt;any&gt;</code>çš„å‡½æ•°</p>
<pre><code class="hljs language-jsx" lang="jsx"><span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogin</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">formData: FormData</span>) =&gt; {
    <span class="hljs-title function_">setError</span>(<span class="hljs-literal">null</span>);
    <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">const</span> payload = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(formData.<span class="hljs-title function_">entries</span>());
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> { data, <span class="hljs-attr">error</span>: apiError } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loginApiAuthLoginPost</span>({
        <span class="hljs-attr">body</span>: { ...payload }
      });
      <span class="hljs-comment">//...</span>
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(err);
      <span class="hljs-title function_">setError</span>(<span class="hljs-string">"An unexpected error occurred. Please try again."</span>);
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-title function_">setLoading</span>(<span class="hljs-literal">false</span>);
    }
</code></pre>
<p>4.å°†<code>handleLogin</code>ä¼ é€’ç»™formçš„<code>action</code>ï¼Œ è®°å¾—ç»™formè¡¨å•æ§ä»¶åŠ ä¸Š<code>name="xxx"</code>å±æ€§ ã€‚</p>
<pre><code class="hljs language-jsx" lang="jsx">&lt;form action={handleLogin} className=<span class="hljs-string">"grid gap-4"</span>&gt;
	<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid gap-2"</span>&gt;</span>
	  <span class="hljs-tag">&lt;<span class="hljs-name">Label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"username"</span>&gt;</span>Username<span class="hljs-tag">&lt;/<span class="hljs-name">Label</span>&gt;</span>
	  <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> 
		<span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span> 
		<span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span>
		<span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
		<span class="hljs-attr">placeholder</span>=<span class="hljs-string">"admin"</span> 
		<span class="hljs-attr">required</span> 
	  /&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
	<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid gap-2"</span>&gt;</span>
	  <span class="hljs-tag">&lt;<span class="hljs-name">Label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"password"</span>&gt;</span>Password<span class="hljs-tag">&lt;/<span class="hljs-name">Label</span>&gt;</span>
	  <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> 
		<span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span> 
		<span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>
		<span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> 
		<span class="hljs-attr">required</span> 
	  /&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
	{error &amp;&amp; (
	  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-sm text-red-500 font-medium"</span>&gt;</span>
		{error}
	  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
	)}
	&lt;<span class="hljs-title class_">Button</span> className=<span class="hljs-string">"w-full"</span> type=<span class="hljs-string">"submit"</span> disabled={loading}&gt;
	  {loading ? <span class="hljs-string">"Signing in..."</span> : <span class="hljs-string">"Sign in"</span>}
	&lt;/<span class="hljs-title class_">Button</span>&gt;
  &lt;/form&gt;
</code></pre>
<h5 data-id="heading-15">b. useActionState</h5>
<p><strong>useActionStateä»‹ç»</strong></p>
<ul>
<li>å®ƒå°†è¡¨å•æäº¤çš„å¼‚æ­¥æ“ä½œã€çŠ¶æ€ç®¡ç†å’ŒåŠ è½½æŒ‡ç¤ºç»“åˆåœ¨ä¸€èµ·ã€‚</li>
<li>å®ƒè¿”å›æœ€æ–°çš„<code>çŠ¶æ€</code>ã€ä¸€ä¸ª<code>Action å‡½æ•°</code>ï¼Œä»¥åŠä¸€ä¸ª <code>isPending</code> çŠ¶æ€ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥å¤„ç†è¡¨å•çš„æäº¤ç»“æœï¼ˆå¦‚æˆåŠŸæ¶ˆæ¯æˆ–é”™è¯¯ï¼‰ã€‚</li>
<li><strong>ä¼˜ç‚¹ï¼š</strong> å‡å°‘äº†å¯¹å¤šä¸ª <code>useState</code> çš„éœ€æ±‚ï¼Œç®€åŒ–äº†çŠ¶æ€é€»è¾‘ã€‚</li>
</ul>
<p><strong>å‚æ•°ç»†èŠ‚</strong></p>
<ul>
<li>
<p><code>useActionState</code> æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><code>prevState</code> ä»£è¡¨ä¹‹å‰çŠ¶æ€</li>
<li><code>formData</code> ä»£è¡¨actionæäº¤çš„æ•°æ®ï¼ˆå¦‚æœæ˜¯formè¡¨å•ï¼Œåˆ™ä¼ å…¥çš„æ˜¯FormDataï¼‰</li>
</ul>
</li>
<li>
<p><code>useActionState</code> å¯ä»¥æŒ‡å®šä¸¤ä¸ªæ³›å‹ï¼Œåˆ†åˆ«å¯¹åº”prevStateå’ŒformDataçš„ç±»å‹ï¼Œæ¯”å¦‚</p>
<ul>
<li><code>useActionState&lt;string | null, FormData&gt;()</code></li>
</ul>
</li>
<li>
<p><code>è¿”å›å€¼</code>ï¼š<code>[state, submitAction, isPending]</code></p>
</li>
</ul>
<p><strong>å¸¸è§é—®é¢˜</strong>
æœ‰ç‚¹éº»çƒ¦çš„æ˜¯ï¼šFormDataå¯¹tså¾ˆä¸å‹å¥½ï¼Œä½ æ— æ³•å¾—çŸ¥FormDataä¸Šæœ‰ä»€ä¹ˆå±æ€§å’Œvalueã€‚</p>
<p><code>const payload = Object.fromEntries(formData.entries())</code> ä¸­çš„payload tsç±»å‹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> <span class="hljs-attr">payload</span>: {  
[<span class="hljs-attr">k</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-title class_">FormDataEntryValue</span>;  
}
</code></pre>
<p>è¿™å°±è¦å€ŸåŠ©ç‰›é€¼çš„<code>zod</code>å’Œ<code>zod-form-data</code>ä¸¤ä¸ªåº“äº†ï¼Œé¡ºä¾¿æŠŠè¡¨å•çš„å‰ç«¯æ ¡éªŒä¹Ÿåšäº†~</p>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fzod" target="_blank" title="https://www.npmjs.com/package/zod" ref="nofollow noopener noreferrer">zod</a> å¤§åé¼é¼çš„TSæ ¡éªŒåº“</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fzod-form-data" target="_blank" title="https://www.npmjs.com/package/zod-form-data" ref="nofollow noopener noreferrer">zod-form-data</a> æ ¡éªŒFormDataå¹¶æä¾›TSç±»å‹</li>
</ul>
<p><strong>ç™»å½•è¡¨å•æ¡ˆä¾‹</strong>
ä½¿ç”¨ Actionsï¼ˆ <code>useActionState</code>ï¼‰  æ”¹è¿›åçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { useActionState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/ui/button"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Card</span>, <span class="hljs-title class_">CardContent</span>, <span class="hljs-title class_">CardDescription</span>, <span class="hljs-title class_">CardFooter</span>, <span class="hljs-title class_">CardHeader</span>, <span class="hljs-title class_">CardTitle</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/ui/card"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Input</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/ui/input"</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Label</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/components/ui/label"</span>
<span class="hljs-keyword">import</span> { useNavigate } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router"</span>
<span class="hljs-keyword">import</span> { loginApiAuthLoginPost } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/APIs"</span>
<span class="hljs-keyword">import</span> { useAuthStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"@/store/useAuthStore"</span>


<span class="hljs-keyword">import</span> { z } <span class="hljs-keyword">from</span> <span class="hljs-string">"zod"</span>;
<span class="hljs-keyword">import</span> { zfd } <span class="hljs-keyword">from</span> <span class="hljs-string">"zod-form-data"</span>;

<span class="hljs-keyword">const</span> schema = zfd.<span class="hljs-title function_">formData</span>({
  <span class="hljs-attr">username</span>: zfd.<span class="hljs-title function_">text</span>(),
  <span class="hljs-attr">password</span>: zfd.<span class="hljs-title function_">text</span>(z.<span class="hljs-title function_">string</span>().<span class="hljs-title function_">min</span>(<span class="hljs-number">6</span>))
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Login</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> navigate = <span class="hljs-title function_">useNavigate</span>();
  <span class="hljs-keyword">const</span> setAuth = <span class="hljs-title function_">useAuthStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">setAuth</span>);
 

  <span class="hljs-keyword">const</span> [error, handleLogin, loading] = useActionState&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>, <span class="hljs-title class_">FormData</span>&gt;(<span class="hljs-keyword">async</span> (_prevState, formData) =&gt; {
    <span class="hljs-comment">// const payload = Object.fromEntries(formData.entries()) //ç¦æ­¢è¿™ç§tsä¸å‹å¥½çš„è½¬æ¢</span>
    <span class="hljs-keyword">const</span> payload = schema.<span class="hljs-title function_">parse</span>(formData)

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> { data, <span class="hljs-attr">error</span>: apiError } = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loginApiAuthLoginPost</span>({
        <span class="hljs-attr">body</span>: payload,
      });

      <span class="hljs-keyword">if</span> (apiError) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">"Login failed. Please check your credentials."</span>
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data &amp;&amp; data.<span class="hljs-property">code</span> &gt;= <span class="hljs-number">300</span>) {
        <span class="hljs-keyword">return</span> data?.<span class="hljs-property">err_msg</span> || <span class="hljs-string">"Unknown error occurred"</span>
      }
      <span class="hljs-title function_">setAuth</span>(data.<span class="hljs-property">data</span>.<span class="hljs-property">token</span>, data.<span class="hljs-property">data</span>.<span class="hljs-property">user</span>);
      <span class="hljs-title function_">navigate</span>(<span class="hljs-string">"/dashboard"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    } <span class="hljs-keyword">catch</span> (err) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">"An unexpected error occurred. Please try again."</span>
    } 
  }, <span class="hljs-literal">null</span>);


  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">{handleLogin}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid gap-4"</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid gap-2"</span>&gt;</span>
		  <span class="hljs-tag">&lt;<span class="hljs-name">Label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"username"</span>&gt;</span>Username<span class="hljs-tag">&lt;/<span class="hljs-name">Label</span>&gt;</span>
		  <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> 
			<span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span> 
			<span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span>
			<span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
			<span class="hljs-attr">placeholder</span>=<span class="hljs-string">"admin"</span> 
			<span class="hljs-attr">required</span> 
		  /&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"grid gap-2"</span>&gt;</span>
		  <span class="hljs-tag">&lt;<span class="hljs-name">Label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"password"</span>&gt;</span>Password<span class="hljs-tag">&lt;/<span class="hljs-name">Label</span>&gt;</span>
		  <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> 
			<span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span> 
			<span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>
			<span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> 
			<span class="hljs-attr">required</span> 
		  /&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
		{error &amp;&amp; (
		  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"text-sm text-red-500 font-medium"</span>&gt;</span>
			{error}
		  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
		)}
		<span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"w-full"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{loading}</span>&gt;</span>
		  {loading ? "Signing in..." : "Sign in"}
		<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
	  <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  )
}
</code></pre>
<h5 data-id="heading-16">c. useFormStatus</h5>
<p>ç”¨äºåœ¨<strong>å­ç»„ä»¶</strong>ä¸­è®¿é—®çˆ¶çº§è¡¨å•çš„çŠ¶æ€ï¼ˆç‰¹åˆ«æ˜¯ pending çŠ¶æ€ï¼‰ï¼Œè§£å†³â€œå±æ€§é€ä¼ ï¼ˆProp Drillingï¼‰â€é—®é¢˜ã€‚</p>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">function</span> <span class="hljs-title function_">SubmitButton</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { pending } = <span class="hljs-title function_">useFormStatus</span>();
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{pending}</span>&gt;</span>{pending ? "æäº¤ä¸­..." : "æäº¤"}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}

<span class="hljs-comment">// åœ¨çˆ¶ç»„ä»¶ä¸­</span>
&lt;form action={action}&gt;
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">SubmitButton</span> /&gt;</span></span>
&lt;/form&gt;
</code></pre>
<h5 data-id="heading-17">d. useOptimistic</h5>
<p>åœ¨å¼‚æ­¥è¯·æ±‚å®Œæˆä¹‹å‰ï¼Œå…ˆå‡è®¾æ“ä½œæˆåŠŸå¹¶ç«‹å³æ›´æ–° UIã€‚å¦‚æœè¯·æ±‚å¤±è´¥ï¼ŒReact ä¼šè‡ªåŠ¨å›æ»šåˆ°æ—§çŠ¶æ€ã€‚</p>
<p><strong>é€‚ç”¨çš„åœºæ™¯</strong>ï¼š</p>
<ul>
<li>ç¤¾äº¤äº’åŠ¨ï¼Œæ¯”å¦‚ï¼šç‚¹èµã€æ”¶è—ã€å…³æ³¨</li>
<li>ç®€å•çš„åˆ—è¡¨æ“ä½œï¼Œæ¯”å¦‚ï¼šåˆ é™¤ã€æ·»åŠ ã€æ’åº</li>
<li>å•å­—æ®µçš„è¡¨å•æ›´æ–°ï¼Œæ¯”å¦‚ï¼šä¿®æ”¹æ˜µç§°ã€åˆ‡æ¢æŸä¸ªå¼€å…³ï¼ˆSwitchï¼‰</li>
</ul>
<p>è¿™äº›åœºæ™¯çš„å…±åŒç‚¹æ˜¯ï¼š<strong>é€»è¾‘ç®€å•ã€æ“ä½œé¢‘ç¹ã€ç”¨æˆ·å¯¹å³æ—¶åé¦ˆè¦æ±‚é«˜ã€ä¸”å¤±è´¥ç‡é€šå¸¸è¾ƒä½ã€‚</strong></p>
<h4 data-id="heading-18">3. å°æ€»ç»“</h4>
<p>æ€»çš„æ¥è¯´ï¼Œå¯¹äºä¸€äº›ç®€å•çš„è¡¨å• åœºæ™¯ï¼Œ å¯ä»¥å°½é‡ä¸ä¾èµ–ç¬¬ä¸‰æ–¹ç»„ä»¶ï¼Œåšåˆ°ä¼˜é›…å¿«é€Ÿå¼€å‘ã€‚åŒæ—¶Actionsè¿™ç§èŒƒå¼ä¹Ÿä¸ä»…ä»…åªç”¨äºformï¼Œä»»ä½•POSTè¯·æ±‚éƒ½å¯ä»¥ç”¨è¿™ç§æ–¹å¼æ¥å¤„ç†ï¼Œå‡å°‘äº†æ¨¡æ¿ä»£ç ã€‚ ç±»ä¼¼ä¸€ä¸ªç®€æ˜“çš„<code>useAsync</code> hookã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[linuxçš„ç½‘ç»œé…ç½®]]></title>    <link>https://juejin.cn/post/7593198957984546857</link>    <guid>https://juejin.cn/post/7593198957984546857</guid>    <pubDate>2026-01-10T09:06:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593198957984546857" data-draft-id="7593241698369716260" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="linuxçš„ç½‘ç»œé…ç½®"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2026-01-10T09:06:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·46724454499"/> <meta itemprop="url" content="https://juejin.cn/user/502914754559866"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            linuxçš„ç½‘ç»œé…ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/502914754559866/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·46724454499
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T09:06:30.000Z" title="Sat Jan 10 2026 09:06:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ç½‘ç»œæ¥å£çš„é…ç½®</h2>
<h3 data-id="heading-1">ifconfig</h3>
<p>è¿™é‡Œæœ‰ä¸‰ä¸ªç½‘ç»œæ¥å£
docker0ï¼ˆDockerçš„è™šæ‹Ÿç½‘ç»œæ¥å£ï¼‰ï¼Œeth0ï¼ˆä¸»ç½‘ç»œæ¥å£ï¼‰ï¼Œloï¼ˆç¯å›æ¥å£ï¼‰</p>
<p>çŠ¶æ€ï¼š</p>
<p>ç½‘ç»œå‚æ•°ï¼šipv4ï¼Œipv6</p>
<p>æµé‡çŠ¶æ€ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a4569985c9c4622befbd8f722ef11f8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=tLFkJNxgYiuLPSKl6ABchtCYm7k%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">ping</h3>
<p>æ£€æµ‹ç½‘ç»œæ˜¯å¦è¿é€š</p>
<p>ping 8.8.8.8è¿é€š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4281d20f75494fb886599dbc03c31754~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=E2%2FXxnYWY9f%2F0khZ%2BCClf8pxuHM%3D" alt="image.png" loading="lazy"/></p>
<p>ping 192.168.33.33æœªè¿é€šæ— å“åº”</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3985b10ba09e4f10bd083459a1e55504~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=4bgq%2FoWuT0ANDS0Sacxe7MI%2BIHI%3D" alt="image.png" loading="lazy"/></p>
<p>ping -t 8.8.8.8æŒç»­æ£€æµ‹ï¼Œä¸€èˆ¬ç”¨äºwindowsï¼ˆå› ä¸ºå››æ¬¡æ£€æµ‹ä¼šç»“æŸï¼‰</p>
<h3 data-id="heading-3">netstaté“¾è·¯çŠ¶æ€çš„åˆ†æ</h3>
<p>netstat -nult</p>
<p>æŸ¥çœ‹ç«¯å£ä¿¡æ¯</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aed152ba728441a1a64edeb52357933b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=iJig0BlO%2BEBZNhFqt3CTnD8L8jQ%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œçš„-nult</p>
<p>-tæ˜¾ç¤ºTCPé“¾æ¥</p>
<p>-uæ˜¾ç¤ºUDPé“¾æ¥</p>
<p>-låªæ˜¾ç¤ºç›‘å¬çŠ¶æ€çš„ç«¯å£</p>
<p>-næ˜¾ç¤ºæ•°å­—åœ°å€å’Œç«¯å£å·</p>
<h3 data-id="heading-4">ss</h3>
<p>-nult
ä¸netstatç›¸å·®ä¸å¤§</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aadd468f32474f58a480ad535d96e9eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=JSMWAQOkMygqafqmVwHJQVIUgd8%3D" alt="image.png" loading="lazy"/></p>
<p>é€šè¿‡
ss -tulpå®ç°å®æ—¶ç›‘æ§</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6f7cdce5d4894e00b09b17735ebd5317~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=Yx6ys%2FbWe3tQcFfRkU5KIGc2NQE%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">é™æ€ipçš„é…ç½®</h3>
<p>è¿›å…¥IPåœ°å€é…ç½®çš„æ–‡ä»¶å¤¹</p>
<p>cd /etc/sysconfig/network-scripts/</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1e980ba7ec954912a1ae900980154794~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=2VQiR615%2BXK3bVO7kb%2FQ4HQkAI0%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰¾åˆ°é…ç½®ç½‘ç»œæ¥å£çš„æ–‡ä»¶æ‰“å¼€ï¼Œè¿™é‡Œæ˜¯eth0ï¼Œ</p>
<p>cat ifcfg-eth0</p>
<p>æ‰¾åˆ°äº†dhcpï¼Œä¸ºåŠ¨æ€ipåœ°å€ï¼Œç”±è·¯ç”±å™¨å®æ—¶åˆ†é…</p>
<p>å°†dhcpä¿®æ”¹ä¸ºstaticï¼ˆé™æ€ï¼‰ï¼Œ</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e5475d405fa47efa4eaaa4531efb738~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=azwIWAfozkstjBqzrPQs0s1MX6g%3D" alt="image.png" loading="lazy"/></p>
<p><code>BOOTPROTO=dhcp</code>ç½‘å¡é‡‡ç”¨ DHCP åè®®ï¼Œè‡ªåŠ¨ä» DHCP æœåŠ¡å™¨è·å– IP åœ°å€ã€å­ç½‘æ©ç ç­‰å‚æ•°ã€‚</p>
<p><code>DEVICE=eth0</code>ç»‘å®šè¯¥é…ç½®åˆ°åä¸º â€œeth0â€ çš„ç½‘ç»œæ¥å£ã€‚</p>
<p><code>ONBOOT=yes</code>ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œè‡ªåŠ¨æ¿€æ´» eth0 ç½‘å¡ã€‚</p>
<p><code>STARTMODE=auto</code>ä¸<code>ONBOOT</code>åŠŸèƒ½å…¼å®¹ï¼ŒæŒ‡å®šç½‘å¡åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨ï¼ˆé€‚é…éƒ¨åˆ†ç½‘ç»œç®¡ç†å·¥å…·ï¼‰ã€‚</p>
<p><code>TYPE=Ethernet</code>æ ‡è¯†è¯¥æ¥å£ä¸ºä»¥å¤ªç½‘ç±»å‹ã€‚</p>
<p><code>USERCTL=no</code>ç¦æ­¢æ™®é€šç”¨æˆ·æ‰‹åŠ¨æ§åˆ¶è¯¥ç½‘å¡çš„å¯åŠ¨ / åœæ­¢æ“ä½œã€‚</p>
<p>å…ˆå¤‡ä»½</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e142020d6bc494c9a80cc7d03e3c105~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=TuVkVOdtXDUx1ITyA%2BUaEujX5n4%3D" alt="image.png" loading="lazy"/></p>
<p>æ‰‹åŠ¨ä¿®æ”¹</p>
<p><code>BOOTPROTO=static</code>å…³é—­ DHCPï¼Œå¯ç”¨é™æ€ IP æ¨¡å¼ï¼ˆæ–°å¢ï¼‰</p>
<p><code>IPADDR=172.28.157.106</code>æ‰‹åŠ¨æŒ‡å®š eth0 çš„é™æ€ IP åœ°å€ï¼ˆæ–°å¢ï¼‰</p>
<p><code>NETMASK=255.255.240.0</code>å­ç½‘æ©ç ï¼ˆä¸ç½‘ç»œç¯å¢ƒåŒ¹é…ï¼‰ï¼ˆæ–°å¢ï¼‰</p>
<p><code>GATEWAY=172.28.144.1</code>ç½‘ç»œç½‘å…³åœ°å€ï¼ˆéœ€ä¸æ‰€åœ¨ç½‘æ®µçš„ç½‘å…³ä¸€è‡´ï¼‰ï¼ˆæ–°å¢ï¼‰</p>
<p><code>DNS1=8.8.8.8</code>é¦–é€‰ DNS æœåŠ¡å™¨ï¼ˆå¯å¡«å†™è¿è¥å•† / å…¬å…± DNSï¼Œå¦‚é˜¿é‡Œäº‘<code>223.5.5.5</code>ï¼‰</p>
<p>åé‡å¯ã€‚</p>
<h3 data-id="heading-6">DNSé…ç½®</h3>
<p>DNSçš„é…ç½®ä¸€èˆ¬åœ¨/etc/resolv.confæ–‡ä»¶ä¸­</p>
<p>æ‰“å¼€è¯¥é…ç½®æ–‡ä»¶ä¸ºç©º</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5abcc327cd114886aeff8df8568fb10e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=QyOVeagBF6ugO1cZqXxdFh7s0ak%3D" alt="image.png" loading="lazy"/></p>
<p>æ·»åŠ nameserver 114.114.114.114
è¿™æ˜¯å›½å†…å…¬å…±DNSæœåŠ¡å™¨</p>
<p>ä¹Ÿå¯ä»¥ç”¨8.8.8.8å’Œ4.4.4.4è¿™æ˜¯è°·æ­Œçš„</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aef35e007c7440438ad73f5bc1c2404e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768640790&amp;x-signature=wum%2FsbwZhkOe5UhtUFRnYs0ZZGc%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„å­¦ä¹ ç†è®ºï¼]]></title>    <link>https://juejin.cn/post/7593311347291471899</link>    <guid>https://juejin.cn/post/7593311347291471899</guid>    <pubDate>2026-01-10T09:52:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593311347291471899" data-draft-id="7593541290991992882" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„å­¦ä¹ ç†è®ºï¼"/> <meta itemprop="keywords" content="é¢è¯•,ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-10T09:52:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="aicoting"/> <meta itemprop="url" content="https://juejin.cn/user/933911964427818"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€æ–‡ææ‡‚æœºå™¨å­¦ä¹ ä¸­çš„å­¦ä¹ ç†è®ºï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/933911964427818/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    aicoting
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T09:52:59.000Z" title="Sat Jan 10 2026 09:52:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»10åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>æ¨èç›´æ¥ç½‘ç«™åœ¨çº¿é˜…è¯»ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flink.zhihu.com%2F%3Ftarget%3Dhttps%253A%2F%2Faicoting.cn%2F" target="_blank" title="https://link.zhihu.com/?target=https%3A//aicoting.cn/" ref="nofollow noopener noreferrer">aicoting AIç®—æ³•é¢è¯•å­¦ä¹ åœ¨çº¿ç½‘ç«™</a></p>
</blockquote>
<p>å­¦ä¹ ç†è®ºï¼ˆLearning Theoryï¼‰æ˜¯æœºå™¨å­¦ä¹ çš„æ•°å­¦ä¸ç†è®ºåŸºç¡€ä¹‹ä¸€ï¼Œå®ƒå¯ä»¥ä»ä¸¥æ ¼çš„æ•°å­¦è§’åº¦è§£é‡Šå’Œåˆ†æå­¦ä¹ ç®—æ³•çš„æ€§è´¨ä¸æ€§èƒ½ã€‚</p>
<p>é€šè¿‡å­¦ä¹ ç†è®ºï¼Œæˆ‘ä»¬ä¸ä»…èƒ½å¤Ÿç†è§£æœºå™¨å­¦ä¹ ä¸ºä½•æœ‰æ•ˆï¼Œè¿˜å¯ä»¥å›ç­”åœ¨å¤šå¤§ç¨‹åº¦ä¸Šç®—æ³•èƒ½å¤Ÿæ³›åŒ–åˆ°æ–°æ•°æ®ã€éœ€è¦å¤šå°‘è®­ç»ƒæ ·æœ¬ã€ç®—æ³•å¤æ‚åº¦å¦‚ä½•å½±å“æ¨¡å‹æ€§èƒ½ç­‰å…³é”®é—®é¢˜ã€‚</p>
<h2 data-id="heading-0">åå·®-æ–¹å·®æƒè¡¡</h2>
<p>åå·®-æ–¹å·®æƒè¡¡ï¼ˆBias-Variance Tradeoffï¼‰æ˜¯æœºå™¨å­¦ä¹ ä¸­ç†è§£æ¨¡å‹æ³›åŒ–èƒ½åŠ›çš„é‡è¦ç†è®ºæ¡†æ¶ã€‚å®ƒæ­ç¤ºäº†æ¨¡å‹å¤æ‚åº¦ã€æ‹Ÿåˆèƒ½åŠ›ä¸æ³›åŒ–æ€§èƒ½ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯è§£é‡Šè¿‡æ‹Ÿåˆä¸æ¬ æ‹Ÿåˆç°è±¡çš„æ ¸å¿ƒå·¥å…·ã€‚</p>
<p>åœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä¸€ä¸ªå‡è®¾å‡½æ•° h(x) æ¥é€¼è¿‘çœŸå®çš„ç›®æ ‡å‡½æ•° f(x)ï¼Œè€Œæ•°æ®å¸¦æœ‰å™ªå£°ï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>Ïµ</mi><mo separator="true">,</mo><mspace width="1em"/><mi>Ïµ</mi><mo>âˆ¼</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = f(x) + \epsilon, \quad \epsilon \sim \mathcal{N}(0, \sigma^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"/><span class="mord mathnormal">Ïµ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"/><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">Ïµ</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"/><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>æ¨¡å‹è®­ç»ƒçš„ç›®æ ‡æ˜¯æœ€å°åŒ–é¢„æµ‹è¯¯å·®ï¼ˆä¾‹å¦‚å‡æ–¹è¯¯å·® MSEï¼‰ï¼šMSE=E[(h(x)âˆ’y)2]</p>
<p>ç„¶è€Œï¼Œè¿™ä¸ªè¯¯å·®å¹¶ä¸æ˜¯å•ä¸€æ¥æºï¼Œè€Œæ˜¯ç”±å¤šä¸ªå› ç´ å…±åŒå†³å®šã€‚</p>
<p>è€ƒè™‘æ¨¡å‹çš„é¢„æµ‹å€¼ h(x)ï¼Œå…¶å‡æ–¹è¯¯å·®å¯ä»¥åˆ†è§£ä¸º åå·®ï¼ˆBiasï¼‰ã€æ–¹å·®ï¼ˆVarianceï¼‰ å’Œ å™ªå£°ï¼ˆNoiseï¼‰ ä¸‰éƒ¨åˆ†ï¼š</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">E</mi><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">[</mo><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">]</mo><mo>=</mo><munder><munder><mrow><mo stretchy="false">(</mo><mi mathvariant="double-struck">E</mi><mo stretchy="false">[</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>âˆ’</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mo stretchy="true">âŸ</mo></munder><msup><mtext>Bias</mtext><mn>2</mn></msup></munder><mo>+</mo><munder><munder><mrow><mi mathvariant="double-struck">E</mi><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">[</mo><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mi mathvariant="double-struck">E</mi><mo stretchy="false">[</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">]</mo></mrow><mo stretchy="true">âŸ</mo></munder><mtext>Variance</mtext></munder><mo>+</mo><munder><munder><msup><mi>Ïƒ</mi><mn>2</mn></msup><mo stretchy="true">âŸ</mo></munder><mtext>Noise</mtext></munder></mrow><annotation encoding="application/x-tex">\mathbb{E}\big[(h(x) - y)^2\big] = \underbrace{( \mathbb{E}[h(x)] - f(x) )^2}_{\text{Bias}^2} + \underbrace{\mathbb{E}\big[(h(x) - \mathbb{E}[h(x)])^2\big]}_{\text{Variance}} + \underbrace{\sigma^2}_{\text{Noise}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"/><span class="mord mathbb">E</span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">]</span></span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:2.5157em;vertical-align:-1.6516em;"/><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-1.3484em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Bias</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7908em;"><span style="top:-2.8305em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span class="svg-align" style="top:-2.102em;"><span class="pstrut" style="height:3em;"/><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13&#10; 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688&#10; 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7&#10;-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice"><path d="M199572 214&#10;c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14&#10; 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3&#10; 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0&#10;-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3&#10; 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237&#10;-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mopen">(</span><span class="mord mathbb">E</span><span class="mopen">[</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.898em;"><span/></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.6516em;"><span/></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:2.5404em;vertical-align:-1.6763em;"/><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-1.3237em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Variance</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span class="svg-align" style="top:-2.002em;"><span class="pstrut" style="height:3em;"/><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13&#10; 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688&#10; 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7&#10;-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice"><path d="M199572 214&#10;c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14&#10; 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3&#10; 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0&#10;-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3&#10; 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237&#10;-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord mathbb">E</span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mord mathbb">E</span><span class="mopen">[</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">]</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.998em;"><span/></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.6763em;"><span/></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:2.1904em;vertical-align:-1.3263em;"/><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-1.6737em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Noise</span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span class="svg-align" style="top:-2.352em;"><span class="pstrut" style="height:3em;"/><span class="stretchy" style="height:0.548em;min-width:1.6em;"><span class="brace-left" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13&#10; 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688&#10; 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7&#10;-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"/></svg></span><span class="brace-center" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMidYMin slice"><path d="M199572 214&#10;c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14&#10; 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3&#10; 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0&#10;-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"/></svg></span><span class="brace-right" style="height:0.548em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewbox="0 0 400000 548" preserveaspectratio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3&#10; 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237&#10;-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"/></svg></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">Ïƒ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.648em;"><span/></span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.3263em;"><span/></span></span></span></span></span></span></span></span></p>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li>Biasï¼ˆåå·®ï¼‰ï¼šæ¨¡å‹é¢„æµ‹çš„æœŸæœ›å€¼ä¸çœŸå®å‡½æ•° f(x) çš„åç¦»ç¨‹åº¦ã€‚åå·®å¤§æ„å‘³ç€æ¨¡å‹è¿‡äºç®€å•ï¼Œæ— æ³•æ•æ‰çœŸå®æ¨¡å¼ï¼Œå¯¼è‡´æ¬ æ‹Ÿåˆã€‚</li>
<li>Varianceï¼ˆæ–¹å·®ï¼‰ï¼šæ¨¡å‹é¢„æµ‹ç»“æœå¯¹è®­ç»ƒæ•°æ®çš„æ•æ„Ÿæ€§ã€‚å¦‚æœè®­ç»ƒæ•°æ®å˜åŒ–å¯¼è‡´æ¨¡å‹é¢„æµ‹å¤§å¹…æ³¢åŠ¨ï¼Œè¯´æ˜æ–¹å·®å¤§ã€‚æ–¹å·®å¤§é€šå¸¸æ„å‘³ç€æ¨¡å‹è¿‡äºå¤æ‚ï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆã€‚</li>
<li>Noiseï¼ˆå™ªå£°ï¼‰ï¼šæ•°æ®æœ¬èº«çš„ä¸å¯çº¦è¯¯å·®ï¼Œç”±è§‚æµ‹å™ªå£°æˆ–ç³»ç»Ÿéšæœºæ€§å¼•èµ·ï¼Œæ— æ³•é€šè¿‡ä»»ä½•å­¦ä¹ æ–¹æ³•æ¶ˆé™¤ã€‚</li>
</ul>
<p>å¦‚æœæŠŠæ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆä¸æ–¹å·®åå·®å¯¹åº”ï¼Œé«˜åå·®å°±æ˜¯æ¬ æ‹Ÿåˆï¼Œæ¨¡å‹è¿‡äºç®€å•ï¼Œä¾‹å¦‚ç”¨çº¿æ€§å‡½æ•°æ‹Ÿåˆä¸€ä¸ªéçº¿æ€§åˆ†å¸ƒï¼Œé¢„æµ‹å€¼ä¸çœŸå®å€¼å­˜åœ¨ç³»ç»Ÿæ€§å·®è·ã€‚é«˜æ–¹å·®å°±æ˜¯è¿‡æ‹Ÿåˆï¼Œæ¨¡å‹è¿‡äºå¤æ‚ï¼Œä¾‹å¦‚é«˜æ¬¡å¤šé¡¹å¼æ‹Ÿåˆå°‘é‡æ ·æœ¬ï¼Œè™½ç„¶è®­ç»ƒè¯¯å·®å¾ˆå°ï¼Œä½†åœ¨æ–°æ ·æœ¬ä¸Šè¡¨ç°å·®ã€‚ç†æƒ³æƒ…å†µæ˜¯æ¨¡å‹æ—¢ä¸è¿‡äºç®€å•ï¼Œä¹Ÿä¸è¿‡äºå¤æ‚ï¼Œèƒ½å¤Ÿæ•æ‰æ•°æ®çš„ä¸»è¦è§„å¾‹ï¼ŒåŒæ—¶ä¿æŒè¾ƒå¥½çš„æ³›åŒ–æ€§èƒ½ã€‚</p>
<p>å‡è®¾æˆ‘ä»¬ç”¨ä¸€ä¸ªäºŒæ¬¡å¤šé¡¹å¼å»æ‹Ÿåˆæ•°æ® y=x2+Ïµï¼š å¦‚æœæˆ‘ä»¬åªç”¨ä¸€æ¬¡å‡½æ•° y = ax + bï¼Œé‚£ä¹ˆåå·®å°±ä¼šå¾ˆå¤§ï¼ˆæ¨¡å‹ä¸èƒ½è¡¨è¾¾äºŒæ¬¡å…³ç³»ï¼‰ã€‚</p>
<p>åä¹‹å¦‚æœæˆ‘ä»¬ç”¨ 10 æ¬¡å¤šé¡¹å¼ï¼Œåå·®å‡ ä¹ä¸ºé›¶ï¼Œä½†æ–¹å·®æå¤§ï¼ˆå¯¹è®­ç»ƒæ ·æœ¬æ‰°åŠ¨éå¸¸æ•æ„Ÿï¼‰ã€‚</p>
<p>å¦‚æœç”¨äºŒæ¬¡å‡½æ•°ï¼Œåå·®å°ï¼Œæ–¹å·®ä¹Ÿé€‚ä¸­ï¼Œæ‰æ˜¯ç†æƒ³è§£ã€‚</p>
<p>è¿™è¯´æ˜æœ€ä½³æ¨¡å‹å¤æ‚åº¦å¾€å¾€ä¸æ•°æ®çš„çœŸå®ç»“æ„ç›¸åŒ¹é…ã€‚</p>
<p>è€ƒè™‘ç”¨å¤šé¡¹å¼å›å½’æ‹Ÿåˆä¸€ç»„æ ·æœ¬ç‚¹ï¼š</p>
<ul>
<li>ä½é˜¶å¤šé¡¹å¼ï¼ˆå¦‚ä¸€æ¬¡å‡½æ•°ï¼‰ï¼šæ¨¡å‹å¤ªç®€å•ï¼Œè¡¨ç°ä¸ºé«˜åå·®ä½æ–¹å·®ï¼Œæ¬ æ‹Ÿåˆã€‚</li>
<li>é«˜é˜¶å¤šé¡¹å¼ï¼ˆå¦‚ 10 æ¬¡å‡½æ•°ï¼‰ï¼šæ¨¡å‹å¤ªå¤æ‚ï¼Œè®­ç»ƒè¯¯å·®æä½ï¼Œä½†åœ¨æµ‹è¯•é›†ä¸Šæ³¢åŠ¨å¾ˆå¤§ï¼Œè¡¨ç°ä¸ºä½åå·®é«˜æ–¹å·®ï¼Œè¿‡æ‹Ÿåˆã€‚</li>
<li>ä¸­ç­‰é˜¶æ•°å¤šé¡¹å¼ï¼ˆå¦‚ä¸‰æ¬¡æˆ–å››æ¬¡ï¼‰ï¼šèƒ½å¤Ÿè¾ƒå¥½åœ°å¹³è¡¡åå·®å’Œæ–¹å·®ï¼Œæ³›åŒ–è¯¯å·®æœ€å°ã€‚</li>
</ul>
<p>åå·®-æ–¹å·®æƒè¡¡åœ¨æœºå™¨å­¦ä¹ ä¸­çš„åº”ç”¨åŒ…æ‹¬ä»¥ä¸‹æ–¹é¢ï¼š</p>
<ol>
<li>æ¨¡å‹é€‰æ‹©</li>
</ol>
<ul>
<li>çº¿æ€§æ¨¡å‹ï¼ˆå¦‚çº¿æ€§å›å½’ï¼‰ï¼šåå·®è¾ƒé«˜ä½†æ–¹å·®è¾ƒä½ã€‚</li>
<li>éçº¿æ€§æ¨¡å‹ï¼ˆå¦‚æ·±åº¦ç¥ç»ç½‘ç»œï¼‰ï¼šåå·®è¾ƒä½ä½†æ–¹å·®å¯èƒ½è¾ƒé«˜ã€‚ é€‰æ‹©åˆé€‚å¤æ‚åº¦çš„æ¨¡å‹æ˜¯å…³é”®ã€‚</li>
</ul>
<ol start="2">
<li>æ­£åˆ™åŒ–</li>
</ol>
<ul>
<li>L1ï¼ˆLassoï¼‰ã€L2ï¼ˆRidgeï¼‰æ­£åˆ™åŒ–é€šè¿‡é™åˆ¶æ¨¡å‹å¤æ‚åº¦æ¥é™ä½æ–¹å·®ï¼Œä»è€Œæ”¹å–„æ³›åŒ–èƒ½åŠ›ã€‚</li>
</ul>
<ol start="3">
<li>é›†æˆæ–¹æ³•</li>
</ol>
<ul>
<li>Baggingï¼ˆå¦‚éšæœºæ£®æ—ï¼‰é™ä½æ–¹å·®ã€‚</li>
<li>Boostingï¼ˆå¦‚ XGBoostï¼‰é™ä½åå·®ã€‚ é›†æˆæ–¹æ³•æ­£æ˜¯é€šè¿‡æ§åˆ¶åå·®å’Œæ–¹å·®æ¥æå‡æ¨¡å‹æ€§èƒ½ï¼Œè¿™äº›æˆ‘ä»¬åé¢éƒ½ä¼šè¿›è¡Œä»‹ç»ã€‚</li>
</ul>
<ol start="4">
<li>äº¤å‰éªŒè¯</li>
</ol>
<ul>
<li>ç”¨äºè¯„ä¼°ä¸åŒå¤æ‚åº¦æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå¸®åŠ©æ‰¾åˆ°åå·®-æ–¹å·®çš„å¹³è¡¡ç‚¹ã€‚</li>
</ul>
<p>æ€»ç»“ä¸€ä¸‹å°±æ˜¯åå·®åæ˜ æ¨¡å‹çš„ç®€åŒ–ç¨‹åº¦ï¼Œåå·®å¤§å¯¼è‡´æ¬ æ‹Ÿåˆã€‚æ–¹å·®åæ˜ æ¨¡å‹å¯¹æ•°æ®çš„æ•æ„Ÿæ€§ï¼Œæ–¹å·®å¤§å¯¼è‡´è¿‡æ‹Ÿåˆã€‚åå·®ä¸æ–¹å·®é€šå¸¸å‘ˆç°å¯¹ç«‹å…³ç³»ï¼šé™ä½åå·®å¾€å¾€å¢åŠ æ–¹å·®ï¼Œé™ä½æ–¹å·®å¾€å¾€å¢åŠ åå·®ã€‚åå·®-æ–¹å·®æƒè¡¡ å°±æ˜¯åœ¨è¿™ä¸¤è€…ä¹‹é—´å¯»æ‰¾æœ€ä¼˜å¹³è¡¡ï¼Œä»¥å®ç°æœ€ä½çš„æ³›åŒ–è¯¯å·®ã€‚</p>
<h2 data-id="heading-1">VC ç»´ä¸æ³›åŒ–è¯¯å·®</h2>
<p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å…³å¿ƒçš„ä¸ä»…æ˜¯æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šçš„è¡¨ç°ï¼Œæ›´å…³å¿ƒæ¨¡å‹åœ¨ æ–°æ•°æ®ï¼ˆæµ‹è¯•é›†ï¼‰ ä¸Šçš„è¡¨ç°ï¼Œä¹Ÿå°±æ˜¯ æ³›åŒ–èƒ½åŠ›ã€‚ç»Ÿè®¡å­¦ä¹ ç†è®ºä¸ºæˆ‘ä»¬æä¾›äº†åˆ†æå’Œä¿è¯æ³›åŒ–æ€§èƒ½çš„ç†è®ºæ¡†æ¶ï¼Œè€Œ VC ç»´ï¼ˆVapnikâ€“Chervonenkis Dimensionï¼‰ æ˜¯å…¶ä¸­çš„æ ¸å¿ƒæ¦‚å¿µä¹‹ä¸€ã€‚</p>
<h3 data-id="heading-2">æ³›åŒ–è¯¯å·®ä¸ç»éªŒè¯¯å·®</h3>
<p>åœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰çœŸå®åˆ†å¸ƒ Dï¼Œæ ·æœ¬æ•°æ®ä¸ºï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mo separator="true">,</mo><mspace width="1em"/><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>âˆ¼</mo><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">S = \{(x_1, y_1), (x_2, y_2), \dots, (x_m, y_m)\}, \quad (x_i, y_i) \sim \mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">{(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)}</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"/><span class="mspace" style="margin-right:0.1667em;"/><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span></span></span></p>
<p>è®¾æ¨¡å‹å‡è®¾ä¸º h(x)ï¼ŒæŸå¤±å‡½æ•°ä¸º L(h(x),y)ã€‚åˆ™ï¼š</p>
<ul>
<li>æ³›åŒ–è¯¯å·®ï¼ˆæœŸæœ›é£é™©ï¼‰ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>âˆ¼</mo><mi mathvariant="script">D</mi></mrow></msub><mo stretchy="false">[</mo><mi>L</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">R(h) = \mathbb{E}_{(x,y)\sim \mathcal{D}}[L(h(x), y)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3552em;"/><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.5198em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">âˆ¼</span><span class="mord mathcal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.3552em;"><span/></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)]</span></span></span></span></span></li>
<li>ç»éªŒè¯¯å·®ï¼ˆç»éªŒé£é™©ï¼‰ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>R</mi><mo>^</mo></mover><mi>S</mi></msub><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msubsup><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mi>L</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{R}_S(h) = \frac{1}{m} \sum_{i=1}^m L(h(x_i), y_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"/><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></li>
</ul>
<p>æˆ‘ä»¬å¸Œæœ›ï¼š <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>â‰ˆ</mo><msub><mover accent="true"><mi>R</mi><mo>^</mo></mover><mi>S</mi></msub><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R(h) \approx \hat{R}_S(h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â‰ˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span></span></p>
<p>ä½†ç”±äºè®­ç»ƒæ ·æœ¬æœ‰é™ï¼Œæ¨¡å‹å¯èƒ½ä¼šå‡ºç° è¿‡æ‹Ÿåˆï¼ˆç»éªŒè¯¯å·®å¾ˆå°ä½†æ³›åŒ–è¯¯å·®å¾ˆå¤§ï¼‰ã€‚è¿™æ—¶å°±éœ€è¦ä¸€ä¸ªç†è®ºæ¥åˆ»ç”» å‡è®¾ç©ºé—´å¤æ‚åº¦ï¼ŒVC ç»´ä¾¿åº”è¿è€Œç”Ÿã€‚</p>
<h3 data-id="heading-3">VC ç»´çš„å®šä¹‰</h3>
<p>Shatteringï¼ˆæ‰“æ•£ï¼‰</p>
<p>è®¾ä¸€ä¸ªå‡è®¾ç±»ï¼ˆå‡è®¾ç©ºé—´ï¼‰ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span>ã€‚è‹¥å¯¹æŸä¸ªæ ·æœ¬é›†åˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>â€¦</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">S = \{x_1, x_2, \dots, x_m\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner">â€¦</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mclose">}</span></span></span></span></span>ï¼Œæ— è®ºå¦‚ä½•ç»™è¿™äº›æ ·æœ¬ç‚¹åˆ†é…æ ‡ç­¾ï¼ˆå…± 2m ç§å¯èƒ½ï¼‰ï¼Œ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span>ä¸­éƒ½å­˜åœ¨ä¸€ä¸ªå‡è®¾èƒ½å®Œå…¨æ­£ç¡®åˆ†ç±»è¿™äº›æ ·æœ¬ç‚¹ï¼Œåˆ™ç§° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span>èƒ½æ‰“æ•£ï¼ˆshatterï¼‰é›†åˆ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></span>ã€‚</p>
<p>VC ç»´</p>
<p>VC ç»´ å®šä¹‰ä¸ºï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>C</mi><mo stretchy="false">(</mo><mi mathvariant="script">H</mi><mo stretchy="false">)</mo><mo>=</mo><mi>max</mi><mo>â¡</mo><mo stretchy="false">{</mo><mi>m</mi><mtext>â€‰</mtext><mi mathvariant="normal">âˆ£</mi><mtext>â€‰</mtext><mi mathvariant="normal">âˆƒ</mi><mi>S</mi><mo separator="true">,</mo><mi mathvariant="normal">âˆ£</mi><mi>S</mi><mi mathvariant="normal">âˆ£</mi><mo>=</mo><mi>m</mi><mo separator="true">,</mo><mi mathvariant="script">H</mi><mtext>èƒ½æ‰“æ•£</mtext><mi>S</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">VC(\mathcal{H}) = \max \{m \,|\, \exists S, |S|=m, \mathcal{H} \text{èƒ½æ‰“æ•£} S\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mop">max</span><span class="mopen">{</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">âˆƒ</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">âˆ£</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">âˆ£</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="mord text"><span class="mord cjk_fallback">èƒ½æ‰“æ•£</span></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">}</span></span></span></span></span></p>
<p>å³ï¼šä¸€ä¸ªå‡è®¾ç±»èƒ½å¤Ÿæ‰“æ•£çš„æœ€å¤§æ ·æœ¬ç‚¹æ•°ã€‚</p>
<h3 data-id="heading-4">ç¤ºä¾‹</h3>
<ol>
<li>ä¸€ç»´é˜ˆå€¼åˆ†ç±»å™¨ï¼ˆç›´çº¿åˆ‡åˆ†å®æ•°è½´ï¼‰ï¼š</li>
</ol>
<ul>
<li>ä»»ä½• 2 ä¸ªç‚¹éƒ½å¯ä»¥è¢«é˜ˆå€¼åˆ†ç±»å™¨æ‰“æ•£ã€‚</li>
<li>ä½† 3 ä¸ªç‚¹æ— æ³•å®Œå…¨æ‰“æ•£ï¼ˆæ€»æœ‰ä¸€ç§æ ‡ç­¾åˆ†å¸ƒæ— æ³•å®ç°ï¼‰ã€‚</li>
<li>å› æ­¤ VC=2ã€‚</li>
</ul>
<ol start="2">
<li>äºŒç»´å¹³é¢ä¸Šçš„çº¿æ€§åˆ†ç±»å™¨ï¼ˆç›´çº¿åˆ’åˆ†å¹³é¢ï¼‰ï¼š</li>
</ol>
<ul>
<li>å¯ä»¥æ‰“æ•£ä»»æ„ 3 ä¸ªç‚¹ï¼ˆåªè¦ä¸å…±çº¿ï¼‰ã€‚</li>
<li>å¯¹äº 4 ä¸ªç‚¹ï¼Œä¸æ˜¯æ‰€æœ‰æƒ…å†µéƒ½èƒ½æ‰“æ•£ï¼ˆä¾‹å¦‚å››ç‚¹æ„æˆå‡¸å››è¾¹å½¢ï¼Œæ— æ³•å®ç°å¯¹è§’ç‚¹æ­£è´Ÿäº¤æ›¿æ ‡è®°ï¼‰ã€‚</li>
<li>å› æ­¤ VC=3ã€‚</li>
</ul>
<ol start="3">
<li>d ç»´ç©ºé—´ä¸­çš„çº¿æ€§åˆ†ç±»å™¨ï¼š</li>
</ol>
<ul>
<li>VC = d + 1</li>
<li>ä¾‹å¦‚åœ¨ä¸‰ç»´ç©ºé—´ï¼ˆd=3ï¼‰ä¸­ï¼Œå¹³é¢åˆ†ç±»å™¨çš„ VC ç»´ä¸º 4ã€‚</li>
</ul>
<h3 data-id="heading-5">VC ç»´ä¸æ³›åŒ–è¯¯å·®çš„å…³ç³»</h3>
<p>ç»Ÿè®¡å­¦ä¹ ç†è®ºè¡¨æ˜ï¼šå½“å‡è®¾ç©ºé—´çš„ VC ç»´æœ‰é™æ—¶ï¼Œå¯ä»¥ç»™å‡ºæ³›åŒ–è¯¯å·®çš„ä¸Šç•Œã€‚</p>
<p>æ³›åŒ–ç•Œï¼ˆVC ä¸ç­‰å¼ï¼‰</p>
<p>ä»¥ 0-1 æŸå¤±ä¸ºä¾‹ï¼Œè‹¥å‡è®¾ç©ºé—´ Hçš„ VC ç»´ä¸º hï¼Œè®­ç»ƒæ ·æœ¬æ•°ä¸º mï¼Œåˆ™å¯¹äºä»»æ„ Î´âˆˆ(0,1)ï¼Œä»¥è‡³å°‘</p>
<p>1âˆ’Î´çš„æ¦‚ç‡ï¼Œæœ‰ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>â‰¤</mo><msub><mover accent="true"><mi>R</mi><mo>^</mo></mover><mi>S</mi></msub><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>+</mo><msqrt><mfrac><mrow><mi>h</mi><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">(</mo><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mfrac><mrow><mn>2</mn><mi>m</mi></mrow><mi>h</mi></mfrac><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo fence="false" stretchy="true" minsize="1.2em" maxsize="1.2em">)</mo><mo>+</mo><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mfrac><mn>4</mn><mi>Î´</mi></mfrac><mo stretchy="false">)</mo></mrow><mi>m</mi></mfrac></msqrt></mrow><annotation encoding="application/x-tex">R(h) \leq \hat{R}_S(h) + \sqrt{\frac{h\big(\log(\frac{2m}{h})+1\big) + \log(\frac{4}{\delta})}{m}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.1968em;vertical-align:-0.25em;"/><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"/><span class="accent-body" style="left:-0.1667em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0077em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:2.44em;vertical-align:-0.5725em;"/><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8675em;"><span class="svg-align" style="top:-4.4em;"><span class="pstrut" style="height:4.4em;"/><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.51em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.66em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord sizing reset-size3 size6 mtight"><span class="delimsizing size1 mtight"><span class="mtight">(</span></span></span><span class="mspace mtight" style="margin-right:0.1952em;"/><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"/><span class="frac-line mtight" style="border-bottom-width:0.049em;"/></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span/></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"/></span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mord sizing reset-size3 size6 mtight"><span class="delimsizing size1 mtight"><span class="mtight">)</span></span></span><span class="mbin mtight">+</span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03785em;">Î´</span></span></span></span><span style="top:-3.2255em;"><span class="pstrut" style="height:3em;"/><span class="frac-line mtight" style="border-bottom-width:0.049em;"/></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span/></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"/></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span></span></span><span style="top:-3.8275em;"><span class="pstrut" style="height:4.4em;"/><span class="hide-tail" style="min-width:1.02em;height:2.48em;"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="2.48em" viewbox="0 0 400000 2592" preserveaspectratio="xMinYMin slice"><path d="M424,2478&#10;c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514&#10;c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20&#10;s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121&#10;s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081&#10;l0 -0c4,-6.7,10,-10,18,-10 H400000&#10;v40H1014.6&#10;s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185&#10;c-2,6,-10,9,-24,9&#10;c-8,0,-12,-0.7,-12,-2z M1001 80&#10;h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.5725em;"><span/></span></span></span></span></span></span></span></span></p>
<p>å«ä¹‰ï¼š</p>
<ul>
<li>æ³›åŒ–è¯¯å·®ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç»éªŒè¯¯å·® + å¤æ‚åº¦æƒ©ç½šé¡¹ã€‚</li>
<li>VC ç»´è¶Šå¤§ï¼Œå¤æ‚åº¦æƒ©ç½šè¶Šå¤§ï¼Œéœ€è¦æ›´å¤šæ ·æœ¬æ‰èƒ½ä¿è¯æ³›åŒ–èƒ½åŠ›ã€‚</li>
<li>è®­ç»ƒæ ·æœ¬æ•° mm è¶Šå¤§ï¼Œå¤æ‚åº¦æƒ©ç½šé¡¹è¶Šå°ï¼Œæ¨¡å‹è¶Šæ¥è¿‘çœŸå®æ³›åŒ–èƒ½åŠ›ã€‚</li>
</ul>
<h3 data-id="heading-6">åå·®-æ–¹å·®ä¸ VC ç»´çš„è”ç³»</h3>
<ul>
<li>VC ç»´å¤§ â†’ æ¨¡å‹å¤æ‚åº¦é«˜ â†’ åå·®å°ä½†æ–¹å·®å¤§ â†’ å®¹æ˜“è¿‡æ‹Ÿåˆã€‚</li>
<li>VC ç»´å° â†’ æ¨¡å‹å¤æ‚åº¦ä½ â†’ åå·®å¤§ä½†æ–¹å·®å° â†’ å®¹æ˜“æ¬ æ‹Ÿåˆã€‚</li>
<li>è¿™ä¸ åå·®-æ–¹å·®æƒè¡¡ æ˜¯ä¸€è‡´çš„ã€‚</li>
</ul>
<h3 data-id="heading-7">åœ¨æœºå™¨å­¦ä¹ ä¸­çš„åº”ç”¨</h3>
<ol>
<li>æ¨¡å‹å¤æ‚åº¦çš„é‡åŒ–</li>
</ol>
<p>VC ç»´æ˜¯è¡¡é‡å‡è®¾ç©ºé—´å¤æ‚åº¦çš„ç†è®ºæŒ‡æ ‡ã€‚</p>
<ul>
<li>é«˜ VC ç»´ â†’ æ¨¡å‹èƒ½è¡¨ç¤ºæ›´å¤æ‚çš„æ¨¡å¼ï¼Œä½†éœ€è¦æ›´å¤šæ ·æœ¬ã€‚</li>
<li>ä½ VC ç»´ â†’ æ³›åŒ–èƒ½åŠ›å·®ï¼Œéš¾ä»¥æ•æ‰å¤æ‚æ¨¡å¼ã€‚</li>
</ul>
<ol start="2">
<li>æ ·æœ¬å¤æ‚åº¦ï¼ˆSample Complexityï¼‰</li>
</ol>
<p>è‹¥å‡è®¾ç©ºé—´ VC ç»´ä¸º hï¼Œè¦ä¿è¯æ³›åŒ–è¯¯å·® Ïµä¸”ç½®ä¿¡åº¦ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ’</mo><mi>Î´</mi></mrow><annotation encoding="application/x-tex">1âˆ’Î´</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.03785em;">Î´</span></span></span></span></span>ï¼Œæ‰€éœ€æ ·æœ¬æ•°é‡çº§ä¸ºï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>O</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>h</mi><mo>+</mo><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>Î´</mi><mo stretchy="false">)</mo></mrow><msup><mi>Ïµ</mi><mn>2</mn></msup></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">m = O\left(\frac{h + \log(1/\delta)}{\epsilon^2}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ïµ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mopen mtight">(</span><span class="mord mtight">1/</span><span class="mord mathnormal mtight" style="margin-right:0.03785em;">Î´</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></p>
<ol start="3">
<li>æ¨¡å‹é€‰æ‹©</li>
</ol>
<p>VC ç»´å¯ä»¥ä½œä¸ºæ¨¡å‹é€‰æ‹©çš„ç†è®ºå‚è€ƒï¼Œå¸®åŠ©é¿å…è¿‡æ‹Ÿåˆæˆ–æ¬ æ‹Ÿåˆã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹å°±æ˜¯VC ç»´ å®šä¹‰äº†ä¸€ä¸ªå‡è®¾ç±»èƒ½å¤Ÿæ‰“æ•£çš„æœ€å¤§æ ·æœ¬ç‚¹æ•°ï¼Œæ˜¯è¡¡é‡æ¨¡å‹å¤æ‚åº¦çš„é‡è¦æŒ‡æ ‡ã€‚æ³›åŒ–è¯¯å·®å¯ä»¥åˆ†è§£ä¸º ç»éªŒè¯¯å·® + å¤æ‚åº¦æƒ©ç½šé¡¹ï¼ŒVC ç»´ç›´æ¥å½±å“å¤æ‚åº¦æƒ©ç½šçš„å¤§å°ã€‚VC ç†è®ºä¸ºæœºå™¨å­¦ä¹ æä¾›äº†æ³›åŒ–ä¿è¯ï¼Œå¹¶è§£é‡Šäº†ä¸ºä»€ä¹ˆéœ€è¦è¶³å¤Ÿå¤šçš„æ•°æ®æ¥æ”¯æ’‘å¤æ‚æ¨¡å‹çš„è®­ç»ƒã€‚</p>
<h2 data-id="heading-8">PAC å­¦ä¹ </h2>
<p>PAC å­¦ä¹ ï¼ˆProbably Approximately Correct Learningï¼Œæ¦‚ç‡è¿‘ä¼¼æ­£ç¡®å­¦ä¹ ï¼‰æ˜¯ç»Ÿè®¡å­¦ä¹ ç†è®ºçš„æ ¸å¿ƒæ¦‚å¿µï¼Œç”± Valiant (1984) æå‡ºï¼Œç”¨äºä¸¥æ ¼å®šä¹‰â€œå­¦ä¹ æ˜¯å¦å¯èƒ½â€ã€‚å®ƒå›ç­”äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šåœ¨æœ‰é™æ•°æ®å’Œæœ‰é™è®¡ç®—èµ„æºä¸‹ï¼Œä¸€ä¸ªå­¦ä¹ ç®—æ³•èƒ½å¦å­¦åˆ°æ¥è¿‘çœŸå®çš„æ¨¡å‹ï¼Ÿ</p>
<h3 data-id="heading-9">PAC å­¦ä¹ çš„æ ¸å¿ƒæ€æƒ³</h3>
<p>PAC æ¡†æ¶çš„ç›®æ ‡æ˜¯ï¼š</p>
<ul>
<li>å­¦ä¹ ç®—æ³•ä»æœ‰é™æ ·æœ¬ä¸­è®­ç»ƒå‡ºä¸€ä¸ªå‡è®¾ hã€‚</li>
<li>è¿™ä¸ªå‡è®¾åœ¨æœªæ¥æ•°æ®ä¸Šçš„è¡¨ç°ï¼ˆæ³›åŒ–èƒ½åŠ›ï¼‰æ¥è¿‘æœ€ä¼˜ã€‚</li>
<li>ä¿è¯è¿™ç§æ¥è¿‘æœ€ä¼˜çš„æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡éå¸¸é«˜ã€‚</li>
</ul>
<p>æ¢å¥è¯è¯´ï¼ŒPAC å­¦ä¹ è¦æ±‚ç®—æ³•è¾“å‡ºçš„æ¨¡å‹æ˜¯ï¼š</p>
<ul>
<li>Approximately Correctï¼ˆè¿‘ä¼¼æ­£ç¡®ï¼‰ï¼šé¢„æµ‹è¯¯å·®ä¸è¶…è¿‡ä¸€ä¸ªå¾ˆå°çš„<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex"> Ïµ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">Ïµ</span></span></span></span></span>ã€‚</li>
<li>Probablyï¼ˆé«˜æ¦‚ç‡ï¼‰ï¼šä¸Šè¿°ç»“æœå‘ç”Ÿçš„æ¦‚ç‡è‡³å°‘ä¸º<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>âˆ’</mo><mi>Î´</mi></mrow><annotation encoding="application/x-tex"> 1âˆ’Î´</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"/><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.6944em;"/><span class="mord mathnormal" style="margin-right:0.03785em;">Î´</span></span></span></span></span>ã€‚</li>
</ul>
<h3 data-id="heading-10">PAC å­¦ä¹ çš„æ•°å­¦å®šä¹‰</h3>
<p>è®¾ï¼š</p>
<ul>
<li>è¾“å…¥ç©ºé—´ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></span>ï¼Œè¾“å‡ºæ ‡ç­¾ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{0,1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"/><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord">1</span></span></span></span></span></span>ã€‚</li>
<li>æ•°æ®æ ·æœ¬ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span> æ¥è‡ªåˆ†å¸ƒ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span>ã€‚</li>
<li>ç›®æ ‡å‡½æ•°ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span>ï¼Œå‡è®¾ç©ºé—´ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span>ã€‚</li>
<li>å­¦ä¹ ç®—æ³•è¾“å‡ºå‡è®¾ä¸º <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>âˆˆ</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">hâˆˆH</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"/><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span>ã€‚</li>
<li>æ³›åŒ–è¯¯å·®ï¼ˆçœŸå®é£é™©ï¼‰ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mrow><mi>Pr</mi><mo>â¡</mo></mrow><mrow><mi>x</mi><mo>âˆ¼</mo><mi mathvariant="script">D</mi></mrow></msub><mo stretchy="false">[</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo mathvariant="normal">â‰ </mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">R(h) = \Pr_{x \sim \mathcal{D}}[h(x) \neq f(x)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mop"><span class="mop">Pr</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">âˆ¼</span><span class="mord mathcal mtight" style="margin-right:0.02778em;">D</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span/></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="inner"><span class="mord"><span class="mrel">î€ </span></span></span><span class="fix"/></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)]</span></span></span></span></span></li>
</ul>
<p>å¦‚æœå¯¹äºä»»æ„ Ïµ,Î´âˆˆ(0,1)ï¼Œå­¦ä¹ ç®—æ³•èƒ½åœ¨å¤šé¡¹å¼æ•°é‡çš„æ ·æœ¬å’Œæ—¶é—´å†…ï¼Œæ‰¾åˆ°æ»¡è¶³R(h)â‰¤Ïµçš„å‡è®¾ï¼Œå¹¶ä¸”è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡è‡³å°‘ä¸º1âˆ’Î´ï¼Œåˆ™ç§°å‡è®¾ç±» Hæ˜¯ PAC å¯å­¦ä¹ çš„ã€‚</p>
<h3 data-id="heading-11">è§£é‡Š</h3>
<p>PAC æ¡†æ¶å‘Šè¯‰æˆ‘ä»¬ï¼š</p>
<ol>
<li>Ïµæ§åˆ¶â€œå­¦ä¹ æœ‰å¤šå‡†â€ï¼š</li>
</ol>
<p>è¶Šå°ä»£è¡¨æ¨¡å‹è¶Šæ¥è¿‘çœŸå®ç›®æ ‡å‡½æ•°ã€‚</p>
<ol start="2">
<li>1âˆ’Î´æ§åˆ¶â€œå­¦ä¹ æœ‰å¤šç¨³â€ï¼š</li>
</ol>
<p>1âˆ’Î´æ˜¯ç½®ä¿¡åº¦ï¼Œè¡¨ç¤ºè¿™ç§è¿‘ä¼¼æ­£ç¡®ç»“æœå‘ç”Ÿçš„æ¦‚ç‡ã€‚</p>
<ol start="3">
<li>æ ·æœ¬å¤æ‚åº¦ï¼š</li>
</ol>
<ul>
<li>ä¸ºäº†è¾¾åˆ° PAC å­¦ä¹ ç›®æ ‡ï¼Œæ‰€éœ€æ ·æœ¬æ•°é‡ä¾èµ–äºå‡è®¾ç©ºé—´å¤æ‚åº¦å’Œå‚æ•° (Ïµ,Î´)ã€‚</li>
<li>è‹¥å‡è®¾ç©ºé—´ VC ç»´ä¸ºhï¼Œåˆ™æ‰€éœ€æ ·æœ¬æ•°ä¸ºï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>O</mi><mrow><mo fence="true">(</mo><mfrac><mrow><mi>h</mi><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>Ïµ</mi><mo stretchy="false">)</mo><mo>+</mo><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>Î´</mi><mo stretchy="false">)</mo></mrow><mi>Ïµ</mi></mfrac><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">m = O\left(\frac{h \log(1/\epsilon) + \log(1/\delta)}{\epsilon}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.8em;vertical-align:-0.65em;"/><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mspace" style="margin-right:0.1667em;"/><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mopen nulldelimiter"/><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">Ïµ</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"/><span class="frac-line" style="border-bottom-width:0.04em;"/></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mspace mtight" style="margin-right:0.1952em;"/><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mopen mtight">(</span><span class="mord mtight">1/</span><span class="mord mathnormal mtight">Ïµ</span><span class="mclose mtight">)</span><span class="mbin mtight">+</span><span class="mop mtight"><span class="mtight">l</span><span class="mtight">o</span><span class="mtight" style="margin-right:0.01389em;">g</span></span><span class="mopen mtight">(</span><span class="mord mtight">1/</span><span class="mord mathnormal mtight" style="margin-right:0.03785em;">Î´</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span/></span></span></span></span><span class="mclose nulldelimiter"/></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span></span></span></span></li>
</ul>
<h3 data-id="heading-12">PAC å­¦ä¹ çš„ä¸¤ç§è®¾å®š</h3>
<p>å®ç°å‹ PAC å­¦ä¹ ï¼ˆRealizable Caseï¼‰</p>
<ul>
<li>å‡è®¾å­˜åœ¨ä¸€ä¸ªçœŸå®çš„ç›®æ ‡å‡½æ•° <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>âˆˆ</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">fâˆˆH</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"/><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span>ã€‚</li>
<li>ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸ f æ¥è¿‘çš„å‡è®¾ hã€‚</li>
<li>å¸¸ç”¨äºç†è®ºåˆ†æã€‚</li>
</ul>
<p>ä¸å¯å®ç°å‹ PAC å­¦ä¹ ï¼ˆAgnostic PACï¼‰</p>
<ul>
<li>ç°å®ä¸­ç›®æ ‡å‡½æ•°æœªå¿…åœ¨å‡è®¾ç©ºé—´ <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"/><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span> å†…ã€‚</li>
<li>ç›®æ ‡æ”¹ä¸ºæ‰¾åˆ°ä¸€ä¸ªå‡è®¾ï¼Œä½¿å…¶è¯¯å·®æ¥è¿‘ H ä¸­æœ€ä¼˜å‡è®¾çš„è¯¯å·®ï¼š<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>â‰¤</mo><msub><mrow><mi>min</mi><mo>â¡</mo></mrow><mrow><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>âˆˆ</mo><mi mathvariant="script">H</mi></mrow></msub><mi>R</mi><mo stretchy="false">(</mo><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">)</mo><mo>+</mo><mi>Ïµ</mi></mrow><annotation encoding="application/x-tex">R(h) \leq \min_{h' \in \mathcal{H}} R(h') + \epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"/><span class="mrel">â‰¤</span><span class="mspace" style="margin-right:0.2778em;"/></span><span class="base"><span class="strut" style="height:1.0019em;vertical-align:-0.25em;"/><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em;"><span style="top:-2.786em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"/><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mrel mtight">âˆˆ</span><span class="mord mathcal mtight" style="margin-right:0.00965em;">H</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.1774em;"><span/></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"/><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"/><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"/><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"/></span><span class="base"><span class="strut" style="height:0.4306em;"/><span class="mord mathnormal">Ïµ</span></span></span></span></span></li>
<li>æ›´ç¬¦åˆçœŸå®æœºå™¨å­¦ä¹ åœºæ™¯ã€‚</li>
</ul>
<h3 data-id="heading-13">PAC å­¦ä¹ çš„æ„ä¹‰</h3>
<ol>
<li>ç†è®ºä¿è¯ï¼šæä¾›äº†åˆ¤æ–­æŸä¸ªå‡è®¾ç±»èƒ½å¦å­¦å¥½çš„æ•°å­¦æ ‡å‡†ã€‚</li>
<li>æ ·æœ¬å¤æ‚åº¦ï¼šè§£é‡Šäº†ä¸ºä»€ä¹ˆæ›´å¤æ‚çš„æ¨¡å‹éœ€è¦æ›´å¤šæ•°æ®ã€‚</li>
<li>æ³›åŒ–èƒ½åŠ›ï¼šæ­ç¤ºäº†ä¸ºä»€ä¹ˆç»éªŒè¯¯å·®å°å¹¶ä¸ç­‰äºæ³›åŒ–è¯¯å·®å°ã€‚</li>
<li>ä¸ VC ç»´çš„å…³ç³»ï¼š</li>
</ol>
<ul>
<li>æœ‰é™ VC ç»´ â‡” PAC å¯å­¦ä¹ ã€‚</li>
<li>è¿™æ˜¯ç»Ÿè®¡å­¦ä¹ ç†è®ºä¸­çš„ä¸€ä¸ªæ ¸å¿ƒå®šç†ã€‚</li>
</ul>
<p>ç¤ºä¾‹</p>
<ul>
<li>ä¸€ç»´é˜ˆå€¼åˆ†ç±»å™¨ï¼šVC ç»´ä¸º 2ï¼Œå› æ­¤æ˜¯ PAC å¯å­¦ä¹ çš„ï¼Œä¸”æ‰€éœ€æ ·æœ¬æ•°è¾ƒå°‘ã€‚</li>
<li>äºŒç»´çº¿æ€§åˆ†ç±»å™¨ï¼šVC ç»´ä¸º 3ï¼Œä¹Ÿå¯ PAC å­¦ä¹ ã€‚</li>
<li>ç¥ç»ç½‘ç»œï¼šå‡è®¾ç©ºé—´å¤æ‚åº¦æé«˜ï¼ŒVC ç»´å·¨å¤§ï¼Œä½†åœ¨è¶³å¤Ÿå¤šæ ·æœ¬ä¸‹ä¹Ÿæ»¡è¶³ PAC æ¡†æ¶ã€‚</li>
</ul>
<p>æœ€æ–°çš„æ–‡ç« éƒ½åœ¨å…¬ä¼—å·aicotingæ›´æ–°ï¼Œåˆ«å¿˜è®°å…³æ³¨å“¦ï¼ï¼ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æˆ‘æ˜¯å¦‚ä½•åœ¨2025å¹´é›¶åŸºç¡€å¼€å¯â€œæ°›å›´ç¼–ç¨‹â€çš„]]></title>    <link>https://juejin.cn/post/7593254419078381608</link>    <guid>https://juejin.cn/post/7593254419078381608</guid>    <pubDate>2026-01-10T09:53:58.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593254419078381608" data-draft-id="7593262196844019764" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æˆ‘æ˜¯å¦‚ä½•åœ¨2025å¹´é›¶åŸºç¡€å¼€å¯â€œæ°›å›´ç¼–ç¨‹â€çš„"/> <meta itemprop="keywords" content="VibeCoding"/> <meta itemprop="datePublished" content="2026-01-10T09:53:58.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="bytebeats"/> <meta itemprop="url" content="https://juejin.cn/user/463698667655"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æˆ‘æ˜¯å¦‚ä½•åœ¨2025å¹´é›¶åŸºç¡€å¼€å¯â€œæ°›å›´ç¼–ç¨‹â€çš„
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/463698667655/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    bytebeats
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T09:53:58.000Z" title="Sat Jan 10 2026 09:53:58 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">åœ¨ 2025 å¹´, æˆ‘å€ŸåŠ©å€ŸåŠ©ç»ˆæè°·æ­ŒAntigravityæŒ‡å—, é›¶åŸºç¡€å¼€å¯äº†â€œæ°›å›´ç¼–ç¨‹â€ä¹‹æ—…. æ¢ç´¢Gemini + Claude Codeå·¥ä½œæµæ˜¯å¦‚ä½•è¶…è¶Šæ ‡å‡†ChatGPTçš„, ä»¥è‡³æ— éœ€ç¼–å†™ä»»ä½•ä»£ç å³å¯æ„å»ºçœŸå®åº”ç”¨å·¥å…·.</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cdd0a6fcb6ef4a8e94b00f70a5854321~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZWJlYXRz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768643637&amp;x-signature=uAQSE4eP%2FmCzWyiuHqH1Jr%2B56Ac%3D" alt="Vibe coding is a new approach to programming where you collaborate with AI to build software using plain language." loading="lazy"/></p>
<p>æ°›å›´ç¼–ç¨‹æ˜¯ä¸€ç§æ–°å‹ç¼–ç¨‹æ–¹å¼, é€šè¿‡ä¸AIåä½œä½¿ç”¨è‡ªç„¶è¯­è¨€æ„å»ºè½¯ä»¶.</p>
<p><em>ç¤¾äº¤åª’ä½“æ­£è¢«â€œæ°›å›´ç¼–ç¨‹â€é£æ½®å¸­å·â€”â€”äººä»¬æ— éœ€äº²è‡ªç¼–å†™ä»£ç , å°±èƒ½åˆ›å»ºå¤æ‚ä»ªè¡¨ç›˜, å®ç”¨å·¥å…·åŠç›ˆåˆ©æ€§å…¨åŠŸèƒ½åº”ç”¨.</em></p>
<p>è‹¥ä½ è¢«ä¿¡æ¯æ´ªæµæ·¹æ²¡, è¯·ä¸å¿…æ‹…å¿§. å…¶æ“ä½œæµç¨‹å‡ºä¹æ„æ–™åœ°ç®€å•.</p>
<p>æˆ‘æµ‹è¯•è¿‡ä¼—å¤šå·¥ä½œæµ, å¯¹äºé›¶åŸºç¡€ç”¨æˆ·, è¿™å¥—<strong>æ€æ‰‹çº§ç»„åˆ</strong>å ªç§°æ™ºèƒ½ç¼–ç¨‹çš„ç»ˆææ–¹æ¡ˆ: å®ƒèåˆäº†<strong>Gemini 3 Pro</strong>çš„è§„åˆ’èƒ½åŠ›ä¸<strong>Claude Code</strong>çš„æ‰§è¡ŒåŠ›, å¹¶å…¨éƒ¨éƒ¨ç½²åœ¨è°·æ­Œçš„<strong>Antigravity</strong>å¹³å°ä¸Š.</p>
<blockquote>
<p>ç›®æ ‡:è®©é›¶ç¼–ç¨‹åŸºç¡€è€…ä¹Ÿèƒ½é€šè¿‡è‡ªç„¶è¯­è¨€æ„å»ºæœºå™¨äºº, å·¥å…·æˆ–SaaSäº§å“.</p>
</blockquote>
<h2 data-id="heading-1">ç¬¬ä¸€éƒ¨åˆ†: ç¯å¢ƒæ­å»º</h2>
<h2 data-id="heading-2">1. å®‰è£…Google Antigravity</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d10c87a1f87a4238ab2d11de4e63082f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZWJlYXRz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768643637&amp;x-signature=sLRbcOMqPLBGHQTwBBo0q5A8ACY%3D" alt="" loading="lazy"/></p>
<p>Google Antigravity SS</p>
<p><strong>ä¸‹è½½åœ°å€:</strong> Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fantigravity.google%2Fdownload" target="_blank" title="https://antigravity.google/download" ref="nofollow noopener noreferrer">antigravity.google/download</a></p>
<p>Antigravityæ˜¯æ ¸å¿ƒåŸºç¡€. æŠ€æœ¯ä¸Šå®ƒå±äº<strong>IDE</strong>, ä½†å®é™…æ›´åƒä¸€ä¸ª<strong>æ™ºèƒ½å·¥ä½œç©ºé—´</strong>.</p>
<p>ä¸åŒäºä¼ ç»Ÿä»£ç ç¼–è¾‘å™¨(å¦‚VS Codeæˆ–Cursor), Antigravityä¸“ä¸ºè‡ªç„¶è¯­è¨€äº¤äº’è®¾è®¡. ä½ å¯ç”¨æ™®é€šè‹±è¯­ä¸AIå¯¹è¯, å®ƒå°†åœ¨åå°å¤„ç†æ–‡ä»¶ç®¡ç†å’Œæ‰§è¡Œä»»åŠ¡. ç›®å‰è¿™æ˜¯éæŠ€æœ¯åˆ›ä½œè€…æœ€å‹å¥½çš„å…¥é—¨å…¥å£.</p>
<h2 data-id="heading-3">2. é€šè¿‡Claude Codeå®ç°åŠŸèƒ½å‡çº§</h2>
<p>è™½ç„¶Antigravityè‡ªå¸¦Gemini, ä½†é›†æˆ<strong>Claude Code</strong>èƒ½å°†èƒ½åŠ›æå‡åˆ°å…¨æ–°é«˜åº¦.</p>
<p><strong>ä»€ä¹ˆæ˜¯Claude Code?</strong> è¿™æ˜¯é©»ç•™åœ¨ç»ˆç«¯çš„æ™ºèƒ½ç¼–ç åŠ©æ‰‹. ä¸åŒäºæ ‡å‡†ç½‘é¡µç«¯LLM, Claude Codeèƒ½è‡ªä¸»æ‰§è¡Œå·¥ç¨‹ä»»åŠ¡, ç®¡ç†æœ¬åœ°æ–‡ä»¶, é…ç½®æ•°æ®åº“, å¤„ç†èº«ä»½éªŒè¯åŠè°ƒç”¨API.</p>
<p><strong>å®‰è£…æ­¥éª¤:</strong></p>
<ol>
<li>æ‰“å¼€Antigravity.</li>
<li>è¿›å…¥å·¦ä¾§æ çš„<strong>æ‰©å±•</strong>é€‰é¡¹å¡.</li>
<li>æœç´¢ <strong>â€œClaude Code for VS Codeâ€</strong> å¹¶å®‰è£….</li>
</ol>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bb33cbc359bc409a893ea4701ff0629c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgYnl0ZWJlYXRz:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768643637&amp;x-signature=RgCiYgyyP%2FKwCzQHedjJggrjcOs%3D" alt="" loading="lazy"/></p>
<p>å¢å¼ºç‰ˆSS: Antigravityé›†æˆClaude Code for VS Codeçš„ç•Œé¢</p>
<ul>
<li><em>æ³¨æ„: ç”±äºAntigravityä¸VS Codeç”Ÿæ€å…¼å®¹, è¯¥æ‰©å±•å¯æ— ç¼è¿è¡Œ.</em></li>
</ul>
<h2 data-id="heading-4">3. åˆå§‹åŒ–é¡¹ç›®</h2>
<ol>
<li>ç‚¹å‡» <strong>æ‰“å¼€æ–‡ä»¶å¤¹</strong> å¹¶é€‰æ‹©(æˆ–åˆ›å»º)å­˜æ”¾é¡¹ç›®æ–‡ä»¶çš„ç›®å½•.</li>
<li>æ‰“å¼€ç»ˆç«¯(åˆ‡æ¢åº•éƒ¨é¢æ¿, æŸ¥æ‰¾ç»ˆç«¯å›¾æ ‡, æˆ–ä½¿ç”¨å¿«æ·é”® Ctrl + `).</li>
<li>è¾“å…¥ <code>Claude</code> å¹¶æŒ‰ä¸‹ <strong>Enter</strong>.</li>
<li>æŒ‰æç¤ºç™»å½•(éœ€è®¢é˜… Claude Pro æœåŠ¡).</li>
</ol>
<p>å½“å‘½ä»¤è¡Œç•Œé¢(CLI)æ˜¾ç¤ºClaudeæ ‡è¯†å, å³å¯å¼€å§‹æ„å»º.</p>
<h2 data-id="heading-5">ç¬¬äºŒéƒ¨åˆ†: å·¥ä½œæµ(è§„åˆ’è€… vs æ‰§è¡Œè€…)</h2>
<p>ä¸ºé«˜æ•ˆæ„å»ºä¸“ä¸šçº§è½¯ä»¶, ä½ å°†é‡‡ç”¨åŒAIå·¥ä½œæµ. è¯¥æ¨¡å¼å¤åˆ»çœŸå®å·¥ç¨‹å›¢é˜Ÿæ¶æ„: <strong>æ¶æ„å¸ˆ</strong>(Gemini)ä¸<strong>å·¥ç¨‹å¸ˆ</strong>(Claude).</p>
<h2 data-id="heading-6">æ¶æ„å¸ˆ: Gemini 3 Pro</h2>
<p>ä½äºAntigravityç•Œé¢å³ä¾§çš„Geminiæ‹…ä»»<strong>è§„åˆ’å¸ˆ</strong>è§’è‰².</p>
<ul>
<li><strong>èŒè´£:</strong> é«˜å±‚çº§é€»è¾‘è®¾è®¡, éœ€æ±‚æ”¶é›†åŠåˆ¶å®šå®æ–½æ–¹æ¡ˆ.</li>
<li><strong>æ¨¡å‹:</strong> ä½¿ç”¨<strong>Gemini 3 Pro (High)</strong>. è¯¥æ¨¡å‹æ¨ç†èƒ½åŠ›å“è¶Š, ä¸”å…³é”®çš„æ˜¯ä¸æ¶ˆè€—Claudeç§¯åˆ†.</li>
</ul>
<h2 data-id="heading-7">å·¥ç¨‹å¸ˆ: Claude Code</h2>
<p>ä½äºåº•éƒ¨ç»ˆç«¯åŒºåŸŸ.</p>
<ul>
<li><strong>èŒè´£:</strong> æ‰§è¡Œè®¡åˆ’, ç¼–å†™å®é™…ä»£ç , è°ƒè¯•åŠè¿è¡Œåº”ç”¨ç¨‹åº.</li>
</ul>
<h2 data-id="heading-8">ç¬¬ä¸‰éƒ¨åˆ†: æ„å»ºæŒ‡å—(åˆ†æ­¥æ“ä½œ)</h2>
<p>éµå¾ªæ­¤å¾ªç¯å°†åˆ›æ„è½¬åŒ–ä¸ºå¯è¿è¡Œåº”ç”¨:</p>
<h2 data-id="heading-9">æ­¥éª¤1: è“å›¾è§„åˆ’(Gemini)</h2>
<p>åœ¨Geminiå¯¹è¯æ¡†(å³ä¾§é¢æ¿)ä¸­ç¼–å†™è¯¦ç»†æç¤ºè¯´æ˜åº”ç”¨éœ€æ±‚, åŒ…å«:</p>
<ul>
<li>æ ¸å¿ƒåŠŸèƒ½ä¸ç‰¹æ€§.</li>
<li>ç‰¹å®šAPIæ¥å£, æ–‡æ¡£é“¾æ¥æˆ–è®¾è®¡åå¥½.</li>
<li><strong>å…³é”®æŒ‡ä»¤:</strong> è¦æ±‚Geminiåœ¨æ–°æ–‡ä»¶å¤¹å†…ç”Ÿæˆ<strong>è¯¦ç»†å®æ–½è®¡åˆ’</strong>. æ˜ç¡®å£°æ˜: <em>â€œè¯·å‹¿ç¼–å†™ä»£ç . åˆ›å»ºå¯ä¾›Claude Codeè¯»å–å¹¶æ‰§è¡Œçš„åˆ†æ­¥ä»»åŠ¡æ¸…å•ä¸æ¶æ„æ–¹æ¡ˆ. â€</em></li>
</ul>
<h2 data-id="heading-10">æ­¥éª¤äºŒ: æ‰§è¡Œé˜¶æ®µ(Claude)</h2>
<p>åˆ‡æ¢è‡³ç»ˆç«¯(åº•éƒ¨é¢æ¿)å¹¶å‘Claudeå‘å‡ºæŒ‡ä»¤:</p>
<blockquote>
<p><em>â€œå˜¿Claude, æŸ¥é˜…Geminiåˆ›å»ºçš„æ–‡ä»¶å¤¹ä¸­çš„å®æ–½è®¡åˆ’. é˜…è¯»ç†è§£éœ€æ±‚å, æŒ‰æ­¥éª¤æ‰§è¡Œä»£ç .â€</em></p>
</blockquote>
<p>Claudeå°†ä½œä¸ºè‡ªä¸»æ‰§è¡Œè€…: é…ç½®ç¯å¢ƒ, ç¼–å†™æ–‡ä»¶å¹¶å¯åŠ¨æœåŠ¡å™¨.</p>
<h2 data-id="heading-11">æ­¥éª¤ä¸‰: è¿­ä»£ä¸æˆæœ¬ç®¡ç†</h2>
<p><strong>Claude Code</strong>åŠŸèƒ½å¼ºå¤§ä½†æ¶ˆè€—ä¿¡ç”¨ç‚¹. ä¸ºä¼˜åŒ–å·¥ä½œæµç¨‹å¹¶èŠ‚çœå¼€æ”¯:</p>
<ul>
<li><strong>å¤æ‚é€»è¾‘å¤„ç†:</strong> ä½¿ç”¨Claude. è‹¥éœ€æ”¯ä»˜å¤„ç†, æ•°æ®åº“è¿æ¥æˆ–èº«ä»½éªŒè¯ç³»ç»Ÿ, äº¤ç”±Claudeå¤„ç†.</li>
<li><strong>å¤„ç†ç®€å•ä¿®æ”¹:</strong> ä½¿ç”¨Gemini. è‹¥éœ€è°ƒæ•´é¢œè‰², æ›´æ–°æ–‡æœ¬æˆ–æ·»åŠ åŸºç¡€è¾“å…¥, å¯è®©Geminiç¼–å†™ä»£ç .</li>
<li><strong>ä»£ç äº¤æ¥:</strong> å¯è¦æ±‚Geminiç¼–å†™ç‰¹å®šä»£ç å—å¹¶å°†å…¶ä½œä¸ºæ³¨é‡Šæ·»åŠ è‡³æ–‡ä»¶, éšåå‘ŠçŸ¥Claude: <em>â€œåº”ç”¨æ³¨é‡Šä¸­çš„ä¿®æ”¹å†…å®¹.â€</em></li>
</ul>
<h2 data-id="heading-12">æ€»ç»“</h2>
<p>ä½ ç°æ‹¥æœ‰ä¸¤æ¬¾ååŒè¿ä½œçš„é«˜çº§AI: ä¸€è€…è´Ÿè´£æ€è€ƒè§„åˆ’, å¦ä¸€è€…ä¸“å¸ç¼–ç æ„å»º.</p>
<p>å³ä¾¿é‡åˆ°é”™è¯¯, è¯¥ç»„åˆé€šå¸¸å¯é€šè¿‡ç®€å•æŒ‡ä»¤å®ç°è‡ªæˆ‘ä¿®æ­£, ä¾‹å¦‚: <em>â€œä¿®å¤ä½ åˆšé‡åˆ°çš„é”™è¯¯.â€</em></p>
<p>å¥½å§, ä»Šå¤©çš„å†…å®¹å°±åˆ†äº«åˆ°è¿™é‡Œå•¦!</p>
<p>ä¸€å®¶ä¹‹è¨€, æ¬¢è¿æ‹ç –!</p>
<p>Happy coding! Stay GOLDEN!</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ31ï¼‰Hibernateçš„åŸç”ŸSQLæŸ¥è¯¢æ˜¯ä»€ä¹ˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7593165280488833065</link>    <guid>https://juejin.cn/post/7593165280488833065</guid>    <pubDate>2026-01-09T13:47:44.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593165280488833065" data-draft-id="7593098101432795190" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ31ï¼‰Hibernateçš„åŸç”ŸSQLæŸ¥è¯¢æ˜¯ä»€ä¹ˆï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-09T13:47:44.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ31ï¼‰Hibernateçš„åŸç”ŸSQLæŸ¥è¯¢æ˜¯ä»€ä¹ˆï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T13:47:44.000Z" title="Fri Jan 09 2026 13:47:44 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    8
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">Hibernateçš„åŸç”ŸSQLæŸ¥è¯¢</h3>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒHQLï¼ˆHibernate Query Languageï¼‰æˆ–Criteria APIå¯èƒ½æ— æ³•æ»¡è¶³å¤æ‚æŸ¥è¯¢çš„éœ€è¦ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢ï¼ˆNative SQL Queryï¼‰ã€‚åŸç”ŸSQLæŸ¥è¯¢å…è®¸å¼€å‘è€…ç›´æ¥ç¼–å†™SQLè¯­å¥ï¼Œå¹¶é€šè¿‡Hibernateæ‰§è¡Œè¿™äº›è¯­å¥ï¼Œå°†ç»“æœæ˜ å°„ä¸ºå®ä½“ç±»æˆ–è‡ªå®šä¹‰ç»“æœé›†ã€‚</p>
<h3 data-id="heading-1">ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢</h3>
<p>åŸç”ŸSQLæŸ¥è¯¢ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ol>
<li><strong>å®ä½“æŸ¥è¯¢</strong>ï¼šè¿”å›å®ä½“å¯¹è±¡ã€‚</li>
<li><strong>éå®ä½“æŸ¥è¯¢</strong>ï¼šè¿”å›è‡ªå®šä¹‰å¯¹è±¡æˆ–æŠ•å½±ç»“æœã€‚</li>
</ol>
<h3 data-id="heading-2">ç¤ºä¾‹ä»£ç </h3>
<h4 data-id="heading-3">å®ä½“ç±»å®šä¹‰</h4>
<p>æˆ‘ä»¬å°†å®šä¹‰ä¸¤ä¸ªå®ä½“ç±»ï¼š<code>Person</code> å’Œ <code>Address</code>ã€‚</p>
<h5 data-id="heading-4">Personç±»</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "person")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {

    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@Column(name = "age")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
    }

    <span class="hljs-comment">// Getters å’Œ Setters</span>

    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> age;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.age = age;
    }
}
</code></pre>
<h5 data-id="heading-5">Addressç±»</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "address")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span> {

    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "street")</span>
    <span class="hljs-keyword">private</span> String street;

    <span class="hljs-meta">@ManyToOne</span>
    <span class="hljs-meta">@JoinColumn(name = "person_id", nullable = false)</span>
    <span class="hljs-keyword">private</span> Person person;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Address</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Address</span><span class="hljs-params">(String street, Person person)</span> {
        <span class="hljs-built_in">this</span>.street = street;
        <span class="hljs-built_in">this</span>.person = person;
    }

    <span class="hljs-comment">// Getters å’Œ Setters</span>

    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getStreet</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> street;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setStreet</span><span class="hljs-params">(String street)</span> {
        <span class="hljs-built_in">this</span>.street = street;
    }

    <span class="hljs-keyword">public</span> Person <span class="hljs-title function_">getPerson</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> person;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPerson</span><span class="hljs-params">(Person person)</span> {
        <span class="hljs-built_in">this</span>.person = person;
    }
}
</code></pre>
<h4 data-id="heading-6">Hibernateé…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.format_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Person"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Address"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-7">HibernateUtilç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateUtil</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä»é…ç½®æ–‡ä»¶åˆ›å»ºSessionFactory</span>
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            <span class="hljs-comment">// è®°å½•å¯åŠ¨å¤±è´¥çš„é”™è¯¯</span>
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SessionFactory <span class="hljs-title function_">getSessionFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sessionFactory;
    }
}
</code></pre>
<h3 data-id="heading-8">ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢ç¤ºä¾‹</h3>
<h4 data-id="heading-9">æ’å…¥ç¤ºä¾‹æ•°æ®</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateInsertData</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// æ’å…¥ç¤ºä¾‹æ•°æ®</span>
        insertSampleData(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertSampleData</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Person</span> <span class="hljs-variable">person1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"John Doe"</span>, <span class="hljs-number">30</span>);
            <span class="hljs-type">Person</span> <span class="hljs-variable">person2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Jane Doe"</span>, <span class="hljs-number">28</span>);

            session.save(person1);
            session.save(person2);
            transaction.commit();
            System.out.println(<span class="hljs-string">"Inserted sample data"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-10">ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢</h4>
<h5 data-id="heading-11">æŸ¥è¯¢æ‰€æœ‰Personè®°å½•</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.query.NativeQuery;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateNativeQueryExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢æ‰€æœ‰Personè®°å½•</span>
        queryAllPersons(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">queryAllPersons</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT * FROM person"</span>;
            NativeQuery&lt;Person&gt; query = session.createNativeQuery(sql, Person.class);
            List&lt;Person&gt; persons = query.getResultList();
            System.out.println(<span class="hljs-string">"Query all persons:"</span>);
            <span class="hljs-keyword">for</span> (Person person : persons) {
                System.out.println(person.getName() + <span class="hljs-string">" - "</span> + person.getAge());
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
<h5 data-id="heading-12">ä½¿ç”¨æŠ•å½±æŸ¥è¯¢è¿”å›è‡ªå®šä¹‰ç»“æœ</h5>
<p>å‡è®¾æˆ‘ä»¬åªæƒ³æŸ¥è¯¢Personçš„å§“åå’Œå¹´é¾„ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå®ä½“ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨æŠ•å½±æŸ¥è¯¢ï¼ˆProjection Queryï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.query.NativeQuery;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateProjectionQueryExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// ä½¿ç”¨åŸç”ŸSQLæŠ•å½±æŸ¥è¯¢</span>
        queryPersonNameAndAge(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">queryPersonNameAndAge</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT name, age FROM person"</span>;
            NativeQuery&lt;Object[]&gt; query = session.createNativeQuery(sql);
            List&lt;Object[]&gt; results = query.getResultList();
            System.out.println(<span class="hljs-string">"Query person name and age:"</span>);
            <span class="hljs-keyword">for</span> (Object[] row : results) {
                <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> (String) row[<span class="hljs-number">0</span>];
                <span class="hljs-type">Integer</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> (Integer) row[<span class="hljs-number">1</span>];
                System.out.println(name + <span class="hljs-string">" - "</span> + age);
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-13">åŸç”ŸSQLæŸ¥è¯¢è¯¦ç»†è§£é‡Š</h3>
<ol>
<li>
<p><strong>æ’å…¥ç¤ºä¾‹æ•°æ®</strong>ï¼šå‘æ•°æ®åº“ä¸­æ’å…¥ä¸¤ä¸ª<code>Person</code>å¯¹è±¡ä¾›æŸ¥è¯¢ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateInsertData</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// æ’å…¥ç¤ºä¾‹æ•°æ®</span>
        insertSampleData(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertSampleData</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Person</span> <span class="hljs-variable">person1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"John Doe"</span>, <span class="hljs-number">30</span>);
            <span class="hljs-type">Person</span> <span class="hljs-variable">person2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Jane Doe"</span>, <span class="hljs-number">28</span>);

            session.save(person1);
            session.save(person2);
            transaction.commit();
            System.out.println(<span class="hljs-string">"Inserted sample data"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
</li>
<li>
<p><strong>æŸ¥è¯¢æ‰€æœ‰Personè®°å½•</strong>ï¼šä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢æ‰€æœ‰Personè®°å½•å¹¶æ˜ å°„ä¸º<code>Person</code>å®ä½“ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateNativeQueryExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢æ‰€æœ‰Personè®°å½•</span>
        queryAllPersons(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
</code></pre>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flinkæºç é˜…è¯»ï¼šNettyé€šä¿¡]]></title>    <link>https://juejin.cn/post/7593164154631815177</link>    <guid>https://juejin.cn/post/7593164154631815177</guid>    <pubDate>2026-01-09T12:13:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593164154631815177" data-draft-id="7593164154631798793" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flinkæºç é˜…è¯»ï¼šNettyé€šä¿¡"/> <meta itemprop="keywords" content="Flink,å¤§æ•°æ®"/> <meta itemprop="datePublished" content="2026-01-09T12:13:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¢å‘Googleç¼–ç¨‹"/> <meta itemprop="url" content="https://juejin.cn/user/1063982986695374"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flinkæºç é˜…è¯»ï¼šNettyé€šä¿¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1063982986695374/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¢å‘Googleç¼–ç¨‹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T12:13:27.000Z" title="Fri Jan 09 2026 12:13:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>å‰æ–‡ä¸­æˆ‘ä»¬äº†è§£äº† Flink çš„æ•°æ®äº¤äº’è¿‡ç¨‹ï¼Œä¸Šæ¸¸çš„ Task å°†æ•°æ®å†™å…¥åˆ° ResultSubpartition çš„ buffers é˜Ÿåˆ—ä¸­ã€‚ä¸‹æ¸¸çš„ Task é€šè¿‡ LocalInputChannel å’Œ RemoteInputChannel æ¶ˆè´¹ä¸Šæ¸¸çš„æ•°æ®ã€‚</p>
<p>LocalInputChannel æ˜¯ä¸Šä¸‹æ¸¸çš„ Task éƒ¨ç½²åœ¨åŒä¸€ä¸ª TaskManager æ—¶ä½¿ç”¨çš„ï¼Œåœ¨æœ¬åœ°å³å¯å®Œæˆæ•°æ®äº¤æ¢ï¼Œæ— éœ€ç½‘ç»œé€šä¿¡ã€‚å½“ä¸Šä¸‹æ¸¸çš„ Task éƒ¨ç½²åœ¨ä¸åŒçš„ TaskManager æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ° RemoteInputChannelï¼ŒFlink åˆ©ç”¨ Netty æ¥è¿›è¡Œæ•°æ®äº¤äº’ã€‚æœ¬æ–‡æˆ‘ä»¬æ¥ä¸€èµ·æ¢³ç†ä¸€ä¸‹ Netty ç›¸å…³çš„æºç ã€‚</p>
<h3 data-id="heading-0">åˆå§‹åŒ–</h3>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ NettyServer å’Œ NettyClient çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0ba4706fbb604cc5884638aaad02c95b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2i5ZCRR29vZ2xl57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768565606&amp;x-signature=ro8kY7ZVGC%2BQRjha4Mu06IgMWMI%3D" alt="NettyInit" loading="lazy"/></p>
<p>Netty çš„åˆå§‹åŒ–é˜¶æ®µæ˜¯åœ¨ TaskManager å¯åŠ¨çš„è¿‡ç¨‹ä¸­æ‰§è¡Œçš„ã€‚åœ¨ <code>TaskManagerServices.fromConfiguration</code> æ–¹æ³•ä¸­ï¼Œä¼šåˆ›å»ºå¹¶å¯åŠ¨ ShuffleEnvironmentã€‚</p>
<pre><code class="hljs language-php" lang="php"><span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> TaskManagerServices <span class="hljs-title function_ invoke__">fromConfiguration</span>(
        TaskManagerServicesConfiguration taskManagerServicesConfiguration,
        PermanentBlobService permanentBlobService,
        MetricGroup taskManagerMetricGroup,
        ExecutorService ioExecutor,
        ScheduledExecutor scheduledExecutor,
        FatalErrorHandler fatalErrorHandler,
        WorkingDirectory workingDirectory)
        throws <span class="hljs-built_in">Exception</span> {
    ...

    <span class="hljs-keyword">final</span> ShuffleEnvironment<span class="hljs-meta">&lt;?</span>, <span class="hljs-meta">?&gt;</span> shuffleEnvironment =
            <span class="hljs-title function_ invoke__">createShuffleEnvironment</span>(
                    taskManagerServicesConfiguration,
                    taskEventDispatcher,
                    taskManagerMetricGroup,
                    ioExecutor,
                    scheduledExecutor);
    <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> listeningDataPort = shuffleEnvironment.<span class="hljs-title function_ invoke__">start</span>();
    ...
}
</code></pre>
<p>æˆ‘ä»¬é¡ºç€è°ƒç”¨é“¾è·¯å¯ä»¥ä¸€ç›´æ‰¾åˆ° <code>NettyShuffleServiceFactory.createNettyShuffleEnvironment</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­åˆ›å»ºäº† NettyConnectionManagerï¼Œåœ¨ NettyConnectionManager ä¸­æœ‰å‡ ä¸ªå¾ˆé‡è¦çš„å¯¹è±¡ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">public NettyConnectionManager(
        NettyBufferPool bufferPool,
        ResultPartitionProvider partitionProvider,
        TaskEventPublisher taskEventPublisher,
        NettyConfig nettyConfig,
        boolean connectionReuseEnabled) {

    <span class="hljs-attr">this.server</span> = new NettyServer(nettyConfig)<span class="hljs-comment">;</span>
    <span class="hljs-attr">this.client</span> = new NettyClient(nettyConfig)<span class="hljs-comment">;</span>
    <span class="hljs-attr">this.bufferPool</span> = checkNotNull(bufferPool)<span class="hljs-comment">;</span>

    <span class="hljs-attr">this.partitionRequestClientFactory</span> =
            new PartitionRequestClientFactory(
                    client, nettyConfig.getNetworkRetries(), connectionReuseEnabled)<span class="hljs-comment">;</span>

    <span class="hljs-attr">this.nettyProtocol</span> =
            new NettyProtocol(
                    checkNotNull(partitionProvider), checkNotNull(taskEventPublisher))<span class="hljs-comment">;</span>
}
</code></pre>
<p>server å’Œ client ä¸éœ€è¦å¤šä»‹ç»ï¼Œå°±æ˜¯ Netty çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚bufferPool æ˜¯ç¼“å†²æ± ï¼Œç”¨äºå­˜å‚¨è¦ä¼ è¾“çš„æ•°æ®ã€‚nettyProtocol æä¾›äº† NettyClient å’Œ NettyServer å¼•å¯¼å¯åŠ¨æ³¨å†Œçš„ Channel Handlerã€‚</p>
<p>åé¢å°±æ˜¯åˆ›å»º NettyShuffleEnvironment åŠå…¶éœ€è¦çš„å¯¹è±¡äº†ã€‚åœ¨åˆ›å»ºå®Œæˆåï¼Œä¼šè°ƒç”¨å®ƒçš„ start æ–¹æ³•å¯åŠ¨ã€‚è¿™ä¸ªå¯åŠ¨æ–¹æ³•å°±æ˜¯è°ƒç”¨äº† <code>connectionManager.start</code>ï¼Œåœ¨ NettyConnectionManager ä¸­ï¼Œå°±æ˜¯åˆå§‹åŒ–å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">int</span> <span class="hljs-title">start</span>() throws IOException</span> {
    client.<span class="hljs-keyword">init</span>(nettyProtocol, bufferPool);

    <span class="hljs-keyword">return</span> server.<span class="hljs-keyword">init</span>(nettyProtocol, bufferPool);
}
</code></pre>
<h4 data-id="heading-1">client åˆå§‹åŒ–</h4>
<p>client çš„åˆå§‹åŒ–è¿‡ç¨‹æ˜¯å…ˆåˆ›å»ºå¹¶åˆå§‹åŒ– Bootstrapã€‚</p>
<pre><code class="hljs language-scss" lang="scss">private void <span class="hljs-built_in">initEpollBootstrap</span>() {
    <span class="hljs-comment">// Add the server port number to the name in order to distinguish</span>
    <span class="hljs-comment">// multiple clients running on the same host.</span>
    String name =
            NettyConfig<span class="hljs-selector-class">.CLIENT_THREAD_GROUP_NAME</span> + " (" + config.getServerPortRange() + ")";

    EpollEventLoopGroup epollGroup =
            new <span class="hljs-built_in">EpollEventLoopGroup</span>(
                    config.getClientNumThreads(), NettyServer<span class="hljs-selector-class">.getNamedThreadFactory</span>(name));
    bootstrap<span class="hljs-selector-class">.group</span>(epollGroup)<span class="hljs-selector-class">.channel</span>(EpollSocketChannel.class);

    config<span class="hljs-selector-class">.getTcpKeepIdleInSeconds</span>()
            <span class="hljs-selector-class">.ifPresent</span>(idle -&gt; bootstrap.option(EpollChannelOption.TCP_KEEPIDLE, idle));
    config<span class="hljs-selector-class">.getTcpKeepInternalInSeconds</span>()
            <span class="hljs-selector-class">.ifPresent</span>(
                    interval -&gt; bootstrap.option(EpollChannelOption.TCP_KEEPINTVL, interval));
    config<span class="hljs-selector-class">.getTcpKeepCount</span>()
            <span class="hljs-selector-class">.ifPresent</span>(count -&gt; bootstrap.option(EpollChannelOption.TCP_KEEPCNT, count));
}
</code></pre>
<p>åˆå§‹åŒ–è¿‡ç¨‹é‡è¦è®¾ç½® EventLoopGroup å’Œ channelï¼Œå¯ä»¥ç”¨ epoll çš„è¯å°±ç”¨ epollï¼Œå¦åˆ™å°±ç”¨ nioã€‚è®¾ç½®å¥½è¿™äº›åå°±æ˜¯è®¾ç½®äº†ä¸€äº›é€šé“å‚æ•°ï¼ˆè¿æ¥è¶…æ—¶æ—¶é—´ã€Bufffer æ± ç­‰ï¼‰ã€‚</p>
<p>åˆ°è¿™é‡Œ client çš„åˆå§‹åŒ–å…¶å®å¹¶æ²¡æœ‰ç»“æŸï¼Œè¿˜éœ€è¦è®¾ç½® Handler æµæ°´çº¿ï¼Œè¿™äº›å·¥ä½œæ˜¯åœ¨ Task å¯åŠ¨æ—¶æ‰§è¡Œäº†ã€‚</p>
<h4 data-id="heading-2">server åˆå§‹åŒ–</h4>
<p>server çš„åˆå§‹åŒ–è¿‡ç¨‹æ˜¯å…ˆåˆ›å»ºå¹¶åˆå§‹åŒ–äº† ServerBootstrapã€‚ä¹‹ååŒæ ·ä¹Ÿæ˜¯è®¾ç½® EventLoopGroup å’Œ channelï¼Œä»¥åŠé€šé“ç›¸å…³çš„å„ç§å‚æ•°ã€‚</p>
<p>è®¾ç½®å¥½ä¹‹åï¼Œä¼šæ·»åŠ  ChannelHandler æµæ°´çº¿ï¼Œè¿™é‡Œçš„ ChannelHandler æµæ°´çº¿å°±æ˜¯æˆ‘ä»¬å‰é¢åˆ›å»ºçš„ NettyProtocol æä¾›çš„ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">public ChannelHandler<span class="hljs-section">[]</span> getServerChannelHandlers() {
    PartitionRequestQueue <span class="hljs-attr">queueOfPartitionQueues</span> = new PartitionRequestQueue()<span class="hljs-comment">;</span>
    PartitionRequestServerHandler <span class="hljs-attr">serverHandler</span> =
            new PartitionRequestServerHandler(
                    partitionProvider, taskEventPublisher, queueOfPartitionQueues)<span class="hljs-comment">;</span>

    return new ChannelHandler<span class="hljs-section">[]</span> {
        messageEncoder,
        new NettyMessage.NettyMessageDecoder(),
        serverHandler,
        queueOfPartitionQueues
    }<span class="hljs-comment">;</span>
}
</code></pre>
<p>æµæ°´çº¿ä¸ŠåŒ…å«äº†æ¶ˆæ¯ç¼–ç å™¨ã€è§£ç å™¨ã€PartitionRequestServerHandler è¯·æ±‚æœåŠ¡ç«¯å¤„ç†å™¨å’Œ PartitionRequestQueue åˆ†åŒºè¯·æ±‚é˜Ÿåˆ—ã€‚</p>
<p>è¿™äº›éƒ½è®¾ç½®å¥½ä¹‹åï¼Œå°±å¼€å§‹å¯åŠ¨ NettyServer æœåŠ¡äº†ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">Iterator&lt;Integer&gt; portsIterator = config<span class="hljs-selector-class">.getServerPortRange</span>()<span class="hljs-selector-class">.getPortsIterator</span>();
while (portsIterator.hasNext() &amp;&amp; bindFuture == null) {
    Integer port = portsIterator<span class="hljs-selector-class">.next</span>();
    LOG<span class="hljs-selector-class">.debug</span>("Trying to bind Netty server to port: {}", port);

    bootstrap<span class="hljs-selector-class">.localAddress</span>(config.getServerAddress(), port);
    try {
        bindFuture = bootstrap<span class="hljs-selector-class">.bind</span>()<span class="hljs-selector-class">.syncUninterruptibly</span>();
    } catch (Exception e) {
        <span class="hljs-comment">// syncUninterruptibly() throws checked exceptions via Unsafe</span>
        <span class="hljs-comment">// continue if the exception is due to the port being in use, fail early</span>
        <span class="hljs-comment">// otherwise</span>
        if (isBindFailure(e)) {
            LOG<span class="hljs-selector-class">.debug</span>("Failed to bind Netty server", e);
        } else {
            throw e;
        }
    }
}

if (bindFuture == null) {
    throw new <span class="hljs-built_in">BindException</span>(
            "Could not start rest endpoint on any port in port range "
                    + config.getServerPortRange());
}

localAddress = (InetSocketAddress) bindFuture<span class="hljs-selector-class">.channel</span>()<span class="hljs-selector-class">.localAddress</span>();
</code></pre>
<h3 data-id="heading-3">å®¢æˆ·ç«¯è¯·æ±‚è¿œç«¯å­åˆ†åŒº</h3>
<p>æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åˆå§‹åŒ–ä¹‹åï¼Œåœ¨ Task è¿è¡Œæ—¶ï¼Œä¼šå…ˆå®Œæˆ Client çš„ ChannelHandler çš„é…ç½®ï¼Œç„¶åè¯·æ±‚ Netty è¿œç«¯æœåŠ¡ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b99d38c65200487f8f5f1d7e05cc2b36~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2i5ZCRR29vZ2xl57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768565606&amp;x-signature=7ig7BNFyUGozffh2yuryKQkj%2FHo%3D" alt="NettyRequestPartition" loading="lazy"/></p>
<p>æˆ‘ä»¬æ¥çœ‹å…·ä½“è¿‡ç¨‹ï¼Œåœ¨ Task åˆå§‹åŒ–æ—¶ï¼Œä¼šè°ƒç”¨ <code>StreamTask.invoke</code> æ–¹æ³•ï¼Œå…¶å†…éƒ¨ä¼šè°ƒç”¨ <code>StreamTask.restoreStateAndGate</code> æ–¹æ³•ï¼Œè¿™é‡Œä¼šä¾¿åˆ© Task çš„æ‰€æœ‰ InputGateï¼Œç„¶åè°ƒç”¨ requestPartitionsã€‚åœ¨ InputGate çš„ requestPartitions é€»è¾‘ä¸­ï¼Œåˆä¾¿åˆ©æ‰€æœ‰çš„ InputChannelï¼Œè°ƒç”¨ requestSubpartitionsã€‚</p>
<pre><code class="hljs language-scss" lang="scss">for (InputGate inputGate : inputGates) {
    recoveredFutures<span class="hljs-selector-class">.add</span>(inputGate.getStateConsumedFuture());

    inputGate
            <span class="hljs-selector-class">.getStateConsumedFuture</span>()
            <span class="hljs-selector-class">.thenRun</span>(
                    () -&gt;
                            mainMailboxExecutor<span class="hljs-selector-class">.execute</span>(
                                    inputGate::requestPartitions,
                                    "Input gate request partitions"));
}


private void <span class="hljs-built_in">internalRequestPartitions</span>() {
    for (InputChannel inputChannel : inputChannels()) {
        try {
            inputChannel<span class="hljs-selector-class">.requestSubpartitions</span>();
        } catch (Throwable t) {
            inputChannel<span class="hljs-selector-class">.setError</span>(t);
            return;
        }
    }
}
</code></pre>
<p>æˆ‘ä»¬æ¥çœ‹ <code>RemoteInputChannel.requestSubpartitions</code> çš„é€»è¾‘ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">requestSubpartitions</span>() throws IOException, InterruptedException</span> {
    <span class="hljs-keyword">if</span> (partitionRequestClient == <span class="hljs-literal">null</span>) {
        LOG.debug(
                <span class="hljs-string">"{}: Requesting REMOTE subpartitions {} of partition {}. {}"</span>,
                <span class="hljs-keyword">this</span>,
                consumedSubpartitionIndexSet,
                partitionId,
                channelStatePersister);
        <span class="hljs-comment">// Create a client and request the partition</span>
        <span class="hljs-keyword">try</span> {
            partitionRequestClient =
                    connectionManager.createPartitionRequestClient(connectionId);
        } <span class="hljs-keyword">catch</span> (IOException e) {
            <span class="hljs-comment">// IOExceptions indicate that we could not open a connection to the remote</span>
            <span class="hljs-comment">// TaskExecutor</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> PartitionConnectionException(partitionId, e);
        }

        partitionRequestClient.requestSubpartition(
                partitionId, consumedSubpartitionIndexSet, <span class="hljs-keyword">this</span>, <span class="hljs-number">0</span>);
    }
}
</code></pre>
<p>è¿™é‡Œä¸»è¦æœ‰ä¸¤ä¸ªæ­¥éª¤ï¼Œå…ˆæ˜¯åˆ›å»º partitionRequestClientï¼Œç„¶åè°ƒç”¨ requestSubpartitionã€‚</p>
<h4 data-id="heading-4">åˆ›å»ºè¯·æ±‚å®¢æˆ·ç«¯</h4>
<p>PartitionRequestClient æ˜¯åœ¨ <code>PartitionRequestClientFactory.connect</code> ä¸­åˆ›å»ºçš„ã€‚å…ˆè°ƒç”¨äº† <code>NettyClient.connect</code>ï¼ŒåŒæ­¥ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šè¿›è¡Œ ChannelHandler é…ç½®ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ä»‹ç»çš„ï¼ŒNettyClient æ²¡æœ‰å®Œæˆçš„æ­¥éª¤ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">public ChannelHandler<span class="hljs-selector-attr">[]</span> <span class="hljs-built_in">getClientChannelHandlers</span>() {
    NetworkClientHandler networkClientHandler = new <span class="hljs-built_in">CreditBasedPartitionRequestClientHandler</span>();

    return new ChannelHandler<span class="hljs-selector-attr">[]</span> {
        messageEncoder,
        new <span class="hljs-built_in">NettyMessageClientDecoderDelegate</span>(networkClientHandler),
        networkClientHandler
    };
}
</code></pre>
<p>Handler åŒ…æ‹¬äº†æ¶ˆæ¯ç¼–ç å™¨ã€è§£ç å™¨å’Œ CreditBasedPartitionRequestClientHandler è¿™ä¸ªåŸºäº Credit çš„åˆ†åŒºè¯·æ±‚å®¢æˆ·ç«¯å¤„ç†å™¨ã€‚Handler é…ç½®å¥½ä¹‹åä¼šåˆ©ç”¨ bootstrap è¿æ¥åˆ°æœåŠ¡ç«¯ã€‚</p>
<p>åœ¨è·å–åˆ° Channel å’Œ NetworkClientHandler ä¹‹åï¼Œå°±ç›´æ¥åˆ›å»ºäº† NettyPartitionRequestClientã€‚</p>
<h4 data-id="heading-5">è¯·æ±‚å­åˆ†åŒºæ•°æ®</h4>
<p>è®©æˆ‘ä»¬å†å›åˆ° RemoteInputChannel çš„ requestSubpartitions æ–¹æ³•ä¸­ï¼Œç°åœ¨æˆ‘ä»¬åˆ›å»ºå¥½äº† NettyPartitionRequestClientï¼Œæ¥ä¸‹æ¥å°±æ˜¯è°ƒç”¨å®ƒçš„ requestSubpartition æ–¹æ³•æ¥å‘èµ·è¯·æ±‚ã€‚</p>
<p>è¿™é‡Œé€»è¾‘ä¹Ÿæ¯”è¾ƒç®€å•ï¼š</p>
<ol>
<li>å‘ NetworkClientHandler æ³¨å†Œå½“å‰ RemoteInputChannelã€‚</li>
<li>æ„é€ è¯·æ±‚å¯¹è±¡ PartitionRequestï¼Œè¿™é‡ŒåŒ…å«äº†åˆ†åŒº IDã€å­åˆ†åŒºç´¢å¼•ã€inputChannel ID ä»¥åŠåˆè¯†çš„ Creditã€‚</li>
<li>è°ƒç”¨ <code>tcpChannel.writeAndFlush</code> å‘èµ·è¯·æ±‚ï¼Œå¹¶æ·»åŠ è¯·æ±‚å¤±è´¥çš„ç›‘å¬ã€‚</li>
<li>å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œç§»é™¤å½“å‰ inputChannelã€‚</li>
</ol>
<h3 data-id="heading-6">æœåŠ¡ç«¯å“åº”</h3>
<p>ç°åœ¨æ•°æ®åˆ°äº†æœåŠ¡ç«¯ï¼Œæˆ‘ä»¬æ¥çœ‹æœåŠ¡ç«¯å¤„ç†çš„å…·ä½“è¿‡ç¨‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/339a67c8d7c64865bc109c665e60c60c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2i5ZCRR29vZ2xl57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768565606&amp;x-signature=xpUm9gskdJn323LGxtvTmcAThSc%3D" alt="NettyServerHandler" loading="lazy"/></p>
<p>åœ¨ NettyServer åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ªé‡è¦çš„ Handlerï¼Œåˆ†åˆ«æ˜¯ PartitionRequestServerHandler å’Œ PartitionRequestQueueã€‚æœåŠ¡ç«¯å“åº”æ•°æ®çš„è¿‡ç¨‹å°±æ˜¯è¿™ä¸¤ä¸ª Handler åœ¨å‘æŒ¥ä½œç”¨ã€‚</p>
<p>PartitionRequestServerHandler è´Ÿè´£å¤„ç† Client ç«¯é€šè¿‡ PartitionRequestClient å‘é€çš„è¯·æ±‚ï¼Œå¤„ç†è¿‡ç¨‹æ˜¯å…ˆåˆ›å»º CreditBasedSequenceNumberingViewReader ç±»å‹çš„ readerï¼Œç„¶åå°†å®ƒæ”¾å…¥ PartitionRequestQueue ç»´æŠ¤çš„ reader é˜Ÿåˆ—ä¸­ã€‚PartitionRequestQueue ä¼šç›‘å¬ Netty Channel çš„å¯å†™å…¥çŠ¶æ€ï¼Œå½“ Netty Channel å¯å†™å…¥æ—¶ï¼Œä¼šæ¶ˆè´¹æ•°æ®å¹¶å†™å…¥ç½‘ç»œã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹å…·ä½“çš„æºç ã€‚</p>
<p>æœåŠ¡ç«¯çš„å“åº”å…¥å£åœ¨ <code>PartitionRequestServerHandler.channelRead0</code> æ–¹æ³•ï¼Œè¿™é‡Œåœ¨å¤„ç† PartitionRequest è¯·æ±‚æ—¶ï¼Œå…ˆæ˜¯åˆ›å»º CreditBasedSequenceNumberingViewReaderï¼Œç„¶åè°ƒç”¨ requestSubpartitionViewOrRegisterListenerã€‚</p>
<p>requestSubpartitionViewOrRegisterListener çš„é€»è¾‘æ˜¯åˆ›å»º ResultSubpartitionViewï¼Œå¹¶æé†’ PartitionRequestQueue æœ‰æ•°æ®å¯ç”¨ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">Optional&lt;ResultSubpartitionView&gt; <span class="hljs-attr">subpartitionViewOptional</span> =
        partitionProvider.createSubpartitionViewOrRegisterListener(
                resultPartitionId,
                subpartitionIndexSet,
                this,
                partitionRequestListener)<span class="hljs-comment">;</span>
...

notifyDataAvailable(subpartitionView)<span class="hljs-comment">;</span>
</code></pre>
<p>ResultSubpartitionView å°±æ˜¯ç”¨æ¥æ¶ˆè´¹ ResultSubpartition çš„æ•°æ®ã€‚</p>
<p>notifyDataAvailable å†…éƒ¨è°ƒç”¨äº† notifyReaderNonEmptyï¼ŒnotifyReaderNonEmpty åˆè§¦å‘äº† userEventTriggeredï¼Œè¿™é‡Œè°ƒç”¨ enqueueAvailableReader å°† reader æ”¾å…¥åˆ°å¯ç”¨é˜Ÿåˆ— availableReaders ä¸­ã€‚</p>
<pre><code class="hljs language-scss" lang="scss">private void <span class="hljs-built_in">enqueueAvailableReader</span>(final NetworkSequenceViewReader reader) throws Exception {
    if (reader.isRegisteredAsAvailable()) {
        return;
    }

    ResultSubpartitionView<span class="hljs-selector-class">.AvailabilityWithBacklog</span> availabilityWithBacklog =
            reader<span class="hljs-selector-class">.getAvailabilityAndBacklog</span>();
    if (!availabilityWithBacklog.isAvailable()) {
        int backlog = availabilityWithBacklog<span class="hljs-selector-class">.getBacklog</span>();
        if (backlog &gt; <span class="hljs-number">0</span> &amp;&amp; reader.needAnnounceBacklog()) {
            <span class="hljs-built_in">announceBacklog</span>(reader, backlog);
        }
        return;
    }

    <span class="hljs-comment">// Queue an available reader for consumption. If the queue is empty,</span>
    <span class="hljs-comment">// we try trigger the actual write. Otherwise this will be handled by</span>
    <span class="hljs-comment">// the writeAndFlushNextMessageIfPossible calls.</span>
    boolean triggerWrite = availableReaders<span class="hljs-selector-class">.isEmpty</span>();
    <span class="hljs-built_in">registerAvailableReader</span>(reader);

    if (triggerWrite) {
        <span class="hljs-built_in">writeAndFlushNextMessageIfPossible</span>(ctx.channel());
    }
}
</code></pre>
<p>å¦‚æœ reader æ˜¯é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¼šè§¦å‘æ•°æ®å†™å…¥ç½‘ç»œã€‚</p>
<p>writeAndFlushNextMessageIfPossible çš„å¤„ç†æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å–å‡ºå¯ç”¨ readerã€‚</li>
<li>è°ƒç”¨ <code>reader.getNextBuffer</code> è·å–æ•°æ®ã€‚</li>
<li>å¦‚æœ reader ä»ç„¶å¯ç”¨ï¼Œå°†å…¶åŠ å›é˜Ÿåˆ—ã€‚</li>
<li>å‘ä¸‹æ¸¸å†™å…¥æ•°æ®å¹¶æ·»åŠ ä¸‹æ¬¡å†™å…¥çš„ç›‘å¬ã€‚</li>
</ol>

<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> BufferAndAvailability <span class="hljs-title function_">getNextBuffer</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException {
    <span class="hljs-type">BufferAndBacklog</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> subpartitionView.getNextBuffer();
    <span class="hljs-keyword">if</span> (next != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">if</span> (next.buffer().isBuffer() &amp;&amp; --numCreditsAvailable &lt; <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>(<span class="hljs-string">"no credit available"</span>);
        }

        <span class="hljs-keyword">final</span> Buffer.<span class="hljs-type">DataType</span> <span class="hljs-variable">nextDataType</span> <span class="hljs-operator">=</span> getNextDataType(next);
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferAndAvailability</span>(
                next.buffer(), nextDataType, next.buffersInBacklog(), next.getSequenceNumber());
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
}
</code></pre>
<p>åœ¨ getNextBuffer æ–¹æ³•ä¸­ï¼Œä¼šå°† credit å€¼å‡ 1ï¼Œå¹¶åˆ¤æ–­æ˜¯å¦å°äº 0ã€‚å¦‚æœå°äº 0 ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œreader æ˜¯å¦å¯ç”¨ä¹Ÿæ˜¯æ ¹æ® numCreditsAvailable æ˜¯å¦å¤§äº 0 æ¥åˆ¤æ–­çš„ã€‚</p>
<h3 data-id="heading-7">å®¢æˆ·ç«¯æ¥æ”¶æ•°æ®</h3>
<p>NettyClient åœ¨æ¶ˆè´¹æ•°æ®æ—¶ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä»¥ ChannelHandler ä½œä¸ºå…¥å£ã€‚è¿™é‡Œçš„å…¥å£æ–¹æ³•æ˜¯ <code>CreditBasedPartitionRequestClientHandler.channelRead</code> ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e3e211ea7d445e8a040cfd2e5bac1dd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2i5ZCRR29vZ2xl57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768565606&amp;x-signature=QzLjqwFQqFXMQxN4wlfezdFTli4%3D" alt="NettyClientHandler" loading="lazy"/></p>
<p>åœ¨ decodeMsg æ–¹æ³•ä¸­ï¼Œå…ˆè§£ç  msgï¼Œåˆ¤æ–­ InputChannel æ˜¯å¦å¯ç”¨ï¼Œå¦‚æœä¸å¯ç”¨ï¼Œåˆ™å–æ¶ˆå½“å‰ InputChannel çš„è®¢é˜…ã€‚å¦‚æœå¯ç”¨ï¼Œç»§ç»­è°ƒç”¨ decodeBufferOrEvent è¿›è¡Œå¤„ç†ã€‚decodeBufferOrEvent çš„æ ¸å¿ƒé€»è¾‘æ˜¯è°ƒç”¨ <code>RemoteInputChannel.onBuffer</code> æ–¹æ³•ï¼Œå°†æ•°æ®åŠ å…¥åˆ° receivedBuffers é˜Ÿåˆ—ã€‚</p>
<p>å¦‚æœ receivedBuffers é˜Ÿåˆ—åœ¨æ­¤ä¹‹å‰å¤„äºç©ºé—²çŠ¶æ€ï¼Œä¼šè°ƒç”¨ notifyChannelNonEmptyï¼Œå°†å½“å‰ RemoteInputChannel åŠ å…¥åˆ° inputChannelsWithData é˜Ÿåˆ—ä¸­ï¼ŒåŒæ—¶è¿˜ä¼šå”¤é†’ inputChannelsWithData ä¸Šçš„é˜»å¡çº¿ç¨‹ï¼Œè®© inputGate å¯ä»¥æ¶ˆè´¹ RemoteInputChannel çš„æ•°æ®ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">private</span> boolean <span class="hljs-title">queueChannelUnsafe</span>(<span class="hljs-params">InputChannel channel, boolean priority</span>)</span> {
    assert Thread.holdsLock(inputChannelsWithData);
    <span class="hljs-keyword">if</span> (channelsWithEndOfPartitionEvents.<span class="hljs-keyword">get</span>(channel.getChannelIndex())) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    final boolean alreadyEnqueued =
            enqueuedInputChannelsWithData.<span class="hljs-keyword">get</span>(channel.getChannelIndex());
    <span class="hljs-keyword">if</span> (alreadyEnqueued
            &amp;&amp; (!priority || inputChannelsWithData.containsPriorityElement(channel))) {
        <span class="hljs-comment">// already notified / prioritized (double notification), ignore</span>
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// å½“å‰ inputChannel åŠ å…¥åˆ° inputChannelsWithData</span>
    inputChannelsWithData.<span class="hljs-keyword">add</span>(channel, priority, alreadyEnqueued);
    <span class="hljs-keyword">if</span> (!alreadyEnqueued) {
        enqueuedInputChannelsWithData.<span class="hljs-keyword">set</span>(channel.getChannelIndex());
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-comment">// å”¤é†’çº¿ç¨‹</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">notifyDataAvailable</span>()</span> {
    availabilityMonitor.notifyAll();
    toNotify = inputGate.availabilityHelper.getUnavailableToResetAvailable();
}
</code></pre>
<p>å¦‚æœå®¢æˆ·ç«¯æœ‰ç§¯å‹ï¼Œè¿˜éœ€è¦æ ¹æ®ç§¯å‹ç”³è¯· Buffer å¹¶æ›´æ–° Credit å€¼ã€‚è¿™é‡Œç”³è¯·çš„ buffer æ•°é‡ä¸ºç§¯å‹æ•°é‡+åˆè¯† Credit å€¼ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSenderBacklog</span><span class="hljs-params">(<span class="hljs-type">int</span> backlog)</span> <span class="hljs-keyword">throws</span> IOException {
    notifyBufferAvailable(bufferManager.requestFloatingBuffers(backlog + initialCredit));
}
</code></pre>
<p>å¦‚æœ RemoteInputChannel æ²¡æœ‰è¶³å¤Ÿçš„ bufferï¼Œåˆ™ä¼šå‘ LocalBufferPool ç”³è¯·æ–°çš„ bufferï¼Œå¦‚æœç”³è¯·ä¸åˆ°ï¼Œä¼šåŠ ä¸€ä¸ªç›‘å¬ï¼Œç­‰ LocalBufferPool æœ‰ç©ºé—²æ—¶å†è§¦å‘ç”³è¯· bufferã€‚</p>
<pre><code class="hljs language-ini" lang="ini">private int tryRequestBuffers() {
    assert Thread.holdsLock(bufferQueue)<span class="hljs-comment">;</span>

    int <span class="hljs-attr">numRequestedBuffers</span> = <span class="hljs-number">0</span><span class="hljs-comment">;</span>
    while (bufferQueue.getAvailableBufferSize() &lt; numRequiredBuffers
            &amp;&amp; !isWaitingForFloatingBuffers) {
        BufferPool <span class="hljs-attr">bufferPool</span> = inputChannel.inputGate.getBufferPool()<span class="hljs-comment">;</span>
        Buffer <span class="hljs-attr">buffer</span> = bufferPool.requestBuffer()<span class="hljs-comment">;</span>
        if (buffer != null) {
            bufferQueue.addFloatingBuffer(buffer)<span class="hljs-comment">;</span>
            numRequestedBuffers++<span class="hljs-comment">;</span>
        } else if (bufferPool.addBufferListener(this)) {
            <span class="hljs-attr">isWaitingForFloatingBuffers</span> = <span class="hljs-literal">true</span><span class="hljs-comment">;</span>
            break<span class="hljs-comment">;</span>
        }
    }
    return numRequestedBuffers<span class="hljs-comment">;</span>
}
</code></pre>
<p>å½“ RemoteInputChannel ç”³è¯·åˆ°äº†éœ€è¦çš„ buffer ä¹‹åï¼Œå°±ä¼šå‘ NettyServer å‘é€ AddCredit æ¶ˆæ¯ï¼Œè¯·æ±‚æ›´æ–° Credit å€¼ã€‚</p>
<pre><code class="hljs language-csharp" lang="csharp"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">notifyCreditAvailable</span>() throws IOException</span> {
    checkPartitionRequestQueueInitialized();

    partitionRequestClient.notifyCreditAvailable(<span class="hljs-keyword">this</span>);
}


<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">notifyCreditAvailable</span>(<span class="hljs-params">RemoteInputChannel inputChannel</span>)</span> {
    sendToChannel(<span class="hljs-keyword">new</span> AddCreditMessage(inputChannel));
}
</code></pre>
<p>NettyServer æ”¶åˆ°è¯·æ±‚åï¼Œä¼šå°†å¯¹åº”çš„ Credit å€¼è¿›è¡Œæ›´æ–°ã€‚</p>
<pre><code class="hljs language-ini" lang="ini">else if (<span class="hljs-attr">msgClazz</span> == AddCredit.class) {
    AddCredit <span class="hljs-attr">request</span> = (AddCredit) msg<span class="hljs-comment">;</span>

    outboundQueue.addCreditOrResumeConsumption(
            request.receiverId, reader -&gt; reader.addCredit(request.credit))<span class="hljs-comment">;</span>
}

void addCreditOrResumeConsumption(
        InputChannelID receiverId, Consumer&lt;NetworkSequenceViewReader&gt; operation)
        throws Exception {
    if (fatalError) {
        return<span class="hljs-comment">;</span>
    }

    NetworkSequenceViewReader <span class="hljs-attr">reader</span> = obtainReader(receiverId)<span class="hljs-comment">;</span>

    operation.accept(reader)<span class="hljs-comment">;</span>
    enqueueAvailableReader(reader)<span class="hljs-comment">;</span>
}


public void addCredit(int creditDeltas) {
    numCreditsAvailable += creditDeltas<span class="hljs-comment">;</span>
}
</code></pre>
<p>æ­¤å¤–ï¼ŒFlink è¿˜æœ‰ä¸¤ç§åœºæ™¯ä¼šæ›´æ–° Credit å€¼ã€‚</p>
<p>ä¸€ç§æ˜¯ LocalBufferPool å›æ”¶ç©ºé—² buffer æ—¶ï¼Œä¼šå°† buffer åˆ†é…ç»™ç”³è¯·è€…ï¼Œåˆ†é…ä¹‹åä¼šè°ƒç”¨å¯¹åº” InputChannel çš„ notifyBufferAvailable æ–¹æ³•é€šçŸ¥æ›´æ–° Creditã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/91654d63dada40089adc39ddeaa32f16~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2i5ZCRR29vZ2xl57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768565606&amp;x-signature=%2B6Q5%2FPKgLnUQeBSJ7%2BBwQflI7Ik%3D" alt="LocalBufferPool" loading="lazy"/></p>
<p>å¦ä¸€ç§æ˜¯ RemoteInputChannel ç‹¬å çš„ buffer é˜Ÿåˆ—é‡Šæ”¾ buffer æ—¶ï¼Œä¼šè§¦å‘ Credit æ›´æ–°ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2c5cb9fddc0d4e18802107951125230b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Z2i5ZCRR29vZ2xl57yW56iL:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768565606&amp;x-signature=T4scDtDnWrMIvABCUiom8RV0bTQ%3D" alt="BufferManager" loading="lazy"/></p>
<h3 data-id="heading-8">åå‹</h3>
<p>é€šè¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å…¶å®å·²ç»ç†è§£äº†åå‹çš„æœºåˆ¶äº†ã€‚å½“å‰ Flink çš„åå‹å°±æ˜¯é€šè¿‡ Credit æ¥å®ç°åå‹çš„ï¼Œå¦‚æœä¸‹æ¸¸æ•°æ®å¤„ç†é€Ÿåº¦æ…¢ï¼ŒCredit ä¼šè¢«è€—å°½ï¼Œä¸Šæ¸¸ä¹Ÿå°±ä¸ä¼šç»§ç»­å¤„ç†å’Œä¸‹å‘æ•°æ®äº†ã€‚ç›´åˆ°ä¸‹æ¸¸å¤„ç†å®Œæˆï¼Œæœ‰äº†ç©ºé—²çš„ bufferï¼Œæ­¤æ—¶å‘ä¸Šæ¸¸åé¦ˆæ›´æ–° Credit å€¼ï¼Œä¸Šæ¸¸å°±ä¼šç»§ç»­å¤„ç†æ•°æ®ã€‚</p>
<h3 data-id="heading-9">æ€»ç»“</h3>
<p>æœ€åæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ï¼Œæœ¬æ–‡æˆ‘ä»¬ä¸€èµ·æ¢³ç†äº† Flink Netty ç›¸å…³çš„æºç ã€‚åŒ…æ‹¬ NettyClient å’Œ NettyServer çš„åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–è¿‡ç¨‹ä¸­ä¼šåˆ›å»ºä¸€ç³»åˆ— ChannelHandlerï¼Œä¹‹ååˆ©ç”¨è¿™äº›Handler å¤„ç†æ•°æ®ï¼Œæ•°æ®å¤„ç†åŒ…æ‹¬ Client ç«¯çš„å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ï¼ŒServer ç«¯å¤„ç†æ¶ˆæ¯çš„è¿‡ç¨‹ã€‚ä¸­é—´è¿˜ç©¿æ’ç€ Credit çš„å¤„ç†ã€‚Flink çš„åå‹é€»è¾‘å°±æ˜¯ä¾èµ–äº Credit æ¥å®ç°çš„ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Hibernateï¼ˆ31ï¼‰Hibernateçš„åŸç”ŸSQLæŸ¥è¯¢æ˜¯ä»€ä¹ˆï¼Ÿ]]></title>    <link>https://juejin.cn/post/7593145583348105258</link>    <guid>https://juejin.cn/post/7593145583348105258</guid>    <pubDate>2026-01-09T13:47:01.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593145583348105258" data-draft-id="7593098101432778806" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Hibernateï¼ˆ31ï¼‰Hibernateçš„åŸç”ŸSQLæŸ¥è¯¢æ˜¯ä»€ä¹ˆï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-09T13:47:01.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Victor356"/> <meta itemprop="url" content="https://juejin.cn/user/3492507879476878"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Hibernateï¼ˆ31ï¼‰Hibernateçš„åŸç”ŸSQLæŸ¥è¯¢æ˜¯ä»€ä¹ˆï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3492507879476878/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Victor356
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T13:47:01.000Z" title="Fri Jan 09 2026 13:47:01 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    6
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">Hibernateçš„åŸç”ŸSQLæŸ¥è¯¢</h3>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒHQLï¼ˆHibernate Query Languageï¼‰æˆ–Criteria APIå¯èƒ½æ— æ³•æ»¡è¶³å¤æ‚æŸ¥è¯¢çš„éœ€è¦ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢ï¼ˆNative SQL Queryï¼‰ã€‚åŸç”ŸSQLæŸ¥è¯¢å…è®¸å¼€å‘è€…ç›´æ¥ç¼–å†™SQLè¯­å¥ï¼Œå¹¶é€šè¿‡Hibernateæ‰§è¡Œè¿™äº›è¯­å¥ï¼Œå°†ç»“æœæ˜ å°„ä¸ºå®ä½“ç±»æˆ–è‡ªå®šä¹‰ç»“æœé›†ã€‚</p>
<h3 data-id="heading-1">ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢</h3>
<p>åŸç”ŸSQLæŸ¥è¯¢ä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ol>
<li><strong>å®ä½“æŸ¥è¯¢</strong>ï¼šè¿”å›å®ä½“å¯¹è±¡ã€‚</li>
<li><strong>éå®ä½“æŸ¥è¯¢</strong>ï¼šè¿”å›è‡ªå®šä¹‰å¯¹è±¡æˆ–æŠ•å½±ç»“æœã€‚</li>
</ol>
<h3 data-id="heading-2">ç¤ºä¾‹ä»£ç </h3>
<h4 data-id="heading-3">å®ä½“ç±»å®šä¹‰</h4>
<p>æˆ‘ä»¬å°†å®šä¹‰ä¸¤ä¸ªå®ä½“ç±»ï¼š<code>Person</code> å’Œ <code>Address</code>ã€‚</p>
<h5 data-id="heading-4">Personç±»</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "person")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {

    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "name")</span>
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@Column(name = "age")</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.age = age;
    }

    <span class="hljs-comment">// Getters å’Œ Setters</span>

    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> {
        <span class="hljs-built_in">this</span>.name = name;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> age;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> {
        <span class="hljs-built_in">this</span>.age = age;
    }
}
</code></pre>
<h5 data-id="heading-5">Addressç±»</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">package</span> com.example.domain;

<span class="hljs-keyword">import</span> javax.persistence.*;

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table(name = "address")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Address</span> {

    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue(strategy = GenerationType.IDENTITY)</span>
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-meta">@Column(name = "street")</span>
    <span class="hljs-keyword">private</span> String street;

    <span class="hljs-meta">@ManyToOne</span>
    <span class="hljs-meta">@JoinColumn(name = "person_id", nullable = false)</span>
    <span class="hljs-keyword">private</span> Person person;

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Address</span><span class="hljs-params">()</span> {}

    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Address</span><span class="hljs-params">(String street, Person person)</span> {
        <span class="hljs-built_in">this</span>.street = street;
        <span class="hljs-built_in">this</span>.person = person;
    }

    <span class="hljs-comment">// Getters å’Œ Setters</span>

    <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> id;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setId</span><span class="hljs-params">(Long id)</span> {
        <span class="hljs-built_in">this</span>.id = id;
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getStreet</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> street;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setStreet</span><span class="hljs-params">(String street)</span> {
        <span class="hljs-built_in">this</span>.street = street;
    }

    <span class="hljs-keyword">public</span> Person <span class="hljs-title function_">getPerson</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> person;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPerson</span><span class="hljs-params">(Person person)</span> {
        <span class="hljs-built_in">this</span>.person = person;
    }
}
</code></pre>
<h4 data-id="heading-6">Hibernateé…ç½®æ–‡ä»¶ <code>hibernate.cfg.xml</code></h4>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">hibernate-configuration</span> <span class="hljs-keyword">PUBLIC</span>
        <span class="hljs-string">"-//Hibernate/Hibernate Configuration DTD 3.0//EN"</span>
        <span class="hljs-string">"http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">hibernate-configuration</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">session-factory</span>&gt;</span>
        <span class="hljs-comment">&lt;!-- æ•°æ®åº“è¿æ¥é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.driver_class"</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.url"</span>&gt;</span>jdbc:mysql://localhost:3306/your_database<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.username"</span>&gt;</span>your_username<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.connection.password"</span>&gt;</span>your_password<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- Hibernate å±æ€§é…ç½® --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.MySQLDialect<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.show_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.format_sql"</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span>

        <span class="hljs-comment">&lt;!-- æ˜ å°„ç±» --&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Person"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">mapping</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"com.example.domain.Address"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">session-factory</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">hibernate-configuration</span>&gt;</span>
</code></pre>
<h4 data-id="heading-7">HibernateUtilç±»</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.cfg.Configuration;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateUtil</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> SessionFactory sessionFactory;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// ä»é…ç½®æ–‡ä»¶åˆ›å»ºSessionFactory</span>
            sessionFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Configuration</span>().configure(<span class="hljs-string">"hibernate.cfg.xml"</span>).buildSessionFactory();
        } <span class="hljs-keyword">catch</span> (Throwable ex) {
            <span class="hljs-comment">// è®°å½•å¯åŠ¨å¤±è´¥çš„é”™è¯¯</span>
            System.err.println(<span class="hljs-string">"Initial SessionFactory creation failed."</span> + ex);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExceptionInInitializerError</span>(ex);
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> SessionFactory <span class="hljs-title function_">getSessionFactory</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sessionFactory;
    }
}
</code></pre>
<h3 data-id="heading-8">ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢ç¤ºä¾‹</h3>
<h4 data-id="heading-9">æ’å…¥ç¤ºä¾‹æ•°æ®</h4>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.Transaction;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateInsertData</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// æ’å…¥ç¤ºä¾‹æ•°æ®</span>
        insertSampleData(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertSampleData</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Person</span> <span class="hljs-variable">person1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"John Doe"</span>, <span class="hljs-number">30</span>);
            <span class="hljs-type">Person</span> <span class="hljs-variable">person2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Jane Doe"</span>, <span class="hljs-number">28</span>);

            session.save(person1);
            session.save(person2);
            transaction.commit();
            System.out.println(<span class="hljs-string">"Inserted sample data"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
<h4 data-id="heading-10">ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢</h4>
<h5 data-id="heading-11">æŸ¥è¯¢æ‰€æœ‰Personè®°å½•</h5>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.query.NativeQuery;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateNativeQueryExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢æ‰€æœ‰Personè®°å½•</span>
        queryAllPersons(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">queryAllPersons</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT * FROM person"</span>;
            NativeQuery&lt;Person&gt; query = session.createNativeQuery(sql, Person.class);
            List&lt;Person&gt; persons = query.getResultList();
            System.out.println(<span class="hljs-string">"Query all persons:"</span>);
            <span class="hljs-keyword">for</span> (Person person : persons) {
                System.out.println(person.getName() + <span class="hljs-string">" - "</span> + person.getAge());
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
<h5 data-id="heading-12">ä½¿ç”¨æŠ•å½±æŸ¥è¯¢è¿”å›è‡ªå®šä¹‰ç»“æœ</h5>
<p>å‡è®¾æˆ‘ä»¬åªæƒ³æŸ¥è¯¢Personçš„å§“åå’Œå¹´é¾„ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå®ä½“ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨æŠ•å½±æŸ¥è¯¢ï¼ˆProjection Queryï¼‰ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">import</span> org.hibernate.Session;
<span class="hljs-keyword">import</span> org.hibernate.SessionFactory;
<span class="hljs-keyword">import</span> org.hibernate.query.NativeQuery;

<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateProjectionQueryExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// ä½¿ç”¨åŸç”ŸSQLæŠ•å½±æŸ¥è¯¢</span>
        queryPersonNameAndAge(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">queryPersonNameAndAge</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SELECT name, age FROM person"</span>;
            NativeQuery&lt;Object[]&gt; query = session.createNativeQuery(sql);
            List&lt;Object[]&gt; results = query.getResultList();
            System.out.println(<span class="hljs-string">"Query person name and age:"</span>);
            <span class="hljs-keyword">for</span> (Object[] row : results) {
                <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> (String) row[<span class="hljs-number">0</span>];
                <span class="hljs-type">Integer</span> <span class="hljs-variable">age</span> <span class="hljs-operator">=</span> (Integer) row[<span class="hljs-number">1</span>];
                System.out.println(name + <span class="hljs-string">" - "</span> + age);
            }
        } <span class="hljs-keyword">catch</span> (Exception e) {
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
<h3 data-id="heading-13">åŸç”ŸSQLæŸ¥è¯¢è¯¦ç»†è§£é‡Š</h3>
<ol>
<li>
<p><strong>æ’å…¥ç¤ºä¾‹æ•°æ®</strong>ï¼šå‘æ•°æ®åº“ä¸­æ’å…¥ä¸¤ä¸ª<code>Person</code>å¯¹è±¡ä¾›æŸ¥è¯¢ä½¿ç”¨ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateInsertData</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// æ’å…¥ç¤ºä¾‹æ•°æ®</span>
        insertSampleData(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">insertSampleData</span><span class="hljs-params">(SessionFactory sessionFactory)</span> {
        <span class="hljs-type">Session</span> <span class="hljs-variable">session</span> <span class="hljs-operator">=</span> sessionFactory.openSession();
        <span class="hljs-type">Transaction</span> <span class="hljs-variable">transaction</span> <span class="hljs-operator">=</span> session.beginTransaction();
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">Person</span> <span class="hljs-variable">person1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"John Doe"</span>, <span class="hljs-number">30</span>);
            <span class="hljs-type">Person</span> <span class="hljs-variable">person2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">"Jane Doe"</span>, <span class="hljs-number">28</span>);

            session.save(person1);
            session.save(person2);
            transaction.commit();
            System.out.println(<span class="hljs-string">"Inserted sample data"</span>);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            <span class="hljs-keyword">if</span> (transaction != <span class="hljs-literal">null</span>) {
                transaction.rollback();
            }
            e.printStackTrace();
        } <span class="hljs-keyword">finally</span> {
            <span class="hljs-keyword">if</span> (session != <span class="hljs-literal">null</span>) {
                session.close();
            }
        }
    }
}
</code></pre>
</li>
<li>
<p><strong>æŸ¥è¯¢æ‰€æœ‰Personè®°å½•</strong>ï¼šä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢æ‰€æœ‰Personè®°å½•å¹¶æ˜ å°„ä¸º<code>Person</code>å®ä½“ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HibernateNativeQueryExample</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {
        <span class="hljs-comment">// è·å–SessionFactory</span>
        <span class="hljs-type">SessionFactory</span> <span class="hljs-variable">sessionFactory</span> <span class="hljs-operator">=</span> HibernateUtil.getSessionFactory();

        <span class="hljs-comment">// ä½¿ç”¨åŸç”ŸSQLæŸ¥è¯¢æ‰€æœ‰Personè®°å½•</span>
        queryAllPersons(sessionFactory);

        <span class="hljs-comment">// å…³é—­SessionFactory</span>
        sessionFactory.close();
</code></pre>
</li>
</ol></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SQLInsightï¼šä»JDBCåº•å±‚åˆ°APIè°ƒç”¨çš„é›¶ä¾µå…¥SQLç›‘æ§æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7593232758127280134</link>    <guid>https://juejin.cn/post/7593232758127280134</guid>    <pubDate>2026-01-10T08:25:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593232758127280134" data-draft-id="7593232758127247366" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SQLInsightï¼šä»JDBCåº•å±‚åˆ°APIè°ƒç”¨çš„é›¶ä¾µå…¥SQLç›‘æ§æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="åç«¯,æ•°æ®åº“,å¼€æº"/> <meta itemprop="datePublished" content="2026-01-10T08:25:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¸æµªæ— ç—•"/> <meta itemprop="url" content="https://juejin.cn/user/2834988091055719"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SQLInsightï¼šä»JDBCåº•å±‚åˆ°APIè°ƒç”¨çš„é›¶ä¾µå…¥SQLç›‘æ§æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2834988091055719/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¸æµªæ— ç—•
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T08:25:40.000Z" title="Sat Jan 10 2026 08:25:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»15åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fsh_wangwanbao%2Fsql-insight" target="_blank" title="https://gitee.com/sh_wangwanbao/sql-insight" ref="nofollow noopener noreferrer">gitee.com/sh_wangwanbâ€¦</a><br/>
<strong>ä¸Šä¸€ç¯‡æ–‡ç« </strong>ï¼š<a href="https://juejin.cn/post/7591513171199295551" target="_blank" title="https://juejin.cn/post/7591513171199295551">SQLInsightï¼šä¸€è¡Œä¾èµ–ï¼Œè‡ªåŠ¨è¿½è¸ªAPIèƒŒåçš„æ¯ä¸€æ¡SQL</a></p>
</blockquote>
<h2 data-id="heading-0">å¼€ç¯‡</h2>
<p>ä¸Šå‘¨å†™äº†ä¸€ç¯‡æ–‡ç« ï¼Œåˆ†äº«äº†SQLInsightçš„è®¾è®¡æ€è·¯å’ŒæŠ€æœ¯æ–¹æ¡ˆï¼Œæ²¡æƒ³åˆ°æ”¶åˆ°äº†ä¸å°‘åé¦ˆã€‚æœ‰äººé—®"å•¥æ—¶å€™èƒ½ç”¨"ï¼Œæœ‰äººé—®"æŠ€æœ¯ç»†èŠ‚æ˜¯æ€ä¹ˆå®ç°çš„"ã€‚</p>
<p>èŠ±äº†å°ä¸€å‘¨æ—¶é—´ï¼Œç»ˆäºæŠŠå®ƒå®ç°å‡ºæ¥äº†ã€‚ä»Šå¤©å‘¨æœ«ï¼Œç»ˆäºå¯ä»¥è¿˜å€ºäº†ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬æ¥èŠèŠSQLInsightçš„æŠ€æœ¯å®ç°ç»†èŠ‚ï¼šåŠ¨æ€ä»£ç†æ˜¯æ€ä¹ˆåšçš„ï¼ŸStackTraceæ˜¯æ€ä¹ˆè§£æçš„ï¼Ÿä¸ºä»€ä¹ˆè¯´é›¶ä¾µå…¥ï¼Ÿæ€§èƒ½åˆ°åº•å¦‚ä½•ï¼Ÿ</p>
<p>ä»£ç å·²ç»å¼€æºï¼Œä½ å¯ä»¥ç›´æ¥ç”¨ï¼Œä¹Ÿå¯ä»¥å­¦ä¹ å®ç°æ€è·¯ã€‚</p>
<hr/>
<h2 data-id="heading-1">ä¸€ã€æŠ€æœ¯äº®ç‚¹é€Ÿè§ˆ</h2>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆè¯´å‡ ä¸ªæ ¸å¿ƒäº®ç‚¹ï¼Œè®©ä½ çŸ¥é“è¿™ä¸ªé¡¹ç›®æœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼š</p>
<h3 data-id="heading-2">1.1 çœŸæ­£çš„é›¶ä¾µå…¥</h3>
<p>ä¸éœ€è¦åœ¨ä»£ç é‡ŒåŠ æ³¨è§£ï¼Œä¸éœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œç”šè‡³ä¸éœ€è¦åŠ å¯åŠ¨å‚æ•°ã€‚åŠ ä¸ªä¾èµ–ï¼Œå¯åŠ¨åº”ç”¨ï¼Œå°±èƒ½çœ‹åˆ°æ‰€æœ‰SQLæ‰§è¡Œæƒ…å†µã€‚è¿™æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿç­”æ¡ˆæ˜¯ï¼š<strong>åœ¨æœ€åº•å±‚åšæ‰‹è„š</strong>ã€‚</p>
<h3 data-id="heading-3">1.2 å®Œæ•´çš„è°ƒç”¨é“¾è‡ªåŠ¨è¿½è¸ª</h3>
<p>ä½ åœ¨Controllerå†™äº†ä¸ªæ¥å£ï¼Œè°ƒç”¨Serviceï¼ŒServiceè°ƒç”¨Mapperï¼Œæœ€åæ‰§è¡Œäº†SQLã€‚è¿™æ•´ä¸ªé“¾è·¯ï¼ŒSQLInsightèƒ½è‡ªåŠ¨ç»™ä½ ä¸²èµ·æ¥ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>api<span class="hljs-operator">/</span>users<span class="hljs-operator">/</span><span class="hljs-number">123</span> 
  â†’ UserController.getUser()
    â†’ UserService.findById()
      â†’ <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">123</span> (<span class="hljs-number">15</span>ms)
</code></pre>
<p>è¿™ä¸æ˜¯é AOPï¼Œä¸æ˜¯é åŸ‹ç‚¹ï¼Œè€Œæ˜¯é <strong>è¯»å–çº¿ç¨‹æ ˆ</strong>ã€‚</p>
<h3 data-id="heading-4">1.3 å…¼å®¹æ€§å¥½åˆ°è®©äººæƒŠè®¶</h3>
<p>ä¸ç®¡ä½ ç”¨çš„æ˜¯MyBatisã€JPAã€Hibernateè¿˜æ˜¯JdbcTemplateï¼Œä¸ç®¡ä½ çš„è¿æ¥æ± æ˜¯Druidã€HikariCPè¿˜æ˜¯C3P0ï¼ŒSQLInsightéƒ½èƒ½å·¥ä½œã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå®ƒä»£ç†çš„æ˜¯JDBCæ ‡å‡†æ¥å£ï¼Œä¸ä¾èµ–å…·ä½“å®ç°ã€‚</p>
<h3 data-id="heading-5">1.4 æ€§èƒ½å½±å“å¾®ä¹å…¶å¾®</h3>
<p>åŠ¨æ€ä»£ç†ï¼ŸStackTraceæ‰«æï¼Ÿè¿™ä¸ä¼šå¾ˆæ…¢å—ï¼Ÿå®æµ‹ä¸‹æ¥ï¼Œå•æ¬¡SQLæ‰§è¡Œçš„é¢å¤–å¼€é”€åœ¨<strong>1å¾®ç§’ä»¥å†…</strong>ã€‚æ€ä¹ˆåšåˆ°çš„ï¼Ÿç­”æ¡ˆæ˜¯ï¼š<strong>ç¼“å­˜ + å¼‚æ­¥ + é™åˆ¶æ‰«ææ·±åº¦</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-6">äºŒã€è®¾è®¡æ€æƒ³çš„æ¥æº</h2>
<p>åšæŠ€æœ¯ä¸æ˜¯é—­é—¨é€ è½¦ï¼ŒSQLInsightçš„æ ¸å¿ƒè®¾è®¡æ€æƒ³æ¥è‡ªä¸¤ä¸ªæˆç†Ÿçš„å¼€æºç»„ä»¶ã€‚</p>
<h3 data-id="heading-7">2.1 åŠ¨æ€ä»£ç†ï¼šå­¦ä¹ Seata</h3>
<p>Seataæ˜¯é˜¿é‡Œå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶ã€‚å®ƒæœ‰ä¸ªå¾ˆå·§å¦™çš„è®¾è®¡ï¼šé€šè¿‡åŠ¨æ€ä»£ç†DataSourceï¼Œåœ¨JDBCå±‚æ‹¦æˆªæ‰€æœ‰SQLæ‰§è¡Œï¼Œå®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„é€æ˜åŒ–ã€‚</p>
<p>SQLInsightå€Ÿé‰´äº†è¿™ä¸ªæ€è·¯ï¼Œä½†åšå¾—æ›´å½»åº•ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[åº”ç”¨ç¨‹åº] --&gt;|è°ƒç”¨| B[DataSourceProxy]
    B --&gt;|ä»£ç†| C[ConnectionProxy]
    C --&gt;|ä»£ç†| D[PreparedStatementProxy]
    D --&gt;|æ‰§è¡Œ| E[çœŸå®çš„JDBCé©±åŠ¨]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
    style E fill:#f5e1ff
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™ä¸ªæ€è·¯å¥½ï¼Ÿ</strong></p>
<ol>
<li><strong>æœ€åº•å±‚æ‹¦æˆª</strong>ï¼šä¸ç®¡ä½ ä¸Šå±‚ç”¨ä»€ä¹ˆæ¡†æ¶ï¼Œæœ€ç»ˆéƒ½è¦é€šè¿‡JDBCæ‰§è¡ŒSQL</li>
<li><strong>æ ‡å‡†æ¥å£</strong>ï¼šJDBCæ˜¯Javaæ ‡å‡†ï¼Œä¸ä¼šéšä¾¿å˜</li>
<li><strong>é€æ˜æ€§å¥½</strong>ï¼šå¯¹ä¸Šå±‚ä¸šåŠ¡ä»£ç å®Œå…¨é€æ˜</li>
</ol>
<p>Seataä»£ç†DataSourceæ˜¯ä¸ºäº†åŠ äº‹åŠ¡æ§åˆ¶ï¼ŒSQLInsightä»£ç†DataSourceæ˜¯ä¸ºäº†ç›‘æ§ã€‚æœ¬è´¨ä¸Šæ˜¯åŒä¸€ä¸ªæ€è·¯çš„ä¸åŒåº”ç”¨ã€‚</p>
<h3 data-id="heading-8">2.2 StackTraceåˆ†æï¼šå­¦ä¹ MyBatis</h3>
<p>MyBatisæœ‰ä¸ªå¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼šèƒ½æŠŠSQLæ‰§è¡Œæ—¥å¿—å’ŒMapperæ–¹æ³•å¯¹åº”èµ·æ¥ã€‚å®ƒæ€ä¹ˆåšçš„ï¼Ÿç­”æ¡ˆæ˜¯ï¼š<strong>è§£æStackTrace</strong>ã€‚</p>
<p>å½“SQLæ‰§è¡Œæ—¶ï¼ŒMyBatisä¼šè¯»å–å½“å‰çº¿ç¨‹çš„è°ƒç”¨æ ˆï¼Œæ‰¾åˆ°æ˜¯å“ªä¸ªMapperæ¥å£çš„å“ªä¸ªæ–¹æ³•è§¦å‘çš„ã€‚</p>
<p>SQLInsightæŠŠè¿™ä¸ªæ€è·¯å¾€ä¸Šå»¶ä¼¸äº†ä¸€å±‚ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[SQLæ‰§è¡Œ] --&gt;|è§¦å‘| B[è·å–StackTrace]
    B --&gt; C{æ‰«æè°ƒç”¨æ ˆ}
    C --&gt;|æ‰¾åˆ°| D[RestControlleræ³¨è§£]
    D --&gt; E[è§£æAPIè·¯å¾„]
    E --&gt; F[è§£ææ–¹æ³•å]
    F --&gt; G[æ„å»ºå®Œæ•´è°ƒç”¨é“¾]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
    style E fill:#f5e1ff
    style F fill:#e1f5ff
    style G fill:#fff4e1
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¿™ä¸ªæ€è·¯å¯è¡Œï¼Ÿ</strong></p>
<p>Javaçš„çº¿ç¨‹æ ˆé‡ŒåŒ…å«äº†å®Œæ•´çš„æ–¹æ³•è°ƒç”¨é“¾ã€‚é€šè¿‡æ‰«ææ ˆå¸§ï¼Œå¯ä»¥æ‰¾åˆ°ï¼š</p>
<ul>
<li>å“ªä¸ªControllerè¢«è°ƒç”¨äº†ï¼ˆæœ‰@RestControlleræ³¨è§£ï¼‰</li>
<li>å“ªä¸ªServiceæ–¹æ³•è¢«è°ƒç”¨äº†</li>
<li>å“ªä¸ªMapperæ–¹æ³•è¢«è°ƒç”¨äº†</li>
</ul>
<p>è¿™æ ·å°±èƒ½æŠŠAPIè°ƒç”¨å’ŒSQLæ‰§è¡Œä¸²èµ·æ¥ï¼Œå½¢æˆå®Œæ•´çš„é“¾è·¯ã€‚</p>
<hr/>
<h2 data-id="heading-9">ä¸‰ã€æ ¸å¿ƒæŠ€æœ¯å®ç°</h2>
<h3 data-id="heading-10">3.1 åŠ¨æ€ä»£ç†çš„ä¸‰å±‚ç»“æ„</h3>
<p>JDBCçš„æ ¸å¿ƒæ¥å£æœ‰ä¸‰ä¸ªï¼šDataSourceã€Connectionã€Statement/PreparedStatementã€‚SQLInsightä¸ºæ¯ä¸€å±‚éƒ½åˆ›å»ºäº†ä»£ç†ã€‚</p>
<h4 data-id="heading-11">3.1.1 ç¬¬ä¸€å±‚ï¼šä»£ç†DataSource</h4>
<p>è¿™ä¸€å±‚æ˜¯å…¥å£ã€‚Spring Bootå¯åŠ¨æ—¶ï¼Œä¼šåˆ›å»ºDataSource Beanã€‚æˆ‘ä»¬é€šè¿‡<code>BeanPostProcessor</code>æ‹¦æˆªè¿™ä¸ªè¿‡ç¨‹ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> Object <span class="hljs-title function_">postProcessAfterInitialization</span><span class="hljs-params">(Object bean, String beanName)</span> {
    <span class="hljs-keyword">if</span> (bean <span class="hljs-keyword">instanceof</span> DataSource) {
        <span class="hljs-comment">// æŠŠåŸå§‹DataSourceåŒ…è£…æˆä»£ç†</span>
        <span class="hljs-keyword">return</span> DataSourceProxy.create((DataSource) bean, collector, handler);
    }
    <span class="hljs-keyword">return</span> bean;
}
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š<code>BeanPostProcessor</code>æ˜¯Springæä¾›çš„æ‰©å±•ç‚¹ï¼Œèƒ½åœ¨Beanåˆ›å»ºåã€åˆå§‹åŒ–ååšä¸€äº›å¤„ç†ã€‚è¿™æ˜¯Springç”Ÿæ€å¸¸ç”¨çš„æ’ä»¶åŒ–æœºåˆ¶ã€‚</p>
<h4 data-id="heading-12">3.1.2 ç¬¬äºŒå±‚ï¼šä»£ç†Connection</h4>
<p>å½“ä¸šåŠ¡ä»£ç è°ƒç”¨<code>dataSource.getConnection()</code>æ—¶ï¼Œæˆ‘ä»¬è¿”å›ä¸€ä¸ªä»£ç†çš„Connectionï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable {
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"getConnection"</span>.equals(method.getName())) {
        <span class="hljs-comment">// è°ƒç”¨åŸå§‹DataSourceè·å–çœŸå®Connection</span>
        <span class="hljs-type">Connection</span> <span class="hljs-variable">realConnection</span> <span class="hljs-operator">=</span> (Connection) method.invoke(target, args);
        <span class="hljs-comment">// è¿”å›ä»£ç†Connection</span>
        <span class="hljs-keyword">return</span> ConnectionProxy.createProxy(realConnection, collector, handler);
    }
    <span class="hljs-keyword">return</span> method.invoke(target, args);
}
</code></pre>
<p><strong>è¿™é‡Œç”¨åˆ°äº†JavaåŠ¨æ€ä»£ç†çš„æ ¸å¿ƒæœºåˆ¶</strong>ï¼š<code>InvocationHandler</code>ã€‚æ¯æ¬¡è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œéƒ½ä¼šè¿›å…¥<code>invoke</code>æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œåšæ‹¦æˆªã€‚</p>
<h4 data-id="heading-13">3.1.3 ç¬¬ä¸‰å±‚ï¼šä»£ç†PreparedStatement</h4>
<p>è¿™ä¸€å±‚æ˜¯çœŸæ­£æ‰§è¡ŒSQLçš„åœ°æ–¹ã€‚å½“ä¸šåŠ¡ä»£ç è°ƒç”¨<code>connection.prepareStatement(sql)</code>æ—¶ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable {
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"prepareStatement"</span>.equals(method.getName())) {
        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> (String) args[<span class="hljs-number">0</span>];
        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">realStmt</span> <span class="hljs-operator">=</span> (PreparedStatement) method.invoke(target, args);
        <span class="hljs-comment">// è¿”å›ä»£ç†PreparedStatementï¼Œå¹¶æŠŠSQLä¼ è¿›å»</span>
        <span class="hljs-keyword">return</span> PreparedStatementProxy.createProxy(realStmt, sql, collector, handler);
    }
    <span class="hljs-keyword">return</span> method.invoke(target, args);
}
</code></pre>
<p><strong>è¿™é‡Œçš„ç»†èŠ‚</strong>ï¼šæˆ‘ä»¬æŠŠSQLè¯­å¥ä¼ ç»™äº†PreparedStatementä»£ç†ã€‚è¿™æ ·åœ¨æ‰§è¡ŒSQLæ—¶ï¼Œä»£ç†å°±çŸ¥é“è¦æ‰§è¡Œçš„æ˜¯ä»€ä¹ˆSQLäº†ã€‚</p>
<h3 data-id="heading-14">3.2 SQLæ‰§è¡Œçš„æ‹¦æˆª</h3>
<p>PreparedStatementä»£ç†çš„æ ¸å¿ƒé€»è¾‘åœ¨è¿™é‡Œï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;Integer, Object&gt; parameters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable {
    <span class="hljs-comment">// 1. æ‹¦æˆªå‚æ•°è®¾ç½®æ–¹æ³•ï¼ˆsetStringã€setIntç­‰ï¼‰</span>
    <span class="hljs-keyword">if</span> (method.getName().startsWith(<span class="hljs-string">"set"</span>) &amp;&amp; args.length &gt;= <span class="hljs-number">2</span>) {
        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) args[<span class="hljs-number">0</span>];
        <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> args[<span class="hljs-number">1</span>];
        parameters.put(index, value);  <span class="hljs-comment">// è®°å½•å‚æ•°å€¼</span>
    }
    
    <span class="hljs-comment">// 2. æ‹¦æˆªæ‰§è¡Œæ–¹æ³•ï¼ˆexecuteã€executeQueryç­‰ï¼‰</span>
    <span class="hljs-keyword">if</span> (method.getName().startsWith(<span class="hljs-string">"execute"</span>)) {
        <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
        <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> method.invoke(target, args);  <span class="hljs-comment">// æ‰§è¡ŒçœŸå®SQL</span>
        <span class="hljs-type">long</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - start;
        
        <span class="hljs-comment">// 3. æ”¶é›†SQLæ‰§è¡Œä¿¡æ¯</span>
        collectSqlExecution(sql, parameters, duration);
        <span class="hljs-keyword">return</span> result;
    }
    
    <span class="hljs-keyword">return</span> method.invoke(target, args);
}
</code></pre>
<p><strong>è¿™é‡Œæœ‰ä¸¤ä¸ªå…³é”®ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>å‚æ•°æ‹¦æˆª</strong>ï¼šPreparedStatementçš„å‚æ•°æ˜¯é€šè¿‡<code>setXxx(index, value)</code>æ–¹æ³•è®¾ç½®çš„ã€‚æˆ‘ä»¬æ‹¦æˆªè¿™äº›æ–¹æ³•ï¼ŒæŠŠå‚æ•°è®°ä¸‹æ¥ã€‚</li>
<li><strong>æ‰§è¡Œæ‹¦æˆª</strong>ï¼šå½“è°ƒç”¨<code>execute()</code>æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬è®°å½•å¼€å§‹æ—¶é—´ï¼Œæ‰§è¡ŒSQLï¼Œç„¶åè®°å½•ç»“æŸæ—¶é—´ï¼Œç®—å‡ºæ‰§è¡Œè€—æ—¶ã€‚</li>
</ol>
<h3 data-id="heading-15">3.3 StackTraceè§£æï¼šæ‰¾åˆ°APIè°ƒç”¨è€…</h3>
<p>SQLæ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æ˜¯å“ªä¸ªAPIè§¦å‘çš„ã€‚è¿™é‡Œç”¨åˆ°äº†StackTraceåˆ†æï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ApiInfo <span class="hljs-title function_">extractApiInfo</span><span class="hljs-params">()</span> {
    StackTraceElement[] stack = Thread.currentThread().getStackTrace();
    
    <span class="hljs-comment">// é™åˆ¶æ‰«ææ·±åº¦ï¼Œé¿å…æ€§èƒ½é—®é¢˜</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">maxDepth</span> <span class="hljs-operator">=</span> Math.min(stack.length, <span class="hljs-number">50</span>);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; maxDepth; i++) {
        <span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> stack[i].getClassName();
        
        <span class="hljs-comment">// å…ˆæŸ¥ç¼“å­˜</span>
        <span class="hljs-keyword">if</span> (controllerCache.containsKey(className)) {
            <span class="hljs-keyword">return</span> controllerCache.get(className);
        }
        
        <span class="hljs-comment">// åŠ è½½ç±»ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰@RestControlleræˆ–@Controlleræ³¨è§£</span>
        Class&lt;?&gt; clazz = Class.forName(className);
        <span class="hljs-keyword">if</span> (clazz.isAnnotationPresent(RestController.class) || 
            clazz.isAnnotationPresent(Controller.class)) {
            <span class="hljs-type">ApiInfo</span> <span class="hljs-variable">apiInfo</span> <span class="hljs-operator">=</span> parseApiInfo(clazz, stack[i].getMethodName());
            controllerCache.put(className, apiInfo);  <span class="hljs-comment">// ç¼“å­˜èµ·æ¥</span>
            <span class="hljs-keyword">return</span> apiInfo;
        }
    }
    
    <span class="hljs-keyword">return</span> ApiInfo.unknown();
}
</code></pre>
<p><strong>æ€§èƒ½ä¼˜åŒ–ç‚¹</strong>ï¼š</p>
<ol>
<li><strong>é™åˆ¶æ‰«ææ·±åº¦</strong>ï¼šåªæ‰«æå‰50å±‚è°ƒç”¨æ ˆï¼Œé¿å…æ·±åº¦é€’å½’</li>
<li><strong>ç¼“å­˜Controllerä¿¡æ¯</strong>ï¼šåŒä¸€ä¸ªControllerç±»åªè§£æä¸€æ¬¡ï¼Œåç»­ç›´æ¥ä»ç¼“å­˜å–</li>
</ol>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[SQLæ‰§è¡Œ] --&gt; B{è¯»å–çº¿ç¨‹æ ˆ}
    B --&gt; C[ç¬¬1å±‚: SQLInsightä»£ç†]
    C --&gt; D[ç¬¬2å±‚: MyBatis]
    D --&gt; E[ç¬¬3å±‚: Service]
    E --&gt; F[ç¬¬4å±‚: Controller]
    F --&gt; G{æ‰¾åˆ°RestController?}
    G --&gt;|æ˜¯| H[è§£æAPIä¿¡æ¯]
    G --&gt;|å¦| I[ç»§ç»­å‘ä¸Šæ‰«æ]
    H --&gt; J[è¿”å›APIè·¯å¾„å’Œæ–¹æ³•]
    
    style A fill:#e1f5ff
    style F fill:#e1ffe1
    style H fill:#fff4e1
    style J fill:#ffe1f5
</code></pre>
<h3 data-id="heading-16">3.4 APIä¿¡æ¯è§£æ</h3>
<p>æ‰¾åˆ°Controlleråï¼Œæ€ä¹ˆè§£æå‡ºAPIè·¯å¾„å‘¢ï¼Ÿ</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> ApiInfo <span class="hljs-title function_">parseApiInfo</span><span class="hljs-params">(Class&lt;?&gt; controllerClass, String methodName)</span> {
    <span class="hljs-comment">// 1. è·å–ç±»çº§åˆ«çš„@RequestMapping</span>
    <span class="hljs-type">RequestMapping</span> <span class="hljs-variable">classMapping</span> <span class="hljs-operator">=</span> controllerClass.getAnnotation(RequestMapping.class);
    <span class="hljs-type">String</span> <span class="hljs-variable">basePath</span> <span class="hljs-operator">=</span> classMapping != <span class="hljs-literal">null</span> ? classMapping.value()[<span class="hljs-number">0</span>] : <span class="hljs-string">""</span>;
    
    <span class="hljs-comment">// 2. æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•</span>
    <span class="hljs-keyword">for</span> (Method method : controllerClass.getDeclaredMethods()) {
        <span class="hljs-keyword">if</span> (method.getName().equals(methodName)) {
            <span class="hljs-comment">// 3. è·å–æ–¹æ³•çº§åˆ«çš„@GetMapping/@PostMappingç­‰</span>
            <span class="hljs-type">GetMapping</span> <span class="hljs-variable">getMapping</span> <span class="hljs-operator">=</span> method.getAnnotation(GetMapping.class);
            <span class="hljs-keyword">if</span> (getMapping != <span class="hljs-literal">null</span>) {
                <span class="hljs-type">String</span> <span class="hljs-variable">path</span> <span class="hljs-operator">=</span> basePath + getMapping.value()[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApiInfo</span>(path, <span class="hljs-string">"GET"</span>, methodName);
            }
            <span class="hljs-comment">// ... å¤„ç†PostMappingã€PutMappingç­‰</span>
        }
    }
    
    <span class="hljs-keyword">return</span> ApiInfo.unknown();
}
</code></pre>
<p>è¿™æ ·å°±èƒ½ä»æ³¨è§£ä¸­æå–å‡ºå®Œæ•´çš„APIè·¯å¾„ï¼Œæ¯”å¦‚<code>/api/users/123</code>ã€‚</p>
<hr/>
<h2 data-id="heading-17">å››ã€è®¾è®¡æ¨¡å¼çš„åº”ç”¨</h2>
<h3 data-id="heading-18">4.1 ä»£ç†æ¨¡å¼</h3>
<p>è¿™æ˜¯SQLInsightçš„æ ¸å¿ƒã€‚Javaçš„åŠ¨æ€ä»£ç†åŸºäºæ¥å£ï¼Œè¿™å’ŒJDBCçš„è®¾è®¡å¤©ç„¶å¥‘åˆï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ä¸šåŠ¡ä»£ç ] --&gt;|è°ƒç”¨æ¥å£| B[ä»£ç†å¯¹è±¡]
    B --&gt;|æ‹¦æˆªå¤„ç†| C[æ”¶é›†SQLä¿¡æ¯]
    B --&gt;|è½¬å‘è°ƒç”¨| D[çœŸå®å¯¹è±¡]
    D --&gt;|æ‰§è¡ŒSQL| E[æ•°æ®åº“]
    C -.-&gt;|å¼‚æ­¥| F[æ—¥å¿—è¾“å‡º]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
    style E fill:#f5e1ff
    style F fill:#fff4e1
</code></pre>
<p><strong>ä»£ç†æ¨¡å¼çš„å¥½å¤„</strong>ï¼š</p>
<ul>
<li>å¯¹ä¸šåŠ¡ä»£ç é€æ˜</li>
<li>å¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„æƒ…å†µä¸‹å¢åŠ åŠŸèƒ½</li>
<li>ç¬¦åˆå¼€é—­åŸåˆ™ï¼ˆå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼‰</li>
</ul>
<h3 data-id="heading-19">4.2 è§‚å¯Ÿè€…æ¨¡å¼</h3>
<p>SQLæ‰§è¡Œä¿¡æ¯æ”¶é›†åï¼Œå¯èƒ½æœ‰å¤šç§å¤„ç†æ–¹å¼ï¼šè¾“å‡ºåˆ°æ§åˆ¶å°ã€å†™å…¥æ—¥å¿—æ–‡ä»¶ã€æŒä¹…åŒ–åˆ°æ•°æ®åº“ã€å‘é€åˆ°ç›‘æ§ç³»ç»Ÿç­‰ã€‚</p>
<p>SQLInsightç”¨è§‚å¯Ÿè€…æ¨¡å¼æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SqlExecutionHandler</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(SqlExecution execution)</span>;
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConsoleSqlExecutionHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SqlExecutionHandler</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(SqlExecution execution)</span> {
        System.out.println(formatSqlLog(execution));
    }
}

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoggingSqlExecutionHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SqlExecutionHandler</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(SqlExecution execution)</span> {
        logger.info(formatSqlLog(execution));
    }
}
</code></pre>
<p>è¿™æ ·å¯ä»¥çµæ´»ç»„åˆä¸åŒçš„å¤„ç†å™¨ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯çš„éœ€æ±‚ã€‚</p>
<h3 data-id="heading-20">4.3 å·¥å‚æ¨¡å¼</h3>
<p>DataSourceProxyçš„åˆ›å»ºä½¿ç”¨äº†å·¥å‚æ¨¡å¼ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DataSource <span class="hljs-title function_">create</span><span class="hljs-params">(DataSource target, 
                                 SqlExecutionCollector collector, 
                                 SqlExecutionHandler handler)</span> {
    <span class="hljs-keyword">return</span> (DataSource) Proxy.newProxyInstance(
        DataSource.class.getClassLoader(),
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>&lt;?&gt;[] { DataSource.class },
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataSourceProxy</span>(target, collector, handler)
    );
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦ç”¨å·¥å‚æ¨¡å¼ï¼Ÿ</strong></p>
<p>åŠ¨æ€ä»£ç†çš„åˆ›å»ºæ¯”è¾ƒå¤æ‚ï¼Œæ¶‰åŠç±»åŠ è½½å™¨ã€æ¥å£æ•°ç»„ç­‰å‚æ•°ã€‚é€šè¿‡å·¥å‚æ–¹æ³•å°è£…è¿™äº›ç»†èŠ‚ï¼Œè®©ä½¿ç”¨è€…æ›´æ–¹ä¾¿ã€‚</p>
<hr/>
<h2 data-id="heading-21">äº”ã€å…¼å®¹æ€§è®¾è®¡</h2>
<h3 data-id="heading-22">5.1 ä¸Druidçš„å…¼å®¹</h3>
<p>Druidæ˜¯é˜¿é‡Œå¼€æºçš„æ•°æ®åº“è¿æ¥æ± ï¼Œè‡ªå¸¦ç›‘æ§åŠŸèƒ½ã€‚SQLInsightå’ŒDruidå¯ä»¥æ— ç¼é…åˆï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[åº”ç”¨ç¨‹åº] --&gt; B[SQLInsightä»£ç†]
    B --&gt; C[Druidè¿æ¥æ± ]
    C --&gt; D[MySQLé©±åŠ¨]
    
    B -.-&gt;|æ”¶é›†| E[SQLæ‰§è¡Œä¿¡æ¯]
    C -.-&gt;|æ”¶é›†| F[è¿æ¥æ± ç›‘æ§]
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
    style E fill:#f5e1ff
    style F fill:#fff4e1
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆèƒ½å…¼å®¹ï¼Ÿ</strong></p>
<p>SQLInsightä»£ç†çš„æ˜¯æ ‡å‡†JDBCæ¥å£ï¼Œä¸å…³å¿ƒåº•å±‚å®ç°ã€‚Druidè¿æ¥æ± ä¹Ÿå®ç°äº†JDBCæ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä»£ç†ã€‚</p>
<p>ä¸¤è€…çš„ç›‘æ§æ•°æ®æ˜¯äº’è¡¥çš„ï¼š</p>
<ul>
<li>Druidç›‘æ§ï¼šè¿æ¥æ± çŠ¶æ€ã€è¿æ¥è·å–è€—æ—¶ã€SQLæ‰§è¡Œç»Ÿè®¡</li>
<li>SQLInsightç›‘æ§ï¼šSQLä¸APIçš„å…³è”ã€å®Œæ•´è°ƒç”¨é“¾ã€æ…¢SQLæ£€æµ‹</li>
</ul>
<h3 data-id="heading-23">5.2 ä¸Seataçš„å…¼å®¹</h3>
<p>Seataä¹Ÿä¼šä»£ç†DataSourceï¼Œè¿™å°±æ¶‰åŠåˆ°<strong>ä»£ç†é“¾çš„é¡ºåºé—®é¢˜</strong>ã€‚</p>
<p>ç†æƒ³çš„é¡ºåºæ˜¯ï¼š<code>åº”ç”¨ç¨‹åº â†’ Seata â†’ SQLInsight â†’ è¿æ¥æ± </code></p>
<p>ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºSeataéœ€è¦åœ¨æœ€å¤–å±‚æ§åˆ¶äº‹åŠ¡ï¼ŒSQLInsightåªåšç›‘æ§ï¼Œåº”è¯¥åœ¨å†…å±‚ã€‚</p>
<p>å¦‚ä½•ä¿è¯é¡ºåºï¼Ÿé€šè¿‡è°ƒæ•´<code>BeanPostProcessor</code>çš„ä¼˜å…ˆçº§ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Bean</span>
<span class="hljs-keyword">public</span> SqlInsightDataSourceBeanPostProcessor <span class="hljs-title function_">processor</span><span class="hljs-params">()</span> {
    <span class="hljs-type">SqlInsightDataSourceBeanPostProcessor</span> <span class="hljs-variable">processor</span> <span class="hljs-operator">=</span> 
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">SqlInsightDataSourceBeanPostProcessor</span>(collector, handler);
    processor.setOrder(Ordered.LOWEST_PRECEDENCE);  <span class="hljs-comment">// è®¾ç½®æœ€ä½ä¼˜å…ˆçº§</span>
    <span class="hljs-keyword">return</span> processor;
}
</code></pre>
<p>è¿™æ ·Seataä¼šå…ˆæ‰§è¡Œï¼ŒSQLInsightåæ‰§è¡Œï¼Œä»£ç†é¡ºåºå°±å¯¹äº†ã€‚</p>
<hr/>
<h2 data-id="heading-24">å…­ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥</h2>
<h3 data-id="heading-25">6.1 ç¼“å­˜Controllerä¿¡æ¯</h3>
<p>ç¬¬ä¸€æ¬¡è§£æControllerä¿¡æ¯åï¼Œç¼“å­˜èµ·æ¥ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, ApiInfo&gt; controllerCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();

<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ApiInfo <span class="hljs-title function_">extractApiInfo</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// å…ˆæŸ¥ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (controllerCache.containsKey(className)) {
        <span class="hljs-keyword">return</span> controllerCache.get(className);
    }
    <span class="hljs-comment">// è§£æå¹¶ç¼“å­˜</span>
    <span class="hljs-type">ApiInfo</span> <span class="hljs-variable">apiInfo</span> <span class="hljs-operator">=</span> parseApiInfo(clazz, methodName);
    controllerCache.put(className, apiInfo);
    <span class="hljs-keyword">return</span> apiInfo;
}
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šé¦–æ¬¡è§£æçº¦50å¾®ç§’ï¼Œç¼“å­˜å‘½ä¸­åå°äº1å¾®ç§’ã€‚</p>
<h3 data-id="heading-26">6.2 å¼‚æ­¥å¤„ç†</h3>
<p>SQLæ‰§è¡Œä¿¡æ¯çš„å¤„ç†ï¼ˆè¾“å‡ºæ—¥å¿—ã€æŒä¹…åŒ–ç­‰ï¼‰æ˜¯å¼‚æ­¥çš„ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(SqlExecution execution)</span> {
    executor.submit(() -&gt; {
        <span class="hljs-comment">// å¤„ç†SQLæ‰§è¡Œä¿¡æ¯</span>
        persistence.save(execution);
        logger.info(formatSqlLog(execution));
    });
}
</code></pre>
<p>è¿™æ ·ä¸ä¼šé˜»å¡ä¸šåŠ¡SQLçš„æ‰§è¡Œã€‚</p>
<h3 data-id="heading-27">6.3 é™åˆ¶StackTraceæ‰«ææ·±åº¦</h3>
<p>åªæ‰«æå‰50å±‚è°ƒç”¨æ ˆï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">int</span> <span class="hljs-variable">maxDepth</span> <span class="hljs-operator">=</span> Math.min(stack.length, <span class="hljs-number">50</span>);
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; maxDepth; i++) {
    <span class="hljs-comment">// æ‰«ææ ˆå¸§</span>
}
</code></pre>
<p>å®é™…æµ‹è¯•ä¸­ï¼ŒControllerä¸€èˆ¬åœ¨å‰10å±‚å°±èƒ½æ‰¾åˆ°ï¼Œ50å±‚å·²ç»è¶³å¤Ÿäº†ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[SQLæ‰§è¡Œ] --&gt; B{è¯»å–æ ˆæ·±åº¦}
    B --&gt;|æ·±åº¦&lt;=50| C[æ‰«ææ ˆå¸§]
    B --&gt;|æ·±åº¦&gt;50| D[åªæ‰«æå‰50å±‚]
    C --&gt; E[æŸ¥æ‰¾Controller]
    D --&gt; E
    E --&gt; F{æ‰¾åˆ°äº†?}
    F --&gt;|æ˜¯| G[è¿”å›APIä¿¡æ¯]
    F --&gt;|å¦| H[è¿”å›Unknown]
    
    style A fill:#e1f5ff
    style C fill:#e1ffe1
    style E fill:#fff4e1
    style G fill:#ffe1f5
</code></pre>
<hr/>
<h2 data-id="heading-28">ä¸ƒã€æ ¸å¿ƒä»£ç å‰–æ</h2>
<h3 data-id="heading-29">7.1 PreparedStatementProxyçš„ç²¾å¦™ä¹‹å¤„</h3>
<p>è¿™æ˜¯æ•´ä¸ªé¡¹ç›®æœ€æ ¸å¿ƒçš„ä¸€æ®µä»£ç ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PreparedStatementProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PreparedStatement target;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String sql;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;Object&gt; parameters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();
    
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-type">String</span> <span class="hljs-variable">methodName</span> <span class="hljs-operator">=</span> method.getName();
        
        <span class="hljs-comment">// æ‹¦æˆªå‚æ•°è®¾ç½®æ–¹æ³•</span>
        <span class="hljs-keyword">if</span> (methodName.startsWith(<span class="hljs-string">"set"</span>) &amp;&amp; args.length &gt;= <span class="hljs-number">2</span>) {
            <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> (<span class="hljs-type">int</span>) args[<span class="hljs-number">0</span>];
            <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> args[<span class="hljs-number">1</span>];
            
            <span class="hljs-comment">// æ‰©å±•å‚æ•°åˆ—è¡¨</span>
            <span class="hljs-keyword">while</span> (parameters.size() &lt; index) {
                parameters.add(<span class="hljs-literal">null</span>);
            }
            parameters.set(index - <span class="hljs-number">1</span>, value);  <span class="hljs-comment">// JDBCå‚æ•°ç´¢å¼•ä»1å¼€å§‹</span>
            
            <span class="hljs-keyword">return</span> method.invoke(target, args);
        }
        
        <span class="hljs-comment">// æ‹¦æˆªæ‰§è¡Œæ–¹æ³•</span>
        <span class="hljs-keyword">if</span> (methodName.startsWith(<span class="hljs-string">"execute"</span>)) {
            <span class="hljs-type">long</span> <span class="hljs-variable">start</span> <span class="hljs-operator">=</span> System.currentTimeMillis();
            <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> method.invoke(target, args);
            <span class="hljs-type">long</span> <span class="hljs-variable">duration</span> <span class="hljs-operator">=</span> System.currentTimeMillis() - start;
            
            <span class="hljs-comment">// æ”¶é›†SQLæ‰§è¡Œä¿¡æ¯</span>
            collectSqlExecution(sql, parameters, duration);
            
            <span class="hljs-keyword">return</span> result;
        }
        
        <span class="hljs-comment">// å…¶ä»–æ–¹æ³•ç›´æ¥è½¬å‘</span>
        <span class="hljs-keyword">return</span> method.invoke(target, args);
    }
}
</code></pre>
<p><strong>è¿™æ®µä»£ç çš„ç²¾å¦™ä¹‹å¤„</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ‹¦æˆªå‚æ•°è®¾ç½®</strong>ï¼šPreparedStatementçš„å‚æ•°æ˜¯é€šè¿‡<code>setXxx(index, value)</code>æ–¹æ³•è®¾ç½®çš„ï¼Œè€Œä¸”ç´¢å¼•ä»1å¼€å§‹ï¼ˆJDBCè§„èŒƒï¼‰ã€‚ä»£ç ä¸­ç”¨<code>parameters.set(index - 1, value)</code>å¤„ç†äº†è¿™ä¸ªç»†èŠ‚ã€‚</p>
</li>
<li>
<p><strong>åŠ¨æ€æ‰©å±•å‚æ•°åˆ—è¡¨</strong>ï¼šå‚æ•°å¯èƒ½ä¸æ˜¯æŒ‰é¡ºåºè®¾ç½®çš„ï¼Œæ¯”å¦‚å…ˆè®¾ç½®ç¬¬3ä¸ªå‚æ•°ï¼Œå†è®¾ç½®ç¬¬1ä¸ªå‚æ•°ã€‚ä»£ç ç”¨<code>while</code>å¾ªç¯åŠ¨æ€æ‰©å±•åˆ—è¡¨ï¼Œä¿è¯ä¸ä¼šè¶Šç•Œã€‚</p>
</li>
<li>
<p><strong>ç²¾ç¡®æµ‹é‡æ‰§è¡Œæ—¶é—´</strong>ï¼šåœ¨<code>invoke</code>æ–¹æ³•é‡ŒåŒ…è£¹çœŸå®çš„SQLæ‰§è¡Œï¼Œå‰åè®°å½•æ—¶é—´æˆ³ï¼Œå¾—åˆ°ç²¾ç¡®çš„æ‰§è¡Œè€—æ—¶ã€‚</p>
</li>
<li>
<p><strong>ä¿æŒåŸæœ‰è¡Œä¸º</strong>ï¼šæ‰€æœ‰æ‹¦æˆªåï¼Œéƒ½è¦è°ƒç”¨<code>method.invoke(target, args)</code>ï¼Œç¡®ä¿åŸæœ‰åŠŸèƒ½ä¸å—å½±å“ã€‚</p>
</li>
</ol>
<h3 data-id="heading-30">7.2 StackTraceåˆ†æçš„ä¼˜é›…å®ç°</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ApiInfo <span class="hljs-title function_">extractApiInfo</span><span class="hljs-params">()</span> {
    StackTraceElement[] stack = Thread.currentThread().getStackTrace();
    <span class="hljs-type">int</span> <span class="hljs-variable">maxDepth</span> <span class="hljs-operator">=</span> Math.min(stack.length, <span class="hljs-number">50</span>);
    
    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; maxDepth; i++) {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> stack[i].getClassName();
            
            <span class="hljs-comment">// ç¼“å­˜å‘½ä¸­</span>
            <span class="hljs-keyword">if</span> (controllerCache.containsKey(className)) {
                <span class="hljs-keyword">return</span> controllerCache.get(className);
            }
            
            <span class="hljs-comment">// åŠ è½½ç±»å¹¶æ£€æŸ¥æ³¨è§£</span>
            Class&lt;?&gt; clazz = Class.forName(className);
            <span class="hljs-keyword">if</span> (isController(clazz)) {
                <span class="hljs-type">ApiInfo</span> <span class="hljs-variable">apiInfo</span> <span class="hljs-operator">=</span> parseApiInfo(clazz, stack[i].getMethodName());
                controllerCache.put(className, apiInfo);
                <span class="hljs-keyword">return</span> apiInfo;
            }
        } <span class="hljs-keyword">catch</span> (ClassNotFoundException e) {
            <span class="hljs-comment">// å¿½ç•¥ï¼Œç»§ç»­æ‰«æä¸‹ä¸€å±‚</span>
        }
    }
    
    <span class="hljs-keyword">return</span> ApiInfo.unknown();
}

<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isController</span><span class="hljs-params">(Class&lt;?&gt; clazz)</span> {
    <span class="hljs-keyword">return</span> clazz.isAnnotationPresent(RestController.class) || 
           clazz.isAnnotationPresent(Controller.class);
}
</code></pre>
<p><strong>è¿™æ®µä»£ç çš„ä¼˜é›…ä¹‹å¤„</strong>ï¼š</p>
<ol>
<li>
<p><strong>å¼‚å¸¸å¤„ç†å¾—å½“</strong>ï¼š<code>Class.forName()</code>å¯èƒ½æŠ›å‡º<code>ClassNotFoundException</code>ï¼Œä½†è¿™ä¸æ˜¯é”™è¯¯ï¼Œåªæ˜¯è¯´æ˜è¿™ä¸ªç±»ä¸åœ¨å½“å‰ClassLoaderé‡Œã€‚ä»£ç ç”¨<code>try-catch</code>ä¼˜é›…åœ°å¤„ç†äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>æå‰è¿”å›</strong>ï¼šä¸€æ—¦æ‰¾åˆ°Controllerï¼Œç«‹å³è¿”å›ï¼Œä¸å†ç»§ç»­æ‰«æã€‚è¿™æ˜¯æ€§èƒ½ä¼˜åŒ–çš„å…³é”®ã€‚</p>
</li>
<li>
<p><strong>ç¼“å­˜ç­–ç•¥</strong>ï¼šç”¨ç±»åä½œä¸ºkeyç¼“å­˜ï¼Œè€Œä¸æ˜¯ç”¨å®Œæ•´çš„ApiInfoã€‚è¿™æ ·å³ä½¿æ–¹æ³•ä¸åŒï¼Œç±»åç›¸åŒä¹Ÿèƒ½å‘½ä¸­ç¼“å­˜ã€‚</p>
</li>
</ol>
<hr/>
<h2 data-id="heading-31">å…«ã€è®¾è®¡æ€æƒ³çš„å‡å</h2>
<p>åšå®Œè¿™ä¸ªé¡¹ç›®åï¼Œæˆ‘æœ‰ä¸€äº›æ›´æ·±å±‚æ¬¡çš„æ€è€ƒã€‚</p>
<h3 data-id="heading-32">8.1 æœ€å°‘çŸ¥è¯†åŸåˆ™</h3>
<p>SQLInsightéµå¾ªäº†"æœ€å°‘çŸ¥è¯†åŸåˆ™"ï¼ˆLaw of Demeterï¼‰ã€‚å®ƒåªå’ŒJDBCæ¥å£æ‰“äº¤é“ï¼Œä¸å…³å¿ƒï¼š</p>
<ul>
<li>ä½ ç”¨çš„æ˜¯ä»€ä¹ˆORMæ¡†æ¶</li>
<li>ä½ çš„è¿æ¥æ± æ˜¯ä»€ä¹ˆ</li>
<li>ä½ çš„æ•°æ®åº“æ˜¯MySQLè¿˜æ˜¯PostgreSQL</li>
</ul>
<p><strong>è¿™ä¸ªåŸåˆ™çš„å¥½å¤„</strong>ï¼š</p>
<ul>
<li>é™ä½è€¦åˆ</li>
<li>æé«˜é€‚åº”æ€§</li>
<li>å‡å°‘ç»´æŠ¤æˆæœ¬</li>
</ul>
<p>åœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡ä¾èµ–æŠ½è±¡ï¼ˆæ¥å£ï¼‰ï¼Œè€Œä¸æ˜¯å…·ä½“å®ç°ã€‚JDBCæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŠ½è±¡å±‚ã€‚</p>
<h3 data-id="heading-33">8.2 åˆ†å±‚æ¶æ„çš„å¨åŠ›</h3>
<p>JDBCçš„åˆ†å±‚è®¾è®¡ï¼ˆDataSource â†’ Connection â†’ Statementï¼‰ä¸ºä»£ç†æä¾›äº†å¤©ç„¶çš„åˆ‡å…¥ç‚¹ã€‚</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
    A[ä¸šåŠ¡å±‚&lt;br/&gt;MyBatis/JPA] --&gt; B[JDBCæŠ½è±¡å±‚&lt;br/&gt;æ ‡å‡†æ¥å£]
    B --&gt; C[é©±åŠ¨å®ç°å±‚&lt;br/&gt;MySQL/Oracleé©±åŠ¨]
    
    D[SQLInsight] -.-&gt;|ä»£ç†| B
    
    style A fill:#e1f5ff
    style B fill:#fff4e1
    style C fill:#ffe1f5
    style D fill:#e1ffe1
</code></pre>
<p><strong>åˆ†å±‚æ¶æ„çš„å¥½å¤„</strong>ï¼š</p>
<ul>
<li>æ¯ä¸€å±‚éƒ½æœ‰æ˜ç¡®çš„èŒè´£</li>
<li>å±‚ä¸å±‚ä¹‹é—´é€šè¿‡æ¥å£é€šä¿¡</li>
<li>å¯ä»¥åœ¨ä»»ä½•ä¸€å±‚æ’å…¥æ–°åŠŸèƒ½ï¼ˆå¦‚ç›‘æ§ã€äº‹åŠ¡æ§åˆ¶ï¼‰</li>
</ul>
<p>è¿™å¯å‘æˆ‘ä»¬ï¼šåœ¨è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œåˆç†çš„åˆ†å±‚èƒ½å¸¦æ¥æå¤§çš„æ‰©å±•æ€§ã€‚</p>
<h3 data-id="heading-34">8.3 ç»„åˆä¼˜äºç»§æ‰¿</h3>
<p>SQLInsightæ²¡æœ‰é€šè¿‡ç»§æ‰¿æ¥æ‰©å±•åŠŸèƒ½ï¼Œè€Œæ˜¯é€šè¿‡ç»„åˆï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataSourceProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> DataSource target;  <span class="hljs-comment">// ç»„åˆåŸå§‹DataSource</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SqlExecutionCollector collector;  <span class="hljs-comment">// ç»„åˆæ”¶é›†å™¨</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> SqlExecutionHandler handler;  <span class="hljs-comment">// ç»„åˆå¤„ç†å™¨</span>
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆç»„åˆä¼˜äºç»§æ‰¿ï¼Ÿ</strong></p>
<ol>
<li><strong>çµæ´»æ€§</strong>ï¼šå¯ä»¥åŠ¨æ€æ›¿æ¢ç»„ä»¶ï¼ˆæ¯”å¦‚æ¢ä¸€ä¸ªä¸åŒçš„handlerï¼‰</li>
<li><strong>ä½è€¦åˆ</strong>ï¼šå„ä¸ªç»„ä»¶å¯ä»¥ç‹¬ç«‹æ¼”åŒ–</li>
<li><strong>å¯æµ‹è¯•</strong>ï¼šå¯ä»¥å•ç‹¬æµ‹è¯•æ¯ä¸ªç»„ä»¶</li>
</ol>
<p>è¿™æ˜¯è®¾è®¡æ¨¡å¼ä¸­çš„ç»å…¸åŸåˆ™ï¼Œå€¼å¾—åå¤ä½“ä¼šã€‚</p>
<h3 data-id="heading-35">8.4 å¼€é—­åŸåˆ™çš„å®è·µ</h3>
<p>SQLInsightå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼š</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">SqlExecutionHandler</span> {
    <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(SqlExecution execution)</span>;
}

<span class="hljs-comment">// æ–°å¢ä¸€ä¸ªhandlerï¼Œä¸éœ€è¦ä¿®æ”¹æ ¸å¿ƒä»£ç </span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">SqlExecutionHandler</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handle</span><span class="hljs-params">(SqlExecution execution)</span> {
        <span class="hljs-comment">// è‡ªå®šä¹‰å¤„ç†é€»è¾‘</span>
    }
}
</code></pre>
<p>æƒ³å¢åŠ æ–°åŠŸèƒ½ï¼Ÿå®ç°ä¸€ä¸ªæ–°çš„Handlerå°±è¡Œäº†ï¼Œä¸éœ€è¦æ”¹åŠ¨æ ¸å¿ƒä»£ç ã€‚</p>
<p><strong>è¿™ç»™æˆ‘ä»¬çš„å¯ç¤º</strong>ï¼š</p>
<ul>
<li>è®¾è®¡æ¥å£æ—¶è¦æƒ³æ¸…æ¥šæ‰©å±•ç‚¹åœ¨å“ªé‡Œ</li>
<li>æ ¸å¿ƒé€»è¾‘è¦ç¨³å®šï¼Œæ‰©å±•é€»è¾‘è¦çµæ´»</li>
<li>é€šè¿‡æ¥å£å’ŒæŠ½è±¡éš”ç¦»å˜åŒ–</li>
</ul>
<h3 data-id="heading-36">8.5 æ€§èƒ½ä¸åŠŸèƒ½çš„å¹³è¡¡</h3>
<p>SQLInsighté¢ä¸´ä¸€ä¸ªçŸ›ç›¾ï¼š</p>
<ul>
<li><strong>åŠŸèƒ½éœ€æ±‚</strong>ï¼šéœ€è¦æ‰«æStackTraceï¼Œè§£ææ³¨è§£ï¼Œæ”¶é›†ä¿¡æ¯</li>
<li><strong>æ€§èƒ½éœ€æ±‚</strong>ï¼šä¸èƒ½å½±å“ä¸šåŠ¡SQLçš„æ‰§è¡Œé€Ÿåº¦</li>
</ul>
<p>è§£å†³æ–¹æ¡ˆæ˜¯ï¼š</p>
<ol>
<li><strong>ç¼“å­˜</strong>ï¼šå‡å°‘é‡å¤è®¡ç®—</li>
<li><strong>å¼‚æ­¥</strong>ï¼šæŠŠè€—æ—¶æ“ä½œç§»åˆ°åå°</li>
<li><strong>é™åˆ¶</strong>ï¼šé™åˆ¶æ‰«ææ·±åº¦ï¼Œé¿å…æç«¯æƒ…å†µ</li>
</ol>
<p><strong>è¿™ä¸ªå¹³è¡¡çš„å¯ç¤º</strong>ï¼š</p>
<ul>
<li>æ€§èƒ½ä¼˜åŒ–ä¸æ˜¯æ— é™åˆ¶çš„ï¼Œè¦æ‰¾åˆ°åˆé€‚çš„åº¦</li>
<li>ç”¨ç©ºé—´æ¢æ—¶é—´ï¼ˆç¼“å­˜ï¼‰</li>
<li>ç”¨å¼‚æ­¥æ¢åŒæ­¥ï¼ˆåå°å¤„ç†ï¼‰</li>
<li>è®¾ç½®åˆç†çš„è¾¹ç•Œï¼ˆæ‰«ææ·±åº¦é™åˆ¶ï¼‰</li>
</ul>
<hr/>
<h2 data-id="heading-37">ä¹ã€ä½¿ç”¨ç¤ºä¾‹</h2>
<blockquote>
<p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fsh_wangwanbao%2Fsql-insight" target="_blank" title="https://gitee.com/sh_wangwanbao/sql-insight" ref="nofollow noopener noreferrer">gitee.com/sh_wangwanbâ€¦</a><br/>
å®Œæ•´çš„ç¤ºä¾‹ä»£ç åœ¨<code>examples</code>æ¨¡å—ä¸­ï¼Œå¯ä»¥ç›´æ¥è¿è¡ŒæŸ¥çœ‹æ•ˆæœã€‚</p>
</blockquote>
<h3 data-id="heading-38">9.1 å¼•å…¥ä¾èµ–</h3>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.surfing<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>sqlinsight-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h3 data-id="heading-39">9.2 é…ç½®ï¼ˆå¯é€‰ï¼‰</h3>
<pre><code class="hljs language-properties" lang="properties"># å¯ç”¨SQLInsightï¼ˆé»˜è®¤trueï¼‰
sqlinsight.enabled=true

# æ…¢SQLé˜ˆå€¼ï¼ˆé»˜è®¤1000msï¼‰
sqlinsight.slow-sql-threshold=50

# N+1æŸ¥è¯¢æ£€æµ‹é˜ˆå€¼ï¼ˆé»˜è®¤10ï¼‰
sqlinsight.n-plus-one-threshold=10
</code></pre>
<h3 data-id="heading-40">9.3 è¾“å‡ºç¤ºä¾‹</h3>
<pre><code class="hljs language-sql" lang="sql">[<span class="hljs-keyword">SQL</span><span class="hljs-operator">-</span>Insight] <span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>api<span class="hljs-operator">/</span>users<span class="hljs-operator">/</span><span class="hljs-number">123</span> â†’ UserController.findById
   <span class="hljs-keyword">SQL</span>: <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">123</span> (<span class="hljs-number">15</span>ms) [Type: <span class="hljs-keyword">SELECT</span>]

[<span class="hljs-keyword">SQL</span><span class="hljs-operator">-</span>Insight] <span class="hljs-keyword">GET</span> <span class="hljs-operator">/</span>api<span class="hljs-operator">/</span>users<span class="hljs-operator">/</span>orders â†’ UserController.getUserOrders
   [SLOW] <span class="hljs-keyword">SQL</span>: <span class="hljs-keyword">SELECT</span> u.<span class="hljs-operator">*</span>, o.<span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> users u <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> orders o <span class="hljs-keyword">ON</span> u.id <span class="hljs-operator">=</span> o.user_id (<span class="hljs-number">56</span>ms) [Type: <span class="hljs-keyword">SELECT</span>]
</code></pre>
<hr/>
<h2 data-id="heading-41">åã€æ€»ç»“ä¸å±•æœ›</h2>
<h3 data-id="heading-42">10.1 æŠ€æœ¯æ€»ç»“</h3>
<p>SQLInsighté€šè¿‡ä¸‰ä¸ªæ ¸å¿ƒæŠ€æœ¯å®ç°äº†é›¶ä¾µå…¥çš„SQLç›‘æ§ï¼š</p>
<ol>
<li><strong>åŠ¨æ€ä»£ç†</strong>ï¼šåœ¨JDBCå±‚æ‹¦æˆªSQLæ‰§è¡Œï¼ˆå­¦ä¹ è‡ªSeataï¼‰</li>
<li><strong>StackTraceåˆ†æ</strong>ï¼šè‡ªåŠ¨è¿½è¸ªAPIè°ƒç”¨é“¾ï¼ˆå­¦ä¹ è‡ªMyBatisï¼‰</li>
<li><strong>BeanPostProcessor</strong>ï¼šè‡ªåŠ¨ä»£ç†DataSourceï¼ˆSpringçš„æ‰©å±•æœºåˆ¶ï¼‰</li>
</ol>
<p>è¿™ä¸‰ä¸ªæŠ€æœ¯çš„ç»„åˆï¼Œå®ç°äº†ï¼š</p>
<ul>
<li>é›¶é…ç½®é›†æˆ</li>
<li>é€æ˜ç›‘æ§</li>
<li>å®Œæ•´çš„è°ƒç”¨é“¾è¿½è¸ª</li>
<li>è‰¯å¥½çš„å…¼å®¹æ€§</li>
</ul>
<h3 data-id="heading-43">10.2 è®¾è®¡åŸåˆ™çš„è·µè¡Œ</h3>
<p>é¡¹ç›®ä½“ç°äº†å¤šä¸ªç»å…¸è®¾è®¡åŸåˆ™ï¼š</p>
<ul>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªç±»åªåšä¸€ä»¶äº‹</li>
<li><strong>å¼€é—­åŸåˆ™</strong>ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</li>
<li><strong>ä¾èµ–å€’ç½®</strong>ï¼šä¾èµ–æŠ½è±¡ï¼ˆJDBCæ¥å£ï¼‰ï¼Œä¸ä¾èµ–å…·ä½“å®ç°</li>
<li><strong>æœ€å°‘çŸ¥è¯†</strong>ï¼šåªå’ŒJDBCæ¥å£æ‰“äº¤é“</li>
<li><strong>ç»„åˆä¼˜äºç»§æ‰¿</strong>ï¼šç”¨ç»„åˆæ„å»ºåŠŸèƒ½</li>
</ul>
<h3 data-id="heading-44">10.3 æœªæ¥å±•æœ›</h3>
<p>SQLInsightè¿˜æœ‰å¾ˆå¤šå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼š</p>
<ol>
<li><strong>N+1æŸ¥è¯¢æ£€æµ‹</strong>ï¼šè‡ªåŠ¨è¯†åˆ«å¾ªç¯æŸ¥è¯¢é—®é¢˜</li>
<li><strong>Webæ§åˆ¶å°</strong>ï¼šæä¾›å¯è§†åŒ–çš„ç›‘æ§ç•Œé¢</li>
<li><strong>æ™ºèƒ½å»ºè®®</strong>ï¼šæ ¹æ®SQLæ‰§è¡Œæƒ…å†µç»™å‡ºä¼˜åŒ–å»ºè®®</li>
<li><strong>åˆ†å¸ƒå¼è¿½è¸ª</strong>ï¼šé›†æˆOpenTelemetryï¼Œæ”¯æŒåˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª</li>
<li><strong>SQLå®¡è®¡</strong>ï¼šè®°å½•æ‰€æœ‰SQLæ“ä½œï¼Œç”¨äºå®‰å…¨å®¡è®¡</li>
</ol>
<p>ä½†æ ¸å¿ƒæ€æƒ³ä¸ä¼šå˜ï¼š<strong>åœ¨æœ€åº•å±‚åšæ‹¦æˆªï¼Œä¿æŒå¯¹ä¸šåŠ¡ä»£ç çš„é›¶ä¾µå…¥</strong>ã€‚</p>
<hr/>
<h2 data-id="heading-45">åä¸€ã€å†™åœ¨æœ€å</h2>
<p>åšè¿™ä¸ªé¡¹ç›®ï¼Œæœ€å¤§çš„æ”¶è·ä¸æ˜¯å†™äº†å¤šå°‘è¡Œä»£ç ï¼Œè€Œæ˜¯ç†è§£äº†<strong>è®¾è®¡æ€æƒ³çš„ä¼ æ‰¿</strong>ã€‚</p>
<p>Seataçš„åŠ¨æ€ä»£ç†ã€MyBatisçš„StackTraceåˆ†æï¼Œè¿™äº›éƒ½æ˜¯å‰äººæ™ºæ…§çš„ç»“æ™¶ã€‚æˆ‘ä»¬ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼ŒæŠŠè¿™äº›æ€æƒ³ç»„åˆèµ·æ¥ï¼Œåˆ›é€ å‡ºæ–°çš„ä»·å€¼ã€‚</p>
<p>æŠ€æœ¯çš„æœ¬è´¨ä¸æ˜¯ç‚«æŠ€ï¼Œè€Œæ˜¯è§£å†³é—®é¢˜ã€‚SQLInsightè§£å†³çš„é—®é¢˜å¾ˆç®€å•ï¼šè®©å¼€å‘è€…çŸ¥é“æ¯ä¸ªAPIæ‰§è¡Œäº†å“ªäº›SQLï¼Œç”¨äº†å¤šé•¿æ—¶é—´ã€‚ä½†å®ç°è¿™ä¸ªç®€å•çš„ç›®æ ‡ï¼Œéœ€è¦æ·±å…¥ç†è§£JDBCã€åŠ¨æ€ä»£ç†ã€åå°„ã€çº¿ç¨‹æ ˆç­‰å¤šä¸ªæŠ€æœ¯ç‚¹ã€‚</p>
<p><strong>å¥½çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œåº”è¯¥æ˜¯ç®€å•çš„ã€‚</strong></p>
<p>å¯¹ä½¿ç”¨è€…æ¥è¯´ï¼Œåªéœ€è¦åŠ ä¸€ä¸ªä¾èµ–ã€‚å¯¹è®¾è®¡è€…æ¥è¯´ï¼Œéœ€è¦è€ƒè™‘æ€§èƒ½ã€å…¼å®¹æ€§ã€æ‰©å±•æ€§ã€å¯ç»´æŠ¤æ€§ç­‰å¤šä¸ªç»´åº¦ã€‚</p>
<p>è¿™å°±æ˜¯æŠ€æœ¯çš„é­…åŠ›ï¼šè¡¨é¢ç®€å•ï¼Œå†…åœ¨å¤æ‚ï¼›å¯¹å¤–æ˜“ç”¨ï¼Œå¯¹å†…ç²¾å·§ã€‚</p>
<p>å¸Œæœ›è¿™ç¯‡æ–‡æ¡£èƒ½å¸®åŠ©ä½ ç†è§£SQLInsightçš„è®¾è®¡æ€è·¯ï¼Œä¹Ÿå¸Œæœ›è¿™äº›è®¾è®¡æ€æƒ³èƒ½å¯¹ä½ æœªæ¥çš„é¡¹ç›®æœ‰æ‰€å¯å‘ã€‚</p>
<hr/>
<h2 data-id="heading-46">åäºŒã€å¼€å‘è®°å½•</h2>
<p>ä»æƒ³æ³•åˆ°å®ç°ï¼ŒèŠ±äº†å°ä¸€å‘¨æ—¶é—´ã€‚</p>
<p>åˆšå¼€å§‹å†™ä»£ç çš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸å°‘å‘ï¼š</p>
<ul>
<li>PreparedStatementçš„å‚æ•°ç´¢å¼•ä»1å¼€å§‹ï¼Œè€Œä¸æ˜¯0ï¼ˆJDBCè§„èŒƒï¼‰</li>
<li>StackTraceæ‰«ææ—¶è¦æ³¨æ„ClassNotFoundException</li>
<li>åŠ¨æ€ä»£ç†è¦å®Œæ•´å®ç°æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼Œä¸ç„¶ä¼šNPE</li>
<li>ç¼“å­˜ç­–ç•¥è¦åšå¥½ï¼Œä¸ç„¶æ€§èƒ½ä¼šå—å½±å“</li>
</ul>
<p>è°ƒè¯•çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹JDBCæ ‡å‡†ã€JavaåŠ¨æ€ä»£ç†ã€åå°„æœºåˆ¶æœ‰äº†æ›´æ·±çš„ç†è§£ã€‚çœ‹ä¼¼ç®€å•çš„"æ‹¦æˆªSQLæ‰§è¡Œ"ï¼ŒèƒŒåæ¶‰åŠçš„æŠ€æœ¯ç‚¹æ¯”æƒ³è±¡ä¸­è¦å¤šã€‚</p>
<p>ä»Šå¤©å‘¨æœ«ï¼Œç»ˆäºæŠŠå‘éƒ½å¡«å®Œäº†ï¼Œä»£ç ä¹Ÿå¼€æºäº†ã€‚ç®—æ˜¯è¿˜äº†ä¸Šå‘¨æ–‡ç« çš„å€ºã€‚</p>
<p>å¦‚æœä½ åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œæˆ–è€…æœ‰ä»€ä¹ˆæƒ³æ³•å»ºè®®ï¼Œæ¬¢è¿æIssueæˆ–PRã€‚</p>
<hr/>
<p><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgitee.com%2Fsh_wangwanbao%2Fsql-insight" target="_blank" title="https://gitee.com/sh_wangwanbao/sql-insight" ref="nofollow noopener noreferrer">gitee.com/sh_wangwanbâ€¦</a><br/>
<strong>ä¸Šä¸€ç¯‡æ–‡ç« </strong>ï¼š<a href="https://juejin.cn/post/7591513171199295551" target="_blank" title="https://juejin.cn/post/7591513171199295551">SQLInsightï¼šä¸€è¡Œä¾èµ–ï¼Œè‡ªåŠ¨è¿½è¸ªAPIèƒŒåçš„æ¯ä¸€æ¡SQL</a><br/>
<strong>å¼€æºåè®®</strong>ï¼šMIT License<br/>
<strong>æ¬¢è¿åé¦ˆ</strong>ï¼šæIssueã€PRï¼Œæˆ–è€…ç•™è¨€è®¨è®º</p>
<hr/>
<p><em>å†™ä»£ç çš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯å­¦ä¹ çš„è¿‡ç¨‹ã€‚å¸Œæœ›SQLInsightèƒ½å¸®åˆ°ä½ ï¼Œä¹Ÿæ¬¢è¿ä¸€èµ·å®Œå–„å®ƒã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ç¬¬11ç«  LangChain]]></title>    <link>https://juejin.cn/post/7593258683750531106</link>    <guid>https://juejin.cn/post/7593258683750531106</guid>    <pubDate>2026-01-10T08:28:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593258683750531106" data-draft-id="7593262196843741236" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ç¬¬11ç«  LangChain"/> <meta itemprop="keywords" content="LangChain,å‰ç«¯,JavaScript"/> <meta itemprop="datePublished" content="2026-01-10T08:28:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="XiaoYu2002"/> <meta itemprop="url" content="https://juejin.cn/user/251124329220663"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ç¬¬11ç«  LangChain
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/251124329220663/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    XiaoYu2002
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T08:28:33.000Z" title="Sat Jan 10 2026 08:28:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»11åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;color:rgba(46,36,36,.87);overflow-x:hidden}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{margin-bottom:5px;font-size:30px;font-weight:500}.markdown-body h1:before{content:"#";margin-right:10px;color:#1976d2}.markdown-body h2{font-size:28px;font-weight:400;border-left:5px solid #454545;margin-top:20px;padding-left:10px;transition:all .3s ease-in-out}.markdown-body h2:hover{border-color:#1976d2}.markdown-body h3{font-size:24px;font-weight:400;margin-top:15px;padding-bottom:0}.markdown-body h4{font-size:20px;font-weight:500}.markdown-body h5{font-size:16px}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h2:first-letter,.markdown-body h3:first-letter,.markdown-body p:first-letter{text-transform:capitalize}.markdown-body em{text-emphasis:dot;text-emphasis-position:under}.markdown-body img{display:block;margin:0 auto!important;max-width:100%;border-radius:2px;box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)!important}.markdown-body hr{position:relative;width:98%;height:1px;border:none;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,#ddd,#999,#ddd);overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background:#fff;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center}.markdown-body code{font-weight:900;word-break:break-word;border-radius:2px;overflow-x:auto;font-size:.87em;padding:.065em .4em;background-color:#fbe5e1;color:#c0341d}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border-radius:0 4px}.markdown-body pre&gt;code{font-weight:400;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{margin:0 4px;text-decoration:none;color:#027fff;transition:all .3s ease-in-out;padding-bottom:4px;border-bottom:2px solid transparent}.markdown-body a:after{content:"";display:inline-block;width:18px;height:18px;margin-left:4px;vertical-align:middle;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2U9IiMwMjdGRkYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PHBhdGggZD0iTTkuODE1IDYuNDQ4bDEuOTM2LTEuOTM2YzEuMzM3LTEuMzM2IDMuNTgtMS4yNTkgNS4wMTMuMTczIDEuNDMyIDEuNDMyIDEuNTEgMy42NzYuMTczIDUuMDEzbC0xLjQ1MiAxLjQ1Mi0uOTY4Ljk2OGMtMS4zMzcgMS4zMzYtMy41ODEgMS4yNTktNS4wMTMtLjE3MyIvPjxwYXRoIGQ9Ik0xMS4yNjcgMTUuMzY3bC0xLjkzNiAxLjkzNmMtMS4zMzYgMS4zMzctMy41OCAxLjI2LTUuMDEyLS4xNzMtMS40MzItMS40MzItMS41MS0zLjY3Ni0uMTczLTUuMDEybDEuNDUyLTEuNDUyLjk2OC0uOTY4YzEuMzM2LTEuMzM3IDMuNTgtMS4yNiA1LjAxMi4xNzMiLz48L2c+PC9zdmc+);background-size:cover;background-repeat:no-repeat}.markdown-body a:hover{border-color:#027fff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body a.footnote-backref:after,.markdown-body a.footnote-ref:after,.markdown-body sup a:after{display:none!important}.markdown-body table{margin:0 auto 10px;font-size:12px;width:auto;max-width:100%;overflow:auto;border:2px solid #c6c6c6}.markdown-body table img{box-shadow:none!important}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body del{color:rgba(0,0,0,.6)}.markdown-body blockquote{position:relative;color:#666;padding:5px 23px 1px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:hsla(0,0%,78.4%,.12);transition:all .2s ease-in-out}.markdown-body blockquote:hover{border-color:#1976d2}.markdown-body blockquote:after,.markdown-body blockquote:before{position:absolute;font-size:24px;font-weight:800;line-height:24px;color:#cbcbcb;opacity:.6}.markdown-body blockquote:before{content:"â€œ";top:4px;left:6px}.markdown-body blockquote:after{content:"â€";right:8px;bottom:-8px}.markdown-body blockquote&gt;p,.markdown-body blockquote blockquote{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body details{outline:none;border:none;border-left:4px solid #1976d2;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary:hover::-webkit-details-marker{color:#1976d2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>LangChain æ˜¯ä¸€ä¸ªç”¨äºå¼€å‘åŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åº”ç”¨ç¨‹åºçš„å¼€æºæ¡†æ¶ï¼Œå®ƒé€šè¿‡æä¾›æ¨¡å—åŒ–çš„æŠ½è±¡ç»„ä»¶å’Œé“¾å¼è°ƒç”¨å·¥å…·ï¼Œå°† LLM ä¸å¤–éƒ¨æ•°æ®æºï¼ˆå¦‚æ–‡æ¡£ã€æ•°æ®åº“ï¼‰å’Œè®¡ç®—å·¥å…·ï¼ˆå¦‚æœç´¢å¼•æ“ã€ä»£ç è§£é‡Šå™¨ï¼‰æ™ºèƒ½è¿æ¥ï¼Œä»è€Œæ„å»ºå‡ºå…·å¤‡è®°å¿†ã€æ¨ç†å’Œè¡ŒåŠ¨èƒ½åŠ›çš„å¢å¼ºå‹ AI åº”ç”¨ï¼Œå…¸å‹åœºæ™¯åŒ…æ‹¬æ™ºèƒ½é—®ç­”ã€å†…å®¹ç”Ÿæˆå’Œæ™ºèƒ½ä½“ï¼ˆAgentï¼‰ç³»ç»Ÿã€‚</p>
<p>LangChainå®˜æ–¹æ–‡æ¡£ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.langchain.com%2F%25E3%2580%2582%25E7%25BD%2591%25E5%259D%2580%25E7%259A%2584%25E7%25BB%2584%25E6%2588%2590%25E9%2580%25BB%25E8%25BE%2591%25E5%2592%258CNest.js%25E5%25AE%2598%25E6%2596%25B9%25E6%2596%2587%25E6%25A1%25A3%25E7%25B1%25BB%25E4%25BC%25BC%25EF%25BC%258C%25E5%258D%25B3docs.%25E5%2590%258D%25E7%25A7%25B0.com%25E3%2580%2582" target="_blank" title="https://docs.langchain.com/%E3%80%82%E7%BD%91%E5%9D%80%E7%9A%84%E7%BB%84%E6%88%90%E9%80%BB%E8%BE%91%E5%92%8CNest.js%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%B1%BB%E4%BC%BC%EF%BC%8C%E5%8D%B3docs.%E5%90%8D%E7%A7%B0.com%E3%80%82" ref="nofollow noopener noreferrer">docs.langchain.com/ã€‚ç½‘å€çš„ç»„æˆé€»è¾‘å’ŒNeâ€¦</a></p>
<p>LangChainæ”¯æŒPythonå’ŒTypeScriptä¸¤ç§ç¼–ç¨‹è¯­è¨€ï¼Œå¦‚å›¾11-1æ‰€ç¤ºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0decd565cb6f4105b0822cac46543c94~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWGlhb1l1MjAwMg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768638513&amp;x-signature=MHeeA5CYwSQTKaMV8bpJw4pEuJw%3D" alt="image-20251219041533100" loading="lazy"/></p>
<p align="center">
 <b> å›¾11-1 LangChainå¼€æºä»£ç†æ¡†æ¶-è¯­è¨€é€‰é¡¹</b>
</p>
<p>LangChainå¼€æºä»£ç†æ¡†æ¶æœ‰3ç§é€‰æ‹©æ–¹æ¡ˆï¼š</p>
<p>ï¼ˆ1ï¼‰LangChainï¼šä¸€äº›æ™®é€šå¯¹è¯ï¼ŒéŸ³é¢‘è¯†åˆ«ã€æ–‡å­—ç”Ÿæˆï¼Œå›¾ç‰‡ç”Ÿæˆç­‰ç­‰ä¸AIGCç›¸å…³çš„ï¼Œç”¨è¿™é€‰æ‹©æ–¹æ¡ˆå°±å¤Ÿäº†ã€‚</p>
<p>ï¼ˆ2ï¼‰LangGraphï¼šæƒ³åšå·¥ä½œæµï¼Œç±»ä¼¼Difyï¼ŒCozeï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨è¯¥æ–¹æ¡ˆã€‚</p>
<p>ï¼ˆ3ï¼‰Deep Agentsï¼šæƒ³åšä¸€äº›å¤§å‹çš„AIç›¸å…³é«˜çº§åº”ç”¨ï¼Œå°±éœ€è¦ä½¿ç”¨è¯¥æ–¹æ¡ˆï¼ŒDeep Agentsæ˜¯æ·±åº¦é›†æˆçš„æ„æ€ã€‚</p>
<p>LangChain ä½œä¸ºåŸºç¡€æ¡†æ¶ï¼Œé€‚åˆæ„å»ºå¸¸è§„çš„AIGCåº”ç”¨ï¼ˆå¦‚å¯¹è¯ã€æ–‡ç”Ÿå›¾ï¼‰ï¼›LangGraph ä¸“æ³¨äºé€šè¿‡æœ‰çŠ¶æ€ã€å¯å¾ªç¯çš„å›¾ç»“æ„æ¥ç¼–æ’å¤æ‚ã€å¤šæ­¥éª¤çš„æ™ºèƒ½ä½“å·¥ä½œæµï¼Œæ˜¯å¼€å‘ç±»Dify/Cozeå¹³å°æˆ–è‡ªåŠ¨åŒ–ä¸šåŠ¡æµç¨‹çš„æ ¸å¿ƒé€‰æ‹©ï¼›è€Œ Deep Agents åˆ™ä»£è¡¨äº†ä¸€ç§æ›´æ·±åº¦é›†æˆã€èƒ½å¤„ç†é«˜å¤æ‚åº¦ä»»åŠ¡ä¸è‡ªä¸»å†³ç­–çš„é«˜çº§æ™ºèƒ½ä½“æ¶æ„ï¼Œå¸¸ç”¨äºéœ€è¦å¤šæ™ºèƒ½ä½“åä½œæˆ–æ¨¡æ‹Ÿäººç±»å·¥ä½œæµçš„å¤§å‹ä¼ä¸šçº§AIåº”ç”¨ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œå­¦ä¹ çš„è¯ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªLangChainå°±å®Œå…¨å¤Ÿç”¨ã€‚LangChainä¸‹è½½ä½¿ç”¨è¯´æ˜å¦‚å›¾11-2æ‰€ç¤ºã€‚æˆ‘ä»¬ç‚¹å‡»å¦‚å›¾11-1æ‰€ç¤ºçš„ç¬¬ä¸€ä¸ªé€‰é¡¹åï¼Œä¼šè·³è½¬åˆ°å¦‚å›¾11-2æ‰€ç¤ºçš„ç•Œé¢ï¼Œéœ€è¦ç‚¹å‡»å·¦ä¾§è¾¹æ çš„installé€‰é¡¹ã€‚å®˜æ–¹æ–‡æ¡£æœ‰å¯¹åº”çš„ä½¿ç”¨è¯´æ˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/da1162df520b4c888fd7af9b16653f12~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWGlhb1l1MjAwMg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768638513&amp;x-signature=WHqI5tvJ5CV9ekFa4KAdTalfw%2FI%3D" alt="image-20251219042243761" loading="lazy"/></p>
<p align="center">
 <b> å›¾11-2 LangChainä¸‹è½½ä½¿ç”¨è¯´æ˜</b>
</p>
## 11.1 åˆå§‹åŒ–é¡¹ç›®
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å¼€å§‹åˆå§‹åŒ–è¿™æ¬¡çš„é¡¹ç›®ã€‚ä¼šæ²¿ç”¨ç¬¬10ç«  SSEé­”æ”¹çš„ä»£ç ï¼Œåœ¨è¯¥åŸºç¡€ä¸Šï¼Œéœ€è¦è¡¥å……ä»¥ä¸‹å®‰è£…æ­¥éª¤ï¼š</p>
<p>ï¼ˆ1ï¼‰@langchain/coreï¼šLangChain çš„æ ¸å¿ƒåŸºç¡€åº“ï¼ŒåŒ…å«é“¾ã€æç¤ºæ¨¡æ¿ã€æ£€ç´¢å™¨ç­‰æ ¸å¿ƒæŠ½è±¡ã€‚</p>
<p>ï¼ˆ2ï¼‰@langchain/deepseekï¼š LangChain ä¸ºDeepSeek æ¨¡å‹ä¸“é—¨æä¾›çš„é›†æˆåŒ…ï¼Œè®©æˆ‘ä»¬èƒ½åœ¨ LangChain æ¡†æ¶ä¸­ç›´æ¥è°ƒç”¨ DeepSeek çš„ APIã€‚å®‰è£…è§„åˆ™æ˜¯@langchain/æ‰€éœ€AIå¤§æ¨¡å‹ï¼Œä¾‹å¦‚@langchain/openaiã€‚</p>
<p>ï¼ˆ3ï¼‰langchainï¼šLangChain çš„ä¸»åŒ…ï¼Œæä¾›äº†é«˜çº§ã€æ˜“äºä½¿ç”¨çš„æ¥å£æ¥ç»„åˆå’Œä½¿ç”¨ LLMã€‚</p>
<p>å®‰è£…LangChainä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªAIå¤§æ¨¡å‹æ¥æ”¯æŒï¼Œåœ¨è¿™æ¬¡ç¤ºä¾‹ä¸­ï¼Œé€‰æ‹©DeepSeekï¼Œå› ä¸ºå®ƒçš„APIéå¸¸ä¾¿å®œã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ç»ˆç«¯æ‰§è¡Œå‘½ä»¤</span>
npm install <span class="hljs-meta">@langchain</span>/core <span class="hljs-meta">@langchain</span>/deepseek langchain
</code></pre>
<p>å®‰è£…ä¹‹åçš„package.jsonæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<pre><code class="hljs language-ts" lang="ts">{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"module"</span>,
  <span class="hljs-string">"dependencies"</span>: {
    <span class="hljs-string">"@langchain/core"</span>: <span class="hljs-string">"^1.1.6"</span>,
    <span class="hljs-string">"@langchain/deepseek"</span>: <span class="hljs-string">"^1.0.3"</span>,
    <span class="hljs-string">"@types/cors"</span>: <span class="hljs-string">"^2.8.19"</span>,
    <span class="hljs-string">"@types/express"</span>: <span class="hljs-string">"^5.0.6"</span>,
    <span class="hljs-string">"cors"</span>: <span class="hljs-string">"^2.8.5"</span>,
    <span class="hljs-string">"express"</span>: <span class="hljs-string">"^5.2.1"</span>,
    <span class="hljs-string">"langchain"</span>: <span class="hljs-string">"^1.2.1"</span>
  }
}
</code></pre>
<p>ç”±äºæˆ‘ä»¬åœ¨7.1å°èŠ‚å·²ç»å‡çº§è¿‡Node.jsç‰ˆæœ¬ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ç”¨Node.jså»è¿è¡Œtsåç¼€æ–‡ä»¶ï¼Œæ»¡è¶³Node.jsç‰ˆæœ¬å¤§äº23çš„éƒ½å¯ä»¥è¿™ä¹ˆåšï¼Œå¦‚æœæ— æ³•è¿è¡Œtsåç¼€æ–‡ä»¶ï¼Œéœ€è¦æ£€æŸ¥ä¸€ä¸‹Node.jsç‰ˆæœ¬æˆ–è€…é‡‡ç”¨ts-nodeã€‚</p>
<p>æ¥ä¸‹æ¥åˆ°index.tsæ–‡ä»¶ä¸­åˆå§‹åŒ–åç«¯æœåŠ¡ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// index.ts</span>
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>
<span class="hljs-keyword">import</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">'cors'</span>

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>())
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>())

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/chat'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; { })

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Server is running on port 3000'</span>)
})
</code></pre>
<h2 data-id="heading-0">11.2 æ¥å…¥å¤§æ¨¡å‹</h2>
<p>æ¥ç€æ¥å…¥æˆ‘ä»¬çš„AIå¤§æ¨¡å‹DeepSeekï¼Œè¿˜æ˜¯åœ¨index.tsæ–‡ä»¶ä¸­ã€‚</p>
<p>åœ¨è¿™é‡Œå¼•å…¥äº†ä¸€ä¸ªkey.tsæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å­˜æ”¾ç€DeepSeek APIçš„Keyã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/deepseek'</span>
<span class="hljs-keyword">import</span> { key } <span class="hljs-keyword">from</span> <span class="hljs-string">'./key.ts'</span>
<span class="hljs-keyword">const</span> deepseek = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
    <span class="hljs-attr">apiKey</span>: key,
    <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
    <span class="hljs-attr">temperature</span>: <span class="hljs-number">1.3</span>,
    <span class="hljs-attr">maxTokens</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">//500-600ä¸ªæ±‰å­—</span>
    <span class="hljs-attr">topP</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">//è®¾å¾—è¶Šå°ï¼ŒAI è¯´è¯è¶Š"æ­»æ¿"ï¼›è®¾å¾—è¶Šå¤§ï¼ŒAI è¯´è¯è¶Š"æ”¾é£è‡ªæˆ‘"</span>
    <span class="hljs-attr">frequencyPenalty</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">//é˜²å¤è¯»æœºè¯‰ AIï¼š"ä½ åˆ«è€é‡å¤åŒä¸€ä¸ªè¯ï¼"-2   2</span>
    <span class="hljs-attr">presencePenalty</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">//é¼“åŠ±æ¢è¯é¢˜å‘Šè¯‰ AIï¼š"åˆ«è€èŠåŒä¸€ä»¶äº‹ï¼" -2   2</span>
})
</code></pre>
<p>è·å–DeepSeekçš„keyï¼Œå¦‚ä¸‹4æ­¥éª¤ï¼š</p>
<p>ï¼ˆ1ï¼‰æ‰“å¼€DeepSeekçš„APIå¼€æ”¾å¹³å°ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.deepseek.com%2F" target="_blank" title="https://platform.deepseek.com/" ref="nofollow noopener noreferrer">platform.deepseek.com/</a>ã€‚</p>
<p>ï¼ˆ2ï¼‰å¾®ä¿¡æ‰«ç ç™»å½•ï¼Œå»å®åè®¤è¯ã€‚</p>
<p>ï¼ˆ3ï¼‰ç‚¹å‡»å·¦ä¾§è¾¹æ çš„ç”¨é‡ä¿¡æ¯é€‰æ‹©å»å……å€¼é€‰é¡¹ï¼Œæœ‰åœ¨çº¿å……å€¼å’Œå¯¹å…¬æ±‡æ¬¾ä¸¤ä¸ªé€‰é¡¹ï¼Œé€‰æ‹©åœ¨çº¿å……å€¼ï¼Œè‡ªå®šä¹‰è¾“å…¥1å—é’±ï¼ˆå¤Ÿç”¨äº†ï¼‰ï¼Œç„¶åè‡ªå·±é€‰æ‹©æ”¯ä»˜å®æˆ–è€…å¾®ä¿¡æ”¯ä»˜å»ä»˜æ¬¾ã€‚</p>
<p>ï¼ˆ4ï¼‰ä»˜æ¬¾æˆåŠŸåï¼Œç‚¹å‡»å·¦ä¾§è¾¹æ çš„API keysé€‰é¡¹ï¼Œåˆ›å»ºAPI keyï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªåç§°ï¼ˆä¸­è‹±æ–‡éƒ½å¯ä»¥ï¼‰ï¼Œç„¶åä¼šå¼¹å‡ºkeyå€¼ï¼Œæ­¤æ—¶å¤åˆ¶keyå€¼å†å…³é—­å¼¹çª—ï¼Œå› ä¸ºå½“ä½ å…³é—­åï¼Œå°±å†ä¹Ÿæ‹¿ä¸åˆ°è¿™ä¸ªkeyå€¼äº†ã€‚å¿˜è®°å°±åªèƒ½é‡æ–°å†å»ºä¸€ä¸ªï¼ŒDeepSeekä¼šæé†’ä½ çš„ï¼Œå¦‚å›¾11-3æ‰€ç¤ºã€‚</p>
<p>å‹æƒ…æç¤ºï¼šä¿æŠ¤å¥½ä½ çš„keyå€¼ï¼Œåˆ«æš´éœ²åœ¨å…¬ç½‘ä¸­ï¼Œåœ¨å¼€æºé¡¹ç›®ä¸Šä¼ GitHubä¸­ï¼Œå¯ä»¥è®©gitå¿½ç•¥key.tsæ–‡ä»¶ã€‚æˆ–è€…å¦‚æœä½ çš„DeepSeek APIå°±åªå……äº†1å—é’±ï¼Œç„¶åç”¨å¾—å‰©å‡ æ¯›é’±ï¼Œå¹¶ä¸”ä»¥åéƒ½ä¸æ€ä¹ˆæ‰“ç®—å……ï¼Œé‚£æƒ³ä¸æƒ³ä¿æŠ¤keyå€¼ï¼Œå°±çœ‹ä½ å¿ƒæƒ…äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9013c784c7f24b3ba730495b375da82d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWGlhb1l1MjAwMg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768638513&amp;x-signature=SkefVPDl8t1SPeYGB%2B9tEUCcaQc%3D" alt="image.png" loading="lazy"/></p>
<p align="center">
 <b> å›¾11-3 åˆ›å»ºAPI keyæ³¨æ„äº‹é¡¹</b>
</p>
<p>é€šè¿‡ä»¥ä¸Šæ­¥éª¤è·å–åˆ°DeepSeekçš„keyå€¼åï¼Œåœ¨é¡¹ç›®åˆ›å»ºkey.tsæ–‡ä»¶ï¼Œåˆ›å»ºå¸¸é‡keyï¼Œå¡«å…¥ä½ çš„keyå€¼å¹¶å¯¼å‡ºã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> key = <span class="hljs-string">'ä½ DeepSeekçš„keyå€¼'</span>
</code></pre>
<p>å›åˆ°index.tsæ–‡ä»¶ï¼Œæ¥å…¥DeepSeekå¤§æ¨¡å‹ä¹‹åï¼ŒChatDeepSeekæœ‰ä¸€ä¸ªmodelå­—æ®µï¼Œè¿™æ˜¯ç”¨äºé€‰æ‹©æˆ‘ä»¬æ¨¡å‹çš„ã€‚å·²æœ‰çš„æ¨¡å‹ç±»å‹éœ€è¦ä»DeepSeekå®˜æ–¹æ–‡æ¡£ä¸­è·å–ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fapi-docs.deepseek.com%2Fzh-cn%2Fquick_start%2Fpricing" target="_blank" title="https://api-docs.deepseek.com/zh-cn/quick_start/pricing" ref="nofollow noopener noreferrer">æ¨¡å‹ &amp; ä»·æ ¼ | DeepSeek API Docs</a>ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// DeepSeekå­—æ®µ</span>
<span class="hljs-attr">apiKey</span>: key,
<span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
<span class="hljs-attr">temperature</span>: <span class="hljs-number">1.3</span>,
<span class="hljs-attr">maxTokens</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// 500-600ä¸ªæ±‰å­—</span>
<span class="hljs-attr">topP</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// è®¾å¾—è¶Šå°ï¼ŒAI è¯´è¯è¶Š"æ­»æ¿"ï¼›è®¾å¾—è¶Šå¤§ï¼ŒAI è¯´è¯è¶Š"æ”¾é£è‡ªæˆ‘"</span>
<span class="hljs-attr">frequencyPenalty</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">// é˜²å¤è¯»æœºè¯‰ AIï¼š"ä½ åˆ«è€é‡å¤åŒä¸€ä¸ªè¯ï¼"-2   2</span>
<span class="hljs-attr">presencePenalty</span>: <span class="hljs-number">0</span>,<span class="hljs-comment">// é¼“åŠ±æ¢è¯é¢˜å‘Šè¯‰ AIï¼š"åˆ«è€èŠåŒä¸€ä»¶äº‹ï¼" -2   2</span>
</code></pre>
<p>ç›®å‰å¯é€‰çš„æ¨¡å‹æœ‰deepseek-chatå’Œdeepseek-reasonerã€‚DeepSeekå®˜ç½‘ä»·æ ¼è®¡ç®—æ˜¯ä»¥ç™¾ä¸‡Tokenä¸ºå•ä½ï¼Œå…¶ä¸­1 ä¸ªè‹±æ–‡å­—ç¬¦ â‰ˆ 0.3 ä¸ª tokenï¼›1 ä¸ªä¸­æ–‡å­—ç¬¦ â‰ˆ 0.6 ä¸ª tokenã€‚åªè¦å¤§æ¦‚çŸ¥é“å¾ˆä¾¿å®œå°±è¶³å¤Ÿäº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4333a60653334151b832d8eaa7663532~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWGlhb1l1MjAwMg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768638513&amp;x-signature=rzQmAfUQ5NHRpYaM98NeratuXwI%3D" alt="image-20251219050542592" loading="lazy"/></p>
<p align="center">
 <b> å›¾11-4 DeepSeekæ¨¡å‹é€‰æ‹©</b>
</p>
<p>temperatureå­—æ®µæ˜¯æ¸©åº¦çš„å«ä¹‰ï¼Œåœ¨DeepSeekå®˜æ–¹æ–‡æ¡£ä¸­æœ‰ç›´æ¥ç»™å‡ºå¯¹åº”çš„å»ºè®®ï¼Œæˆ‘ä»¬çš„ç¤ºä¾‹æ˜¯æ‰“ç®—ç”¨äºå¯¹è¯ï¼Œå› æ­¤è®¾ç½®1.3å°±è¶³å¤Ÿäº†ï¼ŒTemperatureå‚æ•°è®¾ç½®å¦‚å›¾11-5æ‰€ç¤ºã€‚</p>
<p>ä»åº”ç”¨åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºtemperatureå­—æ®µå¤§æ¦‚æ˜¯ç†æ€§ä¸æ„Ÿæ€§çš„æƒè¡¡åº¦ï¼Œé€»è¾‘æ€§è¶Šå¼ºçš„åœºæ™¯ï¼Œæ¸©åº¦è¶Šä½ï¼›è¶Šæ„Ÿæ€§çš„åœºæ™¯æ¸©åº¦è¶Šé«˜ã€‚æ‰€æœ‰AIå¤§æ¨¡å‹éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œä»ä»–ä»¬å¯¹åº”çš„å®˜æ–¹æ–‡æ¡£å»è·å–å¯¹åº”ä¿¡æ¯å°±å¯ä»¥äº†ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38c09d7f2ecf4117a23169fbd1cdf885~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWGlhb1l1MjAwMg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768638513&amp;x-signature=iwwwFnK%2B2IIhQ0IWhjm8v3nZhJ4%3D" alt="image-20251219050952588" loading="lazy"/></p>
<p align="center">
 <b> å›¾11-5 DeepSeekæ¨¡å‹-Temperatureå‚æ•°è®¾ç½®</b>
</p>
<p>å…¶ä½™4ä¸ªå‚æ•°maxTokensã€topPï¼ŒfrequencyPenaltyå’ŒpresencePenaltyå¦‚ä¸‹ï¼š</p>
<p>ï¼ˆ1ï¼‰maxTokens ç›´æ¥å†³å®šäº† AI å›å¤çš„æœ€å¤§é•¿åº¦ï¼Œé™åˆ¶äº†å•æ¬¡å“åº”çš„æ–‡æœ¬é‡ï¼›</p>
<p>ï¼ˆ2ï¼‰topPï¼ˆæ ¸é‡‡æ ·å‚æ•°ï¼‰é€šè¿‡æ§åˆ¶å€™é€‰è¯çš„æ¦‚ç‡åˆ†å¸ƒæ¥å½±å“æ–‡æœ¬çš„åˆ›é€ æ€§ä¸ç¨³å®šæ€§â€”â€”å€¼è¶Šä½åˆ™ AI çš„é€‰è¯è¶Šé›†ä¸­å’Œå¯é¢„æµ‹ï¼Œè¾“å‡ºè¶‹äºâ€œæ­»æ¿â€ï¼Œå€¼è¶Šé«˜åˆ™é€‰è¯èŒƒå›´è¶Šå®½ï¼Œè¾“å‡ºè¶Šâ€œæ”¾é£è‡ªæˆ‘â€å¹¶å¯Œæœ‰åˆ›æ„ã€‚</p>
<p>ï¼ˆ3ï¼‰è€Œ frequencyPenalty ä¸ presencePenalty åˆ™åˆ†åˆ«ä»è¯é¢‘å’Œè¯é¢˜å±‚é¢æŠ‘åˆ¶é‡å¤ï¼šfrequencyPenalty æ­£å€¼ä¼šæƒ©ç½šåœ¨å½“å‰å›å¤ä¸­å·²ç»é¢‘ç¹å‡ºç°çš„è¯è¯­ï¼Œä¿ƒä½¿ç”¨è¯æ›´åŠ å¤šæ ·ï¼›presencePenalty æ­£å€¼åˆ™ä¼šæƒ©ç½šåœ¨å·²ç”Ÿæˆçš„ä¸Šä¸‹æ–‡ä¸­å‡ºç°è¿‡çš„æ‰€æœ‰ä¸»é¢˜ï¼Œé¼“åŠ± AI ä¸»åŠ¨åˆ‡æ¢åˆ°æ–°çš„è¯é¢˜æˆ–è§’åº¦ï¼Œä»è€Œå…±åŒç¡®ä¿ç”Ÿæˆå†…å®¹çš„å¤šæ ·æ€§å’Œè¿è´¯æ€§ï¼Œé¿å…é™·å…¥å•è°ƒæˆ–å¾ªç¯é‡å¤çš„è¡¨è¾¾ã€‚</p>
<p>è¿™äº›å€¼å…·ä½“è®¾ç½®å¤šå°‘ï¼Œåˆ™éœ€è¦æ ¹æ®å…·ä½“åœºæ™¯çš„ç»éªŒä»¥åŠè‡ªèº«çš„ç†è§£ï¼Œæ¨èçœ‹æˆ‘å†™çš„AIä½¿ç”¨æ‰‹å†Œï¼Œå¼€å¤´æœ‰è®²è§£åˆ°è¿™ä¸€éƒ¨åˆ†æ³¨æ„åŠ›æœºåˆ¶ï¼š<a href="https://juejin.cn/post/7564351324860612623" target="_blank" title="https://juejin.cn/post/7564351324860612623">AIç²¾å‡†æé—®æ‰‹å†Œï¼šä»æ¨¡ç³Šéœ€æ±‚åˆ°ç²¾å‡†è¾“å‡ºçš„æ ¸å¿ƒæŠ€èƒ½ï¼ˆä¸Šï¼‰</a>ã€‚</p>
<h2 data-id="heading-1">11.3 AIå¯¹è¯</h2>
<p>æ¥ä¸‹æ¥éœ€è¦ä»langchainå¼•å…¥createAgentæ–¹æ³•ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬è®¾ç½®å¥½çš„deepseekå®ä¾‹å¯¹è±¡ã€‚æˆ‘ä»¬è°ƒç”¨agentèº«ä¸Šçš„invoke()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ›´é€‚åˆå•æ¬¡è¾“å‡ºï¼ˆä¸€æ¬¡æ€§ç›´æ¥è¿”å›ï¼‰ï¼Œå³éæµå¼è¿”å›ã€‚</p>
<p>é€šè¿‡createAgentæ–¹æ³•é™¤äº†å¯ä»¥è®¾ç½®æ¥å…¥çš„å¤§æ¨¡å‹ï¼Œè¿˜å¯ä»¥é€šè¿‡systemPromptå­—æ®µå»è®¾ç½®Promptæç¤ºè¯ã€‚</p>
<p>é€šè¿‡LangChainä»£ç†çš„stream()æ–¹æ³•è°ƒç”¨DeepSeekæ¨¡å‹å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼šå°†å®¢æˆ·ç«¯å‘é€çš„req.body.messageä½œä¸ºç”¨æˆ·æ¶ˆæ¯è¾“å…¥ï¼Œå¹¶è®¾ç½®streamModeä¸º "messages" æ¥è·å–ç»“æ„åŒ–çš„æ¶ˆæ¯æµå“åº”ï¼›åœ¨ç­‰å¾…ä»£ç†å®Œæˆæµå¼ç”Ÿæˆåï¼Œå°†æ•´ä¸ªç»“æœé›†ä½œä¸ºJSONæ•°æ®ä¸€æ¬¡æ€§è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>
<span class="hljs-keyword">import</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">'cors'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/deepseek'</span>
<span class="hljs-keyword">import</span> { key } <span class="hljs-keyword">from</span> <span class="hljs-string">'./key.ts'</span>
<span class="hljs-keyword">import</span> { createAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'langchain'</span>
<span class="hljs-keyword">const</span> deepseek = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">apiKey</span>: key,
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">1.3</span>,
  <span class="hljs-attr">maxTokens</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// 500-600ä¸ªæ±‰å­—</span>
  <span class="hljs-attr">topP</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// è®¾å¾—è¶Šå°ï¼ŒAI è¯´è¯è¶Š"æ­»æ¿"ï¼›è®¾å¾—è¶Šå¤§ï¼ŒAI è¯´è¯è¶Š"æ”¾é£è‡ªæˆ‘"</span>
  <span class="hljs-attr">frequencyPenalty</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é˜²å¤è¯»æœºè¯‰ AIï¼š"ä½ åˆ«è€é‡å¤åŒä¸€ä¸ªè¯ï¼"-2   2</span>
  <span class="hljs-attr">presencePenalty</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é¼“åŠ±æ¢è¯é¢˜å‘Šè¯‰ AIï¼š"åˆ«è€èŠåŒä¸€ä»¶äº‹ï¼" -2   2</span>
})

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>())
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>())

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/chat'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'application/json'</span>)
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Cache-Control'</span>, <span class="hljs-string">'no-cache'</span>)
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Connection'</span>, <span class="hljs-string">'keep-alive'</span>)
  <span class="hljs-keyword">const</span> agent = <span class="hljs-title function_">createAgent</span>({
    <span class="hljs-attr">model</span>: deepseek,
    <span class="hljs-attr">systemPrompt</span>: <span class="hljs-string">`ä½ æ˜¯ä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œè¯·æ ¹æ®ç”¨æˆ·çš„é—®é¢˜ç»™å‡ºå›ç­”ã€‚`</span>,
  })
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">invoke</span>({
    <span class="hljs-attr">messages</span>: [
      {
        <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
        <span class="hljs-attr">content</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">message</span>,
      }
    ]
  })
  res.<span class="hljs-title function_">json</span>(result)
})

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Server is running on port 3000'</span>)
})
</code></pre>
<p>æ¥ä¸‹æ¥å›åˆ°index.htmlæ–‡ä»¶ä¸€ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®å®¢æˆ·ç«¯è¿”å›ç»™åç«¯çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯å¾€req.body.messageé‡Œå¡ä¸€ä¸‹å’¨è¯¢AIçš„é—®é¢˜ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">&lt;script&gt;
    <span class="hljs-title function_">fetch</span>(<span class="hljs-string">'http://localhost:3000/api/chat'</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
        <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span>
        },
        <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>({ <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·é—®ä½ æ˜¯ä»€ä¹ˆAIå¤§æ¨¡å‹'</span> })
    }).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> res=&gt;{
        <span class="hljs-keyword">const</span> reader = res.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>()
        <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextDecoder</span>()
        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
            <span class="hljs-keyword">const</span> { done, value } = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>()
            <span class="hljs-keyword">if</span> (done) {
                <span class="hljs-keyword">break</span>
            }
            <span class="hljs-keyword">const</span> text = decoder.<span class="hljs-title function_">decode</span>(value, { <span class="hljs-attr">stream</span>: <span class="hljs-literal">true</span> })
            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text)
        }
    })
&lt;/script&gt;
</code></pre>
<p>æˆ‘ä»¬é—®äº†ä¸€ä¸ªï¼šâ€œä½ æ˜¯ä»€ä¹ˆAIå¤§æ¨¡å‹â€çš„é—®é¢˜ï¼Œæµè§ˆå™¨è¿”å›AIå¯¹è¯ä¿¡æ¯å¦‚å›¾11-6æ‰€ç¤ºã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca0955ecf9f7418996b77394d468b9bb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWGlhb1l1MjAwMg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768638513&amp;x-signature=21sxFKXTPK1IbJPurp0xo8FOtVw%3D" alt="image-20251219054656481" loading="lazy"/></p>
<p align="center">
 <b> å›¾11-6 DeepSeekæ¨¡å‹-Temperatureå‚æ•°è®¾ç½®</b>
</p>
<p>åˆ°è¿™ä¸ºæ­¢ï¼Œæˆ‘ä»¬å°±æ­£å¼æ‰“é€šäº†AIå¯¹è¯çš„ç¯èŠ‚ã€‚å¹¶ä¸”å¦‚æœæˆ‘ä»¬æ‰“å¼€ç½‘ç»œé€‰é¡¹å¡ï¼Œå¯ä»¥å‘ç°AIå¯¹è¯è¿”å›çš„å†…å®¹æ˜¯postè¯·æ±‚çš„ã€‚å¦‚æœæˆ‘ä»¬æƒ³æ”¹æˆæµå¼è¾“å‡ºä¹Ÿæ˜¯postè¯·æ±‚ï¼Œåœ¨ç¬¬10.3å°èŠ‚æ‰€å­¦ä¹ çš„SSEè®¾ç½®postè¯·æ±‚å°±å¯ä»¥ç”¨ä¸Šäº†ã€‚</p>
<h2 data-id="heading-2">11.4 æµå¼è¾“å‡ºAIå¯¹è¯</h2>
<p>å¦‚æœæˆ‘ä»¬æƒ³ä¿®æ”¹æˆæµå¼è¾“å‡ºå¯¹è¯çš„è¯ï¼Œéœ€è¦ä¿®æ”¹3ä¸ªåœ°æ–¹ï¼š</p>
<p>ï¼ˆ1ï¼‰åç«¯è®¾ç½®çš„Content-Typeç±»å‹æ”¹æˆäº‹ä»¶æµç±»å‹ã€‚</p>
<p>ï¼ˆ2ï¼‰agentä¸ä½¿ç”¨invoke()æ–¹æ³•ï¼Œè¯¥æ¢ä¸“é—¨çš„agent.stream()æµè¾“å‡ºæ–¹æ³•ï¼Œå¹¶è°ƒæ•´å¯¹åº”å‚æ•°ã€‚</p>
<p>ï¼ˆ3ï¼‰agent.stream()æµè¾“å‡ºæ–¹æ³•è¿”å›è¿­ä»£å™¨ï¼Œé’ˆå¯¹è¿­ä»£å™¨å»è°ƒæ•´è¾“å‡ºå½¢å¼ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>
<span class="hljs-keyword">import</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">'cors'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/deepseek'</span>
<span class="hljs-keyword">import</span> { key } <span class="hljs-keyword">from</span> <span class="hljs-string">'./key.ts'</span>
<span class="hljs-keyword">import</span> { createAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'langchain'</span>
<span class="hljs-keyword">const</span> deepseek = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">apiKey</span>: key,
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">1.3</span>,
  <span class="hljs-attr">maxTokens</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// 500-600ä¸ªæ±‰å­—</span>
  <span class="hljs-attr">topP</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// è®¾å¾—è¶Šå°ï¼ŒAI è¯´è¯è¶Š"æ­»æ¿"ï¼›è®¾å¾—è¶Šå¤§ï¼ŒAI è¯´è¯è¶Š"æ”¾é£è‡ªæˆ‘"</span>
  <span class="hljs-attr">frequencyPenalty</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é˜²å¤è¯»æœºè¯‰ AIï¼š"ä½ åˆ«è€é‡å¤åŒä¸€ä¸ªè¯ï¼"-2   2</span>
  <span class="hljs-attr">presencePenalty</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é¼“åŠ±æ¢è¯é¢˜å‘Šè¯‰ AIï¼š"åˆ«è€èŠåŒä¸€ä»¶äº‹ï¼" -2   2</span>
})

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>())
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>())

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/chat'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'application/event-stream'</span>)
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Cache-Control'</span>, <span class="hljs-string">'no-cache'</span>)
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Connection'</span>, <span class="hljs-string">'keep-alive'</span>)
  <span class="hljs-keyword">const</span> agent = <span class="hljs-title function_">createAgent</span>({
    <span class="hljs-attr">model</span>: deepseek,
    <span class="hljs-attr">systemPrompt</span>: <span class="hljs-string">`ä½ æ˜¯ä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œè¯·æ ¹æ®ç”¨æˆ·çš„é—®é¢˜ç»™å‡ºå›ç­”ã€‚`</span>,
  })
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">stream</span>({
    <span class="hljs-attr">messages</span>: [
      {
        <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
        <span class="hljs-attr">content</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">message</span>,
      }
    ]
  }, { <span class="hljs-attr">streamMode</span>: <span class="hljs-string">"messages"</span> })
  <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> chunk <span class="hljs-keyword">of</span> result) {
    res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`data: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(chunk)}</span>\n\n`</span>)
  }
  res.<span class="hljs-title function_">end</span>()
})

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Server is running on port 3000'</span>)
})
</code></pre>
<p>agent.stream()æ–¹æ³•æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šæµå¼è¾“å‡ºçš„æ•°æ®æ ¼å¼å’Œç²’åº¦ï¼Œå†³å®šäº†ä»æµä¸­æ¥æ”¶åˆ°çš„æ˜¯åŸå§‹ä»¤ç‰Œã€ç»“æ„åŒ–æ¶ˆæ¯è¿˜æ˜¯å…¶ä»–ä¸­é—´ç»“æœã€‚agent.stream()æ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°çš„é€‰é¡¹å¦‚è¡¨11-1æ‰€ç¤ºã€‚æˆ‘ä»¬é€‰æ‹©messageså°±å¯ä»¥äº†ã€‚å¦‚æœæƒ³è¦çœŸæ­£å­˜ç²¹çš„æ‰“å­—æ•ˆæœå¹¶ä¸”èŠ‚çº¦tokenï¼Œå¯ä»¥ä½¿ç”¨valuesé€‰é¡¹ã€‚</p>
<p align="center">
 <b> è¡¨11-1 agent.stream()æ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°çš„é€‰é¡¹</b>
</p>





























<table><thead><tr><th align="left">æµæ¨¡å¼</th><th align="left">è¿”å›çš„æ•°æ®ç±»å‹</th><th align="left">å…¸å‹ç”¨é€”</th><th align="left">ç¤ºä¾‹è¾“å‡ºï¼ˆé€å—ï¼‰</th></tr></thead><tbody><tr><td align="left">"messages"</td><td align="left">å®Œæ•´çš„æ¶ˆæ¯å¯¹è±¡</td><td align="left">éœ€è¦å¤„ç†ç»“æ„åŒ–å¯¹è¯ï¼ˆå¦‚è·å–AIå›å¤çš„å®Œæ•´æ¶ˆæ¯ï¼‰</td><td align="left">{"role": "assistant", "content": "ä½ å¥½"}</td></tr><tr><td align="left">"values"</td><td align="left">åº•å±‚å€¼ï¼ˆå¦‚åŸå§‹tokenï¼‰</td><td align="left">éœ€è¦å®ç°é€å­—æ‰“å°æ•ˆæœæˆ–æœ€ä½çº§æ§åˆ¶</td><td align="left">"ä½ " "å¥½"</td></tr><tr><td align="left">"stream"</td><td align="left">æ··åˆäº‹ä»¶æµ</td><td align="left">éœ€è¦åŒæ—¶è·å–tokenå’Œæ¶ˆæ¯ç­‰å¤šæ ·ä¿¡æ¯</td><td align="left">{"type": "token", "value": "ä½ "}</td></tr></tbody></table>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">stream</span>({
    <span class="hljs-attr">messages</span>: [
      {
        <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
        <span class="hljs-attr">content</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">message</span>,
      }
    ]
  }, { <span class="hljs-attr">streamMode</span>: <span class="hljs-string">"values"</span> })
</code></pre>
<p>å…¶æ¬¡ï¼Œç”±äºagent.stream()æ–¹æ³•çš„è¿”å›å€¼ç±»å‹æ˜¯<code>IterableReadableStream&lt;StreamMessageOutput&gt;</code>ï¼Œè¯´æ˜è¿”å›å€¼å°±æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ã€‚å› æ­¤å¯ä»¥ä½¿ç”¨for await ofè¯­æ³•ç³–æ¥æµå¼è¾“å‡ºå†…å®¹ï¼Œä¸ç”¨æ‰‹åŠ¨çš„å»è°ƒç”¨è¿­ä»£å™¨çš„next()æ–¹æ³•ã€‚</p>
<pre><code class="hljs language-ts" lang="ts">  <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> chunk <span class="hljs-keyword">of</span> result) {
    res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`data: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(chunk)}</span>\n\n`</span>)
  }
  res.<span class="hljs-title function_">end</span>()
</code></pre>
<p>AIå¯¹è¯-æµå¼è¾“å‡ºå¦‚å›¾11-7æ‰€ç¤ºã€‚ä¼šæŒ‰é¡ºåºè¿”å›éå¸¸å¤šçš„JSONæ ¼å¼æ•°æ®ï¼Œé€šè¿‡dataå­—æ®µä¸‹çš„kwargsçš„contentå¯ä»¥çœ‹åˆ°AIè¿”å›å†…å®¹ä»¥ä¸‰ä¸¤å­—çš„å½¢å¼ä¸æ–­è¾“å‡ºã€‚å¹¶ä¸”åœ¨å‰ç«¯çš„æ¥æ”¶æµå¼è¾“å‡ºï¼Œä¸ä¼šå› postè¯·æ±‚è€Œå‡ºç°é—®é¢˜ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/442cefcfac0e47ddb0813b0ab60cb020~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWGlhb1l1MjAwMg==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768638513&amp;x-signature=%2FjSGLU6k0c5VBn3oQ%2B9%2F1esXxMM%3D" alt="image-20251219060557208" loading="lazy"/></p>
<p align="center">
 <b> å›¾11-7 AIå¯¹è¯-æµå¼è¾“å‡º</b>
</p>
<p>æµå¼è¾“å‡ºAIå¯¹è¯çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// index.ts</span>
<span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>
<span class="hljs-keyword">import</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">'cors'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChatDeepSeek</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@langchain/deepseek'</span>
<span class="hljs-keyword">import</span> { key } <span class="hljs-keyword">from</span> <span class="hljs-string">'./key.ts'</span>
<span class="hljs-keyword">import</span> { createAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'langchain'</span>
<span class="hljs-keyword">const</span> deepseek = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChatDeepSeek</span>({
  <span class="hljs-attr">apiKey</span>: key,
  <span class="hljs-attr">model</span>: <span class="hljs-string">'deepseek-chat'</span>,
  <span class="hljs-attr">temperature</span>: <span class="hljs-number">1.3</span>,
  <span class="hljs-attr">maxTokens</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// 500-600ä¸ªæ±‰å­—</span>
  <span class="hljs-attr">topP</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// è®¾å¾—è¶Šå°ï¼ŒAI è¯´è¯è¶Š"æ­»æ¿"ï¼›è®¾å¾—è¶Šå¤§ï¼ŒAI è¯´è¯è¶Š"æ”¾é£è‡ªæˆ‘"</span>
  <span class="hljs-attr">frequencyPenalty</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é˜²å¤è¯»æœºè¯‰ AIï¼š"ä½ åˆ«è€é‡å¤åŒä¸€ä¸ªè¯ï¼"-2   2</span>
  <span class="hljs-attr">presencePenalty</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// é¼“åŠ±æ¢è¯é¢˜å‘Šè¯‰ AIï¼š"åˆ«è€èŠåŒä¸€ä»¶äº‹ï¼" -2   2</span>
})

<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()
app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>())
app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">json</span>())

app.<span class="hljs-title function_">post</span>(<span class="hljs-string">'/api/chat'</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Content-Type'</span>, <span class="hljs-string">'application/event-stream'</span>)
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Cache-Control'</span>, <span class="hljs-string">'no-cache'</span>)
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">'Connection'</span>, <span class="hljs-string">'keep-alive'</span>)
  <span class="hljs-keyword">const</span> agent = <span class="hljs-title function_">createAgent</span>({
    <span class="hljs-attr">model</span>: deepseek,
    <span class="hljs-attr">systemPrompt</span>: <span class="hljs-string">`ä½ æ˜¯ä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œè¯·æ ¹æ®ç”¨æˆ·çš„é—®é¢˜ç»™å‡ºå›ç­”ã€‚`</span>,
  })
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> agent.<span class="hljs-title function_">stream</span>({
    <span class="hljs-attr">messages</span>: [
      {
        <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span>,
        <span class="hljs-attr">content</span>: req.<span class="hljs-property">body</span>.<span class="hljs-property">message</span>,
      }
    ]
  }, { <span class="hljs-attr">streamMode</span>: <span class="hljs-string">"messages"</span> })
  <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> chunk <span class="hljs-keyword">of</span> result) {
    res.<span class="hljs-title function_">write</span>(<span class="hljs-string">`data: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(chunk)}</span>\n\n`</span>)
  }
  res.<span class="hljs-title function_">end</span>()
})

app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Server is running on port 3000'</span>)
})
</code></pre>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// index.html</span>
&lt;!<span class="hljs-variable constant_">DOCTYPE</span> html&gt;
&lt;html lang="en"&gt;

&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
  &lt;title&gt;Document&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
  &lt;script&gt;
    fetch('http://localhost:3000/api/chat', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ message: 'è¯·é—®ä½ æ˜¯ä»€ä¹ˆAIå¤§æ¨¡å‹' })
    }).then(async res =&gt; {
      const reader = res.body.getReader()
      const decoder = new TextDecoder()
      while (true) {
        const { done, value } = await reader.read()
        if (done) {
          break
        }
        const text = decoder.decode(value, { stream: true })
        console.log(text)
      }
    })
  &lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<p>ä»¥ä¸Šå°±æ˜¯ä½¿ç”¨LangChainæ¥å…¥DeepSeekå¤§æ¨¡å‹å¹¶å®ç°AIå¯¹è¯å’ŒåŸºç¡€æç¤ºè¯çš„æ¡ˆä¾‹ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ¨èå‡ ä¸ªå›½å¤–æ¯”è¾ƒæµè¡Œçš„UIåº“ï¼ˆä¸Šï¼‰]]></title>    <link>https://juejin.cn/post/7593198957984301097</link>    <guid>https://juejin.cn/post/7593198957984301097</guid>    <pubDate>2026-01-10T06:45:42.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593198957984301097" data-draft-id="7593198957984038953" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ¨èå‡ ä¸ªå›½å¤–æ¯”è¾ƒæµè¡Œçš„UIåº“ï¼ˆä¸Šï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,JavaScript,CSS"/> <meta itemprop="datePublished" content="2026-01-10T06:45:42.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æˆ‘çš„å†™æ³•æœ‰ç‚¹æ½®"/> <meta itemprop="url" content="https://juejin.cn/user/1643143620204234"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ¨èå‡ ä¸ªå›½å¤–æ¯”è¾ƒæµè¡Œçš„UIåº“ï¼ˆä¸Šï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1643143620204234/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æˆ‘çš„å†™æ³•æœ‰ç‚¹æ½®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T06:45:42.000Z" title="Sat Jan 10 2026 06:45:42 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    11
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»4åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1ã€Tailwind CSS</h2>
<p>ç°åœ¨å†™æ ·å¼çš„æ—¶å€™ï¼Œæˆ‘åŸºæœ¬å·²ç»ç¦»ä¸å¼€ Tailwind CSS äº†ã€‚æœ€å¼€å§‹æ¥è§¦å®ƒçš„æ—¶å€™ï¼Œå…¶å®æŒºä¸é€‚åº”çš„ï¼Œæ„Ÿè§‰ç±»ååˆå¤šåˆæ‚ï¼Œå…¨å†™åœ¨æ ‡ç­¾ä¸Šã€‚ä½†çœŸæ­£ç”¨é¡ºäº†ä¹‹åï¼Œåè€Œä¸å¤ªæƒ³å›åˆ°ä»¥å‰é‚£ç§æ¥å›åˆ‡ CSS æ–‡ä»¶çš„æ–¹å¼ã€‚</p>
<p>æˆ‘æ¯”è¾ƒå–œæ¬¢çš„æ˜¯å®ƒå¤„ç†å“åº”å¼çš„æ–¹å¼ï¼Œæ–­ç‚¹ç›´æ¥å†™åœ¨ç±»åå‰é¢ï¼Œé€»è¾‘éå¸¸ç›´è§‚ã€‚é¡µé¢åœ¨ä¸åŒå°ºå¯¸ä¸‹æ€ä¹ˆå˜ï¼Œä¸€çœ¼å°±èƒ½çœ‹å‡ºæ¥ã€‚å†åŠ ä¸Šé…ç½®æ–‡ä»¶å¯ä»¥ç»Ÿä¸€ç®¡é¢œè‰²ã€é—´è·ã€å­—ä½“è¿™äº›ä¸œè¥¿ï¼Œå¯¹æˆ‘æ¥è¯´ç»´æŠ¤èµ·æ¥åè€Œæ›´è½»æ¾ã€‚</p>
<p>ç¼ºç‚¹å½“ç„¶ä¹Ÿæœ‰ï¼Œæ¯”å¦‚ç»“æ„çœ‹èµ·æ¥ä¸é‚£ä¹ˆâ€œå¹²å‡€â€ï¼Œä½†è¿™ä¸ªåœ¨æˆ‘è¿™é‡Œå·²ç»ä¸ç®—ä»€ä¹ˆé—®é¢˜äº†ã€‚</p>
<p><strong>ä¸‹é¢æˆ‘ä»¬æ¥å®ç°ä¸€ä¸ªç€‘å¸ƒæµ</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"columns-3 ..."</span>&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"aspect-3/2 ..."</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img/mountains-1.jpg"</span> /&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"aspect-square ..."</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img/mountains-2.jpg"</span> /&gt;</span> 
    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"aspect-square ..."</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/img/mountains-3.jpg"</span> /&gt;</span> 
    <span class="hljs-comment">&lt;!-- ... --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</code></pre>
<p><strong>æ•ˆæœ</strong>
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/89fafbbaf8c14ba684aad39db134b1a6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qE5YaZ5rOV5pyJ54K55r2u:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634370&amp;x-signature=WtiWy51sP0B4zRCH1sf%2FIBv%2B7zs%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-1">2ã€Bootstrap</h2>
<p>è™½ç„¶ Bootstrap å·²ç»å¾ˆå¤šå¹´äº†ï¼Œä½†è¯´å®è¯ï¼Œåœ¨ä¸€äº›éœ€æ±‚æ˜ç¡®ã€èŠ‚å¥æ¯”è¾ƒå¿«çš„é¡¹ç›®é‡Œï¼Œå®ƒä¾ç„¶å¾ˆå¥½ç”¨ã€‚æ …æ ¼ã€å¸¸è§ç»„ä»¶åŸºæœ¬éƒ½æœ‰ï¼Œç›´æ¥æ‹¼å°±èƒ½å‡ºé¡µé¢ï¼Œå‡ ä¹ä¸ç”¨æƒ³å¤ªå¤šã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/1b904d7f72ea4f6f8506bc351c91832c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qE5YaZ5rOV5pyJ54K55r2u:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634370&amp;x-signature=KKiVIweFIrVwz%2FgNB8zg2urAs4w%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-2">3ã€Foundation</h2>
<p>Foundation æ˜¯ä¸€ä¸ªå¼€æºçš„å“åº”å¼å‰ç«¯æ¡†æ¶ï¼Œç”¨äºæ„å»ºç»“æ„æ¸…æ™°ã€è§†è§‰ä¸€è‡´çš„ç½‘é¡µç•Œé¢ã€‚å®ƒæä¾›äº†å®Œæ•´çš„å·¥å…·ä½“ç³»ï¼ŒåŒ…æ‹¬å“åº”å¼ç½‘æ ¼ç³»ç»Ÿã€è®¾è®¡æ¨¡æ¿ï¼Œä»¥åŠåŸºäº HTMLã€CSS å’Œ SASS çš„æ ·å¼æ–¹æ¡ˆã€‚åŒæ—¶ï¼Œæ¡†æ¶å†…ç½®äº†æŒ‰é’®ã€å¯¼èˆªã€è¡¨å•ã€æ’ç‰ˆç­‰å¸¸è§ UI èƒ½åŠ›ï¼Œå¹¶æ”¯æŒé€šè¿‡ JavaScript æ‰©å±•è¿›ä¸€æ­¥å¢å¼ºäº¤äº’åŠŸèƒ½ã€‚</p>
<p>Foundation é‡‡ç”¨ç§»åŠ¨ä¼˜å…ˆçš„è®¾è®¡ç†å¿µï¼Œä¸ Bootstrap ç±»ä¼¼ï¼Œå¸ƒå±€ä»å°å±è®¾å¤‡å¼€å§‹æ„å»ºï¼Œå†é€æ­¥æ‰©å±•åˆ°æ›´å¤§çš„å±å¹•å°ºå¯¸ã€‚è¿™ç§æ–¹å¼ä½¿é¡µé¢èƒ½å¤Ÿè‡ªç„¶é€‚é…ä¸åŒè®¾å¤‡ï¼Œæ— éœ€é¢å¤–å¤„ç†å¤æ‚çš„é€‚é…é€»è¾‘ï¼Œä»è€Œåœ¨æ‰‹æœºã€å¹³æ¿å’Œæ¡Œé¢ç«¯ä¹‹é—´ä¿æŒä¸€è‡´ä¸”æµç•…çš„ä½“éªŒã€‚</p>
<p>åœ¨å¸ƒå±€å±‚é¢ï¼ŒFoundation æä¾›äº†åŸºäº Flexbox çš„ 12 åˆ—å“åº”å¼ç½‘æ ¼ç³»ç»Ÿã€‚é¡µé¢ç»“æ„å¯ä»¥é€šè¿‡è¡Œä¸åˆ—çš„ç»„åˆå¿«é€Ÿæ­å»ºï¼Œè€Œç½‘æ ¼ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†ä¸åŒæ–­ç‚¹ä¸‹çš„å°ºå¯¸å˜åŒ–ä¸å†…å®¹å †å ï¼Œä½¿æ•´ä½“å¸ƒå±€ä¿æŒç®€æ´ã€ç›´è§‚ä¸”æ˜“äºç»´æŠ¤ã€‚</p>
<p>Foundation çš„å·¥å…·åŒ…ä½“ç³»ä¹Ÿæ˜¯å…¶é‡è¦ç‰¹æ€§ä¹‹ä¸€ã€‚æ¡†æ¶å†…ç½®äº†å¯ç›´æ¥ä½¿ç”¨çš„ç½‘é¡µä¸é‚®ä»¶ç»„ä»¶ï¼Œä½¿é¡¹ç›®åœ¨å¯åŠ¨é˜¶æ®µä¸å¿…ä»é›¶æ­å»ºåŸºç¡€ç»“æ„ã€‚è¿™ç§æ–¹å¼åœ¨å¤šå¹³å°åœºæ™¯ä¸‹æœ‰åŠ©äºç»´æŒç»Ÿä¸€çš„è§†è§‰é£æ ¼ï¼Œå¹¶æ˜¾è‘—å‡å°‘é‡å¤æ€§å·¥ä½œã€‚</p>
<p>åœ¨çµæ´»æ€§æ–¹é¢ï¼ŒFoundation å¹¶æœªå¼ºåˆ¶ç»‘å®šç‰¹å®šçš„è®¾è®¡è¯­è¨€æˆ–æ ·å¼è§„èŒƒã€‚é»˜è®¤é…ç½®å¯æ ¹æ®é¡¹ç›®éœ€æ±‚è¿›è¡Œè°ƒæ•´æˆ–è¦†ç›–ï¼Œä»è€Œåœ¨ä¸å—æ¡†æ¶é™åˆ¶çš„å‰æä¸‹å®ç°å®šåˆ¶åŒ–ç•Œé¢è®¾è®¡ã€‚è¿™ç§è®¾è®¡æ€è·¯åœ¨æ•ˆç‡ä¸è‡ªç”±åº¦ä¹‹é—´å–å¾—äº†è¾ƒå¥½çš„å¹³è¡¡ã€‚</p>
<p>ä»æ•´ä½“ç‰¹æ€§æ¥çœ‹ï¼ŒFoundation å¯¹æ— éšœç¢è®¿é—®å’Œç§»åŠ¨ä¼˜å…ˆè®¾è®¡çš„é‡è§†ï¼Œä½¿å…¶åœ¨æ„å»ºç°ä»£åŒ–ã€åŒ…å®¹æ€§ç½‘é¡µä½“éªŒæ—¶å…·æœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚æ¨¡å—åŒ–æ¶æ„ä¸ SASS é›†æˆæå‡äº†ç»„ä»¶å®šåˆ¶çš„æ•ˆç‡ï¼Œä¹Ÿä½¿å¤æ‚å¸ƒå±€çš„åŸå‹æ„å»ºæ›´åŠ é¡ºç•…ã€‚</p>
<p>ç›¸å¯¹è€Œè¨€ï¼ŒFoundation çš„å­¦ä¹ æˆæœ¬é«˜äº Bootstrap ç­‰æ›´å¤§ä¼—åŒ–çš„æ–¹æ¡ˆï¼Œå¯¹åˆå­¦è€…å­˜åœ¨ä¸€å®šé—¨æ§›ã€‚æ­¤å¤–ï¼Œå…¶ç¤¾åŒºè§„æ¨¡å’Œç”Ÿæ€èµ„æºä¸åŠ Tailwind å’Œ Bootstrap ä¸°å¯Œï¼Œå¯ç›´æ¥å¤ç”¨çš„ç¬¬ä¸‰æ–¹èµ„æºç›¸å¯¹æœ‰é™ã€‚åœ¨åŠŸèƒ½å®Œæ•´åº¦è¾ƒé«˜çš„åŒæ—¶ï¼Œå¯¹äºä½“é‡è¾ƒå°çš„é¡¹ç›®è€Œè¨€ï¼Œå¯èƒ½ä¼šå¼•å…¥ä¸å¿…è¦çš„å¤æ‚åº¦ã€‚</p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span>  <span class="hljs-strong">**å“åº”å¼**</span>ï¼šå…ˆåšå¥½æ‰‹æœºï¼Œå†é€‚é…å¹³æ¿å’Œç”µè„‘ã€‚
<span class="hljs-bullet">2.</span>  <span class="hljs-strong">**ç½‘æ ¼çµæ´»**</span>ï¼š12 åˆ— Flexbox å¸ƒå±€ï¼Œå¸ƒå±€å¤æ‚ä¹Ÿèƒ½å¤„ç†å¥½ã€‚
<span class="hljs-bullet">3.</span>  <span class="hljs-strong">**ç»„ä»¶é½å…¨**</span>ï¼šå¸¦ JS æ’ä»¶ï¼Œäº¤äº’ä¹Ÿæœ‰ç°æˆçš„ï¼ˆå¼¹çª—ã€èœå•ç­‰ï¼‰ã€‚
</code></pre>
<p><strong>é€‚åˆè°</strong>ï¼šæƒ³å¿«é€Ÿæ­å¤æ‚é¡µé¢ï¼Œæœ‰äº¤äº’ï¼Œåˆæƒ³ç”¨æ¡†æ¶è‡ªå¸¦ç»„ä»¶çš„äººã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šå­¦ä¹ ç¨å¤æ‚ï¼ŒåŠŸèƒ½å¤šäº†ï¼Œå°é¡¹ç›®å¯èƒ½æ˜¾å¾—é‡ã€‚</p>
<p><strong>ä¸‹é¢æˆ‘ä»¬æ¥ä½¿ç”¨å®ƒçš„æŒ‰é’®æ ·å¼</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- Anchors (links) --&gt;</span> 
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"about.html"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"button"</span>&gt;</span>Learn More<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> 
<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#features"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"button"</span>&gt;</span>View All Features<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span> 

<span class="hljs-comment">&lt;!-- Buttons (actions) --&gt;</span> 
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"submit success button"</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span> 
<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"alert button"</span>&gt;</span>Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
</code></pre>
<p><strong>æ•ˆæœ</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/be2c22903f1e42b8842f5f2e49bfc1fa~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qE5YaZ5rOV5pyJ54K55r2u:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634370&amp;x-signature=T93mUi1gwOLHVYsKFj4ZBSUGjUA%3D" alt="image.png" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-3">4ã€Bulma</h2>
<p>Bulma æ˜¯é‚£ç§ä¸€çœ‹å°±æ‡‚ã€ä¸Šæ‰‹å¾ˆå¿«çš„æ¡†æ¶ã€‚ç±»åè¯­ä¹‰æ¸…æ¥šï¼Œå¸ƒå±€åŸºäº Flexboxï¼Œç”¨èµ·æ¥å¾ˆé¡ºã€‚</p>
<p>å®ƒä¸ä¾èµ– JavaScript è¿™ä¸€ç‚¹ï¼Œæ‹¿æ¥é…åˆä»»ä½•æŠ€æœ¯æ ˆéƒ½å¾ˆæ–¹ä¾¿ã€‚ä¸è¿‡ä¹Ÿæ­£å› ä¸ºè¿™æ ·ï¼Œä¸€äº›äº¤äº’ç›¸å…³çš„ä¸œè¥¿éœ€è¦è‡ªå·±è¡¥ï¼Œè¿™ç‚¹åœ¨ç”¨ä¹‹å‰å¿ƒé‡Œè¦æœ‰é¢„æœŸã€‚</p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š</p>
<pre><code class="hljs language-markdown" lang="markdown"><span class="hljs-bullet">1.</span>  <span class="hljs-strong">**å“åº”å¼**</span>ï¼šç§»åŠ¨ä¼˜å…ˆï¼ŒFlexbox ç½‘æ ¼å¸ƒå±€ã€‚
<span class="hljs-bullet">2.</span>  <span class="hljs-strong">**è½»é‡**</span>ï¼šæŒ‰é’®ã€å¡ç‰‡ã€è¡¨å•éƒ½æœ‰æ ·å¼ï¼Œä½†æ²¡æœ‰ JSã€‚
<span class="hljs-bullet">3.</span>  <span class="hljs-strong">**æ˜“ç”¨**</span>ï¼šå­¦ä¹ æˆæœ¬ä½ï¼Œæ”¹æ ·å¼å¾ˆæ–¹ä¾¿ã€‚
</code></pre>
<p><strong>é€‚åˆè°</strong>ï¼šåªéœ€è¦å¿«é€Ÿæ­é¡µé¢ã€å¸ƒå±€å’Œæ ·å¼å›ºå®šã€ä¸éœ€è¦æ¡†æ¶è‡ªå¸¦äº¤äº’çš„äººã€‚</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šæ²¡æœ‰äº¤äº’ç»„ä»¶ï¼Œå¤æ‚è¡Œä¸ºè¦è‡ªå·±å†™ã€‚</p>
<p><strong>ä¸‹é¢æˆ‘ä»¬æ¥å†™ä¸€ä¸ªç®€å•çš„è¡¨å•</strong></p>
<pre><code class="hljs language-html" lang="html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"box"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"field"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"label"</span>&gt;</span>Email<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"control"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"e.g. alex@example.com"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"field"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"label"</span>&gt;</span>Password<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"control"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"input"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"********"</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

  <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"button is-primary"</span>&gt;</span>Sign in<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
</code></pre>
<p><strong>æ•ˆæœ</strong></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/6882c05f7b2a4cb2aae2eca977da9efe~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5oiR55qE5YaZ5rOV5pyJ54K55r2u:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634370&amp;x-signature=Mgu7j96l%2BxUE%2BEmANr46eeSUcQ8%3D" alt="image.png" loading="lazy"/></p>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ä¸€ç¯‡æ–‡ç« å¸¦ä½ ææ‡‚åŸå‹å’ŒåŸå‹é“¾]]></title>    <link>https://juejin.cn/post/7593212374922215451</link>    <guid>https://juejin.cn/post/7593212374922215451</guid>    <pubDate>2026-01-10T06:58:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593212374922215451" data-draft-id="7593212374922182683" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ä¸€ç¯‡æ–‡ç« å¸¦ä½ ææ‡‚åŸå‹å’ŒåŸå‹é“¾"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-10T06:58:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é™Ÿä¸Šé’äº‘"/> <meta itemprop="url" content="https://juejin.cn/user/3910338081725949"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ä¸€ç¯‡æ–‡ç« å¸¦ä½ ææ‡‚åŸå‹å’ŒåŸå‹é“¾
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3910338081725949/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é™Ÿä¸Šé’äº‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T06:58:57.000Z" title="Sat Jan 10 2026 06:58:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    13
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æˆ‘ä»¬åœ¨ç†è§£åŸå‹å’ŒåŸå‹é“¾çš„æ—¶å€™ï¼Œå–œæ¬¢å»çœ‹æ¦‚å¿µå¼ºè¡Œè®°ä½ï¼Œå½“æ—¶ä»¥ä¸ºè®°ä½äº†å°±æ‡‚äº†å¯ç­‰ä¸‹æ¬¡åˆä¼šå¿˜è®°ï¼Œå…¶å®æ˜¯è¿˜æ²¡æœ‰çœŸæ­£å¼„æ‡‚ã€‚æƒ³è¦å¼„æ‡‚ï¼Œå°±è¦å…ˆçŸ¥é“åˆ°åº•éš¾åœ¨å“ªï¼Œç†æ¸…å®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå†å»çœ‹æ¦‚å¿µæ€§çš„ä¸œè¥¿ï¼Œå°±è½»æ¾å¾ˆå¤šäº†ã€‚</p>
<h4 data-id="heading-0">ä¸€ã€åŸå‹å’ŒåŸå‹é“¾çš„æ ¸å¿ƒéš¾ç‚¹æ‹†è§£</h4>
<p>éš¾ç‚¹ 1ï¼š<code>__proto__</code>ã€<code>prototype</code>ã€<code>constructor</code> ä¸‰è€…çš„å…³ç³»ï¼ˆæœ€æ˜“æ··æ·†ï¼‰</p>
<p>è¿™ä¸‰ä¸ªå±æ€§æ˜¯åŸå‹ä½“ç³»çš„ â€œä¸‰è§’å…³ç³»â€ï¼Œæ–°æ‰‹å¾ˆå®¹æ˜“è®°æ··ã€ç”¨é”™ï¼Œå…ˆçœ‹æ ¸å¿ƒç»“è®º</p>
<ul>
<li>prototypeï¼š<strong>å‡½æ•°ç‹¬æœ‰</strong>ï¼ŒæŒ‡å‘â€œåŸå‹å¯¹è±¡â€ï¼ŒåŸå‹å¯¹è±¡é‡Œé»˜è®¤æœ‰constructorå±æ€§ã€‚</li>
<li><code>__proto__</code>ï¼š<strong>æ‰€æœ‰å¯¹è±¡ç‹¬æœ‰</strong>ï¼ŒæŒ‡å‘è‡ªå·±çš„â€œåŸå‹å¯¹è±¡â€ã€‚</li>
<li>constructorï¼š<strong>åŸå‹å¯¹è±¡ç‹¬æœ‰</strong>ï¼ŒæŒ‡å‘åˆ›å»ºè¯¥åŸå‹å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚</li>
</ul>
<p>æ ¸å¿ƒå…¬å¼ï¼ˆå¿…è®°ï¼‰</p>
<pre><code class="hljs language-js" lang="js">å®ä¾‹.<span class="hljs-property">__proto__</span> === æ„é€ å‡½æ•°.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>
æ„é€ å‡½æ•°.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === æ„é€ å‡½æ•°
å®ä¾‹.<span class="hljs-property">constructor</span> === æ„é€ å‡½æ•° ï¼ˆæœ¬è´¨æ˜¯é€šè¿‡åŸå‹é“¾æŸ¥æ‰¾ constructorï¼‰
</code></pre>
<pre><code class="hljs language-js" lang="js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
	<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name
}
<span class="hljs-keyword">const</span> res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'è€ç‹'</span>)
<span class="hljs-comment">// éªŒè¯1ï¼Œå®ä¾‹çš„éšå¼åŸå‹ï¼ˆ__proto__ï¼‰=== æ„é€ å‡½æ•°çš„æ˜¾å¼åŸå‹ï¼ˆprototypeï¼‰</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>,) <span class="hljs-comment">// true</span>
<span class="hljs-comment">// éªŒè¯2ï¼ŒåŸå‹å¯¹è±¡çš„constructoræŒ‡å‘æ„é€ å‡½æ•°</span>
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Person</span>) <span class="hljs-comment">// true</span>
<span class="hljs-comment">// éªŒè¯3ï¼Œå®ä¾‹çš„æœ¬èº«æ²¡æœ‰constructor æ˜¯é€šè¿‡åŸå‹é“¾æ‰¾åˆ°åŸå‹å¯¹è±¡çš„constructor</span>
 <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Person</span>) <span class="hljs-comment">//true</span>
</code></pre>
<p>åŸå‹å¯¹è±¡æœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡ï¼Œå› æ­¤å®ƒçš„ <code>__proto__</code> ä¼šæŒ‡å‘<strong>æ›´é«˜å±‚çš„åŸå‹å¯¹è±¡</strong>ï¼Œæœ€ç»ˆå½¢æˆåŸå‹é“¾</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// Person.prototype æ˜¯å¯¹è±¡ï¼Œå…¶ __proto__ æŒ‡å‘ Object.prototype</span>
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>; <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Object.prototype æ˜¯åŸå‹é“¾çš„é¡¶ç«¯ï¼Œå…¶ __proto__ ä¸º null</span>
<span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">__proto__</span> === <span class="hljs-literal">null</span>; <span class="hljs-comment">// true</span>
</code></pre>
<p>æ³¨æ„ç‚¹ï¼šä¿®æ”¹ <code>prototype</code> ä¼šå½±å“ <code>constructor</code></p>
<p>è‹¥ç›´æ¥è¦†ç›–æ„é€ å‡½æ•°çš„ <code>prototype</code>ï¼ˆè€Œéæ·»åŠ å±æ€§ï¼‰ï¼Œä¼šä¸¢å¤±åŸæœ‰çš„ <code>constructor</code>ï¼ˆé»˜è®¤æŒ‡å‘ <code>Object</code>ï¼‰ï¼Œéœ€æ‰‹åŠ¨æ¢å¤</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// é”™è¯¯ç¤ºä¾‹ï¼šç›´æ¥è¦†ç›–prototypeï¼Œconstructorä¼šæŒ‡å‘Object</span>
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-attr">sayHi</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Hi'</span>); }
};
p.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Object</span>; <span class="hljs-comment">// trueï¼ˆä¸ç¬¦åˆé¢„æœŸï¼‰</span>

<span class="hljs-comment">// æ­£ç¡®åšæ³•ï¼šè¦†ç›–åæ‰‹åŠ¨è®¾ç½®constructor</span>
<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = {
  <span class="hljs-attr">constructor</span>: <span class="hljs-title class_">Person</span>, <span class="hljs-comment">// æ‰‹åŠ¨æŒ‡å‘åŸæ„é€ å‡½æ•°</span>
  <span class="hljs-attr">sayHi</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Hi'</span>); }
};
p.<span class="hljs-property">constructor</span> === <span class="hljs-title class_">Person</span>; <span class="hljs-comment">// trueï¼ˆæ¢å¤é¢„æœŸï¼‰</span>
</code></pre>
<p>æ€»ç»“ä¸‰è€…çš„æ ¸å¿ƒå…³ç³»</p>
<pre><code class="hljs language-javascript" lang="javascript">æ„é€ å‡½æ•°ï¼ˆå¦‚<span class="hljs-title class_">Person</span>ï¼‰
  â†“ æ‹¥æœ‰
  prototype â†’ åŸå‹å¯¹è±¡ï¼ˆå¦‚<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼‰
                â†“ æ‹¥æœ‰
                constructor â†’ æ„é€ å‡½æ•°ï¼ˆ<span class="hljs-title class_">Person</span>ï¼‰
å®ä¾‹ï¼ˆå¦‚pï¼‰
  â†“ æ‹¥æœ‰
  __proto__ â†’ åŸå‹å¯¹è±¡ï¼ˆ<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>ï¼‰
</code></pre>
<p>äºŒï¼ŒåŸå‹å’ŒåŸå‹é“¾çš„æ ¸å¿ƒç†è§£</p>
<p>ç®€å•æ¥è¯´æ¯ä¸ªå‡½æ•°åˆ›å»ºéƒ½ä¼šé»˜è®¤æ·»åŠ ä¸€ä¸ªprototypeçš„å±æ€§ï¼Œåˆ›å»ºæ¯ä¸ªå¯¹è±¡ä¹Ÿä¼šæœ‰ä¸€ä¸ª__proto__çš„å±æ€§ï¼Œä¸Šé¢ä¹ŸéªŒè¯è¿‡ å®ä¾‹çš„__proto__(éšå¼åŸå‹)æ˜¯æŒ‡å‘æ„é€ å‡½æ•°çš„prototype(æ˜¾ç¤ºåŸå‹çš„)ä¸¤è€…æ˜¯ç›¸ç­‰çš„ã€‚</p>
<p>æ„é€ å‡½æ•°.prototypeä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿä¼šæœ‰ä¸€ä¸ª__proto__ï¼ŒæŒ‡å‘çš„æ˜¯<strong>Object.prototype</strong>,å› æ­¤<strong>Object.prototype</strong>ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥ä¹Ÿä¼šæœ‰__proto__ï¼ŒObject.prototype.<strong>proto</strong> æŒ‡å‘çš„å´æ˜¯nullï¼Œå› ä¸ºè¿™æ˜¯åŸå‹é“¾çš„æœ€é¡¶å±‚äº†ï¼Œé¡¶å±‚å°±æ˜¯null</p>
<p><strong>åŸå‹é“¾</strong>ï¼šå®ä¾‹ä¼šå…ˆä»è‡ªèº«ä¸Šæ‰¾ï¼Œæ²¡æ‰¾åˆ°ä¼šé€šè¿‡obj.<strong>proto</strong> ä»åŸå‹å¯¹è±¡ä¸Šå»æ‰¾ï¼ˆæ„é€ å‡½æ•°.prototypeï¼‰,æ²¡æ‰¾åˆ°ä¼šé€šè¿‡obj.<strong>proto</strong>.<strong>proto</strong> ä»åŸå‹å¯¹è±¡ä¸Šçš„åŸå‹ä¸Šå»æ‰¾ï¼ˆæ„é€ å‡½æ•°.prototype.<strong>proto</strong>ï¼‰,ç›´åˆ°æœ€é¡¶å±‚Object.prototypeå»æ‰¾æ²¡æ‰¾åˆ°ï¼Œå°±å›å»Object.prototype.<strong>proto</strong> å€¼ä¸ºnull ç»“æŸ è¿”å› undefined</p>
<pre><code class="hljs language-js" lang="js"> <span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name</span>) {
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = <span class="hljs-number">20</span>
        }

        <span class="hljs-keyword">const</span> obj = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">'zhangsan'</span>)
        <span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">age2</span> = <span class="hljs-number">30</span>
        <span class="hljs-title class_">Object</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">age3</span> = <span class="hljs-number">40</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">age</span>) <span class="hljs-comment">//è®¿é—®çš„æ˜¯è‡ªèº«ä¸Šçš„å±æ€§</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">age2</span>) <span class="hljs-comment">//è®¿é—®çš„æ˜¯åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(obj.<span class="hljs-property">age3</span>) <span class="hljs-comment">//è®¿é—®çš„æ˜¯åŸå‹å¯¹è±¡çš„åŸå‹ä¸Šçš„å±æ€§</span>

        <span class="hljs-comment">/**
         * obj={
         *   console.log(obj.age) 30  å…ˆæ‰¾è‡ªèº«
         * __proto__ === æ„é€ å‡½æ•°.prototype {
         *     console.log(obj.age2) 30  å¦‚æœè‡ªèº«æ²¡æœ‰æ‰¾åˆ° å°±ä¼šå»æ‰¾åŸå‹å¯¹è±¡
         *   Person.prototype.__proto__ === Object.prototype ={
         *       console.log(obj.age3) 40  åŸå‹å¯¹è±¡ä¸Šæ²¡æœ‰  å°±ä¼šå»æ‰¾åŸå‹å¯¹è±¡ä¸Šçš„åŸå‹ä¸Šå»æ‰¾
         *     }
         *      Object.prototype.__proto__ {
         *        ç›´åˆ°æœ€é¡¶å±‚  Object.prototype å®ƒçš„__proto__ === null  æ‰€æœ‰åŸå‹é“¾çš„æœ€é¡¶å±‚å°±æ˜¯
         *      }  
         *   
         *   }
         * 
         * }
         * **/</span>
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[fiuckjs åŸºäºreactçš„flutteråŠ¨æ€åŒ–æ–¹æ¡ˆ]]></title>    <link>https://juejin.cn/post/7593234983755808778</link>    <guid>https://juejin.cn/post/7593234983755808778</guid>    <pubDate>2026-01-10T06:21:27.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593234983755808778" data-draft-id="7593242327933157386" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="fiuckjs åŸºäºreactçš„flutteråŠ¨æ€åŒ–æ–¹æ¡ˆ"/> <meta itemprop="keywords" content="Flutter"/> <meta itemprop="datePublished" content="2026-01-10T06:21:27.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="wey608"/> <meta itemprop="url" content="https://juejin.cn/user/2529294609550445"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            fiuckjs åŸºäºreactçš„flutteråŠ¨æ€åŒ–æ–¹æ¡ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2529294609550445/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    wey608
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T06:21:27.000Z" title="Sat Jan 10 2026 06:21:27 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">FuickJS</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fyanweimin7%2Ffuickjs" target="_blank" title="https://github.com/yanweimin7/fuickjs" ref="nofollow noopener noreferrer">github.com/yanweimin7/â€¦</a></p>
<p>FuickJS æ˜¯ä¸€ä¸ªåŸºäº <strong>QuickJS</strong> å¼•æ“å®ç°çš„ Flutter åŠ¨æ€åŒ–æ¸²æŸ“æ¡†æ¶ã€‚å®ƒå…è®¸å¼€å‘è€…ä½¿ç”¨ <strong>React</strong> è¯­æ³•ç¼–å†™ä¸šåŠ¡é€»è¾‘å’Œ UIï¼Œå¹¶é€šè¿‡ Flutter åŸç”Ÿç»„ä»¶è¿›è¡Œé«˜æ€§èƒ½æ¸²æŸ“ã€‚</p>
<p><strong>ç›®å‰ä½œä¸ºæŠ€æœ¯æ¢ç´¢ï¼Œç”¨äºè·‘é€šåŸç†ï¼Œåˆ†å±‚ã€å‘½åä»€ä¹ˆçš„æ¯”è¾ƒä¹±</strong> ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ä¸€èµ·äº¤æµã€‚</p>
<h3 data-id="heading-1">æ ¸å¿ƒç‰¹æ€§</h3>
<ul>
<li><strong>React å¼€å‘ä½“éªŒ</strong>: ä½¿ç”¨ç†Ÿæ‚‰çš„ React è¯­æ³•ã€Hooks å’Œç”Ÿå‘½å‘¨æœŸã€‚</li>
<li><strong>é«˜æ€§èƒ½æ¸²æŸ“</strong>: å¹¶éä½¿ç”¨ WebViewï¼Œè€Œæ˜¯å°† JS æè¿°çš„ UI æ ‘é€šè¿‡ FFI ä¼ é€’ç»™ Flutterï¼Œæ˜ å°„ä¸ºåŸç”Ÿ Widgetã€‚</li>
<li><strong>è½»é‡çº§æ¡¥æ¥</strong>: é‡‡ç”¨ Dart FFI ç›´æ¥ä¸ C å±‚ QuickJS äº¤äº’ï¼Œé¿å…äº† JSON åºåˆ—åŒ–çš„å¼€é”€ã€‚</li>
<li><strong>åŠ¨æ€æ›´æ–°</strong>: JS ä»£ç å¯åŠ¨æ€ä¸‹å‘ï¼Œå®ç°ä¸å‘ç‰ˆå³å¯æ›´æ–° App åŠŸèƒ½ã€‚</li>
<li>æ”¯æŒandroid ã€ios ã€macoså¤šå¹³å°</li>
<li>æ”¯æŒåŠ è½½quickjs å­—èŠ‚ç ï¼Œå®ç°é¡µé¢ç§’å¼€</li>
<li>æ”¯æŒåˆ†åŒ…åŠ è½½ï¼Œframeworkä»£ç  &amp; ä¸šåŠ¡ä»£ç ç‹¬ç«‹</li>
</ul>
<h3 data-id="heading-2">æ•ˆæœé¢„è§ˆ</h3>
<p align="center">
  <img src="https://github.com/yanweimin7/fuickjs/raw/master/imgs/Screenshot_20260107_225623.png" width="30%" loading="lazy"/>
  <img src="https://github.com/yanweimin7/fuickjs/raw/master/imgs/Simulator%20Screenshot%20-%20iPhone%2015%20Pro%20-%202026-01-07%20at%2022.58.08.png" width="30%" loading="lazy"/>
  <img src="https://github.com/yanweimin7/fuickjs/raw/master/imgs/screenshot-20260107-230007.png" width="30%" loading="lazy"/>
</p>
<h3 data-id="heading-3">é¡¹ç›®ç»“æ„</h3>
<pre><code class="hljs language-text" lang="text">fuickjs/
â”œâ”€â”€ app/                # Flutter ä¾§ä»£ç  (Native å®¹å™¨)
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ core/       # æ ¸å¿ƒé€»è¾‘ (æ¸²æŸ“å¼•æ“ã€æ§åˆ¶å™¨ã€Handler)
â”‚   â”‚   â”œâ”€â”€ quickjs_ffi.dart # åº•å±‚ FFI å°è£…
â”‚   â”‚   â””â”€â”€ main.dart   # å…¥å£æ–‡ä»¶
â”‚   â””â”€â”€ assets/js/      # JS äº§ç‰©å­˜æ”¾ç›®å½•
â”œâ”€â”€ js/                 # JS ä¾§ä»£ç  (React è¿è¡Œæ—¶)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ renderer.js # è‡ªå®šä¹‰ React æ¸²æŸ“å™¨
â”‚   â”‚   â”œâ”€â”€ hostConfig.js # åè°ƒå™¨é…ç½®
â”‚   â”‚   â””â”€â”€ pages/      # ä¸šåŠ¡é¡µé¢ä»£ç 
â”‚   â””â”€â”€ esbuild.js      # æ‰“åŒ…è„šæœ¬
â””â”€â”€ README.md           # æœ¬æ–‡ä»¶
</code></pre>
<h3 data-id="heading-4">è¿è¡Œæµç¨‹</h3>
<ol>
<li><strong>JS æ‰“åŒ…</strong>:
åœ¨ <code>js</code> ç›®å½•ä¸‹è¿è¡Œ <code>node esbuild.js</code>ã€‚è„šæœ¬ä¼šç¼–è¯‘ JS ä»£ç å¹¶å°† <code>bundle.js</code> è‡ªåŠ¨æ‹·è´åˆ° <code>app/assets/js/</code> ç›®å½•ã€‚</li>
<li><strong>Flutter è¿è¡Œ</strong>:
åœ¨ <code>app</code> ç›®å½•ä¸‹è¿è¡Œ <code>flutter run</code>ã€‚Flutter å®¹å™¨ä¼šå¯åŠ¨ QuickJS å¼•æ“ï¼ŒåŠ è½½ <code>bundle.js</code>ï¼Œå¹¶æ ¹æ® JS ä¾§ç”Ÿæˆçš„ DSL æ¸²æŸ“ UIã€‚</li>
</ol>
<h3 data-id="heading-5">å¿«é€Ÿå¼€å§‹</h3>
<h4 data-id="heading-6">1. å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># JS ä¾§</span>
<span class="hljs-built_in">cd</span> js
npm install

<span class="hljs-comment"># Flutter ä¾§</span>
<span class="hljs-built_in">cd</span> app
flutter pub get
</code></pre>
<h4 data-id="heading-7">2. ç¼–è¯‘ JS</h4>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> js
npm run build
</code></pre>
<h4 data-id="heading-8">3. è¿è¡Œé¡¹ç›®</h4>
<p>ä½¿ç”¨ IDE æ‰“å¼€ <code>app</code> ç›®å½•ï¼Œæˆ–åœ¨å‘½ä»¤è¡Œè¿è¡Œï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-built_in">cd</span> app
flutter run
</code></pre>
<h3 data-id="heading-9">æŠ€æœ¯æ¶æ„</h3>
<ul>
<li><strong>Engine</strong>: <a href="https://link.juejin.cn?target=https%3A%2F%2Fbellard.org%2Fquickjs%2F" target="_blank" title="https://bellard.org/quickjs/" ref="nofollow noopener noreferrer">QuickJS</a> (è½»é‡çº§ã€é«˜æ€§èƒ½ JS å¼•æ“)</li>
<li><strong>Bridge</strong>: Dart FFI (C-Style æ¥å£è°ƒç”¨)</li>
<li><strong>Framework</strong>: React (å‰ç«¯ UI æ¡†æ¶)</li>
<li><strong>Renderer</strong>: è‡ªå®šä¹‰ Reconciler (DSL è½¬æ¢å™¨)</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Linux è¿›ç¨‹ç®¡ç†]]></title>    <link>https://juejin.cn/post/7593232758127067142</link>    <guid>https://juejin.cn/post/7593232758127067142</guid>    <pubDate>2026-01-10T06:54:57.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593232758127067142" data-draft-id="7593198957984202793" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Linux è¿›ç¨‹ç®¡ç†"/> <meta itemprop="keywords" content="Linux"/> <meta itemprop="datePublished" content="2026-01-10T06:54:57.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç”¨æˆ·46724454499"/> <meta itemprop="url" content="https://juejin.cn/user/502914754559866"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Linux è¿›ç¨‹ç®¡ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/502914754559866/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç”¨æˆ·46724454499
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T06:54:57.000Z" title="Sat Jan 10 2026 06:54:57 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">PIDè¿›ç¨‹æ ‡è¯†ç¬¦</h2>
<p>æ¯ä¸€ä¸ªè¿›ç¨‹æœ‰å”¯ä¸€çš„è¿›ç¨‹æ ‡è¯†ç¬¦pidï¼ˆ<em>é€šå¸¸ç”±1å¼€å§‹çš„æ­£æ•´æ•°</em>ï¼‰ï¼Œpid=1é€šå¸¸ä¸ºç³»ç»Ÿè¿›ç¨‹ï¼Œå…¶ä»–è¿›ç¨‹ç›´æ¥æˆ–é—´æ¥ç”±å®ƒåˆ›å»º
å¦‚ä½¿ç”¨å‘½ä»¤lsæ—¶ï¼Œç³»ç»Ÿä¼šä¸ºlsç¨‹åºåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œå¹¶åˆ†é…å”¯ä¸€pidã€‚</p>
<h3 data-id="heading-1">æŸ¥çœ‹è¿›ç¨‹å·</h3>
<pre><code class="hljs language-js" lang="js">echo $$  
</code></pre>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d717cda054444c7bbfd555ee8564110b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=P%2B3JuFjXCOv57l4hYzBsOKbA8Dk%3D" alt="image.png" loading="lazy"/></p>
<p>è¿™é‡Œåˆ‡æ¢åˆ°test1ç”¨æˆ·ï¼Œpidä¸åŒ</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/01019a2877274cb284f0c4ff80f2601f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=%2FHq8aSmvB5Gx8E6Hh9WFSC2NeEE%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-2">æŸ¥çœ‹ç”µè„‘ä¸­æœ‰å¤šå°‘ä¸ªè¿›ç¨‹</h3>
<p>ps -aux</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/990f431691d54cc99645a97c8bc5b374~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=%2BJ5cbXq233%2FW2%2BF6mFAlvKAd%2FZ8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-3">topå®æ—¶æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯</h3>
<p>qé€€å‡º</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0474093500874458bff989361fe6cb7d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=zRJLhP%2Bmr4IMyVwmBIF3duz6Zt4%3D" alt="image.png" loading="lazy"/></p>
<p>å¤§å†™PæŒ‰cpuçš„å¤§å°è¿›è¡Œæ’åº</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/52ae549a8d314c22b2c7d37e107cd1e6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=nuU0w%2FWgHTK7sUffIbmrVOp4EMA%3D" alt="image.png" loading="lazy"/></p>
<p>å¤§å†™Mï¼ŒæŒ‰å†…å­˜å¤§å°æ’åº</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/676b0947febd44c5a1fdef685c459a91~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=vkrPaU47wEXQ3heqQn59kpY0aoc%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-4">æŸ¥æ‰¾è¿›ç¨‹å·</h3>
<p>pgrep [name]</p>
<p>æŸ¥æ‰¾æ‰€æœ‰è¿›ç¨‹åä¸º[name]çš„è¿›ç¨‹å·</p>
<p>pgrep sshd</p>
<p>è¿™é‡ŒæŸ¥æ‰¾ sshdçš„è¿›ç¨‹å·</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/44fd01dc77f140b2af240758b9b51acd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=3IheWcHbj%2BWU%2B%2B7DDNF0C%2Fn8sm8%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-5">æŸ¥çœ‹è¿›ç¨‹æ ‘</h3>
<p>pstree -p è¿›ç¨‹å·</p>
<p>å¦‚ï¼š
pstree -p 2202</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ea77de1b2e664e3e904456264aac0c22~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=R5uZ8%2FUPKwlKOq%2BdiC%2Bq94T1YJE%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-6">è¿›ç¨‹æ§åˆ¶</h2>
<h3 data-id="heading-7">killå‘½ä»¤</h3>
<p>kill -2 è¿›ç¨‹å·     ï¼ˆç»ˆæ­¢è¯¥è¿›ç¨‹éå¼ºåˆ¶ï¼‰</p>
<p>kill -9 è¿›ç¨‹å·     ï¼ˆå¼ºåˆ¶ç»ˆæ­¢ï¼‰</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4af80faa4c234ac79de3546ba01cf230~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=S3%2BsQmKAkUxYzlovpIKRUK07tzQ%3D" alt="image.png" loading="lazy"/></p>
<h3 data-id="heading-8">nohupå‘½ä»¤</h3>
<p>nohup bash æ–‡ä»¶å &amp;</p>
<p>è¿™é‡Œæ˜¯test.sh</p>
<p>è‡ªåŠ¨æ‰§è¡Œè„šæœ¬æ–‡ä»¶test.shï¼Œå› ä¸ºè¿™é‡Œçš„test.shé‡Œæ˜¯ç©ºçš„ï¼Œæ‰€ä»¥è¢«doneäº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/24c68183306f4163893674f7c7b0365f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg55So5oi3NDY3MjQ0NTQ0OTk=:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632897&amp;x-signature=uW2xdRADvScY6xqew8DrDJW%2FZIw%3D" alt="image.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Macå®‰è£…Homebrew]]></title>    <link>https://juejin.cn/post/7593338828196610088</link>    <guid>https://juejin.cn/post/7593338828196610088</guid>    <pubDate>2026-01-10T06:58:15.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593338828196610088" data-draft-id="7593338828196577320" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Macå®‰è£…Homebrew"/> <meta itemprop="keywords" content="macOS"/> <meta itemprop="datePublished" content="2026-01-10T06:58:15.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="YongPagani"/> <meta itemprop="url" content="https://juejin.cn/user/254742431009390"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Macå®‰è£…Homebrew
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/254742431009390/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    YongPagani
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T06:58:15.000Z" title="Sat Jan 10 2026 06:58:15 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>åœ¨macå®‰è£…gitè½¯ä»¶çš„é€”ä¸­ï¼Œå‘ç°å…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯å…ˆå®‰è£…Homebrewï¼Œç„¶åé€šè¿‡Homebrewå®‰è£…gitã€‚
ç„¶åæŒ‰ç…§åˆ«äººçš„æ¨èæ‰§è¡Œå‘½ä»¤ï¼š
<code>/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</code></p>
<p>æ­¤æ—¶å¯¹äºå›½å†…ç½‘ç»œä¸å¥½çš„ç¯å¢ƒæ‰§è¡Œä¸Šè¯‰å‘½ä»¤åä¼šæŠ¥å¦‚ä¸‹å›¾æ‰€ç¤ºçš„é”™è¯¯</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d8687b2d551c419aa3c99830764fbe05~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWW9uZ1BhZ2FuaQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768633520&amp;x-signature=EpN3j6MyYfRZppXybD72k34eklw%3D" alt="image.png" loading="lazy"/></p>
<p>ä¸Šè¯‰é”™è¯¯çš„ä¸»è¦åŸå› æ˜¯<strong>ç½‘ç»œç¯å¢ƒé—®é¢˜</strong>ï¼šæœ¬åœ°ç½‘ç»œä¸ç¨³å®šã€é˜²ç«å¢™/ä»£ç†æ‹¦æˆªäº† HTTPS æµé‡ï¼Œæˆ– GitHub çš„ HTTP/2 è¿æ¥åœ¨ä½ çš„ç½‘ç»œç¯å¢ƒä¸‹å…¼å®¹æ€§ä¸ä½³ã€‚</p>
<h3 data-id="heading-0">è§£å†³æ–¹æ¡ˆ 1ï¼šä½¿ç”¨å›½å†…é•œåƒæºå®‰è£…ï¼ˆæ¨èï¼Œæœ€ç¨³å®šï¼‰</h3>
<p>åŸè„šæœ¬è®¿é—® GitHub èµ„æºå®¹æ˜“è¶…æ—¶ / è¿æ¥å¤±è´¥ï¼Œæ”¹ç”¨å›½å†…é•œåƒæºèƒ½å¤§å¹…æå‡æˆåŠŸç‡ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸´æ—¶è®¾ç½®é•œåƒæºå¹¶æ‰§è¡Œå®‰è£…è„šæœ¬ï¼ˆä¸€é”®å¼ï¼Œæ— éœ€æ‰‹åŠ¨æ”¹é…ç½®ï¼‰ </span>
/bin/bash -c <span class="hljs-string">"<span class="hljs-subst">$(curl -fsSL https://gitee.com/cunkai/HomebrewCN/raw/master/Homebrew.sh)</span>"</span>
</code></pre>
<p>æ‰§è¡ŒåæŒ‰æç¤ºæ“ä½œï¼š</p>
<ol>
<li>é€‰æ‹©ä¸€ä¸ªå›½å†…é•œåƒæºï¼ˆæ¯”å¦‚æ¸…åï¼‰ï¼›
<img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d22979eba05542969821a997947f5303~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgWW9uZ1BhZ2FuaQ==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768633520&amp;x-signature=9EpBXrz0TewP4Zgt2Ky9lp0KeyY%3D" alt="image.png" loading="lazy"/></li>
<li>ç­‰å¾…è„šæœ¬è‡ªåŠ¨å®‰è£… Homebrew æ ¸å¿ƒç»„ä»¶ï¼›</li>
<li>å®‰è£…å®Œæˆåï¼Œè„šæœ¬ä¼šè‡ªåŠ¨é…ç½®å¥½åç»­çš„é•œåƒæºï¼Œé¿å…åç»­ <code>brew</code> å‘½ä»¤å†å‡ºç½‘ç»œé—®é¢˜ã€‚</li>
</ol>
<p>å®‰è£…å®Œæˆåï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ï¼š</p>
<pre><code class="hljs language-js" lang="js"># æŸ¥çœ‹ brew ç‰ˆæœ¬ 
brew -v 
# æµ‹è¯•åŸºæœ¬åŠŸèƒ½ 
brew doctor
</code></pre>
<p>å¦‚æœèƒ½æ­£å¸¸æ˜¾ç¤ºç‰ˆæœ¬å·ï¼Œä¸” <code>brew doctor</code> æ— ä¸¥é‡é”™è¯¯ï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[SQL Server 2017 EXISTS å…³é”®å­— å®Œæ•´ç”¨æ³•è¯¦è§£ï¼ˆæœ€å…¨ + æœ€ä¼˜å†™æ³• + æ€§èƒ½å¯¹æ¯”ï¼‰]]></title>    <link>https://juejin.cn/post/7593258683750318114</link>    <guid>https://juejin.cn/post/7593258683750318114</guid>    <pubDate>2026-01-10T06:48:12.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593258683750318114" data-draft-id="7593258683750252578" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="SQL Server 2017 EXISTS å…³é”®å­— å®Œæ•´ç”¨æ³•è¯¦è§£ï¼ˆæœ€å…¨ + æœ€ä¼˜å†™æ³• + æ€§èƒ½å¯¹æ¯”ï¼‰"/> <meta itemprop="keywords" content="SQL Server,SQL"/> <meta itemprop="datePublished" content="2026-01-10T06:48:12.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Waloo"/> <meta itemprop="url" content="https://juejin.cn/user/2065330513129546"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            SQL Server 2017 EXISTS å…³é”®å­— å®Œæ•´ç”¨æ³•è¯¦è§£ï¼ˆæœ€å…¨ + æœ€ä¼˜å†™æ³• + æ€§èƒ½å¯¹æ¯”ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2065330513129546/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Waloo
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T06:48:12.000Z" title="Sat Jan 10 2026 06:48:12 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><code>EXISTS</code>æ˜¯ SQL é«˜é¢‘ä¸”é«˜æ•ˆçš„å…³é”®å­—ï¼ŒæŒæ¡åèƒ½å¤§å¹…ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ï¼Œå†…å®¹å…¨éƒ¨é€‚é… SQL Server 2017ï¼Œç›´æ¥å¥—ç”¨å³å¯ã€‚</p>
<h2 data-id="heading-0">âœ… ä¸€ã€<code>EXISTS</code> æ ¸å¿ƒå®šä¹‰ &amp; æ‰§è¡Œé€»è¾‘ï¼ˆé‡ä¸­ä¹‹é‡ï¼‰</h2>
<h3 data-id="heading-1">1. åŸºç¡€å®šä¹‰</h3>
<p><code>EXISTS</code> æ˜¯ <strong>SQL é€»è¾‘åˆ¤æ–­è¿ç®—ç¬¦</strong>ï¼Œä¸“é—¨ç”¨æ¥åˆ¤æ–­ã€Œ<strong>å­æŸ¥è¯¢æ˜¯å¦è¿”å›æ•°æ®è¡Œ</strong>ã€ï¼Œè¿”å›ç»“æœåªæœ‰ä¸¤ç§ï¼š<code>TRUE</code> æˆ– <code>FALSE</code>ã€‚</p>
<h3 data-id="heading-2">2. æ ¸å¿ƒæ‰§è¡Œé€»è¾‘ï¼ˆçµé­‚ï¼å¿…é¡»è®°ä½ï¼‰</h3>
<p><code>EXISTS</code> æ‰§è¡Œæ—¶æ˜¯ <strong>ã€Œå­˜åœ¨å³æ­¢ã€</strong> çš„é€»è¾‘ï¼š</p>
<blockquote>
<p>å­æŸ¥è¯¢åªè¦èƒ½æŸ¥è¯¢åˆ°<strong>è‡³å°‘ 1 æ¡ç¬¦åˆæ¡ä»¶çš„æ•°æ®</strong>ï¼Œ<code>EXISTS()</code> å°±ç«‹åˆ»è¿”å› <code>TRUE</code>ï¼Œ<strong>ä¸ä¼šç»§ç»­æŸ¥è¯¢å‰©ä½™æ•°æ®</strong>ï¼›å­æŸ¥è¯¢å¦‚æœ<strong>ä¸€æ¡æ•°æ®éƒ½æŸ¥ä¸åˆ°</strong>ï¼Œåˆ™è¿”å› <code>FALSE</code>ã€‚</p>
</blockquote>
<p>âœ… å…³é”®ç‚¹ï¼š<strong><code>EXISTS</code> åªå…³å¿ƒã€Œæœ‰æ²¡æœ‰æ•°æ®ã€ï¼Œä¸å…³å¿ƒå­æŸ¥è¯¢è¿”å›ä»€ä¹ˆå­—æ®µ / ä»€ä¹ˆå€¼</strong>ï¼</p>
<h2 data-id="heading-3">âœ… äºŒã€<code>EXISTS</code> æ ‡å‡†è¯­æ³•æ ¼å¼</h2>
<h3 data-id="heading-4">åŸºç¡€è¯­æ³•ï¼ˆ2 ç§å¸¸ç”¨æ ¼å¼ï¼Œå®Œå…¨ç­‰ä»·ï¼Œæ¨èç¬¬ä¸€ç§ï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- æ ¼å¼1ï¼šæ ‡å‡†å†™æ³•ï¼ˆæ¨èï¼Œå¯è¯»æ€§æœ€é«˜ï¼‰</span>
<span class="hljs-keyword">SELECT</span> å­—æ®µ<span class="hljs-number">1</span>,å­—æ®µ<span class="hljs-number">2</span>,...
<span class="hljs-keyword">FROM</span> ä¸»è¡¨ a
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (
    <span class="hljs-comment">-- å­æŸ¥è¯¢ï¼šå…³è”ä¸»è¡¨ï¼Œè®¾ç½®åŒ¹é…æ¡ä»¶</span>
    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>  <span class="hljs-comment">-- é‡ç‚¹ï¼šè¿™é‡Œå†™ * / 1 / ä»»æ„å­—æ®µ æ•ˆæœå®Œå…¨ä¸€æ ·ï¼Œæ€§èƒ½æ— å·®åˆ«</span>
    <span class="hljs-keyword">FROM</span> å­è¡¨ b
    <span class="hljs-keyword">WHERE</span> a.å…³è”å­—æ®µ <span class="hljs-operator">=</span> b.å…³è”å­—æ®µ  <span class="hljs-comment">-- ä¸»è¡¨å’Œå­è¡¨çš„å…³è”æ¡ä»¶ã€æ ¸å¿ƒã€‘</span>
    <span class="hljs-keyword">AND</span> å­è¡¨çš„è¿‡æ»¤æ¡ä»¶             <span class="hljs-comment">-- å¯é€‰ï¼Œå­è¡¨çš„é¢å¤–ç­›é€‰</span>
);

<span class="hljs-comment">-- æ ¼å¼2ï¼šNOT EXISTS åå‘æŸ¥è¯¢ï¼ˆæŸ¥è¯¢ã€Œä¸å­˜åœ¨åŒ¹é…æ•°æ®ã€çš„ç»“æœï¼‰</span>
<span class="hljs-keyword">SELECT</span> å­—æ®µ<span class="hljs-number">1</span>,å­—æ®µ<span class="hljs-number">2</span>,...
<span class="hljs-keyword">FROM</span> ä¸»è¡¨ a
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>
    <span class="hljs-keyword">FROM</span> å­è¡¨ b
    <span class="hljs-keyword">WHERE</span> a.å…³è”å­—æ®µ <span class="hljs-operator">=</span> b.å…³è”å­—æ®µ
    <span class="hljs-keyword">AND</span> å­è¡¨çš„è¿‡æ»¤æ¡ä»¶
);
</code></pre>
<h3 data-id="heading-5">âœ¨ å¿…è®°çŸ¥è¯†ç‚¹ï¼šå­æŸ¥è¯¢é‡Œçš„ <code>SELECT *</code> å¯ä»¥éšä¾¿å†™ï¼</h3>
<p><code>EXISTS</code> åªåˆ¤æ–­ã€Œå­æŸ¥è¯¢æ˜¯å¦æœ‰ç»“æœé›†ã€ï¼Œæ‰€ä»¥å­æŸ¥è¯¢é‡Œçš„ <code>SELECT</code> åé¢å†™ä»€ä¹ˆéƒ½å¯ä»¥ï¼š<code>SELECT *</code>ã€<code>SELECT 1</code>ã€<code>SELECT ä¸»é”®</code>ã€<code>SELECT ä»»æ„å­—æ®µ</code> â†’ <strong>æ€§èƒ½å®Œå…¨ä¸€è‡´ã€ç»“æœå®Œå…¨ä¸€è‡´</strong>ã€‚âœ… è¡Œä¸šæœ€ä½³å®è·µï¼šå†™ <code>SELECT 1</code>ï¼Œè¯­ä¹‰æ›´æ¸…æ™°ï¼Œå‘Šè¯‰é˜…è¯»è€…ã€Œè¿™é‡Œåªåšå­˜åœ¨åˆ¤æ–­ï¼Œä¸å…³å¿ƒå…·ä½“å­—æ®µã€ï¼Œä¾‹å¦‚ï¼š</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> å­è¡¨ b <span class="hljs-keyword">WHERE</span> a.id <span class="hljs-operator">=</span> b.main_id)
</code></pre>
<h2 data-id="heading-6">âœ… ä¸‰ã€<code>EXISTS</code> ä¸¤ç§æ ¸å¿ƒç”¨æ³•ï¼ˆå«å®æˆ˜æ¡ˆä¾‹ï¼Œæœ€å¸¸ç”¨ï¼‰</h2>
<p>ä¸ºäº†æ–¹ä¾¿ä½ ç†è§£å’Œå¥—ç”¨ï¼Œç”¨<strong>ä¸šåŠ¡åœºæ™¯åŒ–æ¡ˆä¾‹</strong>æ¼”ç¤ºï¼Œæ‰€æœ‰ SQL ç›´æ¥å¯è¿è¡Œï¼Œè¡¨ç»“æ„æ˜¯æ—¥å¸¸å¼€å‘æœ€å¸¸è§çš„ï¼š</p>
<h3 data-id="heading-7">æ¡ˆä¾‹åŸºç¡€è¡¨ï¼ˆ2 å¼ å…³è”è¡¨ï¼‰</h3>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- éƒ¨é—¨è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> Dept(DeptId <span class="hljs-type">INT</span>, DeptName <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>));
<span class="hljs-comment">-- å‘˜å·¥è¡¨</span>
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> Emp(EmpId <span class="hljs-type">INT</span>, EmpName <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">50</span>), DeptId <span class="hljs-type">INT</span>, Salary <span class="hljs-type">DECIMAL</span>(<span class="hljs-number">10</span>,<span class="hljs-number">2</span>));
</code></pre>
<h3 data-id="heading-8">âœ… ç”¨æ³• 1ï¼šæ­£å‘æŸ¥è¯¢ â†’ <code>EXISTS</code> åŒ¹é…ã€å­˜åœ¨å…³è”æ•°æ®ã€‘çš„è®°å½•</h3>
<blockquote>
<p>ä¸šåŠ¡éœ€æ±‚ï¼šæŸ¥è¯¢ã€Œ<strong>æœ‰å‘˜å·¥çš„éƒ¨é—¨</strong>ã€åˆ—è¡¨ï¼ˆå³ï¼šéƒ¨é—¨è¡¨ä¸­ï¼Œå­˜åœ¨å¯¹åº”å‘˜å·¥çš„éƒ¨é—¨ï¼‰</p>
</blockquote>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> DeptId, DeptName
<span class="hljs-keyword">FROM</span> Dept d
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">FROM</span> Emp e
    <span class="hljs-keyword">WHERE</span> d.DeptId <span class="hljs-operator">=</span> e.DeptId  <span class="hljs-comment">-- ä¸»è¡¨Deptå…³è”å­è¡¨Emp</span>
);
</code></pre>
<h3 data-id="heading-9">âœ… ç”¨æ³• 2ï¼šåå‘æŸ¥è¯¢ â†’ <code>NOT EXISTS</code> åŒ¹é…ã€æ— å…³è”æ•°æ®ã€‘çš„è®°å½•</h3>
<blockquote>
<p>ä¸šåŠ¡éœ€æ±‚ï¼šæŸ¥è¯¢ã€Œ<strong>ç©ºéƒ¨é—¨ / æ— å‘˜å·¥çš„éƒ¨é—¨</strong>ã€åˆ—è¡¨ï¼ˆå³ï¼šéƒ¨é—¨è¡¨ä¸­ï¼Œæ²¡æœ‰ä»»ä½•å‘˜å·¥çš„éƒ¨é—¨ï¼‰</p>
</blockquote>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> DeptId, DeptName
<span class="hljs-keyword">FROM</span> Dept d
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">FROM</span> Emp e
    <span class="hljs-keyword">WHERE</span> d.DeptId <span class="hljs-operator">=</span> e.DeptId
);
</code></pre>
<h3 data-id="heading-10">âœ… è¿›é˜¶ç”¨æ³•ï¼šå¸¦é¢å¤–è¿‡æ»¤æ¡ä»¶çš„<code>EXISTS</code>ï¼ˆå·¥ä½œä¸­ 90% çš„çœŸå®åœºæ™¯ï¼‰</h3>
<blockquote>
<p>ä¸šåŠ¡éœ€æ±‚ï¼šæŸ¥è¯¢ã€Œ<strong>æœ‰ã€æœˆè–ªå¤§äº 10000ã€‘å‘˜å·¥çš„éƒ¨é—¨</strong>ã€åˆ—è¡¨</p>
</blockquote>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> DeptId, DeptName
<span class="hljs-keyword">FROM</span> Dept d
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>
    <span class="hljs-keyword">FROM</span> Emp e
    <span class="hljs-keyword">WHERE</span> d.DeptId <span class="hljs-operator">=</span> e.DeptId
    <span class="hljs-keyword">AND</span> e.Salary <span class="hljs-operator">&gt;</span> <span class="hljs-number">10000</span>  <span class="hljs-comment">-- å­è¡¨çš„é¢å¤–è¿‡æ»¤æ¡ä»¶</span>
);
</code></pre>
<h2 data-id="heading-11">âœ… å››ã€<code>EXISTS</code> ä¸ <code>IN</code> çš„åŒºåˆ«ï¼ˆé«˜é¢‘é¢è¯•é¢˜ + æ€§èƒ½å¤©å£¤ä¹‹åˆ«ï¼‰</h2>
<p>ä½ å¤§æ¦‚ç‡ä¼šæœ‰ç–‘é—®ï¼š<code>SELECT ... WHERE å­—æ®µ IN (å­æŸ¥è¯¢)</code> ä¹Ÿèƒ½å®ç°ç±»ä¼¼æ•ˆæœï¼Œå’Œ<code>EXISTS</code>æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿç”¨å“ªä¸ªæ›´å¥½ï¼Ÿè¿™æ˜¯<strong>SQL ä¼˜åŒ–çš„æ ¸å¿ƒè€ƒç‚¹</strong>ï¼Œä¹Ÿæ˜¯æ—¥å¸¸å¼€å‘ä¸­æœ€å®¹æ˜“è¸©å‘çš„ç‚¹ï¼Œ<strong>ç»“è®ºå…ˆè¯´ï¼šåœ¨ SQL Server 2017 ä¸­ï¼Œä¼˜å…ˆç”¨<code>EXISTS</code>ï¼Œå°¤å…¶æ˜¯å¤§æ•°æ®é‡åœºæ™¯</strong>ï¼</p>
<h3 data-id="heading-12">âœ… æ ¸å¿ƒåŒºåˆ« 1ï¼šæ‰§è¡Œé€»è¾‘å®Œå…¨ä¸åŒ</h3>
<h4 data-id="heading-13">â‘  <code>IN (å­æŸ¥è¯¢)</code> æ‰§è¡Œé€»è¾‘ â†’ ã€Œå…¨é‡åŒ¹é…ã€</h4>
<p><code>IN</code> ä¼šå…ˆæ‰§è¡Œ<strong>å­æŸ¥è¯¢</strong>ï¼ŒæŠŠå­æŸ¥è¯¢çš„ç»“æœé›†<strong>å…¨éƒ¨æŸ¥è¯¢å‡ºæ¥</strong>ï¼Œç”Ÿæˆä¸€ä¸ªä¸´æ—¶çš„ç»“æœåˆ—è¡¨ï¼Œç„¶å<strong>ä¸»è¡¨çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å»å’Œè¿™ä¸ªåˆ—è¡¨åšåŒ¹é…</strong>ã€‚</p>
<ul>
<li>è¿‡ç¨‹ï¼šå­æŸ¥è¯¢å…¨é‡æ‰§è¡Œ â†’ ç”Ÿæˆä¸´æ—¶åˆ—è¡¨ â†’ ä¸»è¡¨é€æ¡åŒ¹é…</li>
<li>ç¼ºç‚¹ï¼šå¦‚æœå­æŸ¥è¯¢è¿”å›çš„ç»“æœé›†å¾ˆå¤§ï¼ˆæ¯”å¦‚å‡ ä¸‡ / å‡ åä¸‡æ¡ï¼‰ï¼Œä¸´æ—¶åˆ—è¡¨ä¼šå ç”¨å¤§é‡å†…å­˜ï¼ŒåŒ¹é…æ•ˆç‡æä½ï¼ŒæŸ¥è¯¢ä¼šå¾ˆæ…¢ï¼</li>
</ul>
<h4 data-id="heading-14">â‘¡ <code>EXISTS</code> æ‰§è¡Œé€»è¾‘ â†’ ã€Œé€è¡ŒåŒ¹é… + å­˜åœ¨å³æ­¢ã€</h4>
<p><code>EXISTS</code> æ˜¯<strong>ä»ä¸»è¡¨å¼€å§‹é€è¡ŒæŸ¥è¯¢</strong>ï¼Œæ¯å–ä¸»è¡¨çš„ 1 æ¡æ•°æ®ï¼Œå°±æ‰§è¡Œ 1 æ¬¡å­æŸ¥è¯¢åšåŒ¹é…ï¼Œåªè¦å­æŸ¥è¯¢èƒ½æŸ¥åˆ° 1 æ¡åŒ¹é…æ•°æ®ï¼Œç«‹åˆ»åœæ­¢åŒ¹é…è¿™æ¡ä¸»æ•°æ®ï¼Œç»§ç»­ä¸‹ä¸€æ¡ã€‚</p>
<ul>
<li>è¿‡ç¨‹ï¼šä¸»è¡¨é€è¡Œéå† â†’ å­æŸ¥è¯¢æŒ‰éœ€æ‰§è¡Œ â†’ åŒ¹é…åˆ°å³åœæ­¢</li>
<li>ä¼˜ç‚¹ï¼š<strong>ä¸ç”Ÿæˆä¸´æ—¶ç»“æœé›†</strong>ï¼Œå†…å­˜å ç”¨æä½ï¼Œå“ªæ€•ä¸»è¡¨å’Œå­è¡¨éƒ½æ˜¯å¤§æ•°æ®é‡ï¼Œæ•ˆç‡ä¾ç„¶å¾ˆé«˜ï¼</li>
</ul>
<h3 data-id="heading-15">âœ… æ ¸å¿ƒåŒºåˆ« 2ï¼šå¯¹ã€ŒNULL å€¼ã€çš„å¤„ç†ä¸åŒï¼ˆå¿…é¿å‘ï¼‰</h3>
<p><code>IN</code> é‡åˆ°å­æŸ¥è¯¢è¿”å› <strong>NULL å€¼</strong> æ—¶ï¼Œä¼šç›´æ¥è¿”å› <code>FALSE</code>ï¼Œå¯¼è‡´<strong>æ•´ä¸ªæŸ¥è¯¢æ— ç»“æœ</strong>ï¼›<code>EXISTS</code> å®Œå…¨ä¸å— NULL å€¼ å½±å“ï¼Œåˆ¤æ–­é€»è¾‘ä¾ç„¶æ­£å¸¸ç”Ÿæ•ˆã€‚</p>
<h4 data-id="heading-16">ç¤ºä¾‹å¯¹æ¯”ï¼ˆè¸©å‘æ¡ˆä¾‹ï¼‰</h4>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- åœºæ™¯ï¼šå­æŸ¥è¯¢è¿”å›åŒ…å«NULLçš„ç»“æœé›†</span>
<span class="hljs-comment">-- å†™æ³•1ï¼šIN ä¼šè¿”å›ç©ºç»“æœï¼Œè¸©å‘ï¼</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Emp <span class="hljs-keyword">WHERE</span> DeptId <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> DeptId <span class="hljs-keyword">FROM</span> Dept <span class="hljs-keyword">WHERE</span> DeptName<span class="hljs-operator">=</span><span class="hljs-string">'æŠ€æœ¯éƒ¨'</span> <span class="hljs-keyword">UNION</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">NULL</span>);

<span class="hljs-comment">-- å†™æ³•2ï¼šEXISTS æ­£å¸¸è¿”å›ç»“æœï¼Œæ— å½±å“</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Emp e <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> Dept d <span class="hljs-keyword">WHERE</span> d.DeptId<span class="hljs-operator">=</span>e.DeptId <span class="hljs-keyword">AND</span> d.DeptName<span class="hljs-operator">=</span><span class="hljs-string">'æŠ€æœ¯éƒ¨'</span> <span class="hljs-keyword">OR</span> d.DeptId <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>);
</code></pre>
<h2 data-id="heading-17">âœ… äº”ã€æ‰©å±•ï¼š<code>EXISTS</code> å’Œ<code>ROW_NUMBER()</code>ä¸€èµ·ä½¿ç”¨</h2>
<p>è‹¥éœ€æ±‚æ˜¯ <strong><code>ROW_NUMBER() OVER(PARTITION BY éƒ¨é—¨)</code> åˆ†ç»„æ’åº + è¿‡æ»¤æŒ‡å®šéƒ¨é—¨</strong>ï¼Œç°åœ¨ç»“åˆ<code>EXISTS</code>ï¼Œæ¼”ç¤º 2 ä¸ª<strong>å·¥ä½œä¸­æœ€å¸¸ç”¨çš„å®æˆ˜ç»„åˆåœºæ™¯</strong>ï¼Œç›´æ¥å¥—ç”¨ï¼</p>
<h3 data-id="heading-18">âœ… åœºæ™¯ 1ï¼šæŸ¥è¯¢ã€Œå­˜åœ¨æŒ‡å®šå®¢æˆ·çš„éƒ¨é—¨ã€+ æŒ‰éƒ¨é—¨åˆ†ç»„ç”Ÿæˆè¡Œå·</h3>
<blockquote>
<p>éœ€æ±‚ï¼šåªä¿ç•™ã€Œæœ‰ã€VIP å®¢æˆ·ã€‘çš„éƒ¨é—¨ã€ï¼Œå¹¶å¯¹æ¯ä¸ªéƒ¨é—¨ä¸‹çš„å®¢æˆ·æŒ‰è´Ÿè´£äºº + å®¢æˆ·åç§°æ’åºç”Ÿæˆè¡Œå·</p>
</blockquote>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> 
    h.éƒ¨é—¨, h.è´Ÿè´£äºº, h.å®¢æˆ·åç§°,
    <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> h.éƒ¨é—¨ <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> h.è´Ÿè´£äºº, h.å®¢æˆ·åç§°) <span class="hljs-keyword">AS</span> è¡Œå·
<span class="hljs-keyword">FROM</span> ä½ çš„è¡¨ h
<span class="hljs-comment">-- æ ¸å¿ƒï¼šåªä¿ç•™å­˜åœ¨VIPå®¢æˆ·çš„éƒ¨é—¨</span>
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> ä½ çš„è¡¨ t 
    <span class="hljs-keyword">WHERE</span> t.éƒ¨é—¨ <span class="hljs-operator">=</span> h.éƒ¨é—¨ <span class="hljs-keyword">AND</span> t.å®¢æˆ·ç±»å‹ <span class="hljs-operator">=</span> <span class="hljs-string">'VIPå®¢æˆ·'</span>
);
</code></pre>
<h3 data-id="heading-19">âœ… åœºæ™¯ 2ï¼šæŸ¥è¯¢ã€Œä¸å­˜åœ¨æ— æ•ˆæ•°æ®çš„éƒ¨é—¨ã€+ åˆ†ç»„å»é‡ï¼ˆç»å…¸éœ€æ±‚ï¼‰</h3>
<blockquote>
<p>éœ€æ±‚ï¼šè¿‡æ»¤æ‰ã€Œæœ‰æ— æ•ˆå®¢æˆ·ï¼ˆå®¢æˆ·åç§°ä¸ºç©ºï¼‰ã€çš„éƒ¨é—¨ï¼ŒåŒæ—¶ç»™æ¯ä¸ªæœ‰æ•ˆéƒ¨é—¨çš„å®¢æˆ·ç”Ÿæˆè¡Œå·ï¼Œå–æ¯ä¸ªéƒ¨é—¨çš„ç¬¬ä¸€æ¡æ•°æ®</p>
</blockquote>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">WITH</span> TempData <span class="hljs-keyword">AS</span> (
    <span class="hljs-keyword">SELECT</span> 
        h.éƒ¨é—¨, h.è´Ÿè´£äºº, h.å®¢æˆ·åç§°,
        <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> h.éƒ¨é—¨ <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> h.è´Ÿè´£äºº) <span class="hljs-keyword">AS</span> è¡Œå·
    <span class="hljs-keyword">FROM</span> ä½ çš„è¡¨ h
    <span class="hljs-comment">-- è¿‡æ»¤ï¼šæ— æ— æ•ˆå®¢æˆ·çš„éƒ¨é—¨</span>
    <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> (
        <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> ä½ çš„è¡¨ t <span class="hljs-keyword">WHERE</span> t.éƒ¨é—¨ <span class="hljs-operator">=</span> h.éƒ¨é—¨ <span class="hljs-keyword">AND</span> t.å®¢æˆ·åç§° <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>
    )
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> TempData <span class="hljs-keyword">WHERE</span> è¡Œå·<span class="hljs-operator">=</span><span class="hljs-number">1</span>; <span class="hljs-comment">-- æ¯ä¸ªéƒ¨é—¨åªå–ç¬¬ä¸€æ¡</span>
</code></pre>
<h2 data-id="heading-20">âœ… å…­ã€<code>EXISTS</code> é«˜çº§ç”¨æ³•è¡¥å……ï¼ˆ3 ä¸ªé«˜é¢‘åœºæ™¯ï¼‰</h2>
<h3 data-id="heading-21">âœ… åœºæ™¯ 1ï¼š<code>EXISTS</code> å®ç°ã€Œè¡¨çš„å»é‡æŸ¥è¯¢ã€ï¼ˆæ›¿ä»£ DISTINCTï¼Œæ€§èƒ½æ›´å¥½ï¼‰</h3>
<p>DISTINCT æ˜¯å…¨é‡æŸ¥è¯¢åå»é‡ï¼Œå¤§æ•°æ®é‡æ•ˆç‡ä½ï¼›EXISTS æ˜¯åŒ¹é…åˆ°å³åœæ­¢ï¼Œæ•ˆç‡æ›´é«˜ã€‚</p>
<blockquote>
<p>éœ€æ±‚ï¼šæŸ¥è¯¢æ‰€æœ‰æœ‰è®¢å•çš„å®¢æˆ·ï¼Œå»é‡æ˜¾ç¤ºå®¢æˆ·ä¿¡æ¯</p>
</blockquote>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å†™æ³•1ï¼šDISTINCT æ•ˆç‡ä½</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> c.<span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Customer c <span class="hljs-keyword">JOIN</span> OrderList o <span class="hljs-keyword">ON</span> c.CustId<span class="hljs-operator">=</span>o.CustId;

<span class="hljs-comment">-- å†™æ³•2ï¼šEXISTS æ•ˆç‡é«˜ï¼ˆæ¨èï¼‰</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Customer c <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> OrderList o <span class="hljs-keyword">WHERE</span> o.CustId<span class="hljs-operator">=</span>c.CustId);
</code></pre>
<h3 data-id="heading-22">âœ… åœºæ™¯ 2ï¼šå¤šå±‚åµŒå¥— <code>EXISTS</code>ï¼ˆå¤šè¡¨å…³è”åˆ¤æ–­ï¼‰</h3>
<p>æ”¯æŒæ— é™å±‚åµŒå¥—ï¼Œé€»è¾‘æ¸…æ™°ï¼Œæ€§èƒ½ä¾ç„¶ç¨³å®šï¼Œé€‚åˆå¤šè¡¨å…³è”çš„å¤æ‚åˆ¤æ–­ã€‚</p>
<blockquote>
<p>éœ€æ±‚ï¼šæŸ¥è¯¢ã€Œæœ‰ VIP å®¢æˆ·ï¼Œä¸”è¯¥å®¢æˆ·æœ‰æœªä»˜æ¬¾è®¢å•ã€çš„éƒ¨é—¨</p>
</blockquote>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Dept d
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> Emp e <span class="hljs-keyword">WHERE</span> e.DeptId<span class="hljs-operator">=</span>d.DeptId
    <span class="hljs-keyword">AND</span> <span class="hljs-keyword">EXISTS</span> (
        <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> Customer c <span class="hljs-keyword">WHERE</span> c.EmpId<span class="hljs-operator">=</span>e.EmpId <span class="hljs-keyword">AND</span> c.CustType<span class="hljs-operator">=</span><span class="hljs-string">'VIP'</span>
        <span class="hljs-keyword">AND</span> <span class="hljs-keyword">EXISTS</span> (
            <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> OrderList o <span class="hljs-keyword">WHERE</span> o.CustId<span class="hljs-operator">=</span>c.CustId <span class="hljs-keyword">AND</span> o.PayStatus<span class="hljs-operator">=</span><span class="hljs-string">'æœªä»˜æ¬¾'</span>
        )
    )
);
</code></pre>
<h3 data-id="heading-23">âœ… åœºæ™¯ 3ï¼š<code>EXISTS</code> æ›¿ä»£ <code>JOIN</code>ï¼ˆä»…æŸ¥è¯¢ä¸»è¡¨æ•°æ®æ—¶ï¼‰</h3>
<p>å¦‚æœä½ çš„éœ€æ±‚åªæ˜¯ã€ŒæŸ¥è¯¢ä¸»è¡¨æ•°æ®ï¼Œåªéœ€è¦åˆ¤æ–­æ˜¯å¦å­˜åœ¨å…³è”æ•°æ®ã€ï¼Œä¸éœ€è¦å­è¡¨çš„å­—æ®µï¼Œç”¨<code>EXISTS</code>æ›¿ä»£<code>JOIN</code>ï¼Œæ€§èƒ½ä¼šæ¯”<code>LEFT JOIN + IS NOT NULL</code>æ›´å¥½ã€‚</p>
<pre><code class="hljs language-sql" lang="sql"><span class="hljs-comment">-- å†™æ³•1ï¼šLEFT JOIN å»é‡</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> d.<span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Dept d <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> Emp e <span class="hljs-keyword">ON</span> d.DeptId<span class="hljs-operator">=</span>e.DeptId <span class="hljs-keyword">WHERE</span> e.EmpId <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>;

<span class="hljs-comment">-- å†™æ³•2ï¼šEXISTS æ›´ç®€æ´é«˜æ•ˆ</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> Dept d <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">EXISTS</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-keyword">FROM</span> Emp e <span class="hljs-keyword">WHERE</span> e.DeptId<span class="hljs-operator">=</span>d.DeptId);
</code></pre>
<h2 data-id="heading-24">âœ… ä¸ƒã€<code>EXISTS</code> æ€§èƒ½ä¼˜åŒ–å°æŠ€å·§ï¼ˆSQL Server 2017 ä¸“å±ï¼‰</h2>
<ol>
<li>âœ… å­æŸ¥è¯¢ä¸­å°½é‡ç”¨ <strong>ä¸»é”® / ç´¢å¼•å­—æ®µ</strong> åšå…³è”æ¡ä»¶ â†’ å­æŸ¥è¯¢çš„åŒ¹é…æ•ˆç‡ä¼šç¿»å€ï¼ˆSQL Server ä¼šèµ°ç´¢å¼•æŸ¥è¯¢ï¼‰ï¼›</li>
<li>âœ… å­æŸ¥è¯¢é‡Œåªå†™ã€Œå…³è”æ¡ä»¶ + å¿…è¦è¿‡æ»¤æ¡ä»¶ã€ï¼Œä¸è¦å†™å¤šä½™çš„å­—æ®µå’Œé€»è¾‘ï¼›</li>
<li>âœ… å¯¹é¢‘ç¹æŸ¥è¯¢çš„å…³è”å­—æ®µï¼ˆæ¯”å¦‚ DeptIdã€EmpIdï¼‰å»ºç«‹<strong>éèšé›†ç´¢å¼•</strong>ï¼Œèƒ½è®© EXISTS çš„æŸ¥è¯¢æ•ˆç‡å†æå‡ä¸€ä¸ªé‡çº§ã€‚</li>
</ol>
<h2 data-id="heading-25">âœ… æ€»ç»“ï¼ˆæ‰€æœ‰æ ¸å¿ƒçŸ¥è¯†ç‚¹æµ“ç¼©ï¼Œå»ºè®®æ”¶è—ï¼‰</h2>
<h3 data-id="heading-26">1. <code>EXISTS</code> æ ¸å¿ƒ</h3>
<ul>
<li>æ˜¯é€»è¾‘è¿ç®—ç¬¦ï¼Œè¿”å›<code>TRUE/FALSE</code>ï¼Œåªåˆ¤æ–­ã€Œå­æŸ¥è¯¢æ˜¯å¦æœ‰ç»“æœã€ï¼›</li>
<li>å­æŸ¥è¯¢å†™<code>SELECT 1</code>æœ€ä½³ï¼Œ<code>SELECT *</code>ä¹Ÿå¯ä»¥ï¼Œæ€§èƒ½æ— å·®åˆ«ï¼›</li>
<li>æ‰§è¡Œé€»è¾‘ï¼š<strong>é€è¡ŒåŒ¹é…ã€å­˜åœ¨å³æ­¢</strong>ï¼Œæ€§èƒ½å¤©èŠ±æ¿çº§åˆ«çš„åˆ¤æ–­æ–¹å¼ã€‚</li>
</ul>
<h3 data-id="heading-27">2. <code>NOT EXISTS</code> æ ¸å¿ƒ</h3>
<ul>
<li>åå‘åˆ¤æ–­ã€Œæ— åŒ¹é…æ•°æ®ã€ï¼Œæ˜¯æŸ¥è¯¢ã€Œç¼ºå¤±æ•°æ®ã€çš„æœ€ä¼˜å†™æ³•ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚</li>
</ul>
<h3 data-id="heading-28">3. <code>EXISTS</code> vs <code>IN</code> æ ¸å¿ƒ</h3>
<ul>
<li>æ‰§è¡Œé€»è¾‘ï¼šEXISTS é€è¡ŒåŒ¹é…ï¼ŒIN å…¨é‡ç”Ÿæˆä¸´æ—¶åˆ—è¡¨ï¼›</li>
<li>æ€§èƒ½ï¼šEXISTS &gt;&gt; INï¼ˆå¤§æ•°æ®é‡åœºæ™¯å·®è·æ‚¬æ®Šï¼‰ï¼›</li>
<li>å‘ç‚¹ï¼šIN å— NULL å€¼å½±å“ï¼ŒEXISTS ä¸å—ï¼›</li>
<li>é€‰æ‹©ï¼šä¼˜å…ˆç”¨ EXISTSï¼Œå›ºå®šå€¼åˆ—è¡¨ç”¨ INã€‚</li>
</ul>
<h3 data-id="heading-29">4. ç»“åˆä½ çš„éœ€æ±‚</h3>
<ul>
<li><code>EXISTS + ROW_NUMBER()</code> æ˜¯å®Œç¾ç»„åˆï¼Œæ—¢èƒ½é«˜æ•ˆè¿‡æ»¤æ•°æ®ï¼Œåˆèƒ½æŒ‰åˆ†ç»„ç”Ÿæˆè¡Œå·ï¼Œæ˜¯ SQL Server ä¸­å¤„ç†åˆ†ç»„æ’åº + æ¡ä»¶è¿‡æ»¤çš„æœ€ä¼˜å†™æ³•ã€‚</li>
</ul>
<p>å¸Œæœ›è¿™ä»½è¯¦è§£èƒ½å¸®ä½ å½»åº•æŒæ¡<code>EXISTS</code>ï¼Œæ‰€æœ‰çŸ¥è¯†ç‚¹éƒ½æ˜¯ SQL Server 2017 çš„åŸç”Ÿæ”¯æŒï¼Œç›´æ¥ç”¨å°±è¡Œï¼ğŸ’¡</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€Pythonæºç ã€‘6Gï¼šPyTorch OFDM æ•™å­¦ä»¿çœŸå¹³å°]]></title>    <link>https://juejin.cn/post/7593212374922297371</link>    <guid>https://juejin.cn/post/7593212374922297371</guid>    <pubDate>2026-01-10T07:12:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593212374922297371" data-draft-id="7593240931287400500" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€Pythonæºç ã€‘6Gï¼šPyTorch OFDM æ•™å­¦ä»¿çœŸå¹³å°"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-10T07:12:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="3GPPä»¿çœŸå®éªŒå®¤"/> <meta itemprop="url" content="https://juejin.cn/user/590875532999898"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€Pythonæºç ã€‘6Gï¼šPyTorch OFDM æ•™å­¦ä»¿çœŸå¹³å°
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/590875532999898/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    3GPPä»¿çœŸå®éªŒå®¤
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T07:12:09.000Z" title="Sat Jan 10 2026 07:12:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>â€‹
ğŸ“¡ PyTorch 3GPP NR OFDM æ•™å­¦ä»¿çœŸå¹³å°</p>
<p><strong>PyTorch æ·±åº¦å­¦ä¹ ä¸æ— çº¿é€šä¿¡çš„å®Œç¾èåˆ Â· 3GPP æ ‡å‡†é€è¡Œå¤ç°</strong>
<em>ä» Tensor åŸºç¡€åˆ° Autograd ä¿¡é“ä¼°è®¡ Â· æ¢ç´¢ AI for Science çš„é€šä¿¡åŸºçŸ³</em></p>
<p>â€‹</p>
<h2 data-id="heading-0">ğŸ“Œ ä¸ºä»€ä¹ˆé€šè¿‡æœ¬é¡¹ç›®å­¦ä¹  PyTorchï¼Ÿ</h2>
<p>å¯¹ç€ <strong>PyTorch æ–‡æ¡£</strong> é‡Œçš„ <code>backward()</code> å‘æ„ï¼ŸåªçŸ¥é“è°ƒåº“ <code>import torch.nn</code> å´ä¸æ‡‚åº•å±‚å¾®åˆ†åŸç†ï¼Ÿæƒ³åš <strong>AI é€šä¿¡ (AI-RAN)</strong> å´å‘ç°ä¼ ç»Ÿ MATLAB ä»¿çœŸæ— æ³•å¹³æ»‘è¿ç§»ï¼Ÿ</p>
<p>æœ¬å¹³å°æä¾›äº†ä¸€å¥— <strong>æ•™ç§‘ä¹¦çº§</strong> çš„ PyTorch é€šä¿¡ä»¿çœŸæ•™ç¨‹ï¼Œå°†æŠ½è±¡çš„å¼ é‡æ“ä½œæ˜ å°„åˆ°å…·è±¡çš„ç‰©ç†å±‚ä¿¡å·å¤„ç†ã€‚</p>

























<table><thead><tr><th>ç—›ç‚¹ (å­¦ä¹ å›°å¢ƒ)</th><th>æœ¬å¹³å°è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>ğŸ”´ <strong>å¼ é‡æ“ä½œæŠ½è±¡</strong>(dim, broadcast)</td><td>âœ… <strong>é€šä¿¡åœºæ™¯åŒ–</strong>ï¼šç”¨ <code>[Batch, Ant, Subcarrier]</code> è§£é‡Šç»´åº¦ï¼Œç§’æ‡‚å¹¿æ’­æœºåˆ¶</td></tr><tr><td>ğŸ”´<strong>Autograd é»‘ç›’</strong></td><td>âœ… <strong>ç‰©ç†æ„ä¹‰è§£æ„</strong>ï¼šç”¨â€œä¿¡é“ä¼°è®¡â€æ¼”ç¤ºæ¢¯åº¦ä¸‹é™ï¼Œ<code>backward</code> å°±æ˜¯æ±‚å¯¼</td></tr><tr><td>ğŸ”´<strong>MATLAB è¿ç§»éš¾</strong></td><td>âœ…<strong>3GPP æ ‡å‡†å¤ç°</strong>ï¼šç”¨ PyTorch Tensor é‡å†™ TS 38.211ï¼Œå¯¹æ ‡ MATLAB å†™æ³•</td></tr><tr><td>ğŸ”´ <strong>é¢‘åŸŸå¤„ç†æ˜“é”™</strong></td><td>âœ… <strong>æ ‡å‡† OFDM æµç¨‹</strong>ï¼šå®Œç¾å¤„ç† <code>fftshift</code>ã€CPã€å­è½½æ³¢æ˜ å°„ï¼Œç¬¦åˆ 5G æ ‡å‡†</td></tr></tbody></table>
<h2 data-id="heading-1">ğŸ¯ æ ¸å¿ƒä»·å€¼</h2>
<p>â€‹â€‹</p>
<h3 data-id="heading-2">ğŸ”¬ å­¦æœ¯ç ”ç©¶ä»·å€¼ (AI for Comm)</h3>
<ul>
<li><strong>å¯å¾®åˆ†é€šä¿¡</strong>ï¼šå…¨é“¾è·¯ Tensor å®ç°ï¼Œæ”¯æŒç«¯åˆ°ç«¯åå‘ä¼ æ’­</li>
<li><strong>æ¢¯åº¦ä¸‹é™ä¿¡é“ä¼°è®¡</strong>ï¼šæ·±å…¥ç†è§£ MSE Loss ä¸ SGD åœ¨ç‰©ç†å±‚çš„ä½œç”¨</li>
<li><strong>é«˜æ€§èƒ½ä»¿çœŸ</strong>ï¼šåˆ©ç”¨ GPU åŠ é€Ÿå¤§è§„æ¨¡å¹¶è¡Œ OFDM ä»¿çœŸ</li>
<li><strong>3GPP å¯¹æ ‡</strong>ï¼šä¸¥æ ¼éµå¾ª TS 38.211 Numerology å®šä¹‰</li>
</ul>

<h3 data-id="heading-3">ğŸ’¼ å·¥ç¨‹åº”ç”¨ä»·å€¼ (5G NR)</h3>
<ul>
<li><strong>æ¨¡å—è§£è€¦</strong>ï¼šNumerology / Modulator / Channel å‡æ¨¡å—åŒ–è®¾è®¡</li>
<li><strong>å·¥ä¸šçº§å®ç°</strong>ï¼šæ”¯æŒ BPSK åˆ° 1024QAM å…¨é˜¶è°ƒåˆ¶</li>
<li><strong>å®Œæ•´é“¾è·¯</strong>ï¼šä»æ¯”ç‰¹æµåˆ°æ³¢å½¢çš„ E2E æ”¶å‘æ¼”ç¤º</li>
<li><strong>ä»£ç è§„èŒƒ</strong>ï¼šç±»å‹æç¤º (Type Hint) + è¯¦ç»†ä¸­æ–‡æ³¨é‡Š</li>
</ul>

<h2 data-id="heading-4">âš¡ æŠ€æœ¯äº®ç‚¹</h2>
<h3 data-id="heading-5">ğŸ—ï¸ è¯¾ç¨‹é˜¶æ®µæ¶æ„ (Staged Arch)</h3>
<pre><code class="hljs language-bash" lang="bash">src/
â”œâ”€â”€ ã€é˜¶æ®µä¸€ï¼šTensor ä¸åŸºç¡€ä¿¡å·å¤„ç†ã€‘
â”‚   â”œâ”€â”€ tensor_basics.py      <span class="hljs-comment"># å¼ é‡åŸºç¡€ï¼šå¹¿æ’­ã€è§†å›¾ã€å¤æ•°æ“ä½œ</span>
â”‚   â”œâ”€â”€ modulation.py         <span class="hljs-comment"># 3GPP è°ƒåˆ¶ï¼šBPSK/QPSK/16QAM...1024QAM (Gray Mapping)</span>
â”‚   â”œâ”€â”€ nr_ofdm.py            <span class="hljs-comment"># [TS 38.211] NRNumerology &amp; NROFDMModulator</span>
â”‚   â””â”€â”€ nr_ofdm_system.py     <span class="hljs-comment"># E2E ç³»ç»Ÿï¼šBER ä»¿çœŸé“¾è·¯</span>
â”‚
â”œâ”€â”€ ã€é˜¶æ®µäºŒï¼šAutograd ä¸ä¿¡é“ä¼°è®¡ã€‘
â”‚   â””â”€â”€ channel_estimation.py <span class="hljs-comment"># ğŸ”¥ è‡ªåŠ¨æ±‚å¯¼æ ¸å¿ƒæ¼”ç¤ºï¼šåŸºäºæ¢¯åº¦çš„ä¿¡é“ä¼°è®¡</span>
â”‚
â”œâ”€â”€ ã€é€šç”¨æ¨¡å—ã€‘
â”‚   â””â”€â”€ channel.py            <span class="hljs-comment"># AWGN ä¿¡é“æ¨¡å‹</span>
â”‚   
â””â”€â”€ ã€æ¼”ç¤ºä¸å¯è§†åŒ–ã€‘
    â”œâ”€â”€ examples/
    â”‚   â”œâ”€â”€ demo_nr_ofdm_ber.py   <span class="hljs-comment"># é˜¶æ®µä¸€ï¼šOFDM æ˜Ÿåº§å›¾ä¸ BER æ›²çº¿</span>
    â”‚   â””â”€â”€ src/channel_estimation.py ... (ç›´æ¥è¿è¡Œæ¨¡å—)
</code></pre>
<h3 data-id="heading-6">ğŸ“Š æ€§èƒ½å®æµ‹</h3>
<h4 data-id="heading-7">é˜¶æ®µä¸€ï¼šOFDM BER (3GPP Compliance)</h4>

































<table><thead><tr><th>SNR (dB)</th><th>QPSK (Sim)</th><th>16QAM (Sim)</th><th>64QAM (Sim)</th><th>Theory Match</th></tr></thead><tbody><tr><td>0</td><td>1.31e-01</td><td>2.63e-01</td><td>2.50e-01</td><td>âœ…</td></tr><tr><td>10</td><td><strong>2.06e-04</strong></td><td>4.26e-02</td><td>4.29e-02</td><td>âœ…</td></tr><tr><td>20</td><td>0</td><td>0</td><td>0</td><td>âœ…</td></tr></tbody></table>
<h4 data-id="heading-8">é˜¶æ®µäºŒï¼šè‡ªåŠ¨æ±‚å¯¼ä¿¡é“ä¼°è®¡ (h_true = 0.8 + 0.6j)</h4>





























<table><thead><tr><th>ä¼˜åŒ–å™¨</th><th>è¿­ä»£æ¬¡æ•°</th><th>æœ€ç»ˆè¯¯å·®</th><th>æ”¶æ•›ç‰¹æ€§</th></tr></thead><tbody><tr><td><strong>Manual</strong></td><td>50</td><td>0.0026</td><td>å¿«é€Ÿï¼Œæ¼”ç¤ºåŸç†</td></tr><tr><td><strong>SGD</strong></td><td>50</td><td>0.0026</td><td>ç¨³å®šï¼Œæ ‡å‡† GD</td></tr><tr><td><strong>Adam</strong></td><td>50</td><td>0.0170</td><td>æŒ¯è¡æ”¶æ•›</td></tr></tbody></table>
<h2 data-id="heading-9">ğŸ’» æ ¸å¿ƒä»£ç å±•ç¤º</h2>
<h3 data-id="heading-10">ğŸ”¥ 3GPP OFDM è°ƒåˆ¶ (<code>src/nr_ofdm.py</code>)</h3>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">modulate</span>(<span class="hljs-params">self, freq_grid: torch.Tensor, symbol_idx: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span></span>) -&gt; torch.Tensor:
    <span class="hljs-string">"""
    é¢‘åŸŸ â†’ æ—¶åŸŸ (IFFT + CP) [TS 38.211]
    """</span>
    <span class="hljs-comment"># 1. IFFT (PyTorch åŸç”Ÿ FFT æ”¯æŒ)</span>
    <span class="hljs-comment">#    è¾“å…¥ä¸ºæ ‡å‡† FFT æ ¼å¼ (DC at index 0)</span>
    time_signal = torch.fft.ifft(freq_grid)
    
    <span class="hljs-comment"># 2. æ·»åŠ  Cyclic Prefix (CP)</span>
    cp_length = self.numerology.get_cp_samples(self.n_fft, symbol_idx)
    time_signal_with_cp = torch.cat([time_signal[-cp_length:], time_signal])
    
    <span class="hljs-keyword">return</span> time_signal_with_cp
</code></pre>
<h3 data-id="heading-11">ğŸš€ è‡ªåŠ¨æ±‚å¯¼ä¿¡é“ä¼°è®¡ (<code>src/channel_estimation.py</code>)</h3>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ ¸å¿ƒé€»è¾‘ï¼šåˆ©ç”¨ backward() è‡ªåŠ¨è®¡ç®— âˆ‚Loss/âˆ‚h</span>
<span class="hljs-attr">h_hat.requires_grad</span> = <span class="hljs-literal">True</span>  <span class="hljs-comment"># å‘Šè¯‰ PyTorch è¿½è¸ªæ¢¯åº¦</span>
â€‹
for i in range(n_iterations):
    <span class="hljs-attr">y_pred</span> = h_hat * x      <span class="hljs-comment"># å‰å‘ä¼ æ’­ (Forward)</span>
    <span class="hljs-attr">loss</span> = torch.mean(torch.abs(y - y_pred) ** <span class="hljs-number">2</span>) <span class="hljs-comment"># è®¡ç®— MSE</span>
    
    loss.backward()         <span class="hljs-comment"># åå‘ä¼ æ’­ (Backward) -&gt; è‡ªåŠ¨è®¡ç®— h_hat.grad</span>
    
    with torch.no_grad():   <span class="hljs-comment"># å‚æ•°æ›´æ–°</span>
        h_hat <span class="hljs-attr">-</span>= lr * h_hat.grad
    h_hat.grad.zero_()      <span class="hljs-comment"># æ¢¯åº¦æ¸…é›¶</span>
</code></pre>
<h2 data-id="heading-12">ğŸ¬ ä¸€é”®è¿è¡Œ</h2>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># å®‰è£…ä¾èµ–</span>
pip install -r requirements.txt
â€‹
<span class="hljs-comment"># --- é˜¶æ®µä¸€ï¼šOFDM ç³»ç»Ÿæ¼”ç¤º ---</span>
<span class="hljs-comment"># ç”Ÿæˆæ ‡å‡†æ˜Ÿåº§å›¾ã€é¢‘è°±å›¾ã€BER æ›²çº¿</span>
python examples/demo_nr_ofdm_ber.py
â€‹
<span class="hljs-comment"># --- é˜¶æ®µäºŒï¼šAutograd ä¿¡é“ä¼°è®¡ ---</span>
<span class="hljs-comment"># æ¼”ç¤ºæ¢¯åº¦ä¸‹é™åœ¨é€šä¿¡ä¸­çš„åº”ç”¨</span>
python src/channel_estimation.py
</code></pre>
<h3 data-id="heading-13">è¾“å‡ºé¢„è§ˆ</h3>
<pre><code class="hljs language-ini" lang="ini">============================================================
Stage 2: Autograd Channel Estimation <span class="hljs-attr">Demo</span>
============================================================
True channel <span class="hljs-attr">h</span> = (<span class="hljs-number">0.8000</span>+<span class="hljs-number">0.6000</span>j)
â€‹
--- SGD Optimizer ---
Iter   10: <span class="hljs-attr">Loss</span>=<span class="hljs-number">0.021901</span>, h_hat=<span class="hljs-number">0.7299</span>+<span class="hljs-number">0.5556</span>j
Iter   50: <span class="hljs-attr">Loss</span>=<span class="hljs-number">0.010527</span>, h_hat=<span class="hljs-number">0.8026</span>+<span class="hljs-number">0.6003</span>j
Final <span class="hljs-attr">h_hat</span> = <span class="hljs-number">0.8026</span>+<span class="hljs-number">0.6003</span>j, Error = <span class="hljs-number">0.0026</span>
</code></pre>
<h2 data-id="heading-14">ğŸ–¥ï¸ è¿è¡Œç¯å¢ƒ</h2>
<ul>
<li><strong>Python</strong>: 3.8+</li>
<li><strong>PyTorch</strong>: 1.10+ (æ¨è 2.0+)</li>
<li><strong>Matplotlib</strong>: ç”¨äºç»˜å›¾</li>
</ul>
<h2 data-id="heading-15">ğŸ›’ è·å–æ–¹å¼</h2>
<p>å…³æ³¨å…¬ä¼—å· <strong>ã€3GPP ä»¿çœŸå®éªŒå®¤ã€‘</strong>ï¼Œåå°å›å¤å…³é”®è¯ <strong>ã€Pytorchã€‘</strong> å³å¯è·å–å®Œæ•´å·¥ç¨‹ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/eced213a26334767aead708112b45f60~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgM0dQUOS7v-ecn-WunumqjOWupA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768633929&amp;x-signature=9wTq8g%2BsWLxbgUpCMaNpvC5m36c%3D" alt="constellation.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/23b9a3c03b9540f8bcf870c40e4e8cb9~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgM0dQUOS7v-ecn-WunumqjOWupA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768633929&amp;x-signature=qxi84v%2B861T3j5Oeqq0AYfid6Tc%3D" alt="all_constellations.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/738c1a9fcf4649b1a77b18d1e645964d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgM0dQUOS7v-ecn-WunumqjOWupA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768633929&amp;x-signature=yMg5jZwGnZaPAjdcqRlWzC2iqe4%3D" alt="ber_curve.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0a7ace5f8cfd44f199af1d4d4580f6ef~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgM0dQUOS7v-ecn-WunumqjOWupA==:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768633929&amp;x-signature=qv67rvif9CSfgdYZ7lFkij3PzIk%3D" alt="channel_estimation.png" loading="lazy"/></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¼€å‘ä¸€ä¸ªç¾è§‚çš„ VitePress å›¾ç‰‡é¢„è§ˆæ’ä»¶]]></title>    <link>https://juejin.cn/post/7593215107406266404</link>    <guid>https://juejin.cn/post/7593215107406266404</guid>    <pubDate>2026-01-10T07:32:50.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593215107406266404" data-draft-id="7593215107406233636" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¼€å‘ä¸€ä¸ªç¾è§‚çš„ VitePress å›¾ç‰‡é¢„è§ˆæ’ä»¶"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,VitePress"/> <meta itemprop="datePublished" content="2026-01-10T07:32:50.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç²¥é‡Œæœ‰å‹ºç³–"/> <meta itemprop="url" content="https://juejin.cn/user/1028798615918983"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¼€å‘ä¸€ä¸ªç¾è§‚çš„ VitePress å›¾ç‰‡é¢„è§ˆæ’ä»¶
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1028798615918983/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç²¥é‡Œæœ‰å‹ºç³–
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T07:32:50.000Z" title="Sat Jan 10 2026 07:32:50 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>ç¬”è€…ç»´æŠ¤çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Ftheme.sugarat.top%2F" target="_blank" title="https://theme.sugarat.top/" ref="nofollow noopener noreferrer">VitePress åšå®¢ä¸»é¢˜</a>å·²ç»é›†æˆäº†éå¸¸å¤šçš„åŠŸèƒ½ï¼Œä¸ºä¾¿äºåœ¨ä¸»é¢˜ä¹‹å¤–å¤ç”¨ï¼Œå› æ­¤æœ‰è®¡åˆ’å°†å…¶ä¸€éƒ¨åˆ†åŠŸèƒ½åˆ†ç¦»å‡ºæ¥ï¼Œå½¢æˆç‹¬ç«‹çš„æ’ä»¶ã€‚</p>
<p><em>ç°åœ¨åˆæœ‰AIåŠ æŒï¼Œå†å·²ç»æœ‰é€šç”¨æ’ä»¶æ¨¡æ¿å‰æä¸‹ï¼Œä½¿ç”¨AIå°±èƒ½å®Œæˆ95%çš„æ’ä»¶å·¥ä½œé‡ï¼</em></p>
<p>åˆ†ç¦»çš„ <a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fvitepress-plugin-image-preview" target="_blank" title="https://www.npmjs.com/package/vitepress-plugin-image-preview" ref="nofollow noopener noreferrer">å›¾ç‰‡é¢„è§ˆæ’ä»¶</a>ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5716412c82f34f9694069c8db798d097~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57Kl6YeM5pyJ5Yu657OW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768635170&amp;x-signature=PohUBeKkEL54FWb625e8R8nRL%2B0%3D" alt="" loading="lazy"/></p>
<p>ç»„ä»¶æ ·å¼å®ç°å‚è€ƒäº† <a href="https://link.juejin.cn?target=https%3A%2F%2Felement-plus.org%2Fzh-CN%2Fcomponent%2Fimage%23%25E5%259B%25BE%25E7%2589%2587%25E9%25A2%2584%25E8%25A7%2588" target="_blank" title="https://element-plus.org/zh-CN/component/image#%E5%9B%BE%E7%89%87%E9%A2%84%E8%A7%88" ref="nofollow noopener noreferrer">Element Plus Image Viewer</a></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4ba9582679804ff29a4d26bbbb40d39e~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57Kl6YeM5pyJ5Yu657OW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768635170&amp;x-signature=zfv4X7pXrzJB8Gflzwf9yvQGW0I%3D" alt="" loading="lazy"/></p>
<p>æ¥ä¸‹æ¥å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ç”¨æ³•ï¼Œå†å¿«é€Ÿè®²è§£æ ¸å¿ƒåŸç†ã€‚</p>
<p>æ’ä»¶å¼€å‘åŸºäºä¹‹å‰åˆ›å»ºçš„ä¸€ä¸ªé€šç”¨æ¨¡æ¿ï¼Œ<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FATQQ%2Fsugar-blog%2Ftree%2Fmaster%2Ftemplate%2Fvitepress-plugin-slot-inject-template" target="_blank" title="https://github.com/ATQQ/sugar-blog/tree/master/template/vitepress-plugin-slot-inject-template" ref="nofollow noopener noreferrer">vitepress-plugin-slot-inject-template</a>ï¼Œåœ¨æ¨¡æ¿çš„åŸºç¡€ä¸Šï¼Œ<strong>æ’ä»¶95%çš„ä»£ç ç”± Gemini 3.0 ç”Ÿæˆã€‚</strong></p>
<h2 data-id="heading-1">å¦‚ä½•ä½¿ç”¨</h2>
<p><em>åªéœ€è¦ 2 æ­¥ï¼š</em></p>
<ol>
<li>å®‰è£…æ’ä»¶</li>
</ol>
<pre><code class="hljs language-sh" lang="sh">pnpm add vitepress-plugin-image-preview
</code></pre>
<ol start="2">
<li>é…ç½®æ’ä»¶</li>
</ol>
<p>å¼•å…¥æ’ä»¶åœ¨ <code>.vitepress/config.mts</code> VitePress é…ç½®æ–‡ä»¶ä¸­</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vitepress'</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ImagePreviewPlugin</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'vitepress-plugin-image-preview'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
  <span class="hljs-attr">vite</span>: {
    <span class="hljs-attr">plugins</span>: [
      <span class="hljs-title class_">ImagePreviewPlugin</span>()
    ]
  }
})
</code></pre>
<h2 data-id="heading-2">å®ç°åŸç†</h2>
<p><em>è¿™é‡Œåªé˜è¿°å…³é”®ç‚¹ï¼Œç»†èŠ‚ä¸ä¹‹å‰çš„<a href="https://juejin.cn/post/7416625208766988324?searchId=20260110152755960C86037BF7AA755194" target="_blank" title="https://juejin.cn/post/7416625208766988324?searchId=20260110152755960C86037BF7AA755194">å…¬å‘Šæ’ä»¶</a>ç±»ä¼¼ï¼Œè¿™é‡Œä¸åšèµ˜è¿°ã€‚</em></p>
<p>VitePress é»˜è®¤ä¸»é¢˜ <code>Layout.vue</code> ç»„ä»¶é¢„è®¾çš„ä¸€äº›æ’æ§½ï¼Œåªéœ€å°†å®ç°è‡ªå®šä¹‰ç»„ä»¶æ³¨å…¥åˆ°å¯¹åº”æ’æ§½ä¸ºæ­¢å³å¯ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/369cfde9363a46bd88230c19463645a1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg57Kl6YeM5pyJ5Yu657OW:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768635170&amp;x-signature=g7If%2Fgct80uAmulWBK3fCHUZfCc%3D" alt="" loading="lazy"/></p>
<p>æ‰€æœ‰çš„ <code>slots</code> åœ¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fvitepress.dev%2Fguide%2Fextending-default-theme%23layout-slots" target="_blank" title="https://vitepress.dev/guide/extending-default-theme#layout-slots" ref="nofollow noopener noreferrer">VitePress æ–‡æ¡£é‡Œä¹Ÿæœ‰ä»‹ç»</a></p>
<h3 data-id="heading-3">æ³¨å…¥è‡ªå®šä¹‰ç»„ä»¶</h3>
<p>åˆ©ç”¨æ’ä»¶çš„ <code>transform</code> é’©å­ï¼Œå°†æˆ‘ä»¬çš„ <code>&lt;ImagePreview /&gt;</code> ç»„ä»¶æ’å…¥åˆ° <code>Layout.vue</code> çš„ç‰¹å®šæ’æ§½ä½ç½®</p>
<p>å›¾ç‰‡é¢„è§ˆç»„ä»¶æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ <code>doc-before</code> å’Œ <code>page-top</code> ä¸¤ä¸ªæ’æ§½ã€‚</p>
<p>ä½¿ç”¨ alias ä¿è¯å¼•å…¥ç»„ä»¶çš„è·¯å¾„æ­£ç¡®æ˜ å°„ã€‚</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-comment">// ä»…åŒ…å«å…³é”®ä»£ç </span>
<span class="hljs-keyword">const</span> componentName = <span class="hljs-string">'ImagePreview'</span>
<span class="hljs-keyword">const</span> componentFile = <span class="hljs-string">`<span class="hljs-subst">${componentName}</span>.vue`</span>
<span class="hljs-keyword">const</span> aliasComponentFile = <span class="hljs-string">`<span class="hljs-subst">${getDirname()}</span>/components/<span class="hljs-subst">${componentFile}</span>`</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ImagePreviewPlugin</span>(<span class="hljs-params">options = {}</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// æ·»åŠ alias</span>
    <span class="hljs-attr">config</span>: <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">resolve</span>: {
          <span class="hljs-attr">alias</span>: {
            [<span class="hljs-string">`./<span class="hljs-subst">${componentFile}</span>`</span>]: aliasComponentFile
          }
        }
      }
    },
    <span class="hljs-title function_">transform</span>(<span class="hljs-params">code, id</span>) {
      <span class="hljs-comment">// ç­›é€‰å‡º Layout.vue</span>
      <span class="hljs-keyword">if</span> (id.<span class="hljs-title function_">endsWith</span>(<span class="hljs-string">'vitepress/dist/client/theme-default/Layout.vue'</span>)) {
        <span class="hljs-keyword">let</span> transformResult = code

        <span class="hljs-comment">// æ’å…¥ç»„ä»¶</span>
        <span class="hljs-keyword">const</span> slots = [options.<span class="hljs-property">slots</span> || [<span class="hljs-string">'doc-before'</span>, <span class="hljs-string">'page-top'</span>]].<span class="hljs-title function_">flat</span>()
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> slot <span class="hljs-keyword">of</span> slots) {
          <span class="hljs-keyword">const</span> slotPosition = <span class="hljs-string">`&lt;slot name="<span class="hljs-subst">${slot}</span>" /&gt;`</span>
          <span class="hljs-comment">// æ·»åŠ  ClientOnly ç›®çš„æ˜¯é¿å…ç»„ä»¶åœ¨SSGçš„æ—¶å€™è¢«æ¸²æŸ“</span>
          transformResult = transformResult.<span class="hljs-title function_">replace</span>(slotPosition, <span class="hljs-string">`<span class="hljs-subst">${slotPosition}</span>\n&lt;ClientOnly&gt;&lt;<span class="hljs-subst">${componentName}</span> /&gt;&lt;/ClientOnly&gt;`</span>)
        }

        <span class="hljs-comment">// å¯¼å…¥ç»„ä»¶</span>
        <span class="hljs-keyword">const</span> setupPosition = <span class="hljs-string">'&lt;script setup lang="ts"&gt;'</span>
        transformResult = transformResult.<span class="hljs-title function_">replace</span>(setupPosition, <span class="hljs-string">`<span class="hljs-subst">${setupPosition}</span>\nimport <span class="hljs-subst">${componentName}</span> from './<span class="hljs-subst">${componentFile}</span>'`</span>)
        <span class="hljs-keyword">return</span> transformResult
      }
    },
  }
}
</code></pre>
<h3 data-id="heading-4">æ’ä»¶é…ç½®ä¼ é€’</h3>
<p>é‡‡ç”¨è™šæ‹Ÿæ¨¡å—çš„æ–¹å¼ä¼ é€’é…ç½®ã€‚</p>
<p>ç»„ä»¶ä¸­å¯¼å…¥é…ç½®ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">import</span> options <span class="hljs-keyword">from</span> <span class="hljs-string">'virtual:image-preview-options'</span>
</code></pre>
<p>æ’ä»¶ä¸­å¤„ç†è™šæ‹Ÿæ¨¡å—ï¼š</p>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-keyword">const</span> virtualModuleId = <span class="hljs-string">'virtual:image-preview-options'</span>
<span class="hljs-keyword">const</span> resolvedVirtualModuleId = <span class="hljs-string">`\0<span class="hljs-subst">${virtualModuleId}</span>`</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ImagePreviewPlugin</span>(<span class="hljs-params">options = {}</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-comment">// çœç•¥å…¶å®ƒæ— å…³ä»£ç ...</span>
    <span class="hljs-title function_">resolveId</span>(<span class="hljs-params">id</span>) {
      <span class="hljs-keyword">if</span> (id === virtualModuleId) {
        <span class="hljs-keyword">return</span> resolvedVirtualModuleId
      }
    },
    <span class="hljs-title function_">load</span>(<span class="hljs-params"><span class="hljs-variable language_">this</span>, id</span>) {
      <span class="hljs-keyword">if</span> (id === resolvedVirtualModuleId) {
        <span class="hljs-keyword">return</span> <span class="hljs-string">`export default <span class="hljs-subst">${stringify(options)}</span>`</span>
      }
    },
  }
}
</code></pre>
<h3 data-id="heading-5">æ ¸å¿ƒäº¤äº’å®ç°</h3>
<p>å›¾ç‰‡é¢„è§ˆçš„æ ¸å¿ƒé€»è¾‘åœ¨äºç›‘å¬å›¾ç‰‡çš„ç‚¹å‡»äº‹ä»¶ï¼Œè·å–å›¾ç‰‡åˆ—è¡¨ï¼Œå¹¶æ˜¾ç¤ºé¢„è§ˆé®ç½©ã€‚</p>
<ol>
<li><strong>äº‹ä»¶ç›‘å¬</strong>ï¼šåœ¨ <code>onMounted</code>æ—¶ï¼Œç»™å†…å®¹çš„å®¹å™¨æ³¨å†Œç‚¹å‡»äº‹ä»¶ï¼Œåœ¨ç‚¹å‡»çš„æ—¶å€™è·å–å®¹å™¨ä¸­æ‰€æœ‰çš„å›¾ç‰‡å…ƒç´ ï¼Œç„¶ååšåç»­æ“ä½œã€‚</li>
</ol>
<pre><code class="hljs language-ts" lang="ts"><span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> wrapperId = imagePreviewOptions?.<span class="hljs-property">wrapperId</span> || <span class="hljs-string">'#VPContent'</span>
  <span class="hljs-keyword">const</span> docDomContainer = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(wrapperId)
  docDomContainer?.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, previewImage)
})

<span class="hljs-keyword">function</span> <span class="hljs-title function_">previewImage</span>(<span class="hljs-params">e: Event</span>) {
  <span class="hljs-keyword">const</span> target = e.<span class="hljs-property">target</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>
  <span class="hljs-keyword">const</span> currentTarget = e.<span class="hljs-property">currentTarget</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLElement</span>
  <span class="hljs-keyword">if</span> (target.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toLowerCase</span>() === <span class="hljs-string">'img'</span>) {
    <span class="hljs-keyword">const</span> selector = imagePreviewOptions?.<span class="hljs-property">selector</span> || <span class="hljs-string">'.content-container .main img,.VPPage img'</span>
    <span class="hljs-keyword">const</span> imgs = currentTarget.<span class="hljs-property">querySelectorAll</span>&lt;<span class="hljs-title class_">HTMLImageElement</span>&gt;(selector)
    <span class="hljs-keyword">const</span> idx = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(imgs).<span class="hljs-title function_">findIndex</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> el === target)
    <span class="hljs-keyword">const</span> urls = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(imgs).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> el.<span class="hljs-property">src</span>)
    <span class="hljs-comment">// çœç•¥å…¶å®ƒé€»è¾‘</span>
  }
}
</code></pre>
<ol start="2">
<li><strong>é¢„è§ˆç»„ä»¶</strong>ï¼šå‚è€ƒäº† <a href="https://link.juejin.cn?target=https%3A%2F%2Felement-plus.org%2Fzh-CN%2Fcomponent%2Fimage%23%25E5%259B%25BE%25E7%2589%2587%25E9%25A2%2584%25E8%25A7%2588" target="_blank" title="https://element-plus.org/zh-CN/component/image#%E5%9B%BE%E7%89%87%E9%A2%84%E8%A7%88" ref="nofollow noopener noreferrer">Element Plus çš„ å›¾ç‰‡é¢„è§ˆç»„ä»¶</a>çš„æ ·å¼ä¸åŠŸèƒ½ï¼Œè¿™éƒ¨åˆ†å®Œå…¨ç”± AI å®ç°(Gemini 3.0)ï¼Œè¿˜åŸåº¦éå¸¸é«˜ã€‚</li>
</ol>
<h2 data-id="heading-6">æ’ä»¶æ¨¡æ¿ä»‹ç»</h2>
<p>åœ¨å¼€å‘æ’ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œç¬”è€…æŠŠæ­¤ç±»åŸºäº slot ä½ç½®æ³¨å…¥çš„æ’ä»¶åˆ†ç¦»äº†ä¸€ä¸ªæ¨¡æ¿ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FATQQ%2Fsugar-blog%2Ftree%2Fmaster%2Ftemplate%2Fvitepress-plugin-slot-inject-template" target="_blank" title="https://github.com/ATQQ/sugar-blog/tree/master/template/vitepress-plugin-slot-inject-template" ref="nofollow noopener noreferrer">vitepress-plugin-slot-inject-template</a></p>
<p>æœ‰ç›¸å…³è¯‰æ±‚çš„æœ‹å‹ï¼Œå¯ä»¥åŸºäºæ­¤æ¨¡æ¿ï¼Œé…åˆ AI å¿«é€Ÿçš„å¼€å‘å„ç§åŸºäºæ’æ§½å°±å¯ä»¥å®ç°çš„ç»„ä»¶èƒ½åŠ›ã€‚</p>
<h2 data-id="heading-7">æœ€å</h2>
<p>æ’ä»¶å®Œæ•´æºç  <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FATQQ%2Fsugar-blog%2Ftree%2Fmaster%2Fpackages%2Fvitepress-plugin-image-preview" target="_blank" title="https://github.com/ATQQ/sugar-blog/tree/master/packages/vitepress-plugin-image-preview" ref="nofollow noopener noreferrer">vitepress-plugin-image-preview</a></p>
<p><strong>æœ€åå†æ„Ÿå¹ä¸€å¥ï¼ŒAI å¤ªç‰›é€¼äº†ï¼Œæ•ˆç‡èµ·é£ã€‚</strong></p>
<p><em>æ¬¢è¿è¯„è®ºåŒºäº¤æµ&amp;æŒ‡å¯¼ã€‚</em></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å°ç¨‹åºä¸Šçº¿åŠå¹´æˆ‘èµšäº†å¤šå°‘é’±ï¼Ÿ]]></title>    <link>https://juejin.cn/post/7593338828196626472</link>    <guid>https://juejin.cn/post/7593338828196626472</guid>    <pubDate>2026-01-10T07:17:26.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593338828196626472" data-draft-id="7593338828196560936" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å°ç¨‹åºä¸Šçº¿åŠå¹´æˆ‘èµšäº†å¤šå°‘é’±ï¼Ÿ"/> <meta itemprop="keywords" content="å¾®ä¿¡å°ç¨‹åº,äº§å“,åˆ›ä¸š"/> <meta itemprop="datePublished" content="2026-01-10T07:17:26.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="æ˜¯æ±Ÿè¿ªå‘€"/> <meta itemprop="url" content="https://juejin.cn/user/4468854131529624"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å°ç¨‹åºä¸Šçº¿åŠå¹´æˆ‘èµšäº†å¤šå°‘é’±ï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4468854131529624/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    æ˜¯æ±Ÿè¿ªå‘€
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T07:17:26.000Z" title="Sat Jan 10 2026 07:17:26 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">1.  å¼€å‘å†ç¨‹</h2>
<p>æ—¶é—´è¿‡å¾—çœŸå¿«ï¼Œè½¬çœ¼é—´ç¦çŒªè®°è´¦å°ç¨‹åºä¸Šçº¿å·²ç»æœ‰åŠå¹´æ—¶é—´äº†ï¼Œä»v1.0.0 ç‰ˆæœ¬åšåˆ°äº† v1.6.1 ç‰ˆæœ¬ã€‚ä»Šå¤©æ•´ç†äº†å¼€å‘æ—¥å¿—ï¼ŒçœŸçš„ä¸æ•¢ç›¸ä¿¡è‡ªå·±åœ¨å·¥ä½œä¹‹ä½™èƒ½å¤ŸæŠŠå®ƒåšå‡ºæ¥å¹¶ä¸Šçº¿ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4481b17d01fd4fde8ae549bf7dbde51f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5rGf6L-q5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634245&amp;x-signature=GytMq8NGwZ8YIPQMv35X2cKeqMc%3D" alt="2026-01-10-14-22-50.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a6df6d61fc874a2e8c418ac0735d0e54~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5rGf6L-q5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634245&amp;x-signature=WRZdXBpYzhCUSudb6RS4GkXMa%2B4%3D" alt="2026-01-10-14-23-15.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bc19b58cd0d44e46a135776fc3dae679~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5rGf6L-q5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634245&amp;x-signature=DHGOSISxo3cK4Spj2a8obB7UH9Y%3D" alt="2026-01-10-14-23-23.png" loading="lazy"/></p>
<h2 data-id="heading-1">2.ç”¨æˆ·ç§¯ç´¯</h2>
<p>åˆ°ç›®å‰2026å¹´1æœˆ10æ—¥ä¸ºæ­¢ï¼Œå·²ç»ç§¯ç´¯äº†872ä½ç”¨æˆ·ï¼Œæ„Ÿè°¢ä½ ä»¬çš„ä½¿ç”¨å’Œæ”¯æŒï¼</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bd97bec4dcb34fc1b42fe923506f6d88~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5rGf6L-q5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634245&amp;x-signature=WEB%2BY%2BGo7JI1JjH0iuhHd855dXg%3D" alt="2026-01-10-14-23-32.png" loading="lazy"/></p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77f3ef7ace934209abcaa97ba6a419e8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5rGf6L-q5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634245&amp;x-signature=5qfvFySWfbX8%2B4Kedcs1GnQUSmo%3D" alt="2026-01-10-14-23-42.png" loading="lazy"/></p>
<p>æˆ‘åœ¨å°ç¨‹åºä¸Šçº¿åä¹Ÿæ²¡æ€ä¹ˆå®£ä¼ ï¼Œåªå†™äº†ä¸€ç¯‡å…¬ä¼—å·æœ‰1200å¤šæµè§ˆé‡ï¼Œç„¶åå…¨é è‡ªç„¶æµé‡ã€‚è™½ç„¶ç”¨æˆ·å¢é•¿æ•°æ®å¯è§‚ï¼Œä½†æ˜¯ç•™å­˜æ•°æ®ä¸å®¹ä¹è§‚ï¼Œä»ä¹‹å‰çš„æ—¥æ´»ï¼š70å¤šäººåˆ°ç°åœ¨ç¨³å®šåœ¨10å‡ äººã€‚è¿™ä¹Ÿè®©æˆ‘æ€€ç–‘æ˜¯ä¸æ˜¯æˆ‘åšçš„ä¸œè¥¿ä¸å¥½ç”¨ï¼Œå¸®åŠ©ä¸äº†ç”¨æˆ·ï¼Œä¸ºäº†
é˜²æ­¢é—­é—¨é€ è½¦
æˆ‘ä¼šç§¯æå¬å–èº«è¾¹æœ‹å‹å’Œç”¨æˆ·çš„åé¦ˆå’Œå»ºè®®ï¼Œä½œå‡ºè°ƒæ•´ä¼˜åŒ–ï¼Œ
è®©å®ƒè¶Šæ¥è¶Šå¥½
ã€‚
æ— è®ºæœªæ¥å¦‚ä½•ï¼Œè¿™ä¸ªé¡¹ç›®æˆ‘ä¼šä¸€ç›´æ›´æ–°è¿­ä»£ä¸‹å»ï¼Œ
æœåŠ¡æ›´å¤šçš„ç”¨æˆ·ï¼Œå®ƒæ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªå®Œæ•´çš„ä½œå“ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æˆ‘è¿ˆå‡ºç‹¬ç«‹å¼€å‘çš„ç¬¬ä¸€æ­¥ï¼æˆ‘ä¸€å®šä¼šè®¤çœŸå¯¹å¾…ã€‚</p>
<h2 data-id="heading-2">3.  æ”¶ç›Š</h2>
<p>ç›®å‰æ”¶ç›Šé€”å¾„ä»…æœ‰æµé‡ä¸»ï¼ŒåŠŸèƒ½å…¨éƒ¨æ˜¯å…è´¹çš„ã€‚ä¸ºäº†ä¸å½±å“ç”¨æˆ·çš„ä½“éªŒåœ¨æµé‡ä¸»å¼€é€šåï¼Œæˆ‘åªå¼•å…¥äº†å¼€å±å¹¿å‘Šã€‚ç›®å‰æµé‡ä¸»å¼€é€šäº†3ä¸ªæœˆï¼Œä¸€å…±æ”¶å…¥69.32ã€‚å¹³å‡æ¯å¤©æ˜¯0.4å·¦å³ï¼Œæ”¶ç›Šç­‰äºæ²¡æœ‰ï¼Œå“ˆå“ˆã€‚æ²¡æœ‰æ”¶ç›Šçš„è½¯ä»¶å¦‚åŒæ— æºä¹‹æ°´ï¼Œæ— æ ¹ä¹‹æœ¨ï¼Œæ˜¯ä¸é•¿ä¹…çš„ï¼Œä¹Ÿå®¹æ˜“è®©ç”¨æˆ·äº§ç”Ÿæˆ‘ä¼šéšæ—¶è·‘è·¯çš„æ‹…å¿§ï¼Œæˆ‘çš„è®¡åˆ’æ˜¯ç­‰æˆ‘æŠŠç¦çŒªè®°è´¦åšå¾—æ›´å®Œæ•´æ›´å¥½çš„æ—¶å€™ï¼Œå†æ¨å‡ºVIPåŠŸèƒ½ã€‚</p>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/e4132df94c514f96971c1077fe8a346b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5piv5rGf6L-q5ZGA:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768634245&amp;x-signature=7ueG3LtfKdrzz8SG4WtczDrqvbw%3D" alt="2026-01-10-14-24-02.png" loading="lazy"/></p>
<h2 data-id="heading-3">4.æ„Ÿæ‚Ÿ</h2>
<p>å¼€å‘ç¦çŒªè®°è´¦æ˜¯æˆ‘è¿ˆå‘ç‹¬ç«‹å¼€å‘çš„ç¬¬ä¸€æ­¥ï¼Œè®©æˆ‘æ„è¯†åˆ°åšdemoå’Œåšäº§å“æœ‰ç€äº‘æ³¥ä¹‹åˆ«ã€‚ä»èƒ½çœ‹çš„demoï¼Œåšåˆ°èƒ½ç”¨ï¼Œå†ä»èƒ½ç”¨åšåˆ°å¥½ç”¨ï¼Œæ˜¯éœ€è¦åŠ¨è„‘å­ï¼Œä¸‹åŠŸå¤«çš„ã€‚éœ€è¦è€ƒè™‘å¾ˆå¤šä¸œè¥¿æ¯”å¦‚UIè®¾è®¡ã€ç”¨æˆ·ä½“éªŒã€ç”¨æˆ·å¼•å¯¼ã€åŠŸèƒ½æµ‹è¯•ç­‰ç­‰ã€‚çœ¼é«˜æ‰‹ä½æ˜¯æˆ‘å¸¸çŠ¯çš„ä¸€ä¸ªé”™è¯¯ï¼Œä¹Ÿæ˜¯æˆ‘è¦å°½å¿«å…‹æœçš„æ¯›ç—…ï¼Œé¿å…å®Œç¾ä¸»ä¹‰ï¼Œå®Œç¾çš„å‰ææ˜¯å®Œæˆã€‚</p>
<p>åšç‹¬ç«‹å¼€å‘ï¼Œè¦ç¼©å°ç¨‹åºå‘˜æ€ç»´å çš„ä½ç½®ï¼Œè¦å°†äº§å“æ€ç»´ã€è¿è¥æ€ç»´åŠ å…¥è¿›æ¥ã€‚åœ¨å…¬å¸ä¸Šç­ï¼Œä½ åªéœ€è¦å…³æ³¨ä½ çš„ä¸€äº©ä¸‰åˆ†åœ°å³å¯ï¼ŒåŠŸèƒ½å®ç°äº†æ²¡é—®é¢˜ä½ å°±å¯ä»¥ç‚¹æ¯å’–å•¡å¼€å§‹åˆ’æ°´äº†ã€‚ä½†æ˜¯ç‹¬ç«‹å¼€å‘ä¸è¡Œï¼Œä½ è¦æ—¢å½“çˆ¹åˆå½“å¦ˆï¼Œä¸è¦å¤ªè¿‡äºæ³¨é‡ä»£ç å†™çš„æ˜¯å¦ç¾è§‚ã€å¥å£®ï¼Œä¹Ÿä¸è¦ä¸Šæ¥å°±ç”¨è¿™ä¸ªæ¡†æ¶ã€é‚£ä¸ªæŠ€æœ¯ã€è®¾è®¡æ¨¡å¼ã€ç®—æ³•å’”å’”ä¸€é€šä¹±æ•´ã€‚å‰æœŸä¸€å®šè¦é¿å…è¿™æ ·ï¼Œä¸ç„¶ç²¾åŠ›å¾ˆå¿«å°±ä¼šè¢«è€—å°½ï¼Œä½ éœ€è¦è€ƒè™‘çš„æ˜¯ä»€ä¹ˆå¯ä»¥è®©ä½ çš„åŠŸèƒ½å¿«é€Ÿå®ç°å¹¶ä¸Šçº¿ï¼åˆ«ç®¡ç™½çŒ«é»‘çŒ«é€®åˆ°è€—å­å°±æ˜¯å¥½çŒ«ã€‚</p>
<p>AIçœŸçš„æ”¹å˜äº†æˆ‘ä»¬çš„å¼€å‘æ¨¡å¼ï¼Œå®ƒå¸®æˆ‘èŠ‚çœäº†å¤§é‡å¼€å‘çš„æ—¶é—´ï¼Œæˆ‘ä»¬åº”è¯¥ç§¯ææ‹¥æŠ±è¿™ç§å˜åŒ–ã€‚æˆ‘æ•¢è¯´å¦‚æœæ²¡æœ‰AIçš„ååŠ©ï¼Œæˆ‘è¿™ä¸ªé¡¹ç›®è‡³å°‘è¦åŒå€çš„æ—¶é—´æ¥å®Œæˆï¼Œç”šè‡³å®Œä¸æˆï¼ä½†æ˜¯ä¹Ÿä¸åƒç½‘ä¸Šè¯´çš„é‚£æ ·ç¦»è°±ï¼Œä¸€å¥è¯AIå°±å¯ä»¥ç»™ä½ åšå‡ºä¸€æ¬¾APPï¼Œé‚£ä¸ç°å®ï¼Œå³ä½¿åšå‡ºæ¥ä¹Ÿå­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œéœ€è¦å¤§é‡æ—¶é—´è°ƒæ•´ä¿®å¤ã€‚é€šè¿‡è¿™æ®µæ—¶é—´å’ŒAIåä½œå¼€å‘ï¼Œæˆ‘å‘ç°AIçš„èƒ½åŠ›çš„å¤©èŠ±æ¿å…¶æ˜¯ä½ ä¸ªäººèƒ½åŠ›çš„å¤©èŠ±æ¿ï¼Œä½ å¼ºAIå°±å¼ºï¼Œä½ å°±åƒæ˜¯ä¸€ä¸ªæŒ‡æŒ¥å®˜ï¼ŒAIå¸®ä½ å¹²æ´»ï¼Œä½†æ˜¯å¦‚æœä½ èƒ½åŠ›ä¸è¡Œä¸“ä¸šçŸ¥è¯†ä¸å¤Ÿï¼ŒçæŒ‡æŒ¥ï¼ŒAIä¹Ÿå˜å¾—å‚»ä¹ä¹çš„ï¼Œå®ƒåšä¸å‡ºæ¥ä½ è„‘å­é‡Œé¢æ²¡æœ‰ä¸œè¥¿ï¼åœ¨AIè¿…é€Ÿå‘å±•çš„æ—¶ä»£ï¼Œæˆ‘åº”è¯¥ç€é‡åŸ¹å…»è‡ªå·±çš„æ€ç»´èƒ½åŠ›ï¼šä»£ç æ€ç»´ã€äº§å“æ€ç»´ã€‚æˆ‘è®°å¾—ä¸€å¥è¯æ˜¯è¿™æ ·è¯´çš„ï¼šä»£ç æ˜¯åœ¨ä½ è„‘æµ·ä¸­å½¢æˆçš„ï¼Œåªè¦æ€è·¯æ­£ç¡®ï¼Œå†™ä»£ç åªæ˜¯ä¸€ä¸ªå †ç Œçš„è¿‡ç¨‹ã€‚ç°åœ¨AIå¸®æˆ‘åšäº†å†™ä»£ç è¿™ä¸€æ­¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åº”è¯¥å­¦ä¼šå¦‚ä½•å°†è„‘æµ·ä¸­çš„æ€ç»´æ¸…æ™°çš„è¡¨è¿°å‡ºæ¥ï¼Œè®©AIå¬å¾—æ‡‚ï¼Œå¹¶ä¸”æŒ‰ç…§æˆ‘ä»¬çš„æ€è·¯å»åšã€‚</p>
<p>æœ€é‡è¦çš„æ°¸è¿œåœ¨æœ€åï¼šäº§å“å®šä½å’Œè¿è¥å®£ä¼ ï¼Œä½ ä¸œè¥¿åšçš„å†å¥½æ²¡äººçŸ¥é“ä¹Ÿæ˜¯ä¸è¡Œçš„ã€‚äº§å“å®šä½å¾ˆé‡è¦ï¼Œå¦‚æœä½ é€‰æ‹©çš„æ˜¯çº¢æµ·é¢†åŸŸæ¯”å¦‚è®°è´¦ï¼Œè¿™ä¸ªç±»å‹çš„åº”ç”¨éšä¾¿ä¸€æœç´¢å°±ä¸ä¸‹10å‡ 20ä¸ªï¼Œè¦ä»å¤´éƒ¨appä¸­æŠ¢æµé‡è¿™å¤ªéš¾äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å†ä»”ç»†æƒ³ä¸€ä¸ªé—®é¢˜ï¼šä¸ºä»€ä¹ˆè®°è´¦appå·²ç»é‚£ä¹ˆå¤šäº†ï¼Œå¶å°”è¿˜æ˜¯ä¼šå‡ºç°ä¸€ä¸¤æ¬¾è®°è´¦è½¯ä»¶å‘¢ï¼Ÿæˆ‘çš„ç­”æ¡ˆæ˜¯ï¼šæ²¡æœ‰ä¸€æ¬¾è½¯ä»¶å¯ä»¥æ»¡è¶³æ‰€æœ‰ç”¨æˆ·çš„éœ€æ±‚ï¼æ¯”å¦‚æˆ‘å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼Œæˆ‘ç›¸ä¿¡è‚¯å®šä¹Ÿæœ‰å…¶ä»–äººå’Œæˆ‘ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘è¦åšåˆ°å·®å¼‚åŒ–ï¼Œå¦‚æœåªæ˜¯æƒ³å¤åˆ»åˆ«äººäº§å“é‚£æ˜¯è¡Œä¸é€šçš„ï¼Œå·®å¼‚åŒ–å¯ä»¥æ˜¯åŠŸèƒ½ã€UIã€äº¤äº’ã€‚é¿å…å¤§è€Œå…¨ï¼Œä¸“æ³¨å°è€Œç¾ï¼Œèšç„¦æŸä¸€ç±»ç‰¹å®šçš„ç”¨æˆ·éœ€æ±‚ï¼Œæ‰æ˜¯ç ´å±€ä¹‹é“ã€‚è‡³äºå®£ä¼ ï¼Œæ²¡æœ‰é’±æ¥æŠ•å¹¿å‘Šé‚£å°±é è‡ªå·±ï¼Œé™¤äº†åœ¨å„å¤§å¹³å°å‘æ–‡ç« å®£ä¼ æ–¹å¼å¤–åˆ«æ— ä»–æ³•ï¼Œè¿™ç§å†·å¯åŠ¨å®æ˜¯æ— å¥ˆä¹‹ä¸¾ï¼Œè¿™ä¹Ÿæ›´åŠ ä½“ç°äº†æ‰“é€ ä¸ªäººIPçš„é‡è¦æ€§ã€‚</p>
<p>ç‹¬ç«‹å¼€å‘æ˜¯ä¸€æ¡å¤œè·¯ï¼Œæ²¡æœ‰ç›®æ ‡ã€æ²¡æœ‰ç»ˆç‚¹ï¼Œä¸€åˆ‡éƒ½æ˜¯æœªçŸ¥æ•°ï¼Œä½†æ˜¯æˆ‘å–œæ¬¢æœªçŸ¥æ•°ï¼Œè¿™è¡¨ç¤ºæˆ‘çš„ç”Ÿæ´»æœ‰ç€æ— é™çš„å¯èƒ½ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[webpack/viteé…ç½®]]></title>    <link>https://juejin.cn/post/7593215107406250020</link>    <guid>https://juejin.cn/post/7593215107406250020</guid>    <pubDate>2026-01-10T07:28:29.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593215107406250020" data-draft-id="7593145583348940842" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="webpack/viteé…ç½®"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-10T07:28:29.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸åŠ¡æ­£ä¸šçš„å‰ç«¯å­¦å¾’"/> <meta itemprop="url" content="https://juejin.cn/user/1640911047494430"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            webpack/viteé…ç½®
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1640911047494430/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸åŠ¡æ­£ä¸šçš„å‰ç«¯å­¦å¾’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T07:28:29.000Z" title="Sat Jan 10 2026 07:28:29 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h3 data-id="heading-0">webpacké…ç½®</h3>
<p><strong>webpack.base.cjs</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¯¼å…¥ Node.js å†…ç½®çš„ path æ¨¡å—ï¼Œç”¨äºå¤„ç†æ–‡ä»¶è·¯å¾„</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-comment">// å¯¼å…¥ vue-loader æ’ä»¶ï¼Œç”¨äºå¤„ç† .vue æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">VueLoaderPlugin</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'vue-loader'</span>);
<span class="hljs-comment">// å¯¼å…¥ HtmlWebpackPluginï¼Œç”¨äºç”Ÿæˆ HTML æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'html-webpack-plugin'</span>);
<span class="hljs-comment">// å¯¼å…¥ unplugin-auto-import çš„ webpack ç‰ˆæœ¬ï¼Œç”¨äºè‡ªåŠ¨å¯¼å…¥ Vue ç»„åˆå¼ API</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">AutoImport</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'unplugin-auto-import/webpack'</span>);
<span class="hljs-comment">// å¯¼å…¥ unplugin-vue-components çš„ webpack ç‰ˆæœ¬ï¼Œç”¨äºè‡ªåŠ¨å¯¼å…¥ Vue ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Components</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'unplugin-vue-components/webpack'</span>);
<span class="hljs-comment">// å¯¼å…¥ ElementPlusResolverï¼Œç”¨äºè‡ªåŠ¨å¯¼å…¥ Element Plus ç»„ä»¶å’Œæ ·å¼</span>
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">ElementPlusResolver</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'unplugin-vue-components/resolvers'</span>);

<span class="hljs-comment">// å¯¼å‡º webpack é…ç½®å¯¹è±¡</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
    <span class="hljs-comment">// å…¥å£æ–‡ä»¶é…ç½®</span>
    <span class="hljs-attr">entry</span>: <span class="hljs-string">'./src/main.ts'</span>,

    <span class="hljs-comment">// è¾“å‡ºé…ç½®</span>
    <span class="hljs-attr">output</span>: {
        <span class="hljs-comment">// è¾“å‡ºç›®å½•ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„</span>
        <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'dist'</span>),
    },

    <span class="hljs-comment">// è§£æé…ç½®</span>
    <span class="hljs-attr">resolve</span>: {
        <span class="hljs-comment">// è·¯å¾„åˆ«åé…ç½®</span>
        <span class="hljs-attr">alias</span>: {
            <span class="hljs-comment">// å°† @ åˆ«åæŒ‡å‘ src ç›®å½•</span>
            <span class="hljs-string">'@'</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'src'</span>),
        },
        <span class="hljs-comment">// è‡ªåŠ¨è§£æçš„æ‰©å±•ååˆ—è¡¨ï¼Œè¿™æ ·å¯¼å…¥æ—¶å¯ä»¥çœç•¥æ‰©å±•å</span>
        <span class="hljs-attr">extensions</span>: [<span class="hljs-string">'.ts'</span>, <span class="hljs-string">'.tsx'</span>, <span class="hljs-string">'.js'</span>, <span class="hljs-string">'.jsx'</span>, <span class="hljs-string">'.vue'</span>, <span class="hljs-string">'.json'</span>],
    },

    <span class="hljs-comment">// æ’ä»¶é…ç½®</span>
    <span class="hljs-attr">plugins</span>: [
        <span class="hljs-comment">// è‡ªåŠ¨å¯¼å…¥é…ç½®</span>
        <span class="hljs-title class_">AutoImport</span>({
            <span class="hljs-comment">// è§£æå™¨é…ç½®ï¼Œä½¿ç”¨ ElementPlusResolver è‡ªåŠ¨å¯¼å…¥ Element Plus</span>
            <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],
        }),
        <span class="hljs-comment">// è‡ªåŠ¨ç»„ä»¶å¯¼å…¥é…ç½®</span>
        <span class="hljs-title class_">Components</span>({
            <span class="hljs-comment">// è§£æå™¨é…ç½®ï¼Œä½¿ç”¨ ElementPlusResolver è‡ªåŠ¨å¯¼å…¥ Element Plus ç»„ä»¶</span>
            <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],
        }),
        <span class="hljs-comment">// VueLoaderPlugin å¿…é¡»é…ç½®ï¼Œç”¨äºç¼–è¯‘ Vue å•æ–‡ä»¶ç»„ä»¶</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">VueLoaderPlugin</span>(),
        <span class="hljs-comment">// HtmlWebpackPlugin é…ç½®ï¼Œç”¨äºç”Ÿæˆ HTML æ–‡ä»¶</span>
        <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>({
            <span class="hljs-comment">// ä½¿ç”¨ public/index.html ä½œä¸ºæ¨¡æ¿</span>
            <span class="hljs-attr">template</span>: <span class="hljs-string">'./public/index.html'</span>,
        }),
    ],

    <span class="hljs-comment">// æ¨¡å—é…ç½®</span>
    <span class="hljs-attr">module</span>: {
        <span class="hljs-comment">// è§„åˆ™é…ç½®ï¼Œç”¨äºå¤„ç†ä¸åŒç±»å‹çš„æ–‡ä»¶</span>
        <span class="hljs-attr">rules</span>: [
            <span class="hljs-comment">// å¤„ç† .vue æ–‡ä»¶çš„è§„åˆ™</span>
            {
                <span class="hljs-comment">// åŒ¹é… .vue æ–‡ä»¶</span>
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.vue$/</span>,
                <span class="hljs-comment">// ä½¿ç”¨ vue-loader å¤„ç†</span>
                <span class="hljs-attr">loader</span>: <span class="hljs-string">'vue-loader'</span>,
                <span class="hljs-comment">// vue-loader é€‰é¡¹é…ç½®</span>
                <span class="hljs-attr">options</span>: {
                    <span class="hljs-comment">// ç¼–è¯‘å™¨é€‰é¡¹</span>
                    <span class="hljs-attr">compilerOptions</span>: {
                        <span class="hljs-comment">// ä¸ä¿ç•™ç©ºæ ¼ï¼Œå‡å°æ–‡ä»¶ä½“ç§¯</span>
                        <span class="hljs-attr">preserveWhitespace</span>: <span class="hljs-literal">false</span>,
                    },
                },
            },
            <span class="hljs-comment">// å¤„ç† .ts æ–‡ä»¶çš„è§„åˆ™</span>
            {
                <span class="hljs-comment">// åŒ¹é… .ts æ–‡ä»¶</span>
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.ts$/</span>,
                <span class="hljs-comment">// æ’é™¤ node_modules ç›®å½•</span>
                <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,
                <span class="hljs-comment">// ä½¿ç”¨å¤šä¸ª loader å¤„ç†</span>
                <span class="hljs-attr">use</span>: [
                    <span class="hljs-comment">// é¦–å…ˆä½¿ç”¨ babel-loader å¤„ç†</span>
                    {
                        <span class="hljs-attr">loader</span>: <span class="hljs-string">'babel-loader'</span>,
                        <span class="hljs-comment">// babel-loader é€‰é¡¹</span>
                        <span class="hljs-attr">options</span>: {
                            <span class="hljs-comment">// ä½¿ç”¨ @babel/preset-env é¢„è®¾ï¼Œå°† ES6+ è½¬æ¢ä¸º ES5</span>
                            <span class="hljs-attr">presets</span>: [<span class="hljs-string">'@babel/preset-env'</span>],
                            <span class="hljs-comment">// ä½¿ç”¨ @babel/plugin-transform-runtime æ’ä»¶ï¼Œé¿å…é‡å¤æ³¨å…¥ helper å‡½æ•°</span>
                            <span class="hljs-attr">plugins</span>: [<span class="hljs-string">'@babel/plugin-transform-runtime'</span>],
                        },
                    },
                    <span class="hljs-comment">// ç„¶åä½¿ç”¨ ts-loader å¤„ç†</span>
                    {
                        <span class="hljs-attr">loader</span>: <span class="hljs-string">'ts-loader'</span>,
                        <span class="hljs-comment">// ts-loader é€‰é¡¹</span>
                        <span class="hljs-attr">options</span>: {
                            <span class="hljs-comment">// ä¸º .vue æ–‡ä»¶æ·»åŠ  .ts åç¼€ï¼Œä»¥ä¾¿ ts-loader å¤„ç†</span>
                            <span class="hljs-attr">appendTsSuffixTo</span>: [<span class="hljs-regexp">/\.vue$/</span>],
                            <span class="hljs-comment">// åªè¿›è¡Œè½¬è¯‘ï¼Œä¸è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œæé«˜æ„å»ºé€Ÿåº¦</span>
                            <span class="hljs-attr">transpileOnly</span>: <span class="hljs-literal">true</span>,
                        },
                    },
                ],
            },
            <span class="hljs-comment">// å¤„ç† .js æ–‡ä»¶çš„è§„åˆ™</span>
            {
                <span class="hljs-comment">// åŒ¹é… .js æ–‡ä»¶</span>
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js$/</span>,
                <span class="hljs-comment">// æ’é™¤ node_modules ç›®å½•</span>
                <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,
                <span class="hljs-comment">// ä½¿ç”¨ babel-loader å¤„ç†</span>
                <span class="hljs-attr">use</span>: {
                    <span class="hljs-attr">loader</span>: <span class="hljs-string">'babel-loader'</span>,
                    <span class="hljs-comment">// babel-loader é€‰é¡¹</span>
                    <span class="hljs-attr">options</span>: {
                        <span class="hljs-comment">// ä½¿ç”¨ @babel/preset-env é¢„è®¾ï¼Œå°† ES6+ è½¬æ¢ä¸º ES5</span>
                        <span class="hljs-attr">presets</span>: [<span class="hljs-string">'@babel/preset-env'</span>],
                        <span class="hljs-comment">// ä½¿ç”¨ @babel/plugin-transform-runtime æ’ä»¶ï¼Œé¿å…é‡å¤æ³¨å…¥ helper å‡½æ•°</span>
                        <span class="hljs-attr">plugins</span>: [<span class="hljs-string">'@babel/plugin-transform-runtime'</span>],
                    },
                },
            },
            <span class="hljs-comment">// å¤„ç† .css æ–‡ä»¶çš„è§„åˆ™</span>
            {
                <span class="hljs-comment">// åŒ¹é… .css æ–‡ä»¶</span>
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,
                <span class="hljs-comment">// ä½¿ç”¨ style-loader å’Œ css-loader å¤„ç†</span>
                <span class="hljs-comment">// æ‰§è¡Œé¡ºåºï¼šä»å³åˆ°å·¦ï¼Œå…ˆä½¿ç”¨ css-loader è§£æ CSSï¼Œå†ä½¿ç”¨ style-loader å°† CSS æ’å…¥åˆ°é¡µé¢</span>
                <span class="hljs-attr">use</span>: [<span class="hljs-string">'style-loader'</span>, <span class="hljs-string">'css-loader'</span>],
            },
            <span class="hljs-comment">// å¤„ç† .scss å’Œ .sass æ–‡ä»¶çš„è§„åˆ™</span>
            {
                <span class="hljs-comment">// åŒ¹é… .scss å’Œ .sass æ–‡ä»¶</span>
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.s[ac]ss$/i</span>,
                <span class="hljs-comment">// ä½¿ç”¨ style-loaderã€css-loader å’Œ sass-loader å¤„ç†</span>
                <span class="hljs-comment">// æ‰§è¡Œé¡ºåºï¼šä»å³åˆ°å·¦ï¼Œå…ˆä½¿ç”¨ sass-loader ç¼–è¯‘ Sassï¼Œå†ä½¿ç”¨ css-loader è§£æ CSSï¼Œæœ€åä½¿ç”¨ style-loader å°† CSS æ’å…¥åˆ°é¡µé¢</span>
                <span class="hljs-attr">use</span>: [<span class="hljs-string">'style-loader'</span>, <span class="hljs-string">'css-loader'</span>, <span class="hljs-string">'sass-loader'</span>],
            },
            <span class="hljs-comment">// å¤„ç†å›¾ç‰‡æ–‡ä»¶çš„è§„åˆ™</span>
            {
                <span class="hljs-comment">// åŒ¹é… pngã€jpgã€jpegã€gif å’Œ webp æ ¼å¼çš„å›¾ç‰‡æ–‡ä»¶</span>
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(png|jpe?g|gif|webp)$/i</span>,
                <span class="hljs-comment">// ä½¿ç”¨ file-loader å¤„ç†ï¼Œå°†å›¾ç‰‡æ–‡ä»¶å¤åˆ¶åˆ°è¾“å‡ºç›®å½•å¹¶è¿”å›æ–‡ä»¶è·¯å¾„</span>
                <span class="hljs-attr">use</span>: <span class="hljs-string">'file-loader'</span>,
            },
        ],
    },
};

</code></pre>
<p><strong>webpack.dev.cjs</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¯¼å…¥ webpack-merge æ¨¡å—ï¼Œç”¨äºåˆå¹¶ webpack é…ç½®</span>
<span class="hljs-keyword">const</span> { merge } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-merge'</span>);
<span class="hljs-comment">// å¯¼å…¥åŸºç¡€é…ç½®æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.base.cjs'</span>);
<span class="hljs-comment">// å¯¼å…¥ Node.js å†…ç½®çš„ path æ¨¡å—ï¼Œç”¨äºå¤„ç†æ–‡ä»¶è·¯å¾„</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-comment">// åˆå¹¶åŸºç¡€é…ç½®å’Œå¼€å‘ç¯å¢ƒé…ç½®</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">merge</span>(baseConfig, {
    <span class="hljs-comment">// æ¨¡å¼è®¾ç½®ä¸ºå¼€å‘ç¯å¢ƒ</span>
    <span class="hljs-attr">mode</span>: <span class="hljs-string">'development'</span>,

    <span class="hljs-comment">// è¾“å‡ºé…ç½®</span>
    <span class="hljs-attr">output</span>: {
        <span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶åï¼Œå¼€å‘ç¯å¢ƒä½¿ç”¨ç®€å•çš„ bundle.js</span>
        <span class="hljs-attr">filename</span>: <span class="hljs-string">'bundle.js'</span>,
    },

    <span class="hljs-comment">// å¼€å‘å·¥å…·é…ç½®ï¼Œç”¨äºç”Ÿæˆ source map</span>
    <span class="hljs-comment">// eval-cheap-module-source-map èƒ½åœ¨å¼€å‘æ—¶æä¾›è¾ƒå¥½çš„æ€§èƒ½å’Œè°ƒè¯•ä½“éªŒ</span>
    <span class="hljs-attr">devtool</span>: <span class="hljs-string">'eval-cheap-module-source-map'</span>,

    <span class="hljs-comment">// å¼€å‘æœåŠ¡å™¨é…ç½®</span>
    <span class="hljs-attr">devServer</span>: {
        <span class="hljs-comment">// é™æ€æ–‡ä»¶ç›®å½•é…ç½®</span>
        <span class="hljs-attr">static</span>: {
            <span class="hljs-comment">// æŒ‡å®š public ç›®å½•ä¸ºé™æ€æ–‡ä»¶ç›®å½•</span>
            <span class="hljs-attr">directory</span>: path.<span class="hljs-title function_">join</span>(__dirname, <span class="hljs-string">'public'</span>),
        },
        <span class="hljs-comment">// æ˜¯å¦å¯ç”¨ gzip å‹ç¼©</span>
        <span class="hljs-attr">compress</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// å¼€å‘æœåŠ¡å™¨ç«¯å£</span>
        <span class="hljs-attr">port</span>: <span class="hljs-number">8000</span>,
        <span class="hljs-comment">// æ˜¯å¦å¯ç”¨çƒ­æ¨¡å—æ›¿æ¢ï¼ˆHMRï¼‰</span>
        <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// æ„å»ºå®Œæˆåæ˜¯å¦è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</span>
        <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// å®¢æˆ·ç«¯é…ç½®</span>
        <span class="hljs-attr">client</span>: {
            <span class="hljs-comment">// é”™è¯¯å’Œè­¦å‘Šçš„è¦†ç›–å±‚é…ç½®</span>
            <span class="hljs-attr">overlay</span>: {
                <span class="hljs-comment">// æ˜¾ç¤ºé”™è¯¯è¦†ç›–å±‚</span>
                <span class="hljs-attr">errors</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-comment">// ä¸æ˜¾ç¤ºè­¦å‘Šè¦†ç›–å±‚</span>
                <span class="hljs-attr">warnings</span>: <span class="hljs-literal">false</span>,
            },
        },
        <span class="hljs-comment">// æ”¯æŒ SPA è·¯ç”±ï¼Œæ‰€æœ‰ 404 è¯·æ±‚éƒ½ä¼šè¿”å› index.html</span>
        <span class="hljs-attr">historyApiFallback</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// ä»£ç†é…ç½®ï¼Œç”¨äºå°† API è¯·æ±‚ä»£ç†åˆ°åç«¯æœåŠ¡å™¨</span>
        <span class="hljs-attr">proxy</span>: [
            {
                <span class="hljs-comment">// åŒ¹é…éœ€è¦ä»£ç†çš„è·¯å¾„</span>
                <span class="hljs-attr">context</span>: [<span class="hljs-string">'/test'</span>],
                <span class="hljs-comment">// ä»£ç†ç›®æ ‡åœ°å€</span>
                <span class="hljs-attr">target</span>: <span class="hljs-string">'http://localhost:3000'</span>,
                <span class="hljs-comment">// æ˜¯å¦éªŒè¯ SSL è¯ä¹¦</span>
                <span class="hljs-attr">secure</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-comment">// æ˜¯å¦ä¿®æ”¹è¯·æ±‚å¤´ä¸­çš„ Origin</span>
                <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-comment">// è·¯å¾„é‡å†™é…ç½®ï¼ˆå½“å‰å·²æ³¨é‡Šï¼‰</span>
                <span class="hljs-comment">// pathRewrite: {</span>
                <span class="hljs-comment">//     '^/api': ''</span>
                <span class="hljs-comment">// }</span>
            },
        ],
    },

    <span class="hljs-comment">// ä¼˜åŒ–é…ç½®</span>
    <span class="hljs-attr">optimization</span>: {
        <span class="hljs-comment">// å¯ç”¨ tree shakingï¼Œåªæ‰“åŒ…ä½¿ç”¨åˆ°çš„ä»£ç </span>
        <span class="hljs-attr">usedExports</span>: <span class="hljs-literal">true</span>,
    },
});

</code></pre>
<p><strong>webpack.prod.cjs</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¯¼å…¥ webpack-merge æ¨¡å—ï¼Œç”¨äºåˆå¹¶ webpack é…ç½®</span>
<span class="hljs-keyword">const</span> { merge } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-merge'</span>);
<span class="hljs-comment">// å¯¼å…¥åŸºç¡€é…ç½®æ–‡ä»¶</span>
<span class="hljs-keyword">const</span> baseConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./webpack.base.cjs'</span>);
<span class="hljs-comment">// å¯¼å…¥ TerserPluginï¼Œç”¨äºå‹ç¼© JavaScript ä»£ç </span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">TerserPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'terser-webpack-plugin'</span>);
<span class="hljs-comment">// å¯¼å…¥ CssMinimizerPluginï¼Œç”¨äºå‹ç¼© CSS ä»£ç </span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">CssMinimizerPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'css-minimizer-webpack-plugin'</span>);
<span class="hljs-comment">// å¯¼å…¥ BundleAnalyzerPluginï¼Œç”¨äºåˆ†ææ‰“åŒ…åçš„æ–‡ä»¶ç»“æ„å’Œå¤§å°</span>
<span class="hljs-keyword">const</span> { <span class="hljs-title class_">BundleAnalyzerPlugin</span> } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-bundle-analyzer'</span>);

<span class="hljs-comment">// åˆå¹¶åŸºç¡€é…ç½®å’Œç”Ÿäº§ç¯å¢ƒé…ç½®</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">merge</span>(baseConfig, {
    <span class="hljs-comment">// æ¨¡å¼è®¾ç½®ä¸ºç”Ÿäº§ç¯å¢ƒ</span>
    <span class="hljs-attr">mode</span>: <span class="hljs-string">'production'</span>,

    <span class="hljs-comment">// è¾“å‡ºé…ç½®</span>
    <span class="hljs-attr">output</span>: {
        <span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶åï¼Œä½¿ç”¨ contenthash ç¡®ä¿æ–‡ä»¶å†…å®¹å˜åŒ–æ—¶æ–‡ä»¶åå˜åŒ–ï¼Œæœ‰åˆ©äºç¼“å­˜</span>
        <span class="hljs-attr">filename</span>: <span class="hljs-string">'bundle.[contenthash].js'</span>,
        <span class="hljs-comment">// æ„å»ºå‰æ¸…ç†è¾“å‡ºç›®å½•</span>
        <span class="hljs-attr">clean</span>: <span class="hljs-literal">true</span>,
    },
    <span class="hljs-attr">devtool</span>: <span class="hljs-string">'hidden-source-map'</span>,
    <span class="hljs-comment">// ä¼˜åŒ–é…ç½®</span>
    <span class="hljs-attr">optimization</span>: {
        <span class="hljs-comment">// å¯ç”¨ä»£ç å‹ç¼©</span>
        <span class="hljs-attr">minimize</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// é…ç½®å‹ç¼©å™¨</span>
        <span class="hljs-attr">minimizer</span>: [
            <span class="hljs-comment">// JavaScript å‹ç¼©å™¨é…ç½®</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">TerserPlugin</span>({
                <span class="hljs-comment">// Terser é…ç½®é€‰é¡¹</span>
                <span class="hljs-attr">terserOptions</span>: {
                    <span class="hljs-comment">// å‹ç¼©é…ç½®</span>
                    <span class="hljs-attr">compress</span>: {
                        <span class="hljs-comment">// åˆ é™¤æ‰€æœ‰ console è¯­å¥</span>
                        <span class="hljs-attr">drop_console</span>: <span class="hljs-literal">true</span>,
                        <span class="hljs-comment">// åˆ é™¤æ‰€æœ‰ debugger è¯­å¥</span>
                        <span class="hljs-attr">drop_debugger</span>: <span class="hljs-literal">true</span>,
                    },
                },
            }),
            <span class="hljs-comment">// CSS å‹ç¼©å™¨</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">CssMinimizerPlugin</span>(),
            <span class="hljs-comment">// æ‰“åŒ…åˆ†æå·¥å…·é…ç½®</span>
            <span class="hljs-keyword">new</span> <span class="hljs-title class_">BundleAnalyzerPlugin</span>({
                <span class="hljs-comment">// åˆ†ææ¨¡å¼è®¾ç½®ä¸ºé™æ€æ–‡ä»¶</span>
                <span class="hljs-attr">analyzerMode</span>: <span class="hljs-string">'static'</span>,
                <span class="hljs-comment">// ä¸è‡ªåŠ¨æ‰“å¼€åˆ†ææŠ¥å‘Š</span>
                <span class="hljs-attr">openAnalyzer</span>: <span class="hljs-literal">false</span>,
            }),
        ],
        <span class="hljs-comment">// ä»£ç åˆ†å‰²é…ç½®</span>
        <span class="hljs-attr">splitChunks</span>: {
            <span class="hljs-comment">// å¯¹æ‰€æœ‰ç±»å‹çš„ chunk è¿›è¡Œæ‹†åˆ†ï¼ˆåŒ…æ‹¬å¼‚æ­¥å’ŒåŒæ­¥ï¼‰</span>
            <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
            <span class="hljs-comment">// æ§åˆ¶ç”Ÿæˆ chunk çš„æœ€å°å¤§å°ï¼ˆ20KBï¼‰</span>
            <span class="hljs-attr">minSize</span>: <span class="hljs-number">20000</span>,
            <span class="hljs-comment">// å‰©ä½™å¤§å°çš„æœ€å°å€¼ï¼Œç¡®ä¿æ‹†åˆ†åå‰©ä½™éƒ¨åˆ†ä¸ä¼šè¿‡å°</span>
            <span class="hljs-attr">minRemainingSize</span>: <span class="hljs-number">0</span>,
            <span class="hljs-comment">// æ¨¡å—è¢«å¼•ç”¨çš„æœ€å°æ¬¡æ•°</span>
            <span class="hljs-attr">minChunks</span>: <span class="hljs-number">1</span>,
            <span class="hljs-comment">// å¼‚æ­¥åŠ è½½æ—¶çš„æœ€å¤§è¯·æ±‚æ•°</span>
            <span class="hljs-attr">maxAsyncRequests</span>: <span class="hljs-number">30</span>,
            <span class="hljs-comment">// åˆå§‹åŠ è½½æ—¶çš„æœ€å¤§è¯·æ±‚æ•°</span>
            <span class="hljs-attr">maxInitialRequests</span>: <span class="hljs-number">30</span>,
            <span class="hljs-comment">// å¼ºåˆ¶æ‰§è¡Œå¤§å°é˜ˆå€¼ï¼ˆ50KBï¼‰ï¼Œè¶…è¿‡æ­¤å€¼çš„ chunk ä¼šè¢«å¼ºåˆ¶æ‹†åˆ†</span>
            <span class="hljs-attr">enforceSizeThreshold</span>: <span class="hljs-number">50000</span>,
            <span class="hljs-comment">// ç¼“å­˜ç»„é…ç½®ï¼Œç”¨äºå°†ä¸åŒç±»å‹çš„æ¨¡å—åˆ†å‰²åˆ°ä¸åŒçš„ chunk ä¸­</span>
            <span class="hljs-attr">cacheGroups</span>: {
                <span class="hljs-comment">// Element Plus ç»„ä»¶åº“ç¼“å­˜ç»„</span>
                <span class="hljs-attr">elementPlus</span>: {
                    <span class="hljs-comment">// è¾“å‡ºæ–‡ä»¶å</span>
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'element-plus'</span>,
                    <span class="hljs-comment">// åŒ¹é… Element Plus æ¨¡å—</span>
                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\/]node_modules[\/]element-plus[\/]/</span>,
                    <span class="hljs-comment">// ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜</span>
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
                    <span class="hljs-comment">// å¯¹æ‰€æœ‰ç±»å‹çš„ chunk ç”Ÿæ•ˆ</span>
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
                    <span class="hljs-comment">// é‡ç”¨å·²å­˜åœ¨çš„ chunkï¼Œé¿å…é‡å¤æ‰“åŒ…</span>
                    <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
                },
                <span class="hljs-comment">// Vue Router è·¯ç”±åº“ç¼“å­˜ç»„</span>
                <span class="hljs-attr">vueRouter</span>: {
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'vue-router'</span>,
                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\/]node_modules[\/]vue-router[\/]/</span>,
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
                    <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
                },
                <span class="hljs-comment">// Pinia çŠ¶æ€ç®¡ç†åº“ç¼“å­˜ç»„</span>
                <span class="hljs-attr">pinia</span>: {
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'pinia'</span>,
                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\/]node_modules[\/]pinia[\/]/</span>,
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
                    <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
                },
                <span class="hljs-comment">// Axios HTTP å®¢æˆ·ç«¯åº“ç¼“å­˜ç»„</span>
                <span class="hljs-attr">axios</span>: {
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'axios'</span>,
                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\/]node_modules[\/]axios[\/]/</span>,
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
                    <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
                },
                <span class="hljs-comment">// Vue æ ¸å¿ƒåº“ç¼“å­˜ç»„</span>
                <span class="hljs-attr">vue</span>: {
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'vue'</span>,
                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\/]node_modules[\/]vue[\/]/</span>,
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
                    <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
                },
                <span class="hljs-comment">// VueUse å·¥å…·åº“ç¼“å­˜ç»„</span>
                <span class="hljs-attr">vueUse</span>: {
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'vue-use'</span>,
                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\/]node_modules[\/]@vueuse[\/]/</span>,
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
                    <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
                },
                <span class="hljs-comment">// å…¬å…±ä»£ç ç¼“å­˜ç»„</span>
                <span class="hljs-attr">common</span>: {
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'common'</span>,
                    <span class="hljs-comment">// è‡³å°‘è¢«å¼•ç”¨ 2 æ¬¡çš„æ¨¡å—æ‰ä¼šè¢«æ‰“åŒ…åˆ°è¿™ä¸ª chunk</span>
                    <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>,
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">5</span>,
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
                    <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
                },
                <span class="hljs-comment">// å…¶ä»–ç¬¬ä¸‰æ–¹ä¾èµ–ç¼“å­˜ç»„</span>
                <span class="hljs-attr">vendors</span>: {
                    <span class="hljs-attr">name</span>: <span class="hljs-string">'vendors'</span>,
                    <span class="hljs-comment">// åŒ¹é…æ‰€æœ‰ node_modules ä¸­çš„æ¨¡å—</span>
                    <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\/]node_modules[\/]/</span>,
                    <span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>,
                    <span class="hljs-comment">// åªå¯¹åˆå§‹åŠ è½½çš„ chunk ç”Ÿæ•ˆ</span>
                    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'initial'</span>,
                    <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-comment">// å¼ºåˆ¶æ‰§è¡Œç¼“å­˜ç»„ï¼Œå³ä½¿ä¸ç¬¦åˆå…¶ä»–æ¡ä»¶</span>
                    <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>,
                },
            },
        },
        <span class="hljs-comment">// è¿è¡Œæ—¶ä»£ç åˆ†å‰²é…ç½®</span>
        <span class="hljs-attr">runtimeChunk</span>: {
            <span class="hljs-comment">// è¿è¡Œæ—¶ä»£ç çš„è¾“å‡ºæ–‡ä»¶å</span>
            <span class="hljs-attr">name</span>: <span class="hljs-string">'runtime'</span>,
        },
    },
});

</code></pre>
<h3 data-id="heading-1">viteé…ç½®</h3>
<p><strong>vite.base.ts</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¯¼å…¥Viteçš„defineConfigå‡½æ•°ï¼Œç”¨äºå®šä¹‰Viteé…ç½®</span>
<span class="hljs-keyword">import</span> { defineConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;
<span class="hljs-comment">// å¯¼å…¥Vueæ’ä»¶ï¼Œç”¨äºæ”¯æŒVueç»„ä»¶</span>
<span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">'@vitejs/plugin-vue'</span>;
<span class="hljs-comment">// å¯¼å…¥è‡ªåŠ¨å¯¼å…¥æ’ä»¶ï¼Œç”¨äºè‡ªåŠ¨å¯¼å…¥Vue APIå’Œå…¶ä»–åº“</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-auto-import/vite'</span>;
<span class="hljs-comment">// å¯¼å…¥ç»„ä»¶è‡ªåŠ¨æ³¨å†Œæ’ä»¶ï¼Œç”¨äºè‡ªåŠ¨æ³¨å†ŒVueç»„ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/vite'</span>;
<span class="hljs-comment">// å¯¼å…¥Element Plusè§£æå™¨ï¼Œç”¨äºè‡ªåŠ¨å¯¼å…¥Element Plusç»„ä»¶å’ŒAPI</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ElementPlusResolver</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'unplugin-vue-components/resolvers'</span>;
<span class="hljs-comment">// å¯¼å…¥Node.jsçš„pathæ¨¡å—ï¼Œç”¨äºå¤„ç†æ–‡ä»¶è·¯å¾„</span>
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;

<span class="hljs-comment">// å¯¼å‡ºå…¬å…±é…ç½®</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>({
    <span class="hljs-comment">// è®¾ç½®é¡¹ç›®åŸºç¡€è·¯å¾„ï¼Œä½¿ç”¨ç›¸å¯¹è·¯å¾„</span>
    <span class="hljs-attr">base</span>: <span class="hljs-string">'./'</span>,

    <span class="hljs-comment">// é…ç½®Viteæ’ä»¶</span>
    <span class="hljs-attr">plugins</span>: [
        <span class="hljs-comment">// ä½¿ç”¨Vueæ’ä»¶</span>
        <span class="hljs-title function_">vue</span>(),

        <span class="hljs-comment">// é…ç½®è‡ªåŠ¨å¯¼å…¥æ’ä»¶</span>
        <span class="hljs-title class_">AutoImport</span>({
            <span class="hljs-comment">// ä½¿ç”¨Element Plusè§£æå™¨</span>
            <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],
            <span class="hljs-comment">// ç”Ÿæˆç±»å‹å£°æ˜æ–‡ä»¶</span>
            <span class="hljs-attr">dts</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-comment">// è‡ªåŠ¨å¯¼å…¥çš„åº“</span>
            <span class="hljs-attr">imports</span>: [<span class="hljs-string">'vue'</span>, <span class="hljs-string">'vue-router'</span>, <span class="hljs-string">'pinia'</span>],
        }),

        <span class="hljs-comment">// é…ç½®ç»„ä»¶è‡ªåŠ¨æ³¨å†Œæ’ä»¶</span>
        <span class="hljs-title class_">Components</span>({
            <span class="hljs-comment">// ä½¿ç”¨Element Plusè§£æå™¨</span>
            <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],
            <span class="hljs-comment">// ç”Ÿæˆç±»å‹å£°æ˜æ–‡ä»¶</span>
            <span class="hljs-attr">dts</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-comment">// ç»„ä»¶æ‰€åœ¨ç›®å½•</span>
            <span class="hljs-attr">dirs</span>: [<span class="hljs-string">'./src/components'</span>],
        }),
    ],

    <span class="hljs-comment">// é…ç½®æ¨¡å—è§£æ</span>
    <span class="hljs-attr">resolve</span>: {
        <span class="hljs-comment">// é…ç½®è·¯å¾„åˆ«å</span>
        <span class="hljs-attr">alias</span>: {
            <span class="hljs-comment">// å°†@ç¬¦å·æŒ‡å‘srcç›®å½•</span>
            <span class="hljs-string">'@'</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">'./src'</span>),
        },
        <span class="hljs-comment">// é…ç½®æ–‡ä»¶æ‰©å±•åï¼Œå¯¼å…¥æ—¶å¯ä»¥çœç•¥</span>
        <span class="hljs-attr">extensions</span>: [<span class="hljs-string">'.mjs'</span>, <span class="hljs-string">'.js'</span>, <span class="hljs-string">'.ts'</span>, <span class="hljs-string">'.jsx'</span>, <span class="hljs-string">'.tsx'</span>, <span class="hljs-string">'.json'</span>, <span class="hljs-string">'.vue'</span>],
    },

    <span class="hljs-comment">// é…ç½®CSS</span>
    <span class="hljs-attr">css</span>: {
        <span class="hljs-comment">// é…ç½®é¢„å¤„ç†å™¨é€‰é¡¹</span>
        <span class="hljs-attr">preprocessorOptions</span>: {
            <span class="hljs-comment">// SCSSé¢„å¤„ç†å™¨é…ç½®</span>
            <span class="hljs-attr">scss</span>: {
                <span class="hljs-comment">// ç§»é™¤äº†additionalDataï¼Œå› ä¸ºstyle.csså·²ç»åœ¨main.tsä¸­å¯¼å…¥</span>
            },
        },
    },

    <span class="hljs-comment">// é…ç½®å¼€å‘æœåŠ¡å™¨</span>
    <span class="hljs-attr">server</span>: {
        <span class="hljs-comment">// æœåŠ¡å™¨ç«¯å£</span>
        <span class="hljs-attr">port</span>: <span class="hljs-number">9000</span>,
        <span class="hljs-comment">// è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</span>
        <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-comment">// å…è®¸å¤–éƒ¨è®¿é—®</span>
        <span class="hljs-attr">host</span>: <span class="hljs-string">'0.0.0.0'</span>,
        <span class="hljs-comment">// é…ç½®ä»£ç†</span>
        <span class="hljs-attr">proxy</span>: {
            <span class="hljs-comment">// å°†/testè·¯å¾„ä»£ç†åˆ°http://localhost:3000</span>
            <span class="hljs-string">'/test'</span>: {
                <span class="hljs-comment">// ä»£ç†ç›®æ ‡åœ°å€</span>
                <span class="hljs-attr">target</span>: <span class="hljs-string">'http://localhost:3000'</span>,
                <span class="hljs-comment">// æ”¹å˜è¯·æ±‚å¤´ä¸­çš„Origin</span>
                <span class="hljs-attr">changeOrigin</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-comment">// å…è®¸HTTPSè¯ä¹¦æ— æ•ˆ</span>
                <span class="hljs-attr">secure</span>: <span class="hljs-literal">false</span>,
            },
        },
    },

    <span class="hljs-comment">// é…ç½®ä¾èµ–ä¼˜åŒ–</span>
    <span class="hljs-attr">optimizeDeps</span>: {
        <span class="hljs-comment">// é¢„æ„å»ºçš„ä¾èµ–åˆ—è¡¨</span>
        <span class="hljs-attr">include</span>: [<span class="hljs-string">'vue'</span>, <span class="hljs-string">'vue-router'</span>, <span class="hljs-string">'pinia'</span>, <span class="hljs-string">'axios'</span>, <span class="hljs-string">'element-plus'</span>, <span class="hljs-string">'@vueuse/core'</span>],
    },
});

</code></pre>
<p><strong>vite.dev.ts</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¯¼å…¥Viteçš„defineConfigå’ŒmergeConfigå‡½æ•°</span>
<span class="hljs-comment">// defineConfigç”¨äºå®šä¹‰Viteé…ç½®ï¼ŒmergeConfigç”¨äºåˆå¹¶é…ç½®</span>
<span class="hljs-keyword">import</span> { defineConfig, mergeConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;

<span class="hljs-comment">// å¯¼å…¥å…¬å…±é…ç½®</span>
<span class="hljs-keyword">import</span> baseConfig <span class="hljs-keyword">from</span> <span class="hljs-string">'./vite.base.ts'</span>;

<span class="hljs-comment">// å¯¼å‡ºå¼€å‘ç¯å¢ƒé…ç½®</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(
    <span class="hljs-comment">// ä½¿ç”¨mergeConfigåˆå¹¶å…¬å…±é…ç½®å’Œå¼€å‘ç¯å¢ƒé…ç½®</span>
    <span class="hljs-title function_">mergeConfig</span>(
        <span class="hljs-comment">// å…¬å…±é…ç½®</span>
        baseConfig,
        <span class="hljs-comment">// å¼€å‘ç¯å¢ƒç‰¹å®šé…ç½®</span>
        <span class="hljs-title function_">defineConfig</span>({
            <span class="hljs-comment">// è®¾ç½®ç¯å¢ƒæ¨¡å¼ä¸ºdevelopment</span>
            <span class="hljs-attr">mode</span>: <span class="hljs-string">'development'</span>,
            <span class="hljs-comment">// é…ç½®å…¨å±€å¸¸é‡æ›¿æ¢</span>
            <span class="hljs-attr">define</span>: {
                <span class="hljs-comment">// Vue feature flag for hydration mismatch details</span>
                <span class="hljs-attr">__VUE_PROD_HYDRATION_MISMATCH_DETAILS__</span>: <span class="hljs-literal">false</span>,
            },
            <span class="hljs-comment">// é…ç½®æ„å»ºé€‰é¡¹</span>
            <span class="hljs-attr">build</span>: {
                <span class="hljs-comment">// æ„å»ºè¾“å‡ºç›®å½•</span>
                <span class="hljs-attr">outDir</span>: <span class="hljs-string">'dist'</span>,
                <span class="hljs-comment">// é™æ€èµ„æºè¾“å‡ºç›®å½•</span>
                <span class="hljs-attr">assetsDir</span>: <span class="hljs-string">'assets'</span>,
                <span class="hljs-comment">// å¼€å‘ç¯å¢ƒå¯ç”¨sourcemapï¼Œä¾¿äºè°ƒè¯•</span>
                <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-comment">// å¼€å‘ç¯å¢ƒä¸å‹ç¼©ä»£ç ï¼Œæé«˜æ„å»ºé€Ÿåº¦</span>
                <span class="hljs-attr">minify</span>: <span class="hljs-literal">false</span>,
            },
        })
    )
);

</code></pre>
<p><strong>vite.prod.ts</strong></p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// å¯¼å…¥Viteçš„defineConfigå’ŒmergeConfigå‡½æ•°</span>
<span class="hljs-comment">// defineConfigç”¨äºå®šä¹‰Viteé…ç½®ï¼ŒmergeConfigç”¨äºåˆå¹¶é…ç½®</span>
<span class="hljs-keyword">import</span> { defineConfig, mergeConfig } <span class="hljs-keyword">from</span> <span class="hljs-string">'vite'</span>;

<span class="hljs-comment">// å¯¼å…¥æ„å»ºåˆ†æå·¥å…·ï¼Œç”¨äºç”Ÿæˆæ„å»ºåŒ…å¤§å°åˆ†ææŠ¥å‘Š</span>
<span class="hljs-keyword">import</span> { visualizer } <span class="hljs-keyword">from</span> <span class="hljs-string">'rollup-plugin-visualizer'</span>;

<span class="hljs-comment">// å¯¼å…¥Gzipå‹ç¼©æ’ä»¶ï¼Œç”¨äºå‹ç¼©é™æ€èµ„æº</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Compression</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'vite-plugin-compression'</span>;

<span class="hljs-comment">// å¯¼å…¥å…¬å…±é…ç½®</span>
<span class="hljs-keyword">import</span> baseConfig <span class="hljs-keyword">from</span> <span class="hljs-string">'./vite.base.ts'</span>;

<span class="hljs-comment">// å¯¼å‡ºç”Ÿäº§ç¯å¢ƒé…ç½®</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(
    <span class="hljs-comment">// ä½¿ç”¨mergeConfigåˆå¹¶å…¬å…±é…ç½®å’Œç”Ÿäº§ç¯å¢ƒé…ç½®</span>
    <span class="hljs-title function_">mergeConfig</span>(
        <span class="hljs-comment">// å…¬å…±é…ç½®</span>
        baseConfig,
        <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒç‰¹å®šé…ç½®</span>
        <span class="hljs-title function_">defineConfig</span>({
            <span class="hljs-comment">// è®¾ç½®ç¯å¢ƒæ¨¡å¼ä¸ºproduction</span>
            <span class="hljs-attr">mode</span>: <span class="hljs-string">'production'</span>,
            <span class="hljs-comment">// é…ç½®å…¨å±€å¸¸é‡æ›¿æ¢</span>
            <span class="hljs-attr">define</span>: {
                <span class="hljs-comment">// Vue feature flag for hydration mismatch details</span>
                <span class="hljs-attr">__VUE_PROD_HYDRATION_MISMATCH_DETAILS__</span>: <span class="hljs-literal">true</span>,
            },
            <span class="hljs-comment">// é…ç½®ç”Ÿäº§ç¯å¢ƒç‰¹å®šæ’ä»¶</span>
            <span class="hljs-attr">plugins</span>: [
                <span class="hljs-comment">// æ„å»ºåˆ†æå·¥å…·é…ç½®</span>
                <span class="hljs-title function_">visualizer</span>({
                    <span class="hljs-comment">// æ„å»ºå®Œæˆåä¸è‡ªåŠ¨æ‰“å¼€æŠ¥å‘Š</span>
                    <span class="hljs-attr">open</span>: <span class="hljs-literal">false</span>,
                    <span class="hljs-comment">// æ˜¾ç¤ºgzipå‹ç¼©åçš„å¤§å°</span>
                    <span class="hljs-attr">gzipSize</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-comment">// æ˜¾ç¤ºbrotliå‹ç¼©åçš„å¤§å°</span>
                    <span class="hljs-attr">brotliSize</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-comment">// æŠ¥å‘Šç”Ÿæˆè·¯å¾„</span>
                    <span class="hljs-attr">filename</span>: <span class="hljs-string">'dist/stats.html'</span>,
                }),

                <span class="hljs-comment">// Gzipå‹ç¼©æ’ä»¶é…ç½®</span>
                <span class="hljs-title class_">Compression</span>({
                    <span class="hljs-comment">// è¾“å‡ºå‹ç¼©ä¿¡æ¯</span>
                    <span class="hljs-attr">verbose</span>: <span class="hljs-literal">true</span>,
                    <span class="hljs-comment">// å¯ç”¨å‹ç¼©</span>
                    <span class="hljs-attr">disable</span>: <span class="hljs-literal">false</span>,
                    <span class="hljs-comment">// å‹ç¼©é˜ˆå€¼ï¼Œå¤§äº10KBçš„æ–‡ä»¶æ‰ä¼šè¢«å‹ç¼©</span>
                    <span class="hljs-attr">threshold</span>: <span class="hljs-number">10240</span>,
                    <span class="hljs-comment">// å‹ç¼©ç®—æ³•</span>
                    <span class="hljs-attr">algorithm</span>: <span class="hljs-string">'gzip'</span>,
                    <span class="hljs-comment">// å‹ç¼©æ–‡ä»¶æ‰©å±•å</span>
                    <span class="hljs-attr">ext</span>: <span class="hljs-string">'.gz'</span>,
                }),
            ],

            <span class="hljs-comment">// é…ç½®æ„å»ºé€‰é¡¹</span>
            <span class="hljs-attr">build</span>: {
                <span class="hljs-comment">// æ„å»ºè¾“å‡ºç›®å½•</span>
                <span class="hljs-attr">outDir</span>: <span class="hljs-string">'dist'</span>,
                <span class="hljs-comment">// é™æ€èµ„æºè¾“å‡ºç›®å½•</span>
                <span class="hljs-attr">assetsDir</span>: <span class="hljs-string">'assets'</span>,
                <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒç¦ç”¨sourcemapï¼Œå‡å°‘æ–‡ä»¶å¤§å°</span>
                <span class="hljs-attr">sourcemap</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒä½¿ç”¨terserè¿›è¡Œä»£ç å‹ç¼©</span>
                <span class="hljs-attr">minify</span>: <span class="hljs-string">'terser'</span>,

                <span class="hljs-comment">// terserå‹ç¼©é…ç½®</span>
                <span class="hljs-attr">terserOptions</span>: {
                    <span class="hljs-comment">// å‹ç¼©é€‰é¡¹</span>
                    <span class="hljs-attr">compress</span>: {
                        <span class="hljs-comment">// ç§»é™¤consoleè¯­å¥</span>
                        <span class="hljs-attr">drop_console</span>: <span class="hljs-literal">true</span>,
                        <span class="hljs-comment">// ç§»é™¤debuggerè¯­å¥</span>
                        <span class="hljs-attr">drop_debugger</span>: <span class="hljs-literal">true</span>,
                    },
                },

                <span class="hljs-comment">// è¾“å‡ºé…ç½®ï¼ˆä½¿ç”¨rolldownæ›¿ä»£rollupï¼‰</span>
                <span class="hljs-attr">rollupOptions</span>: {
                    <span class="hljs-attr">output</span>: {
                        <span class="hljs-comment">// å…¥å£æ–‡ä»¶å‘½åè§„åˆ™</span>
                        <span class="hljs-attr">entryFileNames</span>: <span class="hljs-string">'assets/js/[name].[hash].js'</span>,
                        <span class="hljs-comment">// ä»£ç å—å‘½åè§„åˆ™</span>
                        <span class="hljs-attr">chunkFileNames</span>: <span class="hljs-string">'assets/js/[name].[hash].js'</span>,
                        <span class="hljs-comment">// é™æ€èµ„æºå‘½åè§„åˆ™</span>
                        <span class="hljs-attr">assetFileNames</span>: <span class="hljs-string">'assets/[ext]/[name].[hash].[ext]'</span>,

                        <span class="hljs-comment">// æ‰‹åŠ¨ä»£ç åˆ†å‰²é…ç½®</span>
                        <span class="hljs-attr">manualChunks</span>: {
                            <span class="hljs-comment">// å°†Vueç›¸å…³åº“æ‰“åŒ…åˆ°vue-vendor chunk</span>
                            <span class="hljs-string">'vue-vendor'</span>: [<span class="hljs-string">'vue'</span>, <span class="hljs-string">'vue-router'</span>, <span class="hljs-string">'pinia'</span>],
                            <span class="hljs-comment">// å°†Element Plusæ‰“åŒ…åˆ°element-plus chunk</span>
                            <span class="hljs-string">'element-plus'</span>: [<span class="hljs-string">'element-plus'</span>],
                            <span class="hljs-comment">// å°†Axiosæ‰“åŒ…åˆ°axios chunk</span>
                            <span class="hljs-attr">axios</span>: [<span class="hljs-string">'axios'</span>],
                            <span class="hljs-comment">// å°†@vueuse/coreæ‰“åŒ…åˆ°@vueuse/core chunk</span>
                            <span class="hljs-string">'@vueuse/core'</span>: [<span class="hljs-string">'@vueuse/core'</span>],
                        },
                    },
                },
            },
        })
    )
);

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯æ¨¡å—åŒ–å‘å±•]]></title>    <link>https://juejin.cn/post/7593234983756120074</link>    <guid>https://juejin.cn/post/7593234983756120074</guid>    <pubDate>2026-01-10T07:42:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593234983756120074" data-draft-id="7593242327933370378" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯æ¨¡å—åŒ–å‘å±•"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-10T07:42:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="cxxcode"/> <meta itemprop="url" content="https://juejin.cn/user/3175045310711944"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯æ¨¡å—åŒ–å‘å±•
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3175045310711944/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    cxxcode
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T07:42:22.000Z" title="Sat Jan 10 2026 07:42:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»20åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">å‰ç«¯æ¨¡å—åŒ–</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<pre><code class="hljs language-javascript" lang="javascript">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         çŸ¥è¯†ä½“ç³»é€’è¿›å…³ç³»                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ç¬¬ä¸€ç« ï¼šä¸ºä»€ä¹ˆéœ€è¦æ¨¡å—åŒ–ï¼Ÿ                                                  â”‚
â”‚     â””â”€â”€ é—®é¢˜èƒŒæ™¯ã€å†å²æ¼”è¿›                                                   â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚  ç¬¬äºŒç« ï¼šæ¨¡å—åŒ–è§„èŒƒæœ‰å“ªäº›ï¼Ÿ                                                  â”‚
â”‚     â””â”€â”€ <span class="hljs-title class_">CommonJS</span>ã€<span class="hljs-variable constant_">AMD</span>/<span class="hljs-variable constant_">UMD</span>ã€<span class="hljs-variable constant_">ESM</span> è¯­æ³•ä¸ç‰¹æ€§å¯¹æ¯”                                â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚  ç¬¬ä¸‰ç« ï¼š<span class="hljs-variable constant_">ESM</span> å¦‚ä½•å·¥ä½œï¼Ÿï¼ˆå®˜æ–¹æ ‡å‡†æ·±å…¥ï¼‰                                       â”‚
â”‚     â””â”€â”€ ä¸‰é˜¶æ®µåŠ è½½ã€é™æ€ç‰¹æ€§ã€å®æ—¶ç»‘å®šã€å¾ªç¯ä¾èµ–                              â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚  ç¬¬å››ç« ï¼šä¸ºä»€ä¹ˆéœ€è¦æ„å»ºå·¥å…·ï¼Ÿ                                                â”‚
â”‚     â””â”€â”€ <span class="hljs-variable constant_">ESM</span> çš„å±€é™æ€§ã€<span class="hljs-title class_">Webpack</span> çš„ä»·å€¼å®šä½                                     â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚  ç¬¬äº”ç« ï¼š<span class="hljs-title class_">Webpack</span> æ„å»ºåŸç†                                                   â”‚
â”‚     â””â”€â”€ æ„å»ºæµç¨‹ã€<span class="hljs-title class_">Module</span>/<span class="hljs-title class_">Chunk</span>/<span class="hljs-title class_">Bundle</span>ã€æ¨¡å—åŒ…è£¹æœºåˆ¶                          â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚  ç¬¬å…­ç« ï¼š<span class="hljs-title class_">Webpack</span> è¿è¡Œæ—¶æœºåˆ¶                                                 â”‚
â”‚     â””â”€â”€ __webpack_require__ã€å¼‚æ­¥åŠ è½½ã€<span class="hljs-title class_">JSON</span>P å›è°ƒ                            â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚  ç¬¬ä¸ƒç« ï¼šä¼˜åŒ–ç­–ç•¥ä¸æœ€ä½³å®è·µ                                                  â”‚
â”‚     â””â”€â”€ <span class="hljs-title class_">Tree</span> <span class="hljs-title class_">Shaking</span>ã€ä»£ç åˆ†å‰²ã€æ¨¡å—è¾“å‡ºæ ¼å¼                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-2">ç¬¬ä¸€ç« ï¼šæ¨¡å—åŒ–çš„å†å²æ¼”è¿›ä¸é—®é¢˜èƒŒæ™¯</h3>
<blockquote>
<p><strong>æœ¬ç« è§£å†³çš„é—®é¢˜</strong>ï¼šä¸ºä»€ä¹ˆ JavaScript éœ€è¦æ¨¡å—åŒ–ï¼Ÿæ¨¡å—åŒ–æ˜¯å¦‚ä½•ä¸€æ­¥æ­¥å‘å±•çš„ï¼Ÿ</p>
</blockquote>
<h4 data-id="heading-3">1.1 æ— æ¨¡å—æ—¶ä»£çš„ç—›ç‚¹ï¼ˆ1995-2009ï¼‰</h4>
<p>JavaScript è¯ç”Ÿä¹‹åˆå¹¶æ²¡æœ‰æ¨¡å—ç³»ç»Ÿï¼Œæ‰€æœ‰ä»£ç å…±äº«å…¨å±€ä½œç”¨åŸŸï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// a.js</span>
<span class="hljs-keyword">var</span> name = <span class="hljs-string">"moduleA"</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">helper</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/*...*/</span> }

<span class="hljs-comment">// b.js</span>
<span class="hljs-keyword">var</span> name = <span class="hljs-string">"moduleB"</span>;  <span class="hljs-comment">// ğŸ’¥ è¦†ç›–äº† a.js çš„ nameï¼</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">helper</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/*...*/</span> }  <span class="hljs-comment">// ğŸ’¥ è¦†ç›–äº† a.js çš„ helperï¼</span>

<span class="hljs-comment">// index.html - å¿…é¡»æ‰‹åŠ¨ç®¡ç†åŠ è½½é¡ºåº</span>
&lt;script src=<span class="hljs-string">"a.js"</span>&gt;&lt;/script&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"b.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</code></pre>
<p><strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>å‘½åå†²çª</strong>ï¼šå…¨å±€å˜é‡ç›¸äº’è¦†ç›–</li>
<li><strong>ä¾èµ–ç®¡ç†</strong>ï¼šæ‰‹åŠ¨ç»´æŠ¤ script æ ‡ç­¾é¡ºåº</li>
<li><strong>æŒ‰éœ€åŠ è½½</strong>ï¼šæ— æ³•å®ç°ï¼Œæ‰€æœ‰ä»£ç ä¸€æ¬¡æ€§åŠ è½½</li>
</ol>
<p><strong>æ—©æœŸè§£å†³æ–¹æ¡ˆ</strong>ï¼šIIFE + å‘½åç©ºé—´</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">var</span> <span class="hljs-title class_">MyApp</span> = <span class="hljs-title class_">MyApp</span> || {};
<span class="hljs-title class_">MyApp</span>.<span class="hljs-property">moduleA</span> = (<span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
  <span class="hljs-keyword">var</span> privateVar = <span class="hljs-string">"private"</span>;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">publicMethod</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) { <span class="hljs-comment">/*...*/</span> },
  };
})();
</code></pre>
<h4 data-id="heading-4">1.2 æ¨¡å—åŒ–æ¼”è¿›æ—¶é—´çº¿</h4>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>                     <span class="hljs-string">JavaScript</span> <span class="hljs-string">æ¨¡å—åŒ–æ¼”è¿›å²</span>                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span>                                                                             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-number">1995        </span><span class="hljs-number">2009         </span><span class="hljs-number">2011         </span><span class="hljs-number">2015         </span><span class="hljs-number">2017</span>         <span class="hljs-string">ç°åœ¨</span>      <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>    <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>    <span class="hljs-string">â–¼</span>           <span class="hljs-string">â–¼</span>            <span class="hljs-string">â–¼</span>            <span class="hljs-string">â–¼</span>            <span class="hljs-string">â–¼</span>            <span class="hljs-string">â–¼</span>       <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">æ— æ¨¡å—</span> <span class="hljs-string">â†’</span> <span class="hljs-string">CommonJS</span> <span class="hljs-string">â†’</span> <span class="hljs-string">AMD/UMD</span> <span class="hljs-string">â†’</span> <span class="hljs-string">ES</span> <span class="hljs-string">Modules</span> <span class="hljs-string">â†’</span> <span class="hljs-string">Nodeæ”¯æŒESM</span> <span class="hljs-string">â†’</span> <span class="hljs-string">ESMæˆä¸ºä¸»æµ</span>     <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>    <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>            <span class="hljs-string">â”‚</span>       <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">å…¨å±€å˜é‡</span>   <span class="hljs-string">Node.js</span>      <span class="hljs-string">æµè§ˆå™¨å¼‚æ­¥</span>    <span class="hljs-string">è¯­è¨€æ ‡å‡†</span>      <span class="hljs-string">ç”Ÿæ€ç»Ÿä¸€</span>      <span class="hljs-string">æ„å»ºå·¥å…·</span> <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>  <span class="hljs-string">å‘½åå†²çª</span>   <span class="hljs-string">æœåŠ¡ç«¯æ¨¡å—</span>    <span class="hljs-string">åŠ è½½éœ€æ±‚</span>      <span class="hljs-string">é™æ€åˆ†æ</span>      <span class="hljs-string">åŒæ ¼å¼å¹¶å­˜</span>    <span class="hljs-string">æ·±åº¦ä¼˜åŒ–</span> <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                             <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>








































<table><thead><tr><th>é˜¶æ®µ</th><th>æ—¶é—´</th><th>è§„èŒƒ</th><th>èƒŒæ™¯</th><th>ç‰¹ç‚¹</th></tr></thead><tbody><tr><td>1</td><td>2009</td><td>CommonJS</td><td>Node.js è¯ç”Ÿï¼ŒæœåŠ¡ç«¯éœ€è¦æ¨¡å—ç³»ç»Ÿ</td><td>åŒæ­¥åŠ è½½ï¼Œè¿è¡Œæ—¶è§£æ</td></tr><tr><td>2</td><td>2011</td><td>AMD/UMD</td><td>æµè§ˆå™¨éœ€è¦å¼‚æ­¥åŠ è½½ï¼ˆç½‘ç»œå»¶è¿Ÿï¼‰</td><td>å¼‚æ­¥åŠ è½½ï¼Œå…¼å®¹å¤šç¯å¢ƒ</td></tr><tr><td>3</td><td>2015</td><td>ES Modules</td><td>JavaScript è¯­è¨€å±‚é¢çš„å®˜æ–¹æ ‡å‡†</td><td>é™æ€åˆ†æï¼Œç¼–è¯‘æ—¶ç¡®å®š</td></tr><tr><td>4</td><td>2017+</td><td>ç”Ÿæ€ç»Ÿä¸€</td><td>Node.js 12+ åŸç”Ÿæ”¯æŒ ESM</td><td>ESM + CJS åŒæ ¼å¼å¹¶å­˜</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-5">ç¬¬äºŒç« ï¼šæ¨¡å—åŒ–è§„èŒƒè¯¦è§£</h3>
<blockquote>
<p><strong>æœ¬ç« è§£å†³çš„é—®é¢˜</strong>ï¼šä¸‰å¤§æ¨¡å—è§„èŒƒï¼ˆCommonJSã€AMD/UMDã€ESMï¼‰å„æœ‰ä»€ä¹ˆè¯­æ³•å’Œç‰¹æ€§ï¼Ÿå¦‚ä½•é€‰æ‹©ï¼Ÿ</p>
</blockquote>
<h4 data-id="heading-6">2.1 è§„èŒƒå¯¹æ¯”æ€»è§ˆ</h4>






















































<table><thead><tr><th>ç‰¹æ€§</th><th>CommonJS</th><th>AMD</th><th>UMD</th><th>ESM</th></tr></thead><tbody><tr><td>è®¾è®¡ç›®æ ‡</td><td>æœåŠ¡ç«¯</td><td>æµè§ˆå™¨å¼‚æ­¥</td><td>é€šç”¨å…¼å®¹</td><td>è¯­è¨€æ ‡å‡†</td></tr><tr><td>åŠ è½½æ—¶æœº</td><td>è¿è¡Œæ—¶</td><td>è¿è¡Œæ—¶</td><td>è¿è¡Œæ—¶</td><td><strong>ç¼–è¯‘æ—¶</strong></td></tr><tr><td>åŠ è½½æ–¹å¼</td><td>åŒæ­¥</td><td>å¼‚æ­¥</td><td>ä¾ç¯å¢ƒ</td><td>å¼‚æ­¥(å¯åŒæ­¥)</td></tr><tr><td>å¯¼å‡ºç±»å‹</td><td>å€¼æ‹·è´</td><td>å€¼æ‹·è´</td><td>å€¼æ‹·è´</td><td><strong>å¼•ç”¨ç»‘å®š</strong></td></tr><tr><td>é™æ€åˆ†æ</td><td>âŒ</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>Tree Shaking</td><td>âŒ</td><td>âŒ</td><td>âŒ</td><td>âœ…</td></tr></tbody></table>
<h4 data-id="heading-7">2.2 CommonJS è¯¦è§£</h4>
<p><strong>è¯­æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯¼å‡º</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };
<span class="hljs-comment">// æˆ–</span>
<span class="hljs-built_in">exports</span>.<span class="hljs-property">a</span> = <span class="hljs-number">1</span>;
<span class="hljs-built_in">exports</span>.<span class="hljs-property">b</span> = <span class="hljs-number">2</span>;

<span class="hljs-comment">// å¯¼å…¥</span>
<span class="hljs-keyword">const</span> lib = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib'</span>);
<span class="hljs-keyword">const</span> { a, b } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib'</span>);
</code></pre>
<p><strong>è¿è¡Œæ—¶ç‰¹æ€§ï¼ˆåŠ¨æ€ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… æ¡ä»¶å¯¼å…¥</span>
<span class="hljs-keyword">if</span> (process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">'production'</span>) {
  <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./prod.js'</span>);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./dev.js'</span>);
}

<span class="hljs-comment">// âœ… åŠ¨æ€è·¯å¾„</span>
<span class="hljs-keyword">const</span> name = <span class="hljs-string">'utils'</span>;
<span class="hljs-keyword">const</span> utils = <span class="hljs-built_in">require</span>(<span class="hljs-string">`./<span class="hljs-subst">${name}</span>.js`</span>);

<span class="hljs-comment">// âœ… å¾ªç¯ä¸­å¯¼å…¥</span>
[<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">name</span> =&gt;</span> {
  modules[name] = <span class="hljs-built_in">require</span>(<span class="hljs-string">`./<span class="hljs-subst">${name}</span>.js`</span>);
});
</code></pre>
<p><strong>å€¼æ‹·è´ç‰¹æ€§</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// counter.js</span>
<span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  count,
  <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> count++,
};

<span class="hljs-comment">// index.js</span>
<span class="hljs-keyword">const</span> counter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./counter'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(counter.<span class="hljs-property">count</span>);  <span class="hljs-comment">// 0</span>
counter.<span class="hljs-title function_">increment</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(counter.<span class="hljs-property">count</span>);  <span class="hljs-comment">// 0 â† è¿˜æ˜¯ 0ï¼å€¼æ‹·è´ï¼</span>
</code></pre>
<h4 data-id="heading-8">2.3 UMD è¯¦è§£ï¼ˆé€šç”¨æ¨¡å—å®šä¹‰ï¼‰</h4>
<p>UMD çš„ç›®æ ‡æ˜¯<strong>ä¸€ä»½ä»£ç ï¼Œå¤šç¯å¢ƒè¿è¡Œ</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript">(<span class="hljs-keyword">function</span> (<span class="hljs-params">root, factory</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.<span class="hljs-property">amd</span>) {
    <span class="hljs-comment">// AMD ç¯å¢ƒ (RequireJS)</span>
    <span class="hljs-title function_">define</span>([<span class="hljs-string">'dependency'</span>], factory);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">module</span> === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>) {
    <span class="hljs-comment">// CommonJS ç¯å¢ƒ (Node.js)</span>
    <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title function_">factory</span>(<span class="hljs-built_in">require</span>(<span class="hljs-string">'dependency'</span>));
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// æµè§ˆå™¨å…¨å±€å˜é‡</span>
    root.<span class="hljs-property">MyLibrary</span> = <span class="hljs-title function_">factory</span>(root.<span class="hljs-property">Dependency</span>);
  }
})(<span class="hljs-keyword">typeof</span> self !== <span class="hljs-string">'undefined'</span> ? self : <span class="hljs-variable language_">this</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">dependency</span>) {
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">doSomething</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"/>) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'Hello from UMD!'</span>);
    },
  };
});
</code></pre>
<p><strong>ç¯å¢ƒåˆ¤æ–­æµç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-objectivec" lang="objectivec">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-keyword">typeof</span> exports ===   â”‚
â”‚ <span class="hljs-string">"object"</span> &amp;&amp;          â”‚â”€â”€â”€ <span class="hljs-literal">YES</span> â”€â”€â†’ CommonJS2: module.exports = ...
â”‚ <span class="hljs-keyword">typeof</span> module ===    â”‚
â”‚ <span class="hljs-string">"object"</span>             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ <span class="hljs-literal">NO</span>
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-keyword">typeof</span> define ===    â”‚
â”‚ <span class="hljs-string">"function"</span> &amp;&amp;        â”‚â”€â”€â”€ <span class="hljs-literal">YES</span> â”€â”€â†’ AMD: define([], factory)
â”‚ define.amd           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ <span class="hljs-literal">NO</span>
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-keyword">typeof</span> exports ===   â”‚â”€â”€â”€ <span class="hljs-literal">YES</span> â”€â”€â†’ CommonJS: exports[<span class="hljs-string">"name"</span>] = ...
â”‚ <span class="hljs-string">"object"</span>             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ <span class="hljs-literal">NO</span>
           â–¼
     æµè§ˆå™¨å…¨å±€å˜é‡: root[<span class="hljs-string">"name"</span>] = ...
</code></pre>
<h4 data-id="heading-9">2.4 ESM è¯¦è§£ï¼ˆå®˜æ–¹æ ‡å‡†ï¼‰</h4>
<p><strong>å¯¼å‡ºè¯­æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘½åå¯¼å‡º â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> name = <span class="hljs-string">'ESM'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">greet</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/*...*/</span> }
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> { <span class="hljs-comment">/*...*/</span> }

<span class="hljs-comment">// æ‰¹é‡å¯¼å‡º</span>
<span class="hljs-keyword">const</span> a = <span class="hljs-number">1</span>, b = <span class="hljs-number">2</span>;
<span class="hljs-keyword">export</span> { a, b };

<span class="hljs-comment">// é‡å‘½åå¯¼å‡º</span>
<span class="hljs-keyword">export</span> { a <span class="hljs-keyword">as</span> aliasA, b <span class="hljs-keyword">as</span> aliasB };

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ é»˜è®¤å¯¼å‡º â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-comment">/*...*/</span> }
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> { <span class="hljs-comment">/*...*/</span> }

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ èšåˆå¯¼å‡ºï¼ˆre-exportï¼‰â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">export</span> { foo, bar } <span class="hljs-keyword">from</span> <span class="hljs-string">'./other.js'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils.js'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">as</span> utils <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils.js'</span>;  <span class="hljs-comment">// å‘½åç©ºé—´èšåˆ</span>
</code></pre>
<p><strong>å¯¼å…¥è¯­æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘½åå¯¼å…¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">import</span> { name, greet } <span class="hljs-keyword">from</span> <span class="hljs-string">'./module.js'</span>;
<span class="hljs-keyword">import</span> { name <span class="hljs-keyword">as</span> aliasName } <span class="hljs-keyword">from</span> <span class="hljs-string">'./module.js'</span>;

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ é»˜è®¤å¯¼å…¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MyDefault</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./module.js'</span>;

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ··åˆå¯¼å…¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">MyDefault</span>, { name, greet } <span class="hljs-keyword">from</span> <span class="hljs-string">'./module.js'</span>;

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‘½åç©ºé—´å¯¼å…¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> <span class="hljs-title class_">Module</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./module.js'</span>;

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å‰¯ä½œç”¨å¯¼å…¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'./polyfill.js'</span>;  <span class="hljs-comment">// åªæ‰§è¡Œï¼Œä¸å¯¼å…¥ä»»ä½•å€¼</span>

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åŠ¨æ€å¯¼å…¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./module.js'</span>);
</code></pre>
<p><strong>é™æ€ç»“æ„é™åˆ¶ï¼ˆä¸ CommonJS çš„å…³é”®åŒºåˆ«ï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ESM ä¸å…è®¸ - åŠ¨æ€å¯¼å…¥è·¯å¾„</span>
<span class="hljs-keyword">import</span> { foo } <span class="hljs-keyword">from</span> <span class="hljs-title function_">getModulePath</span>();  <span class="hljs-comment">// SyntaxError</span>

<span class="hljs-comment">// âŒ ESM ä¸å…è®¸ - æ¡ä»¶å¯¼å…¥</span>
<span class="hljs-keyword">if</span> (condition) {
  <span class="hljs-keyword">import</span> { bar } <span class="hljs-keyword">from</span> <span class="hljs-string">'./bar.js'</span>;  <span class="hljs-comment">// SyntaxError</span>
}

<span class="hljs-comment">// âœ… CommonJS å…è®¸ - å®Œå…¨åŠ¨æ€</span>
<span class="hljs-keyword">const</span> mod = <span class="hljs-built_in">require</span>(<span class="hljs-title function_">getModulePath</span>());
<span class="hljs-keyword">if</span> (condition) {
  <span class="hljs-keyword">const</span> bar = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./bar.js'</span>);
}
</code></pre>
<hr/>
<h3 data-id="heading-10">ç¬¬ä¸‰ç« ï¼šESM å·¥ä½œåŸç†æ·±å…¥</h3>
<blockquote>
<p><strong>æœ¬ç« è§£å†³çš„é—®é¢˜</strong>ï¼šESM ä½œä¸ºå®˜æ–¹æ ‡å‡†ï¼Œå®ƒçš„åŠ è½½æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿé™æ€ç‰¹æ€§å’Œå®æ—¶ç»‘å®šæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</p>
</blockquote>
<h4 data-id="heading-11">3.1 ESM ä¸‰é˜¶æ®µåŠ è½½è¿‡ç¨‹</h4>
<p>ESM çš„åŠ è½½è¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªå®Œå…¨ç‹¬ç«‹çš„é˜¶æ®µï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ—¶æœºåˆ’åˆ†                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚                                              â”‚
â”‚   ç¼–è¯‘æ—¶/åŠ è½½æ—¶   â”‚  â‘  æ„å»º (Construction) - è§£æã€å‘ç°ä¾èµ–      â”‚
â”‚   (é™æ€åˆ†æ)     â”‚  â‘¡ å®ä¾‹åŒ– (Instantiation) - åˆ†é…å†…å­˜ã€è¿æ¥ç»‘å®šâ”‚
â”‚                  â”‚                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  â”‚                                              â”‚
â”‚   è¿è¡Œæ—¶         â”‚  â‘¢ æ±‚å€¼ (Evaluation) - æ‰§è¡Œä»£ç ã€å¡«å……å¯¼å‡ºå€¼   â”‚
â”‚   (ä»£ç æ‰§è¡Œ)     â”‚                                              â”‚
â”‚                  â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h5 data-id="heading-12">3.1.1 æ„å»ºé˜¶æ®µ (Construction)</h5>
<pre><code class="hljs language-sql" lang="sql">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ„å»ºé˜¶æ®µ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-number">1.</span> è§£ææ¨¡å—è¯´æ˜ç¬¦ (<span class="hljs-keyword">Module</span> Specifier)                        â”‚
â”‚     <span class="hljs-string">'./utils.js'</span> â†’ <span class="hljs-string">'file:///project/utils.js'</span>              â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">2.</span> è·å–æ¨¡å—æ–‡ä»¶ (<span class="hljs-keyword">Fetch</span>)                                     â”‚
â”‚     <span class="hljs-operator">-</span> æµè§ˆå™¨: HTTP è¯·æ±‚                                      â”‚
â”‚     <span class="hljs-operator">-</span> Node.js: æ–‡ä»¶ç³»ç»Ÿè¯»å–                                  â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">3.</span> è§£æä¸ºæ¨¡å—è®°å½• (<span class="hljs-keyword">Module</span> Record)                           â”‚
â”‚     <span class="hljs-operator">-</span> é™æ€åˆ†æ import<span class="hljs-operator">/</span>export è¯­å¥                            â”‚
â”‚     <span class="hljs-operator">-</span> ä¸æ‰§è¡Œä»»ä½•ä»£ç                                          â”‚
â”‚     <span class="hljs-operator">-</span> æ„å»ºæ¨¡å—ä¾èµ–å›¾                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼š</p>
<ul>
<li>æ¯ä¸ªæ¨¡å—åªä¼šè¢«è§£æä¸€æ¬¡ï¼Œç»“æœç¼“å­˜åœ¨ <strong>Module Map</strong> ä¸­</li>
<li>æ‰€æœ‰ä¾èµ–é€šè¿‡æ·±åº¦ä¼˜å…ˆéå†è¢«å‘ç°å’ŒåŠ è½½</li>
<li>æ­¤é˜¶æ®µå®Œå…¨æ˜¯é™æ€åˆ†æï¼Œ<strong>ä¸æ‰§è¡Œä»»ä½• JavaScript ä»£ç </strong></li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ¨¡å—è®°å½• (Module Record) çš„ç®€åŒ–ç»“æ„</span>
{
  [[<span class="hljs-title class_">RequestedModules</span>]]: [<span class="hljs-string">'./dep1.js'</span>, <span class="hljs-string">'./dep2.js'</span>],  <span class="hljs-comment">// ä¾èµ–åˆ—è¡¨</span>
  [[<span class="hljs-title class_">ImportEntries</span>]]: [...],   <span class="hljs-comment">// å¯¼å…¥æ¡ç›®</span>
  [[<span class="hljs-title class_">ExportEntries</span>]]: [...],   <span class="hljs-comment">// å¯¼å‡ºæ¡ç›®</span>
  [[<span class="hljs-title class_">Status</span>]]: <span class="hljs-string">'unlinked'</span>,     <span class="hljs-comment">// æ¨¡å—çŠ¶æ€</span>
  [[<span class="hljs-title class_">EvaluationError</span>]]: <span class="hljs-literal">null</span>   <span class="hljs-comment">// æ‰§è¡Œé”™è¯¯</span>
}
</code></pre>
<h5 data-id="heading-13">3.1.2 å®ä¾‹åŒ–é˜¶æ®µ (Instantiation / Linking)</h5>
<pre><code class="hljs language-arduino" lang="arduino">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å®ä¾‹åŒ–é˜¶æ®µ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-number">1.</span> ä¸ºæ¯ä¸ªæ¨¡å—åˆ†é…å†…å­˜ç©ºé—´ (Module Environment Record)        â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">2.</span> åˆ›å»ºå¯¼å‡ºç»‘å®š (Export Bindings)                           â”‚
â”‚     - åœ¨å†…å­˜ä¸­ä¸ºæ‰€æœ‰ <span class="hljs-keyword">export</span> åˆ›å»º<span class="hljs-string">"æ§½ä½"</span>                        â”‚
â”‚     - æ­¤æ—¶æ§½ä½æœªåˆå§‹åŒ– (uninitialized)                       â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">3.</span> è¿æ¥å¯¼å…¥å¯¼å‡º (Linking)                                   â”‚
â”‚     - <span class="hljs-keyword">import</span> ç›´æ¥æŒ‡å‘ <span class="hljs-keyword">export</span> çš„å†…å­˜åœ°å€                      â”‚
â”‚     - è¿™å°±æ˜¯<span class="hljs-string">"å®æ—¶ç»‘å®š"</span> (Live Binding)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h5 data-id="heading-14">3.1.3 æ±‚å€¼é˜¶æ®µ (Evaluation)</h5>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ±‚å€¼é˜¶æ®µ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  <span class="hljs-number">1</span>. æŒ‰ç…§æ·±åº¦ä¼˜å…ˆã€ååºéå†çš„é¡ºåºæ‰§è¡Œæ¨¡å—ä»£ç                     â”‚
â”‚     (å…ˆæ‰§è¡Œä¾èµ–æ¨¡å—ï¼Œå†æ‰§è¡Œå½“å‰æ¨¡å—)                          â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">2</span>. å¡«å……å¯¼å‡ºæ§½ä½çš„å®é™…å€¼                                      â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">3</span>. æ¯ä¸ªæ¨¡å—åªæ‰§è¡Œä¸€æ¬¡ï¼Œç»“æœè¢«ç¼“å­˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>æ‰§è¡Œé¡ºåºç¤ºä¾‹</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> { b } <span class="hljs-keyword">from</span> <span class="hljs-string">'./b.js'</span>;
<span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./a.js'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'main'</span>);

<span class="hljs-comment">// a.js</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'a'</span>);
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> a = <span class="hljs-string">'A'</span>;

<span class="hljs-comment">// b.js</span>
<span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./a.js'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'b'</span>);
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> b = <span class="hljs-string">'B'</span>;

<span class="hljs-comment">// æ‰§è¡Œé¡ºåº: a â†’ b â†’ main</span>
<span class="hljs-comment">// è¾“å‡º: 'a', 'b', 'main'</span>
</code></pre>
<h4 data-id="heading-15">3.2 é™æ€ç»“æ„ç‰¹æ€§</h4>
<p><strong>é™æ€åˆ†æ</strong>ï¼šåœ¨ä»£ç <strong>æ‰§è¡Œå‰</strong>ï¼ˆç¼–è¯‘é˜¶æ®µï¼‰ï¼Œä»…é€šè¿‡åˆ†æä»£ç æ–‡æœ¬ç»“æ„ï¼Œå°±èƒ½ç¡®å®šæ‰€æœ‰æ¨¡å—ä¾èµ–å…³ç³»ã€‚</p>
<pre><code class="hljs language-javascript" lang="javascript">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     é™æ€ vs åŠ¨æ€                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  <span class="hljs-variable constant_">ESM</span> é™æ€åˆ†æï¼ˆç¼–è¯‘æ—¶ï¼‰                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚
â”‚  <span class="hljs-keyword">import</span> { add } <span class="hljs-keyword">from</span> <span class="hljs-string">'./math.js'</span>;                                â”‚
â”‚       â†“                                                          â”‚
â”‚  ç¼–è¯‘å™¨è¯»å–ä»£ç æ–‡æœ¬ â†’ çœ‹åˆ° <span class="hljs-keyword">import</span> è¯­å¥ â†’ çŸ¥é“ä¾èµ– math.<span class="hljs-property">js</span>        â”‚
â”‚       â†“                                                          â”‚
â”‚  æ— éœ€æ‰§è¡Œä»£ç ï¼Œ<span class="hljs-number">100</span>% ç¡®å®šä¾èµ–å…³ç³»                                 â”‚
â”‚                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                                  â”‚
â”‚  <span class="hljs-title class_">CommonJS</span> åŠ¨æ€åˆ†æï¼ˆè¿è¡Œæ—¶ï¼‰                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚  <span class="hljs-keyword">const</span> math = <span class="hljs-built_in">require</span>(<span class="hljs-title function_">getPath</span>());                                â”‚
â”‚       â†“                                                          â”‚
â”‚  å¿…é¡»æ‰§è¡Œ <span class="hljs-title function_">getPath</span>() æ‰çŸ¥é“è·¯å¾„æ˜¯ä»€ä¹ˆ                             â”‚
â”‚       â†“                                                          â”‚
â”‚  ç¼–è¯‘æ—¶æ— æ³•ç¡®å®šä¾èµ–ï¼                                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>é™æ€ç»“æ„çš„ä¼˜åŠ¿</strong>ï¼š</p>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   é™æ€ç»“æ„çš„ä¼˜åŠ¿                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  <span class="hljs-number">1</span>. Tree Shaking (æ‘‡æ ‘ä¼˜åŒ–)                                  â”‚
â”‚     â”œâ”€â”€ åœ¨æ„å»ºæ—¶åˆ†æå“ªäº›å¯¼å‡ºè¢«ä½¿ç”¨                           â”‚
â”‚     â””â”€â”€ ç§»é™¤æœªä½¿ç”¨çš„ä»£ç  (Dead Code Elimination)             â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">2</span>. æ›´å¿«çš„æŸ¥æ‰¾                                               â”‚
â”‚     â”œâ”€â”€ å˜é‡æŸ¥æ‰¾åœ¨ç¼–è¯‘æ—¶ç¡®å®š                                 â”‚
â”‚     â””â”€â”€ æ— éœ€è¿è¡Œæ—¶çš„åŠ¨æ€æŸ¥æ‰¾                                 â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">3</span>. ç±»å‹æ£€æŸ¥                                                 â”‚
â”‚     â”œâ”€â”€ TypeScript å¯åœ¨ç¼–è¯‘æ—¶éªŒè¯å¯¼å…¥                        â”‚
â”‚     â””â”€â”€ IDE æä¾›å‡†ç¡®çš„è‡ªåŠ¨è¡¥å…¨                               â”‚
â”‚                                                             â”‚
â”‚  <span class="hljs-number">4</span>. å¾ªç¯ä¾èµ–å¤„ç†æ›´å¯é                                        â”‚
â”‚     â””â”€â”€ é™æ€åˆ†æå¯ä»¥æå‰å‘ç°é—®é¢˜                             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-16">3.3 å®æ—¶ç»‘å®š (Live Binding)</h4>
<p>ESM æœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œä¸ CommonJS çš„å€¼æ‹·è´å½¢æˆé²œæ˜å¯¹æ¯”ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// ============ ESM: å®æ—¶ç»‘å®š ============</span>
<span class="hljs-comment">// counter.mjs</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">increment</span>(<span class="hljs-params"/>) { count++; }

<span class="hljs-comment">// main.mjs</span>
<span class="hljs-keyword">import</span> { count, increment } <span class="hljs-keyword">from</span> <span class="hljs-string">'./counter.mjs'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count);  <span class="hljs-comment">// 0</span>
<span class="hljs-title function_">increment</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count);  <span class="hljs-comment">// 1 â† çœ‹åˆ°äº†å˜åŒ–ï¼</span>

<span class="hljs-comment">// ============ CommonJS: å€¼æ‹·è´ ============</span>
<span class="hljs-comment">// counter.cjs</span>
<span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {
  count,
  <span class="hljs-title function_">increment</span>(<span class="hljs-params"/>) { count++; }
};

<span class="hljs-comment">// main.cjs</span>
<span class="hljs-keyword">const</span> { count, increment } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./counter.cjs'</span>);
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count);  <span class="hljs-comment">// 0</span>
<span class="hljs-title function_">increment</span>();
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(count);  <span class="hljs-comment">// 0 â† è¿˜æ˜¯ 0ï¼(æ‹·è´çš„å€¼)</span>
</code></pre>
<p><strong>ç»‘å®šåŸç†å›¾è§£</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span> <span class="hljs-string">ESM</span> <span class="hljs-string">å®æ—¶ç»‘å®š</span> <span class="hljs-string">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">å¯¼å‡ºæ¨¡å—å†…å­˜</span>                 <span class="hljs-string">å¯¼å…¥æ¨¡å—</span>          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>           <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span> <span class="hljs-attr">count:</span> [<span class="hljs-string">ref</span>]<span class="hljs-string">â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â–º</span> <span class="hljs-string">count</span>      <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>         <span class="hljs-string">â”‚</span>    <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>         <span class="hljs-string">â–¼</span>    <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>      <span class="hljs-string">â”Œâ”€â”€â”€â”</span>   <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>      <span class="hljs-string">â”‚</span> <span class="hljs-number">0</span> <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">åŒä¸€å†…å­˜</span>  <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>      <span class="hljs-string">â””â”€â”€â”€â”˜</span>   <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>           <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>

<span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span> <span class="hljs-string">CJS</span> <span class="hljs-string">å€¼æ‹·è´</span> <span class="hljs-string">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">å¯¼å‡ºæ¨¡å—</span>                     <span class="hljs-string">å¯¼å…¥æ¨¡å—</span>          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>           <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span> <span class="hljs-attr">count:</span> <span class="hljs-string">â”€â”€â”€â”</span>  <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span> <span class="hljs-attr">count:</span> <span class="hljs-string">â”€â”€â”€â”</span>  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>  <span class="hljs-string">æ‹·è´æ“ä½œ</span>  <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>           <span class="hljs-string">â–¼</span>  <span class="hljs-string">â”‚</span>  <span class="hljs-string">â•â•â•â•â•â•â•â–º</span> <span class="hljs-string">â”‚</span>           <span class="hljs-string">â–¼</span>  <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>        <span class="hljs-string">â”Œâ”€â”€â”€â”</span> <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>        <span class="hljs-string">â”Œâ”€â”€â”€â”</span> <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>        <span class="hljs-string">â”‚</span> <span class="hljs-number">0</span> <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>        <span class="hljs-string">â”‚</span> <span class="hljs-number">0</span> <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>        <span class="hljs-string">â””â”€â”€â”€â”˜</span> <span class="hljs-string">â”‚</span>           <span class="hljs-string">â”‚</span>        <span class="hljs-string">â””â”€â”€â”€â”˜</span> <span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>           <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>      <span class="hljs-string">ç‹¬ç«‹å†…å­˜</span>                    <span class="hljs-string">ç‹¬ç«‹å†…å­˜</span>        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<p><strong>å¯¼å…¥æ˜¯åªè¯»çš„</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// module.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> value = <span class="hljs-number">1</span>;

<span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> { value } <span class="hljs-keyword">from</span> <span class="hljs-string">'./module.js'</span>;
value = <span class="hljs-number">2</span>;  <span class="hljs-comment">// TypeError: Assignment to constant variable</span>
<span class="hljs-comment">// å¯¼å…¥çš„ç»‘å®šæ˜¯åªè¯»çš„ï¼</span>

<span class="hljs-comment">// ä½†å¯ä»¥ä¿®æ”¹å¯¼å…¥å¯¹è±¡çš„å±æ€§</span>
<span class="hljs-keyword">import</span> { obj } <span class="hljs-keyword">from</span> <span class="hljs-string">'./module.js'</span>;
obj.<span class="hljs-property">prop</span> = <span class="hljs-string">'new'</span>;  <span class="hljs-comment">// âœ… è¿™æ˜¯å…è®¸çš„</span>
</code></pre>
<h4 data-id="heading-17">3.4 å¾ªç¯ä¾èµ–å¤„ç†</h4>
<h5 data-id="heading-18">ä½¿ç”¨ <code>const/let</code> å£°æ˜ â€”â€” æŠ›å‡º ReferenceError</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// a.mjs</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'a.mjs å¼€å§‹æ‰§è¡Œ'</span>);
<span class="hljs-keyword">import</span> { b } <span class="hljs-keyword">from</span> <span class="hljs-string">'./b.mjs'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åœ¨ a.mjs ä¸­, b ='</span>, b);
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> a = <span class="hljs-string">'a çš„å€¼'</span>;

<span class="hljs-comment">// b.mjs</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'b.mjs å¼€å§‹æ‰§è¡Œ'</span>);
<span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./a.mjs'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åœ¨ b.mjs ä¸­, a ='</span>, a);  <span class="hljs-comment">// âŒ ReferenceError!</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> b = <span class="hljs-string">'b çš„å€¼'</span>;

<span class="hljs-comment">// æ‰§è¡Œ node a.mjs</span>
<span class="hljs-comment">// è¾“å‡º:</span>
<span class="hljs-comment">// b.mjs å¼€å§‹æ‰§è¡Œ</span>
<span class="hljs-comment">// ReferenceError: Cannot access 'a' before initialization</span>
<span class="hljs-comment">//</span>
<span class="hljs-comment">// åŸå› ï¼šconst/let å­˜åœ¨æš‚æ—¶æ€§æ­»åŒº (TDZ)ï¼Œåœ¨åˆå§‹åŒ–å‰è®¿é—®ä¼šæŠ¥é”™</span>
</code></pre>
<h5 data-id="heading-19">ä½¿ç”¨ <code>var</code> å£°æ˜ â€”â€” å¾—åˆ° undefined</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// a.mjs</span>
<span class="hljs-keyword">import</span> { b } <span class="hljs-keyword">from</span> <span class="hljs-string">'./b.mjs'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">var</span> a = <span class="hljs-string">'a çš„å€¼'</span>;  <span class="hljs-comment">// ä½¿ç”¨ var</span>

<span class="hljs-comment">// b.mjs</span>
<span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./a.mjs'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åœ¨ b.mjs ä¸­, a ='</span>, a);  <span class="hljs-comment">// undefined (var ä¼šæå‡)</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">var</span> b = <span class="hljs-string">'b çš„å€¼'</span>;
</code></pre>
<h5 data-id="heading-20">ä½¿ç”¨å‡½æ•°å£°æ˜ â€”â€” æ­£å¸¸å·¥ä½œ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// a.mjs</span>
<span class="hljs-keyword">import</span> { b } <span class="hljs-keyword">from</span> <span class="hljs-string">'./b.mjs'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åœ¨ a.mjs ä¸­, b() ='</span>, <span class="hljs-title function_">b</span>());
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">a</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-string">'a çš„å€¼'</span>; }  <span class="hljs-comment">// å‡½æ•°å£°æ˜ä¼šæå‡</span>

<span class="hljs-comment">// b.mjs</span>
<span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./a.mjs'</span>;
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'åœ¨ b.mjs ä¸­, a() ='</span>, <span class="hljs-title function_">a</span>());  <span class="hljs-comment">// âœ… æ­£å¸¸å·¥ä½œï¼</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">b</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> <span class="hljs-string">'b çš„å€¼'</span>; }
</code></pre>
<p><strong>å¾ªç¯ä¾èµ–æ‰§è¡Œæµç¨‹</strong>ï¼š</p>
<pre><code class="hljs language-less" lang="less">æ‰§è¡Œ <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.mjs</span>:
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <span class="hljs-number">1</span>. è§£æ <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.mjs</span>ï¼Œå‘ç°ä¾èµ– <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.mjs</span>                                â”‚
â”‚ <span class="hljs-number">2</span>. è§£æ <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.mjs</span>ï¼Œå‘ç°ä¾èµ– <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.mjs</span> (å¾ªç¯ï¼)                       â”‚
â”‚ <span class="hljs-number">3</span>. <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.mjs</span> å·²åœ¨å¤„ç†ä¸­ï¼Œè·³è¿‡ (ä½¿ç”¨æœªåˆå§‹åŒ–çš„ç»‘å®š)                â”‚
â”‚ <span class="hljs-number">4</span>. æ‰§è¡Œ <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.mjs</span>ï¼Œæ­¤æ—¶ <span class="hljs-selector-tag">a</span> çš„å¯¼å‡ºæ§½ä½ï¼š                           â”‚
â”‚    <span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">const</span>/<span class="hljs-selector-tag">let</span>: å¤„äº <span class="hljs-selector-tag">TDZ</span> â†’ è®¿é—®æŠ›å‡º <span class="hljs-selector-tag">ReferenceError</span>          â”‚
â”‚    <span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">var</span>: å·²æå‡ä½†æœªèµ‹å€¼ â†’ <span class="hljs-selector-tag">undefined</span>                        â”‚
â”‚    <span class="hljs-selector-tag">-</span> <span class="hljs-selector-tag">function</span>: å®Œæ•´æå‡ â†’ å¯æ­£å¸¸è°ƒç”¨                        â”‚
â”‚ <span class="hljs-number">5</span>. <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.mjs</span> æ‰§è¡Œå®Œæ¯•ï¼ˆå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼‰ï¼Œ<span class="hljs-selector-tag">b</span> çš„å¯¼å‡ºæ§½ä½è¢«å¡«å……        â”‚
â”‚ <span class="hljs-number">6</span>. å›åˆ° <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.mjs</span> ç»§ç»­æ‰§è¡Œ                                       â”‚
â”‚ <span class="hljs-number">7</span>. <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.mjs</span> æ‰§è¡Œå®Œæ¯•ï¼Œ<span class="hljs-selector-tag">a</span> çš„å¯¼å‡ºæ§½ä½è¢«å¡«å……                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>é¿å…å¾ªç¯ä¾èµ–é—®é¢˜çš„æ–¹æ³•</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âœ… æ–¹æ³•1: ä½¿ç”¨å‡½æ•°å»¶è¿Ÿè®¿é—®</span>
<span class="hljs-comment">// a.mjs</span>
<span class="hljs-keyword">import</span> { getB } <span class="hljs-keyword">from</span> <span class="hljs-string">'./b.mjs'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> a = <span class="hljs-string">'a'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getA</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> a; }
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">getB</span>());  <span class="hljs-comment">// åœ¨å‡½æ•°è°ƒç”¨æ—¶ï¼Œb å·²åˆå§‹åŒ–</span>

<span class="hljs-comment">// b.mjs</span>
<span class="hljs-keyword">import</span> { getA } <span class="hljs-keyword">from</span> <span class="hljs-string">'./a.mjs'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> b = <span class="hljs-string">'b'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getB</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> b; }

<span class="hljs-comment">// âœ… æ–¹æ³•2: å°†å…±äº«çŠ¶æ€æå–åˆ°ç¬¬ä¸‰ä¸ªæ¨¡å—</span>
<span class="hljs-comment">// shared.mjs</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> shared = { <span class="hljs-attr">a</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">b</span>: <span class="hljs-literal">null</span> };

<span class="hljs-comment">// a.mjs</span>
<span class="hljs-keyword">import</span> { shared } <span class="hljs-keyword">from</span> <span class="hljs-string">'./shared.mjs'</span>;
shared.<span class="hljs-property">a</span> = <span class="hljs-string">'a'</span>;

<span class="hljs-comment">// b.mjs</span>
<span class="hljs-keyword">import</span> { shared } <span class="hljs-keyword">from</span> <span class="hljs-string">'./shared.mjs'</span>;
shared.<span class="hljs-property">b</span> = <span class="hljs-string">'b'</span>;
</code></pre>
<h4 data-id="heading-21">3.5 ESM åœ¨ä¸åŒç¯å¢ƒä¸­çš„å®ç°</h4>
<h5 data-id="heading-22">æµè§ˆå™¨ä¸­çš„ ESM</h5>
<pre><code class="hljs language-html" lang="html"><span class="hljs-comment">&lt;!-- ä½¿ç”¨ type="module" --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">
  <span class="hljs-keyword">import</span> { func } <span class="hljs-keyword">from</span> <span class="hljs-string">'./module.js'</span>;
  <span class="hljs-title function_">func</span>();
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- å¤–éƒ¨æ¨¡å— --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"./main.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- æ¨¡å—ç‰¹æ€§ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span>&gt;</span><span class="javascript">
  <span class="hljs-comment">// 1. é»˜è®¤ defer - ä¸é˜»å¡ HTML è§£æ</span>
  <span class="hljs-comment">// 2. é»˜è®¤ strict mode</span>
  <span class="hljs-comment">// 3. é¡¶å±‚ this æ˜¯ undefined</span>
  <span class="hljs-comment">// 4. æ”¯æŒé¡¶å±‚ await (ES2022)</span>
  <span class="hljs-comment">// 5. åŒæºç­–ç•¥ - è·¨åŸŸéœ€è¦ CORS</span>
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>

<span class="hljs-comment">&lt;!-- å…¼å®¹é™çº§ --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"module"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"modern.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">nomodule</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"legacy.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</code></pre>
<h5 data-id="heading-23">Node.js ä¸­çš„ ESM</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ–¹å¼1: ä½¿ç”¨ .mjs æ‰©å±•å</span>
<span class="hljs-comment">// utils.mjs</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">helper</span>(<span class="hljs-params"/>) {}

<span class="hljs-comment">// æ–¹å¼2: package.json ä¸­è®¾ç½® "type": "module"</span>
<span class="hljs-comment">// package.json</span>
{
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"module"</span>  <span class="hljs-comment">// æ‰€æœ‰ .js æ–‡ä»¶è§†ä¸º ESM</span>
}

<span class="hljs-comment">// æ–¹å¼3: .cjs æ‰©å±•åå¼ºåˆ¶ CommonJS</span>
<span class="hljs-comment">// legacy.cjs - å³ä½¿ type: moduleï¼Œä¹Ÿæ˜¯ CommonJS</span>

<span class="hljs-comment">// Node.js ç‰¹æœ‰çš„å¯¼å…¥æ–¹å¼</span>
<span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'node:fs'</span>;
<span class="hljs-keyword">import</span> { readFile } <span class="hljs-keyword">from</span> <span class="hljs-string">'node:fs/promises'</span>;

<span class="hljs-comment">// import.meta å¯¹è±¡</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);       <span class="hljs-comment">// file:///path/to/module.mjs</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">dirname</span>);   <span class="hljs-comment">// /path/to (Node 20.11+)</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">filename</span>);  <span class="hljs-comment">// /path/to/module.mjs</span>
</code></pre>
<hr/>
<h3 data-id="heading-24">ç¬¬å››ç« ï¼šä¸ºä»€ä¹ˆéœ€è¦æ„å»ºå·¥å…·ï¼Ÿ</h3>
<blockquote>
<p><strong>æœ¬ç« è§£å†³çš„é—®é¢˜</strong>ï¼šESM å·²ç»æ˜¯å®˜æ–¹æ ‡å‡†äº†ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦ Webpack è¿™æ ·çš„æ„å»ºå·¥å…·ï¼Ÿ</p>
</blockquote>
<h4 data-id="heading-25">4.1 å‰ç«¯å·¥ç¨‹åŒ–çš„ç—›ç‚¹</h4>
<p>è™½ç„¶ ESM è§£å†³äº†æ¨¡å—åŒ–çš„è¯­æ³•æ ‡å‡†é—®é¢˜ï¼Œä½†å‰ç«¯å¼€å‘è¿˜é¢ä¸´æ›´å¤šæŒ‘æˆ˜ï¼š</p>
<pre><code class="hljs language-sql" lang="sql">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯æ¨¡å—åŒ–çš„ç—›ç‚¹                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  <span class="hljs-number">1.</span> æ¨¡å—è§„èŒƒæ··ä¹±        <span class="hljs-number">2.</span> æµè§ˆå™¨å…¼å®¹æ€§       <span class="hljs-number">3.</span> èµ„æºç±»å‹å¤šæ ·            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ CommonJS    â”‚       â”‚ ES <span class="hljs-keyword">Module</span>   â”‚       â”‚ .js .css    â”‚           â”‚
â”‚  â”‚ AMD <span class="hljs-operator">/</span> UMD   â”‚       â”‚ æµè§ˆå™¨æ”¯æŒ  â”‚       â”‚ .png .svg   â”‚           â”‚
â”‚  â”‚ ES <span class="hljs-keyword">Module</span>   â”‚       â”‚ æœ‰é™        â”‚       â”‚ .json .wasm â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                         â”‚
â”‚  <span class="hljs-number">4.</span> å¼€å‘æ•ˆç‡            <span class="hljs-number">5.</span> æ€§èƒ½ä¼˜åŒ–                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚  â”‚ çƒ­æ›´æ–°      â”‚       â”‚ ä»£ç åˆ†å‰²    â”‚                                  â”‚
â”‚  â”‚ Source Map  â”‚       â”‚ Tree Shakingâ”‚                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ å‹ç¼©æ··æ·†    â”‚                                  â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â”‚                                                                         â”‚
â”‚                              â†“                                          â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                     â”‚    Webpack      â”‚                                 â”‚
â”‚                     â”‚  ç»Ÿä¸€è§£å†³æ–¹æ¡ˆ    â”‚                                 â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-26">4.2 Webpack çš„ä»·å€¼å®šä½</h4>
<p><strong>Webpack æœ¬è´¨</strong>ï¼šä¸€ä¸ªé™æ€æ¨¡å—æ‰“åŒ…å™¨ï¼Œä»¥ entry ä¸ºèµ·ç‚¹ï¼Œé€’å½’æ„å»ºä¾èµ–å›¾ï¼Œå°†æ‰€æœ‰æ¨¡å—æ‰“åŒ…æˆæµè§ˆå™¨å¯è¿è¡Œçš„ Bundleã€‚</p>



































<table><thead><tr><th>é—®é¢˜</th><th>ESM åŸç”Ÿèƒ½åŠ›</th><th>Webpack è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>æ¨¡å—è§„èŒƒæ··ä¹±</td><td>åªæ”¯æŒ ESM</td><td>ç»Ÿä¸€å¤„ç† CJS/AMD/ESM</td></tr><tr><td>æµè§ˆå™¨å…¼å®¹</td><td>éœ€è¦ç°ä»£æµè§ˆå™¨</td><td>è½¬è¯‘ä¸ºå…¼å®¹ä»£ç </td></tr><tr><td>é JS èµ„æº</td><td>ä¸æ”¯æŒ</td><td>Loader å¤„ç†ä»»æ„ç±»å‹</td></tr><tr><td>æ€§èƒ½ä¼˜åŒ–</td><td>æ— </td><td>Tree Shakingã€ä»£ç åˆ†å‰²</td></tr><tr><td>å¼€å‘ä½“éªŒ</td><td>æ— </td><td>HMRã€Source Map</td></tr></tbody></table>
<h4 data-id="heading-27">4.3 æ„å»ºå·¥å…·é“¾å…¨æ™¯</h4>
<pre><code class="hljs language-javascript" lang="javascript">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç°ä»£æ„å»ºå·¥å…·å¤„ç†æµç¨‹                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  æºä»£ç  (<span class="hljs-title class_">ES6</span>+ / <span class="hljs-variable constant_">ESM</span>)                                                         â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                         <span class="hljs-title class_">Babel</span>-loader                                 â”‚    â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚
â”‚  â”‚  â€¢ è½¬æ¢ <span class="hljs-title class_">ES6</span>+ è¯­æ³•ï¼ˆ<span class="hljs-keyword">async</span>/<span class="hljs-keyword">await</span>, <span class="hljs-keyword">class</span>, ç®­å¤´å‡½æ•°ç­‰ï¼‰                 â”‚    â”‚
â”‚  â”‚  â€¢ ä¿ç•™ <span class="hljs-keyword">import</span>/<span class="hljs-keyword">export</span> è¯­æ³•ï¼ˆ<span class="hljs-attr">modules</span>: <span class="hljs-literal">false</span>ï¼‰â† å…³é”®ï¼                â”‚    â”‚
â”‚  â”‚  â€¢ è½¬æ¢ <span class="hljs-variable constant_">JSX</span>ã€<span class="hljs-title class_">TypeScript</span> ç­‰                                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                           <span class="hljs-title class_">Webpack</span>                                    â”‚    â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚
â”‚  â”‚  <span class="hljs-number">1.</span> è§£æå…¥å£æ–‡ä»¶ï¼Œæ„å»ºä¾èµ–å›¾                                        â”‚    â”‚
â”‚  â”‚  <span class="hljs-number">2.</span> å°† <span class="hljs-keyword">import</span>/<span class="hljs-keyword">export</span> è½¬æ¢ä¸º __webpack_require__                     â”‚    â”‚
â”‚  â”‚  <span class="hljs-number">3.</span> æ ‡è®°æœªä½¿ç”¨çš„å¯¼å‡ºï¼ˆusedExportsï¼‰                                 â”‚    â”‚
â”‚  â”‚  <span class="hljs-number">4.</span> ä»£ç åˆ†å‰²ï¼ˆåŠ¨æ€ <span class="hljs-keyword">import</span> â†’ å•ç‹¬ chunkï¼‰                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                           <span class="hljs-title class_">Terser</span>                                     â”‚    â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚    â”‚
â”‚  â”‚  â€¢ åˆ é™¤æ ‡è®°ä¸ºæœªä½¿ç”¨çš„ä»£ç ï¼ˆ<span class="hljs-title class_">Tree</span> <span class="hljs-title class_">Shaking</span> å®Œæˆï¼‰                      â”‚    â”‚
â”‚  â”‚  â€¢ å‹ç¼©å˜é‡åã€ç§»é™¤ç©ºç™½ã€å†…è”ç®€å•å‡½æ•°                               â”‚    â”‚
â”‚  â”‚  â€¢ åˆ é™¤ <span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>ï¼ˆå¯é…ç½®ï¼‰                                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚        â”‚                                                                     â”‚
â”‚        â–¼                                                                     â”‚
â”‚  æœ€ç»ˆ <span class="hljs-title class_">Bundle</span>ï¼ˆä¼˜åŒ–åçš„ <span class="hljs-title class_">ES5</span> ä»£ç ï¼‰                                            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-28">ç¬¬äº”ç« ï¼šWebpack æ„å»ºåŸç†</h3>
<blockquote>
<p><strong>æœ¬ç« è§£å†³çš„é—®é¢˜</strong>ï¼šWebpack å†…éƒ¨æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿæ„å»ºæµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</p>
</blockquote>
<h4 data-id="heading-29">5.1 ä¸‰å¤§æ ¸å¿ƒè§’è‰²</h4>

























<table><thead><tr><th>è§’è‰²</th><th>èŒè´£</th><th>ç±»æ¯”</th></tr></thead><tbody><tr><td><strong>Compiler</strong></td><td>ç¼–è¯‘å™¨ï¼Œå…¨å±€å•ä¾‹ï¼Œè´¯ç©¿æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ</td><td>æ€»æŒ‡æŒ¥</td></tr><tr><td><strong>Compilation</strong></td><td>å•æ¬¡ç¼–è¯‘è¿‡ç¨‹ï¼ŒåŒ…å«æ¨¡å—ã€ä¾èµ–ã€Chunk ç­‰</td><td>ä¸€æ¬¡æ„å»ºä»»åŠ¡</td></tr><tr><td><strong>Module</strong></td><td>æ–‡ä»¶çš„æŠ½è±¡ï¼Œæ¯ä¸ªæºæ–‡ä»¶å¯¹åº”ä¸€ä¸ª Module</td><td>æ„å»ºçš„æœ€å°å•ä½</td></tr></tbody></table>
<h4 data-id="heading-30">5.2 æ ¸å¿ƒæ¦‚å¿µï¼šModuleã€Chunkã€Bundle</h4>

























<table><thead><tr><th>æ¦‚å¿µ</th><th>å®šä¹‰</th><th>ç”Ÿå‘½é˜¶æ®µ</th></tr></thead><tbody><tr><td><strong>Module</strong></td><td>æºæ–‡ä»¶çš„æŠ½è±¡ï¼ŒWebpack å¤„ç†çš„æœ€å°å•ä½</td><td>Make é˜¶æ®µ</td></tr><tr><td><strong>Chunk</strong></td><td>å¤šä¸ª Module çš„é›†åˆï¼Œæ‰“åŒ…çš„ä¸­é—´æ€</td><td>Seal é˜¶æ®µ</td></tr><tr><td><strong>Bundle</strong></td><td>Chunk ç»è¿‡å¤„ç†åè¾“å‡ºçš„æœ€ç»ˆæ–‡ä»¶</td><td>Emit é˜¶æ®µ</td></tr></tbody></table>
<pre><code class="hljs language-css" lang="css">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ä¸‰è€…å…³ç³»ï¼šä¸€å¯¹å¤š                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   Module (æºæ–‡ä»¶)              Chunk (ä¸­é—´æ€)             Bundle (äº§ç‰©) â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚   â”‚  <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.js</span>   â”‚â”€â”                                                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚   <span class="hljs-selector-tag">main</span> chunk    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’  <span class="hljs-selector-tag">main</span><span class="hljs-selector-class">.js</span>     â”‚
â”‚   â”‚  <span class="hljs-selector-tag">b</span><span class="hljs-selector-class">.js</span>   â”‚â”€â”¤              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”€â”˜                                                         â”‚
â”‚   â”‚  c<span class="hljs-selector-class">.css</span>  â”‚                                                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                           â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚   â”‚ lodash  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  vendor chunk   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’  vendor<span class="hljs-selector-class">.js</span>   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚   â”‚ lazy<span class="hljs-selector-class">.js</span> â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚   async chunk   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â†’  lazy<span class="hljs-selector-class">.js</span>     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                         â”‚
â”‚   å…³ç³»ï¼šN Module â†’ <span class="hljs-number">1</span> Chunk â†’ <span class="hljs-number">1</span> Bundle                                   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Chunk çš„ä¸‰ç§äº§ç”Ÿæ–¹å¼</strong>ï¼š</p>

























<table><thead><tr><th>äº§ç”Ÿæ–¹å¼</th><th>è§¦å‘æ¡ä»¶</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>Entry Chunk</strong></td><td>æ¯ä¸ª entry é…ç½®</td><td><code>entry: { main: './src/index.js' }</code></td></tr><tr><td><strong>Async Chunk</strong></td><td>åŠ¨æ€å¯¼å…¥ <code>import()</code></td><td><code>import('./lazy.js')</code></td></tr><tr><td><strong>Split Chunk</strong></td><td>SplitChunks é…ç½®æå–å…¬å…±æ¨¡å—</td><td><code>splitChunks: { chunks: 'all' }</code></td></tr></tbody></table>
<h4 data-id="heading-31">5.3 å®Œæ•´æ„å»ºæµç¨‹</h4>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Webpack æ„å»ºå…¨æµç¨‹                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚Initializeâ”‚â”€â”€â”€â†’â”‚   Make   â”‚â”€â”€â”€â†’â”‚   Seal   â”‚â”€â”€â”€â†’â”‚ Optimize â”‚â”€â”€â”€â†’â”‚ Emit  â”‚ â”‚
â”‚  â”‚  åˆå§‹åŒ–   â”‚    â”‚  æ„å»º    â”‚    â”‚   å°è£…   â”‚    â”‚   ä¼˜åŒ–   â”‚    â”‚ è¾“å‡º  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â”‚               â”‚               â”‚               â”‚              â”‚      â”‚
â”‚       â–¼               â–¼               â–¼               â–¼              â–¼      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚åˆå¹¶é…ç½®   â”‚    â”‚ä»Entry   â”‚    â”‚å½¢æˆChunk â”‚    â”‚SplitChunksâ”‚   â”‚å†™å…¥   â”‚ â”‚
â”‚  â”‚åˆ›å»ºCompilerâ”‚   â”‚é€’å½’è§£æ  â”‚    â”‚å»ºç«‹æ˜ å°„  â”‚    â”‚TreeShakingâ”‚   â”‚æ–‡ä»¶   â”‚ â”‚
â”‚  â”‚æ³¨å†ŒPlugin â”‚    â”‚æ‰§è¡ŒLoaderâ”‚    â”‚ç”Ÿæˆä»£ç   â”‚    â”‚å‹ç¼©æ··æ·†  â”‚    â”‚ç³»ç»Ÿ   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h5 data-id="heading-32">5.3.1 Initialize é˜¶æ®µ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ ¸å¿ƒä»»åŠ¡</span>
<span class="hljs-comment">// 1. åˆå¹¶é…ç½®ï¼ˆå‘½ä»¤è¡Œ + é…ç½®æ–‡ä»¶ + é»˜è®¤å€¼ï¼‰</span>
<span class="hljs-keyword">const</span> options = <span class="hljs-title function_">merge</span>(defaultConfig, userConfig, cliConfig);

<span class="hljs-comment">// 2. åˆ›å»º Compiler å®ä¾‹ï¼ˆå…¨å±€å•ä¾‹ï¼‰</span>
<span class="hljs-keyword">const</span> compiler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Compiler</span>(options);

<span class="hljs-comment">// 3. æ³¨å†Œæ‰€æœ‰æ’ä»¶</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> plugin <span class="hljs-keyword">of</span> options.<span class="hljs-property">plugins</span>) {
  plugin.<span class="hljs-title function_">apply</span>(compiler);  <span class="hljs-comment">// æ’ä»¶é€šè¿‡ apply æ–¹æ³•æ³¨å…¥ hooks</span>
}

<span class="hljs-comment">// 4. è§¦å‘ environment é’©å­</span>
compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">environment</span>.<span class="hljs-title function_">call</span>();
compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">afterEnvironment</span>.<span class="hljs-title function_">call</span>();
</code></pre>
<h5 data-id="heading-33">5.3.2 Make é˜¶æ®µï¼ˆæ ¸å¿ƒï¼šæ„å»º ModuleGraphï¼‰</h5>
<pre><code class="hljs language-javascript" lang="javascript">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           <span class="hljs-title class_">Make</span> é˜¶æ®µè¯¦è§£                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   <span class="hljs-title class_">Entry</span> <span class="hljs-title class_">Point</span>                      é€’å½’å¤„ç†æµç¨‹                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚   â”‚index.<span class="hljs-property">js</span> â”‚                                                           â”‚
â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                           â”‚
â”‚        â”‚                                                                â”‚
â”‚        â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  <span class="hljs-title class_">Step</span> <span class="hljs-number">1</span>: åˆ›å»º <span class="hljs-title class_">Module</span>                                             â”‚  â”‚
â”‚   â”‚  <span class="hljs-keyword">const</span> <span class="hljs-variable language_">module</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NormalModule</span>({                               â”‚  â”‚
â”‚   â”‚    <span class="hljs-attr">request</span>: <span class="hljs-string">'./src/index.js'</span>,                                    â”‚  â”‚
â”‚   â”‚    <span class="hljs-attr">type</span>: <span class="hljs-string">'javascript/auto'</span>,                                      â”‚  â”‚
â”‚   â”‚    <span class="hljs-attr">loaders</span>: [babel-loader, ...]                                  â”‚  â”‚
â”‚   â”‚  });                                                             â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                â”‚
â”‚        â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  <span class="hljs-title class_">Step</span> <span class="hljs-number">2</span>: <span class="hljs-title class_">Loader</span> è½¬æ¢                                             â”‚  â”‚
â”‚   â”‚  source = <span class="hljs-title function_">runLoaders</span>(loaders, originalSource);                   â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚  <span class="hljs-comment">// Loader é“¾å¼è°ƒç”¨ï¼ˆä»å³åˆ°å·¦ï¼‰                                   â”‚  â”‚</span>
â”‚   â”‚  <span class="hljs-comment">// sass-loader â†’ css-loader â†’ style-loader                      â”‚  â”‚</span>
â”‚   â”‚  <span class="hljs-comment">// ts-loader â†’ babel-loader                                     â”‚  â”‚</span>
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                â”‚
â”‚        â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  <span class="hljs-title class_">Step</span> <span class="hljs-number">3</span>: <span class="hljs-variable constant_">AST</span> è§£æï¼Œæå–ä¾èµ–                                       â”‚  â”‚
â”‚   â”‚  <span class="hljs-keyword">const</span> ast = <span class="hljs-title function_">parse</span>(source);                                      â”‚  â”‚
â”‚   â”‚                                                                  â”‚  â”‚
â”‚   â”‚  <span class="hljs-comment">// è¯†åˆ« import/require è¯­å¥                                      â”‚  â”‚</span>
â”‚   â”‚  <span class="hljs-keyword">import</span> utils <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;  â†’ <span class="hljs-title class_">HarmonyImportDependency</span>         â”‚  â”‚
â”‚   â”‚  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./config'</span>);          â†’ <span class="hljs-title class_">CommonJsDependency</span>              â”‚  â”‚
â”‚   â”‚  <span class="hljs-keyword">import</span>(<span class="hljs-string">'./lazy'</span>);             â†’ <span class="hljs-title class_">ImportDependency</span> (<span class="hljs-keyword">async</span>)        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                â”‚
â”‚        â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  <span class="hljs-title class_">Step</span> <span class="hljs-number">4</span>: é€’å½’å¤„ç†ä¾èµ–                                            â”‚  â”‚
â”‚   â”‚  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> dep <span class="hljs-keyword">of</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">dependencies</span>) {                        â”‚  â”‚
â”‚   â”‚    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">handleModuleCreation</span>(dep);  <span class="hljs-comment">// é€’å½’å›åˆ° Step 1           â”‚  â”‚</span>
â”‚   â”‚  }                                                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚        â”‚                                                                â”‚
â”‚        â–¼                                                                â”‚
â”‚   æœ€ç»ˆäº§ç‰©ï¼š<span class="hljs-title class_">ModuleGraph</span>ï¼ˆä¾èµ–å…³ç³»å›¾ï¼‰                                    â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h5 data-id="heading-34">5.3.3 Seal é˜¶æ®µï¼ˆæ ¸å¿ƒï¼šç”Ÿæˆ Chunkï¼‰</h5>
<p>è¿™æ˜¯ <strong>SplitChunks ç”Ÿæ•ˆçš„é˜¶æ®µ</strong>ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="hljs-string">â”‚</span>                           <span class="hljs-string">Seal</span> <span class="hljs-string">é˜¶æ®µè¯¦è§£</span>                                   <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span>
<span class="hljs-string">â”‚</span>                                                                         <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">Step 1:</span> <span class="hljs-string">å½¢æˆåˆå§‹</span> <span class="hljs-string">Chunk</span>                                                <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">Entry</span> <span class="hljs-string">A</span> <span class="hljs-string">â”€â”€â†’</span> <span class="hljs-string">Initial</span> <span class="hljs-string">Chunk</span> <span class="hljs-string">A</span>                                    <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">a.js</span>                                           <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">utils.js</span> <span class="hljs-string">(è¢«</span> <span class="hljs-string">Aã€B</span> <span class="hljs-string">éƒ½å¼•ç”¨)</span>                       <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>              <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">lodash</span>   <span class="hljs-string">(è¢«</span> <span class="hljs-string">Aã€B</span> <span class="hljs-string">éƒ½å¼•ç”¨)</span>                       <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>                                                                 <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">Entry</span> <span class="hljs-string">B</span> <span class="hljs-string">â”€â”€â†’</span> <span class="hljs-string">Initial</span> <span class="hljs-string">Chunk</span> <span class="hljs-string">B</span>                                    <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">b.js</span>                                           <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>              <span class="hljs-string">â”œâ”€â”€</span> <span class="hljs-string">utils.js</span> <span class="hljs-string">(é‡å¤ï¼)</span>                               <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>              <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">lodash</span>   <span class="hljs-string">(é‡å¤ï¼)</span>                               <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>                                                                 <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">import()</span> <span class="hljs-string">â”€â”€â†’</span> <span class="hljs-string">Async</span> <span class="hljs-string">Chunk</span>                                       <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>              <span class="hljs-string">â””â”€â”€</span> <span class="hljs-string">lazy.js</span>                                        <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                              <span class="hljs-string">â”‚</span>                                          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                              <span class="hljs-string">â–¼</span>                                          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">Step 2:</span> <span class="hljs-string">SplitChunks</span> <span class="hljs-string">ä¼˜åŒ–ï¼ˆoptimizeChunks</span> <span class="hljs-string">é’©å­ï¼‰</span>                        <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">éå†æ‰€æœ‰</span> <span class="hljs-string">Moduleï¼Œæ£€æŸ¥ï¼š</span>                                         <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>  <span class="hljs-attr">lodash:</span>                                                  <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">è¢«å¼•ç”¨æ¬¡æ•°:</span> <span class="hljs-number">2</span> <span class="hljs-string">(Chunk</span> <span class="hljs-string">A,</span> <span class="hljs-string">B)</span>    <span class="hljs-string">â‰¥</span> <span class="hljs-attr">minChunks:</span> <span class="hljs-number">1</span>   <span class="hljs-string">âœ“</span>    <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">æ¨¡å—å¤§å°:</span> <span class="hljs-string">70KB</span>                <span class="hljs-string">â‰¥</span> <span class="hljs-attr">minSize:</span> <span class="hljs-string">20KB</span>  <span class="hljs-string">âœ“</span>    <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">æ¥æº:</span> <span class="hljs-string">node_modules</span>            <span class="hljs-string">åŒ¹é…</span> <span class="hljs-string">test</span> <span class="hljs-string">æ­£åˆ™</span>   <span class="hljs-string">âœ“</span>    <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">â†’</span> <span class="hljs-string">æå–åˆ°</span> <span class="hljs-string">vendors</span> <span class="hljs-string">chunk</span>                                 <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>  <span class="hljs-attr">utils.js:</span>                                                <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">è¢«å¼•ç”¨æ¬¡æ•°:</span> <span class="hljs-number">2</span> <span class="hljs-string">(Chunk</span> <span class="hljs-string">A,</span> <span class="hljs-string">B)</span>    <span class="hljs-string">â‰¥</span> <span class="hljs-attr">minChunks:</span> <span class="hljs-number">2</span>   <span class="hljs-string">âœ“</span>    <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-bullet">-</span> <span class="hljs-string">æ¨¡å—å¤§å°:</span> <span class="hljs-string">5KB</span>                 <span class="hljs-string">&lt;</span> <span class="hljs-attr">minSize:</span> <span class="hljs-string">20KB</span>  <span class="hljs-string">âœ—</span>    <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>    <span class="hljs-string">â†’</span> <span class="hljs-string">ä¸æå–ï¼Œä¿ç•™åœ¨åŸ</span> <span class="hljs-string">chunk</span>                               <span class="hljs-string">â”‚</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span> <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                              <span class="hljs-string">â”‚</span>                                          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                              <span class="hljs-string">â–¼</span>                                          <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-attr">Step 3:</span> <span class="hljs-string">ä»£ç ç”Ÿæˆ</span>                                                       <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">æœ€ç»ˆ</span> <span class="hljs-string">Chunk</span> <span class="hljs-string">ç»“æ„:</span>                                               <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-attr">Chunk A:</span>  <span class="hljs-string">a.js</span> <span class="hljs-string">+</span> <span class="hljs-string">utils.js</span>                                      <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-attr">Chunk B:</span>  <span class="hljs-string">b.js</span> <span class="hljs-string">+</span> <span class="hljs-string">utils.js</span>                                      <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-attr">Chunk vendors:</span> <span class="hljs-string">lodash</span>                                          <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-attr">Chunk async:</span> <span class="hljs-string">lazy.js</span>                                           <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>                                                                 <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-string">ä¸ºæ¯ä¸ª</span> <span class="hljs-string">Chunk</span> <span class="hljs-string">ç”Ÿæˆä»£ç ï¼š</span>                                         <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-bullet">-</span> <span class="hljs-string">åŒ…è£¹</span> <span class="hljs-string">Module</span> <span class="hljs-string">ä¸ºå‡½æ•°</span>                                           <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-bullet">-</span> <span class="hljs-string">æ³¨å…¥</span> <span class="hljs-string">Runtime</span> <span class="hljs-string">ä»£ç </span>                                            <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â”‚</span>  <span class="hljs-bullet">-</span> <span class="hljs-string">å»ºç«‹</span> <span class="hljs-string">Chunk</span> <span class="hljs-string">é—´ä¾èµ–å…³ç³»</span>                                        <span class="hljs-string">â”‚</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>   <span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>  <span class="hljs-string">â”‚</span>
<span class="hljs-string">â”‚</span>                                                                         <span class="hljs-string">â”‚</span>
<span class="hljs-string">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
</code></pre>
<h4 data-id="heading-35">5.4 Module åŒ…è£¹æœºåˆ¶</h4>
<h5 data-id="heading-36">ä¸ºä»€ä¹ˆè¦åŒ…è£¹æˆå‡½æ•°ï¼Ÿ</h5>
<pre><code class="hljs language-java" lang="java">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Module åŒ…è£¹çš„ä¸‰å¤§ç›®çš„                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  <span class="hljs-number">1.</span> åˆ›å»ºç‹¬ç«‹ä½œç”¨åŸŸ                                                       â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚     â”‚  æ¯ä¸ªæ¨¡å—çš„å˜é‡ä¸ä¼šæ±¡æŸ“å…¨å±€                                     â”‚  â”‚
â”‚     â”‚  <span class="hljs-type">var</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">'a.js'</span> å’Œ <span class="hljs-type">var</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">'b.js'</span> ä¸ä¼šå†²çª               â”‚  â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  <span class="hljs-number">2.</span> æ³¨å…¥æ¨¡å—ç³»ç»Ÿ                                                         â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚     â”‚  <span class="hljs-keyword">module</span>        â†’ å½“å‰æ¨¡å—å¯¹è±¡                                   â”‚  â”‚
â”‚     â”‚  <span class="hljs-keyword">exports</span>       â†’ å¯¼å‡ºå¯¹è±¡ (<span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> çš„å¼•ç”¨)               â”‚  â”‚
â”‚     â”‚  __webpack_require__ â†’ å¼•å…¥å…¶ä»–æ¨¡å—çš„å‡½æ•°                       â”‚  â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  <span class="hljs-number">3.</span> æŒ‰éœ€æ‰§è¡Œ + ç¼“å­˜                                                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚     â”‚  å‡½æ•°åªæœ‰è¢« require æ—¶æ‰æ‰§è¡Œï¼ˆæƒ°æ€§åŠ è½½ï¼‰                        â”‚  â”‚
â”‚     â”‚  æ‰§è¡Œä¸€æ¬¡åç»“æœè¢«ç¼“å­˜åˆ° installedModulesï¼ˆå•ä¾‹æ¨¡å¼ï¼‰            â”‚  â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h5 data-id="heading-37">åŒ…è£¹å‰åå¯¹æ¯”</h5>
<p><strong>æºä»£ç </strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/utils.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">a, b</span>) =&gt; a + b;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> name = <span class="hljs-string">'utils'</span>;
</code></pre>
<p><strong>ç¼–è¯‘åï¼ˆES Moduleï¼‰</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-string">"./src/utils.js"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">module</span>, __webpack_exports__, __webpack_require__</span>) {
  <span class="hljs-string">"use strict"</span>;
  <span class="hljs-comment">// æ ‡è®°ä¸º ES Moduleï¼ˆç”¨äºå’Œ CommonJS åŒºåˆ†ï¼‰</span>
  __webpack_require__.<span class="hljs-title function_">r</span>(__webpack_exports__);

  <span class="hljs-comment">// å®šä¹‰å¯¼å‡ºï¼ˆä½¿ç”¨ getterï¼Œå®ç° live bindingï¼‰</span>
  __webpack_require__.<span class="hljs-title function_">d</span>(__webpack_exports__, {
    <span class="hljs-string">"add"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> add; },
    <span class="hljs-string">"name"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> name; }
  });

  <span class="hljs-comment">// åŸå§‹ä»£ç </span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">a, b</span>) =&gt; a + b;
  <span class="hljs-keyword">const</span> name = <span class="hljs-string">'utils'</span>;
}
</code></pre>
<h4 data-id="heading-38">5.5 æœ€ç»ˆ Bundle ç»“æ„</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// bundle.js</span>
(<span class="hljs-keyword">function</span>(<span class="hljs-params">modules</span>) {
  <span class="hljs-comment">// ========== Runtime ä»£ç  ==========</span>

  <span class="hljs-comment">// æ¨¡å—ç¼“å­˜</span>
  <span class="hljs-keyword">var</span> installedModules = {};

  <span class="hljs-comment">// æ ¸å¿ƒåŠ è½½å‡½æ•°</span>
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">__webpack_require__</span>(<span class="hljs-params">moduleId</span>) {
    <span class="hljs-comment">// æ£€æŸ¥ç¼“å­˜</span>
    <span class="hljs-keyword">if</span> (installedModules[moduleId]) {
      <span class="hljs-keyword">return</span> installedModules[moduleId].<span class="hljs-property">exports</span>;
    }

    <span class="hljs-comment">// åˆ›å»ºæ–°æ¨¡å—</span>
    <span class="hljs-keyword">var</span> <span class="hljs-variable language_">module</span> = installedModules[moduleId] = {
      <span class="hljs-attr">i</span>: moduleId,
      <span class="hljs-attr">l</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">exports</span>: {}
    };

    <span class="hljs-comment">// æ‰§è¡Œæ¨¡å—å‡½æ•°</span>
    modules[moduleId].<span class="hljs-title function_">call</span>(
      <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>,
      <span class="hljs-variable language_">module</span>,
      <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>,
      __webpack_require__
    );

    <span class="hljs-variable language_">module</span>.<span class="hljs-property">l</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>;
  }

  <span class="hljs-comment">// å·¥å…·å‡½æ•°</span>
  __webpack_require__.<span class="hljs-property">r</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-built_in">exports</span></span>) {
    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, <span class="hljs-string">'__esModule'</span>, { <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span> });
  };

  __webpack_require__.<span class="hljs-property">d</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-built_in">exports</span>, definition</span>) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> definition) {
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-built_in">exports</span>, key, {
        <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">get</span>: definition[key]  <span class="hljs-comment">// getter å®ç° live binding</span>
      });
    }
  };

  <span class="hljs-comment">// ========== å¯åŠ¨å…¥å£ ==========</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">__webpack_require__</span>(<span class="hljs-string">'./src/index.js'</span>);

})({
  <span class="hljs-comment">// ========== æ‰€æœ‰ Moduleï¼ˆåŒ…è£¹åï¼‰==========</span>
  <span class="hljs-string">"./src/index.js"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">module</span>, <span class="hljs-built_in">exports</span>, __webpack_require__</span>) {
    <span class="hljs-keyword">var</span> utils = <span class="hljs-title function_">__webpack_require__</span>(<span class="hljs-string">"./src/utils.js"</span>);
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(utils.<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));
  },
  <span class="hljs-string">"./src/utils.js"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">module</span>, __webpack_exports__, __webpack_require__</span>) {
    __webpack_require__.<span class="hljs-title function_">r</span>(__webpack_exports__);
    __webpack_require__.<span class="hljs-title function_">d</span>(__webpack_exports__, {
      <span class="hljs-string">"add"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) { <span class="hljs-keyword">return</span> add; }
    });
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">a, b</span>) =&gt; a + b;
  }
});
</code></pre>
<hr/>
<h3 data-id="heading-39">ç¬¬å…­ç« ï¼šWebpack è¿è¡Œæ—¶æœºåˆ¶</h3>
<blockquote>
<p><strong>æœ¬ç« è§£å†³çš„é—®é¢˜</strong>ï¼šWebpack æ‰“åŒ…åçš„ä»£ç åœ¨æµè§ˆå™¨ä¸­æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼ŸåŒæ­¥å’Œå¼‚æ­¥åŠ è½½æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</p>
</blockquote>
<h4 data-id="heading-40">6.1 åŒæ­¥åŠ è½½ï¼š<code>__webpack_require__</code></h4>
<pre><code class="hljs language-java" lang="java">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    __webpack_require__(moduleId) æµç¨‹                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚                         require(<span class="hljs-string">'./utils.js'</span>)                           â”‚
â”‚                                   â”‚                                     â”‚
â”‚                                   â–¼                                     â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                    â”‚   æ£€æŸ¥ installedModules      â”‚                     â”‚
â”‚                    â”‚   æ˜¯å¦æœ‰ç¼“å­˜ï¼Ÿ                â”‚                     â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                           â”‚                                             â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚              â”‚ YES                     â”‚ NO                             â”‚
â”‚              â–¼                         â–¼                                â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚      â”‚ ç›´æ¥è¿”å›     â”‚         â”‚ åˆ›å»º <span class="hljs-keyword">module</span> å¯¹è±¡     â”‚                   â”‚
â”‚      â”‚ ç¼“å­˜çš„       â”‚         â”‚ {                   â”‚                   â”‚
â”‚      â”‚ <span class="hljs-keyword">exports</span>     â”‚         â”‚   i: moduleId,      â”‚                   â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   l: <span class="hljs-literal">false</span>,         â”‚                   â”‚
â”‚                              â”‚   <span class="hljs-keyword">exports</span>: {}       â”‚                   â”‚
â”‚                              â”‚ }                   â”‚                   â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                        â”‚                                â”‚
â”‚                                        â–¼                                â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                              â”‚ æ”¾å…¥ç¼“å­˜             â”‚                   â”‚
â”‚                              â”‚ installedModules    â”‚                   â”‚
â”‚                              â”‚ [moduleId] = <span class="hljs-keyword">module</span> â”‚                   â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                        â”‚                                â”‚
â”‚                                        â–¼                                â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                              â”‚ æ‰§è¡Œæ¨¡å—å‡½æ•°         â”‚                   â”‚
â”‚                              â”‚ modules[moduleId]   â”‚                   â”‚
â”‚                              â”‚ .call(...)          â”‚                   â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                        â”‚                                â”‚
â”‚                                        â–¼                                â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                              â”‚ <span class="hljs-keyword">module</span>.l = <span class="hljs-literal">true</span>     â”‚                   â”‚
â”‚                              â”‚ è¿”å› <span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> â”‚                   â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h4 data-id="heading-41">6.2 å¼‚æ­¥åŠ è½½ï¼š<code>__webpack_require__.e</code></h4>
<p>åŠ¨æ€ <code>import()</code> ä¼šè¢«è½¬æ¢ä¸º <code>__webpack_require__.e</code>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æºä»£ç </span>
<span class="hljs-keyword">import</span>(<span class="hljs-string">'./lazy'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">module</span> =&gt;</span> {
  <span class="hljs-variable language_">module</span>.<span class="hljs-title function_">doSomething</span>();
});

<span class="hljs-comment">// ç¼–è¯‘å</span>
__webpack_require__.<span class="hljs-title function_">e</span>(<span class="hljs-comment">/* chunkId */</span> <span class="hljs-string">'lazy'</span>)
  .<span class="hljs-title function_">then</span>(__webpack_require__.<span class="hljs-title function_">bind</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">'./src/lazy.js'</span>))
  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">module</span> =&gt;</span> {
    <span class="hljs-variable language_">module</span>.<span class="hljs-title function_">doSomething</span>();
  });
</code></pre>
<p><strong><code>__webpack_require__.e</code> å®ç°åŸç†</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// Chunk åŠ è½½çŠ¶æ€</span>
<span class="hljs-comment">// undefined: æœªåŠ è½½</span>
<span class="hljs-comment">// [resolve, reject]: æ­£åœ¨åŠ è½½</span>
<span class="hljs-comment">// 0: å·²åŠ è½½</span>
<span class="hljs-keyword">var</span> installedChunks = {};

__webpack_require__.<span class="hljs-property">e</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">chunkId</span>) {
  <span class="hljs-keyword">var</span> promises = [];

  <span class="hljs-keyword">var</span> installedChunkData = installedChunks[chunkId];

  <span class="hljs-comment">// 0 è¡¨ç¤ºå·²åŠ è½½</span>
  <span class="hljs-keyword">if</span> (installedChunkData !== <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// æ­£åœ¨åŠ è½½ä¸­ï¼Œå¤ç”¨ Promise</span>
    <span class="hljs-keyword">if</span> (installedChunkData) {
      promises.<span class="hljs-title function_">push</span>(installedChunkData[<span class="hljs-number">2</span>]);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// åˆ›å»ºæ–°çš„ Promise</span>
      <span class="hljs-keyword">var</span> promise = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">resolve, reject</span>) {
        installedChunkData = installedChunks[chunkId] = [resolve, reject];
      });
      promises.<span class="hljs-title function_">push</span>(installedChunkData[<span class="hljs-number">2</span>] = promise);

      <span class="hljs-comment">// åˆ›å»º script æ ‡ç­¾</span>
      <span class="hljs-keyword">var</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'script'</span>);
      script.<span class="hljs-property">charset</span> = <span class="hljs-string">'utf-8'</span>;
      script.<span class="hljs-property">timeout</span> = <span class="hljs-number">120</span>;
      script.<span class="hljs-property">src</span> = __webpack_require__.<span class="hljs-property">p</span> + chunkId + <span class="hljs-string">'.bundle.js'</span>;

      <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span>.<span class="hljs-title function_">appendChild</span>(script);
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises);
};
</code></pre>
<h4 data-id="heading-42">6.3 å¼‚æ­¥ Chunk çš„æ³¨å†Œï¼ˆJSONPï¼‰</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// lazy.chunk.jsï¼ˆå¼‚æ­¥ chunk æ–‡ä»¶æ ¼å¼ï¼‰</span>
(<span class="hljs-variable language_">window</span>[<span class="hljs-string">"webpackJsonp"</span>] = <span class="hljs-variable language_">window</span>[<span class="hljs-string">"webpackJsonp"</span>] || []).<span class="hljs-title function_">push</span>([
  [<span class="hljs-string">"lazy"</span>],  <span class="hljs-comment">// chunkIds</span>
  {          <span class="hljs-comment">// modules</span>
    <span class="hljs-string">"./src/lazy.js"</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-variable language_">module</span>, <span class="hljs-built_in">exports</span></span>) {
      <span class="hljs-built_in">exports</span>.<span class="hljs-property">doSomething</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"lazy loaded!"</span>);
      };
    }
  }
]);
</code></pre>
<p><strong>ä¸» bundle ä¸­çš„ JSONP å›è°ƒæ³¨å†Œ</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ³¨å†Œ JSONP å›è°ƒ</span>
<span class="hljs-keyword">var</span> jsonpArray = <span class="hljs-variable language_">window</span>[<span class="hljs-string">"webpackJsonp"</span>] = <span class="hljs-variable language_">window</span>[<span class="hljs-string">"webpackJsonp"</span>] || [];
<span class="hljs-keyword">var</span> oldJsonpFunction = jsonpArray.<span class="hljs-property">push</span>.<span class="hljs-title function_">bind</span>(jsonpArray);

jsonpArray.<span class="hljs-property">push</span> = webpackJsonpCallback;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">webpackJsonpCallback</span>(<span class="hljs-params">data</span>) {
  <span class="hljs-keyword">var</span> chunkIds = data[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">var</span> moreModules = data[<span class="hljs-number">1</span>];

  <span class="hljs-comment">// å°†æ–°æ¨¡å—æ·»åŠ åˆ° modules å¯¹è±¡</span>
  <span class="hljs-keyword">for</span> (moduleId <span class="hljs-keyword">in</span> moreModules) {
    modules[moduleId] = moreModules[moduleId];
  }

  <span class="hljs-comment">// æ ‡è®° chunk å·²åŠ è½½ï¼Œæ‰§è¡Œ resolve</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; chunkIds.<span class="hljs-property">length</span>; i++) {
    <span class="hljs-keyword">var</span> chunkId = chunkIds[i];
    <span class="hljs-keyword">if</span> (installedChunks[chunkId]) {
      installedChunks[chunkId][<span class="hljs-number">0</span>]();  <span class="hljs-comment">// resolve</span>
    }
    installedChunks[chunkId] = <span class="hljs-number">0</span>;     <span class="hljs-comment">// æ ‡è®°å·²åŠ è½½</span>
  }
}
</code></pre>
<h4 data-id="heading-43">6.4 è¿è¡Œæ—¶æµç¨‹æ€»è§ˆ</h4>
<pre><code class="hljs language-xml" lang="xml">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          è¿è¡Œæ—¶å®Œæ•´æµç¨‹                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  é¡µé¢åŠ è½½                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"main.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>                                 â”‚   â”‚
â”‚  â”‚ <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"vendor.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â–¼                                          â”‚
â”‚  åˆå§‹åŒ– Runtime                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ åˆ›å»º installedModules ç¼“å­˜                                     â”‚   â”‚
â”‚  â”‚ â€¢ åˆ›å»º installedChunks ç¼“å­˜                                      â”‚   â”‚
â”‚  â”‚ â€¢ å®šä¹‰ __webpack_require__ å‡½æ•°                                  â”‚   â”‚
â”‚  â”‚ â€¢ æ³¨å†Œ JSONP å›è°ƒ                                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â–¼                                          â”‚
â”‚  æ‰§è¡Œå…¥å£æ¨¡å—                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ __webpack_require__("./src/index.js")                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚                                          â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚               â”‚                             â”‚                           â”‚
â”‚               â–¼                             â–¼                           â”‚
â”‚  åŒæ­¥ä¾èµ–                              å¼‚æ­¥ä¾èµ–                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚__webpack_require__ â”‚            â”‚__webpack_require__.eâ”‚              â”‚
â”‚  â”‚ ä» modules å–      â”‚            â”‚ åˆ›å»º script æ ‡ç­¾   â”‚              â”‚
â”‚  â”‚ æ‰§è¡Œ + ç¼“å­˜        â”‚            â”‚ åŠ è½½ chunk æ–‡ä»¶    â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                             â”‚                           â”‚
â”‚                                             â–¼                           â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                                    â”‚ JSONP å›è°ƒ         â”‚              â”‚
â”‚                                    â”‚ æ³¨å†Œæ–° modules     â”‚              â”‚
â”‚                                    â”‚ resolve Promise    â”‚              â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                             â”‚                           â”‚
â”‚                                             â–¼                           â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚                                    â”‚__webpack_require__ â”‚              â”‚
â”‚                                    â”‚ æ‰§è¡Œå¼‚æ­¥æ¨¡å—       â”‚              â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<hr/>
<h3 data-id="heading-44">ç¬¬ä¸ƒç« ï¼šä¼˜åŒ–ç­–ç•¥ä¸æœ€ä½³å®è·µ</h3>
<blockquote>
<p><strong>æœ¬ç« è§£å†³çš„é—®é¢˜</strong>ï¼šå¦‚ä½•åˆ©ç”¨ ESM çš„é™æ€ç‰¹æ€§å’Œ Webpack çš„ä¼˜åŒ–èƒ½åŠ›ï¼Œå®ç°æœ€ä½³çš„æ„å»ºæ•ˆæœï¼Ÿ</p>
</blockquote>
<h4 data-id="heading-45">7.1 Tree Shaking åŸç†</h4>
<p><strong>Tree Shaking</strong>ï¼šç§»é™¤ JavaScript ä¸­æœªä½¿ç”¨çš„ä»£ç ï¼ˆDead Code Eliminationï¼‰</p>
<pre><code class="hljs language-javascript" lang="javascript">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                <span class="hljs-title class_">Tree</span> <span class="hljs-title class_">Shaking</span> å·¥ä½œåŸç†                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  æºä»£ç ï¼ˆmath.<span class="hljs-property">js</span>ï¼‰                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">a, b</span>) =&gt; a + b;      <span class="hljs-comment">// è¢«ä½¿ç”¨              â”‚</span>
â”‚  <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">sub</span> = (<span class="hljs-params">a, b</span>) =&gt; a - b;      <span class="hljs-comment">// æœªä½¿ç”¨              â”‚</span>
â”‚  <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">mul</span> = (<span class="hljs-params">a, b</span>) =&gt; a * b;      <span class="hljs-comment">// æœªä½¿ç”¨              â”‚</span>
â”‚                                                                  â”‚
â”‚  ä½¿ç”¨æ–¹ï¼ˆindex.<span class="hljs-property">js</span>ï¼‰                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  <span class="hljs-keyword">import</span> { add } <span class="hljs-keyword">from</span> <span class="hljs-string">'./math.js'</span>;                                â”‚
â”‚  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));                                         â”‚
â”‚                                                                  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  é˜¶æ®µ <span class="hljs-number">1</span>: <span class="hljs-title class_">Webpack</span> æ ‡è®°ï¼ˆ<span class="hljs-title class_">Mark</span> <span class="hljs-title class_">Phase</span>ï¼‰                      â”‚    â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚    â”‚
â”‚  â”‚  åˆ†æ <span class="hljs-keyword">import</span> è¯­å¥ â†’ æ ‡è®° add ä¸º<span class="hljs-string">"å·²ä½¿ç”¨"</span>                  â”‚    â”‚
â”‚  â”‚  sub, mul æ²¡æœ‰è¢«ä»»ä½• <span class="hljs-keyword">import</span> â†’ æ ‡è®°ä¸º<span class="hljs-string">"æœªä½¿ç”¨"</span>             â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  ç”Ÿæˆä»£ç ï¼ˆå¸¦æ ‡è®°ï¼‰ï¼š                                    â”‚    â”‚
â”‚  â”‚  __webpack_require__.<span class="hljs-title function_">d</span>(<span class="hljs-built_in">exports</span>, { <span class="hljs-attr">add</span>: <span class="hljs-function">() =&gt;</span> add });     â”‚    â”‚
â”‚  â”‚  <span class="hljs-comment">/* unused harmony export sub */</span>                         â”‚    â”‚
â”‚  â”‚  <span class="hljs-comment">/* unused harmony export mul */</span>                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  é˜¶æ®µ <span class="hljs-number">2</span>: <span class="hljs-title class_">Terser</span> åˆ é™¤ï¼ˆ<span class="hljs-title class_">Sweep</span> <span class="hljs-title class_">Phase</span>ï¼‰                      â”‚    â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚    â”‚
â”‚  â”‚  è¯†åˆ« unused æ ‡è®° â†’ è¿™äº›å˜é‡æ²¡æœ‰è¢«å¼•ç”¨                   â”‚    â”‚
â”‚  â”‚  å®‰å…¨åˆ é™¤ sub å’Œ mul çš„å®šä¹‰                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚                                                                  â”‚
â”‚  æœ€ç»ˆ <span class="hljs-title class_">Bundle</span>                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">a, b</span>) =&gt; a + b;  <span class="hljs-comment">// åªä¿ç•™ addï¼                   â”‚</span>
â”‚  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));                                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<p><strong>Tree Shaking ç”Ÿæ•ˆæ¡ä»¶</strong>ï¼š</p>



































<table><thead><tr><th>æ¡ä»¶</th><th>è¯´æ˜</th><th>åŸå› </th></tr></thead><tbody><tr><td>ä½¿ç”¨ ESM</td><td><code>import</code>/<code>export</code> è¯­æ³•</td><td>é™æ€åˆ†æçš„å‰æ</td></tr><tr><td>production æ¨¡å¼</td><td>æˆ– <code>usedExports: true</code></td><td>å¯ç”¨æ ‡è®°åŠŸèƒ½</td></tr><tr><td>å£°æ˜æ— å‰¯ä½œç”¨</td><td><code>sideEffects: false</code></td><td>å‘Šè¯‰æ‰“åŒ…å·¥å…·å¯å®‰å…¨åˆ é™¤</td></tr><tr><td>å¯ç”¨å‹ç¼©</td><td>Terser/UglifyJS</td><td>å®é™…åˆ é™¤ä»£ç </td></tr><tr><td>é¿å…æ•´ä½“å¯¼å…¥</td><td>ç”¨ <code>{ a }</code> ä¸ç”¨ <code>* as</code></td><td>æ˜ç¡®ä½¿ç”¨èŒƒå›´</td></tr></tbody></table>
<h4 data-id="heading-46">7.2 sideEffects é…ç½®</h4>
<p><strong>ä»€ä¹ˆæ˜¯å‰¯ä½œç”¨ï¼Ÿ</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœ‰å‰¯ä½œç”¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-comment">// polyfill.js - ä¿®æ”¹å…¨å±€å¯¹è±¡</span>
<span class="hljs-title class_">Array</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>.<span class="hljs-property">myMethod</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"/>) {};

<span class="hljs-comment">// analytics.js - æ‰§è¡Œæ—¶å‘é€è¯·æ±‚</span>
<span class="hljs-title function_">fetch</span>(<span class="hljs-string">'/api/track?page=home'</span>);

<span class="hljs-comment">// styles.css - å½±å“é¡µé¢æ ·å¼</span>
.<span class="hljs-property">button</span> { <span class="hljs-attr">color</span>: red; }

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ— å‰¯ä½œç”¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-comment">// utils.js - çº¯å‡½æ•°ï¼Œä¸å½±å“å¤–éƒ¨</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">a, b</span>) =&gt; a + b;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">format</span> = (<span class="hljs-params">str</span>) =&gt; str.<span class="hljs-title function_">trim</span>();
</code></pre>
<p><strong>package.json é…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"my-library"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"sideEffects"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"my-library"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"sideEffects"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"*.css"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"*.scss"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"./src/polyfill.js"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-47">7.3 ä»£ç åˆ†å‰²ç­–ç•¥ï¼ˆSplitChunksï¼‰</h4>
<p><strong>é»˜è®¤é…ç½®è¯¦è§£</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">optimization</span>: {
  <span class="hljs-attr">splitChunks</span>: {
    <span class="hljs-comment">// å¯¹å“ªäº› chunk ç”Ÿæ•ˆ</span>
    <span class="hljs-comment">// 'async': åªå¤„ç†å¼‚æ­¥ chunkï¼ˆé»˜è®¤ï¼‰</span>
    <span class="hljs-comment">// 'initial': åªå¤„ç†å…¥å£ chunk</span>
    <span class="hljs-comment">// 'all': å¤„ç†æ‰€æœ‰ chunkï¼ˆæ¨èï¼‰</span>
    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'async'</span>,

    <span class="hljs-comment">// åˆ†å‰²é˜ˆå€¼</span>
    <span class="hljs-attr">minSize</span>: <span class="hljs-number">20000</span>,           <span class="hljs-comment">// æœ€å° 20KB æ‰åˆ†å‰²</span>
    <span class="hljs-attr">minRemainingSize</span>: <span class="hljs-number">0</span>,      <span class="hljs-comment">// åˆ†å‰²åå‰©ä½™æœ€å°ä½“ç§¯</span>
    <span class="hljs-attr">minChunks</span>: <span class="hljs-number">1</span>,             <span class="hljs-comment">// æœ€å°‘è¢«å¼•ç”¨ 1 æ¬¡</span>

    <span class="hljs-comment">// å¹¶è¡Œè¯·æ±‚é™åˆ¶</span>
    <span class="hljs-attr">maxAsyncRequests</span>: <span class="hljs-number">30</span>,     <span class="hljs-comment">// æŒ‰éœ€åŠ è½½æ—¶æœ€å¤§å¹¶è¡Œè¯·æ±‚æ•°</span>
    <span class="hljs-attr">maxInitialRequests</span>: <span class="hljs-number">30</span>,   <span class="hljs-comment">// å…¥å£ç‚¹æœ€å¤§å¹¶è¡Œè¯·æ±‚æ•°</span>

    <span class="hljs-comment">// ç¼“å­˜ç»„ï¼ˆæ ¸å¿ƒé…ç½®ï¼‰</span>
    <span class="hljs-attr">cacheGroups</span>: {
      <span class="hljs-comment">// ç¬¬ä¸‰æ–¹åº“</span>
      <span class="hljs-attr">defaultVendors</span>: {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,
        <span class="hljs-attr">priority</span>: -<span class="hljs-number">10</span>,
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
      },
      <span class="hljs-comment">// å…¬å…±æ¨¡å—</span>
      <span class="hljs-attr">default</span>: {
        <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>,
        <span class="hljs-attr">priority</span>: -<span class="hljs-number">20</span>,
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
      },
    },
  },
}
</code></pre>
<p><strong>æ¨èé…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-attr">optimization</span>: {
  <span class="hljs-attr">splitChunks</span>: {
    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
    <span class="hljs-attr">cacheGroups</span>: {
      <span class="hljs-comment">// React å…¨å®¶æ¡¶å•ç‹¬æ‰“åŒ…</span>
      <span class="hljs-attr">react</span>: {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/](react|react-dom|react-router)[\\/]/</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'react-vendor'</span>,
        <span class="hljs-attr">priority</span>: <span class="hljs-number">20</span>,
        <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
      },
      <span class="hljs-comment">// å…¶ä»–ç¬¬ä¸‰æ–¹åº“</span>
      <span class="hljs-attr">vendors</span>: {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'vendors'</span>,
        <span class="hljs-attr">priority</span>: <span class="hljs-number">10</span>,
        <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>,
      },
      <span class="hljs-comment">// ä¸šåŠ¡å…¬å…±æ¨¡å—</span>
      <span class="hljs-attr">common</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'common'</span>,
        <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>,
        <span class="hljs-attr">priority</span>: <span class="hljs-number">5</span>,
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
      },
    },
  },
  <span class="hljs-comment">// è¿è¡Œæ—¶ä»£ç å•ç‹¬åˆ†ç¦»ï¼ˆåˆ©äºç¼“å­˜ï¼‰</span>
  <span class="hljs-attr">runtimeChunk</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'runtime'</span>,
  },
}
</code></pre>
<h4 data-id="heading-48">7.4 æ¨¡å—è¾“å‡ºæ ¼å¼</h4>















































<table><thead><tr><th>æ ¼å¼</th><th>å¯¼å‡ºè¯­æ³•</th><th>ä½¿ç”¨åœºæ™¯</th><th>Tree Shaking</th></tr></thead><tbody><tr><td><code>var</code></td><td><code>var MyLib = ...</code></td><td>å…¨å±€å˜é‡</td><td>âŒ</td></tr><tr><td><code>commonjs</code></td><td><code>exports.MyLib = ...</code></td><td>Node.js</td><td>âŒ</td></tr><tr><td><code>commonjs2</code></td><td><code>module.exports = ...</code></td><td>Node.js</td><td>âŒ</td></tr><tr><td><code>amd</code></td><td><code>define([], factory)</code></td><td>RequireJS</td><td>âŒ</td></tr><tr><td><code>umd</code></td><td>é€šç”¨æ¨¡å—å®šä¹‰</td><td>å¤šç¯å¢ƒå…¼å®¹</td><td>âŒ</td></tr><tr><td><code>module</code></td><td><code>export { ... }</code></td><td>ES Module</td><td>âœ…</td></tr></tbody></table>
<p><strong>å¤šæ ¼å¼è¾“å‡ºé…ç½®</strong>ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// webpack.config.js - åŒæ—¶è¾“å‡ºå¤šç§æ ¼å¼</span>
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = [
  <span class="hljs-comment">// ESM ç‰ˆæœ¬ï¼ˆç°ä»£ç¯å¢ƒï¼Œæ”¯æŒ Tree Shakingï¼‰</span>
  {
    <span class="hljs-attr">entry</span>: <span class="hljs-string">'./src/index.js'</span>,
    <span class="hljs-attr">experiments</span>: { <span class="hljs-attr">outputModule</span>: <span class="hljs-literal">true</span> },
    <span class="hljs-attr">output</span>: {
      <span class="hljs-attr">filename</span>: <span class="hljs-string">'my-library.esm.js'</span>,
      <span class="hljs-attr">library</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'module'</span> },
    },
  },
  <span class="hljs-comment">// CommonJS ç‰ˆæœ¬ï¼ˆNode.jsï¼‰</span>
  {
    <span class="hljs-attr">entry</span>: <span class="hljs-string">'./src/index.js'</span>,
    <span class="hljs-attr">output</span>: {
      <span class="hljs-attr">filename</span>: <span class="hljs-string">'my-library.cjs.js'</span>,
      <span class="hljs-attr">library</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">'commonjs2'</span> },
    },
  },
  <span class="hljs-comment">// UMD ç‰ˆæœ¬ï¼ˆæµè§ˆå™¨ç›´æ¥å¼•ç”¨ï¼‰</span>
  {
    <span class="hljs-attr">entry</span>: <span class="hljs-string">'./src/index.js'</span>,
    <span class="hljs-attr">output</span>: {
      <span class="hljs-attr">filename</span>: <span class="hljs-string">'my-library.umd.js'</span>,
      <span class="hljs-attr">library</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">'MyLibrary'</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">'umd'</span> },
      <span class="hljs-attr">globalObject</span>: <span class="hljs-string">'this'</span>,
    },
  },
];
</code></pre>
<p><strong>å¯¹åº” package.json</strong>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"my-library"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"main"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/my-library.cjs.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/my-library.esm.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"browser"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/my-library.umd.js"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"exports"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"."</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"import"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/my-library.esm.js"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"require"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./dist/my-library.cjs.js"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"sideEffects"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 data-id="heading-49">7.5 æœ€ä½³å®è·µæ±‡æ€»</h4>
<h5 data-id="heading-50">æ¨¡å—è§„èŒƒé€‰æ‹©</h5>
<pre><code class="hljs">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ¨¡å—è§„èŒƒé€‰æ‹©æŒ‡å—                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚   â”‚ æ–°é¡¹ç›®ï¼Ÿ        â”‚                                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚            â”‚                                                    â”‚
â”‚      æ˜¯ â†â”€â”€â”´â”€â”€â†’ å¦                                              â”‚
â”‚      â”‚          â”‚                                               â”‚
â”‚      â–¼          â–¼                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚   â”‚ ESM  â”‚   â”‚ éœ€è¦å…¼å®¹è€ç¯å¢ƒï¼Ÿ â”‚                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                       â”‚                                         â”‚
â”‚                 æ˜¯ â†â”€â”€â”´â”€â”€â†’ å¦                                   â”‚
â”‚                 â”‚          â”‚                                    â”‚
â”‚                 â–¼          â–¼                                    â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚              â”‚ UMD â”‚    â”‚ ESM  â”‚                                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚                                                                 â”‚
â”‚   å‘å¸ƒ npm åŒ…ï¼Ÿ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ åŒæ—¶æä¾› ESM + CJS                â”‚
â”‚                                                                 â”‚
â”‚   CDN ç›´æ¥å¼•ç”¨ï¼Ÿ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ UMD                               â”‚
â”‚                                                                 â”‚
â”‚   éœ€è¦ Tree Shakingï¼Ÿ â”€â”€â”€â”€â”€â”€â†’ ESMï¼ˆå¿…é¡»ï¼‰                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h5 data-id="heading-51">å¯¼å…¥æœ€ä½³å®è·µ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ä¸æ¨èï¼šå¯¼å…¥æ•´ä¸ªåº“</span>
<span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash'</span>;
_.<span class="hljs-title function_">map</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x * <span class="hljs-number">2</span>);

<span class="hljs-comment">// âœ… æ¨èï¼šæŒ‰éœ€å¯¼å…¥</span>
<span class="hljs-keyword">import</span> { map } <span class="hljs-keyword">from</span> <span class="hljs-string">'lodash-es'</span>;
<span class="hljs-title function_">map</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x * <span class="hljs-number">2</span>);

<span class="hljs-comment">// âŒ ä¸æ¨èï¼šå‘½åç©ºé—´å¯¼å…¥ï¼ˆé˜»æ­¢ Tree Shakingï¼‰</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> utils <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;
utils.<span class="hljs-title function_">format</span>(str);

<span class="hljs-comment">// âœ… æ¨èï¼šå…·åå¯¼å…¥</span>
<span class="hljs-keyword">import</span> { format } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils'</span>;
<span class="hljs-title function_">format</span>(str);

<span class="hljs-comment">// âœ… æ‡’åŠ è½½ï¼šå¤§æ¨¡å—åŠ¨æ€å¯¼å…¥</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">loadChart</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> { <span class="hljs-title class_">Chart</span> } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'./chart'</span>);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chart</span>();
};
</code></pre>
<h5 data-id="heading-52">CommonJS è¿ç§»åˆ° ESM</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CommonJS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> { myFunc } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./utils'</span>);

<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = { a, b };
<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>.<span class="hljs-property">c</span> = c;

<span class="hljs-comment">// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ESM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;
<span class="hljs-keyword">import</span> { myFunc } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils.js'</span>;  <span class="hljs-comment">// æ³¨æ„æ‰©å±•åï¼</span>

<span class="hljs-keyword">export</span> { a, b };
<span class="hljs-keyword">export</span> { c };

<span class="hljs-comment">// __dirname/__filename æ›¿ä»£æ–¹æ¡ˆ</span>
<span class="hljs-keyword">import</span> { fileURLToPath } <span class="hljs-keyword">from</span> <span class="hljs-string">'url'</span>;
<span class="hljs-keyword">import</span> { dirname } <span class="hljs-keyword">from</span> <span class="hljs-string">'path'</span>;

<span class="hljs-keyword">const</span> __filename = <span class="hljs-title function_">fileURLToPath</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">url</span>);
<span class="hljs-keyword">const</span> __dirname = <span class="hljs-title function_">dirname</span>(__filename);
</code></pre>
<hr/>
<h3 data-id="heading-53">é™„å½•ï¼šæ ¸å¿ƒæ¦‚å¿µé€ŸæŸ¥è¡¨</h3>
<h4 data-id="heading-54">A. æ¨¡å—è§„èŒƒå¯¹æ¯”</h4>








































<table><thead><tr><th>ç‰¹æ€§</th><th>CommonJS</th><th>ESM</th></tr></thead><tbody><tr><td>è¯­æ³•</td><td>require/exports</td><td>import/export</td></tr><tr><td>åŠ è½½æ—¶æœº</td><td>è¿è¡Œæ—¶</td><td>ç¼–è¯‘æ—¶</td></tr><tr><td>ç»‘å®šç±»å‹</td><td>å€¼æ‹·è´</td><td>å®æ—¶ç»‘å®š</td></tr><tr><td>é™æ€åˆ†æ</td><td>âŒ</td><td>âœ…</td></tr><tr><td>Tree Shaking</td><td>âŒ</td><td>âœ…</td></tr><tr><td>é¡¶å±‚ await</td><td>âŒ</td><td>âœ…</td></tr></tbody></table>
<h4 data-id="heading-55">B. Webpack æ„å»ºé˜¶æ®µ</h4>



































<table><thead><tr><th>é˜¶æ®µ</th><th>æ ¸å¿ƒä»»åŠ¡</th><th>å…³é”® Hook</th></tr></thead><tbody><tr><td><strong>Initialize</strong></td><td>åˆå¹¶é…ç½®ã€åˆ›å»º Compilerã€æ³¨å†Œ Plugin</td><td><code>environment</code></td></tr><tr><td><strong>Make</strong></td><td>ä» Entry é€’å½’è§£æï¼Œæ‰§è¡Œ Loaderï¼Œæ„å»º ModuleGraph</td><td><code>make</code></td></tr><tr><td><strong>Seal</strong></td><td>ç”Ÿæˆ Chunkã€æ‰§è¡Œ SplitChunksã€ç”Ÿæˆä»£ç </td><td><code>optimizeChunks</code></td></tr><tr><td><strong>Optimize</strong></td><td>Tree Shakingã€å‹ç¼©æ··æ·†</td><td><code>optimizeTree</code></td></tr><tr><td><strong>Emit</strong></td><td>è¾“å‡º Bundle æ–‡ä»¶</td><td><code>emit</code></td></tr></tbody></table>
<h4 data-id="heading-56">C. è¿è¡Œæ—¶æœºåˆ¶</h4>





























<table><thead><tr><th>æœºåˆ¶</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>__webpack_require__</code></td><td>åŒæ­¥åŠ è½½æ¨¡å—ï¼Œä» modules å¯¹è±¡å–å¹¶æ‰§è¡Œ</td></tr><tr><td><code>__webpack_require__.e</code></td><td>å¼‚æ­¥åŠ è½½ Chunkï¼ŒåŠ¨æ€åˆ›å»º script æ ‡ç­¾</td></tr><tr><td><code>installedModules</code></td><td>æ¨¡å—ç¼“å­˜ï¼Œé¿å…é‡å¤æ‰§è¡Œ</td></tr><tr><td><code>installedChunks</code></td><td>Chunk ç¼“å­˜ï¼Œé¿å…é‡å¤åŠ è½½</td></tr><tr><td><code>webpackJsonp</code></td><td>JSONP å›è°ƒï¼Œæ³¨å†Œå¼‚æ­¥ Chunk çš„æ¨¡å—</td></tr></tbody></table>
<h4 data-id="heading-57">D. çŸ¥è¯†ä½“ç³»ä¸€å›¾æ€»ç»“</h4>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚                    JavaScript æ¨¡å—åŒ–çŸ¥è¯†ä½“ç³»                                 â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   å†å²æ¼”è¿›                                                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â”‚
â”‚   å…¨å±€å˜é‡ â†’ <span class="hljs-built_in">CommonJS</span>(Node) â†’ <span class="hljs-built_in">AMD</span>(æµè§ˆå™¨) â†’ <span class="hljs-built_in">UMD</span>(é€šç”¨) â†’ <span class="hljs-built_in">ESM</span>(æ ‡å‡†)            â”‚
â”‚                                                                              â”‚
â”‚   æ ¸å¿ƒåŒºåˆ«                                                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â”‚
â”‚   CommonJS: è¿è¡Œæ—¶åŠ è½½ï¼Œå€¼æ‹·è´ï¼ŒåŠ¨æ€è·¯å¾„ â†’ æ— æ³• Tree Shaking                 â”‚
â”‚   ESM:      ç¼–è¯‘æ—¶åˆ†æï¼Œå¼•ç”¨ç»‘å®šï¼Œé™æ€è·¯å¾„ â†’ æ”¯æŒ Tree Shaking               â”‚
â”‚                                                                              â”‚
â”‚   ESM ä¸‰é˜¶æ®µ                                                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚   æ„å»º(è§£æä¾èµ–) â†’ å®ä¾‹åŒ–(åˆ†é…å†…å­˜/è¿æ¥ç»‘å®š) â†’ æ±‚å€¼(æ‰§è¡Œä»£ç )                â”‚
â”‚                                                                              â”‚
â”‚   æ„å»ºå·¥å…·é“¾                                                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚   æºç (ESM) â†’ <span class="hljs-built_in">Babel</span>(ä¿ç•™ESM,è½¬è¯­æ³•) â†’ <span class="hljs-built_in">Webpack</span>(æ‰“åŒ…,æ ‡è®°) â†’ <span class="hljs-built_in">Terser</span>(åˆ é™¤,å‹ç¼©) â”‚
â”‚                                                                              â”‚
â”‚   Webpack æ ¸å¿ƒ                                                               â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                               â”‚
â”‚   <span class="hljs-built_in">Module</span>(æºæ–‡ä»¶) â†’ <span class="hljs-built_in">Chunk</span>(ä¸­é—´æ€) â†’ <span class="hljs-built_in">Bundle</span>(äº§ç‰©)                              â”‚
â”‚   <span class="hljs-built_in">Make</span>(æ„å»ºModuleGraph) â†’ <span class="hljs-built_in">Seal</span>(ç”ŸæˆChunk) â†’ <span class="hljs-built_in">Emit</span>(è¾“å‡ºæ–‡ä»¶)                   â”‚
â”‚                                                                              â”‚
â”‚   æœ€ä½³å®è·µ                                                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â”‚
â”‚   â€¢ æ–°é¡¹ç›®é¦–é€‰ ESM                                                           â”‚
â”‚   â€¢ npm åŒ…åŒæ—¶æä¾› ESM + CJS                                                 â”‚
â”‚   â€¢ æŒ‰éœ€å¯¼å…¥ï¼Œé¿å… import *                                                  â”‚
â”‚   â€¢ é…ç½® sideEffects: false                                                  â”‚
â”‚   â€¢ å¤§æ¨¡å—ä½¿ç”¨åŠ¨æ€ <span class="hljs-built_in">import</span>() æ‡’åŠ è½½                                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[docker+nginxéƒ¨ç½²]]></title>    <link>https://juejin.cn/post/7593262196843708468</link>    <guid>https://juejin.cn/post/7593262196843708468</guid>    <pubDate>2026-01-10T07:52:40.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593262196843708468" data-draft-id="7593240931287515188" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="docker+nginxéƒ¨ç½²"/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-10T07:52:40.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¸åŠ¡æ­£ä¸šçš„å‰ç«¯å­¦å¾’"/> <meta itemprop="url" content="https://juejin.cn/user/1640911047494430"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            docker+nginxéƒ¨ç½²
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1640911047494430/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¸åŠ¡æ­£ä¸šçš„å‰ç«¯å­¦å¾’
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T07:52:40.000Z" title="Sat Jan 10 2026 07:52:40 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong>nginx.conf</strong></p>
<pre><code class="hljs language-js" lang="js">

worker_processes  <span class="hljs-number">1</span>;

events {
    worker_connections  <span class="hljs-number">1024</span>;
}

http {
    include       mime.<span class="hljs-property">types</span>;
    default_type  application/octet-stream;
    sendfile        on;
    keepalive_timeout  <span class="hljs-number">65</span>;
    server {
        listen       <span class="hljs-number">80</span>;
        server_name  localhost;
        

        location / {
            root   /usr/share/nginx/html;
            index  index.<span class="hljs-property">html</span> index.<span class="hljs-property">htm</span>;
        }

        error_page   <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span>  /50x.<span class="hljs-property">html</span>;
        location = /50x.<span class="hljs-property">html</span> {
            root   html;
        }
    }
}


</code></pre>
<p><strong>Dockerfile</strong></p>
<pre><code class="hljs language-js" lang="js">
#å¼•å…¥node
<span class="hljs-variable constant_">FROM</span> node <span class="hljs-keyword">as</span> build
#æ‹·è´å½“å‰æ–‡ä»¶å¤¹åˆ°dockerä¸­çš„demoæ–‡ä»¶å¤¹ï¼Œdemoæ–‡ä»¶å¤¹è‡ªåŠ¨ç”Ÿæˆ
<span class="hljs-variable constant_">COPY</span> . ./demo
#å®šä½åˆ°demoæ–‡ä»¶å¤¹
<span class="hljs-variable constant_">WORKDIR</span> /demo
#è®¾ç½®æº
<span class="hljs-variable constant_">RUN</span> npm config set registry <span class="hljs-attr">https</span>:<span class="hljs-comment">//registry.npm.taobao.org</span>
#ä¸‹è½½
<span class="hljs-variable constant_">RUN</span> npm install
#æ‰“åŒ…
<span class="hljs-variable constant_">RUN</span> npm run build
#å¼•å…¥nginx
<span class="hljs-variable constant_">FROM</span> nginx
#å¤åˆ¶é¡¹ç›®çš„nginx.<span class="hljs-property">conf</span>åˆ° /etc/nginxç›®å½•ï¼Œå¹¶ä¿®æ”¹ä¸ºæ–‡ä»¶åä¸ºnginx.<span class="hljs-property">conf</span>
<span class="hljs-variable constant_">COPY</span> nginx.<span class="hljs-property">conf</span> /etc/nginx/nginx.<span class="hljs-property">conf</span>
#å¤åˆ¶ç”Ÿæˆçš„distæ–‡ä»¶å¤¹åˆ°nginxçš„htmlç›®å½•ä¸‹
<span class="hljs-variable constant_">COPY</span> --<span class="hljs-keyword">from</span>=build /demo/dist /usr/share/nginx/html
#æ˜¾å¼åœ°æ ‡æ˜é•œåƒå¼€æ”¾ç«¯å£ï¼Œä¸€å®šç¨‹åº¦ä¸Šæä¾›äº†æ“ä½œçš„ä¾¿åˆ©ï¼Œä¹Ÿæé«˜äº† <span class="hljs-title class_">Dockerfile</span> çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§
<span class="hljs-variable constant_">EXPOSE</span> <span class="hljs-number">80</span>
#è¿è¡Œnginx
<span class="hljs-variable constant_">CMD</span> [<span class="hljs-string">"nginx"</span>,<span class="hljs-string">"-g"</span>,<span class="hljs-string">"daemon off;"</span>] 


</code></pre>
<p>é¡¹ç›®æ ¹ç›®å½•è¿è¡Œå‘½ä»¤ï¼Œæ‰“åŒ…ä¸ºé•œåƒ</p>
<pre><code class="hljs language-js" lang="js">docker image build -t vue_nginx_demo .
</code></pre>
<p>è¿è¡Œé•œåƒ</p>
<pre><code class="hljs language-js" lang="js">docker container run -p <span class="hljs-number">8090</span>:<span class="hljs-number">80</span> -d vue_nginx_demo

</code></pre>
<p>å…¶ä»–çš„è‡ªåŠ¨åŒ–ï¼Œä½¿ç”¨jenkinsæˆ–è€…k8så†™éƒ¨ç½²è„šæœ¬</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å¯åŠ¨ Taro 4 é¡¹ç›®æŠ¥é”™ï¼šError: The specified module could not be found.]]></title>    <link>https://juejin.cn/post/7593242327933485066</link>    <guid>https://juejin.cn/post/7593242327933485066</guid>    <pubDate>2026-01-10T07:59:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593242327933485066" data-draft-id="7593541290991648818" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å¯åŠ¨ Taro 4 é¡¹ç›®æŠ¥é”™ï¼šError: The specified module could not be found."/> <meta itemprop="keywords" content="å‰ç«¯"/> <meta itemprop="datePublished" content="2026-01-10T07:59:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="éœ‰è¿å…¨æ»šè›‹å¥½è¿å›´ç€è½¬"/> <meta itemprop="url" content="https://juejin.cn/user/2496369082771673"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å¯åŠ¨ Taro 4 é¡¹ç›®æŠ¥é”™ï¼šError: The specified module could not be found.
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2496369082771673/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    éœ‰è¿å…¨æ»šè›‹å¥½è¿å›´ç€è½¬
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T07:59:28.000Z" title="Sat Jan 10 2026 07:59:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>æœ€è¿‘åœ¨ Windows ä¸Š clone äº†ä¸€ä¸ªä¹‹å‰å°±å†™å¥½çš„ <strong>Taro 4.x å°ç¨‹åºé¡¹ç›®</strong>ï¼Œæœ¬åœ°ç”¨ VS Code å¯åŠ¨çš„æ—¶å€™ç›´æ¥æŠ¥é”™ï¼š</p>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-title class_">Error</span>: <span class="hljs-title class_">The</span> specified <span class="hljs-variable language_">module</span> could not be found.
â€¦/node_modules/<span class="hljs-meta">@tarojs</span>/plugin-doctor-win32-x64-msvc/
taro-doctor.<span class="hljs-property">win32</span>-x64-msvc.<span class="hljs-property">nodez</span>
</code></pre>
<p>æœ€ååœ¨taroçš„githubé‡Œé¢æ‰¾åˆ°äº†ä¸€æ ·çš„é—®é¢˜</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/de2328b66c1947dd8406cebe2c13dd73~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZyJ6L-Q5YWo5rua6JuL5aW96L-Q5Zu0552A6L2s:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768636768&amp;x-signature=rMvfUCyYeo5SYOuDZVA6HXmR8Kc%3D" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a0e2f737bfd34932a5db67481f925b8f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6ZyJ6L-Q5YWo5rua6JuL5aW96L-Q5Zu0552A6L2s:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768636768&amp;x-signature=vpkfy%2FgPwNFvNJ4lby6WTNt0HkI%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-0">åŸå› </h3>
<p><code>taro-doctor.win32-x64-msvc.node</code> æ˜¯ä¸€ä¸ª <strong>Node åŸç”Ÿæ¨¡å—</strong>ï¼Œ<br/>
åœ¨ Windows ä¸Šè¿è¡Œæ—¶ï¼Œéœ€è¦ç³»ç»Ÿé‡Œæœ‰å¯¹åº”çš„ <strong>VC++ è¿è¡Œåº“</strong>ã€‚</p>
<p>å¦‚æœç³»ç»Ÿé‡Œæ²¡æœ‰ï¼Œæˆ–è€…ç‰ˆæœ¬ä¸å®Œæ•´ï¼ŒNode åŠ è½½è¿™ä¸ª <code>.node</code> æ–‡ä»¶æ—¶å°±ä¼šç›´æ¥æŠ¥ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">The specified <span class="hljs-keyword">module</span> could <span class="hljs-keyword">not</span> be found
</code></pre>
<p>å³ä½¿æ–‡ä»¶æœ¬èº«æ˜¯å­˜åœ¨çš„ã€‚</p>
<h3 data-id="heading-1">è§£å†³æ–¹æ³•</h3>
<p>å»å¾®è½¯å®˜ç½‘ä¸‹è½½å¹¶å®‰è£…æœ€æ–°ç‰ˆçš„ <strong>Microsoft Visual C++ Redistributable</strong>ï¼š</p>
<p>é“¾æ¥ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Flearn.microsoft.com%2Fzh-cn%2Fcpp%2Fwindows%2Flatest-supported-vc-redist" target="_blank" title="https://learn.microsoft.com/zh-cn/cpp/windows/latest-supported-vc-redist" ref="nofollow noopener noreferrer">learn.microsoft.com/zh-cn/cpp/wâ€¦</a></p>
<p>è£…å®Œä¹‹å <strong>é‡å¯äº†ä¸€æ¬¡ç³»ç»Ÿ</strong>ï¼Œå†å¯åŠ¨é¡¹ç›®ï¼š</p>
<pre><code class="hljs language-arduino" lang="arduino">npm run dev
</code></pre>
<p>æ²¡æœ‰å†æŠ¥é”™ï¼Œå¯ä»¥æ­£å¸¸è¿è¡Œäº†ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¡†æ¶è®¾è®¡ï¼ˆäºŒï¼‰ï¼šç³Ÿç³•çš„ä»£ç æœ‰å“ªäº›ç‰¹ç‚¹?]]></title>    <link>https://juejin.cn/post/7592876744526233650</link>    <guid>https://juejin.cn/post/7592876744526233650</guid>    <pubDate>2026-01-09T01:38:19.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592876744526233650" data-draft-id="7592833068224299054" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¡†æ¶è®¾è®¡ï¼ˆäºŒï¼‰ï¼šç³Ÿç³•çš„ä»£ç æœ‰å“ªäº›ç‰¹ç‚¹?"/> <meta itemprop="keywords" content="å‰ç«¯,æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-09T01:38:19.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯ç‹å£®å£®"/> <meta itemprop="url" content="https://juejin.cn/user/4473272506789485"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            å‰ç«¯å‘æ¶æ„çªå›´ç³»åˆ— - æ¡†æ¶è®¾è®¡ï¼ˆäºŒï¼‰ï¼šç³Ÿç³•çš„ä»£ç æœ‰å“ªäº›ç‰¹ç‚¹?
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4473272506789485/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯ç‹å£®å£®
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:38:19.000Z" title="Fri Jan 09 2026 01:38:19 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-dark">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#abb2bf;background:#282c34}.hljs-comment,.hljs-quote{color:#5c6370;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#c678dd}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e06c75}.hljs-literal{color:#56b6c2}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#98c379}.hljs-built_in,.hljs-class .hljs-title{color:#e6c07b}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#d19a66}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#61aeee}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><blockquote>
<p><strong>å‰è¨€</strong>
ä½ æœ‰æ²¡æœ‰è¿‡è¿™ç§ç»å†ï¼šæ–°æ¥æ‰‹äº†ä¸€ä¸ªé¡¹ç›®ï¼Œäº§å“ç»ç†è®©ä½ æŠŠä¸€ä¸ªæŒ‰é’®å¾€å·¦ç§» 5 åƒç´ ã€‚ä½ å¿ƒæƒ³ï¼šâ€œè¿™ä¸æœ‰æ‰‹å°±è¡Œï¼Ÿâ€
ç»“æœä½ æ”¹äº† CSSï¼Œä¿å­˜ï¼Œåˆ·æ–°ã€‚ æŒ‰é’®æ˜¯ç§»è¿‡å»äº†ï¼Œä½†ç™»å½•å¼¹çª—æ‰“ä¸å¼€äº†ï¼Œæ§åˆ¶å°çº¢äº†ä¸€ç‰‡ï¼Œç”šè‡³ CI/CD æµç¨‹éƒ½æŒ‚äº†ã€‚</p>
<p>è¿™ä¸€åˆ»ï¼Œä½ é¢å¯¹çš„ä¸æ˜¯ä»£ç ï¼Œè€Œæ˜¯ä¸€åº§æ‘‡æ‘‡æ¬²å çš„<strong>å±å±±</strong>ã€‚
åœ¨æ¡†æ¶è®¾è®¡å’Œç»„ä»¶åº“å¼€å‘ä¸­ï¼Œè¿™ç§ç°è±¡å°¤ä¸ºè‡´å‘½ã€‚ä¸šåŠ¡ä»£ç å†™çƒ‚äº†ï¼Œå‘çš„æ˜¯ä¸€ä¸ªé¡µé¢ï¼›æ¡†æ¶è®¾è®¡å†™çƒ‚äº†ï¼Œå‘çš„æ˜¯æ•´ä¸ªå›¢é˜Ÿã€‚ä»Šå¤©æˆ‘ä»¬è¦èŠçš„ä¸æ˜¯å…·ä½“çš„å˜é‡å‘½åæˆ–ç¼©è¿›ï¼Œè€Œæ˜¯<strong>æ¶æ„å±‚é¢çš„â€œè®¾è®¡è‡­å‘³â€</strong> ã€‚</p>
</blockquote>
<p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/2b1b752cb9a54d9ba2541bf79c08082b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv546L5aOu5aOu:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768527527&amp;x-signature=3Ug%2Fp7CsV%2BF7P8t2zkMGz3ZQ16o%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯â€œè®¾è®¡è‡­å‘³â€ï¼Ÿ</h2>
<p>â€œä»£ç è‡­å‘³â€ï¼ˆCode Smellï¼‰è¿™ä¸ªè¯ä¸æ˜¯è¯´ä»£ç çœŸçš„æœ‰å‘³å„¿ï¼ˆè™½ç„¶æœ‰æ—¶å€™çœ‹ä»£ç ç¡®å®æƒ³åï¼‰ï¼Œè€Œæ˜¯æŒ‡<strong>ä»£ç ç»“æ„ä¸­æŸäº›ç‰¹å¾æš—ç¤ºäº†æ·±å±‚æ¬¡çš„è®¾è®¡é—®é¢˜</strong>ã€‚</p>
<p>å®ƒå°±åƒç…¤æ°”æ³„æ¼çš„å‘³é“ï¼Œæœ¬èº«ä¸ä¸€å®šä¼šç‚¸ï¼Œä½†åªè¦æœ‰ä¸€ç‚¹ç«æ˜Ÿï¼ˆæ–°çš„éœ€æ±‚å˜æ›´ï¼‰ï¼Œæ•´ä¸ªç³»ç»Ÿå°±ä¼šåŸåœ°å‡å¤©ã€‚</p>
<p>ä½œä¸ºå‰ç«¯æ¶æ„å¸ˆæˆ–æ ¸å¿ƒå¼€å‘è€…ï¼Œå¦‚æœä½ åœ¨ Code Review æ—¶é—»åˆ°äº†ä»¥ä¸‹è¿™ <strong>5 ç§å‘³é“</strong>ï¼Œè¯·åŠ¡å¿…è­¦æƒ•ã€‚</p>
<hr/>
<h2 data-id="heading-1">1. åƒµåŒ–æ€§ (Rigidity)ï¼šç‰µä¸€å‘è€ŒåŠ¨å…¨èº«</h2>
<p><strong>ç—‡çŠ¶ï¼š</strong> ä½ æƒ³å¤ç”¨ä¸€ä¸ªé€šç”¨çš„ <code>Header</code> ç»„ä»¶ï¼Œç»“æœå‘ç°å®ƒé‡Œé¢ç¡¬ç¼–ç äº† <code>useRouter()</code> çš„è·³è½¬é€»è¾‘ï¼Œç”šè‡³è¿˜ç›´æ¥ <code>import</code> äº† <code>Redux/Pinia</code> çš„ storeã€‚ ä½ æƒ³åœ¨å¦ä¸€ä¸ªé¡¹ç›®ç”¨å®ƒï¼Ÿæ²¡é—¨ã€‚é™¤éä½ æŠŠé‚£è¾¹çš„è·¯ç”±å’ŒçŠ¶æ€ç®¡ç†å…¨å¥—æ¬è¿‡æ¥ã€‚</p>
<p><strong>å‰ç«¯å®æˆ˜ç¿»è¯‘ï¼š</strong> è¿™å°±æ˜¯å…¸å‹çš„<strong>é«˜è€¦åˆ</strong>ã€‚ç»„ä»¶ä¸å†æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¹é«˜ç§¯æœ¨ï¼Œè€Œæ˜¯ä¸€å—ç„Šæ­»åœ¨ä¸»æ¿ä¸Šçš„èŠ¯ç‰‡ã€‚</p>
<p><strong>åé¢æ•™æ (React)ï¼š</strong></p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// è¿™æ˜¯ä¸€ä¸ªå……æ»¡åƒµåŒ–å‘³é“çš„ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">UserProfile</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-comment">// è‡´å‘½ä¼¤1ï¼šç›´æ¥ä¾èµ–å…·ä½“çš„å…¨å±€çŠ¶æ€</span>
  <span class="hljs-keyword">const</span> user = <span class="hljs-title function_">useSelector</span>(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.<span class="hljs-property">user</span>.<span class="hljs-property">info</span>);
  <span class="hljs-comment">// è‡´å‘½ä¼¤2ï¼šç›´æ¥ä¾èµ–å…·ä½“çš„è·¯ç”±å®ç°</span>
  <span class="hljs-keyword">const</span> history = <span class="hljs-title function_">useHistory</span>();

  <span class="hljs-keyword">const</span> <span class="hljs-title function_">handleLogout</span> = (<span class="hljs-params"/>) =&gt; {
     <span class="hljs-comment">// ä¸šåŠ¡é€»è¾‘è€¦åˆåœ¨UIé‡Œ</span>
     api.<span class="hljs-title function_">logout</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> history.<span class="hljs-title function_">push</span>(<span class="hljs-string">'/login'</span>));
  }

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user.name} <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleLogout}</span>&gt;</span>é€€å‡º<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
};
</code></pre>
<p><strong>æŒ‡å—ï¼š</strong></p>
<ul>
<li><strong>æ§åˆ¶åè½¬ (IoC)</strong> ï¼šç»„ä»¶åªç®¡å±•ç¤ºï¼Œé€»è¾‘é€šè¿‡ <code>Props</code> ä¼ è¿›æ¥ã€‚</li>
<li><strong>Presentational vs Container</strong>ï¼šæŠŠâ€œå±•ç¤ºç»„ä»¶â€å’Œâ€œå®¹å™¨ç»„ä»¶â€æ‹†å¼€ã€‚å±•ç¤ºç»„ä»¶è¦åƒâ€œå‚»ç“œâ€ä¸€æ ·ï¼Œç»™ä»€ä¹ˆåƒä»€ä¹ˆï¼Œä¸è¦è‡ªå·±å»å†°ç®±ï¼ˆStoreï¼‰é‡Œæ‹¿ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-2">2. è„†å¼±æ€§ (Fragility)ï¼šæ”¹ä¸œå´©è¥¿çš„è´è¶æ•ˆåº”</h2>
<p><strong>ç—‡çŠ¶ï¼š</strong> è¿™æ¯”åƒµåŒ–æ€§æ›´æå¿ƒæ€ã€‚åƒµåŒ–æ€§æ˜¯ä½ æ”¹ä¸åŠ¨ï¼Œè„†å¼±æ€§æ˜¯<strong>ä½ æ”¹äº†ï¼Œä½†å´©åœ¨äº†ä½ å®Œå…¨æƒ³ä¸åˆ°çš„åœ°æ–¹</strong>ã€‚ æ¯”å¦‚ï¼šä½ ä¸ºäº†ä¼˜åŒ–é¦–é¡µåŠ è½½é€Ÿåº¦ï¼Œè°ƒæ•´äº†ä¸€ä¸ªå…¬å…± <code>utils</code> å‡½æ•°ï¼Œç»“æœç»“ç®—é¡µé¢çš„é‡‘é¢è®¡ç®—é”™äº†ï¼Œå¤šç»™äº†ç”¨æˆ· 100 å—é’±ã€‚</p>
<p><strong>å‰ç«¯å®æˆ˜ç¿»è¯‘ï¼š</strong> é€šå¸¸æºäº<strong>éšå¼ä¾èµ–</strong>ã€<strong>å…¨å±€å˜é‡æ±¡æŸ“</strong>æˆ–è€…<strong>CSS æ ·å¼ç©¿é€</strong>ã€‚</p>
<p><strong>åé¢æ•™æ (CSS/Vue)ï¼š</strong></p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-comment">/* è¿™ç§å†™æ³•åœ¨å…¨å±€æ ·å¼é‡Œç®€ç›´æ˜¯ç¾éš¾ */</span>
<span class="hljs-selector-class">.title</span> {
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">20px</span>;
  <span class="hljs-attribute">color</span>: red;
}

<span class="hljs-comment">/* æˆ–è€…åœ¨ç»„ä»¶é‡Œæ»¥ç”¨ !important */</span>
<span class="hljs-selector-class">.btn</span> {
  <span class="hljs-attribute">background</span>: blue <span class="hljs-meta">!important</span>; <span class="hljs-comment">/* ä½ çš„åŒäº‹æƒ³è¦†ç›–è¿™ä¸ªæ ·å¼æ—¶ï¼Œå¿…é¡»å†™å¾—æ¯”ä½ æ›´æ¶å¿ƒ */</span>
}
</code></pre>
<p><strong>æŒ‡å—ï¼š</strong></p>
<ul>
<li><strong>CSS Modules / Scoped CSS / Tailwind</strong>ï¼šåšå†³æ¶ˆç­å…¨å±€æ ·å¼å†²çªã€‚</li>
<li><strong>çº¯å‡½æ•° (Pure Functions)</strong> ï¼šå·¥å…·ç±»å‡½æ•°åšå†³ä¸èƒ½æœ‰å‰¯ä½œç”¨ï¼Œè¾“å…¥ç›¸åŒï¼Œè¾“å‡ºå¿…é¡»ç›¸åŒã€‚</li>
<li><strong>ä¾èµ–æ˜¾å¼åŒ–</strong>ï¼šåˆ«åœ¨ç»„ä»¶é‡Œå·å·æ‘¸æ‘¸è¯» <code>window.xxx</code> æˆ–è€… <code>localStorage</code>ï¼ŒæŠŠå®ƒä»¬å°è£…æˆ Hooks æˆ–æœåŠ¡ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-3">3. é¡½å›ºæ€§ (Immobility)ï¼šæ— æ³•æ‹†åˆ†çš„è¿ä½“å©´</h2>
<p><strong>ç—‡çŠ¶ï¼š</strong> ä½ å†™äº†ä¸€ä¸ªéå¸¸ç‚«é…·çš„ <code>DataGrid</code> è¡¨æ ¼ï¼Œæ”¯æŒæ’åºã€ç­›é€‰ã€åˆ†é¡µã€‚éš”å£ç»„çœ‹åˆ°äº†è¯´ï¼šâ€œå“‡ï¼Œè¿™ä¸ªå¥½ï¼Œæˆ‘ä¹Ÿè¦ç”¨ã€‚â€ ä½ è‡ªä¿¡æ»¡æ»¡åœ°æŠŠä»£ç å‘ç»™ä»–ã€‚ äº”åˆ†é’Ÿåä»–è·‘æ¥è¯´ï¼šâ€œå“¥ï¼Œæˆ‘åªè¦ä¸ªè¡¨æ ¼UIï¼Œä½ ä¸ºä»€ä¹ˆæŠŠ <code>Axios</code> æ‹¦æˆªå™¨ã€<code>ElementUI</code> çš„å¼¹çª—ç»„ä»¶ã€ç”šè‡³ä½ ä»¬å…¬å¸çš„åŸ‹ç‚¹ SDK éƒ½æ‰“åŒ…è¿›æ¥äº†ï¼Ÿâ€</p>
<p><strong>å‰ç«¯å®æˆ˜ç¿»è¯‘ï¼š</strong> è¿™æ˜¯<strong>å†…èšæ€§ä½</strong>çš„è¡¨ç°ã€‚ä¸šåŠ¡é€»è¾‘å’ŒåŸºç¡€è®¾æ–½ã€UI é€»è¾‘æ··åœ¨ä¸€èµ·ï¼Œå¯¼è‡´æ ¹æœ¬æ— æ³•æ‹†åˆ†å¤ç”¨ã€‚</p>
<p><strong>åé¢æ•™æï¼š</strong></p>
<p>JavaScript</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-comment">// ä¸€ä¸ªåŸæœ¬æƒ³åšé€šç”¨ç»„ä»¶çš„ hookï¼Œå´æ··å…¥äº†ä¸šåŠ¡</span>
function <span class="hljs-built_in">useTableData</span>(url) {
  const <span class="hljs-selector-attr">[data, setData]</span> = <span class="hljs-built_in">useState</span>([]);

  <span class="hljs-built_in">useEffect</span>(() =&gt; {
    <span class="hljs-comment">// é”™è¯¯ï¼šè¿™é‡Œè€¦åˆäº†ç‰¹å®šçš„ HTTP åº“å’Œä¸šåŠ¡ä¸Šçš„ token é€»è¾‘</span>
    axios<span class="hljs-selector-class">.get</span>(url, { headers: { 'X-Auth': localStorage.getItem('token') } })
      <span class="hljs-selector-class">.then</span>(res =&gt; setData(res.data.list)); <span class="hljs-comment">// é”™è¯¯ï¼šç¡¬ç¼–ç äº†æ•°æ®ç»“æ„ res.data.list</span>
  }, <span class="hljs-selector-attr">[url]</span>);

  return data;
}
</code></pre>
<p><strong>æŒ‡å—ï¼š</strong></p>
<ul>
<li><strong>Headless UI</strong>ï¼šè¿™æ˜¯ç°åœ¨çš„è®¾è®¡è¶‹åŠ¿ï¼ˆå¦‚ React Table, TanStack Queryï¼‰ã€‚åªæä¾›é€»è¾‘é’©å­ï¼Œä¸æä¾› UIã€‚</li>
<li><strong>ä¾èµ–å€’ç½®</strong>ï¼šç½‘ç»œè¯·æ±‚å±‚åº”è¯¥ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè€Œä¸æ˜¯åœ¨ç»„ä»¶å†…éƒ¨ç›´æ¥å®ä¾‹åŒ–ã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-4">4. ç²˜æ»æ€§ (Viscosity)ï¼šåšé”™è¯¯çš„äº‹æ›´å®¹æ˜“</h2>
<p><strong>ç—‡çŠ¶ï¼š</strong> è¿™æ˜¯ä¸€ä¸ªäººæ€§é—®é¢˜ã€‚ å‡è®¾ä½ çš„æ¡†æ¶æ”¯æŒ TypeScriptã€‚</p>
<ul>
<li><strong>æ­£ç¡®çš„åšæ³•</strong>ï¼šå®šä¹‰ Interfaceï¼Œç»§æ‰¿ Propsï¼Œå¤„ç†æ³›å‹ï¼Œå†™ Mock æ•°æ®ï¼Œè·‘å•å…ƒæµ‹è¯•ã€‚éœ€è¦ 10 åˆ†é’Ÿã€‚</li>
<li><strong>é”™è¯¯çš„åšæ³•</strong>ï¼š<code>any</code> ä¸€æŠŠæ¢­ã€‚éœ€è¦ 10 ç§’é’Ÿã€‚</li>
</ul>
<p>å½“<strong>åšæ­£ç¡®çš„äº‹</strong>æ¯”<strong>åšé”™è¯¯çš„äº‹</strong>é˜»åŠ›å¤§å¾—å¤šæ—¶ï¼Œå¼€å‘è€…å°±ä¼šå€¾å‘äºç ´åæ¶æ„ã€‚è¿™å°±æ˜¯ç²˜æ»æ€§ã€‚</p>
<p><strong>å‰ç«¯å®æˆ˜ç¿»è¯‘ï¼š</strong> ç¯å¢ƒé…ç½®å¤ªå¤æ‚ã€ç±»å‹å®šä¹‰å¤ªåäººç±»ã€æµ‹è¯•éš¾å†™ã€‚</p>
<p><strong>åé¢æ•™æï¼š</strong> å¦‚æœä½ çš„ç»„ä»¶åº“è¦æ±‚ä½¿ç”¨è€…å¿…é¡»å†™ 5 å±‚åµŒå¥—çš„é…ç½®å¯¹è±¡æ‰èƒ½è·‘èµ·æ¥ï¼Œé‚£ä½¿ç”¨è€…ä¸€å®šä¼šæƒ³åŠæ³•ç»•è¿‡é…ç½®ï¼Œç›´æ¥å»æ”¹æºç ã€‚</p>
<p><strong>æŒ‡å—ï¼š</strong></p>
<ul>
<li><strong>çº¦å®šä¼˜äºé…ç½®</strong>ï¼šåƒ Next.js æˆ– Nuxt.js é‚£æ ·ï¼Œæ–‡ä»¶æ”¾å¯¹ä½ç½®è·¯ç”±å°±è‡ªåŠ¨ç”Ÿæˆäº†ã€‚</li>
<li><strong>æä¾›å¼€ç®±å³ç”¨çš„ç±»å‹</strong>ï¼šåˆ«è®©ç”¨æˆ·è‡ªå·±å»çŒœæ³›å‹å¡«ä»€ä¹ˆã€‚</li>
<li><strong>è·¯å¾„ä¾èµ–è®¾è®¡</strong>ï¼šè®©æœ€ç®€å•çš„å†™æ³•ï¼Œå°±æ˜¯æœ€ä½³å®è·µã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-5">5. æ™¦æ¶©æ€§ (Opacity) &amp; è¿‡åº¦è®¾è®¡ (Needless Complexity)</h2>
<p><strong>ç—‡çŠ¶ï¼š</strong> è¿™ä¸¤ä¸ªå¾€å¾€ç›¸ä¼´è€Œç”Ÿã€‚ ä½ æ‰“å¼€ä¸€ä¸ªåŒäº‹çš„ä»£ç ï¼Œçœ‹åˆ°äº†ä¸€å † <code>AbstractFactoryProvider</code>ã€<code>HighOrderComponentWrapper</code>ã€‚ ä½ åªæ˜¯æƒ³æ¸²æŸ“ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œç»“æœä½ éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ª <code>FormConfig</code>ï¼Œå†å®ä¾‹åŒ–ä¸€ä¸ª <code>FieldBuilder</code>ï¼Œæœ€åé€šè¿‡ <code>RenderProp</code> ä¼ è¿›å»ã€‚</p>
<p>å¼€å‘è€…çœ‹ç€ä½ çš„ä»£ç ä¼šæ„Ÿå¹ï¼šâ€œè™½ç„¶çœ‹ä¸æ‡‚ï¼Œä½†æ„Ÿè§‰å¾ˆå‰å®³çš„æ ·å­ã€‚â€ â€”â€” åˆ«å‚»äº†ï¼Œä»–ä»¬å¿ƒé‡Œåœ¨éª‚å¨˜ã€‚</p>
<p><strong>å‰ç«¯å®æˆ˜ç¿»è¯‘ï¼š</strong> ä¸ºäº†å°è£…è€Œå°è£…ã€‚æ¯”å¦‚æŠŠç®€å•çš„ <code>if-else</code> é€»è¾‘æŠ½è±¡æˆæå…¶å¤æ‚çš„ç­–ç•¥æ¨¡å¼ï¼Œæˆ–è€…å†™äº†æ— æ¯”æŠ½è±¡çš„ Hooksï¼Œç»“æœå‚æ•°ä¼ äº† 8 ä¸ªï¼Œè¿”å›å€¼ 12 ä¸ªã€‚</p>
<p><strong>æŒ‡å—ï¼š</strong></p>
<ul>
<li><strong>YAGNI åŸåˆ™</strong> (You Ain't Gonna Need It)ï¼šä¸è¦ä¸ºä½ è‡†æƒ³çš„æœªæ¥éœ€æ±‚å†™ä»£ç ã€‚</li>
<li><strong>ä»£ç å¦‚æ–‡ç« </strong>ï¼šå¥½çš„ä»£ç åº”è¯¥åƒå¤§ç™½è¯ä¸€æ ·ã€‚å¦‚æœä¸€æ®µä»£ç éœ€è¦ä½ å†™ 10 è¡Œæ³¨é‡Šæ¥è§£é‡Šâ€œæˆ‘ä¸ºä»€ä¹ˆè¦ç»•è¿™ä¹ˆå¤§å¼¯å­â€ï¼Œé‚£é€šå¸¸æ„å‘³ç€è®¾è®¡å¤±è´¥ã€‚</li>
<li><strong>ç»„åˆä¼˜äºç»§æ‰¿ï¼Œç®€å•ä¼˜äºæŠ½è±¡</strong>ï¼šåœ¨å‰ç«¯ï¼Œç‰¹åˆ«æ˜¯ React Hooks ä¸­ï¼Œå¹³é“ºç›´å™çš„é€»è¾‘å¾€å¾€æ¯”å±‚å±‚åµŒå¥—çš„é«˜é˜¶ç»„ä»¶è¦å¥½ç»´æŠ¤å¾—å¤šã€‚</li>
</ul>
<hr/>
<h2 data-id="heading-6">æ€»ç»“ï¼šå¦‚ä½•é¿å…æˆä¸ºâ€œåˆ¶é€ è‡­å‘³â€çš„äººï¼Ÿ</h2>
<p>è®¾è®¡æ¡†æ¶å°±åƒç›–æ¥¼ã€‚</p>
<ul>
<li><strong>åƒµåŒ–æ€§</strong>æ˜¯é’¢ç­‹æ²¡ç»‘å¥½ï¼Œæƒ³æ”¹æˆ·å‹å¾—æ‹†æ‰¿é‡å¢™ã€‚</li>
<li><strong>è„†å¼±æ€§</strong>æ˜¯åœ°åŸºæ²¡æ‰“ç‰¢ï¼Œæ¥¼ä¸Šè£…ä¿®æ¥¼ä¸‹æ¼æ°´ã€‚</li>
<li><strong>é¡½å›ºæ€§</strong>æ˜¯æ°´ç”µç®¡çº¿æ··åœ¨ä¸€èµ·ï¼Œä¿®ç”µçº¿å¾—ç ¸æ°´ç®¡ã€‚</li>
<li><strong>ç²˜æ»æ€§</strong>æ˜¯åƒåœ¾é“è®¾è®¡ä¸åˆç†ï¼Œå¤§å®¶åªå¥½å¾€æ¥¼ä¸‹æ‰”åƒåœ¾ã€‚</li>
</ul>
<p>è¦å»é™¤è¿™äº›â€œå‘³é“â€ï¼Œæœ€æ ¸å¿ƒçš„å¿ƒæ³•åªæœ‰ä¸€å¥è¯ï¼š</p>
<p><strong>ä¿æŒä»£ç çš„â€œè½¯â€åº¦ (Software)ã€‚</strong></p>
<p>è½¯ä»¶ä¹‹æ‰€ä»¥å«è½¯ä»¶ï¼Œæ˜¯å› ä¸ºå®ƒåº”è¯¥æ˜¯æ˜“äºæ”¹å˜çš„ã€‚å½“æˆ‘ä»¬å†™ä¸‹ä¸€è¡Œä»£ç æ—¶ï¼Œå¤šé—®è‡ªå·±ä¸€å¥ï¼š <em>â€œå¦‚æœæ˜å¤©è¿™ä¸ªéœ€æ±‚å˜äº†ï¼Œæˆ‘ä»Šå¤©å†™çš„è¿™è¡Œä»£ç æ˜¯èµ„äº§ï¼Œè¿˜æ˜¯å€ºåŠ¡ï¼Ÿâ€</em></p>
<hr/>
<p><strong>äº’åŠ¨è¯é¢˜</strong></p>
<p>ä½ çš„é¡¹ç›®é‡Œæœ‰æ²¡æœ‰é‚£ç§â€œç”šè‡³ä¸æ•¢çœ‹å®ƒä¸€çœ¼ï¼Œæ€•çœ‹ä¸€çœ¼å®ƒå°±å´©äº†â€çš„ä»£ç ï¼Ÿæˆ–è€…ä½ è§è¿‡æœ€ç¦»è°±çš„â€œè¿‡åº¦è®¾è®¡â€æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºæ™’å‡ºä½ çš„â€œå—è‹¦â€ç»å†ï¼Œè®©å¤§å®¶å¼€å¿ƒä¸€ä¸‹ï¼ˆåˆ’æ‰ï¼‰é¿é¿å‘ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Flutter æ··åˆæ¨¡å¼ä¸‹ï¼šsaveLayer æ··åˆæ³¨æ„ç‚¹]]></title>    <link>https://juejin.cn/post/7592887786966351908</link>    <guid>https://juejin.cn/post/7592887786966351908</guid>    <pubDate>2026-01-09T03:24:13.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592887786966351908" data-draft-id="7592912896591364115" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Flutter æ··åˆæ¨¡å¼ä¸‹ï¼šsaveLayer æ··åˆæ³¨æ„ç‚¹"/> <meta itemprop="keywords" content="Flutter,Android"/> <meta itemprop="datePublished" content="2026-01-09T03:24:13.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç«æŸ´å°±æ˜¯æˆ‘"/> <meta itemprop="url" content="https://juejin.cn/user/272334614705575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Flutter æ··åˆæ¨¡å¼ä¸‹ï¼šsaveLayer æ··åˆæ³¨æ„ç‚¹
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/272334614705575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç«æŸ´å°±æ˜¯æˆ‘
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T03:24:13.000Z" title="Fri Jan 09 2026 03:24:13 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ç›´æ¥Paint ç»˜åˆ¶æ··åˆ</p>
<pre><code class="hljs language-js" lang="js">    canvas.<span class="hljs-title function_">saveLayer</span>(<span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height), <span class="hljs-title class_">Paint</span>());
    <span class="hljs-title class_">Paint</span> dstPaint = <span class="hljs-title class_">Paint</span>()..<span class="hljs-property">color</span> = <span class="hljs-title class_">Colors</span>.<span class="hljs-property">red</span>;
    dstPaint.<span class="hljs-property">strokeWidth</span> = <span class="hljs-number">20</span>;
    dstPaint.<span class="hljs-property">style</span> = <span class="hljs-title class_">PaintingStyle</span>.<span class="hljs-property">stroke</span>;
    canvas.<span class="hljs-title function_">drawImageRect</span>(image!, <span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, image!.<span class="hljs-property">width</span>.<span class="hljs-title function_">toDouble</span>(), image!.<span class="hljs-property">height</span>.<span class="hljs-title function_">toDouble</span>()), <span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height), dstPaint);

    <span class="hljs-keyword">var</span> srcPaint = <span class="hljs-title class_">Paint</span>()
      ..<span class="hljs-property">color</span> = <span class="hljs-title class_">Colors</span>.<span class="hljs-property">yellowAccent</span> <span class="hljs-comment">// æºé¢œè‰²ï¼šè“è‰²</span>
      ..<span class="hljs-property">style</span> = <span class="hljs-title class_">PaintingStyle</span>.<span class="hljs-property">fill</span> <span class="hljs-comment">// å¡«å……æ¨¡å¼</span>
      ..<span class="hljs-property">blendMode</span> = ui.<span class="hljs-property">BlendMode</span>.<span class="hljs-property">clear</span>
      ..<span class="hljs-property">strokeWidth</span> = <span class="hljs-number">70</span>; <span class="hljs-comment">// æ··åˆæ¨¡å¼</span>
    canvas.<span class="hljs-title function_">drawRect</span>(<span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height).<span class="hljs-title function_">deflate</span>(<span class="hljs-number">100</span>), srcPaint);
</code></pre>
<p>æ•ˆæœå›¾ï¼š</p>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/ca0ab18fc0104e1d80d75a1cc2911f2c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Gr5p-05bCx5piv5oiR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768533853&amp;x-signature=ixgv4WOlft17x7UqUQBFAz0m0vo%3D" alt="image.png" width="30%" loading="lazy"/>
<p>ä½†æ˜¯å¦‚æœæ”¹æˆå¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js">    canvas.<span class="hljs-title function_">saveLayer</span>(<span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height), <span class="hljs-title class_">Paint</span>());
    <span class="hljs-title class_">Paint</span> dstPaint = <span class="hljs-title class_">Paint</span>()..<span class="hljs-property">color</span> = <span class="hljs-title class_">Colors</span>.<span class="hljs-property">red</span>;
    dstPaint.<span class="hljs-property">strokeWidth</span> = <span class="hljs-number">20</span>;
    dstPaint.<span class="hljs-property">style</span> = <span class="hljs-title class_">PaintingStyle</span>.<span class="hljs-property">stroke</span>;
    canvas.<span class="hljs-title function_">drawImageRect</span>(image!, <span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, image!.<span class="hljs-property">width</span>.<span class="hljs-title function_">toDouble</span>(), image!.<span class="hljs-property">height</span>.<span class="hljs-title function_">toDouble</span>()), <span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height), dstPaint);
    
    canvas.<span class="hljs-title function_">saveLayer</span>(<span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width/<span class="hljs-number">2</span>, height/<span class="hljs-number">2</span>), ui.<span class="hljs-title class_">Paint</span>()
    ..<span class="hljs-property">blendMode</span> = ui.<span class="hljs-property">BlendMode</span>.<span class="hljs-property">clear</span>);

    <span class="hljs-keyword">var</span> srcPaint = <span class="hljs-title class_">Paint</span>()
      ..<span class="hljs-property">color</span> = <span class="hljs-title class_">Colors</span>.<span class="hljs-property">yellowAccent</span> <span class="hljs-comment">// æºé¢œè‰²ï¼šè“è‰²</span>
      ..<span class="hljs-property">style</span> = <span class="hljs-title class_">PaintingStyle</span>.<span class="hljs-property">fill</span> <span class="hljs-comment">// å¡«å……æ¨¡å¼</span>
      ..<span class="hljs-property">strokeWidth</span> = <span class="hljs-number">70</span>; <span class="hljs-comment">// æ··åˆæ¨¡å¼</span>
    canvas.<span class="hljs-title function_">drawRect</span>(<span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height).<span class="hljs-title function_">deflate</span>(<span class="hljs-number">100</span>), srcPaint);
</code></pre>
<p>ç›®æµ‹ä»£ç é€»è¾‘æ˜¯ä¸€æ ·çš„åªæ˜¯æŠŠæ··åˆæ¨¡å¼è®¾ç½®ç»™äº†Layerã€‚ä½†æ˜¯æœ€ç»ˆæ•ˆæœå°±æ˜¯ç•Œé¢ä¸Šå•¥é¡µæ²¡æœ‰å…¨éƒ¨è¢«æ¸…ç©ºäº†ã€‚è¿™æ˜¯å› ä¸ºè®¾ç½®äº†æ··åˆæ¨¡å¼ä¹‹å,æ•´ä¸ªå›¾å±‚éƒ½ä¼šè¢«å½“ä½œsrc è¿›è¡Œæ··åˆã€‚å¹¶ä¸”ç¬¬ä¸€ä¸ªè®¾ç½®èŒƒå›´çš„å‚æ•°ä¹Ÿä¸ç”Ÿæ•ˆã€‚</p>
<p>å¦‚æœæƒ³é™åˆ¶åˆ°æŒ‡å®šèŒƒå›´å¯ä»¥åœ¨saveLayerå‰åŠ å¦‚ä¸‹å†…å®¹:</p>
<pre><code class="hljs language-js" lang="js">  canvas.<span class="hljs-title function_">clipRect</span>(<span class="hljs-title class_">Rect</span>.<span class="hljs-title function_">fromLTWH</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width/<span class="hljs-number">2</span>, height/<span class="hljs-number">2</span>));
</code></pre>
<p>é‚£ä¹ˆåŠ å®Œä¹‹åçš„æ•ˆæœå›¾å¦‚ä¸‹:</p>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/558f554184234155b5564810a7766348~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg54Gr5p-05bCx5piv5oiR:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768533853&amp;x-signature=wsSloCb0DJ%2BswQJUI2LyUk7FxSE%3D" alt="image.png" width="30%" loading="lazy"/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[â€œæ­»äº†ä¹ˆâ€Appè£ç™»ä»˜è´¹æ¦œç¬¬ä¸€åï¼]]></title>    <link>https://juejin.cn/post/7593212374922117147</link>    <guid>https://juejin.cn/post/7593212374922117147</guid>    <pubDate>2026-01-10T06:48:45.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593212374922117147" data-draft-id="7593215107406151716" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="â€œæ­»äº†ä¹ˆâ€Appè£ç™»ä»˜è´¹æ¦œç¬¬ä¸€åï¼"/> <meta itemprop="keywords" content="APP,Apple,uni-app"/> <meta itemprop="datePublished" content="2026-01-10T06:48:45.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="iOSç ”ç©¶é™¢"/> <meta itemprop="url" content="https://juejin.cn/user/1421041942671774"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            â€œæ­»äº†ä¹ˆâ€Appè£ç™»ä»˜è´¹æ¦œç¬¬ä¸€åï¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1421041942671774/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    iOSç ”ç©¶é™¢
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T06:48:45.000Z" title="Sat Jan 10 2026 06:48:45 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>2026å¹´åˆçš„App Storeä»˜è´¹æ¦œï¼Œçªç„¶æ€å‡ºä¸€åŒ¹â€œé»‘é©¬â€â€”â€”ä¸€æ¬¾åä¸º <strong>ã€Œâ€œæ­»äº†ä¹ˆ - å®˜æ–¹æ­£ç‰ˆâ€ã€</strong> çš„äº§å“ï¼Œä»¥8å…ƒä»˜è´¹ä¸‹è½½çš„æ¨¡å¼ï¼Œæ¯«æ— å¾å…†åœ°ç™»é¡¶ä»˜è´¹æ¦œå•æ¦œé¦–ï¼Œæˆä¸ºä»Šå¹´é¦–ä¸ªç°è±¡çº§çˆ†æ¬¾ã€‚å¯¹äºå¸¸å¹´å…³æ³¨åº”ç”¨å¸‚åœºçš„å¼€å‘è€…å’Œä»ä¸šè€…æ¥è¯´ï¼Œè¿™æ³¢æ“ä½œå ªç§°â€œæƒŠå–œä¸æ„å¤–å¹¶å­˜â€ï¼šæ—¢å¥½å¥‡è¿™æ¬¾çªç„¶å†’å¤´çš„äº§å“ç©¶ç«Ÿæœ‰ä½•é­…åŠ›ï¼Œæ›´ç–‘æƒ‘ä¸ºä½•ä¸€æ¬¾2025å¹´å°±ä¸Šæ¶çš„äº§å“ï¼Œç›´åˆ°ç°åœ¨æ‰è¿æ¥æµé‡çˆ†å‘ã€‚</p>
<p><img src="" alt="" loading="lazy"/></p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/035ed6c39d71464cbab494a864944c4a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaU9T56CU56m26Zmi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632525&amp;x-signature=eQP5ljROs%2FNo2oVFKn%2Fva2U%2Fumo%3D" alt="f5521fe6324e395d5a821f0a3f03e95c.jpg" loading="lazy"/></p>
<h3 data-id="heading-1">æ¦œå•å˜åŒ–</h3>
<p>ç›´è§‚çš„æ¦œå•è¡¨ç°ï¼Œæ‰“å¼€App Storeä»˜è´¹æ¦œï¼Œâ€œæ­»äº†ä¹ˆ - å®˜æ–¹æ­£ç‰ˆâ€èµ«ç„¶å æ®TOP1ä½ç½®ï¼Œè¿œè¶…åŒç±»ä»˜è´¹åº”ç”¨ï¼Œä¸‹è½½é‡å’Œä»˜è´¹è½¬åŒ–æ•°æ®ä¸€è·¯é£™å‡ã€‚ä»æ¦œå•é¡µé¢èƒ½æ¸…æ™°çœ‹åˆ°ï¼Œè¿™æ¬¾äº§å“çš„ç™»é¡¶ç›´æ¥æ‰“ä¹±äº†åŸæœ‰æ¦œå•æ ¼å±€ï¼Œä¸å°‘å¸¸å¹´ç›˜è¸å‰åˆ—çš„ä»˜è´¹åº”ç”¨çº·çº·é€€å±…å…¶åï¼Œè¶³è§å…¶çŸ­æœŸå†…çš„çˆ†å‘åŠ›ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/820b28d228df42358770d527545f5939~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaU9T56CU56m26Zmi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632525&amp;x-signature=179AK6FwJgwyRiBWBO5cESH01m0%3D" alt="ScreenShot_2026-01-10_142553_600.png" loading="lazy"/></p>
<h3 data-id="heading-2">å…³é”®è¯å˜åŒ–</h3>
<p>ä»è¡Œä¸šå¸¸è§„é€»è¾‘æ¥çœ‹ï¼Œåº”ç”¨ä¸Šæ¶åè‹¥å‡ºç°åç§°è¿è§„ã€å†…å®¹ä¸ç¬¦åˆå¹³å°è§„èŒƒã€å…³é”®è¯å †ç Œç­‰é—®é¢˜ï¼Œå°±å¯èƒ½è¢«å¹³å°ä¸‹æ¶æˆ–é™åˆ¶æ›å…‰ï¼ˆå³â€œæ¸…è¯ã€æ¸…æ¦œâ€ï¼‰ã€‚â€œæ­»äº†ä¹ˆ - å®˜æ–¹æ­£ç‰ˆâ€å¤§æ¦‚ç‡æ˜¯åœ¨åˆæœŸè¿è¥ä¸­è§¦ç¢°äº†å¹³å°è§„åˆ™çº¢çº¿ï¼Œå¯¼è‡´è¢«é™åˆ¶ä¼ æ’­ã€‚</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/82339af4e1664ae0ab746e7ec413d10f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgaU9T56CU56m26Zmi:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768632525&amp;x-signature=IZhzT5yALvIuow0ELO54rcu2TjQ%3D" alt="3333.png" loading="lazy"/></p>
<p><code>éµå®ˆè§„åˆ™ï¼Œæ–¹å¾—é•¿æ²»ä¹…å®‰</code>ï¼Œæœ€åç¥å¤§å®¶å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šè¿‡å®¡ï¼</p>
<h3 data-id="heading-3">ç›¸å…³æ¨è</h3>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FURmC_4vxQv5ttOg8yYe7Eg" target="_blank" title="https://mp.weixin.qq.com/s/URmC_4vxQv5ttOg8yYe7Eg" ref="nofollow noopener noreferrer"># è‹¹æœå¼€å‘è€…ç»­è´¹å¤§å‘åŠæˆåŠŸç»­è´¹æ–¹æ¡ˆï¼äº²æµ‹æœ‰æ•ˆ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2F1bAA90Tzpx03tTHZbdg3aw" target="_blank" title="https://mp.weixin.qq.com/s/1bAA90Tzpx03tTHZbdg3aw" ref="nofollow noopener noreferrer"># AppStoreæ•æ„Ÿè¯æ’æŸ¥æ‰‹å†Œï¼Œå¤šç»´åº¦åˆ†æGuideline 2.3.1éšè—åŠŸèƒ½ï¼Œè½»æ¾è¿‡å®¡ã€‚</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FV2F4BaEYh5HfeUUHm1tI6Q" target="_blank" title="https://mp.weixin.qq.com/s/V2F4BaEYh5HfeUUHm1tI6Q" ref="nofollow noopener noreferrer"># å¦‚ä½•ä¸»åŠ¨æé˜²è‹¹æœ3.2fçš„è¿›æ”»ï¼Œè‡ªæŸ¥é˜²å¾¡æ‰‹å†Œï¼ˆä»£ç ç¯‡ï¼‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2FLs3su8fmMckTocPwMmFaNQ" target="_blank" title="https://mp.weixin.qq.com/s/Ls3su8fmMckTocPwMmFaNQ" ref="nofollow noopener noreferrer"># å¦‚ä½•ä¸»åŠ¨æé˜²è‹¹æœ3.2fçš„è¿›æ”»ï¼Œè‡ªæŸ¥é˜²å¾¡æ‰‹å†Œï¼ˆASOç¯‡ï¼‰</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484371%26idx%3D1%26sn%3D33568c58e90a5bf4d2612d803ecb2a27%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484371&amp;idx=1&amp;sn=33568c58e90a5bf4d2612d803ecb2a27&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># è‹¹æœåŠ æ€¥å®¡æ ¸æ˜¯â€œç»¿è‰²é€šé“â€è¿˜æ˜¯â€œæ­»äº¡é™·é˜±â€ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484362%26idx%3D1%26sn%3Dea61bd42d5ae8b99d2a56cbfb8d91e88%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484362&amp;idx=1&amp;sn=ea61bd42d5ae8b99d2a56cbfb8d91e88&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># è‹¹æœå¼€å‘è€…é‚®ç®±ï¼Œçªç„¶æ”¶åˆ°11.2é€šçŸ¥ä¸¥é‡ä¹ˆï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484413%26idx%3D1%26sn%3D82870d4c8892fa65803a8e05fd5ac938%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484413&amp;idx=1&amp;sn=82870d4c8892fa65803a8e05fd5ac938&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># ä¸æƒ³è¢«è‹¹æœå¡å®¡æœ€å¥½é”™å¼€è¿™ä¸¤ä¸ªæå®¡æ—¶é—´</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484349%26idx%3D1%26sn%3D1c75a6b08cb5de64ddf41a88b61ff108%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484349&amp;idx=1&amp;sn=1c75a6b08cb5de64ddf41a88b61ff108&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># æ‰‹æ’•è‹¹æœå®¡æ ¸4.3æ˜¯ä»£ç é—®é¢˜è¿˜æ˜¯è®¾è®¡é—®é¢˜ï¼Ÿ</a></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMTkxNzAzMw%3D%3D%26mid%3D2247484344%26idx%3D1%26sn%3D4399eb8d8bf82e9c5df26a18b8564cfb%26scene%3D21%23wechat_redirect" target="_blank" title="https://mp.weixin.qq.com/s?__biz=MzUxMTkxNzAzMw==&amp;mid=2247484344&amp;idx=1&amp;sn=4399eb8d8bf82e9c5df26a18b8564cfb&amp;scene=21#wechat_redirect" ref="nofollow noopener noreferrer"># æœ‰å¹¸å’ŒAppstoreå®¡æ ¸äººå‘˜è¿›è¡Œäº†ä¸€åœºè§†é¢‘ä¼šè®®ç‰¹æ­¤è®°å½•ã€‚</a></p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ğŸ¥è§£å†³å‰ç«¯ â€œå¤ç°éš¾â€ï¼šrrweb å½•åˆ¶å›æ”¾ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸‹ï¼‰]]></title>    <link>https://juejin.cn/post/7592815497848930367</link>    <guid>https://juejin.cn/post/7592815497848930367</guid>    <pubDate>2026-01-09T01:56:33.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592815497848930367" data-draft-id="7592508079306670099" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ğŸ¥è§£å†³å‰ç«¯ â€œå¤ç°éš¾â€ï¼šrrweb å½•åˆ¶å›æ”¾ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸‹ï¼‰"/> <meta itemprop="keywords" content="å‰ç«¯,å¼€æº,å…¨æ ˆ"/> <meta itemprop="datePublished" content="2026-01-09T01:56:33.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç§‹å¤©çš„ä¸€é˜µé£"/> <meta itemprop="url" content="https://juejin.cn/user/3588413946594925"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ğŸ¥è§£å†³å‰ç«¯ â€œå¤ç°éš¾â€ï¼šrrweb å½•åˆ¶å›æ”¾ä»å…¥é—¨åˆ°ç²¾é€šï¼ˆä¸‹ï¼‰
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/3588413946594925/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç§‹å¤©çš„ä¸€é˜µé£
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:56:33.000Z" title="Fri Jan 09 2026 01:56:33 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»14åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><strong/></p><p align="center"><strong>Hello~å¤§å®¶å¥½ã€‚æˆ‘æ˜¯ç§‹å¤©çš„ä¸€é˜µé£</strong></p><p/>
<p>rrweb çš„æ ¸å¿ƒé­…åŠ›åœ¨äº â€œç”¨æå°çš„æ•°æ®é‡å¤ç°å®Œæ•´çš„é¡µé¢æ“ä½œâ€ï¼Œè¿™èƒŒåæ˜¯ DOM å¿«ç…§ã€å¢é‡æ›´æ–°ã€äº‹ä»¶åºåˆ—åŒ–ç­‰æŠ€æœ¯çš„ç²¾å¯†åä½œã€‚æœ¬æ–‡å°†ä»åŸç†æœ¬è´¨å‡ºå‘ï¼Œç”¨é€šä¿—ç±»æ¯” + æºç è§£æçš„æ–¹å¼ï¼Œæ‹†è§£æ¯ä¸ªæŠ€æœ¯æ¨¡å—çš„å®ç°é€»è¾‘ï¼ŒåŒæ—¶æ­ç¤º rrweb åœ¨å…¼å®¹æ€§ã€æ€§èƒ½ä¼˜åŒ–ä¸Šçš„å…³é”®è®¾è®¡ã€‚</p>
<h2 data-id="heading-0">ä¸€ã€ DOM å¿«ç…§ç”ŸæˆåŸç†ï¼ˆsnapshotï¼‰</h2>
<p><strong>é€šä¿—ç±»æ¯”</strong>ï¼šDOM å¿«ç…§å°±åƒç»™é¡µé¢æ‹ â€œå…¨æ™¯å·¥ç¨‹å›¾â€â€”â€” ä¸æ˜¯ç®€å•è®°å½•åƒç´ ï¼ˆå¦‚æˆªå›¾ï¼‰ï¼Œè€Œæ˜¯æŠŠé¡µé¢çš„ â€œéª¨æ¶â€ï¼ˆDOM å±‚çº§ç»“æ„ï¼‰ã€â€œçš®è‚¤â€ï¼ˆCSS æ ·å¼ï¼‰ã€â€œé›¶ä»¶å‚æ•°â€ï¼ˆå…ƒç´ å±æ€§ã€æ–‡æœ¬å†…å®¹ï¼‰éƒ½è½¬åŒ–ä¸ºç»“æ„åŒ–æ•°æ®ï¼Œåç»­èƒ½æ ¹æ®è¿™å¼  â€œå·¥ç¨‹å›¾â€ 1:1 è¿˜åŸå‡ºä¸åŸé¡µé¢ä¸€è‡´çš„åˆå§‹çŠ¶æ€ã€‚åŒºåˆ«äºæ™®é€šç…§ç‰‡ï¼Œè¿™å¼  â€œå·¥ç¨‹å›¾â€ åŒ…å«æ‰€æœ‰å¯ç¼–è¾‘çš„ â€œé›¶ä»¶ä¿¡æ¯â€ï¼Œè€Œéå›ºå®šçš„è§†è§‰å›¾åƒã€‚</p>
<h3 data-id="heading-1">1.1 æ ¸å¿ƒç›®æ ‡ä¸æŠ€æœ¯è·¯å¾„</h3>
<p>DOM å¿«ç…§çš„æ ¸å¿ƒç›®æ ‡æ˜¯ç”Ÿæˆ â€œå¯åºåˆ—åŒ–ã€å¯é‡å»ºã€ä½“ç§¯å°â€ çš„ DOM æ•°æ®ï¼ŒæŠ€æœ¯è·¯å¾„åˆ†ä¸ºä¸‰æ­¥ï¼š<strong>DOM éå†ä¸èŠ‚ç‚¹è¿‡æ»¤</strong>â†’<strong>èŠ‚ç‚¹å±æ€§ä¸æ ·å¼åºåˆ—åŒ–</strong>â†’<strong>èµ„æºå¼•ç”¨å¤„ç†</strong>ï¼Œæœ€ç»ˆè¾“å‡º JSON æ ¼å¼çš„FullSnapshotäº‹ä»¶ï¼ˆrrweb äº‹ä»¶ç±»å‹æ ‡è¯†ä¸º 2ï¼‰ã€‚</p>
<h3 data-id="heading-2">1.2 å…³é”®å®ç°é€»è¾‘ï¼ˆå‚è€ƒ rrweb-snapshot æºç ï¼‰</h3>
<p><code>rrweb-snapshot</code> åº“çš„ <code>takeSnapshot</code> å‡½æ•°æ˜¯å¿«ç…§ç”Ÿæˆçš„æ ¸å¿ƒï¼Œå…³é”®æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-3">1.2.1 æ ¹èŠ‚ç‚¹éå†ä¸è¿‡æ»¤</h4>
<p>ä»<code>document.documentElement</code>ï¼ˆHTML æ ¹èŠ‚ç‚¹ï¼‰å¼€å§‹æ·±åº¦ä¼˜å…ˆéå†ï¼Œè·³è¿‡æ— éœ€å½•åˆ¶çš„èŠ‚ç‚¹ï¼ˆå¦‚scriptã€styleæ ‡ç­¾ï¼Œæˆ–å¸¦å±è”½ç±»åçš„å…ƒç´ ï¼‰ï¼Œé¿å…æ— æ•ˆæ•°æ®å ç”¨ç©ºé—´ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šDOMèŠ‚ç‚¹éå†é€»è¾‘</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">traverseNode</span>(<span class="hljs-params">node, config</span>) {
  <span class="hljs-comment">// è¿‡æ»¤è§„åˆ™ï¼šè·³è¿‡è„šæœ¬ã€æ ·å¼ã€å±è”½å…ƒç´ ã€ä¸å¯è§å…ƒç´ </span>
  <span class="hljs-keyword">const</span> isIgnored = 
    node.<span class="hljs-property">tagName</span> === <span class="hljs-string">'SCRIPT'</span> || 
    node.<span class="hljs-property">tagName</span> === <span class="hljs-string">'STYLE'</span> || 
    node.<span class="hljs-property">classList</span>.<span class="hljs-title function_">contains</span>(config.<span class="hljs-property">blockClass</span>) || 
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(node).<span class="hljs-property">display</span> === <span class="hljs-string">'none'</span>;
  <span class="hljs-keyword">if</span> (isIgnored) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  <span class="hljs-comment">// åºåˆ—åŒ–å½“å‰èŠ‚ç‚¹</span>
  <span class="hljs-keyword">const</span> nodeSnapshot = <span class="hljs-title function_">serializeNode</span>(node);
  <span class="hljs-comment">// é€’å½’å¤„ç†å­èŠ‚ç‚¹ï¼ˆæ„å»ºDOMæ ‘ç»“æ„ï¼‰</span>
  <span class="hljs-keyword">const</span> children = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> child <span class="hljs-keyword">of</span> node.<span class="hljs-property">childNodes</span>) {
    <span class="hljs-keyword">const</span> childSnapshot = <span class="hljs-title function_">traverseNode</span>(child, config);
    <span class="hljs-keyword">if</span> (childSnapshot) children.<span class="hljs-title function_">push</span>(childSnapshot);
  }
  nodeSnapshot.<span class="hljs-property">children</span> = children;
  <span class="hljs-comment">// å†…è”è®¡ç®—æ ·å¼ï¼ˆç¡®ä¿å›æ”¾æ ·å¼ä¸€è‡´ï¼‰</span>
  <span class="hljs-title function_">inlineComputedStyle</span>(node, nodeSnapshot);
  <span class="hljs-keyword">return</span> nodeSnapshot;
}
</code></pre>
<h4 data-id="heading-4">1.2.2 èŠ‚ç‚¹åºåˆ—åŒ–ï¼ˆserializeNodeï¼‰</h4>
<p>æå–èŠ‚ç‚¹å…³é”®å±æ€§ï¼Œè½¬åŒ–ä¸º JSON ç»“æ„ï¼Œé‡ç‚¹å¤„ç†å…ƒç´ èŠ‚ç‚¹ä¸æ–‡æœ¬èŠ‚ç‚¹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šèŠ‚ç‚¹åºåˆ—åŒ–</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">serializeNode</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">const</span> snapshot = {
    <span class="hljs-attr">type</span>: node.<span class="hljs-property">nodeType</span>, <span class="hljs-comment">// 1=å…ƒç´ èŠ‚ç‚¹ï¼Œ3=æ–‡æœ¬èŠ‚ç‚¹ï¼Œ8=æ³¨é‡ŠèŠ‚ç‚¹ï¼ˆè·³è¿‡ï¼‰</span>
  };
  <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-number">1</span>) { <span class="hljs-comment">// å…ƒç´ èŠ‚ç‚¹</span>
    snapshot.<span class="hljs-property">tagName</span> = node.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toLowerCase</span>(); <span class="hljs-comment">// ç»Ÿä¸€å°å†™ï¼ˆå¦‚DIVâ†’divï¼‰</span>
    snapshot.<span class="hljs-property">attributes</span> = {};
    <span class="hljs-comment">// æ”¶é›†æ ¸å¿ƒå±æ€§ï¼ˆidã€classã€srcã€hrefç­‰ï¼Œè·³è¿‡è‡ªå®šä¹‰æ— å…³å±æ€§ï¼‰</span>
    <span class="hljs-keyword">const</span> coreAttrs = [<span class="hljs-string">'id'</span>, <span class="hljs-string">'class'</span>, <span class="hljs-string">'src'</span>, <span class="hljs-string">'href'</span>, <span class="hljs-string">'alt'</span>, <span class="hljs-string">'title'</span>, <span class="hljs-string">'value'</span>, <span class="hljs-string">'checked'</span>];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> attr <span class="hljs-keyword">of</span> node.<span class="hljs-property">attributes</span>) {
      <span class="hljs-keyword">if</span> (coreAttrs.<span class="hljs-title function_">includes</span>(attr.<span class="hljs-property">name</span>) || attr.<span class="hljs-property">name</span>.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'data-'</span>)) {
        snapshot.<span class="hljs-property">attributes</span>[attr.<span class="hljs-property">name</span>] = attr.<span class="hljs-property">value</span>;
      }
    }
    <span class="hljs-comment">// ç‰¹æ®Šå¤„ç†è¡¨å•å…ƒç´ ï¼ˆè®°å½•å½“å‰å€¼ï¼Œè€Œéåˆå§‹å€¼ï¼‰</span>
    <span class="hljs-keyword">if</span> ([<span class="hljs-string">'INPUT'</span>, <span class="hljs-string">'TEXTAREA'</span>, <span class="hljs-string">'SELECT'</span>].<span class="hljs-title function_">includes</span>(node.<span class="hljs-property">tagName</span>)) {
      snapshot.<span class="hljs-property">value</span> = node.<span class="hljs-property">value</span>;
      snapshot.<span class="hljs-property">checked</span> = node.<span class="hljs-property">checked</span> || <span class="hljs-literal">false</span>;
      snapshot.<span class="hljs-property">selectedIndex</span> = node.<span class="hljs-property">tagName</span> === <span class="hljs-string">'SELECT'</span> ? node.<span class="hljs-property">selectedIndex</span> : -<span class="hljs-number">1</span>;
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.<span class="hljs-property">nodeType</span> === <span class="hljs-number">3</span>) { <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹</span>
    snapshot.<span class="hljs-property">text</span> = node.<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>() || <span class="hljs-string">''</span>; <span class="hljs-comment">// è¿‡æ»¤ç©ºæ–‡æœ¬ï¼Œå‡å°‘ä½“ç§¯</span>
  }
  <span class="hljs-keyword">return</span> snapshot;
}
</code></pre>
<h4 data-id="heading-5">1.2.3 æ ·å¼æ”¶é›†ä¸å†…è”</h4>
<p>é¡µé¢æ ·å¼å¯èƒ½æ¥è‡ªlinkã€styleæˆ–å†…è”styleï¼Œä¸ºé¿å…å›æ”¾æ—¶æ ·å¼ä¸¢å¤±ï¼Œrrweb ä¼šå°†<strong>è®¡ç®—æ ·å¼ï¼ˆcomputedStyleï¼‰</strong> å†…è”åˆ°èŠ‚ç‚¹å¿«ç…§ä¸­ï¼ŒåŒæ—¶è¿‡æ»¤é»˜è®¤æ ·å¼å‡å°‘æ•°æ®é‡ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šæ ·å¼å†…è”å¤„ç†</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">inlineComputedStyle</span>(<span class="hljs-params">node, snapshot</span>) {
  <span class="hljs-keyword">const</span> computedStyle = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">getComputedStyle</span>(node);
  <span class="hljs-keyword">const</span> styles = {};
  <span class="hljs-comment">// ä»…æ”¶é›†å½±å“è§†è§‰çš„å…³é”®æ ·å¼å±æ€§ï¼ˆæ’é™¤é»˜è®¤å€¼ï¼‰</span>
  <span class="hljs-keyword">const</span> criticalStyles = [
    <span class="hljs-string">'display'</span>, <span class="hljs-string">'position'</span>, <span class="hljs-string">'top'</span>, <span class="hljs-string">'left'</span>, <span class="hljs-string">'width'</span>, <span class="hljs-string">'height'</span>, 
    <span class="hljs-string">'color'</span>, <span class="hljs-string">'background'</span>, <span class="hljs-string">'font-size'</span>, <span class="hljs-string">'border'</span>, <span class="hljs-string">'padding'</span>, <span class="hljs-string">'margin'</span>
  ];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> prop <span class="hljs-keyword">of</span> criticalStyles) {
    <span class="hljs-keyword">const</span> value = computedStyle.<span class="hljs-title function_">getPropertyValue</span>(prop);
    <span class="hljs-comment">// è¿‡æ»¤é»˜è®¤æ ·å¼ï¼ˆå¦‚divçš„display:blockã€bodyçš„margin:8pxï¼‰</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_">isDefaultStyle</span>(snapshot.<span class="hljs-property">tagName</span>, prop, value)) {
      styles[prop] = value;
    }
  }
  <span class="hljs-keyword">if</span> (<span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(styles).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
    snapshot.<span class="hljs-property">styles</span> = styles; <span class="hljs-comment">// ä»…å½“æœ‰éé»˜è®¤æ ·å¼æ—¶æ‰æ·»åŠ ï¼Œå‡å°‘ä½“ç§¯</span>
  }
}
<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šåˆ¤æ–­æ˜¯å¦ä¸ºæ ‡ç­¾é»˜è®¤æ ·å¼ï¼ˆåŸºäºrrwebå†…ç½®çš„é»˜è®¤æ ·å¼è¡¨ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isDefaultStyle</span>(<span class="hljs-params">tagName, prop, value</span>) {
  <span class="hljs-keyword">const</span> defaultStyles = {
    <span class="hljs-attr">div</span>: { <span class="hljs-attr">display</span>: <span class="hljs-string">'block'</span>, <span class="hljs-attr">margin</span>: <span class="hljs-string">'0'</span> },
    <span class="hljs-attr">body</span>: { <span class="hljs-attr">margin</span>: <span class="hljs-string">'8px'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'rgb(0, 0, 0)'</span> },
    <span class="hljs-attr">input</span>: { <span class="hljs-attr">border</span>: <span class="hljs-string">'1px solid rgb(169, 169, 169)'</span> }
    <span class="hljs-comment">// å…¶ä»–æ ‡ç­¾é»˜è®¤æ ·å¼...</span>
  };
  <span class="hljs-keyword">return</span> defaultStyles[tagName]?.[prop] === value;
}
</code></pre>
<h3 data-id="heading-6">1.3 æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li>
<p><strong>éš¾ç‚¹ 1ï¼šæ ·å¼ä½“ç§¯è¿‡å¤§ä¸æµè§ˆå™¨å…¼å®¹æ€§</strong></p>
<p>ç›´æ¥æ”¶é›†æ‰€æœ‰è®¡ç®—æ ·å¼ä¼šå¯¼è‡´æ•°æ®é‡æ¿€å¢ï¼ˆå•ä¸ªå…ƒç´ å¯èƒ½æœ‰ä¸Šç™¾ä¸ªæ ·å¼å±æ€§ï¼‰ï¼Œä¸”ä¸åŒæµè§ˆå™¨é»˜è®¤æ ·å¼å­˜åœ¨å·®å¼‚ï¼ˆå¦‚ Chrome ä¸ Safari çš„bodyé»˜è®¤marginä¸åŒï¼‰ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
â‘  ä»…æ”¶é›† â€œå½±å“è§†è§‰çš„å…³é”®æ ·å¼â€ï¼ˆå¦‚displayã€positionï¼‰ï¼Œè¿‡æ»¤æ— å…³æ ·å¼ï¼ˆå¦‚webkit-font-smoothingï¼‰ï¼›</p>
<p>â‘¡ ç»´æŠ¤ â€œæ ‡ç­¾é»˜è®¤æ ·å¼è¡¨â€ï¼Œä»…è®°å½•ä¸é»˜è®¤å€¼ä¸åŒçš„æ ·å¼ï¼Œæ•°æ®é‡å¯å‡å°‘ 60% ä»¥ä¸Šï¼›</p>
<p>â‘¢ å¯¹æµè§ˆå™¨ç§æœ‰å‰ç¼€æ ·å¼ï¼ˆå¦‚-webkit-border-radiusï¼‰è¿›è¡Œå…¼å®¹å¤„ç†ï¼Œç»Ÿä¸€è½¬åŒ–ä¸ºæ ‡å‡†æ ·å¼ã€‚</p>
</li>
<li>
<p><strong>éš¾ç‚¹ 2ï¼šè·¨åŸŸèµ„æºæ— æ³•åŠ è½½</strong></p>
<p>é¡µé¢ä¸­çš„è·¨åŸŸå›¾ç‰‡ï¼ˆå¦‚ CDN å›¾ç‰‡ï¼‰ã€å­—ä½“ç­‰èµ„æºï¼Œå›æ”¾æ—¶å¯èƒ½å›  CORS é™åˆ¶æ— æ³•åŠ è½½ï¼Œå¯¼è‡´æ ·å¼é”™ä¹±ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
</li>
<li>
<p>â‘  é…ç½®<code>inlineImages: true</code>æ—¶ï¼Œå°†å›¾ç‰‡è½¬åŒ–ä¸º Base64 ç¼–ç å†…è”åˆ°å¿«ç…§ä¸­ï¼ˆé€‚åˆå°å›¾ç‰‡ï¼‰ï¼›</p>
</li>
<li>
<p>â‘¡ å¯¹å¤§å›¾ç‰‡ï¼Œå›æ”¾æ—¶é€šè¿‡ â€œåŒæºä»£ç†æœåŠ¡â€ è½¬å‘è¯·æ±‚ï¼ˆå¦‚åç«¯éƒ¨ç½²ä»£ç†æ¥å£ï¼Œå°†è·¨åŸŸå›¾ç‰‡ URL è½¬ä¸ºåŒæº URLï¼‰ï¼›</p>
</li>
<li>
<p>â‘¢ è®°å½•èµ„æºåŠ è½½å¤±è´¥æ—¶çš„é™çº§æ ·å¼ï¼ˆå¦‚å›¾ç‰‡å ä½ç¬¦ï¼‰ï¼Œç¡®ä¿å›æ”¾ä½“éªŒä¸€è‡´ã€‚</p>
</li>
</ul>
<h3 data-id="heading-7">1.4 DOM å¿«ç…§ç”Ÿæˆæµç¨‹å›¾</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/06c362ed5ffc430d93116711b56412e1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56eL5aSp55qE5LiA6Zi16aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528593&amp;x-signature=Mi8sK5khRiJIu7UNyllRiks9Vlc%3D" alt="exported_image.png" width="70%" loading="lazy"/>
<h2 data-id="heading-8">äºŒã€å¢é‡æ›´æ–°æœºåˆ¶ï¼ˆMutationObserverï¼‰</h2>
<p><strong>é€šä¿—ç±»æ¯”</strong>ï¼šå¦‚æœè¯´ DOM å¿«ç…§æ˜¯ â€œåˆå§‹å·¥ç¨‹å›¾â€ï¼Œå¢é‡æ›´æ–°å°±æ˜¯ â€œå·¥ç¨‹å˜æ›´è®°å½•â€â€”â€” å°±åƒå»ºç­‘æ–½å·¥æ—¶ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½é‡æ–°ç»˜åˆ¶å®Œæ•´å›¾çº¸ï¼Œåªéœ€è®°å½• <strong>â€œåœ¨ 3 å±‚å¢åŠ  1 ä¸ªçª—æˆ·â€</strong> <strong>â€œä¿®æ”¹ 2 å±‚å¢™ä½“é¢œè‰²â€</strong> è¿™ç±»å˜åŒ–ã€‚</p>
<p>rrweb é€šè¿‡ç›‘å¬ DOM å˜åŒ–ï¼Œåªè®°å½•å¿«ç…§åçš„å¢é‡ä¿®æ”¹ï¼Œå¤§å¹…å‡å°‘å½•åˆ¶æ•°æ®é‡ã€‚</p>
<h3 data-id="heading-9">2.1 æ ¸å¿ƒæŠ€æœ¯ï¼šMutationObserver API</h3>
<p>rrweb çš„å¢é‡æ›´æ–°å®Œå…¨ä¾èµ–æµè§ˆå™¨åŸç”Ÿçš„MutationObserver APIï¼Œè¯¥ API å¯ç›‘å¬ DOM æ ‘çš„ <strong>â€œèŠ‚ç‚¹å˜åŒ–ã€å±æ€§å˜åŒ–ã€æ–‡æœ¬å˜åŒ–â€</strong> ï¼Œå¹¶<strong>å¼‚æ­¥æ‰¹é‡è§¦å‘å›è°ƒ</strong>ï¼ˆé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼‰ã€‚</p>
<p>å…¶æ ¸å¿ƒä¼˜åŠ¿ï¼š</p>
<ul>
<li>â‘  ç²¾å‡†ç›‘å¬ï¼ˆå¯æŒ‡å®šç›‘å¬ç±»å‹ï¼‰ï¼›</li>
<li>â‘¡ æ‰¹é‡å¤„ç†ï¼ˆçŸ­æ—¶é—´å†…å¤šæ¬¡å˜åŒ–åˆå¹¶ä¸ºä¸€æ¬¡å›è°ƒï¼‰ï¼›</li>
<li>â‘¢ æ€§èƒ½å‹å¥½ï¼ˆå¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡ç”¨æˆ·äº¤äº’ï¼‰ã€‚</li>
</ul>
<h3 data-id="heading-10">2.2 ç›‘å¬é…ç½®ä¸äº‹ä»¶è½¬åŒ–</h3>
<p>rrweb åˆå§‹åŒ–æ—¶åˆ›å»º <code>MutationObserver</code>å®ä¾‹ï¼Œå°†åŸç”Ÿå˜åŒ–äº‹ä»¶è½¬åŒ–ä¸ºè‡ªå®šä¹‰çš„Mutationäº‹ä»¶ï¼ˆrrweb äº‹ä»¶ç±»å‹æ ‡è¯†ä¸º 3ï¼‰ï¼Œå…³é”®é€»è¾‘å¦‚ä¸‹ï¼š</p>
<h4 data-id="heading-11">2.2.1 MutationObserver åˆå§‹åŒ–</h4>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šrrwebä¸­MutationObserveré…ç½®</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">initMutationObserver</span>(<span class="hljs-params">emit, config</span>) {
  <span class="hljs-comment">// å›è°ƒå‡½æ•°ï¼šæ‰¹é‡å¤„ç†DOMå˜åŒ–</span>
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">observerCallback</span> = (<span class="hljs-params">mutations</span>) =&gt; {
    <span class="hljs-comment">// è¿‡æ»¤æ— éœ€è®°å½•çš„å¾®å°å˜åŒ–ï¼ˆå¦‚æ–‡æœ¬èŠ‚ç‚¹ç©ºå­—ç¬¦ä¿®æ”¹ï¼‰</span>
    <span class="hljs-keyword">const</span> validMutations = mutations.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">m</span> =&gt;</span> <span class="hljs-title function_">isMutationValid</span>(m, config));
    <span class="hljs-keyword">if</span> (validMutations.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-comment">// æ‰¹é‡è½¬åŒ–ä¸ºrrwebå¢é‡äº‹ä»¶å¹¶å‘é€</span>
    validMutations.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">mutation</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> incrementalEvent = <span class="hljs-title function_">transformMutation</span>(mutation);
      <span class="hljs-title function_">emit</span>(incrementalEvent); <span class="hljs-comment">// å‘é€åˆ°äº‹ä»¶é˜Ÿåˆ—ï¼Œåç»­å­˜å‚¨/ä¸Šä¼ </span>
    });
  };
  <span class="hljs-comment">// ç›‘å¬é…ç½®ï¼šè¦†ç›–æ‰€æœ‰å…³é”®å˜åŒ–ç±»å‹</span>
  <span class="hljs-keyword">const</span> observerConfig = {
    <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,          <span class="hljs-comment">// ç›‘å¬å­èŠ‚ç‚¹æ–°å¢/åˆ é™¤</span>
    <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,         <span class="hljs-comment">// ç›‘å¬å…ƒç´ å±æ€§å˜åŒ–</span>
    <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,      <span class="hljs-comment">// ç›‘å¬æ–‡æœ¬èŠ‚ç‚¹å†…å®¹å˜åŒ–</span>
    <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>,            <span class="hljs-comment">// æ·±åº¦ç›‘å¬ï¼ˆå­æ ‘æ‰€æœ‰èŠ‚ç‚¹ï¼Œä¸ä»…æ˜¯ç›´æ¥å­èŠ‚ç‚¹ï¼‰</span>
    <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// è®°å½•å±æ€§å˜åŒ–å‰çš„æ—§å€¼ï¼ˆä¾¿äºå›æ”¾æ—¶è¿˜åŸï¼‰</span>
    <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">// è®°å½•æ–‡æœ¬å˜åŒ–å‰çš„æ—§å€¼</span>
  };
  <span class="hljs-comment">// å¼€å§‹ç›‘å¬æ ¹èŠ‚ç‚¹</span>
  <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutationObserver</span>(observerCallback);
  observer.<span class="hljs-title function_">observe</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>, observerConfig);
  <span class="hljs-keyword">return</span> observer; <span class="hljs-comment">// è¿”å›å®ä¾‹ï¼Œä¾¿äºåç»­åœæ­¢ç›‘å¬</span>
}
<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šè¿‡æ»¤æ— æ•ˆå˜åŒ–ï¼ˆå¦‚å±è”½å…ƒç´ å†…çš„å˜åŒ–ã€ç©ºæ–‡æœ¬ä¿®æ”¹ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isMutationValid</span>(<span class="hljs-params">mutation, config</span>) {
  <span class="hljs-comment">// å±è”½å…ƒç´ å†…çš„å˜åŒ–ä¸è®°å½•</span>
  <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">target</span>.<span class="hljs-title function_">closest</span>(<span class="hljs-string">`.<span class="hljs-subst">${config.blockClass}</span>`</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹ç©ºå­—ç¬¦ä¿®æ”¹ä¸è®°å½•ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ååˆ é™¤ä¸ºç©ºï¼‰</span>
  <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'characterData'</span>) {
    <span class="hljs-keyword">return</span> mutation.<span class="hljs-property">oldValue</span>.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">''</span> || mutation.<span class="hljs-property">target</span>.<span class="hljs-property">textContent</span>.<span class="hljs-title function_">trim</span>() !== <span class="hljs-string">''</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<h4 data-id="heading-12">2.2.2 åŸç”Ÿå˜åŒ–äº‹ä»¶è½¬åŒ–ï¼ˆtransformMutationï¼‰</h4>
<p>å°†æµè§ˆå™¨åŸç”Ÿçš„<code>MutationRecord</code>è½¬åŒ–ä¸º â€œå¯å›æ”¾çš„ç»“æ„åŒ–æ•°æ®â€ï¼Œæ ¸å¿ƒæ˜¯æ˜ç¡® â€œå˜åŒ–ç›®æ ‡ã€å˜åŒ–ç±»å‹ã€å˜åŒ–å†…å®¹â€ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šè½¬åŒ–åŸç”ŸMutationRecord</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">transformMutation</span>(<span class="hljs-params">mutation</span>) {
  <span class="hljs-keyword">const</span> event = {
    <span class="hljs-attr">type</span>: <span class="hljs-number">3</span>,                  <span class="hljs-comment">// Mutationäº‹ä»¶ç±»å‹æ ‡è¯†</span>
    <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),    <span class="hljs-comment">// äº‹ä»¶å‘ç”Ÿæ—¶é—´æˆ³ï¼ˆç”¨äºå›æ”¾æ’åºï¼‰</span>
    <span class="hljs-attr">data</span>: {}
  };
  <span class="hljs-comment">// 1. å­èŠ‚ç‚¹å˜åŒ–ï¼ˆæ–°å¢/åˆ é™¤èŠ‚ç‚¹ï¼‰</span>
  <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'childList'</span>) {
    event.<span class="hljs-property">data</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'childList'</span>;
    <span class="hljs-comment">// è®°å½•çˆ¶èŠ‚ç‚¹è·¯å¾„ï¼ˆä¾¿äºå›æ”¾æ—¶å®šä½ç›®æ ‡çˆ¶èŠ‚ç‚¹ï¼‰</span>
    event.<span class="hljs-property">data</span>.<span class="hljs-property">parentPath</span> = <span class="hljs-title function_">getNodeUniquePath</span>(mutation.<span class="hljs-property">target</span>);
    <span class="hljs-comment">// åºåˆ—åŒ–æ–°å¢/åˆ é™¤çš„èŠ‚ç‚¹ï¼ˆä»…æ ¸å¿ƒå±æ€§ï¼Œå‡å°‘ä½“ç§¯ï¼‰</span>
    event.<span class="hljs-property">data</span>.<span class="hljs-property">addedNodes</span> = mutation.<span class="hljs-property">addedNodes</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-title function_">serializeNode</span>(n)).<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
    event.<span class="hljs-property">data</span>.<span class="hljs-property">removedNodes</span> = mutation.<span class="hljs-property">removedNodes</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">n</span> =&gt;</span> <span class="hljs-title function_">serializeNode</span>(n)).<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
    <span class="hljs-comment">// è®°å½•æ’å…¥ä½ç½®å‚è€ƒèŠ‚ç‚¹ï¼ˆç¡®ä¿å›æ”¾æ—¶æ’å…¥é¡ºåºæ­£ç¡®ï¼‰</span>
    event.<span class="hljs-property">data</span>.<span class="hljs-property">nextSiblingId</span> = mutation.<span class="hljs-property">nextSibling</span> 
      ? <span class="hljs-title function_">getNodeUniqueId</span>(mutation.<span class="hljs-property">nextSibling</span>) 
      : <span class="hljs-literal">null</span>;
  }
  <span class="hljs-comment">// 2. å±æ€§å˜åŒ–ï¼ˆå¦‚classã€srcä¿®æ”¹ï¼‰</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'attributes'</span>) {
    event.<span class="hljs-property">data</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'attributes'</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">targetPath</span> = <span class="hljs-title function_">getNodeUniquePath</span>(mutation.<span class="hljs-property">target</span>);
    event.<span class="hljs-property">data</span>.<span class="hljs-property">attributeName</span> = mutation.<span class="hljs-property">attributeName</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">oldValue</span> = mutation.<span class="hljs-property">oldValue</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">newValue</span> = mutation.<span class="hljs-property">target</span>.<span class="hljs-title function_">getAttribute</span>(mutation.<span class="hljs-property">attributeName</span>);
  }
  <span class="hljs-comment">// 3. æ–‡æœ¬å˜åŒ–ï¼ˆå¦‚spanå†…æ–‡æœ¬ä¿®æ”¹ï¼‰</span>
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mutation.<span class="hljs-property">type</span> === <span class="hljs-string">'characterData'</span>) {
    event.<span class="hljs-property">data</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'characterData'</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">targetPath</span> = <span class="hljs-title function_">getNodeUniquePath</span>(mutation.<span class="hljs-property">target</span>);
    event.<span class="hljs-property">data</span>.<span class="hljs-property">oldValue</span> = mutation.<span class="hljs-property">oldValue</span>;
    event.<span class="hljs-property">data</span>.<span class="hljs-property">newValue</span> = mutation.<span class="hljs-property">target</span>.<span class="hljs-property">textContent</span>;
  }
  <span class="hljs-keyword">return</span> event;
}
<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šç”ŸæˆèŠ‚ç‚¹å”¯ä¸€è·¯å¾„ï¼ˆå¦‚"body&gt;div.container&gt;ul&gt;li:nth-child(2)"ï¼‰</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getNodeUniquePath</span>(<span class="hljs-params">node</span>) {
  <span class="hljs-keyword">if</span> (node === <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'html'</span>;
  <span class="hljs-keyword">if</span> (node === <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">'body'</span>;
  <span class="hljs-keyword">const</span> parentPath = <span class="hljs-title function_">getNodeUniquePath</span>(node.<span class="hljs-property">parentElement</span>);
  <span class="hljs-keyword">const</span> siblings = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(node.<span class="hljs-property">parentElement</span>.<span class="hljs-property">children</span>);
  <span class="hljs-comment">// ç”¨"æ ‡ç­¾å+ç´¢å¼•"ç¡®ä¿å”¯ä¸€æ€§ï¼ˆå¦‚li:nth-child(2)ï¼‰</span>
  <span class="hljs-keyword">const</span> index = siblings.<span class="hljs-title function_">indexOf</span>(node) + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">const</span> nodeName = node.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toLowerCase</span>();
  <span class="hljs-keyword">const</span> classAttr = node.<span class="hljs-property">classList</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> 
    ? <span class="hljs-string">`.<span class="hljs-subst">${<span class="hljs-built_in">Array</span>.<span class="hljs-keyword">from</span>(node.classList).join(<span class="hljs-string">'.'</span>)}</span>`</span> 
    : <span class="hljs-string">''</span>;
  <span class="hljs-keyword">const</span> idAttr = node.<span class="hljs-property">id</span> ? <span class="hljs-string">`#<span class="hljs-subst">${node.id}</span>`</span> : <span class="hljs-string">''</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${parentPath}</span>&gt;<span class="hljs-subst">${nodeName}</span><span class="hljs-subst">${idAttr}</span><span class="hljs-subst">${classAttr}</span>:nth-child(<span class="hljs-subst">${index}</span>)`</span>;
}
</code></pre>
<h3 data-id="heading-13">2.3 æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li>
<p><strong>éš¾ç‚¹ 1ï¼šèŠ‚ç‚¹è·¯å¾„å®šä½ä¸å‡†ç¡®</strong></p>
<p>å¢é‡å˜åŒ–éœ€è¦æ˜ç¡® â€œå“ªä¸ªèŠ‚ç‚¹å‘ç”Ÿäº†å˜åŒ–â€ï¼Œä½† DOM èŠ‚ç‚¹æ²¡æœ‰å¤©ç”Ÿçš„å”¯ä¸€æ ‡è¯†ï¼ŒåŠ¨æ€ç”Ÿæˆçš„èŠ‚ç‚¹ï¼ˆå¦‚ Vue åˆ—è¡¨æ¸²æŸ“çš„liï¼‰åœ¨åˆ·æ–°åè·¯å¾„å¯èƒ½å˜åŒ–ï¼Œå¯¼è‡´å›æ”¾æ—¶æ— æ³•å®šä½ç›®æ ‡èŠ‚ç‚¹ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>
<p>â‘  ç”Ÿæˆ â€œå”¯ä¸€è·¯å¾„â€ï¼ˆç»“åˆæ ‡ç­¾åã€IDã€ç±»åã€å…„å¼ŸèŠ‚ç‚¹ç´¢å¼•ï¼‰ï¼Œå¦‚body&gt;div.container&gt;ul&gt;li:nth-child(2)ï¼Œç¡®ä¿å³ä½¿èŠ‚ç‚¹åŠ¨æ€æ›´æ–°ï¼Œä»èƒ½é€šè¿‡è·¯å¾„æ‰¾åˆ°ï¼›</p>
</li>
<li>
<p>â‘¡ ç»´æŠ¤ â€œèŠ‚ç‚¹ ID æ˜ å°„è¡¨â€ï¼Œå½•åˆ¶æ—¶ä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…ä¸´æ—¶ IDï¼ˆå¦‚node.__rrwebIdï¼‰ï¼Œå›æ”¾æ—¶é€šè¿‡ ID å¿«é€Ÿå®šä½ï¼Œè·¯å¾„ä½œä¸ºé™çº§æ–¹æ¡ˆï¼ˆåº”å¯¹ ID ä¸¢å¤±åœºæ™¯ï¼‰ã€‚</p>
</li>
</ul>
</li>
<li>
<p><strong>éš¾ç‚¹ 2ï¼šé«˜é¢‘å˜åŒ–å¯¼è‡´æ€§èƒ½å¡é¡¿</strong></p>
<p>é¡µé¢ä¸­çš„é«˜é¢‘ DOM å˜åŒ–ï¼ˆå¦‚å€’è®¡æ—¶ã€åŠ¨ç”»ã€æ»šåŠ¨åŠ è½½åˆ—è¡¨ï¼‰ä¼šè§¦å‘MutationObserveré¢‘ç¹å›è°ƒï¼ˆå¦‚æ¯ç§’å‡ åæ¬¡ï¼‰ï¼Œå¯¼è‡´å‰ç«¯ä¸»çº¿ç¨‹é˜»å¡ï¼Œå½±å“ç”¨æˆ·äº¤äº’ä½“éªŒã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>â‘  ç»“åˆ â€œé‡‡æ ·ç‡æ§åˆ¶â€ï¼Œå¯¹é«˜é¢‘å˜åŒ–äº‹ä»¶ï¼ˆå¦‚æ–‡æœ¬å€’è®¡æ—¶ï¼‰è¿›è¡ŒèŠ‚æµå¤„ç†ï¼ˆå¦‚ 100ms å†…ä»…è®°å½• 1 æ¬¡å˜åŒ–ï¼‰ï¼›</li>
<li>â‘¡ æ‰¹é‡åˆå¹¶çŸ­æ—¶é—´å†…çš„åŒç±»å˜åŒ–ï¼ˆå¦‚ 100ms å†…çš„å¤šæ¬¡æ–‡æœ¬ä¿®æ”¹åˆå¹¶ä¸º 1 æ¬¡ï¼‰ï¼›</li>
<li>â‘¢ è¿‡æ»¤ â€œæ— æ„ä¹‰å˜åŒ–â€ï¼ˆå¦‚å…ƒç´ scrollTopçš„å¾®å°æ³¢åŠ¨ã€ç©ºæ–‡æœ¬ä¿®æ”¹ï¼‰ï¼Œå‡å°‘äº‹ä»¶æ•°é‡ã€‚</li>
</ul>
</li>
</ul>
<h3 data-id="heading-14">2.4 å¢é‡æ›´æ–°æµç¨‹ç¤ºæ„å›¾</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/38213ded1a94417689424eaa9f67279f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56eL5aSp55qE5LiA6Zi16aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528593&amp;x-signature=qzF5MNVrmSzOBjSonF7tBbBHrlk%3D" alt="exported_image.png" width="70%" loading="lazy"/>
<h2 data-id="heading-15">ä¸‰ã€äº‹ä»¶æ•è·å’Œåºåˆ—åŒ–</h2>
<p><strong>é€šä¿—ç±»æ¯”</strong>ï¼šå¦‚æœè¯´ DOM å¿«ç…§æ˜¯ â€œåˆå§‹åœºæ™¯â€ï¼Œå¢é‡æ›´æ–°æ˜¯ â€œåœºæ™¯å˜åŒ–â€ï¼Œé‚£ä¹ˆäº‹ä»¶æ•è·å°±æ˜¯ â€œç”¨æˆ·åŠ¨ä½œå‰§æœ¬â€â€”â€” å°±åƒç”µå½±æ‹æ‘„æ—¶ï¼Œä¸ä»…è¦æ­å»ºåœºæ™¯ï¼Œè¿˜è¦è®°å½•æ¼”å‘˜çš„ â€œè‚¢ä½“åŠ¨ä½œâ€â€œå°è¯â€â€œè¡¨æƒ…â€ã€‚</p>
<p>rrweb éœ€è¦æ•è·ç”¨æˆ·çš„ç‚¹å‡»ã€è¾“å…¥ã€æ»šåŠ¨ç­‰äº¤äº’åŠ¨ä½œï¼Œå°†å…¶è½¬åŒ–ä¸ºç»“æ„åŒ–çš„ â€œå‰§æœ¬æ•°æ®â€ï¼Œç¡®ä¿å›æ”¾æ—¶èƒ½ç²¾å‡†è¿˜åŸç”¨æˆ·æ“ä½œè½¨è¿¹ã€‚</p>
<h3 data-id="heading-16">3.1 æ ¸å¿ƒäº‹ä»¶ç±»å‹ä¸æ•è·ç­–ç•¥</h3>
<p>rrweb ä¸»è¦æ•è· 6 ç±»é«˜é¢‘ç”¨æˆ·äº¤äº’äº‹ä»¶ï¼Œè¦†ç›– 90% ä»¥ä¸Šçš„å‰ç«¯æ“ä½œåœºæ™¯ï¼Œé‡‡ç”¨ â€œå…¨å±€äº‹ä»¶å§”æ‰˜ + ç²¾å‡†è¿‡æ»¤â€ çš„æ•è·ç­–ç•¥ï¼Œé¿å…ç»™æ¯ä¸ªèŠ‚ç‚¹ç»‘å®šäº‹ä»¶å¯¼è‡´å†…å­˜æ³„æ¼ï¼š</p>















































<table><thead><tr><th>äº‹ä»¶ç±»å‹</th><th>æ ¸å¿ƒç”¨é€”</th><th>å…³é”®æ•°æ®å­—æ®µ</th><th>rrweb äº‹ä»¶ç±»å‹æ ‡è¯†</th></tr></thead><tbody><tr><td>é¼ æ ‡ç‚¹å‡»ï¼ˆclickï¼‰</td><td>è®°å½•æŒ‰é’®ã€é“¾æ¥ç­‰ç‚¹å‡»æ“ä½œ</td><td>ç‚¹å‡»åæ ‡ï¼ˆx/yï¼‰ã€ç›®æ ‡èŠ‚ç‚¹è·¯å¾„</td><td>4</td></tr><tr><td>é”®ç›˜è¾“å…¥ï¼ˆkeydownï¼‰</td><td>è®°å½•æ–‡æœ¬è¾“å…¥ã€åŠŸèƒ½é”®æ“ä½œ</td><td>æŒ‰é”®ç ï¼ˆkeyCodeï¼‰ã€è¾“å…¥å†…å®¹ã€ç›®æ ‡èŠ‚ç‚¹</td><td>5</td></tr><tr><td>é¼ æ ‡ç§»åŠ¨ï¼ˆmousemoveï¼‰</td><td>è®°å½•é¼ æ ‡ä½ç½®å˜åŒ–</td><td>é¼ æ ‡åæ ‡ï¼ˆx/yï¼‰ã€æ—¶é—´æˆ³</td><td>6</td></tr><tr><td>æ»šåŠ¨ï¼ˆscrollï¼‰</td><td>è®°å½•é¡µé¢ / å…ƒç´ æ»šåŠ¨ä½ç½®</td><td>æ»šåŠ¨ç›®æ ‡è·¯å¾„ã€scrollTop/scrollLeft</td><td>7</td></tr><tr><td>çª—å£ resize</td><td>è®°å½•çª—å£å°ºå¯¸å˜åŒ–</td><td>çª—å£å®½ï¼ˆwidthï¼‰ã€é«˜ï¼ˆheightï¼‰</td><td>8</td></tr><tr><td>è¡¨å•æäº¤ï¼ˆsubmitï¼‰</td><td>è®°å½•è¡¨å•æäº¤æ“ä½œ</td><td>è¡¨å•èŠ‚ç‚¹è·¯å¾„ã€æäº¤æ—¶é—´æˆ³</td><td>9</td></tr></tbody></table>
<h3 data-id="heading-17">3.2 å…³é”®å®ç°é€»è¾‘ï¼ˆå…¨å±€äº‹ä»¶å§”æ‰˜ï¼‰</h3>
<p>é€šè¿‡åœ¨documentä¸Šç»‘å®šäº‹ä»¶ç›‘å¬å™¨ï¼Œåˆ©ç”¨äº‹ä»¶å†’æ³¡æœºåˆ¶æ•è·æ‰€æœ‰å­èŠ‚ç‚¹çš„äº¤äº’ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šrrwebäº‹ä»¶æ•è·æ ¸å¿ƒé€»è¾‘</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">initEventCapture</span>(<span class="hljs-params">emit, config</span>) {
  <span class="hljs-comment">// éœ€æ•è·çš„äº‹ä»¶ç±»å‹ä¸å¯¹åº”çš„å¤„ç†å‡½æ•°</span>
  <span class="hljs-keyword">const</span> eventHandlers = {
    <span class="hljs-attr">click</span>: handleClick,
    <span class="hljs-attr">keydown</span>: handleKeydown,
    <span class="hljs-attr">mousemove</span>: handleMousemove,
    <span class="hljs-attr">scroll</span>: handleScroll,
    <span class="hljs-attr">resize</span>: handleResize,
    <span class="hljs-attr">submit</span>: handleSubmit
  };
  <span class="hljs-comment">// ç»‘å®šå…¨å±€äº‹ä»¶å§”æ‰˜</span>
  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(eventHandlers).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[type, handler]</span>) =&gt;</span> {
    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(type, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-comment">// è¿‡æ»¤è§„åˆ™ï¼š1. å±è”½å…ƒç´ å†…çš„äº‹ä»¶ 2. éç”¨æˆ·è§¦å‘çš„äº‹ä»¶ï¼ˆå¦‚è„šæœ¬è§¦å‘çš„clickï¼‰</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isIgnoredEvent</span>(e, config)) <span class="hljs-keyword">return</span>;
      <span class="hljs-comment">// å¤„ç†äº‹ä»¶å¹¶åºåˆ—åŒ–ä¸ºç»“æ„åŒ–æ•°æ®</span>
      <span class="hljs-keyword">const</span> eventData = <span class="hljs-title function_">handler</span>(e, config);
      <span class="hljs-comment">// å‘é€äº‹ä»¶ï¼ˆæºå¸¦æ—¶é—´æˆ³ï¼Œç¡®ä¿å›æ”¾é¡ºåºï¼‰</span>
      <span class="hljs-title function_">emit</span>({
        <span class="hljs-attr">type</span>: <span class="hljs-title function_">getRRwebEventType</span>(type), <span class="hljs-comment">// è½¬åŒ–ä¸ºrrwebäº‹ä»¶æ ‡è¯†</span>
        <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
        <span class="hljs-attr">data</span>: eventData
      });
    }, {
      <span class="hljs-attr">passive</span>: type === <span class="hljs-string">'scroll'</span> || type === <span class="hljs-string">'resize'</span>, <span class="hljs-comment">// passiveä¼˜åŒ–ï¼šé¿å…æ»šåŠ¨é˜»å¡</span>
      <span class="hljs-attr">capture</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// å†’æ³¡é˜¶æ®µæ•è·ï¼Œç¡®ä¿èƒ½è·å–æœ€ç»ˆç›®æ ‡èŠ‚ç‚¹</span>
    });
  });
}
<span class="hljs-comment">// è¾…åŠ©å‡½æ•°ï¼šè¿‡æ»¤æ— æ•ˆäº‹ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">isIgnoredEvent</span>(<span class="hljs-params">e, config</span>) {
  <span class="hljs-comment">// 1. å±è”½å…ƒç´ å†…çš„äº‹ä»¶ï¼ˆå¦‚å¸¦.rr-blockç±»åçš„å…ƒç´ ï¼‰</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">target</span>.<span class="hljs-title function_">closest</span>(<span class="hljs-string">`.<span class="hljs-subst">${config.blockClass}</span>`</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// 2. æ’é™¤è„šæœ¬è§¦å‘çš„äº‹ä»¶ï¼ˆä»…ä¿ç•™ç”¨æˆ·æ‰‹åŠ¨è§¦å‘ï¼‰</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">isTrusted</span> === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-comment">// 3. æ’é™¤å³é”®ç‚¹å‡»ï¼ˆcontextmenuï¼‰å’Œæ»šè½®äº‹ä»¶ï¼ˆé»˜è®¤ä¸æ•è·ï¼‰</span>
  <span class="hljs-keyword">if</span> (e.<span class="hljs-property">type</span> === <span class="hljs-string">'click'</span> &amp;&amp; e.<span class="hljs-property">button</span> === <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<h3 data-id="heading-18">3.3 å…¸å‹äº‹ä»¶åºåˆ—åŒ–å®ç°ï¼ˆä»¥é”®ç›˜è¾“å…¥å’Œæ»šåŠ¨ä¸ºä¾‹ï¼‰</h3>
<p>ä¸åŒäº‹ä»¶çš„åºåˆ—åŒ–é‡ç‚¹ä¸åŒï¼Œéœ€é’ˆå¯¹æ€§å¤„ç†æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å¯†ç ï¼‰å’Œå†—ä½™ä¿¡æ¯ï¼š</p>
<h4 data-id="heading-19">3.3.1 é”®ç›˜è¾“å…¥äº‹ä»¶ï¼ˆkeydownï¼‰åºåˆ—åŒ–</h4>
<p>éœ€åŒºåˆ† â€œæ™®é€šå­—ç¬¦è¾“å…¥â€ å’Œ â€œåŠŸèƒ½é”®â€ï¼ŒåŒæ—¶å¯¹å¯†ç ç­‰æ•æ„Ÿè¾“å…¥è¿›è¡Œæ©ç å¤„ç†ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šé”®ç›˜è¾“å…¥äº‹ä»¶å¤„ç†</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleKeydown</span>(<span class="hljs-params">e, config</span>) {
  <span class="hljs-keyword">const</span> target = e.<span class="hljs-property">target</span>;
  <span class="hljs-comment">// éšç§å¤„ç†ï¼šå¯†ç è¾“å…¥æ¡†ä¸”å¼€å¯æ©ç ï¼Œä¸è®°å½•çœŸå®å†…å®¹</span>
  <span class="hljs-keyword">const</span> isPasswordInput = target.<span class="hljs-property">tagName</span> === <span class="hljs-string">'INPUT'</span> &amp;&amp; target.<span class="hljs-property">type</span> === <span class="hljs-string">'password'</span>;
  <span class="hljs-keyword">const</span> shouldMask = isPasswordInput &amp;&amp; config.<span class="hljs-property">maskInputPassword</span>;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">targetPath</span>: <span class="hljs-title function_">getNodeUniquePath</span>(target), <span class="hljs-comment">// ç›®æ ‡è¾“å…¥æ¡†è·¯å¾„</span>
    <span class="hljs-attr">key</span>: shouldMask ? <span class="hljs-string">'*'</span> : e.<span class="hljs-property">key</span>, <span class="hljs-comment">// æ•æ„Ÿè¾“å…¥æ›¿æ¢ä¸º*</span>
    <span class="hljs-attr">keyCode</span>: e.<span class="hljs-property">keyCode</span>, <span class="hljs-comment">// æŒ‰é”®ç ï¼ˆå›æ”¾æ—¶æ¨¡æ‹Ÿè¾“å…¥éœ€ç”¨åˆ°ï¼‰</span>
    <span class="hljs-attr">value</span>: shouldMask ? <span class="hljs-string">'*'</span> : target.<span class="hljs-property">value</span>, <span class="hljs-comment">// è¾“å…¥æ¡†å½“å‰å€¼ï¼ˆéæ•æ„Ÿåœºæ™¯ï¼‰</span>
    <span class="hljs-attr">isFunctionalKey</span>: [<span class="hljs-string">'Enter'</span>, <span class="hljs-string">'Backspace'</span>, <span class="hljs-string">'Tab'</span>].<span class="hljs-title function_">includes</span>(e.<span class="hljs-property">key</span>) <span class="hljs-comment">// æ˜¯å¦ä¸ºåŠŸèƒ½é”®</span>
  };
}
</code></pre>
<h4 data-id="heading-20">3.3.2 æ»šåŠ¨äº‹ä»¶ï¼ˆscrollï¼‰åºåˆ—åŒ–</h4>
<p>éœ€åŒºåˆ† â€œé¡µé¢æ»šåŠ¨â€ å’Œ â€œå…ƒç´ æ»šåŠ¨â€ï¼Œé¿å…é‡å¤è®°å½•é«˜é¢‘æ»šåŠ¨äº‹ä»¶ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šæ»šåŠ¨äº‹ä»¶å¤„ç†ï¼ˆå«èŠ‚æµä¼˜åŒ–ï¼‰</span>
<span class="hljs-keyword">let</span> lastScrollTime = <span class="hljs-number">0</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title function_">handleScroll</span>(<span class="hljs-params">e, config</span>) {
  <span class="hljs-keyword">const</span> now = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
  <span class="hljs-comment">// èŠ‚æµä¼˜åŒ–ï¼š50mså†…ä»…è®°å½•1æ¬¡ï¼Œå‡å°‘é«˜é¢‘æ»šåŠ¨å¯¼è‡´çš„æ•°æ®é‡</span>
  <span class="hljs-keyword">if</span> (now - lastScrollTime &lt; <span class="hljs-number">50</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  lastScrollTime = now;
  <span class="hljs-comment">// åŒºåˆ†é¡µé¢æ»šåŠ¨å’Œå…ƒç´ æ»šåŠ¨</span>
  <span class="hljs-keyword">const</span> target = e.<span class="hljs-property">target</span> === <span class="hljs-variable language_">document</span> ? <span class="hljs-variable language_">document</span>.<span class="hljs-property">documentElement</span> : e.<span class="hljs-property">target</span>;
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">targetPath</span>: <span class="hljs-title function_">getNodeUniquePath</span>(target),
    <span class="hljs-attr">scrollTop</span>: target.<span class="hljs-property">scrollTop</span>,
    <span class="hljs-attr">scrollLeft</span>: target.<span class="hljs-property">scrollLeft</span>,
    <span class="hljs-attr">isPageScroll</span>: e.<span class="hljs-property">target</span> === <span class="hljs-variable language_">document</span> <span class="hljs-comment">// æ˜¯å¦ä¸ºé¡µé¢æ»šåŠ¨</span>
  };
}
</code></pre>
<h3 data-id="heading-21">3.4 æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li>
<p><strong>éš¾ç‚¹ 1ï¼šäº‹ä»¶é¡ºåºé”™ä¹±</strong></p>
<p>ä¸åŒäº‹ä»¶çš„è§¦å‘å­˜åœ¨æ—¶é—´å·®ï¼ˆå¦‚ â€œç‚¹å‡»æŒ‰é’®â†’è¾“å…¥æ–‡æœ¬â†’æäº¤è¡¨å•â€ï¼‰ï¼Œè‹¥å½•åˆ¶æ—¶äº‹ä»¶é¡ºåºé”™è¯¯ï¼Œå›æ”¾ä¼šå‡ºç°é€»è¾‘æ··ä¹±ï¼ˆå¦‚æœªè¾“å…¥å°±æäº¤ï¼‰ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>
<p>â‘  æ‰€æœ‰äº‹ä»¶æºå¸¦ç²¾ç¡®æ—¶é—´æˆ³ï¼ˆDate.now()ï¼‰ï¼Œå›æ”¾æ—¶æŒ‰æ—¶é—´æˆ³å‡åºæ‰§è¡Œï¼›</p>
</li>
<li>
<p>â‘¡ å¯¹å­˜åœ¨ä¾èµ–å…³ç³»çš„äº‹ä»¶ï¼ˆå¦‚ â€œclickâ€ åè§¦å‘çš„ â€œkeydownâ€ï¼‰ï¼Œè®°å½•äº‹ä»¶é—´çš„å…³è” IDï¼ˆå¦‚parentEventIdï¼‰ï¼Œç¡®ä¿å›æ”¾æ—¶é¡ºåºä¸€è‡´ã€‚</p>
</li>
</ul>
</li>
</ul>
<h3 data-id="heading-22">3.5 äº‹ä»¶æ•è·æµç¨‹ç¤ºæ„å›¾</h3>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/022ced5baa094839a29a8f042b525a2d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56eL5aSp55qE5LiA6Zi16aOO:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528593&amp;x-signature=KM2%2FXkDZmNplhKC0zCIxuh0YvQ8%3D" alt="image.png" width="100%" loading="lazy"/>
<h2 data-id="heading-23">å››ã€å›æ”¾è¿˜åŸæŠ€æœ¯</h2>
<p><strong>é€šä¿—ç±»æ¯”</strong>ï¼šå›æ”¾å°±åƒ â€œæŒ‰å‰§æœ¬å¤ç°èˆå°å‰§â€â€”â€”DOM å¿«ç…§æ˜¯ â€œåˆå§‹èˆå°å¸ƒç½®â€ï¼Œå¢é‡äº‹ä»¶æ˜¯ â€œèˆå°é“å…·å˜åŒ–æŒ‡ä»¤â€ï¼Œç”¨æˆ·äº¤äº’äº‹ä»¶æ˜¯ â€œæ¼”å‘˜åŠ¨ä½œæŒ‡ä»¤â€ï¼Œrrweb-player åˆ™æ˜¯ â€œå¯¼æ¼”â€ï¼ŒæŒ‰æ—¶é—´é¡ºåºæ‰§è¡Œæ‰€æœ‰æŒ‡ä»¤ï¼Œæœ€ç»ˆè¿˜åŸå®Œæ•´åœºæ™¯ã€‚</p>
<h3 data-id="heading-24">4.1 å›æ”¾æ ¸å¿ƒæµç¨‹</h3>
<p>å›æ”¾è¿‡ç¨‹åˆ†ä¸º <strong>â€œåˆå§‹åŒ–å‡†å¤‡â€</strong> <strong>â€œäº‹ä»¶è°ƒåº¦â€</strong> <strong>â€œçŠ¶æ€åŒæ­¥â€</strong> ä¸‰æ­¥ï¼Œæ ¸å¿ƒæ˜¯ â€œæŒ‰æ—¶é—´æˆ³æ’åºäº‹ä»¶â€ ä¸ â€œç²¾å‡†æ‰§è¡ŒæŒ‡ä»¤â€ï¼š</p>
<h4 data-id="heading-25">4.1.1 åˆå§‹åŒ–å‡†å¤‡ï¼ˆåŠ è½½å¿«ç…§ï¼‰</h4>
<p>å›æ”¾å¼€å§‹æ—¶ï¼Œå…ˆåŸºäº<code>FullSnapshot</code>äº‹ä»¶é‡å»ºåˆå§‹ DOMï¼Œå†åˆå§‹åŒ–èŠ‚ç‚¹è·¯å¾„æ˜ å°„è¡¨ï¼ˆä¾¿äºåç»­å®šä½ç›®æ ‡èŠ‚ç‚¹ï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šå›æ”¾åˆå§‹åŒ–</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RRwebPlayer</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span> = options.<span class="hljs-property">events</span>.<span class="hljs-title function_">sort</span>(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.<span class="hljs-property">timestamp</span> - b.<span class="hljs-property">timestamp</span>); <span class="hljs-comment">// æŒ‰æ—¶é—´æˆ³æ’åº</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span> = options.<span class="hljs-property">target</span>; <span class="hljs-comment">// å›æ”¾å®¹å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(); <span class="hljs-comment">// èŠ‚ç‚¹IDâ†’DOMèŠ‚ç‚¹æ˜ å°„è¡¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initSnapshot</span>(); <span class="hljs-comment">// åŠ è½½åˆå§‹å¿«ç…§</span>
  }
  <span class="hljs-comment">// åŸºäºFullSnapshoté‡å»ºåˆå§‹DOM</span>
  <span class="hljs-title function_">initSnapshot</span>(<span class="hljs-params"/>) {
    <span class="hljs-comment">// æ‰¾åˆ°é¦–å±å¿«ç…§äº‹ä»¶</span>
    <span class="hljs-keyword">const</span> fullSnapshot = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.<span class="hljs-property">type</span> === <span class="hljs-number">2</span>);
    <span class="hljs-keyword">if</span> (!fullSnapshot) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'ç¼ºå°‘é¦–å±å¿«ç…§ï¼Œæ— æ³•å›æ”¾'</span>);
    
    <span class="hljs-comment">// æ¸…ç©ºå®¹å™¨ï¼Œé‡å»ºDOM</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">''</span>;
    <span class="hljs-keyword">const</span> rootNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rebuildNode</span>(fullSnapshot.<span class="hljs-property">data</span>.<span class="hljs-property">node</span>);
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">container</span>.<span class="hljs-title function_">appendChild</span>(rootNode);
    
    <span class="hljs-comment">// åˆå§‹åŒ–èŠ‚ç‚¹æ˜ å°„è¡¨ï¼ˆè®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„å”¯ä¸€IDï¼‰</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildNodeMap</span>(rootNode);
  }
  <span class="hljs-comment">// ä»å¿«ç…§èŠ‚ç‚¹é‡å»ºçœŸå®DOM</span>
  <span class="hljs-title function_">rebuildNode</span>(<span class="hljs-params">snapshotNode</span>) {
    <span class="hljs-keyword">let</span> node;
    <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">type</span> === <span class="hljs-number">1</span>) { <span class="hljs-comment">// å…ƒç´ èŠ‚ç‚¹</span>
      node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(snapshotNode.<span class="hljs-property">tagName</span>);
      <span class="hljs-comment">// è¿˜åŸå±æ€§ï¼ˆidã€classã€srcç­‰ï¼‰</span>
      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(snapshotNode.<span class="hljs-property">attributes</span> || {}).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
        node.<span class="hljs-title function_">setAttribute</span>(key, value);
      });
      <span class="hljs-comment">// è¿˜åŸæ ·å¼ï¼ˆå†…è”å¿«ç…§ä¸­çš„éé»˜è®¤æ ·å¼ï¼‰</span>
      <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">styles</span>) {
        <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(snapshotNode.<span class="hljs-property">styles</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
          node.<span class="hljs-property">style</span>[key] = value;
        });
      }
      <span class="hljs-comment">// è¿˜åŸè¡¨å•çŠ¶æ€ï¼ˆvalueã€checkedï¼‰</span>
      <span class="hljs-keyword">if</span> ([<span class="hljs-string">'INPUT'</span>, <span class="hljs-string">'TEXTAREA'</span>, <span class="hljs-string">'SELECT'</span>].<span class="hljs-title function_">includes</span>(snapshotNode.<span class="hljs-property">tagName</span>.<span class="hljs-title function_">toUpperCase</span>())) {
        node.<span class="hljs-property">value</span> = snapshotNode.<span class="hljs-property">value</span> || <span class="hljs-string">''</span>;
        <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">checked</span> !== <span class="hljs-literal">undefined</span>) node.<span class="hljs-property">checked</span> = snapshotNode.<span class="hljs-property">checked</span>;
      }
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">type</span> === <span class="hljs-number">3</span>) { <span class="hljs-comment">// æ–‡æœ¬èŠ‚ç‚¹</span>
      node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(snapshotNode.<span class="hljs-property">text</span> || <span class="hljs-string">''</span>);
    }
    <span class="hljs-comment">// é€’å½’é‡å»ºå­èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> (snapshotNode.<span class="hljs-property">children</span> &amp;&amp; snapshotNode.<span class="hljs-property">children</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {
      snapshotNode.<span class="hljs-property">children</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">childSnapshot</span> =&gt;</span> {
        <span class="hljs-keyword">const</span> childNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rebuildNode</span>(childSnapshot);
        <span class="hljs-keyword">if</span> (childNode) node.<span class="hljs-title function_">appendChild</span>(childNode);
      });
    }
    <span class="hljs-keyword">return</span> node;
  }
}
</code></pre>
<h4 data-id="heading-26">4.1.2 äº‹ä»¶è°ƒåº¦ï¼ˆæŒ‰æ—¶é—´é¡ºåºæ‰§è¡Œï¼‰</h4>
<p>é‡‡ç”¨ â€œå®šæ—¶å™¨ + äº‹ä»¶é˜Ÿåˆ—â€ æ¨¡å¼ï¼Œæ¨¡æ‹ŸçœŸå®æ—¶é—´æµé€ï¼ŒæŒ‰äº‹ä»¶ timestamp å·®å€¼æ‰§è¡ŒæŒ‡ä»¤ï¼Œæ”¯æŒå€é€Ÿæ’­æ”¾ï¼ˆå¦‚ 1xã€2xã€4xï¼‰ï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šäº‹ä»¶è°ƒåº¦é€»è¾‘</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RRwebPlayer</span> {
  <span class="hljs-comment">// ... åˆå§‹åŒ–é€»è¾‘ ...</span>
  <span class="hljs-comment">// å¼€å§‹å›æ”¾</span>
  <span class="hljs-title function_">play</span>(<span class="hljs-params">speed = <span class="hljs-number">1</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isPlaying</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">playSpeed</span> = speed;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// å½“å‰æ‰§è¡Œåˆ°çš„äº‹ä»¶ç´¢å¼•</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(); <span class="hljs-comment">// å›æ”¾å¼€å§‹æ—¶é—´</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstEventTime</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[<span class="hljs-number">0</span>].<span class="hljs-property">timestamp</span>; <span class="hljs-comment">// ç¬¬ä¸€ä¸ªäº‹ä»¶çš„æ—¶é—´æˆ³</span>
    
    <span class="hljs-comment">// å¯åŠ¨è°ƒåº¦å™¨</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">scheduler</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeEvents</span>(), <span class="hljs-number">16</span>); <span class="hljs-comment">// çº¦60fpsï¼Œæµç•…åº¦ä¼˜å…ˆ</span>
  }
  <span class="hljs-comment">// æ‰§è¡Œå½“å‰æ—¶é—´ç‚¹åº”è§¦å‘çš„äº‹ä»¶</span>
  <span class="hljs-title function_">executeEvents</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isPlaying</span>) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">const</span> currentPlayTime = <span class="hljs-variable language_">this</span>.<span class="hljs-property">firstEventTime</span> + (<span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">startTime</span>) * <span class="hljs-variable language_">this</span>.<span class="hljs-property">playSpeed</span>;
    
    <span class="hljs-comment">// æ‰§è¡Œæ‰€æœ‰timestamp &lt;= å½“å‰æ’­æ”¾æ—¶é—´çš„äº‹ä»¶</span>
    <span class="hljs-keyword">while</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-property">length</span>) {
      <span class="hljs-keyword">const</span> event = <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span>];
      <span class="hljs-keyword">if</span> (event.<span class="hljs-property">timestamp</span> &gt; currentPlayTime) <span class="hljs-keyword">break</span>;
      
      <span class="hljs-comment">// æ ¹æ®äº‹ä»¶ç±»å‹æ‰§è¡Œå¯¹åº”æ“ä½œ</span>
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeEvent</span>(event);
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span>++;
    }
    <span class="hljs-comment">// å›æ”¾ç»“æŸï¼Œæ¸…é™¤å®šæ—¶å™¨</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentEventIndex</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">events</span>.<span class="hljs-property">length</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">pause</span>();
      <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFinish</span>?.();
    }
  }
  <span class="hljs-comment">// æ‰§è¡Œå•ä¸ªäº‹ä»¶</span>
  <span class="hljs-title function_">executeEvent</span>(<span class="hljs-params">event</span>) {
    <span class="hljs-keyword">switch</span> (event.<span class="hljs-property">type</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: <span class="hljs-comment">// Mutationäº‹ä»¶ï¼ˆå¢é‡æ›´æ–°ï¼‰</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeMutation</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: <span class="hljs-comment">// clickäº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeClick</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>: <span class="hljs-comment">// é”®ç›˜äº‹ä»¶</span>
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">executeKeyEvent</span>(event.<span class="hljs-property">data</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-comment">// å…¶ä»–äº‹ä»¶ç±»å‹æ‰§è¡Œé€»è¾‘...</span>
    }
  }
}
</code></pre>
<h4 data-id="heading-27">4.1.3 å¢é‡äº‹ä»¶æ‰§è¡Œï¼ˆä»¥ Mutation ä¸ºä¾‹ï¼‰</h4>
<p>æ ¹æ®å¢é‡äº‹ä»¶ç±»å‹ï¼Œæ‰§è¡Œ â€œèŠ‚ç‚¹æ–°å¢ / åˆ é™¤â€â€œå±æ€§ä¿®æ”¹â€â€œæ–‡æœ¬æ›´æ–°â€ ç­‰æ“ä½œï¼š</p>
<pre><code class="hljs language-js" lang="js"><span class="hljs-comment">// ä¼ªä»£ç ï¼šæ‰§è¡ŒMutationå¢é‡äº‹ä»¶</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">RRwebPlayer</span> {
  <span class="hljs-comment">// ... å…¶ä»–æ–¹æ³• ...</span>
  <span class="hljs-title function_">executeMutation</span>(<span class="hljs-params">mutationData</span>) {
    <span class="hljs-comment">// å®šä½ç›®æ ‡èŠ‚ç‚¹ï¼ˆé€šè¿‡è·¯å¾„æˆ–èŠ‚ç‚¹IDï¼‰</span>
    <span class="hljs-keyword">const</span> targetNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTargetNode</span>(mutationData.<span class="hljs-property">targetPath</span> || mutationData.<span class="hljs-property">parentPath</span>);
    <span class="hljs-keyword">if</span> (!targetNode) <span class="hljs-keyword">return</span>;
    <span class="hljs-keyword">switch</span> (mutationData.<span class="hljs-property">type</span>) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">'childList'</span>: <span class="hljs-comment">// å­èŠ‚ç‚¹å˜åŒ–</span>
        <span class="hljs-comment">// æ–°å¢èŠ‚ç‚¹</span>
        mutationData.<span class="hljs-property">addedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">childSnapshot</span> =&gt;</span> {
          <span class="hljs-keyword">const</span> childNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">rebuildNode</span>(childSnapshot);
          <span class="hljs-keyword">if</span> (mutationData.<span class="hljs-property">nextSiblingId</span>) {
            <span class="hljs-comment">// æ’å…¥åˆ°å‚è€ƒèŠ‚ç‚¹ä¹‹å‰</span>
            <span class="hljs-keyword">const</span> nextSibling = <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeMap</span>.<span class="hljs-title function_">get</span>(mutationData.<span class="hljs-property">nextSiblingId</span>);
            targetNode.<span class="hljs-title function_">insertBefore</span>(childNode, nextSibling);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-comment">// æ’å…¥åˆ°æœ«å°¾</span>
            targetNode.<span class="hljs-title function_">appendChild</span>(childNode);
          }
          <span class="hljs-comment">// æ›´æ–°èŠ‚ç‚¹æ˜ å°„è¡¨</span>
          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildNodeMap</span>(childNode);
        });
        <span class="hljs-comment">// åˆ é™¤èŠ‚ç‚¹</span>
        mutationData.<span class="hljs-property">removedNodes</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">childSnapshot</span> =&gt;</span> {
          <span class="hljs-keyword">const</span> childNode = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getTargetNodeBySnapshot</span>(childSnapshot);
          <span class="hljs-keyword">if</span> (childNode &amp;&amp; childNode.<span class="hljs-property">parentElement</span> === targetNode) {
            targetNode.<span class="hljs-title function_">removeChild</span>(childNode);
            <span class="hljs-variable language_">this</span>.<span class="hljs-property">nodeMap</span>.<span class="hljs-title function_">delete</span>(childNode.<span class="hljs-property">__rrwebId</span>); <span class="hljs-comment">// ä»æ˜ å°„è¡¨ç§»é™¤</span>
          }
        });
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'attributes'</span>: <span class="hljs-comment">// å±æ€§ä¿®æ”¹</span>
        targetNode.<span class="hljs-title function_">setAttribute</span>(mutationData.<span class="hljs-property">attributeName</span>, mutationData.<span class="hljs-property">newValue</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">'characterData'</span>: <span class="hljs-comment">// æ–‡æœ¬ä¿®æ”¹</span>
        targetNode.<span class="hljs-property">textContent</span> = mutationData.<span class="hljs-property">newValue</span>;
        <span class="hljs-keyword">break</span>;
    }
  }
}
</code></pre>
<h3 data-id="heading-28">4.2 æŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ</h3>
<ul>
<li><strong>éš¾ç‚¹ 1ï¼šäº‹ä»¶æ‰§è¡Œé¡ºåºåå·®</strong></li>
</ul>
<p>å½•åˆ¶æ—¶äº‹ä»¶æŒ‰çœŸå®æ—¶é—´æˆ³å­˜å‚¨ï¼Œä½†å›æ”¾æ—¶è‹¥å®šæ—¶å™¨ç²¾åº¦ä¸è¶³ï¼ˆå¦‚ setInterval å­˜åœ¨å»¶è¿Ÿï¼‰ï¼Œå¯èƒ½å¯¼è‡´ â€œå…ˆæ‰§è¡Œç‚¹å‡»ã€åæ‰§è¡Œ DOM æ›´æ–°â€ çš„é¡ºåºé”™è¯¯ï¼Œå¼•å‘åœºæ™¯æ··ä¹±ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
â‘  äº‹ä»¶é˜Ÿåˆ—æŒ‰ timestamp ä¸¥æ ¼æ’åºï¼Œæ‰§è¡Œæ—¶é€šè¿‡ â€œå½“å‰æ’­æ”¾æ—¶é—´ = é¦–äº‹ä»¶æ—¶é—´ +ï¼ˆå½“å‰æ—¶é—´ - å›æ”¾å¼€å§‹æ—¶é—´ï¼‰Ã— å€é€Ÿâ€ ç²¾å‡†è®¡ç®—åº”æ‰§è¡Œçš„äº‹ä»¶ï¼›</p>
<p>â‘¡ å¯¹ä¾èµ– DOM çŠ¶æ€çš„äº‹ä»¶ï¼ˆå¦‚ clickï¼‰ï¼Œå¢åŠ  â€œDOM å°±ç»ªæ£€æŸ¥â€ï¼Œç¡®ä¿å¢é‡æ›´æ–°æ‰§è¡Œå®Œæˆåå†è§¦å‘äº¤äº’äº‹ä»¶ã€‚</p>
<ul>
<li><strong>éš¾ç‚¹ 2ï¼šå›æ”¾æ—¶èŠ‚ç‚¹å®šä½å¤±è´¥</strong></li>
</ul>
<p>è‹¥å½•åˆ¶æ—¶ DOM ç»“æ„åŠ¨æ€å˜åŒ–ï¼ˆå¦‚ Vue åˆ—è¡¨é‡æ–°æ¸²æŸ“ï¼‰ï¼Œå›æ”¾æ—¶å¯èƒ½å‡ºç° â€œè·¯å¾„æ‰¾ä¸åˆ°èŠ‚ç‚¹â€ çš„é—®é¢˜ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>â‘  é‡‡ç”¨ â€œèŠ‚ç‚¹ ID ä¼˜å…ˆã€è·¯å¾„é™çº§â€ çš„å®šä½ç­–ç•¥ï¼Œå½•åˆ¶æ—¶ä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…<code>\_\_rrwebId</code>ï¼Œå›æ”¾æ—¶ä¼˜å…ˆé€šè¿‡ ID å®šä½ï¼›</li>
<li>â‘¡ è·¯å¾„å®šä½æ—¶æ”¯æŒ â€œæ¨¡ç³ŠåŒ¹é…â€ï¼ˆå¦‚å¿½ç•¥åŠ¨æ€ç´¢å¼•ï¼Œé€šè¿‡ç±»å + æ ‡ç­¾åç»„åˆå®šä½ï¼‰ï¼›</li>
<li>â‘¢ å®šä½å¤±è´¥æ—¶è§¦å‘ â€œé™çº§å¤„ç†â€ï¼ˆå¦‚è·³è¿‡è¯¥äº‹ä»¶ï¼Œé¿å…æ•´ä¸ªå›æ”¾å´©æºƒï¼‰ã€‚</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[åŸºäºNettyçš„TCPåè®®çš„SocketæœåŠ¡ç«¯]]></title>    <link>https://juejin.cn/post/7592903126177792050</link>    <guid>https://juejin.cn/post/7592903126177792050</guid>    <pubDate>2026-01-09T01:18:09.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592903126177792050" data-draft-id="7592884480731267118" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="åŸºäºNettyçš„TCPåè®®çš„SocketæœåŠ¡ç«¯"/> <meta itemprop="keywords" content="åç«¯,Java,ç¨‹åºå‘˜"/> <meta itemprop="datePublished" content="2026-01-09T01:18:09.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SimonKing"/> <meta itemprop="url" content="https://juejin.cn/user/4001878056904584"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            åŸºäºNettyçš„TCPåè®®çš„SocketæœåŠ¡ç«¯
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4001878056904584/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SimonKing
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:18:09.000Z" title="Fri Jan 09 2026 01:18:09 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p>å…³æ³¨æˆ‘çš„å…¬ä¼—å·ï¼šã€ç¼–ç¨‹æœèŠ±å¤•æ‹¾ã€‘ï¼Œå¯è·å–é¦–å‘å†…å®¹ã€‚</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/40b53a2b2228449aa7af28c2f736c676~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526289&amp;x-signature=qFmx82yE%2FPNijL2%2FL7gPieSubaE%3D" alt="" loading="lazy"/></p>
<h2 data-id="heading-0">01 å¼•è¨€</h2>
<p>ä¸Šä¸€èŠ‚åˆ†äº«<code>Websocket</code>ç‹¬ç«‹éƒ¨ç½²çš„ä¸€ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ä»¬ä»Šå¤©æ¥ç€èŠä¸€ä¸‹åŸºäºNettyçš„TCPåè®®çš„SocketæœåŠ¡ç«¯å¦‚ä½•æ­å»ºã€‚è¿™ä¸ªå¯¹äºç†Ÿæ‚‰çš„äººå¯èƒ½å¾ˆç®€å•ï¼Œä½†æ˜¯å¯¹äºæ–°æ‰‹æˆ–è€…ä¸å¸¸ç”¨çš„å¼€å‘è€…æ¥è¯´ï¼Œå¯èƒ½ä¸€å¤´é›¾æ°´ã€‚</p>
<p>å°ç¼–åœ¨åˆæ¬¡ä½¿ç”¨<code>Socket</code>çš„æ—¶å€™ï¼Œéƒ½æ˜¯åº¦å¨˜ä¸€å¤§å †ï¼Œç„¶åæŠ„æŠ„æŠ„ï¼Œå®Œæˆè‡ªå·±çš„ä»»åŠ¡ã€‚è‡³äºä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œå®Œå…¨ä¸çŸ¥é“ã€‚è¿™ä¸€èŠ‚å°†è‡ªå·±çš„ç†è§£åˆ†äº«å¹¶è®°å½•ä¸‹æ¥ï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚</p>
<h2 data-id="heading-1">02 æœåŠ¡ç«¯æ¡ˆä¾‹</h2>
<h3 data-id="heading-2">2.1 ä»£ç å±•ç¤º</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// åˆ›å»ºçº¿ç¨‹ç»„</span>
    <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);
    <span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">5</span>);

    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// æœåŠ¡ç«¯ç±»</span>
        <span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">serverBootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();
        <span class="hljs-comment">// æ·»åŠ ç»„</span>
        serverBootstrap.group(bossGroup, workGroup);
        <span class="hljs-comment">// è®¾ç½®NioServerSocketChannelé€šé“</span>
        serverBootstrap.channel(NioServerSocketChannel.class);
        <span class="hljs-comment">// è¿æ¥é˜Ÿåˆ—å¤§å°</span>
        serverBootstrap.option(ChannelOption.SO_BACKLOG, <span class="hljs-number">1024</span>)ï¼›
        <span class="hljs-comment">// ä¿æŒè¿æ¥</span>
        serverBootstrap.childOption(ChannelOption.SO_KEEPALIVE, <span class="hljs-literal">true</span>); 
        serverBootstrap.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;(){
            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel socketChannel)</span> <span class="hljs-keyword">throws</span> Exception {
                <span class="hljs-comment">// è®¾ç½®å¤„ç†å™¨é“¾ï¼Œä¾æ¬¡æ‰§è¡Œ</span>
                <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> socketChannel.pipeline();
                pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DelimiterBasedFrameDecoder</span>(<span class="hljs-number">2048</span>, Unpooled.copiedBuffer(<span class="hljs-string">"_"</span>.getBytes())));
                pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>(StandardCharsets.UTF_8));
                pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringEncoder</span>(StandardCharsets.UTF_8));
                <span class="hljs-comment">// è‡ªå®šä¹‰çš„handlerï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘</span>
                pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BusinessHandler</span>&lt;&gt;());    
            }
        });

        <span class="hljs-comment">// é…ç½®å®Œæˆï¼Œå¼€å§‹ç»‘å®šserverï¼Œé€šè¿‡è°ƒç”¨syncåŒæ­¥æ–¹æ³•é˜»å¡ç›´åˆ°ç»‘å®šæˆåŠŸ</span>
        <span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> serverBootstrap.bind(<span class="hljs-number">9091</span>).sync();
        log.info(<span class="hljs-string">"Server started and listen on:{}"</span>,channelFuture.channel().localAddress());
        <span class="hljs-comment">// å¯¹å…³é—­é€šé“è¿›è¡Œç›‘å¬</span>
        channelFuture.channel().closeFuture().sync();
    } <span class="hljs-keyword">catch</span> (Exception e) {
        log.error(<span class="hljs-string">"ä¿¡æ¯å¼‚å¸¸ï¼š"</span>, e);
    }<span class="hljs-keyword">finally</span> {
        bossGroup.close();
        workGroup.close();
    }
}
</code></pre>
<h3 data-id="heading-3">2.2 åˆ›å»ºçº¿ç¨‹ç»„</h3>
<pre><code class="hljs language-java" lang="java"> <span class="hljs-comment">// åˆ›å»ºçº¿ç¨‹ç»„</span>
<span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">bossGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">1</span>);
<span class="hljs-type">EventLoopGroup</span> <span class="hljs-variable">workGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NioEventLoopGroup</span>(<span class="hljs-number">5</span>);
</code></pre>
<p><code>EventLoopGroup</code>å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ã€‚åœ¨<code>Netty</code>çš„<code>Socket</code>ä¸­éœ€è¦ä¸¤ä¸ªä¸åŒçš„çº¿ç¨‹æ± ï¼Œåˆ†åˆ«å¤„ç†ä¸åŒçš„ä»»åŠ¡ã€‚å…¶ä¸­<code>bossGroup</code>ç”¨æ¥æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ï¼Œé€šå¸¸è®¾ç½®1ä¸ªçº¿ç¨‹ï¼Œè€Œ<code>workGroup</code>ç”¨æ¥å¤„ç†I/Oæ“ä½œå’Œä¸šåŠ¡é€»è¾‘ï¼Œå¯ä»¥æ ¹æ®CPUçš„æ ¸å¿ƒæ•°æŒ‡å®šã€‚</p>
<h3 data-id="heading-4">2.3 åˆ›å»ºæœåŠ¡ç«¯</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// æœåŠ¡ç«¯ç±»</span>
<span class="hljs-type">ServerBootstrap</span> <span class="hljs-variable">bootstrap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServerBootstrap</span>();
<span class="hljs-comment">// æ·»åŠ ç»„</span>
serverBootstrap.group(bossGroup, workGroup);
<span class="hljs-comment">// è®¾ç½®NioServerSocketChannelé€šé“</span>
serverBootstrap.channel(NioServerSocketChannel.class);
<span class="hljs-comment">// è¿æ¥é˜Ÿåˆ—å¤§å°</span>
serverBootstrap.option(ChannelOption.SO_BACKLOG, <span class="hljs-number">1024</span>)ï¼›
<span class="hljs-comment">// ä¿æŒè¿æ¥</span>
serverBootstrap.childOption(ChannelOption.SO_KEEPALIVE, <span class="hljs-literal">true</span>);
</code></pre>
<p>æœåŠ¡ç«¯å¼•å¯¼ç±»åˆ›å»ºå®Œæˆä¹‹åï¼Œéœ€è¦è®¾ç½®å‚æ•°ï¼š</p>
<ul>
<li>group()ï¼šæ·»åŠ çº¿ç¨‹æ± ç»„ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º<code>bossGroup</code>ï¼Œç¬¬äºŒä¸ªæ˜¯<code>workGroup</code></li>
<li>channel()ï¼šè®¾ç½®<code>NioServerSocketChannel</code>é€šé“</li>
<li>option()ï¼šé…ç½®æœåŠ¡ç«¯ç›‘å¬çš„<code>ServerSocketChannel</code></li>
<li>childOption()ï¼šé…ç½®å®¢æˆ·ç«¯è¿æ¥çš„<code>SocketChannel</code></li>
</ul>
<p>æ‰€ä»¥è¿™é‡Œçš„<code>ChannelOption.SO_BACKLOG</code>åªèƒ½è®¾ç½®åœ¨<code>option</code>ä¸­ï¼Œç”¨æ¥æŒ‡å®šæœåŠ¡ç«¯æ¥æ”¶çš„ä»»åŠ¡æœ€å¤§é˜Ÿåˆ—ã€‚<code>ChannelOption.SO_KEEPALIVE</code>ç”¨æ¥TCPä¿æ´»æœºåˆ¶ï¼Œæ£€æµ‹æ­»è¿æ¥ï¼Œæ˜¯é’ˆå¯¹å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®åœ¨<code>childOption</code>ä¸Šã€‚</p>
<p><code>ChannelOption.SO_KEEPALIVE</code>ä¹Ÿå¯ä»¥ä¸åŒè®¾ç½®ï¼Œé‡‡ç”¨å¿ƒè·³æœºåˆ¶æ¥ä¿æ´»ã€‚å…¶ä½¿ç”¨æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œé€šå¸¸éƒ½ä¼šé€šè¿‡å¿ƒè·³æœºåˆ¶æ¥ä»£æ›¿ã€‚</p>
<h3 data-id="heading-5">2.4 è®¾ç½®å¤„ç†é“¾</h3>
<pre><code class="hljs language-java" lang="java">serverBootstrap.childHandler(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ChannelInitializer</span>&lt;SocketChannel&gt;(){
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initChannel</span><span class="hljs-params">(SocketChannel socketChannel)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// è®¾ç½®å¤„ç†å™¨é“¾ï¼Œä¾æ¬¡æ‰§è¡Œ</span>
        <span class="hljs-type">ChannelPipeline</span> <span class="hljs-variable">pipeline</span> <span class="hljs-operator">=</span> socketChannel.pipeline();
      
        pipeline.addLast(<span class="hljs-string">"..."</span>); 
        pipeline.addLast(<span class="hljs-string">"..."</span>);  
    }
});
</code></pre>
<p>é‡‡ç”¨è´£ä»»é“¾æ¨¡å¼ï¼Œæ¯ä¸ªå¤„ç†å™¨å¤„ç†ç‰¹å®šä»»åŠ¡ï¼Œä¾æ¬¡æ‰§è¡Œã€‚é‡Œé¢å…·ä½“çš„<code>Handler</code>å•ç‹¬è¯´æ˜ã€‚</p>
<h3 data-id="heading-6">2.5 ç»‘å®šç«¯å£ï¼ŒåŒæ­¥é˜»å¡</h3>
<pre><code class="hljs language-java" lang="java"><span class="hljs-comment">// é…ç½®å®Œæˆï¼Œå¼€å§‹ç»‘å®šserverï¼Œé€šè¿‡è°ƒç”¨syncåŒæ­¥æ–¹æ³•é˜»å¡ç›´åˆ°ç»‘å®šæˆåŠŸ</span>
<span class="hljs-type">ChannelFuture</span> <span class="hljs-variable">channelFuture</span> <span class="hljs-operator">=</span> serverBootstrap.bind(<span class="hljs-number">9091</span>).sync();
<span class="hljs-comment">// å¯¹å…³é—­é€šé“è¿›è¡Œç›‘å¬</span>
channelFuture.channel().closeFuture().sync();
</code></pre>
<p>å½“å‰æœåŠ¡ç«¯ç»‘å®šä¸€ä¸ªç«¯å£ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥é€šè¿‡å½“å‰ç«¯å£è¿æ¥ï¼Œå¹¶åŒæ­¥é˜»å¡ï¼Œç­‰å¾…ç«¯å£ç»‘å®šæˆåŠŸã€‚æœ€ååŒæ­¥é˜»å¡ç­‰å¾…é€šè¿‡å…³é—­ã€‚</p>
<h2 data-id="heading-7">03 æ¶ˆæ¯å¤„ç†</h2>
<p>æ¶ˆæ¯çš„å¤„ç†æ˜¯æ¥å—å’Œæ¨é€æ¶ˆæ¯é‡è¦éƒ¨åˆ†ã€‚<code>Netty</code>æ¡†æ¶æä¾›äº†ä¸°å¯Œçš„å¤„ç†å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©é€‚åˆè‡ªå·±çš„å¤„ç†å™¨ã€‚å¤„ç†å™¨éƒ½æ˜¯å®ç°<code>io.netty.channel.ChannelInboundHandler</code>æ¥å£</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/10f257724c4f430d8fc42076c9d30588~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526289&amp;x-signature=zvnBXknvXTxwYTLlo0PGKTBgYmM%3D" alt="" loading="lazy"/></p>
<h3 data-id="heading-8">3.1 æ¡†æ¶è‡ªå¸¦ç¼–è§£ç å™¨</h3>
<p><code>Netty</code>æ¡†æ¶ä¸‹çš„Socketæ•°æ®ä¼ è¾“ï¼Œé»˜è®¤éƒ½æ˜¯<code>ByteBuf</code>ï¼ˆå­—èŠ‚ç¼“å†²ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨çš„æ—¶å€™è‡ªç„¶æƒ³é€šè¿‡å¸¸ç”¨çš„å­—ç¬¦ä¸²ä¼ è¾“ï¼Œè€Œ<code>Netty</code>è‡ªç„¶å¸®æˆ‘ä»¬æä¾›äº†å­—ç¬¦ä¸²ç›¸å…³çš„ç¼–è§£ç å¤„ç†å™¨ã€‚</p>
<ul>
<li><code>io.netty.handler.codec.string.StringDecoder</code></li>
<li><code>io.netty.handler.codec.string.StringEncoder</code></li>
</ul>
<p>é€šè¿‡æºç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ³¨é‡Šï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3446ecfbe67d4a5bbd54f4f7073ee95a~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526289&amp;x-signature=3YVfWVvHQUuWJ61ds68L4V7K4VM%3D" alt="" loading="lazy"/></p>
<p><code>StringDecoder</code>æ˜¯å°†<code>ByteBuf</code>è½¬æˆå­—ç¬¦ä¸²çš„è§£ç å™¨ï¼Œä½†æ˜¯åœ¨å¤„ç†ä¹‹å‰å¿…é¡»ä½¿ç”¨<code>ByteToMessageDecoder</code>å…ˆè§£ç ï¼Œå­ç±»åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>io.netty.handler.codec.DelimiterBasedFrameDecoder</code>ï¼šåˆ†éš”ç¬¦åˆ†å‰²</li>
<li><code>io.netty.handler.codec.FixedLengthFrameDecoder</code>ï¼šå›ºå®šé•¿åº¦åˆ†å‰²</li>
<li><code>io.netty.handler.codec.LengthFieldBasedFrameDecoder</code>ï¼šæŒ‰ç…§å­—æ®µé•¿åº¦åˆ†å‰²</li>
<li><code>io.netty.handler.codec.LineBasedFrameDecoder</code>ï¼šæŒ‰è¡Œåˆ†å‰²</li>
</ul>
<p>è¿™å‡ ç§æ–¹å¼éƒ½æ˜¯æœ‰æ•ˆé˜²æ­¢æ‹†åŒ…ã€ç²˜åŒ…çš„æ–¹æ³•ã€‚</p>
<p>æŒ‰ç…§æ³¨é‡Šçš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é…ç½®ã€‚è€Œ<code>StringEncoder</code>æ˜¯ç”¨æ¥å‘é€æ¶ˆæ¯çš„è§£ç å™¨ï¼Œç”¨æ¥å°†å­—ç¬¦ä¸²è½¬æˆ<code>ByteBuf</code>ã€‚</p>
<p>æˆ‘ä»¬è¿™é‡Œé‡‡ç”¨åˆ†éš”ç¬¦çš„æ–¹å¼åˆ†å‰²ï¼š</p>
<pre><code class="hljs language-java" lang="java">pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DelimiterBasedFrameDecoder</span>(<span class="hljs-number">2048</span>, Unpooled.copiedBuffer(<span class="hljs-string">"_"</span>.getBytes())));
pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringDecoder</span>(StandardCharsets.UTF_8));
pipeline.addLast(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringEncoder</span>(StandardCharsets.UTF_8));
</code></pre>
<p>è€Œå…¶ä¸­<code>DelimiterBasedFrameDecoder</code>çš„<code>maxFrameLength</code>å‚æ•°ç”¨æ¥æ§åˆ¶æ¥æ”¶æ¶ˆæ¯çš„æœ€å¤§å­—èŠ‚å¤§å°ï¼Œè¶…è¿‡å°±ä¼šå¼‚å¸¸ã€‚</p>
<h3 data-id="heading-9">3.2 è‡ªå®šä¹‰ä¸šåŠ¡å¤„ç†å™¨</h3>
<p>è‡ªå®šä¹‰ä¸šåŠ¡å¤„ç†å™¨æ˜¯ç”¨æ¥å¤„ç†å®¢æˆ·ç«¯è¿æ¥ä»¥åŠæ¶ˆæ¯çš„ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-meta">@Slf4j</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BusinessHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SimpleChannelInboundHandler</span> {
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handlerAdded</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// å»ºç«‹å®¢æˆ·ç«¯</span>
        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> ctx.channel();
        log.info(<span class="hljs-string">"Socketå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼šchannelId={}"</span>, channel.id());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handlerRemoved</span><span class="hljs-params">(ChannelHandlerContext ctx)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// æ–­å¼€é“¾æ¥</span>
        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> ctx.channel();
        log.info(<span class="hljs-string">"Socketå®¢æˆ·ç«¯æ–­å¼€è¿æ¥ï¼šchannelId={}"</span>, channel.id());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">channelRead0</span><span class="hljs-params">(ChannelHandlerContext ctx, Object msg)</span> <span class="hljs-keyword">throws</span> Exception {
        <span class="hljs-comment">// æ¥å—æ¶ˆæ¯</span>
        <span class="hljs-type">Channel</span> <span class="hljs-variable">channel</span> <span class="hljs-operator">=</span> ctx.channel();
        log.info(<span class="hljs-string">"Socketæ”¶åˆ°æ¥è‡ªé€šé“channelId[{}]å‘é€çš„æ¶ˆæ¯ï¼š{}"</span>, channel.id(), msg);
        <span class="hljs-comment">// é€šè¿‡WebSocketå°†æ–¹æ³•å‘é€ç»™å®¢æˆ·ç«¯</span>
        channel.writeAndFlush(msg + <span class="hljs-string">"789_000"</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exceptionCaught</span><span class="hljs-params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="hljs-keyword">throws</span> Exception {
        log.info(<span class="hljs-string">"å¼‚å¸¸ï¼š"</span>, cause);
    }
}
</code></pre>
<p><strong>handlerAdded()</strong></p>
<p>å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ä¹‹åä¼šè§¦å‘è¯¥æ–¹æ³•ã€‚å¯ä»¥é€šè¿‡<code>ctx.channel()</code>è·å–æ¥è¿æ¥çš„é€šé“ï¼ˆå®¢æˆ·ç«¯ï¼‰ã€‚è¿æ¥çš„é€šå¸¸å¯ä»¥é€šè¿‡<code>io.netty.channel.group.ChannelGroup</code>æ”¶é›†ã€‚</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-type">ChannelGroup</span> <span class="hljs-variable">channelGroup</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DefaultChannelGroup</span>(GlobalEventExecutor.INSTANCE)
channelGroup.add(channel);
</code></pre>
<p>å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯æ—¶ï¼Œå¯ä»¥é€šè¿‡<code>channelGroup.writeAndFlush()</code>ç»Ÿä¸€ç»™å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ã€‚</p>
<p><strong>handlerRemoved()</strong></p>
<p>å®¢æˆ·ç«¯æ–­å¼€è¿æ¥çš„æ—¶è§¦å‘ï¼Œå¯ä»¥é€šè¿‡<code>channelGroup.remove(channel)</code>ç§»é™¤å·²ç»å…³é—­çš„å®¢æˆ·ç«¯é€šé“</p>
<p><strong>channelRead0()</strong></p>
<p>æ¥æ”¶å®¢æˆ·ç«¯æ¶ˆæ¯çš„é‡è¦æ–¹æ³•ï¼Œé€šè¿‡<code>channel.writeAndFlush()</code>å¯ä»¥ç›´æ¥å‘å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯</p>
<p><strong>exceptionCaught()</strong></p>
<p>å¤„ç†å¼‚å¸¸çš„æ–¹æ³•</p>
<h3 data-id="heading-10">3.3 å®¢æˆ·ç«¯æµ‹è¯•</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/f9a650b8a56147df80a7e5c01054dba8~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526289&amp;x-signature=a1Bpa31M0yrWhMUwVbYYlxbYTlk%3D" alt="" loading="lazy"/></p>
<p>ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œä»‹ç»çš„æ–¹æ³•éƒ½è¢«è§¦å‘äº†ã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c822ddfe1a364d779ff9a814448f3afc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgU2ltb25LaW5n:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768526289&amp;x-signature=xIyskKp9eWRcTh236r0eEl1xT80%3D" alt="" loading="lazy"/></p>
<p>ä»å›¾å¯ä»¥çœ‹å‡ºå®¢æˆ·ç«¯çš„ä¹Ÿæ¥æ”¶åˆ°æœåŠ¡ç«¯çš„æ¶ˆæ¯äº†ã€‚</p>
<p><strong>æ³¨æ„</strong></p>
<p>å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯ï¼šfoo test..._</p>
<p>æœåŠ¡ç«¯å‘é€çš„æ¶ˆæ¯ï¼šfoo test...789_000</p>
<p>å®¢æˆ·ç«¯æ¥å—çš„æ¶ˆæ¯ï¼šfoo test...789</p>
<p>å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°çš„æ¶ˆæ¯éƒ½é€šè¿‡<code>_</code>æˆªæ–­çš„</p>
<h2 data-id="heading-11">04 å°ç»“</h2>
<p>ç®€å•çš„æœåŠ¡ç«¯æ­å»ºå°±å·²ç»å¥½äº†ï¼Œä½†æ˜¯å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œè¿˜éœ€è¦è€ƒè™‘å¿ƒè·³æœºåˆ¶ã€ä»¥åŠæ— æ•ˆå®¢æˆ·ç«¯çš„æ¸…ç†ç­‰ã€‚<code>TCP</code>åè®®æœåŠ¡ç«¯çš„ä»‹ç»å°±åˆ°è¿™é‡Œï¼Œå®¢æˆ·ç«¯æˆ‘ä»¬ä¸‹ä¸€æœŸä»‹ç»ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[LangChain å®æˆ˜ | å¿«é€Ÿæ­å»º Python å¼€å‘ç¯å¢ƒ]]></title>    <link>https://juejin.cn/post/7593165280488194089</link>    <guid>https://juejin.cn/post/7593165280488194089</guid>    <pubDate>2026-01-09T09:33:35.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593165280488194089" data-draft-id="7580723992498110500" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="LangChain å®æˆ˜ | å¿«é€Ÿæ­å»º Python å¼€å‘ç¯å¢ƒ"/> <meta itemprop="keywords" content="LangChain,LLM,Python"/> <meta itemprop="datePublished" content="2026-01-09T09:33:35.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="è¿›å‡»çš„æ¾é¼ "/> <meta itemprop="url" content="https://juejin.cn/user/2749193011073976"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            LangChain å®æˆ˜ | å¿«é€Ÿæ­å»º Python å¼€å‘ç¯å¢ƒ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2749193011073976/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    è¿›å‡»çš„æ¾é¼ 
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T09:33:35.000Z" title="Fri Jan 09 2026 09:33:35 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    10
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{position:relative;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:30px;margin-bottom:5px}.markdown-body h2{font-size:24px;display:inline-block;font-weight:700;background:#ef7060;color:#fff;padding:6px 8px 0 0;border-top-right-radius:6px;margin-right:2px;box-shadow:6px 3px 0 0 rgba(239,112,96,.2)}.markdown-body h2:before{content:" ";display:inline-block;width:8px}.markdown-body h2:after{content:" ";position:absolute;display:block;width:calc(100% - 50px);border-bottom:3px solid #ef7060}.markdown-body h3{font-size:18px;padding-bottom:0}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:15px}.markdown-body h6{margin-top:5px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #3e3e3e;margin-top:32px;margin-bottom:32px;height:1px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(27,31,35,.05);color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:JetBranins Mono,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px}.markdown-body pre:before{content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAdCAYAAABcz8ldAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAhgSURBVGhD7Zp7bBTHHcdn33t7vvOdzy+ITVKDU0xIKG2ABCPTRCCaUiEVKWoqRJuASAhCitRCVKSoalFUKZBiSmmFRRJKRUnUtIpo+aNqGgwoOCmuFUIRzxjwE4zte+97drYzztji8HPvtkit/PnH+n1397Tz+83vN/PbMZhmmmmm+d+BoX8n5diihcGqgFQf5vk6BMAskWUlw3GyFnIvtqWSf91w7mKC3npfOLX7wYeiIa6BBWCOLLFRF2NB0JvIOP/80YG+k2ev6S699b/OzOfKBW5l5KsgyC4DCFQDnpEAdE1goc/dlNPc/Up7P711UiYNSMuyxeUzZPnHgGHWh5XADEkSAcdiN+AnEXIBhBComgFU0/xQR+jnj51sOUMf9Z0NKyL8S9+JPBEN8zuCMrsqGOA5QWAAyzLAxe53HBeYFgJp1c5Cx33nyIfpV3e+22/Sx32nev/sMCgVnmM4bjOniAtZWQAsz315EfsGQQc4hgWcjHkCmOj1rheuNn95cXwmDMiVp5etC/D8m5FwUWVQUYYGPh6mZYFUOgsGVa1pXvOZzVT2jRuH54RM230jEuI3RcIiL4l4UkxAJmuD/riVsqD7ct2m9nep7BtVTbVfZ0uE/UIk+CQflAHDjf8+Lg6MldYATGpH3c/Ul7p3dWXppVGM6eElJSHmnQWPbSlRlN1lJcUBjqNRnwJZVQO3B5P/uq5rK1d90pakckFcaKp5UJHY92JR8YlwkUDVySEZfGfQdO7E7Z8s2HL9TSoXTPXRud9nA8IBqSwcZgWeqpPj6BYw7yTbXBN9q2v9lQEq5zBmWA8vWLCptCi4tzwW8RQMQlFQATPLSh6vCSh/plJBkMyQBHZfWYnkKRgEktEVpTJXERN2Xzo4ex2VC6K6qXYpF5b3ypVRT8EgcAERSJXRbwCBOTFzXblM5RxGBaRt+ZPYA+LO0mgxz5K1Ig+UgAzKIuGnz39z6S+olDeaibaXRsU1RUFvgx+GwTWgPCaDgMw2XXpr9gwq50XV0bkxJiYeEiNF5cwE5XsiOEkAUkXkUW51SSOVchjl8WKef604XFSRbzCGCYeCoESStv/p8QU1VPIM3knNDynctnBRfsEYhgSlNCIGgQv2UCkvGIHZgteMh1nBW9W4F16RAM6yDVV7amZTaYQcr59cuuhhWRTWBvAMLxQGeyFSHOLnh0MvUskz5RF+fbRYDEy0mZgqQYUHOLhr//b6rGoqeaLqQG0pw3PrBbyA+4EQUkRmhvgqNUfICUipKK4OKUqIJVPKB0jpEhjmWWp64jdbKmVZZNYogcJm493gsifOqhDyeh9GYR/FM7sW+DA5CKR0MSK3tvKZkpwB5gRE4tjFEr7RL0iWBGV51vHFCyupNGWWPqLgnoer9mtyEGSJAzwLllDTGzyznDjRN/CwOFkoFb4bm0eVIXICgpvdGoEvrF7fC89zfLkkeV5HbOhWiTwTpKYvCAJLGshRdXtKMKAWlyxq+MPQLk1h66g5RE5ABJYNFrqY3wvJklJRUKg5ZWLFXIA86yek2uDOPkBNb3CM5Pf7DL2QyIrUGiLH+xC5Bmmm/ARnHUhC6PnzxWDK0RH5HuIjZGy27erU9AZ0dTIWXyG+NpBBrSFySxZw220IqeUPFoS6jVAPNadM7yDsgNB1qOkLuAziMYIb1PQGA75wIaKGPyAb+9oF16g5RE5ALIQ+tSyLWoWDEAK6aXW3JlK9VJoyx1oyvVkNdvo5KXXDAVkdnaKmNwx0xjH98w3JNmTCm+Bc9hKVhsgJSI9pvp9Vdd++jmq6AXB2/HHrhcs5aTkVDv0DFzoHvKdq/mQsKX/4t7KJLDpOJW+IbAvMGoMkxfwAWZB8DT7W1diTE+WcgKz6pK1bs6z3daPwmJDsSKt6ZsCyjlLJMz0DsDGZ8SdlDROBjOb8YeWOjptU8kTXusuaazu7oJrfEnQvdkpVcUn6PTVHyAkIIW7br/Unklni0EJIZ1WgGsauZR+fvUglz6zY0dGfVp09ybRNlfwgi3k8YSbvJJ29VMoLt9v6rZVQL7hOYUubndHJGclBtzn1byqNMCogi09/2nFb01/oj+f/5TyjauBOKtPcZ1r7qZQ3f2lRfxZPWi2anp8TSDAGExZMa2jr8u03L1M5L7q3Xc+iAeuHRl/ScvPcjSLDBnZS/cjtNHd2v3171Ewbs9N5q7Pn4otVMx3btBsCsoRbk1FxG5dMVgMDqfTpXl1/tuFMa5zKefPROdX59qLQBwLnNog8Wy1OcjB1N+QEsW/QsFNZuO35Xb1v98QLX4/Sx+O3wqujrQ6013ABUWI8+AaqBjAH01+ghL22+5X2PirnMG7r+esbnae/V1neauvGSoHjigTcVU7UGFm2DeK4ttxKpQ+mLPvl+o/PjnkAkw9HTqSMmVHhyAMx9iFcSh/BHTfLceO/C8mKjApBf9zszGhoY92m9sN+BGOY9AeD7eGniv8OTaOB4dgyTsQd9wS+IQu4lciYdkI7CLrNH3Rvbb9FL41i0tbzVP2iWJkobpN5fmM4IJfJskTP1Bk8A9HQmbpmGDBrWqdVCN/Yd7PjxKGOXn+bmbto3feVVcVB9qehIL8EJy8nChwgr0O2xxBnhGU5eP2CfYbl/m4gBRsbtneMORP9oGpjpcCsiKzHHfdOPiQ/wMniyFEu2dbiTQCAeN/vavC466BGYLttXc9fmXBXMGlAhiHHur+sq6uPiUI9z7CVHMPwBnLSuuN8FuC48/Oaz1ylt94XfrW5ouyprwWfYRkwNyCyYYjwkBHows1fa+tV/fzGxlv39b9gqvfPmQ+i/HK8KlcBjhHwfl8HEHyOd1JnuzZd66S3TTPNNNP8/wDAfwDG7G0m9LKBpwAAAABJRU5ErkJggg==) 10px 10px no-repeat;background-size:40px;background-color:#fdfdfd}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#fdfdfd}.markdown-body a{text-decoration:none;font-weight:700;color:#ef7060;border-bottom:1px solid #ef7060}.markdown-body a:active,.markdown-body a:hover{color:#ef2d26}.markdown-body table tr td,.markdown-body table tr th{border:1px solid #ccc;padding:5px 10px}.markdown-body table{display:block!important;width:auto;max-width:100%;overflow:auto;border-collapse:collapse}.markdown-body thead{background:#f0f0f0;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#f8f8f8}.markdown-body blockquote{margin-inline-start:0;margin-inline-end:0;border-left:3px solid #ef7060;background:#fff9f9;padding:1px 20px;margin-top:20px}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="atom-one-light">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#383a42;background:#fafafa}.hljs-comment,.hljs-quote{color:#a0a1a7;font-style:italic}.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#e45649}.hljs-literal{color:#0184bb}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#50a14f}.hljs-built_in,.hljs-class .hljs-title{color:#c18401}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#4078f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.hljs-link{text-decoration:underline}</style><h2 data-id="heading-0">ä»‹ç» uv</h2>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.astral.sh%2Fuv" target="_blank" title="https://docs.astral.sh/uv" ref="nofollow noopener noreferrer">uv</a> æ˜¯ä¸€ä¸ªç”¨ Rust ç¼–å†™çš„ <strong>æå¿«çš„ Python åŒ…ç®¡ç†å™¨å’Œé¡¹ç›®ç®¡ç†å™¨ã€‚</strong></p>
<p>å®ƒæ•´åˆäº† Python å¼€å‘è€…å¸¸ç”¨çš„å¤šç§å·¥å…·åˆ°ä¸€ä¸ª CLI ä¸­ï¼Œéå¸¸åƒ Node.js ç”Ÿæ€é‡Œçš„ npm/pnpmã€‚</p>
<ul>
<li>Rust å†™çš„ï¼Œ<strong>é€Ÿåº¦æ¯” pip å¿« 10ï½80 å€</strong></li>
<li>ä¸€ä¸ªå·¥å…·æ›¿ä»£å¤šä¸ªå·¥å…·ï¼ˆpipã€virtualenvã€pip-toolsã€pyenvã€poetryâ€¦ï¼‰</li>
<li>å’Œ Ruff åŒä¸€ä¸ªå›¢é˜Ÿï¼Œä¸“ä¸šåº¦é«˜</li>
<li>é…ç½®ç»Ÿä¸€åœ¨ <code>pyproject.toml</code></li>
<li>å…¼å®¹ pipï¼Œä¸éœ€è¦è¿ç§»æˆæœ¬</li>
</ul>
<p><strong>uv å‘½ä»¤é€ŸæŸ¥è¡¨ï¼š</strong></p>





































<table><thead><tr><th>åŠŸèƒ½</th><th>å‘½ä»¤</th></tr></thead><tbody><tr><td>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</td><td><code>uv venv</code></td></tr><tr><td>ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒè¿è¡Œè„šæœ¬</td><td><code>uv run main.py</code></td></tr><tr><td>å®‰è£…ä¾èµ–</td><td><code>uv pip install fastapi</code></td></tr><tr><td>å®‰è£…åˆ°é¡¹ç›®ï¼ˆå†™å…¥ pyprojectï¼‰</td><td><code>uv add fastapi</code></td></tr><tr><td>å®‰è£… Python ç‰ˆæœ¬</td><td><code>uv python install 3.12</code></td></tr><tr><td>è¿è¡Œå·¥å…·</td><td><code>uv run uvicorn app:app</code></td></tr><tr><td>è§£æä¾èµ–é”å®š</td><td><code>uv pip compile</code></td></tr></tbody></table>
<h2 data-id="heading-1">å®‰è£… uv</h2>
<p>æˆ‘ä»¬éœ€è¦ä¾æ® <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.astral.sh%2Fuv" target="_blank" title="https://docs.astral.sh/uv" ref="nofollow noopener noreferrer">uv å®˜ç½‘</a>ç»™æˆ‘ä»¬æä¾›çš„å®‰è£…æ–¹æ³•å°† uv å®‰è£…åˆ°è®¡ç®—æœºä¸­ã€‚</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7e67e9d3fc2d47e5ac00bc781b20644d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5p2-6byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768557817&amp;x-signature=NmESSR4T2Uorm2GLLfsDQx2tvY0%3D" alt="01-001.png" width="100%" loading="lazy"/>
<p><code>powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"</code></p>
<p>ä»¥ Windows ä¸ºä¾‹ï¼Œå°†ä¸Šè¿°å‘½ä»¤è¾“å…¥åˆ°ç»ˆç«¯åç­‰å¾…å‡ ç§’å°±ä¼šå®‰è£…å®Œæˆã€‚</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/bcc768d845334b3b97baca0712c47b4d~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5p2-6byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768557817&amp;x-signature=jVNA%2BfiFMZzXUSM1Rp43WmyM8aA%3D" alt="01-002.png" width="100%" loading="lazy"/>
<h4 data-id="heading-2">åˆå§‹åŒ–ç¯å¢ƒ</h4>
<p>å­¦ä¹  <code>langchain</code> æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ª <code>Python</code> é¡¹ç›®ç¯å¢ƒã€‚</p>
<p>é¦–å…ˆï¼Œåˆ›å»º <code>langchain</code> é¡¹ç›®ç›®å½• <code>learn-langchain</code>ï¼Œåœ¨ç›®å½•ä¸‹çš„ç»ˆç«¯å‘½ä»¤è¡Œè¾“å…¥ <code>uv init</code>ã€‚</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/cfb9d4344c6b4d109afe0a8e2ceed1d0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5p2-6byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768557817&amp;x-signature=lh8JR1ZVlo0Eaj%2Btwag9wt48N3s%3D" alt="01-1.png" width="100%" loading="lazy"/>
<p>æ­¤æ—¶ï¼Œ<code>uv</code> å°±ä¼šå¸®æˆ‘ä»¬åˆå§‹åŒ–å¼€å‘ç¯å¢ƒï¼Œä¼šç”Ÿæˆå¦‚ä¸‹åˆå§‹æ–‡ä»¶ï¼š</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b2dfc5164e144ee58d4af506f02432ca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5p2-6byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768557817&amp;x-signature=JYU%2FeW8qP6t7BbRygrU3MBctW44%3D" alt="01-2.png" width="100%" loading="lazy"/>
<p>å…¶ä¸­ï¼Œ<code>pyproject.toml</code> æ˜¯ Python é¡¹ç›®çš„â€œ<strong>æ€»é…ç½®ä¸­å¿ƒ + ä¾èµ–å£°æ˜å…¥å£</strong>â€ã€‚</p>
<pre><code class="hljs language-toml" lang="toml"><span class="hljs-section">[project]</span>
<span class="hljs-attr">name</span> = <span class="hljs-string">"learn-langchain"</span>
<span class="hljs-attr">version</span> = <span class="hljs-string">"0.1.0"</span>
<span class="hljs-attr">description</span> = <span class="hljs-string">"Add your description here"</span>
<span class="hljs-attr">readme</span> = <span class="hljs-string">"README.md"</span>
<span class="hljs-attr">requires-python</span> = <span class="hljs-string">"&gt;=3.13"</span>
<span class="hljs-attr">dependencies</span> = []
</code></pre>
<p>å¯ä»¥æŠŠå®ƒç±»æ¯”æˆå‰ç«¯é¡¹ç›®ä¸­çš„ <code>package.json</code> æ–‡ä»¶ï¼Œä¸‹é¢æˆ‘ä»¬è¯¦ç»†è§£é‡Šè¿™ä¸ªæ–‡ä»¶ä¸­å„ä¸ªå­—æ®µçš„å«ä¹‰ã€‚</p>
<ul>
<li><strong>[project]</strong> ï¼šè¿™æ˜¯ä¸€ä¸ª Python é¡¹ç›®çš„å…ƒæ•°æ®å£°æ˜ï¼Œuv ä¼šä»è¿™é‡Œè¯»å–é¡¹ç›®ä¿¡æ¯ã€‚</li>
<li><strong>name</strong>ï¼šé¡¹ç›®çš„å®˜æ–¹åç§°ã€‚</li>
<li><strong>version</strong>ï¼šé¡¹ç›®ç‰ˆæœ¬å·ã€‚</li>
<li><strong>description</strong>ï¼šé¡¹ç›®çš„ä¸€å¥è¯æè¿°ã€‚</li>
<li><strong>readme</strong>ï¼šæŒ‡å®šé¡¹ç›®çš„ README æ–‡ä»¶ã€‚</li>
<li><strong>requires-python</strong>ï¼šå£°æ˜é¡¹ç›®èƒ½è¿è¡Œçš„ Python ç‰ˆæœ¬èŒƒå›´ã€‚</li>
<li><strong>dependencies</strong>ï¼šé¡¹ç›®çš„è¿è¡Œæ—¶ä¾èµ–ï¼Œåç»­å®‰è£…çš„ä¾èµ–éƒ½ä¼šå­˜åˆ°è¿™é‡Œã€‚</li>
</ul>
<h2 data-id="heading-3">å®‰è£…é¡¹ç›®ä¾èµ–</h2>
<p>é¦–å…ˆï¼Œå®‰è£… langchain æ ¸å¿ƒä¾èµ–ï¼Œåœ¨é¡¹ç›®è·Ÿç›®å½•ç»ˆç«¯è¾“å…¥ï¼š</p>
<p><code>uv add langchain langchain-core langchain-classic langchain-community</code></p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/b8037e3bbab2465e8aa43b9ebe6c7452~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5p2-6byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768557817&amp;x-signature=MXsDQ9g0ZYbolQJv1OKAI2eb%2Bh4%3D" alt="01-3.png" width="100%" loading="lazy"/>
<p>æ­¤æ—¶ï¼Œæ–°çš„ä¾èµ–ä¼šå£°æ˜åœ¨ <code>pyproject.toml</code> æ–‡ä»¶çš„ <code>dependencies</code> ä¸­ã€‚</p>
<p>åŒæ—¶ï¼Œåœ¨é¡¹ç›®ä¸­ä¼šç”Ÿæˆ <code>uv.lovk</code> æ–‡ä»¶å’Œ <code>.venv</code> æ–‡ä»¶ï¼š</p>
<ul>
<li><strong>uv.lovk</strong>ï¼š uv è‡ªåŠ¨ç”Ÿæˆçš„<strong>ä¾èµ–é”æ–‡ä»¶</strong>ï¼Œ è®°å½•æ¯ä¸ªä¾èµ–çš„<strong>æœ€ç»ˆç‰ˆæœ¬ã€‚</strong></li>
<li><strong>.venv</strong>ï¼š uv ä¸ºå½“å‰é¡¹ç›®åˆ›å»ºçš„ Python è™šæ‹Ÿç¯å¢ƒç›®å½•ï¼Œé¿å…å…¨å±€ Python ç¯å¢ƒæ±¡æŸ“ã€‚</li>
</ul>
<h2 data-id="heading-4">æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</h2>
<p>å¦‚æœæ˜¯ Windows ç³»ç»Ÿï¼Œåœ¨é¡¹ç›®ç»ˆç«¯å‘½ä»¤è¡Œè¾“å…¥ï¼š</p>
<p><code>.venv\Scripts\activate</code></p>
<p>å¦‚æœæ˜¯ macOS / Linux ç³»ç»Ÿï¼Œåœ¨é¡¹ç›®ç»ˆç«¯å‘½ä»¤è¡Œè¾“å…¥ï¼š</p>
<p><code>source .venv/bin/activate</code></p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5203a55b9934d238fe64c700f5cfc1f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5p2-6byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768557817&amp;x-signature=EJc6mUuM%2FAxNLoIkPFY%2FFNrPGhc%3D" alt="01-4.png" width="100%" loading="lazy"/>
<p>è™šæ‹Ÿç¯å¢ƒæ¿€æ´»åï¼Œä¼šåœ¨ç»ˆç«¯å‘½ä»¤è¡Œå‰ç«¯æ˜¾ç¤º <code>(learn-langchain)</code> è¡¨ç¤ºå½“å‰æ¿€æ´»çš„ Python è™šæ‹Ÿç¯å¢ƒåç§°ã€‚</p>
<h2 data-id="heading-5">åˆ›å»ºé¡¹ç›®ç¤ºä¾‹</h2>
<h3 data-id="heading-6">å®‰è£…ä¾èµ–</h3>
<p>é¦–å…ˆï¼Œå®‰è£…å¿…è¦çš„ä¾èµ–ï¼Œåœ¨é¡¹ç›®è·Ÿç›®å½•ç»ˆç«¯è¾“å…¥ï¼š</p>
<p><code>uv add python-dotenv langchain-openai langchain-deepseek</code></p>
<ul>
<li><code>python-dotenv</code>æ˜¯ä¸€ä¸ªç”¨äºè¯»å– <code>.env</code> æ–‡ä»¶å¹¶å°†ç¯å¢ƒå˜é‡åŠ è½½åˆ° Python è¿è¡Œæ—¶çš„å·¥å…·ã€‚</li>
<li><code>langchain-openai</code> æä¾›å¯¹ <strong>OpenAI å®˜æ–¹æ¨¡å‹</strong> çš„æ¥å£å°è£…ã€‚</li>
<li><code>langchain-deepseek</code> æä¾›å¯¹ <strong>DeepSeek å¹³å°ï¼ˆOpenAI-compatibleï¼‰çš„æ¥å£</strong> å°è£…ã€‚</li>
</ul>
<h3 data-id="heading-7">é…ç½®ç¯å¢ƒå˜é‡</h3>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>.env</code> æ–‡ä»¶ï¼Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-attr">OPENAI_API_KEY</span>=sk-c97afa925b1745f79225c904dff53cba
<span class="hljs-attr">OPENAI_API_BASE</span>=https://api.deepseek.com/v1
</code></pre>
<p>åœ¨å­¦ä¹  <code>LangChain</code> çš„å‰æœŸé˜¶æ®µï¼Œæˆ‘ä»¬æš‚æ—¶ä½¿ç”¨ <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.deepseek.com" target="_blank" title="https://platform.deepseek.com" ref="nofollow noopener noreferrer">DeepSeek</a> ä½œä¸ºæˆ‘ä»¬çš„å¤§è¯­è¨€æ¨¡å‹ã€‚</p>
<p>å› ä¸º DeepSeek <strong>å…¼å®¹ OpenAI API åè®®ï¼Œ</strong> æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶ <code>API key</code> èµ‹å€¼ç»™ <code>OPENAI_API_KEY</code>ã€‚</p>
<p>è®¿é—® <a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.deepseek.com%2Fapi_keys" target="_blank" title="https://platform.deepseek.com/api_keys" ref="nofollow noopener noreferrer">DeepSeek å¼€æ”¾å¹³å°</a>ï¼Œåˆ›å»º <code>API key</code> ä¿å­˜èµ·æ¥ï¼Œç„¶åèµ‹å€¼ç»™ <code>.env</code> ä¸­çš„ <code>OPENAI_API_KEY</code>ã€‚</p>
<p>ä½¿ç”¨å®˜ç½‘æä¾›çš„å…¼å®¹ OpenAI çš„<code>base_url</code> èµ‹å€¼ç»™ <code>OPENAI_API_BASE</code>ã€‚</p>
<h3 data-id="heading-8">åˆ›å»ºç¤ºä¾‹</h3>
<p>åˆ›å»ºç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>01-hello-world</code> æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶æ–‡ä»¶å¤¹å†…åˆ›å»º <code>01-chat.py</code> æ–‡ä»¶ã€‚</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv

<span class="hljs-comment"># åŠ è½½ç¯å¢ƒå˜é‡</span>
load_dotenv()

<span class="hljs-comment"># åˆå§‹åŒ–èŠå¤©æ¨¡å‹</span>
llm = ChatOpenAI(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    temperature=<span class="hljs-number">0</span>,
)

<span class="hljs-comment"># è°ƒç”¨æ¨¡å‹</span>
response = llm.invoke(<span class="hljs-string">"ä½ æ˜¯è°"</span>)

<span class="hljs-built_in">print</span>(response.content)
</code></pre>
<p><strong>ä¸Šè¿°ä»£ç çš„å«ä¹‰æ˜¯ï¼š</strong></p>
<ol>
<li><strong>å¯¼å…¥ä¾èµ–</strong></li>
</ol>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain_openai <span class="hljs-keyword">import</span> ChatOpenAI
<span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv
</code></pre>
<ul>
<li><code>from langchain_openai import ChatOpenAI</code>
<ul>
<li>ä» <strong>LangChain çš„ OpenAI é€‚é…å™¨åŒ…</strong>é‡Œå¯¼å…¥ <strong>ChatOpenAI</strong> ç±»</li>
<li>è¿™ä¸ªç±»å°è£…äº†å¯¹ OpenAI æˆ–å…¼å®¹ APIï¼ˆDeepSeekï¼‰çš„å¯¹è¯æ¨¡å‹è°ƒç”¨</li>
<li>æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª <strong>LLMï¼ˆLarge Language Modelï¼‰å®¢æˆ·ç«¯</strong></li>
</ul>
</li>
<li><code>from dotenv import load_dotenv</code>
<ul>
<li>ä» <code>python-dotenv </code>å¯¼å…¥ <code>load_dotenv</code></li>
<li>ç”¨æ¥åŠ è½½ <code>.env</code> æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡åˆ° Python çš„ <code>os.environ</code></li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>åŠ è½½ç¯å¢ƒå˜é‡</strong></li>
</ol>
<ul>
<li><code>load_dotenv()</code>
<ul>
<li>è¯»å–é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ <code>.env</code> æ–‡ä»¶</li>
<li>å°†å…¶ä¸­çš„å†…å®¹ï¼ˆä¾‹å¦‚ <code>OPENAI_API_KEY</code>ã€<code>OPENAI_API_BASE</code>ï¼‰å¯¼å…¥ç¯å¢ƒå˜é‡</li>
<li>è¿™æ · <code>ChatOpenAI</code> å°±å¯ä»¥è‡ªåŠ¨è¯»å– Key å’Œ API Baseï¼Œæ— éœ€åœ¨ä»£ç ä¸­ç¡¬ç¼–ç </li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>åˆå§‹åŒ– LLM</strong></li>
</ol>
<pre><code class="hljs language-python" lang="python">llm = ChatOpenAI(
    model=<span class="hljs-string">"deepseek-chat"</span>,
    temperature=<span class="hljs-number">0</span>,
)
</code></pre>
<ul>
<li>åˆ›å»ºä¸€ä¸ª <strong>ChatOpenAI å¯¹è±¡</strong>ï¼Œç”¨äºå‘é€æ¶ˆæ¯ç»™ LLM</li>
<li><code>model="deepseek-chat" </code>ï¼š
<ul>
<li>å› ä¸º DeepSeek å…¼å®¹ OpenAI APIï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥æŒ‡å®š DeepSeek æä¾›çš„æ¨¡å‹</li>
</ul>
</li>
<li><code>temperature=0</code>ï¼š
<ul>
<li>æ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„éšæœºæ€§ï¼Œ 0 â†’ <strong>æœ€ç¡®å®šã€æœ€ç¨³å¦¥ï¼Œ è¶Šå¤§ â†’ è¾“å‡ºè¶Šå¤šæ ·åŒ–</strong></li>
</ul>
</li>
</ul>
<ol start="4">
<li><strong>è°ƒç”¨ LLM</strong></li>
</ol>
<ul>
<li><code>response = llm.invoke("ä½ æ˜¯è°")</code>
<ul>
<li><code>invoke()</code> æ˜¯ ChatOpenAI çš„æ ¸å¿ƒæ–¹æ³•</li>
<li>è¾“å…¥å‚æ•° <code>"ä½ æ˜¯è°"</code> æ˜¯ <strong>prompt</strong>ï¼Œå‘Šè¯‰ LLM ä½ å¸Œæœ›å®ƒåšä»€ä¹ˆ</li>
<li>è¿”å›å€¼ <code>response</code> æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé€šå¸¸åŒ…å«ï¼š<code>response.content</code> â†’ LLM çš„æ–‡æœ¬è¾“å‡º</li>
</ul>
</li>
</ul>
<h2 data-id="heading-9">ç»“è¯­</h2>
<p><strong>æœ€ç»ˆ</strong>ï¼Œåœ¨ç»ˆç«¯å‘½ä»¤è¡Œè¾“å…¥ï¼š<code>python .\01-hello-world\01-chat.py</code> ç­‰å¾…å‡ ç§’å°±ä¼šåœ¨æ§åˆ¶å°æ‰“å°å†…å®¹ã€‚</p>
<img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aef3c786bb9b49ecaf3f8c9edb074432~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6L-b5Ye755qE5p2-6byg:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768557817&amp;x-signature=UQbmHSOHRpzCyMw16vyF0AI7n90%3D" alt="01-5.png" width="100%" loading="lazy"/>
<p>è¿™è¯´æ˜ï¼Œæˆ‘ä»¬ç¬¬ä¸€ä¸ª LangChain ç¤ºä¾‹è¿è¡ŒæˆåŠŸï¼Œåç»­ï¼Œæˆ‘ä»¬å°†å¼€å§‹ç³»ç»Ÿå­¦ä¹  LangChain æä¾›çš„å¼ºå¤§çš„èƒ½åŠ›ã€‚</p>
<blockquote>
<p>æ­¤æ–‡ç« å·²åŒæ­¥è‡³ <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fvaesonshu%2Flearn-langchan%2Fissues%2F1" target="_blank" title="https://github.com/vaesonshu/learn-langchan/issues/1" ref="nofollow noopener noreferrer">Github</a></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[reactè·¯ç”±é…ç½®ç›¸å…³]]></title>    <link>https://juejin.cn/post/7592996072706097202</link>    <guid>https://juejin.cn/post/7592996072706097202</guid>    <pubDate>2026-01-09T07:30:36.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592996072706097202" data-draft-id="7592996072705589298" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="reactè·¯ç”±é…ç½®ç›¸å…³"/> <meta itemprop="keywords" content="å‰ç«¯,React.js,Ant Design"/> <meta itemprop="datePublished" content="2026-01-09T07:30:36.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŠ æ²¹ä¹"/> <meta itemprop="url" content="https://juejin.cn/user/84036866547575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            reactè·¯ç”±é…ç½®ç›¸å…³
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/84036866547575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŠ æ²¹ä¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T07:30:36.000Z" title="Fri Jan 09 2026 07:30:36 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">ä¸€ã€è·¯ç”±é…ç½®æ¥å£è®¾è®¡</h2>
<ul>
<li>é€šè¿‡ç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œç¡®ä¿è·¯ç”±é…ç½®çš„ç±»å‹å®‰å…¨ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚</li>
</ul>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">RouteConfig</span> {
  <span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>;                     <span class="hljs-comment">// è·¯ç”±è·¯å¾„</span>
  element?: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span>;        <span class="hljs-comment">// æ¸²æŸ“ç»„ä»¶</span>
  children?: <span class="hljs-title class_">RouteConfig</span>[];         <span class="hljs-comment">// å­è·¯ç”±</span>
  redirect?: <span class="hljs-built_in">string</span>;                <span class="hljs-comment">// é‡å®šå‘è·¯å¾„</span>
  meta?: {                          <span class="hljs-comment">// è·¯ç”±å…ƒä¿¡æ¯</span>
    <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;                  <span class="hljs-comment">// é¡µé¢æ ‡é¢˜</span>
    requiresAuth?: <span class="hljs-built_in">boolean</span>;         <span class="hljs-comment">// æ˜¯å¦éœ€è¦ç™»å½•</span>
    roles?: <span class="hljs-built_in">string</span>[];               <span class="hljs-comment">// å…è®¸è®¿é—®çš„è§’è‰²</span>
  };
}
</code></pre>
<h2 data-id="heading-1">äºŒã€è·¯ç”±åˆ†ç¦»ç­–ç•¥</h2>
<ul>
<li>å°†è·¯ç”±åˆ†ä¸ºå…¬å…±è·¯ç”±å’Œç§æœ‰è·¯ç”±</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-string">//</span> <span class="hljs-string">å…¬å…±è·¯ç”±ï¼ˆæ— éœ€ç™»å½•ï¼‰</span>
<span class="hljs-attr">const publicRoutes:</span> <span class="hljs-string">RouteConfig[]</span> <span class="hljs-string">=</span> [
  {
    <span class="hljs-attr">path:</span> <span class="hljs-string">'/login'</span>,
    <span class="hljs-attr">element:</span> <span class="hljs-string">&lt;Login</span> <span class="hljs-string">/&gt;</span>,
    <span class="hljs-attr">meta:</span> { <span class="hljs-attr">title:</span> <span class="hljs-string">'ç™»å½•'</span>, <span class="hljs-attr">requiresAuth:</span> <span class="hljs-literal">false</span> }
  }
]<span class="hljs-string">;</span>

<span class="hljs-string">//</span> <span class="hljs-string">ç§æœ‰è·¯ç”±ï¼ˆéœ€è¦ç™»å½•ï¼‰</span>
<span class="hljs-attr">const privateRoutes:</span> <span class="hljs-string">RouteConfig[]</span> <span class="hljs-string">=</span> [
  {
    <span class="hljs-attr">path:</span> <span class="hljs-string">'/dashboard'</span>,
    <span class="hljs-attr">element:</span> <span class="hljs-string">&lt;Dashboard</span> <span class="hljs-string">/&gt;</span>,
    <span class="hljs-attr">meta:</span> { <span class="hljs-attr">title:</span> <span class="hljs-string">'ä»ªè¡¨æ¿'</span>, <span class="hljs-attr">requiresAuth:</span> <span class="hljs-literal">true</span> }
  }
]<span class="hljs-string">;</span>
</code></pre>
<h2 data-id="heading-2">ä¸‰ã€æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²</h2>
<ul>
<li><code>React.lazy</code>Â æ˜¯ React ä¸­å®ç°<strong>ç»„ä»¶çº§ä»£ç åˆ†å‰²</strong>çš„æ ¸å¿ƒ APIï¼Œå®ƒå…è®¸ä½ å°†ç»„ä»¶ä»£ç å»¶è¿ŸåŠ è½½ï¼Œä»è€Œä¼˜åŒ–åº”ç”¨æ€§èƒ½ã€‚</li>
<li><code>React.lazy</code><strong>å¿…é¡»åœ¨ Suspense å†…ä½¿ç”¨</strong></li>
<li><strong>Suspense</strong>Â æ˜¯ React ä¸­ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„ç»„ä»¶ï¼Œå®ƒè®©ç»„ä»¶å¯ä»¥"ç­‰å¾…"æŸäº›æ“ä½œå®Œæˆï¼Œåœ¨ç­‰å¾…æœŸé—´æ˜¾ç¤ºå›é€€ UIã€‚</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// æ‡’åŠ è½½ç»„ä»¶å®šä¹‰</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyAbout</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../pages/About'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyUserList</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../pages/UserList'</span>));

<span class="hljs-comment">// å°è£…SuspenseåŒ…è£…å™¨ç»„ä»¶</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">LazyComponent</span> = (<span class="hljs-params">{ component: Component }</span>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LoadingFallback</span> /&gt;</span>}&gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">Component</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
);
</code></pre>
<ul>
<li>é¡µé¢åŠ è½½æ—¶çš„ç­‰å¾…çŠ¶æ€</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">//æ­¤å¤„ä»…ç¤ºä¾‹ï¼Œå®é™…å¯æ”¾ç½®å…¨å±€çš„æœªåŠ è½½å®Œæˆæ—¶çš„ç­‰å¾…æ ·å¼</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">LoadingFallback</span> = (<span class="hljs-params"/>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>é¡µé¢åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
);
</code></pre>
<h2 data-id="heading-3">å››ã€è·¯ç”±å®ˆå«ä¸æƒé™æ§åˆ¶</h2>
<ul>
<li>è®¤è¯å®ˆå«ç»„ä»¶ï¼šåŸºäºtokençš„<code>è®¤è¯æ£€æŸ¥</code>ã€<code>è‡ªåŠ¨é‡å®šå‘</code>ã€replace<code>é˜²æ­¢å›é€€åˆ°å—ä¿æŠ¤çš„é¡µé¢</code></li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">AuthGuard</span> = (<span class="hljs-params">{ children }</span>) =&gt; {
  <span class="hljs-keyword">const</span> isAuthenticated = !!<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>);
  
  <span class="hljs-comment">// æœªè®¤è¯é‡å®šå‘åˆ°ç™»å½•é¡µ</span>
  <span class="hljs-keyword">if</span> (!isAuthenticated) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/login"</span> <span class="hljs-attr">replace</span> /&gt;</span></span>;
  }
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;&gt;</span>{children}<span class="hljs-tag">&lt;/&gt;</span></span>;
};
</code></pre>
<ul>
<li>å…ƒæ•°æ®é©±åŠ¨çš„æƒé™æ§åˆ¶</li>
</ul>
<pre><code class="hljs language-yaml" lang="yaml">{
  <span class="hljs-attr">path:</span> <span class="hljs-string">'/user-center'</span>,
  <span class="hljs-attr">element:</span> <span class="hljs-string">&lt;UserCenter</span> <span class="hljs-string">/&gt;</span>,
  <span class="hljs-attr">meta:</span> {
    <span class="hljs-attr">title:</span> <span class="hljs-string">'ç”¨æˆ·ä¸­å¿ƒ'</span>,
    <span class="hljs-attr">requiresAuth:</span> <span class="hljs-literal">true</span>
    <span class="hljs-string">//æƒé™æ§åˆ¶</span>
    <span class="hljs-attr">roles:</span> [<span class="hljs-string">'admin'</span>]
  }
}
</code></pre>
<h2 data-id="heading-4">äº”ã€é€’å½’æ¸²æŸ“ä¸åµŒå¥—è·¯ç”±</h2>
<ul>
<li>æ”¯æŒæ— é™å±‚çº§åµŒå¥—</li>
<li>ç»Ÿä¸€çš„è®¤è¯å¤„ç†é€»è¾‘</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">renderRoutes</span> = (<span class="hljs-params">routes: RouteConfig[]</span>) =&gt; {
  <span class="hljs-keyword">return</span> routes.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { path, element, children, redirect, meta } = route;

    <span class="hljs-comment">// å¤„ç†é‡å®šå‘</span>
    <span class="hljs-keyword">if</span> (redirect) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{path}</span>
          <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span>
          <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">{redirect}</span> <span class="hljs-attr">replace</span> /&gt;</span>}
        /&gt;</span>
      );
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span>
        <span class="hljs-attr">key</span>=<span class="hljs-string">{path}</span>
        <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span>
        <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
          // <span class="hljs-attr">æ ¹æ®å…ƒæ•°æ®å†³å®šæ˜¯å¦åŒ…è£¹AuthGuard</span>
          <span class="hljs-attr">meta</span>?<span class="hljs-attr">.requiresAuth</span> ? (
            &lt;<span class="hljs-attr">AuthGuard</span>&gt;</span>{element}<span class="hljs-tag">&lt;/<span class="hljs-name">AuthGuard</span>&gt;</span>
          ) : (
            element
          )
        }
      &gt;
        {/* é€’å½’æ¸²æŸ“å­è·¯ç”± */}
        {children &amp;&amp; renderRoutes(children)}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></span>
    );
  });
};

</code></pre>
<ul>
<li>åµŒå¥—è·¯ç”±ç¤ºä¾‹</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript">{
  <span class="hljs-attr">path</span>: <span class="hljs-string">'/father'</span>,
  <span class="hljs-attr">children</span>: [
    {
      <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>,  <span class="hljs-comment">// è®¿é—® /father</span>
      <span class="hljs-attr">redirect</span>: <span class="hljs-string">'son'</span>  <span class="hljs-comment">// é‡å®šå‘åˆ° /father/son</span>
    },
    {
      <span class="hljs-attr">path</span>: <span class="hljs-string">'son'</span>,  <span class="hljs-comment">// è®¿é—® /father/son</span>
      <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Son</span> /&gt;</span></span>
    }
  ]
}
</code></pre>
<h2 data-id="heading-5">å…­ã€è¾…åŠ©å·¥å…·å‡½æ•°</h2>
<h3 data-id="heading-6">1. é¢åŒ…å±‘å¯¼èˆªç”Ÿæˆ</h3>
<ul>
<li>æ˜¾ç¤ºå½“å‰é¡µé¢</li>
<li>å¿«é€Ÿå¯¼èˆª</li>
</ul>
<pre><code class="hljs language-ini" lang="ini">export const <span class="hljs-attr">generateBreadcrumbs</span> = (pathname) =&gt; {
  const <span class="hljs-attr">segments</span> = pathname.split(<span class="hljs-string">'/'</span>).filter(Boolean)<span class="hljs-comment">;</span>
  const <span class="hljs-attr">breadcrumbs</span> = []<span class="hljs-comment">;</span>
  let <span class="hljs-attr">currentPath</span> = <span class="hljs-string">''</span><span class="hljs-comment">;</span>

  for (const segment of segments) {
    currentPath += `/${segment}`<span class="hljs-comment">;</span>
    const <span class="hljs-attr">route</span> = findRouteByPath(currentPath)<span class="hljs-comment">;</span>

    if (route?.meta?.title) {
      breadcrumbs.push({
        title: route.meta.title,
        path: route.path !== '/404' ? currentPath : undefined,
      })<span class="hljs-comment">;</span>
    }
  }

  return breadcrumbs<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-7">2. è·¯ç”±æŸ¥æ‰¾åŠŸèƒ½</h3>
<pre><code class="hljs language-ini" lang="ini">export const <span class="hljs-attr">findRouteByPath</span> = (pathname, routes = getAllRoutes()) =&gt; {
  for (const route of routes) {
    if (<span class="hljs-attr">route.path</span> === pathname) return route<span class="hljs-comment">;</span>
    
    if (route.children) {
      const <span class="hljs-attr">found</span> = findRouteByPath(pathname, route.children)<span class="hljs-comment">;</span>
      if (found) return found<span class="hljs-comment">;</span>
    }
  }
  
  return null<span class="hljs-comment">;</span>
}<span class="hljs-comment">;</span>
</code></pre>
<h2 data-id="heading-8">ä¸ƒã€æ±‡æ€»ä½¿ç”¨</h2>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-comment">// AppRouter.jsx</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">React</span>, { <span class="hljs-title class_">Suspense</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">Routes</span>, <span class="hljs-title class_">Route</span>, <span class="hljs-title class_">Navigate</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-router-dom'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../pages/App'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Father</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../pages/Father'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Son</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../pages/Son'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">Login</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../pages/Login'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">NotFound</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../pages/NotFound'</span>;

<span class="hljs-comment">/**
 * ============================================
 * å®šä¹‰è·¯ç”±é…ç½®æ¥å£
 * ============================================
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">RouteConfig</span> {
  <span class="hljs-attr">path</span>: <span class="hljs-built_in">string</span>;                     <span class="hljs-comment">// è·¯ç”±è·¯å¾„</span>
  element?: <span class="hljs-title class_">React</span>.<span class="hljs-property">ReactNode</span>;        <span class="hljs-comment">// æ¸²æŸ“ç»„ä»¶</span>
  children?: <span class="hljs-title class_">RouteConfig</span>[];         <span class="hljs-comment">// å­è·¯ç”±</span>
  redirect?: <span class="hljs-built_in">string</span>;                <span class="hljs-comment">// é‡å®šå‘è·¯å¾„</span>
  meta?: {                          <span class="hljs-comment">// è·¯ç”±å…ƒä¿¡æ¯</span>
    <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;                  <span class="hljs-comment">// é¡µé¢æ ‡é¢˜</span>
    requiresAuth?: <span class="hljs-built_in">boolean</span>;         <span class="hljs-comment">// æ˜¯å¦éœ€è¦ç™»å½•</span>
    roles?: <span class="hljs-built_in">string</span>[];               <span class="hljs-comment">// å…è®¸è®¿é—®çš„è§’è‰²</span>
  };
}

<span class="hljs-comment">/**
 * æ‡’åŠ è½½é…ç½®åŒºåŸŸ
 * ä½¿ç”¨ React.lazy å®ç°ä»£ç åˆ†å‰²
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyApp</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../pages/App'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazyFather</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../pages/Father'</span>));
<span class="hljs-keyword">const</span> <span class="hljs-title class_">LazySon</span> = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">lazy</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../pages/Son'</span>));

<span class="hljs-comment">/**
 * åŠ è½½ä¸­ç»„ä»¶
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">LoadingFallback</span> = (<span class="hljs-params"/>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>é¡µé¢åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
);

<span class="hljs-comment">/**
 * æ‡’åŠ è½½ç»„ä»¶åŒ…è£…å™¨
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">LazyComponent</span> = (<span class="hljs-params">{ component: Component }</span>) =&gt; (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LoadingFallback</span> /&gt;</span>}&gt;
    <span class="hljs-tag">&lt;<span class="hljs-name">Component</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
);

<span class="hljs-comment">/**
 * æƒé™å®ˆå«ç»„ä»¶
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">AuthGuard</span> = (<span class="hljs-params">{ children }</span>) =&gt; {
  <span class="hljs-keyword">const</span> isAuthenticated = !!<span class="hljs-variable language_">localStorage</span>.<span class="hljs-title function_">getItem</span>(<span class="hljs-string">'token'</span>);
  <span class="hljs-keyword">if</span> (!isAuthenticated) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/login"</span> <span class="hljs-attr">replace</span> /&gt;</span></span>;
  }
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;&gt;</span>{children}<span class="hljs-tag">&lt;/&gt;</span></span>;
};

<span class="hljs-comment">/**
 * å…¬å…±è·¯ç”±é…ç½®ï¼ˆä¸éœ€è¦ç™»å½•ï¼‰
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">publicRoutes</span>: <span class="hljs-title class_">RouteConfig</span>[] = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/login'</span>,
    <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Login</span> /&gt;</span></span>,
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">title</span>: <span class="hljs-string">'ç™»å½•'</span>,
      <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">false</span>,
    },
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/404'</span>,
    <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">NotFound</span> /&gt;</span></span>,
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">title</span>: <span class="hljs-string">'é¡µé¢ä¸å­˜åœ¨'</span>,
      <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">false</span>,
    },
  },
];

<span class="hljs-comment">/**
 * ç§æœ‰è·¯ç”±é…ç½®ï¼ˆéœ€è¦ç™»å½•ï¼‰
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-attr">privateRoutes</span>: <span class="hljs-title class_">RouteConfig</span>[] = [
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
    <span class="hljs-attr">element</span>: (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AuthGuard</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>ä¸»å¸ƒå±€<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> {/* è¿™é‡Œå¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ å¸ƒå±€ç»„ä»¶ */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">AuthGuard</span>&gt;</span></span>
    ),
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">title</span>: <span class="hljs-string">'é¦–é¡µ'</span>,
      <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span>,
    },
    <span class="hljs-attr">children</span>: [
      <span class="hljs-comment">// é»˜è®¤é‡å®šå‘åˆ° App é¡µé¢</span>
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>,
        <span class="hljs-attr">redirect</span>: <span class="hljs-string">'/app'</span>,
      },
      <span class="hljs-comment">// App é¡µé¢</span>
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'app'</span>,
        <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> <span class="hljs-attr">component</span>=<span class="hljs-string">{LazyApp}</span> /&gt;</span></span>,
        <span class="hljs-attr">meta</span>: {
          <span class="hljs-attr">title</span>: <span class="hljs-string">'App é¡µé¢'</span>,
          <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span>,
        },
      },
      <span class="hljs-comment">// Father é¡µé¢</span>
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'father'</span>,
        <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> <span class="hljs-attr">component</span>=<span class="hljs-string">{LazyFather}</span> /&gt;</span></span>,
        <span class="hljs-attr">meta</span>: {
          <span class="hljs-attr">title</span>: <span class="hljs-string">'Father é¡µé¢'</span>,
          <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span>,
        },
        <span class="hljs-attr">children</span>: [
          <span class="hljs-comment">// è®¿é—® /father æ—¶é‡å®šå‘åˆ° /father/son</span>
          {
            <span class="hljs-attr">path</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">redirect</span>: <span class="hljs-string">'son'</span>,
          },
          <span class="hljs-comment">// Son é¡µé¢ä½œä¸º Father çš„å­é¡µé¢</span>
          {
            <span class="hljs-attr">path</span>: <span class="hljs-string">'son'</span>,
            <span class="hljs-attr">element</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> <span class="hljs-attr">component</span>=<span class="hljs-string">{LazySon}</span> /&gt;</span></span>,
            <span class="hljs-attr">meta</span>: {
              <span class="hljs-attr">title</span>: <span class="hljs-string">'Son é¡µé¢'</span>,
              <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span>,
            },
          },
        ],
      },
    ],
  },
];

<span class="hljs-comment">/**
 * é€’å½’æ¸²æŸ“è·¯ç”±é…ç½®
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">renderRoutes</span> = (<span class="hljs-params">routes: RouteConfig[]</span>) =&gt; {
  <span class="hljs-keyword">return</span> routes.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { path, element, children, redirect, meta } = route;

    <span class="hljs-comment">// å¦‚æœæœ‰é‡å®šå‘ï¼Œç›´æ¥è¿”å›é‡å®šå‘è·¯ç”±</span>
    <span class="hljs-keyword">if</span> (redirect) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{path}</span>
          <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span>
          <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">{redirect}</span> <span class="hljs-attr">replace</span> /&gt;</span>}
        /&gt;</span>
      );
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Route</span>
        <span class="hljs-attr">key</span>=<span class="hljs-string">{path}</span>
        <span class="hljs-attr">path</span>=<span class="hljs-string">{path}</span>
        <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
          &lt;<span class="hljs-attr">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LoadingFallback</span> /&gt;</span>}&gt;
            {meta?.requiresAuth ? (
              <span class="hljs-tag">&lt;<span class="hljs-name">AuthGuard</span>&gt;</span>
                {element}
              <span class="hljs-tag">&lt;/<span class="hljs-name">AuthGuard</span>&gt;</span>
            ) : (
              element
            )}
          <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
        }
      &gt;
        {/* é€’å½’æ¸²æŸ“å­è·¯ç”± */}
        {children &amp;&amp; renderRoutes(children)}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Route</span>&gt;</span></span>
    );
  });
};

<span class="hljs-comment">/**
 * ä¸»è·¯ç”±ç»„ä»¶
 */</span>
<span class="hljs-keyword">const</span> <span class="hljs-title function_">AppRouter</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
      {/* æ¸²æŸ“æ‰€æœ‰è·¯ç”± */}
      {renderRoutes([...publicRoutes, ...privateRoutes])}
      {/* å¤„ç†æœªåŒ¹é…çš„è·¯ç”± */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"*"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Navigate</span> <span class="hljs-attr">to</span>=<span class="hljs-string">"/404"</span> <span class="hljs-attr">replace</span> /&gt;</span>} /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span></span>
  );
};

<span class="hljs-comment">/**
 * è·å–æ‰€æœ‰è·¯ç”±é…ç½®
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getAllRoutes</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">return</span> [...publicRoutes, ...privateRoutes];
};

<span class="hljs-comment">/**
 * æ ¹æ®è·¯å¾„æŸ¥æ‰¾è·¯ç”±ä¿¡æ¯
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">findRouteByPath</span> = (<span class="hljs-params">
  pathname: <span class="hljs-built_in">string</span>,
  routes = getAllRoutes()
</span>) =&gt; {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> route <span class="hljs-keyword">of</span> routes) {
    <span class="hljs-keyword">if</span> (route.<span class="hljs-property">path</span> === pathname) {
      <span class="hljs-keyword">return</span> route;
    }

    <span class="hljs-keyword">if</span> (route.<span class="hljs-property">children</span>) {
      <span class="hljs-keyword">const</span> found = <span class="hljs-title function_">findRouteByPath</span>(pathname, route.<span class="hljs-property">children</span>);
      <span class="hljs-keyword">if</span> (found) {
        <span class="hljs-keyword">return</span> found;
      }
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
};

<span class="hljs-comment">/**
 * ç”Ÿæˆé¢åŒ…å±‘å¯¼èˆªæ•°æ®
 */</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">generateBreadcrumbs</span> = (<span class="hljs-params">pathname</span>) =&gt; {
  <span class="hljs-keyword">const</span> segments = pathname.<span class="hljs-title function_">split</span>(<span class="hljs-string">'/'</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-title class_">Boolean</span>);
  <span class="hljs-keyword">const</span> breadcrumbs = [];
  <span class="hljs-keyword">let</span> currentPath = <span class="hljs-string">''</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> segment <span class="hljs-keyword">of</span> segments) {
    currentPath += <span class="hljs-string">`/<span class="hljs-subst">${segment}</span>`</span>;
    <span class="hljs-keyword">const</span> route = <span class="hljs-title function_">findRouteByPath</span>(currentPath);

    <span class="hljs-keyword">if</span> (route?.<span class="hljs-property">meta</span>?.<span class="hljs-property">title</span>) {
      breadcrumbs.<span class="hljs-title function_">push</span>({
        <span class="hljs-attr">title</span>: route.<span class="hljs-property">meta</span>.<span class="hljs-property">title</span>,
        <span class="hljs-attr">path</span>: route.<span class="hljs-property">path</span> !== <span class="hljs-string">'/404'</span> ? currentPath : <span class="hljs-literal">undefined</span>,
      });
    }
  }
  <span class="hljs-keyword">return</span> breadcrumbs;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">AppRouter</span>;

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[reactä½¿ç”¨Ant Design]]></title>    <link>https://juejin.cn/post/7593015632078405659</link>    <guid>https://juejin.cn/post/7593015632078405659</guid>    <pubDate>2026-01-09T03:58:56.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593015632078405659" data-draft-id="7592996072705032242" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="reactä½¿ç”¨Ant Design"/> <meta itemprop="keywords" content="å‰ç«¯,React.js,Ant Design"/> <meta itemprop="datePublished" content="2026-01-09T03:58:56.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="åŠ æ²¹ä¹"/> <meta itemprop="url" content="https://juejin.cn/user/84036866547575"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            reactä½¿ç”¨Ant Design
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/84036866547575/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    åŠ æ²¹ä¹
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T03:58:56.000Z" title="Fri Jan 09 2026 03:58:56 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%}.markdown-body p{color:#595959;font-size:15px;line-height:2;font-weight:400}.markdown-body p+p{margin-top:16px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{padding:30px 0;margin:0;color:#135ce0}.markdown-body h1{position:relative;text-align:center;font-size:22px;margin:50px 0}.markdown-body h1:before{position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)}.markdown-body h2{position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0}.markdown-body h3{font-size:16px}.markdown-body ul{list-style:disc outside;margin-left:2em;margin-top:1em}.markdown-body li{line-height:2;color:#595959}.markdown-body img.loaded{margin:0 auto;display:block}.markdown-body blockquote{background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5}.markdown-body blockquote p{color:#666;line-height:2}.markdown-body a{color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none}.markdown-body em strong,.markdown-body strong{color:#036aca}.markdown-body hr{border-top:1px solid #135ce0}.markdown-body pre{overflow:auto}.markdown-body code,.markdown-body pre{overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body table{border-collapse:collapse;margin:1rem 0;overflow-x:auto}.markdown-body table td,.markdown-body table th{border:1px solid #dfe2e5;padding:.6em 1em}.markdown-body table tr{border-top:1px solid #dfe2e5}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}</style><style data-highlight="" data-highlight-key="a11y-dark">.hljs-comment,.hljs-quote{color:#d4d0ab}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#ffa07a}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#f5ab35}.hljs-attribute{color:gold}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#abe338}.hljs-section,.hljs-title{color:#00e0e0}.hljs-keyword,.hljs-selector-tag{color:#dcc6e0}.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#2b2b2b;color:#f8f8f2}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}@media screen and (-ms-high-contrast:active){.hljs-addition,.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-bullet,.hljs-comment,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-quote,.hljs-string,.hljs-symbol,.hljs-type{color:highlight}.hljs-keyword,.hljs-selector-tag{font-weight:700}}</style><h2 data-id="heading-0">ä¸€ã€å®‰è£…</h2>
<ul>
<li>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fant.design%2Fdocs%2Freact%2Fintroduce-cn" target="_blank" title="https://ant.design/docs/react/introduce-cn" ref="nofollow noopener noreferrer">Ant Design</a></li>
<li>npm</li>
</ul>
<pre><code class="hljs language-css" lang="css">npm install antd <span class="hljs-attr">--save</span>
</code></pre>
<ul>
<li>yarn</li>
</ul>
<pre><code class="hljs language-csharp" lang="csharp">yarn <span class="hljs-keyword">add</span> antd
</code></pre>
<ul>
<li>pnpm</li>
</ul>
<pre><code class="hljs language-css" lang="css">pnpm install antd <span class="hljs-attr">--save</span>
</code></pre>
<h2 data-id="heading-1">äºŒã€mainå¼•ç”¨</h2>
<ul>
<li>å¼•å…¥Ant Designçš„<code>reset.css</code>æ–‡ä»¶</li>
<li>å¼•å…¥<code>ConfigProvider</code>å…¨å±€é…ç½®ï¼Œä¸”åŒ…å«æ‰€æœ‰ç»„ä»¶</li>
<li>è®¾ç½®<code>locale</code>å±æ€§ä¸º<code>ä¸­æ–‡</code></li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// å¯¼å…¥ä¸¥æ ¼æ¨¡å¼ç»„ä»¶ï¼Œç”¨äºå¼€å‘ç¯å¢ƒä¸‹æ£€æµ‹æ½œåœ¨é—®é¢˜</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">StrictMode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-comment">// å¯¼å…¥å®¢æˆ·ç«¯æ¸²æŸ“æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºæ ¹èŠ‚ç‚¹å¹¶æ¸²æŸ“åº”ç”¨</span>
<span class="hljs-keyword">import</span> { createRoot } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom/client'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title class_">App</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'./App.jsx'</span>;
<span class="hljs-comment">// å¯¼å…¥Ant Designçš„æ ·å¼æ–‡ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'antd/dist/reset.css'</span>;
<span class="hljs-comment">// å¯¼å…¥å…¨å±€è‡ªå®šä¹‰æ ·å¼æ–‡ä»¶</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'./index.css'</span>;
<span class="hljs-comment">// å¯¼å…¥Ant Designé…ç½®æä¾›è€…ç»„ä»¶</span>
<span class="hljs-keyword">import</span> { <span class="hljs-title class_">ConfigProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;
<span class="hljs-comment">// å¯¼å…¥Ant Designçš„ä¸­æ–‡è¯­è¨€åŒ…</span>
<span class="hljs-keyword">import</span> zhCN <span class="hljs-keyword">from</span> <span class="hljs-string">'antd/locale/zh_CN'</span>;

<span class="hljs-comment">// è·å– HTML ä¸­ id ä¸º 'root' çš„ DOM å…ƒç´ ä½œä¸ºåº”ç”¨æ ¹èŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> rootElement = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'root'</span>);

<span class="hljs-comment">// å¦‚æœæ‰¾ä¸åˆ°æ ¹èŠ‚ç‚¹ï¼Œåˆ™æŠ›å‡ºé”™è¯¯</span>
<span class="hljs-keyword">if</span> (!rootElement) {
	<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'æ‰¾ä¸åˆ°idä¸º"root"çš„DOMå…ƒç´ ï¼Œè¯·æ£€æŸ¥index.htmlæ–‡ä»¶'</span>);
}

<span class="hljs-comment">// åˆ›å»º React æ ¹èŠ‚ç‚¹</span>
<span class="hljs-keyword">const</span> root = <span class="hljs-title function_">createRoot</span>(rootElement);

<span class="hljs-comment">// æ¸²æŸ“æ•´ä¸ª React åº”ç”¨</span>
root.<span class="hljs-title function_">render</span>(
	<span class="hljs-comment">// ä½¿ç”¨ä¸¥æ ¼æ¨¡å¼åŒ…è£…åº”ç”¨</span>
	<span class="hljs-comment">// æ³¨æ„ï¼šä¸¥æ ¼æ¨¡å¼åªåœ¨å¼€å‘ç¯å¢ƒç”Ÿæ•ˆï¼Œç”Ÿäº§ç¯å¢ƒä¼šè‡ªåŠ¨ç¦ç”¨</span>
	<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">StrictMode</span>&gt;</span>
		{/*
		 ConfigProvider æ˜¯ Ant Design çš„å…¨å±€é…ç½®ç»„ä»¶
		 æ­¤å¤„è®¾ç½® locale å±æ€§ä¸ºä¸­æ–‡è¯­è¨€åŒ…ï¼Œå®ç°ç»„ä»¶å›½é™…åŒ–
		 å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šå…¨å±€é…ç½®ï¼Œå¦‚ä¸»é¢˜å®šåˆ¶ç­‰
		 */}
		<span class="hljs-tag">&lt;<span class="hljs-name">ConfigProvider</span> <span class="hljs-attr">locale</span>=<span class="hljs-string">{zhCN}</span>&gt;</span>
			{/*
			 åº”ç”¨ä¸»ç»„ä»¶
			 æ‰€æœ‰é¡µé¢å’Œè·¯ç”±éƒ½å°†åœ¨ App ç»„ä»¶å†…éƒ¨å®šä¹‰å’Œç®¡ç†
			 */}
			<span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">ConfigProvider</span>&gt;</span>
	<span class="hljs-tag">&lt;/<span class="hljs-name">StrictMode</span>&gt;</span></span>
);

</code></pre>
<h2 data-id="heading-2">ä¸‰ã€ç»„ä»¶å¼•ç”¨</h2>
<ul>
<li>å¼•ç”¨Buttonï¼ŒæŸ¥çœ‹ä½¿ç”¨æ•ˆæœ</li>
</ul>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'antd'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">App</span>(<span class="hljs-params"/>) {
	<span class="hljs-keyword">return</span> (
		<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
			<span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"primary"</span>&gt;</span>æŒ‰é’®<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
	);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">App</span>;

</code></pre></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[AQS è§£æï¼šä»åŸç†åˆ°å®æˆ˜]]></title>    <link>https://juejin.cn/post/7592815497848864831</link>    <guid>https://juejin.cn/post/7592815497848864831</guid>    <pubDate>2026-01-09T01:41:59.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592815497848864831" data-draft-id="7592863358258905142" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="AQS è§£æï¼šä»åŸç†åˆ°å®æˆ˜"/> <meta itemprop="keywords" content="Java,åç«¯"/> <meta itemprop="datePublished" content="2026-01-09T01:41:59.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="gelald"/> <meta itemprop="url" content="https://juejin.cn/user/923245499657822"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            AQS è§£æï¼šä»åŸç†åˆ°å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/923245499657822/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    gelald
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:41:59.000Z" title="Fri Jan 09 2026 01:41:59 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    5
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">ä¸ºä»€ä¹ˆéœ€è¦ AQS</h2>
<p>ç»è¿‡ synchronized çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“ synchronized å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç»™ä¸€æ®µå…±äº«èµ„æºçš„æ“ä½œåŠ ä¸Šé”ï¼Œå¯¹æ“ä½œè¿›è¡ŒåŒæ­¥æ§åˆ¶ï¼›</p>
<p>ä½†æ˜¯ synchronized ä¹Ÿæœ‰ä¸€å®šçš„å¼Šç«¯ï¼š</p>
<ul>
<li><strong>ä¸æ”¯æŒä¸­æ–­</strong> (çº¿ç¨‹æ— æ³•å“åº” interrupt)</li>
<li><strong>ä¸æ”¯æŒè¶…æ—¶</strong> (æ— æ³•è¿›è¡Œ <code>tryLock(timeout)</code>)</li>
<li><strong>ä¸æ”¯æŒå…¬å¹³é”</strong> (æ— æ³•ä¿è¯ FIFO è·å–)</li>
</ul>
<p>AQS å…¨ç§° AbstractQueueSynchronizer (æŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨)ï¼Œå®ƒæ­£æ˜¯ç”¨æ¥è§£å†³ä»¥ä¸Šå¼Šç«¯çš„ï¼ŒåŒæ—¶å®ƒä½œä¸º J.U.C åŒ…çš„åŸºç¡€ï¼Œæä¾›äº†ï¼š</p>
<ul>
<li>æ ‡å‡†åŒ–çš„åŒæ­¥æ¡†æ¶ï¼šç»Ÿä¸€å°è£…äº†çº¿ç¨‹æ’é˜Ÿã€é˜»å¡ã€å”¤é†’ç­‰é€šç”¨é€»è¾‘</li>
<li>çµæ´»çš„æ‰©å±•èƒ½åŠ›ï¼šä½¿ç”¨æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ï¼Œå®šåˆ¶è‡ªå®šä¹‰åŒæ­¥è¯­æ„</li>
<li>é«˜æ€§èƒ½æ— é”è®¾è®¡ï¼šCAS åŸå­æ“ä½œ + <code>volatile</code> ä¿è¯æ•°æ®ä¿®æ”¹æ˜¯çº¿ç¨‹å®‰å…¨çš„</li>
</ul>
<h2 data-id="heading-1">AQS æ ¸å¿ƒç»„ä»¶</h2>
<blockquote>
<p>AQS çš„è®¾è®¡ç²¾é«“ï¼šä¸€ä¸ªçŠ¶æ€(state) + ä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—(CLH) + ä¸€å¥—åŸå­æ“ä½œ(CAS)</p>
</blockquote>
<h3 data-id="heading-2"><code>state</code> åŒæ­¥çŠ¶æ€æœº</h3>
<p><code>state</code> å¯ä»¥ç†è§£ä¸ºé”çš„è®¡æ•°å™¨ï¼Œæˆ–è€…èµ„æºå‰©ä½™é‡ï¼Œç”¨å…·ä½“ä¾‹å­æ¥è¯´æ˜ï¼š</p>
<ul>
<li><code>ReentrantLock</code>: <code>state = 0</code> è¡¨ç¤ºæ— é”ï¼Œ<code>state &gt; 0</code> è¡¨ç¤ºè¢«æŒæœ‰ä»¥åŠé”é‡å…¥çš„æ¬¡æ•°</li>
<li><code>CountDownLatch</code>: <code>state = 3</code> è¡¨ç¤ºè¿˜éœ€è¦è¿›è¡Œ 3 æ¬¡ <code>countDown()</code></li>
</ul>
<p>å…³é”®è®¾è®¡ï¼š<code>state</code> è¢« <code>volatile</code> ä¿®é¥°ï¼Œä¿è¯äº†å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§</p>
<h3 data-id="heading-3">CLH FIFOé˜»å¡é˜Ÿåˆ—</h3>
<p>CLH é˜Ÿåˆ—æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨å®ç°çš„é˜»å¡é˜Ÿåˆ—ï¼Œ<strong>AQS é€šè¿‡ prev å’Œ next ä¸¤ä¸ªæŒ‡é’ˆæ¥ç»´æŠ¤é“¾è¡¨</strong></p>
<p>CLH é˜Ÿåˆ—å·¥ä½œæµç¨‹ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">graph LR
  A[çº¿ç¨‹å°è¯•è·å– state] --&gt;|å¤±è´¥| B[åˆ›å»º Node å…¥é˜Ÿ]
  B --&gt; C{å‰é©±æ˜¯ head ?}
  C --&gt;|æ˜¯| D[å†æ¬¡å°è¯•è·å–]
  C --&gt;|å¦| E[é˜»å¡ park]
  D --&gt;|æˆåŠŸ| F[è®¾ä¸ºæ–° head]
  D --&gt;|å¤±è´¥| E
  E --&gt;|è¢«å”¤é†’| C
</code></pre>
<p>CLH é˜Ÿåˆ—é«˜æ•ˆå…³é”®ï¼š</p>
<ul>
<li>å½“çº¿ç¨‹è·å– <code>state</code> å¤±è´¥æ—¶ï¼Œä¼šè¢«å°è£…æˆä¸€ä¸ª <code>Node</code> ï¼Œ<strong>é€šè¿‡ CAS çš„æ–¹å¼åŠ å…¥ CLH é˜Ÿåˆ—å°¾éƒ¨</strong>ï¼Œé¿å…ä½¿ç”¨ <code>synchronized</code> è€Œå¸¦æ¥çš„å¼€é”€</li>
<li>æ¯ä¸ªçº¿ç¨‹åªéœ€è¦å…³æ³¨å‰é©±çº¿ç¨‹ï¼Œæ¯”å¦‚çº¿ç¨‹ B é˜»å¡æ—¶ï¼Œ<strong>åªç­‰å¾…å‰é©±èŠ‚ç‚¹çº¿ç¨‹ A å”¤é†’</strong> (<code>LockSupport.unpark</code>)ï¼›é¿å…äº†å…¨å±€é€šçŸ¥çš„å¼€é”€ï¼ŒåŒæ—¶å¤©ç„¶ä¿è¯ FIFO ç‰¹æ€§</li>
</ul>
<h3 data-id="heading-4">CAS åŸå­æ“ä½œåŸºçŸ³</h3>
<p>AQS ä¸­å¯¹äº <code>state</code> çŠ¶æ€æœºçš„ä¿®æ”¹å’Œçº¿ç¨‹åŠ å…¥ CLH é˜Ÿåˆ—çš„æ“ä½œéƒ½æ˜¯ä½¿ç”¨ CAS çš„æ–¹å¼ï¼Œæ—¢å®‰å…¨åˆæ¯” <code>synchronized</code> é«˜æ•ˆ</p>
<h2 data-id="heading-5">AQS ç‹¬å æ¨¡å¼ä¸å…±äº«æ¨¡å¼</h2>



































<table><thead><tr><th align="center">å¯¹æ¯”ç»´åº¦</th><th align="center">ç‹¬å æ¨¡å¼ (Exclusive)</th><th align="center">å…±äº«æ¨¡å¼ (Shared)</th></tr></thead><tbody><tr><td align="center">è¯­ä¹‰</td><td align="center">ä¸€æ¬¡ä»…å…è®¸ä¸€ä¸ªçº¿ç¨‹é€šè¿‡</td><td align="center">åœ¨èµ„æºè¶³å¤Ÿçš„æƒ…å†µä¸‹ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶é€šè¿‡</td></tr><tr><td align="center">æ ¸å¿ƒæ–¹æ³•</td><td align="center"><code>tryAcquire() -&gt; boolean</code></td><td align="center"><code>tryAcquireShared() -&gt; int</code></td></tr><tr><td align="center">è¿”å›å€¼å«ä¹‰</td><td align="center"><code>true</code> è¡¨ç¤ºæˆåŠŸ</td><td align="center"><code>&gt;=0</code> è¡¨ç¤ºæˆåŠŸï¼Œå€¼è¡¨ç¤ºå‰©ä½™èµ„æº <br/> <code>&lt;0</code> è¡¨ç¤ºå¤±è´¥</td></tr><tr><td align="center">å”¤é†’è¡Œä¸º</td><td align="center">å”¤é†’ä¸€ä¸ªåç»§</td><td align="center">ä¼ æ’­å¼å”¤é†’ (å¤šä¸ªçº¿ç¨‹åŒæ—¶é€šè¿‡)</td></tr><tr><td align="center">ä»£è¡¨å·¥å…·</td><td align="center"><code>ReentrantLock</code>ã€<code>ReentrantReadWriteLock.WriteLock</code></td><td align="center"><code>CountDownLatch</code>ã€<code>ReentrantReadWriteLock.ReadLock</code>ã€<code>Semaphore</code></td></tr></tbody></table>
<h2 data-id="heading-6">å…¬å¹³é”ä¸éå…¬å¹³é”</h2>
<p>å…ˆç®€å•è®²è®²å…¬å¹³é”å’Œéå…¬å¹³é”çš„æ„æ€ï¼š</p>
<ul>
<li>å…¬å¹³é”ï¼šæ¯ä¸ªçº¿ç¨‹æŒ‰ç…§è®¿é—®é”çš„å…ˆåé¡ºåºæ¥è·å–é”ï¼Œéµé¡¼å…ˆè®¿é—®å…ˆè·å–çš„è§„åˆ™</li>
<li>éå…¬å¹³é”ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šç«äº‰é”çš„è·å–ï¼Œè·å–é¡ºåºæ˜¯éšæœºçš„ï¼Œä¸éµå¾ªå…ˆæ¥å…ˆå¾—çš„è§„åˆ™</li>
</ul>
<p>ReentrantLock ä¸­å¯¹å…¬å¹³é”å’Œéå…¬å¹³é”éƒ½è¿›è¡Œäº†å®ç°ï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äº <code>tryAcquire()</code> æ–¹æ³•ä¸­ï¼Œå…¶ä¸­ <code>FairSync</code> çš„å®ç°ä¸­ï¼Œåœ¨ CAS ä¿®æ”¹ <code>state</code> ä¹‹å‰è¿˜å…ˆæ£€æŸ¥äº†ä¸€ä¸‹æ’é˜Ÿçº¿ç¨‹ï¼Œå‰é¢æ²¡æœ‰å…¶ä»–çº¿ç¨‹ç­‰å¾…é”äº†ï¼Œæ‰è¿›è¡Œ CAS ä¿®æ”¹ <code>state</code> æ¥è·å–é”ï¼›åœ¨ <code>NonfairSync</code> çš„å®ç°ä¸­ï¼Œåˆ™æ‰€æœ‰çº¿ç¨‹ä¸ç®¡é˜Ÿåˆ—ï¼Œç›´æ¥ä¸€èµ·æŠ¢å </p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
        <span class="hljs-comment">// hasQueuedPredecessors: å¦‚æœå½“å‰çº¿ç¨‹å‰é¢æœ‰å·²æ’é˜Ÿçš„çº¿ç¨‹ï¼Œåˆ™è¿”å› trueï¼›å¦‚æœå½“å‰çº¿ç¨‹ä½äºé˜Ÿåˆ—å¤´éƒ¨æˆ–é˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™è¿”å› falseã€‚</span>
        <span class="hljs-keyword">if</span> (getState() == <span class="hljs-number">0</span> &amp;&amp; !hasQueuedPredecessors() &amp;&amp; compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
            setExclusiveOwnerThread(Thread.currentThread());
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}

<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NonfairSync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Sync</span> {
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
        <span class="hljs-keyword">if</span> (getState() == <span class="hljs-number">0</span> &amp;&amp; compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
            setExclusiveOwnerThread(Thread.currentThread());
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<h2 data-id="heading-7">AQS ç®€æ˜“å®ç°</h2>
<h3 data-id="heading-8">ä¸å¯é‡å…¥é”</h3>
<p>æ¥ä¸‹æ¥ä½¿ç”¨ AQS æ¥å®ç° synchronized åŠŸèƒ½</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AQSDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">SimpleMutex</span> <span class="hljs-variable">simpleMutex</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SimpleMutex</span>();

        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-comment">// çº¿ç¨‹1ï¼šè·å–é”å¹¶æŒæœ‰3ç§’</span>
            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" å°è¯•è·å–é”"</span>);
            simpleMutex.lock();
            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" è·å–é”æˆåŠŸ"</span>);
            <span class="hljs-keyword">try</span> {
                TimeUnit.SECONDS.sleep(<span class="hljs-number">3</span>);
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                Thread.currentThread().interrupt();
            } <span class="hljs-keyword">finally</span> {
                System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" é‡Šæ”¾é”"</span>);
                simpleMutex.unlock();
            }
        }, <span class="hljs-string">"Thread-1"</span>);

        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-comment">// ç¡®ä¿çº¿ç¨‹1æ‹¿åˆ°é”</span>
                TimeUnit.MILLISECONDS.sleep(<span class="hljs-number">100</span>);
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
            <span class="hljs-comment">// çº¿ç¨‹2ï¼šè·å–é”æ—¶ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œç›´åˆ°çº¿ç¨‹1é‡Šæ”¾é”</span>
            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" å°è¯•è·å–é”"</span>);
            simpleMutex.lock();
            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" è·å–é”æˆåŠŸ"</span>);
            <span class="hljs-keyword">try</span> {
                TimeUnit.SECONDS.sleep(<span class="hljs-number">3</span>);
            } <span class="hljs-keyword">catch</span> (InterruptedException e) {
                Thread.currentThread().interrupt();
            } <span class="hljs-keyword">finally</span> {
                simpleMutex.unlock();
                System.out.println(Thread.currentThread().getName() + <span class="hljs-string">" é‡Šæ”¾é”"</span>);
            }
        }, <span class="hljs-string">"Thread-2"</span>);

        t1.start();
        t2.start();

        t1.join();
        t2.join();

        System.out.println(<span class="hljs-string">"ä¸»çº¿ç¨‹ç»“æŸï¼Œé”çŠ¶æ€ï¼š"</span> + (simpleMutex.isLocked() ? <span class="hljs-string">"å·²é”"</span> : <span class="hljs-string">"æœªé”"</span>));
    }
}

<span class="hljs-comment">/**
 * ä¸€ä¸ªåŸºäº AQS çš„ç®€å•äº’æ–¥é”ï¼ˆä¸å¯é‡å…¥ï¼‰
 */</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">SimpleMutex</span> {
    <span class="hljs-comment">// å®ç°äº’æ–¥é”çš„æ ¸å¿ƒç»„ä»¶ï¼Œé€šè¿‡ AQS æ¥æ„å»ºåŒæ­¥å·¥å…·</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
            <span class="hljs-comment">// é€šè¿‡ CAS çš„æ–¹å¼ä¿®æ”¹ state å€¼</span>
            <span class="hljs-comment">// åŸå­åœ°è·å–é”</span>
            <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) {
                <span class="hljs-comment">// è®°å½•å½“å‰æ‹¥æœ‰ç‹¬ç«‹è®¿é—®æƒé™çš„çº¿ç¨‹</span>
                <span class="hljs-comment">// å¯é‡å…¥çš„åŸºç¡€</span>
                setExclusiveOwnerThread(Thread.currentThread());
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> arg)</span> {
            <span class="hljs-keyword">if</span> (getState() == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// å¦‚æœ state å·²ç»æ˜¯ 0ï¼Œè¯´æ˜æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œæˆ–è€…å·²ç»è¢«é‡Šæ”¾äº†ï¼ŒæŠ›å‡ºå¼‚å¸¸</span>
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
            }
            <span class="hljs-comment">// æ¸…é™¤æ‹¥æœ‰ç‹¬ç«‹è®¿é—®æƒé™çº¿ç¨‹çš„æ ‡è¯†</span>
            setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
            <span class="hljs-comment">// state = 0 è¯´æ˜é‡Šæ”¾é”</span>
            setState(<span class="hljs-number">0</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
            <span class="hljs-comment">// é€šè¿‡ state æ˜¯å¦ç­‰äº 1 æ¥åˆ¤æ–­é”æ˜¯å¦è¢«æŒæœ‰</span>
            <span class="hljs-keyword">return</span> getState() == <span class="hljs-number">1</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Sync</span> <span class="hljs-variable">sync</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sync</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        sync.acquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        sync.release(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.isHeldExclusively();
    }
}
</code></pre>
<p>ç»“æœæ˜¯ï¼šçº¿ç¨‹ 2 ä¹Ÿå°è¯•è·å–é”ï¼Œä½†æ˜¯é˜»å¡ç­‰å¾…ç€çº¿ç¨‹ 1 çš„é‡Šæ”¾</p>
<pre><code class="hljs">Thread-1 å°è¯•è·å–é”
Thread-1 è·å–é”æˆåŠŸ
Thread-2 å°è¯•è·å–é”
Thread-1 é‡Šæ”¾é”
Thread-2 è·å–é”æˆåŠŸ
Thread-2 é‡Šæ”¾é”
ä¸»çº¿ç¨‹ç»“æŸï¼Œé”çŠ¶æ€ï¼šæœªé”
</code></pre>
<h3 data-id="heading-9">å¯é‡å…¥é”</h3>
<p>åœ¨ç®€æ˜“å®ç°çš„åŸºç¡€ä¸Šæ·»åŠ é‡å…¥çš„æ”¯æŒï¼Œæ ¸å¿ƒè¦ç‚¹å°±æ˜¯æ£€æŸ¥ <code>state</code> çš„æ•°é‡å’Œ <code>exclusiveOwnerThread</code> çš„æŒ‡å‘</p>
<pre><code class="hljs language-java" lang="java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AQSDemo</span> {
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InterruptedException {
        <span class="hljs-type">ReentrantMutex</span> <span class="hljs-variable">reentrantMutex</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReentrantMutex</span>();

        <span class="hljs-type">Thread</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(() -&gt; {
            System.out.println(<span class="hljs-string">"çº¿ç¨‹å¼€å§‹"</span>);

            reentrantMutex.lock();
            System.out.println(<span class="hljs-string">"ç¬¬1æ¬¡ lockï¼ŒholdCount = "</span> + reentrantMutex.getHoldCount());

            reentrantMutex.lock();
            System.out.println(<span class="hljs-string">"ç¬¬2æ¬¡ lockï¼ŒholdCount = "</span> + reentrantMutex.getHoldCount());

            reentrantMutex.lock();
            System.out.println(<span class="hljs-string">"ç¬¬3æ¬¡ lockï¼ŒholdCount = "</span> + reentrantMutex.getHoldCount());

            <span class="hljs-comment">// é‡Šæ”¾ä¸‰æ¬¡</span>
            reentrantMutex.unlock();
            System.out.println(<span class="hljs-string">"ç¬¬1æ¬¡ unlockï¼ŒholdCount = "</span> + reentrantMutex.getHoldCount());

            reentrantMutex.unlock();
            System.out.println(<span class="hljs-string">"ç¬¬2æ¬¡ unlockï¼ŒholdCount = "</span> + reentrantMutex.getHoldCount());

            reentrantMutex.unlock();
            System.out.println(<span class="hljs-string">"ç¬¬3æ¬¡ unlockï¼ŒholdCount = "</span> + reentrantMutex.getHoldCount());

            System.out.println(<span class="hljs-string">"çº¿ç¨‹ç»“æŸï¼Œé”æ˜¯å¦é‡Šæ”¾: "</span> + !reentrantMutex.isLocked());
        });

        t.start();
        <span class="hljs-keyword">try</span> {
            t.join();
        } <span class="hljs-keyword">catch</span> (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
}

<span class="hljs-keyword">class</span> <span class="hljs-title class_">ReentrantMutex</span> {
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractQueuedSynchronizer</span> {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAcquire</span><span class="hljs-params">(<span class="hljs-type">int</span> acquires)</span> {
            <span class="hljs-type">Thread</span> <span class="hljs-variable">current</span> <span class="hljs-operator">=</span> Thread.currentThread();
            <span class="hljs-type">int</span> <span class="hljs-variable">state</span> <span class="hljs-operator">=</span> getState();

            <span class="hljs-keyword">if</span> (state == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// æ— é”ï¼Œå°è¯•è·å–</span>
                <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, acquires)) {
                    setExclusiveOwnerThread(current);
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
                }
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (current == getExclusiveOwnerThread()) {
                <span class="hljs-comment">// å¯é‡å…¥ï¼šåŒä¸€çº¿ç¨‹å†æ¬¡è·å–</span>
                <span class="hljs-type">int</span> <span class="hljs-variable">next</span> <span class="hljs-operator">=</span> state + acquires;
                <span class="hljs-keyword">if</span> (next &lt; <span class="hljs-number">0</span>) { <span class="hljs-comment">// æº¢å‡ºæ£€æŸ¥</span>
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Maximum lock count exceeded"</span>);
                }
                setState(next);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryRelease</span><span class="hljs-params">(<span class="hljs-type">int</span> releases)</span> {
            <span class="hljs-type">int</span> <span class="hljs-variable">state</span> <span class="hljs-operator">=</span> getState() - releases;
            <span class="hljs-keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread()) {
                <span class="hljs-comment">// éæŒæœ‰è€…é‡Šæ”¾é”ï¼ŒæŠ›å‡ºå¼‚å¸¸</span>
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalMonitorStateException</span>();
            }

            <span class="hljs-type">boolean</span> <span class="hljs-variable">free</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;

            <span class="hljs-keyword">if</span> (state == <span class="hljs-number">0</span>) {
                <span class="hljs-comment">// é‡å…¥æ¬¡æ•°å½’é›¶ï¼ŒçœŸæ­£é‡Šæ”¾</span>
                free = <span class="hljs-literal">true</span>;
                setExclusiveOwnerThread(<span class="hljs-literal">null</span>);
            }
            <span class="hljs-comment">// æœªå½’é›¶ï¼Œç»§ç»­æ›´æ–° state</span>
            setState(state);
            <span class="hljs-comment">// æ³¨æ„ï¼šAQS release() ä¼šæ£€æŸ¥ tryRelease() è¿”å›å€¼æ˜¯å¦ä¸º true</span>
            <span class="hljs-keyword">return</span> free;
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">protected</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isHeldExclusively</span><span class="hljs-params">()</span> {
            <span class="hljs-keyword">return</span> getExclusiveOwnerThread() == Thread.currentThread();
        }

        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> {
            <span class="hljs-comment">// å¦‚æœè¢«æŒæœ‰ç€ï¼Œè¿”å›é‡å…¥æ¬¡æ•°</span>
            <span class="hljs-comment">// å¦‚æœæ²¡æœ‰è¢«æŒæœ‰ï¼Œç›´æ¥è¿”å›0</span>
            <span class="hljs-keyword">return</span> isHeldExclusively() ? getState() : <span class="hljs-number">0</span>;
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Sync</span> <span class="hljs-variable">sync</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Sync</span>();

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lock</span><span class="hljs-params">()</span> {
        sync.acquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">unlock</span><span class="hljs-params">()</span> {
        sync.release(<span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isLocked</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.isHeldExclusively();
    }

    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getHoldCount</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> sync.getHoldCount();
    }
}
</code></pre>
<p>ç»“æœæ˜¯ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">çº¿ç¨‹å¼€å§‹
ç¬¬1æ¬¡ lockï¼Œ<span class="hljs-attr">holdCount</span> = <span class="hljs-number">1</span>
ç¬¬2æ¬¡ lockï¼Œ<span class="hljs-attr">holdCount</span> = <span class="hljs-number">2</span>
ç¬¬3æ¬¡ lockï¼Œ<span class="hljs-attr">holdCount</span> = <span class="hljs-number">3</span>
ç¬¬1æ¬¡ unlockï¼Œ<span class="hljs-attr">holdCount</span> = <span class="hljs-number">2</span>
ç¬¬2æ¬¡ unlockï¼Œ<span class="hljs-attr">holdCount</span> = <span class="hljs-number">1</span>
ç¬¬3æ¬¡ unlockï¼Œ<span class="hljs-attr">holdCount</span> = <span class="hljs-number">0</span>
çº¿ç¨‹ç»“æŸï¼Œé”æ˜¯å¦é‡Šæ”¾: true
</code></pre>
<h2 data-id="heading-10">æ€»ç»“ AQS çš„è®¾è®¡å“²å­¦</h2>
<ul>
<li><strong>åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œé«˜æ•ˆæ‰©å±•</strong>ï¼šAQS ä¸­å·²ç»å®šä¹‰å¥½é€šç”¨çš„é€»è¾‘ (è·å–é”ã€é˜»å¡æ’é˜Ÿã€é‡Šæ”¾é”ã€å”¤é†’)ï¼Œæ¯”å¦‚ <code>acquire()</code> å’Œ <code>release()</code> æ–¹æ³•ï¼›å­ç±»åªéœ€è¦å®ç° â€œå¦‚ä½•é€šè¿‡â€ (æ€ä¹ˆæ ·æ‰ç®—æ˜¯è·å–/é‡Šæ”¾é”æˆåŠŸ/å¤±è´¥)ï¼Œæ¯”å¦‚ <code>tryAcquire()</code> å’Œ <code>tryRelease()</code> æ–¹æ³•ï¼Œä½“ç°äº†æ¨¡æ¿æ–¹æ³•çš„è®¾è®¡æ¨¡å¼</li>
<li><strong>çº¿ç¨‹å®‰å…¨ï¼Œæ“ä½œé«˜æ•ˆ</strong>ï¼šå¯¹äº <code>state</code> çŠ¶æ€æœºä»¥åŠé˜Ÿåˆ—æ“ä½œï¼Œéƒ½ä½¿ç”¨ <code>volatile</code> ä¿®é¥°ä¸”ä½¿ç”¨ CAS æ“ä½œï¼Œé¿å…ç›´æ¥ä½¿ç”¨ synchronizedï¼Œæ—¢ä¿è¯å®‰å…¨åˆä¿è¯äº†æ€§èƒ½ï¼›CLH é˜Ÿåˆ—çš„å”¤é†’ï¼Œåªéœ€è¦å”¤é†’åä¸€ä¸ªçº¿ç¨‹ï¼Œé¿å…å…¨å±€å”¤é†’çš„å¼€é”€</li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Dubboå¾®æœåŠ¡å®æˆ˜]]></title>    <link>https://juejin.cn/post/7593139476833157163</link>    <guid>https://juejin.cn/post/7593139476833157163</guid>    <pubDate>2026-01-09T06:17:28.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593139476833157163" data-draft-id="7592887786966761508" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Dubboå¾®æœåŠ¡å®æˆ˜"/> <meta itemprop="keywords" content="Dubbo"/> <meta itemprop="datePublished" content="2026-01-09T06:17:28.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é›¨ä¸­é£˜è¡çš„è®°å¿†"/> <meta itemprop="url" content="https://juejin.cn/user/694547077666606"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Dubboå¾®æœåŠ¡å®æˆ˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/694547077666606/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é›¨ä¸­é£˜è¡çš„è®°å¿†
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T06:17:28.000Z" title="Fri Jan 09 2026 06:17:28 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Dubboå¾®æœåŠ¡å®æˆ˜</h2>
<h2 data-id="heading-1">å‰è¨€</h2>
<p>åœ¨å¾®æœåŠ¡æ¶æ„ç››è¡Œçš„ä»Šå¤©ï¼Œåˆ†å¸ƒå¼æœåŠ¡è°ƒç”¨æˆä¸ºäº†ä¼ä¸šçº§åº”ç”¨å¼€å‘çš„æ ‡é…ã€‚Apache Dubboä½œä¸ºé˜¿é‡Œå·´å·´å¼€æºçš„é«˜æ€§èƒ½ã€è½»é‡çº§çš„RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ¡†æ¶ï¼Œåœ¨å›½å†…æ‹¥æœ‰å¹¿æ³›çš„åº”ç”¨åœºæ™¯ã€‚</p>
<h2 data-id="heading-2">ä¸€ã€Dubboç®€ä»‹</h2>
<h3 data-id="heading-3">1.1 ä»€ä¹ˆæ˜¯Dubboï¼Ÿ</h3>
<p>Apache Dubboæ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava RPCæ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼š</p>
<ul>
<li><strong>é¢å‘æ¥å£çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨</strong>ï¼šåƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·è°ƒç”¨è¿œç¨‹æœåŠ¡</li>
<li><strong>æ™ºèƒ½å®¹é”™å’Œè´Ÿè½½å‡è¡¡</strong>ï¼šå†…ç½®å¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥å’Œå®¹é”™æœºåˆ¶</li>
<li><strong>æœåŠ¡è‡ªåŠ¨æ³¨å†Œä¸å‘ç°</strong>ï¼šæ”¯æŒå¤šç§æ³¨å†Œä¸­å¿ƒï¼Œå®ç°æœåŠ¡çš„è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°</li>
</ul>
<h3 data-id="heading-4">1.2 Dubboçš„å‘å±•å†ç¨‹</h3>
<ul>
<li>2011å¹´ï¼šé˜¿é‡Œå·´å·´å¼€æºDubbo 2.0</li>
<li>2014å¹´ï¼šDubboè¿›å…¥ç»´æŠ¤æœŸ</li>
<li>2017å¹´ï¼šé˜¿é‡Œå·´å·´é‡å¯Dubboå¼€å‘</li>
<li>2019å¹´ï¼šDubboæˆä¸ºApacheé¡¶çº§é¡¹ç›®</li>
<li>2023å¹´ï¼šå‘å¸ƒDubbo 3.xç³»åˆ—ï¼Œå…¨é¢æ”¯æŒäº‘åŸç”Ÿ</li>
</ul>
<h3 data-id="heading-5">1.3 ä¸ºä»€ä¹ˆé€‰æ‹©Dubboï¼Ÿ</h3>
<p><strong>å¯¹æ¯”Spring Cloudçš„ä¼˜åŠ¿ï¼š</strong></p>



































<table><thead><tr><th>ç‰¹æ€§</th><th>Dubbo</th><th>Spring Cloud</th></tr></thead><tbody><tr><td>é€šä¿¡åè®®</td><td>Dubboåè®®ï¼ˆæ€§èƒ½æ›´ä¼˜ï¼‰</td><td>HTTP REST</td></tr><tr><td>åºåˆ—åŒ–</td><td>Hessian2ï¼ˆæ•ˆç‡é«˜ï¼‰</td><td>JSON</td></tr><tr><td>æœåŠ¡è°ƒç”¨</td><td>RPCï¼ˆé€æ˜ï¼‰</td><td>REST API</td></tr><tr><td>å­¦ä¹ æ›²çº¿</td><td>è¾ƒä½</td><td>è¾ƒé«˜</td></tr><tr><td>ç¤¾åŒºæ´»è·ƒåº¦</td><td>å›½å†…ä¸ºä¸»</td><td>å›½é™…åŒ–</td></tr></tbody></table>
<h2 data-id="heading-6">äºŒã€Dubboæ ¸å¿ƒæ¶æ„</h2>
<h3 data-id="heading-7">2.1 ç³»ç»Ÿæ¶æ„å›¾</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5a541008a7a74bcdbcc71fad848a65eb~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768544248&amp;x-signature=ivotqTH%2BebmxfJK1JA3mMKkrcOk%3D" alt="" loading="lazy"/></p>
<p>ä¸Šå›¾å±•ç¤ºäº†å®Œæ•´çš„Dubboå¾®æœåŠ¡å…­å±‚æ¶æ„ï¼Œä»å®¢æˆ·ç«¯åˆ°æ•°æ®å±‚çš„å®Œæ•´è°ƒç”¨é“¾è·¯ã€‚Dubboçš„æ¶æ„è®¾è®¡éå¸¸æ¸…æ™°ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹è§’è‰²ï¼š</p>
<ul>
<li><strong>Registryï¼ˆæ³¨å†Œä¸­å¿ƒï¼‰</strong> ï¼šè´Ÿè´£æœåŠ¡çš„æ³¨å†Œä¸å‘ç°</li>
<li><strong>Providerï¼ˆæœåŠ¡æä¾›è€…ï¼‰</strong> ï¼šæš´éœ²æœåŠ¡çš„åº”ç”¨</li>
<li><strong>Consumerï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰</strong> ï¼šè°ƒç”¨è¿œç¨‹æœåŠ¡çš„åº”ç”¨</li>
<li><strong>Monitorï¼ˆç›‘æ§ä¸­å¿ƒï¼‰</strong> ï¼šç»Ÿè®¡æœåŠ¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´</li>
<li><strong>Containerï¼ˆæœåŠ¡å®¹å™¨ï¼‰</strong> ï¼šè´Ÿè´£å¯åŠ¨ã€åŠ è½½å’Œè¿è¡ŒæœåŠ¡</li>
</ul>
<h3 data-id="heading-8">2.2 æœåŠ¡è°ƒç”¨æ—¶åºå›¾</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/77e1484bc0c3476390d69d6b80ff0452~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768544248&amp;x-signature=mtaD2Ig1tY9bl6PnxGglANXKVWM%3D" alt="" loading="lazy"/></p>
<p>ä»æ—¶åºå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä¸€ä¸ªå®Œæ•´çš„DubboæœåŠ¡è°ƒç”¨åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š</p>
<ol>
<li><strong>å®¢æˆ·ç«¯å‘èµ·HTTPè¯·æ±‚</strong>åˆ°Consumer</li>
<li><strong>Consumerå‘Registryè®¢é˜…æœåŠ¡</strong>ï¼Œè·å–Provideråˆ—è¡¨</li>
<li><strong>Registryè¿”å›å¯ç”¨çš„Provideråœ°å€åˆ—è¡¨</strong></li>
<li><strong>Consumeræ ¹æ®è´Ÿè½½å‡è¡¡ç­–ç•¥é€‰æ‹©ä¸€ä¸ªProvider</strong></li>
<li><strong>é€šè¿‡Dubboåè®®è¿›è¡ŒRPCè°ƒç”¨</strong>ï¼ˆé»˜è®¤ç«¯å£20880ï¼‰</li>
<li><strong>ProvideræŸ¥è¯¢æ•°æ®å¹¶è¿”å›ç»“æœ</strong></li>
<li><strong>Consumerå°†ç»“æœä»¥HTTPå“åº”è¿”å›ç»™å®¢æˆ·ç«¯</strong></li>
</ol>
<h3 data-id="heading-9">2.3 Dubboå·¥ä½œåŸç†</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d7198cf5c9e24ec2a612bb8ad83d67e4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768544248&amp;x-signature=FoOfP62BMZQMeI8h6fz%2FHEgGJtA%3D" alt="" loading="lazy"/></p>
<p>Dubboé‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œä»ä¸Šåˆ°ä¸‹å…±9å±‚ï¼š</p>
<ol>
<li><strong>Serviceå±‚ï¼ˆä¸šåŠ¡å±‚ï¼‰</strong> ï¼šæ¥å£å’Œå®ç°å®šä¹‰ï¼Œå¦‚UserServiceã€OrderService</li>
<li><strong>Configå±‚ï¼ˆé…ç½®å±‚ï¼‰</strong> ï¼š@DubboServiceã€@DubboReferenceç­‰é…ç½®</li>
<li><strong>Proxyå±‚ï¼ˆä»£ç†å±‚ï¼‰</strong> ï¼šæœåŠ¡æ¥å£ä»£ç†ï¼Œé€æ˜åŒ–è¿œç¨‹è°ƒç”¨</li>
<li><strong>Registryå±‚ï¼ˆæ³¨å†Œå±‚ï¼‰</strong> ï¼šæœåŠ¡çš„æ³¨å†Œä¸å‘ç°</li>
<li><strong>Clusterå±‚ï¼ˆé›†ç¾¤å±‚ï¼‰</strong> ï¼šè´Ÿè½½å‡è¡¡ã€å®¹é”™å¤„ç†</li>
<li><strong>Protocolå±‚ï¼ˆåè®®å±‚ï¼‰</strong> ï¼šRPCè°ƒç”¨å°è£…</li>
<li><strong>Exchangeå±‚ï¼ˆäº¤æ¢å±‚ï¼‰</strong> ï¼šè¯·æ±‚å“åº”æ˜ å°„</li>
<li><strong>Networkå±‚ï¼ˆç½‘ç»œå±‚ï¼‰</strong> ï¼šNettyã€Minaç­‰ç½‘ç»œé€šä¿¡</li>
<li><strong>Serializeå±‚ï¼ˆåºåˆ—åŒ–å±‚ï¼‰</strong> ï¼šHessian2ã€JSONç­‰æ•°æ®åºåˆ—åŒ–</li>
</ol>
<p>è¿™ç§åˆ†å±‚è®¾è®¡ä½¿å¾—Dubboå…·æœ‰è‰¯å¥½çš„æ‰©å±•æ€§ï¼Œæ¯ä¸€å±‚éƒ½å¯ä»¥ç‹¬ç«‹æ›¿æ¢å’Œä¼˜åŒ–ã€‚</p>
<h2 data-id="heading-10">ä¸‰ã€æœåŠ¡æ³¨å†Œä¸å‘ç°</h2>
<h3 data-id="heading-11">3.1 æœåŠ¡æ³¨å†Œå‘ç°æµç¨‹</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/9718a2344e71428ca918ae8740277ae6~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768544248&amp;x-signature=gs2U0wq2TYMbNmjRdJzivysTYz4%3D" alt="" loading="lazy"/></p>
<p>æœåŠ¡æ³¨å†Œä¸å‘ç°æ˜¯Dubboçš„æ ¸å¿ƒæœºåˆ¶ï¼Œåˆ†ä¸ºä¸¤ä¸ªæµç¨‹ï¼š</p>
<p><strong>Provideræ³¨å†Œæµç¨‹ï¼š</strong></p>
<ol>
<li>ProvideræœåŠ¡å¯åŠ¨</li>
<li>è¿æ¥åˆ°Zookeeperæ³¨å†Œä¸­å¿ƒ</li>
<li>æ³¨å†ŒæœåŠ¡æ¥å£ã€ç‰ˆæœ¬ã€åˆ†ç»„ç­‰ä¿¡æ¯</li>
<li>è®¢é˜…é…ç½®å˜æ›´</li>
<li>æš´éœ²DubboæœåŠ¡ï¼ˆé»˜è®¤20880ç«¯å£ï¼‰</li>
</ol>
<p><strong>Consumerå‘ç°æµç¨‹ï¼š</strong></p>
<ol>
<li>ConsumeræœåŠ¡å¯åŠ¨</li>
<li>è¿æ¥åˆ°Zookeeperæ³¨å†Œä¸­å¿ƒ</li>
<li>è®¢é˜…æ‰€éœ€çš„æœåŠ¡æ¥å£</li>
<li>è·å–Provideråœ°å€åˆ—è¡¨</li>
<li>æ ¹æ®è´Ÿè½½å‡è¡¡ç­–ç•¥è°ƒç”¨Provider</li>
</ol>
<h3 data-id="heading-12">3.2 Zookeeperé…ç½®</h3>
<p>Zookeeperæ˜¯Dubboæœ€å¸¸ç”¨çš„æ³¨å†Œä¸­å¿ƒï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½Zookeeper</span>
wget https://downloads.apache.org/zookeeper/

<span class="hljs-comment"># å¯åŠ¨Zookeeper</span>
bin/zkServer.sh start
</code></pre>
<p><strong>é…ç½®å‚æ•°ï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dubbo:</span>
  <span class="hljs-attr">registry:</span>
    <span class="hljs-attr">address:</span> <span class="hljs-string">zookeeper://127.0.0.1:2181</span>
    <span class="hljs-attr">sessiontimeout:</span> <span class="hljs-number">60000</span>
    <span class="hljs-attr">register:</span> <span class="hljs-literal">true</span>
    <span class="hljs-attr">subscribe:</span> <span class="hljs-literal">true</span>
</code></pre>
<h3 data-id="heading-13">3.3 å…¶ä»–æ³¨å†Œä¸­å¿ƒ</h3>
<p>Dubboè¿˜æ”¯æŒï¼š</p>
<ul>
<li><strong>Nacos</strong>ï¼šé˜¿é‡Œå¼€æºï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ï¼Œæ”¯æŒé…ç½®ç®¡ç†</li>
<li><strong>Redis</strong>ï¼šè½»é‡çº§é€‰æ‹©ï¼Œé€‚åˆå°è§„æ¨¡åº”ç”¨</li>
<li><strong>Consul</strong>ï¼šæ”¯æŒå¥åº·æ£€æŸ¥å’ŒæœåŠ¡ç½‘æ ¼</li>
</ul>
<p><strong>Nacosé…ç½®ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dubbo:</span>
  <span class="hljs-attr">registry:</span>
    <span class="hljs-attr">address:</span> <span class="hljs-string">nacos://127.0.0.1:8848</span>
</code></pre>
<h2 data-id="heading-14">å››ã€è´Ÿè½½å‡è¡¡ç­–ç•¥</h2>
<h3 data-id="heading-15">4.1 è´Ÿè½½å‡è¡¡åŸç†</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a12ae92e4829450081eb203bd6526322~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768544248&amp;x-signature=JkuCIlveyLj3rQbDjdyIz6%2F%2FiXI%3D" alt="" loading="lazy"/></p>
<p>Dubboæä¾›å¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡åœºæ™¯é€‰æ‹©ï¼š</p>








































<table><thead><tr><th>ç­–ç•¥</th><th>è¯´æ˜</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Randomï¼ˆéšæœºï¼‰</td><td>éšæœºé€‰æ‹©Provider</td><td>é»˜è®¤ç­–ç•¥ï¼ŒProvideræ€§èƒ½ç›¸è¿‘</td></tr><tr><td>RoundRobinï¼ˆè½®è¯¢ï¼‰</td><td>æŒ‰é¡ºåºè½®æµè°ƒç”¨</td><td>Provideræ€§èƒ½ç›¸è¿‘ï¼Œè¯·æ±‚å‡åŒ€åˆ†å¸ƒ</td></tr><tr><td>LeastActiveï¼ˆæœ€å°‘æ´»è·ƒï¼‰</td><td>é€‰æ‹©æ´»è·ƒæ•°æœ€å°‘çš„Provider</td><td>Provideræ€§èƒ½å·®å¼‚å¤§</td></tr><tr><td>ConsistentHashï¼ˆä¸€è‡´æ€§å“ˆå¸Œï¼‰</td><td>ç›¸åŒå‚æ•°è·¯ç”±åˆ°åŒä¸€Provider</td><td>æœ‰çŠ¶æ€æœåŠ¡ï¼Œå¦‚ç”¨æˆ·ä¼šè¯</td></tr><tr><td>WeightedRandomï¼ˆåŠ æƒéšæœºï¼‰</td><td>æ ¹æ®æƒé‡éšæœºé€‰æ‹©</td><td>Provideræ€§èƒ½ä¸åŒ</td></tr><tr><td>ShortestResponseï¼ˆæœ€çŸ­å“åº”ï¼‰</td><td>é€‰æ‹©å“åº”æ—¶é—´æœ€çŸ­çš„Provider</td><td>å¯¹æ€§èƒ½è¦æ±‚é«˜</td></tr></tbody></table>
<h3 data-id="heading-16">4.2 é…ç½®ç¤ºä¾‹</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// æœåŠ¡ç«¯é…ç½®</span>
<span class="hljs-variable">@DubboService</span>(loadbalance = <span class="hljs-string">"random"</span>)
public class UserServiceImpl implements UserService {}

<span class="hljs-comment">// å®¢æˆ·ç«¯é…ç½®</span>
<span class="hljs-variable">@DubboReference</span>(loadbalance = <span class="hljs-string">"roundrobin"</span>)
private UserService userService;

# å…¨å±€é…ç½®
<span class="hljs-selector-tag">dubbo</span>:
  <span class="hljs-selector-tag">provider</span>:
    <span class="hljs-selector-tag">loadbalance</span>: <span class="hljs-selector-tag">random</span>
  <span class="hljs-selector-tag">consumer</span>:
    <span class="hljs-selector-tag">loadbalance</span>: <span class="hljs-selector-tag">random</span>
</code></pre>
<h2 data-id="heading-17">äº”ã€é›†ç¾¤å®¹é”™æœºåˆ¶</h2>
<h3 data-id="heading-18">5.1 å®¹é”™ç­–ç•¥</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a54ab60d3de74519baf054c8dd4b6ae4~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768544248&amp;x-signature=R2hgBAhH59SFZmoRWZUhH2xNyII%3D" alt="" loading="lazy"/></p>
<p>Dubboæä¾›6ç§é›†ç¾¤å®¹é”™ç­–ç•¥ï¼Œä¿è¯æœåŠ¡çš„é«˜å¯ç”¨æ€§ï¼š</p>








































<table><thead><tr><th>ç­–ç•¥</th><th>è¯´æ˜</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Failoverï¼ˆå¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼‰</td><td>å¤±è´¥åé‡è¯•å…¶ä»–Provider</td><td>é»˜è®¤ç­–ç•¥ï¼Œå¹‚ç­‰æ“ä½œ</td></tr><tr><td>Failfastï¼ˆå¿«é€Ÿå¤±è´¥ï¼‰</td><td>å¤±è´¥åç«‹å³æŠ¥é”™ï¼Œä¸é‡è¯•</td><td>éå¹‚ç­‰æ“ä½œï¼Œå¦‚å†™æ“ä½œ</td></tr><tr><td>Failsafeï¼ˆå¤±è´¥å®‰å…¨ï¼‰</td><td>å¤±è´¥åå¿½ç•¥ï¼Œä¸æŠ¥é”™</td><td>æ—¥å¿—è®°å½•ã€å®¡è®¡ç­‰éå…³é”®æ“ä½œ</td></tr><tr><td>Failbackï¼ˆå¤±è´¥è‡ªåŠ¨æ¢å¤ï¼‰</td><td>å¤±è´¥ååå°é‡è¯•</td><td>æ¶ˆæ¯é€šçŸ¥ã€å¼‚æ­¥ä»»åŠ¡</td></tr><tr><td>Forkingï¼ˆå¹¶è¡Œè°ƒç”¨ï¼‰</td><td>å¹¶è¡Œè°ƒç”¨å¤šä¸ªProviderï¼Œè¿”å›æˆåŠŸç»“æœ</td><td>å¯¹å®æ—¶æ€§è¦æ±‚é«˜çš„è¯»æ“ä½œ</td></tr><tr><td>Broadcastï¼ˆå¹¿æ’­è°ƒç”¨ï¼‰</td><td>å¹¿æ’­è°ƒç”¨æ‰€æœ‰Provider</td><td>é€šçŸ¥æ‰€æœ‰Provideræ›´æ–°ç¼“å­˜</td></tr></tbody></table>
<h3 data-id="heading-19">5.2 Failoveræµç¨‹è¯¦è§£</h3>
<p>ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°Failoverï¼ˆæœ€å¸¸ç”¨çš„å®¹é”™ç­–ç•¥ï¼‰çš„å·¥ä½œæµç¨‹ï¼š</p>
<ol>
<li>Consumerè°ƒç”¨Provider A</li>
<li>Provider Aå¤±è´¥ï¼ˆè¶…æ—¶/å¼‚å¸¸ï¼‰</li>
<li>è‡ªåŠ¨é‡è¯•Provider Bï¼ˆåŸºäºè´Ÿè½½å‡è¡¡ï¼‰</li>
<li>Provider Bå¤±è´¥</li>
<li>è‡ªåŠ¨é‡è¯•Provider C</li>
<li>Provider CæˆåŠŸï¼Œè¿”å›ç»“æœ</li>
</ol>
<h3 data-id="heading-20">5.3 é…ç½®ç¤ºä¾‹</h3>
<pre><code class="hljs language-less" lang="less"><span class="hljs-comment">// æœåŠ¡ç«¯é…ç½®</span>
<span class="hljs-variable">@DubboService</span>(
    cluster = <span class="hljs-string">"failover"</span>,
    retries = <span class="hljs-number">2</span>  <span class="hljs-comment">// é‡è¯•æ¬¡æ•°</span>
)
public class UserServiceImpl implements UserService {}

<span class="hljs-comment">// å®¢æˆ·ç«¯é…ç½®</span>
<span class="hljs-variable">@DubboReference</span>(
    cluster = <span class="hljs-string">"failfast"</span>,  <span class="hljs-comment">// å¿«é€Ÿå¤±è´¥</span>
    retries = <span class="hljs-number">0</span>            <span class="hljs-comment">// ä¸é‡è¯•</span>
)
private UserService userService;
</code></pre>
<p><strong>é‡è¯•ç­–ç•¥å»ºè®®ï¼š</strong></p>
<ul>
<li>æŸ¥è¯¢æ“ä½œï¼šå¯ä»¥é‡è¯•2-3æ¬¡ï¼ˆFailoverï¼‰</li>
<li>å†™æ“ä½œï¼šå»ºè®®ä¸é‡è¯•ï¼ˆFailfastï¼‰</li>
<li>é‡è¦ä¸šåŠ¡ï¼šè°¨æ…è®¾ç½®é‡è¯•æ¬¡æ•°</li>
</ul>
<h2 data-id="heading-21">å…­ã€å®æˆ˜é¡¹ç›®æ„å»º</h2>
<h3 data-id="heading-22">6.1 å®šä¹‰æœåŠ¡æ¥å£</h3>
<p>dubbo-apiæ¨¡å—å®šä¹‰äº†æ‰€æœ‰æœåŠ¡çš„æ¥å£ï¼Œè¿™æ˜¯Providerå’ŒConsumerä¹‹é—´çš„å¥‘çº¦ã€‚</p>
<p><strong>ç”¨æˆ·æœåŠ¡æ¥å£ï¼š</strong></p>
<pre><code class="hljs language-scss" lang="scss">public interface UserService {
    User <span class="hljs-built_in">getUserById</span>(Long userId);
    Long <span class="hljs-built_in">createUser</span>(User user);
    boolean <span class="hljs-built_in">updateUser</span>(User user);
    boolean <span class="hljs-built_in">deleteUser</span>(Long userId);
    List&lt;User&gt; <span class="hljs-built_in">getAllUsers</span>();
}
</code></pre>
<p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ol>
<li>æœåŠ¡æ¥å£å¿…é¡»ä¿æŒç¨³å®šï¼Œé¿å…é¢‘ç¹ä¿®æ”¹</li>
<li>å‚æ•°å’Œè¿”å›å€¼å¿…é¡»å®ç°Serializableæ¥å£</li>
<li>å»ºè®®ä½¿ç”¨Javaå¯¹è±¡ä½œä¸ºå‚æ•°å’Œè¿”å›å€¼ï¼Œä¾¿äºåºåˆ—åŒ–</li>
</ol>
<h3 data-id="heading-23">6.2 å®ç°æœåŠ¡æä¾›è€…</h3>
<p>ä½¿ç”¨<code>@DubboService</code>æ³¨è§£æš´éœ²æœåŠ¡ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">@DubboService(
    <span class="hljs-attr">version</span> = <span class="hljs-string">"1.0.0"</span>,
    <span class="hljs-attr">group</span> = <span class="hljs-string">"user-service"</span>,
    <span class="hljs-attr">timeout</span> = <span class="hljs-number">5000</span>,
    <span class="hljs-attr">retries</span> = <span class="hljs-number">2</span>,
    <span class="hljs-attr">loadbalance</span> = <span class="hljs-string">"roundrobin"</span>
)
public class UserServiceImpl implements UserService {
    // å®ç°ä»£ç 
}
</code></pre>
<p><strong>æ ¸å¿ƒé…ç½®å‚æ•°è¯´æ˜ï¼š</strong></p>



































<table><thead><tr><th>å‚æ•°</th><th>è¯´æ˜</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td>version</td><td>æœåŠ¡ç‰ˆæœ¬å·</td><td>-</td></tr><tr><td>group</td><td>æœåŠ¡åˆ†ç»„</td><td>-</td></tr><tr><td>timeout</td><td>è¶…æ—¶æ—¶é—´(æ¯«ç§’)</td><td>1000</td></tr><tr><td>retries</td><td>å¤±è´¥é‡è¯•æ¬¡æ•°</td><td>2</td></tr><tr><td>loadbalance</td><td>è´Ÿè½½å‡è¡¡ç­–ç•¥</td><td>random</td></tr></tbody></table>
<h3 data-id="heading-24">6.3 æœåŠ¡æä¾›è€…é…ç½®</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dubbo:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">dubbo-provider</span>
  <span class="hljs-attr">protocol:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">dubbo</span>
    <span class="hljs-attr">port:</span> <span class="hljs-number">20880</span>
    <span class="hljs-attr">serialization:</span> <span class="hljs-string">hessian2</span>
  <span class="hljs-attr">registry:</span>
    <span class="hljs-attr">address:</span> <span class="hljs-string">zookeeper://127.0.0.1:2181</span>
  <span class="hljs-attr">provider:</span>
    <span class="hljs-attr">timeout:</span> <span class="hljs-number">5000</span>
    <span class="hljs-attr">retries:</span> <span class="hljs-number">2</span>
    <span class="hljs-attr">loadbalance:</span> <span class="hljs-string">random</span>
</code></pre>
<h3 data-id="heading-25">6.4 å®ç°æœåŠ¡æ¶ˆè´¹è€…</h3>
<p>ä½¿ç”¨<code>@DubboReference</code>æ³¨è§£å¼•ç”¨è¿œç¨‹æœåŠ¡ï¼š</p>
<pre><code class="hljs language-less" lang="less"><span class="hljs-variable">@RestController</span>
<span class="hljs-variable">@RequestMapping</span>(<span class="hljs-string">"/api/users"</span>)
public class UserController {

    <span class="hljs-variable">@DubboReference</span>(
        version = <span class="hljs-string">"1.0.0"</span>,
        group = <span class="hljs-string">"user-service"</span>,
        check = false
    )
    private UserService userService;

    <span class="hljs-variable">@GetMapping</span>(<span class="hljs-string">"/{id}"</span>)
    public String <span class="hljs-built_in">getUserById</span>(<span class="hljs-variable">@PathVariable</span> Long id) {
        <span class="hljs-selector-tag">User</span> <span class="hljs-selector-tag">user</span> = <span class="hljs-selector-tag">userService</span><span class="hljs-selector-class">.getUserById</span>(id);
        <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">user</span> != <span class="hljs-selector-tag">null</span> ? <span class="hljs-selector-tag">user</span><span class="hljs-selector-class">.toString</span>() : "ç”¨æˆ·ä¸å­˜åœ¨";
    }
}
</code></pre>
<h3 data-id="heading-26">6.5 æœåŠ¡æ¶ˆè´¹è€…é…ç½®</h3>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-attr">dubbo:</span>
  <span class="hljs-attr">application:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">dubbo-consumer</span>
  <span class="hljs-attr">registry:</span>
    <span class="hljs-attr">address:</span> <span class="hljs-string">zookeeper://127.0.0.1:2181</span>
  <span class="hljs-attr">consumer:</span>
    <span class="hljs-attr">timeout:</span> <span class="hljs-number">5000</span>
    <span class="hljs-attr">retries:</span> <span class="hljs-number">2</span>
    <span class="hljs-attr">check:</span> <span class="hljs-literal">false</span>
</code></pre>
<h2 data-id="heading-27">ä¸ƒã€æœåŠ¡é—´è°ƒç”¨</h2>
<h3 data-id="heading-28">7.1 æœåŠ¡é—´é€šä¿¡ç¤ºä¾‹</h3>
<p>åœ¨è®¢å•æœåŠ¡ä¸­è°ƒç”¨ç”¨æˆ·æœåŠ¡ï¼š</p>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@DubboService</span>
public class OrderServiceImpl implements OrderService {

    <span class="hljs-keyword">@DubboReference</span>
    private UserService userService;

    public Long <span class="hljs-built_in">createOrder</span>(Order order) {
        <span class="hljs-comment">// 1. éªŒè¯ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span>
        User user = userService<span class="hljs-selector-class">.getUserById</span>(order.getUserId());
        if (user == null) {
            throw new <span class="hljs-built_in">RuntimeException</span>("ç”¨æˆ·ä¸å­˜åœ¨");
        }

        <span class="hljs-comment">// 2. åˆ›å»ºè®¢å•</span>
        <span class="hljs-attribute">order</span><span class="hljs-selector-class">.setId</span>(ID_GENERATOR.getAndIncrement());
        ORDER_DATABASE<span class="hljs-selector-class">.put</span>(order.getId(), <span class="hljs-attribute">order</span>);

        return <span class="hljs-attribute">order</span><span class="hljs-selector-class">.getId</span>();
    }
}
</code></pre>
<p><strong>ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹ï¼š</strong></p>
<ol>
<li>æœåŠ¡é—´è°ƒç”¨è¦è®¾ç½®åˆç†çš„è¶…æ—¶æ—¶é—´</li>
<li>è€ƒè™‘ç†”æ–­æœºåˆ¶ï¼Œé˜²æ­¢é›ªå´©æ•ˆåº”</li>
<li>é‡è¦ä¸šåŠ¡é€»è¾‘è¦è®°å½•æ—¥å¿—</li>
<li>ä½¿ç”¨åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿç›‘æ§è°ƒç”¨é“¾</li>
</ol>
<h2 data-id="heading-29">å…«ã€ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²</h2>
<h3 data-id="heading-30">8.1 å¾®æœåŠ¡éƒ¨ç½²æ¶æ„</h3>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0db13f1817aa4ab5b36dbd21c22d303b~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6Zuo5Lit6aOY6I2h55qE6K6w5b-G:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768544248&amp;x-signature=IVGmg9xj%2FlorA%2BFetz1eEB4SO4s%3D" alt="" loading="lazy"/></p>
<p>ç”Ÿäº§ç¯å¢ƒé€šå¸¸é‡‡ç”¨å¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå®¹ç¾èƒ½åŠ›ï¼š</p>
<p><strong>åŒ—äº¬æ•°æ®ä¸­å¿ƒï¼ˆData Center 1ï¼‰ï¼š</strong></p>
<ul>
<li>3ä¸ªProviderå®ä¾‹ï¼ˆ192.168.1.101-103ï¼‰</li>
<li>2ä¸ªConsumerå®ä¾‹ï¼ˆ192.168.1.201-202ï¼‰</li>
<li>3èŠ‚ç‚¹Zookeeperé›†ç¾¤</li>
</ul>
<p><strong>ä¸Šæµ·æ•°æ®ä¸­å¿ƒï¼ˆData Center 2ï¼‰ï¼š</strong></p>
<ul>
<li>2ä¸ªProviderå®ä¾‹ï¼ˆ192.168.2.101-102ï¼‰</li>
<li>2ä¸ªConsumerå®ä¾‹ï¼ˆ192.168.2.201-202ï¼‰</li>
<li>MySQLä¸»ä»é›†ç¾¤ã€Redisé›†ç¾¤</li>
</ul>
<p><strong>è·¨æ•°æ®ä¸­å¿ƒè¿æ¥ï¼š</strong></p>
<ul>
<li>é€šè¿‡VPNæˆ–ä¸“çº¿è¿æ¥</li>
<li>å®ç°å¼‚åœ°å¤šæ´»å’Œå®¹ç¾</li>
</ul>
<h3 data-id="heading-31">8.2 é«˜å¯ç”¨éƒ¨ç½²</h3>
<p><strong>æ³¨å†Œä¸­å¿ƒé›†ç¾¤ï¼š</strong></p>
<ul>
<li>Zookeeperè‡³å°‘3ä¸ªèŠ‚ç‚¹ï¼ˆå¥‡æ•°ä¸ªï¼‰</li>
<li>Nacosé›†ç¾¤æ¨¡å¼éƒ¨ç½²</li>
</ul>
<p><strong>æœåŠ¡éƒ¨ç½²ï¼š</strong></p>
<ul>
<li>Providerè‡³å°‘éƒ¨ç½²2ä¸ªå®ä¾‹</li>
<li>ä½¿ç”¨Dockerå®¹å™¨åŒ–éƒ¨ç½²</li>
</ul>
<p><strong>æ•°æ®åº“ï¼š</strong></p>
<ul>
<li>MySQLä¸»ä»å¤åˆ¶</li>
<li>Redis Clusteré›†ç¾¤</li>
</ul>
<h3 data-id="heading-32">8.3 é…ç½®ä¸­å¿ƒ</h3>
<p>ç”Ÿäº§ç¯å¢ƒå»ºè®®å¼•å…¥é…ç½®ä¸­å¿ƒï¼ˆå¦‚Nacosã€Apolloï¼‰ï¼š</p>
<pre><code class="hljs language-yaml" lang="yaml"><span class="hljs-comment"># ä»é…ç½®ä¸­å¿ƒè¯»å–</span>
<span class="hljs-attr">dubbo:</span>
  <span class="hljs-attr">registry:</span>
    <span class="hljs-attr">address:</span> <span class="hljs-string">${dubbo.registry.address:zookeeper://127.0.0.1:2181}</span>
  <span class="hljs-attr">protocol:</span>
    <span class="hljs-attr">port:</span> <span class="hljs-string">${dubbo.protocol.port:20880}</span>
</code></pre>
<h2 data-id="heading-33">ä¹ã€é«˜çº§ç‰¹æ€§</h2>
<h3 data-id="heading-34">9.1 å¼‚æ­¥è°ƒç”¨</h3>
<pre><code class="hljs language-typescript" lang="typescript"><span class="hljs-meta">@DubboReference</span>(<span class="hljs-keyword">async</span> = <span class="hljs-literal">true</span>)
<span class="hljs-keyword">private</span> <span class="hljs-title class_">UserService</span> userService;

<span class="hljs-keyword">public</span> <span class="hljs-title class_">CompletableFuture</span>&lt;<span class="hljs-title class_">User</span>&gt; <span class="hljs-title function_">getUserAsync</span>(<span class="hljs-params">Long id</span>) {
    <span class="hljs-keyword">return</span> userService.<span class="hljs-title function_">getUserById</span>(id);
}
</code></pre>
<h3 data-id="heading-35">9.2 æ³›åŒ–è°ƒç”¨</h3>
<p>æ— éœ€ä¾èµ–æ¥å£JARåŒ…å³å¯è°ƒç”¨ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">GenericService <span class="hljs-attr">genericService</span> = (GenericService) context.getBean(<span class="hljs-string">"genericService"</span>)<span class="hljs-comment">;</span>

Object <span class="hljs-attr">result</span> = genericService.<span class="hljs-variable">$invoke</span>(
    "getUserById",
    new String<span class="hljs-section">[]</span>{"java.lang.Long"},
    new Object<span class="hljs-section">[]</span>{1L}
)<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-36">9.3 æœåŠ¡é™çº§</h3>
<p>é€šè¿‡Mockå®ç°æœåŠ¡é™çº§ï¼š</p>
<pre><code class="hljs language-ini" lang="ini">@DubboReference(<span class="hljs-attr">mock</span> = <span class="hljs-string">"com.dubbo.demo.mock.UserServiceMock"</span>)
private UserService userService<span class="hljs-comment">;</span>
</code></pre>
<h3 data-id="heading-37">9.4 ç»“æœç¼“å­˜</h3>
<pre><code class="hljs language-ini" lang="ini">@DubboReference(<span class="hljs-attr">cache</span> = <span class="hljs-string">"lru"</span>)
private UserService userService<span class="hljs-comment">;</span>
</code></pre>
<p><strong>ç¼“å­˜ç­–ç•¥ï¼š</strong></p>
<ul>
<li><code>lru</code>ï¼šæœ€è¿‘æœ€å°‘ä½¿ç”¨</li>
<li><code>threadlocal</code>ï¼šçº¿ç¨‹ç¼“å­˜</li>
<li><code>jcache</code>ï¼šä¸JSR107é›†æˆ</li>
</ul>
<h2 data-id="heading-38">åã€ç›‘æ§ä¸è¿ç»´</h2>
<h3 data-id="heading-39">10.1 Dubbo Admin</h3>
<p>Dubbo Adminæ˜¯å®˜æ–¹æä¾›çš„ç®¡ç†æ§åˆ¶å°ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¸‹è½½å¹¶å¯åŠ¨</span>
git <span class="hljs-built_in">clone</span> https://github.com/apache/dubbo-admin
mvn clean package
java -jar dubbo-admin-server/target/dubbo-admin-server-0.1.0.jar
</code></pre>
<p><strong>åŠŸèƒ½ç‰¹æ€§ï¼š</strong></p>
<ul>
<li>æœåŠ¡æŸ¥è¯¢</li>
<li>æœåŠ¡è¯¦æƒ…</li>
<li>è·¯ç”±è§„åˆ™é…ç½®</li>
<li>åŠ¨æ€é…ç½®</li>
<li>æœåŠ¡æµ‹è¯•</li>
</ul>
<h3 data-id="heading-40">10.2 æ—¥å¿—ç›‘æ§</h3>
<pre><code class="hljs language-ini" lang="ini">&lt;logger <span class="hljs-attr">name</span>=<span class="hljs-string">"org.apache.dubbo"</span> level=<span class="hljs-string">"INFO"</span>/&gt;
&lt;logger <span class="hljs-attr">name</span>=<span class="hljs-string">"com.dubbo.demo"</span> level=<span class="hljs-string">"DEBUG"</span>/&gt;
</code></pre>
<h3 data-id="heading-41">10.3 é“¾è·¯è¿½è¸ª</h3>
<p>é›†æˆSkyWalkingå®ç°åˆ†å¸ƒå¼è¿½è¸ªï¼š</p>
<pre><code class="hljs language-xml" lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.skywalking<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>apm-toolkit-trace<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>8.16.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h2 data-id="heading-42">åä¸€ã€æ€»ç»“</h2>
<p>Dubboä½œä¸ºæˆç†Ÿçš„RPCæ¡†æ¶ï¼Œåœ¨ä¼ä¸šçº§å¾®æœåŠ¡æ¶æ„ä¸­å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[é«˜å¹¶å‘ä¸åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¹‚ç­‰å¤„ç†]]></title>    <link>https://juejin.cn/post/7593139476840448006</link>    <guid>https://juejin.cn/post/7593139476840448006</guid>    <pubDate>2026-01-09T09:26:34.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593139476840448006" data-draft-id="7593139476840185862" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="é«˜å¹¶å‘ä¸åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¹‚ç­‰å¤„ç†"/> <meta itemprop="keywords" content="æ¶æ„"/> <meta itemprop="datePublished" content="2026-01-09T09:26:34.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç‹¼çˆ·"/> <meta itemprop="url" content="https://juejin.cn/user/2418581314208279"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            é«˜å¹¶å‘ä¸åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¹‚ç­‰å¤„ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2418581314208279/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç‹¼çˆ·
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T09:26:34.000Z" title="Fri Jan 09 2026 09:26:34 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    16
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»23åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:14px;overflow-x:hidden;color:var(--cyanosis-base-color);transition:color .35s;--cyanosis-base-color:#353535;--cyanosis-title-color:#005bb7;--cyanosis-strong-color:#2196f3;--cyanosis-em-color:#4fc3f7;--cyanosis-del-color:#ccc;--cyanosis-link-color:#3da8f5;--cyanosis-linkh-color:#007fff;--cyanosis-border-color:#bedcff;--cyanosis-border-color-2:#ececec;--cyanosis-bg-color:#fff;--cyanosis-blockquote-color:#8c8c8c;--cyanosis-blockquote-bg-color:#f0fdff;--cyanosis-code-color:#c2185b;--cyanosis-code-bg-color:#fff4f4;--cyanosis-code-pre-color:#f8f8f8;--cyanosis-table-border-color:#c3e0fd;--cyanosis-table-th-color:#dff0ff;--cyanosis-table-tht-color:#005bb7;--cyanosis-table-tr-nc-color:#f7fbff;--cyanosis-table-trh-color:#e0edf7;--cyanosis-slct-title-color:#005bb7;--cyanosis-slct-titlebg-color:rgba(175,207,247,0.25);--cyanosis-slct-text-color:#c80000;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#e8ebec;--cyanosis-slct-codebg-color:#ffeaeb;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body.__dark{--cyanosis-base-color:#cacaca;--cyanosis-title-color:#ddd;--cyanosis-strong-color:#fe9900;--cyanosis-em-color:#ffd28e;--cyanosis-del-color:#ccc;--cyanosis-link-color:#ffb648;--cyanosis-linkh-color:#fe9900;--cyanosis-border-color:#ffe3ba;--cyanosis-border-color-2:#ffcb7b;--cyanosis-bg-color:#2f2f2f;--cyanosis-blockquote-color:#c7c7c7;--cyanosis-blockquote-bg-color:rgba(255,199,116,0.1);--cyanosis-code-color:#000;--cyanosis-code-bg-color:#ffcb7b;--cyanosis-code-pre-color:rgba(255,227,185,0.5);--cyanosis-table-border-color:#fe9900;--cyanosis-table-th-color:#ffb648;--cyanosis-table-tht-color:#000;--cyanosis-table-tr-nc-color:#6d5736;--cyanosis-table-trh-color:#947443;--cyanosis-slct-title-color:#000;--cyanosis-slct-titlebg-color:#fe9900;--cyanosis-slct-text-color:#00c888;--cyanosis-slct-bg-color:rgba(175,207,247,0.25);--cyanosis-slct-del-color:#999;--cyanosis-slct-elbg-color:#000;--cyanosis-slct-codebg-color:#ffcb7b;--cyanosis-slct-prebg-color:rgba(160,200,255,0.25)}.markdown-body h1{padding-bottom:4px;font-size:30px}.markdown-body h1,.markdown-body h2{margin-top:36px;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);transition:color .35s}.markdown-body h2{position:relative;padding-left:10px;padding-right:10px;padding-bottom:10px;font-size:24px;border-bottom:1px solid var(--cyanosis-border-color-2)}.markdown-body h2:before{content:"ã€Œ";position:absolute;top:-6px;left:-14px}.markdown-body h2:after{content:"ã€";position:relative;top:6px;right:auto}.markdown-body h3{position:relative;padding-bottom:0;margin-top:30px;margin-bottom:10px;font-size:20px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h3:before{content:"Â»";padding-right:6px;color:var(--cyanosis-strong-color)}.markdown-body h4{margin-top:24px;font-size:16px}.markdown-body h4,.markdown-body h5{padding-bottom:0;margin-bottom:10px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body h5{margin-top:18px;font-size:14px}.markdown-body h6{padding-bottom:0;margin-top:12px;margin-bottom:10px;font-size:12px;line-height:1.5;color:var(--cyanosis-title-color);padding-left:6px;transition:color .35s}.markdown-body p{line-height:inherit;margin-top:16px;margin-bottom:16px}.markdown-body img{max-width:100%}.markdown-body hr{position:relative;width:98%;height:1px;margin-top:32px;margin-bottom:32px;background-image:linear-gradient(90deg,var(--cyanosis-link-color),rgba(255,0,0,.3),hsla(0,0%,100%,.1),rgba(255,0,0,.3),var(--cyanosis-link-color));border-width:0;overflow:visible}.markdown-body hr:after{content:"";position:absolute;margin:auto;left:0;right:0;bottom:0;top:0;display:inline-block;width:60px;height:20px;background-color:var(--cyanosis-bg-color);background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAgCAYAAABgrToAAAADoklEQVRYR82XTYgcRRTHf2933Q1RjAa9eFO8JHoJ8RQVBQ2iBwXBET0YEUTXNVmNQtTpmeqaWV0XNRq/o4KoECSCEPSg4CF+BYUkIIiCoCJCPIhC/Ihh2Z0nVV27VnZnenumW9i6ddV7//frV69fVQurfMgq56NawFTPAU6QyomqXrw6wIZeyhCPebA5buNR+akKyGoAjd6BshthnYdSjqNcRVuOlIUsD2j0SuA94IwuMHdh5ZUykOUBXfSGbmKI54EtAeYIHSZoy5dl4JxvNYBOKdW1KE8BQ8AkVk6WhasWsAiN0TX9gveXQaPP+Aytpc4u+bMI06JNohsYYYYOR2lJWtS3OKDRfcAtQfgDoI6Vo4UCGb0OmAEuDvZvYmVbEd/igC3dzDz7gQu8sPA9kJDK27mBmjqBeLjTg90PDFOjWawFFQd06kZHEfaj3LAIpTRpSXsZ5E06zEYP9sDimnAApYaV2SLZG/wjMeqAkijwW4xQJ5Gf/ZzRC8OW3hiBTGGlURRswW55Bh/Ssxljrwew8l1PQaM14GngvGDzBUKdDsMeTtgU5o8B92PFlUf3YXUrHa7Fys6lBqcCGnX15YQ2A18FyPd7Crd1A3M8C1wdbH4DD3hWeP6IEXbQkG97ajR1HPFnuPP5jFFq1OWX7hl8WM9l1AO648uNfwLk7tytMeogty+xeQ4rO3r6bdcx1nuwOGsHmaXGtPzae4uzGnLH1kQkvpdZGrHjssBZJrL+pqS05KWc8tgITAPXRzYvYOXe/C2OV43eDcRBDtIhoS2f9wzc0Cv8Wls+zoFzUC5zF0U241h5uZtPfptp6OUM8wbK+cH5GEpCS17P3fJei0Z3+npTxryJ8CPzbKMtn/ZyWbkPGl0PuFPkmkjkcb4h4R2ZLwRq1H0ALmvjkf2HwK1Y+T1PY2XABe/sHJ6MxN5lnoSpnC/UGbsTaI5phK2R7x6s3Ffk5YoDOrWm3onwJHBmEP86bPmBrsGaenNoIdnxCH+gPEhLXi0Cl1VBvyPVLSh7gEuC62yAfOIUqabWEaaiucMIk6RyqJ+Q/QM69V26jjW86Gvov/EaoyT8zRCn+Xq7PVrbx0nuYUaO9wM3WAbjCE1NEUw09Um4UV+2OKfYfu5/S19gsAzGKqm6LE5FrShbdS0ku465DjDwKA/oQht19ejqbaEVuRbiLhuHByYLjtUAZpDutzP7cYdHsPJXWbjyNVgFwQoa1WXwf4Jd9YD/Ap80+yE7+u9aAAAAAElFTkSuQmCC);background-repeat:no-repeat;background-size:auto 100%;background-position-x:center;transition:background-color .5s}.markdown-body code{padding:.065em .4em;font-size:.87em;color:var(--cyanosis-code-color);word-break:break-word;overflow-x:auto;background-color:var(--cyanosis-code-bg-color);border-radius:2px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{display:block;padding:16px 12px;margin:0;font-size:12px;color:#333;word-break:normal;overflow-x:auto;background:var(--cyanosis-code-pre-color)}.markdown-body pre&gt;code::-webkit-scrollbar{width:4px;height:4px}.markdown-body pre&gt;code::-webkit-scrollbar-track{background-color:var(--cyanosis-border-color)}.markdown-body pre&gt;code::-webkit-scrollbar-thumb{background-color:var(--cyanosis-strong-color);border-radius:10px}.markdown-body a{position:relative;text-decoration:none;color:var(--cyanosis-link-color);border-bottom:1px solid var(--cyanosis-border-color)}.markdown-body a:hover{border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body a:active,.markdown-body a:hover{color:var(--cyanosis-linkh-color)}.markdown-body a:after{position:absolute;content:"";top:100%;left:0;width:100%;opacity:0;border-bottom:1px solid var(--cyanosis-border-color);transition:top .3s,opacity .3s;transform:translateZ(0)}.markdown-body a:hover:after{top:0;opacity:1;border-bottom-color:var(--cyanosis-linkh-color)}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid var(--cyanosis-table-border-color);border-spacing:0;border-collapse:collapse}.markdown-body table thead{color:#000;text-align:left;font-size:14px;background:#f6f6f6}.markdown-body table tr:nth-child(2n){background-color:var(--cyanosis-table-tr-nc-color)}.markdown-body table tr:hover{background-color:var(--cyanosis-table-trh-color)}.markdown-body table td,.markdown-body table th{padding:12px 8px;line-height:24px;border:1px solid var(--cyanosis-table-border-color)}.markdown-body table th{color:var(--cyanosis-table-tht-color);background-color:var(--cyanosis-table-th-color)}.markdown-body table td{min-width:120px}.markdown-body blockquote{color:var(--cyanosis-blockquote-color);border-left:4px solid var(--cyanosis-strong-color);background-color:var(--cyanosis-blockquote-bg-color);padding:1px 20px;margin:22px 0;transition:color .35s}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body b,.markdown-body blockquote&gt;b,.markdown-body blockquote&gt;strong,.markdown-body strong{color:var(--cyanosis-strong-color)}.markdown-body em,.markdown-body i{color:var(--cyanosis-em-color)}.markdown-body del{color:var(--cyanosis-del-color)}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:4px}.markdown-body ol li{padding-left:6px}.markdown-body details&gt;summary{outline:none;color:var(--cyanosis-title-color);font-size:20px;font-weight:bolder;border-bottom:1px solid var(--cyanosis-border-color);cursor:pointer}.markdown-body details&gt;p{padding:10px 20px;margin:10px 0 0;color:#666;background-color:var(--cyanosis-blockquote-bg-color);border:2px dashed var(--cyanosis-strong-color)}.markdown-body h1::selection,.markdown-body h2::selection,.markdown-body h3::selection,.markdown-body h4::selection,.markdown-body h5::selection,.markdown-body h6::selection{color:var(--cyanosis-slct-title-color);background-color:var(--cyanosis-slct-titlebg-color)}.markdown-body ol li::selection,.markdown-body p::selection,.markdown-body ul li::selection{color:var(--cyanosis-slct-text-color);background-color:var(--cyanosis-slct-bg-color)}.markdown-body a::selection,.markdown-body b::selection,.markdown-body em::selection,.markdown-body i::selection,.markdown-body strong::selection{background-color:var(--cyanosis-slct-elbg-color)}.markdown-body del::selection{color:var(--cyanosis-slct-del-color);background-color:var(--cyanosis-slct-elbg-color)}.markdown-body table thead th::selection{background-color:transparent}.markdown-body table tbody td::selection{background-color:var(--cyanosis-slct-bg-color)}.markdown-body code::selection{background-color:var(--cyanosis-slct-codebg-color)}.markdown-body pre&gt;code::selection{background-color:var(--cyanosis-slct-prebg-color)}.markdown-body .contains-task-list{padding-left:14px;list-style:none}.markdown-body .contains-task-list input[type=checkbox]{position:relative}.markdown-body .contains-task-list input[type=checkbox]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;width:inherit;height:inherit;background:#f0f8ff;border:1px solid #add6ff;border-radius:2px;box-sizing:border-box;z-index:1}.markdown-body .contains-task-list input[type=checkbox]:checked:after{content:"âœ“";position:absolute;top:-12px;left:0;right:0;bottom:0;width:0;height:0;color:#f55;font-size:20px;font-weight:700;z-index:2}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="srcery">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#1c1b19;color:#fce8c3}.hljs-emphasis,.hljs-strong{color:#918175}.hljs-bullet,.hljs-link,.hljs-literal,.hljs-number,.hljs-quote,.hljs-regexp{color:#ff5c8f}.hljs-code,.hljs-selector-class{color:#68a8e4}.hljs-emphasis{font-style:italic}.hljs-attribute,.hljs-keyword,.hljs-section,.hljs-selector-tag,.hljs-variable{color:#ef2f27}.hljs-name,.hljs-title{color:#fbb829}.hljs-params,.hljs-type{color:#0aaeb3}.hljs-string{color:#98bc37}.hljs-addition,.hljs-built_in,.hljs-builtin-name,.hljs-selector-attr,.hljs-selector-id,.hljs-selector-pseudo,.hljs-subst,.hljs-symbol,.hljs-template-tag,.hljs-template-variable{color:#c07abe}.hljs-comment,.hljs-deletion,.hljs-meta{color:#918175}</style><h2 data-id="heading-0">ä¸€ã€ä¸ºä»€ä¹ˆé«˜å¹¶å‘ç³»ç»Ÿä¸€å®šä¼šâ€œè¢«å¹‚ç­‰æ•™è‚²â€ï¼Ÿ</h2>
<p>å…ˆè¯´ä¸€å¥å¯èƒ½ä¸å¤ªå¥½å¬çš„å¤§å®è¯ï¼š</p>
<blockquote>
<p><strong>ç»å¤§å¤šæ•°é«˜å¹¶å‘äº‹æ•…ï¼Œä¸æ˜¯ä»£ç å†™é”™ï¼Œè€Œæ˜¯è¯·æ±‚è¢«æ‰§è¡Œäº†ä¸æ­¢ä¸€æ¬¡ã€‚</strong></p>
</blockquote>
<p>å¾ˆå¤šæ–°æ‰‹å·¥ç¨‹å¸ˆåœ¨æœ¬åœ°æµ‹è¯•æ—¶ï¼Œæ¥å£é€»è¾‘è·‘å¾—é¡ºé£é¡ºæ°´ï¼Œä½†ä¸€ä¸Šç”Ÿäº§ç¯å¢ƒï¼Œå°±å®¹æ˜“æ ½åœ¨â€œé‡å¤è¯·æ±‚â€è¿™ä¸ªå‘é‡Œã€‚ä¸æ˜¯ä»£ç é€»è¾‘æœ‰é—®é¢˜ï¼Œè€Œæ˜¯çœŸå®çš„çº¿ä¸Šç¯å¢ƒï¼Œæ ¹æœ¬ä¸å­˜åœ¨â€œè¯·æ±‚åªæ¥ä¸€æ¬¡â€çš„ç†æƒ³çŠ¶æ€ã€‚</p>
<p>ä½ ä¸€å®šä¼šé‡åˆ°è¿™äº›æ— æ³•é¿å…çš„åœºæ™¯ï¼š</p>
<ul>
<li>
<p><strong>ç½‘ç»œæŠ–åŠ¨</strong>ï¼šå®¢æˆ·ç«¯å‘å®Œè¯·æ±‚åï¼Œå› ç½‘ç»œå»¶è¿Ÿæ²¡åŠæ—¶æ”¶åˆ°å“åº”ï¼Œè¯¯ä»¥ä¸ºè¯·æ±‚å¤±è´¥</p>
</li>
<li>
<p><strong>å®¢æˆ·ç«¯é‡è¯•</strong>ï¼šå‰ç«¯æŒ‰é’®é‡å¤ç‚¹å‡»ã€APP ç¦»çº¿é‡è¿åé‡è¯•ã€ç¬¬ä¸‰æ–¹è°ƒç”¨æ–¹é…ç½®äº†è‡ªåŠ¨é‡è¯•</p>
</li>
<li>
<p><strong>ç½‘å…³é‡å‘</strong>ï¼šAPI ç½‘å…³å› è¶…æ—¶ç­‰åŸå› ï¼Œä¸»åŠ¨é‡å‘è¯·æ±‚åˆ°åç«¯æœåŠ¡</p>
</li>
<li>
<p><strong>MQ è‡³å°‘ä¸€æ¬¡æŠ•é€’</strong>ï¼šä¸ºä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼ŒKafkaã€RocketMQ ç­‰æ¶ˆæ¯ä¸­é—´ä»¶é»˜è®¤éƒ½æ˜¯â€œè‡³å°‘ä¸€æ¬¡â€æŠ•é€’ç­–ç•¥ï¼Œæ¶ˆæ¯å¿…ç„¶å¯èƒ½é‡å¤</p>
</li>
</ul>
<p>ç”¨ä¸€æ®µçœŸå®çš„äº¤äº’åœºæ™¯ï¼Œå°±èƒ½æ˜ç™½è¿™ç§æ— å¥ˆï¼š</p>
<pre><code class="hljs language-text" lang="text">å®¢æˆ·ç«¯ï¼šæˆ‘åˆšåˆšæ˜¯ä¸æ˜¯æ²¡æˆåŠŸï¼Ÿï¼ˆå› ç½‘ç»œå»¶è¿Ÿæ²¡æ”¶åˆ°å“åº”ï¼‰
ç³»ç»Ÿï¼šæˆåŠŸäº†ã€‚ï¼ˆå…¶å®å·²ç»å¤„ç†å®Œå¹¶è¿”å›ï¼Œä½†å“åº”ä¸¢äº†ï¼‰
å®¢æˆ·ç«¯ï¼šé‚£æˆ‘å†æ¥ä¸€æ¬¡ã€‚ï¼ˆè§¦å‘é‡è¯•æœºåˆ¶ï¼‰
ç³»ç»Ÿï¼šï¼Ÿï¼Ÿï¼Ÿï¼ˆæˆ‘åˆ°åº•è¯¥å†å¤„ç†ä¸€æ¬¡è¿˜æ˜¯ç›´æ¥è¿”å›ï¼Ÿï¼‰
</code></pre>
<p>ç»“è®ºå…ˆè¡Œï¼Œè®°æ­»è¿™å¥è¯ï¼š</p>
<blockquote>
<p><strong>åœ¨é«˜å¹¶å‘ + åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œè¯·æ±‚â€œåªæ¥ä¸€æ¬¡â€æ˜¯å¥¢æœ›ï¼Œâ€œé‡å¤è¯·æ±‚â€æ‰æ˜¯å¸¸æ€ã€‚</strong></p>
</blockquote>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‰€æœ‰æˆç†Ÿçš„é«˜å¹¶å‘ç³»ç»Ÿï¼Œéƒ½å¿…é¡»è¿‡â€œå¹‚ç­‰â€è¿™ä¸€å…³â€”â€”ä¸æ˜¯ä½ æƒ³åšï¼Œè€Œæ˜¯ç¯å¢ƒé€¼ç€ä½ å¿…é¡»åšã€‚</p>
<hr/>
<h2 data-id="heading-1">äºŒã€ä»€ä¹ˆæ˜¯å¹‚ç­‰ï¼Ÿï¼ˆå·¥ç¨‹å¸ˆç‰ˆæœ¬ï¼Œæ‹’ç»åºŸè¯ï¼‰</h2>
<p>åˆ«å»èƒŒæ•™ç§‘ä¹¦ä¸Šçš„æŠ½è±¡å®šä¹‰ï¼Œè®°ä½è¿™ä¸€å¥äººè¯å°±å¤Ÿäº†ï¼š</p>
<blockquote>
<p><strong>åŒä¸€ä¸ªè¯·æ±‚ï¼Œä¸ç®¡æ¥å¤šå°‘æ¬¡ï¼Œç³»ç»Ÿæœ€ç»ˆçš„çŠ¶æ€å’Œç»“æœéƒ½å®Œå…¨ä¸€æ ·ã€‚</strong></p>
</blockquote>
<p>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šæŸ¥è¯¢æ¥å£ï¼ˆGET /api/order?orderNo=123ï¼‰å¤©ç”Ÿå°±æ˜¯å¹‚ç­‰çš„ï¼Œä¸ç®¡ä½ è°ƒç”¨1æ¬¡è¿˜æ˜¯100æ¬¡ï¼Œè¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªè®¢å•ä¿¡æ¯ï¼›ä½†ä¸‹å•æ¥å£ï¼ˆPOST /api/order/createï¼‰å¦‚æœä¸åšå¤„ç†ï¼Œè°ƒç”¨2æ¬¡å°±ä¼šç”Ÿæˆ2ä¸ªè®¢å•ï¼Œè¿™å°±æ˜¯éå¹‚ç­‰çš„ã€‚</p>
<h3 data-id="heading-2">ä¸åšå¹‚ç­‰ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼ˆçœŸå®äº‹æ•…æ¡ˆä¾‹ï¼‰</h3>
<p>å¾ˆå¤šäººè§‰å¾—â€œå¹‚ç­‰æ˜¯é«˜çº§ä¼˜åŒ–â€ï¼Œç›´åˆ°è¸©äº†å‘æ‰æ˜ç™½è¿™æ˜¯â€œåŸºç¡€å¿…å¤‡â€ã€‚éå¹‚ç­‰æ¥å£åœ¨é«˜å¹¶å‘ä¸‹ï¼Œå¿…ç„¶ä¼šå‡ºç°è¿™äº›è‡´å‘½é—®é¢˜ï¼š</p>
<ul>
<li>
<p><strong>é‡å¤ä¸‹å•</strong>ï¼šç”¨æˆ·ç‚¹å‡»â€œæäº¤è®¢å•â€åå› ç½‘ç»œå¡é¡¿æ—¶é‡å¤ç‚¹å‡»ï¼Œç”Ÿæˆå¤šç¬”è®¢å•ï¼Œå¯¼è‡´åº“å­˜è¢«å¤šæ‰£ã€ç”¨æˆ·æ”¶åˆ°å¤šä¸ªå‘è´§é€šçŸ¥</p>
</li>
<li>
<p><strong>é‡å¤æ‰£æ¬¾</strong>ï¼šæ”¯ä»˜æ¥å£é‡è¯•å¯¼è‡´ç”¨æˆ·è´¦æˆ·è¢«å¤šæ¬¡æ‰£æ¬¾ï¼Œç›´æ¥å¼•å‘ç”¨æˆ·æŠ•è¯‰ï¼Œç”šè‡³ç›‘ç®¡ä»‹å…¥</p>
</li>
<li>
<p><strong>MQ é‡å¤æ¶ˆè´¹</strong>ï¼šæ¶ˆæ¯é‡å¤æŠ•é€’åè¢«é‡å¤å¤„ç†ï¼Œå¯¼è‡´åº“å­˜æ‰£ä¸ºè´Ÿæ•°ã€ä¼˜æƒ åˆ¸è¢«é‡å¤æ ¸é”€</p>
</li>
<li>
<p><strong>é‡å¤é€€æ¬¾</strong>ï¼šé€€æ¬¾æ¥å£è¢«é‡è¯•ï¼Œç”¨æˆ·æ”¶åˆ°å¤šç¬”é€€æ¬¾ï¼Œä¼ä¸šç›´æ¥äº§ç”Ÿèµ„é‡‘æŸå¤±</p>
</li>
</ul>
<p>è¿™é‡Œæœ‰ä¸ªåˆ¤æ–­æ ‡å‡†ï¼Œè®°ä¸‹æ¥ç›´æ¥ç”¨ï¼š</p>
<blockquote>
<p><strong>åªè¦â€œåŒä¸€ä¸ªè¯·æ±‚å¤šæ‰§è¡Œä¸€æ¬¡ä¼šå‡ºäº‹â€ï¼Œè¿™ä¸ªæ¥å£å°±å¿…é¡»åšå¹‚ç­‰å¤„ç†ã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-3">ä¸‰ã€å“ªäº›åœºæ™¯æ˜¯å¹‚ç­‰â€œé‡ç¾åŒºâ€ï¼Ÿï¼ˆä¼˜å…ˆå¤„ç†è¿™äº›ï¼‰</h2>
<p>ä¸æ˜¯æ‰€æœ‰æ¥å£éƒ½éœ€è¦åšå¹‚ç­‰ï¼Œæˆ‘ä»¬è¦æŠŠç²¾åŠ›æ”¾åœ¨é«˜é£é™©åœºæ™¯ä¸Šã€‚ç›´æ¥åˆ—é‡ç‚¹ï¼Œè¿™äº›åœºæ™¯å¿…é¡»ä¼˜å…ˆä¿è¯å¹‚ç­‰ï¼š</p>
<ul>
<li>
<p><strong>äº¤æ˜“ç›¸å…³æ¥å£</strong>ï¼šä¸‹å•ã€æ”¯ä»˜ã€é€€æ¬¾ã€è½¬è´¦â€”â€”æ ¸å¿ƒæ˜¯æ¶‰åŠèµ„é‡‘å˜åŠ¨ï¼Œä¸€æ—¦é‡å¤å¿…ç„¶å‡ºé—®é¢˜</p>
</li>
<li>
<p><strong>åˆ›å»ºå‹æ¥å£ï¼ˆPOSTï¼‰</strong>ï¼šPOST æ¥å£çš„è¯­ä¹‰æ˜¯â€œåˆ›å»ºèµ„æºâ€ï¼Œé‡å¤è°ƒç”¨ä¼šç”Ÿæˆå¤šä¸ªèµ„æºï¼Œè€Œ GET æ¥å£æ˜¯â€œæŸ¥è¯¢èµ„æºâ€ï¼Œå¤©ç”Ÿå¹‚ç­‰ï¼ˆè¿™é‡Œè¦æ³¨æ„ï¼šRESTful è§„èŒƒä¸­ï¼ŒPOST æ˜¯éå¹‚ç­‰çš„ï¼ŒPUT æ˜¯å¹‚ç­‰çš„ï¼Œè®¾è®¡æ¥å£æ—¶è¦éµå¾ªè¿™ä¸ªè¯­ä¹‰ï¼‰</p>
</li>
<li>
<p><strong>MQ æ¶ˆè´¹é€»è¾‘</strong>ï¼šå¦‚å‰æ‰€è¿°ï¼ŒMQ é»˜è®¤â€œè‡³å°‘ä¸€æ¬¡â€æŠ•é€’ï¼Œæ¶ˆè´¹ç«¯å¿…é¡»èƒ½å¤„ç†é‡å¤æ¶ˆæ¯</p>
</li>
<li>
<p><strong>åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯</strong>ï¼šSaga æ¨¡å¼çš„è¡¥å¿æ¥å£ã€TCC æ¨¡å¼çš„ Confirm/Cancel æ¥å£ï¼Œéƒ½å¯èƒ½å› é‡è¯•è§¦å‘é‡å¤æ‰§è¡Œ</p>
</li>
<li>
<p><strong>å¯¹å¤–æä¾›çš„æ¥å£</strong>ï¼šç»™åˆä½œæ–¹ã€ç¬¬ä¸‰æ–¹è°ƒç”¨çš„æ¥å£ï¼Œæ— æ³•æ§åˆ¶å¯¹æ–¹çš„é‡è¯•ç­–ç•¥ï¼Œå¿…é¡»è‡ªå·±å…œåº•å¹‚ç­‰</p>
</li>
<li>
<p><strong>ç”¨æˆ·é«˜é¢‘æ“ä½œæ¥å£</strong>ï¼šå¦‚ä¼˜æƒ åˆ¸é¢†å–ã€æ´»åŠ¨æŠ¥åã€ç§’æ€ä¸‹å•â€”â€”ç”¨æˆ·å¯èƒ½å› æ“ä½œå¤±è¯¯æˆ–ç½‘ç»œé—®é¢˜é‡å¤è§¦å‘</p>
</li>
</ul>
<p>ç”¨ä¸€å¥æ‰å¿ƒçš„è¯æ€»ç»“ï¼š</p>
<blockquote>
<p><strong>ä½ ä¸ä¸»åŠ¨åšå¹‚ç­‰ï¼Œæµé‡ä¼šå¸®ä½ åšäº‹æ•…ã€‚</strong></p>
</blockquote>
<p>å¾ˆå¤šå›¢é˜Ÿçš„çº¿ä¸Šæ•…éšœå¤ç›˜ï¼Œæœ€åç»“è®ºéƒ½æ˜¯â€œæŸä¸ªæ¥å£æœªåšå¹‚ç­‰ï¼Œå¯¼è‡´é«˜å¹¶å‘ä¸‹é‡å¤æ‰§è¡Œâ€ã€‚ä¸å…¶äº‹åæ•‘ç«ï¼Œä¸å¦‚äº‹å‰é¢„é˜²ã€‚</p>
<hr/>
<h2 data-id="heading-4">å››ã€å¹‚ç­‰çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆçœ‹é€é—®é¢˜æ ¸å¿ƒï¼‰</h2>
<p>å¾ˆå¤šäººåœ¨è®¾è®¡å¹‚ç­‰æ–¹æ¡ˆæ—¶ä¼šé™·å…¥â€œå„ç§æŠ€å·§çš„å †ç Œâ€ï¼Œå…¶å®åªè¦æŠ“ä½æœ¬è´¨ï¼Œæ‰€æœ‰æ–¹æ¡ˆéƒ½èƒ½çœ‹æ‡‚ã€‚</p>
<p>æ‰€æœ‰å¹‚ç­‰æ–¹æ¡ˆï¼Œæœ¬è´¨ä¸Šéƒ½åœ¨è§£å†³åŒä¸€ä¸ªæ ¸å¿ƒé—®é¢˜ï¼š</p>
<blockquote>
<p><strong>â€œæˆ‘æ€ä¹ˆåˆ¤æ–­è¿™ä¸ªè¯·æ±‚æ˜¯ä¸æ˜¯å·²ç»å¤„ç†è¿‡äº†ï¼Ÿâ€</strong></p>
</blockquote>
<p>åªè¦èƒ½å‡†ç¡®å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œå¹‚ç­‰å°±è§£å†³äº†ä¸€åŠã€‚ä»å·¥ç¨‹å®è·µçš„è§’åº¦çœ‹ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜æ— éä¸‰ç§æ ¸å¿ƒæ€è·¯ï¼š</p>
<ul>
<li>
<p><strong>ç»™è¯·æ±‚åŠ â€œå”¯ä¸€æ ‡è¯†â€</strong>ï¼šé€šè¿‡ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ ID æ ‡è®°è¯·æ±‚ï¼Œç³»ç»Ÿå¤„ç†å‰å…ˆæ£€æŸ¥è¿™ä¸ª ID æ˜¯å¦å·²ç»å¤„ç†è¿‡â€”â€”è¿™æ˜¯æœ€å¸¸ç”¨çš„æ€è·¯</p>
</li>
<li>
<p><strong>è®©çŠ¶æ€â€œä¸å¯é€†â€</strong>ï¼šé€šè¿‡çŠ¶æ€æœºçº¦æŸï¼Œè®©ä¸šåŠ¡çŠ¶æ€åªèƒ½ä»â€œæœªå¤„ç†â€å‘â€œå·²å¤„ç†â€æµè½¬ï¼Œæ— æ³•å›é€€ï¼Œä»è€Œé¿å…é‡å¤å¤„ç†â€”â€”æ¯”å¦‚è®¢å•çŠ¶æ€ä»â€œå¾…æ”¯ä»˜â€åˆ°â€œå·²æ”¯ä»˜â€ï¼Œå†æ”¶åˆ°æ”¯ä»˜è¯·æ±‚æ—¶å°±æ— æ³•å†æ¬¡å˜æ›´</p>
</li>
<li>
<p><strong>è®°å½•â€œå»é‡æ—¥å¿—â€</strong>ï¼šä¸“é—¨ç»´æŠ¤ä¸€ä¸ªå»é‡è¡¨æˆ–ç¼“å­˜ï¼Œè®°å½•å·²ç»å¤„ç†è¿‡çš„è¯·æ±‚ï¼Œå¤„ç†æ–°è¯·æ±‚æ—¶å…ˆæŸ¥å»é‡è®°å½•â€”â€”æœ¬è´¨æ˜¯â€œå”¯ä¸€æ ‡è¯†â€æ€è·¯çš„å»¶ä¼¸</p>
</li>
</ul>
<p>ç†è§£äº†è¿™ä¸‰ç§æ€è·¯ï¼Œä¸‹é¢çš„å®æˆ˜æ–¹æ¡ˆå°±å¾ˆå®¹æ˜“çœ‹æ‡‚äº†â€”â€”æ‰€æœ‰æ–¹æ¡ˆéƒ½æ˜¯è¿™ä¸‰ç§æ€è·¯çš„å…·ä½“è½åœ°ã€‚</p>
<hr/>
<h2 data-id="heading-5">äº”ã€4 ç§ä¸»æµå¹‚ç­‰æ–¹æ¡ˆï¼ˆJava å®æˆ˜ï¼Œé™„ä»£ç +æ³¨æ„äº‹é¡¹ï¼‰</h2>
<p>ä¸‹é¢ä»‹ç»çš„ 4 ç§æ–¹æ¡ˆï¼Œè¦†ç›–äº† 90% ä»¥ä¸Šçš„ä¸šåŠ¡åœºæ™¯ã€‚ä»â€œç¨³å®šæ€§â€â€œå®ç°æˆæœ¬â€â€œé€‚ç”¨åœºæ™¯â€ä¸‰ä¸ªç»´åº¦å¯¹æ¯”ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡é€‰æ‹©ã€‚</p>
<h3 data-id="heading-6">1ï¸âƒ£ å”¯ä¸€ä¸šåŠ¡ ID + å”¯ä¸€ç´¢å¼•ï¼ˆæœ€ç¨³ã€æœ€æ¨èï¼‰â­</h3>
<p>è¿™æ˜¯å·¥ä¸šç•Œæœ€å¸¸ç”¨ã€æœ€å¯é çš„æ–¹æ¡ˆï¼Œæ ¸å¿ƒæ˜¯â€œç”¨ä¸šåŠ¡å”¯ä¸€ ID æ ‡è®°è¯·æ±‚ï¼Œç”¨æ•°æ®åº“å”¯ä¸€ç´¢å¼•å…œåº•â€ï¼Œä»æ ¹æºä¸Šé˜²æ­¢é‡å¤æ•°æ®æ’å…¥ã€‚</p>
<h4 data-id="heading-7">æ ¸å¿ƒæ€è·¯</h4>
<ol>
<li>
<p>å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚æ—¶ï¼Œæºå¸¦ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ä¸šåŠ¡ IDï¼ˆæ¯”å¦‚è®¢å•å· orderNoã€ä¸šåŠ¡æµæ°´å· bizIdï¼‰â€”â€”è¿™ä¸ª ID å¯ä»¥ç”±å®¢æˆ·ç«¯ç”Ÿæˆï¼Œä¹Ÿå¯ä»¥ç”±æœåŠ¡ç«¯ç”Ÿæˆåè¿”å›ç»™å®¢æˆ·ç«¯</p>
</li>
<li>
<p>æœåŠ¡ç«¯å¤„ç†è¯·æ±‚æ—¶ï¼Œå°†è¿™ä¸ªå”¯ä¸€ä¸šåŠ¡ ID å­˜å…¥ä¸šåŠ¡è¡¨ï¼ˆæ¯”å¦‚è®¢å•è¡¨ï¼‰</p>
</li>
<li>
<p>åœ¨ä¸šåŠ¡è¡¨ä¸Šç»™è¿™ä¸ªå”¯ä¸€ä¸šåŠ¡ ID åŠ â€œå”¯ä¸€ç´¢å¼•â€ï¼Œåˆ©ç”¨æ•°æ®åº“çš„çº¦æŸæœºåˆ¶ï¼Œé˜²æ­¢é‡å¤æ’å…¥æ•°æ®</p>
</li>
<li>
<p>å½“é‡å¤è¯·æ±‚åˆ°æ¥æ—¶ï¼Œæ•°æ®åº“ä¼šæŠ›å‡ºå”¯ä¸€çº¦æŸå†²çªå¼‚å¸¸ï¼ŒæœåŠ¡ç«¯æ•è·å¼‚å¸¸åï¼Œç›´æ¥è¿”å›â€œå¤„ç†æˆåŠŸâ€ï¼ˆå› ä¸ºç¬¬ä¸€æ¬¡è¯·æ±‚å·²ç»å¤„ç†å®Œæˆï¼‰</p>
</li>
</ol>
<h4 data-id="heading-8">å®æˆ˜ä»£ç ï¼ˆJava + MySQLï¼‰</h4>
<p>ç¬¬ä¸€æ­¥ï¼šç»™ä¸šåŠ¡è¡¨åŠ å”¯ä¸€ç´¢å¼•ï¼ˆä»¥è®¢å•è¡¨ä¸ºä¾‹ï¼‰</p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- è®¢å•è¡¨ï¼šorder_no æ˜¯å…¨å±€å”¯ä¸€çš„ä¸šåŠ¡ ID</span>
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> orders 
<span class="hljs-keyword">ADD</span> <span class="hljs-keyword">COLUMN</span> order_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è®¢å•å·ï¼ˆå…¨å±€å”¯ä¸€ï¼‰'</span>,
<span class="hljs-keyword">ADD</span> <span class="hljs-keyword">UNIQUE</span> KEY uk_order_no(order_no); <span class="hljs-comment">-- å”¯ä¸€ç´¢å¼•å…œåº•</span>
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼šJava ä»£ç å¤„ç†é€»è¾‘ï¼ˆç»“åˆ MyBatisï¼‰</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * ä¸‹å•æ¥å£ï¼ˆå¹‚ç­‰ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> createOrderDTO ä¸‹å•è¯·æ±‚DTOï¼ŒåŒ…å«å”¯ä¸€è®¢å•å· orderNo
 */</span>
<span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
<span class="hljs-keyword">public</span> OrderVO <span class="hljs-title function_">createOrder</span><span class="hljs-params">(CreateOrderDTO createOrderDTO)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">orderNo</span> <span class="hljs-operator">=</span> createOrderDTO.getOrderNo();
    <span class="hljs-keyword">if</span> (StringUtils.isBlank(orderNo)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BizException</span>(<span class="hljs-string">"è®¢å•å·ä¸èƒ½ä¸ºç©º"</span>);
    }

    <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();
    order.setOrderNo(orderNo);
    order.setUserId(createOrderDTO.getUserId());
    order.setProductId(createOrderDTO.getProductId());
    order.setStatus(<span class="hljs-string">"CREATED"</span>); <span class="hljs-comment">// åˆå§‹çŠ¶æ€ï¼šå¾…æ”¯ä»˜</span>

    <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// å°è¯•æ’å…¥è®¢å•</span>
        orderMapper.insert(order);
        <span class="hljs-comment">// åç»­ä¸šåŠ¡é€»è¾‘ï¼šæ‰£å‡åº“å­˜ã€é”å®šä¼˜æƒ åˆ¸ç­‰</span>
        deductStock(createOrderDTO.getProductId(), createOrderDTO.getQuantity());
        lockCoupon(createOrderDTO.getUserId(), createOrderDTO.getCouponId());
        <span class="hljs-comment">// è¿”å›æˆåŠŸç»“æœ</span>
        <span class="hljs-type">OrderVO</span> <span class="hljs-variable">orderVO</span> <span class="hljs-operator">=</span> convertToVO(order);
        <span class="hljs-keyword">return</span> orderVO;
    } <span class="hljs-keyword">catch</span> (DuplicateKeyException e) {
        <span class="hljs-comment">// æ•è·å”¯ä¸€ç´¢å¼•å†²çªå¼‚å¸¸ï¼Œè¯´æ˜æ˜¯é‡å¤è¯·æ±‚</span>
        log.info(<span class="hljs-string">"é‡å¤ä¸‹å•ï¼Œè®¢å•å·ï¼š{}"</span>, orderNo, e);
        <span class="hljs-comment">// ç›´æ¥æŸ¥è¯¢å·²å­˜åœ¨çš„è®¢å•ï¼Œè¿”å›æˆåŠŸç»“æœ</span>
        <span class="hljs-type">Order</span> <span class="hljs-variable">existOrder</span> <span class="hljs-operator">=</span> orderMapper.selectByOrderNo(orderNo);
        <span class="hljs-keyword">return</span> convertToVO(existOrder);
    }
}
</code></pre>
<h4 data-id="heading-9">ä¼˜ç‚¹ &amp; æ³¨æ„äº‹é¡¹</h4>
<p>âœ… ä¼˜ç‚¹ï¼š</p>
<ul>
<li>
<p>å®ç°ç®€å•ï¼Œå¼€å‘æˆæœ¬ä½</p>
</li>
<li>
<p>ç¨³å®šæ€§é«˜ï¼Œæ•°æ®åº“å”¯ä¸€ç´¢å¼•æ˜¯â€œç‰©ç†å…œåº•â€ï¼Œä¸ä¼šå‡ºç°æ¼åˆ¤çš„æƒ…å†µ</p>
</li>
<li>
<p>å¼ºä¸€è‡´æ€§ï¼Œèƒ½ä¿è¯ä¸šåŠ¡æ•°æ®çš„å‡†ç¡®æ€§</p>
</li>
</ul>
<p>âš ï¸ æ³¨æ„äº‹é¡¹ï¼ˆå…³é”®ï¼ï¼‰ï¼š</p>
<blockquote>
<p><strong>å”¯ä¸€ç´¢å¼•æ˜¯æœ€åä¸€é“é˜²çº¿ï¼Œè€Œä¸æ˜¯ç¬¬ä¸€é“ã€‚</strong></p>
</blockquote>
<p>å¾ˆå¤šäººä¼šçŠ¯ä¸€ä¸ªé”™è¯¯ï¼šæ¯æ¬¡è¯·æ±‚éƒ½ç›´æ¥å¾€æ•°æ®åº“æ’æ•°æ®ï¼Œé å”¯ä¸€ç´¢å¼•æŒ¡é‡å¤è¯·æ±‚ã€‚è¿™æ ·ä¼šå¯¼è‡´æ•°æ®åº“é¢‘ç¹æŠ›å‡ºå¼‚å¸¸ï¼Œå¢åŠ æ•°æ®åº“å‹åŠ›ã€‚</p>
<p>ä¼˜åŒ–å»ºè®®ï¼šåœ¨æ’å…¥æ•°æ®åº“ä¹‹å‰ï¼Œå…ˆæŸ¥ç¼“å­˜ï¼ˆæ¯”å¦‚ Redisï¼‰åˆ¤æ–­è®¢å•å·æ˜¯å¦å·²å­˜åœ¨â€”â€”ç¼“å­˜å‘½ä¸­åˆ™ç›´æ¥è¿”å›ï¼Œæœªå‘½ä¸­å†æ‰§è¡Œæ’å…¥é€»è¾‘ã€‚è¿™æ ·èƒ½å‡å°‘æ•°æ®åº“çš„å¼‚å¸¸æŠ›å‡ºæ¬¡æ•°ï¼Œæå‡æ€§èƒ½ã€‚ä¼˜åŒ–åçš„ä»£ç ç‰‡æ®µï¼š</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">// ä¼˜åŒ–ï¼šå…ˆæŸ¥ç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“å‹åŠ›</span>
<span class="hljs-type">String</span> <span class="hljs-variable">redisKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"order:idempotent:"</span> + orderNo;
<span class="hljs-type">Boolean</span> <span class="hljs-variable">isExist</span> <span class="hljs-operator">=</span> redisTemplate.hasKey(redisKey);
<span class="hljs-keyword">if</span> (Boolean.TRUE.equals(isExist)) {
    <span class="hljs-type">Order</span> <span class="hljs-variable">existOrder</span> <span class="hljs-operator">=</span> orderMapper.selectByOrderNo(orderNo);
    <span class="hljs-keyword">return</span> convertToVO(existOrder);
}

<span class="hljs-keyword">try</span> {
    orderMapper.insert(order);
    <span class="hljs-comment">// æ’å…¥æˆåŠŸåï¼Œå¾€ç¼“å­˜æ”¾ä¸€ä»½ï¼Œè¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºä¸šåŠ¡åˆç†æ—¶é—´ï¼ˆæ¯”å¦‚30åˆ†é’Ÿï¼‰</span>
    redisTemplate.opsForValue().set(redisKey, <span class="hljs-string">"1"</span>, <span class="hljs-number">30</span>, TimeUnit.MINUTES);
    <span class="hljs-comment">// åç»­ä¸šåŠ¡é€»è¾‘...</span>
} <span class="hljs-keyword">catch</span> (DuplicateKeyException e) {
    <span class="hljs-comment">// é‡å¤è¯·æ±‚å¤„ç†...</span>
}
</code></pre>
<h3 data-id="heading-10">2ï¸âƒ£ çŠ¶æ€æœº + ä¹è§‚é”ï¼ˆè®¢å•ç³»ç»Ÿæ ‡é…ï¼‰</h3>
<p>è¿™ä¸ªæ–¹æ¡ˆä¸»è¦é€‚ç”¨äºâ€œæœ‰æ˜ç¡®çŠ¶æ€æµè½¬â€çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ¯”å¦‚è®¢å•ã€æ”¯ä»˜ã€é€€æ¬¾ã€‚æ ¸å¿ƒæ˜¯â€œé€šè¿‡çŠ¶æ€æœºçº¦æŸä¸šåŠ¡çŠ¶æ€çš„æµè½¬ï¼Œå¹¶ç”¨ä¹è§‚é”ä¿è¯å¹¶å‘å®‰å…¨â€ï¼Œé¿å…é‡å¤å¤„ç†ã€‚</p>
<h4 data-id="heading-11">æ ¸å¿ƒæ€è·¯</h4>
<ol>
<li>
<p>ç»™ä¸šåŠ¡å®ä½“å®šä¹‰æ¸…æ™°çš„çŠ¶æ€æœºï¼Œæ¯”å¦‚è®¢å•çŠ¶æ€ï¼šå¾…æ”¯ä»˜ï¼ˆCREATEDï¼‰â†’ å·²æ”¯ä»˜ï¼ˆPAIDï¼‰â†’ å·²å‘è´§ï¼ˆSHIPPEDï¼‰â†’ å·²å®Œæˆï¼ˆCOMPLETEDï¼‰</p>
</li>
<li>
<p>çŠ¶æ€åªèƒ½â€œå‘å‰æµè½¬â€ï¼Œä¸èƒ½â€œå‘åæµè½¬â€ï¼ˆæ¯”å¦‚å·²æ”¯ä»˜çš„è®¢å•ï¼Œä¸èƒ½å†å›åˆ°å¾…æ”¯ä»˜çŠ¶æ€ï¼‰</p>
</li>
<li>
<p>æ›´æ–°çŠ¶æ€æ—¶ï¼Œé€šè¿‡â€œä¹è§‚é”â€ï¼ˆæ¯”å¦‚ç‰ˆæœ¬å· version æˆ–çŠ¶æ€å­—æ®µæœ¬èº«ï¼‰åšæ¡ä»¶åˆ¤æ–­ï¼Œåªæœ‰æ¡ä»¶æ»¡è¶³æ—¶æ‰æ›´æ–°æˆåŠŸ</p>
</li>
</ol>
<p>ä¸€å¥è¯ç†è§£ï¼šé‡å¤è¯·æ±‚åˆ°æ¥æ—¶ï¼Œå› ä¸ºçŠ¶æ€å·²ç»æµè½¬åˆ°ä¸‹ä¸€ä¸ªé˜¶æ®µï¼Œæ›´æ–°æ¡ä»¶ä¸æ»¡è¶³ï¼Œæ‰€ä»¥ä¸ä¼šé‡å¤å¤„ç†ã€‚</p>
<h4 data-id="heading-12">å®æˆ˜ä»£ç ï¼ˆJava + MySQLï¼‰</h4>
<p>ç¬¬ä¸€æ­¥ï¼šè®¢å•è¡¨å¢åŠ çŠ¶æ€å­—æ®µå’Œç‰ˆæœ¬å·å­—æ®µï¼ˆä¹è§‚é”ï¼‰</p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> orders 
<span class="hljs-keyword">ADD</span> <span class="hljs-keyword">COLUMN</span> status <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'è®¢å•çŠ¶æ€ï¼šCREATED-å¾…æ”¯ä»˜ï¼ŒPAID-å·²æ”¯ä»˜ï¼ŒSHIPPED-å·²å‘è´§ï¼ŒCOMPLETED-å·²å®Œæˆ'</span>,
<span class="hljs-keyword">ADD</span> <span class="hljs-keyword">COLUMN</span> version <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">'ç‰ˆæœ¬å·ï¼ˆä¹è§‚é”ï¼‰'</span>;
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼šæ›´æ–°çŠ¶æ€çš„ SQLï¼ˆä»¥â€œè®¢å•æ”¯ä»˜â€ä¸ºä¾‹ï¼‰</p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-comment">-- æ–¹å¼1ï¼šç”¨çŠ¶æ€ä½œä¸ºæ¡ä»¶ï¼ˆç®€å•åœºæ™¯ï¼‰</span>
<span class="hljs-keyword">UPDATE</span> orders 
<span class="hljs-keyword">SET</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'PAID'</span>, pay_time <span class="hljs-operator">=</span> NOW()
<span class="hljs-keyword">WHERE</span> order_no <span class="hljs-operator">=</span> ? <span class="hljs-keyword">AND</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'CREATED'</span>; <span class="hljs-comment">-- åªæœ‰çŠ¶æ€æ˜¯â€œå¾…æ”¯ä»˜â€æ—¶æ‰èƒ½æ›´æ–°</span>

<span class="hljs-comment">-- æ–¹å¼2ï¼šç”¨ç‰ˆæœ¬å·ä½œä¸ºæ¡ä»¶ï¼ˆå¹¶å‘æ›´é«˜çš„åœºæ™¯ï¼‰</span>
<span class="hljs-keyword">UPDATE</span> orders 
<span class="hljs-keyword">SET</span> status <span class="hljs-operator">=</span> <span class="hljs-string">'PAID'</span>, pay_time <span class="hljs-operator">=</span> NOW(), version <span class="hljs-operator">=</span> version <span class="hljs-operator">+</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">WHERE</span> order_no <span class="hljs-operator">=</span> ? <span class="hljs-keyword">AND</span> version <span class="hljs-operator">=</span> ?;
</code></pre>
<p>ç¬¬ä¸‰æ­¥ï¼šJava ä»£ç å¤„ç†é€»è¾‘</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * è®¢å•æ”¯ä»˜æ¥å£ï¼ˆå¹‚ç­‰ç‰ˆï¼‰
 * <span class="hljs-doctag">@param</span> payDTO æ”¯ä»˜è¯·æ±‚DTOï¼ŒåŒ…å«è®¢å•å·ã€æ”¯ä»˜é‡‘é¢ç­‰
 */</span>
<span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
<span class="hljs-keyword">public</span> Boolean <span class="hljs-title function_">payOrder</span><span class="hljs-params">(PayDTO payDTO)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">orderNo</span> <span class="hljs-operator">=</span> payDTO.getOrderNo();
    <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> orderMapper.selectByOrderNo(orderNo);
    <span class="hljs-keyword">if</span> (order == <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BizException</span>(<span class="hljs-string">"è®¢å•ä¸å­˜åœ¨"</span>);
    }

    <span class="hljs-comment">// æ–¹å¼1ï¼šç”¨çŠ¶æ€ä½œä¸ºæ¡ä»¶æ›´æ–°</span>
    <span class="hljs-type">int</span> <span class="hljs-variable">updateCount</span> <span class="hljs-operator">=</span> orderMapper.updateOrderStatusToPaid(orderNo, <span class="hljs-string">"CREATED"</span>);
    <span class="hljs-keyword">if</span> (updateCount == <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// æ›´æ–°å¤±è´¥ï¼Œè¯´æ˜è®¢å•å·²æ”¯ä»˜æˆ–çŠ¶æ€å¼‚å¸¸ï¼ˆé‡å¤è¯·æ±‚ï¼‰</span>
        log.info(<span class="hljs-string">"è®¢å•å·²æ”¯ä»˜æˆ–çŠ¶æ€å¼‚å¸¸ï¼Œè®¢å•å·ï¼š{}"</span>, orderNo);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// é‡å¤è¯·æ±‚ï¼Œè¿”å›æˆåŠŸ</span>
    }

    <span class="hljs-comment">// æ–¹å¼2ï¼šç”¨ç‰ˆæœ¬å·ä½œä¸ºæ¡ä»¶æ›´æ–°ï¼ˆæ¨èé«˜å¹¶å‘åœºæ™¯ï¼‰</span>
    <span class="hljs-comment">// int updateCount = orderMapper.updateOrderStatusToPaidWithVersion(orderNo, order.getVersion());</span>
    <span class="hljs-comment">// if (updateCount == 0) {</span>
    <span class="hljs-comment">//     log.info("è®¢å•å·²æ”¯ä»˜æˆ–çŠ¶æ€å¼‚å¸¸ï¼Œè®¢å•å·ï¼š{}", orderNo);</span>
    <span class="hljs-comment">//     return true;</span>
    <span class="hljs-comment">// }</span>

    <span class="hljs-comment">// åç»­ä¸šåŠ¡é€»è¾‘ï¼šæ‰£å‡ç”¨æˆ·ä½™é¢ã€è®°å½•æ”¯ä»˜æ—¥å¿—ç­‰</span>
    deductUserBalance(payDTO.getUserId(), payDTO.getAmount());
    recordPayLog(payDTO);

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>
<h4 data-id="heading-13">ä¼˜ç‚¹ &amp; é€‚ç”¨åœºæ™¯</h4>
<p>âœ… ä¼˜ç‚¹ï¼š</p>
<ul>
<li>
<p>è´´åˆä¸šåŠ¡åœºæ™¯ï¼ŒçŠ¶æ€æœºæœ¬èº«å°±æ˜¯ä¸šåŠ¡é€»è¾‘çš„ä¸€éƒ¨åˆ†ï¼Œä¸éœ€è¦é¢å¤–å¼•å…¥è¿‡å¤šæ¦‚å¿µ</p>
</li>
<li>
<p>å¹¶å‘æ€§èƒ½å¥½ï¼Œä¹è§‚é”ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œé€‚åˆé«˜å¹¶å‘åœºæ™¯</p>
</li>
<li>
<p>èƒ½é˜²æ­¢â€œçŠ¶æ€ä¹±åºâ€é—®é¢˜ï¼ˆæ¯”å¦‚åŒæ—¶æ”¶åˆ°â€œæ”¯ä»˜â€å’Œâ€œå–æ¶ˆâ€è¯·æ±‚ï¼Œä¿è¯åªæœ‰ä¸€ä¸ªèƒ½æ‰§è¡Œï¼‰</p>
</li>
</ul>
<p>ğŸ“Œ é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>
<p>è®¢å•çŠ¶æ€æµè½¬ï¼ˆæ”¯ä»˜ã€å‘è´§ã€å–æ¶ˆï¼‰</p>
</li>
<li>
<p>é€€æ¬¾æµç¨‹ï¼ˆç”³è¯·é€€æ¬¾ â†’ é€€æ¬¾ä¸­ â†’ é€€æ¬¾æˆåŠŸ/å¤±è´¥ï¼‰</p>
</li>
<li>
<p>ä»»ä½•æœ‰æ˜ç¡®çŠ¶æ€æµè½¬çš„ä¸šåŠ¡å®ä½“</p>
</li>
</ul>
<p>æ ¸å¿ƒåŸåˆ™ï¼š</p>
<blockquote>
<p><strong>çŠ¶æ€åªå¾€å‰èµ°ï¼Œæœ¬èº«å°±æ˜¯å¹‚ç­‰ã€‚</strong></p>
</blockquote>
<h3 data-id="heading-14">3ï¸âƒ£ Token / Redis å»é‡ï¼ˆé˜²é‡å¤æäº¤é¦–é€‰ï¼‰</h3>
<p>è¿™ä¸ªæ–¹æ¡ˆä¸»è¦ç”¨äºâ€œç”¨æˆ·äº¤äº’å‹æ¥å£â€ï¼Œæ¯”å¦‚è¡¨å•æäº¤ã€æŒ‰é’®ç‚¹å‡»ã€ç§’æ€ä¸‹å•ã€‚æ ¸å¿ƒæ˜¯â€œåœ¨è¯·æ±‚æ‰§è¡Œå‰ï¼Œå…ˆè·å–ä¸€ä¸ªå”¯ä¸€ Tokenï¼Œæ‰§è¡Œæ—¶æ ¡éªŒ Token æœ‰æ•ˆæ€§â€ï¼Œä»è€Œé˜²æ­¢é‡å¤æäº¤ã€‚</p>
<h4 data-id="heading-15">æ ¸å¿ƒæµç¨‹</h4>
<ol>
<li>
<p>å®¢æˆ·ç«¯å…ˆå‘æœåŠ¡ç«¯è¯·æ±‚â€œè·å– Tokenâ€ï¼ˆæ¯”å¦‚ç”¨æˆ·è¿›å…¥ä¸‹å•é¡µé¢æ—¶ï¼Œå‰ç«¯è°ƒç”¨æ¥å£è·å– Tokenï¼‰</p>
</li>
<li>
<p>æœåŠ¡ç«¯ç”Ÿæˆä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ Tokenï¼ˆæ¯”å¦‚ç”¨ UUIDï¼‰ï¼Œå­˜å…¥ Redisï¼ˆè®¾ç½®è¿‡æœŸæ—¶é—´ï¼‰ï¼Œç„¶åè¿”å›ç»™å®¢æˆ·ç«¯</p>
</li>
<li>
<p>å®¢æˆ·ç«¯å‘èµ·ä¸šåŠ¡è¯·æ±‚æ—¶ï¼Œå°† Token æ”¾åœ¨è¯·æ±‚å¤´æˆ–è¯·æ±‚å‚æ•°ä¸­ä¸€èµ·æäº¤</p>
</li>
<li>
<p>æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œå…ˆæ ¡éªŒ Tokenï¼šå¦‚æœ Redis ä¸­å­˜åœ¨è¯¥ Tokenï¼Œåˆ™åˆ é™¤ Token å¹¶æ‰§è¡Œåç»­ä¸šåŠ¡é€»è¾‘ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¯´æ˜æ˜¯é‡å¤è¯·æ±‚ï¼Œç›´æ¥è¿”å›é”™è¯¯</p>
</li>
</ol>
<p>æµç¨‹ç¤ºæ„å›¾ï¼š</p>
<pre><code class="hljs language-mermaid" lang="mermaid">
sequenceDiagram
    Client-&gt;&gt;Server: è¿›å…¥ä¸‹å•é¡µé¢ï¼Œè¯·æ±‚è·å–Token
    Server-&gt;&gt;Server: ç”ŸæˆUUIDä½œä¸ºTokenï¼Œå­˜å…¥Redisï¼ˆè®¾ç½®è¿‡æœŸæ—¶é—´ï¼‰
    Server-&gt;&gt;Client: è¿”å›Token
    Client-&gt;&gt;Server: æäº¤è®¢å•ï¼ˆæºå¸¦Tokenï¼‰
    Server-&gt;&gt;Server: æ ¡éªŒRedisä¸­æ˜¯å¦å­˜åœ¨è¯¥Tokenï¼Œå­˜åœ¨åˆ™åˆ é™¤
    Server-&gt;&gt;Server: æ‰§è¡Œä¸‹å•é€»è¾‘
    Server-&gt;&gt;Client: è¿”å›ä¸‹å•ç»“æœ
    Client-&gt;&gt;Server: é‡å¤æäº¤è®¢å•ï¼ˆæºå¸¦ç›¸åŒTokenï¼‰
    Server-&gt;&gt;Server: æ ¡éªŒRedisä¸­å·²æ— è¯¥Token
    Server-&gt;&gt;Client: è¿”å›â€œé‡å¤æäº¤â€é”™è¯¯
</code></pre>
<h4 data-id="heading-16">å®æˆ˜ä»£ç ï¼ˆJava + Redisï¼‰</h4>
<p>ç¬¬ä¸€æ­¥ï¼šè·å– Token æ¥å£</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * è·å–é˜²é‡å¤æäº¤Token
 */</span>
<span class="hljs-meta">@GetMapping("/api/idempotent/token")</span>
<span class="hljs-keyword">public</span> Result&lt;String&gt; <span class="hljs-title function_">getIdempotentToken</span><span class="hljs-params">()</span> {
    <span class="hljs-comment">// ç”Ÿæˆå”¯ä¸€Tokenï¼ˆUUIDï¼‰</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> UUID.randomUUID().toString().replace(<span class="hljs-string">"-"</span>, <span class="hljs-string">""</span>);
    <span class="hljs-comment">// å­˜å…¥Redisï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´5åˆ†é’Ÿï¼ˆæ ¹æ®ä¸šåŠ¡è°ƒæ•´ï¼Œæ¯”å¦‚è¡¨å•æäº¤è®¾ç½®10åˆ†é’Ÿï¼‰</span>
    <span class="hljs-type">String</span> <span class="hljs-variable">redisKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"idempotent:token:"</span> + token;
    redisTemplate.opsForValue().set(redisKey, <span class="hljs-string">"1"</span>, <span class="hljs-number">5</span>, TimeUnit.MINUTES);
    <span class="hljs-keyword">return</span> Result.success(token);
}
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼šä¸šåŠ¡æ¥å£ï¼ˆç»“åˆ Spring AOP å®ç°æ›´ä¼˜é›…ï¼‰</p>
<p>å…ˆå®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰æ³¨è§£ï¼Œç”¨äºæ ‡è®°éœ€è¦é˜²é‡å¤æäº¤çš„æ¥å£ï¼š</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * é˜²é‡å¤æäº¤æ³¨è§£
 */</span>
<span class="hljs-meta">@Target(ElementType.METHOD)</span>
<span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span>
<span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> Idempotent {
    <span class="hljs-comment">// Tokenå‚æ•°çš„åç§°ï¼ˆé»˜è®¤ä»è¯·æ±‚å¤´è·å–ï¼‰</span>
    String <span class="hljs-title function_">tokenName</span><span class="hljs-params">()</span> <span class="hljs-keyword">default</span> <span class="hljs-string">"Idempotent-Token"</span>;
}

<span class="hljs-comment">// AOPåˆ‡é¢å®ç°</span>
<span class="hljs-meta">@Aspect</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdempotentAspect</span> {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> StringRedisTemplate redisTemplate;

    <span class="hljs-meta">@Around("@annotation(idempotent)")</span>
    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">around</span><span class="hljs-params">(ProceedingJoinPoint joinPoint, Idempotent idempotent)</span> <span class="hljs-keyword">throws</span> Throwable {
        <span class="hljs-comment">// 1. è·å–è¯·æ±‚ä¸­çš„Token</span>
        <span class="hljs-type">HttpServletRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest();
        <span class="hljs-type">String</span> <span class="hljs-variable">token</span> <span class="hljs-operator">=</span> request.getHeader(idempotent.tokenName());
        <span class="hljs-keyword">if</span> (StringUtils.isBlank(token)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BizException</span>(<span class="hljs-string">"Tokenä¸èƒ½ä¸ºç©º"</span>);
        }

        <span class="hljs-comment">// 2. æ ¡éªŒTokenæ˜¯å¦å­˜åœ¨äºRedis</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">redisKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"idempotent:token:"</span> + token;
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">isExist</span> <span class="hljs-operator">=</span> redisTemplate.hasKey(redisKey);
        <span class="hljs-keyword">if</span> (Boolean.FALSE.equals(isExist)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BizException</span>(<span class="hljs-string">"é‡å¤æäº¤ï¼Œè¯·ç¨åå†è¯•"</span>);
        }

        <span class="hljs-comment">// 3. åŸå­æ€§åˆ é™¤Tokenï¼ˆé˜²æ­¢å¹¶å‘é—®é¢˜ï¼‰</span>
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">deleteSuccess</span> <span class="hljs-operator">=</span> redisTemplate.delete(redisKey);
        <span class="hljs-keyword">if</span> (Boolean.FALSE.equals(deleteSuccess)) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BizException</span>(<span class="hljs-string">"é‡å¤æäº¤ï¼Œè¯·ç¨åå†è¯•"</span>);
        }

        <span class="hljs-comment">// 4. æ‰§è¡ŒåŸä¸šåŠ¡é€»è¾‘</span>
        <span class="hljs-keyword">return</span> joinPoint.proceed();
    }
}
</code></pre>
<p>ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨æ³¨è§£æ ‡è®°ä¸šåŠ¡æ¥å£</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * è¡¨å•æäº¤æ¥å£ï¼ˆé˜²é‡å¤æäº¤ï¼‰
 */</span>
<span class="hljs-meta">@PostMapping("/api/form/submit")</span>
<span class="hljs-meta">@Idempotent(tokenName = "Idempotent-Token")</span>
<span class="hljs-keyword">public</span> Result&lt;String&gt; <span class="hljs-title function_">submitForm</span><span class="hljs-params">(<span class="hljs-meta">@RequestBody</span> FormDTO formDTO)</span> {
    <span class="hljs-comment">// æ‰§è¡Œè¡¨å•æäº¤é€»è¾‘</span>
    formService.submit(formDTO);
    <span class="hljs-keyword">return</span> Result.success(<span class="hljs-string">"æäº¤æˆåŠŸ"</span>);
}
</code></pre>
<h4 data-id="heading-17">ä¼˜ç‚¹ &amp; æ³¨æ„äº‹é¡¹</h4>
<p>âœ… ä¼˜ç‚¹ï¼š</p>
<ul>
<li>
<p>å®ç°ä¼˜é›…ï¼Œé€šè¿‡ AOP å¯ä»¥å…¨å±€å¤ç”¨ï¼Œå¼€å‘æˆæœ¬ä½</p>
</li>
<li>
<p>æ€§èƒ½å¥½ï¼ŒåŸºäº Redis æ“ä½œï¼Œå“åº”é€Ÿåº¦å¿«</p>
</li>
<li>
<p>é€‚åˆå‰ç«¯äº¤äº’åœºæ™¯ï¼Œèƒ½æœ‰æ•ˆé˜²æ­¢ç”¨æˆ·é‡å¤ç‚¹å‡»</p>
</li>
</ul>
<p>âš ï¸ æ³¨æ„äº‹é¡¹ï¼š</p>
<ul>
<li>
<p>ä¸é€‚åˆæ ¸å¿ƒäº¤æ˜“é“¾è·¯ï¼šRedis æ˜¯ç¼“å­˜ï¼Œå­˜åœ¨å®•æœºæˆ–æ•°æ®ä¸¢å¤±çš„é£é™©ï¼Œæ— æ³•åƒæ•°æ®åº“é‚£æ ·æä¾›å¼ºä¸€è‡´æ€§ä¿è¯</p>
</li>
<li>
<p>Token è¿‡æœŸæ—¶é—´è¦åˆç†ï¼šå¤ªçŸ­ä¼šå¯¼è‡´æ­£å¸¸è¯·æ±‚å¤±è´¥ï¼Œå¤ªé•¿ä¼šå ç”¨ Redis èµ„æº</p>
</li>
<li>
<p>å¿…é¡»ä¿è¯â€œåˆ é™¤ Tokenâ€æ˜¯åŸå­æ“ä½œï¼šå¦‚æœç”¨â€œå…ˆæŸ¥ååˆ â€çš„æ–¹å¼ï¼Œä¼šå‡ºç°å¹¶å‘é—®é¢˜ï¼ˆä¸¤ä¸ªè¯·æ±‚åŒæ—¶æŸ¥åˆ° Token å­˜åœ¨ï¼Œç„¶åéƒ½æ‰§è¡Œåˆ é™¤ï¼Œå¯¼è‡´é‡å¤å¤„ç†ï¼‰</p>
</li>
</ul>
<p>æ ¸å¿ƒç»“è®ºï¼šè¿™ä¸ªæ–¹æ¡ˆé€‚åˆâ€œéæ ¸å¿ƒé“¾è·¯çš„é˜²é‡å¤æäº¤â€ï¼Œæ¯”å¦‚è¡¨å•æäº¤ã€è¯„è®ºå‘å¸ƒã€æ´»åŠ¨æŠ¥åç­‰ï¼›æ ¸å¿ƒäº¤æ˜“é“¾è·¯ï¼ˆä¸‹å•ã€æ”¯ä»˜ï¼‰ä¸æ¨èå•ç‹¬ä½¿ç”¨ï¼Œå»ºè®®ç»“åˆæ–¹æ¡ˆä¸€ï¼ˆå”¯ä¸€ç´¢å¼•ï¼‰å…œåº•ã€‚</p>
<h3 data-id="heading-18">4ï¸âƒ£ MQ æ¶ˆè´¹å¹‚ç­‰ï¼ˆé¢è¯•å¿…è€ƒï¼Œå¿…é¡»æŒæ¡ï¼‰</h3>
<p>MQ æ¶ˆè´¹çš„å¹‚ç­‰æ˜¯é«˜å¹¶å‘ç³»ç»Ÿä¸­çš„é«˜é¢‘é—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰ MQ ä¸­é—´ä»¶éƒ½æ— æ³•ä¿è¯â€œæ°å¥½ä¸€æ¬¡â€æŠ•é€’ï¼ˆé™¤éç”¨äº‹åŠ¡æ¶ˆæ¯ï¼Œä½†å¤æ‚åº¦é«˜ï¼‰ï¼Œé»˜è®¤éƒ½æ˜¯â€œè‡³å°‘ä¸€æ¬¡â€æŠ•é€’ã€‚æ‰€ä»¥ï¼Œæ¶ˆè´¹ç«¯å¿…é¡»è‡ªå·±å¤„ç†é‡å¤æ¶ˆæ¯ã€‚</p>
<h4 data-id="heading-19">æ ¸å¿ƒæ€è·¯</h4>
<p>MQ æ¶ˆæ¯æœ¬èº«ä¼šæºå¸¦ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„æ¶ˆæ¯ IDï¼ˆæ¯”å¦‚ RocketMQ çš„ msgIdã€Kafka çš„ offset + partitionï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¶ˆæ¯ ID åšå»é‡ï¼›å¦‚æœæ¶ˆæ¯ ID ä¸å¯é ï¼ˆæ¯”å¦‚æœ‰äº› MQ ä¼šé‡å¤ç”Ÿæˆ msgIdï¼‰ï¼Œåˆ™å¯ä»¥ç”¨ä¸šåŠ¡å”¯ä¸€ IDï¼ˆæ¯”å¦‚è®¢å•å·ï¼‰åšå»é‡ã€‚</p>
<p>æ ¸å¿ƒæµç¨‹ï¼š</p>
<ol>
<li>
<p>æ¶ˆè´¹æ¶ˆæ¯å‰ï¼Œå…ˆæ£€æŸ¥è¯¥æ¶ˆæ¯çš„ IDï¼ˆmsgId æˆ– bizIdï¼‰æ˜¯å¦å·²ç»å¤„ç†è¿‡</p>
</li>
<li>
<p>å¦‚æœå·²ç»å¤„ç†è¿‡ï¼Œåˆ™ç›´æ¥è¿”å›æˆåŠŸï¼Œä¸æ‰§è¡Œåç»­é€»è¾‘</p>
</li>
<li>
<p>å¦‚æœæœªå¤„ç†è¿‡ï¼Œåˆ™æ‰§è¡Œæ¶ˆè´¹é€»è¾‘ï¼Œæ‰§è¡Œå®Œæˆåï¼Œè®°å½•è¯¥æ¶ˆæ¯ ID å·²å¤„ç†</p>
</li>
</ol>
<p>ä¸€å¥è¯ç‚¹ç ´ï¼š</p>
<blockquote>
<p><strong>MQ ä¸€å®šä¼šé‡å¤ï¼Œä¸šåŠ¡å¿…é¡»èƒ½æ‰›ä½ã€‚</strong></p>
</blockquote>
<h4 data-id="heading-20">å®æˆ˜ä»£ç ï¼ˆJava + RocketMQï¼‰</h4>
<p>è¿™é‡Œæä¾›ä¸¤ç§å®ç°æ–¹å¼ï¼šåŸºäº Redis å»é‡ï¼ˆé€‚åˆéæ ¸å¿ƒæ¶ˆæ¯ï¼‰å’ŒåŸºäºæ•°æ®åº“å»é‡è¡¨ï¼ˆé€‚åˆæ ¸å¿ƒæ¶ˆæ¯ï¼‰ã€‚</p>
<p>æ–¹å¼ä¸€ï¼šåŸºäº Redis å»é‡ï¼ˆç®€å•åœºæ™¯ï¼‰</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * MQ æ¶ˆè´¹è€…ï¼ˆåŸºäºRediså»é‡ï¼‰
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RocketMQMessageListener(topic = "order_topic", consumerGroup = "order_consumer_group")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">OrderConsumer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;MessageExt&gt; {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> StringRedisTemplate redisTemplate;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> OrderService orderService;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(MessageExt messageExt)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">msgId</span> <span class="hljs-operator">=</span> messageExt.getMsgId(); <span class="hljs-comment">// MQè‡ªå¸¦çš„å”¯ä¸€æ¶ˆæ¯ID</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">body</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(messageExt.getBody(), StandardCharsets.UTF_8);
        <span class="hljs-type">OrderMessage</span> <span class="hljs-variable">orderMessage</span> <span class="hljs-operator">=</span> JSON.parseObject(body, OrderMessage.class);
        <span class="hljs-type">String</span> <span class="hljs-variable">bizId</span> <span class="hljs-operator">=</span> orderMessage.getOrderNo(); <span class="hljs-comment">// ä¸šåŠ¡å”¯ä¸€IDï¼ˆè®¢å•å·ï¼‰</span>

        <span class="hljs-comment">// 1. å…ˆæŸ¥Redisï¼Œåˆ¤æ–­æ˜¯å¦å·²å¤„ç†ï¼ˆç”¨bizIdæ›´å¯é ï¼ŒmsgIdå¯èƒ½é‡å¤ï¼‰</span>
        <span class="hljs-type">String</span> <span class="hljs-variable">redisKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"mq:idempotent:order:"</span> + bizId;
        <span class="hljs-type">Boolean</span> <span class="hljs-variable">isProcessed</span> <span class="hljs-operator">=</span> redisTemplate.hasKey(redisKey);
        <span class="hljs-keyword">if</span> (Boolean.TRUE.equals(isProcessed)) {
            log.info(<span class="hljs-string">"æ¶ˆæ¯å·²å¤„ç†ï¼ŒmsgIdï¼š{}ï¼ŒbizIdï¼š{}"</span>, msgId, bizId);
            <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 2. æ‰§è¡Œæ¶ˆè´¹é€»è¾‘ï¼ˆæ¯”å¦‚æ›´æ–°è®¢å•çŠ¶æ€ï¼‰</span>
            orderService.processOrderMessage(orderMessage);

            <span class="hljs-comment">// 3. æ ‡è®°ä¸ºå·²å¤„ç†ï¼ˆå­˜å…¥Redisï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ¯”å¦‚24å°æ—¶ï¼‰</span>
            redisTemplate.opsForValue().set(redisKey, <span class="hljs-string">"1"</span>, <span class="hljs-number">24</span>, TimeUnit.HOURS);
            log.info(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†æˆåŠŸï¼ŒmsgIdï¼š{}ï¼ŒbizIdï¼š{}"</span>, msgId, bizId);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†å¤±è´¥ï¼ŒmsgIdï¼š{}ï¼ŒbizIdï¼š{}"</span>, msgId, bizId, e);
            <span class="hljs-comment">// æŠ›å‡ºå¼‚å¸¸ï¼Œè®©MQé‡è¯•ï¼ˆæ ¹æ®ä¸šåŠ¡è°ƒæ•´é‡è¯•ç­–ç•¥ï¼‰</span>
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œè§¦å‘é‡è¯•"</span>, e);
        }
    }
}
</code></pre>
<p>æ–¹å¼äºŒï¼šåŸºäºæ•°æ®åº“å»é‡è¡¨ï¼ˆæ ¸å¿ƒæ¶ˆæ¯ï¼Œå¼ºä¸€è‡´ï¼‰</p>
<p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»º MQ æ¶ˆæ¯å»é‡è¡¨</p>
<pre><code class="hljs language-sql" lang="sql">
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> mq_message_idempotent (
    id <span class="hljs-type">BIGINT</span> AUTO_INCREMENT <span class="hljs-keyword">PRIMARY</span> KEY COMMENT <span class="hljs-string">'ä¸»é”®ID'</span>,
    msg_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'MQæ¶ˆæ¯ID'</span>,
    biz_id <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">64</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> COMMENT <span class="hljs-string">'ä¸šåŠ¡å”¯ä¸€ID'</span>,
    status TINYINT <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span> COMMENT <span class="hljs-string">'å¤„ç†çŠ¶æ€ï¼š0-æœªå¤„ç†ï¼Œ1-å·²å¤„ç†'</span>,
    create_time DATETIME <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="hljs-string">'åˆ›å»ºæ—¶é—´'</span>,
    update_time DATETIME <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> <span class="hljs-keyword">ON</span> <span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="hljs-string">'æ›´æ–°æ—¶é—´'</span>,
    <span class="hljs-keyword">UNIQUE</span> KEY uk_biz_id (biz_id) COMMENT <span class="hljs-string">'ä¸šåŠ¡IDå”¯ä¸€çº¦æŸ'</span>
) ENGINE<span class="hljs-operator">=</span>InnoDB <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8mb4 COMMENT <span class="hljs-string">'MQæ¶ˆæ¯å¹‚ç­‰è¡¨'</span>;
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼šæ¶ˆè´¹é€»è¾‘ä»£ç </p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">/**
 * MQ æ¶ˆè´¹è€…ï¼ˆåŸºäºæ•°æ®åº“å»é‡è¡¨ï¼‰
 */</span>
<span class="hljs-meta">@Component</span>
<span class="hljs-meta">@RocketMQMessageListener(topic = "payment_topic", consumerGroup = "payment_consumer_group")</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PaymentConsumer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RocketMQListener</span>&lt;MessageExt&gt; {

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> MqMessageIdempotentMapper idempotentMapper;

    <span class="hljs-meta">@Autowired</span>
    <span class="hljs-keyword">private</span> PaymentService paymentService;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onMessage</span><span class="hljs-params">(MessageExt messageExt)</span> {
        <span class="hljs-type">String</span> <span class="hljs-variable">msgId</span> <span class="hljs-operator">=</span> messageExt.getMsgId();
        <span class="hljs-type">String</span> <span class="hljs-variable">body</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(messageExt.getBody(), StandardCharsets.UTF_8);
        <span class="hljs-type">PaymentMessage</span> <span class="hljs-variable">paymentMessage</span> <span class="hljs-operator">=</span> JSON.parseObject(body, PaymentMessage.class);
        <span class="hljs-type">String</span> <span class="hljs-variable">bizId</span> <span class="hljs-operator">=</span> paymentMessage.getPayNo(); <span class="hljs-comment">// æ”¯ä»˜æµæ°´å·ï¼ˆä¸šåŠ¡å”¯ä¸€IDï¼‰</span>

        <span class="hljs-comment">// 1. å°è¯•æ’å…¥å»é‡è¡¨ï¼ˆå”¯ä¸€çº¦æŸå…œåº•ï¼‰</span>
        <span class="hljs-type">MqMessageIdempotent</span> <span class="hljs-variable">idempotent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MqMessageIdempotent</span>();
        idempotent.setMsgId(msgId);
        idempotent.setBizId(bizId);
        idempotent.setStatus(<span class="hljs-number">0</span>); <span class="hljs-comment">// æœªå¤„ç†</span>

        <span class="hljs-keyword">try</span> {
            idempotentMapper.insert(idempotent);
        } <span class="hljs-keyword">catch</span> (DuplicateKeyException e) {
            <span class="hljs-comment">// é‡å¤æ¶ˆæ¯ï¼ŒæŸ¥è¯¢å¤„ç†çŠ¶æ€</span>
            <span class="hljs-type">MqMessageIdempotent</span> <span class="hljs-variable">exist</span> <span class="hljs-operator">=</span> idempotentMapper.selectByBizId(bizId);
            <span class="hljs-keyword">if</span> (exist.getStatus() == <span class="hljs-number">1</span>) {
                log.info(<span class="hljs-string">"æ¶ˆæ¯å·²å¤„ç†ï¼ŒmsgIdï¼š{}ï¼ŒbizIdï¼š{}"</span>, msgId, bizId);
                <span class="hljs-keyword">return</span>;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-comment">// æ¶ˆæ¯æ­£åœ¨å¤„ç†ä¸­ï¼ŒæŠ›å‡ºå¼‚å¸¸è®©MQé‡è¯•ï¼ˆæˆ–æ ¹æ®ä¸šåŠ¡å¤„ç†ï¼‰</span>
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†ä¸­ï¼Œè¯·ç¨åé‡è¯•"</span>);
            }
        }

        <span class="hljs-keyword">try</span> {
            <span class="hljs-comment">// 2. æ‰§è¡Œæ¶ˆè´¹é€»è¾‘ï¼ˆæ¯”å¦‚å¤„ç†æ”¯ä»˜ç»“æœï¼‰</span>
            paymentService.processPaymentResult(paymentMessage);

            <span class="hljs-comment">// 3. æ›´æ–°å»é‡è¡¨çŠ¶æ€ä¸ºâ€œå·²å¤„ç†â€</span>
            idempotentMapper.updateStatusByBizId(bizId, <span class="hljs-number">1</span>);
            log.info(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†æˆåŠŸï¼ŒmsgIdï¼š{}ï¼ŒbizIdï¼š{}"</span>, msgId, bizId);
        } <span class="hljs-keyword">catch</span> (Exception e) {
            log.error(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†å¤±è´¥ï¼ŒmsgIdï¼š{}ï¼ŒbizIdï¼š{}"</span>, msgId, bizId, e);
            <span class="hljs-comment">// å¯ä»¥æ›´æ–°çŠ¶æ€ä¸ºâ€œå¤„ç†å¤±è´¥â€ï¼Œåç»­äººå·¥ä»‹å…¥</span>
            idempotentMapper.updateStatusByBizId(bizId, <span class="hljs-number">2</span>);
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">"æ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œè§¦å‘é‡è¯•"</span>, e);
        }
    }
}
</code></pre>
<h4 data-id="heading-21">ä¼˜ç‚¹ &amp; é€‚ç”¨åœºæ™¯</h4>
<p>âœ… ä¼˜ç‚¹ï¼š</p>
<ul>
<li>
<p>å¯é æ€§é«˜ï¼Œå°¤å…¶æ˜¯åŸºäºæ•°æ®åº“å»é‡è¡¨çš„æ–¹å¼ï¼Œèƒ½ä¿è¯å¼ºä¸€è‡´æ€§</p>
</li>
<li>
<p>é€‚é…æ‰€æœ‰ MQ åœºæ™¯ï¼Œé€šç”¨æ€§å¼º</p>
</li>
</ul>
<p>ğŸ“Œ é€‚ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>
<p>åŸºäº Redis ï¼šéæ ¸å¿ƒæ¶ˆæ¯ï¼Œæ¯”å¦‚æ—¥å¿—åŒæ­¥ã€é€šçŸ¥æ¨é€ã€æ•°æ®ç»Ÿè®¡</p>
</li>
<li>
<p>åŸºäºæ•°æ®åº“ï¼šæ ¸å¿ƒæ¶ˆæ¯ï¼Œæ¯”å¦‚è®¢å•æ”¯ä»˜ç»“æœé€šçŸ¥ã€åº“å­˜å˜æ›´æ¶ˆæ¯ã€é€€æ¬¾æ¶ˆæ¯</p>
</li>
</ul>
<p>é¢è¯•å°è´´å£«ï¼šè¢«é—®åˆ°â€œMQ æ¶ˆè´¹å¦‚ä½•ä¿è¯å¹‚ç­‰â€æ—¶ï¼Œè¦å…ˆè¯´æ˜â€œMQ æ— æ³•é¿å…é‡å¤æŠ•é€’â€ï¼Œç„¶ååˆ†åœºæ™¯ç»™å‡ºæ–¹æ¡ˆï¼Œæœ€åå¼ºè°ƒâ€œæ ¸å¿ƒæ¶ˆæ¯å¿…é¡»ç”¨æ•°æ®åº“å»é‡è¡¨å…œåº•â€ï¼Œè¿™æ ·å›ç­”æ‰å¤Ÿå…¨é¢ã€‚</p>
<hr/>
<h2 data-id="heading-22">å…­ã€3 ä¸ªæœ€å®¹æ˜“è¸©çš„å¹‚ç­‰å¤§å‘ï¼ˆé¿å‘æŒ‡å—ï¼‰</h2>
<p>å¾ˆå¤šäººåšäº†å¹‚ç­‰å¤„ç†ï¼Œä½†è¿˜æ˜¯å‡ºäº†é—®é¢˜ï¼ŒåŸå› æ˜¯è¸©äº†ä¸€äº›â€œéšæ€§å‘â€ã€‚ä¸‹é¢è¿™ 3 ä¸ªå‘ï¼Œä¸€å®šè¦é¿å¼€ï¼š</p>
<h3 data-id="heading-23">âŒ 1. å…ˆæŸ¥å†æ’/å…ˆæŸ¥å†æ›´ï¼ˆé«˜å¹¶å‘ä¸‹å¿…ç‚¸ï¼‰</h3>
<p>è¿™æ˜¯æœ€å¸¸è§çš„é”™è¯¯åšæ³•ï¼šå¤„ç†è¯·æ±‚æ—¶ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“â€œè¿™ä¸ªè¯·æ±‚æ˜¯å¦å·²å¤„ç†â€ï¼Œå¦‚æœæ²¡å¤„ç†å†æ‰§è¡Œæ’å…¥/æ›´æ–°æ“ä½œã€‚ä»£ç ç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">// é”™è¯¯ä»£ç ï¼šå…ˆæŸ¥å†æ’</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(CreateOrderDTO dto)</span> {
    <span class="hljs-comment">// å…ˆæŸ¥è¯¢è®¢å•æ˜¯å¦å­˜åœ¨</span>
    <span class="hljs-type">Order</span> <span class="hljs-variable">existOrder</span> <span class="hljs-operator">=</span> orderMapper.selectByOrderNo(dto.getOrderNo());
    <span class="hljs-keyword">if</span> (existOrder != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">return</span>;
    }
    <span class="hljs-comment">// æ’å…¥è®¢å•</span>
    <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();
    order.setOrderNo(dto.getOrderNo());
    orderMapper.insert(order);
}
</code></pre>
<p>é—®é¢˜å‡ºåœ¨â€œæŸ¥è¯¢â€å’Œâ€œæ’å…¥â€ä¹‹é—´å­˜åœ¨â€œæ—¶é—´çª—å£â€ï¼šé«˜å¹¶å‘ä¸‹ï¼Œä¸¤ä¸ªç›¸åŒçš„è¯·æ±‚å¯èƒ½åŒæ—¶æŸ¥è¯¢åˆ°â€œè®¢å•ä¸å­˜åœ¨â€ï¼Œç„¶ååŒæ—¶æ’å…¥è®¢å•ï¼Œå¯¼è‡´å”¯ä¸€ç´¢å¼•å†²çªï¼Œæˆ–è€…ç›´æ¥ç”Ÿæˆä¸¤ä¸ªè®¢å•ï¼ˆå¦‚æœæ²¡åŠ å”¯ä¸€ç´¢å¼•ï¼‰ã€‚</p>
<p>æ­£ç¡®åšæ³•ï¼š</p>
<blockquote>
<p><strong>ç›´æ¥æ’/ç›´æ¥æ›´ï¼Œäº¤ç»™å”¯ä¸€çº¦æŸæˆ–ä¹è§‚é”å…œåº•ã€‚</strong></p>
</blockquote>
<p>æ¯”å¦‚æ–¹æ¡ˆä¸€ä¸­çš„â€œç›´æ¥æ’å…¥ï¼Œæ•è·å”¯ä¸€ç´¢å¼•å†²çªâ€ï¼Œæ–¹æ¡ˆäºŒä¸­çš„â€œç›´æ¥æ›´æ–°ï¼Œåˆ¤æ–­å½±å“è¡Œæ•°â€â€”â€”ç”¨æ•°æ®åº“çš„åŸå­æ“ä½œä»£æ›¿â€œå…ˆæŸ¥åå†™â€ï¼Œé¿å…å¹¶å‘é—®é¢˜ã€‚</p>
<h3 data-id="heading-24">âŒ 2. å¹‚ç­‰é€»è¾‘ä¸åœ¨äº‹åŠ¡é‡Œï¼ˆæ•°æ®çµå¼‚ï¼‰</h3>
<p>è¿™ä¸ªå‘çš„åœºæ™¯ï¼šæ ‡è®°â€œè¯·æ±‚å·²å¤„ç†â€çš„æ“ä½œï¼Œå’Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä¸åœ¨åŒä¸€ä¸ªäº‹åŠ¡é‡Œã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">// é”™è¯¯ä»£ç ï¼šå¹‚ç­‰æ ‡è®°ä¸åœ¨äº‹åŠ¡ä¸­</span>
<span class="hljs-meta">@Transactional(rollbackFor = Exception.class)</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processOrder</span><span class="hljs-params">(OrderMessage message)</span> {
    <span class="hljs-type">String</span> <span class="hljs-variable">bizId</span> <span class="hljs-operator">=</span> message.getOrderNo();
    <span class="hljs-comment">// 1. æ‰§è¡Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆæ›´æ–°è®¢å•çŠ¶æ€ï¼‰</span>
    orderMapper.updateStatus(bizId, <span class="hljs-string">"PAID"</span>);
    <span class="hljs-comment">// 2. æ ‡è®°ä¸ºå·²å¤„ç†ï¼ˆå­˜å…¥Redisï¼Œä¸åœ¨äº‹åŠ¡ä¸­ï¼‰</span>
    redisTemplate.opsForValue().set(<span class="hljs-string">"order:processed:"</span> + bizId, <span class="hljs-string">"1"</span>, <span class="hljs-number">24</span>, TimeUnit.HOURS);
}
</code></pre>
<p>é—®é¢˜ï¼šå¦‚æœæ­¥éª¤ 1 æ‰§è¡ŒæˆåŠŸï¼Œä½†æ­¥éª¤ 2 æ‰§è¡Œå¤±è´¥ï¼ˆæ¯”å¦‚ Redis å®•æœºï¼‰ï¼Œæ­¤æ—¶äº‹åŠ¡ä¼šå›æ»šå—ï¼Ÿä¸ä¼šï¼å› ä¸ºæ­¥éª¤ 2 æ˜¯ Redis æ“ä½œï¼Œä¸åœ¨æ•°æ®åº“äº‹åŠ¡çš„ç®¡è¾–èŒƒå›´å†…ã€‚æœ€ç»ˆç»“æœæ˜¯ï¼šè®¢å•çŠ¶æ€å·²ç»æ›´æ–°ä¸ºâ€œå·²æ”¯ä»˜â€ï¼Œä½† Redis ä¸­æ²¡æœ‰æ ‡è®°â€œå·²å¤„ç†â€â€”â€”å½“ä¸‹æ¬¡é‡å¤æ¶ˆæ¯åˆ°æ¥æ—¶ï¼Œä¼šå†æ¬¡æ‰§è¡Œæ­¥éª¤ 1ï¼Œå¯¼è‡´è®¢å•çŠ¶æ€è¢«é‡å¤æ›´æ–°ï¼ˆè™½ç„¶çŠ¶æ€æœºå¯èƒ½é˜»æ­¢ï¼Œä½†å¦‚æœæ˜¯å…¶ä»–ä¸šåŠ¡å¯èƒ½å‡ºé—®é¢˜ï¼‰ã€‚</p>
<p>æ›´ä¸¥é‡çš„æƒ…å†µï¼šå¦‚æœæ­¥éª¤ 2 å…ˆæ‰§è¡Œï¼ˆæ ‡è®°å·²å¤„ç†ï¼‰ï¼Œæ­¥éª¤ 1 æ‰§è¡Œå¤±è´¥ï¼ˆäº‹åŠ¡å›æ»šï¼‰ï¼Œä¼šå¯¼è‡´â€œæ ‡è®°å·²å¤„ç†ï¼Œä½†ä¸šåŠ¡æ²¡æ‰§è¡Œâ€â€”â€”åç»­è¯·æ±‚éƒ½ä¼šè¢«å½“æˆé‡å¤è¯·æ±‚ï¼Œç›´æ¥è¿”å›ï¼Œå¯¼è‡´ä¸šåŠ¡ä¸¢å¤±ã€‚</p>
<p>æ­£ç¡®åšæ³•ï¼š</p>
<ul>
<li>
<p>å¦‚æœç”¨æ•°æ®åº“å»é‡ï¼ˆæ¯”å¦‚æ–¹æ¡ˆä¸€ã€æ–¹æ¡ˆå››çš„æ•°æ®åº“å»é‡è¡¨ï¼‰ï¼Œä¸€å®šè¦æŠŠâ€œæ ‡è®°å·²å¤„ç†â€å’Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘æ”¾åœ¨åŒä¸€ä¸ªäº‹åŠ¡é‡Œâ€”â€”ç”¨æ•°æ®åº“äº‹åŠ¡ä¿è¯ä¸¤è€…çš„åŸå­æ€§</p>
</li>
<li>
<p>å¦‚æœç”¨ Redis å»é‡ï¼Œè¦é‡‡ç”¨â€œå…ˆæ‰§è¡Œä¸šåŠ¡ï¼Œå†æ ‡è®°å·²å¤„ç†â€çš„é¡ºåºï¼Œå¹¶ä¸”æ¥å—â€œæç«¯æƒ…å†µä¸‹å¯èƒ½é‡å¤å¤„ç†â€çš„é£é™©ï¼ˆå› ä¸º Redis ä¸æ”¯æŒäº‹åŠ¡å›æ»šï¼‰ï¼›å¦‚æœæ˜¯æ ¸å¿ƒä¸šåŠ¡ï¼Œå»ºè®®ç”¨æ•°æ®åº“å»é‡è¡¨å…œåº•</p>
</li>
</ul>
<h3 data-id="heading-25">âŒ 3. å¹‚ç­‰ = åå¼‚å¸¸ï¼ˆæ©ç›–é—®é¢˜ï¼‰</h3>
<p>è¿™ä¸ªå‘çš„é”™è¯¯è®¤çŸ¥ï¼šâ€œåªè¦æ˜¯é‡å¤è¯·æ±‚ï¼Œä¸ç®¡ä»€ä¹ˆæƒ…å†µéƒ½è¿”å›æˆåŠŸâ€â€”â€”æŠŠå¹‚ç­‰å½“æˆäº†â€œåå¼‚å¸¸â€çš„é®ç¾å¸ƒã€‚æ¯”å¦‚ï¼š</p>
<pre><code class="hljs language-java" lang="java">
<span class="hljs-comment">// é”™è¯¯ä»£ç ï¼šå¹‚ç­‰ = åå¼‚å¸¸</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">createOrder</span><span class="hljs-params">(CreateOrderDTO dto)</span> {
    <span class="hljs-keyword">try</span> {
        orderMapper.insert(dto);
    } <span class="hljs-keyword">catch</span> (Exception e) {
        <span class="hljs-comment">// ä¸ç®¡ä»€ä¹ˆå¼‚å¸¸ï¼Œéƒ½å½“æˆé‡å¤è¯·æ±‚è¿”å›æˆåŠŸ</span>
        log.error(<span class="hljs-string">"åˆ›å»ºè®¢å•å¤±è´¥"</span>, e);
        <span class="hljs-keyword">return</span>;
    }
}
</code></pre>
<p>é—®é¢˜ï¼šå¦‚æœæ˜¯çœŸæ­£çš„ä¸šåŠ¡å¼‚å¸¸ï¼ˆæ¯”å¦‚åº“å­˜ä¸è¶³ã€å‚æ•°é”™è¯¯ï¼‰ï¼Œä¹Ÿä¼šè¢«å½“æˆé‡å¤è¯·æ±‚ï¼Œç›´æ¥è¿”å›æˆåŠŸâ€”â€”ç”¨æˆ·ä»¥ä¸ºè®¢å•åˆ›å»ºæˆåŠŸï¼Œä½†å®é™…ä¸Šå¹¶æ²¡æœ‰ï¼Œå¯¼è‡´ç”¨æˆ·æŠ•è¯‰ï¼›åŒæ—¶ï¼Œå¼€å‘äººå‘˜æ— æ³•åŠæ—¶å‘ç°ä¸šåŠ¡é—®é¢˜ï¼Œå› ä¸ºå¼‚å¸¸è¢«åæ‰äº†ã€‚</p>
<p>æ­£ç¡®åšæ³•ï¼š</p>
<blockquote>
<p><strong>å¹‚ç­‰åªå¤„ç†â€œé‡å¤è¯·æ±‚â€çš„å¼‚å¸¸ï¼Œä¸å¤„ç†â€œä¸šåŠ¡é€»è¾‘â€çš„å¼‚å¸¸ã€‚</strong></p>
</blockquote>
<p>æ¯”å¦‚æ–¹æ¡ˆä¸€ä¸­ï¼Œåªæ•è·â€œDuplicateKeyExceptionâ€ï¼ˆå”¯ä¸€ç´¢å¼•å†²çªï¼Œä»£è¡¨é‡å¤è¯·æ±‚ï¼‰ï¼Œå…¶ä»–å¼‚å¸¸ï¼ˆæ¯”å¦‚åº“å­˜ä¸è¶³çš„ BizExceptionï¼‰è¦æ­£å¸¸æŠ›å‡ºï¼Œè®©ä¸Šå±‚å¤„ç†ï¼ˆæ¯”å¦‚è¿”å›é”™è¯¯ä¿¡æ¯ç»™ç”¨æˆ·ï¼‰ã€‚</p>
<p>æ ¸å¿ƒåŸåˆ™ï¼šå¹‚ç­‰æ˜¯â€œä¿è¯é‡å¤è¯·æ±‚çš„ç»“æœä¸€è‡´â€ï¼Œè€Œä¸æ˜¯â€œæ©ç›–æ‰€æœ‰å¼‚å¸¸â€ã€‚</p>
<hr/>
<h2 data-id="heading-26">ä¸ƒã€å¹‚ç­‰ä¸åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆç›¸è¾…ç›¸æˆï¼‰</h2>
<p>å¾ˆå¤šäººä¼šæŠŠâ€œå¹‚ç­‰â€å’Œâ€œåˆ†å¸ƒå¼äº‹åŠ¡â€åˆ†å¼€çœ‹ï¼Œä½†å®é™…ä¸Šï¼Œä¸¤è€…æ˜¯ç›¸è¾…ç›¸æˆçš„â€”â€”æ²¡æœ‰å¹‚ç­‰ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡å°±è·‘ä¸èµ·æ¥ã€‚</p>
<p>ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºåˆ†å¸ƒå¼äº‹åŠ¡çš„æ ¸å¿ƒæ˜¯â€œè·¨æœåŠ¡çš„åè°ƒâ€ï¼Œè€Œåè°ƒè¿‡ç¨‹ä¸­å¿…ç„¶ä¼šå‡ºç°é‡è¯•ï¼ˆæ¯”å¦‚ Saga æ¨¡å¼çš„è¡¥å¿é‡è¯•ã€TCC æ¨¡å¼çš„ Confirm/Cancel é‡è¯•ï¼‰ã€‚å¦‚æœè¿™äº›é‡è¯•çš„æ¥å£æ²¡æœ‰åšå¹‚ç­‰ï¼Œå°±ä¼šå¯¼è‡´é‡å¤å¤„ç†ï¼Œå¼•å‘æ•°æ®ä¸ä¸€è‡´ã€‚</p>
<p>ä¸‹é¢æ˜¯å¸¸è§åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯ä¸­ï¼Œå¹‚ç­‰çš„ä½œç”¨ï¼š</p>





















<table><thead><tr><th>åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯</th><th>å¹‚ç­‰çš„ä½œç”¨</th></tr></thead><tbody><tr><td>Saga æ¨¡å¼</td><td>Saga åˆ†ä¸ºâ€œæ­£å‘æµç¨‹â€å’Œâ€œè¡¥å¿æµç¨‹â€ï¼Œå½“æ­£å‘æµç¨‹æŸä¸€æ­¥å¤±è´¥æ—¶ï¼Œä¼šé‡è¯•è¡¥å¿æµç¨‹ï¼›å¦‚æœè¡¥å¿æ¥å£æ²¡æœ‰åšå¹‚ç­‰ï¼Œå¤šæ¬¡è¡¥å¿ä¼šå¯¼è‡´æ•°æ®é”™è¯¯ï¼ˆæ¯”å¦‚é‡å¤é€€æ¬¾ï¼‰</td></tr><tr><td>TCC æ¨¡å¼</td><td>TCC çš„ Confirmï¼ˆç¡®è®¤ï¼‰å’Œ Cancelï¼ˆå–æ¶ˆï¼‰æ¥å£å¯èƒ½å› ç½‘ç»œé—®é¢˜è¢«é‡è¯•ï¼›å¦‚æœè¿™äº›æ¥å£æ²¡æœ‰åšå¹‚ç­‰ï¼Œä¼šå¯¼è‡´é‡å¤æ‰£å‡/é‡Šæ”¾èµ„æºï¼ˆæ¯”å¦‚é‡å¤æ‰£åº“å­˜ï¼‰</td></tr><tr><td>MQ äº‹åŠ¡æ¶ˆæ¯</td><td>äº‹åŠ¡æ¶ˆæ¯çš„â€œæäº¤â€æˆ–â€œå›æ»šâ€å¯èƒ½è¢«é‡è¯•ï¼Œæ¶ˆè´¹ç«¯ä¹Ÿä¼šæ”¶åˆ°é‡å¤æ¶ˆæ¯ï¼›å¹‚ç­‰èƒ½ä¿è¯é‡è¯•å’Œé‡å¤æ¶ˆæ¯ä¸ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´</td></tr></tbody></table>
<p>ä¸€å¥è¯æ€»ç»“ï¼š</p>
<blockquote>
<p><strong>æ²¡æœ‰å¹‚ç­‰ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡è·‘ä¸èµ·æ¥ï¼›æœ‰äº†å¹‚ç­‰ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡æ‰èƒ½æ›´ç¨³å®šã€‚</strong></p>
</blockquote>
<hr/>
<h2 data-id="heading-27">å…«ã€æ¨èçš„ Java æŠ€æœ¯ç»„åˆï¼ˆè½åœ°å‚è€ƒï¼‰</h2>
<p>ç»“åˆå‰é¢çš„æ–¹æ¡ˆï¼Œè¿™é‡Œç»™å‡ºä¸€å¥—å·¥ä¸šç•Œå¸¸ç”¨çš„ Java æŠ€æœ¯ç»„åˆï¼Œè¦†ç›–å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯ï¼š</p>
<ul>
<li>
<p><strong>æ ¸å¿ƒæ¡†æ¶</strong>ï¼šSpring Boot / Spring Cloudï¼ˆæˆç†Ÿç¨³å®šï¼Œç”Ÿæ€å®Œå–„ï¼‰</p>
</li>
<li>
<p><strong>æ•°æ®å­˜å‚¨</strong>ï¼šMySQLï¼ˆå”¯ä¸€ç´¢å¼• + çŠ¶æ€æœº + å»é‡è¡¨ï¼Œä¿è¯å¼ºä¸€è‡´æ€§ï¼‰</p>
</li>
<li>
<p><strong>ç¼“å­˜</strong>ï¼šRedisï¼ˆToken é˜²é‡å¤æäº¤ + éæ ¸å¿ƒæ¶ˆæ¯å»é‡ï¼Œæå‡æ€§èƒ½ï¼‰</p>
</li>
<li>
<p><strong>æ¶ˆæ¯ä¸­é—´ä»¶</strong>ï¼šRocketMQ / Kafkaï¼ˆæ”¯æŒäº‹åŠ¡æ¶ˆæ¯ï¼Œé€‚é…é«˜å¹¶å‘åœºæ™¯ï¼‰</p>
</li>
<li>
<p><strong>ORM æ¡†æ¶</strong>ï¼šMyBatis-Plusï¼ˆç®€åŒ–æ•°æ®åº“æ“ä½œï¼Œæ”¯æŒä¹è§‚é”æ’ä»¶ï¼‰</p>
</li>
</ul>
<p>ç»éªŒæ€»ç»“ï¼Œè®°ä¸‹æ¥ç›´æ¥ç”¨ï¼š</p>
<blockquote>
<p><strong>æ ¸å¿ƒé“¾è·¯é  DBï¼Œå¤–å›´é˜²æŠ–ç”¨ Redisã€‚</strong></p>
</blockquote>
<ul>
<li>
<p>æ ¸å¿ƒé“¾è·¯ï¼ˆä¸‹å•ã€æ”¯ä»˜ã€é€€æ¬¾ï¼‰ï¼šç”¨â€œå”¯ä¸€ä¸šåŠ¡ ID + å”¯ä¸€ç´¢å¼•â€å…œåº•ï¼Œç»“åˆâ€œçŠ¶æ€æœº + ä¹è§‚é”â€ä¼˜åŒ–å¹¶å‘æ€§èƒ½</p>
</li>
<li>
<p>å¤–å›´é“¾è·¯ï¼ˆè¡¨å•æäº¤ã€é€šçŸ¥æ¨é€ã€æ´»åŠ¨æŠ¥åï¼‰ï¼šç”¨â€œToken + Redisâ€é˜²é‡å¤æäº¤ï¼Œç®€å•é«˜æ•ˆ</p>
</li>
<li>
<p>MQ æ¶ˆè´¹ï¼šæ ¸å¿ƒæ¶ˆæ¯ç”¨â€œæ•°æ®åº“å»é‡è¡¨â€ï¼Œéæ ¸å¿ƒæ¶ˆæ¯ç”¨â€œRedis å»é‡â€</p>
</li>
</ul>
<hr/>
<h2 data-id="heading-28">ä¹ã€æ€»ç»“ï¼ˆæ ¸å¿ƒè§‚ç‚¹å†å¼ºè°ƒï¼‰</h2>
<p>æœ€åç”¨å‡ å¥è¯æ€»ç»“å…¨æ–‡ï¼Œå¸®å¤§å®¶æ¢³ç†æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼š</p>
<ol>
<li>
<p>å¹‚ç­‰ä¸æ˜¯é«˜çº§æŠ€å·§ï¼Œè€Œæ˜¯åˆ†å¸ƒå¼é«˜å¹¶å‘ç³»ç»Ÿçš„â€œå…¥åœºåˆ¸â€â€”â€”ä½ å¯ä»¥æš‚æ—¶æ²¡é‡åˆ°å¹‚ç­‰é—®é¢˜ï¼Œä½†é«˜å¹¶å‘ä¸€å®šä¼šå¸®ä½ é‡åˆ°</p>
</li>
<li>
<p>å¹‚ç­‰çš„æœ¬è´¨æ˜¯â€œåˆ¤æ–­è¯·æ±‚æ˜¯å¦å·²å¤„ç†â€ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯â€œå”¯ä¸€æ ‡è¯†ã€çŠ¶æ€ä¸å¯é€†ã€å»é‡è®°å½•â€</p>
</li>
<li>
<p>4 ç§ä¸»æµæ–¹æ¡ˆå„æœ‰é€‚ç”¨åœºæ™¯ï¼šå”¯ä¸€ç´¢å¼•æœ€ç¨³ï¼ŒçŠ¶æ€æœºé€‚åˆè®¢å•ï¼ŒToken é€‚åˆè¡¨å•ï¼ŒMQ å»é‡åˆ†æ ¸å¿ƒ/éæ ¸å¿ƒ</p>
</li>
<li>
<p>é¿å‘é‡ç‚¹ï¼šåˆ«ç”¨â€œå…ˆæŸ¥åå†™â€ï¼Œå¹‚ç­‰é€»è¾‘è¦åœ¨äº‹åŠ¡é‡Œï¼Œåˆ«æŠŠå¹‚ç­‰å½“æˆåå¼‚å¸¸çš„é®ç¾å¸ƒ</p>
</li>
<li>
<p>æŠ€æœ¯ç»„åˆåŸåˆ™ï¼šæ ¸å¿ƒé“¾è·¯é  DB ä¿è¯å¼ºä¸€è‡´ï¼Œå¤–å›´é“¾è·¯ç”¨ Redis æå‡æ€§èƒ½</p>
</li>
</ol>
<p>æœ€åå†é€å¤§å®¶ä¸€å¥å®æˆ˜æ„Ÿæ‚Ÿï¼š</p>
<blockquote>
<p><strong>åšå¹‚ç­‰ä¸æ˜¯ä¸ºäº†â€œè§£å†³é—®é¢˜â€ï¼Œè€Œæ˜¯ä¸ºäº†â€œé¿å…é—®é¢˜â€â€”â€”åœ¨é«˜å¹¶å‘çš„ä¸–ç•Œé‡Œï¼Œé¢„é˜²æ°¸è¿œæ¯”æ•‘ç«æ›´é‡è¦ã€‚</strong></p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€æ·±åº¦è§£æã€‘ä¸ºä»€ä¹ˆC++æœ‰äº†mallocï¼Œè¿˜éœ€è¦newï¼Ÿ]]></title>    <link>https://juejin.cn/post/7592921639464828970</link>    <guid>https://juejin.cn/post/7592921639464828970</guid>    <pubDate>2026-01-09T06:45:25.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592921639464828970" data-draft-id="7592921639464812586" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€æ·±åº¦è§£æã€‘ä¸ºä»€ä¹ˆC++æœ‰äº†mallocï¼Œè¿˜éœ€è¦newï¼Ÿ"/> <meta itemprop="keywords" content="åç«¯"/> <meta itemprop="datePublished" content="2026-01-09T06:45:25.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ç äº‹æ¼«è°ˆ"/> <meta itemprop="url" content="https://juejin.cn/user/1972974802965230"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€æ·±åº¦è§£æã€‘ä¸ºä»€ä¹ˆC++æœ‰äº†mallocï¼Œè¿˜éœ€è¦newï¼Ÿ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1972974802965230/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ç äº‹æ¼«è°ˆ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T06:45:25.000Z" title="Fri Jan 09 2026 06:45:25 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»8åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p><img src="https://p3-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/c6db449a842d4b658d7902b089f9dcf0~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg56CB5LqL5ryr6LCI:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768545925&amp;x-signature=Zwt72GxDtpj%2FHARfglaY4bWi4G0%3D" alt="image.png" loading="lazy"/></p>
<p>å¦‚æœä½ æ˜¯Cç¨‹åºå‘˜è½¬å‘C++ï¼Œä¸€å®šä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼š<strong>ä¸ºä»€ä¹ˆC++åœ¨æœ‰äº†<code>malloc</code>è¿™ä¸ªæˆç†Ÿçš„å†…å­˜åˆ†é…å‡½æ•°åï¼Œè¿˜è¦å¼•å…¥<code>new</code>è¿™ä¸ªçœ‹èµ·æ¥åŠŸèƒ½ç›¸ä¼¼çš„æ“ä½œç¬¦ï¼Ÿ</strong> è¿™éš¾é“ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾å—ï¼Ÿ</p>
<p>è®©æˆ‘ç”¨ä¸€ä¸ªç”ŸåŠ¨çš„æ¯”å–»å¼€å§‹ï¼š<code>malloc</code>å°±åƒä¸€ä¸ªæˆ¿åœ°äº§å•†ï¼Œä»–åªè´Ÿè´£ç»™ä½ ä¸€å—ç©ºåœ°ï¼›è€Œ<code>new</code>æ˜¯ä¸€ä¸ªå®Œæ•´çš„å»ºç­‘å…¬å¸ï¼Œä¸ä»…ç»™ä½ åœŸåœ°ï¼Œè¿˜æŒ‰ç…§ä½ çš„è¦æ±‚å»ºå¥½æˆ¿å­ï¼Œå®Œæˆè£…ä¿®ï¼Œç”šè‡³æŠŠå®¶å…·éƒ½æ‘†å¥½ã€‚</p>
<h2 data-id="heading-0">ç¬¬ä¸€ç« ï¼šä»è¡¨é¢ç°è±¡çœ‹èµ·â€”â€”ä¸€æ®µä»¤äººæ²®ä¸§çš„ä»£ç </h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ç±»ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Student</span> {
<span class="hljs-keyword">public</span>:
    string name;
    <span class="hljs-type">int</span> age;
    <span class="hljs-built_in">Student</span>(string n, <span class="hljs-type">int</span> a) : <span class="hljs-built_in">name</span>(n), <span class="hljs-built_in">age</span>(a) {
        cout &lt;&lt; <span class="hljs-string">"åˆ›å»ºå­¦ç”Ÿï¼š"</span> &lt;&lt; n &lt;&lt; endl;
    }
    ~<span class="hljs-built_in">Student</span>() {
        cout &lt;&lt; <span class="hljs-string">"é”€æ¯å­¦ç”Ÿï¼š"</span> &lt;&lt; name &lt;&lt; endl;
    }
};
</code></pre>
<h3 data-id="heading-1">ç¬¬ä¸€æ¬¡å°è¯•ï¼šç”¨mallocåˆ›å»ºå¯¹è±¡</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// Cç¨‹åºå‘˜ä¼šå¾ˆè‡ªç„¶åœ°è¿™æ ·å†™ï¼š</span>
Student* s1 = (Student*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(Student));
s1-&gt;name = <span class="hljs-string">"å¼ ä¸‰"</span>;  <span class="hljs-comment">// ç¼–è¯‘é”™è¯¯ï¼</span>
s1-&gt;age = <span class="hljs-number">20</span>;      <span class="hljs-comment">// å±é™©çš„æ“ä½œï¼</span>
</code></pre>
<p><strong>é—®é¢˜å‡ºç°äº†</strong>ï¼šç¼–è¯‘å™¨ä¼šå‘Šè¯‰æˆ‘ä»¬ï¼Œstringå¯¹è±¡æ²¡æœ‰é»˜è®¤æ„é€ ï¼Œä¸èƒ½ç›´æ¥èµ‹å€¼ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå³ä½¿èƒ½èµ‹å€¼ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡æœ‰è°ƒç”¨æ„é€ å‡½æ•°ï¼Œè™šå‡½æ•°è¡¨ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ä¹Ÿæ²¡æœ‰åˆå§‹åŒ–ã€‚</p>
<h3 data-id="heading-2">ç¬¬äºŒæ¬¡å°è¯•ï¼šå¯»æ‰¾è§£å†³æ–¹æ¡ˆ</h3>
<p>ä½ å¯èƒ½ä¼šæƒ³ï¼š"é‚£æˆ‘èƒ½ä¸èƒ½mallocä¹‹åæ‰‹åŠ¨è°ƒç”¨æ„é€ å‡½æ•°å‘¢ï¼Ÿ"</p>
<pre><code class="hljs language-cpp" lang="cpp">Student* s2 = (Student*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(Student));
s2-&gt;<span class="hljs-built_in">Student</span>(<span class="hljs-string">"æå››"</span>, <span class="hljs-number">21</span>);  <span class="hljs-comment">// è¯­æ³•é”™è¯¯ï¼ä¸èƒ½è¿™æ ·è°ƒç”¨æ„é€ å‡½æ•°</span>
</code></pre>
<p><strong>åˆä¸€ä¸ªé—®é¢˜</strong>ï¼šC++ä¸å…è®¸ç›´æ¥è°ƒç”¨æ„é€ å‡½æ•°ï¼Œè¿™æ˜¯è¯­è¨€è®¾è®¡ä¸Šçš„é™åˆ¶ã€‚</p>
<h2 data-id="heading-3">ç¬¬äºŒç« ï¼šnewçš„ç™»åœºâ€”â€”è§£å†³é—®é¢˜çš„å…³é”®</h2>
<h3 data-id="heading-4">newçš„ç®€å•ç”¨æ³•</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// C++çš„æ–¹å¼å¦‚æ­¤ç®€æ´ï¼š</span>
Student* s3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Student</span>(<span class="hljs-string">"ç‹äº”"</span>, <span class="hljs-number">22</span>);
<span class="hljs-comment">// ä¸€åˆ‡æ­£å¸¸ï¼å¯¹è±¡è¢«å®Œæ•´åˆ›å»º</span>
</code></pre>
<p><strong>å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</strong> <code>new</code>åœ¨è¿™é‡Œåšäº†ä¸‰ä»¶äº‹ï¼š</p>
<ol>
<li>è®¡ç®—<code>Student</code>ç±»éœ€è¦çš„å†…å­˜å¤§å°</li>
<li>åˆ†é…è¶³å¤Ÿçš„å†…å­˜</li>
<li>è°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–å¯¹è±¡</li>
</ol>
<h3 data-id="heading-5">å¯¹æ¯”å®éªŒï¼šçœ‹çœ‹èƒŒåå·®å¼‚</h3>
<p>è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­çœ‹æ¸…æœ¬è´¨ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Complex</span> {
    vector&lt;<span class="hljs-type">int</span>&gt; data;  <span class="hljs-comment">// åŠ¨æ€å®¹å™¨</span>
    string name;       <span class="hljs-comment">// å­—ç¬¦ä¸²å¯¹è±¡</span>
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">Complex</span>(string n) : <span class="hljs-built_in">name</span>(n), <span class="hljs-built_in">data</span>(<span class="hljs-number">100</span>) {
        cout &lt;&lt; name &lt;&lt; <span class="hljs-string">"æ„é€ å®Œæˆï¼Œæ‹¥æœ‰"</span> &lt;&lt; data.<span class="hljs-built_in">size</span>() &lt;&lt; <span class="hljs-string">"ä¸ªå…ƒç´ \n"</span>;
    }
    ~<span class="hljs-built_in">Complex</span>() {
        cout &lt;&lt; name &lt;&lt; <span class="hljs-string">"è¢«é”€æ¯\n"</span>;
    }
};

<span class="hljs-comment">// æµ‹è¯•1ï¼šä½¿ç”¨mallocï¼ˆæ³¨å®šå¤±è´¥ï¼‰</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test_malloc</span><span class="hljs-params">()</span> </span>{
    Complex* c = (Complex*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(Complex));
    <span class="hljs-comment">// æ­¤æ—¶c-&gt;dataå’Œc-&gt;nameéƒ½æ˜¯æœªåˆå§‹åŒ–çš„ï¼</span>
    <span class="hljs-comment">// å°è¯•ä½¿ç”¨å®ƒä»¬ä¼šå¯¼è‡´æœªå®šä¹‰è¡Œä¸º</span>
    <span class="hljs-comment">// è€Œä¸”æˆ‘ä»¬æ— æ³•è°ƒç”¨æ„é€ å‡½æ•°</span>
}

<span class="hljs-comment">// æµ‹è¯•2ï¼šä½¿ç”¨newï¼ˆå®Œç¾å·¥ä½œï¼‰</span>
<span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">test_new</span><span class="hljs-params">()</span> </span>{
    Complex* c = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Complex</span>(<span class="hljs-string">"æµ‹è¯•å¯¹è±¡"</span>);
    <span class="hljs-comment">// c-&gt;dataå·²ç»è¢«åˆå§‹åŒ–ä¸º100ä¸ªå…ƒç´ çš„vector</span>
    <span class="hljs-comment">// c-&gt;nameå·²ç»è¢«è®¾ç½®ä¸º"æµ‹è¯•å¯¹è±¡"</span>
    <span class="hljs-keyword">delete</span> c;  <span class="hljs-comment">// è‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°</span>
}
</code></pre>
<h2 data-id="heading-6">ç¬¬ä¸‰ç« ï¼šæ·±å…¥åŸç†â€”â€”ä¸ºä»€ä¹ˆmallocåšä¸åˆ°ï¼Ÿ</h2>
<h3 data-id="heading-7">æ„é€ å‡½æ•°çš„ç‰¹æ®Šæ€§</h3>
<p>æ„é€ å‡½æ•°åœ¨C++ä¸­æ˜¯ä¸€ä¸ª<strong>ç‰¹æ®Šçš„å­˜åœ¨</strong>ï¼Œå®ƒï¼š</p>
<ol>
<li><strong>æ²¡æœ‰åå­—å¯ä»¥è°ƒç”¨</strong>ï¼šä½ ä¸èƒ½åƒæ™®é€šå‡½æ•°é‚£æ ·è°ƒç”¨<code>obj.Constructor()</code></li>
<li><strong>æ²¡æœ‰è¿”å›å€¼</strong>ï¼šç”šè‡³ä¸æ˜¯voidç±»å‹</li>
<li><strong>è‡ªåŠ¨è°ƒç”¨æœºåˆ¶</strong>ï¼šåªåœ¨å¯¹è±¡åˆ›å»ºæ—¶ç”±ç¼–è¯‘å™¨è‡ªåŠ¨å®‰æ’è°ƒç”¨</li>
</ol>
<p><strong>è®¾è®¡å“²å­¦</strong>ï¼šæ„é€ å‡½æ•°æ˜¯å¯¹è±¡"è¯ç”Ÿ"çš„æ—¶åˆ»ï¼Œè¿™ä¸ªæ—¶åˆ»åº”è¯¥ç”±è¯­è¨€æœºåˆ¶ä¿è¯ï¼Œè€Œä¸æ˜¯ç¨‹åºå‘˜æ‰‹åŠ¨æ§åˆ¶ã€‚</p>
<h3 data-id="heading-8">è™šå‡½æ•°è¡¨çš„ç§˜å¯†</h3>
<p>å¯¹äºæœ‰è™šå‡½æ•°çš„ç±»ï¼Œé—®é¢˜æ›´ä¸¥é‡ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Animal</span> {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-keyword">virtual</span> <span class="hljs-type">void</span> <span class="hljs-title">speak</span><span class="hljs-params">()</span> </span>= <span class="hljs-number">0</span>;
    <span class="hljs-keyword">virtual</span> ~<span class="hljs-built_in">Animal</span>() {}
};

<span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> : <span class="hljs-keyword">public</span> Animal {
<span class="hljs-keyword">public</span>:
    <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">speak</span><span class="hljs-params">()</span> <span class="hljs-keyword">override</span> </span>{ cout &lt;&lt; <span class="hljs-string">"æ±ªæ±ªï¼\n"</span>; }
};

<span class="hljs-comment">// å±é™©çš„å°è¯•ï¼š</span>
Animal* a = (Animal*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(Dog));
a-&gt;<span class="hljs-built_in">speak</span>();  <span class="hljs-comment">// ç¾éš¾ï¼è™šå‡½æ•°è¡¨æŒ‡é’ˆæœªåˆå§‹åŒ–</span>
</code></pre>
<p>æ¯ä¸ªæœ‰è™šå‡½æ•°çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªéšè—çš„<strong>è™šå‡½æ•°è¡¨æŒ‡é’ˆ</strong>ï¼Œè¿™ä¸ªæŒ‡é’ˆå¿…é¡»åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ã€‚<code>malloc</code>å®Œå…¨ä¸çŸ¥é“è¿™ä¸ªæŒ‡é’ˆçš„å­˜åœ¨ï¼Œè€Œ<code>new</code>ä¼šæ­£ç¡®å¤„ç†ã€‚</p>
<h2 data-id="heading-9">ç¬¬å››ç« ï¼šæ‰‹åŠ¨æ„é€ çš„æ¡¥æ¢â€”â€”placement new</h2>
<h3 data-id="heading-10">å‘ç°è§£å†³æ–¹æ¡ˆ</h3>
<p>æ—¢ç„¶ä¸èƒ½ç›´æ¥è°ƒç”¨æ„é€ å‡½æ•°ï¼ŒC++æä¾›äº†<strong>placement new</strong>è¿™ä¸ªæœºåˆ¶ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;new&gt;</span>  <span class="hljs-comment">// å¿…é¡»åŒ…å«è¿™ä¸ªå¤´æ–‡ä»¶</span></span>

<span class="hljs-type">void</span>* memory = <span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(Student));
Student* s = <span class="hljs-built_in">new</span>(memory) <span class="hljs-built_in">Student</span>(<span class="hljs-string">"èµµå…­"</span>, <span class="hljs-number">23</span>);  <span class="hljs-comment">// placement newï¼</span>
</code></pre>
<p><strong>è¿™æ˜¯ä»€ä¹ˆé­”æ³•ï¼Ÿ</strong> <code>new(memory)</code>çš„æ„æ€æ˜¯ï¼š"åœ¨<code>memory</code>æŒ‡å‘çš„å†…å­˜ä½ç½®ä¸Šæ„é€ ä¸€ä¸ªå¯¹è±¡"ã€‚</p>
<h3 data-id="heading-11">å®Œæ•´çš„æ‰‹åŠ¨ç®¡ç†æµç¨‹</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// 1. åˆ†é…åŸå§‹å†…å­˜</span>
<span class="hljs-type">void</span>* raw_mem = <span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(Student));

<span class="hljs-comment">// 2. åœ¨å†…å­˜ä¸Šæ„é€ å¯¹è±¡</span>
Student* student = <span class="hljs-built_in">new</span>(raw_mem) <span class="hljs-built_in">Student</span>(<span class="hljs-string">"é’±ä¸ƒ"</span>, <span class="hljs-number">24</span>);

<span class="hljs-comment">// 3. ä½¿ç”¨å¯¹è±¡</span>
cout &lt;&lt; student-&gt;name &lt;&lt; <span class="hljs-string">" "</span> &lt;&lt; student-&gt;age &lt;&lt; endl;

<span class="hljs-comment">// 4. æ‰‹åŠ¨è°ƒç”¨ææ„å‡½æ•°</span>
student-&gt;~<span class="hljs-built_in">Student</span>();

<span class="hljs-comment">// 5. é‡Šæ”¾å†…å­˜</span>
<span class="hljs-built_in">free</span>(raw_mem);
</code></pre>
<h3 data-id="heading-12">æœ‰è¶£çš„ç°è±¡ï¼šä¸ºä»€ä¹ˆææ„å‡½æ•°å¯ä»¥æ‰‹åŠ¨è°ƒç”¨ï¼Ÿ</h3>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è°ƒç”¨ææ„å‡½æ•°<code>student-&gt;~Student()</code>ï¼Œä½†ä¸èƒ½æ‰‹åŠ¨è°ƒç”¨æ„é€ å‡½æ•°ã€‚è¿™æ˜¯å› ä¸ºï¼š</p>
<ul>
<li><strong>ææ„å‡½æ•°</strong>æ˜¯ä¸€ä¸ªæ™®é€šçš„æˆå‘˜å‡½æ•°ï¼Œåªæ˜¯åå­—ç‰¹æ®Š</li>
<li><strong>æ„é€ å‡½æ•°</strong>æ˜¯è¯­è¨€çº§åˆ«çš„ç‰¹æ®Šæœºåˆ¶ï¼Œä¸æ˜¯æ™®é€šå‡½æ•°</li>
</ul>
<h2 data-id="heading-13">ç¬¬äº”ç« ï¼šè®¾è®¡å“²å­¦â€”â€”ä¸ºä»€ä¹ˆC++è¦è¿™æ ·è®¾è®¡ï¼Ÿ</h2>
<h3 data-id="heading-14">å¼‚å¸¸å®‰å…¨ä¿è¯</h3>
<p>è€ƒè™‘è¿™ä¸ªåœºæ™¯ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourceHolder</span> {
    FILE* file;
<span class="hljs-keyword">public</span>:
    <span class="hljs-built_in">ResourceHolder</span>(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* filename) {
        file = <span class="hljs-built_in">fopen</span>(filename, <span class="hljs-string">"r"</span>);
        <span class="hljs-keyword">if</span> (!file) <span class="hljs-keyword">throw</span> <span class="hljs-built_in">runtime_error</span>(<span class="hljs-string">"æ–‡ä»¶æ‰“å¼€å¤±è´¥"</span>);
        <span class="hljs-comment">// å¯èƒ½è¿˜æœ‰å…¶ä»–å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ“ä½œ</span>
    }
    ~<span class="hljs-built_in">ResourceHolder</span>() {
        <span class="hljs-keyword">if</span> (file) <span class="hljs-built_in">fclose</span>(file);
    }
};

<span class="hljs-comment">// ä½¿ç”¨newï¼šå¼‚å¸¸å®‰å…¨</span>
<span class="hljs-keyword">try</span> {
    ResourceHolder* rh = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ResourceHolder</span>(<span class="hljs-string">"data.txt"</span>);
    <span class="hljs-comment">// å¦‚æœæ„é€ å¤±è´¥ï¼Œnewä¿è¯å†…å­˜è¢«é‡Šæ”¾</span>
    <span class="hljs-keyword">delete</span> rh;
} <span class="hljs-built_in">catch</span> (<span class="hljs-type">const</span> exception&amp; e) {
    <span class="hljs-comment">// å®‰å…¨å¤„ç†å¼‚å¸¸</span>
}

<span class="hljs-comment">// å¦‚æœå…è®¸malloc+æ‰‹åŠ¨æ„é€ ï¼š</span>
ResourceHolder* rh = (ResourceHolder*)<span class="hljs-built_in">malloc</span>(<span class="hljs-built_in">sizeof</span>(ResourceHolder));
<span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// å‡è®¾æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨è°ƒç”¨æ„é€ å‡½æ•°</span>
    rh-&gt;<span class="hljs-built_in">ResourceHolder</span>(<span class="hljs-string">"data.txt"</span>);  <span class="hljs-comment">// å¯èƒ½æŠ›å‡ºå¼‚å¸¸</span>
} <span class="hljs-built_in">catch</span> (...) {
    <span class="hljs-built_in">free</span>(rh);  <span class="hljs-comment">// å®¹æ˜“å¿˜è®°è¿™ä¸ªæ¸…ç†ï¼</span>
    <span class="hljs-keyword">throw</span>;
}
</code></pre>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š<code>new</code>æä¾›äº†<strong>åŸå­æ€§æ“ä½œ</strong>â€”â€”è¦ä¹ˆå¯¹è±¡å®Œæ•´åˆ›å»ºï¼Œè¦ä¹ˆå®Œå…¨å¤±è´¥ä¸”æ²¡æœ‰èµ„æºæ³„æ¼ã€‚</p>
<h3 data-id="heading-15">RAIIåŸåˆ™</h3>
<p>RAIIï¼ˆResource Acquisition Is Initializationï¼‰æ˜¯C++çš„æ ¸å¿ƒè®¾è®¡æ¨¡å¼ï¼š</p>
<ul>
<li><strong>èµ„æºè·å–</strong>å°±æ˜¯<strong>åˆå§‹åŒ–</strong></li>
<li>æ„é€ å‡½æ•°è·å–èµ„æº</li>
<li>ææ„å‡½æ•°é‡Šæ”¾èµ„æº</li>
</ul>
<p><code>new</code>/<code>delete</code>å®Œç¾æ”¯æŒRAIIï¼Œè€Œ<code>malloc</code>/<code>free</code>éœ€è¦æ‰‹åŠ¨ç®¡ç†æ‰€æœ‰ç»†èŠ‚ã€‚</p>
<h2 data-id="heading-16">ç¬¬å…­ç« ï¼šå®é™…åº”ç”¨â€”â€”ä½•æ—¶ä½¿ç”¨ä½•ç§æ–¹å¼ï¼Ÿ</h2>
<h3 data-id="heading-17">ç°ä»£C++çš„æ¨èå®è·µ</h3>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// âœ… æƒ…å†µ1ï¼šåˆ›å»ºå•ä¸ªå¯¹è±¡â€”â€”ä½¿ç”¨new</span>
<span class="hljs-keyword">auto</span>* obj = <span class="hljs-keyword">new</span> <span class="hljs-built_in">MyClass</span>(args);

<span class="hljs-comment">// âœ… æƒ…å†µ2ï¼šåˆ›å»ºå¯¹è±¡æ•°ç»„â€”â€”ä½¿ç”¨new[]</span>
<span class="hljs-keyword">auto</span>* arr = <span class="hljs-keyword">new</span> MyClass[<span class="hljs-number">10</span>];

<span class="hljs-comment">// âœ… æƒ…å†µ3ï¼šéœ€è¦è‡ªå®šä¹‰å†…å­˜ä½ç½®â€”â€”ä½¿ç”¨placement new</span>
<span class="hljs-type">char</span> buffer[<span class="hljs-number">1024</span>];
<span class="hljs-keyword">auto</span>* obj = <span class="hljs-built_in">new</span>(buffer) <span class="hljs-built_in">MyClass</span>(args);

<span class="hljs-comment">// âš ï¸ æƒ…å†µ4ï¼šä¸Cåº“äº¤äº’â€”â€”å¯ä»¥ä½¿ç”¨malloc</span>
<span class="hljs-type">void</span>* data = <span class="hljs-built_in">malloc</span>(size);
<span class="hljs-built_in">c_library_function</span>(data);
<span class="hljs-built_in">free</span>(data);

<span class="hljs-comment">// âŒ å¤§å¤šæ•°ç°ä»£C++ä»£ç ä¸­ï¼šé¿å…ç›´æ¥ä½¿ç”¨new</span>
<span class="hljs-comment">// æ”¹ç”¨æ™ºèƒ½æŒ‡é’ˆï¼š</span>
<span class="hljs-keyword">auto</span> obj = <span class="hljs-built_in">make_unique</span>&lt;MyClass&gt;(args);  <span class="hljs-comment">// æ›´å®‰å…¨ï¼</span>
</code></pre>
<h3 data-id="heading-18">æ€§èƒ½è€ƒè™‘ï¼šçœŸçš„éœ€è¦æ‹…å¿ƒå—ï¼Ÿ</h3>
<p>å¾ˆå¤šäººæ‹…å¿ƒ<code>new</code>æ¯”<code>malloc</code>æ…¢ï¼Œä½†å®é™…ä¸Šï¼š</p>
<ol>
<li>å¯¹äºéœ€è¦åˆå§‹åŒ–çš„å¯¹è±¡ï¼Œ<code>malloc</code>éœ€è¦é¢å¤–çš„åˆå§‹åŒ–æ­¥éª¤</li>
<li>ç¼–è¯‘å™¨å¯ä»¥å¯¹<code>new</code>è¿›è¡Œæ·±åº¦ä¼˜åŒ–</li>
<li>çœŸæ­£çš„æ€§èƒ½ç“¶é¢ˆå¾ˆå°‘æ˜¯å†…å­˜åˆ†é…æœ¬èº«</li>
</ol>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// æ€§èƒ½æµ‹è¯•å¯¹æ¯”</span>
<span class="hljs-keyword">auto</span> start = chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();
<span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
    <span class="hljs-keyword">auto</span>* p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ComplexObject</span>(<span class="hljs-string">"test"</span>);
    <span class="hljs-keyword">delete</span> p;
}
<span class="hljs-keyword">auto</span> end = chrono::high_resolution_clock::<span class="hljs-built_in">now</span>();

<span class="hljs-comment">// é€šå¸¸å·®å¼‚å°äº10%ï¼Œè€Œå®‰å…¨æ€§æå‡æ˜¯å·¨å¤§çš„</span>
</code></pre>
<h2 data-id="heading-19">ç¬¬ä¸ƒç« ï¼šä»æ±‡ç¼–å±‚é¢çœ‹å·®å¼‚</h2>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ç¼–è¯‘å™¨å®é™…ç”Ÿæˆäº†ä»€ä¹ˆä»£ç ï¼š</p>
<pre><code class="hljs language-cpp" lang="cpp"><span class="hljs-comment">// C++æºä»£ç ï¼š</span>
<span class="hljs-function">Student* <span class="hljs-title">create</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Student</span>(<span class="hljs-string">"å°æ˜"</span>, <span class="hljs-number">18</span>);
}

<span class="hljs-comment">// ç¼–è¯‘å™¨ç”Ÿæˆçš„ä¼ªæ±‡ç¼–ï¼ˆx64ï¼‰ï¼š</span>
<span class="hljs-built_in">create</span>():
    push    rbx
    mov     edi, <span class="hljs-number">40</span>          <span class="hljs-meta"># sizeof(Student)ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨è®¡ç®—</span>
    call    <span class="hljs-keyword">operator</span> <span class="hljs-keyword">new</span>     # <span class="hljs-number">1.</span> åˆ†é…å†…å­˜
    
    mov     rbx, rax         # ä¿å­˜æŒ‡é’ˆ
    mov     rdi, rbx         # ä¼ é€’<span class="hljs-keyword">this</span>æŒ‡é’ˆ
    mov     esi, åœ°å€_of_<span class="hljs-string">"å°æ˜"</span>  # ä¼ é€’nameå‚æ•°
    mov     edx, <span class="hljs-number">18</span>          # ä¼ é€’ageå‚æ•°
    call    Studentæ„é€ å‡½æ•°   # <span class="hljs-number">2.</span> è°ƒç”¨æ„é€ å‡½æ•°ï¼å…³é”®æ­¥éª¤ï¼
    
    mov     rax, rbx         # è¿”å›å¯¹è±¡æŒ‡é’ˆ
    pop     rbx
    ret
</code></pre>
<p><strong>å…³é”®ç‚¹</strong>ï¼šæ„é€ å‡½æ•°è°ƒç”¨æ˜¯ç¼–è¯‘å™¨<strong>ç›´æ¥æ’å…¥</strong>çš„ï¼Œä¸æ˜¯è¿è¡Œæ—¶æŸ¥æ‰¾çš„ã€‚</p>
<h2 data-id="heading-20">é€‰æ‹©å“ªç§æ–¹å¼ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h2>
<h3 data-id="heading-21">ç»ˆæç­”æ¡ˆ</h3>
<p><code>malloc</code>å’Œ<code>new</code>ä»£è¡¨äº†ä¸¤ç§ä¸åŒçš„ç¼–ç¨‹å“²å­¦ï¼š</p>






























<table><thead><tr><th>ç‰¹æ€§</th><th><code>malloc</code>/<code>free</code></th><th><code>new</code>/<code>delete</code></th></tr></thead><tbody><tr><td><strong>å“²å­¦</strong></td><td>Cï¼šåˆ†ç¦»å…³æ³¨ç‚¹</td><td>C++ï¼šå¯¹è±¡å®Œæ•´æ€§</td></tr><tr><td><strong>è§†è§’</strong></td><td>å†…å­˜åˆ†é…å™¨</td><td>å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†å™¨</td></tr><tr><td><strong>èŒè´£</strong></td><td>åªç»™ç©ºåœ°</td><td>ç»™åœ°+å»ºæˆ¿+è£…ä¿®</td></tr><tr><td><strong>å®‰å…¨</strong></td><td>ç¨‹åºå‘˜å…¨è´£</td><td>è¯­è¨€æä¾›ä¿è¯</td></tr></tbody></table>
<h3 data-id="heading-22">ç°ä»£C++çš„æœ€ä½³å®è·µ</h3>
<ol>
<li><strong>é»˜è®¤ä½¿ç”¨new/delete</strong>â€”â€”å½“ä½ éœ€è¦åˆ›å»ºå¯¹è±¡æ—¶</li>
<li><strong>ä¼˜å…ˆä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ</strong>â€”â€”é¿å…æ‰‹åŠ¨å†…å­˜ç®¡ç†</li>
<li><strong>ä»…åœ¨å¿…è¦æ—¶ç”¨malloc</strong>â€”â€”ä¸Cåº“äº¤äº’ã€å®ç°å†…å­˜æ± ç­‰ä½çº§æ“ä½œ</li>
<li><strong>ç†è§£èƒŒåçš„åŸç†</strong>â€”â€”å³ä½¿ä½¿ç”¨é«˜çº§å·¥å…·ï¼Œä¹Ÿè¦çŸ¥é“åº•å±‚æœºåˆ¶</li>
</ol>
<h3 data-id="heading-23">æœ€åçš„æ€è€ƒ</h3>
<p>å›åˆ°æœ€åˆçš„é—®é¢˜ï¼š<strong>ä¸ºä»€ä¹ˆC++æœ‰äº†mallocè¿˜éœ€è¦newï¼Ÿ</strong></p>
<p>å› ä¸ºC++ä¸ä»…ä»…æ˜¯è¦åˆ†é…å†…å­˜ï¼Œæ›´æ˜¯è¦ç®¡ç†<strong>å¯¹è±¡çš„å®Œæ•´ç”Ÿå‘½å‘¨æœŸ</strong>ã€‚<code>new</code>ä¸æ˜¯<code>malloc</code>çš„æ›¿ä»£å“ï¼Œè€Œæ˜¯C++é¢å‘å¯¹è±¡å“²å­¦çš„ä½“ç°â€”â€”å®ƒå°†å†…å­˜åˆ†é…ã€å¯¹è±¡æ„é€ ã€å¼‚å¸¸å®‰å…¨ã€ç±»å‹ç³»ç»Ÿå®Œç¾åœ°ç»“åˆåœ¨ä¸€èµ·ã€‚</p>
<p>å½“ä½ ä½¿ç”¨<code>new</code>æ—¶ï¼Œä½ ä¸ä»…æ˜¯åœ¨åˆ†é…å†…å­˜ï¼Œæ›´æ˜¯åœ¨å‘Šè¯‰ç¼–è¯‘å™¨ï¼š"è¯·ä¸ºæˆ‘åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ã€ç±»å‹å®‰å…¨çš„ã€å¼‚å¸¸å®‰å…¨çš„å¯¹è±¡ã€‚" è¿™å°±æ˜¯C++çš„åŠ›é‡æ‰€åœ¨ï¼Œä¹Ÿæ˜¯å®ƒåŒºåˆ«äºCçš„æœ¬è´¨ç‰¹å¾ã€‚</p>
<p>è®°ä½ï¼šåœ¨C++ä¸­ï¼Œæˆ‘ä»¬ä¸æ˜¯æ“ä½œå†…å­˜ï¼Œæˆ‘ä»¬æ˜¯ç®¡ç†å¯¹è±¡ã€‚è¿™ä¸ªç†å¿µçš„è½¬å˜ï¼Œæ­£æ˜¯ä»<code>malloc</code>åˆ°<code>new</code>è·¨è¶Šçš„æ ¸å¿ƒã€‚</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[jsx/tsxä½¿ç”¨cssModuleå’Œtypescript-plugin-css-modules]]></title>    <link>https://juejin.cn/post/7592865044692008966</link>    <guid>https://juejin.cn/post/7592865044692008966</guid>    <pubDate>2026-01-09T01:51:30.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7592865044692008966" data-draft-id="7592865044690698246" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="jsx/tsxä½¿ç”¨cssModuleå’Œtypescript-plugin-css-modules"/> <meta itemprop="keywords" content="å‰ç«¯,Vue.js,React.js"/> <meta itemprop="datePublished" content="2026-01-09T01:51:30.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="é¹å¤šå¤š"/> <meta itemprop="url" content="https://juejin.cn/user/747323639737191"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            jsx/tsxä½¿ç”¨cssModuleå’Œtypescript-plugin-css-modules
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/747323639737191/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    é¹å¤šå¤š
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-09T01:51:30.000Z" title="Fri Jan 09 2026 01:51:30 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-09
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>@charset "UTF-8";.markdown-body{word-break:break-word;line-height:2;font-weight:400;font-size:15px;overflow-x:hidden;color:#333;letter-spacing:1.2px}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1:first-child,.markdown-body h2:first-child,.markdown-body h3:first-child,.markdown-body h4:first-child,.markdown-body h5:first-child,.markdown-body h6:first-child{margin-top:-1.5rem;margin-bottom:1rem}.markdown-body h1:before,.markdown-body h2:before,.markdown-body h3:before,.markdown-body h4:before,.markdown-body h5:before,.markdown-body h6:before{content:"#";display:inline-block;color:#3eaf7c;padding-right:.23em}.markdown-body h1{position:relative;font-size:2.5rem;margin-bottom:5px}.markdown-body h1:before{font-size:2.5rem}.markdown-body h2{padding-bottom:.5rem;font-size:2.2rem;border-bottom:1px solid #ececec}.markdown-body h3{font-size:1.5rem;padding-bottom:0}.markdown-body h4{font-size:1.25rem}.markdown-body h5{font-size:1rem}.markdown-body h6{margin-top:5px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body strong{color:#3eaf7c}.markdown-body img{max-width:100%;border-radius:2px;display:block;margin:auto}.markdown-body hr{border:none;border-top:1px solid #3eaf7c;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;overflow-x:auto;padding:.2rem .5rem;margin:0;color:#3eaf7c;font-size:.85em;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75;border:.5rem solid #3eaf7c}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{font-weight:500;text-decoration:none;color:#3eaf7c;margin:0 5px}.markdown-body a:active,.markdown-body a:hover{text-decoration:none;border-bottom:1.5px solid #3eaf7c}.markdown-body a[href^=http]:after{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04MzIgMTI4SDY0MHY2NGgxNDYuNzUyTDUyMS4zNzYgNDU3LjM3Nmw0NS4yNDggNDUuMjQ4TDgzMiAyMzcuMjQ4VjM4NGg2NFYxMjh6IiBmaWxsPSIjM2VhZjdjIi8+PHBhdGggZD0iTTc2OCA4MzJIMTkyVjI1NmgzNTJ2LTY0SDE2MGEzMiAzMiAwIDAwLTMyIDMydjY0MGEzMiAzMiAwIDAwMzIgMzJoNjQwYTMyIDMyIDAgMDAzMi0zMlY0ODBoLTY0djM1MnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");margin-left:2px}.markdown-body a[href^="#"]:before{content:"#"}.markdown-body table{display:inline-block!important;font-size:13px;width:auto;max-width:100%;overflow:auto;border:1px solid #3eaf7c;border-collapse:collapse}.markdown-body thead{background:#3eaf7c;color:#fff;text-align:left}.markdown-body tr:nth-child(2n){background-color:rgba(153,255,188,.1)}.markdown-body td,.markdown-body th{padding:4px 8px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#7b7878;padding:1px 23px;border-left:.5rem solid;border-color:#42b983;background-color:rgba(66,184,131,.1);position:relative;margin:14px 8px 0}.markdown-body blockquote:before{display:inline-block;position:absolute;content:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjUiIGhlaWdodD0iMjUiIHZpZXdCb3g9IjAgMCAyNyAyNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjg2MiAxLjg2MikiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0ibm9uZSI+PGNpcmNsZSBzdHJva2U9IiNGRkYiIHN0cm9rZS13aWR0aD0iMS43MjQiIGZpbGw9IiM0MkI5ODMiIGN4PSIxMS42MzgiIGN5PSIxMS42MzgiIHI9IjExLjYzOCIvPjxwYXRoIGQ9Ik0xNC45NzggNi4yN0E1LjAwNiA1LjAwNiAwIDAwNi42NyA5LjQ2OGE0LjkwMSA0LjkwMSAwIDAwMS43NzMgNC4zNjJjLjMyMy4yNTguNTE0LjY0Ny41MjIgMS4wNnYxLjA2YTIuNjg1IDIuNjg1IDAgMDA1LjM3IDB2LTEuMDA4Yy4wMDItLjM5OC4xNzMtLjc3Ny40Ny0xLjA0MmE1LjAyMyA1LjAyMyAwIDAwLjE3My03LjYzem0tMy4zMzcgMTAuOTY3YTEuMzA0IDEuMzA0IDAgMDEtMS4yODYtMS4yODd2LS4yNzhoMi41NzJ2LjI2MWMwIC43MTMtLjU3MyAxLjI5NC0xLjI4NiAxLjMwNHptMi4yNi00LjQxNWMtLjQ0LjM4My0uNzUuODkzLS44ODcgMS40NmgtMi43NDZhMi44NjggMi44NjggMCAwMC0uOTM4LTEuNTNoLS4wMThhMy40NzYgMy40NzYgMCAwMS0xLjI2OS0zLjE0NSAzLjYxNSAzLjYxNSAwIDAxNy4xOTYuNCAzLjY1IDMuNjUgMCAwMS0xLjMzOCAyLjgxNXoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+");width:25px;height:25px;left:-16px;top:12px}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body details{outline:none;border:none;border-left:4px solid #3eaf7c;padding-left:10px;margin-left:4px}.markdown-body details summary{cursor:pointer;border:none;outline:none;background:#fff;margin:0 -17px}.markdown-body details summary::-webkit-details-marker{color:#3eaf7c}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body ol li::marker{color:#3eaf7c}.markdown-body ul li{list-style:none;padding-left:10px}.markdown-body ul li::marker{content:"â€¢";color:#3eaf7c}.markdown-body ul li.task-list-item:before{content:"";margin-right:0}.markdown-body input[type=checkbox]{vertical-align:text-bottom;box-shadow:inset 0 0 0 10px #fff}.markdown-body input[type=checkbox]:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik04NzcuMDU2IDE0Ni45NDR2NzMwLjExMkgxNDYuOTQ0VjE0Ni45NDRoNzMwLjExMnptMC0xMDQuMjc3SDE0Ni45NDRjLTU3LjYyOCAwLTEwNC4yNzcgNDYuNjQ5LTEwNC4yNzcgMTA0LjI3N3Y3MzAuMTEyYzAgNTcuNjI4IDQ2LjY0OSAxMDQuMjc3IDEwNC4yNzcgMTA0LjI3N2g3MzAuMTEyYzU3LjYyOCAwIDEwNC4yNzctNDYuNjQ5IDEwNC4yNzctMTA0LjI3N1YxNDYuOTQ0YzAtNTcuNjI4LTQ2LjY0OS0xMDQuMjc3LTEwNC4yNzctMTA0LjI3N3oiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}.markdown-body input[type=checkbox]:checked:before{content:url("data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjxkZWZzPjxzdHlsZS8+PC9kZWZzPjxwYXRoIGQ9Ik05MTAuMjA4IDBIMTEzLjc2QTExNC4xMTIgMTE0LjExMiAwIDAwLS4wMzIgMTEzLjc5MlY5MTAuMjRjMCA2Mi41OTIgNTEuMiAxMTMuNzkyIDExMy43OTIgMTEzLjc5Mmg3OTYuNDQ4YzYyLjU5MiAwIDExMy43OTItNTEuMiAxMTMuNzkyLTExMy43OTJWMTEzLjc5MkMxMDI0IDUxLjIgOTcyLjggMCA5MTAuMjA4IDB6bS01MTIgNzk2LjQ0OEwxMTMuNzYgNTEybDc5LjY0OC03OS42NDggMjA0LjggMjA0LjhMODMwLjU2IDIwNC44bDc5LjY0OCA3OS42NDgtNTEyIDUxMnoiIGZpbGw9IiMzZWFmN2MiLz48L3N2Zz4=");position:relative;top:-2px;right:2px}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="agate">.markdown-body pre,.markdown-body pre&gt;code.hljs{background:#333;color:#fff}.hljs-name,.hljs-strong{font-weight:700}.hljs-code,.hljs-emphasis{font-style:italic}.hljs-tag{color:#62c8f3}.hljs-selector-class,.hljs-selector-id,.hljs-template-variable,.hljs-variable{color:#ade5fc}.hljs-bullet,.hljs-string{color:#a2fca2}.hljs-attribute,.hljs-built_in,.hljs-builtin-name,.hljs-quote,.hljs-section,.hljs-title,.hljs-type{color:#ffa}.hljs-bullet,.hljs-number,.hljs-symbol{color:#d36363}.hljs-keyword,.hljs-literal,.hljs-selector-tag{color:#fcc28c}.hljs-code,.hljs-comment,.hljs-deletion{color:#888}.hljs-link,.hljs-regexp{color:#c6b4f0}.hljs-meta{color:#fc9b9b}.hljs-deletion{background-color:#fc9b9b;color:#333}.hljs-addition{background-color:#a2fca2;color:#333}.hljs a{color:inherit}.hljs a:focus,.hljs a:hover{color:inherit;text-decoration:underline}</style><h2 data-id="heading-0">1ï¼Œå‰è¨€</h2>
<p>åœ¨<code>vite/webpack</code>æ­å»ºçš„é¡¹ç›®ä¸­ï¼Œä¸ç®¡æ˜¯<code>vue</code>è¿˜æ˜¯<code>react</code>ï¼Œéƒ½å¯ä»¥å†™<code>jsx/tsx</code>ï¼Œä¸ºäº†é¿å…æ ·å¼æ±¡æŸ“ï¼Œå¸¸ç”¨çš„æ–¹å¼æœ‰ä¸¤ç§ã€‚ä¸€ç§æ˜¯æ¯ä¸ªç»„ä»¶éƒ½ç”¨ä¸€ä¸ªå”¯ä¸€ç±»å<code>class</code>åŒ…è£¹ï¼Œä½¿ç”¨<code>less/scss</code>åµŒå¥—æ ·å¼ã€‚å¦ä¸€ç§æ˜¯ä½¿ç”¨<code>cssModule</code>æ¨¡å—åŒ–ã€‚æœ¬æ–‡å°±åˆ†äº«ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨<code>cssModule</code>ï¼Œå¹¶æ¨èä¸€ä¸ªå¥½ç”¨çš„æ’ä»¶ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmrmckeb%2Ftypescript-plugin-css-modules" target="_blank" title="https://github.com/mrmckeb/typescript-plugin-css-modules" ref="nofollow noopener noreferrer">typescript-plugin-css-modules</a>ï¼Œè®©ä½ åœ¨<code>vscode</code>ä¸­ï¼Œèƒ½æ‹¥æœ‰<code>typeScript</code>ä¸€æ ·çš„æ™ºèƒ½æç¤ºã€‚</p>
<h2 data-id="heading-1">2ï¼Œæ•ˆæœå›¾</h2>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/d0bd5997378846b9b12ef860fc3c02a5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bmP5aSa5aSa:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528289&amp;x-signature=VbpxS6gbIuZsMa9sowhqGPK9ibA%3D" alt="æ•ˆæœå›¾" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/daac9b0cb2cf49139d7978b35c2d8107~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bmP5aSa5aSa:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528289&amp;x-signature=ux2%2BRbzz5sUgV2hQgojwBiXs%2FAE%3D" alt="ç±»å‹æç¤º" loading="lazy"/></p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/7b4f9d8de17a4c47a31f352109a1a179~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bmP5aSa5aSa:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528289&amp;x-signature=rhqaxSgUhgn4IHHMT6GPiTCO1yA%3D" alt="ç±»å‹æç¤º" loading="lazy"/></p>
<h2 data-id="heading-2">3ï¼Œå¦‚ä½•ä½¿ç”¨</h2>
<p>æ³¨ï¼šæœ¬æ–‡å„ç§é…ç½®å‡ä½¿ç”¨<code>vscode</code>ç¼–è¾‘å™¨ã€‚</p>
<h3 data-id="heading-3">3.1ï¼Œå®‰è£…</h3>
<ul>
<li>yarn</li>
</ul>

<pre><code class="hljs language-csharp" lang="csharp">yarn <span class="hljs-keyword">add</span> -D typescript-plugin-css-modules
</code></pre>
<ul>
<li>npm</li>
</ul>

<pre><code class="hljs">npm install -D typescript-plugin-css-modules
</code></pre>
<h3 data-id="heading-4">3.2ï¼Œé…ç½®</h3>
<p>é…ç½®åéœ€è¦é‡å¯<code>vscode</code>ï¼Œç„¶åé¡¹ç›®ä¸­ä½¿ç”¨<code>cssMoudule</code>æ—¶ï¼Œå°±å¯ä»¥äº«å—åˆ°<code>typeScript</code>æç¤ºçš„<code>class</code>ç±»åäº†ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<ul>
<li>é…ç½®<code>tsconfig.json</code></li>
</ul>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"compilerOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"plugins"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span><span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"typescript-plugin-css-modules"</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li>é…ç½®<code>settings.json</code></li>
</ul>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º<code>.vscode</code>æ–‡ä»¶å¤¹ï¼Œåœ¨æ–‡ä»¶å¤¹ä¸­æ–°å»º<code>settings.json</code>ï¼Œå¹¶å†™å…¥å¦‚ä¸‹é…ç½®ï¼Œç”¨äºæŒ‡æ˜ä½¿ç”¨<code>typescript.tsdk</code>çš„ä½ç½®ä»¥åŠå¼€å¯æç¤ºï¼Œå¦‚æœ<code>vscode</code>æœ‰æç¤ºï¼Œè®°å¾—åŒæ„ã€‚</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"typescript.tsdk"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"node_modules/typescript/lib"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"typescript.enablePromptUseWorkspaceTsdk"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p>æ³¨æ„ï¼š<code>cssModule</code>å¯ä»¥ç”¨äº<code>cssï¼Œlessï¼Œscss</code>ç­‰ï¼Œä½¿ç”¨æ—¶ï¼Œ<code>css/less/scss</code>æ–‡ä»¶åç¼€å¿…é¡»ç”±<code>.css/.less/.scss</code>å˜ä¸º <code>.module.css/.module.less/.module.scss</code></p>
</blockquote>
<h2 data-id="heading-5">4ï¼Œç¤ºä¾‹</h2>
<ul>
<li>index.tsx</li>
</ul>
<pre><code class="hljs language-tsx" lang="tsx"><span class="hljs-keyword">import</span> { defineComponent } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>
<span class="hljs-keyword">import</span> styles <span class="hljs-keyword">from</span> <span class="hljs-string">'./index.module.scss'</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineComponent</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'notFound'</span>,
  <span class="hljs-title function_">setup</span>(<span class="hljs-params"/>) {
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">{styles.main_box}</span>&gt;</span>11111&lt;/div &gt;
    )
  }
})
</span></code></pre>
<ul>
<li>index.module.scss</li>
</ul>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-class">.main_box</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">position</span>: relative;
  <span class="hljs-attribute">overflow</span>: hidden;
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#ffffff</span>;
}
</code></pre>
<h2 data-id="heading-6">5ï¼Œæ’ä»¶é”™è¯¯å¤„ç†</h2>
<p>æˆªæ­¢æœ¬æ–‡å‘å¸ƒä¹‹æ—¶ï¼Œ<code>typescript-plugin-css-modules</code>çš„ç‰ˆæœ¬ä¸º<code>3.4.0</code>ï¼Œæ­¤æ’ä»¶æœ‰ä¸€ä¸ªbugï¼Œä¼šå¯¼è‡´<code>cssModule</code>ç±»å‹æå–å¤±è´¥ï¼Œæ¨¡å—ç±»å‹æ˜¯ä¸€ä¸ª<code>{}</code>çš„æƒ…å†µï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<blockquote>
<p>Property '' does not exist on type {}</p>
</blockquote>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/5fe00da34d764b5a92e27317c127f946~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg6bmP5aSa5aSa:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768528289&amp;x-signature=WD4gvahZv5D5qegFhFN5Iepq1Ro%3D" alt="ç±»å‹æå–é”™è¯¯" loading="lazy"/></p>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fmrmckeb%2Ftypescript-plugin-css-modules%2Fissues%2F146" target="_blank" title="https://github.com/mrmckeb/typescript-plugin-css-modules/issues/146" ref="nofollow noopener noreferrer">issuesåœ°å€</a></p>
<h2 data-id="heading-7">5.1ï¼Œé”™è¯¯è§¦å‘åŸå› </h2>
<p>è¿™ä¸ªbugç›®å‰æœ‰ä¸¤ä¸ªæ–¹å¼éƒ½ä¼šè§¦å‘ï¼š</p>
<ul>
<li>
<p>1ï¼Œå½“ä½ é¡¹ç›®ä¸­ä½¿ç”¨<code>less/scss</code>çš„<code>@include/@mixin</code>ç­‰ç­‰æŒ‡ä»¤çš„æ—¶å€™</p>
</li>
<li>
<p>2ï¼Œå½“ä½ çš„é¡¹ç›®ä½¿ç”¨<code>/ deep /</code>è¿™æ ·çš„æ·±åº¦é€‰æ‹©å™¨è¯­æ³•çš„æ—¶å€™</p>
</li>
</ul>
<h2 data-id="heading-8">5.2ï¼Œè§£å†³åŠæ³•</h2>
<ul>
<li>1ï¼Œåœ¨éœ€è¦ä½¿ç”¨<code>@include/@mixin</code>ç­‰ç­‰æŒ‡ä»¤çš„æ—¶å€™ï¼Œåœ¨<code>cssModule</code>æ–‡ä»¶çš„å¤´ä¸Šå¼•å…¥æ ·å¼ï¼Œå°±å¯ä»¥è§£å†³(ä¹‹å‰æ˜¯å…¨å±€å¼•å…¥)ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</li>
</ul>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-keyword">@use</span> <span class="hljs-string">"../../../static/styles/common.scss"</span> as *;
</code></pre>
<ul>
<li>2ï¼Œæ¢ä¸€ç§æ·±åº¦é€‰æ‹©å™¨å†™æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</li>
</ul>
<pre><code class="hljs language-scss" lang="scss"><span class="hljs-selector-class">.main</span>{
  &amp; ::deep .el-button{
    <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">linear-gradient</span>(-<span class="hljs-number">90deg</span>, <span class="hljs-number">#29bdd9</span> <span class="hljs-number">0%</span>, <span class="hljs-number">#276ace</span> <span class="hljs-number">100%</span>);
    &amp;<span class="hljs-selector-pseudo">:hover</span>{
      <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0.8</span>;
    }
  }
}
</code></pre>
<blockquote>
<p>æœ¬æ¬¡åˆ†äº«å°±åˆ°è¿™å„¿å•¦ï¼Œæˆ‘æ˜¯é¹å¤šå¤šï¼Œæ·±è€•å‰ç«¯çš„æŠ€æœ¯åˆ›ä½œè€…ï¼Œå¦‚æœæ‚¨çœ‹äº†è§‰å¾—æœ‰å¸®åŠ©ï¼Œæ¬¢è¿è¯„è®ºï¼Œå…³æ³¨ï¼Œç‚¹èµï¼Œè½¬å‘ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§~</p>
</blockquote>
<p>PSï¼šåœ¨æœ¬é¡µæŒ‰F12ï¼Œåœ¨consoleä¸­è¾“å…¥document.getElementsByClassName('panel-btn')[0].click();æœ‰æƒŠå–œå“¦~</p>
<p><code>å¾€æœŸæ–‡ç« </code></p>
<ul>
<li><a href="https://juejin.cn/post/7568192652286754870" target="_blank" title="https://juejin.cn/post/7568192652286754870">çº¯å‰ç«¯æå–å›¾ç‰‡é¢œè‰²æ’ä»¶Color-Thiefæ•™å­¦+å®æˆ˜å®Œæ•´æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7565737512816771135" target="_blank" title="https://juejin.cn/post/7565737512816771135">react-konvaå®æˆ˜æŒ‡å—ï¼šCanvasé«˜æ€§èƒ½+æ˜“ç»´æŠ¤çš„ç»„ä»¶åŒ–å›¾å½¢å¼€å‘å®ç°æ•™ç¨‹</a></li>
<li><a href="https://juejin.cn/post/7560905838074462271" target="_blank" title="https://juejin.cn/post/7560905838074462271">Reactæ— é™æ»šåŠ¨æ’ä»¶react-infinite-scroll-componentçš„é…ç½®+ä¼˜åŒ–+é¿å‘æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7560542615484137491" target="_blank" title="https://juejin.cn/post/7560542615484137491">å‰ç«¯éŸ³é¢‘å…¼å®¹è§£å†³ï¼šéŸ³é¢‘ç¥å™¨howler.jsä»åŸºç¡€åˆ°è¿›é˜¶å®Œæ•´ä½¿ç”¨æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7559871680015024169" target="_blank" title="https://juejin.cn/post/7559871680015024169">ä½¿ç”¨React-OAuthè¿›è¡ŒGoogle/GitHubç™»å½•çš„æ•™ç¨‹å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7550585427834404927" target="_blank" title="https://juejin.cn/post/7550585427834404927">çº¯å‰ç«¯äººè„¸è¯†åˆ«åˆ©å™¨ï¼šface-api.jsæ‰‹æŠŠæ‰‹æ·±å…¥è§£ææ•™å­¦</a></li>
<li><a href="https://juejin.cn/post/7553865490732433462" target="_blank" title="https://juejin.cn/post/7553865490732433462">å…³äºReactçˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ–¹æ³•forwardRefçš„è¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7553484874609410074" target="_blank" title="https://juejin.cn/post/7553484874609410074">Reactè·¨ç»„ä»¶æ•°æ®å…±äº«useContextè¯¦è§£å’Œæ¡ˆä¾‹</a></li>
<li><a href="https://juejin.cn/post/7545087762837815334" target="_blank" title="https://juejin.cn/post/7545087762837815334">Webå›¾åƒç¼–è¾‘ç¥å™¨tui.image-editorä»åŸºç¡€åˆ°è¿›é˜¶çš„å®æˆ˜æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7544323659788288046" target="_blank" title="https://juejin.cn/post/7544323659788288046">å¼€å‘ä¸ªäººå¾®ä¿¡å°ç¨‹åºç±»ç›®é€‰æ‹©/ç›ˆåˆ©æ–¹å¼/æˆæœ¬æ§åˆ¶ä¸æœåŠ¡å™¨æ¥å…¥æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7541741121400864778" target="_blank" title="https://juejin.cn/post/7541741121400864778">å‰ç«¯å›¾ç‰‡è£å‰ªCropper.jsæ ¸å¿ƒåŠŸèƒ½ä¸å®æˆ˜æŠ€å·§è¯¦è§£</a></li>
<li><a href="https://juejin.cn/post/7536530451461472265" target="_blank" title="https://juejin.cn/post/7536530451461472265">ç¼–è¾‘å™¨ä¹Ÿæœ‰é‚ªä¿®ï¼Ÿç›˜ç‚¹VS Codeé‚ªé—¨/æœ‰è¶£çš„æ‰©å±•</a></li>
<li><a href="https://juejin.cn/post/7535005018257981466" target="_blank" title="https://juejin.cn/post/7535005018257981466">jsä½¿ç”¨IntersectionObserverå®ç°ç›®æ ‡å…ƒç´ å¯è§åº¦çš„äº¤äº’</a></li>
<li><a href="https://juejin.cn/post/7534547200330121225" target="_blank" title="https://juejin.cn/post/7534547200330121225">Webå‰ç«¯é¡µé¢å¼€å‘é˜¿æ‹‰ä¼¯è¯­ç§é€‚é…æŒ‡å—</a></li>
<li><a href="https://juejin.cn/post/7516122409948020736" target="_blank" title="https://juejin.cn/post/7516122409948020736">è®©ç½‘é¡µæ‹¥æœ‰Appä½“éªŒï¼ŸPWA å°†ç½‘é¡µå˜ä¸ºæ¡Œé¢åº”ç”¨çš„ä¿å§†çº§æ•™ç¨‹PWA</a></li>
<li><a href="https://juejin.cn/post/6953803916484018206" target="_blank" title="https://juejin.cn/post/6953803916484018206">ä½¿ç”¨nvmç®¡ç†node.jsç‰ˆæœ¬ä»¥åŠæ›´æ¢npmæ·˜å®é•œåƒæº</a></li>
<li><a href="https://juejin.cn/post/7140443283209060383" target="_blank" title="https://juejin.cn/post/7140443283209060383">æ‰‹æŠŠæ‰‹æ•™ä½ æ­å»ºè§„èŒƒçš„å›¢é˜Ÿvueé¡¹ç›®ï¼ŒåŒ…å«commitlintï¼Œeslintï¼Œprettierï¼Œhuskyï¼Œcommitizenç­‰ç­‰</a></li>
</ul></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[æ·±å…¥æµ…å‡º TinyEditor å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ç³»åˆ—ä¹‹ä¸€ï¼šTinyEditor æ˜¯ä»€ä¹ˆ]]></title>    <link>https://juejin.cn/post/7593261984189218866</link>    <guid>https://juejin.cn/post/7593261984189218866</guid>    <pubDate>2026-01-10T05:06:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593261984189218866" data-draft-id="7593242327932862474" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="æ·±å…¥æµ…å‡º TinyEditor å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ç³»åˆ—ä¹‹ä¸€ï¼šTinyEditor æ˜¯ä»€ä¹ˆ"/> <meta itemprop="keywords" content="å‰ç«¯,TypeScript,å¼€æº"/> <meta itemprop="datePublished" content="2026-01-10T05:06:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å‰ç«¯å¼€æºæ˜Ÿçƒ"/> <meta itemprop="url" content="https://juejin.cn/user/1504599026445150"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            æ·±å…¥æµ…å‡º TinyEditor å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ç³»åˆ—ä¹‹ä¸€ï¼šTinyEditor æ˜¯ä»€ä¹ˆ
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/1504599026445150/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å‰ç«¯å¼€æºæ˜Ÿçƒ
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T05:06:47.000Z" title="Sat Jan 10 2026 05:06:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>ä½ å¥½ï¼Œæˆ‘æ˜¯ Kagolï¼Œä¸ªäººå…¬ä¼—å·ï¼š<code>å‰ç«¯å¼€æºæ˜Ÿçƒ</code>ã€‚</p>
<p>TinyEditor v4.0 å·²æ­£å¼å‘å¸ƒï¼Œæ¥ä¸‹æ¥å°†é€šè¿‡ä¸€ç³»åˆ—æ–‡ç« ä»‹ç» TinyEditorï¼Œè®©å¤§å®¶æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨ TinyEditorã€‚</p>
<p><a href="https://juejin.cn/post/7592089325913522176" target="_blank" title="https://juejin.cn/post/7592089325913522176">ğŸ‰å†æ—¶1å¹´ï¼ŒTinyEditor v4.0 æ­£å¼å‘å¸ƒï¼</a></p>
<p>TinyEditor æ˜¯ä¸€ä¸ªåŸºäº Quill 2.0 æ„å»ºçš„å¼ºå¤§å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œé€šè¿‡å…¨é¢çš„æ¨¡å—å’Œæ ¼å¼æ‰©å±•äº†åŸºç¡€åŠŸèƒ½ã€‚æœ¬æ¦‚è¿°ä»‹ç»äº†é¡¹ç›®æ¶æ„ã€å…³é”®ç‰¹æ€§å’Œç»“æ„ï¼Œå¸®åŠ©åˆå­¦è€…å¼€å‘è€…äº†è§£ TinyEditor æä¾›çš„åŠŸèƒ½ä»¥åŠå¦‚ä½•å¼€å§‹ä½¿ç”¨ã€‚</p>
<h2 data-id="heading-0">ä»€ä¹ˆæ˜¯ TinyEditorï¼Ÿ</h2>
<p>TinyEditor æ˜¯ä¸€ä¸ªæ¡†æ¶æ— å…³çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œé€šè¿‡ 30 å¤šä¸ªé¢å¤–çš„æ¨¡å—å’Œæ ¼å¼å¢å¼ºäº† Quill 2.0ã€‚å®ƒåŸºäº Quill ç”Ÿæ€ç³»ç»Ÿï¼Œåœ¨ä¿æŒå®Œæ•´ API å…¼å®¹æ€§çš„åŒæ—¶ï¼Œæ·»åŠ äº†å¼ºå¤§çš„åŠŸèƒ½ï¼Œå¦‚é«˜çº§è¡¨æ ¼æ“ä½œã€å›¾åƒå¤„ç†ã€åä½œç¼–è¾‘ã€AI é›†æˆç­‰ã€‚è¯¥ç¼–è¾‘å™¨è®¾è®¡ä¸ºä¸ Vueã€Reactã€Angular åŠå…¶ä»– Web æ¡†æ¶æ— ç¼åä½œã€‚</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/103155482b99440fa671ed8daa8670ed~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5byA5rqQ5pif55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768626406&amp;x-signature=tnr86h%2F8r3uJOYIEjwEP7yqfD1s%3D" alt="Tiny-editor-demo.png" loading="lazy"/></p>
<h2 data-id="heading-1">é¡¹ç›®æ¶æ„</h2>
<p>é¡¹ç›®é‡‡ç”¨ pnpm workspaces çš„ monorepo ç»“æ„ï¼ŒæŒ‰ä¸åŒå…³æ³¨ç‚¹ç»„ç»‡æˆç‹¬ç«‹çš„åŒ…ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/0aab8c8d29c44ef0bf99dc8e4821e7dc~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5byA5rqQ5pif55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768626406&amp;x-signature=zFLGHZ6E2Vhf26L0mryeBzq9XgI%3D" alt="é¡¹ç›®æ¶æ„.png" loading="lazy"/></p>
<h3 data-id="heading-2">æ ¸å¿ƒåŒ…</h3>






























<table><thead><tr><th>åŒ…</th><th>ç”¨é€”</th><th>ä¸»è¦å†…å®¹</th></tr></thead><tbody><tr><td>fluent-editor</td><td>ä¸»ç¼–è¾‘å™¨åº“</td><td>æ ¸å¿ƒ FluentEditor ç±»ã€æ¨¡å—ã€æ ¼å¼ã€ä¸»é¢˜</td></tr><tr><td>collaborative-editing-backend</td><td>å®æ—¶åä½œæœåŠ¡å™¨</td><td>WebSocket æœåŠ¡å™¨ã€MongoDB æŒä¹…åŒ–ã€Yjs é›†æˆ</td></tr><tr><td>docs</td><td>æ–‡æ¡£å’Œç¤ºä¾‹</td><td>æ–‡æ¡£ç«™ç‚¹ã€æ¼”ç¤ºåœºã€ç¤ºä¾‹</td></tr><tr><td>projects</td><td>æ¼”ç¤ºåº”ç”¨</td><td>Vue æ¼”ç¤ºã€å®ç°ç¤ºä¾‹</td></tr></tbody></table>
<h2 data-id="heading-3">å…³é”®ç‰¹æ€§å’Œæ¨¡å—</h2>
<p>TinyEditor é€šè¿‡ä¸€å¥—å…¨é¢çš„æ¨¡å—å’Œæ ¼å¼æ‰©å±•äº† Quillï¼Œä½¿å…¶å¼€ç®±å³ç”¨å³å¯æŠ•å…¥ç”Ÿäº§ç¯å¢ƒï¼š</p>
<h3 data-id="heading-4">æ ¸å¿ƒç‰¹æ€§</h3>
<ul>
<li><strong>30+ æ¨¡å—å’Œæ ¼å¼</strong>ï¼šé™¤äº† Quill çš„ 21 ä¸ªå†…ç½®æ ¼å¼ï¼Œè¿˜æ·»åŠ äº† 15+ ä¸ªå¢å¼ºæ¨¡å—ï¼ŒåŒ…æ‹¬è¡¨æ ¼ã€å›¾åƒã€é“¾æ¥ã€è®¡æ•°å™¨ã€è¡¨æƒ…ç¬¦å·ã€æ–‡ä»¶ã€å‰ªè´´æ¿ã€æåŠã€å¿«é€Ÿèœå•å’Œæˆªå›¾åŠŸèƒ½</li>
<li><strong>é«˜çº§è¡¨æ ¼æ“ä½œ</strong>ï¼šæ’å…¥è‡ªå®šä¹‰å°ºå¯¸è¡¨æ ¼ã€æ‹–åŠ¨è¡Œåˆ—å¤§å°ã€æ’å…¥/åˆ é™¤è¡Œåˆ—ã€åˆå¹¶/æ‹†åˆ†å•å…ƒæ ¼</li>
<li><strong>æ¡†æ¶æ— å…³</strong>ï¼šå…¼å®¹ Vueã€Reactã€Angular å’ŒåŸç”Ÿ JavaScript</li>
<li><strong>å®Œå…¨ Quill å…¼å®¹</strong>ï¼šä¸ Quill API å’Œç”Ÿæ€ç³»ç»Ÿæ¨¡å—ä¿æŒ 100% å…¼å®¹æ€§</li>
</ul>
<h3 data-id="heading-5">æ¨¡å—æ¶æ„</h3>
<p>ç¼–è¾‘å™¨æŒ‰å‡ ä¸ªå…³é”®æ¨¡å—ç±»åˆ«ç»„ç»‡ï¼š</p>
<p><img src="https://p6-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8106308c11cd4be3b472e6fe2a58c1fd~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAg5YmN56uv5byA5rqQ5pif55CD:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768626406&amp;x-signature=3481r0VpVI8HXBhV3wxf5%2FrJqGg%3D" alt="æ¨¡å—æ¶æ„.png" loading="lazy"/></p>
<h2 data-id="heading-6">æŠ€æœ¯æ ˆ</h2>
<h3 data-id="heading-7">æ ¸å¿ƒä¾èµ–</h3>
<ul>
<li><strong>Quill 2.0</strong>ï¼šåŸºç¡€å¯Œæ–‡æœ¬ç¼–è¾‘å™¨å¼•æ“</li>
<li><strong>TypeScript</strong>ï¼šå®Œæ•´ç±»å‹å®‰å…¨å’Œå¼€å‘ä½“éªŒ</li>
<li><strong>Vite</strong>ï¼šç”¨äºå¼€å‘å’Œæ‰“åŒ…çš„ç°ä»£æ„å»ºå·¥å…·</li>
<li><strong>Sass</strong>ï¼šä¸»é¢˜çš„ CSS é¢„å¤„ç†</li>
</ul>
<h3 data-id="heading-8">é«˜çº§åŠŸèƒ½æ”¯æŒ</h3>
<ul>
<li><strong>Yjs</strong>ï¼šå®æ—¶åä½œç¼–è¾‘æ¡†æ¶</li>
<li><strong>MongoDB</strong>ï¼šåä½œçš„æ–‡æ¡£æŒä¹…åŒ–</li>
<li><strong>WebSocket</strong>ï¼šå®æ—¶é€šä¿¡</li>
<li><strong>Emoji Mart</strong>ï¼šè¡¨æƒ…ç¬¦å·é€‰æ‹©å’Œæ’å…¥</li>
<li><strong>Highlight.js</strong>ï¼šä»£ç è¯­æ³•é«˜äº®</li>
<li><strong>MathLive</strong>ï¼šLaTeX æ•°å­¦å…¬å¼æ”¯æŒ</li>
</ul>
<h2 data-id="heading-9">å¿«é€Ÿå¼€å§‹</h2>
<p>ä½“éªŒ TinyEditor æœ€å¿«çš„æ–¹å¼æ˜¯é€šè¿‡å¼€å‘ç¯å¢ƒï¼š</p>
<ol>
<li>å…‹éš†å’Œå®‰è£…ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">git <span class="hljs-built_in">clone</span> git@github.com:opentiny/tiny-editor.git
<span class="hljs-built_in">cd</span> tiny-editor
pnpm i
</code></pre>
<ol start="2">
<li>å¯åŠ¨å¼€å‘ï¼š</li>
</ol>
<pre><code class="hljs language-bash" lang="bash">pnpm dev
</code></pre>
<ol start="3">
<li>æŸ¥çœ‹ç¤ºä¾‹ï¼šè®¿é—® <a href="https://link.juejin.cn?target=http%3A%2F%2Flocalhost%3A5173%2Ftiny-editor%2F" target="_blank" title="http://localhost:5173/tiny-editor/" ref="nofollow noopener noreferrer">http://localhost:5173/tiny-editor/</a></li>
</ol>
<p>ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œè¯·å®‰è£…åŒ…ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">npm i @opentiny/fluent-editor
</code></pre>
<h2 data-id="heading-10">é¡¹ç›®ç»“æ„æ·±å…¥è§£æ</h2>
<h3 data-id="heading-11">æºç ç»„ç»‡</h3>
<p>ä¸»ç¼–è¾‘å™¨æºç ç»“æ„å¦‚ä¸‹ï¼š</p>
<ul>
<li><code>src/core/</code>ï¼šæ‰©å±• Quill çš„æ ¸å¿ƒ FluentEditor ç±»</li>
<li><code>src/modules/</code>ï¼šæ‰€æœ‰åŠŸèƒ½æ¨¡å—ï¼ˆå·¥å…·æ ã€å‰ªè´´æ¿ã€AI ç­‰ï¼‰</li>
<li><code>src/formats/</code>ï¼šè‡ªå®šä¹‰å†…å®¹æ ¼å¼å’Œ blot</li>
<li><code>src/attributors/</code>ï¼šæ ·å¼å’Œå±æ€§å®šä¹‰</li>
<li><code>src/themes/</code>ï¼šè§†è§‰ä¸»é¢˜å®ç°</li>
<li><code>src/config/</code>ï¼šé…ç½®ç±»å‹å’Œå›½é™…åŒ–</li>
</ul>
<h3 data-id="heading-12">æ¨¡å—æ³¨å†Œç³»ç»Ÿ</h3>
<p>TinyEditor ä½¿ç”¨å¤æ‚çš„æ¨¡å—æ³¨å†Œç³»ç»Ÿï¼Œæ”¯æŒè½»æ¾æ‰©å±•å’Œå®šåˆ¶ã€‚æ‰€æœ‰æ¨¡å—åœ¨ä¸»å…¥å£ç‚¹æ³¨å†Œï¼Œå…·æœ‰è¦†ç›–èƒ½åŠ›ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿè‡ªå®šä¹‰æˆ–æ›¿æ¢ä»»ä½•ç»„ä»¶ã€‚</p>
<p>æ¨¡å—åŒ–è®¾è®¡å’Œå…¨é¢çš„åŠŸèƒ½é›†ä½¿ TinyEditor é€‚ç”¨äºä»ç®€å•å†…å®¹ç¼–è¾‘åˆ°å¤æ‚åä½œåº”ç”¨çš„å„ç§åœºæ™¯ã€‚é¡¹ç›®å¯¹ Quill å…¼å®¹æ€§çš„æ‰¿è¯ºç¡®ä¿ä½ å¯ä»¥åˆ©ç”¨æ•´ä¸ª Quill ç”Ÿæ€ç³»ç»Ÿï¼ŒåŒæ—¶äº«å— TinyEditor çš„å¢å¼ºåŠŸèƒ½ã€‚</p>
<p>åç»­å°†å…¨é¢ä»‹ç» TinyEditor å¦‚ä½•ä½¿ç”¨ã€è®¾è®¡æ¶æ„ã€å®ç°åŸç†ã€äºŒæ¬¡å¼€å‘ç­‰å†…å®¹ï¼Œç‚¹ä¸ªå…³æ³¨ï¼Œä¸è¿·è·¯ã€‚</p>
<h2 data-id="heading-13">è”ç³»æˆ‘ä»¬</h2>
<p>GitHubï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fopentiny%2Ftiny-editor" target="_blank" title="https://github.com/opentiny/tiny-editor" ref="nofollow noopener noreferrer">github.com/opentiny/tiâ€¦</a>ï¼ˆæ¬¢è¿ Star â­ï¼‰</p>
<p>å®˜ç½‘ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fopentiny.github.io%2Ftiny-editor" target="_blank" title="https://opentiny.github.io/tiny-editor" ref="nofollow noopener noreferrer">opentiny.github.io/tiny-editor</a></p>
<p>ä¸ªäººåšå®¢ï¼š<a href="https://link.juejin.cn?target=https%3A%2F%2Fkagol.github.io%2Fblogs%2F" target="_blank" title="https://kagol.github.io/blogs/" ref="nofollow noopener noreferrer">kagol.github.io/blogs/</a></p>
<p>å°åŠ©æ‰‹å¾®ä¿¡ï¼šopentiny-official</p>
<p>å…¬ä¼—å·ï¼šOpenTiny</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[ã€èŠ‚ç‚¹ã€‘[Channel-FlipèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨]]></title>    <link>https://juejin.cn/post/7593541290991124530</link>    <guid>https://juejin.cn/post/7593541290991124530</guid>    <pubDate>2026-01-10T05:17:22.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593541290991124530" data-draft-id="7593541290991108146" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="ã€èŠ‚ç‚¹ã€‘[Channel-FlipèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨"/> <meta itemprop="keywords" content="æ¸¸æˆå¼€å‘,å›¾å½¢å­¦,Unity3D"/> <meta itemprop="datePublished" content="2026-01-10T05:17:22.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="SmalBox"/> <meta itemprop="url" content="https://juejin.cn/user/2218166695237532"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            ã€èŠ‚ç‚¹ã€‘[Channel-FlipèŠ‚ç‚¹]åŸç†è§£æä¸å®é™…åº”ç”¨
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2218166695237532/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    SmalBox
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T05:17:22.000Z" title="Sat Jan 10 2026 05:17:22 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»5åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong></p>
</blockquote>
<p>åœ¨Unityé€šç”¨æ¸²æŸ“ç®¡çº¿ï¼ˆURPï¼‰ä¸­ï¼ŒShader Graphä½œä¸ºä¸€ç§ç›´è§‚çš„å¯è§†åŒ–ç€è‰²å™¨ç¼–è¾‘å·¥å…·ï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä¾¿æ·çš„ç€è‰²å™¨æ„å»ºæ–¹å¼ã€‚FlipèŠ‚ç‚¹ä½œä¸ºShader Graphä¸­çš„ä¸€ä¸ªåŸºç¡€ä½†åŠŸèƒ½å¼ºå¤§çš„ç»„ä»¶ï¼Œåœ¨å›¾å½¢æ•ˆæœå¼€å‘ä¸­å…·æœ‰é‡è¦ä½œç”¨ã€‚æœ¬æ–‡å°†ä»æŠ€æœ¯åŸç†ã€åº”ç”¨åœºæ™¯åŠå®æˆ˜æŠ€å·§ç­‰å¤šä¸ªç»´åº¦ï¼Œç³»ç»Ÿè§£æFlipèŠ‚ç‚¹çš„ä½¿ç”¨æ–¹æ³•ä¸æœ€ä½³å®è·µã€‚</p>
<h2 data-id="heading-0">æ ¸å¿ƒåŠŸèƒ½è§£æ</h2>
<h3 data-id="heading-1">æ•°å­¦åŸç†</h3>
<p>FlipèŠ‚ç‚¹çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯å¯¹è¾“å…¥å€¼çš„å„ä¸ªé€šé“è¿›è¡Œç¬¦å·ç¿»è½¬ï¼Œå…¶æ•°å­¦è¡¨è¾¾å¼å¦‚ä¸‹ï¼š</p>
<p>Out = (Flip Ã— -2 + 1) Ã— In</p>
<p>å½“Flipå‚æ•°ä¸º1ï¼ˆTrueï¼‰æ—¶ï¼Œç³»æ•°å˜ä¸º-1ï¼Œå®ç°æ•°å€¼ç¿»è½¬ï¼›å½“å‚æ•°ä¸º0ï¼ˆFalseï¼‰æ—¶ï¼Œç³»æ•°ä¿æŒä¸º1ï¼Œæ•°å€¼ä¿æŒä¸å˜ã€‚è¿™ç§çº¿æ€§å˜æ¢æ–¹å¼æ¯”ä¼ ç»Ÿçš„æ¡ä»¶åˆ¤æ–­æ›´ä¸ºé«˜æ•ˆï¼Œå°¤å…¶é€‚ç”¨äºGPUçš„å¹¶è¡Œè®¡ç®—ç¯å¢ƒã€‚</p>
<h3 data-id="heading-2">é€šé“é€‰æ‹©æœºåˆ¶</h3>
<p>FlipèŠ‚ç‚¹æä¾›å››ä¸ªç‹¬ç«‹çš„é€šé“æ§åˆ¶å¼€å…³ï¼š</p>
<ul>
<li>Redï¼šæ§åˆ¶çº¢è‰²é€šé“çš„ç¿»è½¬</li>
<li>Greenï¼šæ§åˆ¶ç»¿è‰²é€šé“çš„ç¿»è½¬</li>
<li>Blueï¼šæ§åˆ¶è“è‰²é€šé“çš„ç¿»è½¬</li>
<li>Alphaï¼šæ§åˆ¶é€æ˜é€šé“çš„ç¿»è½¬</li>
</ul>
<p>æ¯ä¸ªå¼€å…³å‡å…·å¤‡æ™ºèƒ½ç¦ç”¨æœºåˆ¶ï¼š</p>
<ul>
<li>å½“è¾“å…¥ä¸ºFloatç±»å‹æ—¶ï¼ŒGreenã€Blueå’ŒAlphaé€šé“è‡ªåŠ¨ç¦ç”¨</li>
<li>å½“è¾“å…¥ä¸ºVector2ç±»å‹æ—¶ï¼ŒBlueå’ŒAlphaé€šé“è‡ªåŠ¨ç¦ç”¨</li>
<li>å½“è¾“å…¥ä¸ºVector3ç±»å‹æ—¶ï¼ŒAlphaé€šé“è‡ªåŠ¨ç¦ç”¨</li>
</ul>
<p>è¯¥è®¾è®¡æ—¢ä¿è¯äº†èŠ‚ç‚¹çš„çµæ´»æ€§ï¼Œä¹Ÿæœ‰æ•ˆé¿å…äº†ç”¨æˆ·è¯¯æ“ä½œã€‚</p>
<h2 data-id="heading-3">ç«¯å£ç‰¹æ€§è¯¦è§£</h2>
<h3 data-id="heading-4">è¾“å…¥ç«¯å£ï¼ˆInï¼‰</h3>
<ul>
<li>ç±»å‹ï¼šåŠ¨æ€çŸ¢é‡</li>
<li>åŠŸèƒ½ï¼šæ¥å—ä»æµ®ç‚¹æ•°åˆ°å››ç»´å‘é‡çš„å„ç±»è¾“å…¥</li>
<li>ç‰¹ç‚¹ï¼šè‡ªåŠ¨é€‚é…è¾“å…¥ç»´åº¦ï¼Œä¸ºé€šé“æ§åˆ¶æä¾›åŸºç¡€æ•°æ®æ”¯æŒ</li>
</ul>
<h3 data-id="heading-5">è¾“å‡ºç«¯å£ï¼ˆOutï¼‰</h3>
<ul>
<li>ç±»å‹ï¼šåŠ¨æ€çŸ¢é‡</li>
<li>åŠŸèƒ½ï¼šè¾“å‡ºç»è¿‡ç¿»è½¬å¤„ç†åçš„ç»“æœ</li>
<li>ç‰¹ç‚¹ï¼šä¿æŒä¸è¾“å…¥ç›¸åŒçš„ç»´åº¦ï¼Œç¡®ä¿æ•°æ®æµè¿ç»­æ€§ä¸ä¸€è‡´æ€§</li>
</ul>
<h3 data-id="heading-6">ç«¯å£è¿æ¥å»ºè®®</h3>
<ul>
<li>é¢œè‰²å¤„ç†ï¼šå°†ColorèŠ‚ç‚¹è¿æ¥è‡³Inç«¯å£ï¼ŒOutç«¯å£è¿æ¥è‡³æè´¨çš„BaseColor</li>
<li>æ³•çº¿å¤„ç†ï¼šå°†NormalèŠ‚ç‚¹è¿æ¥è‡³Inç«¯å£ï¼ŒOutç«¯å£è¿æ¥è‡³æè´¨çš„Normal</li>
<li>ç‰¹æ•ˆå¤„ç†ï¼šå°†PositionèŠ‚ç‚¹è¿æ¥è‡³Inç«¯å£ï¼ŒOutç«¯å£è¿æ¥è‡³è‡ªå®šä¹‰æ•ˆæœèŠ‚ç‚¹</li>
</ul>
<h2 data-id="heading-7">æ§ä»¶é…ç½®æŒ‡å—</h2>
<h3 data-id="heading-8">é€šé“æ§åˆ¶é€‰é¡¹</h3>



































<table><thead><tr><th>é€šé“</th><th>ç±»å‹</th><th>åŠŸèƒ½</th><th>å…¸å‹åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>Red</td><td>å¼€å…³</td><td>æ§åˆ¶çº¢è‰²é€šé“ç¿»è½¬</td><td>åˆ›å»ºçº¢è‰²è­¦å‘Šæ•ˆæœ</td></tr><tr><td>Green</td><td>å¼€å…³</td><td>æ§åˆ¶ç»¿è‰²é€šé“ç¿»è½¬</td><td>ç¯å¢ƒè‰²é€‚åº”è°ƒæ•´</td></tr><tr><td>Blue</td><td>å¼€å…³</td><td>æ§åˆ¶è“è‰²é€šé“ç¿»è½¬</td><td>å†·è‰²è°ƒæ•ˆæœåˆ›å»º</td></tr><tr><td>Alpha</td><td>å¼€å…³</td><td>æ§åˆ¶é€æ˜é€šé“ç¿»è½¬</td><td>æ˜¾ç¤º/éšè—åˆ‡æ¢</td></tr></tbody></table>
<h3 data-id="heading-9">é…ç½®ç­–ç•¥</h3>
<ul>
<li>åŸºç¡€é¢œè‰²ç¿»è½¬ï¼šåŒæ—¶å¯ç”¨Redã€Greenå’ŒBlueå¼€å…³</li>
<li>å•é€šé“è°ƒæ•´ï¼šä»…å¯ç”¨ç›®æ ‡é€šé“å¼€å…³</li>
<li>åŠ¨æ€æ§åˆ¶ï¼šå°†å¼€å…³è¿æ¥è‡³TimeèŠ‚ç‚¹ï¼Œå®ç°åŠ¨ç”»æ•ˆæœ</li>
</ul>
<h2 data-id="heading-10">å…¸å‹åº”ç”¨åœºæ™¯</h2>
<h3 data-id="heading-11">è§†è§‰æ•ˆæœå¢å¼º</h3>
<ul>
<li>é¢œè‰²åè½¬ç‰¹æ•ˆï¼šåœ¨è§’è‰²å—ä¼¤æ—¶å¿«é€Ÿåˆ›å»ºé—ªç™½æ•ˆæœ
<ul>
<li>é…ç½®ï¼šRed/Green/Blue = Trueï¼ŒAlpha = False</li>
<li>è¿æ¥ï¼šColor â†’ Flip â†’ Material</li>
</ul>
</li>
<li>æ³•çº¿ç¿»è½¬ï¼šå¤„ç†åŒå‘è¡¨é¢å…‰ç…§
<ul>
<li>é…ç½®ï¼šRed/Green = Falseï¼ŒBlue = Trueï¼ŒAlpha = False</li>
<li>è¿æ¥ï¼šNormal â†’ Flip â†’ Material</li>
</ul>
</li>
</ul>
<h3 data-id="heading-12">åŠŸèƒ½å®ç°</h3>
<ul>
<li>æ˜¾ç¤º/éšè—åˆ‡æ¢ï¼šé€šè¿‡ç¿»è½¬Alphaé€šé“å®ç°
<ul>
<li>é…ç½®ï¼šRed/Green/Blue = Falseï¼ŒAlpha = True</li>
<li>è¿æ¥ï¼šColor â†’ Flip â†’ Material</li>
</ul>
</li>
<li>åŠ¨æ€æ•ˆæœåˆ›å»ºï¼šç»“åˆTimeèŠ‚ç‚¹åˆ›å»ºå‘¨æœŸæ€§ç¿»è½¬
<ul>
<li>é…ç½®ï¼šè¿æ¥TimeèŠ‚ç‚¹åˆ°Flipå¼€å…³</li>
<li>æ•ˆæœï¼šå®ç°é¢œè‰²è„‰å†²æ•ˆæœ</li>
</ul>
</li>
</ul>
<h2 data-id="heading-13">é«˜çº§åº”ç”¨æŠ€å·§</h2>
<h3 data-id="heading-14">åŠ¨æ€æ§åˆ¶æ–¹æ¡ˆ</h3>
<ul>
<li>
<p>åŸºäºæ—¶é—´çš„ç¿»è½¬ï¼š</p>
<p><code>// ä¼ªä»£ç ç¤ºä¾‹ float time = Time.time;</code></p>
<p><code>// è·å–å½“å‰æ—¶é—´ Flip.Red = sin(time * 2) &gt; 0;</code></p>
<p><code>// æ ¹æ®æ­£å¼¦æ³¢æ§åˆ¶çº¢è‰²é€šé“</code></p>
</li>
<li>
<p>åŸºäºç”¨æˆ·è¾“å…¥çš„ç¿»è½¬ï¼š</p>
<p><code>// ä¼ªä»£ç ç¤ºä¾‹ Flip.Green = Input.GetKey(KeyCode.G); // æŒ‰ä¸‹Gé”®æ—¶ç¿»è½¬ç»¿è‰²é€šé“</code></p>
</li>
</ul>
<h3 data-id="heading-15">å¤šå±‚ç¿»è½¬æ•ˆæœ</h3>
<p>é€šè¿‡ä¸²è”å¤šä¸ªFlipèŠ‚ç‚¹å¯åˆ›å»ºå¤æ‚æ•ˆæœï¼š</p>
<ul>
<li>ç¬¬ä¸€å±‚ï¼šåŸºç¡€é¢œè‰²ç¿»è½¬ï¼ˆRed/Green/Blue = Trueï¼‰</li>
<li>ç¬¬äºŒå±‚ï¼šç‰¹å®šé€šé“å¾®è°ƒï¼ˆä»…Blue = Trueï¼‰</li>
<li>ç¬¬ä¸‰å±‚ï¼šæœ€ç»ˆè¾“å‡ºè°ƒæ•´ï¼ˆAlpha = Trueï¼‰</li>
</ul>
<h3 data-id="heading-16">æ€§èƒ½ä¼˜åŒ–æŠ€å·§</h3>
<ul>
<li>é¿å…è¿‡åº¦ä½¿ç”¨ï¼šåœ¨æ¯å¸§æ›´æ–°çš„è®¡ç®—ä¸­åº”è°¨æ…ä½¿ç”¨</li>
<li>é™æ€ç¿»è½¬ä¼˜å…ˆï¼šå¯¹ä¸å˜çš„æ•ˆæœä½¿ç”¨é™æ€é…ç½®</li>
<li>æè´¨å®ä¾‹åŒ–ï¼šå¯¹é¢‘ç¹ä½¿ç”¨çš„ç¿»è½¬æ•ˆæœåˆ›å»ºæè´¨å®ä¾‹</li>
</ul>
<h2 data-id="heading-17">å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ</h2>
<h3 data-id="heading-18">é€šé“ä¸åŒ¹é…é—®é¢˜</h3>
<p><strong>ç°è±¡</strong>ï¼šå½“è¾“å…¥å‘é‡ç»´åº¦ä¸æ§ä»¶é…ç½®ä¸åŒ¹é…æ—¶ï¼ŒèŠ‚ç‚¹å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œ</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨SwizzleèŠ‚ç‚¹è°ƒæ•´é€šé“é¡ºåº</li>
<li>ä½¿ç”¨SplitèŠ‚ç‚¹åˆ†ç¦»å‘é‡åˆ†é‡</li>
<li>ä½¿ç”¨CombineèŠ‚ç‚¹é‡æ–°ç»„åˆé€šé“</li>
</ul>
<h3 data-id="heading-19">æ€§èƒ½ç“¶é¢ˆè¯†åˆ«</h3>
<p><strong>æ£€æµ‹æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨Unity Profileråˆ†æç€è‰²å™¨æ€§èƒ½</li>
<li>æ£€æŸ¥FlipèŠ‚ç‚¹åœ¨æ¸²æŸ“é˜Ÿåˆ—ä¸­çš„ä½ç½®</li>
<li>æµ‹è¯•ä¸åŒé…ç½®ä¸‹çš„å¸§ç‡å˜åŒ–</li>
</ul>
<p><strong>ä¼˜åŒ–å»ºè®®</strong>ï¼š</p>
<ul>
<li>ç®€åŒ–å¤æ‚çš„ç¿»è½¬ç»„åˆ</li>
<li>ä½¿ç”¨LODï¼ˆLevel of Detailï¼‰æŠ€æœ¯</li>
<li>é¿å…åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¿‡åº¦ä½¿ç”¨åŠ¨æ€ç¿»è½¬</li>
</ul>
<h2 data-id="heading-20">æœ€ä½³å®è·µæŒ‡å—</h2>
<h3 data-id="heading-21">é¡¹ç›®ç»„ç»‡å»ºè®®</h3>
<ul>
<li>
<p>å‘½åè§„èŒƒï¼š</p>
<ul>
<li>åŸºç¡€ç¿»è½¬ï¼šFlip_BaseColor</li>
<li>ç‰¹æ•ˆç¿»è½¬ï¼šFlip_Effect_Glow</li>
<li>åŠŸèƒ½ç¿»è½¬ï¼šFlip_HUD_Alpha</li>
</ul>
</li>
<li>
<p>æ³¨é‡Šæ ‡å‡†ï¼š</p>
<p><code>// ç¿»è½¬èŠ‚ç‚¹é…ç½®è¯´æ˜</code></p>
<p><code>// åŠŸèƒ½ï¼šåˆ›å»ºè§’è‰²å—ä¼¤æ—¶çš„é—ªç™½æ•ˆæœ</code></p>
<p><code>// é€šé“ï¼šRGBå…¨ç¿»è½¬ï¼ŒAlphaä¿æŒ</code></p>
<p><code>// è¿æ¥ï¼šColor â†’ Flip â†’ Material</code></p>
</li>
<li>
<p>é¢„è®¾ç®¡ç†ï¼š</p>
<ul>
<li>åˆ›å»ºå¸¸ç”¨ç¿»è½¬é¢„è®¾</li>
<li>å»ºç«‹é…ç½®æ–‡æ¡£</li>
<li>å®šæœŸå®¡æŸ¥æ•ˆæœ</li>
</ul>
</li>
</ul>
<h3 data-id="heading-22">æµ‹è¯•éªŒè¯æ–¹æ³•</h3>
<ul>
<li>å•å…ƒæµ‹è¯•ï¼š
<ul>
<li>æµ‹è¯•æ‰€æœ‰é€šé“ç»„åˆ</li>
<li>éªŒè¯è¾¹ç•Œæ¡ä»¶å¤„ç†</li>
</ul>
</li>
<li>é›†æˆæµ‹è¯•ï¼š
<ul>
<li>åœ¨ä¸åŒå…‰ç…§æ¡ä»¶ä¸‹æµ‹è¯•</li>
<li>åœ¨å¤šç§æè´¨ä¸ŠéªŒè¯æ•ˆæœ</li>
</ul>
</li>
<li>æ€§èƒ½æµ‹è¯•ï¼š
<ul>
<li>åŸºå‡†æµ‹è¯•ä¸åŒé…ç½®çš„æ€§èƒ½</li>
<li>åˆ†æå†…å­˜ä½¿ç”¨æƒ…å†µ</li>
</ul>
</li>
</ul>
<h2 data-id="heading-23">æœªæ¥å‘å±•è¶‹åŠ¿</h2>
<p>éšç€URPçš„æŒç»­æ¼”è¿›ï¼ŒFlipèŠ‚ç‚¹ä¹Ÿåœ¨ä¸æ–­å‘å±•ï¼š</p>
<ul>
<li>æ›´å¤šç»´åº¦æ”¯æŒï¼šå¯èƒ½æ‰©å±•è‡³æ›´é«˜ç»´åº¦çš„å‘é‡å¤„ç†</li>
<li>æ›´ç²¾ç»†æ§åˆ¶ï¼šå¼•å…¥é€šé“å¼ºåº¦çš„è¿ç»­è°ƒèŠ‚</li>
<li>æ™ºèƒ½ä¼˜åŒ–ï¼šè‡ªåŠ¨è¯†åˆ«æœ€ä½³ç¿»è½¬é…ç½®</li>
<li>è·¨å¹³å°å¢å¼ºï¼šé’ˆå¯¹ç§»åŠ¨å¹³å°çš„è¿›ä¸€æ­¥ä¼˜åŒ–</li>
</ul>
<hr/>
<blockquote>
<p><a href="https://link.juejin.cn?target=https%3A%2F%2Fblog.csdn.net%2Fchenghai37%2Fcategory_13074589.html%3Ffromshare%3Dblogcolumn%26sharetype%3Dblogcolumn%26sharerId%3D13074589%26sharerefer%3DPC%26sharesource%3Dchenghai37%26sharefrom%3Dfrom_link" target="_blank" title="https://blog.csdn.net/chenghai37/category_13074589.html?fromshare=blogcolumn&amp;sharetype=blogcolumn&amp;sharerId=13074589&amp;sharerefer=PC&amp;sharesource=chenghai37&amp;sharefrom=from_link" ref="nofollow noopener noreferrer">ã€Unity Shader Graph ä½¿ç”¨ä¸ç‰¹æ•ˆå®ç°ã€‘</a><strong>ä¸“æ -ç›´è¾¾</strong>
ï¼ˆæ¬¢è¿<em>ç‚¹èµç•™è¨€</em>æ¢è®¨ï¼Œæ›´å¤šäººåŠ å…¥è¿›æ¥èƒ½æ›´åŠ å®Œå–„è¿™ä¸ªæ¢ç´¢çš„è¿‡ç¨‹ï¼ŒğŸ™ï¼‰</p>
</blockquote></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[è®°å½•protocç”Ÿæˆä»£ç å°†optionalæ”¹æˆomiteptyé—®é¢˜]]></title>    <link>https://juejin.cn/post/7593234983755710474</link>    <guid>https://juejin.cn/post/7593234983755710474</guid>    <pubDate>2026-01-10T05:36:41.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593234983755710474" data-draft-id="7593251491935977518" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="è®°å½•protocç”Ÿæˆä»£ç å°†optionalæ”¹æˆomiteptyé—®é¢˜"/> <meta itemprop="keywords" content="åç«¯,protobuf,Go"/> <meta itemprop="datePublished" content="2026-01-10T05:36:41.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="nil"/> <meta itemprop="url" content="https://juejin.cn/user/2893570337422670"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            è®°å½•protocç”Ÿæˆä»£ç å°†optionalæ”¹æˆomiteptyé—®é¢˜
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2893570337422670/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    nil
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T05:36:41.000Z" title="Sat Jan 10 2026 05:36:41 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»1åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">é—®é¢˜ç°çŠ¶</h2>
<p>åœ¨ä¿®æ”¹goé¡¹ç›®çš„protocæ–‡ä»¶ï¼Œç„¶åç”¨protocå‘½ä»¤ç”Ÿæˆgoä»£ç çš„æ—¶å€™ï¼Œä¼šé‡åˆ°å°†optionalä¿®æ”¹æˆomitemptyçš„æƒ…å†µ</p>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/a5130477f3d94c87aade0643ff38b7c1~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmls:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768628201&amp;x-signature=%2BkhAuvFRJJVeqGbncQA5fG0gktk%3D" alt="image.png" loading="lazy"/></p>
<h2 data-id="heading-1">é—®é¢˜äº§ç”Ÿçš„åŸå› </h2>
<p><img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/215757bebcb7490d9c40fb6df57e2cca~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgbmls:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768628201&amp;x-signature=Wdwhu9nxWdTo0A2SmrbSMyGoe94%3D" alt="image.png" loading="lazy"/></p>
<p>æ˜¯å› ä¸ºæˆ‘çš„protocç‰ˆæœ¬æ˜¯v4.25.1ï¼Œè€Œä¹‹å‰çš„ç‰ˆæœ¬æ˜¯v4.22.1</p>
<h2 data-id="heading-2">äº§ç”Ÿçš„ç»“æœ</h2>
<p>è¿™æ ·ä¿®æ”¹ä¼šå¯¼è‡´æ¥å£ç»™å‰ç«¯è¿”å›çš„æ•°ç»„ç±»å‹å˜æˆäº†nullï¼Œè€Œä¸æ˜¯ç©ºæ•°ç»„ã€‚å¦‚æœå‰ç«¯ä»£ç ä¸ä¸¥è°¨çš„è¯ï¼Œå°±å¯¼è‡´æŠ¥é”™äº†ã€‚</p>
<h2 data-id="heading-3">è§£å†³è¿‡ç¨‹</h2>
<p>å…ˆæ˜¯è¯¢é—®å¤§æ¨¡å‹ï¼Œæä¾›äº†å¾ˆå¤šæ–¹æ³•ï¼Œä½†éƒ½è¡Œä¸é€šã€‚ä¸‹é¢ä»‹ç»ä¸€ä¸‹è¡Œä¸é€šçš„æ–¹æ¡ˆã€‚</p>
<ul>
<li>é‡æ–°å®‰è£…protoc v4.22.1ç‰ˆæœ¬ã€‚ä½†æ˜¯çš„ç½‘ä¸Šæ‰¾äº†å¾ˆå¤šèµ„æ–™ï¼Œå‘ç°åªèƒ½ä¸‹è½½æºä»£ç ï¼Œéœ€è¦è‡ªå·±ç¼–è¯‘ã€‚ä¸èƒ½ç›´æ¥ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li>
<li>ç”¨dockerï¼Œåœ¨dockerä¸­å®‰è£…protoc v4.22.1 ç”Ÿæˆä»£ç </li>
<li>å…¶ä»–</li>
</ul>
<p>æœ€ç»ˆï¼Œé‡‡ç”¨æœ€ç®€å•çš„æ–¹å¼ï¼Œå³å°†ä¿®æ”¹çš„omitemptyæ”¹å›optional</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># 1. å¤‡ä»½æ–‡ä»¶</span>
<span class="hljs-built_in">cp</span> pb/code_review.api.v1.pb.go pb/code_review.api.v1.pb.go.bak

<span class="hljs-comment"># 2. ä½¿ç”¨ç®€å•çš„ sed å‘½ä»¤</span>
sed -i.bak <span class="hljs-string">'s/omitempty/optional/g'</span> pb/code_review.api.v1.pb.go

<span class="hljs-comment"># 3. éªŒè¯</span>
grep <span class="hljs-string">"optional"</span> pb/code_review.api.v1.pb.go | <span class="hljs-built_in">head</span> -3
</code></pre>
<p>è¿™ä¸ªæ–¹æ³•æœ€ç»ˆç”Ÿæ•ˆäº†ï¼ï¼ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[react nativeé¡¹ç›®ä¸­ä½¿ç”¨React Hook é«˜çº§æ¨¡å¼]]></title>    <link>https://juejin.cn/post/7593251491935993902</link>    <guid>https://juejin.cn/post/7593251491935993902</guid>    <pubDate>2026-01-10T05:32:20.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593251491935993902" data-draft-id="7593212374921494555" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="react nativeé¡¹ç›®ä¸­ä½¿ç”¨React Hook é«˜çº§æ¨¡å¼"/> <meta itemprop="keywords" content="React Native"/> <meta itemprop="datePublished" content="2026-01-10T05:32:20.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨ç‹‚ä¹‹é€¸æ‰"/> <meta itemprop="url" content="https://juejin.cn/user/624178332441166"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            react nativeé¡¹ç›®ä¸­ä½¿ç”¨React Hook é«˜çº§æ¨¡å¼
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624178332441166/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨ç‹‚ä¹‹é€¸æ‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T05:32:20.000Z" title="Sat Jan 10 2026 05:32:20 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»6åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">React Hook é«˜çº§æ¨¡å¼ï¼šä»è§¦å‘å™¨æ¨¡å¼åˆ°å®æˆ˜åº”ç”¨</h2>
<h3 data-id="heading-1">å‰è¨€</h3>
<p>åœ¨ React å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼šçˆ¶ç»„ä»¶éœ€è¦æ§åˆ¶å­ç»„ä»¶é‡æ–°åŠ è½½æ•°æ®ï¼Œä½†åˆä¸æƒ³é‡æ–°æŒ‚è½½æ•´ä¸ªç»„ä»¶ã€‚æœ¬æ–‡å°†ä»‹ç»ä¸€ç§ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆâ€”â€”<strong>è§¦å‘å™¨æ¨¡å¼ï¼ˆTrigger Patternï¼‰</strong>ï¼Œä»¥åŠå…¶ä»– 9 ç§å®ç”¨çš„ Hook æ¨¡å¼ã€‚</p>
<h3 data-id="heading-2">é—®é¢˜åœºæ™¯</h3>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå›¾ç‰‡ä¸Šä¼ ç»„ä»¶ <code>FileUpload</code>ï¼Œåœ¨ç¼–è¾‘é¡µé¢ä¿®æ”¹å›¾ç‰‡åè¿”å›åˆ—è¡¨é¡µï¼Œéœ€è¦åˆ·æ–°å›¾ç‰‡æ˜¾ç¤ºï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ—è¡¨é¡µ</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">RecordsList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">refresh</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">fetchData</span>(); <span class="hljs-comment">// åˆ·æ–°åˆ—è¡¨æ•°æ®</span>
    <span class="hljs-comment">// é—®é¢˜ï¼šå¦‚ä½•è®© FileUpload ç»„ä»¶ä¹Ÿåˆ·æ–°ï¼Ÿ</span>
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {data.map(item =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">FileUpload</span> <span class="hljs-attr">id</span>=<span class="hljs-string">{item.id}</span> /&gt;</span> // éœ€è¦åˆ·æ–°å›¾ç‰‡
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-3">å¸¸è§çš„é”™è¯¯æ–¹æ¡ˆ</h4>
<h5 data-id="heading-4">âŒ æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ key å¼ºåˆ¶é‡æ–°æŒ‚è½½</h5>
<pre><code class="hljs language-javascript" lang="javascript">&lt;<span class="hljs-title class_">FileUpload</span> key={<span class="hljs-string">`<span class="hljs-subst">${item.id}</span>-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>} id={item.<span class="hljs-property">id</span>} /&gt;
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ul>
<li>ç»„ä»¶å®Œå…¨é”€æ¯é‡å»ºï¼Œä¸¢å¤±æ‰€æœ‰å†…éƒ¨çŠ¶æ€</li>
<li>æ€§èƒ½å·®ï¼Œä¼šè§¦å‘å®Œæ•´çš„æŒ‚è½½/å¸è½½ç”Ÿå‘½å‘¨æœŸ</li>
<li>å¯èƒ½å¯¼è‡´é—ªçƒæˆ–åŠ¨ç”»ä¸­æ–­</li>
</ul>
<h5 data-id="heading-5">âŒ æ–¹æ¡ˆ 2ï¼šé€šè¿‡ ref è°ƒç”¨å­ç»„ä»¶æ–¹æ³•</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> fileUploadRef = <span class="hljs-title function_">useRef</span>();

<span class="hljs-keyword">const</span> <span class="hljs-title function_">refresh</span> = (<span class="hljs-params"/>) =&gt; {
  fileUploadRef.<span class="hljs-property">current</span>.<span class="hljs-title function_">refresh</span>(); <span class="hljs-comment">// å‘½ä»¤å¼è°ƒç”¨</span>
};

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FileUpload</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{fileUploadRef}</span> <span class="hljs-attr">id</span>=<span class="hljs-string">{item.id}</span> /&gt;</span></span>
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ul>
<li>æ‰“ç ´äº† React çš„å•å‘æ•°æ®æµ</li>
<li>ä¸ç¬¦åˆå£°æ˜å¼ç¼–ç¨‹ç†å¿µ</li>
<li>éš¾ä»¥è¿½è¸ªæ•°æ®æµå‘</li>
</ul>
<h5 data-id="heading-6">âŒ æ–¹æ¡ˆ 3ï¼šä½¿ç”¨å¸ƒå°”å€¼åˆ‡æ¢</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [shouldRefresh, setShouldRefresh] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">refresh</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">setShouldRefresh</span>(<span class="hljs-literal">true</span>);
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setShouldRefresh</span>(<span class="hljs-literal">false</span>), <span class="hljs-number">0</span>);
};

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FileUpload</span> <span class="hljs-attr">shouldRefresh</span>=<span class="hljs-string">{shouldRefresh}</span> /&gt;</span></span>
</code></pre>
<p><strong>é—®é¢˜ï¼š</strong></p>
<ul>
<li>éœ€è¦å¤æ‚çš„çŠ¶æ€é‡ç½®é€»è¾‘</li>
<li>è¿ç»­åˆ·æ–°å¯èƒ½å¤±æ•ˆï¼ˆå€¼æ²¡æœ‰å˜åŒ–ï¼‰</li>
<li>ä»£ç ä¸å¤Ÿä¼˜é›…</li>
</ul>
<hr/>
<h3 data-id="heading-7">âœ… æœ€ä½³æ–¹æ¡ˆï¼šè§¦å‘å™¨æ¨¡å¼</h3>
<h4 data-id="heading-8">æ ¸å¿ƒæ€æƒ³</h4>
<blockquote>
<p><strong>ç”¨ä¸€ä¸ªç®€å•çš„æ•°å€¼å˜åŒ–æ¥è§¦å‘å¤æ‚çš„å‰¯ä½œç”¨</strong></p>
</blockquote>
<h4 data-id="heading-9">å®ç°æ­¥éª¤</h4>
<h5 data-id="heading-10">1. åˆ›å»º Hook</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// src/hooks/useRefreshTrigger.js</span>
<span class="hljs-keyword">import</span> { useState, useCallback } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useRefreshTrigger</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> [trigger, setTrigger] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  
  <span class="hljs-keyword">const</span> fire = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">setTrigger</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, []);
  
  <span class="hljs-keyword">return</span> [trigger, fire];
};
</code></pre>
<h5 data-id="heading-11">2. åœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// åˆ—è¡¨é¡µ</span>
<span class="hljs-keyword">import</span> { useRefreshTrigger } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks/useRefreshTrigger'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">RecordsList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [refreshTrigger, triggerRefresh] = <span class="hljs-title function_">useRefreshTrigger</span>();
  
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">refresh</span> = (<span class="hljs-params"/>) =&gt; {
    <span class="hljs-title function_">fetchData</span>();
    <span class="hljs-title function_">triggerRefresh</span>(); <span class="hljs-comment">// è§¦å‘åˆ·æ–°</span>
  };
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {data.map(item =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">FileUpload</span> 
          <span class="hljs-attr">id</span>=<span class="hljs-string">{item.id}</span> 
          <span class="hljs-attr">refreshTrigger</span>=<span class="hljs-string">{refreshTrigger}</span> // <span class="hljs-attr">ä¼ é€’è§¦å‘å™¨</span>
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h5 data-id="heading-12">3. åœ¨å­ç»„ä»¶ä¸­å“åº”</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// FileUpload ç»„ä»¶</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">FileUpload</span>(<span class="hljs-params">{ id, refreshTrigger }</span>) {
  <span class="hljs-keyword">const</span> [pictures, setPictures] = <span class="hljs-title function_">useState</span>([]);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (id) {
      <span class="hljs-comment">// å½“ id æˆ– refreshTrigger å˜åŒ–æ—¶ï¼Œé‡æ–°åŠ è½½å›¾ç‰‡</span>
      <span class="hljs-title function_">fetchImages</span>(id).<span class="hljs-title function_">then</span>(setPictures);
    }
  }, [id, refreshTrigger]); <span class="hljs-comment">// â† å…³é”®ï¼šä¾èµ– refreshTrigger</span>
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {pictures.map(pic =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{pic.url}</span> /&gt;</span>)}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h4 data-id="heading-13">å·¥ä½œåŸç†</h4>
<pre><code class="hljs language-scss" lang="scss">ç”¨æˆ·æ“ä½œ â†’ <span class="hljs-built_in">triggerRefresh</span>() â†’ trigger: <span class="hljs-number">0</span> â†’ <span class="hljs-number">1</span> â†’ <span class="hljs-number">2</span> â†’ ...
                                    â†“
                        useEffect æ£€æµ‹åˆ°ä¾èµ–å˜åŒ–
                                    â†“
                            é‡æ–°æ‰§è¡Œå‰¯ä½œç”¨
</code></pre>
<h4 data-id="heading-14">ä¼˜åŠ¿æ€»ç»“</h4>
<p>âœ… <strong>å£°æ˜å¼</strong> - ç¬¦åˆ React ç†å¿µï¼Œæ•°æ®æµæ¸…æ™°<br/>
âœ… <strong>è½»é‡çº§</strong> - åªè§¦å‘ effectï¼Œä¸é‡æ–°æŒ‚è½½ç»„ä»¶<br/>
âœ… <strong>å¯é¢„æµ‹</strong> - çˆ¶ç»„ä»¶æ§åˆ¶ï¼Œå­ç»„ä»¶å“åº”<br/>
âœ… <strong>å¯å¤ç”¨</strong> - Hook å¯åœ¨ä»»ä½•åœºæ™¯ä½¿ç”¨<br/>
âœ… <strong>æ€§èƒ½å¥½</strong> - ä¸ä¼šä¸¢å¤±ç»„ä»¶çŠ¶æ€</p>
<hr/>
<h3 data-id="heading-15">å…¶ä»– 9 ç§å®ç”¨ Hook æ¨¡å¼</h3>
<h4 data-id="heading-16">1. Toggle Pattern - å¼€å…³æ¨¡å¼</h4>
<p>ç®¡ç†å¸ƒå°”çŠ¶æ€çš„åˆ‡æ¢ï¼Œæ¯” <code>useState</code> æ›´æ–¹ä¾¿ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useToggle</span> = (<span class="hljs-params">initialValue = <span class="hljs-literal">false</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> [value, setValue] = <span class="hljs-title function_">useState</span>(initialValue);
  
  <span class="hljs-keyword">const</span> toggle = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setValue</span>(<span class="hljs-function"><span class="hljs-params">v</span> =&gt;</span> !v), []);
  <span class="hljs-keyword">const</span> setTrue = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setValue</span>(<span class="hljs-literal">true</span>), []);
  <span class="hljs-keyword">const</span> setFalse = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setValue</span>(<span class="hljs-literal">false</span>), []);
  
  <span class="hljs-keyword">return</span> [value, { toggle, setTrue, setFalse }];
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Modal</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [isOpen, { toggle, setTrue, setFalse }] = <span class="hljs-title function_">useToggle</span>(<span class="hljs-literal">false</span>);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{setTrue}</span>&gt;</span>æ‰“å¼€<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Dialog</span> <span class="hljs-attr">visible</span>=<span class="hljs-string">{isOpen}</span> <span class="hljs-attr">onClose</span>=<span class="hljs-string">{setFalse}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> æ¨¡æ€æ¡†ã€æŠ˜å é¢æ¿ã€æ˜¾ç¤º/éšè—</p>
<hr/>
<h4 data-id="heading-17">2. Previous Value Pattern - è®°å½•ä¸Šä¸€æ¬¡çš„å€¼</h4>
<p>è·å–çŠ¶æ€çš„å‰ä¸€ä¸ªå€¼ï¼Œç”¨äºå¯¹æ¯”ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">usePrevious</span> = (<span class="hljs-params">value</span>) =&gt; {
  <span class="hljs-keyword">const</span> ref = <span class="hljs-title function_">useRef</span>();
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    ref.<span class="hljs-property">current</span> = value;
  }, [value]);
  
  <span class="hljs-keyword">return</span> ref.<span class="hljs-property">current</span>;
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Counter</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> prevCount = <span class="hljs-title function_">usePrevious</span>(count);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å½“å‰: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä¸Šä¸€æ¬¡: {prevCount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å˜åŒ–: {count - (prevCount || 0)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> å¯¹æ¯”æ–°æ—§å€¼ã€æ’¤é”€æ“ä½œã€åŠ¨ç”»è¿‡æ¸¡</p>
<hr/>
<h4 data-id="heading-18">3. Debounce Pattern - é˜²æŠ–æ¨¡å¼</h4>
<p>å»¶è¿Ÿæ‰§è¡Œï¼Œé¿å…é¢‘ç¹è§¦å‘ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useDebounce</span> = (<span class="hljs-params">value, delay = <span class="hljs-number">500</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> [debouncedValue, setDebouncedValue] = <span class="hljs-title function_">useState</span>(value);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {
      <span class="hljs-title function_">setDebouncedValue</span>(value);
    }, delay);
    
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearTimeout</span>(timer);
  }, [value, delay]);
  
  <span class="hljs-keyword">return</span> debouncedValue;
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">SearchBox</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> debouncedSearchTerm = <span class="hljs-title function_">useDebounce</span>(searchTerm, <span class="hljs-number">500</span>);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (debouncedSearchTerm) {
      <span class="hljs-title function_">searchAPI</span>(debouncedSearchTerm); <span class="hljs-comment">// åªåœ¨åœæ­¢è¾“å…¥ 500ms åæœç´¢</span>
    }
  }, [debouncedSearchTerm]);
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{searchTerm}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setSearchTerm(e.target.value)} /&gt;</span>;
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> æœç´¢è¾“å…¥ã€çª—å£ resizeã€æ»šåŠ¨äº‹ä»¶</p>
<hr/>
<h4 data-id="heading-19">4. Async State Pattern - å¼‚æ­¥çŠ¶æ€ç®¡ç†</h4>
<p>ç»Ÿä¸€ç®¡ç†å¼‚æ­¥è¯·æ±‚çš„åŠ è½½ã€æˆåŠŸã€å¤±è´¥çŠ¶æ€ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useAsync</span> = (<span class="hljs-params">asyncFunction</span>) =&gt; {
  <span class="hljs-keyword">const</span> [state, setState] = <span class="hljs-title function_">useState</span>({
    <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
  });
  
  <span class="hljs-keyword">const</span> execute = <span class="hljs-title function_">useCallback</span>(<span class="hljs-keyword">async</span> (...params) =&gt; {
    <span class="hljs-title function_">setState</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });
    
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">asyncFunction</span>(...params);
      <span class="hljs-title function_">setState</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>, data, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });
      <span class="hljs-keyword">return</span> data;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-title function_">setState</span>({ <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>, error });
      <span class="hljs-keyword">throw</span> error;
    }
  }, [asyncFunction]);
  
  <span class="hljs-keyword">return</span> { ...state, execute };
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">UserProfile</span>(<span class="hljs-params">{ userId }</span>) {
  <span class="hljs-keyword">const</span> { loading, data, error, execute } = <span class="hljs-title function_">useAsync</span>(fetchUserData);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">execute</span>(userId);
  }, [userId]);
  
  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>åŠ è½½ä¸­...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>é”™è¯¯: {error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>ç”¨æˆ·å: {data.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> API è°ƒç”¨ã€æ•°æ®åŠ è½½</p>
<hr/>
<h4 data-id="heading-20">5. Local Storage Pattern - æŒä¹…åŒ–çŠ¶æ€</h4>
<p>è‡ªåŠ¨åŒæ­¥çŠ¶æ€åˆ° localStorageï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useLocalStorage</span> = (<span class="hljs-params">key, initialValue</span>) =&gt; {
  <span class="hljs-keyword">const</span> [storedValue, setStoredValue] = <span class="hljs-title function_">useState</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">window</span>.<span class="hljs-property">localStorage</span>.<span class="hljs-title function_">getItem</span>(key);
      <span class="hljs-keyword">return</span> item ? <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(item) : initialValue;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">return</span> initialValue;
    }
  });
  
  <span class="hljs-keyword">const</span> setValue = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> valueToStore = value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Function</span> ? <span class="hljs-title function_">value</span>(storedValue) : value;
      <span class="hljs-title function_">setStoredValue</span>(valueToStore);
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">localStorage</span>.<span class="hljs-title function_">setItem</span>(key, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(valueToStore));
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(error);
    }
  }, [key, storedValue]);
  
  <span class="hljs-keyword">return</span> [storedValue, setValue];
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ThemeSelector</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [theme, setTheme] = <span class="hljs-title function_">useLocalStorage</span>(<span class="hljs-string">'theme'</span>, <span class="hljs-string">'light'</span>);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setTheme(theme === 'light' ? 'dark' : 'light')}&gt;
      å½“å‰ä¸»é¢˜: {theme}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> ç”¨æˆ·åå¥½è®¾ç½®ã€è¡¨å•è‰ç¨¿ã€ä¸»é¢˜åˆ‡æ¢</p>
<hr/>
<h4 data-id="heading-21">6. Interval Pattern - å®šæ—¶å™¨æ¨¡å¼</h4>
<p>å®‰å…¨åœ°ä½¿ç”¨ setIntervalï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useInterval</span> = (<span class="hljs-params">callback, delay</span>) =&gt; {
  <span class="hljs-keyword">const</span> savedCallback = <span class="hljs-title function_">useRef</span>();
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    savedCallback.<span class="hljs-property">current</span> = callback;
  }, [callback]);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (delay !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> savedCallback.<span class="hljs-title function_">current</span>(), delay);
      <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">clearInterval</span>(id);
    }
  }, [delay]);
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Countdown</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [count, setCount] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">60</span>);
  
  <span class="hljs-title function_">useInterval</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span>) <span class="hljs-title function_">setCount</span>(count - <span class="hljs-number">1</span>);
  }, <span class="hljs-number">1000</span>);
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>å€’è®¡æ—¶: {count}ç§’<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> å€’è®¡æ—¶ã€è½®è¯¢ã€å®æ—¶æ›´æ–°</p>
<hr/>
<h4 data-id="heading-22">7. Mount Status Pattern - ç»„ä»¶æŒ‚è½½çŠ¶æ€</h4>
<p>é¿å…åœ¨ç»„ä»¶å¸è½½åæ›´æ–°çŠ¶æ€ï¼ˆé˜²æ­¢å†…å­˜æ³„æ¼ï¼‰ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useIsMounted</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-keyword">const</span> isMounted = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">false</span>);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    isMounted.<span class="hljs-property">current</span> = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      isMounted.<span class="hljs-property">current</span> = <span class="hljs-literal">false</span>;
    };
  }, []);
  
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> isMounted.<span class="hljs-property">current</span>, []);
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">SafeAsyncComponent</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [data, setData] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> isMounted = <span class="hljs-title function_">useIsMounted</span>();
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">fetchData</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isMounted</span>()) { <span class="hljs-comment">// åªåœ¨ç»„ä»¶è¿˜æŒ‚è½½æ—¶æ‰æ›´æ–°</span>
        <span class="hljs-title function_">setData</span>(result);
      }
    });
  }, []);
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{data}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> å¼‚æ­¥æ“ä½œã€å»¶è¿Ÿæ›´æ–°</p>
<hr/>
<h4 data-id="heading-23">8. Composite Pattern - ç»„åˆæ¨¡å¼</h4>
<p>å°†å¤šä¸ªç›¸å…³çš„ Hook ç»„åˆæˆä¸€ä¸ªä¸šåŠ¡ Hookï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useSearchableList</span> = (<span class="hljs-params">fetchFunction</span>) =&gt; {
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> [refreshTrigger, triggerRefresh] = <span class="hljs-title function_">useRefreshTrigger</span>();
  <span class="hljs-keyword">const</span> debouncedSearchTerm = <span class="hljs-title function_">useDebounce</span>(searchTerm, <span class="hljs-number">300</span>);
  <span class="hljs-keyword">const</span> { loading, data, error, execute } = <span class="hljs-title function_">useAsync</span>(fetchFunction);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">execute</span>(debouncedSearchTerm);
  }, [debouncedSearchTerm, refreshTrigger]);
  
  <span class="hljs-keyword">return</span> {
    searchTerm,
    setSearchTerm,
    loading,
    data,
    error,
    <span class="hljs-attr">refresh</span>: triggerRefresh,
  };
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">ProductList</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> { searchTerm, setSearchTerm, loading, data, refresh } = 
    <span class="hljs-title function_">useSearchableList</span>(searchProducts);
  
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{searchTerm}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{e</span> =&gt;</span> setSearchTerm(e.target.value)} /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{refresh}</span>&gt;</span>åˆ·æ–°<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      {loading ? 'åŠ è½½ä¸­...' : data?.map(item =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>)}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> è¡¨å•ç®¡ç†ã€åˆ†é¡µåˆ—è¡¨ã€æœç´¢åŠŸèƒ½</p>
<hr/>
<h4 data-id="heading-24">9. Event Listener Pattern - äº‹ä»¶ç›‘å¬æ¨¡å¼</h4>
<p>å®‰å…¨åœ°æ·»åŠ å’Œç§»é™¤äº‹ä»¶ç›‘å¬å™¨ï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useEventListener</span> = (<span class="hljs-params">eventName, handler, element = <span class="hljs-variable language_">window</span></span>) =&gt; {
  <span class="hljs-keyword">const</span> savedHandler = <span class="hljs-title function_">useRef</span>();
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    savedHandler.<span class="hljs-property">current</span> = handler;
  }, [handler]);
  
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> isSupported = element &amp;&amp; element.<span class="hljs-property">addEventListener</span>;
    <span class="hljs-keyword">if</span> (!isSupported) <span class="hljs-keyword">return</span>;
    
    <span class="hljs-keyword">const</span> <span class="hljs-title function_">eventListener</span> = (<span class="hljs-params">event</span>) =&gt; savedHandler.<span class="hljs-title function_">current</span>(event);
    element.<span class="hljs-title function_">addEventListener</span>(eventName, eventListener);
    
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      element.<span class="hljs-title function_">removeEventListener</span>(eventName, eventListener);
    };
  }, [eventName, element]);
};

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">KeyboardShortcuts</span>(<span class="hljs-params"/>) {
  <span class="hljs-title function_">useEventListener</span>(<span class="hljs-string">'keydown'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (e.<span class="hljs-property">ctrlKey</span> &amp;&amp; e.<span class="hljs-property">key</span> === <span class="hljs-string">'s'</span>) {
      e.<span class="hljs-title function_">preventDefault</span>();
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ä¿å­˜å¿«æ·é”®è§¦å‘'</span>);
    }
  });
  
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>æŒ‰ Ctrl+S ä¿å­˜<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</code></pre>
<p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> é”®ç›˜äº‹ä»¶ã€çª—å£äº‹ä»¶ã€è‡ªå®šä¹‰äº‹ä»¶</p>
<hr/>
<h3 data-id="heading-25">Hook è®¾è®¡åŸåˆ™</h3>
<h4 data-id="heading-26">1. å•ä¸€èŒè´£åŸåˆ™</h4>
<p>æ¯ä¸ª Hook åªåšä¸€ä»¶äº‹ï¼Œä¿æŒç®€å•å’Œä¸“æ³¨ã€‚</p>
<h4 data-id="heading-27">2. å¯ç»„åˆæ€§</h4>
<p>å° Hook å¯ä»¥ç»„åˆæˆå¤§ Hookï¼Œå°±åƒä¹é«˜ç§¯æœ¨ã€‚</p>
<h4 data-id="heading-28">3. å£°æ˜å¼</h4>
<p>é€šè¿‡ props å’Œè¿”å›å€¼ä¼ é€’æ•°æ®ï¼Œé¿å…å‘½ä»¤å¼è°ƒç”¨ã€‚</p>
<h4 data-id="heading-29">4. å¯æµ‹è¯•æ€§</h4>
<p>é€»è¾‘ç‹¬ç«‹ï¼Œæ˜“äºå•å…ƒæµ‹è¯•ã€‚</p>
<h4 data-id="heading-30">5. å¯å¤ç”¨æ€§</h4>
<p>ä¸ä¾èµ–å…·ä½“ä¸šåŠ¡ï¼Œé€šç”¨æ€§å¼ºã€‚</p>
<hr/>
<h3 data-id="heading-31">å‘½åè§„èŒƒ</h3>
<h4 data-id="heading-32">Hook å‘½å</h4>
<ul>
<li>æ ¼å¼ï¼š<code>use</code> + åŠŸèƒ½æè¿°ï¼ˆé©¼å³°å‘½åï¼‰</li>
<li>ç¤ºä¾‹ï¼š<code>useRefreshTrigger</code>, <code>useToggle</code>, <code>useDebounce</code></li>
</ul>
<h4 data-id="heading-33">è¿”å›å€¼è§„èŒƒ</h4>
<ul>
<li>
<p><strong>å•ä¸ªå€¼</strong>ï¼šç›´æ¥è¿”å›</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> debouncedValue = <span class="hljs-title function_">useDebounce</span>(value);
</code></pre>
</li>
<li>
<p><strong>ä¸¤ä¸ªå€¼</strong>ï¼šè¿”å›æ•°ç»„ï¼ˆç±»ä¼¼ useStateï¼‰</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [trigger, fire] = <span class="hljs-title function_">useRefreshTrigger</span>();
<span class="hljs-keyword">const</span> [isOpen, { toggle }] = <span class="hljs-title function_">useToggle</span>();
</code></pre>
</li>
<li>
<p><strong>å¤šä¸ªå€¼</strong>ï¼šè¿”å›å¯¹è±¡</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { loading, data, error, execute } = <span class="hljs-title function_">useAsync</span>(fetchData);
</code></pre>
</li>
</ul>
<hr/>
<h3 data-id="heading-34">å®æˆ˜æ¡ˆä¾‹ï¼šå®Œæ•´çš„åˆ—è¡¨åˆ·æ–°æ–¹æ¡ˆ</h3>
<p>ç»“åˆå¤šä¸ª Hook æ¨¡å¼ï¼Œå®ç°ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨é¡µï¼š</p>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useRefreshTrigger } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks/useRefreshTrigger'</span>;
<span class="hljs-keyword">import</span> { useDebounce } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks/useDebounce'</span>;
<span class="hljs-keyword">import</span> { useAsync } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks/useAsync'</span>;

<span class="hljs-keyword">function</span> <span class="hljs-title function_">QualityInspectionRecords</span>(<span class="hljs-params">{ route, navigation }</span>) {
  <span class="hljs-comment">// 1. åˆ·æ–°è§¦å‘å™¨</span>
  <span class="hljs-keyword">const</span> [refreshTrigger, triggerRefresh] = <span class="hljs-title function_">useRefreshTrigger</span>();
  
  <span class="hljs-comment">// 2. æœç´¢é˜²æŠ–</span>
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
  <span class="hljs-keyword">const</span> debouncedSearchTerm = <span class="hljs-title function_">useDebounce</span>(searchTerm, <span class="hljs-number">300</span>);
  
  <span class="hljs-comment">// 3. å¼‚æ­¥æ•°æ®åŠ è½½</span>
  <span class="hljs-keyword">const</span> { loading, data, execute } = <span class="hljs-title function_">useAsync</span>(fetchRecords);
  
  <span class="hljs-comment">// 4. åŠ è½½æ•°æ®</span>
  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">execute</span>(route.<span class="hljs-property">params</span>?.<span class="hljs-property">outsourcingId</span>, debouncedSearchTerm);
  }, [route.<span class="hljs-property">params</span>?.<span class="hljs-property">outsourcingId</span>, debouncedSearchTerm, refreshTrigger]);
  
  <span class="hljs-comment">// 5. åˆ·æ–°å‡½æ•°</span>
  <span class="hljs-keyword">const</span> refresh = <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">triggerRefresh</span>();
  }, [triggerRefresh]);
  
  <span class="hljs-comment">// 6. æ¸²æŸ“</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">SearchBar</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{searchTerm}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{setSearchTerm}</span> /&gt;</span>
      
      {loading ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">Loading</span> /&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">FlatList</span>
          <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span>
          <span class="hljs-attr">renderItem</span>=<span class="hljs-string">{({</span> <span class="hljs-attr">item</span> }) =&gt;</span> (
            <span class="hljs-tag">&lt;<span class="hljs-name">View</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">FileUpload</span> 
                <span class="hljs-attr">id</span>=<span class="hljs-string">{item.id}</span> 
                <span class="hljs-attr">refreshTrigger</span>=<span class="hljs-string">{refreshTrigger}</span> // <span class="hljs-attr">ä¼ é€’è§¦å‘å™¨</span>
              /&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> 
                <span class="hljs-attr">onPress</span>=<span class="hljs-string">{()</span> =&gt;</span> navigation.navigate('Edit', {
                  item,
                  onBack: refresh, // ç¼–è¾‘å®Œæˆååˆ·æ–°
                })}
              &gt;
                ç¼–è¾‘
              <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span>
          )}
        /&gt;
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">View</span>&gt;</span></span>
  );
}
</code></pre>
<hr/>
<h3 data-id="heading-35">æ€»ç»“</h3>
<p>Hook æ¨¡å¼çš„æ ¸å¿ƒæ˜¯<strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong>å’Œ<strong>é€»è¾‘å¤ç”¨</strong>ã€‚é€šè¿‡å°†å¸¸è§çš„çŠ¶æ€é€»è¾‘å°è£…æˆ Hookï¼Œæˆ‘ä»¬å¯ä»¥ï¼š</p>
<ol>
<li>âœ… å‡å°‘é‡å¤ä»£ç </li>
<li>âœ… æé«˜ä»£ç å¯è¯»æ€§</li>
<li>âœ… ç®€åŒ–ç»„ä»¶é€»è¾‘</li>
<li>âœ… æå‡å¯ç»´æŠ¤æ€§</li>
<li>âœ… ä¾¿äºå•å…ƒæµ‹è¯•</li>
</ol>
<p>è§¦å‘å™¨æ¨¡å¼åªæ˜¯å…¶ä¸­ä¸€ç§ï¼ŒæŒæ¡è¿™äº›æ¨¡å¼åï¼Œä½ ä¼šå‘ç° React å¼€å‘å˜å¾—æ›´åŠ ä¼˜é›…å’Œé«˜æ•ˆã€‚</p>
<hr/>
<h3 data-id="heading-36">å‚è€ƒèµ„æº</h3>
<ul>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Freact.dev%2Freference%2Freact" target="_blank" title="https://react.dev/reference/react" ref="nofollow noopener noreferrer">React Hooks å®˜æ–¹æ–‡æ¡£</a></li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fusehooks.com%2F" target="_blank" title="https://usehooks.com/" ref="nofollow noopener noreferrer">usehooks.com</a> - Hook ç¤ºä¾‹é›†åˆ</li>
<li><a href="https://link.juejin.cn?target=https%3A%2F%2Fahooks.js.org%2F" target="_blank" title="https://ahooks.js.org/" ref="nofollow noopener noreferrer">ahooks</a> - é˜¿é‡Œå¼€æºçš„ Hook åº“</li>
</ul>
<hr/>
<p><strong>ä½œè€…ï¼š</strong> [ä½ çš„åå­—]<br/>
<strong>æ—¥æœŸï¼š</strong> 2026-01-10<br/>
<strong>æ ‡ç­¾ï¼š</strong> React, Hooks, è®¾è®¡æ¨¡å¼, æœ€ä½³å®è·µ</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[React Native Hooks å¿«é€Ÿå‚è€ƒå¡]]></title>    <link>https://juejin.cn/post/7593261984189317170</link>    <guid>https://juejin.cn/post/7593261984189317170</guid>    <pubDate>2026-01-10T05:33:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593261984189317170" data-draft-id="7593212374921822235" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="React Native Hooks å¿«é€Ÿå‚è€ƒå¡"/> <meta itemprop="keywords" content="React Native"/> <meta itemprop="datePublished" content="2026-01-10T05:33:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨ç‹‚ä¹‹é€¸æ‰"/> <meta itemprop="url" content="https://juejin.cn/user/624178332441166"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            React Native Hooks å¿«é€Ÿå‚è€ƒå¡
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624178332441166/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨ç‹‚ä¹‹é€¸æ‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T05:33:39.000Z" title="Sat Jan 10 2026 05:33:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">React Native Hooks å¿«é€Ÿå‚è€ƒå¡</h2>
<h3 data-id="heading-1">ğŸ¯ é¡¹ç›®è‡ªå®šä¹‰ Hooks</h3>
<h4 data-id="heading-2">useRefreshTrigger</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useRefreshTrigger } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks'</span>;

<span class="hljs-keyword">const</span> [trigger, fire] = <span class="hljs-title function_">useRefreshTrigger</span>();
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span> <span class="hljs-attr">refreshTrigger</span>=<span class="hljs-string">{trigger}</span> /&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{fire}</span>&gt;</span>åˆ·æ–°<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-3">useToggle</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useToggle } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks'</span>;

<span class="hljs-keyword">const</span> [isOpen, { toggle, setTrue, setFalse }] = <span class="hljs-title function_">useToggle</span>(<span class="hljs-literal">false</span>);
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Modal</span> <span class="hljs-attr">visible</span>=<span class="hljs-string">{isOpen}</span> <span class="hljs-attr">onClose</span>=<span class="hljs-string">{setFalse}</span> /&gt;</span></span>
</code></pre>
<h4 data-id="heading-4">useDebounce</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useDebounce } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks'</span>;

<span class="hljs-keyword">const</span> [text, setText] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
<span class="hljs-keyword">const</span> debouncedText = <span class="hljs-title function_">useDebounce</span>(text, <span class="hljs-number">500</span>);
</code></pre>
<h4 data-id="heading-5">useAsync</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useAsync } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks'</span>;

<span class="hljs-keyword">const</span> { loading, data, error, execute } = <span class="hljs-title function_">useAsync</span>(fetchData);
<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> { <span class="hljs-title function_">execute</span>(id); }, [id]);
</code></pre>
<h4 data-id="heading-6">usePrevious</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { usePrevious } <span class="hljs-keyword">from</span> <span class="hljs-string">'@/hooks'</span>;

<span class="hljs-keyword">const</span> prevValue = <span class="hljs-title function_">usePrevious</span>(currentValue);
</code></pre>
<hr/>
<h3 data-id="heading-7">ğŸ“¦ æ¨èç¬¬ä¸‰æ–¹åº“</h3>
<h4 data-id="heading-8">ahooksï¼ˆæ¨èå®‰è£…ï¼‰</h4>
<pre><code class="hljs language-bash" lang="bash">yarn add ahooks
</code></pre>
<h5 data-id="heading-9">çŠ¶æ€ç®¡ç†</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useBoolean, useToggle, useSet, useMap } <span class="hljs-keyword">from</span> <span class="hljs-string">'ahooks'</span>;

<span class="hljs-keyword">const</span> [state, { toggle, setTrue, setFalse }] = <span class="hljs-title function_">useBoolean</span>(<span class="hljs-literal">false</span>);
</code></pre>
<h5 data-id="heading-10">å‰¯ä½œç”¨</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useDebounce, useThrottle, useInterval } <span class="hljs-keyword">from</span> <span class="hljs-string">'ahooks'</span>;

<span class="hljs-keyword">const</span> debouncedValue = <span class="hljs-title function_">useDebounce</span>(value, { <span class="hljs-attr">wait</span>: <span class="hljs-number">500</span> });
</code></pre>
<h5 data-id="heading-11">æ•°æ®è¯·æ±‚</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useRequest } <span class="hljs-keyword">from</span> <span class="hljs-string">'ahooks'</span>;

<span class="hljs-keyword">const</span> { data, loading, error, run, refresh } = <span class="hljs-title function_">useRequest</span>(getUser, {
  <span class="hljs-attr">manual</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">debounceWait</span>: <span class="hljs-number">300</span>,
  <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data),
});
</code></pre>
<h5 data-id="heading-12">ç”Ÿå‘½å‘¨æœŸ</h5>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useMount, useUnmount, useUpdateEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">'ahooks'</span>;

<span class="hljs-title function_">useMount</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶æŒ‚è½½'</span>));
<span class="hljs-title function_">useUnmount</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'ç»„ä»¶å¸è½½'</span>));
<span class="hljs-title function_">useUpdateEffect</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'æ›´æ–°ï¼Œè·³è¿‡é¦–æ¬¡'</span>), [dep]);
</code></pre>
<hr/>
<h4 data-id="heading-13">@react-native-community/hooks</h4>
<pre><code class="hljs language-bash" lang="bash">yarn add @react-native-community/hooks
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> {
  useAppState,        <span class="hljs-comment">// åº”ç”¨å‰åå°çŠ¶æ€</span>
  useBackHandler,     <span class="hljs-comment">// Android è¿”å›é”®</span>
  useClipboard,       <span class="hljs-comment">// å‰ªè´´æ¿</span>
  useDimensions,      <span class="hljs-comment">// å±å¹•å°ºå¯¸</span>
  useKeyboard,        <span class="hljs-comment">// é”®ç›˜çŠ¶æ€</span>
  useDeviceOrientation, <span class="hljs-comment">// è®¾å¤‡æ–¹å‘</span>
  useLayout,          <span class="hljs-comment">// ç»„ä»¶å¸ƒå±€</span>
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@react-native-community/hooks'</span>;

<span class="hljs-comment">// åº”ç”¨çŠ¶æ€</span>
<span class="hljs-keyword">const</span> appState = <span class="hljs-title function_">useAppState</span>(); <span class="hljs-comment">// 'active' | 'background' | 'inactive'</span>

<span class="hljs-comment">// è¿”å›é”®</span>
<span class="hljs-title function_">useBackHandler</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-comment">// è¿”å› true é˜»æ­¢é»˜è®¤è¡Œä¸º</span>
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
});

<span class="hljs-comment">// å‰ªè´´æ¿</span>
<span class="hljs-keyword">const</span> [data, setString] = <span class="hljs-title function_">useClipboard</span>();

<span class="hljs-comment">// å±å¹•å°ºå¯¸</span>
<span class="hljs-keyword">const</span> { screen, <span class="hljs-variable language_">window</span> } = <span class="hljs-title function_">useDimensions</span>();

<span class="hljs-comment">// é”®ç›˜</span>
<span class="hljs-keyword">const</span> keyboard = <span class="hljs-title function_">useKeyboard</span>();
<span class="hljs-comment">// keyboard.keyboardShown: boolean</span>
<span class="hljs-comment">// keyboard.keyboardHeight: number</span>

<span class="hljs-comment">// è®¾å¤‡æ–¹å‘</span>
<span class="hljs-keyword">const</span> orientation = <span class="hljs-title function_">useDeviceOrientation</span>(); <span class="hljs-comment">// 'portrait' | 'landscape'</span>

<span class="hljs-comment">// å¸ƒå±€</span>
<span class="hljs-keyword">const</span> { onLayout, width, height, x, y } = <span class="hljs-title function_">useLayout</span>();
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">View</span> <span class="hljs-attr">onLayout</span>=<span class="hljs-string">{onLayout}</span> /&gt;</span></span>
</code></pre>
<hr/>
<h4 data-id="heading-14">react-hook-form</h4>
<pre><code class="hljs language-bash" lang="bash">yarn add react-hook-form
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useForm, <span class="hljs-title class_">Controller</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-hook-form'</span>;

<span class="hljs-keyword">const</span> { control, handleSubmit, <span class="hljs-attr">formState</span>: { errors } } = <span class="hljs-title function_">useForm</span>();

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Controller</span>
  <span class="hljs-attr">control</span>=<span class="hljs-string">{control}</span>
  <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span>
  <span class="hljs-attr">rules</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">required:</span> '<span class="hljs-attr">å¿…å¡«</span>' }}
  <span class="hljs-attr">render</span>=<span class="hljs-string">{({</span> <span class="hljs-attr">field:</span> { <span class="hljs-attr">onChange</span>, <span class="hljs-attr">value</span> } }) =&gt;</span> (
    <span class="hljs-tag">&lt;<span class="hljs-name">TextInput</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChangeText</span>=<span class="hljs-string">{onChange}</span> /&gt;</span>
  )}
/&gt;</span>
</code></pre>
<hr/>
<h4 data-id="heading-15">@tanstack/react-query</h4>
<pre><code class="hljs language-bash" lang="bash">yarn add @tanstack/react-query
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { useQuery, useMutation } <span class="hljs-keyword">from</span> <span class="hljs-string">'@tanstack/react-query'</span>;

<span class="hljs-comment">// æŸ¥è¯¢</span>
<span class="hljs-keyword">const</span> { data, isLoading, error, refetch } = <span class="hljs-title function_">useQuery</span>({
  <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">'users'</span>],
  <span class="hljs-attr">queryFn</span>: fetchUsers,
  <span class="hljs-attr">staleTime</span>: <span class="hljs-number">5000</span>,
});

<span class="hljs-comment">// ä¿®æ”¹</span>
<span class="hljs-keyword">const</span> mutation = <span class="hljs-title function_">useMutation</span>({
  <span class="hljs-attr">mutationFn</span>: createUser,
  <span class="hljs-attr">onSuccess</span>: <span class="hljs-function">() =&gt;</span> {
    queryClient.<span class="hljs-title function_">invalidateQueries</span>({ <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">'users'</span>] });
  },
});
</code></pre>
<hr/>
<h4 data-id="heading-16">zustand</h4>
<pre><code class="hljs language-bash" lang="bash">yarn add zustand
</code></pre>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;

<span class="hljs-keyword">const</span> useStore = <span class="hljs-title function_">create</span>(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
  <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">increment</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">set</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">count</span>: state.<span class="hljs-property">count</span> + <span class="hljs-number">1</span> })),
}));

<span class="hljs-comment">// ä½¿ç”¨</span>
<span class="hljs-keyword">const</span> count = <span class="hljs-title function_">useStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">count</span>);
<span class="hljs-keyword">const</span> increment = <span class="hljs-title function_">useStore</span>(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.<span class="hljs-property">increment</span>);
</code></pre>
<hr/>
<h4 data-id="heading-17">@react-navigation/native</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">import</span> {
  useNavigation,
  useRoute,
  useFocusEffect,
  useIsFocused,
} <span class="hljs-keyword">from</span> <span class="hljs-string">'@react-navigation/native'</span>;

<span class="hljs-keyword">const</span> navigation = <span class="hljs-title function_">useNavigation</span>();
<span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>();
<span class="hljs-keyword">const</span> isFocused = <span class="hljs-title function_">useIsFocused</span>();

<span class="hljs-title function_">useFocusEffect</span>(
  <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-comment">// é¡µé¢èšç„¦æ—¶æ‰§è¡Œ</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-comment">// é¡µé¢å¤±ç„¦æ—¶æ‰§è¡Œ</span>
    };
  }, [])
);
</code></pre>
<hr/>
<h3 data-id="heading-18">ğŸ”¥ å¸¸è§åœºæ™¯é€ŸæŸ¥</h3>
<h4 data-id="heading-19">æœç´¢é˜²æŠ–</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [keyword, setKeyword] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">''</span>);
<span class="hljs-keyword">const</span> debouncedKeyword = <span class="hljs-title function_">useDebounce</span>(keyword, <span class="hljs-number">500</span>);

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (debouncedKeyword) {
    <span class="hljs-title function_">searchAPI</span>(debouncedKeyword);
  }
}, [debouncedKeyword]);
</code></pre>
<h4 data-id="heading-20">æ¨¡æ€æ¡†æ§åˆ¶</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [visible, { <span class="hljs-attr">setTrue</span>: open, <span class="hljs-attr">setFalse</span>: close }] = <span class="hljs-title function_">useToggle</span>(<span class="hljs-literal">false</span>);

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Modal</span> <span class="hljs-attr">visible</span>=<span class="hljs-string">{visible}</span> <span class="hljs-attr">onClose</span>=<span class="hljs-string">{close}</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{close}</span>&gt;</span>å…³é—­<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-21">åˆ—è¡¨åˆ·æ–°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [refreshTrigger, triggerRefresh] = <span class="hljs-title function_">useRefreshTrigger</span>();

<span class="hljs-keyword">const</span> <span class="hljs-title function_">refresh</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">fetchData</span>();
  <span class="hljs-title function_">triggerRefresh</span>();
};

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FlatList</span>
  <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span>
  <span class="hljs-attr">renderItem</span>=<span class="hljs-string">{({</span> <span class="hljs-attr">item</span> }) =&gt;</span> (
    <span class="hljs-tag">&lt;<span class="hljs-name">ItemCard</span> <span class="hljs-attr">refreshTrigger</span>=<span class="hljs-string">{refreshTrigger}</span> /&gt;</span>
  )}
/&gt;</span>
</code></pre>
<h4 data-id="heading-22">é”®ç›˜é€‚é…</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> keyboard = <span class="hljs-title function_">useKeyboard</span>();

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">KeyboardAvoidingView</span>
  <span class="hljs-attr">behavior</span>=<span class="hljs-string">{Platform.OS</span> === <span class="hljs-string">'ios'</span> ? '<span class="hljs-attr">padding</span>' <span class="hljs-attr">:</span> '<span class="hljs-attr">height</span>'}
  <span class="hljs-attr">keyboardVerticalOffset</span>=<span class="hljs-string">{keyboard.keyboardHeight}</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">TextInput</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">KeyboardAvoidingView</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-23">é¡µé¢èšç„¦åˆ·æ–°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">useFocusEffect</span>(
  <span class="hljs-title function_">useCallback</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title function_">fetchData</span>();
  }, [])
);
</code></pre>
<h4 data-id="heading-24">è¿”å›é”®æ‹¦æˆª</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-title function_">useBackHandler</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">if</span> (hasUnsavedChanges) {
    <span class="hljs-title class_">Alert</span>.<span class="hljs-title function_">alert</span>(<span class="hljs-string">'æç¤º'</span>, <span class="hljs-string">'æœ‰æœªä¿å­˜çš„æ›´æ”¹'</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// é˜»æ­¢è¿”å›</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// å…è®¸è¿”å›</span>
});
</code></pre>
<h4 data-id="heading-25">å¼‚æ­¥æ•°æ®åŠ è½½</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { loading, data, error, execute } = <span class="hljs-title function_">useAsync</span>(fetchUser);

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-title function_">execute</span>(userId);
}, [userId]);

<span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Loading</span> /&gt;</span></span>;
<span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Error</span> <span class="hljs-attr">message</span>=<span class="hljs-string">{error.message}</span> /&gt;</span></span>;
<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span> /&gt;</span></span>;
</code></pre>
<h4 data-id="heading-26">è¡¨å•éªŒè¯</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> { control, handleSubmit, <span class="hljs-attr">formState</span>: { errors } } = <span class="hljs-title function_">useForm</span>();

<span class="hljs-keyword">const</span> <span class="hljs-title function_">onSubmit</span> = (<span class="hljs-params">data</span>) =&gt; {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);
};

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Controller</span>
  <span class="hljs-attr">control</span>=<span class="hljs-string">{control}</span>
  <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span>
  <span class="hljs-attr">rules</span>=<span class="hljs-string">{{</span>
    <span class="hljs-attr">required:</span> '<span class="hljs-attr">é‚®ç®±å¿…å¡«</span>',
    <span class="hljs-attr">pattern:</span> {
      <span class="hljs-attr">value:</span> /^[<span class="hljs-attr">A-Z0-9._</span>%+<span class="hljs-attr">-</span>]+@[<span class="hljs-attr">A-Z0-9.-</span>]+\<span class="hljs-attr">.</span>[<span class="hljs-attr">A-Z</span>]{<span class="hljs-attr">2</span>,}$/<span class="hljs-attr">i</span>,
      <span class="hljs-attr">message:</span> '<span class="hljs-attr">é‚®ç®±æ ¼å¼ä¸æ­£ç¡®</span>'
    }
  }}
  <span class="hljs-attr">render</span>=<span class="hljs-string">{({</span> <span class="hljs-attr">field:</span> { <span class="hljs-attr">onChange</span>, <span class="hljs-attr">value</span> } }) =&gt;</span> (
    <span class="hljs-tag">&lt;<span class="hljs-name">TextInput</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChangeText</span>=<span class="hljs-string">{onChange}</span> /&gt;</span>
  )}
/&gt;</span>
{errors.<span class="hljs-property">email</span> &amp;&amp; <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Text</span>&gt;</span>{errors.email.message}<span class="hljs-tag">&lt;/<span class="hljs-name">Text</span>&gt;</span></span>}
&lt;<span class="hljs-title class_">Button</span> onPress={<span class="hljs-title function_">handleSubmit</span>(onSubmit)}&gt;æäº¤&lt;/<span class="hljs-title class_">Button</span>&gt;
</code></pre>
<hr/>
<h3 data-id="heading-27">ğŸ“– å®Œæ•´æ–‡æ¡£</h3>
<ul>
<li><a href="https://link.juejin.cn?target=.%2FReact_Hook_Advanced_Patterns.md" target="_blank" title="./React_Hook_Advanced_Patterns.md" ref="nofollow noopener noreferrer">React Hook é«˜çº§æ¨¡å¼</a></li>
<li><a href="https://link.juejin.cn?target=.%2Ftrigger-pattern-diagram.md" target="_blank" title="./trigger-pattern-diagram.md" ref="nofollow noopener noreferrer">è§¦å‘å™¨æ¨¡å¼è¯¦è§£</a></li>
<li><a href="https://link.juejin.cn?target=.%2FReact_Native_Hooks_Libraries_Guide.md" target="_blank" title="./React_Native_Hooks_Libraries_Guide.md" ref="nofollow noopener noreferrer">React Native Hooks åº“æŒ‡å—</a></li>
<li><a href="https://link.juejin.cn?target=..%2Fsrc%2Fhooks%2FREADME.md" target="_blank" title="../src/hooks/README.md" ref="nofollow noopener noreferrer">é¡¹ç›® Hooks ä½¿ç”¨æŒ‡å—</a></li>
</ul>
<hr/>
<p><strong>æç¤ºï¼š</strong> å°†æ­¤æ–‡ä»¶ä¿å­˜ä¸ºä¹¦ç­¾ï¼Œéšæ—¶æŸ¥é˜…ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[useRefreshTriggerè§¦å‘å™¨æ¨¡å¼å·¥ä½œæµç¨‹å›¾è§£]]></title>    <link>https://juejin.cn/post/7593234983755694090</link>    <guid>https://juejin.cn/post/7593234983755694090</guid>    <pubDate>2026-01-10T05:36:07.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593234983755694090" data-draft-id="7593212374921838619" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="useRefreshTriggerè§¦å‘å™¨æ¨¡å¼å·¥ä½œæµç¨‹å›¾è§£"/> <meta itemprop="keywords" content="React Native"/> <meta itemprop="datePublished" content="2026-01-10T05:36:07.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="å¢¨ç‹‚ä¹‹é€¸æ‰"/> <meta itemprop="url" content="https://juejin.cn/user/624178332441166"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            useRefreshTriggerè§¦å‘å™¨æ¨¡å¼å·¥ä½œæµç¨‹å›¾è§£
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/624178332441166/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    å¢¨ç‹‚ä¹‹é€¸æ‰
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T05:36:07.000Z" title="Sat Jan 10 2026 05:36:07 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»2åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">è§¦å‘å™¨æ¨¡å¼å·¥ä½œæµç¨‹å›¾è§£</h2>
<h3 data-id="heading-1">å®Œæ•´æ•°æ®æµ</h3>
<pre><code class="hljs language-scss" lang="scss">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·æ“ä½œæµç¨‹                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ç”¨æˆ·ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  è¿›å…¥ç¼–è¾‘é¡µé¢ EditQa    â”‚
                    â”‚  ä¿®æ”¹å›¾ç‰‡å¹¶ä¿å­˜         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  è°ƒç”¨ <span class="hljs-built_in">onBack</span>() å›è°ƒ     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        çˆ¶ç»„ä»¶ (åˆ—è¡¨é¡µ)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  const <span class="hljs-selector-attr">[refreshTrigger, triggerRefresh]</span> = <span class="hljs-built_in">useRefreshTrigger</span>();  â”‚
â”‚                                                                  â”‚
â”‚  const refresh = () =&gt; {                                        â”‚
â”‚    <span class="hljs-built_in">query</span>({ ... });           <span class="hljs-comment">// â† 1. åˆ·æ–°åˆ—è¡¨æ•°æ®               â”‚</span>
â”‚    <span class="hljs-built_in">triggerRefresh</span>();         <span class="hljs-comment">// â† 2. è§¦å‘å›¾ç‰‡åˆ·æ–°               â”‚</span>
â”‚  };                                                              â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  <span class="hljs-built_in">triggerRefresh</span>() æ‰§è¡Œè¿‡ç¨‹ï¼š                      â”‚          â”‚
â”‚  â”‚                                                   â”‚          â”‚
â”‚  â”‚  <span class="hljs-built_in">setTrigger</span>(prev =&gt; prev + <span class="hljs-number">1</span>)                    â”‚          â”‚
â”‚  â”‚       â”‚                                           â”‚          â”‚
â”‚  â”‚       â–¼                                           â”‚          â”‚
â”‚  â”‚  refreshTrigger: <span class="hljs-number">0</span> â†’ <span class="hljs-number">1</span> â†’ <span class="hljs-number">2</span> â†’ <span class="hljs-number">3</span> ...              â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â”‚  &lt;FileUpload                                                    â”‚
â”‚    id={problem<span class="hljs-selector-class">.id</span>}                                              â”‚
â”‚    refreshTrigger={refreshTrigger}  <span class="hljs-comment">// â† ä¼ é€’è§¦å‘å™¨å€¼           â”‚</span>
â”‚  /&gt;                                                              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ props ä¼ é€’
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å­ç»„ä»¶ (FileUpload)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  function <span class="hljs-built_in">FileUpload</span>({ id, refreshTrigger }) {                  â”‚
â”‚    const <span class="hljs-selector-attr">[pictures, setPictures]</span> = <span class="hljs-built_in">useState</span>([]);                â”‚
â”‚                                                                  â”‚
â”‚    <span class="hljs-built_in">useEffect</span>(() =&gt; {                                            â”‚
â”‚      if (id) {                                                  â”‚
â”‚        <span class="hljs-built_in">getFileInfos</span>({ query: { fkId: id } })                   â”‚
â”‚          <span class="hljs-selector-class">.then</span>(res =&gt; setPictures(res));                        â”‚
â”‚      }                                                           â”‚
â”‚    }, <span class="hljs-selector-attr">[id, refreshTrigger]</span>);  <span class="hljs-comment">// â† ä¾èµ– refreshTrigger          â”‚</span>
â”‚                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚    â”‚  React æ£€æµ‹ä¾èµ–å˜åŒ–ï¼š                         â”‚            â”‚
â”‚    â”‚                                               â”‚            â”‚
â”‚    â”‚  refreshTrigger ä» <span class="hljs-number">0</span> å˜æˆ <span class="hljs-number">1</span>                  â”‚            â”‚
â”‚    â”‚       â†“                                       â”‚            â”‚
â”‚    â”‚  useEffect é‡æ–°æ‰§è¡Œ                           â”‚            â”‚
â”‚    â”‚       â†“                                       â”‚            â”‚
â”‚    â”‚  å‘èµ·æ–°çš„å›¾ç‰‡è¯·æ±‚                             â”‚            â”‚
â”‚    â”‚       â†“                                       â”‚            â”‚
â”‚    â”‚  <span class="hljs-built_in">setPictures</span>(æ–°æ•°æ®)                          â”‚            â”‚
â”‚    â”‚       â†“                                       â”‚            â”‚
â”‚    â”‚  ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œæ˜¾ç¤ºæ–°å›¾ç‰‡                     â”‚            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                  â”‚
â”‚    return &lt;<span class="hljs-selector-tag">img</span> <span class="hljs-attribute">src</span>={pictures<span class="hljs-selector-attr">[0]</span><span class="hljs-selector-class">.url</span>} /&gt;;                        â”‚
â”‚  }                                                               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
<h3 data-id="heading-2">å…³é”®ç‚¹è§£æ</h3>
<h4 data-id="heading-3">1. ä¸ºä»€ä¹ˆç”¨æ•°å­—è€Œä¸æ˜¯å¸ƒå°”å€¼ï¼Ÿ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ä½¿ç”¨å¸ƒå°”å€¼çš„é—®é¢˜</span>
<span class="hljs-keyword">const</span> [refresh, setRefresh] = <span class="hljs-title function_">useState</span>(<span class="hljs-literal">false</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">triggerRefresh</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">setRefresh</span>(<span class="hljs-literal">true</span>);
  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">setRefresh</span>(<span class="hljs-literal">false</span>), <span class="hljs-number">0</span>); <span class="hljs-comment">// éœ€è¦é‡ç½®</span>
};

<span class="hljs-comment">// è¿ç»­ä¸¤æ¬¡è°ƒç”¨ä¼šå¤±æ•ˆï¼š</span>
<span class="hljs-title function_">triggerRefresh</span>(); <span class="hljs-comment">// true</span>
<span class="hljs-title function_">triggerRefresh</span>(); <span class="hljs-comment">// è¿˜æ˜¯ trueï¼Œæ²¡æœ‰å˜åŒ–ï¼</span>


<span class="hljs-comment">// âœ… ä½¿ç”¨æ•°å­—çš„ä¼˜åŠ¿</span>
<span class="hljs-keyword">const</span> [trigger, setTrigger] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title function_">triggerRefresh</span> = (<span class="hljs-params"/>) =&gt; {
  <span class="hljs-title function_">setTrigger</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev + <span class="hljs-number">1</span>);
};

<span class="hljs-comment">// æ¯æ¬¡è°ƒç”¨éƒ½ä¼šå˜åŒ–ï¼š</span>
<span class="hljs-title function_">triggerRefresh</span>(); <span class="hljs-comment">// 0 â†’ 1</span>
<span class="hljs-title function_">triggerRefresh</span>(); <span class="hljs-comment">// 1 â†’ 2</span>
<span class="hljs-title function_">triggerRefresh</span>(); <span class="hljs-comment">// 2 â†’ 3</span>
</code></pre>
<h4 data-id="heading-4">2. ä¸ºä»€ä¹ˆä¸ç”¨ key å¼ºåˆ¶é‡æ–°æŒ‚è½½ï¼Ÿ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ä½¿ç”¨ key çš„é—®é¢˜</span>
&lt;<span class="hljs-title class_">FileUpload</span> key={<span class="hljs-string">`<span class="hljs-subst">${id}</span>-<span class="hljs-subst">${timestamp}</span>`</span>} id={id} /&gt;

<span class="hljs-comment">// ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼š</span>
<span class="hljs-comment">// 1. å¸è½½æ—§ç»„ä»¶ (componentWillUnmount)</span>
<span class="hljs-comment">// 2. é”€æ¯æ‰€æœ‰çŠ¶æ€å’Œ DOM</span>
<span class="hljs-comment">// 3. æŒ‚è½½æ–°ç»„ä»¶ (componentDidMount)</span>
<span class="hljs-comment">// 4. é‡æ–°åˆå§‹åŒ–æ‰€æœ‰çŠ¶æ€</span>
<span class="hljs-comment">// 5. é‡æ–°æ¸²æŸ“ DOM</span>

<span class="hljs-comment">// æ€§èƒ½å¼€é”€å¤§ï¼Œå¯èƒ½å¯¼è‡´ï¼š</span>
<span class="hljs-comment">// - é—ªçƒ</span>
<span class="hljs-comment">// - åŠ¨ç”»ä¸­æ–­</span>
<span class="hljs-comment">// - æ»šåŠ¨ä½ç½®ä¸¢å¤±</span>
<span class="hljs-comment">// - è¾“å…¥ç„¦ç‚¹ä¸¢å¤±</span>


<span class="hljs-comment">// âœ… ä½¿ç”¨ refreshTrigger çš„ä¼˜åŠ¿</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FileUpload</span> <span class="hljs-attr">id</span>=<span class="hljs-string">{id}</span> <span class="hljs-attr">refreshTrigger</span>=<span class="hljs-string">{trigger}</span> /&gt;</span></span>

<span class="hljs-comment">// ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼š</span>
<span class="hljs-comment">// 1. ç»„ä»¶ä¿æŒæŒ‚è½½çŠ¶æ€</span>
<span class="hljs-comment">// 2. åªæ‰§è¡Œ useEffect å›è°ƒ</span>
<span class="hljs-comment">// 3. åªæ›´æ–°éœ€è¦æ›´æ–°çš„æ•°æ®</span>
<span class="hljs-comment">// 4. ä¿ç•™å…¶ä»–çŠ¶æ€å’Œ DOM</span>

<span class="hljs-comment">// æ€§èƒ½å¥½ï¼Œç”¨æˆ·ä½“éªŒæµç•…</span>
</code></pre>
<h4 data-id="heading-5">3. ä¸ºä»€ä¹ˆè¦å°è£…æˆ Hookï¼Ÿ</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-comment">// âŒ ä¸å°è£…çš„é—®é¢˜</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component1</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [trigger, setTrigger] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fire</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title function_">setTrigger</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev + <span class="hljs-number">1</span>);
  <span class="hljs-comment">// ...</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component2</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [trigger, setTrigger] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> <span class="hljs-title function_">fire</span> = (<span class="hljs-params"/>) =&gt; <span class="hljs-title function_">setTrigger</span>(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> prev + <span class="hljs-number">1</span>);
  <span class="hljs-comment">// ... é‡å¤ä»£ç </span>
}


<span class="hljs-comment">// âœ… å°è£…æˆ Hook çš„ä¼˜åŠ¿</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component1</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [trigger, fire] = <span class="hljs-title function_">useRefreshTrigger</span>();
  <span class="hljs-comment">// ç®€æ´ã€å¯å¤ç”¨</span>
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component2</span>(<span class="hljs-params"/>) {
  <span class="hljs-keyword">const</span> [trigger, fire] = <span class="hljs-title function_">useRefreshTrigger</span>();
  <span class="hljs-comment">// åŒæ ·ç®€æ´</span>
}
</code></pre>
<h3 data-id="heading-6">å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆ</h3>








































<table><thead><tr><th>æ–¹æ¡ˆ</th><th>æ€§èƒ½</th><th>æ˜“ç”¨æ€§</th><th>å¯ç»´æŠ¤æ€§</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td><strong>è§¦å‘å™¨æ¨¡å¼</strong></td><td>â­â­â­â­â­</td><td>â­â­â­â­â­</td><td>â­â­â­â­â­</td><td>âœ… å¼ºçƒˆæ¨è</td></tr><tr><td>key å¼ºåˆ¶é‡æŒ‚è½½</td><td>â­â­</td><td>â­â­â­â­</td><td>â­â­â­</td><td>âš ï¸ ä¸æ¨è</td></tr><tr><td>ref å‘½ä»¤å¼è°ƒç”¨</td><td>â­â­â­â­</td><td>â­â­â­</td><td>â­â­</td><td>âš ï¸ ä¸æ¨è</td></tr><tr><td>å¸ƒå°”å€¼åˆ‡æ¢</td><td>â­â­â­â­</td><td>â­â­</td><td>â­â­</td><td>âš ï¸ ä¸æ¨è</td></tr></tbody></table>
<h3 data-id="heading-7">å®é™…åº”ç”¨åœºæ™¯</h3>
<h4 data-id="heading-8">åœºæ™¯ 1ï¼šåˆ—è¡¨åˆ·æ–°</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [trigger, fire] = <span class="hljs-title function_">useRefreshTrigger</span>();

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FlatList</span>
  <span class="hljs-attr">data</span>=<span class="hljs-string">{data}</span>
  <span class="hljs-attr">renderItem</span>=<span class="hljs-string">{({</span> <span class="hljs-attr">item</span> }) =&gt;</span> (
    <span class="hljs-tag">&lt;<span class="hljs-name">ItemCard</span> <span class="hljs-attr">refreshTrigger</span>=<span class="hljs-string">{trigger}</span> /&gt;</span>
  )}
/&gt;</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{fire}</span>&gt;</span>åˆ·æ–°å…¨éƒ¨<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-9">åœºæ™¯ 2ï¼šè¡¨å•é‡ç½®</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [trigger, fire] = <span class="hljs-title function_">useRefreshTrigger</span>();

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Form</span> <span class="hljs-attr">resetTrigger</span>=<span class="hljs-string">{trigger}</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">Select</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{fire}</span>&gt;</span>é‡ç½®è¡¨å•<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-10">åœºæ™¯ 3ï¼šå›¾è¡¨é‡ç»˜</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [trigger, fire] = <span class="hljs-title function_">useRefreshTrigger</span>();

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Chart</span> 
  <span class="hljs-attr">data</span>=<span class="hljs-string">{chartData}</span>
  <span class="hljs-attr">redrawTrigger</span>=<span class="hljs-string">{trigger}</span>
/&gt;</span></span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{fire}</span>&gt;</span>åˆ·æ–°å›¾è¡¨<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
</code></pre>
<h4 data-id="heading-11">åœºæ™¯ 4ï¼šWebSocket é‡è¿</h4>
<pre><code class="hljs language-javascript" lang="javascript"><span class="hljs-keyword">const</span> [trigger, fire] = <span class="hljs-title function_">useRefreshTrigger</span>();

<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
  <span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(url);
  <span class="hljs-comment">// ... è¿æ¥é€»è¾‘</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> ws.<span class="hljs-title function_">close</span>();
}, [trigger]);

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onPress</span>=<span class="hljs-string">{fire}</span>&gt;</span>é‡æ–°è¿æ¥<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
</code></pre>
<h3 data-id="heading-12">æ€»ç»“</h3>
<p>è§¦å‘å™¨æ¨¡å¼çš„æœ¬è´¨æ˜¯ï¼š</p>
<blockquote>
<p><strong>é€šè¿‡ä¸€ä¸ªç®€å•çš„ã€å¯é¢„æµ‹çš„å€¼å˜åŒ–ï¼Œæ¥è§¦å‘å¤æ‚çš„ã€å¯æ§çš„å‰¯ä½œç”¨</strong></p>
</blockquote>
<p>è¿™ç§æ¨¡å¼ï¼š</p>
<ul>
<li>âœ… ç¬¦åˆ React çš„å£°æ˜å¼ç†å¿µ</li>
<li>âœ… ä¿æŒå•å‘æ•°æ®æµ</li>
<li>âœ… æ€§èƒ½ä¼˜ç§€</li>
<li>âœ… æ˜“äºç†è§£å’Œç»´æŠ¤</li>
<li>âœ… å¯å¤ç”¨æ€§å¼º</li>
</ul>
<p>æŒæ¡è¿™ä¸ªæ¨¡å¼ï¼Œä½ å°±æŒæ¡äº† React çŠ¶æ€ç®¡ç†çš„ç²¾é«“ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Redisæ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–ï¼šæ€§èƒ½ç“¶é¢ˆæ’æŸ¥å®æˆ˜æŒ‡å—]]></title>    <link>https://juejin.cn/post/7593240931287187508</link>    <guid>https://juejin.cn/post/7593240931287187508</guid>    <pubDate>2026-01-10T05:40:47.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593240931287187508" data-draft-id="7490784514842361906" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Redisæ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–ï¼šæ€§èƒ½ç“¶é¢ˆæ’æŸ¥å®æˆ˜æŒ‡å—"/> <meta itemprop="keywords" content="Redis,æ•°æ®åº“,æ€§èƒ½ä¼˜åŒ–"/> <meta itemprop="datePublished" content="2026-01-10T05:40:47.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥"/> <meta itemprop="url" content="https://juejin.cn/user/446863555701561"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Redisæ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–ï¼šæ€§èƒ½ç“¶é¢ˆæ’æŸ¥å®æˆ˜æŒ‡å—
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/446863555701561/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    Goé«˜å¹¶å‘æ¶æ„_ç‹å·¥
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T05:40:47.000Z" title="Sat Jan 10 2026 05:40:47 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»21åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h4 data-id="heading-0">ä¸€ã€å‰è¨€</h4>
<p>åœ¨ç°ä»£åç«¯å¼€å‘ä¸­ï¼ŒRediså‡­å€Ÿå…¶è¶…é«˜çš„å†…å­˜æ“ä½œæ€§èƒ½å’Œä¸°å¯Œçš„æ•°æ®ç»“æ„ï¼Œå·²æˆä¸ºè®¸å¤šé«˜å¹¶å‘åœºæ™¯ä¸‹çš„â€œæ ‡é…â€æ•°æ®åº“ã€‚æ— è®ºæ˜¯ç”µå•†ç§’æ€ã€å®æ—¶æ’è¡Œæ¦œï¼Œè¿˜æ˜¯åˆ†å¸ƒå¼é”å’Œç¼“å­˜ï¼ŒRedisçš„èº«å½±æ— å¤„ä¸åœ¨ã€‚ç„¶è€Œï¼Œæ­£å¦‚ä¸€è¾†è·‘è½¦å¦‚æœæ²¹è·¯ä¸ç•…å°±æ— æ³•å‘æŒ¥å…¨éƒ¨é©¬åŠ›ï¼ŒRedisçš„æ€§èƒ½ä¹Ÿå¯èƒ½å› ä¸ºæ…¢æŸ¥è¯¢é—®é¢˜è€Œå¤§æ‰“æŠ˜æ‰£ã€‚æ…¢æŸ¥è¯¢å°±åƒç³»ç»Ÿä¸­çš„â€œéšå½¢æ€æ‰‹â€ï¼Œæ‚„æ— å£°æ¯åœ°æ‹–æ…¢å“åº”æ—¶é—´ã€é™ä½ååé‡ï¼Œç”šè‡³å¼•å‘è¿é”ååº”ï¼Œè®©çº¿ä¸ŠæœåŠ¡é›ªä¸ŠåŠ éœœã€‚</p>
<p>æˆ‘ä»äº‹Rediså¼€å‘å·²æœ‰10å¹´ï¼Œä»åˆå­¦è€…åˆ°å¦‚ä»Šè´Ÿè´£è¿‡å¤šä¸ªå¤§å‹é¡¹ç›®çš„æ€§èƒ½ä¼˜åŒ–ï¼Œè¸©è¿‡çš„å‘å’Œç§¯ç´¯çš„ç»éªŒè®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°ï¼šæ…¢æŸ¥è¯¢ä¸ä»…æ˜¯æŠ€æœ¯é—®é¢˜ï¼Œæ›´æ˜¯ä¸šåŠ¡ç¨³å®šçš„å…³é”®ä¸€ç¯ã€‚è®°å¾—æœ‰ä¸€æ¬¡ï¼ŒæŸç”µå•†ç§’æ€æ´»åŠ¨ä¸­ï¼Œæ…¢æŸ¥è¯¢å¯¼è‡´è®¢å•å¤„ç†å»¶è¿Ÿï¼Œæœ€ç»ˆå¼•å‘ç”¨æˆ·æŠ•è¯‰ã€‚é‚£ä¸€åˆ»æˆ‘æ„è¯†åˆ°ï¼Œä»…ä»…ä¼šç”¨Redisè¿œè¿œä¸å¤Ÿï¼ŒçœŸæ­£çš„é«˜æ‰‹éœ€è¦èƒ½â€œé©¯æœâ€å®ƒï¼Œæ‰¾åˆ°å¹¶è§£å†³æ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>è¿™ç¯‡æ–‡ç« çš„ç›®æ ‡è¯»è€…æ˜¯é‚£äº›æœ‰1-2å¹´Rediså¼€å‘ç»éªŒçš„å¼€å‘è€…ã€‚ä½ å¯èƒ½å·²ç»ç†Ÿæ‚‰åŸºæœ¬çš„SET/GETæ“ä½œï¼Œä¹Ÿèƒ½å†™å‡ºç®€å•çš„Luaè„šæœ¬ï¼Œä½†é¢å¯¹çº¿ä¸Šæ…¢æŸ¥è¯¢é—®é¢˜æ—¶ï¼Œå´ä¸çŸ¥é“ä»ä½•ä¸‹æ‰‹ã€‚åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šå¸¦ä½ ä»é›¶å¼€å§‹ï¼Œé€æ­¥æŒæ¡æ…¢æŸ¥è¯¢çš„åˆ†æä¸ä¼˜åŒ–æŠ€å·§ã€‚æ–‡ç« çš„æ ¸å¿ƒäº®ç‚¹åœ¨äºï¼š</p>
<ul>
<li><strong>å®æˆ˜å¯¼å‘</strong>ï¼šä»å‘ç°é—®é¢˜åˆ°ä¼˜åŒ–è½åœ°ï¼Œæä¾›ä¸€æ­¥æ­¥å¯æ“ä½œçš„æ–¹æ¡ˆã€‚</li>
<li><strong>é¡¹ç›®ç»éªŒ</strong>ï¼šåˆ†äº«çœŸå®æ¡ˆä¾‹å’Œè¸©å‘æ•™è®­ï¼Œè®©ä½ å°‘èµ°å¼¯è·¯ã€‚</li>
<li><strong>ä»£ç ç¤ºä¾‹</strong>ï¼šæä¾›å¯ç›´æ¥å¤ç”¨çš„è„šæœ¬å’Œå‘½ä»¤ï¼Œæ‹¿æ¥å³ç”¨ã€‚</li>
</ul>
<p>æ— è®ºä½ æ˜¯æƒ³æå‡æŠ€æœ¯èƒ½åŠ›ï¼Œè¿˜æ˜¯å‡†å¤‡åº”å¯¹ä¸‹ä¸€æ¬¡çº¿ä¸Šäº‹æ•…ï¼Œè¿™ç¯‡æ–‡ç« éƒ½å°†æ˜¯ä½ çš„â€œå®æˆ˜æŒ‡å—â€ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»æ…¢æŸ¥è¯¢çš„åŸºç¡€çŸ¥è¯†å…¥æ‰‹ï¼Œé€æ­¥æ·±å…¥åˆ°åˆ†æå·¥å…·ã€ä¼˜åŒ–ç­–ç•¥å’Œå®Œæ•´æ’æŸ¥æµç¨‹ã€‚å¸Œæœ›ä½ åœ¨è¯»å®Œåï¼Œä¸ä»…èƒ½ç†è§£æ…¢æŸ¥è¯¢çš„æœ¬è´¨ï¼Œè¿˜èƒ½è‡ªä¿¡åœ°è§£å†³å®é™…é—®é¢˜ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šåœ¨æ·±å…¥åˆ†æå’Œä¼˜åŒ–ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦æ‰“å¥½åŸºç¡€â€”â€”ç†è§£ä»€ä¹ˆæ˜¯æ…¢æŸ¥è¯¢ï¼Œä»¥åŠRedisæ˜¯å¦‚ä½•è®°å½•å®ƒä»¬çš„ã€‚åªæœ‰æŒæ¡è¿™äº›åŸºæœ¬æ¦‚å¿µï¼Œæˆ‘ä»¬æ‰èƒ½åœ¨åç»­ç« èŠ‚ä¸­æ¸¸åˆƒæœ‰ä½™åœ°æ’æŸ¥å’Œè§£å†³é—®é¢˜ã€‚</p>
<hr/>
<h4 data-id="heading-1">äºŒã€Redisæ…¢æŸ¥è¯¢åŸºç¡€çŸ¥è¯†</h4>
<p>Redisçš„æ…¢æŸ¥è¯¢é—®é¢˜çœ‹ä¼¼å¤æ‚ï¼Œä½†æœ¬è´¨ä¸Šå¹¶ä¸ç¥ç§˜ã€‚åªè¦æŒæ¡å®ƒçš„å®šä¹‰ã€å·¥ä½œåŸç†å’Œæ½œåœ¨å½±å“ï¼Œä½ å°±èƒ½ä¸ºåç»­çš„åˆ†æä¸ä¼˜åŒ–æ‰“ä¸‹åšå®åŸºç¡€ã€‚æœ¬èŠ‚å°†å¸¦ä½ äº†è§£æ…¢æŸ¥è¯¢çš„åŸºæœ¬æ¦‚å¿µï¼Œå‰–æRedisçš„æ—¥å¿—æœºåˆ¶ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªçœŸå®åœºæ™¯è¯´æ˜ä¸ºä½•æ…¢æŸ¥è¯¢å€¼å¾—æˆ‘ä»¬é‡è§†ã€‚</p>
<h5 data-id="heading-2">1. ä»€ä¹ˆæ˜¯Redisæ…¢æŸ¥è¯¢</h5>
<p>ç®€å•æ¥è¯´ï¼ŒRedisä¸­çš„æ…¢æŸ¥è¯¢æ˜¯æŒ‡æ‰§è¡Œæ—¶é—´è¶…è¿‡æŸä¸ªé˜ˆå€¼çš„å‘½ä»¤ã€‚å°±åƒä¸€åœºé©¬æ‹‰æ¾ï¼Œè·‘å¾—å¤ªæ…¢çš„é€‰æ‰‹ä¼šè¢«ç‰¹åˆ«æ ‡è®°ï¼Œæ…¢æŸ¥è¯¢ä¹Ÿæ˜¯å¦‚æ­¤ã€‚Redisé€šè¿‡ä¸¤ä¸ªå…³é”®é…ç½®å‚æ•°æ¥å®šä¹‰å’Œç®¡ç†å®ƒï¼š</p>
<ul>
<li><strong><code>slowlog-log-slower-than</code></strong>ï¼šæ…¢æŸ¥è¯¢çš„é˜ˆå€¼ï¼Œå•ä½æ˜¯å¾®ç§’ï¼ˆÎ¼sï¼‰ã€‚æ¯”å¦‚è®¾ç½®ä¸º10000ï¼ˆå³10æ¯«ç§’ï¼‰ï¼Œä»»ä½•æ‰§è¡Œæ—¶é—´è¶…è¿‡10msçš„å‘½ä»¤éƒ½ä¼šè¢«è®°å½•ã€‚</li>
<li><strong><code>slowlog-max-len</code></strong>ï¼šæ…¢æŸ¥è¯¢æ—¥å¿—çš„æœ€å¤§æ¡æ•°ï¼Œé‡‡ç”¨å¾ªç¯é˜Ÿåˆ—å­˜å‚¨ï¼Œè¶…å‡ºæ—¶ä¼šè¦†ç›–æœ€æ—©çš„è®°å½•ã€‚</li>
</ul>
<p>å‡è®¾ä½ æŠŠé˜ˆå€¼è®¾ä¸º5msï¼Œæ—¥å¿—é•¿åº¦è®¾ä¸º100ï¼Œé‚£ä¹ˆRedisä¼šè®°å½•æœ€è¿‘100æ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡5msçš„å‘½ä»¤ã€‚è¿™ä¸¤ä¸ªå‚æ•°å¯ä»¥åœ¨<code>redis.conf</code>ä¸­é…ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<code>CONFIG SET</code>å‘½ä»¤åŠ¨æ€è°ƒæ•´ã€‚</p>
<h5 data-id="heading-3">2. æ…¢æŸ¥è¯¢æ—¥å¿—çš„å·¥ä½œåŸç†</h5>
<p>Redisçš„æ…¢æŸ¥è¯¢æ—¥å¿—ç”±<code>SLOWLOG</code>æœºåˆ¶é©±åŠ¨ï¼Œå†…ç½®äºRedisæ ¸å¿ƒï¼Œæ— éœ€é¢å¤–æ’ä»¶ã€‚å®ƒå°±åƒä¸€ä¸ªâ€œé»‘åŒ£å­â€ï¼Œé»˜é»˜è®°å½•æ¯æ¬¡â€œè¶…é€Ÿâ€çš„å‘½ä»¤ç»†èŠ‚ã€‚æ—¥å¿—çš„è®°å½•è¿‡ç¨‹éå¸¸é«˜æ•ˆï¼Œä¸ä¼šæ˜¾è‘—å½±å“Redisçš„æ€§èƒ½ã€‚å…·ä½“æ¥è¯´ï¼Œæ¯æ¬¡å‘½ä»¤æ‰§è¡Œåï¼ŒRedisä¼šï¼š</p>
<ol>
<li>è®¡ç®—å‘½ä»¤çš„æ‰§è¡Œæ—¶é—´ï¼ˆä¸åŒ…æ‹¬ç½‘ç»œä¼ è¾“æ—¶é—´ï¼‰ã€‚</li>
<li>å¦‚æœè¶…è¿‡é˜ˆå€¼ï¼Œå°±å°†å…¶å†™å…¥æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚</li>
</ol>
<p>ä½ å¯ä»¥ç”¨<code>SLOWLOG GET [n]</code>å‘½ä»¤æŸ¥çœ‹æ—¥å¿—ï¼Œå…¶ä¸­<code>n</code>æŒ‡å®šè¿”å›çš„æ¡æ•°ã€‚æ¯æ¡æ—¥å¿—åŒ…å«ä»¥ä¸‹å­—æ®µï¼š</p>








































<table><thead><tr><th>å­—æ®µå</th><th>å«ä¹‰</th><th>ç¤ºä¾‹å€¼</th></tr></thead><tbody><tr><td>id</td><td>æ—¥å¿—çš„å”¯ä¸€æ ‡è¯†</td><td>12345</td></tr><tr><td>timestamp</td><td>å‘½ä»¤æ‰§è¡Œçš„æ—¶é—´æˆ³</td><td>1617182400</td></tr><tr><td>duration</td><td>æ‰§è¡Œè€—æ—¶ï¼ˆå¾®ç§’ï¼‰</td><td>15234</td></tr><tr><td>command</td><td>å®Œæ•´å‘½ä»¤åŠå…¶å‚æ•°</td><td>"HGETALL user:1001"</td></tr><tr><td>client_addr</td><td>å®¢æˆ·ç«¯åœ°å€ï¼ˆå¯é€‰ï¼‰</td><td>"127.0.0.1:54321"</td></tr><tr><td>client_name</td><td>å®¢æˆ·ç«¯åç§°ï¼ˆå¯é€‰ï¼‰</td><td>"web-app"</td></tr></tbody></table>
<p><strong>ç¤ºæ„å›¾</strong>ï¼šæ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•æµç¨‹</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[å‘½ä»¤æ‰§è¡Œ]</span> â†’ <span class="hljs-selector-attr">[è®¡ç®—è€—æ—¶]</span> â†’ <span class="hljs-selector-attr">[æ¯”å¯¹é˜ˆå€¼]</span> â†’ <span class="hljs-selector-attr">[è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—]</span> â†’ <span class="hljs-selector-attr">[å­˜å‚¨åˆ°å¾ªç¯é˜Ÿåˆ—]</span>
</code></pre>
<h5 data-id="heading-4">3. ä¸ºä½•è¦å…³æ³¨æ…¢æŸ¥è¯¢</h5>
<p>æ…¢æŸ¥è¯¢çš„å½±å“è¿œä¸æ­¢â€œå‘½ä»¤è·‘å¾—æ…¢â€è¿™ä¹ˆç®€å•ã€‚å®ƒå°±åƒæ°´ç®¡ä¸­çš„å µå¡ç‚¹ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿå»¶è¿Ÿä¸Šå‡ã€ååé‡ä¸‹é™ï¼Œç”šè‡³å¼•å‘ä¸šåŠ¡æ•…éšœã€‚ä»¥ä¸€ä¸ªç”µå•†ç§’æ€åœºæ™¯ä¸ºä¾‹ï¼šå‡è®¾æŸä¸ªæ´»åŠ¨ä¸­æœ‰å¤§é‡ç”¨æˆ·æŸ¥è¯¢åº“å­˜ï¼Œå¼€å‘è€…ä¸å°å¿ƒç”¨äº†<code>KEYS *</code>å‘½ä»¤æ‰«ææ‰€æœ‰é”®ï¼Œç»“æœæ¯æ¬¡æ‰§è¡Œè€—æ—¶50msã€‚åœ¨é«˜å¹¶å‘ä¸‹ï¼Œè¿™ä¸ä»…æ‹–æ…¢äº†å“åº”ï¼Œè¿˜å ç”¨äº†Redisçš„å•çº¿ç¨‹å¤„ç†èƒ½åŠ›ï¼Œæœ€ç»ˆå¯¼è‡´è¯·æ±‚å †ç§¯ï¼Œç”¨æˆ·ä½“éªŒç›´çº¿ä¸‹é™ã€‚</p>
<p>æˆ‘åœ¨ä¸€æ¬¡é¡¹ç›®ä¸­å°±é‡åˆ°è¿‡ç±»ä¼¼é—®é¢˜ã€‚å½“æ—¶ç³»ç»ŸQPSä»å¹³æ—¶çš„5000éª¤é™åˆ°1000ï¼Œæ’æŸ¥åå‘ç°æ˜¯æŸä¸ªå¤§Hashçš„<code>HGETALL</code>æ“ä½œå¼•å‘çš„æ…¢æŸ¥è¯¢ã€‚è§£å†³åï¼Œæ€§èƒ½æ¢å¤ä¸è¯´ï¼Œç”¨æˆ·çš„æŠ•è¯‰ä¹Ÿæ˜æ˜¾å‡å°‘ã€‚è¿™è®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°ï¼šæ…¢æŸ¥è¯¢ä¸ä»…æ˜¯æŠ€æœ¯ç»†èŠ‚ï¼Œæ›´æ˜¯ä¸šåŠ¡ç¨³å®šçš„å‘½è„‰ã€‚</p>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šç°åœ¨ä½ å·²ç»äº†è§£äº†æ…¢æŸ¥è¯¢çš„å®šä¹‰å’ŒåŸç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è¿›å…¥å®æˆ˜ç¯èŠ‚â€”â€”å¦‚ä½•è·å–å’Œåˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—ã€‚é€šè¿‡å…·ä½“çš„å·¥å…·å’Œæ–¹æ³•ï¼Œä½ å°†å­¦ä¼šä»æµ·é‡å‘½ä»¤ä¸­æ‰¾å‡ºâ€œç½ªé­ç¥¸é¦–â€ï¼Œä¸ºä¼˜åŒ–æ‰“ä¸‹åŸºç¡€ã€‚è®©æˆ‘ä»¬ç»§ç»­å‰è¡Œï¼</p>
<hr/>
<h4 data-id="heading-5">ä¸‰ã€æ…¢æŸ¥è¯¢åˆ†æçš„æ ¸å¿ƒå·¥å…·ä¸æ–¹æ³•</h4>
<p>äº†è§£äº†æ…¢æŸ¥è¯¢çš„åŸºç¡€çŸ¥è¯†åï¼Œæˆ‘ä»¬ç»ˆäºè¦è¿›å…¥å®æˆ˜ç¯èŠ‚äº†ã€‚åˆ†ææ…¢æŸ¥è¯¢å°±åƒä¾¦æ¢ç ´æ¡ˆï¼Œéœ€è¦ä»çº¿ç´¢ï¼ˆæ—¥å¿—ï¼‰å…¥æ‰‹ï¼Œç»“åˆå·¥å…·å’Œç»éªŒï¼Œæ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆçš„æ ¹æºã€‚æœ¬èŠ‚å°†å¸¦ä½ æŒæ¡è·å–æ…¢æŸ¥è¯¢æ—¥å¿—çš„æ–¹æ³•ï¼Œå‰–æå¸¸è§çš„æ…¢æŸ¥è¯¢æ¨¡å¼ï¼Œå¹¶åˆ†äº«å¦‚ä½•å€ŸåŠ©å¤–éƒ¨å·¥å…·æå‡æ•ˆç‡ã€‚æœ‰äº†è¿™äº›æŠ€èƒ½ï¼Œä½ å°±èƒ½è¿…é€Ÿé”å®šé—®é¢˜ï¼Œä¸ºä¼˜åŒ–åšå¥½å‡†å¤‡ã€‚</p>
<h5 data-id="heading-6">1. è·å–æ…¢æŸ¥è¯¢æ—¥å¿—</h5>
<p>Redisæä¾›äº†å†…ç½®å‘½ä»¤<code>SLOWLOG GET</code>æ¥æŸ¥çœ‹æ…¢æŸ¥è¯¢è®°å½•ï¼Œè¿™æ˜¯åˆ†æçš„ç¬¬ä¸€æ­¥ã€‚å®ƒçš„ç”¨æ³•å¾ˆç®€å•ï¼Œæ¯”å¦‚<code>SLOWLOG GET 10</code>ä¼šè¿”å›æœ€è¿‘10æ¡æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚ä¸ºäº†æ–¹ä¾¿è‡ªåŠ¨åŒ–åˆ†æï¼Œæˆ‘é€šå¸¸ä¼šç”¨è„šæœ¬æ‰¹é‡æ‹‰å–æ—¥å¿—ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªPythonç¤ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> redis

<span class="hljs-comment"># è¿æ¥Rediså®ä¾‹</span>
r = redis.Redis(host=<span class="hljs-string">'localhost'</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>)

<span class="hljs-comment"># è·å–æœ€è¿‘10æ¡æ…¢æŸ¥è¯¢æ—¥å¿—</span>
slow_logs = r.slowlog_get(<span class="hljs-number">10</span>)

<span class="hljs-comment"># éå†å¹¶æ‰“å°æ—¥å¿—è¯¦æƒ…</span>
<span class="hljs-keyword">for</span> log <span class="hljs-keyword">in</span> slow_logs:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"ID: <span class="hljs-subst">{log[<span class="hljs-string">'id'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Timestamp: <span class="hljs-subst">{log[<span class="hljs-string">'timestamp'</span>]}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Command: <span class="hljs-subst">{log[<span class="hljs-string">'command'</span>].decode(<span class="hljs-string">'utf-8'</span>)}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Duration: <span class="hljs-subst">{log[<span class="hljs-string">'duration'</span>]}</span>Î¼s"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">f"Client: <span class="hljs-subst">{log.get(<span class="hljs-string">'client_addr'</span>, <span class="hljs-string">'N/A'</span>)}</span>"</span>)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"-"</span> * <span class="hljs-number">30</span>)
</code></pre>
<p><strong>ä»£ç æ³¨é‡Šè¯´æ˜</strong>ï¼š</p>
<ul>
<li><code>redis.Redis</code>ï¼šåˆå§‹åŒ–Rediså®¢æˆ·ç«¯è¿æ¥ã€‚</li>
<li><code>slowlog_get(10)</code>ï¼šè·å–æœ€è¿‘10æ¡æ…¢æŸ¥è¯¢ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨ã€‚</li>
<li><code>log['command'].decode('utf-8')</code>ï¼šå‘½ä»¤ä»¥å­—èŠ‚å½¢å¼å­˜å‚¨ï¼Œéœ€è§£ç ä¸ºå­—ç¬¦ä¸²ã€‚</li>
<li><code>log.get('client_addr', 'N/A')</code>ï¼šå®¢æˆ·ç«¯åœ°å€å¯èƒ½ä¸ºç©ºï¼Œç”¨<code>get</code>é¿å…æŠ¥é”™ã€‚</li>
</ul>
<p>è¿è¡Œåï¼Œä½ ä¼šçœ‹åˆ°æ¯æ¡æ…¢æŸ¥è¯¢çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚æŸä¸ª<code>HGETALL</code>è€—æ—¶15234å¾®ç§’ã€‚æŒæ¡è¿™ä¸ªæ–¹æ³•åï¼Œä½ å°±å¯ä»¥å®šæœŸæ£€æŸ¥æ—¥å¿—ï¼Œå¿«é€Ÿå‘ç°å¼‚å¸¸ã€‚</p>
<h5 data-id="heading-7">2. åˆ†ææ…¢æŸ¥è¯¢çš„å¸¸è§æ¨¡å¼</h5>
<p>æ…¢æŸ¥è¯¢çš„â€œç½ªé­ç¥¸é¦–â€é€šå¸¸é€ƒä¸å‡ºå‡ ç§æ¨¡å¼ã€‚ä»¥ä¸‹æ˜¯ä¸‰ç§å¸¸è§ç±»å‹ï¼Œä»¥åŠæˆ‘åœ¨é¡¹ç›®ä¸­æ€»ç»“çš„ç‰¹å¾ï¼š</p>
<ul>
<li>
<p><strong>é«˜é¢‘å‘½ä»¤</strong><br/>
å¦‚<code>KEYS *</code>æˆ–<code>HGETALL</code>ï¼Œè¿™äº›å‘½ä»¤å¤æ‚åº¦é«˜ï¼ˆO(N)çº§åˆ«ï¼‰ï¼Œåœ¨æ•°æ®é‡å¤§æ—¶ææ˜“å˜æ…¢ã€‚æ¯”å¦‚<code>KEYS *</code>ä¼šæ‰«ææ‰€æœ‰é”®ï¼Œçº¿ä¸Šç¯å¢ƒå‡ ä¹æ˜¯â€œç¦å¿Œâ€ã€‚</p>
</li>
<li>
<p><strong>å¤§æ•°æ®é‡æ“ä½œ</strong><br/>
æ“ä½œå¤§Hashã€å¤§Listæˆ–å¤§Setæ—¶ï¼Œæ¯”å¦‚<code>LRANGE 0 -1</code>è·å–æ•´ä¸ªåˆ—è¡¨ï¼Œæˆ–è€…<code>HGETALL</code>è¯»å–ä¸Šåƒå­—æ®µçš„Hashï¼Œè€—æ—¶ä¼šæ˜¾è‘—å¢åŠ ã€‚</p>
</li>
<li>
<p><strong>ç½‘ç»œå»¶è¿Ÿä¸å®¢æˆ·ç«¯é—®é¢˜</strong><br/>
æœ‰æ—¶æ…¢æŸ¥è¯¢å¹¶éRedisæœ¬èº«é—®é¢˜ï¼Œè€Œæ˜¯å®¢æˆ·ç«¯è¿æ¥é¢‘ç¹æ–­å¼€é‡è¿ï¼Œæˆ–ç½‘ç»œæŠ–åŠ¨å¯¼è‡´çš„é¢å¤–å¼€é”€ã€‚</p>
</li>
</ul>
<p><strong>è¡¨æ ¼</strong>ï¼šå¸¸è§æ…¢æŸ¥è¯¢æ¨¡å¼å¯¹æ¯”</p>

































<table><thead><tr><th>ç±»å‹</th><th>ç¤ºä¾‹å‘½ä»¤</th><th>å¤æ‚åº¦</th><th>å…¸å‹åœºæ™¯</th><th>å½±å“</th></tr></thead><tbody><tr><td>é«˜é¢‘å‘½ä»¤</td><td><code>KEYS *</code></td><td>O(N)</td><td>å…¨é‡é”®æ‰«æ</td><td>CPUå ç”¨é«˜</td></tr><tr><td>å¤§æ•°æ®é‡æ“ä½œ</td><td><code>HGETALL</code></td><td>O(N)</td><td>å¤§Hashè¯»å–</td><td>å»¶è¿Ÿä¸Šå‡</td></tr><tr><td>ç½‘ç»œé—®é¢˜</td><td>-</td><td>-</td><td>å®¢æˆ·ç«¯è¿æ¥ä¸ç¨³å®š</td><td>ååé‡ä¸‹é™</td></tr></tbody></table>
<p>é€šè¿‡åˆ†ææ—¥å¿—ä¸­çš„<code>command</code>å’Œ<code>duration</code>ï¼Œä½ å¯ä»¥å¿«é€Ÿåˆ¤æ–­é—®é¢˜å±äºå“ªç±»ã€‚æ¯”å¦‚æˆ‘æ›¾å‘ç°æŸæœåŠ¡é¢‘ç¹è°ƒç”¨<code>KEYS user:*</code>ï¼Œè€—æ—¶é«˜è¾¾200msï¼Œç›´æ¥æ‹–å®äº†QPSã€‚</p>
<h5 data-id="heading-8">3. å€ŸåŠ©å¤–éƒ¨å·¥å…·æå‡æ•ˆç‡</h5>
<p>é™¤äº†Redisè‡ªå¸¦çš„<code>SLOWLOG</code>ï¼Œå¤–éƒ¨å·¥å…·ä¹Ÿèƒ½å¸®ä½ äº‹åŠåŠŸå€ã€‚ä»¥ä¸‹æ˜¯å‡ ç§é€‰æ‹©åŠå…¶å¯¹æ¯”ï¼š</p>
<ul>
<li>
<p><strong>redis-cli</strong><br/>
ç›´æ¥åœ¨ç»ˆç«¯è¿è¡Œ<code>SLOWLOG GET</code>ï¼Œé€‚åˆä¸´æ—¶æ’æŸ¥ï¼Œä½†ä¸æ–¹ä¾¿é•¿æœŸç›‘æ§ã€‚</p>
</li>
<li>
<p><strong>RedisInsight</strong><br/>
ä¸€ä¸ªå›¾å½¢åŒ–å·¥å…·ï¼Œèƒ½å¯è§†åŒ–æ…¢æŸ¥è¯¢è¶‹åŠ¿ï¼Œè¿˜æ”¯æŒå‘½ä»¤åˆ†æï¼Œé€‚åˆåˆå­¦è€…ã€‚ä¸è¿‡å¯¹èµ„æºå ç”¨ç¨é«˜ã€‚</p>
</li>
<li>
<p><strong>è„šæœ¬+Grafana</strong><br/>
æˆ‘åœ¨é¡¹ç›®ä¸­æœ€å¸¸ç”¨çš„æ–¹æ¡ˆã€‚é€šè¿‡è„šæœ¬å®šæœŸæ‹‰å–æ…¢æŸ¥è¯¢æ•°æ®ï¼Œæ¨é€åˆ°Prometheusï¼Œå†ç”¨Grafanaç»˜åˆ¶è¶‹åŠ¿å›¾ã€‚æ¯”å¦‚æŸæ¬¡ä¼˜åŒ–å‰ï¼Œæ…¢æŸ¥è¯¢æ•°é‡æ¯å¤©é«˜è¾¾500æ¡ï¼Œä¼˜åŒ–åé™åˆ°50æ¡ï¼Œæ•ˆæœä¸€ç›®äº†ç„¶ã€‚</p>
</li>
</ul>
<p><strong>é¡¹ç›®ç»éªŒ</strong>ï¼šæœ‰ä¸€æ¬¡çº¿ä¸ŠæœåŠ¡å“åº”å˜æ…¢ï¼Œæˆ‘ç”¨è„šæœ¬å‘ç°<code>HGETALL</code>å äº†æ…¢æŸ¥è¯¢çš„80%ã€‚ç»“åˆGrafanaç›‘æ§ï¼Œç¡®è®¤æ˜¯æŸä¸ªå¤§Hashå¼•èµ·çš„ã€‚è¿™è®©æˆ‘æ„è¯†åˆ°ï¼Œå·¥å…·ä¸ä»…èƒ½å‘ç°é—®é¢˜ï¼Œè¿˜èƒ½éªŒè¯ä¼˜åŒ–æ•ˆæœã€‚</p>
<p><strong>ç¤ºæ„å›¾</strong>ï¼šæ…¢æŸ¥è¯¢åˆ†ææµç¨‹</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[æ‹‰å–æ—¥å¿—: SLOWLOG GET]</span> â†’ <span class="hljs-selector-attr">[åˆ†ææ¨¡å¼: é«˜é¢‘/å¤§æ•°æ®/ç½‘ç»œ]</span> â†’ <span class="hljs-selector-attr">[å€ŸåŠ©å·¥å…·: redis-cli æˆ– Grafana]</span> â†’ <span class="hljs-selector-attr">[å®šä½é—®é¢˜]</span>
</code></pre>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šé€šè¿‡æœ¬èŠ‚ï¼Œä½ å·²ç»å­¦ä¼šå¦‚ä½•è·å–å’Œåˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œå¹¶èƒ½è¯†åˆ«å¸¸è§é—®é¢˜æ¨¡å¼ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è¿›å…¥ä¼˜åŒ–å®æˆ˜ï¼Œæ¢è®¨å¦‚ä½•é€šè¿‡å‘½ä»¤è°ƒæ•´ã€æ•°æ®ç»“æ„ä¼˜åŒ–å’Œå®¢æˆ·ç«¯é…ç½®ï¼Œå½»åº•è§£å†³è¿™äº›æ€§èƒ½ç“¶é¢ˆã€‚å‡†å¤‡å¥½åŠ¨æ‰‹ä¼˜åŒ–äº†å—ï¼Ÿè®©æˆ‘ä»¬ç»§ç»­ï¼</p>
<hr/>
<h4 data-id="heading-9">å››ã€æ…¢æŸ¥è¯¢ä¼˜åŒ–çš„å®æˆ˜ç­–ç•¥</h4>
<p>åˆ†æå‡ºæ…¢æŸ¥è¯¢çš„â€œå…ƒå‡¶â€åªæ˜¯ç¬¬ä¸€æ­¥ï¼ŒçœŸæ­£è§£å†³é—®é¢˜è¿˜å¾—é ä¼˜åŒ–ã€‚ä¼˜åŒ–Redisæ…¢æŸ¥è¯¢å°±åƒä¿®å‰ªä¸€æ£µå¤§æ ‘ï¼Œæ—¢è¦å‰ªæ‰å¤šä½™çš„æå¶ï¼ˆä½æ•ˆå‘½ä»¤ï¼‰ï¼Œä¹Ÿè¦è°ƒæ•´æ ¹ç³»ï¼ˆæ•°æ®ç»“æ„ï¼‰ï¼Œç”šè‡³æ”¹å–„åœŸå£¤ï¼ˆå®¢æˆ·ç«¯é…ç½®ï¼‰ã€‚æœ¬èŠ‚å°†é€šè¿‡å…·ä½“æ¡ˆä¾‹å’Œä»£ç ï¼Œå¸¦ä½ æŒæ¡å‘½ä»¤é€‰æ‹©ã€æ•°æ®ç»“æ„è°ƒæ•´å’Œå®¢æˆ·ç«¯ä¼˜åŒ–çš„å®æˆ˜ç­–ç•¥ï¼Œå¹¶åˆ†äº«æˆ‘åœ¨é¡¹ç›®ä¸­è¸©è¿‡çš„å‘ä¸è§£å†³æ–¹æ¡ˆã€‚å‡†å¤‡å¥½åŠ¨æ‰‹äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹ä¼˜åŒ–ä¹‹æ—…ï¼</p>
<h5 data-id="heading-10">1. ä¼˜åŒ–å‘½ä»¤é€‰æ‹©</h5>
<p>Redisæä¾›äº†ä¸°å¯Œçš„å‘½ä»¤ï¼Œä½†å¹¶éæ¯æ¡éƒ½é€‚åˆé«˜å¹¶å‘åœºæ™¯ã€‚ä»¥ä¸‹æ˜¯ä¸¤ä¸ªå¸¸è§æ¡ˆä¾‹çš„ä¼˜åŒ–æ–¹æ¡ˆï¼š</p>
<ul>
<li>
<p><strong>æ¡ˆä¾‹1ï¼šå°† <code>KEYS *</code> æ›¿æ¢ä¸º <code>SCAN</code></strong><br/>
<code>KEYS *</code>æ˜¯ä¸ªâ€œå…¨å®¶æ¡¶â€å‘½ä»¤ï¼Œä¼šä¸€æ¬¡æ€§æ‰«ææ‰€æœ‰é”®ï¼Œå¤æ‚åº¦O(N)ï¼Œæ•°æ®é‡å¤§æ—¶ææ˜“å¼•å‘æ…¢æŸ¥è¯¢ã€‚æˆ‘æ›¾åœ¨æŸé¡¹ç›®ä¸­çœ‹åˆ°å®ƒè€—æ—¶300msï¼Œç›´æ¥æ‹–æ…¢äº†æœåŠ¡ã€‚ä¼˜åŒ–æ–¹æ¡ˆæ˜¯ç”¨<code>SCAN</code>ï¼Œå®ƒæ”¯æŒåˆ†æ‰¹è¿­ä»£ï¼Œæ€§èƒ½æ›´ç¨³å®šï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é”™è¯¯ç”¨æ³•ï¼šå…¨é‡æ‰«æï¼Œè€—æ—¶é•¿</span>
KEYS user:*

<span class="hljs-comment"># ä¼˜åŒ–åï¼šåˆ†æ‰¹è¿­ä»£ï¼ŒæŒ‡å®šæ¯æ¬¡è¿”å›100æ¡</span>
SCAN 0 MATCH user:* COUNT 100
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šä¼˜åŒ–åå•æ¬¡è€—æ—¶é™åˆ°5msä»¥ä¸‹ï¼ŒQPSæå‡20%ã€‚</p>
</li>
<li>
<p><strong>æ¡ˆä¾‹2ï¼š<code>HGETALL</code> æ›¿æ¢ä¸º <code>HMGET</code></strong><br/>
<code>HGETALL</code>ä¼šè¿”å›Hashçš„æ‰€æœ‰å­—æ®µï¼Œä½†åœ¨å­—æ®µå¤šæ—¶ï¼ˆå¦‚ä¸Šåƒä¸ªï¼‰æ€§èƒ½å ªå¿§ã€‚æ”¹ä¸º<code>HMGET</code>ï¼Œåªå–éœ€è¦çš„å­—æ®µï¼Œèƒ½æ˜¾è‘—é™ä½å¼€é”€ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># é”™è¯¯ç”¨æ³•ï¼šè¯»å–æ•´ä¸ªHash</span>
HGETALL user:1001

<span class="hljs-comment"># ä¼˜åŒ–åï¼šåªå–æ‰€éœ€å­—æ®µ</span>
HMGET user:1001 name age
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼šè€—æ—¶ä»50msé™åˆ°2msï¼Œç‰¹åˆ«é€‚åˆå­—æ®µå›ºå®šçš„åœºæ™¯ã€‚</p>
</li>
</ul>
<h5 data-id="heading-11">2. æ•°æ®ç»“æ„ä¼˜åŒ–</h5>
<p>Redisçš„æ€§èƒ½å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæ•°æ®ç»“æ„é€‰æ‹©ã€‚ä»¥ä¸‹æ˜¯ä¸¤ä¸ªå®ç”¨ä¼˜åŒ–ï¼š</p>
<ul>
<li>
<p><strong>å¤§Listæ‹†åˆ†ä¸ºå°List</strong><br/>
ä¸€ä¸ªåŒ…å«10ä¸‡å…ƒç´ çš„Listç”¨<code>LRANGE 0 -1</code>è¯»å–ï¼Œè€—æ—¶å¯èƒ½é«˜è¾¾ç§’çº§ã€‚æˆ‘çš„è§£å†³åŠæ³•æ˜¯æŒ‰ä¸šåŠ¡é€»è¾‘æ‹†åˆ†ï¼Œæ¯”å¦‚æŒ‰æ—¥æœŸå­˜ä¸º<code>list:20250408</code>ï¼Œæ¯æ®µæ§åˆ¶åœ¨1000æ¡ä»¥å†…ã€‚è¯»å–æ—¶åªå–ç‰¹å®šæ®µï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># ä¼˜åŒ–å‰ï¼šè¯»å–æ•´ä¸ªå¤§List</span>
LRANGE big_list 0 -1

<span class="hljs-comment"># ä¼˜åŒ–åï¼šåˆ†æ®µè¯»å–</span>
LRANGE list:20250408 0 999
</code></pre>
</li>
<li>
<p><strong>ä½¿ç”¨Setæ›¿ä»£List</strong><br/>
åœ¨éœ€è¦å»é‡çš„åœºæ™¯ä¸‹ï¼ŒListçš„<code>LREM</code>æ“ä½œå¤æ‚åº¦ä¸ºO(N)ï¼Œè€ŒSetçš„<code>SREM</code>ä»…O(1)ã€‚æˆ‘æ›¾å°†æŸæ’è¡Œæ¦œä»Listæ”¹ä¸ºSetï¼Œæ…¢æŸ¥è¯¢æ•°é‡å‡å°‘80%ã€‚</p>
</li>
</ul>
<p><strong>è¡¨æ ¼</strong>ï¼šæ•°æ®ç»“æ„ä¼˜åŒ–å¯¹æ¯”</p>


























<table><thead><tr><th>åœºæ™¯</th><th>åŸç»“æ„/å‘½ä»¤</th><th>ä¼˜åŒ–åç»“æ„/å‘½ä»¤</th><th>å¤æ‚åº¦å˜åŒ–</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>å¤§Listè¯»å–</td><td>List / <code>LRANGE</code></td><td>å¤šå°List / <code>LRANGE</code></td><td>O(N) â†’ O(1)</td><td>è€—æ—¶é™ä½90%</td></tr><tr><td>å»é‡æ“ä½œ</td><td>List / <code>LREM</code></td><td>Set / <code>SREM</code></td><td>O(N) â†’ O(1)</td><td>æ€§èƒ½æå‡10å€</td></tr></tbody></table>
<h5 data-id="heading-12">3. å®¢æˆ·ç«¯ä¸è¿æ¥ä¼˜åŒ–</h5>
<p>æ…¢æŸ¥è¯¢æœ‰æ—¶å¹¶éRedisæœ¬èº«é—®é¢˜ï¼Œè€Œæ˜¯å®¢æˆ·ç«¯é…ç½®ä¸å½“ã€‚ä»¥ä¸‹æ˜¯ä¸¤æ‹›å®ç”¨ä¼˜åŒ–ï¼š</p>
<ul>
<li>
<p><strong>è¿æ¥æ± é…ç½®</strong><br/>
é¢‘ç¹å»ºç«‹/é‡Šæ”¾è¿æ¥ä¼šå¢åŠ ç½‘ç»œå¼€é”€ã€‚ä½¿ç”¨è¿æ¥æ± èƒ½å¤ç”¨è¿æ¥ï¼Œå‡å°‘æ…¢æŸ¥è¯¢ã€‚æˆ‘å¸¸ç”¨Pythonçš„<code>redis-py</code>é…ç½®å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> redis

<span class="hljs-comment"># é…ç½®è¿æ¥æ± </span>
pool = redis.ConnectionPool(host=<span class="hljs-string">'localhost'</span>, port=<span class="hljs-number">6379</span>, db=<span class="hljs-number">0</span>, max_connections=<span class="hljs-number">100</span>)
r = redis.Redis(connection_pool=pool)
</code></pre>
</li>
<li>
<p><strong>Pipelineæ‰¹é‡æ“ä½œ</strong><br/>
å•æ¡å‘½ä»¤çš„ç½‘ç»œå¾€è¿”ï¼ˆRTTï¼‰å¯èƒ½åªæœ‰1msï¼Œä½†åœ¨é«˜é¢‘åœºæ™¯ä¸‹ç´¯ç§¯ä¸¥é‡ã€‚Pipelineå°†å¤šæ¡å‘½ä»¤æ‰“åŒ…å‘é€ï¼Œå‡å°‘RTTï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">with</span> r.pipeline() <span class="hljs-keyword">as</span> pipe:
    pipe.<span class="hljs-built_in">set</span>(<span class="hljs-string">'key1'</span>, <span class="hljs-string">'value1'</span>)
    pipe.<span class="hljs-built_in">set</span>(<span class="hljs-string">'key2'</span>, <span class="hljs-string">'value2'</span>)
    pipe.execute()  <span class="hljs-comment"># ä¸€æ¬¡æ€§æ‰§è¡Œ</span>
</code></pre>
<p><strong>æ•ˆæœ</strong>ï¼š1000æ¬¡SETä»2ç§’é™åˆ°50msï¼Œæ•ˆç‡æå‡40å€ã€‚</p>
</li>
</ul>
<h5 data-id="heading-13">4. é¡¹ç›®ç»éªŒåˆ†äº«</h5>
<ul>
<li>
<p><strong>è¸©å‘æ¡ˆä¾‹</strong>ï¼šæŸæ¬¡çº¿ä¸ŠæœåŠ¡QPSä»5000è·Œåˆ°2000ï¼Œæ…¢æŸ¥è¯¢æ—¥å¿—æ˜¾ç¤ºå¤§é‡<code>HGETALL</code>æ“ä½œã€‚æ£€æŸ¥å‘ç°æ˜¯ä¸ªåŒ…å«5000å­—æ®µçš„å¤§Hashã€‚ä¼˜åŒ–æ–¹æ¡ˆæ˜¯å°†Hashåˆ†ç‰‡å­˜å‚¨ä¸ºå¤šä¸ªå°Hashï¼ˆå¦‚<code>user:1001:base</code>å’Œ<code>user:1001:extra</code>ï¼‰ï¼Œå¹¶ç”¨<code>HMGET</code>æ›¿æ¢<code>HGETALL</code>ï¼Œç»“æœQPSæå‡50%ã€‚</p>
</li>
<li>
<p><strong>æœ€ä½³å®è·µ</strong>ï¼š</p>
<ul>
<li><strong>åˆ†ç‰‡å­˜å‚¨</strong>ï¼šå¤§æ•°æ®ç»“æ„æŒ‰ä¸šåŠ¡æ‹†åˆ†ï¼Œå•ç»“æ„å¤§å°æ§åˆ¶åœ¨1MBä»¥å†…ã€‚</li>
<li><strong>å®šæœŸæ¸…ç†</strong>ï¼šç”¨<code>EXPIRE</code>è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œé¿å…æ— ç”¨æ•°æ®å †ç§¯ã€‚</li>
</ul>
</li>
</ul>
<p><strong>ç¤ºæ„å›¾</strong>ï¼šæ…¢æŸ¥è¯¢ä¼˜åŒ–æµç¨‹</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[è¯†åˆ«é—®é¢˜: KEYS/HGETALL]</span> â†’ <span class="hljs-selector-attr">[ä¼˜åŒ–å‘½ä»¤: SCAN/HMGET]</span> â†’ <span class="hljs-selector-attr">[è°ƒæ•´ç»“æ„: å°List/Set]</span> â†’ <span class="hljs-selector-attr">[å®¢æˆ·ç«¯ä¼˜åŒ–: Pipeline]</span> â†’ <span class="hljs-selector-attr">[éªŒè¯æ•ˆæœ]</span>
</code></pre>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šé€šè¿‡å‘½ä»¤è°ƒæ•´ã€æ•°æ®ç»“æ„ä¼˜åŒ–å’Œå®¢æˆ·ç«¯é…ç½®ï¼Œä½ å·²ç»æŒæ¡äº†æ…¢æŸ¥è¯¢ä¼˜åŒ–çš„æ ¸å¿ƒæŠ€èƒ½ã€‚ä½†åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæ€§èƒ½ç“¶é¢ˆå¾€å¾€éœ€è¦ç³»ç»ŸåŒ–æ’æŸ¥ã€‚ä¸‹ä¸€èŠ‚å°†å¸¦ä½ èµ°è¿›å®Œæ•´çš„æ’æŸ¥æµç¨‹ï¼Œä»é—®é¢˜å®šä½åˆ°ä¼˜åŒ–è½åœ°ï¼Œå½»åº•è§£å†³çº¿ä¸Šéš¾é¢˜ã€‚è®©æˆ‘ä»¬ç»§ç»­ï¼</p>
<hr/>
<h4 data-id="heading-14">äº”ã€æ€§èƒ½ç“¶é¢ˆæ’æŸ¥çš„å®Œæ•´æµç¨‹</h4>
<p>ä¼˜åŒ–æ…¢æŸ¥è¯¢çš„ç­–ç•¥å›ºç„¶é‡è¦ï¼Œä½†å®é™…é¡¹ç›®ä¸­ï¼Œæ€§èƒ½ç“¶é¢ˆå¾€å¾€éšè—åœ¨å¤æ‚çš„ç³»ç»Ÿä¸­ï¼Œéœ€è¦ä¸€å¥—ç³»ç»ŸåŒ–çš„æ’æŸ¥æµç¨‹æ¥â€œæŠ½ä¸å‰¥èŒ§â€ã€‚è¿™å°±åƒåŒ»ç”Ÿè¯Šæ–­ç—…æƒ…ï¼Œå¾—å…ˆæ£€æŸ¥ç—‡çŠ¶ï¼ˆæ—¥å¿—ï¼‰ã€åˆ†æç—…å› ï¼ˆæ•°æ®ï¼‰ï¼Œå†å¼€è¯æ–¹ï¼ˆä¼˜åŒ–ï¼‰ã€‚æœ¬èŠ‚å°†å¸¦ä½ èµ°ä¸€éä»é—®é¢˜å®šä½åˆ°ä¼˜åŒ–è½åœ°çš„å®Œæ•´æµç¨‹ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªçœŸå®æ¡ˆä¾‹å±•ç¤ºå¦‚ä½•åœ¨å‹åŠ›ä¸‹å¿«é€Ÿæ¢å¤æœåŠ¡ã€‚</p>
<h5 data-id="heading-15">1. é—®é¢˜å®šä½</h5>
<p>æ’æŸ¥çš„ç¬¬ä¸€æ­¥æ˜¯æ‰¾åˆ°â€œç—›ç‚¹â€ã€‚æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯æ ¸å¿ƒçº¿ç´¢ï¼Œä½†è¿˜éœ€è¦ç»“åˆç³»ç»Ÿç›‘æ§æ¥å…¨é¢åˆ¤æ–­ã€‚ä»¥ä¸‹æ˜¯æˆ‘å¸¸ç”¨çš„æ–¹æ³•ï¼š</p>
<ul>
<li>
<p><strong>æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—</strong><br/>
ç”¨<code>SLOWLOG GET</code>æŠ“å–æœ€è¿‘çš„æ…¢æŸ¥è¯¢ï¼Œå…³æ³¨è€—æ—¶æœ€é•¿å’Œé«˜é¢‘çš„å‘½ä»¤ã€‚</p>
</li>
<li>
<p><strong>ç³»ç»Ÿç›‘æ§</strong><br/>
æ£€æŸ¥CPUã€å†…å­˜ã€ç½‘ç»œç­‰æŒ‡æ ‡ã€‚æ¯”å¦‚Rediså•çº¿ç¨‹CPUå æ»¡å¯èƒ½è¯´æ˜å‘½ä»¤é˜»å¡ï¼Œç½‘ç»œå»¶è¿Ÿé«˜åˆ™å¯èƒ½æ˜¯å®¢æˆ·ç«¯é—®é¢˜ã€‚</p>
</li>
<li>
<p><strong>ç¤ºä¾‹å‘½ä»¤</strong>ï¼šç”¨<code>INFO</code>æŸ¥çœ‹RedisçŠ¶æ€</p>
<pre><code class="hljs language-bash" lang="bash">INFO ALL
<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹ï¼š</span>
<span class="hljs-comment"># used_cpu_sys: 10.5  # ç³»ç»ŸCPUä½¿ç”¨</span>
<span class="hljs-comment"># used_memory: 2G     # å†…å­˜å ç”¨</span>
<span class="hljs-comment"># instantaneous_ops_per_sec: 3000  # å½“å‰QPS</span>
</code></pre>
<p><strong>ç»éªŒ</strong>ï¼šæŸæ¬¡æ”¯ä»˜ç³»ç»ŸQPSä»1ä¸‡é™åˆ°2000ï¼Œæˆ‘å…ˆç”¨<code>SLOWLOG GET</code>å‘ç°å¤§é‡<code>LRANGE</code>è€—æ—¶è¶…50msï¼Œå†ç”¨<code>INFO</code>ç¡®è®¤CPUå ç”¨100%ï¼Œåˆæ­¥é”å®šæ˜¯å¤§æ•°æ®é‡æ“ä½œã€‚</p>
</li>
</ul>
<h5 data-id="heading-16">2. åˆ†æä¸éªŒè¯</h5>
<p>å®šä½é—®é¢˜åï¼Œè¦æ·±å…¥åˆ†æåŸå› å¹¶éªŒè¯å‡è®¾ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„æ­¥éª¤ï¼š</p>
<ul>
<li>
<p><strong>åˆ†ææ—¥å¿—</strong><br/>
æ£€æŸ¥æ…¢æŸ¥è¯¢çš„å‘½ä»¤æ¨¡å¼ï¼Œæ¯”å¦‚æ˜¯<code>KEYS *</code>è¿˜æ˜¯å¤§Hashæ“ä½œã€‚</p>
</li>
<li>
<p><strong>æ¨¡æ‹Ÿå‹æµ‹</strong><br/>
ç”¨å·¥å…·ï¼ˆå¦‚<code>redis-benchmark</code>ï¼‰é‡ç°é—®é¢˜ï¼ŒéªŒè¯æ˜¯å¦ä¸å¹¶å‘é‡ç›¸å…³ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">redis-benchmark -h localhost -p 6379 -c 50 -n 10000 -q -t LRANGE
<span class="hljs-comment"># -c 50: 50ä¸ªå¹¶å‘å®¢æˆ·ç«¯</span>
<span class="hljs-comment"># -n 10000: æ€»è¯·æ±‚æ•°</span>
<span class="hljs-comment"># è¾“å‡ºç¤ºä¾‹ï¼šLRANGE: 5000 req/s</span>
</code></pre>
</li>
<li>
<p><strong>éªŒè¯å‡è®¾</strong><br/>
è°ƒæ•´å‘½ä»¤æˆ–æ•°æ®ç»“æ„åï¼Œè§‚å¯Ÿè€—æ—¶å˜åŒ–ã€‚æ¯”å¦‚å°†<code>LRANGE 0 -1</code>æ”¹ä¸º<code>LRANGE 0 999</code>ï¼Œç¡®è®¤æ€§èƒ½æå‡ã€‚</p>
</li>
</ul>
<h5 data-id="heading-17">3. ä¼˜åŒ–è½åœ°ä¸ç›‘æ§</h5>
<p>æ‰¾åˆ°è§£å†³æ–¹æ¡ˆåï¼Œéƒ¨ç½²ä¼˜åŒ–å¹¶æŒç»­ç›‘æ§æ˜¯å…³é”®ï¼š</p>
<ul>
<li>
<p><strong>éƒ¨ç½²ä¼˜åŒ–</strong><br/>
æ ¹æ®ä¸Šä¸€èŠ‚ç­–ç•¥è°ƒæ•´å‘½ä»¤æˆ–ç»“æ„ï¼Œæ¯”å¦‚ç”¨<code>SCAN</code>æ›¿æ¢<code>KEYS</code>ã€‚æ³¨æ„å°èŒƒå›´æµ‹è¯•ï¼Œé¿å…å½±å“çº¿ä¸ŠæœåŠ¡ã€‚</p>
</li>
<li>
<p><strong>é…ç½®å‘Šè­¦</strong><br/>
è®¾ç½®æ…¢æŸ¥è¯¢æ•°é‡é˜ˆå€¼ï¼ˆå¦‚æ¯å¤©è¶…100æ¡å‘Šè­¦ï¼‰ï¼Œå¯ç”¨è„šæœ¬æ¨é€åˆ°ç›‘æ§ç³»ç»Ÿï¼š</p>
<pre><code class="hljs language-python" lang="python">slow_logs = r.slowlog_get(<span class="hljs-number">100</span>)
<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(slow_logs) &gt; <span class="hljs-number">100</span>:
    <span class="hljs-built_in">print</span>(<span class="hljs-string">"Alert: Slow queries exceed threshold!"</span>)
</code></pre>
</li>
<li>
<p><strong>æ³¨æ„äº‹é¡¹</strong><br/>
ä¼˜åŒ–åè§‚å¯Ÿä¸šåŠ¡æŒ‡æ ‡ï¼ˆå¦‚è®¢å•æˆåŠŸç‡ï¼‰ï¼Œç¡®ä¿æ²¡æœ‰å‰¯ä½œç”¨ã€‚</p>
</li>
</ul>
<p><strong>è¡¨æ ¼</strong>ï¼šæ’æŸ¥ä¸ä¼˜åŒ–é˜¶æ®µå¯¹æ¯”</p>





























<table><thead><tr><th>é˜¶æ®µ</th><th>å·¥å…·/å‘½ä»¤</th><th>ç›®æ ‡</th><th>è¾“å‡ºç¤ºä¾‹</th></tr></thead><tbody><tr><td>é—®é¢˜å®šä½</td><td><code>SLOWLOG GET</code>, <code>INFO</code></td><td>é”å®šæ…¢æŸ¥è¯¢å’Œèµ„æºç“¶é¢ˆ</td><td><code>LRANGE</code>è€—æ—¶50ms</td></tr><tr><td>åˆ†æéªŒè¯</td><td><code>redis-benchmark</code></td><td>ç¡®è®¤åŸå› å¹¶æµ‹è¯•ä¼˜åŒ–</td><td>QPSä»2000å‡åˆ°8000</td></tr><tr><td>ä¼˜åŒ–è½åœ°</td><td><code>SCAN</code>, è„šæœ¬å‘Šè­¦</td><td>éƒ¨ç½²å¹¶ç›‘æ§æ•ˆæœ</td><td>æ…¢æŸ¥è¯¢é™åˆ°10æ¡/å¤©</td></tr></tbody></table>
<h5 data-id="heading-18">4. çœŸå®æ¡ˆä¾‹</h5>
<ul>
<li><strong>èƒŒæ™¯</strong>ï¼šæŸç”µå•†é¡¹ç›®ä¸­ï¼Œç”¨æˆ·ä¸‹å•å»¶è¿Ÿä»50msé£™å‡åˆ°500msï¼Œè®¢å•æˆåŠŸç‡ä¸‹é™10%ã€‚</li>
<li><strong>å®šä½</strong>ï¼šç”¨<code>SLOWLOG GET</code>å‘ç°<code>HGETALL order:1001</code>è€—æ—¶200msï¼Œ<code>INFO</code>æ˜¾ç¤ºå†…å­˜å ç”¨æ¿€å¢ã€‚</li>
<li><strong>åˆ†æ</strong>ï¼šè®¢å•Hashå­—æ®µä»100æ¶¨åˆ°5000ï¼Œå¯¼è‡´è¯»å–å˜æ…¢ã€‚å‹æµ‹éªŒè¯ï¼š5000å­—æ®µæ—¶QPSä»…1000ã€‚</li>
<li><strong>ä¼˜åŒ–</strong>ï¼šå°†Hashæ‹†ä¸º<code>order:1001:base</code>ï¼ˆåŸºæœ¬ä¿¡æ¯ï¼‰å’Œ<code>order:1001:items</code>ï¼ˆå•†å“åˆ—è¡¨ï¼‰ï¼Œç”¨<code>HMGET</code>æ›¿æ¢<code>HGETALL</code>ã€‚</li>
<li><strong>ç»“æœ</strong>ï¼šå»¶è¿Ÿé™å›60msï¼ŒQPSæ¢å¤åˆ°1ä¸‡ï¼Œè®¢å•æˆåŠŸç‡å›å‡ã€‚</li>
</ul>
<p><strong>ç¤ºæ„å›¾</strong>ï¼šæ’æŸ¥æµç¨‹</p>
<pre><code class="hljs language-css" lang="css"><span class="hljs-selector-attr">[é—®é¢˜å‘ç°: QPSä¸‹é™]</span> â†’ <span class="hljs-selector-attr">[å®šä½: SLOWLOG+INFO]</span> â†’ <span class="hljs-selector-attr">[åˆ†æ: å‹æµ‹+éªŒè¯]</span> â†’ <span class="hljs-selector-attr">[ä¼˜åŒ–: å‘½ä»¤æ›¿æ¢+åˆ†ç‰‡]</span> â†’ <span class="hljs-selector-attr">[ç›‘æ§: å‘Šè­¦+æŒ‡æ ‡]</span>
</code></pre>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šé€šè¿‡å®Œæ•´çš„æ’æŸ¥æµç¨‹ï¼Œä½ å·²ç»èƒ½ä»æ··ä¹±çš„çº¿ä¸Šé—®é¢˜ä¸­æ‰¾åˆ°çªç ´å£ï¼Œå¹¶è½åœ°ä¼˜åŒ–ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ€»ç»“å¸¸è§çš„è¸©å‘ç»éªŒå’Œæœ€ä½³å®è·µï¼Œå¸®åŠ©ä½ åœ¨æœªæ¥å°‘èµ°å¼¯è·¯ã€‚å‡†å¤‡å¥½è¿æ¥ç»éªŒçš„â€œå¹²è´§â€äº†å—ï¼Ÿè®©æˆ‘ä»¬ç»§ç»­ï¼</p>
<hr/>
<h4 data-id="heading-19">å…­ã€å¸¸è§è¸©å‘ä¸ç»éªŒæ€»ç»“</h4>
<p>ç»è¿‡å‰å‡ èŠ‚çš„å®æˆ˜æ¼”ç»ƒï¼Œä½ å·²ç»æŒæ¡äº†æ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–çš„æ ¸å¿ƒæŠ€èƒ½ã€‚ä½†åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œç»éªŒå¾€å¾€æ˜¯ä»è¸©å‘ä¸­æç‚¼å‡ºæ¥çš„ã€‚æœ¬èŠ‚å°†åˆ†äº«æˆ‘åœ¨10å¹´Rediså¼€å‘ä¸­é‡åˆ°çš„å…¸å‹é—®é¢˜å’Œæ•™è®­ï¼Œå¹¶æ€»ç»“ä¸€äº›æœ€ä½³å®è·µï¼Œå¸Œæœ›ä½ èƒ½ä»ä¸­å—ç›Šï¼Œé¿å…é‡è¹ˆè¦†è¾™ã€‚è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹è¿™äº›â€œè¡€æ³ªå²â€å’Œå®ç”¨å»ºè®®å§ï¼</p>
<h5 data-id="heading-20">1. è¸©å‘æ¡ˆä¾‹</h5>
<ul>
<li>
<p><strong>æœªè®¾ç½®åˆç†é˜ˆå€¼å¯¼è‡´æ—¥å¿—ä¸¢å¤±</strong><br/>
æœ‰ä¸€æ¬¡çº¿ä¸ŠæœåŠ¡æ…¢å¾—åƒâ€œä¹Œé¾Ÿçˆ¬â€ï¼Œå´æŸ¥ä¸åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚åŸå› æ˜¯æˆ‘æŠŠ<code>slowlog-log-slower-than</code>è®¾ä¸º100msï¼Œè€Œå¤§éƒ¨åˆ†æ…¢æŸ¥è¯¢è€—æ—¶åœ¨10-50msä¹‹é—´ï¼Œç»“æœå•¥ä¹Ÿæ²¡è®°å½•ã€‚è°ƒæ•´ä¸º5000Î¼sï¼ˆ5msï¼‰åï¼Œé—®é¢˜æš´éœ²æ— é—ã€‚<br/>
<strong>æ•™è®­</strong>ï¼šåˆå§‹é˜ˆå€¼è®¾ä½ç‚¹ï¼ˆå¦‚1-5msï¼‰ï¼Œæ ¹æ®ä¸šåŠ¡è°ƒæ•´ï¼Œåˆ«è®©æ—¥å¿—â€œéšèº«â€ã€‚</p>
</li>
<li>
<p><strong>ç›²ç›®ä¼˜åŒ–å¿½ç•¥ä¸šåŠ¡é€»è¾‘</strong><br/>
æŸé¡¹ç›®ä¸­ï¼Œæˆ‘å‘ç°<code>LRANGE</code>æ…¢æŸ¥è¯¢é¢‘å‘ï¼Œæœæ–­æ‹†æˆå°Listï¼Œç»“æœå‘ç°ä¸šåŠ¡éœ€è¦å…¨é‡è¯»å–æ’è¡Œæ¦œï¼Œä¼˜åŒ–ååè€Œå¤šäº†ä¸€æ¬¡åˆå¹¶é€»è¾‘ï¼Œå¾—ä¸å¿å¤±ã€‚<br/>
<strong>æ•™è®­</strong>ï¼šä¼˜åŒ–å‰è¦ææ¸…æ¥šä¸šåŠ¡éœ€æ±‚ï¼Œåˆ«â€œå¤´ç—›åŒ»è„šâ€ã€‚</p>
</li>
</ul>
<h5 data-id="heading-21">2. æœ€ä½³å®è·µ</h5>
<p>åŸºäºè¸©å‘ç»éªŒï¼Œæˆ‘æ€»ç»“äº†ä»¥ä¸‹å‡ æ¡å®è·µå»ºè®®ï¼š</p>
<ul>
<li>
<p><strong>å®šæœŸå®¡æŸ¥æ…¢æŸ¥è¯¢æ—¥å¿—</strong><br/>
æ¯å‘¨è¿è¡Œè„šæœ¬æ£€æŸ¥æ…¢æŸ¥è¯¢ï¼Œé˜²æ‚£äºæœªç„¶ã€‚å¯ä»¥ç”¨Cronä»»åŠ¡è‡ªåŠ¨åŒ–ï¼š</p>
<pre><code class="hljs language-bash" lang="bash"><span class="hljs-comment"># æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡</span>
0 * * * * redis-cli -h localhost -p 6379 SLOWLOG GET 50 &gt; /log/slowlog.txt
</code></pre>
</li>
<li>
<p><strong>ç»“åˆä¸šåŠ¡é€‰æ‹©æ•°æ®ç»“æ„</strong><br/>
æ¯”å¦‚ç¼“å­˜ç”¨æˆ·çŠ¶æ€ç”¨Hashï¼Œå®æ—¶æ’è¡Œç”¨ZSetï¼Œåˆ«ä¸€å‘³è¿½æ±‚æ€§èƒ½å¿½ç•¥åœºæ™¯é€‚ç”¨æ€§ã€‚</p>
</li>
<li>
<p><strong>å°æ­¥å¿«è·‘éªŒè¯æ•ˆæœ</strong><br/>
ä¼˜åŒ–åå…ˆåœ¨æµ‹è¯•ç¯å¢ƒå‹æµ‹ï¼Œå†ç°åº¦ä¸Šçº¿ã€‚æ¯”å¦‚è°ƒæ•´<code>HGETALL</code>ä¸º<code>HMGET</code>ï¼Œè§‚å¯ŸQPSå’Œå»¶è¿Ÿåå†å…¨é‡éƒ¨ç½²ã€‚</p>
</li>
</ul>
<p><strong>è¡¨æ ¼</strong>ï¼šè¸©å‘ä¸è§£å†³å¯¹æ¯”</p>























<table><thead><tr><th>é—®é¢˜</th><th>åŸå› </th><th>è§£å†³æ–¹æ¡ˆ</th><th>æ•ˆæœ</th></tr></thead><tbody><tr><td>æ—¥å¿—ä¸¢å¤±</td><td>é˜ˆå€¼è¿‡é«˜</td><td>é™ä½åˆ°5ms</td><td>é—®é¢˜åŠæ—¶æš´éœ²</td></tr><tr><td>ä¼˜åŒ–ä¸ä¸šåŠ¡å†²çª</td><td>æœªè€ƒè™‘å…¨é‡éœ€æ±‚</td><td>å…ˆè¯„ä¼°ä¸šåŠ¡å†è°ƒæ•´ç»“æ„</td><td>æ€§èƒ½ä¸é€»è¾‘å…¼é¡¾</td></tr></tbody></table>
<h5 data-id="heading-22">3. ç»™è¯»è€…çš„å»ºè®®</h5>
<ul>
<li>
<p><strong>ä»å°é¡¹ç›®å…¥æ‰‹</strong><br/>
å¦‚æœä½ æ˜¯æ–°æ‰‹ï¼Œåˆ«æ€¥ç€ä¼˜åŒ–çº¿ä¸Šå¤§ç³»ç»Ÿã€‚å…ˆåœ¨æœ¬åœ°æ­å»ºRedisï¼Œæ¨¡æ‹Ÿæ…¢æŸ¥è¯¢ï¼ˆæ¯”å¦‚ç”¨<code>DEBUG SLEEP</code>åˆ¶é€ å»¶è¿Ÿï¼‰ï¼Œç†Ÿæ‚‰åˆ†ææµç¨‹ã€‚</p>
</li>
<li>
<p><strong>å–„ç”¨å·¥å…·ä¸ç¤¾åŒº</strong><br/>
Rediså®˜æ–¹æ–‡æ¡£ã€RedisInsightå’ŒStack Overflowéƒ½æ˜¯å®è—ã€‚é‡åˆ°é—®é¢˜å…ˆæŸ¥æŸ¥ï¼Œä¹Ÿè®¸åˆ«äººå·²ç»è¸©è¿‡åŒæ ·çš„å‘ã€‚</p>
</li>
<li>
<p><strong>ä¿æŒå¥½å¥‡å¿ƒ</strong><br/>
æ…¢æŸ¥è¯¢ä¼˜åŒ–æ˜¯ä¸ªæŒç»­å­¦ä¹ çš„è¿‡ç¨‹ï¼Œæ¯æ¬¡æ’æŸ¥éƒ½æ˜¯ä¸€æ¬¡æå‡ã€‚è¯•ç€è®°å½•è‡ªå·±çš„ä¼˜åŒ–æ¡ˆä¾‹ï¼Œç§¯ç´¯ç»éªŒã€‚</p>
</li>
</ul>
<p><strong>è¿‡æ¸¡åˆ°ä¸‹ä¸€èŠ‚</strong>ï¼šé€šè¿‡è¿™äº›è¸©å‘æ•™è®­å’Œå®è·µå»ºè®®ï¼Œä½ åº”è¯¥å¯¹æ…¢æŸ¥è¯¢çš„åº”å¯¹æ›´æœ‰ä¿¡å¿ƒäº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨ç»“è¯­ä¸­å›é¡¾æ ¸å¿ƒè¦ç‚¹ï¼Œå±•æœ›Redisæœªæ¥çš„å‘å±•æ–¹å‘ï¼Œå¹¶é‚€è¯·ä½ åˆ†äº«è‡ªå·±çš„ç»éªŒã€‚å‡†å¤‡å¥½è¿æ¥æœ€åçš„æ€»ç»“äº†å—ï¼Ÿè®©æˆ‘ä»¬ç»§ç»­ï¼</p>
<hr/>
<h4 data-id="heading-23">ä¸ƒã€ç»“è¯­</h4>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»ä¸€èµ·èµ°è¿‡äº†Redisæ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–çš„å®Œæ•´æ—…ç¨‹ã€‚ä»åŸºç¡€çŸ¥è¯†åˆ°åˆ†æå·¥å…·ï¼Œå†åˆ°ä¼˜åŒ–ç­–ç•¥å’Œæ’æŸ¥æµç¨‹ï¼Œè¿™ç¯‡æ–‡ç« ä¸ä»…æ˜¯ä¸€ä»½æŠ€æœ¯æŒ‡å—ï¼Œæ›´æ˜¯æˆ‘10å¹´å®æˆ˜ç»éªŒçš„æ²‰æ·€ã€‚æ…¢æŸ¥è¯¢è™½å°ï¼Œå´èƒ½å½±å“æ•´ä¸ªç³»ç»Ÿçš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚é€šè¿‡æœ¬æ–‡ï¼Œä½ åº”è¯¥å·²ç»æŒæ¡äº†å‘ç°é—®é¢˜ã€åˆ†æåŸå› å¹¶ä¼˜åŒ–è½åœ°çš„æ ¸å¿ƒæŠ€èƒ½ã€‚æ— è®ºæ˜¯æ›¿æ¢ä½æ•ˆå‘½ä»¤ã€è°ƒæ•´æ•°æ®ç»“æ„ï¼Œè¿˜æ˜¯é…ç½®å‘Šè­¦ç›‘æ§ï¼Œè¿™äº›æ–¹æ³•éƒ½èƒ½è®©ä½ åœ¨é¢å¯¹æ€§èƒ½ç“¶é¢ˆæ—¶æ›´åŠ ä»å®¹ã€‚</p>
<h5 data-id="heading-24">1. æ€»ç»“</h5>
<p>æ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–çš„ä»·å€¼åœ¨äºï¼Œå®ƒä¸ä»…æ˜¯æŠ€æœ¯çš„æå‡ï¼Œæ›´æ˜¯ä¸šåŠ¡ä¿éšœçš„åŸºçŸ³ã€‚ä½ ç°åœ¨èƒ½ç”¨<code>SLOWLOG GET</code>å®šä½é—®é¢˜ï¼Œç”¨<code>SCAN</code>å’Œ<code>HMGET</code>ä¼˜åŒ–å‘½ä»¤ï¼Œè¿˜èƒ½é€šè¿‡åˆ†ç‰‡å’ŒPipelineè§£å†³å¤§æ•°æ®é‡å’Œé«˜å¹¶å‘æŒ‘æˆ˜ã€‚è¿™äº›æŠ€èƒ½ä¸ä»…èƒ½å¸®ä½ æå‡QPSã€é™ä½å»¶è¿Ÿï¼Œè¿˜å¯èƒ½åœ¨å…³é”®æ—¶åˆ»æŒ½æ•‘ä¸€æ¬¡çº¿ä¸Šäº‹æ•…ã€‚è®°ä½ï¼Œæ€§èƒ½ä¼˜åŒ–æ²¡æœ‰ç»ˆç‚¹ï¼Œæ¯ä¸€æ¬¡æ’æŸ¥éƒ½æ˜¯ä¸€æ¬¡æˆé•¿ã€‚</p>
<h5 data-id="heading-25">2. å±•æœ›</h5>
<p>éšç€Redisçš„ä¸æ–­æ¼”è¿›ï¼Œæ…¢æŸ¥è¯¢ç›¸å…³çš„åŠŸèƒ½ä¹Ÿåœ¨æ”¹è¿›ã€‚æ¯”å¦‚Redis 7.xå¼•å…¥äº†æ›´çµæ´»çš„å‘½ä»¤åˆ†æå·¥å…·å’Œå†…å­˜ç®¡ç†ä¼˜åŒ–ï¼Œæœªæ¥å¯èƒ½ä¼šæä¾›æ›´æ™ºèƒ½çš„æ…¢æŸ¥è¯¢è¯Šæ–­ï¼Œç”šè‡³å†…ç½®æ¨èä¼˜åŒ–æ–¹æ¡ˆã€‚åŒæ—¶ï¼Œéšç€äº‘åŸç”Ÿå’Œåˆ†å¸ƒå¼æ¶æ„çš„æ™®åŠï¼ŒRedis Clusterå’ŒSentinelçš„æ…¢æŸ¥è¯¢ç®¡ç†ä¹Ÿå°†æˆä¸ºæ–°çƒ­ç‚¹ã€‚ä½œä¸ºå¼€å‘è€…ï¼ŒæŒç»­å…³æ³¨è¿™äº›è¶‹åŠ¿ï¼Œç»“åˆå®é™…é¡¹ç›®å®è·µï¼Œæ‰èƒ½ä¿æŒç«äº‰åŠ›ã€‚æˆ‘å»ºè®®ä½ å¤šå…³æ³¨Rediså®˜æ–¹åšå®¢å’Œç¤¾åŒºåŠ¨æ€ï¼Œç´§è·ŸæŠ€æœ¯è„‰æã€‚</p>
<h5 data-id="heading-26">3. äº’åŠ¨</h5>
<p>æŠ€æœ¯æ˜¯æ´»çš„ï¼Œç»éªŒæ˜¯å…±äº«çš„ã€‚æˆ‘åœ¨æ–‡ä¸­åˆ†äº«äº†è‡ªå·±çš„è¸©å‘å’Œå¿ƒå¾—ï¼Œä¹Ÿå¾ˆæœŸå¾…å¬åˆ°ä½ çš„æ•…äº‹ã€‚ä½ æ˜¯å¦é‡åˆ°è¿‡æ£˜æ‰‹çš„æ…¢æŸ¥è¯¢é—®é¢˜ï¼Ÿåˆæ˜¯æ€ä¹ˆè§£å†³çš„ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ–è€…é€šè¿‡Xè”ç³»æˆ‘ï¼ˆå‡è®¾æœ‰è¿™ä¸ªå¹³å°ï¼‰ï¼Œè®©æˆ‘ä»¬ä¸€èµ·äº¤æµæˆé•¿ã€‚Redisçš„ä¸–ç•Œå¾ˆå¤§ï¼Œä¼˜åŒ–ä¹‹è·¯è¿˜å¾ˆé•¿ï¼Œå¸Œæœ›æˆ‘ä»¬éƒ½èƒ½åœ¨è¿™æ¡è·¯ä¸Šè¶Šèµ°è¶Šè¿œï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Agent Skills å®Œå…¨æŒ‡å—ï¼šè®©ä½ çš„ AI Agent æ‹¥æœ‰è¶…èƒ½åŠ›]]></title>    <link>https://juejin.cn/post/7593262196843380788</link>    <guid>https://juejin.cn/post/7593262196843380788</guid>    <pubDate>2026-01-10T03:45:39.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593262196843380788" data-draft-id="7593240931286990900" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Agent Skills å®Œå…¨æŒ‡å—ï¼šè®©ä½ çš„ AI Agent æ‹¥æœ‰è¶…èƒ½åŠ›"/> <meta itemprop="keywords" content="ç®—æ³•"/> <meta itemprop="datePublished" content="2026-01-10T03:45:39.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="ä¹ƒç»è¡¡å®‡"/> <meta itemprop="url" content="https://juejin.cn/user/2373161075090537"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Agent Skills å®Œå…¨æŒ‡å—ï¼šè®©ä½ çš„ AI Agent æ‹¥æœ‰è¶…èƒ½åŠ›
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/2373161075090537/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    ä¹ƒç»è¡¡å®‡
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T03:45:39.000Z" title="Sat Jan 10 2026 03:45:39 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    0
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»9åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><h2 data-id="heading-0">Agent Skills å®Œå…¨æŒ‡å—ï¼šè®©ä½ çš„ AI Agent æ‹¥æœ‰è¶…èƒ½åŠ›</h2>
<blockquote>
<p><strong>æ‘˜è¦ï¼š</strong> æœ¬æ–‡è¯¦ç»†ä»‹ç» Agent Skills çš„æ¦‚å¿µã€å®ç°åŸç†å’Œæœ€ä½³å®è·µï¼Œé€šè¿‡å®æˆ˜æ¡ˆä¾‹æ•™ä½ å¦‚ä½•ä¸º AI Agent æ·»åŠ è‡ªå®šä¹‰æŠ€èƒ½ï¼Œè®©å…¶èƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å·¥å…·ã€API å’ŒæœåŠ¡ï¼Œå®ç°çœŸæ­£çš„è‡ªä¸»ä»»åŠ¡æ‰§è¡Œã€‚</p>
</blockquote>
<hr/>
<h3 data-id="heading-1">ğŸ“Œ å‰è¨€</h3>
<p>éšç€å¤§è¯­è¨€æ¨¡å‹çš„å¿«é€Ÿå‘å±•ï¼ŒAI Agent å·²ç»ä»ç®€å•çš„å¯¹è¯æœºå™¨äººè¿›åŒ–æˆèƒ½å¤Ÿè‡ªä¸»å®Œæˆå¤æ‚ä»»åŠ¡çš„æ™ºèƒ½ä½“ã€‚ä½†æ˜¯ï¼Œä»…ä»…ä¾é è¯­è¨€æ¨¡å‹æœ¬èº«æ˜¯ä¸å¤Ÿçš„â€”â€”Agent éœ€è¦ <strong>Skillsï¼ˆæŠ€èƒ½ï¼‰</strong> æ¥ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’ã€‚</p>
<p>å°±åƒäººç±»éœ€è¦å­¦ä¹ ä½¿ç”¨å·¥å…·ä¸€æ ·ï¼ŒAI Agent ä¹Ÿéœ€è¦æŒæ¡å„ç§æŠ€èƒ½ï¼šæœç´¢ç½‘é¡µã€è¯»å†™æ–‡ä»¶ã€è°ƒç”¨ APIã€æ‰§è¡Œä»£ç ç­‰ã€‚æœ¬æ–‡å°†å¸¦ä½ æ·±å…¥äº†è§£ Agent Skills çš„æ ¸å¿ƒæœºåˆ¶ï¼Œå¹¶æ‰‹æŠŠæ‰‹æ•™ä½ å®ç°è‡ªå·±çš„æŠ€èƒ½ç³»ç»Ÿã€‚</p>
<p><strong>é€‚åˆäººç¾¤ï¼š</strong></p>
<ul>
<li>AI Agent å¼€å‘è€…</li>
<li>LangChain/AutoGPT ç”¨æˆ·</li>
<li>æƒ³è¦æ‰©å±• AI èƒ½åŠ›çš„å·¥ç¨‹å¸ˆ</li>
</ul>
<hr/>
<h3 data-id="heading-2">ğŸ¯ ä»€ä¹ˆæ˜¯ Agent Skillsï¼Ÿ</h3>
<h4 data-id="heading-3">1.1 æ ¸å¿ƒæ¦‚å¿µ</h4>
<p><strong>Agent Skills</strong> æ˜¯èµ‹äºˆ AI Agent æ‰§è¡Œç‰¹å®šä»»åŠ¡çš„èƒ½åŠ›æ¨¡å—ã€‚æ¯ä¸ª Skill æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª<strong>å¯è°ƒç”¨çš„å‡½æ•°</strong>ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li><strong>å‡½æ•°åç§°</strong>ï¼šAgent çŸ¥é“ä½•æ—¶è°ƒç”¨å®ƒ</li>
<li><strong>å‡½æ•°æè¿°</strong>ï¼šå‘Šè¯‰ Agent è¿™ä¸ªæŠ€èƒ½èƒ½åšä»€ä¹ˆ</li>
<li><strong>å‚æ•°å®šä¹‰</strong>ï¼šéœ€è¦ä»€ä¹ˆè¾“å…¥</li>
<li><strong>æ‰§è¡Œé€»è¾‘</strong>ï¼šå®é™…çš„ä¸šåŠ¡ä»£ç </li>
</ul>
<h4 data-id="heading-4">1.2 å·¥ä½œåŸç†</h4>
<pre><code class="hljs">ç”¨æˆ·è¾“å…¥ â†’ Agent åˆ†æ â†’ é€‰æ‹©åˆé€‚çš„ Skill â†’ æ‰§è¡Œ Skill â†’ è¿”å›ç»“æœ â†’ ç»§ç»­æ¨ç†
</code></pre>
<p><strong>å…¸å‹æµç¨‹ï¼š</strong></p>
<ol start="0">
<li>ç”¨æˆ·ï¼š"å¸®æˆ‘æŸ¥ä¸€ä¸‹åŒ—äº¬ä»Šå¤©çš„å¤©æ°”"</li>
<li>Agent è¯†åˆ«éœ€è¦ä½¿ç”¨ <code>get_weather</code> æŠ€èƒ½</li>
<li>æå–å‚æ•°ï¼š<code>{"city": "åŒ—äº¬"}</code></li>
<li>æ‰§è¡ŒæŠ€èƒ½ï¼Œè°ƒç”¨å¤©æ°” API</li>
<li>è¿”å›ç»“æœï¼š"åŒ—äº¬ä»Šå¤©å¤šäº‘ï¼Œ22-28Â°C"</li>
<li>Agent ç»„ç»‡è¯­è¨€å›å¤ç”¨æˆ·</li>
</ol>
<h4 data-id="heading-5">1.3 ä¸ºä»€ä¹ˆéœ€è¦ Skillsï¼Ÿ</h4>

























<table><thead><tr><th>æŒ‘æˆ˜</th><th>è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td>LLM è®­ç»ƒæ•°æ®è¿‡æ—¶</td><td>é€šè¿‡æœç´¢ Skill è·å–å®æ—¶ä¿¡æ¯</td></tr><tr><td>æ— æ³•æ‰§è¡Œè®¡ç®—</td><td>æ·»åŠ ä»£ç æ‰§è¡Œ Skill</td></tr><tr><td>ä¸èƒ½è®¿é—®ç§æœ‰æ•°æ®</td><td>åˆ›å»ºæ•°æ®åº“æŸ¥è¯¢ Skill</td></tr><tr><td>æ— æ³•æ“ä½œå¤–éƒ¨ç³»ç»Ÿ</td><td>å¼€å‘ API è°ƒç”¨ Skill</td></tr></tbody></table>
<hr/>
<h3 data-id="heading-6">ğŸ’» å®ç°ä½ çš„ç¬¬ä¸€ä¸ª Skill</h3>
<h4 data-id="heading-7">2.1 åŸºç¡€ç¤ºä¾‹ï¼šå¤©æ°”æŸ¥è¯¢ Skill</h4>
<p>ä»¥ Python å’Œ LangChain ä¸ºä¾‹ï¼š</p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.tools <span class="hljs-keyword">import</span> Tool
<span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, AgentType
<span class="hljs-keyword">from</span> langchain.llms <span class="hljs-keyword">import</span> OpenAI
<span class="hljs-keyword">import</span> requests
â€‹
<span class="hljs-keyword">def</span> <span class="hljs-title function_">get_weather</span>(<span class="hljs-params">city: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
 Â  Â <span class="hljs-string">"""
 Â   æŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯
â€‹
 Â   Args:
 Â  Â  Â   city: åŸå¸‚åç§°ï¼ˆä¸­æ–‡æˆ–è‹±æ–‡ï¼‰
â€‹
 Â   Returns:
 Â  Â  Â   å¤©æ°”ä¿¡æ¯å­—ç¬¦ä¸²
 Â   """</span>
 Â  Â <span class="hljs-comment"># è¿™é‡Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œå®é™…åº”è°ƒç”¨çœŸå®å¤©æ°”API</span>
 Â  Â api_url = <span class="hljs-string">f"https://api.weatherapi.com/v1/current.json"</span>
 Â  Â params = {
 Â  Â  Â  Â <span class="hljs-string">"key"</span>: <span class="hljs-string">"YOUR_API_KEY"</span>,
 Â  Â  Â  Â <span class="hljs-string">"q"</span>: city,
 Â  Â  Â  Â <span class="hljs-string">"lang"</span>: <span class="hljs-string">"zh"</span>
 Â   }
â€‹
 Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â response = requests.get(api_url, params=params)
 Â  Â  Â  Â data = response.json()
â€‹
 Â  Â  Â  Â weather_info = <span class="hljs-string">f"<span class="hljs-subst">{city}</span>å½“å‰å¤©æ°”ï¼š<span class="hljs-subst">{data[<span class="hljs-string">'current'</span>][<span class="hljs-string">'condition'</span>][<span class="hljs-string">'text'</span>]}</span>ï¼Œ"</span> \
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">f"æ¸©åº¦ <span class="hljs-subst">{data[<span class="hljs-string">'current'</span>][<span class="hljs-string">'temp_c'</span>]}</span>Â°Cï¼Œ"</span> \
 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-string">f"ä½“æ„Ÿæ¸©åº¦ <span class="hljs-subst">{data[<span class="hljs-string">'current'</span>][<span class="hljs-string">'feelslike_c'</span>]}</span>Â°C"</span>
 Â  Â  Â  Â <span class="hljs-keyword">return</span> weather_info
 Â  Â <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"æŸ¥è¯¢å¤©æ°”å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>
â€‹
<span class="hljs-comment"># å°†å‡½æ•°åŒ…è£…æˆ Tool</span>
weather_tool = Tool(
 Â  Â name=<span class="hljs-string">"WeatherQuery"</span>,
 Â  Â func=get_weather,
 Â  Â description=<span class="hljs-string">"ç”¨äºæŸ¥è¯¢åŸå¸‚çš„å®æ—¶å¤©æ°”ä¿¡æ¯ã€‚è¾“å…¥åŸå¸‚åç§°ï¼Œè¿”å›å¤©æ°”çŠ¶å†µã€æ¸©åº¦ç­‰ä¿¡æ¯ã€‚"</span>
)
â€‹
<span class="hljs-comment"># åˆ›å»º Agent</span>
llm = OpenAI(temperature=<span class="hljs-number">0</span>)
tools = [weather_tool]
â€‹
agent = initialize_agent(
 Â  Â tools=tools,
 Â  Â llm=llm,
 Â  Â agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,
 Â  Â verbose=<span class="hljs-literal">True</span>
)
â€‹
<span class="hljs-comment"># ä½¿ç”¨ Agent</span>
response = agent.run(<span class="hljs-string">"åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"</span>)
<span class="hljs-built_in">print</span>(response)
</code></pre>
<p><strong>å…³é”®ç‚¹è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>name</code>ï¼šç®€æ´æ˜ç¡®çš„æŠ€èƒ½åç§°</li>
<li><code>description</code>ï¼šè¯¦ç»†æè¿°åŠŸèƒ½ï¼Œå¸®åŠ© Agent åˆ¤æ–­ä½•æ—¶ä½¿ç”¨</li>
<li><code>func</code>ï¼šå®é™…æ‰§è¡Œçš„å‡½æ•°</li>
<li>é”™è¯¯å¤„ç†ï¼šå¿…é¡»æ•è·å¼‚å¸¸å¹¶è¿”å›å‹å¥½ä¿¡æ¯</li>
</ul>
<h4 data-id="heading-8">2.2 è¿›é˜¶ç¤ºä¾‹ï¼šæ–‡ä»¶æ“ä½œ Skill</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> os
<span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Optional</span>
â€‹
<span class="hljs-keyword">def</span> <span class="hljs-title function_">read_file_skill</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span>, encoding: <span class="hljs-built_in">str</span> = <span class="hljs-string">"utf-8"</span></span>) -&gt; <span class="hljs-built_in">str</span>:
 Â  Â <span class="hljs-string">"""
 Â   è¯»å–æ–‡ä»¶å†…å®¹
â€‹
 Â   Args:
 Â  Â  Â   file_path: æ–‡ä»¶è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ï¼‰
 Â  Â  Â   encoding: æ–‡ä»¶ç¼–ç ï¼Œé»˜è®¤ utf-8
â€‹
 Â   Returns:
 Â  Â  Â   æ–‡ä»¶å†…å®¹å­—ç¬¦ä¸²
 Â   """</span>
 Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(file_path):
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"é”™è¯¯ï¼šæ–‡ä»¶ <span class="hljs-subst">{file_path}</span> ä¸å­˜åœ¨"</span>
â€‹
 Â  Â  Â  Â <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">'r'</span>, encoding=encoding) <span class="hljs-keyword">as</span> f:
 Â  Â  Â  Â  Â  Â content = f.read()
â€‹
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"æˆåŠŸè¯»å–æ–‡ä»¶ï¼Œå†…å®¹ï¼š\n<span class="hljs-subst">{content[:<span class="hljs-number">500</span>]}</span>..."</span> Â <span class="hljs-comment"># é™åˆ¶è¿”å›é•¿åº¦</span>
 Â  Â <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"è¯»å–æ–‡ä»¶å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>
â€‹
<span class="hljs-keyword">def</span> <span class="hljs-title function_">write_file_skill</span>(<span class="hljs-params">file_path: <span class="hljs-built_in">str</span>, content: <span class="hljs-built_in">str</span>, mode: <span class="hljs-built_in">str</span> = <span class="hljs-string">"w"</span></span>) -&gt; <span class="hljs-built_in">str</span>:
 Â  Â <span class="hljs-string">"""
 Â   å†™å…¥å†…å®¹åˆ°æ–‡ä»¶
â€‹
 Â   Args:
 Â  Â  Â   file_path: ç›®æ ‡æ–‡ä»¶è·¯å¾„
 Â  Â  Â   content: è¦å†™å…¥çš„å†…å®¹
 Â  Â  Â   mode: å†™å…¥æ¨¡å¼ï¼Œ'w' è¦†ç›–ï¼Œ'a' è¿½åŠ 
â€‹
 Â   Returns:
 Â  Â  Â   æ“ä½œç»“æœæè¿°
 Â   """</span>
 Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, mode, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
 Â  Â  Â  Â  Â  Â f.write(content)
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"æˆåŠŸå†™å…¥æ–‡ä»¶ <span class="hljs-subst">{file_path}</span>"</span>
 Â  Â <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"å†™å…¥æ–‡ä»¶å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>
â€‹
<span class="hljs-comment"># åˆ›å»ºå·¥å…·é›†</span>
file_tools = [
 Â  Â Tool(
 Â  Â  Â  Â name=<span class="hljs-string">"ReadFile"</span>,
 Â  Â  Â  Â func=read_file_skill,
 Â  Â  Â  Â description=<span class="hljs-string">"è¯»å–æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶å†…å®¹ã€‚è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼Œè¿”å›æ–‡ä»¶å†…å®¹ã€‚"</span>
 Â   ),
 Â  Â Tool(
 Â  Â  Â  Â name=<span class="hljs-string">"WriteFile"</span>,
 Â  Â  Â  Â func=write_file_skill,
 Â  Â  Â  Â description=<span class="hljs-string">"å°†å†…å®¹å†™å…¥æŒ‡å®šæ–‡ä»¶ã€‚éœ€è¦æ–‡ä»¶è·¯å¾„å’Œè¦å†™å…¥çš„å†…å®¹ä½œä¸ºå‚æ•°ã€‚"</span>
 Â   )
]
</code></pre>
<hr/>
<h3 data-id="heading-9">ğŸš€ å®æˆ˜æ¡ˆä¾‹ï¼šæ„å»ºå¤šæŠ€èƒ½ Agent</h3>
<h4 data-id="heading-10">3.1 éœ€æ±‚åœºæ™¯</h4>
<p>åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿï¼š</p>
<ol start="0">
<li>æœç´¢ç½‘é¡µä¿¡æ¯</li>
<li>è¿›è¡Œæ•°å­¦è®¡ç®—</li>
<li>ç”Ÿæˆå¹¶ä¿å­˜ä»£ç æ–‡ä»¶</li>
</ol>
<p>çš„å…¨èƒ½å‹ Agentã€‚</p>
<h4 data-id="heading-11">3.2 å®Œæ•´å®ç°</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">from</span> langchain.agents <span class="hljs-keyword">import</span> initialize_agent, Tool, AgentType
<span class="hljs-keyword">from</span> langchain.llms <span class="hljs-keyword">import</span> OpenAI
<span class="hljs-keyword">from</span> langchain.utilities <span class="hljs-keyword">import</span> SerpAPIWrapper
<span class="hljs-keyword">import</span> math
<span class="hljs-keyword">import</span> os
â€‹
<span class="hljs-comment"># Skill 1: ç½‘é¡µæœç´¢</span>
search = SerpAPIWrapper()
search_tool = Tool(
 Â  Â name=<span class="hljs-string">"WebSearch"</span>,
 Â  Â func=search.run,
 Â  Â description=<span class="hljs-string">"ç”¨äºæœç´¢äº’è”ç½‘ä¿¡æ¯ã€‚è¾“å…¥æœç´¢å…³é”®è¯ï¼Œè¿”å›ç›¸å…³ç½‘é¡µç»“æœæ‘˜è¦ã€‚"</span>
)
â€‹
<span class="hljs-comment"># Skill 2: æ•°å­¦è®¡ç®—</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">calculator_skill</span>(<span class="hljs-params">expression: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
 Â  Â <span class="hljs-string">"""å®‰å…¨çš„æ•°å­¦è¡¨è¾¾å¼è®¡ç®—"""</span>
 Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â <span class="hljs-comment"># ä»…å…è®¸æ•°å­¦è¿ç®—ï¼Œé˜²æ­¢ä»£ç æ³¨å…¥</span>
 Â  Â  Â  Â allowed_names = {k: v <span class="hljs-keyword">for</span> k, v <span class="hljs-keyword">in</span> math.__dict__.items() <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> k.startswith(<span class="hljs-string">"__"</span>)}
 Â  Â  Â  Â result = <span class="hljs-built_in">eval</span>(expression, {<span class="hljs-string">"__builtins__"</span>: {}}, allowed_names)
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"è®¡ç®—ç»“æœï¼š<span class="hljs-subst">{result}</span>"</span>
 Â  Â <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"è®¡ç®—é”™è¯¯ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>
â€‹
calculator_tool = Tool(
 Â  Â name=<span class="hljs-string">"Calculator"</span>,
 Â  Â func=calculator_skill,
 Â  Â description=<span class="hljs-string">"æ‰§è¡Œæ•°å­¦è®¡ç®—ã€‚è¾“å…¥æ•°å­¦è¡¨è¾¾å¼ï¼ˆå¦‚ '2+2' æˆ– 'sqrt(16)'ï¼‰ï¼Œè¿”å›è®¡ç®—ç»“æœã€‚"</span>
)
â€‹
<span class="hljs-comment"># Skill 3: ä»£ç ç”Ÿæˆä¸ä¿å­˜</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">save_code_skill</span>(<span class="hljs-params">code: <span class="hljs-built_in">str</span>, filename: <span class="hljs-built_in">str</span>, language: <span class="hljs-built_in">str</span> = <span class="hljs-string">"python"</span></span>) -&gt; <span class="hljs-built_in">str</span>:
 Â  Â <span class="hljs-string">"""ç”Ÿæˆä»£ç æ–‡ä»¶"""</span>
 Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â <span class="hljs-comment"># æ ¹æ®è¯­è¨€ç¡®å®šæ‰©å±•å</span>
 Â  Â  Â  Â ext_map = {<span class="hljs-string">"python"</span>: <span class="hljs-string">"py"</span>, <span class="hljs-string">"javascript"</span>: <span class="hljs-string">"js"</span>, <span class="hljs-string">"java"</span>: <span class="hljs-string">"java"</span>, <span class="hljs-string">"cpp"</span>: <span class="hljs-string">"cpp"</span>}
 Â  Â  Â  Â ext = ext_map.get(language.lower(), <span class="hljs-string">"txt"</span>)
â€‹
 Â  Â  Â  Â full_path = <span class="hljs-string">f"<span class="hljs-subst">{filename}</span>.<span class="hljs-subst">{ext}</span>"</span>
â€‹
 Â  Â  Â  Â <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(full_path, <span class="hljs-string">'w'</span>, encoding=<span class="hljs-string">'utf-8'</span>) <span class="hljs-keyword">as</span> f:
 Â  Â  Â  Â  Â  Â f.write(code)
â€‹
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"ä»£ç å·²ä¿å­˜åˆ° <span class="hljs-subst">{full_path}</span>"</span>
 Â  Â <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"ä¿å­˜å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>
â€‹
code_tool = Tool(
 Â  Â name=<span class="hljs-string">"SaveCode"</span>,
 Â  Â func=save_code_skill,
 Â  Â description=<span class="hljs-string">"ä¿å­˜ä»£ç åˆ°æ–‡ä»¶ã€‚éœ€è¦æä¾›ä»£ç å†…å®¹ã€æ–‡ä»¶åå’Œç¼–ç¨‹è¯­è¨€ç±»å‹ã€‚"</span>
)
â€‹
<span class="hljs-comment"># ç»„è£… Agent</span>
llm = OpenAI(temperature=<span class="hljs-number">0</span>, model_name=<span class="hljs-string">"gpt-4"</span>)
tools = [search_tool, calculator_tool, code_tool]
â€‹
agent = initialize_agent(
 Â  Â tools=tools,
 Â  Â llm=llm,
 Â  Â agent=AgentType.ZERO_SHOT_REACT_DESCRIPTION,
 Â  Â verbose=<span class="hljs-literal">True</span>,
 Â  Â max_iterations=<span class="hljs-number">5</span>
)
â€‹
<span class="hljs-comment"># æµ‹è¯•å¤æ‚ä»»åŠ¡</span>
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:
 Â  Â <span class="hljs-comment"># ä»»åŠ¡ï¼šæœç´¢ Python æ’åºç®—æ³•ï¼Œè®¡ç®—æ—¶é—´å¤æ‚åº¦ï¼Œç”Ÿæˆç¤ºä¾‹ä»£ç </span>
 Â  Â result = agent.run(<span class="hljs-string">"""
 Â   è¯·å¸®æˆ‘å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š
 Â   1. æœç´¢å¿«é€Ÿæ’åºç®—æ³•çš„åŸç†
 Â   2. è®¡ç®—å¯¹ 1000 ä¸ªå…ƒç´ æ’åºï¼Œå¹³å‡éœ€è¦å¤šå°‘æ¬¡æ¯”è¾ƒï¼ˆå‡è®¾ O(n log n)ï¼‰
 Â   3. ç”Ÿæˆä¸€ä¸ª Python å¿«é€Ÿæ’åºçš„å®ç°ä»£ç å¹¶ä¿å­˜ä¸º quicksort.py
 Â   """</span>)
â€‹
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"\n"</span> + <span class="hljs-string">"="</span>*<span class="hljs-number">50</span>)
 Â  Â <span class="hljs-built_in">print</span>(<span class="hljs-string">"æœ€ç»ˆç»“æœï¼š"</span>)
 Â  Â <span class="hljs-built_in">print</span>(result)
</code></pre>
<p><strong>è¿è¡Œæ•ˆæœï¼š</strong></p>
<pre><code class="hljs language-vbnet" lang="vbnet">&gt; Entering <span class="hljs-built_in">new</span> AgentExecutor chain...
â€‹
<span class="hljs-symbol">Thought:</span> æˆ‘éœ€è¦å…ˆæœç´¢å¿«é€Ÿæ’åºçš„åŸç†
<span class="hljs-symbol">Action:</span> WebSearch
Action Input: <span class="hljs-string">"å¿«é€Ÿæ’åºç®—æ³•åŸç†"</span>
â€‹
<span class="hljs-symbol">Observation:</span> å¿«é€Ÿæ’åºæ˜¯ä¸€ç§åˆ†æ²»ç®—æ³•...
â€‹
<span class="hljs-symbol">Thought:</span> ç°åœ¨è®¡ç®—æ¯”è¾ƒæ¬¡æ•°
<span class="hljs-symbol">Action:</span> Calculator
Action Input: <span class="hljs-string">"1000 * log(1000, 2)"</span>
â€‹
<span class="hljs-symbol">Observation:</span> è®¡ç®—ç»“æœï¼š<span class="hljs-number">9965.784284662087</span>
â€‹
<span class="hljs-symbol">Thought:</span> ç”Ÿæˆä»£ç å¹¶ä¿å­˜
<span class="hljs-symbol">Action:</span> SaveCode
Action Input: code=<span class="hljs-string">"def quicksort(arr):\n Â   if len(arr) &lt;= 1:\n Â  Â  Â   return arr\n Â   ..."</span>, filename=<span class="hljs-string">"quicksort"</span>, language=<span class="hljs-string">"python"</span>
â€‹
<span class="hljs-symbol">Observation:</span> ä»£ç å·²ä¿å­˜åˆ° quicksort.py
â€‹
Final Answer: å·²å®Œæˆæ‰€æœ‰ä»»åŠ¡ã€‚å¿«é€Ÿæ’åºé‡‡ç”¨åˆ†æ²»ç­–ç•¥...
</code></pre>
<hr/>
<h3 data-id="heading-12">ğŸ“Š Skills è®¾è®¡æœ€ä½³å®è·µ</h3>
<h4 data-id="heading-13">4.1 è®¾è®¡åŸåˆ™</h4>



































<table><thead><tr><th>åŸåˆ™</th><th>è¯´æ˜</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><strong>å•ä¸€èŒè´£</strong></td><td>æ¯ä¸ª Skill åªåšä¸€ä»¶äº‹</td><td>âŒ <code>handle_data</code> â†’ âœ… <code>read_csv</code>, <code>write_csv</code></td></tr><tr><td><strong>æ¸…æ™°å‘½å</strong></td><td>åç§°è¦è¡¨è¾¾åŠŸèƒ½</td><td>âŒ <code>tool1</code> â†’ âœ… <code>GetWeather</code></td></tr><tr><td><strong>è¯¦ç»†æè¿°</strong></td><td>å¸®åŠ© Agent ç†è§£ä½¿ç”¨åœºæ™¯</td><td>"æŸ¥è¯¢å¤©æ°”" â†’ "æŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å®æ—¶å¤©æ°”ï¼ŒåŒ…æ‹¬æ¸©åº¦ã€æ¹¿åº¦ã€é£é€Ÿç­‰ä¿¡æ¯"</td></tr><tr><td><strong>å®¹é”™å¤„ç†</strong></td><td>å¿…é¡»æ•è·å¼‚å¸¸</td><td>è¿”å›é”™è¯¯ä¿¡æ¯è€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸</td></tr><tr><td><strong>å‚æ•°éªŒè¯</strong></td><td>æ£€æŸ¥è¾“å…¥åˆæ³•æ€§</td><td>éªŒè¯åŸå¸‚åä¸ä¸ºç©ºï¼Œæ–‡ä»¶è·¯å¾„å­˜åœ¨ç­‰</td></tr></tbody></table>
<h4 data-id="heading-14">4.2 æè¿°æ–‡æœ¬ä¼˜åŒ–æŠ€å·§</h4>
<p>å¥½çš„æè¿°èƒ½è®© Agent æ›´å‡†ç¡®åœ°é€‰æ‹©æŠ€èƒ½ï¼š</p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># âŒ ä¸å¥½çš„æè¿°</span>
<span class="hljs-attr">description</span> = <span class="hljs-string">"æŸ¥å¤©æ°”"</span>
â€‹
<span class="hljs-comment"># âœ… ä¼˜ç§€çš„æè¿°</span>
<span class="hljs-attr">description</span> = <span class="hljs-string">"""
æŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å®æ—¶å¤©æ°”ä¿¡æ¯ã€‚
â€‹
ä½¿ç”¨åœºæ™¯ï¼š
- ç”¨æˆ·è¯¢é—®æŸä¸ªåŸå¸‚çš„å¤©æ°”
- éœ€è¦è·å–æ¸©åº¦ã€å¤©æ°”çŠ¶å†µã€ä½“æ„Ÿæ¸©åº¦ç­‰ä¿¡æ¯
â€‹
è¾“å…¥ï¼šåŸå¸‚åç§°ï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼Œå¦‚ "åŒ—äº¬" æˆ– "Beijing"ï¼‰
è¾“å‡ºï¼šå¤©æ°”æè¿°æ–‡æœ¬ï¼ŒåŒ…å«æ¸©åº¦ã€å¤©æ°”çŠ¶å†µã€é£åŠ›ç­‰
â€‹
ç¤ºä¾‹ï¼š
è¾“å…¥: "ä¸Šæµ·"
è¾“å‡º: "ä¸Šæµ·å½“å‰å¤©æ°”ï¼šå¤šäº‘ï¼Œæ¸©åº¦ 25Â°Cï¼Œä½“æ„Ÿæ¸©åº¦ 27Â°Cï¼Œä¸œå—é£ 3 çº§"
"""</span>
</code></pre>
<h4 data-id="heading-15">4.3 å®‰å…¨è€ƒè™‘</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">safe_skill_wrapper</span>(<span class="hljs-params">func</span>):
 Â  Â <span class="hljs-string">"""å®‰å…¨åŒ…è£…å™¨ï¼šé™åˆ¶æ‰§è¡Œæ—¶é—´å’Œèµ„æº"""</span>
 Â  Â <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args, **kwargs</span>):
 Â  Â  Â  Â <span class="hljs-keyword">import</span> signal
â€‹
 Â  Â  Â  Â <span class="hljs-keyword">def</span> <span class="hljs-title function_">timeout_handler</span>(<span class="hljs-params">signum, frame</span>):
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">raise</span> TimeoutError(<span class="hljs-string">"æŠ€èƒ½æ‰§è¡Œè¶…æ—¶"</span>)
â€‹
 Â  Â  Â  Â <span class="hljs-comment"># è®¾ç½® 5 ç§’è¶…æ—¶</span>
 Â  Â  Â  Â signal.signal(signal.SIGALRM, timeout_handler)
 Â  Â  Â  Â signal.alarm(<span class="hljs-number">5</span>)
â€‹
 Â  Â  Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â  Â  Â result = func(*args, **kwargs)
 Â  Â  Â  Â  Â  Â signal.alarm(<span class="hljs-number">0</span>) Â <span class="hljs-comment"># å–æ¶ˆè¶…æ—¶</span>
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> result
 Â  Â  Â  Â <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
 Â  Â  Â  Â  Â  Â signal.alarm(<span class="hljs-number">0</span>)
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"æ‰§è¡Œå¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>
â€‹
 Â  Â <span class="hljs-keyword">return</span> wrapper
â€‹
<span class="hljs-meta">@safe_skill_wrapper</span>
<span class="hljs-keyword">def</span> <span class="hljs-title function_">risky_skill</span>(<span class="hljs-params">command: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
 Â  Â <span class="hljs-string">"""å¯èƒ½è€—æ—¶çš„æ“ä½œ"""</span>
 Â  Â <span class="hljs-comment"># æ‰§è¡Œé€»è¾‘</span>
 Â  Â <span class="hljs-keyword">pass</span>
</code></pre>
<hr/>
<h3 data-id="heading-16">âš ï¸ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h3>
<h4 data-id="heading-17">Q1: Agent ä¸ä½¿ç”¨æˆ‘çš„ Skillï¼Ÿ</h4>
<p><strong>åŸå› ï¼š</strong></p>
<ul>
<li>æè¿°ä¸å¤Ÿæ¸…æ™°</li>
<li>åç§°æœ‰æ­§ä¹‰</li>
<li>åŠŸèƒ½ä¸å…¶ä»– Skill é‡å </li>
</ul>
<p><strong>è§£å†³ï¼š</strong></p>
<pre><code class="hljs language-ini" lang="ini"><span class="hljs-comment"># æ”¹è¿›æè¿°ï¼Œæ˜ç¡®ä½¿ç”¨åœºæ™¯</span>
<span class="hljs-attr">description</span> = <span class="hljs-string">"""
å½“ç”¨æˆ·æ˜ç¡®è¦æ±‚è¯»å–æ–‡ä»¶å†…å®¹æ—¶ä½¿ç”¨æ­¤æŠ€èƒ½ã€‚
ä¸è¦ç”¨äºå†™å…¥ã€åˆ é™¤æˆ–ä¿®æ”¹æ–‡ä»¶ã€‚
è¾“å…¥å¿…é¡»æ˜¯å…·ä½“çš„æ–‡ä»¶è·¯å¾„ã€‚
"""</span>
</code></pre>
<h4 data-id="heading-18">Q2: Skill æ‰§è¡Œå¤±è´¥ä½† Agent æ²¡æœ‰é‡è¯•ï¼Ÿ</h4>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">robust_skill</span>(<span class="hljs-params">param: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
 Â  Â <span class="hljs-string">"""å¸¦é‡è¯•æœºåˆ¶çš„æŠ€èƒ½"""</span>
 Â  Â max_retries = <span class="hljs-number">3</span>
â€‹
 Â  Â <span class="hljs-keyword">for</span> attempt <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(max_retries):
 Â  Â  Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â  Â  Â <span class="hljs-comment"># æ‰§è¡Œé€»è¾‘</span>
 Â  Â  Â  Â  Â  Â result = external_api_call(param)
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> result
 Â  Â  Â  Â <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
 Â  Â  Â  Â  Â  Â <span class="hljs-keyword">if</span> attempt == max_retries - <span class="hljs-number">1</span>:
 Â  Â  Â  Â  Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"é‡è¯• <span class="hljs-subst">{max_retries}</span> æ¬¡åä»ç„¶å¤±è´¥ï¼š<span class="hljs-subst">{<span class="hljs-built_in">str</span>(e)}</span>"</span>
 Â  Â  Â  Â  Â  Â time.sleep(<span class="hljs-number">1</span>) Â <span class="hljs-comment"># ç­‰å¾…åé‡è¯•</span>
</code></pre>
<h4 data-id="heading-19">Q3: å¦‚ä½•ä¼ é€’å¤æ‚å‚æ•°ï¼ˆå¦‚ JSONï¼‰ï¼Ÿ</h4>
<pre><code class="hljs language-python" lang="python"><span class="hljs-keyword">import</span> json
â€‹
<span class="hljs-keyword">def</span> <span class="hljs-title function_">complex_skill</span>(<span class="hljs-params">json_str: <span class="hljs-built_in">str</span></span>) -&gt; <span class="hljs-built_in">str</span>:
 Â  Â <span class="hljs-string">"""æ¥å— JSON å­—ç¬¦ä¸²å‚æ•°"""</span>
 Â  Â <span class="hljs-keyword">try</span>:
 Â  Â  Â  Â params = json.loads(json_str)
 Â  Â  Â  Â city = params.get(<span class="hljs-string">"city"</span>)
 Â  Â  Â  Â date = params.get(<span class="hljs-string">"date"</span>)
 Â  Â  Â  Â <span class="hljs-comment"># å¤„ç†é€»è¾‘</span>
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">f"æŸ¥è¯¢ <span class="hljs-subst">{city}</span> åœ¨ <span class="hljs-subst">{date}</span> çš„æ•°æ®"</span>
 Â  Â <span class="hljs-keyword">except</span> json.JSONDecodeError:
 Â  Â  Â  Â <span class="hljs-keyword">return</span> <span class="hljs-string">"å‚æ•°æ ¼å¼é”™è¯¯ï¼Œè¯·æä¾›æœ‰æ•ˆçš„ JSON å­—ç¬¦ä¸²"</span>
â€‹
<span class="hljs-comment"># ä½¿ç”¨æ—¶</span>
Tool(
 Â  Â name=<span class="hljs-string">"ComplexQuery"</span>,
 Â  Â func=complex_skill,
 Â  Â description=<span class="hljs-string">'éœ€è¦ JSON æ ¼å¼å‚æ•°ï¼Œä¾‹å¦‚ï¼š{"city": "åŒ—äº¬", "date": "2024-01-01"}'</span>
)
</code></pre>
<hr/>
<h3 data-id="heading-20">ğŸ”— å¸¸ç”¨æŠ€èƒ½åº“æ¨è</h3>






























<table><thead><tr><th>å·¥å…·åº“</th><th>åŠŸèƒ½</th><th>é“¾æ¥</th></tr></thead><tbody><tr><td><strong>LangChain Tools</strong></td><td>å®˜æ–¹é¢„ç½®æŠ€èƒ½é›†ï¼ˆæœç´¢ã€è®¡ç®—ã€APIè°ƒç”¨ï¼‰</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fpython.langchain.com%2Fdocs%2Fmodules%2Fagents%2Ftools%2F" target="_blank" title="https://python.langchain.com/docs/modules/agents/tools/" ref="nofollow noopener noreferrer">æ–‡æ¡£</a></td></tr><tr><td><strong>OpenAI Function Calling</strong></td><td>åŸç”Ÿå‡½æ•°è°ƒç”¨æ”¯æŒ</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fplatform.openai.com%2Fdocs%2Fguides%2Ffunction-calling" target="_blank" title="https://platform.openai.com/docs/guides/function-calling" ref="nofollow noopener noreferrer">æŒ‡å—</a></td></tr><tr><td><strong>AutoGPT Plugins</strong></td><td>ç¤¾åŒºè´¡çŒ®çš„æ’ä»¶å¸‚åœº</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2FSignificant-Gravitas%2FAuto-GPT-Plugins" target="_blank" title="https://github.com/Significant-Gravitas/Auto-GPT-Plugins" ref="nofollow noopener noreferrer">GitHub</a></td></tr><tr><td><strong>Semantic Kernel</strong></td><td>å¾®è½¯çš„æŠ€èƒ½ç®¡ç†æ¡†æ¶</td><td><a href="https://link.juejin.cn?target=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fsemantic-kernel%2F" target="_blank" title="https://learn.microsoft.com/en-us/semantic-kernel/" ref="nofollow noopener noreferrer">å®˜ç½‘</a></td></tr></tbody></table>
<hr/>
<h3 data-id="heading-21">ğŸ“ æ€»ç»“</h3>
<p>é€šè¿‡æœ¬æ–‡ï¼Œä½ å·²ç»æŒæ¡äº† Agent Skills çš„æ ¸å¿ƒçŸ¥è¯†ï¼š</p>
<p><strong>å…³é”®è¦ç‚¹ï¼š</strong></p>
<ol start="0">
<li>âœ… Skills æ˜¯ Agent ä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’çš„æ¡¥æ¢</li>
<li>âœ… è®¾è®¡ Skill è¦éµå¾ªå•ä¸€èŒè´£ã€æ¸…æ™°å‘½åã€å®¹é”™å¤„ç†åŸåˆ™</li>
<li>âœ… ä¼˜ç§€çš„æè¿°æ–‡æœ¬èƒ½æ˜¾è‘—æå‡ Agent çš„æŠ€èƒ½é€‰æ‹©å‡†ç¡®ç‡</li>
<li>âœ… å®æˆ˜ä¸­è¦æ³¨æ„å®‰å…¨æ€§ã€è¶…æ—¶æ§åˆ¶å’Œé”™è¯¯å¤„ç†</li>
</ol>
<p><strong>ä¸‹ä¸€æ­¥å»ºè®®ï¼š</strong></p>
<ul>
<li>ğŸ”¨ åŠ¨æ‰‹å®ç° 3-5 ä¸ªè‡ªå·±ä¸šåŠ¡ç›¸å…³çš„ Skills</li>
<li>ğŸ“š æ·±å…¥å­¦ä¹  LangChain æˆ– Semantic Kernel æ¡†æ¶</li>
<li>ğŸŒ æ¢ç´¢ Function Calling çš„é«˜çº§ç”¨æ³•</li>
<li>ğŸ¤ åŠ å…¥ AI Agent å¼€å‘ç¤¾åŒºï¼Œåˆ†äº«ä½ çš„æŠ€èƒ½åº“</li>
</ul>
<p><strong>è®°ä½ï¼š</strong> ä¸€ä¸ªå¼ºå¤§çš„ Agent ä¸ä»…å–å†³äºåº•å±‚æ¨¡å‹ï¼Œæ›´å–å†³äºä½ ä¸ºå®ƒé…å¤‡äº†å“ªäº›"æ­¦å™¨"ï¼ˆSkillsï¼‰ã€‚ç°åœ¨å°±å¼€å§‹æ„å»ºä½ çš„æŠ€èƒ½åº“å§ï¼</p></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item><item>    <title><![CDATA[Zed ç¼–è¾‘å™¨çš„ 6 ä¸ªéšè—æŠ€å·§ï¼šæå‡å¼€å‘æ•ˆç‡çš„ã€Œå†·çŸ¥è¯†ã€æ•´ç†]]></title>    <link>https://juejin.cn/post/7593175890795036718</link>    <guid>https://juejin.cn/post/7593175890795036718</guid>    <pubDate>2026-01-10T00:23:24.000Z</pubDate>    <description><![CDATA[<article itemscope="itemscope" itemtype="http://schema.org/Article" data-entry-id="7593175890795036718" data-draft-id="7582845425402642472" data-original-type="0" class="article" data-v-61fb5e44=""><!----> <meta itemprop="headline" content="Zed ç¼–è¾‘å™¨çš„ 6 ä¸ªéšè—æŠ€å·§ï¼šæå‡å¼€å‘æ•ˆç‡çš„ã€Œå†·çŸ¥è¯†ã€æ•´ç†"/> <meta itemprop="keywords" content="äººå·¥æ™ºèƒ½"/> <meta itemprop="datePublished" content="2026-01-10T00:23:24.000Z"/> <meta itemprop="image" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-128.png~tplv-t2oaga2asx-image.image"/> <div itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="name" content="golangå­¦ä¹ è®°"/> <meta itemprop="url" content="https://juejin.cn/user/4371313964100990"/></div> <div itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="æ˜é‡‘"/> <div itemprop="logo" itemscope="itemscope" itemtype="https://schema.org/ImageObject"><meta itemprop="url" content="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-assets/icon/icon-white-180.png~tplv-t2oaga2asx-image.image"/> <meta itemprop="width" content="180"/> <meta itemprop="height" content="180"/></div></div> <h1 class="article-title" data-v-61fb5e44="">
            Zed ç¼–è¾‘å™¨çš„ 6 ä¸ªéšè—æŠ€å·§ï¼šæå‡å¼€å‘æ•ˆç‡çš„ã€Œå†·çŸ¥è¯†ã€æ•´ç†
            <!----> <!----></h1> <div class="author-info-block block-hidden" data-v-61fb5e44=""><div class="author-info-box" data-v-61fb5e44=""><div class="author-name" data-v-61fb5e44=""><a href="/user/4371313964100990/posts" target="_blank" rel="" class="jj-link username username ellipsis" data-v-65b50b51="" data-v-292f6e48="" data-v-61fb5e44=""><span class="name" style="max-width:160px;" data-v-65b50b51="" data-v-292f6e48="">
    golangå­¦ä¹ è®°
  </span> <!----> <!----> <!----> </a></div> <div class="meta-box" data-v-61fb5e44=""><time datetime="2026-01-10T00:23:24.000Z" title="Sat Jan 10 2026 00:23:24 GMT+0000 (Coordinated Universal Time)" class="time" data-v-61fb5e44="">
                    2026-01-10
                  </time> <svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="read-icon" data-v-61fb5e44=""><path d="M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z" stroke="currentColor" data-v-61fb5e44=""/><circle cx="7.89922" cy="8.00078" r="2.2" stroke="currentColor" data-v-61fb5e44=""/></svg> <span class="views-count" data-v-61fb5e44="">
                    1
                  </span> <span class="read-time" data-v-61fb5e44=""><svg width="16" height="16" viewbox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-61fb5e44=""><rect width="16" height="16" fill="none" data-v-61fb5e44=""/><circle cx="8" cy="8" r="5.65625" stroke="#8A919F" data-v-61fb5e44=""/><path d="M7.69141 5.18652V8.30924H10.8141" stroke="#8A919F" stroke-linecap="round" stroke-linejoin="round" data-v-61fb5e44=""/></svg>
                    é˜…è¯»3åˆ†é’Ÿ
                  </span> <!----></div></div> <div style="flex:1;" data-v-61fb5e44=""/> <!----> <!----></div> <!----> <!----> <!----> <!----> <div id="article-root" itemprop="articleBody" class="main" data-v-61fb5e44=""><div class="article-viewer markdown-body result"><style>.markdown-body{word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#252933}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px}.markdown-body h1{font-size:24px;line-height:38px;margin-bottom:5px}.markdown-body h2{font-size:22px;line-height:34px;padding-bottom:12px;border-bottom:1px solid #ececec}.markdown-body h3{font-size:20px;line-height:28px}.markdown-body h4{font-size:18px;line-height:26px}.markdown-body h5{font-size:17px;line-height:24px}.markdown-body h6{font-size:16px;line-height:24px}.markdown-body p{line-height:inherit;margin-top:22px;margin-bottom:22px}.markdown-body img{max-width:100%}.markdown-body hr{border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px}.markdown-body code{word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em}.markdown-body code,.markdown-body pre{font-family:Menlo,Monaco,Consolas,Courier New,monospace}.markdown-body pre{overflow:auto;position:relative;line-height:1.75}.markdown-body pre&gt;code{font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8}.markdown-body a{text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff}.markdown-body a:active,.markdown-body a:hover{color:#275b8c}.markdown-body table{display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6}.markdown-body thead{background:#f6f6f6;color:#000;text-align:left}.markdown-body tr:nth-child(2n){background-color:#fcfcfc}.markdown-body td,.markdown-body th{padding:12px 7px;line-height:24px}.markdown-body td{min-width:120px}.markdown-body blockquote{color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8}.markdown-body blockquote:after{display:block;content:""}.markdown-body blockquote&gt;p{margin:10px 0}.markdown-body ol,.markdown-body ul{padding-left:28px}.markdown-body ol li,.markdown-body ul li{margin-bottom:0;list-style:inherit}.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item{list-style:none}.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul{margin-top:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:3px}.markdown-body ol li{padding-left:6px}.markdown-body .contains-task-list{padding-left:0}.markdown-body .task-list-item{list-style:none}@media (max-width:720px){.markdown-body h1{font-size:24px}.markdown-body h2{font-size:20px}.markdown-body h3{font-size:18px}}</style><style data-highlight="" data-highlight-key="juejin">.markdown-body pre,.markdown-body pre&gt;code.hljs{color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style><p>Zed è‡ªä»ä»Šå¹´å¼€å§‹å‘å¸ƒäº†winç‰ˆæœ¬ï¼Œä¹Ÿæœ‰æ›´å¤šçš„ç”¨æˆ·å¼€å§‹ä½¿ç”¨zedè¿™å—æ–°æ—¶ä»£çš„AI IDEï¼Œä¸‹é¢å°±æ¥ä»‹ç»å‡ ä¸ªéå¸¸å®ç”¨çš„zedæŠ€å·§ï¼Œæå‡å¤§å®¶çš„æ•ˆç‡ï¼</p>
<h2 data-id="heading-0">ä¸€ã€ä»»åŠ¡å‘½ä»¤å®æ—¶ä¿®æ”¹ï¼š<code>Tab + Alt+Enter</code> ç¥æ“ä½œ</h2>
<p>Zed çš„ä»»åŠ¡ç³»ç»Ÿï¼ˆTasksï¼‰æ”¯æŒ<strong>ä¸´æ—¶ç¼–è¾‘å‘½ä»¤</strong>åç«‹å³è¿è¡Œï¼Œç‰¹åˆ«é€‚åˆè°ƒè¯•åœºæ™¯ã€‚</p>
<h3 data-id="heading-1">ğŸŒ° åœºæ™¯ä¸¾ä¾‹ï¼šRust æµ‹è¯•éœ€å¼€å¯ backtrace</h3>
<p>é»˜è®¤ <code>cargo test</code> ä»»åŠ¡ä¸å¸¦ <code>RUST_BACKTRACE=1</code>ï¼Œä½†æˆ‘ä»¬å¯ä»¥ï¼š</p>
<ol>
<li>æŒ‰ <code>Cmd/Ctrl + Shift + P</code> â†’ è¾“å…¥ <code>task: spawn</code></li>
<li>é€‰æ‹©ä¸€ä¸ªä»»åŠ¡å â†’ æŒ‰ <code>Tab</code> é”®å±•å¼€åŸå§‹å‘½ä»¤<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/75d3a3cfebd145e78d6de2b60f714152~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768609403&amp;x-signature=QI2JIAs6RDZs7TamAGE%2BJrHHxDE%3D" alt="" loading="lazy"/></li>
<li>æ‰‹åŠ¨åœ¨å‘½ä»¤å‰åŠ ä¸Š <code>RUST_BACKTRACE=1 </code>ï¼ˆæ³¨æ„ç©ºæ ¼ï¼‰</li>
<li>æŒ‰ <code>Alt + Enter</code> è¿è¡Œ â†’ å³ä¸º <strong>ã€Œä¸€æ¬¡æ€§ä»»åŠ¡ã€ï¼ˆOneshot Taskï¼‰</strong><br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/3e1ff6853ebd4cefa7fc93c79025c02c~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768609403&amp;x-signature=5d6d%2F4oU9o6a%2FlclwuRwYOjGR4Y%3D" alt="" loading="lazy"/></li>
</ol>
<p>âœ… ä¼˜ç‚¹ï¼š</p>
<ul>
<li>ä¸æ±¡æŸ“é…ç½®æ–‡ä»¶</li>
<li>å†å²è®°å½•ä¼šä¿å­˜ä¿®æ”¹åçš„å‘½ä»¤ï¼ˆä¸‹æ¬¡å¯ç›´æ¥å¤ç”¨ï¼‰<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/4446b8c9ae0f4dd3b4cbe6efa4cdbaf7~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768609403&amp;x-signature=IgPyMmFhbk6UiLY0%2F1z9py%2FFVkQ%3D" alt="" loading="lazy"/></li>
</ul>
<hr/>
<h2 data-id="heading-2">äºŒã€ä¸º Bun æµ‹è¯•æ·»åŠ ã€Œè¡Œå†… Run æŒ‰é’®ã€</h2>
<p>Zed æ”¯æŒåœ¨ä»£ç è¡Œå·æ—æ˜¾ç¤º â–¶ï¸ æŒ‰é’®ï¼Œç‚¹å‡»ç›´æ¥è¿è¡Œå½“å‰æµ‹è¯•ã€‚</p>
<h3 data-id="heading-3">âœ”ï¸ è‡ªåŠ¨æ”¯æŒæ¡ä»¶</h3>
<ul>
<li>é¡¹ç›® <code>package.json</code> ä¸­åŒ…å« <code>"@types/bun"</code></li>
<li>æ–‡ä»¶ä¸º <code>.test.ts</code> / <code>.spec.js</code> ç­‰è§„èŒƒå‘½å</li>
</ul>
<h3 data-id="heading-4">âš™ï¸ æ‰‹åŠ¨é…ç½®ï¼ˆé€šç”¨æ–¹æ¡ˆï¼‰</h3>
<p>è‹¥æœªè‡ªåŠ¨è¯†åˆ«ï¼Œå¯åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>.zed/tasks.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"label"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Bun Test"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"bun test"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"\"$ZED_RELATIVE_FILE\" -t=\"$ZED_SYMBOL\""</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"tags"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"js-test"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"ts-test"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"bun-test"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"tsx-test"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span>
</code></pre>
<p>âœ… æ•ˆæœï¼š<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/61abc96daf9449ec9a69b249ce4c03ea~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768609403&amp;x-signature=JytCtyODD0a67kXnLApyMGv521s%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>ğŸ’¡ <code>$ZED_RELATIVE_FILE</code> å’Œ <code>$ZED_SYMBOL</code> æ˜¯ Zed å†…ç½®å˜é‡ï¼Œåˆ†åˆ«ä»£è¡¨å½“å‰æ–‡ä»¶è·¯å¾„ã€å…‰æ ‡æ‰€åœ¨ç¬¦å·ï¼ˆå¦‚æµ‹è¯•å‡½æ•°åï¼‰ã€‚</p>
</blockquote>
<hr/>
<h2 data-id="heading-5">ä¸‰ã€ç»™æ–‡ä»¶å›¾æ ‡ã€ŒåŠ ç‚¹é¢œè‰²ã€â€”â€” å®‰è£… Catppuccin Icons</h2>
<p>Zed é»˜è®¤æ˜¯<strong>å•è‰²å›¾æ ‡</strong>ï¼š<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/8b7e935163bc482f962619ae0ab6a24f~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768609403&amp;x-signature=yAzt9DTW7kqN1Bk9QOhZvf90TGU%3D" alt="" loading="lazy"/></p>
<p>ğŸ‘‰ å®‰è£…å½©è‰²å›¾æ ‡ä¸»é¢˜ä¸‰æ­¥èµ°ï¼š</p>
<ol>
<li>å‘½ä»¤é¢æ¿ â†’ <code>zed: extensions</code> â†’ æœç´¢ <code>Catppuccin Icons</code> â†’ Install</li>
<li>å‘½ä»¤é¢æ¿ â†’ <code>icon theme selector: toggle</code> â†’ é€‰æ‹© <code>Catppuccin Mocha</code>ï¼ˆæˆ–å…¶ä»–å˜ä½“ï¼‰</li>
<li>ï¼ˆå¯é€‰ï¼‰å¼€å¯ Tab æ å›¾æ ‡ï¼š<br/>
åœ¨ <code>settings.json</code> ä¸­æ·»åŠ ï¼š
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"tabs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"file_icons"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ol>
<p>ğŸ‰ æ•ˆæœå¯¹æ¯”ï¼š<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/715dcde9f3d24c4bb9fdb21bbece5e43~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768609403&amp;x-signature=4OyqOSv7cblxIqKsLTAQt1zdgY0%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-6">å››ã€ç”¨ <code>television</code> æ›¿ä»£é»˜è®¤æ–‡ä»¶æœç´¢ï¼ˆVim ç”¨æˆ·ç‹‚å–œï¼‰</h2>
<blockquote>
<p><code>television</code> æ˜¯ä¸€ä¸ªç»ˆç«¯ç‰ˆçš„æ¨¡ç³ŠæŸ¥æ‰¾å™¨ï¼ˆç±»ä¼¼ fzf + Telescope.nvimï¼‰ï¼Œæ”¯æŒé¢„è§ˆã€å¤šé€‰ç­‰é«˜çº§åŠŸèƒ½ã€‚</p>
</blockquote>
<h3 data-id="heading-7">ğŸ”§ é…ç½®æ­¥éª¤</h3>
<ol>
<li>
<p>å®‰è£… <a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Fayazhafiz%2Ftelevision" target="_blank" title="https://github.com/ayazhafiz/television" ref="nofollow noopener noreferrer">television</a>ï¼ˆéœ€ Rust ç¯å¢ƒï¼‰ï¼š</p>
<pre><code class="hljs language-bash" lang="bash">cargo install television
</code></pre>
</li>
<li>
<p>åœ¨ <code>tasks.json</code> ä¸­æ·»åŠ ä»»åŠ¡ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"label"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Television File Finder"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"command"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"zed \"$(tv files)\""</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"hide"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"always"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"allow_concurrent_runs"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"use_new_terminal"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
<li>
<p>ç»‘å®šå¿«æ·é”®ï¼ˆå¦‚è¦†ç›– <code>Cmd/Ctrl+P</code>ï¼‰ï¼š<br/>
ç¼–è¾‘ <code>keymap.json</code>ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"bindings"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"cmd-p"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">"task::Spawn"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span> <span class="hljs-attr">"task_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Television File Finder"</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">"reveal_target"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"center"</span> <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
</li>
</ol>
<p>âœ… æœ€ç»ˆæ•ˆæœï¼š<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/00430f5b81394b9ba97e680fb34d7870~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768609403&amp;x-signature=11D4osPrJIEoJY%2BeATDQ6%2FmiO54%3D" alt="" loading="lazy"/></p>
<hr/>
<h2 data-id="heading-8">äº”ã€ç»ˆç«¯è‡ªåŠ¨è¿›å…¥é¡¹ç›®ä¸“å± tmux ä¼šè¯</h2>
<p>é€‚åˆé‡åº¦ tmux ç”¨æˆ·â€”â€”æ¯ä¸ªé¡¹ç›®ç‹¬ç«‹ sessionï¼Œé¿å…çª—å£æ··ä¹±ã€‚</p>
<p>åœ¨ <code>settings.json</code> ä¸­é…ç½®ï¼š</p>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"terminal"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"shell"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"with_arguments"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"program"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"/bin/zsh"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"args"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"-c"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"tmux new-session -A -s \"$(basename \"$PWD\")\""</span><span class="hljs-punctuation">]</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<ul>
<li><code>-A</code>ï¼šè‹¥ session å­˜åœ¨åˆ™ attachï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º</li>
<li><code>-s</code>ï¼šæŒ‡å®š session åä¸ºå½“å‰ç›®å½•åï¼ˆå¦‚ <code>my-project</code>ï¼‰</li>
</ul>
<p>ğŸ“Œ æ•ˆæœï¼šæ‰“å¼€ç»ˆç«¯å³è¿›å…¥ä¸“å± tmuxï¼Œå¯è‡ªç”±åˆ†å±/åˆ‡æ¢çª—å£ï¼š<br/>
<img src="https://p9-xtjj-sign.byteimg.com/tos-cn-i-73owjymdk6/aea91a77370944369d21e7243ca33aa5~tplv-73owjymdk6-jj-mark-v1:0:0:0:0:5o6Y6YeR5oqA5pyv56S-5Yy6IEAgZ29sYW5n5a2m5Lmg6K6w:q75.awebp?rk3s=f64ab15b&amp;x-expires=1768609403&amp;x-signature=9OgcGlMsctZM51%2Bfdf8mP2aq%2BiY%3D" alt="" loading="lazy"/></p>
<blockquote>
<p>âœ… æ”¯æŒ bash/fishï¼šåªéœ€ä¿®æ”¹ <code>program</code> è·¯å¾„ï¼Œå¦‚ <code>"/bin/bash"</code></p>
</blockquote>
<hr/>
<h2 data-id="heading-9">å…­ã€è®© Zed è®¤è¯†ã€Œé™Œç”Ÿã€æ–‡ä»¶åç¼€ï¼ˆå¦‚ <code>.jsm</code>ï¼‰</h2>
<p>Zed é»˜è®¤ä»…è¯†åˆ«å¸¸è§åç¼€ï¼ˆ<code>.js</code>, <code>.ts</code>, <code>.rs</code>â€¦ï¼‰ã€‚é‡åˆ° <code>.jsm</code>ï¼ˆESM æ¨¡å—ï¼‰ã€<code>.svelte.ts</code> ç­‰å¯æ‰‹åŠ¨æ˜ å°„ï¼š</p>
<h3 data-id="heading-10">ğŸ” ä¸´æ—¶æ–¹æ¡ˆï¼ˆå•æ¬¡ç”Ÿæ•ˆï¼‰</h3>
<p>å‘½ä»¤é¢æ¿ â†’ <code>language selector: toggle</code> â†’ é€‰ <code>JavaScript</code></p>
<p>âš ï¸ ç¼ºç‚¹ï¼šå…³é—­æ–‡ä»¶å³å¤±æ•ˆã€‚</p>
<h3 data-id="heading-11">âœ… æ°¸ä¹…æ–¹æ¡ˆï¼šå†™å…¥ <code>settings.json</code></h3>
<pre><code class="hljs language-json" lang="json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"file_types"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"JavaScript"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"*.jsm"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"*.mjs"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"TypeScript"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"*.cts"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"*.mts"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"Python"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"*.pyi"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"*.tac"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"Rust"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"*.rs.in"</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<blockquote>
<p>âœ… æ”¯æŒ glob é€šé…ç¬¦<br/>
ğŸ” ä¼˜å…ˆå»ºè®®ï¼šå…ˆæŸ¥ <a href="https://link.juejin.cn?target=https%3A%2F%2Fzed.dev%2Fextensions" target="_blank" title="https://zed.dev/extensions" ref="nofollow noopener noreferrer">Zed æ‰©å±•å¸‚åœº</a> æ˜¯å¦æœ‰ä¸“å±è¯­è¨€æ’ä»¶ï¼</p>
</blockquote>
<hr/></div></div></article> <div class="article-end" data-v-539963b4="" data-v-61fb5e44=""><div class="rank-entry-bottom" data-v-539963b4="" data-v-61fb5e44=""><!----></div> <div class="tag-list-box" data-v-539963b4="" data-v-61fb5e44=""><!----><!----><!----></div></div> <!----><!----><!----><!----><!----><style>	.markdown-body { color: #828182;}</style>]]></description></item>  </channel></rss>